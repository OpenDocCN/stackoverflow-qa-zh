# StackOverflow 问答 12416000-12416999

# javascript - Javascript 覆盖用户鼠标事件

> ID：12416002
> 
> 赞同：1
> 
> 时间：2012-09-13T23:00:57.233
> 
> 标签：javascript, mouse

我有一些 javascript 允许用户使用鼠标移动东西，所以用户可以点击并拖动东西，这一切正常，但我正在努力的是能够覆盖用户点击事件.

所以我想做的是，如果用户将项目移动到某个位置，我想停止单击并按住事件，这意味着用户将不得不再次重新选择项目并再次单击并拖动。

您可以从 javascript 覆盖用户的鼠标操作吗？看起来很简单，但我无法在我的 javascript 中找到停止 mousehold 事件的方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T23:17:16.980

也许您可以在`onclick`处理程序中放置一些逻辑来检查这种情况，而不是阻塞事件？

例如，可能有几个属性来维护状态。您可以调用 one `itemSelected`，这必须是`true`为了使项目移动。然后，如果您设置`itemSelected`为`false`，则需要再次单击才能再次切换它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T23:12:36.880

如果鼠标位置没有改变（或者如果改变小于 5 像素），您可以尝试覆盖`onmousedown`以存储鼠标坐标并触发“真正的单击”事件。`onmouseup`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T23:15:02.457

```
document.getElementById('myElement').addEventListener('click', function(e) {
    e.preventDefault(); // here is your override
    doSomethingElse();  // or not
}); 
```

Same thing for IE but use `attachEvent` instead of `addEventListener`

# java - 在 grails 或 java 中转换视频文件

> ID：12416009
> 
> 赞同：0
> 
> 时间：2012-09-13T23:01:34.207
> 
> 标签：java, grails, video

我正在尝试了解如何将视频文件从 mov 转换为 mp4 和/或 ogg。这样移动应用程序就可以将视频上传到我用 grails 制作的网络应用程序。有没有人这样做或知道怎么做。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T02:19:59.107

我会下拉到一个本地进程（在 Java 中它会涉及启动一个进程，[Apace Commons Exec](http://commons.apache.org/exec/)是一个很好的库来管理这个），然后运行[​​mencoder](http://www.mplayerhq.hu/DOCS/HTML/en/mencoder.html)（[MPlayer](http://www.mplayerhq.hu)项目的一部分）或其他一些本地应用程序进行转换。纯 Java 或 Grails 方法可能无法触及 mencoder 的宽格式支持（它具有适用于各种操作系统的[二进制文件）。](http://www.mplayerhq.hu/design7/dload.html)我为音频做了类似的事情，它的扩展性相当好。我有一个 servlet，它获取上传的数据并将其保存到[Amazon S3](http://aws.amazon.com/s3/)，然后我向[Amazon SQS添加一条消息](http://aws.amazon.com/sqs/)它由运行在服务器上的 java 应用程序读取。当它在 que 中检测到新消息时，它会下载上传的歌曲，将其传递给 oggenc2 和 lame，然后 Java 应用程序读取输出（假设进程没有返回任何错误）并将其上传回 S3。如果编码速度太慢，我可以启动另一个编码器并将其指向消息队列。亚马逊确保两个或多个客户在附近提供相同的消息

# c - posix 线程 (pthreads) 标准

> ID：12416012
> 
> 赞同：1
> 
> 时间：2012-09-13T23:01:43.480
> 
> 标签：c, linux, pthreads, posix, standards

我正在为`pthreads`我在并行性方面所做的一些工作寻找标准。我发现它应该是 IEEE 1003.1c“信息技术的 EEE 标准 - 可移植操作系统接口 (POSIX(R)) - 系统应用程序接口 (API) 修正案 2：线程扩展（C 语言）”。但是，当[我谈到它时](http://standards.ieee.org/findstds/standard/1003.1c-1995.html)，它说该标准已被“取代”，但他们没有说什么（或者我没有看到他们在哪里说的）。有谁知道替代标准的链接？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T23:11:30.747

它已被较新的版本（2008 年）取代。它以 IEEE 1003.1-2008 或 ISO/IEC 9945-2009（足够的钱）或[The Open Group Single Unix Specification，第 7 版](https://www2.opengroup.org/ogsys/jsp/publications/PublicationDetails.jsp?publicationid=12310)（免费）的形式提供。这三个都有相同的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T23:11:22.870

是的，那是一份非常古老的文件。您可能想要的是完整的[POSIX 2008 规范](http://pubs.opengroup.org/onlinepubs/9699919799/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T01:14:12.920

由于您在问题中标记了 Linux，我建议除了 Jerry Coffin 回答的内容之外，您还可以查看 Linux [pthreads 手册页](http://www.kernel.org/doc/man-pages/online/pages/man7/pthreads.7.html)。当前的 Linux pthreads 实现 (NPTL) 并不完全符合 POSIX；有些小细节处理方式不同。

还有一些扩展，如`__thread`关键字（指定每个线程的变量，比`pthread_key_create()`; 在此处详细解释[GCC](http://gcc.gnu.org/onlinedocs/gcc/Thread_002dLocal.html)）在 Linux 和其他操作系统中可用，并且可能在将来的某个时候包含在 POSIX 中.

如果您正在做对性能极为敏感的工作，我建议您还查看 GCC、ICC 和 Pathscale 编译器中可用的原子内置函数和向量扩展（[GCC 向量扩展](http://gcc.gnu.org/onlinedocs/gcc/Vector-Extensions.html)、[遗留`__sync`内置](http://gcc.gnu.org/onlinedocs/gcc/_005f_005fsync-Builtins.html)函数、[C++11 风格的`__atomic`内置](http://gcc.gnu.org/onlinedocs/gcc/_005f_005fatomic-Builtins.html)函数和[x86 特定的内置函数](http://gcc.gnu.org/onlinedocs/gcc/X86-Built_002din-Functions.html)）。虽然这些还没有标准化，但它们可以在上述编译器中使用，并且除了最近的内置函数之外`__atomic`，它们至少已经存在了十年。从个人经验来看，我可以证明这些设施可以显着提升性能（在我正在研究的经典分子动力学模拟器中约为 40%），同时仍然可以在非 Windows 系统和编译器之间移植。

# asp.net - RDLC Report Viewer - 如何以编程方式重置输入参数

> ID：12416013
> 
> 赞同：0
> 
> 时间：2012-09-13T23:01:42.497
> 
> 标签：asp.net, webforms, rdlc, report-viewer2010

我的网站上有一个 RDLC 控件。这是客户端报告。我正在使用带有 Visual Studio 2010 的 ASP.net 3.5 报告将许多过滤条件用作输入参数。有一个生成结果的 SQ1 服务器 2008 R2 存储过程。其中一个输入是带有关联日历控件的日期时间文本框。有一个“刷新”按钮。单击此按钮将刷新报告。我想为日期添加一些验证。我所有的验证工作正常。我的问题是当用户在日期时间文本框中输入错误的字符时，报告失败，这是正确的，但是当用户点击刷新按钮时，虽然错误消失了，但报告仍然显示错误消息。

本地调用报表时有没有办法刷新参数。这是我的简单代码 -

```
 protected void BtnRefresh_Click(object sender, EventArgs e)
    {
        //check object session
        LoginSessionData.IsValid();

        //Hide the display panel 
        DisplayMessage.Visible = false;

        //add a try catch block here
        try
        {

            ReportViewer1.LocalReport.Refresh();
        }
        catch (Exception ex)
        {
            m_logger.Error(ex);
        }
    } 
```

![在此处输入图像描述](../Images/e7d6bf9a339b294a42912f3bd1575cc9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T04:19:10.093

您可以将参数值设置为空白或以其他方式使用：

```
ReportParameter p1 = new 
      ReportParameter("ShowDescriptions", checkBox1.Checked.ToString());
ReportParameter p2 = new 
      ReportParameter("MyDate", DateTime.Now.ToString());
ReportViewer1.LocalReport.SetParameters(new ReportParameter[] { p1, p2 }); 
```

# c++ - c++11 标准布局 - 使用相同的访问控制

> ID：12416015
> 
> 赞同：4
> 
> 时间：2012-09-13T23:02:17.097
> 
> 标签：c++, c++11

我认为 POD（c++11，琐碎 + 标准布局）的全部意义在于确保类型与 C 兼容。

给定以下代码：

```
// that one is a standard layout, and trivial which makes it a c++11 POD
struct Bar
{
public:
  int x;
public:
  int y;
}; 
```

AFAIU，编译器可能会重新排序 x 和 y。这不会破坏与 C 的兼容性吗？

为什么 c++11 中的 98/03 POD 定义放宽被认为是一个好主意？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T01:49:13.370

> AFAIU，编译器可能会重新排序 x 和 y。这不会破坏与 C 的兼容性吗？

在 C++03 中，它可以。在 C++11 中它不能。C++11 的标准布局规则*只*要求所有成员具有相同的访问控制。它们不必在同一个访问控制区域中声明。

> 为什么 c++11 中的 98/03 POD 定义放宽被认为是一个好主意？

我认为你误解了一些事情。C++11 规则允许*更多*类型成为标准布局（因此可能与 C 类型布局兼容），而不是更少。因此，放宽规则并没有真正的缺点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T23:07:26.680

> 我认为 POD（c++11，琐碎 + 标准布局）的全部意义在于确保类型与 C 兼容。

不完全是它的全部意义，但是，是的，这是 POD 的特性之一。

> ```
> // that one is a standard layout, and trivial which makes it a c++11 POD 
> ```

正确的。

> AFAIU，编译器可能会重新排序 x 和 y。这不会破坏与 C 的兼容性吗？

我们已经确定它是一个 POD，这意味着编译器将保持与 C 的兼容性。保持与 C 的兼容性不会破坏与 C 的兼容性。

> 为什么 c++11 中的 98/03 POD 定义放宽被认为是一个好主意？

因为它不会破坏任何东西。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-13T23:31:00.040

POD 的重点不仅仅是确保类型与 C 兼容 - 请注意，具有访问说明符（`public`,`private`等）的类型根据定义与 C 不兼容，因为 C 没有访问说明符。POD 类型的主要属性是它可以被 memcpy'ed 围绕。

在 C++ 类型中拥有多个访问说明符确实允许编译器以非指定方式布置类型，并且这已经有一段时间了（这在 C++11 中并不新鲜）：

从 C++03 9.2/12

> 分配没有中间访问说明符的（非联合）类的非静态数据成员，以便后面的成员在类对象中具有更高的地址。由访问说明符分隔的非静态数据成员的分配顺序未指定 (11.1)。

然而，这并没有使一个类型成为非 POD——它仍然可以是一个 POD，只是不是一个可以在 C 中可移植地表达的 POD。

# c++ - 提升正则表达式空格，后跟一个或多个星号

> ID：12416018
> 
> 赞同：0
> 
> 时间：2012-09-13T23:02:28.957
> 
> 标签：c++, regex, boost

为什么以下 boost 正则表达式不返回我正在寻找的结果（以 0 个或多个空格开头，后跟一个或多个星号）？

```
boost::regex tmpCommentRegex("(^\\s*)\\*+");

for (std::vector<std::string>::iterator vect_it =
    tmpInputStringLines.begin(); vect_it != tmpInputStringLines.end();
    ++vect_it) {

    boost::match_results<std::string::const_iterator> tmpMatch;
    if (boost::regex_match((*vect_it), tmpMatch, tmpCommentRegex,
        boost::match_default) == 0) {

        std::cout << "Found comment " << (*vect_it) << std::endl;
    } else {
        std::cout << "No comment" << std::endl;
    }
} 
```

在以下输入上：

```
* Script 7
[P]%OMO      * change
[P]%QMS      * change
[T]%OMO      * change
[T]%QMM      * change
[S]%G1       * Resume
[] 
```

这应该读

```
Found comment * Script 7
No comment
No comment 
No comment 
No comment 
No comment 
No comment 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T23:27:39.693

引用[regex_match 的文档](http://www.boost.org/doc/libs/1_51_0/libs/regex/doc/html/boost_regex/ref/regex_match.html "文档")：

> 请注意，仅当表达式与**整个**输入序列匹配时，结果才为真。如果要在序列中的某处搜索表达式，请使用`regex_search`. 如果要匹配字符串的前缀，请`regex_search`与标志 match_continuous 一起使用。

您的所有输入行都没有与您的正则表达式作为一个整体匹配，因此程序按预期工作。您应该使用`regex_search`来获得所需的行为。

此外，`regex_match`两者`regex_search`都 return`bool`和 not `int`，所以测试 for`== 0`是错误的。

# java - 什么是 Erlang 替代品？

> ID：12416019
> 
> 赞同：3
> 
> 时间：2012-09-13T23:02:41.983
> 
> 标签：java, c++, erlang, message, fsm

对于 Java、C++ 等其他编程语言，尤其是对于 Erlang 来说，最接近的框架是什么？

1.  嵌入式linux应用
2.  除了 Erlang 的其他主要功能之外，该框架还支持 Erlang 的 FSM 模型的近似风格，因此对于我收集的此类要求，例如 Node.js 真的不是一个很好的选择

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T23:13:06.593

在 Scala 中，[Akka](http://akka.io/docs/)是最先进的 actor 技术。

它具有用于切换当前处理器功能的类似 Erlang 的[become/unbecome](http://doc.akka.io/docs/akka/snapshot/scala/actors.html#actor-hotswap)方法，但也具有更惯用的[FSM 模块](http://doc.akka.io/docs/akka/snapshot/scala/fsm.html)。还有一些关于[Akka 在 ARM Linux](http://www.cakesolutions.net/teamblogs/2012/06/01/low-power-arm-kernel-and-akka/)设备上运行的消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T04:59:23.033

1.  云哈斯克尔
2.  任何语言 + RabbitMQ/ZeroMQ

# python - 如何在异步反向服务器 python 中控制要连接的套接字线程？

> ID：12416021
> 
> 赞同：0
> 
> 时间：2012-09-13T23:02:49.530
> 
> 标签：python, multithreading

晚上好，这是我第一次访问这个网站，在过去的 3 个月里，我一直在为我的工作编写一个基于 python 的用户监控系统，我的第一个版本几乎完成了。但是，我在控制要连接的计算机时遇到了问题。

如果我运行我在这篇文章中放置的两个示例代码，我可以接收客户端并向服务器发送命令，但一次只能发送一个客户端，服务器决定我可以发送到哪个客户端，下一个是哪个客户端. 我确定问题出在“服务器端，但我不知道如何解决这个问题，而且谷歌搜索没有出现任何尝试过这个的人。

我在这篇文章中附加了基于客户端和服务器的网络代码。

客户：

```
import asyncore
import socket
import sys
do_restart = False
class client(asyncore.dispatcher):
    def __init__(self, host, port=8000):
        serv = open("srv.conf","r")
        host = serv.read()
        serv.close()
        asyncore.dispatcher.__init__(self)
        self.create_socket(socket.AF_INET, socket.SOCK_STREAM)
        self.connect((host, port))
    def writable(self):
        return 0
    def handle_connect(self):
        pass           
    def handle_read(self):
        data = self.recv(4096)
        #Rest of code goes here 
serv = open("srv.conf","r")
host = serv.read()
serv.close()
request = client(host)
asyncore.loop() 
```

服务器：

```
import asyncore
import socket
import sys
class  soc(asyncore.dispatcher):
    def __init__(self, port=8000):
        asyncore.dispatcher.__init__(self)   
        self.port = port
        self.create_socket(socket.AF_INET, socket.SOCK_STREAM)
        self.bind(('', port))
        self.listen(5)
    def handle_accept(self):
        channel, addr = self.accept()
        while 1:
            j = raw_input(addr)
            #Rest of my code is here
server = soc(8000)
asyncore.loop() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:26:27.200

这是我提出的一个快速而肮脏的想法。

的使用`raw_input`已被另一个异步兼容的调度程序替换，[在此处引用另一个问题](https://stackoverflow.com/questions/7312977/asyncore-loop-and-raw-input-problem)

我正在扩展@user1320237 给出的答案，以将每个新连接推迟到新的调度程序。

您希望拥有一个可以向任何连接的客户端发送控制命令的命令行界面。这意味着您需要一种在它们之间切换的方法。我所做的是创建一个字典来跟踪连接的客户端。然后我们还创建了一组可用的命令，这些命令映射到您的命令行的回调。

此示例具有以下内容：

*   `list`: 列出当前客户
*   `set <client>`: 设置当前客户端
*   `send <msg>`: 向当前客户端发送一条消息

**服务器.py**

```
import asyncore
import socket
import sys
from weakref import WeakValueDictionary

class Soc(asyncore.dispatcher):

    CMDS = {
        'list': 'cmd_list',
        'set': 'cmd_set_addr',
        'send': 'cmd_send',
    }

    def __init__(self, port=8000):
        asyncore.dispatcher.__init__(self)  

        self._conns = WeakValueDictionary()
        self._current = tuple()

        self.port = port
        self.create_socket(socket.AF_INET, socket.SOCK_STREAM)
        self.set_reuse_addr()
        self.bind(('', port))
        self.listen(5)

        self.cmdline = Cmdline(self.handle_input, sys.stdin)
        self.cmdline.prompt()

    def writable(self):
        return False

    def handle_input(self, i):
        tokens = i.strip().split(None, 1)
        cmd = tokens[0]
        arg = ""
        if len(tokens) > 1:
            arg = tokens[1]

        cbk = self.CMDS.get(cmd)
        if cbk:
            getattr(self, cbk)(arg)

        self.cmdline.prompt(self._addr_to_key(self._current))

    def handle_accept(self):
        channel, addr = self.accept()
        c = Conn(channel)
        self._conns[self._addr_to_key(addr)] = c

    def _addr_to_key(self, addr):
        return ':'.join(str(i) for i in addr)

    def cmd_list(self, *args):
        avail = '\n'.join(self._conns.iterkeys())
        print "\n%s\n" % avail

    def cmd_set_addr(self, addr_str):
        conn = self._conns.get(addr_str)
        if conn:
            self._current = conn.addr

    def cmd_send(self, msg):
        if self._current:
            addr_str = self._addr_to_key(self._current)
            conn = self._conns.get(addr_str)
            if conn:
                conn.buffer += msg         

class Cmdline(asyncore.file_dispatcher):
    def __init__(self, cbk, f):
        asyncore.file_dispatcher.__init__(self, f)
        self.cbk = cbk

    def prompt(self, msg=''):
        sys.stdout.write('%s > ' % msg)
        sys.stdout.flush()        

    def handle_read(self):
        self.cbk(self.recv(1024))

class Conn(asyncore.dispatcher):

    def __init__(self, *args, **kwargs):
        asyncore.dispatcher.__init__(self, *args, **kwargs)  
        self.buffer = ""

    def writable(self):
        return len(self.buffer) > 0

    def handle_write(self):
        self.send(self.buffer)
        self.buffer = ''

    def handle_read(self):
        data = self.recv(4096)
        print self.addr, '-', data

server = Soc(8000)
asyncore.loop() 
```

您的主服务器现在永远不会阻塞`stdin`，并且总是接受新连接。它所做的唯一工作是命令处理，它应该是快速操作，或者向连接对象发出信号以处理消息。

用法：

```
# start the server
# start 2 clients
> 
> list

127.0.0.1:51738
127.0.0.1:51736

> set 127.0.0.1:51736
127.0.0.1:51736 >
127.0.0.1:51736 > send foo

# client 127.0.0.1:51736 receives "foo" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T23:19:36.403

大部头书

```
 while 1:
        j = raw_input(addr) 
```

似乎是问题所在：你只接受一个套接字，然后用它做一些事情直到结束。

您应该为每个连接的客户端创建一个新的调度程序

```
class  conn(asyncore.dispatcher):
     ...
     def handle_read(self):
         ...

class  soc(asyncore.dispatcher):
     def handle_accept(self):
         ...
         c = conn()
         c.set_socket(channel) 
```

Asyncore 会为每个可能的读取操作回电。

Asyncore 只使用一个线程。这就是它的力量。每个具有套接字的调度程序都被这些`handle_*`函数一个接一个地调用。

# jquery - jquery dialog("open") 内容不显示

> ID：12416026
> 
> 赞同：1
> 
> 时间：2012-09-13T23:03:41.153
> 
> 标签：jquery

使用 jquery 对话框有一段时间了，但现在遇到了一个奇怪的行为。

来电：

```
$('#dialog-form').dialog({
    autoOpen: false,
    width: '700px',
    modal: true,
    hide: 'slide'
});

$('#dialog-form').dialog('option', 'buttons', {
'add' : {
    text: labelAdd,
    click: function() {
        doadd = true;
        if (typeof checkRow !== "undefined") { doadd = checkRow() };
        if (doadd) { exec(); }
    }}, 
'Cancelar': function() {$(this).dialog('close'); }
});
$("#dialog-form").dialog("open");

function exec() {
$('#dialog-form').dialog('close');
/* execute some remote code using ajax call*/
if (error) {
    $('#dialog-form').dialog('open');
    return false
}
return true;
} 
```

对话框未正确显示。它显示“ui-widget-overlay”，但不显示对话框内容。

我调用该函数的两次树时间发生在我身上。

对于我可以看到的显示属性设置为无。

生成的html代码：

```
div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-draggable ui-resizable" style="display: none; z-index: 1002; outline: 0px none; position: absolute; height: auto; width: 700px; top: 0px; left: 320.5px;" tabindex="-1" role="dialog" aria-labelledby="ui-dialog-title-dialog-form"> 
```

我使用firebug手动设置显示阻止，它工作正常。

顺便说一句，如果我脉冲“esc”，我可以看到隐藏对话框的动画。

我可以从js设置div内容的显示吗？或者我应该以不同的方式打开/关闭对话框？

谢谢您的帮助。

安东尼奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T23:05:38.580

为什么不加

`$("#dialog-form").dialog("open").show()`对它..

我有一个类似的问题，这对我有用..

# c++ - ((ManifestItem*)manifest->currentItem())->fileContent = currentHtml(); 在cpp中是什么意思？

> ID：12416028
> 
> 赞同：0
> 
> 时间：2012-09-13T23:03:45.840
> 
> 标签：c++

我知道这`(*x).y`就像`x->y`在 c++ 中一样，但是这段代码是为我准备的。任何人都可以帮助我或给我一个参考吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T23:09:43.757

总的来说，使用变量名称中的术语，它将`currentHtml()`函数的返回值存储到`manifest`'s`currentItem`的`fileContent`变量中。

分解它：

```
((ManifestItem*)manifest->currentItem()) 
```

`currentItem()`在您的类中有一个方法`manifest`将返回“当前项目”。会将这个`(ManifestItem*)`返回的项目转换为`ManifestItem`数据类型。

其余的，我希望，不言自明：

```
->fileContent = currentHtml(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:01:29.407

> `((ManifestItem*)manifest->currentItem())->fileContent = currentHtml();`cpp是什么意思？

意思是有人在做坏事。

首先，将问题放在标题中是在做坏事。其次，演员阵容是可疑的迹象。但 ...

您需要了解的第一件事是 C++ 运算符优先规则。元素选择运算符`->`优先于强制转换运算符`(type)`，这意味着我们可以将其重写为

```
((ManifestItem*)(manifest->currentItem()))->fileContent = currentHtml(); 
```

将其分解为部分，

1.  `manifest`对象的成员`currentItem()`函数被调用，它可能返回某种类型的指针。鉴于演员表，我怀疑`currentItem()`返回一个`void*`指针。
2.  C 风格的强制转换运算符将该指针转换为指向`ManifestItem`对象的指针。
3.  该`fileContent`对象的成员设置为调用的结果`currentHtml()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T23:12:42.710

```
((ManifestItem*)manifest->currentItem())->fileContent = currentHtml(); 
```

1) 调用 currentHtml()

2) 将清单转换为指向 ManifestItem 的指针

3）取消引用#2中的指针并调用其currentItem成员函数

4) 取消引用 #3 并将 #1 中的值分配给它的 fileContent 数据成员——或者使用 operator=()

# python - Python-如何保留 X% 的数据？

> ID：12416029
> 
> 赞同：0
> 
> 时间：2012-09-13T23:03:45.543
> 
> 标签：python, percentage, minimum

我有看起来像这样的数据，比如说制表符分隔的格式：

```
Sample  Dog Cat Tarsier
A47 1   7   2
A48 3   3   4
A51 2   1   8
A53 0   0   0
A54 1   7   2
A57 0   0   10 
```

虽然这里可能不清楚，但样本名称在第一列，值对应于 Dog、cat 或 Tarsier。我想保留，比如说每个样本的 90% 的数据，并在 PYTHON 中删除其余的数据。例如，对于示例 A47，我想检索如下内容：

```
 Cat   Tarsier
A47    7       2 
```

这对我来说很难，因为每个样本我需要 3 条信息：样本名称、动物和数量。有什么想法吗？提前致谢

根据下面的评论，第二行可能包括所有数字，但排除可能存在的所有其他数字（未显示）。这是因为在这种情况下，如果没有第二个 3，则只有不到 90% 的数据，这可能比拥有 >90% 的数据更糟糕。如何做到这一点超出了我的 PYTHON 编程技能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T00:21:04.620

假设您使用的是 Python 3（它也可能在 Py2 中工作，但我不知道），只需将其视为由制表符而不是逗号分隔的 CSV——

```
import csv

def getvals(file):
    """
        gets the val's from a file of whitespace separated values, and 
        turns them into easy to use Python var's
    """
    samples = csv.reader(open(file))
    s = []
    n = 0
    for row in samples:
        r = [row[0].split()]
        s += r
        n+=1
    return s 
```

该函数将返回一个如下所示的集合——

```
[
 ['Sample', 'Dog', 'Cat', 'Tarsier'], 
 ['A47', '1', '7', '2'], 
 ['A48', '3', '3', '4'], 
 ['A51', '2', '1', '8'], 
 ['A53', '0', '0', '0'], 
 ['A54', '1', '7', '2'], 
 ['A57', '0', '0', '10']
] 
```

从那里，确定要丢弃哪个值只是一些数学问题。当然，您也可以在 for 循环中进行数学运算并返回您想要的值。我只是想返回许多其他函数可以使用的值集，所以我就这样做了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T09:05:39.503

我强烈建议您考虑[NumPy](http://docs.scipy.org)。

使用 NumPy，您可以定义所谓的结构化数组，即每行由您可以直接命名和访问的不同字段组成的数组。

假设您的数据存储在制表符分隔的文件`data.dat`中，使用您描述的格式，您会这样做

```
>>> data = np.genfromtxt('data.txt', delimiter="\t", names=True, dtype=None) 
```

该[`np.genfromtxt`](http://docs.scipy.org/doc/numpy/user/basics.io.genfromtxt.html)函数从 读取您的数据`'data.txt'`，沿 分割每一行`delimiter`，使用第一行获取字段的名称 ( `names=True`)，并猜测每个字段的数据类型 ( `data=None`)。以你的例子，我得到

```
data = array([('A47', 1, 7, 2), ('A48', 3, 3, 4), ('A51', 2, 1, 8),
       ('A53', 0, 0, 0), ('A54', 1, 7, 2), ('A57', 0, 0, 10)], 
      dtype=[('Sample', '|S3'), ('Dog', '<i8'), ('Cat', '<i8'), ('Tarsier', '<i8')]) 
```

从这里，我们可以选择字段组合

```
>>> data[["Cat","Tarsier"]]
array([(7, 2), (3, 4), (1, 8), (0, 0), (7, 2), (0, 10)], 
  dtype=[('Cat', '<i8'), ('Tarsier', '<i8')]) 
```

或只有几行：

```
>>> data[[0,2]]
array([('A47', 1, 7, 2), ('A51', 2, 1, 8)], 
     dtype=[('Sample', '|S3'), ('Dog', '<i8'), ('Cat', '<i8'), ('Tarsier', '<i8')]) 
```

对某个字段进行一些统计：

```
>>> data["Dog"].mean()
1.1666667 
```

简而言之，您可以按照自己的方式过滤数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T23:32:00.780

如果我是对的，您删除了“狗”，因为它<=动物总数的 10%。让我们创建一个结构

```
struct row{
    char *name;
    int animal[3]; //id 0 is dog, 1 is cat and 2 is tarsier
} 
```

然后每次将读取的数据放入此结构时，您可以简单地将每个字段设置为 0 <=10%：

```
int i;
float sum=0; //we need float to force the result to be float
for (i=0;i<3;i++){
    sum += row.animal[i]; //count the total row population
}
for (i=0;i<3;i++){ //for every animal
    if (row.animal[i]/sum <= 0.1){ //if this animal is equal or less than 10% of the row population
        row.animal[i]=0; //set his population to 0
    }
} 
```

如您所见，由于具有此代码的动物数组，您可以拥有任意（但固定）数量的动物。

# r - 通过 = 在 R 中禁用分配

> ID：12416030
> 
> 赞同：30
> 
> 时间：2012-09-13T23:03:49.943
> 
> 标签：r, variable-assignment

R 允许通过`<-`和进行赋值`=`。

尽管两个赋值运算符之间存在[细微差别](https://stackoverflow.com/q/1741820/289572)，但似乎有一个广泛的共识，即`<-`比`=`, as也更好，因为`=`它也用作将值映射到参数的运算符，因此它的使用可能会导致模棱两可的陈述。下面举例说明了这一点：

```
> system.time(x <- rnorm(10))
   user  system elapsed 
      0       0       0 
> system.time(x = rnorm(10))
Error in system.time(x = rnorm(10)) : unused argument(s) (x = rnorm(10)) 
```

事实上，[Google 风格的代码](http://google-styleguide.googlecode.com/svn/trunk/google-r-style.html#assignment)不允许使用`=`for assignment（请参阅对此[答案](https://stackoverflow.com/a/1742591/289572)的评论以获取相反的观点）。

我也几乎专门`<-`用作赋值运算符。但是，上一句中的差不多就是这个问题的原因。在`=`我的代码中充当赋值运算符时，它总是偶然的，如果它导致问题，通常很难发现。

**我想知道是否有办法通过关闭分配并让 R 在任何时候用于分配`=`时抛出错误。`=`**

最佳情况下，这种行为只会发生在全局环境中的代码上，因为在附加的命名空间中很可能有代码`=`用于分配并且不应该中断。

（这个问题的灵感来自与[Jonathan Nelson](http://www.jonathandnelson.com/)的讨论）

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-09-13T23:40:03.600

这是一个候选人：

```
`=` <- function(...) stop("Assignment by = disabled, use <- instead")
# seems to work
a = 1
Error in a = 1 : Assignment by = disabled, use <- instead
# appears not to break named arguments
sum(1:2,na.rm=TRUE)
[1] 3 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-13T23:40:15.687

我不确定，但也许简单地覆盖的分配`=`对你来说就足够了。毕竟，``=``是一个和其他名字一样的名字——几乎。

```
> `=` <- function() { }
> a = 3
Error in a = 3 : unused argument(s) (a, 3)
> a <- 3
> data.frame(a = 3)
  a
1 3 
```

因此，任何使用`=`for 赋值都会导致错误，而使用它来命名参数仍然有效。除非实际执行了相关行，否则它在函数中的使用可能会被忽视。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-14T03:56:39.747

包`lint`(CRAN) 有一个样式检查，所以假设你的代码在一个文件中，你可以对它运行 lint，它会警告你那些带有`=`分配的行号。

这是一个基本示例：

```
temp <- tempfile()
write("foo = function(...) {
          good <- 0
          bad = 1
          sum(..., na.rm = TRUE)
       }", file = temp)

library(lint) 
lint(file = temp, style = list(styles.assignment.noeq))
# Lint checking: C:\Users\flodel\AppData\Local\Temp\RtmpwF3pZ6\file19ac3b66b81
# Lint: Equal sign assignemnts: found on lines 1, 3 
```

该`lint`软件包附带了一些您可能会感兴趣的测试，包括：

*   警告不要正确分配
*   推荐周围的空间`=`
*   推荐逗号后的空格
*   建议中缀之间有空格（又称二元运算符）
*   警告标签
*   警告最大线宽的可能性
*   警告函数调用内部的赋值

您可以打开或关闭任何预定义的样式检查，也可以编写自己的。然而，该软件包仍处于起步阶段：它带有一些错误（https://github.com/halpo/lint）并且文档有点难以消化。作者反应灵敏，并慢慢做出改进。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-14T05:43:44.060

如果您不想破坏现有代码，那么这样的事情（打印警告而不是错误）可能会起作用 - 您给出警告然后分配给`parent.frame`使用`<-`（以避免任何递归）

```
`=` <- function(...){
        .what <- as.list(match.call())
        .call <-  sprintf('%s <- %s', deparse(.what[[2]]),  deparse(.what[[3]]))
        mess <- 'Use <- instead of = for assigment '
        if(getOption('warn_assign', default = T)) {
        stop (mess) } else {
        warning(mess)
        eval(parse(text =.call), envir = parent.frame())  
          }
        } 
```

如果您设置`options(warn_assign = F)`，`=`则将警告并分配。其他任何事情都会引发错误并且不会分配。

## 使用示例

```
# with no option set
z = 1
## Error in z = 1 : Use <- instead of = for assigment 
options(warn_assign = T)
z = 1
## Error in z = 1 : Use <- instead of = for assigment 
 options(warn_assign = F)
 z = 1
## Warning message:
##  In z = 1 : Use <- instead of = for assigment 
```

## 更好的选择

我认为`formatR`or`lint`和代码格式化是更好的方法。

# ios - IOS - reloadData 有多贵？

> ID：12416032
> 
> 赞同：6
> 
> 时间：2012-09-13T23:03:57.887
> 
> 标签：ios, performance, tableview, reloaddata

我想知道 tableView 上的 reloadData 有多贵。我想每 5 秒刷新一次表格视图。这会导致任何性能问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T23:10:12.960

重新加载数据将调用您的表格视图数据源上的两个主要方法，`numberOfRowsInSection`然后根据您的表格视图迭代`cellForRow:atIndexPath:`所需的可见单元格`contentOffset`

如果您的应用程序已经很好地滚动，那么您的应用程序将承受的唯一性能损失是您是否正在做大量工作`numberOfRowsInSection`（例如访问网络或一些耗时的事情）。

**编辑：**如前所述，`heightForRow:atIndexPath:`如果您使用它对不同高度的单元格进行复杂计算，也可能是一个痛点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T21:54:02.003

如果适用于您的情况，NSFetchedResultsController 可以在数据更改时通知您的表视图，而不是每“n”秒刷新一次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T23:29:07.810

除了@Jessedc 的回答，

如果所有行的高度相同，则`heightForRowAtIndexPath`比`tableview.rowHeight`.

如果每行有很多不同高度的行，并且每次`heightForRowAtIndexPath`调用该方法时都在计算行的高度，那么它的成本会更高。

决定电话的费用有很多因素`reloadData`。一切都取决于每次调用委托方法时你做了什么以及做了多少。

# c# - 线程使应用程序停止

> ID：12416038
> 
> 赞同：0
> 
> 时间：2012-09-13T23:04:42.743
> 
> 标签：c#, multithreading, file, callback

我目前正在尝试创建一个 FileViewer 控件，在我将项目（带有图标的文件名、大小等）添加到我的 ListView（图标 - 文件名 - 扩展名 - 大小）之后，我还检查文件是否是图像（png /jpg 等），但我在不同的线程上执行此操作。

我对线程的期望是它在主应用程序旁边运行，但是在我添加了所有文件之后，我启动了这个线程。它检查 ListView 中的所有文件并为它们创建缩略图。如果操作正确，ListView 图标在加载时应该一个接一个出现 - 但它们不是。它们都同时出现。

...当线程处于活动状态时，我什么也做不了。

为什么会发生这种情况，我做错了什么？我之前处理过线程并且它总是有效的，我使用回调调用该方法。

线程流：

1.  格式文件键 = "C:\image.png" = "C_image_png"。
2.  检查图像的缩略图是否存在（通过检查它的键），然后使用它
3.  否则使用 Image.FromFile().GetThumbnailImage() 加载缩略图，并将带有 Key 的图像添加到 Listview 的图像
4.  最后更改 ListView 项的 ImageKey。

全部在一个线程中完成。

```
private void GetFiles()
{
   // Load all files in directory

   Thread t = new Thread(new ThreadStart(GetImageFiles));
   t.Priority = ThreadPriority.Lowest;
   t.Start();

}

delegate void GetImageFilesCallback();

    private void GetImageFiles()
    {
        if (this.IsHandleCreated)
        {
            if (files.InvokeRequired)
            {
                GetImageFilesCallback callback = new GetImageFilesCallback(GetImageFiles);
                this.Invoke(callback);
            }
            else
            {
                string extension = "";
                string key = "";

                foreach (string file in _files)
                {
                    extension = FileManager.GetExtension(file);
                    key = (DirectoryCurrent + file).Replace(":", "").Replace("\\", "_").Replace(".", "_");

                    foreach (string knownimages in _knownImageTypes)
                    {
                        if (extension.ToLower() == knownimages)
                        {
                            foreach (ListViewItem item in files.Items)
                            {
                                if (item.Text == file)
                                {
                                    if (files.SmallImageList != null)
                                    {
                                        if (files.SmallImageList.Images[key] == null)
                                        {
                                            files.SmallImageList.Images.Add(key, Image.FromFile(DirectoryCurrent + file).GetThumbnailImage(16, 16, null, IntPtr.Zero));
                                            files.LargeImageList.Images.Add(key, Image.FromFile(DirectoryCurrent + file).GetThumbnailImage(32, 32, null, IntPtr.Zero));
                                        }

                                        files.Items[item.Index].ImageKey = key;
                                    }
                                }
                            }
                        }
                    }
                }

                files.Refresh();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:31:06.917

您的线程调用的方法是在主线程上调用自身，然后在该线程中完成所有工作，从而阻塞您的 UI。

您应该安排您的代码，以便线程代码不接触 ListView，而只是加载每个图像，然后调用主线程方法，传递位图，以便主线程可以将它们分配给 ListView。

这是我的意思的草图：

```
// this is your thread method
// it touches no UI elements, just loads files and passes them to the main thread
private void LoadFiles(List<string> filenames) {
   foreach (var file in filenames) {
      var key = filename.Replace(...);
      var largeBmp = Image.FromFile(...);
      var smallBmp = Image.FromFile(...);
      this.Invoke(new AddImagesDelegate(AddImages), key, largeBmp, smallBmp);
   }
}

// this executes on the main (UI) thread    
private void AddImages(string key, Bitmap large, Bitmap small) {
   // add bitmaps to listview
   files.SmallImageList.Images.Add(key, small);
   files.LargeImageList.Images.Add(key, large);
}

private delegate AddImagesDelegate(string key, Bitmap large, Bitmap small); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T23:34:19.617

阅读以下内容：http: [//www.codeproject.com/Articles/10311/What-s-up-with-BeginInvoke](http://www.codeproject.com/Articles/10311/What-s-up-with-BeginInvoke)。Invoke 和 BeginInvoke 的重要之处在于它们都在主线程上运行。BeginInvoke 只是在返回控制之前不等待消息被处理。但最终，工作将发生在主线程上，并且会阻塞直到完成。

# jquery - 使用 jquery post 从控制器获取值

> ID：12416043
> 
> 赞同：0
> 
> 时间：2012-09-13T23:04:54.803
> 
> 标签：jquery, post, spring-mvc

从 jquery 做一个帖子。POST 正在发生，但无法访问控制器添加的模型属性。

jQuery代码：

```
$.post('<c:url value="/savedLog.form" />', $('#logForm').serialize(), function(data, textStatus) {
    var jsonlog = "${logJson}"
    if (data === "SUCCESS") {
        alert(jsonlog);
    }
}); 
```

控制器：

```
public String savedLog(@RequestParam(value = "requestId", required = true) LogRequest request, ModelMap model) throws IOException 
{
    try 
    {
        //Code to populate log            
        model.addAttribute("logJson", log.getLog());
        return "success";
    }​
} 
```

POST 工作正常，控制器方法执行成功。实际代码中有一个问题。已删除，因为它是多余的。

可能是什么问题。这条线不起作用。var jsonlog = "${logJson}" 模型属性或 jquery 有问题吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:26:22.587

看起来您混淆了生成页面的请求（其中包含 AJAX 表单）和发生 AJAX POST 时调用的请求。

```
var jsonlog = "${logJson}" 
```

只会在第一个（页面）请求上填充。AJAX POST 在呈现后无法将 JSTL 值注入您的页面。

您需要在来自 AJAX POST 的响应中将该值作为文本或 JSON 数据发送，然后从`data`.POST 回调中的 var 读取该值。添加`@ResponseBody`注解告诉 Spring 返回 JSON（可能需要添加 Jackson 库）并返回 Map ...

```
public @ResponseBody Map<String, String> savedLog(@RequestParam(value = "requestId", required = true) LogRequest request, ModelMap model) throws IOException {
try {
    //Code to populate log            
    //model.addAttribute("logJson", log.getLog());
    Map <String, String> map = new HashMap<String, String>();
    map.put("logJson", log.getLog());
    return map;
}​ 
```

然后在 AJAX 代码中，阅读：

```
$.post('<c:url value="/savedLog.form" />', $('#logForm').serialize(), function(data, textStatus) {

    if (data.logJson) {
        alert(data.logJson);
    }
}, "json"); // Note JSON dataType specified here 
```

注意：您不应该从控制器返回“SUCCESS”作为文本。为此使用 HTTP 代码，例如，如果发生错误，则抛出 404 或 500（通过 HttpServletResponse 对象），否则当您返回 Map 时，状态将自动变为 200。

# iphone - Xcode 4.5 故事板“退出”

> ID：12416050
> 
> 赞同：102
> 
> 时间：2012-09-13T23:06:07.040
> 
> 标签：iphone, objective-c, xcode, ipad, storyboard

我刚刚安装了支持 iOS6 的 Xcode 4.5，我在我的 Storyboard 中看到了一个名为“Exit”的新图标，它与“First Responder”等一起列在我的视图控制器下。一个标有“Exit”的绿色小图标。

我可以找到任何关于它的信息，也不知道如何使用它。它是如何工作的？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-09-17T14:37:19.177

这被称为“ **Unwind Segue** ”。不幸的是，到目前为止，除了 XCode 4.5 新功能列表中的简短提及外，没有任何文档说明：

> 展开转场可以允许过渡到情节提要中的现有场景实例

好消息是 WWDC 2012 有一个会议解释了这些生物（除其他外）。

您可以使用您的开发人员帐户详细信息登录 Apple 的 iOS 开发中心，然后转到[WWDC 2012 视频页面](https://developer.apple.com/videos/wwdc/2012/)并观看“在您的应用程序中采用故事板”（从顶部起第五个）关于 unwind segues 的讨论从 37:20 开始.

* * *

**更新：** 以下是 Apple 文档中有关该主题的更多信息

> 一个名为 Exit 的占位符对象，用于展开序列。默认情况下，当用户关闭子场景时，该场景的视图控制器会展开（或返回）到父场景——即最初转换到子场景的场景。但是，Exit 对象使视图控制器能够展开到任意场景。

*（来自 iOS6 docset > General > Getting Started）*

[这是一个很好的例子，说明如何实现一个](http://www.techotopia.com/index.php/Using_Xcode_Storyboarding_%28iOS_6%29#Unwinding_Storyboard_Segues)

* * *

**另一个更新：**

[这是 Apple](https://developer.apple.com/library/ios/technotes/tn2298/_index.html)关于此主题的技术说明。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-09-14T03:37:15.440

假设您的故事板中有一系列视图：

`A -> ... -> Z`

您希望在视图上有一个按钮`Z`，允许用户一直返回到`A`.

所以你需要做的是给出你想要一直返回的视图，在这种情况下`A`，一个实例方法被标记为 a`IBAction`并接受一个类型的参数`UIStoryboardSegue *`。方法和变量的名称无关紧要。您在实现中所做的事情也无关紧要。这是一个例子：

**Obj-C：**
在`A`'s 接口（不是`Z`'s）：

```
- (IBAction)cancelSignup:(UIStoryboardSegue *)unwindSegue; 
```

在`A`'s 实现（不是`Z`'s）：

```
- (IBAction)cancelSignup:(UIStoryboardSegue *)unwindSegue {
    // Only "implemented" to satisfy a respondsToSelector: search.
    // You can actually implement more stuff here, if you want, IE, if
    // you need to reach out to a server to mention that this screen was
    // returned to from a later screen.
} 
```

**斯威夫特：**
在`A`'s 源（不是`Z`'s）：

```
@IBAction func cancelSignup(unwindSegue: UIStoryboardSegue) {
    // Only "implemented" to satisfy a respondsToSelector: search.
    // You can actually implement more stuff here, if you want, IE, if
    // you need to reach out to a server to mention that this screen was
    // returned to from a later screen.
} 
```

现在，在故事板中，从（IE，取消按钮）`control`上的元素拖动到's 。它将扫描视图层次结构中更高的所有视图，这些视图具有仅接受单个作为操作的视图，并列出它们以供您选择。`Z``Z``Exit``IBAction``UIStoryboardSegue *`

希望这比现有答案更直接和更有帮助。我发现此链接特别有用，因此，如果您在阅读我的答案后仍然不清楚某个细节，也许这可以帮助您（我试图将这篇长文中的所有有用信息浓缩成一个简短的答案）： [http://www.freelancemadscience.com/fmslabs_blog/2012/9/24/advanced-storyboard-techniques.html](http://www.freelancemadscience.com/fmslabs_blog/2012/9/24/advanced-storyboard-techniques.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-26T17:52:35.457

另请参阅[Cannot Connect Storyboard Unwind Segue](https://stackoverflow.com/questions/12792573/cannot-connect-storyboard-unwind-segue)，它阐明了使退出图标栩栩如生的要求。在视图控制器层次结构中，您必须有一个方法，即：

1.  标记为 IBAction

2.  采用一个参数，即 UIStoryboardSegue*

如果满足这两个条件，Exit 图标将看到它，并允许您通过从同一视图控制器中的按钮拖动来连接到它。

我现在还在这里发布了世界上最简单的示例：

[https://github.com/mattneub/Programming-iOS-Book-Examples/tree/master/ch19p638presentedViewControllerStoryboard（2013](https://github.com/mattneub/Programming-iOS-Book-Examples/tree/master/ch19p638presentedViewControllerStoryboard)年 7 月 12 日修复）

这表明现在在呈现的视图控制器之间进行切换是多么容易，而不是您以前为了来回传递信息而必须做的所有工作（模板中带有委托和协议的东西*）*，现在可以删除所有这些）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-18T00:41:41.180

只需在可能有帮助的需求定义中添加一点微妙之处。这是基于在 Xcode 4.6 中的实验。我发现它是专门且唯一的方法的声明（！），可以从 Xcode 启用所需的控制拖动响应。这是我发现的全部要求：

*   标记为`IBAction`
*   接受一个参数是`UIStoryboardSegue`*
*   您必须声明一个动作（但不一定要实现[意味着`.M`实现部分中的方法]）。
*   它可以在任何类的接口声明中，甚至是 a 的接口部分`.M`，除了 appdelegate 类。（我没有看到它在控制器层次结构中的位置有任何依赖性。您可以添加任何旧文件，系统似乎聚合了所有具有`UIStoryboardSegue`参数的方法并将它们显示在退出图标的菜单上。）请注意，控制拖动如果方法在情节提要编辑器中操作的场景的类中，菜单甚至会向您显示您的方法，但它会出现没有冒号并且似乎不会在运行时触发任何动作。

例子： `-(IBAction)anymethodname:(UIStoryboardSegue *)myvariable;`

# windows - PE 文件格式 - 节表和第一节之间是什么？

> ID：12416054
> 
> 赞同：3
> 
> 时间：2012-09-13T23:06:27.550
> 
> 标签：windows, executable, portable-executable, coff

在十六进制编辑器中查看 PE 文件时，我经常在节表和第一节之间遇到一些字节，这对我来说真的没有意义。就我而言，应该有一个 00 字节的填充以适应对齐方式。但是，这是一个截屏，展示了相反的情况：

[![](../Images/aa78f858cb2ec1d013d100845d14b81b.png)](https://i.stack.imgur.com/qSiaL.png)

事实证明，突出显示的块几乎是绑定导入表。但我仍然很困惑。为什么此表不在一个部分中？总是这样还是只是某个编译器/链接器的规范？我没有找到有关此特定问题的任何文档。关于这个主题的所有内容基本上都说：

1.  DOS MZ 标头
2.  DOS存根
3.  PE头
4.  截面表
5.  第 1 节
6.  第 2 节
7.  第 3 节

... 等等

在我遇到这个问题之前，我什至不知道这些部分之外可能有一些东西（当然，除了我上面列出的那些）。

**[编辑]**

概念证明（因为 Mox 不相信我）：

![主PE](../Images/37a1bc0590f5c1bdc0f84008bfb2e71f.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-06T22:05:43.950

诸如 的数据目录`IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT`可以存在于节之外。存在于任何已知部分之外的数据目录的另一个示例是`IMAGE_DIRECTORY_ENTRY_CERTIFICATE`数据目录，它是在签署可执行文件时用于存储证书信息的数据目录。

数据目录可以指向节外、节内的数据，也可以指向整个节。`IMAGE_DIRECTORY_ENTRY_RESOURCE`数据目录指向整个“.rsrc”部分。某些数据目录指向已知部分，这些部分记录在[Microsoft 的 PE 格式规范中](http://msdn.microsoft.com/en-us/library/windows/hardware/gg463119.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T15:51:13.317

绑定导入表之类的项目可以写入链接器希望将它们放入原始图像的任何位置。它只是用表覆盖零字节并使指针在数据目录中正确。您甚至可以用导入表覆盖 DOS 标头或存根的中间部分，只要目录中的指针正确，它就可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T07:18:26.847

据我在 LordPe 中看到的，iexplore.exe 的 IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT 条目是空的。

![在此处输入图像描述](../Images/da3e2e01e75becb450cf24c4ee6dc531.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T07:50:37.573

IEXPLORE.EXE 的 32 位和 64 位版本都没有 IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT 条目。

这是 LordPE 的快照，显示了 Windows 7 机器上的 64 位版本的 IEXPLORE.EXE 和（绿色）缺少的 IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT 条目：

![在此处输入图像描述](../Images/52463bd3dcebca26a6ff565378c92801.png)

看起来您没有查看正确的目录条目。

# c++ - 微优化 - 访问递归成员时的编译器优化

> ID：12416055
> 
> 赞同：0
> 
> 时间：2012-09-13T23:06:44.210
> 
> 标签：c++, micro-optimization, member-function-pointers

我有兴趣从一开始就编写好的代码，而不是以后优化代码。很抱歉没有提供基准我目前没有工作场景。感谢您的关注！

使用 FunctionY 优于 FunctionX 的性能提升是什么？

已经有很多关于 stackoverflow 的讨论，但我对访问子成员（递归）时的情况表示怀疑，如下所示。编译器（比如 VS2008）会将 FunctionX 优化为 FunctionY 之类的东西吗？

```
void FunctionX(Obj * pObj)
{
   pObj->MemberQ->MemberW->MemberA.function1();
   pObj->MemberQ->MemberW->MemberA.function2();
   pObj->MemberQ->MemberW->MemberB.function1();
   pObj->MemberQ->MemberW->MemberB.function2();
   ..
   pObj->MemberQ->MemberW->MemberZ.function1();
   pObj->MemberQ->MemberW->MemberZ.function2();
}

void FunctionY(Obj * pObj)
{
   W * localPtr = pObj->MemberQ->MemberW;
   localPtr->MemberA.function1();
   localPtr->MemberA.function2();
   localPtr->MemberB.function1();
   localPtr->MemberB.function2();
   ...
   localPtr->MemberZ.function1();
   localPtr->MemberZ.function2();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T23:13:21.400

如果没有任何成员指针是 volatile 或指向 volatile 的指针，并且您没有`operator ->`为链中的任何成员重载，则两个函数都是相同的。您建议的优化规则被广泛称为通用表达式消除，几十年来绝大多数编译器都支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T23:14:08.170

理论上，您节省了额外的指针取消引用，但是，在现实世界中，编译器可能会为您优化它，所以这是一个无用的优化。

这就是为什么重要的是首先进行分析，然后再进行优化。编译器正在尽其所能帮助您，您不妨确保您不只是在做它已经在做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T23:14:50.213

如果编译器足够好，它应该将 functionX 转换为类似于 functionY 的东西。但是您可以在不同的编译器和具有不同优化标志的同一编译器上得到不同的结果。使用“哑”编译器函数应该更快，恕我直言，它更具可读性和编码速度。所以坚持使用功能Y

附言。你应该看看一些代码风格指南，通常成员和函数名应该总是以小写字母开头

# apache - Tomcat PersistenceManager：设置 minIdleSwap / maxIdleSwap 值的用例是什么？

> ID：12416060
> 
> 赞同：1
> 
> 时间：2012-09-13T23:07:22.213
> 
> 标签：apache, session, tomcat, tomcat7, persistence-manager

今天刚了解了tomcat PersistenceManager。我正在研究为什么我的声明式安全模型在配置了 PersistenceManager 的开发和生产服务器上的登录超时 1 分钟，但在其他两个没有配置 PersistenceManager 的服务器上却没有。

我发现将 maxIdleSwap 从“30”更改为“3600”并添加“1800”的 minIdleSwap 会导致超时为 30 分钟，就像我希望的那样（在 web.xml 中设置）。

所以，在试图确定为什么原来的管理员会这样设置时，我做了一些研究，但我无法确定意图是什么。

我想问：希望 Tomcat 会话每 30 秒保存到磁盘有哪些可能的用例？请注意，当 tomcat 关闭并重新启动时，持久性管理器会自动将会话持久化到磁盘（除非您手动告诉它不要这样做）。

也许这会让我对为什么以这种方式设置有一些了解。到目前为止，我对该问题的所有研究都让我相信大多数人都将其设置为默认值，即禁用 min 和 max IdleSwap，尽管我见过一些人们将这些值设置为 0 的情况，这样每个请求导致会话的持久性。

谢谢。

# iphone - UITabBarController 的 UINavigationController 类型的第一个视图不太正确

> ID：12416061
> 
> 赞同：0
> 
> 时间：2012-09-13T23:07:24.200
> 
> 标签：iphone, objective-c, xcode

所以我有一个UITabBarController 作为我的应用程序中的一个视图，它的第一个选项卡是一个UINavigationController。我在这个视图中有一个按钮，可以将另一个自定义视图推送到堆栈上：

```
myViewController *vc = [[myViewController alloc] init];
[self pushViewController:myOtherView animated:YES]; 
```

该类`myViewController`具有应该在两者内部发生的事情`-viewDidLoad`，`-viewDidAppear:(BOOL)animated`但是如果我在 UITabBarController 视图出现后立即点击我的按钮，那么这些方法似乎都没有被调用。甚至更奇怪的是，当我点击“返回”时，视图并没有消失，而是堆栈中它下面的视图只是弹回原位。

但是，如果我转到选项卡栏中的另一个选项卡，然后返回到第一个选项卡，然后再次点击我的按钮，我的自定义视图控制器动画进入，`-viewDidAppear:(BOOL)animated`被调用，并且它在点击“返回”时动画出视图应该。不幸的是，`-viewDidLoad`从未调用过。

我真的很想摆脱对所有事情都使用 Interface Builder 的做法；我想纯粹以编程方式创建这个视图控制器，但这些奇怪的问题并没有帮助。谁能想到这种奇怪行为的原因？

编辑：即使我通过 IB 创建我的视图控制器，这种行为仍然会发生。这是怎么回事？我需要对 UITabBarController 做些什么吗？

编辑#2：这是我希望我的观点设置的方式：

*   UITabBar 控件
    *   选项卡 1：UINavigationController
        *   UIViewController 被压入堆栈
            *   UIViewController 被压入堆栈
            *   等（可能更多的 UIViewControllers）
    *   选项卡 2：UIViewController
    *   选项卡 3：UINavigation 控制器
        *   UIViewController 被压入堆栈
            *   UIViewController 被压入堆栈

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T23:28:52.287

你没有说什么样的对象包含你发布的代码，但是，如果它正在处理一个按钮动作，它可能是一个由你的导航控制器管理的自定义视图控制器。如果这是真的，那么你会想要`[self.navigationController pushViewController:myOtherView animated:YES];`.

（如果`self`是其他类型的对象或`self.navigationController`为 nil，那么您需要添加有关当前视图控制器结构的更多详细信息。）

# iphone - 取消隐藏视图时 becomeFirstResponder 会减慢应用程序的速度

> ID：12416065
> 
> 赞同：4
> 
> 时间：2012-09-13T23:07:35.697
> 
> 标签：iphone, ios, uitextfield, becomefirstresponder

这是对这个问题的一种跟进：[becomeFirstResponder 减慢应用程序的速度](https://stackoverflow.com/questions/5631095/becomefirstresponder-slows-down-app)

我遇到了与该海报相同的问题，即调用 becomeFirstResponder 似乎会减慢我的应用程序的速度（它可能会挂起 1-2 秒）。然而，虽然他们在显示警报的同时调用它，但我只是试图取消隐藏隐藏视图并让它与某个字段一起显示为第一响应者。就像是：

```
[self.dialogView setHidden:NO];
[self.dialogText becomeFirstResponder]; 
```

dialogView 有一个层次结构，其中包含 dialogText（我试图设置为第一响应者的 UITextField）和其他一些项目。

这种缓慢*仅*在第一次执行此代码时出现，即我们第一次尝试打开此对话框时。在随后的尝试中，没有明显的缓慢（我认为这是因为 dialogText 在那时已经是第一响应者 - 我没有在任何地方使用 resignFirstResponder ？）。

编辑：这里有一些额外的上下文代码，但不确定它是否真的会更清楚。注意我现在正在动画这个对话框视图的取消隐藏，但是行为没有什么不同。我也已经将 becomeFirstResponder 调用移到完成块中（未反映在此处的代码中），这样至少对话框的出现不会延迟，但是在对话框出现和键盘出现之间仍然存在延迟。

```
- (IBAction)showEditDialog:(id)sender
{    
    [UIView animateWithDuration:0.3f animations:^() {
        self.maskView.alpha = 0.8;
        self.editDialogView.alpha = 1.0;
    } completion:^(BOOL finished) {
        if (finished) {
        }
    }];

   [self.editDialogText becomeFirstResponder];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T22:07:05.730

firstly, are you doing view switching?(e.g view1(hide)->view2(unhide))

If you having your dialogText(which I guess is a textfield?) on a different view, I suggest you do:

```
[self.view bringSubviewToFront:view2]; 
```

first

It's hard to guess what slows it down without looking at how your views are allocated and where your textView or textField are sitting on.

# android - 在Android中实现方法回调

> ID：12416075
> 
> 赞同：8
> 
> 时间：2012-09-13T23:09:18.187
> 
> 标签：android, callback

目前在我的项目中，我正在发出 Http 请求，我希望将不同的 http 响应发送到不同的回调方法。

我在下面写了一个快速示例来展示我想要做什么。我知道这可能不会像我想要的那样，但是有没有什么干净的解决方案可以实现同样的目标？

样本：

活动课：

```
public class Main extends Activity{  
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Services service = new Services();
        service.login("user", "password", **onLoginComplete()** );
    }

    public void onLoginComplete(String HTTPResponse){
        // Do something with the response
    }
} 
```

服务等级：

```
public class Services{  

    public void login(String user, String password, CALLBACK){
        Request request = createLoginRequest(user, password);
        sendRequest(request, CALLBACK);
    }

    public class sendRequest extends AsyncTask{
        @Override
        protected Object doInBackground(Object... params) {
             // Do Http Request
             // Get Response
             CALLBACK(response);
        } 
    }
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-13T23:14:28.217

```
interface OnLoginCompleteListener {
    void onLoginComplete(String response);
} 
```

And then

```
public void login(String user, String password, OnLoginComplete listener) {
    mOnCompleteListener = listener;
} 
```

and

```
protected Object doInBackground(Object... params) {
    mOnCompleteListener.onLoginComplete(response);
} 
```

and finally

```
service.login("user", "password", new OnLoginCompleteListener() {
    public void onLoginComplete(String response) {
        // Handle your response
    }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-03-31T00:54:19.060

我想我遇到了和你一样的问题。

我正在寻找一个好的答案，这是对我有用的实现：

首先创建一个包含您的方法的接口；在我的情况下，我使用典型的`onSuccess`，`onFailure`但你可以制作自己的方法：

```
//MyInterface.java

public interface MyInterface
{
    void onSuccess(String response);
    void onFailure(String response);
} 
```

然后创建类`Services`：

```
//Services.java

公共类服务
{
    公共无效登录（字符串用户，字符串密码，MyInterface myInterface）
    {
        请求请求 = createLoginRequest(user, password);

        if(/*请求成功*/)
            myInterface.onSuccess("登录成功");

        别的
            myInterface.onFailure("登录失败");
    }
}

```

最后调用你的方法`Activity`：

```
//main.java

公共类 Main 扩展 Activity
{  
    @覆盖
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        服务服务 = 新服务（）；
        service.login("用户", "密码", new Myinterface()
        {
            @覆盖
            公共无效 onSuccess（字符串响应）
            {
                Toast.makeText(getApplicationContext(), 响应, Toast.LENGTH_SHORT).show();
            }

            @覆盖
            公共无效onFailure（字符串响应）
            {
                Toast.makeText(getApplicationContext(), 响应, Toast.LENGTH_SHORT).show();
            }
        });
    }
}

```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-09T00:33:26.730

如果我对您的理解正确，建议您通过使用 AsyncTask 来完成您想要实现的目标。这里以非常简单的方式解释了 [http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

此外，我分享了一个示例，说明我如何执行（doInBackground）对站点的 GET 请求，然后我读取了结果（onPostExecute）......希望对您有所帮助！

```
protected InputStream doInBackground(String... example) {
    JsonComm jc = new JsonComm();
    String baseUrl = "http://www.somewhere.com/get_request.php?data=";
    String jcString = jc.encodeJSON("nowyou","seeme");
    String url = "";

    try {
        url = baseUrl + URLEncoder.encode(jcString, "UTF-8");
    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    }

    HttpResponse response;
    HttpClient httpClient = new DefaultHttpClient();
    HttpGet request = new HttpGet(url);
    try {
        request.setHeader("Accept", "application/json");
        request.setHeader("Content-type", "application/json");
        response = httpClient.execute(request);
    } catch (Exception ex) {
        // handle exception here
    }finally {
        httpClient.getConnectionManager().shutdown();
    }
    return response.getEntity().getContent();
}

protected void onPostExecute(InputStream is) {
    BufferedReader reader = new BufferedReader(new InputStreamReader(is));
    StringBuilder sb = new StringBuilder();

    String line = null;
    try {
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        try {
            is.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
     System.out.println(sb.toString());

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T23:14:58.810

There are several ways you can handle this. You could pass in a `Runnable` for your callback or you could provide a method to override in your `Services` class and use an anonymous class derived from `Services` in your main activity. If you need to pass in a parameter, you could also define an interface for something equivalent to the `Runnable` where you can define a method with a response parameter.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T23:16:16.933

How to implement callbacks in java:

```
public interface SomeCallbackInterface {
    public void finished(Request req);
} 
```

Then in your class you do:

```
YourReqeust.instantiateWithCallback(new SomeCallbackInterface() {
   @Override
   public void finished(Request req){
      // do something here
   }
}); 
```

This pretty much the same thing your do with any `View.OnClickListener`

# r - 抑制 R 中的安装输出

> ID：12416076
> 
> 赞同：12
> 
> 时间：2012-09-13T23:09:18.593
> 
> 标签：r, suppressmessage

这真的开始困扰我......我尝试了一些方法，但似乎都没有工作

我正在从一个函数运行安装，该函数会生成许多我想抑制的不必要的消息，但是我尝试执行此操作的所有方法都没有奏效。

我试图抑制的代码是 : `install_github('ROAUth', 'duncantl')`，它需要`devtools`预先加载包。

无论如何，我尝试了`invisible`，`capture.output`并且`sink`，其中没有一个工作......或者我没有正确使用它们......无论哪种方式......有什么想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-14T04:33:21.053

`suppressMessages` will turn some messages off (those that were printed though calls to `message`), but not all.

The rest of the messages are coming from a shelled out call to `R CMD INSTALL` via the `system2` function. I think it is because this is shelled out that all the usual things you tried (`sink`, `capture.output`, etc.) are not working. Note that the `system2` function comes with `stderr` and `stdout` arguments which, if turned to `FALSE` would turn off all those messages. Unfortunately, `system2` uses `stdout = ""` and `stderr = ""` by default and there seems to be no way to access these arguments through the `devtools` package.

So one way I managed to run without any messages is to temporarily overwrite the `system2` function in the base environment. It's not particularly elegant but it works:

```
# store a copy of system2
assign("system2.default", base::system2, baseenv())

# create a quiet version of system2
assign("system2.quiet", function(...)system2.default(..., stdout = FALSE,
                                                     stderr = FALSE), baseenv())

# overwrite system2 with the quiet version
assignInNamespace("system2", system2.quiet, "base")

# this is now message-free:
res <- eval(suppressMessages(install_github('ROAUth', 'duncantl'))) 

# reset system2 to its original version
assignInNamespace("system2", system2.default, "base") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-20T00:20:26.697

这是另一种可能性。此处的优点是您不必`system2`在调用`install_github`:后重置`system2`将继续对所有调用显示其默认行为，但由调用发起的调用*除外*`install_github()`：

```
# store a copy of system2
assign("system2.default", base::system2, baseenv())

# create a quiet version of system2
assign("system2.quiet", function(...)system2.default(..., stdout = FALSE,
                                                     stderr = FALSE), baseenv())
# redefine system2 to use system2.quiet if called from "install_github"
assignInNamespace("system2",
    function(...) {
        cls <- sys.calls()
        from_install_github <- 
            any(sapply(cls, "[[", 1) == as.name("install_github"))
        if(from_install_github) {
            system2.quiet(...)
        } else {
            system2.default(...)
        }},
    "base")

## Try it out
library(devtools)
suppressMessages(install_github('ROAUth', 'duncantl')) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-19T16:48:15.843

另一种技术是修补`devtools`函数，以便它们允许您将`stdout`参数传递给`system2`. 也不是很优雅，但也许你可以说服包作者以`devtools`这种方式进行修改。这是我的补丁`build`和`install`功能：

```
library(devtools)

# New functions.
my.install<-function (pkg = ".", reload = TRUE, quick = FALSE, args = NULL, ...) 
{
    pkg <- as.package(pkg)
    message("Installing ", pkg$package)
    devtools:::install_deps(pkg)
    built_path <- devtools:::build(pkg, tempdir(),...) # pass along the stdout arg
    on.exit(unlink(built_path))
    opts <- c(paste("--library=", shQuote(.libPaths()[1]), sep = ""), 
        "--with-keep.source")
    if (quick) {
        opts <- c(opts, "--no-docs", "--no-multiarch", "--no-demo")
    }
    opts <- paste(paste(opts, collapse = " "), paste(args, collapse = " "))
    devtools:::R(paste("CMD INSTALL ", shQuote(built_path), " ", opts, sep = ""),...) # pass along the stdout arg
    if (reload) 
        devtools:::reload(pkg)
    invisible(TRUE)
}

my.build<-function (pkg = ".", path = NULL, binary = FALSE, ...) 
{
    pkg <- as.package(pkg)
    if (is.null(path)) {
        path <- dirname(pkg$path)
    }
    if (binary) {
        cmd <- paste("CMD INSTALL ", shQuote(pkg$path), " --build", 
            sep = "")
        ext <- if (.Platform$OS.type == "windows") 
            "zip"
        else "tgz"
    }
    else {
        cmd <- paste("CMD build ", shQuote(pkg$path), " --no-manual --no-resave-data", 
            sep = "")
        ext <- "tar.gz"
    }
    devtools:::R(cmd, path, ...) # pass along the stdout arg
    targz <- paste(pkg$package, "_", pkg$version, ".", ext, sep = "")
    file.path(path, targz)
}

# Patch package.
unlockBinding("install", as.environment("package:devtools"))
unlockBinding("build", as.environment("package:devtools"))
assignInNamespace('install', my.install, ns='devtools', envir=as.environment("package:devtools"));
assignInNamespace('build', my.build, ns='devtools', envir=as.environment("package:devtools"));
lockBinding("install", as.environment("package:devtools"))
lockBinding("build", as.environment("package:devtools"))

# Run with no messages.
suppressMessages(install_github('ROAUth','duncantl',stdout=NULL)) 
```

本质上，你在三个地方传递了`...`，两次在`install`函数中，一次在`build`函数中。

# python - 从python json转储在Mysql中插入json

> ID：12416078
> 
> 赞同：-1
> 
> 时间：2012-09-13T23:09:38.857
> 
> 标签：python, mysql, json

我无法将此查询插入 mysql。我做了一个 json.dump()。我尝试了文本和blob。我尝试打开和关闭引号。

```
INSERT INTO mytable (campaign_object) 
VALUES ( {"cpa_type": "null", "device_tablets": "True",
 "language": "all", "end_date": null, "bid": "1", "budget": "1", "goal_type": "ctr",
 "frequency": "null", "location": "all", "device_mobile": "True", "device_desktop": 
"True", "impressions": "null", "campaign_name": "1", "start_date": "2012-09-14", 
"insert_date": "2012-09-13 23:00:1347548413"}) 
```

所以...我不得不想象 MyhSQL 可以处理 json。我真的很想泡菜。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T23:12:06.053

始终使用参数化查询。

```
value = '''{"cpa_type": "null", "...0:1347548413"}'''
cursor.execute("INSERT INTO mytable (campaign_object) VALUES (%s)", (value,)) 
```

这样您就可以避免转义 json，并且可以避免 SQL 注入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T23:15:15.423

看你说的句柄是什么意思。

MySQL 不将 JSON 理解为一种数据类型。但是您可以将 JSON 表达式存储为字符串。

我假设该列`campaign_object`被声明为一个字符串，如下所示：

```
CREATE TABLE mytable (
  campaign_object NVARCHAR(8000)
); 
```

在这种情况下，您必须将整个 JSON 字符串括在单引号中，如下所示：

```
INSERT INTO mytable (campaign_object) 
VALUES ( '{"cpa_type": "null", "device_tablets": "True",
 "language": "all", "end_date": null, "bid": "1", "budget": "1", "goal_type": "ctr",
 "frequency": "null", "location": "all", "device_mobile": "True", "device_desktop": 
"True", "impressions": "null", "campaign_name": "1", "start_date": "2012-09-14", 
"insert_date": "2012-09-13 23:00:1347548413"}') 
```

否则，MySQL 将抱怨一条神秘的消息，因为它试图将原始 JSON 解释为 SQL。当我尝试使用我的 table 定义在[SQL Fiddle](http://sqlfiddle.com/#!2/d2fad)`mytable`中执行您的示例时，我看到此错误：

> 架构创建失败：列计数与第 1 行的值计数不匹配：

# jquery - 使用 jqueryui selectable 我的小提琴有什么问题

> ID：12416080
> 
> 赞同：0
> 
> 时间：2012-09-13T23:09:39.543
> 
> 标签：jquery, jquery-ui, selectable

嗨，我有一个非常简单的小提琴来了解如何使用 jqueryui 可选：

[http://jsfiddle.net/hvqz7/](http://jsfiddle.net/hvqz7/)。

但是它看起来不起作用。有谁知道它有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T23:13:38.967

Your last line in the CSS should be:

```
#container .ui-selected { background: #F39814; color: white; } 
```

Working fiddle:

[http://jsfiddle.net/U8XsX/](http://jsfiddle.net/U8XsX/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T23:14:02.880

Your CSS is wrong.

Change this:

```
#selectable .ui-selected { background: #F39814; color: white; } 
```

To this:

```
#container .ui-selected { background: #F39814; color: white; } 
```

### [DEMO](http://jsfiddle.net/x26My/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T23:13:26.590

# java - 在程序之外捕获 KeyEvent

> ID：12416083
> 
> 赞同：2
> 
> 时间：2012-09-13T23:09:49.840
> 
> 标签：java, keyboard

我想知道是否有办法在我的 Java 程序之外捕获 KeyEvent。我知道使用普通的 Java，您只能捕获 Java 程序中的 KeyEvent。根据我在不同论坛上所读到的内容，我认为在您的程序之外捕获 KeyEvents 都是基于操作系统的，但如果这对任何人都有帮助，我正在使用 Windows 7。如果有人知道如何实现这一点，请回复，如果您不介意链接，教程或示例会很棒。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:17:59.303

这个问题可能会有所帮助：

[Java 键盘/鼠标活动（甚至在我的应用程序之外）](https://stackoverflow.com/questions/3490469/java-keyboard-mouse-activity-even-outside-of-my-app)

它不是完全重复的，因为它只是想知道是否有关键事件，但它给了你一个关于做什么的指针：

使用 JNI。

* * *

此外：

[问题http://www.jotschi.de/?p=90](http://www.jotschi.de/?p=90)中的链接中的代码在Windows 7/Vista 中不起作用，但有一个更新的版本：

[http://ksquared.de/blog/2011/07/java-global-system-hook/](http://ksquared.de/blog/2011/07/java-global-system-hook/)

而这个，我认为（我没有深入研究它）是一个很好的教程。

它有你需要的所有代码。

# php - AJAX 在 PHP MVC 中的位置？

> ID：12416089
> 
> 赞同：1
> 
> 时间：2012-09-13T23:10:41.757
> 
> 标签：php, ajax, model-view-controller

我调用的 AJAX 文件应该驻留在典型的 PHP MVC 框架中的什么位置？

这是逻辑，所以我假设模型文件夹，但同时它充当控制器功能的一部分？

谢谢！

* * *

感谢所有回复，尤其是 zerkms。

JS 将构成视图的一部分，它将 AJAX 请求一个 URL。URL 将是一个独立的控制器（可能本身就是一个 AJAX 控制器），它将为 JS 提供它的数据源。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-13T23:11:54.847

它是*表示*逻辑，所以它属于表示，`View`部分。

而`Model`层代表*业务*逻辑。

# ios - 如何在 iOS 的视图控制器中正确处理数据的持久性和状态警报

> ID：12416094
> 
> 赞同：0
> 
> 时间：2012-09-13T23:11:22.180
> 
> 标签：ios, rest, asynchronous, uitextview

我在 iOS 应用程序中有 2 个文本视图，用于更新用户密码。在用户单击确认按钮后，我正在使用 RESTful Web 服务将数据保存到远程数据库。

如果传输出现问题或输入数据在服务器端验证失败，我该如何与用户沟通？

在这个及时的过程继续进行时，我不想让用户等待。我想让服务异步并提醒用户状态，即使他们点击了另一个视图。

我将如何做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:38:38.437

将请求委托设置为您的 UIApplication 委托

在使用 ASIHTTPRequest 的情况下，使用您的失败消息设置 userInfo 字典

```
ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:@""];
[request setUserInfo:[NSDictionary dictionaryWithObject:@"Password reset failed" forKey:@"failureAlertMessage"];
[request setDelegate:[[UIApplication sharedApplication] delegate]]; 
```

使您的 UIApplication 委托符合请求委托协议（例如，ASIHTTPRequestDelegate）

在 UIApplication 委托中，使用请求中包含的信息来显示错误消息

```
- (void)requestFailed:(ASIHTTPRequest *)request
{
    if([[request userInfo] objectForKey:@"failureAlertMessage"]){
        //Do the alert
    }
} 
```

# iphone - UITableView 之上的 UIWebView - 如何在它们之间切换？

> ID：12416095
> 
> 赞同：1
> 
> 时间：2012-09-13T23:11:22.493
> 
> 标签：iphone, uitableview, uiwebview, show-hide, user-interaction

好的，我有一种情况，用户在我的应用程序中查找一个单词。关于单词的静态信息显示在屏幕的顶部 1/3。用户可以在屏幕底部 2/3 看到更多关于这个词的信息。此信息通过两个不同的视图显示...

第一个视图是显示用户活动的 UITableView，另一个是在 Internet 上查找单词的 UIWebView。我只是将 UIWebView 放在 UITable 视图的顶部，当用户按下按钮时，我只是隐藏/取消隐藏 UIWebView。

一切都很好，除了任何用户交互始终与 UIWebView 交互，即使它被隐藏，所以用户无法在现在可见的 UITableView 中滚动。

有没有一种简单的方法可以“停用” UIWebView，从而允许用户在隐藏在下面的 UITableView 中滚动？

现在的相关代码是：

```
- (IBAction)pressDictionaryTab:(id)sender {
    webView.hidden = NO;
}

- (IBAction)pressHistoryTab:(id)sender {
    webView.hidden = YES;
} 
```

干杯:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T05:13:05.563

除了隐藏，可以试试sendSubviewToBack，像这样：

```
- (IBAction)pressDictionaryTab:(id)sender {
    webView.hidden = NO;
    tableView.hidden = YES;
    [self.view sendSubviewToBack:tableView];
}

- (IBAction)pressHistoryTab:(id)sender {
    webView.hidden = YES;
    tableView.hidden = NO;
    [self.view sendSubviewToBack:webView];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T23:22:33.173

从 UIWebView 文档：

> 重要您不应该在 UIScrollView 对象中嵌入 UIWebView 或 UITableView 对象。如果这样做，可能会导致意外行为，因为两个对象的触摸事件可能会混淆并错误处理。

如果您在 iPhone 下，请使用 Web 视图推送一个新的视图控制器。在 iPad 下，在 UIPopoverController 中显示一个小的视图控制器。

# c# - SSIS - 用于日期格式化的脚本组件 - VB.NET/C#

> ID：12416097
> 
> 赞同：0
> 
> 时间：2012-09-13T23:11:42.567
> 
> 标签：c#, sql, vb.net, ssis

所以我有一种情况，（通过 SSIS）我基本上对我的数据库运行 SELECT，然后将结果导出到 .txt 平面文件。

SSIS流程如下：OLEDB SOURCE (my select query) -> DATA CONVERSION (change all values to DT_WSTR) -> FLAT FILE DESTINATION

但是，有人告诉我，我需要将导出的所有日期时间列值的格式从`yyyy-mm-dd hh:nn:ss`（数据库中的格式）更改为`mm/dd/yyyy hh:nn:ss AM/PM`

从我对这个主题的搜索中，我相信我的 DATA CONVERSION 和 FLAT FILE DESTINATION 之间的脚本组件是我在 SSIS 中所需要的……但我没有任何 VB.NET 或 C# 技能。尽管进行了搜索，但我还没有真正理解如何对这种日期格式转换进行编码。

帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T23:36:49.900

您可以在 SELECT 语句中进行转换。

这将使您接近：

```
SELECT CONVERT(VARCHAR(20),GetDate(),101) + ' ' 
+ LTRIM(RIGHT(CONVERT(VARCHAR(26),GetDate(),9),14)) 
```

只需将 GetDate() 替换为您的日期字段。如果你需要它而不需要纳秒，它会更长一点：

```
SELECT CONVERT(VARCHAR(20),GetDate(),101) + ' ' 
+ LTRIM(LEFT(RIGHT(CONVERT(VARCHAR(26),GetDate(),9),14),8)) + ' ' 
+ RIGHT(CONVERT(VARCHAR(26),GetDate(),9),2) 
```

# ruby-on-rails - 当我以这种方式使用 FactoryGirl 时，为什么我的测试会失败？

> ID：12416105
> 
> 赞同：2
> 
> 时间：2012-09-13T23:12:23.553
> 
> 标签：ruby-on-rails, ruby-on-rails-3, factory-bot, rspec-rails

我正在测试我的用户模型并研究 FactoryGirl 的工作原理。当我在我的**user_spec.rb**中执行此操作时：

```
before(:each) do
  @user = User.new(username: 'ExampleUser', email: 'user@example.com', timezone: 'Eastern Time (US & Canada)', password: 'example')
end 
```

一切都会过去，但如果我这样做：

```
before(:each) do
  @user = FactoryGirl.create(:user)
end 
```

它未能通过测试来查看用户的用户名和电子邮件是否已被使用。

```
1) User when username is already taken
     Failure/Error: it { should_not be_valid }
       expected valid? to return false, got true
     # ./spec/models/user_spec.rb:151:in `block (3 levels) in <top (required)>'

  2) User when email address is already taken
     Failure/Error: it { should_not be_valid }
       expected valid? to return false, got true
     # ./spec/models/user_spec.rb:142:in `block (3 levels) in <top (required)>'

Finished in 1.8 seconds
29 examples, 2 failures 
```

这些是测试：

```
 describe 'when email address is already taken' do
    before do
      user_with_same_email = @user.dup
      user_with_same_email.email = @user.email.upcase
      user_with_same_email.save
    end
    it { should_not be_valid }
  end

  describe 'when username is already taken' do
    before do
      user_with_same_username = @user.dup
      user_with_same_username.username = @user.username.upcase
      user_with_same_username.save
    end
    it { should_not be_valid }
  end 
```

有人可以解释吗？我认为 FactoryGirl 应该让我像使用它一样使用它`User.new`，这是我的第一个有效示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:43:02.093

`FactoryGirl.create`实际创建记录，而`User.new`仅实例化模型但不实际保存记录。

如果你只想实例化模型，你应该使用`FactoryGirl.build`：

```
before(:each) do
  @user = FactoryGirl.build(:user)
end 
```

有关详细信息，请参阅[文档](https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md)。

所以我认为您当前的代码正在发生的事情是，当您使用 创建用户时`FactoryGirl.create`，它实际上保存了没有验证问题的记录（因为尚未创建副本）。当您使用相同的电子邮件保存用户时`user_with_same_email.save`，它实际上并没有保存该用户，但您看不到。然后，当您检查原始用户是否有效时，它会说是，因为您在尝试（并且失败）创建副本之前已经保存了它。

有道理？无论如何，只需切换到`FactoryGirl.build`两个测试都应该通过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T02:40:37.010

通常，在使用 Factory Girl 测试字段时，`validates_uniqueness_of`最好使用[sequence](https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md#sequences)。

使用序列时，每次创建记录时`FactoryGirl.create(:user)`，用户名始终是唯一的。这允许您使用数据库中的“真实”记录，而无需手动更正冲突值。

```
factory :user do
  sequence :username do |n}
    "user_#{n}"
  end
end 
```

**注意：**我不喜欢测试尚未添加到数据库中的记录的想法。我想不出任何可靠的理由来说明这会是一个问题。我能想到的唯一问题是您将无法测试关联。

* * *

我一直注意到您的问题的另一件事是您使用`before`块并创建实例变量。在 RSpec 中有一个方法调用`let`将在需要时创建变量。

这将使您的`user_spec.rb`文件像这样工作。

```
describe User do
  let(:user) { create(:user, :first_name => "John", :last_name => "Doe") }

  it "should get full name" do
    user.full_name.should == "John Doe"
  end
end 
```

`let`还有一个 bang 方法，无论它是否在`it`块中使用，它都会创建变量。

# symfony - Symfony2 中的身份验证无法读取密码

> ID：12416111
> 
> 赞同：1
> 
> 时间：2012-09-13T23:13:11.820
> 
> 标签：symfony

在使用 Symfony 几年后，我正在编写我的第一个 Symfony2 应用程序，并且在转换我们的用户管理代码时遇到了麻烦。似乎为了适应 Symfony2 的身份验证模型，我必须提供用户详细信息，包括他们的（加密的）密码。我们通过网络服务进行身份验证，该服务接受用户名和密码，并以确认和用户级别（用户、管理员等）作为响应，但它永远不会将真实密码发送回给我们。

我想要做的是接受表单中的登录详细信息，确认它们是有效的，然后根据 web 服务的响应设置用户的角色。我从哪里开始？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T05:37:23.687

您需要使用自定义身份验证提供程序来针对您的 Web 服务进行身份验证。在这篇博文中解释得很[清楚](http://blog.vandenbrand.org/2012/06/19/symfony2-authentication-provider-authenticate-against-webservice/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T06:15:22.337

您可以创建一个用户提供程序，并且`loadUserByName`您可以调用 Web 服务。如果成功，则返回`UserInterface`带有空盐字符串形式的密码和服务返回的角色的新对象。还将 中的编码器设置`UserInterface`为纯文本`security.yml`。`form_login`然后在防火墙的 auth provider 中设置新创建的用户提供者。

# jquery - 哪个元素正在滚动？

> ID：12416114
> 
> 赞同：1
> 
> 时间：2012-09-13T23:13:22.010
> 
> 标签：jquery, html-select, jquery-events

我正在制作自定义选择框，我需要一种方法来以编程方式检测正在滚动的几个框。

我试图`<select>`在 size > 1 时模拟该功能。也就是说，如果您点击 [up:38] 或 [down:40] 在列表中选择适当的项目。

我的小提琴我正在使用[http://jsfiddle.net/GtA8v/52/](http://jsfiddle.net/GtA8v/52/)

现在，由于事件已附加到正文，我如何知道正在滚动哪些“.wrap”元素（希望在滚动之前，以便我可以在需要时停止事件）？

编辑：我更新了 Jfiddle，如果你看我只有占位符正在滚动“包装”，一旦我可以弄清楚收到哪个“包装”，它将按预期工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T23:25:34.480

您可以简单地使用该[`scroll`](http://api.jquery.com/scroll/)事件来确定哪些元素正在滚动。例子：

```
$('.wrap').scroll(function() {
    console.log($(this));
}); 
```

[**演示**](http://jsfiddle.net/GtA8v/30/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:29:57.137

UUUUUGGGGGLLLLLYYY 但它有效，我记下何时聚焦包装元素，然后当调用 selectNext() 函数时，我只是引用它。我将暂时将此作为不可接受的答案，看看是否有人知道如何通过查看事件对象来确定它，但这是一个有效的解决方案。

[http://jsfiddle.net/GtA8v/66/](http://jsfiddle.net/GtA8v/66/)

# regex - 正则表达式否定前瞻

> ID：12416119
> 
> 赞同：1
> 
> 时间：2012-09-13T23:13:29.840
> 
> 标签：regex

在 RE 不太熟悉。我有以下字符串

```
"The cat jump The cat ran The cat eat The dog jump The dog ran The dog eat". 
```

我想得到

```
"The cat ran" and "The dog ran". 
```

我认为这个使用负面展望的 RE 应该可以工作

```
"The(?!.*The).*jump" 
```

但事实并非如此。什么不见​​了？

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:16:46.313

以下内容会为您做吗？

```
The \w* ran 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T03:39:12.703

似乎您想要一个与不包含的子字符串匹配的表达式`The`。这可以`(?:(?!The).)*`在您的表达式中使用类似 , 的构造来完成：

```
The(?:(?!The).)*jump 
```

请注意，在这种情况下，使用惰性 ( `.*?`) 量词就足够了，例如：

```
The.*?jump 
```

也许这也可以解决您原来的问题。

# python - 使用线程更新 Heroku 上的数据库？

> ID：12416120
> 
> 赞同：2
> 
> 时间：2012-09-13T23:13:32.700
> 
> 标签：python, django, multithreading, heroku

创建一个要部署在 Heroku 上的小型 Web 应用程序，我们希望在用户单击更新按钮时更新数据库中的条目。每天，我们都会自动检查并更新过去 24 小时内某些用户未更新的所有条目。

更新功能和web应用是用django写的，但是因为更新涉及到向另一个网站发出请求，需要几秒钟的时间来处理，我当时在考虑让这些请求并行执行，所以多个用户可以点击不同的更新按钮，并让它快速通过。

我们正在考虑使用 Heroku 上的调度程序进行 24 小时更新，但是我们可以将线程应用程序/实现用于这种用例吗？任何提示都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T03:47:42.517

[芹菜](https://github.com/celery/django-celery/)非常适合这样的计划任务。[我在这里](https://gist.github.com/1004844)找到了一个在 Heroku 上设置工作人员的技巧，虽然我没有使用 Heroku，所以你自己在那里。

芹菜的用法看起来很简单：

```
@celery.task
def do_costly_database_update(some_data):
    # do stuff
    pass

# And then in a view...
do_costly_database_update.delay(some_data) 
```

编辑：Celery 还使用如下配置条目处理重复任务，例如您的夜间更新：

```
'every-night': {
    'task': 'tasks.do_costly_database_update',
    'schedule': crontab(hour=0, minute=0),
    'args': some_data,
}, 
```

所有的 Celery[文档](http://docs.celeryproject.org/en/latest/index.html)都非常好。

# mysql - How to handle a specific foreign key error in stored procedure?

> ID：12416135
> 
> 赞同：1
> 
> 时间：2012-09-13T23:15:07.357
> 
> 标签：mysql, stored-procedures

Let's say I have following table structure:

users:

```
id INT(10) 
```

posts:

```
id INT(10) 
```

users_posts:

```
user_id (FOREIGN KEY [fk_up_1]: users.id)
post_id (FOREIGN KEY [fk_up_2]: posts.id) 
```

Then, I create a procedure like this:

```
CREATE PROCEDURE sp_user_add_post(v_user_id INT(10), v_post_id INT(10))
BEGIN
    DECLARE EXIT HANDLER FOR 1452 RESIGNAL SET MESSAGE_TEXT = "Invalid user_id or post_id";
    DECLARE EXIT HANDLER FOR SQLEXCEPTION RESIGNAL;

    INSERT INTO `users_posts` (`user_id`, `post_id`)
        VALUES (v_user_id, v_post_id);
END 
```

**The question:** how can I differentiate between specific FK error conditions? Can I retrieve a name of FK that errored (`fk_up_1` and `fk_up_2` in my example above)? For instance, I might want to log an error somewhere if invalid user_id is passed, so it can come in handy.

# html - 为什么我不能设置这个标签标签的样式？

> ID：12416136
> 
> 赞同：1
> 
> 时间：2012-09-13T23:15:11.620
> 
> 标签：html, css

无论我做什么，标签标签都不会被我的 CSS 设置样式。

CSS：

```
label {
        font-family: 'Lucida Grande';
    } 
```

HTML：

```
<div class="contact-form">
            <form action="post">
                <label for="name">Name:<input type="text" id="name" class="text" /></label>
                <label for="email">Email:<input type="text" id="email" class="text" /></label>
                <label for="message">Message:<textarea id="message"></textarea></label>
                <input type="submit" class="submit" value="Send Message" />
            </form>
        </div> 
```

你猜怎么了？不是卢西达格兰德。

在这里行动：http: [//christianselig.com/contact.html](http://christianselig.com/contact.html)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T23:29:11.270

也许是因为`reset.css`压倒一切`style.css`？

```
<!-- Stylesheets -->
<link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
<link href="css/reset.css" rel="stylesheet" type="text/css" media="all" /> 
```

选择`label`器包含在此块的第 8 行中`reset.css`：

```
html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed, 
figure, figcaption, footer, header, hgroup, 
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
    margin: 0;
    padding: 0; 
    border: 0;
    font-size: 100%;
    font: inherit; 
    vertical-align: baseline;
} 
```

# python - 无法在鼻子测试中导入 logging.handlers

> ID：12416140
> 
> 赞同：0
> 
> 时间：2012-09-13T23:15:55.267
> 
> 标签：python, importerror, nose

我正在用鼻子编写一个基本测试，以从日志包装器中调用单个函数，但是一旦我发现了测试，我就开始收到标准库模块导入错误。

这是我正在尝试为其编写一些测试的代码，并且已经投入生产并且很长时间没有改变，所以我确信当我尝试使用鼻子时有问题。

```
 Failure: ImportError (cannot import name WatchedFileHandler) ... ERROR

  ======================================================================
  ERROR: Failure: ImportError (cannot import name WatchedFileHandler)
  ----------------------------------------------------------------------
  Traceback (most recent call last):
    File "/opt/local/lib/python2.4/site-packages/nose/loader.py", line 389, in loadTestsFromName
      module = self.importer.importFromPath(
    File "/opt/local/lib/python2.4/site-packages/nose/importer.py", line 39, in importFromPath
      return self.importFromDir(dir_path, fqname)
    File "/opt/local/lib/python2.4/site-packages/nose/importer.py", line 86, in importFromDir
      mod = load_module(part_fqname, fh, filename, desc)
    File "/Users/jolson/project/qworker/tests/unit/test_qscript_log.py", line 2, in ?
      from logging.handlers import WatchedFileHandler, TimedRotatingFileHandler
  ImportError: cannot import name WatchedFileHandler 
```

什么可能导致这种情况？

**更新：** 我已将其简化为以下内容，但测试仍然失败，但在鼻子之外，这一切都按预期工作。

```
from logging.handlers import WatchedFileHandler, TimedRotatingFileHandler

def test_INFO():
    assert 0 == 0 
```

** 更新 2 ** 我检查了我的路径。在鼻子测试中，我的路径看起来像这样。

```
['/Users/jolson/project/qworker/tests', '/Users/jolson/project/qworker',
'/opt/local/bin', '/opt/local/lib/python24.zip', '/opt/local/lib/python2.4', 
'/opt/local/lib/python2.4/plat-darwin', '/opt/local/lib/python2.4/plat-mac', 
'/opt/local/lib/python2.4/plat-mac/lib-scriptpackages', '/opt/local/lib/python2.4/lib-tk',
 '/opt/local/lib/python2.4/site-packages/readline', '/opt/local/lib/python2.4/lib-dynload', 
'/opt/local/lib/python2.4/site-packages', '/opt/local/lib/python2.4/site-packages/setuptools-0.6c11-py2.4.egg-info'] 
```

但我在 python 解释器中的正常路径是

```
['', '/usr/local/bin', '/Library/Python/2.7/site-packages/pip-1.2.1-py2.7.egg', 
'/Library/Python/2.7/site-packages/virtualenv-1.8.2-py2.7.egg', 
'/Library/Python/2.7/site-packages/virtualenvwrapper-3.6-py2.7.egg', 
'/Library/Python/2.7/site-packages/stevedore-0.3-py2.7.egg', 
'/Library/Python/2.7/site-packages/virtualenv_clone-0.2.4-py2.7.egg',
 '/Library/Python/2.7/site-packages/distribute-0.6.28-py2.7.egg', 
'/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip', 
'/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7', 
'/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin', 
'/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac', 
'/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages', 
'/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python', 
'/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk', 
'/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old', 
'/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload', 
'/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/PyObjC', 
'/Library/Python/2.7/site-packages', '/Library/Python/2.7/site-packages/setuptools-0.6c11-py2.7.egg-info', 
'/Library/Python/2.7/site-packages/IPython/extensions'] 
```

我在跑`nosetests-2.4 tests`

其中有一个文件`tests/unit/test_log.py`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:52:56.137

我的操作系统默认`nosetests-2.4`使用 python 2.4，但我们所有的代码都是 python 2.7，所以这就是为什么路径错误并且没有任何工作，而 logging.handlers 只是需要的 2.4 库中缺少的第一个包。

# sitecore - Get the date/time that Sitecore last published

> ID：12416141
> 
> 赞同：4
> 
> 时间：2012-09-13T23:16:16.093
> 
> 标签：sitecore, sitecore6

Simple question, I think: is there a value, either in the API or the Web database, that will tell me the last time content was published using sitecore? It looks like there's an "Updated" column in the "Items" table that might do this, but I'd like to be sure. I don't need to know individual items, just the last time any content was published.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T23:34:08.253

如果（即当且仅当）发布是完整站点发布或增量发布，Sitecore 会将该日期记录到数据库中，并且可以使用从主数据库中检索它

```
Database.Properties.GetLastPublishDate(Database target, Language language) 
```

否则，如果您想要**任何**发布的日期，您可能需要创建一个发布管道处理器以在某处记录该日期。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-13T12:15:34.807

我在寻找类似的东西时遇到了这个。像这样的东西对我有用：

```
public String PostDate()
{
    DateTime postDate = Context.Item.Statistics.Updated;
    return postDate != null ? postDate.ToString("MMMM dd yyyy H:mm:ss tt") : String.Empty;
} 
```

# java - plus() and minus method

> ID：12416143
> 
> 赞同：1
> 
> 时间：2012-09-13T23:16:21.567
> 
> 标签：java

Ok so I am going to try this again. I have a very basic calculator application. I am currently having trouble figuring out how to get my plus() and minus() methods to work. Whenever I run the code, the plus() method is adding currentValue + currentValue. I want it to act like a calculator and add two different integers together. Any suggestions?

```
digitButton(buttons, 0);
JButton plus = new JButton("+");
plus.addActionListener(new ActionListener() {
  public void actionPerformed(ActionEvent e)
  {
    myAccumulator.plus();
    updateDisplay();
  }
});
buttons.add(plus);
return buttons; 
```

this is where it is getting called.

And this is my class that I wrote with my plus () method.

```
public class BasicAccumulator implements Accumulator {

    private int digit;
    private int currentValue;

    public void BasicAccumulator(int digit, int currentValue)
    {
        this.digit = digit;
        this.currentValue = currentValue;
    }

    public void addDigit(int digit)
    {
        currentValue = currentValue * 10 + digit;
    }

    public void plus()
    {
        if (currentValue != 0)
            digit = currentValue;
            currentValue = currentValue + digit;

    }

    public void minus()
    {
        currentValue = currentValue - digit;
    }

    public void clear()
    {
        currentValue = 0;
    }

    public int displayValue()
    {
        return currentValue;
    }

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T23:45:24.177

想想看。在您按 + 时，您可能还没有输入第二个数字。也就是说，如果您的计算器旨在像大多数计算器一样工作......

大概你有以下事件序列..

1.  输入数字：数字进入当前累加器以创建一个数字
2.  按+：数字被存储起来
3.  输入数字，数字累加为1
4.  按=：当前累积的数字加到上一个。

为此，我从概念上将 3 件东西存储在累加器中：

*   'left' 值（等式的左侧） - 即按下 + 后存储的数字
*   当前操作 - 最初没有，但将设置为指示是 + 还是 - 的值。
*   当前的累积值（我称之为“正确”）

所以......最初，`left`是零并且`operation`什么都不是（即“清除”）。

```
State: left(0), operation(empty), right(0) 
```

输入一些数字......这些是在“正确”中建立的。

```
State: left(0), operation(empty), right(22) 
```

按 +。现在，您将任何挂起的操作应用于`left`. 在这种情况下，操作为空，因此您只需复制该值并清除“正确”。然后将操作设置为“+”

```
State: left(22), operation(+), right(0) 
```

您输入更多数字，再次建立`right`.

```
State: left(22), operation(+), right(20) 
```

你再次点击+。现在应用该操作。您添加`right`并`left`清除`right`.

```
State: left(42), operation(+), right(0) 
```

*等等等等*……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T23:34:47.333

这*至少*看起来像是混乱的根源：

```
public void plus()
{
    if (currentValue != 0)
        digit = currentValue;
        currentValue = currentValue + digit;

} 
```

当您添加支撑并修复缩进时，该代码实际上是：

```
public void plus()
{
    if (currentValue != 0)
    {
        digit = currentValue;
    }
    currentValue = currentValue + digit;
} 
```

这真的是你的意图吗？似乎不太可能。如果您希望缩进会影响行为，则应将代码重写为：

```
public void plus()
{
    if (currentValue != 0)
    {
        digit = currentValue;
        currentValue = currentValue + digit;
    }
} 
```

也不清楚*为什么*你首先想要这种行为。正如您上一个问题所要求的那样，如果您编写一个简短但完整的*控制台*应用程序来练习您的课程，以及*预期*行为与*实际*行为的陈述，那将非常有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T23:33:01.890

您`digit`在两个位置使用：作为成员和作为`addDigit`. 前者对我来说似乎没有多大意义。

大多数基本操作`plus`都需要*两个数字*才能处理。您要么必须将其中一个提供给函数调用，要么将它们都存储在您的类中。您可以将现有`digit`成员用于后者，但除非您只想添加个位数，否则我建议您不要使用该名称。

相反，请考虑您的操作顺序是什么。你输入*两个*数字，然后按操作按钮？如果是这样，您需要存储两个数字，例如`value`和`current`。在重置为零之前，将附加数字`current`并且任何类似的操作`plus`都会添加。显示可能应该在每次操作之后反映，但在每个数字之后，因此您需要一些布尔标志来区分这两种情况。`current``value``current``value``current`

如果输入一个数字，然后按操作按钮，然后输入另一个数字（中缀运算符），上面的大多数建议仍然适用，但除此之外，在读取第二个数字时，您需要一些方法来存储操作。您可以使用一些字符、字符串、数字或枚举常量来执行此操作。我个人会使用已经包含计算该操作的指令的枚举常量来执行此操作，但这是非常高级的语法。每次按下操作按钮都会评估先前存储的操作，然后存储新的操作，可能除了“=”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T23:33:14.677

在你的`plus()`你正在做

```
digit = currentValue;
currentValue = currentValue + digit; 
```

对我来说看起来像

```
currentValue = currentValue + currentValue 
```

你应该使用

```
currentValue = currentValue + digit; 
```

只要

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T23:29:25.137

我建议做这样的事情。

```
int plus(int first, int second)
{
   return first + second;
} 
```

这就是这里的问题：

```
digit = currentValue;
currentValue = currentValue + digit; 
```

你设置数字等于 currentValue 所以它变成

```
currentValue = currentValue + currentValue; 
```

# c# - 是协方差和逆变相关的问题吗？

> ID：12416149
> 
> 赞同：0
> 
> 时间：2012-09-13T23:17:28.097
> 
> 标签：c#, generics, covariance, contravariance

我有以下代码：

```
class Header<TItem> where TItem : IItem { IEnumerable<TItem> Item { get; set; } }
class HeaderA : Header<ItemA> { public HeaderA(int a) {...} } 
class HeaderB : Header<ItemB> { public HeaderB(int b) {...} } 

interface IItem {...}
class ItemA : IItem { }
class ItemB : IItem { }

public static List<Header<IItem>> list = new List<Header<IItem>> 
{
    new HeaderA(1)
} 
```

最后的编译错误`new HeaderA(1)`是

```
Error   1   The best overloaded Add method
'System.Collections.Generic.List<NS.Header<NS.IItem>>.Add(NS.Header<NS.IItem>)'
for the collection initializer has some invalid arguments 
```

如何解决问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T23:30:18.083

您正在尝试将 a 添加`Header<ItemA>`到`List<Header<IItem>>`. 这需要从`Header<ItemA>`to转换`Header<IItem>`- 并且该转换不存在。它不存在是有充分理由的。想象一下您的代码是有效的......那么这将起作用：

```
List<Header<IItem>> list = ...; // As per code
Header<IItem> header = list[0];
header.Item = new List<IItem>(); 
```

现在记住这`header`实际上*是*一个`HeaderA`- 所以这个工作相当于这个 HeaderA header = new HeaderA(); header.Item = 新列表 { 新 ItemB() };

当其他任何东西都期望`header.Item`成为`IEnumerable<ItemA>();`- 所以*这*应该没问题时，这并不好：

```
ItemA itemA = header.Item.First(); 
```

...如果您在其中添加了一个，显然不会`ItemB`。

基本上，您正在寻找泛型协方差 - 但您只能在接口和委托上声明它（而不是在诸如 之类的类上`Header<TItem>`），并且只有当类型参数由于设置器而*没有*在输入位置使用时，因为它在这里`Item`.

也许更重要的是，你的设计看起来非常复杂——我*强烈*怀疑，如果你退后一步，你可以设计自己的方式来尝试首先做到这一点。

# c++ - 如何编写具有仅移动属性的函数？

> ID：12416156
> 
> 赞同：1
> 
> 时间：2012-09-13T23:19:02.673
> 
> 标签：c++, c++11, move, rvalue-reference

我有一种只能移动的类型，禁止复制。我想在某个系统中传递它，但我不确定将哪种签名用于在参数中采用该类型的函数。这种类型的对象必须移动到系统中，不应该进行任何复制。

例子：

```
#include <vector>
class Foo
{
public:
    Foo( std::string name ) : m_name( std::move( name ) ){}
    Foo( Foo&& other ) : m_name( std::move( other.m_name ) ){}
    Foo& operator=( Foo&& other ){ m_name = std::move( other.m_name ); }

    const std::string& name() const { return m_name; }
    // ...
private:
    Foo( const Foo& ) ;//= delete;
    Foo& operator=( const Foo& ) ;//= delete;
    // ...

    std::string m_name;
};

class Bar
{
public:

    void add( Foo foo )  // (1)
        // or...
    void add( Foo&& foo ) // (2)
    {
        m_foos.emplace_back( std::move(foo) ); // if add was template I should use std::forward?
    }

private:
    std::vector<Foo> m_foos;
};

void test()
{
    Bar bar;
    bar.add( Foo("hello") );

    Foo foo("world");
    bar.add( std::move(foo) );
} 
```

（假设我正在移动对象，两个签名都在 VS2012 中编译）

应该首选 1 和 2 之间的哪个签名？

看起来两者都有效，但我认为必须有区别......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T00:25:50.063

从 xvalue 移动时，签名 #1 将花费 2 次移动构造，而从 xvalue 移动时，签名 #2 将仅花费 1 次移动构造。因此＃2对我来说听起来更好。但只要搬家建设便宜，任何一个签名都可以完成工作。你想要：

1.  真的很快，或者
2.  速度是真快的两倍？

:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-13T23:25:01.843

这取决于。

如果要将对象移动到函数中，请按值获取。编译器将自己进行移动，并且您将清楚地向调用者记录该函数移动传递的参数。如果您使用第二个，该函数*可能会也可能不会*移动参数，即使调用者必须使用`std::move(foo)`. 这可能非常令人困惑。

如果您不想将对象移动到函数中，请使用左值引用。如果函数不发生变异，则设为 const，如果发生变异，则设为非 const。

# list - 制作列表以在 Haskell 中计算帕斯卡三角形

> ID：12416157
> 
> 赞同：4
> 
> 时间：2012-09-13T23:19:10.737
> 
> 标签：list, haskell, recursion

我正在尝试制作一个函数，该函数接受一个整数`m`并将帕斯卡三角形的行返回到`m`第 th 行。

我已经构造了一个`choose`函数，它接受两个整数 n 和 k，并返回值 n 选择 k。例如，`choose 3 2`返回 3。

到目前为止，我有

```
pascal 0 = [1]
pascal m = [x | x <- pascal (m-1)] ++ [choose m k | k <- [0,1..m] 
```

这将返回一个大列表，但实际上，我想要一个列表列表，其中每个列表对应于帕斯卡三角形中的一行。例如`pascal 3`应该返回`[[1],[1,1],[1,2,1],[1,3,3,1]]`。它目前正在返回`[1,1,1,1,2,1,1,3,3,1]`。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-13T23:41:35.750

有解决方案，然后有*解决方案*。让我们先从解决方案开始，然后逐步找到*解决方案*。

首先要注意的是，如果我们想要您声称的结果，我们必须更改类型，并进行更多的包装：

```
-- was pascal :: Integer -> [Integer]
pascal :: Integer -> [[Integer]]
pascal 0 = [[1]]
pascal m = [x | x <- pascal (m-1)] ++ [[choose m k | k <- [0,1..m]]] 
```

现在，一些句法指针：`[x | x <- foo]`最好写成 just `foo`，并且`[0,1..m]`通常与 just 相同`[0..m]`：

```
pascal m = pascal (m-1) ++ [[choose m k | k <- [0..m]]] 
```

您会观察到，这是在每次递归调用时将单例列表附加到另一个列表的末尾。这是低效的；最好从前面构建列表。所以，我们将使用一个常见的重构：我们将创建一个带有累加器的助手。

```
pascal = go [] where
    go 0 acc = [1] : acc
    go m acc = go (m-1) ([choose m k | k <- [0..m]] : acc) 
```

`choose m k`下一个观察结果是，您可以比每次重新计算更有效地做一些事情：您可以仅使用前一行和一些加法来计算帕斯卡三角形的下一行。这意味着我们可以构建一个包含帕斯卡三角形所有行的惰性（无限）列表。

```
nextRow vs = [1] ++ zipWith (+) vs (tail vs) ++ [1]
allPascals = iterate nextRow [1] 
```

最后，由于帕斯卡三角形的所有行在它们的中点上都是对称的，您可以尝试构建一个仅包含每行前半部分的无限列表。这将有利于消除剩余的“附加到列表末尾”操作。我把它留作练习；请记住，行在偶数和奇数元素之间交替，这使得这部分有点棘手（也更丑陋）。

# mercurial - 如何在 Mercurial 中创建一次性实验工作流程？

> ID：12416159
> 
> 赞同：0
> 
> 时间：2012-09-13T23:19:26.470
> 
> 标签：mercurial, mercurialeclipse

最初来自 SVN，我还是 Mercurial 的新手。

我有兴趣创建一个实验性工作流程，看看我是否可以从头开始重写一个有问题的功能。如果我的尝试失败了，我希望删除实验工作流程——放弃工作——**没有其他人看到它**。

问题是，尽管我仍然需要在笔记本电脑和个人电脑上推动这个实验性工作流程的变化，并继续工作几周。但是仍然保持选项打开以删除该分支并回退到主分支，而没有任何实验分支的痕迹。

在 Mercurial 中是否有可能发生这样的事情，我怎么能做到这一点？

> 仅供参考，我在 Aptana Studio 3.0 上使用 mercurialeclipse 插件。（所以我使用 UI，但命令也应该没问题）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T23:27:43.367

将变更集推送到中央服务器后（假设您有一个） - 无法从那里删除它。

因此，您现在可能（但非常不方便）的解决方案是创建一个个人独立的存储库并使用它同步您的设备。如果你喜欢这个结果 - 然后你推送到共享的中央仓库。否则，您只需删除临时存储库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T01:44:04.623

使用像 Mercurial 这样的分布式版本控制系统，您可以在存储库的任何克隆之间进行同步，而不仅仅是所有用户都同意使用的“中央”版本。

因此，您可以：

1.  将存储库克隆为系统“实验”可以访问的私有共享。

2.  克隆到 USB 密钥并在系统之间移动它。

3.  用于`hg serve`为系统上的本地存储库启动 Web 服务器，并将该历史记录克隆并拉取到其他系统。

4.  用于`hg bundle/unbundle`打包新的历史记录并将其通过电子邮件发送到另一个系统。

要放弃工作，只需删除所有这些额外的克隆并再次从公共“中央”存储库中克隆。

# scheme - 如何在方案中定义字符串权限？

> ID：12416160
> 
> 赞同：1
> 
> 时间：2012-09-13T23:19:27.850
> 
> 标签：scheme, procedure

我需要定义“字符串正确”的程序

```
(define string-right
  (lambda (x)
    (substring x (quotient (string-length x) 2) (string-length x)))) 
```

不适用于奇数字符串长度，但程序

```
(define string-right
    (lambda (x)
      (substring x (+ (quotient (string-length x) 2) 1)(string-length x)))) 
```

不适用于偶数字符串长度。请帮忙。沮丧的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:37:31.047

假设你的意思是你想要一个没有中间的字符串的右半部分：
在商（第一个选项）中，替换：

```
(string-length x) 
```

和：

```
(+ 1 (string-length x)) 
```

如果字符串的长度是偶数，则 floor((length + 1) / 2) = length / 2

否则地板（（长度+ 1）/ 2）=（长度+ 1）/ 2

该`+ 1`部分将排除中间元素

完整的解决方案：

```
(define string-right
  (lambda (x)
    (substring x (quotient (+ 1 (string-length x)) 2) (string-length x)))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T23:46:07.250

试试这个方法：

```
(define string-right
  (lambda (x)
    (substring x (floor (/ (string-length x) 2))))) 
```

如果字符串长度为奇数，上述过程将包括中间的字符。如果您不希望这样，请替换`floor`为，`ceiling`并且返回的字符串中不会出现中间字符。

一些使用示例`floor`：

```
(string-right "")      ; => ""
(string-right "a")     ; => "a"
(string-right "ab")    ; => "b"
(string-right "abc")   ; => "bc"
(string-right "abcd")  ; => "cd"
(string-right "abcde") ; => "cde" 
```

一些使用示例`ceiling`：

```
(string-right "")      ; => ""
(string-right "a")     ; => ""
(string-right "ab")    ; => "b"
(string-right "abc")   ; => "c"
(string-right "abcd")  ; => "cd"
(string-right "abcde") ; => "de" 
```

# android - 如何使 ICS 应用程序（API 15）与 Jellybean（API 16）兼容？

> ID：12416164
> 
> 赞同：3
> 
> 时间：2012-09-13T23:20:07.133
> 
> 标签：android, compatibility, android-4.0-ice-cream-sandwich, android-4.2-jelly-bean, eclipse-adt

我正在为 Android 构建一个应用程序，但我想制作它，以便至少可以使用 4.0.3 功能。我目前并不担心为使用 4.0 及以下版本的用户发布此功能。

基本上，我的问题如下：

*   如果我已经有一个项目，其 Eclipse 中的基本最小 SDK 设置为 4.0.3，最大值设置为相同，我可以更改最大值吗？如果是这样，怎么做？

*   4.0.3 应用程序是否与 4.1 应用程序完全兼容？如果没有，有什么好的解决方法？如果我在 C/C++ 中执行此操作，答案将是预处理器指令（例如，`#ifdef ANDROID_OS_4_1 //do stuff for 4.1 only #endif`）。然而，我知道 Java 中没有这样的等价物，更不用说 Android 了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T23:56:52.113

要针对 JellyBean 进行构建，您可以使用`<uses-sdk />`AndroidManifest 中的标签（就在`<application />`标签上方）：

```
<uses-sdk android:minSdkVersion="15" android:targetSdkVersion="16"/> 
```

通过使用 16 (JellyBean) 的 targetSdkVersion，您可以访问所有新的 API

然后，在运行时，您可以检查应用程序正在运行的 Android 版本，并据此执行操作。我在我的应用程序中使用了一个实用程序类来执行此操作：

```
public class Api {
    public static final int LEVEL = Build.VERSION.SDK_INT;
    public static final int FROYO = Build.VERSION_CODES.FROYO;
    public static final int GINGERBREAD = Build.VERSION_CODES.GINGERBREAD;
    public static final int GINGERBREAD_MR1 = Build.VERSION_CODES.GINGERBREAD_MR1;
    public static final int HONEYCOMB = Build.VERSION_CODES.HONEYCOMB;
    public static final int ICS = Build.VERSION_CODES.ICE_CREAM_SANDWICH;
    public static final int JELLYBEAN = Build.VERSION_CODES.JELLY_BEAN;

    public static boolean isMin(int level) {
        return LEVEL >= level;
    }
} 
```

然后在您的代码中，您可以执行以下操作：

```
if(Api.isMin(Api.JELLYBEAN) )
    doJellybeanStuff();
else if(Api.isMin(Api.ICS) )
    doIcsStuff();
else
    doOldStuff(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T23:22:15.013

您可以通过使用获取版本

```
int SDK_INT = android.os.Build.VERSION.SDK_INT; 
```

您可以在设置参数之前检查版本

```
if(SDK_INT < 16) {
  someAPIInLowerVersions();
} else {
  someJBApi();
} 
```

# mongodb - 使用 MongoDb 中的运算符 $all 优化数组查询匹配

> ID：12416173
> 
> 赞同：1
> 
> 时间：2012-09-13T23:22:56.230
> 
> 标签：mongodb, optimization, nosql

在具有以下结构的 130k 元素的集合中：

```
{
  "tags": ["restaurant", "john doe"]
} 
```

有 40k 个带有“restaurant”标签的文档，但只有 2 个带有“john doe”标签。所以接下来的查询是不同的：

```
// 0.100 seconds (40.000 objects scanned)
{"tags": {$all: [/^restaurant/, /^john doe/]}}

// 0.004 seconds (2 objects scanned)
{"tags": {$all: [/^john doe/, /^restaurant/]}} 
```

有没有办法优化查询而不对客户端中的标签进行排序？我现在能想象的唯一方法是将不太频繁的标签放在搜索数组的开头。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:11:11.167

我在 mongodb 团队 JIRA 中找到了一个请求功能：

> [https://jira.mongodb.org/browse/SERVER-1000](https://jira.mongodb.org/browse/SERVER-1000)

我实现了一个统计系统，将具有更多节奏的标签放在数组的末尾。

# android - 在开放的角度画一个正方形

> ID：12416174
> 
> 赞同：1
> 
> 时间：2012-09-13T23:22:59.660
> 
> 标签：android, opengl-es, drawing

我尝试画一个正方形..但是当我运行代码时，我看到一个三角形，而不是正方形... :)）这里有什么问题？？？

```
public class MyGL20Renderer implements GLSurfaceView.Renderer {

    private FloatBuffer square1;

    private void initShapes(){

        float square1Coords[]={ 
              -0.5f, -0.5f,  0.0f,  // 0\. left-bottom
               0.5f, -0.5f,  0.0f,  // 1\. right-bottom
               0.0f,  0.0f,  0.0f,  // 2\. left-top
               0.5f,  0.5f,  0.0f   // 3\. right-top
        };

        // initialize vertex Buffer for square  
        ByteBuffer vbb4 = ByteBuffer.allocateDirect(

        // (# of coordinate values * 4 bytes per float)
        square1Coords.length * 4); 
        vbb4.order(ByteOrder.nativeOrder());
        square1 = vbb4.asFloatBuffer();  
        square1.put(square1Coords);
        square1.position(0);   

    } 
```

. . . .

```
public void onDrawFrame(GL10 gl) {

    // Redraw background color
    gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);

    // Draw the square
    gl.glColor4f(0.0f, 0.0f, 1.0f, 0.0f);  //blue
    gl.glVertexPointer(3, GL10.GL_FLOAT, 0, square1);
    gl.glDrawArrays(GL10.GL_TRIANGLES, 0, 4);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T23:31:14.643

您正在指定`GL_TRIANGLES`但只有四个顶点。试试六。

或使用`GL_TRIANGLE_STRIP`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T23:52:03.937

Left top point seem to be wrong, should be `-0.5, 0.5, 0.0` and I also agree with genpfault that think you should use `GL_TRIANGLE_STRIP`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T20:47:37.380

好的..我找到了解决问题的方法，我想..

```
//this is our Square class
public class Square {

    private FloatBuffer vertexBuffer;   // buffer holding the vertices
    private float vertices[] = {
              -0.3f, -0.3f,  0.0f,  // 0\. left-bottom
               0.3f, -0.3f,  0.0f,  // 1\. right-bottom
              -0.3f,  0.3f,  0.0f,  // 2\. left-top
               0.3f,  0.3f,  0.0f   // 3\. right-top
    };

    public Square() {
        // a float has 4 bytes so we allocate for each coordinate 4 bytes
        ByteBuffer vertexByteBuffer = ByteBuffer.allocateDirect(vertices.length * 4);
        vertexByteBuffer.order(ByteOrder.nativeOrder());

        // allocates the memory from the byte buffer
        vertexBuffer = vertexByteBuffer.asFloatBuffer();

        // fill the vertexBuffer with the vertices
        vertexBuffer.put(vertices);

        // set the cursor position to the beginning of the buffer
        vertexBuffer.position(0);

    }

    /** The draw method for the square with the GL context */
    public void draw(javax.microedition.khronos.opengles.GL10 gl) {

        gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);

        // set the colour for the square
        gl.glColor4f(1.0f, 0.0f, 0.0f, 0.0f);  //red

        // Point to our vertex buffer
        gl.glVertexPointer(3, GL10.GL_FLOAT, 0, vertexBuffer);

        // Draw the vertices as triangle strip
        gl.glDrawArrays(GL10.GL_TRIANGLE_STRIP, 0, vertices.length / 3);

        //Disable the client state before leaving
        gl.glDisableClientState(GL10.GL_VERTEX_ARRAY);
    }
}

// and this is our renderer class
public class MyRenderer implements GLSurfaceView.Renderer {
    // the square to be drawn
    private Square      square;

public MyRenderer() {

        this.square = new Square(); 

    @Override
    public void onDrawFrame(GL10 gl) {
        // clear Screen and Depth Buffer
        gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);

        // Reset the Modelview Matrix
        gl.glLoadIdentity();

        // Drawing
        gl.glTranslatef(0.0f, 0.0f, -5.0f);     

        // Draw the square
        square.draw(gl);

    }

    @Override
    public void onSurfaceChanged(GL10 gl, int width, int height) {
        if(height == 0) {       //Prevent A Divide By Zero By
            height = 1;         //Making Height Equal One
        }

        gl.glViewport(0, 0, width, height);     //Reset The Current Viewport
        gl.glMatrixMode(GL10.GL_PROJECTION);    //Select The Projection Matrix
        gl.glLoadIdentity();            //Reset The Projection Matrix

        //Calculate The Aspect Ratio Of The Window
        GLU.gluPerspective(gl, 45.0f, (float)width / (float)height, 0.1f, 100.0f);

        gl.glMatrixMode(GL10.GL_MODELVIEW);     //Select The Modelview Matrix
        gl.glLoadIdentity();            //Reset The Modelview Matrix
    }

    @Override
    public void onSurfaceCreated(GL10 gl, EGLConfig config) {
    }
} 
```

# c++ - 加载和保存矢量到文件

> ID：12416175
> 
> 赞同：1
> 
> 时间：2012-09-13T23:23:09.953
> 
> 标签：c++, serialization, load, save, c++builder

我正在使用 C++ Builder，并且我有一个`Appointment`对象向量数组。

我想将其保存到文件中并从文件中加载。

目前，我将 ifstream 和 ofstream 与二进制文件一起使用。我有一个标题，其中包含将与数据一起保存的向量的大小，以便在加载时知道它的大小。

序列化是更好的方法吗？

如果是这样，我需要使用 boost 库还是其他方式？

这是我当前的代码：

```
class appointment
{
public:
    appointment();
    appointment(TDateTime aDate, TDateTime aReminderDateTime, string aType,
    string aLocation, string aComments, bool aIsImportant)
    {
        appDateTime = aDate;
        appReminderDateTime = aReminderDateTime;
        appType = aType;
        appLocation = aLocation;
        appComments = aComments;
        appIsImportant = aIsImportant;
    }
    void setAppDateTime(TDateTime aDateTime)
    {
        appDateTime = aDateTime;
    }
    void setappReminderDateTime(TDateTime aReminderDateTime)
    {
        appReminderDateTime = aReminderDateTime;
    }
    /*
    void printAppointmentDetails()
    {
        cout << "Appointment Date: " << appDateTime << endl;
        cout << "Appointment Reminder Date: " << appReminderDateTime << endl;
        cout << "Appointment Type: " << appType << endl;
        cout << "Appointment Location: " << appLocation << endl;
        cout << "Appointment Comments: " << appComments << endl;
        if (appIsImportant)
        {
            cout << "Appointment IsImportant: " << "Yes" << endl;
        } else {
            cout << "Appointment IsImportant: " << "No" << endl;
        }
    }

    */
    void setType(string aType)
    {
        appType = aType;
    }
    void setLocation(string aLocation)
    {
        appLocation = aLocation;
    }
    void setComments(string aComments)
    {
        appComments = aComments;
    }
    void setIsImportant(bool aIsImportant)
    {
        appIsImportant = aIsImportant;
    }
    TDateTime getAppDateTime()
    {
        return appDateTime;
    }
    TDateTime getAppReminderDateTime()
    {
        return appReminderDateTime;
    }
    string getType()
    {
        return appType;
    }
    string getLocation()
    {
        return appLocation;
    }
    string getComments()
    {
        return appComments;
    }
    bool getIsImportant()
    {
        return appIsImportant;
    }
private:
    //appointment();
    TDateTime appDateTime;
    TDateTime appReminderDateTime;
    string appType;
    string appLocation;
    string appComments;
    bool appIsImportant;
    //person owner;
};

class calendar
{
public:
    calendar()
    {
        //loadFromFile();
        //load persons
        //calculateimportantAppointments
    }
    ~calendar()
    {
        saveToFile();
    }
    //addperson
    //editperson
    //removeperson
    void createAppointment(TDateTime aDate, TDateTime aReminderDateTime, string aType,
    string aLocation, string aComments, bool aIsImportant)
    {
        appointment newAppointment(aDate, aReminderDateTime, aType,
        aLocation, aComments, aIsImportant);
        appointments.push_back(newAppointment);
    }
    /*
    void printAllAppointmentDetails()
    {
        for (int i = 0; i < appointments.size(); i++)
        {
            appointments[i].printAppointmentDetails();
        }
    }
    void calculateImportantAppointments()
    {

    }
    int getNumberOfImportantAppointments()
    {
        int intImportantAppointmentCount = 0;
        for (int i = 0; i < appointments.size(); i++)
        {
             if (appointments[i].getIsImportant())
                intImportantAppointmentCount += 1;
        }
        return intImportantAppointmentCount;
    }

    appointment[] getImportantAppointments()
    {

    }
    appointment[] getAllAppointments()
    {

    }
    */
    void loadFromFile()
    {
        ifstream iStream("file.ext", ios::binary);
        if (!iStream)
        {
            cout << "No file";
        } else {
            fileHeader_t fHeader;
            iStream.read((char*)&fHeader, sizeof(fileHeader_t));
            if (fHeader.magicNumber = 0xDEADBEAF)
            {
                appointments.resize(fHeader.appointmentCount);
                iStream.read((char*)&appointments[0], fHeader.appointmentCount * sizeof(appointment));
            }
        }
    }
    void saveToFile()
    {
        ofstream oStream("file.ext", ios::binary);
        fileHeader_t fHeader;
        fHeader.magicNumber = 0xDEADBEAF;
        fHeader.appointmentCount = appointments.size();
        oStream.write((char*)&fHeader, sizeof(fileHeader_t));
        oStream.write((char*)&appointments[0], sizeof(appointment) * appointments.size());
    }
    //vector<appointment> appointments;
private:
    vector<appointment> appointments;
    string calCurrentDate;
    string calCurrentTime;
    typedef struct fileHeader_s
    {
        DWORD magicNumber;
        size_t appointmentCount;
    }fileHeader_t;
}; 
```

调用 loadFromFile() 方法时出现以下错误。

> [BCC32 警告] File1.cpp(185): W8060 可能不正确的分配 [ILINK32 错误] 错误：从 \PROFILES.SOIT.LOCAL\HOMES$\SIMON.CANNING\MY DOCUMENTS\ 引用的未解决的外部 'appointment::appointment()' RAD STUDIO\PROJECTS\DEBUG\FILE1.OBJ [ILINK32 错误] 错误：无法执行链接

我知道这是由于构造函数调用而发生的。我可以就如何解决此问题提供一些建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T23:58:40.547

有了所有你可能需要编译的戏剧，然后你必须做的所有废话来实现序列化，我个人并不费心。

只需将大小设置到标题中，将其写入文件，然后写出向量的字节。

加载时，读入标头，将向量调整为它所说的大小，然后读入向量的字节。

*[编辑]*

正如评论中所讨论的，您必须意识到您也不能将其他非平凡类型（例如字符串）写成二进制。所有这些都必须序列化。根据您提出问题的方式，我推断您已经意识到这一点。

所以如果你只需要序列化几个类型并且还没有使用boost的话，我个人认为使用boost来解决这个问题会有点矫枉过正。人们似乎对我表达这种观点的方式做出了负面回应，所以也许他们从来没有处理过一个项目，其中有人依赖于 boost 序列化来解决一个非常简单和孤立的问题 =)

您真正需要的是一些您可以自己编写的简单支持函数。在这种情况下，您甚至不需要该标头来包含矢量大小，因为您可以序列化...

```
// This writes a vector of trivial data types.
template <class T>
void WriteTrivial( std::ostream& s, const std::vector<T>& data )
{
    unsigned int len = data.size();
    s.write( (char*)&len, sizeof(len) );
    s.write( (const char*)&data[0], len * sizeof(T) );
}

// This reads a vector of trivial data types.
template <class T>
void ReadTrivial( std::istream& s, std::vector<T>& data )
{
    unsigned int len = 0;
    s.read( (char*)&len, sizeof(len) );
    data.resize(len);
    if( len > 0 ) s.read( (char*)&data[0], len * sizeof(T) );
} 
```

如果您的向量可能包含字符串或向量，则需要更多支持函数

```
// This writes a vector of non-trivial data types.
template <class T>
void Write( std::ostream& s, const std::vector<T>& data )
{
    unsigned int len = data.size();
    s.write( (char*)&len, sizeof(len) );
    for( unsigned int i = 0; i < len; i++ ) {
        Write( s, data[i] );
    }
}

// This reads a vector of non-trivial data types.
template <class T>
void Read( std::istream& s, std::vector<T>& data )
{
    unsigned int len = 0;
    s.read( (char*)&len, sizeof(len) );
    data.resize(len);
    for( unsigned int i = 0; i < len; i++ ) {
        Read( s, data[i] );
    }
 } 
```

当然，对于上述内容，您需要一些字符串，以及一个读/写模板来处理普通数据类型。无论如何，这应该让你开始。希望有帮助。

*[编辑]*

既然您已经发布了代码，我建议您这样做：

在**日历**中：

```
void loadFromFile()
{
    ifstream iStream("file.ext", ios::binary);
    if (!iStream)
    {
        cout << "No file";
    } else {
        fileHeader_t fHeader;
        iStream.read((char*)&fHeader, sizeof(fileHeader_t));
        if (fHeader.magicNumber != 0xDEADBEAF) return;
        appointments.resize(fHeader.appointmentCount);
        for( size_t i = 0; i < appointments.size(); i++ ) {            
            appointments[i].read(iStream);
        }
        iStream.close();
    }
}

void saveToFile()
{
    ofstream oStream("file.ext", ios::binary);
    fileHeader_t fHeader;
    fHeader.magicNumber = 0xDEADBEAF;
    fHeader.appointmentCount = appointments.size();
    oStream.write((char*)&fHeader, sizeof(fileHeader_t));
    for( size_t i = 0; i < appointments.size(); i++ ) {            
        appointments[i].write(oStream);
    }
    oStream.close();
} 
```

现在，对于序列化字符串：

```
void write( ostream &s, const string& str )
{
    unsigned int len = str.size();
    s.write((char*)&len, sizeof(len));
    s.write(str.c_str(), len*sizeof(char));
}

void read( istream &s, string& str )
{
    unsigned int len = 0;
    s.read((char*)&len, sizeof(len));
    str.resize(len);
    if( len == 0 ) return;
    s.read((char *) str.c_str(), len*sizeof(char));
} 
```

也许是编写琐碎类型的有用包装器：

```
template <class T>
void writeTrivial( ostream& s, const T& val )
{
    ostream.write( (const char*)&val, sizeof(T) );
}

template <class T>
void readTrivial( ostream& s, T& val )
{
    ostream.read( (char*)&val, sizeof(T) );
} 
```

最后，在**约会中**

```
void write( ostream& s )
{
    writeTrivial(s, appDateTime);
    writeTrivial(s, appReminderDateTime);
    write(s, appType);
    write(s, appLocation);
    write(s, appComments);
    writeTrivial(s, appIsImportant);
}

void read( istream& s )
{
    readTrivial(s, appDateTime);
    readTrivial(s, appReminderDateTime);
    read(s, appType);
    read(s, appLocation);
    read(s, appComments);
    readTrivial(s, appIsImportant);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T15:47:20.643

> Is serilization a better way to do this?
> 
> If so, do I need to use the boost library, or another way?

I think you'd be better off using a serialization library. Your use of a library might be limited at this point, but if your application grows... The [C++ Middleware Writer](http://webEbenezer.net) is an on line alternative to traditional serialization libraries.

# wpf - Windows 7 和 8 之间的图像资源命名不同？

> ID：12416177
> 
> 赞同：3
> 
> 时间：2012-09-13T23:23:40.473
> 
> 标签：wpf, visual-studio-2010, xaml, windows-7, windows-8

我有一个使用`png`图像作为资源的 WPF 应用程序。这些图像被添加到我的`csproj`“作为链接”中一个名为“资源”的文件夹中，具有以下属性

*   构建操作：资源
*   复制到输出目录：不要复制

在我的`xaml`文件中，它们的引用如下：

```
<Image Source="foo.png" /> 
```

这足以在 Windows 7 上使用 Visual Studio 2010 构建和运行。安装 Windows 8 后，解决方案仍然可以成功构建，但没有图像出现在正在运行的应用程序中。如果我将每个`xaml`图像引用更改为此，图像**会**出现：

```
<Image Source="resources/foo.png" /> 
```

那么，我的 Windows 7 和 Windows 8 安装之间发生了什么变化会影响这一点？此外，我可以采取什么方法让我的应用程序在 Windows 7 和 8 上成功构建和运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T20:22:56.477

由于您提到该文件作为链接添加到名为“resources”的文件夹中，因此我不确定之前没有合格路径它是如何工作的。从技术上讲，每个相对 Uri 都是相对于试图加载它的页面的“打包”uri。我怀疑框架版本之间的相关规则发生了变化，但我认为你有三个选择：

1.  如果这适用于两个版本，请包括“资源”前缀。
2.  使用 pack Uri 获得明确的信息，而不是使用相对 Uris 并根据系统来转换它们（更多[信息在这里](http://msdn.microsoft.com/en-us/library/aa970069.aspx)）。
3.  强制应用程序在特定的运行时版本下运行（更多[信息在这里](http://msdn.microsoft.com/en-us/library/9w519wzk.aspx)）。

# node.js - expressjs + mongoose + passportjs GithubStrategy

> ID：12416179
> 
> 赞同：0
> 
> 时间：2012-09-13T23:23:51.610
> 
> 标签：node.js, express, github, mongoose, passport.js

我正在尝试将通过 GitHub 进行身份验证的用户保存到 mongodb 中。我正在使用猫鼬。以下是我所拥有的：

```
var accountSchema = new Schema({
  firstName: String,
  lastName: String,
  email: String,
  githubId: String,
  githubAccessToken: String
});

passport.use(new GitHubStrategy({
    clientID: config.GITHUB_CLIENT_ID,
    clientSecret: config.GITHUB_CLIENT_SECRET,
    callbackURL: "http://127.0.0.1/auth/github/callback",
    scope: ['user', 'public_repo', 'repo', 'gist']
  },
  function(accessToken, refreshToken, profile, done) {
     User.findOrCreate(...) // User is not defined
  });
})); 
```

如何将用户保存到 mongodb，这样他们每次访问该站点时都不必进行身份验证？passport-github 上的示例没有将任何内容保存到数据库中，这是我想要做的吗？有没有这方面的教程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T12:56:06.683

这可能会有所帮助： [如何处理异步。护照和猫鼬的 findOrCreate 方法](https://stackoverflow.com/questions/11155108/how-to-deal-with-async-findorcreate-method-for-passport-and-mongoose)

基本上，您必须定义一个处理数据库操作并了解必要的猫鼬模式和模型的函数（在您的情况下是 findOrCreate 函数）。

# javascript - window.location.replace 并在 URL 历史记录条目中传递变量？

> ID：12416180
> 
> 赞同：0
> 
> 时间：2012-09-13T23:23:53.820
> 
> 标签：javascript, browser-history

我`window.location.replace`在应用程序上使用各种东西并在 URL (www.website.com/?clicked=2) 中传递变量。

问题是它绝对会用新条目淹没历史记录（至少在 Chrome 中）。有没有办法让页面只有 1 个条目？我认为`window.location.replace`应该替换条目或者我已经阅读了？

还有其他方法吗？如果您合法地使用该应用程序一分钟点击内容，它将占用一页历史。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T23:42:38.993

我不认为你能做到这一点。`window.location.replace`只会更改 URL 并重新加载页面。因为它是一个不同的 URL - 它将被添加到导航历史记录中。假设您在这里唯一能做的就是使用 ajax 下载整页。ajax 有点奇怪的用法，但它会解决你在历史上的多个条目的问题。使用[History.js](https://github.com/balupton/History.js/)之类的东西，您可以控制浏览器历史记录中的内容，但无论如何页面都将使用 ajax 加载。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-30T03:27:08.883

Location.replace( 不创建历史条目。

# ios - 如何通过使用 iOS 的 initRecurrenceWithFrequency 将 weekOfTheYear 作为 NSInteger（52 或 53）？一世

> ID：12416182
> 
> 赞同：0
> 
> 时间：2012-09-13T23:24:26.223
> 
> 标签：ios, date, calendar

请帮帮我，我卡住了！

我正在尝试制作一个简单的日历应用程序并且很绝望。我需要一个给定年份（52 或 53）周的值，我知道这个问题的答案是使用 initRecurrenceWithFrequency。但我无法让我的代码工作！！！！请帮忙。

/约翰

* * *

@阿里软件

非常感谢！

然而这个代码片段（下面）给了我 1 而不是 53。你知道为什么吗？顺便说一句，我的模拟器设置状态为公历，作为它的日历。/约翰

```
 NSDateComponents *comps = [NSDateComponents alloc];
    [comps setDay:31];
    [comps setMonth:12];
    [comps  setYear:year];

    NSCalendar *usersCalendar =[[NSLocale currentLocale] objectForKey:NSLocaleCalendar];
    NSDate *date = [usersCalendar dateFromComponents:comps];

    NSDateComponents *weekComps =
    [usersCalendar components:NSWeekCalendarUnit fromDate:date];

    NSInteger totalNumberOfWeeksInThisYear = [weekComps week]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:00:26.320

如果您需要知道一年中的哪一周是给定日期，或者任何类似的东西（一年中的周数等），您应该使用`NSDateComponents`它。

您应该真正阅读 Apple 文档中的**[日期和时间编程指南](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/DatesAndTimes/DatesAndTimes.html#//apple_ref/doc/uid/10000039i)**。它解释了有关日期、日历和日期组件、概念和细微之处（闰年等）、与日期和日历相关的 Cocoa 类如何相互交互以及如何使用它们的所有内容。

它非常详细（实际上就像 Apple 文档中的每个编程指南一样），**如果不阅读此文档，您就无法真正考虑创建日历应用程序**。

*（顺便说一句，我不明白你如何质疑一年中的几周与?!!的`initRecurrenceWithFrequency`方法有关）`EKRecurrenceRule`*

# c# - 在 ASP.NET (C#) 中，呈现和引用基于集合的表单的正确方法是什么？

> ID：12416190
> 
> 赞同：0
> 
> 时间：2012-09-13T23:25:27.257
> 
> 标签：c#, asp.net, inline, code-behind, html-rendering

我想这个问题之前已经被问过（不是每个问题吗？），但我正在努力寻找解决方案所需的语言，所以这里有一些细节：

我有一个用于更新单个位置的 Web 表单，例如街道地址、城市、州等，这是通过使用带有各种 asp:TextBoxes 的静态位置更新表单来处理的，这些 asp:TextBoxes 在代码隐藏中使用它们的智能感知控件，例如 StreetAddressTextBox.Text。

我想更新此表格以适用于多个地点。过去，当我使用 PHP 时，这意味着要编写大量内联代码，其中我将表单内容包装在我正在呈现的集合上的 for 循环中，然后使用`ID="StreetAddressTextBox_<%=locationId%>"`类似模式的模式引用每个项目。

我目前正在 ASP.NET 中这样做，但内联感觉很脏，特别是因为我必须踢掉很多我在其他页面上建立的代码隐藏范例，而表单内容不是基于集合进行缩放。我的直觉告诉我应该有某种方法来模板化一个位置并在代码隐藏中做所有事情，但我还没有偶然发现和示例在实践中向我展示了这一点。

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T23:58:42.207

假设我正确理解您，听起来您应该使用 UserControl。

基本上创建一个 UserControl.ascx 文件（VS 将为您生成 UserControl.designer.cs 和代码隐藏类）。然后将您的输入字段放在那里，没有特殊属性，如下所示：

（请注意，我更喜欢 HtmlControls 而不是 WebControls，它们提供更清晰的标记并且不会弄脏东西。我建议你试一试）：

```
<%@ Control blargh %>
<label for="<%= Street.ClientID %>">Street address</label>
<input type="text" runat="server" id="Street" /> <br />

<label for="<%= City.ClientID %>">Town / City</label>
<input type="text" runat="server" id="City" /> <br />

<!-- etc --> 
```

请注意我没有弄乱`id=""`输入控件的属性。现在只需在您的 web.config 中注册它：

```
<add tagPrefix="foo" tagName="Address" src="~/Controls/Address.ascx" /> 
```

然后在每个需要地址表单的页面中（假设您的 UserControl 称为 AddressControl）

```
<%@ Page blargh %>
<p>Enter your address details below:</p>
<foo:Address runat="server" id="Address" /> 
```

然后在您页面的代码隐藏中，您可以这样做：

```
 public override void OnLoad(Object sender, EventArgs e) {
      if( Page.IsPostBack ) {
          Validate();
          if( Page.IsValid ) {
              // get values from a POST
              String street = this.Address.Street.Value;
              String city   = this.Address.City.Value;
              // and so on
          }
      } else {
          // set values if you're retrieving data from a DB or something
          this.Address.Street.Value = "123 Fake Street";
          this.Address.City.Value = "Frying Pan City";
      }
 } 
```

请注意我是如何使用“<%= Street.ClientID %>”的东西。ASP.NET 将根据控件的父名称（以此类推，递归方式）自动生成控件名称和 ID。因此，实际的 HTML 输入将呈现如下：

```
<label for="Address.Street">Street address</label>
<input type="text" name="Address_Street" id="Address.Street" /> 
```

请注意，这种设计和做法仅适用于 WebForms。ASP.NET MVC 又完全不同了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T04:22:46.880

你可以只使用一个`<asp:PlaceHolder runat="server" id="plcDynamicControls" />`.

在您的代码后面创建一个`private List<WebControl> dynamicControls`.

在`.Init()`退货期间，无论您的要求是什么逻辑`locationID`，以及您的现场要求可能是什么。

说出`locationID = 4`必填的姓名、地址 1、地址 2 字段：

```
Page_Init(object Sender, EventArgs e) 
{
    TextBox txt = new TextBox(){
        ID = "txtName"    
    };
    plcDynamicControls.Controls.Add(txt); //Add to Form
    dynamicControls.Add(txt); //Add to reference list, to avoid having to do .FindControl()

    TextBox add1 = new TextBox(){
        ID = "txtAddress1"    
    };
    plcDynamicControls.Controls.Add(add1); 
    dynamicControls.Add(add1); 

    TextBox add2 = new TextBox(){
        ID = "txtAddress2"    
    };
    plcDynamicControls.Controls.Add(add2);
    dynamicControls.Add(add2); 
} 
```

构建一个很好的循环来将这样的控件添加到您的占位符中。

在您`.Click()`的提交按钮事件中，您可以遍历`List<WebControl> dynamicControls`集合并处理响应。

# visual-studio - 如果多个文件具有相同的名称，Visual Studio 断点会在错误的源文件（或同时出现多个文件）中中断

> ID：12416192
> 
> 赞同：49
> 
> 时间：2012-09-13T23:25:29.997
> 
> 标签：visual-studio, debugging, msbuild, visual-studio-2012, debug-symbols

在我正在处理的团队项目中，`IdeasController.cs`如果解决方案中存在另一个同名文件，则在文件中设置断点（例如）将导致调试器行为不稳定。我已经在几个开发人员的工作站上重现了这个问题。

### 例子

`IdeasController.cs`我在我们的 Web API 中设置了一个断点：

> ![代码中设置的断点](../Images/62bb83bb336e01d6aac2c8ed61068d88.png)

另一个名为的文件`IdeasController.cs`存在于我们单独的 MVC 4 Web 项目中。在下面的屏幕截图中，调试器显示了`Api->IdeasController`源代码，但高亮行与`Web->IdeasController`. 断点被复制，其中一个位于注释块的中间。

> ![调试器突出显示与代码结构不匹配](../Images/b3511e01e3fd949dcaf380ad1bf5e3ca.png)

Breakpoint 窗口同时显示两个文件中的断点：

> ![断点跨越两个文件](../Images/a938f389f7cd3f168e1c00f2652e2dc8.png)

在某些工作站上，调试器会逐步通过正确的行（不管行突出显示）；在其他人身上，它会愉快地穿过不相关的行（包括注释和空格）。我猜这取决于它选择显示的源文件。

### 我试过的

我搜索了互联网。`*.pdb`当调试文件（ ）、源文件和编译代码不匹配时，似乎会出现这种问题。有很多可能的原因：重复的文件名（可能会混淆调试器^([[5]](http://www.velocityreviews.com/forums/t72561-asp-net-debugger-shows-wrong-line.html))）、过时的项目构建文件、无效的解决方案缓存或不正确的构建配置。

这些是我找到并尝试过的解决方案：

*   检查了我的构建配置。
    1.  确保项目不是在发布模式下构建的。
    2.  确保我们[没有启用代码优化](http://joelblogs.co.uk/2010/02/10/visual-studio-2008-%E2%80%93-when-debugging-highlights-the-wrong-line/)。
    3.  确保项目的调试模块已正确加载。（开始调试项目并检查`Debug`> `Windows`> `Modules`。两个程序集都已列出，未优化，并且符号状态为“已加载符号”。）
*   重置调试元数据和 Visual Studio 缓存。
    1.  关闭 Visual Studio 并删除解决方案缓存文件 ( `*.suo`)。^([[1]](http://www.dotnetmonster.com/Uwe/Forum.aspx/vs-net-debugging/2997/breakpoint-was-set-to-the-same-file-name-in-different))
    2.  删除了每个项目的构建输出（`bin`和`obj`文件夹）。（供将来参考：在 Windows 资源管理器中打开解决方案文件夹并在搜索框中键入：“ `type:folder AND (name:=bin OR name:=obj)`”。
    3.  删除了程序集缓存文件夹 ( `C:\Documents and Settings\<user>\Local Settings\Application Data\dl3`)。^([[2]](http://minkmachine.reine.se/2006/04/breakpoint-issues-in-visual-studio-net/) [[3]](http://weblogs.asp.net/psheriff/archive/2011/11/08/clean-up-after-visual-studio.aspx))

这些都没有任何效果。我可以重命名其中一个文件（不重命名类）以临时解决该问题，但这远非理想。

### 我现在在哪里

我最新的谷歌搜索的第 14 页。建议将不胜感激。:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-08-01T08:50:30.573

如果没有更好的选择，您可以将断点放在代码中：

```
System.Diagnostics.Debugger.Break(); 
```

只是不要忘记之后将其删除...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-15T14:28:19.483

我很高兴我找到了这篇文章，以为我是唯一的一个，而且快疯了！我在使用 VB.Net 的 VS2012 中遇到了同样的问题，并且已经尝试了 OP 提到的所有内容。

文件的唯一命名似乎是我发现的唯一 100% 修复。在应用程序加载之前禁用所有断点然后重新启用您需要的断点在大多数情况下都有效。Lambda 函数中的断点仍然会给您带来问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-07-01T09:19:37.563

我只是遇到了完全相同的问题。为我解决的问题是删除属于包含受影响项目/源文件的解决方案的 .suo 文件。

我还删除了我的本地符号缓存，但我认为这与它没有任何关系。

（我的解决方案包含多个项目，一个项目中的一个文件（DataAdapter.cs）受此影响（VisualStudio将我的断点放在属于System.Data.DataAdapter的pdb中）。我直接打开了.csproj文件并且能够正确设置断点。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-04T22:11:48.923

I had the same problem today. I was able to trace it back to the fact that I had forgotten to set the platform target to x86 while debugging. Unfortunately the others (x64 / Any CPU) can be problematic while debugging. At least VS 2008 doesn't like them. I guess this is yet another reason to stay away.

Some speculation... I think the debugger (while running a 64 bit app) somehow "steals" breakpoints away from a file in certain cases. For me it was because another assembly was loaded first which had the same file name. I was able to avoid the issue, even in 64 bit mode, if I first manually loaded the assembly with my breakpoints: Assembly.Load("MyAssemblyWithBreakpoints");

Hope this (my first stackoverflow contribution) helps.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-03-06T09:51:41.093

我刚刚在 Visual Studio 2017（版本 15.9.7）上遇到了这个问题，断点被跳过，调试器只是“跳过”了 return 语句等。

过了一会儿，我注意到我最近在项目中添加了一个 .runsettings 文件 - 结果证明，在我的情况下，配置 CodeCoverage 数据收集器导致了这个问题。一旦我删除了这个部分：

```
<DataCollector friendlyName="Code Coverage" uri="datacollector://Microsoft/CodeCoverage/2.0" assemblyQualifiedName="Microsoft.VisualStudio.Coverage.DynamicCoverageDataCollector, Microsoft.VisualStudio.TraceCollector, Version=11.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"> ... </DataCollector> 
```

从 .runsettings 文件中，它再次像魅力一样工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-03-31T22:23:41.020

虽然重命名其中一个文件会起作用，但我发现最简单的解决方案是暂时禁用“其他”程序集的符号自动加载。

1.  启动调试器并继续，直到遇到错误的断点。
2.  *使用调用堆栈*窗口 查找调试器*实际*设置断点的位置： *1.  右键单击带有黄色箭头的行并启用*Show Module Names*。（该行上也应该有红色断点符号。）
    2.  程序集名称现在在该行上可见。* 
**   在 Modules 窗口（*Debug > Windows > Modules*）中找到该程序集。*   右键单击程序集并禁用*Always Load Automatically*。*   停止调试器。*   再次开始调试。*

 *通过这样做，您可以防止 Visual Studio 调试器将断点映射到错误的程序集。然后它将首先从另一个 [大概] 正确的程序集中加载符号，因此将断点映射到正确的程序集。

# 为什么会这样？

当两个不同的符号文件（PDB 文件）——对于两个不同的程序集——都引用同名的源文件时，这似乎会发生。尽管源文件完全不同，但 Visual Studio 调试器似乎会感到困惑。

例如，假设有两个不同的文件，它们的名称都是`IdeasController.cs`. 第一个编译成程序集`Api.dll`，第二个编译成程序集`Web.dll`。

当调试器加载符号时，它将加载`Api.pdb`或`Web.pdb`首先加载。假设它`Api.pdb`首先加载。那么即使你在 in 中设置断点，它也会找到in`Web\IdeasController.cs`的匹配项。然后它将代码从 映射到。当然，这不会正确映射，因此您在调试时会看到各种奇怪的问题。`IdeasController.cs``Api.pdb``Web\IdeasController.cs``Api.dll`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-09-17T10:12:32.057

我只是备份并删除了文件，然后添加回项目，解决了问题。我只是希望我在完成上述列表之前就这样做了：）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-09-01T20:08:25.293

您也可以尝试清理和重建（而不是构建）所有项目。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-09-09T14:52:17.317

我在 Visual Studio 2015 中遇到了这个问题。

我有一个包含要保存为 Version1 的 DLL 的子文件夹。即使在删除对该 DLL 的引用，然后添加对另一个项目工作室的引用之后，它似乎也拉入了现有的引用并转到了错误的源文件。我在子文件夹中删除了该 DLL，然后 Studio 获得了正确的源。

我在 [MSDN 上找到了一个有用的链接，该链接显示了如何在此链接上清除工作室中先前关联的源文件][1]。

**概括：**

1.  在解决方案资源管理器中，右键单击解决方案名称（例如：解决方案“TestApplication”）并选择属性这将打开解决方案属性页对话框
2.  在通用属性下，选择调试源文件
3.  在搜索这些路径以查找源代码文件 (Visual Studio .NET 2003)/包含源代码的目录 (Visual Studio 2005) 框中，根据需要添加、删除和/或重新排序目录
4.  单击确定按钮

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-02-18T02:15:52.840

我遇到了同样的问题。在我的情况下，这两个项目都有相同的端口号。我能够通过更改其文件断点未命中的项目的端口号来解决它。

我的猜测是 IIS Express 正在缓存来自第二个项目的 pdb 文件，因为这两个文件具有相同的名称，并且这些项目具有相同的端口号。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-06-10T04:22:53.587

我有一个非常相似的问题。在我的情况下，问题是其中一个项目中的不同目标 .net 框架导致 VS2017 错误地加载另一个项目的源文件（同名），而不是被激活的项目

```
ObjectHandle handle = Activator.CreateInstance 
```

将项目的目标框架更改为在所有项目中都相同已修复它。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-04-27T13:30:21.260

**我（在VS 2008**中）碰巧有两个具有**相同内存地址**和**相同关联文件的**子断点。这些断点是在进程运行期间的某个时间产生的。

我注意到`.dll`我的项目文件夹中有重复的文件，**并解决了删除重复的问题`.dll`**，同时`.dll`在调试文件夹结构中每个名称只保留一个。（以我为例，我有`/bin/Example.dll`并且`/bin/Plug-in/Example.dll`都存在于我的调试文件夹结构下）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-10-07T16:25:04.423

我在另一个项目中具有相同文件名的另一个文件中设置了断点，我遇到了类似的问题。

这是因为调试是为其他项目启动的，而我试图设置断点的项目没有启动。在为预期项目执行 Debug > Start New Instance 后，断点创建工作正常。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-11-20T10:02:06.280

对我有用的（VS2017）是在“**要求源文件与原始版本完全匹配”中****禁用**此选项，该选项 默认启用，但我已将其打开。`Tools --> Options... --> Debugging --> General`

 **但这还不够，我还必须手动删除解决方案中所有项目`obj`的`bin`文件夹。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-02-15T11:59:47.673

删除断点错误命中的项目的所有 .pdb 文件。这将解决问题。***

# node.js - 错误：在 Heroku 上找不到模块“./proto”

> ID：12416194
> 
> 赞同：1
> 
> 时间：2012-09-13T23:25:58.890
> 
> 标签：node.js, heroku, connect, express

我似乎无法弄清楚为什么这在本地可以正常工作，但是当我将它推送到**Heroku**时，它失败并出现以下错误。

**Heroku 的错误**

```
Starting process with command `node web.js`

module.js:337
    throw new Error("Cannot find module '" + request + "'");
          ^
Error: Cannot find module './proto'
    at Function._resolveFilename (module.js:337:11)
    at Function._load (module.js:279:25)
    at Module.require (module.js:359:17)
    at require (module.js:375:17)
    at Object.<anonymous> (/app/node_modules/express/node_modules/connect/lib/connect.js:14:13)
    at Module._compile (module.js:446:26)
    at Object..js (module.js:464:10)
    at Module.load (module.js:353:31)
    at Function._load (module.js:311:12)
    at Module.require (module.js:359:17)
Process exited with status 1
State changed from starting to crashed 
```

**包.json**

```
{
  "name": "divtest",
  "version": "0.0.2",
  "dependencies": {
    "underscore": "1.3.x",
    "crypto": "0.0.x",
    "knox": "0.3.x",
    "mongoose": "~3.1.2",
    "mime": "1.2.x",
    "express": "3.0.x",
    "request": "~2.9.203"
  },
  "engines": {
    "node": "0.6.x",
    "npm": "1.0.x"
  }
} 
```

`./proto`是一个`connect`正在调用的本地模块

我吹走了我的`./node_modules`文件夹并做了一个`npm install --save`并且仍然得到相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T17:04:30.527

我遇到了这个问题，我的问题是我是一个 git 初学者并且没有正确提交所有需要的文件。看起来连接某处有一个 proto.js。

我做了一个 git add * (...) 并再次推送，一切都很顺利。

另一个明显的错误是，在推送时 Heroku 抱怨未满足的依赖关系。

# java - 3d 高度图地形和碰撞检测

> ID：12416195
> 
> 赞同：0
> 
> 时间：2012-09-13T23:26:03.513
> 
> 标签：java, math, 3d

3d 地形。

我有 3 个顶点定义一个平面。（高度图中最近的 3 个像素）

我在那架飞机上有一个 x,z。（我在世界上的位置）

你如何找到 y 截距？（这样我就站在那架飞机的表面上）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T23:36:47.787

平面方程为：

A *x + B* y + C *z = D，其中 D = A* x0 + B *y0 + C* z0，

如果您有三个顶点，请从顶点中找到两个向量。例如，对于三个顶点 T、U、V，将有一个向量**TU**和一个向量**UV**。

求两个向量的叉积。那是您的法线向量**n**，它具有三个分量 n1、n2 和 n3。

```
A = n1
B = n2
C = n3 
```

取其中一分。该点的坐标是 x0、y0 和 z0。

将其输入方程以计算 D。

然后用你的 x 和 z 代替 x 和 z 并求解 y！

所以最后 y 是：

```
y = (A*x0 + B*y0 + C*z0 - A*x - C*z)/B 
```

如果我的代数错了，请有人纠正我。

您可以像这样计算叉积：

对于两个向量**a**和**b**，分量分别为 a1、a2、a3 和 b1、b2、b3，叉积为：

![在此处输入图像描述](../Images/c4d1e5029940ca7ed535bc17c9928b12.png)

去：

![在此处输入图像描述](../Images/ca36d387f26c1db71a35ced6f0f23f91.png)

A = i-hat 的系数（加粗的 i）

B = j-hat 的系数（粗体 j）

C = k-hat 的系数（加粗的 k）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T08:19:18.667

您说您正在查看高度图中最近的三个像素，这让我假设您有一个规则网格，您可以从中提取顶点。在这种情况下，您可以使用图像插值方法来执行类似于 eboix 或[双三次](http://en.wikipedia.org/wiki/Bicubic_interpolation)插值的答案的[线性。](http://en.wikipedia.org/wiki/Bilinear_filtering)然后，您的高度值等于图像处理域中的亮度值。在线性情况下，数学要容易得多，而网格结构使得使用简单的形式成为可能。让 c 为您的像元大小，而 p、q、r 为您的 3 个顶点的高度值，如下所示

```
p    q
 +--.
 | /
 |/
r 
```

和 x 和 y 沿直角三角形的腿的距离。三角形当然是您的 3 个顶点在 x、y 平面上的投影。然后你的插值高度值是

```
z = (q-p)/c * x + (r-q)/c * y 
```

# app-store - 提前提交 App Store 支持 iOS6 和 iPhone 5

> ID：12416196
> 
> 赞同：0
> 
> 时间：2012-09-13T23:26:04.207
> 
> 标签：app-store, ios6, iphone-5

我正在为我的应用程序准备更新以完全兼容 iOS6 和 iPhone5 显示，因此最好在它们向公众发布之前将其提交到 App Store，让任何人都可以从第 1 天开始使用它。

Apple 表示开发人员现在可以提交他们的 iOS6 优化应用程序（我没有找到任何关于 iPhone 5 的信息），但我问自己是否可以 - 从今天开始 - 写类似“添加 iOS6 兼容性”或“支持 iPhone 5 显示”在更改日志中......或者他们会拒绝我的提交，因为我正在讲述一些尚未发布/出售的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T04:56:55.817

既然是官方的，你现在应该可以提交了！

# jquery - 通过jQuery停止将关键事件传播到特定的div

> ID：12416199
> 
> 赞同：1
> 
> 时间：2012-09-13T23:27:06.690
> 
> 标签：jquery, keypress, event-bubbling, event-propagation

假设您的 HTML 中具有以下结构，并且内容 div 中的某些元素具有各种键（按下、向上、向下）事件：

```
<html>
<head></head>
<body>
    <div id="content">All the content</div>
</body>
</html> 
```

您通过 jQuery 添加一个绝对定位的 div：

```
$('body').append('<div id="lightbox">etc.</div>'); 
```

您如何临时（在灯箱存在期间）防止所有键盘事件被**仅** `$('#content')`及其子级捕获或冒泡，以便上述结构的灯箱存在时的冒泡顺序将是

1.  `$('#lightbox *')`
2.  `$('#lightbox')`
3.  `$('body')`
4.  `$('html')`

而它将是

1.  `$('#content *')`
2.  `$('#content')`
3.  `$('body')`
4.  `$('html')`

灯箱什么时候不见了？

**编辑：**这里有一些额外的信息。

*   我不能使所有表单元素都被禁用或只读（这无论如何都适用于有限的元素），因为灯箱有时可能存在于许多已经分配了唯一键事件的表单元素之上。

*   另外，我希望关键事件影响窗口+（灯箱，如果有，否则为内容），所以我不能直接停止所有事件传播

*   上面的顺序可以是4-1而不是1-4，没关系。重要的是在关键事件中绕过这个特定元素的内容（灯箱或内容根据情况）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T03:26:05.030

如果我理解正确，您需要在灯箱显示时选择性地禁止关键事件。

我认为最简单的方法是将抑制放在事件处理程序中，如下所示：

*   当灯箱处于活动/非活动状态时升高/降低标志
*   在您希望被禁止的事件的所有处理程序中，如果引发标志，则立即返回。

*（您可以直接测试灯箱状态，无需使用标志）*

我认为这种方法应该比从广义上讲涉及以下任何一种方法的替代方法要容易得多：

*   防止/允许事件传播
*   分离和重新附加处理程序。

# 编辑

Inhan，在阅读了您自己的解决方案之后，这是我保持简单的想法。

## 制表符

必须有一种更简单的方法来控制标签顺序，而不是在打开灯箱对话框时模拟它。

如果您需要实现的全部效果是抑制选项卡以形成不在当前打开的对话框中的元素（并假设 jQuery UI 灯箱），那么只需设置`modal: true`选项。对于其他灯箱插件，请参阅他们的文档。

## 冒泡

您应该能够通过适当地构建您的 HTML 来消除从灯箱到“文档”或任何其他容器的不必要的事件冒泡。尝试遵循以下规则：

*   不要将任何事件委托给`document`. 选择更多本地容器。如有必要，将灯箱以外的所有内容包装在 a`<div id="pseudoBody">...</div>`中，以明确事件委托的目的，即。将事件委托给这个专用的、无样式的包装器，而不是`document`.
*   确保您的灯箱没有嵌套在委托事件的容器内，例如。通过将 lightbox(es) 放置在不超过一层的范围内，如果采用`<body>`的话，肯定在外部。`pseudoBody`
*   如果您需要允许一些灯箱事件冒泡，则委托给灯箱容器。`pseudoBody`为了节省代码（如果合适的话），您可以附加与附加到或其他地方相同的（命名的）事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T02:34:55.443

我找不到任何可靠的解决方案，所以我选择编写自己的函数。虽然我不太乐意搞砸它，但我必须控制 TAB 键的行为并创建全局 keyup/keydown 函数。

对于那些感兴趣的人，我在 SO、[here](https://stackoverflow.com/questions/7208161/focus-next-element-in-tab-index)、[here](https://stackoverflow.com/questions/10742349/focus-on-next-tabindex-of-html-element-onenter-keypress-by-jquery)和[here](https://stackoverflow.com/questions/1599660/which-html-elements-can-receive-focus)中找到了一些资源。

请注意，我为脚本中的锚分配了一个名为“已禁用”的 CSS 类，因此您可以考虑在我的代码中看到的那些，例如`disabled="disabled"`适用元素的属性。此外，我无法找到一种方法将其从 html 内容集中到浏览器的可选 UI 元素中，但这可能是最后一个问题。

```
// lightbox keyboard navigation
function getFocusList() {
    return $('body,#lightbox *:visible').filter(function(idx,elm) {
        if ($(elm).is('body')) return true;
        if (/^hidden$/i.test($(elm).css('visibility'))) return false;
        return (
            (/^a(rea)?$/i.test(elm.nodeName) && $(elm).hasAttr('href') && !$(elm).is('.disabled')) ||
            (/^(input|textarea|button|select)$/i.test(elm.nodeName) && !$(elm).prop('disabled')) ||
            (/^\d+$/.test($(elm).prop('tabindex')) && !$(elm).prop('disabled') && !$(elm).is('.disabled'))
        )
    });
}
function globalKeyDown(e) {
    var
        LB          = !!$('#lightbox').length,
        isTAB       = e.which == 9,
        isSHIFT     = e.which == 16,
        SHIFT_ON    = LB && typeof $('#lightbox').data('SHIFT_ON') != 'undefined'
    if (isSHIFT && LB) $('#lightbox').data('SHIFT_ON',true);
    if (!isTAB || !LB) return;
    var focusList = getFocusList(), nextIndex;
    var curIndex = $.inArray($(this).get(0),focusList);
    if (SHIFT_ON) nextIndex = --curIndex == 0 ? focusList.length - 1 : curIndex;
    else nextIndex = ++curIndex == focusList.length ? (focusList.length > 1 ? 1 : 0) : curIndex;
    var next = $(focusList[nextIndex]);
    e.preventDefault();
    e.stopImmediatePropagation();
    next.focus();
}
function globalKeyUp(e) {
    var
        LB          = !!$('#lightbox').length,
        isSHIFT     = e.which == 16,
        SHIFT_ON    = LB && typeof $('#lightbox').data('SHIFT_ON') != 'undefined'
    if (isSHIFT && SHIFT_ON) $('#lightbox').removeData('SHIFT_ON')
}

$.fn.extend({
    hasAttr:function(attrStr) {
        var res = true;
        $(this).each(function() {
            if (typeof $(this).attr(attrStr) == 'undefined') res = false;
        });
        return res;
    }
});
$(document).ready(function() {
    $('body')
    .on('focus','#lightbox a',function() {$(this).addClass('hover')})
    .on('blur','#lightbox a',function() {$(this).removeClass('hover')})
    .on('keydown','*',globalKeyDown).on('keyup','*',globalKeyUp)
    .on('keydown',globalKeyDown).on('keyup',globalKeyUp)
    // remaining jQuery code...
}); 
```

我希望这可以为其他有类似问题的人节省一些时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T23:39:16.033

操纵事件的本机传播顺序的唯一方法是更改​​ DOM 顺序。您不能以一种方式离开您的 DOM 结构并指定与 DOM 结构不同的自定义传播顺序。事件在 DOM 中冒泡。这就是浏览器进行事件传播的方式。

您可以使灯箱覆盖整个页面（绝对位置，整个页面的 z-index 高）并将键盘焦点设置为文档，这样除了灯箱和文档之外的其他元素都不会获得输入事件。这通常是使用灯箱覆盖完成的。如果它覆盖了其他元素（即使是部分透明的），那么它将拦截所有鼠标点击。如果您随后将键盘焦点设置为文档，那么键事件将永远不会转到页面中的元素，或者您可以使其以这种方式工作。如果您以这种方式放置灯箱并防止灯箱下方的任何东西获得键盘焦点，那么您应该获得第一个传播顺序。

工作示例：http: [//jsfiddle.net/jfriend00/q3r78/](http://jsfiddle.net/jfriend00/q3r78/)

此示例中还包含阻止默认处理击键的代码，因此您无法切换到其他字段。

# haskell - 我怎样才能让 cabal 安装酸状态？

> ID：12416201
> 
> 赞同：3
> 
> 时间：2012-09-13T23:27:28.840
> 
> 标签：haskell, cabal, acid-state

我是 Haskell 的新手，想尝试 acid-state 库，但在尝试安装它时得到以下输出：

```
>cabal install acid-state
Resolving dependencies...
Configuring acid-state-0.7.5...
Building acid-state-0.7.5...
Preprocessing library acid-state-0.7.5...
[ 1 of 15] Compiling Data.Acid.CRC    ( src\Data\Acid\CRC.hs, dist\build\Data\Ac
id\CRC.o )
[ 2 of 15] Compiling Paths_acid_state ( dist\build\autogen\Paths_acid_state.hs,
dist\build\Paths_acid_state.o )
[ 3 of 15] Compiling Data.Acid.Archive ( src\Data\Acid\Archive.hs, dist\build\Da
ta\Acid\Archive.o )
[ 4 of 15] Compiling FileIO           ( src-win32\FileIO.hs, dist\build\FileIO.o
 )

src-win32\FileIO.hs:43:5:
    Not in scope: `catchIO'
    Perhaps you meant `catch' (imported from Prelude)

src-win32\FileIO.hs:55:6:
    Not in scope: `tryE'
    Perhaps you meant `try' (imported from Control.Exception.Extensible)

src-win32\FileIO.hs:56:6:
    Not in scope: `tryE'
    Perhaps you meant `try' (imported from Control.Exception.Extensible)
cabal: Error: some packages failed to install:
acid-state-0.7.5 failed during the building phase. The exception was:
ExitFailure 1 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T04:29:29.063

我刚刚遇到了同样的问题。临时解决方法：安装旧版本的酸状态

```
cabal install acid-state-0.7.0 
```

# javascript - 保存给定文件的位置

> ID：12416206
> 
> 赞同：0
> 
> 时间：2012-09-13T23:27:51.920
> 
> 标签：javascript, html

我想知道是否可以选择一个文件，然后将文件的位置保存到数据库中，例如`C:\folder\another-folder\file.txt`通过 HTML 或 JavaScript？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T23:34:43.640

不可以。由于安全限制，您不能在浏览器中执行此操作。你可以得到它的名字（`file.txt'）。你唯一能做的就是给用户一个输入来选择和上传文件。在它在您的服务器上之后 - 您可以随心所欲地使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T23:34:53.877

不完全确定，因为我过去从未真正做过这样的事情——除非用户直接输入，否则很可能无法在本机系统中获取文件的实际位置，但也许你可以从上传文件？

[http://www.w3schools.com/jsref/dom_obj_fileupload.asp](http://www.w3schools.com/jsref/dom_obj_fileupload.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T23:33:24.923

Javascript 和 HTML 都在客户端（浏览器）上进行评估，因此如果没有任何服务器端脚本，这是不可能的。

# javascript - jQuery 移动 ajax 加载器图片

> ID：12416208
> 
> 赞同：0
> 
> 时间：2012-09-13T23:27:55.630
> 
> 标签：javascript, ajax, jquery, cordova

我在使用 phonegap 和 jQuery 构建的移动应用程序中使用此代码我想显示来自服务器的图片，但我无法集成`showPageLoadingMsg`功能，我不相信这种类型的 Ajax 调用有用且强大。所以我真的想知道我应该使用什么类型的 Ajax 调用以及如何`showPageLoadingMsg()`在我的 Android 手机应用程序中使用功能。

```
server = "http://monserveur.com/upload.php";
var wid = $(window).width();
    if (server) {
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange=function(){
            if(xmlhttp.readyState == 4){
        alert('ready');

                if (xmlhttp.status == 200  ) {
        alert('200');
                    document.getElementById('ousa').innerHTML = xmlhttp.responseText;
                }
                else {
                    document.getElementById('ousa').innerHTML = "Error retrieving pictures from server.";
                }
            }
        };
        xmlhttp.open("GET", server+"?wid="+wid, true);
        xmlhttp.send(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:52:21.087

你试过 [http://api.jquery.com/ajaxStart/](http://api.jquery.com/ajaxStart/)

[http://api.jquery.com/ajaxStop/](http://api.jquery.com/ajaxStop/)

并将它们与此处的逻辑相结合

[http://www.w3schools.com/jquery/ajax_ajaxstart.asp](http://www.w3schools.com/jquery/ajax_ajaxstart.asp)

```
$("div").ajaxStart(function(){
  $(this).html("<img src='demo_wait.gif' />");
})ajaxStop(function(){
   $(this).empty();
}); 
```

如果添加到自执行函数或脚本的 dom 就绪逻辑，这将基本上添加一个侦听器，该侦听器将等待与运行相关的任何 ajax。

```
$.post()
$.get()
$.ajax()
$.getJSON()
$.postJSON()
//any I missed? 
```

我还注意到您提到了 phonegap，您目前是否正在使用他们建议与 AJAX 请求一起使用的 xhr.js？如果不是我建议调查的内容，由于相同的域策略，您的 AJAX 可能只是默默地并且非常迅速地失败。xhr.js 超越了相同域策略的界限。

# objective-c - 在 iOS 中更改 ViewController 和传递数据

> ID：12416209
> 
> 赞同：1
> 
> 时间：2012-09-13T23:27:57.780
> 
> 标签：objective-c, ios, xcode, uiviewcontroller

我试图让我的应用程序拍照然后将图像传递到另一个视图进行编辑，但我似乎无法弄清楚如何更改视图，如何将“ID”添加到情节提要中的视图或如何在视图之间传递数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:12:57.013

两个 UIViewController 之间的通信需要手动管理，但是，如果您使用情节提要创建应用程序，则需要考虑一些事项。

假设您有 FirstViewController 和 SecondViewController（假设您在 Storyboard 中设置了所有内容）。FirstViewController 会将 UIImage 传递给 SecondViewController，它们看起来像这样。

```
@interface FirstViewController : UIViewController

- (IBAction)transitionToNextViewController;

@property (retain, nonatomic) UIImage *image;

@end

@implementation FirstViewContoller

- (IBAction)transitionToNextViewController;
{
    [self performSegueWithIdentifier:@"SegueIdentifier"];
}

@end 
```

和：

```
@interface SecondViewController : UIViewController

@property (retain, nonatomic) UIImage *image;

@end 
```

您可能想知道应该如何将图像传递给 SecondViewController。好吧，当使用故事板时，您的 UIViewControllers 将收到对其方法 prepareForSegue:sender: 的调用。您所要做的就是为那里的第二个 UIViewController 设置图像属性。

```
@implementation FirstViewController

- (IBAction)transitionToNextViewController;
{
    [self performSegueWithIdentifier:@"SegueIdentifier"];
}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    SecondViewController *secondViewController = (SecondViewController *)segue.destinationViewController; // You have to cast it

    secondViewController.image = self.image;
}

@end 
```

就是这样。[为了更好地理解故事板，请阅读此处](http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/Introduction/Introduction.html#//apple_ref/doc/uid/TP40011318)的苹果文档。

# facebook - 为什么使用无时区日期创建的事件在 facebook.com 上显示错误的时间？

> ID：12416213
> 
> 赞同：4
> 
> 时间：2012-09-13T23:28:06.540
> 
> 标签：facebook, facebook-graph-api, timezone

例如，以这个事件为例：

210489449014070 [Facebook 事件](https://www.facebook.com/events/210489449014070/)/[图形 API 浏览器](https://developers.facebook.com/tools/explorer?method=GET&path=210489449014070)

此事件创建于 2011 年 9 月。创建时，它正确显示 2011 年 11 月 11 日星期五晚上 11:11 作为事件的日期和时间。

但现在，它显示 2011 年 11 月 12 日星期六上午 12:11 作为日期。这也发生在未来的事件中，例如 426044564103401。

但是，即使在当前月份（例如 330237680381087）也不会发生这种情况。

其中显示了正确的日期（与图表显示的相同）。这是几个月前创建的。

我怀疑它仍在将 DST 偏移量应用于日期。例如，现在太平洋时间距离 UTC 7 小时（因为 DST 生效，因此是 PDT。） 2012-11-04，DST 将结束，它将回到 UTC 8 小时。它在秋天“回落”。

Facebook.com 前端的日期显示好像仍在使用 7 小时偏移量（比应有的时间提前一个小时。）我的假设/猜测是 2012-11-04 02:00:00，它将开始显示正确的日期。欢呼？但是到那时，现在正确的日期可能会显示错误（因为它不再适用 DST。）

我猜这意味着在内部，无时区事件现在被全球视为“-07:00”或“-08:00”，基于当前的 UTC 偏移量，而不是与日期相关的事件。

我是否必须提取所有 186,272 个事件并更新所有事件以使用时区日期来解决此问题（也影响前端向其他用户显示，并可能影响通过 FQL 等与这些事件交互的其他方）？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:55:17.747

当 Facebook 向无时区事件迁移时可能是一个问题[http://developers.facebook.com/roadmap/completed-changes/](http://developers.facebook.com/roadmap/completed-changes/)

# c# - 如何在 nopcommerce 中添加产品？

> ID：12416223
> 
> 赞同：0
> 
> 时间：2012-09-13T23:30:01.810
> 
> 标签：c#, asp.net-mvc, nopcommerce

我正在使用非商业 V2.6。所以我尝试在管理面板中添加新产品。我输入所有数据，然后单击保存按钮或保存并继续编辑按钮。

我有这样的错误。

```
 Object reference not set to an instance of an object.

    Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

    Exception Details: System.NullReferenceException: Object reference not set to an instance of an object.

    Source Error:

Line 546:                //default product variant
Line 547:                var variant = model.FirstProductVariantModel.ToEntity();             
Line 548:                variant.ProductId = product.Id;
Line 549:                variant.Published = true;
Line 550:                variant.DisplayOrder = 1; 
```

我的代码在下面有错误..

```
var variant = model.FirstProductVariantModel.ToEntity();             
                variant.ProductId = product.Id;
                variant.Published = true;
                variant.DisplayOrder = 1;
                variant.CreatedOnUtc = DateTime.UtcNow;
                variant.UpdatedOnUtc = DateTime.UtcNow;
                _productService.InsertProductVariant(variant);
                FirstVariant_UpdateLocales(variant, model.FirstProductVariantModel); 
```

我怎么能爱它。。

请帮助...谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T14:47:58.730

对于该产品，您必须在**默认产品变体信息**选项卡 下添加一个产品变体

# php - Zend Framework：获取 CPU 使用率

> ID：12416227
> 
> 赞同：0
> 
> 时间：2012-09-13T23:30:31.430
> 
> 标签：php, zend-framework

如何在 Zend Framework 中获取 CPU 使用率，因为当我使用某些浏览器打开某个页面时，我的 CPU 使用率增加到 100%？我使用 AppServ 2.5.10：Apache 2.2.8、PHP 5.2.6、MySQL 5.0.51b，我的 PC 配置：AMD Athlon 64 X2 2.21Ghz、4GB RAM DDR2。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T23:34:42.723

您可以使用[XDebug](http://xdebug.org/)来分析您的应用程序。它不仅会为您提供大量可供研究的指标（CPU 和内存使用情况等），而且您还可以看到应用程序的真正瓶颈。

# c# - Excel 自动化，如何检测用户是否在 Excel 工作表中运行宏或单击“运行宏”CommandBarControl？

> ID：12416229
> 
> 赞同：6
> 
> 时间：2012-09-13T23:30:33.797
> 
> 标签：c#, .net, excel, vba, vsto

.net 自动化库中是否有一些事件可以检测到正在处理 excel 文件的用户何时运行了宏？

例如，用户打开一个包含宏的 excel 文档，然后运行宏和附加到该 excel 进程的 .net 应用程序检测到启动宏事件？

或者可能将宏函数绑定到应用程序中的委托事件..

**编辑：**

**可以从后面的代码中捕获“运行宏”CommandBarControl 单击事件吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T12:46:41.613

我自己从来没有这样做过，我不能确定你将如何定义特定的应用程序事件，但这里的这个页面给了我一些关于通过类模块定义你自己的事件的有用信息。[http://www.cpearson.com/excel/Events.aspx](http://www.cpearson.com/excel/Events.aspx)

编辑：整个页面都在事件上，阅读有关定义自己的向下滚动约 4/5 的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T23:45:12.617

我不知道`.NET`自动化中是否存在“事件”，但我知道[TrackToAct.com](http://tracktoact.com/blog/)（完全披露我的公司）有一个`VBA`代码片段，或者`DLL`您进入跟踪事件。它使您能够标记事件并通过 Web 仪表板报告使用情况。

# c - reading file with mmap starting at 0x123456789 location

> ID：12416230
> 
> 赞同：0
> 
> 时间：2012-09-13T23:30:38.480
> 
> 标签：c, binaryfiles, mmap

I tried using mmap like this:

```
off_t offset = 0x123456789;
long pagesize = sysconf(_SC_PAGE_SIZE);
int pageoffset = offset % pagesize;

//Open file, get file descriptor
fd = open("./test", O_RDONLY);
map_main = mmap(NULL, 106 + pageoffset, PROT_READ | PROT_EXEC,
                    MAP_SHARED, fd, offset - pageoffset); 
```

Not behaving as expected.

Am I doing right, for reading file from specific location? Reference: [Segfault while using mmap in C for reading binary files](https://stackoverflow.com/questions/10164364/segfault-while-using-mmap-in-c-for-reading-binary-files)

# delphi - 进程名称在 Delphi XE 附加到进程对话框中不可见 - 无法调试

> ID：12416231
> 
> 赞同：4
> 
> 时间：2012-09-13T23:30:46.797
> 
> 标签：delphi, debugging, iis-7.5, delphi-xe, isapi

设想：

*   Delphi ISAPI dll 使用 Delphi XE，32 位编写。

    ISAPI dll 在 Win 7 64 企业台式机上通过 IIS 7.5 运行。

    DLL 运行良好。

    使用 Run->Attach to Process 在 Delphi XE IDE 中调试 ISAPI DLL：

    启动 ISAPI DLL 并附加到调试器中的 wpw3.exe *32 进程 - 可以在 ISAPI 上下文中运行时跟踪和调试代码。

问题：

*   我的硬盘上周坏了，我安装了新的 Win 7 - 标准的公司范围 Win 7 64 Enterprise 映像（与我之前的 Win 7 64 安装不同）。

    现在，当我进入运行->附加到进程时，我不再按名称看到 wpw3.exe *32 进程，尽管它在任务管理器中按名称可见。在“附加到进程”对话框中调用“显示系统进程”选项没有帮助。

    我现在看到的（我以前在旧部署中**从未**见过）是一长串带有 PID 的“通用”系统进程，但除了“系统”之外没有其他描述。

    其中一个进程是我的 wpw3.exe *32 进程，我已经使用 MS 的 Process Explorer 确定了它的 PID。但是，如果我尝试附加到该进程，我会收到一条错误消息 - “无法创建进程 - 访问被拒绝” - 所以我无法调试。（相同的错误消息“错误打开进程，访问被拒绝”也会在进程资源管理器中显示某些属性，尽管进程的描述性名称“wpw3.exe *32”在那里可见，与 PID 相关联。）

    如何让 Run->Attach to process 对话框显示正确的 wpw3.exe *32 进程名称并附加到它，以便我可以调试？

    这是德尔福问题吗？IIS 问题？ISAPI 问题？这是一个问题吗？即缺乏描述性的进程名称和无法附加到进程是由同一问题引起的；还是这两个问题：一个问题是缺少描述性名称，另一个问题是无法附加到流程？

    （不想使用 - 不能真正使用 - webApp 调试器 - 这些是 ISAPI dll，它们完全按照在 IIS 中编写和调试的方式部署到生产环境 - 我需要看到它们在 IIS 上下文中运行。）

*   多年来一直以这种方式调试 ISAPI dll，使用不同版本的 Delphi 以及在各种操作系统和服务器环境中没有任何问题 - 以前从未遇到过这个问题。我难住了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T23:45:02.763

我的帐户有管理员权限，但我觉得我应该尝试以管理员身份运行 DelphiXE –**使用“以管理员身份运行”选项启动它。**

我收到提示'你想允许...' - 单击是，Delphi 运行。设置我的进程并连接并跟踪我的代码 - 进程名称现在可见，我可以附加到我的 IIS 进程并在 Delphi 调试器中进行调试。

无论出于何种原因，我在之前的部署中都不必执行此步骤 - 但问题已解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-16T04:32:44.153

如果您想在 64 位操作系统上调试 32 位 ISAPI dll，您可以使用以下过程。

这假定您已按照其他步骤允许 32 位 ISAPI dll 工作。

1.  停止 IIS

    净停止 w3svc

2.  在调试模式下启动 32 位工作进程

    %SYSTEMROOT%\SysWOW64\inetsrv\w3wp -debug

3.  在调试器中附加到 w3wp。正如您所指出的，您需要以提升的权限运行 Delphi 才能使其工作。

# bash - 使用 bash eval 内置允许 ini 文件中包含命令字符串

> ID：12416237
> 
> 赞同：0
> 
> 时间：2012-09-13T23:31:16.483
> 
> 标签：bash, shell, variables, eval

我一直在整理一个 bash 脚本，该脚本接受一个 ini 文件（具有我一直在与脚本一起开发的格式）并通读该文件，执行指定的操作。

ini 格式的函数之一允许使用`eval`. 当命令包含变量名时，我遇到了问题。

`eval`（或一般的外壳）似乎没有正确替换值，并且大多数时候它似乎用空格替换所有变量名，从而破坏了命令。创建字符串输出的子shell 似乎也有同样的问题。

奇怪的是，这在我的开发机器上运行（运行 linux mint 13），但是当我将脚本移动到运行 CentOS 5.8 的目标机器时，这些问题就出现了。

我从 ini 文件中读取的一些代码示例：

```
shellcmd $toolspath/program > /path/file

shellcmd parsedata=$( cat /path/file ) 
```

这些通过一个脚本函数剥离前导`shellcmd`，然后使用 evals 字符串

```
eval ${scmd} 
```

关于可能导致奇怪行为的原因以及我可以尝试解决问题的任何想法？我的最终目标是能够从文件中读取一行并让我的脚本执行它，并能够正确处理读取命令中的脚本变量。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T00:24:48.693

我为导致此问题的一个命令找到了合适的替代方法，因此我将此问题标记为已解决。

从我所有的调查来看，我似乎在 bash shell 中发现了一个不为人知的错误。我试图评估的特定命令在其输出中返回了一个终端代码，并且由于 shell 处于读取循环中，输入从文件重定向，因此导致了一些奇怪的行为。我的解决方案是将对该特定命令的调用移到读取循环之外。它仍然没有解决根本问题，我认为这是 bash shell 中的一个错误。希望这会帮助遇到同样（晦涩）问题的其他人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T11:55:15.033

使用 Bash 3.2.25 (CentOS 5) 我试过这个，它工作正常：

```
toolspath='/bin'
while read prefix scmd
do
    if [[ $prefix == 'shellcmd' ]]
    then
        echo "Evaluating: <$scmd>"
        eval ${scmd}
    else
        echo "$prefix ignored"
    fi
done < ini 
```

和：

```
shellcmd $toolspath/ls > /home/user1/file     
shellcmd parsedata=$( cat /home/user1/file )
shellcmd echo $parsedata 
```

我显然必须设置路径。很可能您在切换机器时必须更改路径。你的路径有嵌入空间吗？

你是如何传输文件的？你可能是通过 Windows 去的吗？一时兴起，我`unix2dos`在`ini`文件上做了一个，我得到了与你描述的相似的症状。这是我最好的猜测。

# spring - 如何使spring roo菜单树像JQuery菜单一样折叠

> ID：12416239
> 
> 赞同：0
> 
> 时间：2012-09-13T23:31:26.167
> 
> 标签：spring, menu, spring-roo, jspx

问题是不言自明的。我需要树形菜单，可以折叠哪个菜单类别...

任何帮助深表感谢。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T05:10:39.613

我认为您需要根据需要搜索不同的 CSS 样式。具体与 Spring ROO 无关。

我认为您应该探索 twitter 提供的 Bootstrap CSS。这是一个非常好的和标准的 CSS 库。看看这个[链接](http://twitter.github.com/bootstrap/)。它可以在 github 上下载。

希望这对您有所帮助。干杯。

# c# - 缩小任何图像尺寸

> ID：12416242
> 
> 赞同：3
> 
> 时间：2012-09-13T23:31:47.203
> 
> 标签：c#, asp.net, image, image-processing, image-size

# 计划

我需要减小图像尺寸，同时保持一些质量。但是，我接受 GIF、JPEG、JPG 和 PNG。

* * *

# 目前的情况

图片的上传功能完全正常，我已经能够成功地缩放它的宽度和/或高度。

我[在 Stackoverflow 上找到了一篇很棒的帖子](https://stackoverflow.com/a/4161930/183268)，它给了我一个很好的代码示例：

```
Image myImage = //... load the image somehow 
```

// 以50%的质量保存图片 SaveJpeg (destImagePath, myImage, 50); //添加这个！使用 System.Drawing.Imaging；

```
 /// <summary> 
    /// Saves an image as a jpeg image, with the given quality 
    /// </summary> 
    /// <param name="path">Path to which the image would be saved.</param> 
    // <param name="quality">An integer from 0 to 100, with 100 being the 
    /// highest quality</param> 
    public static void SaveJpeg (string path, Image img, int quality) 
    { 
        if (quality<0  ||  quality>100) 
            throw new ArgumentOutOfRangeException("quality must be between 0 and 100."); 

        // Encoder parameter for image quality 
        EncoderParameter qualityParam = 
            new EncoderParameter (Encoder.Quality, quality); 
        // Jpeg image codec 
        ImageCodecInfo   jpegCodec = GetEncoderInfo("image/jpeg"); 

        EncoderParameters encoderParams = new EncoderParameters(1); 
        encoderParams.Param[0] = qualityParam; 

        img.Save (path, jpegCodec, encoderParams); 
    } 

    /// <summary> 
    /// Returns the image codec with the given mime type 
    /// </summary> 
    private static ImageCodecInfo GetEncoderInfo(string mimeType) 
    { 
        // Get image codecs for all image formats 
        ImageCodecInfo[] codecs = ImageCodecInfo.GetImageEncoders(); 

        // Find the correct image codec 
        for(int i=0; i<codecs.Length; i++) 
            if(codecs[i].MimeType == mimeType) 
                return codecs[i]; 
        return null; 
    } 
```

但是，此代码似乎仅适用于 JPEG 图像。

* * *

# 问题

1.  JPEG 格式比 PNG 或 GIF 轻吗？如果是这样，我应该将所有图像转换并保存为 JPEG 格式吗？
    *   在这种情况下，示例代码应该可以正常工作吧？
    *   如果没有，给定示例代码，我们可以使用其他格式做什么？
2.  我们可以在 C# 中使用哪些工具来减少图像重量？*（除了缩小尺寸）*
3.  为了保持可读性、颜色、清晰度和清晰度的合理状态，建议的图像“质量损失”是多少？
4.  服务器上的图像处理是否“繁重”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T23:50:55.937

First of all, JPEG uses a "lossy" compression algorithm, which is why you can tune the quality. Lower quality will result better compression at the cost of higher data loss. Also realize that the JPEG format is designed for photograph-like images, and applying JPEG to other types of images can be disappointing (google "jpeg artifacts").

PNG and GIF are lossless, so they can't support a quality parameter. This isn't to say that you can't get better compression out of them - there's a variety of tools to reduce the size of your PNG's (pngcrush, punypng, etc), but these tools (mostly) work in a fundamentally different way than JPEG compressors do. One thing to note is that GIF supports a smaller palette than PNG - only up to 256 colors.

So to answer your questions in order:

1.  Can't really compare, since compression in JPEG comes with a tradeoff while compression in PNG and GIF doesn't, and how tolerable the tradeoff is depends on the type of image. That is, JPEG will often give better compression, but if the image isn't a photograph the result will be noticeably worse.

2.  Your code for JPEG is fine. Google for C#-compatible tools for PNG.

3.  You'll need to experiment with the types of images you expect.

4.  Yes.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T05:44:11.043

您可能想阅读我的文章[20 Image Resizing pitfalls](http://nathanaeljones.com/163/20-image-resizing-pitfalls/)。它涵盖了您 4 个问题中的 3 个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-12T09:44:58.857

我们可以通过不同的方式做到这一点，

最好的方法之一是将所有图像转换为 jpeg，因为它会以更小的尺寸提供更好的清晰度，在这种情况下，我们不需要更改特定图像的任何高度或宽度

方法1：将所有图像转换为jpeg（无需额外压缩）

```
 private static void VaryQualityLevel(Image imgToResize,string imageName)
      {
        // Get a bitmap.
        Bitmap bmp1 = new Bitmap(imgToResize);
        ImageCodecInfo jgpEncoder = GetEncoder(ImageFormat.Jpeg);

        // Create an Encoder object based on the GUID
        // for the Quality parameter category.
        System.Drawing.Imaging.Encoder myEncoder =
            System.Drawing.Imaging.Encoder.Quality;

        // Create an EncoderParameters object.
        // An EncoderParameters object has an array of EncoderParameter
        // objects. In this case, there is only one
        // EncoderParameter object in the array.
        EncoderParameters myEncoderParameters = new EncoderParameters(1);

        EncoderParameter myEncoderParameter = new EncoderParameter(myEncoder,
            50L);
        myEncoderParameters.Param[0] = myEncoderParameter;

        var fileSavePath = Path.Combine(HttpContext.Current.Server.MapPath("~/Download/"), imageName+".jpeg");
        bmp1.Save(fileSavePath, jgpEncoder,
            myEncoderParameters);

        //myEncoderParameter = new EncoderParameter(myEncoder, 100L);
        //myEncoderParameters.Param[0] = myEncoderParameter;
        //fileSavePath = Path.Combine(HttpContext.Current.Server.MapPath("~/Download/"), "TestPhotoQuality100.jpeg");
        //bmp1.Save(fileSavePath, jgpEncoder,
        //    myEncoderParameters);

        // Save the bitmap as a JPG file with 75 quality level compression.
        myEncoderParameter = new EncoderParameter(myEncoder, 75L);
        //myEncoderParameters.Param[0] = myEncoderParameter;
        //fileSavePath = Path.Combine(HttpContext.Current.Server.MapPath("~/Download/"), "TestPhotoQuality75.jpeg");
        //bmp1.Save(fileSavePath, jgpEncoder,
        //    myEncoderParameters);

    }

    private static ImageCodecInfo GetEncoder(ImageFormat format)
    {

        ImageCodecInfo[] codecs = ImageCodecInfo.GetImageDecoders();

        foreach (ImageCodecInfo codec in codecs)
        {
            if (codec.FormatID == format.Guid)
            {
                return codec;
            }
        }
        return null;
        } 
```

方法2：通过改变图像的高度和宽度（没有jpeg转换）

CommonConstant.CS

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace EmptyDemo.compression
{
#region[Directive]
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
#endregion[Directive]

/// <summary>
/// This class is used to get the constants
/// </summary>
public class CommonConstant
{
    public const string JPEG = ".jpeg";
    public const string PNG = ".png";
    public const string JPG = ".jpg";
    public const string BTM = ".btm";
}
} 
```

图像压缩.CS

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace EmptyDemo.compression
{
#region[Directive]
using System;
using System.Collections.Generic;
using System.Linq;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
#endregion[Directive]

/// <summary>
/// This class is used to compress the image to
/// provided size
/// </summary>
public class ImageCompress
{
    #region[PrivateData]
    private static volatile ImageCompress imageCompress;
    private Bitmap bitmap;
    private int width;
    private int height;
    private Image img;
    #endregion[Privatedata]

    #region[Constructor]
    /// <summary>
    /// It is used to restrict to create the instance of the      ImageCompress
    /// </summary>
    private ImageCompress()
    {
    }
    #endregion[Constructor]

    #region[Poperties]
    /// <summary>
    /// Gets ImageCompress object
    /// </summary>
    public static ImageCompress GetImageCompressObject
    {
        get
        {
            if (imageCompress == null)
            {
                imageCompress = new ImageCompress();
            }
            return imageCompress;
        }
    }

    /// <summary>
    /// Gets or sets Width
    /// </summary>
    public int Height
    {
        get { return height; }
        set { height = value; }
    }

    /// <summary>
    /// Gets or sets Width
    /// </summary>
    public int Width
    {
        get { return width; }
        set { width = value; }
    }

    /// <summary>
    /// Gets or sets Image
    /// </summary>
    public Bitmap GetImage
    {
        get { return bitmap; }
        set { bitmap = value; }
    }
    #endregion[Poperties]

    #region[PublicFunction]
    /// <summary>
    /// This function is used to save the image
    /// </summary>
    /// <param name="fileName"></param>
    /// <param name="path"></param>
    public void Save(string fileName, string path)
    {
        if (ISValidFileType(fileName))
        {
            string pathaname = path + @"\" + fileName;
            save(pathaname, 60);
        }
    }
    #endregion[PublicFunction]

    #region[PrivateData]
    /// <summary>
    /// This function is use to compress the image to
    /// predefine size
    /// </summary>
    /// <returns>return bitmap in compress size</returns>
    private Image CompressImage()
    {
        if (GetImage != null)
        {
            Width = (Width == 0) ? GetImage.Width : Width;
            Height = (Height == 0) ? GetImage.Height : Height;
            Bitmap newBitmap = new Bitmap(Width, Height, PixelFormat.Format24bppRgb);
            newBitmap = bitmap;
            newBitmap.SetResolution(80, 80);
            return newBitmap.GetThumbnailImage(Width, Height, null, IntPtr.Zero);
        }
        else
        {
            throw new Exception("Please provide bitmap");
        }
    }

    /// <summary>
    /// This function is used to check the file Type
    /// </summary>
    /// <param name="fileName">String data type:contain the file name</param>
    /// <returns>true or false on the file extention</returns>
    private bool ISValidFileType(string fileName)
    {
        bool isValidExt = false;
        string fileExt = Path.GetExtension(fileName);
        switch (fileExt.ToLower())
        {
            case CommonConstant.JPEG:
            case CommonConstant.BTM:
            case CommonConstant.JPG:
            case CommonConstant.PNG:
                isValidExt = true;
                break;
        }
        return isValidExt;
    }

    /// <summary>
    /// This function is used to get the imageCode info
    /// on the basis of mimeType
    /// </summary>
    /// <param name="mimeType">string data type</param>
    /// <returns>ImageCodecInfo data type</returns>
    private ImageCodecInfo GetImageCoeInfo(string mimeType)
    {
        ImageCodecInfo[] codes = ImageCodecInfo.GetImageEncoders();
        for (int i = 0; i < codes.Length; i++)
        {
            if (codes[i].MimeType == mimeType)
            {
                return codes[i];
            }
        }
        return null;
    }
    /// <summary>
    /// this function is used to save the image into a
    /// given path
    /// </summary>
    /// <param name="path">string data type</param>
    /// <param name="quality">int data type</param>
    private void save(string path, int quality)
    {
        img = CompressImage();
        ////Setting the quality of the picture
        EncoderParameter qualityParam =
            new EncoderParameter(System.Drawing.Imaging.Encoder.Quality, quality);
        ////Seting the format to save
        ImageCodecInfo imageCodec = GetImageCoeInfo("image/jpeg");
        ////Used to contain the poarameters of the quality
        EncoderParameters parameters = new EncoderParameters(1);
        parameters.Param[0] = qualityParam;
        ////Used to save the image to a  given path
        img.Save(path, imageCodec, parameters);
    }
    #endregion[PrivateData]
}
} 
```

在这里，我在 jquery 和 Web 服务的帮助下上传图像，并将文件作为 formdata 传递

```
 [WebMethod]
    public void UploadFile()
     {
         if (HttpContext.Current.Request.Files.AllKeys.Any())
         {
             // Get the uploaded image from the Files collection
             var httpPostedFile = HttpContext.Current.Request.Files["UploadedImage"];
             if (httpPostedFile != null)
             {
                 ImageCompress imgCompress = ImageCompress.GetImageCompressObject;
                 imgCompress.GetImage = new System.Drawing.Bitmap(httpPostedFile.InputStream);
                 imgCompress.Height = 260;
                 imgCompress.Width = 358;
                 //imgCompress.Save(httpPostedFile.FileName, @"C:\Documents and Settings\Rasmi\My Documents\Visual Studio2008\WebSites\compressImageFile\Logo");
                 imgCompress.Save(httpPostedFile.FileName, HttpContext.Current.Server.MapPath("~/Download/"));

             }
         }
     } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-31T09:01:11.260

我使用相同的概念来调整图像大小而不会仅通过更改缩放因子来降低质量。在社交网站上传图片后，他们会缩小照片的大小，但看到我尝试写这篇文章后质量会一样

```
using System.Drawing.Imaging;
using System.Drawing;

public partial class Default3 : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        VaryQualityLevel();
    }
    private void VaryQualityLevel()
    {
        Bitmap bmp1 = new Bitmap(Server.MapPath("test2.png"));
        ImageCodecInfo jgpEncoder = GetEncoder(ImageFormat.Jpeg);
        System.Drawing.Imaging.Encoder myEncoder =System.Drawing.Imaging.Encoder.Quality;
        EncoderParameters myEncoderParameters = new EncoderParameters(1);
        EncoderParameter myEncoderParameter = new EncoderParameter(myEncoder, 50L);
        myEncoderParameters.Param[0] = myEncoderParameter;
        bmp1.Save(Server.MapPath("~/Images/1.jpg"), jgpEncoder, myEncoderParameters);
        //myEncoderParameter = new EncoderParameter(myEncoder, 75L);
        //myEncoderParameters.Param[0] = myEncoderParameter;
        //bmp1.Save(Server.MapPath("~/Images/2.jpg"), jgpEncoder, myEncoderParameters);

    }
    private ImageCodecInfo GetEncoder(ImageFormat format)
    {
        ImageCodecInfo[] codecs = ImageCodecInfo.GetImageDecoders();

        foreach (ImageCodecInfo codec in codecs)
        {
            if (codec.FormatID == format.Guid)
            {
                return codec;
            }
        }
        return null;
    }
} 
```

# css - 将画布设置为固定到窗口宽度并在没有javascript的情况下调整大小？

> ID：12416246
> 
> 赞同：4
> 
> 时间：2012-09-13T23:32:05.590
> 
> 标签：css, html, canvas, css-position

我正在创建一个带有画布的图像查看器，该画布将在新窗口中打开。我希望画布是窗口的宽度，距离顶部和底部 100 像素。我还希望它在不使用 javascript 的情况下调整大小（让我处理 javascript 中的重绘 - 我只想看到画布保持固定在窗口边缘的顶部和底部间距。）我该怎么做？我尝试了以下但右侧和底部被忽略：

```
.contextCanvas
{
    position: fixed;
    left: 0px;
    right: 0px;
    top: 100px;
    bottom: 100px;
} 
```

关于为什么浏览器会愉快地忽略右侧和底部的任何建议或推理？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-13T23:32:05.590

我找到了答案——我必须将画布包装在一个固定位置的容器 div 中，然后将内部画布设置为绝对定位和 100% 的宽度和高度。

HTML

```
<div class="canvasContainer">
    <canvas class="contextCanvas"></canvas>
</div> 
```

这是CSS

```
.canvasContainer
{
    position: fixed;
    left: 0px;
    right: 0px;
    top: 100px;
    bottom: 100px;
    z-index: 1;
    background-color: Black;
}

.contextCanvas
{   position: absolute;
    width: 100%;
    height: 100%;
    left: 0px;
    top: 0px;
    z-index: 1;
} 
```

# c# - 使用 Sha256 散列字符串

> ID：12416249
> 
> 赞同：160
> 
> 时间：2012-09-13T23:32:24.230
> 
> 标签：c#, string, hash, sha256

我尝试使用 SHA256 对字符串进行哈希处理，我正在使用以下代码：

```
using System;
using System.Security.Cryptography;
using System.Text;
 public class Hash
    {
    public static string getHashSha256(string text)
    {
        byte[] bytes = Encoding.Unicode.GetBytes(text);
        SHA256Managed hashstring = new SHA256Managed();
        byte[] hash = hashstring.ComputeHash(bytes);
        string hashString = string.Empty;
        foreach (byte x in hash)
        {
            hashString += String.Format("{0:x2}", x);
        }
        return hashString;
    }
} 
```

但是，与我的朋友 php 以及在线生成器（例如[This generator](http://hash.online-convert.com/sha256-generator)）相比，此代码给出了明显不同的结果

有谁知道错误是什么？不同的基地？

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2012-09-13T23:50:01.037

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2013-02-05T14:33:36.023

我也遇到了另一种实现方式的问题，但我忘记了我从哪里得到它，因为它是 2 年前的。

```
static string sha256(string randomString)
{
    var crypt = new SHA256Managed();
    string hash = String.Empty;
    byte[] crypto = crypt.ComputeHash(Encoding.ASCII.GetBytes(randomString));
    foreach (byte theByte in crypto)
    {
        hash += theByte.ToString("x2");
    }
    return hash;
} 
```

当我`abcdefghi2013`出于某种原因输入类似内容时，它会给出不同的结果并导致我的登录模块出现错误。然后我尝试按照 Quuxplusone 建议的相同方式修改代码，并将编码从 更改`ASCII`为`UTF8`然后它终于起作用了！

```
static string sha256(string randomString)
{
    var crypt = new System.Security.Cryptography.SHA256Managed();
    var hash = new System.Text.StringBuilder();
    byte[] crypto = crypt.ComputeHash(Encoding.UTF8.GetBytes(randomString));
    foreach (byte theByte in crypto)
    {
        hash.Append(theByte.ToString("x2"));
    }
    return hash.ToString();
} 
```

*再次感谢 Quuxplusone 的精彩而详细的回答！:)*

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2019-11-27T23:13:26.827

```
public static string ComputeSHA256Hash(string text)
{
    using (var sha256 = new SHA256Managed())
    {
        return BitConverter.ToString(sha256.ComputeHash(Encoding.UTF8.GetBytes(text))).Replace("-", "");
    }                
} 
```

你得到不同结果的原因是你没有使用相同的字符串编码。您为计算 SHA256 的在线网站放置的链接使用 UTF8 编码，而在您的示例中，您使用了 Unicode 编码。它们是两种不同的编码，因此您不会得到相同的结果。通过上面的示例，您可以获得链接网站的相同 SHA256 哈希值。您还需要在 PHP 中使用相同的编码。

每个软件开发人员绝对、绝对必须了解 Unicode 和字符集的绝对最低要求（没有借口！）

[https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/](https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-05-18T19:26:19.180

有史以来最短和最快的方式。只有1行！

```
public static string StringSha256Hash(string text) =>
    string.IsNullOrEmpty(text) ? string.Empty : BitConverter.ToString(new System.Security.Cryptography.SHA256Managed().ComputeHash(System.Text.Encoding.UTF8.GetBytes(text))).Replace("-", string.Empty); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-01-13T11:07:38.420

在 PHP 版本中，您可以在最后一个参数中发送“true”，但默认为“false”。以下算法等效于将 'sha256' 作为第一个参数传递时的默认 PHP 哈希函数：

```
public static string GetSha256FromString(string strData)
    {
        var message = Encoding.ASCII.GetBytes(strData);
        SHA256Managed hashString = new SHA256Managed();
        string hex = "";

        var hashValue = hashString.ComputeHash(message);
        foreach (byte x in hashValue)
        {
            hex += String.Format("{0:x2}", x);
        }
        return hex;
    } 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-09-23T07:00:05.157

```
public string EncryptPassword(string password, string saltorusername)
        {
            using (var sha256 = SHA256.Create())
            {
                var saltedPassword = string.Format("{0}{1}", salt, password);
                byte[] saltedPasswordAsBytes = Encoding.UTF8.GetBytes(saltedPassword);
                return Convert.ToBase64String(sha256.ComputeHash(saltedPasswordAsBytes));
            }
        } 
```

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2020-07-29T11:40:27.487

这在 .NET Core 3.1 中对我有用。
但不在 .NET 5 预览版 7 中。

```
using System;
using System.Security.Cryptography;
using System.Text;

namespace PortalAplicaciones.Shared.Models
{
    public class Encriptar
    {
        public static string EncriptaPassWord(string Password)
        {
            try
            {
                SHA256Managed hasher = new SHA256Managed();

                byte[] pwdBytes = new UTF8Encoding().GetBytes(Password);
                byte[] keyBytes = hasher.ComputeHash(pwdBytes);

                hasher.Dispose();
                return Convert.ToBase64String(keyBytes);
            }
            catch (Exception ex)
            {
                throw new Exception(ex.Message, ex);
            }
        }  
    }
} 
```

# python - HTML 未在 Django 文本字段中呈现

> ID：12416253
> 
> 赞同：8
> 
> 时间：2012-09-13T23:32:59.113
> 
> 标签：python, django, django-forms, markdown

我正在尝试使用降价来避免在我的 wiki 表单中键入 HTML，但由于某种原因，表单显示的是 HTML 代码而不是预期的格式。

我的视图功能如下：

```
from django.shortcuts import render_to_response
from mywiki.wiki.models import Page
from django.http import HttpResponseRedirect
import markdown

def view_page(request, page_name):
    try:
        page = Page.objects.get(pk=page_name)
    except Page.DoesNotExist:
        return render_to_response('create.html', {'page_name':page_name})

    content = page.content    
    return render_to_response('view.html', {'page_name':page_name, 'content':markdown.markdown(content)}) 
```

这是我的 view.html 模板：

```
{% extends 'base.html' %}
{% load wikilink %}

{% block title %}{{page_name}}{% endblock %}

{% block content %}
        <h1>{{page_name}}</h1>
        {{content|wikify}}
        <hr/>
        <a href='/mywiki/{{page_name}}/edit/'>Edit this page?</a>

{% endblock %} 
```

这是我的base.html：

```
<html>
    <head>
        <title>{{% block title %}{% endblock %}</title>
    </head>
    <body>
<div>
Menu: <a href='/mywiki/Start/'>Start Page</a>
</div>
        {% block content %}
        {% endblock %}
    </body>
</html> 
```

我确实安装了 markdown，我的 Django 版本是 1.4.1 (Mac)。

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-13T23:36:53.313

使用 Django 的[安全过滤器](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#safe)，以免您的 Html 被转义。

```
{{ content|safe }} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T23:35:47.130

```
{% autoescape off %}
{{content|wikify}}
{% endautoescape %} 
```

也许 ...

# iphone - AS3 Flash Professional iPhone iOS app 播放 flv

> ID：12416258
> 
> 赞同：0
> 
> 时间：2012-09-13T23:33:42.123
> 
> 标签：iphone, ios, actionscript-3, flash, flv

我刚刚使用 Flash Professional 中的 as3 使用 FLV 视频编写了我的第一个 iPhone 应用程序，但视频真的很慢而且断断续续。关于如何提高 iOS 视频性能的任何想法？

# linux - SSH多终端MAC

> ID：12416264
> 
> 赞同：0
> 
> 时间：2012-09-13T23:34:10.047
> 
> 标签：linux, macos, ssh, remote-access

我必须远程登录才能完成我的工作。有什么方法可以登录同一台机器并在我的笔记本电脑中有多个终端？我可以 SSH 多次，但效率不高。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T23:51:29.230

As Gung Foo said, **screen** is the way to go. Also check out Total Terminal a hot-key toggled dropdown terminal for mac, with tabs.

[http://totalterminal.binaryage.com/](http://totalterminal.binaryage.com/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T23:47:11.420

使用`screen`. 它是一个程序，允许您在同一个 tty 上拥有多个 shell 并在它们之间切换。

[人屏](http://linux.die.net/man/1/screen)

[屏幕命令示例](http://www.thegeekstuff.com/2010/07/screen-command-examples/)

# c - 查找内核的内存页面所有权

> ID：12416267
> 
> 赞同：0
> 
> 时间：2012-09-13T23:34:34.500
> 
> 标签：c, linux, caching, memory, paging

我正在 Linux 机器上编写一个 C 程序，它需要分配一个 10 到 20 GB 的巨大数组。

分配空间后，我想知道哪个核心拥有该数组的哪些页面。“拥有”是指哪个核心负责哪个页面的连贯性。

是否有任何函数或 shell 命令来获取此信息？

注意：我正在使用带有 gcc4.7 的 Debian。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T00:57:42.637

分配内存时，内核通常只分配虚拟内存；内容（RAM 页）仅在第一次访问时填充。如果被驱逐到文件（文件支持的内存映射）或交换（所有其他内存），它们将在驱逐后的下一次访问时重新填充。这意味着进程分配的每一页内存可能不存在（按照惯例，它在第一次访问时会读取为零），在 RAM 中，或者被驱逐（到磁盘或其他非 RAM 存储介质）。

在标准的多核/多 CPU 机器上，“所有权”是基于缓存线确定的，缓存线通常是 2 的小幂，介于 16 和 256 字节之间。每个 CPU “拥有”它最后接触过的高速缓存行。随着进程的运行，CPU和内核运行代码，从而访问代码，发生变化，因此没有固定的“所有者”；它动态变化。此外，管理通常由特定的芯片、内存管理单元或 MMU 完成，而不是由 CPU 运行的代码完成。（现在，MMU 通常集成到 CPU 中。）您可以将进程固定为仅在某些 CPU 内核或多个内核上运行，并基于该*猜测*哪个 CPU 内核拥有哪个内存。而且我猜一些 MMU 可能有办法报告它给哪个 CPU 内核提供了哪些缓存线——尽管我严重怀疑它在实践中是否可行。

CPU 内核“拥有”内存的整个想法非常奇怪。我认为 Linux 内核本身甚至不会跟踪哪个 CPU 内核最后接触了哪个页面，它当然不会跟踪哪个 CPU 内核最后接触了哪个缓存行。（跟踪会消耗太多 RAM，并且基本上没有任何好处。）

有分布式内核（至少是 Linux 内核的补丁）和其他一些方法来构建一个集群，其中内存和 CPU 分布在多个物理机器上，但对进程来说是统一的——就像它们正在运行一样在单个物理机器上。在这种情况下，可以查询管理端以找出哪个物理节点拥有哪些 CPU 和哪些内存页面。如果这是您的情况，您需要详细描述您正在使用的内核和工具，因为管理工具各不相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T01:42:39.553

[`move_pages()`](http://www.kernel.org/doc/man-pages/online/pages/man2/move_pages.2.html)您可以使用或设置所有权[`numa_tonode_memory()`](http://linux.die.net/man/3/numa)。

# c++ - find_last_of 用于字符串末尾的双引号

> ID：12416268
> 
> 赞同：1
> 
> 时间：2012-09-13T23:34:35.547
> 
> 标签：c++, string

我正在尝试查看正在读取的字符串的结尾是否为`"`. 如果不是，我希望它打印出一些东西。

```
if(!line.find_last_of("\"")) {
    cout << "Extra parameter is typed."; 
    continue; 
```

我试图使用`find_last_of`，但是当我运行它时，无论命令是否有额外参数，都会打印额外的参数。例子：

```
lc "file.txt"   -suppose to true so it's suppose to continue program but returns false
lc "file.txt" lk  - suppose to return false and it does but should only return false for this type of case. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T00:05:22.723

虽然我认为@Jonathon Seng 的回答很好（并且已经投票赞成），但我认为还有另一种可能值得一提。而不是`mystring.at(mystring.length()-1)`，您可以使用`*mystring.rbegin()`：

```
if (*line.rbegin() == '"') ... 
```

当然，您仍然需要检查字符串是否为空。为此，我通常更喜欢`!line.empty()`over `line.length() > 0`，因此最终版本变为：

```
if (!line.empty() && *line.rbegin() == '"') {
    // whatever
} 
```

编辑：请注意，`!line.empty()`必须首先进行测试。`&&`计算其左操作数，然后当（且仅当）其计算结果为 时`true`，计算其右操作数。*我们需要先*验证该行不为空，然后仅在字符串不为空时检查字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T23:36:35.100

您可以比较`line.at(line.length() - 1)`（`'"'`建立后`line.length() > 0`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T23:41:40.190

一种方法可能是

```
if( (!(line.find_last_of("\"") == line.length() - 1)) && (line.length() > 0) ) {
   <do your stuff>;
} 
```

由于 string::find_last_of() 如果在行中的任何位置（至少一次）找到给定字符的最后位置，则返回它。因此，如果它是倒数第二个字符，它将返回 line.length()-2 这将导致您的布尔表达式（if 条件）的行为方式与 if 是最后一个字符相同。

检查`line.length()`是否大于零是必不可少的，就像 if 一样`line.length() == 0`，这可能会返回 true，因为如果找不到匹配的模式则`string::find_last_of()`返回（通常等于 -1）。`string::npos`

也不要忘记空检查`line`，但如果你喜欢防御性编程，这是给定的。

# codeigniter-2 - Codeigniter 路由不重定向

> ID：12416269
> 
> 赞同：1
> 
> 时间：2012-09-13T23:34:40.773
> 
> 标签：codeigniter-2, routes

我正在使用 Tank_auth 来处理注册、登录等。我的 CI 位于我的域根目录的子文件夹中，例如 www.domain.com/account/

一个例子：

登录控制器就是这样**auth/login**所以我的网址是**www.domain.com/account/auth/login**

我想将**www.domain.com/account/auth/login**更改为**www.domain.com/account/login**所以在我的 routes.php 配置文件中我添加了这一行：

```
$route['login'] = 'auth/login'; 
```

现在我希望当我访问**www.domain.com/account/auth/login**时，我会被带到 **www.domain.com/account/login**。如果我访问**www.domain.com/account/login**，我将保留在该 url 上，并且页面应该正确加载。

相反，当我访问**www.domain.com/account/auth/login**时，我看到了登录页面，而当我访问**www.domain.com/account/login**时，我被重定向到**www.domain.com/account/auth/login**。

这种行为似乎与文档描述的内容以及 SO 上的其他行为相反。我尝试交换*$route*变量的键和值，但这只会导致上述两个 url 的 404。

谁能指出我正确的方向？我在这里做错了什么？

谢谢

**[编辑] - htaccess 的内容**

```
RewriteEngine on

# remove index.php from url
RewriteCond $1 !^(index\.php|img|js|css|robots\.txt|favicon\.ico)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /account/index.php/$1 [L]

# redirect non-www to www
RewriteCond %{HTTP_HOST} !^www\.
RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [R=301,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-23T06:37:29.867

不是一个完美的答案，而是我用于与 CI 非常相似的解决方法。`routes.php`如果您将其添加到文件中，我认为这会满足您的需求：

```
$route['(login|logout|register|send_again|activate|forgot_password)'] = 'auth/$1'; 
```

我从 Auth 类中省略了一些方法，但你明白了。我敢肯定，有一种更优雅的方法可以解决这个问题，但基本的想法就在那里。

我在一个项目中使用了这种方法，其中有一些路由基本上映射到静态页面。正在使用“页面”控制器，但 URL 最终像：example.com/pages/about。我不喜欢这样，所以我想出了上面的路线片段。

如果有更好的答案，我很乐意看到它。我记得当时这让我很困扰……再看一遍它仍然如此:)

# c# - 为什么在一个案例语句中声明的变量在其他案例的范围内？

> ID：12416272
> 
> 赞同：6
> 
> 时间：2012-09-13T23:34:44.273
> 
> 标签：c#, compiler-construction, switch-statement

为什么下面的代码会编译？我希望它会抱怨`foo`没有在第二个案例分支中声明。编译器是否处理声明以使其适用于所有情况？

```
using System;

namespace Scratch
{
    class Scratch
    {
        public static void Main()
        {
            var x = 2;
            switch (x)
            {
                case 1:
                    var foo = "one";
                    Console.Out.WriteLine(foo);
                    break;
                case 2:
                    foo = "two"; // is foo in scope here?
                    Console.Out.WriteLine(foo);
                    break;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-13T23:36:56.487

> 为什么下面的代码会编译？

因为语言是在这个特定领域以脑死亡的方式设计的:(

局部变量的范围是声明它的*块，并且在声明之后的任何时候都可以在词法上访问它。*

不，我也不会那样设计语言。我不喜欢 C# 中的开关设计...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-13T23:43:43.447

@JonSkeet 所说的是正确的：C/C++/C# 意义上的“块”与逻辑意义上的“案例”不同。但他没有提到解决问题的“最佳实践”：如果您想在 switch 语句的一个案例中声明一个变量，最好将整个逻辑“案例”包装在一个块中。这样，编译器识别的逻辑“案例”和实际“范围”将是相同的。

```
public static void Main()
{
    var x = 2;
    switch (x)
    {
        case 1: {  // notice these braces I added
            var foo = "one";
            Console.Out.WriteLine(foo);
            break;
        }
        case 2:
            foo = "two"; // hooray! foo is no longer in scope here
            Console.Out.WriteLine(foo);
            break;
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-13T23:42:05.763

要使其无法编译，您可以使用花括号来限定范围，如下所示：

```
using System;

namespace Scratch
{
    class Scratch
    {
        public static void Main()
    {
        var x = 2;
        switch (x)
        {
            case 1:
            {
                var foo = "one";
                Console.Out.WriteLine(foo);
                break;
            }
            case 2:
            {
                foo = "two"; // is foo in scope here?
                Console.Out.WriteLine(foo);
                break;
            }
        }
    }
} 
```

这迫使 var foo 仅存在于该特定范围内。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T23:39:56.913

在 C# 中，变量的作用域是块级别。由于该块遵循 switch 语句，因此 foo 在这两种情况下都确实在范围内。

# python - 混合 matplotlib 转换

> ID：12416278
> 
> 赞同：3
> 
> 时间：2012-09-13T23:35:12.830
> 
> 标签：python, matplotlib

我想在 Matplotlib 图中添加一个补丁，例如矩形，其中补丁的位置使用 ax.transData 但大小以像素或点为单位。有没有办法设置这样的转换？还是转换以外的其他方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-06-04T09:23:26.713

这个答案可能来得太晚了，但是如果其他人偶然发现了这个问题：

[Matplotlib 文档](https://matplotlib.org/3.1.0/tutorials/advanced/transforms_tutorial.html#plotting-in-physical-units)中有一个示例：

```
import matplotlib.pyplot as plt
import matplotlib.patches as mpatches
import matplotlib.transforms as transforms
fig, ax = plt.subplots()
xdata, ydata = (0.2, 0.7), (0.5, 0.5)
ax.plot(xdata, ydata, "o")
ax.set_xlim((0, 1))

trans = (fig.dpi_scale_trans +
         transforms.ScaledTranslation(xdata[0], ydata[0], ax.transData))

# plot an ellipse around the point that is 150 x 130 points in diameter...
circle = mpatches.Ellipse((0, 0), 150/72, 130/72, angle=40,
                          fill=None, transform=trans)
ax.add_patch(circle)
plt.show() 
```

所以基本上你在转换中对补丁的位置进行编码，然后在位置 (0, 0) 处绘制补丁。

# html - 如何在相对定位的容器内垂直居中图像？

> ID：12416279
> 
> 赞同：1
> 
> 时间：2012-09-13T23:35:32.103
> 
> 标签：html, css, positioning, centering

我想在下面的 HTML 中将图像垂直居中，使其垂直居中于它旁边的 div（“rtUpdateContentDiv”）。img 和 div 都在父容器“rtUpdateContainerDivActive”内。

```
<div class="rtUpdateContainerDivActive">
     <img class="statusImg" src="images/icons/Knob-Valid-Green.png">
     <div class="rtUpdateContentDiv">
          <span class="rtBlueHighlight">date and time:</span>
          ipsum lorem text here
    </div>
</div> 
```

这是到目前为止图像的css：

```
.statusImg
{
     position: absolute;
     margin-top: auto;
     margin-bottom: auto;
     vertical-align: middle;
     padding-left: 3px;
     padding-top: 3px;
} 
```

和容器：

```
.rtUpdateContainerDivActive
 {
     background-color: #90ee90;
     margin-top: 1%;
     position: relative;
     min-height: 38px;
 } 
```

父母需要保持相对关系。

如何使图像垂直居中（38px x 38px）？

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T23:41:13.880

解决方案1：

```
.parent{
    display: inline-table;
    height:100%;
}

.middleChild{
    display: table-cell;
    vertical-align: middle;
} 
```

解决方案2：

```
.statusImg
{
     position: absolute;
     height:38px;
     top:50%;
     margin-top:-19px;
} 
```

希望它会有所帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T00:01:32.010

您可能想阅读此[http://css-tricks.com/centering-in-the-unknown/](http://css-tricks.com/centering-in-the-unknown/)最后一种方法可能是您需要的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T23:41:37.963

与图像高度的一半`top: 50%`结合使用： http: [//jsbin.com/adiseq/1/edit](http://jsbin.com/adiseq/1/edit)`margin-top`

# c# - 激活条件块

> ID：12416282
> 
> 赞同：0
> 
> 时间：2012-09-13T23:36:30.720
> 
> 标签：c#, asp.net, asp.net-mvc, razor

我创建了这段代码，但是出现了一个错误（*la compilation conditionnelle est désactivée*）所以这是怎么回事，我该如何纠正它

```
@model IEnumerable<MvcApplication7.Models.GoogleMarker>
@using System.Threading;
@using System.Globalization;
@{

    Thread.CurrentThread.CurrentCulture = new CultureInfo("en-US");
}
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Lay2.cshtml";
}
<script src="@Url.Content("~/Scripts/jquery-1.4.4.min.js")" type="text/javascript"></script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
<script  type="text/javascript">
    $(document).ready(function () {
    var bounds = new google.maps.LatLngBounds();
    var options = {
        zoom : 14,
        mapTypeId: google.maps.MapTypeId.TERRAIN
    };
    var googleMap = new google.maps.Map($("#map")[0],options);
    var infoWindow = new google.maps.InfoWindow({ content: "Cargando…" });
    @foreach (var marker in Model){
    <text>
        var point = new google.maps.LatLng(@marker.Latitude, @marker.Longitude);
        bounds.extend(point);
      var marker = new google.maps.Marker({ position: point,map: googleMap,icon:'/Content/images/ui-bg_glass_75_e6e6e6_1x400.png.png',html: '@marker.InfoWindow'});

        google.maps.event.addListener(marker, "click", function () {infoWindow.setContent(this.html);infoWindow.open(googleMap, this);});
    </text>
    }
    googleMap.fitBounds(bounds);}
    );
     </script> 
```

有什么建议么？

# google-apps-script - 使用 Google Apps 脚本设置自定义 cookie

> ID：12416286
> 
> 赞同：0
> 
> 时间：2012-09-13T23:36:46.900
> 
> 标签：google-apps-script, google-sites

是否可以通过嵌入在 Google 网站中的 Google Apps 脚本小工具设置自定义 cookie。我一直在尝试使用 HtmlService 类（通过 html 文件中的脚本中的 document.coookie），但它似乎没有生成 cookie。我假设这必须是设计使然（即 Caja 消毒）。还有其他方法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T02:17:34.813

按照设计，这是不可能的，但您不需要这样做；您可以在 UserProperties 中存储有关当前用户的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-07T20:34:12.283

如果您像这样使用 iframe 选项，这实际上是可能的：

```
function doGet(e) {
    return HtmlService.createHtmlOutputFromFile("index.html")
                .setSandboxMode(HtmlService.SandboxMode.IFRAME);
}
// after that you may use (On "index.html"):
// document.cookie = "cookieName=1234"; 
```

此致。

# kentico - Kentico 产品选项：启用后端但隐藏前端

> ID：12416290
> 
> 赞同：0
> 
> 时间：2012-09-13T23:36:54.773
> 
> 标签：kentico

我对 Kentico 还很陌生，我不是 100% 确定如何防止产品选项显示在前端网站上，但在后端保持启用，以便系统管理员仍然可以使用该选项下订单。

例如

CMSDesk > 工具 > 电子商务 > 产品选项 > 编辑具有子选项的选项

例如，有三个子选项，其中两个我想在网站上显示给用户，但只有一个我想对最终用户隐藏，并且只允许管理员访问该选项...

以前有没有人需要这个功能？如果是这样，您是如何实现的？

谢谢

米歇尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T15:05:54.373

请在我们的官方 Kentico 论坛上找到我的答案：

[论坛链接][1]

我们的论坛比stackoverflow更经常被监控，所以我建议在那里继续我们的讨论；）

问候，鲍里斯，肯蒂科

* * *

更新：

如果链接应该失效，这里是完整的答案：

遗憾的是，这不能开箱即用。您将不得不自定义显示选项的控件。您需要修改以下方法：

加载产品选项（）

在文件 \CMSModules\Ecommerce\Controls\ProductOptions\ShoppingCartItemSelector.ascx.cs 中。在实时站点上加载并显示了产品选项。您必须检查当前用户是否是全局管理员，如果不是，则跳过某些字段的处理。第二种方法是通过使用自定义电子商务处理程序覆盖 OptionCategoryInfoProvider.GetSKUOptionCategories 方法来更改它。可以在以下链接下找到有关此主题的更多信息：

相关链接可以在论坛帖子中找到，因为我不能在帖子中发布超过 2 个链接。

以下是提供者对象覆盖的示例：

```
using System;
using System.Collections.Generic;
using System.Web;

using CMS.WorkflowEngine;
using CMS.SettingsProvider;
using CMS.Ecommerce;
using CMS.EcommerceProvider;

/// <summary>
/// Summary description for Class1
/// </summary>
[MyHandlers]
public partial class CMSModuleLoader {
    private class MyHandlers: CMSLoaderAttribute {

        public override void Init() {
            OrderInfoProvider.ProviderObject = new MyEcommerceCustomHandler();

            WorkflowEvents.Approve.After += WorkflowEvents_Publish_Handler;
        }

        private static void WorkflowEvents_Publish_Handler(object sender, EventArgs e) {
            //insert custom code here
        }
    }

    public class MyEcommerceCustomHandler: OrderInfoProvider {
        protected override string GetInvoiceInternal(int orderId) {
            return base.GetInvoiceInternal(orderId);
        }
    }
} 
```

您还可以在产品选项表中添加一个自定义字段，以指示该字段是否应显示在实时站点上。

# java - 用于一对多映射的挂毯组件

> ID：12416291
> 
> 赞同：1
> 
> 时间：2012-09-13T23:36:55.223
> 
> 标签：java, hibernate, components, tapestry, palette

[我对生物分类](http://en.wikipedia.org/wiki/Biological_classification)有相似的尺度。我正在寻找可以更快地将它们连接起来的挂毯组件。但是我仅限于挂毯 5.2.6。

```
@Entity
public class Species implements Serializable {
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Basic(optional = false)
    @NonVisual
    private Long Id;
    @Basic(optional = false)
    private String Name;   
    @ManyToOne   
    @NotFound(action = NotFoundAction.IGNORE)   
    private Kingdom kingdom; 
    //getter and setter frod data above
}

@Entity
public class Kingdom implements Serializable {
    private static final long serialVersionUID = 1L;
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Basic(optional = false)
    @NonVisual
    private Long Id;
    @Basic(optional = false)
    private String Name; 
    @OneToMany
    private Collection<Species> speciesCollection;
    //getter and setter frod data above
} 
```

我们已经在数据库中输入了 1000 条物种记录，我们希望将它们链接起来。我知道的唯一解决方案是在具有表格的表单内使用具有复杂代码的选择对象。我认为使用 GenericValueEncoder。

```
<td><t:label for="species"/></td><td><t:selectObject t:id="species" blankOption="never" list="speciesList" value="species" labelField="literal:name"/></td> 
```

当然 selectobject 可以工作，但是与每个输入的物种的[调色板](http://tapestry5-jquery.com/core/docsjquerypalette)或循环复选框（在我的版本中不可用）相比，它确实很慢。

但是主要问题仍然是我不了解调色板 java 代码。许多变量都有下划线，谁知道呢？

由于任何地方都没有评论，很难理解什么是什么，但我认为我需要做的是改变第 14 行。

使用 GenericValueEncoder 代替 EnumValueEncoder 和 GenericSelectModel 代替 EnumSelectModel。

如果有人设法用实体对象实现调色板，请告诉我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T08:52:58.890

这是我们使用的调色板示例。在我使用 Account 的地方，您可以用您的 Species 替换它。

```
@Component(id = "accountsPalette", parameters = {
        "label=literal:My palette",
        "selected=selectedAccountsIds",
        "model=availableAccountIdsModel",
        "encoder=accountsEncoder"})
private Palette accountsPalette;

public SelectModel getAvailableAccountIdsModel() throws Exception {

    final List<OptionModel> options = new ArrayList<OptionModel>();

    for(Account account : availableAccounts) {

        options.add(new OptionModelImpl(account.getFullNameSingleType(), account.getId()));
    }

    return new AbstractSelectModel() {

        public List<OptionModel> getOptions() {
            return options;
        }

        public List<OptionGroupModel> getOptionGroups() {
            return null;
        }
    };
}

public ValueEncoder<Long> getAccountsEncoder(){
    return new ValueEncoder<Long>() {

        public String toClient(Long value) {
            return value.toString();
        }

        public Long toValue(String clientValue) {
            return Long.parseLong(clientValue);
        }
    };
}

public List<Long> getSelectedAccountsIds() {
    return selectedAccountIds;
}

public void setSelectedAccountsIds(List<Long> selectedAccountIds) throws Exception {
    ..... deal with the selected ids .....
} 
```

# codeigniter - codeigniter 分页 - 结果在每一页上保持不变

> ID：12416305
> 
> 赞同：3
> 
> 时间：2012-09-13T23:39:36.017
> 
> 标签：codeigniter, pagination

我正在使用 Codeigniter 分页，但遇到了问题。

url 在单击时更改，如限制更新，例如 displayAllUsers/10 到 displayAllUsers/15，但结果保持不变。

这是我的控制器：

```
 public function displayAllUsers()
    {

        $this->load->model('backOfficeUsersModel');
        $data['loggedUser'] = $this->backOfficeUsersModel->get_by('username', $this->session->userdata('username'), FALSE,TRUE);

        $this->db->order_by('userid');
        $limit = 5;     // this works, I have 5 records displayed on the page
        $offset = 3;
        $this->db->limit($limit);
        $this->db->offset($offset);
        $data['users'] = $this->backOfficeUsersModel->get();

        // line bellow, prints correct result, 17 records total in database;
        $totalresults = $this->db->get('back_office_users')->num_rows();

        $this->load->library('pagination');
        $config['base_url'] = site_url('/backOfficeUsers/displayAllUsers');
        $config['total_rows'] = $totalresults;
        $config['per_page'] = 5;
        $config['uri_segment'] = 3;
        $this->pagination->initialize($config); 
        $data['main_content'] = 'users';
        $data['title'] = 'Back Office Users';
        $errorMessage = FALSE;
        $this->load->vars($data,$errorMessage);
        $this->load->view('backOffice/template');

    } // end of function displayAllUsers 
```

任何人都可以发现我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T00:01:46.283

尝试像这样进行偏移，

```
$offset = $this->uri->segment(3);
$this->db->limit(5, $offset); 
```

这样，当您访问您的用户时，您就从正确的偏移量开始。

假设您的表中有 20 个用户。当您第一次登陆页面时，您的 $offset 变量将为空，因为您的链接中没有尾随数字（在 $this->uri->segment(3) 处）。因此，当您在数据库中查询 5 个用户时，您从 0 开始，因为 $offset 变量为空。在这种情况下，您的代码将是：

```
$this->db->limit(5, 0). 
```

从第 0 条记录开始获取 5 条记录。

但是，当您使用分页链接时，您设置的 per_page 变量会在 url 的末尾添加一个数字并重新加载页面。发生这种情况时，您的 $offset 变量会得到一个数字，在这种情况下，它每次都会增加 5。现在在这种情况下，您的代码将是

```
$this->db->limit(5,5) 
```

意思是从第 5 条记录开始获得 5 条记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T23:48:26.983

没有调用`$this->pagination->create_links()`which 生成要放在页面上的 html。

例如，

```
...
$this->load->vars($data,$errorMessage);
$data['page_nav'] = $this->pagination->create_links();
$this->load->view('page_body', $data); 
```

`$page_nav`如果它用于添加分页项，这将与表单很好地配合：

在`views/page_body.php：

```
... (various html markup)
<div class="pagination">
 <?php echo $page_nav; ?>
</div> 
```

# javascript - 使用“defer”属性时是否需要将脚本放在页面底部？

> ID：12416307
> 
> 赞同：30
> 
> 时间：2012-09-13T23:39:58.977
> 
> 标签：javascript, html

我总是将脚本标签放在页面底部，因为在 HTML/CSS 和文本等内容完成加载后加载脚本是一种很好的做法。我刚刚发现了 defer 属性，它基本上做同样的事情，即它等待页面完成加载，然后再获取和执行脚本。

因此，如果使用 defer 属性，是否有必要将 script 标签物理放置在页面底部而不是 head 标签内？

我发现将脚本标签保留在 head 部分中会更好地提高可读性。

```
<script src="script.js" defer="defer"></script> 
```

或者

```
<script defer="defer">

// do something

</script> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-13T23:49:44.143

当前的最佳实践？**在 head 中按顺序使用延迟脚本**，除非您需要支持较旧的浏览器（IE < 10、Opera Mini 等） - 97.45% 的浏览器使用率（[参考](https://caniuse.com/#feat=script-defer)）

**为什么？**使用`defer`, 解析就像我们将脚本放在 body 标记的末尾一样完成，但总体而言，脚本执行之前完成得很好，因为脚本已与 HTML 解析并行下载。这种情况将触发`domInteractive`用于页面加载速度的更快事件。使用`async`时，脚本的执行顺序会根据获取脚本的速度而有所不同，因此可能会影响顺序。此外，`async`脚本内联执行并暂停 HTML 的解析。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-02-26T14:13:50.740

自从编写这些答案以来，最佳实践已经发生了变化，因为全球对该`defer`属性的支持已经增长到[98%](https://caniuse.com/#feat=script-defer)。

除非您需要针对旧版浏览器优化速度，否则您应该将脚本放在头部并标记为 defer。这 1) 将所有脚本引用保存在一个地方（更易于维护）和 2) 使浏览器更快地意识到脚本，这让它更早地开始优先考虑资源。

对于大多数页面而言，性能差异差异应该可以忽略不计，因为浏览器的[预加载器](https://andydavies.me/blog/2013/10/22/how-the-browser-pre-loader-makes-pages-load-faster/)可能在整个文档被解析之前不会开始下载延迟脚本。但是，它不应该受到伤害，它为浏览器留下了更多的工作，这通常是最好的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-13T23:43:39.613

首先，并非所有浏览器都支持 defer 属性（有些支持它的只是忽略它）。将脚本放在页面底部可确保其上方的所有 HTML 元素在脚本执行之前都已加载到 DOM 中。另一种方法是使用该[`onload`](https://developer.mozilla.org/en-US/docs/DOM/window.onload)方法或使用 jQuery 的[DOM 就绪](http://api.jquery.com/ready/)功能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-21T07:25:52.570

在 HTML 底部的脚本中使用 defer 有不同的原因：

*   并非所有浏览器都支持“延迟”。如果你把你的脚本放在带有 defer 的 HEAD 中并且浏览器不支持 defer，那么脚本会阻止以下元素的并行下载，并且还会阻止脚本下所有内容的渐进式渲染。
*   如果您只是将脚本放在底部而不延迟，浏览器将继续显示繁忙指示符，直到页面完成 JavaScript 解析。
*   在某些情况下，“底部没有延迟的脚本”会阻止渐进式渲染。在 Google Chrome 36 和 IE11 中测试（见下方评论）

重要的是要知道每个浏览器都处理“延迟”之类的事情，而且繁忙的指标也略有不同。

最佳实践应该是：**将脚本放在底部并使用 defer。**

除了可读性方面，与“带延迟的头部脚本”或“不带延迟的底部脚本”相比，我只看到将脚本放在底部并带有延迟的优势。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-13T23:42:42.990

虽然我同意您的观点，即使用“延迟”并将脚本放在标题中会提高可读性，但桌面和移动 Opera 仍然不支持此属性（请查看[此表](http://caniuse.com/script-defer)了解详细信息）。

# java - 如何从 XML 属性文件加载变量？

> ID：12416310
> 
> 赞同：4
> 
> 时间：2012-09-13T23:40:07.173
> 
> 标签：java, xml, ant, ant-contrib

我目前正在从 Ant 中的 XML 文件加载属性。但是，我想在 for 循环中执行我当前的 ant 任务，同时每次都为同一组属性加载一个新的 XML 属性文件。

我知道 ant-contrib 的 var 任务的存在，它允许我覆盖属性。但是，我不确定如何将其与从 XML 文件加载属性结合使用。起初我想遍历所有属性，然后使用 propertyregex 任务将它们设置为新值。不幸的是，当我开始编写代码时，我意识到我仍然不知道如何实际加载属性值，因为它们无法覆盖以前设置的属性。（好吧，他们可以使用 var 任务，但据我所知，这不能用于从 XML 文件加载。）

有任何想法吗？我理想地寻找的是一个被称为类似的任务

```
<xmlvars file="myxmlpropertyfile.xml"/> 
```

它的功能就像

```
<xmlproperty file="myxmlpropertyfile.xml"/> 
```

除了它覆盖变量之外。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T02:32:59.433

您可以对`<xmlproperty>`任务执行的一件事是为每个属性添加一个特定值的前缀。为什么不简单地使用参数名称作为前缀？

否则，您可以使用该`<echoproperties>`任务取消设置所有属性，然后循环`<for>`执行任务的下一次迭代。

像这样的东西，但未经测试：

```
 <for param="my.directory">
     <fileset dir="${some.directory}"/>
     <sequential>
         <xmlproperty file="@{my.directory}/myxmlpropertyfile.xml"
            prefix="foo-fighters"/>
          <blah, blah, blah/>
          <for param="reset.var">
              <echoproperty prefix=foo-fighters"/>
              <sequential>
                  <var name="@{reset.var}"
                     unset="true"/>
              </sequential>
          </for>
     </sequential>
 </for> 
```

基本上，您使用外部`<for>`循环遍历您的目录，并使用它`<xmlproperty>`来设置属性名称。`<blah blah blah/>`手段做你想做的事。然后，在您进行外`<for>`循环的下一次迭代之前，您将执行一个*内* `<for>`循环，该循环将取消您之前在`<xmlproperty>`任务中设置的所有变量。

诀窍是使用变量前缀来保证变量名很容易找到。因此`foo-fighters`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T23:57:05.853

看起来我*应该*能够通过使用 var 任务的 unset 属性来完成此任务。会回来汇报...

# c# - 使用 vs profiler 分析一个 azure webrole

> ID：12416313
> 
> 赞同：3
> 
> 时间：2012-09-13T23:40:46.827
> 
> 标签：c#, asp.net-mvc, azure, profiling

我发现了大量关于在 Azure 解决方案上运行内置 VS 分析器的博客/信息，它实际上在工作角色项目上按预期工作。但是，当我分析 ASP.NET Web 角色时，w3wp.exe 的所有数据都拒绝加载符号，因此我留下了一长串十六进制地址和时间信息，我无法将其与代码相关联。当我打开 vsp 文件时，我得到了很多符号解析失败，以及这个：

> VSP2340：在分析运行期间未正确设置环境变量，并且托管 > 符号可能无法解析。请在分析之前使用 vsperfclrenv

除了我没有运行 vsperf 或其他任何东西之外，启用分析的唯一方法是通过 Azure 项目上的“发布”操作，它在幕后执行任何必要的魔法。

我错过了什么吗？有没有办法让这些符号解析，甚至有办法让这些符号与函数匹配（我有相关的 pdb）

我的结果截图：

![截屏](../Images/4b0fbc8d284e1d725a75bbf850cf1882.png)

# c# - 使用 C# 和 ODP.NET 和 Oracle，如何从存储过程中获取关联数组（pl/sql 表）

> ID：12416315
> 
> 赞同：1
> 
> 时间：2012-09-13T23:40:50.177
> 
> 标签：c#, oracle, plsql, odp.net

使用 C# 4.0 和 ODP.NET。我们有一个存储过程，它是一个包的一部分，它接受两个 in 参数并返回一个 pl/sql 表。

我已经搜索了几个小时，在这里和其他地方找到了许多代码示例，您可以将数组传递给存储过程，但没有找到一个可以返回 pl/sql 表的示例。

这可能吗？我相信它必须是但不确定了。

注意：我没有取回 ref 游标，它是一个 pl/sql 表（关联数组）

# android - 即使应用程序不是使用 Play 应用程序下载的，Android 是否也会向 Google 的 Play 商店发送崩溃/冻结报告？

> ID：12416318
> 
> 赞同：0
> 
> 时间：2012-09-13T23:41:27.750
> 
> 标签：android, google-play

示例：向 beta 测试人员发送 beta 版本时，我仍然希望将他们的所有崩溃/冻结报告发送到“Google Play”（以前的“Android 市场”）。

注意：此类测试版可以通过电子邮件（例如）发布，而不是使用“Google Play”下载。它将通过允许“未知来源”手动安装。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T04:02:19.250

实际上，Google Play 并没有真正“跟踪”崩溃。它实际上做的是让用户选择在应用程序需要强制关闭时发送报告（例如，有一个未处理的异常）。

所以，**不**。除非该应用程序是从 Google Play 下载的，否则该选项不可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T01:36:26.123

除非它是从市场上加载的，否则它不太可能跟踪它。使用 Flurry，添加和在通过电子邮件发送、下载或其他任何方式的应用程序上运行都很简单。

# gtk - 无法运行用 gcc 4.4 (mingw) 编译的 gtk 应用程序

> ID：12416319
> 
> 赞同：0
> 
> 时间：2012-09-13T23:41:33.147
> 
> 标签：gtk, mingw, gcc4.4

我已经下载了适用于 windows 的 gtk all-in-one 软件包。我正在使用 -mms-bitfields 编译我的文件，但仍然出现错误，

```
Gtk-ERROR **: Incompatible build!
The code using GTK+ thinks GtkBox is of different
size than it actually is in this build of GTK+.
On Windows, this probably means that you have compiled
your code with gcc without the -mms-bitfields switch,
or that you are using an unsupported compiler.
aborting... 
```

有任何想法吗？

阿德尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T10:11:47.733

您应该在项目的属性中启用 -mms-bitfields。

根据您使用的 IDE，它可能会有所不同。

在 NetBeans 中，右键单击您的项目。然后转到项目属性-> C++ 编译器。展开 Compilation Line 并在 Additional Options 中输入 -mms-bitfields。确保配置设置为所有配置。重建你的项目。

在 Code::Blocks 我认为你应该这样做：右键单击你的项目 -> 构建选项。转到编译器设置 -> 其他选项并写入 -mms-bitfields。确保将此更改应用于整个项目（不仅仅是调试或发布）。重建你的项目。

# hibernate - 在播放 2.0.3 时在 JPA 中加载模型属性时出错

> ID：12416321
> 
> 赞同：1
> 
> 时间：2012-09-13T23:41:35.283
> 
> 标签：hibernate, playframework, jpa-2.0

我有一个非常简单的模型，名为“Scholar”，带有相应的 getter/setter 方法。我还有一种方法 findByFullName(String name, String surname) 可以根据输入的姓名或姓氏检索列表。
`@Entity`
`@Table(name="scholar")`
`public class Scholar extends Model {`
`@Id`
`@Column(name = "student_number")`
`private long studentNumber;`
`@Column(name = "surname")`
`private String surname;`
`@Column(name = "name")`
`private String name;`

我的 findByFullName 方法如下：
`public static List<Scholar> findByFullName(String name, String surname) {`
`List<Scholar> returned = JPA.em().createQuery("from Scholar s where s.surname=?")` `.setParameter(1, surname).getResultList();`

生成的 Scholar List 包含只有 studentNumber 的 Scholar 对象。即使学者表具有两列的数据，姓名和姓氏也会返回 null。IE

```
returned.get(0).getStudentNumber returns a value
returned.get(0).getName() returns null
returned.get(0).getSurname() returns null 
```

异常跟踪：
内部服务器错误，请求 [POST /search] ->

```
play.core.ActionInvoker$$anonfun$receive$1$$anon$1: Execution exception [[NullPo
interException: null]]
at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:134) [
play_2.9.1.jar:2.0.3]
at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:115) [
play_2.9.1.jar:2.0.3]
at akka.actor.Actor$class.apply(Actor.scala:318) [akka-actor.jar:2.0.2]
at play.core.ActionInvoker.apply(Invoker.scala:113) [play_2.9.1.jar:2.0.3]
at akka.actor.ActorCell.invoke(ActorCell.scala:626) [akka-actor.jar:2.0.2]
at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:197) [akka-actor.jar:2.0.2]
Caused by: java.lang.NullPointerException: null
    at models.Scholar._ebean_get_surname(Scholar.java:4) ~[classes/:na]
    at models.Scholar.getSurname(Scholar.java:89) ~[classes/:na]
    at models.Scholar.findbyIdOrNames(Scholar.java:55) ~[classes/:na]
    at controllers.Search.findScholar(Search.java:30) ~[classes/:2.0.3]
    at Routes$$anonfun$routes$1$$anonfun$apply$11$$anonfun$apply$12.apply(ro
     utes_routing.scala:92) ~[classes/:na]
    at Routes$$anonfun$routes$1$$anonfun$apply$11$$anonfun$apply$12.apply(ro
    utes_routing.scala:92) ~[classes/:na] 
```

我的 persistence.xml 看起来像：

```
 <persistence xmlns="http://java.sun.com/xml/ns/persistence"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence        http://java.sun.com    /xml/ns/persistence/persistence_2_0.xsd"
             version="2.0">

    <persistence-unit name="defaultPersistenceUnit" transaction-type="RESOURCE_LOCAL">
        <provider>org.hibernate.ejb.HibernatePersistence</provider>
        <non-jta-data-source>DefaultDS</non-jta-data-source>
        <properties>
            <property name="hibernate.dialect" value="org.hibernate.dialect.MySQLDialect"/>
            <property name="hibernate.hbm2ddl.auto" value="update"/>
        </properties>
    </persistence-unit>

</persistence> 
```

我的 Application.conf 文件如下所示：

```
db.default.driver=com.mysql.jdbc.Driver
db.default.url="jdbc:mysql://localhost/DBName" 
db.default.user=user
db.default.password=password
jpa.default=defaultPersistenceUnit

db.default.jndiName=DefaultD` 
```

我想检索所有 Scholar 属性；studentNumber, name and surname 请协助，字面上卡住没有前进的路

# python - Django - 多站点

> ID：12416328
> 
> 赞同：1
> 
> 时间：2012-09-13T23:42:18.787
> 
> 标签：python, django, e-commerce

我目前正计划在 python (django) 中构建一个 SaaS 电子商务应用程序。该应用程序将根据要求创建新的电子商务网站。每个电子商务都需要自己的模板/配置，但核心功能保持不变。每个所有者决定什么去哪里和页面布局。

因此，据我了解，我必须与项目分开创建应用程序，以便它们可以在所有站点中重复使用，但每个网站都有自己的项目，配置不同。因为每个网站都有自己的数据库。

**我的问题如下：**

在这种情况下使用 django 提供的站点框架会更好吗？我不这么认为，但我可能是错的？

django 将如何处理许多网站？Web 端口只能使用一次，因此不可能生成多个 django 服务器。可以通过某种中间件解决吗？在这种情况下，我该怎么做呢？

我真的很想学习，并且非常感谢我能得到的所有帮助！

非常感谢您的宝贵时间。:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T23:52:45.980

> Better idea to use sites framework?

Yes.

> I don't think so but I could be wrong?

No.

> How would django handle many websites?

vhosts.

> Could it be solved through some kind of middleware?

As well. Sure.

> How to go about that?

Pay a programmer

# python - 字典还是列表？

> ID：12416329
> 
> 赞同：0
> 
> 时间：2012-09-13T23:42:22.647
> 
> 标签：python

我需要能够存储数据，一个是数字，一个是它出现的次数。我有一个 for 循环，它调用一个返回字典的方法：

```
for x in range(total_holidays):
    t = trial()
    y = y + "\n" + str(x+1) + "," + str(t["brown"]) + "," + str(t["rainbow"]) + "," + str(t["nothing"]) + "," + str(t["days"])
    total += t["days"]
    #print total
    if x%10000 == 0:
        y0.append(y)
        y = "" 
```

基本上我需要计算 t['days'] 发生了多少次，这个数字几乎每次都在变化。如果你想要完整的代码看这里：

[https://math.stackexchange.com/questions/193846/how-many-trials-would-you-expect-to-give-you-an-accurate-answer](https://math.stackexchange.com/questions/193846/how-many-trials-would-you-expect-to-give-you-an-accurate-answer)

那么我该怎么做，然后我需要把它全部打印出来。

`y`是 csv 文件的文本，total 用于计算平均值。

* * *

正如 mgilson 建议的那样，我应该使用它吗？

```
from collections import Counter

a = []
for x in range(total_holidays):
    t = trial()
    y = y + "\n" + str(x+1) + "," + str(t["brown"]) + "," + str(t["rainbow"]) + "," + str(t["nothing"]) + "," + str(t["days"])
    total += t["days"]
    a.append(t['days'])
    #print total
    if x%10000 == 0:
        y0.append(y)
        y = ""
z = Counter(a)
print z 
```

我应该有类似的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T23:57:14.770

您想要的是`collections.Counter`类型，一种`dict`专门用于此类任务的子类型：

```
import collections
days_occurred = collections.Counter()

for ...:
    t = trial()
    days_occurred[t['days']] += 1

# total is now sum(days_occurred.itervalues())

# you print the counts by iterating over the dict

for days, count in days_occurred.iteritems():
    print "%d: %d" % (days, count) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T23:50:46.263

您不需要手动构建 CSV 文件。Python 已经为此提供了一个内置模块：

```
import csv

writer = csv.writer(open('output.csv', 'wb'))

# ...

for x in range(total_holidays):
  t = trial()

  writer.writerow([x + 1, t['brown'], t['rainbow'], t['nothing'], t['days']])
  total += t['days'] 
```

除此之外，您的问题到底是什么？

# c# - XNA/Silverlight 中的自动滚动列表框

> ID：12416330
> 
> 赞同：1
> 
> 时间：2012-09-13T23:42:25.423
> 
> 标签：c#, silverlight, xna, autoscroll, credits

我想做一个游戏的学分屏幕，但学分包含一系列图像。我找不到允许我插入多个图像并滚动它们的容器，所以我创建了一个带有按钮的 ListBox。这些按钮只有一个图像并且不可点击，所以它们就像图像一样。至于将图像放在允许我滚动它的容器中，已经涵盖了。当我希望它们自动滚动时，问题就来了，我在网上发现了一系列自动滚动 ListBox，但似乎没有什么适合我想做的事情。

这是我所拥有的：

此类的全局变量

```
 GameTimer _timer = null;
    int _currentIdx = 0;
    int _elapsedTime;
    const int TIMER_DELAY_IN_MILLIS = 1000; 
```

当应用程序导航到此页面时：

```
 protected override void OnNavigatedTo(System.Windows.Navigation.NavigationEventArgs e)
    {
        _elapsedTime = 0;
        _timer = new GameTimer();
        _timer.UpdateInterval = TimeSpan.FromTicks(333333);
        _timer.Update += OnUpdate;
        _timer.Start();

        base.OnNavigatedTo(e);
    } 
```

当应用程序更新时：

```
 private void OnUpdate(object sender, GameTimerEventArgs e)
    {
        if (_elapsedTime > TIMER_DELAY_IN_MILLIS)
        {
            _elapsedTime -= TIMER_DELAY_IN_MILLIS;
            Credits.UpdateLayout();
            Credits.ScrollIntoView(Credits.Items[_currentIdx]);
            System.Diagnostics.Debug.WriteLine("" + _currentIdx + " Update: " + e.ElapsedTime);

            _currentIdx = ++_currentIdx % Credits.Items.Count;
        }
        _elapsedTime += e.ElapsedTime.Milliseconds;
    } 
```

如您所见，我对此类进行了更新，并基于该列表框滚动到列表的下一个索引中的按钮（视图），但是我尝试获得的滚动更平滑且更多电影般的。我不知道我是否使用了正确的容器，或者我的算法是否有问题，任何形式的帮助都将不胜感激[：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T16:44:45.237

[本文](http://blogs.msdn.com/b/delay/archive/2009/08/04/scrolling-so-smooth-like-the-butter-on-a-muffin-how-to-animate-the-horizontal-verticaloffset-properties-of-a-scrollviewer.aspx)提供了一些示例，说明如何在 ScrollViewer 中设置滚动动画。为你的学分长度选择一个合适的时间跨度，并将 VerticalOffset 动画化到最后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T05:32:31.813

尝试改用该`ScrollToVerticalOffset`方法。这允许您以像素精度滚动。

# excel - VBA 目标寻求多行

> ID：12416336
> 
> 赞同：0
> 
> 时间：2012-09-13T23:43:18.620
> 
> 标签：excel, vba

这应该很简单，我只是无法理解它

我有 3 列

ABC 如果 A 中有数据，我想在 B 和 C 上运行目标搜索

Range("B3").GoalSeek 目标：=0，ChangingCell:=Range("C3")

我想要类似的东西：

```
 If CellA>0:
     Range("D1").GoalSeek Goal:=0, ChangingCell:=Range("C1") 
```

如果这有什么不同的话，这可能是大约 7000 行的价值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T01:41:18.847

试试这个：

```
Dim rCell As Range

For Each rCell In ActiveSheet.UsedRange.Resize(, 1)
    If rCell.Value <> "" Then
        rCell.Offset(, 3).GoalSeek Goal:=0, ChangingCell:=rCell.Offset(, 2)
    End If
Next rCell 
```

此代码示例基于您上面的最后一条评论。它将更改 C 列中的单元格以在 D 列的公式中给出 0。

# c# - 无法将对象类型“System.String[*]”转换为“System.String[]”

> ID：12416338
> 
> 赞同：3
> 
> 时间：2012-09-13T23:43:36.503
> 
> 标签：c#, .net, visual-studio-2010, casting, opc

大家好，我对 C# .NET 中的代码有疑问，我正在使用 DLL 连接到 OPC 服务器，该 DLL 在 VB.NET 项目中使用并且完全没有问题。

我正在尝试在 ListBox 中显示可用服务器的列表，VB.NET（和工作）中使用的代码是这个：

```
Dim AllOPCServers As Object
AllOPCServers = AnOPCServer.GetOPCServers

' Load the list returned into the List box for user selection
Dim i As Short
For i = LBound(AllOPCServers) To UBound(AllOPCServers)
    AvailableOPCServerList.Items.Add(AllOPCServers(i))
Next i 
```

我写了这个在 C# 应用程序中使用

```
try
{
    var _listOPCServer = _OPCServer.GetOPCServers();
    foreach(var i in _listOPCServer)
    {
        string serverName = (string)i;
        listServers.Items.Add(serverName);
    }             
}
catch (Exception exc)
{
    lstMsg.Items.Add(DateTime.Now + " Error al Obtener Lista de OPC's: " + exc.Message);
} 
```

在本地选项卡上的调试模式下显示：

_listOPCServer | {字符串[1..2]} | 动态 {string[]} |

```
[1]        |  "Server01"    | string  
[2]        |  "Server02"    | string 
```

**更新：**

我在“foreach（var i in **_listOPCServer**）”行中收到错误

**无法将对象类型“System.String[*]”转换为“System.String[]”**

这才是真正的错误。

我确定我做错了什么，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T19:26:44.803

好的，我找到了解决这个问题的方法，这只是你建议的一个模式

```
 Array _listOPCServer = (Array)(object)_OPCServer.GetOPCServers();               

            foreach(object i in _listOPCServer)
            {
                string serverName = (string)i;
                listServers.Items.Add(serverName);
            } 
```

我只在声明中添加了（对象）并且工作正常，现在我可以按照我想要的方式显示服务器列表

或者也这样做

```
Array _listOPCServer = (Array)(object)_OPCServer.GetOPCServers();               

            foreach(object i in _listOPCServer)
            {
                listServers.Items.Add(i);
            } 
```

再次感谢您的帮助和时间！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T00:02:57.723

VB.NET 在处理不一致的数组类型方面要精明得多。不要犹豫，使用它，.NET 使语言之间的互操作变得容易。

问题在于 OPC 是基于 COM 的标准。您正在使用的服务器正在返回一个 SAFEARRAY，其下限不一致，第一个索引是 1。不是 0。在 COM 中并不罕见，在 0 和 1 之间选择作为第一个数组索引就像字节序问题或争论是否番茄是一种水果或蔬菜（它是一种水果。而 little-endian 是一种正确的蔬菜）。

然而，0 作为下界是 C# 在处理一维数组时所坚持的。它需要一个“向量”，一种独特的数组类型，它始终具有一个下限为 0 的维度。在 .NET 运行时中进行了大量优化。你得到的不匹配，所以被映射到一个*一维**的多维*数组。不是可以用 C# 语言表达的数组类型。

 *您*可以*在 C# 中破解它，但您必须明确使用 Array 类型。像这样的东西，为了清楚起见：

```
Array servers = (Array)_OPCServer.GetOPCServers();
int first = servers.GetLowerBound(0);
int last = servers.GetUpperBound(0);
for (int ix = first; ix <= last; ++ix) {
    var elem = (string)servers.GetValue(ix);
    // etc..
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T01:11:10.453

虽然 Hans 在区分从零开始的数组和非从零开始的数组之间的区别是正确的，但我仍然不明白您为什么会遇到这种异常。

我的猜测是您声明`_OPCServer`as `dynamic`，它将类型绑定推迟到运行时。`_listOPCServer`也是如此`dynamic`。

由于您正在遍历数组并提取`string`s，编译器*可能*会尝试将对象强制转换为`string[]`为 Hans 指出的无效的对象。

您应该能够转换`_listOPCServer`为 an`Array`并按`foreach`原样使用：

```
Array _listOPCServer = (Array)(_OPCServer.GetOPCServers());
foreach(var i in _listOPCServer)
{
    // etc. 
```*

# jquery - 更新 div 标签显示的数字？

> ID：12416345
> 
> 赞同：1
> 
> 时间：2012-09-13T23:44:29.280
> 
> 标签：jquery, html

我有一些代码显示查看特定 twitch.tv 流的人数。它加载一次数字并显示它。如果有人想要更新查看者的数量，那么他们必须刷新页面。有没有办法每隔几秒刷新一次数字，这样人们就不用刷新页面了？代码如下（我要更新的 div id=viewers）

```
 <html>
    <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js" charset="utf-8"></script></head></html>
    <script type="text/javascript" >

    var channelName = "crossgamechat";

    function showViewers(a){
    alert(a.viewers_count);
    }
    $.getJSON("http://api.justin.tv/api/stream/summary.json?channel="+ channelName + "&jsonp=?", function(a){document.getElementById("viewers").innerHTML  += a.viewers_count;}); 
    ;  

    </script>

    <div class="clear"></div>
    <div style="width: 100px;">
     <div id="viewers" style="float: left"></div>
     <div id="blank" style="float: left; width: 5px;">&nbsp;</div>
     <div id="divtext" style="float: left;">Viewers</div>
     <br style="clear: left;"/>
    </div>
    </head></html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T23:49:00.057

您可以在 setInterval 中使用 ajax 调用来执行此操作。向返回要显示的数字的页面发送 get 或 post 请求，然后在该调用成功时更新 span/div 或显示数字的任何内容

这是一个[工作小提琴](http://jsfiddle.net/4TJXV/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T23:46:50.103

您可以使用[`setInterval`](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval)以设定的时间间隔运行特定功能。

演示：http: [//jsfiddle.net/SO_AMK/tt5NH/](http://jsfiddle.net/SO_AMK/tt5NH/)

jQuery：

```
window.setInterval(function() {
    $.getJSON("http://api.justin.tv/api/stream/summary.json?channel=" + channelName + "&jsonp=?", function(data) {
        document.getElementById("viewers").innerHTML = data.viewers_count;
    });
}, 2000); 
```

PS 您的 jQuery 库已过时，并且您有一些语法错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T23:48:33.430

最简单的方法是使用 setInterval 方法

```
window.setInterval(function () {

    $.getJSON("http://api.justin.tv/api/stream/summary.json?channel="+ channelName + "&jsonp=?", function(a){document.getElementById("viewers").innerHTML  += a.viewers_count;}); 

}, 5000); 
```

[https://developer.mozilla.org/en-US/docs/DOM/window.setInterval](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval)

# android - 什么是标签页的官方 Android 建议？

> ID：12416346
> 
> 赞同：2
> 
> 时间：2012-09-13T23:44:31.400
> 
> 标签：android, tabs, android-tabhost, android-actionbar, design-guidelines

我不得不说我现在在 Android 上设计选项卡式布局时非常迷茫。平台开发人员的设计发展速度似乎比我弄清楚他们的意图要快。

根据我从最近弃用[`TabActivity`](http://developer.android.com/reference/android/app/TabActivity.html)和新[设计指南](http://developer.android.com/design/index.html)的组合中收集到的信息，我认为他们打算让选项卡专门与操作栏一起使用，要么在主操作栏内，要么堆叠在辅助操作栏上。

尽管[开发人员指南建议](http://developer.android.com/guide/topics/ui/actionbar.html)使用操作栏进行“全局导航”。这是否意味着如果您的选项卡仅适用于特定的应用程序上下文，则建议在操作栏之外创建您自己的选项卡？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T00:26:23.927

“全局”在此处用于本地上下文。:) 该声明的意图是说操作栏选项卡应该用于活动全局导航，并且您应该避免使用操作栏选项卡在同一活动的子窗格中切换导航。

这主要适用于可能有多个内容窗格的大屏幕或平板电脑布局。如果您在这样的配置中使用操作栏选项卡，那么这些选项卡仅适用于活动的右侧详细信息窗格而单独保留左侧窗格是没有意义的。如果您想要仅适用于活动的单个窗格的选项卡，则这些选项卡应该是该窗格的一部分，而不是操作栏的一部分。

基本上，选项卡应始终位于其影响的内容的本地。如果切换选项卡在整个活动窗口的不同内容之间切换，请使用操作栏选项卡。如果选项卡在您的 UI 的较小部分中更本地化，请将它们放置在更靠近您选择新选项卡时实际更改的内容的位置。

# c++ - 这段代码确定两条线段是否相交有什么问题？

> ID：12416352
> 
> 赞同：0
> 
> 时间：2012-09-13T23:45:43.817
> 
> 标签：c++, math, line, intersection, algebra

如果分段交叉，我一生都无法弄清楚如何让它返回 true。任何帮助将不胜感激。

```
bool doCross(int x1, int y1, int x2, int y2, int x3, int y3, int x4, int y4)
{
    bool cross = true;
    double denom, uA, uB;

    denom = (y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1);

    if(denom == 0)
    {
        cross = false;
    }
    else
    {
        uA = (x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3) / denom;
        uB = (x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3) / denom;
    }
    if (abs(0 < uA) && abs(uA < 1) && abs(0 < uB) && abs(uB < 1))
    {
        cross = true;
    }
    else
    {
        cross = false;
    }       
    return cross;   
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T23:57:14.097

两条线段*AB*和*CD*相交当且仅当*A*和*B在**CD*的不同侧，反之亦然。要测试点*X*是否在有向线段*PQ*的左侧，请使用*ccw*原语。有关某些代码，请参阅[http://algs4.cs.princeton.edu/91primitives/](http://algs4.cs.princeton.edu/91primitives/)中的*线段相交和*[http://www.cs.princeton.edu/~rs/AlgsDS07/16Geometric.pdf](http://www.cs.princeton.edu/~rs/AlgsDS07/16Geometric.pdf)中的一些幻灯片。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T00:01:35.583

你说：

```
uA = (x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3) / denom;
uB = (x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3) / denom; 
```

我想你想要：

```
uA = ((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / denom;
uB = ((x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3)) / denom; 
```

你说：

```
if (abs(0 < uA) && abs(uA < 1) && abs(0 < uB) && abs(uB < 1)) 
```

您正在获取比较的绝对值，这根本没有意义。你想要：

```
if ((0 < abs(uA)) && (abs(uA) < 1) && (0 < abs(uB)) && abs(uB) < 1)) 
```

在比较浮点数/双精度数时使用整数常量是不好的形式，尽管不一定是错误

# clojure - 如何使 gen-class 对象显示得更好

> ID：12416355
> 
> 赞同：2
> 
> 时间：2012-09-13T23:46:14.400
> 
> 标签：clojure

我有一段代码来实现包含映射的原子映射的引用

```
 > (def a (example.DynaRec.)

 > (dosync (assoc! a 3 {:id 3 :contents "stuff"} 4 {:id 4}))
 ;;=> #[DynaRec@1a659078: {4 [<Atom@118eb00c: {:id 4}] 3 [Atom@242110fc: {:id 3 :contents "stuff"}]] 
```

我想改变它在 repl 中的显示方式，以便它只输出

```
> a 
;;=> ({:id 3 :contents "stuff"}
;;    {:id 4}) 
```

如何才能做到这一点？代码如下所示：

```
(ns example.dyna-rec
  (:gen-class
   :name example.DynaRec
   ：字首 ”-”
   :init 初始化
   :state 状态
   : 扩展 clojure.lang.AFn
   ：实现 [clojure.lang.IDeref
                clojure.lang.Seqable
                clojure.lang.ILookup
                clojure.lang.ITransientMap]))

(defn- $ [this] (:data (.state this)))

（定义-有效？
  （[e]
     （有效？e []））
  （[这个电子]
     （每个？#（包含？e %）（：必需（.state this）））））

(defn -deref [this] @($ this))

（定义-valAt
  ([this k] ((-deref this) k nil))
  （[这个k nv]
    (if-let [vatom ((-deref this) k nv)]
      @vatom）））

（定义-调用
  ([this k] (-valAt this k))
  ([this k nv] -valAt this k nv))

(defn -seq [this] (seq (-deref this)))

(defn -count [this] (count (-deref this)))

(defn - 没有 [这个 obj]
  (alter ($ this) dissoc obj))

（定义-关联
  ([this obj] (-assoc this (:id obj) obj))
  ([这个千伏]
   {:pre [(有效？这个 v)
          (= k (:id v))]}
    (alter ($ this) assock (atom v))
    这））

(defn -conj [这个 obj]
  (-关联这个 obj))

（定义 - 持久 [this]
  (-deref 这个))

(定义-init []
  [[] {:必填 #{:id}
        ：数据（参考{}）}]）

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T00:45:40.880

要扩展经典的 java 模型（clojure 包含），您可以实现自己的`.toString`生成正确字符串的模型，然后告诉 REPL 如何正确打印这个新类

start by adding a super basic `toString` to dyna-rec.clj:

```
(defn- -toString [this]
  (str (into {} this))) 
```

this can be called like this:

```
 (defn- -toString [this]
 (str (zipmap (keys this) (map deref (vals this)))))

example.DynaRec> (.toString a)
"{}"
example.DynaRec> (str a)
"{}" 
```

then improve the printer to match your desired output:

```
(defn- -toString [this]
  (str (zipmap (keys this) (map deref (vals this))))) 
```

and test it:

```
example.DynaRec> (str a)
"{3 {:id 3, :contents \"stuff\"}, 4 {:id 4}}"
example.DynaRec> 
```

This still does not print correctly at the REPL, so we need to **extend the multimethod used by the printer** (print-method) which is used by the REPL to know about your new class:

```
(defmethod print-method 
  example.DynaRec
  [this, w]
  (print-method (zipmap (keys this) (map deref (vals this))) w)) 
```

this produces what you seek:

```
example.DynaRec> a
{3 {:id 3, :contents "stuff"}, 4 {:id 4}} 
```

# javascript - Javascript多维数组传递位置

> ID：12416357
> 
> 赞同：0
> 
> 时间：2012-09-13T23:46:22.147
> 
> 标签：javascript, algorithm, multidimensional-array, nodes, a-star

我正在用 Javascript 实现 A* 寻路算法的一个版本。为了保持理智，我使用了一个伪多维数组（即嵌套数组）。如果您不熟悉 A*，第一步是检查“开放”节点的周围节点。

如何传递“打开”节点的位置并检查阵列中的相邻节点？阵列位置不应该是一流的吗？

```
function checknode (node) //Such as [5,2]
{
     if(array[node+1][node]==something) //In this case [6,2]

} 
```

是的，我知道我可以将 x 和 y 坐标作为单独的参数传递，如下所示：

```
function checknode (nodex, nodey)
{
     if(array[nodex+1][nodey]==something)
} 
```

但是就我的代码而言，这具有的影响是不可取的。

**编辑：**基本上，我想知道是否可以将数组 (5,2) 项的位置传递到我的函数中并进行操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:56:13.003

您可以创建一个包含两个坐标的复合值（使用对象）。这样您就可以将其作为单个参数传递：

```
function checknode(node) {
  if (array[node.x + 1][node.y] == something) //In this case [6,2]
} 
```

示例调用：

```
checknode({ x: 5, y: 2 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T23:54:06.683

我不确定你到底想要什么，但看起来你正在传递一个数组。你想要类似的东西吗

```
function checknode (node) //Such as [5,2]
{
     if( array[ node[0]+1 ][node[1]]==something) //In this case [6,2]

} 
```

因此，如果 node 是一个数组，即 node = [5,2] 此代码将使用“某物”检查数组 [6][2]

# wxwidgets - wxTimer 并发问题

> ID：12416360
> 
> 赞同：0
> 
> 时间：2012-09-13T23:46:41.537
> 
> 标签：wxwidgets

我有一个（尽管可能有几个）wxTimer，它们附加到 wxFrame 中的 wxGLCanvas。计时器可以触发画布的重绘。

主要问题是删除——当框架关闭时，框架及其画布自然会死掉。似乎在计时器的绘制过程中，窗口关闭了。正在进行中的绘制方法现在正在对不再存在的对象进行操作，因此会出现问题。

问题只是有时会出现，这进一步支持了这一评估。在画布的析构函数（我是子类化）中，我在删除它之前调用 timer->Stop()。这似乎没有帮助-大概是因为可能刚刚发布了计时事件？

我的问题是如何防止这种情况发生。在销毁之前停止重复计时器事件的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T22:28:45.750

如果使用事件来处理计时器到期，这似乎很可疑，因为只有在没有更多事件待处理时才真正销毁框架，这是 wxWidgets 首先使用延迟销毁的主要原因之一。

如果您的意思是“我打电话`Destroy()`”但“我删除它”，我真的不知道这怎么会发生，并且一如既往，尝试在一个简单的示例中重现问题并将其提交到[http：/ /trac.wxwidgets.org/](http://trac.wxwidgets.org/)。如果你`delete frame`直接这样做，那么不要这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T13:58:15.703

我的*猜测*是在计时器触发后但在绘图完成之前框架关闭。我建议：添加一个在计时器触发时设置的标志，并且仅在绘图完成时清除。帧关闭代码应该检查这个标志，并且只有在它明确时才继续。

# java - 如何检查堆栈限制，并在 Java 中完成 Chicken Scheme 风格的递归？

> ID：12416363
> 
> 赞同：1
> 
> 时间：2012-09-13T23:47:01.070
> 
> 标签：java, stack, stack-overflow, chicken-scheme

考虑以下代码。这段代码几乎实现了 Chicken Scheme 风格的递归，其中大部分时间函数是直接调用的，但偶尔会有更复杂的蹦床过程。但是，代码不能完全正常工作。我真正想要的是一个方法 stackLimitsAlmostReached，它返回一个布尔值，指示是否存在堆栈溢出的危险。如何检查堆栈限制，并在 Java 中完成 Chicken Scheme 风格的递归？

```
import java.util.Scanner;

public class Main {

public static abstract class Thunk {
    public abstract Thunk x();

    public final void run() {
        Thunk ip = this;

        while (ip != null)
            ip = ip.x();
    }
}

public static void main(String[] unused) {
    final Scanner scanner = new Scanner(System.in);

    new Thunk() {
        public Thunk x() {
            System.out.println("Hello World!");

            try {
                return this.x();
            } catch (StackOverflowError t) {
                System.out.println("GC!");
                scanner.nextLine();
                return this;
            }
        }
    }.run();
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T00:53:06.327

嘿，我可能误解了你的问题，但我认为你必须首先寻找这些选项（Java 明智，但这不是 IMO 的问题）

```
-ss Stacksize to increase the native stack size or

-oss Stacksize to increase the Java stack size, 
```

The default native stack size is 128k, with a minimum value of 1000 bytes. The default java stack size is 400k, with a minimum value of 1000 bytes.

But what i really feel i should warn you about is that the JVM can't support tail call optimisation because of it's security model. [Wikipedia](http://en.wikipedia.org/wiki/Tail_call) . Each time you call the same function , you introduce a new stack frame and that's why you run on limits fast. A proper scheme that supports TCO doesn't actually create a new stack frame , it just updates the values and returns to a continuation at the start of the current frame. this makes recursion very efficient.

Even clojure that runs on the JVM suffers from this problem , that's why it has a lambda called recur to handle that limitation. check also : [TCO paper](http://lambda-the-ultimate.org/node/1333)

# javascript - Phonegap Input 专注于 Mobile Safari

> ID：12416364
> 
> 赞同：1
> 
> 时间：2012-09-13T23:47:02.700
> 
> 标签：javascript, iphone, ios, cordova

`(0, 0)`每次用户关注我的 Phonegap 应用程序中的输入字段时，我都使用以下代码滚动窗口以定位：

```
<input type="text" id="answer" class="answer" />
...

$(document).on("touchstart", ".answer", function() {
  window.scrollTo(0, 0);
}); 
```

我也试过了`setTimeout()`，但这也不起作用：

```
$(document).on("touchstart", ".answer", function() {
  window.scrollTo(0, 0);
  setTimeout(function() {
     scrollWindow();
  }, 10);

  var scrollWindow = function() {
     window.scrollTo(0, 0);
  }
}); 
```

问题是窗口仅在我第二次点击输入字段时滚动。当我第一次点击输入字段时，我希望窗口立即滚动。

我移动窗口的原因是因为 iOS 在输入字段的焦点上生成本机键盘并将整个视图向上移动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T04:33:23.533

To do this I usually use "focus" instead of "touchstart".

```
$('#someFormId input').on("focus", function(event) {
    window.scrollTo(0, 0);
    document.body.scrollTop = 0;
}); 
```

# silverstripe - Silverstripe 3：如何在 CMS 数据网格中显示日期选择器

> ID：12416366
> 
> 赞同：2
> 
> 时间：2012-09-13T23:47:35.563
> 
> 标签：silverstripe

我有一个数据网格，允许用户将事件添加到事件页面。

在它上面，我有 2 个日期字段，因此他们可以指定开始日期和结束日期。除非我在 Sapphire/javascript 中注释掉 DateField.js 中的一行（第 12 行 - `if(!config.showcalendar) return;`），否则这些字段不会显示日期选择器。

有没有办法让日期选择器在不篡改核心的情况下显示？

```
<?php
class Event extends DataObject{
    public static $db = array(
        'Title' => 'Varchar(255)',
        'StartDate' => 'Date',
        'EndDate' => 'Date',
        'Summary' => 'Text',
        'Content' => 'HTMLText'
    );

    static $has_one = array( 
        'WhatsOnCategory' => 'WhatsOnCategory',
        'EventImage' => 'Image'
    );

    public static $summary_fields = array(
        'Title' => 'Title'
    );

    public static $default_sort='StartDate';

    public function getCMSFields() {
        return new FieldList(
            new TextField('Title', 'Title'),
            new DateField('StartDate', 'StartDate'),
            new DateField('EndDate', 'EndDate'),
            new TextField('Summary', 'Summary'),
            new HTMLEditorField('Content', 'Content'),
            new UploadField('EventImage','Image')
        );
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-16T23:43:51.007

DateField 默认情况下不显示日历弹出窗口，您必须对其进行配置才能这样做。

申请所有 DateFields：（您可以将此行放在 getCMSFields 方法的顶部）

```
DateField::set_default_config('showcalendar', true); 
```

应用于特定的 DateField 实例

```
return new FieldList(
    DateField::create('StartDate', 'StartDate')->setConfig('showcalendar', true)
    ...
) 
```

使用 DateField::create 方法而不是 new DateField 允许您直接在一行中调用该类的方法，这很好。我认为这也是 SS 对象的最佳实践。

**更新**

在 SilverStripe 3 中，可以使用新的配置系统设置全局配置。

IE。在你的配置 YML

```
DateField:
  default_config:
    showcalendar: true 
```

如果您使用的是**DateTimeField**，要使“每个实例”配置正常工作，您需要首先调用 getDateField：

```
$myDateTimeField->getDateField()->setConfig('showcalendar',true); 
```

如果您想在 DateTimeField 的 Time 字段上使用 timepicker UI，则需要安装[TimePicker 模块](https://github.com/sheadawson/silverstripe-timepickerfield)，然后：

```
$myDateTimeField->setTimeField(
    TimePickerField::create('StartTime[time]', '')
    ->addExtraClass('fieldgroup-field')
); 
```

# jquery - 在 hashchange 插件中更改哈希的外观

> ID：12416368
> 
> 赞同：0
> 
> 时间：2012-09-13T23:48:19.983
> 
> 标签：jquery, hashchange, jquery-address

我目前正在使用[http://benalman.com/projects/jquery-hashchange-plugin/](http://benalman.com/projects/jquery-hashchange-plugin/)并且我注意到我的哈希显示为“/#page”而不是“/#/page”我试图从jQuery 地址。但是我不能使用 Asual 的原因是它没有像 hashchange 插件那样的触发事件。

当前设置：

```
$j(window).bind('hashchange', function(e) { 
   run w/e functions here
});

load json objects

$(window).trigger('hashchange'); 
```

我注意到在 jQuery Address 中有一个点击选择器的返回。也许我需要这样的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:14:38.780

`/`网址中的额外内容没有什么特别之处。

像往常一样把它放在锚中：`<a href="#/page">`

或者手动设置哈希时：`location.hash="/page"`

# c# - 在 Devexpress 中保存对象需要很长时间，为什么？

> ID：12416369
> 
> 赞同：1
> 
> 时间：2012-09-13T23:48:20.447
> 
> 标签：c#, devexpress, xpo

我不知道这是我的错误还是 Devexpres XPO 中的错误？（版本 12.1.5）
看一下以下示例：

```
static void Main(string[] args)
    {
        var dxs = Session.DefaultSession;
        var sw = new Stopwatch();

        using (var uow = dxs.BeginNestedUnitOfWork())
        {
            var dbp = new DBParent(uow) { TitleXX = "Morgan" };

            // add 1000 child to the parent table
            for (var i = 0; i < 1000; i++)
            {
                var dbc = new DBChild(uow)
                              {
                                  Name = string.Format("Child {0}", i),
                                  Parent = dbp
                              };
            }

            var count = uow.GetObjectsToSave();
            // count = 1001
            sw.Start();
            uow.CommitChanges();
            sw.Stop();
            Console.WriteLine("Time:" +sw.Elapsed);
            // Takes about 7 sec
        }

        using (var uow = dxs.BeginNestedUnitOfWork())
        {
            var dbp = new XPCollection<DBParent>(uow).First();
            dbp.TitleXX = "Another title";
            dbp.Save();

            var count = uow.GetObjectsToSave();
            // count = 1
            sw.Reset();
            sw.Start();
            uow.CommitChanges();
            sw.Stop();
            Console.WriteLine("Time:" + sw.Elapsed); // Takes about 4 sec ????
        }
        Console.ReadLine();
    }
} 
```

这是我的对象：

```
public class DBParent : XPObject
{
    public DBParent(){}
    public DBParent(Session session) : base(session) { }

    private string _TitleXX;
    public string TitleXX
    {
        get { return _TitleXX; }
        set { SetPropertyValue("TitleXX", ref _TitleXX, value); }
    }

    [Association("a1"), Aggregated]
    public XPCollection<DBChild> Childs
    {
        get
        {
            return GetCollection<DBChild>("Childs");                
        }
    }      
}

public class DBChild : XPObject
{
    public DBChild(){}
    public DBChild(Session session): base(session){}

    private string _Name;       
    public string Name
    {
        get { return _Name; }
        set { SetPropertyValue("Name", ref _Name, value); }
    }

    private DBParent _Parent;
    [Association("a1")]
    public DBParent Parent
    {
        get { return _Parent; }
        set { SetPropertyValue("Parent", ref _Parent, value); }
    }       
} 
```

如您所见，保存 1001（1000 个子对象 + 1 个父对象）需要 7 秒，而在下一个块中更新 1 个父对象需要 4 秒。我已经针对 MS Access 和 MS SQL 2008 和 MSSQL-Compact 进行了测试，但结果都相同。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:10:47.277

这似乎是 1001 个离散插入的合理时间长度。这些对象一直保存在内存中，直到您调用 CommitChanges，此时它们被写入数据库。我没有分析 XPO 生成的 SQL，但如果每个插入都发生在它自己的隐式事务中，我不会感到惊讶。

**编辑**

我已经使用 Filip 建议的跟踪编译了您的代码，并且第二个 NestedUnitOfWork 实际上正在更新所有子级，即使没有工作要做（这是在版本 12.1.7 中）。我不确定这是否是设计使然，但对我来说确实是一个错误。

为避免不必要地更新孩子，您可以实例化一个普通的 UnitOfWork：

```
using (var uow = new UnitOfWork())
{
    //...
} 
```

这只会更新父对象。但要小心：您仍然需要一个 NestedUnitOfWork 来进行会影响子对象的更新。

# objective-c - MKAnnotationMethod animatesDrop 不起作用

> ID：12416376
> 
> 赞同：0
> 
> 时间：2012-09-13T23:49:21.337
> 
> 标签：objective-c, mkannotation

我已经做到了，UILongPressGestureRecognizer 会丢下一个图钉，但我希望它是动画的。所以我尝试在 press: 方法中设置 animatesDrop 属性，我没有收到任何错误，但它不起作用。我不知道我是否将属性设置在错误的位置，或者什么。

这是代码。

```
-(void)viewDidLoad
{
    UILongPressGestureRecognizer *longPress = [[UILongPressGestureRecognizer alloc]initWithTarget:self
                                                                                       action:@selector(press:)];
longPress.minimumPressDuration = 0.5f; //user needs to press for 2 seconds
[longPress setDelegate:self];
[worldView addGestureRecognizer:longPress];
[worldView setShowsUserLocation:YES]; 
```

}

```
-(void)press:(UILongPressGestureRecognizer *)recognizer
{
    CGPoint touchPoint = [recognizer locationInView:worldView];
    CLLocationCoordinate2D touchMapCoordinate = [worldView convertPoint:touchPoint toCoordinateFromView:worldView];

if (UIGestureRecognizerStateBegan == recognizer.state) {
    BNRMapPoint *mp = [[BNRMapPoint alloc]initWithCoordinate:touchMapCoordinate
                                                       title:@"Some Title"];
    [worldView addAnnotation:mp];
    [mp setAnimatesDrop:YES];
} 
```

}

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T01:50:56.230

[`setAnimatesDrop:`](http://developer.apple.com/library/ios/#DOCUMENTATION/MapKit/Reference/MKPinAnnotationView_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40008203-CH1-SW5)是 MKPinAnnotationView 的一种方法，而您`BNRMapPoint`似乎是实现`MKAnnotation`协议的注释类。

您需要提供`mapView:viewForAnnotation:`为您的注释返回 MKPinAnnotationView 的方法，您可以在其中将 MKPinAnnotationView 的`animatesDrop`属性设置为`YES`.

可以参考苹果的示例代码[MapCallouts](http://developer.apple.com/library/ios/#samplecode/MapCallouts/Introduction/Intro.html)。

# .htaccess - Pointing to subfolder via .htaccess doesn't work

> ID：12416381
> 
> 赞同：0
> 
> 时间：2012-09-13T23:50:20.230
> 
> 标签：.htaccess, mod-rewrite, url-rewriting, directory-tree

I'm working on a WP based site. I have the site of the client on my space (www.mydomainname.com/~subfolder/sub-subfolder). Now the original domain of the client is pointing to my space (www.clientdomain.com goes directly on the www.domainname.com/~subfolder/) without changing url name. But, whent it happens, the server answer giving a directory tree. I would need the site to point directly to sub-subfolder (not to ~subfolder) without giving the directory tree.

I have used this .htaccess:

```
<IfModule mod_rewrite.c>

Options +FollowSymlinks  

RewriteEngine on

RewriteBase /

RewriteCond &#37;{HTTP_HOST} ^(www\.)?mydomainname\.cc [NC]

RewriteRule .? http://www.mydomainname.cc/~subfolder/ [R=301,L]

</IfModule> 
```

How can I do it? I'm sure I'm doing the same error but I can't find it... Please help me I'm going crazy!!! :)

Thank you!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T23:59:09.513

尝试：

```
RewriteRule %{DOCUMENT_ROOT}/~subfolder/sub-subfolder%{REQUEST_URI} -f [OR]
RewriteRule %{DOCUMENT_ROOT}/~subfolder/sub-subfolder%{REQUEST_URI} -d
RewriteRule ^ /~subfolder/sub-subfolder%{REQUEST_URI} [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T09:20:57.363

尝试在 ~subfolder/ 的 htaccess 中使用它：

```
RewriteEngine on
RewriteBase /
RewriteCond %{REQUEST_FILENAME} ^sub-subfolder
RewriteRule ^(.*)$ sub-subfolder/$1 [L,QSA] 
```

# javascript - shortcut to existentially define variable in javascript

> ID：12416385
> 
> 赞同：2
> 
> 时间：2012-09-13T23:50:35.470
> 
> 标签：javascript, global-variables, variable-assignment, local-variables, not-exists

To avoid clobbering existing variables, I have code like this

```
window.x = typeof x != "undefined" ? x : {} 
```

Which seems like a very long winded way to define something, but necessary to avoid console errors.

I tried this out instead, and it seems to work ok. Is it ok to define a variable like this?

```
window.x=window.x||{} 
```

Or even in the global scope...

```
x=this.x||{} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:56:46.047

这些是非常不同的。

首先，如果不检查`typeof ... === 'undefined'`您将基本上重写任何“虚假”值。但这是微不足道的，还有更微妙的细微差别。

```
window.x = typeof x != "undefined" ? x : {} 
```

这会将一些`x`（不一定是全局的，它可能是局部`x`或`x`局部于某个外部函数）的值分配给全局`x`（`window.x`）。当'local' x 超出范围时，它*在赋值*时的值仍将存储在`window.x`变量中。

```
window.x = window.x || {} 
```

这`window.x`仅适用于；即使我们现在忘记了虚假值，它仍然与第一个值不同（它甚至不检查“本地”`x`存在）。

```
x = this.x || {} 
```

`this`当它是 volatile 时（事件处理程序、超时函数等等），这可能会完全失控，并且在“使用严格”模式下不允许在外部函数体内出现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T23:55:52.700

如果您使用此构造：

```
window.x=window.x||{} 
```

And`x` *已*定义但具有虚假值（零、空字符串、null、NaN、未定义，当然还有 false），那么该值将被新的空对象覆盖。如果这对您来说是可以接受的，因为您确信`x`它将完全未定义或已经定义为对象，那么可以确定，继续...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-04T19:43:05.383

以下是如何避免`console.log`具体破坏：

```
var console = window.console || {"log": function(){} }; 
```

通常，如果您想避免使用默认 (||) 或三元 (?:) 运算符，请使用[调度表：](https://stackoverflow.com/questions/4034742/understanding-dean-edwards-addevent-javascript/13999454#13999454)

```
/* Check for IE Mutation Event */
var browser = "onpropertychange" in document;

/* Map boolean values to variables */
var detect = { "true": ie_param, "false": w3_param };

/* Map string templates with escaped quotes to variables */
var w3_param = [".addEventListener","\u0022DOMAttrModified\u0022",",false"];
var ie_param = [".attachEvent","\u0022onpropertychange\u0022",""];

/* Shadow array indices with key/value pairs */
var api = {"event":0,"attribute":1,"state":2};

/* Generate DOM lookup based on boolean value and matching string template */
var result = "document.getElementsByTagName(\u0022body\u0022)[0]".concat(detect[browser][api.event], "(", detect[browser][api.attribute], ",alert", detect[browser][api.state], ")");

/* Execute generated code */ 
var lazy = Function(result); 
```

> 可选地指向元素数组的对象。该对象始终具有相同数量的键/值对，并且每个数组元素始终具有相同的大小。因此，可以按名称或按值访问数组索引。

**参考**

*   [ECMAScript 2015，第 19.2.1 节：函数构造函数](http://www.ecma-international.org/ecma-262/6.0/#sec-function-constructor)

*   [JavaScript 字符转义序列](https://mathiasbynens.be/notes/javascript-escapes)

*   [万维网的字符模型：字符串匹配和搜索](http://www.w3.org/TR/charmod-norm/)

*   [有趣的代码存档](http://www.keithschwarz.com/interesting/code/?dir=hashed-array-tree)

# windows - Kinect Game on Mac and Windows

> ID：12416388
> 
> 赞同：3
> 
> 时间：2012-09-13T23:51:02.487
> 
> 标签：windows, macos, kinect

I have a project that requires Microsoft Kinect (Windows Version), and also requires running on a Mac and on Windows.

Which platform does everybody think would be the best choice for this? I am developing on a PC. So what would be best in terms of the smoothest transfer to the Mac, and also up to date?

# python - How do I decorate Fabric tasks with @roles when my tasks inherit from the Task class?

> ID：12416394
> 
> 赞同：2
> 
> 时间：2012-09-13T23:51:47.557
> 
> 标签：python, fabric

I have a number of tasks defined as Task subclasses and I have roledefs set similar to the following:

```
env.roledefs = { "web": ["1.2.3.4"], "db": ["5.6.7.8"] }

class Foo(Task):
  name = "foo"

  def run(self):
    pass

foo = Foo() 
```

With the `@roles` decorator I can decorate tasks if they are functions in a module but I'm not sure how to apply this to Task classes. Decorating the class or its run function doesn't seem to work.

I'm using Fabric 1.4.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T23:55:33.843

认为您应该能够像这样使用 init ：

```
def __init__(self):
     env.roles = ['web'] 
```

或使用执行：

```
execute(foo, roles='web') 
```

# python - Filter map reduce to records that match a different collection

> ID：12416395
> 
> 赞同：0
> 
> 时间：2012-09-13T23:51:54.690
> 
> 标签：python, mongodb, mapreduce

I am trying to figure out an elegant way to do the following in mongo / python: I have two collections: one containing a list of people and attributes and one containing a subset of people that is a 'population subset'. I want to run a map reduce job to calculate some aggregate stats on the large list but only using names of people that appear in the population sample. Here is an example set of records:

```
master_list: [{ Name: Jim }, { Age: 24}
              { Name: Bill}, { Age: 38}
              { Name: Mary}, { Age: 55}]

subset : [{ Name: Jim}
          { Name: Mary}] 
```

The idea is to calculate an average of age but only using two of the three records in the master_list, as listed in subset. I am aware that map_reduce in mongo supports a query parameter, but not clear what the best way to deal with the above is given the no joining. One option is for me to preprocess master_list and create an attribute 'include' to flag which records to use, and then operate on that in map_reduce filter. Seems kludgy though and creates a permanent flag in my database which is annoying for various reasons.

**UPDATE**

After reading suggestions to embed list in query I was able to get what I needed with the below

```
map_reduce(mapper, reducer, out = {'merge': 'Stats'}, 
           finalize = finalizer, scope = {'atts': f},
           query = {'Name' : { '$in' : pop }}) 
```

Where pop is a python list of names. Thanks!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T03:59:50.323

在 MongoDB 中有两种方法可以解决这个问题。

1.  如果您的子集相当小，您可以只对子集进行查询以查找所有成员并将该查询的结果用作对 map-reduce 调用的初始[查询。](http://docs.mongodb.org/manual/reference/command/mapReduce/)

2.  但是，如果您有非常大的子集，这可能是不可能的。然后，您可以做的是[使用两个带有“reduce”输出选项的 map-reduce 调用来模拟连接](http://tebros.com/2011/07/using-mongodb-mapreduce-to-join-2-collections/)，以减少到同一个目标集合中。这将创建一个中间集合，其中的文档如下所示：

    ```
    {Name: Jim, Age: 24, inSubset: true}
    {Name: Bill, Age: 38, inSubset: false}
    {Name: Mary, Age: 55, inSubset: true} 
    ```

    最后，您可以在此中间集合上执行第三个 map reduce 以平均所有具有`inSubset: true`.

这是 Python 中 2\. 选项（三个 map-reduce）的代码，使用 pymongo 驱动程序：

```
from pymongo import Connection
from bson import ObjectId, Code

con = Connection(port=30000)  # add host/port here if different from default
db = con['test']    # or the database name you are using

# insert documents
db.master.insert({'_id': ObjectId(), 'Name': 'Jim', 'Age': 24})
db.master.insert({'_id': ObjectId(), 'Name': 'Bill', 'Age': 38})
db.master.insert({'_id': ObjectId(), 'Name': 'Mary', 'Age': 55})

db.subset.insert({'_id': ObjectId(), 'Name': 'Jim'})
db.subset.insert({'_id': ObjectId(), 'Name': 'Mary'})

# map function for master collection
mapf_master = Code(""" function () {
    emit(this.Name, {'age': this.Age, 'inSubset': false});
} """)

# map function for subset collection
mapf_subset = Code(""" function() {
    emit(this.Name, {'age': 0, 'inSubset': true});
} """)

# reduce function for both master and subset
reducef = Code(""" function(key, values) {
    var result = {'age': 0, 'inSubset': false};

    values.forEach( function(value) {
        result.age += value.age;
        result.inSubset = result.inSubset || value.inSubset;
    });

    return result;
} """)

# call map-reduce on master and subset (simulates a join)
db.master.map_reduce(mapf_master, reducef, out={'reduce': 'join'})
db.subset.map_reduce(mapf_subset, reducef, out={'reduce': 'join'})

# final map function for third map-reduce call
mapf_final = Code(""" function() {
    if (this.value.inSubset) {
        emit('total', {'age': this.value.age, 'count': 1});
    }
} """)

# final reduce function for third map-reduce call
reducef_final = Code(""" function(key, values) {
    var result = {'age': 0, 'count': 0};

    values.forEach( function(value) {
        result.age += value.age;
        result.count += value.count;
    });

    return result;
} """)

# final finalize function, calculates the average
finalizef_final = Code(""" function(key, value) {
    if (value.count > 0) {
        value.averageAge = value.age / value.count;
    }
    return value;
} """)

# call final map-reduce 
db.join.map_reduce(mapf_final, reducef_final, finalize=finalizef_final, out={'merge': 'result'}) 
```

结果集合如下所示（从 mongo shell 查询）：

```
> db.result.find()
{ "_id" : "total", "value" : { "age" : 79, "count" : 2, "averageAge" : 39.5 } } 
```

最终平均值存储在 value.averageAge 字段中。

# java - Java Bitwise & Operator Matching Multiple Conditions

> ID：12416399
> 
> 赞同：0
> 
> 时间：2012-09-13T23:52:24.877
> 
> 标签：java

I'm attempting to use java's Bitwise *&* operator and I think I'm misusing it. Using the below example, with messageAddress of 7 both condition 1 and condition 3 are satisfied. Shouldn't a messageAddress of 7 just meet the 3rd condition and not the first? Any ideas on how to change the below logic so that messageAddress of 7 would only meet the last condition?

```
 public static final int SLOW = 1;
    public static final int SMEDIUM = 2;
    public static final int SHIGH = 3;
        String messageAddressHex="7";
        int messageAddress = Integer.parseInt(messageAddressHex, 16);
        if ((messageAddress & SLOW) == SLOW) {
                   //condition 1 met logic
                } else if ((messageAddress & SMEDIUM) == SMEDIUM) {
                    //condition 2 met logic
                } else if ((messageAddress & SHIGH) == SHIGH) {
                    //condition 3 met logic
                } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T23:56:10.247

要使按位掩码有效，您需要使用 2 的幂。

`3 = 1 | 2`, 因此对于任何`x & 3 != 0`,`x & 1 != 0`和`x & 2 != 0`.

更详细地解释一下， 7 是`1 + 2 + 4`或，在二进制中，`111`. 请注意，1 位是高位（因此 7 & 1 == 1）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T23:59:27.917

实际上，`condition 1`是所有奇数，`condition 2`是所有第二个最低有效位打开的数字，并且`condition 3`是 1 和 2 的组合。

我假设您真正想要的是将两个最低有效位检查为 0 到 3 之间的数字。如果是这种情况，您应该使用：

```
if ((messageAddress & SHIGH) == SLOW) {
    //condition 1 met logic
} else if ((messageAddress & SHIGH) == SMEDIUM) {
    //condition 2 met logic
} else if ((messageAddress & SHIGH) == SHIGH) {
    //condition 3 met logic
} 
```

**编辑：**
将另一个常量声明为位掩码是一个更好的设计：

```
public static final int MASK=3; 
```

然后我们可以写：

```
if ((messageAddress & MASK) == SLOW) {
    //condition 1 met logic
} else if ((messageAddress & MASK) == SMEDIUM) {
    //condition 2 met logic
} else if ((messageAddress & MASK) == SHIGH) {
    //condition 3 met logic
} 
```

数字 3 有两个作用 - `MASK`，用作位掩码以仅过滤最后两位，以及`SHIGH`- 是您要检查的最后两位的可能值之一。

顺便说一句，现在您可以使用`switch-case`语句而不是`if-else-if`链：

```
switch (messageAddress & MASK) {
    case SLOW:
        //condition 1 met logic
        break;
    case SMEDIUM:
        //condition 2 met logic
        break;
    case SHIGH:
        //condition 3 met logic
        break;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T23:58:19.367

的二进制表示`7`是`111`（注意，全为）。因此，`7 & ANYTHING == ANYTHING`将始终返回`true`小于或等于`7`且大于或等于 的任何值`0`。例如`7 & 3`：

> 111 & 011
> 
> 第一位：0 (1 & 0)
> 第二位：1 (1 & 1)
> 第三位：1 (1 & 1)

请注意您是如何再次收到第二个参数的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-13T23:58:55.273

```
 111 (=7)
& 001 (=1)
----------
  001 (=1) 
```

您可以通过方法检查 int 值的二进制表示`Integer.toBinaryString`。

# java - Joda Time - 将字符串转换为具有特定时区和特定格式的 DateTime

> ID：12416405
> 
> 赞同：4
> 
> 时间：2012-09-13T23:53:13.940
> 
> 标签：java, jodatime

我想将字符串日期转换为特定时区和特定格式的 DateTime 对象。我该怎么做 ？

字符串日期可以是世界上使用的任何格式。示例 MM-DD-YYYY、YYYY-MM-DD、MM/DD/YY、MM/DD/YYYY 等。时区可以是用户指定的任何合法时区。

示例 - 将 YYYY-MM-DD 转换为太平洋时区的 MM/DD/YY。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-14T00:12:29.837

用于[`DateTimeFormatterBuilder`](http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormatterBuilder.html)构建能够解析/格式化多个`DateTimeFormat`s 的格式化程序，并将结果设置`DateTimeFormatter`为使用指定的`DateTimeZone`：

```
DateTimeParser[] parsers = { 
  DateTimeFormat.forPattern("MM-dd-yyyy").getParser(),
  DateTimeFormat.forPattern("yyyy-MM-dd").getParser(),
  DateTimeFormat.forPattern("MM/dd/yyyy").getParser(),
  DateTimeFormat.forPattern("yyyy/MM/dd").getParser()
};

DateTimeFormatter formatter = new DateTimeFormatterBuilder()
  .append(null, parsers)
  .toFormatter()
  .withZone(DateTimeZone.UTC);

DateTime dttm1 = formatter.parseDateTime("01-31-2012");
DateTime dttm2 = formatter.parseDateTime("01/31/2012");
DateTime dttm3 = formatter.parseDateTime("2012-01-31"); 
```

要格式化给定的`DateTime`，您可以使用`dttm1.toString("yyyy-MM-dd"))`.

# php - 保护对 JQuery 自动完成助手的访问

> ID：12416410
> 
> 赞同：1
> 
> 时间：2012-09-13T23:53:59.583
> 
> 标签：php, jquery, security, jquery-autocomplete

我最近[使用 JQuery 在输入字段上设置了自动完成功能](http://docs.jquery.com/UI/Autocomplete)。我将其源设置为我服务器上可公开访问的 PHP 页面。

```
$(document).ready(function() {
    $("input#q").autocomplete({
        minLength: 3,
        delay: 500,
        autoFocus: true,
        source: "ac.php"
    });
}); 
```

ac.php 在清理接收到的输入后轮询在服务器上运行的搜索服务。

我想知道是否有任何方法只能通过自动完成表单强制访问 ac.php？我在考虑检查引荐来源网址，但可以使用 tamperdata 等工具绕过。

我什至需要担心让助手可以公开访问吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T23:57:34.743

这是不可能的。任何ajax请求其实都是可以伪造的普通HTTP请求。

> 我什至需要担心让助手可以公开访问吗？

不，你没有。将其视为您网站上的任何其他资源（页面）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T23:59:48.287

并非没有某种形式的身份验证，也许是 oauth、digest 等。我个人不会打扰。您可以使用服务器上每 5 分钟生成的密钥并将它们作为请求变量发送，然后尝试匹配它们，但这仍然允许短期访问并导致比它解决的问题更多的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T00:02:53.903

您是否需要担心取决于您的情况。了解请求是否来自 Ajax 调用的一种方法是检查`X-Requested-With`PHP 脚本中的标头。它将由 jQuery 设置为`XMLHttpRequest`. 看这里例如：[http ://davidwalsh.name/detect-ajax](http://davidwalsh.name/detect-ajax)

# javascript - 在重新打开/重新打开类的 Ember 中定义具有特定元的计算属性时的钩子/事件？

> ID：12416414
> 
> 赞同：1
> 
> 时间：2012-09-13T23:54:24.017
> 
> 标签：javascript, coffeescript, ember.js

有没有办法*知道*何时`Ember.Object`在 Ember 的原型上定义属性？

我能够做到这一点并在从以下位置定义属性时得到通知`extend`：

```
App.Model = Ember.Object.extend()
App.Model.reopen Ember.MixinDelegate,
  willApplyProperty: (key) ->
  didApplyProperty: (key) ->
    # 'this' is the prototype

App.Person = App.Model.extend
  name: Ember.computed -> 'John' 
```

但这太过分了，基本上是为原型上定义的每个属性创建一个回调。`reopen`此外，如果您稍后使用（即`didApplyProperty`永远不会调用）添加属性，该策略将不起作用`email`：

```
App.Person = App.Model.extend
  name: Ember.computed -> 'John'    

App.Person.reopen
  email: Ember.computed -> 'example@gmail.com' 
```

在此示例中，目标是能够将这些数据库列附加到类*可缓存*计算属性`App.Person.get('attributes')`.

```
App.Model.reopenClass
  emberFields: Ember.computed(->
    map = Ember.Map.create()

    @eachComputedProperty (name, meta) ->
      if meta.isAttribute
        map.set(name, meta)

    map
  ).cacheable() 
```

Ember-data 会这样做，但问题是如果您在and`App.Person.get('attributes')`之间调用，那么它会在 之后被缓存，因此以后添加的所有内容都不会显示 - 它需要使缓存无效。`extend``reopen``extend``App.Person.attributes`

我尝试使用`App.Person.propertyDidChange('attributes')`，但这似乎不起作用。我最终要做的是覆盖`reopen`并手动删除计算属性上的缓存值：

```
App.Model.reopenClass
  reopen: ->
    result = @_super(arguments...)
    delete Ember.meta(@, 'attributes')['attributes']
    Ember.propertyDidChange(@, 'attributes')
    result 
```

我的问题是，当使用或定义计算**实例属性**（例如数据库列）时，如何使计算**类属性**无效（并清除其缓存值） ？**`email``reopen``extend`**

# proxy - 如何在 vcl_recv 中检查后端是否健康

> ID：12416415
> 
> 赞同：4
> 
> 时间：2012-09-13T23:54:25.297
> 
> 标签：proxy, varnish, varnish-vcl

我有非常复杂的清漆配置。我不能真正使用导演并手动完成路线。

```
//webservice1 and webservice2 has probes working there

set req.backend = webservice1;
if (req.backend.healthy)
{ 
     #redirect there 
}

set req.backend = webservice2;
if(req.backend.healthy)
{ 
     #change parameters with regex and redirect
} 
```

这行得通。但看起来真的很蹩脚。

是否有任何“合法”的方式来确定后端是否健康？像这样：

```
if(webservice2.healthy)
{ 
     #change parameters with regex and redirect
} 
```

这显然是行不通的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-09-19T21:32:31.957

在用谷歌进行大量搜索后，我找到了这个[链接](https://www.varnish-cache.org/lists/pipermail/varnish-misc/2014-May/023693.html)，他们正在谈论迁移到 V4。

编码 ：

```
if(!req.backend.healthy) {
  #your logic
} 
```

对清漆 3 有效，对清漆 4 无效。

**对于清漆 4：**

看看这里： [https ://www.varnish-cache.org/docs/4.0/users-guide/vcl-grace.html#users-guide-handling-misbehave-servers](https://www.varnish-cache.org/docs/4.0/users-guide/vcl-grace.html#users-guide-handling-misbehaving-servers)

所以解决方案是：

```
import std;
set req.backend_hint = webservice1;
if (!std.healthy(req.backend_hint)) {
    set req.backend_hint = webservice2;
} 
```

我希望这对你有帮助:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-28T18:49:46.627

我一直在对此进行大量研究，这是完成它的唯一方法（除非您想编写 vmod）。

假设您总是想用 webservice1 做出响应，除非它生病了，我可能会建议进行一些重构：

```
set req.backend = webservice1;
if(!req.backend.healthy) {
     set req.backend = webservice2;
     #change parameters with regex
}
# redirect here 
```

# archlinux - 让 yaourt 总是对某些包使用 ABS

> ID：12416418
> 
> 赞同：3
> 
> 时间：2012-09-13T23:54:56.840
> 
> 标签：archlinux

我想知道是否可以将 yaourt 设置为始终对某些软件包使用 ABS（构建表单源）（因此即使在执行完整系统升级时它们也是从源构建的：yaourt -Syua）。

/etc/yaourtrc 中的 BuildPkgs list 之类的东西会派上用场，但我找不到类似的东西。

任何人都可以想到一种方法吗？

干杯。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T05:56:23.060

您可以做一个解决方法：您应该从 AUR安装[customizepkg 。](http://aur.archlinux.org/packages.php?ID=10314)Yaourt 可以使用 customizepkg，因此如果您有一个名为package的文件`foo`，将从源代码构建。如果你不想改变PKGBUILD可以是一个空文件。`/etc/customizepkg.d/``foo``foo``/etc/customizepkg.d/foo`

因此，如果您不想更改 PKGBUILD，您只需要更改`touch /etc/customizepkg.d/package-build-from-source`要从源代码构建的每个包。

# c# - 从数据库中检索图像数据/非结构化数据并将其流式传输到 Web 浏览器以供下载

> ID：12416419
> 
> 赞同：0
> 
> 时间：2012-09-13T23:55:11.100
> 
> 标签：c#, asp.net-mvc, database, filestream

我正在使用 ASP.NET MVC 4 开发一个 Web 应用程序，该应用程序从 SQL Server 2008 数据库中检索图像数据/非结构化数据（扫描文档），以通过 Web 浏览器下载。它不用于在 Web 浏览器上查看，但应通过客户端计算机上的默认程序下载和查看。我的主要问题是数据在下载后无法被 PC 识别。需要帮助来解决这个问题。

这是代码片段。

模型

```
 public bool getData(string code)
   {

        SqlCommand cmd = new SqlCommand("spReadDocumentCode", con);
        cmd.CommandType = CommandType.StoredProcedure;
        bool state = false;

        cmd.Parameters.Add("@Code", SqlDbType.VarChar).Value =
          Convert.ToString(code);
        SqlDataAdapter adp = new SqlDataAdapter(cmd);
        DataTable dt = new DataTable();
        try
        {
            if (con.State == ConnectionState.Closed)
                con.Open();
            adp.Fill(dt);
            if (dt.Rows.Count > 0)
            {
                image = (byte[])dt.Rows[0]["Data"];
                // I pass the data to a public MemoryStream variable.
                ms = new MemoryStream((byte[])dt.Rows[0]["Data"]); 
                state = true;
            }

            if (con.State == ConnectionState.Open)
                con.Close();

            return state;
        }
        catch
        {

            if (con.State == ConnectionState.Open)
                con.Close();

            return false;
        } 
```

控制器

```
 [OutputCache(Duration=3600, VaryByParam="code", NoStore = true)]
    public ActionResult Document(string code)
    {

        MemoryStream img = null;
        if (Doc.getData(code))
        {
            img = Doc.getMemoryStream();

        }
        try
        {

            if (img == null)
            {
                return HttpNotFound();
            }
            // I send back an image file, however I want to upgrade the code 
            // to send back any type of scanned documents stored on the database.
            return new FileStreamResult(img, "image/png");  
        }
        catch 
        {
            return null;
        }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T19:39:02.130

看起来数据可能已损坏。

您能否检查存储在数据库中的字节数是否与下载文件中的相同字节数相匹配？如果是这样，您确定数据库中存储的内容确实正确且没有被截断吗？

我假设数据类型是`VARBINARY(MAX)`

# c# - 带有附加线程的生产者消费者队列，用于定期备份数据

> ID：12416421
> 
> 赞同：0
> 
> 时间：2012-09-13T23:55:35.473
> 
> 标签：c#, .net, multithreading

我正在尝试实现具有多个生产者和一个消费者的并发生产者/消费者队列：生产者将一些数据添加到`Queue`，消费者将这些数据从队列中取出以更新集合。此集合必须定期备份到新文件。为此，我创建了一个自定义的可序列化集合：序列化可以通过使用`DataContractSerializer`.

*   该队列仅在消费者和生产者之间共享，因此必须管理对该队列的访问以避免竞争条件。
*   自定义集合在消费者和备份线程之间共享。
*   备份线程可以使用对象定期激活[`System.Threading.Timer`](http://msdn.microsoft.com/it-it/library/system.threading.timer%28v=vs.100%29.aspx)：它最初可能由消费者调度，然后在每个备份过程结束时调度。
*   最后，关闭方法应该停止生产者的排队，然后停止消费者，执行最后一次备份并处置计时器。

一次出列一个项目可能效率不高，所以我想到了使用两个队列：当第一个队列满时，生产者通过调用通知消费者`Monitor.Pulse`。一旦消费者收到通知，队列就会被交换，因此当生产者将新项目排入队列时，消费者可以处理以前的项目。

我写的示例似乎工作正常。我认为它也是线程安全的，但我不确定。以下代码，为简单起见，我使用了`Queue<int>`. 我还使用（再次为简单起见）`ArrayList`而不是可序列化的集合。

```
public class QueueManager
{
    private readonly int m_QueueMaxSize;
    private readonly TimeSpan m_BackupPeriod;

    private readonly object m_SyncRoot_1 = new object();
    private Queue<int> m_InputQueue = new Queue<int>();
    private bool m_Shutdown;
    private bool m_Pulsed;

    private readonly object m_SyncRoot_2 = new object();
    private ArrayList m_CustomCollection = new ArrayList();

    private Thread m_ConsumerThread;
    private Timer m_BackupThread;
    private WaitHandle m_Disposed;

    public QueueManager()
    {
        m_ConsumerThread = new Thread(Work) { IsBackground = true };

        m_QueueMaxSize = 7;
        m_BackupPeriod = TimeSpan.FromSeconds(30);
    }

    public void Run()
    {
        m_Shutdown = m_Pulsed = false;

        m_BackupThread = new Timer(DoBackup);
        m_Disposed = new AutoResetEvent(false);

        m_ConsumerThread.Start();
    }

    public void Shutdown()
    {
        lock (m_SyncRoot_1)
        {
            m_Shutdown = true;
            Console.WriteLine("Worker shutdown...");

            Monitor.Pulse(m_SyncRoot_1);
        }

        m_ConsumerThread.Join();
        WaitHandle.WaitAll(new WaitHandle[] { m_Disposed });

        if (m_InputQueue != null) { m_InputQueue.Clear(); }
        if (m_CustomCollection != null) { m_CustomCollection.Clear(); }

        Console.WriteLine("Worker stopped!");
    }

    public void Enqueue(int item)
    {
        lock (m_SyncRoot_1)
        {
            if (m_InputQueue.Count == m_QueueMaxSize)
            {
                if (!m_Pulsed)
                {
                    Monitor.Pulse(m_SyncRoot_1); // it notifies the consumer...
                    m_Pulsed = true;
                }
                Monitor.Wait(m_SyncRoot_1);  // ... and waits for Pulse
            }

            m_InputQueue.Enqueue(item);
            Console.WriteLine("{0}    \t {1} >", Thread.CurrentThread.Name, item.ToString("+000;-000;"));
        }
    }

    private void Work()
    {
        m_BackupThread.Change(m_BackupPeriod, TimeSpan.FromMilliseconds(-1));

        Queue<int> m_SwapQueueRef, m_WorkerQueue = new Queue<int>();

        Console.WriteLine("Worker started!");
        while (true)
        {
            lock (m_SyncRoot_1)
            {
                if (m_InputQueue.Count < m_QueueMaxSize && !m_Shutdown) Monitor.Wait(m_SyncRoot_1);

                Console.WriteLine("\nswapping...");
                m_SwapQueueRef = m_InputQueue;
                m_InputQueue = m_WorkerQueue;
                m_WorkerQueue = m_SwapQueueRef;

                m_Pulsed = false;
                Monitor.PulseAll(m_SyncRoot_1); // all producers are notified
            }

            Console.WriteLine("Worker\t      < {0}", String.Join(",", m_WorkerQueue.ToArray()));

            lock (m_SyncRoot_2)
            {
                Console.WriteLine("Updating custom dictionary...");
                foreach (int item in m_WorkerQueue)
                {
                    m_CustomCollection.Add(item);
                }
                Thread.Sleep(1000);
                Console.WriteLine("Custom dictionary updated successfully!");
            }

            if (m_Shutdown)
            {
                // schedule last backup
                m_BackupThread.Change(0, Timeout.Infinite);
                return;
            }
            m_WorkerQueue.Clear();
        }
    }

    private void DoBackup(object state)
    {
        try
        {
            lock (m_SyncRoot_2)
            {
                Console.WriteLine("Backup...");
                Thread.Sleep(2000);
                Console.WriteLine("Backup completed at {0}", DateTime.Now);
            }
        }
        finally
        {
            if (m_Shutdown) { m_BackupThread.Dispose(m_Disposed); }
            else { m_BackupThread.Change(m_BackupPeriod, TimeSpan.FromMilliseconds(-1)); }
        }
    }
} 
```

方法中初始化了一些对象，`Run`以允许您`QueueManager`在它停止后重新启动它，如下面的代码所示。

```
public static void Main(string[] args)
{
    QueueManager queue = new QueueManager();

    var t1 = new Thread(() =>
    {
        for (int i = 0; i < 50; i++)
        {
            queue.Enqueue(i);
            Thread.Sleep(1500);
        }
    }) { Name = "t1" };

    var t2 = new Thread(() =>
    {
        for (int i = 0; i > -30; i--)
        {
            queue.Enqueue(i);
            Thread.Sleep(3000);
        }
    }) { Name = "t2" };

    t1.Start(); t2.Start(); queue.Run();
    t1.Join(); t2.Join(); queue.Shutdown();
    Console.ReadLine();

    var t3 = new Thread(() =>
    {
        for (int i = 0; i < 50; i++)
        {
            queue.Enqueue(i);
            Thread.Sleep(1000);
        }
    }) { Name = "t3" };

    var t4 = new Thread(() =>
    {
        for (int i = 0; i > -30; i--)
        {
            queue.Enqueue(i);
            Thread.Sleep(2000);
        }
    }) { Name = "t4" };

    t3.Start(); t4.Start(); queue.Run();
    t3.Join(); t4.Join(); queue.Shutdown();
    Console.ReadLine();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T01:36:23.480

我建议将`BlockingCollection`用于生产者/消费者队列。它是专门为此目的而设计的。生产者使用添加项目`Add`，消费者使用`Take`。如果没有要带的物品，那么它将阻塞，直到添加一个为止。它已经设计用于多线程环境，因此如果您只是使用这些方法，则无需显式使用任何锁或其他同步代码。

# ios - UIScrollView里面章节长文本的构造

> ID：12416429
> 
> 赞同：1
> 
> 时间：2012-09-13T23:56:14.813
> 
> 标签：ios, uiscrollview, uitextview

我的 iOS 应用程序的一个视图在 UIScrollView 中包含一个很长的文本，并带有用户指南。文本以三种语言本地化，并按标题分成章节。

我正在使用多个 UITextView。在每个视图构造函数的末尾，我将其添加到主视图并调用：

`[self autoSizeTextView:myuitexview];`

使其根据所使用语言的文本长度调整大小。

下一个 UITextView 定位计算前一个的位置和高度，以使它们按顺序呈现而不重叠。

这是一项乏味的工作！考虑到我不想使用 Web 视图（以保持良好的性能），是否有另一种方法可以在 iOS 上显示长而不是单块文本（带有章节和不那么简单的布局）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T03:56:41.660

从我的评论中发布：

有理由不使用 UITableView 吗？我建议不要在 UIScrollView 中执行此操作，而是在 UITableView 中执行此操作。它会为您的应用程序节省一些资源来进行定位计算，并且段落的延迟加载将由 cellForRowAtIndexPath 处理，这将使应用程序保持非常灵敏

@flip79：很高兴它有帮助！

# linux - Linux内核结构文件指针

> ID：12416430
> 
> 赞同：4
> 
> 时间：2012-09-13T23:56:31.893
> 
> 标签：linux, kernel, driver, linux-device-driver, file-structure

是否保证结构文件指针*在*其打开到关闭的生命周期中不会被释放和重新分配到内存中的其他位置？

我想唯一标识传递给设备驱动程序的文件结构（通过读/写/打开等），并且想知道是否可以只使用指向文件结构的指针进行标识。我看到的唯一其他选择是在 private_data 中存储一个唯一标识符，如果不能保证结构文件指针不会改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T05:21:57.900

指针不会发生任何事情。但是你必须确保如果这个指针被传递到内核用户边界（或计算机网络），你实际上检查你得到的指针是一个有效的指针，也许是一个合适的指针（预期从这个特定的来电者，如果你能识别他们）。否则你会有一个巨大的安全漏洞。

# centos - 在多 VM 环境中定位的特定 VM 名称

> ID：12416433
> 
> 赞同：3
> 
> 时间：2012-09-13T23:56:59.770
> 
> 标签：centos, chef-infra, vagrant

我正在创建两个带有 Vagrantfile 的 CentOS 盒子，并在它们各自的块中为它们使用两个唯一的主机名

```
box1_config.vm.host_name = "Base1"
box1_config.vm.network:hostonly, "192.168.50.4"

box2_config.vm.host_name = "Base2"
box2_config.vm.network:hostonly, "192.168.50.5" 
```

操作系统启动时没有任何问题，但我不知道使用什么主机名来访问它们。

我尝试将以下作为“vagrant ssh”的参数，但没有一个有效，我收到错误：“此命令需要特定的 VM 名称才能在多 VM 环境中定位”

试过：

*   主机名
*   IP地址
*   VirtualBox 中的虚拟机名称

任何线索我可能会出错？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T12:56:50.097

vagrant ssh 的参数是附加到 vm 定义块的符号。例如（来自 vagrant 文档）：

```
Vagrant::Config.run do |config|
  config.vm.define :web do |web_config|
    web_config.vm.box = "web"
    web_config.vm.forward_port 80, 8080
  end

  config.vm.define :db do |db_config|
    db_config.vm.box = "db"
    db_config.vm.forward_port 3306, 3306
  end
end 
```

你会做的

```
vagrant ssh web 
```

或者

```
vagrant ssh db 
```

因为这些是配置中定义的框的名称。

HTH。

# apache - 如何在 Apache 中代理查询字符串 URL？

> ID：12416434
> 
> 赞同：1
> 
> 时间：2012-09-13T23:57:04.027
> 
> 标签：apache, proxy, urldecode

我正在尝试使用较旧的 Apache (2.2.17) 进行代理：

[http://foo.com/proxy/?url=http%3A%2F%2Fbar.com%2foo](http://foo.com/proxy/?url=http%3A%2F%2Fbar.com%2foo)

到：

[http://bar.com/foo](http://bar.com/foo)

我有：

RewriteCond %{QUERY_STRING} ^url=(.*)$
RewriteRule ^/proxy/ %1? [P,L]

不幸的是，这导致 Apache 尝试代理 URL 编码的值（日志输出）：

(3) 将模式 '^/proxy/' 应用到 uri '/proxy/'
(4) RewriteCond: input='url='http%3A%2F%2Fbar.com%2foo'' pattern='^url=(. *)$' => 匹配
(2) 重写'/proxy/' -> ''http%3A%2F%2Fbar.com%2foo'?'
(3) 拆分uri='http%3A%2F%2Fbar.com%2foo'？-> uri='http%3A%2F%2Fbar.com%2foo', args= (2) 使用[http://foo.com/](http://foo.com/) 'http%3A%2F%2Fbar.com%2foo'
强制代理吞吐量 （ 1) 继续代理请求 proxy:http://foo.com/'http%3A%2F%2Fbar.com%2foo' [OK]

所以，看来有两个问题。一种是结果中有撇号，另一种是结果没有经过 URL 解码。我认为 Apache 在原始协议之前添加的原因：//主机是它没有将结果视为 URL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T00:06:53.417

如果您有权访问 vhost/server 配置（并且看起来像您这样做），您可以配置 apache 的内置重写映射之一来为您取消转义：

```
RewriteMap unescape int:unescape 
```

然后你可以在你的规则中使用地图：

```
RewriteCond %{QUERY_STRING} ^url=(.*)$
RewriteRule ^/proxy/ ${unescape:%1}? [P,L] 
```

# windows-phone-7 - windows phone c#检查有效的url并替换列表中的foreach项目

> ID：12416436
> 
> 赞同：0
> 
> 时间：2012-09-13T23:57:12.987
> 
> 标签：windows-phone-7, url, listbox

我正在获取 Windows Phone 中的对象列表，并将它们显示在带有数据绑定的列表框中。某些图像 url 无效，因此在列表中添加每个对象后，我运行以下代码来检查和替换，如果无效

```
 private void CheckLinkUrl(Person p)
    {
            Uri filePath = new Uri(p.img_url);
            string correct = p.img_url;
            HttpWebRequest fileRequest = HttpWebRequest.CreateHttp(filePath);
            fileRequest.Method = "HEAD";
            fileRequest.BeginGetResponse(result =>
            {
                HttpWebRequest resultInfo = (HttpWebRequest)result.AsyncState;
                HttpWebResponse response;
                try
                {
                    response = (HttpWebResponse)resultInfo.EndGetResponse(result);
                }
                catch (Exception e)
                {
                    p.img_url = "http://somethingelse.com/image.jpg";

                }                    

            }, fileRequest);

    } 
```

问题是它**非常**慢，加载每张图片有时需要 2 分钟以上（尽管 UI 保持响应，并且除了图片之外，其他所有内容都会立即显示在列表框中）

难道我做错了什么？我能让它跑得更快吗？

编辑：我尝试使用 imagefailed 事件并替换链接，加载图片的速度没有提高

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T05:14:04.370

我在我的应用程序中为避免此问题所做的是，我已使用默认图像加载项目，图像源绑定到我的结果项目类型中的属性`ImageSource`。默认情况下，它返回默认图像。处理或下载完成后，图像源值更改为触发`NotifyPropertyChanged`事件的新图像，因此它会自动反映在 UI 上。我希望它对你有帮助。

# uitableview - 带有 XIB 的 UITabView 内的 uiNavaigationcontroller 内的 UITableview

> ID：12416440
> 
> 赞同：0
> 
> 时间：2012-09-13T23:57:27.613
> 
> 标签：uitableview, uinavigationcontroller, xamarin.ios

请原谅完整的单触菜鸟。

我有一个主选项卡控制器，它是应用程序的基础，当我导航到其中一个选项卡时，我需要的是 uinavigationcontroller，里面有一个 uitableview。

我处理的主要标签视图。

选择选项卡的辅助视图，我进入 IB 并拖动一个导航控制器，然后在其上拖动一个 uitableview。所以现在我有了 XIB 集。

我如何在单声道中声明这些东西以连接它？主控制器很明显，类就在那里，从 UINvaigationController 派生，它将从 XIB 加载它。我在哪里声明作为子视图的 UITableView ？我如何将它连接到 XIB，因为它与主导航控制器在同一个 XIB 中？

感谢您提供的任何指示，如果这是一个重复的问题，我们深表歉意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T07:40:32.907

我建议你这样做：

1.  使用 UITableView 制作 XIB 文件，但没有 UINavigationController。如果您想查看视图的外观，请将视图的“顶部栏”属性值从“无”设置为“导航栏”。这只是为了预览。
2.  将 UINavigationController 的实例添加到您的 AppDelegate；
3.  用 UITableView 调用 UINavigationController.PushViewController；
4.  将 UINavigationController 作为视图控制器添加到您的选项卡之一；

示例：假设friendsView的UI包含UITableView。

```
public partial class AppDelegate : UIApplicationDelegate
{
    // 1, 2
    Friends friendsView;
    UINavigationController friendsNav;

    ...

    // 3
    public override bool FinishedLaunching (UIApplication app, NSDictionary options)
    {
        friendsView = new Friends ();
        friendsNav = new UINavigationController();
        friendsNav.PushViewController(friendsView, false);

        ...

        // 4
    MyTabController.ViewControllers = new UIViewController[]{
            journalNav, friendsNav
        };
    }
} 
```

因此，您将有 2 个标签 journalNav、friendsNav。当你切换到friendsNav时，friendsView带有UITableView和导航栏。

# c# - 如何检查列表中的重复项目 ?

> ID：12416441
> 
> 赞同：-6
> 
> 时间：2012-09-13T23:57:31.453
> 
> 标签：c#

我有这个代码：

```
private void test(List<string> a)
{

} 
```

我想在 for 循环中使用 for 并检查 List a 中是否存在重复项，然后将其标记为 null。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:01:12.437

不确定您想在这里做什么，但如果您只想获取列表中不同值的集合，您可以使用 LINQ 来执行此操作：

```
var distinctOnes = a.Distinct(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:03:03.370

你真的应该避免有副作用的方法[Side Effects Answer](https://stackoverflow.com/a/1073932/809314)。你可以像这样实现你想要的：

```
private List<String> test(List<String> originalList)
{
    List<String> returnList = new ArrayList<String>();
    for (String value : originalList)
    {
        if (!returnList.contains(value))
        {
            returnList.add(value);
        }
    }
    return returnList;
} 
```

如果您真的想要，您也可以轻松地修改此方法以添加 null （而不是如果已添加任何内容，则不添加任何内容）...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T00:03:20.557

```
private bool HasDuplicates(List<string> a)
{
    return a.Distinct().Count() != a.Count();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T00:04:33.690

你可以使用 LINQ

```
var list = (from n in a select n).Distinct().ToList(); 
```

所以知道你有一个唯一的列表，你可以检查“a”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T00:02:06.787

遍历字符串并将新字符串放入 HashSet 中，以便您可以有效地检查重复：

```
var set = new HashSet<string>();
for (int i = 0; i < a.Count; i++) {
  if (set.Contains(a[i])) {
    // duplicate
    a[i] = null;
  } else {
    set.Add(a[i]);
  }
} 
```

# objective-c - 将视图的 NSInteger 属性设置为 NSInteger？

> ID：12416446
> 
> 赞同：3
> 
> 时间：2012-09-13T23:58:23.013
> 
> 标签：objective-c, properties, nsinteger

我正在尝试在我准备加载的视图上设置一个变量。下面是设置它的代码：

```
 NSInteger amountOfQuestions = [self.questions.text intValue];
    Timer_ViewController *tvc = [[Timer_ViewController alloc] initWithNibName:@"Timer_ViewController" bundle:nil];

    tvc.amountOfQuestions = &amountOfQuestions; 
```

这是@interface `Timer_ViewController`：

```
@interface Timer_ViewController : UIViewController
{
    NSInteger amountOfQuestions;
}

    @property (nonatomic) NSInteger *amountOfQuestions;

@end 
```

我对objective-c相对较新，因此指出明显的设计缺陷将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-14T00:08:58.640

你不应该做`NSInteger`一个指针——它不是一个对象类型，只是一个`typedef`简单的原始类型。如果您使用的是相对较新版本的 Xcode，则可以使用以下内容：

```
@interface Timer_ViewController : UIViewController
@property (nonatomic, assign) NSInteger amountOfQuestions;
@end 
```

并使用：

```
tvc.amountOfQuestions = [self.questions.text intValue]; 
```

您甚至不必声明实例变量或`@synthesize`属性 - Xcode 会为您处理它。

# c# - 使用基于 2 个变量的 LINQ 从列表中选择 1 个对象

> ID：12416449
> 
> 赞同：1
> 
> 时间：2012-09-13T23:58:47.380
> 
> 标签：c#, linq, list, select

我一直在尝试通过阅读 StackOverflow 上的内容来解决这个问题，这些信息很有帮助，但我似乎无法实现我发现的东西。

我有一个数据列表，我想检查数据集中是否存在与我提供的 2 个变量匹配的条目。

```
public void SaveWaveDataFor( List<WaveData> newData )
{
    foreach(WaveData wave in newData)
    {
        //WaveData item = data.FirstOrDefault( o => o.id == wave.id );
        var item = data.Select( o => new{ wave.id, wave.waveNumber  } );
        Debug.Log( item.id );
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:04:12.747

如果要获取`wave`符合两个条件的所有对象，可以使用`Where()`子句：

```
// items will be an IEnumerable<WaveData> containing the matching objects
// where id == matchId and waveNumber == matchNumber
var items = data.Where(o => o.id == matchId && o.waveNumber == matchNumber); 
```

该`Select()`子句通常用于将匹配的元素转换为另一种类型的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T05:19:20.813

如果您只想检查条目是否存在，那么您可以使用`Any`Linq 中的 Operator。

```
bool recordsExists = data.Any(o => o.id == matchId && o.waveNumber == matchNumber); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T00:15:53.230

实际上，注释掉的行对此更好。

FirstOrDefault 将返回第一个匹配项，如果没有项匹配，则返回 null。

另一方面，如果您只想知道某个项目是否存在，则可以使用 Any()。Any(x=>x.Id == matchId) 仅当列表包含具有匹配 ID 的项目时才会返回 true，否则返回 false。

你会这样做：

```
public void SaveWaveDataFor( List<WaveData> newData )
{
    int waveIdToMatch = 1;
    int waveNumberToMatch = 2;
    foreach(WaveData wave in newData)
    {
        WaveData item = data.FirstOrDefault( o => o.id == waveIdToMatch && o.waveNumber == waveNumberToMatch );
        //if a match exists, item will not be a WaveData object, otherwise it will be null
        Debug.Log( item.id );
    }
} 
```

# c - 我可以在 C 中使用 void 指针作为数组吗？

> ID：12416459
> 
> 赞同：0
> 
> 时间：2012-09-14T00:00:09.827
> 
> 标签：c, arrays, undefined-behavior, void-pointers

我尝试在 C 中执行此操作，但它崩溃了：

```
int nValue=1;   
void* asd;  
asd[0]=&nValue; 
```

出现以下错误：

```
*error C2036: 'void**' *: unknown size  
error C2100: illegal indirection* 
```

我可以在 C 中使用 void 指针作为数组吗？

如果可以，正确的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T00:17:58.603

> 我可以在 C 中使用 void 指针作为数组吗？

没有。您可以转换为 和 from `void*`，但不能服从它，当您考虑它时，它是有道理的。

它指向一个未知类型，所以大小也是未知的。因此，您不可能对其执行指针算术（这就是这样`asd[0]`做的），因为您不知道要从基指针偏移多少字节，也不知道要写入多少字节。

在旁注中，`asd`（可能）指向无效内存，因为它未初始化。写入或读取它会调用未定义的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:49:14.640

你可以这样写：

```
int main()
{
    int iv = 4;
    char c = 'c';
    void *pv[4];
    pv[0] = &iv;
    pv[1] = &c;

    printf("iv =%d, c = %c", *(int *)pv[0], *(char *)pv[1]);
    return 0;
} 
```

# android - Android 后退按钮和恢复活动

> ID：12416462
> 
> 赞同：2
> 
> 时间：2012-09-14T00:00:30.783
> 
> 标签：android, android-activity, android-lifecycle

我有这个问题。
我有一个启动其他活动**B的活动****A**（通过 onclick - 按钮）。 在**B**中，我有一个返回按钮可以返回活动**A**。我按下它。 现在我在 A，我再次按下按钮去 B。

 ******如果我使用 android 后退按钮（我在 B 中），我会先回到 A，然后再回到 B。
但是现在，如果我再次按下 android 后退按钮，我不会去 A 的先前活动或它从应用程序中退出. 我回到B！

我怎样才能防止这种行为？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T00:08:53.437

活动B的后退按钮不应该启动活动A，而是关闭活动B并完成：http: [//developer.android.com/reference/android/app/Activity.html#finish%28%29](http://developer.android.com/reference/android/app/Activity.html#finish%28%29)

请注意，在界面上有一个“后退”按钮可能是糟糕的用户界面设计。这个官方的 Android 页面说“不要使用标记的后退按钮” [http://developer.android.com/design/patterns/pure-android.html](http://developer.android.com/design/patterns/pure-android.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T06:41:23.107

如果您希望自定义后退按钮在活动 A 和 B 之间切换，则只需启动意图即可。

我相信您的问题出在 android 后退按钮上。如果您不想使用此操作转到上一个活动，您可以在清单文件中写入`<activity>`A 和 B 活动的标签下 - `android:noHistory="true"`。这样做将从应用程序中退出。由于活动堆栈没有存储任何活动，但这样的要求是相当混乱的 UI 方法。******

# c++ - 使用 R CMD SHLIB 编译 C++ 文件时如何指定头文件搜索路径？

> ID：12416463
> 
> 赞同：6
> 
> 时间：2012-09-14T00:00:46.050
> 
> 标签：c++, r, boost

我正在尝试编译一个在 Mac OSX 上使用 Boost 库的 C++ 文件。例如看下面的“simple.cpp”

```
#include <boost/random.hpp>
using namesapce boost::math;

int main(){
    boost::mt19937 rng;
    rng.seed(static_cast<boost::uint32_t> (std::time(0)));

    return 0;
} 
```

如果我在命令外壳中编译文件

```
g++ -I/usr/local/boost simple.cpp 
```

那么一切都很好。但我想建立一个共享库，以便我可以使用它来加速我的 R 项目。如果我使用

```
R CMD SHLIB test.cpp 
```

然后它报告找不到头文件。有没有办法指定 R CMD 的搜索路径？就像是

```
R CMD SHLIB -I/usr/local/boost test.cpp 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-14T00:07:15.150

你想设置`PKG_CXXFLAGS`——见[精细手册的第 1.2 节。“使用 Makevars”](http://cran.r-project.org/doc/manuals/R-exts.html#Using-Makevars)以及 [第 5.5 节“创建共享对象”](http://cran.r-project.org/doc/manuals/R-exts.html#Creating-shared-objects)了解详细信息。

# ios - 如何从 iOS 应用程序启动 Safari 并打开 URL

> ID：12416469
> 
> 赞同：223
> 
> 时间：2012-09-14T00:01:31.967
> 
> 标签：ios, url, mobile-safari

在设置页面上，我想包含三个链接

*   我的应用支持网站
*   YouTube 应用教程
*   我的主站点（即：链接到“由 Dale Dietrich 创建”标签。）

我搜索了这个网站、网络和我的文档，但没有发现任何明显的东西。

**注意：**我不想在我的应用程序中打开网页。我只想将链接发送到 Safari，并且该链接在那里打开。我已经看到许多应用程序在他们的设置页面中做同样的事情，所以这一定是可能的。

* * *

## 回答 #1

> 赞同：394
> 
> 时间：2012-09-14T00:08:52.777

这是我所做的：

1.  我在头 .h 文件中创建了一个 IBAction，如下所示：

    ```
     - (IBAction)openDaleDietrichDotCom:(id)sender; 
    ```

2.  我在“设置”页面上添加了一个 UIButton，其中包含我要链接到的文本。

3.  我将按钮适当地连接到文件所有者中的 IBAction。

4.  然后执行以下操作：

**Objective-C**

```
- (IBAction)openDaleDietrichDotCom:(id)sender {
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"http://www.daledietrich.com"]];
} 
```

**迅速**

（viewController中的IBAction，而不是头文件）

```
if let link = URL(string: "https://yoursite.com") {
  UIApplication.shared.open(link)
} 
```

> **请注意**，我们不需要转义字符串和/或地址，例如：
> 
> ```
> let myNormalString = "https://example.com";
> let myEscapedString = myNormalString.addingPercentEncoding(withAllowedCharacters: .urlHostAllowed)! 
> ```
> 
> 事实上，逃逸可能会导致打开失败。

* * *

## 回答 #2

> 赞同：169
> 
> 时间：2015-02-13T14:22:41.803

**斯威夫特语法：**

```
UIApplication.sharedApplication().openURL(NSURL(string:"http://www.reddit.com/")!) 
```

**适用于 iOS 9.3 及更早版本的新 Swift 语法**

作为 Swift 的一些新版本（可能是 swift 2？）， UIApplication.sharedApplication() 现在是 UIApplication.shared （我猜是更好地利用计算属性）。此外，URL 不再隐式转换为 NSURL，必须使用 as! 显式转换！

```
UIApplication.sharedApplication.openURL(NSURL(string:"http://www.reddit.com/") as! URL) 
```

**从 iOS 10.0 开始的新 Swift 语法**

从 iOS 10.0 开始，openURL 方法已被弃用并替换为更通用的方法，该方法采用选项对象和异步完成处理程序

```
UIApplication.shared.open(NSURL(string:"http://www.reddit.com/")! as URL) 
```

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2015-10-14T10:05:52.557

这里需要检查要打开的 url 是否能够被设备或模拟器打开。因为有时（模拟器中的大多数）我发现它会导致崩溃。

**Objective-C**

```
NSURL *url = [NSURL URLWithString:@"some url"];
if ([[UIApplication sharedApplication] canOpenURL:url]) {
   [[UIApplication sharedApplication] openURL:url];
} 
```

**斯威夫特 2.0**

```
let url : NSURL = NSURL(string: "some url")!
if UIApplication.sharedApplication().canOpenURL(url) {
     UIApplication.sharedApplication().openURL(url)
} 
```

**斯威夫特 4.2**

```
guard let url = URL(string: "some url") else {
    return
}
if UIApplication.shared.canOpenURL(url) {
    UIApplication.shared.open(url, options: [:], completionHandler: nil)
} 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2012-09-14T00:06:25.227

看一下[`-openURL:`](http://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006728-CH3-SW14)UIApplication 上的方法。它应该允许您将 NSURL 实例传递给系统，这将确定在哪个应用程序中打开它并启动该应用程序。（请记住，您可能需要先检查一下`-canOpenURL:`，以防系统上当前安装的应用程序无法处理该 URL - 尽管这对于普通`http://`链接来说可能不是问题。）

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2015-03-08T17:37:11.923

而且，如果您不确定提供的 URL`text`是否有方案：

```
NSString* text = @"www.apple.com";
NSURL*    url  = [[NSURL alloc] initWithString:text];

if (url.scheme.length == 0)
{
    text = [@"http://" stringByAppendingString:text];
    url  = [[NSURL alloc] initWithString:text];
}

[[UIApplication sharedApplication] openURL:url]; 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2017-03-24T05:22:13.533

不推荐使用的 Objective-C 版本是：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"http://apple.com"] options:@{} completionHandler:nil]; 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2017-05-01T04:58:55.853

**斯威夫特 3.0**

```
if let url = URL(string: "https://www.reddit.com") {
    if #available(iOS 10.0, *) {
        UIApplication.shared.open(url, options: [:])
    } else {
        UIApplication.shared.openURL(url)
    }
} 
```

这也支持运行旧版本 iOS 的设备

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2017-08-12T19:50:40.883

**带有完成按钮的**Swift 3解决方案****

 **不要忘记`import SafariServices`

```
if let url = URL(string: "http://www.yoururl.com/") {
            let vc = SFSafariViewController(url: url, entersReaderIfAvailable: true)
            present(vc, animated: true)
        } 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2019-01-27T16:48:33.400

由于自 iOS 10.0 起已弃用此答案，因此更好的答案是：

```
if #available(iOS 10.0, *) {
    UIApplication.shared.open(url, options: [:], completionHandler: nil)
}else{
    UIApplication.shared.openURL(url)
} 
```

y en Objective-c

```
[[UIApplication sharedApplication] openURL:@"url string" options:@{} completionHandler:^(BOOL success) {
        if (success) {
            NSLog(@"Opened url");
        }
    }]; 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2020-03-31T03:30:02.043

**斯威夫特 5：**

```
func open(scheme: String) {
   if let url = URL(string: scheme) {
      if #available(iOS 10, *) {
         UIApplication.shared.open(url, options: [:],
           completionHandler: {
               (success) in
                  print("Open \(scheme): \(success)")
           })
     } else {
         let success = UIApplication.shared.openURL(url)
         print("Open \(scheme): \(success)")
     }
   }
 } 
```

**用法：**

```
open(scheme: "http://www.bing.com") 
```

参考：

[iOS10中的OpenURL](https://stackoverflow.com/questions/38964264/openurl-in-ios10)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-10-24T03:24:54.987

**openURL( *:)****在 iOS 10.0 中已被弃用，您应该在 UIApplication 上使用以下实例方法：**open(*** **:options:completionHandler :)**

**使用 Swift 的示例**这将在 Safari 中
打开“ [https://apple.com ”。](https://apple.com)

```
if let url = URL(string: "https://apple.com") {
    if UIApplication.shared.canOpenURL(url) {
        UIApplication.shared.open(url, options: [:], completionHandler: nil)
    }
} 
```

[https://developer.apple.com/reference/uikit/uiapplication/1648685-open](https://developer.apple.com/reference/uikit/uiapplication/1648685-open)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-10-03T19:21:08.470

**在 SWIFT 3.0 中**

```
 if let url = URL(string: "https://www.google.com") {
                 UIApplication.shared.open(url, options: [:])
               } 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-10-24T09:42:57.217

尝试这个：

```
NSString *URL = @"xyz.com";
if([[UIApplication sharedApplication] canOpenURL:[NSURL URLWithString:URL]])
{
     [[UIApplication sharedApplication] openURL:[NSURL URLWithString:URL]];
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-04-13T12:30:28.510

在 Swift 1.2 中，试试这个：

```
let pth = "http://www.google.com"
    if let url = NSURL(string: pth){
        UIApplication.sharedApplication().openURL(url) 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2017-10-30T12:45:41.467

斯威夫特 4 解决方案：

```
UIApplication.shared.open(NSURL(string:"http://yo.lo")! as URL, options: [String : Any](), completionHandler: nil) 
```**

# php - Ajax 表单 - 如果浏览器不支持 javascript 怎么办？

> ID：12416476
> 
> 赞同：0
> 
> 时间：2012-09-14T00:02:35.463
> 
> 标签：php, jquery, ajax, forms

我知道一些 PHP，现在我想使用 ajax/jquery 组合它。只是为了学习目的，我制作了一些脚本。我想制作一个检查可用性等的注册表单。但是在我开始制作这样的脚本之前，我想做一些更简单的事情来检查它是如何工作的。

我的目标是使用 ajax 的联系表格，它可以工作。数据被发送到 php 验证脚本。错误保存在一个数组中，它返回错误列表或发送消息。

但我有几个问题：

1.  如果浏览器不支持javascript怎么办。有没有办法仍然发送消息？
2.  提交触发 ajax 发布功能。在进入 php 文件（客户端）之前添加 jquery 验证的最佳方法是什么

    联系 AJAX 表格

    ```
    <script language="JavaScript" type="text/javascript">
        function ajax_post(){
            // Create our XMLHttpRequest object
            var hr = new XMLHttpRequest();
            // Create some variables we need to send to our PHP file
            var url = "functions/validation.php";
            var name = document.getElementById("name").value;
            var subject = document.getElementById("subject").value;
            var email = document.getElementById("email").value;
            var message = document.getElementById("message").value;
            var vars = "name="+name+"&subject="+subject+"&email="+email+"&message="+message;
            hr.open("POST", url, true);
            // Set content type header information for sending url encoded variables in the request
            hr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            // Access the onreadystatechange event for the XMLHttpRequest object
            hr.onreadystatechange = function() {
                if(hr.readyState == 4 && hr.status == 200) {
                    var return_data = hr.responseText;
                    document.getElementById("status").innerHTML = return_data;
                }
            }
            // Send the data to PHP now... and wait for response to update the status div
            hr.send(vars); // Actually execute the request
            document.getElementById("status").innerHTML = "processing...";

        }
    </script> 
    ```

    # 联系表

    文本

    ```
     <label>Name
            <span id="nameInfo" class="small">Add your name</span>
        </label>
        <input type="text" name="name" id="name" />

        <label>subject
            <span id="subjectInfo" class="small">Add a subject</span>
        </label>
        <input type="text" name="email" id="subject" />

        <label>Email
            <span id="emailInfo" class="small">Add a valid email address</span>
        </label>
        <input type="text" name="email" id="email" />

        <label>message
            <span id="messageInfo" class="small">Your message min 20 chars</span>
        </label>
        <input type="text" name="message" id="message" />

        <button type="submit" onClick="javascript:ajax_post();">Send</button>
        <div class="spacer"></div>
        <div id="status"></div> 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T00:04:41.840

> 如果浏览器不支持javascript怎么办。有没有办法仍然发送消息？

如果您正确构建它，如果客户端中的 JavaScript 不可用，表单将正常提交数据。[渐进式增强](http://www.alistapart.com/articles/understandingprogressiveenhancement/)，应该始终是 JavaScript 的使用方式。

> 提交触发 ajax 发布功能。在进入 php 文件（客户端）之前添加 jquery 验证的最佳方法是什么

在提交之前使用[`submit`事件捕获表单数据。](http://api.jquery.com/submit/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:03:46.223

如果 JavaScript 不可用，表单将以经典方式提交。在这种情况下，您的服务器端代码需要处理并返回完整的 HTML 页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T00:05:01.263

你为什么不使用jquery？只需让`<form>`标签发送数据并在所述表单的 submit() 事件中禁用/返回 false。

# haskell - 如何在 Haskell 中使用 random-fu 和平台无关代码生成随机数？

> ID：12416480
> 
> 赞同：4
> 
> 时间：2012-09-14T00:03:07.610
> 
> 标签：haskell, random, numbers, multiplatform

我不知道如何使用`Data.Random.Source.IO`多平台方式生成随机数。

我可以在 Unix 中使用 生成随机数，`Data.Random.Source.DevRandom`在 GitHub 文档中有一个用于 Windows using 的`Data.Random.Source.MWC`示例，但没有使用示例代码`Data.Random.Source.IO`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T07:05:12.360

好的，我已将 github 示例转换为使用`Source.IO`

```
import Data.Random
import Data.Random.Source.IO

logNormal :: Double -> Double -> RVar Double
logNormal mu sigmaSq = do
    x <- normal mu sigmaSq
    return (exp x)

main = sample (logNormal 5 1) >>= print 
```

您可以在[源代码](https://github.com/mokus0/random-fu/blob/master/random-source/src/Data/Random/Source/IO.hs)中`Data.Random.Source.IO`看到它只是为`MonadRandom IO`.

您可以从列表中生成一个统一的随机数

```
import Data.Random
import Data.Random.Source.IO

main = sample (randomElement [0..9]) >>= print 
```

# mysql - Postgres 使用连接汇总 netflow 数据

> ID：12416482
> 
> 赞同：1
> 
> 时间：2012-09-14T00:03:20.733
> 
> 标签：mysql, postgresql

我让 pmacct 每小时将网络流量汇总到 postgres 数据库中。我需要编写一个脚本/查询以将不同格式的数据移动到 mysql 数据库中。我想使用 SQL 进行尽可能多的数据处理，因为这个数据集将快速增长。

我运行了一个 perl 脚本来添加一个额外的字段 (agent_id) 来跟踪数据所在的区域（本地/国家/国际），它将显示为 0、1 或 2。

我从中提取此数据的表架构中的相关字段是：

`ip_src, ip_dst, agent_id, bytes, stamp_updated, processed`

我要插入数据的架构是：

`ip, local_down_mb, nat_down_mb, int_down_mb, local_up_mb, nat_up_mb, int_up_mb, timestamp`

由于我只是在寻找源或目标是我的范围之一的流量，因此我目前有一个查询，它以我想要的方式从 postgres 数据库中获取上传数据：

```
SELECT DISTINCT ip_src, agent_id, SUM(bytes), stamp_updated FROM acct
WHERE ip_src <<= '192.168.0.0/22'
   OR ip_src <<= '10.1.2.0/24'
   OR ip_src <<= '1.2.3.4/32'
GROUP BY ip_src, agent_id, stamp_updated
ORDER BY ip_src, agent_id, stamp_updated 
```

该查询的示例输出是：

```
 ip_src     | agent_id |    sum    |    stamp_updated    
--------------+----------+-----------+---------------------
10.1.2.134    |        2 |      3192 | 2012-09-13 21:20:01
10.1.2.134    |        2 |      3192 | 2012-09-13 22:20:01
10.1.2.134    |        2 |      3192 | 2012-09-13 23:20:01
10.2.3.252    |        2 |       448 | 2012-09-11 06:00:01
10.2.3.252    |        2 |       448 | 2012-09-11 07:20:01
10.2.3.252    |        2 |       448 | 2012-09-11 08:20:01
10.2.3.252    |        2 |      8112 | 2012-09-11 09:20:01 
```

在这个阶段，我知道我可以对 ip_dst 运行相同的查询，然后在将数据以新格式重新插入 mysql 时进行一些手动过程，以确保 ip 源和目标匹配时间戳，然后使用 agent_id 和我插入的 ip 源或 ip 目的地的组合来了解它是入站还是出站，以及流量是本地、国家还是国际。

然而，我想要的是一个可以为我完成所有这些的查询。我的 SQL 知识的限制是几个月前已经阅读了 W3C 网站教程，这使我能够像上面那样编写查询，但不会更进一步。

据我所知，我需要一些帮助是在两组结果之间编写一个连接，一组用于 ip_src，另一组用于 ip_dst，然后做一些魔术来使用流量方向的信息与agent_id 具有与 mysql 数据库的模式匹配的输出。

是否有人可以（非常友好地）编写他们认为可能适用于完成此任务的查询，或者至少将我指向相关文档并让我抢先了解我可能需要使用哪些功能来完成这项工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-14T02:52:51.667

*   为了解决您对如何将 ip_src 粘合到 ip_dst 搜索的主要问题，您希望在两个查询上使用 FULL OUTER JOIN 来处理 IP 在给定时间戳中仅具有一个方向的流量的情况。如果您的数据加载器可以保证匹配数据，您可以使用 INNER JOIN，但为什么要冒险呢？
*   由于您希望将 agent_id 转换为目标架构中的 3 个单独的列，因此我展示了一种在聚合函数内部使用条件的方法。
*   我假设根据列名将最终输出中的字节数转换为四舍五入的兆字节。

    ```
     SELECT down.ip,
             ceil(down.lb/1048576) AS local_down_mb,
             ceil(down.nb/1048576) AS nat_down_mb,
             ceil(down.ib/1048576) AS int_down_mb,
             ceil(up.lb/1048576) AS local_up_mb,
             ceil(up.nb/1048576) AS nat_up_mb,
             ceil(up.ib/1048576) AS int_up_mb,
             down.timestamp
        FROM (SELECT ip_src AS ip,
                     SUM(CASE WHEN agent_id=0 THEN bytes ELSE 0 END) AS lb,
                     SUM(CASE WHEN agent_id=1 THEN bytes ELSE 0 END) AS nb,
                     SUM(CASE WHEN agent_id=2 THEN bytes ELSE 0 END) AS ib,
                     stamp_updated AS timestamp
                FROM acct
               WHERE ip_src <<= '192.168.0.0/22'
                  OR ip_src <<= '10.1.2.0/24'
                  OR ip_src <<= '1.2.3.4/32'
            GROUP BY ip,timestamp) down
        FULL OUTER JOIN
             (SELECT ip_dst AS ip,
                     SUM(CASE WHEN agent_id=0 THEN bytes ELSE 0 END) AS lb,
                     SUM(CASE WHEN agent_id=1 THEN bytes ELSE 0 END) AS nb,
                     SUM(CASE WHEN agent_id=2 THEN bytes ELSE 0 END) AS ib,
                     stamp_updated AS timestamp
                FROM acct
               WHERE ip_dst <<= '192.168.0.0/22'
                  OR ip_dst <<= '10.1.2.0/24'
                  OR ip_dst <<= '1.2.3.4/32'
            GROUP BY ip,timestamp) up
       USING (ip,timestamp)
    ORDER BY ip,timestamp; 
    ```

# jquery - 使用按钮更改 div 中的内容

> ID：12416483
> 
> 赞同：1
> 
> 时间：2012-09-14T00:03:25.243
> 
> 标签：jquery, button

我正在尝试创建三个按钮来使用 jQuery 更改 div 内的内容。

我不确定这段代码有什么问题。

```
<head>

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>

</head>

<body>
    <script type="text/javascript">
    var buttons = $("#buttons").find("a");
        $("buttons").click(function() {
           var id = $(this).attribute("id");
           $("pages id").css("display", "none");
           $("pages id:eq("+id+")").css("display", "block");
    });
    </script>​​​​

    <div id="buttons">
         <a href="#" id="0" class="mybutton myred">Div 1</a>
         <a href="#" id="1" class="mybutton myblue">Div 2</a>
         <a href="#" id="2" class="mybutton myblue">Div 3</a>
    </div>

    <div id="pages">
        <div id="1" class="mydivshow">1111</div>
        <div id="2" class="mydivhide">2222</div>
        <div id="3" class="mydivhide">3333</div>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-14T00:23:23.253

看起来你有一些需要澄清的误解。*别担心*，你显然是在正确的轨道上。

首先，您需要像这样将调用包装在 document.ready 事件中。

```
<script type="text/javascript">
$(document).ready(function() {
    var buttons = $("#buttons").find("a");
        $("buttons").click(function() {
           var id = $(this).attr("id");
           $("pages id").css("display", "none");
           $("pages id:eq("+id+")").css("display", "block");
    });
});
</script>​​​​ 
```

这样做的原因是因为您的 HTML 是按顺序呈现的，也就是说，它会逐行读取它。当您的 javascript 代码执行时，尚未呈现按钮的 HTML，因此它不知道您在说什么。另请注意，就绪事件处理程序的构造几乎与单击事件处理程序相同。您只是对不同的对象进行操作并使用不同的事件。

下一个问题是您似乎在为选择器的工作方式而苦苦挣扎。

```
var buttons = $("#buttons").find("a"); 
```

您实际上在这里使用*了两个*选择器。$() 和 .find() 做几乎完全相同的事情。然而，jQuery 对象选择器用于查询整个文档，而 find 用于查询子集。因此，对于您要尝试执行的操作，这将更合适：

```
var buttons = $("a"); 
```

这只是说“选择所有锚标签”。When a selector does not start with a special character it is simply looking for tags of that type. # 字符查询所有具有 id 和 . character 查询该类的所有元素。因此，您的第一条语句实际上是在查询 ID 为“buttons”且不存在的任何元素。

最后，你不需要为你想要做的事情创建一个 var ，为了简单起见，我们将摆脱那条线并继续点击处理程序。

```
<script type="text/javascript">
$(document).ready(function() {
    $("a").click(function() {
       var id = $(this).attribute("id");
       $("pages id").css("display", "none");
       $("pages id:eq("+id+")").css("display", "block");
    });
});
</script>​​​​ 
```

下一个问题是您将 ID 属性用作数据字段。不要这样做。如果您需要在其标签中存储有关元素的信息，请使用以前缀“data-”开头的自定义属性。所以在这种情况下，让我们改变你的锚标签。

```
<div id="buttons">
     <a href="#" data-id="0" class="mybutton myred">Div 1</a>
     <a href="#" data-id="1" class="mybutton myblue">Div 2</a>
     <a href="#" data-id="2" class="mybutton myblue">Div 3</a>
</div> 
```

这样好一点。现在我们在 div 上遇到了同样的问题。我们可以做同样的事情，但是因为我们要查询这些信息并且在类上使用选择器要容易得多，所以我们只根据 id 给 div 类。

```
<div id="pages">
    <div class="mydivshow div1">1111</div>
    <div class="mydivhide div2">2222</div>
    <div class="mydivhide div3">3333</div>
</div> 
```

现在我们可以回到 jQuery 并更改代码。

```
<script type="text/javascript">
$(document).ready(function() {
    $("a").click(function() {
       var id = $(this).attribute("data-id"); // Using a custom attribute.
       $("#pages div").hide(); // gather all the div tags under the element with the id pages and hide them.
       $(".div" + id).show(); // Show the div with the class of .divX where X is the number stored in the data-id of the object that was clicked.
    });
});
</script>​​​​ 
```

那应该这样做！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-14T00:04:58.510

您的代码中有多个错误，修改后的版本如下：

演示：http: [//jsfiddle.net/SO_AMK/BcFVv/](http://jsfiddle.net/SO_AMK/BcFVv/)

jQuery：

```
$("#buttons a").click(function() {
    var id = $(this).attr("id");
    $("#pages div").css("display", "none");
    $("#pages div#" + id + "").css("display", "block");
});​ 
```

HTML：

```
<div id="buttons">
    <a href="#" id="1" class="mybutton myred">Div 1</a>
    <a href="#" id="2" class="mybutton myblue">Div 2</a>
    <a href="#" id="3" class="mybutton myblue">Div 3</a>
</div>
<div id="pages">
    <div id="1" class="mydivshow">1111</div>
    <div id="2" class="mydivhide">2222</div>
    <div id="3" class="mydivhide">3333</div>
</div> 
```

​</p>

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-14T00:04:11.773

您需要将代码包装在 document.ready 函数中。而且没有属性函数这种东西，就是attr()。此外，您正在选择一个 Id 的页面，您需要 # 符号和它引用 div 之后的 Id，但您需要这样说，否则 jquery 将寻找一个名为 id 的 HTML 元素，该元素不存在。

您可能还想利用 jquery 的隐藏/显示功能而不是所有的 css 代码

在这里查看工作[小提琴](http://jsfiddle.net/2YYgb/2/)

```
 var buttons = $("#buttons a");

    buttons.click(function(){
            var id = $(this).attr("id");
                $("#pages div").hide();
                $("#pages div:eq("+id+")").show();
        }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-14T00:05:19.773

你在打电话`$("buttons")`- 那是试图找到一个名为`<buttons>`当然不存在的标签。您已经预先计算了链接数组，因此您只需要调用：

```
buttons.click(function() { ... 
```

# java - 使用 fql 的 Facebook 事件

> ID：12416487
> 
> 赞同：0
> 
> 时间：2012-09-14T00:03:55.503
> 
> 标签：java, facebook, facebook-graph-api, facebook-fql

这是此问题的扩展： [Getting Facebook Events using fql](https://stackoverflow.com/questions/10902259/getting-facebook-events-using-fql)

当没有为活动设置位置/地点时，我遇到了问题。

这是我正在使用的查询：

```
{\"events\":
    \"SELECT eid, name,description, start_time, end_time, pic_small,pic_big, eid,venue,location 
      from event WHERE eid in (SELECT eid FROM event_member WHERE uid = me() 
      and start_time > %s)\" ,
 \"locations\":
     \"select page_id,location from page where page_id IN 
     (select venue.id from #events)\" ,
  \"rsvpStatus\":
     \"select eid, rsvp_status from event_member where eid IN 
      (select eid from #events) AND uid = me()\" } 
```

我的观察：当为此事件设置了位置时，场地属性是一个带有 id 属性的 json 对象。请参考下面的json

```
 {
          "eid": 34343434322,
          "name": "Another yo you",
          "description": "",
          "start_time": 1347699600,
          "end_time": 1347786000,
          "pic_small": "http:\/\/profile.ak.fbcdn.net\/static-ak\/rsrc.php\/v2\/yy\/r\/XcB-JGXohjk.png",
          "pic_big": "http:\/\/profile.ak.fbcdn.net\/static-ak\/rsrc.php\/v2\/yn\/r\/5uwzdFmIMKQ.png",
          "venue": {
            "id": 34243242
          },
          "location": "Airbiquity"
        } 
```

当没有设置位置时，它是一个空数组。请参考下面的json。

```
{
          "eid": 441320552577649,
          "name": "Meeting",
          "description": "",
          "start_time": 1347491700,
          "end_time": 1347502500,
          "pic_small": "http:\/\/profile.ak.fbcdn.net\/static-ak\/rsrc.php\/v2\/yy\/r\/XcB-JGXohjk.png",
          "pic_big": "http:\/\/profile.ak.fbcdn.net\/static-ak\/rsrc.php\/v2\/yn\/r\/5uwzdFmIMKQ.png",
          "venue": [

          ],
          "location": null
        } 
```

场地属性的类型发生了变化，这很奇怪。我是 GSON 来将此响应转换为 Java 对象，但由于场地结构出乎意料，它被抛出。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T01:23:53.407

Facebook 对场地的处理方式在去年 5 月发生了变化。API 返回了几种不同的情况，具体取决于创建事件的时间和方式。

1.  返回已知场所的 id。
2.  场地字段为空白，并返回任意位置字符串。
3.  Venue 包含有关活动地点的一系列信息，但没有 id。

不幸的是，您的脚本必须处理所有这些情况，并为 Facebook 工程师将来可能提出的任何情况做好准备。

# javascript - 在节点项目中需要 d3 会导致 jsdom 错误

> ID：12416500
> 
> 赞同：0
> 
> 时间：2012-09-14T00:06:25.460
> 
> 标签：javascript, node.js, d3.js, npm, jsdom

我真的很困惑这里发生了什么。在 d3 2.10.1 中，`require 'd3'`调用会在 d3 的这一行中生成关于 jsdom 的错误`index.js`：

```
document = require("jsdom").jsdom("<html><head></head><body></body></html>"); 
```

jsdom 位于 npm install 的 d3 的 node_modules 文件夹中。但是，即使我将 jsdom 直接安装为 package.json/slug.json 中的依赖项，我也会收到相同的错误。当需要 d3 时，问题如下：

```
Uncaught module jsdom not found 
```

旧版本的 d3 (2.8.1) 也会发生这种情况。我在 Spine/hem/npm 应用程序中使用 d3，但不知道是什么原因造成的。现在，我只需要 d3.v2.min.js 脚本，但这只是一个临时的 hack。

希望各位节点勇士能帮帮我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T18:08:08.400

这似乎可以通过执行以下操作来解决：

```
require 'd3/d3.v2' 
```

显然，正常`require 'd3'`（获取 index.js）用于服务器端非浏览器使用，因此如果您使用 npm 编写客户端应用程序，则需要上述内容。

# sql - 当所有值也是一个选项时的 Delphi 查询参数用法

> ID：12416503
> 
> 赞同：2
> 
> 时间：2012-09-14T00:07:07.770
> 
> 标签：sql, delphi, delphi-7, firebird

我有一个 tquery（通过 BDE 或 BDE 仿真组件），用于选择单个记录或所有记录。

传统上，这是这样做的：

```
select * from clients where (clientid = :clientid or :clientid = -1) 
```

然后，当他们希望查询返回所有值时，他们会在字段中输入 -1。不过，通过这段代码，我发现当他们这样做时，查询不会对表使用正确的索引，而只会进行自然读取。

是否有实现此目标的最佳实践方法？也许是一种告诉参数返回所有值的方法，或者必须修改脚本以在需要所有值时完全删除 where 子句？

编辑：顺便说一句，这是 Delphi 7（与 Firebird 1.5 相悖，很抱歉漏掉了）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T05:30:20.993

当您使用已弃用的 BDE 时，这可能是从 BDE 迁移到 3d 方解决方案的另一个原因。AnyDAC（UniDAC，可能还有其他人。大多数是商业库）具有宏，允许根据宏值动态更改 SQL 命令文本。因此，您的查询可能会写成：

```
ADQuery1.SQL.Text := 'select * from clients {IF &clientid} where clientid = &clientid {FI}';

if clientid >= 0 then
  // to get a single record
  ADQuery1.Macros[0].AsInteger := clientid
else
  // to get all records
  ADQuery1.Macros[0].Clear;

ADQuery1.Open; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:50:21.777

最好使用两个查询：

```
if (clientid <> -1) then
begin
  DBComp.SQL.Text := 'select * from clients where (clientid = :clientid)';
  DBComp.ParamByName('clientid').Value := clientid;
end else
begin
  DBComp.SQL.Text := 'select * from clients';
end;
DBComp.Open;
... 
```

或者：

```
DBComp.SQL.BeginUpdate;
try
  DBComp.SQL.Clear;
  DBComp.SQL.Add('select * from clients');
  if (clientid <> -1) then
    DBComp.SQL.Add('where (clientid = :clientid)');
finally
  DBComp.SQL.EndUpdate;
end;

if (clientid <> -1) then
  DBComp.ParamByName('clientid').Value := clientid;

DBComp.Open;
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T13:06:05.023

我会用这个：

```
SELECT * FROM CLIENTS WHERE clientid = :clientid or :clientid IS NULL 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T06:27:01.830

对于带有“可选”参数的查询，我总是使用 ISNULL（MSSQL 或 NVL Oracle），即。

```
SELECT * FROM clients WHERE ISNULL(:clientid, clientid) = clientid 
```

将参数设置为`NULL`然后选择所有记录。您还必须注意表字段中的 NULL 值，因为`NULL <> NULL`. 您可以通过稍作修改来克服这一点：

```
SELECT * FROM clients WHERE COALESCE(:clientid, clientid, -1) = ISNULL(clientid, -1) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-17T06:15:44.047

Remy 的答案可能会重新表述为单个查询。*如果您准备*一次然后重新打开多次，这可能会更好。

```
select * from clients where (clientid = :clientid)
                        and (:clientid is not null)
  UNION ALL
select * from clients where (:clientid is null) 
```

这只是将两个不同的查询（具有相同的结果向量）聚合在一起。条件只是关闭其中一个。使用会是这样的：

```
 DBComp.Prepare.
   ...
 DBComp.Close;
 DBComp.ParamByName('clientid').Value := clientid;
 DBComp.Open;
   ...
 DBComp.Close;
 DBComp.ParamByName('clientid').Clear;
 DBComp.Open; 
```

但是，此查询将依赖 SQL Server*优化器*功能来提取查询不变量*（：clientid 为 [not] null）*并完全启用/禁用查询。但是，您的原始查询也取决于此。

* * *

为什么仍然使用过时的 FB 1.5 ？FB 2.5.2 在那里工作不会更好吗？我认为您的原始查询表述不佳。

```
 select * from clients where (:clientid = -1) or  ((clientid = :clientid) and (:clientid <> -1)) 
```

在 SQL Server 优化器上可能会更容易。但我认为 FB 可以在那里做得更好。稍后尝试下载 FB，并使用 IBExpert 或 FlameRobin 等 IDE 在其中运行您的查询。重新排列括号并将 -1 更改为 NULL 是显而易见的尝试。

* * *

现在使用 BDE 很脆弱。它不是很快，限制了数据类型和连接性（例如没有 FB/IB 事件）。并且会出现与 Vista/Win7 和 Win64 的各种兼容性问题。如果 FB/IB 是您选择的服务器，请考虑切换到一些现代组件集：

*   (FLOSS) [http://uib.sf.net的 Universal Interbase (RIP](http://uib.sf.net) [http://Progdigy.com](http://Progdigy.com)的所有 Delphi 页面)
*   (FLOSS) ZeosLib DBO 来自[http://zeos.firmos.at/](http://zeos.firmos.at/)
*   (propr) FIB+ by [http://DevRace.com](http://DevRace.com)
*   (propr) IB Objects by [http://IBobjects.com](http://IBobjects.com)
*   *(propr) [http://da-soft.com](http://da-soft.com)*的 AnyDAC - 已售罄给 Embarcadero，不适用于 D7
*   (propr) IB-DAC/UniDAC [http://DevArt.com](http://DevArt.com)

* * *

显示表格和索引的定义以及这些索引的选择性也是一件好事。

# c - 如何在C中的32位int中找到最左边的1

> ID：12416505
> 
> 赞同：4
> 
> 时间：2012-09-14T00:07:15.973
> 
> 标签：c, bitwise-operators, bitmask

> **可能的重复：**
> [查找 C 中的最高位](https://stackoverflow.com/questions/53161/find-the-highest-order-bit-in-c)

如何编写一个 C 函数来生成一个掩码，`1`指示`x`.

例如：`0xFF00 -> 0x8000`和`0x6600 -> 0x4000`。至今：

```
int left1(unsigned x){} 
```

我明白，`0xFF00 == 1111 1111 0000 0000..` 但`0x6600 == 0110 0110 0000 0000..`在那之后我很难过。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-14T00:26:30.270

您可以分两部分执行此操作：首先，使用一种称为“位涂抹”的技术来确保第一个 1 右侧的所有位也是 1：

```
x |= x >> 16;
x |= x >> 8;
x |= x >> 4;
x |= x >> 2;
x |= x >> 1; 
```

此时， 的输入`0xFF00`将`x`等于`0xFFFF`， 的输入`0x6600`将`x`等于`0x7FFF`。然后，我们可以使用以下方法仅保留最高`1`集：

```
x ^= x >> 1; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T00:13:52.840

计算向右移位直到达到 1 所需的次数，然后将该 1 向左移位相同的计数。

```
int ct=0;
while (x > 1) { ct++; x = x >> 1; }
x = x << ct; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T00:18:02.427

一种方法是创建一个位掩码，然后右移该值。

也就是说，创建一个位掩码，使您的整数为“1000 ....”或“0 ...” - 取决于第一位是 0 还是 1。

然后取那个整数并右移它，直到它变成最低有效位，而不是最高有效位。例如，`0b10000000 >> 8`是 1。

因此，首先，根据整数的大小，您必须进行移位，不管多少位都是相关的。

然后你必须创建位掩码。让我们取一个 1 字节的整数：

`unsigned int i = 1 << 8`将创建一个整数 i，其最高有效位为 1。

或者你可以使用十六进制。你已经知道`0xFF`==了`11111111`。您实际上可以进一步分解它：`0xF0`==`11110000`

因为`0xF`==`1111`是二进制的，好吧，我们将做相反的事情。`1000`二进制是什么，十六进制？`1000`在二进制中是数字`8`，它也恰好等于`0x8`

因此，对于单个字节，最左边位的掩码是`0x80`.

现在！将此应用于 32 位！

祝你好运！

# dart - Dart中“var”和“dynamic”类型的区别？

> ID：12416507
> 
> 赞同：98
> 
> 时间：2012-09-14T00:08:24.170
> 
> 标签：dart

根据[这篇文章](http://news.dartlang.org/2012/09/breaking-change-remove-dynamic-from.html#comment-form)：

> 您可能知道，`dynamic`（现在称为）是未提供静态类型注释时的替代类型。

那么，`dynamic`和 和有什么不一样`var`？什么时候使用？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2012-09-14T01:07:49.347

`dynamic`是所有 Dart 对象的基础类型。在大多数情况下，您不需要显式使用它。

`var`是一个关键字，意思是“我不关心这里的类型是什么”。Dart 会将`var`关键字替换为初始值设定项类型，`dynamic`如果没有初始值设定项，则默认保留。

`var`如果您希望变量赋值在其生命周期内发生变化，请使用：

```
var msg = "Hello world.";
msg = "Hello world again."; 
```

`final`如果您希望变量赋值在其生命周期内保持不变，请使用：

```
final msg = "Hello world."; 
```

使用`final`（自由地）将帮助您捕获在您无意更改变量分配的情况下。

`final`请注意，`const`当涉及到对象时， 它们之间有很好的区别。`final`不一定使对象本身不可变，而`const`：

```
// can add/remove from this list, but cannot assign a new list to fruit.
final fruit = ["apple", "pear", "orange"];
fruit.add("grape");

// cannot mutate the list or assign a new list to cars.
final cars = const ["Honda", "Toyota", "Ford"];

// const requires a constant assignment, whereas final will accept both:
const names = const ["John", "Jane", "Jack"]; 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2018-10-26T11:30:08.990

[在DartPad](https://dartpad.dartlang.org/)中试试这个：

```
void main() {
  dynamic x = 'hal';
  x = 123;
  print(x);
  var a = 'hal';
  a = 123;
  print(a);
} 
```

您可以更改 x 的类型，但不能更改 a。

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2020-02-02T14:44:02.220

**动态：** *可以改变*变量的类型，&*可以*在后面的代码中改变变量的值。

**var：** *不能改变*变量的类型，但*可以*在后面的代码中改变变量的值。

**final：** *不能改变*变量的类型，&*不能*在后面的代码中改变变量的值。

```
dynamic v = 123;   // v is of type int.
v = 456;           // changing value of v from 123 to 456.
v = 'abc';         // changing type of v from int to String.

var v = 123;       // v is of type int.
v = 456;           // changing value of v from 123 to 456.
v = 'abc';         // ERROR: can't change type of v from int to String.

final v = 123;       // v is of type int.
v = 456;           // ERROR: can't change value of v from 123 to 456.
v = 'abc';         // ERROR: can't change type of v from int to String. 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-09-14T04:13:37.647

`var`, 像`final`, 用于声明一个变量。它根本**不是**一种类型。

Dart 足够聪明，可以在大多数情况下知道确切的类型。例如，以下两个语句是等价的：

```
String a = "abc"; // type of variable is String
var a = "abc";    // a simple and equivalent (and also recommended) way
                  // to declare a variable for string types 
```

另一方面，`dynamic`它是一种特殊类型，表明它可以是任何类型（又名类）。例如，通过将对象强制转换为`dynamic`，您可以调用任何方法（假设有一个）。

```
(foo as dynamic).whatever(); //valid. compiler won't check if whatever() exists
(foo as var).whatever(); //illegal. var is not a type 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2019-02-04T18:09:58.650

```
var a ;
a = 123;
print(a is int);
print(a);
a = 'hal';
print(a is String); 
```

当没有初始值定义时， var 是动态的

```
var b = 321;
print(b is int);
print(b);
//b = 'hal'; //error
print(b is String); 
```

当用初始值定义时，在这种情况下 var 是 int 。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-11-29T15:04:59.700

为了澄清以前的一些答案，当您将变量声明为 时`dynamic`，它的类型会根据您分配给它的内容而变化。当您声明 a`var`时，一旦分配了某些类型，就会设置类型，之后就无法更改。

例如，下面的代码：

```
dynamic foo = 'foo';
print('foo is ${foo.runtimeType} ($foo)');
foo = 123;
print('foo is ${foo.runtimeType} ($foo)'); 
```

在 DartPad 中运行时将返回以下结果：

```
foo is String (foo)
foo is int (123) 
```

但以下代码甚至无法编译：

```
var bar = 'bar';
print('bar is ${bar.runtimeType} ($bar)');
bar = 123; // <-- Won't compile, because bar is a String
print('bar is ${bar.runtimeType} ($bar)'); 
```

长话短说 -`dynamic`如果您想要一个非类型变量，请使用`var`，当您想要一个类型变量时使用您分配给它的任何类型。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2021-04-30T19:11:58.960

查看以前的答案，我希望这可以澄清/总结一切：

有**关键字**var、final 和 const。这些是声明一个变量（以表明它的存在）*（旁注：[声明与初始化](https://www.quora.com/What-is-the-difference-between-variable-declaration-vs-initialization#:%7E:text=initialization%20is%20a%20short%20name%20for%20%E2%80%9Cdeclaring%20and%20assigning%20a%20value%20in%20the%20same%20line%E2%80%9D.)）*

然后是String，int，List，dynamic等类型（类型表示变量应该持有什么样的值，这是为了**类型**[安全](https://dart.dev/guides/language/type-system#:%7E:text=type%20safe%3A%20it%20uses%20a%20combination%20of%20static%20type%20checking%20and%20runtime%20checks%20to%20ensure%20that%20a%20variable%E2%80%99s%20value%20always%20matches%20the%20variable%E2%80%99s%20static%20type)）

通常，我们通过显式声明其类型来声明变量：

```
String a; // a is now a String type
int b; // b is now an int type 
```

但是我们也可以使用 var 关键字。默认情况下，这会将变量的类型设置为初始化时使用的任何类型。*（这称为[类型推断](https://dart.dev/guides/language/type-system#type-inference)）*

```
var a = "hello"; // a is now a String type
var b = 5; // b is now an int type 
```

现在，当您尝试使用 var 关键字声明变量但不初始化值时会发生什么？它应该如何推断类型？嗯，还有一种叫做动态的类型。这与通常的 String 或 int 不同，因为它允许为变量分配任何类型的值（通常会出现错误）。

```
String a = "hello"; // a is now a String type
// var a = "hello"; // Alternative way; same as the line above because its type is inferred to be String
a = 5 // error: A value of type 'int' can't be assigned to a variable of type 'String'

dynamic b; // b is now a dynamic type
b = "hello"; // still a dynamic type, but now its value is of type String  (You can use b.runtimeType to check)
b = 5; // dynamic type, but now its value is of type int 
```

因此，为了解决对文章引用的原始混淆，

> 您可能知道，动态（现在称为）是未提供静态类型注释时的替代类型。

这只是意味着，如果你没有明确声明它的类型（你使用 var 声明一个变量）并且在没有初始化的情况下这样做，它只是将它的类型推断为动态的：

```
var b; // b is now a dynamic type, the following will not have any errors.
b = "hello";
b = 5; 
b = true; 
```

* * *

其他注意事项：

*   不知道为什么人们开始谈论 final 和 const，但如果你想了解更多，我认为[这里接受的答案很好地解释了它。](https://stackoverflow.com/questions/50431055/what-is-the-difference-between-the-const-and-final-keywords-in-dart)

*   `dynamic a;`并且`var a;`实际上是相同的：它们都声明了一个动态类型的变量。

*   检查变量类型的两种方法是[使用 is 运算符](https://dart.dev/guides/language/language-tour#:%7E:text=true%20if%20the%20object%20has%20the%20specified%20type)和使用`.runtimeType`不同的工作方式。请参见以下示例：

    ```
    dynamic b; // b is now a dynamic type, no value
    print(b is dynamic); // true
    print(b is Null); // true
    print(b is String); // false
    print(b is int); // false
    print(b.runtimeType); // Null

    b = "hello"; // dynamic type, String value
    print(b is dynamic); // true
    print(b is Null); // false
    print(b is String); // true
    print(b is int); // false
    print(b.runtimeType); // String

    b = 5; // dynamic type, int value
    print(b is dynamic); // true
    print(b is Null); // false
    print(b is String); // false
    print(b is int); // true
    print(b.runtimeType); // int 
    ```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-05-19T12:26:41.580

在比较**动态与 var**时可以考虑的方面之一是考虑使用 var 声明和初始化时的行为，同时在动态的情况下不可能更改类型。

但是动态 vs var 不是我要问的问题。**我会问更多dynamic 与 Object**之间的区别。

这是一个[使用 Object 而不是 dynamic 的 DO 注释，表示允许任何对象。](https://dart.dev/guides/language/effective-dart/design#do-annotate-with-object-instead-of-dynamic-to-indicate-any-object-is-allowed)

一开始很难感觉到它，但是动态的我会与泛型类型参数有关。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2020-08-06T05:59:57.050

在dynamic和var中，变量可以保存任何数据类型的数据，即int、float、string等

如果一个变量被声明为动态变量并且即使被初始化，它的类型也会随着时间而改变。在[https://dartpad.dev/中试试这个代码](https://dartpad.dev/)

```
void main() {
  dynamic x = 'abc';
  x = 12345;
  print(x);

} 
```

如果将变量声明为 var，则一旦分配类型就不能更改。

```
void main() {
  var x = 'abc';
  x = 12345;
  print(x);
} 
```

上面的代码将导致错误，指出“int”类型的值不能分配给“String”类型的变量 - 第 3 行

但是，如果你在没有初始化的情况下声明一个 var，它就会变成一个动态的：

```
void main() {
  var x ;
  x = 'abc';
  x=12345;
  print(x);
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-04-24T05:02:19.020

一个`dynamic`变量可以改变他的类型，而一个`var`类型不能改变。

例如 ：

```
var myVar = 'hello';
dynamic myDynamicVar = 'hello';
myVar = 123; // not possible
myDynamicVar = 123; // possible 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-08-15T12:47:02.467

dynamic 是一种数据类型，表示 dart 中的所有数据类型

var 是一种类似于“final”的变量声明方式，它采用其值的数据类型

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-09-28T06:55:15.183

如果使用 var，则无法更改变量的数据类型。但是如果你使用动态，你可以自由地改变它。例如。

```
dynamic x = 12; // type: integer
x= "Hello world"; // type: string 
```

如果您使用 var 而不是 dynamic 执行相同操作，这将毫无问题，您将收到错误，因为您无法更改数据类型，因为它在初始化时会自动分配给变量。

# javascript - nvd3 piechart.js - 如何编辑工具提示？

> ID：12416508
> 
> 赞同：40
> 
> 时间：2012-09-14T00:08:31.817
> 
> 标签：javascript, tooltip, d3.js, pie-chart, nvd3.js

我正在使用 nvd3 的 piechart.js 组件在我的网站上生成饼图。提供的 .js 文件包括几个 var，如下：

```
var margin = {top: 30, right: 20, bottom: 20, left: 20}
    , width = null
    , height = null
    , showLegend = true
    , color = nv.utils.defaultColor()
    , tooltips = true
    , tooltip = function(key, y, e, graph) {
        return '<h3>' + key + '</h3>' +
               '<p>' +  y + '</p>'
      }
    , noData = "No Data Available."
    , dispatch = d3.dispatch('tooltipShow', 'tooltipHide')
; 
```

在我的内联 js 中，我已经能够覆盖其中的一些变量，例如（覆盖 showLegend 和 margin）：

```
var chart = nv.models.pieChart()
    .x(function(d) { return d.label })
    .y(function(d) { return d.value })
    .showLabels(false)
    .showLegend(false)
    .margin({top: 10, right: 0, bottom: 0, left: 0})
    .donut(true); 
```

我试过以同样的方式覆盖工具提示：

```
.tooltip(function(key, y, e, graph) { return 'Some String' }) 
```

但是当我这样做时，我的饼图根本不显示。为什么我不能在这里覆盖工具提示？我还有其他方法可以这样做吗？我真的宁愿根本不必编辑 piechart.js 本身；我需要保持该文件通用，以便在多个小部件中使用。

当我们这样做的时候，有什么方法可以让整个工具提示变成一个可点击的链接？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-11-23T11:25:43.500

只需以这种方式覆盖它肯定会起作用

```
function tooltipContent(key, y, e, graph) {
            return '<h3>' + key + '</h3>' +'<p>' + y + '</p>' ;
        } 
```

或者

```
tooltipContent(function(key, y, e, graph) { return 'Some String' }) 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2015-09-10T10:29:27.470

我刚刚遇到了同样的问题，使用 nvd3 1.8.1，这是我找到的解决方案。

如果没有该选项`useInteractiveGuideline`，您可以简单地在以下位置声明您的工具提示生成函数`chart.tooltip.contentGenerator(function (d){ YOUR_FUNCTION_HERE})`：

该参数`d`由 nvd3 在调用工具提示时给出，它具有三个属性：

*   `value`: 光标位置的 x 轴值
*   `index``datum`: 图表中与光标位置对应的索引
*   `series`：一个数组，包含图表中的每个项目：
    *   `key`：该项目的图例键
    *   `value`: 该项目在光标位置的 y 轴值
    *   `color`：该项目的图例颜色

所以这里有一个例子：

```
chart.tooltip.contentGenerator(function (d) {
          var html = "<h2>"+d.value+"</h2> <ul>";

          d.series.forEach(function(elem){
            html += "<li><h3 style='color:"+elem.color+"'>"
                    +elem.key+"</h3> : <b>"+elem.value+"</b></li>";
          })
          html += "</ul>"
          return html;
        }) 
```

**重要的提示**

使用该选项时`useInteractiveGuideline`，该`chart.tooltip`对象不用于生成工具提示，您必须改为使用`chart.interactiveLayer.tooltip`，即：

```
this.chart.interactiveLayer.tooltip.contentGenerator(function (d) { ... }) 
```

我希望答案对你有用，即使迟到了。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-03-11T06:22:24.260

自定义工具提示不能与“useInteractiveGuideline”一起存在。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-06-23T07:41:41.557

如果您碰巧使用[Angular NVD3](http://krispo.github.io/angular-nvd3/#/)包装器，设置自定义消息的方法是通过图表选项，简单地说：

```
$scope.options = {
  chart: {
  ...
  tooltip: {
      contentGenerator: function(d) {
          return d.series[0].key + ' ' + d.series[0].value;
      }
  },
  ...
  }
}; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-05-26T06:16:05.053

要添加到以前的答案，有时您想使用系列的数据而不仅仅是`x`和`y`。例如当

```
data = {'values': [{'month': 1, 'count': 2}, ...], 'key': 'test' } 
```

对于这些情况，使用

```
.tooltip(function(key, x, y, e, graph) {
         var d = e.series.values[e.pointIndex];
         return '<h3>' + e.series.key + '</h3><p>' + d.month.toString() + ...;
 }); 
```

`e.series`是鼠标悬停的特定系列，是`e.pointIndex`系列值的索引。在这里`e.series.key == key`，可是我用来感同身受的是什么`e.series`。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-03-08T03:52:44.183

```
my_chart = nv.models.multiBarChart()
  .tooltip(function(key, x, y, e, graph) {
    return '<h3>' + key + '</h3>' +
           '<p>' +  y + ' on ' + x + '</p>';
  }); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-09-17T19:26:07.833

我认为您在工具提示功能中缺少“x”参数。函数调用的格式为：

```
function(key, x, y, e, graph) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-05-23T15:20:51.900

```
var chart = nv.models.multiBarChart();

chart.tooltip.contentGenerator(function (obj) {
                return JSON.stringify("<b>HOHO</b>")
            }) 
```

这对我有用...

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2017-01-05T03:56:18.663

```
chart:{
interactive:true,
tooltips: true,
tooltip: {
  contentGenerator: function (d) {
    return '<h3>PUT YOUR DATA HERE E.g. d.data.name</h3>'
  }
}
```

谢谢你和最好的问候 Abhay Patidar

# postgresql - Postgres sql查询困难连接

> ID：12416515
> 
> 赞同：0
> 
> 时间：2012-09-14T00:09:19.253
> 
> 标签：postgresql, tuples

这是我的表：

```
Table A which has entries with "item" and "grade" fields
Table B which has entries with A.id
Tuple table B-C 
```

我想要所有具有 item= "x" 和 Grade = "y" 的 A 条目以及与 B 条目相关联的所有 C 条目，该条目与具有 item = "x" 和grade = "y" 的 A 条目相关联"

例如

```
A table:

    A.item = "x", A.Grade = "y", A.id = 1
    A.item = "x", A.Grade = "y", A.id = 2
    A.item = "x", A.Grade = "y", A.id = 3
    A.item = "r", A.Grade = "z", A.id = 4

B Table

   B.AID = 1, B.id = 10
   B.AID = 1, B.id = 11
   B.AID = 2, B.id = 13
   B.AID = 3, B.id = 14
   B.AID = 4, B.id = 15

B-C Tuple Table

   BID = 10, CID = 20
   BID = 11, CID = 20
   BID = 13, CID = 20
   BID = 15, CID = 21 
```

该查询应返回 A 表中的所有条目以及 C 表中的条目 20 但不返回 21，因为 C.id = 21 仅与与不满足项目和等级要求的 A 关联的 B 进行元组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:40:02.117

这些关联，虽然书面形式听起来很复杂，但只是三个表之间的简单连接： `a`joins to `b`joins to `c`。

您确定需要如何连接列：“与 A 条目相关联的 B 条目”，并且查看列听起来像是您想要加入的`b.aid = a.id`。同样对于`b`和`c`。

```
SELECT ...
FROM
    a
    JOIN b ON b.aid = a.id
    JOIN b_c ON b_c.bid = b.id
WHERE
    ... 
```

这在将原始数据集拆分为三个规范化表之前构建了原始数据集。

下一步是按给定条件过滤。您只需要 " item = "x" 和 Grade = "y"" 的行，因此将这些行添加到 WHERE 子句中，并在它们前面加上表名，在这种情况下是可选的）：

```
WHERE
    a.item = 'x'
    AND a.grade = 'y' 
```

最后，您可以在 SELECT 子句中选择您真正需要的列。我猜`SELECT b_c.cid`会做。虽然如果您还有一个`c`表，您可能也想加入该表，并从中选择列。

# css - 混合模式内容 - 如何从 h1 中选择文本但不包括其子元素的文本？

> ID：12416516
> 
> 赞同：3
> 
> 时间：2012-09-14T00:09:27.447
> 
> 标签：css, ruby, xpath, css-selectors

我无法从`<h1>`元素打印简单文本：

```
require 'nokogiri'

doc = Nokogiri::HTML("<h1><em>Name</em>A Johnson </h1>")
puts doc.at_xpath("//h1").content 
```

它输出：

```
NameA Johnson 
```

我只想`A Johnson`在输出中。是否可以使用 XPath 或 CSS 选择器仅选择此文本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T00:16:38.820

使用`text()`XPath 函数怎么样？像这样（虽然未经测试）：

```
require 'nokogiri'

doc = Nokogiri::HTML("<h1><em>Name</em>A Johnson </h1>")
puts doc.at_xpath("//h1/text()").content 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T00:57:21.093

这些解决方案可能只是故事的一部分。考虑：

```
doc = Nokogiri::HTML("<h1><em>Name</em>A <br>Johnson </h1>")
puts doc.at_xpath("//h1/text()").content

=> A

puts doc.at('h1').children.last.text

=> Johnson 
```

或我的建议：

```
puts doc.search("h1/text()").text

=> A Johnson 
```

# javascript - 如何在没有 iframe 的情况下创建新的窗口对象？

> ID：12416517
> 
> 赞同：7
> 
> 时间：2012-09-14T00:09:28.510
> 
> 标签：javascript

如何制作一个独立于（因此修改例如不影响）的新`Window`对象，**而不**创建？`myWindow``window``myWindow.Array.prototype``window.Array.prototype`**`<iframe>`**

 **目前我正在做如下

```
function newWindow(){
    var myFrame = document.createElement('iframe'), myWindow = undefined;
    myFrame.style.display = 'none';
    myFrame.src = 'javascript:undefined;';
    document.body.appendChild(myFrame);
    myWindow = myFrame.contentWindow;
    document.body.removeChild(myFrame);
    return myWindow;
} 
```

最终，我想制作我自己的核心对象类型的副本并将它们原型化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T00:14:03.403

嗯……你不能那样做。嗯...你可以打电话`window.open`，但它会打开一个新窗口。还有……你为什么需要那个？看起来你走错路了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:21:45.227

根据您所做的事情，更好的方法可能是创建一个普通数组，然后使用您需要的功能扩充该特定数组实例。

```
function augmentArray(a) {
  a.purgeAll = function() {a.length = 0;};
}

var myList = [1, 2, 3];
augmentArray(myList);
myList.purgeAll(); 
```**

# linux - 使用 systemtap 编译 erlang 但需要 dtrace

> ID：12416518
> 
> 赞同：1
> 
> 时间：2012-09-14T00:09:37.243
> 
> 标签：linux, erlang, dtrace, systemtap

我正在从源代码编译 erlang otp，如下所示：

```
./configure --with-dynamic-trace=systemtap 
```

但它报告错误：

```
checking for dtrace... no
configure: error: No dtrace utility found. 
```

我认为 systemtap 是用于 linux 的，它与 dtrace 不同，对吗？

* * *

安装[dtrace](ftp://crisp.dyndns-server.com/pub/release/website/dtrace)后现在的错误是：

```
dtrace: failed to compile script emulator/beam/erlang_dtrace.d: Preprocessor not found
configure: error: Could not precompile erlang_dtrace.d: dtrace -h failed
configure: error: /root/otp/erts/configure failed for erts 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T16:10:41.023

您使用的是哪个发行版？我会忘记使用 DTRACE，它会比 Systemtap 更难工作（至少对我来说是这样）。我正在使用 Systemtap，它运行良好。

如果您不使用 Fedora/RH，您应该使用 UTRACE 修补您的内核或使用启用了 UPBOBES 的 >= 3.5 的内核。

要验证您的内核是否启用了 UTRACE/UPROBE，请运行以下命令：

```
grep UTRACE /boot/config-$(uname -r) 
```

或者

```
grep PROBES /boot/config-$(uname -r) 
```

例如，在我的机器上（带有 Mainline 内核 3.5 的 Ubuntu 12.04）：

```
$ grep UTRACE /boot/config-$(uname -r)
$
$ grep UPROBES /boot/config-$(uname -r)
CONFIG_ARCH_SUPPORTS_UPROBES=y
CONFIG_UPROBES=y 
```

您还应该安装 systemtap。Ubuntu（我的情况）附带的版本很旧，所以我从源代码编译它（传统的配置/制作/制作安装）。你可以在这里得到它：

[http://sourceware.org/systemtap/ftp/releases/](http://sourceware.org/systemtap/ftp/releases/)

我使用的是 1.8 版。

然后尝试再次重新编译它。它应该工作。

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-29T04:03:52.137

*   安装 systemtap（sudo apt-get install systemtap）后，退出或退出当前 shell 会话然后登录可能会有所帮助。

*   另外，您可以尝试使用[kerl](https://github.com/kerl/kerl)。

# vb.net - 从列表框中删除项目

> ID：12416530
> 
> 赞同：0
> 
> 时间：2012-09-14T00:11:13.157
> 
> 标签：vb.net, visual-studio-2010, listbox

好的，我在遍历项目列表框并根据文件系统观察程序删除它们时遇到问题。

用户在文本框中输入数值，我将它们添加到列表框中。

```
Listbox1.Items.Add(Textbox1.Text) 
```

在这里，我当前是如何遍历列表框项目并触发 msgbox 以进行测试的。

```
Public Sub CheckCreatedPDFs()
    For i As Integer = 0 To ListBox1.Items.Count - 1
        Dim Watcher As New FileSystemWatcher()
        Watcher.Path = "C:\Temp\"
        Watcher.NotifyFilter = (NotifyFilters.Attributes)
        Watcher.Filter = ListBox1.Items(i) + ".pdf"

        AddHandler Watcher.Changed, AddressOf OnChanged

        Watcher.EnableRaisingEvents = True
    Next i

End Sub

Private Sub OnChanged(source As Object, e As FileSystemEventArgs)
    ' Specify what is done when a file is created.
    MsgBox("SPACE RESERVED FOR REMOVING LISTBOX ITEMS")
End Sub 
```

有关如何删除这些项目的任何建议？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:45:09.043

存储`ListBox1.Items.IndexOf(e.Name)`. 如果大于 -1，请使用`ListBox1.Items.RemoveAt(SavedIndex)`. 我不使用`VB.Net`，所以我无法提供确切的代码。

在 C# 中，它会是这样的：

```
private void OnChanged(object Sender, FileSystemEventArgs e)
{
    var Idx = listbox1.Items.IndexOf(e.Name);
    if (Idx > -1) 
    {
      listbox1.Items.RemoveAt(Idx);
    }
} 
```

# python - mod_wsgi 测试 wsgi 运行良好，应用程序给出 HTTP 500

> ID：12416532
> 
> 赞同：1
> 
> 时间：2012-09-14T00:12:00.240
> 
> 标签：python, apache, centos, mod-wsgi, flask

我试图让一个烧瓶应用程序在运行 CentOS 6.3（禁用 SE linux）的 Apache 服务器（2.2.15）上运行，并且正在使用 mod_wsgi（从源代码安装 3.3）来执行此操作。

[我在这里](http://code.google.com/p/modwsgi/wiki/CheckingYourInstallation)尝试了测试脚本，它返回了 HTTP 200，但是当我将应用程序放在同一目录中并`httpd.conf`进行相应调整时，我得到了 HTTP 500。

这是我的相关部分`/etc/httpd/conf/httpd.conf`：

```
LoadModule wsgi_module modules/mod_wsgi.so
WSGISocketPrefix /tmp/wsgi
<VirtualHost *:80>
#    ServerAdmin root@localhost
    DocumentRoot /var/www/html/
#    ServerName dummy-host.example.com
#    ErrorLog logs/dummy-host.example.com-error_log
#    CustomLog logs/dummy-host.example.com-access_log common
     ServerName XXXX.YYYYY.org
     WSGIDaemonProcess irbsite user=apache group=apache threads=5
     WSGIScriptAlias / /var/www/html/irbsite.wsgi

     <Directory />
    WSGIProcessGroup irbsite
    WSGIApplicationGroup %{GLOBAL}
    Order deny,allow
    Allow from all
    </Directory> 
```

我在运行 Debian 6 的 linode 服务器上运行了一个类似的应用程序，它开箱即用。

**编辑：**检查错误日志显示脚本被调用：

```
[Thu Sep 13 17:24:45 2012] [info] mod_wsgi (pid=6223): Attach interpreter ''.
[Thu Sep 13 17:24:45 2012] [info] mod_wsgi (pid=6228): Attach interpreter ''.
[Thu Sep 13 17:24:45 2012] [info] mod_wsgi (pid=6229): Attach interpreter ''.
[Thu Sep 13 17:24:45 2012] [info] mod_wsgi (pid=6230): Attach interpreter ''.
[Thu Sep 13 17:24:45 2012] [info] mod_wsgi (pid=6231): Attach interpreter ''.
[Thu Sep 13 17:24:47 2012] [info] [client 140.107.134.36] mod_wsgi (pid=6223, process='irbsite', application=''): Loading WSGI script '/var/www/html/irbsite.wsgi'. 
```

我不确定下一步该尝试什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T18:13:34.247

经过进一步测试，事实证明，罪魁祸首是应用程序正在调用的 sqlite 数据库的非显式路径名。mod_wsgi 调试页面上的测试与烧瓶中的[示例一样运行良好。](http://flask.pocoo.org/)

# python - 给定一个“混乱”的列表 L，如果 L 已排序，则得到一个列表，其中每个元素都是 L 的相应元素的索引

> ID：12416537
> 
> 赞同：4
> 
> 时间：2012-09-14T00:12:43.547
> 
> 标签：python

## 期望的输出

我想要一个函数返回一个列表，这样，给定一个“混乱”的列表，如果已排序`l`，每个元素都是 的相应元素的索引。（对不起，我想不出一种不那么复杂的说法。）`l``l`

**例子**

`f([3,1,2])`=`[2,0,1]`

`f([3,1,2,2,3])`= `[3,0,1,2,4]`，因为排序后的输入是`[1,2,2,3,3]`。

（这对于某些统计数据计算很有用。）

## 我的尝试

我想出了一种方法来执行此功能，但这是*python* - 似乎应该有一个单行来执行此操作，或者至少是一种更清洁、更清晰的方法。

```
def getIndiciesInSorted(l):
    sortedL = sorted(l)
    outputList = []
    for num in l:
        sortedIndex = sortedL.index(num)
        outputList.append(sortedIndex)
        sortedL[sortedIndex] = None
    return outputList

l=[3,1,2,2,3] 
print getIndiciesInSorted(l) 
```

那么，我怎样才能更简洁地写这个呢？是否有清晰的列表理解解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T00:27:58.273

```
def argsort(seq):
    # http://stackoverflow.com/questions/3382352/3382369#3382369
    # http://stackoverflow.com/questions/3071415/3071441#3071441
    '''
    >>> seq=[1,3,0,4,2]
    >>> index=argsort(seq)
    [2, 0, 4, 1, 3]

    Given seq and the index, you can construct the sorted seq:
    >>> sorted_seq=[seq[x] for x in index]
    >>> assert sorted_seq == sorted(seq)

    Given the sorted seq and the index, you can reconstruct seq:
    >>> assert [sorted_seq[x] for x in argsort(index)] == seq
    '''
    return sorted(range(len(seq)), key=seq.__getitem__)

def f(seq):
    idx = argsort(seq)
    return argsort(idx)

print(f([3,1,2]))
# [2, 0, 1]

print(f([3,1,2,2,3]))
# [3, 0, 1, 2, 4] 
```

* * *

请注意，nightcracker 的功能更快：

```
def get_sorted_indices(l):
    sorted_positions = sorted(range(len(l)), key=l.__getitem__)
    result = [None for _ in range(len(l))]
    for new_index, old_index in enumerate(sorted_positions):
        result[old_index] = new_index
    return result 
```

对于长列表，差异可能很大：

```
In [83]: import random
In [98]: l = [random.randrange(100) for _ in range(10000)]
In [104]: timeit get_sorted_indices(l)
100 loops, best of 3: 4.73 ms per loop

In [105]: timeit f(l)
100 loops, best of 3: 6.64 ms per loop 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-14T00:15:35.457

这是我想出的最好的：

```
def get_sorted_indices(l):
    sorted_positions = sorted(range(len(l)), key=l.__getitem__)
    result = [None for _ in range(len(l))]

    for new_index, old_index in enumerate(sorted_positions):
        result[old_index] = new_index

    return result 
```

它比您的解决方案更快，但仅此而已。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-14T00:31:45.250

有一个单行理解，但它真的很难看：

```
>>> E, S = enumerate, sorted
>>> l = [3,1,2,2,3]
>>> [a for _,a in S((a,b) for b,(_,a) in E(S((a,b) for b,a in E(l))))]
[3, 0, 1, 2, 4] 
```

[Unutbu 的答案](https://stackoverflow.com/a/12416630/68063)更容易阅读并且产生的垃圾更少。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-14T00:33:25.053

```
k = [3, 0, 1, 2, 4]
initial = dict(zip(k, range(len(k)))) #{0: 1, 1: 2, 2: 3, 3: 0, 4: 4}
sorted_initial = dict(zip(sorted(k), range(len(k)))) #{0: 0, 1: 1, 2: 2, 3: 3, 4: 4}
initial.update(sorted_initial) #{0: 0, 1: 1, 2: 2, 3: 3, 4: 4}
result = [initial[i] for i in k] #[3, 0, 1, 2, 4] 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-14T03:27:40.287

如果您正在进行统计计算，您可能会在某个时候开始使用 numpy。使用 numpy，您可以使用 argsort 的现有实现：

```
>>> from numpy import array
>>> x = array([3, 1, 2, 2, 3])
>>> x.argsort().argsort()
array([3, 0, 1, 2, 4]) 
```

这是 unutbu 答案的 numpy 版本。nightcracker的答案可以实现为

```
>>> from numpy import array, empty_like, arange
>>> x = array([3, 1, 2, 2, 3])
>>> s = x.argsort()
>>> r = empty_like(s)
>>> r[s] = arange(x.size)
>>> r
array([3, 0, 1, 2, 4]) 
```

# android - 设备关闭时运行的 Android 时钟

> ID：12416540
> 
> 赞同：2
> 
> 时间：2012-09-14T00:13:07.807
> 
> 标签：android, clock

我正在创建一个应用程序，当用户按下按钮时，它将在文件中保存当前时间（有一些延迟，例如 2 小时）。稍后，应用程序将检查时间是否已经过去并做一些事情......

所以...我单击应用程序中的按钮（时间保存在文件中）...我退出应用程序...关闭手机...我在 1 小时后打开它，返回应用程序...我会仍然需要等待 1 小时，直到应用程序让我做“某事”......

**问题：**

是否存在用户无法更改并在设备关闭时继续运行的时钟？我目前正在使用`SystemClock.elapsedRealtime()`，效果很好，因为即使用户更改设置中的时间，也`elapsedRealtime`保持不变。问题是设备是否被关闭，因为每次启动都`elapsedRealtime`以 0 开头。

我无法使用服务器时间，因为应用程序不会连接到 Internet。

如果没有这样的时钟，请建议我另一种解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T02:10:22.073

实际上，您没有机会“关闭”硬件时钟数据。硬件时钟只是在新手机中的旧手机上，我认为没有人需要它，所以他们不会在硬件中构建它。在旧手机中，有“硬件”时钟，但在新设备中，我认为与此完全不同。我确实读过一些关于谷歌想要制作一些框架或实现它的内容。但是没有警报可以在关闭模式下启动。

所以我很抱歉，但我认为现在不可能..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T03:07:03.803

您可以将您的时间作为 DateTime 值存储在数据库中，表示年日月时秒毫秒，然后您可以请求服务在启动时启动并读取该数据，创建在剩余时间触发的警报。我会给你一个代码示例，但我不太擅长java编程，所以它可能没用，无论如何祝你好运并尝试实现它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-14T00:23:06.780

您显然需要将数据保存到非易失性存储中。当您的应用程序被 Android 暂停/破坏时，您应该将其视为威胁并将您的时间值保存到磁盘中，然后当您的应用程序再次启动时，您的应用程序应该读取您之前写入的数据并继续运行它通常会。

好吧，当谈到如何提出问题时：

最简单的解决方案是使用[`SharedPreferences`](http://developer.android.com/reference/android/content/SharedPreferences.html),

更复杂和更灵活的是 SQLite 数据库，

有关 Android 存储的更多数据，我建议：[存储选项](http://developer.android.com/guide/topics/data/data-storage.html)

# indexeddb - jquery indexeddb插件在游标迭代完成之前执行其他语句

> ID：12416541
> 
> 赞同：0
> 
> 时间：2012-09-14T00:13:10.350
> 
> 标签：indexeddb

我正在使用[http://nparashuram.com/jquery-indexeddb/](http://nparashuram.com/jquery-indexeddb/)此处提供的**JQuery IndexedDB 插件**。以下是我在 objectstore **project_created**上迭代的代码。当我运行此代码时，会在迭代**objectstore task_created**之前提醒**ss**。但从逻辑上讲，只有在迭代**objectstore task_created**之后才应该提醒**ss**。

 ******```
$.indexedDB("sl_task_tracker").objectStore("project_created").each(function(elem){
        var count_tasks=0;
        $.indexedDB("sl_task_tracker").objectStore("task_created").each(function(item){
            if(item.value.project_id==elem.key)
                count_tasks++;
        });

        alert("ss");
});
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T07:31:23.530

我相信这是因为 IndexedDB 使用了[异步 API](https://developer.mozilla.org/en-US/docs/IndexedDB#Asynchronous_API)。与 IndexedDB 相关的一切都在“另一个线程”中完成，以便*不阻塞*主线程（这样网站就不会看起来是固定的）。

我不知道这个插件，但你应该检查你是否可以将“onSuccess”函数传递给你的任务，这样你就可以指定任务完成后会发生什么。

有关您正在使用的插件的更多信息，您可以随时在他的 github 页面上询问开发人员：[https ://github.com/axemclion/jquery-indexeddb](https://github.com/axemclion/jquery-indexeddb)

（抱歉我的技术英语不好，请随时用更易于理解的语言进行编辑）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-23T08:45:21.137

我编写了一个小的 jquery 插件（仍然非常 alpha）来缓解异步和其他令人困惑的 API：

[https://github.com/ameyms/jquery-indexeddb](https://github.com/ameyms/jquery-indexeddb)

我试图保持 API 超级简单：

```
//Define and initialize an IndexedDB ...
var db = $.idb({
                    name:'foobar', 
                    version: 2,
                    drop: stores_to_be_deleted,
                    stores:list_of_stores
                });

// ... Add objects to a store
db.put(items, 'into_store').done(onsuccess);

//.. And delete objects from a store
db.remove('from_store', conditionFunc).done(onremoval);

//.. And not to forget fetching objects from a store
db.select('from_my_store', conditionFunc).done(function (items){

    console.log(items)
}); 
```

希望你喜欢！******

# php - WordPress 中选项字符串的限制

> ID：12416542
> 
> 赞同：1
> 
> 时间：2012-09-14T00:13:13.100
> 
> 标签：php, wordpress

用于选项的字符串是否有限制？我很想使用瞬态 API，当我在瞬态名称中包含一串 url 时，它不会保存数据。我不确定这是由于字符长度还是非法字符。

```
$url = 'http://stackoverflow.com/questions/tagged/php+wordpress+wordpress-plugin';
$strTransient = 'sample_transient_' . $url;
$key = 'sample_transient';
$html = get_transient($strTransient);   
if( false === $html ) {
    echo 'cache is not used: ' . $strTransient . '<br />';      
    $html = wp_remote_get($url);    
    $html = $html['body'];  
    $savehtml = base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_256, md5($key), $html, MCRYPT_MODE_CBC, md5(md5($key))));
    set_transient($strTransient, $savehtml, 60 );
} else {
    echo 'cache is used. <br />';
    $html = mcrypt_decrypt(MCRYPT_RIJNDAEL_256, md5($key), base64_decode($html), MCRYPT_MODE_CBC, md5(md5($key)));  
}
print_r($html); 
```

提前致谢。

[编辑]

这似乎是由于字符长度。

```
$transientkey = 'verylongstring_verylongstring_verylongstring_verylongstring_verylongstring_verylongstring_verylongstring'; // <-- fails
// $transientkey = 'shortstring';   // <-- okay

$data = get_transient($transientkey);   
if( false === $data ) {
    echo 'transient is not saved: ' . $transientkey . '<br />';     
    $data = 'hello world!';
    echo 'now saving the data.<br />';
    set_transient($transientkey, $data, 60 );
} else {
    echo 'transient is used. <br />';
}
print_r($data); 
```

那么我在哪里可以找到有关选项键限制的确切信息？我在核心中找不到它。这是评论`set_transient()`

**wp-includes/option.php**

```
/**
 * Set/update the value of a transient.
 *
 * You do not need to serialize values. If the value needs to be serialized, then
 * it will be serialized before it is set.
 *
 * @since 2.8.0
 * @package WordPress
 * @subpackage Transient
 *
 * @uses apply_filters() Calls 'pre_set_transient_$transient' hook to allow overwriting the
 *  transient value to be stored.
 * @uses do_action() Calls 'set_transient_$transient' and 'setted_transient' hooks on success.
 *
 * @param string $transient Transient name. Expected to not be SQL-escaped.
 * @param mixed $value Transient value. Expected to not be SQL-escaped.
 * @param int $expiration Time until expiration in seconds, default 0
 * @return bool False if value was not set and true if value was set.
 */ 
```

还有任何将 url 标识为临时密钥的建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T00:41:01.933

[文档说](http://codex.wordpress.org/Function_Reference/set_transient)临时名称是“预计*不会被 SQL 转义。长度应为 45 个字符或更少。* ”

查看 Wordpress 3.4.1 中的表结构：

```
mysql> desc wp_options;
+--------------+---------------------+------+-----+---------+----------------+
| Field        | Type                | Null | Key | Default | Extra          |
+--------------+---------------------+------+-----+---------+----------------+
| option_id    | bigint(20) unsigned | NO   | PRI | NULL    | auto_increment |
| option_name  | varchar(64)         | NO   | UNI |         |                |
| option_value | longtext            | NO   |     | NULL    |                |
| autoload     | varchar(20)         | NO   |     | yes     |                |
+--------------+---------------------+------+-----+---------+----------------+
4 rows in set (0.00 sec) 
```

因此`option_name`可以不超过 64 个字符，但`data`可以大到 2 ^(32)字节 (~4GB)。 `set_transient`最终调用`add/update_option`的选项名称最长为 64 个字符，但由于瞬态以特殊方式工作，`45`因此是您应该使用的最长值。

编辑：

通过查看 WP 代码，根据参考指南将瞬态名称限制为 45 个字符的原因是代码执行以下操作：

```
$transient_timeout = '_transient_timeout_' . $transient;
//...
add_option( $transient_timeout, time() + $expiration, '', 'no' ); 
```

因此，如果您`hello`作为瞬态传递，它将添加一个名为`_transient_timeout_hello`. 鉴于：`45 + strlen('_transient_timeout_') === 64`和 64 是 WP 选项表中选项名称字段的最大 varchar 长度。

# html - 为什么菜单出现在 Chrome 和 FireFox 中，而不出现在 IE 中？

> ID：12416543
> 
> 赞同：1
> 
> 时间：2012-09-14T00:13:16.403
> 
> 标签：html, css, internet-explorer, firefox, google-chrome

为什么顶级类别菜单（Everything、Ballet Flats、Boots 等） - div id="header-bar" - 在 FireFox 和 Chrome 中看起来很棒，但在 IE 中隐藏，除非您向下滚动页面？

[http://shoeporn.com](http://shoeporn.com)

任何帮助都感激不尽 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T00:18:05.937

它位于顶部栏的下方（后面）。要么将 更改为`z-index`比顶部栏更大的东西，要么将 更改为`top`将其放置在顶部栏下方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T01:33:03.747

它也隐藏在铬中。z-index 低于背景之类的。无论如何，将这样的内容添加到您的 header-nav 中：

```
z-index: 130; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T06:32:49.070

我发现`position:absolute`在`#header-bar`这个特定的例子中设置是不好的做法。考虑将其更改为

```
#header-bar {
  position: relative;
  /*left: 0;
  right: 0;
  top: 44px; - remove these*/
} 
```

这将保持自然的文档流；`position:relative`允许下拉定位和维护渲染上下文（与完全删除位置属性相比，看到下拉菜单在鞋砖“后面”）

经验法则：如果您可以在没有它的情况下构建，请避免使用绝对定位。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-14T00:21:12.057

对我来说，它也隐藏在 chrome 中......无论如何在 css 中更改它：

```
#header-bar {
   top: 84px;
   z-index: 105;
} 
```

从 #header-wrapper 中删除 z-index 并将 z-index:106 添加到 #header-nav。

希望它会有所帮助...

# javascript - 如何在 app.use express 中配置强大的功能？

> ID：12416550
> 
> 赞同：3
> 
> 时间：2012-09-14T00:14:44.537
> 
> 标签：javascript, node.js, express

这是一个简单的问题......我如何使用强大的而不是bodyparser（）......

如何在 app.use 中配置

```
app.configure(function(){
app.set('port', process.env.PORT || 9000);
app.set('views', __dirname + '/views');
app.set('view engine', 'jade');
app.set('view options',{layout:false});
app.use(express.favicon());
app.use(express.bodyParser();
app.use(express.cookieParser('blocksecretpass'));
app.use(express.session()); 
```

我在 Windows 7 64 位上使用 expressjs 3 rc4 nodejs 0.8 强大的 1.0.11 为什么我需要？因为我必须发布一些文件并且 bodyparser() 关闭我的节点应用程序这是错误

```
https://github.com/felixge/node-formidable/issues/34
https://github.com/felixge/node-formidable/issues/130 
```

问题的解决方案是 app.use express.bodyparser 在任何其他尝试使用异步调用的中间件之前

全部

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-07T23:47:08.413

不要使用`.bodyParser()`，它已被弃用。

利用

```
app.use(express.json());
app.use(express.urlencoded()); 
```

考虑使用替代方案：[http](http://www.senchalabs.org/connect/multipart.html) ://www.senchalabs.org/connect/multipart.html 。[强大](https://github.com/felixge/node-formidable)就是其中之一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T18:40:08.700

你已经在使用强大的了。Express 是基于[connect](http://www.senchalabs.org/connect/)的，[multipart](http://www.senchalabs.org/connect/multipart.html)中间件是基于 formidable 的。查看[express 示例](https://github.com/visionmedia/express/blob/master/examples/multipart/index.js)以了解如何上传文件。

# r - 使用 ffdf 读取 csv 文件并成功对其进行子集化

> ID：12416552
> 
> 赞同：0
> 
> 时间：2012-09-14T00:15:19.080
> 
> 标签：r, csv, dataframe, large-files, subset

我一直在研究一种使用 R 从大型 csv 数据集中有效提取信息的方法。许多人似乎推荐使用 ff 包。我成功地读取了数据集，但现在在尝试对其进行子集化时遇到了问题。

最大的数据集包含超过 650,000 行和 1005 列。并非所有列都包含相同的数据类型。作为一个数据框，结构看起来像这样：

```
'data.frame':   5 obs. of  1005 variables:
 $ SAMPLING_EVENT_ID      : Factor w/ 5 levels "S6230404","S6252242",..: 2 1 3 4 5
 $ LATITUDE               : num  24.4 24.5 24.5 24.5 24.5
 $ LONGITUDE              : num  -81.9 -81.9 -82 -82 -82
 $ YEAR                   : int  2010 2010 2010 2010 2010
 $ MONTH                  : int  4 3 10 10 10
 $ DAY                    : int  97 88 299 298 300
 $ TIME                   : num  9 10 10 11.58 9.58
 $ COUNTRY                : Factor w/ 1 level "United_States": 1 1 1 1 1
 $ STATE_PROVINCE         : Factor w/ 1 level "Florida": 1 1 1 1 1
 $ COUNT_TYPE             : Factor w/ 2 levels "P21","P22": 2 2 1 1 1
 $ EFFORT_HRS             : num  6 2 7 6 3.5
 $ EFFORT_DISTANCE_KM     : num  48.28 8.05 0 0 0
 $ EFFORT_AREA_HA         : int  0 0 0 0 0
 $ OBSERVER_ID            : Factor w/ 3 levels "obs132426","obs58643",..: 3 2 1 1 1
 $ NUMBER_OBSERVERS       : Factor w/ 2 levels "?","1": 2 1 2 2 2
 $ Zenaida_macroura       : int  0 0 1 0 0 
```

所有其他变量都类似于最后一个变量，即各种鸟类。

这是我用来“成功：读取 csv：

```
B2010 <- read.table.ffdf (x = NULL, “filePath&Name", nrows = -1, first.rows = 50000, next.rows = 50000) 
```

为了了解 ffdf 输出，我输入了诸如 dim(B2010)、str(B2010)、ls(B2010) 等命令行。 dim(B2010) 产生了适当的行数，但只有一列（每条记录一个字符串逗号分隔的值），并且 ls(B2010) 输出“[1] "physical" "row.names" "virtual" 而不是通常的变量列表。

我不确定如何处理这种类型的输出以便能够提取 STATE_PROVINCE == “California”？我如何告诉 B2010 变量是什么？我想我需要以不同的方式看待这个问题，但需要你的帮助才能弄清楚。

我的最终目标是对一堆 csv 数据集进行子集化（因为我每年都有一个）并将结果重新组合在一起作为数据框进行各种分析。

谢谢，乔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T07:45:51.723

要子集 ffdf，请使用 ffbase 包。如在

```
require(ffbase)
x <- subset(B2010, BB2010$STATE_PROVINCE == “California”) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T01:06:44.087

我终于找到了正确读取和访问 ffdf 变量名称和类型以进行子集化的解决方案：

```
B2010 <- read.csv.ffdf (file = "filepath/name", colClasses = c("factor", "numeric", "numeric", "integer", "integer", "integer", "numeric", rep("factor",998)), first.rows = 10000, next.rows = 50000, nrows = -1) 
```

这需要很长时间才能阅读，但似乎有效，即我能够创建数据的子集。下一步：将子集保存回“正常”数据帧和/或 csv。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T00:26:34.140

根据 ?read.table.ffdf 的帮助页面，您应该使用`read.csv.ffdf(...)`. 然后转到布兰登引用的页面。

# arguments - 如何使用宏参数将宏定义为 _Pragma

> ID：12416558
> 
> 赞同：2
> 
> 时间：2012-09-14T00:15:43.287
> 
> 标签：arguments, literals, pragma

我一直在编写 C++，但对宏的经验很少。我已经阅读了有关此主题的其他一些问题，但我无法将它们完全转化为我的问题。

我想定义一个宏，以便编码`ENUM_PRAGMA(foo)`产生`_Pragma("enum(foo)")`我打算产生的效果`#pragma enum(foo)`

（编译器支持`_Pragma("string")`。）

我尝试了多种变体

```
#define ENUM_PRAGMA(siz)  \
_Pragma( "enum(" #siz ")" ) 
```

但不能让他们中的任何一个工作。

基于[如何实现为 _Pragma 创建带引号的字符串的宏？](https://stackoverflow.com/questions/8724644/how-do-i-implement-a-macro-that-creates-a-quoted-string-for-pragma)我试过了

```
#define HELPER1(x) enum( x )  
#define HELPER2(y) HELPER1(#y) 
#define ENUM_PRAGMA(siz) _Pragma(HELPER2(siz)) 
```

但我仍然不完全在那里。（错误是`string literal was expected but enum was found`所以我猜我的 HELPER2 没有引用字符串。

任何人都可以请幽默我吗？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T16:30:26.710

好的，我明白了。

我定义了一个通用宏STRINGIFY：

```
#define STRINGIFY(str) #str 
```

现在真正的宏简单地归结为

```
#define ENUM_PRAGMA(siz) _Pragma(STRINGIFY(enum(siz))) 
```

谢谢你的耐心。

# android - 如果选中 Unknown Sources，则阻止 .apk 安装

> ID：12416559
> 
> 赞同：1
> 
> 时间：2012-09-14T00:15:47.183
> 
> 标签：android, apk

如果检查了未知来源，我可以阻止安装 .apk 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T00:26:29.430

您可以检查[Settings.Secure.INSTALL_NON_MARKET_APPS](http://developer.android.com/reference/android/provider/Settings.Secure.html#INSTALL_NON_MARKET_APPS)以查看用户是否允许来自未知来源的安装

# eclipse - Help_Contents 未显示在 Eclipse 产品中

> ID：12416562
> 
> 赞同：3
> 
> 时间：2012-09-14T00:16:08.187
> 
> 标签：eclipse, product

我构建了一个 Eclipse 产品。当我在 Eclipse 中测试项目时一切正常，我可以执行 Help->Help Contents 并查看我的插件包含的帮助内容。

如果我导出产品并启动它，一切正常，除了 Help->Help Contents 什么都不做。我怀疑我的产品依赖项中缺少一些插件。但我看不出是哪个？

我添加了所有 org.eclipse.help* 和 org.mortbay.jetty.*（因为我注意到在 Eclipse 中从我的测试启动帮助内容时，内容由码头提供）。但产品导出后仍然没有帮助内容窗口。

知道产品中缺少什么来显示帮助内容吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T15:41:42.777

[根据拉斯沃格尔](http://www.vogella.com/articles/EclipseRCPHelpSystem/article.html)的说法，它是

*   org.eclipse.help.ui
*   org.eclipse.help.webapp
*   org.eclipse.equinox.http.jetty

另一个潜在问题可能是您在产品导出中根本没有帮助内容文件。我会尝试在 build.properties 的“二进制构建”部分中为帮助文件设置复选标记，但我不确定这里。

# php - 需要从标签中去除锚标签，但不影响其他标签（使用 PHP）

> ID：12416566
> 
> 赞同：-1
> 
> 时间：2012-09-14T00:17:25.220
> 
> 标签：php, rss, image

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T11:44:41.760

strip_tags() 能够允许未剥离的标签。

看下面的例子

```
<?php
$text = '<p>Test paragraph.</p><!-- Comment --> <a href="#fragment">Other text</a>';
// Allow <p> and <a>
echo strip_tags($text, '<p><a>');
?> 
```

或手册 [http://www.php.net/manual/en/function.strip-tags.php](http://www.php.net/manual/en/function.strip-tags.php)

# jquery - 可编辑文本区域宽度

> ID：12416567
> 
> 赞同：0
> 
> 时间：2012-09-14T00:17:26.760
> 
> 标签：jquery, html, jeditable

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T08:39:19.623

该插件不应该改变文本区域的宽度，而是它的高度。无论如何，您甚至没有告诉 jeditable 使用该插件，请再次阅读您链接到的文档。

# php - 如何解析来自 vBulletin 的引用帖子？

> ID：12416568
> 
> 赞同：0
> 
> 时间：2012-09-14T00:17:30.727
> 
> 标签：php, regex, preg-replace, vbulletin, quote

使用 PHP，我该如何转换：

```
[QUOTE=Username;1234]This is the text being quoted[/QUOTE] 
```

进入：

```
<div class="quote"><a href="./linktopost?id=1234>Posted by: Username</a><p>This is the text being quoted.</p></div> 
```

注意**Username**、**1234** id 和**This is the text 被引用的**文本映射到的位置。

我知道如何开始和结束，只需替换（例如`str_replace`）以下任何实例：

```
[QUOTE= >>> <div class="quote">< href="./linktopost.php?id=

[/QUOTE] >>> </p><div> 
```

但我不知道如何提取**Username**、**Post ID**和被引用的**Text**，以便将它们捆绑在一起。

如果有帮助，从我上面可以看出，可以在分隔符`[QUOTE=`and之间提取用户名`;`，可以在 and 之间提取帖子 ID ，并且可以在`;`and`]`之间提取文本`]`，`[/QUOTE]`但我不知道如何提取它们。

另外，如果报价中有报价，会发生什么？该解决方案也应该适用于这些情况。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T13:55:43.537

这可能会有所帮助；）

```
$str = "[QUOTE=Username;1234]This is the text being quoted[/QUOTE]";

if(preg_match('/\[QUOTE=([^;]+);([0-9]+)\]([^\[]+)\[\/QUOTE\]/i', $str, $matches)){
    echo "<br>USERNAME : ".$matches[1];
    echo "<br>POST ID : ".$matches[2];
    echo "<br>MESSAGE : ".$matches[3];
} 
```

# sql - 没有 ORDER BY 的 SQL 中的最新日期和时间

> ID：12416569
> 
> 赞同：-3
> 
> 时间：2012-09-14T00:17:49.140
> 
> 标签：sql

我试图找到一种方法来显示事件表中举行的最后一个事件（最后日期和时间），同时显示该事件的所有列而不使用 ORDER BY。

例如：

```
SELECT * from Events
where dateheld in (select max(dateheld) from events)
AND starttime in (select max(starttime) from events) 
```

当我输入 MAX starttime 时，它​​什么也不显示。当我输入 MIN starttime 时，它​​可以工作，但会显示该日期的最早时间而不是最晚时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:20:29.943

我想你可以打印出你的记录，把它们扔下楼梯，走得最远的那些就有“最轻”的日期。没有顺序就无法排序。这就像想要不湿的水一样。除非您的数据自然地按照您想要的顺序出现，否则您必须排序。

当然，如果您只想要具有绝对最近日期的记录，并且只需要那条记录，那么

```
SELECT yourdatetimefield, ...
FROM yourtable
HAVING yourdatetimefield = MAX(yourdatetimefield) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:21:02.127

如果您只是在寻找最新的项目：

**当您有单独的日期和时间字段时，编辑**会变得更加复杂，但这应该可以工作。对于日期和时间应该存储在一个字段中的情况，这是一个荒谬的组合。

```
SELECT * 
FROM (
  SELECT *
  FROM Events
  WHERE dateTime = (SELECT MAX(dateheld) FROM Events)
) temp
WHERE starttime = (SELECT MAX(starttime) FROM (
  SELECT *
  FROM Events
  WHERE dateTime = (SELECT MAX(dateheld) FROM Events)
) temp 2 ) 
```

# node.js - Node.js optimist 模块 - 将标志后面的所有参数分配给标志

> ID：12416570
> 
> 赞同：0
> 
> 时间：2012-09-14T00:17:51.673
> 
> 标签：node.js

我正在为 node.js 使用 optimist，并希望像这样解析输入：

```
$ command some args -m this is the message 
```

进入这个

```
{argv:{_:['some','args'],m:'this is the message'}} 
```

乐观主义者有可能吗？这一般可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T21:38:55.537

通常，shell 负责对包含空格的参数进行分组，而不是参数解析器。这通常是通过用户引用多字参数来完成的（在 Unix 类型的 shell 中使用单引号或双引号，在 Windows 中只能识别双引号）。

在 Optimist 中，您*可以*执行以下操作：

```
var argv=require('optimist').argv;
if (argv.m) {
  argv.m=argv.m+' '+argv._.join(' ');
} 
```

*如果* `-m`是最后一个参数，它将按您的预期工作。但是，如果你做了类似的事情`command ... -m hello there -q now here`，`argv.m`最终会变成“你好”，这可能不是你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T12:30:21.830

我最终这样做了，这适用于我的用例：

```
#!/usr/bin/env coffee

args = process.argv

o = {_:[],$0:[]}
flags = {s:'state',m:'message',e:'editor',t:'type'}
i = -2
na = false # next argument: false/opt/flag

for arg in args
  if m = arg.match /^--(.+?)(=(.+))?$/
    na = m[1]
    o[m[1]] = m[3] || true
  else if m = arg.match /^-(.+)/
    na = flags[m[1]]
    o[na] = true
    if !na
      console.log 'Unknown flag: '+m[1]
      process.exit 1
  else if ++i > 0 # ignore first two args which are node and app
    if na == 'message'
      o.message = [arg]
    else if na != false
      o[na] = arg
    else
      if o.message
        o.message.push arg
      else
        o._.push arg
    na = false
  else
    o['$0'].push arg

if o.message
  o.message = o.message.join ' '

console.log o 
```

## 编辑：

其实这种方法还是有问题的。我最终做了其他事情，但仍在寻找更好的解决方案。我想我最终会编写一个小的 peg 解析器来解析我想要的命令行选项。

# f# - 在不确定类型的对象上查找错误....在已注释的类型上

> ID：12416571
> 
> 赞同：9
> 
> 时间：2012-09-14T00:17:52.767
> 
> 标签：f#

为什么我会收到“基于此程序点之前的信息查找不确定类型的对象...”的错误

我已经用类型信息进行了注释。

它突出显示代码`r.Read()`。

```
let rec foldResult myFunc accumulator r:SqlDataReader =
    if r.Read() then
        foldResult myFunc (myFunc 123456 accumulator) r:SqlDataReader
    else
        accumulator 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-14T00:46:18.353

把它放在括号里

```
let rec foldResult myFunc accumulator (r:SqlDataReader) = ... 
```

否则，您将注释函数的返回类型而不是最终参数类型。

# jquery - jQuery可排序“序列化”方法返回空白字符串

> ID：12416577
> 
> 赞同：1
> 
> 时间：2012-09-14T00:19:48.957
> 
> 标签：jquery, ruby-on-rails, jquery-ui-sortable

我的桌子看起来像：

```
<table id="pages_table">
<tr>
 <th>Name</th>
 <th>Sub title</th>
 <th>Icon url</th>
 <th>Order</th>
</tr>

<tbody>
<% @pages.each do |page| %>
<tr id="page<%=page.ordering %>">
  <td><%= page.name %></td>
  <td><%= page.sub_title %></td>
  <td><%= page.icon_url %></td>
  <td><%= page.ordering %></td>
  <td><%= link_to 'Show', page %></td>
  <td><%= link_to 'Edit', edit_page_path(page) %></td>
  <td><%= link_to 'Destroy', page, method: :delete, data: { confirm: 'Are you sure?' } %></td>
</tr>
<% end %>
</tbody> 
```

我的javascript是：

```
$(function() {

 $("#pages_table tbody").sortable({
   update  : function () { 
   var order = $("#pages_table tbody").sortable('serialize'); 
   console.log(order);
  }
 });
}); 
```

无论出于何种原因，控制台语句都会打印出一个空白字符串，我不知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-15T03:48:58.580

更改此行：

```
<tr id="page<%=page.ordering %>"> 
```

对于这个：

```
<tr id="page_<%= page.ordering %>"> 
```

看起来`.sortable('serialize')`需要 id 属性中的下划线。

# git - Azure 网站创建给出“拒绝访问”

> ID：12416578
> 
> 赞同：1
> 
> 时间：2012-09-14T00:19:51.957
> 
> 标签：git, deployment, command-line, azure, web

我正在使用适用于 Mac ( `version 0.6.2 of the tools, 1.0.1 of the azure tools installer for MacOS`) 的 azure 命令行工具，并且正在尝试使用 : 创建一个带有 git 存储库的网站`azure site create MyUniqueApp --git`。

我一直看到这个：

```
$ azure site create MyUniqueApp --git
info:    Executing command site create
+ Enumerating locations                                                        
+ Enumerating sites                                                            
info:    Updating existing site
+ Retrieving user information                                                  
error:   Access is denied.
error:   site create command failed 
```

不带选项运行相同的命令`--git`是成功的。

```
$ azure site create MyUniqueApp
info:    Executing command site create
+ Enumerating locations                                                        
+ Enumerating sites                                                            
info:    Using location North Europe
info:    Creating a new web site at MyUniqueApp.azurewebsites.net
+ Sending site information                                                     
info:    Created website at myuniqueapp.azurewebsites.net
info:    Initializing remote Azure repository
+ Updating site information                                                    
info:    Repository initialized
+ Retrieving site information                                                  
info:    To create a local git repository to publish to the remote site, please rerun this command with the --git flag: "azure site create MyUniqueApp --git".
info:    site create command OK 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T22:13:17.923

我们遇到了一个应该很快解决的临时问题。有关更多信息，请参阅我的博客文章：http: [//hashtagfail.com/post/31636752900/azure-site-create-bug](http://hashtagfail.com/post/31636752900/azure-site-create-bug)。

# php - 让 Apache/PHP 吐出原始 php 代码？

> ID：12416586
> 
> 赞同：-4
> 
> 时间：2012-09-14T00:21:06.273
> 
> 标签：php, apache, encryption, base64, obfuscation

我遇到了一个问题......我有备份，备份，备份大声笑:)

不久前，我使用自定义密码加密创建了一个高级 PHP 系统，这是一种原始 CMS。

你必须登录，然后你才能看到后台，我什至做了一个管理面板。
我不知道很久以前我的原始代码在哪里。
我可以再做一次，但我只是想节省时间和压力，而且我喜欢学习新技巧:)

我在想，必须有一种方法让 Apache 和/或 PHP 吐出它生成的代码。

我的意思是，当您访问该页面时，Apache 和 PHP 会读取文件并将其呈现给浏览器。
因此，在内存中，文件以原始形式读取并显示在屏幕上。

有没有办法改变配置文件，或者“mod”Apache或PHP来读取文件并将原始代码存储在say中`readfilename.php.txt`？

例如，假设您获取了 PHP 源代码，并使用简单的`base64_encode`. 你将会拥有：

```
<?php
eval(base64_decode('Ly8gY29kZSBoZXJl'));
?> 
```

Web 服务器必须即时读取它并实际查看真实代码。

我想在日志文件中吐出它。

**我没有使用 Base64，因为它太容易了。**

只需快速浏览一下我的旧代码，我就会看到 SHA512 和`str_reverse`，并且我在其中的某处有一个密钥......

我真的不记得我是否在代码下面放了任何东西......它可能是 Base64 然后是最后一种方法，我只是不记得顺序。

我写了一个 PHP 脚本，我把代码放在一个`<textarea>`盒子里，给它起了个名字，它用我的自定义加密序列加密了文件。

代码效果很好，*我只是不能回去编辑它*。

当时，我并没有发布或使用它......只是让我自己的 CMS 有一天可以使用，并且可能只是出于好奇而对加密发疯了......

我的意思是程序员很好奇，而且天生就是黑客，即使我们不是恶意的，而且是为了我们自己的用途！

如果我可以让服务器解释文件，而不是显示它，而是将它吐出到文件中或在页面上显示原始代码，我可以编写另一个脚本来循环和反转我的整个项目。

节省大量时间“重新发明轮子”我已经做过的事情。

我对自己发疯和编码感到非常生气，所以希望有人能提供帮助……即使它是私下而不在网站上公开的，我明白。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T00:40:14.690

登录到服务器（或在文件目录中弹出 shell 提示符，假设您有本地副本），更改`eval`为`echo`，然后在命令行执行脚本（或浏览到它）...然后您去。这就是会被评估的代码——即：将运行的代码。

让这也成为“保护”你的源代码通常甚至没有像更天真的灵魂认为的那样有帮助的证据。除非您正在运行类似 ionCube 的东西，它实际上直接运行编码脚本，否则它实际上几乎毫无价值——在某些时候，解释器必须对脚本进行解码，此时您应用的任何保护都消失了。我强烈建议您在大多数情况下不要打扰......特别是如果您不打算保留原始代码的现成副本。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T00:22:56.520

您可以简单地禁用`mod_php`并重新启动 Apache 服务器。这将使所有`.php`文件以纯文本形式下载。

但是，如果您可以在服务器上获得这样做的特权***，***那么您已经可以访问 webroot 来下载文件；）

# javascript - 如何防止 jQuery ajax 在页面上提交表单

> ID：12416588
> 
> 赞同：3
> 
> 时间：2012-09-14T00:21:16.877
> 
> 标签：javascript, ajax, jquery

我在一个页面上有两个 ajax 调用。有用于搜索或返回结果的文本输入。

该页面有几个非 ajax 输入，并且 ajax 文本输入在 this 中。每当我按 enter -- 返回 ajax 调用时，表单都会过早提交并刷新页面。当在这些输入上按下 enter 时，如何防止 ajax 提交表单？它应该只是得到结果。

但是，我无法执行 jquery 按键，因为即使用户选项卡到另一个字段，它也需要运行 ajax。基本上我需要这个在用户甚至可以获得ajax结果之前不提交页面上的完整表单。我读了 return false 会解决这个问题，但它没有。

这是javascript：

```
 <script type="text/javascript">
    $(function() {
        $("[id^='product-search']").change(function() {
            var myClass = $(this).attr("class");
            // getting the value that user typed
            var searchString    = $("#product-search" + myClass).val();
            // forming the queryString
            var data            = 'productSearch='+ searchString + '&formID=' + myClass;
            // if searchString is not empty
            if(searchString) {
                // ajax call
                $.ajax({
                    type: "POST",
                    url: "<?php echo $path ?>ajax/product_search.php",
                    data: data,
                    beforeSend: function(html) { // this happens before actual call
                        $("#results" + myClass).html(''); 
                        $("#searchresults" + myClass).show();
                        $(".word").html(searchString);
                   },
                   success: function(html){ // this happens after we get results
                        $("#results" + myClass).show();
                        $("#results" + myClass).append(html);
                  }
                });
            }
            return false;
            });

            $("[id^='inventory-ESN-']").change(function() {
                var arr = [<?php 
                $j = 1;
                foreach($checkESNArray as $value){
                    echo "'$value'"; 
                    if(count($checkESNArray) != $j)
                        echo ", ";
                    $j++;
                }
                ?>];
                var carrier = $(this).attr("class");
                var idVersion = $(this).attr("id");
                if($.inArray(carrier,arr) > -1) {
                // getting the value that user typed
                    var checkESN    = $("#inventory-ESN-" + idVersion).val();
                    // forming the queryString
                    var data            = 'checkESN='+ checkESN + '&carrier=' + carrier;
                    // if checkESN is not empty
                    if(checkESN) {
                        // ajax call
                        $.ajax({
                            type: "POST",
                            url: "<?php echo $path ?>ajax/checkESN.php",
                            data: data,
                            beforeSend: function(html) { // this happens before actual call
                                $("#esnResults" + idVersion).html(''); 
                            },
                            success: function(html){ // this happens after we get results
                                $("#esnResults" + idVersion).show();
                                $("#esnResults" + idVersion).append(html);
                            }
                        });    
                    }
                }
                return false;
            });
    });
    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T00:57:03.203

我建议您将该 ajax 调用绑定到表单的提交事件并在最后返回 false，这将防止浏览器触发默认提交功能，并且只会执行您的 ajax 调用。

**更新**

我不知道您的 HTML 的结构，因此我将仅添加一个虚拟示例以使其清楚。假设我们有一些表格（我猜你有这样的表格，你试图阻止提交）

HTML：

```
<form id="myForm">
    <input id="searchQuery" name="search" />
</form> 
```

JavaScript：

```
$("#myForm").submit({

                     // this will preform necessary ajax call and other stuff
    productSearch(); // I would suggest also to remove that functionality from
                     // change event listener and make a separate function to avoid duplicating code

    return false;
}); 
```

此代码将在每次尝试提交表单时运行（尤其是当用户`Enter`在输入中按下键时），将执行必要的 ajax 调用并将返回 false 以防止以这种方式提交。

# c# - Webrequest 不包含身份验证标头

> ID：12416592
> 
> 赞同：1
> 
> 时间：2012-09-14T00:22:36.723
> 
> 标签：c#, webrequest

我在 c# 中运行以下命令向 API 发送登录请求。但是，根据 Fiddler 的说法，它没有发送身份验证标头。我是菜鸟，所以可能很简单。

```
NetworkCredential netcreds=new NetworkCredential(username,password);
CredentialCache credentials = new CredentialCache();
credentials.Add(new Uri(LoginUrl.ToString()),"Basic",netcreds);
Uri LoginUri = new Uri(LoginUrl);
WebRequest AuthRequest = WebRequest.Create(LoginUri);
AuthRequest.Credentials = credentials;        `  

AuthRequest.Headers.Add(HttpRequestHeader.AcceptEncoding,@"application/*+xml;version=1.5");` 
```

# c++ - 如果返回值未用于某种类型，则编译失败

> ID：12416604
> 
> 赞同：4
> 
> 时间：2012-09-14T00:24:02.103
> 
> 标签：c++, compiler-errors, compiler-warnings, static-analysis, clang-static-analyzer

我想让某些函数调用的编译失败，但其他的不行。我想要失败的函数调用是那些在值属于某种类型时不处理返回值的函数调用。在下面的示例中，不处理返回的函数`Error`是编译错误，但不处理返回任何其他内容的函数应该会成功。

注意：我们的运行时环境（嵌入式）不允许我们使用以下构造：RTTI、异常。

这段代码只需要用 Clang 编译，我宁愿不必注释每个函数。

我们更喜欢在编译时而不是在运行时失败的解决方案。

```
enum class Error {
  INVAL,
  NOERR,
};

// do something that can fail.
Error DoThing();
// may return different return codes, we never care (we can't change prototype)
int DoIgnoredThing();

int main() {
  DoThing(); // compilation failure here, unused "Error" result
  DoIgnoredThing(); // compilation succeeds, OK to ignore unused "int" result
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T00:34:30.613

我不知道直接使用 C++ 的方法，但如果您使用的是 g++，则可以使用[warn_unused_result 属性](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html#Function-Attributes)和 -Werror=unused-result 命令行标志。有关如何指定它的信息，请参阅 warn_unused 结果的文档（不幸的是，您必须在每个函数上指定它；我不相信您可以为类型指定它）。然后编译器标志会将警告变成错误。

如果您不使用 g++，您的编译器可能具有类似的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T11:57:49.477

我已经尝试了几种方法来制作一个可以满足您需求的课程，但我没有成功。您是否考虑过将“返回值”作为通过引用传递的参数？这是我见过的最常见的 API 迫使您注意返回值的方式。所以而不是

```
Error DoThing(); 
```

你有

```
void DoThing(Error& e); 
```

任何调用 DoThing() 的东西都必须传入一个 Error 对象，否则它们会得到编译器错误。同样，不完全是您要求的，但也许足够好？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T00:27:38.867

您可能会发现使用代码分析工具扫描源代码更容易。

这可以让您根据您的要求使用返回类型，或者为要测试的函数使用不同的标记，例如注释以指示应检查哪些函数。

您可以将分析工具作为编译过程的一部分或作为构建服务器的一部分运行。

# windows - 如何在没有 WMI 的情况下枚举远程计算机上的共享文件夹会话（最好在 C# 中）

> ID：12416605
> 
> 赞同：1
> 
> 时间：2012-09-14T00:24:22.533
> 
> 标签：windows

首先请允许我先简要解释一下为什么我必须在没有 WMI 的情况下执行此操作。

我正在尝试列出连接到 EMC Celerra NS20 的所有会话。这个特定的设备允许您使用计算机管理 MMC 管理单元连接到它以查看共享，但我很快发现它*不是*基于 MS Windows 的并且不支持 WMI。

我想在不使用管理单元的情况下执行此操作的原因仅仅是因为我正在尝试创建一个工具来监视一组服务器（其中大部分是 Windows 服务器）之间的会话，以跟踪哪些用户从哪里登录，以及有多少台电脑等。

我已经搜索并广泛阅读了有关 Celerra 公开和 XML API 的信息（我认为这可能是计算机管理控制台使用的）。但是，在运行数据包捕获以查看 Compmgmt.msc 实际来回发送的内容后，它似乎正在使用 SMB2 协议。

所以我想弄清楚是否有：A）一个很好的库，可以用 SMB/Samba 做这种工作（最好是 C#）。B）如果有人知道检索此信息的更好方法。

如果有人对如何做到这一点有很好的想法，但不是在 C# 中，我愿意用任何语言实现它，然后在必要时将其通过管道传输到我的程序中。

我希望我已经清楚地解释了我的问题。非常感谢您对此的任何帮助。谢谢你的时间。

# javascript - 定时器循环时，setInterval 前进到下一个 div

> ID：12416608
> 
> 赞同：0
> 
> 时间：2012-09-14T00:25:35.253
> 
> 标签：javascript, jquery, setinterval

我一直在摆弄这个：

[http://jsfiddle.net/bXJhe/46/](http://jsfiddle.net/bXJhe/46/)

我需要的是在计时器循环后前进到下一个 div id 的时间。我点击“一”，它显示当前的ID，然后它应该前进到“二”，“三”......并显示它们各自的ID。我不想使用 jQuery 的 .remove() 或 .detach()。任何见解都会很棒。

有一个大项目到期，没有头发可以拔掉。

HTML：

```
<span id="bar"></span>
<span id="timer">00:05</span>

<div id="one"><a href="#">one</a></div>
<div id="two"><a href="#">two</a></div>
<div id="three"><a href="#">three</a></div>
<div id="four"><a href="#">four</a></div> 
```

JS：

```
jQuery(document).ready(function() {

    jQuery('div').not(':first').hide();
    jQuery('a').hide();

    timer(5)
});

// Timer
var GLOBAL_TIMER;

function timer(intCount) {
    GLOBAL_TIMER = setInterval(function() {

        var intTickLength = 5;

        jQuery('#bar').css('width', intCount * intTickLength + 'px');
        jQuery('#timer').html('00:0' + intCount--);      

        if (intCount < 0) {

            jQuery('a').show('slow');

             jQuery('a').click(function() {
                 id = jQuery(this).parent('div').attr('id');
                 alert('current id: ' + id);
                 jQuery(this).hide();
                 timer(5);
             });

             stopTimer();
        }

    }, 1000);
}

function stopTimer() {
    clearInterval(GLOBAL_TIMER);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T01:43:03.163

检查并查看[这](http://jsfiddle.net/izaiasdotcom/pKMaC/1/)是否是您需要的：

```
jQuery(document).ready(function() {

    jQuery('div').hide();

    currDiv = jQuery('#one');

    timer(5);
});

// Timer
var GLOBAL_TIMER;

function timer(intCount) {
    GLOBAL_TIMER = setInterval(function() {

        var intTickLength = 5;

        jQuery('#bar').css('width', intCount * intTickLength + 'px');
        jQuery('#timer').html('00:0' + intCount--);

        if (intCount < 0) {

            currDiv.show('slow');

             currDiv.click(function() {
                 id = currDiv.attr('id');
                 alert('current id: ' + id);
                 jQuery(this).hide();

                 currDiv = currDiv.next();
                 timer(5);
             });

             stopTimer();
        }

    }, 1000);
}

function stopTimer() {
    clearInterval(GLOBAL_TIMER);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T01:00:48.060

我认为最简洁的解决方案是使用 jQuery 的`data()`机制将变量附加到 each `<div>`，表示它是下一个要显示的变量。

此外，您的`<a>`元素中有`<div>`元素，有时您会尝试显示/隐藏其中一个……在我看来，始终对同一个元素进行操作会更清楚。我选择了`<div>`元素。

因此，首先您要隐藏所有`<div>`元素：

```
jQuery('div').hide(); 
```

然后你会想指出“一个”`<div>`是下一个要显示的：

```
jQuery('#one').data('nextToBeShown',true); 
```

然后，当您遍历每个元素时（我通过`<div>`s 而不是`<a>`s），您只需要查看它是否是要显示的下一个元素，并显示它：

```
jQuery('div').each(function() {
    current = jQuery(this);
    if( current.data('nextToBeShown') ) {
        current.show('slow');
    }
}); 
```

最后，当您单击链接时，您需要移动“nextToBeShown”指针：

```
jQuery('a').click(function() {
    id = jQuery(this).parent('div').attr('id');
    alert('current id: ' + id);
    div = jQuery(this).parent();
    div.hide();
    div.data('nextToBeShown',false);
    div.next().data('nextToBeShown',true);
    timer(9);
}); 
```

这会让你到达你想要的地方......在这里查看我更新的 jsFiddle：http: [//jsfiddle.net/NjUg2/1/](http://jsfiddle.net/NjUg2/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T01:29:12.873

## *[jsBin 演示](http://jsbin.com/ewayus/9/edit)*

参考我的**[旧答案](https://stackoverflow.com/questions/12335030/setinterval-timer-need-offset-on-animated-progress-bar)**和我的旧**[DEMO](http://jsbin.com/ewayus/5/edit)**给你......

您唯一需要添加的是：

```
////////////// old answer :  
(function($){ // remap "$" to jQuery
$(function(){ // "Document Ready" shorthand

  var divCounter = 0;    ///// added

  function timer(bar, intCount){  
     var elWidth = $(bar).width(), intTickLength=intCount, i;  
     function math(){
       var m = Math.floor(intCount/60);
       var s = intCount % 60;
       if(m<10){m='0'+m;}
       if(s<10){s='0'+s;}
       $(bar).next('.timer').text(m+':'+s);
       $(bar).width( elWidth*intCount/intTickLength );
       if(intCount--<=0){         
         clearInterval(i);
         showDiv();  /////// added
       }
     }
     math();

     i = setInterval(math, 1000);  
  }  
  timer('#bar',5); 
  ////////////////////////////////

  ///////////// new answer :  
  $('div.box').hide();  // hide all initially 
  function showDiv(){
      $('.box').hide().eq(divCounter%$('.box').length).show();
  }

  $('.box a').click(function(e){
      e.preventDefault();
      $('.box').hide();
      divCounter++;
      timer('#bar',5);
  });
  /////////////////////////////

});
})(jQuery); 
```

HTML：**向您的跨度****添加一个类`.timer`**

```
<span id="bar"></span>
<span class="timer">00:05</span> 
```

**并为您的 div 元素添加一个通用 CLASS ：**

```
<div class="box"><a href="#">one</a></div>
<div class="box"><a href="#">two</a></div>
<div class="box"><a href="#">three</a></div>
<div class="box"><a href="#">four</a></div> 
```

如果您有任何问题，请随时提出，不要扯更多头发，而是查看一些旧问题以获得一些解决方案:)

# internet-explorer - 跨帧泄漏的媒体查询

> ID：12416610
> 
> 赞同：14
> 
> 时间：2012-09-14T00:25:47.870
> 
> 标签：internet-explorer, iframe, media-queries

这是一些 HTML：

```
<iframe src="test.html" style="width: 200px; height: 100px;"></iframe>
<iframe src="test.html" style="width: 800px; height: 100px;"></iframe> 
```

该`test.html`页面包含来自外部文件的一些 CSS：

```
<link rel="stylesheet" type="text/css" href="style.css" /> 
```

样式表有：

```
@media all and (max-width: 600px) {
  body {background-color: red;}
} 
```

以上是简化的，但足以证明问题：两页都是红色的，尽管其中一个明显比另一个宽。[演示页面](http://adamhaskell.net/misc/ifrtest/)

是什么赋予了？

（注意：在 IE 和 Chrome 中测试 - Chrome 很好，一帧红色，另一帧白色。）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-20T19:34:45.970

正如您在[此答案](https://stackoverflow.com/questions/10316247/media-queries-fail-inside-ie9-iframe)中所读到的，Internet Explorer 9 支持 CSS3 媒体查询，但当包含媒体查询的 CSS 在外部文件中时，不支持在帧内，因此您应该将媒体查询放在`test.html`页面顶部。以前的 IE 版本本身不支持媒体查询，但您可以使用 javascript 库（请参阅[respond.js](https://github.com/scottjehl/Respond)或[css3-mediaqueries-js](http://code.google.com/p/css3-mediaqueries-js/)）来解决这个问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-19T13:36:27.653

您可以使用带有以下脚本的 jquery 来完成这项工作：

```
<script src="http://code.jquery.com/jquery-1.8.1.min.js"></script>
<script>
    $(document).ready(function() {
        if ($(document).width() < 600) {
            $('body').css('background-color', 'red');
        };
    });
</script> 
```

# php - 使用提交方法将多个Javascript值传递给php isset？

> ID：12416613
> 
> 赞同：0
> 
> 时间：2012-09-14T00:25:51.810
> 
> 标签：php, javascript, forms, submit, setattribute

我在`<select`php/xhtml 页面上有一个元素。我没有使用提交按钮，而是尝试实现 Javascript`onchange()`和`submit()`方法。我需要传递多个变量来弥补丢失的隐藏字段。onchange 和 submit 方法正在触发，但我无法让它触发同一页面上的 PHP isset。

```
<?php
if(isset($_POST['companykey'])){
$nowIveGot1 = $_POST['COMPANYKEY'];
$nowIveGot2 = $_POST['USERNAME'];
?>

<script language="javascript">
function copy(selectedValuePassed, selectedNamePassed, userIDPassed, formNamePassed) { 
var formNameReceived = formNamePassed;
var userIDReceived = userIDPassed;
var selectedValueReceived = selectedValuePassed;
var selectedNameReceived = selectedNamePassed;

var form = document.createElement("form");     
form.setAttribute("method", "post"); 
form.setAttribute("action", ""); 
form.setAttribute("name", formNameReceived);
form.setAttribute("id", formNameReceived);

var valueSelected = document.createElement("input"); 
valueSelected.setAttribute("type", "hidden"); 
valueSelected.setAttribute("name", selectedNameReceived); 
valueSelected.setAttribute("id", selectedNameReceived);
valueSelected.setAttribute("value", selectedValueReceived);
form.appendChild(valueSelected); 

var passusername = document.createElement("input");
passusername.setAttribute("type", "hidden");
passusername.setAttribute("name", "USERNAME");
passusername.setAttribute("id", "USERNAME");
passusername.setAttribute("value", userIDReceived);
form.appendChild(passusername);

document.body.appendChild(form); 
form.submit(); 
} 
</script>

<select onchange="copy(this, 'COMPANYKEY','jarrett', 'companykey');">
  <option value="Text1">Text 1</option>
  <option value="Text2">Text 2</option>
</select> 
```

已解决：为 valueSelected 和 passusername 创建一个父元素。将其命名为 isset 检查名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T00:48:58.333

如果我理解你的问题...

```
<?php
if(isset($_POST['companykey'])){
    $nowIveGot1 = $_POST['COMPANYKEY'];
    $nowIveGot2 = $_POST['USERNAME'];
} 
```

将`$_POST['companykey']`永远存在`null`，`if`条件永远不会执行。

这是因为键值对在`$_POST`附加到`<form>`元素时不会传递到数组中，只有嵌入`<input>`的。

在您的 javascript 中，您将`'companykey'`作为最后一个参数传递给`copy`. 从那里它被分配到`formNameReceived`。然后，您将其分配给`name`表单的属性：

```
form.setAttribute("name", formNameReceived);
form.setAttribute("id", formNameReceived); 
```

`'companykey'`永远不会`$_POST`像这样出现在数组中，它不附加到输入，而是附加到`form`自身。

作为一个普通的 HTML 类似物，想象一下：

```
<? print_r($_POST);?>
<html>
<body>
<form method='post' name='cat' value='dog'>
    <input type='hidden' name='foo' value='bar'/>
    <input type='submit'/>
</form>
</body>
</html> 
```

无论您提交此表单多少次，它都不会包含该`cat -> dog`对。如果要`'companykey'`出现在数组中，则必须将其分配给另一个隐藏的输入。

# javascript - getElementsByClassName 帮助（分配给变量时未捕获的引用错误）

> ID：12416614
> 
> 赞同：2
> 
> 时间：2012-09-14T00:25:52.480
> 
> 标签：javascript

使用普通的“ol vanilla javascript”选择类名时遇到一些问题：

```
var email = document.getElementsByClassName('email');
var phone = document.getElementsByClassName('phone');
// Hide phone by default
phone.style.display = "none";

function showContact() {
    var dropdown = document.getElementById( "contact-select" );        // Get a reference to the dropdown (select) element
    var selectedItemValue = dropdown.options[ dropdown.selectedIndex ].value; // use the dropdown reference to get the selected item's value

    if ( selectedItemValue === "phone" ) {
        email.style.display = "none";
        phone.style.display = "block";
    } else {
        phone.style.display = "none";
        email.style.display = "block";
    }
} 
```

每当我尝试调用其中一个变量时，都会不断收到未定义的错误。任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T00:31:18.277

暗示：

`document.getElementsByClassName`-- 注意是复数。它返回一个`nodeList`或一个`null`。

调试的第一步应该是`console.log(phone)`，看看它有什么价值。

在没有看到您的标记的情况下，我不得不进行一些猜测，但请尝试：

```
var email = document.getElementsByClassName('email')[0];
var phone = document.getElementsByClassName('phone')[0]; 
```

编辑：返回一个`nodeList`类似于数组的，但实际上不是一个数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T00:31:29.587

1.  如果您在旧版本的 IE 中执行此操作，则未定义`getElementsByClassName`您的`email`和`phone`变量。
2.  如果这是在元素之前添加到页面`phone`并`email`加载然后`email`将`phone`是未定义的。
3.  `getElementsByClassName`返回一个节点列表，因此您应该实际定义`email`and `phone`。

代码：

```
var email = document.getElementsByClassName('email')[0];
var phone = document.getElementsByClassName('phone')[0]; 
```

**更新**：或遍历数组：

```
for(var i = 0; i < phone.length; i++)
{
    phone[i].style.display = "none";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T00:31:19.893

`document.getElementsByClassName`返回一个`nodeList`。您可以像访问元素数组一样访问它。

### 编辑：

变成`nodeList`

# c++ - c++ std::map 运行超出范围

> ID：12416615
> 
> 赞同：0
> 
> 时间：2012-09-14T00:25:57.470
> 
> 标签：c++, map

我正在解决 SPOJ 问题[FLIB](http://www.spoj.pl/problems/FLIB/)，我已经尝试使用这样的地图来实现它 -

```
long long FiboSum(long long n) {
    if(n==1||n==0) return n;
    if(fiboDict.count(n)) return (long long) fiboDict.at(n);
    if(n%2==0) { 
        //calculate term -- value to that key
        fiboDict.insert(pair<long,long>(n,term));
    }
    else { 
        //calculate term
        fiboDict.insert(pair<long,long>(n,term));
    }
    return (long long) fiboDict.at(n);
} 
```

`fiboDict`是地图，但问题需要我计算，`( 0 <= n < 2^51)`但 KEY 值不能保持这么高的值，我得到错误

```
terminate called after throwing an instance of 'std::out_of_range' what():  
map::at 
```

我怎样才能让它保持大的价值？或者如果有其他选择，请提出建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T00:32:21.187

你为什么不制作地图：

```
pair<long long,long long> 
```

然后？

# java - 为什么查询 Androids MediaStore 返回空光标？

> ID：12416623
> 
> 赞同：3
> 
> 时间：2012-09-14T00:26:56.867
> 
> 标签：java, android, api, video, mediastore

我正在使用 Android 的 MediaStore 来检索我用我的应用程序录制的视频文件的持续时间/日期。它适用于较旧的文件，但我记录的最新文件确实返回空（非空）光标。我不明白为什么会发生这种情况，是 MediaStore 没有立即更新还是我在下面使用的代码有问题？谢谢你的帮助！

```
Uri uri = MediaStore.Video.Media.EXTERNAL_CONTENT_URI;
String selection = MediaStore.MediaColumns.DISPLAY_NAME + " LIKE '"+file.getName()+"'";
Cursor cursor = getContentResolver().query(uri, new String[]{MediaStore.Video.VideoColumns.DATE_TAKEN,MediaStore.Video.VideoColumns.DURATION}, selection, null, null); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-13T07:17:32.750

我也面临同样的问题。打印堆栈跟踪解决了这个问题。请在清单中添加此权限：

```
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T01:29:15.797

似乎 MediaScanner 尚未将最新文件扫描到 MediaStore 中。如果外部存储中有新文件，则必须触发。

```
sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED, Uri.parse("file://"
                            + Environment.getExternalStorageDirectory()))); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-25T06:08:01.880

检查以确保插入您的 Android 设备不会干扰外部存储。如果您的手机安装为 USB 存储设备，那么您将无法直接访问外部存储设备中的文件。您可以通过在手机连接到计算机时打开图库来检查这一点。

我刚刚开发了一个必须访问手机上所有图片的应用程序，它在手机插入时不起作用。但是，如果我拔掉它就可以了。

# cmd - “使用 echo 命令和重定向运算符创建一个名为“test.txt”的文件，其唯一内容是“Hello world”。”

> ID：12416627
> 
> 赞同：0
> 
> 时间：2012-09-14T00:27:50.367
> 
> 标签：cmd

我遇到了这个问题

> 使用 echo 命令和重定向运算符创建一个名为“test.txt”的文件，其唯一内容是“Hello world”。

我不明白它要我做什么或如何去做。在继续之前需要这样做。我看了所有的问题，这是我唯一不明白的一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T02:58:01.393

运行 cmd，然后在提示符下键入：

```
echo Hello World>test.txt 
```

# ubuntu - Cuda SDK运行deviceQuery的问题

> ID：12416629
> 
> 赞同：0
> 
> 时间：2012-09-14T00:27:53.920
> 
> 标签：ubuntu, cuda

我昨天编译了 sdk 示例，我也运行了其中的一些示例。但是今天我试图通过发出 ./deviceQuery 命令来运行 deviceQuery 并在 ~/NVIDIA_GPU_Computing_SDK/C/bin/linux/release 文件夹中，它显示：

```
 ./deviceQuery: error while loading shared libraries: libcudart.so.4: cannot open shared object file: No such file or directory 
```

有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T04:05:05.267

你设置环境变量了吗？导出 LD_LIBRARY_PATH=/usr/local/cuda-5.0/lib:/usr/local/cuda-5.0/lib64:$LD_LIBRARY_PATH

详情请参考 CUDA_Getting_Started_Guide_For_Linux。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T10:39:39.250

设置CUDA的路径环境

```
goto /etc/

$ gksudo gedit environment 
```

在那里你可以看到 PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games"

类似的东西，，，只需附加以下内容

```
:/usr/local/cuda/bin" 
```

保存并退出编辑器

重新加载路径

```
 source environment 
```

现在设置 LD_LIBRARY_PATH: （位于 /etc/ 目录本身）

```
 $ gksudo gedit ld.so.conf.d/cuda.conf 
```

（创建一个新文件）将以下内容粘贴到文件中

```
 /usr/local/cuda/lib64
  /usr/local/cuda/lib 
```

保存并退出编辑器重新加载 LD_LIBRARY_PATH

```
$ sudo ldconfig 
```

现在运行示例。

# groovy - Groovy cast 行为不一致

> ID：12416631
> 
> 赞同：3
> 
> 时间：2012-09-14T00:28:36.343
> 
> 标签：groovy

我今天遇到了一段糟糕的代码，相当于：

```
[["asdf"]].each {String str -> println str}

println (["asdf"] as String) 
```

把它放到 groovy 控制台 ( `groovysh`) 中，你会看到这个结果：

```
asdf

[asdf] 
```

谁能解释为什么输出有差异？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T09:22:41.480

如果这意味着它适合您在闭包中定义的类型，Groovy 将打开一个 List。

如果您没有定义类型（或将其设置为 List），它将按照您的预期运行：

```
// Both print '[a]'
[['a']].each { it -> println it }
[['a']].each { List it -> println it } 
```

但是，如果您定义了一个类型，它将尝试解开列表并将内容应用于定义的参数，因此：

```
// Prints 'a'
[['a']].each { String it -> println it } 
```

把它想象成 java 中的可变参数，或者`closure( *it )`在 Groovy 中调用闭包

它实际上非常有用，因为您可以执行以下操作：

```
// Tokenize the strings into 2 element lists, then call each with these
// elements in separate variables
['a=b', 'b=c']*.tokenize( '=' )
               .each { key, value ->
  println "$key = $value"
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T03:48:13.927

**第一个输出**

我不确定，但似乎 Groovy 会尝试将闭包应用于列表的单个元素，如果只有一个元素。

请注意：

```
[["asdf"]].each {String str -> println str } 
```

相当于：

```
Closure c = { String s -> println s }
c(["asdf"]) 
```

并且这些测试表明了经验证据：

```
Closure c = { String s -> println s }

println "c test"
try { c(["asdf","def"]) } catch(Exception ex) { println "no" }
try { c(123) } catch(Exception ex) { println "no" }
try { c([]) } catch(Exception ex) { println "no" }
// this works:
try { c(["asdf"]) } catch(Exception ex) { println "no" }

Closure d = { Integer i -> println i }

println "d test"
try { d([22,33]) } catch(Exception ex) { println "no" }
try { d("abc") } catch(Exception ex) { println "no" }
try { d([]) } catch(Exception ex) { println "no" }
// this works:
try { d([22]) } catch(Exception ex) { println "no" } 
```

**第二个输出**

只需注意这一点：

```
println (["asdf"] as String) 
```

可能等同于：

```
List<String> list = ["asdf"]
println list.toString() 
```

# c# - 屏幕抓取和控制第 3 方 .NET 应用程序

> ID：12416632
> 
> 赞同：0
> 
> 时间：2012-09-14T00:28:43.377
> 
> 标签：c#, reflection, hook, screen-scraping, ui-automation

**问题：**

在正在运行的 3rd 方应用程序中从 .Net UI 控件中获取文本并将输入发送到所述应用程序的最佳方法是什么？由于部署限制，目标平台范围从 XP 到 Win7。我们可以使用的最大 .NET 版本是 3.5。

**背景：**

我的团队的任务是与我们行业中广泛使用的遗留应用程序集成。此集成需要从 3rd 方应用程序的 UI 读取数据并在某些情况下按下该应用程序 UI 上的按钮。

我们得到了第 3 方应用程序开发人员的支持，但他们没有执行这些功能的 API。

我们之前已经通过 api hooks 使用普通的 win32 应用程序成功地做到了这一点，但在 .net 中没有。

我觉得我应该重申：我们对相关应用程序中可能的 UI 状态有深入的了解；如果没有这么深的知识，显然这里有各种各样的陷阱。

我主要是好奇其他人在这里做了什么。有什么建议或指示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T14:53:15.237

我推荐[MS UI 自动化](http://msdn.microsoft.com/en-us/library/ms747327%28v=vs.90%29.aspx)。

尝试使用[UI Spy](http://msdn.microsoft.com/en-us/library/ms727247%28v=vs.90%29.aspx)调查您的应用程序。如果您在 UI Spy 中看到足够的信息来完成工作，那么它应该适合您。API 并不容易上手，但我建议避开构建在它之上的框架，以使事情变得更容易。这些框架中的大多数都存在性能或其他问题。

如果您需要在应用程序中操作非常复杂的控件（例如来自 Infragistics 的控件），那么您需要保留在 .NET 3.5 上的事实可能是个问题。[使用LegacyIAccessible Control Pattern](http://msdn.microsoft.com/en-us/library/windows/desktop/ee671281%28v=vs.85%29.aspx)最好使用 UI 自动化核心来操作最复杂的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:48:19.180

这是基于网络的吗？如果是这样，请查看 iMacros。

# mysql - rails server eventmachine 段错误

> ID：12416633
> 
> 赞同：0
> 
> 时间：2012-09-14T00:28:43.457
> 
> 标签：mysql, ruby-on-rails, eventmachine

执行 >rails server 产生：

```
C:/Ruby193/lib/ruby/gems/1.9.1/gems/eventmachine-1.0.0.beta.4.1-x86-mingw32/lib/ 
```

eventmachine.rb:179: [BUG] 分段错误

除了谷歌我什么都没有

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T12:59:00.267

windows 上最新的 ruby​​ 版本 (>= 1.9.3) 存在一些问题（与 FD 的数量有关）。尝试将 eventmachine 更新到 1.0.0 stable，它应该可以解决您的问题。

# c - 如何在C中创建最低有效位设置为1的掩码

> ID：12416639
> 
> 赞同：16
> 
> 时间：2012-09-14T00:29:49.573
> 
> 标签：c, bit-manipulation, bitmask

有人可以向我解释一下这个功能吗？

最低有效 n 位设置为 1 的掩码。

前任：

n = 6 --> 0x2F, n = 17 --> 0x1FFFF // 我一点也不明白，尤其是 n = 6 --> 0x2F

还有，什么是口罩？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-14T00:35:37.307

通常的方法是取 a `1`，并将其向左移动`n`。这会给你类似的东西：`00100000`. 然后从中减去一个，这将清除已设置的位，并设置所有次要有效位，因此在这种情况下，我们将得到：`00011111`。

掩码通常用于按位运算，尤其是`and`. 您将使用上面的掩码自己获取 5 个最低有效位，与可能存在的任何其他内容隔离。这在处理通常具有单个硬件寄存器的硬件时尤其常见，该寄存器包含表示许多完全独立的、不相关的数量和/或标志的位。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-14T00:45:31.557

掩码是一个整数值的常用术语，它与另一个整数值按位与、或、异或等。

例如，如果您想提取一个 int 变量的 8 个最低有效数字，您可以使用`variable & 0xFF`. 0xFF 是一个掩码。

同样，如果您想设置位 0 和 8，您可以这样做`variable | 0x101`，其中 0x101 是掩码。

或者，如果您想反转相同的位，您可以这样做`variable ^ 0x101`，其中 0x101 是掩码。

要为您的情况生成一个掩码，您应该利用一个简单的数学事实，即如果您将 1 添加到您的掩码（掩码的所有最低有效位都设置为 1，其余位设置为 0），您将获得一个值为2.

所以，如果你生成最接近的 2 的幂，那么你可以从中减去 1 来得到掩码。

使用 C中的左移`<<`运算符很容易生成 2 的正幂。

因此，`1 << n`产生 2 ^n。在二进制中，它是 10...0 和`n`0。

`(1 << n) - 1`将产生一个`n`最低位设置为 1 的掩码。

现在，您需要注意左移时的溢出。在 C（和 C++）中，您不能合法地将变量左移尽可能多的位位置，因此如果 int 是 32 位，则`1<<32`结果为`undefined behavior`. 还应避免有符号整数溢出，因此应使用无符号值，例如`1u << 31`.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-06-29T19:36:40.953

由于现代 x86 处理器（特别是 BLSMSK）中 BMI 指令的出现，自 2012 年问及这个问题以来，实现这一点的最佳方法已经改变。

这是解决此问题的好方法，同时保持与旧处理器的向后兼容性。

这种方法是正确的，而当前的最佳答案在极端情况下会产生未定义的行为。

当允许使用 BMI 指令进行优化时，Clang 和 GCC 会将 gen_mask() 压缩为两个操作。使用支持硬件，请务必为 BMI 指令添加编译器标志： `-mbmi -mbmi2`

```
#include <inttypes.h>
#include <stdio.h>

uint64_t gen_mask(const uint_fast8_t msb) {
  const uint64_t src = (uint64_t)1  << msb;
  return (src - 1) ^ src;
}

int main() {
  uint_fast8_t msb;
  for (msb = 0; msb < 64; ++msb) {
    printf("%016" PRIx64 "\n", gen_mask(msb));
  }
  return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-04-29T10:52:17.130

首先，对于那些只想要代码来创建面具的人：

```
uint64_t bits = 6;
uint64_t mask = ((uint64_t)1 << bits) - 1;
# Results in 0b111111 (or 0x03F) 
```

对于那些想知道面具是什么的人：

掩码通常是值的名称，我们使用它来使用按位运算（如 AND、OR、XOR 等）来操作其他值。

短掩码通常以二进制表示，我们可以明确地看到所有设置为 1 的位。

较长的掩码通常以十六进制表示，一旦掌握它就很容易阅读。

[您可以在此处](https://en.wikipedia.org/wiki/Bitwise_operations_in_C)阅读有关 C 中的按位运算的更多信息，以便更好地掌握材料。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T00:38:00.763

我相信你的第一个例子应该是`0x3f`.

`0x3f``63`是二进制数字的十六进制表示法`111111`，因此最后 6 位（最低有效 6 位）设置为`1`.

下面的小 C 程序将计算正确的掩码：

```
#include <stdarg.h>
#include <stdio.h>

int mask_for_n_bits(int n)
{
    int mask = 0;

    for (int i = 0; i < n; ++i)
        mask |= 1 << i;

    return mask;
}

int main (int argc, char const *argv[])
{
    printf("6: 0x%x\n17: 0x%x\n", mask_for_n_bits(6), mask_for_n_bits(17));
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-14T00:38:35.050

`0x2F`是`0010 1111`二进制的 - 这应该是`0x3f`，它是`0011 1111`二进制的并且设置了 6 个最低有效位。

同样，`0x1FFFF`是`0001 1111 1111 1111 1111`二进制的，它设置了 17 个最低有效位。

“掩码”是一个值，它旨在使用按位运算符（如 ）与另一个值组合`&`，`|`或者`^`单独设置、取消设置、翻转或保持其他值中的位不变。

例如，如果您使用运算符将​​掩码`0x2F`与某个值组合，则结果将在除 6 个最低有效位之外的所有位中都为零，并且这 6 个位将从 value 中原样复制。`n``&``n`

在掩码的情况下，`&`掩码中的二进制`0`表示“无条件地将结果位设置为 0”，a`1`表示“将结果位设置为输入值位”。对于`|`掩码，掩码中的 an`0`将结果位设置为输入位，a`1`无条件地将结果位设置为`1`，对于`^`掩码，`0`将结果位设置为输入位，a`1`将结果位设置为输入位。

# php - 如何取消链接文件以在 symfony2 中删除

> ID：12416640
> 
> 赞同：1
> 
> 时间：2012-09-14T00:29:52.897
> 
> 标签：php, symfony

我在删除实体时使用此代码删除图像

```
 /**
     * @ORM\PostRemove()
     */
    public function removeUpload()
    {
        if ($this->filenameForRemove)
        {
            unlink ( $this->filenameForRemove );
        }
    } 
```

但问题是，如果我没有图像，那么它会抛出这样的异常

```
Warning: unlink(/home/site/../../../../uploads/50343885699c5.jpeg) [<a href='function.unlink'>function.unlink</a>]: No such file or directory i 
```

如果文件不存在或目录不存在，是否有任何方法应该跳过此步骤并仍然删除实体

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T00:33:05.310

您可以使用[`file_exists`](http://php.net/file_exists)它来确保文件确实存在并[`is_writable`](http://php.net/is_writable)确保您有权删除它。

```
if ($this->filenameForRemove)
{
    if (file_exists($this->filenameForRemove) &&
        is_writable($this->filenameForRemove))
    {
        unlink ( $this->filenameForRemove );
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-29T15:06:52.547

# 更新

Symfony 引入了文件系统组件。[您可以在此处](https://symfony.com/doc/current/components/filesystem.html)查看文档。它说：`The Filesystem component provides basic utilities for the filesystem.`

例如，您可以在删除文件之前检查文件路径/目录是否存在，如下所示：

```
use Symfony\Component\Filesystem\Filesystem;

$filesystem = new Filesystem();
$oldFilePath = '/path/to/directory/activity.log'

if($filesystem->exists($oldFilePath)){
    $filesystem->remove($oldFilePath); //same as unlink($oldFilePath) in php
} 
```

# git - 臭名昭著的 Git 错误：远程拒绝（锁定失败）

> ID：12416643
> 
> 赞同：32
> 
> 时间：2012-09-14T00:30:28.937
> 
> 标签：git, github

我正在尝试将分支从本地推送到原点。分支名称和路径相同。我已经从这个分支推拉了一段时间，从来没有遇到过问题。但突然间，它开始表现得很糟糕。上次我尝试使用以下命令推送到原点时：

```
git push origin feature/Prizefulfilment 
```

它给了我以下错误：

```
72c6c1da98e5cff4484e254a538d9e3b472156ff but expected 0000000000000000000000000000000000000000 
```

我用谷歌搜索了一遍，但还没有找到一个非常令人满意的解决方案。

我的确切错误如下所示：

```
$ git push origin feature/Prizefulfilment
Counting objects: 126, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (75/75), done.
Writing objects: 100% (78/78), 8.83 KiB, done.
Total 78 (delta 61), reused 0 (delta 0)
error: Ref refs/heads/feature/Prizefulfilment is at 72c6c1da98e5cff4484e254a538d9e3b472156ff but expected 0000000000000000000000000000000000000000
remote: error: failed to lock refs/heads/feature/Prizefulfilment
To git@devtools.contestfactory.com:OpusOneSCRUM
 ! [remote rejected] feature/Prizefulfilment -> feature/Prizefulfilment (failed to lock)
error: failed to push some refs to 'git@devtools.contestfactory.com:OpusOneSCRUM'` 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-14T05:55:48.737

```
 git push feature/prizeFulfilment: feature/Prizefulfilment 
```

这类似于[这个答案](https://stackoverflow.com/a/5169488/6309)：

> 作为记录，我认为这个问题的根本原因是**本地和远程分支名称之间的大小写不同**，以及托管远程存储库的 Windows 共享的不区分大小写的性质。
> 
> 我们刚刚遇到了这个完全相同的错误，并且能够通过重命名本地分支以匹配现有远程分支的大小写来解决问题。

尝试并确保**在本地和远程分支之间使用相同的大小写**。

您的第二个命令使`prizeFulfilment`远程和远程之间的链接`Prizefulfilment`显式，这就是它起作用的原因。但是，让本地分支机构保持这种差异并不是一个好的解决方案。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-02-08T17:23:31.773

我看到这个错误发生是因为以前的分支与我的新分支路径名称同名。例子：

*   远程有分支：`some_feature`
*   本地有分支：`some_feature/some_subfeature`
*   本地将分支推`some_feature/some_subfeature`送到远程
*   远程有错误：`(failed to lock)`

解决方案：

*   将本地分支重命名`some_feature/some_subfeature`为`foo/some_subfeature`
*   删除远程分支`some_feature`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-08-26T20:28:56.860

发生在我身上的是 git 正在改变我本地分支的大小写。我有一个名为 Feature/blahBlah 的旧分支和一个名为 feature/fooBar 的新分支。后者自动重命名为 Feature/fooBar 因为 git 将分支存储为文件夹，我不能使用不同大小写的相同文件夹名称。

要修复它，我必须**进入 .git/refs/heads 并将“Feature”重命名为“feature”**，以便所有分支都保持一致。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-09-08T08:46:59.203

在区分大小写的系统上也存在问题的另一个可能原因是冲突名称。

如果远程存储库包含分支`a/b`并且您正在尝试推送分支`a/b/c`，则 git 将报告相同的错误（肯定应该改进此错误描述）。

[https://coderwall.com/p/qkofma/a-caution-about-git-branch-names-with-s](https://coderwall.com/p/qkofma/a-caution-about-git-branch-names-with-s) [https://ocroquette.wordpress.com/2011/07/10/git-failed-to-lock /](https://ocroquette.wordpress.com/2011/07/10/git-failed-to-lock/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-03-13T08:52:55.563

就我而言，这是在 git 存储库中未正确设置权限。我在这里找到了解决方案：[如何在 git 存储库上正确使用组文件权限？](https://stackoverflow.com/questions/4832346/how-to-use-group-file-permissions-correctly-on-a-git-repository)

问题是当创建一个包含路径（功能/Prizefulfilment）的新分支时，在“refs/heads/”中创建文件夹“feature”，并且新文件夹继承了用户组 ID，这会阻止未来用户使用相同的路径。

要解决这个问题，您必须将 setgid 设置为 git 存储库中的所有目录，以便新文件夹继承其组 ID，而不是用户的组 ID。

```
chown -R git:git /path/to/repo
chmod -R g+rw /path/to/repo
find /path/to/repo -type d -print0 | xargs -0 chmod g+s 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-18T20:22:40.313

在我的情况下，我结帐了一个全小写字母的分支。这导致远程分支和本地分支名称不一致。

远程分支是 INT-4368-some-feature-details，而本地分支是 int-4368-some-feature-details。

为了解决这个问题，我进入了 .git\refs\heads\feature 并重命名了分支名称以匹配远程。然后去命令行运行

```
git checkout INT-4368-some-feature-details 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-02-03T06:10:08.170

当您收到这样的消息时，首先从远程分支执行拉取操作。然后执行推送操作。当有人将文件推送到远程服务器时，它会将主分支（如果远程分支是主分支，它可以是任何名称）转移到某个其他地方。您需要在本地存储库中更新它，以便本地存储库中的 origin/master 向前移动。然后在本地存储库中添加文件并提交它。然后执行推送操作。它对我有用

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2019-07-24T09:13:38.890

本地和远程仓库的分支名称在大小写方面不匹配，您可以使用以下命令重命名本地分支：-

```
git branch -m new-name 
```

# jpa-2.0 - 在 JPA 中如何定义可以存储 CLOB 或 BLOB 的表列

> ID：12416650
> 
> 赞同：0
> 
> 时间：2012-09-14T00:31:22.483
> 
> 标签：jpa-2.0, eclipselink

我正在定义一个只为用户存储文档对象的实体。有时对象是二进制 (BLOB)，例如 PNG 或 JPG 图像，有时它是基于字符的，例如 RTF 文本文件或 MIME text/* 类型。所有文档在同一个名称空间中都有一个唯一的 ID。属性大致是这样的：

```
@Id private long id;
@Column private String type;
@Lob private byte [] rawData; 
```

现在我可以提供一些访问器方法来按需将 rawData 从 byte [] 转换为 String，但是有没有一种技术可以避免字符数据的频繁转换步骤？请注意，我也不希望 JPA 提供程序这样做——我想使用一个表列来存储字符数据或二进制数据，当它被注入实体实例时，转录开销最小或没有。

我想我应该能够像这样编写一个基类和两个子类：

```
@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name = "TYPE", discriminatorType = DiscriminatorType.STRING)
public class Document {
    @Id private long id;
    @Column private String type;
}

@Entity
@DiscriminatorValue("binary")
public class BinaryDocument extends Document {
    @Column @Lob private byte [] binaryData;
}

@Entity
@DiscriminatorValue("text")
public class TextDocument extends Document {
    @Column @Lob private String textData;
} 
```

（为简洁起见，省略了访问器方法）

如果我理解这一点，我最终会得到一个包含两个 @Lob 列**binaryData**和**textData**的表。有没有办法让它们成为同一列？

还是我应该关心？拥有两列（类的每个实例中只使用其中一列）的空间需求是否最小？

还是我应该采取完全不同的方法？我愿意接受建议，因为我还没有花太多时间编写这个。

# php - 如何在欧盟地区创建存储桶？

> ID：12416655
> 
> 赞同：1
> 
> 时间：2012-09-14T00:31:47.683
> 
> 标签：php, rest, google-cloud-storage

我正在尝试使用 PHP 和 REST 在谷歌云存储上创建一个存储桶。我可以在美国地区很好地创建存储桶，但似乎无法在欧盟地区创建存储桶。

这就是我正在做的 -

```
function createBucket($accessToken, $bucket, $region)
{
    $version_header = "x-goog-api-version: 2";
    $project_header = "x-goog-project-id: ".$this->projectID;
    $url = 'https://'.$bucket.'.commondatastorage.googleapis.com';
    $timestamp = date("r");
    define('XML_PAYLOAD','<xml version=\'1.0\' ? ><CreateBucketConfiguration><LocationConstraint>'.$region.'</LocationConstraint></CreateBucketConfiguration>');

    $headers = array(
                'Host: '.$bucket.'.commondatastorage.googleapis.com',
                'Date: '.$timestamp, 
                $version_header,
                $project_header, 
                'Content-Length: 0',
                'Authorization: OAuth '.$accessToken);

    $c   = curl_init($url);
    curl_setopt($c, CURLOPT_HEADER, 1);
    curl_setopt($c, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($c, CURLOPT_HTTPHEADER,$headers);
    curl_setopt($c, CURLOPT_POSTFIELDS,XML_PAYLOAD);
    curl_setopt($c, CURLOPT_CUSTOMREQUEST, "PUT");
    $response = curl_exec($c);
    curl_close($c);

    // split up the response into header and xml body
    list($header, $xml) = explode("\r\n\r\n", $response, 2);
    // tokenize - first token is the status
    $status = strtok($header, "\r\n"); 

    if(stristr($status,"200 OK"))
    {
        //success
        $result = "success";
    }
    else
    {
        //failed
        $result = "fail";
    }

    return $result;
} 
```

此功能适用于美国桶，但在欧盟的情况下失败。我确保为存储桶生成的名称是唯一名称（相同的模式适用于美国存储桶）。

**编辑：**实际上该功能没有失败，它确实创建了一个存储桶......尽管指定了欧盟地区，但它只是在美国地区创建了存储桶。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T01:07:20.677

你怎么判断它是否成功？gsutil -L?

我只是使用 gsutil 指定位置并使用 -DD 转储请求的内容，并注意到在请求正文中发送的 XML 文档不包含 XML 标头。接下来，我尝试使用 curl 使用类似的无标题 XML 文档来制定 REST 请求，它对我来说效果很好。接下来，我再次尝试使用 XML 标头 curl 并失败并出现以下错误：

> 您提供的 XML 格式不正确或未针对我们发布的架构进行验证。

您可以在没有 XML 标头的情况下重试您的 PHP 代码，看看是否有帮助？如果是这样，我可以为此提交一个错误。

# box-api - v2 上传 API 是否处理 100-continue？

> ID：12416658
> 
> 赞同：3
> 
> 时间：2012-09-14T00:31:53.750
> 
> 标签：box-api

我最近注意到上传大文件时，Box 似乎在上传完成之前没有响应错误。我正在设置`Expect: 100-continue`我的请求标头，但似乎 Box 服务器忽略了它。

我错了，还是有什么方法可以让 Box 服务器尊重我的`Expect: 100-continue`标题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T22:41:27.963

我们目前不支持`100-continue`，但很明显这对 API 客户端非常有帮助。我们目前专注于[将 v2 API 导入 GA](https://stackoverflow.com/a/10824276/1154983)，之后我们将能够添加对`100-continue`.

# objective-c - 使用 avaudioplayer、UITableView NSURL 加载和播放音频

> ID：12416659
> 
> 赞同：0
> 
> 时间：2012-09-14T00:32:08.847
> 
> 标签：objective-c, ios, avfoundation, nsdata, nsurl

我有一个音频对象的表格视图，每个对象都有一个 url 属性。我正在寻找最快的方式（对于用户）来播放每个音频文件。

我尝试先从 url 获取数据：

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSURL *audioURL = [NSURL URLWithString:(NSString *)[[[self.objects objectAtIndex:indexPath.row] objectForKey:@"audioFile"] url]];
    NSData *audioData = [NSData dataWithContentsOfURL:audioURL];
    NSError *error;

    self.player = [[AVAudioPlayer alloc] initWithData:audioData error:&error];
    self.player.delegate = self;
    [self.player play];
} 
```

但它很慢而且反应迟钝。我试图直接访问网址：

```
self.player = [[AVAudioplayer alloc] initWithContentsOfURL:audioURL] 
```

在这种情况下加载和播放音频文件的最佳方式是什么？异步获取数据？AVfoundation 是流式传输音频的最佳方式吗？

[http://developer.apple.com/library/ios/#documentation/MusicAudio/Reference/AudioStreamReference/Reference/reference.html#//apple_ref/doc/uid/TP40006162](http://developer.apple.com/library/ios/#documentation/MusicAudio/Reference/AudioStreamReference/Reference/reference.html#//apple_ref/doc/uid/TP40006162)

我应该尝试流式传输吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T01:14:12.570

最快的方法是这样设置音频服务

```
CFBundleRef mainbundle = CFBundleGetMainBundle();
CFURLRef soundFileURLRef = CFBundleCopyResourceURL(mainbundle, CFSTR("soundhere"), CFSTR("extensionofsound"), NULL);
AudioServicesCreateSystemSoundID(soundFileURLRef, &soundFileObject); 
```

如果您坚持不使用 AudioServices，那么您可以查看 OpenAL（Github for iOS 上有包装器）

# android - Android Drawables 不刷新

> ID：12416661
> 
> 赞同：4
> 
> 时间：2012-09-14T00:32:11.410
> 
> 标签：android, drawable

我最近有一个让我发疯的问题......

我有一个充满可绘制资产（背景、图像等）的应用程序。在更大的设备上进行测试后，我发现一些drawables太小并且被拉伸了。然后，我决定制作更高质量的版本，然后在可绘制文件夹中替换它们。在设备上启动应用程序后，我注意到可绘制对象没有刷新，将应用程序留在旧的。我试图卸载该应用程序，没有区别...在我再次安装后，该应用程序带有所有旧的东西而不是新的东西。

怎么了？:|

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T00:39:35.843

尝试 Project/Clean，然后部署您的应用程序。如果问题仍然存在，另一种可能是您没有将 /drawable 拆分为 /drawable-hdpi、/drawable-ldpi、/drawable-mdpi、/drawable-xhdpi。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T00:41:04.320

尝试刷新可绘制文件夹（右键单击它-> 刷新）如果这没有帮助，请临时设置对另一张图片的引用运行您的应用程序。然后退出它并设置对正确图片的引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-11T01:08:43.677

如果 Clean Project 对您不起作用，请尝试`File > Invalidate Caches / Restart`- 这对我有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-01T22:06:53.903

这些解决方案都不适合我。

在我重命名文件并更改对代码中可绘制对象的引用之后，它就起作用了。

# internet-explorer - 如何在默认情况下以 IE7 模式打开 Internet Explorer 9？

> ID：12416663
> 
> 赞同：6
> 
> 时间：2012-09-14T00:32:23.747
> 
> 标签：internet-explorer, selenium, internet-explorer-7, webdriver

我想将我的 IE 设置为始终以 IE7 模式打开。

我主要在 Chrome 中进行开发，出于效率和 80/20 原则的目的，我假设 IE9 的外观和行为大多类似于 Chrome。

而且我假设如果某些东西在 IE7 中看起来和工作得足够好，那么大部分时间 IE8 会很好。

所以我只希望我的 Internet Explorer 始终以版本 7 的形式打开，而无需在开发人员面板中进行更改。

这对于我想在 IE7 中运行的 Selenium WebDriver 功能测试也很有用。

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T18:31:03.517

我刚刚找到[http://www.makeuseof.com/tag/internet-explorer-google-chrome-tab/](http://www.makeuseof.com/tag/internet-explorer-google-chrome-tab/)它似乎默认以 IE7 模式打开。

仍然有一个警告（当然），这个假的 IE7 与 IE7 的本机安装不同。但这可能是一个不错的权衡。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T00:38:06.133

这些元标记对你有用吗？

```
<!-- Force IE9 to IE8 compatibility mode -->
<meta http-equiv="X-UA-Compatible" content="IE=8" />
<!-- Force IE9 to IE7 compatibility mode -->
<meta http-equiv="X-UA-Compatible" content="IE=7" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T13:20:21.200

评论者是对的——你不应该假设 Chrome 的行为与 IE9、IE7 或任何东西相同。此外，在兼容性视图中运行的 IE9（无论是从开发人员工具中设置还是从兼容性视图设置中设置）都不能指望与 IE7 一样。

但是，如果您希望 IE9 始终在兼容性视图中启动，只需在浏览器的选项中进行设置（兼容性视图设置中的底部复选框）。

# css - 使用 CSS3 转换的（如果有的话）缺点是什么：为响应式标题缩放文本？

> ID：12416665
> 
> 赞同：5
> 
> 时间：2012-09-14T00:33:21.810
> 
> 标签：css, responsive-design, media-queries

我有一个非常精致的标题，它使用 lettering.js 来设置每个字母的样式。

使用媒体查询更改文本大小将迫使我分别更改其他方面，例如`top`, 和`right`（相对）位置以及旋转和其他样式。

我发现在 webkit 中`transform: scale()`效果很好，并且可以缩放设计的所有方面，而不仅仅是字体大小。

其他浏览器是否存在导致此问题的错误解决方案的错误？它似乎有相当好的[浏览器支持](http://caniuse.com/transforms2d)，但我担心其他浏览器和渲染引擎上的错误和像素化。

使用 CSS3 转换的（如果有的话）缺点是什么：为响应式标题缩放文本？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-14T01:35:10.307

我能想到的问题有两个：

1.  该元素仍将占用文档中的原始大小，因此您可能需要使用负边距来处理它。这是一个演示：http: [//jsfiddle.net/joshnh/MwMYT/](http://jsfiddle.net/joshnh/MwMYT/)
2.  一些浏览器不能很好地渲染缩放元素。Chrome 因这一点而臭名昭著（尽管它在转换元素的比例时最为明显）。不过他们越来越好了！

话虽如此，我认为您提出的解决方案是一个合理的解决方案，并且缺点肯定是可以控制的！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-14T00:43:27.397

除了浏览器支持之外，我认为没有任何其他功能。`CSS transform`很好，因为它是硬件加速的，所以它更快，更流畅。

# silverlight-4.0 - silverlight-4 com-interop 无法调用非委托类型

> ID：12416669
> 
> 赞同：1
> 
> 时间：2012-09-14T00:33:33.173
> 
> 标签：silverlight-4.0, com-interop, wsh

此 silverlight 代码引发错误“无法调用非委托类型”

```
 var WshShell = AutomationFactory.CreateObject("WScript.Shell");
        var WshSysEnv = WshShell.Environment("SYSTEM");
        var foo = WshSysEnv("APPDATA"); 
```

如何获取环境变量？

**编辑：**
@paulsm4 - 这适用于 Silverlight...

```
 var WshShell = AutomationFactory.CreateObject("WScript.Shell");
        var appData = WshShell.ExpandEnvironmentStrings("%APPDATA%");
        MessageBox.Show(appData); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:43:27.023

假设 WSH，这样的事情怎么样：

```
Set wshShell = CreateObject( "WScript.Shell" )
WScript.Echo wshShell.ExpandEnvironmentStrings( "%APPDATA%" )
wshShell = Nothing 
```

# xcode - Xcode 4，如何使其他按钮在按下后从屏幕上脱落。

> ID：12416672
> 
> 赞同：0
> 
> 时间：2012-09-14T00:33:53.297
> 
> 标签：xcode, ibaction, gravity

例如，我声明了 5 个 IBAction。当我按下一个时，我希望另外 4 个从屏幕上掉下来。知道怎么做吗？我会为其他 IBAction 定义翻译吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T00:39:45.460

UIButton 是 UIView。您可以为 UIView 的移动设置动画；该移动可以是到屏幕外的位置。（请参阅 UIView 类参考中“动画”下的部分：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)）然后您*可能*想要删除他们的超级视图中现在不可见的按钮（在这种情况下，您需要以某种方式保留它们，否则它们可能不复存在），但您不必这样做。

您将需要一种方法来引用 UIButton。您可以为此使用 IBOutlets，或者您可以在 Interface Builder 中“标记”按钮并使用它`-[UIView viewWithTag:]`来查找要设置动画的按钮。

有关动画的更多信息，请参阅我的书：[http ://www.aeth.com/iOSBook/ch17.html](http://www.apeth.com/iOSBook/ch17.html)

# unix - 在 Unix 脚本上使用不同文件中声明的变量

> ID：12416676
> 
> 赞同：0
> 
> 时间：2012-09-14T00:34:24.437
> 
> 标签：unix, variables

如何将脚本中使用的变量保存在辅助文件中？例如，`myscript.env`在脚本中使用存储变量`myscript.sh`。

因此，每当我需要更改变量时，我都可以编辑`myscript.env`而不是`myscript.sh`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T00:44:11.973

这是很常见的设计模式。沿着以下思路思考

**myscript.sh：**

```
#!/path/to/shell

CONFIG_FILE=myscript.env
CONFIG_DIR=`dirname $0`
# or e.g. CONFIG_DIR=/etc/myscript

CONFIG="$CONFIG_DIR/$CONFIG_FILE"
. $CONFIG

echo "SOMEVAR=$SOMEVAR" 
```

**myscript.env**

```
SOMEVAR="The value of some var" 
```

现在`/path/to/myscript.sh`将输出`SOMEVAR=The value of some var`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:50:13.787

只需使用“点运算符”包含文件。

假设这两个文件在同一个目录中，以下将起作用：

t.sh：

```
#!/usr/bin/sh

# Note the first dot on the following line
. ./t.env 
echo $TESTVAR 
```

t.env：

```
TESTVAR="Hello world" 
```

运行时：

```
~/tmp$ sh ./t.sh
Hello world 
```

# javascript - 如何自定义 TinyMCE 按钮输出

> ID：12416678
> 
> 赞同：2
> 
> 时间：2012-09-14T00:35:00.173
> 
> 标签：javascript, tinymce

我想更改缩进按钮的默认行为。默认情况下，缩进按钮将 CSS 样式添加`padding-left: 30px;`到段落标签。我想将其更改为`margin-left: 20px`或任何数量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-01-05T23:08:39.500

设置“缩进”可让您配置数量。2014 年 1 月添加了“indent_use_margin”选项，让您切换 css 属性：[https ://github.com/tinymce/tinymce/pull/290](https://github.com/tinymce/tinymce/pull/290)

我之所以需要这个，是因为我们使用 TinyMCE 让用户编辑 HTML 电子邮件，而电子邮件客户端（尤其是 Outlook）因 CSS 支持不完善而臭名昭著。

例子：

```
 tinymce.init({
        indent_use_margin: true,
        indentation: 20, 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T00:43:25.740

我不确定是否可以不侵入 tinyMCE 代码。一种选择可能是使用自定义样式，如下所示：[http ://www.tinymce.com/wiki.php/Configuration:style_formats](http://www.tinymce.com/wiki.php/Configuration:style_formats)

```
tinyMCE.init({
    ...
    style_formats : [
        {title : 'Indented text', inline : 'p', styles : {marginLeft : '20px'}}
    ]
}); 
```

然后应用样式而不是按缩进按钮。

# python - base64 编码和解码问题，其中 a != b

> ID：12416680
> 
> 赞同：3
> 
> 时间：2012-09-14T00:35:10.427
> 
> 标签：python, base64

给出 Python 中的这个例子

```
sample = '5PB37L2CH5DUDWN2SUOYE6LJPYCJBFM5N2FGVEHF7HD224UR52KB===='
a = base64.b32decode(sample)
b = base64.b32encode(a) 
```

为什么会这样

样品！= b？

但是哪里

```
sample = '5PB37L2CH5DUDWN2SUOYE6LJPYCJBFM5N2FGVEHF7HD224UR52KBAAAA' 
```

然后

样本 == b

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T00:40:03.197

你得到的第一个样本是无效的base64。

取自维基：

> 当要编码的字节数不能被 3 整除时（即，如果最后一个块只有一个或两个字节的输入），则执行以下操作：添加值为 0 的额外字节，因此有 3 个字节，并执行到base64的转换。如果只有一个有效输入字节，则只选择前两个 base64 数字，如果有两个有效输入字节，则选择前三个 base64 数字。可能会添加“=”字符以使最后一个块包含四个 base64 字符。

[http://en.wikipedia.org/wiki/Base64#Examples](http://en.wikipedia.org/wiki/Base64#Examples)

编辑：

取自 RFC 4648：

> 如果在被编码的数据末尾可用的位少于 24 位，则执行特殊处理。一个完整的编码量
> 总是在一个量的末尾完成。
> 当输入组中可用的输入位少于 24 个时，将添加值为 0 的位
> （在右侧）以形成整数个 6 位组。
> 使用“=”字符执行数据末尾的填充。

4 倍 8 位（='s）（在你的末尾`sample`）超过 24 位，所以它们至少是不必要的。（不确定是什么数据类型`sample`，但找出并取其大小乘以字符数除以 24）

关于你的特别`sample`：

base-encoding 读取 24 位块，并且只需要在 base'd 字符串的末尾添加 '=' 填充字符，以使字符串在拆分为 24 位块后剩下的内容为“大小为 24”，因此可以通过以下方式解析解码器。由于字符串末尾的 ==== 超过 24 位，因此它们是无用的，因此：无效...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T01:58:23.010

首先，让我们明确一点：您的问题是关于 base32，而不是 base64。

您的原始样本有点太长了。最后有 4 个`=`填充，这意味着至少有 20 位填充。位数必须是 8 的倍数，所以它实际上是 24 位。base32 中的编码`B`是`1`，这意味着设置了填充位之一。这违反了规范，该规范规定所有填充位都必须清晰。解码完全丢弃该位，并且编码产生正确的值`A`而不是`B`.

# css - webkit 中的 CSS 过渡

> ID：12416683
> 
> 赞同：0
> 
> 时间：2012-09-14T00:36:02.713
> 
> 标签：css, css-transitions, flicker

我在 chrome 中看到一个关于 CSS 过渡的有趣错误。

页面在转换过程中闪烁。目前我只在 Chrome 中看到过这个。

你可以在我的作品集中看到这个：www.dkhalife.com

只需向下滚动到技能部分并反复将鼠标悬停在右侧的任何社交图标上，您就不会错过它...

CSS过渡代码主要是：

```
-webkit-transition: all 500ms;
-moz-transition: all 500ms;
-o-transition: all 500ms;
transition: all 500ms; 
```

基本上我只是使用悬停伪类来改变不透明度和边距。

我努力了：

```
-webkit-backface-visibility: hidden; 
```

正如关于 SO 的其他一些问题所提到的，但这似乎并不能解决我的问题。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T00:44:58.263

代替

```
-webkit-transition: all 500ms; 
```

仅对要更改的属性进行动画处理

```
-webkit-transition: opacity,margin 500ms; 
```

# c - 用户输入 - C（不允许某些字符）

> ID：12416684
> 
> 赞同：0
> 
> 时间：2012-09-14T00:37:13.540
> 
> 标签：c, user-input

我有一个 C 程序，用户将在命令行中输入整数或双精度数作为输入。允许使用负数，但我遇到了用户输入以下内容时的问题：

```
1-1 
```

它只是被解析为一个。我创建了一个函数来测试用户输入是否为有效数字，但我不确定如何捕获这样的实例，或者对于 1+1、1)2 等输入也是如此。

这是我创建的函数：

```
int check_number(char *userInput) {
int i;
//check each character
for (i = 0; userInput[i] != '\0'; i++){
    if (isalpha(userInput[i])){
        printf("Invalid input.\n");
        return -1;
    }
}       
return 0;
} 
```

我应该怎么做才能在用户输入中间不允许任何其他随机字符（除了字母，因为那些已经用 isalpha 测试过）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T00:40:47.487

基本上，您希望第一个字符是减号或数字（可能还有句点），所有后续字符都应该是数字或句点。但是您可能还需要计算周期以确保只有一个。如果你也想接受科学记数法，你也需要处理它。

检查 not isalpha 是错误的方法，您应该检查允许的字符。

基本上是这样的：

```
if (*userInput != '-' && !isdigit(*userInput))
  return -1;
int periods = 0;
while (*++userInput != 0) {
  if (*userInput == '.') {
    if (periods >= 1)
      return -1;
    ++periods;
    continue;
  }
  if (!isdigit(*userInput))
    return -1;
}
return 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:41:11.697

```
if (isdigit(userInput[i]) || userInput[i]=='.') {
  printf("Valid input.\n");
}
else return -1; 
```

# automapper - 如果没有使用目标对象，则有条件地覆盖目标

> ID：12416686
> 
> 赞同：3
> 
> 时间：2012-09-14T00:37:20.007
> 
> 标签：automapper

我想设置一个遵循以下规则的 Automapper 映射。

*   如果未使用“就地”目标语法，则将特定成员映射到值
*   如果传入一个对象，则使用目标值

我已经尝试了所有我能想到的方法。像这样的东西：

```
Mapper.CreateMap<A, B>()
    .ForMember(dest => dest.RowCreatedDateTime, opt => {
        opt.Condition(dest => dest.DestinationValue == null);
        opt.UseValue(DateTime.Now);
     }); 
```

这总是映射值。基本上我想要的是：

```
c = Mapper.Map<A, B>(a, b);  // does not overwrite the existing b.RowCreatedDateTime
c = Mapper.Map<B>(a);        // uses DateTime.Now for c.RowCreatedDateTime 
```

注意：A 不包含 RowCreatedDateTime。

我在这里有什么选择？这非常令人沮丧，因为似乎没有关于 Condition 方法的文档，并且所有谷歌结果似乎都集中在源值为 null 的位置，而不是目标位置。

编辑：

多亏了帕特里克，他让我走上了正轨。

我想出了一个解决办法。如果有人有更好的方法，请告诉我。注意我必须引用`dest.Parent.DestinationValue`而不是`dest.DestinationValue`. 出于某种原因，`dest.DestinationValue`始终为空。

```
.ForMember(d => d.RowCreatedDateTime, o => o.Condition(d => dest.Parent.DestinationValue != null))
.ForMember(d => d.RowCreatedDateTime, o => o.UseValue(DateTime.Now)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T12:32:10.657

我相信您需要设置两个映射：一个带有`Condition`（确定是否应该执行映射）和一个定义如果`Condition`返回 true 时要做什么。像这样的东西：

```
.ForMember(d => d.RowCreatedDateTime, o => o.Condition(d => d.DestinationValue == null);
.ForMember(d => d.RowCreatedDateTime, o => o.UseValue(DateTime.Now)); 
```

# delphi - 在一个tcombobox中，我如何具有下拉显示x，但是当x被选中时，文本属性得到y？

> ID：12416696
> 
> 赞同：1
> 
> 时间：2012-09-14T00:39:14.760
> 
> 标签：delphi, tcombobox

我需要用户选择日期格式（dd/mm/yyyy 或 dd mmmm yyyy 等），但显示这些选项只是令人困惑。我想要做的是让 TComboBox 项目充满“14/09/2012”、“2012 年 9 月 14 日”、“2012 年 9 月 14 日星期五”等，当用户选择其中一种日期格式时，组合框会得到文本“dd mmmm yyyy”或任何日期格式（尽管我仍然希望他们能够输入其他内容，例如“d/m/yy”）。

但是，我还没有找到一种简单的方法来做到这一点 - 除了带有 TSpeedButton 的 TEdit 之外，它会打开一个带有选择选项的表单，如果没有办法使用 TComboBox 执行此操作，这是我的第二选择。

问题：如何让 TComboBox 下拉菜单显示日期，但文本属性在选择日期时获取日期格式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T03:47:40.993

ownerdraw TCombobox 怎么样？

```
procedure TForm16.cbLongDateFormatDrawItem(Control: TWinControl; Index: Integer;
  Rect: TRect; State: TOwnerDrawState);
begin
  with Control as TComboBox do
  begin
    if not (odSelected in State) then
      Canvas.Brush.Color:=clWindow
    else
      Canvas.Brush.Color:=clHighlight;
    Canvas.FillRect(Rect);
    Canvas.TextOut(Rect.Left +2 , Rect.Top, FormatDateTime(cbLongDateFormat.Items[Index], Now));
  end;
end;

procedure TForm16.FormCreate(Sender: TObject);
begin
  cbLongDateFormat.Items.Add('ddddd');
  cbLongDateFormat.Items.Add('dddddd');
  cbLongDateFormat.Items.Add('dd/mm/yyyy');
  cbLongDateFormat.Items.Add('d mmmm yyyy');
end; 
```

![在此处输入图像描述](../Images/098289cf4dc0ab0ab9b42c8cd36b55bf.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T01:29:25.060

不可能通过 ComboBox 上的 OnChange 事件直接执行此操作，因为在 OnChange 事件之后，文本属性将设置回用户选择的任何内容。但是，我可以向表单发送消息以进行更改。

```
procedure TfINISettings.cbLongDateFormatChange(Sender: TObject);
begin
  PostMessage(Handle, WM_USER, 0, 0);
end; 
```

并在表单界面中声明一个过程

```
procedure DateFormatComboBoxChange(var msg: TMessage); message WM_USER; 
```

处理此消息，并在实现中

```
procedure TfINISettings.DateFormatComboBoxChange(var msg: TMessage);
begin
  if cbLongDateFormat.ItemIndex <> -1 then
    cbLongDateFormat.Text := DateFormats[cbLongDateFormat.ItemIndex];
end; 
```

其中 DateFormats 是一个包含我的日期格式的 TStringList。FormCreate 方法如下所示

```
procedure TfINISettings.FormCreate(Sender: TObject);
var
  d: String;
begin
  DateFormats := TStringList.Create;
  DateFormats.Add('ddddd');
  DateFormats.Add('dddddd');
  DateFormats.Add('d mmmm yyyy');
  for d in DateFormats do
    cbLongDateFormat.Items.Add(FormatDateTime(d, now));
end; 
```

欢迎提出改进建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T00:43:17.467

将您的日期/时间格式字符串存储在单独`TStringList`的.`TComboBox.OnChange``TComboBox.ItemIndex``TStringList``TComboBox.Text`

# knockout.js - 你如何调试你的 knockout.js 绑定表达式？

> ID：12416697
> 
> 赞同：8
> 
> 时间：2012-09-14T00:39:33.287
> 
> 标签：knockout.js

我喜欢 KO 框架，但调试有时对我来说只是一场噩梦。如果是常规 javascript 代码，我可以放置一个断点并在运行时去那里看看有什么问题，但是如何调试淘汰表达式？在大多数情况下，绑定错误是由于缺少某些符号或语法错误造成的，有时敲除会向我显示有关该问题的明确错误，但有时不会，预期的数据只是没有出现在页面上，或者诸如“绑定表达式错误”之类的错误消息，即使是“未找到函数 abc”之类的消息也无法让我立即了解问题所在，因为我不知道我的模型 KO 运行时目前正在经历哪个级别。理想情况下，应该有一个浏览器插件可以在任何 KO 表达式中放置断点或其他内容，并查看它在运行时运行的上下文。市场上有这样的东西还是预期的？关于改进调试过程的任何想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-14T01:46:24.593

在开发过程中，我使用调试版本并在函数上设置断点`createBindingsStringEvaluator()`（v2.1.0 中的第 1858 行）。因此，就在绑定被“解析”之前，您可以分析将要评估的表达式，找出哪些绑定失败，它们的上下文，您可以逐步完成绑定过程，这样您就可以一直走下去，直到它失败。

为了最大限度地减少非常复杂的绑定的问题，特别是如果它们需要重复，我会考虑创建一些自定义绑定处理程序，它们可以一次应用一组绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-23T16:17:54.343

在当前版本 (v 3.4.1) 中，该函数称为**parseBindingsString**。在此处设置 a`debugger`或 a`console.log`将为您提供一些信息。

# vbscript - 为什么这个 WMI 脚本不会读取我的注册表字符串值？

> ID：12416701
> 
> 赞同：0
> 
> 时间：2012-09-14T00:40:03.723
> 
> 标签：vbscript, wmi

我正在使用 technet 中的示例尝试从 HKLM\Microsoft\Windows\CurrentVersion\Run 读取一个名为 MyStartupExe 的 dword / 字符串。它返回空。这个常规示例有效：

```
Const HKEY_CURRENT_USER = &H80000001
strComputer = "."
Set oReg=GetObject( _
   "winmgmts:{impersonationLevel=impersonate}!\\" &_
    strComputer & "\root\default:StdRegProv")
strKeyPath = "Console"
strValueName = "HistoryBufferSize"
oReg.GetDWORDValue _
   HKEY_CURRENT_USER,strKeyPath,strValueName,dwValue
WScript.Echo "Current History Buffer Size: " & dwValue 
```

我对它的改编不起作用。字符串和 dword 值存在于注册表中我要查找的键路径中。

```
const HKEY_LOCAL_MACHINE = &H80000002
strComputer = "."
Set oReg=GetObject( _
   "winmgmts:{impersonationLevel=impersonate}!\\" &_
    strComputer & "\root\default:StdRegProv")
strKeyPath = "SOFTWARE\Microsoft\Windows\CurrentVersion\Run"
strValueName = "MyStartUpExe"
oReg.GetDWORDValue _
   HKEY_LOCAL_MACHINE,strKeyPath,strValueName,dwValue
WScript.Echo "MyStartupExe" & dwValue 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T21:21:45.787

"MyStartUpExe" 很可能是一个`REG_SZ`值，而不是一个`REG_DWORD`值，因此您必须使用`GetStringValue()`而不是`GetDWORDValue()`.

```
oReg.GetStringValue HKEY_LOCAL_MACHINE, strKeyPath, strValueName, value
WScript.Echo "MyStartUpExe" & value 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T02:48:31.173

请参阅[WMI StdRegProv 类](http://msdn.microsoft.com/en-us/library/windows/desktop/aa393664(v=vs.85).aspx)。

或者，您可以只使用`Shell.RegRead`读取不知道值数据类型的注册表值。如果返回码`RegRead`为 0（成功），则存在一个 reg 值，否则如果返回码是一些一般错误代码，例如`&h800xxxxx`等，则不存在 reg 值。要检查您的操作系统架构类型，请查询`Win32_Processor.Architecture`值（其中 '0' = 'x86' 或 '9' = 'x64'）。

# jquery - 如何避免自动使用jquery mobile？

> ID：12416702
> 
> 赞同：1
> 
> 时间：2012-09-14T00:40:04.447
> 
> 标签：jquery, mobile, styles

假设我有两个页面： - 第 1 页使用 jquery mobile 并有到第 2 页的链接 - 第 2 页不使用 jquery mobile

为什么如果我通过第 1 页访问第 2 页，它以 jqm 的样式显示，而如果我直接访问它，它具有中性样式？如何避免在通过第一个访问的每个页面中使用 jquery mobile？我只希望在我明确定义它的那些页面中使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:07:54.620

查看有关 jQuery Mobile 如何处理链接的文档，特别是“无 Ajax 链接”部分：http:
[//jquerymobile.com/test/docs/pages/page-links.html](http://jquerymobile.com/test/docs/pages/page-links.html)

它说您`data-ajax="false"`向链接或父容器添加属性以在当前 jQuery Mobile 页面之外加载链接。

例如：

```
<a href="index.html" data-ajax="false">link to a page</a> 
```

该页面底部也有示例。

# android - 将一张图像与存储在 sdcard 中的其他图像进行比较

> ID：12416703
> 
> 赞同：-1
> 
> 时间：2012-09-14T00:40:09.237
> 
> 标签：android, image, android-camera

如何将一个带有相机的图像令牌与存储在 sd 卡中的所有其他图像进行比较并显示结果？

```
public class SearchForFaces extends Activity {

    Bitmap bitmapOriginale;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        Bundle b1 = getIntent().getExtras();
        String cin= b1.getString("cin");        

        //getting the image
        File sdCard = Environment.getExternalStorageDirectory();
        File directory = new File (sdCard.getAbsolutePath() + "/Student");
        File file = new File(directory, cin+"jpg");
        try {
            FileInputStream streamIn = new FileInputStream(file);
            bitmapOriginale = BitmapFactory.decodeStream(streamIn);
            streamIn.close();
        } catch (IOException e) {
            Log.d("SearchForFaces Exception", e.getMessage());
        }
        if(bitmapOriginale.sameAs(//images from sdcard)) 
        {
            //display founded image
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:03:59.917

另请查看此博客[http://mihaifonoage.blogspot.com/2009/09/displaying-images-from-sd-card-in.html](http://mihaifonoage.blogspot.com/2009/09/displaying-images-from-sd-card-in.html)它展示了如何从 sd 卡读取图像。阅读它们后，您可以使用您的 sameAs() 编写方法来比较它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T01:36:38.923

我认为，没有必要读取所有图像..如果您想比较相机中的图像，您可以“轻松”拍摄 DCMI 文件夹中的图像。但是好的，用户将在另一个文件夹中移动一些文件。因此，在这种情况下，我建议只打开第一个文件夹，读取其中的文件并检查格式，然后打开另一个文件夹，读取其中的文件并再次检查格式并将路径保存到 jpg 文件。
所以在这种情况下，foreach 很容易，而 cykl 或者你可以用递归来做。您将拥有一些 ArrayList（linkedList 等），并且在此列表中您可以放置​​路径。然后只需调用您的 sameAs 方法。
在这你可以使用`Environment.getExternalStorageDirectory().listFiles();`

但是..我不确定您的“算法”是否有效..图像识别是计算机科学中非常难的部分..如果您不知道如何获取 SD 卡上的文件..算法可能不起作用..
但是如果您想通过逐字节比较检查相似性，然后就可以了..

# java - Struts 1.1：不同Action之间的ActionErrors

> ID：12416706
> 
> 赞同：1
> 
> 时间：2012-09-14T00:40:21.977
> 
> 标签：java, ajax, struts

我有一个表单 (form.jsp) 和一个连接的 FormAction ActionA。ActionA 进行验证并存储 ActionErrors，form.jsp 将使用`<html:errors../>`标记打印它们。所有这一切都很好。

然后，我想在其中一个表单字段（fieldA）上的 onblur 事件上添加一些即时服务器端验证。我使用 jQuery 的`$.post`. 它转到一个不同的 Action 类 (ActionB)，它将返回一个值，我可以在 fieldA 下的 div 中打印该值。这也很好用。

问题是将两者结合起来。我`saveErrors`在 ActionA 中使用方法，需要用我在 ActionB 中遇到的新错误来重置它。

示例：如果 fieldA 的值是“A”，而 fieldB 的值是“#$”，并且我的 ActionA 在按下提交时返回错误“fieldA 没有大写字母”和“fieldB 没有符号”，那么当用户将 fieldA 更改为“123”并按下制表符时，显示的错误应该是“字段A 没有数字”和“字段B 没有符号”，即第一个错误被删除。

但是，如果它不在请求中，我如何访问错误！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T06:02:53.773

好的，我解决了。我只是使用 jQuery 使带有错误 (class="globalError") 的整个 div 不显示 (display:none)，然后在类似的 div 中添加了我的新错误。所以，看起来错误部分发生了变化:-)。谢谢您的帮助。

# json - 您可以将嵌套的 JSON 结构展平为单个 autobean 吗？

> ID：12416713
> 
> 赞同：1
> 
> 时间：2012-09-14T00:41:10.030
> 
> 标签：json, gwt, autobean

假设以下 JSON 结构：

```
{
    \"is_something\": false,
    \"name\": \"Some Name\",
    \"subtype\": {
        \"total\": 0.0
    }
} 
```

我不想创建两个 autobean 接口（一个用于整个结构，一个用于子类型），我想要一个包含所有属性的接口。

```
public interface ExampleAutoBean {
    @PropertyName("is_something")
    boolean isSomething();

    String getName();

    @PropertyName("subtype.total")
    double getTotal();
} 
```

因此，该`getTotal()`方法有望`total`在 JSON 结构中包含嵌套子类型的属性。我在源代码或网上找不到任何说明这是否可行的文档。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T03:13:06.057

不：AutoBeans 被设计为从 JSON 结构到 Java 接口的映射，加上或减去集合，如`List`、`Set`和a或 a 的`Map`字符串编码。此外，拥有如下 json 是合法的：`long``Date`

```
{
    "some.property.with.dots" : "abcd",
    "name" : "wxyz"
} 
```

If the `.` character could only be used for traversing into sub-objects, there would be no way to have a getter for the first property.

# php - PHP：将相同长度的数组组合成一个多维数组，其中两者都作为值（不是键）？

> ID：12416715
> 
> 赞同：4
> 
> 时间：2012-09-14T00:41:13.643
> 
> 标签：php, arrays

我有两个相同长度的数组，如下所示：

```
Array
(
    [0] => a
    [1] => b
    [2] => c
)

Array
(
    [0] => 1
    [1] => 2
    [2] => 3
) 
```

我想结束这个：

```
Array
(
    [0] => Array
        (
            [0] => a
            [1] => 1
        )
    [1] => Array
        (
            [0] => b
            [1] => 2
        )
    [2] => Array
        (
            [0] => c
            [1] => 3
        )
) 
```

`array_combine`会将上述一组值变成数组*键*，这是我不想要的——我希望两者都以数组值结尾，将两个数组的每个项目组合成一个新数组。

是否有内置功能可以做到这一点，还是我必须自己动手？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T00:47:01.167

尝试这个：

```
$result = array();
foreach ($array1 as $i => $val) {
    $result[] = array($val, $array2[$i]);
} 
```

[http://codepad.viper-7.com/Jx5H1Q](http://codepad.viper-7.com/Jx5H1Q)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-01-21T14:48:44.233

> 是否有内置功能来执行此操作

**是的**

> 还是我必须自己动手？

**不**

通过调用`array_map()`并将其`null`作为回调参数提供，然后提供 2 个或更多数组，它将根据需要重组您的数据。

代码：（[演示](https://3v4l.org/f8C7g)）

```
$array1 = ['a', 'b', 'c'];
$array2 = [1, 2, 3];

var_export(array_map(null, $array1, $array2)); 
```

输出：

```
array (
  0 => 
  array (
    0 => 'a',
    1 => 1,
  ),
  1 => 
  array (
    0 => 'b',
    1 => 2,
  ),
  2 => 
  array (
    0 => 'c',
    1 => 3,
  ),
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T00:51:22.927

如果你有字符串键，你可以[`array_merge_recursive`](http://php.net/array-merge-recursive)用来合并它们。但是，实际上，您需要做其他事情。例如：

```
$result = Array();
$arrays = Array($array1,$array2...);
foreach($arrays as $arr) {
    foreach($arr as $k=>$v) $result[$k][] = $v;
} 
```

# php - 如何将普通的 sql 查询转换为 Zend_Db_Select？

> ID：12416719
> 
> 赞同：4
> 
> 时间：2012-09-14T00:41:45.547
> 
> 标签：php, mysql, zend-framework, zend-db-select

嗨，我想将我的普通 mysql 查询转换为 zend.db.select；

我想使用这个脚本：

```
$select = $db->select();

// Add a FROM clause
$select->from( ...specify table and columns... )

// Add a WHERE clause
$select->where( ...specify search criteria... )

// Add an ORDER BY clause
$select->order( ...specify sorting criteria... );

$select->limit(20, 10); 
```

**对于我下面的查询**

```
SELECT 
    IF(derived_messages.toid = '$user', derived_messages.fromid, 
    derived_messages.toid) friend1,c.UserName,
    derived_messages.message, derived_messages.fromid, derived_messages.toid,
    derived_messages.is_read,derived_messages.type,derived_messages.id as mesid,                    
    derived_messages.date,
    (SELECT M.message_id FROM messagesmapped M where M.message_id= derived_messages.id AND M.user_id ='$user' AND M.important = 1) as MesMapid
    FROM 
    (               
    SELECT * 
    FROM messages
    WHERE messages.deleted_by NOT 
    IN ( $user ) 
    ORDER BY Date DESC      
    ) derived_messages
    INNER JOIN Users c ON c.MemberID = IF(derived_messages.toid = '$user', derived_messages.fromid, 
    derived_messages.toid)
    WHERE (derived_messages.id IN 
    (SELECT M.message_id FROM messagesmapped M where M.message_id= derived_messages.id AND M.user_id ='$user' AND M.important = 1)                  
    AND 
    (derived_messages.toid='$user' OR derived_messages.fromid='$user'))

    GROUP BY friend1 ASC 
    ORDER BY derived_messages.date DESC, derived_messages.id DESC LIMIT $limit $offset 
```

我希望有人可以帮助我。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T01:12:41.313

可能但不太可能有人会为您编写查询。

我对处理此类查询的建议是将每个单独的子查询编写为其自己的`Zend_Db_Select`对象，然后使用您已经拥有对象的子查询构建最终查询。

`Zend_Db_Select`不直接支持该`IF`功能，因此您需要使用[`Zend_Db_Expr`](http://framework.zend.com/manual/1.12/en/zend.db.select.html#zend.db.select.building.columns-expr)将该语句添加到您的选择中。

* * *

这是我正在谈论的基本示例。让我们构建以下查询：

```
SELECT IF(msg.toId = 'drew010', msg.fromId, msg.toId), id, name, age, history.ip
FROM users
JOIN history ON users.id = history.userId
WHERE users.id = (
    SELECT id FROM users WHERE loginCount > 1000
)
GROUP BY id,
ORDER BY age DESC 
```

首先构建选择`loginCount`大于 1000 的用户的子选择。

```
$subquery1 = $db->select()
                ->from('users', array('id'))
                ->where('loginCount > ?', 1000); 
```

接下来，使用 IF 函数构建外部查询：

```
$cols  = array(
    new Zend_Db_Expr('IF(' . $db->quoteInto('msg.toId = ?', 'drew010') . '), msg.fromId, msg.toId'),
    'id', 'name', 'age'
);

$query = $db->select()
            ->from('users', $cols)
            ->join('history', 'users.id = history.userId', array('ip'))
            ->where('id = ?', $subquery1)
            ->group('id')
            ->order('age DESC');

echo $query; 
```

输出：

```
SELECT
  IF(msg.toId = 'drew010', msg.fromId, msg.toId),
  `users`.`id`,
  `users`.`name`,
  `users`.`age`,
  `history`.`ip`
FROM `users`
INNER JOIN `history`
  ON users.id = history.userId
WHERE id = (
    (SELECT `users`.`id`
    FROM `users`
    WHERE (loginCount > 1000))
)
GROUP BY `id`
ORDER BY `age` DESC 
```

* * *

所以要走的路是先把整个查询分解成单独的查询，然后再构造外部查询。只要有耐心，慢慢来。那并阅读[`Zend_Db_Select`](http://framework.zend.com/manual/1.12/en/zend.db.select.html)文档以全面了解您可以使用的内容。

# c - scanf 调用中类型的无效操作数

> ID：12416720
> 
> 赞同：0
> 
> 时间：2012-09-14T00:41:47.640
> 
> 标签：c

当我去编译下面的程序时，我得到了这个错误，我不知道为什么。

```
39:19: error: invalid operands of types ‘const char [5]’ and ‘long long int’ to binary ‘operator&’ 
```

这是代码。

```
int
main(void)
{
    long long d, p; 

    // Ask for number for the numbers of  days as long as input is between 28 and 31
    do  
    {
       printf("How many days are in your month?\n");
       scanf("%lld" &d);    // This is the line with the error
    }   
    while (d<28 || d>31);

    // Ask user for number of pennies for day 1 as long as input is not negative
    printf("How many Pennies do you have?\n");
    do
    {
        scanf("%lld", &p);    
    }
    while (p<0);

    //sum up the pennies
    int i;
    for (int i=0; i<=d-1; i++);
    {
        p = (p * 2);
    }

    // Format and print the total  (currently * instead of / for troube-shooting)
    double total;
    total = (p * 100);
    printf("Your ending amount it $%.2f.\n, total");        
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T00:43:19.107

应该

```
scanf("%lld", &d); //not scanf("%lld" &d); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T00:43:18.107

你忘记了一个逗号`scanf("%lld" &d);`。这导致它将参数解释`scanf`为某些字符与数字 BITAND 的结果。

将其更改为：

```
scanf("%lld", &d); 
```

# php - iframe 提交后重定向

> ID：12416721
> 
> 赞同：-2
> 
> 时间：2012-09-14T00:41:47.873
> 
> 标签：php, redirect, iframe, forwarding

在 iframe 表单完成后是否有重定向，即使我没有托管表单本身。

我想将用户发送到感谢页面，但表单是 iframe，所以我无法控制 iframe 本身的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T00:46:47.650

挂钩`onload`IFRAME 的事件。在第一次加载（加载表单）时，什么都不做。在第二次加载时（提交表单并显示其结果）通过以下方式进行客户端重定向`location.href`

# haskell - 有没有一种很好的方法可以让 Haskell 中的函数签名提供更多信息？

> ID：12416723
> 
> 赞同：56
> 
> 时间：2012-09-14T00:42:04.247
> 
> 标签：haskell, syntax, coding-style, functional-programming

我意识到这可能被认为是一个主观的或离题的问题，所以我希望与其关闭它，不如将它迁移到程序员身上。

我开始学习 Haskell，主要是为了我自己的启迪，我喜欢很多支持该语言的想法和原则。在参加了一个语言理论课后，我开始对函数式语言着迷，我们在那里玩了 Lisp，而且我听到了很多关于 Haskell 高效的好消息，所以我想我自己去研究一下。到目前为止，我喜欢这门语言，除了一件事我无法摆脱：那些母亲 effing 函数签名。

我的专业背景主要是做OO，尤其是Java。我工作过的大多数地方都遵循了许多标准的现代教条。Agile、Clean Code、TDD 等。经过几年的工作，它绝对成为了我的舒适区；特别是“好”代码应该是自我记录的想法。我已经习惯了在 IDE 中工作，其中带有非常描述性签名的冗长冗长的方法名称对于智能自动完成和用于导航包和符号的大量分析工具来说不是问题；如果我可以在 Eclipse 中按 Ctrl+Space，然后通过查看方法的名称和与其参数关联的本地范围变量来推断方法正在做什么，而不是拉起 JavaDocs，我就像一头猪一样高兴。

这显然不是 Haskell 社区最佳实践的一部分。我已经阅读了很多关于这个问题的不同意见，我知道 Haskell 社区认为它的简洁性是一个“专业人士”。我已经阅读了[如何阅读 Haskell](http://www.haskell.org/haskellwiki/How_to_read_Haskell#General_advice)，并且我理解许多决定背后的基本原理，但这并不意味着我喜欢它们；一个字母的变量名等对我来说并不有趣。我承认，如果我想继续使用该语言进行黑客攻击，我将不得不习惯这一点。

但我无法克服函数签名。举个例子，从[Learn you a Haskell[...]](http://learnyouahaskell.com/syntax-in-functions) 's section on function syntax：

```
bmiTell :: (RealFloat a) => a -> a -> String  
bmiTell weight height  
    | weight / height ^ 2 <= 18.5 = "You're underweight, you emo, you!"  
    | weight / height ^ 2 <= 25.0 = "You're supposedly normal. Pffft, I bet you're ugly!"  
    | weight / height ^ 2 <= 30.0 = "You're fat! Lose some weight, fatty!"  
    | otherwise                   = "You're a whale, congratulations!" 
```

我意识到这是一个愚蠢的例子，它只是为了解释守卫和类约束而创建的，但是如果你只检查*那个*函数的签名，你将不知道它的哪个参数是用来作为权重的或高度。即使您使用`Float`or`Double`代替任何类型，它仍然无法立即辨别。

起初，我认为我会很可爱、聪明、聪明，并尝试使用具有多个类约束的更长类型变量名来欺骗它：

```
bmiTell :: (RealFloat weight, RealFloat height) => weight -> height -> String 
```

这吐出了一个错误（顺便说一句，如果有人可以向我解释该错误，我将不胜感激）：

```
Could not deduce (height ~ weight)
    from the context (RealFloat weight, RealFloat height)
      bound by the type signature for
                 bmiTell :: (RealFloat weight, RealFloat height) =>
                            weight -> height -> String
      at example.hs:(25,1)-(27,27)
      `height' is a rigid type variable bound by
               the type signature for
                 bmiTell :: (RealFloat weight, RealFloat height) =>
                            weight -> height -> String
               at example.hs:25:1
      `weight' is a rigid type variable bound by
               the type signature for
                 bmiTell :: (RealFloat weight, RealFloat height) =>
                            weight -> height -> String
               at example.hs:25:1
    In the first argument of `(^)', namely `height'
    In the second argument of `(/)', namely `height ^ 2'
    In the first argument of `(<=)', namely `weight / height ^ 2' 
```

不完全理解为什么这不起作用，我开始用谷歌搜索，我什至发现了这篇小帖子，它建议命名参数，特别是[通过 欺骗命名参数`newtype`](http://blog.ezyang.com/2010/09/keyword-arguments-in-haskell/)，但这似乎有点多。

是否没有可接受的方法来制作信息丰富的函数签名？“Haskell 方式”只是为了把所有事情都搞砸吗？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-09-14T01:49:48.573

类型签名不是 Java 样式的签名。Java 风格的签名会告诉您哪个参数是重量，哪个是高度，因为它将参数名称与参数类型混合在一起。Haskell 不能将此作为一般规则，因为函数是使用模式匹配和多个方程定义的，如下所示：

```
map :: (a -> b) -> [a] -> [b]
map f (x:xs) = f x : map f xs
map _ [] = [] 
```

这里第一个参数`f`在第一个方程中命名，`_`（这几乎意味着“未命名”）在第二个方程中。第二个参数在任一方程中都没有名称*；*在它的第一部分有名字（程序员可能会认为它是“xs 列表”），而在第二部分它是一个完全文字的表达式。

然后是无点定义，例如：

```
concat :: [[a]] -> [a]
concat = foldr (++) [] 
```

类型签名告诉我们它接受一个类型为 的参数`[[a]]`，但该参数的名称没有出现在系统中的**任何位置**。

在函数的单个方程之外，它用来引用其参数的名称无论如何都是无关紧要的，**除非**作为文档。由于函数参数的“规范名称”的概念在 Haskell 中没有很好地定义，因此“第一个参数`bmiTell`表示重量，第二个表示高度”信息的位置在文档中，而不是在类型签名中。

我绝对同意，一个函数的作用应该从关于它的“公共”信息中一目了然。在 Java 中，这是函数的名称，以及参数类型和名称。如果（通常）用户需要更多信息，则将其添加到文档中。在 Haskell 中，关于函数的公共信息是函数的名称和参数类型。如果用户需要更多信息，请在文档中添加。注意 Haskell 的 IDE（例如 Leksah）很容易向您显示 Haddock 注释。

* * *

请注意，在具有像 Haskell 之类的强大且富有表现力的类型系统的语言中，首选的做法通常是尝试使尽可能多的错误与类型错误一样可检测。因此，像这样的功能`bmiTell`会立即向我发出警告信号，原因如下：

1.  它需要两个相同类型的参数代表不同的事物
2.  如果以错误的顺序传递参数，它会做错事
3.  这两种类型没有自然位置（作为两个`[a]`论点`++`）

为提高类型安全性而经常做的一件事确实是创建新类型，如您找到的链接中所示。我真的不认为这与命名参数传递有很大关系，更多的是关于制作一个明确表示**height**的数据类型，而不是您可能想用数字测量的任何其他数量。所以我*不会*让 newtype 值只出现在通话中；*无论我从*哪里获得高度数据，我都会使用 newtype 值*同样，并将其作为高度数据而不是数字传递，这样我就可以在任何地方获得类型安全（和文档）的好处。当我需要将值传递给对数字而不是高度进行运算的东西（例如内部的算术运算`bmiTell`）时，我只会将值解包为原始数字。*

 *请注意，这没有运行时开销；newtypes 的表示方式与 newtype 包装器“内部”的数据相同，因此 wrap/unwrap 操作在底层表示上是无操作的，并且在编译期间被简单地删除。它只在源代码中添加了额外的字符，但这些字符*正是*您正在寻找的文档，并具有由编译器强制执行的额外好处；Java 风格的签名告诉您哪个参数是重量，哪个是高度，但是编译器仍然无法判断您是否不小心以错误的方式传递了它们！

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-09-14T01:42:26.843

还有其他选择，具体取决于您希望自己的类型变得多么愚蠢和/或迂腐。

例如，您*可以*这样做...

```
type Meaning a b = a

bmiTell :: (RealFloat a) => a `Meaning` weight -> a `Meaning` height -> String  
bmiTell weight height = -- etc. 
```

...但这非常愚蠢，可能令人困惑，并且在大多数情况下无济于事。这也是如此，这还需要使用语言扩展：

```
bmiTell :: (RealFloat weight, RealFloat height, weight ~ height) 
        => weight -> height -> String  
bmiTell weight height = -- etc. 
```

稍微更明智的是：

```
type Weight a = a
type Height a = a

bmiTell :: (RealFloat a) => Weight a -> Height a -> String  
bmiTell weight height = -- etc. 
```

...但这仍然有点愚蠢，并且当 GHC 扩展类型同义词时往往会迷失方向。

这里真正的问题是您将额外的语义内容附加到相同多态类型的不同值上，这违背了语言本身的本质，因此通常不是惯用的。

当然，一种选择是只处理无信息的类型变量。但是，如果同一类型的两个事物之间存在显着差异，而这从它们给出的顺序来看并不明显，那么这并不是很令人满意。

相反，我建议您尝试使用`newtype`包装器来指定语义：

```
newtype Weight a = Weight { getWeight :: a }
newtype Height a = Height { getHeight :: a }

bmiTell :: (RealFloat a) => Weight a -> Height a -> String  
bmiTell (Weight weight) (Height height) 
```

我认为，这样做远没有应有的普遍性。这是一些额外的输入（哈，哈），但它不仅使您的类型签名即使扩展了类型同义词也能提供更多信息，如果您错误地将重量用作高度等，它会让类型检查器发现。使用该`GeneralizedNewtypeDeriving`扩展，您甚至可以获得通常无法派生的类型类的自动实例。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2012-09-14T00:50:25.840

黑线鳕和/或还查看函数方程（您将事物绑定到的名称）是我告诉正在发生的事情的方式。您可以将 Haddock 单个参数，像这样，

```
bmiTell :: (RealFloat a) => a      -- ^ your weight
                         -> a      -- ^ your height
                         -> String -- ^ what I'd think about that 
```

所以它不仅仅是解释所有东西的一大堆文字。

你可爱的类型变量不起作用的原因是你的函数是：

```
(RealFloat a) => a -> a -> String 
```

但是您尝试的更改：

```
(RealFloat weight, RealFloat height) => weight -> height -> String 
```

相当于：

```
(RealFloat a, RealFloat b) => a -> b -> String 
```

因此，在此类型签名中，您已经说过前两个参数具有*不同*的类型，但 GHC 已确定（根据您的使用）它们必须具有*相同*的类型。所以它抱怨它无法确定`weight`并且`height`是相同的类型，即使它们必须是（也就是说，您提出的类型签名不够严格，并且会允许对函数的无效使用）。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-09-14T01:41:46.480

`weight``height`必须与您划分它们的类型相同（没有隐式强制转换）。`weight ~ height`表示它们是同一类型。ghc 已经继续解释了它是如何得出`weight ~ height`必要的结论的，抱歉。您可以使用类型系列扩展中的语法告诉它/您想使用什么：

```
{-# LANGUAGE TypeFamilies #-}
bmiTell :: (RealFloat weight, RealFloat height,weight~height) => weight -> height -> String
bmiTell weight height  
  | weight / height ^ 2 <= 18.5 = "You're underweight, you emo, you!"  
  | weight / height ^ 2 <= 25.0 = "You're supposedly normal. Pffft, I bet you're ugly!"  
  | weight / height ^ 2 <= 30.0 = "You're fat! Lose some weight, fatty!"  
  | otherwise                   = "You're a whale, congratulations!" 
```

然而，这也不理想。您必须记住，Haskell 确实使用了*非常*不同的范式，并且您必须小心不要假设在另一种语言中重要的东西在这里很重要。当你在舒适区之外时，你学习得最多。这就像来自伦敦的人出现在多伦多并抱怨这座城市令人困惑，因为所有街道都是一样的，而来自多伦多的人可能会声称伦敦令人困惑，因为街道上没有规律。你所说的混淆被Haskellers称为清晰。

如果你想回到更加面向对象的明确目的，那么让 bmiTell 只对人起作用，所以

```
data Person = Person {name :: String, weight :: Float, height :: Float}
bmiOffence :: Person -> String
bmiOffence p
  | weight p / height p ^ 2 <= 18.5 = "You're underweight, you emo, you!"  
  | weight p / height p ^ 2 <= 25.0 = "You're supposedly normal. Pffft, I bet you're ugly!"  
  | weight p / height p ^ 2 <= 30.0 = "You're fat! Lose some weight, fatty!"  
  | otherwise                   = "You're a whale, congratulations!" 
```

我相信，这是您在 OOP 中明确表达的一种方式。我真的不相信您使用 OOP 方法参数的类型来获取此信息，为了清楚起见，您必须秘密使用参数名称而不是类型，并且期望 haskell 告诉您参数名称是不公平的当您排除阅读问题中的参数名称时。[见下文*] Haskell 中的类型系统非常灵活且非常强大，请不要仅仅因为它最初对您疏远而放弃它。

如果您真的希望类型告诉您，我们可以为您做到：

```
type Weight = Float -- a type synonym - Float and Weight are exactly the same type, but human-readably different
type Height = Float

bmiClear :: Weight -> Height -> String
.... 
```

这是用于表示文件名的字符串的方法，所以我们定义

```
type FilePath = String
writeFile :: FilePath -> String -> IO ()  -- take the path, the contents, and make an IO operation 
```

这给了你所追求的清晰度。不过感觉是

```
type FilePath = String 
```

缺乏类型安全，而且

```
newtype FilePath = FilePath String 
```

或者更聪明的东西会是一个更好的主意。有关类型安全的非常重要的一点，请参见 Ben 的回答。

[*] 好的，你可以在 ghci 中做 :t 并获得类型签名而不需要参数名称，但 ghci 是用于源代码的交互式开发。你的库或模块不应该保持无文档和hacky，你应该使用非常轻量级的语法haddock文档系统并在本地安装haddock。您投诉的更合理版本是没有 :v 命令打印您的函数 bmiTell 的源代码。指标表明，针对同一问题的 Haskell 代码会缩短一个因子（我发现与等效的 OO 或非 oo 命令式代码相比，我发现大约 10 个），因此在 gchi 中显示定义通常是明智的。我们应该提交一个功能请求。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2012-09-14T01:41:13.430

尝试这个：

```
type Height a = a
type Weight a = a

bmiTell :: (RealFloat a) => Weight a -> Height a -> String 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2012-09-14T15:41:30.733

可能与带有两个参数的函数无关，*但是*......如果您有一个函数需要大量参数，类型相似或顺序不明确，则可能值得定义一个表示它们的数据结构。例如，

```
data Body a = Body {weight, height :: a}

bmiTell :: (RealFloat a) => Body a -> String 
```

你现在可以写

```
bmiTell (Body {weight = 5, height = 2}) 
```

或者

```
bmiTell (Body {height = 2, weight = 5}) 
```

并且这两种方式都值得正确，并且对于任何试图阅读您的代码的人来说都是显而易见的。

不过，对于具有大量参数的函数来说，这可能更值得。只有两个，我会和其他人一起去，`newtype`所以类型签名记录了正确的参数顺序，如果你把它们混在一起，你会得到一个编译时错误。*

# vb.net - dataGridViewCombobox 值未保存在导航器上保存按钮单击

> ID：12416726
> 
> 赞同：0
> 
> 时间：2012-09-14T00:43:15.067
> 
> 标签：vb.net, winforms, datagridviewcombobox

这是一个使用 EF 的 VB.NET winforms 项目。ComboBox 绑定到一个单独的数据源，其中包含列 tName 和 tNumber。TName 是该值的简要描述，tNumber 是保存在财务表中名为 transaction_type 的列下的实际数字。在财务表中现有数据的显示上，一切都完美无缺。

网格中每个项目的组合框都显示了 transaction_type 的正确描述。但是，当我更改任何组合框的值并单击保存按钮时，它不会将任何值保存到 transaction_type。

任何想法为什么会这样？如果需要，我将添加任何缺少的代码..

form_load 事件如下所示：

```
 Private Sub paymentHistoryView_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    FinancialDataGridView.DataSource = db.financials.Where(Function(f) f.TenantId = tenentId).OrderBy(Function(f) f.transaction_date)
    TranstypeBindingSource.DataSource = db.transtypes.OrderBy(Function(f) f.tNumber)
    BindingNavigatorDeleteItem.Enabled = False

End Sub 
```

而savebutton点击事件如下：

```
Private Sub FinancialBindingNavigatorSaveItem_Click(sender As System.Object, e As System.EventArgs) Handles FinancialBindingNavigatorSaveItem.Click
    db.SaveChanges()
End Sub 
```

ComboBox 的属性如下所示：

![组合框属性](../Images/84f1a142c9acab739766d092f5650f17.png)

应该注意的是，当单击保存按钮时，对数据网格的所有其他更改都会正确保存......经过进一步测试，如果不再选择 ComboBox，该值将实际保存。我想解决方法是在组合框的值更改后专注于其他事情。如果这似乎是最好的方法，我将如何挂钩 Datagridview 中组合框的 SelectedIndexChanged 事件？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T07:05:18.897

我认为，如果您检查，如果您在单击保存按钮之前没有移出单元格，那么 datagridview 中的其他列实际上会发生同样的事情。好消息是您只需要添加一行代码。

```
FinancialDataGridView.CommitEdit(DataGridViewDataErrorContexts.CurrentCellChange) 
```

现在您的 SaveItem_Click 事件处理程序应如下所示：

```
Private Sub FinancialBindingNavigatorSaveItem_Click(sender As System.Object, e As System.EventArgs) Handles FinancialBindingNavigatorSaveItem.Click
    FinancialDataGridView.CommitEdit(DataGridViewDataErrorContexts.CurrentCellChange)
    db.SaveChanges()
End Sub 
```

这将在保存之前提交脏单元格。

见[https://stackoverflow.com/a/6469559/269123](https://stackoverflow.com/a/6469559/269123)

# ruby - 在多个 SSH 隧道上运行 MySQL 查询？

> ID：12416733
> 
> 赞同：3
> 
> 时间：2012-09-14T00:43:26.610
> 
> 标签：ruby, ssh, net-ssh

我的情况有点类似于“[如何在 ruby​​ 中创建 ssh 隧道，然后连接到远程主机上的 mysql 服务器](https://stackoverflow.com/questions/4103809/how-to-create-a-ssh-tunnel-in-ruby-and-then-connect-to-mysql-server-on-the-remot)”。

在我的本地机器上，我想对生产 MySQL 数据库主机运行查询。我的本地机器无法直接连接到数据库主机。但是，如果我通过 SSH 连接到网关机器，我可以运行 MySQL 客户端并连接到数据库主机。

我试图弄清楚如何以编程方式从我的机器运行一个查询，该查询被转发到网关机器，网关机器将其转发到数据库服务器，并返回结果。基本上我想要`LOCAL => GATEWAY => DB_HOST`转发。

我有一个在命令行上运行`ssh.exec`和 MySQL 的 hacky 解决方案，如下所示，但是，我正在尝试找到一种进行两次端口转发的方法。我试过了，但到目前为止还没有成功。

```
require 'rubygems'  
require 'mysql2'  
require 'net/ssh/gateway' 

gateway = Net::SSH::Gateway.new(
  $gateway_host, $gateway_user,:password => $gateway_pass)

# This works
ssh = gateway.ssh($db_host, $db_login_user)
data = ssh.exec!("mysql -u#{$db_user} -p#{$db_pass} #{$db_name} -e '#{$sql_query}'")
puts "#{data.class} is the class type"
puts data

# Want to do something like this with port forwarding
# client = Mysql2::Client.new(:host => $db_host,
#                            :username => $db_user,
#                            :password => $db_pass,
#                            :database => $db_name,
#                            :port => port)
# results = client.query($sql_query)

puts "end stuff"
ssh.close 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-21T14:34:56.027

您的图表很好地展示了它，您需要从网关到 Db_Host 的隧道；以及从本地计算机到网关的第二条隧道。这两条隧道将通过网关有效地将您的本地计算机连接到 db_host。

这是特定于[通过 SSH 隧道连接 MySQL的参考](http://chxo.com/be2/20040511_5667.html)

# c# - Containskey VS Try Catch

> ID：12416735
> 
> 赞同：11
> 
> 时间：2012-09-14T00:43:51.820
> 
> 标签：c#, dictionary, try-catch, containskey

我有一个 Vector2 的 Generated 列表，我必须检查字典以查看它们是否存在，这个函数在每个滴答声中执行。

以这种方式运行最快/更好？

```
 public static bool exists(Vector2 Position, Dictionary<Vector2, object> ToCheck)
    {
        try
        {
            object Test = ToCheck[Position];
            return (true);
        }
        catch 
        {
            return (false);
        }           
    } 
```

还是我应该坚持规范？

```
 public static bool exists(Vector2 Position, Dictionary<Vector2, object> ToCheck)
    {
        if (ToCheck.ContainsKey(Position))
        {
            return (true);
        }
        return (false);
    } 
```

感谢您的输入:)

旁注：（此时键的值无关紧要，否则我将使用 TryGetValue 而不是 ContainsKey）

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-02T12:05:47.300

我知道这是一个老问题，但只是添加一些经验数据......

在包含 10,000 个条目的字典上运行 50,000,000 次查找并比较完成的相对时间：

..如果每次查找都成功：

*   直接（未经检查）运行需要 1.2 秒
*   受保护的 (ContainsKey) 运行需要 2 秒
*   处理（try-catch）运行需要 1.21 秒

..如果每 10,000 次查找中有 1 次失败：

*   受保护的 (ContainsKey) 运行需要 2 秒
*   处理（try-catch）运行需要 1.37 秒

..如果每 10,000 次查找中有 16 次失败：

*   受保护的 (ContainsKey) 运行需要 2 秒
*   处理（try-catch）运行需要 3.27 秒

..如果每 10,000 次查找中有 250 次失败：

*   受保护的 (ContainsKey) 运行需要 2 秒
*   处理（try-catch）运行需要 32 秒

..因此，受保护的测试将增加恒定的开销，仅此而已，并且如果它从不失败，try-catch 测试的运行速度几乎与没有测试一样快，但会与失败的数量成比例地降低性能。

我用来运行测试的代码：

```
using System;
using System.Collections.Generic;

namespace ConsoleApplication1
{
   class Program
   {
      static void Main(string[] args)
      {  Test(0);
         Test(1);
         Test(16);
         Test(250);
      }

      private static void Test(int failsPerSet)
      {  Dictionary<int, bool> items = new Dictionary<int,bool>();

         for(int i =  0; i < 10000; i++)
            if(i >= failsPerSet)
               items[i] = true;

         if(failsPerSet == 0)
            RawLookup(items, failsPerSet);

         GuardedLookup(items, failsPerSet);

         CaughtLookup(items, failsPerSet);

      }

      private static void RawLookup
      (  Dictionary<int, bool> items
      ,  int             failsPerSet
      ){ int                   found = 0;
         DateTime              start ;

         Console.Write("Raw     (");
         Console.Write(failsPerSet);
         Console.Write("): ");

         start = DateTime.Now;
         for(int i = 0; i < 50000000; i++)
         {  int pick = i % 10000;
            if(items[pick])
               found++;
         }

         Console.WriteLine(DateTime.Now - start);
      }

      private static void GuardedLookup
      (  Dictionary<int, bool> items
      ,  int             failsPerSet
      ){ int                   found = 0;
         DateTime              start ;

         Console.Write("Guarded (");
         Console.Write(failsPerSet);
         Console.Write("): ");

         start = DateTime.Now;
         for(int i = 0; i < 50000000; i++)
         {  int pick = i % 10000;
            if(items.ContainsKey(pick))
               if(items[pick])
                  found++;
         }

         Console.WriteLine(DateTime.Now - start);
      }

      private static void CaughtLookup
      (  Dictionary<int, bool> items
      ,  int             failsPerSet
      ){ int                   found = 0;
         DateTime              start ;

         Console.Write("Caught  (");
         Console.Write(failsPerSet);
         Console.Write("): ");

         start = DateTime.Now;
         for(int i = 0; i < 50000000; i++)
         {  int pick = i % 10000;
            try
            {  if(items[pick])
                  found++;
            }
            catch
            {  
            }
         }

         Console.WriteLine(DateTime.Now - start);
      }

   }
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-09-14T00:45:57.573

一定要用`ContainsKey`支票；异常处理会[增加很大的开销](http://msdn.microsoft.com/en-us/library/ms229009%28v=vs.100%29.aspx)。

> 抛出异常会对性能产生负面影响。对于经常失败的代码，您可以使用设计模式来最大程度地减少性能问题。

异常不适用于您可以检查的条件。

我建议阅读有关[异常](http://msdn.microsoft.com/en-us/library/ms229014%28v=vs.100%29.aspx)的 MSDN 文档，特别是有关[异常处理](http://msdn.microsoft.com/en-us/library/ms229005%28v=vs.100%29.aspx)的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T00:48:24.730

切勿将 try/catch 用作**常规**程序路径的一部分。它确实很昂贵，并且应该只捕获您无法阻止的错误。ContainsKey 是这里的方法。

旁注：不，你不会。如果该值很重要，请使用 ContainsKey 检查它是否存在并检索它（如果存在）。不尝试/抓住。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T02:26:39.923

> 旁注：（此时键的值无关紧要，否则我将使用 TryGetValue 而不是 ContainsKey）

您接受的答案是正确的，但只是补充一下，如果您只关心键而不关心值，也许您正在寻找 a`HashSet`而不是 a `Dictionary`？

此外，您的第二个代码片段是一种从字面上添加零值的方法。只需使用`ToCheck.ContainsKey(Position)`，不要创建仅调用该方法并返回其值但不执行其他任何操作的方法。

# mongodb - Mongo：获取另一个集合中未引用的文档

> ID：12416737
> 
> 赞同：1
> 
> 时间：2012-09-14T00:44:22.447
> 
> 标签：mongodb

假设我的 Mongo 数据库中有两个集合：`A`& `B`。每个`A`文档都可能有对 的引用`B`，但`B`文档没有对 的引用`A`。

我怎样才能有效地找到文档中`B`未**引用**的所有文档`A`？

有没有比检索所有文档`B`并手动与`A`文档进行比较更有效的方法？这可以用map reduce来完成吗？

我应该考虑添加来自`B`to`A`的引用来支持查询吗？由于 Mongo 不支持事务，因此我避免了任何两种方式的引用，以避免在发生故障时出现任何不一致的状态。

此外，如果这会影响解决方案，我需要能够有效地翻阅这些结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T01:48:26.240

在伪代码中：

```
// Get the set of B document ids that are referenced by A documents.
var bref_ids = db.A.distinct('b_id');

// Get the set of all other B documents.
var unreferenced_b_docs = db.B.find({_id: {$nin: bref_ids}}); 
```

# heroku - 如何使用 heroku 的临时文件系统

> ID：12416738
> 
> 赞同：59
> 
> 时间：2012-09-14T00:44:52.417
> 
> 标签：heroku, filesystems

我在 Heroku（Cedar Stack）上使用 Python/Django，并且我有一个需要编写的管理命令，它将从 S3 存储桶中拉出一个文件并进行处理。我不确定我是否了解如何使用临时文件系统。是否只有某些可写的目录？我发现另一篇文章暗示只有某些文件夹是可写的（但是，它似乎不适用于 Cedar 堆栈）。我找到了这篇开发[文章](https://devcenter.heroku.com/articles/dynos#ephemeral-filesystem)，但没有详细介绍（注意：我明白这只是暂时的。我只需要解压缩文件并处理文件）。我可以在应用程序根目录下的任何位置创建一个文件夹吗？我怎么会得到它？看来我可能只使用 $HOME。我通过连接到 via 做了一些测试

```
$ heroku run bash 
```

并运行：

```
$ echo #HOME 
```

返回：

/应用程序

并运行：

```
$ mkdir $HOME/tmp 
```

在应用程序的根目录中创建一个文件夹，并提供与其他文件和文件夹相同的用户和组。

所以......我在这里错过了什么？有更好的方法吗？是否有为此的操作系统环境变量？我已经运行了“env”，但没有看到更好的。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-09-14T06:06:17.337

要真正了解临时文件系统，您需要了解什么是测功机。您可以阅读有关[dynos 工作原理](https://devcenter.heroku.com/articles/dynos)的更多信息。不过，简而言之，一个进程在 Heroku 上运行在具有自己文件系统的虚拟机中。该虚拟机可能会因多种原因停止，同时带走文件系统。

当应用程序重新启动、重新配置（例如`heroku config ...`）、缩放等时，底层文件系统将被破坏。例如，如果您有两个 web dyno，将一些文件写入临时文件系统，然后扩展到三个 dyno，这些文件将被破坏因为您的应用程序正在新的测功机上运行。

一般来说，临时文件系统就像任何文件系统一样工作。您有权写入的目录，例如`$HOME`和`/tmp`，您可以向其中写入文件。任何需要持久性的文件都应写入 S3 或类似的持久性存储。S3 是首选，因为 Heroku 在 AWS 上运行，并且 S3 提供了一些性能优势。任何可以随意重新创建的文件都可以存储在测功机的临时存储中。

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2012-09-14T01:16:23.567

您可以在“/tmp”目录下创建一个文件，该文件将在请求完成后销毁。我在 Cedar 上做这个，我没有遇到任何问题。

# sql - 将以下 sql 查询转换为 lambda 表达式

> ID：12416751
> 
> 赞同：1
> 
> 时间：2012-09-14T00:47:18.743
> 
> 标签：sql, linq

如何将以下 sql 查询转换为 lambda 表达式？

```
select cg.Code, ci.ChangeType, SUM(oc.Value) from OtherCharges oc 
left join changeitems ci on oc.ChangeItemKey = ci.ChangeItemKey
left join ChangeGroups cg on ci.ChangeGroupKey = cg.ChangeGroupKey
where OtherKey = 'AB235A00-FEB2-4C4F-B0F9-3239FD127A8F'
group by cg.Code, ci.ChangeType
order by cg.Code, ci.ChangeType 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T20:33:47.357

假设您的表已经有 .NET 域类型：

```
IQueryable<OtherCharges> otherCharges = ...
Guid otherKey = ...

var query = otherCharges.Where(oc => oc.OtherKey == otherKey)
    .Select(oc => new { oc.ChangeItem, oc.Value })
    .GroupBy(t => new { t.ChangeItem.ChangeGroup.Code, t.ChangeItem.ChangeType })
    .OrderBy(g => g.Key.Code)
    .ThenBy(g => g.Key.ChangeType)
    // note that if Code is a non-nullable type you'll want to cast it to int? at some
    // point so that when pulled into memory EF won't complain that you can't cast
    // null to a non-nullable type. I expect that Code could sometimes be null here
    // do to your use of LEFT OUTER JOIN in the T-SQL
    .Select(g => new { g.Key.Code, g.Key.ChangeType, Sum = g.Sum(t => t.Value) });

var inMemoryResult = query.ToList(); 
```

请注意，我在这里使用的是 OtherCharge.ChangeItem 和 ChangeItem.ChangeGroup。这些是关联属性，需要作为模型的一部分进行设置（例如，首先对 EF 代码使用流畅的配置）。

# php - Zend_Auth_Adapter_DbTable 和 PHP crypt

> ID：12416752
> 
> 赞同：3
> 
> 时间：2012-09-14T00:47:24.950
> 
> 标签：php, zend-framework, zend-auth, crypt

我正在使用 PHP crypt() 在 Zend php 应用程序中对我的密码进行哈希处理。但是，我想不出将这个散列与 Zend_Auth_Adapter_DbTable 一起使用的解决方案。假设我在使用 crypt() 运行后存储了一个密码哈希...

```
 //Salt and hash...
    $salt = '$2a$07$'.$this->getSalt();
    $data['password'] = crypt($user_object->password, $salt);
    $this->_db_table->insert($data);

    //Authentication...
    $dbAdapter = Zend_Db_Table::getDefaultAdapter();
    $authAdapter = new Zend_Auth_Adapter_DbTable($dbAdapter);
    $authAdapter->setTableName('users')
                ->setIdentityColumn('username')
                ->setCredentialColumn('password')
                //Now what? Possibly...
                ->setCredentialTreatment(/* But how? */); 
```

如何将 Zend_Auth_Adapter_DbTable 表对象与这种加盐和散列策略一起使用？我环顾四周，但真的找不到 MD5 和 SHA 类型散列之外的任何解决方案......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T01:57:03.890

如果您将 Salt 存储在用户表中，您应该创建自己的适配器

如果您在其他地方有盐，您只需要加密密码，然后将其传递给适配器

```
$authAdapter->setCredential($cryptedPassword); 
```

几周前我有同样的问题，我最终创建了自己的适配器，扩展 Zend_Auth_Adapter_DbTable

我实际上向后移植了 ZF2 Bcrypt 库，但您应该能够将它与 crypt 方法一起使用。

看看你是否想要[AuthAdapter-DbTableBcrypt](https://github.com/rumeau/zf1-authadapter-dbtablebcrypt)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T03:05:22.330

所以我写了自己的适配器来克服这个问题。只需包含该文件，将其传递给 Zend_Auth 适配器的身份验证函数以及详细信息（这里我使用的是带有电子邮件和密码的登录）：

```
class User_Authenticate_Adapter implements Zend_Auth_Adapter_Interface {
  protected $_username;
  protected $_password;

  public function __construct($email, $password) {
    $this->_email = $email;
    $this->_password = $password;
  }
  public function authenticate() {

    $dbTable = new Application_Model_DbTable_User();
    $select = $dbTable->select()->where('email = ?', $this->_email);
    $row = $dbTable->fetchRow($select);

    if($row == null) {
        return new Zend_Auth_Result(Zend_Auth_Result::FAILURE_IDENTITY_NOT_FOUND,$this->_email);
    }
    $data = $row->toArray();
    if(!crypt($data['password'], $this->_password)) {
        return new Zend_Auth_Result(Zend_Auth_Result::FAILURE_CREDENTIAL_INVALID,$this->_email);
    }
    else {
        return new Zend_Auth_Result(Zend_Auth_Result::SUCCESS);
    }

  }
} 
```

希望对某人有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-11T06:59:48.280

之前获取密码并将其用作 crypt 函数中的盐

```
$dbUser = new Application_Model_DbTable_User;
$data = $dbUser->fetchRow(array("username = ?" => $_POST["username"]));
$cryptedPassword = $data->password; // here is the salt

$authAdapter->setIdentity($_POST["username"])
            ->setCredential(crypt($_POST["password"], $cryptedPassword)); 
```

# objective-c - 应用程序在 iPhone 模拟器上运行，但在真正的 iPhone 设备上崩溃

> ID：12416753
> 
> 赞同：1
> 
> 时间：2012-09-14T00:47:33.097
> 
> 标签：objective-c, cocos2d-iphone

今天我尝试在我的 iPhone 设备上运行我的应用程序，但它崩溃了！它在模拟器上运行得很好，我不知道问题是什么。

这些是崩溃日志：

```
Identifier:      Evader
Version:         ??? (???)
Code Type:       ARM (Native)
Parent Process:  launchd [1]

Date/Time:       2012-09-13 16:41:54.656 -0700
OS Version:      iPhone OS 5.1.1 (9B206)
Report Version:  104

Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x00000000, 0x00000000
Crashed Thread:  0

Last Exception Backtrace:
0   CoreFoundation                  0x377d888f __exceptionPreprocess + 163
1   libobjc.A.dylib                 0x354dd259 objc_exception_throw + 33
2   CoreFoundation                  0x377d8789 +[NSException raise:format:] + 1
3   Foundation                      0x380173a3 -[NSAssertionHandler                         handleFailureInMethod:object:file:lineNumber:description:] + 91
4   Evader                          0x0012ca41 -[CCSprite initWithTexture:] (CCSprite.m:192)
5   Evader                          0x0012c1b1 +[CCSprite spriteWithTexture:] (CCSprite.m:83)
6   Evader                          0x0011eb3d -[CCProgressTimer initWithTexture:] (CCProgressTimer.m:69)
7   Evader                          0x0011ea55 -[CCProgressTimer initWithFile:] (CCProgressTimer.m:59)
8   Evader                          0x0011e9e1 +[CCProgressTimer progressWithFile:] (CCProgressTimer.m:55)
9   Evader                          0x00173579 -[HelloWorldLayer lives] (HelloWorldLayer.m:256)
10  Evader                          0x001723ed -[HelloWorldLayer init] (HelloWorldLayer.m:101)
11  Evader                          0x0010f073 +[CCNode node] (CCNode.m:258)
12  Evader                          0x0017bd11 -[StartMenu doThis:] (StartMenu.m:75)
13  CoreFoundation                  0x377db7e4 __invoking___ + 68
14  CoreFoundation                  0x377367b1 -[NSInvocation invoke] + 161
15  Evader                          0x0010aa03 -[CCMenuItem activate] (CCMenuItem.m:129)
16  Evader                          0x001085ff -[CCMenu ccTouchEnded:withEvent:] (CCMenu.m:198)
17  CoreFoundation                  0x377323fd -[NSObject performSelector:withObject:withObject:] + 53
18  Evader                          0x0014f4ff -[CCTouchDispatcher touches:withEvent:withTouchType:] (CCTouchDispatcher.m:268)
19  Evader                          0x0014fc43 -[CCTouchDispatcher touchesEnded:withEvent:] (CCTouchDispatcher.m:338)
20  Evader                          0x001515c3 -[EAGLView touchesEnded:withEvent:] (EAGLView.m:332)
21  UIKit                           0x314c692b -[UIWindow _sendTouchesForEvent:] + 319
22  UIKit                           0x314c6319 -[UIWindow sendEvent:] + 381
23  UIKit                           0x314ac695 -[UIApplication sendEvent:] + 357
24  UIKit                           0x314abf3b _UIApplicationHandleEvent + 5827
25  GraphicsServices                0x33eee22b PurpleEventCallback + 883
26  CoreFoundation                  0x377ac523 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 39
27  CoreFoundation                  0x377ac4c5 __CFRunLoopDoSource1 + 141
28  CoreFoundation                  0x377ab313 __CFRunLoopRun + 1371
29  CoreFoundation                  0x3772e4a5 CFRunLoopRunSpecific + 301
30  CoreFoundation                  0x3772e36d CFRunLoopRunInMode + 105
31  GraphicsServices                0x33eed439 GSEventRunModal + 137
32  UIKit                           0x314dacd5 UIApplicationMain + 1081
33  Evader                          0x00171029 main (main.m:14)
34  Evader                          0x000dec68 start + 40

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   libsystem_kernel.dylib          0x3198f32c __pthread_kill + 8
1   libsystem_c.dylib               0x3408c208 pthread_kill + 48
2   libsystem_c.dylib               0x34085298 abort + 88
3   libc++abi.dylib                 0x36f12f64 abort_message + 40
4   libc++abi.dylib                 0x36f10346 _ZL17default_terminatev + 18
5   libobjc.A.dylib                 0x354dd350 _objc_terminate + 140
6   libc++abi.dylib                 0x36f103be _ZL19safe_handler_callerPFvvE + 70
7   libc++abi.dylib                 0x36f1044a std::terminate() + 14
8   libc++abi.dylib                 0x36f1181e __cxa_rethrow + 82
9   libobjc.A.dylib                 0x354dd2a2 objc_exception_rethrow + 6
10  CoreFoundation                  0x3772e506 CFRunLoopRunSpecific + 398
11  CoreFoundation                  0x3772e366 CFRunLoopRunInMode + 98
12  GraphicsServices                0x33eed432 GSEventRunModal + 130
13  UIKit                           0x314dacce UIApplicationMain + 1074
14  Evader                          0x00171022 main (main.m:14)
15  Evader                          0x000dec60 start + 32 
```

我试图寻找错误，但我不知道要寻找什么。有人可以帮助解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T00:57:58.147

`CCSprite initWithTexture:`引发导致您的应用退出的异常。我并不完全了解 Cocos2d，但对文档的快速检查表明它会在找不到命名文件时引发异常。

既然如此，我猜问题只是文件名大小写之一。Mac 默认情况下不区分大小写。所以如果你有FunnyImage.png，那么如果你尝试加载funnyimage.png，模拟器就会成功。

iOS 设备区分大小写。因此，如果您尝试加载funnyimage.png，它将失败。

因此，您可能想要做的是检查您在代码中使用的所有文件名是否与实际文件的大小写完全匹配。

# memory-management - 不同的数据类型是否分配不同数量的内存？

> ID：12416754
> 
> 赞同：0
> 
> 时间：2012-09-14T00:48:02.523
> 
> 标签：memory-management

例如，如果我添加一个短整数和一个浮点数据类型，它们会分配相同数量的内存吗？它们有不同的最大值，但也有不同的数据结构，所以我不确定。此外，不同数据类型的数学运算是否需要不同的时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T00:50:59.497

如果不知道您使用的是哪种语言/硬件，很难准确回答这个问题，但在大多数情况下，不同的数据类型确实会占用不同数量的内存，并且数据类型会影响数学运算的速度。例如，在 Java 和 C# 中，short 是 16 位，float 是 32 位。我希望浮点数学通常比整数数学慢，尽管这可能很复杂，如[本文](https://stackoverflow.com/questions/2550281/floating-point-vs-integer-calculations-on-modern-hardware "这个帖子")所述。

对于其他语言（例如 C），基本数据类型的大小取决于硬件，因此 int 在某些机器上可能是 32 位，而在其他机器上可能是 64 位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T00:53:54.090

我们有数据类型的原因是效率。这包括数据（类型）的大小和处理。

一个`char`数据类型有 8 位（你也可以这样称呼它，`8-bit integer`因为数值只是映射到 ASCII 表中的字符）= 256 个可能的值

A`32-bit integer`有...你猜对了 32 位 = 2³² 可能的值

通过移位或比较这些位来执行数学运算。

更多位 = 更多操作 = 更多时间

参考：[http ://en.wikipedia.org/wiki/Data_type](http://en.wikipedia.org/wiki/Data_type)

# php - 无法写入文件，即使 is_writable 返回 true

> ID：12416759
> 
> 赞同：5
> 
> 时间：2012-09-14T00:48:28.607
> 
> 标签：php, file-io, permissions, fopen

有人对此有任何想法吗？我用`file_exists()`and检查文件`is_writable()`，两者都返回 true。我也将目录和文件设置`777`为安全，但**尝试 fwrite() 或 file_put_contents() 都不会导致文件发生变化**

以下是相关代码：

```
$filePath = dirname( __FILE__ ) . '/' . 'myfile.txt';
file_put_contents($filePath, "waffles are delicious"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T14:32:21.173

您已经检查了文件的权限，还查看了所有权。

我经常看到使用原始系统的 uid/gid 从档案中解压缩文件的问题。当您上传并解压框架、CMS 或论坛的 zip 或 tar.gz 安装存档而不是等待所有文件通过 FTP 上传时，通常会出现这种情况。

要更改文件所有者，您需要`chown`在 shell 中执行命令将其更改为您帐户的用户名/组。您可能需要成为 root/su 才能执行此操作。

```
chown -R username:groupname *
```

`-R`使其递归并适用于所有子目录中的所有文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T05:55:09.853

尝试删除关闭 php 标记以确保这不是空格问题。

# java - 高效的 2D 径向重力布局 (Java)

> ID：12416760
> 
> 赞同：1
> 
> 时间：2012-09-14T00:48:40.143
> 
> 标签：java, layout, graphics, box2d, gravity

我追求一种高效的 2D 映射算法，并且我尝试了许多实现，但它们似乎都缺乏。我希望 stackoverflow 世界可以提供一些指向我可以从中学习的现有、久经考验的算法的指针。

我的目标是根据写作体裁展示文章；对于原型，我使用哲学、编程、政治和诗歌，因为这是我仅有的四种写作风格。

每篇文章根据每个类别进行加权，首页视图将每个类别作为每个角落的标题。然后文章以类似词云的格式排列，“人工重力”将每个项目尽可能靠近其主要类别（或在其主要类别之间），而不重叠。

目前，我正在使用一种效率低下的算法，该算法存储矩形数组以在每次将文章添加到视图时执行命中测试和搜索（使用 A* 搜索模式来查找要填充的空白空间）。通过为所有具有相同权重的文章近似单个目的地，并通过使用循环队列从每个池中挑选文章，我可以获得新的结果（数组按权重排序，然后是时间戳），定位相关性（“人为重力”）。

然而，使用 A* 进行盲目搜索似乎真的很浪费，即使使用启发式方法让每篇文章首先检查最接近它的目标标记。我需要一种更有效的方法来迭代 2D 空间。

我想知道链接列表方法是否会更好。而不是盲目地在各个方向搜索空白空间，我可以遍历连接的节点来询问每个节点是否有a）附近的可用空间，或者b）其他连接的节点要询问（并且总是首先询问最近的节点） .

如果有任何更好的算法可用，或对我的方法的批评，任何和所有的帮助肯定会受到赞赏。

我在这个 gui 中使用 gwt elemental + java，但是任何语言的任何 2D 映射算法肯定会有所帮助。

[EDIT (request for more details)]：这里的主要问题是每个新添加的工作量；它会在 ui 线程中产生明显的故障，尤其是在几乎没有剩余空间的情况下，因为我正在给定半径内搜索许多点以获得足够的可用空间来容纳文章。

如果我过早切断算法，我会得到本来可以填补的空白点。如果我让它运行太久，用户界面会出现非常糟糕的故障，我相信用户会讨厌它。

存储和修改 2D 空间集合的最快/最有效方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:00:30.493

您没有提供足够的信息来说明什么会使算法“更好”。快点？根据某些质量指标生成“更好”的布局？能够处理更大的数据源？

数组当然没有错，A* 也没有。如果他们给出的结果与你试图解决的问题的规模一样大，那么他们怎么能“浪费”呢？链接数据结构只有在减少经常需要的操作的成本时才有价值。

如果你把问题变得尖锐，你更有可能得到一个有用的答案。

无论如何，有大量关于“图形布局”和“图形绘制”的文献。尝试搜索这些术语。如果您可以将所需的布局表示为节点和边的集合，则这些可能适用。许多都基于模拟弹簧系统，这似乎类似于您正在做的事情。

# xcode - 可以对 Xcode 中的 arm 架构设置进行一些说明

> ID：12416761
> 
> 赞同：3
> 
> 时间：2012-09-14T00:48:45.637
> 
> 标签：xcode, xcode4, arm, ios6

据我了解，iPhone 5 将采用新架构，`armv7s`. 我的项目具有有效的架构`armv7`，并且已`Build Active Architecture Only`设置为`true`. 由于现在商店中的每个应用程序都是为`armv6`和/或构建的`armv7`，我无法想象它不会在新 iPhone 上运行。那么会发生什么？它只是没有运行得那么好吗？

我可以更好地解释正在发生的事情，以及一旦我重建并`armv7s`作为有效架构提交后会有什么不同。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-14T11:35:20.150

首先，它是**armv7**，而不是 arm7 （是的，有区别）。我似乎找不到任何有关细节的文档，但我想 armv7s 添加了对一些可选 ARMv7 功能的支持，例如 VFPv4/FMA 或 UDIV/SDIV 整数除法指令。除非您的应用程序处理大量数学或图形，否则我无法想象差异会很明显。

**编辑**：请参阅[此链接](https://github.com/llvm-mirror/llvm/commit/eb1641d54a7eda7717304bc4d55d059208d8ebed)以了解对 LLVM 所做的更改以支持 armv7s。从我所见，它确实只是 VFPv4 和整数除法，加上对指令调度程序的一些更改。显然 CPU 代号是“Swift”。

# python-2.7 - 我的程序不会从命令提示符运行

> ID：12416764
> 
> 赞同：0
> 
> 时间：2012-09-14T00:49:11.057
> 
> 标签：python-2.7

我在这里需要帮助 我为我的实验室编写了代码“循环将使用每次循环完成时递增 1 的变量的值迭代总共 10 次”。**强文本**，但是当我通过单击运行我的python文件时，只需打开它就拒绝在命令提示符下运行...当我在使用 IDLE 的编辑中进行测试时，它运行良好...我不知道为什么它不会运行...这里是我为我的代码写的：

```
 counter = 0
   while counter < 10:
         counter = counter + 1
          print counter
    print "the loop is finished" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:54:47.057

也许它只是完成得太快了。

您是否尝试过`raw_input()`在文件底部添加一个？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:53:58.720

看起来您有缩进错误（主要是打印语句比它们上面的代码缩进一个空格）。

这对你有用吗：

```
counter = 0
    while counter < 10:
        counter = counter + 1
        print counter
    print "the loop is finished" 
```

Python 有严格的缩进规则，如果你想了解更多关于它们的信息，我建议阅读[这个 wikipedia page](http://en.wikipedia.org/wiki/Python_syntax_and_semantics)，它非常好。

# python - 在 Scipy（或其他库）中是否有与 Python 的 matlab 'idealfilter' 等效的东西？

> ID：12416772
> 
> 赞同：13
> 
> 时间：2012-09-14T00:50:37.290
> 
> 标签：python, matlab, opencv, scipy, dct

我正在为 Python 寻找在 Matlab 中实现的时间序列[Idealfilter的等效项。](http://www.mathworks.com/help/matlab/ref/timeseries.idealfilter.html)

我的目标是使用 Python 中的[欧拉视频放大论文](http://people.csail.mit.edu/mrub/vidmag/)中使用的离散余弦变换实现一个理想的过滤器，以便从标准视频中获取人类的心跳。我正在使用他们的视频作为我的输入，并且我已经实现了带通滤波器方法，但是我无法找到一个可以在我的脚本中使用的理想滤波器方法。

他们声明他们使用 0.83 - 1.0Hz 的 DCT 实现了一个理想的滤波器。

我的问题是 Matlab 中的理想滤波器将截止频率作为输入，但我不认为它是用 dct 实现的。

相反，在 scipy.fftpack 中找到的 DCT 滤波器不会将频率截止值作为输入。

如果我必须以某种类型的连续使用这些，请告诉我。

如果存在这样的等效功能，我想尝试使用它，看看它是否会产生与他们获得的结果相似的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T23:06:06.767

非因果意味着您的过滤器取决于未来的输入。DCT 是一种变换，而不是过滤器。你想要一个过滤器。

您想对指定范围内的数据应用带通滤波器，所以我会使用巴特沃斯滤波器。

这是一些示例代码：[https ://stackoverflow.com/a/12233959/1097117](https://stackoverflow.com/a/12233959/1097117)

所有这一切中最棘手的部分是根据您的奈奎斯特频率获取所有信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T08:48:25.463

我也许值得看看[statsmodel 库的时间序列分析模块。](http://statsmodels.sourceforge.net/stable/tsa.html#other-time-series-filters)这个模块实现了几个时间序列过滤器，包括我*认为*是非因果的 Hodrick-Prescott 过滤器。

# javascript - 使用 window.location 是一种安全的方式来检查您的脚本是否仅包含在特定站点上？

> ID：12416773
> 
> 赞同：1
> 
> 时间：2012-09-14T00:50:48.073
> 
> 标签：javascript, security, window.location

我正在构建一项服务，客户将在他们的网站上包含一个脚本。我将根据客户对脚本的使用情况（它连接到我的服务器以使用该服务。）向客户收费，并且我还有一个 iFrame 版本。检查他们的 window.location.host 以检查脚本是否发布在他们自己的网站上是否安全？客户可以选择指定多个域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:58:32.993

总的来说，你不应该，请继续阅读。

我相信，如果您进行更改，`window.location`则浏览器会导航到该页面。因此，没有浏览器导航到新页面，没有人能够更改`window.location`以欺骗您的脚本。

但是没有什么能阻止任何人下载 .js 文件并对其进行编辑以删除您的检查。（或者像 Sime 所说，他们可能使用的是非标准浏览器）

（确认这发生在 Firefox 上）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:58:32.340

不可以。所有的 Javascript 都在客户端运行，并且作为一项规则，您永远不能依赖客户端验证。

# android - 无法正常打开draw9patch.bat

> ID：12416779
> 
> 赞同：1
> 
> 时间：2012-09-14T00:51:33.930
> 
> 标签：android

我安装了最新版本的Android SDK，并使用SDK Tool Revision 20.0.3，然后我双击'draw9patch.bat'，我希望它可以显示一个UI，不幸的是，bat文件只是运行过去，确实如此不显示用户界面。然后我尝试双击“hierarchyviewer.bat”，程序也不显示用户界面。我不知道为什么，我可以从互联网上找到解决这个问题的方法，所以我向你们寻求帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-14T05:19:36.727

确保为 java 设置环境路径。打开命令提示符并导航到 android-sdk\tools\lib 文件夹并键入**java -jar draw9patch.jar**按 enter 。如果这个 .jar 文件没有问题，现在您可以看到 UI 屏幕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-25T18:54:46.050

可能，“find_java.bat”和它相关的垃圾 exe 在做它应该做的一件事时惨遭失败。我不知道它应该如何工作或为什么会失败，我也不在乎。Java 已安装，但此 exe 失败 - 所以清除该死的依赖并完成它。谁知道呢，也许 find_java.exe 是一些该死的 NSA 病毒——以前从来没有为我工作过（也许它找不到 64 位 Java ......毫无价值的垃圾）。

嗯，是的，无论如何...

转到 draw9patch.bat 并更改这三行：

```
set java_exe=
call lib\find_java.bat
if not defined java_exe goto :EOF 
```

为此（使用您的 Java 路径）：

```
set java_exe=C:\Program Files\Java\jdk1.7.0_21\bin\java.exe 
```

然后，您甚至应该能够使用另一个 bat 文件运行 draw9patch.bat 以方便您在新的 bat 中执行以下操作：

```
call "C:\Program Files (x86)\Android\android-sdk\tools\draw9patch.bat" 
```

不知道为什么一年前没有这个“答案”。打开命令提示符...请。:P

# c# - ASP.NET MVC 4 中的 Global.asax.cs 文件中正在执行什么模式？

> ID：12416780
> 
> 赞同：7
> 
> 时间：2012-09-14T00:51:42.080
> 
> 标签：c#, asp.net-mvc, design-patterns, asp.net-mvc-4, global-asax

我从来没有在这里遇到过这种代码模式。有人愿意向我解释吗？*（或者这里甚至有一个模式？这样做有什么原因吗？这样做有什么好处？）*我是一般编程的新手，这对我来说非常有趣：

**全球.asax.cs**

```
 protected void Application_Start()
    {
        AreaRegistration.RegisterAllAreas();

        WebApiConfig.Register(GlobalConfiguration.Configuration);
        //...
        RouteConfig.RegisterRoutes(RouteTable.Routes);
        //...
    } 
```

**WebApiConfig.cs**

```
public static class WebApiConfig
{
    public static void Register(HttpConfiguration config)
    {
        config.Routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional }
        );
    }
} 
```

**路由配置.cs**

```
public class RouteConfig
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            name: "Default",
            url: "{controller}/{action}/{id}",
            defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
        );
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-14T01:13:34.417

这不是[单一职责原则 (SRP)](http://en.wikipedia.org/wiki/Single_responsibility_principle)的示例。在 Global.asax 中，我们知道设置所需的高级任务，但我们将实现分开。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-14T01:17:48.527

您可以像这样轻松地在示例中编写代码：

```
protected void Application_Start()
{
    AreaRegistration.RegisterAllAreas();

    GlobalConfiguration.Configuration.Routes.MapHttpRoute(
        name: "DefaultApi",
        routeTemplate: "api/{controller}/{id}",
        defaults: new { id = RouteParameter.Optional });

    RouteTable.Routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    RouteTable.Routes.MapRoute(
        name: "Default",
        url: "{controller}/{action}/{id}",
        defaults: new { 
            controller = "Home", 
            action = "Index", 
            id = UrlParameter.Optional });
} 
```

但是，随着必要配置数量的增加，将其拆分为几个逻辑相关的块是有意义的。ASP.NET MVC 很好地支持这一点，默认项目模板只是试图引导您这样做。

# python - Python 中 xlrd 模块的 open_workbook() 参数是否具有动态值？

> ID：12416787
> 
> 赞同：0
> 
> 时间：2012-09-14T00:53:01.993
> 
> 标签：python, python-2.7

我试图将动态值作为参数放在 xlrd 的 open_workbook() 函数中，但它给出了错误。我的示例代码是：

# ****** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** *****

 **导入 xlrd,os 文件路径=r'C:\Users\JJ\Desktop\JustForTest\2012_09_10'

对于 os.walk(filepath) 中的根目录、目录、文件：

```
abc=files[0] # To convert List to string, files will be like ['Samplexyx.xls']

wb=xlrd.open_workbook(abc)
sh=wb.sheet_by_index(0)    
for rownum in range(sh.nrows):
    print(sh.row_values(rownum)) 
```

# ****** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** *****

 **在上面的代码中，abc 的值是动态变化的。当我运行上面的代码时，它给出的错误是：IOError: [Errno 2] No such file or directory: 'Samplexyx.xls'

我是使用 xlrd 和 Python 的新手。使用 xlrd 和 python 动态打开 xls 文件应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T01:01:28.140

它没有在正确的目录中查找文件

```
xlrd.open_workbook(os.path.join(filepath,abc)) 
```****

# java - 为什么 Eclipse 中的现有类不显示“运行为 jUnit 测试”？

> ID：12416788
> 
> 赞同：1
> 
> 时间：2012-09-14T00:53:23.817
> 
> 标签：java, eclipse, junit, junit4

我在 Eclipse 中将方法作为 jUnit 运行时遇到问题。我知道如何在我的 Mac 上的 Eclipse 中这样做，现在我正试图让它在 Ubuntu 12.04 上运行。

通常，如果您有类似...的方法

```
@Test
public void foo(){} 
```

...您可以右键单击该`foo`方法，其中一个选项是“Run as jUnit Test”。由于我开始尝试在我的 Ubuntu 机器上的 Eclipse 中使用 jUnit 测试，所以当我在一个全新的类中定义一个方法时，我看到了这个选项。例如，我使用以下方法创建了一个全新的类`test1`：

```
package all;

import org.junit.Test;

public class BabyClass {
    @Test
    public void test1(){}
} 
```

右键单击`test1`会给我“作为 jUnit 测试运行”选项，并且 jUnit 测试按预期工作。

但是，如果我进入我的一个较旧的类（在我尝试使用 jUnit 之前）并尝试通过右键单击其名称来将方法作为 jUnit 测试运行，那么运行为 jUnit 测试选项不存在，这令人费解。“旧”和“新”类都在同一个包中，以防相关。

有谁知道为什么我的旧类中的方法没有出现作为 jUnit 测试运行的选项？我应该做些什么来使选项出现吗？对我来说，这似乎有点像 Eclipse 中的错误。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T01:04:19.900

您不能对涉及泛型的类进行 jUnit 测试。

```
package all;

import org.junit.Test;

public class BabyClass<T> {
    @Test
    public void test1(){

    }
} 
```

婴儿类现在已参数化，但您不能再用它进行 jUnit 测试了。

# python - Python 传递格式说明符

> ID：12416790
> 
> 赞同：0
> 
> 时间：2012-09-14T00:53:39.770
> 
> 标签：python, string-formatting

我有一个包含 0.10 的字符串变量，我想将其格式化为打印出 0.10。有没有办法我可以以某种方式将所需的字符串格式传递给变量和相应的变量格式。

前任。

.10 变为 0.10（格式化 0.00）
.10 变为 0.100（格式化 0.000）
50.10 变为 50.1（格式化 0.0）

我使用的python版本是2.4。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T01:25:41.213

如果您希望格式可变：

```
>>> '%.*f' % (1,.1)
'0.1'
>>> '%.*f' % (2,.1)
'0.10'
>>> '%.*f' % (3,.1)
'0.100'
>>> '%*.*f' % (5,3,.1)
'0.100'
>>> '%*.*f' % (5,2,.1)
' 0.10'
>>> '%*.*f' % (5,1,.1)
'  0.1' 
```

参考：[Python 2.4.4，§2.3.6.2 字符串格式化操作](http://docs.python.org/release/2.4.4/lib/typesseq-strings.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T00:56:43.877

```
>>> '%.2f' % (float('.10'),)
'0.10' 
```

# c++ - 有没有更多的 C++ 方法来获取 EOF 代码？

> ID：12416792
> 
> 赞同：1
> 
> 时间：2012-09-14T00:53:45.560
> 
> 标签：c++

在 C 中，`EOF`是一个定义在`stdio.h`. 我想知道是否有与它等效的 C++（a`const int`或 sth）？

我要它干什么？例如，我可能想实现一个`SeekEof()`：

```
// Is there any non-space character remaining?
bool SeekEof(std::istream &in) { 
  int c(0);
  while ((c = in.peek()) != EOF &&
         (c == ' ' || c == '\t' || 
          c == '\r' || c == '\n')) in.get();
  return c == EOF ;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T01:23:31.757

```
std::char_traits<char>::eof()
std::char_traits<char16_t>::eof()
std::char_traits<char32_t>::eof()
std::char_traits<wchar_t>::eof() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T01:01:46.953

您也`stdio.h`可以在您的 c++ 应用程序中使用。但要小心使用它。它的愚蠢（-1）宏和-1到字节是255（0xff）。如果您检查 EOF 的输入字符，您可以以错误的文件结尾的结果结束。安全检查`eof`是使用 c/c++ 中的 feof() 和 c++ 中的 .eof() 方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T02:15:48.593

`<stdio.h>`当使用 C函数从文件或其他流中读取时`EOF`，某些函数返回一个特殊值，用于标记无法读取更多数据，因为您已到达文件末尾*或*出现错误。有`feof()`和功能，但只有在您检测到文件结束或错误情况*后才*`ferror()`应使用这些功能，以区分另一个。

 *例如，经典的 C 输入循环是：

```
int c; /* Note int, *not* char */
while ((c = getchar()) != EOF) {
    /* do something with c */
}
/* optional: */
if (ferror(stdin)) {
     /* an error occurred, not just end-of-file */
} 
```

C++ 有几个不同的重载`std::istream::get()`函数。其中一个不带参数并且行为与 C 非常相似`getchar()`：它返回一个`int`值，`EOF`如果没有更多数据可用：

```
int c;
while ((c = std::cin.get()) != EOF) {
   // do something with c
} 
```

你必须`#include <cstdio>`得到 的定义`EOF`。

另一个重载版本引用 a`char`并返回一个`istream&`可以测试的结果，以判断它是否能够读取任何内容：

```
char c;
while (std::cin.get(c)) {
    std::cout << c;
} 
```

有一个`eof()`函数（特别是`std::ios::eof()`）告诉您是否设置了文件结束标志。还有其他几个状态函数`good()`：`fail()`和`bad()`。[浏览此处获取更多信息。](http://www.cplusplus.com/reference/iostream/ios/)

*（注意：cplusplus.com 是一个很好的资源吗？如果不是，请告诉我，我会更改链接。）*

在任何情况下`feof()`，状态函数（对于`ferror()`CI/O，，，，，对于C++ I/O）不应该用作循环条件；相反，循环应该由您尝试输入时获得的结果控制，并且可以在循环终止后使用其他函数*来*确定它终止的原因。`eof()``fail()``bad()``good()`

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T00:56:31.327

std::fstream fileHandle.eof() [http://www.cplusplus.com/reference/iostream/ios/eof/](http://www.cplusplus.com/reference/iostream/ios/eof/)**

# python - 在 python 中处理图像

> ID：12416796
> 
> 赞同：0
> 
> 时间：2012-09-14T00:54:08.727
> 
> 标签：python, python-imaging-library

我有这组数据：

```
{5: 136018, 4: 131402, 6: 113441, 7: 94609, 8: 80752, 9: 69753, 10: 60322, 11: 51388, 
12: 44416, 13: 37638, 14: 31524, 15: 26275, 16: 22098, 17: 18458, 18: 15294, 19: 12207, 
20: 10209, 21: 8355, 22: 6826, 23: 5657, 24: 4554, 25: 3668, 26: 2907, 27: 2438, 28: 1923, 
29: 1609, 30: 1223, 31: 1000, 32: 821, 33: 693, 34: 492, 35: 381, 36: 315, 37: 263, 38: 218,
40: 170, 39: 164, 41: 103, 42: 94, 43: 58, 44: 48, 45: 40, 47: 36, 46: 30, 49: 22, 48: 21, 
50: 14, 51: 12, 53: 9, 52: 6, 54: 5, 55: 5, 56: 4, 57: 3, 64: 2, 58: 1, 59: 1, 60: 1, 
61: 1, 62: 1, 65: 1, 66: 1} 
```

我想要做的是从这些数据中创建一个图像。我知道这并不容易，但基本上我想使用 PIL 之类的东西来创建图像，我想用它显示一种条形图，我知道它也会是一个巨大的图像，因为数字很大（像136018）

那么我怎么可能用 Python 和 PIL 做到这一点呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T00:58:22.033

艰难的路。请改用[matplotlib](http://matplotlib.org/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T01:26:31.800

Ignacio 的建议很好 - 但这里有一个更简单的示例可以帮助您入门：

```
import pylab    # part of the matplotlib package - a simpler interface

data = {
    5: 136018, 4: 131402, 6: 113441, 7: 94609, 8: 80752, 9: 69753,
    10: 60322, 11: 51388, 12: 44416, 13: 37638, 14: 31524, 15: 26275,
    16: 22098, 17: 18458, 18: 15294, 19: 12207, 20: 10209, 21: 8355,
    22: 6826, 23: 5657, 24: 4554, 25: 3668, 26: 2907, 27: 2438, 28: 1923,
    29: 1609, 30: 1223, 31: 1000, 32: 821, 33: 693, 34: 492, 35: 381,
    36: 315, 37: 263, 38: 218, 40: 170, 39: 164, 41: 103, 42: 94, 43: 58,
    44: 48, 45: 40, 47: 36, 46: 30, 49: 22, 48: 21, 50: 14, 51: 12,
    53: 9, 52: 6, 54: 5, 55: 5, 56: 4, 57: 3, 64: 2, 58: 1, 59: 1, 60: 1,
    61: 1, 62: 1, 65: 1, 66: 1
}

xs = range(min(data), max(data)+1)
ys = [data.get(x, 0) for x in xs]

pylab.bar(xs, ys) 
```

给你 ![在此处输入图像描述](../Images/7cf852c764ed3f0edf378319bc06e2b3.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-14T00:58:34.577

尝试这样的事情：您必须`pixels`自然地修改零件

```
import PIL

image = PIL.Image.new('RGBA', (1000, 1000))
pixels = image.load()

print pixels[x, y]
pixels[x, y] = some_color 
```

# android - 服务插件中的 android phonegap 计时器在设备休眠时停止

> ID：12416797
> 
> 赞同：1
> 
> 时间：2012-09-14T00:54:11.173
> 
> 标签：android, cordova, timer, background-service

在过去的几天里，我正忙着为电话间隙应用程序启动和运行服务（使用 eclipse ide 和连接到我的计算机的设备（motorola defy android 2.3.））/该服务在应用程序运行时在后台运行关闭并安排了一个计时器，该计时器传递了在不规则时间启动我的应用程序的意图/一切都按预期工作/当应用程序关闭并且设备处于睡眠状态（屏幕为黑色）时，计时器仍在运行并且在预定时间设备被唤醒，锁被移除，应用程序启动/但是，当我从我的计算机上拔下我的设备时出现了糟糕的情况/当设备连接到我的计算机/当它没有连接到我的计算机时，定时器似乎只在睡眠模式下可靠工作，定时器仅在屏幕打开/当它时正确触发未开启它会随意触发，而且通常根本不会触发/我关闭了设备在充电时不应进入深度睡眠的选项/但是当设备连接到电源插座或计算机时它仍然可以工作

任何人都可以尝试解释原因可能是什么？

我能做些什么来确保计时器在设备睡眠时按原样运行吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-18T14:30:35.137

对不起，我的错，它没有完全回答你的问题

一种方法是在本机级别注册`ACTION_SCREEN_OFF`和`ACTION_SCREEN_ON`事件并将该事件传播到 phonegap 层（@html/js 级别）。

有关处理屏幕关闭和开启意图的更多详细信息，[请单击此处。](http://thinkandroid.wordpress.com/2010/01/24/handling-screen-off-and-screen-on-intents, "处理屏幕关闭和屏幕打开意图")

有关如何通知 UI 层的更多信息，[请单击此处。](https://stackoverflow.com/questions/7751522/android-phonegap-notify-javascript-when-an-asynctask-is-finished, "当 AsyncTask 完成时通知 javascript")

# perl - 我应该将解析 /var/log/.* 文件的 perl 脚本转换为守护进程吗？

> ID：12416799
> 
> 赞同：1
> 
> 时间：2012-09-14T00:55:03.700
> 
> 标签：perl, logging, daemon, file-handling

我正在编写一个 perl 脚本来解析，例如`/var/log/syslog`.

当日志中出现特定事件时，perl 脚本会触发进一步的后续任务。根据这篇文章的建议解析日志：

[命令行：监控日志文件并将数据添加到数据库](https://stackoverflow.com/questions/10801034/command-line-monitor-log-file-and-add-data-to-database)

我相信这是使用管道。

现在我希望这个脚本永远在后台运行。

这对我来说听起来像是一个守护进程，以下问题中引用的守护进程似乎很理想：

[如何在 linux 中将 Perl 脚本作为系统守护进程运行？](https://stackoverflow.com/questions/766397/how-can-i-run-a-perl-script-as-a-system-daemon-in-linux)

但是从这篇文章中，很明显守护进程没有打开的文件句柄。那么我怎样才能拥有一个守护进程，或者一个成为守护进程的 perl 脚本来监视日志文件呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T02:59:48.630

这并不能回答您的问题，但可以考虑另一种可能适合或不适合您的途径：

[rsyslog](http://www.rsyslog.com/)可以在记录特定消息时执行程序

请参阅用于设置触发器的[过滤条件](http://www.rsyslog.com/doc/rsyslog_conf_filter.html)、用于格式化传递给脚本的输出的[模板](http://www.rsyslog.com/doc/rsyslog_conf_templates.html)以及用于指定可执行文件的[操作 > 外壳执行。](http://www.rsyslog.com/doc/rsyslog_conf_actions.html)

请务必阅读安全隐患，并且 ryslog 会在外部程序运行时阻塞。但是，如果您的脚本运行可靠且快速，它可能是一种选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-16T00:04:09.223

听起来你想要的是一个守护进程。在这种情况下，您参考的第二篇文章中给出的建议是最佳实践。但是，您确实有其他选项，例如 daemontools，它消除了 fork 的复杂性。

允许守护进程拥有文件句柄，但您应该关闭 STDIN、STDOUT 和 STDERRR，因为您不应该再使用它们[了](http://www.netzmafia.de/skripten/unix/linux-daemon-howto.html)。这在很大程度上与 *nix 系统中 fork 的工作方式有关。只需在第二次分叉后打开管道文件句柄，就不会出现任何问题。

# asp.net - 无法使用 OAuth2 获取 AccessToken 来暗示 Google Document List Api

> ID：12416800
> 
> 赞同：0
> 
> 时间：2012-09-14T00:55:37.590
> 
> 标签：asp.net, oauth-2.0, google-drive-api, google-docs-api

在我的 ASP.NET 应用程序中，我正在实现 Google Document List API，为了获取用户数据，我使用 OAuth2 来执行此操作，我做了一些代码：

```
string CLIENT_ID = "123456789321.apps.googleusercontent.com";
string CLIENT_SECRET = "xxxxxxxxxxxxxxxxxxxxxxxx";
string SCOPE = "https://docs.google.com/feeds/ https://docs.googleusercontent.com/ https://spreadsheets.google.com/feeds/";
string REDIRECT_URI = "urn:ietf:wg:oauth:2.0:oob";

        parameters = new OAuth2Parameters();
        parameters.ClientId = CLIENT_ID;
        parameters.ClientSecret = CLIENT_SECRET;
        parameters.RedirectUri = REDIRECT_URI;
        parameters.Scope = SCOPE;
        parameters.AccessCode = Convert.ToString(HttpContext.Current.Session["AccessCode"]);

        OAuthUtil.GetAccessToken(parameters);
        settings = new RequestSettings("My Application", parameters); 
```

每次都会`OAuthUtil.GetAccessToken(parameters);`给出错误：

谁能告诉我我在哪里做错了？

另外，如何访问 RefreshToken？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T08:37:29.287

您正在使用重定向 URI 安装在 Web 应用程序中。

我建议您更新代码以使用更新的 Drive API，其中还包括完整的 ASP.NET 示例应用程序和教程：

[https://developers.google.com/drive/examples/dotnet](https://developers.google.com/drive/examples/dotnet)

# jquery - jquery ajaxSubmit：如何有选择地加载响应页面

> ID：12416801
> 
> 赞同：0
> 
> 时间：2012-09-14T00:56:07.520
> 
> 标签：jquery, forms

我有一个引起各种反应的表格；它需要某种格式的响应（并且会在正常情况下得到它），但是如果服务器出错或以其他方式重定向，我需要通过用该页面替换 DOM 来处理返回的页面。换句话说，我要么想像提交普通表单（替换页面）一样，要么获取我的特殊数据。

当然，关键是 jQuery 的 ajaxSubmit，它可以在不加载页面的情况下获取表单的结果。那么，在中断了正常的表单处理并得到了这个错误页面之后，我该如何让它接管浏览器呢？

在 $.submit 函数级别，我可以返回 true 以防止正常处理。ajaxSubmit 的成功函数怎么才能“恢复”呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:01:43.710

如果您使用 Ajax 提交，则不能“重新激活”非 Ajax 表单处理。您可以做的是，如果您要通过 Ajax 调用返回整个页面，并且您想用该页面替换该页面，则使用 Javascript 和 DOM 来替换整个页面。例如，如果您返回的内容中有一个正文标签，您可以用新的正文标签替换当前的正文标签。这与将浏览器转发到新页面并不完全相同，但具有相同的效果。

# wordpress - 魔法领域 2 // 模拟写面板的方法？

> ID：12416802
> 
> 赞同：0
> 
> 时间：2012-09-14T00:56:08.960
> 
> 标签：wordpress

所以 Magic Fields 2 没有“写面板”。而且由于 MF2 非常时尚 - 我想还有其他一些东西可以代替我找不到的地方。

问题是这样的：创建一个包含一些字段的简单页面。

**在 MF1//**

1.  创建一些 m-Fields
2.  创建一个页面
3.  填写页面上的字段
4.  选择我想要作为写入面板的字段。
5.  在页面上回显它们

结构：页面>字段

**在 MF2//**

1.  创建页面模板
2.  创建一个页面
3.  将模板分配给页面
4.  创建自定义帖子类型
5.  为该帖子类型创建字段
6.  创建帖子
7.  填写所有字段
8.  在页面中针对帖子类型运行循环（针对 1 个帖子）
9.  回显 m-Fields 数据

结构：页面>帖子>字段

所以客户必须选择帖子类型“关于”然后进入那里并获取（那里唯一的帖子）“关于”然后调整字段......同时页面“关于”从未被触及......看起来真的奇怪的...

或者——你可以把所有的魔法字段放在“页面”上——在我的例子中，这意味着每个页面上都会有 100 个以上的字段，其中 90 个与那个页面无关，然后就不能'不是必需的——这对客户来说太混乱了。

我觉得我只是没有在某个地方检查一个特殊的盒子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T03:40:48.530

答案是否定的。

从那以后我开始使用高级自定义字段插件，您只需设置自定义字段集并告诉他们要出现在哪个页面或帖子类型上。我更有信心 ACF 将保持最新状态，而不是其他插件选项。只是想把它扔出去。

# vb.net - 访问另一个类的对象的结构

> ID：12416808
> 
> 赞同：-2
> 
> 时间：2012-09-14T00:56:48.227
> 
> 标签：vb.net, structure

我有一个 ClassA 类，在其中创建另一个 ClassB 类的对象（classB_obj）。如何使用这个 classB_obj 访问/设置 ClassB 内部结构的值？我不熟悉 vb.net 中的语法。我想做的是这个

```
Public ClassA
         Public Sub SomeSub 
              Dim ClassB_obj As New ClassB()   

              Dim classB_struct As ClassB.sampleStruct 'The error is **Type ClassB.sampleStruct not defined**
          End Sub
End ClassA

Public ClassB

   Private Structure Struct
       Dim xy As String
       Dim yz As String
   End Structure

   Dim sampleStruct As Struct

   'Member functions here
 End ClassB 
```

错误是**Type ClassB.sampleStruct 未定义**

谁能告诉我哪里出错了。这里是 vb.net 的新手，不熟悉语法。非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T00:58:25.847

您需要声明`Class B`允许在类外访问的成员以`Public`

```
Public ClassB

   Public Structure Struct
       Dim xy As String
       Dim yz As String
   End Structure

   'Public sampleStruct As Struct

End ClassB

Public ClassA
   Public Sub SomeSub 
        'Dim ClassB_obj As New ClassB()   
        Dim classb_struct As ClassB.Struct
   End Sub
End ClassA 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T00:58:44.790

好吧，您的结构是私有的，您是否尝试过将其公开？

# php - Zend 翻译和 smarty

> ID：12416809
> 
> 赞同：2
> 
> 时间：2012-09-14T00:56:51.743
> 
> 标签：php, zend-framework, smarty, zend-translate

我在我的项目中使用 ZendTranslate(csv 适配器) 和 Smarty。我将 ZendTranslate 用作独立的而不是所有 Zend，因为它看起来非常好用且易于使用。但我有一个问题。我找不到获取所有内容并发送给 Smarty 的最佳方法。我的简单代码：

```
require_once 'Smarty/libs/Smarty.class.php';
require_once 'Zend/Translate.php';
$lang = $_GET["lang"];
$translate = new Zend_Translate(
    array(
        'adapter' => 'csv',
        'content' => 'csv/lang_eng.csv',
        'locale'  => 'en'
    )
);
$translate->addTranslation(
    array(
        'content' => 'csv/lang_' . $lang . '.csv',
        'locale' => $lang
    )
);
$smarty->assign("m2", "" . $translate->translate('m2', $lang));
$smarty->display("views/page.tpl"); 
```

这对于一份翻译来说是可以的，但我在一页上有超过 30 个。如何以最佳方式获取所有这些并发送给 Smarty？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T14:37:38.463

这就是你必须在最新版本的 Smarty 中注册修饰符的方式：

```
$smarty ->registerPlugin('modifier','translate', array($obj, 'translate' )); 
```

可能有人觉得这很有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T09:33:43.977

最好注册 smarty 修改。在初始化 Smarty 时将其添加到地方：

```
require_once 'Smarty/Smarty.class.php';
// ...
$this->Smarty();
// ...
$obj = new TemplateTranslate();
$this->register_modifier('translate', array($obj, 'translate' )); 
```

主要翻译类：

```
class TemplateTranslate
{
    public static $zt;

    public function __construct()
    {
        self::$zt = new Zend_Translate(array(
            'adapter' => 'csv',
            'content' => 'csv/lang_eng.csv',
            'locale' => 'en'
        ));
    }

    public static function translate($string)
    {
        return self::$zt->_($string);
    }
} 
```

lang_eng.csv：

```
"Text on another language";"English text" 
```

然后你可以像这样使用：

```
<p>{'Text on another language'|translate}</p> 
```

# html - 省略周围 从 HAML 生成

> ID：12416812
> 
> 赞同：2
> 
> 时间：2012-09-14T00:57:19.547
> 
> 标签：html, haml, markdown

已经得到以下 HAML 代码，结合 Markdown：

```
%h2.slogan.align-center
  :markdown
    No more big words. Enough of the abbreviations.  
    **Project management for the rest of us.** 
```

生成HTML：

```
<h2 class='slogan align-center'>
  <p>No more big words. Enough of the abbreviations.<br/>
  <strong>Project management for the rest of us.</strong></p>
</h2> 
```

我希望 HTML 看起来像（省略周围的`<p>`标签）：

```
<h2 class='slogan align-center'>
  No more big words. Enough of the abbreviations.<br/>
  <strong>Project management for the rest of us.</strong>
</h2> 
```

创建该 HTML 的 HAML/Markdown 是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T07:45:08.060

好吧，只用haml很容易：

```
%h2.slogan.align-center
  No more big words. Enough of the abbreviations.
  %br/
  %strong Project management for the rest of us. 
```

好像haml的markdown插件加了p标签。根据[文档](http://haml.info/docs/yardoc/file.HAML_REFERENCE.html#markdown-filter)，这是通过使用 4 个不同的降价处理器之一来完成的。我想结果可能会有所不同，具体取决于您使用的是哪一个。

# git - 如何在 git 中删除 ORIG_HEAD 分支？

> ID：12416814
> 
> 赞同：7
> 
> 时间：2012-09-14T00:57:28.227
> 
> 标签：git, version-control

> **可能重复：**
> [git delete 并重新创建分支](https://stackoverflow.com/questions/11844581/git-delete-and-recreate-branch)

老实说，我不确定 ORIG_HEAD 是否可以称为分支，但它在我的可视化编辑器中显示为一个。

我做了一个“git reset --hard HEAD~1”然后做了一些改变，最后提交了。如何获得该 ORIG_HEAD 分支的权利？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-14T04:20:59.440

请参阅“ [Git 中的 HEAD 和 ORIG_HEAD](https://stackoverflow.com/questions/964876/head-and-orig-head-in-git) ”：

> `ORIG_HEAD`是 的先前状态`HEAD`，由可能具有危险行为的命令设置，以便于恢复它们。
> 现在 Git 有 reflog:`HEAD@{1}`的用处不大，大致相当于`ORIG_HEAD`

在你的情况下，你做了一个`git reset`，所以 Git 留下了一个“提醒”你在重置之前的位置。
你可以忽略它。

你也可以用一个简单的方法摆脱它

```
rm -f $GIT_DIR/ORIG_HEAD
# or
rm -f .git/ORIG_HEAD 
```

例如，这就是[`example/git-reset.sh`](https://github.com/git/git/blob/master/contrib/examples/git-reset.sh#L77-L84)脚本所做的。

# php - 这是正确的 Session_start()

> ID：12416815
> 
> 赞同：2
> 
> 时间：2012-09-14T00:57:32.480
> 
> 标签：php, session, cookies, browser, session-cookies

好吧，会话有一个小问题。似乎某些浏览器没有放置会话，例如我父亲的 mac book，但问题是他的 Safari 仅阻止来自第三方的 cookie，即使我说从不阻止会话也没有启动。只有少数例子是这样的；我的兄弟 mac 工作正常。无论如何这里是代码：

登录页面：

```
 if ($email==$dbusername&&md5($pass)==$dbpassword){
            $_SESSION['username']=$email;
            header( 'Location: http://www.website/start.php' ) ; 
```

首页：

```
session_start();
if($_SESSION['username']){
}
else{
die("<li style=\" color: black; font-family: Helvetica, sans-serif;
margin-left: 550px; margin-top: 300px; font-size: 24px; \" ><a  style=\"text-decoration: none;\" href=\"index.php\">Login or Register<a></li>  "); 
```

无论如何，在我爸爸的 mac 和我今天测试的另一台电脑上，我发现会话从未创建过。有什么帮助吗？我也是stackoverflow的新手，请不要为这篇文章抨击我，我的意思是从我所听到的关于stackoverflow的一切来看，主要是它对像我这样的人有用，为什么甚至允许抨击，如果我在错误的部分发帖请告诉我这样并重定向我。它的专业性。多谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:05:44.657

尽管您需要回答 @haynar1658 的问题，但如果您`session_start()`在两个页面上都使用，则潜在的问题可能是您的重定向：

```
header( 'Location: http://www.website/start.php' ) ; 
```

（我假设你的意思`www.website.com`或类似的东西）。

如果您的站点同时作为`www.website.com`和可用`website.com`，那么如果您登录，就会出现您所描述的问题`website.com`。然后您将打开一个会话，`website.com`但**不会**打开，`www.website.com`因此在重定向后您将看到您的错误消息。

**编辑**：要让您的会话跨子域工作，您可以使用以下内容：

```
$some_name = session_name("some_name");
session_set_cookie_params(0, '/', '.website.com');
session_start(); 
```

您使用的任何地方`session_start();`。

另一种方法是使用`.htaccess`文件之类的东西来始终重定向到`www`版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T02:19:18.367

`session_start()`应该在保存到会话的页面上以及从会话中检索数据的页面上。

我通常`session_start()`在所有页面上都包含一个文件的顶部。

# wpf - 覆盖切换按钮样式

> ID：12416821
> 
> 赞同：9
> 
> 时间：2012-09-14T00:58:15.570
> 
> 标签：wpf, xaml

我的窗口中有一个 ToggleButton，并在我的 ResourceDictionary 中设置了样式。它在 ResourceDictionary 中的原因是因为我很快就会有几个或多个 ToggleButton 必须具有相同的外观。

```
<Style x:Key="Standardbutton" TargetType="{x:Type ToggleButton}">
    <Setter Property="FontSize" Value="18" />
    <Setter Property="Foreground" Value="White" />
    <Setter Property="Background">
        <Setter.Value>
            <ImageBrush ImageSource="Resources/Standard_Button_Normal.png" />
        </Setter.Value>
    </Setter>
    <Setter Property="Height" Value="56" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="ToggleButton">
                <Border Name="border" BorderThickness="0" Padding="0,0" BorderBrush="DarkGray" CornerRadius="0" Background="{TemplateBinding Background}">
                    <ContentPresenter HorizontalAlignment="Left" VerticalAlignment="Center" Name="content" Margin="15,0,0,0"/>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsChecked" Value="True">
                        <Setter Property="Background">
                            <Setter.Value>
                                <ImageBrush ImageSource="Resources/Standard_Button_Pressed.png" />
                            </Setter.Value>
                        </Setter>
                        <Setter Property="Foreground">
                            <Setter.Value>
                                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                    <GradientStop Color="#FFF9CE7B" Offset="0"/>
                                    <GradientStop Color="#FFE88C41" Offset="1"/>
                                </LinearGradientBrush>
                            </Setter.Value>
                        </Setter>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

现在，此 ToggleButton 样式具有默认背景，并且当“IsChecked”为真时，它将具有不同的背景（如您在上面的 XAML 代码中所见）。

现在这些切换按钮必须组合图标+文本，就像我在这里所做的那样（对不起我蹩脚的 XAML 代码）

```
<ToggleButton Style="{DynamicResource Standardbutton}" Margin="0,0,0,4">
    <StackPanel Orientation="Horizontal">
        <Image Source="Resources/scan_26x26.png" />
        <TextBlock Text="Scan"/>
    </StackPanel>
</ToggleButton> 
```

问题是，当检查togglebutton时，我如何获得不同的图标（iSchecked = true）？

以下是一些可以帮助您理解问题的图片

Normal ToggleButton Style
![在此处输入图像描述](../Images/9582e922857350866495596c6f9931c1.png)
IsChecked=True Style
![在此处输入图像描述](../Images/957c3d02c9a404d58e6902bd9dff540d.png)
我的设计目标是当 IsChecked=True 时有不同的图标
![在此处输入图像描述](../Images/026fa928f03961c79c586a9cb7b60a01.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-14T01:48:47.473

将两个图像添加到控件模板，并将它们的`Visibility`属性绑定到`IsChecked`属性（使用 an`IValueConverter`将真/假转换为适当的`Visibility`枚举值）。

```
<ToggleButton Style="{DynamicResource Standardbutton}" Margin="0,0,0,4">
    <StackPanel Orientation="Horizontal">
        <Image Source="Resources/scan_26x26.png" 
               Visibility="{Binding 
                  RelativeSource={RelativeSource AncestorType=ToggleButton},
                  Path=IsChecked,
                  Converter={StaticResource BoolToVisibleConverter}}" />
        <Image Source="Resources/anotherimage.png" 
                  Visibility="{Binding 
                     RelativeSource={RelativeSource AncestorType=ToggleButton},
                     Path=IsChecked,
                     Converter={StaticResource BoolToCollapsedConverter}}" />
        <TextBlock Text="Scan"/>
    </StackPanel>
</ToggleButton> 
```

我使用了两个转换器`BoolToVisibleConverter`and `BoolToCollapsedConverter`，但你也可以使用 a`ConverterParameter`来完成同样的事情。

# iphone - 以编程方式关闭 UIAlertView

> ID：12416825
> 
> 赞同：13
> 
> 时间：2012-09-14T00:58:27.690
> 
> 标签：iphone, objective-c, uialertview

我需要有关以编程方式关闭 UIAlertView 的帮助。目前我有这个

`UIAlertView *alert1 = [[UIAlertView alloc]initWithTitle:@"title" message:@"message" delegate:nil cancelButtonTitle:nil otherButtonTitles:nil];`

然后后来我称之为

```
[alert1 dismissWithClickedButtonIndex:0 animated:NO]; 
```

但什么也没发生。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-09-14T06:15:17.500

你需要设置两件事。

**1.包括你的.h文件：** `<UIAlertViewDelegate>`

**2.请按照下面的实现...**

```
 UIAlertView *alert1 = [[UIAlertView alloc]initWithTitle:@"title" message:@"message" delegate:nil cancelButtonTitle:nil otherButtonTitles:nil]; 
        [alert1 show];
        [self performSelector:@selector(dismiss:) withObject:alert1 afterDelay:1.0]; 
```

**解雇方法将是......**

```
-(void)dismiss:(UIAlertView*)alert
{
    [alert dismissWithClickedButtonIndex:0 animated:YES];
} 
```

我希望这能帮到您。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-07-22T09:22:38.750

我也遇到了这个问题。就我而言，出于某种原因，请致电：

```
[alert dismissWithClickedButtonIndex:0 animated:NO]; 
```

并不总是有效（是的，甚至在 UI 线程上调用它，是的，警报！= nil），而是简单地将动画标志设置为 YES 它有效：

```
[alert dismissWithClickedButtonIndex:0 animated:YES]; 
```

可能是苹果的bug...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-14T01:06:38.130

你应该先显示它：

```
UIAlertView *alert1 = [[UIAlertView alloc]initWithTitle:@"title" message:@"message" delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:nil];
    [alert1 show]; 
```

然后在委托方法中

```
- (void)alertView:(UIAlertView *)alertView willDismissWithButtonIndex:(NSInteger)buttonIndex{
    if(buttonIndex==0){
     // do something
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T01:11:44.217

您调用的方法是正确的。
我猜当您调用方法 dismissWithClickedButtonIndex:animated: 时，alert1 为 nil：
尝试检查您的变量 alert1。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-14T06:50:37.590

您可以使用委托方法**-alertView:didDismissWithButtonIndex:**代替 - 一旦从屏幕上删除警报视图，它就会被调用，或者更好的方法是，使用后台线程，例如**-performSelectorInBackground:withObject:**来处理您需要的任何处理去做。

# jpa - 关系ManyToOne，javax.persistence.EntityExistsException：具有相同标识符值的不同对象已与会话关联

> ID：12416826
> 
> 赞同：6
> 
> 时间：2012-09-14T00:58:29.633
> 
> 标签：jpa, spring-data-jpa

我花了很多时间寻找这个错误，但我无法解决这个问题。我将 Spring JPA 与 Hibernate 和 Postgre 一起使用。我有两个实体 Location 和 Ap：

```
 CREATE TABLE ap
(
  id serial NOT NULL,
  ssid text NOT NULL,
  bssid text NOT NULL,
  capabilities text,
  CONSTRAINT ap_pkey PRIMARY KEY (id )
)
CREATE TABLE location2
(
  latitude double precision NOT NULL,
  longitude double precision NOT NULL,
  power integer NOT NULL,
  ap_id integer,
  id serial NOT NULL,
  CONSTRAINT location2_pkey PRIMARY KEY (id ),
  CONSTRAINT location2_ap_id_fkey FOREIGN KEY (ap_id)
      REFERENCES ap (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE NO ACTION
) 
```

应用：

```
import java.io.Serializable;
import java.util.HashSet;
import java.util.Set;

import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.FetchType;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.OneToMany;
import javax.persistence.Table;

@Entity
@Table(name = "ap")
public class Ap implements Serializable {
    private Long id;
    private String ssid;
    private String bssid;
    private String capabilities;
    private Set<Location> locations = new HashSet<Location>();

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column
    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    @OneToMany(mappedBy = "ap", cascade = CascadeType.ALL, orphanRemoval = true, fetch = FetchType.LAZY)
    public Set<Location> getLocations() {
        return locations;
    }

    public void setLocations(Set<Location> locations) {
        this.locations = locations;
    }

    @Column
    public String getSsid() {
        return ssid;
    }

    public void setSsid(String ssid) {
        this.ssid = ssid;
    }

    @Column
    public String getBssid() {
        return bssid;
    }

    public void setBssid(String bssid) {
        this.bssid = bssid;
    }

    @Column
    public String getCapabilities() {
        return capabilities;
    }

    public void setCapabilities(String capabilities) {
        this.capabilities = capabilities;
    }

    public void addLocation(Location location) {
        location.setAp(this);
        getLocations().add(location);
    }

    public void removeLocation(Location location) {
        getLocations().remove(location);
    }

    public Ap() {
        super();
    }

    public Ap(String ssid, String bssid, String capabilities) {
        this.ssid = ssid;
        this.bssid = bssid;
        this.capabilities = capabilities;
    }

} 
```

位置2

```
@Entity
@Table(name = "location2")

public class Location implements Serializable {

    private Long id;
    private double latitude;
    private double longitude;
    private int power;
    private Ap ap;

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "id")
    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    @ManyToOne
    @JoinColumn(name = "ap_id")
    public Ap getAp() {
        return ap;
    }

    public void setAp(Ap ap) {
        this.ap = ap;
    }

    @Column
    public double getLatitude() {
        return latitude;
    }

    public void setLatitude(double latitude) {
        this.latitude = latitude;
    }

    @Column
    public double getLongitude() {
        return longitude;
    }

    public void setLongitude(double longitude) {
        this.longitude = longitude;
    }

    @Column
    public int getPower() {
        return power;
    }

    public void setPower(int power) {
        this.power = power;
    }

    public Location(double latitude, double longitude, int power) {
        super();
        this.latitude = latitude;
        this.longitude = longitude;
        this.power = power;
    }

    public Location() {
        super();
    } 
```

当我将一个位置添加到 Ap 时，它可以工作，但是当 Ap 有两个或更多位置时，我无法保存 Ap 实体。

```
ApService service=context.getBean("ApService", ApService.class);
    Ap ap=new Ap("test_ssid2", "test_bssid2", "test_capabilities2");
    ap.addLocation(new Location(9.121, 12.9, 12));
    ap.addLocation(new Location(9.122, 12.9, 12));
    service.save(ap); 
```

应用服务：

```
 public Ap save(Ap ap) {
        return apRepository.save(ap);
    } 
```

它会出现错误：

```
Exception in thread "main" org.springframework.dao.DataIntegrityViolationException: a different object with the same identifier value was already associated with the session: [com.kulig.ap.domain.Location#9]; nested exception is javax.persistence.EntityExistsException: a different object with the same identifier value was already associated with the session: [com.kulig.ap.domain.Location#9]
at org.springframework.orm.jpa.EntityManagerFactoryUtils.convertJpaAccessExceptionIfPossible(EntityManagerFactoryUtils.java:318)
at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:106)
at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:403)
at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:58)
at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:213)
at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:163)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
at org.springframework.data.jpa.repository.support.LockModeRepositoryPostProcessor$LockModePopulatingMethodIntercceptor.invoke(LockModeRepositoryPostProcessor.java:91)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:90)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
at $Proxy24.save(Unknown Source)
at com.kulig.ap.service.jpa.ApServiceImpl.save(ApServiceImpl.java:31)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:318)
at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:155)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
at $Proxy29.save(Unknown Source)
at com.kulig.ap.Test.main(Test.java:24)
Caused by: javax.persistence.EntityExistsException: a different object with the same identifier value was already associated with the session: [com.kulig.ap.domain.Location#9]
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1359)
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1315)
    at org.hibernate.ejb.AbstractEntityManagerImpl.convert(AbstractEntityManagerImpl.java:1321)
    at org.hibernate.ejb.AbstractEntityManagerImpl.persist(AbstractEntityManagerImpl.java:843)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.springframework.orm.jpa.SharedEntityManagerCreator$SharedEntityManagerInvocationHandler.invoke(SharedEntityManagerCreator.java:240)
    at $Proxy19.persist(Unknown Source)
    at org.springframework.data.jpa.repository.support.SimpleJpaRepository.save(SimpleJpaRepository.java:341)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.springframework.data.repository.core.support.RepositoryFactorySupport$QueryExecutorMethodInterceptor.executeMethodOn(RepositoryFactorySupport.java:334)
    at org.springframework.data.repository.core.support.RepositoryFactorySupport$QueryExecutorMethodInterceptor.invoke(RepositoryFactorySupport.java:319)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:155)
    ... 22 more 
```

我还尝试了 EntityManager 与 merge 和 persist 方法，这给出了同样的错误。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-15T09:04:19.893

在位置尝试更改

```
@Id
@GeneratedValue(strategy = GenerationType.IDENTITY)
@Column(name = "id") 
```

至

```
@Id
@GeneratedValue(generator="LOCATION_SEQ_GEN",strategy=GenerationType.SEQUENCE)
@SequenceGenerator(sequenceName="location_sequence_name",name="LOCATION_SEQ_GEN",allocationSize=1) 
```

我听说这`allocationSize=1`是不好的做法，但否则顺序会出现问题。您可以阅读更多[Hibernate 使用 PostgreSQL 序列不影响序列表](https://stackoverflow.com/questions/4288740/hibernate-use-of-postgresql-sequence-does-not-affect-sequence-table)

# jquery - 使用 jquery 设置十六进制颜色

> ID：12416833
> 
> 赞同：2
> 
> 时间：2012-09-14T00:59:16.417
> 
> 标签：jquery, html

我的 UI 样式表中有一个类设置，以及一个用户可以使用颜色选择器设置页面样式的首选项部分。这些值以十六进制形式存储在数据库中，但是当我使用这些值通过 jQuery 更新页面时：

```
$nav.css("background-color", button_bg_color) 
```

我失去了新的 :hover 颜色。非悬停颜色正确更改，但我看到它们被转换为 RGB 格式，我猜这会导致 :hover 值出现问题。我想我可以更改我的代码并在悬停时更改类来解决这个问题，但是有没有办法让 jQuery 使用十六进制值设置颜色？还是我还缺少其他东西？

更新：James Montagne 是对的，因为你不能改变 :hover 效果，所以我把它改成了一个类。现在，使用 hover() 函数，我仍然缺少一些东西：小提琴：http: [//jsfiddle.net/Y9EBt/6/](http://jsfiddle.net/Y9EBt/6/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T20:08:14.290

这里有一个问题，“Javascript 不支持获取或设置伪选择器的属性，这意味着您无法直接获取 :hover css 样式。” [[来源]](http://www.roslindesign.com/2011/05/04/detecting-the-hover-css-selector-style-in-jqueryjavascript/)

然而，JQuery 确实有一个[.hover() 函数](http://api.jquery.com/hover/)，它可能用于间接更改悬停项的 css。示例：[jQuery CSS 悬停](https://stackoverflow.com/questions/1642072/jquery-css-hover)

**编辑：** 这是我展示它工作的小提琴：http: [//jsfiddle.net/TvfB9/1/](http://jsfiddle.net/TvfB9/1/)

关键点是：

*   我在 javascript 中创建了一个全局变量（在文档就绪函数之外）： `hover_color = "#00FFff";`用于存储用户的“新”或“所需”悬停颜色。理想情况下，您可能希望在页面加载时将其初始化为样式表中的任何内容。

*   然后在更改颜色函数中，我更新全局变量：`hover_color = hover_text_color;`. 在此示例中，我将其分配给您已在小提琴中使用的变量，但 hover_text_color 应替换为用户从您的选择器控件中选择的任何值。

*   我向文档就绪的 javascript 对象添加了一个悬停功能，并从全局变量中为 .nav 类设置 CSS。

```
 `$('.nav').hover(function() {
        $(this).css('color', hover_color ); 
    },
    function() {
        $(this).css('color', '#ffffff');
    });` 
```

`基本上，当您使用 .CSS 设置 CSS 时，它实际上将 CSS 应用于附加了该类的特定标签的“样式”属性，它不会修改内存中的 CSS 文件或任何东西。因此，当您运行悬停功能时，您几乎忘记了您尝试对 CSS 类进行的更改。`

 `为了懒惰，我只改变前景色，并将非悬停前景色硬编码，显然，你不会想要;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T19:39:28.203

`:hover`不能以这种方式用作选择器。选择器的想法是 jquery 将找到页面上**当前**与选择器匹配的所有元素。虽然`:hover`我相信它根本不是一个有效的选择器，但如果是的话，我的想法是找到所有**当前**悬停在上面的元素，因为这就是选择器的工作方式。

此外，使用`.css`样式设置元素本质上只是将值添加到元素的样式属性。因此，由于[无法`hover`直接在 style 属性中设置 css](https://stackoverflow.com/questions/1033156/how-to-write-ahover-in-inline-css)，因此无法使用`.css`.`

# android - 单击android中的按钮后传递第二个数据

> ID：12416834
> 
> 赞同：-1
> 
> 时间：2012-09-14T00:59:35.907
> 
> 标签：android, android-intent, listener

我实际上采用了[vogella.com](http://www.vogella.com/articles/AndroidIntent/article.html)的代码。

单击第二个活动中的按钮时，我想将数据从第二个活动传递到第一个活动。为了确保传递的值是正确的，我希望它在返回第一个活动时显示为敬酒。

这是我在 firstactivity_layout 上的代码。res/activity_intentintent.xml

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/TextView01"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:minHeight="60dip"
        android:text="First Activity. Press button to call second activity"
        android:textSize="20sp" >
    </TextView>

    <Button
        android:id="@+id/Button01"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:onClick="onClick"
        android:text="Calling an intent" >
    </Button>

</LinearLayout> 
```

这是布局的第二个代码。水库/picklayout.xml

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <EditText
        android:id="@+id/input11"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:ems="10" >

        <requestFocus />
    </EditText>

    <EditText
        android:id="@+id/input22"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:ems="10" />

    <Button
        android:id="@+id/button1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="Button" />

</LinearLayout> 
```

这是第一个布局的活动代码，IntentintentActivity.java

```
public class IntentintentActivity extends Activity {
    Button btn1;
    private static final int REQUEST_CODE = 10;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_intentintent);

    }

    public void onClick(View view) {
        Intent i = new Intent(this, PickActivity.class);
        i.putExtra("Value1", "This value one for ActivityTwo ");
        i.putExtra("Value2", "This value two ActivityTwo");
        // Set the request code to any code you like, you can identify the
        // callback via this code
        startActivityForResult(i, REQUEST_CODE);
      }

      @Override
      protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        if (resultCode == RESULT_OK && requestCode == REQUEST_CODE) {
          if (data.hasExtra("returnKey1")) {
            Toast.makeText(this, data.getExtras().getString("returnKey1"),
                Toast.LENGTH_SHORT).show();
          }
        }
      }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_intentintent, menu);
        return true;
    } 
```

最后是第二个活动，PickActivity.java

```
public class PickActivity extends Activity{ 
Button submit;
EditText text1, text2;

public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
        setContentView(R.layout.picklayout);

        Bundle extras = getIntent().getExtras();
        if (extras == null) {
          return;
        }
        String value1 = extras.getString("Value1");
        String value2 = extras.getString("Value2");
        if (value1 != null && value2 != null) {
          text1 = (EditText) findViewById(R.id.input11);
          text2 = (EditText) findViewById(R.id.input22);
          text1.setText(value1);
          text2.setText(value2);            

        }   
        submit = (Button)findViewById(R.id.button1);
        /*
        submit.setOnClickListener(new OnClickListener(){
            public void onClick(View v){
                Toast.makeText(this, text1.getText(), 2500).show();
            }
        });
        */
    }

public void onClick(View v) {
    Toast.makeText(this, text1.getText(), 2500).show();
    finish();
  }     

      @Override
      public void finish() {
        Intent data = new Intent(this, IntentintentActivity.class);
        Toast.makeText(this, "finish state", 2500).show();
        // Return some hard-coded values
        data.putExtra("returnKey1", "Swinging on a star. ");
        data.putExtra("returnKey2", "You could be better then you are. ");
        setResult(RESULT_OK, data);
        int result = 1;
        //startActivityForResult(data, result);
        super.finish();
      } 
```

}

我试图将按钮的侦听器放在第二个活动中，就像这样。

```
public class PickActivity extends Activity{ 
Button submit;
EditText text1, text2;

public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
        setContentView(R.layout.picklayout);

        Bundle extras = getIntent().getExtras();
        if (extras == null) {
          return;
        }
        String value1 = extras.getString("Value1");
        String value2 = extras.getString("Value2");
        if (value1 != null && value2 != null) {
          text1 = (EditText) findViewById(R.id.input11);
          text2 = (EditText) findViewById(R.id.input22);
          text1.setText(value1);
          text2.setText(value2);            

        }   
        submit = (Button)findViewById(R.id.button1);

        submit.setOnClickListener(new OnClickListener(){
            public void onClick(View v){
                Toast.makeText(this, text1.getText(), 2500).show();
            }
        });

    } 
```

但是它说`Toast.makeText(...)`不适用于参数（新 View.onClickListener）。

请问有谁知道如何解决这个问题。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T01:07:54.873

在您的 Toast 中，您必须将 'this' 参数替换为 getBaseContext()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T01:08:11.987

你在一个内部类中，这应该是 IntentintentActivity.this。

```
 Toast.makeText(IntentintentActivity.this, data.getExtras().getString("returnKey1"),
        Toast.LENGTH_SHORT).show(); 
```

# c# - 返回程序顶部重试

> ID：12416835
> 
> 赞同：4
> 
> 时间：2012-09-14T00:59:45.117
> 
> 标签：c#

我正在自学 C#，当前的章节挑战要求我：

以您的最后一个项目并创建附加的方法，将传递给它的两个数字相减、相乘或相除。在除法中，检查第二个数是否不为 0，因为除以 0 是一个非法的数学概念。如果第二个数字是 0，则返回 0。

现在我写了以下我认为满足所有标准的内容。我不确定 IF 语句是否是最佳选择，但它确实有效。我还认为 SWITCH 也可以解决问题。

所以第一个问题，IF 或 SWITCH 会更好吗？

第二个问题。在 ELSE 中，如果用户没有选择可用选项之一，我会给出一般失败消息，但我想做的是如果调用 ELSE（不确定正确的术语是什么），我希望程序回到开始并要求用户再试一次并显示第一个 Console.Writeline() 要求选择操作员。我知道这不是挑战的一部分，但它似乎是对程序的合乎逻辑的补充，我想知道这是否可行，而无需诉诸任何过于复杂的东西。

提前致谢！

```
 string whichOp;
        int firstNum, secondNum, result;

        Console.WriteLine("What Operator do you wish to use? [A]dd, [S]ubtract, [M]ultiply or [D]ivide?");

        whichOp = Console.ReadLine();

        whichOp = whichOp.ToLower();

        if (whichOp == "a")
        {
            Console.Write("You chose Addition.  Please choose your first number: ");
            firstNum = int.Parse(Console.ReadLine());
            Console.Write("You chose the number {0}.  Please choose a second number: ", firstNum);
            secondNum = int.Parse(Console.ReadLine());
            result = Add(firstNum, secondNum);
            Console.WriteLine("You chose the number {0}.  {1} plus {2} equals {3}.", secondNum, firstNum, secondNum, result);
        }
        else if (whichOp == "s")
        {
            Console.Write("You chose Subtraction.  Please choose your first number: ");
            firstNum = int.Parse(Console.ReadLine());
            Console.Write("You chose the number {0}.  Please choose a second number: ", firstNum);
            secondNum = int.Parse(Console.ReadLine());
            result = Sub(firstNum, secondNum);
            Console.WriteLine("You chose the number {0}.  {1} minus {2} equals {3}.", secondNum, firstNum, secondNum, result);
        }
        else if (whichOp == "m")
        {
            Console.Write("You chose Multiplication.  Please choose your first number: ");
            firstNum = int.Parse(Console.ReadLine());
            Console.Write("You chose the number {0}.  Please choose a second number: ", firstNum);
            secondNum = int.Parse(Console.ReadLine());
            result = Mult(firstNum, secondNum);
            Console.WriteLine("You chose the number {0}.  {1} times {2} equals {3}.", secondNum, firstNum, secondNum, result);
        }
        else if (whichOp == "d")
        {
            Console.Write("You chose Division.  Please choose your first number: ");
            firstNum = int.Parse(Console.ReadLine());
            Console.Write("You chose the number {0}.  Please choose a second number: ", firstNum);
            secondNum = int.Parse(Console.ReadLine());
            result = Div(firstNum, secondNum);
            Console.WriteLine("You chose the number {0}.  {1} divided by {2} equals {3}.", secondNum, firstNum, secondNum, result);
        }
        else
            Console.WriteLine("FAIL!  You did not choose an available option.");

        Console.ReadLine();
    }

    static int Add(int num1, int num2)
    {
        int theAnswer;

        theAnswer = num1 + num2;

        return theAnswer;
    }

    static int Mult(int num1, int num2)
    {
        int theAnswer;

        theAnswer = num1 * num2;

        return theAnswer;
    }

    static int Sub(int num1, int num2)
    {
        int theAnswer;

        theAnswer = num1 - num2;

        return theAnswer;
    }

    static int Div(int num1, int num2)
    {
        int theAnswer;

        if (num2 == 0)
            return 0;

        theAnswer = num1 / num2;

        return theAnswer;
    } 
```

编辑：我接受了这里的建议，并用 SWITCH 和 WHILE 重建了程序。也有人说，因为很多代码都是一样的，我应该可以重用它。我喜欢这个想法，并将研究如何做到这一点。

```
 var retry = true;
        while (retry)
        {
            retry = false;

            string whichOp;
            int firstNum, secondNum, result;

            Console.WriteLine("What Operator do you wish to use? [A]dd, [S]ubtract, [M]ultiply or [D]ivide?");

            whichOp = Console.ReadLine();

            whichOp = whichOp.ToLower();

            switch (whichOp)
            {
                case "a":
                    Console.Write("You chose Addition.  Please choose your first number: ");
                    firstNum = int.Parse(Console.ReadLine());
                    Console.Write("You chose the number {0}.  Please choose a second number: ", firstNum);
                    secondNum = int.Parse(Console.ReadLine());
                    result = Add(firstNum, secondNum);
                    Console.WriteLine("You chose the number {0}.  {1} plus {2} equals {3}.", secondNum, firstNum, secondNum, result);
                    Console.ReadLine();
                    break;
                case "s":
                    Console.Write("You chose Subtraction.  Please choose your first number: ");
                    firstNum = int.Parse(Console.ReadLine());
                    Console.Write("You chose the number {0}.  Please choose a second number: ", firstNum);
                    secondNum = int.Parse(Console.ReadLine());
                    result = Sub(firstNum, secondNum);
                    Console.WriteLine("You chose the number {0}.  {1} minus {2} equals {3}.", secondNum, firstNum, secondNum, result);
                    Console.ReadLine();
                    break;
                case "m":
                    Console.Write("You chose Multiplication.  Please choose your first number: ");
                    firstNum = int.Parse(Console.ReadLine());
                    Console.Write("You chose the number {0}.  Please choose a second number: ", firstNum);
                    secondNum = int.Parse(Console.ReadLine());
                    result = Mult(firstNum, secondNum);
                    Console.WriteLine("You chose the number {0}.  {1} times {2} equals {3}.", secondNum, firstNum, secondNum, result);
                    Console.ReadLine();
                    break;
                case "d":
                    Console.Write("You chose Division.  Please choose your first number: ");
                    firstNum = int.Parse(Console.ReadLine());
                    Console.Write("You chose the number {0}.  Please choose a second number: ", firstNum);
                    secondNum = int.Parse(Console.ReadLine());
                    result = Div(firstNum, secondNum);
                    Console.WriteLine("You chose the number {0}.  {1} divided by {2} equals {3}.", secondNum, firstNum, secondNum, result);
                    Console.ReadLine();
                    break;
                default:
                    Console.WriteLine("I'm sorry.  {0} is not an available option.  Please try again.", whichOp.ToUpper());
                    retry = true;
                    break;
            }
        }
    }

    static int Add(int num1, int num2)
    {
        int theAnswer;

        theAnswer = num1 + num2;

        return theAnswer;
    }

    static int Mult(int num1, int num2)
    {
        int theAnswer;

        theAnswer = num1 * num2;

        return theAnswer;
    }

    static int Sub(int num1, int num2)
    {
        int theAnswer;

        theAnswer = num1 - num2;

        return theAnswer;
    }

    static int Div(int num1, int num2)
    {
        int theAnswer;

        if (num2 == 0)
            return 0;

        theAnswer = num1 / num2;

        return theAnswer;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-14T01:06:35.713

(1) switch 通常是表达这种分支的一种更简洁的方式。switch 的主要限制是它仅适用于编译时常量值（常量变量、文字字符串、整数、枚举等）。在这种情况下，这似乎不是问题，因此 switch 对于更简洁、更短的代码可能是一个不错的选择。在对性能敏感的代码中（当然不是），单个 switch 可能比一堆 if 更快，因为程序将测试该值并直接跳转到正确的大小写，而不是针对每个 if 条件进行测试，直到匹配。

(2) 一种简单的方法是将整个程序包装在一个循环中：

```
var retry = true;
while (retry)
    retry = false;
    // your program
    else { // or default: if you're going with switch
        ...
        retry = true;
    }
} 
```

# windows-phone-7 - 如何制作或获取平铺大小的 Windows Phone 矢量图标

> ID：12416837
> 
> 赞同：0
> 
> 时间：2012-09-14T01:00:07.240
> 
> 标签：windows-phone-7

我熟悉 Windows Phone sdk 附带的标准应用程序图标图像，但我想使用其中一些图像，如标准开始屏幕上所示，应用程序磁贴的尺寸为 173x173。我试过调整这些大小，但它们太模糊了，不值得使用。是否有地方可以下载与 SDK 一起提供的相同（或类似）图像，但尺寸更大？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T12:33:18.340

也看看[Icons8 图标包](http://icons8.com/)，他们只要求一个链接到他们的网站或 199 美元没有链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T05:10:47.983

看看[Syncfusion 的 Metro Studio](http://www.syncfusion.com/downloads/metrostudio)。我在我所有的应用程序和它的`free`.

# ruby - Jekyll 中有多个转换器/生成器？

> ID：12416841
> 
> 赞同：1
> 
> 时间：2012-09-14T01:00:31.210
> 
> 标签：ruby, jekyll, jekyll-extensions

我想编写一个 Jekyll 插件，利用 Kramdown 的`LaTeX`导出功能，使所有帖子都以 PDF 格式提供。对于 Markdown 格式的每个帖子，我想以普通`.html`帖子结尾，以及一个`.tex`包含`LaTeX`标记的文件，最后是一个`.pdf`.

在[创建插件的文档](https://github.com/mojombo/jekyll/wiki/Plugins)之后，我看到了两种解决问题的方法，使用转换器或生成器。

转换器插件似乎在内置转换器之后运行，因此文件在到达转换器时`.markdown`已全部转换为。`.html`

当我尝试实现一个生成器时，我能够`fileutils`成功地写入一个文件，但是在 Jekyll 的循环结束时，该文件已被删除。似乎有一个`StaticFile`类可以用来向 Jekyll 注册新的输出文件，但我找不到任何关于如何使用它的真正指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T20:45:04.300

如果你看一下 ThumbGenerator 类：[https](https://github.com/matthewowen/jekyll-slideshow/blob/master/_plugins/jekyll_slideshow.rb) ://github.com/matthewowen/jekyll-slideshow/blob/master/_plugins/jekyll_slideshow.rb你会看到一个类似的例子。这个特殊的插件制作了网站中所有图像的缩略图大小版本。希望它为您如何与 Jekyll 的 StaticFile 类交互提供有用的指南（尽管我不是 Ruby 专业人士，所以请原谅任何糟糕的风格）。

不幸的是，并没有真正的文档——我是从阅读源代码中收集到的。

几个月前我写了这篇文章，并不太记得细节（这就是为什么我给出了一个例子而不是一个解决方案），但如果这不能让你走上正确的轨道，请告诉我，我会尽力帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-01T06:55:34.383

我尝试做同样的事情，但直接进行 html->pdf 转换。目前它在 gitlab-ci 管道中不起作用，但它在我的工作站上工作（[见这里](https://stackoverflow.com/questions/43137876/jekyll-generating-file-with-pdfkit-in-a-gitlab-ci-pipeline)），还有第三种可能性：钩子！

（这里有pdfkit）

```
require 'pdfkit'

module Jekyll

  Jekyll::Hooks.register :site, :post_write do |post|

      post.posts.docs.each do |post|
          filename = post.site.dest + post.id + ".pdf"
          dirname = File.dirname(filename)
          Dir.mkdir(dirname) unless File.exists?(dirname)

          kit = PDFKit.new(post.content, :page_size => 'Letter')
          kit.stylesheets << './css/bootstrap.min.css'
          kit.to_file(filename)
      end
  end

end 
```

# generics - 如何简化 VHDL 中端口的泛型使用？

> ID：12416843
> 
> 赞同：0
> 
> 时间：2012-09-14T01:00:57.860
> 
> 标签：generics, vhdl

假设我有一个实体：

```
entity myblock is
    port(
        input1 : std_logic_vector(15 downto 0);
        input2 : std_logic_vector(15 downto 0);
        input3 : std_logic_vector(15 downto 0);
        -- ...
        output : std_logic_vector(15 downto 0);
    );
end myblock; 
```

我现在想让输入的大小通用，所以我可以这样做：

```
entity myblock is
    generic(
        WIDTH : natural;
    );
    port(
        input1 : std_logic_vector(WIDTH-1 downto 0);
        input2 : std_logic_vector(WIDTH-1 downto 0);
        input3 : std_logic_vector(WIDTH-1 downto 0);
        -- ...
        output : std_logic_vector(WIDTH-1 downto 0);
    );
end myblock; 
```

理想情况下，我想稍微简化一下，并说：

```
subtype calc_data is std_logic_vector(WIDTH-1 downto 0);
port(
    input1 : calc_data;
    input2 : calc_data;
    input3 : calc_data;
    -- ...
    output : calc_data;
); 
```

在这种情况下，这是一个非常简单的例子，收益并不大。但是，在更复杂的情况下，它确实会有所帮助。

这在VHDL中可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T01:25:04.297

您可以使用单一类型规范命名多个端口：

```
entity myblock is
    generic(
        WIDTH : natural;
    );
    port(
        input1, input2, input3 : in std_logic_vector(WIDTH-1 downto 0);
        -- ...
        output : out std_logic_vector(WIDTH-1 downto 0);
    );
end myblock; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T10:11:05.967

当输入只是向量时，通常使用选项 2（通用）

如果您的子类型用于携带“对读者的意义”（而不仅仅是“宽度信息”），则将该子类型存储在一个包中。

另一种选择是在`std_logic_vector`没有宽度规范的情况下使用，并让宽度从更高级别向下传播。

（有一个针对[匿名类型](http://www.eda.org/twiki/bin/view.cgi/P1076/AnonymousTypes)的 VHDL 新迭代的提议，您可能会觉得这很有趣）

# python - 如何将WinPython的解释器设置为vim默认的python解释器？

> ID：12416845
> 
> 赞同：0
> 
> 时间：2012-09-14T01:01:38.170
> 
> 标签：python, vim

我使用名为[WinPython](https://code.google.com/p/winpython/)的 Python 发行版。现在我希望我的 vim 使用 WinPython 中的 python 解释器作为其默认解释器。我尝试将其添加`F:\WinPython\python-2.7.3.amd64`到我的 windows 环境变量`PATH`中，以便 vim 可以找到`Python27.dll`. 然后我使用 Vim 命令`:echo has('python')`并返回 1。但是，每次我使用 Python 的任何功能时，例如`:python print 1`，Vim 都会自动退出。如果我使用 GVim，则不会显示警告和错误。如果我使用 Vim 命令行，则会出现错误“ImportError: No moulde named site”。

我的操作系统：Win7（64位）

我的 Vim 版本：7.3（64 位）

我的 Python：python：2.7.3.amd64 whit WinPython 发行版

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:15:39.120

我刚刚解决了这个问题，是因为我没有设置环境变量`PYTHONHOME`。我应该将它设置为我的 python 解释器的目录。

# uwsgi - 是否有 uwsgi 的神秘魔法变量的完整列表？

> ID：12416846
> 
> 赞同：5
> 
> 时间：2012-09-14T01:01:41.217
> 
> 标签：uwsgi

我正在尝试用 uwsgi 做一些相当复杂的配置。从长远来看，我正在努力让自己的事情变得更轻松，自然地，这样做，*我正在让事情变得尽可能困难*。

无论如何，我正在寻找魔法变量的完整列表。我能在[皇帝页面](http://projects.unbit.it/uwsgi/wiki/Emperor)上找到的*不是*我想要的。该页面（和其他页面）表明那里有一本更大的魔法词典。某处。

```
%v = the vassals dir
%o = the original config filename as specified in the command line
%p = the absolute path of the config filename
%s = the filename of the config file
%d = the absolute path of the directory containing the config file
%e = the extension of the config file
%n = the filename without extension 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-20T14:22:17.533

自从提出这个问题以来，uwsgi 文档似乎已经更新。这是一个较长的魔术变量列表的链接：

[http://uwsgi-docs.readthedocs.org/en/latest/Configuration.html#magicvars](http://uwsgi-docs.readthedocs.org/en/latest/Configuration.html#magicvars)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-14T15:54:45.043

唯一缺少的变量是 %c，它报告了包含配置文件的目录的名称：

/foo/bar/test/one.ini 将返回“测试”

# windows - TortoiseSVN 和重命名作者

> ID：12416850
> 
> 赞同：1
> 
> 时间：2012-09-14T01:01:58.213
> 
> 标签：windows, svn, tortoisesvn, local, author

我在公司机器上工作，无法更改 Windows 用户名的名称。我在本地运行 TortoiseSvn，我想将提交更改为我的名字。我不想右键单击每个提交并手动更改名称。有没有办法做到这一点？我知道有几个关于此的线程，但没有解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T02:17:07.487

是的，有办法做到这一点，但你可能做不到。

在 Subversion 中，有两种类型的属性：与文件本身一起修订的文件属性，以及不附加到文件而是附加到修订的修订属性。这些没有版本控制。

有几个标准修订属性：

*   **svn:log**：这是提交注释。
*   **svn:author**：这是提交的用户。
*   **svn:date**：这是提交的日期和时间戳。

您可以使用以下命令更改任何这些修订属性：

```
$ svn pset svn:log --rev-prop -r193 "The commit comment for revsion #193 is this!" 
```

用 PowerShell 或 Python 或 Perl 编写脚本来一次对一大堆修订执行此操作相当简单。但是，您可以想象如果您可以随心所欲地更改任何 Subversion 修订版的日期、作者身份和提交评论，这会造成什么样的破坏。

因此，为了能够使用`rev-prop`更改，存储库必须具有允许您执行此操作的挂钩。这是您必须有一个钩子才能显式允许允许的操作的唯一情况。而且，当然，您是否有能力创建这样的钩子是非常值得怀疑的。

* * *

现在，我假设您在谈论已经提交的修订。如果您正在共享一个工作副本，并且您进行了更改，然后与其他人一起提交了这些更改，那么您使用的 Subversion 完全错误。

每个用户都应该有自己的工作目录，他们可以在其中进行更改。这样，存储库将记录谁做了提交而没有任何恶作剧。

* * *

如果你只是想用 Windows 名称以外的名称从存储库中签出，可以将身份验证保存在本地计算机上，Subversion 将在从该存储库中签出时使用该授权。

我相信授权存储在 %HOMEPATH%.subversion\auth 目录下。找到授权文件并删除它应该不会花费太长时间。然后，下次结帐时，您需要指定用户和密码并保存凭据。之后，这就是 TortoiseSVN 在您使用该存储库时默认使用的内容。

* * *

这是三个不同的答案，涵盖了使用 Subversion 和凭据的三种不同情况。如果我没有回答正确的场景，请编辑您的问题并准确解释您的意思以及您想要完成的任务。你描述的情况不是很清楚。

# mysql - SQL 查询连接两个表

> ID：12416855
> 
> 赞同：-1
> 
> 时间：2012-09-14T01:03:51.673
> 
> 标签：mysql, sql, join

我有2个表如下：

1.产品

```
product_id, name
    1       Books A
    2       Books B
    3       Books C
    4       Books D
    5       Books E 
```

2.liked_items

```
user_id, product_id
   1         4
   1         3
   1         1 
```

我想查询（sql）以检索结果，如下所示。我可以在同一个查询中执行吗？

```
product_id,  user_id
1              1
2              0
3              1
4              1
5              0 
```

你好，这是我第一次在这里发帖。希望任何人都可以帮助我。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:06:43.017

试试这个，

```
SELECT  a.product_ID,
        COALESCE(b.user_id,0) `user_id`
FROM    products a 
        LEFT JOIN liked_items b
            ON a.product_ID = b.product_ID 
```

有时`liked_items.user_id`可能是`NULL`这样，而不是显示`NULL`在结果列表中，而是可以使用`COALESCE`. `COALESCE`是一个可以将`NULL`value 更改为您*想要的 value*的函数。

# [*点击演示*](http://sqlfiddle.com/#!2/7e79c/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T01:14:14.320

```
SELECT
  Products.product_id AS product_id,
  IFNULL(liked_items.user_id,0) AS user_id
FROM Products
  LEFT JOIN liked_items ON liked_items.product_id=Products.product_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T01:25:09.837

```
SELECT Products.product_id,liked_items.product_id,liked_items.user_id 
FROM Products 
     LEFT JOIN liked_items 
     ON Products.product_id=liked_items.product_id 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-14T01:12:38.927

如果您使用的是 MS SQL Server，您可以像这样使用 IsNull：

```
SELECT p.product_id, IsNull(li.user_id, 0)
FROM products p 
LEFT JOIN liked_items li 
   ON (p.product_id = li.product_id); 
```

如果没有，Joao 或 John 的回答会很好。

# php - 仅当我包含“刷新”时，codeigniter 重定向才会失败

> ID：12416868
> 
> 赞同：1
> 
> 时间：2012-09-14T01:07:06.257
> 
> 标签：php, codeigniter, redirect, controller, codeigniter-2

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class VerifyLogin extends CI_Controller
{

 public function __construct()
 {
    parent::__construct();
    //Model for fetching users in database
    $this->load->model('user', '', TRUE);
 }                             

 public function index()
 {
    //Load method to help verify form credentials
    $this->load->library('form_validation');

    //-----------------------------------------------
    //Verify Existance of values in login form fields
    //-----------------------------------------------
    //Validate existance of username field value
    $this->form_validation->set_rules('username', 'Username', 'trim|required|xss_clean');
    //Validate existance of password field value, and if exists then call 'check_database' func
    $this->form_validation->set_rules('password', 'Password', 'trim|required|xss_clean|callback_check_database');

    //If the form validation is false (i.e. Missing form fields)
    if($this->form_validation->run() == FALSE){
            //Redirect back to login page
            $this->load->view('general-Login');
    }
    //Login Success, goto main-page
    else{
        //Go to main page
        redirect('Main', 'refresh');
    }
}

function check_database($password)
{
    //Field validation succeeded.  Validate against database
    $username = $this->input->post('username');

    //Check the username and password against database
    $result = $this->user->login($username, $password);

    //If there is a result
    if($result){
        //will be used for session information
        $sess_array = array();
        foreach ($result as $row){
            $sess_array= array(
                'id' => $row->id,
                'username' => $row->username
            );
            //Session set as logged in
            $this->session->set_userdata('logged_in', $sess_array);
        }
        return true;
    }
    //No existance of user or, incorrect password
    else{
        //Send Message of incorrect username or password
        $this->form_validation->set_message('check_database', 'Invalid Username or Password');
        return false;
    }
}
} 
```

所以我有一个验证登录控制器来处理来自我的登录页面的表单数据。数据库访问效果很好，一切正常，直到我使用重定向功能。我尝试通过刷新进行重定向，它只是给了我一个显示“未定义”的页面。现在，当我删除“刷新”并留下控制器名称时，它会突然起作用，但我试图弄清楚为什么这个“刷新”不起作用。

我已经禁用了我`.htaccess` 我尝试将我设置`$config['uri_protocol']`为`REQUEST_URI`,`AUTO`并且`PATH_INFO` 没有运气。

另外，这是我第一次在网上提交给任何类似论坛的东西，所以请......温柔点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T06:06:28.817

我有类似的问题。例如，我的本地主机刷新不起作用，而托管服务提供商设置它起作用。也许在 Apache/PHP 配置中有些东西。不用刷新就可以了。我认为这与浏览器无关。发生这种情况时，我使用的是同一个浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T02:04:59.417

首先，欢迎来到 Stack Overflow。

其次，如果没有“刷新”的重定向（）有效，我会用它运行并稍后解决。

为了更深入的解释，“刷新”尝试对页面进行类似元的刷新，类似于：

> `<meta http-equiv="refresh" content="0;URL='http://example.com/'">`

（**注意：**它不会在您的视图中执行此操作，而是在响应中向浏览器发送类似的片段）

你使用的是什么浏览器？什么版本？希望它是最新的，因为这可能会对刷新的工作方式产生影响。

# java - 如何在没有登录页面的情况下使用简单的 Spring Security AuthenticationProvider？

> ID：12416870
> 
> 赞同：0
> 
> 时间：2012-09-14T01:07:20.143
> 
> 标签：java, spring-security

我有一个简单的身份验证提供程序，正在尝试与 Spring Security 一起使用。

```
<security:http auto-config="true" use-expressions="true">
    <security:intercept-url pattern="/**" access="isAuthenticated()" />
</security:http>
<security:authentication-manager>
    <security:authentication-provider
        ref="ipAddressAuthenticationProvider" />
</security:authentication-manager> 
```

目前，通过上述配置，用户在第一次访问时被重定向到登录页面。我不想要这个重定向。我试图在每次访问页面时都访问此身份验证提供程序。有什么方法可以在不编写额外的自定义代码的情况下完成这项工作？

我猜我需要以某种方式彻底摆脱表单过滤器和基本过滤器。

**结果**

我让它与下面的配置一起工作。我不得不`AbstractPreAuthenticatedProcessingFilter`简单地扩展`return "";`它的两个抽象方法。

```
<security:http use-expressions="true" entry-point-ref="http403ForbiddenEntryPoint">
    <security:intercept-url pattern="/**" access="isAuthenticated()" />
    <security:custom-filter position="PRE_AUTH_FILTER" ref="preAuthFilter" />
</security:http>
<bean id="preAuthFilter" class="com.hercules.ratinggame.business.security.IpAddressPreAuthenticationFilter">
    <property name="authenticationManager" ref="authenticationManager"/>
</bean>
<bean id="http403ForbiddenEntryPoint" class="org.springframework.security.web.authentication.Http403ForbiddenEntryPoint"/>
<security:authentication-manager alias="authenticationManager">
    <security:authentication-provider
        ref="ipAddressAuthenticationProvider" />
</security:authentication-manager> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T08:17:22.253

当前您使用`auto-config="true"`这意味着您[在引擎盖下配置了很少的过滤器](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/ns-config.html#ns-auto-config)，包括`<form-login>`带有`UsernamePasswordAuthenticationFilter`过滤器的元素。

此外，要*在每次访问页面时点击此身份验证提供程序，*您需要一个可以从请求中获取数据的过滤器（据我所知，IP 地址）。过滤器可能是[`RequestHeaderAuthenticationFilter`](http://static.springsource.org/spring-security/site/docs/3.1.x/apidocs/org/springframework/security/web/authentication/preauth/RequestHeaderAuthenticationFilter.html)或更可能是[您自己的`AbstractPreAuthenticatedProcessingFilter`实现](http://static.springsource.org/spring-security/site/docs/3.1.x/apidocs/org/springframework/security/web/authentication/preauth/AbstractPreAuthenticatedProcessingFilter.html)，它可以访问您的身份验证管理器。

总而言之，配置将如下所示：

```
<security:http use-expressions="true">
    <security:intercept-url pattern="/**" access="isAuthenticated()" />
    <security:logout /> <!-- optional -->
    <security:custom-filter position="PRE_AUTH_FILTER"
            ref="ipFromRequestPreAuthenticationFilter" />
</security:http>

<!-- this will probably extend AbstractPreAuthenticatedProcessingFilter -->
<bean id="ipFromRequestPreAuthenticationFilter"
        class="com.example.IpFromRequestPreAuthenticationFilter">
    <property name="authenticationManager" ref="authenticationManager" />
</bean>

<security:authentication-manager alias="authenticationManager">
    <security:authentication-provider ref="ipAddressAuthenticationProvider" />
</security:authentication-manager> 
```

# python - 监听 HTTP 响应

> ID：12416871
> 
> 赞同：2
> 
> 时间：2012-09-14T01:07:27.633
> 
> 标签：python, http

我正在尝试编写一个 python 应用程序来侦听套接字上的 HTTP 响应。我为此使用[http-parser](https://github.com/benoitc/http-parser)。这是我的代码：

```
#!/usr/bin/env python
import socket

from http_parser.http import HttpStream
from http_parser.reader import SocketReader

from http_parser.util import b

def main():
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.bind((socket.gethostname(), 7000))
    s.listen(5)
    try:
        while True:
            p = HttpStream(SocketReader(s))
    finally:
        s.close()

if __name__ == "__main__":
    main() 
```

我有两个问题：

1.  这是最好的方法吗？请注意，我不想发送请求然后收听响应。我想要一个重定向机制，将所有响应重定向到运行此脚本的框。
2.  我应该如何测试这个？有没有可以模拟 HTTP 响应的工具？

**编辑** 我想要做的是：我有三个盒子，一旦运行 Apache，一个运行这个脚本，一个是客户端。当客户端连接到 Apache 并发送回响应时，我将响应转移到此框。所以在这个脚本中，我试图监听 HTTP 响应。

**拓扑** 这是我的拓扑： 服务器 <----> 交换机一 <-----> 交换机二 <-----> 框一和二 最初，框一连接到服务器并发送请求。当第二个交换机接收到来自服务器的响应时，它会将其分叉到框一和框二。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T01:58:51.403

1.  如果您真的想在 TCP 套接字级别进行操作，那么这是一个非常好的实现。如果你想要更多的抽象，有很多很多用于 python 的 HTTP 服务器包，包括标准库[`BaseHttpServer`](http://docs.python.org/library/basehttpserver.html)，以及外部库/框架，如[tornado](http://www.tornadoweb.org/)和[cherrypy](http://www.cherrypy.org/)。

2.  要测试您的 HTTP 侦听器，有很多选项。您可以在 Python 中编写完整的 HTTP 客户端测试代码（使用类似的 HTTP 客户端库[`urllib`](http://docs.python.org/library/urllib.html)），或者您可以：

    *   将您的网络浏览器指向`http://localhost:7000`
    *   `telnet`到 localhost 上的端口 7000 并输入原始 HTTP 请求。
    *   通过使用自动执行上述操作`nc`，例如：

        ```
        echo -e 'GET / HTTP/1.1\n\n' | nc localhost 7000 
        ```

关于术语的注释：您在绑定套接字上监听的是 HTTP*请求*，用 HTTP 的说法；您发送回连接客户端的是*响应*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T01:28:58.927

> 1.有没有更好的方法？

是的，[有](http://docs.python.org/library/basehttpserver.html)

> 2\. 我应该如何测试这个？

常见的做法是在同一个文件夹下放一个test.py，然后运行python test.py进行测试。示例代码：

```
#!python
# -*- coding: utf-8 -*-
import optparse
import urllib2
from django.utils import unittest

# just a sample of settings
HOST = 'localhost'

class GIOPTest(unittest.TestCase):
    def test_basic(self):
        #TEST GOES HERE

if __name__ == '__main__':
    # This part is to accept command line parameters
    option_list = ( # check optparse help for more options
        make_option("--host",
                action = 'store',
                type    = 'string',
                dest    = 'host',
                default = 'localhost',
                help    = 'Server host (localhost by default)'
            ),
    )

    parser = OptionParser(option_list=option_list)
    options, args = parser.parse_args()
    HOST = options.host

    # run the test
    unittest.main() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-01T03:11:44.503

我最终使用了一个原始套接字并直接从中读取数据包。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-16T23:34:20.927

如果您使用 apache 作为服务器，您可以将数据重定向到您可以使用 apache 基准测试（ab - 据我所知，您必须是超级用户才能使用它）来测试它......也将有助于评估性能您的应用程序对整个事物的影响，例如

```
 ab -n 500 -c 20 http://localhost:7000/ 
```

其中 -n 之后是测试期间与服务器建立的连接总数，在 -c 之后，您有 apache 基准测试将建立的并发连接数，尝试不同的值，还请阅读它的手册，您可能会发现更有用无论您的具体目的是什么

# python - 在python中打印一个带有偏移量的字符串

> ID：12416872
> 
> 赞同：3
> 
> 时间：2012-09-14T01:07:36.040
> 
> 标签：python, string-formatting

我正在使用 Python 2.4。我想打印一个左对齐但带有“偏移量”的字符串。我的意思是，打印一个前面有一定数量空格的字符串。

例子：

在宽度为 20 的空格中打印字符串“Hello”，左对齐，但在字符串之前插入五个空格。

```
"     Hello          "   #(The string has 5 spaces prior, and 10 space after)

print "Hello".ljust(20) #does not cut it. 
```

我可以使用以下方法作为解决方法：

```
print "     ", "Hello".ljust(15) 
```

有没有比打印一串 5 个空格更好的方法。

谢谢你，艾哈迈德。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-14T01:08:59.160

并不真地。

```
>>> '     %-15s' % ('Hello',)
'     Hello          ' 
```

# directory - testlink 安装失败：检查 /var/testlink/logs/ 目录是否存在

> ID：12416879
> 
> 赞同：11
> 
> 时间：2012-09-14T01:08:38.010
> 
> 标签：directory, installation, testlink

今天，我安装了testlink。在我选择“新安装”并选择“我同意”选项后，它在第二步失败。失败的消息如下：

读/写权限

出于安全原因，我们建议在以下消息中标记为 [S] 的目录将从浏览器变为 UNREACHEABLE
检查 C:\xampp\htdocs\testlink\gui\templates_c 目录
是否存在 OK 检查 C:\xampp\htdocs\testlink\ gui\templates_c 目录是可写的（由用于运行 webserver 进程的用户） OK
检查 /var/testlink/logs/ 目录是否存在 [S] **失败！**
检查 /var/testlink/upload_area/ 目录是否存在 [S]**失败！**

那么，任何人都可以帮我一把吗？非常感谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-14T10:37:21.277

在`C:\xampp\htdocs\testlink\config.inc.php`文件中，更改

```
$g_repositoryPath = 'C:\xampp\htdocs\testlink\upload_area';
$tlCfg->log_path = 'C:\xampp\htdocs\testlink\logs'; 
```

为我工作，确保你最后没有斜线。
即，确保它**不是**：

```
$g_repositoryPath = 'C:\xampp\htdocs\testlink\upload_area\';
$tlCfg->log_path = 'C:\xampp\htdocs\testlink\logs\'; 
```

如果您将 XAMPP 或 testlink 安装在其他目录中，请相应地更改上述路径。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-09-18T08:41:48.633

转到 config.inc.php 和日志目录 ( `$tlCfg->log_path`) 编辑路径`C:\xampp\testlink\logs`并将目录 () 上传`$g_repositoryPath`到`C:\xampp\testlink\upload_area`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-13T08:11:30.947

在某些情况下，您会这样做：

去`C:\xampp\htdocs\testlink\config.inc.php1`

和日志目录（**$tlCfg->log_path**）编辑路径`C:\xampp\htdocs\testlink\logs`

并将目录（**$g_repositoryPath**）上传到`C:\xampp\htdocs\testlink\upload_area`

然后你有：

```
$g_repositoryPath = 'C:\xampp\htdocs\testlink\upload_area';
$tlCfg->log_path = 'C:\xampp\htdocs\testlink\logs'; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-10T00:55:28.203

Ubuntu 12.04 - 你所要做的就是`chmod 777`这些目录，失败会变成通过。

```
~$ cd into /var/www/testlink

~$ sudo chmod 777 ./gui/templates_c/

~$ sudo chmod 777 ./upload_area/

~$ sudo chmod 777 ./logs/ 
```

不管说明书上说什么都是废话。使这些目录无法从浏览器访问是可选的，这造成了混乱。如果您是`chmod 777`他们，您的失败将变为通过，现在您将能够继续进行 testlink 安装的第 3 步。使用 testlink 1.9.5 版进行测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-09-05T07:03:16.797

我的路径设置正确，用户、组和访问权限也设置正确，但仍然无法解决问题。我花了很长时间才找到根本原因，问题在于 - 由于 SELinux 政策，http 守护进程无法访问相关文件。如此简单的 chown，chmod 无济于事（组和用户访问）。对于 testlink 1.16，我通过使用 sudo 用户重新安装来解决它，但是对于升级，即使使用 sudo 用户也会再次出现问题。

并通过执行以下命令解决了问题，我希望这会有所帮助。（注意：您可能需要修改属性才能成功运行它）

```
$chcon -t httpd_sys_content_rw_t "<path_to_testlink_folder>/gui/templates_c/"
$chcon -t httpd_sys_content_rw_t "/<path_to_testlink_folder>/upload_area/"
$chcon -t httpd_sys_content_rw_t "<path_to_testlink_folder>/logs"
$semanage fcontext -a -t httpd_sys_content_rw_t "<path_to_testlink_folder>(/.*)?"
$restorecon -R -v path_to_testlink_folder 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-16T07:25:08.867

在 Linux 上；确保路径如下：

$tlCfg->log_path $g_repositoryPath

是

/var/www/html/testlink/logs/ /var/www/html/testlink/upload_area/

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-08-23T06:47:53.530

对于**Mac OS 用户**，请在 1.9.19 版本中尝试此操作：

**确保使用您的文件夹名称。**

在 config.inc.php 文件中：

**$tlCfg->log_path** = TL_ABS_PATH 。“日志”。DIRECTORY_SEPARATOR；

**$g_repositoryPath** = TL_ABS_PATH 。“上传区域”。DIRECTORY_SEPARATOR；

在此之后，如果您获得读写权限问题失败。

转到 testlink -> 日志/upload_area -> 按 Command + I -> 在 Permission **Enable Read Write to Everyone。**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-11-05T07:32:10.307

在**ubuntu 18.04**上，需要运行

```
apt-get remove apparmor 
```

为了安装它

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-02-09T05:19:52.400

在 CentOS 中转到`/var/www/html/testlink-code-1.9.16`并编辑文件`custom_config.inc.php`替换这两行 `// $tlCfg->log_path = '/var/testlink-ga-testlink-code/logs/'; /* unix example */ // $g_repositoryPath = '/var/testlink-ga-testlink-code/upload_area/'; /* unix example */`

和 `$tlCfg->log_path = '/var/www/html/testlink-code-1.9.16/logs/'; $g_repositoryPath = '/var/www/html/testlink-code-1.9.16/upload_area/';`

确保您已禁用 selinux。如果不这样做，请编辑文件`/etc/sysconfig/selinux`并将变量更改`SELINUX`为`disabled`并重新启动机器。现在这些错误应该已经消失了。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-01-16T22:34:23.783

适用于 ubuntu 16.04 LTS 添加权限

![在此处输入图像描述](../Images/de314d44729d169a99cf0fb5845ae0ed.png)

改变：

```
$g_repositoryPath = 'var/www/html/testlink/upload_area'; //linux user
$tlCfg->log_path = 'var/www/html/testlink/logs';

~$ cd into /var/www/testlink

~$ sudo chmod 777 ./gui/templates_c/

~$ sudo chmod 777 ./upload_area/

~$ sudo chmod 777 ./logs/ 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2018-06-30T17:56:18.023

解决问题：在 Centos 7 上检查 /var/www/html/testlink-1.9.16/gui/templates_c 目录是否可写（由用于运行 webserver 进程的用户）。禁用 SELinux，然后重新启动系统。您不应再收到此错误消息。

# r - 从...获取名称（点）

> ID：12416880
> 
> 赞同：6
> 
> 时间：2012-09-14T01:08:54.027
> 
> 标签：r

在改进`rbind`方法时，我想提取传递给它的对象的名称，以便我可以从中生成唯一的 ID。

我试过`all.names(match.call())`了，但这只是给了我：

```
[1] "rbind"         "deparse.level" "..1"           "..2" 
```

通用示例：

```
rbind.test <- function(...) {
  dots <- list(...)
  all.names(match.call())
}

t1 <- t2 <- ""
class(t1) <- class(t2) <- "test"
> rbind(t1,t2)
[1] "rbind"         "deparse.level" "..1"           "..2" 
```

而我希望能够检索`c("t1","t2")`.

我知道通常无法检索传递给函数的对象的名称，但似乎 ... 可能是可能的，如上面示例中的`substitute(...)`返回`t1`。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-14T02:20:37.887

[我从R Help List Serve 上的 Bill Dunlap](https://stat.ethz.ch/pipermail/r-help/2013-October/361774.html)那里挑选了这个：

```
rbind.test <- function(...) {
    sapply(substitute(...()), as.character)
} 
```

我认为这会给你你想要的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-14T01:16:35.697

使用此处的指导[How to use R's ellipsis feature when writing your own function？](https://stackoverflow.com/questions/3057341/how-to-use-rs-ellipsis-feature-when-writing-your-own-function)

例如`substitute(list(...))`

并结合 with`as.character`

```
rbind.test <- function(...) {
  .x <-  as.list(substitute(list(...)))[-1]
  as.character(.x)
 } 
```

你也可以使用

```
rbind.test <- function(...){as.character(match.call(expand.dots = F)$...)} 
```

# openoffice-calc - OpenOffice.org/LibreOffice Calc 宏：单元格的内容当前是否溢出？

> ID：12416882
> 
> 赞同：0
> 
> 时间：2012-09-14T01:09:16.913
> 
> 标签：openoffice-calc, automatic-properties, openoffice-basic, libreoffice-basic, libreoffice-calc

我有一堆单元格，如果它们的内容溢出，我想调整它们的字体大小，直到它们都适合。我想编写一个宏来执行此操作，除非有条件格式或其他公式化的方法。是否有一个属性可以告诉单元格是否溢出？如果是这样，它是什么？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-11-28T15:05:06.227

'开放办公室 3

'获取当前文档
oDoc = ThisComponent

' 获取第一张工作表
oSheet = oDoc.getSheets().getByIndex(0)

'工作表的第一个单元格

Cell = oSheet.getCellByPosition(0, 0) MsgBox Cell.CharHeight

快乐的编码:))

# function - VHDL：使用函数的意外结束

> ID：12416883
> 
> 赞同：2
> 
> 时间：2012-09-14T01:09:22.687
> 
> 标签：function, vhdl

我正在尝试合成一些我发现的代码，这些代码基本上将 8 位二进制转换为 BCD。该代码使用函数，我遇到以下错误；

```
Line #: parse error, unexpected END 
```

以下是我的代码的行为部分；

```
architecture Behavioral of bintobcd is

function to_bcd ( bin : std_logic_vector(7 downto 0) ) return std_logic_vector is
variable i : integer:=0;
variable bcd : std_logic_vector(11 downto 0) := (others => '0');
variable bint : std_logic_vector(7 downto 0) := bin;

begin
for i in 0 to 7 loop  -- repeating 8 times.
    bcd(11 downto 1) := bcd(10 downto 0);  --shifting the bits.
    bcd(0) := bint(7);
    bint(7 downto 1) := bint(6 downto 0);
    bint(0) :='0';

    if (i < 7 and bcd(3 downto 0) > "0100") then --add 3 if BCD digit is greater than 4.
        bcd(3 downto 0) := bcd(3 downto 0) + "0011";
    end if;

    if (i < 7 and bcd(7 downto 4) > "0100") then --add 3 if BCD digit is greater than 4.
        bcd(7 downto 4) := bcd(7 downto 4) + "0011";
    end if;

    if (i < 7 and bcd(11 downto 8) > "0100") then  --add 3 if BCD digit is greater than 4.
        bcd(11 downto 8) := bcd(11 downto 8) + "0011";
    end if;

end loop;
return bcd;
end to_bcd;
end Behavioral; 
```

错误指向我的最后一行“end Behavioral”。我在这里做错了什么？

亲切的问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T01:14:55.213

架构的定义如下：

```
`**architecture** identifier **of** entity_name **is**
    architecture_declarative_part
**begin**
    architecture_statement_part
**end** *optional*(**architecture**) *optional*(architecture_simple_name) **;**` 
```

`在你说**end architecture**之前，你需要说**begin**，并做架构声明部分（可以是空的）`

# hadoop - 在hadoop的map阶段写入本地文件

> ID：12416884
> 
> 赞同：0
> 
> 时间：2012-09-14T01:09:30.050
> 
> 标签：hadoop, mapreduce

Hadoop 将中间结果写入本地磁盘，将 reducer 的结果写入 HDFS。HDFS 是什么意思。它在物理上转化为什么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T01:17:30.020

HDFS 是 Hadoop 分布式文件系统。在物理上，它是一个运行在集群的每个节点上的程序，它提供了一个与本地文件系统非常相似的文件系统接口。但是，写入 HDFS 的数据不仅存储在本地磁盘上，而且分布在整个集群的磁盘上。存储在 HDFS 中的数据通常也会被复制，因此相同的数据块可能会出现在集群中的多个节点上。这提供了可靠的访问，因此一个节点的崩溃或忙碌不会阻止某人能够从 HDFS 读取任何特定的数据块。

查看[http://en.wikipedia.org/wiki/Hadoop_Distributed_File_System#Hadoop_Distributed_File_System](http://en.wikipedia.org/wiki/Hadoop_Distributed_File_System#Hadoop_Distributed_File_System)了解更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T09:49:58.663

正如 Chase 所指出的，HDFS 是 Hadoop 分布式文件系统。

如果可以的话，我推荐这个关于 HDFS 和 Map/Reduce 框架如何工作的教程和视频，并将作为进入 Hadoop 世界的指南：http: [//www.cloudera.com/resource/introduction-to-apache -mapreduce 和 hdfs/](http://www.cloudera.com/resource/introduction-to-apache-mapreduce-and-hdfs/)

# bash - 捕获错误并输出以登录 Bash 脚本

> ID：12416886
> 
> 赞同：0
> 
> 时间：2012-09-14T01:09:59.600
> 
> 标签：bash

我有一个脚本，它根据记录 id 的文本文件检查数据库中的错误。

当发生错误（例如连接丢失）时，它将有问题的 id ($line) 以及错误消息 ($OP) 写入日志文件。

问题是错误消息始终为空，尽管错误显示在控制台上，但只有 id 被写入日志文件。

如何捕获错误并将其输出到日志文件？

```
while read line
do
    OP=$(mysql $DB -u root --password=$PW -e "select * from properties where hierarchyid = $line")
    printf "\r$line"
    #if [ $? -gt 0 ]; then
    if [[ ! $OP =~ "hierarchyid" ]]; then
        echo
        echo $line $OP >> errors.log
        sleep 10    
        echo
    fi
done < $IDS 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T01:12:17.130

将标准错误重定向到标准输出。

```
OP=$(mysql ... 2>&1) 
```

# iphone - iOS - 在应用程序之间传输应用程序内

> ID：12416887
> 
> 赞同：2
> 
> 时间：2012-09-14T01:10:01.700
> 
> 标签：iphone, ios, ipad, in-app-purchase, app-store-connect

我正在开发一个最初不是由我开发的项目，该项目是一个带有大量应用内购买的 iphone 应用程序，这些应用内购买是存储在应用程序内的大图像。这些图像使应用程序变大（~ 70 Mb）。此应用程序与 iOS 4.x 及更高版本兼容。

随着 iPhone 5 和 iOS 6 的推出，该公司希望创建一个全新的应用程序，该应用程序仅与 iOS 6 兼容，并且放弃了对先前版本的所有遗留支持。这个新版本会将应用内购买的图像存储在 Apple 服务器上，这将使应用大小降至 3 Mb。但是，另一方面，他们不想放弃那些购买应用内购买的人，他们想创建一个用户可以将购买从旧版本转移到新版本的方案。

我知道这可以通过在我们这边拥有一台服务器并设置一个应用程序和一个数据库来实现，但是他们现在有限的预算正在禁止这样做。那么，有没有办法只使用应用程序和 iCloud（或苹果方面的任何东西）来做到这一点？

我想知道[这](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/UserDefaults/StoringPreferenceDatainiCloud/StoringPreferenceDatainiCloud.html)是否可以用来做到这一点。我的意思是，我可以使用键值存储的东西来做到这一点吗？或者换句话说：两个应用程序可以有相同的**com.apple.developer.ubiquity-kvstore-identifier**吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T02:10:40.883

如果您的用户同时安装了这两个应用程序，则可以很容易地将数据从一个应用程序传输到另一个应用程序，但是不可能将应用程序购买从一个应用程序传输到另一个应用程序。

您需要做的是更新您的旧应用程序以支持某种操作或链接到新应用程序，然后从旧应用程序中打开新应用程序`UIApplication openURL:`并传递一些有关升级的元数据。

*然后*在新应用程序中，您的应用程序代表将收到`didFinishLaunchingWithOptions:`用于启动应用程序的 URL，然后您可以下载他们的购买。

通过为您的新应用注册 URL 方案来支持此功能，这是一个`info.plist`设置。

在旧应用程序和新应用程序之间进行上述购买元数据传输时，您将遇到的一个问题是无法通过 StoreKit/Apple 恢复他们的购买（如上所述，无法进行传输） .

如果您的新应用有两个应用内购买 SKU，您可以绕过此问题并为现有客户提供恢复购买的能力。

一件是新客户需要支付的常用物品，另一件是相同的，但现有客户“购买”为 0 美元，因此他们在 StoreKit/Apple 上注册了购买，以便他们将来在没有旧应用程序的情况下恢复。

如果现有客户已通过上述方法升级，新应用程序可以有条件地向现有客户显示此 $0 选项。

# javascript - 如何访问 Sound Manager2 创建的声音对象？

> ID：12416888
> 
> 赞同：0
> 
> 时间：2012-09-14T01:10:02.827
> 
> 标签：javascript, html, object, audio

在 soundmanger2 [http://www.schillmania.com/projects/soundmanager2/](http://www.schillmania.com/projects/soundmanager2/)

我创建了以下声音对象：

```
soundManager.setup({
  url: '<?php echo $html->url('/') ?>js/swf/',
  flashVersion: 9, // optional: shiny features (default = 8)
  useFlashBlock: false, // optionally, enable when you're ready to dive in
  allowScriptAccess: 'always',
  /**
   * read up on HTML5 audio support, if you're feeling adventurous.
   * iPad/iPhone and devices without flash installed will always attempt to use it.
   */
  onready: function() {
    //defaultReader = 'Menshawi_16kbps';
    soundManager.createSound({
  id: defaultReader,
  url: '<?php echo $html->url('/').'assets/audio/\'+defaultReader+\''.$mp3; ?>',
  autoLoad: false,
  autoPlay: true,
  onload: function() {
    //alert('The sound '+this.id+' loaded!');
  },
  onplay: function(){
    $('#'+defaultReader).removeClass('sm2_link');
    $('#'+defaultReader).addClass('sm2_playing');
    $.cookie('defaultReader', defaultReader, { expires: 7, path: '/' });
    $('#'+defaultReader).click(function(){
      //alert('ho')

      soundManager.togglePause(defaultReader);
      return false;

    });

  },

  onfinish: function(){
    $('#'+defaultReader).addClass('sm2_link');
    $('#'+defaultReader).removeClass('sm2_playing');

  },
  volume: 100
});
  }
}); 
```

我想从另一个脚本标签访问由 soundManager.createSound 创建的对象，例如：

```
<script>
theSoundObjectCreated.play()
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T01:17:50.377

用这样的东西设置你的声音管理器

`window.soundManager = new SoundManager();`

然后使用`soundManager.setup(.....)`

您将加载/创建声音

```
soundManager.createSound({
    id: 'some-id-for-your-sound',
    url: "url-to-your-sound.mp3",
    autoLoad: true,
    autoPlay: false,
    volume: 40
}); 
```

你可以用

`soundManager.getSoundById("some-id-for-your-sound").play()`

# c - Linux O_PATH 文件描述符的语义？

> ID：12416889
> 
> 赞同：8
> 
> 时间：2012-09-14T01:10:14.760
> 
> 标签：c, linux, posix

Linux 2.6.39 引入了`O_PATH`打开模式，它（粗略地说）根本不真正打开文件（即不创建打开的文件描述），而只是提供一个文件描述符，它是未打开目标的句柄。它的主要用途是作为`*at`函数的参数（`openat`等），它似乎适合作为`O_SEARCH`Linux 以前缺少的 POSIX 2008 功能的实现。但是，我一直无法找到任何关于`O_PATH`. 我有几个具体问题是：

1.  `O_PATH`Linux文件描述符上可以进行哪些操作？（只有`*at`功能？）
2.  `O_PATH`对非目录有用吗？
3.  文件描述符如何绑定到底层文件系统对象，如果它被移动、删除等会发生什么？`O_PATH`当最后一个链接被取消链接时，文件描述符是否算作防止对象被释放的引用？等等。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T11:12:21.200

使用 获得的文件描述符`open(directory, O_PATH | O_DIRECTORY)`不仅对`...at()`函数有用，而且对`fchdir()`（我相信从内核版本 3.2.23 开始）有用。

最近还有一个新的系统调用[补丁](http://marc.info/?l=linux-kernel&m=134504937124533)[`fbind()`](http://marc.info/?l=linux-kernel&m=134504828424171)，它允许非常长的 Unix 域套接字名称。套接字文件首先使用 创建`mknod(path, mode | S_IFSOCK, (dev_t)0)`，然后使用`open(file, O_PATH)`. 如此获得的文件描述符和一个 Unix 域套接字描述符被传递给`fbind()`，以将套接字绑定到路径名。这是否会被包含在 Linux 内核中还有待观察——尽管即使是这样，人们也需要数年时间才能依赖它被普遍使用。（不过，作为过长的 Unix 域套接字名称的一种解决方法，它会更早可行。）

我想说`O_PATH`的是现在只对目录有用；将来可能会发现文件用途。除了未来的可能性`fbind()`或类似的未来系统调用之外，我不知道文件描述符对使用`O_PATH`. `fstatvfs()`至少在 3.5.0 内核上， 甚至都行不通。

在 Linux 中，inode（文件内容和元数据）仅在最后一个打开的文件描述符关闭时才被释放。删除（取消链接）文件时，您只删除与 inode 关联的文件名。因此，有*两个*独立的文件系统对象与文件描述符相关联：用于打开对象的名称和引用的底层 inode。该名称仅用于路径解析，即何时`open()`（或等效）被调用。所有数据和元数据都在 inode 中。

使用行为获得的文件描述符`O_PATH`（至少在内核 3.5.0 上）就像普通文件描述符 wrt。移动和重命名用于打开描述符的名称或名称组件。（描述符保持有效，因为它引用 inode，并且文件名对象仅在路径解析期间使用。保持描述符打开将保持分配的 inode 资源，即使描述符已打开`O_PATH`。）

# ruby-on-rails - 在 Rails 中整合实例变量（将数据从控制器传递到视图）的最佳方法是什么？

> ID：12416890
> 
> 赞同：5
> 
> 时间：2012-09-14T01:10:38.197
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, object, instance-variables

我在 Rails 3 应用程序中有一个详细信息页面，其中包含多个实例变量。例如，我的视图有以下实例：

```
@product
@program
@action
...etc... 
```

其中一些是单个字符串，一些是数组（来自外部 API 的请求的结果）。总体而言，数据来自至少 3 个模型。

我的问题是：合并实例变量的最佳方法是什么，以便我的视图和控制器看起来更干净（不牺牲可读性）？我知道这个问题是开放式的，每个人都有自己的喜好，但是有哪些选择呢？我正在考虑将实例变量组合成一个对象，所以前面的代码变成了这样：

```
Details.product
Details.program
Details.action 
```

非常感谢！

更新：走对象路线，有没有实际实现它的好例子（github、博客文章）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T03:16:47.520

在我看来，清理控制器操作的最佳方法是在那里分配尽可能少的实例变量。在实践中，我尝试只在 action/before_filters 中分配实例变量，这些变量直接派生自传递给它的参数。此外，一般来说，我会尽量将尽可能多的实例变量分配推送到 before_filters 以保持动作苗条。

但是在动作中减少实例变量分配的最好方法是使用视图助手。例如，如果您当前在用于输出某些 div 的操作中分配实例变量，则只需使用视图助手直接执行输出，而无需将对象传递给视图。

这是控制器上的 before_filter 示例：

```
before_filter :assign_variables, :only => :show

def show; end

private
def assign_variables
  @product = Product.find(params[:product_id])
  @program = Program.find(params[:program_id])
  @action = Action.find(params[:action_id])
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T09:13:29.260

I would suggest not using instance variables at all and go with the decent exposure gem instead.

[https://github.com/voxdolo/decent_exposure](https://github.com/voxdolo/decent_exposure)

[http://railscasts.com/episodes/259-decent-exposure](http://railscasts.com/episodes/259-decent-exposure)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-15T05:46:04.270

每当您发现自己在控制器操作中有多个实例变量时，最好使用演示者模式。

该视频详细解释了所有内容 [“Ruby on Rails - Presenters & Decorators”](https://www.youtube.com/watch?v=OGdVJj-jNoc)

# c - 我可以以头文件实现中不存在的方式使用结构吗？

> ID：12416895
> 
> 赞同：0
> 
> 时间：2012-09-14T01:11:30.487
> 
> 标签：c, struct, header-files

所以我是一个 Java 和 C# 的人，最近在做一些 C 的事情。我有一个头文件，它有一个函数`void update(struct process* foo, float measurements)`，在头文件（.c 文件）的实现中，我将有这个函数：

```
void update(struct process* p,float measurements)
{
  *p.speed = *p.speed + measurements;
  *p.time = *p.time + 1;
  *p.noise = *p.noise + ((measurements)/100);
} 
```

现在在 Java 中，我必须导入类进程，这一切都很好。但是，在 .c 实现中，如果不在 .c 文件中声明结构，我将如何做到这一点（这将毫无意义，因为我想使用它从另一个模块传递参数）？

我是 C 语言的新手，可能这是一个非常基本的问题，但我在互联网上进行了一个小时的搜索，最终没有找到我想要的东西。也许我的关键字选择不当。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T01:18:15.037

您包括`process`结构定义所在的文件。

正如@AusCBloke 所注意到的，您要么使用`(*p).`取消引用结构指针并访问其成员，要么使用`p->`它的语法糖`(*p).`

# wordpress - WordPress：在索引页面上按类别/标签显示帖子

> ID：12416898
> 
> 赞同：0
> 
> 时间：2012-09-14T01:12:04.590
> 
> 标签：wordpress

是否可以在索引页面上按类别/标签显示帖子，而不是将用户带到 tag.php 和 category.php 页面？

例如，当用户单击“未分类”类别时，我希望所有未分类帖子替换索引页面上已有的帖子列表。

我一直在试图找出是否有人这样做，但我没有运气。如果有人能给我一个链接到某个地方，告诉我如何去做，或者让我知道如何更改代码以使其正常工作，我将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:17:51.940

这是可以做到的。我不记得做过的页面，但我知道它需要您创建自己的自定义页面模板。

[http://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates](http://codex.wordpress.org/Pages#Creating_Your_Own_Page_Templates)是开始学习如何创建页面模板的好地方。

一些附加链接 [http://codex.wordpress.org/Displaying_Posts_Using_a_Custom_Select_Query](http://codex.wordpress.org/Displaying_Posts_Using_a_Custom_Select_Query)

[http://wordpress.org/support/topic/tag-archive-from-a-single-category-is-this-possible?replies=34](http://wordpress.org/support/topic/tag-archive-from-a-single-category-is-this-possible?replies=34)

# parsing - 解析不完整或不正确代码的任何参考资料？

> ID：12416903
> 
> 赞同：9
> 
> 时间：2012-09-14T01:12:49.297
> 
> 标签：parsing, programming-languages, heuristics

例如，任何人都可以指出有关解析包含语法错误或缺少必要标点符号的代码的技术的参考资料吗？

我正在开发的应用程序是一个 IDE，我们希望在其中提供“跳转到定义”、自动完成和重构功能等功能，而无需在调用函数时源语法正确.

我见过的大多数解析器代码似乎都按照“早期失败”的原则工作，而不是专注于错误恢复或解析部分完整的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-15T01:30:27.317

你试过[ANTLR](http://www.antlr.org/)吗？

在“ [The Definitive ANTLR Reference](http://pragprog.com/book/tpantlr/the-definitive-antlr-reference) ”中，10.7 节 5 页的自动错误恢复策略 Terrence 谈到了这一点。他参考了[算法 + 数据结构 = 程序](http://www.worldcat.org/title/algorithms-data-structuresprograms/oclc/1324351&referer=brief_results)，[关于递归下降解析器中的错误恢复的说明，递归下降解析器](http://dl.acm.org/citation.cfm?id=947905)中的[高效和舒适的错误恢复](ftp://www.cocolab.com/products/cocktail/doc.pdf/ell.pdf)。

另请参阅网站上的页面：

*   [错误报告和恢复](http://www.antlr.org/wiki/display/ANTLR3/Error+reporting+and+recovery)

*   [ANTLR 3.0 错误报告和恢复](http://www.antlr.org/blog/antlr3/error.handling.tml)

*   [自定义语法错误恢复](http://www.antlr.org/wiki/display/ANTLR3/Custom+Syntax+Error+Recovery)

还要检查[ANTLR](https://stackoverflow.com/tags/antlr/info)标签以访问 Terrence Parr 回答问题的 ANTLR 论坛。[他确实以ANTLR Guy 的](https://stackoverflow.com/users/275496/the-antlr-guy)身份在这里回答了一些问题。

新版本的[ANTLR 4](http://www.antlr4.org)也即将[出版](http://antlr.markmail.org/search/?q=antlr%204%20book#query:antlr%204%20book%20page:1%20mid:i3lb7an3mkupvn4z%20state:results)。

抱歉听起来像是推销，但我多年来一直在使用 ANTLR，因为它被很多人使用，用于生产系统，有几个可靠的版本：Java、C、C#，有一个非常活跃的社区，有一个网站，有书籍，正在发展，维护，开源，BSD 许可，易于使用并有一些 GUI 工具。

Sam Harwell 是为 ANTLR 4 开发具有语法突出显示和自动完成以及其他有用 IDE 编辑功能的[GUI](http://www.antlr.org/wiki/display/ANTLR4/2.+Grammar+Editing+Features)的人之一。如果您可以通过 ANTLR 论坛联系到他，他或许可以帮助您。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-14T01:24:29.883

我不知道任何论文或教程，但[uu-parsinglib](http://hackage.haskell.org/package/uu-parsinglib-2.7.3.4)是一个 Haskell 解析库，可以以一般方式从语法错误中恢复。例如，如果`;`预期但`int`已接收，则解析器可以继续，就好像`;`插入到该源位置一样。

解析器在哪里失败以及在哪里进行更正取决于您，结果将与解析期间纠正的一组错误一起交付。即使您不打算在 Haskell 中实现解析代码，对该库的检查也可能会为您提供一些见解。或者您可以在 Haskell 中编写解析器并[从 C 调用它](http://www.haskell.org/haskellwiki/Calling_Haskell_from_C)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-15T00:43:26.243

您可能会对“岛屿语法”的研究感兴趣。自从我查看它们已经有一段时间了，但我相信它们应该能够合理地处理文件中有很多废话的情况。我对 CiteSeer 不太满意（奇怪的是；通常它还不错），但[Google Scholar](http://scholar.google.com/scholar?hl=en&q=island%20parsing&btnG=&as_sdt=1,22&as_sdtp=)找到了许多相关论文。[使用岛语法生成健壮的解析器](http://vefur.simula.no/~leonm/papers/wcre2001/wcre2001.pdf)看起来是一个不错的起点。

# oop - 将静态方法用作工厂是否被认为是不好的做法？

> ID：12416911
> 
> 赞同：1
> 
> 时间：2012-09-14T01:14:26.407
> 
> 标签：oop, factory-pattern

我看到大多数项目都创建了单独的工厂类，例如，它们将有一个 User 类和一个 UserFactory 类。如果您的工厂需要更多方法而不仅仅是 CreateUser 方法，这是有道理的，但这些工厂中的大多数只有一个构造函数和一个 CreateUser 方法（或工厂创建的任何等效方法）。`User.create()`那么，除了向类添加静态方法之外，还有其他原因可以创建单独的工厂类吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T01:22:33.843

根据我的经验，如果您经常想要更改实现，*尤其是对于测试用例*，主要使用单独的工厂类。例如，如果 User 具有访问数据库的方法并且对于单元测试来说“太慢”，那么您可能希望拥有一个不使用数据库的 MockUser。然后，您可以为实际应用程序使用 RealUserFactory，并为单元测试使用 MockUserFactory。

但是可能存在您想要更改的真实世界示例，例如从军事规范应用程序中的 SecurityClearedUser 到另一个应用程序中的 AnyOldUser。因此，配置文件将声明工厂的类，例如 MilitaryUserFactory 或 AnyOldFactory。

当然，User.create() 可以从配置文件中读取要创建的实际类。所以，在实践中，我不确定是否有那么大的差异。取决于事情是如何设置的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-19T13:14:34.967

要考虑的另一件事是“关注点分离”。在 User.Create 的情况下，用户类将做的比它应该做的更多，因此需要一个类来精确地做到这一点，即创建一个用户。

通过使用 User.Create，您可以将对象的创建与类本身耦合起来，在其他情况下，您将面临用户创建由多个步骤组成的场景，如果是这种情况，则 User.Create方法变得不合适。

所以简而言之，让用户对象负责成为用户，并将用户的创建外包给外部关注点，工厂。

从可读性的角度来看，User.Create 与 UserFactory.Create... 将其视为“汽车无法制造汽车”，但工厂可以。

# asp.net - 为什么我不能将数据集添加到我的 WCF Web 服务项目？

> ID：12416920
> 
> 赞同：0
> 
> 时间：2012-09-14T01:15:33.107
> 
> 标签：asp.net, vb.net, wcf, web-services

我是 WCF Web 服务的新手，我正在做我的第一个。我需要在服务中访问我的 SQL 数据库。通常，我将一个数据集添加到我的项目中，然后将我的表从服务器资源管理器拖到数据集并从那里开始工作。这似乎在 WCF Web 服务项目中不可用。有没有办法做到这一点？如果没有，我如何访问我的 sql 数据库表？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:21:39.230

我建议使用[Dapper](http://code.google.com/p/dapper-dot-net/)。这是一个非常简单直接的库，它只有一个文件！事实上 Stack Overflow 使用的是 Dapper。此外，它非常快。假设您有一个名为的表`Customer`，它看起来像这样：

```
Id int
Name varchar(255) 
```

好吧，使用 Dapper，您只需创建一个如下所示的 POCO 类：

```
public class Customer
{
    public int Id { get; set; }
    public string Name { get; set; }
} 
```

然后由于 Dapper 只是扩展了`IDbConnection`接口，当您创建一个并在要查询数据的类的顶部`SqlConnection`添加语句时，Dapper 方法会显示在该连接对象上。`using`

该链接有关于如何使用该库的非常好的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T01:45:13.467

实际上我从来没有想过如何通过在项目中添加新项目来添加数据集，但是我能够从另一个项目中复制数据集并很好地使用它。

# c - 为什么不对 C 中的结构使用 typedef？

> ID：12416924
> 
> 赞同：6
> 
> 时间：2012-09-14T01:16:33.643
> 
> 标签：c, struct, typedef

我正在研究用于 ARM 低功耗设备的 C 应用程序，我首先有这段代码

```
struct state {
    float position;
    int dummy;
}; 
```

注意这个结构没有定义一个新类型，我也注意到在后面的代码中这个结构是这样使用的

```
struct state mystate; 
```

这对我来说很奇怪，不方便，不灵活，并且有一个额外的无用关键字，我可以很容易地避免`typedef`首先将其用于结构。

这是一个对该应用程序的业务逻辑至关重要的结构，并且在源代码中也被大量使用。

`typedef`不使用最终用作类型的结构有一个特殊的原因吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-14T01:28:09.617

我认为 typedef 有害。我认为它几乎总是被误用。在我看来，它是有用的，并且仅在底层类型被完全抽象时才有用 - 例如，所有操作都是通过函数进行的。否则，底层类型不会被抽象——用户仍然必须知道它是什么，才能理解代码——所发生的只是代码可读性受损，类型命名空间没有获得收益（对于类型未正确抽象）扩展。

在我看来，几乎所有对 typedef 的使用都缺乏对它带来的问题以及应该如何使用它的理解。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-14T06:06:04.360

这里没有提到的一个小细节，来自 C 标准。

> 6.7.7.3 [...] typedef 声明不引入新类型，仅引入指定类型的同义词。

您可以使用它来抽象出一些细节，但是当有人走到只允许函数调用的极端时，我想知道他们如何在 a`size_t`和泄漏知识它是 unsigned int 类型的地方分配内存是必要的。

鉴于它只是一个别名，我在使用 typedef 作为快捷方式时也没有任何问题，例如省略一个在任何地方都需要的附加关键字。我不喜欢重复的样板代码，隐藏它会使代码更短。您应该小心一点，以免影响清晰度和可读性，因此我也更喜欢始终保持命名空间清洁。我觉得这很糟糕：

```
typedef struct state {
    float position;
    int dummy;
} state; 
```

而是更喜欢这样的东西：

```
typedef struct s_state {
    float position;
    int dummy;
} t_state; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-14T01:19:24.810

这主要是为了清楚起见。在实践中，人们普遍认为，如果您必须使用 struct 关键字，您应该自己操作内部数据。当结构是 typedef'd 时，它隐藏了实际类型，并且操作应该由函数完成。这是一个并不总是遵循的约定，其他人只是留下 struct 关键字以将其与不透明类型区分开来。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-14T01:18:32.653

使用`typedef`与否是个人喜好。就个人而言，我只`typedef`用于复杂的指针类型或函数指针。

当你声明一个结构时，你也声明了一个类型，即`struct structName`. typedef 所做的只是允许您`struct`在这种情况下取​​出定义的一部分，并且不是必需的。这与低功率设备完全无关。

# azure-sql-database - 在 SQL Azure 联合中创建具有主键和单独唯一列的表

> ID：12416925
> 
> 赞同：0
> 
> 时间：2012-09-14T01:16:34.343
> 
> 标签：azure-sql-database, unique-constraint, bigint

如何在 SQL Azure 联合中创建唯一标识符 ID 列和唯一 nvarchar(256) 电子邮件地址列？我不是 SQL 专家，所以我不知道如何设置唯一约束，或者是否可以在联合数据库中这样做。

编辑：

我找到了一个 TSQL 查询来创建唯一约束，但出现以下错误：

“联合表上的唯一索引或聚集索引必须包含联合列”

我认为我的联合列是 ID 列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:49:29.983

只需按照错误告诉您的内容进行操作即可。

联合列必须是唯一索引或聚集索引的一部分。

请参阅：[联合指南和限制](http://msdn.microsoft.com/en-us/library/windowsazure/hh597469.aspx)

因此，对于您的唯一索引，列应该是 Id+emailAddress

# php - Zend Gdata 登录，两步验证/验证

> ID：12416928
> 
> 赞同：3
> 
> 时间：2012-09-14T01:16:38.317
> 
> 标签：php, zend-framework, gmail, zend-gdata, two-factor-authentication

我最近为我的 Gmail 帐户激活了两步验证，因此注意到我使用 Zend Gdata 库的应用程序停止工作。我禁用了两个因素验证，然后他们又开始工作了。

我在网上找不到任何关于使用 Zend Gdata 库进行两步验证的信息。有没有人找到解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-22T01:03:20.733

为使用 Zend Gdata 的应用程序创建应用程序特定凭证，它们不需要使用两步验证。

[https://support.google.com/mail/answer/1173270?hl=en](https://support.google.com/mail/answer/1173270?hl=en)

# java - J2ME setCurrent()

> ID：12416929
> 
> 赞同：2
> 
> 时间：2012-09-14T01:16:48.623
> 
> 标签：java, java-me, pim

我已经问过了，但我需要进一步的知识。我正在尝试使用按钮命令将两个类链接在一起。我在这里遵循了最后一个答案，但是当我分开课程时，它不起作用。我使用 b2Command 来触发事件。这是我的代码：

MainMidlet.java

```
 /*
   * To change this template, choose Tools | Templates
   * and open the template in the editor.
  */

import javax.microedition.midlet.*;
import javax.microedition.lcdui.*;
import javax.microedition.lcdui.StringItem;
import javax.microedition.lcdui.Command;
import javax.microedition.lcdui.Displayable;
import javax.microedition.lcdui.Display;

/**
* @author bon
*/
public class MainMidlet extends MIDlet implements CommandListener, 
ItemCommandListener, ItemStateListener{
private Display display;
private Form form;
private Command okCommand, backCommand, exitCommand, b1Command, b2Command, exCommand,    boutCommand;
private StringItem b1stringItem, b2stringItem, boutstringItem, exstringItem;

public AddCalendarEvent addcalendarevent;

public MainMidlet(){
    okCommand = new Command ( "OK", Command.OK, 1); 
    exitCommand = new Command ( "EXIT", Command.EXIT, 1);
    backCommand = new Command ( "BACK", Command.BACK, 1);
    b1Command = new Command ( "BUTTON", Command.ITEM, 2);
    b2Command = new Command ( "BUTTON", Command.ITEM, 2);
    exCommand = new Command ( "BUTTON", Command.ITEM, 2);
    boutCommand = new Command ( "BUTTON", Command.ITEM, 2);

    form = new Form ( "CyberMe");

    b1stringItem = new StringItem (null, "Make Todo", Item.BUTTON); 
    b1stringItem.setItemCommandListener (this); 
    b1stringItem.setDefaultCommand (b1Command);

    b2stringItem = new StringItem (null, "Set Alarm", Item.BUTTON); 
    b2stringItem.setItemCommandListener (this); 
    b2stringItem.setDefaultCommand (b2Command);

    boutstringItem = new StringItem (null, "About", Item.BUTTON); 
    boutstringItem.setItemCommandListener (this); 
    boutstringItem.setDefaultCommand (boutCommand);

    exstringItem = new StringItem (null, "Exit", Item.BUTTON); 
    exstringItem.setItemCommandListener (this); 
    exstringItem.setDefaultCommand (exCommand);

    form.append ( "Any Appointment?"); 
    form.append (b1stringItem);
    form.append (b2stringItem);
    form.append (boutstringItem);
    form.append (exstringItem);

    form.addCommand (okCommand); 
    form.addCommand (exitCommand); 
    form.setCommandListener (this);
}

public void startApp() {
    display = Display.getDisplay(this);
    display.setCurrent(form);
}

public void pauseApp() {
}

public void destroyApp(boolean unconditional) {
}

public void commandAction(Command c, Displayable d) {
    throw new UnsupportedOperationException("Not supported yet.");
}

public void commandAction(Command c, Item item) {

if (c == b1Command) { 
//display.setCurrent (); 
}
else if (c == b2Command){
    addcalendarevent = new AddCalendarEvent(this);
    display.setCurrent(addcalendarevent);
}
else if (c == exCommand){
destroyApp(false); 
notifyDestroyed ();
}
//else if (c == boutCommand)
//display.setCurrent ();
}

public void itemStateChanged(Item item) {
    throw new UnsupportedOperationException("Not supported yet.");
}
} 
```

这就是我要链接的内容：AddCalendarEvent.java

```
 /*
        * To change this template, choose Tools | Templates
        * and open the template in the editor.
        */
        import javax.microedition.midlet.MIDlet;
        import javax.microedition.lcdui.Displayable;
        import javax.microedition.lcdui.Display;
        import javax.microedition.lcdui.Form;
        import javax.microedition.lcdui.CommandListener;
        import javax.microedition.lcdui.TextField;
        import javax.microedition.lcdui.DateField;
        import javax.microedition.lcdui.Command;
        import javax.microedition.lcdui.Alert;

        import javax.microedition.pim.PIM;
        import javax.microedition.pim.PIMItem;
        import javax.microedition.pim.EventList;
        import javax.microedition.pim.Event;
        import javax.microedition.pim.PIMException;

        import java.util.Date;
        /**
        *
        * @author bon
        */
        public class AddCalendarEvent extends MainMidlet{
            private Display display;
            // Form where user can enter data of new event.
            private Form addEventForm;

            // Command for adding event to list of events. Placed on addEventForm.
            private Command cmdAddEvent;
            // Command for exiting from application. Placed on addEventForm.
            private Command cmdExit;

            // Text field for summary of event.
            private TextField summaryField;
            // Date field for start data of event.
            private DateField startDateField;
            // Date field for end data of event.
            private DateField endDateField;
            // Text field for note of event.
            private TextField noteField;
            // Text field for location of event.
            private TextField locationField;

            /**
            * Constructor.
            */    
            public AddCalendarEvent() {
                if(checkPIMSupport() == false) {
                    exitMIDlet();
                }

                initializeComponents();
            }

            /**
            * Initializes components of midlet.
            */      
            public void initializeComponents() {
                display = Display.getDisplay(this);

                // Create form for adding event.
                addEventForm = new Form("Add event");

                // Add commands to form and set listener for it.
                cmdAddEvent = new Command("Add event", Command.SCREEN, 0);
                addEventForm.addCommand(cmdAddEvent);

                cmdExit = new Command("Exit", Command.EXIT, 0);
                addEventForm.addCommand(cmdExit);

                addEventForm.setCommandListener(this);        

                try {
                    // Get list of events.
                    EventList eventList = (EventList)PIM.getInstance().openPIMList(
                            PIM.EVENT_LIST, PIM.READ_WRITE);

                    // Create controls based on supported fields for event.
                    if(eventList.isSupportedField(Event.SUMMARY) == true) {
                        summaryField = new TextField("Summary", null, 20, 
                                                    TextField.ANY);
                        addEventForm.append(summaryField);
                    } else {
                        // At least "summary" field must be supported. 
                        // If not, throw exception.
                        eventList.close();
                        throw new Exception("Summary field is not supported");
                    }

                    if(eventList.isSupportedField(Event.START) == true) {
                        startDateField = new DateField("Start date", 
                                                    DateField.DATE_TIME);
                        startDateField.setDate(new Date());
                        addEventForm.append(startDateField);
                    }

                    if(eventList.isSupportedField(Event.END) == true) {
                        endDateField = new DateField("End date", DateField.DATE_TIME);
                        endDateField.setDate(new Date());
                        addEventForm.append(endDateField);
                    }

                    if(eventList.isSupportedField(Event.NOTE) == true) {
                        noteField = new TextField("Note", null, 20, TextField.ANY);
                        addEventForm.append(noteField);
                    }

                    if(eventList.isSupportedField(Event.LOCATION) == true) {
                        locationField = new TextField("Location", null, 20, 
                                                    TextField.ANY);
                        addEventForm.append(locationField);
                    }            

                    // Close list of events.
                    eventList.close();

                } catch(PIMException pimExc) {
                    // TODO: Handle error on working with PIM.
                }
                catch(SecurityException secExc) {
                    // TODO: Handle error on access to PIM.
                }
                catch(Exception exc) {
                    // If unknown error was catched, exit from application.
                    exitMIDlet();
                }
            }

            /**
            * Checks PIM support.
            * @return - true if PIM is supported, false otherwise.
            */    
            private boolean checkPIMSupport() {
                String propValue = System.getProperty("microedition.pim.version");
                if(propValue != null) {
                    return true;
                } else {
                    return false;
                }
            }

            /**
            * Adds event to list of events. 
            * Gets data for event from addEventForm controls.
            */
            private void addEvent() {
                try {
                    // Get list of events.
                    EventList eventList = (EventList)PIM.getInstance().openPIMList(
                            PIM.EVENT_LIST, PIM.READ_WRITE);            

                    // Create new event.
                    Event event = eventList.createEvent();

                    // Get data from controls
                    if(eventList.isSupportedField(Event.SUMMARY) == true) {
                        String summary = summaryField.getString();
                        event.addString(Event.SUMMARY, PIMItem.ATTR_NONE, summary);
                    } else {
                        // At least summary must be supported.
                        eventList.close();
                        throw new Exception("Summary field for event is not supported");
                    }

                    if(eventList.isSupportedField(Event.START) == true) {
                        long startDate = startDateField.getDate().getTime();
                        event.addDate(Event.START, PIMItem.ATTR_NONE, startDate);
                    }

                    if(eventList.isSupportedField(Event.END) == true) {
                        long endDate = endDateField.getDate().getTime();
                        event.addDate(Event.END, PIMItem.ATTR_NONE, endDate);
                    }

                    if(eventList.isSupportedField(Event.NOTE) == true) {
                        String note = noteField.getString();
                        event.addString(Event.NOTE, PIMItem.ATTR_NONE, note);
                    }

                    if(eventList.isSupportedField(Event.LOCATION) == true) {
                        String location = locationField.getString();
                        event.addString(Event.LOCATION, PIMItem.ATTR_NONE, location);
                    }      

                    // Commit event.
                    event.commit();
                    // Close list of events.
                    eventList.close();

                    // Notify user that event was added
                    showAlert("Info", "Event was successfully added.");

                } catch(PIMException pimExc) {
                    // TODO: Handle error on working with PIM.
                    showAlert("PIMException", pimExc.getMessage());
                }
                catch(SecurityException secExc) {
                    // TODO: Handle error on access to PIM.
                    showAlert("SecurityException", secExc.getMessage());
                }
                catch(Exception exc) {
                    // TODO: Handle all other errors.
                    showAlert("Exception", exc.getMessage());
                }   
            }

            /**
            * Shows alert with specified title and text.
            * @param title - Title of alert.
            * @param message - text of alert.
            */
            private void showAlert(String title, String message) {
                Alert alert = new Alert(title);
                alert.setString(message);
                alert.setTimeout(Alert.FOREVER);
                display.setCurrent(alert);
            }

            private void exitMIDlet() {
                notifyDestroyed();
            }

            public void commandAction(Command command, Displayable displayable) {
                if(command == cmdAddEvent) {
                    addEvent();
                }

                if(command == cmdExit) {
                    exitMIDlet();
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T03:09:03.743

试试这个，

// 在 MainMidlet 类中定义一个公共静态方法

```
private static Display display;  // declare static Display variable.

public static Display getDisplay () 
{
    return display;
} 
```

现在从 AddCalendarEvent 类访问此方法，如下所示，

```
private void showAlert(String title, String message) 
{
    Alert alert = new Alert(title);
    alert.setString(message);
    alert.setTimeout(Alert.FOREVER);
    MainMidlet.getDisplay().setCurrent(alert);  // this line has been changed
} 
```

# android - 使用 TimerTask 延迟发送 SMS

> ID：12416930
> 
> 赞同：0
> 
> 时间：2012-09-14T01:16:55.647
> 
> 标签：android, timer, sms, delay, timertask

我正在开发的代码（android 应用程序）接收短信，如果短信来自某个号码，那么它会返回预定义的短信。这一切都很好，虽然我想添加一个计时器，以便回复看起来很真实。通过一些研究，我想出了下面的代码来尝试延迟代码，以便消息在 30 秒延迟后发送。

我定义了一个名为 Timer1 的新计时器，延迟 30 秒，并在顶部定义了一个名为 tt1 的 TimerTask，然后在 onReceive() 中，就在我调用 sendSMS 方法之前，我调用了启动计时器的 timer() 方法。

但是，计时器永远不会停止，消息也永远不会发送。该应用程序最终在几次后崩溃谁能看到我做错了什么？

```
 static Timer timer1 = new Timer();
static long delay = 30000;
static TimerTask tt1;

        private BroadcastReceiver intentReceiver = new BroadcastReceiver() {
    @Override
    public void onReceive(Context context, Intent intent) {

        //---gather up all the necessary user input---
        prefs = getSharedPreferences(prefName, MODE_PRIVATE);
        String textMessage = (String) prefs.getString(NAME_KEY, "");
        final Button btn2 = (Button)findViewById(R.id.btnContacts);
        String phoneNumber = (String) btn2.getText();
        String Sender = (String) intent.getExtras().getString("Sender");

        if(Sender.equals(phoneNumber))
        {
            timer();
            sendSMS(phoneNumber, textMessage); 
        }
        }
    }
     };

        //---holds the delay for realistic reply time---
public static void timer() 
{
    timer1.schedule(tt1 ,0,delay);      
}

//---sends an SMS message to another device---
public void sendSMS(String phoneNumber, String message)
{       
    SmsManager sms = SmsManager.getDefault();
    sms.sendTextMessage(phoneNumber, null, message, null, null);
} 
```

**编辑：我现在使用 handler.postDelayed 暂停发送文本。这效果更好**

在这里找到 handler.postDelayed 的良好初学者资源：http: [//www.appaholics.in/running-a-task-with-a-delay/](http://www.appaholics.in/running-a-task-with-a-delay/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:25:09.213

改用`Handler.postDelayed`http://developer.android.com/reference/android/os/Handler.html#postDelayed(java.lang.Runnable,%20long [)](http://developer.android.com/reference/android/os/Handler.html#postDelayed%28java.lang.Runnable,%20long%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T02:34:41.563

```
 what I am doing wrong? 
```

这是你错的地方

`timer1.schedule(tt1 ,0,delay);`

上面的语句会创建一个每隔 30 秒重复发送 SMS 操作的时间表。

我相信你只需要回复一次短信给发件人，所以你需要改变你的代码如下，

```
timer1.schedule(tt1 ,100); 
```

现在上面的代码将在 100 毫秒后向发送者回复一次短信。

# python - 在熊猫中按多个日期对数据进行分组

> ID：12416932
> 
> 赞同：3
> 
> 时间：2012-09-14T01:17:06.000
> 
> 标签：python, pandas

我有一些包含日期的数据，例如：

```
1979-02-15
1979-02-15
1979-02-17
1979-02-17 
```

我想按年、月和日期对数据进行分组，以便数据看起来像

```
1979
02
15

1979-02-15
1979-02-15

1979
02
17

1979-02-17
1979-02-17 
```

我找到了功能

```
grouped = df.groupby(lambda x: x.year) 
```

但这仅允许按年份分组。所以，我的问题是如何在熊猫中按日期进行多级分组？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T03:59:01.527

您可以将多个键作为列表传递给 groupby：

```
from pandas import *
from numpy.random import randn
rng = date_range('1/1/2011', periods=7200, freq='H')
ts = Series(randn(len(rng)), index=rng)
for key, data in ts.groupby([rng.year, rng.month]):
    print key, data.sum() 
```

# twitter-bootstrap - 您可以在下拉菜单中使用拆分按钮下拉菜单吗？

> ID：12416933
> 
> 赞同：0
> 
> 时间：2012-09-14T01:17:06.340
> 
> 标签：twitter-bootstrap

使用 twitter 引导框架的下拉登录菜单中的下拉菜单存在问题。登录框的第二个下拉菜单不起作用。是否可以在下拉列表中包含拆分按钮下拉列表，如下例所示。

在这里看到这个小提琴。

[http://jsfiddle.net/DMWFj/](http://jsfiddle.net/DMWFj/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T03:00:09.020

当您单击第二个下拉按钮时，jQuery 插件“bootstrap-dropdown.js”会隐藏**所有**具有“open”类的元素。

您需要编辑文件“bootstrap-dropdown.js”（http://twitter.github.com/bootstrap/assets/js/bootstrap-dropdown.js）并重写函数 clearMenus()。

在此文件中查找下一个代码：

```
function clearMenus() {
    getParent($(toggle))
      .removeClass('open')
} 
```

并将其替换为：

```
function clearMenus($this) {
    getParent($this)
      .removeClass('open')
} 
```

在附近找到行 clearMenus()：

```
 , toggle: function (e) {
  var $this = $(this)
    , $parent
    , isActive

  if ($this.is('.disabled, :disabled')) return

  $parent = getParent($this)

  isActive = $parent.hasClass('open')

  clearMenus() // here 
```

将行替换`clearMenus()`为`clearMenus($this)`。

这里 jsFiddle 示例：http: [//jsfiddle.net/BMBc3/](http://jsfiddle.net/BMBc3/)

# java - 数组和链接结构

> ID：12416936
> 
> 赞同：0
> 
> 时间：2012-09-14T01:17:33.107
> 
> 标签：java, arrays, element, structure

我在学校学习 java 数据结构和算法课程，我完全迷失在数组和链接结构上，如果有人可以告诉我一些很好的链接或教程，可以很好地解释......谢谢

数组操作：

*   遍历
*   调整大小
*   替换元素
*   替换元素插入元素
*   删除一个元素

链接结构特点：

*   SLNode
*   遍历
*   替换元素
*   替换元素
*   插入一个元素
*   删除一个元素

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T02:22:41.710

首先要了解大局并了解这两者之间的区别。

正如[java文档中提到的](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)

> “数组是一个容器对象，它保存了固定数量的单一类型的值。数组的长度是在创建数组时确定的。创建后，它的长度是固定的”。

简而言之，这意味着当您声明一个数组时，您应该给出一个大小。

如果您考虑链接的数据结构，您会发现它们没有预定义大小。它就像一条链子。您可以将新节点链接到链上的任何位置。 [读这个](http://math.hws.edu/javanotes/c9/s2.html)

用于操作那些阅读流畅的文章。

*   [http://www.geeksforgeeks.org/archives/10245](http://www.geeksforgeeks.org/archives/10245)
*   [http://www.roseindia.net/java/collection/array-operation-collections.shtml](http://www.roseindia.net/java/collection/array-operation-collections.shtml)

有很多链接的数据结构，但首先学习 ArrayList 对你来说可能很容易

*   [http://www.anyexample.com/programming/java/java_arraylist_example.xml](http://www.anyexample.com/programming/java/java_arraylist_example.xml)
*   [http://www.roseindia.net/java/beginners/array_list_demo.shtml](http://www.roseindia.net/java/beginners/array_list_demo.shtml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T01:25:41.727

数组（VB 和 Java）
[http://msdn.microsoft.com/en-us/library/office/aa164778(v=office.10).aspx](http://msdn.microsoft.com/en-us/library/office/aa164778%28v=office.10%29.aspx)
[http://www.dummies.com/how-to/content/理解-arrays-in-java.html](http://www.dummies.com/how-to/content/understanding-arrays-in-java.html)

链接列表
[http://www.eternallyconfuzzled.com/tuts/datastructures/jsw_tut_linklist.aspx](http://www.eternallyconfuzzled.com/tuts/datastructures/jsw_tut_linklist.aspx)
[http://cslibrary.stanford.edu/103/LinkedListBasics.pdf](http://cslibrary.stanford.edu/103/LinkedListBasics.pdf)

希望能帮助到你！

# ios6 - UIImageView 定义没有 .frame 的大小

> ID：12416941
> 
> 赞同：1
> 
> 时间：2012-09-14T01:17:53.940
> 
> 标签：ios6, iphone-5, xcode4.5

我有一个启用了分页的 UIScrollView。我想用图像填充它，并且我有一个 UIImageView 需要在不使用`.frame`. 这是因为它不适用于启用自动布局。不使用自动布局不是一种选择。

这是它的代码：

```
//Prepare and load the view
[scrollView1 setContentSize:CGSizeMake((kNumImages * kScrollObjWidth), (kScrollObjHeight))];
scrollView1.pagingEnabled = YES;
[scrollView1 setShowsHorizontalScrollIndicator:NO];

CGRect Rect = scrollView1.bounds;
UIImageView *beadContainer;

for (int i = 0; i < imageViews.count; i++)
{
    beadContainer = [imageViews objectAtIndex:i];
    beadContainer.frame = Rect;
    [scrollView1 addSubview:beadContainer];
    Rect.origin.x += Rect.size.width;
} 
```

尽管 ScrollView 具有所有正确的尺寸并按预期滚动，但没有任何图像按原样显示。如果我注释掉`beadContainer.frame = Rect;`，那么数组中的所有图像`imageViews`都会出现在`0, 0`. 它们都出现在彼此之上。当然，我需要它们来填充 ScrollView。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T13:24:09.000

为什么不使用自动布局来布局图像？

```
//Prepare and load the view
[scrollView1 setContentSize:CGSizeMake((kNumImages * kScrollObjWidth), (kScrollObjHeight))];
scrollView1.pagingEnabled = YES;
[scrollView1 setShowsHorizontalScrollIndicator:NO];

UIImageView *firstImage = imageViews[0];
UIImageView *lastImageView = [imageViews lastObject];
UIImageView *previousImageView = nil;
NSMutableArray *constraints = [NSMutableArray new];
for (UIImageView *imageView in imageViews){
    [scrollView1 addSubview:imageView];
    //set the size of the images
    [constraints addObject:[NSLayoutConstraint constraintWithItem:imageView
                                                        attribute:NSLayoutAttributeWidth
                                                        relatedBy:NSLayoutRelationEqual
                                                           toItem:nil
                                                        attribute:NSLayoutAttributeNotAnAttribute
                                                       multiplier:1.0f
                                                         constant:kScrollObjWidth]];
    [constraints addObject:[NSLayoutConstraint constraintWithItem:imageView
                                                        attribute:NSLayoutAttributeHeight
                                                        relatedBy:NSLayoutRelationEqual
                                                           toItem:nil
                                                        attribute:NSLayoutAttributeNotAnAttribute
                                                       multiplier:1.0f
                                                         constant:kScrollObjHeight]];
    //remove autoresizing masks
    [imageView setTranslatesAutoresizingMaskIntoConstraints:NO];
    //pin the top of the imageview to the top of the superview
    [constraints addObjectsFromArray:[NSLayoutConstraint constraintWithVisualFormat:@"V:|[imageView]"
                                                                            options:0
                                                                            metrics:nil
                                                                              views:NSDictionaryOfVariableBindings(imageView)]];

    if ([firstImage isEqual:imageView]){ //pin the first image view to the left of the scrollview
        [constraints addObjectsFromArray:[NSLayoutConstraint constraintWithVisualFormat:@"|[firstImage]"
                                                                                options:0
                                                                                metrics:nil
                                                                                  views:NSDictionaryOfVariableBindings(firstImage)]];
    }

    if (previousImageView){ //pin any imageViews to the previous imageViews
        [constraints addObjectFromArray:[NSLayoutConstraint constraintWithVisualFormat:@"[previousImageView][imageView]"
                                                                               options:0
                                                                               metrics:nil
                                                                                 views:NSDictionaryOfVariableBindings(imageView, previousImageView)]];
    }
    previousImageView = imageView;
}

[scrollView1 addConstraints:constraints]; 
```

请注意，我没有尝试过，它可能是垃圾代码，我是在文本编辑器中编写的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T18:51:35.563

如果您要完全使用自动布局，请不要设置滚动视图的`contentSize`. 只需使用约束完全布置内容，确保描述每个内容子视图的大小，以及内容子视图与围绕它们的假想矩形边界的距离。运行时将自动使用该虚构的矩形来创建内容大小。

# android - Android允许取消选中但不选中

> ID：12416942
> 
> 赞同：0
> 
> 时间：2012-09-14T01:17:55.253
> 
> 标签：android, checkbox

我有一个 Checkable ListView，我想让用户检查 15 个项目。一旦他们检查了 15 个项目，我就想做它，这样他们就不能再检查任何项目，但他们可以随意取消选中。

# workflow - Tridion 2011 SP1 - Publication 的默认工作流程仅适用于新页面

> ID：12416950
> 
> 赞同：3
> 
> 时间：2012-09-14T01:18:56.073
> 
> 标签：workflow, tridion, tridion-2011

我为出版物中的页面创建了一个新的工作流定义，并将其设置为出版物属性的默认值。

问题是只有新页面会触发工作流程。现有页面（在定义之前创建）在编辑时不会触发它。

有没有其他人经历过这个并且知道解决方案？我宁愿不通过几十个结构组属性来设置工作流定义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T19:43:11.847

我敢打赌，您的一位同事已将此配置放在结构组上，而您没有发现 :) - 看看那里。

# codeigniter - 在代码点火器中使用 hmvc 的模块特定路由？

> ID：12416951
> 
> 赞同：0
> 
> 时间：2012-09-14T01:19:13.330
> 
> 标签：codeigniter, routing, hmvc

我正在使用带有 HMVC 的代码点火器，

我们正在创建插入式模块。

我有点坚持的一件事是路由。

我可以加

```
$route['gallery/categories'] = 'gallery/categorieseditor';
$route['gallery/categories/(:any)] = 'gallery/categorieseditor/$1'; 
```

到主要的 routes.php 配置文件，它工作正常。

但我不想编辑模块的主路由文件。

我希望我可以把它放到一个`routes.php`文件中`/modules/gallery/config/`但是访问 url 只会给我一个 404（访问`/gallery/categorieseditor`作品）。

我怎样才能启动并运行它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T01:52:49.780

您的代码中有错误：

`$route['gallery/categories/(:any)] = 'gallery/categorieseditor/$1';`

应该：

`$route['gallery/categories/(:any)'] = 'gallery/categorieseditor/$1';`

# linux - 在 Mac 上为编译器添加 boost 包含路径

> ID：12416953
> 
> 赞同：0
> 
> 时间：2012-09-14T01:19:26.437
> 
> 标签：linux, macos, unix, boost

我刚刚在 OSX Mountain Lion 上完成了 Boost 的安装，我得到了这个对话框......

> 应将以下目录添加到编译器包含路径：
> 
> ```
> /usr/local/boost_1_51_0 
> ```
> 
> 应将以下目录添加到链接器库路径：
> 
> ```
> /usr/local/boost_1_51_0/stage/lib 
> ```

Boost“入门”页面建议使用此程序：

```
#include <boost/lambda/lambda.hpp>
#include <iostream>
#include <iterator>
#include <algorithm>

int main()
{
    using namespace boost::lambda;
    typedef std::istream_iterator<int> in;

    std::for_each(
        in(std::cin), in(), std::cout << (_1 * 3) << " " );
} 
```

使用此脚本编译：

```
c++ -I /usr/local/boost_1_51_0 example.cpp -o example 
```

有没有办法在 Linux/UNIX for Mac 中添加这个包含路径，所以我在编译时不必总是输入路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T12:30:54.187

简短的回答：是的。

长答案：你不应该这样做。

原因：如果您添加特定的编译器标志以始终使用，无论您正在编译什么，您最终都会遇到包含或链接错误内容的情况。

明确声明要在 makefile 或命令行中使用的标志总是一件好事，并且有类似的工具`pkg-config`可以减少麻烦和容易出错。

# android - Android Mapview可绘制图标毁容

> ID：12416956
> 
> 赞同：0
> 
> 时间：2012-09-14T01:20:01.987
> 
> 标签：android, android-mapview, drawable

从 JSON 文件解析一个地理点时，我有一个 MapView，drawable 看起来很正常，但是当我解析地图集的所有地理点时，drawable 图标看起来丑陋和变形？什么会导致这个？我也在使用 MapView Ballons Library。[MapView 气球](https://github.com/jgilfelt/android-mapviewballoons)

**毁容的地图密码**

```
public class ViewAll  extends MapActivity

{   static final String KEY_MAPNAME = "name";
static final String KEY_MAPLOCATION = "address";
static final String KEY_MAPLONG = "longitude";
static final String KEY_MAPLAT = "latitude";
static final String KEY_MAPSETMAPSET = "";

TapControlledMapView mapView; // use the custom TapControlledMapView
List<Overlay> mapOverlays;
Drawable drawable;

SimpleItemizedOverlay itemizedOverlay;

;

 @Override
 public void onCreate(Bundle savedInstanceState)
 {
 super.onCreate(savedInstanceState);
 setContentView(R.layout.maps);

 Intent in = getIntent();
    String mapset = in.getStringExtra(KEY_MAPSETMAPSET);

    mapView = (TapControlledMapView) findViewById(R.id.mapview);
    mapView.setBuiltInZoomControls(true);
    mapView.setSatellite(false);
    // dismiss balloon upon single tap of MapView (iOS behavior) 
    mapView.setOnSingleTapListener(new OnSingleTapListener() {      
        public boolean onSingleTap(MotionEvent e) {
            itemizedOverlay.hideAllBalloons();
            return true;
        }
    });

    mapOverlays = mapView.getOverlays();

    // first overlay
    drawable = getResources().getDrawable(R.drawable.marker2);

    itemizedOverlay = new SimpleItemizedOverlay(drawable, mapView);
    // set iOS behavior attributes for overlay
    itemizedOverlay.setShowClose(false);
    itemizedOverlay.setShowDisclosure(true);
    itemizedOverlay.setSnapToCenter(false); 

try {

          JSONObject jOBj;
          JSONArray  jsonArray;
          JSONArray jarray=new JSONArray(mapset);

          for(int j=0;j<jarray.length();j++){
                jOBj=jarray.getJSONObject(j);
                jsonArray = jOBj.getJSONArray("locations");
                  for(int i=0;i < jsonArray.length();i++){                     

                    JSONObject maps = jsonArray.getJSONObject(i);

                  String.valueOf(i);

                    String latitude = maps.getString("latitude");
                    String longitude = maps.getString("longitude");
                    String name = maps.getString("name");
                    String address = maps.getString("address");

                    double lat = Double.parseDouble(latitude);
                    double lng = Double.parseDouble(longitude);
                    GeoPoint point = new GeoPoint(
                             (int) (lat * 1E6), 
                             (int) (lng * 1E6));
                    OverlayItem overlayItem = new OverlayItem(point, name, 
                            address);
                    itemizedOverlay.addOverlay(overlayItem);

                    mapOverlays.add(itemizedOverlay);

                    // second overlay

                    if (savedInstanceState == null) {

                        final MapController mc = mapView.getController();
                        mc.animateTo(point);
                        mc.setZoom(2);

                    } else {

                        // example restoring focused state of  overlays
                        int focused;
                        focused =  savedInstanceState.getInt("focused_1", -1);
                        if (focused >= 0) {
                             itemizedOverlay.setFocus(itemizedOverlay.getItem(focused));
                        }

                        }

             RadioGroup radGrp = (RadioGroup) findViewById(R.id.map_type);
             int checkedRadioButtonID = radGrp.getCheckedRadioButtonId();
             radGrp.setOnCheckedChangeListener(new  RadioGroup.OnCheckedChangeListener() {
               public void onCheckedChanged(RadioGroup arg0, int id) {
                 switch (id) {

                 case R.id.maps:
                     mapView.setSatellite(false);
                   break;
                 case R.id.satellite:
                     mapView.setSatellite(true);
                   break;

                 default:
                     mapView.setSatellite(false);
                   break;
                 }
               }
             });    }   

              }

 }catch(JSONException e)        {
   Log.e("log_tag", "Error parsing data "+e.toString());
 }
}

@Override
protected boolean isRouteDisplayed() {
    // TODO Auto-generated method stub
    return false;
}} 
```

**法线贴图密码**

```
public class Maps  extends MapActivity

{
static final String KEY_MAPSETMAPSET = "";
static final String KEY_MAPNAME = "name";
static final String KEY_MAPLOCATION = "address";
static final String KEY_MAPLONG = "longitude";
static final String KEY_MAPLAT = "latitude";

TapControlledMapView mapView; // use the custom TapControlledMapView
List<Overlay> mapOverlays;
Drawable drawable;
Drawable drawable2;
SimpleItemizedOverlay itemizedOverlay;
SimpleItemizedOverlay itemizedOverlay2;

 @Override
 public void onCreate(Bundle savedInstanceState)
 {
 super.onCreate(savedInstanceState);
 setContentView(R.layout.maps);

 Intent in = getIntent();
    String name = in.getStringExtra(KEY_MAPNAME);
    String address = in.getStringExtra(KEY_MAPLOCATION);
    String longitude = in.getStringExtra(KEY_MAPLONG);
    String latitude = in.getStringExtra(KEY_MAPLAT);

    mapView = (TapControlledMapView) findViewById(R.id.mapview);
        mapView.setBuiltInZoomControls(true);
        mapView.setSatellite(false);
        // dismiss balloon upon single tap of MapView (iOS behavior) 
        mapView.setOnSingleTapListener(new OnSingleTapListener() {      
            public boolean onSingleTap(MotionEvent e) {
                itemizedOverlay.hideAllBalloons();
                return true;
            }
        });

        mapOverlays = mapView.getOverlays();

        // first overlay
        drawable = getResources().getDrawable(R.drawable.marker2);

        itemizedOverlay = new SimpleItemizedOverlay(drawable, mapView);
        // set iOS behavior attributes for overlay
        itemizedOverlay.setShowClose(false);
        itemizedOverlay.setShowDisclosure(true);
        itemizedOverlay.setSnapToCenter(false);
        double lat = Double.parseDouble(latitude);
        double lng = Double.parseDouble(longitude);

        GeoPoint point = new GeoPoint(
                 (int) (lat * 1E6), 
                 (int) (lng * 1E6));
        OverlayItem overlayItem = new OverlayItem(point, name, 
                address);
        itemizedOverlay.addOverlay(overlayItem);

        mapOverlays.add(itemizedOverlay);

        // second overlay

        if (savedInstanceState == null) {

            final MapController mc = mapView.getController();
            mc.animateTo(point);
            mc.setZoom(16);

        } else {

            // example restoring focused state of overlays
            int focused;
            focused = savedInstanceState.getInt("focused_1", -1);
            if (focused >= 0) {
                itemizedOverlay.setFocus(itemizedOverlay.getItem(focused));
            }

            }

 RadioGroup radGrp = (RadioGroup) findViewById(R.id.map_type);
 int checkedRadioButtonID = radGrp.getCheckedRadioButtonId();
 radGrp.setOnCheckedChangeListener(new RadioGroup.OnCheckedChangeListener() {
   public void onCheckedChanged(RadioGroup arg0, int id) {
     switch (id) {

     case R.id.maps:
         mapView.setSatellite(false);
       break;
     case R.id.satellite:
         mapView.setSatellite(true);
       break;

     default:
         mapView.setSatellite(false);
       break;
     }
   }
 });    }   

    @Override
    protected boolean isRouteDisplayed() {
        return false;
    }

    @Override
    protected void onSaveInstanceState(Bundle outState) {

        // example saving focused state of overlays
        if (itemizedOverlay.getFocus() != null) outState.putInt("focused_1", itemizedOverlay.getLastFocusedIndex());
        super.onSaveInstanceState(outState);

    }

  } 
```

![法线贴图引脚](../Images/ecb80c7fd790096521a3d213f598f7e8.png) ![毁容的地图别针](../Images/e2cf2e3327e36274161767bdf2c7f60c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:37:44.637

每次向其中添加项目时，您都会重复将 itemizedOverlay 添加到 mapview 叠加层。

移动线：

```
mapOverlays.add(itemizedOverlay); 
```

在它被创建之后，在你开始 Try Catch 语句之前，它应该可以正常工作。

# sql - 如何在查询期间在元素中添加 xml 命名空间？

> ID：12416958
> 
> 赞同：2
> 
> 时间：2012-09-14T01:20:07.777
> 
> 标签：sql, xml, sql-server-2008, tsql

与以下

```
DECLARE @t TABLE (Test nvarchar(50), Location_ID uniqueidentifier);
INSERT INTO @t (Test,Location_ID ) 
SELECT Test,Location_ID 
from
dbo.TEST;
DECLARE @xml XML
;WITH XMLNAMESPACES (
'typens:GPCodedValueDomain2' as type,
'http://www.esri.com/schemas/ArcGIS/10.0' as typens, 
'http://www.w3.org/TR/html4/' AS xs, 
'http://www.w3.org/2001/XMLSchema-instance' AS xsi )
SELECT @xml = 
    (
    SELECT 
    'typens:CodedValue' AS "@xsi:type", 
    TEST AS "Name", Location_ID  AS "Code"
    FROM @t 
    order by Location_ID
    FOR XML PATH
    ('CodedValue'), ROOT
    ('GPCodedValueDomain2'),TYPE
    )
SELECT @xml 
```

它输出

```
<GPCodedValueDomain2 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xs="http://www.w3.org/TR/html4/" xmlns:typens="http://www.esri.com/schemas/ArcGIS/10.0" xmlns:type="typens:GPCodedValueDomain2">
  <CodedValue xsi:type="typens:CodedValue">
    <Name>test update</Name>
    <Code>B59D3BEB-CBCE-E111-B5B0-002564D275D1</Code>
  </CodedValue>
  <CodedValue xsi:type="typens:CodedValue">
    <Name>test update</Name>
    <Code>B69D3BEB-CBCE-E111-B5B0-002564D275D1</Code>
  </CodedValue>
  <CodedValue xsi:type="typens:CodedValue">
    <Name>test update</Name>
    <Code>B79D3BEB-CBCE-E111-B5B0-002564D275D1</Code>
  </CodedValue>
</GPCodedValueDomain2> 
```

几个小时以来，我一直在尝试不同的命名空间定义迭代，但都失败了。我正在寻找的输出是：

```
<GPCodedValueDomain2 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xs="http://www.w3.org/TR/html4/" xmlns:typens="http://www.esri.com/schemas/ArcGIS/10.0" xmlns:type="typens:GPCodedValueDomain2">
  <CodedValue xsi:type="typens:CodedValue">
    <Name>test update</Name>
    <Code xsi:type="xs:string">B59D3BEB-CBCE-E111-B5B0-002564D275D1</Code>
  </CodedValue>
  <CodedValue xsi:type="typens:CodedValue">
    <Name>test update</Name>
    <Code xsi:type="xs:string">B69D3BEB-CBCE-E111-B5B0-002564D275D1</Code>
  </CodedValue>
  <CodedValue xsi:type="typens:CodedValue">
    <Name>test update</Name>
    <Code xsi:type="xs:string">B79D3BEB-CBCE-E111-B5B0-002564D275D1</Code>
  </CodedValue>
</GPCodedValueDomain2> 
```

关于如何实现这一点的任何想法？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T01:47:26.443

我不是 SQL Server 用户，但我想知道您是否真的提供了一个模式文档，该文档定义了`string`在 namespace 中命名的类型`http://www.w3.org/TR/html4/`。

`xs`将前缀绑定到名称为 HTML 4 规范的 URI 的命名空间绝对没有错。但是有几件事让我想知道你是否已经足够清楚地定义了你的问题。

*   HTML 4 规范没有定义名为`string`;的数据类型。除非您在此处未显示的模式文档中做一些非常不寻常的事情，否则`xs:string`不会表示已知类型。
*   您似乎将命名空间前缀绑定到命名`type`空间 URI `typens:GPCodedValueDomain2`。该名称空间前缀似乎没有在其他任何地方使用，因此尚不清楚它的用途是什么。该名称空间名称中使用的 URI 方案`typens`也是在查询中其他地方定义的名称空间前缀这一事实表明，您要么对名称空间和名称空间前缀感到困惑，要么您正在做一些极其微妙和狡猾的事情。在后一种情况下，您肯定不需要 Stack Overflow 的帮助。
*   您需要输出中的and元素的`xsi:type`属性。您的查询成功地将属性放在第一个，通过指定它。但是该元素没有类似的构造。为什么不？`CodedValue``Code``SELECT 'typens:CodedValue' AS "@xsi:type", ...``Code`

# macos - Applescript：更改用户密码？

> ID：12416959
> 
> 赞同：1
> 
> 时间：2012-09-14T01:20:19.880
> 
> 标签：macos, shell, applescript

试图通过applescript更改用户密码。

```
do shell script "dscl . -passwd /Users/username oldpass newpass" 
```

似乎不适用于山狮。我得到以下信息：

```
error "<dscl_cmd> DS Error: -14009 (eDSUnknownNodeName)" number 185 
```

找了好久，一无所获，现在在这里问。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T04:22:23.350

它仍然对我有用，但是您是否忘记`username`用实际用户名替换？

# c++ - VLC如何在桌面播放视频？

> ID：12416960
> 
> 赞同：8
> 
> 时间：2012-09-14T01:20:58.633
> 
> 标签：c++, winapi, desktop, vlc

不久前，我注意到 VLC 可以直接在桌面上播放视频。当我在学校这样做时，在 Windows XP 上，它在图标下方播放。当我在家里尝试时，在 Windows 7 上，它隐藏了图标。我不确定它是操作系统还是 VLC 的更新，但我有兴趣在图标下播放它。

注意到这一点后，我有了制作某种动画桌面的想法。没什么特别的，只是一些我自己使用的精选视频。我开始的想法是在我自己的窗口中播放视频（使用`mciSendString`），然后`PrintWindow`对每一帧执行一次，将其保存到文件中，并将桌面壁纸设置为文件。从那以后，我丢失了特定的代码，但它并不能很好地工作，而且不用说，性能会很糟糕。

回到它，我意识到无论如何肯定有比这更有效的方法，但我不能完全理解那是什么。

我尝试（现在全部在 Windows 7 中）将视频的父窗口设置为`GetDesktopWindow`，以最小化所有窗口，在任务栏上留下一个新窗口来播放视频，但能够通过单击 aero peek 按钮或点击来查看桌面赢+D。

然后我对桌面文件夹视图窗口的父窗口进行了同样的尝试。结果是相同尺寸的窗口播放视频，但这次无法访问桌面，也没有创建新窗口。就像它在大多数桌面上播放一样，但是由于播放窗口尺寸较小，小工具超出了顶部，并且右侧和底部的区域仍然显示。

VLC 做了什么来在桌面上播放它，看起来好像是动态壁纸？让它在图标下播放（如果你在 Windows 7 中添加，我想还有小工具）是否更难？该程序本身将在 Windows XP 上使用。我不确定 DirectShow 是否有任何帮助，但我愿意在除 MCI 之外的其他 Windows API 领域中使用它。如果它有所作为，我更喜欢 C++ 中的解决方案。.NET 也可以很好地工作，但可能需要一些额外的时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-14T03:15:08.930

VLC 将壁纸设置为特定颜色，然后使用 DirectDraw 在为桌面定义的覆盖表面内更新该颜色键。

我自己从来没有做过，但这里有几个地方可以寻找更多信息：

*   [叠加颜色键](http://msdn.microsoft.com/en-us/library/aa911350.aspx)
*   [IDirectDrawSurface](http://msdn.microsoft.com/en-us/subscriptions/ms785089%28v=vs.85%29.aspx)
*   [VLC 源代码](http://www.videolan.org/vlc/download-sources.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-22T20:54:26.417

您可以只使用桌面手柄并绘制自己的组件或数据

试试这个，

```
#include <stdafx.h>
#include <windows.h>
#include <objidl.h>
#include <gdiplus.h>
using namespace Gdiplus;
#pragma comment (lib,"Gdiplus.lib")

VOID OnPaint(HDC hdc)
{
   Graphics graphics(hdc);
   Pen      pen(Color(255, 0, 0, 255));
   graphics.DrawLine(&pen, 0, 0, 200, 100);
}

LRESULT CALLBACK WndProc(HWND, UINT, WPARAM, LPARAM);

INT WINAPI WinMain(HINSTANCE hInstance, HINSTANCE, PSTR, INT iCmdShow)
{
   HWND                hWnd;
   MSG                 msg;
   WNDCLASS            wndClass;
   GdiplusStartupInput gdiplusStartupInput;
   ULONG_PTR           gdiplusToken;

   // Initialize GDI+.
   GdiplusStartup(&gdiplusToken, &gdiplusStartupInput, NULL);

   wndClass.style          = CS_HREDRAW | CS_VREDRAW;
   wndClass.lpfnWndProc    = WndProc;
   wndClass.cbClsExtra     = 0;
   wndClass.cbWndExtra     = 0;
   wndClass.hInstance      = hInstance;
   wndClass.hIcon          = LoadIcon(NULL, IDI_APPLICATION);
   wndClass.hCursor        = LoadCursor(NULL, IDC_ARROW);
   wndClass.hbrBackground  = (HBRUSH)GetStockObject(WHITE_BRUSH);
   wndClass.lpszMenuName   = NULL;
   wndClass.lpszClassName  = TEXT("GettingStarted");

   RegisterClass(&wndClass);

   hWnd = GetDesktopWindow();

   ShowWindow(hWnd, iCmdShow);
   UpdateWindow(hWnd);

   while(GetMessage(&msg, NULL, 0, 0))
   {
      TranslateMessage(&msg);
      DispatchMessage(&msg);
   }

   GdiplusShutdown(gdiplusToken);
   return msg.wParam;
}  // WinMain

LRESULT CALLBACK WndProc(HWND hWnd, UINT message, 
   WPARAM wParam, LPARAM lParam)
{
   HDC          hdc;
   PAINTSTRUCT  ps;

   switch(message)
   {
   case WM_PAINT:
      hdc = BeginPaint(hWnd, &ps);
      OnPaint(hdc);
      EndPaint(hWnd, &ps);
      return 0;
   case WM_DESTROY:
      PostQuitMessage(0);
      return 0;
   default:
      return DefWindowProc(hWnd, message, wParam, lParam);
   }
} // WndProc 
```

# html - Jquery Sortable + 一些项目

> ID：12416961
> 
> 赞同：1
> 
> 时间：2012-09-14T01:21:07.867
> 
> 标签：html, jquery-ui

我正在使用 ul 可排序的 jquery 并且可以移动下面的 8 li 项目：

![在此处输入图像描述](../Images/ad20cd8c06841fb410ca114a99aa9e51.png)

我想限制这一点，因此只能对具有 img 的 li 项目进行排序（在前 3 个项目之上）但是我发现可能会发生以下情况（例如：可以在非图像 li 之间移动 3 个图像）：

![在此处输入图像描述](../Images/d7dfedcbab22b86e1c7b53c3b93a21b1.png)

我正在使用以下 HTML 结构（与上面的图片相关，类不可排序）：

```
<ul id="photoPreviews>
<li class="unsortable">elements</li>
<li class="unsortable">elements</li>
<li>elements</li>
<li class="unsortable">elements</li>
<li>elements</li>
<li class="unsortable">elements</li>
<li>elements</li>
<li class="unsortable">elements</li>
</ul> 
```

当前使用取消的 JQUERY：

```
$('ul#photoPreviews').sortable({
  cancel: 'li.unsortable'    
}); 
```

所有 li 元素都以 unsortable 类（连接到 .sortable() cancel）开始，并且当将图像添加到 li 时会删除此类。而且我发现我无法使用 unsortable 类对这些项目进行排序。

但是，我仍然可以在无图像项目之间移动带有图像的 li 项目。

问题：我怎样才能限制它，以便只有带有图像的 li 项目可以在彼此之间移动 - 所以在这个例子中，前 3 个可以互相改变位置？有没有办法对可排序的项目进行分组？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T01:32:57.677

“项目”选项允许您更改哪些元素是可排序的[http://jqueryui.com/demos/sortable/#option-items](http://jqueryui.com/demos/sortable/#option-items)

示例：http: [//jsfiddle.net/cjc343/55rzM/](http://jsfiddle.net/cjc343/55rzM/)

# firefox - Chrome/Firefox 上的盒子模型大小

> ID：12416963
> 
> 赞同：1
> 
> 时间：2012-09-14T01:22:00.520
> 
> 标签：firefox, google-chrome, css

我有以下代码，它显示了我在 Chrome 中想要的内容，但在 Firefox 中，不遵守 div`width`上的属性。`panel`

[http://codepen.io/anon/pen/Ltsaj](http://codepen.io/anon/pen/Ltsaj)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T01:31:28.887

所以目前 Firefox 存在一些问题。首先，您必须使用旧的措辞（即`display: -moz-flexbox;`）。其次，Firefox 有一个已知错误与将宽度指定为百分比有关：[https ://bugzilla.mozilla.org/show_bug.cgi?id=529761](https://bugzilla.mozilla.org/show_bug.cgi?id=529761)

另一种解决方案可能是考虑使用`display: inline-block;`来实现您的目标。这是一个例子：http: [//jsfiddle.net/joshnh/QbZrH/](http://jsfiddle.net/joshnh/QbZrH/)

# android - Android 中带有 CursorAdapter 的 ORMLite

> ID：12416964
> 
> 赞同：13
> 
> 时间：2012-09-14T01:22:07.387
> 
> 标签：android, ormlite, android-cursoradapter

我正在修改我的 Android 应用程序以使用 ORMLite，它目前使用许多 CursorAdapter，我非常想保留它们以尽量减少编码。

我不是 100% 确定，但似乎当 ORMLite 在数据库中创建一个 id 字段时，它总是使用`id`，而 CursorAdapter 需要`_id`.

可以使用如下查询来解决这个问题：

```
select id as _id ...... 
```

但是该`Dao.queryRaw()`方法返回一个列表，而不是游标，所以我这样做的方法是打开另一个 SQLiteOpenHelper 数据库连接并使用`rawQuery()`.

这行得通，但是有没有更好的方法呢？拥有两个独立的数据库连接似乎有点过头了，而且可能会在以后存储麻烦。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-14T13:17:39.973

您的评论表明您已经回答了您的问题。您当然可以使用[ORMLite](http://ormlite.com/)创建一个名为“_id”的列：

```
@DatabaseField(generatedId = true)
private int _id; 
```

或者

```
@DatabaseField(generatedId = true, columnName = "_id")
private int id; 
```

如果您正在使用`Cursor`s ，那么您可能需要查看类中的`last()`和`moveAbsolute(...)`方法`DatabaseResults`。此外，[`AndroidDatabaseResults`](http://ormlite.com/javadoc/ormlite-android/com/j256/ormlite/android/AndroidDatabaseResults.html)（您可以转换为）还有一个`getRawCursor()`方法，该方法返回基础`Cursor`对象并具有附加的`getCount()`和`getPosition()`方法。

以下是有关 ORMLite 和`Cursor`s 的更多信息：

> [在 CursorAdapter 中使用带有 ORMLite 的 Android 游标](https://stackoverflow.com/questions/7159816/android-cursor-with-ormlite)

您可以`Cursor`使用以下内容访问：

```
// build your query
QueryBuilder<Foo, String> qb = fooDao.queryBuilder();
qb.where()...;
// when you are done, prepare your query and build an iterator
CloseableIterator<Foo> iterator = dao.iterator(qb.prepare());
try {
   // get the raw results which can be cast under Android
   AndroidDatabaseResults results =
       (AndroidDatabaseResults)iterator.getRawResults();
   Cursor cursor = results.getRawCursor();
   ...
} finally {
   iterator.closeQuietly();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-14T13:26:47.347

事实证明，毕竟我确实需要一个带有 ORMLite 的原始 SQL 查询，因为我需要进行左连接（即不是因为必须在查询中重命名 id 列，根据上面的 Gray 的回答，这不是必需的）

我这样做的方式如下：

```
public class DatabaseHelper extends OrmLiteSqliteOpenHelper{
   public void myRawQueryMethod() {
        SQLiteDatabase database = this.getReadableDatabase();
        String SqlQuery = "Write raw SQL query here"; 
        Cursor cursor = database.rawQuery(SqlQuery, null);
    }
} 
```

谢谢你的建议

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-19T13:15:14.877

用另一个将您的光标包装`"_id"`为您的真实主键列的别名的光标。例子：

```
cursor = new CursorWrapper(cursor) {
                @Override
                public int getColumnIndexOrThrow(String columnName) throws IllegalArgumentException {
                    if ("_id".equals(columnName)) columnName = "id";
                    return super.getColumnIndexOrThrow(columnName);
                }
            }; 
```

# objective-c - 可变集合有文字语法吗？

> ID：12416967
> 
> 赞同：56
> 
> 时间：2012-09-14T01:22:40.880
> 
> 标签：objective-c, cocoa, nsmutablearray, nsmutabledictionary, objective-c-literals

我知道我可以创建一个`NSArray`with`@[@"foo", @"bar"]`或一个`NSDictionary`with `@{@0 : @"foo", @1 : @"bar"}`。

是否有用于创建 an`NSMutableArray`或 an的文字语法`NSMutableDictionary`？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2012-09-14T01:39:19.913

没有内置的方式，但我通常是`mutableCopy`这样使用的：

```
NSMutableArray *array = [@[ @"1", @"2", @"3" ] mutableCopy]; 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-09-14T01:36:16.187

不，就像没有用于创建`NSMutableString`两者的语法一样。可变对象并不特别适合文字值。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-09-14T01:39:20.370

> 但是，是否有用于创建 NSMutableArray 或 NSMutableDictionary 的文字语法？

没有。最好的选择：

```
[@[ @"foo", @"bar"] mutableCopy] 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-08-03T05:37:49.560

是的。但不完全是。看看这个;

`NSMutableArray *list = [@[] mutableCopy];`

这将创建一个非可变数组`@[]`并调用`mutableCopy`返回一个`NSMutableArray *`. 代替`@[]`，您可以提供任何数组文字。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-29T20:42:24.627

如果您有数组和字典的嵌套文字，您可以通过`NSJSONSerialization`. 例如：

```
NSArray* array = @[ @{ @"call" : @{ @"devices" : @[ @"$(devices)" ] } } ];
NSData* data   = [NSJSONSerialization dataWithJSONObject:array 
                                                 options:0 
                                                   error:nil];

NSJSONReadingOptions options = NSJSONReadingMutableContainers | 
                               NSJSONReadingMutableLeaves;
NSMutableArray* mutableArray = [NSJSONSerialization JSONObjectWithData:data 
                                                               options:options
                                                                 error:nil]; 
```

有点绕道，但至少不用自己写代码。好消息是`NSJSONSerialization`速度非常快。

# ios - 在 2 个子视图控制器之间来回传递数据

> ID：12416971
> 
> 赞同：2
> 
> 时间：2012-09-14T01:23:32.877
> 
> 标签：ios, ipad, ios5

想看看是否有人可以就如何解决我目前在**iPad**应用程序中面临的这个问题提供一些建议/指示。这是我在下面描述的图形的链接 [http://www.yogile.com/dsruyzk7/41m/share/?vt=QANtu4j](http://www.yogile.com/dsruyzk7/41m/share/?vt=QANtu4j)

基本上我有一个包含 2 个子视图控制器的 parentViewController。Child 1 有一个 UITableView，而 Child 2 有一个自定义 UIView。我能够从 didSelectRowAtIndexPath 将 Child 1 上的 UITableview 中的信息加载到 Child 2 上的自定义 UIView 中。数据显示在 Child 2 上后，我进行了一些处理。处理完成后，我需要更新 Child 1 上的 UITableView，以便新/更新的数据显示在 UITableView 上。我尝试在 Child 1 上创建一个代表，但没有工作，也许我设置了错误。因此，任何帮助建议将不胜感激。

谢谢

# .h 在子 2 视图控制器上

```
@class Child2ViewController;

@protocol child2Delegate <NSObject>
- (void)refreshTable:(Child2ViewController*)controller passedDict:(NSDictionary *)dict;

@interface Child2ViewController:UIViewController<UITableViewDataSource, UITableViewDelegate> {
    UITableView *myTableView;
    id<child2Delegate> delegate;
    Child1ViewController *child1VC;
}

@property (nonatomic, weak) id<child2Delegate> delegate;
…
…

@end 
```

# .m 在子 2 视图控制器上

```
@synthesize delegate;
…
..
..
#after all the processing is done we are ready to refresh the view
#updatedDictForTableView is basically a NSDictionary and has the updated data needed
#for the UITableview on child1VC.

-(void)processData {
    child1VC.delegate = self
    NSLog(@"Dump the updated Data : %@", updatedDictForTableView);
    [delegate refreshTable:self passedDict:updatedDictForTableView;
} 
```

# Child1 ViewController 中的 .h

```
@interface Child1ViewController : UIViewController <child2Delegate> {
    ….
    ….
    ..
} 
```

# Child1 ViewController 中的 .m

```
- (void)refreshTable:(Child2ViewController*)controller passedDict:(NSDictionary *)dict {
    NSLog(@"dump dict %@", dict);
    [myTableView reloadData];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T20:20:08.170

您可以在没有委托的情况下执行此操作，使用 NSNotificationcenter 发送通知，其中包含您在 nsdictionary: exple 中的值：

```
 // in child1 ( in viewDiDLoad function )
 [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(FunctionToReloadData:) name:@"ProcessDone" object:nil];

  // remove the listnerin child1 ( in viDidUnload )
[[NSNotificationCenter defaultCenter] removeObserver:self forKeyPath:@"ProcessDone"];

 //in child2 ( in the end of your processData function )
 [[NSNotificationCenter defaultCenter] postNotificationName:@"ProcessDone" object:nil userInfo:updatedDictForTableView ];

 //in child1
 -(void) FunctionToReloadData:(NSNotification *)notification
 {
    // get the sended dictionary
    NSDictionary *tmpDic = [notification userInfo];
     .
     .
     [tableView reloadData];

 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T01:58:07.407

您可以通过将父表视图属性添加到子类来做到这一点（这里将被视为详细视图或 DetailViewController）

```
@interface DetailViewController : UIViewController {
...
UITableView *parentTableView;
...
}
@property (nonatomic, retain) UITableView* parentTableView; 
```

然后在子 2 上显示某些内容之前，在子 1 中的某个位置设置该属性，可能就像在 viewWillAppear 中一样：

```
- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];
    self.detailViewController.parentTableView = self.tableView;
} 
```

然后，您就可以在子 2 表视图中重新加载子 1 表视图...

# math - 消除样本数据中的尖峰

> ID：12416974
> 
> 赞同：0
> 
> 时间：2012-09-14T01:24:17.590
> 
> 标签：math, signal-processing, discrete-mathematics, sage

我怎样才能摆脱离散数据集中的火花数据，但以“更顺畅”的方式？

举个例子

![在此处输入图像描述](../Images/1434d0b404c260c9327be53a34a55e6d.png)

有两个火花，在 20000，但下一个在 600 也被认为是火花。

我已经设法将非常高的值归零，通过

```
a = 2
b = 5
beta_dist = RealDistribution('beta', [a, b])
f(x) = x / 19968
normalized_insertions = [f(i) for i in insertions]

insertions_pairs = [(i, beta_dist.distribution_function(i)) for i in normalized_insertions]
plot_b = beta_dist.plot()

show(list_plot(insertions_pairs)+plot_b) 
```

不知道如何处理较低的。最大值应该达到 100，也许 beta 分布的参数需要更多的调整？

目前，它看起来像这样： ![在此处输入图像描述](../Images/6de93e386ddd1af0bd3c41e963958804.png)

如果可能，请使用鼠尾草作为解释的参考。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-15T05:51:52.410

您可以使用[中值过滤器](http://en.wikipedia.org/wiki/Median_filter)，也许是 3 或 5 个点。这将删除上面数据中的孤立异常值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T10:37:08.930

你也许应该看看卡尔曼滤波器。这将确定您的数据的偏差并平滑高斯均值。因此，20k 的数字几乎没有任何影响，而 600 的数字会产生更大的影响，它们仍然会被数据的一致性所取代。如果你喜欢数学：
[http](http://www.cs.berkeley.edu/~pabbeel/cs287-fa11/slides/Smoother_KalmanSmoother--DRAFT.pdf)
://www.cs.berkeley.edu/~pabbeel/cs287-fa11/slides/Smoother_KalmanSmoother--DRAFT.pdf否则可能：http:
[//interactive-matter.eu/blog/2009/12 /18/filtering-sensor-data-with-a-kalman-filter/](http://interactive-matter.eu/blog/2009/12/18/filtering-sensor-data-with-a-kalman-filter/)

# scripting - Netstat 批处理程序

> ID：12416975
> 
> 赞同：0
> 
> 时间：2012-09-14T01:24:20.520
> 
> 标签：scripting, batch-file

运行此批处理脚本时，结果始终相同。我相信我在语法中遗漏了一些东西。我错过了什么？

```
@echo off
netstat -an | find /C "LIST" > tmpFile
set test=<tmpFile
del tmpFile
set max=6
IF !%test! GTR !max! echo Greater than X
IF !%test! LEQ !max! echo Less than X
PAUSE
:EOF 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T02:24:09.020

```
@echo off
setlocal EnableDelayedExpansion

netstat -an | find /C "LIST" > tmpFile
set /P test=<tmpFile
del tmpFile
set max=20
IF !test! GTR !max! echo Greater than X
IF !test! LEQ !max! echo Less than X
PAUSE
:EOF 
```

你需要：

1.  删除`%`变量`test`
2.  `/P`在`set`命令中为变量添加键`test`
3.  添加`setlocal EnableDelayedExpansion`. 另请参阅[批处理文件：无法在循环内回显变量](https://stackoverflow.com/questions/11571926/batch-file-fails-to-echo-variable-inside-loop/11572315#11572315)

# php - WP-Ecommerce 在产品页面上显示类别名称

> ID：12416977
> 
> 赞同：2
> 
> 时间：2012-09-14T01:24:25.327
> 
> 标签：php, wordpress, categories

我正在使用 WP-Ecommerce 并希望在单个产品页面上显示产品的类别。我四处搜索，发现了一些几乎可以工作的东西（由 Rohan 在这个网站上发布）：

```
function cdl_get_cat() {
global $wp_query, $wpsc_query;
$query_data = Array();
$cdl_post_id = wpsc_the_product_id();

$categories = wp_get_object_terms( $cdl_post_id , 'wpsc_product_category' );
//if product is associated w more than one category
if(count($categories) > 1 && isset($wpsc_query->query_vars['wpsc_product_category']))
$query_data['category'] = $wpsc_query->query_vars['wpsc_product_category'];
elseif(count($categories) > 0)
$query_data['category'] = $categories[0]->slug;

return $query_data['category'];
}
echo cdl_get_cat(); 
```

虽然此代码可以满足我的需要，但它会将类别名称显示为 slug（即眼影而不是眼影）。我对 PHP 不是很流利，所以我不确定需要更改什么才能显示名称而不是 slug。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T11:33:52.743

谢谢，发现这对于将类添加到它所在类别的产品很有用：

在产品循环之前：

```
 <?php function cdl_get_cat() {
    global $wp_query, $wpsc_query;
    $query_data = Array();
    $cdl_post_id = wpsc_the_product_id();

    $categories = wp_get_object_terms( $cdl_post_id , 'wpsc_product_category' );

    $count = count($categories);

        for ($i = 0; $i < ($count); $i++) {
            $query_data['category'] = $categories[$i]->name;
            echo $query_data['category'];
            if ($i < ($count - 1))
            echo ", ";
        }

    }  
    cdl_get_cat();
    ?> 
```

然后在循环中：

```
<li class="product_grid_item product_view_<?php echo wpsc_the_product_id(); ?> <?php cdl_get_cat(); ?>"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-22T15:58:40.370

我整天都在为此苦苦挣扎，而且我也不擅长 php ......但我已经通过删除这个位（我不明白......）让它工作：

```
//if product is associated w more than one category
if(count($categories) > 1 && isset($wpsc_query->query_vars['wpsc_product_category']))
$query_data['category'] = $wpsc_query->query_vars['wpsc_product_category'];
elseif(count($categories) > 0) 
```

然后在这里将“slug”更改为“name”：

```
$query_data['category'] = $categories[0]->slug; 
```

所以你只需要这个：

```
<?php function cdl_get_cat() {
global $wp_query, $wpsc_query;
$query_data = Array();
$cdl_post_id = wpsc_the_product_id();

$categories = wp_get_object_terms( $cdl_post_id , 'wpsc_product_category' );
$query_data['category'] = $categories[0]->name;

return $query_data['category'];

}
echo cdl_get_cat();
?> 
```

如果您对一种产品有多个类别，则更改 [0] 将为您提供不同的类别，因为我认为 $categories 是一个包含所有相关类别的数组。如果需要，您应该能够遍历所有这些。我应该看看如何做到这一点！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T16:31:23.237

哇，我想我已经找到了，或者找到了更好的地方……这应该得到与显示的产品相关的所有类别，然后循环出一个列表，用逗号分隔。

```
<?php function cdl_get_cat() {
global $wp_query, $wpsc_query;
$query_data = Array();
$cdl_post_id = wpsc_the_product_id();

$categories = wp_get_object_terms( $cdl_post_id , 'wpsc_product_category' );

$count = count($categories);

    for ($i = 0; $i < ($count); $i++) {
        $query_data['category'] = $categories[$i]->name;
        echo $query_data['category'];
        if ($i < ($count - 1))
        echo ", ";
    }

}  
cdl_get_cat();
?> 
```

# string - 将 System::String^ 与 std::string 进行比较

> ID：12416985
> 
> 赞同：0
> 
> 时间：2012-09-14T01:25:30.410
> 
> 标签：string, c++-cli, string-comparison, stdstring

我有一个`Generic::List(String^)^ myList`和一些`std::string & myValue`值，我需要检查这些值是否都包含在列表中。（我不想在列表中添加值）。

我该怎么做`myList->Contains(myValue)`才能确保我正在比较字符串的内容？

我知道我可以使用 InteropServices 来编组列表中的每个元素。

如果有帮助，我可以将 Generic::List 转换为 cli::array！

谢谢梅兰妮

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T02:18:41.837

从`List<T>::Contains(T)`文档（C#文档，但这不会影响任何东西）：

*此方法通过使用默认相等比较器来确定相等性，该比较器由对象对 T（列表中的值的类型）的 IEquatable.Equals 方法的实现定义。*

因为`String::Equals(String^)`比较字符串的内容，所以只需将 转换`std::string`为`System::String^`. 你可以用 a 做到这一点，`marshal_as`你应该很好。

# c++ - SQLite DB（带有 WAL）在准备“选择”语句时被锁定 - 为什么？

> ID：12416988
> 
> 赞同：8
> 
> 时间：2012-09-14T01:25:33.020
> 
> 标签：c++, sqlite

我看到我的读取被 WAL 模式下的数据库写入阻止了 - 我不知道为什么。

我的设置：

*   SQLite3 数据库，journal_mode=WAL，同步=NORMAL
*   多个 C++ 进程（确切地说是 3 个）使用数据库 - 这些进程中的任何方法打开和关闭它们自己的非共享连接`sqlite3_open_v2`。
*   插入数据的方法以`SQLITE_OPEN_READWRITE`模式打开数据库
*   从数据库读取的方法（即只执行选择语句）以`SQLITE_OPEN_READONLY`模式打开数据库

在 WAL 模式下，我相信在发生写入时应该可以有并发读取器。

然而，当我准备使用 select 语句时，我看到“数据库已锁定”`sqlite3_prepare_v2`

我可能做错了什么导致读者被阻止？我是否误解了“阅读”实际上是什么？

任何提示表示赞赏，

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T10:08:54.213

在每个 sqlite3_step 之后检查您是否有 sqlite3_reset，因为这是导致数据库被锁定错误的一种情况。在使用 sqlite3_prepare 准备语句并使用 sqlite3_step 执行它之后，您需要始终使用 sqlite3_reset 重置它。

> sqlite3_reset(S) 接口将准备好的语句 S 重置回其程序的开头。

希望这能解决你的问题......!!!

# php - 从数组中复制数据

> ID：12416993
> 
> 赞同：-3
> 
> 时间：2012-09-14T01:25:56.763
> 
> 标签：php, mysql, html

代码是：

```
<?php

// my query

if (isset($_GET['ssiptype']))
{
    if (($_GET['ssiptype']) == 'gma'){
        $query = "SELECT location, year, serviceArea, noOfBenificiaries, stat, fundingSrc, projCost 
            FROM swipdd
            WHERE fundingSrc LIKE 'GMA-Rice%' AND ssiptype = 'SWIP'" ;
    }
    elseif (($_GET['ssiptype']) == 'am'){
        $query = "SELECT location, year, serviceArea, noOfBenificiaries, stat, fundingSrc, projCost 
            FROM swipdd
            WHERE fundingSrc LIKE 'AM-Rice%' AND ssiptype = 'SWIP'" ;
    }
    elseif (($_GET['ssiptype']) == 'hvcccred'){
        $query = "SELECT location, year, serviceArea, noOfBenificiaries, stat, fundingSrc, projCost 
            FROM swipdd
            WHERE fundingSrc LIKE 'HVCC RED%' AND ssiptype = 'SWIP'" ;
    }
    elseif (($_GET['ssiptype']) == 'hvcc'){
        $query = "SELECT location, year, serviceArea, noOfBenificiaries, stat, fundingSrc, projCost 
            FROM swipdd
            WHERE fundingSrc LIKE 'HVCC%' AND ssiptype = 'SWIP'" ;
    }
    else{}
}
// output

if (isset($query))
{
  $result = mysql_query($query) or die(mysql_error()); 

  echo "<table border='1' cellpadding='3'>";
  echo "<tr> 
            <td bgcolor=\"#DFE8EC\">LOCATION</td>
            <td bgcolor=\"#DFE8EC\">YEAR</td>
            <td bgcolor=\"#DFE8EC\">STATUS</td>
        </tr>";
  while($row = mysql_fetch_array( $result )) {

  $final_result = array_unique($row);

    echo "<tr>";
    echo '<td>' . $row['location'] . '</td>';
    echo '<td>' . $row['year'] . '</td>';
    echo '<td>' . $row['stat'] . '</td>';
    echo "</tr>"; 
  } 
  echo "</table>";
}
?> 
```

我想要的输出如下：

```
//dummy data
LOCATION    YEAR   STATUS
---------------------------
park         1999   ok
----------------------------
sea          2000   fine
---------------------------- 
```

我得到这个输出：

```
LOCATION    YEAR   STATUS
----------------------------
park         1999   ok
----------------------------
sea          2000   fine
----------------------------
park         1999   ok
----------------------------
sea          2000   fine
----------------------------
park         1999   ok
----------------------------
sea          2000   fine
---------------------------- 
```

它重复了两次。我的代码有什么问题？请，任何帮助将不胜感激。

> 非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T01:33:13.103

使用`mysql_fetch_assoc`，不使用`mysql_fetch_array`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T03:00:58.927

尝试向数据库询问不同的数据，而不是让 PHP 过滤它。强调*不同*的词（这是你对谷歌的暗示......）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-14T22:22:59.453

1.  只选择您需要的列。
2.  为了不获得多个整体，您需要某种额外的限定符。我假设您希望显示最近的一年，所以我们可以做的是使用 GROUP BY 选择不同的位置，并使用 ORDER BY 来显示最近的一年
3.  代码很丑...当您可以替换更改的部分时，您会不断重复相同的 SQL。

所以把它们放在一起

```
<?php 

$fundingSrcs = array(
  'gma' => 'GMA-Rice%',
  /* repeat for your other options */
);
$sql = "SELECT location, year, stat 
       FROM swipdd
       WHERE fundingSrc LIKE %s AND ssiptype = 'SWIP'
       ORDER BY year DESC
       GROUP BY location";

$result = false; // initialize as a default of false

if(isset($_GET['ssiptype']) {
   $ssitype = $_GET['ssiptype'];
   if(isset($fundingSrcs[$ssitype]) {

      // substitute the db quoted string for the %s
      $query = sprintf($sql, mysql_real_escape_string($fundingSrcs[$ssitype]));
      $result = mysql_query($query) or die(mysql_error());
   }
}
?>

<?php if($result && mysql_num_rows($result)): ?>
  <table border='1' cellpadding='3'>
    <thead>
      <tr>
        <th bgcolor="#DFE8EC">LOCATION</th>
        <th bgcolor="#DFE8EC">YEAR</th>
        <th bgcolor="#DFE8EC">STATUS</th>
      </tr>
    </thead>
    <tbody>
    <?php while ($row = mysql_fetch_array($result)): ?>
      <tr>
        <td><?php echo $row['location'] ?></td>
        <td><?php echo $row['year'] ?></td>
        <td><?php echo $row['stat'] ?></td>
      </tr>
    <?php endwhile; ?>
    </tbody>
  </table>
<?php else if($err = mysql_error()): ?>
  <p>There was an error executing this request.</p>
<?php else: ?>
  <p>No matching entries found</p>
<?php endif; ?> 
```

# php - 事件列表的 PHP PDO 查询

> ID：12416998
> 
> 赞同：0
> 
> 时间：2012-09-14T01:26:52.107
> 
> 标签：php, mysql, list, pdo, fetch

我正在做一个活动项目，我想展示我的用户在他们的个人资料页面中举办的活动，但我一直坚持列出这些活动。

其他事情都运作良好。

以下是代码：

```
if(isset($_GET["id"])) {
$id = intval($_GET["id"]);
if(!empty($id)) {

try {
$pq = "SELECT * FROM `users` WHERE `id` = :id";
$pq_check = $db->prepare($pq);
$pq_check->bindParam(':id', $id, PDO::PARAM_INT);
$pq_check->execute();
$ac = $db->query("SELECT FOUND_ROWS()")->fetchColumn();
} 
catch(PDOException $e) { $log->logError($e." - ".basename(__FILE__));
}

// i'm fetching the user info and showing them name age gender exc. , no problem with here

echo "Events That User Hosted :\n";

// here is the place i have problem

$eq = "SELECT * FROM `events` WHERE `host_id` = :id";
$eq_check = $db->prepare($eq);
$eq_check->bindParam(':id', $id, PDO::PARAM_INT);
$eq_check->execute();
$foo = $db->query("SELECT FOUND_ROWS()")->fetchColumn();
if(!empty($foo)) {
$_loader = true;
$fetch = $eq_check->fetch (PDO::FETCH_ASSOC);
}

while($fetch = $eq_check->fetch (PDO::FETCH_ASSOC) ){ 
if ($fetch == NULL ) {
break;
}

$event_id = $fetch['event_id'];
$event_name = $fetch['event_name'];
$link = "https://www.mywebsite.com/e/$event_id";

echo "<a target=\"_blank\" href=\"$link\"><li>$event_name</li></a>";

} 

}
} 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T01:34:15.990

一个问题是您获取结果集的第一行，然后将其丢弃：

```
if(!empty($foo)) {
  $_loader = true;
  $fetch = $eq_check->fetch (PDO::FETCH_ASSOC);
}

/* above you have fetched the first row but that value gets overwritten
   directly after that: */

while ($fetch = $eq_check->fetch (PDO::FETCH_ASSOC) ) { 

/* $fetch now contains the second row of the result set, if it exists... */ 
```

**编辑：**我会清理代码，添加错误处理，看看会发生什么：

```
try
{
  $eq = "SELECT * FROM `events` WHERE `host_id` = :id";
  $eq_check = $db->prepare($eq);
  $eq_check->bindParam(':id', $id, PDO::PARAM_INT);
  $eq_check->execute();

  while($fetch = $eq_check->fetch (PDO::FETCH_ASSOC) )
  { 
    $_loader = true;

    $event_id = $fetch['event_id'];
    $event_name = $fetch['event_name'];
    $link = "https://www.mywebsite.com/e/$event_id";

    echo "<a target=\"_blank\" href=\"$link\"><li>$event_name</li></a>";
  }
} 
catch(PDOException $e)
{
  $log->logError($e." - ".basename(__FILE__));
} 
```

# c# - nHibernate 中的子类表映射

> ID：12416999
> 
> 赞同：1
> 
> 时间：2012-09-14T01:27:11.010
> 
> 标签：c#, nhibernate, nhibernate-mapping, subclass

首先，对文字墙感到抱歉。

我有以下架构。请注意， 中`User_Contact`可能包含空值`ContactID`。

![架构](../Images/b873d35ab2fb40c7be1c663ce0700c8f.png)

然后在类级别以以下方式实现

```
public abstract class User : EntityBase<Guid>, IAggregateRoot
{
    public User()
    {

    }

    public virtual string FirstName { get; set; }
    public virtual string LastName { get; set; }

    protected abstract override void Validate();
}

public class SiteUser : User
{
    public SiteUser() { }

    public virtual Guid ApplicationId { get; set; }
    public virtual string UserName { get; set; }
    public virtual string LoweredUserName { get; set; }
    public virtual string MobileAlias { get; set; }
    public virtual bool IsAnonymous { get; set; }
    public virtual DateTime LastActivityDate { get; set; }

    protected override void Validate()
    { 
        if (this.ApplicationId == Guid.Empty)
            base.AddBrokenRule(UserBusinessRules.ApplicationIdRequired);

        if (this.UserName.IsNullOrEmpty())
            base.AddBrokenRule(UserBusinessRules.UserNameRequired);

        if (this.LoweredUserName.IsNullOrEmpty())
            base.AddBrokenRule(UserBusinessRules.LoweredUserNameRequired);

        if (this.LastActivityDate == DateTime.MinValue)
            base.AddBrokenRule(UserBusinessRules.LastActivityDateRequired);

    }
}

public class SiteContact : SiteUser
{

    public SiteContact() 
    {
    }

    public virtual int ExternalID { get; set; }
    //All the rest...

    protected override void Validate()
    { 
        //validate
    }
} 
```

所以基本上这个想法是每个单曲`SiteContact`都是 a`SiteUser`但不是每个`SiteUser`都是 a `SiteContact`。

我完全陷入困境的是如何在 nHibernate 中映射这种关系。我似乎能够检索 a`SiteUser`但无法检索 a `SiteContact`，原因很清楚。我实现的映射导致以下 sql 被执行。

```
SELECT this_.userid             AS UserId18_0_, 
       this_.firstname          AS FirstName18_0_, 
       this_.lastname           AS LastName18_0_, 
       //Blah blah.....
FROM   user_contact this_ 
       INNER JOIN contact this_1_ 
               ON this_.userid = this_1_.contactid  //Here is the error this should be ContactID = ContactID
       INNER JOIN aspnet_users this_2_ 
               ON this_.userid = this_2_.userid 
WHERE  ( CASE 
           WHEN this_.contactid IS NOT NULL THEN 1 
           ELSE 0 
         END ) = '1' 
```

但是我一辈子都无法在我的 hbm 映射文件中解决这个问题。这是为简单起见省略了一些字段的文件。

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="MyProject.Namespaces.Model.Entities" assembly="MyProject.Namespaces.Model">

  <class name="User" table="User_Contact" lazy="true" abstract="true">

    <id name="ID" column="UserId" type="guid">
      <generator class="guid" />
    </id>

    <discriminator column="ContactID" formula="(CASE WHEN ContactID IS NOT NULL THEN 1 ELSE 0 END)" />

    <property name="FirstName">
      <column name="FirstName" sql-type="nvarchar(500)" not-null="true" />
    </property>

    <property name="LastName">
      <column name="LastName" sql-type="nvarchar(500)" not-null="true" />
    </property>

    <subclass name="SiteContact" discriminator-value="1">
      <join table="Contact">
        <key column="ContactID" /> //I assume the problem is here. I have tried adding foreign-key="ContactID" to no success

        <property name="ExternalID" insert="false" update="false">
          <column name="ExternalID" sql-type="int" not-null="true" />
        </property>

        //The rest of the mapped columns

      </join>
      <join table="aspnet_Users">
        <key column="UserId" />

        <property name="ApplicationId">
          <column name="ApplicationId" sql-type="guid" not-null="true" />
        </property>

        <property name="UserName">
          <column name="UserName" sql-type="nvarchar(256)" not-null="true" />
        </property>

        <property name="LoweredUserName">
          <column name="LoweredUserName" sql-type="nvarchar(256)" not-null="true" />
        </property>

        <property name="MobileAlias">
          <column name="MobileAlias" sql-type="nvarchar(16)" not-null="false" />
        </property>

        <property name="IsAnonymous">
          <column name="IsAnonymous" sql-type="bit" not-null="true" />
        </property>

        <property name="LastActivityDate">
          <column name="LastActivityDate" sql-type="datetime" not-null="true" />
        </property>

      </join>
    </subclass>

    <subclass name="SiteUser" discriminator-value="0">
      <join table="aspnet_Users">
        <key column="UserId" />

        //blah blah blah

      </join>
    </subclass>

  </class>

</hibernate-mapping> 
```

希望有人能告诉我我是否在这个映射的正确轨道上，也许可以提供一些指导？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T13:13:24.383

这似乎是一种非常复杂的映射方式。我不确定你希望在这种情况下使用继承获得什么好处，我建议改为使用组合（即每个表有一个类并映射关系）。

话虽如此，您可能有自己的理由，所以我建议以下内容来实现我认为您想要的：

1.  将您的 SiteUser 类映射为基类并使用从 User_Contact 到 aspnet_Users 的连接（因此不要将 User 作为映射中的基础）
2.  然后使用连接子类映射而不是子类将您的 SiteContact 映射为子类，因此您不需要使用鉴别器。