# StackOverflow 问答 000626000-000626999

# windows - 如何在 Windows 上调用 Perl 脚本？

> ID：626003
> 
> 赞同：0
> 
> 时间：2009-03-09T12:20:04.910
> 
> 标签：windows, perl

我尝试编译 apache 2.2，我的 Visual Studio 2008 在 RC 上返回错误。经过一番谷歌搜索，我发现了这个解释：

> 似乎发生的事情是您在 Visual Studio 中未成功打开它；在转换为 .sln 文件 + .vcproj 文件之前，调用 perl 脚本很重要
> 
> perl srclib\apr\build\cvtdsp.pl -2005
> 
> 这将对 .dsp 文件语法做坏事，永远破坏它们，但允许我们解决一个 Visual Studio 错误。然后，将 Apache.dsw 加载到现代视觉工作室中；它应该“正常工作”。

谁能向我解释如何在 Windows 上调用 Perl 脚本？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T12:24:46.037

您可以获得的 Perl for Windows 的两个发行版是

*   [Strawberry Perl](http://strawberryperl.com/)（一种集成了 C 编译器以使 CPAN 存档在 Windows 上完全运行的新发行版）
*   [ActivePerl](http://www.activestate.com/activeperl/)（最常见的发行版，但 CPAN 不起作用）

只需安装其中一个，因为此脚本似乎没有使用任何花哨的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T00:04:23.710

此外，由于它是 Windows，请确保 Perl 解释器位于您的系统路径中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-25T18:28:20.527

我倾向于在我的 perl 脚本中使用一个与脚本同名的短 cmd 文件来设置一些初始变量并调用实际脚本：好处？！当您将所有逻辑包装在 Perl 脚本中并且 sh 或 cmd 文件只是设置一些基本的启动变量时，对 Unix 和 Linux 的可移植性会更容易：

就像是 ：

```
 set _BaseDir=E:\Perl\sfw
    set _ProjectName=logger
    set _ProjectVersion=0.6.0
    set _ProjectVersionDir=%_BaseDir%\%_ProjectName%\%_ProjectName%.%_ProjectVersion%

    set _PerlScript=%_ProjectVersionDir%\%_ProjectName%.pl
    set _CmdScript=%_ProjectVersionDir%\%_ProjectName%.cmd

    :: Action !!!
    perl %_PerlScript% 

    :: ping localhost -n 5
    pause 
```

# php - 地理邻近搜索

> ID：626024
> 
> 赞同：4
> 
> 时间：2009-03-09T12:27:46.670
> 
> 标签：php, mysql, google-maps

应用程序中有一个要求，即找出所有与特定国家和/或城市绑定的对象到谷歌地图中。

我们有使用谷歌地图api预先计算并存储在数据库中的具有各自纬度和经度的对象。有时，这些对象在它们可以提供其服务的特定服务范围/半径内提供服务。

例如，现在的情况就像我想找出所有位于阿姆斯特丹的对象。

该应用程序应找出所有位于阿姆斯特丹的对象，以及不完全位于阿姆斯特丹但附近的对象，其服务范围可达阿姆斯特丹。

所以我知道谷歌地图返回的阿姆斯特丹的纬度、经度值，以及存储在数据库中的具有各自纬度、经度值和服务范围/半径的对象。我怎样才能使它成为可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T12:41:13.377

您可能应该在数据库中将国家/城市表示为多边形，然后使用 OpenGIS 样式的多边形相交函数进行相交。

**但是**，MySQL 没有**正确**实现多边形相交（仅 MBR - 最小边界矩形）。因此，这种方法虽然在理论上是正确的，但对 MySQL 根本不起作用。您可能需要考虑迁移到 Postgres。

您可以做的是使用数据库的 MBR 交叉功能并用您自己的执行多边形/点交叉的代码来补充它们（您可以找到执行此操作的库）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T15:10:01.537

如果你想离开接近外部服务的机制，你也可以看看[LocalSolr](http://www.gissearch.com/localsolr) / [LocalLucene 之类的东西。](http://www.gissearch.com/locallucene)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T12:41:39.320

您可能想看看 MySQL 的[空间扩展](http://dev.mysql.com/doc/refman/5.1/en/spatial-extensions.html)。

您需要使用[Contains](http://dev.mysql.com/doc/refman/5.1/en/functions-that-test-spatial-relationships-between-geometries.html#function_contains)函数。然而，正如保罗在他的评论中所说，区域应该表示为多边形。如果不是，那么我相信您最好的选择是创建一个以您已有的点为中心的多边形。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T12:54:34.030

好的，据我了解，您基本上是在尝试计算 2 个纬度/经度点之间的距离。我会首先打折那些在你（比如说）10英里范围之外的地方。因此，从您的中心点，您将想要获得东、西、南和北 10 英里的坐标。为此，您需要使用[大圆距离](http://en.wikipedia.org/wiki/Great-circle_distance)公式。

从那时起，如果您希望进一步分解此数据，则您拥有数据，那么您需要按距中心点的距离对点进行排序。为此，您需要使用[Haversine 公式](http://en.wikipedia.org/wiki/Haversine_formula)

我可以看到您有一个 PHP 标记，但我在 SQL（主要）和 C# 中都包含了一些公式和示例。

[C# 和 SQL 中的半正弦公式](http://megocode3.wordpress.com/2008/02/05/haversine-formula-in-c/)

[使用 C# 确定邮政编码之间的距离](https://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/programming-and-development/?p=634)

[大圆SQL](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=81360)

[大圈子 2](http://www.bigresource.com/MS_SQL-Great-Circle-distance-calculation-AAuK69yL.html#ZWR4HbHJ)

# java - .png 文件的 drawImage() 在 Java 小程序中不起作用？

> ID：626031
> 
> 赞同：0
> 
> 时间：2009-03-09T12:29:27.413
> 
> 标签：java, image, applet

我用一个小程序制作了这个吃豆人游戏。当小程序完成加载时，它会显示我制作的“开始菜单”图形，上面写着“双击启动游戏”等。该图形将占据整个 400x400 小程序。这是代码：

```
public void paint(Graphics g)
{
    if (! isRunning)
    {
        switch (result)
        {
            case 0:
                showStartScreen(g);
            break;

            case 1:
                showWonScreen(g);
            break;

            case -1:
                showLostScreen(g);
            break;
        }
        return;
    }
      //Code for rendering other stuff if game is here
} 
```

显示开始屏幕：

```
public void showStartScreen(Graphics g)
{
    Image intro=img.getImg("pacman-intro.png");
    g.drawImage(intro, 0, 0, this);

} 
```

当我在 Eclipse 上本地运行它时，这工作正常，但是在 Web 浏览器中，当加载小程序时，我只看到一个空白框，其中 java 的加载动画以前是。令人惊讶的是，如果我随机双击小程序所在的位置，游戏就会开始并正常运行。所以这让我觉得问题在于使用 .png 文件绘制 .png 文件`drawImage`。

当您输赢游戏时也会发生同样的事情，它只是挂起而不是绘制它需要的图形。

[你可以在这里](http://tinyurl.com/a3fj2y)看到这个（你可以使用箭头键来控制）

PS我在这里使用双缓冲。

有什么想法吗..？

编辑：用于加载 img 的 ImgHelper 类的代码：

```
import java.awt.Image;
import java.net.URL;

import javax.swing.ImageIcon;

public class ImgHelper
{
    public Image getImg(String file)
    {
            //Engine is the name of the base applet class
        URL url=Engine.class.getClassLoader().getResource("assets/" + file);
        return new ImageIcon(url).getImage();

    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T12:43:34.870

啊，我检查了你的jar文件的内容。

将“pacman-intro.png”替换为“pacman-intro.PNG”。它区分大小写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T12:33:17.547

pngs在正确的目录中吗？是 ”。” 在服务器上的路径环境变量中？

试试“./pacman-intro.png”，即

# c# - 如何将 WiX 安装程序版本设置为当前构建版本？

> ID：626033
> 
> 赞同：139
> 
> 时间：2009-03-09T12:32:19.997
> 
> 标签：c#, svn, wix

我编写了一个应用程序及其 WiX 安装程序，并使用 subversion 将其置于版本控制之下。当 WiX 安装程序构建时，我希望它的版本号是应用程序的当前构建版本。我该如何做到这一点？我使用 c# 对应用程序进行编码。

注意我正在使用 ccnet 来构建这个项目

* * *

## 回答 #1

> 赞同：186
> 
> 时间：2009-03-13T00:52:57.917

您可以使用`Product/@Version="!(bind.FileVersion.FileId)"`（替换`FileId`为`Id`您想从中获取版本号的文件），light.exe 将使用`FileId`.

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-03-14T14:51:37.950

我在我的一个项目中通过编写预处理器扩展来从我的可执行文件中读取文件版本来做到这一点。所以 WiX 文件看起来像：

```
<?define ProductName="$(fileVersion.ProductName($(var.MyApp.TargetPath)))" ?>
<?define CompanyName="$(fileVersion.CompanyName($(var.MyApp.TargetPath)))" ?>
<?define ProductVersion="$(fileVersion.ProductVersion($(var.MyApp.TargetPath)))" ?>
<Product 
    Id="<product ID>" 
    Name="$(var.ProductName)" 
    Version="$(var.ProductVersion)" 
    Manufacturer="$(var.CompanyName)" 
    Language="1033" 
    UpgradeCode="<upgrade code>"> 
```

我已经在 CodePlex 上发布了代码： [http ://wixfileversionext.codeplex.com/](http://wixfileversionext.codeplex.com/)

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2015-07-29T17:32:58.183

如果有人正在寻找一个实际的 XML 示例，这适用于 .NET 程序集（并且您不必执行 Assembly 或 KeyPath 属性）。我用 [...] 占位符消除了不相关的代码：

```
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product [...] Version="!(bind.fileVersion.MyDLL)">
        [...]
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder" Name="PFiles">
                <Directory Id="INSTALLDIR" Name="MyDLLInstallLocation">
                    <Component Id="MainLib" Guid="[...]">
                        <File Id="MyDLL" Name="MyDll.dll" Source="MyDll.dll" />
                        [...]
                    </Component>
                    [...]
                </Directory>
            </Directory>
        </Directory>
    </Product>
</Wix> 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2013-09-25T21:58:56.063

`BeforeBuild Target`这是一种非常简单的方法，可以使用和让您的 Bootstrapper Bundle 版本与您的 MyApp AssemblyVersion 匹配`DefineConstants`。

捆绑.wxs：

```
<Bundle Name="$(var.ProductName) Bootstrapper v$(var.BuildVersion)"
     Version="$(var.BuildVersion)" 
```

引导程序.wixproj：

```
<Target Name="BeforeBuild">
  <GetAssemblyIdentity AssemblyFiles="..\MyApp\bin\$(Configuration)\MyApp.exe">
    <Output TaskParameter="Assemblies" ItemName="AssemblyVersion" />
  </GetAssemblyIdentity>
  <PropertyGroup>
    <DefineConstants>BuildVersion=%(AssemblyVersion.Version)</DefineConstants>
  </PropertyGroup>
</Target> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-03-26T04:34:32.987

您可以将版本传递给安装项目的 MSBuild 脚本，就像传递给应用程序的构建脚本一样。

例如，如果您的 CI 系统定义了变量`AppVersion`和`BuildNumber`，并将它们传递给您的 MSBuild 脚本，您的 wixproj 可以创建一个相应的`Version`属性，并将其转发给 Wix，如下所示：

```
<PropertyGroup>
    <Version Condition=" '$(BuildNumber)' == '' ">0.0.1</Version>
    <Version Condition=" '$(BuildNumber)' != '' ">$(AppVersion).$(BuildNumber)</Version>
    <DefineConstants>Version=$(Version)</DefineConstants>
</PropertyGroup> 
```

的第一个定义`Version`为您在本地构建时提供了默认值。无论最终结果如何，都会成为`Version`Wix 中的变量。在 wsx 文件中使用它，如下所示：

```
<Product Version="$(var.Version)" ...>
    <Package Description="$(var.ProductName) $(var.Version): $(var.ProductDescription)" ... /> 
```

我喜欢在描述中包含版本，以便可以轻松地从窗口资源管理器（作为详细信息视图或属性页面中的一列）查找，而与文件名无关。

将版本作为变量传递给您比从文件中读取它更多的控制权。当您从文件中读取时，您将获得程序化版本的所有 4 个部分。但是，[ProductVersion](https://docs.microsoft.com/en-us/windows/desktop/msi/productversion)仅设计为使用前 3 个部分。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-09T12:55:24.090

这看起来与您要完成的工作相当接近。看看巡航控制中的等价物是什么。

[http://www.ageektrapped.com/blog/setting-properties-for-wix-in-msbuild/](http://www.ageektrapped.com/blog/setting-properties-for-wix-in-msbuild/)

# windows - CMD 全屏 Visual Studio

> ID：626035
> 
> 赞同：2
> 
> 时间：2009-03-09T12:33:14.440
> 
> 标签：windows, visual-studio, visual-studio-2008, command-line

我不小心做了一个全屏命令外壳，我设法让它恢复到原来的状态，但是现在当我运行 Visual Studio 时，我的屏幕闪烁黑色，我认为这是全屏命令外壳启动。

有人可以帮忙吗？如果再有一位同事问我是否感染了病毒，我会用头撞桌子。

谢谢，

乙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-22T09:24:58.240

上述解决方案对我没有帮助。运行 cmd.exe 不再全屏打开，但从其他位置运行它（如 Visual Studio 一样）仍会全屏打开。而且构建速度太快，无法更改构建提示本身的选项。所以其他想法将不胜感激！

**编辑：**

在 microsoft.com 上大量搜索后找到了解决方案：在 Windows Server 2000、Windows XP（32 位）、Windows Server 2003 和 Windows Vista（32 位）上：运行 Regedt32，它位于 \System32 子文件夹中Windows NT 根文件夹。打开注册表树的 \HKEY_CURRENT_USER\Console 分支。将 FullScreen 值设置为 0。退出注册表编辑器。[http://support.microsoft.com/kb/126031/en-us?spid=3041&sid=global](http://support.microsoft.com/kb/126031/en-us?spid=3041&sid=global)

（从评论复制）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T12:35:40.003

打开命令提示符，从其系统菜单（单击左上角的图标）选择默认并确保未在选项选项卡上选择全屏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-22T09:48:24.467

Alt + Enter，是命令提示符的全屏切换。

# c# - WinForms ListView中的可变高度行

> ID：626037
> 
> 赞同：7
> 
> 时间：2009-03-09T12:33:41.570
> 
> 标签：c#, .net, winforms, listview

在详细信息模式下，WinForms ListView 中是否可以有可变高度行？

据我所知，控件上没有 RowHeight 或 Rows[i].Height 属性。

一些博客建议实现 OwnerDraw，我这样做了，但我仍然无法从事件处理程序中找到任何类似于 height 属性的东西。

理想情况下，行高会在需要时自动调整大小以显示多行文本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T12:54:37.743

如果您使用的是详细信息模式，我想知道是否`DataGridView`会更加通用。每行都有一个高度，或者您可以使用 AutoSizeRowsMo​​de 自动完成。请参阅[MSDN](http://msdn.microsoft.com/en-us/library/ms171604.aspx) “在 Windows 窗体 DataGridView 控件中调整列和行的大小”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T12:56:55.617

要考虑的一种选择：

要覆盖所有行的项目高度，请创建一个虚拟 ImageList 并将其设置为所需的高度，然后根据视图将其分配给列表视图或掌握[http://www.codeproject.com/KB/list/changerowheight的概念.aspx](http://www.codeproject.com/KB/list/changerowheight.aspx)

如果您使用[ObjectListView ，您可以很](http://objectlistview.sourceforge.net/cs/features.html)[容易地](http://objectlistview.sourceforge.net/cs/features.html#row-height-can-be-changed)更改所有行的项目高度。但是，只要您使用 ListView，就无法更改单个项目的高度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T06:42:04.857

第一个答案中提到的 ObjectListView 不支持可变行高。[它在其常见问题解答](http://file:///C:/jpp/code/cs/ObjectListView/SourceForge/website/cs/faq.html#can-an-objectlistview-have-rows-of-different-heights)中清楚地说明了这一点。底层的 Windows 列表视图控件根本不支持可变行高。您必须查看其他自定义书面控件。

您可能需要考虑[Matthew Hall 的出色 XPTable](http://www.codeproject.com/KB/list/XPTable.aspx)及其[更新项目](http://www.codeproject.com/KB/list/XPTableListViewUpdate.aspx)，以及 Lee Paul Alexander 出色的[Outlook 样式列表](http://www.codeproject.com/KB/list/outlooklistcontrol.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-13T00:13:32.113

ListBox 控件确实支持可变高度行，但您必须自己完成所有绘图。

将 DrawMode 设置为 OwnerDrawVariable

然后加

```
protected override void OnDrawItem(DrawItemEventArgs e)
{
  /* Drawing code here */
}

protected override void OnMeasureItem(MeasureItemEventArgs e)
{
  /* Measure code here */
} 
```

我在一个名为 Task Reporter 的程序中使用自绘列表框来列出用户输入的每个任务。每个条目都不同，具体取决于输入的文本量。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-22T23:22:13.380

如果您对 3rd 方组件没问题，[更好的 ListView](http://www.componentowl.com/better-listview)完全支持这一点（每个项目都有一个`CustomHeight`属性，因此每个项目可以有不同的高度）：

![在此处输入图像描述](https://i.stack.imgur.com/E0vzy.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-11T21:44:11.277

Windows ListView 控件本身（由 .NET ListView 控件包装）不支持可变行高。

如果您坚持使用 ListView，则需要固定高度的行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-13T19:26:22.420

如果可变高度行是您想要的，我会考虑改用 DataGridView。它非常支持可变高度的行（通过使用单元格样式），并且比尝试将列表视图硬塞到做你想做的事情要容易得多。

# java - 如何扩展类 java.security.SecureClassLoader？

> ID：626043
> 
> 赞同：0
> 
> 时间：2009-03-09T12:38:33.197
> 
> 标签：java, security, classloader

我想编写自己的 ClassLoader。作为 Applet 的默认 ClassLoader，它应该更快、更动态。

但我不知道我应该如何实现该方法：

```
PermissionCollection getPermissions( CodeSource codesource ) 
```

如果 CodeSource 中存在有效证书，则超级实现也不授予任何权利。

我必须自己验证证书还是它已经从 Java VM 验证并从用户那里接受？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T12:44:15.757

Sun PlugIn 和 WebStart 覆盖`getPermissions`以检查签名并与用户一起检查他们是否希望接受证书。这是一个实现细节，将来可能会改变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T13:03:04.290

如果我错了，请纠正我 - 我认为您想要的是在您的小程序初始化的某个地方创建一个类加载器，然后使用该加载器加载您的后续类。如果是，则该小程序已经被授予所有权限，因为它已被签名（并且假设用户单击了浏览器警告）。您的 getPermissions 方法可能如下所示

```
 PermissionCollection p = new Permissions();
    p.add(new AllPermission());
    return p; 
```

# sql - 初始化提供者的传输层连接错误

> ID：626047
> 
> 赞同：2
> 
> 时间：2009-03-09T12:38:46.957
> 
> 标签：sql, sql-server, ssis

我正在尝试使用特定的用户名和密码连接到 SSIS 中的分析服务数据库。

我收到消息

> 初始化提供程序时出错。在传输层中遇到错误。

对等方过早地关闭了连接。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T14:25:20.150

您是否在 Analysis Services 中正确设置了您的权利？假设当您通过 SSIS 创建新的 AS 连接时，您单击“添加新的 Analysis Services 连接”窗口中的“编辑”按钮并输入您的用户名和密码，它应该可以工作。您可以通过 SQL Management Studio 登录吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-15T21:01:34.677

尝试安装/重新安装[Microsoft OLE DB Provider for Analysis Services 9.0](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=50b97994-8453-4998-8226-fa42ec403d17&displaylang=en) (for 2005) 或[Microsoft OLE DB Provider for Analysis Services 10.0](http://www.microsoft.com/downloads/en/details.aspx?familyid=B33D2C78-1059-4CE2-B80D-2343C099BCB4&displaylang=en) (2008)

# javascript - 如何在 Mozilla 中使用 JavaScript 调用 COM 组件？

> ID：626048
> 
> 赞同：0
> 
> 时间：2009-03-09T12:39:20.603
> 
> 标签：javascript, silverlight, firefox

我在 IE 中调用 COM 组件。这是代码

```
<object align="left" classid="CLSID:22D6F312-B0F6-11D0-94AB-0080C74C7E95" 
        id="Winvideo-Silverlight2RTW-Hypervideo-Part1-WMVa.wmv">

    <param name="FileName" value="Winvideo-Silverlight2RTW-Hypervideo-Part1-WMVa.wmv">
    <param name="AutoRewind" value="true">
    <param name="AutoStart" value="false">    
    <param name="ClickToPlay" value="true">
    <param name="Mute" value="false">
    <param name="ShowControls" value="true">
    <param name="ShowDisplay" value="true">
    <param name="ShowTracker" value="true">
    <param name="PlayCount" value="1">

</object> 
```

它在 IE 中运行良好，但在 Mozilla Firefox 中运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T17:02:48.007

您需要添加[<object type="application/x-ms-wmp">](http://msdn.microsoft.com/en-us/library/bb614509(VS.85).aspx)。

但是，许多 Firefoxen 和其他浏览器仍然没有安装 Windows Media Player 插件。即使在 IE 上，我也发现它——连同 QuickTime 和 Real——相当不可靠……这就是为什么现在大多数人最终都使用 Flash Video 而不是尝试嵌入媒体播放器的原因。

# c++ - _bstr_t 到 UTF-8 可能吗？

> ID：626049
> 
> 赞同：9
> 
> 时间：2009-03-09T12:40:20.273
> 
> 标签：c++, visual-c++, com, atl, bstr

我有一个`_bstr_t`包含日语文本的字符串。我想将此字符串转换为定义为`char *`.

我可以将`_bstr_t`字符串转换为`char *`(UTF-8) 字符串而不会丢失日文字符吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-09T12:43:15.213

使用 WideCharToMultiByte() – 传递 CP_UTF8 作为第一个参数。

请注意，BSTR 可以是空指针并且对应于空字符串 - 将此视为特殊情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-10T19:32:07.740

这是一些应该进行转换的代码。

```
void PrintUtf8(const TCHAR* value) { 
    if (value == nullptr) {
        printf("");
        return;
    }
    int n = WideCharToMultiByte(CP_UTF8, 0, value, -1, nullptr, 0, nullptr, nullptr);
    if (n <= 0) {
        printf("");
        return;
    }
    char* buffer = new char[n];
    WideCharToMultiByte(CP_UTF8, 0, value, -1, buffer, n, nullptr, nullptr);
    printf("%s", buffer);
    delete(buffer);
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-09T12:44:19.827

这类事情非常方便的 MSDN 参考：http: [//msdn.microsoft.com/en-us/library/ms235631 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms235631(VS.80).aspx)

我认为你需要去 wchar_t* 因为 char* 会丢失 Unicode 的东西，虽然我不确定。

```
// convert_from_bstr_t.cpp
// compile with: /clr /link comsuppw.lib

#include <iostream>
#include <stdlib.h>
#include <string>

#include "atlbase.h"
#include "atlstr.h"
#include "comutil.h"

using namespace std;
using namespace System;

int main()
{
    _bstr_t orig("Hello, World!");
    wcout << orig << " (_bstr_t)" << endl;

    // Convert to a char*
    const size_t newsize = 100;
    char nstring[newsize];
    strcpy_s(nstring, (char *)orig);
    strcat_s(nstring, " (char *)");
    cout << nstring << endl;

    // Convert to a wchar_t*
    wchar_t wcstring[newsize];
    wcscpy_s(wcstring, (wchar_t *)orig);
    wcscat_s(wcstring, L" (wchar_t *)");
    wcout << wcstring << endl;

    // Convert to a CComBSTR
    CComBSTR ccombstr((char *)orig);
    if (ccombstr.Append(L" (CComBSTR)") == S_OK)
    {
        CW2A printstr(ccombstr);
        cout << printstr << endl;
    }

    // Convert to a CString
    CString cstring((char *)orig);
    cstring += " (CString)";
    cout << cstring << endl;

    // Convert to a basic_string
    string basicstring((char *)orig);
    basicstring += " (basic_string)";
    cout << basicstring << endl;

    // Convert to a System::String
    String ^systemstring = gcnew String((char *)orig);
    systemstring += " (System::String)";
    Console::WriteLine("{0}", systemstring);
    delete systemstring;
} 
```

# java - DWR 是否支持使用 GET 调用方法？

> ID：626052
> 
> 赞同：0
> 
> 时间：2009-03-09T12:41:03.487
> 
> 标签：java, ajax, dwr, http-get

DWR 是否支持使用 GET 调用方法？所以我可以使用http缓存来缓存调用的结果......这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-11T14:19:51.580

似乎它确实支持这一点，因为 DWR 2.x 中的 engine.js 有一个选项“ `httpMethod`”，您可以使用它指定 GET；来自[文档](http://directwebremoting.org/dwr/browser/engine/index.html)：

> 选择使用 GET 或 POST。在 1.x 中称为“动词”，可能在 3.0 版中被删除

这些选项可以全局设置或在调用级别设置。不过，我自己并没有使用过该选项。（并且它被标记为已弃用。）

（关于缓存，我不确定。我很快就找到了[这个页面](http://directwebremoting.org/dwr/browser/engine/static.html)，它讨论了缓存 engine.js 和 DWR 生成的脚本。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-18T07:40:51.080

可以将其设置为 GET 方法首先，我们必须在 web.xml 中为 dwr config 设置一个允许 GET

```
<Init-param>
       <Param-name> allowGetForSafariButMakeForgeryEasier </ param-name>
       <Param-value> true </ param-value>
</ Init-param> 
```

其次，在使用 dwr 调用任何方法之前，我们必须设置 `dwr.engine.setHttpMethod("GET");`

从下面的链接中找到了解决方案，修改了一下以适应 dwr 2.0/3.0 [http://blog.intropedro.com/es/tema/dwr](http://blog.intropedro.com/es/tema/dwr)

# analytics - SAS在业务中的使用是增加还是减少？

> ID：626056
> 
> 赞同：2
> 
> 时间：2009-03-09T12:42:18.490
> 
> 标签：analytics, sas, business-intelligence

当您查看商业智能领域时，有许多大玩家，包括 SAS。在我在这个领域的时间里，我注意到越来越多的大玩家转向了一种不需要编码技能集的更用户友好的工具。

此外，我知道 SAS 正试图通过引入更多指向和点击的工具（EGUIde、DI 工作室等）来保护他们的市场份额。但是让我们面对现实吧，这些没有编码知识的工具对于大多数用户来说并不是一个有效的选择。

您认为 SAS 作为商业智能工具的使用正在增加还是减少？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T19:06:48.833

SAS[自成立以来一直保持着相当稳定的增长](http://blogs.sas.com/sascom/index.php?/archives/454-SAS-growth-continues.html)。特定功能领域的使用可能会起起落落，但总体而言，在我看来它们仍在增长（不知道这如何转化为市场份额，但在这些经济时代的任何增长都可能是好的）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-15T21:36:33.220

您需要了解编码是实现灵活性的最终方式。任何 GUI 都只是一座纪念碑，基础是底层编码。如果您可以创建足够灵活的纪念碑，那就太好了！但我还没有看到任何产品能够提供这么大的灵活性。此外，出于商业智能/分析的目的，我觉得很难想出一个坚如磐石的模型来适应一切，因为它是一个不断发展的领域。

因此，SAS 保留了它的编码以及 GUI（EG 等），我认为这是不断发展的分析和 BI 目的的完美组合。

因此，回答您的问题：在 BI/分析方面，每个人都有自己的需求。有些人更喜欢编码而不是 GUI。所以对每个他/她自己。SAS 拥有稳固的用户群，而且看起来不会很快减少，当然也不会像我之前的受访者所说的那样“慢慢消亡”。

和平。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T14:16:04.287

我的猜测是 SAS 正在慢慢消亡。对我来说，SAS 的*好处*是（1）SAS-L 在处理和组合数据方面比例如强大得多。SQL 或我使用过的任何其他工具，以及 (2) 它被解释，这使得临时的东西变得容易。

我不知道 SAS 在世界范围内是如何使用的，但如果大多数用户主要是编码，那么最大的威胁可能不是面向 GUI 的工具，而是更灵活的语言。例如，对我来说，一个大问题是 SAS 不能很好地集成到关系数据库中。

也许 F#，作为一种解释性语言，有朝一日会在 SAS 用于这些天的任务中变得有用 - 或者这只是我的梦想 :)

# http - 是否可以在 HTTP 中缓存 POST 方法？

> ID：626057
> 
> 赞同：169
> 
> 时间：2009-03-09T12:42:21.953
> 
> 标签：http, post, http-caching

使用非常简单的缓存语义：如果参数相同（当然，URL 相同），那么它就成功了。那可能吗？受到推崇的？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-03-09T12:50:42.277

如果您使用适当的标头，则第 9.5 节（POST）中的相应[RFC 2616](http://www.faqs.org/rfcs/rfc2616.html)允许缓存对 POST 消息的**响应。**

> 对此方法的响应是不可缓存的，除非响应包含适当的 Cache-Control 或 Expires 标头字段。但是，303（请参阅其他）响应可用于指示用户代理检索可缓存资源。

请注意，相同的 RFC 在第 13 节（HTTP 中的缓存）中明确指出，缓存必须在 POST**请求**之后使相应的实体无效。

> 某些 HTTP 方法必须导致缓存使实体无效。这是 Request-URI 或 Location 或 Content-Location 标头（如果存在）引用的实体。这些方法是：
> 
> ```
>  - PUT
>   - DELETE
>   - POST 
> ```

我不清楚这些规范如何允许有意义的缓存。

这也在[RFC 7231](https://www.rfc-editor.org/rfc/rfc7231)（第 4.3.3 节）中得到反映和进一步澄清，该 RFC 2616 已经过时。

> POST 请求的响应只有在包含
> 明确的新鲜度信息时才可缓存（参见 [RFC7234] 的第 4.2.1 节）。
> 但是，POST 缓存并未得到广泛实施。对于源服务器希望客户端能够缓存 POST 的结果以供以后的 GET 重用的情况，源服务器可以发送包含结果和 Content-Location 的 200（OK）响应与 POST 的有效请求 URI 具有相同值的标头字段（第 3.1.4.2 节）。

据此，缓存 POST 的结果（如果服务器指示此能力）随后可以用作对同一 URI 的 GET 请求的结果。

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2009-05-06T04:57:04.443

根据 RFC 2616 第 9.5 节：

> “对 POST 方法的响应不可缓存，除非响应包含适当的 Cache-Control 或 Expires 标头字段。”

所以，是的，您可以缓存 POST 请求响应，但前提是它带有适当的标头。在大多数情况下，您不想缓存响应。但在某些情况下——比如你没有在服务器上保存任何数据——这是完全合适的。

请注意，许多浏览器，包括当前的 Firefox 3.0.10，都不会缓存 POST 响应，无论标头如何。IE 在这方面表现得更聪明。

现在，我想在这里澄清一些关于 RFC 2616 S. 13.10 的混淆。URI 上的 POST 方法不会“使缓存资源无效”，正如一些人所说的这里。它使该 URI 的先前缓存版本过时，即使它的缓存控制标头指示较长持续时间的新鲜度。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-03-09T13:04:28.703

**总体：**

基本上[POST 不是幂等操作](http://en.wikipedia.org/wiki/Idempotent)。所以你不能用它来缓存。GET 应该是幂等操作，所以常用于缓存。

请参阅[HTTP 1.1 RFC 2616 S. 9.1](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.1)的第 9.1 节。

**除了 GET 方法的语义：**

POST 方法本身在语义上意味着将某些内容发布到资源。POST 不能被缓存，因为如果你做某事一次 vs 两次 vs 三次，那么你每次都在改变服务器的资源。每个请求都很重要，应该传递给服务器。

PUT 方法本身在语义上意味着放置或创建资源。这是一个幂等操作，但不会用于缓存，因为此时可能发生了 DELETE。

DELETE 方法本身在语义上意味着删除资源。这是一个幂等操作，但不会用于缓存，因为同时可能发生了 PUT。

**关于客户端缓存：**

Web 浏览器将始终转发您的请求，即使它有来自先前 POST 操作的响应。例如，您可以隔几天发送带有 gmail 的电子邮件。它们可能是相同的主题和正文，但应发送两封电子邮件。

**关于代理缓存：**

将您的消息转发到服务器的代理 HTTP 服务器永远不会缓存除 GET 或 HEAD 请求之外的任何内容。

**关于服务器缓存：**

默认情况下，服务器不会通过检查其缓存来自动处理 POST 请求。但是当然可以将 POST 请求发送到您的应用程序或加载项，并且您可以拥有自己的缓存，当参数相同时您可以从中读取。

**使资源无效：**

检查[HTTP 1.1 RFC 2616 S. 13.10](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.10)表明 POST 方法应该使缓存资源无效。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2020-01-02T20:13:21.223

如果您想知道是否可以缓存发布请求，并尝试研究该问题的答案，您可能不会成功。搜索“缓存发布请求”时，第一个结果是这个 StackOverflow 问题。

答案是混淆了缓存应该如何工作、缓存如何根据 RFC 工作、缓存应该如何根据 RFC 工作以及缓存在实践中如何工作。让我们从 RFC 开始，了解浏览器的实际工作原理，然后讨论 CDN、GraphQL 和其他关注领域。

## RFC 2616

根据 RFC，POST 请求必须使缓存无效：

```
13.10 Invalidation After Updates or Deletions

..

Some HTTP methods MUST cause a cache to invalidate an entity. This is
either the entity referred to by the Request-URI, or by the Location
or Content-Location headers (if present). These methods are:
  - PUT
  - DELETE
  - POST 
```

这种语言表明 POST 请求是不可缓存的，但事实并非如此（在这种情况下）。缓存仅对以前存储的数据无效。RFC（似乎）明确说明是的，您可以缓存`POST`请求：

```
9.5 POST

..

Responses to this method are not cacheable, unless the response
includes appropriate Cache-Control or Expires header fields. However,
the 303 (See Other) response can be used to direct the user agent to
retrieve a cacheable resource. 
```

尽管使用了这种语言，但设置`Cache-Control`不得缓存`POST`对同一资源的后续请求。`POST`请求必须发送到服务器：

```
13.11 Write-Through Mandatory

..

All methods that might be expected to cause modifications to the
origin server's resources MUST be written through to the origin
server. This currently includes all methods except for GET and HEAD.
A cache MUST NOT reply to such a request from a client before having
transmitted the request to the inbound server, and having received a
corresponding response from the inbound server. This does not prevent
a proxy cache from sending a 100 (Continue) response before the
inbound server has sent its final reply. 
```

这有什么意义？好吧，您不是在缓存`POST`请求，而是在缓存资源。

POST 响应正文只能为对同一资源的后续 GET 请求进行缓存。在 POST 响应中设置`Location`or标头以传达正文代表的资源。`Content-Location`因此，缓存 POST 请求的唯一技术上有效的方法是对同一资源进行后续 GET。

正确答案是两者：

*   “是的，RFC 允许您将后续 GET 的 POST 请求缓存到同一资源”
*   “不，RFC 不允许您为后续 POST 缓存 POST 请求，因为 POST 不是幂等的，必须写入服务器”

尽管 RFC 允许缓存对同一资源的请求，但在实践中，浏览器和 CDN 不会实现此行为，并且不允许您缓存 POST 请求。

资料来源：

*   [https://www.rfc-editor.org/rfc/rfc2616#section-13](https://www.rfc-editor.org/rfc/rfc2616#section-13) HTTP/1.1 RFC
*   [https://www.mnot.net/blog/2012/09/24/caching_POST](https://www.mnot.net/blog/2012/09/24/caching_POST)

## 浏览器行为演示

给定以下示例 JavaScript 应用程序 (index.js)：

```
const express = require('express')
const app = express()

let count = 0

app
    .get('/asdf', (req, res) => {
        count++
        const msg = `count is ${count}`
        console.log(msg)
        res
            .set('Access-Control-Allow-Origin', '*')
            .set('Cache-Control', 'public, max-age=30')
            .send(msg)
    })
    .post('/asdf', (req, res) => {
        count++
        const msg = `count is ${count}`
        console.log(msg)
        res
            .set('Access-Control-Allow-Origin', '*')
            .set('Cache-Control', 'public, max-age=30')
            .set('Content-Location', 'http://localhost:3000/asdf')
            .set('Location', 'http://localhost:3000/asdf')
            .status(201)
            .send(msg)
    })
    .set('etag', false)
    .disable('x-powered-by')
    .listen(3000, () => {
        console.log('Example app listening on port 3000!')
    }) 
```

并给出以下示例网页（index.html）：

```
<!DOCTYPE html>
<html>

<head>
    <script>
        async function getRequest() {
            const response = await fetch('http://localhost:3000/asdf')
            const text = await response.text()
            alert(text)
        }
        async function postRequest(message) {
            const response = await fetch(
                'http://localhost:3000/asdf',
                {
                    method: 'post',
                    body: { message },
                }
            )
            const text = await response.text()
            alert(text)
        }
    </script>
</head>

<body>
    <button onclick="getRequest()">Trigger GET request</button>
    <br />
    <button onclick="postRequest('trigger1')">Trigger POST request (body 1)</button>
    <br />
    <button onclick="postRequest('trigger2')">Trigger POST request (body 2)</button>
</body>

</html> 
```

安装 NodeJS、Express，并启动 JavaScript 应用程序。在浏览器中打开网页。尝试几种不同的场景来测试浏览器的行为：

*   每次单击“触发 GET 请求”都会显示相同的“计数”（HTTP 缓存有效）。
*   单击“触发 POST 请求”每次都会触发不同的计数（POST 的 HTTP 缓存不起作用）。
*   单击“触发 GET 请求”、“触发 POST 请求”和“触发 GET 请求”显示 POST 请求使 GET 请求的缓存无效。
*   单击“触发 POST 请求”然后单击“触发 GET 请求”显示浏览器不会缓存后续 GET 请求的 POST 请求，即使它是 RFC 允许的。

这表明，即使您可以设置`Cache-Control`和`Content-Location`响应标头，也无法让浏览器缓存 HTTP POST 请求。

## 我必须遵循 RFC 吗？

浏览器行为不可配置，但如果您不是浏览器，则不一定受 RFC 规则的约束。

如果您正在编写应用程序代码，没有什么能阻止您显式缓存 POST 请求（伪代码）：

```
if (cache.get('hello')) {
  return cache.get('hello')
} else {
  response = post(url = 'http://somewebsite/hello', request_body = 'world')
  cache.put('hello', response.body)
  return response.body
} 
```

CDN、代理和网关也不一定必须遵循 RFC。例如，如果您使用 Fastly 作为 CDN，Fastly 允许您编写[自定义 VCL](https://docs.fastly.com/en/guides/guide-to-vcl)逻辑来[缓存 POST 请求](https://docs.varnish-software.com/tutorials/caching-post-requests/)。

## 我应该缓存 POST 请求吗？

您的 POST 请求是否应该被缓存取决于上下文。

例如，您可以使用 POST 查询 Elasticsearch 或 GraphQL，而您的底层查询是幂等的。在这些情况下，根据用例缓存响应可能有意义，也可能没有意义。

在 RESTful API 中，POST 请求通常会创建资源并且不应被缓存。这也是RFC对POST不是幂等操作的理解。

## GraphQL

如果您使用 GraphQL 并需要跨 CDN 和浏览器进行 HTTP 缓存，请考虑使用[GET 方法而不是](https://graphql.org/learn/serving-over-http/#get-request)[POST](https://graphql.org/learn/serving-over-http/#post-request)发送查询是否满足您的要求。需要注意的是，不同的浏览器和 CDN 可能有不同的 URI 长度限制，但操作安全列表（查询白名单）作为面向外部的生产 GraphQL 应用程序的最佳实践，可以缩短 URI。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-10-16T20:49:32.060

如果您确实缓存了 POST 响应，则它必须位于 Web 应用程序的方向。这就是“对此方法的响应不可缓存，除非响应包含适当的 Cache-Control 或 Expires 标头字段”的意思。

可以安全地假设应用程序知道 POST 的结果是否是幂等的，它决定是否附加必要的和适当的缓存控制头。如果存在建议允许缓存的标头，则应用程序会告诉您 POST 实际上是一个超级 GET；仅由于执行幂等操作所需的大量不必要且不相关的数据（对于使用 URI 作为缓存键），才需要使用 POST。

在此假设下，可以从缓存中提供以下 GET 服务。

未能附加必要且正确的标头以区分可缓存和不可缓存 POST 响应的应用程序对于任何无效缓存结果都是错误的。

也就是说，每个命中缓存的 POST 都需要使用条件标头进行验证。这是刷新缓存内容所必需的，以避免在对象的生命周期到期之前，POST 的结果不会反映在对请求的响应中。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-07-07T06:47:30.503

Mark Nottingham 分析了何时缓存 POST 的响应是可行的。请注意，想要利用缓存的后续请求必须是 GET 或 HEAD 请求。另请参阅[http 语义](https://www.rfc-editor.org/rfc/rfc7231#section-4.3.3)

> POST 不处理已识别状态的表示，100 次中有 99 次。但是，有一种情况可以；当服务器通过设置与请求 URI 相同的 Content-Location 标头来表示此 POST 响应是其 URI 的表示时。发生这种情况时，POST 响应就像对同一个 URI 的 GET 响应；它可以被缓存和重用——但仅限于未来的 GET 请求。

[https://www.mnot.net/blog/2012/09/24/caching_POST](https://www.mnot.net/blog/2012/09/24/caching_POST)。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-09T12:55:37.897

如果它实际上并没有改变您网站上的数据，那么它应该是一个 GET 请求。即使是表单，您仍然可以将其设置为获取请求。虽然，就像其他人指出的那样，您可以缓存 POST 的结果，但它没有语义意义，因为 POST 根据定义正在更改数据。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2014-05-19T18:45:29.257

使用 firefox 27.0 和 httpfox，在 2014 年 5 月 19 日，我看到了这样一行： 00:03:58.777 0.488 657 (393) POST (Cache) text/html [https://users.jackiszhp.info/S4UP](https://users.jackiszhp.info/S4UP)

很明显，一个post方法的响应是缓存的，也是在https中的。逆天！

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2013-06-11T20:57:09.957

POST 用于有状态的 Ajax。返回 POST 的缓存响应会破坏通信通道和接收消息的副作用。这是非常非常糟糕的。追查也是一件很痛苦的事。强烈建议反对。

一个简单的例子是一条消息，作为副作用，当周支付你的工资 10,000 美元。你不想得到“好的，它通过了！” 上周缓存的页面返回。其他更复杂的真实案例也会引起类似的欢闹。

# c# - 另一个进程使用的文件

> ID：626058
> 
> 赞同：22
> 
> 时间：2009-03-09T12:42:26.713
> 
> 标签：c#, file-io

很多时候我们在尝试在 Windows 平台上写入文件时遇到错误，

“该进程无法访问文件‘XXX’，因为它正被另一个进程使用。”

如何在写入文件之前检查 C#，它没有被另一个进程使用？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-09T12:45:39.043

基本上，您不能-您必须尝试打开文件进行写入，如果遇到异常，您将无法写入它:(

即使您可以先进行单独的检查，在您开始编写之前，结果也会过时 - 您以后仍然可能会遇到异常。

`TryOpen`诚然，如果框架提供了一种方法，那就太好了……

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T12:45:25.520

这里唯一的选择是捕获生成的异常并适当地处理它。有关完整讨论，请参阅其他两个 SO 线程：

*   [如何检查文件锁定？](https://stackoverflow.com/questions/1304/how-to-check-for-file-lock-in-c)
*   [检测文件是否被另一个进程（或者实际上是同一个进程）锁定](https://stackoverflow.com/questions/424830/detecting-whether-a-file-is-locked-by-another-process-or-indeed-the-same-process)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-07-27T13:52:40.330

在您的代码上使用它后，您必须对`close`您的文件：

```
FileStream file = new FileStream(fileName, FileMode.Open, FileAccess.Read); //file is opened
//you use the file here 
file.Close(); //then you must to close the file 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T12:48:40.193

您只需尝试使用您想要的共享访问权限打开，并处理引发的错误。

注意：有时文件无法打开只是因为您指定的文件共享权限与某人已经打开文件的文件共享权限冲突。

[请在此处查看我的答案以获取更多信息](https://stackoverflow.com/questions/203837/can-i-simply-read-a-file-that-is-in-use/203839#203839)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T12:47:15.623

尝试将 open 命令放在 try-catch 语句中。如果文件正在被使用，将抛出 IOException。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-03T10:25:16.153

如果可以重命名，请尝试重命名文件，然后确认没有其他进程正在访问该文件。最后确保您已重命名同一文件夹中的同一文件。

# c++ - 模板类的继承问题

> ID：626067
> 
> 赞同：0
> 
> 时间：2009-03-09T12:45:02.230
> 
> 标签：c++, inheritance

任何人都可以想出一个让以下代码工作的好方法吗？（这又是一种非常简单的方法）

```
 template <class f, class g> class Ptr;

class RealBase
{
};

template <class a, class b, class c = Ptr<a,b> >
class Base : public RealBase
{
public:
    Base(){};
};

template <class d, class e>
class Derived : public Base <d,e>
{
public:
    Derived(){};
    void DerivedMethod(){};
};
template <class f, class g>
class Ptr
{
public:
    Ptr(){};
    Ptr(Base<f,g,Ptr<f,g> >* a){in = a;};
    Base<f,g,Ptr<f,g> >* operator->()
    {
        return in;
    };
private:
    Base<f,g,Ptr<f,g> >* in;
};

typedef Derived<double,double> DDerived;

int main()
{
    Base<int,int> b = Base<int,int>();
    Derived<double,double> d = Derived<double,double>();
    DDerived dd = DDerived();
    Ptr<double,double> p(&dd);
    p->DerivedMethod();
    return 1;
} 
```

目前编译器抱怨因为 Base<> 没有 DerivedMethod();

编辑

我确实理解这里的问题，我在第一种情况下缺乏解释（我很着急）。[顺便说一句，这是非常精简的代码，是的，为了简单起见，我没有实际执行任何操作的析构函数或方法。忽略这一点，这对问题没有影响。]

我需要发生的是，仅处理派生类（D_Derived）的迭代器（此处未详细说明）需要访问包含在派生类而不是基类中的方法。简单地将这个方法插入基类并不是一个真正的选择，因为如果我必须这样做，这个错误将会发生很多。（大约有 10 个类建立在真正的基类上，它们都有自己的派生方法。就像其中的 20 个。每个。）

谁能想到另一种实现此功能的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T12:54:04.610

此代码不起作用，因为模板类 Ptr 返回基模板类的对象而不是派生模板类的对象。派生方法是派生模板的一部分，因此会引发编译错误。而如果 DerivedMethod 是基本模板的一部分，则此代码将起作用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T12:49:32.547

这就说得通了。Base 没有这样的方法（DerivedMethod）。如果 DerivedMethod 是基类的虚函数（可能是`pure`），它会起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T12:54:28.010

编译器是对的。为了让您能够访问一个方法，该方法必须以编译器看到的类型声明（这称为变量的*静态类型*）。在您的情况下，这种类型是`Base<…&gt;`，编译器不知道它是别的什么。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T12:56:05.447

使用抽象类和成员名称很难弄清楚您真正想要实现的目标。如果您确实必须将指针`Ptr`视为 a `D_Derived`，请添加访问器成员`Ptr`并使用类型转换：

```
class Ptr {
    ...

    Base<f,g,Ptr<f,g> >* get() {
        return in;
    }
};

...

D_Derived* ptr = dynamic_cast<D_Derived*>(p.get());
if (ptr) {
    ptr->DerivedMethod();
} 
```

* * *

**编辑**：正如 Konrad Rudolph 指出的那样，为了使用动态转换，您必须在基类中添加一个虚拟方法。

实际上，为每个要用作基类的类定义一个虚拟析构函数是一个好习惯，以确保将调用派生类的析构函数（[更多信息](http://www.codersource.net/cpp_virtual_destructors.html)）。

```
class RealBase {
public:
    virtual ~RealBase() {}
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T16:26:18.470

好的。在尝试了大约 10 种不同的方法（`static_cast`等`reinterpret_cast`）之后，您就可以投射它了。

```
int main()
{
    Base&lt;int,int> b = Base&lt;int,int>();
    Derived&lt;double,double> d = Derived&lt;double,double>();
    DDerived dd = DDerived();
    Ptr&lt;double,double> p(&dd);
    DDerived * fauxpointer;
    fauxpointer = (DDerived\*) &(*p);
    fauxpointer->DerivedMethod();
    return 1;
} 
```

讨厌。但它有效，这就是最重要的。

向所有向我重复这个问题的人干杯。

# sql-server - 仅限 Analysis Services 的 Windows 身份验证

> ID：626078
> 
> 赞同：13
> 
> 时间：2009-03-09T12:50:03.247
> 
> 标签：sql-server, sql-server-2005, ssis, ssas, analysis

Analysis Services 是否仅支持 Windows 身份验证？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T12:56:22.607

是的，它确实。引用自[MSDN](http://msdn.microsoft.com/en-us/library/ms143708.aspx)

*“SQL Server Analysis Services 仅支持 Windows 身份验证”*

您需要活动目录，有关如何设置它，请参阅以下 kb [http://support.microsoft.com/kb/917409](http://support.microsoft.com/kb/917409)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-10-23T22:51:21.353

实际上需要“Active Directory”并不是真的。

您可以通过使用与运行 SSAS 的其他服务器上的帐户相同的用户和密码登录到任何域中的 PC 来欺骗操作系统。我一直都这样做。默认情况下，如果域不同但用户/密码是准确的，您将获得访问权限。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-07T21:52:41.790

根据您要实现的目标，您可以通过 HTTP 和 IIS 进行连接，IIS 提供或传递凭据：

[http://www.sqlserveranalysisservices.com/OLAPPapers/ConfiguringHTTPAccessToYukon.htm](http://www.sqlserveranalysisservices.com/OLAPPapers/ConfiguringHTTPAccessToYukon.htm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-28T10:45:26.263

需要 AD 肯定不是真的。您可以使用类似的工具`runas`在不同的用户帐户下执行程序。

例如，在我的开发环境中，我有时会使用它在不同的用户下运行 Sql Server Management Studio (SSMS) 或 Visual Studio。

SSMS：

```
runas /netonly /user:domain\username "C:\path_to\Ssms.exe"
runas /netonly /user:domain\username "C:\Program Files (x86)\Microsoft SQL Server\130\Tools\Binn\ManagementStudio\Ssms.exe" 
```

视觉工作室：

```
runas /netonly /user:domain\username "C:\path_to\devenv.exe"
runas /netonly /user:domain\username "C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\devenv.exe" 
```

该`runas`工具将提示您输入密码并在该用户下启动程序。

如果没有域，则可以使用计算机的名称。

# c# - 我怎样才能获得在特定日期执行的任务？

> ID：626080
> 
> 赞同：1
> 
> 时间：2009-03-09T12:50:08.487
> 
> 标签：c#, calendar

当我在日历控件中单击所述日期时，如何显示在特定日期内执行的任务详细信息。

例子：

*   我单击日历中的 1 月 5 日，然后我得到在该日期执行的任务。

我正在使用 C# 和 ASP.NET (2008)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T13:32:52.800

在数据库中存储带有日期的任务。编写具有日期参数的选择语句并在给定参数上返回任务。Onclick 事件从执行的过程中返回数据并显示结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T13:22:48.567

假设您有一个包含任务和分配日期的表，为所述表创建一个带有 TableAdapter 的 DataSet，并在您的页面上使用一个 ObjectDataSource，它将所选日历日作为参数并将行返回到 GridView。

# .net - 从 .NET 2.0 升级到 .NET 3.5 有什么好处？

> ID：626085
> 
> 赞同：18
> 
> 时间：2009-03-09T12:52:31.430
> 
> 标签：.net

我需要一些帮助。我的非程序员主管要求我准备一份文档，说明我们公司将如何从 .NET 2.0 切换到 .NET 3.5 中受益。我们是一家小公司，我们的 IT 部门只有 6 名程序员。我们主要编写 Windows 窗体，有时也编写 ASP.NET 和 Compact Framework 应用程序。我想听听这个决定的利弊。

### 编辑：

我个人知道 .NET 3.5 我只是不确定如何让我的主管相信我们需要它。

### 编辑2：

请注意，我的主管不是程序员（这是一个非常愚蠢的情况，但这是另一个故事），所以简单地告诉他 .NET 3.5 具有 LINQ 和其他东西什么也没告诉他。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-09T12:56:19.330

我知道很难用商业术语来量化，但是...... LINQ/lambda 表达式！

另外：您可以利用更高级别的 API，例如 Windows Presentation Foundation (WPF)、Windows Communication Foundation (WCF)、Windows Workflow Foundation（我想您已经明白了首字母缩略词的意思）。VS2008 也更适合用于 ASP.Net 的东西（将其作为更高的生产力出售。我在 vs2008 中没有完成足够多的 windows 窗体工作来提供任何建议）。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-09T13:23:21.607

值得打破这一点。

“从 2.0 迁移到 3.5”实际上是几件事（有些是可选的，有些不是）

1.  BCL 库的版本从 2.0 到 3.5
    *   这实际上主要是*增加*了一些库，例如负责 LINQ 的库。您熟悉的 2.0 中的库只有（次要）错误修复。
2.  编译器更改
    1.  从 c# 2.0 到 c# 3.0 的转变
        *   拉姆达表达式
        *   var 类型推断
        *   通过部分类大大改进了设计器支持
        *   LINQ（到对象、到 xml、到 sql
        *   匿名类型
        *   自动属性
        *   扩展方法
        *   和更多...
    2.  从 VB.Net 8.0 迁移到 VB.Net 9.0
        *   在 lamdas/LINQ/var 方面与 c# 非常相似
        *   XML 文字
3.  VS 2008 而不是 2005
    *   改进的智能感知（更快，更能容忍其中的故障，而不会影响整个应用程序）
    *   VS 2008 Professional 中的单元测试集成而不是团队系统
    *   比我在这里列出的更多的变化

您实际上需要迁移到 VS 2008 以实现 c# 编译器升级。
您可以升级编译器但不能迁移到 3.5 库，这意味着您会失去 Linq 的某些方面，除非您使用像 LinqBridge 这样的插件替代品。

这些升级中的每一个都有自己的优点（和一些缺点）。

对于您的需要，我想访问新的 MVC ASP.Net 可能会很有用。我对它没有个人经验，但它似乎被广泛认为是这种用途的一个很好的框架。

集成的测试功能意味着您可以免费使用它（我发现能够轻松地调试到我的单元测试中值得像 TestDriven.Net 这样的工具的价格，所以免费获得（一些）这个是有用的。

VS 2008 上改进的稳定性（和启动时间）对我非常有用。我还发现“转到定义”是一个非常有用的命令，它以惊人的速度加快了我的工作流程。

我赞同那些说新的 LINQ 相关语言增强功能很有用的人。我发现扩展方法`IEnumerable<T>`使某些过去需要多行样板代码和不必要的变量只需要一行（非常描述性）的任务。这减少了将功能分离为更多方法的需要并增强了可读性。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-09T12:57:16.287

你看过微软的“What's new”文档吗？恕我直言，好处是巨大的，因为 .NET 3.5 提供了 Linq 框架。我不能代表 ASP.NET，但总的来说，Linq to Object 非常强大并且可以提高生产力。

另一方面，成本相对较小（再次恕我直言），因为微软通过 Windows 的自动更新功能提供了新的 .NET 框架的轻松安装。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T12:58:46.533

如果你写 CF，我第一手知道 CF 3.5 比 CF 2.0 有了显着改进；一些棘手的[权限问题](http://marcgravell.blogspot.com/2008/11/cf-woes.html)已修复，您只需选择更多框架即可。诸如此类的简单事物`Delegate.CreateDelegate`可用于极大地优化事物。

在 winform 上，WPF 提供了另一种选择。对于 ASP.NET，MVC 成为一种选择。

哦，LINQ 可以满足您的所有查询需求；-p（尽管 C# 3.0 编译器也可以使用 .NET 2.0 + LINQBridge）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T13:32:51.850

这可能很明显，但您想告诉他为什么 3.5 中的[附加功能](http://msdn.microsoft.com/en-us/library/s57a598e.aspx)将有助于实现高级目标，例如：

1.  节省时间，从而节省金钱！
2.  提高质量
3.  提高互操作性（即与浏览器的兼容性）
4.  提高可管理性

不要用大量的术语来混淆这些功能的名称，告诉他这些新功能将帮助您实现什么。对他说行话只会使情况混乱。

给他估计升级所涉及的工作量，然后显示 3.5 的额外好处将大于估计的升级工作量多长时间！这是 ROI（投资回报率）

话又说回来，如果所有这一切都是一个延伸，那么请诚实一点：所有开发人员都想玩新的 .net 3.5 玩具，并熟练掌握最新和最棒的东西，这样我们就可以把它写在我们的简历上。这将是很棒的经验，并帮助我们在其他地方找到工作；-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-05T05:15:37.363

我可能为时已晚，无法回答这个问题并假设您最近的问题可能您实际上已迁移到 3.5。

您的问题是相关的，因为在很多情况下会出现这个问题，而且在很多情况下，我们的上级也没有任何技术背景，或者更关注开发成本和最终升级服务器或用户机器，以及他们是否有著名的投资回报率（返回投资）。

在我看来，迁移到 3.5 和最终 4.0 的最重要的好处是**生产力**。生产力是通过拥有最新的技术来实现的，这将为开发人员节省宝贵的时间、解决方法和一些令人头疼的问题。但大多数情况下，特别是对我来说，使用最新技术给了我动力，这将把我推向我学习和解决新问题的能力的极限。这个特定的点通常会被上级忽略，但在我的情况下是成功项目的隐藏点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-09T12:57:26.910

其中许多[功能](https://stackoverflow.com/questions/610199/the-art-of-programming-java-vs-c/610261#610261)都随 .Net 3.0 提供。不是全部，而是很多。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-09T13:02:42.890

为了强调 Joel 的观点，LINQ/Lambda 极大地减少了 UI 层中的错误数量。LINQ 不是最适合需要挤出每个周期的代码，但对于不需要 0.02 额外秒的代码来说，它很棒。微软已经做到了，你可以用自然语言编写循环，这是一个人的思想实际运作的方式。这使您不必担心循环索引、占位符数组、边缘情况等。自从我进行切换以来，我的（诚然很小的）UI 中没有一个错误。

此外，WCF 使 Web 通信、RESTful 服务器和进程间通信变得非常非常容易。我可以在大约 10 分钟内推出一个功能相当丰富的 RESTful 网络服务器。当然，我正在使用我们创建的一个库来处理 WCF 的一些重复，但否则可能需要 20 分钟。

如果您使用多线程，ReaderWriterLockSlim 提供了比 2.0 中的 ReaderWriterLock 的巨大速度改进，并且比 lock() 的改进更大。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-09T14:09:32.667

另一件事是您可以使用新的[Microsoft Chart Controls](http://www.microsoft.com/downloads/details.aspx?FamilyID=130f7986-bf49-4fe5-9ca8-910ae6ea442c&displaylang=en)，它们基本上是 Dundas Chart 的克隆，但它们是免费的。如果您需要图表功能，那么每台服务器将为您节省数百美元（假设您使用 ASP.NET）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-09T12:57:28.643

LINQ to SQL，不再为 1 个对象编写 4 个存储过程。

你会写一些，但只是为了提高速度和效率。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-09T13:53:00.320

我认为大多数其他答案已经获得了大部分关键概念。我想说的是，虽然来自 winforms 世界，但 WPf 和框架的客户端子集是巨大的。

我只是想补充一点，因为 3.5 实际上只是 2.0 之上的额外 dll，所以问题似乎是，为什么不切换。将项目文件转换为 VS2008 后，您的整个代码库应立即在 3.5 中运行。只要升级到新的VS没有问题，升级真的不应该有任何缺点。然后，您可以涉足新功能并在您认为合适时应用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-09T14:17:27.793

我在另一次谈话中说过这一点，但尽管 LINQ 很酷，我还是会谨慎地关注这一点。我们程序员喜欢衡量并提供无可争辩的结果，但我们似乎都毫无疑问地声称使用 LINQ“提高了生产力”。支持这些说法的研究结果在哪里？您如何在不借助模糊、无法衡量的数据的情况下在业务中推广这一点？

我建议放松这方面，因为缺乏具体证据只会在敏锐的头脑中产生怀疑。

专注于 CF 3.5 的改进和对 ASP.NET 的改进。该死的，他们甚至修复了 String.IsNullOrEmpty() 中的一个错误。升级的理由有很多。如果您不在 VS2008 上，那么值得更新，更快的构建时间，目标框架等。这是一个不错的升级。

另一点是，您可能会开始发现在 3.5 或 2008 中解决的问题，或者使用仅在最新版本中可用的代码或组件。想象一下被一个糟糕的问题卡住了，在网上找到了一个解决方案，但由于您使用的是旧版本而无法使用该修复程序。令人沮丧。

对于任何科技公司，您都应该升级。重点不在于证明升级的合理性，而是更多地规划何时何地进行更新是明智的，尤其是在向后兼容性大多很好的 .NET 版本升级中。

# c# - GetType、Managed CodeGen 中的 C# 疑问

> ID：626115
> 
> 赞同：1
> 
> 时间：2009-03-09T12:58:14.367
> 
> 标签：c#

考虑代码，

```
Type t0 = Type.GetType("System.Drawing.dll");
Type t1 = Type.GetType("System.Drawing.Font"); 
```

为了找到“System.Drawing.Font”的类型，需要“System.Drawing.dll”程序集。如何使用它。？

即，如果我这样做，那么**t0**的值不会为空。？？

考虑我有一个 dll，**proj.dll**，我需要找到 dll 中存在的类**Class1**的类型。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T13:01:48.070

指定程序集，包括强命名程序集的版本号：

```
Type t = Type.GetType("System.Drawing.Font,System.Drawing,"+
                      " Version=2.0.0.0, Culture=neutral, "+
                      "PublicKeyToken=b03f5f7f11d50a3a"); 
```

当然，如果它*真的*只是`System.Drawing.Font`（或您在编译时知道的另一种类型），请使用`typeof`：

```
Type t = typeof(System.Drawing.Font); 
```

如果您在编译时知道同一程序集中的另一种类型，则可以使用[`Assembly.GetType`](http://msdn.microsoft.com/en-us/library/y0cd10tb.aspx)：

```
Type sizeType = typeof(System.Drawing.Size);
Assembly assembly = sizeType.Assembly;
Type fontType = assembly.GetType("System.Drawing.Font"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T13:04:49.047

传递程序集的强名称以加载它，然后从中加载类型，例如

```
 Assembly asm = Assembly.Load("System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a");
            Type font = asm.GetType("System.Drawing.Font"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T13:01:49.567

你想要的[`System.Reflection.Assembly.Load`](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.load.aspx)方法。

# logic - 是否有任何工具可以帮助处理复杂的“如果”逻辑？

> ID：626120
> 
> 赞同：10
> 
> 时间：2009-03-09T13:00:04.110
> 
> 标签：logic

我个人的编程恶魔之一一直是需要由 if 语句（或类似语句）控制的复杂逻辑。也不一定总是那么复杂，有时只需要考虑几个状态。

开发人员在设计期间是否可以执行任何工具或步骤来帮助查看“状态”并采取措施重构代码以简化生成的代码？我正在考虑按照这些思路绘制一个矩阵或其他东西......？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-09T13:16:49.627

我会为每个有抱负的程序员推荐一门[命题逻辑的基础课程。](http://en.wikipedia.org/wiki/Propositional_logic)起初，符号和希腊字母可能会让厌恶数学的人感到反感，但它确实是你技能中最强大（也经常被忽视）的工具之一，而且核心相当简单。

[基本运算符](http://en.wikipedia.org/wiki/Logical_operator)、德摩[根](http://en.wikipedia.org/wiki/De_Morgan%27s_Laws)和[其他基本定律](http://en.wikipedia.org/wiki/Rule_of_inference)、[真值表](http://en.wikipedia.org/wiki/Truth_table)以及例如[析取和合取](http://en.wikipedia.org/wiki/Disjunctive_normal_form)范式[的存在](http://en.wikipedia.org/wiki/Conjunctive_normal_form)让我大开眼界。在我了解它们之前，条件表达式感觉就像是危险的野兽。从那以后，我知道我可以在必要时用重炮将他们鞭打！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T13:17:45.363

真值表基本上是详尽的方法，并将（希望）突出所有可能性。

您可能想看看[Microsoft Pex](http://research.microsoft.com/en-us/projects/Pex/)，它有助于发现您没有想到的边缘案例。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-10-21T00:11:34.307

我认为开发人员在问如何在处理复杂的 if 代码时让他的生活更轻松。

我处理复杂代码的方法是尽可能地编写代码并首先清除所有否定。如果您可以通过将其中的一部分放在上面来摆脱化合物，那么就这样做。

简单的美妙之处在于它不需要一本书或一堂课来学习它。如果你能打破它，就这样做。如果您可以删除它的任何部分，请执行此操作。如果你不明白，那就换个方式。而且 flat 几乎总是比嵌套好（感谢 python！）。

阅读起来更简单：

```
if(broken){
  return false;
}
if (simple){
  doit();
  return true;
}
if(complicated){
  divide();
  conquor();
}
if(extra){
  extra();
} 
```

而不是阅读：

```
if(!broken && (simple || complicated)){
 ....
}
return false; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T13:03:00.877

真值表和单元测试 - 绘制表格（n 个变量的 n 维），然后将它们用作单元测试的输入，单元测试可以测试变量的每个组合并验证结果。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T13:21:57.193

这些年来我看到的复杂 IF 的最大问题是人们不会测试所有的分支。确保为每个可能的分支编写一个测试，无论您看起来多么不可能碰到它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-09T13:36:46.783

您可能还想尝试[卡诺图](http://en.wikipedia.org/wiki/Karnaugh_map)，它适用于最多 4 个变量。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-09T13:40:47.837

如果您还没有，我强烈建议您阅读[Code Complete](https://rads.stackoverflow.com/amzn/click/com/0735619670)。它对诸如此类的主题有很多建议。我现在手边没有我的副本，否则我会在书中发布这部分的摘要。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-09T13:12:17.983

将逻辑分解为离散单元（a && b 等），每个单元都有自己的变量。然后使用您需要的逻辑构建这些。用适当的名称命名每个变量，以便您的复杂语句具有相当的可读性（尽管它可能会占用几行额外的行和相当多的临时变量）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-09T13:24:28.983

你有什么理由不能只用警卫语句处理逻辑？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-09T13:37:11.980

[卡诺图](http://en.wikipedia.org/wiki/Karnaugh_map)是从真值表（Visage 建议）中获取信息并将其转换为紧凑和/或/非表达式的好方法。这些通常在 EE 数字逻辑课程中教授。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-03-05T15:09:27.877

你试过设计模式吗？您可能会查看所谓的策略模式：[http ://en.wikipedia.org/wiki/Strategy_pattern](http://en.wikipedia.org/wiki/Strategy_pattern)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-05-11T12:32:47.227

查看核选项：[Drools](http://www.jboss.org/drools)。它有很多内容——我花了一两天时间阅读文献来了解它的功能。但是，如果您的应用程序中复杂的 if-then 逻辑是项目不断发展的一部分（例如，具有模块化算法的应用程序），那么它可能就是这样。

# c++ - 关于在 C++ 代码中使用 realloc 实现的问题

> ID：626123
> 
> 赞同：2
> 
> 时间：2009-03-09T13:02:03.110
> 
> 标签：c++, memory-management, realloc

朋友们

在我们的 C++ 中，我目前使用 realloc 方法来调整 malloc 分配的内存大小。realloc() 用法如下完成

```
my_Struct *strPtr =(my_struct*)malloc(sizeof(my_Struct));

/* an later */

strPtr = (my_struct*)realloc(strPtr,sizeof(my_Struct)*NBR); 
```

现在维基百科（_http://en.wikipedia.org/wiki/Malloc）说

如果相反，一个

```
void *p = malloc(orig_size);

/* and later... */

p = realloc(p, big_size); 
```

那么如果无法获得 big_size 字节的内存，p 的值为 NULL，并且我们不再有指向先前为 p 分配的内存的指针，从而造成内存泄漏

它还说纠正上述错误的正确方法是

```
void *p = malloc(orig_size);

/* and later... */

void *tmp = realloc(p, big_size); 

if (tmp != NULL)
 {

p = tmp; /* OK, assign new, larger storage to p */

} 

else 

{

/* handle the problem somehow */

} 
```

* * *

你能告诉我哪个是使用 realloc() 的最佳方式吗

同样，一旦我有了指向结构的指针，然后在稍后使用 realloc 时，我可以使用指向 void 的指针吗？

非常感谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T13:04:54.943

当然你必须防止`realloc()`返回的情况`NULL`。这是一种内存分配，在 C 中（其中`realloc()`）主要使用，我认为 C++ 程序员认为使用原始调用有点低级/qaint `realloc()`，内存分配总是会失败。

直接用返回值覆盖指针是错误的，因为这会丢弃原始指针并在重新分配失败的情况下导致内存泄漏。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T13:32:21.537

Malloc() 和 realloc() 是 C 函数。实际上， realloc() 执行 malloc() 和 free() 取决于您传递的参数：

*   如果你传递一个空指针，realloc 会做 malloc 做的事情。
*   如果您将其传递为零大小，则 realloc 会执行 free 的操作。

引自[这里](http://www.ddj.com/cpp/184403806)，你有更深入的解释。

C 库无法就地扩展内存块，因此 C++ 也不支持它。

如果您想坚持使用 C 函数，那么您应该在调用 realloc() 时保留第一次内存分配的指针。然后检查它是否为 NULL，否则分配它，就像在上一个代码中所做的那样。

但也许对于 C++，最好的解决方案是制作自己的 mallocator，即基于 C 的 malloc() 的 std 解决方案。检查[这个](http://blogs.msdn.com/vcblog/archive/2008/08/28/the-mallocator.aspx)，或者[这个](http://www.codeguru.com/cpp/cpp/cpp_mfc/stl/article.php/c4079)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T13:06:10.307

使用建议的方法——保持指向前一个缓冲区的指针，直到 realloc 成功返回。一旦 realloc() 成功返回前一个块已经被释放并且所有指向它的指针都变得悬空 - 调整它们。

realloc 和 malloc 不关心指针类型是什么——你可以使用 void* 以及任何东西*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T14:32:06.667

正如其他人所说，只需按照建议正确使用 realloc 即可。

但是这样做的“C++ 方式”实际上是使用 std::vector<> 而不是自己维护数组。这样，C++ 标准库将处理重新分配的低级细节（可能通过使用 realloc()）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T14:44:15.967

当 realloc() 失败并返回 NULL 时，原始内存保持不变。
所以你应该像这样使用它：

```
my_Struct* strPtr =(my_struct*)malloc(sizeof(my_Struct));

/* an later */

my_Struct* tmp = (my_struct*)realloc(strPtr,sizeof(my_Struct)*NBR);
if (tmp != NULL)
{
    strPtr = tmp;
}
else
{
    /* realloc Failed. Need to do something */
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T14:55:56.360

为什么要使用 malloc 和 realloc？C++ 中几乎总是有更好的方法。

如果您使用它来制作可变长度数组，则几乎可以肯定使用 std::vector<> 或其他容器模板之一会更好。

如果您使用 C 代替，可能使用支持 C++ 的编译器，那么正确的方法是第二种方法，它在分配失败时不会丢失整个内存块。

第二个问题的答案还取决于您使用的是 C 还是 C++。在 C 中，void * 是一种通用数据指针类型，可以自由转换。在 C++ 中，void * 需要显式转换。如果您实际上正在编写 C，则需要使用 malloc() 和朋友，它们适用于 void *。如果你真的在写 C++，你需要强制转换，这让它更尴尬。在这两种情况下，realloc() 都不适用于指向 struct 的指针，而是适用于指向 void 的指针。

# java - java swt表中的动态组合框列表

> ID：626131
> 
> 赞同：3
> 
> 时间：2009-03-09T13:03:33.697
> 
> 标签：java, eclipse, combobox, swt

我在 org.eclipse.swt.widgets.Table 中创建了一个组合框控件，代码片段如下

```
...
TableEditor editor = new TableEditor (table_LLSimDataFileInfo);
CCombo combo = new CCombo (table_LLSimDataFileInfo, SWT.NONE);
combo.setText("CCombo");
combo.add("item 1");
combo.add("item 2");
editor.grabHorizontal = true;
editor.setEditor(combo, items[i], 0);
... 
```

如何通过触发某些事件来动态更改表中选定行的组合框列表（例如，仅第 5 行的 item1、item2 等更改为 item4、item5、item7 等）。在我的情况下，事件是在另一个组合框中的选择，其列表不会改变

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T13:29:49.017

您应该在您的另一个 CCombo 上设置一个**[SelectionListener](http://kickjava.com/src/org/eclipse/swt/events/SelectionListener.java.htm)**，以便在您的第二个 CCombo 上调用更新。

这个[`WavAudioSettingComposite`](http://www.koders.com/java/fid9C4438C40B623EB84A35D689C67B14B71E6D1D97.aspx?s=ccombo+update+listener#L8)类就是一个很好的例子。

就像是：

```
public class ValueChanged extends SelectionAdapter {

    public void widgetSelected(SelectionEvent e) {
        if(e.getSource()==myFirstCCombo){
            // call update on your second CCombo
        }
    }
}

public void updateSecondCCombo(int[] newValues){
    int oldbitrate=getFramerate();
    mySecondCCombo.removeAll();

    for (int i = 0; i < newValues.length; i++) {
        mySecondCCombo.add(""+newValues[i]);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T13:24:05.257

[TableEditor](http://download.eclipse.org/eclipse/downloads/documentation/2.0/html/plugins/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/custom/TableEditor.html)文档显示了一个简单的示例，其中包含一个标识当前选定行的选择侦听器。

您只需要自定义此示例并根据所选行*动态*填充。`Combo`

# vb.net - 将字符转换为 ASCII 码

> ID：626132
> 
> 赞同：1
> 
> 时间：2009-03-09T13:03:44.837
> 
> 标签：vb.net, ascii

在阅读我的 VB 代码中的特殊字符时需要帮助。ASCII 码 Char(34) = " 工作正常，但 Char(60) = < 和 Char(62) = > 没有被读取。

我的代码

```
node.FirstChild.InnerText = Chr(60) & "httpRuntime executionTimeout=" & Chr(34) & "999999" & Chr(34) & " maxRequestLength=" & Chr(34) & "2097151" & Chr(34) & "/" & Chr(62) 
```

无 ASCII 码

```
'node.FirstChild.InnerText = "<httpRuntime executionTimeout="999999" maxRequestLength="2097151"/>" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T13:13:02.707

也许这不能回答您的问题，但您可以使用**两个双引号**来转义 VB.NET 中的引号字符：

```
node.FirstChild.InnerText = _
    "<httpRuntime executionTimeout=""999999"" maxRequestLength=""2097151"" />" 
```

我只是在猜测：您可以将该`String.Format`方法用于您的目的：

```
 node.FirstChild.InnerText = _
    String.Format( _
        "<httpRuntime executionTimeout=""{0}"" maxRequestLength=""{1}"" />", _
        timeoutValue.ToString(), reqLenValue.ToString()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T13:18:11.057

您是否尝试修改配置文件？尝试：-

```
node.FirstChild.InnerXml =  "<httpRuntime executionTimeout=""999999"" maxRequestLength=""2097151"" />" 
```

请注意，Chr marlarky 是不必要的，您是否试图避免`<`并将`>`其编码为 XML 实体？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T13:11:24.147

你需要提供更多关于你如何“看到”结果的信息。以我的经验，这方面的问题很可能是在调试器中查看字符串和首先获取正确的字符串。

`Chr(60)`除了引号之外，我真的不明白为什么你需要使用etc。当您只在代码中使用`<`and时会发生什么？`>`

我*强烈*建议您将字符串转储到控制台而不是使用调试器 - 调试器会尝试向您展示如何在代码中表示字符串，而不是逐字显示内容。

当然，如果这是 XML，那么我希望再次将 XML 序列化以最终转义`<`-`>`再次，有关您尝试做什么的更多信息会有所帮助。绝对*理想*（IMO）将是一个简短但完整的程序来演示问题 - 一个做一件事的小型控制台应用程序，以及您希望它做什么的描述。

# c# - 在调用函数 #1 时自动调用函数 #2

> ID：626139
> 
> 赞同：3
> 
> 时间：2009-03-09T13:05:01.620
> 
> 标签：c#, attributes, function-calls

这应该是一个快速的。是否有可能做这样的事情：

```
[Callback(funtionY)]
void functionX()
{
}

void functionY()
{
} 
```

这样在调用 functionX 时，也会自动调用 functionY 吗？我问的原因是因为我要为基于 XNA 的小型游戏引擎实现网络功能，并且我想将函数标记为同步，以标记在调用函数时应该在所有客户端上调用它。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T13:07:47.573

听起来你想要[Aspect-Oriented Programming](http://en.wikipedia.org/wiki/Aspect-oriented_programming)。

我以前用过[PostSharp](http://www.postsharp.org/)，效果很好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T13:07:52.487

[您可以使用PostSharp](http://www.postsharp.org/)很容易地做到这一点，但总的来说：不；你必须明确地调用它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T13:10:18.300

是的，您可以，只需将它们创建为代表即可。

```
Action foo = functionX;
foo += functionY;

foo(); // both called 
```

更新：乔恩（谢谢）指出调用顺序实际上是确定的。然而，我永远不会依赖这个。看评论。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T13:08:23.187

有什么原因你不能这样做：

```
void functionX()
{
    functionY();
    // ... etc
} 
```

根据问题中的描述，这是一个有效的答案。不过，我假设您已经考虑过了。

另一种可能性是使用事件系统对您有利，例如（未编译）：

```
event Action FunctionXCalled;

// somewhere in initialization...
MyCtor()
{
    FunctionXCalled += functionY;
}

void functionY() { }

void functionX()
{
    if(FunctionXCalled != null) FunctionXCalled();
    // ... etc
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T13:08:42.670

怎么样：

```
void functionX() {
   functionY();
   // Other implementation stuff
}

void functionY() {

} 
```

# windows - 帮我找到阻止我更改 excel 宏安全级别的注册密钥？

> ID：626149
> 
> 赞同：0
> 
> 时间：2009-03-09T13:07:00.100
> 
> 标签：windows, excel, com

我的自动测试框架使用我的团队提供的 excel 插件测试了客户所需的一堆 Excel 表格。为了测试工作表，我需要调用一些宏，这反过来又需要在测试服务器上将宏安全性设置为最低。（在生产中宏安全将打开）。特别是我需要抑制这个对话框：

![替代文字](https://farm4.static.flickr.com/3332/3340582143_d4891850a3.jpg?v=0)

一台特定的 PC 似乎拒绝我对其进行配置的尝试，将宏安全性从工具->宏->安全设置为低...我退出 Excel 并返回它，却发现宏安全性已恢复为“中等” "

我猜我继承了一台 PC，它的注册表设置阻止我降级安全性，我四处搜索发现“[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\11.0\Excel\Security]”，但是这似乎不起作用。

我想知道是否有另一种方法可以以编程方式（通过 COM）或通过简单的注册表编辑将宏安全性强制设置为最低设置。

更新：我在 Office 2003 上。我的电脑是其他用户的二手电脑，可能有各种配置不一致。在我负责的所有 PC 中，这个问题只影响一台机器。我拥有完整的管理员权限。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T13:13:10.523

HKEY_CURRENT_USER\Software\Microsoft\Office\12.0\Excel\Security\VBAWarnings=1 (REG_DWORD) 是您要查找的设置。它也可以作为机器范围的覆盖存在于 HKLM 下。位置也因办公版本而异；2003=11.0；2007=12.0。

最后，如果您处于托管 IT 环境中，请记住，组策略可能会为您改回来。

# python - 仅使用 python 加载捆绑的 python 框架依赖项

> ID：626157
> 
> 赞同：1
> 
> 时间：2009-03-09T13:09:37.177
> 
> 标签：python

我遇到了[这个问题](https://stackoverflow.com/questions/331377/)，但我不喜欢提出的解决方案。Shell 脚本依赖于操作系统。

这个问题有python解决方案吗？

我不是在寻找 python 到机器代码编译器，只是一种用 python 修改包含路径的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T13:17:18.360

一般来说，python 在尝试解析库依赖项时会遵循 sys.path 中的路径。`sys.path`是一个列表，它是按顺序搜索的。如果您的应用程序`sys.path`在加载时进行了修改以将其自己的库路径放在前面，那么这应该可以解决问题。

python 文档中的这一部分很好地解释了 python 如何找到其依赖项：[https](https://docs.python.org/reference/simple_stmts.html#the-import-statement) ://docs.python.org/reference/simple_stmts.html#the-import-statement 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T13:22:42.950

好吧，据我所知，关于如何做到这一点有很多不同的建议。

这里有 2 种方法可以帮助您分发您的应用程序

一世/

. 在我的项目目录结构中包含所有依赖项

. 在查看系统可用模块之前，操作 sys.path 以确保应用程序始终查看我的 dir 结构

（免责声明：如果涉及 C 库，此解决方案可能不起作用）

二/

另一种方法是使用[EasyInstall 和 egg 之](http://peak.telecommunity.com/DevCenter/PythonEggs)类的工具。这个解决方案可能有点复杂，但它会为您提供很大的自由来配置您的应用程序及其依赖项（此外，它将与 C 依赖项一起使用）。

./亚历克斯

# c++ - DLL 中的线程，其中 DLL 必须在子线程完成之前返回

> ID：626160
> 
> 赞同：0
> 
> 时间：2009-03-09T13:09:52.543
> 
> 标签：c++, multithreading, dll

我正在编写一个包装器 DLL，以将 yokogawa WT1600 功率计的通信 DLL 连接到基于 PC 的自动化包。我让通信部分开始工作，但我需要对其进行线程化，以便可以保持自动化包的 50 毫秒扫描时间。（扩展功能块 (EFB) 调用将阻止扫描，直到它返回）

这些是我需要做的步骤。

1.  调用 EFB
2.  EFB 创建一个线程来执行通信设置（大约需要 200 毫秒）
3.  EFB 在线程执行工作时返回 EFB_BUSY
    *   3a。（自动化程序继续扫描，直到它返回到 EFB 调用）
4.  调用 EFB 传入它在最后一次调用时返回忙
5.  EFB 检查线程是否已返回
6.  如果线程返回则EFB返回成功，否则返回EFB_BUSY
7.  重复 3a-6 直到 efb 返回成功

所以我的问题是，我如何创建一个在调用它的函数生命周期之后存在的线程？当我回调 DLL 时，如何获得该线程的返回值？

编辑#1

```
 HeavyFunction::HeavyFunction^ hf;  //HeavyFunction is a class that has a time consuming function in it
        ThreadStart^ efbThreadDelegate;
        Thread^ efbThread;

        if( pEfbData->nBlockingRecall != DOEFB_BUSY ) {
            hf  = gcnew HeavyFunction::HeavyFunction;
            hf->iiStart = (int)(pEfbData->uParams[0].dw);
            hf->iiEnd = (int)(pEfbData->uParams[1].dw);
            efbThreadDelegate = gcnew ThreadStart( hf, &HeavyFunction::HeavyFunction::iGetPrime );
            efbThread = gcnew Thread( efbThreadDelegate );
            efbThread->Start();
            return DOEFB_BUSY;
        }else if ( efbThread->IsAlive ) {
            return DOEFB_BUSY;
        }else {
            uRetValue->dw = hf->iReturn;
            return 0;
        } 
```

efbThread 在后续调用中是否仍具有相同的线程句柄？

编辑#2

我通过为 Mutex 和线程创建全局 HANDLE 来使其工作。在 init 入口点初始化互斥锁（在加载 dll 时完成）并在实际调用 dll 时在 main 函数中创建线程。

我使用了[MSDN 中的示例代码：Creating Threads](http://msdn.microsoft.com/en-us/library/ms682516%28VS.85%29.aspx)作为我的模型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T13:43:35.723

创建的任何线程（无论是在 DLL 中还是在其他地方）都不会自发停止。特别是，创建线程的函数可能会返回。即使创建者线程退出，新线程仍将运行。也就是说，假设它没有到达其入口函数的末尾。

Windows 线程在准备好后返回一个 DWORD。要查看，请在线程句柄上调用 WaitForSingleObject ，超时时间为 0 秒，如果成功，请调用 GetExitCodeThread 。

不过，我不了解您的整个“EFB”内容，既不了解它的含义，也不了解它的作用。如果它对正常的 Windows 线程做有趣的事情，那么所有的赌注都没有了。

# air - 有没有办法找到 Adob e Air 应用程序的自签名证书何时到期？

> ID：626166
> 
> 赞同：0
> 
> 时间：2009-03-09T13:12:10.010
> 
> 标签：air, certificate

我必须发布我的 Adob​​e Air 应用程序，但构建过程是由不同的开发人员“设置”的。（他制作了一个自签名证书并编写了一个批处理文件来调用 adt 来打包应用程序）。

Adobe 提到此类自签名证书的有效期为 5 年。现在我不知道该证书何时到期，因为我不知道它何时创建。

我安装的应用程序是否会在到期时停止工作，或者只有新安装会失败？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T05:55:23.907

唯一可能的方法是检查证书文件上的时间戳。只有新安装会在 5 年后失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T13:36:35.443

`migrate`您正在寻找`adt`. 如果证书过期，您可以更新您的空中应用程序以使用新证书。[在此处](http://help.adobe.com/en_US/AIR/1.5/devappshtml/WS13ACB483-1711-43c0-9049-0A7251630A7D.html)阅读有关更新 AIR 1.5 应用程序的更多信息。我还建议您看看[这个](http://help.adobe.com/en_US/AIR/1.1/devappsflex/WS5b3ccc516d4fbf351e63e3d118666ade46-7ff2.html)页面（这是关于升级 AIR 1.1 应用程序的——以防万一您不在 1.5 上）。

# sql-server - 如何确定报告服务器上的 SQL Server 版本

> ID：626173
> 
> 赞同：3
> 
> 时间：2009-03-09T13:13:31.333
> 
> 标签：sql-server, reporting-services, servicepacks

我们所有的报告服务生产实例都分为 Web 服务器组件和报告数据库组件。

我知道您可以通过以下 TSQL 检测数据库服务器上的 SQL Server 实例：

```
SELECT SERVERPROPERTY('productversion'), SERVERPROPERTY ('productlevel'),
SERVERPROPERTY ('edition') 
```

但是，在我们的例子中，报告服务器没有安装数据库服务器组件。那么在这种情况下如何检测安装了什么服务包呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T13:21:15.450

手动或使用网页抓取，浏览到

```
http://reportServerName/ReportServer 
```

版本号在页面底部。

或以编程方式：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;
using System.Web;
using System.Web.Services;
using System.Web.Services.Protocols;

class Sample
{
    static void Main(string[] args)
    {
        // Create proxy object and set service 
        // credentials to integrated
        ReportingService2006 rs = new ReportingService2006();
        rs.Url = "http://<Server Name>/_vti_bin/ReportServer/" +
            "ReportService2006.asmx";
        rs.Credentials = 
            System.Net.CredentialCache.DefaultCredentials;

        try
        {
            // Set the server info header 
            rs.ServerInfoHeaderValue = new ServerInfoHeader();

            // Make a call to the Web service
            CatalogItem[] items = rs.ListChildren("/");

            // Output the server version and edition to the console
            Console.WriteLine("Server version: {0}",
               rs.ServerInfoHeaderValue.ReportServerVersionNumber);
            Console.WriteLine("Server edition: {0}",
               rs.ServerInfoHeaderValue.ReportServerEdition);
        }

        catch (Exception e)
        {
            Console.WriteLine(e.Message);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-24T11:07:29.963

在您的浏览器中转到

```
http://<reportserverName>/reportserver 
```

只看页面底部

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T13:30:39.110

[Reporting Services 配置工具](http://msdn.microsoft.com/en-us/library/ms156305.aspx)详细说明了正在运行的SQL Server 版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-19T23:12:09.800

在现代 2017 版本中，“帮助 | 关于”效果很好。

# iphone - iPhone 上的 applicationShouldTerminate 问题

> ID：626175
> 
> 赞同：1
> 
> 时间：2009-03-09T13:14:45.497
> 
> 标签：iphone

我遇到了 applicationShouldTerminate 的问题。

我所做的一切接缝都没有效果。任何帮助，将不胜感激。

我精通编程，但这只是让我头疼。我正在阅读一些 xcode 的基本教程，因为我一般是 mac 新手，目前正在研究一个简单的手电筒应用程序。

它存在，但我想在此处添加一个带有不退出选项的警告框。

```
(void)applicationWillTerminate:(UIApplication *)application
{
    [application setIdleTimerDisabled:NO];
} 
```

这没有效果，警报甚至在创建之前就关闭了。

```
(void)applicationWillTerminate:(UIApplication *)application
{
    [application setIdleTimerDisabled:NO];
    UIAlertView *alertTest = [[UIAlertView alloc]
                          initWithTitle:@"This is a Test"
                          message:@"This is the message contained
                          with a UIAlertView"
                          delegate:self
                          cancelButtonTitle:@"Button #1"
                          otherButtonTitles:nil];

    [alertTest addButtonWithTitle:@"Button #2"];
    [alertTest show];
    [alertTest autorelease];

    NSLog(@"Termination");
} 
```

我在网上做了一些阅读，发现应该可以做到这一点

```
(NSApplicationTerminateReply)applicationShouldTerminate:(NSApplication*)sender 
```

但无论我把声明放在哪里，我都会收到错误：NSApplicationTerminateReply 之前的语法错误。

除了 xcode 似乎没有将 NSApplicationTerminateReply 识别为有效输入之外，没有语法错误。

任何示例代码将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T14:05:44.813

我知道这是一个非答案，但希望我能有所帮助：

显示“真的退出？”这样的警报，即使您可以在技术上完成（我不确定您是否可以），也是一个坏主意，并且可能会导致 App Store 被拒绝，或者在最好的，不一致的用户体验，因为没有其他应用程序这样做。

iPhone 应用程序的惯例是在必要时保存状态，然后在用户点击主页按钮或切换应用程序时尽快让出控制权（用于终止）。

为了确保一致的体验，Apple 可能设置了一个激进的计时器来限制您在`applicationWillTerminate`. 即使他们没有适当的技术措施，他们也可能有 App Store 批准政策，以确保应用程序在被要求时立即退出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T14:40:57.160

1.  iPhone 上不存在 applicationShouldTerminate 和 NSApplication。你必须使用 UIApplication。

2.  警报视图永远不会显示，因为“show”方法不会阻塞，因此，在您创建警报视图并尝试显示它之后，会立即到达“applicationWillTerminate”的末尾。我相信这是设计使然。您不能真正在“applicationWillTerminate”中开始异步操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T13:32:41.007

我想我找到了我想做的事情的答案，但是当我回到家时需要检查一下。[在这里](https://stackoverflow.com/questions/411436/what-happens-to-an-iphone-app-when-iphone-goes-into-stand-by-mode)找到了一些方向

[http://blog.minus-zero.org/](http://blog.minus-zero.org/)

> iPhone 2.0 软件最近发布，用户可以从 iPhone UI 或通过 iTunes 将本地应用程序（即，不是网站）直接下载到他们的手机。开发人员（任何向 Apple 支付 59 英镑以获得特权的人）然后可以编写自己的应用程序并在 App Store 中购买。
> 
> Apple 认可的 SDK 的一个限制是一次只允许运行一个应用程序。这给 IM 客户端、音乐播放器和其他功能依赖于能够在后台运行的程序等应用程序带来了问题。另一个例子（由 James 提供）是一个应用程序，它利用 iPhone 3G 的 GPS 芯片来创建您访问的所有地点的日志。
> 
> 但是，我发现了一个巧妙的技巧：您的应用程序只有在您切换离开它时才会终止，并且在您的应用程序处于前台时按下 iPhone 的电源按钮不算作切换。这样做的结果是您可以创建在 iPhone 放在口袋中时继续运行的应用程序 - 非常适合 GPS 示例。
> 
> `UIApplication`实现这一点就像在您的委托中实现两个方法一样简单 -`applicationWillResignActive:`和 `applicationDidBecomeActive:`. 这是一个简单的例子来演示效果。
> 
> 在您的`UIApplication`委托头文件中，添加一个新的`ivar: BOOL activeApp`. 然后，在您的实现中，添加以下三个方法：
> 
> ```
> - (void)applicationWillResignActive:(UIApplication *)application {
>   NSLog(@"resigning active status...");
>   activeApp = NO;
>   [self performSelector:@selector(sayHello) withObject:nil afterDelay:1.0];
> }
> 
> - (void)applicationDidBecomeActive:(UIApplication *)application {
>   NSLog(@"becoming the active app...");
>   activeApp = YES;
> }
> 
> - (void)sayHello {
>   NSLog(@"Hello!");
>   if (!activeApp)
>     [self performSelector:@selector(sayHello) withObject:nil afterDelay:1.0];
> } 
> ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-01T12:07:37.893

关于 applicationShouldTerminate 错误，以防万一有人好奇， NSApplicationTerminateReply 和 NSApplication 似乎已被弃用......即使 OP 的方法正是它在文档中的显示方式！

如下定义您的方法应该没有错误：

```
-(BOOL)applicationShouldTerminate :(UIApplication *)application 
```

# .net - 当 Key 和 Value 相同时使用字典？

> ID：626187
> 
> 赞同：4
> 
> 时间：2009-03-09T13:18:46.157
> 
> 标签：.net, collections, string

我想在静态“集合”中保存大约 30 个字符串。然后，我需要根据该列表检查传入 Web 请求的路径。

我正在考虑使用具有相同值的键和值的 StringDictionary。然而，当我真正想要的是一个键查找时，这似乎很奇怪，所以我可以检查是否存在而不是查找要使用的值。

我什么都不担心吗？

拍

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T13:20:01.363

您使用什么语言？

.NET 支持[Hashset<>](http://msdn.microsoft.com/en-us/library/bb359438.aspx)，这符合您的描述。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T13:19:52.223

如果您只需要一个键查找来检查是否存在，请改用 Set。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T13:40:50.737

我同意关于 set 的用途的评论 - 但在 3.5 版之前，.NET 也没有*set*类型。您可以轻松获得的最接近（仅使用内置库而不是编写自己的集合）是值无关紧要的字典。

但是，我想知道 3.5 之前的 .NET 中是否只有 30 个字符串，a`List<string>`可能不是票。我们知道散列集非常适合*大*集合，但是*如果*您知道您使用的是一小部分字符串，那么简单的`List<string>.Contains`调用将相当快。`String.Equals`可以检查长度开始，然后检查每个字符，所以它可能会很快拒绝不匹配。

简而言之，`HashSet<string>`如果您使用的是 .NET 3.5，`List<string>`如果您使用的是 .NET 2.0 或 3.0，或者`ArrayList`如果您使用的是 .NET 1.1，我可能会使用它。那应该给出最简单的调用代码，并且性能可能很好。如果您认为它正在成为瓶颈，请使用探查器证明这一点。

# iphone - 确定 UIView 的可用区域

> ID：626191
> 
> 赞同：1
> 
> 时间：2009-03-09T13:19:34.003
> 
> 标签：iphone, objective-c, cocoa

我是一个 iPhone 开发新手，我遇到了一个问题，当 UIViews 的控制器是 UITabController 的一部分时，我可以使用多少 UIView。我将窗口初始化为

```
window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]]; 
```

并且认为

```
myView = [[UIView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame]]; 
```

窗口返回为 320x480，视图为 320x460（我假设 20 像素的差异是顶部的状态栏）。

但是，视图是 UITabController 的一部分，我不知道在考虑该选项卡栏时如何计算可用空间量。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T13:43:34.600

我假设您正在以编程方式创建视图并尝试在选项卡控制器中动态布局。使用 OS 上的 UIViewAutoresizing 和信任来为你做这件事。

在我花时间了解如何使用灵活属性将元素锁定在某些位置之前，我遇到了类似的麻烦。当您使用选项卡控制器切换所选视图时，操作系统将自动调整视图大小以适应。

```
UIViewAutoresizingFlexibleTopMargin - Locks the location of an object with regards to the bottom.
UIViewAutoresizingFlexibleBottomMargin - Locks with regards to the top.
UIViewAutoresizingFlexibleWidth - Keeps the object the same distance from the left and right edges.
UIViewAutoresizingFlexibleHeight - Keeps the object the same distance from the top and bottom edges. 
```

顶部和底部起初似乎是向后的，直到您意识到定义允许更改的边距。

要以编程方式进行配置，您需要设置视图的 autoresizingMask：

```
[myView setAutoresizingMask:UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleBottomMargin]; 
```

# php - 如何使用 PHP 同步两个数据库表？

> ID：626192
> 
> 赞同：6
> 
> 时间：2009-03-09T13:19:39.820
> 
> 标签：php, mysql, synchronization

我需要使用 PHP 将数据从一个 MySQL 数据库复制到另一个数据库。

我可以构建和排列所有值以进入另一个数据库，但首先我想确保数据库在插入之前具有正确的字段。

例如，假设我要将数据从 tableA 复制到 tableB。

我可以将 tableB 设置为看起来像 tableA 但将来我可能会向 tableA 添加列而忘记将它们添加到 tableB，然后我的 PHP 脚本将尝试将数据插入到 tableB 中不存在的列中，它会失败。

所以我想做的是将tableA与tableB进行比较，并且tableA具有tableB的任何列都没有将它们添加到tableB。

谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-17T15:00:57.747

谢谢大家，基于您的所有帮助，我能够编写一个 PHP 类，如果它们不存在，则将表 A 中的任何列复制到表 B：

```
class MatchTable 
{
    var $_table_one_name;
    var $_table_two_name;

    var $_table_one_db_user;
    var $_table_one_db_pass;
    var $_table_one_db_host;
    var $_table_one_db_name;

    var $_table_two_db_user;
    var $_table_two_db_pass;
    var $_table_two_db_host;
    var $_table_two_db_name;

    var $_table_one_columns = array();
    var $_table_two_columns = array();
    var $_table_one_types = array();
    var $_table_two_types = array();

    var $_table_one_link;
    var $_table_two_link;

    var $_isTest;

    function MatchTable($isLive = true)
    {
        $this->_isTest = !$isLive;
    }

    function matchTables($table1, $table2)
    {
        $this->_table_one_name = $table1;
        $this->_table_two_name = $table2;

        if(isset($this->_table_one_db_pass))
        {
            $this->db_connect('ONE');
        }
        list($this->_table_one_columns,$this->_table_one_types) = $this->getColumns($this->_table_one_name);

        if(isset($this->_table_two_db_pass))
        {
            $this->db_connect('TWO');
        }
        list($this->_table_two_columns,$this->_table_two_types) = $this->getColumns($this->_table_two_name);

        $this->addAdditionalColumns($this->getAdditionalColumns());
    }

    function setTableOneConnection($host, $user, $pass, $name)
    {
        $this->_table_one_db_host = $host;
        $this->_table_one_db_user = $user;
        $this->_table_one_db_pass = $pass;
        $this->_table_one_db_name = $name;
    }

    function setTableTwoConnection($host, $user, $pass, $name)
    {
        $this->_table_two_db_host = $host;
        $this->_table_two_db_user = $user;
        $this->_table_two_db_pass = $pass;
        $this->_table_two_db_name = $name;
    }

    function db_connect($table)
    {
        switch(strtoupper($table))
        {
            case 'ONE':
                $host = $this->_table_one_db_host;
                $user = $this->_table_one_db_user;
                $pass = $this->_table_one_db_pass;
                $name = $this->_table_one_db_name;
                $link = $this->_table_one_link = mysql_connect($host, $user, $pass, true);
                mysql_select_db($name) or die(mysql_error());
            break;
            case 'TWO';
                $host = $this->_table_two_db_host;
                $user = $this->_table_two_db_user;
                $pass = $this->_table_two_db_pass;
                $name = $this->_table_two_db_name;
                $link = $this->_table_two_link = mysql_connect($host, $user, $pass, true);
                mysql_select_db($name) or die(mysql_error());
            break;
            default:
                die('Improper parameter in MatchTable->db_connect() expecting "one" or "two".');
            break;
        }
        if (!$link) {
            die('Could not connect: ' . mysql_error());
        }
    }

    function getColumns($table_name)
    {
        $columns = array();
        $types = array();
        $qry = 'SHOW COLUMNS FROM '.$table_name;
        $result = mysql_query($qry) or die(mysql_error());
        while($row = mysql_fetch_assoc($result))
        {
            $field = $row['Field'];
            $type = $row['Type'];
            /*
            $column = array('Field' => $field, 'Type' => $type);
            array_push($columns, $column);
            */
            $types[$field] = $type;
            array_push($columns, $field);
        }
        $arr = array($columns, $types);
        return $arr;
    }

    function getAdditionalColumns()
    {
        $additional = array_diff($this->_table_one_columns,$this->_table_two_columns);
        return $additional;
    }

    function addAdditionalColumns($additional)
    {
        $qry = '';
        foreach($additional as $field)
        {
            $qry = 'ALTER TABLE '.$this->_table_two_name.' ADD '.$field.' '.$this->_table_one_types[$field].'; ';

            if($this->_isTest)
            {
                echo $qry.'<br><br>';
            }
            else
            {
                mysql_query($qry) or die(mysql_error());
            }
        }
    }

    /**
     * End of Class
     */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T13:36:36.380

我不是 100% 确定这就是你要找的东西，但我曾经做过一些数据库维护。我们需要一种方法来确保 devDB 和 prodDB 在结构上是相同的，我找到了这个漂亮的小工具。该工具会创建一个 sql-alter-script，可以在您要修补的数据库上运行。它是用 perl 编写的，所以我想它应该可以跨平台工作，但我只在 linux 上尝试过。

该工具名为 mySQLdiff，是免费软件，可在[www.mysqldiff.org](http://www.mysqldiff.org)下载。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T12:33:09.363

您可以查看一些为您执行此操作的 phpclasses [http://www.phpclasses.org/search.html?words=mysql+sync&x=0&y=0&go_search=1](http://www.phpclasses.org/search.html?words=mysql+sync&x=0&y=0&go_search=1)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T13:23:29.873

```
SHOW COLUMNS FROM «table» 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T13:30:48.577

您可以编写一个从表中返回列的函数，例如：

```
function columns($table) {

    $columns = array();
    $sql = "desc $table";
    $q = mysql_query($sql);

    while ($r = mysql_fetch_array($q)) {

       $columns[] = $r[0];

    }

    return $columns;

} 
```

接下来，您可以比较两个表中的列：

```
function tables_different($table1, $table2) {

  $cols1 = columns($table1);
  $cols2 = columns($table2);

  return count(array_diff($cols1, $cols2)) ? true : false;

} 
```

现在，您可以将 tables_different() 函数集成到数据传输脚本中，每次运行它以确保表相同。

当然，您可以让它更有趣，让它告诉您两个表之间哪些列不同，从而使同步它们更有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T13:32:53.440

这是一项非常复杂的任务，据我所知，到目前为止，许多人都试图解决它（不幸的是，我不知道有任何 100% 保证的解决方案）。

我想说的是，在开始实施您自己的解决方案之前，您应该通过阅读模式演变、模式重构、模式版本控制等内容来了解​​您将面临的挑战。

之后，您可以查看[PHP MDB2_Schema （](http://pear.php.net/package/MDB2_Schema/)[本文](http://www.devx.com/webdev/Article/39102)中的更多文档）。

如果您不依赖 PHP，那么您还可以查看[Sundog](http://www.sundog.net/index.php/databaserefactoring)，它提供了一组高级模式重构。

一旦您为您的应用程序获得了可靠的架构迁移工具，迁移数据将只是一项微不足道的任务。

./亚历克斯

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T13:56:07.627

可能最简单的方法是

```
$sql = "SELECT * FROM tableA WHERE 1"

$results = mysql_fetch_assoc($sql);

$sql = "truncate table tableB";

// run truncate

foreach($result as $update){

   $sql = "Insert into table b VALUES(....)"

   // run insert
} 
```

但是在这里你需要非常小心。确保唯一可以写入 tableB 的进程是从 tableA 复制的进程，否则您将丢失数据。还要确保一旦此过程开始，就没有任何东西可以写入 tableA。

最好的做法是不在 php 中执行此操作，而是通过 mysql 复制。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-09T15:22:18.823

使用 TOAD for MySQL Schema 比较工具，它将查看表，直观地显示差异并生成 SQL 查询以同步表结构。它还进行数据比较。

# asp.net - 使用 SharpZipLib 在 .net 中通过 http 流式传输 zip 文件

> ID：626196
> 
> 赞同：12
> 
> 时间：2009-03-09T13:20:16.043
> 
> 标签：asp.net, http, zip, stream

我正在制作一个简单的下载服务，以便用户可以从外部站点下载他的所有图像。为此，我只需将所有内容压缩到 http 流。

但是，似乎所有内容都存储在内存中，并且直到 zip 文件完成并且输出关闭时才发送数据。我希望服务立即开始发送，而不是使用太多内存。

```
public void ProcessRequest(HttpContext context)
{
    List<string> fileNames = GetFileNames();
    context.Response.ContentType = "application/x-zip-compressed";
    context.Response.AppendHeader("content-disposition", "attachment; filename=files.zip");
    context.Response.ContentEncoding = Encoding.Default;
    context.Response.Charset = "";

    byte[] buffer = new byte[1024 * 8];

    using (ICSharpCode.SharpZipLib.Zip.ZipOutputStream zipOutput = new ICSharpCode.SharpZipLib.Zip.ZipOutputStream(context.Response.OutputStream))
    {
        foreach (string fileName in fileNames)
        {
            ICSharpCode.SharpZipLib.Zip.ZipEntry zipEntry = new ICSharpCode.SharpZipLib.Zip.ZipEntry(fileName);
            zipOutput.PutNextEntry(zipEntry);
            using (var fread = System.IO.File.OpenRead(fileName))
            {
                ICSharpCode.SharpZipLib.Core.StreamUtils.Copy(fread, zipOutput, buffer);
            }
        }
        zipOutput.Finish();
    }

    context.Response.Flush();
    context.Response.End();
} 
```

我可以看到工作进程内存在制作文件时增长，然后在完成发送后释放内存。我如何在不使用太多内存的情况下做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-09T13:23:04.027

[禁用响应缓冲](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.bufferoutput.aspx)并从代码末尾`context.Response.BufferOutput = false;`删除`Flush`调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T13:25:14.877

使用 Response.BufferOutput = false; 在 ProcessRequest 开始时并在每个文件之后刷新响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-09T09:26:08.127

供参考。这是递归添加整个文件树的工作代码，并流式传输到浏览器：

```
string path = @"c:\files";

Response.Clear();
Response.ContentType = "application/zip";
Response.AddHeader("Content-Disposition", string.Format("attachment; filename=\"{0}\"", "hive.zip"));
Response.BufferOutput = false;

byte[] buffer = new byte[1024 * 1024];
using (ZipOutputStream zo = new ZipOutputStream(Response.OutputStream, 1024 * 1024)) {
    zo.SetLevel(0);
    DirectoryInfo di = new DirectoryInfo(path);
    foreach (string file in Directory.GetFiles(di.FullName, "*.*", SearchOption.AllDirectories)) {
        string folder = Path.GetDirectoryName(file);
        if (folder.Length > di.FullName.Length) {
            folder = folder.Substring(di.FullName.Length).Trim('\\') + @"\";
        } else {
            folder = string.Empty;
        }
        zo.PutNextEntry(new ZipEntry(folder + Path.GetFileName(file)));
        using (FileStream fs = File.OpenRead(file)) {
            ICSharpCode.SharpZipLib.Core.StreamUtils.Copy(fs, zo, buffer);
        }
        zo.Flush();
        Response.Flush();
    }
    zo.Finish();
}

Response.Flush(); 
```

# powershell - 如何使 PowerShell V2 远程处理与 Windows Server 2003 一起工作？

> ID：626197
> 
> 赞同：2
> 
> 时间：2009-03-09T13:20:30.817
> 
> 标签：powershell, windows-server-2003, powershell-remoting

我正在测试 PowerShell 远程处理：

1.  我在我的 Windows XP 桌面上安装了[PowerShell V2 CTP3](http://go.microsoft.com/fwlink/?LinkID=131969)
2.  我在我的 Windows 2003 R2 服务器上安装了[WS-Management v1.1](http://www.microsoft.com/downloads/details.aspx?FamilyID=845289ca-16cc-4c73-8934-dd46b5ed1d33&DisplayLang=en)，它禁用了防火墙并且没有安装 PowerShell。
3.  两台机器都有 .NET Framework 3.5 SP1

当我在桌面上打字时：

```
Get-WmiObject -ComputerName computerNameHere Win32_Service 
```

我收到以下错误：

```
Get-WmiObject : Access denied. (HRESULT exception: 0x80070005 (E_ACCESSDENIED)) 
```

我还需要做什么才能完成这项工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T14:07:29.940

它与远程处理无关。XP/2003 不支持 PowerShell Remoting，仅支持 Vista/2008 及更高版本（尽管在接下来的几个月内应该为 XP/2003 发布 WSMan 更新）。

你有远程盒子的管理员权限吗？如果没有，请尝试使用凭证参数：

Get-WmiObject -ComputerName computerNameHere Win32_Service -Credential $cred

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T13:44:45.067

PSH V2 使用[WinRM 2.0](https://connect.microsoft.com/wsman)（*不是 1.1*），目前仅提供 CTP 形式，且仅限于 Vista 和 2008。

PSH 团队博客条目已经提到（IIRC）这是一个 CTP 限制，但目前尚不清楚它将如何解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T02:15:44.343

另一种方法是使用另一种远程解决方案，例如 /n 软件 PowerShell 服务器：www.nsoftware.com/powershell/

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-22T00:50:40.297

用户遇到的问题与 PowerShell Remoting 无关。 `Get-WmiObject -ComputerName computerNameHere`改用**WMI 远程处理**。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-06T01:54:30.607

虽然这篇文章更多的是关于 wmi 而不是 powershell 远程处理，但这是我在 windows 2003 机器上使用 powershell 远程处理的经验。它适用于管理员用户。但是，在 2003 年与非管理员用户进行远程处理时，您可以正常运行 powershell cmdlet，但不能运行任何。

[http://powershell.com/cs/forums/t/16205.aspx](http://powershell.com/cs/forums/t/16205.aspx)

# subsonic - 架构更改和亚音速 - VS 2008

> ID：626198
> 
> 赞同：0
> 
> 时间：2009-03-09T13:20:45.480
> 
> 标签：subsonic

我一直在使用亚音速，我一直遇到的问题是当我进行架构更改时，我必须重新编译所有内容，有时亚音速无法识别某些架构更改。

有没有更好的 OR/M 可以让我使用 asp.net，它在处理架构更改时更有效

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T13:29:10.627

我在使用 SubSonic 生成类时从来没有遇到过任何问题。您确定您的架构是一个好的架构吗？你遵守[约定](http://subsonicproject.com/setup/subsonic-conventions/)吗？如果未生成某些表，您可能会丢失 PK，但如果您查看生成的类，它会告诉您（在评论中）就是这种情况。这就是我根据您提供的信息所能给出的所有建议。我仍然认为问题不是SubSonic...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T15:47:54.380

如果您使用的是 BuildProvider，则存在已知问题，有时您可能需要编辑 web.config 以使其重建，您也可以尝试使用 SubCommander (sonic.exe) 为您生成类。

您也可以尝试 NHibernate 查看[http://www.summerofnhibernate.com/](http://www.summerofnhibernate.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T22:59:16.953

我建议 LLBLGen PRO。它不是免费的，但物有所值。我已经在 Web 和 Windows 应用程序上使用它超过 4 年了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T14:09:13.693

您正在使用什么数据库以及未显示哪些架构更改。根据我使用 SubSonic 的经验，我从来没有在生成的类中出现任何架构更改。我见过人们犯的最大错误是在他们的数据库中添加一个表，运行 SubCommander 来生成他们的类，然后忘记在他们的项目中包含生成的类。

我看到人们提出的唯一其他相关问题是，如果您在单独的类中生成类，并且它们都是用 C# 生成的，并且使用这些类的项目是用 VB 编写的。VB 无法读入 C# 项目，因此您首先需要构建 C# 项目以查看 VB 项目中的架构更改。这是VB的局限之一。

# c++ - 重载 << 运算符 C++ - 指向类的指针

> ID：626199
> 
> 赞同：4
> 
> 时间：2009-03-09T13:21:09.957
> 
> 标签：c++, pointers, operator-overloading

```
class logger {
 ....
};

logger& operator<<(logger& log, const std::string& str)
{
    cout << "My Log: " << str << endl;
    return log;
}

logger log;
log << "Lexicon Starting"; 
```

工作正常，但我想使用指向类实例的指针。IE

```
logger * log = new log();
log << "Lexicon Starting"; 
```

这可能吗？如果是这样，语法是什么？谢谢

编辑：编译器错误是

```
error: invalid operands of types 'logger*' and 'const char [17]' to binary 'operator<<' 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-09T13:24:57.373

您必须取消引用指向您的记录器对象的指针，并且显然检查它是否不是 0。这样的事情应该可以完成这项工作：

```
 log && ((*log) << "Lexicon starting") 
```

总的来说，我会回避通过指针引用像记录器这样的对象（您通常无条件地希望存在），因为指针不确定，AKA 是否存在对象？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T13:24:26.003

这是方法：

```
logger * log = new log();
(*log) << "Lexicon Starting"; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-09T13:30:14.397

为什么不使用参考？

```
logger & log = *(new log()); 
// the above is abhorrent code that 
// should be replaced by something meaningful

log << "Lexicon Starting"; 
```

如果这不是你想要的，我会选择[Timo Geusch](https://stackoverflow.com/questions/626199/overloading-operator-c-pointer-to-class/626215#626215)，即使它很丑

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T13:28:59.253

根据您获取记录器的上下文，您可能希望返回引用而不是指针：

```
...
Logger& logger() {
    return *_pLogger;
}
...

Logger& log = logger();
log << "..."; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T13:29:48.953

并不真地。`new log( )`有指针类型，`"Lexicon starting"`有类型`const char[16]`。如果至少一个参数具有用户定义的类型，则只能重载运算符。

decasteljau 正确地指出`(*log)`，如果你想要指针，你可以通过 来做到这一点。但是，我不喜欢指针。Andrei Alexandrescu 在“现代 C++ 设计”中花了很多篇幅介绍智能记录器单例，可能值得参考。

# php - ViewSVN 无法运行说不受支持的 URL

> ID：626203
> 
> 赞同：0
> 
> 时间：2009-03-09T13:22:35.353
> 
> 标签：php, svn

我正在尝试设置[ViewSVN](http://viewsvn.berlios.de/)以查看我们的 subversion 存储库。我的 SVN 存储库使用 https 进行访问。但是，无论在我的 svn 存储库的 viewsvn 配置中提供 svn://、svn+ssh:// 或 https://，我总是在我的 apache 日志中得到这个：

```
svn: URL protocol is not supported 'https://my.repository.com' 
```

从命令行运行时，一切当然都可以完美运行。我的 localconfig.php 文件将 svn 根服务器定义为

```
$config['svnroot']='https://my.repository.com'; 
```

另一件事-我正在使用[JavaSVN](http://svnkit.com/)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T14:01:00.813

您是否碰巧安装了多个版本的 SVN，例如 ViewSVN 使用 /usr/bin/svn 而您使用的是 /usr/local/bin/svn 或类似的东西？

* * *

[**编辑**] 我不知道 JavaSVN，但是当不同的用户运行它时，它的行为可能会有所不同。也许它不会加载您需要处理不同协议的其他插件。你有超级用户访问你的机器吗？尝试以 Web 服务器用户身份从命令行运行结帐：

```
su nobody
svn checkout https://... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-06T23:38:36.197

我在 svnroot 中添加了“端口号”和“根文件夹”，如下所示

$config['svnroot']=' [https://my.repository.com](https://my.repository.com) : ***8088/svn*** ';

我使用 TortoiseSVN，它显示了我的 svnroot，我认为 JAVASVN 具有相同的功能。

# algorithm - 推荐系统是如何工作的？

> ID：626220
> 
> 赞同：29
> 
> 时间：2009-03-09T13:27:21.673
> 
> 标签：algorithm, recommendation-engine

我一直很好奇这些系统是如何工作的。例如，netflix 或亚马逊如何根据过去的购买和/或评分确定要提出的建议？有什么算法可以阅读吗？

只是为了这里没有误解，我没有实际的理由问。我只是出于好奇而问。

（另外，如果有关于这个主题的现有问题，请指出它。“推荐系统”是一个很难搜索的术语。）

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-09T13:35:43.807

在最基本的情况下，大多数推荐系统通过说两件事之一来工作。

**基于用户的推荐：**
如果用户 A 喜欢项目 1、2、3、4 和 5，
并且用户 B 喜欢项目 1、2、3 和 4，
那么用户 B 很可能也喜欢项目 5

**基于物品的推荐：**
如果购买物品 1 的用户也有不成比例地购买物品 2
并且用户 A 购买了物品 1
，那么用户 A 可能会对物品 2 感兴趣

**这里是你应该知道的算法的大脑转储：**
- 设置相似度（Jaccard 指数和 Tanimoto 系数）
- n 维欧几里得距离
- k-means 算法
- 支持向量机

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-03-09T13:33:10.227

这是一个如此重要的商业应用程序，[Netflix 推出了 100 万美元的奖金，用于将他们的推荐提高 10%](http://www.netflixprize.com/)。

几年后，人们越来越接近（我认为他们现在上涨了 9% 左右），但由于很多很多原因，这很难。Netflix Prize 的最大因素或最大的初始改进可能是使用了一种称为[奇异值分解](http://en.wikipedia.org/wiki/Singular_value_decomposition)的统计技术。

我强烈建议您阅读[如果您喜欢这个，您一定会喜欢那个](http://www.nytimes.com/2008/11/23/magazine/23Netflix-t.html?_r=1&partner=permalink&exprod=permalink)，以深入讨论 Netflix Prize 和一般推荐系统。

基本上亚马逊等的原理是一样的：他们寻找模式。如果有人很好地购买了《星球大战》三部曲，那么他们比普通客户更喜欢吸血鬼猎人巴菲（纯属虚构的例子）。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-09T13:30:10.887

O'Reilly 的书[“Programming Collective Intelligence”](https://rads.stackoverflow.com/amzn/click/com/0596529325)有一个很好的章节展示了它是如何工作的。非常可读。

代码示例都是用 Python 编写的，但这不是什么大问题。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-09T14:29:47.843

明尼苏达大学的[GroupLens Research研究推荐系统并慷慨地分享他们的](http://www.grouplens.org/)[研究](http://www.grouplens.org/biblio)和[数据集](http://www.grouplens.org/taxonomy/term/14)。

他们的研究每年都会扩大一点，现在考虑诸如在线社区、社交协作过滤和呈现复杂数据的 UI 挑战等细节。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-09T13:31:28.123

Netflix 推荐系统的算法实际上是一项竞争性的努力，程序员在其中不断竞争以提高系统的准确性。

但在最基本的术语中，推荐系统会检查与另一个用户的人口统计/兴趣信息密切匹配的用户的选择。

因此，如果您是来自纽约市的 25 岁白人男性，推荐系统可能会尝试为您带来美国东北部其他 21-30 岁年龄段白人男性购买的产品。

编辑：还应该注意的是，您拥有的用户信息越多，您就越能改进算法，以将其他人正在做的事情与相关用户可能感兴趣的事情相匹配。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-09T13:31:53.537

这是一个分类问题——即将用户分类为可能对某些项目感兴趣的用户组。

一旦被分类到这样的组中，就很容易检查该组中其他用户的购买/喜欢并推荐它们。

因此，贝叶斯分类和神经网络（多层感知器、径向基函数、支持向量机）值得一读。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-09T13:34:53.607

一种技术是将用户分组到[集群中](http://en.wikipedia.org/wiki/Data_clustering)，并从同一集群中的其他用户推荐产品。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-05-30T20:09:58.073

主要有两种类型的推荐系统，它们的工作方式不同：

**1\. 基于内容**。这些系统根据特征信息提出建议。这是关于项目（关键字、类别等）和用户（偏好、配置文件等）的信息。

**2.协同过滤**。这些系统基于用户-项目交互。这是诸如评级、购买数量、喜欢等信息。

[这篇](https://tryolabs.com/blog/introduction-to-recommender-systems/)文章（由我工作的公司出版）概述了这两个系统，一些实际示例，并建议何时实施它们是有意义的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-06-18T07:23:02.060

当然有算法会推荐你喜欢的项目。为此已经实施了不同的数据挖掘技术。如果您想了解有关推荐系统的更多基本信息，请访问[此](http://sujitshakya.com.np/wp-content/uploads/2014/06/Recommender.pdf)博客。这里已经涵盖了所有基础知识，以了解推荐系统。

# project-management - 为什么使用邮件列表进行项目协作？

> ID：626221
> 
> 赞同：18
> 
> 时间：2009-03-09T13:28:11.907
> 
> 标签：project-management, mailing-list

我注意到许多开源项目继续使用邮件列表来代替论坛。我个人发现邮件列表很麻烦且无法搜索，这使得解决/讨论使用它们的项目的技术问题变得更加困难。我错过了邮件列表的一些继承优势还是不合时宜？

澄清一下，这不是一个“一般来说邮件列表有什么好处”的问题。我刚刚注意到它们非常常用于软件开发项目，而互联网的其他部分似乎已经开始发展。那么使用邮件列表进行软件开发有什么好处呢？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-09T13:32:22.117

如果您关注多个邮件列表，那么邮件列表要比论坛好得多，因为它们是推送技术。如果我关心 N 个不同的项目，我可以订阅 N 个不同的邮件列表，并在我的邮箱中拥有所有信息，或者我可以去 N 个不同的论坛，需要 N 个不同的登录和近 N 个不同的界面。

其中一位评论者建议，通过一些网络论坛，您可以在活动发生时收到电子邮件通知，而另一位则建议使用 RSS 提要。对我来说，这是试图重新发明一个已经发明的轮子，只是你无法决定要在它上面放多少个角。因此，您建议不要将我感兴趣的所有对话发送到我可以忽略或直接回复的收件箱，而是收到一封电子邮件或 RSS 提要通知，告知有更新，然后我可以登录进入所有这些不同的网络论坛并在那里阅读或回复它们？那是如何改进的？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-10T00:36:30.443

既然我已经看到 SO 的效果如何，我认为邮件列表和论坛都应该关闭商店并继续使用他们最喜欢的 SO 标签。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-29T15:38:58.233

因为您可以通过早上查看您的电子邮件来关注他们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-31T11:01:02.360

这是因为 *大多数 OSS 开发人员已经将他们的邮件工作流程配置得非常高效*。

我也可以想象其他解决方案（包括 RSS 之类的拉取技术），其中大部分*都在*某处使用。但电子邮件仍然是共同点。

请注意，人们经常会找到与 RSS、Web、错误跟踪系统和 Web 服务的接口。

# html - 电视指南列表语义。不是桌子吗？

> ID：626224
> 
> 赞同：7
> 
> 时间：2009-03-09T13:28:53.963
> 
> 标签：html, html-table, semantics

我需要建立一个基于网络的电视指南列表。

当我开始时，我认为我所需要的只是建立一个表格，因为它是一个表格数据。

```
date       00:00   00:30   01:00   etc...
channel 1  show 1  show 2  show 3  etc...
channel 2  show 3  show 4  show 5  etc... 
```

但可惜情况并非如此。虽然`<th>`每 30 分钟一次。演出长度可以从 5 分钟开始。长达几个小时。

我可以用 colspan=6 作弊并制作每一个`<th>`，所以子单元将是 5 分钟。然后将每个节目的 colspan 玩成时间长度/5（分钟），这就是我的 colspan。

但是（总是有一个但是），现在我所拥有的不是带有表格数据的表格，我所拥有的是某种意大利面条表。

我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T13:57:08.373

这绝对不是你应该用 <table> 解决的问题。

使用多个 <div>，每个都在 CSS 中设置显示内联或内联块。设置它们的宽度，最好使用 CSS 类，例如如下：

```
div.channel div
{
   display: inline-block;
}
div.five { width: 1em; }
div.ten { width: 2em; }
div.fifteen { width: 3em; }
... 
```

然后是 HTML：

```
<div class="channel">
  <div class="five">Five minute program</div>
  <div class="fifteen">Fifteen minute program</div>
  <div class="five">Five minute program</div>
</div>
<div class="channel">
  <div class="ten">Ten minute program</div>
  <div class="fifteen">Fifteen minute program</div>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T13:36:41.263

您是否从现有的电视指南中寻找灵感？

例如，带有许多 colspans 选项的表就是[此处](http://www.ebroadcast.com.au/TV/static/MelbourneNight.html?)使用的表。

我认为基本上有两种选择。

*   使用表格，并有 colspans。您只能在有限的时间内拥有一个“列”，因此您可能必须四舍五入到最接近的 5、10 或 15 分钟，具体取决于您每小时的列数，而一个一小时的程序可能有正如您在问题中指出的那样，colspan 为 4、6 甚至 12。
*   将 CSS 与普通的 DIV 一起使用（或者您甚至可以将它们设为 UL 和 LI，如果您真的需要，每行一个 UL，该行中的每个块一个 LI）并分别指定每个项目的宽度。您可以按百分比（允许整行扩展和收缩）或像素来执行此操作。您可能想要试验内部元素，即每个程序一个，是浮动块或内联块。浮点数应该没问题，只要舍入误差不会使它们换行。

我认为从语义上讲，第二种选择更好。正如您正确指出的那样，它非常像一张表格，因此表格应该是合适的，但是一旦您使用的列比您打算显示的多得多，并且跨度到大小区域，它就会失去语义吸引力。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T13:42:12.013

我认为您已经表明您的数据并不是真正的表格。如果您对 CSS 感到满意，那么我建议您使用 CSS 并以这种方式设置规则。

例如，您可以有五分钟、十分钟、十五分钟、三十分钟、一小时等课程......这些规则中的每一个都将被配置为为您提供正确的宽度等等。对于其他不寻常的事情，您可以即时计算大小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T12:02:33.433

最后，我们决定电视指南不完全是一张桌子。有显示小时的标题部分和按小时显示节目的正文部分，但这里是表格部分结束的地方。

我们将它作为一个列表列表，第一个列表是标题和频道列表，在每个 li 中都会有另一个列表，在标题中会有一个小时列表（每个小时都有一个恒定的宽度），并且在li 的其余部分（频道）将有一个特定频道的节目列表，每个 li 都会根据节目长度获得一个宽度。

```
<ol>
    <li>date
        <ol>
            <li>00:00</li>
            <li>00:30</li>
            <li>01:00</li>
            <li>01:30</li>
            .
            .
            .
        </ol>
    </li>
    <li>Channel 1
        <ol>
            <li>Show 1</li>
            <li>Show 2</li>
            <li>Show 3</li>
            <li>Show 4</li>
            .
            .
            .
        </ol>
    </li>
    <li>Channel 2
    .
    .
    .
<ol> 
```

这不是一个完美的解决方案，但我们生活在一个不完美的世界。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T13:40:55.543

您呈现的数据实际上类似于各种图形或图表。没有与此相对应的 HTML 元素。我会说表格方法是有道理的。将表格分成 1/6 也很有意义。不能有 1.125 的 colspan 是介质的限制。由于该表将以编程方式生成，因此我认为将每个逻辑单元拆分为 6 个物理单元不会是一个主要问题。只需在您关心的任何非标准浏览器上测试样本，例如屏幕阅读器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T14:00:01.970

电视节目表？这是一个清单...

实际上，在这方面存在一些严重的分歧：

*   [无线电时报确实使用了一个列表](http://www.radiotimes.com/tv/)
*   [TVGuide.co.uk 使用 4 级嵌套表格](http://www.tvguide.co.uk/)
*   [Sky 使用了数量惊人的 div 和大量 javascript。](http://tv.sky.com/tvlistings)

所以决定你喜欢哪个，然后选择......

# javascript - 输出字符串时出现 Javascript 错误（链接）

> ID：626239
> 
> 赞同：0
> 
> 时间：2009-03-09T13:32:15.190
> 
> 标签：javascript

```
String link = "javascript:document.forms[0].submit() onClick=\"return processParams(" + classOid + ")\" "; classbreadCrumbSelect.add("" + className + ""); //Load the link into my arrayList

for (String unitkey : unitbreadCrumbSelect) {
    out.print(" | " + unitkey + " | "); 
} //outputs to the JSP. 
```

该错误指出 ) 丢失，并表示页面在 IE 中出现错误。

该链接完美运行，可以满足我的要求。基本上我只需要知道是否存在语法错误或 IE 是否只是烦人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T13:39:48.260

如果我理解正确，这段 HTML 将被写入客户端：

```
<a href="javascript:document.forms[0].submit() onClick="return processParams(classOid)""> 
```

也许您希望它看起来像：

```
<a href="javascript:document.forms[0].submit()" onClick="return processParams(classOid)"> 
```

请检查您的 JSP 的输出——我怀疑您的`link`字符串中的引号是错误的。

* * *

[**编辑**] 从评论中，HTML 输出是：

```
<a href='javascript:document.forms[0].submit()' onClick="return processParams(wt.projmgmt.admin.Project2:282144)" >Unit 3</a> 
```

问题在于`processParams()`：

```
processParams(wt.projmgmt.admin.Project2:282144) 
```

这是无效的 JavaScript：在“Project2”之后缺少语法上的“)”。也许您想添加引号以将参数视为字符串？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T14:07:51.297

您需要查看页面源代码并查看您的代码生成的内容。查看您的服务器端将输出什么永远不如查看它输出的内容。

视图源应该向您显示您输入的拼写错误、缺少的引号等。

# iphone - iPhone SDK 的 Sqlite3 连接类

> ID：626240
> 
> 赞同：0
> 
> 时间：2009-03-09T13:32:21.163
> 
> 标签：iphone, sqlite

是否有任何常见的 sqlite3 连接类可用于使用 iPhone SDK。我意识到每次连接和运行查询都很容易，但是为了节省更多时间，如果我们可以使用一个类来直接处理所有 sql，那将是一个真正的帮助。

如果您将查询传递给它，我会想象一些返回 NSMutableArray 的东西。

有什么可用的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T15:59:49.547

另请查看我使用的[SQLitePersistentObjects](http://code.google.com/p/sqlitepersistentobjects/)。最大的优势是我现在不必担心模式等。但是，SQLitePO 似乎无法将对象存储到备用表中，AFAIK。否则它似乎工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T13:41:24.387

我们使用Flying Meat 和 Gus Mueller的[FMDB包装器。](http://gusmueller.com/blog/archives/2008/03/fmdb_for_iphone.html)他们在使用 Cocoa 包装 sqlite3 的 C API 并返回一流的 Cocoa 类型方面做得相当不错。您不会从查询中返回 NSMutableArray ——您会得到一个 FMResultSet，在精神上类似于 JDBC ResultSet（如果有记忆的话）。如果这很重要，它也是麻省理工学院许可的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-18T18:05:36.913

要与 SQLite 数据库通信，您可以尝试以下库：[https ://github.com/ziminji/objective-c-sql-query-builder](https://github.com/ziminji/objective-c-sql-query-builder)

通过这个库，您可以构建 SQL 查询并构建有助于您更好地访问数据库的 ORM 模型。该库还有一个非常好的 Wiki 页面，可以帮助您将其集成到您的应用程序中。

# visual-c++ - 用于网络监控的 Visual C++ API

> ID：626244
> 
> 赞同：2
> 
> 时间：2009-03-09T13:32:33.393
> 
> 标签：visual-c++, network-programming

我必须在 Visual C++ (Windows) 下制作一个网络监控应用程序，你推荐我使用哪些库或 API？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T13:42:33.527

[传输驱动程序接口 (TDI)](http://en.wikipedia.org/wiki/Transport_Driver_Interface)过滤器允许您监控网络流量。

您也可以尝试使用为 ethereal/wireshark 提供支持的[libpcap 。](http://en.wikipedia.org/wiki/Pcap)这基于[网络驱动程序接口规范 (NDIS)](http://en.wikipedia.org/wiki/NDIS)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T14:34:25.883

几个选项，取决于您真正想要监控的内容：

*   Net-SNMP（或其他 SNMP 库），用于与网络设备通信并从各种 MIB 获取数据（**例如，您要收集接口计数器、cpu 利用率和供应商提供的其他好东西**）

*   WinPcap 用于做更多低级、面向数据包的事情（**例如，使用 BPF 过滤器的功能和速度捕获某些类型的流量**）

*   如果您对收集特定类型的信息（NetFlow、sFlow）感兴趣，那么我帮不了您太多。有现成的工具，但我不确定是否有任何形式的库。

*   RRDtool（**如果你想向用户展示一些漂亮的图**）

# asp.net - 如何处理 ASP.NET 的 HyperLink.NavigateUrl 中的特殊字符？

> ID：626254
> 
> 赞同：2
> 
> 时间：2009-03-09T13:34:34.030
> 
> 标签：asp.net, character-encoding, hyperlink, navigateurl

我目前在弄清楚如何处理要（动态）传递给`HyperLink`控件`NavigateUrl`属性的文件路径时遇到了麻烦。

假设我试图引用一个`jäynä.txt`以`C:`.
将结果传递`"file:///C:/jäynä.txt"`给指向 的链接`file:///C:/jÃ¤ynÃ¤.txt`，就像`HttpUtility.UrlPathEncode("file:///C:/jäynä.txt")`.

将 **s 替换为**`ä`**`%E4`**，它给出了 string `"file:///C:/j%E4yn%E4.txt"`，确实提供了一个到 的工作链接`file:///C:/jäynä.txt`，但我无法找到一种方法来进行替换而不自己定义它。以`Replace("ä", "%E4")`为例。

有没有办法自动处理文件路径字符串，以便`HyperLink`正确显示它，而无需手动列出要替换字符串中的哪些字符？

*附加说明：*
可能有一种方法可以通过指定呈现页面的字符编码来解决此问题，因为调试表明`HyperLink`至少将字符串保存`"file:///C:/jäynä.txt"`不变，但在呈现时会以某种方式破坏它。
然而，这似乎只在渲染 ' 时才会出现，`NavigateUrl`因为其他组件以及`HyperLink`'s `Text`-property 都完全能够以**`ä`**不变的方式渲染字符。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-21T18:00:46.667

超链接的 NavigateUrl 属性将对 url 中的 unicode 字符进行编码。

相反，您可以像这样设置超链接的 href 属性：

```
hyperlink1.Attribute("href") = "file:///C:/jäynä.txt" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T13:40:11.940

这是由于浏览器开始解释路径的方式，通常个人会避免使用诸如页面 url 中的字符。

在你的情况下，我相信你已经找到了最好的情况，因为我不知道有任何方法可以改变 HttpUtility 和/或 NavigateUrl 属性的行为。至少在没有为其创建自定义控件的情况下并非如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-23T11:44:45.827

不要使用超链接控件。而是使用 HtmlAnchor 控件。它会解决你的问题。我不知道微软为什么要这样设计。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T09:10:02.807

谢谢！使用“属性”的帖子解决了我的问题。就我而言，它是

```
HyperLink6.Attributes["href"] = "http://høgstedt.danquah.dk/"; 
```

在 url 中使用特殊丹麦字符的问题似乎一直困扰着很多程序员——搜索提供了几种非常复杂的方法。这个很简单，而且很简单。所以再一次，谢谢你

# oracle - 哪些情况会导致 Oracle 包失效？

> ID：626267
> 
> 赞同：11
> 
> 时间：2009-03-09T13:37:48.747
> 
> 标签：oracle, plsql, package, dependencies

创建此问题的场景：

我们有一个包是另一个包的依赖项，有时对“父”包进行更改会导致依赖包无效，但有时不会。

它以前曾让我们感到意外。

简单地了解导致失效的原因将非常有用，这样我就可以预测/计划它。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-09T14:46:01.923

更改包所依赖的任何对象（例如表、视图、触发器、其他包）都会自动将包标记为无效。正如上面 tuinstoel 所指出的，Oracle 足够聪明，可以在第一次使用包时重新编译它。

如果您对此感到担忧，那么每次您进行模式更改（例如表、视图、触发器、过程）时，运行一个`DBMS_UTILITY.compile_schema` （或让您的 DBA 执行）。这将强制编译所有包，并在您发现错误之前让您知道哪里有错误，或者是否有错误。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-07-08T07:12:39.157

或者您可以查询下表查看您有哪些依赖项

```
 select *
   from dba_dependencies
   where name = 'YOUR_PACKAGE'
   and referenced_owner = 'ANYUSER' --- Comment this out if you are looking for yourself
   and owner = USER --- Or can be set to any user 
```

这将显示所有依赖项。对于您的对象，请查询 user_dependencies。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T20:29:06.980

我同意 Thomas Jones-Low 的观点，但是还有一些与长时间会话和重新编译有关的问题。

如果您在会话中引用一个包并且该包（或依赖包）在同一会话期间重新编译，那么您将收到 oracle 错误“ORA-06508：PL/SQL：找不到被调用的程序单元”

一旦您在会话中引用了包，您通常无法更改包而不使该包无效。对于包经常更改的开发环境来说，这是一个特殊的问题，但对于想要在不关闭整个环境的情况下做一个小补丁的生产环境来说也是一个问题。请注意，即使更改的包中没有错误，也会发生此错误。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T15:20:26.083

*顺便说一句，如果我对这种情况完全错了......提前道歉*

被吓到了？

不知道这意味着什么...

生产中有什么问题吗？

究竟发生了什么？

我问的原因是因为理解每一个可能的变化的后果比处理结果要困难得多。为什么失效会成为一个问题？我的猜测是因为您的应用程序中出现“包的现有状态已被丢弃”错误。这是**真正**的问题吗？

我再次怀疑它是，如果是这样，让我们​​处理它而不是我在评论中放置的更改列表是特定于版本的。（例如，11g 将依赖关系跟踪到表的列而不是整个表）。

**如果**您不使用包状态，这对您来说可能不是一个重要的错误。如果你是这将是一个重要的错误，你不会感到惊讶，所以我猜你不是。

既然你不是这个错误可以忽略。由于您可以安全地忽略它，您可以编写客户端应用程序以忽略此错误并重试您的调用，因为正如其他人指出的那样，Oracle 将为您重新编译您的包。这是一个很有价值的练习。因为当您进行更改时，您不必知道您需要担心的所有可能的事情，然后在紧急修复中您忘记其中的一件，您的应用程序只会处理它并继续前进，而无需担心。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T14:50:12.193

除了 Thomas Jones-Low 的回答之外，如果您只修改包 BODY，则依赖对象可能不会被标记为无效。

但是，一旦您修改了包规范，这必然会发生。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T14:28:19.983

如果尝试执行一个无效的 Oracle 包，Oracle 将尝试编译它。只有在编译Oracle后仍然无效时才会抛出异常。

# sql-server - 在 NHibernate SQL 查询中使用时间时的内存泄漏

> ID：626290
> 
> 赞同：1
> 
> 时间：2009-03-09T13:44:22.647
> 
> 标签：sql-server, sql-server-2005, nhibernate, datetime, memory-leaks

我在我的 ASP.NET 应用程序中使用 NHibernate 来连接到 MS SQL Server 2005 数据库。在某些情况下，我需要编写自己的 SQL 查询。但是，我注意到每次执行以下代码时，SQL Server 线程都会泄漏大约 50 KB 的内存：

```
NHibernate.ISession session = NHibernateSessionManager.Instance.GetSession();

ISQLQuery query = session.CreateSQLQuery(
  "select {a.*} from t_alarm a where a.deactivationtime > '" +
  DateTime.UtcNow.ToString("yyyy-MM-dd HH:mm:ss") +
  "'");

query.AddEntity("a", typeof(TAlarm));
System.Collections.IList aList = query.List(); 
```

当我查看 Windows 任务管理器时，我发现`sqlservr.exe`每次运行此代码时，该进程的内存使用量都会增加 50 KB。

这是真正有趣的部分。如果我在上面的代码中替换`"yyyy-MM-dd HH:mm:ss"`为`"yyyy-MM-dd HH:mm"`（即删除秒数），则内存泄漏停止。

*更新：显然内存泄漏实际上并没有停止。他们只是每分钟显示一次。大概是当 SQL 查询发生变化时。*

两种情况下返回的结果是相同的。

有谁知道这里发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T19:37:58.430

您可能已将查询计划添加到过程缓存中？

sqlservr.exe 占用内存并且不会释放它，除非它必须在其他应用程序需要它时释放它。因此数据库服务器是独立的而不是多用途的。

[来自 BOL：动态内存管理](http://msdn.microsoft.com/en-us/library/ms178145(SQL.90).aspx)

在具有 2 GB RAM 的 32 位 PC 上，SQL Server 2000 将最大消耗 1.7GB RAM。有一篇 KB 文章对此进行了描述。

在这种情况下，通过提供秒数，您隐含地声明了“datetime”类型，而不是“smalldatetime”类型。这可能会影响您的查询计划。您可能对“a.deactivationtime”进行了隐式转换

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T21:39:53.190

a) 在示例中，您没有正确处理 NHibernate 的 Session，因此与 DB 的连接保持打开状态。

使用 using() {} statemenet 或 try{} cath{} finally{} 正确关闭连接。

b）您编写的 SQL 命令不使用 SQL 参数，因此每次执行它时 SQL 服务器都会将此视为一个新命令 - 更准确地说是每秒（或者如果您删除 :ss 部分，则每分钟）。使用 SQL 参数（就像 NHibernate 在使用 HQL、Criteria 或 QBE 查询时所做的那样），它将被正确缓存，内存消耗更少。

希望这可以帮助;）

# html - 打印包含超过 1 页的表格的 HTML 电子邮件

> ID：626294
> 
> 赞同：3
> 
> 时间：2009-03-09T13:45:14.923
> 
> 标签：html, printing, internet-explorer-7

当我尝试打印带有延伸多个页面的表格的 HTML 电子邮件时，Windows-Mail 和 IE7 将只打印适合第一页的任何内容，但 Firefox 打印所有内容都很好。

有什么想法可以让微软产品打印整个东西吗？

问候，彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T14:38:33.727

如果这只是一次性电子邮件，您可以尝试以下方法之一：

1) 单击文件 > 打印以确保获得打印对话框 2) 确保在打印对话框中选择“所有页面” 3) 确认打印作业

或者

1) 将电子邮件复制并粘贴到另一个应用程序中，例如 Word，然后从那里打印文档。

如果这不是一次性的问题，您可以考虑将信息生成为可打印的附件，例如 PDF 格式 - 这使您可以比 HTML 更好地控制打印布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T09:44:48.823

我只是再次深入研究这个问题，发现 Internet Explorer 和 Windows 邮件（相同的 html 引擎？）在打印嵌套表时不能很好地处理嵌套表（另一个表的单元格内的表）。

从 html 电子邮件中删除嵌套表解决了这个问题（并创建了另一个，但我能够很好地解决没有嵌套表的布局问题；））

# silverlight - Silverlight 流媒体托管

> ID：626297
> 
> 赞同：0
> 
> 时间：2009-03-09T13:47:47.243
> 
> 标签：silverlight, hosting

微软在 silverlight.live.com 提供托管服务，我想知道是否有一些产品可以让我们在本地托管 silverlight 流，例如托管在 IIS 或某些文件服务器中？

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T02:19:32.693

Silverlight applications can be hosted on any web server: a Silverlight application is just a file with a .xap extension that the html page references.

Or are you looking at providing mms streaming for media content in your Silverlight app?

# asp.net - 不带参数请求的 WebResource.axd - 这是一个无效的网络资源请求

> ID：626301
> 
> 赞同：16
> 
> 时间：2009-03-09T13:48:22.047
> 
> 标签：asp.net, asp.net-2.0, webresource.axd

我时不时地在我的生产网站中发现这个问题，这让我非常难过......

我的应用程序在开发和生产中都能完美运行，但时不时地，我会从我的全局错误处理中收到一封电子邮件：

消息：这是一个无效的网络资源请求。
URL：/WebResource.axd
（这意味着由于某种原因请求 webresource.axd 时未指定任何 GET 参数）

我自己没有对 webresource.axd 做任何事情，我没有通过它获得任何资源，它仅由 .Net 自动用于为验证器等提供典型的 JS。

知道为什么在没有参数的情况下可能会被请求？有没有人遇到过这个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-25T23:37:55.063

这绝对是一个机器人在抓取您的网站方面做得不好。它处理您的 Web 表单并定位对 WebResource.axd 的引用，例如：

```
<script src="/site/WebResource.axd?d=MtIW_TBRtZCvAXDMJGwg4g2&amp;t=633772897740666651" type="text/javascript"></script> 
```

该机器人只需要静态 JavaScript 文件，并尝试通过请求不带参数的 WebResource.axd 来下载它。结果是 System.Web.Handlers.AssemblyResourceLoader 类抛出异常，并被 Global.asax 中的 Application_Error 拦截。

我相信这个异常是无害的——客户端会收到 404 错误。您可以放心地忽略它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T22:11:20.803

我们还将所有错误都通过电子邮件发送给我们，我们偶尔也会收到这些错误。他们似乎从来没有推荐人，而且用户代理通常有点古怪。我们把它们写成机器人。

我刚刚检查了几个针对[Arin](https://www.arin.net/)的违规客户端 IP ，其中一个属于网络爬虫类型的组织，因此对于机器人理论有更多的证据。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-14T22:06:51.343

我还将记录向 WebResource.axd 发出请求的用户代理。如果它是爬取您网站的机器人，我不会感到惊讶。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-14T21:52:21.863

这个讨论...

[http://www.telerik.com/community/forums/aspnet/spell/this-is-an-invalid-webresource-request.aspx](http://www.telerik.com/community/forums/aspnet/spell/this-is-an-invalid-webresource-request.aspx)

...以及此链接的 MSDN 文章...

[http://msdn.microsoft.com/en-us/magazine/cc163708.aspx](http://msdn.microsoft.com/en-us/magazine/cc163708.aspx)

...可能会有所启发（尽管不多）。

# c# - ASP.net 中的静态文件和身份验证

> ID：626303
> 
> 赞同：2
> 
> 时间：2009-03-09T13:48:42.530
> 
> 标签：c#, asp.net, security, ihttphandler, ihttpmodule

假设我在 IIS7 中有一个虚拟文件夹 /topFolder/，在该文件夹中可以有任何可以在浏览器中显示的文件（xml、html、swf、doc 等 - 从 IIS 角度来看通常是“非托管”资源）。在授予打开文件夹下任何文件的请求权限之前，我需要检查一些会话变量，以查看用户是否拥有相关子文件夹和文件的“许可证”。

我尝试使用 IHttpModule 和 IReadOnlySessionState 接口实现一个模块，但是当文件是“静态”而不是 IIS 管理（如 aspx、ashx 等）时，AcquireRequestState 事件中的 Session 始终为空。

如果我使用自定义 HttpHandler，我会得到会话，但我还需要实现内容如何发送到响应。编辑：由于用户没有下载文件，我只希望 IIS 像使用它的 StaticFileModule 一样提供文件。Handler/Module 应该是一个 StaticFileModuleWithAuthorizationHook...

所以我真的想做以下事情： 1\. 对于请求 /topFolder/* ：检查会话和许可证等 a）如果可以，继续提供文件 b）如果不可以，中断请求，或者只是发送 FORBIDDEN 作为响应。

希望有人可以提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T13:53:39.380

您应该能够通过 httphandler 处理此问题，简单的方法是使用内置方法将文件发送给有权访问的用户。

[本文](http://www.code-magazine.com/article.aspx?quickid=0703031&page=3)（在底部）展示了如何执行此操作的示例。

# batch-file - 编写批处理文件以将文本文件从 windows 系统复制到 unix 系统

> ID：626306
> 
> 赞同：0
> 
> 时间：2009-03-09T13:49:25.990
> 
> 标签：batch-file

我需要将 bleow 脚本的结果复制到 unix 系统的描述位置。脚本是

```
@echo off
setlocal enableextensions enabledelayedexpansion
set Counter=0
set FILEPATH=C:\VPM-WNC-MANUAL-MIGRATION
for /f "usebackq tokens=2,5,6 delims= " %%a in (`findstr /c:"Cod " %FILEPATH%\INPUT\INPUT.txt`) do (        
set x=%%b
set x=!x:~3!
set y=%%c        
if %%c LSS 10 set y=!y:~1!
set item!Counter!=%%a-!x!#!y!        
set /a Counter+=1
)
set result=%item0%
for /l %%i in (0,1,!Counter!) do echo !item%%i!>> %FILEPATH%\OUTPUT\result.txt  
echo \n
move %FILEPATH%\INPUT\INPUT.txt %FILEPATH%\DONE\
echo  >> %FILEPATH%\INPUT\INPUT.txt
move %FILEPATH%\OUTPUT\result.txt %FILEPATH%\RESULT\
echo  >> %FILEPATH%\OUTPUT\result.txt   
endlocal 
```

result.txt 应该转到 unix 文件夹

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T13:56:52.150

[PuTTy scp](http://the.earth.li/~sgtatham/putty/latest/x86/pscp.exe)可能是您的选择。像 linux 上的安全副本一样工作。

例如

pscp result.txt your_username@remotehost:/some/remote/directory

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T13:53:37.743

您可以使用 Samba 将 unix 文件系统挂载为 Windows 驱动器。然后正常复制文件，就像复制到本地硬盘一样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T13:54:12.080

假设您可以访问这些服务，您可以使用 ftp 或 scp 将结果上传到 unix 服务器。

# visual-studio - 如何在 Visual Studio 宏中开始文本选择

> ID：626309
> 
> 赞同：2
> 
> 时间：2009-03-09T13:50:47.343
> 
> 标签：visual-studio

很久以前，在以前的编辑器中，可以开始一个宏，然后“打开”文本选择......这样如果你的下一个动作是，比如说，搜索某个字符串 - 文本选择将扩展到那个地方。

这是一种无需使用通配符或正则表达式即可执行相当复杂的操作的好方法。

Visual Studio 2008 中是否有类似的功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-02-16T21:33:56.917

Ctrl-= 就是答案。

它是“SelectToLastGoBack”命令，正式记录为“从编辑器中的当前位置选择回到导航历史记录中的上一个位置”。因此，将光标移到您想要开始选择的位置（最好使用可靠可重复的搜索，例如搜索），开始新的搜索（通常我喜欢 ctrl-I 比 ctrl-F 更好，因为我可以看到它在做什么，但是 ctrl-我似乎在宏中无法正常工作），将搜索结束在您想要结束的位置（esc 关闭搜索框），然后点击控制等于选择回到您开始的位置。

不幸的是，我真的找不到任何东西可以详细解释编辑器如何决定导航历史中的先前位置。

# asp.net - ASP.net 无法从事件处理程序更新页面

> ID：626313
> 
> 赞同：0
> 
> 时间：2009-03-09T13:51:36.420
> 
> 标签：asp.net, events

我在页面上有一个链接按钮，该按钮的单击事件的事件处理程序调用对象上的一个方法，该方法又调用 Web 服务，当 Web 服务返回该对象时，该对象会在页面上触发一个事件和一个事件处理程序代码隐藏更新页面上的标签。由于某种原因，标签不显示消息。

这一直让我发疯，我在谷歌上找不到任何关于它的信息。任何帮助都会得到帮助。

正在异步调用 Web 服务，但线程被阻塞，直到它返回。并且标签预渲染事件在其文本由代理对象事件处理程序设置后被调用。

所有调用都发生在同一个线程上，我在事件处理程序中设置的任何值，而不仅仅是标签文本，在预渲染事件触发时都会恢复到它们以前的值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T14:04:24.270

这是正在发生的事情：

*   用户点击您的链接按钮
*   浏览器向 Web 服务器发送回发请求
*   Web 服务器创建一个全新的页面类实例并开始一个新的页面生命周期
*   页面生命周期完成所有正常的加载工作。
*   页面生命周期到达事件处理阶段并运行你的点击事件
*   点击事件通过您描述的“代理”对象调用 Web 服务
*   代理对象异步调用 Web 服务并返回
*   **click 事件返回**，因为它无事可做，从而释放 ASP.Net 以继续在页面生命周期中移动。
*   页面生命周期结束，所以**页面被渲染到浏览器**
*   用户看到新页面，但*标签相同，因为 Web 服务调用尚未完成*
*   Web 服务调用返回到您的代理对象，该对象引发其完成事件
*   您的事件处理程序更新*已呈现的页面类中标签的文本属性*
*   此请求中的页面实例已被释放。

**更新：**
在我发布此问题后，OP 更新了他的问题，以表明生命周期时间保持同步。因此，相反，我将指出 ASP.Net 中的控件不是线程安全的，而是从后台使用的线程调用 webservice 完成事件以发出异步请求，而不是从源线程调用。您应该`Invoke`在设置属性时进行控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T13:57:15.020

你在你的 Page_Load 事件中有这个吗？

```
if (Page.IsPostBack)
{
   return;
} 
```

如果没有，标签可以在回发后重新初始化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T13:59:37.043

网络服务是否异步运行？页面渲染后可能会触发 web 服务完成事件？您是否进行了调试以确保设置了标签值？

# jndi - “java:comp/env/jdbc/MY_SQL_DS”或“MY_SQL_DS”或其他什么可以从 Java 中引用 DataSource？

> ID：626314
> 
> 赞同：1
> 
> 时间：2009-03-09T13:51:45.097
> 
> 标签：jndi

“java:comp/env/jdbc/MY_SQL_DS”不起作用。我得到一个命名异常：NameNotFoundException。单独的“MY_SQL_DS”都不起作用。再次命名异常。

我为名为“MY_MailSession”的邮件会话创建了另一个 JNDI，并像 (javax.mail.Session) ctx.lookup("MY_MailSession") 一样引用它...

那么引用 JDBC 数据源的约定是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T17:51:23.683

我通过以下方式解决了它：希望这可以帮助其他人之后遇到同样的问题/问题......

```
protected Connection getConnection() {
            try {
                if (connection == null || connection.isClosed()) {
                    if (dataSource == null) {
                        // impliziter Initial Context von WebLogic ApplicationServer Environment
                        java.util.Hashtable environment = new java.util.Hashtable();
                        environment.put(Context.INITIAL_CONTEXT_FACTORY, "weblogic.jndi.WLInitialContextFactory");
                        Context wlsic = new InitialContext(environment);
                        showJndiContext( wlsic, "", "");

                        // logischer JNDI Rootcontext der Serverkomponente, kann mehrfach verwendet werden
                        Context ctx = (Context) wlsic.lookup("java:comp/env"); 
                        showJndiContext( ctx, "", "");

                        // weiter mit Resourcenpfad
                        dataSource = (DataSource) ctx.lookup("MY_SQL_DS");
                    }
                    connection = dataSource.getConnection();
                }
            }
            catch (NamingException ne) {
                ne.printStackTrace();
                log.error(ne);
            }
            catch (SQLException sqlEx) {
                sqlEx.printStackTrace();
                log.error(sqlEx.getMessage());
            }
            return connection;
        }

        public static void showJndiContext(Context ctx, String name, String space) {
            if (null == name)
                name = "";
            if (null == space)
                space = "";

            try {
                NamingEnumeration en = ctx.list(name);
                while (en.hasMoreElements()) {
                    String delim = (null != name && 0 < name.length()) ? "/" : "";
                    NameClassPair nc = (NameClassPair) en.next();
                    System.out.println(space + name + delim + nc);
                    if (40 > space.length())
                        showJndiContext(ctx, nc.getName(), "    " + space);
                }
            }
            catch (javax.naming.NamingException ex) {
                //System.out.println( ex );
            }
        } 
```

# c# - WinForms ListView，在重新加载时记住滚动位置

> ID：626315
> 
> 赞同：13
> 
> 时间：2009-03-09T13:51:47.887
> 
> 标签：c#, winforms, listview, .net-2.0, listviewitem

我有一个列表视图，其中填充了 8 列用户数据。用户可以选择启用自动刷新，这会导致 ListView 被清除并重新填充数据库中的最新数据。

问题是当项目被清除并重新填充时，可见区域会跳回列表的顶部。因此，如果我正在查看 2000 年的第 1000 项，则返回该项目非常不方便。

基本上，我要问的是，如何获得当前的滚动距离（x 和 y）然后恢复它们？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2010-01-24T12:45:05.643

我只是想为那些拼命尝试使用有问题的 ListView.TopItem 属性的人提供一些信息：

1.  您必须在调用 ListView.EndUpdate 之后设置 TopItem 属性
2.  ListView 控件的项目必须将它们的 Text 属性设置为 String.Empty 以外的值，否则该属性将不起作用。
3.  设置 ListView.TopItem 会间歇性地引发空引用异常。始终将这行代码保留在 Try...Catch 块中。

当然，这会导致ListView的滚动条跳到0又回到最上面的item的位置，很烦人。如果您找到解决此问题的方法，请更新此问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-11T01:10:30.237

I used the following successfully:

```
int topItemIndex = 0;
try
{
     topItemIndex = listView1.TopItem.Index;
}
catch (Exception ex)
{ }
listView1.BeginUpdate();
listView1.Items.Clear();
//CODE TO FILL LISTVIEW GOES HERE
listView1.EndUpdate();
try 
{ 
    listView1.TopItem = listView1.Items[topItemIndex];
}
catch (Exception ex)
{ } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T13:58:26.250

不久前我遇到了同样的问题，我最终实现了一个算法来比较模型和列表，所以我只添加/删除了改变的元素。这样，如果没有大的变化，列表就不会跳到开头。我想要实现的主要目标是效率（这样列表就不会闪烁）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-12-06T19:32:51.077

The TopItemIndex property on ListView is what you are looking for, however it has some confirmed bugs that should have been addressed in VS2010 release.. not sure (haven't checked).

Anyway, my workaround for making this work is to do this:

```
listViewOutput.TopItemIndex = outputList.Count - 1;
listViewOutput.TopItemIndex = myNewTopItemIndex; 
```

For some reason setting it directly does not update it, but setting it to the last item and then the one I want works reliably for me.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T14:05:28.527

查看 ListView.TopItem 属性。它有一个索引，应该包含它在列表中的位置。在新列表中找到该索引，并将 TopItem 设置为该项目，它应该会自动滚动。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T15:16:58.917

不幸的是，您将需要使用一些互操作来滚动到 ListView 中的确切位置。使用[GetScrollInfo](http://www.pinvoke.net/default.aspx/user32/GetScrollInfo.html) winapi 函数获取现有滚动位置，使用[SendMessage](http://www.pinvoke.net/default.aspx/user32/SendMessage.html)滚动到该位置。

在 CodeProject 上的一篇名为[Scrolling to a group with a ListView](http://www.codeproject.com/KB/list/ListViewGroupScroll.aspx)的文章中，可能会指导您找到解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-25T19:22:47.817

I was having sort-of the same problem. I have a listView that I populate every 1/2 sec and when I set the TopItem to an ListItem whose index > visible items, then the list jumped between the topItem and back 2 spots.

So, to correct the problem, I set the TopIterm AFTER the call to EndUpdate.

```
lvB.EndUpdate();
lvI.EndUpdate();
lvR.EndUpdate();

if (lstEntryInts.Items.Count > 0)
    lstEntryInts.TopItem = lstEntryInts.Items[iTopVisIdx];
if (lstEntryBools.Items.Count > 0)
    lstEntryBools.TopItem = lstEntryBools.Items[iTopVisIdx];
if (lstEntryReals.Items.Count > 0)
    lstEntryReals.TopItem = lstEntryReals.Items[iTopVisIdx];​ 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-10T16:55:46.437

My solution to maintaining scroll position:

Form level variable:

```
private static int scrollSpot = 0; 
```

Inside listview refresh (ie Timer,button) to store the current spot:

```
scrollSpot = this.listView1.TopItem.Index;
refreshTheForm(); 
```

Inside refreshTheForm method to show the stored spot (put at very end of method):

```
if (scrollSpot <= 1)
{
     listView1.Items[scrollSpot].Selected = true;
}
else
{
     listView1.Items[scrollSpot - 2].Selected = true;
}
listView1.TopItem = listView1.SelectedItems[0]; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-08-11T20:05:07.227

In my tests, you did not even need the TopItem, although I used a int to save the selected item. Also TopItem throws an exception if you are using View.Tile or View.LargeIcon.

This code does not move the scroll bars:

```
listView1.BeginUpdate();
listView1.Items.Clear();

// loop through your add routine
listView1.Items.Add(lvi);

listView1.EndUpdate(); 
```

# cocoa - 删除/添加 CALayers 以进行 GPU 优化

> ID：626316
> 
> 赞同：1
> 
> 时间：2009-03-09T13:51:58.853
> 
> 标签：cocoa, core-animation

我有一个支持图层的视图，我正在尝试添加大约 300 X 270（以像素为单位）大小的子图层。

子层的数量可能会达到 1000 到 2000 个，更不用说每个子层都可以再次扩展到大约 4280 X 1500 或更多。

所以问题显然是GPU约束的问题。

添加大约 100 个大小为 300 X 270 的子图层后，会出现一个警告`image is too large for GPU, ignoring`，这会干扰图层显示。

这种问题的解决方案（来自一些邮件列表）是使用，但由于子图层显示的复杂要求，`CATiledLayer`我无法使用。`tiledLayer`

是否有可能删除不属于`VisibleRect`视图的子层？

我尝试`removeFromSuperlayer`添加它，然后在需要时添加它，当我尝试添加 subLayer 时总是会崩溃。

我怎样才能做到这一点？

我添加了两次子层（我需要更改它）但现在只是为了代码的要点：

```
-(IBAction)addLayer:(id)sender
{
  Layer *l = [[Layer alloc] init];
  CALayer *layer = [l page];
  [contentArray addObject:page];
  [drawLayer addSublayer:layer];
  [self layout];
}

-(void)layout
{
    NSEnumerator *pageEnumr = [contentArray objectEnumerator];

    float widthMargin = [self frame].size.width;
    CGRect rect;
    float zoom = [self zoomFactor];
    while(obj = [contentEnmr nextObject] )
    {
        [obj setZoomFactor:zoom];
        CALayer *pg =(CALayer *)[obj page] ;
        rect = pg.bounds;

        if ( x + pg.bounds.size.width   > widthMargin  )
        {
            x = xOffset;
            y += rect.size.height + spacing ;

        }
        rect.origin = CGPointMake(x,y);
        [obj changeBounds];

        NSRect VisibleRect = [self visibleRect];
        NSRect result = NSIntersectionRect(VisibleRect,NSRectFromCGRect( rect));
        if( NSEqualRects (result ,NSZeroRect) )
        {
            [pg removeFromSuperlayer];
        }else
        {
            [drawLayer addSublayer:pg];
            [pg setFrame:rect];
            [pg setNeedsDisplay];
        }

        x += ( rect.size.width + spacing);
    }

    NSRect viewRect = [self frame];
    if(viewRect.size.height < ( y + rect.size.height + spacing )  )
        viewRect.size.height = ( y + rect.size.height + spacing) ;

    [self setFrameSize: viewRect.size];

}

@interface Layer : NSObject {
CALayer *page;
}
@property (retain) CALayer *page; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-10-05T05:42:23.847

查看包含在 WWDC 会议中的 PhotoScroller 应用程序。它演示了如何通过仅加载当前可见的图像部分来缩放和滚动非常大的图像。

另请查看[此讨论](http://forums.pragprog.com/forums/57/topics/816)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-19T16:14:46.417

您需要做 NSTableView 和 UITableView 所做的事情，并在可见矩形发生变化时自行管理图层的添加/删除。订阅封闭滚动视图的剪辑视图的 boundsDidChange 通知（我假设某些层在屏幕外的原因是它包含在滚动视图中）：

```
- (void) viewDidMoveToSuperview
{
    NSClipView* clipView = [[self enclosingScrollView] contentView];
    [clipView setPostsBoundsChangedNotifications:YES];
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(clipViewBoundsDidChange:)
                                                 name:NSViewBoundsDidChangeNotification
                                               object:clipView];
} 
```

然后编写一个`clipViewBoundsDidChange:`根据需要添加和删除子层的方法。您可能还希望缓存和重用无效层以减少分配。看看 UITableView 和 NSTableView 与它们的 dataSource 对象交互的方式，了解如何为此设计界面。

*CATiledLayer 通过图层的内容*解决了这个问题——即，无论您设置其内容属性或直接绘制到其图形上下文中。它不会对子图层执行此操作，实际上我认为建议您根本不要将子图层添加到 CATiledLayer，因为这会干扰其绘图行为。

# xsd - 将属性添加到简单类型或限制到 Xml 架构中的复杂类型

> ID：626319
> 
> 赞同：67
> 
> 时间：2009-03-09T13:52:36.933
> 
> 标签：xsd, restriction

问题如下：

我有以下 XML 片段：

```
<time format="minutes">11:60</time> 
```

问题是我不能同时添加属性和限制。属性格式只能具有分钟、小时和秒的值。时间有限制模式`\d{2}:\d{2}`

```
<xs:element name="time" type="timeType"/>
...
<xs:simpleType name="formatType">
    <xs:restriction base="xs:string">
        <xs:enumeration value="minutes"/>
        <xs:enumeration value="hours"/>
        <xs:enumeration value="seconds"/>
    </xs:restriction>
</xs:simpleType>
<xs:complexType name="timeType">
    <xs:attribute name="format">
        <xs:simpleType>
            <xs:restriction base="formatType"/>
        </xs:simpleType>
    </xs:attribute>
</xs:complexType> 
```

如果我做一个复杂类型的timeType，我可以加一个属性，但不能加限制；如果我做一个简单类型，我可以加限制，但不能加属性。有没有办法解决这个问题。这不是一个很奇怪的限制，不是吗？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2009-03-09T14:11:26.857

要添加必须通过扩展派生的属性，要添加必须通过限制派生的方面。因此，对于元素的子内容，这必须分两步完成。该属性可以内联定义：

```
<xsd:simpleType name="timeValueType">
  <xsd:restriction base="xsd:token">
    <xsd:pattern value="\d{2}:\d{2}"/>
  </xsd:restriction>
</xsd:simpleType>

<xsd:complexType name="timeType">
  <xsd:simpleContent>
    <xsd:extension base="timeValueType">
      <xsd:attribute name="format">
        <xsd:simpleType>
          <xsd:restriction base="xsd:token">
            <xsd:enumeration value="seconds"/>
            <xsd:enumeration value="minutes"/>
            <xsd:enumeration value="hours"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:attribute>
    </xsd:extension>
  </xsd:simpleContent>
</xsd:complexType> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-04-28T09:33:29.150

我想提出我的示例，并更详细地解释在添加属性时将继承类型与限制混合实际需要什么。

这是您定义继承类型的地方（在我的情况下，它是基于 xs:string 且应用了字段长度 1024 限制的类型）。您不能将其作为您的字段的标准类型，因为您也将向您的字段添加“属性”。

```
 <xs:simpleType name="string1024Type">
    <xs:restriction base="xs:string">
      <xs:maxLength value="1024"/>
    </xs:restriction>
  </xs:simpleType> 
```

这是根据您的私有类型（在我的情况下是“string1024Type”）和附加的必要属性定义元素的地方：

```
<xs:element maxOccurs="unbounded" name="event">
  <xs:complexType>
    <xs:simpleContent>
      <xs:extension base="string1024Type">
        <xs:attribute default="list" name="node" type="xs:string"/>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
</xs:element> 
```

两个块都可以位于架构的完全不同的位置。重要的一点只是再次关注——你不能在同一个元素定义中混合继承和属性。

# c# - “静态反射”在 java 中是如何工作的？（例如在 mockito 或 easymock 中）

> ID：626328
> 
> 赞同：5
> 
> 时间：2009-03-09T13:55:20.343
> 
> 标签：c#, java, reflection, easymock, mockito

我是 .NET 人 - 我主要使用 C# 编写代码。

从 C# 3.0 开始，我们可以利用 lambda 表达式和表达式树来使用[静态反射](http://www.lostechies.com/blogs/gabrielschenker/archive/2009/02/03/dynamic-reflection-versus-static-reflection.aspx)。例如，可以`GetMethodName`在下面的代码片段中实现返回传入参数的方法名称：

```
string methodName = GetMethodName( o => o.DoSomething());
Console.WriteLine(methodName); // displays "DoSomething" 
```

现在，当我查看 Java 世界中的 Mockito 示例（或 EasyMock 示例）时，我看到：

```
LinkedList mockedList = mock(LinkedList.class);
when(mockedList.get(0)).thenReturn("first"); 
```

**它是如何工作的？**

该方法如何`when`工作？它如何解释`mockedList.get(0)`为对 get 方法的调用，其中 0 作为参数而不是值*传递？*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T14:06:38.820

模拟库通常不适用于表达式树。他们构建了一个实现适当接口的类型，并通过记录或验证方法调用并返回预编程的响应来响应方法调用。这通常通过代理（例如.NET 中的[RealProxy ，Java 中的](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.proxies.realproxy.aspx)[代理](http://java.sun.com/javase/6/docs/api/java/lang/reflect/Proxy.html)）或动态代码生成来完成。

在 EasyMock 的情况下，它使用`Proxy`（无论如何用于接口），正如您在源代码中看到的那样：查看`org.easymock.internal.JavaProxyFactory`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T16:55:50.410

Java 模拟库通常是这样工作的：

当您创建模拟时，会创建一个实际的代理（无论是来自接口还是子类），该实例处于“录制模式”。这意味着记录任何后续调用（方法名称、参数、预期返回）。请注意，录音模式下的代理实际上只记录呼叫。本身不涉及反射。没有元数据发现等。当然，这些库做了一些技巧（例如将调用存储在线程局部变量中以处理返回 void 的方法），但想法保持不变。

然后，当“重播模式”启动时，模拟实例仅检查调用列表中的期望（方法+参数和返回值）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T14:03:16.223

我从未使用过 mockito 或 easymock，但我认为该调用不会像您认为的那样。它不以`mockedList.get(0)`任何特殊方式解释。该方法`get`在`mockedList`对象上正常执行，其*结果*交给`when`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T14:05:33.550

`mockedList.get(0)`是方法调用的语法，并且正是这样做的。该方法的作用并不完全清楚。`mockedList`的运行时类型将是`LinkedList`该方法返回的子类`mock`，它可以在模拟框架认为合适的情况下实现。

# c++ - 在 C++ 应用程序中嵌入 Ruby 解释器

> ID：626333
> 
> 赞同：18
> 
> 时间：2009-03-09T13:56:59.483
> 
> 标签：c++, ruby, scripting

我希望使用 Ruby 作为我的游戏引擎的脚本语言。我找到了描述如何从 C++ 代码调用 Ruby 类的常用文章，反之亦然（例如[这里](http://aeditor.rubyforge.org/ruby_cplusplus/index.html)），但我不太明白如何用这种工作方式做我想做的事......

我的引擎目前使用一种我自己用 Flex 和 Bison 编写的小语言，以及一个基于堆栈的小虚拟机。脚本并不总是从头到尾运行，例如它们有时包含诸如“睡眠 2 秒”或“等待角色完成行走”之类的命令，因此调度程序会密切关注每个脚本的状态和指令指针，并知道何时恢复它们，等等。

所以看起来我真的需要某种嵌入式 Ruby 解释器，我可以对其进行一定程度的控制，而不是简单地调用 Ruby 方法。还是我只是迟钝而遗漏了什么？

我在 Microsoft Visual C++ 中工作，因此理想情况下，任何解决方案都可以很好地轻松编译。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2011-10-28T16:24:34.427

这是一个包含错误处理的示例。

```
#include <iostream>
#include <ruby.h>

using namespace std;

int main(void)
{
  ruby_init();
  ruby_init_loadpath();
  int status;
  rb_load_protect(rb_str_new2("./test.rb"), 0, &status);
  if (status) {
    VALUE rbError = rb_funcall(rb_gv_get("$!"), rb_intern("message"), 0);
    cerr << StringValuePtr(rbError) << endl;
  };
  ruby_finalize();
  return status;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T14:20:11.063

你在正确的轨道上。关键是在您发布的链接中执行类似于[嵌入概念部分的操作。](http://aeditor.rubyforge.org/ruby_cplusplus/index.html#id2866647)简单来说，它只不过是：

```
ruby_init();
ruby_script("some_script"); 
```

您可能需要复制[main.c](http://ruby-doc.org/doxygen/1.8.4/main_8c-source.html)`#ifdef`中的所有内容以使一切正常。从那时起，就是为您想要公开的 C++ 函数构建一个 API，并根据您的设计，对事物进行多线程处理。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T14:21:53.977

您总是可以重新设计脚本的工作方式以适应脚本引擎，而不是试图让引擎与原始脚本范例一起工作。

所以，如果你有这个：

```
proc:
  action 1
  action 2
  sleep a bit
  action 3
end 
```

这将需要将脚本挂起在睡眠线上，请执行以下操作：

```
proc
  action1
  action2
  set timer (time, callback_proc)
end

callback_proc
  action3
end 
```

这让脚本引擎可以巧妙地完成每个方法。它不需要对托管方进行太多更改 - 每个版本都需要某种形式的事件系统，可以重新启动脚本引擎。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-09T17:25:04.823

有一个关于如何将 ruby​​ 嵌入到 C++ 应用程序中的[指南。](https://web.archive.org/web/20160415222459/http://aeditor.rubyforge.org/ruby_cplusplus/index.html)这可能会有所帮助。否则请转到[Ruby 文档](http://www.ruby-doc.org)。在 C中[嵌入 Ruby](http://my.opera.com/subjam/blog/embedding-ruby-in-c-programs)文章也可能会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-14T00:13:02.190

我认为您想要做的是使用 Ruby 的线程。我已经对 Ruby 线程代码进行了相当多的挖掘，并且我知道（在 pthreads 可用的地方）睡眠是使用 pthread_cond_timedwait 以非阻塞方式实现的。这会解除对解释器的阻塞，以便其他线程可以继续执行。

在与 Ruby 解释器交互时，您自己的代码必须尊重 Ruby 的线程。他们在 Ruby 中仍然有一个全局 VM 锁，这意味着您应该小心修改解释器中的任何内容，而不要自己拥有锁。

# c# - 国际化：我应该使用资源还是 MVP 作为标签？

> ID：626337
> 
> 赞同：0
> 
> 时间：2009-03-09T13:58:05.250
> 
> 标签：c#, resources, internationalization

我正在使用 VS 2008 中的 MVP 模式构建 C# WinForms。我将来会将这些迁移到 WPF。这些表单需要支持多种语言的输入标签和菜单。我想将标签文本存储在 SQL Server 数据库中，并根据语言提取正确的标签。

您会使用这些选项中的哪一个（或者可能是其他选项）？

*   使用 Visual Studio 2008 内置资源功能并编写自定义提供程序以从 SQL 获取属性。

*   将标签文本合并到
    MVP 演示器中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T15:04:06.530

由于您的目标是在将来的某个时间更改 UI，因此您应该使表示层尽可能薄，以避免编写大量额外代码。考虑到这一点，在演示者中添加您的全球化/本地化代码并不是一个好主意。内置资源管理的自定义提供程序是比加载演示者 IMO 更好的选择。

查看 Michele Bustamante 在 MSDN 上关于全球化的文章。至于是否将本地化字符串存储在 SQL Server 中，您必须做出决定，因为资源文件可用于多种项目类型。我将不得不找到她关于构建定制全球化提供商的文章。

快速谷歌找到这篇文章： [http ://www.codeproject.com/KB/aspnet/customsqlserverprovider.aspx?fid=308557&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=1619351](http://www.codeproject.com/KB/aspnet/customsqlserverprovider.aspx?fid=308557&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=1619351)

我没有玩过代码，但它似乎是一个好的开始。

# database - 如何维护生产和开发者数据库？

> ID：626338
> 
> 赞同：2
> 
> 时间：2009-03-09T13:58:11.383
> 
> 标签：database, production

在一台机器上工作时，您将如何维护单独的生产和开发数据库，​​您可以透明地切换？我见过一些接近的主题，但似乎没有一个匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T14:03:21.637

调用一个数据库产品和一个开发人员。使用不同的用户名/密码对进行生产和开发。
您可以切换连接字符串并更改数据库、用户名和密码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T14:22:08.813

理想情况下，生产环境不应与开发环境位于同一主机上（因此任何意外长时间运行或密集查询都不会导致生产中断）。

我过去使用的一种方法是同时需要一个 QA 环境和一个开发环境，即使用不同的 SQL Server 实例，它具有数据库间查询相对“安全”的额外优势，并且不需要在环境之间进行更改；然后根据需要使用不同的配置文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T14:02:10.657

我通常看到这是通过两种方式之一完成的。

1.  使用两个配置文件，并根据需要简单地重命名它们以启用每个环境

2.  在机器上使用应用程序/网站的两份副本，一份是生产版，一份是开发版。

我个人更喜欢第二个选项，因为我发现第一个选项很容易意外进入生产数据库。

# c# - 如何使用 MySQL 配置流畅的 nHibernate

> ID：626339
> 
> 赞同：33
> 
> 时间：2009-03-09T13:58:12.303
> 
> 标签：c#, mysql, nhibernate, fluent-nhibernate, autofac

我正在尝试将 nHibernate 配置为使用 MySql 数据库。我找到了 mssql 和 sqlite 的示例，但没有找到 mysql 的示例。那么，我该如何更改它以使其使用 mysql：

```
Fluently.Configure().Database(
        MsSqlConfiguration.MsSql2005.ConnectionString(
            c => c.FromConnectionStringWithKey("ConnectionString")
        )
    )
    .Mappings(m => m.FluentMappings.AddFromAssemblyOf<MyAutofacModule>())
    .BuildSessionFactory()) 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-03-09T14:00:56.070

Change `MsSqlConfiguration.MsSql2005`, to `MySqlConfiguration.Standard`，这是我为这个项目做出贡献的一件事。

例子：

```
Fluently.Configure().Database(
        MySqlConfiguration.Standard.ConnectionString(
            c => c.FromConnectionStringWithKey("ConnectionString")
        )
    )
    .Mappings(m => m.FluentMappings.AddFromAssemblyOf<MyAutofacModule>())
    .BuildSessionFactory()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-20T07:42:47.167

```
var SessionFactory = Fluently.Configure()
    .Database(MySQLConfiguration.Standard.ConnectionString(connectionString))
    .Mappings(m => m.FluentMappings.AddFromAssembly(Assembly.GetExecutingAssembly()))
    .BuildSessionFactory();` 
```

试试这个配置。

# javascript - 我应该学习 Silverlight 还是 JavaScript/JQuery/CSS/HTML？

> ID：626341
> 
> 赞同：18
> 
> 时间：2009-03-09T13:58:44.533
> 
> 标签：javascript, silverlight

我是一名经验丰富的*桌面*开发人员，使用 C++/C#/WinForms/等。到目前为止，我在 Web 开发方面做得*很少*。在我的职业生涯中，我觉得我应该开始做 Web 开发——不是为了取代我的桌面体验，而是为了成为更全面的开发人员。

我已经知道一些 HTML 和 JavaScript，但我并不精通。我对.NET 很满意。

那么你的意见是什么？我应该专注于掌握 HTML/CSS/JavaScript/JQuery（后端使用 ASP.NET 或 PHP），还是应该培养我的 .NET 经验并深入研究 Silverlight？

我对诸如性能、采用率等因素以及应该指导我做出决定的任何其他建议感到好奇。

**PS：**我也读过[这篇](https://stackoverflow.com/questions/477759/javascript-css-vs-silverlight-vs-flex)文章，但和我的问题略有不同。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-09T14:06:21.970

如果您真的希望提高自己作为开发人员的技能并过渡到 Web 开发世界。我强烈建议从 HTML、CSS、JavaScript、jQuery、ASP.NET AJAX 路由开始。

这有很多原因，但最重要的是这些是 Web 开发的基础。最终一切都以 HTML 呈现给用户，而 Javascript/CSS 是我们必须定期处理的事情。CSS 和跨浏览器功能仍然存在问题，理解其工作原理是成为一名熟练的开发人员的基础。

然后是 JavaScript/JQuery 部分，这在许多方面也是现在的基本要求，因为人们期望丰富的功能性用户界面和理解如何利用这些技术是关键。

Sliverlight 也很适合学习，但是，我认为首先需要基础知识和获得一般 Web 开发技术的经验。特别是因为在大多数情况下，silverlight 只是网站的一小部分。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-09T14:10:28.887

有时您可能会使用 Silverlight，但*通常*您会使用 XHTML/JS/CSS。选择应该是不言而喻的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-09T14:06:08.413

特别是。如果您的主要目标是成为一名更全面的开发人员，您应该 IMO 首先尝试进入基础 Web 技术，然后（如果您发现无法用它们解决的问题）将其与您对 .网。

虽然 Silverlight 和 Flash 是帮助解决某些问题的好工具，但它们不应该是您进行 Web 开发时的首选。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-10T14:37:57.130

我在同一条船上。我的感觉是，要赶上已经发展多年的技术非常困难。有些开发人员总是会在 Javascript/Ajax 等上谋杀你……所以我宁愿成为技术的早期采用者。这样一来，您就可以真正擅长某事并学习/犯错误，而无需其他人比您好得多的压力，因为他们有 3 年的领先优势。

至于 Silverlight/Flash 即将到期。我不同意。在 Ajax/Html 中制作 RIA 应用程序所花费的 60% 的时间都花在了让事情看起来不错（或者只是让它们看起来像任何东西......）。对于大多数来自 Winforms 或类似软件的开发人员来说，这并不是很好地利用时间。花时间想知道您的“div”面板是否会正确显示是 80 年代！

IMO，Silverlight 对于内部业务应用程序来说将是巨大的。这更容易！建造更便宜，测试更便宜，看起来更好！对于公司机器上的 30 秒安装，您可能会遇到零部署问题以及在浏览器中看起来像桌面应用程序的应用程序。为什么要使用 Asp.net？由于 Silverlight 旨在正确拆分设计/编程，因此让设计师为您的应用程序设计皮肤也将变得更加容易。

对于企业台式机以外的世界，采用速度会慢一些，这仅仅是因为开发人员受可访问性和让最多人使用他们的东西的驱动（因为每个人都在努力赚钱！）。与移动设备兼容会使大多数公司不敢使用 Silverlight 或 Flash，所以我希望 Ajax 会在一段时间内成为最流行的网络应用程序形式。

目前我在想，我宁愿在特定的发展领域表现出色，也不愿成为万事通。它看起来比把我的生活困在萤火虫里想知道为什么我的 CSS 没有生效要有趣得多！:-)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-09T14:08:14.480

就我个人而言，我会用 XHTML/CSS/JS/一些后端来提高你的技能。虽然 Silverlight 在 Web 上的速度越来越快，但它仍然会像 Flash 一样——整个 Web 编程的一小部分。XHTML/etc 无处不在，它是基础，您会发现它有更多的用途和需求。

如果您不是在寻找“学习一些东西来帮助我找到一份工作”，而是寻找一些东西来让您成为更强大的编程人员，那么我强烈建议您结合 PHP 来学习这些东西。这将与你习惯的有很大的不同。学习完全不同的东西会让你成为一个更强大的程序员。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-09T14:13:34.653

好的，这当然是一个意见问题，但这是我的问题……今天的任何开发人员都应该精通 HTML、JavaScript、CSS 和 SQL。

我刚刚完成了一次用户组之旅，我是开发技术（.NET（我）、PHP、Python 和 Java）小组的一员，我们每个人都同意，你需要先了解网络“语言”。即使您最终参与了 Silverlight 活动，了解网络语言也会帮助您了解您的 silverlight 内容如何融入更大的图景。

不要限制自己，学习网络。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-09T14:22:36.473

我的背景与您相似，因此我决定专注于 Silverlight 2 进行 Web 开发。这实际上取决于您想要进行的开发类型。某些类型的应用程序更适合其中一种应用。

我已经完成了少量的 ASP.NET（使用 AJAX）和 PHP。就个人而言，我不喜欢这种类型的发展。在各种浏览器中处理 HTML/CSS 问题是为了鸟类。调试 Silverlight 2 C# 与调试 HTML/CSS/JavaScript 是一个不同的世界。虽然肯定有一些很棒的 web/AJAX 应用程序，但我不禁觉得这些只是权宜之计。不要误会我的意思，HTML/CSS/JavaScript/AJAX 在网络上的影响力总是比 Silverlight、Flash 等更大。但我从事的是业务线应用程序，并使传统的 Web 模型始终适用于这些应用程序导致巨大的 UI 妥协。我从未接触过 Flash/Flex，所以 Silverlight 2 是我第一次能够交付基于浏览器的应用程序，我可以以与桌面应用程序类似的方式构建/调试/支持该应用程序。

至于 Rich B 关于需要 JavaScript/AJAX 技能才能使用 Silverlight 的评论，对于 Silverlight 1 可能是正确的，但对于 Silverlight 2 则不是这样。当然，将 Silverlight 与传统 Web 开发集成的能力是存在的，但不是强制性的。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-29T19:50:58.857

正如每个人都会说的，答案取决于手头的任务。

也就是说，我选择 Silverlight 2。我正在开发业务线应用程序。去年 12 月，我开始在 ASP.NET MVC 中开发新应用程序。由于与 DIV、CSS 和 JS 的争执感到沮丧，我在假期里几乎没有做任何隐秘的工作，并及时重新实现了我的小应用程序的所有已经编码的功能。

我已经熟悉 XAML（来自我之前做的 WPF 应用程序）确实有所帮助，但我老板的主要胜利点是速度和易于开发。突然间，我不再花时间调整我的表示层，而是编码业务规则。

到目前为止，一切看起来都很棒。我的编码速度稳定，我的工作满意度更高，我再次喜欢编码:)

关键是，对于 LOB，在受控环境中，Silverlight 2 胜出。我不熟悉 Flex，但我听说它在开发工作流程中与 SL2 非常相似。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-09T14:21:37.690

我倾向于认为 Silverlight/Flash 的开发应该留给真正的设计师……他们不仅对图形设计有一定了解，而且对动画流程有深刻的理解。当您使用 Web 技术（特别是 HTML 和 CSS）时，您可以很好地利用设计师组合来创建漂亮的 Web 界面并使用该框架使其与 Javascript/Jquery 一起使用。

更重要的是，Web 应用程序的广度和范围如此之广，以至于可以解决各种各样的问题，而 Silverlight 和 Flash 的应用程序则受到更多限制。虽然使用现有技能组合直接进入 Silverlight 确实具有很强的优势，但 Silverlight 的安装基础足够轻，您将无法轻松地让所有人查看您的工作。

此外，（来自 ASP.NET MVC 程序员）您有很多机会在 ASP.Net 领域培养您的 .Net 技能。我最喜欢 MVC 策略的一点是，我可以再次完全控制我的 HTML（维护外观和感觉的优点），并拥有全套工具，让我能够在很短的时间内构建极其复杂的数据驱动网站它曾经带我去。Web 开发和 winforms 开发之间的唯一区别是您用来与用户交互的媒介。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-09T14:27:52.543

微软的年度 MIX 大会将于 3 月 18 日开始。本次会议的重点是微软的网络技术。从历史上看，会议已在 72 小时内在线发布 ( [http://visitmix.com/](http://visitmix.com/) )。

考虑到我们离 3 月 18 日如此之近，我建议您等着看会宣布什么。那里可能有一些东西让你对一种或另一种技术感到兴奋。我认为找到自己感兴趣的东西对你会更有益。这将使学习过程更加愉快。

Chad Campbell 《Silverlight 2 in Action》的作者

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-09T14:41:53.070

我认为 Silverlight（和 Flash）正在迅速接近其到期日期。随着 JIT 编译器开始出现（如 Chrome、Firefox 3.1 和 Safari 4），JavaScript 变得越来越快，并且随着 HTML 支持变得更好（HTML5），对插件显示精美渲染小部件的需求将会减少。即使在今天，我仍然对使用 HTML+CSS+JS 的可能性感到惊讶，如果没有像 Silverlight 这样的东西，我永远无法想象。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-29T19:36:12.777

我的表弟是一名网页设计师/开发人员，他告诉我很多人希望您了解 Flash 背后的动作脚本，而不仅仅是设计部分。所以另一方面，要充分利用闪存，你需要成为一个体面的程序员。Flash 基本上是设计和编程的结合......所以如果你要掌握这个程序，显然你必须能够做到这两点。一个好的设计师可以让它看起来很漂亮，就是这样。你必须编程才能赋予它功能。

除非有一些我不知道的神奇闪光动作脚本编写器。=/

# algorithm - 如何绘制噪声的频谱？

> ID：626343
> 
> 赞同：-2
> 
> 时间：2009-03-09T13:59:41.240
> 
> 标签：algorithm

我希望在 simulink 中绘制高频开关电路产生的 EMI 噪声。频谱范围显示了 dB 与频率的关系图。我想在对数频率范围内绘制它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T14:23:31.820

如果我理解正确，您有包含频率 -> dB 的数据，并且您想使用频率的对数来绘制它？

例如，如果您有以下情况：

```
Freq   dB
  63   70
 125   75
 250   71
 500   75
1000   65
2000   77
4000   79
8000   74 
```

你想要频率的日志：

```
Freq   dB     Log(Freq)
  63   70     1.8
 125   75     2.1
 250   71     2.4
 500   75     2.7
1000   65     3.0
2000   77     3.3
4000   79     3.6
8000   74     3.9 
```

并将其绘制在图表中：

```
80 |
 - |                           x
76 |                        x
 - |            x     x           x  
72 |
 - |         x     x
68 |
 - |                     x
64 |

     |----|----|----|----|----|----|
    1.0  1.5  2.0  2.5  3.0  3.5  4.0 
```

如果是这样，您只需获取数据并将每个频率转换为频率的对数即可。

# c++ - 无法在 GlowCode x64 中加载符号

> ID：626345
> 
> 赞同：3
> 
> 时间：2009-03-09T13:59:49.320
> 
> 标签：c++, profiling, native, glowcode

这个问题可能太特定于应用程序，无法在 SO 上出现，但这里有。

我正在尝试使用 GlowCode-x64 6.2 分析一个简单的本机 c++ 应用程序。

问题是无论我在**“选项->符号服务器和搜索路径”**中设置哪些设置，符号都不会加载。我的 .pdb 文件也与 .exe 文件位于同一个文件夹中。

进入**“运行->挂钩”**菜单并添加模块时，我总是在“地址”列中看到**“未加载” 。**

我已经多次阅读了启动教程，并且每一步都遵循它。

我什至尝试过使用 AQTime6 分析相同的程序，效果很好。所以我知道调试信息在那里。

我还记得 2 年前在我的 32 位笔记本电脑上使用 GlowCode，并立即让它工作。

非常感谢“再次阅读手册”之外的任何帮助。

编辑：

只是想指出我的应用程序是使用 VS2005 SP1 编译器构建的。

编辑2：

刚下班回家，在家里用Win32试试GlowCode。像魅力一样工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-01-09T10:28:37.910

我访问了 GlowCode 站点，发现 6.2 版只有 32 位版本，而不是 64 位版本。GlowCode 7.0 有安装程序，32 位和 64 位。这可能是你的问题。

# jquery - load() 是否检索具有或不具有其后代的元素？

> ID：626352
> 
> 赞同：1
> 
> 时间：2009-03-09T14:02:07.427
> 
> 标签：jquery, ajax, load

`load()`我使用jQuery 的命令进行了一些测试，例如：`$('<div id="box" />').load('my.html div#content', function(){`等等。我很惊讶地发现我能够检索`div#content`但不能检索它的子元素。当我用`div#content`任何子描述符替换时，例如，`a.opts`我得到了预期的结果——在这种情况下，所有的`.opts`链接。但是，我的内部有许多不同类型的元素，我`div#content;`应该一个一个地调用它们，用一个新的`load()`语句，还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T14:08:33.447

load() 将获取您指定的元素及其所有子元素。您使用的选择器可能有问题。你能发布一些代码吗？

编辑：我猜你正在使用的选择器是罪魁祸首。我不确定到底是什么问题，但您可能想尝试仅使用选择器中的元素 ID（确保您使用的元素具有唯一的 ID）。

这是我过去使用它的方式：

```
$('#targetDiv').load('http://localhost/test.aspx #sourceDiv'); 
```

# javascript - 从下拉列表中选择选项

> ID：626355
> 
> 赞同：1
> 
> 时间：2009-03-09T14:02:46.473
> 
> 标签：javascript, jquery, html

我正在为一个新的美食博客构建一个食谱查找器。我的设计基本上涉及用户从下拉列表中一次选择一种成分，`<select>`该选项从列表中消失（因此他们无法再次选择它）并出现在另一个 HTML 列表中，并带有一个链接以将其从中删除名单。完成后，他们单击一个按钮，然后进入结果页面。

这是 PHP 生成的选择标记：

```
<select>
    <option value="">Please select</option>
    <option value="beef-mince">Beef mince</option>
    <option value="carrots">Carrots</option>
    ...
</select> 
```

它不是非常复杂，但它确实提出了一些关于我将如何做这些事情的问题。我正在使用 jquery。

1.  我需要将所选项目存储在内存中，以便在他们完成选择项目后知道要发送到搜索页面的内容。在您看来，最好的方法是什么，因为每个项目都有两个值（它的“真实”值和它的数据库值）？

2.  在他们选择了某些东西（最好不触发 onchange 事件）之后，如何使“请选择”选定的选项？

3.  一旦我将它存储在内存中并将其添加到他们正在搜索的显示列表中，我如何从可用项目中删除该项目？我可以（安全地）“隐藏”或禁用它吗？

4.  如果在#3 中我必须从 DOM 中删除它，当我再次添加它时，我可以对列表进行排序（基于任一值）并将 please-select 选项保留在顶部吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T14:13:29.660

1.) 您可以将隐藏的表单元素附加到其值为所选选项的值的页面。

2.) `jQuery("#select-list")[0].options[0].selected = true // assuming it's the first item`

3.) 我会使用 jQuery("#select-list option:selected").remove() 从 DOM 中删除元素

4.) 你可以使用 before()。jQuery(your_default_option).before("#select-list option:first");

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T14:15:24.400

1）基本思路，你需要检查以确保第一个没有被选中

```
var selections = [];
var mySel = document.getElementById("mySelectId");
var ind = mySel.selectedIndex;
selections.push( mySel.options[ind].value ); //add to a list for you to remember
mySel.options[ind] = null; //remove 
```

2) mySel.selectedIndex = 0;

3) 见#1

4）是的，您可以使用 insertBefore 将其添加到您想要的任何位置

此处示例：http: [//www.pascarello.com/lessons/forms/moveSelectOptions.html](http://www.pascarello.com/lessons/forms/moveSelectOptions.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T14:18:20.787

1.  您可以将“两个值”作为 JSON 表示法中的对象存储在隐藏的表单字段中。当用户与页面交互时，这将使在 jQuery 中进行修改变得容易。

2.  您将需要结合使用 onchange、keyup 和 keydown 事件来捕获对表单的可能更改，以便您可以重新选择“请选择”选项。

3.  您需要从 dom 中删除该选项并稍后重新添加。您可以通过 jquery 通过以下方式轻松完成此操作：

    $("选择选项：选择").remove();

4.  您可以为从索引 1 开始的选项编写排序函数，并将“请选择”保留为第一个选项。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-03-09T14:09:51.010

将把这个答案留在这里，但我认为我没有阅读你的整篇文章，所以它可能没有多大帮助。

你需要给你的选择一个像这样的 id：

```
<select id="MySelect">        
    <option value="">Please select</option>
    <option value="beef-mince">Beef mince</option>
    <option value="carrots">Carrots</option>
    ...
</select> 
```

得到它就是这样的：

```
<?php
    $value = $_REQUEST["MySelect"];
    echo $value;
?> 
```

代码未经测试，并且 $_REQUEST 可以替换为 $_GET 或 $_POST 关于您在表单上指定为操作的内容。$_REQUEST 会吃掉它。

# html - 浏览我的页面时如何在浏览器地址栏中添加图片？

> ID：626371
> 
> 赞同：7
> 
> 时间：2009-03-09T14:08:08.863
> 
> 标签：html, favicon

### 复制：

> [站点 URL 旁边的图像图标](https://stackoverflow.com/questions/120420/image-icon-beside-the-site-url)
> 
> [目前在所有支持 Favicon 的浏览器中显示 favicon 的最佳方式是什么？](https://stackoverflow.com/questions/37073/what-is-currently-the-best-way-to-get-a-favicon-to-display-in-all-browsers-that-s)
> 
> [使用网站图标的首选方式？](https://stackoverflow.com/questions/6642/preferred-way-to-use-favicons)

我想在浏览器的地址栏中添加我的徽标，无论何时浏览。

如何制作网站图标？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-09T14:09:43.447

您需要一个[favicon](http://en.wikipedia.org/wiki/Favicon) - 这是一个[.ico](http://en.wikipedia.org/wiki/ICO_(icon_image_file_format))格式的 16x16 图像，作为 favicon.ico 存储在您网站的根目录中。一些浏览器也支持其他格式。

一种更新的、更基于标准的方法是在您的 html 头中包含类似这样的内容：

```
<link rel="icon" type="image/png" href="/path/image.png"/> 
```

另请参阅 W3C 的此文档：[如何将 Favicon 添加到您的站点](http://www.w3.org/2005/10/howto-favicon)

您可能还想参考这个问题的其他答案：

*   [站点 URL 旁边的图像图标](https://stackoverflow.com/questions/120420/image-icon-beside-the-site-url)
*   [目前在所有支持 Favicon 的浏览器中显示 favicon 的最佳方式是什么？](https://stackoverflow.com/questions/37073/what-is-currently-the-best-way-to-get-a-favicon-to-display-in-all-browsers-that-s)
*   [使用网站图标的首选方式？](https://stackoverflow.com/questions/6642/preferred-way-to-use-favicons)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T14:13:14.997

该图像称为网站图标，这里有一些有关如何添加的链接，或者您可以谷歌“如何添加网站图标”以获取更多信息。

[http://www.w3.org/2005/10/howto-favicon](http://www.clickfire.com/favicon-tutorial)

[http://www.clickfire.com/favicon-tutorial](http://www.clickfire.com/favicon-tutorial)

[http://essentialkeystrokes.com/tutorial-how-to-create-your-own-favicon](http://essentialkeystrokes.com/tutorial-how-to-create-your-own-favicon)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T14:10:22.350

见[http://en.wikipedia.org/wiki/Favicon](http://en.wikipedia.org/wiki/Favicon)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T14:10:51.040

您是在谈论创建[Favicon](http://en.wikipedia.org/wiki/Favicon)吗？

如果是这样，[这里有一个网站](http://www.favicon.co.uk/)可以帮助您制作一个。

# c++ - 如何有条件地选择我在 C++ DLL 中通过 COM 调用的 C# 类？

> ID：626373
> 
> 赞同：1
> 
> 时间：2009-03-09T14:08:32.527
> 
> 标签：c++, com, interface, createinstance

在我的 StackOverFlow 兄弟们的大力帮助下，我设法创建了一个 C++ DLL，它通过 COM 调用我的 C# 类并将数据来回传递给外部应用程序。在该代码开始工作后，王国里有很多庆祝活动。

现在我有一个新问题。我正在扩展 DLL，以便它可以调用不同的类（都实现相同的接口）。我需要根据加载时传递给 DLL 的 char 数组来决定调用哪个类。无论我使用哪个类，我调用的方法都是完全相同的。调用 DLL 时在类之间切换的最佳方法是什么？

```
 // Initialize COM. 
 HRESULT hr = CoInitialize(NULL);

// I want to do something like this....but how? 
if (strcmp(modelType, "Model1") == 0) { 
        IUnitModelPtr pIUnit(__uuidof(ClassOne));
    }   

    if (strcmp(modelType, "Model2") == 0) { 
        IUnitModelPtr pIUnit(__uuidof(ClassTwo));
    }

//call method 1

//call method 2

CoUninitialize();

//exit 
```

这可能是一个相当简单的问题，但我真的不知道任何 C++。让 COM 运行对我来说是一个重大挑战。

编辑：我确定有一些超级优雅的方法可以实现这一点（反思？），但请将您的建议限制在可以轻松实现的东西上......效率在这里并不重要，可维护性也不是真正的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T14:18:23.987

这样做：

```
GUID classId = GUID_NULL;
if( strcmp( modelType, "Model1" ) == 0 ) {
    classId = __uuidof( class1 );
} else if( strcmp( modelType, "Model2" ) == 0 ) {
    classId = __uuidof( class2 );
} else if(... etc, continue for all possible model types
}
IUnitModelPtr unit;
unit.CreateInstance( classId );
// interface methods can be called here 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T14:19:45.107

两种选择。

由于每个不同的接口实现都是一个 coclass，并且您的 C++ 代码使用正确的 prog-id/classid 来执行创建。

或者，暴露的 coclass 是一个带有返回实际实现类的方法的工厂。

两者都需要逻辑来将您映射`modelType`到实现类。您可以在 C++ 代码或 .NET 代码中执行此操作。没有关于整体上下文的更多信息（在逻辑上是 COM 组件或调用者的字符串 --> coclass 映射的一部分）。

（在纯 C++ COM 实现中，您可以创建自己的自定义 COM 实例工厂，但这是更高级的 COM，不适用于 .NET COM 互操作。）

# xml - 如何扩展此 XSLT 以动态包含 XML 字段？

> ID：626387
> 
> 赞同：1
> 
> 时间：2009-03-09T14:11:55.203
> 
> 标签：xml, xslt

我们需要使用 XSLT 将 XML 文件解析为 CVS 文件。下面的代码有效*，但*前提是 XML 中的字段始终保持不变。

我们的 XML 文件中的字段总是不同的。**如何更改我的 XSLT 文件，以便它在 CSV 文件中动态包含XML 文件中的*所有字段？***

XML:

```
<?xml version="1.0" encoding="iso-8859-1"?>
<data>
    <row>
        <customerID>06104539-463E-4B1A-231-34342343434</customerID>
        <contactID>23434-99F2-4325-B228-6F343483469389FB</contactID>
        <firstName>Jim</firstName>
        <lastName>Smith</lastName>
    </row>
    <row>
        <customerID>223434-463E-4B1A-231-A1E7EA248796</customerID>
        <contactID>6675767-99F2-4325-B234328-6F83469389FB</contactID>
        <specialID>112332</specialID>
        <firstName>John</firstName>
        <middleName>S.</middleName>
        <lastName>Jones</lastName>
    </row>
</data> 
```

XSLT：

```
<?xml version="1.0" encoding="ISO-8859-1"?>

<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/">
    customerID,contactID<br/>
    <xsl:for-each select="data/row">
        <xsl:value-of select="customerID"/>,<xsl:value-of select="contactID"/><br/>
    </xsl:for-each>
</xsl:template>

</xsl:stylesheet> 
```

这是解析上述文件的 ASP.NET 文件：

```
<%@ Page Language="c#" %>
<%@ import Namespace="System.Xml" %>
<%@ import Namespace="System.Xml.Xsl" %>
<%@ import Namespace="System.Xml.XPath" %>
<%@ import Namespace="System.IO" %>
<%@ import Namespace="System.Text" %>
<script runat="server">

    public void Page_Load(Object sender, EventArgs E) {

        string xmlPath = Server.MapPath("test2.xml");
        string xslPath = Server.MapPath("test2.xsl");

        StreamReader reader = null;;
        XmlTextReader xmlReader = null;

        FileStream fs = new FileStream(xmlPath, FileMode.Open, FileAccess.Read);
        reader = new StreamReader(fs,Encoding.UTF7);
        xmlReader = new XmlTextReader(reader);
        XPathDocument doc = new XPathDocument(xmlReader);

        XslTransform xslDoc = new XslTransform();
        xslDoc.Load(xslPath);

        xslDoc.Transform(doc,null, Response.Output);

        reader.Close();
        xmlReader.Close();

    }

</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T15:26:14.040

我记得以前做过类似的事情，然后翻阅我的档案工作，你瞧：

```
<?xml version="1.0" encoding="ISO-8859-1"?>

<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:key name="muench" match="/data/row/*" use="local-name()"/>

    <xsl:template match="/">
        <xsl:for-each select="/data/row/*[generate-id() = generate-id(key('muench',local-name())[1])]">
            <xsl:if test="not(position()=1)">,</xsl:if><xsl:value-of select="local-name()"/>
        </xsl:for-each>
        <br/>
        <xsl:for-each select="/data/row">
            <xsl:variable name="current" select="."/>
            <xsl:for-each select="/data/row/*[generate-id() = generate-id(key('muench',local-name())[1])]">
                <xsl:variable name="field" select="local-name()"/>
                <xsl:if test="not(position()=1)">,</xsl:if><xsl:value-of select="$current/*[local-name()=$field]"/>             
            </xsl:for-each>
            <br/>
        </xsl:for-each>
    </xsl:template>

</xsl:stylesheet> 
```

所有人都欢呼丑陋但实用的产品。

我对此并不感到自豪，但是我已经更新了您的数据并对其进行了测试，并且可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T15:00:30.780

另一个 for-each 循环不会为您完成这项工作吗？

```
<?xml version="1.0" encoding="ISO-8859-1"?>  
  <xsl:stylesheet version="1.0"xmlns:xsl="http://www.w3.org/1999/XSL/Transform">  
    <xsl:template match="/">  
      customerID,contactID<br/>  
      <xsl:for-each select="data/row">  
        <xsl:for-each select="*">  
          <xsl:value-of select="."/>,  
        </xsl:for-each>  
        <br/>      
      </xsl:for-each>  
   </xsl:template>  
</xsl:stylesheet> 
```

问候，

亚伦

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T15:14:43.710

这里的问题是第一个“行”可能包含 3 个元素和其他行 5​​ 个元素。所以很难提取标题。

排序使用[xsl:sort](http://www.w3schools.com/xsl/el_sort.asp)

要计数，请使用 xslt 函数[count()](http://www.w3schools.com/xpath/xpath_functions.asp)

按元素数量排序，获取标题，在标题中创建项目集合，然后针对每一行扫描这些元素。

# java - 如何将 Java 控制台输出通过管道传输到文件？

> ID：626389
> 
> 赞同：18
> 
> 时间：2009-03-09T14:12:48.977
> 
> 标签：java, testing, logging, java-web-start

我在一个完全冻结 JVM 的应用程序中发现了一个错误。生成的堆栈跟踪将为开发人员提供有价值的信息，我想从 Java 控制台检索它。当 JVM 崩溃时，控制台被冻结，我无法再复制包含的文本。

有没有办法将 Java 控制台直接通过管道传输到文件或其他访问 Java 应用程序控制台输出的方法？

更新：我忘了提，没有改变代码。我是手动测试员。

更新 2：这是在 Windows XP 下，它实际上是一个 Web 启动应用程序。管道输出

```
javaws jnlp-url
```

不起作用（空文件）。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-09T14:51:01.677

实际上可以在 Java 控制面板中激活[跟踪。](http://java.sun.com/javase/6/docs/technotes/guides/deployment/deployment-guide/tracing_logging.html#tracing)这将在跟踪文件中通过管道传输最终在 Java 控制台中的任何内容。

日志文件将结束于：

*   Unix/Linux 上的 <user.home>/.java/deployment/log
*   <用户应用程序数据文件夹>\Sun\Java\Deployment\log 在 Windows 上
*   /~/库/缓存/Java/在 OS X 上登录

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-09T14:14:58.753

（如果您可以修改代码）您可以将该`System.out`字段设置为不同的值：

```
System.setOut(new PrintStream(new FileOutputStream(fileName))); 
```

如果您正在运行脚本（通过 调用程序`java`），`Unix`您可以执行以下操作：

```
/path/to/script.sh >& path/to/output.log 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-06T12:42:28.643

在 Mac 10.8.2 中，可以在`/Users/<userName>/Library/Application Support/Oracle/Java/Deployment/log/`.

Before you have to enable logging from Java Control Panel. Option "`Enable logging`" is at tab "`Advanced`". Java Control Panel could be started from "`System preferences`".

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T14:26:33.997

冻结的控制台可能意味着死锁（也可能意味着重复抛出异常）。您可以使用`jstack`. `jps`可能会使查找过程更容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-26T11:03:36.760

try [this guide](http://seguide.blogspot.com/2010/02/writing-console-output-to-file-in-java.html) it works for me. it also guides you that how you can set "System.setOut(fileStream);", "System.setErr(fileStream);"

# reporting-services - SQL Reporting Services 2005 本地时区

> ID：626390
> 
> 赞同：3
> 
> 时间：2009-03-09T14:12:53.313
> 
> 标签：reporting-services, timezone

我们将日期/时间信息以 UTC 格式存储在 SQL Server 上。

使用 SQL Reporting Services 时，我们希望在客户端工作站的时区中显示此数据，但似乎使用如下表达式；

```
System.TimeZone.CurrentTimeZone.ToLocalTime(Fields!DateStarted.Value) 
```

...转换为服务器的时区，而不是客户端工作站的时区？

有什么办法可以在本地执行这种转换，或者将本地时区传递给服务器进行转换？

在此先感谢马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T15:56:32.783

如果您的报告是独立的，除了添加时区报告参数之外，我看不到其他选项。

But if you using reports inside web application, you can [Determine Timezone from Request Variables with JavaScript](https://stackoverflow.com/questions/338482/can-you-determine-timezone-from-request-variables) and send time zone value back in hidden fields, urlparameter or postback.

You can also add timezone to user registration info (or figure it out from Country and City fields).

Also you may try [Target Your Visitors Using GeoIP and .NET](http://www.codeproject.com/KB/asp/geoip.aspx).

# version-control - 是否可以在没有外壳访问的共享主机上进行版本控制？

> ID：626391
> 
> 赞同：4
> 
> 时间：2009-03-09T14:12:57.353
> 
> 标签：version-control, shared-hosting

我有一个主机不允许 shell 访问的客户端。是否有任何多用户版本控制系统可以在这种情况下工作（在 linux 上）？他不愿意换主人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T14:15:48.517

是的，因为您**不直接在生产服务器上进行开发！** 生产服务器的内容只是源存储库的视图，它保存在其他地方，以便可以在单独的开发服务器上完成工作。这样，开发服务器上的愚蠢错误就不会影响您的生产系统。如果这意味着进行手动结帐以传输文件，那就这样吧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T14:19:28.617

不是您正在寻找的答案，而是获得更好的托管服务提供商。您的托管服务提供商是否正在为您做一些特别的事情，让您想要忍受没有外壳访问，甚至不只是为您预安装 SVN？有大量非常便宜的主机可以为您提供已经安装的 SVN 和 shell 访问权限。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-29T03:06:07.940

我正是出于这个原因使用 Bazaar。如果服务器支持 ftp 或 ftps，则支持 Bazaar。 [http://bazaar.canonical.com/](http://bazaar.canonical.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-06T22:41:01.873

我一直在寻找同样的东西，我有一个无外壳访问的托管服务提供商，没有包含源代码控制并且不想更改。

目前，我正在使用 git。但我没有使用`git push`更新远程存储库，而是使用脚本和 FTP 来更新服务器的副本。

`git pull`如果 ftp git 目录可通过 http 访问，则可以从任何客户端正常工作。

git推送替换：

```
git update-server-info
perl ftpsync.pl -v .git ftp://ftp.example.com/gitrepo/project.git
  ftpuser=user@example.com ftppasswd=* 
```

那是使用 ftpsync，来自 Sourceforge [ftpsync 页面](http://sourceforge.net/projects/ftpsync/)。它是 git 推送的不完美替代品，它镜像本地仓库，而不是将其与远程合并，因此请确保本地仓库是最新的 git pull 首先。

git-ftp 声称做同样的事情。Github 的[git-ftp 页面](http://wiki.github.com/ezyang/git-ftp/)。可能比 ftpsync 效果更好，因为它是为此目的而设计的，但我还没有尝试过。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T14:15:25.600

当然，SVN 可以有多个用户和多个存储库。当然取决于您的主机是否愿意安装它。如果这不起作用，也许您会考虑在其他地方托管您的版本控制？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T14:18:50.070

您的意思是要将版本控制存储库存储在主机上，然后从多个客户端访问它吗？如果是，那么所有现代版本控制系统都可以这样工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-18T20:26:04.533

我刚刚在 Mercurial 特定问题上发布了这个答案，但它也适用于这里。我使用 Mercurial，并找到了一个指南，让我只能通过 FTP/控制面板访问（无外壳）来安装它。

[http://javadocs.wordpress.com/2010/04/27/set-up-mercurial-1-5-1-on-a-shared-host-simplified/](http://javadocs.wordpress.com/2010/04/27/set-up-mercurial-1-5-1-on-a-shared-host-simplified/)

# c# - 数据层和业务层之间的类型转换

> ID：626396
> 
> 赞同：1
> 
> 时间：2009-03-09T14:13:41.953
> 
> 标签：c#

我有两个标准层，即包含相似对象的业务层和域层，现在我想提供一些标准方法来从双方来回转换对象。我找到了三个选项。

1.  使用隐式或显式转换。
    *   我基本上不喜欢它们，因为它们不提供干净的界面，并且在转换时没有适当的指示可用。
2.  使用[TypeConverter](http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverter.aspx)类
    *   这提供了我正在寻找的方法，但它迫使我从这个类继承，如果它是一个接口而不是一个类，我很乐意这样做。因为它会限制我的选择。
3.  使用[IConvertable](http://msdn.microsoft.com/en-us/library/system.iconvertible.aspx)
    *   这仅允许转换为基本类型，但不允许转换为自定义类型。
4.  创建我自己的界面
    *   我可以创建自己的界面，允许我进行正确的验证以及像 IConvertable 这样更干净的界面，但我只是想有没有其他可用的选项，而不是重新发明轮子

那么 .NET 中还有哪些其他方法可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T14:26:42.810

我认为[AutoMapper](http://www.codeplex.com/AutoMapper)是您正在寻找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T14:25:28.947

您可以使用反射将具有相同名称（和数据类型）的属性从一个类复制到另一个类。

如果您想更进一步，您可以使用反射来生成将一个类复制到另一个类的类。

# sql-server - 如何将 ssis 包从 Dev 转移到 Prod？

> ID：626397
> 
> 赞同：2
> 
> 时间：2009-03-09T14:14:23.840
> 
> 标签：sql-server, ssis

我正在尝试使用配置文件将我的包移至生产环境，但文件仅部分更改，结果仍会发送到 DEV 服务器。

有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T16:05:06.630

如果不访问配置文件，很难找出问题的原因。

我建议您做的是使用在您的环境中引用数据库的包配置。然后可以使用每个环境独有的环境变量来引用数据库本身。

这是一个很好的节省时间的方法，也是集中管理所有 SSIS 包配置的好方法。有关详细信息，请查看以下参考。

[http://www.mssqltips.com/tip.asp?tip=1405](http://www.mssqltips.com/tip.asp?tip=1405)

配置完成后，您可以在开发和生产之间部署相同的包，而无需对 SSIS 包进行任何修改或弄乱配置文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-11T20:00:54.490

我个人的技术是首先拥有一个将包指向基于 SQL 的包配置（到配置数据库的连接字符串）的配置文件。包配置中的后续条目使用 SQL 存储来加载它们的设置。我有一个脚本进入包的 XML 并准备它们以部署到阶段或生产。配置文件包含包配置的初始文件配置条目的名称以及阶段和产品配置数据库配置文件所在的位置。该脚本为 stage 和 prod 生成两个子目录。每个目录都有针对其特定部署修改的解决方案包的副本。

还！不要忘记关闭包文件中的加密！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T17:01:39.413

即使您使用的是配置文件，您的包中仍然可以有硬编码的连接。您还需要检查每个连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T08:19:45.977

大家并感谢您的回答。我设法以一种丑陋的方式解决了这个问题 - 在服务器上编辑包，但我想要更优雅的解决方案 - 现在我正在尝试使用环境变量，它看起来很棒，但是我得到的向导与链接中给出的不同 - 我不知道如何继续。（我使用的是 VStudio 2005）此外，我尝试将配置文件作为 XML，但即使在源机器上包运行也会失败，所以我卡住 ！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T17:16:15.180

你也可以走很远的路。进入集成服务并将存储的包导出到其 dtsx 文件。然后，您可以在任何好的文本编辑器中打开文件，在您的服务器名称上进行查找/替换，然后返回集成服务并导入更新的包。很多时候只是更容易...

# asp.net - 颠覆提交时要忽略的文件夹

> ID：626399
> 
> 赞同：7
> 
> 时间：2009-03-09T14:15:00.797
> 
> 标签：asp.net, visual-studio, svn

我不能将哪些文件夹提交到颠覆服务器？

我说的是 Visual Studio 2.008 中的标准 asp.net Web 应用程序。我认为 bin 文件夹，因为它的文件被重新生成，还有其他的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-09T14:21:14.697

我们把这个字符串作为我们所有项目的 svn:ignore 属性：

```
*.pdb  
*.exe  
*.dll  
debug/*  
release/*  
*.user  
*.suo  
obj/*  
bin/*  
obj  
bin  
VSMacros80 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T13:24:28.327

对于任何 C# 项目，我建议忽略以下文件/目录：

**要忽略的 Visual Studio 文件**

*   `*.pdb`— 调试时保存状态信息的文件。
*   `*.exe`— 可执行二进制文件。
*   `*.dll`— 库二进制文件。
*   `debug/*`— Visual Studio 用来存储大量调试信息的文件夹
*   `release/*`— Visual Studio 用于存储二进制版本的文件夹。
*   `*.user`— 每个用户的配置。
*   `*.suo`— 以二进制格式存储的每个用户的选项设置。
*   `obj`— Visual Studio 用于存储调试时使用的二进制对象的文件夹。
*   `bin`— Visual Studio 用来存储编译对象的文件夹。
*   `VSMacros80`— Visual Studio 用来存储宏的文件夹。

**其他要忽略的文件**

*   `packages`— 用于 NuGet 引用的文件夹。
*   `*.log`— 如果在源文件夹中写入日志（*这不应该发生*）。

**注意：**请记住添加这些模式以递归方式忽略。

* * *

**额外（复制粘贴）**

```
*.pdb  
*.exe  
*.dll  
debug/*  
release/*  
*.user  
*.suo
obj  
bin  
VSMacros80
packages
*.log 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T14:21:55.240

obj 是另一个，因为它们是在编译期间构建的调试符号。

# weblogic - JMX 能满足我的要求吗？

> ID：626400
> 
> 赞同：0
> 
> 时间：2009-03-09T14:15:11.840
> 
> 标签：weblogic, jmx

我对[JMX](http://java.sun.com/javase/technologies/core/mntr-mgmt/javamanagement/)完全陌生。我有一个特定的要求，想知道是否可以在 JMX 的范围内完成。

### 要求：

我有一组资源，其中包括跨许多服务器运行的许多 weblogic 实例、 [jBoss](http://www.jboss.org/)实例和[Tomcat实例。](http://tomcat.apache.org/)现在我需要一个一站式解决方案，UI 来监控这些资源，检查它们的当前状态，如果它们关闭，我需要从该网页启动和停止它们。

这可能使用 JMX 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T14:22:54.957

您可以将[nagios](http://www.nagios.org)与[check_jmx](http://www.nagiosexchange.org/cgi-bin/page.cgi?g=2338.html;d=1)结合使用来监控（[创建统计信息](http://www.pnp4nagios.org/)）并可能触发资源的重新启动。（我不确定是否可以通过 JMX 直接触发重启）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-06T22:12:53.123

查看 Jopr，[http: //www.jboss.org/jopr/](http://www.jboss.org/jopr/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-26T07:28:07.530

[jmx4perl](http://www.jmx4perl.org)带有一个功能齐全的 Nagios 插件[check_jmx4perl](http://search.cpan.org/~roland/jmx4perl/scripts/check_jmx4perl)用于访问 JMX 信息。它带有一组针对各种资源的预配置检查，目前用于 JBoss、Tomcat 和 Jetty（更多资源正在准备中）。

# objective-c - Objective-c 中的 for 循环 - 原始数组

> ID：626408
> 
> 赞同：1
> 
> 时间：2009-03-09T14:17:33.253
> 
> 标签：objective-c, for-loop, primitive

```
int matrix[3][3] = {
      {1,2,3},
      {1,2,3},
      {1,2,3},
} 
```

我怎样才能循环它？

基本上长度操作是我关心的。

```
for (int i=0; XXXXX; i++) {
  for (int j=0; XXXX; j++) {
      int value = matrix[i][j];
 }
} 
```

编辑：是否有获取数组大小的动态方法？像`sizeof()`什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T14:29:21.353

对于静态创建的数组类型，您可以使用 sizeof 运算符，例如

```
sizeof(myArray) / sizeof(myArray[0]) 
```

对于动态创建的数组（即由指针引用），这将不起作用（sizeof 只会为您提供系统上指针的大小）。在这种情况下，您需要常量或数组中的标记值。使用哨兵，只需扫描每个轴，直到找到它的长度（这就是 C 字符串的工作方式，使用 \0）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T14:54:51.760

在 C 中，我会执行以下操作，请尝试：

```
sizeof( matrix ) /sizeof( matrix[0] )         <- outer array
sizeof( matrix[0] )/ sizeof( matrix[0][0] )   <- inner array

linux ~ $ cat sizeof_test.c
#include <stdio.h>

int main( void )
{
        int matrix[][3] = { {1,2,3}, {1,2,3}, {1,2,3}, };
        int matrix2[][3] = { {1,2,3}, {1,2,3}, {1,2,3}, {1,2,3}, };
        int matrix3[][4] = { {1,2,3,4}, {1,2,3,4}, {1,2,3,4}, {1,2,3,4}, };

        printf( "array (%d) - elements( %d )\n", sizeof( matrix ) /sizeof( matrix[0] ), sizeof( matrix[0] )/ sizeof( matrix[0][0] ));
        printf( "array (%d) - elements( %d )\n", sizeof( matrix2 ) /sizeof( matrix2[0] ), sizeof( matrix2[0] )/ sizeof( matrix2[0][0] ));
        printf( "array (%d) - elements( %d )\n", sizeof( matrix3 ) /sizeof( matrix3[0] ), sizeof( matrix3[0] )/ sizeof( matrix3[0][0] ));

        return 0;
}
linux ~ $ gcc sizeof_test.c -o sizeof_test
linux ~ $ ./sizeof_test
array (3) - elements( 3 )
array (4) - elements( 3 )
array (4) - elements( 4 )
linux ~ $ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T14:21:10.267

您可以像在 C 中一样执行此操作：

```
int matrix[3][3] = { {1,2,3}, {1,2,3}, {1,2,3}, };

for(int i = 0; i < 3; i++)
{
    for(int j = 0; j < 3; j++)
    {
        int value = matrix[i][j];
    }
} 
```

不过，我建议使用常量而不是魔术 3。将使一切更具可读性，尤其是 for 循环。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-03-09T14:21:40.577

顶级数组的长度为 3，每个子数组的长度为 3，所以这应该有效：

```
for( int i = 0; i < 3; ++i ) {
      for( int j = 0; j < 3; ++j ) {
           // do something here for each element
      }
 } 
```

# asp.net - 可以将 asp:CheckBox 控件动态添加到 TableCell 中吗？

> ID：626410
> 
> 赞同：1
> 
> 时间：2009-03-09T14:17:48.980
> 
> 标签：asp.net, checkbox

在我的 .NET 应用程序中，我需要为动态创建的 asp:Table 中的每一行添加一个复选框。是否可以通过为每一行动态创建一个 asp:CheckBox 并以某种方式将其放在 TableCell 对象中来做到这一点？（在那种情况下怎么办？）

或者我是否需要将 asp:table 控件替换为其他东西，例如 Repeater 控件或 GridView 以使其工作？

我正在寻找最快的解决方案，因为我没有太多时间。

提前致谢！

/伊尔瓦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T15:20:11.077

在 aspx 中：

```
<asp:Table id=T1 runat=server /> 
```

在cs中：

```
TableCell tc;
foreach(TableRow tr in T1.Rows)
{
    tr.Cells.Add(tc = new TableCell());
    ((IParserAccessor)tc).AddParsedSubObject(new CheckBox());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T15:45:40.920

您不想在服务器端执行此操作（如 Yossarian 所说，在 cs 中）。因为每次重新加载或刷新您的页面时，您都必须重新创建这些复选框，这意味着每次加载新的复选框，这也意味着您的复选框控件信息将丢失，因为它们不在客户端，所以所有更新的信息用户完成的（复选框选中）将丢失，因此您希望能够找出检查的内容，除非您添加 jquery 并且它开始变得更加复杂，然后需要

如果您使用的是网页，那么最好使用 asp:Gridview Web 控件并将数据绑定到后面代码中的表格，如下所示：

```
 Gridview.Datasource=//ex:data; 

  Gridview.Databind(); 
```

如本页示例所示[here](http://www.codeproject.com/KB/miscctrl/GridViewCheckBox.aspx)

但是如果您使用的是 MVC，那么您可以将它们以如下形式添加到客户端代码中：

```
 <% using (Html.BeginForm("Presentation", "Home")) %>
        <% { %>
  <table id="Table" class="color" width="100%" border="1"> 
<colgroup width="3%" ></colgroup>
<colgroup width="15%"></colgroup>
<colgroup width="20%"></colgroup>
<colgroup width="15%"></colgroup>
<colgroup width="47%"></colgroup>
<thead>
    <tr class="dxgvHeader_Glass"> 
         <th id="CheckBox" class="style1" ><input type="checkbox" class="selectall" id="selectall" name="CheckBox" /></th>

         <th id="DateTime"  runat="server"></th>  
         <th id="Description" runat="server"></th>
    </tr>
</thead> 
<tbody >
<%try
  { %>
   <% foreach (var SamAuditLog in ViewData.Model)
      { %>
        <tr>

            <td class="style1" align="center"><%=Html.CheckBox(""+data.ID) %></td>

             <td><%= data.DateTime%></td>
             <td><%= data.Description%></td>
        </tr>
    <% } %>      

 <%} %>

</tbody> 
```

# php - 命令行中的 PHP 服务器名称

> ID：626416
> 
> 赞同：40
> 
> 时间：2009-03-09T14:19:00.693
> 
> 标签：php, command-line, command-line-interface

有没有办法从命令行检测运行 PHP 脚本的服务器的名称？

对于通过 HTTP 访问的 PHP，有很多方法可以做到这一点。但似乎没有办法为 CLI 做到这一点。

例如：

```
$_SERVER['SERVER_NAME'] 
```

不能从命令行获得。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-03-09T14:36:40.870

```
echo php_uname("n"); 
```

见[http://php.net/manual/en/function.php-uname.php](http://php.net/manual/en/function.php-uname.php)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2010-12-28T13:07:21.247

```
<?php
echo gethostname(); // may output e.g,: sandie 
```

见[http://php.net/manual/en/function.gethostname.php](http://php.net/manual/en/function.gethostname.php)

gethostname() 是一个方便的函数，它与 PHP 5.3 的功能相同`php_uname('n')`并且是从 PHP 5.3 开始添加的

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-09T14:31:53.783

出于同样的原因，当您从 CLI 运行 PHP 时，SERVER_NAME 不可用。

当您从 CLI 运行 PHP 时，您将启动自己的 PHP 解释器，它运行您传递给它的任何代码，而无需任何类型的服务器。因此，从 CLI 来看，PHP 对您没有明确告诉它的 Web 服务器一无所知。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T14:23:33.723

尝试：

```
$servername = trim(`hostname`); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-05-05T19:59:49.130

调用 CLI 并使用 gethostname 命令：

```
php -r "echo gethostname();" 
```

印刷：

```
your_hostname 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-04-09T12:53:42.727

为了从命令行获取主机名，**您**还需要使用 php -r 运行。在linux上我使用：

```
~#php -r 'echo php_uname("n");'
hostname 
```

在我使用的 Windows 上：

```
D:\xampp\php>php -r "echo php_uname('n');"
MB-PC 
```

此外，当通过控制台访问时，PHP 不提供许多经典的 $_SERVER 值，但在我访问的服务器上只有以下键：

```
root@hermes:~# php -r 'foreach($_SERVER as $key =>$value){echo $key.",";}'
TERM,SHELL,SSH_CLIENT,SSH_TTY,USER,LS_COLORS,MAIL,PATH,PWD,LANG,SHLVL,HOME,LOGNAME,SSH_CONNECTION,LESSOPEN,LESSCLOSE,_,PHP_SELF,SCRIPT_NAME,SCRIPT_FIL
ENAME,PATH_TRANSLATED,DOCUMENT_ROOT,REQUEST_TIME,argv,argc 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-06-06T16:19:20.710

您可以将 php 脚本添加到将为您设置 $_SERVER['SERVER_NAME'] 的命令行。这是我使用它的方式：

> C:\SDK\php-5.5.25-Win32-VC11-x86\php.exe -S localhost:8080 -t D:\Projects\Sites\mysite router.php

路由器.php

```
<?php
$_SERVER['SERVER_NAME'] = 'localhost:8080';
return false;    // serve the requested resource as-is.
?> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-09T14:21:48.393

可能是因为如果您从命令行运行脚本，则不涉及服务器？

* * *

## 回答 #9

> 赞同：-6
> 
> 时间：2012-11-22T10:14:17.100

其中之一可能具有服务器名称：

```
print_r($_SERVER)
var_dump($_SERVER) 
echo $_SERVER['HOSTNAME'] 
```

给我服务器的名称。

# ruby-on-rails - 如何使用/绕过 Gmail 的 SMTP 出站发送限制？

> ID：626421
> 
> 赞同：6
> 
> 时间：2009-03-09T14:19:55.293
> 
> 标签：ruby-on-rails, email, smtp

我正在使用我的域帐户的 Gmail 应用程序在我的 rails 应用程序中发送标准自动电子邮件（用户注册、忘记密码、通知管理员新评论等）的电子邮件，但我担心每天 500 封电子邮件的限制设置由谷歌。

谷歌建议克服限制的一种方法是使用多个用户帐户。

因此，我设置了 10 个额外的 gmail 用户帐户（noreply1、noreply2、noreply3 等）——我想跟踪这些帐户中的任何一个在 24 小时内何时发送了 500 封电子邮件，并相应地使用空闲帐户。

如何动态设置`:user_name`值`ActionMailer::Base.smtp_settings`？

这是我当前的设置 - 注意：每次都从“noreply1”发送，即使我明确设置：user_name 和 :from 为“noreply2”：

```
--- development.rb --- 
    ActionMailer::Base.delivery_method = :smtp
    ActionMailer::Base.smtp_settings = {
        :address => "smtp.gmail.com",
        :port => "587",
        :domain => "mydomain.com",   
        :authentication => :plain,
            :user_name => "noreply1@mydomain.com",
        :password => "password"
    }

--- account.rb --- (MODEL, called via a callback)
after_create :send_welcome_email
...
def send_welcome_email
  #ActionMailer::Base.smtp_settings[:user_name] = 'noreply2@mydomain.com'
  ActionMailer::Base.smtp_settings.merge!({:user_name => "noreply2@mydomain.com"})  
  SubscriptionNotifier.deliver_welcome(self)   
end

--- subscription_notifier.rb --- (MODEL) 
class SubscriptionNotifier < ActionMailer::Base
  def welcome(account)    
    @sent_on = Time.now
    @subject = "Welcome to the App"
    @recipients = account.email
    @from = "noreply2@mydomain.com" 
    @body = { :account => account }
  end
end 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T17:36:20.330

您还可以在您的服务器上设置一个 MTA 并使用它来发送邮件。

这就是我们所做的。

您必须将您的服务器的 IP 添加为有效的 IP，以便在您的域的 SPF 记录中发送电子邮件，以避免被标记为垃圾邮件。

这样做的另一个好处是，如果您这样做，您可以将电子邮件的 From: 地址设置为您的用户之一，而 GMail 无法做到这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T14:34:39.830

将可用的用户名连同“last-modified”、“last-reset”和发送计数一起存储在数据库的表中。然后，您可以在发送电子邮件时查询此内容以查找当前使用最少的电子邮件地址。然后增加发送的计数和最后修改的帐户。'last-reset' 值可用于您的清理代码，以便您每 24 小时重置一次计数。

这也使得添加新的电子邮件帐户、停用不再使用的帐户、在不同的应用程序中实现等变得容易，因为它们都只是在数据库表中，您可以在需要时更改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T15:26:34.010

您应该能够以与配置相同的方式在邮件程序的哈希中设置 :user_name 元素，即通过执行以下操作：

```
ActionMailer::Base.smtp_settings[:user_name] = 'new_user_name' 
```

虽然这可能需要一些额外的代码来强制重新加载任何内部操作邮件配置（我自己没有测试过）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-01T23:18:02.220

评论框对我的问题变得过于严格。动态更改`ActionMailer::Base.smtp_settings`哈希对我来说是按预期工作的，所以我怀疑这里还有其他一些因素在起作用。一些事情要尝试：

1.  您使用的是 TLS 插件吗？我在 Rails 2.3.2 和 Ruby 1.8.6 中使用[了 action_mailer_optional_tls 。](http://svn.douglasfshearer.com/rails/plugins/action_mailer_optional_tls/)
2.  正在写入日志/控制台的内容是什么？
3.  您正在更改用户名而不是密码：所有 noreply 帐户都具有相同的密码吗？

**编辑：更多尝试**

我会仔细查看评论中提到的 smtp_tls.rb 文件，以确保没有任何内容是硬编码的。或者删除它并尝试我上面链接的插件。要使用它，您只需添加`:tls => true`到 smtp_settings 哈希。

# asp.net - 如何使用 ASP.Net 进行多次登录？

> ID：626422
> 
> 赞同：2
> 
> 时间：2009-03-09T14:19:59.740
> 
> 标签：asp.net, login, forms-authentication

我正在一个有内部和外部部分的网站上工作。

这两个部分的用户不同，因此他们需要不同的登录页面。我想为这两个文件夹配置不同的身份验证，但是 ASP.Net 但不允许这样做。

示例（在我的主 web.config 中）：

```
<authentication mode="Forms">
    <forms loginUrl="~/Pages/Internal/Main.aspx" defaultUrl="~/Pages/Internal/Main.aspx" cookieless="UseDeviceProfile" name=".ApplicationAuthenticatedUser" path="/" protection="All" slidingExpiration="true" timeout="45"/>
</authentication> 
```

在外部子文件夹中，我尝试覆盖设置：

```
<authentication mode="Forms">
    <forms loginUrl="~/Pages/External/Default.aspx" defaultUrl="~/Pages/External/Default.aspx" cookieless="UseDeviceProfile" name=".ApplicationAuthenticatedUser" path="/Pages/External" protection="All" slidingExpiration="true" timeout="45"/>
</authentication> 
```

然而，这给了我一个错误。

我尝试将它们都放在它们的子文件夹中，但我得到了同样的错误，身份验证配置部分必须在应用程序级别设置（我猜这意味着根 web.config）。

* * *

一种可能的解决方案是集中登录页面并根据请求的来源进行重定向，如果它来自外部页面，则将其发送到外部登录页面，否则发送到内部页面。

它会起作用，但如果可能的话，我想要可以在 web.config 中配置它的解决方案。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T15:14:09.063

我很困惑？为什么有两个用户数据存储？我了解内部与外部，但如果这是同一个应用程序，您可以分配角色以向内部用户授予更多权限。此外，您可以允许您的内部用户在没有 VPN 的情况下在家中访问该站点。

即便如此，如果您必须拥有两家商店，您最好的选择是复制该应用程序。它可以是确切的应用程序，但您将它放在一台内部服务器和一台外部服务器上。然后，您可以对不同位置的用户进行身份验证。但是请注意，您仍然需要角色，除非您正在拼凑应用程序。

如果您需要针对两个商店进行身份验证，您可以使用自定义提供程序来完成。ASP.NET 登录模型允许自定义提供程序，并且很容易构建一个： http: [//msdn.microsoft.com/en-us/library/f1kyba5e.aspx](http://msdn.microsoft.com/en-us/library/f1kyba5e.aspx) [http://msdn.microsoft.com/en-我们/图书馆/aa479048.aspx](http://msdn.microsoft.com/en-us/library/aa479048.aspx)

现在，如果您必须重定向到不同的页面（由于某种原因您被困在这个模型中？），您可以通过 IP 地址来完成。您的内部网络很可能使用 10 点或 192 点 IP 方案。如果是这样，这些地址将被转移到内部。其余的交给外部。这将需要您设置一些进行重定向的东西。我知道您可以在登录页面上执行此操作，如果不是使用 HTTP 处理程序的话。

然而，这似乎是一项非常艰巨的工作。我仍然不明白为什么你必须以这种方式完成任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T14:29:10.560

如果您可以作为两个不同的 IIS 应用程序运行，那么您可以有不同的身份验证提供程序（或同一提供程序的不同实例......可能使用相同的数据库和提供程序上的应用程序属性来区分）。

但是不同的网络应用程序意味着没有共享状态（应用程序和会话）和重复安装。对于内部网/互联网，这将允许外部部署不包括互联网用户无法访问的组件（从而通过减少表面积来提高安全性）。

否则，您可能需要一个自定义身份验证提供程序，该提供程序根据登录者转发到其中一个内置身份验证提供程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T14:35:18.983

如果您的站点是单个 Web 应用程序，您可能会为此使用 ASP.NET 角色提供程序模型，它有两个角色，一个用于内部页面，一个用于外部页面（您可以使用 <location> 配置配置该 pr. 文件夹元素）。

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/9ab2fxh0.aspx](http://msdn.microsoft.com/en-us/library/9ab2fxh0.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-15T04:15:32.673

我有一个简单的方法来处理这个可能对某人有用。我基本上希望能够为访客登录和注册用户使用相同的代码。我还有一个移动版本的网站，当身份验证票到期时，我想将其发送到不同的登录页面。

可能不是最优雅的解决方案，但足够简单：

```
 Public Sub btnSubmit_Click(ByVal sender As Object, ByVal e As EventArgs)
        If Page.IsValid Then
            Dim userLogin As String = ""

            userLogin = System.Guid.NewGuid.ToString
            FormsAuthentication.RedirectFromLoginPage(userLogin, False)
            ' place a url param throughout my app, only four pages so no 
            ' big problem there in this case g stands for guest           
            Response.Redirect("menu.aspx?m=g", False)

        End If
End Sub 
```

然后，在 Global.asax 中：

```
 Protected Sub Application_AuthenticateRequest(ByVal sender As Object, ByVal e As System.EventArgs)

        If Not Request.IsAuthenticated And _
(Not Request.RawUrl.ToLower.Contains("guestlogin.aspx")) And _
(Not Request.RawUrl.ToLower.Contains("registeredlogin.aspx")) And _
(Not Request.RawUrl.ToLower.Contains("mobilelogin.aspx")) Then
            Response.Redirect("spLogin.aspx?m=" & Request.QueryString("m"))
        End If

    End Sub 
```

然后，在您的登录页面（在您的 Web.config 中指定的页面）：

```
 Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
            If Not Page.IsPostBack Then
    if request.querystring("m")="g" then
                    Response.Redirect("guestlogin.aspx?m=g")

    elseif  request.querystring("m")="r" then
                    Response.Redirect("registeredlogin.aspx?m=r")
    elseif  request.querystring("m")="m" then
                    Response.Redirect("mobilelogin.aspx?m=m")

end if
End If
End Sib 
```

# winapi - ShellExecuteEx 或 HlinkSimpleNavigateToString

> ID：626435
> 
> 赞同：0
> 
> 时间：2009-03-09T14:23:27.140
> 
> 标签：winapi, api

我想从我的 Win32 应用程序在默认浏览器中启动一个网页。这两个功能都可以完成这项工作。有任何理由使用其中一个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T16:54:49.663

ShellExecuteEx 似乎是打开某些东西的首选/推荐方式，无论是文件还是网页。ShellExecuteEx 似乎是一个更通用的解决方案，用于使用它的默认处理程序打开任何类型的项目。我总是使用 ShellExecuteEx，从来没有需要使用 HlinkSimpleNavigateToString。

# c# - 如何关闭 Visual Studio 的格式化选项？

> ID：626439
> 
> 赞同：3
> 
> 时间：2009-03-09T14:23:46.047
> 
> 标签：c#, .net, asp.net, visual-studio, visual-studio-2008

所以我在使用 Visual Studio 时遇到了这个烦人的问题（使用 C# 时），我一直在研究 C# 格式选项、通用 VS 选项以及 google 和 MSDN，但实际上找不到解决方法 - 我是假设某处只有一个复选框，而我只是忽略了它。这里是：

我喜欢这样格式化我的代码：

```
Type var2    = new Type();
Type someVar = new Type(); 
```

但是只要应用自动格式化功能，Visual Studio 就坚持这样格式化：

```
Type var2 = new Type();
Type someVar = new Type(); 
```

我在哪里关闭这个烦人的**功能**？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T14:27:12.140

在“格式选项”的“间距”部分：

有一个名为**“忽略声明语句中的空格”的选项**。选中该选项，VS.NET 将不会重新格式化您所做的声明。

所以，这应该工作：

```
int i      = 5;
int melp   = 4; 
```

但是，当你这样做时，VS.NET 仍然会重新格式化你的代码：

```
int i;
int melp;

i    = 5;
melp = 4; 
```

会变成：

```
int i;
int melp;

i = 5;
melp = 4; 
```

因此，实际上只有在声明语句中 VS.NET 才会忽略您提供的额外间距。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-09-02T14:54:11.820

工具|选项|C#|格式化

I. 忽略声明语句中的空格 <<-- 检查这个

和

二、为运算符设置间距
插入空格...
忽略空格 ... <<-- 检查这个

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T14:28:02.030

工具 -> 选项 -> 文本编辑器 -> C# -> 选项卡 -> “保留选项卡”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T14:26:58.693

查看工具|选项|C#|格式化

# .net - 您对 NPaday 有什么体验？

> ID：626440
> 
> 赞同：4
> 
> 时间：2009-03-09T14:24:24.377
> 
> 标签：.net, apache

您是否使用[NPaday](http://npanday.codeplex.com/)将 Visual Studio 与[Apache Maven](http://maven.apache.org/)集成？如果是这样，它运作良好吗？你会再次使用它吗？

编辑：不太具体，我想，我要解决的问题是：我在 Subversion 中有一个 C# 解决方案，它依赖于 Subversion 树中其他地方的其他项目。我想使用 Hudson 构建我的项目。我可以在本地构建另一个项目 DLL，并引用它，但这不适用于 CI 服务器。我无法引用该项目，因为 Hudson 将项目文件夹复制到其他地方，并使用了新名称。解决方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-27T08:09:01.180

虽然一些问题仍然存在，但 NPaday 自 1.1 以来已经取得了相当大的进步——它已经转移到[Apache](http://incubator.apache.org/npanday/)，并且[1.4.0-incubating 已经发布](http://startbigthinksmall.wordpress.com/2011/05/26/apache-npanday-1-4-0-incubating-released-net-for-maven/)了一段时间。

**--原答案：已经过时了--**

我们甚至还尝试将 NPaday 与 Hudson 一起使用。它可以工作，但在 NPaday 1.1 中，生命周期仍然非常类似于 java，并且没有很好地适应 .NET 项目的需求。

该插件可以维护一个带有所有源文件的 pom.xml。已提供对资源的支持，但尚未完成：不支持本地化卫星组件。

该插件也仅适用于英语 VS 安装（补丁正在进行中）

我们最终构建了我们自己的 maven 插件，我现在正试图进入 NPaday v1.2。（希望在夏天之前发布）

在 Teamcity 中，您可以轻松地依赖其他 buildprojects 生成的工件，但 Hudson 似乎[不支持这一点](https://stackoverflow.com/questions/827515/sharing-build-artifacts-between-jobs-in-hudson)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-24T18:35:57.553

安德鲁，

我一直在利用 Npanday 和 Continuum (maestro) 开发构建和发布管理功能。有一些小问题，但慢慢改进并提供 CI 和集中二进制管理的好处（主要优势）。我从未尝试过 hudson，但建议您继续使用 Npanday 和 continuum(maestro) 组合来实现 CI。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-14T10:36:22.417

我尝试在 mac os x 上使用 npanday 并在 .Net 上使用 mono

但是这些项目不会被编译或打包

不确定 npanday 是否仍然处于活动状态

# .net - 需要如何在同一域上运行的两个 .net 2.0 Web 应用程序之间共享“会话”数据的工作示例

> ID：626441
> 
> 赞同：0
> 
> 时间：2009-03-09T14:25:23.767
> 
> 标签：.net, session, asp.net-2.0, session-state

我想要一个使用asp.net会话状态服务器的工作示例，在两个运行在同一域上的.net 2.0 Web应用程序之间共享会话变量，只是在不同的文件夹（同一个父文件夹）中

目录结构：

父站点：[localhost/testSite] Web 应用程序 1 站点：[localhost/testSite/webapp1] Web 应用程序 2 站点：[localhost/testSite/webapp2]

Web 应用 1 站点设置 Session 变量（“myVarImSetting”） Web 应用 2 站点获取 Session 变量（“myVarImSetting”）

项目编译完成后，首先运行 web app 1，设置变量，然后在它仍然打开的情况下，浏览到 web app 2 页面，并显示存储在 Session(myVarImSetting") 中的值

这应该可行，应该有一种方法可以做到这一点，我告诉有，但没有人提供任何证据，以及使用 asp.net 状态服务器的 .net 2.0 框架的工作演示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T14:47:28.580

[这](http://blogs.lessthandot.com/index.php/WebDev/ServerProgramming/ASPNET/sharing-asp-net-session-state-between-we)是带有代码示例的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T14:59:34.200

您可以为此使用[应用程序变量吗？](http://msdn.microsoft.com/en-us/library/ms178594.aspx)

```
Application("myVarImSetting") = 5;
int mySetting = (int)Application("myVarImSetting"); 
```

# c# - 在局域网中搜索 WCF 服务？

> ID：626445
> 
> 赞同：2
> 
> 时间：2009-03-09T14:26:02.953
> 
> 标签：c#, .net, wcf

有没有办法在本地网络的任何计算机中搜索给定 WCF 服务的存在？

例如，我正在寻找 Math/Add2Numbers 服务，我想知道 LAN 上的哪些机器提供它，有什么方法可以做到吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-08-18T19:32:47.743

这是一个超级简单的发现示例。它不使用配置文件，都是 c# 代码，但您可以将概念移植到配置文件中。

在主机和客户端程序之间共享此接口（暂时复制到每个程序）

```
[ServiceContract]
public interface IWcfPingTest
{
  [OperationContract]
  string Ping();
} 
```

将此代码放在主机程序中

```
public class WcfPingTest : IWcfPingTest
{
  public const string magicString = "djeut73bch58sb4"; // this is random, just to see if you get the right result
  public string Ping() {return magicString;}
}
public void WcfTestHost_Open()
{
  string hostname = System.Environment.MachineName;
  var baseAddress = new UriBuilder("http", hostname, 7400, "WcfPing");
  var h = new ServiceHost(typeof(WcfPingTest), baseAddress.Uri);

  // enable processing of discovery messages.  use UdpDiscoveryEndpoint to enable listening. use EndpointDiscoveryBehavior for fine control.
  h.Description.Behaviors.Add(new ServiceDiscoveryBehavior());
  h.AddServiceEndpoint(new UdpDiscoveryEndpoint());

  // enable wsdl, so you can use the service from WcfStorm, or other tools.
  var smb = new ServiceMetadataBehavior();
  smb.HttpGetEnabled = true;
  smb.MetadataExporter.PolicyVersion = PolicyVersion.Policy15;
  h.Description.Behaviors.Add(smb);

  // create endpoint
  var binding = new BasicHttpBinding(BasicHttpSecurityMode.None);
  h.AddServiceEndpoint(typeof(IWcfPingTest) , binding,   "");
  h.Open();
  Console.WriteLine("host open");
} 
```

将此代码放在客户端程序中

```
private IWcfPingTest channel;
public Uri WcfTestClient_DiscoverChannel()
{
  var dc = new DiscoveryClient(new UdpDiscoveryEndpoint());
  FindCriteria fc = new FindCriteria(typeof(IWcfPingTest));
  fc.Duration = TimeSpan.FromSeconds(5);
  FindResponse fr = dc.Find(fc);
  foreach(EndpointDiscoveryMetadata edm in fr.Endpoints) 
  {
    Console.WriteLine("uri found = " + edm.Address.Uri.ToString());
  }
  // here is the really nasty part
  // i am just returning the first channel, but it may not work.
  // you have to do some logic to decide which uri to use from the discovered uris
  // for example, you may discover "127.0.0.1", but that one is obviously useless.
  // also, catch exceptions when no endpoints are found and try again.
  return fr.Endpoints[0].Address.Uri;  
}
public void WcfTestClient_SetupChannel()
{
  var binding = new BasicHttpBinding(BasicHttpSecurityMode.None);
  var factory = new ChannelFactory<IWcfPingTest>(binding);
  var uri = WcfTestClient_DiscoverChannel();
  Console.WriteLine("creating channel to " + uri.ToString());
  EndpointAddress ea = new EndpointAddress(uri);
  channel = factory.CreateChannel(ea);
  Console.WriteLine("channel created");
  //Console.WriteLine("pinging host");
  //string result = channel.Ping();
  //Console.WriteLine("ping result = " + result);
}
public void WcfTestClient_Ping()
{
  Console.WriteLine("pinging host");
  string result = channel.Ping();
  Console.WriteLine("ping result = " + result);
} 
```

在主机上，只需调用 WcfTestHost_Open() 函数，然后永远休眠之类的。

在客户端上，运行这些功能。主机打开需要一点时间，所以这里有几个延迟。

```
System.Threading.Thread.Sleep(8000);
this.server.WcfTestClient_SetupChannel();
System.Threading.Thread.Sleep(2000);
this.server.WcfTestClient_Ping(); 
```

主机输出应该看起来像

```
host open 
```

客户端输出应该看起来像

```
uri found = http://wilkesvmdev:7400/WcfPing
creating channel to http://wilkesvmdev:7400/WcfPing
channel created
pinging host
ping result = djeut73bch58sb4 
```

对于发现示例，这确实是我能想到的最低要求。这东西很快就变得相当复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T14:55:52.757

您需要的是 WS-Discovery，但不幸的是，它不包含在 WCF 中的 ws-* 扩展中。它有一些本土的实现。这是一个[谷歌搜索](http://www.google.com/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=P7g&q=wcf++ws-discovery&btnG=Search)。

否则，您可以由第三方供应商（如[IBM](http://www.ibm.com/developerworks/websphere/library/techarticles/0609_mckee/0609_mckee.html)或[Microsoft](http://www.microsoft.com/windowsserver2003/technologies/idm/uddi/default.mspx)）实施企业 UDDI 或注册解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T22:46:08.260

您可以使用 UDDI 来查找它，但是如果有多个服务实例，您将如何决定使用哪个实例？

# c# - 返回带有一个随机项的 SPListItemCollection

> ID：626446
> 
> 赞同：2
> 
> 时间：2009-03-09T14:26:24.840
> 
> 标签：c#, sharepoint

我有一个 SPListItemCollection。

我基本上想（随机）获取集合中的一项并返回它。

我的方法有一个返回类型，它需要一个 SPListItemCollection，所以我不介意有一个 SPListItemCollection，其中只有一个项目并返回它。

我不知道如何返回包含这一项的 SPListItemCollection

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T15:30:13.097

我认为您必须将项目添加到要返回的集合中，然后您必须调用 update()

```
SPListItemCollection collListItemsDest; //collection to return
SPListItem oListDest = collListItemsDest.Add(); //add item to collection
oListDest["Field1_Name"] = "RANDOM"; //random item you retrieved
oListDest.Update(); 
```

然后你可以返回 collListItemsDest
[MSDN - SPListItemCollection add()](http://msdn.microsoft.com/en-us/library/ms470423.aspx#)

但实际上，您应该考虑只返回项目，而不是集合。如果你总是知道它只会有一个项目，那么返回一个集合是没有意义的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T13:24:09.657

重新阅读时，您似乎想将 SPListItemCollection 减少为单个项目，但这是一种直接从列表中获取带有单个随机项目的 SPListItemCollection 的方法：

```
private SPListItemCollection GetRandomItem(SPList list)
{
    Random random = new Random();
    int index = random.Next(0, list.ItemCount - 1);
    SPQuery query = new SPQuery();
    query.Query = string.Format("<Where><Eq><FieldRef Name=\"ID\" /><Value Type=\"Integer\">{0}</Value></Eq></Where>", index);
    return list.GetItems(query);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T14:43:03.240

在集合中选择一个随机项目。播种 Rand 对象，然后当您从中获取随机数时，使用数组的边界来定义随机对象的边界（0，spListItemCollection.Count）；

获取该项目，将其包装在新的 SPListItemCollection 中并返回。

# asp.net-mvc - 强类型部分视图 MVC RC1

> ID：626457
> 
> 赞同：0
> 
> 时间：2009-03-09T14:28:23.807
> 
> 标签：asp.net-mvc, user-controls, strong-typing, viewdata, partials

将 ViewData.Model 传递给部分视图时遇到问题。即使我将其等同于结果查询，它也始终默认为 null。我无法访问强类型数据，因为模型为空。我目前的代码是这样的，

查看页面

```
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
    <% Html.RenderPartial("header", this.ViewData.Model); %>
    <% Html.RenderPartial("test", this.ViewData.Model); %>
    <div id="userControls">
    </div>
</asp:Content> 
```

用户控件 - 标题

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<testMVCProject.Models.information>" %>
<h2>
    ACReport</h2>
<p>
    id:
    <%= Html.Encode(Model.id) %>
</p>
<p>
    type:
    <%= Html.Encode(Model.type) %>
</p> 
```

用户控制 - 测试

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<testMVCProject.Models.information>" %>

        <%  using (Ajax.BeginForm(
            "pressureV2",
            "Home",
            new { id = ViewData.Model.id },
            new AjaxOptions
            {
                UpdateTargetId = "userControls",
                HttpMethod = "GET"

            },
            new { @id = "genInfoLinkForm" }))
            {%>
        <%= Html.SubmitButton("hey", "Lol") %>

    <%} %> 
```

控制器

```
public ActionResult header(int id)
        {
            var headerResults = from c in db.information
                                where c.id == id
                                select new information
                                {
                                    id = c.id,
                                    type = c.type
                                };
            ViewData.Model = headerResults.FirstOrDefault();
            return View(ViewData.Model);
        }

public ActionResult pressureV2(int id)
        {
            var pressureVResults = from c in db.pressure_volume_tests
                                   where c.id == id
                                   select new pressureVT
                                   {
                                       bottomCVP = c.bottom_CVP,
                                       topCVP = c.top_CVP
                                   };

            ViewData.Model = pressureVResults.FirstOrDefault();
            return View(ViewData.Model);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T21:32:08.307

在您所说的评论中，该视图不是强类型的。正因为如此：

```
<% Html.RenderPartial("header", this.ViewData.Model); %>
<% Html.RenderPartial("test", this.ViewData.Model); %> 
```

不管用。如果您将视图强输入到 testMVCProject.Models.information，然后从您的构造函数传递该类型的实例，它将起作用。

控制器：

```
public ActionResult ShowAView()
{
    Return View("WhateverYourViewIsCalled", new information());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T22:00:29.533

您对 Html.RenderPartial 助手的使用有一个误解。当您使用 RenderPartial 时，您将显示视图而无需从控制器请求模型。

所以你必须重构你的 ViewPage 并将好的模型传递给你的用户控件：

示例：

控制器：

```
ActionResult MainView()
{
    var mainviewobj = new MainViewObject();

    var headerResults = from c in db.information
                                where c.id == id
                                select new information
                                {
                                    id = c.id,
                                    type = c.type
                                };

    mainviewobj.info = headerResults.FirstOrDefault();

    return view(mainviewobj);   
} 
```

查看代码：

```
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
    <% Html.RenderPartial("header", this.ViewData.Model.info); %>
    <% Html.RenderPartial("test", this.ViewData.Model.info); %>
    <div id="userControls">
    </div>
</asp:Content> 
```

查看后面的代码

```
public partial class MainView : ViewPage<MainViewObject>
{
} 
```

现在模型在您的用户控件中不会为空。但请记住，用户控件渲染部分不需要执行控制器中的代码所以你不需要`public ActionResult header(int id)`在你的控制器中

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T00:18:41.793

您是否也尝试过使 ViewPage 通用？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T21:40:45.507

RenderPartial 时不会调用 Controller - 它被绕过并直接呈现视图。因此，无论您想作为模型传入什么，都需要从调用视图中完成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-23T20:45:09.733

我发现这对我有用，像这样引用部分内容。

```
...form
    @Html.Partial("_AboutYou", Model.AboutYou);
 ..end form 
```

在顶部的局部视图中......

```
@model <namespace1>.<namespace2>.<namespace3>.CustomerInfo.AboutYou
    @{

        ViewData.TemplateInfo.HtmlFieldPrefix = "AboutYou";

        if (this.ViewContext.FormContext == null)
        {
            this.ViewContext.FormContext = new FormContext();
        }
    } 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-12T00:04:59.800

我相信问题可能是您在表单中缺少名称为“id”的元素，因此 Action 方法的参数永远不会填充值？

这样，查询将始终使用 FirstOrDefault 返回 null，因此返回 null 模型。

只是我的猜测...

# algorithm - 将一组 3D 点映射到具有最小距离总和的另一组

> ID：626468
> 
> 赞同：8
> 
> 时间：2009-03-09T14:31:55.497
> 
> 标签：algorithm, math, mapping, mathematical-optimization

给定两组三维点，一个源集和一个目标集。每组上的点数是任意的（可能为零）。任务是为每个目标点分配一个或不分配一个源点，以使所有距离的总和最小。如果源点多于目标点，则忽略附加点。

这个问题有一个蛮力的解决方案，但是由于点的数量可能很大，所以不可行。我听说这个问题在具有相同大小的 2D 中很容易，但遗憾的是这里没有给出这些先决条件。

我对近似值和精确解都感兴趣。

编辑：哈哈，是的，我想这听起来确实像家庭作业。事实上，它不是。我正在编写一个程序来接收大量汽车的位置，并且我正在尝试将它们映射到它们各自的停车单元。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T15:02:15.347

您可以解决此问题的一种方法是将其视为经典分配问题：[http ://en.wikipedia.org/wiki/Assignment_problem](http://en.wikipedia.org/wiki/Assignment_problem)

您将点视为图形的顶点，边的权重是点之间的距离。因为最快的算法假设您正在寻找最大匹配（而不是像您的情况那样最小），并且权重是非负的，您可以将权重重新定义为例如：

```
weight(A, B) = bigNumber- distance(A,B) 
```

哪里`bigNumber`比你最长的距离更大。

显然，您最终得到了一个二分图。然后，您使用标准算法之一进行最大加权二分匹配（网络上的大量资源，例如[http://valis.cs.uiuc.edu/~sariel/teach/courses/473/notes/27_matchings_notes.pdf](http://valis.cs.uiuc.edu/~sariel/teach/courses/473/notes/27_matchings_notes.pdf)或 Wikipedia概述：[http](http://en.wikipedia.org/wiki/Perfect_matching#Maximum_bipartite_matchings) ://en.wikipedia.org/wiki/Perfect_matching#Maximum_bipartite_matchings ）这样你最终会得到一个 O(NM max(N,M)) 算法，其中 N 和 M 是你的集合的大小点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T15:01:19.250

尽管我对您的问题没有真正的答案，但我可以建议您研究以下主题。（我对此知之甚少，但之前在 Stack Overflow 上遇到过。）

*   [最近邻搜索](http://en.wikipedia.org/wiki/Nearest_neighbor_search)
*   [*k* -d树](http://en.wikipedia.org/wiki/Kd-tree)

希望这个对你有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T11:44:06.767

在我的脑海中，空间排序，然后是模拟退火。

对空间进行网格化并将集合分类为空间单元格。

在每个单元格内求解 O(NM) 问题，然后在单元格邻域内求解，以此类推，以获得试验匹配。

最后，运行大量模拟退火循环，在其中随机改变匹配，以探索附近的空间。

这是启发式的，虽然不一定是最好的，但可以为您提供一个很好的答案，并且由于初始网格排序，它应该是相当有效的。

# visual-studio-2008 - Deploy 不会复制 app_data 的子文件夹

> ID：626469
> 
> 赞同：2
> 
> 时间：2009-03-09T14:31:57.353
> 
> 标签：visual-studio-2008, deployment, app-data

我的网络项目有一个带有子文件夹的 app_data 文件夹。当我从 Visual Studio2008 部署我的项目（单击、部署、包括 app_data 勾选）时，它只从 app_data 根目录复制文件，而不是子目录。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T14:52:48.863

在未部署的子文件夹中，右键单击每个文件并检查其属性：构建操作并复制到输出目录。验证构建操作是否设置为“内容”并且“复制到输出目录”是否设置为“始终复制”（或如果较新则复制）。更改所有文件属性的一种快速方法是将它们全部突出显示，然后右键单击属性，这将一次更改其所有值。

我将在这个答案的开头加上：我假设一个 Web 部署项目类似于单击一次部署，这是我的答案基于:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-04T22:40:16.627

只需确保 wurfl.xml.gz 文件属性的设置（通过 Visual Studio 中的属性窗口）**Build Action**设置为**Content**。此属性决定 Visual Studio 或工具在编译或发布期间应如何处理各个项目文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-27T19:56:42.213

为要发布为“内容”的文件设置 buid 操作

如果您使用的是 VS2008，则在发布期间会有一个选项复选框

由于您使用的是VS2010，请右键单击属性->打包/发布Web->排除文件App_Data文件夹

![在此处输入图像描述](https://i.stack.imgur.com/OSE7B.jpg)

![在此处输入图像描述](https://i.stack.imgur.com/lMUpW.jpg)

# open-source - 开源软件是否可能带有病毒/间谍软件/恶意软件？

> ID：626477
> 
> 赞同：6
> 
> 时间：2009-03-09T14:35:48.470
> 
> 标签：open-source

抱歉，如果这是一个愚蠢的问题，但有时我会在 Aptitude 等程序中看到复活节彩蛋之类的东西。（Debian 的包管理器）

~~是否可以~~是否有可能更多险恶的功能进入开源软件？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-09T14:47:22.373

这当然是可能的，但它更复杂。我不知道有任何实际的恶意软件在传播，但人们犯了具有类似影响的错误。（我知道已经发现的错误；显然，我不知道有多少还没有。）

如果将恶意软件放入闭源软件中，找到它的唯一方法是检测影响并分析二进制文件。有些人非常擅长分析二进制文件。

在开源软件中，任何人都可以查看源代码。对于大多数包裹来说，没有多少人愿意，但被发现的机会要高得多。一旦发现，任何人都可以修补软件以做好事而不做坏事。此外，大多数开源软件都有公开可用的存储库，这意味着任何人都可以追踪代码的历史，以及（至少对于化名）谁做了什么。还有一种趋势是在开源中生成更具可读性的代码，这样更改会更加突出。

当然，需要注意的是，我们大多数人真的不知道在软件安全方面要寻找什么。如果我运行一个压缩程序，它将我的文件压缩成一个看起来像乱码的较短版本，我可以取回原始文件，我知道这是有效的。如果将其更改为声称已加密的胡言乱语，我不知道如何先验地判断它是否已加密。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-09T14:38:15.607

这是可能的，但有点困难，因为源代码在那里。作者会指望在运行它之前没有人费心阅读源代码，我想这对很多人来说都是如此。我知道我不会费心去阅读我运行的开源程序的源代码。在一个更大的项目中，这更难，因为代码经常被审查，但如果只有一个作者，那么它就会变得容易得多。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-09T14:38:17.590

任何软件都可能包含恶意部分（有意或无意）。开源的好处是你可以检查它（如果你喜欢并且有时间的话）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-09T14:39:10.863

是的，这是可能的，请参阅 Debian OpenSLL debacle 以获得一个很好的示例： [http ://www.metasploit.com/users/hdm/tools/debian-openssl/](http://www.metasploit.com/users/hdm/tools/debian-openssl/)

虽然这不是病毒/间谍软件/恶意软件，但它清楚地显示了开源软件可能出现的问题。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-09T16:05:57.643

我不敢相信还没有人提到[Ken Thompson 的编译器病毒](http://cm.bell-labs.com/who/ken/trust.html)。

访问源代码可以合理地保证程序不会出现恶意行为。但是，除非您检查过以下之一：

1.  编译器的二进制输出
2.  编译器本身的二进制代码
3.  编译器的源代码（和它的编译器，和它的编译器等）和用于编译它的编译器的二进制代码。

您最终可能会在编译后的二进制文件中发现从未出现在源代码中的恶意代码。诚然，这是一种非常不可能且极其困难的攻击形式，但理论上可以以一种无法在源代码（项目或编译器）中检测到的方式将恶意代码引入开源项目。

如果您不是为 CIA（或其他政府的同等机构）工作，编译器安全可能不是您需要担心的事情。但这是一个非常酷的概念。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-09T14:38:32.517

我会说这显然是可能的。它所需要的只是代码在没有经过充分审查的情况下被接受。想出允许这样做的场景并不难，因为审阅者是人。

更有趣的问题是恶意软件被接受到某个可能造成伤害的程序包中的*可能性有多大。*不幸的是，这很难回答。至少到目前为止，我们似乎做得很好（敲木头）。

我猜[Linus 定律](http://en.wikipedia.org/wiki/Linus%27s_Law)（“有足够的眼睛，所有的 bug 都很浅”）是正确的，但很容易认为，仅仅因为某些东西是开源的，人们就会花很多时间盯着它的代码。据我所知，这通常不是真的。

编辑：更改了上面关于莱纳斯定律的措辞，错误地归因于它。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-09T14:43:53.003

原则上可以吗？当然。任何软件都可以做人们不想要的事情。

在实践中可能吗？反对的理由当然是该软件是可用的，而且很多眼睛都在注视着它，所以它会在它造成太大的损害之前被发现。

另一方面，有 Underhanded C 代码竞赛[http://www.underhanded-c.org/](http://www.underhanded-c.org/)，您在其中提交故意行为不端的程序，但从检查中看不出不良行为的原因来源。

然后当然还有 Debian SSL 错误，在 Debian 上使用 OpenSSL 库生成的 SSL 密钥非常不安全。显然，这只是一种无能行为（Hanlon's Razor，每个人），但它显示了安全问题如何潜入开源代码。使用弱密钥和 SSH 访问，您不需要代码中的病毒，您只需在生产系统上运行时利用弱代码。

把它当作是/否/也许:)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-09T14:38:28.977

是的，有可能，就像闭源软件也有可能发生同样的情况（团队中的恶意开发人员等）

不过，开源可能不太可能，因为一旦注意到类似的事情，任何其他用户都可以提取问题代码，这不再是问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-09T14:46:45.010

类似于闭源软件可能是病毒/间谍软件/恶意软件，开源软件也可能是。以及如何有大量可怕的开源软件。

到目前为止，我所见过的所有闭源 Windows 软件都是某种恶意软件，因此偏向于闭源应用程序总体上更有可能成为垃圾。

谁阻止它？即使软件是开源的，只有糟糕的软件才允许任何人未经授权接触发布存储库。通常会有维护者审查所有传入的补丁。

生产和使用的所有软件中有 99% 质量低劣且漏洞百出。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-09T14:38:49.367

它是，但通常在它成为问题之前就已经注意到并删除了。对于任何维护良好的开源软件，都会有很多人检查每个修订版是否有任何更改。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-09T14:39:41.843

是的，这是可能的，这取决于对源代码的提交访问的控制程度以及对这些提交的监视程度。一些项目有一些主要开发人员向社区请求补丁并将其提交到代码库，其他项目将授予更多开发人员访问权限。同样，有些项目在进行更改时会有大量人员查看源代码。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-09T14:40:37.740

这是可能的，事实上它就像任何专有软件一样是代码。但是，主要区别在于您和社区可以访问代码，这一事实足以阻止它在几乎所有情况下发生。此外，大量版本的库和内核使恶意软件不太可能成功。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-09T14:40:39.610

你真的知道你用什么吗？你检查吗？典型用户是否检查或关心？

例如 google 的关键字：`repository compromised`或类似的`gpg repository compromised`东西。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-09T14:41:36.880

有可能，但可能性不大。

开源代码并没有什么特别之处，它可以神奇地抵抗包含坏事的东西，但是由一群人积极开发的开源不太可能包含恶意代码，因为有人会注意到并吹哨。

此外，在大多数开源项目中，通过查看项目的源代码库，可以跟踪任何特定代码的历史，这意味着可以识别恶意代码的作者。

如有疑问，您始终可以自己查看代码，或聘请他人为您查看代码。当然，代码审查通常不会发现细微的错误或错误，但恶意代码可能更明显。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-09T15:12:45.977

另一个开源安全性优于封闭源代码的例子是[interbase 后门](http://www.google.de/search?q=interbase+backdoor)。

从[登记处](http://www.theregister.co.uk/2001/01/12/borland_interbase_backdoor_exposed/)：

*专家说，Borland/Inprise 广受欢迎的 Interbase 数据库软件中隐藏了一个后门密码至少七年，这可能会使公司和政府机构的数以万计的私人数据库暴露在未经授权的互联网访问和操纵之下。*

这个密码是在 Interbase 开源时被发现的。

这并不意味着开源软件的安全性是完美的，甚至是好的。当数以千计的可远程利用的安全漏洞无处不在时，谁需要将恶意软件插入到原始软件中？

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-09T15:26:09.627

> 是否有可能更多险恶的功能进入开源软件？

*官方*没有，恶意软件功能不太可能进入并长期被忽视。但：

*   拥有分发源的服务器可能（并且已经）受到损害，因此您下载的内容与开源开发工作不对应；

*   对于二进制发行版（通常用于 Windows），软件的安装程序可以与恶意软件一起打包。再一次，*正式*地这种情况很少发生。一个例子是 LimeWire 的早期版本，它安装了一个“购物助手”会员费用窃取器 BHO 来“支持该项目”，但这样做却失去了很多善意；

*   但是，也有一些骗子会抢占知名开源项目的搜索结果（同样，最常见的是文件共享软件），并提供他们自己的经过调整的与恶意软件捆绑的安装程序。下载前总是找到项目的官方网站。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-09T16:38:19.360

只是提醒，

*   SSH 后门
*   WordPress 之前被后门

两者都是攻击的结果，所以它不是由原始开发人员种植的。我认为这种证明可以但不太可能，并且如果该应用程序足够流行，它将很快被采用。

# sql - SQL Server 中的相关查询与内部联接性能

> ID：626481
> 
> 赞同：5
> 
> 时间：2009-03-09T14:37:01.553
> 
> 标签：sql, sql-server

假设您要从一个表中选择在另一个表中有对应行的所有行（另一个表中的数据不重要，只有对应行的存在很重要）。根据我对 DB2 的了解，这种查询在编写为带有 EXISTS 子句而不是 INNER JOIN 的相关查询时性能更好。SQL Server 也一样吗？或者它没有任何区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T14:52:12.050

我刚刚运行了一个测试查询，两条语句最终得到了完全相同的执行计划。当然，对于任何性能问题，我建议在您自己的环境中运行测试；使用 SQL Server Management Studio，这很容易（如果您正在运行 2000，则使用 SQL 查询分析器）。只需在查询窗口中输入两个语句，选择查询|包括实际查询计划。然后运行查询。转到结果选项卡，您可以轻松查看计划是什么以及哪个计划的成本更高。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T14:47:42.060

奇怪：我通常更自然地首先将这些作为相关查询编写，此时我必须返回并重新考虑使用连接，因为根据我的经验，sql server 优化器更有可能做到这一点。

但是不要把我看得太认真。对于所有我在这里有 26K 的代表和仅有的 2 个当前特定于 sql 主题的徽章之一，我实际上在 sql 知识方面相当初级（这都是关于数量的！;)）；当然我不是DBA。在实践中，您当然需要分析每种方法以衡量其实际性能。我*希望*优化器能够识别您的要求并以最佳方式处理任一查询，但在您检查之前您永远不会知道。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T15:41:43.210

正如每个人所指出的，这一切都归结为优化器。我建议以您觉得更自然的方式编写它，然后确保优化器能够找出最有效的查询计划（收集统计信息、创建索引等）。SQL Server 优化器总体上相当不错，只要你给它提供它需要使用的信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T19:25:41.690

使用连接。如果您有小表，它可能不会对性能产生太大影响，但如果“外部”表非常大，则需要对每一行执行 EXISTS 子查询。如果您的表在公共列上建立索引，那么执行 INNER JOIN 应该快得多。顺便说一句，如果您想查找不在第二个表中的所有行，请使用 LEFT JOIN 并在第二个表中测试 NULL - 当您有非常大的表和索引时，它比使用 EXISTS 快得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T18:40:00.143

可能最好的性能是连接到派生表。存在可能会是下一个（并且可能更快）。最差的性能是在 select 中使用子查询，因为它倾向于逐行而不是作为一组运行。

然而，一切都是平等的，数据库性能非常依赖于数据库设计。我会尝试所有可能的方法，看看在你的情况下哪种方法更快。

# emacs - 突出显示缓冲区修改

> ID：626492
> 
> 赞同：30
> 
> 时间：2009-03-09T14:40:32.437
> 
> 标签：emacs

经常发生文件缓冲区被修改（duh！）。在退出之前，emacs 会询问是否保存更改。现在知道实际发生了什么变化会很有趣。有没有办法找出来？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-09T15:19:45.960

从 Emacs 22.1 开始（至少），`'save-buffers-kill-emacs`（ 的默认绑定`C-x C-c`）提示您输入每个未保存的具有文件的缓冲区。`d`在提示保存并查看差异时键入 a 。

从帮助文档中：

```
Save some modified file-visiting buffers.  Asks user about each one.
You can answer `y' to save, `n' not to save, `C-r' to look at the
buffer in question with `view-buffer' before deciding or `d' to
view the differences using `diff-buffer-with-file'. 
```

如果您查看提示，它应该会显示如下内容：

```
Save file /path/to/file.txt? (y, n, !, ., q, C-r, d, or C-h) 
```

键入`C-h`为您提供了更详细的描述（但这`d`是您所要求的）：

```
Type SPC or `y' to save the current buffer;
DEL or `n' to skip the current buffer;
RET or `q' to give up on the save (skip all remaining buffers);
C-g to quit (cancel the whole command);
! to save all remaining buffers;
C-r to view this buffer;
d to view changes in this buffer;
or . (period) to save the current buffer and exit. 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-09T15:04:04.250

我使用 diff-buffer-with-file，并选择缓冲区来自的文件（无论如何这是命令的默认值......只需按 Enter 键）。

您也可以使用highlight-changes-mode，尽管在您打开它之前它不会跟踪更改，因此如果您想在关闭未处于此模式的文件时查看更改的内容，则不是那么有用：- )

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-09T16:04:03.327

您可以`highlight-changes-mode`启用。它将以红色显示所有更改。但是，它不会向您显示空白更改，并且只会用红色标记删除`_`。另请参见[http://www.emacswiki.org/emacs/TrackChanges](http://www.emacswiki.org/emacs/TrackChanges)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-31T01:42:10.100

我发现这篇关于djcb[跟踪更改的帖子对跟踪 Emacs 中的更改最有帮助。](http://emacs-fu.blogspot.com/2009/05/tracking-changes.html)诀窍是将以下内容添加到您的 .emacs 中：

```
;; higlight changes in documents
(global-highlight-changes-mode t)
(setq highlight-changes-visibility-initial-state nil); initially hide 
```

然后在您想查看发生了什么变化时切换 highlight-changes-visible-mode 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T14:59:57.567

在这种情况下，我键入 undo 以查看最后的更改（通常是一些在错误窗口中键入的杂散字符，因为我很早就保存并且经常保存）。

如果有一些其他指示当前更改会很好，例如在边框中，如 Eclipse 文本编辑器中的快速差异。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T17:10:57.143

我使用[goto-chg](http://www.emacswiki.org/emacs/goto-chg.el)来处理类似的事情。它并不完美，但它总是足以让我回忆起我所做的改变并很快忘记了。

# regex - 什么正则表达式会将空格后面的任何字母大写？

> ID：626498
> 
> 赞同：5
> 
> 时间：2009-03-09T14:41:43.103
> 
> 标签：regex, perl

我正在寻找一个 Perl 正则表达式，它将大写前面有空格（或字符串中的第一个字符）的任何字符。

我很确定有一种简单的方法可以做到这一点，但我手边没有我的 Perl 书，而且我这样做的次数不够多，以至于我已经记住了它......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T14:44:40.537

```
s/(\s\w)/\U$1\E/g; 
```

我最初建议：

```
s/\s\w/\U$&\E/g; 
```

[但是在使用' $&](http://perldoc.perl.org/perlvar.html) '时已经敲响了警钟（甚至在我阅读@Manni的评论之前）。事实证明，它们是完全合理的——使用 $&、$` 和 $' 操作会导致正则表达式的整体效率低下。

\E 对于这个正则表达式并不重要；`\U`在这种情况下或小写时，它会关闭“大小写设置”开关`\L`。

* * *

如评论中所述，匹配字符串的第一个字符需要：

```
s/((?:^|\s)\w)/\U$1\E/g; 
```

*更正了第二个右括号的位置 - 谢谢，Blixtor。*

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-09T15:54:49.793

根据您的具体问题，这可能比您想象的要复杂，简单的正则表达式可能不起作用。您是否考虑过单词内部的大写？如果单词以“...Word”之类的标点符号开头怎么办？有什么例外吗？国际角色呢？

在这些问题已经解决的情况下，使用[Text::Autoformat](http://search.cpan.org/~dconway/Text-Autoformat-v1.14.0/lib/Text/Autoformat.pm)或[Text::Capitalize](http://search.cpan.org/~doom/Text-Capitalize-0.5/Capitalize.pm)等 CPAN 模块可能会更好。

```
use Text::Capitalize 0.2;
print capitalize_title($t), "\n";

use Text::Autoformat;
print autoformat{case => "highlight", right=>length($t)}, $t; 
```

听起来 Text::Autoformat 可能更“标准”，我会先尝试。它是由[达米安](http://en.wikipedia.org/wiki/Damian_Conway)写的。但是 Text::Capitalize 做了一些 Text::Autoformat 没有做的事情。这是一个[比较](http://search.cpan.org/~doom/Text-Capitalize-0.5/Capitalize.pm#Comparison_to_Text::Autoformat)。

您还可以查看[Perl Cookbook](http://books.google.com/books?id=hP4IRp8xwTkC&pg=PA31&vq=properly+capitalizing+a+title+or+headline&dq=perl+cookbook&source=gbs_search_s&cad=0) for recipie 1.14（第 31 页），了解如何使用正则表达式正确大写标题或标题。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-09T14:58:08.697

像这样的东西应该可以解决问题 -

```
s!(^|\s)(\w)!$1\U$2!g 
```

这只是将扫描的表达式分成两个匹配项 - $1 用于字符串的空白/开头，$2 用于单词的第一个字符。然后，在将单词的开头设为大写之后，我们同时替换 $1 和 $2。

我会将 \s 更改为 \b，这更有意义，因为我们在这里检查单词边界。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T16:17:44.497

这不是我通常会使用正则表达式的东西，但我的解决方案并不完全是你所说的“美丽”：

```
$string = join("", map(ucfirst, split(/(\s+)/, $string))); 
```

那`split()`是由空格组成的字符串并捕获所有空格，然后遍历列表的每个元素并对`ucfirst`它们进行处理（使第一个字符大写），然后`join()`将它们作为单个字符串重新组合在一起。不可怕，但也许你会更喜欢正则表达式。我个人只是不喜欢`\Q`or`\U`或其他半尴尬的正则表达式结构。

编辑：其他人提到标点符号可能是一个潜在的问题。如果说，你想要这个：

```
...string 
```

改为：

```
...String 
```

即，即使前面有标点符号，您也希望单词大写，请尝试类似这样的操作：

```
$string = join("", map(ucfirst, split(/(\w+)/, $string))); 
```

同样的事情，但它`split()`位于单词 ( `\w+`) 上，因此列表中捕获的元素是仅单词的。整体效果相同，但会将可能不以单词字符开头的单词大写。更改`\w`为`[a-zA-Z]`以消除尝试将数字大写。并且通常根据您的喜好对其进行调整。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T16:38:21.200

如果您的意思是空格后的字符，请使用正则表达式使用`\s`. 如果你真的是指单词中的第一个字符，你应该使用而不是上面所有容易出错`\b`的尝试。`\s`

```
s/\b(\w)/\U$1/g; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T16:03:14.997

您想匹配空格后面或字符串开头的字母。

Perl 不能做可变长度的后视。如果是这样，你可以使用这个：

```
s/(?<=\s|^)(\w)/\u$1/g;    # this does not work! 
```

Perl 抱怨：

```
Variable length lookbehind not implemented in regex; 
```

您可以使用双重否定后视来解决这个问题：它左边的东西不能是任何不是空白的东西。这意味着它将在字符串的开头匹配，但*如果*它前面有任何东西，它必须是空格。

```
s/(?<!\S)(\w)/\u$1/g; 
```

在这种情况下，更简单的方法可能是只匹配空格；然后，可变长度限制消失，并将其包含在替换中。

```
s/(\s|^)(\w)/$1\u$2/g; 
```

有时您不能在重复替换中使用这种方法，因为实际匹配之前的内容已经被正则表达式吃掉了，最好有办法解决这个问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-18T10:54:38.183

将前面有空格或字符串开头的任何字符大写：

```
s/(^|\s)./\u$1/g 
```

也许是一种非常草率的做法，因为它现在也在大写空格。:P 优点是它适用于所有可能的重音字母（以及特殊的丹麦语/瑞典语/挪威语字母），当您在正则表达式中使用 \w 和 \b 时，这是有问题的。我可以期望所有非字母都不受大写修饰符的影响吗？

# javascript - JS中的数组长度

> ID：626500
> 
> 赞同：-1
> 
> 时间：2009-03-09T14:42:56.907
> 
> 标签：javascript, arrays

```
var a = [1,4,5];
var e = a.length--; 
```

这里`e`变量将包含 5。但如果我这样做：

```
var e = a.length-=1; 
```

这里`e`将包含 2 个元素的数组。
那么第一个是模拟 pop() 数组方法的语言“提示”？

在语言语法中：

```
a-- 
```

或者

```
a-=1 
```

在语义上是相同的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T14:49:06.113

```
var a = [1, 4, 5];
var e = a.length--; 
```

是相同的

```
var a = [1, 4, 5];
var e = a.length;
a.length = a.length - 1; 
```

然而

```
 var a = [1, 4, 5];
 var e = a.length -= 1; 
```

是相同的

```
var a = [1, 4, 5];
a.length = a.length - 1;
var e = a.length; 
```

和

```
var a = [1, 4, 5];
var e = --a.length; 
```

换句话说： x-- 返回递减前的值，而 --x （和 x -= 1）返回递减后的值。所有这些代码片段从数组 a 中弹出最后一个元素。

请注意，在第一个示例中，e 的值为 3，而*不是*`e = a.length--`5，因此它与 不同。*`a.pop()`*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T14:46:25.090

这是一个基本的误解：如果您评估`a++`， a 将被评估*然后*递增，而`++a`or`a+=1`将首先被递增，然后被评估。

在大多数情况下，最好以更详细的方式编写这些类型的语句，因为它们会很快导致对正在发生的事情感到困惑，而不会获得任何东西（大多数编译器/解释器都会对此进行优化）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T14:53:37.270

那不是我得到的。

相反，我得到了预期的结果。在第一种情况下 e = 3，在第二种情况下 e = 2。

在第一种情况下，a.length 最初为 3（因为 javascript 数组是稀疏的）。使用后递减，这个值 (3) 首先被分配给 e，然后 a.length 被递减（有趣的是，这实际上是可能的）。

在第二种情况下，从 3 中减去 1 得到 2，然后将其分配给 e。

所以我不认为有什么花哨的事情发生，真的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T14:56:59.417

```
var a = [1,4,5];
var e = a.length--; 
```

e 将不包含 5。它将包含 3。

-- postix 减量运算符在这里没有任何区别。`a.length`是 3。第二个语句翻译为：

*   检索数组长度（结果：3）
*   将结果存储在名为“e”的变量中
*   递减数组长度（此步骤对这个独立样本的整体结果没有影响）

然而：

```
var a = [1,4,5];
var e = a.length-=1; 
```

这里 e*将*包含 2。

第二个语句翻译为

*   检索数组长度（结果：3）
*   递减数组长度（结果：2）
*   将结果存储在名为“e”的变量中

在任何情况下，您都在弄乱该`array.length`属性，这是您不应该做的。它会导致难以追踪的那种令人讨厌的错误，因为它是您可能不打算或没有想到的副作用的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T15:20:31.887

哦，是的，我是从书中读到的：Object Oriented Javascript at page 112

> > > push() 方法在数组末尾追加一个新元素。pop() 方法删除最后一个元素。a.push('new') 的工作方式与 a[a.length] = 'new' 相同，而 a.pop() 与 a.length-- 相同。

并且没有尝试我发布问题的代码！！！

对不起。所以我认为这是一个书本错误，因为 pop() 返回 a.length-- 缩小数组但不返回元素但数组长度 -1 的最后一个元素

# emacs - 如何使用 ispell 忽略 LaTeX 文件中的注释（如果可能，在 Emacs 中）

> ID：626506
> 
> 赞同：4
> 
> 时间：2009-03-09T14:44:13.377
> 
> 标签：emacs, latex, spell-checking, ispell

我正在用英文用 Latex 写一篇文章，但用芬兰文写了我的评论。当我用 ispell 运行拼写检查时，我必须浏览所有的注释。有没有一种方便的方法可以用 ispell 跳过评论？如果这可以用emacs完成，那将是双重方便=）

例如，一种方法是在控制台中运行 ispell 并使用 sed 处理输入，但我想直接在文件上进行更改...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T15:13:43.387

(setq ispell-check-comments nil)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T15:13:32.230

您必须深入研究代码，但是当您对文件进行拼写检查时，它会运行 detex 工具来去除 TeX 代码。您应该能够修改管道以使 sed 或 perl 脚本去除注释行。

我有点模糊地认为 AuC-TeX 可以配置这个，但是 30 秒看并没有显示出来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-09T11:58:26.260

为这个老问题添加一个现代答案，因为我也遇到了问题：
**只需使用 aspell，它开箱即用**。

# php - 如何对数组中的对象进行排序？

> ID：626508
> 
> 赞同：1
> 
> 时间：2009-03-09T14:44:26.467
> 
> 标签：php, object, sorting

我在这个网站上搜索并找到了几个解决方案，这对我不起作用。我的情况是我在 XML 中执行 XPath 搜索（包含函数），并列出结果。我希望按字母顺序列出这些结果。结果放在一个数组中，如下所示：

```
Array
(
    [0] => SimpleXMLElement Object
        (
            [DISID] => 2160364
            [StopName] => Nationtheatret
        )

    [1] => SimpleXMLElement Object
        (
            [DISID] => 1118735
            [StopName] => Huldrefaret
        )

    [2] => SimpleXMLElement Object
        (
            [DISID] => 2200752
            [StopName] => Jernbanetorget
        )
) 
```

我列出这样的数据：

```
$xml = new SimpleXMLElement(file_get_contents("StopPointList.xml"));

$query = strtolower($_GET["q"]);

$upper = "ABCDEFGHIJKLMNOPQRSTUVWXYZÆØÅ";
$lower = "abcdefghijklmnopqrstuvwxyzæøå";

$result = $xml->xpath("//StopPoint[contains(translate(StopName, '$upper', '$lower'), '$query')]");

foreach ($result as $stop)
{
    echo '<li><a href="stops.php?id='.$stop->DISID.'">'."\n";
    echo "\t".'<span class="name">'.$stop->StopName.'</span>'."\n";
    echo "\t".'<span class="arrow"></span>'."\n";
    echo '</a></li>'."\n";
} 
```

我如何（以及在​​哪里）对结果进行排序以按字母顺序列出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T14:49:47.733

看起来在您的 foreach 循环中，您需要将数据复制到另一个数据结构中，对该结构进行排序，然后将其输出。 [这些功能](http://us2.php.net/array_sort) [可能会有所帮助](http://us2.php.net/manual/en/function.sort.php)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T15:03:33.003

为了对对象进行排序，您需要一个比较功能。例如，要比较 by `StopName`，请使用以下内容：

```
function cmp ($a, $b)
{
    return strcmp($a->StopName, $b->StopName);
} 
```

然后，在您的 xpath 查询之后和之前`foreach`，添加此行以进行实际排序：

```
usort($result, "cmp"); 
```

# c++ - 与 c 中的链接相比，c++ 链接中的命名空间有什么影响？

> ID：626510
> 
> 赞同：1
> 
> 时间：2009-03-09T14:44:46.420
> 
> 标签：c++, namespaces, linkage

与 c 中的链接相比，c++ 链接中的命名空间有什么影响？

是否可以仅通过使用命名空间来创建一个具有内部链接到外部链接的名称。类似地反过来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T14:48:26.427

通常，命名空间名称会在名称被破坏并进入链接器之前添加到任何封闭实体的名称之前。

如果您在不同的命名空间中有两个具有相同签名的函数，它们可以链接到一个文件中。如果您有两个具有相同名称的类和至少一个具有相同签名的方法，并且这些类位于不同的命名空间中——它们再次链接在一起就好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T14:51:15.810

C 和 C++ 都允许对象和函数具有静态文件链接，也称为内部链接。C++，支持使用未命名的命名空间而不是文件范围，这是编译器的好处。static 是一个链接修饰符。所以，如果你想要文件范围和内部链接，你应该在 C++ 中同时使用命名空间和静态。但是，在 C 中，您只需要 static 关键字即可实现相同的目的。

```
/* C and C++ code */

static int  bufsize = 1024;
static int  counter = 0;

static long square(long x)
{
    return (x * x);
} 
```

在 C++ 中执行此操作的首选方法：

```
 // C++ code
namespace /*unnamed*/
{
    static int  bufsize = 1024;
    static int  counter = 0;

    static long square(long x)
    {
        return (x * x);
    } 

} 
```

# c++ - CComboBox 在调用 MoveWindow 后自动选择文本

> ID：626511
> 
> 赞同：1
> 
> 时间：2009-03-09T14:44:52.660
> 
> 标签：c++, winapi, mfc, ccombobox

我目前遇到了一个非常奇怪的问题，其中`CComboBox`使用了`CFormView`.

将字符串添加到组合框（使用创建`WS_CHILD | WS_VISIBLE | WS_TABSTOP | WS_VSCROLL | CBS_DROPDOWN | CBS_SORT | CBS_AUTOHSCROLL`）后，我在派生类的处理程序中选择一个条目`CComboBox::SetCurSel`并通过调整组合框的大小。`MoveWindow``OnSize()``CFormView`

一旦我包含对 的调用`MoveWindow`，组合框的编辑部分中的整个文本就会被选中。如果我删除对 的调用`MoveWindow`，则不会选择文本。这不仅适用于一个，而且适用于所有使用的组合框。

在这一点上，我不知何故迷路了。非常感谢任何提示！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T15:04:35.280

当组合框获得焦点时，选择所有文本是标准的 Windows 行为。我猜 MoveWindow 正在重置控件上的焦点。

尝试使用 CComboBox::SetEditSel 删除 MoveWindow 之后的选择。

# edi - EDI 格式

> ID：626512
> 
> 赞同：17
> 
> 时间：2009-03-09T14:45:26.510
> 
> 标签：edi

我以前读过 XML 或 CSV，但我从未见过像 EDI 这样的东西。

如何读取此文件并获取我需要的数据？我看到了 ~、REF、N1、N2、N4 之类的东西，但不知道这些东西是什么意思。

我看过一些关于 x12 的东西，但不知道我有没有，我怎么知道？

- 更新

感谢大家的快速回复。有谁知道我可以在.Net 中使用的解析器？从长远来看，我将把这个 EDI 文件转换为 CSV 文件......

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-09T14:48:33.210

EDI 消息由 X12 标准定义。

如果您寻找 X12 解析器，您可以找到有用的信息。

例如，[http://code.activestate.com/recipes/299485/](http://code.activestate.com/recipes/299485/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T14:50:13.613

这些是 ANSI X12 文件，标准在此处管理[http://www.wpc-edi.com/](http://www.wpc-edi.com/)

结构简明教程

层次结构 = 循环 -> 段 -> 元素 -> 子元素。

循环要么由控制段限定，要么在逻辑上基于标准。段用段终止符分隔，默认~元素用元素分隔符分隔，默认 * 子元素用子元素分隔符分隔，默认：

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T14:54:27.800

EDI 是一种分隔文件格式。您必须知道行分隔符和列分隔符（因为没有更好的答案）。例如，您可能会看到具有以下格式的 EDI 文件（来自[http://www.slik.co.nz/HTML_help/edi_file_format.htm](http://www.slik.co.nz/HTML_help/edi_file_format.htm)）：

```
 HDR|6||||
  DTL|1|ABC|xyz|123|1
  DTL|13|ABC|animal|334|1
  DTL|11|ABC|sfdk|432|2
  DTL|12|ABC|wewdc|3|1
  DTL|14|ABC|qwdx|416|4 
```

第一行是标题，告诉您有六条记录。其他线是细节线。

X12 是 EDI 使用的一种标准。您将看到 X12 常用于医疗保健。如果你有 X12，你可以检查 X12 标准来弄清楚如何解析。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T14:58:04.030

EDI代表电子数据交换...

它本身不是特定的格式。一般来说，它是一个平面文本数据文件，通常具有相关的已发布规范。例如：“位置 23-34 是作为货币价值的原始价格”

如果您没有随附的已定义规范，您真的无法对 EDI 文件做任何有用的事情。

一旦你得到规范，我相信如何阅读文件就会很清楚了。

一般流程为： 1\. 读取/解析EDI文件。2\. 对您需要的数据执行任何处理/转换。3\. 将其保存为您的本地系统格式（表格、其他平面文件等）。

抱歉，很遗憾，我们无法告诉您更多信息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-27T09:21:50.083

EDI 代表“电子数据交换”。这种做法涉及使用计算机技术在称为“贸易伙伴”的两个组织之间以电子方式交换信息或数据。从技术上讲，EDI 是一组标准，定义了信息的通用格式，因此可以以这种方式进行交换。

阅读更多：[http ://www.1edisource.com/learn-about-edi/what-is-edi#ixzz2g5E4p2ET](http://www.1edisource.com/learn-about-edi/what-is-edi#ixzz2g5E4p2ET)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-05T13:02:52.417

EDI 只是一个包含某种层次结构的平面文件。通常公司购买 EDI 翻译软件来解析这些文件并提取数据，然后与其他系统集成。您也可以使用某种类型的服务，他们会为您做到这一点。您可以尝试使用 Amosoft EDI Serices ( [www.amosoft.com](http://www.amosoft.com) )，他们可以帮助您。

# .net - 创建包含 .Net Framework 3.5 SP1 的安装项目

> ID：626525
> 
> 赞同：3
> 
> 时间：2009-03-09T14:48:48.220
> 
> 标签：.net, deployment, windows-installer

我正在创建一个安装项目。客户希望拥有已包含 .Net framework 3.5 SP1 的 setup.exe 文件。

但是，当我右键单击 setup project | 属性在“属性页面”上有一个名为“先决条件..”的按钮

您有 3 个选择： 供应商的网站与我的应用程序相同的位置从以下位置下载。

但是，客户端不想下载任何东西。所以我需要用 setup.exe 打包它。

有没有办法做到这一点？

如果 setup.exe 包含 .Net 框架，它将有多大？

非常感谢您的任何建议，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T15:08:50.527

完整的[.net 3.5 sp1 安装程序](http://www.microsoft.com/downloads/details.aspx?FamilyID=AB99342F-5D1A-413D-8319-81DA479AB0D7&displaylang=en)为 231 Mb，包含在光盘上相当大。如果你想沿着这条路线走，那么[这](http://msmvps.com/blogs/haarongonzalez/archive/2007/04/09/772757.aspx)应该会有所帮助。

如果它仅适用于一次性场景中的单个客户端，您可以将所有 pre-reqs 粘贴在其网络上某处的文件共享上，并使用“从以下位置下载先决条件”选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-24T11:05:43.557

[http://geekrick.blogspot.com/2008/08/frustrating-net-framework-sp1-issue.html](http://geekrick.blogspot.com/2008/08/frustrating-net-framework-sp1-issue.html)
和
[http://download.microsoft.com/download/A/2/8/A2807F78-C861-4B66- 9B31-9205C3F22252/VS2008SP1Readme.htm#General%20Issues](http://download.microsoft.com/download/A/2/8/A2807F78-C861-4B66-9B31-9205C3F22252/VS2008SP1Readme.htm#General%20Issues)

是很好的向导。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-10T02:57:08.953

[http://www.hanselman.com/smallestdotnet/](http://www.hanselman.com/smallestdotnet/) （我讨厌这个）但我认为你应该看到它。嘿，它只有 28meg HE HE HE，是的，它只穿上你需要的东西。他们从哪里得到信息？

你看，我猜在制作了一些 .net 东西之后，开发人员可以告诉“用户”，嘿，小菜一碟只有 28meg。
糟糕的是，这仅适用于安装程序。嘿，其他人知道需要 28MEGS 的更新程序吗？

好吧好吧，但它很可爱，客户永远不会知道 LOL，嘿，它为那里的某个人工作 ;-)

# bash - 如何直接 ssh 到特定目录？

> ID：626533
> 
> 赞同：290
> 
> 时间：2009-03-09T14:50:21.147
> 
> 标签：bash, shell, scripting, ssh

我经常必须登录到几台服务器之一并转到这些机器上的几个目录之一。目前我做这样的事情：

```
localhost ~]$ ssh somehost

欢迎来到某个主机！

somehost ~]$ cd /some/directory/somewhere/named/Foo
somehost Foo]$

```

我有脚本可以确定我需要进入哪个主机和哪个目录，但我无法找到一种方法来做到这一点：

```
本地主机 ~]$ go_to_dir Foo

欢迎来到某个主机！

somehost Foo]$

```

有没有简单、聪明或任何方法可以做到这一点？

* * *

## 回答 #1

> 赞同：498
> 
> 时间：2009-03-09T14:59:05.697

您可以执行以下操作：

```
ssh -t xxx.xxx.xxx.xxx "cd /directory_wanted ; bash --login" 
```

这样，您将在 directory_wanted 上获得一个登录 shell。

* * *

解释

> `-t`强制伪终端分配。这可用于在远程机器上执行任意基于屏幕的程序，这非常有用，例如在实现菜单服务时。
> 
> 多个`-t`选项强制 tty 分配，即使 ssh 没有本地 tty。

*   如果不使用`-t`则不会出现提示。
*   如果您不添加`; bash`，则连接将关闭并将控制权返回给您的本地计算机
*   如果您不添加`bash --login`，那么它将不会使用您的配置，因为它不是登录 shell

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2009-03-09T15:22:48.777

你可以添加

```
cd /some/directory/somewhere/named/Foo 
```

到您在另一台主机上的`.bashrc`文件（或`.profile`任何您称之为的文件）。这样，无论您做什么，无论您`ssh`来自哪里，无论何时登录该服务器，它都会`cd`进入适合您的目录，您所要做的就是像平常一样使用`ssh`。

诅咒，rogeriopvl 的解决方案也有效，但它有点冗长，而且你必须记住每次都这样做（除非你制作别名），所以它看起来不那么“有趣”。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2019-01-17T19:08:00.937

我的首选方法是使用 SSH 配置文件（如下所述），但根据您的使用情况，有一些可能的解决方案。

# 命令行参数

我认为这种方法的最佳答案是 christianbundy 对已接受答案的回复：

```
ssh -t example.com "cd /foo/bar; exec \$SHELL -l" 
```

使用双引号将允许您使用本地计算机中的变量，除非它们被转义（如此`$SHELL`处）。或者，您可以使用单引号，并且您使用的所有变量都是来自目标机器的变量：

```
ssh -t example.com 'cd /foo/bar; exec $SHELL -l' 
```

# 重击函数

您可以通过将命令包装在 bash 函数中来简化命令。假设您只想输入以下内容：

```
sshcd example.com /foo/bar 
```

您可以通过将其添加到您的`~/.bashrc`：

```
sshcd () { ssh -t "$1" "cd \"$2\"; exec \$SHELL -l"; } 
```

如果您将远程计算机上存在的变量用于目录，请确保将其转义或放在单引号中。例如，这将 cd 到存储在`JBOSS_HOME`远程机器上的变量中的目录：

```
sshcd example.com \$JBOSS_HOME 
```

# SSH 配置文件

如果您希望使用普通 ssh 命令始终查看特定（或任何）主机的这种行为，而不必使用额外的命令行参数，您可以在 ssh 配置文件中设置`RequestTTY`和`RemoteCommand`选项。

例如，我只想输入以下命令：

```
ssh qaapps18 
```

但希望它始终表现得像这个命令：

```
ssh -t qaapps18 'cd $JBOSS_HOME; exec $SHELL' 
```

所以我将此添加到我的`~/.ssh/config`文件中：

```
Host *apps*
    RequestTTY yes
    RemoteCommand cd $JBOSS_HOME; exec $SHELL 
```

现在，此规则适用于主机名中包含“apps”的任何主机。

有关详细信息，请参阅[http://man7.org/linux/man-pages/man5/ssh_config.5.html](http://man7.org/linux/man-pages/man5/ssh_config.5.html)

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2014-02-12T11:33:32.853

我创建了一个将 SSH 和 CD 连续连接到服务器的工具——恰当地命名为[sshcd](https://github.com/christianbundy/sshcd)。对于您给出的示例，您只需使用：

```
sshcd somehost:/some/directory/somewhere/named/Foo 
```

如果您有任何疑问或问题，请告诉我！

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2017-12-14T09:20:13.333

根据对@rogeriopvl 的回答的补充，我建议如下：

```
ssh -t xxx.xxx.xxx.xxx "cd /directory_wanted && bash" 
```

链接命令 by`&&`将使下一个命令仅在前一个命令成功时运行（与 using 相反`;`，后者按顺序执行命令）。这在需要到`cd`执行命令的目录时特别有用。

想象一下执行以下操作：

```
/home/me$ cd /usr/share/teminal; rm -R * 
```

该目录`teminal`不存在，这会导致您留在主目录中并使用以下命令删除其中的所有文件。

如果您使用`&&`：

```
/home/me$ cd /usr/share/teminal && rm -R * 
```

找不到目录后，该命令将失败。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-06-13T15:45:01.067

在我非常具体的情况下，我只想在远程主机中执行一个命令，在 Jenkins 从机的特定目录中：

```
ssh myuser@mydomain
cd /home/myuser/somedir 
./commandThatMustBeRunInside_somedir
exit 
```

但是我的机器无法执行 ssh（我想它无法分配伪 tty）并让我给出以下错误：

```
Pseudo-terminal will not be allocated because stdin is not a terminal 
```

我可以通过传递“cd to dir + my command”作为 ssh 命令的参数（不必分配伪终端）并通过传递选项 -T 来明确告诉 ssh 命令我没有解决这个问题不需要伪终端分配。

```
ssh -T myuser@mydomain "cd /home/myuser/somedir; ./commandThatMustBeRunInside_somedir" 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-09T15:05:52.810

我使用环境变量 CDPATH

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-02-25T04:11:37.480

更进一步的`-t`想法。我保留了一组脚本，调用下面的脚本来访问我经常访问的主机中的特定位置。我将它们全部保存在我的路径中`~/bin`，并将该目录保存在我的路径中。

```
#!/bin/bash

# does ssh session switching to particular directory
# $1, hostname from config file 
# $2, directory to move to after login
# can save this as say 'con' then
# make another script calling this one, e.g.
# con myhost repos/i2c

ssh -t $1 "cd $2; exec \$SHELL --login" 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-03-04T15:36:43.203

我的回答可能与你真正想要的不同，但我写在这里可能对某些人有用。在我的解决方案中，您必须进入目录一次，然后每个新的 ssh 会话都进入同一个目录（在第一次注销之后）。

**如何 ssh 到您上次登录时的同一目录。** （我假设您在远程节点上使用 bash。）

**将此行添加到远程节点**上的 ~/.bash_logout (!)：

```
echo $PWD > ~/.bash_lastpwd 
```

这些行到 ~/.bashrc 文件（仍在**远程节点**上！）

```
if [ -f ~/.bash_lastpwd ]; then
    cd $(cat ~/.bash_lastpwd)
fi 
```

这样，您可以在每次注销时保存当前路径，并`.bashrc`在登录后将您放入该目录。

ps：您可以进一步调整它，例如使用`SSH_CLIENT`变量来决定是否进入该目录，这样您就可以区分本地登录和 ssh 甚至不同的 ssh 客户端。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-11-18T21:30:37.227

登录后直接进入的另一种方法是创建“别名”。当您登录系统时，只需输入该别名，您就会进入该目录。

示例：别名 = myfolder '/var/www/Folder'

在您登录到您的系统类型后，该别名（这适用于系统的任何部分）
如果不在 bashrc 中，则此命令将适用于当前会话。因此，您还可以将此别名添加到 bashrc 以供将来使用

$ myfolder => 带你到那个文件夹

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-10-02T08:45:56.517

我知道这在很久以前就已经得到了回答，但是我在尝试将 ssh 登录合并到 bash 脚本中时发现了这个问题，一旦登录运行一些命令并注销并继续使用 bash 脚本。我发现在其他地方没有提到的最简单的方法是这样做，因为它是如此微不足道。

```
#!/bin/bash

sshpass -p "password" ssh user@server 'cd /path/to/dir;somecommand;someothercommand;exit;' 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-09-02T14:21:58.057

## 与用户联系

如果您不知道这一点，您可以通过指定用户和主机来使用它来连接

```
ssh -t <user>@<Host domain / IP> "cd /path/to/directory; bash --login" 
```

例子：`ssh -t admin@test.com "cd public_html; bash --login"`

您还可以通过在每个命令之前将其附加在双引号中来附加要在每次登录时执行的`;`命令

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-01-13T04:22:46.127

不幸的是，当您使用多个跃点时，建议的解决方案（@rogeriopvl）不起作用，所以我找到了另一个。在远程机器上添加`~/.bashrc`以下内容：

```
[ "x$CDTO" != "x" ] && cd $CDTO 
```

这允许您以这种方式在命令行上指定所需的目标目录：

```
ssh -t host1 ssh -t host2 "CDTO=/desired_directory exec bash --login" 
```

当然，这种方式也可以用于单跳。

此解决方案可以与@redseven 的有用提示结合使用以获得更大的灵活性（如果没有 $CDTO，则转到保存的目录，如果存在）。

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2009-03-09T14:56:42.413

SSH 本身提供了一种通信方式，它对目录一无所知。由于您可以指定要执行的远程命令（这是 - 默认情况下 - 您的 shell），我将从那里开始。

* * *

## 回答 #15

> 赞同：-7
> 
> 时间：2016-06-16T11:19:15.833

只需使用以下命令修改您的家： `usermod -d /newhome username`

# .net - Linq-To-SQL 被废弃了吗？

> ID：626539
> 
> 赞同：1
> 
> 时间：2009-03-09T14:51:16.513
> 
> 标签：.net, sql-server, linq, linq-to-sql

### 复制：

> [LINQ to SQL 是 DOA 吗？](https://stackoverflow.com/questions/252683/is-linq-to-sql-doa)

我在网上的某个地方读到，微软正在考虑以目前的形式放弃 LINQ-To-SQL，因为它不是很成功。

我希望尽可能多地对此发表意见，因为我是 .NET 的新手，并且想为我工作的地方选择最好的路线。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-09T14:54:23.383

不，不是 LINQ 本身。“语言综合查询”将继续存在。

有一些关于 MS 放弃“Linq-to-SQL”（LINQ 的 SQLServer-only 数据库版本）转而支持 ADO.NET 实体框架的讨论，但即使这样仍然有点不清楚。

请参阅 MS [ADO.NET 团队博客中的这篇文章以及](http://blogs.msdn.com/adonet/archive/2008/10/29/update-on-linq-to-sql-and-linq-to-entities-roadmap.aspx)[Oren Eini](http://ayende.com/Blog/archive/2008/10/31/microsoft-kills-linq-to-sql.aspx)和[David Hayden](http://codebetter.com/blogs/david.hayden/archive/2008/10/31/linq-to-sql-is-dead-read-between-the-lines.aspx)的这些评论。

虽然我认为 Linq-To-Sql 可能不会再收到大的更新，但我非常怀疑它会从产品中物理删除，因此第三方开发人员总有机会介入并使其变得更好！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T14:54:36.490

不完全是“报废”，但 MS 正在转向[下一件大事](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx)。

此外，不要将 linq-to-sql 与 linq-to-objects、lambda 表达式或 IEnumerable 扩展方法混淆。那些不会去任何地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T14:55:32.040

[这是另一个讨论这个的 SO 线程。](https://stackoverflow.com/questions/252683/is-linq-to-sql-doa)他们并没有摆脱 LINQ，我相信只是 Linq-To-SQL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T14:56:24.893

我认为 MS 不太可能不再支持 LINQ。我很好奇你在哪里听到它“不是很成功”......据我所知，LINQ 被认为是自泛型以来对 .NET 的最佳补充。

就此而言，无论使用多少，继续支持它都不会“花费”任何东西。LINQ 及其相关技术（SQL、实体、XML 等）将继续存在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T14:56:21.883

LINQ 并没有被废弃，但 Linq to SQL 可能是：它看起来将被实体框架取代。

我认为这需要一些时间，尽管我希望 MS 至少会提供一些迁移工具来从 L2S 迁移到 EF。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T14:58:05.683

这是一个 MSDN 博客条目，几乎暗示微软更喜欢 LINQ 到 LINQ 到 SQL 之上的实体，但没有提到完全废弃 LINQ。

[http://blogs.msdn.com/adonet/archive/2008/10/29/update-on-linq-to-sql-and-linq-to-entities-roadmap.aspx](http://blogs.msdn.com/adonet/archive/2008/10/29/update-on-linq-to-sql-and-linq-to-entities-roadmap.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T15:21:09.640

LINQ 将保留在 .Net-Framework 中，因为它是一个非常强大且流行的附加组件。但微软宣布将专注于[实体框架](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx)的开发。这将使[LINQ-TO-SQL-PROVIDER](http://msdn.microsoft.com/en-us/library/bb386976.aspx)过时。当然，您可以使用 LINQ 从 EF 对象中查询数据。

因此，我建议您仔细研究 LINQ 的可能性，因为它使对各种列表的数据查询变得更容易和更快（对我而言）。

# c# - LINQ 和 Count 扩展方法

> ID：626540
> 
> 赞同：6
> 
> 时间：2009-03-09T14:51:27.540
> 
> 标签：c#, linq-to-sql

我有一个可以包含许多记录的数据库表，我想计算表中的当前总数。我打算做一个简单的：

```
DataContext.Table.Count(c => c.condition); 
```

直到我意识到返回类型为`Count`is `int`。如果表要保存的值多于 32 位可以表示的值怎么办？我怎么数他们？

当我们谈论这种规模时，我应该以不同的方式计算它们吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T14:53:58.253

使用 LongCount()，同样的，但结果为 64 位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T14:53:56.537

我的解决方案是使用`.LongCount()`扩展方法。

# c# - 在 C# 中侦听 ICMP 数据包

> ID：626541
> 
> 赞同：8
> 
> 时间：2009-03-09T14:51:46.637
> 
> 标签：c#, icmp

我有一个需要发送 UDP 数据包来设置 SIP 呼叫的 SIP 应用程序。SIP 有一个超时机制来处理交付失败。我想做的另一件事是检测 UDP 套接字是否已关闭，以便必须等待 SIP 使用的 32 秒重传间隔。

我所指的情况是尝试发送到 UDP 套接字导致远程主机生成 ICMP 目标不可达数据包。如果我尝试向启动但端口未侦听的主机发送 UDP 数据包，我可以看到带有数据包跟踪器的 ICMP 消息返回，但问题是如何从我的 C# 代码中访问它？

我正在玩原始套接字，但还不能让我的程序接收到 ICMP 数据包。即使 ICMP 消息到达我的 PC，下面的示例也不会收到数据包。

```
Socket icmpListener = new Socket(AddressFamily.InterNetwork, SocketType.Raw, ProtocolType.Icmp);
icmpListener.Bind(new IPEndPoint(IPAddress.Any, 0));

byte[] buffer = new byte[4096];
EndPoint remoteEndPoint = new IPEndPoint(IPAddress.Any, 0);
int bytesRead = icmpListener.ReceiveFrom(buffer, ref remoteEndPoint);
logger.Debug("ICMPListener received " + bytesRead + " from " + remoteEndPoint.ToString()); 
```

下面是一个 Wireshark 跟踪，显示了 ICMP 响应进入我的 PC 的尝试，该响应是从我知道它没有在侦听的端口上尝试从 10.0.0.100（我的 PC）到 10.0.0.138（我的路由器）发送一个 UDP 数据包。我的问题是如何利用这些 ICMP 数据包来实现 UDP 发送失败，而不是仅仅等待应用程序在任意时间后超时？

![ICMP 对 UDP 的响应发送](https://i.stack.imgur.com/lmb4J.png)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-02-07T10:13:11.300

将近 3 年后，我偶然发现了[http://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C](http://www.codeproject.com/Articles/17031/A-Network-Sniffer-in-C)，它给了我足够的提示，帮助我找到在 Windows 上接收 ICMP 数据包的解决方案7（不知道Vista，最初的问题是关于这个的，但我怀疑这个解决方案会起作用）。

两个关键点是套接字必须绑定到单个特定 IP 地址而不是 IPAddress.Any 和设置 SIO_RCVALL 标志的 IOControl 调用。

```
Socket icmpListener = new Socket(AddressFamily.InterNetwork, SocketType.Raw, ProtocolType.Icmp);
icmpListener.Bind(new IPEndPoint(IPAddress.Parse("10.1.1.2"), 0));
icmpListener.IOControl(IOControlCode.ReceiveAll, new byte[] { 1, 0, 0, 0 }, new byte[] { 1, 0, 0, 0 });

byte[] buffer = new byte[4096];
EndPoint remoteEndPoint = new IPEndPoint(IPAddress.Any, 0);
int bytesRead = icmpListener.ReceiveFrom(buffer, ref remoteEndPoint);
Console.WriteLine("ICMPListener received " + bytesRead + " from " + remoteEndPoint);
Console.ReadLine(); 
```

我还必须设置防火墙规则以允许接收 ICMP 端口不可达数据包。

```
netsh advfirewall firewall add rule name="All ICMP v4" dir=in action=allow protocol=icmpv4:any,any 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-20T02:00:57.910

**更新：我想我快疯了......你发布的那段代码也为我工作......**

以下代码对我来说很好（xp sp3）：

```
using System;
using System.Net;
using System.Net.Sockets;

namespace icmp_capture
{
    class Program
    {
        static void Main(string[] args)
        {            
            IPEndPoint ipMyEndPoint = new IPEndPoint(IPAddress.Any, 0);
            EndPoint myEndPoint = (ipMyEndPoint);
            Socket socket = new Socket(AddressFamily.InterNetwork, SocketType.Raw, ProtocolType.Icmp);            
            socket.Bind(myEndPoint);
            while (true)
            {

                /*                
                //SEND SOME BS (you will get a nice infinite loop if you uncomment this)
                var udpClient = new UdpClient("192.168.2.199", 666);   //**host must exist if it's in the same subnet (if not routed)**              
                Byte[] messagebyte = Encoding.Default.GetBytes("hi".ToCharArray());                
                int s = udpClient.Send(messagebyte, messagebyte.Length);
                */

                Byte[] ReceiveBuffer = new Byte[256];
                var nBytes = socket.ReceiveFrom(ReceiveBuffer, 256, 0, ref myEndPoint);
                if (ReceiveBuffer[20] == 3)// ICMP type = Delivery failed
                {
                    Console.WriteLine("Delivery failed");
                    Console.WriteLine("Returned by: " + myEndPoint.ToString());
                    Console.WriteLine("Destination: " + ReceiveBuffer[44] + "." + ReceiveBuffer[45] + "." + ReceiveBuffer[46] + "." + ReceiveBuffer[47]);
                    Console.WriteLine("---------------");
                }
                else {
                    Console.WriteLine("Some (not delivery failed) ICMP packet ignored");
                }
            }

        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-15T07:20:55.357

Icmp 使用的**标识符**对于每个 icmp“会话”（对于每个 icmp 套接字）似乎都不同。因此，**对不是由同一个套接字发送的 icmp 数据包的回复会**为您**过滤掉**。这就是为什么那段代码不起作用的原因。*（对此我不确定。这只是查看一些 ICMP 流量后的假设。）*

您可以简单地 ping 主机，看看您是否可以访问它，然后尝试您的 SIP。但是，如果其他主机正在过滤掉 icmp，这将不起作用。

一个丑陋（但有效）的解决方案是使用**winpcap**。*（将其作为唯一可行的解​​决方案似乎太糟糕了，难以置信。）*

我使用 winpcap 的意思是您可以**捕获 ICMP 流量**，然后**查看捕获的数据包是否与您的 UDP 数据包无法传递有关**。

这是捕获 tcp 数据包的示例： [http](http://www.tamirgal.com/home/SourceView.aspx?Item=SharpPcap&File=Example6.DumpTCP.cs) ://www.tamirgal.com/home/SourceView.aspx?Item=SharpPcap&File=Example6.DumpTCP.cs （用 ICMP 做同样的事情应该不会太难。）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-08-08T15:40:14.167

只需使用已连接的 udp 套接字，操作系统就会匹配无法访问的 icmp 并在 udp 套接字中返回错误。

谷歌连接的 udp 套接字。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-18T17:14:19.750

所以你想以编程方式获取 dest 无法到达的返回 icmp 数据包？一个艰难的。我会说网络堆栈在您靠近它之前就吸收了它。

我认为纯 C# 方法在这里行不通。您需要使用驱动程序级别拦截来获取挂钩。看看这个使用 Windows 的 ipfiltdrv.sys 捕获数据包（icmp、tcp、udp 等）并使用托管代码读取/播放它们的应用程序（ C＃）。

[http://www.codeproject.com/KB/IP/firewall_sniffer.aspx?display=Print](http://www.codeproject.com/KB/IP/firewall_sniffer.aspx?display=Print)

*   奥辛

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-20T09:25:19.353

网上有很多帖子提到 ICMP Port Unreachable 数据包在 Vista 上不再可访问的问题。

*   [http://www.eggheadcafe.com/software/aspnet/31961998/icmp-port-unreachable-and.aspx](http://www.eggheadcafe.com/software/aspnet/31961998/icmp-port-unreachable-and.aspx)
*   [http://social.msdn.microsoft.com/Forums/en-US/Offtopic/thread/5bd8b275-cc6f-43cd-949d-7c411973b2f3/](http://social.msdn.microsoft.com/Forums/en-US/Offtopic/thread/5bd8b275-cc6f-43cd-949d-7c411973b2f3/)

堆栈在收到 ICMP 时应该给您一个异常。但它没有，至少在 Vista 上是这样。因此，您正在尝试一种解决方法。

我不喜欢说不可能的答案，但似乎是这样。所以我建议你回到最初的问题，即 SIP 中的长时间超时。

*   您可以让用户配置超时（因此符合规范）。
*   您可以在超时结束之前开始做其他事情（例如检查其他代理）。
*   您可以缓存已知的错误目的地（但这需要对缓存进行良好的管理。
*   如果 icmp 和 udp 没有给出正确的错误消息，请尝试 tcp 或其他协议。只是为了引出所需的信息。

*（一切皆有可能，只是可能需要大量资源。）*

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-18T16:53:45.247

我写这个作为一个单独的答案，因为细节与我之前写的完全不同。

因此，根据 Kalmi 关于会话 ID 的评论，我开始思考为什么我可以在同一台机器上打开两个 ping 程序，并且响应不会交叉。它们都是 ICMP，因此都使用无端口原始套接字。这意味着 IP 堆栈中的某些东西必须知道这些响应的目的是什么套接字。对于 ping，事实证明在 ICMP 包的数据中使用了一个 ID，作为 ECHO REQUEST 和 ECHO REPLY 的一部分。

然后我在维基百科上看到了这个关于[ICMP](http://en.wikipedia.org/wiki/Internet_Control_Message_Protocol)的评论：

> 尽管 ICMP 消息包含在标准 IP 数据报中，但 ICMP 消息通常被处理为一种特殊情况，与普通 IP 处理不同，而不是作为 IP 的普通子协议处理。在许多情况下，有必要检查 ICMP 消息的内容并将适当的错误消息传递给生成原始 IP 数据包的应用程序，即提示发送 ICMP 消息的应用程序。

[此处](http://www.networksorcery.com/enp/protocol/icmp/msg3.htm)（间接）详细说明了这一点：

> 互联网报头加上原始数据报数据的前 64 位。主机使用此数据将消息与适当的进程匹配。如果更高级别的协议使用端口号，则假定它们位于原始数据报数据的前 64 个数据位中。

由于您使用的是使用端口的 UDP，因此网络堆栈可能会将 ICMP 消息路由回原始套接字。这就是为什么您的新的独立套接字永远不会收到这些消息的原因。我想UDP会吃掉ICMP消息。

如果我是正确的，一个解决方案是打开一个原始套接字并手动创建您的 UDP 数据包，侦听返回的任何内容，并根据需要处理 UDP 和 ICMP 消息。我不确定这在代码中会是什么样子，但我不认为它会太难，并且可能被认为比 winpcap 解决方案更“优雅”。

此外，此链接[http://www.networksorcery.com/enp/default1003.htm](http://www.networksorcery.com/enp/default1003.htm)似乎是低级网络协议的绝佳资源。

我希望这有帮助。

# .net - 使用 ISA Server 2006 SP1 访问未编译页面时出错

> ID：626543
> 
> 赞同：1
> 
> 时间：2009-03-09T14:52:46.103
> 
> 标签：.net, isaserver

我们正在配置门户以使用 ISA 服务器作为我们的前端安全提供程序。
所以我们使用的是ISA Server 2006 SP1。

不幸的是，当我们通过 ISA Server 访问 .net 应用程序时，它们是第一次被访问。
即它们尚未编译，出现以下错误：
错误代码：500 内部服务器错误。参数不正确。(87)

在 ISA 监控日志中，这显示：

> 失败的连接尝试
> 日志类型：Web 代理（反向）
> 状态：87 参数不正确。

一旦应用程序被编译，错误就永远不会出现。
有谁知道如何解决这个问题，所以该网站第一次正常工作？

一些附加信息：

*   访问的网站在 windows server 2008 64 位标准版上运行，并且出现在 Sharepoint 以及标准 .net 网站上。
*   ISA 服务器在 Windows server 2003 R2 SP2 标准版上运行
*   windows server 2008 盒子上的防火墙允许所有访问。（排除这种情况。）
*   IIS 日志或防火墙日志中没有出现任何异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T04:29:14.513

您可以[预先编译网站](http://msdn.microsoft.com/en-us/library/ms227972.aspx)。这更像是一种解决方法。

您是否尝试过清除 ASP.NET 的编译输出目录？你可能在那里有一些冲突。

```
%SystemRoot%\Microsoft.NET\Framework\versionNumber\Temporary ASP.NET Files 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T10:45:21.927

此问题是由 ISA 服务器中的身份验证委派值设置为 NTLM 而 IIS 设置为接受 Windows 身份验证引起的。这种组合在我的环境中似乎是一个问题。

将其更改为基本身份验证或任何其他有效组合都可以正常工作，因此我将使用不同的身份验证委托设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-09T00:31:25.207

我今天遇到了同样的问题（ISA 2006/sp1 通过 ISA HTML Form Auth 发布 SharePoint，通过 NTLM 身份验证）并花了几个小时调试它。你是对的，编译触发它的页面是必要的，只有 IISRESET 会导致问题；应用程序池回收不会。基本身份验证有效，但 NTLM 无效。请继续阅读以进行修复。

如果您查看 IIS 日志，您会发现那里有些奇怪，**即**IIS 对特定 HTTP 请求的 401 回复并带有一点提示：

```
... GET /auth.aspx - 80 - ... Mozilla/4.0+(compatible;...) 401 1 2148074254 734 
```

请注意错误代码 2148074254 ( 0x8009030e SEC_E_NO_CREDENTIALS )。在常规的质询/响应交换中，这应该是“5”。

这导致我走上了一些更曲折的调试路径，最终我发现问题归结为默认启用 IIS 7 的内核模式身份验证。如果你关闭它：

```
%windir%\system32\inetsrv\appcmd set config -section:windowsAuthentication -useKernelMode:false 
```

...问题消失了。这篇文章中有足够的信息供任何人挖掘其技术原因，所以我不会在这里重复它。

-Oisin

# javascript - 用于缩放和平移图像的 Javascript

> ID：626558
> 
> 赞同：7
> 
> 时间：2009-03-09T14:56:07.513
> 
> 标签：javascript, html

我正在处理的项目中需要一段 JavaScript，它允许用户平移和放大和缩小大图像。

不幸的是，我对 JavaScript 的经验有限。

有人知道可以满足我要求的免费脚本吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T15:12:57.427

我认为有一个 jquery ZoomImage 插件可以很好地用于这种情况。代码示例在[此处](http://www.eyecon.ro/zoomimage/)或[此处](http://www.suuronen.org/esa-matti/projects/panfullsize/)。

[有一个也使用图像](http://www.oneblackbear.com/zoom/index.html)旁边的缩放工具栏

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T15:00:31.780

我不知道您是否能够使用任何库，例如 jQuery 或 Prototype/Scriptaculous，这可能会增加您的可用选项。

也就是说，这个来自 Todd Ditchendorf 的示例非常酷，并且没有外部依赖项：

[http://ditchnet.org/dhtmlgallery/izoom/](http://ditchnet.org/dhtmlgallery/izoom/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T21:35:09.710

在这里查看 SeaDragon AJAX：

[http://livelabs.com/seadragon-ajax/](http://livelabs.com/seadragon-ajax)

它与 PhotoSynth 中使用的“深度缩放”技术相同，但它完全是在 Javascript 中完成的。有一个预先构建的查看器控件，您可以将其嵌入到您的页面中，并且还有一个用于创建多级图像的工具，因此您无需成为忍者 Javascript 编码器即可开始使用。它是 100% 的 HTML 和 JS。

使用 Silverlight 查看器可以让您更平滑地缩放，但如果您的客户端反对插件，那么 AJAX 解决方案可能是要走的路。

我希望这有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T21:05:06.863

Have a look at the examples of [Shadowbox](http://www.mjijackson.com/shadowbox/).

# c++ - C API 函数的风格

> ID：626567
> 
> 赞同：9
> 
> 时间：2009-03-09T14:57:45.997
> 
> 标签：c++, c, api

我正在开发一个支持多种编程环境（如 VB6 和 FoxPro）的库。我必须坚持 C 约定，因为它是最低公分母。现在我有一个关于风格的问题。

假设函数处理输入并返回一个字符串。在此过程中，可能会发生错误。当前建议的样式是这样的：

```
int func(input params... char* buffer, unsigned int* buffer_size); 
```

这种风格的好处是一切都包含在原型中，包括错误代码。并且可以避免内存分配。问题是该函数非常冗长。而且因为 buffer_size 可以是任意的，所以它需要更多的代码来实现。

另一种选择是返回 char*，并返回 NULL 以指示错误：

```
char* func(input params...); 
```

这种风格要求调用者删除缓冲区。需要内存分配，因此服务器程序可能会面临内存碎片问题。

第二个选项的变体是使用线程局部变量来保存返回的指针 char*，这样用户就不需要删除缓冲区。

你喜欢哪种风格？和原因？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T15:32:46.117

说到这个话题，我有点“损坏的货物”。我曾经为嵌入式电信设计和维护相当大的 API。一个你不能把任何事情视为理所当然的环境。甚至没有像全局变量或 TLS 这样的东西。有时甚至会出现堆缓冲区，它们实际上是寻址 ROM 内存。

因此，如果您正在寻找“最低公分母”，您可能还想考虑在您的目标环境中可以使用哪些语言结构（编译器可能接受标准 C 中的任何内容，但如果某些内容不受支持，则链接器会说不）。

话虽如此，**我总是会选择替代 1**。部分原因是（正如其他人指出的那样），您永远不应该直接为用户分配内存（间接方法将在下面进一步解释）。即使保证用户使用纯 C 语言，他们仍然可以使用自己定制的内存管理 API 来跟踪泄漏、诊断日志等。对这样的策略的支持是普遍赞赏的。

**处理 API 时，错误通信**是最重要的事情之一。由于用户可能有不同的方法来处理其代码中的错误，因此您应该尽可能地在整个 API 中保持这种通信的一致性。用户应该能够以一致的方式和最少的代码将错误处理包装到您的 API 中。我通常总是建议使用清晰的枚举代码或定义/类型定义。我个人更喜欢 typedef:ed 枚举：

```
typedef enum {

  RESULT_ONE,
  RESULT_TWO

} RESULT; 
```

..因为它提供类型/分配安全。

有一个*get-last-error*函数也很好（但是需要中央存储），我个人仅将它用于提供有关已识别错误的额外信息。

**备选方案 1的冗长**可以通过制作如下简单的复合词来限制：

```
struct Buffer
{
  unsigned long size;
  char* data;
}; 
```

然后你的 api 可能看起来更好：

```
ERROR_CODE func( params... , Buffer* outBuffer ); 
```

这一策略也为更精细的机制开辟了道路。举例来说，您必须能够为用户分配内存（例如，如果您需要调整缓冲区的大小），那么您可以为此提供一种间接方法：

```
struct Buffer
{
  unsigned long size;
  char* data;
  void* (*allocator_callback)( unsigned long size );
  void  (*free_callback)( void* p );
}; 
```

当然，这种结构的风格总是值得认真讨论。

祝你好运！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T15:10:24.720

我更喜欢第一个定义，传入缓冲区及其大小。有例外，但通常您不希望在调用函数后进行清理。而如果我分配内存并将其传递给函数，那么我知道我必须自己清理。

处理不同大小的缓冲区应该没什么大不了的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T15:07:42.650

如果我必须在显示的两种样式之间进行选择，我每次都会选择第一种。第二种风格让你的图书馆的用户有别的想法，内存分配，有人肯定会忘记释放内存。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T15:13:37.490

第二种风格的另一个问题是分配内存的上下文可能不同。例如：

```
// your library in C
char * foo() {
   return malloc( 100 );
}

// my client code C++
char * p =  foo();      // call your code
delete p;               // natural for me to do, but ... aaargh! 
```

而这只是问题的一小部分。你可以说双方都应该使用 malloc & free，但是如果他们使用不同的编译器实现呢？最好所有分配和释放都发生在同一个地方。这是否是库 r 客户端代码取决于您。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T15:02:10.247

第二种变体更清洁。

COM IErrorInfo 是第二种方法的实现。服务器调用 SetErrorInfo 来设置错误的详细信息并返回错误代码。调用者检查代码并可以调用 GetErrorInfo 来获取详细信息。调用者负责释放 IErrorInfo，但是在第一个变体中传递每个调用的参数也不是很漂亮。

服务器可以在启动时预先分配足够的内存，以便它肯定有足够的内存来返回错误详细信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T15:16:30.493

当其他程序员使用它时，第一版将不太容易出错。

如果程序员必须自己分配内存，他们更有可能记得释放它。如果库为它们分配内存，那又是另一种抽象，并且可能/将导致复杂化。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-09T15:19:58.923

需要思考的事情很少；

*   分配和释放应该发生在相同的范围内（理想情况下）。最好由调用者传入一个预先分配的缓冲区。调用者稍后可以安全地释放它。这就提出了一个问题——缓冲区应该有多大？我已经看到在 Win32 中广泛使用的一种方法是将 NULL 作为输入缓冲区传递，该`size`参数会告诉您需要多少。

*   您监督了多少种可能的错误情况？返回 a`char*`可能会限制错误报告的范围。

*   您希望满足哪些前置条件和后置条件？你的原型是否反映了这一点？

*   您是否在调用者或被调用者中进行错误检查？

我不能真的告诉你一个比另一个更好，因为我没有大局。但我相信这些事情可以让你和其他帖子一样开始思考。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-09T17:24:08.813

使用这两种方法怎么样？我同意有利于样式 1 与样式 2 缺陷的答案的共识。我确实认为如果您的所有 API 都遵循一致的命名习惯，则可以使用样式 2，如下所示：

```
 // Style 1 functions
int fooBuff(char* buffer, unsigned int buffer_size, input params... );

// Style 2 functions
char* fooBuffAlloc(input params...);
bool fooBuffFree(char* foo); 
```

/D

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-09T15:40:43.243

在 snprintf 和类似功能的模型之后，我会以与第一种方式类似的方式进行操作，但略有不同：

```
int func(char* buffer, size_t buffer_size, input params...); 
```

这样，如果你有很多这些，它们看起来很相似，并且你可以在有用的地方使用可变数量的参数。

我非常同意使用版本 1 而不是版本 2 的已经陈述的原因 - 版本 2 更可能出现内存问题。

# windows-mobile - windows mobile 中的连接管理器

> ID：626578
> 
> 赞同：1
> 
> 时间：2009-03-09T15:00:11.077
> 
> 标签：windows-mobile, connectivity

我尝试将单元核心连接管理器与 c# 一起使用，以强制我的应用程序浏览 WAP 网关（使用其 GUID），尽管默认连接是互联网。我看到 WAP 连接打开，但所有实际请求都通过互联网，我最终得到 2 个打开的连接。有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T08:26:11.907

您可以使用[Connection Manager](http://msdn.microsoft.com/en-us/library/ms879580.aspx)来做到这一点。OpenNetCF 智能设备框架中有一个 .NET 包装器。文档[在这里](http://www.opennetcf.com/library/sdf/)。您需要使用 Connect 方法通过其 GUId 连接到特定网络。

# flash - 将所有图像加载到 AS3 中的动态文本框中

> ID：626590
> 
> 赞同：0
> 
> 时间：2009-03-09T15:03:06.907
> 
> 标签：flash, actionscript-3

[如this question](https://stackoverflow.com/questions/624754/enable-smoothing-on-imported-rotated-image-in-dynamic-text-box-in-flash-as3)中所述，我能够平滑文本框中加载的旋转图像。该解决方案要求我知道传入图像的 id。有没有办法概括并获取所有传入图像的列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-10T01:48:23.953

您可能想用正则表达式解析出 id？

# jquery - sIFR jQuery 切换，在 FF3 中不起作用

> ID：626595
> 
> 赞同：1
> 
> 时间：2009-03-09T15:04:52.690
> 
> 标签：jquery, firefox, sifr

我有一个 sIFR 替换的 H2 链接，它只是切换（w/jQuery）另一个 div 打开和关闭。“似乎”适用于除 Firefox 3 以外的所有浏览器。有什么想法吗？

```
<ul id="titlenav">
   <li><h2><a href="javascript:void()">Title</a></h2>
    <ul id="titlemenu">
       <li>1</li>
       <li>2</li>
       <li>3</li>
    </ul>
   </li>
</ul>

$('#titlenav h2').click(function() {
  $('#titlemenu').Toggle();
}); 
```

我的 siFr 替换配置和 css 非常简单，而且 sIFr 链接通常可以工作，只是 jquery 函数不行。我正在使用 ; - jquery-1.3.1 - sIFR 3 R 427

欢迎任何建议。我对这一切都很陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T16:16:36.353

您使用的是什么操作系统？我听说 sFIR 在 linux 系统上以 alpha 透明度正确运行存在问题；这可能是原因。

如果你仍然有这个问题，一个替代方法可能是[typeface.js](http://typeface.neocracy.org/)，它是所有的 js，没有 flash。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T19:53:14.227

嗯，我以前从未听说过这个 sIFR 的东西。不过，看起来很酷，也就是说，当我可以让它工作时。显然，我发现的大多数 sIFR 演示都无法在 Ubuntu Linux 上使用 FF3。最后，我找到了一个可行的，并且还提供 jQuery 集成：[http](http://dev.jquery.com/~gilles/sifr/) ://dev.jquery.com/~gilles/sifr/ ，你可能想看看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T09:28:12.460

问题是 Flash 上的点击事件不会传播到`h2`元素。查看[`onRelease`回调](http://wiki.novemberborn.net/sifr3/JavaScript+Methods)，您可以将其指定为`sIFR.replace`. 每当您单击替换的 Flash 电影时，它就会触发。

# asp.net - 加载和查询 Web 配置

> ID：626596
> 
> 赞同：1
> 
> 时间：2009-03-09T15:05:01.860
> 
> 标签：asp.net, winforms, configuration

是否有可能在 WinForms 应用程序中加载 web.config 文件并查询生成的配置，而不是使用 XML 来查找一些不符合语义的“添加”元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T15:27:27.720

您需要添加对 System.Web 的引用，然后会像这样：

```
using System.Web.Configuration
WebConfigurationManager webCfg = WebConfigurationManager.OpenWebconfiguration("/WebApp");

// Edit/Query the configuration
webConfig.AppSettings.Settings.Add("NewSetting","SomeValue");
webConfig.AppSettings.SectionInformation.ForceSave = true;

webConfig.Save(); 
```

如果您想访问没有像 system.diagnostics 这样的公共接口的配置部分，那么您可以使用通用配置类。添加对 System.Configuration 的引用并尝试以下操作：

```
ConfiguationSection sysDiagnostics = webConfig.GetSection("system.diagnostics");
ConfigurationElementCollection sources = sysDiagnostics.ElementInformation.Properties["sources"].Value as ConfigurationElementCollection;
foreach (ConfigurationElement source in sources)
{
    ConfigurationElementCollection listeners = source.ElementInformation.Properties["listeners"].Value as ConfigurationElementCollection;
     foreach (ConfigurationElement listener in listeners)
     {
        Console.WriteLine(listener.ElementInformation.Properties["name"].Value.ToString());
     }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T01:23:33.247

在尝试了上述所有建议（尽管速度很快）之后，尽管失败程度不同，但我使用了 XmlDocument 和 XPath，并使用两行代码和一个导入的命名空间完成了这项工作，而无需额外的程序集引用。

```
WebConfigurationManager.OpenWebConfiguration("/", "My Website", null) 
```

以上需要一个虚拟路径，这对 WinForms 应用程序意味着什么？我确实声明我需要*在 WinForms 应用程序*中打开一个 web.config '。

我改进了我的 XPath 一点。:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T15:24:28.663

您可以使用 System.Web.Configuration 命名空间中的[WebConfigurationManager.OpenWebConfiguration 方法](http://msdn.microsoft.com/en-us/ms151458(VS.80).aspx)。

例子：

```
System.Configuration.Configuration config =
        WebConfigurationManager.OpenWebConfiguration("/", "My Website", null) as System.Configuration.Configuration;

KeyValueConfigurationCollection appSettings = config.AppSettings.Settings; 
```

这将获取网站“我的网站”的 appsettings 块。只需修改第一个参数，即配置文件的虚拟路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T15:13:06.273

哼，你有没有试过：

```
Using System.Web.Configuration; 
```

或者

```
Using System.Configuration; 
```

有了它，您应该可以访问该`ConfigurationManager`对象，这将使您可以访问 web.config 文件。

# wpf - 是否有任何源代码在 WPF 中托管了 Active X 控件？

> ID：626600
> 
> 赞同：0
> 
> 时间：2009-03-09T15:06:57.457
> 
> 标签：wpf, activex, hosting

我正在寻找一些源代码和一个项目来下载并查看具有托管 WPF 的 Active X 控件。我在网上的任何地方都找不到任何源代码。

我无法在 Active X 控件中以通常的方式添加 WPF 资源。我必须手动将其添加到参考部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T15:18:06.620

不确定这是否可能。我会检查 WPF 浏览器应用程序。考虑到如果您要使用 WPF 运行活动 x 控件，这对您来说可能是一个更好的解决方案，用户将需要 1) Internet Explorer 和 2) 本地安装的 .net 3.0+。如果用户安装了 .net 3.0+，WPF 浏览器应用程序将与 IE 一起使用，如果用户安装了 .net 3.5+，则 WPF 浏览器应用程序将与 IE 和 FireFox 一起使用。在此处查看 WPF Broswer 应用程序：http: [//msdn.microsoft.com/en-us/library/aa970060.aspx](http://msdn.microsoft.com/en-us/library/aa970060.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T15:26:50.903

这应该是可能的，尽管我没有手头的代码。您可以在 ActiveX 控件中创建一个`HwndSource`允许普通窗口承载 WPF 控件的 . 然后只需将您的 WPF UI 添加到该窗口即可。

# visual-studio-2008-sp1 - 如何在 C 上安装具有 < 4 G 可用空间的 VS 2008 sp1：

> ID：626606
> 
> 赞同：1
> 
> 时间：2009-03-09T15:09:29.760
> 
> 标签：visual-studio-2008-sp1

我很震惊，这还没有被问到 - 但我无法安装 VS 2008 sp1，因为我的 c: (%SYSTEMDRIVE%) 有大约 1.6 G 的空闲空间......

我到底如何才能安装 sp1？

谢谢

更新：我安装了 C++ 位 - 我没有使用它们......一旦我删除了 C++ 位，安装程序就停止抱怨了。

还 - 仅供参考 - 我的 %tmp% 和 %temp% 已经指向不同的磁盘 - 但安装程序不够聪明，无法弄清楚我猜......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T15:14:08.377

我在其他安装中也遇到过类似的问题。重新设置`TMP`和/或`TEMP`到具有更多空间的分区似乎已经奏效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T15:14:12.247

根据 Visual Studio 2008 SP1 发行说明中的​​系统要求：“系统驱动器上有 3.8 GB 可用空间，安装 Visual Studio 的驱动器上有 600 MB 可用空间。注意：您可以使用磁盘清理实用程序删除临时文件。 " 可以帮助您的一种选择是关闭系统还原、重新启动、安装，然后重新打开系统还原。有风险，但如果您绝对绝望，它可能会允许安装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T15:12:10.253

您将需要更多的硬盘空间。VS 安装程序将进行大量下载、解压缩和复制。所以大部分 4gb 用于交换空间，不一定用于最终安装。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T15:19:20.627

也可以关闭Windows的交换空间。仅当您有足够的 RAM 时才这样做。交换空间可以在我的电脑/属性/高级/性能/高级/虚拟内存中找到。

如果您还希望在某个时候进行碎片整理，请在磁盘尽可能为空时进行碎片整理，否则碎片整理（可以提高性能）将无法正常工作，如果有的话。

之后不要忘记再次激活交换空间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-10T15:08:39.473

可悲的是，我不得不删除 c++ （请参阅我在问题中的更新）并且“修复”了它......

# sql - 如何创建表约束以防止两列中的重复值？

> ID：626609
> 
> 赞同：3
> 
> 时间：2009-03-09T15:10:20.523
> 
> 标签：sql, constraints, alter-table

我有下表：

```
CREATE TABLE [dbo].[EntityAttributeRelship](
    [IdNmb] [int] IDENTITY(1,1) NOT NULL,
    [EntityIdNmb] [int] NOT NULL,
    [AttributeIdNmb] [int] NOT NULL,
    [IsActive] [bit] NOT NULL CONSTRAINT [DF_EntityAttributeRelship_IsActive]  DEFAULT ((0)),
CONSTRAINT [PK_EntityAttributeRelship] PRIMARY KEY CLUSTERED 
([IdNmb] ASC) WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]) ON [PRIMARY] 
```

表中的部分数据如下所示：

```
IdNmb    EntityIdNmb    AttributeIdNmb  IsActive
1        22             7               0
2        22             8               0
3        22             9               0
4        22             10              1 
```

如果已经存在 IsActive = 1 的 EntityIdNmb 记录，我想添加一个约束以确保没有人添加或更新记录以使 IsActive = 1。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T15:24:14.110

如果您使用的是 SQLServer，则可以创建聚集索引视图。

```
CREATE VIEW dbo.VIEW_EntityAttributeRelship WITH SCHEMABINDING AS
SELECT EntityIdNmb 
FROM dbo.EntityAttributeRelship
WHERE IsActive = 1
GO

CREATE UNIQUE CLUSTERED INDEX UIX_VIEW_ENTITYATTRIBUTERELSHIP 
  ON dbo.VIEW_EntityAttributeRelship (EntityIdNmb) 
```

这可确保您的表中只有一个 IsActive = 1 的 EntityIdNmb。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T15:15:53.160

听起来您需要实现一个触发器（假设您的数据库产品支持它）。如果您只想要一个活动条目和一个非活动条目，则唯一索引将起作用。否则，您将需要编写某种自定义约束或触发器（可能是 2 - 一个用于插入，一个用于更新），以确保您没有 2 条具有相同 id 的记录同时处于活动状态。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T15:35:26.967

如果您使用的是 MSSQL（我认为这就是您的语法），请创建一个仅包含 IsActive = 1 行的视图，然后在视图中的 EntityIdNmb 上放置一个唯一索引。

在我最近使用较多的 PostgreSQL 中，您可以创建部分索引： [http ://www.postgresql.org/docs/8.3/interactive/indexes-partial.html](http://www.postgresql.org/docs/8.3/interactive/indexes-partial.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T17:32:20.727

编写触发器的事情是决定您是否要拒绝记录，将值更改为 0 而不是 1 或将旧记录更新为 0 并让这条记录保持为 1。如果要删除值为1的记录，是否需要将另一条记录更改为活动记录，如何选择哪条记录？一旦您可以定义您想要在触发器中执行的操作，我们就可以帮助您更好地设计流程。

我们执行后两个步骤以使任何地址成为我们数据库中的主要邮寄地址。我们的业务规则是只有一个地址可以是主地址，如果有任何地址，则必须将其中一个地址标记为主地址。这种触发器的关键是记住插入/更新/删除可以成批发生（即使这不是常态），并确保触发器以基于集合的方式工作。当我到达这里时，我们通过游标实现了多行处理，当我不得不在导入中更新 200,000 个地址时，这变得很糟糕。（请注意没有经验的人 - 永远不要在触发器中使用光标！）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T15:21:11.247

非活动记录将用于什么？它们是否未使用并且只是用于跟踪以前的活动记录？如果是这样，是否可以将数据拆分到多个表中？就像是...

EntityAttributeRelship(IDNmb, EntityIDNmb, AttributeIDNmb)

EntityAttributeRelshipHistory(IDNmb, EntityIDNmb, AttributeIDNmb)

如果它在 EntityAttributeRelship 表中，则它处于活动状态。如果它在历史记录表中，那么它在某个时候被激活并且已经被停用？

如果您确实需要一张表中的所有内容，我会接受 todd.run 的使用触发器的建议。

# .net - WPF 事件属性已更改？

> ID：626613
> 
> 赞同：2
> 
> 时间：2009-03-09T15:11:04.983
> 
> 标签：.net, wpf

当某些事情发生变化时，我必须实现什么接口才能创建 wpf 事件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T15:13:06.833

INotifyPropertyChanged。

它在[System.ComponentModel](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)

使用此接口时的一个小技巧，当您使用空委托实现它时，您不必在每次引发它时检查事件是否为空。

```
public event PropertyChangedEventHandler PropertyChanged = delegate { }; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T15:14:52.930

WPF 控件继承 DependencyObject 类。参见：[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.dependencyobject.aspx)

对于业务实体，您仍然可以实现 INotifyPropertyChanged。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T15:16:44.143

[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)。这是一个“[如何](http://msdn.microsoft.com/en-us/library/ms229614.aspx)”。

# python - python中的文件编辑

> ID：626617
> 
> 赞同：3
> 
> 时间：2009-03-09T15:12:30.330
> 
> 标签：python, svn

我写了一个小 Python 程序作为个人实用程序来帮助我进行一些重构。它类似于 unix replace，除了它支持正则表达式并对目录中的所有文件和（可选）所有子目录中的所有文件进行操作。

问题是我没有更换到位。我正在打开文件，将内容传递到内存中，然后覆盖文件，如下所示：

```
file = open('path/to/file','r')
in_string = file.read()
file.close()
# ...
#Processing logic
# ...
file = open('path/to/file','w')
file.write(out_string)
file.close() 
```

除了明显的性能/内存问题，这些问题是合法的，但对我的使用来说并不是什么大问题，这种方法还有另一个缺点。SVN 吓坏了。在修复 svn 在提交时抛出的校验和错误之后，我可以做一些复制和粘贴解决方法，但这会使实用程序毫无意义。

有一个更好的方法吗？我猜如果我在原地编辑文件，就不会有任何问题。我该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T15:21:22.960

我怀疑问题在于您实际上正在编辑错误的文件。当你只是修改你的跟踪文件时，Subversion 不应该引发任何关于校验和的错误——与你修改它们的*方式*无关。

也许您不小心编辑了`.svn`目录中的文件？在`.svn/text-base`中，Subversion 使用相同的名称和扩展名存储文件的副本，请`.svn-base`确保您没有编辑这些文件！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T15:22:11.557

“SVN 吓坏了”是什么意思？

无论如何，vi/emacs/etc 的工作方式如下：

```
f = open("/path/to/.file.tmp", "w")
f.write(out_string)
f.close()
os.rename("/path/to/.file.tmp", "/path/to/file") 
```

（好吧，那里实际上有一个“fsync”......但我不知道如何在 Python 中做到这一点）

它执行该副本的原因是为了确保，如果系统在写入新文件的中途死机，旧文件仍然存在......并且“重命名”操作被定义为原子操作，因此它可以工作（你得到 100% 的新文件）或不工作（你得到 100% 的旧文件）——你永远不会留下半个文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T18:03:39.810

也许该`fileinput`模块可以使您的代码更简单/更短：

这是一个例子：

```
import fileinput

for line in fileinput.input("test.txt", inplace=1):
    print "%d: %s" % (fileinput.filelineno(), line), 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T15:16:23.847

怎么破？您所描述的，如果它正在工作，*就是*“就地”编辑文件，至少与*vi(1)*一样多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T15:18:45.400

试试'file = open('path/to/file', 'w+')'。这意味着您正在更新现有文件，而不是编写新文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T18:05:26.500

我怀疑[费迪南德的回答](https://stackoverflow.com/questions/626617/file-editing-in-python/626666#626666)，即您正在递归到 .svn 目录，这解释了您为什么要搞乱 SVN，但请注意，您处理文件的方式还有另一个缺陷。

如果您的程序被终止，或者您的计算机在错误的位置崩溃（当您写出更改的内容时），您可能会丢失文件的原始内容和新内容。更稳健的方法是执行以下步骤：

1.  将文件读入内存，然后进行翻译
2.  将新内容写入“filename.new”，而不是原始文件名。
3.  删除原文件，将“filename.new”重命名为“filename”

这样，如果在错误的位置被杀，您就不会冒丢失数据的风险。请注意，[fileinput](http://docs.python.org/library/fileinput.html)模块将为您处理其中的大部分内容。可以给它一个文件序列来处理，如果你指定inplace=True，将把stdout重定向到适当的文件（保持备份）。然后，您可以像这样构建代码：

```
import os
import fileinput

def allfiles(dir, ignore_dirs=set(['.svn'])):
    """Generator yielding all writable filenames below dir.
    Ignores directories specified 
    """
    for basedir, dirs, files in os.walk(dir):
        if basedir in ignore_dirs:
            dirs[:]=[] # Don't recurse
            continue  # Skip this directory

        for filename in files:
            filename = os.path.join(basedir, filename)
            # Check the file is writable
            if os.access(filename, os.W_OK):
                yield filename

for line in fileinput.input(allfiles(PATH_TO_PROCESS), inplace=True):
    line = perform_some_substitution(line)
    print line.rstrip("\n") # Print adds a newline, but line already has one 
```

# sql-server - 将 xml 粉碎到 SQL Server 中的多个表时对数据进行分组

> ID：626622
> 
> 赞同：0
> 
> 时间：2009-03-09T15:13:31.560
> 
> 标签：sql-server, xml, grouping, shred

这是从这个问题开始的：
[Modify XML in SQL server to add a root node](https://stackoverflow.com/questions/624206/modify-xml-in-sql-server-to-add-a-root-node/)

除了在该问题中提出并已解决的问题之外，我还将现有表拆分为 2 个，其中第 2 个表是第一个表的子表，外键返回第一个表。

所以目前

```
table1(ID, col1, col2, col3....coln) 
```

正在变得

```
table1(ID, col1, col2, col3) 
```

和

```
table2(PK, FK_table1, col4, col5, ...coln) 
```

目前我还没有从现有表中删除任何东西，只是创建了第二个，我发现了**OUTPUT**构造，以便我可以同时插入两个表，包括将第一个表的 PK 作为 FK 放入第二个表在 1 插入 - 就像这样；

```
INSERT INTO table1 col1, col2,...etc...

OUTPUT inserted.ID, col1, col2, ....
INTO table2(FK_table1, col1, col2, .... )

Select  col.value('node1[1]', 'int') col1,
 col.value('node2[1]', 'varchar(50)') col2,
....etc......
FROM @xml.nodes('//Items/Item') doc(col) 
```

这一次成功插入两个表**但**依赖于我尚未从 table1 中删除列的事实，**AND* 导致表之间存在 1:1 关系，而我需要的是 table1 只有行对于不同的 col1, col2, col3 ， table2 包含更详细的信息

我想知道我是否以正确的方式进行？我将能够在 1 个查询中执行此操作，还是必须将其分解？我在想也许我可以先将xml切碎到table1中，然后再单独切碎到table2中，加入table1以获得插入的FK？以前有人做过这种事吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T19:18:32.690

是的，我做了类似的事情，并根据我需要做的其他工作使用了这两个建议

选项：

1.  将 XML 分解为一个表变量 SELECT DISTINCT 从该变量到 table1，SELECT 到 table2

2.  将 XML 切碎两次。

我倾向于一次性完成昂贵的操作（粉碎 XML）。

# visual-studio - 如何重定位 Visual Studio 项目 (.sln) 文件

> ID：626631
> 
> 赞同：52
> 
> 时间：2009-03-09T15:14:45.317
> 
> 标签：visual-studio, relative-path

我想将 Visual Studio 解决方案 (myProject.sln) 文件移动到一个文件夹中。

这样做的问题是项目中的所有相对路径都会中断，如何在不手动更新项目内所有相对路径的情况下重新定位项目？

谢谢。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-03-09T15:18:23.297

只需单击解决方案资源管理器中的解决方案，然后单击文件菜单中的“将 myProject.sln 保存为...”。这会将您的 .sln 保存在您选择的文件夹中，而不会破坏参考。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T15:18:23.827

在记事本或类似文件中打开 .sln 文件，在顶部附近它具有相对基本路径 - 修改它以满足您的需要。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-28T10:11:51.263

要完成 jrummell 解决方案：使用 nodepadd 编辑 *.sln 文件后，您当然必须删除包含已弃用缓存的 *.suo 文件。

请注意，*.suo 文件是 Windows 7 中的隐藏文件（因此默认情况下，您在资源管理器中看不到它）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-08-09T18:23:36.290

使用源代码控制，这有点棘手。我只需要将我的解决方案 .sln 文件上移一层，以便在维护源代码控制历史记录的同时轻松访问。我遵循了之前帖子的建议，但遇到了 TFS 想要使用该解决方案移动我的所有项目的情况。我结合使用以下步骤完成了这项任务：

1.  确保解决方案未打开。
2.  从本地驱动器取消映射解决方案。
3.  在源代码管理资源管理器中右键单击解决方案 (.sln)，然后选择上述移动。设置新文件夹的路径，然后选择确定。
4.  检查该更改。
5.  签`.sln`出解决方案，然后在记事本中编辑解决方案。您将看到为项目分配了 guid，并且有项目的文件路径。您需要更改与新解决方案文件`.sln`所在位置相关的所有这些路径。确保对唯一名称和路径使用双斜杠：

`GlobalSection(TeamFoundationVersionControl) = preSolution`

`SccProjectUniqueName1 = MyNewFolder\\MyProject.Common\\MyProject.Common.csproj`

`SccProjectTopLevelParentUniqueName1 = MySolution.sln`

```
SccProjectName1 = MyNewfolder/MyProject.Common 
SccLocalPath1 = MyNewFolder\\MyProject.Common 
```

签入并将解决方案重新映射到本地驱动器。这对我有用。希望能帮助到你！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T15:19:00.487

您可以在文本编辑器中更新每个项目的相对路径。

# java - Itext 在 PDF 中嵌入字体

> ID：626632
> 
> 赞同：12
> 
> 时间：2009-03-09T15:14:51.510
> 
> 标签：java, pdf, fonts, itext, foxit

我有一个使用 Foxit 表单设计器创建的 pdf。在我的设计系统上，我安装了条形码字体。条形码字体用于 AcroField 之一。foxit 似乎没有在文档中嵌入字体。

我也有客户没有在他们的计算机中安装条形码字体，因此我想将字体嵌入到 PDF 中。有没有办法让我使用 iText 将 AcroFields 中使用的字体嵌入到 PDF 中？

**编辑：**字体似乎包含在文本中，但不包含在字段中，因此字体（条形码）不会打印。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-11-17T08:31:18.427

我几乎可以肯定您现在已经得到了答案，但也许其他人想详细了解解决方案。下面是我用来在生成的 PDF 中嵌入字体的示例 java 代码（仅在某些情况下有用，因为文档的大小会急剧增加）。作为创建 PDF 表单的免费工具，我使用了 OpenOffice 编写器，通过在文档中添加表单并将文档导出为 PDF 文件：

```
PdfReader pdfTemplate = new PdfReader(templateName);
ByteArrayOutputStream out = new ByteArrayOutputStream();
BaseFont unicode = BaseFont.createFont(unicodeFontPath, BaseFont.IDENTITY_H, BaseFont.EMBEDDED);
PdfStamper stamper = new PdfStamper(pdfTemplate, out);
//assigning the font to the field
stamper.getAcroFields().setFieldProperty("myField", "textfont", unicode, null);
stamper.getAcroFields().setField("myField", someValue);
stamper.close();
pdfTemplate.close(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-18T03:03:24.293

```
PdfContentByte ab = yourPDFWriter.getDirectContent();
// field: PdfFormField.createTextField(...);
PdfAppearance ap = ab.createAppearance(320, 30); // size of field
field.setDefaultAppearanceString(ap); 
```

这应该够了吧。

# iphone - 搜索 NSMutableArray 的问题

> ID：626635
> 
> 赞同：0
> 
> 时间：2009-03-09T15:15:23.710
> 
> 标签：iphone, arrays, search, mutable

基本上，我有一个 UISearchBar 搜索组成 RSS 提要的故事的 NSMutableArray，当您选择一个故事时，它会加载到我的应用程序的 UIWebView 中。这很难解释，但我有一个条目 1、2、3 和 4 的列表，您搜索“4”。4 将是现在过滤的数据列表中的第一个条目，对吗？你会认为通过选择 4，它会加载到 UIWebView 中。好吧，该应用程序似乎无法识别您正在选择*过滤*数据列表中的第一个条目，而是认为您正在选择*未*过滤数据数组中的第一个条目，因此它加载条目 1。一切看起来就在我的代码中，但显然不是。

我知道这是一个令人困惑的问题，但我希望我说得清楚一些。无论如何，这里是相关的来源，这样你就可以明白我的意思：

Search.h： [http ://www.scribd.com/doc/13107802/Searchh](http://www.scribd.com/doc/13107802/Searchh)

Search.m： [http ://www.scribd.com/doc/13107812/Searchm](http://www.scribd.com/doc/13107812/Searchm)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T16:02:24.050

这篇文章提供了一个很好的关于如何在 nsmutablearray 上搜索的教程！

[使用 UISearchBar 在 Keypress 上过滤 TableView](http://blog.atrexis.com/index.cfm/2008/5/16/Using-the-UISearchBar-to-filter-a-TableView-on-Keypress)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-21T00:48:47.133

要真正回答这个问题，还需要一些进一步的细节。例如，`searchBar: textDidChange:`函数内部过滤列表的 NSLog 是否返回预期数据？

如果是这样，我会假设问题不在于您的搜索功能，而在于`cellForRowAtIndexPath:`您的 TableView 的数据源的方法。看起来您已经正确实现了该`numberOfRowsForTableView`方法，因为返回了正确数量的结果，但`cellForRowAtIndexPath:`必须区分要从中提取的数据列表。

# ms-access - 在 MS Access 应用程序中访问原始代码

> ID：626642
> 
> 赞同：2
> 
> 时间：2009-03-09T15:17:00.227
> 
> 标签：ms-access, com

我一直在尝试查找有关在 MS Access 中访问原始代码的一些信息（我使用 v2007，但可能应该适用于所有版本）。

例如，我想列出应用程序中每个代码隐藏表单和模块中的所有函数并列出它们的参数。

您将如何实现这一目标？

注意：我当然假设应用程序没有被编译。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T17:24:24.443

您可以将所有代码输出为文本并通过另一个程序运行或将其加载到数据库中，或者您可以编写代码以使用 VBE 访问代码。

```
 Sub AllCodeToDesktop()
   'The reference for the FileSystemObject Object is Windows Script Host Object Model
   'but it not necessary to add the reference for this procedure.

   Dim fs As Object
   Dim f As Object
   Dim strMod As String
   Dim mdl As Object
   Dim i As Integer

   Set fs = CreateObject("Scripting.FileSystemObject")

   'Set up the file.
   Set f = fs.CreateTextFile(SpFolder(Desktop) & "\" _
       & Replace(CurrentProject.Name, ".", "") & ".txt")

   'For each component in the project ...
   For Each mdl In VBE.ActiveVBProject.VBComponents
       'using the count of lines ...
       i = VBE.ActiveVBProject.VBComponents(mdl.Name).CodeModule.CountOfLines
       'put the code in a string ...
       If VBE.ActiveVBProject.VBComponents(mdl.Name).codemodule.CountOfLines > 0 Then
          strMod = VBE.ActiveVBProject.VBComponents(mdl.Name).codemodule.Lines(1, i)
       End If
       'and then write it to a file, first marking the start with
       'some equal signs and the component name.
       f.writeline String(15, "=") & vbCrLf & mdl.Name _
           & vbCrLf & String(15, "=") & vbCrLf & strMod
   Next

   'Close eveything
   f.Close
   Set fs = Nothing
End Sub 
```

来自：[http ://wiki.lessthandot.com/index.php/Code_and_Code_Windows](http://wiki.lessthandot.com/index.php/Code_and_Code_Windows)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-16T04:08:41.750

是否可以从另一个程序调用 VBE 对象？很抱歉从死里复活，我在[这里有新的讨论](https://stackoverflow.com/questions/1430870/get-all-source-code-in-mdb-file-msaccess-using-c-vbscript)

# xml - VB.Net 傻瓜网络服务

> ID：626643
> 
> 赞同：0
> 
> 时间：2009-03-09T15:17:07.683
> 
> 标签：xml, vb.net, web-services

（编辑添加一个例子，希望让它更清楚一点）

我主要是一名 VB6 开发人员，但目前我正在尝试使用 VB.Net 编写一个 Web 服务，以允许我们的产品与第三方之间进行通信。第三方软件会调用我们的网络服务来更新各种数据。

我已经阅读了有关如何执行此操作的各种内容，并成功生成了原型 Web 服务。我现在关心的是如何正确地做到这一点。我们的客户希望我们为我们的 Web 服务提供 WSDL 和 XSD，这样他们就可以最终实现它，所以我想确保我做对了。因此，我有以下假设/问题：

Web 服务将接收应更新的各种字段。为了保持这种灵活性，我认为这可以是单个 XML 参数。我猜这就是我们的客户想要 XSD 的原因。这个假设正确吗？传递 XML 输入参数是一种好习惯吗？

我创建了一个简单的类，其中包含应更新的字段示例（标题、地址 1、地址 2 等），然后使用 XSD.Exe 生成了一个 XSD。这让我想到——我的输入参数应该是这个类的一个实例，而不是一个基于 XSD 的 XML 文档吗？

例如，要更新的字段与客户数据相关。有许多可能的字段可以更新，但一次可能只更新几个。显然，我不希望每个可能的字段都有 40 个参数的方法，而且我还被要求只提供一个方法。因此，我的想法是有一个参数来命名要更新的字段及其值。对这个参数使用 XML 似乎是明智的。我对客户对 XSD 的请求做出了假设，以便我们可以确保 XML 参数只包含有效字段。但同时，我使用 Visual Studio 基于我创建的示例类生成了一个 XSD。但现在我不确定哪个最好使用，即：

a) XML：cliData As Xml.XmlDocument：出现在 WSDL 中，但我将如何生成 XSD 以确保 XML 有效？手动？

b) 类：cliData 作为 ClientData：在 WSDL 中序列化，因此每个字段都显示为单独的元素。大概不需要 XSD，但我不认为这让我可以选择只包含几个字段，这不等于拥有大量参数吗？

c）字符串：cliData As String：传入某种字符串，手动解开它，但没有验证。

我最初计划返回 Web 服务的状态（例如“OK”或一些失败消息），尽管我在其他地方看到过对 SOAP Faults 的引用。有一些链接指向 MSDN 文章讨论这个问题，但链接似乎被破坏了！有人对此有什么建议吗？

如果在其他地方问过这些问题，我深表歉意 - 我浏览了这个网站，以及整个互联网，但信息已经变得如此超载，以至于我得到的问题多于答案！

谢谢，奥利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T15:23:19.040

听起来你真的让你的生活比你必须做的更复杂。ASP.NET 将为您处理 Web 服务的所有脏活。老实说，我不确定 XSD 的用途。我只想在您的 Web 服务上创建一个方法，该方法将字符串作为参数或使用自定义类。ASP.NET Web 服务或 WCF 服务将为您处理序列化。查看 msdn 站点以开始使用此功能。[http://msdn.microsoft.com/en-us/library/ms972326.aspx](http://msdn.microsoft.com/en-us/library/ms972326.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T15:25:48.160

我使用了接受 XML 字符串作为输入的服务，发现它比一组带参数的方法调用更麻烦。如果您在服务中收到 XML 字符串，则必须将其解析出来以获取值。我发现只编写一个或多个带有所需参数的方法更容易。

我假设您的客户不会使用 .NET 来调用您的网络服务。如果他们愿意，您可以使用 wsdl.exe 为他们生成代理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T22:54:34.197

过于灵活是错误的。服务应该做服务应该做的事情。如果以后需求发生变化，则向服务添加新操作，或者更好的是，添加新版本的服务 - 这样做既便宜又容易。

此外，如果您刚刚开始，那么从过去开始是没有意义的。直接转到 WCF，不要关注 ASMX Web 服务，这是下一个最好的过时服务 - 对它们的增强很少（如果有的话），也许只有关键的安全修复。

此外，基本的 WCF 更简单。此外，在很大程度上，您为简单案例编写的代码也可以在以后可能出现的更复杂的案例中使用，只需很少或没有更改。

# c# - 让 Lucene 在术语中包含空格以实现精确匹配

> ID：626645
> 
> 赞同：7
> 
> 时间：2009-03-09T15:18:09.817
> 
> 标签：c#, lucene.net

我希望我的 Lucene 查询包含类似于以下内容的内容：

> 公司名称：梅赛德斯卡车

它将与 companyName 字段中的字符串“mercedes trucks”进行完全匹配。
companyName 是一个未标记的字段，但任何带有空格的内容都会返回空结果。

```
new TermQuery(new Term("companyName", "mercedes trucks")); 
```

如果涉及空格，则始终产生 0 个结果。否则我的程序运行良好。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-05-31T18:40:06.380

也许更换：

```
mercedes trucks 
```

和

```
mercedes?trucks 
```

为我工作。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-02-16T20:13:25.553

像这样使用 PhraseQuery：

```
//create the query objects
BooleanQuery query = new BooleanQuery();
PhraseQuery q2 = new PhraseQuery();
//grab the search terms from the query string
string[] str = Sitecore.Context.Request.QueryString[BRAND_TERM].Split(' ');
//build the query
foreach(string word in str)
{
  //brand is the field I'm searching in
  q2.Add(new Term("brand", word.ToLower()));
}

//finally, add it to the BooleanQuery object
query.Add(q2, BooleanClause.Occur.MUST);

//Don't forget to run the query
Hits hits = searcher.Search(query); 
```

希望这可以帮助！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-11T10:14:15.240

您在搜索时使用的分析器可能与创建索引时使用的分析器不同。

在搜索时尝试使用 KeywordAnalyzer。它将创建搜索字符串的单个标记，这可能是您正在寻找的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T12:47:55.817

您是否考虑过使用[PhraseQuery](http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/search/PhraseQuery.html)？该字段是否必须取消标记？我相信 unkenized 是用于 ids 等，而不是用于具有多个单词作为内容的字段。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T15:57:33.467

I'm guessing here - does `exactMask` add quotes around the string? You should simply use the string "mercedes truck", without manipulating it.

```
new TermQuery(new Term("companyName", "mercedes trucks")); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-10-26T22:38:19.293

我发现可行的最佳方法是使用关键字分析器和以下查询“mercedes?trucks”来解析查询。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-08-05T09:42:26.963

Even I am facing the same issue. You have to do the following thing to get rid of from this issue. 1)When add the field value to the document remove the spaces in between. 2)Make the field value in lowercase. 3)Make the search text in lowercase. 4)Remove the white spaces in the search text. Regards ~shef

# java - 当命名空间在操作标签内定义时，如何处理 SOAP 消息的 Castor 解组？

> ID：626648
> 
> 赞同：2
> 
> 时间：2009-03-09T15:18:43.250
> 
> 标签：java, web-services, spring-ws, castor, unmarshalling

我正在开发基于 Spring-WS 的合同优先 Web 服务。我依赖于 Castor 编组，我遇到了以下问题。

当在 Envelope 标记中定义“xmlns”命名空间时，请求被接受，例如：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"
                      xmlns="http://www.mycompany.com/MyService/schemas">
  <soap:Header/>
  <soap:Body>
    <doPlaceHoldRequest>
      <hold>
        <accountInfo>
          <accountNumber>123456789</accountNumber>
        </accountInfo>
        <extended>false</extended>
        <afterHours>false</afterHours>
        <amountSavings>1.00</amountSavings>
        <amountChecking>0.00</amountChecking>
      </hold>
    </doPlaceHoldRequest>
  </soap:Body>
</soap:Envelope> 
```

但是，从 Spring-WS 提供的 .wsdl（从 XSD 生成）生成的 .NET 和 Java 客户端都以下列方式形成它们的请求：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Header/>
  <soap:Body>
    <doPlaceHoldRequest 
                xmlns="http://www.mycompany.com/MyService/schemas">
      <hold>
        <accountInfo>
          <accountNumber>123456789</accountNumber>
        </accountInfo>
        <extended>false</extended>
        <afterHours>false</afterHours>
        <amountSavings>1.00</amountSavings>
        <amountChecking>0.00</amountChecking>
      </hold>
    </doPlaceHoldRequest>
  </soap:Body>
</soap:Envelope> 
```

这会导致 Castor 抛出 Unmarshalling Exception。如何让 Castor 将这些消息识别为有效？我的 WSDL（或我用来自动生成它的 XSD）可能是错误的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-02-16T00:56:52.520

我在使用我的第一个 Spring-WS/Castor Web 服务时一遍又一遍地遇到了这个问题。据我所知，某些组件以非命名空间感知的方式提取有效负载。换句话说，像 doPlaceHoldRequest 这样的节点在不继承顶级命名空间声明的情况下成为 XML 文档的根，在上述两种情况下，导致一个*在*您想要的命名空间中，一个不在您想要的命名空间中 - 所以一个可以针对您的架构进行很好的验证，而另一个则不能。

最好的解决方案似乎是覆盖所有基础。使您的 XSD 具有 elementFormDefault="qualified"，以要求您的所有元素都位于命名空间中。然后在 Castor 映射中的每个 map-to 元素中指定一个 ns-uri 和一个 ns-prefix。结果有点重，包含所有的命名空间前缀，但是当涉及到惰性客户端*和*服务器组件中的未记录行为时，它似乎变得不那么脆弱了。

[JAX-WS 返回空列表](https://stackoverflow.com/questions/3601113/jax-ws-return-empty-lists/3602475#3602475)也是一个很好的观点。`org.springframework.ws.soap.server.endpoint.interceptor.PayloadValidatingInterceptor`值得验证进出的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-14T05:10:14.793

如果你看到这个博客我认为永远不会去其他网络服务:) [http://springkbase.blogspot.com/2009/06/spring-webservice-with-castor.html](http://springkbase.blogspot.com/2009/06/spring-webservice-with-castor.html)

# iphone - UIView - 绘制图像 - 基于图块的游戏

> ID：626657
> 
> 赞同：1
> 
> 时间：2009-03-09T15:20:18.440
> 
> 标签：iphone, objective-c, image

我正在尝试创建一个简单的益智游戏。我有一个表示地图的 int[8][8] 数组。每个单元格都有一个代表某个项目的值。

现在我想在屏幕上绘制这张地图，每个项目都有一个图像文件。（每个项目具有相同的宽度和高度）

我试图通过为每个单元格创建一个 UIImageView 并将其添加到视图中来做到这一点。

但是，如果谜题发生变化（每次移动后都会发生变化......非常频繁），我该怎么办？删除所有 UIImageViews 并创建新的..？

我用 int[][] 地图做所有的逻辑..

你建议我画什么地图？

谢谢你，克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T19:14:53.947

通常，所有 UIView 属性都可以更改，并且视图层次结构将重绘以反映更改。正如 Eric 所说，您可以简单地更改 UIViews 的图像属性，绘制的图像就会改变。

这同样适用于框架（或中心和边界）和所有其他属性。

我建议在你让你的代码像这样工作之后，你看看 CoreAnimation 可以帮助你平滑你将要生成的过渡。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T15:23:01.803

只需使用新图像更改现有 UIImageView 上的“图像”属性，您就应该一切就绪。

# asp.net - 在 asp.net ajax 工具包中组合脚本

> ID：626659
> 
> 赞同：6
> 
> 时间：2009-03-09T15:20:29.360
> 
> 标签：asp.net, ajax, ajaxcontroltoolkit

我们正在使用 3.0.20229.0 版的 asp.net ajaxControlTookKit（在 .net 3.5 sp1 之前）。我想知道是否可以将我们的自定义 javascript 文件合并到 controlTookKit 创建的 ScriptResource.axd 中。我找到了这篇文章（[http://blogs.msdn.com/delay/archive/2007/06/11/script-combining-made-easy-overview-of-the-ajax-control-toolkit-s-toolkitscriptmanager .aspx](http://blogs.msdn.com/delay/archive/2007/06/11/script-combining-made-easy-overview-of-the-ajax-control-toolkit-s-toolkitscriptmanager.aspx)）告诉我需要将 scriptCombine 属性添加到程序集文件中。我们正在运行一个网站项目，我该如何添加这个属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T15:30:38.430

您需要将脚本作为资源添加到单独的库中，并从那里引用它们以利用脚本组合器。

**编辑以提供演练**

创建一个新的类库项目（例如称为“CombinedScipts”），删除默认类。

添加对**AjaxControlToolkit**和**System.Web的引用**

将您的 JS 文件添加到项目中，并将它们的 Build Action 属性更改为“Embedded Resource”。

打开 AssemblyInfo.cs 文件

添加以下内容：

```
// You need to add a web resource call for each JS file in the project
[assembly: WebResource("CombinedScripts.Console.js", "text/javascript")]
[assembly: WebResource("CombinedScripts.Utilities.js", "text/javascript")]
// Not setting IncludeScripts or ExcludeScripts marks all scripts as
// combinable.
[assembly: AjaxControlToolkit.ScriptCombine()] 
```

将此库作为参考添加到您的网站项目中。

在您的项目中，您可以在 ToolkitScriptManager 标记之间添加以下内容：

```
<Scripts>
  <asp:ScriptReference name="CombinedScripts.Console.js" 
                       assembly="CombinedScripts" />
  <asp:ScriptReference name="CombinedScripts.Utilities.js"
                       assembly="CombinedScripts" />
</Scripts> 
```

不要忘记确保 ToolkitScriptManager 的 CombineScripts 属性设置为 true。

然后，这会导致对以下内容的调用：/pageName.aspx?_TSM_HiddenField_=ToolkitScriptManager1_HiddenField&[...]

这将包含您的组合脚本，并带有注释分隔符，例如：

```
//START CombinedScripts.Console.js
[...]
//END CombinedScripts.Console.js
//START CombinedScripts.Utilities.js
[...]
//END CombinedScripts.Utilities.js 
```

# c# - 处理在辅助线程进程中发生的未处理错误

> ID：626665
> 
> 赞同：0
> 
> 时间：2009-03-09T15:21:13.883
> 
> 标签：c#, asp.net, multithreading, error-handling, response.redirect

我有一个 asp.net 2.0 web 应用程序，它调用一个长时间运行的存储过程（大约 3 分钟）。sp 实际上在后端执行许多任务。

我的页面使用线程和 ajax（更新面板）和计时器控件向用户显示进度条。这一切都很好，除非在 sp 中有一个错误，它只是冻结了屏幕。

我尝试使用在 codeProject 上找到的 SafeThread 类，[该类](http://www.codeproject.com/KB/threads/SafeThread.aspx)包装了线程进程并创建了一个可以在发生异常时处理的事件。

在事件处理程序中，我只想将用户重定向到错误页面并显示错误。测试时我可以中断事件处理程序。然而，调用 Server.Transfer 或 Response.Redirect 完全没有效果。

我不确定为什么会这样。我将在下面发布我的代码。任何想法或替代建议表示赞赏。

```
 protected void btnSave_OnClick(object sender, EventArgs e)
    {
        DAC dac = new DAC();
        Session["RerunStatus"] = 0;
        SafeThread thrd = new SafeThread(new ParameterizedThreadStart(dac.RerunTest));
        thrd.IsBackground = true;

        //tell the SafeThread to report 
        //ThreadAbort exceptions
        thrd.ShouldReportThreadAbort = true;
        //attach a ThreadException handler for 
        //reporting SafeThread exceptions
        thrd.ThreadException += new
        ThreadThrewExceptionHandler(thrd_ThreadException);

        thrd.Start(ddlRundate.SelectedItem.Text);
        Session["RerunThread"] = thrd;
        btnSave.Enabled = false;
        Timer1.Enabled = true;
    }

    void thrd_ThreadException(SafeThread thrd, Exception ex)
    {
        //thrd.Abort();
        Timer1.Enabled = false;
        //Response.Redirect("ErrorPage.aspx");
        Server.Transfer("ErrorPage.aspx?ErrorMsg=" + ex.Message);
        //thrd.Abort();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T15:35:30.667

您只能在处理请求时使用 Server.Transfer()/Response.Redirect() - 调用 thrd_ThreadException() 时并非如此。

尝试在 thrd_ThreadException 中设置一个标志并在 Timer1 Tick 事件中进行重定向。

# model-view-controller - 客户端对象速度

> ID：626668
> 
> 赞同：0
> 
> 时间：2009-03-09T15:22:32.880
> 
> 标签：model-view-controller, spring, spring-mvc, velocity

我想创建一个对象客户端并将其添加到另一个对象。

我正在使用速度和弹簧。

我形成一个命令对象并将其作为支持对象传递给视图。

我想创建一个新对象并将其添加到这个命令对象，而不将任何一个对象保存到数据库中。

这样做的原因是，如果保存期间出现错误，我希望有一些持久性。我希望命令以提交时的相同状态返回给用户。

感谢您的回答。更具体地说，我需要将许多字段绑定到一个对象的对象。

例如，如果我想创建一个新联系人并将其添加到客户帐户中。所以联系是由许多字符串组成的。所以我需要将字符串绑定到联系人，然后将联系人绑定到客户账户上的联系人集合。

我想在扩展的 div 中执行此操作，这样用户就不必离开页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T15:57:19.317

Support for this is built into the Spring Web MVC framework.

You need to implement a Validator for your command object and set this as the validator for your form controller. See [Chapter 5](http://static.springframework.org/spring/docs/2.5.x/reference/validation.html) of the Spring reference for more details regarding validators.

Using the [Spring velocity macros](http://static.springframework.org/spring/docs/2.5.x/reference/view.html#view-velocity-forms) you bind your command object to the HTML form. The #springShowErrors macro is used to handle showing validiation errors.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T15:30:27.590

查看 Spring 验证框架。它会处理你想做的事情。

# java - 没有函数指针，在Java中实现回调的推荐方法是什么——除了接口？

> ID：626669
> 
> 赞同：0
> 
> 时间：2009-03-09T15:22:46.203
> 
> 标签：java, design-patterns, callback

我有几个类想要相互传递一些信息并在以后使用该信息（回调模式）被回调。

在我的应用程序中，这种机制有两个目的：

*   计划/延迟执行
*   涉及消息传递的异步执行

我的对象基本上互相说*“当你完成 X 后，给我回电话并告诉我用 Z 做 Y（因为到那时我会忘记它）”*。X 可能只是在等待正确的时间，但也与远程服务通信或调用本地函数。

现在，如果 Java 中有函数指针（或等价物），我会实现一些“作业”类，其中包含一个加它需要的参数。例如，在 PHP 中，这个结构必须存储一个类名、一个函数名和一个参数数组。在 C 中，它是一个指向函数的指针，我必须为所有调用设置相同的参数编号和类型。

在 Java 中，通常的方法是拥有一个由所有想要回调的类实现的接口，如下所示：

```
public interface ICallable {
    public void call_me(Object data);
} 
```

现在这对我不起作用，因为

*   要回调的对象可能有一组不同的方法来进行调用
*   呼叫者不是决定应该拨打什么电话的人

也许我的问题是我试图为各种回调建立一个通用的数据结构和调用过程，但原则上，这对我来说似乎很有意义。

在 Java 中处理这种情况的好的设计模式是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T15:31:59.707

我想你会发现接口是最好的解决方案。我不明白你对他们的反对。如果接收者需要调用不同的方法，则让接口方法调用不同的方法。

如果您的接收器类需要有多个处理程序，您可以使用实现接口的匿名内部类，一个用于您需要的每种类型的处理程序。例如，如果发送方使用名为“ListenerInterface”的接口，您的接收方可能会定义一个匿名内部类来实现 ListenerInterface 并调用接收方方法“handlerFunction”。

```
 sender.addListener(new ListenerInterface()
   {
      public void callback(Object arg)
      {
         handlerFunction(arg);
      }
   }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T15:41:42.990

您可能正在使用类似于[匿名内部类的概念](http://www.exciton.cs.rice.edu/javaresources/Java/innerclasses.htm)

[这里的](http://www.developer.com/java/other/article.php/3300881)另一个参考

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T15:38:24.107

正如您所描述的，我将使用一个接口，然后为您的回调使用一个匿名类。例如，从您的调用者内部：

```
ICallback callback = new ICallback() { 
    public void call_me(Object data) { this.actionToCall(data); }
}
serverObject.doX(callback); 
```

（语法可能与此略有不同。）

这样，您可以在原始调用者（在调用点）中指定完成后要采取的操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T17:00:50.880

如果您真的不想使用接口（相信我，您会这样做！），您可以使用反射来获取您想要调用的方法，然后将其传递给需要调用的方法。这与您将要获得的 C 函数指针一样接近。

反射将（可能）比执行它的接口方式慢（但这并不重要，除非它被频繁调用）。

反射不会像接口方式那样进行编译时类型检查（这意味着您可能会在运行时崩溃）。

反射也将是比接口方式更丑陋的代码。

但是，如果您真的真的很想模拟 C 函数指针，那么反射就像您将要获得的一样接近。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T15:41:18.170

回调是一个普遍的想法，您不应该尝试一刀切的接口。使您的回调接口特定于使用。它应该与传递给它并进行回调的类型的语义相匹配。回调接口的通常实现将作为匿名内部类完成。抵制在外部类中实现接口的诱惑，从而导致类型不连贯。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T15:30:55.823

我可能误解了这个问题，但在我看来，你会从设置某种事件系统中受益。

基本上，您设置了一个事件处理程序，并且想要了解该事件的类订阅该事件处理程序。因此，对于您的问题，当 X 完成时，它将触发您的对象将订阅的 FinishedProcessingEvent()。当您的对象收到此事件（以及关心该事件的任何其他订阅者）时，它将执行正确的操作（Y 与 Z）。这些动作是在对象中定义的，因此不同的对象可以基于相同的事件做不同的事情。

这有帮助吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T15:32:06.197

我确信有一些有趣的模式可以解决您的问题，但我会选择使用基础设施的简单方法。将请求和响应填充到消息队列（如 JMS）中，您的系统可能会更简单、更健壮，因为您可以处理耗时数秒或数周的事件，而无需担心系统重启、持久性和消息完整性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-09T15:34:03.477

我没有过多研究它，但 Java 5+ [Future](http://java.sun.com/javase/6/docs/api/java/util/concurrent/Future.html)接口（或其子接口）可能对此有用。

# java - Java：如何在迭代/添加到列表时从列表中删除元素

> ID：626671
> 
> 赞同：17
> 
> 时间：2009-03-09T15:22:57.357
> 
> 标签：java, algorithm, collections, list

[这个问题是这个问题中描述（和解决）的问题](https://stackoverflow.com/questions/223918/java-efficient-equivalent-to-removing-while-iterating-a-collection)的一个更特例。

我有两种方法，stopAndRemove(ServerObject server) 和 close() 方法。后者应该关闭所有服务器并将它们从服务器列表中删除。该列表定义为

```
List<ServerObject> server. 
```

我不想在 closeCurrentlyOpen 中拥有与 stopAndRemove 几乎相同的代码，所以我想做类似的事情：

```
public void closeCurrentlyOpen() {
   for(ServerObject server : this.servers) {
       stopAndRemove(server)
   }
} 
```

这不起作用，因为这将导致 ConcurrentModificationException。我试图复制列表

```
List<ServerObject> copyList = new ArrayList<ServerObject>(this.servers); 
```

并将其用作 foreach 循环的列表。但是，当我迭代 copyList 但 closeCurrentlyOpen 应该会导致一个空列表时，其他线程可能会将服务器附加到服务器列表。由于 addServerToList 方法与服务器列表同步，因此执行此操作

```
public void closeCurrentlyOpen() {
   synchronized(this.servers) {
     for(ServerObject server : this.servers) {
        stopAndRemove(server)
     }
    }
} 
```

将通过修改解决问题。但是我无法同步 stopAndRemove 方法中的代码，如果直接调用它是必要的。

在我看来，这三种方法的设计可能需要修整。任何人的想法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-09T15:28:38.247

从 stopAndRemove() 中分离出一个方法 stop()。然后使用显式迭代器编写循环，执行停止，然后执行 iterator.remove()。

方法名称中的“和”是代码异味。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-09T17:33:47.777

也许这是错误的做法，但我总是创建一个删除集合，其中包含对需要删除的对象的索引或引用。然后我遍历该集合并从原始集合中删除这些索引/对象。可能不是最有效的，但它完成了工作。

代替

```
for(Collection things : thing)  
    things.remove(thing) 
```

我用

```
Collection toRemove = new LinkedList();
for(things : thing)
    toRemove.add(thing);

for(toRemove : thing)
    things.remove(thing) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T15:27:02.010

当我以前这样做时，我总是使用“老派”的 LinkedList 集合、一个 Iterator 和 Iterator.remove() 方法来删​​除当前项目。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T17:21:04.857

您可能会发现[这篇关于 ConcurrentModificationException](http://tech.puredanger.com/2009/02/02/java-concurrency-bugs-concurrentmodificationexception/)的文章在这方面有一些建议。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T15:28:03.913

将 stopAndRemove 中的所有 ServerObject 停止代码重构为私有 stopServer 方法，然后在 stopAndRemove 和 closeCurrentlyOpen 中分别进行删除。然后您可以使用 ListIterator 删除它们（或者只是在 for 循环中停止它们并在最后清除列表）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T15:28:44.783

您应该获得一个迭代器并使用它删除。您收到异常是因为迭代器在 java 中是[快速失败的。](http://java.sun.com/j2se/1.5.0/docs/api/java/util/ConcurrentModificationException.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-10T10:00:10.260

回答问题的标题，而不是给定示例的具体细节。事实上，这个解决方案甚至在给定的情况下都不合适（重构是合适的，正如其他人所建议的那样）。

然而，似乎许多 Java 程序员不知道[CopyOnWriteArrayList](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/CopyOnWriteArrayList.html)（自 1.5 以来是 JDK 的一部分），并试图推出他们自己的解决方案来解决相同的问题（迭代之前的复制列表）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-07-19T10:53:34.333

...从目录列表中删除不是 XML 的文件...

```
List<File> files = Arrays.asList(dir.listFiles());

Iterator<File> i = files.iterator();

while (i.hasNext()) {
    File file = i.next();
    if (!file.getName().endsWith(".xml")) {
        i.remove();
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-05-29T18:21:57.737

类似于 firebird84。但是你可以使用 removeAll(Collection c) api

```
for(String exitingPermission : existingPermissions){                
    //remove all permissions for the screen and add the new ones
    if(exitingPermission.split("_")[0].equals(screen)){
        removePermissions.add(exitingPermission);
    }
 }
existingPermissions.removeAll(removePermissions); 
```

# c - C语言中的WMI查询？

> ID：626674
> 
> 赞同：6
> 
> 时间：2009-03-09T15:24:06.153
> 
> 标签：c, wmi

是否可以在纯 C 中发出 WMI WQL 查询？如果是，如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T15:40:02.853

只要您可以调用[WMI 的 COM API，](http://msdn.microsoft.com/en-us/library/aa389276(VS.85).aspx)您就可以使用任何您想要的编程语言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T15:48:04.050

看起来你可以通过使用 ExecQuery() 来做这种事情，尽管这个例子是用 C++ 编写的。顺便说一句，这家伙无法让它工作，但你可以看看他在做什么。

希望这可以帮助。

[http://forums.devshed.com/c-programming-42/wmi-wql-querying-problem-in-c-215026.html](http://forums.devshed.com/c-programming-42/wmi-wql-querying-problem-in-c-215026.html)

更多 WMI 编程：

[http://www.vedivi.com/blog/2008/05/how-to-enable-remote-desktop-programmatically/](http://www.vedivi.com/blog/2008/05/how-to-enable-remote-desktop-programmatically/)

# .net - DataTable.Select vs DataTable.rows.Find vs foreach vs Find（谓词 )/拉姆达

> ID：626679
> 
> 赞同：19
> 
> 时间：2009-03-09T15:25:48.350
> 
> 标签：.net, optimization, lambda, anonymous-methods

我有一个缓存在内存中的数据表/集合，我想用它作为源来为自动完成文本框生成结果（当然使用 AJAX）。我正在评估各种快速获取数据的选项。数据表中集合/行中的项目数可能从 10000 到 2,000,000 不等。（所以我们不会被转移，暂时假设已经做出决定，我有足够的内存，我将使用缓存而不是数据库查询）

我对此处理有一些额外的业务逻辑；我必须根据`priority`集合中的列（int）对自动完成列表进行优先级排序。因此，如果我有人搜索`Micro`并且我得到 20 个以开头的单词/句子的结果，`Micro`那么我会选择具有最高优先级的前 10 个结果项目。（因此需要有一个与字符串值关联的优先级属性）。

集合项目已按字母顺序排序。

在这种情况下，最好的解决方案是什么。
1.[使用](http://www.liensberger.it/web/blog/?p=306)[DataTable.Select](https://stackoverflow.com/questions/365615) (
。2 .[使用](http://bytes.com/groups/net-c/648398-datatable-select-vs-datatable-rows-find-vs-foreach)
DataTable.Rows.Find [(](http://devpinoy.org/blogs/keithrull/archive/2007/03/26/find-items-inside-a-generic-list-using-the-old-approach-the-cool-approach-and-the-super-duper-cool-approach.aspx) _ _[性能](http://www.liensberger.it/web/blog/?p=306)与否[？](http://blogs.msdn.com/ericlippert/archive/2007/01/10/lambda-expressions-vs-anonymous-methods-part-one.aspx)）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-11T15:57:19.910

这些图表没有发布在我的博客条目上；更多详细信息，请访问[http://msdn.microsoft.com/en-us/library/dd364983.aspx](http://msdn.microsoft.com/en-us/library/dd364983.aspx)

我后来发现的另一件事是，对于大型数据集，使用链式通用字典的性能非常好。它还有助于缓解由聚合操作所需的排序操作引起的许多问题，例如 min 和 max（使用`DataTable.Compute`或`LINQ`）。

我所说的“链式通用字典”是指一种`Dictionary(Of String, Dictionary(Of String, Dictionary(Of Integer, List(Of DataRow))))`或类似的技术，其中每个字典的键都是一个搜索词。

当然，这并不是在所有情况下都有用，但我至少有一种情况，实施这种方法可以`500x`提高性能。

在您的情况下，我会考虑使用前 1-5 个字符的简单字典，然后是`List(Of String)`. 您必须建立这个字典一次，将单词添加到具有前 1-5 个字符的列表中，但之后您将能够获得极快的结果。

我通常将这样的东西包装在一个类中，这样我就可以轻松地做一些事情，比如添加单词。您可能还想使用`SortedList(Of String)`, 来自动对结果进行排序。这样，您可以快速查找与已键入的前 N ​​个字符匹配的单词列表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T15:33:21.577

在我的上`autocomplete`，我首先尝试了这种`linq/lambda`方法，性能有点慢。`DataTable.Select`比 快`linq`，所以我用这个。我还没有比较和之间的`datatable.Select`性能`datatable.Find`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T15:33:41.887

我们可以整天猜测它，但既然这不是一段庞大的代码，为什么不编写每个代码并相互进行基准测试呢？

```
public delegate void TestProcedure();

public TimeSpan Benchmark(TestProcedure tp)
{
    int testBatchSize = 5;
    List<TimeSpan> results = new List<TimeSpan>();
    for(int i = 0; i<testBatchSize; i++)
    {
        DateTime start = DateTime.Now;
        tp();
        results.Add(DateTime.Now - start);
    }
    return results.Min();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-09T20:54:36.500

根据以下博客

[http://blog.dotnetspeech.net/archive/2008/08/26/performance----datatable.select-vs-dictionary.aspx](http://blog.dotnetspeech.net/archive/2008/08/26/performance----datatable.select-vs-dictionary.aspx)

DataTable.Rows.Find 比 DataTable.Select 快得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T15:40:28.687

数据视图呢？您可以应用您的过滤条件并按优先级排序，并轻松地遍历结果以添加到您的结果中。

# sharepoint - 在哪里可以更改 Sharepoint 通知电子邮件的 HTML 模板？

> ID：626688
> 
> 赞同：2
> 
> 时间：2009-03-09T15:28:32.867
> 
> 标签：sharepoint

我想更改创建新博客条目时发送的 Sharepoint (Portal Server 2003) 电子邮件通知的外观。背后的原因：我们公司像新闻系统一样使用它们，如果我们可以在其中包含一些品牌信息（徽标等）和定制设计，那就太好了。

我正在学习共享点，所以我只需要一个正确方向的指针。但如果有人知道更多：是否所有通知都有一个模板？我必须在文件级别更改它吗？是否有某种抽象层或 API 我可以与之交谈？主题？

我检查了所有的管子，但什么也没找到。任何帮助将不胜感激。

塞巴斯蒂安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T17:20:14.407

我在 microsoft.public.sharepoint.portalserver 组上找到了答案 - 尚未尝试过，但在模板文件级别似乎可行：

[http://wssv3faq.mindsharp.com/Lists/v3%20WSS%20FAQ/DispForm.aspx?ID=125](http://wssv3faq.mindsharp.com/Lists/v3%20WSS%20FAQ/DispForm.aspx?ID=125)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T18:05:27.823

在 WSS3 中，您修改 c:\Program Files\Common Files\Microsoft Shared\web server extensions\12\TEMPLATE\1033\XML 文件夹中的 AlertTemplats.xml。只需查看 AlertTemplate 节点并找到要修改的列表类型的名称。我不确定这是否适用于 SharePoint 2003，但我认为可能。

# php - 从静态文本自动创建电子邮件链接

> ID：626692
> 
> 赞同：8
> 
> 时间：2009-03-09T15:29:28.387
> 
> 标签：php, email, url, hyperlink

我试图弄清楚如何使用php在页面中打印时自动链接数据库中简单文本中包含的电子邮件地址。

例如，现在我有：

```
Lorem ipsum dolor email@foo.com sit amet 
```

我想（即时）将其转换为：

```
Lorem ipsum dolor <a href="mailto:email@foo.com">email@foo.com</a> sit amet 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-09T15:41:36.190

您将需要使用正则表达式：

```
<?php

function emailize($text)
{
    $regex = '/(\S+@\S+\.\S+)/';
    $replace = '<a href="mailto:$1">$1</a>';

    return preg_replace($regex, $replace, $text);
}

echo emailize ("bla bla bla e@mail.com bla bla bla");

?> 
```

在下面的示例文本中使用上述函数：

```
blalajdudjd user@example.com djjdjd 
```

会变成如下：

```
blalalbla <a href="mailto:user@example.com">user@example.com</a> djjdjd 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-07-16T09:39:10.667

试试这个版本：

```
function automail($str){

    //Detect and create email
    $mail_pattern = "/([A-z0-9_-]+\@[A-z0-9_-]+\.)([A-z0-9\_\-\.]{1,}[A-z])/";

    $str = preg_replace($mail_pattern, '<a href="mailto:$1$2">$1$2</a>', $str);

    return $str;
} 
```

* * *

2015 年 10 月 31 日更新：修复电子邮件地址，例如`abc.def@xyz.com`

```
function detectEmail($str)
{
    //Detect and create email
    $mail_pattern = "/([A-z0-9\._-]+\@[A-z0-9_-]+\.)([A-z0-9\_\-\.]{1,}[A-z])/";
    $str = preg_replace($mail_pattern, '<a href="mailto:$1$2">$1$2</a>', $str);

    return $str;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-01T23:40:31.600

这是我组合的一些代码（来自此处的答案），用于为电子邮件和 URL 执行此操作的函数：

这样做的好处是，如果已经存在链接，它不会转换为链接。

```
function replace_links( $content ){
    $content = preg_replace('"<a[^>]+>.+?</a>(*SKIP)(*FAIL)|\b(?:https?)://\S+"', '<a href="$0">$0</a>', $content);
    $content = preg_replace('"<a[^>]+>.+?</a>(*SKIP)(*FAIL)|\b(\S+@\S+\.\S+)\S+"', '<a href="mailto:$0">$0</a>', $content);
    return $content;
} 
```

演示： [https ://glot.io/snippets/g6nwd6amyo](https://glot.io/snippets/g6nwd6amyo)

我还建议看看 WordPress 是如何处理这个问题的，因为你知道它已经过实战测试，并且在实际电子邮件之后处理诸如句点或其他字符之类的随机问题：

[https://github.com/WordPress/WordPress/blob/master/wp-includes/formatting.php#L2997-L3055](https://github.com/WordPress/WordPress/blob/master/wp-includes/formatting.php#L2997-L3055)

查看`make_clickable`特别`_make_email_clickable_cb`是回调行（由于其他正则表达式问题，这是我个人最终使用的）

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-09T15:35:41.757

我想这就是你想要的...

```
 //store db value into local variable
    $email = "foo@bar.com";
    echo "<a href='mailto:$email'>Email Me!</a>"; 
```

# python - 验证 Unicode 名称

> ID：626697
> 
> 赞同：3
> 
> 时间：2009-03-09T15:30:47.243
> 
> 标签：python, unicode, validation, character-properties

在 ASCII 中，验证名称并不太难：只要确保所有字符都按字母顺序排列即可。

但是在 Unicode (utf-8) 中呢？如何确保给定字符串中没有逗号或下划线（ASCII 范围之外）？

（最好在 Python 中）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T15:39:52.777

也许[unicodedata 模块](http://docs.python.org/library/unicodedata.html)对这项任务很有用。尤其是`category()`功能。对于现有的 unicode 类别，请查看[unicode.org](http://unicode.org/Public/UNIDATA/UCD.html#General_Category_Values)。然后，您可以过滤标点符号等。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T15:46:43.477

只需将字节串（您的 utf-8）转换为 unicode 对象并检查所有字符是否都是字母：

```
s.isalpha() 
```

对于字节串，此方法依赖于语言环境。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T15:35:53.160

根据您定义“名称”的方式，您可以对照这个正则表达式检查它：

```
^\w+$ 
```

但是，这将允许数字和下划线。要排除它们，您可以针对以下内容进行第二次测试：

```
[\d_] 
```

并使您的检查在匹配时失败。这两者可以组合如下：

```
^(?:(?![\d_])\w)+$ 
```

但是出于正则表达式性能的原因，我宁愿做两次单独的检查。

从[文档](http://docs.python.org/library/re.html)：

> `\w`
> 
> 未指定`LOCALE`and标志时，匹配任何字母数字字符和下划线；`UNICODE`这相当于 set `[a-zA-Z0-9_]`。使用`LOCALE`，它将匹配集合`[0-9_]`加上当前语言环境中定义为字母数字的任何字符。如果`UNICODE`设置，这将匹配字符 `[0-9_]`加上 Unicode 字符属性数据库中分类为字母数字的任何内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T20:21:06.593

这可能是迈向解决方案的一步：

```
import unicodedata
EXCEPTIONS= frozenset(u"'.")
CATEGORIES= frozenset( ('Lu', 'Ll', 'Lt', 'Pd', 'Zs') )
# O'Rourke, Franklin D. Roosevelt

def test_unicode_name(unicode_name):
    return all(
      uchar in EXCEPTIONS
        or unicodedata.category(uchar) in CATEGORIES
      for uchar in unicode_name)

>>> test_unicode_name(u"Michael O'Rourke")
True
>>> test_unicode_name(u"Χρήστος Γεωργίου")
True
>>> test_unicode_name(u"Jean-Luc Géraud")
True 
```

添加例外，并进一步检查我可能错过的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T15:35:58.137

模块的`letters`属性`string`应该给你你想要的。此属性是特定于语言环境的，因此只要您知道传递给您的文本的语言，就可以使用`setlocale()`这些字符并对其进行验证。

[http://docs.python.org/library/string.html#module-string](http://docs.python.org/library/string.html#module-string)

但是，正如您所指出的，在真正的“unicode”世界中，除非您了解语言，否则根本无法知道哪些字符是“字母”。如果您不了解该语言，则可以默认为 ASCII，或者通过语言环境运行常用语言。

# scripting - 以编程方式比较linux中的文件大小

> ID：626701
> 
> 赞同：3
> 
> 时间：2009-03-09T15:31:53.000
> 
> 标签：scripting

我有一个非常大且复杂的目录结构的两个版本，其中包含数万个单独的文件，我想查找从一个版本到另一个版本的重大文件更改。

每个文件都以某种细微的方式发生了变化。例如，您可能有一个名为 intro.txt 的文件，其中包含

[由 Mike 12:00 完成的 Build 1057] -（版本 1）

[由 Mike 18:10 完成的 Build 1065] -（版本 2）

我不关心这样的变化，因为它们不包含有用的信息。我也不关心拼写错误的更正或添加一两个单词。

我真正想做的是找出哪些文件以更主要的方式发生了变化。他们可能已经改变的一种方式是添加大量额外的内容，这会增加文件大小——这就是我感兴趣的那种改变。

那么，您将如何递归地解析目录以查找从一个版本到下一个版本增加（或减少）一定数量的文件。

我正在运行 linux，但几乎任何语言都可以。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T15:57:56.243

CPAN 上有几个模块可以提供此功能。例如。

*   [文件::目录比较](http://search.cpan.org/dist/File-DirCompare/)
*   [文件::DirCmp](http://search.cpan.org/dist/File-Dircmp/)

File::DirCompare 看起来最有希望....

```
 use File::DirCompare;

 File::DirCompare->compare('dirA', 'dirB', sub {
     my ($a, $b) = @_;

     ... callback runs on different or missing files   ...
     ... so perform extra checks on files $a & $b here ...

 }); 
```

因此，显示差异超过规定字节数的文件的一个示例是....

```
File::DirCompare->compare('dirA', 'dirB', size_diff_by_more_than(1024) );

sub size_diff_by_more_than {
    my $this = shift;

    return sub {
        my @files = grep { $_ } @_;

        if ( @files == 2 ) {
            # get the two file sizes and report if more than $this
            my @sizes = sort { $a <=> $b } map { (stat)[7] } @files;
            print "Different by more than $this bytes: $files[1]\n"
                if $sizes[1] - $sizes[0] > $this
        }
        else {
            print "Only: $files[0]\n";
        }
    };
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T15:43:09.260

在 python 中，您想从[filecmp](http://docs.python.org/library/filecmp.html)模块开始。

比较目录 - 然后打印出一侧或另一侧缺少的文件（[left_only](http://docs.python.org/library/filecmp.html#filecmp.dircmp.left_only)和[right_only](http://docs.python.org/library/filecmp.html#filecmp.dircmp.right_only)）。

然后对于[diff_files](http://docs.python.org/library/filecmp.html#filecmp.dircmp.diff_files)你需要做更多的细节比较 - 用于`os.stat`找出大小，如果差异太大则打印出文件名。

最后，您需要递归到公共子目录。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T15:54:11.493

我会做一个`diff -r -b FOLDER1 FOLDER2`获取已更改文件的列表，然后处理该列表（使用 bash 脚本就足够了）并检查每个文件的大小差异，如果差异超过阈值则打印文件名。

`-b`选项`diff`用于简要输出，它只为找到的每个差异打印一行，而不打印每行更改。

`-r`经常用于递归比较两个目录。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T15:57:35.247

在 bash 中：

```
before_dir=foo.old
after_dir=foo.new
interesting_size=10
for file in `find $before_dir -type f`; do
    diff_size=$(diff -u "$file" "$after_dir$(echo $file | sed "s,$before_dir,,")" | wc -l)
    if [ $diff_size -ge $interesting_size ]; then
        echo $file;
    fi;
done 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T15:58:55.133

您可以生成两个目录的差异，并在其上使用[diffstat](http://invisible-island.net/diffstat/)实用程序。Diffstat 报告更改文件的统计信息：添加、删除或修改了多少行。我想这将为您提供更多信息，而不仅仅是比较文件大小。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-10T17:59:58.483

在 C 中，您对文件调用 stat 。

```
＃包括
＃包括
＃包括

int main(int argc, char* argv[])
{
   结构统计文件信息A；
   结构统计文件信息B；

   如果（argc == 3）
   {
     stat(argv[1], &fileInfoA);
     stat(argv[2], &fileInfoB);

     // 现在，您可以使用 stat 的以下字段来比较文件：
     //结构统计{
     // dev_t st_dev; /* 包含文件的设备 ID */
     // ino_t st_ino; /* inode 编号 */
     // mode_t st_mode; /* 保护 */
     // nlink_t st_nlink; /* 硬链接数 */
     // uid_t st_uid; /* 所有者的用户 ID */
     // gid_t st_gid; /* 所有者的组 ID */
     // dev_t st_rdev; /* 设备 ID（如果是特殊文件） */
     // off_t st_size; /* 总大小，以字节为单位 */
     // blksize_t st_blksize; /* 文件系统 I/O 的块大小 */
     // blkcnt_t st_blocks; /* 分配的块数 */
     // time_t st_atime; /* 上次访问时间 */
     // time_t st_mtime; /* 上次修改时间 */
     // time_t st_ctime; /* 上次状态变化的时间 */
     // };

   }

```

现在，这对于比较单个文件很有用。要递归比较目录中的文件，您显然需要使用递归（或堆栈）。您还需要 opendir() 和 readdir() 系统调用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-10T14:07:20.917

关于确定两个文件之间的差异量：

运行两个文件的差异并将差异输出的长度与文件的整体大小相关可能会很好。

这（除了文件大小比较之外）将捕获文件中有很多更改但整体文件大小没有显着变化的情况。这可能适合也可能不适合您的用例。

# wpf - 属性上的 WPF 故事板触发器已更改

> ID：626704
> 
> 赞同：4
> 
> 时间：2009-03-09T15:32:26.430
> 
> 标签：wpf, triggers, storyboard

我有一个用于实现 INotifyPropertyChanged 的​​类的 DataTemplate。当属性更改并且不同值的不同故事板（在这种情况下为布尔值）时，有什么方法可以触发故事板？

有什么方法可以根据数据模板所针对的类的值在启动时触发情节提要？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T16:05:52.700

是的，你可以这么做。

添加一个 DataTrigger 并绑定到相应的属性。这是一个例子：

```
<DataTemplate.Triggers>
    <DataTrigger Binding="{Binding Path=MyProperty}" Value="True">
        <BeginStoryboard Storyboard="{StaticResource myStoryboard}"/>
    </DataTrigger>
</DataTemplate.Triggers> 
```

您可以将要测试的值设置为您想要的任何内容。因此，您可以将故事板设置为在您的值更改为 false 时开始。您可以根据需要添加任意数量的 DataTrigger（或其他触发器）。

请注意，在我的示例中，我引用了一个虚拟属性和情节提要。

当属性更改时，绑定将被更新并会因为数据绑定而触发触发器。

这种技术也应该在启动时起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-12T16:28:12.097

与上面的海报类似，我也使用了一个 DataTrigger，然后将它绑定到我的 ViewModel 中的一个属性。我发现令人困惑的一件事是数据触发器的放置位置。我直接放在根节点（即Window）。我使用 Expression Blend 创建了它，它为我处理了标签命名细节。

还要确保在您的项目中包含对“Microsoft.Expression.Interactions”的引用

XAML：（这直接在根节点中）

```
<Window
   xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
   xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions" 
   x:Name="window" >

    ...

    <i:Interaction.Triggers>
      <ei:DataTrigger Binding="{Binding FlashingBackground, Mode=OneWay}" Value="ON">
        <ei:ControlStoryboardAction Storyboard="{StaticResource MyAnimation}"     
                                                ControlStoryboardOption="Play"/>
      </ei:DataTrigger>
    </i:Interaction.Triggers>

    ...
</Window> 
```

视图模型：

```
 private void TurnOnFlashingBackround()
    {
        FlashingBackground = "ON";
    }

    private string _FlashingBackround = "OFF";

    public string FlashingBackground
    {
        get { return _FlashingBackround; }

        private set
        {
            if (FlashingBackground == value)
            {
                return;
            }

            _FlashingBackround = value;
            this.OnPropertyChanged("FlashingBackground");
        }
    }

    public new event PropertyChangedEventHandler PropertyChanged;

    private void OnPropertyChanged(string propertyName)
    {
        if (this.PropertyChanged != null)
        {
            this.PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    } 
```

最后，Viewmodel 必须继承自“INotifyPropertyChanged”

# c - 夏令时开关问题

> ID：626707
> 
> 赞同：0
> 
> 时间：2009-03-09T15:32:49.550
> 
> 标签：c, dst

我大约四年前写的一个程序，它获取日期和时间如下：

```
get_the_date_and_time(char *string) 
{
    struct tm *now;
    time_t lt;
    lt = time(NULL);
    now = localtime(&lt);
    sprintf(string,asctime(now));
} 
```

自切换到夏令时以来，它正在返回一个小时后的时间。

通过将我的系统日期更改为 4 月 5 日，我得到了正确的时间。

我们已经对所涉及的项目进行了解决；这只是一个提醒。

我怀疑微软用于扩展夏令时扩展的夏令时模块，即使没有损坏，也有些损坏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T15:41:08.280

听起来您的系统不知道由于 2005 年能源政策法案（[从 2007 年起 DST 延长了一个月](http://www.energy.ca.gov/daylightsaving.html)），美国夏令时的变化。

您使用的是哪个版本的 Windows，您是否使用 Windows 更新使其保持最新状态？

编辑：另外，这是静态链接还是动态链接，并且自从应用所有补丁等后您是否进行了重建？虽然我*希望*它从操作系统获取信息，但如果您静态链接，其中一些可能会被烘焙到您的可执行文件中。（伊克。）

# c++ - 如何从丢失的源代码中恢复？

> ID：626708
> 
> 赞同：1
> 
> 时间：2009-03-09T15:33:25.677
> 
> 标签：c++, dll, linker

我有一个导出 GetHash() 的单功能 DLL。但是，此 DLL 的源代码会丢失。我需要将此代码集成到我的 MSVC++ 项目中。

我知道有一些共享软件工具可以做到这一点，但我认为我可以手动完成。

我需要做什么才能手动完成此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T15:36:58.227

在您构建的项目中，引用 dll 并调用哈希函数。在调试器中运行代码并单步执行并反汇编函数并将其翻译回高级语言。

如果这还不够好，请将代码反汇编成一系列可以用 ASM 块实现的函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T15:55:49.353

你有 DLL 的 LIB 文件吗？AH（前导）文件？两者都需要静态链接，这是最简单的方法。

否则，最简单的路线可能只是动态链接它。（除非这是一个 COM DLL——你必须 RegSvr32 吗？如果是，你可以引用它并称之为 COM 样式。）为了做到这一点，你使用[LoadLibrary](http://msdn.microsoft.com/en-us/library/ms684175.aspx) () 和[GetProcAddress](http://msdn.microsoft.com/en-us/library/ms683212(VS.85).aspx) () 来获得一个函数指针。这就是事情变得棘手的地方：函数使用什么调用约定、什么参数以及什么返回类型？如果你有这些，你可以定义一个适当的函数指针类型（例如“int fphasher*(char *)”）。否则，准备进行大量有趣的实验甚至反汇编列表以使事情正确...

像[DllExportViewer](http://www.nirsoft.net/utils/dll_export_viewer.html)这样的 DLL 查看器可以帮助获取正确的函数名称，并获得一些提示，是否应该使用 C++ 或 C 风格的调用约定。警告：我没有测试过这个特定的版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T15:59:46.177

我认为另一种方法是反汇编 DLL 并恢复原始源代码。然后，您可以将代码集成到您的代码库中并更好地管理它。

这可能是这个问题的长期解决方案。

# string - 如何检测字符串是否为空字符？

> ID：626710
> 
> 赞同：2
> 
> 时间：2009-03-09T15:33:45.613
> 
> 标签：string

如何确定字符串是否有任何字母字符？

换句话说，如果字符串中只有空格，我如何将其视为空字符串？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-09T15:36:46.420

尝试：

```
if the_string.replace(" ", "") == "":
    the_string = "" 
```

如果您的语言支持它，使用“trim”、“strip”或“chomp”来删除前导/尾随空格也可能很好......

**编辑**：当然，正则表达式也可以解决这个问题：`the_string.match("[^\s]")`......或自定义函数......或任何数量的东西。

**编辑**：在 Caml 中：

```
let rec empty_or_space = fun
      [] -> true
    | (x::xs) -> x == ` ` and empty_or_space xs;; 
```

**编辑**：根据要求，在 LOLPYTHON 中：

```
BTW OHAI
SO IM LIKE EMPTY WIT S OK?
    LOL IZ S EMPTIE? DUZ IT HAZ UNWHITESPACE CHAREZ /LOL
    IZ S KINDA LIKE ""?
        U TAKE YEAH

    IZ S LOOK AT EASTERBUNNY OK KINDA NOT LIKE " "?
        U TAKE MEH

    U TAKE EMPTY WIT S OWN __getslice__ WIT CHEEZBURGER AND BIGNESS S OK OK 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T15:39:07.053

在 C# 中，您应该使用 String.IsNullOrEmpty。

要将其视为空字符串，您可以使用 "" 或 string.Empty; 要检查它是否为空，有一个 .Trim 函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T15:38:56.680

C++

```
#include <string>

bool isEmptyOrBlank(const std::string& str)
{
   int len = str.size();
   if(len == 0) { return true; }

   for(int i=0;i<len;++i)
   {
       if(str[i] != ' ') { return false; }
   }
   return true;
} 
```

C

```
#include <string.h>

int isEmptyOrBlank(const char* str)
{
  int i;
  int len;

  len = strlen(str);

  //String has no characters
  if(len == 0) { return 1; }

  for(i=0;i<len;++i)
  {
     if(str[i] != ' ') { return 0; }
  }

  return 1;
} 
```

爪哇

```
boolean isEmptyOrBlank(String str)
{
  int len = str.length();
  if(len == 0) { return true; }

  for (int i = 0; i < len; ++i)
  {
    if (str.charAt(i) != ' ')  { return false; }
  }

  return true;
} 
```

你明白了，你可以用任何语言做类似的事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-09T15:37:43.077

如果您谈论 .Net（C# 或 vb），那么您可以 Trim() 它来删除空格。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T16:07:33.490

```
if (s =~ /^\w*$/) 
```

应该可以工作，只要您使用 Perl。

有人有LOLCODE版本吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T16:49:13.703

无论语言如何，规范的方法是修剪字符串（修剪函数删除字符串开头和结尾的空格）并将结果与​​空字符串进行比较：

```
if (trim(myString) == "") {
    // string contains no letters, numbers, or punctuation
} 
```

但是，并非所有语言都具有本地修剪功能。这是一个很好的通用 JavaScript 示例，因为我还没有看到 JS 示例：

```
function trim(str) {
    return str.replace(/^\\s+|\\s+$/g, "");
} 
```

（查看[Steven Levithan 的关于 JavaScript 修剪函数的文章](http://blog.stevenlevithan.com/archives/faster-trim-javascript)以进行深入比较。）

或者，您可以使用正则表达式来测试“空虚”：

```
if (/^\s*$/.test(str)) {
    // string contains no letters, numbers, or punctuation
} 
```

同样，并非所有语言本身都支持正则表达式。检查您的语言文档。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T15:37:30.927

如果您使用的是 .NET，则 string 类型有一个`.Trim()`去除前导和尾随空格的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-09T15:37:50.800

如果您真的想将仅包含空格的字符串视为空字符串（它不是，但那是另一回事）只需使用您选择的语言提供的任何剥离方法（string.lstrip() 和 string.rstrip()例如在 Python 中）并检查结果字符串的长度是否为 0。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-09T16:21:03.707

微软的好心人添加了这个方法

```
string myStr = "    ";    
string.IsNullOrWhiteSpace(myStr) 
```

如果您使用.net，这将完成这项工作。

```
string myStr = "    ";    
string.IsNullOrEmpty(myStr.Trim())); 
```

如果您使用的是 .net 3.0 或更高版本，那么您可能希望为此创建一个可用于任何字符串的扩展方法。

```
namespace StringExtensions
{
    public static class StringExtensionsClass
    {
        public static string IsWhiteSpace(this string s)
        {
            return string.IsNullOrEmpty(s.Trim()));
        }
    }
} 
```

然后你可以像这样使用它

```
string myStr = "    ";
if (myStr.IsWhiteSpace())
    Console.Write("It just whitespace"); 
```

希望这就是你所追求的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-08-14T22:53:28.803

```
a = ' '
b = a if a.replace(' ','') else a.replace(' ','') 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-03-09T15:36:05.110

C＃：

空意味着（MSDN）该字段的值是零长度字符串，“”。

因此，如果你有空格，它不会是空的

```
private bool IsEmtpyOrContainsAllSpaces(String text)
        {
            int count = 0;
            foreach (char c in text)
            {
                if (c == ' ')
                {
                    count++;
                }
            }
            return (count == text.Length);
        } 
```

# php - Soap 返回 HTTP 请求失败错误

> ID：626714
> 
> 赞同：0
> 
> 时间：2009-03-09T15:35:18.497
> 
> 标签：php, soap, wsdl

我在尝试打开 WSDL 时遇到了这个错误，但我也测试了其他有效的 HTPP 地址，我也遇到了同样的错误。

这可能是我的 php.ini 配置中的内容吗？我已经检查`allow_url_fopen`并设置为打开。这是确切的错误：

> 无法打开流：HTTP 请求失败！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T15:41:04.317

尝试使用[fiddler](http://www.fiddlertool.com/fiddler/)，这样您就可以查看请求和响应的所有原始内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T15:38:49.923

我建议使用 CURL 而不是传统的文件函数。这也将允许更好地调试您的连接错误。

# jquery - jQuery没有在附加项目上触发

> ID：626736
> 
> 赞同：2
> 
> 时间：2009-03-09T15:38:04.013
> 
> 标签：jquery, html, css

我在触发已添加到页面的项目上的事件时遇到问题。在以下示例中，如果您单击 X，它将删除其中一项，但如果您添加一项，则无法删除它。

这是列表：

```
<ul id="mylist">
    <li>Item 1 <a class="remove">X</a></li>
    <li>Item 2 <a class="remove">X</a></li>
</ul>
<a class="add">Add</a> 
```

这是jQuery：

```
$('.add').click(function(){ 
    $('#mylist').append('<li>Item 3 <a class="remove">X</a></li>');
});

$('.remove').click(function(){ 
    $(this).parent().hide('slow').remove();
}); 
```

任何人对此有所了解，我是否需要更新 dom 或其他东西才能让 jQuery 识别附加元素？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-09T15:42:59.023

您需要使用 1.3 中添加到 jQuery 的新实时 API

[http://api.jquery.com/live/](http://api.jquery.com/live/)

如果您不能使用 1.3，则有一个用于 1.2 的 JQuery 插件，称为[LiveQuery](http://plugins.jquery.com/project/livequery)，其工作方式类似。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T15:43:39.193

啊，我前几天被这个咬了。您需要将事件绑定到页面加载时执行就绪处理程序后添加的所有新元素。有趣的是，有一个出色的[jQuery Live Query 插件](http://plugins.jquery.com/project/livequery)可以处理所有事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T15:44:35.760

这是正常行为。当您调用选择器（例如 $(".remove")）时，它会针对当前 DOM 执行。当您设置“删除”事件处理程序时，它将与现有项目（在您的示例中为 1 和 2）相关联，但不与之后创建的项目相关联。

幸运的是，jQuert 最近添加了一个新功能：[live](http://docs.jquery.com/Events/live)。它将允许您设置与之后添加的 DOM 元素相关联的事件：

```
$('.remove').live("click", function(){ 
        $(this).parent().hide('slow').remove();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T15:44:01.737

您正在尝试将事件处理程序绑定到不存在的元素类型。使用 jQuery 1.3+ 它有一个新的 $.live() 可以为尚不存在的元素设置事件处理程序

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T15:45:08.223

jQuery 1.3.x 支持“实时事件”：事件可以绑定到匹配选择器的当前和未来元素。您可以通过使用[.live()](http://docs.jquery.com/Events/live)方法来实现这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T17:30:21.357

虽然我建议使用最新版本的 jQuery，但您也可以在不使用“实时”事件的情况下执行此操作，方法是在所需名称空间的某处创建事件并在使用完项目之前将事件绑定到项目上。

```
var removeClickFunction = function(ev) {
    $(this).parent().hide('slow').end().remove();
    ev.preventDefault();
};
$('.remove').click(removeClickFunction);

$('.add').click(function(ev) {
    $('#mylist').append($('<li>Item 3 </li>').append($('<a class="remove" href="#">new remove</a>').click(removeClickFunction)));
    ev.preventDefault();
}); 
```

# specifications - 您如何解决规范中的歧义？

> ID：626737
> 
> 赞同：7
> 
> 时间：2009-03-09T15:38:13.200
> 
> 标签：specifications, ambiguity

我需要一些关于如何解决应用程序规范中的歧义的建议。作为一个简单的例子，

> 当用户多次验证失败时，向 IT 发送通知。

在上面的例子中，不清楚“a number of times”是多少次。目前还不清楚，我不能简单地设置一个随机限制，比如 1000 次。

您将如何解决任何规范中不清楚的部分？（不只是我提到的那个）

而且，对于这种情况，我应该在 Google 上搜索什么样的*主题或书籍？*软件工程？敏捷开发？我不知道从哪里开始。

任何有用的知识和技巧将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T17:57:24.367

如果您以正式的方式跟踪您的需求，您可以做出假设并将它们记录为派生需求：

## 例子：

**用户要求：**

Req 1：当用户多次验证失败时，向 IT 发送通知。

**派生要求：**

要求 1.1 如果用户在三 (3) 次尝试后未能通过身份验证，系统将暂停该帐户并向 IT 支持台发送电子邮件。

要求 1.1.1 帐户暂停电子邮件将指定以下内容：

*   用户的帐户名。
*   进行身份验证尝试的计算机的 IP 地址。

如果客户不可用，请让客户或利益相关者审查并批准派生的需求。

更多信息，谷歌“需求管理”或“需求工程”。国防工业部门**加载**了示例和模板，可能太多了；）

我已经收藏了一些：

*   [规范编写指南](http://nawctsd.navair.navy.mil/Resources/Library/Acqguide/spec.htm)
*   [编写软件需求规范](http://www.techwr-l.com/techwhirl/magazine/writing/softwarerequirementspecs.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T15:39:53.680

用您可能有的确切问题回答客户。这是最好的选择，如果有的话。如果没有，则使其可由最终用户（客户端）进行配置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T15:40:31.247

与（最好按此顺序）沟通：

*   业务分析师
*   客户（为最终产品付款的人）
*   终端用户

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T15:42:53.847

构建或原型化它，然后将它展示给编写规范的人。

通过谈论实际的事情而不是一张说明事情如何运作的纸，更容易消除歧义。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T15:52:10.953

你多虑了。

1.  “次数”值可以很容易地放入 web.config
2.  将其设置为您假定的适当值。（不用担心会出错）
3.  向您的经理发送一封电子邮件，说明您的假设，以及如果您的假设不正确，他们如何更改它。

如果每个其他应用程序通知都是电子邮件（这并非不现实），则可以假定规范的通知部分。否则在你做任何事情之前先问清楚。

我当然不反对要求澄清。但是，我发现如果可以做出*很少或没有缺点*的假设，最好这样做。毕竟他们雇佣你是为了解决问题而不是给他们带来更多。;-)

奇怪的是；你可能会发现你的大部分假设无论如何都是正确的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T15:51:14.777

从那个例子中，我会回到客户那里，询问他们是否希望“次数”是可配置的。它还可能导致以下问题：

1) 谁将维护配置的次数。2) 他们是否需要 UI 来查看和更改这些设置。

采用更敏捷的开发流程也将有所帮助。例如，向他们展示一个允许 3 次登录机会的示例将演示该功能，并可能提示他们告诉您号码。

在问题的答案将影响项目的时间、复杂性和成本的情况下，澄清需求变化的重要性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-09T18:09:39.373

根据谁有空，我会采取几种不同的路线来解决歧义：

1) 项目经理/业务分析师 -> 这些可能是最接近项目的，可以帮助快速解决规范问题。这可能涉及询问其他人并稍后回复您，但这应该是可以接受的。

2) 专家分析师/官员 -> 例如，在您提到存在安全隐患的情况下，如果有安全官员可能有执行政策并应参与讨论。另一个示例可能是让网络分析师从硬件角度查看架构，这在某些情况下可能很有用。

3) Product Owner -> 谁负责定义应用程序。请注意，这不是技术人员，因此如果您遇到“你知道，我没想到...”的回应，那么具体并提出建议可能会很有用。

4) Group Manager/Team Lead -> 如果一切都失败了，去找老板并要求澄清。

“需求收集”或“需求分析”是“软件开发生命周期”或“系统开发生命周期”这一部分的常用术语，以抛出更多您可以搜索并找到大量文章的术语。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-09T18:20:03.313

最好的方法是编写简短的替代用户故事（用例），描述不同选项将如何影响用户，并要求客户选择需要支持的选项。

规范中的模糊性通常反映了客户心中的模糊性——他们自己还没有弄清楚，所以这种方法对你们双方都有帮助。（使用书面笔记 - 没有技术性 - 用他们的术语来描述事物。）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-09T18:20:12.907

如果规格不准确，也许没关系？对其他任何工作都不是至关重要的吗？拨打电话，设为 1000。确保*它*不是硬编码的。一个好主意是将它放在一些配置文件中（但不要暴露给最终用户界面，因为用户通常比你有更少的想法）。

如果这是互操作性的问题，那么其他人会怎么做？在 Windows 中是200 吗*？*比让它变成 200。现在你匹配 Windows 和规范 - 不错:-)

如果您发现您的呼叫很糟糕并且*应该*是 1500，至少您可以告诉您的用户如何在不重新安装软件的情况下修复它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-08-28T16:45:05.443

在企业企业中，这确实意味着它遵循一般公司政策。

事实上，当我自己编写规范时，我并不在意这些通用规范，我只是说参考政策，直接进入特定业务需求的核心。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-05-03T16:10:21.197

为此，您可以建立一个焦点小组，或者您可以与客户/适当的利益相关者进行沟通。

# c++ - 有没有办法自动避免进入 Visual Studio 中的某些功能？

> ID：626744
> 
> 赞同：31
> 
> 时间：2009-03-09T15:39:22.107
> 
> 标签：c++, visual-studio, debugging

我知道“仅启用我的代码”调试选项，但这仅适用于托管代码。

我正在寻找一种无需单步执行函数调用的方法，例如，STL 字符串强制转换运算符，因为在函数的一个参数中存在从 char* 到字符串的隐式转换。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-09T16:05:31.980

我发现这个[博客条目](http://blogs.msdn.com/andypennell/archive/2004/02/06/69004.aspx)有一个解决方案。虽然我更愿意说“不要介入不属于这个项目的任何事情”，但这看起来是可行的。

编辑：在查看了一些博客和新闻组之后，方法是在此注册表项下为您不想进入的每个功能添加一个条目（假设 VS 2005）：

```
32 位 Windows
    \\HKEY_LOCAL_MACHINE\Software\Microsoft\VisualStudio\8.0\NativeDE\StepOver
64 位窗口
    \\HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\VisualStudio\8.0\NativeDE\StepOver

```

路径的版本号：

```
视觉工作室 2005：8.0
视觉工作室 2008：9.0
视觉工作室 2010：10.0
视觉工作室 2012：11.0
视觉工作室 2013：12.0

```

该键包含一组影响如何执行步进的规则。每个规则都被指定为一个单独的条目，其名称是一个十进制数，其值是一个函数名称模式，它指定我们想要影响哪些函数。例如

```
    "10" = "提升\:\:scoped_ptr.*\:\:.*=NoStepInto"

```

防止进入 boost::scoped_ptr 函数。

规则从高值到低值进行评估，直到找到匹配模式，或者没有剩余规则。在这种情况下，该功能被单步执行。

函数名是正则表达式。

冒号需要用反斜杠引用。

您可以指定 StepInto 和 NoStepInto。这为您提供了一种避免进入同一作用域/命名空间中除少数几个函数之外的所有函数的方法。

重新启动 Visual Studio 以获取对注册表的更改。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-09-14T14:34:01.683

[https://docs.microsoft.com/en-us/visualstudio/debugger/just-my-code?view=vs-2019#BKMK_CPP_Customize_stepping_behavior](https://docs.microsoft.com/en-us/visualstudio/debugger/just-my-code?view=vs-2019#BKMK_CPP_Customize_stepping_behavior)

在 C++ 项目中，您可以通过在 *.natstepfilter 文件中将它们列为非用户代码来指定要跳过的函数。*.natstepfilter 文件中列出的函数不依赖于“仅我的代码”设置。

*   若要为所有本地 Visual Studio 用户指定非用户代码，请将 .natstepfilter 文件添加到文件`%VsInstallDirectory%\Common7\Packages\Debugger\Visualizers`夹中。
*   要为单个用户指定非用户代码，请将 .natstepfilter 文件添加到文件`%USERPROFILE%\My Documents\<Visual Studio version>\Visualizers`夹中。

.natstepfilter 文件是具有以下语法的 XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<StepFilter xmlns="http://schemas.microsoft.com/vstudio/debugger/natstepfilter/2010">
    <Function>
        <Name>FunctionSpec</Name>
        <Action>StepAction</Action>
    </Function>
    <Function>
        <Name>FunctionSpec</Name>
        <Module>ModuleSpec</Module>
        <Action>StepAction</Action>
    </Function>
</StepFilter> 
```

| 元素 | 描述 |
| --- | --- |
| 功能 | 必需的。将一个或多个函数指定为非用户函数。 |
| 姓名 | 必需的。一个 ECMA-262 格式的正则表达式，指定要匹配的完整函数名。例如： 
`<Name>MyNS::MyClass.*</Name>`

告诉调试器 MyNS::MyClass 中的所有方法都被视为非用户代码。匹配区分大小写。 |
| 模块 | 选修的。一个 ECMA-262 格式的正则表达式，指定包含函数的模块的完整路径。匹配不区分大小写。 |
| 行动 | 必需的。这些区分大小写的值之一： 
`NoStepInto`- 告诉调试器跳过该函数。
`StepInto`- 告诉调试器进入函数，覆盖匹配函数的任何其他 NoStepInto。 |

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T16:09:14.047

我的复制过去：

> 避免介入事物
> 
> 避免进入一些常见代码（如构造函数或重载运算符）通常很有用。autoexp.dat 提供了这种能力。添加一个名为“[ExecutionControl]”的部分。添加键，其中键是函数名称，值为“NoStepInto”。您可以将星号 (*) 作为通配符指定为命名空间或类的第一组冒号。
> 
> autoexp.dat 仅在 Visual Studio 启动时读取。
> 
> 要忽略函数 myfunctionname，以及对 CFoo 类的所有调用：
> 
> [执行控制]
> 
> myfunctionname=NoStepInto
> 
> CFoo::*=NoStepInto
> 
> 要忽略 MFC CStrings 的构造和分配：（注意 CString::operator= 中的额外 =。）
> 
> [执行控制]
> 
> CString::CString=NoStepInto
> 
> CString::operator==NoStepInto
> 
> 忽略所有 ATL 调用：
> 
> [执行控制]
> 
> ATL::*=NoStepInto

来自这篇（[http://www.highprogrammer.com/alan/windev/visualstudio.html](http://www.highprogrammer.com/alan/windev/visualstudio.html)）文章。

您也可以使用弹出菜单中的“步入特定功能”。

**编辑** 对不起，看起来 autoexp.dat 在 vs 2003/2005 中不起作用。您可以对注册表设置进行同样的操作。 [http://groups.google.com/group/microsoft.public.vsnet.debugging/browse_thread/thread/b03dee5a626470c0/26addb1b539883e8](http://groups.google.com/group/microsoft.public.vsnet.debugging/browse_thread/thread/b03dee5a626470c0/26addb1b539883e8)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-09T19:11:21.240

上下文菜单上还有“进入特定”条目，它将列出当前行可以进入的功能，您可以选择您想要的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T17:24:24.757

VS6 曾经让您在 autoexp 文件中定义值，让您跳过进入常用函数（例如字符串构造函数）。从 VS7 开始，这些排除项已移至注册表。易用性受到严重打击。

在 VS7 及更高版本中，Microsoft 以他们的智慧将这些排除项移至注册表。这里有些例子：

```
Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\9.0\NativeDE\StepOver]
"10"="CString\\:\\:CString=NoStepInto"
"11"=".*\\.c_str.*=NoStepInto" 
```

键名代表搜索顺序。键值包含要搜索的 VS 正则表达式。

如果您创建自己的排除项，请务必从反汇编视图中获取名称。源代码中的声明可能与编译器生成的名称不匹配，尤其是对于模板化函数。

# c# - 如何检测 C# 中的远程处理通道已完成接收？

> ID：626749
> 
> 赞同：2
> 
> 时间：2009-03-09T15:40:20.717
> 
> 标签：c#, remoting

我使用远程处理来远程 C# 中的一个类。当我使用来自客户端的类的属性时。服务器不会等待发送完成。在继续之前，如何确保频道已收到所有消息？

# php - 在 Zend_Form 中处理日期 - 更改日期格式

> ID：626750
> 
> 赞同：0
> 
> 时间：2009-03-09T15:40:28.517
> 
> 标签：php, zend-framework, zend-form

我正在开发一个 Zend Framework (v1.7) 应用程序，该应用程序需要一些用户需要输入日期的表单。

提示用户以**dd/mm/yyyy**格式输入日期，但 MySQL 数据库希望日期以**yyyy-mm-dd**格式显示。因此，我必须执行以下操作：

*加载表格*

1.  从数据库中获取数据
2.  使用 Zend_Date 将日期字段重新格式化为**dd/mm/yyyy**格式

*保存表格*

1.  使用 Zend_Validate 验证日期字段
2.  检查日期字段是否存在。如果是这样，请将其重新格式化为**yyyy-mm-dd**格式。如果不是，请将其设置为 NULL
3.  保存到数据库

必须有一种更简单的方法来做到这一点：-S

谁能推荐一个？

干杯，
马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T15:57:06.433

如果您在 MySql 中使用[DATE_FORMAT()](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-format)和[STR_TO_DATE()等相应的 sql 函数，则可以跳过重新格式化。](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_str-to-date)其余的在我看来还可以。

# python - 如何在 python / Django 中找出给定 URL 的摘要文本？

> ID：626754
> 
> 赞同：16
> 
> 时间：2009-03-09T15:41:00.120
> 
> 标签：python, django

如何找出给定 URL 的摘要文本？

**我所说的摘要文本是什么意思？**

[默克 411 亿美元先灵葆雅竞标寻求科学](http://www.bloomberg.com/apps/news?pid=20601103&sid=a8p0FQHnw.Yo&refer=us)

***链接描述***

*默克公司以 411 亿美元收购先灵葆雅公司，增加了治疗血栓、感染和精神分裂症的实验性药物，使两家公司能够加快生物技术药物的研究。*

对于上述 URL，以下三行是摘要文本。
一个简短的 2 到 3 行 URL 描述，我们通常通过获取该页面获得，然后检查内容，然后从该 html 标记中找出简短描述。

有没有什么好的算法可以做到这一点？（或）
python/django 中是否有任何好的库可以做到这一点？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2010-02-22T00:22:20.317

我也有同样的需求，狐猴，虽然它有总结能力，但我发现它有问题，以至于无法使用。上周末，我使用 nltk 在 python 中编写了一个汇总模块：[https ://github.com/thavelick/summarize](https://github.com/thavelick/summarize)

我在这里从 Java 库 Classifier4J 中获取算法：http: [//classifier4j.sourceforge.net/](http://classifier4j.sourceforge.net/)但尽可能使用 nltk 和 python。

下面是基本用法：

```
>>> import summarize 
```

SimpleSummarizer（目前唯一的总结器）通过使用最常见单词的句子进行总结：

```
>>> ss = summarize.SimpleSummarizer()
>>> input = "NLTK is a python library for working human-written text. Summarize is a package that uses NLTK to create summaries."
>>> ss.summarize(input, 1)
'NLTK is a python library for working human-written text.' 
```

您可以根据需要在摘要中指定任意数量的语句。

```
>>> input = "NLTK is a python library for working human-written text. Summarize is a package that uses NLTK to create summaries. A Summariser is really cool. I don't think there are any other python summarisers."
>>> ss.summarize(input, 2)
"NLTK is a python library for working human-written text.  I don't think there are any other python summarisers." 
```

与 Classifier4J 的原始算法不同，此摘要器可以正确处理句点以外的标点符号：

```
>>> input = "NLTK is a python library for working human-written text! Summarize is a package that uses NLTK to create summaries."
>>> ss.summarize(input, 1)
'NLTK is a python library for working human-written text!' 
```

**更新**

我现在（终于！）在 Apache 2.0 许可证下发布了这个，与 nltk 相同的许可证，并将模块放在 github 上（见上文）。欢迎任何贡献或建议。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T15:54:12.710

文本摘要是一个相当复杂的话题。如果您需要认真地执行此操作，您可能希望查看像 Lemur （[http://www.lemurproject.org/](http://www.lemurproject.org/)）这样的项目。

但是，我怀疑您真正想要的是这里的文本摘要。如果您知道文档的哪一部分包含正文，请使用 HTML 解析库（如[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/) ）定位它，然后删除 HTML；取第一句话，或前 N 个字符（最适合的），然后使用它。有点像一个可怜的表弟的抽象生成器:-)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T16:10:02.190

查看[自然语言工具包](http://www.nltk.org/)。如果您正在进行任何文本处理，它是一个非常有用的 python 库。

然后看看HP Luhn (1958) 的[这篇论文](http://www.di.ubi.pt/~jpaulo/competence/general/(1958)Luhn.pdf)。它描述了一种简单但有效的生成文本摘要的方法。

使用 nltk.probability.FreqDist 对象跟踪单词在文本中出现的频率，然后根据句子中出现频率最高的单词的数量对句子进行评分。然后选择得分最高的句子，瞧，你就有了文档的摘要。

我怀疑 NLTK 应该有一种从 Web 加载文档并将所有 HTML 标记排除在外的方法。我自己没有做过那种事情，但是如果你查看语料库阅读器，你可能会发现一些有用的东西。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-03-09T15:56:09.650

在这种情况下，您最好的选择是使用 HTML 解析库，如 BeautifulSoup ( [http://www.crummy.com/software/BeautifulSoup/](http://www.crummy.com/software/BeautifulSoup/) )

例如，您可以从那里获取所有页面`p`标签：

> 导入 urllib2
> 
> 从 BeautifulSoup 导入 BeautifulSoup
> 
> page = urllib2.urlopen(" [http://www.bloomberg.com/apps/newspid=20601103&sid=a8p0FQHnw.Yo&refer=us](http://www.bloomberg.com/apps/newspid=20601103&sid=a8p0FQHnw.Yo&refer=us) ")
> 
> 汤= BeautifulSoup（页面）
> 
> 汤.findAll('p')

然后，做一些解析。它完全取决于页面，因为每个站点的结构都不同。您可以像他们一样在某些网站上走运，您只需查找`p`其中包含 id#summary 的标签，而其他网站（如 Blooberg）可能需要更多的尝试。

# python - 列表和元组有什么区别？

> ID：626759
> 
> 赞同：1112
> 
> 时间：2009-03-09T15:41:25.767
> 
> 标签：python, list, tuples

有什么不同？

元组/列表的优点/缺点是什么？

* * *

## 回答 #1

> 赞同：1082
> 
> 时间：2009-03-09T16:02:51.800

除了元组是不可变的之外，还有一个语义区别应该指导它们的使用。元组是异构数据结构（即它们的条目具有不同的含义），而列表是同构序列。**元组有结构，列表有顺序。**

使用这种区别使代码更加明确和易于理解。

一个例子是成对的页码和行号来引用书中的位置，例如：

```
my_location = (42, 11)  # page number, line number 
```

然后，您可以将其用作字典中的键来存储有关位置的注释。另一方面，列表可用于存储多个位置。自然地，人们可能想要在列表中添加或删除位置，因此列表是可变的是有道理的。另一方面，从现有位置添加或删除项目没有意义 - 因此元组是不可变的。

在某些情况下，您可能想要更改现有位置元组中的项目，例如在遍历页面行时。但是元组不变性迫使您为每个新值创建一个新的位置元组。从表面上看，这似乎很不方便，但使用像这样的不可变数据是值类型和函数式编程技术的基石，它可以具有很大的优势。

关于这个问题有一些有趣的文章，例如[“Python 元组不仅仅是常量列表”](http://jtauber.com/blog/2006/04/15/python_tuples_are_not_just_constant_lists/)或[“理解 Python 中的元组与列表”](http://news.e-scribe.com/397)。Python 官方文档[也提到了这一点](http://docs.python.org/2/tutorial/datastructures.html#tuples-and-sequences)

> “元组是不可变的，通常包含异构序列......”。

在像*Haskell*这样的静态类型语言中，元组中的值通常具有不同的类型，并且元组的长度必须是固定的。在列表中，值都具有相同的类型，并且长度不固定。所以区别非常明显。

最后是 Python 中的[namedtuple](http://docs.python.org/dev/library/collections.html#collections.namedtuple)，这是有道理的，因为元组已经应该具有结构。这强调了元组是类和实例的轻量级替代方案。

* * *

## 回答 #2

> 赞同：393
> 
> 时间：2013-09-19T11:07:28.673

列表和元组的区别

1.  **文字**

    ```
    someTuple = (1,2)
    someList  = [1,2] 
    ```

2.  **尺寸**

    ```
    a = tuple(range(1000))
    b = list(range(1000))

    a.__sizeof__() # 8024
    b.__sizeof__() # 9088 
    ```

    由于元组操作的尺寸更小，它变得更快一些，但在你拥有大量元素之前，无需多提。

3.  **允许的操作**

    ```
    b    = [1,2]   
    b[0] = 3       # [3, 2]

    a    = (1,2)
    a[0] = 3       # Error 
    ```

    这也意味着您不能删除元素或对元组进行排序。但是，您可以向列表和元组添加一个新元素，唯一的区别是由于元组是不可变的，因此您并没有*真正*添加元素，而是创建了一个新元组，因此 id 会改变

    ```
    a     = (1,2)
    b     = [1,2]  

    id(a)          # 140230916716520
    id(b)          # 748527696

    a   += (3,)    # (1, 2, 3)
    b   += [3]     # [1, 2, 3]

    id(a)          # 140230916878160
    id(b)          # 748527696 
    ```

4.  **用法**

    由于列表是可变的，它不能用作字典中的键，而可以使用元组。

    ```
    a    = (1,2)
    b    = [1,2] 

    c = {a: 1}     # OK
    c = {b: 1}     # Error 
    ```

* * *

## 回答 #3

> 赞同：216
> 
> 时间：2009-03-09T17:14:47.073

如果你去散步，你可以随时在一个`(x,y)`元组中记录你的坐标。

如果您想记录您的旅程，您可以每隔几秒钟将您的位置附加到一个列表中。

但是你不能反过来做。

* * *

## 回答 #4

> 赞同：85
> 
> 时间：2009-03-09T15:42:38.247

关键区别在于元组是不可变的。这意味着一旦创建元组，就不能更改元组中的值。

因此，如果您需要更改值，请使用列表。

元组的好处：

1.  性能略有提升。
2.  由于元组是不可变的，它可以用作字典中的键。
3.  如果你不能改变它，其他人也不能，也就是说你不需要担心任何 API 函数等。在不被询问的情况下改变你的元组。

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2009-03-09T15:41:59.387

列表是可变的；元组不是。

来自[docs.python.org/2/tutorial/datastructures.html](http://docs.python.org/2/tutorial/datastructures.html)

> 元组是不可变的，并且通常包含通过解包（参见本节后面部分）或索引（甚至在命名元组的情况下通过属性）访问的异构元素序列。列表是可变的，它们的元素通常是同质的，可以通过遍历列表来访问。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2013-08-12T07:06:24.550

有人[提到](https://stackoverflow.com/a/626871/915501)，区别主要是语义上的：人们期望一个元组和一个列表来表示不同的信息。但这不仅仅是指导方针；一些库实际上根据它们传递的内容而表现不同。以 NumPy 为例（从我要求更多示例的[另一篇文章](https://stackoverflow.com/q/18181076/915501)中复制）：

```
>>> import numpy as np
>>> a = np.arange(9).reshape(3,3)
>>> a
array([[0, 1, 2],
       [3, 4, 5],
       [6, 7, 8]])
>>> idx = (1,1)
>>> a[idx]
4
>>> idx = [1,1]
>>> a[idx]
array([[3, 4, 5],
       [3, 4, 5]]) 
```

关键是，虽然 NumPy 可能不是标准库的一部分，但它是一个*主要*的Python 库，在 NumPy 中，列表和元组是完全不同的东西。

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2016-03-22T13:48:58.390

这是 Python 列表的示例：

```
my_list = [0,1,2,3,4]
top_rock_list = ["Bohemian Rhapsody","Kashmir","Sweet Emotion", "Fortunate Son"] 
```

这是 Python 元组的示例：

```
my_tuple = (a,b,c,d,e)
celebrity_tuple = ("John", "Wayne", 90210, "Actor", "Male", "Dead") 
```

Python 列表和元组的相似之处在于它们都是有序的值集合。除了使用括号“[ ... , ... ]”创建列表和使用括号“( ... , ... )”创建元组的细微区别之外，它们之间的核心技术“硬编码 Python 语法”区别是特定元组的元素是不可变的，而列表是可变的（...所以只有元组是可散列的，可以用作字典/散列键！）。这导致了它们如何使用或不能使用的差异（通过语法先验地强制执行）以及人们选择使用它们的方式的差异（被鼓励为“最佳实践”，后验，这就是*聪明*的程序员所做的）。*人们给予元素的顺序。*

 *对于元组，“顺序”仅表示用于保存信息的特定“结构”。在第一个字段中找到的值可以轻松切换到第二个字段，因为每个字段都提供跨两个不同维度或比例的值。它们为不同类型的问题提供答案，通常具有以下形式：*对于给定的对象/主题，它的属性是什么？*对象/主体保持不变，属性不同。

对于列表，“顺序”表示顺序或方向性。第二个元素*必须在*第一个元素之后，因为它基于特定和常见的比例或尺寸位于第二位。这些元素被视为一个整体，并且主要为通常形式的单个问题提供答案，*对于给定的属性，这些对象/主题如何比较？*属性保持不变，对象/主题不同。

流行文化中的人和程序员不符合这些差异的例子不胜枚举，也有不计其数的人可能会在主菜中使用沙拉叉。归根结底，这很好，两者通常都能完成工作。

**总结一些更精细的细节**

**相似之处：**

1.  *重复*- 元组和列表都允许重复
2.  *索引、选择和切片*- 元组和列表都使用括号内的整数值进行索引。因此，如果您想要给定列表或元组的前 3 个值，语法将是相同的：

    ```
    >>> my_list[0:3]
    [0,1,2]
    >>> my_tuple[0:3]
    [a,b,c] 
    ```

3.  *比较和排序*- 两个元组或两个列表都通过它们的第一个元素进行比较，如果存在平局，则通过第二个元素进行比较，依此类推。在前面的元素表现出差异之后，不再关注后面的元素。

    ```
    >>> [0,2,0,0,0,0]>[0,0,0,0,0,500]
    True
    >>> (0,2,0,0,0,0)>(0,0,0,0,0,500)
    True 
    ```

**差异：** - 先验，根据定义

1.  *语法*- 列表使用 []，元组使用 ()

2.  *可变性*- 给定列表中的元素是可变的，给定元组中的元素是不可变的。

    ```
    # Lists are mutable:
    >>> top_rock_list
    ['Bohemian Rhapsody', 'Kashmir', 'Sweet Emotion', 'Fortunate Son']
    >>> top_rock_list[1]
    'Kashmir'
    >>> top_rock_list[1] = "Stairway to Heaven"
    >>> top_rock_list
    ['Bohemian Rhapsody', 'Stairway to Heaven', 'Sweet Emotion', 'Fortunate Son']

    # Tuples are NOT mutable:       
    >>> celebrity_tuple
    ('John', 'Wayne', 90210, 'Actor', 'Male', 'Dead')
    >>> celebrity_tuple[5]
    'Dead'
    >>> celebrity_tuple[5]="Alive"
    Traceback (most recent call last):
    File "<stdin>", line 1, in <module>
    TypeError: 'tuple' object does not support item assignment 
    ```

3.  *Hashtables (Dictionaries)* - 由于 hashtables (dictionaries) 要求其键是可散列的，因此是不可变的，因此只有元组可以充当字典键，而不是列表。

    ```
    #Lists CAN'T act as keys for hashtables(dictionaries)
    >>> my_dict = {[a,b,c]:"some value"}
    Traceback (most recent call last):
    File "<stdin>", line 1, in <module>
    TypeError: unhashable type: 'list'

    #Tuples CAN act as keys for hashtables(dictionaries)
    >>> my_dict = {("John","Wayne"): 90210}
    >>> my_dict
    {('John', 'Wayne'): 90210} 
    ```

差异 - 使用中的后验

1.  Homo vs. Heterogeneity of Elements - 通常列表对象是同质的，而元组对象是异构的。也就是说，列表用于相同类型的对象/主题（如所有总统候选人，或所有歌曲，或所有跑步者），尽管它不是强制的），而元组更多用于异构对象。

2.  循环与结构 - 虽然两者都允许循环（对于 my_list 中的 x...），但对列表执行此操作才真正有意义。元组更适合结构化和呈现信息（位于 %s 中的 %s %s 是 %s，现在是 %s % ("John","Wayne",90210, "Actor","Dead")）

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2013-04-19T05:43:14.403

列表用于循环，元组用于结构，即`"%s %s" %tuple`。

列表通常是同质的，元组通常是异构的。

列表用于可变长度，元组用于固定长度。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2013-06-06T11:14:54.527

**列表**的值可以随时更改，但**元组**的值不能更改。

优点和**缺点**取决于用途。如果你有这样一个你不想改变的数据，那么你应该使用元组，否则列表是最好的选择。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2018-07-19T19:03:40.087

## 列表和元组的区别

元组和列表都是 Python 中看似相似的序列类型。

1.  **字面量语法**

    我们使用括号 ( `) 来构造元组和方括号`[ ]`来获得一个新列表。此外，我们可以使用适当类型的调用来获取所需的结构——元组或列表。`

     ````
    someTuple = (4,6)
    someList  = [2,6] 
    ```` 
`*   **可变性**

    元组是不可变的，而列表是可变的。这一点是以下几点的基础。

    *   **内存使用情况**

    由于可变性，列表需要更多内存，元组需要更少内存。

    *   **扩展**

    您可以将新元素添加到元组和列表中，唯一的区别是元组的 id 将被更改（即，我们将拥有一个新对象）。

    *   **散列**

    元组是可散列的，而列表则不是。这意味着您可以将元组用作字典中的键。列表不能用作字典中的键，而可以使用元组

    ```
    tup      = (1,2)
    list_    = [1,2] 

    c = {tup   : 1}     # ok
    c = {list_ : 1}     # error 
    ```

    *   **语义**

    这一点更多的是关于最佳实践。您应该将元组用作异构数据结构，而列表是同质序列。` 

 `* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-03-09T20:29:55.933

列表旨在成为同质序列，而元组是异构数据结构。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2018-05-18T06:12:44.107

正如人们已经在这里回答的那样`tuples`，不可变而`lists`可变，但是我们必须记住使用元组的一个重要方面

如果其中`tuple`包含 a`list`或 a `dictionary`，即使它`tuple`本身是不可变的，也可以更改它们。

例如，假设我们有一个包含列表和字典的元组

```
my_tuple = (10,20,30,[40,50],{ 'a' : 10}) 
```

我们可以将列表的内容更改为

```
my_tuple[3][0] = 400
my_tuple[3][1] = 500 
```

这使得新元组看起来像

```
(10, 20, 30, [400, 500], {'a': 10}) 
```

我们还可以将元组内的字典更改为

```
my_tuple[4]['a'] = 500 
```

这将使整个元组看起来像

```
(10, 20, 30, [400, 500], {'a': 500}) 
```

发生这种情况是因为`list`和`dictionary`是对象，这些对象并没有改变，而是它指向的内容。

所以`tuple`保持不变，无一例外

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2016-09-22T16:13:04.920

[PEP 484 -- Type Hints](https://www.python.org/dev/peps/pep-0484/#the-typing-module)说 a 的元素类型可以`tuple`单独输入；这样你就可以说`Tuple[str, int, float]`；但是 a `list`, with `List`typing class 只能接受一个类型参数：`List[str]`，这暗示了 2 的区别实际上是前者是异构的，而后者本质上是同质的。

此外，标准库主要使用元组作为 C 将返回 a 的标准函数的返回值`struct`。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2019-09-25T07:40:48.157

正如人们已经提到的差异，我将写下为什么要使用元组。

**为什么首选元组？**

> **小元组的分配优化**
> 
> 为了减少内存碎片并加快分配速度，Python 重用了旧的元组。如果一个元组不再需要并且少于 20 个项目而不是永久删除它，Python 会将其移动到空闲列表中。
> 
> 一个空闲列表分为 20 个组，每个组代表一个长度为 0 到 20 之间的元组列表。每个组最多可以存储 2000 个元组。第一个（零）组仅包含 1 个元素并表示一个空元组。

```
>>> a = (1,2,3)
>>> id(a)
4427578104
>>> del a
>>> b = (1,2,4)
>>> id(b)
4427578104 
```

> 在上面的示例中，我们可以看到 a 和 b 具有相同的 id。那是因为我们立即占用了空闲列表上的已销毁元组。
> 
> **列表的分配优化**
> 
> 由于可以修改列表，Python 不使用与元组相同的优化。但是，Python 列表也有一个空闲列表，但它仅用于空对象。如果空列表被 GC 删除或收集，以后可以重复使用。

```
>>> a = []
>>> id(a)
4465566792
>>> del a
>>> b = []
>>> id(b)
4465566792 
```

来源：[https ://rushter.com/blog/python-lists-and-tuples/](https://rushter.com/blog/python-lists-and-tuples/)

**为什么元组比列表有效？**-> [https://stackoverflow.com/a/22140115](https://stackoverflow.com/a/22140115)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2020-08-31T10:13:13.683

最重要的区别是时间！当您不想更改列表内的数据时，最好使用元组！这是为什么使用元组的示例！

```
import timeit
print(timeit.timeit(stmt='[1,2,3,4,5,6,7,8,9,10]', number=1000000)) #created list
print(timeit.timeit(stmt='(1,2,3,4,5,6,7,8,9,10)', number=1000000)) # created tuple 
```

*在这个例子中，我们执行了这两个语句 100 万次*

输出 ：

```
0.136621
0.013722200000000018 
```

任何人都可以清楚地注意到时差。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-09-26T16:12:11.820

来自[5.3 文档的方向引用。元组和序列](https://docs.python.org/2/tutorial/datastructures.html#tuples-and-sequences)：

> 尽管元组可能看起来类似于列表，但它们通常用于不同的情况和不同的目的。元组是*不可变*的，通常包含一个*异构*的元素序列，这些元素通过*解包*（见本节后面）或*索引*（或者在命名元组的情况下甚至通过属性）访问。列表是*可变*的，它们的元素通常是*同质*的，可以通过*遍历*列表来访问。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-04-08T09:10:36.573

首先，它们都是 Python 中的非标量对象（也称为复合对象）。

*   元组，元素的有序序列（可以包含任何没有别名问题的对象）
    *   不可变（元组、int、float、str）
    *   使用连接`+`（当然会创建全新的元组）
    *   索引
    *   切片
    *   单例`(3,) # -> (3)`而不是`(3) # -> 3`
*   列表（其他语言的数组），有序的值序列
    *   可变的
    *   辛格尔顿`[3]`
    *   克隆`new_array = origin_array[:]`
    *   列表理解`[x**2 for x in range(1,7)]`给你 `[1,4,9,16,25,36]`（不可读）

使用 list 还可能导致别名错误（指向同一对象的两个不同路径）。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-08-15T10:16:50.053

**`list` *只是对vs* `tuple`响应的快速扩展：**

*   由于动态特性，`list`分配比实际所需内存更多的位桶。这样做是为了防止在将来附加额外项目时进行昂贵的重新分配操作。

*   另一方面，作为静态的轻量级`tuple`对象，不会保留存储它们所需的额外内存。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-06-21T05:35:59.583

列表是可变的，元组是不可变的。只要考虑这个例子。

```
a = ["1", "2", "ra", "sa"]    #list
b = ("1", "2", "ra", "sa")    #tuple 
```

现在更改列表和元组的索引值。

```
a[2] = 1000
print a     #output : ['1', '2', 1000, 'sa']
b[2] = 1000
print b     #output : TypeError: 'tuple' object does not support item assignment. 
```

因此证明以下代码对元组无效，因为我们试图更新一个元组，这是不允许的。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-02-26T17:26:16.073

列表是可变的。而元组是不可变的。在元组中访问具有索引的偏移元素比列表更有意义，因为元素及其索引不能更改。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-06-22T03:18:08.427

除了这里提出的许多其他评论外，我看到使用元组的好处是它们能够具有不同类型的值而不像列表的灵活性。

以一个数据库表为例，它为每一列指定了不同的值和类型。列表根本无法复制这一点（因为它限制为它可以包含的单一类型的值），而元组可以有多种不同的类型和值，它们的位置对每一列都尊重（甚至可以放在一个列表中创建自己的数据库虚拟表示）。

这种灵活性和限制（因为不能更改值）也有它的好处，比如传输事务数据（或者说类似于表格的格式）。您“密封”元组中的数据，防止它在发送保护它之前被修改，因为它的设计目的是：提供不变性。与只读集合相比，这有什么区别？您可以有不同的值类型的事实。

它的应用（因为列表、对象和字典的大量使用）受到限制，人们通常认为对象模型可以作为更好的选择（在某些情况下确实如此），但是说你不'不需要对象模型，因为您更愿意将其与您定义为业务实体的内容分开。然后，一个元组可能会很好地为您提供您想要实现的目标。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2014-09-30T19:01:37.607

列表是可变的，元组是不可变的。可变和不可变之间的主要区别在于尝试追加项目时的内存使用情况。

创建变量时，会为变量分配一些固定内存。如果是列表，则分配的内存比实际使用的多。例如，如果当前内存分配是 100 字节，当您想要附加第 101 个字节时，可能会分配另外 100 个字节（在这种情况下总共 200 个字节）。

但是，如果您知道自己不经常添加新元素，那么您应该使用元组。元组精确分配所需内存的大小，从而节省内存，尤其是在您使用大块内存时。

# c# - 在 C# 中调用基本构造函数

> ID：626765
> 
> 赞同：26
> 
> 时间：2009-03-09T15:42:08.747
> 
> 标签：c#, asp.net

我有以下层次结构：

```
class Base
{
  public Base(string sMessage)
  {
     //Do stuff
  }
}

class Derived : Base
{
  public Derived(string someParams)
  {

   string sMessage = "Blah " + someParams;

   //Here I want to call the base constructor
   //base(sMessage);

  }

} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-09T15:46:40.560

您必须在派生类构造函数的主体之前调用基类构造函数。

```
class Derived : Base
{
  public Derived(string someParams)
    : base("Blah " + someParams)
  {

  }

} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T15:44:45.370

你不能。您可以在此之前调用它：

```
public Derived() : base() 
```

或者你必须使用钩子

```
class Base
{
  protected void init() { }
  public Base(string sMessage)
  {
     init();
  }
}

class Derived : Base
{
  public Derived(string someParams)
  {
   string sMessage = "Blah " + someParams;
   init();
  }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-09T23:32:31.277

我最初错过了 OregonGhost 关于使用静态方法修改参数的评论，这对我来说是最有用的，所以我想我会为阅读此线程的其他人添加一个代码示例：

```
class Base
{
    public Base( string sMessage )
    {
        // Do stuff
    }
}

class Derived : Base
{
    public Derived( string sMessage ) : base( AdjustParams( sMessage ) )
    {
    }

    static string AdjustParams( string sMessage )
    {
        return "Blah " + sMessage;
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-09T15:53:24.740

如果您确实需要首先运行您的构造函数，那么我建议使用由您的构造函数调用的受保护的 Initialize 方法，并执行初始化类的实际工作。您需要提供一个允许跳过初始化的替代构造函数。

```
public class Base
{

    public Base() : this(true) { }

    protected Base(bool runInitializer)
    {
        if (runInitializer)
        {
            this.Initialize();
        }
    }

    protected void Initialize()
    {
        ...initialize...
    }
}

public class Derived : Base
{
    // explicitly referencing the base constructor keeps
    // the default one from being invoked.
    public Derived() : base(false)
    {
       ...derived code
       this.Initialize();
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T15:46:01.967

构造函数需要注意的点：

· 构造函数不能是“虚拟的”。

· 他们不能被继承。

· 构造函数按继承顺序调用。

```
public Child(string a):base(a){} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T15:45:53.947

```
public Derived(string someParams) : base(someParams)
{
    string sMessage = "Blah " + someParams;
} 
```

这是你必须这样做的方式。您也许可以将以后要调用的代码放在基类的受保护方法中，然后可以像这样调用它：

```
class Base
{
  public Base(string sMessage)
  {
     ConstructorStuff();
  }

  protected Base()
  {
  }

  protected void ConstructorStuff()
  {
  }
}

class Derived : Base
{
  public Derived(string someParams)
  {    
   string sMessage = "Blah " + someParams;

   ConstructorStuff();       
  }    
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T16:23:10.927

实际上，最简单的解决方案是：

```
class Base
{
  public Base(string sMessage)
  {
     //Do stuff
  }
}

class Derived : Base
{
  public Derived(string someParams)
    : base("Blah " + someParams)
  {
  }

} 
```

为什么要让它变得更复杂？

# c# - C# 中内存占用最低的最快的序列化器和反序列化器？

> ID：626766
> 
> 赞同：16
> 
> 时间：2009-03-09T15:42:11.833
> 
> 标签：c#, .net, wcf, sockets, remoting

我目前正在使用二进制格式化程序（远程处理）来序列化和反序列化对象以在我的 LAN 周围发送。

我最近从 2.0 升级到 .NET 3.5。3.5 是否引入了任何新类型来提高序列化性能？

我看过`DataContractSerializer`, 但这会将任何内容序列化为底层 XML 权利……这必须增加内存占用。

通过 LAN 发送对象的最快序列化程序是什么？我不在乎互操作或版本控制……。我需要速度！

我对第三方开源替代品持开放态度。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-09T16:08:07.747

听起来[Protocol Buffers](http://code.google.com/apis/protocolbuffers/)可能是您正在寻找的东西。

我知道三个 .NET 实现：[protobuf-net](http://code.google.com/p/protobuf-net/)、[protobuf-csharp-port](http://code.google.com/p/protobuf-csharp-port/)和[Proto#](http://code.google.com/p/protosharp/)。

[性能比较](http://code.google.com/p/protobuf-net/wiki/Performance)表明，Protocol Buffers在大小和序列化/反序列化速度方面都优于内置序列化器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-08-25T17:44:05.827

我有一些基于 Northwind 数据集[的领先 .NET 序列化程序的基准测试。](http://mono.servicestack.net/benchmarks/NorthwindDatabaseRowsSerialization.1000000-times.2010-02-06.html)

@marcgravell 二进制 protobuf-net 是基准测试中最快的实现，比 BCL 中可用的 Microsoft 最快的序列化程序（XML DataContractSerializer）快约**7 倍。**

**Microsoft 的JsonDataContractSerializer**非常慢 - 比protobuf-net 慢 9 倍以上，比我自己的[JsonSerializer慢](http://www.servicestack.net/mythz_blog/?p=344)**3.6 倍**以上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-11T01:45:29.100

在@Luke 链接的[性能比较](http://code.google.com/p/protobuf-net/wiki/Performance)中，请注意`DataContractJsonSerializer`与其他 MS 序列化程序相比，它的性能非常好。

鉴于 JSON 无处不在，而且您可以轻松使用`DataContractJsonSerializer`，我认为没有太多理由使用“协议缓冲区”。JSON 在语言和平台之间跳转时会更容易调试，并且压缩得很好。

（我喜欢 Google 如何采用 CS 101 概念并因实现它们而闻名。在 C 中，我们将“协议缓冲区”称为“结构”。它们工作得很好。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-26T07:09:12.703

正如我在[这个答案](https://stackoverflow.com/a/36693549/6082960)中所展示的那样，生成的代码可能是最快的序列化程序。然而，它还处于早期阶段，仍然缺乏其他序列化程序提供的一些功能。

# asp.net - Silverlight 访问安全的 Web 服务

> ID：626767
> 
> 赞同：0
> 
> 时间：2009-03-09T15:42:19.353
> 
> 标签：asp.net, silverlight, service

我正在尝试让 Silverlight 应用程序使用服务引用连接到 Java Web 服务。

我得出的结论是，在服务连接方面，Silverlight 的工作方式与 WPF 或 ASP.NET 不同。

我在网上搜索过，我发现的所有身份验证都是关于通过更改服务以包含 web 方法来保护用户应用程序的文章。

我必须使用现有的服务。我一直在 ASP.NET 和 WPF 中使用 NetworkCredentials；Silverlight 中的等价物是什么？

抱歉，我应该提到它是 JBoss 服务器上的轴服务。

更新：此链接似乎表明这应该是可能的[http://blogs.msdn.com/coding4fun/archive/2008/02/24/7883342.aspx](http://blogs.msdn.com/coding4fun/archive/2008/02/24/7883342.aspx)。他们使用 NetworkCredentials 连接到 Twitter API。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-16T12:15:39.817

这绝对应该是可能的。服务是用什么语言编写的无关紧要——只有输出的格式（SOAP、JSON 等）。

您是否涉及任何 SSL？

尝试完全打开您的 ClientAccessPolicy（无限制），然后尝试将其复制到不同的根目录（服务器的根目录、应用程序的根目录、SL 应用程序的根目录等），看看是否能得到更好的结果。

我认为一个完全开放的策略文件应该是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<access-policy>
  <cross-domain-access>
    <policy>
      <allow-from http-request-headers="*">
        <domain uri="*"/>
      </allow-from>
      <grant-to>
        <resource path="/" include-subpaths="true"/>
      </grant-to>
    </policy>
  </cross-domain-access>
</access-policy> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T12:20:17.103

确保您的绑定包含 ServiceReferences.ClientConfig 中的标记 安全模式应该是 = Web 服务的 Https 访问的传输

```
<basicHttpBinding>
                <binding name="FactorSoap" maxBufferSize="2147483647" maxReceivedMessageSize="2147483647">
                    <security mode="Transport" />
                </binding>

</basicHttpBinding> 
```

# visual-studio-2008 - 使用 .net 3.5 MSBuild 和 NantContrib 运行构建

> ID：626774
> 
> 赞同：0
> 
> 时间：2009-03-09T15:43:52.673
> 
> 标签：visual-studio-2008, .net-3.5, msbuild, nant, nantcontrib

我注意到最初在 VS 2008 中创建的项目不能使用 nantcontrib msbuild 任务进行编译。我在[这里](https://stackoverflow.com/questions/5694/the-imported-project-cmicrosoftcsharptargets-was-not-found)看到了一个解决方案，但考虑到“MSBuildBinPath”已被贬低，我不完全喜欢在我创建的每个项目文件上更改此属性的想法。与 2008 年相比。

除了更改构建脚本以通过 exec 任务调用 msbuild 之外，有没有办法将 msbuild 任务指向特定版本的 MSBuild？也许这正在为 Nant 的下一个版本准备？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-29T18:55:38.023

还有另一种选择，直接调用 MsBuild.exe。

这是一个例子：

```
<property name="MSBuildPath" value="C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe"/>    
    <target name="build">
        <exec program="${MSBuildPath}">
            <arg line='"${SolutionFile}"' />
            <arg line="/property:Configuration=${SolutionConfiguration}" />
            <arg value="/target:Rebuild" />
            <arg value="/verbosity:normal" />
            <arg value="/nologo" />
        </exec>
    </target> 
```

如果你从 Cruise Control .NET 调用 Nant，你也可以添加这个参数：

```
<arg line='/logger:"C:\Program Files\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MsBuild.dll"'/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T15:57:17.883

Either use [this hack](http://codebetter.com/blogs/jeffrey.palermo/archive/2007/11/28/upgrade-nant-for-use-with-vs2008-solutions-and-net-3-5.aspx) or upgrade to [nant 0.86 beta-1 or newer](http://nant.sourceforge.net/nightly/latest/releasenotes.html)

# silverlight - Silverlight 自定义用户控件和依赖属性问题

> ID：626779
> 
> 赞同：1
> 
> 时间：2009-03-09T15:44:41.783
> 
> 标签：silverlight, user-controls

我有一个名为 Field 的自定义用户控件：

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>
    <TextBlock Grid.Row="0" Grid.Column="0" Name="LblName"/>
    <TextBox Grid.Row="0" Grid.Column="1" HorizontalContentAlignment="Left" Name="TxtValue"/>
</Grid> 
```

在 CS 文件中，我公开了以下属性，它只是设置了文本框的“.text”值。

```
 public static readonly DependencyProperty ValueProperty = DependencyProperty.Register(
        "Value",
        typeof(string),
        typeof(Field),
        new PropertyMetadata(
            default(string),
            (source, args) => (source as Field).TxtValue.Text = (string)args.NewValue
        )
    );

    [Category("Custom")]
    public string Value
    {
        get
        {
            return (string)this.GetValue(ValueProperty);
        }
        set
        {
            this.SetValue(ValueProperty, value);
        }
    } 
```

第一个问题。这是我们传播子用户控件依赖属性的正确方法，通过父用户控件进行备份，以便可以从页面 xaml 设置它？我在网上四处看看，考虑到这是编写自定义控件时相当原始的事情，没有太多内容。

提供有关大图的详细信息，我有客户详细信息页面，一些控件绑定到包含在可观察集合中的客户对象。如果我将页面上的文本框（包含在字段控件中）的值从“xxxx”更改为“yyyy”，我总是会返回“xxxx”。似乎吸气剂周围的某个地方出了问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-19T08:48:01.093

这绝对是朝着允许属性传播的正确方向迈出的一步。

如果这是一个真正的自定义控件（从 Control 派生），您`{TemplateBinding Value}`可能需要在 OnApplyTemplate 方法中设置模板部分后，连接到 TextBox 上的 TextChanged 事件。这样，您也可以让它更新您的基础 TxtValue 依赖属性。

如果这是一个 UserControl，您可能可以使用 Binding，但您可以使用的选项更少。正如您所拥有的，您的属性更改回调函数仅朝一个方向前进：您只设置 Text 值，您永远不会对其做出反应。

让我们希望那里的文档有所改进。

# vb.net - 为什么我不能在调用 myForm.close() 后创建新的表单实例？

> ID：626785
> 
> 赞同：0
> 
> 时间：2009-03-09T15:45:55.960
> 
> 标签：vb.net, exception

**[编辑]**
请参阅[这篇文章](https://stackoverflow.com/questions/615585/how-do-i-catch-events-on-runtime-objects)，了解我为什么要在全球范围内声明表单元素。

我选择重新连接我的代码以摆脱全局定义。
**[结束编辑]**

我在运行时动态创建一个 from 。表单、所有按钮和组合框都全局声明给父表单。

```
dim myForm as new form 
```

我在上面放了一些按钮和一个我正在填充东西的组合框。

我可以很好地显示表格

```
myForm.show()
myForm.bringToFront() 
```

第一次一切正常。

当用户完成 from 时，我调用：

```
myForm.close()
'have also tried
' myForm.Hide() and myForm.Dispose() 
```

无论哪种方式，（即使只调用 .close()）第二次创建表单时，我都会收到以下错误：

> ObjectDisposedException 未处理 无法访问已处置的对象。

如果我只是切换表单的可见性，则组合框值不会每次都被清除 - 设置可见性 = false 似乎是一种抱歉的做法。

为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T15:54:59.480

因为一旦您的表单关闭，就无法重新打开。

每次您想打开一个新表单时，您都必须将它重新分配给一个新的表单实例。如果您确实想要相同的实例， myForm.Show() 和 myForm.Hide() 应该可以工作，只要您从不调用 myForm.Close()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T15:58:37.537

我猜您的问题出在此处：“表单、所有按钮和组合框都已全局声明给父表单。”

您正在全局定义表单，因此垃圾收集器不会自动清除它，因为它始终在范围内。

要么不处理表单，要么停止将其用作全局变量。

# sql-server - 如何包含其他分组列

> ID：626788
> 
> 赞同：15
> 
> 时间：2009-03-09T15:46:19.983
> 
> 标签：sql-server, tsql

我加入了几个表，并通过 GROUP BY 聚合了一些列。这就是我对 MySQL 所做的，现在我将它们移植到 MSSQL。

一个简单的例子是员工和项目：

```
select empID, fname, lname, title, dept, count(projectID)
from employees E left join projects P on E.empID = P.projLeader
group by empID 
```

...这可以在 MySQL 中工作，但 MS SQL 更严格，并且要求所有内容都包含在聚合函数中或者是 GROUP BY 子句的一部分。

所以，当然，在这个简单的例子中，我假设我可以在 group by 子句中包含额外的列。但是我正在处理的实际查询非常复杂，并且包括对一些非聚合列执行的一系列操作......即，尝试将所有这些列都包含在 group by 子句中会变得非常难看.

那么有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-09T15:53:11.030

你可以让它与围绕这些行的东西一起工作：

```
select e.empID, fname, lname, title, dept, projectIDCount
from
(
   select empID, count(projectID) as projectIDCount
   from employees E left join projects P on E.empID = P.projLeader
   group by empID
) idList
inner join employees e on idList.empID = e.empID 
```

这样可以避免额外的 group by 操作，并且可以获得任何想要的数据。此外，您有更好的机会在某些情况下充分利用索引（如果您没有返回完整信息），并且可以更好地与分页结合使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-09T15:49:59.273

“尝试将它们全部包含在 group by 子句中会变得非常难看。”

是的 - 这是唯一的方法 * - 只需将非聚合列复制并粘贴到 group by 子句中，删除别名就可以了......

*您可以将其包装在嵌套的 SELECT 中，但这可能同样丑陋...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T15:51:16.743

MySQL 不同寻常——从技术上讲不符合 SQL 标准——允许您从 GROUP BY 子句中省略项目。在标准 SQL 中，选择列表中的每个非聚合列必须在 GROUP BY 子句中完整列出（按名称或按序号，但不推荐使用）。

（哦，虽然 MySQL 不寻常，但它允许速记是很好的。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-01T08:08:18.463

您不需要加入子查询，因为不需要根据员工的 empID 进行分组 - 您可以在项目的 projectLeader 字段上进行。

通过内部连接（如我所说），您将获得至少拥有一个项目的员工列表。如果您想要所有员工的列表，只需将其更改为左加入

```
 select e.empID, e.fname, e.lname, e.title, e.dept, p.projectIDCount
    from employees e 
   inner join ( select projLeader, count(*) as projectIDCount
                  from projects
                 group by projLeader
              ) p on p.projLeader = e.empID 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-13T07:26:47.010

select 子句中的子查询也可能是合适的。它适用于给出的示例，但可能不适用于您正在处理的实际复杂查询。

```
select
        e.empID, fname, lname, title, dept
        , (select count(*) from projects p where p.projLeader = e.empId) as projectCount
from
   from employees E 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-05-06T13:17:25.107

我将假定这`empID`是生成的连接语句中的唯一 id。如果是这种情况，您可以使用`distinct`来获得相同的结果。

```
select distinct empID, fname, lname, title, dept, count(projectID)
from employees E
left join projects P on E.empID = P.projLeader 
```

# javascript - 在javascript中将ú转换为u

> ID：626792
> 
> 赞同：1
> 
> 时间：2009-03-09T15:47:30.823
> 
> 标签：javascript, unicode, character-encoding

我如何在 javascript 中将 ú 转换为 u。对于其他非英语字符，我可能也需要它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T15:55:09.137

MovableType 有一个名为[dirify](http://www.movabletype.org/documentation/appendices/modifiers/dirify.html)的函数来执行此操作。 [这是](http://kalsey.com/2004/07/dirify_in_php/)一个PHP版本。这些本质上是大型查找表，因此将它们移至 JavaScript 应该很容易。

从理论上讲，您可以解析 Unicode 表并遵循字符引用，直到找到 ASCII，但这对您来说可能不实用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T15:56:21.567

已经提出了一个类似的问题（但在 .NET 上下文中）：[如何从 .NET 中的字符串中删除变音符号（重音符号）？](https://stackoverflow.com/questions/249087/how-do-i-remove-diacritics-accents-from-a-string-in-net)

我认为最简单的解决方案是制作一个映射表并为每个字符进行查找。您可以构建一个字符表，其中包含对应的“基本”字符的变音符号，将查找包装到一个函数中，您就可以开始了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T15:58:12.047

这是我在 Ruby 中执行此操作的函数的一个版本。转换javascript应该很简单。

[http://snippets.dzone.com/posts/show/2384](http://snippets.dzone.com/posts/show/2384)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T16:00:33.273

检查这个Englishizer

```
function Englishizer(var strIn)
{   
 var strOut
    var strMid
    var n 
    For int (n = 1; n<strIn.Length;n++)
{
        strMid = substring(strIn, n, 1)
        Select Case strMid.charCodeAt(0)
        Case 192 To 197:
            strMid = "A"
        Case 198:
            strMid = "AE"
        Case 199:
            strMid = "C"
        Case 200 To 203:
            strMid = "E"
        Case 204 To 207:
            strMid = "I"
        Case 208:
            strMid = "D"
        Case 209:
            strMid = "N"
        Case 210 To 214, 216:
            strMid = "O"
        Case 215:
            strMid = "x"
        Case 217 To 220:
            strMid = "U"
        Case 221:
            strMid = "Y"
        Case 222, 254:
            strMid = "p"
        Case 223:
            strMid = "B"
        Case 224 To 229:
            strMid = "a"
        Case 230:
            strMid = "ae"
        Case 231:
            strMid = "c"
        Case 232 To 235:
            strMid = "e"
        Case 236 To 239:
            strMid = "i"
        Case 240, 242 To 246, 248:
            strMid = "o"
        Case 241:
            strMid = "n"
        Case 249 To 252:
            strMid = "u"
        Case 253, 255:
            strMid = "y"

        Englishizer = Englishizer + strMid;
}
} 
```

# python - 如何使用 Python 找到 Windows 通用应用程序数据文件夹？

> ID：626796
> 
> 赞同：31
> 
> 时间：2009-03-09T15:48:55.827
> 
> 标签：python, windows, application-data, common-files

我希望我的应用程序存储一些数据以供所有用户访问。使用 Python，我怎样才能找到数据应该去哪里？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-09T16:12:41.823

如果您不想为诸如 winpaths 之类的第三方模块添加依赖项，我建议您使用 Windows 中已有的环境变量：

*   [**Windows 中有哪些环境变量可用？**](http://windowsitpro.com/article/articleid/23873/what-environment-variables-are-available-in-windows.html)

具体来说，您可能想要`ALLUSERSPROFILE`获取通用用户配置文件文件夹的位置，即应用程序数据目录所在的位置。

例如：

```
C:\> python -c "import os; print os.environ['ALLUSERSPROFILE']"
C:\Documents and Settings\All Users 
```

**编辑**：查看 winpaths 模块，它使用 ctypes，所以如果您只想使用代码的相关部分而不安装 winpath，您可以使用它（显然为简洁起见省略了一些错误检查）。

```
import ctypes
from ctypes import wintypes, windll

CSIDL_COMMON_APPDATA = 35

_SHGetFolderPath = windll.shell32.SHGetFolderPathW
_SHGetFolderPath.argtypes = [wintypes.HWND,
                            ctypes.c_int,
                            wintypes.HANDLE,
                            wintypes.DWORD, wintypes.LPCWSTR]

path_buf = wintypes.create_unicode_buffer(wintypes.MAX_PATH)
result = _SHGetFolderPath(0, CSIDL_COMMON_APPDATA, 0, 0, path_buf)
print path_buf.value 
```

示例运行：

```
C:\> python get_common_appdata.py
C:\Documents and Settings\All Users\Application Data 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-09-19T09:57:14.897

来自[http://snipplr.com/view.php?codeview&id=7354](http://snipplr.com/view.php?codeview&id=7354)

```
homedir = os.path.expanduser('~')

# ...works on at least windows and linux. 
# In windows it points to the user's folder 
#  (the one directly under Documents and Settings, not My Documents)

# In windows, you can choose to care about local versus roaming profiles.
# You can fetch the current user's through PyWin32.
#
# For example, to ask for the roaming 'Application Data' directory:
#  (CSIDL_APPDATA asks for the roaming, CSIDL_LOCAL_APPDATA for the local one)
#  (See microsoft references for further CSIDL constants)
try:
    from win32com.shell import shellcon, shell            
    homedir = shell.SHGetFolderPath(0, shellcon.CSIDL_APPDATA, 0, 0)

except ImportError: # quick semi-nasty fallback for non-windows/win32com case
    homedir = os.path.expanduser("~") 
```

要获取所有用户的 app-data 目录，而不是当前用户，只需使用`shellcon.CSIDL_COMMON_APPDATA`而不是`shellcon.CSIDL_APPDATA`.

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-09T15:58:23.700

看看[http://ginstrom.com/code/winpaths.html](http://ginstrom.com/code/winpaths.html)。这是一个简单的模块，它将检索 Windows 文件夹信息。该模块实现`get_common_appdata`为所有用户获取 App Data 文件夹。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T15:59:26.303

*由于与非美国版本的 Windows 和 Vista 不兼容，先前的答案被删除。*

**编辑：** 要扩展 Out Into Space 的答案，您将使用该 `winpaths.get_common_appdata`功能。`easy_install winpaths`您可以使用或转到 pypi 页面[http://pypi.python.org/pypi/winpaths/](http://pypi.python.org/pypi/winpaths/)并下载 .exe 安装程序来获取 winpath 。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-09T16:51:46.427

您可以使用模块`os.environ`中的字典访问所有操作系统环境变量`os`。但是，从该字典中选择使用哪个键可能很棘手。特别是，在使用这些路径时，您应该注意国际化（即非英语）版本的 Windows。

`os.environ['ALLUSERSPROFILE']`应该为您提供计算机上所有用户的根目录，但之后请注意不要硬编码子目录名称，如“应用程序数据”，因为这些目录在非英语版本的 Windows 上不存在。就此而言，您可能希望对可以期望设置 ALLUSERSPROFILE 环境变量的 Windows 版本进行一些研究（我自己也不知道——它可能是通用的）。

我这里的 XP 机器有一个 COMMONAPPDATA 环境变量，它指向 All Users\Application Data 文件夹，但是我的 Win2K3 系统没有这个环境变量。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-19T19:05:26.463

由于不推荐使用[SHGetFolderPath](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762181.aspx)，因此您还可以在 Vista 和更新版本中使用[SHGetKnownFolderPath 。](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762188.aspx)这也使您可以查找比 SHGetFolderPath 更多的路径。这是一个精简的示例（完整代码[可在 Gist 上找到](https://gist.github.com/mkropat/7550097)）：

```
import ctypes, sys
from ctypes import windll, wintypes
from uuid import UUID

class GUID(ctypes.Structure):   # [1]
    _fields_ = [
        ("Data1", wintypes.DWORD),
        ("Data2", wintypes.WORD),
        ("Data3", wintypes.WORD),
        ("Data4", wintypes.BYTE * 8)
    ] 

    def __init__(self, uuid_):
        ctypes.Structure.__init__(self)
        self.Data1, self.Data2, self.Data3, self.Data4[0], self.Data4[1], rest = uuid_.fields
        for i in range(2, 8):
            self.Data4[i] = rest>>(8 - i - 1)*8 & 0xff

class FOLDERID:     # [2]
    LocalAppData            = UUID('{F1B32785-6FBA-4FCF-9D55-7B8E7F157091}')
    LocalAppDataLow         = UUID('{A520A1A4-1780-4FF6-BD18-167343C5AF16}')
    RoamingAppData          = UUID('{3EB685DB-65F9-4CF6-A03A-E3EF65729F3D}')

class UserHandle:   # [3]
    current = wintypes.HANDLE(0)
    common  = wintypes.HANDLE(-1)

_CoTaskMemFree = windll.ole32.CoTaskMemFree     # [4]
_CoTaskMemFree.restype= None
_CoTaskMemFree.argtypes = [ctypes.c_void_p]

_SHGetKnownFolderPath = windll.shell32.SHGetKnownFolderPath     # [5] [3]
_SHGetKnownFolderPath.argtypes = [
    ctypes.POINTER(GUID), wintypes.DWORD, wintypes.HANDLE, ctypes.POINTER(ctypes.c_wchar_p)
] 

class PathNotFoundException(Exception): pass

def get_path(folderid, user_handle=UserHandle.common):
    fid = GUID(folderid) 
    pPath = ctypes.c_wchar_p()
    S_OK = 0
    if _SHGetKnownFolderPath(ctypes.byref(fid), 0, user_handle, ctypes.byref(pPath)) != S_OK:
        raise PathNotFoundException()
    path = pPath.value
    _CoTaskMemFree(pPath)
    return path

common_data_folder = get_path(FOLDERID.RoamingAppData)

# [1] http://msdn.microsoft.com/en-us/library/windows/desktop/aa373931.aspx
# [2] http://msdn.microsoft.com/en-us/library/windows/desktop/dd378457.aspx
# [3] http://msdn.microsoft.com/en-us/library/windows/desktop/bb762188.aspx
# [4] http://msdn.microsoft.com/en-us/library/windows/desktop/ms680722.aspx
# [5] http://www.themacaque.com/?p=954 
```

# sql-server - SQL 返回特定年份以来的年份列表

> ID：626797
> 
> 赞同：29
> 
> 时间：2009-03-09T15:49:23.363
> 
> 标签：sql-server, sql-server-2005, tsql

我需要一个年份列表作为从 2004 年到当前年份的记录集（按 desc 顺序），**而无需编写存储过程**。这可能吗？（SQL Server 2005）。所以它应该返回：

2009
2008
2007
2006
2005
2004

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2011-04-15T14:04:15.677

这是从 2004 年到现在的所有年份，使用递归 CTE：

```
with yearlist as 
(
    select 2004 as year
    union all
    select yl.year + 1 as year
    from yearlist yl
    where yl.year + 1 <= YEAR(GetDate())
)

select year from yearlist order by year desc; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T16:01:46.810

`ROW_NUMBER`在任何足够大（稳定）表的任何列上使用将是一种方法。

```
SELECT *
FROM (
  SELECT TOP 100 2003 + ROW_NUMBER() OVER (ORDER BY <AnyColumn>) AS Yr
  FROM dbo.<AnyTable>
  ) Years
WHERE Yr <= YEAR(GETDATE()) 
```

*请注意，它`<AnyTable>`至少应包含等于您需要的年数的行数。*

### 编辑（库多给约书亚）

*   最好选择一个您知道不会被截断和/或删除的表。`system table`应该想到一个足够大的。
*   目前，由于年龄更大、更聪明（至少年龄更大），我将使用`CTE`Joshua 给出的答案中提到的类似方法来实现这一要求。与当前给定的解决方案相比，该`CTE`技术要优越得多且不易出错`ROW_NUMBER`。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-09T16:03:36.043

更新为返回当年加上前 5 年。应该非常快，因为这是一个小记录集。

```
SELECT YEAR(GETDATE()) as YearNum
UNION
SELECT YEAR(GETDATE()) - 1 as YearNum
UNION
SELECT YEAR(GETDATE()) - 2 as YearNum
UNION
SELECT YEAR(GETDATE()) - 3 as YearNum
UNION
SELECT YEAR(GETDATE()) - 4 as YearNum
UNION
SELECT YEAR(GETDATE()) - 5 as YearNum
ORDER BY YearNum DESC 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T16:03:40.583

```
DECLARE @YEARS TABLE (Y INT)
DECLARE @I INT, @NY INT
SELECT @I = 2004, @NY = YEAR(GETDATE())
WHILE @I <= @NY BEGIN
    INSERT @YEARS SELECT @I
    SET @I = @I + 1
END
SELECT Y 
FROM @YEARS
ORDER BY Y DESC 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-09T15:57:40.987

试试这个：

```
 declare @lowyear int
set @lowyear = 2004
declare @thisyear int
set @thisyear = year(getdate())
while @thisyear >= @lowyear
begin
print @thisyear
set @thisyear = (@thisyear - 1)
end 
```

退货

```
2009
2008
2007
2006
2005
2004 
```

当您点击 2010 年 1 月 1 日时。将返回相同的代码：

```
2010
2009
2008
2007
2006
2005
2004 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-11-07T05:20:18.497

```
WITH n(n) AS
(
    SELECT 0
    UNION ALL
    SELECT n+1 FROM n WHERE n < 10
)
SELECT year(DATEADD( YY, -n, GetDate())) 
FROM n ORDER BY n 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T16:05:45.397

```
SET NOCOUNT ON
DECLARE @max int
set @max = DATEPART(year, getdate())

CREATE TABLE #temp (val int)

while @max >= 2004
  BEGIN
    insert #temp(val) values(@max)
    set @max = @max - 1
  END

SELECT * from #temp 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-18T08:41:24.103

这是一个简单的查询，检查一下

```
(SELECT REPLACE((TO_CHAR(SYSDATE,'YYYY')-Rownum)+1,' ',NULL) yr FROM dual CONNECT BY LEVEL < 32) year 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-11-09T14:20:42.087

我的两分钱：

CTE 是最好的答案，但我喜欢@Lieven Keersmaekers 的答案，因为它不依赖递归/循环或创建其他对象，例如函数/日期表。关键的变化是我简单地使用带有表达式的 Top 子句，而不是前 100 个（基本上是整个表），我首先要求 N 个**无序**行。如果您的基表恰好很大，这会更快。

在 SQL Server 2016 上测试

```
DECLARE @startYear smallint;
SET @startYear = 2004;

DECLARE @endYear smallint;
SET @endYear = YEAR(GETDATE());

-- Top uses expression to bring in N number of rows. The (@startYear - 1) is to retain the start year
SELECT [Yr]
FROM (
    SELECT TOP (@endYear - (@startYear - 1)) 
          COUNT([object_id]) OVER (ORDER BY [object_id] DESC) + (@startYear - 1) AS [Yr] -- Add initial start year to Count
    FROM sys.all_objects
) AS T1
ORDER BY [Yr] DESC 
```

上面的评论是有效的，但是由于 OP 的要求实际上是 2004 年的一小部分值，因此 sys.all_objects 就足够了，因为 SQL Server 安装附带了大量的系统对象。

希望这是一个不同的看法。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-09T15:58:34.650

我认为您需要创建一个日期表，然后从中选择您的范围。当您需要选择一个附有 X 数据且没有任何错过天数的日期范围时，它也很有用。

# asp.net - 更改 ASP.Net 版本时 IIS 服务不可用

> ID：626799
> 
> 赞同：2
> 
> 时间：2009-03-09T15:49:49.837
> 
> 标签：asp.net, iis, iis-6

当我将 IIS 6 中 Web 应用程序的 ASP.Net 版本从 ASP.Net 1.1 更改为 2.0 时。IIS 中的所有站点在短时间内（在 IIS 对话框中应用更改所需的时间）变得“不可用”（Service Unavailable）。

我检查了应用程序池，但这些站点都在不同的应用程序池中......

怎么会这样？

当我更改一个应用程序的 ASP.Net 版本时，这应该不会影响其他应用程序吧？

提前致谢，

雷姆科

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T19:36:50.350

IIS 管理器中的 .Net 选项卡实际上非常危险 - 它会在任何更改时抛出 IISReset，有时也只是出于恶意:-)

[Scott Forsyth](http://weblogs.asp.net/owscott/default.aspx)有一篇题为[IIS 中的 ASP.NET 选项卡的博客文章，比最初看起来更危险！](http://weblogs.asp.net/owscott/archive/2008/08/01/asp-net-tab-in-iis-more-dangerous-than-it-first-appears.aspx)详细说明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T16:51:53.697

显然，您可以使用“Aspnet_regiis.exe”更改 IIS 之外的框架版本以避免此问题。这里有更多信息：

[http://forums.asp.net/t/1174765.aspx](http://forums.asp.net/t/1174765.aspx)

编辑：感谢 Christopher 在评论中让我知道使用此工具与 IISReset 相同并且不能解决问题。:(

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-23T07:30:57.767

更改上点网框架中的主文件夹虚拟并在不同的池中使用。您不会获得服务不可用。

# c# - 对 TransactionScope 的使用进行单元测试

> ID：626802
> 
> 赞同：32
> 
> 时间：2009-03-09T15:50:44.093
> 
> 标签：c#, .net, unit-testing, transactions

**序言：** 我设计了一个强接口且完全可模拟的数据层类，它期望业务层[`TransactionScope`](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.aspx?ppud=4)在单个事务中包含多个调用时创建一个。

**问题：**我想对我的业务层`TransactionScope`在我期望的时候使用一个对象进行单元测试。

不幸的是，使用的标准模式`TransactionScope`如下：

```
using(var scope = new TransactionScope())
{
    // transactional methods
    datalayer.InsertFoo();
    datalayer.InsertBar();
    scope.Complete();
} 
```

虽然就程序员的可用性而言，这是一个非常好的模式，但测试它是否完成似乎……对我来说是不可能的。我无法检测到瞬态对象已被实例化，更不用说模拟它以确定对其调用了方法。然而，我的报道目标意味着我必须这样做。

**问题：**如何构建单元测试以确保`TransactionScope`根据标准模式正确使用？

**最后的想法：**我已经考虑过一种解决方案，它肯定会提供我需要的覆盖范围，但由于过于复杂且不符合标准`TransactionScope`模式而拒绝了它。它涉及`CreateTransactionScope`在我的数据层对象上添加一个方法，该方法返回一个`TransactionScope`. 但是由于 TransactionScope 包含构造函数逻辑和非虚拟方法，因此即使不是不可能模拟也很困难，因此`CreateTransactionScope`将返回一个实例，`DataLayerTransactionScope`该实例将是一个可模拟的外观到`TransactionScope`.

虽然这可能会完成这项工作，但它很复杂，我更喜欢使用标准模式。有没有更好的办法？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-09T22:07:21.487

我现在正面临同样的问题，对我来说似乎有两种解决方案：

1.  不要解决问题。
2.  为遵循相同模式但可模拟/可存根的现有类创建抽象。

**编辑：** 我现在为此创建了一个 CodePlex 项目：http: [//legendtransactions.codeplex.com/](http://legendtransactions.codeplex.com/)

我倾向于创建一组用于处理事务的接口和一个委托给 System.Transaction-implementations 的默认实现，例如：

```
public interface ITransactionManager
{
    ITransaction CurrentTransaction { get; }
    ITransactionScope CreateScope(TransactionScopeOption options);
}

public interface ITransactionScope : IDisposable
{
    void Complete();  
}

public interface ITransaction
{
    void EnlistVolatile(IEnlistmentNotification enlistmentNotification);
}

public interface IEnlistment
{ 
    void Done();
}

public interface IPreparingEnlistment
{
    void Prepared();
}

public interface IEnlistable // The same as IEnlistmentNotification but it has
                             // to be redefined since the Enlistment-class
                             // has no public constructor so it's not mockable.
{
    void Commit(IEnlistment enlistment);
    void Rollback(IEnlistment enlistment);
    void Prepare(IPreparingEnlistment enlistment);
    void InDoubt(IEnlistment enlistment);

} 
```

这似乎需要做很多工作，但另一方面它是可重用的，并且它使所有这些都非常容易测试。

请注意，这并不是接口的完整定义，足以让您了解全局。

**编辑：** 我只是做了一些快速而肮脏的实现作为概念证明，我认为这是我将采取的方向，这是我迄今为止提出的。我在想也许我应该为此创建一个 CodePlex 项目，这样问题就可以一劳永逸地解决。这不是我第一次遇到这种情况。

```
public interface ITransactionManager
{
    ITransaction CurrentTransaction { get; }
    ITransactionScope CreateScope(TransactionScopeOption options);
}

public class TransactionManager : ITransactionManager
{
    public ITransaction CurrentTransaction
    {
        get { return new DefaultTransaction(Transaction.Current); }
    }

    public ITransactionScope CreateScope(TransactionScopeOption options)
    {
        return new DefaultTransactionScope(new TransactionScope());
    }
}

public interface ITransactionScope : IDisposable
{
    void Complete();  
}

public class DefaultTransactionScope : ITransactionScope
{
    private TransactionScope scope;

    public DefaultTransactionScope(TransactionScope scope)
    {
        this.scope = scope;
    }

    public void Complete()
    {
        this.scope.Complete();
    }

    public void Dispose()
    {
        this.scope.Dispose();
    }
}

public interface ITransaction
{
    void EnlistVolatile(Enlistable enlistmentNotification, EnlistmentOptions enlistmentOptions);
}

public class DefaultTransaction : ITransaction
{
    private Transaction transaction;

    public DefaultTransaction(Transaction transaction)
    {
        this.transaction = transaction;
    }

    public void EnlistVolatile(Enlistable enlistmentNotification, EnlistmentOptions enlistmentOptions)
    {
        this.transaction.EnlistVolatile(enlistmentNotification, enlistmentOptions);
    }
}

public interface IEnlistment
{ 
    void Done();
}

public interface IPreparingEnlistment
{
    void Prepared();
}

public abstract class Enlistable : IEnlistmentNotification
{
    public abstract void Commit(IEnlistment enlistment);
    public abstract void Rollback(IEnlistment enlistment);
    public abstract void Prepare(IPreparingEnlistment enlistment);
    public abstract void InDoubt(IEnlistment enlistment);

    void IEnlistmentNotification.Commit(Enlistment enlistment)
    {
        this.Commit(new DefaultEnlistment(enlistment));
    }

    void IEnlistmentNotification.InDoubt(Enlistment enlistment)
    {
        this.InDoubt(new DefaultEnlistment(enlistment));
    }

    void IEnlistmentNotification.Prepare(PreparingEnlistment preparingEnlistment)
    {
        this.Prepare(new DefaultPreparingEnlistment(preparingEnlistment));
    }

    void IEnlistmentNotification.Rollback(Enlistment enlistment)
    {
        this.Rollback(new DefaultEnlistment(enlistment));
    }

    private class DefaultEnlistment : IEnlistment
    {
        private Enlistment enlistment;

        public DefaultEnlistment(Enlistment enlistment)
        {
            this.enlistment = enlistment;
        }

        public void Done()
        {
            this.enlistment.Done();
        }
    }

    private class DefaultPreparingEnlistment : DefaultEnlistment, IPreparingEnlistment
    {
        private PreparingEnlistment enlistment;

        public DefaultPreparingEnlistment(PreparingEnlistment enlistment) : base(enlistment)
        {
            this.enlistment = enlistment;    
        }

        public void Prepared()
        {
            this.enlistment.Prepared();
        }
    }
} 
```

这是一个依赖 ITransactionManager 来处理它的事务工作的类的示例：

```
public class Foo
{
    private ITransactionManager transactionManager;

    public Foo(ITransactionManager transactionManager)
    {
        this.transactionManager = transactionManager;
    }

    public void DoSomethingTransactional()
    {
        var command = new TransactionalCommand();

        using (var scope = this.transactionManager.CreateScope(TransactionScopeOption.Required))
        {
            this.transactionManager.CurrentTransaction.EnlistVolatile(command, EnlistmentOptions.None);

            command.Execute();
            scope.Complete();
        }
    }

    private class TransactionalCommand : Enlistable
    {
        public void Execute()
        { 
            // Do some work here...
        }

        public override void Commit(IEnlistment enlistment)
        {
            enlistment.Done();
        }

        public override void Rollback(IEnlistment enlistment)
        {
            // Do rollback work...
            enlistment.Done();
        }

        public override void Prepare(IPreparingEnlistment enlistment)
        {
            enlistment.Prepared();
        }

        public override void InDoubt(IEnlistment enlistment)
        {
            enlistment.Done();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T19:07:10.733

忽略这个测试是否是一件好事......

非常肮脏的黑客是检查 Transaction.Current 不为空。

这不是一个 100% 的测试，因为有人可能会使用 TransactionScope 以外的东西来实现这一点，但它应该防止明显的“没有费心进行交易”部分。

另一种选择是故意尝试创建一个新的 TransactionScope，其隔离级别与将/应该使用的任何内容和`TransactionScopeOption.Required`. 如果这成功而不是抛出 ArgumentException 则没有事务。这需要你知道一个特定的 IsolationLevel 是未使用的（像 Chaos 之类的东西是一个潜在的选择）

这两个选项都不是特别令人愉快，后者非常脆弱并且受 TransactionScope 语义保持不变。我会测试前者而不是后者，因为它更健壮（并且易于阅读/调试）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-10-14T12:58:45.327

我找到了一种使用 Moq 和 FluentAssertions 进行测试的好方法。假设您的被测单元如下所示：

```
public class Foo
{
    private readonly IDataLayer dataLayer;

    public Foo(IDataLayer dataLayer)
    {
        this.dataLayer = dataLayer;
    }

    public void MethodToTest()
    {
        using (var transaction = new TransactionScope())
        {
            this.dataLayer.Foo();
            this.dataLayer.Bar();
            transaction.Complete();
        }
    }
} 
```

您的测试将如下所示（假设 MS 测试）：

```
[TestClass]
public class WhenMethodToTestIsCalled()
{
    [TestMethod]
    public void ThenEverythingIsExecutedInATransaction()
    {
        var transactionCommitted = false;
        var fooTransaction = (Transaction)null;
        var barTransaction = (Transaction)null;

        var dataLayerMock = new Mock<IDataLayer>();

        dataLayerMock.Setup(dataLayer => dataLayer.Foo())
                     .Callback(() =>
                               {
                                   fooTransaction = Transaction.Current;
                                   fooTransaction.TransactionCompleted +=
                                       (sender, args) =>
                                       transactionCommitted = args.Transaction.TransactionInformation.Status == TransactionStatus.Committed;
                               });

        dataLayerMock.Setup(dataLayer => dataLayer.Bar())
                     .Callback(() => barTransaction = Transaction.Current);

        var unitUnderTest = new Foo(dataLayerMock.Object);

        unitUnderTest.MethodToTest();

        // A transaction was used for Foo()
        fooTransaction.Should().NotBeNull();

        // The same transaction was used for Bar()
        barTransaction.Should().BeSameAs(fooTransaction);

        // The transaction was committed
        transactionCommitted.Should().BeTrue();
    }
} 
```

这对我的目的很有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T15:56:59.273

我是一名 Java 开发人员，所以我不确定 C# 的细节，但在我看来，你需要在这里进行两个单元测试。

第一个应该是成功的“蓝天”测试。您的单元测试应确保所有 ACID 记录在事务提交后出现在数据库中。

第二个应该是执行 InsertFoo 操作然后在尝试 InsertBar 之前抛出异常的“古怪”版本。成功的测试将表明异常已被抛出，并且 Foo 和 Bar 对象都没有提交到数据库。

如果这两个都通过，我会说您的 TransactionScope 正在正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-20T13:55:56.717

在自己考虑过同样的问题后，我得出了以下解决方案。

将模式更改为：

```
using(var scope = GetTransactionScope())
{
    // transactional methods
    datalayer.InsertFoo();
    datalayer.InsertBar();
    scope.Complete();
}

protected virtual TransactionScope GetTransactionScope()
{
    return new TransactionScope();
} 
```

当你需要测试你的代码时，你继承了被测类，扩展了函数，所以你可以检测它是否被调用。

```
public class TestableBLLClass : BLLClass
    {
        public bool scopeCalled;

        protected override TransactionScope GetTransactionScope()
        {
            this.scopeCalled = true;
            return base.GetTransactionScope();
        }
    } 
```

然后，您在类的可测试版本上执行与 TransactionScope 相关的测试。

# .net - 以编程方式隐藏 PropertyGrid 中的字段

> ID：626803
> 
> 赞同：3
> 
> 时间：2009-03-09T15:50:59.503
> 
> 标签：.net, vb.net, attributes, propertygrid, componentmodel

使用

```
<System.ComponentModel.TypeConverter(GetType(System.ComponentModel.ExpandableObjectConverter))> _ 
```

关于由数字属性组成的类（它是另一个类的属性）的声明。

我简单地加载这个类的一个实例......

```
PropertyGrid1.SelectedObject = oColumn 
```

显然我不想在代码中手动构建 propertygrid，我知道该怎么做。

但这就是问题所在。根据属性的值，某些其他属性不应该是可见的，就好像我使用了

```
<System.ComponentModel.Browsable(False)> _ 
```

属性声明上的属性。

无论如何以编程方式执行此操作，而无需手动处理属性网格的所有构建>

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-07-31T01:40:02.007

其实这完全有可能。第一种也是最简单的方法是设置网格的 BrowsableAttributes 属性：

```
propGraph.BrowsableAttributes = new AttributeCollection(
    new Attribute[] 
    { 
        new CategoryAttribute("Appearance")
    }); 
```

这将过滤掉所有与您提供的属性类型不匹配的属性。不幸的是，这是一个积极的过滤器，而不是一个消极的过滤器，这使得它不太有用恕我直言。

其次，同样容易，您可以在要在 PropertyGrid 中显示的对象周围创建一个简单的包装器，然后重新定义要隐藏/等的任何属性。作为直通属性：

```
public class MyDerivedControl : public TextBox
{
    [Browsable(false)]
    [Category("MyCustomCategory")]
    public new bool Enabled
    {
         get { return base.Enabled }
         set { base.Enabled = value; }
    }
} 
```

将其弹出到属性网格中，启用属性将被隐藏。

第三，您可以自定义 PropertyGrid 本身并进入类型描述符的世界等等，但如果您只想隐藏几个属性，那就太矫枉过正了。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T14:22:21.410

如果您希望使用 gridItem.Hide() 那么答案是否定的。在 MS PropertyGrid 中实现这一点的唯一方法是通过 TypeConverter 或自定义类型描述符（实现 ICustomTypeDescriptor）的 GetProperties 方法动态发布您的属性。我会先尝试使用 TypeConverter（特别是如果您要检查的属性值处于同一级别），需要做的编码更少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T09:37:22.680

至于 C++，这是一个简单的解决方案，可以在`propertyGrid`.

```
cli::array<Attribute^,1>^ attrs = {gcnew CategoryAttribute("Appearance")};
this->PropertyGrid->BrowsableAttributes = gcnew AttributeCollection(attrs);
this->PropertyGrid->SelectedObject = this->SelectedControl; 
```

这将仅在 propertyGrid 中显示“外观”类别并隐藏所有其他类别。假设您可以自己翻译 C# 中的代码。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2010-07-15T21:35:31.417

[这个问题](https://stackoverflow.com/questions/2319914/programmatically-hiding-properties-in-a-propertygrid/3260257#3260257)类似，但答案更完整。有些人可能希望交叉引用。

# c# - 让这个 Win32 互操作代码在 Mono 下工作？

> ID：626807
> 
> 赞同：0
> 
> 时间：2009-03-09T15:51:38.613
> 
> 标签：c#, interop, mono

所以我在 .NET 2.0 控制台应用程序中有这段代码：

```
[DllImport("kernel32.dll")]
private static extern bool SetConsoleTextAttribute(IntPtr hConsoleOutput, 
    int wAttributes);

[DllImport("kernel32.dll")]
private  static extern IntPtr GetStdHandle(uint nStdHandle);

private static readonly IntPtr hConsole; 
```

然后在一个方法中我有这个：

```
const uint STD_OUTPUT_HANDLE = 0xfffffff5;
hConsole = GetStdHandle(STD_OUTPUT_HANDLE); 
```

当我尝试在全新安装的 Ubuntu 8.10 上通过 Mono 执行这个应用程序时，我得到了这个异常：

```
Unhandled Exception: System.TypeInitializationException: 
An exception was thrown by the type initializer for 
    IMAPShell.Helpers.ColorConsole ---> 
        System.EntryPointNotFoundException: GetStdHandle
  at (wrapper managed-to-native) IMAPShell.Helpers.ColorConsole:GetStdHandle (uint)
  at IMAPShell.Helpers.ColorConsole..cctor () [0x00000] --- End of inner exception stack trace ---

  at IMAPShell.Program.PrintWelcome () [0x00000] 
  at IMAPShell.Program.Main (System.String[] args) [0x00000] 
```

基本上我正在做的是改变控制台输出的颜色。我编写了这个方便的方法，您可以将颜色代码嵌入到文本字符串中，它会解析代码并更改输出的颜色，直到它遇到另一个颜色代码。

它在 Windows 上工作得很好，我希望它在 Mono 下也能工作。有没有人对我可以尝试让它在两种操作系统下工作有什么建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-09T16:02:59.647

Mono 为您实现 .Net 框架。它没有实现 Windows API。PInvoke 只是使用 LoadLibrary 和 GetProcAddress 调用 Win32 API。你不能指望调用 Win32 API 的 PInvoke 可以在 Linux 上运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T15:58:26.350

你不能改用 Console.BackgroundColor 和 Console.Foreground 颜色吗？这样您就不需要通过互操作层。

# java - 最优雅的剪线方式？

> ID：626812
> 
> 赞同：3
> 
> 时间：2009-03-09T15:54:06.360
> 
> 标签：java, algorithm, geometry, clipping

我有一个 Rectangle2D 和一个 Line2D。我想“剪裁”这条线，以便只保留矩形内的那部分线。如果没有一条线在矩形内，我希望将线设置为 (0,0,0,0)。基本上类似于

```
Rectangle2D.intersect(Line2D src, Line2D dest) 
```

或类似的东西。

有没有办法用 java.awt.geom API 做到这一点？还是一种“手动”编码的优雅方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T16:16:41.737

的源代码[`Rectangle2D.intersectLine()`](http://docs.oracle.com/javase/8/docs/api/java/awt/geom/Rectangle2D.html#intersects-double-double-double-double-)可能会有所帮助：

```
public boolean intersectsLine(double x1, double y1, double x2, double y2) {
    int out1, out2;
    if ((out2 = outcode(x2, y2)) == 0) {
        return true;
    }
    while ((out1 = outcode(x1, y1)) != 0) {
        if ((out1 & out2) != 0) {
            return false;
        }
        if ((out1 & (OUT_LEFT | OUT_RIGHT)) != 0) {
            double x = getX();
            if ((out1 & OUT_RIGHT) != 0) {
                x += getWidth();
            }
            y1 = y1 + (x - x1) * (y2 - y1) / (x2 - x1);
            x1 = x;
        } else {
            double y = getY();
            if ((out1 & OUT_BOTTOM) != 0) {
                y += getHeight();
            }
            x1 = x1 + (y - y1) * (x2 - x1) / (y2 - y1);
            y1 = y;
        }
    }
    return true;
} 
```

其中`outcode()`定义为：

```
public int outcode(double x, double y) {
    int out = 0;
    if (this.width <= 0) {
        out |= OUT_LEFT | OUT_RIGHT;
    } else if (x < this.x) {
        out |= OUT_LEFT;
    } else if (x > this.x + this.width) {
        out |= OUT_RIGHT;
    }
    if (this.height <= 0) {
        out |= OUT_TOP | OUT_BOTTOM;
    } else if (y < this.y) {
        out |= OUT_TOP;
    } else if (y > this.y + this.height) {
        out |= OUT_BOTTOM;
    }
    return out;
} 
```

（来自[OpenJDK](http://hg.openjdk.java.net/jdk8/jdk8/jdk/file/687fd7c7986d/src/share/classes/java/awt/geom/Rectangle2D.java)）

将其更改为 clip 而不是返回 true 或 false 应该不难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T16:16:06.277

使用 AWT 没有什么好办法。您最好的选择是类似于[Cohen-Sutherland 算法](http://en.wikipedia.org/wiki/Cohen-Sutherland)。 [这是一个带有示例 Java 代码](http://shamimkhaliq.50megs.com/Java/lineclipper.htm)（lern2indent，amirite？）的链接，向您展示它是如何完成的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T15:55:28.793

通常要做的事情是在图形上下文中使用`Graphics2D.clip`. 您可能想要调用`Graphics.create`，以免干扰原始上下文。

```
Graphics2D g = (Graphics2D)gOrig.create();
try {
    g.clip(clip);
    ...
} finally {
    g.dispose();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T07:30:00.457

好吧，我最终自己做了。

对于那些有兴趣的人，我最终通过将线变成一个矩形（使用 getBounds）来解决它，然后使用`Rectangle.intersect(clipRect,lineRect,intersectLineRect)`它来创建交叉点，然后将交叉点重新变成一条线。

# wpf - WPF 中带有矢量图形的自定义用户控件

> ID：626815
> 
> 赞同：0
> 
> 时间：2009-03-09T15:54:20.730
> 
> 标签：wpf, wpf-controls

我已将用户控件的图形创建为矢量图形并将其导入到 Expression Design。到目前为止，一切正常，没有问题。但是我随后将其导出为 XAML 并在 VS 中打开它。XAML 由一个画布和几个路径组成。我在 XAML 中创建了一个用户控件，现在我想要一个鼠标单击事件，如果用户单击这些路径中的任何一个，就会触发该事件。我可以将相同的事件附加到每条路径，但是将路径分组会更优雅，有没有办法做到这一点？

我还问自己 WPF 是否可以使用标准格式的矢量图形，如 SVG。

在 XML 代码下方。

```
 <Canvas x:Name="Arrow" Width="40" Height="400" Canvas.Left="0" Canvas.Top="0">
    <Path Width="11.432" Height="361.1" Canvas.Left="12.861" Canvas.Top="-2.666" StrokeThickness="12" StrokeLineJoin="Round" Stroke="#FFFF2800" Data="F1 M 310,130.967L 310,480.067"/>
    <Path Width="6.75" Height="355.767" Canvas.Left="15.25" Canvas.Top="0" Stretch="Fill" StrokeThickness="6.66667" StrokeLineJoin="Round" Stroke="#FFFFFFFF" Data="F1 M 310,130.967L 310,480.067"/>
    <Path Width="22.725" Height="30.4" Canvas.Left="6.363" Canvas.Top="351.1" Stretch="Fill" StrokeThickness="2.66667" StrokeMiterLimit="2.75" Stroke="#FFFF2800" Fill="#FFFF2800" Data="F1 M 310,507.8L 320.4,480.067L 299.6,480.067"/>
    <Path Width="29.97" Height="2.667" Canvas.Left="4.107" Canvas.Top="2" Stretch="Fill" StrokeThickness="2.66667" StrokeMiterLimit="2.75" Stroke="#FFFF2800" Data="F1 M 296.133,130.967L 323.867,130.967"/>
    </Canvas> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T15:59:37.130

我没有时间来验证这一点，但在我的脑海中，如果你把你的事件放在画布上，并且没有为它指定背景，那么你应该只在用户点击时获得点击事件它包含的任何路径。

# php - YUI 自定义事件和同步动作

> ID：626816
> 
> 赞同：0
> 
> 时间：2009-03-09T15:54:29.433
> 
> 标签：php, javascript, events, yui

我正在开发一个必须通过 AJAX 执行两个单独检查的 JavaScript 应用程序。根据每次检查的结果，行为会有所不同。我在这里感兴趣的案例是两项检查都成功的情况。我已经确定了一些方法来做到这一点，我想从 SO 那里得到一些关于他们认为最好的方法是什么的反馈。

1.  同步 AJAX 调用：这是我继承的，它已经消失了。它会导致浏览器和系统锁定，尽管它确实允许您在单个执行线程中处理响应。
2.  菊花链：进行 AJAX 调用以执行第一次检查，如果通过，则在第一次检查的回调中进行第二次检查。处理第二次检查，如果通过，我们就成功了。这是最直接的解决方案，但它看起来不必要地将我的两个检查结合起来。我也觉得序列化我的检查是不必要的，并且会降低性能。
3.  自定义事件：使用 YUI 的[事件](http://developer.yahoo.com/yui/event/)模块和自定义事件实用程序，同时触发两个 AJAX 调用。为每个成功案例创建一个自定义事件，并让处理 AJAX 响应的回调为每次成功检查抛出适当的事件。然后每个事件的处理程序可以订阅另一个事件，如果它被抛出，那么我们已经成功完成。

我的问题与我喜欢的第三种方法有关。我喜欢这样一个事实，即我的处理程序仅通过抛出的事件进行连接，并且 AJAX 调用可以同时发生。我想知道的是，有没有其他人以这种方式使用过这个模块？我可以期待什么样的陷阱？我担心我可能已经为比赛条件做好了准备——我该如何缓解这种情况？最后，对于读到这里的任何人，有没有更好的方法？我的清单是不是详尽无遗，还是设计存在根本缺陷？建设性的批评和评论非常受欢迎。

编辑：虽然服务器请求确实使用会话，但它们彼此无关并且不写入会话数据，因此它们没有理由不在服务器上并行发生（除非 PHP 会话有一些我不知道的限制关于）。我们也进行服务器端检查，但我们发现在某些重要事件之前，我们需要立即与服务器进行检查，以便在极少数情况下通知用户某些事情发生了变化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T20:28:38.247

你没有说明你有什么服务器端？出于几个务实的原因，我个人赞成选项 2。

1.  跨浏览器意味着支持 IE，而 IE 只允许向服务器发送 2 个未完成的请求。我会避免以这种方式同时使用它们，这可能会导致浏览器明显锁定，虽然没有使用同步请求那么严重，但仍然很糟糕。

2.  通常，此类请求将运行使用某种会话的服务器端代码，这反过来又倾向于将请求限制为按顺序处理，因此无法实现所需的性能增益。

您需要这两个结果，因此该要求是在它们之间创建耦合，如果您编写一个这样的代码，可以选择链接到另一个是其设计的一部分，它知道具体为什么应该足够解耦。

# ftp - 在协议设计中，为什么要使用 2 个端口？

> ID：626823
> 
> 赞同：29
> 
> 时间：2009-03-09T15:56:02.097
> 
> 标签：ftp, protocols, network-protocols

当 TCP 服务器在端口上接受套接字时，它会获得一个新的套接字来与该客户端一起工作。
接受套接字对该端口仍然有效，并且可以接受该端口上的更多客户端。

为什么最初的 FTP 规范[RFC 959](http://www.faqs.org/rfcs/rfc959.html)决定同时创建控制端口和数据端口？

**在类似的自定义协议中是否有任何理由这样做？**

在我看来，这可以很容易地在单个端口上指定。

考虑到防火墙和带有 FTP 的 NATS 的所有问题，似乎单个端口会好得多。

对于一般协议实现，我认为您想要这样做的唯一原因是您可以从不同于命令的主机提供文件。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-09T16:01:17.360

这背后的最初理由是，您可以：

*   在传输数据时继续在控制连接上发送和接收控制指令。
*   同时激活多个数据连接。
*   服务器决定何时准备好向您发送数据。

诚然，他们可以通过指定一个集成到 FTP 协议的复杂多路复用协议来获得相同的结果，但由于当时 NAT 不是问题，他们选择使用已经存在的 TCP 端口。

这是一个例子：

Alice 想要 Bob 的两个文件。Alice 连接到 Bob 端口 21 并请求文件。Bob 准备好后打开与 Alice 端口 20 的连接并将文件发送到那里。同时，Charles 需要 Alice 服务器上的文件。Charles 连接到 Alice 上的 21 并请求文件。Alice 准备好后连接到 Charles 的 20 端口，并发送文件。

如您所见，端口 21 用于客户端连接到服务器，端口 20 用于连接到客户端的服务器，但这些客户端仍然可以在 21 上提供文件。

两个端口的用途完全不同，为了简单起见，他们选择使用两个不同的端口而不是实现协商协议。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T16:02:22.987

因为 FTP 允许单独的控制和数据。IIRC，按照最初的设计，您可以有 3 个主机：主机 A 可以要求主机 B 向主机 C 发送数据。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-09T16:11:02.000

FTP 是在现代防火墙的愚蠢程度难以想象的时候设计的。TCP 端口用于此功能；在单个 IP 上多路复用多个连接。它们*不能替代*访问控制列表。它们也不*打算*将 IPv4 扩展到 48 位地址。

任何新的非 IPv6 协议都必须处理当前的混乱，因此它应该坚持一个小的连续端口范围。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-09T16:01:30.010

FTP 有很长的历史，早在 70 年代初期，它就是最早的 ARPANET 协议之一（例如，参见[1971 年的 RFC114](http://www.faqs.org/rfcs/rfc114.html)）。现在可能看起来很奇怪的设计决策在那时更有意义。连接速度要慢得多，并且使用可用的网络技术执行“带外”连接控制似乎是一个不错的举措。

当前的[RFC959](http://www.faqs.org/rfcs/rfc959.html)包含一个很好的历史部分，链接到早期的 RFC，如果你想做一点考古学的话……

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-09T16:05:59.750

与许多较旧的有线协议一样，FTP 适合人类使用。也就是说，从终端会话中使用 FTP 非常容易。FTP 的设计者预计用户可能希望在数据传输时继续使用远程主机。如果命令和数据通过同一个通道，这将很困难。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-09T17:05:36.003

IETF 已经禁止为新协议分配多个端口的做法，因此我们将来可能不会看到这种情况。

较新的 IP 协议（​​如 SCTP）旨在解决 TCP 可能导致使用多个端口的一些缺点。TCPs 'head-of-line' 阻塞可以防止你有多个单独的请求/流在运行，这对于某些实时应用程序来说可能是一个问题。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-09T17:06:17.390

IIRC，问题不在于 FTP 使用两个（即多个）端口。问题是控制连接是由客户端发起的，而数据通道是由服务器发起的。FTP 和 HTTP 之间最大的区别在于，在 HTTP 中，客户端拉取数据，而在 FTP 中，服务器推送数据。NAT 问题与通过不知道预期连接的防火墙推送数据的服务器有关。

FTP 使用单独的端口进行控制和数据是相当优雅的恕我直言。想想 HTTP 中围绕控制和数据多路复用的所有令人头疼的问题——想想尾随标头、围绕流水线请求的规则、连接保持活动等等。通过明确分离控制和数据可以避免大部分情况，更不用说可以做一些有趣的事情，比如加密一个而不是另一个，或者使控制通道具有比数据更高的 QoS。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-09T16:00:13.400

FTP是一个古老的协议。这真的是唯一的原因。设计人员认为数据端口上流过的数据量会使其无法及时发送控制命令，因此将其作为两个端口进行。防火墙，尤其是 NAT，出现的时间要晚得多。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-09T16:40:28.077

你应该看看 RTSP + RTP 协议。这是一个类似的设计：每个流可以在不同的端口上发送，关于抖动、重新排序等的统计信息在另一个端口上发送。

另外，由于它是UDP，因此没有连接。然而，它是在防火墙已经有些平庸（对不起我的英语）时开发的，因此开发了一种模式，所有这些连接都可以嵌入到一个具有 HTTP 语法的 TCP 连接中。

你猜怎么了 ？多端口协议比 http 多路复用协议更简单（IMO）实现，并且它具有更多功能。如果你不关心防火墙问题，既然已经存在一个（TCP端口），为什么还要选择复杂的复用方案呢？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-09T16:01:51.133

我认为他们这样做是为了在发生传输时您可以继续使用服务器并轻松开始新的传输（如果您的客户端可以支持的话）。

请注意，被动模式几乎可以解决所有防火墙/NAT 问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-09T16:00:22.743

在我看来，这首先只是一个糟糕的设计选择。在它被发明的旧时代，防火墙和 NAT 不存在……如今，真正的问题是“为什么人们还要使用 FTP”？FTP 所做的一切都可以使用 HTTP 以更好的方式完成。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-03-27T14:51:19.447

![看到这张图片](https://i.stack.imgur.com/p2AaI.png)

当用户启动与远程主机的 FTP 会话时，FTP 首先在服务器端口号 21 上建立控制 TCP 连接。FTP 的客户端通过此控制连接发送用户标识和密码。FTP 的客户端还通过控制连接发送更改远程目录的命令。

当用户请求文件传输（到远程主机或从远程主机传输）时，FTP 在服务器端口号 20 上打开 TCP 数据连接。FTP 通过数据连接仅发送一个文件，然后关闭数据连接。如果在同一会话期间，用户想要传输另一个文件，则 FTP 会打开另一个数据 TCP 连接。因此，对于 FTP，控制连接在整个用户会话期间保持打开状态，但会为会话内传输的每个文件创建一个新的数据连接（即，数据连接是非持久的）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-06-11T12:05:27.823

在 FTP 的情况下，它不仅是一个不同的端口，而且可能是一个不同的主机，这可能是因为[RFC 959](https://datatracker.ietf.org/doc/html/rfc959)中的这一点：

```
In another situation a user might wish to transfer files between

two hosts, neither of which is a local host. The user sets up

control connections to the two servers and then arranges for a

data connection between them. In this manner, control information

is passed to the user-PI but data is transferred between the

server data transfer processes. Following is a model of this

server-server interaction.

                    Control     ------------   Control 
                    ---------->| User-FTP |<----------- 
                    |          | User-PI  |           | 
                    |          |   "C"    |           | 
                    V          ------------           V 
            --------------                        -------------- 
            | Server-FTP |   Data Connection      | Server-FTP | 
            |    "A"     |<---------------------->|    "B"     | 
            -------------- Port (A)      Port (B) -------------- 

                                 Figure 2 
The protocol requires that the control connections be open while

data transfer is in progress. It is the responsibility of the

user to request the closing of the control connections when

finished using the FTP service, while it is the server who takes

the action. The server may abort data transfer if the control

connections are closed without command. 
```

# mysql - 如何将 Dreamweaver 连接到在 Virtualbox 中运行的 mySQL

> ID：626833
> 
> 赞同：0
> 
> 时间：2009-03-09T15:57:34.230
> 
> 标签：mysql, dreamweaver, virtualbox

我无法将 CS3 Dreamweaver 连接到在 Sun Virtual Box 中运行的 mySQL 数据库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T16:11:16.897

您的 VBox 是否可以访问外部世界？尝试从 vm ping google；如果一切正常，则执行 ifconfig（或 Windows 上的 ipconfig）并查看您的 vm 是否有 IP。如果没有，那么您需要分配一个（或通过路由器的 DHCP 获取一个）。一旦你有了一个，检查你是否可以 ssh/telnet 进入。如果可以，那么你应该能够访问 mysql，前提是没有任何防火墙阻止该端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T13:08:05.970

来宾虚拟机很容易连接到主机的网络，但我没有尝试从主机连接到来宾。看起来您可以在来宾 VM 中打开一个网络接口：

[http://georgelantz.com/2007/11/27/virtualbox-host-interface-networking-windows-host-ubuntu-guest/](http://georgelantz.com/2007/11/27/virtualbox-host-interface-networking-windows-host-ubuntu-guest/)

VMWare Player 开箱即用，但我在找到 Virtualbox 后不再使用它。

# python - 是否可以从解释器中运行的 python 代码写入 sys._getframe() 返回的 python 框架对象？

> ID：626835
> 
> 赞同：2
> 
> 时间：2009-03-09T15:57:39.270
> 
> 标签：python, introspection, frame, sys

关于[这个问题](https://stackoverflow.com/questions/541329/is-it-possible-to-programmatically-construct-a-python-stack-frame-and-start-execu)，解释器中有一些脚手架来检查框架对象，可以通过`sys._getframe()`. 框架对象似乎是只读的，但我在明确说明这一点的文档中找不到任何明显的东西。有人可以确认这些对象是可写的（以某种方式）还是只读的？

```
import sys

def foobar():
    xx='foo'
    ff = sys._getframe()
    ff.f_locals['xx'] = 'bar'
    print xx

if __name__ == '__main__':
    foobar() 
```

这会在运行时打印出 ' `foo`'，但下面的帖子演示了在交互式 shell 中从当前帧运行时该变量是可写的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-09T16:15:24.097

来自 CPython 源代码`Objects/frameobject.c`：

```
static PyMemberDef frame_memberlist[] = {
    {"f_back",      T_OBJECT,       OFF(f_back),    RO},
    {"f_code",      T_OBJECT,       OFF(f_code),    RO},
    {"f_builtins",  T_OBJECT,       OFF(f_builtins),RO},
    {"f_globals",   T_OBJECT,       OFF(f_globals), RO},
    {"f_lasti",     T_INT,          OFF(f_lasti),   RO},
    {"f_exc_type",  T_OBJECT,       OFF(f_exc_type)},
    {"f_exc_value", T_OBJECT,       OFF(f_exc_value)},
    {"f_exc_traceback", T_OBJECT,   OFF(f_exc_traceback)},
    {NULL}    /* Sentinel */
};
...
static PyGetSetDef frame_getsetlist[] = {
    {"f_locals",    (getter)frame_getlocals, NULL, NULL},
    {"f_lineno",    (getter)frame_getlineno,
                    (setter)frame_setlineno, NULL},
    {"f_trace",     (getter)frame_gettrace, (setter)frame_settrace, NULL},
    {"f_restricted",(getter)frame_getrestricted,NULL, NULL},
    {0}
}; 
```

对于`PyMemberDef`，标志`RO`或`READONLY`意味着它的属性是只读的。对于`PyGetSetDef`，如果它只有一个吸气剂，它是只读的。这意味着除了 、 和 之外的所有属性`f_exc_type`在创建`f_exc_value`后都是只读的。这也在文档中的[Data model](http://docs.python.org/reference/datamodel.html#index-1767)下提到。`f_exc_traceback``f_trace`

属性引用的对象不一定是只读的。你可以这样做：

```
>>> f = sys._getframe()
>>> f.f_locals['foo'] = 3
>>> foo
3
>>> 
```

尽管这在解释器中有效，但在函数内部却失败了。执行引擎为局部变量（ ）使用单独的数组，`f_fastlocals`该数组在访问时被合并`f_locals`，但反之则不成立。

```
>>> def foo():
...   x = 3
...   f = sys._getframe()
...   print f.f_locals['x']
...   x = 4
...   print f.f_locals['x']
...   d = f.f_locals
...   x = 5
...   print d['x']
...   f.f_locals
...   print d['x']
...
>>> foo()
3
4
4
5
>>> 
```

在全局框架上，`f_local`引用`f_globals`，这使得这个技巧在解释器中起作用。修改`f_globals`有效，但会影响整个模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T17:08:37.307

NXC 的 f_locals['foo'] 示例有效，因为代码在模块范围内。在这种情况下，f_locals 是 f_globals，而 f_globals 是可修改的，修改会反映在模块中。

在函数范围内，locals() 和 f_locals 是可写的，但是“[更改可能不会影响解释器使用的局部变量的值]。” [1](http://docs.python.org/library/functions.html#locals)这是一种实施选择。在 CPython 中，有一个针对局部变量的优化字节码 LOAD_FAST。在 Python 中，一旦定义了函数，局部变量（几乎总是）是已知的，并且 CPython 使用索引查找来获取变量值，而不是字典查找。

从理论上讲，字典查找可以代理该表，但这是一项收效甚微的工作。

“已知局部变量”的例外情况是函数使用 exec 语句，以及不推荐使用的“from module import *”。对于这些情况，生成的字节码是不同的，而且速度较慢。

# c++ - 初始化 COM 对象 / 将 VB 代码翻译成 C++

> ID：626849
> 
> 赞同：1
> 
> 时间：2009-03-09T15:59:32.120
> 
> 标签：c++, com

任何人都可以将以下代码翻译成 C++ 吗？这是可能的还是缺少重要信息？

```
调暗激光作为物体
子启用激光
    ' 如果尚未完成，则创建一个激光对象
    如果激光什么都不是
       设置激光 = CreateObject("NWLaserXControl.NWLaserX")
    万一
    If Laser.Initialize Then
       Laser.RepRate = 10 ' 设置重复频率为 10Hz
       Laser.LaserEnabled = True ' 开启激光电源，准备就绪
    万一
结束子

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T16:04:26.430

```
// if (CoInitialize(0) == S_OK)
{
    CComPtr<INWLaserX> pMyPtr = NULL;

    CLSID clsid = IID_NULL;
    CLSIDFromProgID("NWLaserXControl.NWLaserX");

    if (pMyPtr.CoCreateInstance(clsid) == S_OK)
    {
         pMyPtr->put_RepRate(10);
         pMyPtr->put_LaserEnabled(TRUE);
    }

   // CoUnInitialize();
} 
```

# php - jquery：在不同选择上具有不同输出的选择框

> ID：626857
> 
> 赞同：0
> 
> 时间：2009-03-09T16:01:01.820
> 
> 标签：php, jquery, date

我试图让输入框根据用户从选择框中的选择显示不同的日期。如果用户选择今天今天日期应该显示如果明天，明天的日期。

我的问题是如何让选择框显示正确的日期？

```
<?php 
$tomorrow  = date("Y-m-d", mktime(0, 0, 0, date("m")  , date("d")+2, date("Y")));
$today = date("Y-m-d", mktime(0, 0, 0, date("m")  , date("d"), date("Y")));
?>

<script>
$(document).ready(function(){

$("#select-bil").change(function () {
<?php                                 
echo      'var datum = "'.$tomorrow.'";'
?>    
        var str ="";
        $("#select-bil option:selected").each(function () {
          });
      $("input[name$='div-one']").val(datum);
    })
    .change();
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T16:22:11.287

我想，这很容易

```
$('#select-option-for-today').val ('<?= $today ?>')
$('#select-option-for-tomororrow').val ('<?= $tomorrow ?>') 
```

（如果`<?=`在您的配置中不起作用，请尝试`<?php`回显相同）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T20:13:40.793

不完全确定你要做什么，试试这个

```
<?php
$tomorrow  = date("Y-m-d", mktime(0, 0, 0, date("m"), date("d")+1, date("Y")));
$today = date("Y-m-d", mktime(0, 0, 0, date("m"), date("d"), date("Y")));
?>

<script>
$(document).ready(function(){
    <?php
        echo 'var tomorrow = "'.$tomorrow.'";';
        echo 'var today = "'.$today.'";';
    ?>
    $("#select-bil>option:contains('today')").val(today);
    $("#select-bil>option:contains('tomorrow')").val(tomorrow);

    $("#select-bil").change(function () {
        $("input[name$='div-one']").val($("#select-bil option:selected").val());
    }).change();
});
</script>
<input name="div-one" />
<select id="select-bil">
 <option value="today">today</option>
 <option value="tomorrow">tomorrow</option>
 <option value="some other day">some other day</option>
</select> 
```

# c++ - 如何在 Pro*C 中保持较低的实施/维护成本？

> ID：626865
> 
> 赞同：1
> 
> 时间：2009-03-09T16:01:55.813
> 
> 标签：c++, c, oracle, oracle-pro-c

经历了 Oracle Pro*C 的可怕之处，在处理动态指定的列以及批量操作（ANSI METHOD 4）的需要时，我只想问：

您可以分享哪些想法/技术可以更轻松地开发/测试/调试/维护使用 Pro *C 或 Pro* C++ 的 C 和 C++ CRUD 应用程序？我对 Pro*C 方面特别感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T16:22:48.790

*   尽可能多地从 C 代码中提取出 Oracle 的内容，并将其粘贴到数据库 PL/SQL 包/过程/函数中。
*   在 C 代码中隔离（尽可能）Oracle 功能。你的 oracle 调用在你的 C 代码周围越分散越好。更好的是，拥有一个包含 Oracle 特定内容的库/DLL。

哦，别忘了半夜在祭坛上献一只山羊……

# ajax - JSP servlet 和 Ajax 的问题

> ID：626867
> 
> 赞同：2
> 
> 时间：2009-03-09T16:02:21.350
> 
> 标签：ajax, jsp, servlets

我有一个带有 Javascript 树控件的 JSP，我希望用户能够通过按一下按钮来隐藏或显示该树，并将这种状态更改传递到访问的其他页面，即如果在页面 A 上，用户隐藏树，然后在页面 B 上，树应该保持隐藏，依此类推，直到用户决定显示树。

为此，我使用 AJAX 在服务器上设置一个会话变量，该变量在加载页面时进行检查。现在，当相关页面的 URL 中没有查询字符串时，这可以正常工作。

但是有一个 URL 如下的页面：

> [http://localhost:8084/myApp/myAppPage?myAppParam=0](http://localhost:8084/myApp/myAppPage?myAppParam=0)

如果我调用显示/隐藏按钮，我会收到 Java NumberFormatException 错误，因为查询字符串丢失了。但是在此之后手动重新加载页面会显示更新了树的页面。

树的 HTML 构建在服务器上，并显示在每个页面的 HTML div 中。

我的理解是 AJAX 旨在仅更新页面的一部分，并且以这种方式编写页面仅允许更新 div 的内容。但我无法弄清楚为什么查询字符串会丢失。

我想知道 AJAX 是否试图强制重新加载整个页面？

我知道 AJAX 调用正确地到达了 servlet。但是 servlet 没有设置为调用另一个页面。

有没有人见过这个，你知道解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-12-15T11:58:00.363

每当您在初始请求的响应中触发 ajaxical 请求时，初始请求 URL 的查询字符串都不会自动传递。您必须自己将其附加到 ajaxical 请求的 URL。初始请求的查询字符串由[`window.location.search`](https://developer.mozilla.org/en/window.location).

```
var ajaxurl = '/someservlet' + window.location.search; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T02:15:01.940

John

Thanks for your reply.

I have partially fixed things now and it was to do with triggering the Ajax from a form button which must also have been doing an implicit page refresh.

Martin O'Shea.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T16:23:55.730

如果没有看到所涉及的代码，就很难推测。需要考虑的一些事项：

*   您是如何发出 AJAX 请求的，即您是在使用 jQuery 或 Prototype 等已建立的框架，还是推出了自己的框架？
*   显示/隐藏按钮背后的代码是什么？
*   您的 servlet 如何响应请求？

您可以使用[Firebug](http://www.getfirebug.com/)来验证您的 AJAX 请求是否正确，并在您的 servlet 中登录以查看发生了什么（当然也可以使用调试器）。

# sql - SQL HELP - 基于 BIT 变量的条件 where 子句 - SQL Server

> ID：626870
> 
> 赞同：10
> 
> 时间：2009-03-09T16:02:36.170
> 
> 标签：sql, sql-server, tsql

我需要帮助编写条件 where 子句。这是我的情况：

我有一个位值来确定在选择语句中返回哪些行。如果值为 true，我需要返回 import_id 列不为 null 的行，如果为 false，则我想要 import_id 列为 null 的行。

我对这样一个查询（如下）的尝试似乎不起作用，完成此操作的最佳方法是什么？

```
 DECLARE @imported BIT

SELECT id, import_id, name FROM Foo WHERE
    (@imported = 1 AND import_id IS NOT NULL)
    AND (@imported = 0 AND import_is IS NULL) 

```

谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-09T16:04:21.470

更改`AND`为`OR`

```
DECLARE @imported BIT

SELECT id, import_id, name FROM Foo WHERE
    (@imported = 1 AND import_id IS NOT NULL)
    OR (@imported = 0 AND import_is IS NULL) 
```

### 分解你的原始陈述

你基本上写过

```
 @imported = 1 
    AND import_id IS NOT NULL
    AND @imported = 0 
    AND import_is IS NULL 
```

这相当于

```
 @imported = 1 AND @imported = 0 
    AND import_id IS NOT NULL AND import_is IS NULL 
```

是什么导致了两个完全否定对方的子句

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T16:04:56.727

我想你的意思是

```
SELECT id, import_id, name FROM Foo WHERE
    (@imported = 1 AND import_id IS NOT NULL)
    OR (@imported = 0 AND import_is IS NULL)
    ^^^ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T16:37:41.250

您的查询需要 OR 来在不同的过滤器之间进行选择。如果在这种情况下使用单独的查询，那么优化器会更好。是的，代码冗余很糟糕，但是对于优化器来说，这些是完全不同的（而不是冗余的）查询。

```
DECLARE @imported BIT

IF @imported = 1
  SELECT id, import_id, name
  FROM Foo
  WHERE import_id IS NOT NULL
ELSE
  SELECT id, import_id, name
  FROM Foo
  WHERE import_id IS NULL 
```

# iphone - 设置对象 nil 与 release+realloc

> ID：626879
> 
> 赞同：9
> 
> 时间：2009-03-09T16:03:52.267
> 
> 标签：iphone, objective-c, ios, cocoa-touch, cocoa

这不是垃圾收集环境

我有一个类实例变量，在运行时的某个时刻，我需要使用与最初构建时不同的数据集重新初始化。

假设地说，如果我有 an`NSMutableArray`或 an `NSMutableDictionary`，那么执行以下操作会更有效：

```
[myArr release];
myArr  = [[NSMutableArray alloc] init....]; 
```

要不就，

```
myArr = nil; 
```

myArr 会释放对象并让我没有指向内存中存储的指针，以便我可以重新使用 myArr 吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-09T16:07:51.960

如果您自己这样做`myArr=nil;`，那么您就丢失了可以向其发送`release`消息的指针。`release`你的对象没有魔法。

而且，正如 Georg 所说，如果无法释放您的对象，则该内存已“泄漏”。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T16:59:37.170

您可以使用一个属性并获得几乎您想要的语法，而不会出现内存泄漏。

使用此语法声明数组

```
@property (readwrite, retain) NSMutableArray *myArray; 
```

然后像这样重新初始化它：

```
[self setMyArray:[NSMutableArray array]]; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-09T16:13:18.030

如果您使用的是 Mac OS，而不是 iPhone OS，我会说这取决于垃圾收集器是否被激活：

*   使用 GC：使用`myArr = nil;`
*   没有 GC：使用`[myArr release];`

不幸的是，在 iPhone 上，没有垃圾回收，所以如果你不想内存泄漏，你必须在不再需要时释放你的对象。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-12-02T10:08:24.240

第一个代码块很好。但是，第二个块并没有给您留下可以使用的数组，因此还不够。半纠正那个块，我认为你的意思是：

```
myArr = nil;
myArr = [[NSMutableArray alloc] init....]; 
```

但是，这也不能实现您想要的，因为您没有发布 myArr。如果你已经为 myArr 合成了一个 setter，那么你可以通过使用 setter (self.myArr) 而不是直接访问指针 (myArr) 来获得你想要的从设置为 nil 的释放行为。完全纠正你的第二个块：

```
self.myArr = nil;
myArr = [[NSMutableArray alloc] init....]; 
```

现在我们有了等效的代码示例，一个使用带有 nil 的 setter 来释放，另一个不使用。他们是一样的。

如果 myArr 是这些示例中的可变数组，最有效的方法是使用 removeAllObjects，避免所有释放内存的工作，只是为了收回它：

```
[myArr removeAllObjects]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T16:09:45.153

实现差异的一种方法可能是：将对对象的引用设置为 nil 对对象没有任何作用，它只对引用做一些事情。

“释放对象”不是“无”，所以它不会那样做。:) 在垃圾收集语言中，它可能会作为删除引用的副作用，但在 Objective C 中，它不是这样工作的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-13T21:37:43.307

如果你想要重置 NSMutableArray/NSMutableDictionary 的内容，你也可以调用 removeAllObjects 并且你有一个新的数组/dict 可以使用。

# vb.net - 什么是更好的设计？

> ID：626880
> 
> 赞同：1
> 
> 时间：2009-03-09T16:03:52.610
> 
> 标签：vb.net, design-patterns

我手头有一个场景，其中正在进行一些设计讨论。用简单的话来分解它，如果我要将 API 暴露给与此一起工作，什么是更好的设计。

一个）

```
Dim comp As New Company
comp.GetInfo(123)
Dim cust As New Customer
cust.Name= "CustomerName"
comp.Add( cust) 
```

b)

```
Dim custhand As Customerhandler
Dim cust As New Customer
cust.Name= "CustomerName"
custhand.AddCustomer(cust,123)  ''123 is CompanyID 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T16:18:32.137

我会选择（A），但我倾向于改变......

```
Dim comp As New Company
comp.GetInfo(123) 
```

进入...

```
Dim comp As Company = Company.Get(123) 
```

（因此向 Company 类添加一个新的共享方法以返回 Company 的特定实例）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T16:07:33.223

A. 在应该使用对象时使用 ID 是个坏主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T16:10:36.930

在两者之间进行选择，我会选择 A，添加 CustomerHandler 似乎过于复杂：公司或客户都应该知道如何将客户添加到公司。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T16:11:01.483

我更喜欢第一种方法，因为它最直接。您创建一个公司对象并向其添加客户。说得通。

第二种方法引入了一个“er”对象，它只会让事情变得更难理解和更程序化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T16:14:05.470

A.`cust`对象应在其中包含 ID，而不是与其分开。

您可能对`Customer.AddCustomer(string, int)`使用给定名称和 ID 生成新客户的重载感兴趣，但这取决于您存储信息的方式。

# c# - 动态（以编程方式）添加复选框和checkedchanged事件

> ID：626889
> 
> 赞同：4
> 
> 时间：2009-03-09T16:05:08.630
> 
> 标签：c#, asp.net, event-handling

我在以编程方式添加一些复选框和事件处理程序时遇到了一些问题。复选框看起来都很好，但单击时它们不做任何事情。有谁知道我做错了什么？

### 我的代码：

```
foreach (Statement i in theseStatements)
{
    box = new CheckBox();
    box.Text = i.StatementText;
    box.AutoPostBack = true;
    box.CheckedChanged += new EventHandler(this.CheckedChange);
    PlaceHolder.Controls.Add(box);
}

protected void CheckedChange(object sender, EventArgs e) 
{
    CheckBox x = (CheckBox)sender;
    Instructions.Text = "change";            
    WorkPlaceHazardsBox.Text += x.Text;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T16:10:53.747

您应该执行以下操作：

1.  为您在循环中创建`ID`的每个实例设置属性。`CheckBox``foreach`
2.  对于 PostBacks，请确保在引发控制事件*之前*`CheckedChanged`，在页面生命周期的某个时间点创建 CheckBoxes 并附加事件处理程序

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T16:45:03.977

确保验证您正在执行以下操作：

*   在初始加载和进一步回发中都添加了相同的复选框列表
*   您为每个复选框设置了不同的 ID
*   验证您是否收到回发（在页面加载中设置断点）
*   控件在页面加载时添加到页面，甚至在页面初始化时更好

如果您尝试做一些不同的事情，请向我们提供更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T16:08:25.750

如果每个复选框有一个 Instructions 文本框和一个 WorkPlaceHazards 文本框，那么您必须有一种方法将单击的复选框与其他两个控件相关联。

如果不是这样，那么他们*应*该做什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T16:09:09.290

当您说他们“什么都不做”时-您收到回发了吗？

如果您必须为复选框分配 ID，我不会感到惊讶 - 请记住，在回发时，您将获得一个新页面，因此必须重新创建所有复选框，然后确定哪个复选框被选中等等。这正在进入（对我来说，无论如何）ASP.NET 有点黑魔法的一面。我认为您必须合理仔细地研究页面生命周期并控制事物的识别方面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T21:53:35.093

在运行时插入控件时，可以通过Request["controlname"] 方法获取值。您必须为每个控件设置唯一ID。

但是，您可以使用 CheckBoxList 代替动态添加的复选框

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T22:42:25.443

我将您的代码复制到一个新的 VS2005 C# Web 项目中（见下文）。您的代码有效。在这个片段之外可能还有其他事情发生。或者，您的所有报表集合中的 StatementText 属性是否始终为空？

页...

```
<body>
    <form id="form1" runat="server">
    <div>
        <asp:PlaceHolder ID="PlaceHolder1" runat="server"></asp:PlaceHolder>
        Instructions: <asp:TextBox ID="Instructions" runat="server" />
        WorkPlaceHazardsBox: <asp:TextBox ID="WorkPlaceHazardsBox" runat="server" />
    </div>
    </form>

</body> 
```

后面的代码...

```
using System;
using System.Data;
using System.Configuration;
using System.Collections.Generic;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;

namespace CheckboxMadness
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            List<string> statements = new List<string>(new string[] { "foo", "bar" });

            foreach (string i in statements)
            {
                CheckBox box = new CheckBox();
                box.Text = i;
                box.AutoPostBack = true;
                box.CheckedChanged += new EventHandler(this.CheckedChange);
                PlaceHolder1.Controls.Add(box);
            }

        }
        protected void CheckedChange(object sender, EventArgs e)
        {
            CheckBox x = (CheckBox)sender;

            Instructions.Text = "change";

            WorkPlaceHazardsBox.Text += x.Text;
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-19T23:27:41.997

`CheckedChanged`如果嵌入到另一个控件中，例如嵌入到`TableCell`s. 在创建外部控件之前尝试创建`CheckBox`并添加（例如，如果表格嵌入在表格的单元格中，则表格是外部控件）。 `CheckedChanged``CheckBox`

在某些情况下，它可以解决问题。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-09T16:08:59.273

```
var box = new CheckBox(); 
```

# ios - 如何在 Objective-C 中创建委托？

> ID：626898
> 
> 赞同：764
> 
> 时间：2009-03-09T16:06:14.197
> 
> 标签：ios, objective-c, cocoa, callback, delegates

我知道代表是如何工作的，我也知道如何使用它们。

但是我如何创建它们？

* * *

## 回答 #1

> 赞同：914
> 
> 时间：2009-03-09T16:16:24.233

Objective-C 委托是一个已分配给`delegate`另一个对象的属性的对象。要创建一个，您定义一个实现您感兴趣的委托方法的类，并将该类标记为实现委托协议。

例如，假设您有一个`UIWebView`. 如果你想实现它的委托[`webViewDidStartLoad:`](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIWebViewDelegate_Protocol/index.html#//apple_ref/occ/intfm/UIWebViewDelegate/webViewDidStartLoad:)方法，你可以创建一个这样的类：

```
@interface MyClass<UIWebViewDelegate>
// ...
@end

@implementation MyClass
- (void)webViewDidStartLoad:(UIWebView *)webView { 
    // ... 
}
@end 
```

然后您可以创建 MyClass 的实例并将其分配为 Web 视图的委托：

```
MyClass *instanceOfMyClass = [[MyClass alloc] init];
myWebView.delegate = instanceOfMyClass; 
```

另一方面`UIWebView`，它可能具有与此类似的代码，以查看代理是否使用响应`webViewDidStartLoad:`消息[`respondsToSelector:`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html#//apple_ref/occ/intfm/NSObject/respondsToSelector:)并在适当时发送它。

```
if([self.delegate respondsToSelector:@selector(webViewDidStartLoad:)]) {
    [self.delegate webViewDidStartLoad:self];
} 
```

委托属性本身通常被声明`weak`（在 ARC 中）或`assign`（在 ARC 之前）以避免保留循环，因为对象的委托通常持有对该对象的强引用。（例如，视图控制器通常是它包含的视图的委托。）

## 为您的课程安排代表

要定义您自己的委托，您必须在某处声明他们的方法，如[Apple Docs on protocols](http://www.google.ca/search?q=site:developer.apple.com+protocols+objective+c&btnI)中所讨论的那样。你通常声明一个正式的协议。从 UIWebView.h 解释的声明如下所示：

```
@protocol UIWebViewDelegate <NSObject>
@optional
- (void)webViewDidStartLoad:(UIWebView *)webView;
// ... other methods here
@end 
```

这类似于接口或抽象基类，因为它为您的委托创建了一个特殊类型，`UIWebViewDelegate`在这种情况下。委托实现者必须采用这个协议：

```
@interface MyClass <UIWebViewDelegate>
// ...
@end 
```

然后实现协议中的方法。对于在协议中声明为的方法`@optional`（像大多数委托方法一样），您需要`-respondsToSelector:`在调用特定方法之前检查 with 。

### 命名

委托方法通常以委托类名称开头，并将委托对象作为第一个参数。他们还经常使用 will-、should- 或 did- 形式。因此，`webViewDidStartLoad:`（第一个参数是 web 视图）而不是`loadStarted`（不带参数）例如。

### 速度优化

您可以在设置委托时缓存该信息，而不是每次我们想要发送消息时检查委托是否响应选择器。一种非常简洁的方法是使用位域，如下所示：

```
@protocol SomethingDelegate <NSObject>
@optional
- (void)something:(id)something didFinishLoadingItem:(id)item;
- (void)something:(id)something didFailWithError:(NSError *)error;
@end

@interface Something : NSObject
@property (nonatomic, weak) id <SomethingDelegate> delegate;
@end

@implementation Something {
  struct {
    unsigned int didFinishLoadingItem:1;
    unsigned int didFailWithError:1;
  } delegateRespondsTo;
}
@synthesize delegate;

- (void)setDelegate:(id <SomethingDelegate>)aDelegate {
  if (delegate != aDelegate) {
    delegate = aDelegate;

    delegateRespondsTo.didFinishLoadingItem = [delegate respondsToSelector:@selector(something:didFinishLoadingItem:)];
    delegateRespondsTo.didFailWithError = [delegate respondsToSelector:@selector(something:didFailWithError:)];
  }
}
@end 
```

`delegateRespondsTo`然后，在正文中，我们可以通过访问我们的结构而不是`-respondsToSelector:`一遍又一遍地发送来检查我们的委托是否处理了消息。

### 非正式代表

在协议存在之前，通常使用一个[类别](http://www.google.ca/search?q=site:developer.apple.com+category+objective+c&btnI)来`NSObject`声明委托可以实现的方法。例如，`CALayer`仍然这样做：

```
@interface NSObject(CALayerDelegate)
- (void)displayLayer:(CALayer *)layer;
// ... other methods here
@end 
```

这告诉编译器任何对象都可以实现`displayLayer:`。

然后，您将使用与上述相同的`-respondsToSelector:`方法来调用此方法。委托实现此方法并分配`delegate`属性，仅此而已（没有声明您符合协议）。这种方法在 Apple 的库中很常见，但是新代码应该使用上面更现代的协议方法，因为这种方法会造成污染`NSObject`（这会降低自动完成的用处）并使编译器很难警告您输入错误和类似错误。

* * *

## 回答 #2

> 赞同：395
> 
> 时间：2012-09-30T10:25:40.570

批准的答案很棒，但如果您正在寻找 1 分钟的答案，请尝试以下操作：

MyClass.h 文件应如下所示（添加带注释的委托行！）

```
#import <BlaClass/BlaClass.h>

@class MyClass;             //define class, so protocol can see MyClass
@protocol MyClassDelegate <NSObject>   //define delegate protocol
    - (void) myClassDelegateMethod: (MyClass *) sender;  //define delegate method to be implemented within another class
@end //end protocol

@interface MyClass : NSObject {
}
@property (nonatomic, weak) id <MyClassDelegate> delegate; //define MyClassDelegate as delegate

@end 
```

MyClass.m 文件应如下所示

```
#import "MyClass.h"
@implementation MyClass 
@synthesize delegate; //synthesise  MyClassDelegate delegate

- (void) myMethodToDoStuff {
    [self.delegate myClassDelegateMethod:self]; //this will call the method implemented in your other class    
}

@end 
```

要在另一个类中使用您的委托（在本例中称为 MyVC 的 UIViewController）MyVC.h：

```
#import "MyClass.h"
@interface MyVC:UIViewController <MyClassDelegate> { //make it a delegate for MyClassDelegate
} 
```

MyVC.m:

```
myClass.delegate = self;          //set its delegate to self somewhere 
```

实现委托方法

```
- (void) myClassDelegateMethod: (MyClass *) sender {
    NSLog(@"Delegates are great!");
} 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2010-05-04T20:42:59.177

当使用正式的协议方法来创建委托支持时，我发现您可以通过添加以下内容来确保正确的类型检查（尽管是运行时，而不是编译时）：

```
if (![delegate conformsToProtocol:@protocol(MyDelegate)]) {
    [NSException raise:@"MyDelegate Exception"
                format:@"Parameter does not conform to MyDelegate protocol at line %d", (int)__LINE__];
} 
```

在您的委托访问器 (setDelegate) 代码中。这有助于减少错误。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-03-10T00:18:37.333

也许这更符合您所缺少的内容：

如果您来自类似 C++ 的观点，代表需要一点时间来适应 - 但基本上“他们只是工作”。

它的工作方式是您将编写的一些对象设置为 NSWindow 的委托，但您的对象仅具有许多可能委托方法中的一种或几种的实现（方法）。所以发生了一些事情，并且`NSWindow`想要调用您的对象 - 它只是使用 Objective-c 的`respondsToSelector`方法来确定您的对象是否想要调用该方法，然后调用它。这就是objective-c的工作原理——方法是按需查找的。

用你自己的对象来做这件事完全是微不足道的，没有什么特别的事情发生，例如你可以有`NSArray`27 个对象，所有不同种类的对象，其中只有 18 个有方法`-(void)setToBue;`，其他 9 个没有。因此，要调用`setToBlue`所有需要完成的 18 个，如下所示：

```
for (id anObject in myArray)
{
  if ([anObject respondsToSelector:@selector(@"setToBlue")])
     [anObject setToBlue]; 
} 
```

关于委托的另一件事是它们不会被保留，因此您始终必须`nil`在`MyClass dealloc`方法中将委托设置为。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2013-02-27T12:21:24.460

请！查看下面的简单分步教程，了解 Delegates 在 iOS 中的工作原理。

> [**iOS 中的委托**](http://rdcworld-iphone.blogspot.in/2013/02/delegate-in-ios.html)

我创建了两个 ViewController（用于将数据从一个发送到另一个）

1.  FirstViewController 实现委托（提供数据）。
2.  SecondViewController 声明委托（它将接收数据）。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2013-08-04T08:39:59.320

作为 Apple 推荐的一种良好做法，委托（根据定义，它是一种协议）符合`NSObject`协议是有好处的。

```
@protocol MyDelegate <NSObject>
    ...
@end 
```

& 要在您的委托中创建可选方法（即不一定要实现的方法），您可以使用这样的`@optional`注释：

```
@protocol MyDelegate <NSObject>
    ...
    ...
      // Declaration for Methods that 'must' be implemented'
    ...
    ...
    @optional
    ...
      // Declaration for Methods that 'need not necessarily' be implemented by the class conforming to your delegate
    ...
@end 
```

因此，当使用您指定为可选的方法时，您需要（在您的类中）检查`respondsToSelector`视图（符合您的委托）是否实际实现了您的可选方法。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2013-06-19T10:34:42.990

我认为，一旦您了解了代表，所有这些答案都会很有意义。就我个人而言，我来自 C/C++ 领域，之前是 Fortran 等过程语言，所以这是我在 C++ 范式中寻找类似类似物的 2 分钟尝试。

如果我要向 C++/Java 程序员解释委托，我会说

什么是代表？这些是指向另一个类中的类的静态指针。分配指针后，您可以调用该类中的函数/方法。因此，您的类的某些功能被“委托”（在 C++ 世界中 - 类对象指针指向的指针）到另一个类。

什么是协议？从概念上讲，它的用途与您分配为委托类的类的头文件类似。协议是定义需要在类中实现哪些方法的显式方式，该类的指针被设置为类中的委托。

如何在 C++ 中做类似的事情？如果您尝试在 C++ 中执行此操作，您将通过在类定义中定义指向类（对象）的指针，然后将它们连接到其他类，这些类将提供附加功能作为基类的委托。但是这种接线需要在代码中维护，并且会很笨拙且容易出错。Objective C 只是假设程序员并不擅长维护这一原则，并提供编译器限制来强制执行干净的实现。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2015-11-05T17:11:08.413

# 斯威夫特版本

委托只是一个为另一个类做一些工作的类。阅读下面的代码，了解一个有点愚蠢（但希望能带来启发）的 Playground 示例，该示例展示了如何在 Swift 中完成此操作。

```
// A protocol is just a list of methods (and/or properties) that must
// be used by any class that adopts the protocol.
protocol OlderSiblingDelegate: class {
    // This protocol only defines one required method
    func getYourNiceOlderSiblingAGlassOfWater() -> String
}

class BossyBigBrother {

    // The delegate is the BossyBigBrother's slave. This position can 
    // be assigned later to whoever is available (and conforms to the 
    // protocol).
    weak var delegate: OlderSiblingDelegate?

    func tellSomebodyToGetMeSomeWater() -> String? {
        // The delegate is optional because there might not be anyone
        // nearby to boss around.
        return delegate?.getYourNiceOlderSiblingAGlassOfWater()
    }
}

// PoorLittleSister conforms to the OlderSiblingDelegate protocol
class PoorLittleSister: OlderSiblingDelegate {

    // This method is repquired by the protocol, but the protocol said
    // nothing about how it needs to be implemented.
    func getYourNiceOlderSiblingAGlassOfWater() -> String {
        return "Go get it yourself!"
    }

}

// initialize the classes
let bigBro = BossyBigBrother()
let lilSis = PoorLittleSister()

// Set the delegate 
// bigBro could boss around anyone who conforms to the 
// OlderSiblingDelegate protocol, but since lilSis is here, 
// she is the unlucky choice.
bigBro.delegate = lilSis

// Because the delegate is set, there is a class to do bigBro's work for him.
// bigBro tells lilSis to get him some water.
if let replyFromLilSis = bigBro.tellSomebodyToGetMeSomeWater() {
    print(replyFromLilSis) // "Go get it yourself!"
} 
```

在实际实践中，委托常用于以下几种情况

1.  当一个班级需要向另一个班级传达一些信息时
2.  当一个类想要允许另一个类自定义它时

除了委托类符合所需的协议外，这些类不需要事先了解彼此的任何信息。

我强烈推荐阅读以下两篇文章。[他们帮助我比文档](https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/Protocols.html)更好地理解了代表。

*   [什么是委托？– Swift 开发者指南](http://www.andrewcbancroft.com/2015/03/26/what-is-delegation-a-swift-developers-guide/)
*   [委托是如何工作的——Swift 开发者指南](https://www.andrewcbancroft.com/2015/04/08/how-delegation-works-a-swift-developer-guide/)

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2013-07-17T04:58:08.033

好的，这并不是问题的真正答案，但如果您正在寻找如何制作自己的代表，也许更简单的东西可能对您来说是一个更好的答案。

我几乎不执行我的代表，因为我很少需要。对于委托对象，我只能有一个委托。因此，如果您希望您的代表以一种方式进行通信/传递数据，那么您最好使用通知。

NSNotification 可以将对象传递给多个接收者，并且非常易于使用。它是这样工作的：

MyClass.m 文件应如下所示

```
#import "MyClass.h"
@implementation MyClass 

- (void) myMethodToDoStuff {
//this will post a notification with myClassData (NSArray in this case)  in its userInfo dict and self as an object
[[NSNotificationCenter defaultCenter] postNotificationName:@"myClassUpdatedData"
                                                    object:self
                                                  userInfo:[NSDictionary dictionaryWithObject:selectedLocation[@"myClassData"] forKey:@"myClassData"]];
}
@end 
```

要在其他类中使用您的通知：将类添加为观察者：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(otherClassUpdatedItsData:) name:@"myClassUpdatedData" object:nil]; 
```

实现选择器：

```
- (void) otherClassUpdatedItsData:(NSNotification *)note {
    NSLog(@"*** Other class updated its data ***");
    MyClass *otherClass = [note object];  //the object itself, you can call back any selector if you want
    NSArray *otherClassData = [note userInfo][@"myClassData"]; //get myClass data object and do whatever you want with it
} 
```

如果出现以下情况，请不要忘记删除您的班级作为观察员

```
- (void)dealloc
{
    [[NSNotificationCenter defaultCenter] removeObserver:self];
} 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2015-04-08T13:24:20.977

假设您有一个您开发的类，并希望声明一个委托属性以便能够在某些事件发生时通知它：

```
@class myClass;

@protocol myClassDelegate <NSObject>

-(void)myClass:(MyClass*)myObject requiredEventHandlerWithParameter:(ParamType*)param;

@optional
-(void)myClass:(MyClass*)myObject optionalEventHandlerWithParameter:(ParamType*)param;

@end

@interface MyClass : NSObject

@property(nonatomic,weak)id< MyClassDelegate> delegate;

@end 
```

所以你在`MyClass`头文件（或单独的头文件）中声明一个协议，并声明你的委托必须/应该实现的必需/​​可选事件处理程序，然后声明一个`MyClass`类型为 ( `id< MyClassDelegate>`) 的属性，这意味着任何符合的目标 c 类在协议`MyClassDelegate`中，您会注意到委托属性被声明为弱，这对于防止保留循环非常重要（通常委托保留`MyClass`实例，因此如果您将委托声明为保留，它们将相互保留并且两者都不会保留其中将永远被释放）。

您还会注意到协议方法将`MyClass`实例作为参数传递给委托，这是最好的做法，以防委托想要在实例上调用某些方法，`MyClass`并且当委托将自己声明为`MyClassDelegate`多个`MyClass`实例时也很有帮助，例如当您有多个实例时`UITableView's`你的实例，`ViewController`并声明自己为`UITableViewDelegate`所有实例。

在您的内部，您`MyClass`通过声明的事件通知委托，如下所示：

```
if([_delegate respondsToSelector:@selector(myClass: requiredEventHandlerWithParameter:)])
{
     [_delegate myClass:self requiredEventHandlerWithParameter:(ParamType*)param];
} 
```

您首先检查您的委托是否响应您将要调用的协议方法，以防委托未实现它并且应用程序将崩溃（即使需要协议方法）。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2015-08-03T04:47:04.140

要创建您自己的委托，首先您需要创建一个协议并声明必要的方法，而无需实现。然后将此协议实现到您想要实现委托或委托方法的头类中。

协议必须声明如下：

```
@protocol ServiceResponceDelegate <NSObject>

- (void) serviceDidFailWithRequestType:(NSString*)error;
- (void) serviceDidFinishedSucessfully:(NSString*)success;

@end 
```

这是应该完成某些任务的服务类。它展示了如何定义委托以及如何设置委托。在任务完成后的实现类中，委托的方法被调用。

```
@interface ServiceClass : NSObject
{
id <ServiceResponceDelegate> _delegate;
}

- (void) setDelegate:(id)delegate;
- (void) someTask;

@end

@implementation ServiceClass

- (void) setDelegate:(id)delegate
{
_delegate = delegate;
}

- (void) someTask
{
/*

   perform task

*/
if (!success)
{
[_delegate serviceDidFailWithRequestType:@”task failed”];
}
else
{
[_delegate serviceDidFinishedSucessfully:@”task success”];
}
}
@end 
```

这是通过将委托设置为自身来调用服务类的主视图类。并且该协议也在头类中实现。

```
@interface viewController: UIViewController <ServiceResponceDelegate>
{
ServiceClass* _service;
}

- (void) go;

@end

@implementation viewController

//
//some methods
//

- (void) go
{
_service = [[ServiceClass alloc] init];
[_service setDelegate:self];
[_service someTask];
} 
```

就是这样，通过在这个类中实现委托方法，一旦操作/任务完成，控制权就会回来。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2015-09-29T09:23:09.937

这是创建委托的简单方法

在 .h 文件中创建协议。确保在协议之前使用 @class 定义，后跟 UIViewController 的名称`< As the protocol I am going to use is UIViewController class>.`

**步骤： 1：**创建一个名为“YourViewController”的新类协议，它将作为 UIViewController 类的子类，并将该类分配给第二个 ViewController。

**步骤：2：**转到“YourViewController”文件并修改如下：

```
#import <UIKit/UIkit.h>
@class YourViewController;

@protocol YourViewController Delegate <NSObject>

 @optional
-(void)defineDelegateMethodName: (YourViewController *) controller;

@required
-(BOOL)delegateMethodReturningBool: (YourViewController *) controller;

  @end
  @interface YourViewController : UIViewController

  //Since the property for the protocol could be of any class, then it will be marked as a type of id.

  @property (nonatomic, weak) id< YourViewController Delegate> delegate;

@end 
```

协议行为中定义的方法可以使用@optional 和@required 作为协议定义的一部分来控制。

**Step : 3 :** **Delegate 的实现**

```
 #import "delegate.h"

   @interface YourDelegateUser ()
     <YourViewControllerDelegate>
   @end

   @implementation YourDelegateUser

   - (void) variousFoo {
      YourViewController *controller = [[YourViewController alloc] init];
      controller.delegate = self;
   }

   -(void)defineDelegateMethodName: (YourViewController *) controller {
      // handle the delegate being called here
   }

   -(BOOL)delegateMethodReturningBool: (YourViewController *) controller {
      // handle the delegate being called here
      return YES;
   }

   @end 
```

//在调用之前测试方法是否已经定义

```
 - (void) someMethodToCallDelegate {
     if ([[self delegate] respondsToSelector:@selector(defineDelegateMethodName:)]) {
           [self.delegate delegateMethodName:self]; 
     }
  } 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2017-04-26T05:27:43.480

免责声明：这是`Swift`如何创建`delegate`.

那么，什么是代表？......在软件开发中，有通用的可重用解决方案架构有助于解决给定上下文中常见的问题，可以说，这些“模板”最为人所知的是设计模式。委托是一种设计模式，它允许一个对象在特定事件发生时向另一个对象发送消息。想象一个对象 A 调用一个对象 B 来执行一个动作。一旦动作完成，对象 A 应该知道 B 已经完成了任务并采取必要的动作，这可以在委托的帮助下实现！

为了更好地解释，我将向您展示如何创建一个在类之间传递数据的自定义委托，在一个简单的应用程序中使用 Swift，[首先下载或克隆这个启动项目并运行它！](https://github.com/jamesrochabrun/DelegateTutorial)

您可以看到一个包含两个类的应用程序，`ViewController A`并且`ViewController B`. B 有两个视图，可以在点击时更改背景颜色`ViewController`，没什么太复杂的吧？好吧，现在让我们以一种简单的方式思考，当点击 B 类的视图时，也可以改变 A 类的背景颜色。

问题是这个视图是 B 类的一部分，不知道 A 类，所以我们需要找到一种方法在这两个类之间进行通信，这就是委托的亮点。我将实现分为 6 个步骤，因此您可以在需要时将其用作备忘单。

第 1 步：在 ClassBVC 文件中查找编译指示标记第 1 步并添加此

```
//MARK: step 1 Add Protocol here.
protocol ClassBVCDelegate: class {
func changeBackgroundColor(_ color: UIColor?)
} 
```

第一步是创建一个`protocol`，在这种情况下，我们将在 B 类中创建协议，在协议中，您可以根据实现的要求创建任意数量的函数。在这种情况下，我们只有一个简单的函数，它接受一个可选`UIColor`参数作为参数。`delegate`在类名末尾添加单词来命名协议是一个好习惯，在这种情况下， `ClassBVCDelegate`.

第 2 步：在第 2 步中查找编译指示标记`ClassVBC`并添加此

```
//MARK: step 2 Create a delegate property here.
weak var delegate: ClassBVCDelegate? 
```

这里我们只是为类创建了一个委托属性，这个属性必须采用`protocol`类型，并且应该是可选的。另外，你应该在属性之前添加weak关键字以避免保留循环和潜在的内存泄漏，如果你不知道这意味着什么现在不要担心，只要记住添加这个关键字。

第3步：在handleTap`method`中查找pragma mark step 3`ClassBVC`并添加

```
//MARK: step 3 Add the delegate method call here.
delegate?.changeBackgroundColor(tapGesture.view?.backgroundColor) 
```

您应该知道的一件事是，运行应用程序并点击任何视图，您不会看到任何新行为，这是正确的，但我想指出的是，当调用委托时应用程序不会崩溃，并且这是因为我们将它创建为一个可选值，这就是为什么即使委托不存在它也不会崩溃的原因。现在让我们去`ClassAVC`归档并制作它，委托人。

第 4 步：在 handleTap 方法中查找编译指示第 4 步，`ClassAVC`并将其添加到您的类类型旁边，如下所示。

```
//MARK: step 4 conform the protocol here.
class ClassAVC: UIViewController, ClassBVCDelegate {
} 
```

现在 ClassAVC 采用了`ClassBVCDelegate`协议，你可以看到你的编译器给你一个错误，说“Type 'ClassAVC does not conform to protocol 'ClassBVCDelegate' 这只是意味着你还没有使用协议的方法，想象一下当 A 类采用协议时，就像与 B 类签订合同，并且该合同说“任何采用我的类都必须使用我的功能！”</p>

快速说明：如果您有`Objective-C`背景，您可能会认为您也可以关闭该错误，使该方法成为可选方法，但令我惊讶的是，可能是您的，`Swift`语言不支持 optional `protocols`，如果您想这样做，您可以创建您的扩展或在您的实现`protocol`中使用 @objc 关键字。`protocol`

就个人而言，如果我必须创建具有不同可选方法的协议，我更愿意将其分解为不同`protocols`的 ，这样我将遵循为我的对象赋予单一职责的概念，但它可能会根据具体实现而有所不同。

[这是](https://www.avanderlee.com/swift-2-0/optional-protocol-methods/)一篇关于可选方法的好文章。

第5步：在prepare for segue方法中寻找pragma mark step 5并添加这个

```
//MARK: step 5 create a reference of Class B and bind them through the `prepareforsegue` method.
if let nav = segue.destination as? UINavigationController, let classBVC = nav.topViewController as? ClassBVC {
classBVC.delegate = self
} 
```

这里我们只是创建一个实例`ClassBVC`并将它的委托分配给 self，但这里的 self 是什么？好吧， self 就是`ClassAVC`被委派的那个！

第 6 步：最后，查找第 6 步中的 pragma `ClassAVC`，让我们使用 的功能`protocol`，开始输入 func **changeBackgroundColor**，您会看到它会自动为您完成。您可以在其中添加任何实现，在此示例中，我们将仅更改背景颜色，添加它。

```
//MARK: step 6 finally use the method of the contract
func changeBackgroundColor(_ color: UIColor?) {
view.backgroundColor = color
} 
```

现在运行应用程序！

`Delegates`无处不在，你可能会在没有通知的情况下使用它们，如果你`tableview`在过去创建了一个你使用过的委托，`UIKIT`围绕它们的许多类的作品以及许多其他的作品`frameworks`，它们解决了这些主要问题。

*   避免对象的紧密耦合。
*   无需子类化对象即可修改行为和外观。
*   允许将任务处理到任何任意对象。

恭喜你，你刚刚实现了一个自定义委托，我知道你可能在想，就为了这个这么麻烦？好吧，如果您想成为一名`iOS`开发人员，委托是一种非常重要的设计模式，并且始终牢记它们在对象之间具有一对一的关系。

[您可以在此处](https://medium.com/compileswift/implementing-delegates-in-swift-step-by-step-d3211cbac3ef)查看原始教程

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2018-03-16T04:40:48.620

答案实际上已经回答，但我想给你一个“备忘单”来创建一个代表：

```
DELEGATE SCRIPT

CLASS A - Where delegate is calling function

@protocol <#Protocol Name#> <NSObject>

-(void)delegateMethod;

@end

@interface <#Some ViewController#> : <#UIViewController#> 

@property (nonatomic, assign) id <<#Protocol Name#>> delegate;

@end

@implementation <#Some ViewController#> 

-(void)someMethod {
    [self.delegate methodName];
}

@end

CLASS B - Where delegate is called 

@interface <#Other ViewController#> (<#Delegate Name#>) {}
@end

@implementation <#Other ViewController#> 

-(void)otherMethod {
    CLASSA *classA = [[CLASSA alloc] init];

    [classA setDelegate:self];
}

-delegateMethod() {

}

@end 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-12-19T04:14:58.487

视图控制器.h

```
@protocol NameDelegate <NSObject>

-(void)delegateMEthod: (ArgType) arg;

@end

@property id <NameDelegate> delegate; 
```

视图控制器.m

```
[self.delegate delegateMEthod: argument]; 
```

主视图控制器.m

```
ViewController viewController = [ViewController new];
viewController.delegate = self; 
```

方法：

```
-(void)delegateMEthod: (ArgType) arg{
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-02-08T09:30:59.663

在我看来，为该委托方法创建单独的类，您可以在需要的地方使用。

在我的自定义 DropDownClass.h

```
typedef enum
{
 DDSTATE,
 DDCITY
}DropDownType;

@protocol DropDownListDelegate <NSObject>
@required
- (void)dropDownDidSelectItemWithString:(NSString*)itemString     DropDownType:(DropDownType)dropDownType;
@end
@interface DropDownViewController : UIViewController
{
 BOOL isFiltered;
}
@property (nonatomic, assign) DropDownType dropDownType;
@property (weak) id <DropDownListDelegate> delegate;
@property (strong, nonatomic) NSMutableArray *array1DropDown;
@property (strong, nonatomic) NSMutableArray *array2DropDown; 
```

在那之后 in.m 文件创建带有对象的数组，

```
 - (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath{
CGFloat rowHeight = 44.0f;
return rowHeight;
}

-(NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
return 1;
}
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
return isFiltered?[self.array1DropDown count]:[self.array2DropDown count];
}
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
static NSString *simpleTableIdentifier = @"TableCell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:simpleTableIdentifier];
}

if (self.delegate) {
    if (self.dropDownType == DDCITY) {
        cell.textLabel.text = [self.array1DropDown objectAtIndex:indexPath.row];
    }
    else if (self.dropDownType == DDSTATE) {
        cell.textLabel.text = [self.array2DropDown objectAtIndex:indexPath.row];
    }
}
return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
 [self dismissViewControllerAnimated:YES completion:^{
    if(self.delegate){
        if(self.dropDownType == DDCITY){
            [self.delegate dropDownDidSelectItemWithString:[self.array1DropDown objectAtIndex:indexPath.row] DropDownType:self.dropDownType];
        }
        else if (self.dropDownType == DDSTATE) {
            [self.delegate dropDownDidSelectItemWithString:[self.array2DropDown objectAtIndex:indexPath.row] DropDownType:self.dropDownType];
        }
    }
}];
} 
```

这里所有的都是为自定义委托类设置的。之后你可以在你想要的地方使用这个委托方法。例如...

在我的另一个视图控制器导入之后

像这样创建调用委托方法的动作

```
- (IBAction)dropDownBtn1Action:(id)sender {
DropDownViewController *vehicleModelDropView = [[DropDownViewController alloc]init];
vehicleModelDropView.dropDownType = DDCITY;
vehicleModelDropView.delegate = self;
[self presentViewController:vehicleModelDropView animated:YES completion:nil];
} 
```

之后像这样调用委托方法

```
- (void)dropDownDidSelectItemWithString:(NSString *)itemString DropDownType:(DropDownType)dropDownType {
switch (dropDownType) {
    case DDCITY:{
        if(itemString.length > 0){
            //Here i am printing the selected row
            [self.dropDownBtn1 setTitle:itemString forState:UIControlStateNormal];
        }
    }
        break;
    case DDSTATE: {
        //Here i am printing the selected row
        [self.dropDownBtn2 setTitle:itemString forState:UIControlStateNormal];
    }

    default:
        break;
}
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-12-08T10:50:58.783

代表：- 创建

```
@protocol addToCartDelegate <NSObject>

-(void)addToCartAction:(ItemsModel *)itemsModel isAdded:(BOOL)added;

@end 
```

发送并请指派代表查看您正在发送的数据

```
[self.delegate addToCartAction:itemsModel isAdded:YES]; 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-01-02T16:31:44.540

```
//1.
//Custom delegate 
@protocol TB_RemovedUserCellTag <NSObject>

-(void)didRemoveCellWithTag:(NSInteger)tag;

@end

//2.
//Create a weak reference in a class where you declared the delegate
@property(weak,nonatomic)id <TB_RemovedUserCellTag> removedCellTagDelegate;

//3\. 
// use it in the class
  [self.removedCellTagDelegate didRemoveCellWithTag:self.tag];

//4\. import the header file in the class where you want to conform to the protocol
@interface MyClassUsesDelegate ()<TB_RemovedUserCellTag>

@end 
```

//5\. 实现类中的方法 .m -(void)didRemoveCellWithTag:(NSInteger)tag { NSLog@("Tag %d",tag);

}

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-07-14T10:14:49.340

让我们从一个例子开始，如果我们在线购买产品，它会经历不同团队处理的运输/交付等过程。因此，如果运输完成，运输团队应该通知交付团队并且应该是一对一的沟通作为广播此信息其他人/供应商可能只想将此信息传递给需要的人，这将是开销。

因此，如果我们从应用程序的角度考虑，一个活动可以是一个在线订单，而不同的团队可以是多个视图。

这是将 ShippingView 视为运输团队和 DeliveryView 作为交付团队的代码：

```
//Declare the protocol with functions having info which needs to be communicated
protocol ShippingDelegate : class {
    func productShipped(productID : String)
}
//shippingView which shows shipping status of products
class ShippingView : UIView
{

    weak var delegate:ShippingDelegate?
    var productID : String

    @IBAction func checkShippingStatus(sender: UIButton)
    {
        // if product is shipped
        delegate?.productShipped(productID: productID)
    }
}
//Delivery view which shows delivery status & tracking info
class DeliveryView: UIView,ShippingDelegate
{
    func productShipped(productID : String)
    {
        // update status on view & perform delivery
    }
}

//Main page on app which has both views & shows updated info on product whole status
class ProductViewController : UIViewController
{
    var shippingView : ShippingView
    var deliveryView : DeliveryView

    override func viewDidLoad() {
        super.viewDidLoad()
        // as we want to update shipping info on delivery view, so assign delegate to delivery object
        // whenever shipping status gets updated it will call productShipped method in DeliveryView & update UI.
        shippingView.delegate = deliveryView
        //
    }
} 
```

# sql-server - 如何更改 SQL Server 中列的数据类型？

> ID：626899
> 
> 赞同：379
> 
> 时间：2009-03-09T16:06:41.090
> 
> 标签：sql-server, tsql, type-conversion, alter-table

我正在尝试将列从 a 更改`varchar(50)`为 a `nvarchar(200)`。更改此表的 SQL 命令是什么？

* * *

## 回答 #1

> 赞同：623
> 
> 时间：2009-03-09T16:07:33.507

```
ALTER TABLE TableName 
ALTER COLUMN ColumnName NVARCHAR(200) [NULL | NOT NULL] 
```

**编辑** 如前所述，应该指定 NULL/NOT NULL，也请参见[Rob 的回答](https://stackoverflow.com/a/635360/1165522)。

* * *

## 回答 #2

> 赞同：181
> 
> 时间：2009-03-11T16:38:07.610

不要忘记可空性。

```
ALTER TABLE <schemaName>.<tableName>
ALTER COLUMN <columnName> nvarchar(200) [NULL|NOT NULL] 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-03-09T16:08:01.727

使用 Alter table 语句。

```
Alter table TableName Alter Column ColumnName nvarchar(100) 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2015-10-11T21:15:59.377

在 SQL Server (Transact-SQL) 中修改现有表中的列的语法是：

```
ALTER TABLE table_name
    ALTER COLUMN column_name column_type; 
```

例如：

```
ALTER TABLE employees
    ALTER COLUMN last_name VARCHAR(75) NOT NULL; 
```

此 SQL Server`ALTER TABLE`示例会将调用的列修改为`last_name`数据类型，`VARCHAR(75)`并强制该列不允许空值。

看[这里](http://www.techonthenet.com/sql_server/tables/alter_table.php)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-09-26T20:12:49.020

**用于更改数据类型**

```
alter table table_name 
alter column column_name datatype [NULL|NOT NULL] 
```

**用于更改主键**

```
ALTER TABLE table_name  
ADD CONSTRAINT PK_MyTable PRIMARY KEY (column_name) 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-12-23T18:25:05.323

只要您增加 varchar 的大小，就可以了。根据[Alter Table](http://msdn.microsoft.com/en-us/library/ms190273.aspx "更改表")参考：

> 降低列的精度或小数位数可能会导致数据截断。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2020-03-05T07:53:17.630

```
ALTER TABLE [dbo].[TableName]
ALTER COLUMN ColumnName VARCHAR(Max) NULL 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-03-09T06:15:32.863

11克：

```
ALTER TABLE TableName
Modify ColumnName DataType; 
```

EG: ALTER TABLE 员工修改 BIRTH_DATE VARCHAR(30);

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-04-06T06:42:14.923

```
ALTER TABLE [Performance].[dbo].[CRA_283_Violation]
ALTER COLUMN [Throughput_HS_DC_NodeB_3G_Alarm] bit 
```

* * *

## 回答 #10

> 赞同：-11
> 
> 时间：2015-01-29T13:50:38.850

试试这个：

```
ALTER TABLE "table_name"
MODIFY "column_name" "New Data Type"; 
```

# c# - ASP.net MVC RC2 - 具有显式值的复选框

> ID：626901
> 
> 赞同：2
> 
> 时间：2009-03-09T16:07:16.923
> 
> 标签：c#, .net, asp.net, asp.net-mvc

有没有一种简单的方法可以使用现有的 Html Helpers 生成具有显式值的复选框列表（就像在 Beta 中一样）？

Beta 中的示例（可能使用 MVC Contrib）：

`.CheckBox("Field", 6, new { value = 6})`会输出：

```
<input id="Field1" type="checkbox" value="6" name="Field" />
<input id="Field2" type="hidden" value="6" name="Field" /> 
```

然而在 RC2 中我得到：

```
<input id="Field1" type="checkbox" value="6" name="Field" />
<input type="hidden" value="false" name="Field" /> 
```

> 注意：我使用了一个自定义帮助扩展，它生成唯一的 HTML`id`并在适当的时候设置选中的 HTML 属性

除了使用原始 HTML 而不是使用 Html Helpers 之外，还有一种方法可以设置带有显式值的复选框吗？查看 RC2 的 Codeplex 源代码似乎并不像`.InputHelper()`标记的那样简单，`private`因此您无法使用它来提供帮助。

注意：`checkbox`页面中有多个选项允许多项选择，因此该`false`值没有用，因为我需要隐藏字段中的值来知道哪些项目已勾选，哪些未勾选（因为未勾选的`checkbox`值不是t 已发布 - 只有隐藏字段是）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T16:20:06.283

如果该字段映射到的属性是 Int 类型，那么我认为 false 将被转换为 0。

这就是您如何知道该框是否被选中的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T17:44:19.280

作为一种解决方法，我根据 RC2 源代码的 InputHelper 方法大致提出了以下方法，但对其进行了调整以允许多个值：

```
private static string CheckBoxWithValue(this HtmlHelper htmlHelper, string name, object value, bool isChecked, bool setId, IDictionary htmlAttributes)
        {
            常量 InputType inputType = InputType.CheckBox;
            if (String.IsNullOrEmpty(name))
            {
                throw new ArgumentException("null or empty error", "name");
            }

            var tagBuilder = new TagBuilder("输入");
            tagBuilder.MergeAttributes(htmlAttributes);
            tagBuilder.MergeAttribute("类型", HtmlHelper.GetInputTypeString(inputType));
            tagBuilder.MergeAttribute("name", name, true);
            string valueParameter = Convert.ToString(value, CultureInfo.CurrentCulture);

            如果（已检查）
            {
                tagBuilder.MergeAttribute("checked", "checked");
            }
            tagBuilder.MergeAttribute("value", valueParameter, true);
            if (setId) tagBuilder.GenerateId(name);

            // 如果命名字段有任何错误，我们添加 css 属性。
            模型状态模型状态；
            if (htmlHelper.ViewData.ModelState.TryGetValue(name, out modelState))
            {
                if (modelState.Errors.Count > 0)
                {
                    tagBuilder.AddCssClass(HtmlHelper.ValidationInputCssClassName);
                }
            }
            var inputItemBuilder = new StringBuilder();
            inputItemBuilder.Append(tagBuilder.ToString(TagRenderMode.SelfClosing));

            var hiddenInput = new TagBuilder("input");
            hiddenInput.MergeAttributes(htmlAttributes);
            hiddenInput.MergeAttribute("类型", HtmlHelper.GetInputTypeString(InputType.Hidden));
            hiddenInput.MergeAttribute("name", name);
            如果 (setId)
            {
                hiddenInput.GenerateId(name);
            }
            hiddenInput.MergeAttribute("value", valueParameter);

            inputItemBuilder.Append(hiddenInput.ToString(TagRenderMode.SelfClosing));
            返回 inputItemBuilder.ToString();

        }

```

这依赖于 .ToString() 您评估对象的值，但对于我使用整数表示选项并在后端数据库中完成查找的场景来说已经足够了。请注意 setId 布尔值似乎只是用下划线字符替换 Html 名称中的点。在 HTML 中使用多个复选框时，ID 应该是唯一的，因此我只需通过 htmlAttributes 集合传入唯一的 Id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-10T05:30:52.200

If you've recently gone from "normal" ASP.Net and started using MVC, then you may be very keen to avoid typing straight HTML, but in the MVC world it's not as much of an issue since there is no longer any viewstate and other issues to contend with. So feel free to just use straight HTML if you wish, especially if you're only dealing with integers (don't need to worry about javascript injection or anything).

# c# - 如何使这个类更可重用？（里面的具体例子）

> ID：626910
> 
> 赞同：1
> 
> 时间：2009-03-09T16:09:07.137
> 
> 标签：c#, .net, refactoring

我有一个当前将 IList 作为参数的方法，其中 UserBO 类似于以下内容：

```
public class UserBO {
    public string Username { get; set; }
    public string Password { get; set; }
    public string Pin { get; set; }
}

public class SomeClass {
    // An example method giving the basic idea of what I need to do
    public void WriteUsers(IList<UserBO> users) {
        // Do stuff with users
        for (var user in users) {
            Console.WriteLine(String.Format(User: {0}: {1}, users.Username, Hash(users.Pin)); // Now needs to optionally be users.Password
        }
    }

    private string Hash(string pin) {
        return // Hashed Pin
    }
} 
```

然后，此方法使用用户名/密码对来创建一些由另一个程序使用的 XML（我们将使用上述方法作为示例）。

问题是，现在我需要能够生成相同的代码，除了使用密码字段而不是 Pin 字段（有两个字段的充分理由）。

我宁愿重构代码，以便完全从此类中删除特定于 BO 的代码，而不是仅仅创建另一个具有相似名称的方法，并使其不决定使用哪些类/成员方法本身，但调用它的代码。

一种选择是传递一个 IDictionary 并使用 Linq ToDictionary 方法在调用代码中动态创建字典。但是，这会丢失物品的顺序（这很好但不是必须保留）。我可以使用 IList 或其他东西，但是将 IList 转换为更困难。

有人对如何做到这一点有任何好的建议吗？

PS如果有人对如何为这篇文章命名有更好的想法，请随意尝试一下。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T16:13:15.520

目前尚不清楚*格式化*后需要对字符串做什么。您可以使该方法采用`IEnumerable<string>`，然后使调用代码：

```
WriteUsers(users.Select(user => string.Format("{0}: {1}", 
                                              users.Username, users.Pin))); 
```

这是否适合您将取决于细节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T16:19:23.197

您还可以使用表达式：

```
 WriteUsers(IList<T> users, u => u.Username, u => u.Password); 
```

如果您使用的是 Net 3.5。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T17:06:06.907

首先，为了可用性，我建议将您的 IList 切换为 IEnumerable。如果您不执行任何需要列表的其他逻辑，它会打开您的类以供更多用户使用，并且没有缺点。

如果您想完全消除从课堂上打印的内容的选择，我可以想到几个选项。

一种（尽管可能不太有用）是使用反射。如果性能。不是一个大问题，您可以将其重构为：

WriteElements（IEnumerable 元素，参数 string[] propertiesToWrite）

然后，您可以重构该方法，以便它使用反射从 T 的类型说明符中获取属性，并写出任意数量的属性。然后调用者会这样做：

```
WriteElements(listOfUsers, "Username", "Password"); 
```

第二个可能更清洁的选择是重构它以采取：

```
WriteElements(IEnumerable<UserBO>, Func<UserBO,string>); 
```

然后您可以使用以下命令调用它：

```
// Call using password
WriteElements(listOfUsers, user => user.Password);

// or call using pin
WriteElements(listOfUsers, user => user.Pin); 
```

# protocols - 无状态协议是否被认为比有状态协议更好用？

> ID：626914
> 
> 赞同：11
> 
> 时间：2009-03-09T16:09:30.757
> 
> 标签：protocols, network-protocols

我可以看到有状态的协议可以减少像 cookie 这样的“模拟状态”。

但是测试变得更加难以确保您的实现正确并重新连接，并且会话继续可能很难处理。

始终使用无状态协议是否被认为是更好的做法，还是真的是特定领域的？

我认为在处理有状态协议时身份验证会变得更容易，但是还有其他原因应该使用有状态协议吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-09T16:22:22.643

无国籍的优点：

1.  **高扩展性** *（可以向任何节点发送请求，可以随时添加节点）*
2.  **高可用** *（如果一个节点发生故障，没有状态丢失，只是重新发送请求到另一个节点）*
3.  **高速** *（因为没有状态，结果是可缓存的）*

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T16:24:09.753

状态对您的应用程序有多重要？您是否需要不同机器之间的持续数据流，还是爆发更有用？如果您正在编写 IP 电话类型的应用程序，那么您可能会想要一些相当有状态的东西，如果您可以摆脱无状态，那么这样做可能会更便宜、更容易。有状态地做事必然更脆弱，因为如果连接的任何一端被丢弃或连接本身发生故障，您将面临更高的数据丢失风险，而对于无状态连接，您更有可能只需要等待一段时间并尝试再次。

它们确实是用于不同工作的不同工具，但鉴于无状态技术在线的易用性和普遍性，当您有选择时，朝这个方向看是合乎逻辑的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-09T16:26:02.010

我会认为它是特定领域的。如果您正在编写 ping 的道德等价物，那么无状态协议是正确的选择。另一方面，如果您正在编写 VNC，则肯定是有状态的。

至于什么时候选哪个，有两点要记住。首先，虽然实施选择是非此即彼，但问题空间是一个连续统一体。所有现实世界的任务都至少有一点状态，问题是多少以及传递它的开销是否值得在两端跟踪它的麻烦。其次，您通常处理的是协议栈，而不是单个协议；确保一切都生活在正确的水平上可以极大地简化事情。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-09T16:18:31.170

无状态协议更容易集群，因为状态永远不需要在后续请求时从一台服务器传输到另一台服务器。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-09T16:32:37.440

我个人并不熟悉有状态与无状态的所有设计问题，但我确实知道 NFSv4 在 15 年之前的 NFS 版本无状态之后是有状态的，因此显然无状态成为 NFS 设计者的一个重大限制。

几分钟的谷歌搜索显示了几篇谈论 NFSv4 的状态的文章和博客；对于所涉及的一些设计问题，这应该是有趣的阅读。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-09T16:17:23.980

无状态协议的另一个好处是它更容易处理服务器故障转移情况和/或集群/负载平衡情况。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-09T16:26:10.777

有状态的更好。然后你不必一直发送状态。然后协议变得更简单。

# iphone - 分发 iPhone 应用程序的开发版本

> ID：626922
> 
> 赞同：5
> 
> 时间：2009-03-09T16:11:03.683
> 
> 标签：iphone

我的公司最近开始为各种客户开发定制的 iPhone 应用程序。我们遇到的挑战之一是如何将这些应用程序提供给客户，以便他们在开发过程中对其进行审查。

理想情况下，这只是向他们发送应用程序文件并让他们将其安装在 iPhone 上的问题。当然，应用签名让事情变得比这复杂得多。我们必须将他们的手机 ID 添加到我们的开发配置文件中，让他们配置手机以接受该应用程序，然后安装该应用程序。这当然让我们在试图引导客户完成这个过程时感到头疼。

在这一点上，我们最好的解决方案是要么简单地向他们发送屏幕截图，要么向安装了应用程序的 iPod Touch 来回发送邮件。当然，这些选项都不是理想的。

有没有更好的方法将 iPhone/iPod Touch 应用程序的开发版本分发给非技术客户？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T16:25:35.350

您是否使用 Ad-Hoc 分发配置文件？对我来说，过程是这样的：

他们发送他们的设备 uuid - 单击设备 sn 后在 iTunes 中可见。然后我将编译后的应用程序和配置文件发送给他们。他们将两者都拖到 iTunes，并同步他们的 iPhone。

我不认为这对非技术客户来说是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T17:49:14.230

您可以通过电子邮件向他们发送临时配置的设备，然后通过电子邮件发送/让他们下载更新的构建。最好的两种方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-09T16:56:30.330

我们对非技术用户运行了一个类似的测试程序。我们有 30-40 名参与者，他们中的大多数人都不是技术人员，在他们的手机上组织配置和获取应用程序肯定很痛苦。我们遇到了以下问题：

*   与 Windows 用户打交道。我们在 Mac 上工作，很难确保您的分发存档能够与 Windows 版本的 iTunes 一起正常工作。在 Windows VM 上测试安装会有所帮助，但这绝对是一个棘手的领域。
*   为用户提供 beta 应用程序。由于我们没有明确的 beta 时间表（我们的错），我们在用户进入时提供用户，当我们觉得积累的足够多时，我们推出了一个可以在新设备上运行的新版本。除非您有条理，否则某些用户可能会不小心被排除在外，并且没有为特定构建配置。如果它们没有被配置，这可能很难从它们尝试安装时弹出的 iTunes 错误消息中进行调试。
*   在用户尝试安装或升级时处理 iTunes 错误。iTunes 似乎对您如何安装应用程序非常讲究，我们永远无法破解让我们的用户安装或升级应用程序的最佳方法的代码（拖放 .app 文件/目录？构建一个 .ipa 文件并提供它对他们那样？）

话虽如此，如果您只向每个客户端的几个用户分发，则临时分发应该是可管理的，并且绝对比屏幕截图或邮寄设备更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-14T20:41:06.350

您应该熟悉 Ad Hoc 分发和配置文件。如果没有，请访问苹果开发者网站并在“Provisioning Portal”中进行一些阅读。

首先，转到苹果开发者并将您客户的设备添加到您的个人资料中。现在，您需要创建一个配置文件，其中包含所有设备 ID。下载 Ad-Hoc 配置文件并将其拖到 Xcode。

从这里开始，有许多分发选项。

我使用 Test Flight [https://testflightapp.com](https://testflightapp.com)在测试人员和客户之间分发我的 Beta，我对他们的服务非常满意。您可以访问他们的网站并阅读“支持”中的文章

# c - EPS在C中是什么意思？

> ID：626924
> 
> 赞同：9
> 
> 时间：2009-03-09T16:11:58.533
> 
> 标签：c, eps

我有以下代码片段：

```
if (ABS(p43.x)  < EPS && ABS(p43.y)  < EPS && ABS(p43.z)  < EPS) return(FALSE); 
```

我正在尝试将其转换为 C#。“EPS”是什么意思？

此代码来自[http://local.wasp.uwa.edu.au/~pbourke/geometry/lineline3d/](http://local.wasp.uwa.edu.au/~pbourke/geometry/lineline3d/)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-09T16:14:28.950

这将是某种形式的[epsilon](http://en.wikipedia.org/wiki/Epsilon)来确定这个数字是否“小到可以忽略不计”。在这种情况下，确切的值看起来像是在`#define`某个地方。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-09T16:17:12.657

EPS是ε。“足够接近”的因素。

问题是“绝对值是否足够接近？” 其中“足够接近”是一些小的数字，通常是`1.0E-3`.

根据算法如何收敛到答案，性能可能取决于 EPS 的大小。注意不要让 EPS 太小，因为你的过程可能会运行几个小时（或几个世纪）而不会产生真正有用的答案。

在这种情况下——没有循环——使用 EPS 是因为浮点数在乘法过程中会累积小错误。你不能简单地说

```
a == b 
```

并且一般来说是真的。所以我们总是说

```
abs( a-b ) <= EPS 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T16:21:06.500

我会说乔恩斯基特是正确的。通过查看该页面上的 lisp 代码，您会在计算中找到类似的参考，称为“nearzero”，其定义如下：

```
(setq nearzero 0.00001) 
```

因此，我会说 EPS 是一个设置为 0.00001 的常数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T16:16:05.887

Epsilon ...它可能是一个#define ...

Epsilon 通常用于表示在浮点或双精度范围内非常接近零的数字。

它用于确定 p43.x 的值是否足够接近零以计为零。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T16:16:16.980

我会说 EPS 适用于 Epsilon：

> 在数学（尤其是微积分）中，任意（或几乎如此）小的正数。

在您的示例中，它用于确定 (ABS(p43.x) 的结果是否足够小（接近于零）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-09T16:19:40.950

最有可能的`p43`是一个保存浮点值的结构。由于浮点值具有有限的精度，它们只能表示实数的一个子集，这意味着通常需要检查相等性并留出舍入误差的余量。

`x = 0`代码检查而不是检查`|x| < EPS`，即所有值`]-EPS, +EPS[`都被认为足够小`0`。

您也可以考虑阅读[机器 epsilon](http://en.wikipedia.org/wiki/Machine_epsilon)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-09T17:00:47.760

在 C 和 C++ 中，您有预处理器常量 FLT_EPSILON 和 DBL_EPSILON，它们是最小的数字，例如 1 + {FLT,DBL}_EPSILON > 1 分别表示浮点和双精度。这个 EPS 似乎是一些类似的特定于应用程序的“接近于零”的值。

# c# - NHibernate 中使用事件的数据审计

> ID：626931
> 
> 赞同：9
> 
> 时间：2009-03-09T16:13:22.710
> 
> 标签：c#, .net, nhibernate, reflection

我正在重新访问并重新实现导致我问[这个](https://stackoverflow.com/questions/15917/data-auditing-in-nhibernate-and-sqlserver)关于 NHibernate 中的数据审计的问题的代码。但是这一次，我想采纳[Sean Carpenter](https://stackoverflow.com/users/729/sean-carpenter)的[建议](https://stackoverflow.com/questions/15917/data-auditing-in-nhibernate-and-sqlserver/142767#142767)并实施 ISaveOrUpdateEventListener（NHibernate 2.x 中的新功能）

我想在数据库中为每个属性的旧值和新值的每次更改添加一行，所以稍后在 UI 中我可以说*“用户 Bob 于 2009 年 3 月 9 日 21 点将 Wibble 的属性从 A 更改为 B： 04"*

比较对象状态以确定对象的哪些属性已更改的最佳方法是什么？

您可以通过以下方式获取对象的加载状态：

```
 public void OnSaveOrUpdate(SaveOrUpdateEvent saveOrUpdateEvent)
    {
       object[] foo = saveOrUpdateEvent.Entry.LoadedState;
    } 
```

而且我想我可以使用反射来确定哪些属性已更改，但我一直在挖掘，似乎没有一组匹配的属性可供比较。我会认为会有一个 GetChangedProperties() 方法或其他东西。

我总是可以按原样从数据库中获取旧对象并进行比较，但这是另一个数据库命中，在这种情况下看起来很重。

最好的方向是什么？

PS 如果有什么不同，这是一个 ASP.NET-MVC / S#arp 架构项目。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-07-27T13:24:29.383

您还可以使用 Persister 上的 FindDirty 方法让 NHibernate 为您进行比较：

```
var dirtyFieldIndexes = @event.Persister.FindDirty(@event.State, @event.OldState, @event.Entity, @event.Session);

foreach (var dirtyFieldIndex in dirtyFieldIndexes)
{
    var oldValue = @event.OldState[dirtyFieldIndex];
    var newValue = @event.State[dirtyFieldIndex];

    // Log values to new "AuditLog" object and save appropriately.
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-09T18:27:48.207

我不知道如何通过接口实现您想要的- 但是您可以利用接口和接口都提供您需要`ISaveOrUpdateListener`的事实......例如做这样的事情：`IPreUpdateEventListener``IPreInsertEventListener`

```
public bool OnPreUpdate(PreUpdateEvent evt)
{
    string[] names = evt.Persister.PropertyNames;
    for(int index = 0; index < names.Length; index++)
    {
        // compare evt.State[index] to evt.OldState[index] and get
        // the name of the changed property from 'names'
        // (...)
    }
} 
```

并对预插入做同样的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T17:23:17.193

您可以通过*ILoadEventListener*实现 Memento 模式以序列化初始 Load 的状态。显然，您不想存储集合/关系，否则您会复制整个对象图。然后，您可以将其拉出并在您的*ISaveOrUpdateEventListener*中进行比较。

# stdout - ABAP 标准输出和标准错误

> ID：626932
> 
> 赞同：1
> 
> 时间：2009-03-09T16:13:48.250
> 
> 标签：stdout, abap, stderr

ABAP 是否允许写入标准输出和标准错误？我需要编写小程序来测试通过作业调度程序（Cronacle）与 SAP 系统的接口连接。例如，开始/编写“Hello World！” + 日期 + 时间到标准输出/退出。我是一名 .net 程序员，负责处理这个看似琐碎的程序，但我被困住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-03-29T21:27:20.387

我假设您在带有 ABAP 堆栈的基于 UNIX/Linux 的系统上运行 SAP。SAP 试图尽可能多地抽象出底层操作系统。这种技术将在 Windows 上进行一些小的修改。

要与操作系统交互，请查看此处的 SM49“外部操作系统命令”，您可以设置一个命令来运行 cat 并将您想要写出的值传递到控制台。

我认为您最好通过将消息写入主机系统上的文件。要做到这一点;

```
OPEN DATASET i_file FOR OUTPUT IN TEXT MODE ENCODING DEFAULT. 
```

然后使用将数据写入文件；

```
TRANSFER wa_text TO i_file. 
```

那么当你完成时不要忘记

```
CLOSE DATASET i_file. 
```

然后，您可以查看 AL11 中文件的内容或直接从主机中获取。如果您想查看在 unix 主机上打印的消息。使用控制台连接并使用 less +F /var/log/ 或 tail。在 Windows 上，我相信有一个同等的替代品。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-02-06T22:43:04.343

Appliaction Log (Transaction SLG0, SLG1) Tables BAL*, 非常非常适合追踪...非常有趣，因为它甚至适用于后台任务、不同的用户帐户、用户不可见以及旧追踪的擦除条目可以在创建时定义。这对我来说是天堂，我不必再调试了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-05T07:24:17.370

有几个选项可以像您所询问的那样编写“调试信息”。前面的答案中提到的两种可能性是应用程序日志（SLG1 和 SBAL* 功能模块）和写入文件。

但是，对于您的情况，您提到在后台运行程序。在这种情况下，最好的办法是简单地使用 MESSAGE 发出消息（您可以通过检查 SY-BATCH 的值将消息的发出限制为后台处理）。

当您转到 SM37 时，可以在作业日志中看到后台运行的程序发出的消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-29T17:56:04.950

查看应用程序日志记录 - [http://help.sap.com/saphelp_nw04/helpdata/en/d3/1fa03940fab918e10000000a114084/frameset.htm](http://help.sap.com/saphelp_nw04/helpdata/en/d3/1fa03940fab918e10000000a114084/frameset.htm)

# .net - 是否有任何陷阱或充分的理由不使用 autosproc 进行存储过程调用？

> ID：626933
> 
> 赞同：1
> 
> 时间：2009-03-09T16:13:57.907
> 
> 标签：.net, stored-procedures, data-access-layer, ilgenerator

我已经实现了一个数据访问层，它使用第三种猴子方法（[http://www.codeproject.com/KB/database/DynamicMethod_ILGenerator.aspx](http://www.codeproject.com/KB/database/DynamicMethod_ILGenerator.aspx)）的变体从数据读取器填充通用实体。这工作得很好，执行得很好，并且节省了我为数据检索编写大量重复代码的时间。

现在我想添加采用通用实体的方法并将其转换为参数列表以提供给存储过程，这样我就可以将数据持久性添加到猴子的技巧集合中。

我在以下位置找到了一些指导：http: [//msdn.microsoft.com/en-us/library/ms973259.aspx](http://msdn.microsoft.com/en-us/library/ms973259.aspx)和 autosproc 解决方案中的一些示例代码。它在纸上看起来不错，我打算将其合并，但快速的谷歌并没有在实现 autosproc 的用户体验方面出现太多，我正在寻找任何去过那里并做过的人的竖起大拇指（或向下）已经。

那么，您是否使用过 autosproc？它对你有用吗？性能或其他方面是否存在任何使其不适合企业应用程序的巨大缺陷？

建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-30T11:59:28.683

我认为向您推荐这个问题更容易，我的答案包含指向您的 AutoSproc 事物的链接：[TSQL - Parse Execution Plan to determine columns to be returned by a stored procedure](https://stackoverflow.com/questions/1256619/tsql-parse-execution-plan-to-determine-columns-to-be-returned-by-a-stored-proce/1256698#1256698)

总而言之，我不喜欢它：它引起了太多问题。

（只是在未回答的问题上闲逛，发现了这个）

# c# - 为什么按匿名对象的键分组不符合预期？

> ID：626935
> 
> 赞同：1
> 
> 时间：2009-03-09T16:14:21.260
> 
> 标签：c#, .net, vb.net, linq, anonymous-class

我有一个这种格式的 csv 文件

```
 A,B,value
 a1,b1,10
 a2,b1,12
 a2,b1,15
 a2,b2,14
 a1,b1,12 
```

我在我的应用程序中将其转换为数据表。

```
 Dim enumerable = _dt.AsEnumerable

 Dim groupedResults = enumerable.GroupBy( _
                                   Function(x) _
                                        New With { _
                                                  .A = x.Item("A").ToString, _
                                                  .B = x.Item("B").ToString _
                                                 } _
                                        ) 
```

我希望 groupedResults 计数为 4 而不是显示的 5。
基本上它不会按第 1 行和第 5 行归为一组。

我预计具有相同值的对象将产生相同的键。

可能是什么原因？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T16:20:32.740

使匿名类型属性不可变——这是使相等和散列起作用的方法。（在 C# 中，默认情况下所有匿名类型都是不可变的。）

试试这个

```
 Dim enumerable = _dt.AsEnumerable

 Dim groupedResults = enumerable.GroupBy( _
               Function(x) _
                    New With { _
                              Key .A = x.Item("A").ToString, _
                              Key .B = x.Item("B").ToString _
                             } _
                    ) 
```

编辑：这`Key`部分意味着属性是匿名类型的键。有关详细信息，请参阅[VB 匿名类型 MSDN 页面](http://msdn.microsoft.com/en-us/library/bb384767.aspx)。

# drupal - 通过 Drupal 进行查询时，Apache Solr 结果不同——为什么？

> ID：626938
> 
> 赞同：6
> 
> 时间：2009-03-09T16:14:47.263
> 
> 标签：drupal, solr

我正在尝试使用[Drupal为](http://drupal.org)[Apache Solr](http://lucene.apache.org/solr/)创建自定义搜索界面，但结果出现了一些奇怪的问题。

当我从 Solr 的内置 Web 界面运行它时，我有相同的查询产生 8 个命中，而当我通过 Drupal 运行它时产生 0 个命中。谁能解释为什么？

以下是查询，均取自 Solr 日志：

*   Solr 后端

    > `INFO: [] webapp=/solr path=/select params={wt=standard&rows=10&start=0&explainOther=&hl.fl=&indent=on&q=ss_cck_field_goal:sell+AND+ss_cck_field_type:(own+OR+coop+OR+house+OR+commercial)+AND+is_price:[10000+TO+5560000]&fl=*,score&qt=standard&version=2.2} hits=8 status=0 QTime=2`

*   Drupal ApacheSolr 模块

    > `09-Mar-2009 15:37:31 org.apache.solr.core.SolrCore execute INFO: [] webapp=/solr path=/select params={wt=json&rows=10&json.nl=map&start=0&q=ss_cck_field_goal:sell+AND+ss_cck_field_type:(own+OR+coop+OR+house+OR+commercial)+AND+is_price:[10000+TO+5560000]&version=1.2} hits=0 status=0 QTime=9`

唯一在我眼中突出的是`version=1.2`参数，但我已经尝试删除它，但这并没有改变行为。

经过大量调整后，我设法向 Drupal 模块发送或多或少相同的参数，但它仍然给出 0 个结果：

> `09-Mar-2009 17:47:43 org.apache.solr.core.SolrCore execute INFO: [] webapp=/solr path=/select params={wt=standard&rows=10&start=0&q=ss_cck_field_goal:sell+AND+ss_cck_field_type:(own+OR+coop+OR+house+OR+commercial)+AND+is_price:[10000+TO+5560000]} hits=0 status=0 QTime=13`

谁能解释一下？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T00:56:52.860

[请求处理程序](http://wiki.apache.org/solr/SolrRequestHandler)（qt 参数）可能不同。未定义时（Drupal 查询未定义）Solr 使用默认处理程序。也许配置的默认处理程序不是标准请求处理程序...检查您的 solrconfig.xml

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T16:49:41.533

Drupal 查询中是否应该有一个非空`fl`（字段列表）参数？没有要显示的字段：没有结果？

# java - 如何在命令提示符下运行 NetBeans 项目？

> ID：626940
> 
> 赞同：15
> 
> 时间：2009-03-09T16:15:28.760
> 
> 标签：java, command-line, netbeans

我的教授要求我们创建一个能够在命令提示符下运行但也可以使用 NetBeans 打开的 Java 程序。

该程序是关于使用不同类型的排序（特别是选择、插入、交换、快速和堆排序）。我们的教授特别告诉我们在 Java 中使用面向对象编程，并且她希望看到一个主类以及可以进行排序的不同类。

我尝试在 NetBeans 中编写程序——想着以后我可以使用 javac 在 cmd 中简单地运行程序。

在 cmd 中，我输入了保存 NetBeans 项目的路径，并尝试使用 javac 编译文件。但它说“'javac' 不被识别为内部或外部命令、可运行程序或批处理文件。”

所以我尝试将文件保存在 sun>sdk>jdk>bin 中，并从那里尝试编译文件，结果很好。当我尝试运行它们时，问题就出现了。

这是我尝试编译文件的方式：

```
javac Main.java
      Sortchoice.java
      Selection.java
      SelectionSort.java
      Insertion.java
      InsertionSort.java
      Exchange.java
      ExchangeSort.java 
```

（我还没有完成接下来两个排序的语法。）

以下是我尝试在 cmd 中运行文件的方法：

```
java Main Sortchoice Selection SelectionSort Insertion InsertionSort Exchange ExchangeSort 
```

和 cmd 说：

```
exception in thread "main" java.lang.NoClassDefFoundError: main (wring name: myjava/Main)
at java.lang.ClassLoader.defineClass1(Nativ... Method)"
at java.lang.ClassLoader.defineClass(ClassL...
at java.security.SecureClassLoader.defineCl...
at java.net.URLClassLoader.defineClass(URLC...
at java.net.URLClassLoader.access$000(URLCl...
at java.net.URLClassLoader$1.run(URLClassLo...
at java.security.AccessController.doPrivile... Method)
at java.net.URLClassLoader.findClass(URLCla...
at java.lang.ClassLoader.loadClass(ClassLoa...
at sun.misc.Launcher&AppClassLoader.loadCla...
at java.lang.ClasLoader.loadClass(ClassLoad...
at java.lang.ClassLoader.loadClassInternal(... 
```

我应该怎么办？（对不起，我的解释很长。我只是想提供尽可能多的细节。）

我还想强调一下，我只是 Java 编程的初学者。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2011-02-08T21:27:54.893

如果您在 NetBeans 中单击构建，它应该（在您的编译器输出中）给您一条消息，例如“要在没有 Ant 的情况下从命令行运行此应用程序，请尝试：java -jar yourPathToRun”

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-09T16:52:06.160

最好的方法是：

1）在其中创建一个目录（如果您不使用 JUnit，则测试是可选的）`src\`。`tests\`

2）假设你有`package myjava;`你的文件的顶部（并确保这是你的教授想要的，如果它们不在正确的位置标记东西会变得很痛苦），创建一个`src\myjava`目录（如果你正在做 JUnit一个`tests\myjava`目录）。

3）将文件复制到`src\myjava`目录中

4) 删除您的 NetBeans 项目并将其重新创建为具有现有源的新项目。当您设置`src`（和可选的`test`）目录时，添加`src\`（和可选的`tests\`）目录。不要添加`src\myjava`目录，否则它在 NetBeans 中不起作用。

5）创建一个名为的目录`classes\`（所以你有`src\`，，，`classes\`也许`\tests`都在同一个地方）

6）关于命令行类型`javac -d classes -cp classes src/myjava/*.java`

*   `-d`告诉编译器将 .class 文件放在哪里
*   `-cp`告诉编译器在哪里寻找类文件
*   `src/myjava/*.java`告诉它编译所有的 .java 文件`src/myjava`

7）通过运行它`java -cp classes myjava.Main`

*   `-cp`classes 告诉它在 classes 目录中查找 .class 文件
*   `myjava.Main`是要运行的类的名称

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-09T16:25:10.017

1.  最好将 javac 添加到您的 PATH 环境变量中，而不是将 .java 文件与它放在同一目录中。那里会变得非常拥挤。
2.  要运行，您只需要

    > `java Main`

    而不是将每个类都放在命令行上。

3.  您是否在 .java 文件中声明了一个包？喜欢，

    > 包我的java；

    ? 如果是这样，命令字符串必须是

    > `java myjava.Main`

这能回答你的问题吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-11-11T00:26:02.337

右键我的电脑>属性>高级>环境变量...将jdk中的bin目录添加到Path变量示例中：变量名：path变量值：C:\Program Files\Java\jdk1.6.0_16\bin

java 和 javac 现在应该可以在命令提示符下的任何目录中工作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T16:50:57.363

请按照以下步骤操作（代码示例只是示例，您需要针对您的设置进行一些调整）：

1.  将您的 JAVA_HOME 设置为安装 JDK 的目录。

    设置 JAVA_HOME="c:\Program Files\Java\jre1.6.0_12"

2.  设置您的 PATH 以包含`bin`JAVA_HOME 中的目录。

    设置 PATH=%PATH%:%JAVA_HOME%\bin

3.  切换到源代码的根目录。如果您已将代码声明在包中，则这是包结构的根目录。如果没有，这是包含 .java 文件的目录：

    cd c:\我的\源\目录

4.  使用您的 Java 文件作为参数执行 javac：

    javac Class1.java Class2.java

5.  （假设一切编译正确）`java`使用包含您的 main 方法的类的名称作为参数执行（如果您包含包声明，那么您的类名是完全限定的，这意味着它应该在类名之前包含包名，并带有'.' 将包名与类名分开）：

    java 主程序

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-09-09T04:24:30.767

最简单的方法是运行项目主`.jar`文件`dist`夹下的文件夹中的文件。确保`bin`您计算机中 jdk 文件夹`System`的路径`Environmental Variables`设置为找到通常的：`jar.exe`、`java.exe`、`javac.exe`等（如果您需要有关操作的说明，请参阅此线程中的其他帖子）。

1) 在 Netbeans 中进行干净构建，按`F11`或单击`Run`菜单并单击`Build Project`。单击以通过所有提示，您需要一个干净的构建来执行此操作。

2）在命令提示符中导航到您的项目`dist`文件夹

3）在命令行输入并运行：`java -jar yourMainFile.jar`

无需创建单独的文件夹，无需复制文件，也无需在命令行参数中包含多个文件。但是每次在命令行上运行代码之前，您都必须重新构建您的项目。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-30T22:38:24.440

您的项目中将有一个**构建**目录。导航到它。接下来打开**类**文件夹。
现在在这里打开终端并运行`java x/y`
**，其中**x 是您的主类所在的包的名称，y 是该 java 文件的名称

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-23T13:40:56.993

在某处创建一个文件夹，例如`C:\myjava`. `.java`例如，从 netbeans 将它们保存到您的任何位置复制您的源文件`C:\java`。打开您刚刚粘贴的每个`.java`文件并删除说明包的行，例如`package myjava`. `javac`使用例如编译`javac c:\myjava\MyJava.java`。然后像在java中一样运行它`c:\myjava\MyJava`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-04T05:46:50.877

注释掉 class.java 文件中的 package 行。

# ms-access - 使用 Microsoft Access DSN 时，我是否只需将数据库连接字符串替换为 DSN 的路径？

> ID：626941
> 
> 赞同：1
> 
> 时间：2009-03-09T16:15:42.003
> 
> 标签：ms-access, shared-hosting, dsn

我继承了一个带有 Access 后端的 Web 应用程序（是的，我知道）。

我需要尽快将这个东西部署到共享托管服务提供商。不幸的是，这并不像我想象的那么容易，因为主机倾向于锁定对 Access 数据库 (AFAICT) 的访问。

我有一个与 GoDaddy 共享的帐户 - 我已启用 Access 数据库使用，并创建了一个 DSN。

该应用程序对数据库连接字符串的引用随处可见。使用 DSN 是否只是将连接字符串更改为 DSN 的路径？

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-09T16:21:33.893

自从我这样做以来已经有一段时间了，但是您应该能够将连接字符串更改为 DSN=MYDSNNAme

不过我会先在本地尝试。

显然，如果您要解决这个问题，请将每次出现的情况替换为一个变量，因此如果您需要再次执行此操作会更容易:)

# flash - 在 Flash (AS3) 中检测鼠标滚轮的移动

> ID：626953
> 
> 赞同：3
> 
> 时间：2009-03-09T16:18:02.497
> 
> 标签：flash, actionscript-3, mousewheel

我有一个必须检测鼠标滚轮事件 (MouseEvent.MOUSE_WHEEL) 的 Flash 应用程序，我已经在独立的 Flash 播放器上进行了测试，并且运行良好，但是当我将 swf 放入网络浏览器时，鼠标滚轮停止工作。

我已经测试过：Internet Explorer 7.0、Mozilla Firefox 3、Safari 3 和 Google Chrome；这种行为发生在所有浏览器中

PS：swf文件嵌入在页面正文中，一个只有swf的简单页面。

编辑： swf 将 wmode 设置为 opaque，并且在发生此错误时会关注它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T16:39:59.310

当您尝试滚动时，您的 SWF 文件是否有焦点？如果没有，浏览器窗口将滚动。

可能相关：我在 Adob​​e JIRA btw 中发现了这个错误：[https](https://bugs.adobe.com/jira/browse/FP-289) ://bugs.adobe.com/jira/browse/FP-289这是 wmode 是透明或不透明的时候。你能检查你的这个属性的html代码吗？这是一种解决方法：http: [//www.adobe.com/cfusion/communityengine/index.cfm? event=showdetails&productId=2&postId=13086](http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&productId=2&postId=13086)

# iphone - 通过 App Store 提供的软件即服务

> ID：626954
> 
> 赞同：3
> 
> 时间：2009-03-09T16:18:05.150
> 
> 标签：iphone, app-store

我想通过 iPhone App Store 开发和启动一个应用程序。该系统将包括一个 Cocoa-touch 原生 iPhone 应用程序以及对 https 网络服务的访问。如果不访问网络服务，iphone 应用程序将毫无用处。

在遵守 Apple 的条款和条件的情况下，我预见到这样做会出现多个问题：

1 - 付费应用程序将包括对网络服务的固定期限（1 个月）访问。我的一个客户怎么能在不通过虚拟 App Store 程序下载来充值他们的服务器租金的情况下购买每月扩展？

2 - 我了解 App Store 不提供每位客户的销售信息。因此，如果我的应用程序的付费版本在 Jailbroken 社区中流通，我的 Web 服务如何区分访问权限与真正的 App Store 客户与盗版客户端安装？

更新1：

感谢大家。我没有勾选一个具体的答案作为最佳解决方案，因为这不是一个纯粹的技术问题。看来我将不得不加入 Apple 的 99 美元开发者计划，并尝试直接从 Apple 获得回应。

回覆。充值要求，我目前的想法是一个单独的 App Store 程序下载，它只是通过 iPhone 应用程序间 URI 消息协议 ping 我的主应用程序以提供信用令牌。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-09T16:26:58.717

免费赠送应用程序，仅对服务收费。这样您就不必担心人们如何获得该应用程序，您可以建立自己的商店来销售订阅。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T16:26:37.453

我认为 Apple 会取消您提到的基于订阅的程序之类的任何东西。参见 SDK 协议中的此条款：

> 第 3.3.3 节：
> 
> 未经 Apple 事先书面批准，应用程序不得通过 App Store 以外的分发机制提供、解锁或启用其他特性或功能。

至于从苹果商店获取某种“客户 ID”以了解应用程序是否合法，我认为没有办法做到这一点，但如果有的话，我很想听听。我能想到的最接近的方法是使用手机本身的 DeviceID。您可能会将其与用户帐户绑定，但您仍然必须解决确保应用程序实际下载合法的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T11:09:22.327

为了回答我自己的问题，昨天苹果公司宣布了 iPhone o/s 的 v3.0 将于夏季中旬发布。新的操作系统支持应用程序触发的购买升级，这将是我最初关于 Web 服务订阅的问题的理想解决方案。

新的购买功能通过通常的 Apple App Store 设置进行支付处理，Apple 采取标准的 30% 提成。一个缺点是免费应用无法触发应用内购买。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-13T00:58:06.423

我相信商店里有一些与订阅服务相关的应用程序，我建议做一些研究，看看苹果已经允许什么。Apple 试图阻止的是共享软件模式，在这种模式下，应用程序免费下载，然后通过直接向开发人员付费提供注册码。在这种情况下，Apple 处理所有托管和分发，但没有获得任何收益。

如果您不是故意尝试将其删除，而是诚实地为持续服务收费，他们可能会允许在商店中这样做。他们可能要求应用程序按原样运行。

请注意，在当前的 App Store 模式下，一旦您下载了一个应用程序，您就有权永久免费获得所有更新。这与音乐不同，您必须再次付费才能再次下载歌曲。因此，您的“充值”应用程序的想法将行不通。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-13T13:56:27.460

我也期待着启动这个应用服务。但我意识到这个应用程序应该有一些真正的目的来提供这些信息。我确实打算通过 And Online SQL 数据库提供有价值的信息。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-09T17:18:26.550

我相信您可以为 App Store 中的应用程序更新收费。因此，当每个人都需要重新订阅时，请强制每个人更新应用程序以继续工作。

# sql-server - 在 Where 子句中按一小组 ID 过滤的性能影响

> ID：626961
> 
> 赞同：2
> 
> 时间：2009-03-09T16:20:28.030
> 
> 标签：sql-server, performance

我有一张表，里面有数百万行。

我想添加一个整数列（索引），它将保存 1-1000 个唯一值（在大多数情况下可能小于 30）。

如果我的查询如下所示，查询性能会大大降低：

SELECT * FROM MyTable WHERE GroupID IN (1, 123, 20, 30, 40)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T16:22:49.913

确保您的表在 GroupID 上有一个索引。

否则应该没问题——这就是数据库的本意。

# iphone - 在白色背景上的“信息暗”按钮上创建“突出显示”效果

> ID：626965
> 
> 赞同：3
> 
> 时间：2009-03-09T16:21:01.273
> 
> 标签：iphone

如果我在屏幕下角的深色背景上放置一个“信息灯”按钮并选中“在高亮时显示触摸”，当用户触摸图标时，我会得到一个很好的高亮效果。它给用户积极的反馈。

在我的应用程序中，背景是白色的。所以我选择了“信息暗”按钮。“Shows Touch On Highlight”和“Highlighted Adjusts Image”被选中。但是因为背景是白色的，所以高亮效果是不可见的，用户也得不到任何反馈。

如何创建某种类似高光/低光的效果来为使用提供一些反馈，然后触摸信息按钮？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-09T19:17:12.770

更新：我已经想通了。创建一个名为 infoDarkHighlighted.png 的带有暗光的新图像，并在 ViewController 的 viewDidLoad 方法中设置以下内容。

[infoButton setImage:[UIImage imageNamed:@"infoDarkHighlighted.png"] forState:UIControlStateHighlighted];

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T17:42:42.170

触摸按钮时看到的“发光”是固定的，无法更改。

最好的办法是自己编写一个自定义按钮，以提供这种发光，但颜色为深色。

# c# - 检查 OleDbConnection 状态的最佳方法

> ID：626984
> 
> 赞同：9
> 
> 时间：2009-03-09T16:26:05.927
> 
> 标签：c#, connection, oledb, database-connection, oledbconnection

显然（[MSDN](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbconnection.resetstate.aspx)）有时 OleDbConnection.ResetState() 什么都不做，所以即使连接失败 OleDbConnection.State 仍将设置为打开。我正在为此寻找最佳解决方法，以便在检查连接状态时可以避免引发异常（只要在上次检查和使用尝试之间连接没有失败）。

有没有比每次发送一个“无用”的sql语句只是为了查看是否抛出异常更好的了？在实际使用之前，如何确保连接已打开？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-09T16:49:31.487

在您的情况下，我会执行以下操作：

1.  在使用它之前不要担心连接是否“真的”打开：无论如何，它会在大多数情况下出现，并且您将节省大量无用的服务器往返
2.  但是每次使用连接时检查是否有任何异常（创建帮助方法以避免在此处复制/粘贴）
3.  如果您有异常，则发送您的“无用”语句来检查数据库连接“真实”状态。我会这样做，因为当与服务器的连接丢失时，您可以获得的异常类型有时会非常令人惊讶（取决于连接断开时发生的情况）

希望这可以帮助。

# c# - C#ActiveX exe？

> ID：626987
> 
> 赞同：1
> 
> 时间：2009-03-09T16:26:22.697
> 
> 标签：c#, com, vb6, out-of-process

我需要一个进程外 C# COM 组件来托管一个 32 位 VB6 COM 对象。我似乎无法弄清楚如何在 C# 中执行此操作。我能想到的最接近的类似物是 activex exe，但 C# 似乎无法做到这一点。由于客户端限制，我无法使用 com+ 或 dllhost.exe。有没有人有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-09T16:36:18.507

请参阅此问题：[.NET 中是否有与进程外 COM EXE 等效的方法？](https://stackoverflow.com/q/604776)

# c# - 防止 RichTextBox 中的自动滚动

> ID：626988
> 
> 赞同：11
> 
> 时间：2009-03-09T16:26:35.253
> 
> 标签：c#, winforms, richtextbox

我有一个使用 RichTextBox 控件实现的只读数据记录窗口。我希望能够禁用用户单击控件时发生的自动滚动，以便用户可以选择特定的日志进行复制/粘贴操作或其他操作。但是，一旦用户在 RichTextBox 中单击，它就会自动滚动到底部，这使得这很困难。

任何人都知道一种方法来覆盖这种行为？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-04-18T16:42:43.433

如果选择未隐藏，RichTextBox 控件会自动滚动到当前选择。RichTextBox.AppendText() 除了附加文本外，还修改当前选择，因此间接触发“自动滚动”行为。请注意，如果 RichTextBox.HideSelection 设置为 true，则当控件未获得焦点时，选择将被隐藏；这解释了您描述的行为，其中自动滚动仅在用户单击控件时发生。（从而赋予它焦点）为防止这种情况，您需要在附加文本时执行以下操作：

1.  备份初始选择
2.  使控件失焦
3.  隐藏选择（通过 Windows 消息）
4.  附加文本
5.  恢复初始选择
6.  取消隐藏选择
7.  重新聚焦控件

您可能还想检查选择是否已经在文本的末尾，如果是，则允许自动滚动行为 - 这基本上模拟了 Visual Studio 的输出窗口的行为。例如：

```
 [System.Runtime.InteropServices.DllImport("user32.dll")]
    static extern IntPtr SendMessage(IntPtr hWnd, UInt32 Msg, Int32 wParam, Int32 lParam);
    const int WM_USER = 0x400;
    const int EM_HIDESELECTION = WM_USER + 63;

    void OnAppend(string text)
    {
        bool focused = richTextBox1.Focused;
        //backup initial selection
        int selection = richTextBox1.SelectionStart;
        int length = richTextBox1.SelectionLength;
        //allow autoscroll if selection is at end of text
        bool autoscroll = (selection==richTextBox1.Text.Length);

        if (!autoscroll)
        {
            //shift focus from RichTextBox to some other control
            if (focused) textBox1.Focus();
            //hide selection
            SendMessage(richTextBox1.Handle, EM_HIDESELECTION, 1, 0);
        }

        richTextBox1.AppendText(text);

        if (!autoscroll)
        {
            //restore initial selection
            richTextBox1.SelectionStart = selection;
            richTextBox1.SelectionLength = length;
            //unhide selection
            SendMessage(richTextBox1.Handle, EM_HIDESELECTION, 0, 0);
            //restore focus to RichTextBox
            if(focused) richTextBox1.Focus();
        }
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T17:40:27.480

你可以看看做这样的事情：

```
[DllImport("user32.dll", SetLastError = true, CharSet = CharSet.Auto)]
private static extern IntPtr LockWindowUpdate(IntPtr Handle); 
```

然后在附加日志数据的方法中（我在这里做一些假设）你可能会做这样的事情：

```
LockWindowUpdate(this.Handle);
int pos = richTextBox1.SelectionStart;
int len = richTextBox1.SelectionLength;
richTextBox1.AppendText(yourText);
richTextBox1.SelectionStart = pos;
richTextBox1.SelectionLength = len;
LockWindowUpdate(IntPtr.Zero); 
```

我做了一个带有计时器的小测试应用程序，它在richtextbox上进行了追加，它阻止了它的滚动，所以我可以进行文本选择。它有一些位置问题，并不完美，但也许它会帮助您找到自己的解决方案。

一切顺利！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-15T13:25:46.470

SytS 的解决方案有一个问题，当“附加”一些文本时，滚动条会移动，从而使选择转到面板顶部。一种解决方案是使用以下命令保存/恢复滚动位置：

```
 [System.Runtime.InteropServices.DllImport("User32.dll")]
    extern static int GetScrollPos(IntPtr hWnd, int nBar);

    [System.Runtime.InteropServices.DllImport("user32.dll")]
    static extern int SetScrollPos(IntPtr hWnd, int nBar, int nPos, bool bRedraw); 
```

[这个解决方案](https://stackoverflow.com/questions/6547193/how-to-append-text-to-richtextbox-without-scrolling-and-losing-selection)对我来说更完整。

# c# - 需要在控件上单击动态创建的链接两次才能执行任何操作？

> ID：626995
> 
> 赞同：1
> 
> 时间：2009-03-09T16:29:27.807
> 
> 标签：c#, asp.net

我有一个 aspx 页面，该页面具有一个控件，该控件用作同一页面上 GridView 的摘要。当页面加载时，它会创建摘要控件并动态创建链接并将事件处理程序附加到它。这是一个片段：

```
protected void Page_Load(object sender, EventArgs e)
{  
    LoadSummaries();    
} 
```

LoadSummaries() 循环遍历 GridView 的 DataSet 并创建链接。以下是我如何创建链接并为其附加事件处理程序的片段：

```
LinkButton lb = new LinkButton();
lb.Text = "Dynamic Text goes here";
lb.Click += new System.EventHandler(this.Search);
lb.CommandName = "CommandName";
lb.CommandArgument = "CommandArgument"; 
```

当我运行该页面时，它可以正常加载所有内容，但是我需要单击该链接两次才能进入 Search 方法。第一次点击时，页面会重新加载，但不会进入搜索方法。在第二次单击时，它确实进入了搜索方法。

我很好奇这是否是因为在第一次点击时，它实际上将事件处理程序绑定到了链接按钮，但这发生在 Page_Load 中，所以当页面加载时，会调用 LoadSummaries 进而将事件绑定到链接按钮，所以我一直在理解为什么我需要单击它两次。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-09T16:46:05.643

您是否在页面上的其他地方使用了任何复杂的控件，这些控件可能会将控件注入您的页面？

对于具有将控件注入页面的库中的某些控件的页面，我遇到了这个问题。我正在使用执行此操作的日历控件。发生在我身上的是，当控件由我的代码构建时，控件 ID 看起来都很好，但就在渲染之前，工具包控件正在注入新控件，这意味着我的链接按钮的回发 URL 将自己标识为一个控件 ID，但服务器认为它应该具有不同的控件 ID。

这导致事件处理程序与第一次回发时的控件不匹配，因此事件无法触发。然而，第二次，控件已经被注入，因此我的链接按钮在其回发 URL 中具有新的控件 ID，因此事件可以触发。

解决方案1：摆脱注入并导致问题的控件。不幸的是，并不总是一种选择。在我的情况下，我无法做到这一点。

解决方案 2：摆脱 LinkBut​​ton 并使用常规链接。如果您的事件处理程序必须在该页面上，则可能无法正常工作。

解决方案 3：提供不会被其他控件更改的 ID。（这是 Xaisoft 的解决方案）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T16:54:03.550

杰是对的。由于您没有为控件分配任何 ID，因此回发页面中的某些内容可能正在发生变化，这意味着它无法将事件与控件链接。

顺便说一句，理论上不为控件分配 ID 是不好的做法，因为如果您更改页面布局，它会使任何 UI 集成测试（例如基于 Selenium 的测试套件）中断。

# javascript - 如何在 JavaScript 中提取 location.href 的一部分？

> ID：626996
> 
> 赞同：2
> 
> 时间：2009-03-09T16:29:36.683
> 
> 标签：javascript, regex

在此示例中，从 location.href 中提取“first”的正则表达式是什么，例如：

[http://www.mydomain.com/first/](http://www.mydomain.com/first/)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-09T16:35:43.720

也许不是您的问题的答案，但如果您使用 Javascript 编写，您可能想要使用 location.pathname 而不是自己从整个 href 中提取它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-09T16:37:00.300

[窗口.位置.路径名](https://developer.mozilla.org/en/DOM/window.location)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-09T16:34:16.623

既然您要求使用正则表达式解决方案，那就是：

```
^(?:[^:]+://)?[^/]+/([^/]+)
```

这匹配所有这些变体（匹配组 1`"first"`在任何情况下都将包含）：

*   `http://www.mydomain.com/first/`
*   `http://www.mydomain.com/first`
*   `https://www.mydomain.com/first/`
*   `https://www.mydomain.com/first`
*   `www.mydomain.com/first/`（这个和下一个是为了方便）
*   `www.mydomain.com/first`

为了使它成为“http://”-only，它变得更简单：

```
^http://[^/]+/([^/]+)
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-09T16:35:11.753

您可以使用 window.location.host 和 window.location.search 只需查看[此页面](https://developer.mozilla.org/en/DOM/window.location)了解详情

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-09T16:35:07.760

```
var re = /^http:\/\/(www.)?mydomain\.com\/([^\/]*)\//;
var url = "http://mydomain.com/first/";

if(re.test(url)) {
  var matches = url.match(re);
  return matches[2]; // 0 contains whole URL, 1 contains optional "www", 2 contains last group
} 
```*`**