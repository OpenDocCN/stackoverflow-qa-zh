# StackOverflow 问答 11369000-11369999

# air - Adobe AIR 和设备兼容性

> ID：11369000
> 
> 赞同：1
> 
> 时间：2012-07-06T20:08:11.250
> 
> 标签：air, smartphone

我是一名新手 android 应用程序开发人员，我开始在 Adob​​e Flash 中进行一些测试，然后使用 Adob​​e AIR 发布。

我有一个关于兼容性的问题：我试图在三星 Ace 智能手机上测试我的应用程序，但因为不支持 AIR，所以我做不到。在支持 AIR 的东芝 Thrive 中，它运行良好。我不明白：这是否意味着当我最终在 Google Play 上发布我的应用程序时，只有某些人能够安装它？

为什么某些应用程序，如愤怒的小鸟，是用闪存制作的，并且可以在每部智能手机上运行？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T17:42:07.783

愤怒的小鸟只在 Facebook 版本中使用 Flash。我相信 iOS 和 Android 版本将是原生的。

# php - 在 PHP/MySQL 中创建的 JSON 数组使用 JQuery 错误解码

> ID：11369001
> 
> 赞同：0
> 
> 时间：2012-07-06T20:08:20.807
> 
> 标签：php, jquery, mysql, ajax

我正在尝试对一个非常小的 PHP 脚本进行 AJAX 调用，该脚本应该返回一个可以使用 JQuery 回显和解码的数组。这是我所拥有的：

我的 PHP 页面被 AJAX 调用：

```
$web_q=mysql_query("select * from sec_u_g where uid='$id' ");
$rs = array();
while($rs[] = mysql_fetch_assoc($web_q)) {
}
print_r(json_encode($rs)); 
```

这输出：

```
[{"id":"3","uid":"39","gid":"16"},{"id":"4","uid":"39","gid":"4"},{"id":"5","uid":"39","gid":"5"},{"id":"6","uid":"39","gid":"6"},{"id":"7","uid":"39","gid":"7"},{"id":"8","uid":"39","gid":"8"},{"id":"9","uid":"39","gid":"9"},false] 
```

我不明白最后的“假”..但后来我发送到 JQuery 并使用：

```
$.each(json.result, function(i, object) {
$.each(object, function(property, value) {
    alert(property + "=" + value);
});
}); 
```

这只是失败。我尝试自行提醒“结果”，它是由以下设置的：

```
 $.post("get_ug.php",{id:txt},function(result){
  }); 
```

我的输出警报如下：

```
1)  The key is '0' and the value is '['
2)  The key is '1' and the value is 'f'
3)  The key is '2' and the value is 'a'
4)  The key is '3' and the value is 'l'
5)  The key is '4' and the value is 's'
6)  The key is '5' and the value is 'e'
7)  The key is '6' and the value is ']'
8)  The key is '7' and the value is '
    '    (<-- Yes the line break is there in the alert) 
```

尝试不同的想法和脚本让我筋疲力尽。除了自己设置分隔符并连接我自己的数组并使用自定义脚本对其进行解码之外，有没有人有任何想法？谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T20:12:05.937

`false`来自你的while循环：

```
while($rs[] = mysql_fetch_assoc($web_q)) 
```

在最后一次迭代中，`mysql_fetch_assoc`返回 false，它被插入到 $rs[]，从而找到了你的 json 的方式。
这也是导致您的 json 无效的原因。通过为循环使用临时变量来
摆脱这种情况。 之后一切都会好起来的。`false`

**编辑（带有临时变量的修订代码）：**

```
$web_q=mysql_query("select * from sec_u_g where uid='$id' ");
$rs = array();
$result; //temporary variable to hold the current 'fetch' result.
while($result = mysql_fetch_assoc($web_q)) {
    array_push($rs, $result); //push the result into the array only if it
                              //passed the loop condition.
}
print_r(json_encode($rs)); 
```

**注意：**`array_push($rs, $result);`您当然也可以 使用`$rs[] = $result;`.

**编辑 2 (jQuery + json)：**
为了解析 json 对象，这里有一个如何构建 ajax 调用的示例：

```
$.ajax({
    url: "get_ug.php",
    data: {
        id: txt
    },
    type: "POST",
    dataType: "json", //important (!!) - this makes sure the received data is parsed as json.
    success: function(data){
        //'data' is the resulting json object which is received from your php file.
        //use it to access your data.
        console.log( data );
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:12:06.867

为什么要使用 print_r 打印结果？它不再是递归对象，所以`print` 或者`echo` 应该足够了。

# highcharts - 如何：在 highcharts 中限制 xaxis 标签以防止重叠

> ID：11369004
> 
> 赞同：1
> 
> 时间：2012-07-06T20:08:30.353
> 
> 标签：highcharts, overlap, labels, axes

我的数据系列点在萤火虫中看起来像这样：

```
 l false 
r true  
x 1339214400000 //from a mysql datetime
y 0 
```

如何定义我的 xaxis，以便它只显示尽可能多的标签而不重叠？

我已经尝试了 tickInterval、tickPixelInterval 和 dateTimeLabelFormats，但到目前为止没有任何效果。

目前我这样定义我的xaxis：

```
 xAxis: {
     labels: {
      formatter: function() {
        var date = new Date(this.value);

        return Highcharts.dateFormat('%b %d ', date);
          }
        }

    } 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T17:07:52.330

这就是我所拥有的，它很丑但似乎有效，我希望避免这种事情......

```
 function loadAreaChartForNewsletters(report) {

    var metric = $("#chartSelect :selected").text();
    $("#gaChartLabel").html(metric);
    $("#gaChartNote").html("");
    charts.area.showLoading();

    var start = new Date($("#gaFromDate").val());
    var end = new Date($("#gaToDate").val());
    postSynchronous({
        action  : "getAnalytics",
        report  : report,
        start   : start.strftime("%Y-%m-%d"),
        end     : end.strftime("%Y-%m-%d")
    }, function(data) {
        // Empty the current chart and load new data

        charts.area.hideLoading();
        destroyCharts("area");
        if (checkForErrors(data)) return;

        var pointsopens = data.pointsopens.data;
        var pointsclicks = data.pointsclicks.data;      

        var total = 0;
        var openstotal = 0;
        var clickstotal = 0;
        var length = 0;
        for (var i in pointsopens) openstotal += pointsopens[i].y; 

        for (var i in pointsclicks) clickstotal += pointsclicks[i].y;

        if  ( pointsopens.length > pointsclicks.length) length = pointsopens.length;
        else  length = pointsclicks.length;

        if  ( openstotal > clickstotal) total = openstotal;
        else total = clickstotal;

        $("#gaChartNote").html("Newsletter Open and Click events detected in " + timeDiffToStr(end-start));
        var numdays = Math.floor((end-start) / (1000*60*60*24));
        var days1 = Math.floor(numdays/8 );
        var days2 = Math.floor(numdays/8 )*2;
        var days3 = Math.floor(numdays/8 )*3;
        var days4 = Math.floor(numdays/8 )*4;
        var days5 = Math.floor(numdays/8 )*5;
        var days6 = Math.floor(numdays/8 )*6;
        var days7 = Math.floor(numdays/8 )*7;
        var days8 = Math.floor(numdays/8 )*8;
        var days9 = Math.floor(numdays/8 )*9;
        var days10 = Math.floor(numdays/8 )*10;
        var days11 = Math.floor(numdays/8 )*11;

        var currday=0;

        var plotLinesopen = createPlotlinesForNewsletters(pointsopens, '#AAAAAA');
        var plotLinesclick = createPlotlinesForNewsletters(pointsclicks, '#DDDDDD');
        config.pointIndex = null;
        config.areaPoints = new Array();
        config.areaPoints[0] = plotLinesopen;
        config.areaPoints[1] = plotLinesclick;
        var options = {
            chart : { renderTo : 'areaChart' },
            stacking: 'normal',
            title: {
                text: 'Open and Click events'
            },

            xAxis: {

                labels: {

                     formatter: function() {
                        var date = new Date(this.value);

                        if(numdays > 7){//show 8 dates on xaxis
                            currday++;
                            if(currday ==  days1  || 
                                currday ==  days2 || 
                                currday ==  days3 || 
                                currday ==  days4 || 
                                currday ==  days5 || 
                                currday ==  days6 ||  
                                currday ==  days7 ||
                                currday ==  days8 ||
                                currday ==  days9 ||
                                currday ==  days10 ||
                                currday ==  days11   ){ 

                                return Highcharts.dateFormat('%b %d ', date);
                            }
                            return '';
                        }else{

                            return Highcharts.dateFormat('%b %d ', date);
                        }
                    }  
                }

            },
            yAxis: {
                title: {
                    text: 'Newsletter Events'
                },
            },
            series : [ data.pointsopens, data.pointsclicks ]
        };
        if (length > 100) {
            options.plotOptions = {
                area : {
                    lineWidth: 1,
                    marker : { radius : 1 }

                }
            };
        }
        options = jQuery.extend(true, {}, areaChartDefault, options);

        charts.area = new Highcharts.Chart(options);
    });
} 
```

注释？我应该对这种无耻的黑客行为感到满意吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T16:48:32.707

我认为下面的代码可以提供帮助

```
// iCount refers number of records, I am limiting total number of records to 10 here
if (iCount >= 10)
    iCount = (iCount + 10) / 10;

LineChart1.YAxis.Add(new YAxisItem { title = new Title("Values") });
LineChart1.XAxis.Add(new XAxisItem { tickInterval = iCount,
                                     title = new Title("Date"),
                                     categories = CopyString(0)
                                      .Where(c => c != null).ToArray() }); 
```

# fedora - 在 Fedora 上安装 Komodo Edit 期间？

> ID：11369008
> 
> 赞同：0
> 
> 时间：2012-07-06T20:09:06.130
> 
> 标签：fedora, komodoedit

安装 Komodo Edit 时收到此错误？

```
ImportError: No module named activestate 
```

在 install.sh 字段中，我更改了 python 解释器，因为我遇到了[这个错误](https://stackoverflow.com/questions/11361881/installing-komodo-edit-on-fedora)

所以文件的更改部分现在看起来像这样：

```
python -E $dname/support/_install.py "$@" 
```

而不是这个

```
$dname/INSTALLDIR/lib/python/bin/python -E $dname/support/_install.py "$@" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T16:51:05.087

我对您的默认 python 可执行文件能够完成手头的任务的信心为零。Komodo 带有它自己的 python 解释器（和 site-packages 目录），因此他们可以确保一切正常。

将 install.sh 编辑回原来的样子，然后检查我对[原始帖子的回答](https://stackoverflow.com/questions/11361881/installing-komodo-edit-on-fedora)

短版：*更改**python 可执行文件的权限***

# linux - 减少 bash 脚本中命令的重复

> ID：11369013
> 
> 赞同：1
> 
> 时间：2012-07-06T20:09:19.033
> 
> 标签：linux, bash, scripting

我正在编写一个 bash 脚本来增加 VPS 服务器上的 /tmp ，我想让它更清洁/更高效，而无需为选择的任何选项重复相同的命令。这是它现在的结构：

```
#!/bin/bash

  showMenu () {
        echo "1) Increase /tmp size to 1 GB"
        echo "2) Increase /tmp size to 2 GB"
        echo "3) Quit"
}
   while [ 1 ]
   do
       showMenu
       read CHOICE
       case "$CHOICE" in

  "1")
       /etc/init.d/mysql stop
       /etc/init.d/httpd stop
       /etc/init.d/cpanel stop
       cp -af /var/tmp /var/tmp.bak
       umount -l /var/tmp
       umount -l /tmp
       rm -f /usr/tmpDSK
       dd if=/dev/zero of=/usr/tmpDSK bs=1M count=1k
       mkfs.ext3 -F /usr/tmpDSK
       mount -t ext3 -o nosuid,noexec,loop /usr/tmpDSK /tmp
       mount -o bind,noexec,nosuid /tmp /var/tmp
       cp -a /var/tmp.bak/* /tmp/
       rm -rf /var/tmp.bak/
       chmod 1777 /tmp
       /etc/init.d/mysql start
       /etc/init.d/httpd start
       /etc/init.d/cpanel start
       df -h
       exit 1
       ;;

    "2")
       /etc/init.d/mysql stop
       /etc/init.d/httpd stop
       /etc/init.d/cpanel stop
       cp -af /var/tmp /var/tmp.bak
       umount -l /var/tmp
       umount -l /tmp
       rm -f /usr/tmpDSK
       dd if=/dev/zero of=/usr/tmpDSK bs=1M count=2k
       mkfs.ext3 -F /usr/tmpDSK
       mount -t ext3 -o nosuid,noexec,loop /usr/tmpDSK /tmp
       mount -o bind,noexec,nosuid /tmp /var/tmp
       cp -a /var/tmp.bak/* /tmp/
       rm -rf /var/tmp.bak/
       chmod 1777 /tmp
       /etc/init.d/mysql start
       /etc/init.d/httpd start
       /etc/init.d/cpanel start
       df -h
       exit 1
       ;;

    "3")
        exit 1
       ;;
      esac
    done 
```

我基本上只想在此过程中启动一次冗余命令。你能给我一个或多个关于最好的方法的想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:13:58.657

听起来很适合[`bash function`](http://tldp.org/LDP/abs/html/functions.html). 将代码的核心放在一个函数中，然后传递一个大小参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T20:14:48.030

这就是函数的用途。将您的通用代码放在一个函数中，并从适当的`case` 选择中调用它。另一种方法是在您的`case`语句中设置标志并根据标志进行条件执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T20:15:38.013

```
#!/bin/bash

function size_up {
           /etc/init.d/mysql stop
           /etc/init.d/httpd stop
           /etc/init.d/cpanel stop
           cp -af /var/tmp /var/tmp.bak
           umount -l /var/tmp
           umount -l /tmp
           rm -f /usr/tmpDSK
           dd if=/dev/zero of=/usr/tmpDSK bs=1M count=${1}k
           mkfs.ext3 -F /usr/tmpDSK
           mount -t ext3 -o nosuid,noexec,loop /usr/tmpDSK /tmp
           mount -o bind,noexec,nosuid /tmp /var/tmp
           cp -a /var/tmp.bak/* /tmp/
           rm -rf /var/tmp.bak/
           chmod 1777 /tmp
           /etc/init.d/mysql start
           /etc/init.d/httpd start
           /etc/init.d/cpanel start
           df -h
           exit 1
           ;;
}

function showMenu () {
        echo "1) Increase /tmp size to 1 GB"
        echo "2) Increase /tmp size to 2 GB"
        echo "3) Quit"
}
 while [ 1 ]
   do
    showMenu
    read CHOICE
    case "$CHOICE" in
       "1") size_up 1
       "2") size_up 2
       "3") exit 1
       ;;
    esac
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T23:20:22.040

请注意，bash 函数有点奇怪。

```
function abc
{
   global_var=1
}

function def
(
   local_var=1
) 
```

注意花括号与括号。使用括号，您的函数在子 shell 中运行，而使用花括号，您的函数不会获得唯一的命名空间！

# google-apps-script - 从新的 Google Script DB 查询

> ID：11369018
> 
> 赞同：0
> 
> 时间：2012-07-06T20:09:34.270
> 
> 标签：google-apps-script

我正在试用新的 Google App Scripts 数据库，但无法确定特定类型的查询。

查找员工 434 是否具有在 20050101 之后颁发的名为“QUAL 1”的资格的最佳方法是什么？我在下面附上了他的记录。

```
{
        "id": 434,
        "qualifications": [
            {
                "pathway": "A",
                "name": "QUAL1",
                "issueDate": 20060330,
                "agencyName": "STATE OFFICE 1"
            },
            {
                "pathway": "B",
                "name": "QUAL2",
                "issueDate": 20090305,
                "agencyName": "STATE OFFICE 2"
            }
        ],
        "name": {
            "last": "SMITH",
            "first": "JOHN"
        },
        "type": "hr"
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:35:13.270

我希望我理解正确：

```
function test() {  
  var db = ScriptDb.getMyDb();
  var result = db.query({id: 434})
  var quals = result.next().qualifications;
  var hasQual = false;
  for (var i = 0; i < quals.length; i++) {
    if (quals[i].name == 'QUAL1' && quals[i].issueDate > 20050101) {
      hasQual = true;
      break;
    }
  }
  Logger.log(hasQual);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T01:35:26.687

目前无法构造一个在数组中查找值的查询。[您可以在问题跟踪器](http://code.google.com/p/google-apps-script-issues/issues/list)上提交功能请求。

# javascript - 如何在Javascript中将浮点数转换为字符串数组？

> ID：11369019
> 
> 赞同：1
> 
> 时间：2012-07-06T20:09:38.100
> 
> 标签：javascript, jquery, html

我需要将浮点数转换为字符串数组，例如`var num=25.67`转换为`var str_array[0] = '2', str_array[1]='5', str_array[2]='.', str[3]='6'; str_array[4]='7'`. 请出示您的代码。非常感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T20:11:44.260

这很简单。您只需将`num`var 转换为字符串（使用`.toString()`方法），然后将其转换为字符串（ `.split('')`'' 参数使其拆分每个字符）。

```
var num = 25.67;
var str_array = num.toString().split(''); 
```

您也可以使用以下代码：

```
var num = 25.67;
var str_array = num.toString(); 
```

然后`str_array`将不再是一个数组，而是一个字符串（可以被视为一个数组）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T20:12:24.430

尝试

```
var digits = num.toString().split(''); 
```

# ejb - 初始上下文查找返回相同的实例 | 在 Pojo 中注入无状态 EJB

> ID：11369020
> 
> 赞同：0
> 
> 时间：2012-07-06T20:09:39.343
> 
> 标签：ejb, stateless, initial-context

我正在尝试通过使用上下文查找在 POJO 中注入 EJB。我期待的是当你做一个 EJB 的无状态行为时

```
@EJB annotation 
```

EJB 有一个 entityManager，我从构造函数中的 EntityManagerFactory 获得，用于 thr EJB

```
 @Stateless
        Class ReprovProcess implements ReprovisioningProcess {
        protected EntityManager em;
        public ReprovProcess(){
        //init em from entityManagerFactory;
        }

        public EntityManager getEm(){
        return em;
        }
        }

        @LocalBinding(jndiBinding = "ReprovProcess/local")
        class interface ReprovisioningProcess {
        } 
```

接下来我查找 EJB 两次，这样

*   在第一次检索时，我关闭了 entitymanager

*   然后在第二次查找时，我应该看到 EntityManager 已打开，因为我期待类似无状态 EJB 的行为。

但我没有观察到这一点。我第二次进行查找并执行`em.isOpen()`，我得到一个错误。

所以问题是：context.lookup 能否用于获得类似 EJB 的无状态行为？如果不是可以用什么？

```
 ReprovisioningProcess pro = (ReprovisioningProcess)                         
            ic.lookup("ReprovProcess/local");
            EntityManager em = pro.getEm();
            System.out.println("Entity Manager State = "+em.isOpen());
            em.close();
            System.out.println("Entity Manager State = "+em.isOpen());

            pro = (NetElementReprovisioningProcess) ic.lookup("ReprovProcess/local");
            em = pro.getEm();
            System.out.println("Entity Manager State = "+em.isOpen());
            em.close();
            System.out.println("Entity Manager State = "+em.isOpen()); 
```

输出是

```
Entity Manager State = true
Entity Manager State = false
Entity Manager State = false
------------- ---------------- ---------------

EntityManager is closed
java.lang.IllegalStateException: EntityManager is closed
at org.hibernate.ejb.EntityManagerImpl.close(EntityManagerImpl.java:97)
at com.cisco.cgms.factoryconfig.reprovision.ReprovisiongGroupTest.testIntialLookup(ReprovisiongGroupTest.java:135) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T04:45:56.733

你误解了*stateless*。它不是关于容器提供将无状态 bean 的实例设置回其初始状态的功能。相反，开发人员应该注意所有无状态会话 bean 的实例都是可互换的。这意味着无状态 bean 不应该有对客户端可见的状态。在你的情况下`getEm`，违反了本合同。

容器确实有无状态会话 bean 实例池。由容器决定返回这些实例中的哪一个。这就是为什么您不能通过以下查找对返回哪个实例做出任何假设：

```
ic.lookup("ReprovProcess/local") 
```

它可以是您之前使用过的实例，也可以是任何客户端从未使用过的实例。如果您需要对客户端可见的状态，请使用有状态会话 bean 并存储对它的引用。

把它们加起来：

*   当实现不正确确实具有对客户端可见的状态时，不应期望无状态行为。
*   无法保证从池中返回哪个实例。

# xml - 使用 XML::Simple 或 XML::Twig 在 perl 中更新 xml 文件

> ID：11369022
> 
> 赞同：1
> 
> 时间：2012-07-06T20:09:47.553
> 
> 标签：xml, perl

有人可以帮我吗？

我想使用 perl 修改 xml 文件。我搜索并找到了 XML::Simple/ XML::Twig 之类的模块，但找不到确切的方法。

下面是我的 xml 文件的一部分。我想修改具有 name='sybase' 的 Driver 的值并将此更改保存到原始文件。

```
 <Properties>
    <Application>
        <Name>global</Name>
        <Cache>20</Cache>
        <Trace>true</Trace>
        <Drivers>
            <Driver name="sybase"> com.sybase</Driver>
            <Driver name="db2">com.db2</Driver>
        </Drivers>
    </Application>
</Properties> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T16:36:25.673

一种非常惯用的方法是：

```
#!/usr/bin/perl

use strict;
use warnings;

use XML::Twig;

XML::Twig->new( twig_handlers => 
                  { 'Driver[@name="sybase"]' 
                       => sub { $_->set_text( 'new driver')->flush }
                  },
                keep_spaces => 1, )
         ->parsefile_inplace( 'so.xml'); 
```

除此之外，“就地编辑文件”的常用方法是处理文件，将结果输出到临时文件，然后，如果一切正常，将临时文件重命名为原始文件名。

# .net - 带有 asp.net mvc 3 的 SPA（示例应用程序）

> ID：11369024
> 
> 赞同：-1
> 
> 时间：2012-07-06T20:09:58.207
> 
> 标签：.net, asp.net-mvc-3

谁能指出我使用 asp.net mvc 3、knockout 或其他任何部分视图（可能）构建的示例 SPA 应用程序（源代码）？

我正在寻找一个架构良好的代码，以便我可以了解 SPA 的工作原理。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:15:19.073

对于附加良好的代码，您需要提出一个特定的问题。

你问的最好的答案是：[http ://www.asp.net/single-page-application](http://www.asp.net/single-page-application)

# android - 如何使用 parcelable 将对象从一个 Android Activity 发送到另一个？

> ID：11369029
> 
> 赞同：1
> 
> 时间：2012-07-06T20:10:09.860
> 
> 标签：android, serialization, parcelable

我正在尝试将一个类型的对象传递给我的应用程序`Team`中的另一个对象。`Activity`

`Team`班级：

```
public class Team implements Parcelable {

    String teamName;

    //Name and Link to competition of Team
    TreeMap<String, String> competitions;
    //Name of competition with a map of matchdays with all games to a matchday
    TreeMap<String, HashMap<Integer, ArrayList<Event>>> matchDays;

    public int describeContents() {
        return 0;
    }

    public void writeToParcel(Parcel dest, int flags) {
        dest.writeString(teamName);
        dest.writeMap(competitions);    
    }

    public static final Parcelable.Creator<Team> CREATOR = new Parcelable.Creator<Team>() {
        public Team createFromParcel(Parcel in) {
            return new Team(in);
        }

        public Team[] newArray(int size) {
            return new Team[size];
        }
    };

    private Team(Parcel in) {
        teamName = in.readString();

        in.readMap(competitions, Team.class.getClassLoader());
    }
} 
```

编组时出现 RuntimeException：

```
TreeMap<String, HashMap<Integer, ArrayList<Event>>> matchDays; 
```

如何将嵌套的 TreeMap 与类的其余部分一起传递？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:23:18.483

`String`, `TreeMap`, 并且`HashMap`都实现了`Serializable`接口。您可能会考虑`Serializable`在您的`Team`类中实现并以这种方式在活动之间传递它。这样做可以使您可以直接从 加载对象，`Bundle`或者`Intent`无需手动解析它们。

```
public class Team implements Serializable {

    String teamName;

    //Name and Link to competition of Team
    TreeMap<String, String> competitions;
    //Name of competition with a map of matchdays with all games to a matchday
    TreeMap<String, HashMap<Integer, ArrayList<Event>>> matchDays; 
```

不需要额外的解析代码。

（编辑：`ArrayList`也实现`Serializable`了，所以这个解决方案取决于`Event`类是否是可序列化的。）

# macos - 如何从终端打印 OSX 文本剪辑文件的内容？

> ID：11369030
> 
> 赞同：7
> 
> 时间：2012-07-06T20:10:16.750
> 
> 标签：macos, bash

在 OSX（我在 10.7.x，Lion）中，您可以从大多数任何应用程序中获取一些文本并将其拖到桌面以获取“snippet.textClipping”文件。不过，该文件不仅仅是原始文本——文本被隐藏在某个地方（在资源中？）我正在寻找的是能够获得人们可能认为的输出的能力

`cat mysnippet.textClipping`

**注意：**这些剪辑是在旧版本的 OSX 下制作的。也许豹。也许年纪大了，已经有一段时间了。:)

谢谢！

PS 我有一个包含 1600 多个文件夹的文件夹，这就是为什么我要编写脚本，而不仅仅是手动将它们复制/粘贴到文本文件中。

PPS 是的，如果我只是全选然后拖到一个打开的空文本文档中，它会如您所愿。但我还是想通过脚本来做，所以我可以先把剪辑的名字放在前面，然后在每个前面放一个空行，等等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T21:39:56.323

这是一些可以工作的丑陋的东西：

```
DeRez -only TEXT foo.textClipping | perl -ne 'm|/\* (.*) \*/| && print $1; END {print "\n"}' 
```

基本上，它从输出中的 C 样式注释中提取文本`DeRez`并将其全部打印在一行上。我从另一个 Stack Overflow 问题（我现在找不到）中得到了这个想法。

# algorithm - 如何在本地二进制算法中训练世界数据？

> ID：11369031
> 
> 赞同：0
> 
> 时间：2012-07-06T20:10:17.443
> 
> 标签：algorithm, face-recognition

我正在研究 LBP 算法并产生另一个问题。在论文*Face Detection and Verification using Local Binary Patterns*中，Yann RODRIGUEZ（这是博士论文），在第 74 页（第 4.3.3 节提出的 LBP/MAP 人脸验证系统），作者提到

> 然后使用 LBP 算子处理裁剪后的人脸（N = 59 个标签）

和

> 对于 BANCA 实验，通用模型使用额外的图像集进行训练，称为世界数据（独立于客户端数据库中的主题）。

我的问题是： 1\. 为什么标签的数量是 59？2.如何训练世界数据？

有人读过这篇文章吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T20:17:32.540

OpenCV 已经有用于人脸检测的本地二进制模式级联，您可以在`data`OpenCV 安装随附的文件夹中找到它。所以没有必要自己训练一个，至少在人脸检测方面是这样。看：

*   [http://code.opencv.org/projects/opencv/repository/show/trunk/opencv/data/lbpcascades](http://code.opencv.org/projects/opencv/repository/show/trunk/opencv/data/lbpcascades)

这与 Rodgriguez 在他的博士论文中使用的类似。论文中提到的数字 59 是由于*Uniform Local Binary Patterns*的数量，详细介绍见 Scholarpedia：

*   [http://www.scholarpedia.org/article/Local_Binary_Patterns](http://www.scholarpedia.org/article/Local_Binary_Patterns)

可用的 LBP 级联应该比可用的 Haar 级联更快，但真正的阳性率略低（这里没有引用，仅基于我的经验）。这也可能是由于训练集。

您可以像使用其他可用的级联一样使用它们，这里是 OpenCV Python 绑定的示例：

*   [http://www.bytefish.de/wiki/opencv/object_detection](http://www.bytefish.de/wiki/opencv/object_detection)

这是一个源代码片段，您还可以在其中看到如何在 OpenCV 中使用 CascadeClassifier：

*   [http://docs.opencv.org/trunk/modules/contrib/doc/facerec/tutorial/facerec_video_recognition.html](http://docs.opencv.org/trunk/modules/contrib/doc/facerec/tutorial/facerec_video_recognition.html)

您询问了用于人脸检测的局部二进制模式，这就是提到的博士论文的内容。使用局部二进制模式进行人脸识别有些相似，但您从局部二进制模式构建空间增强直方图，以对空间信息进行编码以进行人脸识别。我建议您阅读我的人脸识别指南中的本地二进制模式部分：

*   [http://docs.opencv.org/trunk/modules/contrib/doc/facerec/facerec_tutorial.html#local-binary-patterns-histograms](http://docs.opencv.org/trunk/modules/contrib/doc/facerec/facerec_tutorial.html#local-binary-patterns-histograms)

# android - haxe, phone gap, jquery mobile 而不是原生应用

> ID：11369037
> 
> 赞同：-3
> 
> 时间：2012-07-06T20:10:45.097
> 
> 标签：android, ios, jquery-mobile, cordova, haxe

我已经使用 java 学习 Android 开发 10 个月，我曾考虑从 windows phone 和 iOS 开始，但最近我读到了 phone gap 和 jquery mobile，它允许你编写应用程序并在任何平台上运行它会非常棒。

是否真的值得学习使用这些工具，还是在每种情况下我都应该使用 c# 和 Objective-c？如果是这样容易学习吗，我的意思是有文档可以开始..

我也听说过 Haxe，但我完全不明白它的工作方式

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T12:01:02.230

您谈论的所有内容都有据可查。如果您使用跨平台工具，您将获得跨平台应用程序，如果您使用平台工具，您将获得一个平台的应用程序。从另一个角度来看，跨平台工具很少能让你充分利用每个平台的好处：有些东西会变慢，有些东西会被抽象掉。这个选择由你。

但是，考虑到您的问题的性质，我怀疑您是否有足够的知识或经验来使用任何高于勉强可接受的水平的平台。所以我建议你从头开始，先学习一些 C 或低级 java(=java assembler and bytecode)。

# javascript - 使用 jquery 查找只有 id 唯一的 div elememt 的文本

> ID：11369038
> 
> 赞同：-1
> 
> 时间：2012-07-06T20:10:51.607
> 
> 标签：javascript, jquery, html

我想保留所有具有相同类名的 div 的列表，即 mod。为此，我根据升序对列表进行了排序。因此，我正在寻找那些内部 div 包含带有文本 "Hello1" 的类标题的 id。

这是结构

```
<div class="mod" id="mod23" >
      <div class="content" >
       <div class="hd" >
         <div class="title">Hello1</div>
           <ul class="list"></ul>
           <ul class="buttons">
             <li class="help"></li>
             <li class="show" ></li>
             <li class="close"></li>
           </ul>
       </div>
      </div>
     </div>
    <div class="mod" id="mod27" >
      <div class="content" >
       <div class="hd" >
         <div class="title">Hello2</div>
           <ul class="list"></ul>
           <ul class="buttons">
             <li class="help"></li>
             <li class="show" ></li>
             <li class="close"></li>
           </ul>
       </div>
      </div>
     </div>
<div class="mod" id="mod25" >
      <div class="content" >
       <div class="hd" >
         <div class="title">Hello1</div>
           <ul class="list"></ul>
           <ul class="buttons">
             <li class="help"></li>
             <li class="show" ></li>
             <li class="close"></li>
           </ul>
       </div>
      </div>
     </div>
    <div class="mod" id="mod29" >
      <div class="content" >
       <div class="hd" >
         <div class="title">Hello2</div>
           <ul class="list"></ul>
           <ul class="buttons">
             <li class="help"></li>
             <li class="show" ></li>
             <li class="close"></li>
           </ul>
       </div>
      </div>
     </div> 
```

这是我试图想出的代码不起作用

```
myarray is a sorted list of unique id number.        
     for(var i=0;i<len;i++)
    {

 $('#mod'+myarray[i]).each(function(index) {   

      $('div.title:contains(Hello1)').each(function(index) {

       alert('found at ' +i);
    });
    });
      } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:15:43.097

而不是`for`循环和：

```
$('#mod'+myarray[i]).each 
```

您可以`starts with`像这样使用选择器：

```
$('div[id^="mod"]').each(function(){
  // this iterates over all divs with id starting like "modNUMBER"
}); 
```

*但*我认为这就是你要找的东西：

```
$('div.title:contains("Hello1")').each(function(){
  var id = $(this).closest('.mod')[0].id;
  alert('Found in div with id: ' + id);
}); 
```

# php - 显示实际的数据库连接

> ID：11369040
> 
> 赞同：0
> 
> 时间：2012-07-06T20:11:05.117
> 
> 标签：php, database, connection

我需要返回数据库连接的实际文本描述，以及有关数据库的任何其他相关信息。

为什么？我打电话给服务，预期的数据完美地返回。

现在，当我在安全隧道内进行相同的调用时，我得到完全不同的结果。

所有迹象都表明该代码在这两种情况下都有效。

所以，我只能想象它连接到不同的数据库......所以......我想让函数返回服务器名称和被查询的实际数据库 - 即使数据库所在的路径也很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T20:22:35.380

如果您使用的是 MySQL，请尝试：

```
SHOW variables WHERE `Variable_name` LIKE 'datadir' 
OR `Variable_name` like 'hostname'; 
```

这显示了您连接到的服务器的主机以及数据目录的路径。无论您查询的是哪个数据库，都是您选择的数据库。它应该驻留在`%datadir%/%db_name%`

`SHOW variables`通过显示所有变量 ( ) 或显示状态 ( )可以找到您可能正在寻找的任何其他信息`SHOW status`。

另请参阅[SHOW 语法](http://dev.mysql.com/doc/refman/5.0/en/show.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T20:24:26.610

您正在使用 PHP，因此您可以返回`mysql_error`或`mysqli_error`（如果您使用的是`mysqli`扩展程序）。

这将输出连接过程中发生的任何错误。

# c# - 如何检测 SQL Server 版本是否为 Express？

> ID：11369045
> 
> 赞同：0
> 
> 时间：2012-07-06T20:11:25.257
> 
> 标签：c#, connection-string, sql-server-express

我在这里有一个非常简单的问题，但我找不到解决它的答案。

我有一个这样的连接字符串：

```
SqlConnection con = new SqlConnection(@"Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\DB\DB.mdf;Initial Catalog=DB;Integrated Security=True"); 
```

它可以工作，但是当我尝试在没有安装 SQL Server Express 的 PC 中使用它时，它就是无法连接。我知道，如果我删除那个“\SQLEXPRESS”部分，它显然会起作用，但我不想在我安装软件的每台 PC 上手动执行它。我尝试通过使用 try-catch 来实现，但它太慢了，我认为它不是很推荐。

好吧，我只想知道如何通过代码来做到这一点。有没有一种简单的方法可以做到这一点？会彻底解决问题吗？（我的意思是，它肯定会在其他版本中工作吗？）

提前致谢！（对不起我的英语）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T20:17:06.423

连接字符串不应硬编码到您的软件中。

出于发布此问题的确切原因，您应该将它们放在配置 (`web.config`或) 中。`app.config`

您不能假设将在您的应用程序将运行的机器上安装*任何*版本的 SQL - 用户可能希望使用集中式服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T20:29:30.140

在 T-SQL 本身中，您可以检查`edition`服务器属性：

```
SELECT  
   SERVERPROPERTY('edition') as 'Product Edition' 
```

`Express Edition (64-bit)`如果您正在检查的版本确实是 Express 版本，这将返回类似的内容。

[您可以在此处的相关 MSDN 文档](http://msdn.microsoft.com/en-us/library/ms174396.aspx)中阅读有关所有其他可用服务器属性的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T20:23:16.293

您可能应该编写一些内容让您的用户选择服务器。您可以使用注册表来检测本地运行的 SQL Server 实例，但如果您连接到网络实例，这将不起作用。请参阅有关使用 SMO（服务器管理对象）的答案。 [以编程方式检测 SQL Server 版本](https://stackoverflow.com/questions/602677/programmatically-detect-sql-server-edition)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T20:23:17.993

澄清一下：SQL 服务器可以安装为“默认”或“命名”实例。我认为默认情况下，快速安装为命名实例

这允许单个服务器机器运行多个 SQL 服务器

要连接到默认实例，请指定服务器名称或 IP，仅此而已

```
Server=SomeServer 
```

要连接到命名实例，请指定服务器/ip + 实例名称，并用反斜杠分隔。

```
Server=SomeServer\SomeInstance 
```

在您的情况下，您希望连接到本地计算机上名为“SQLEXPRESS”的 SQL 实例。（一个点 . 表示本地机器）

理想情况下，您希望在服务器计算机上安装 SQL 并使用应用程序配置文件 (App.config) 来指定连接字符串。

App.config 支持一个名为 ConnectionStrings 的部分，您可以将连接字符串添加到该部分。然后，如果您向项目添加对 System.Configuration 的引用，您可以使用配置管理器类获取连接字符串：

应用程序配置：

```
<connectionStrings>
    <add name="YourConnectionString"
        connectionString="Server=someSqlServer\SomeInstance;Initial Catalog=SomeDB;Integrated Security=True" 
providerName="System.Data.SqlClient" />
</connectionStrings> 
```

在代码中使用：

```
ConfigurationManager.ConnectionStrings["YourConnectionStringName"] 
```

# android - 新的 Android 项目中缺少 main.xml - Eclipse OS X

> ID：11369048
> 
> 赞同：2
> 
> 时间：2012-07-06T20:11:30.493
> 
> 标签：android, xml, eclipse, layout, adt

我正在关注这个[Android 教程](http://developer.android.com/training/basics/firstapp/building-ui.html)。我试图找到`main.xml`但它不在`res/layout`. 但是我确实有`res/layout/activity_my_first.xml`这个文件的根节点`RelativeLayout`与`LinearLayout`教程中的不同。**如何获取 main.xml？**

也许我可以自己创造它。或者，也许我拥有的 XML 文件是新版本 ADT 插件中 main.xml 的替代品。我是 Android 和 Eclipse 的新手，所以我有点卡住了。

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:17:37.947

不需要标题为“main.xml”的布局。如果您愿意，您可以在 res/layout 文件夹中创建一个名为 main.xml 的文件，然后将布局复制并粘贴到您的示例中 - 然后可以在代码中使用它。但是，除非您尝试在您的 java 代码中使用一种名为“main”的布局，否则您的项目中没有必要使用这种布局。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T20:19:15.920

您可以将 activity_my_first.xml 中的内容替换为教程中的内容。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal">
    <EditText android:id="@+id/edit_message"
        android:layout_weight="1"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:hint="@string/edit_message" />
    <Button
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/button_send" />
</LinearLayout> 
```

或创建另一个名为 main.xml 的 xml。本教程假设您已经创建了即时猜测。

只需确保在您的活动中的 onCreate 方法中您有

```
setContentView(R.layout.activity_my_first); 
```

# jquery - Any+Time DatePicker - 在字段下方显示弹出窗口

> ID：11369049
> 
> 赞同：0
> 
> 时间：2012-07-06T20:11:31.120
> 
> 标签：jquery, jquery-ui, datepicker, anytime

我正在使用 Any+Time DatePicker，当我单击日期字段时，日历 UI 会显示在日期字段**上方**。它阻碍了有助于输入日期的信息。有没有办法让日历 UI 出现在已点击的字段**下方？**
我的代码是：

```
$("#start_date").click(
        function(e) {
            $("#start_date").AnyTime_noPicker().AnyTime_picker({ format: '%d-%m-%Y'}).focus();
            e.preventDefault();
        }
    ); 
```

**解决方案：** 从anytime.js 4.1112L版本中注释掉第3051*行。*该行是：

```
if ( top < 0 ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T14:42:10.410

简短回答：注释掉anytime.js 4.1112L 版本的#3051 行

长答案： pos() 方法相对于输入字段定位选择器。默认情况下，该方法尝试将选择器放在字段上方。第 #3051 行测试是否有空间放置它。如果不是，则第 #3052 行将选择器移到字段下方。简单地注释掉第 #3051 行将导致该方法始终将选择器移动到字段下方。

如果您在使用 Any+Time(TM) 时还有其他疑问或问题，请尝试使用[www.AMA3.com](http://www.ama3.com/ "Andrew M. Andrews III 的网站，包括 Any+Time(TM) JavaScript datepicker/timepicker/calendar widget")上的联系页面以获得更快的响应！

# knockout.js - 淘汰赛可观察行为

> ID：11369054
> 
> 赞同：0
> 
> 时间：2012-07-06T20:11:50.453
> 
> 标签：knockout.js, observable

我的问题是为什么我的两个数据绑定输入字段在我清除它们时表现不同，即使据我所知它们的设置方式与淘汰赛中计算的 observables 相同。

使用这个小提琴：http: [//jsfiddle.net/ya7eF/167/](http://jsfiddle.net/ya7eF/167/)

'min' 字段工作正常，'hrs' 字段不正常。要重现我的问题，请按照以下步骤操作。当我从 Duration 'hrs' 字段中删除文本时，我想了解为什么在模糊时它没有被零替换，例如 min 字段。

1.  从第二个持续时间（'min'）文本字段中删除文本（'30'），然后失去对该字段的关注。空字符串被零替换，并且其他计算的 observables（结束时间）被更新。如预期的。
2.  重新运行小提琴。
3.  从 Duration 'hrs' 文本字段中删除文本 ('0')
4.  模糊“小时”
5.  没发生什么事; 计算的可观察数小时的“读取”方法甚至不会被调用。我无法弄清楚这两个可观察对象之间有什么区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:36:55.807

在第二种情况下，`Duration`observable 的值实际上并没有改变。当 observable 的值设置为当前值时，不会向订阅者发送通知。这意味着不会触发计算的 observables 的读取函数。

处理这个问题的一种技术是使用 observable 的`valueHasMutated`函数来确保通知被发送出去。为避免多个通知，您可以执行以下操作：

```
 if (totalMinutes !== self.Duration()) {
            self.Duration(totalMinutes);
        }
        self.Duration.valueHasMutated(); 
```

这是您更新的示例：http: [//jsfiddle.net/rniemeyer/ya7eF/168/](http://jsfiddle.net/rniemeyer/ya7eF/168/)

# .net - .NET Word 互操作适用于 Windows 7，但不适用于 Server 2008

> ID：11369055
> 
> 赞同：3
> 
> 时间：2012-07-06T20:12:04.197
> 
> 标签：.net, ms-word, interop, 64-bit

我有点迷茫，需要一些帮助；）我们有一个正在工作的应用程序（.NET 4.0 / Windows Forms 应用程序），它为使用 word interop 程序集的用户创建 Word 模板。

在 64 位 Windows 7 机器上一切正常。我应该补充一点，我们的应用程序以 64 位（编译为任何 CPU）运行，Office 是 32 位版本，但在使用 Office 2010 和相应 PIA（通过嵌入式互操作类型包含）的 Windows 7 64 位机器上运行良好.

但是，当我们在同样需要的 Windows Server 2008 上运行此应用程序时，我们会收到错误消息，指出找不到 Word Interop 程序集。它也是 64 位操作系统，也是 32 位的 Office 2010。该应用程序是交互式运行的，因此没有 Windows 服务等。

任何关于问题可能是什么的想法都非常感谢。

谢谢大家！

干杯，杰森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-03T10:11:24.730

该错误表明您的服务器上未安装 Office 主互操作程序集 (PIA)。你有两个选择：

*   启动 Office 安装程序，选择更改当前安装并确保选择了*.NET 可编程*性支持选项。
*   使用您的应用程序部署互操作程序集（放在可执行文件旁边）。

# ios - iOS 的 libSVM？

> ID：11369058
> 
> 赞同：1
> 
> 时间：2012-07-06T20:12:27.407
> 
> 标签：ios, machine-learning, svm, libsvm

有没有人能够为 iOS 编译 libSVM？我没有在网上找到任何指南，也没有任何人报告它在新设备上的速度有多快。谁能指出我正确的方向以使 libSVM 在 iOS 上运行（如果可能的话）？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T21:01:10.470

[OpenCV](http://docs.opencv.org/doc/tutorials/ios/table_of_content_ios/table_of_content_ios.html)中包含的[SVM](http://docs.opencv.org/doc/tutorials/ml/introduction_to_svm/introduction_to_svm.html)怎么样？OpenCV 最近增加了对 iOS 的支持，它的 SVM 实现实际上是基于 LibSVM。这是我发现在 iOS 上轻松实现 SVM 的最佳选择。

# wamp - Windows 7 上的 Wampserver 2.2 橙色图标 错误文件中没有任何内容

> ID：11369059
> 
> 赞同：0
> 
> 时间：2012-07-06T20:12:30.950
> 
> 标签：wamp, wampserver

好的。所以我在我的 Windows 7 计算机上安装了 Wampserver 2.2....在启动 wamp 时，图标从红色变为橙色并保持橙色。我无法运行任何 php 文件。我将鼠标悬停在它上面，它只说服务器处于脱机状态。apache 和 php 错误文件都是空的。我试过以管理员身份运行，甚至更改了对 Windows XP sp2 的兼容性。我的电脑上没有Skype。我确实有谷歌谈话。关于如何让 wamp 运行的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T09:46:19.497

查看 Apache 的 httpd.conf 文件并查看它想要使用的端口，然后查看是否有其他程序正在使用相同的端口。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-09T09:43:34.717

我在不同的机器上为此苦苦挣扎了几个小时。通常一个解决方案在下一台机器上不起作用。这就是我通过反复试验发现每次都像魅力一样工作的东西。

在 win7 POS 上安装 WAMP

将 MSVCR100.dll 添加到 System32 安装 VB 2008 安装 WAMP 在服务中禁用万维网发布服务 以管理员身份启动 WAMP。完成的。无需编辑 httpd.conf，无需编辑主机文件，无需禁用 IIS。

按照这些步骤安装 WAMP 只需不到十分钟。希望它也对你有用。

# mysql - 关系数据库查询

> ID：11369065
> 
> 赞同：-1
> 
> 时间：2012-07-06T20:13:06.800
> 
> 标签：mysql, relational-database

我将如何组合这些查询？'deleted' 字段是指示主题何时被“删除”的时间戳。这个话题并没有真正被删除。如果它有一个实际的时间戳，我只是不显示它。

```
$topics = "SELECT id FROM topics WHERE deleted = '0000-00-00 00:00:00'";

$comments = "SELECT * FROM comments WHERE topic_id IN($topics)"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:16:02.650

使用此解决方案：

```
SELECT a.*
FROM comments a
INNER JOIN topics b ON 
    a.topic_id = b.id AND 
    b.deleted = '0000-00-00 00:00:00' 
```

# api - 如何将文本折叠和折叠代码块数据保存到 .sublime-workspace？

> ID：11369071
> 
> 赞同：35
> 
> 时间：2012-07-06T20:13:46.943
> 
> 标签：api, plugins, editor, sublimetext2, folding

似乎 Sublime Text 2 中没有可以在文件会话关闭\打开之间保持代码折叠的功能。

我想为此编写插件，但有一个问题。

我应该在哪里存储折叠数据，例如页面上的哪个文件或区域被折叠？我唯一的想法保存在 .sublime-workspace

那么，我如何访问它并读取我的属性、属性或什么元数据？

我还能在哪里存储数据，例如持久保存折叠区域所需的数据？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-07-06T22:18:39.673

首先，已经有一个非常好的插件可以做到这一点，而且还有更多，它叫做[BufferScroll](https://github.com/SublimeText/BufferScroll)

> Buffer Scroll 是一个简单的 Sublime Text 插件，它可以记住和恢复滚动、光标位置、选择、标记、书签、折叠、选定的语法和可选的配色方案。

为了回答您的问题，我快速检查了 BufferScroll 源代码，它似乎将所有数据存储在 Gzip 文件内的 Settings 文件夹中。在 mac 上，`~/Library/Application Support/Sublime Text 2/Settings/BufferScroll.bin.gz` 值得一提的是，它与 sublime text 用于存储会话、自动保存会话和许可证文件的文件夹相同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-09-20T03:32:42.583

2017 年 9 月更新，使用 sublime 3，在我们关闭文档后进行折叠持久性，包控制中有[自动折叠代码](https://packagecontrol.io/packages/AutoFoldCode)，我刚刚安装，它按预期工作。

# mysql - MySQL INSERT 如果不存在（不使用主键）

> ID：11369076
> 
> 赞同：10
> 
> 时间：2012-07-06T20:14:21.590
> 
> 标签：mysql, sql

**如果该对**不存在，我如何插入一行？
* 注意这些不是主键，我的主键设置为自动递增

尝试插入忽略但不起作用

```
INSERT IGNORE INTO mytable (`myid`, `theirid`) VALUES ('5', '1')
ON DUPLICATE KEY <DO NOTHING> 
```

表看起来像：

```
CREATE TABLE `mytable` (
    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
    `myid` bigint(20) NOT NULL,
    `theirid` bigint(20) NOT NULL,
    `activated` tinyint(1) NOT NULL DEFAULT '0',
    `dateStamp` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=10 DEFAULT CHARSET=latin1$$ 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-06T20:38:49.603

1）你可以添加一个`UNIQUE`约束`(myid, theirid)`吗？如果是，请添加此约束并使用：

```
INSERT INTO mytable (myid, theirid) 
  VALUES (5, 1) ; 
```

并忽略产生警告（或将上述内容替换为`INSERT IGNORE`）

2）如果你不能添加这样的约束（例如，你有时想要允许这样的重复而其他时候你不允许），你可以使用这个：

```
INSERT INTO mytable (myid, theirid) 
  SELECT 5, 1 
  FROM dual 
  WHERE NOT EXISTS
        ( SELECT *
          FROM mytable
          WHERE myid = 5
            AND theirid = 1
        ) ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T20:29:05.427

我认为您不清楚 on duplicate 确实......不能做，`on duplicate do nothing`因为默认情况下它什么都不做，它不会插入。看看这里

```
mysql> insert into t2 values (20000,'a','a',0);
Query OK, 1 row affected (0.00 sec)

mysql> insert into t2 values (20000,'a','a',0);
ERROR 1062 (23000): Duplicate entry '20000' for key 'PRIMARY' 
```

所以它“什么也没做”。如果您想知道该值是否存在，您应该在插入之前使用 Select 语句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-07T17:13:56.497

重复的异常（1062）仅在其索引为唯一时才会在键上引发，它会引发异常女巫被“ON DUPLICATE KEY”（即1062）捕获

你可以做的是添加一个复合键 UNIQUE( `myid`, `theirid`) 如果你想在两者都在一起时引发异常，或者如果你想要或者只是将它们添加为单独的或者

但我不确定语法所以只是查找它，但它看起来像这样......

```
CREATE TABLE `mytable` (
    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
    `myid` bigint(20) NOT NULL,
    `theirid` bigint(20) NOT NULL,
    `activated` tinyint(1) NOT NULL DEFAULT '0',
    `dateStamp` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (`id`),  UNIQUE(`a`,`b`)
) ENGINE=InnoDB AUTO_INCREMENT=10 DEFAULT CHARSET=latin1$$

INSERT myid, theirid VALUES ('4' , '1') into mytable 
ON DUPLICATE KEY 
UPDATE `myid`,`theirid` ; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T20:27:20.330

取决于您运行此查询的频率（以及其他一些环境元素），但我会说在这些字段上创建唯一索引是有意义的。这样，如果它们是重复的，mysql 将简单地返回一个重复的错误代码而不将其添加到表中。此外，考虑到如果插入的值是重复的，它不必检查整个数据库，这将使这个查询执行得更快。

# javascript - 在 Firebug/Chrome 中获取从一个断点到另一个断点的 Javascript 或 jQuery 堆栈跟踪？

> ID：11369084
> 
> 赞同：0
> 
> 时间：2012-07-06T20:14:57.170
> 
> 标签：javascript, jquery, google-chrome, firebug

我正在挖掘一个单页 Javascript 繁重的应用程序，试图追踪发生某些事情的代码的一个非常特定的部分（不直接与事件相关，因此使用像 Firequery 这样的工具来追踪它被证明是无效的）。

我想知道是否有任何方法可以在一个断点处暂停 Javascript 的执行，设置另一个断点，并记录所有从堆栈中推送和弹出的函数的跟踪，以便我可以跟踪代码库中的特定位置（许多JS文件）发生这种情况。

谢谢。

编辑：还应该指出，jQuery 跟踪小书签在这种情况下并没有多大帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T20:54:30.947

在 Chrome 开发工具中，如果您设置了断点，您可以手动`F10`逐行遍历 ( ) 代码，直到到达您想要的终点。这将遍历 JS 所做的一切，包括带您浏览您可能拥有的其他文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T23:48:51.400

通过遵循@sachleen 所写的内容，您可能可以更好地实现您想要的。

但关于原来的问题：

在 Firebug 中，您在“控制台”选项卡中有“配置文件”按钮。它没有按执行顺序列出函数，只是统计每个函数发生了多少次调用。如果您多次调用某些函数，它可能不会有太大帮助。但这取决于。

在 Chrome 中，您有“配置文件”选项卡，它显示的输出略有不同[您可以选择两种显示输出的方法：“重（自下而上）”和“树（自上而下）”]。根据您的需要选择一种。事实上，Chrome 的输出对我来说有点尴尬。

基本上，分析本身在两者中的工作方式相同，您单击一个按钮开始分析，并在完成后再次单击它以停止它。

# multithreading - 共享数据结构的 perl fork 与线程

> ID：11369085
> 
> 赞同：1
> 
> 时间：2012-07-06T20:15:03.447
> 
> 标签：multithreading, perl, hash, fork, hash-of-hashes

我正在编写一个脚本，我需要在多个进程之间共享数据结构。目前我正在分叉，当我只需要共享简单变量（即 $var、@arr、%hash）时，它的效果很好。但是最近我一直在尝试共享更复杂的变量，例如散列的散列，我遇到了很多麻烦。我尝试过使用[IPC::Shareable](http://search.cpan.org/~bsugars/IPC-Shareable-0.60/lib/IPC/Shareable.pm)、[DBM::Deep](http://search.cpan.org/~sprout/DBM-Deep-2.0008/lib/DBM/Deep.pod)和[forks::shared](http://search.cpan.org/~rybskej/forks-0.34/lib/forks/shared.pm)，但它们似乎都存在共享更复杂数据结构的问题，例如哈希哈希。我想知道的是对于像我这样的情况，使用叉子或线程会更好吗？我喜欢 fork 语法，因为它看起来很容易使用，但是如果我跳过很多不必要的圈子，而线程会简单得多，我'

**更新**

共享意味着单独的进程需要读取和写入数据结构。

我在 Centos5.5 上运行 Perl 5.8

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:35:18.470

您完全没有提供有关您的共享模式的信息，所以我假设您使用的是工作模型（这是您真正应该使用的），这意味着数据是通过消息队列共享的。

如果是这样，答案是“没关系”。使用您选择的`use forks;`or `use threads;`，并使用[Thread::Queue::Any](http://search.cpan.org/perldoc?Thread%3a%3aQueue%3a%3aAny)作为您的任务间通信通道。

# javascript - 在 Javascript 中从 VM 或 EC2 实例运行控制台？

> ID：11369086
> 
> 赞同：-2
> 
> 时间：2012-07-06T20:15:04.540
> 
> 标签：javascript

因此，我正在尝试创建一个能够从虚拟机或 EC2 实例访问控制台的小型 javascript 应用程序。我知道这已经完成，但我找不到任何项目或教程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:17:47.373

我通过使用[此处](http://net.tutsplus.com/tutorials/javascript-ajax/how-to-create-a-simple-web-based-chat-application/)的代码作为基础来做到这一点

根本不需要太多的重新发明

# node.js - 在 Node.js 中使用单独的控制器和路由

> ID：11369089
> 
> 赞同：8
> 
> 时间：2012-07-06T20:15:11.793
> 
> 标签：node.js

我正在寻找主观建议（我知道这可能会关闭），但我希望能够在 node.js 项目中分离路由和控制器，所以我有一些问题：

*   尝试使用更少/更大的 JS 文件是无用的吗？
*   我希望能够 require("routing") 并让它将我的所有路由连接到我的控制器所需的模块。如果我把所有东西都放进去，我可以很容易地做到这一点，`index.js`但这似乎很奇怪。我已经在进行`app.get("/" controllers.index);`样式分离，但是我对构建一个仅在另一个模块中包含所有 JS 文件的模块感到困惑。我错过了什么吗？
*   或者也许有一个完全不同的 node.js 风格来做到这一点，我试图将我的 ASP.NET MVC 知识映射得太深？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-06T20:28:42.157

如果你想把它全部放到一个文件中，你可以尝试这样的事情，它需要每个文件，`./routes/`并调用导出到每个文件的函数`app`作为参数：

```
// routing.js

var fs = require('fs');

module.exports = function(app) {
  fs.readdirSync(__dirname + '/routes/').forEach(function(name) {
    var route = require('./routes/' + name);
    route(app);
  });
}

// routes/index.js

module.exports = function(app) {
  app.get('/something', function(req, res) { ... });
  app.get('/something/else', function(req, res) { ... });
}

// routes/pages.js

module.exports = function(app) {
  app.get('/pages/first', function(req, res) { ... });
  app.get('/pages/second', function(req, res) { ... });
}

// server.js

var app = express.createServer();
require('./routing')(app); // require the function from routing.js and pass in app 
```

在 GitHub 上的 Express 目录中也有一些有趣的示例`example`，例如[一个基于 MVC 的](https://github.com/visionmedia/express/tree/master/examples/mvc)示例，它实现了 RESTful 路由，就像 Rails 一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T20:37:24.467

如果您打算做一些 RESTish API 服务器，请尝试一下：[https](https://github.com/kilianc/node-apiserver) ://github.com/kilianc/node-apiserver 还有示例：[https ://github.com/kilianc/node-apiserver/blob/master/例子](https://github.com/kilianc/node-apiserver/blob/master/examples)

# shell - Linux：什么是 echo $! 在 Linux 中？

> ID：11369104
> 
> 赞同：9
> 
> 时间：2012-07-06T20:16:00.497
> 
> 标签：shell

谁能告诉我 echo $! 意思和它是怎么来的（'$'和'！'的意思）？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-06T20:20:09.277

`$!`在后台运行的最后一个作业的 PID。

# java - HttpClient 身份验证 -

> ID：11369106
> 
> 赞同：1
> 
> 时间：2012-07-06T20:16:05.280
> 
> 标签：java, http

我正在尝试在 java 中模拟这种行为

```
curl -u usrname:password http://somewebsite.com/docs/DOC-2264 
```

我不确定身份验证是 NTLM 还是 Basic。我登录到提供用户名和密码的网站。这是一个表格帖子。使用上面的 curl 命令，我可以登录并获取内容。

为了在java中做到这一点，我做了：

```
 try {
        URL url = new URL("http://somewebsite.com/docs/DOC-2264");
        String authStr ="username:password";
        String encodedAuthStr = Base64.encodeBytes(authStr.getBytes());
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        connection.setRequestMethod("POST");
        connection.setDoOutput(true);
        onnection.setRequestProperty("Authorization", "Basic" + encodedAuthStr);

        InputStream content = (InputStream)connection.getInputStream();
        BufferedReader in   = 
            new BufferedReader (new InputStreamReader (content));
        String line;
        while ((line = in.readLine()) != null) {
            System.out.println(line);
        }           

    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

但我只得到登录页面。不是实际内容。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:59:13.797

1.  `curl`您可以通过添加`-v`(verbose) 选项来查看正在发送的确切标头。
2.  标`Authorization`头需要 base64 编码的用户名/密码之前的身份验证类型。它应该看起来像这样：`Authorization: Basic dXNybmFtZTpwYXNzd29yZA==`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T20:26:01.397

也许 curl 只是做相当于这个：

```
URL url = new URL("http://username:password@somewebsite.com/docs/DOC-2264"); 
```

# printing - 在 VB6 中打印到精确尺寸

> ID：11369108
> 
> 赞同：1
> 
> 时间：2012-07-06T20:16:23.303
> 
> 标签：printing, vb6

我正在寻找一种以特定像素/毫米比率在 VB6 中打印位图图像的方法。这个想法是有一个功能，可以在 nxn mm 处打印 500 x 500 像素的图像，在 2*nx 2*n mm 处打印 1000 x 1000 像素的图像，在 2*nxn mm 处打印 1000 x 500 等。

我已经广泛搜索了解决此问题的方法，但收效甚微。我发现的最有希望的解决方案是在 DEVMODE 结构中设置成员，但是这方面的文档非常稀少。Printer 类也有一些缩放方法，但没有一个听起来像我需要的那样。

有人知道如何实现这个功能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:42:30.203

尝试[Printer.PaintPicture](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.powerpacks.printing.compatibility.vb6.printer.paintpicture.aspx)。您可以在参数中指定宽度和高度。此外，之前在这里回答过[Print Bitmap Visual Basic 6](https://stackoverflow.com/questions/1033077/print-bitmap-visual-basic-6)。

# ruby-on-rails - 获取带有条件的随机记录

> ID：11369111
> 
> 赞同：0
> 
> 时间：2012-07-06T20:16:27.933
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

下面的代码没有做我需要它做的事情。我想返回一个 user_id 不是 1 的随机设计对象。事实上，查询有时不返回任何记录。

```
 offset = rand(Design.count)
   @design = Design.first(:offset => offset, :conditions => [ "user_id != ?", 1]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:18:22.987

您要做的是计算也符合这些条件的元素的数量：

```
offset = rand(Design.count(:conditions => [ "user_id <> ?", 1])) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:48:27.517

如果数据库很小，您可以在返回的数组上调用示例方法。

```
Design.where(:offset => offset, :conditions => [ "user_id != ?", 1]).sample 
```

# javascript - Android webview - javascript 不适用于操作系统 < 2.3

> ID：11369114
> 
> 赞同：3
> 
> 时间：2012-07-06T20:16:36.193
> 
> 标签：javascript, android, webview, android-2.2-froyo

我有一个使用 web 视图通过 javascript 调用函数的应用程序。Android OS 2.3 及更高版本的一切都很好，但 2.2 或更低版本的任何东西都会出现无声故障。我的 webview 代码粘贴在下面，在 javascript 文件中我有一个简单的回调：

```
<body onLoad='onLoad()'> 
```

永远不会被触发。关于什么可能是错误的任何想法？

```
 mMessageView = new WebView(main);
        clearWebviewCache();
        WebSettings mSettings = mMessageView.getSettings();
        mSettings.setJavaScriptEnabled(true);

        mMessageView.addJavascriptInterface(new DriverInterface(main), "messageView");              
        mMessageView.setWebChromeClient(new WebChromeClient(){
            public void onProgressChanged(WebView view, int progress)
            {
                log("load progress = " + progress);

            }
        }); 
```

# c++ - 如何在显示多个属性的graphviz中打印图表

> ID：11369115
> 
> 赞同：7
> 
> 时间：2012-07-06T20:16:39.323
> 
> 标签：c++, boost, graphviz, boost-graph

我的问题基于：[如何打印显示单个属性的图表](https://stackoverflow.com/questions/9181183/how-to-print-a-boost-graph-in-graphviz-with-one-of-the-properties-displayed)

我正在使用捆绑的属性：

```
 typedef struct vert{
   std::string name;
 };

 typedef struct edge{
   int capacity;
   int weight;
 }; 

typedef adjacency_list<listS, vecS, undirectedS, vert, edge> Graph;
Graph g;
vector<int,int> ele; 
```

我在一个*应该*创建边缘的循环中调用了以下内容：

```
 edge prop;
  prop.weight = 5;
  prop.capacity = 4;
  add_edge(ele.first,ele.second, prop, g); 
```

该段是将图形打印为点格式的部分。

```
ofstream dot("graph.dot");
write_graphviz(dot, g, 
  boost::make_label_writer(boost::get(&vert::name, g)),
  boost::make_label_writer(boost::get(&edge::weight, g)),
  boost::make_label_writer(boost::get(&edge::capacity, g))); 
```

错误是：

```
/usr/include/boost/graph/graphviz.hpp: In function ‘void boost::write_graphviz(std::ostream&, const Graph&, VertexPropertiesWriter, EdgePropertiesWriter, GraphPropertiesWriter, VertexID) [with Graph = boost::adjacency_list<boost::listS, boost::vecS, boost::undirectedS, vert, edge, boost::no_property, boost::listS>, VertexPropertiesWriter = boost::label_writer<boost::bundle_property_map<boost::adjacency_list<boost::listS, boost::vecS, boost::undirectedS, vert, edge, boost::no_property, boost::listS>, long unsigned int, vert, std::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, EdgePropertiesWriter = boost::label_writer<boost::bundle_property_map<boost::adjacency_list<boost::listS, boost::vecS, boost::undirectedS, vert, edge, boost::no_property, boost::listS>, boost::detail::edge_desc_impl<boost::undirected_tag, long unsigned int>, edge, int> >, GraphPropertiesWriter = boost::label_writer<boost::bundle_property_map<boost::adjacency_list<boost::listS, boost::vecS, boost::undirectedS, vert, edge, boost::no_property, boost::listS>, boost::detail::edge_desc_impl<boost::undirected_tag, long unsigned int>, edge, int> >, VertexID = boost::vec_adj_list_vertex_id_map<boost::property<boost::vertex_bundle_t, vert, boost::no_property>, long unsigned int>]’:
/usr/include/boost/graph/graphviz.hpp:260:   instantiated from ‘void boost::write_graphviz(std::ostream&, const Graph&, VertexPropertiesWriter, EdgePropertiesWriter, GraphPropertiesWriter) [with Graph = Graph, VertexPropertiesWriter = boost::label_writer<boost::bundle_property_map<boost::adjacency_list<boost::listS, boost::vecS, boost::undirectedS, vert, edge, boost::no_property, boost::listS>, long unsigned int, vert, std::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, EdgePropertiesWriter = boost::label_writer<boost::bundle_property_map<boost::adjacency_list<boost::listS, boost::vecS, boost::undirectedS, vert, edge, boost::no_property, boost::listS>, boost::detail::edge_desc_impl<boost::undirected_tag, long unsigned int>, edge, int> >, GraphPropertiesWriter = boost::label_writer<boost::bundle_property_map<boost::adjacency_list<boost::listS, boost::vecS, boost::undirectedS, vert, edge, boost::no_property, boost::listS>, boost::detail::edge_desc_impl<boost::undirected_tag, long unsigned int>, edge, int> >]’
file_format.cc:194:   instantiated from here
/usr/include/boost/graph/graphviz.hpp:236: error: no match for call to ‘(boost::label_writer<boost::bundle_property_map<boost::adjacency_list<boost::listS, boost::vecS, boost::undirectedS, vert, edge, boost::no_property, boost::listS>, boost::detail::edge_desc_impl<boost::undirected_tag, long unsigned int>, edge, int> >) (std::basic_ostream<char, std::char_traits<char> >&)’ 
```

这对我来说很奇怪，因为这有效：

```
write_graphviz(dot, g,
  boost::make_label_writer(boost::get(&vert_info::name, g))); 
```

并输出以下内容：

```
graph G {
0[label="0"];
1[label="1"];
2[label="2"];
3[label="3"];
4[label="4"];
5[label="5"];
6[label="6"];
7[label="7"];
8[label="8"];
9[label=""];  // this is another problem that I will have to fix but beside the point
0--9 ;
0--5 ;
0--2 ;
0--1 ;
...
...
} 
```

我的目标是标记每个节点，并标记每个边缘的容量和权重。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-07T07:57:22.177

你可以在[这里](http://www.boost.org/libs/graph/doc/write-graphviz.html)找到所有重载的列表`write_graphviz`。第一个错误的原因是您尝试使用的重载在其第五个参数中需要一个图形属性编写器。

辅助函数`make_label_writer`简单地创建一个属性编写器，将单个属性从图的顶点或边分配给名为 的graphviz 顶点或边属性`label`。

为了实现您想要的，您需要创建一个自定义[`property writer`](http://www.boost.org/libs/graph/doc/write-graphviz.html#concept%3aPropertyWriter)项，在该自定义项中将每个边缘属性分配给您需要的[graphviz 属性](http://www.graphviz.org/content/attrs)。我个人会使用`weight`->`label`和`capacity`->`taillabel`或`headlabel`.

```
template <class WeightMap,class CapacityMap>
class edge_writer {
public:
  edge_writer(WeightMap w, CapacityMap c) : wm(w),cm(c) {}
  template <class Edge>
  void operator()(ostream &out, const Edge& e) const {
    out << "[label=\"" << wm[e] << "\", taillabel=\"" << cm[e] << "\"]";
  }
private:
  WeightMap wm;
  CapacityMap cm;
};

template <class WeightMap, class CapacityMap>
inline edge_writer<WeightMap,CapacityMap> 
make_edge_writer(WeightMap w,CapacityMap c) {
  return edge_writer<WeightMap,CapacityMap>(w,c);
} 
```

最后，您的`write_graphviz`调用将只是：

```
ofstream dot("graph.dot");
write_graphviz(dot, g, 
  boost::make_label_writer(boost::get(&vert::name, g)),
  make_edge_writer(boost::get(&edge::weight,g),boost::get(&edge::capacity,g))); 
```

# c++ - Tesseract：如何导出文本和边界框？

> ID：11369126
> 
> 赞同：3
> 
> 时间：2012-07-06T20:17:47.700
> 
> 标签：c++, iteration, ocr, tesseract, bounding-box

我想将文档图像转换为 XML，并导出在页面中找到某个单词的位置。为了访问边界框信息，可以使用 tesseract 的布局分析：

```
 tess.SetImage(...); 
 tess.SetPageSegMode( tesseract::PSM_AUTO_OSD); 
 tesseract::PageIterator* it = tess.AnalyseLayout(); 
 while(it->Next(tesseract::RIL_WORD)
 {
      int top, bottom, left, right; 
      it->BoundingBox(tesseract::RIL_WORD, &left, &top, &right, &bottom); 

 } 
```

然而，那时我不知道边界框的实际内容，通过执行以下代码，对当前图像执行 OCR，因此`text`包含页面的整个文本。

```
 tess.Recognize(0); 
 std::string text = tess.GetUTF8Text(); 
```

目前我暂时将所有边界框存储在`vector`. 对于每个框，我从原始框中剪切出一个子图像，并对每个边界框执行 OCR。基本上这是可行的，但是当我将结果与 Tesseract 命令行工具进行比较时，会发生更多的 OCR 错误。

因此，我想知道如何逐字遍历 OCR 结果并获得相应的边界框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T12:25:38.887

```
tess.Recognize(0);

PAGE_RES_IT resultIter(page_res_);

for (resultIter.start_page(false); resultIter.block() != NULL; resultIter.forward()) 
{

            WERD_RES* wordResult = resultIter.word();
            WERD_CHOICE* word = wordResult->best_choice;

            TBOX& box = wordResult->word->bounding_box();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-13T03:47:41.647

```
NSString *retText = @"";
tesseract::ResultIterator *ri = tess.GetIterator();
tesseract::PageIteratorLevel level = tesseract::RIL_WORD;

if (ri != 0) {
do {
  const char *word = ri->GetUTF8Text(level);
  float conf = ri->Confidence(level);
  int x1, y1, x2, y2;
  ri->BoundingBox(level, &x1, &y1, &x2, &y2);

  if (word) {
    printf("word: '%s';  \tconf: %.2f; BoundingBox: %d,%d,%d,%d;\n", word,
           conf, x1, y1, x2, y2);

    NSString *temp =
        [NSString stringWithCString:word encoding:NSUTF8StringEncoding];
    retText = [NSString stringWithFormat:@"%@ %@", retText, temp];
    retText = [retText stringByReplacingOccurrencesOfString:@"[\\\""
                                                 withString:@""];
    retText = [retText stringByReplacingOccurrencesOfString:@"\n\n"
                                                 withString:@""];

    UIBezierPath *path = [UIBezierPath bezierPath];

    [path moveToPoint:CGPointMake(x1, y1)];
    [path addLineToPoint:CGPointMake(x2, y1)];
    [path addLineToPoint:CGPointMake(x2, y2)];
    [path addLineToPoint:CGPointMake(x1, y2)];
    [path addLineToPoint:CGPointMake(x1, y1)];

    CAShapeLayer *shapeLayer = [CAShapeLayer layer];
    shapeLayer.path = [path CGPath];
    shapeLayer.strokeColor = [[UIColor blueColor] CGColor];
    shapeLayer.lineWidth = 3.0;
    shapeLayer.fillColor = [[UIColor clearColor] CGColor];

    [self.scrollView.layer addSublayer:shapeLayer];

    delete[] word;
  }
} while (ri->Next(level));
} 
```

# azure - 来自 Windows Azure 网站的 HttpWebRequest

> ID：11369128
> 
> 赞同：0
> 
> 时间：2012-07-06T20:17:53.157
> 
> 标签：azure, httpwebrequest, azure-web-app-service

我今天刚刚在 Windows Azure 网站上发布了我的第一个网站。从这个网站，我正在尝试使用 HTTPWebRequest 从外部 RSS 提要 (https://picasaweb.google.com/) 获取内容。

我从 MVC 控制器中执行以下方法，然后用生成的 RSS XML 填充模型：

```
 private static string HttpGet(String url)
    {
        HttpWebRequest req = WebRequest.Create(url) as HttpWebRequest;
        String result = null;
        using (HttpWebResponse resp = req.GetResponse() as HttpWebResponse)
        {
            StreamReader reader = new StreamReader(resp.GetResponseStream());
            result = reader.ReadToEnd();
        }
        return result;
    } 
```

当我对此进行测试时，这在我的本地计算机上运行良好，但是一旦将站点上传到 Windows Azure 网站，单击页面结果：

**抱歉，处理您的请求时出现了一个错误。**

我的猜测是我需要打开一个防火墙端口以允许 Web 服务器从数据中心内部发出端口 443 请求，但我找不到在哪里或如何做到这一点。

任何想法将不胜感激。

**更新：**
我认为我最初的假设是正确的——我似乎无法从 Azure 内部发出 SSL 请求。这是下面的堆栈跟踪：

```
[WebException: The request was aborted: Could not create SSL/TLS secure channel.]
   System.Net.HttpWebRequest.GetResponse() +6115603
   Alien.Models.PicassaWebReader.HttpGet(String url) +61
   Alien.Models.PicassaWebReader.GetPicassaWebFeed() +17
   Alien.Controllers.PhotosController.Index() +14
   lambda_method(Closure , ControllerBase , Object[] ) +62
   System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) +17
   System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) +208
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +27
   System.Web.Mvc.<>c__DisplayClass15.<InvokeActionMethodWithFilters>b__12() +55
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +263
   System.Web.Mvc.<>c__DisplayClass17.<InvokeActionMethodWithFilters>b__14() +19
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +191
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +343
   System.Web.Mvc.Controller.ExecuteCore() +116
   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +97
   System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +10
   System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__5() +37
   System.Web.Mvc.Async.<>c__DisplayClass1.<MakeVoidDelegate>b__0() +21
   System.Web.Mvc.Async.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _) +12
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
   System.Web.Mvc.<>c__DisplayClasse.<EndProcessRequest>b__d() +50
   System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +60
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8969201
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184 
```

我也将此问题发布到：[http ://social.msdn.microsoft.com/Forums/en-US/windowsazuredevelopment/thread/622f0dbc-bbfd-4d3e-b344-148a79ddeedc](http://social.msdn.microsoft.com/Forums/en-US/windowsazuredevelopment/thread/622f0dbc-bbfd-4d3e-b344-148a79ddeedc)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:18:51.747

SSL 证书是否有效？

[如何以编程方式接受无效的 SSL 证书](http://blog.jameshiggs.com/2008/05/01/c-how-to-accept-an-invalid-ssl-certificate-programmatically/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T20:32:48.550

您应该能够很好地发出出站 HTTP/HTTPS 请求。不需要更改防火墙。您能否从错误中获得更多信息？有没有可以查看的异常？也许至少暂时关闭友好的错误消息（显示黄屏死机）会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T08:18:47.930

如果我将 URL 更改为我正在读取的 RSS 提要，从 Https 到 Http 链接，一切正常。幸运的是，picasaweb 只是重定向到那里的 https，所以一切正常。

我很想知道如何解决这个问题以允许代码实际使用 SSL，但与此同时，这个问题已经解决了。

# sql - SQLite：从有限的行集中选择 MIN

> ID：11369131
> 
> 赞同：2
> 
> 时间：2012-07-06T20:18:04.797
> 
> 标签：sql, sqlite

我需要从表中的前 5 行中选择最小 ID 值。我通过此查询获得最高 ID：

```
SELECT id FROM items ORDER BY id DESC LIMIT 5 
```

它工作正常并从前 5 行返回 ID 值：

```
314
313
312
311
310 
```

现在，尝试从该集合中获取最小 ID：

```
SELECT MIN(id) FROM items ORDER BY id DESC LIMIT 5 
```

我希望结果是**310**但 SQLite 返回**1**。那是怎么回事？我在哪里错了，我是否实现了我的目标？

**更新：**

`SELECT MIN(id) FROM (SELECT id FROM news_items ORDER BY id DESC LIMIT 5)`有效，所以现在我只是好奇第一个查询有什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:36:42.140

假设你实际使用的是`MIN`代替`MAX`，那么解释就很简单了。这`ORDER BY id DESC LIMIT 5`是对您的查询进行评估的最后一部分。`id`因此，在您的第一个查询中，您正在检索（应该是）的最小值`0`，然后`ORDER BY ....`是无关紧要的（您正在订购并限制一行）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:02:30.643

`ORDER BY`需要评估整个数据集才能正确排序。

通过经验证据，我们可以假设`MIN`在每一行进行评估。:)

# java - Java - 新点，距纬度/经度点的 X 距离

> ID：11369132
> 
> 赞同：1
> 
> 时间：2012-07-06T20:18:06.187
> 
> 标签：java, latitude-longitude, trigonometry, haversine

我需要取一个点，并确定在它西北 N 英里处和东南 N 英里处的点是什么。它本质上会在初始点周围创建一个边界框。

我环顾四周，发现了一些关于 Haversine 的东西，但似乎所有代码实现都是针对两点之间的距离，而不是一个点的新点组件。

是否存在已经存在的这种东西的现有实现，最好是在 Java 中？还是其他语言？

这是我想象的我需要的方法：

```
public float longitudeFromPoint( float lat, float long, int vertical, int horizontal )
{
    // something
}

public float latitudeFromPoint( float lat, float long, int vertical, int horizontal )
{
    // something
}

float startLat  = 41.829347;
float startLong = -87.633788

float northWestLat  = latitudeFromPoint( startLat, startLong, 1, -1 );
float northWestLong = latitudeFromPoint( startLat, startLong, 1, -1 );

float southWestLat  = latitudeFromPoint( startLat, startLong, -1, 1 );
float southWestLong = latitudeFromPoint( startLat, startLong, -1, 1 ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:26:32.203

这可能值得一读：[使用边界坐标查找纬度/经度距离内的点](http://janmatuschek.de/LatitudeLongitudeBoundingCoordinates)。它提供了关于球坐标的简短理论背景，并提供了一些 java 代码。

该链接是从 SO 上该线程的已接受答案中借用的： [Calculating bounding box a certain distance from a lat/long coordinate in Java](https://stackoverflow.com/questions/1689096/calculating-bounding-box-a-certain-distance-away-from-a-lat-long-coordinate-in-j?rq=1)

# sql-server - ASP 3.0 将来自 SQL Server 的 PRINT 和警告视为错误

> ID：11369134
> 
> 赞同：-1
> 
> 时间：2012-07-06T20:18:16.417
> 
> 标签：sql-server, asp-classic, error-handling

在我的 ASP 页面中，我放了一个“下一个错误恢复”，并在文件末尾我做

```
If err.number <> 0 then
response.write "error"
end if 
```

但是 ASP 页面将来自 SQL Server 过程的 PRINT 和 WARNINGs 消息视为 ERROR 并进入 IF 条件。

为什么在某些服务器上会发生这种情况，而在另一台服务器上则不会？

谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T15:14:14.933

err.number <> 0 仅在崩溃的语句之后直接...

所以：

```
ii = 1/0
xx= 3
if err.number <> then
    response.write "This will never be printed..."
end if 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T20:28:25.843

它可能发生在不同的服务器上，因为您的设置`SET ANSI_WARNINGS`在`ON`某些情况下和`OFF`其他情况下。你可以通过调查看到这一点`sys.dm_exec_sessions`。由于来自不同应用程序的此选项和其他选项的不同设置会导致性能特征大不相同，因此在所有应用程序中明确且一致地设置这些选项符合您的最佳利益。

# telerik-mvc - Telerik MVC 网格 - ClientTemplate()

> ID：11369138
> 
> 赞同：0
> 
> 时间：2012-07-06T20:18:34.157
> 
> 标签：telerik-mvc

我有一个 DateTime，它通过 ClientTemplate() 在网格中呈现，如下所示：

/日期(1294030800000)/

我知道这是一个有效的日期。

有没有人看到这一点或可以提供关于我做错了什么的线索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:49:22.270

这是我所做的（感谢 SLaks 指出这是一个 JSON 日期），它提醒我 Telerik 网格在 Ajax 模式下将响应序列化为 JSON。

我在我的视图中创建了一个辅助函数：

```
<script type="text/javascript" language="javascript">
    function ConvertToDateFromJSON(jsonDate) {
        var regex = /-?\d+/;
        var numbers = regex.exec(jsonDate);
        var d = new Date(parseInt(numbers[0]));
        return d;
    }
</script> 
```

然后对 ClientTemplate 的调用如下所示：

```
columns.Bound(model => model.DateAdmitted)              
    .Template(o => o.DateAdmitted.ToString("d"))
    .ClientTemplate(
         "<#= $.telerik.formatString('{0:MM/dd/yyyy}', ConvertToDateFromJSON(DateAdmitted)) #>"
    ); 
```

# android - 如何在服务中设置文本视图？

> ID：11369140
> 
> 赞同：0
> 
> 时间：2012-07-06T20:18:50.307
> 
> 标签：android

我有一个有 2 个按钮（开始，结束）的活动，当用户按下开始时，活动将触发一个服务来记录语音并在用户按下结束按钮时保存它。为了确保用户知道他正在录制，我在活动 UI 上添加了一个文本视图，并希望服务类可以在服务的 onStartCommand() 和“完成记录”上将其更改为“正在录制...” " onDestory() 。但是由于Service类不支持findviewbyId()，请问这个问题怎么解决？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T20:40:26.587

实现这一点的最简单方法是使用 Toast 通知，该通知可以从服务中创建和显示 - 这是 Toasts 的文档：http: [//developer.android.com/guide/topics/ui/notifiers/toasts。 html](http://developer.android.com/guide/topics/ui/notifiers/toasts.html)

根据该页面，此示例演示了大多数 toast 通知所需的一切。您应该很少需要其他任何东西：

```
Context context = getApplicationContext();
CharSequence text = "Hello toast!";
int duration = Toast.LENGTH_SHORT;

Toast toast = Toast.makeText(context, text, duration);
toast.show(); 
```

# xml - XSL Pass Transformation - 标准 Muenchian 分组

> ID：11369144
> 
> 赞同：0
> 
> 时间：2012-07-06T20:19:16.613
> 
> 标签：xml, xslt, xml-serialization, xml-parsing

我试图使用 XSLT 对 XML 进行多次传递转换到另一个 xml。但无法实现。代码的帮助表示赞赏。

如果没有元素匹配并且@DimitreNovaatchev 进行muenchian 分组，我已经解决了提供的解决方案。在这种情况下，“” Car_MNO, Car_Model “”被匹配，然后其他值被分组。

```
Input XML:

<t>
<Vehicle>
<Car_MNo>123</Car_MNo>
<Car_Model>Audi</Car_Model>
<Description>car.color</Description>
<colour>BLACK</colour>
</Vehicle>

<Vehicle>
<Car_MNo>123</Car_MNo>
<Car_Model>Audi</Car_Model>
<Description>car.hood</Description>
<colour>RED</colour>
</Vehicle>

<Vehicle>
<Car_MNo>123</Car_MNo>
<Car_Model>BMW</Car_Model>
<Description>Bus.Brakes</Description>
<colour>steel</colour>
</Vehicle>

<Vehicle>
<Car_MNo>123</Car_MNo>
<Car_Model>BMW</Car_Model>
<Description>Bus.steering</Description>
<colour>black</colour>
</Vehicle>

<Vehicle>
<Car_MNo>234</Car_MNo>
<Car_Model>benz</Car_Model>
<Description>cycle.color</Description>
<colour>violet</colour>
</Vehicle>

<Vehicle>
<Car_MNo>345</Car_MNo>
<Car_Model>nissan</Car_Model>
<Description>bike.seat</Description>
<colour>RED</colour>
</Vehicle>

<Vehicle>
<Car_MNo>345</Car_MNo>
<Car_Model>nissan</Car_Model>
<Description>car</Description>
<colour>RED</colour>
</Vehicle>
</t> 
```

XML 中的预期输出：

```
 <t>
  <Vehicle>
    <car>
      <color>BLACK</color>
      <hood>RED</hood>
    </car>
    <Bus>
     <Brakes>steel</Brakes>
     <Steering>black</Steering>
    </Bus>
    <cycle>
      <color>violet</color>
    </cycle>
    <bike>
      <seat>Red</seat>
    </bike>
  </Vehicle>
  <vehicle>
    <car>red</car>
 </vehicle>
</t> 
```

我工作的示例代码如下所示：

```
<Vehicle>
  <xsl:variable name="vrtfPass2">
<xsl:apply-templates/>
  </xsl:variable>
  <xsl:apply-templates mode="pass3" select="ext:node-set($vrtfPass2)/* [generate-id()=generate-      id(key('kvehiclechild', name(Name/*[1]))[1])]   "/>
  <xsl:for-each select="//Vehicle">
  <xsl:if test="not(contains(Description,'.'))">
  <xsl:variable name="var3" select="Description"/>
  <xsl:element name="{$var3}">
  <xsl:value-of select="colour"/>
  </xsl:element>
  </xsl:if>
  </xsl:for-each>
  </Vehicle>
  <Vehicle>
  <xsl:variable name="vrtfPass3">
  <xsl:apply-templates/>
  </xsl:variable>
  <xsl:apply-templates mode="pass4" select="ext:node-set($vrtfPass3)/* [generate-id()= generate-      id(key('kvehicle_au', name(Description/*[1]))[1])]   "/>
  </Vehicle>

  <xsl:template match="Vehicle">
   <Vehicle>
    <car>
<xsl:if test="contains(Description,'.')">
  <xsl:element name="{concat(substring-before(Description, '.'),substring-after (Profile, ' '))}">
<xsl:element name="{substring-after(Description, '.')}">
<xsl:value-of select="Value"/>
</xsl:element>
</xsl:element>
</xsl:if>
     </car>
     </Vehicle>
     </xsl:template>
     <xsl:template match="Vehicle" mode="pass3">
     <xsl:apply-templates select="*/*[1]" mode="pass3"/>
     </xsl:template> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:52:55.857

**这种转换（仍然是 2-pass :)）**：

```
<xsl:stylesheet version="1.0"
         xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
         xmlns:ext="http://exslt.org/common" exclude-result-prefixes="ext">
         <xsl:output omit-xml-declaration="yes" indent="yes"/>

         <xsl:key name="kDescrByAttribs" match="Description"
          use="concat(../@Car_MNo, '+', ../@Car_Model)"/>

         <xsl:key name="kDescrChildByAttribsAndName" match="Description/*"
          use="concat(../../@Car_MNo, '+', ../../@Car_Model, '+', name())"/>

         <xsl:template match="/">
          <xsl:variable name="vrtfPass1">
            <xsl:apply-templates/>
          </xsl:variable>

          <xsl:apply-templates mode="pass2" select=
          "ext:node-set($vrtfPass1)/*/*
                   [generate-id()
                   =
                    generate-id(key('kDescrByAttribs', 
                                     concat(../@Car_MNo, '+', ../@Car_Model)
                                   )
                                    [1])
                   ]
          "/>

         </xsl:template>

         <xsl:template match="Vehicle[contains(Description, '.')]">
          <Vehicle Car_MNo="{Car_MNo}" Car_Model="{Car_Model}">
           <Description>
               <xsl:element name="{substring-before(Description, '.')}">
                 <xsl:element name="{substring-after(Description, '.')}">
                   <xsl:value-of select="colour"/>
                 </xsl:element>
               </xsl:element>
           </Description>
          </Vehicle>
         </xsl:template>

         <xsl:template match="Vehicle">
          <Vehicle Car_MNo="{Car_MNo}" Car_Model="{Car_Model}">
           <Description>
                 <xsl:element name="{Description}">
                   <xsl:value-of select="colour"/>
                 </xsl:element>
           </Description>
          </Vehicle>
         </xsl:template>

         <xsl:template match="Description" mode="pass2">
           <Description>
             <xsl:apply-templates mode="pass2" select=
              "*[generate-id()
                =
                generate-id(key('kDescrChildByAttribsAndName',
                                concat(../../@Car_MNo, 
                                      '+', ../../@Car_Model, 
                                      '+', name())
                               )[1]
                            )
                ]"/>
             <xsl:copy-of select=
              "key('kDescrByAttribs',
                   concat(../@Car_MNo, '+', ../@Car_Model)
                   )/*[not(*)]
              "/>

           </Description>
         </xsl:template>

         <xsl:template match="Description/*" mode="pass2">
           <xsl:element name="{name()}">
             <xsl:copy-of select=
              "key('kDescrChildByAttribsAndName',
                   concat(../../@Car_MNo, '+', ../../@Car_Model, '+', name())
                   )/*
              "/>
           </xsl:element>
         </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<t>
    <Vehicle>
        <Car_MNo>123</Car_MNo>
        <Car_Model>Audi</Car_Model>
        <Description>car.color</Description>
        <colour>BLACK</colour>
    </Vehicle>
    <Vehicle>
        <Car_MNo>123</Car_MNo>
        <Car_Model>Audi</Car_Model>
        <Description>car.hood</Description>
        <colour>RED</colour>
    </Vehicle>
    <Vehicle>
        <Car_MNo>123</Car_MNo>
        <Car_Model>BMW</Car_Model>
        <Description>Bus.Brakes</Description>
        <colour>steel</colour>
    </Vehicle>
    <Vehicle>
        <Car_MNo>123</Car_MNo>
        <Car_Model>BMW</Car_Model>
        <Description>Bus.steering</Description>
        <colour>black</colour>
    </Vehicle>
    <Vehicle>
        <Car_MNo>234</Car_MNo>
        <Car_Model>benz</Car_Model>
        <Description>cycle.color</Description>
        <colour>violet</colour>
    </Vehicle>
    <Vehicle>
        <Car_MNo>345</Car_MNo>
        <Car_Model>nissan</Car_Model>
        <Description>bike.seat</Description>
        <colour>RED</colour>
    </Vehicle>
    <Vehicle>
        <Car_MNo>345</Car_MNo>
        <Car_Model>nissan</Car_Model>
        <Description>car</Description>
        <colour>RED</colour>
    </Vehicle>
</t> 
```

**产生想要的正确结果：**

```
<Description>
   <car>
      <color>BLACK</color>
      <hood>RED</hood>
   </car>
</Description>
<Description>
   <Bus>
      <Brakes>steel</Brakes>
      <steering>black</steering>
   </Bus>
</Description>
<Description>
   <cycle>
      <color>violet</color>
   </cycle>
</Description>
<Description>
   <bike>
      <seat>RED</seat>
   </bike>
   <car>RED</car>
</Description> 
```

# javascript - 我如何在 GWT 2.4 中使用没有 JSNI 的 javascript

> ID：11369153
> 
> 赞同：0
> 
> 时间：2012-07-06T20:20:10.480
> 
> 标签：javascript, gwt

我有一个从最新版本扩展而来的手写 jquery javascript。它不在 GWTQuery 或 GWTQuery-UI 中。我知道 JSNI 可以注入任何 javascipt，但我不想使用它，因为如果我想更改和测试某些东西，它就太死板了。

有什么办法可以直接在 UIBinder 模板 xml 文件中使用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:42:56.583

UiBinder 中不支持 Javascript。

如果要调用 Javascript，则需要使用 JSNI。使用两种不同的实现可以避免测试问题。

如果您担心开发周转时间，您可能想看看超级开发模式。

# database-design - 数据库表 vs config/yml 属性，用于很少更改的值

> ID：11369156
> 
> 赞同：0
> 
> 时间：2012-07-06T20:20:14.140
> 
> 标签：database-design, configuration-files

我做了一些初步的阅读。

[配置文件与数据库表](https://stackoverflow.com/questions/3190710/config-files-vs-database-tables)
[类型用于 sql 表中的“状态”列](https://stackoverflow.com/questions/7205391/type-to-use-for-status-columns-in-a-sql-table)

表：

```
[video]
    id
    title
    format_id (foreign key)
    language_id (foreign key)
    aspect_ratio_id (foreign key)

[formats]
    id
    name

[languages]
    id
    name

[aspect_ratios]
    id
    name 
```

最后 3 个表（格式、语言、方面比率）不会有太大变化（如果有的话）。即当我们支持它时，我可能会添加一种新语言。

那么将这些类型的表（仅引用，几乎没有任何更新/插入）提取到独立的 yaml 文件中并具有处理视图的应用程序逻辑是否是一种好习惯？或者我应该以表连接的（小）成本将所有内容保留在数据库中以维护数据和关系完整性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:51:10.037

如果它们很少更改并且可以在部署之前或部署时定义，我更喜欢文件，YAML 或 JSON。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T22:40:43.503

您是否需要在这些表上强制执行参照完整性（即外键）？如果是，则将它们保存在数据库中并让 DBMS 为您强制执行。其他类型的完整性也是如此。

你打算和其他人一起加入这些表吗？如果是，请将它们保存在数据库中，让 DBMS 完成繁重的工作。

您是否需要以事务方式更新它们（尽管很少）？如果是，那么让 DBMS 为您提供[ACID](http://en.wikipedia.org/wiki/ACID)。

您需要备份这些数据吗？如果是，就让它与常规数据库备份一起发生。

您是否需要确保所有客户端的数据都相同？如果是，那么像数据库这样的中心位置是一个明显的候选者。

等等等等……

# php - mysql 中始终排在最前面的一行

> ID：11369157
> 
> 赞同：1
> 
> 时间：2012-07-06T20:20:28.383
> 
> 标签：php, mysql, sorting, select, sql-order-by

我是一名自学成才的编码员，所以我可能会忽略一些我在课堂上没有学到的非常简单的答案，但是......

我有一个充满不同业务的数据库，它们`Unique ID`与我服务器上的图片名称相对应。每次加载我网站上的页面时，我都希望 php 以最少的浏览量获取业务（以及后续广告）。万一它是相关的，我也有两种不同尺寸的广告。我将尝试说明。

桌子：

```
Business Name | Unique ID | Views | Size
--------------+-----------+-------+------
Business 1    | 1         | 50    | Small
Business 2    | 2         | 9     | Small
Business 3    | 3         | 67    | Large
Business 4    | 4         | 9     | Large 
```

所以我使用这个脚本来检索具有最低视图的业务

```
SELECT * FROM ads WHERE size='Large' ORDER BY views ASC 
```

现在问我的问题 - 这一直有效，直到所有视图达到“9”，然后它似乎只选择两个广告（每种尺寸一个）始终显示。因此，在示例中，您希望`Business 4`被选中，但由于某种原因`business 3`始终是被选中的那个。

此外，当我在 PhpMyAdmin 中进行调查并单击列名称`views`以按视图排序时，这两个业务始终位于顶部或底部（分别为 ASC 和 DESC），从不与列表混合。现在，当我对 ASC 进行排序时，我得到：

```
Views
50
67
9
9 
9
9 
```

50 和 67 显然顺序不正确，它们是始终显示在网页上的两个。似乎在“9”之后，这两个被分配了某种优先级，我不知道。

我还应该提到在特定网页调用时处理表格的方式：

```
$result = mysql_query("SELECT * FROM ads WHERE size='Large' ORDER BY views ASC") or die(mysql_error());
$productCount = mysql_num_rows($result); // count the output amount
if ($productCount > 0) {
    if($row = mysql_fetch_array($result)){ 
            $id = $row["id"];
        $url = $row["url"];
        $views = $row["views"];
            $businessName = $row["businessName"];
    }
}
$views = $views + 1;
$sql = mysql_query("UPDATE ads SET views='$views' WHERE id='$id'"); 
```

这是在我网站上每个页面的 php 代码中。

广告使用以下 html 代码显示：

```
<div id="ad1">
        <a href="<?php echo $url; ?>" target="_blank"> <img src="inventory_images/<?php echo $id; ?>.jpg" alt="<?php echo $businessName; ?>" height="144" width="216"/></a>
    </div> 
```

希望这是足够的信息，非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:23:48.757

确保您的“views”列设置为类型“int”而不是“char”或“varchar”，否则它不会按预期排序。

# javascript - 如何根据当前选定按钮的上下文选择正确的子元素隐藏输入值？

> ID：11369159
> 
> 赞同：0
> 
> 时间：2012-07-06T20:20:40.963
> 
> 标签：javascript, jquery

我试图整理一个 5 天的清单应用程序。清单应用程序有 5 个水平跨越页面的 div。每个 div 代表一天。每个 div 代表一周中的一天，每个 div 包含一个隐藏的输入字段，其中包含该特定日期的日期值。每个 div 也有一个检查列表按钮，当用户单击该按钮时，任务列表将被删除，并在其位置出现一个表单以添加任务。我正在尝试捕获隐藏输入字段的值，即该特定 div 的日期。但是，即使我使用“this”关键字，无论我单击哪个检查列表按钮，我都只能返回当前日期。这是第一个 div 中的输入值。如何根据单击的检查列表按钮选择唯一输入值（日期）？

jQuery：

```
$(".task-btn").click(function(){
    // Setting form to the clone I want to acces in .on()
    var refdate = $(this).closest('#replace').children('.hidden-date').val();
    console.log(refdate);
}); 
```

html和php：

```
<?php 
  $date = date("F j, Y");
  $refDate = date("Y-m-d");
  $counterForLi = 0;
?>
<div id="replace">
              <input type="hidden" name="thedate" class="hidden-date" value="<?php echo $refDate; ?>">
              <h2 class="day"></h2>
                <h4 class="thedate">
                  <?php
                    if ($counter > 0) {
                      $tomorrow = mktime(0, 0, 0, date("m"), date("d")+$counter, date("y"));
                      $refDate = date("Y-m-d", $tomorrow);
                      $date = date("F j, Y", $tomorrow);
                      echo $date;
                    } else {
                      echo $date;
                    }
                  ?>
                </h4>
                <?php echo $refDate; ?>

                <div class="btn-group">
                  <button class="btn task-btn">Add Task</button> 
```

注意：我回显了每个 div 的日期，并确保 php.ini 没有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T20:31:35.887

尽管您的问题的答案可以是：

```
$(this).parents("#replace").find('.hidden-date').val(); 
```

您的问题在另一个地方，因为您显示的代码段也应该有效

# java - org.xml.sax.SAXException：在 Java 中使用 Axis 的 {http://www.w3.org/2001/XMLSchema}anyType 没有反序列化器

> ID：11369161
> 
> 赞同：3
> 
> 时间：2012-07-06T20:21:27.483
> 
> 标签：java, axis, wsdl2java

我正在使用从 WSDL 创建的 Java 源包进行肥皂调用。

插入必要的详细信息后，应用程序进行调用并接收错误；

代码：

```
public static String getRioInformation(String msisdn, String endpoint_address) {
     String rio_response="";
   try {
       System.out.println("here  :");
       FwiEsbWs4USSDLocator locator=new FwiEsbWs4USSDLocator();
       locator.setMaintainSession(true);

       locator.setFwiEsbWs4USSDEndPointEndpointAddress(endpoint_address);

       FwiEsbWs4USSDSoapBindingStub temp;

       FwiEsbWs4USSD fwi;
       FwiEsbWs4USSDPortType port;
       GetRioInformationsRequest rio=new GetRioInformationsRequest();
       RioSearchRequest search=new RioSearchRequest();
       search.setMsisdn(msisdn);

       DefaultContext def_context = new DefaultContext();
       DateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
       def_context.setEffectiveDatetime(Calendar.getInstance());

       def_context.setSystem(MappingSystem.USSD);
       search.setContext(def_context);
       rio.setRioSearchRequest(search);

       FwiEsbWs4USSD cg= null;

       //QName q = new QName("http://service.digicel.fr/", "GetRioInformationsRequest");
       int responseCode=0;
       try {
            //cg=locator.;

           port =  locator.getFwiEsbWs4USSDEndPoint();

           DefaultResponse def=new DefaultResponse();

           def= port.getRioInformations(rio);

           ContextEnrichment context = def.getEnrichment();
           RioInformation[] rio_info =context.getRioInformation();
           rio_response = rio_info[0].getRIO();
       } catch (ServiceException ex) {
           System.out.println("ex 1 :"+ex);
       } 

  } catch (Exception e) {
    System.err.println("SOAP Call Error: "+e.toString());
    e.printStackTrace();
  }
   return rio_response;
} 
```

错误：

```
SOAP Call Error: org.xml.sax.SAXException: No deserializer for {http://www.w3.org/2001/XMLSchema}anyType
AxisFault
faultCode: {http://schemas.xmlsoap.org/soap/envelope/}Server.userException
faultSubcode: 
faultString: org.xml.sax.SAXException: No deserializer for {http://www.w3.org/2001/XMLSchema}anyType
faultActor: 
faultNode: 
faultDetail: 
    {http://xml.apache.org/axis/}stackTrace:org.xml.sax.SAXException: No deserializer for {http://www.w3.org/2001/XMLSchema}anyType
    at org.apache.axis.encoding.ser.BeanDeserializer.onStartChild(BeanDeserializer.java:314)
    at org.apache.axis.encoding.DeserializationContext.startElement(DeserializationContext.java:1035)
    at org.apache.axis.message.SAX2EventRecorder.replay(SAX2EventRecorder.java:165)
    at org.apache.axis.message.MessageElement.publishToHandler(MessageElement.java:1141)
    at org.apache.axis.message.RPCElement.deserialize(RPCElement.java:236)
    at org.apache.axis.message.RPCElement.getParams(RPCElement.java:384)
    at org.apache.axis.client.Call.invoke(Call.java:2448)
    at org.apache.axis.client.Call.invoke(Call.java:2347)
    at org.apache.axis.client.Call.invoke(Call.java:1804)
    at fr.digicel.service.DigicelFwiEsbWs4USSDSoapBindingStub.getRioInformations(DigicelFwiEsbWs4USSDSoapBindingStub.java:2333)
    at com.digicel.mynumber.SOAPInteractions.getRioInformation(SOAPInteractions.java:107)
    at com.digicel.mynumber.Main.&lt;init&gt;(Main.java:97)
    at com.digicel.mynumber.Main.main(Main.java:253)
org.xml.sax.SAXException: No deserializer for {http://www.w3.org/2001/XMLSchema}anyType
    at org.apache.axis.AxisFault.makeFault(AxisFault.java:101)
    at org.apache.axis.client.Call.invoke(Call.java:2451)
    at org.apache.axis.client.Call.invoke(Call.java:2347)
    at org.apache.axis.client.Call.invoke(Call.java:1804)
    at fr.digicel.service.DigicelFwiEsbWs4USSDSoapBindingStub.getRioInformations(DigicelFwiEsbWs4USSDSoapBindingStub.java:2333)
    at com.digicel.mynumber.SOAPInteractions.getRioInformation(SOAPInteractions.java:107)
    at com.digicel.mynumber.Main.<init>(Main.java:97)
    at com.digicel.mynumber.Main.main(Main.java:253)
Caused by: org.xml.sax.SAXException: No deserializer for {http://www.w3.org/2001/XMLSchema}anyType
        at org.apache.axis.encoding.ser.BeanDeserializer.onStartChild(BeanDeserializer.java:314)
        at org.apache.axis.encoding.DeserializationContext.startElement(DeserializationContext.java:1035)
        at org.apache.axis.message.SAX2EventRecorder.replay(SAX2EventRecorder.java:165)
        at org.apache.axis.message.MessageElement.publishToHandler(MessageElement.java:1141)
        at org.apache.axis.message.RPCElement.deserialize(RPCElement.java:236)
        at org.apache.axis.message.RPCElement.getParams(RPCElement.java:384)
        at org.apache.axis.client.Call.invoke(Call.java:2448)
        ... 6 more 
```

错误发生在“def=port.getRioInformations(rio);”行上，解决该错误需要什么？解决此问题需要什么示例反序列化程序代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-09-30T08:24:21.597

经过几天的努力和同事的帮助后，我已经解决了同样的问题，我得出了结论。在静态块中的你的 responceType 类（你想从 xml 响应 ot 对象中解析）中。 `elemField.setXmlType(new javax.xml.namespace.QName("http://www.w3.org/2001/XMLSchema", "anyType"));`

将此 QName 更改为

`elemField.setXmlType(new javax.xml.namespace.QName("http://www.w3.org/2001/XMLSchema", "string"));`

# java - 您可以通过公共嵌套接口访问私有 [静态] 嵌套类吗？

> ID：11369165
> 
> 赞同：0
> 
> 时间：2012-07-06T20:22:00.647
> 
> 标签：java, oop

好的，设置如下：

```
EnclosingClass {

    public interface ClassFactory {
        public static SomeClass getInstance(int which);
    }

    private static ClassFactoryImpl {
        @Override
        public static SomeClass getInstance(int which) {
            switch(which) {
            case 1:
                return new SomeClassSubclassA();
            case 2:
                return new SomeClassSubclassB();
            ...
            }
        }
    }
} 
```

我希望能够发表以下声明：

```
SomeClass x = EnclosingClass.ClassFactory.getInstance(instanceClassRequest); 
```

这可能吗？如果没有，我如何仅通过它实现的接口访问静态嵌套类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:27:03.437

最简洁的答案是不。” 您需要创建实现类的*实例*并将其放入静态变量中。它看起来像这样：

```
public class EnclosingClass {
    public interface ClassFactory {
        public SomeClass getInstance(int which);
    }
    public static final ClassFactory CLASS_FACTORY;

    private static class ClassFactoryImpl implements ClassFactory {
        public SomeClass getInstance(int which) { /* ... */ }
    }

    static {
        CLASS_FACTORY = new ClassFactoryImpl();
    }
} 
```

另请注意，实例上的方法不再是静态的。

然后调用它的代码如下所示：

```
SomeClass x = EnclosingClass.CLASS_FACTORY.getInstance(2); 
```

# php - PHP 会话与 Cookie

> ID：11369166
> 
> 赞同：2
> 
> 时间：2012-07-06T20:22:01.313
> 
> 标签：php, javascript, session, cookies, store

> **可能重复：**
> [Cookie VS 会话](https://stackoverflow.com/questions/6253633/cookie-vs-session)
> [PHP：Cookie 和会话如何工作？](https://stackoverflow.com/questions/11142882/php-how-do-cookies-and-sessions-work)

我正在努力学习 PHP。我有一个项目网站，其中不断生成数字，并更改并存储在 javascript 变量中。除了在用户点击“存储到数据库”按钮时将这些变量存储到数据库之外，几乎没有涉及 php。今天我正在使用该网站，导航到另一个网站并返回，我的所有数据都消失了，因为我没有先将其存储到数据库中。我想保存该数据，以便在我离开页面时重新填充。这样做的最佳方法是什么？php 会话、cookie 或 javascript cookie？请指教，提前谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-06T20:27:09.457

> php 会话、cookie 或 javascript cookie？

有会话或 cookie，所以有**两**件事而不是三件事。

现在**会话也是一个 cookie**，但保存在**服务器上，这与保存在****用户机器中的**简单 JS cookie 不同。

> 我想保存该数据，以便在我离开页面时重新填充

如果是**敏感**信息，请始终使用**数据库**存储，如果**不是**敏感数据：

*   使用cookies或`localStorage`但它可以被用户**删除**
*   使用用户无法删除但会根据 php.ini 设置**过期的会话**

另一方面，要**永久**保存它，请改用数据库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T20:27:08.020

**PHP 和 Javascript** cookie 是**一回事**，它们只是**存储在客户端**的数据，php 和 javascript 是用来存储它们的技术，仅此而已。

由于 PHP cookie 只能**在输出发送到页面之前**设置，因此 Javascript cookie 似乎是最好的。

您将使用 cookie 而不是会话，因为您提到您将离开页面，在这种情况下会话将**终止**并且您将丢失数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T20:25:55.937

当您想临时存储一些数据时使用**会话（对于一个会话 - 直到用户关闭他的浏览器）。**

当您想要更长时间地存储数据（如登录凭证）时，请使用**cookie 。**

您还应该记住，用户可以更改存储的 cookie 的值，但不能更改会话，因为会话存储在服务器上，而 cookie 存储在客户端的计算机上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-06T20:26:31.257

我相信 cookie 是您需要的答案，因为 php 会话仅存储在页面加载之间，因此您已经有效地将数据发送回服务器（不是您想要的），据我所知，javascript cookie 只是 cookie 集用javascript。

因此，为了澄清，我认为您应该在每次创建一些数据时设置一个 cookie（通过使用 javascript） - 它将本地存储在浏览器上（仍然相当不稳定），直到用户按下保存按钮，它将被发送回服务器。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-07-06T20:25:55.667

如果您想长期存储 PHP cookie，但不关心用户是否更改值。

如果您不希望用户能够更改值但不需要长期存储，则 PHP 会话（这听起来像您想要的）

如果您想长期存储并且不希望用户有权更改值，则会话和 cookie 都可以。您可能希望使用数据库，以便您可以使用数据库检查 cookie 信息以查看它是否正确，然后将数据存储在会话中以便于访问。

这是有多少网站“记住用户”。他们存储一个带有用户名和密码的 cookie，然后当用户访问该网站时（如果未设置会话），他们会使用数据库检查用户名和密码，然后如果它是正确的，他们会创建一个特定于该用户的会话。

# r - 在 R 中按时间间隔对数据集进行分区

> ID：11369167
> 
> 赞同：0
> 
> 时间：2012-07-06T20:22:06.560
> 
> 标签：r, dataset, partitioning

我有一些按小时观察到的数据。我试图按天甚至每周间隔对这些数据进行子集化。我不确定如何在`R`.

数据样本如下。

```
date                                 obs
2011-10-24 01:00:00                  12
2011-10-24 02:00:00                  4
2011-10-24 19:00:00                  18
2011-10-24 20:00:00                  7
2011-10-24 21:00:00                  4
2011-10-24 22:00:00                  2
2011-10-25 00:00:00                  4
2011-10-25 01:00:00                  2
2011-10-25 02:00:00                  2
2011-10-25 15:00:00                  12
2011-10-25 18:00:00                  2
2011-10-25 19:00:00                  3
2011-10-25 21:00:00                  2
2011-10-25 23:00:00                  9
2011-10-26 00:00:00                  13
2011-10-26 01:00:00                  11 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:38:46.797

我会使用时间序列类，例如`xts`

```
dat <- read.table(text="2011-10-24 01:00:00                  12
2011-10-24 02:00:00                  4
2011-10-24 19:00:00                  18
2011-10-24 20:00:00                  7
2011-10-24 21:00:00                  4
2011-10-24 22:00:00                  2
2011-10-25 00:00:00                  4
2011-10-25 01:00:00                  2
2011-10-25 02:00:00                  2
2011-10-25 15:00:00                  12
2011-10-25 18:00:00                  2
2011-10-25 19:00:00                  3
2011-10-25 21:00:00                  2
2011-10-25 23:00:00                  9
2011-10-26 00:00:00                  13
2011-10-26 01:00:00                  11", header=FALSE, stringsAsFactors=FALSE)

xobj <- xts(dat[, 3], as.POSIXct(paste(dat[, 1], dat[, 2]))) 
```

xts 子集非常直观。对于“2011-10-25”的所有数据，执行此操作

```
xobj["2011-10-25"]
#                    [,1]
#2011-10-25 00:00:00    4
#2011-10-25 01:00:00    2
#2011-10-25 02:00:00    2
#2011-10-25 15:00:00   12
#2011-10-25 18:00:00    2
#2011-10-25 19:00:00    3
#2011-10-25 21:00:00    2
#2011-10-25 23:00:00    9 
```

您还可以像这样子化时间跨度（包括 2011-10-24 和 2011-10-25 之间的所有数据）

```
xobj["2011-10-24/2011-10-25"] 
```

或者，如果您想要 2011 年 10 月的所有数据，

```
xobj["2011-10"] 
```

如果您想获取 19:00 到 20:00 之间任何一天的所有数据，

```
xobj['T19:00:00/T20:00:00']
#                    [,1]
#2011-10-24 19:00:00   18
#2011-10-24 20:00:00    7
#2011-10-25 19:00:00    3 
```

您可以使用该`endpoints`函数查找时间段的最后一行（“小时”、“天”、“周”等）

```
endpoints(xobj, "days")
[1]  0  6 14 16 
```

或者您可以转换为较低的频率

```
to.weekly(xobj)
#           xobj.Open xobj.High xobj.Low xobj.Close
#2011-10-26        12        18        2         11
to.daily(xobj)
#           xobj.Open xobj.High xobj.Low xobj.Close
#2011-10-25        12        18        2          2
#2011-10-26         4        12        2          9
#2011-10-26        13        13       11         11 
```

请注意，上面创建了开盘价、最高价、最低价和收盘价列。如果您只想要端点处的数据，您可以使用`OHLC=FALSE`

```
to.daily(xobj, OHLC=FALSE)
#           [,1]
#2011-10-25    2
#2011-10-26    9
#2011-10-26   11 
```

有关更多基本子集等内容，请访问[http://www.quantmod.com/examples/](http://www.quantmod.com/examples/)

正如@JoshuaUlrich 在评论中提到的那样，`split.xts`它非常有用。

您可以按天（或周、月等）拆分，应用一个函数，然后重新组合

```
split(xobj, 'days') #create a list where each element is the data for a different day
#[[1]]
#                    [,1]
#2011-10-24 01:00:00   12
#2011-10-24 02:00:00    4
#2011-10-24 19:00:00   18
#2011-10-24 20:00:00    7
#2011-10-24 21:00:00    4
#2011-10-24 22:00:00    2
#
#[[2]]
#                    [,1]
#2011-10-25 00:00:00    4
#2011-10-25 01:00:00    2
#2011-10-25 02:00:00    2
#2011-10-25 15:00:00   12
#2011-10-25 18:00:00    2
#2011-10-25 19:00:00    3
#2011-10-25 21:00:00    2
#2011-10-25 23:00:00    9
#
#[[3]]
#                    [,1]
#2011-10-26 00:00:00   13
#2011-10-26 01:00:00   11 
```

假设您只需要每天的第一个值。 `split`按天，`lapply`函数`first`又`rbind`回来了。

```
do.call(rbind, lapply(split(xobj, 'days'), first))
#                    [,1]
#2011-10-24 01:00:00   12
#2011-10-25 00:00:00    4
#2011-10-26 00:00:00   13 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T20:32:00.670

首先，我输入了多个空格替换为制表符的数据。

```
dat$date <- as.POSIXct(dat$date, format="%Y-%m-%d %H:%M:%S")
split(dat , as.POSIXlt(dat$date)$yday)
# Notice these are not the same functions
#---------------------
$`296`
                 date obs
1 2011-10-24 01:00:00  12
2 2011-10-24 02:00:00   4
3 2011-10-24 19:00:00  18
4 2011-10-24 20:00:00   7
5 2011-10-24 21:00:00   4
6 2011-10-24 22:00:00   2

$`297`
                  date obs
7  2011-10-25 00:00:00   4
8  2011-10-25 01:00:00   2
9  2011-10-25 02:00:00   2
10 2011-10-25 15:00:00  12
11 2011-10-25 18:00:00   2
12 2011-10-25 19:00:00   3
13 2011-10-25 21:00:00   2
14 2011-10-25 23:00:00   9

$`298`
                  date obs
15 2011-10-26 00:00:00  13
16 2011-10-26 01:00:00  11 
```

POSIXlt 类在数据帧中不能很好地工作，但它可以非常方便地创建基于时间的组。这是一个具有以下索引的列表结构：'yday'、'wday'、'year'、'mon'、'mday'、'hour'、'min'、'sec'和'isdt'。该`cut.POSIXt`函数在其他自然边界处添加分割；例如

```
?cut.POSIXt
  split(dat , cut(dat$date, "week") ) 
```

如果您想在日期内求和：

```
tapply(dat$obs, as.POSIXlt(dat$date)$yday, sum)
#-------
296 297 298 
 47  36  24 
```

# cocos2d-iphone - 当我不提供 -hd 文件时会发生什么？

> ID：11369170
> 
> 赞同：0
> 
> 时间：2012-07-06T20:22:14.780
> 
> 标签：cocos2d-iphone

Cocos2d-iphone 1.0.1

我为我的应用启用了视网膜显示。我提供 myimage.png，但我不提供 myimage-hd.png。当我运行游戏时，我确实收到一条消息说找不到高清文件。伟大的。然而，游戏并没有崩溃：我在我的游戏中看到**精灵**显然使用了 sd 文件。

发生了什么？它是使用 sd 文件然后调整它的大小吗？它仍然是视网膜，但我的精灵的版本更小了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:49:09.137

它将回退到使用 SD 文件。SD 文件的大小将是文件 HD 版本的一半（如果已提供）。因此，如果您稍后添加 -hd 文件，您将看到更大版本的图像。这是你要避免的事情。

仅部分支持 Retina 通常不是一个好主意。如果您使用 -hd，则建议不加选择地对所有资产使用它。当然，-ipad 和 -ipadhd 也是如此。

我今天很难学到的一点是，如果您**只**提供 -hd 或 -ipad 版本但不包含没有后缀的常规版本，cocos2d 将尝试加载 SD 图像（因为这是它总是首先检查的内容）。由于失败 cocos2d (v1.1) 将返回 nil 纹理，而不是寻找 -hd 或 -ipad 版本。要解决此问题，请使用 CCFileUtils setIpadSuffix 和 setiPhoneRetinaSuffix 为 -hd 或 -ipad 以外的其他内容。就我而言，只需将它们设置为空字符串（无后缀）即可。

# java - JComponents没有显示图片背景？

> ID：11369171
> 
> 赞同：4
> 
> 时间：2012-07-06T20:22:23.047
> 
> 标签：java, swing, jframe, jpanel, bufferedimage

我的组件没有出现。我该如何解决？

代码：

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;

import javax.imageio.ImageIO;
import javax.swing.*;

public class login implements ActionListener{
    JTextField gusername;
    JTextField gpassword;
    static String username;
    static String password;

    void logini() throws IOException {
        JFrame window = new JFrame("Login");
        window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        window.setSize(300, 250);
        window.setResizable(false);
        window.setVisible(true);

        JPanel mainp = new JPanel(new GridBagLayout());
        GridBagConstraints c = new GridBagConstraints();
        window.add(mainp);

        BufferedImage myPicture = ImageIO.read(new File("c:\\bgd.png"));
        JLabel picLabel = new JLabel(new ImageIcon( myPicture ));
        mainp.add(picLabel, c);

        c.gridx = 0;
        c.gridy = 1;
        gusername = new JTextField();
        gusername.setText("Username");
        mainp.add(gusername, c);

        c.gridx = 0;
        c.gridy = 2;
        gpassword = new JTextField();
        gpassword.setText(" password ");
        mainp.add(gpassword, c);

        c.gridx = 0;
        c.gridy = 3;
        JButton login = new JButton("Login");
        mainp.add(login, c);

        login.addActionListener(this);
        login.setActionCommand("ok");
    }

    public void actionPerformed(ActionEvent e) {
        if (e.getActionCommand().equalsIgnoreCase("ok")){
            try {
                this.username = (gusername.getText());
                this.password = (gpassword.getText());
                System.out.println("0");
            }
            catch(NumberFormatException ex){
                System.out.println("ERROR: Could not preform function: 7424");
            }
        }
    }
} 
```

结果：

![](../Images/cf62253c7e4aa93cb7f1a437c358bc0b.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-07T04:54:22.967

这里首先看这个小例子，如果你明白这里发生了什么，请告诉我。那么只有我们会更进一步，慢慢地慢慢地。尝试通过这个例子，我将向你展示如何在一个`JPanel`

```
import java.awt.*;
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.net.URL;
import javax.imageio.ImageIO;
import javax.swing.*;

public class PaintingExample {

    private CustomPanel contentPane;

    private void displayGUI() {
        JFrame frame = new JFrame("Painting Example");
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        contentPane = new CustomPanel();        

        frame.setContentPane(contentPane);
        frame.pack();
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    public static void main(String... args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new PaintingExample().displayGUI();
            }
        });
    }
}

class CustomPanel extends JPanel {

    private BufferedImage image;

    public CustomPanel() {
        setOpaque(true);
        setBorder(BorderFactory.createLineBorder(Color.BLACK, 5));
        try {
            /*
             * Since Images are Application Resources,
             * it's always best to access them in the
             * form of a URL, instead of File, as you are doing.
             * Uncomment this below line and watch this answer
             * of mine, as to HOW TO ADD IMAGES TO THE PROJECT
             * http://stackoverflow.com/a/9866659/1057230
             * In order to access images with getClass().getResource(path)
             * here your Directory structure has to be like this
             *                 Project
             *                    |
             *         ------------------------
             *         |                      |
             *        bin                    src
             *         |                      |
             *     ---------             .java files             
             *     |       |                   
             *  package   image(folder)
             *  ( or              |
             *   .class        404error.jpg
             *   files, if
             *   no package
             *   exists.)
             */
            //image = ImageIO.read(
            //      getClass().getResource(
            //              "/image/404error.jpg"));
            image = ImageIO.read(new URL(
                        "http://i.imgur.com/8zgHpH8.jpg"));
        } catch(IOException ioe) {
            System.out.println("Unable to fetch image.");
            ioe.printStackTrace();
        }
    }

    /*
     * Make this one customary habbit,
     * of overriding this method, when
     * you extends a JPanel/JComponent,
     * to define it's Preferred Size.
     * Now in this case we want it to be 
     * as big as the Image itself.
     */
    @Override
    public Dimension getPreferredSize() {
        return (new Dimension(image.getWidth(), image.getHeight()));
    }

    /*
     * This is where the actual Painting
     * Code for the JPanel/JComponent
     * goes. Here we will draw the image.
     * Here the first line super.paintComponent(...),
     * means we want the JPanel to be drawn the usual 
     * Java way first (this usually depends on the opaque
     * property of the said JComponent, if it's true, then
     * it becomes the responsibility on the part of the
     * programmer to fill the content area with a fully
     * opaque color. If it is false, then the programmer
     * is free to leave it untouched. So in order to 
     * overcome the hassle assoicated with this contract,
     * super.paintComponent(g) is used, since it adheres
     * to the rules, and performs the same task, depending
     * upon whether the opaque property is true or false),
     * then later on we will add our image to it, by 
     * writing the other line, g.drawImage(...).
     */
    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.drawImage(image, 0, 0, this);
    }
} 
```

### 编译并运行：

1.  启动命令提示符/终端/cmd。**并移动到Project**文件夹所指的位置
2.  现在使用以下代码编译代码：

    > C:\Project>javac -d bin src\*.java

3.  现在通过发出命令移动到**bin**文件夹：

    > C:\项目>cd bin

4.  进入**bin**文件夹后，发出以下命令运行：

    > C:\Project\bin>java 绘画示例

这是`JLabel`用作图像基础时的代码：

```
import java.awt.*;
import java.net.MalformedURLException;
import java.net.URL;
import javax.swing.*;

public class LabelExample {

    private JPanel contentPane;
    private JLabel imageLabel;

    private void displayGUI() {
        JFrame frame = new JFrame("Label Example");
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        contentPane = new JPanel();
        contentPane.setOpaque(true);
        contentPane.setBorder(
                BorderFactory.createLineBorder(Color.BLACK, 5));
        //imageLabel = new JLabel(
        //          new ImageIcon(
        //              getClass().getResource(
        //                  "/image/404error.jpg")));
        try {
            imageLabel = new JLabel(new ImageIcon(
                    new URL("http://i.imgur.com/8zgHpH8.jpg")));
        } catch(MalformedURLException mue) {
            System.out.println(
                    "Unable to get Image from"
                        + "the Resource specified.");
            mue.printStackTrace();
        }
        contentPane.add(imageLabel);
        frame.setContentPane(contentPane);  
        frame.pack();
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    public static void main(String... args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new LabelExample().displayGUI();
            }
        });
    }
} 
```

这是上述两个代码的输出：

![404错误](../Images/6509869a53ad11280b2ad6f157430475.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-25T12:37:47.120

```
window.setVisible(true); should be invoked only after all the components have been added to the frame.
 void logini() throws IOException {
        JFrame window = new JFrame("Login");
        JPanel mainp = new JPanel(new GridBagLayout());
        GridBagConstraints c = new GridBagConstraints();
        window.add(mainp);

        BufferedImage myPicture = ImageIO.read(new File("c:\\bgd.png"));
        JLabel picLabel = new JLabel(new ImageIcon( myPicture ));
        mainp.add(picLabel, c);

        c.gridx = 0;
        c.gridy = 1;
        gusername = new JTextField();
        gusername.setText("Username");
        mainp.add(gusername, c);

        c.gridx = 0;
        c.gridy = 2;
        gpassword = new JTextField();
        gpassword.setText(" password ");
        mainp.add(gpassword, c);

        c.gridx = 0;
        c.gridy = 3;
        JButton login = new JButton("Login");
        mainp.add(login, c);

        login.addActionListener(this);
        login.setActionCommand("ok");

        window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        window.setSize(500, 250);
        window.setResizable(false);
        window.setVisible(true);
    } 
```

# java - 改变一个变量会改变另一个

> ID：11369173
> 
> 赞同：3
> 
> 时间：2012-07-06T20:22:31.380
> 
> 标签：java, object

当我创建一个球的实例，然后将它的副本复制到另一个变量时，更改原始文件也会更改球的副本。例如，以下面非常简化的示例为例：

```
class Ball() {
    Color _color;
    public Ball(Color startColor) {
        _color = startColor;
    }
    public void setColor(Color newColor) {
        _color = newColor;
    }
}
Ball myBall = new Ball(black);
Ball mySecondBall = myBall;
myBall.setColor(white); 
```

我已经省略了 _color 的访问器方法，但是如果我得到了球的颜色，它们现在都是白色的！所以我的问题是：

*   为什么更改一个对象会更改它的副本，以及
*   有没有办法复制一个对象，以便您可以独立更改它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T20:24:34.333

`Ball mySecondBall = myBall;`

这不会创建副本。您分配一个参考。这两个变量现在都引用同一个对象，这就是为什么两个变量都可以看到更改的原因。
您应该执行类似创建`new Ball`相同颜色的复制操作：

`Ball mySecondBall = new Ball(myBall.getColor());`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T20:24:56.230

没有副本，`Ball`在这个赋值之后有两个对同一个实例的引用：

```
Ball mySecondBall = myBall; 
```

要创建一个副本，请实现一个副本构造函数`Ball`：

```
class Ball() {
    Color _color;
    public Ball(Color startColor) {
        _color = startColor;
    }
    public Ball(final Ball otherBall) {
        _color = otherBall._color;
    }
    public void setColor(Color newColor) {
        _color = newColor;
    }
} 
```

要使用：

```
Ball myBall = new Ball(black);
Ball mySecondBall = new Ball(myBall); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T20:25:28.663

你只有一个`Ball`对象。`myBall`和引用都`mySecondBall`指向同一个`Ball`对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T20:29:42.373

正如其他人所说，问题在于您对同一个实际实例有两个引用。我喜欢使用的一个类比是您有两个遥控器用于同一台电视。

如果你想拥有两个球，你可以这样做：

```
class Ball() {
  public Ball(Ball original){
      _color = original.getColor();
  }
...etc...
}

Ball myBall = new Ball(black);
Ball mySecondBall = new Ball(myBall);
myBall.setColor(white); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-28T06:05:27.340

上述解决方案肯定会奏效。

对象是复合值，因此通过将对象等同于某个变量不会创建它的副本，而是传递它的引用。因此，改变一个会影响另一个。如果有人想知道更多解决此问题的方法，他们可以尝试以下任何一种方法-

> 球 mySecondBall = JSON.parse(JSON.stringify(myBall));

或者

> 球 mySecondBall = Object.assign({}, myBall);

# objective-c - 如何让 super 成为 NSTimer 的目标？

> ID：11369176
> 
> 赞同：0
> 
> 时间：2012-07-06T20:22:35.877
> 
> 标签：objective-c, ios, nstimer

我正在尝试使用 a`NSTimer`来调用类的超类中的函数。

如果我这样称呼它，该功能将起作用：

```
[super playNarrationForPage:[NSNumber numberWithInt:1]]; 
```

但如果我这样做：

```
NSTimer *narrationTimer = [NSTimer scheduledTimerWithTimeInterval:7.5
                                                           target:self.superclass
                                                           selector:@selector(playNarrationForPage:) 
                                                           userInfo:[NSNumber numberWithInt:1] 
                                                           repeats:NO
                          ]; 
```

我收到此错误：`unrecognized selector sent to class 0x106890 2012-07-06 21:14:59.522 MyApp[19955:707] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '+[MyBaseClass playNarrationForPage:]: unrecognized selector sent to class 0x106890'`

我尝试设置`super`为，`target:`但我被告知“使用未声明的超级标识符”。有什么想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-06T20:28:05.993

由于`self.superclass`返回一个`Class`对象，它绝对不是你想要的。

此外，您似乎不了解 an 如何`NSTimer`调用其目标。您正在使用 an`NSNumber`作为计时器`userInfo`，并且您的`playNarrationForPage:`方法似乎需要一个`NSNumber`参数。但是 an在调用其目标时不会将其作为`NSTimer`参数**传递**！`userInfo`将*自身*作为参数传递，如下所示`NSTimer`：

 *```
// self is the NSTimer object here!
[self.target performSelector:self.selector withObject:self]; 
```

您**必须**为计时器创建一个新方法才能调用。这个新方法需要将计时器作为其参数，如下所示：

```
- (void)narrationTimerDidFire:(NSTimer *)timer {
    [self playNarrationForPage:timer.userInfo];
} 
```

然后，您需要在创建计时器时使用该选择器：

```
NSTimer *narrationTimer = [NSTimer scheduledTimerWithTimeInterval:7.5
    target:self
    selector:@selector(narrationTimerDidFire:)
    userInfo:[NSNumber numberWithInt:1]
    repeats:NO]; 
```

如果你真的想`narrationTimerDidFire:`打电话`[super playNarrationForPage:]`，编译器会让你。但是这样做**很可疑**。如果您没有`playNarrationForPage:`在子类中覆盖，那么没有理由`super`直接引用；您的子类继承其超类的`playNarrationForPage:`方法。如果您在子类*中*重写`playNarrationForPage:`了它，那么从计时器的回调中绕过它表明您的设计有问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-06T20:26:15.807

您应该使用的*唯一*`super`时间是当您在一个方法中并且想要调用超类的**同一方法**的实现时（包括间接 - 见下文）。

`self.superclass`作为计时器的目标没有意义，*除非*您的目标是调用超类上的类方法。

只需`self`用作目标。如果这不起作用，因为您正在重写`playNarrationForPage:`并希望将调用延迟到 super，然后创建一个单独的方法，该方法执行以下操作：

```
- (void) _delayedDoIt
{
     [super playNarrationForPage:1];
} 
```

`playNarrationForPage:`并通过计时器从自己的实现中调用它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-06T20:27:44.097

您不能直接告诉它调用该`super`方法。`target`只是一个指向对象的指针，与您的实例`super`没有单独的指针地址。`self`

此外，通过分配`target`给您，`self.superclass`您正在告诉`target`要成为班级。因此，您尝试调用类方法而不是实例方法，这不是您想要做的。

这样做的唯一方法是将目标分配给`self`并具有单独的方法，例如：

```
- (void)callSuperMethod
{
    [super playNarrationForPage:[NSNumber numberWithInt:1]];
} 
```*

# javascript - 从客户端发送电子邮件

> ID：11369178
> 
> 赞同：0
> 
> 时间：2012-07-06T20:22:48.133
> 
> 标签：javascript, apache-flex

我们正在开发一个需要严格安全性的应用程序。现在，我的问题是客户输入了密码，并且该密码应该通过电子邮件发送给另一个客户。这里的关键点是即使服务器也不应该看到密码，所以客户端必须使用客户端的东西通过应用程序直接将电子邮件发送到另一个客户端。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T03:44:17.130

您将需要一个可以安装在客户端上的电子邮件服务器。

有几个基于 Python 的电子邮件服务器。FreeSMTP 易于安装和配置，但每天只能免费发送 10 封电子邮件 - 但对于概念验证来说肯定很容易上手。

最后，您需要通过客户端代码与电子邮件服务器通信。从您的问题中不清楚您的客户是 Flex 还是 JavaScript。如果您使用的是 Flex，那么 SMTPMailer 可能会有所帮助。 [http://code.google.com/p/smtpmailer/](http://code.google.com/p/smtpmailer/)。使用 JavaScript 可能无法做到这一点 - 请参阅[Javascript IMAP 和 SMTP 客户端？](https://stackoverflow.com/questions/3775191/javascript-imap-and-smtp-client).

不过，这个概念似乎不是一个好概念。相反，您可以发送从密码派生的不可逆哈希 - 然后服务器将永远不会看到密码 - 但哈希可能仍可用于身份验证目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T21:22:56.390

如果您想通过电子邮件将数据从一个客户端传输到另一个客户端，则必须通过服务器。在这种情况下，我建议使用只有客户端才能访问的密钥对密码进行编码，从而使其对服务器不可读。或者将密钥存储在不同的服务器上。

# c# - Console.ReadLine() 从未从 Visual Studio 构建事件中调用

> ID：11369180
> 
> 赞同：0
> 
> 时间：2012-07-06T20:22:55.310
> 
> 标签：c#, visual-studio-2010

我编写了一个小型支持控制台程序，该程序应该通过用户输入在 Visual Studio 的前/后构建中处理其他程序的版本控制。

即用户应该得到提示，他/她想如何对构建进行版本控制。所以在我的前/后我有类似“version.exe $(ProjectDir)”的东西。

但是，`version.exe`以下行的空引用异常会崩溃（用箭头表示）

```
var input = Console.ReadLine();
bool result = input.Substring(0,1).ToUpper() == trueKey; <---- input is null 
```

永远不会提示用户。

怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T20:28:58.287

如果输入流没有更多可用数据，该`Console.ReadLine`方法可以返回一个值。`null`您可以在一个简单的控制台程序中通过`Ctrl+Z`在等待输入时点击来模拟它。

由构建启动的程序可能只是通过关闭输入流来禁止输入。这将是构建阻塞等待用户输入的预防措施

解决此问题的另一种方法是使用 MSBuild 设置。本质上具有版本化和非版本化构建的构建配置。仅当启用版本化构建并消除对用户输入的需要时才启用此构建步骤。

# jquery - 如何用 each 替换元素的 attr href？// 剥离网址

> ID：11369182
> 
> 赞同：8
> 
> 时间：2012-07-06T20:23:02.313
> 
> 标签：jquery, href, each, attr

我试图用每种方法改变href，

[这是演示，检查一个，你会看到没有变化](http://jsfiddle.net/nUsWT/5/)

html:

```
<a href="#/news">News</a>
<a href="#/news/detail">Detail</a>
<a href="#/sport">Sport</a>
<a href="#/sport/football">Football</a>​​​​​​​​​​​​ 
```

jQuery：

```
$('a').each(function() {
  $(this).attr('href').replace('#/',''); //tried to erase #/ from all hrefs
});​ 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-06T20:25:01.720

您发布的代码将获得值作为`string`然后正确`replace`的值，但它会立即丢弃结果。您需要将替换的值传递给`attr`. 尝试以下

```
$('a').each(function() {
  var value = $(this).attr('href');
  $(this).attr('href', value.replace('#/',''));
});​ 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-06T20:24:43.077

```
var href = $(this).attr('href');
$(this).attr('href', href.replace('#/','')); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-10T06:42:59.907

您还可以检查href值并制作条件

```
<script type="text/javascript">
$('a').each(function() {
    var value = $(this).attr('href');
    if(value=='http://google.com')
    {
        $(this).attr('href', 'http://youtube.com');
    }
});​
</script> 
```

# php - 图像抓取占用服务器资源/连接？

> ID：11369186
> 
> 赞同：1
> 
> 时间：2012-07-06T20:23:22.750
> 
> 标签：php, rss, nginx, getimagesize

作为我的网络应用程序的一部分，我构建了一个系统，该系统会定期提取 RSS 提要并抓取其内容。我还查找提要项中存在的任何图像标签，并尝试将其拉出以查询其大小等以确定要使用的“图片”。

这是该部分代码的粗略草图：

1.  有`<image>`节点吗？如果是这样，那就是图像。出口。
2.  [通过simplehtmldom](http://simplehtmldom.sourceforge.net/)解析`description`节点的内容并查找任何和所有标签`img`
3.  遍历所有`img`标签：
    *   `getimagesize();`
    *   如果图像尺寸大于我之前找到的尺寸，请使用这张图片。
4.  出口。

在第 3 步，脚本可能需要一段时间，特别是对于有大量图像供我检查的提要。我假设每次调用 getimagesize() 都需要一定的时间，而且加起来很快。我不太担心它会花费很长时间（尽管如果可以减少它，那将是最好的），但事实上，当这个脚本运行时，它实际上让所有其他并发用户挂起，直到脚本完成。

我想避免这种情况，但不太精通服务器管理 - 也许有人可以给我一些指导？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:27:06.430

如果您需要性能提升，请在单独的服务器上运行它。`getimagesize()`真的可以减慢速度。我建议在它自己的服务器上运行抓取脚本，并在您当前的服务器上托管其他所有内容。

# iphone - Iphone 上的 CSS Wordpress 博客

> ID：11369188
> 
> 赞同：-2
> 
> 时间：2012-07-06T20:23:38.063
> 
> 标签：iphone, css, wordpress

我正在处理这个 wordpress 博客[http://www.taranmarlowjewelry.com/?page_id=7](http://www.taranmarlowjewelry.com/?page_id=7)（在普通的网络浏览器上看起来不错）我尝试编辑 CSS，使其在 iphone 上看起来不错......我添加了这些行在我的 iphone css 文件中

```
.wrapper{
    position:relative;
    width:840px;
    margin:0 auto;
}

.blog #page{
    width:840px !important;
}

.blog #main{
    width:840px !important;
}

.blog #primary {
    width:220px !important;
}

.blog #content {
    width: 220px !important;
}

.blog #secondary {
    width:200px !important;
    float:right !important;
} 
```

但是博客和侧边栏之间有很大的空间，这个页面的宽度太宽了，而我的主页，关于页面看起来不错，.wrapper 的宽度为 840px；

这里出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T20:47:38.707

您是否尝试过使用初始比例？

```
 <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"> 
```

将其添加并相应地调整您的 CSS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:50:05.087

正确的方法是使用响应式主题，因此您将为所有框架格式包含一个 base.css 样式表，然后为每个新的框架格式添加样式表。就像是：

http://yourdomain.com/library/css/style.css' type='text/css' media='(min-width:481px)' />

然后，您可以使用该样式表中的函数将更多样式应用于更大的框架格式。Bones Theme（by themble）是开始学习响应式网页设计的好地方。

做不到这一点 - 肖恩是对的，从元视口设置开始，然后从那里调整。iPad 和 iPhone 屏幕尺寸有一个很好的答案[iPad 浏览器宽度和高度标准](https://stackoverflow.com/questions/3375706/ipad-browser-width-height-standard)

安迪

# objective-c - CMAccelerometerData 类与。不推荐使用的 UIAccelerometer 类

> ID：11369189
> 
> 赞同：1
> 
> 时间：2012-07-06T20:23:42.587
> 
> 标签：objective-c, ios, class, accelerometer

根据[本](http://developer.apple.com/library/ios/#documentation/CoreMotion/Reference/CMAccelerometerData_Class/Reference/Reference.html)文档，**CMAccelerometerData 类**（在 Core Motion 框架中找到）具有**CMAcceleration**类型的属性，称为***加速***，它是包含 3 个值（双 x、双 y、双 z）的结构的 typedef

我对Objective-C相当陌生（我只知道C++ ..）所以我的问题是：在我的代码中的某个时刻，我如何访问，比如说保存在该属性中的*双y值？*

我是否首先像这样创建 CMAccelerometerData 类的实例：

```
CMAccelerometerData *myAccelerometer; 
```

然后访问它的加速属性：

```
double axisYvalue = [myAccelerometer acceleration]; 
```

以上显然是错误的，不是吗？我必须在加速中找到 Y，所以我该怎么做？

```
double axisYvalue = [myAccelerometer acceleration->y]; // no this is wrong as well.. 
```

那么我该怎么做呢？

如果可以的话，还有最后一个问题:)

鉴于我提到的这个特定的类和属性..假设我已经实例化了我的 CMAccelerometer 类..现在每次，在我的代码中，我使用类似的东西

```
return [myAccelerometer acceleration->y]; // let's say that's the correct version :) 
```

在一些 -(double) 方法中..我会在调用的***那个***特定时刻获得 Y 轴的值吗？

我之所以问这个问题是因为我在阅读现已弃用的 UIAccelerometer 类时感到困惑，在该类中您必须定义间隔并经常更新 x、y、z 的值等等。现在我可以获得正在执行的值在 Y 轴上调用加速属性的那一刻，不是这样吗？

唷...对不起这篇文章的长度！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:38:36.843

来自 C++，我认为假设您理解指针是安全的。第一行：

```
CMAccelerometerData *myAccelerometer; 
```

...不是*创建*一个实例，而是*声明一个指向*实例的指针，它不会指向任何有效的东西。要获得一个有效的实例，您永远不会自己实际创建其中一个。相反，您将使用[CMMotionManager](http://developer.apple.com/library/ios/#documentation/CoreMotion/Reference/CMMotionManager_Class/Reference/Reference.html)类的`accelerometerData`属性来获取指向有效对象的指针：

```
// Sometime earlier...
CMMotionManager* manager = [[CMMotionManager alloc] init];
[manager startAccelerometerUpdates];

// Sometime in the present...
// Get a ref to the most recent accelerometer data.
CMAccelerometerData* data = [manager accelerometerData];

// Access it.
double x = [data acceleration].x; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T20:29:41.997

您可以访问只读属性

```
myAccelerometer.acceleration 
```

这将返回三个双精度的结构

```
myAccelerometer.acceleration.y (gives the y at that specific moment the call is being made) 
```

# android - Android menuItem 不显示，直到你点击它......？

> ID：11369192
> 
> 赞同：0
> 
> 时间：2012-07-06T20:23:57.460
> 
> 标签：android, menu, menuitem

我相信对于大多数有经验的 Android 开发人员来说，我的问题很简单，但我无法弄清楚。

我正在尝试在 menuItem 中设置名称并使文本变为白色。

仅当我单击 menuItem 时，文本才会显示，或者更确切地说，当我单击 menuItem 时，文本变为白色并且可读。

任何有用的帮助如何使文本在 menuItem 中始终保持白色和可见？

item.setTitle(this.task.getName()); 应该是白色的并且在菜单中一直可见。

```
@Override
public boolean onCreateOptionsMenu(Menu menu)
{
MenuInflater inflater = getMenuInflater();
inflater.inflate( R.menu.show_task_feedback_menu, menu );
return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item)
{
switch ( item.getItemId() )
{
  case R.id.show_task_feedback_menu_add_feedback:  
    item.setTitle(this.task.getName()); <------------- Here is the problem!!!!!!!!!!
    this.startTaskFeedback();
    return true;
  default: return true;
}
} 
```

XML：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

<item
android:id="@+id/show_task_feedback_menu_add_feedback"
>
</item>

</menu> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T20:34:21.527

我想我理解你的问题，在我看来你只需要将以下行添加到你的 xml 中：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

    <item
        android:id="@+id/show_task_feedback_menu_add_feedback"
        android:showAsAction="ifRoom|withText"> <!-- this line -->
    </item>

</menu> 
```

不确定我是否理解您要将哪个文本设置为白色...

# javascript - 在 wordpress 上寻找 Nivo Slider 的照片

> ID：11369197
> 
> 赞同：0
> 
> 时间：2012-07-06T20:24:24.530
> 
> 标签：javascript, wordpress, html

我正在寻找一种在 Wordpress 上使用页面指示器制作照片库的简单方法。我找到了 WP Nivo Slider [http://wordpress.org/extend/plugins/wp-nivo-slider/screenshots/](http://wordpress.org/extend/plugins/wp-nivo-slider/screenshots/)，但它在可以做什么以及何时可以使用方面非常严格。

理想情况下，我只想在 HTML 中包含一堆图像，并让一些滑块自动拾取标签并将它们组合成一个......任何简单但灵活的 API 都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:44:06.010

我使用 riva slider pro (http://rivaslider.com/)，它是一个付费插件，但效果非常好，而且非常容易使用。您可以选择是否要输出缩略图、图标或小指示点作为页面指示符。它在包中带有主题，但您可以在管理员中为每个滑块覆盖 CSS。

唯一的缺点；它没有响应。我已经编辑了我的以使其具有响应性，但它​​的高度和宽度是固定的，开箱即用 - 这有点烦人。

要使用它，您只需设置幻灯片，然后使用简码将其嵌入到您的帖子/页面中 - 听起来就像您正在寻找的那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T20:47:15.317

我没有看过 Nivo Slider Wordpress 插件和它的限制，但独立的 Nivo Slider 可以在 Wordpress 安装中轻松使用，并为您提供很大的灵活性。我不确定您所说的页面指示器是什么意思，但您可以根据需要从页面/帖子中提取信息。举个例子，下面是我用来创建图像滑块的一些代码，它使用自定义查询将精选图像从特定类别的帖子中拉出。

```
 <!-- Slideshow -->
        <div id="nivowrapper">
          <div id="nivoslider">
            <?php 
            $featured_slide = new WP_Query('cat=4&showposts=-1');
            while ($featured_slide->have_posts()) : $featured_slide->the_post();
              ?>
               <?php 

                if (function_exists('has_post_thumbnail') && has_post_thumbnail()) {
                    $img_height = 293;
                    $img_width  = 960;

                    slider_image(thumb_url(),$img_width,$img_height);

                }
              ?>
            <?php endwhile; ?>
            <?php wp_reset_query(); ?>
          </div>
        </div>
    <!-- Slideshow End --> 
```

这使用了我的 functions.php 中的方法 slider_image() 以及方法 thumb_url() - 这样做的原因是它使用 timthumb 来确保如果客户端上传大小不正确的图像，整个事情不会向南到特色帖子类别。

在functions.php中

```
 # This function returns the attached Featured image in the page / post
 function thumb_url(){  
   $thumb_src = wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), array( 960,960 ));
   return $thumb_src[0];
 }

# This function resizes the featured image to the requested proportions via timthumb. 
function slider_image($image_source,$width,$height) {
  global $post;

  echo '<img src="'.get_bloginfo('template_directory').'/timthumb.php?src='.$image_source.'&amp;h='.$height.'&amp;w='.$width.'&amp;zc=1" alt="" title="'.get_the_title().'" />';
} 
```

我有点离开了 Nivo Slider，因为在 Firefox 中字幕消失的问题从未得到解决。你看过[Flexslider 2](http://flex.madebymufffin.com/examples/basic.html)吗？我认为它在技术上仍处于测试阶段，但它很棒并且高度可配置。我刚刚在一个网站上使用过它，它很棒（尤其是你可以使用手指滑动在平板电脑和智能手机上滚动）。

希望这个对你有帮助。

编辑

我意识到我应该为读过这篇文章但没有单独使用过 Nivo Slider 的任何人添加最后一点。您需要初始化 Nivo Slider。包括 Nivo Slider Javascript 文件（将其放入您的 functions.php 中）和 CSS 并将以下代码放在头部或结束 body 标记之前。您可以根据需要更改参数；

```
 <script type="text/javascript">
    jQuery(window).load(function($) {

      jQuery('#nivoslider').nivoSlider({
        effect:'fade',
        slices:15,
        animSpeed:700, 
        pauseTime:7000,
        controlNav: false,
        directionNav: true,
        directionNavHide: false,
        captionOpacity: 1
      });

    });
    </script> 
```

# java - 我想比较数据库中是否存在用户名

> ID：11369199
> 
> 赞同：1
> 
> 时间：2012-07-06T20:24:26.680
> 
> 标签：java, android, database, sqliteopenhelper

我想从数据库中获取数据并将其与一些输入的文本进行比较，即想检查用户名是否已经存在于数据库中。

这是我的 DBHelper 代码。

```
public Boolean checkusername(String name) throws SQLException {

    Cursor mCursor =
            db.query(true,Login_Table, new String[] { KEY_ROWID, KEY_USERNAME,KEY_STATUS }, KEY_USERNAME

                    + "=" + "'" + name + "'", null, null, null, null, null);

    if (mCursor.moveToFirst()) {

        return true;

    }

    return false; 
```

}

进行比较的代码

```
public class Registration extends Activity implements OnClickListener, OnItemSelectedListener

{
 // Variable Declaration should be in onCreate()
 private Button mSubmit;
 private Button mCancel;

 private EditText mFname;
 private EditText mLname;
 private EditText mUsername;
 private EditText mPassword;
 private EditText mEmail;
 private Spinner mGender;
 private String Gen;
 boolean check; 
```

> 私有 DBHelper DB = new DBHelper(Registration.this);

```
 @Override
 protected void onCreate(Bundle savedInstanceState) {

  super.onCreate(savedInstanceState);
  setContentView(R.layout.register);

  //Assignment of UI fields to the variables
  mSubmit = (Button)findViewById(R.id.submit);
  mSubmit.setOnClickListener(this);

  mCancel = (Button)findViewById(R.id.cancel);
  mCancel.setOnClickListener(this);

  mFname = (EditText)findViewById(R.id.efname);
  mLname = (EditText)findViewById(R.id.elname);

  mUsername = (EditText)findViewById(R.id.reuname);
  mPassword = (EditText)findViewById(R.id.repass);
  mEmail = (EditText)findViewById(R.id.eemail);

  mGender = (Spinner)findViewById(R.id.spinner1);

  // Spinner method to read the on selected value
  ArrayAdapter<State> spinnerArrayAdapter = new ArrayAdapter<State>(this,
               android.R.layout.simple_spinner_item, new State[] { 
            new State("Male"), 
            new State("Female")});
  mGender.setAdapter(spinnerArrayAdapter);
  mGender.setOnItemSelectedListener(this); 

 }

 public static boolean isvalidEmail(String email) {
        boolean isValid = false;

        String expression = "^[\\w\\.-]+@([\\w\\-]+\\.)+[A-Z]{2,4}$";
        CharSequence inputStr = email;

        Pattern pattern = Pattern.compile(expression, Pattern.CASE_INSENSITIVE);
        Matcher matcher = pattern.matcher(inputStr);
        if (matcher.matches()) {
            isValid = true;
        }
        return isValid;
    }

 public void onClick(View v) 
 {

  switch(v.getId()){

  case R.id.cancel:
   Intent i = new Intent(getBaseContext(), Home.class);
   startActivity(i);
   //finish();
   break;

  case R.id.submit:

   String fname = mFname.getText().toString();
   String lname = mLname.getText().toString();

   String uname = mUsername.getText().toString();
   String pass = mPassword.getText().toString();
   String email = mEmail.getText().toString();
   String status="s";

   boolean invalid = false;
  boolean checkEmail=isvalidEmail(email);

   if(fname.equals(""))
   {
    invalid = true;
    Toast.makeText(getApplicationContext(), "Enter your Firstname", Toast.LENGTH_SHORT).show();
   }
   else
       if(fname.matches("[0-9]+" ))
               {
           invalid = true;
            Toast.makeText(getApplicationContext(), "Enter valid name", Toast.LENGTH_SHORT).show();

               }
   else
       if (fname.matches(".*\\s+.*"))
       {
           invalid = true;
            Toast.makeText(getApplicationContext(), "Spaces are not allowed in Firstname", Toast.LENGTH_SHORT).show();
       }
   else

   if(lname.equals(""))
   {
    invalid = true;
    Toast.makeText(getApplicationContext(), "Please enter your Lastname", Toast.LENGTH_SHORT).show();
   }
   else
       if (fname.matches(".*\\s+.*"))
       {
           invalid = true;
            Toast.makeText(getApplicationContext(), "Spaces are not allowed in Lastname", Toast.LENGTH_SHORT).show();
       }
   else

    if(uname.equals(""))
    {
     invalid = true;
     Toast.makeText(getApplicationContext(), "Please enter your Username", Toast.LENGTH_SHORT).show();
    }
    else
           if (uname.matches(".*\\s+.*"))
           {
               invalid = true;
                Toast.makeText(getApplicationContext(), "Spaces are not allowed in Username", Toast.LENGTH_SHORT).show();
           }
    else

      if(pass.equals(""))
     {
      invalid = true;
      Toast.makeText(getApplicationContext(), "Please enter your Password", Toast.LENGTH_SHORT).show();

   }
      else
       if (pass.matches(".*\\s+.*"))
       {
           invalid = true;
            Toast.makeText(getApplicationContext(), "Spaces are not allowed in Password", Toast.LENGTH_SHORT).show();
       }
     else 
      if(email.equals(""))
   {
    invalid = true;
    Toast.makeText(getApplicationContext(), "Please enter your Email ID", Toast.LENGTH_SHORT).show();
   }
      else if(checkEmail==false)
      {
            invalid = true;
            Toast.makeText(getApplicationContext(), "Please enter valid Email ID", Toast.LENGTH_SHORT).show();
      }
      else 
```

> DB.open();
> 
> ```
>  if (DB.checkusername(uname)) {
> 
>       invalid = true;
>       Toast.makeText(getApplicationContext(), "username alredy in use enter another", Toast.LENGTH_SHORT).show();
> 
>   } 
> ```

```
 else
      if(invalid == false)
      {
       addEntry(fname, lname, Gen, uname, pass, email);
       login( uname, pass, status);
       Intent i_register = new Intent(Registration.this, Login.class);
       startActivity(i_register);
       //finish();
      }

      break;
      }

    }

 public void onDestroy()
 {
  super.onDestroy();
  DB.close();
 }

private void login(String username,String password,String status)
{

      SQLiteDatabase db = DB.getWritableDatabase();
      ContentValues values = new ContentValues();
      values.put("username", username); 
      values.put("password", password);
      values.put("status", status);
      try
      {
       db.insert(DBHelper.Login_Table, null, values);
      }
      catch(Exception e)
      {
       e.printStackTrace();
      }
}

 private void addEntry(String fname, String lname, String Gen, String uname, String pass, String email) 
 {

  SQLiteDatabase db = DB.getWritableDatabase();

  ContentValues values = new ContentValues();
  values.put("firstname", fname);
  values.put("lastname", lname);
  values.put("gender", Gen);
  values.put("username", uname);
  values.put("password", pass);
  values.put("email", email);

  try
  {
   db.insert(DBHelper.DATABASE_TABLE_NAME, null, values);

   Toast.makeText(getApplicationContext(), "your details submitted Successfully...", Toast.LENGTH_SHORT).show();
  }
  catch(Exception e)
  {
   e.printStackTrace();
  }
 }

} 
```

这是错误日志猫

```
07-07 02:02:48.623: E/AndroidRuntime(8297): FATAL EXCEPTION: main
07-07 02:02:48.623: E/AndroidRuntime(8297): java.lang.NullPointerException
07-07 02:02:48.623: E/AndroidRuntime(8297):     at com.google.data.DBHelper.checkusername(DBHelper.java:164)
07-07 02:02:48.623: E/AndroidRuntime(8297):     at com.google.data.Registration.onClick(Registration.java:209)
07-07 02:02:48.623: E/AndroidRuntime(8297):     at android.view.View.performClick(View.java:2408)
07-07 02:02:48.623: E/AndroidRuntime(8297):     at android.view.View$PerformClick.run(View.java:8816)
07-07 02:02:48.623: E/AndroidRuntime(8297):     at android.os.Handler.handleCallback(Handler.java:587)
07-07 02:02:48.623: E/AndroidRuntime(8297):     at android.os.Handler.dispatchMessage(Handler.java:92)
07-07 02:02:48.623: E/AndroidRuntime(8297):     at android.os.Looper.loop(Looper.java:123)
07-07 02:02:48.623: E/AndroidRuntime(8297):     at android.app.ActivityThread.main(ActivityThread.java:4627)
07-07 02:02:48.623: E/AndroidRuntime(8297):     at java.lang.reflect.Method.invokeNative(Native Method)
07-07 02:02:48.623: E/AndroidRuntime(8297):     at java.lang.reflect.Method.invoke(Method.java:521)
07-07 02:02:48.623: E/AndroidRuntime(8297):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
07-07 02:02:48.623: E/AndroidRuntime(8297):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
07-07 02:02:48.623: E/AndroidRuntime(8297):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T20:28:11.127

似乎没有`open`您正在执行的数据库`query`。在执行任何操作之前，您需要先打开数据库。

例子： `db.open()`

# javascript - 如何确保在 HREF 触发之前下载并显示图像？

> ID：11369216
> 
> 赞同：0
> 
> 时间：2012-07-06T20:25:38.427
> 
> 标签：javascript, jquery, dom, joomla

我有这个代码：

```
function Imagehover(obj,img){               
    jQuery("#"+obj.id).attr("src","<?php echo $this->baseurl ?>/templates/codecraft.gr/images/"+img+".png");            
}
function Imageclick(obj,img){                               
    jQuery("#"+obj.id).attr("src","<?php echo $this->baseurl ?>/templates/codecraft.gr/images/"+img+".png");        
}
function Imageout(obj,img){                                                                     
    jQuery("#"+obj.id).attr("src","<?php echo $this->baseurl ?>/templates/codecraft.gr/images/"+img+".png");                                
}

<a href="<?php echo JURI::root(); ?><?php echo $langsefs->sef;?>"><img id="<?php echo $langsefs->sef;?>flag" style="height: 40px;margin-right: 10px;width: 47px;" src="<?php echo JURI::root(); ?>/templates/codecraft.gr/images/<?php echo $langsefs->sef; ?>_flag.png" onclick="Imageclick(this,'<?php echo $langsefs->sef; ?>_flag_pressed')" onmouseout="Imageout(this,'<?php echo $langsefs->sef; ?>_flag')" onmouseover="Imagehover(this,'<?php echo $langsefs->sef; ?>_flag_over')" alt="<?php echo $langsefs->sef; ?>"/></a> 
```

但是，当我单击标志时，图像消失，然后 href 的重定向执行到新页面。当我删除图像的 onclick 事件时

```
function Imageclick(obj,img){                               
    //jQuery("#"+obj.id).attr("src","<?php echo $this->baseurl ?>/templates/codecraft.gr/images/"+img+".png");      
} 
```

图像不会消失。所以我认为 onclick 事件触发并尝试从服务器获取图像，但是由于 href 也被执行，图像没有机会进入用户的浏览器，因为页面重定向已经开始。

如何确保图像下载到用户的浏览器然后进行重定向，而不需要删除 href 属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:33:10.920

你可以使用`event.preventDefault()`：

> 如果调用该方法，则不会触发事件的默认动作。

```
$('a').click(function(e){
   e.preventDefault();
   var href = $(this).attr('href');
   $("#"+obj.id).attr("src","<?php echo $this->baseurl ?>/templates/codecraft.gr/images/"+img+".png").promise().done(function(){
      window.location = href;
   })        
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T20:32:45.390

从事件处理程序返回 false 以防止默认行为。如果您希望页面地址在之后立即更改，则可能需要在替换图像后在每个处理程序中放置位置重定向。

# javascript - 从 Ajax-JSON 中提取元素

> ID：11369217
> 
> 赞同：0
> 
> 时间：2012-07-06T20:25:52.770
> 
> 标签：javascript, ajax, json, object

我精通 PHP，但我是 AJAX 的初学者，而 JSON 让我发疯。

我的 PHP 脚本提供了一个简单的 JSON 字符串，例如

```
 {"bindings": [ {"ircEvent": "PRIVMSG", "method": "newURI", "regex": "^http://.*"},
    {"ircEvent": "PRIVMSG", "method": "deleteURI", "regex": "^delete.*"}, 
    {"ircEvent": "PRIVMSG", "method": "randomURI", "regex": "^random.*"} ] } I 
```

检索它如下：

```
var fillDataMasterTable = $.ajax({          
    url: "/php/PrepareGoogleDataTable.php" +"?"+
                "SensorString="+SensorString + "&"+
                "TableType=" + TableType +"&"+
                "NoAbscissaBins=" + NoAbscissaBins + "&"+
                "DataTableName=" + DataTableName +"&"+
                "TimeUnit=" + TimeUnit +"&"+
                "TimeStart=" + TimeStart,          
    dataType:'json',          
    async: false          
    }).responseText;    

 $('#debug_div').html(fillDataMasterTable); 
```

这很好，我得到了我的 JSON 字符串。但是我怎样才能访问各个值呢？我试过：

```
 $('#debug_div').html(fillDataMasterTable.bindings); 
```

但这行不通。我当然在这里做了一些非常愚蠢的事情，我有点羞愧 - 但我确实需要一些帮助才能让自己开始......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T20:30:10.810

`reponseText`是对象的属性，请求后`XMLHttpRequest`它不会是对象。它将是一个。并且它不会改变，无论您指定为。`JSON``String``"dataType"``"json"`

所以你需要将其转换为 json 对象：

```
 fillDataMasterTable = JSON.parse(fillDataMasterTable); 
```

然后你可以访问这样的属性：

```
 fillDataMasterTable.bindings 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T20:30:04.173

像这样使用 Jquery：

```
$.each(fillDataMasterTable.bindings, function(i, object) {
            $.each(object, bindings(property, value) {
                $('#debug_div').html(value);
            });
        }); 
```

# permissions - CRM 2011 OnPremise - 注释/注释的权限

> ID：11369220
> 
> 赞同：6
> 
> 时间：2012-07-06T20:26:00.703
> 
> 标签：permissions, dynamics-crm, dynamics-crm-2011

对联系人/帐户的注释/注释有一个看似矛盾的问题。

这是我们定义的自定义角色的 Note 实体的权限：

![在此处输入图像描述](../Images/9704fde4c64c1a38736e8b00de84fcd8.png)

概括：

*   个人创作
*   组织阅读
*   个人写
*   无删除
*   BU追加
*   BU 追加到
*   BU分配
*   无共享

我转到帐户屏幕，正如预期的那样，我**无法**修改其他用户的注释。

我转到联系人屏幕，我**可以**修改另一个用户的注释。

我缺少权限的某些方面吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T16:26:32.203

此角色中联系人和帐户的“附加到”权限是什么？由于您尝试将注释附加到联系人和帐户...

否则说：注释的“附加”权限与您想要添加注释的实体的“附加到”权限密切相关，例如联系人或帐户。

# tsql - 识别表数据检索自

> ID：11369222
> 
> 赞同：0
> 
> 时间：2012-07-06T20:26:01.877
> 
> 标签：tsql, union, inner-join

我有一个典型的问题。

我需要修改下面的 T SQL 查询。目前它只在一张表中查找信息。我需要查看两个具有相同列的表以获取信息。一张表包含当前员工，一张包含前员工

```
SELECT t.net_Id
      ,e.fname
      ,e.lname
FROM tblTrackingEmployee t
    join view_employee e 
        on e.net_id = t.net_id
where trackingid = @trackingId
and empType = @empType 
```

我想做的是使用联合来查看两者。员工要么出现在一个表中，要么出现在另一个表中，它永远不会出现在两个表中。

```
SELECT t.net_Id
      ,e.fname
      ,e.lname
FROM tblTrackingEmployee t
    JOIN view_employee e
        ON e.net_id = t.net_id
WHERE trackingid = @trackingId
AND empType = @empType
union 
SELECT t.net_Id
      ,fe.fname
      ,fe.lname
FROM tblTrackingEmployee t
      JOIN view_employee fe 
             ON fe.net_id = t.net_id
WHERE trackingid = @trackingId
AND empType = @empType 
```

然而，这是一个转折点，我需要知道返回的人是现任还是前任员工。有没有办法在返回的表中添加一列，如果它是当前员工，则为 1，如果是前员工，则为 0？每个 trackingId 都可能包含两种类型的员工。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:28:51.983

为每个子句添加一个常量列`SELECT`- 您可以给它起别名：

```
SELECT t.net_Id
      ,e.fname
      ,e.lname
      ,'Current' AS Type
FROM tblTrackingEmployee t
    JOIN view_employee e
        ON e.net_id = t.net_id
WHERE trackingid = @trackingId
AND empType = @empType
union 
SELECT t.net_Id
      ,fe.fname
      ,fe.lname
      ,'Former'
FROM tblTrackingEmployee t
      JOIN view_formerEmployee fe 
             ON fe.net_id = t.net_id
WHERE trackingid = @trackingId
AND empType = @empType 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T20:30:37.357

让我直截了当地说，你有两张表，一张有现任员工，一张有前任员工？这是一个坏主意，您本来可以拥有一个状态为（“活动”/“非活动”）的表。无论如何，只需`int`为每个查询添加一个字段，例如

```
SELECT
 0 AS TheField,
  ....
FROM
  Table
UNION ALL
SELECT
1 AS TheField,
 ...
FROM
  table 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T20:31:08.630

如果您愿意，还可以按状态排序：

```
 SELECT U.* FROM
 (
  SELECT t.net_Id AS ID
      ,e.fname AS FName
      ,e.lname AS LName
      ,'Current' AS EmployStatus
  FROM tblTrackingEmployee t
      JOIN view_employee e
          ON e.net_id = t.net_id
  WHERE trackingid = @trackingId
  AND empType = @empType
  union 
  SELECT t.net_Id AS ID
      ,fe.fname AS FName
      ,fe.lname AS LName
      ,'Former' AS EmployStatus
  FROM tblTrackingEmployee t
        JOIN view_formerEmployee fe
               ON fe.net_id = t.net_id
  WHERE trackingid = @trackingId
    AND empType = @empType
) AS U
 ORDER BY U.EmployStatus 
```

# android - AlarmManager 多个警报

> ID：11369230
> 
> 赞同：0
> 
> 时间：2012-07-06T20:26:35.043
> 
> 标签：android, android-intent

只是一个快速的问题。

我知道如何通过为每个警报分配一个唯一的 id 来设置多个警报，但是如果用户想在周一、周三和周五的上午 9 点、下午 12 点、下午 3 点和晚上 7 点设置警报，这是否意味着我必须设置 12 个警报?

从那以后，如果他们想在一周中的 6 天设置相同的时间，那是 24 个警报，而如果是整周，那将只有 4 个警报？

谢谢

戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:05:15.583

`AlarmManager`只有基本的API。因此，您可以`setRepeating`在上午 9 点、下午 12 点、下午 3 点、晚上 7 点使用，然后在特定日期忽略警报。

# android - TYPE_SYSTEM_OVERLAY 检测 ICS 中的触摸

> ID：11369233
> 
> 赞同：1
> 
> 时间：2012-07-06T20:26:45.713
> 
> 标签：android, touch, overlay, android-4.0-ice-cream-sandwich

我一直在使用 FLAG_WATCH_OUTSIDE_TOUCH 从蜂窝中的系统覆盖中获取触摸，但这在 ICS 中不再有效。我也需要下面的应用程序来接收触摸，所以 TYPE_SYSTEM_ALERT 不起作用。该应用程序不会放在 Play 商店中，因此如果它需要 root 或放在系统目录中才能工作，则可以。有任何想法吗？

谢谢，ng93

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:01:31.937

似乎情况就是如此，因为这篇[文章强调了](https://stackoverflow.com/questions/9656185/type-system-overlay-in-ics/9656233#9656233). 这通常是一个坏主意，请参阅[文档](http://developer.android.com/reference/android/view/WindowManager.LayoutParams.html#TYPE_SYSTEM_OVERLAY)：

> 这些窗口不能成为输入焦点，否则它们会干扰键盘保护。

我实际上还没有在 Android 4.0 ICS 上测试过这些叠加层，但[SwipePad](https://play.google.com/store/apps/details?id=mobi.conduction.swipepad.android)等其他应用程序似乎可以做到这一点。我知道的唯一问题是与性能有关，这样的覆盖通常会对设备造成严重影响。如果您想准确检测触摸输入并且覆盖层不必位于锁定屏幕上方，请尝试 TYPE_SYSTEM_ALERT。[SO上的](https://stackoverflow.com/questions/10097145/type-system-overlay-in-android-4-ics)另一篇文章似乎也选择了这种类型。

# ruby - Ruby HTTP 库通过 Facebook 应用程序重置连接

> ID：11369234
> 
> 赞同：2
> 
> 时间：2012-07-06T20:26:46.303
> 
> 标签：ruby, facebook, http

以下 curl 命令按预期工作：
`curl 'https://graph.facebook.com/oauth/access_token?grant_type=client_credentials&client_id=myappid&client_secret=myclientsecret'`

我想在我的 Ruby 程序中做同样的事情。以下代码给了我一个错误：

```
fb_access_token_url = URI.parse(                                             
    'https://graph.facebook.com/oauth/access_token' +                        
    '?grant_type=client_credentials' +                                       
    '&client_id=' + FACEBOOK_APP_ID +                                        
    '&client_secret=' + FACEBOOK_APP_SECRET)                                 
fb_access_token = Net::HTTP.get(fb_access_token_url) 
```

这段代码也是如此：

```
fb_access_token_host = 'graph.facebook.com'                                  
fb_access_token_path_and_params = (                                          
    '/oauth/access_token' +                                                  
    '?grant_type=client_credentials' +                                       
    '&client_id=' + FACEBOOK_APP_ID +                                        
    '&client_secret=' + FACEBOOK_APP_SECRET)                                 
https_port = Net::HTTP.https_default_port()                                  

fb_access_token = Net::HTTP.get_response(fb_access_token_host,               
                                         fb_access_token_path_and_params,       
                                         https_port) 
```

错误如下：

```
Errno::ECONNRESET: Connection reset by peer
/usr/lib/ruby/1.8/net/protocol.rb:135:in `sysread'
/usr/lib/ruby/1.8/net/protocol.rb:135:in `rbuf_fill'
/usr/lib/ruby/1.8/timeout.rb:67:in `timeout'
/usr/lib/ruby/1.8/timeout.rb:101:in `timeout'
/usr/lib/ruby/1.8/net/protocol.rb:134:in `rbuf_fill'
/usr/lib/ruby/1.8/net/protocol.rb:116:in `readuntil'
/usr/lib/ruby/1.8/net/protocol.rb:126:in `readline'
/usr/lib/ruby/1.8/net/http.rb:2028:in `read_status_line'
/usr/lib/ruby/1.8/net/http.rb:2017:in `read_new'
/usr/lib/ruby/1.8/net/http.rb:1051:in `request'
/usr/lib/ruby/1.8/net/http.rb:948:in `request_get'
/usr/lib/ruby/1.8/net/http.rb:380:in `get_response'
/usr/lib/ruby/1.8/net/http.rb:543:in `start'
/usr/lib/ruby/1.8/net/http.rb:379:in `get_response'
/usr/lib/ruby/1.8/net/http.rb:356:in `get'
./test-login-and-registration.rb:182:in `test_facebook_register' 
```

我在 Ubuntu 12.04 上使用 Ruby 1.8.7

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T15:19:29.313

感谢 Manoj Awasthi 让我意识到有些 ssl 方法我无法使用。

问题是我需要的是 net/http 而不是 net/https。

工作片段：

```
fb_access_token_url = URI.parse(                                             
    'https://graph.facebook.com/oauth/access_token' +                        
    '?grant_type=client_credentials' +                                       
    '&client_id=' + FACEBOOK_APP_ID +                                        
    '&client_secret=' + FACEBOOK_APP_SECRET)                                 
https = Net::HTTP.new(fb_access_token_url.host, fb_access_token_url.port)    
https.use_ssl = true                                                         
https.verify_mode = OpenSSL::SSL::VERIFY_NONE                                
fb_access_token = https.request_get(fb_access_token_url.path + '?' +         
                                    fb_access_token_url.query) 
```

# hadoop - 为什么向 mapreduce 提交作业通常需要这么多时间？

> ID：11369235
> 
> 赞同：7
> 
> 时间：2012-07-06T20:26:54.637
> 
> 标签：hadoop, mapreduce

所以通常20个节点的集群提交作业处理3GB（200个分割）的数据大约需要30秒，实际执行大约需要1m。我想了解作业提交过程中的瓶颈是什么并了解下一个报价

> 每个 MapReduce 开销很大：启动/结束 MapReduce 作业需要时间

我知道的一些过程： 1\. 数据拆分 2\. jar 文件共享

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-06T21:00:36.967

关于 HDFS 和 M/R 的一些了解有助于理解这种延迟的事情：

1.  HDFS 将您的文件存储为分布在称为数据节点的多台机器上的数据块
2.  M/R 在每个数据块或块上运行多个称为映射器的程序。这些映射器的 (key,value) 输出由 reducer 编译为结果。（考虑将多个映射器的各种结果相加）
3.  每个 mapper 和 reducer 都是在这些分布式系统上生成的完整程序。生成一个完整的程序确实需要时间，即使我们说它们什么也没做（No-OP map reduce 程序）。
4.  当要处理的数据变得非常大时，这些生成时间变得微不足道，这就是 Hadoop 大放异彩的时候。

如果您要处理内容为 1000 行的文件，那么您最好使用普通的文件读取和处理程序。在分布式系统上生成进程的 Hadoop 基础架构不会产生任何好处，只会增加定位包含相关数据块的数据节点、启动其上的处理程序、跟踪和收集结果的额外开销。

现在将其扩展到 100 Peta 字节的数据，与处理它们所需的时间相比，这些开销看起来完全微不足道。处理器（映射器和减速器）的并行化将在这里显示出它的优势。

因此，在分析 M/R 的性能之前，您应该首先查看对集群进行基准测试，以便更好地了解开销。

在集群上做一个无操作的 map-reduce 程序需要多少时间？

**为此目的**使用 MRBench ：****

 **1.  MRbench 多次循环一个小作业
2.  检查小型作业运行是否响应并在您的集群上高效运行。
3.  它对HDFS层的影响非常有限

要运行此程序，请尝试以下操作（检查最新版本的正确方法：

```
hadoop jar /usr/lib/hadoop-0.20/hadoop-test.jar mrbench -numRuns 50 
```

令人惊讶的是，在我们的一个开发集群上，它是 22 秒。

**另一个问题是文件大小。**

如果文件大小小于 HDFS 块大小，则 Map/Reduce 程序的开销很大。Hadoop 通常会尝试为每个块生成一个映射器。这意味着如果你有 30 个 5KB 的文件，那么即使文件很小，Hadoop 最终也可能最终为每个块生成 30 个映射器。这是一种真正的浪费，因为与处理小文件所花费的时间相比，每个程序的开销都很大。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-07T09:56:23.157

据我所知，没有一个瓶颈会导致作业运行延迟；如果有，早就解决了。

有许多步骤需要时间，而且过程缓慢是有原因的。我将尝试列出它们并估计我可以：

1.  运行 hadoop 客户端。它正在运行 Java，我认为可以假设 1 秒的开销。
2.  将作业放入队列并让当前调度程序运行作业。我不确定什么是开销，但是由于进程的异步性质，应该存在一些延迟。
3.  计算分裂。
4.  运行和同步任务。在这里，我们面临的事实是 TaskTrackes 轮询 JobTracker，而不是相反。我认为这样做是为了可扩展性。这意味着当JobTracker要执行某个任务时，它不会调用task tracker，而是等待相应的tracker ping它来获取任务。任务跟踪器不能频繁 ping JobTracker，否则会在大集群中杀死它。
5.  运行任务。如果没有 JVM 重用，大约需要 3 秒，每个任务的开销约为 1 秒。
6.  客户端轮询作业跟踪器以获取结果（至少我是这么认为的），并且它还为获取作业完成的信息增加了一些延迟。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-01T01:53:27.773

我已经看到了类似的问题，我可以在以下步骤中说明要破解的解决方案：

1.  当 HDFS 存储了太多固定块大小的小文件时，HDFS 的效率就会出现问题，最好的方法是删除所有不必要的文件和有数据的小文件。再试一次。
2.  尝试使用数据节点和名称节点：

    *   使用 stop-all.sh 停止所有服务。
    *   格式名称节点
    *   重启机器
    *   使用 start-all.sh 启动所有服务
    *   检查数据和名称节点。
3.  尝试安装低版本的 hadoop (hadoop 2.5.2)，它在两种情况下都有效，并且在命中和试验中都有效。**

# mysql - MySQL搜索最接近的小于数值

> ID：11369238
> 
> 赞同：1
> 
> 时间：2012-07-06T20:27:06.600
> 
> 标签：mysql

我是 SQL 新手，我似乎无法在其他任何地方找到答案。我正在做一个项目，该项目需要我在两个不同的网格之间进行转换，这在 Excel 中相当简单。我有 2 个这些表格的表格（填写前几行以供参考）：

```
JDAY   TL1   TL2   TL3
1.5    148.2 147.3 146.4
2.5     150.2 150.1 150.0
3.5    151.1 150.7 150.3

Layer  Elevation
2      150.9
3      149.9
4      148.9
5      147.9
6      146.9
7      145.9 
```

在表 1 中，TL1、TL2、TL3 下的值是与表 2 中的高程列相对应的高程。我想输出这样的视图：

```
JDAY   TL1   TL2   TL3
1.5    5     6     7
2.5    3     3     3
3.5    2     3     3 
```

我需要为 Table1 中的每个值在 Table2 中搜索最接近的小于高程，并输出相应的图层编号。我不确定如何执行此操作，因为海拔不完全匹配。这在 Excel 中使用 vlookup() 函数效果很好。另一件需要注意的是，这只是一小部分数据……实际上有 15 个 TL 列和 365 个 JDAY 值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:37:01.927

这会很丑陋，但这样的事情可能会做：

```
SELECT JDAY, MAX(TL1) AS tl1, MAX(TL2) AS tl2, ...
FROM (
    SELECT JDAY, othertable.Layer AS TL1, othertable.Layer AS TL2, etc...
    FROM maintable
    INNER JOIN othertable AS tl1 ON maintable.TL1 < othertable.TL1
    INNER JOIN othertable AS tl2 ON maintable.TL2 < othertable.TL2
    etc...
) AS subquery 
```

基本上，内部查询获取所有连接记录，其中其他表的高度低于主表的高度。然后另一个查询选择每个字段的 MAX()，这应该是您要查找的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T20:43:34.497

鉴于涉及的行数较少，以下可能有效：

```
SELECT A.JDAY,
       (select max(layer) from table2 where elevation<=A.tl1) as tl1,
       (select max(layer) from table2 where elevation<=A.tl2) as tl2,
       (select max(layer) from table2 where elevation<=A.tl3) as tl3,
       ...
FROM table1 AS A 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T20:48:20.013

首先，您的 table1 可能应该被标准化一点：

```
create table measurements (
  jday date not null,
  measure varchar(5) not null,
  value decimal(6,2) not null,
  primary key (jday, measure)
); 
```

因此，您的数据集将表示为：

```
jday       measure value
2012-05-01 TL1      148.2
2012-05-01 TL2      147.3
2012-05-01 TL3      146.4
... 
```

（我假设您的 JDAY 列包含一个日期？）

现在，对于您的问题，由于您使用的是 MySql，因此您可以结合 orderby、group by 和 subselects 来获得您想要的结果。还有其他方法可以达到相同的结果，但我认为这是相当可读的：

```
select * from (
  select m.*
  from measurements m
  join layers l
  where l.elevation <= m.value
  order by l.elevation desc ) x
group by jday, measure
order by jday, measure 
```

# android - 从外部 MySQL 数据库单向同步 Android SQLite 数据库

> ID：11369239
> 
> 赞同：2
> 
> 时间：2012-07-06T20:27:06.743
> 
> 标签：android, sqlite, synchronization

我的应用程序中有一个大型本地 SQLite 数据库。我需要使用 MySQL 数据库使其保持最新状态。我正在考虑生成某种带有更改的 XML 文件，然后让客户端下载并使用它来更新本地数据库。每次更新都会创建和删除记录。有一个更好的方法吗？我该怎么办？在这一点上，我真的愿意采取任何路线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-27T03:03:17.507

这已经快一年了，但我就是这样做的，以防有人偶然发现。

- 拥有一个保存所有更改的 MySQL 数据库 - 添加更改时，将使用 Unix 时间戳生成 - 列作为“已删除”的布尔值存在

-PHP 页面将时间戳作为 URL 变量 -将该时间戳之后的所有更改返回为 .CSV

-应用程序下载 .CSV，对其进行解析并更新其本地 SQLite 数据库

就这么简单，效果很好。

# ruby - 太阳黑子：不能在文本字段上使用“order_by”？

> ID：11369244
> 
> 赞同：2
> 
> 时间：2012-07-06T20:27:28.363
> 
> 标签：ruby, solr, sunspot

如果我尝试`order_by`在文本字段上使用，我会得到：“没有配置名称标题的字段”。

在“字符串”类型的字段上工作正常。所以我最终使用了一种解决方法，例如：

```
searchable do 
  text :title

  string :title_sortable do 
    title
  end
end 
```

我们有什么理由不能`order_by`在文本字段上？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T13:31:01.107

这是由 Solr 设计的。文本字段被标记化。对标记化字段进行排序没有意义。

考虑两个不同文档中的以下两个空格标记字段。

“速射弹药”“黑熊”

当你按升序排列它们时，第一个不应该出现在第二个之前，因为它里面有“ammo”这个词。

这就是为什么应将可排序字段定义为字符串。

# html - 在 D3 中鼠标悬停时突出显示表格的列的最有效方法是什么？

> ID：11369255
> 
> 赞同：2
> 
> 时间：2012-07-06T20:28:13.323
> 
> 标签：html, d3.js

我刚开始学习D3。我正在玩从数组生成表（来自教程中的示例），我想知道在鼠标悬停时突出显示列的最佳方法是什么？下面是我的第一次尝试。

```
 var tableData = [], colCnt = 100, rowCnt = 100;
    //Generate 2d array with values
    for( var i=0; i<rowCnt; i++ ){
        tableData.push( d3.range(i*colCnt, (i*colCnt)+colCnt) )
    }

    d3.select('#viz').append('table')
            .style('border-collapse', 'collapse')
            .style('border', '2px solid black')
        .selectAll('tr')
        .data( tableData )
        .enter().append('tr')
            //Highlight the row
            .on('mouseover', function(){d3.select(this).style('background-color', 'gray');})
            .on('mouseout', function(){d3.select(this).style('background-color', 'white');})
        .selectAll('td')
        .data( function(d){ return d; } )
        .enter().append('td')
            .text(String)
            .style('border', '1px solid black')
            .style('padding', '5px')
            //Highlight the column
            .on('mouseover', function(d,i){
                //d3.select(this).style('background-color','lightgray');
                d3.select(this.parentNode.parentNode).selectAll('tr')
                    .selectAll('td')
                        .style('background-color', function(d,j){ return i==j ? 'lightgray' : null;});
            })
            .on('mouseout', function(d,i){
                //d3.select(this).style('background-color', null);
                d3.select(this.parentNode.parentNode).selectAll('tr').selectAll('td').style('background-color', null);
            }) 
```

[更新] 我尝试了 Josh 的解决方案，它比我上面的要快得多。以下是更新版本。我将表格设置为 256x256，我没有注意到任何减速，上面的解决方案有很大的延迟。

```
 d3.select('#viz').append('table')
            .style('border-collapse', 'collapse')
            .style('border', '2px solid black')
        .selectAll('tr')
        .data( tableData )
        .enter().append('tr')
            .on('mouseover', function(){d3.select(this).style('background-color', 'gray');})
            .on('mouseout', function(){d3.select(this).style('background-color', 'white');})
        .selectAll('td')
        .data( function(d){ return d; } )
        .enter().append('td')
            .text(String)
            .style('border', '1px solid black')
            .style('padding', '5px')
            .attr('class', function(d,i){ return "col_" + i; })
            .on('mouseover', function(d,i){
               d3.selectAll('td.col_' + i)
                    .style('background-color', 'lightgray');
            })
            .on('mouseout', function(d,i){
               d3.selectAll('td.col_' + i)
                    .style('background-color', null);
            }) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-08T01:15:54.513

这似乎是实现目标的合理方法，您还可以考虑为每一行赋予不同的类名，即 row1、row2 等，然后按类选择行，即：

```
.on('mouseover', function(d,i){
    d3.select(".row" + i)
        .style('background-color', 'lightgray);
}) 
```

我敢肯定，可能还有很多其他变体可以做到这一点

# visual-studio-2010 - 使用 Kinect 1.5 访问特定像素（对应于面部点）

> ID：11369256
> 
> 赞同：1
> 
> 时间：2012-07-06T20:28:13.347
> 
> 标签：visual-studio-2010, visual-c++, kinect, pixels, rgba

几周以来，我一直在研究 Kinect API 并使用新的 SDK (1.5) 进行编程，我基本上是在尝试从 Kinect 传感器流式传输的每个图像中找出眼睛的位置。然后我想获得构成眼睛的像素的 RGB 值。虽然一些变量，如 pFaceModel2DPoint 和 pPts2D（都在 Visualize.cpp 中）声称存储了 colorImage（IFTImage* 类型）中构成面部的所有 86 个点的 x、y 值，但我已经测试并重新测试了这些变量，但无法从这些变量中访问有价值的数据。

此外，即使对应于眼睛的这些 x,y 值对于给定图像是正确的，我也无法找到如何访问所需每个像素的 RGB 值。我知道宏 (FTIMAGEFORMAT_UINT8_B8G8R8A8) 来查找存储像素数据的格式，并且我知道 byte* pixel = colorImage->GetBuffer() 将为来自 Kinect 的当前图像流提供缓冲流，但是做一些事情像像素[rowNum*num_cols_per_row + colNum] = [...] 这样简单的 for 循环不会产生任何有用的东西。

我真的很沮丧和失望，因为我无法让这个工作，但我已经搜索了这么多网站和搜索引擎来解决我附近的问题，但一无所获。我多次使用 OpenCV 和 Kinect 编写了自己的代码，仅使用了 Kinect 本身，以及 SDK 中对 MultiFace 示例的修改。（上面列出的这些变量和函数来自 MultiFace 示例。）任何帮助将不胜感激。谢谢！

更新：Kinect API 不清楚，因此我提出了这个问题，但经过反复试验，我已经解决了这个问题。图像格式实际上是 RGBX（格式化为 BGRX），因此 byte* 中的元素 0-3 对应像素 0，元素 4-7 对应像素 1，等等。非常简单；我刚刚对处理图像流的不同方法感到困惑，因为在同一个头文件中有几个 GetBuffer 类型的调用。希望这对其他人有帮助！

# visual-studio-2010 - Visual Studio 2010 在文件中查找，附加结果

> ID：11369257
> 
> 赞同：1
> 
> 时间：2012-07-06T20:28:14.463
> 
> 标签：visual-studio-2010, visual-studio

有没有办法（设置或扩展？）让 Visual Studio 2010 在文件中查找功能附加搜索结果（而不是替换它们）？

我意识到您可以将结果发送到两个结果屏幕之一，但这很麻烦，并且无法通过两个结果集。

过去使用 SlickEdit，只需附加搜索结果并向上滚动就很好。

# internationalization - 使用 require.js i18n 仅加载一种语言

> ID：11369258
> 
> 赞同：7
> 
> 时间：2012-07-06T20:28:22.780
> 
> 标签：internationalization, requirejs

有没有办法使用 require.js i18n 插件只加载一种语言？

使用默认设置时，始终会加载默认语言，然后还会加载具有浏览器区域设置的语言。

我正在寻找一种解决方案，其中默认语言不会在 app.js 中编译，而是在 require.js 检查浏览器区域设置后加载。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-08T16:50:39.427

好的，我知道了。您必须在基础 i18n.js 文件中设置`root`为：`false`

```
define({
  "root": false,
  "de": true,
  "en": true
}); 
```

在这种情况下，只有上述 json 将在您的优化版本中呈现。并在加载 require.js 后决定加载哪种语言。请注意，您丢失了默认语言，您必须确保以所有语言设置所有属性。

# c# - 如何提取引号中的字符串（双引号或单引号）

> ID：11369261
> 
> 赞同：0
> 
> 时间：2012-07-06T20:28:28.220
> 
> 标签：c#, regex

**问题一：**

例如，

```
     ... "ab'cd" ...'ab"cd' ...

```

它应该分别得到`ab'cd`和`ab"cd`。可能有许多带引号的字符串。

* * *

**问题2：**

以及如何`text <td>...</td> text`从以下字符串中提取？

```
<abc>text <td>...</td> text</abc>
<xyz>text <td>...</td> text</xyz>
<def>text <td>...</td> text</def> 
```

abc, def, xyz 可以嵌套在`<td>`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:32:01.827

正则表达式：

`(?:"(?<text>[^"]*)")|(?:'(?<text>[^']*)')`

和整个片段：

```
Regex regex = new Regex(
@"(?:""(?<text>[^""]*)"")|(?:'(?<text>[^']*)')",
RegexOptions.None
); 
```

可在[我的博客](http://blog.stevekonves.com/2012/01/an-even-better-regex-tester/)上测试（需要 silverlight）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T20:35:53.610

看起来这是一个二合一的问题，对吧？

我对 1 的回答是

```
((.*)['"](.*)) 
```

然后对于＃2

```
<(abc|xyz|def)>(.*)<\/(abc|xyz|def)> 
```

美国广播公司 | xyz | def <- 想象成这样

在使用结果之前不要忘记修剪空格

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T10:01:15.183

对于**第一个**问题使用：

`("(?<content>[^"]*)")|('(?<content>[^']*)')`

**第二个**问题：

`>(?<content>\w*\s*<td>.*</td>[\w\s]*)<`

并为两者获取组命名*内容*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T05:01:47.193

我想通了 - 使用反向引用。

```
(["'])(?<q>.+?)\1 
```

# ios - 有没有办法在屏幕上显示一条短消息并让它消失？

> ID：11369267
> 
> 赞同：0
> 
> 时间：2012-07-06T20:29:01.993
> 
> 标签：ios

我希望在屏幕上显示一条短消息并让它在几秒钟后消失。有没有办法做到这一点？

我正在查看警报，但这似乎不是我需要的。

如果这有助于解释我的问题，我正在寻找的是相当于 Android 中的 toast 消息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T20:37:12.693

正常初始化 UIAlertView（`alertView`在此处调用），然后在需要的任何地方执行此操作：

```
[self performSelector:@selector(hideAlert:) withObject:alertView afterDelay:delay];

-(void)hideAlert:(UIAlertView *)alertView {
      [alertView dismissWithClickedButtonIndex:0 animated:YES];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T20:29:46.980

我建议查看这个有用的库： http: [//www.cocoacontrols.com/controls/itoast](http://www.cocoacontrols.com/controls/itoast)

# ruby-on-rails - 在运行时将模块动态包含到模型中？

> ID：11369270
> 
> 赞同：6
> 
> 时间：2012-07-06T20:29:24.400
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有一个“事务”（扩展 ActiveRecord::Base）。我有两种不同类型的交易，“购买”或“捐赠”。两者之间有足够的重叠，不需要创建两个单独的数据库表，所以我只有一个表用于带有“item_type”列的事务。

但是，购买和捐赠有不同的方法和验证，因此将它们分成两个不同的控制器和模型是有意义的。我没有创建 ActiveBase 模型（减去表格），而是尝试为每个模型使用模块。

这是购买模块的样子。

```
module Purchase
  def self.included(base)
    base.validates :amount, 
      :presence => true
  end

  def testing
    "testing"
  end
end 
```

下面是如何创建一个：（此代码在 Purchases 控制器的创建操作中）

```
@purchase = Transaction.new(params[:purchase]).extend(Purchase) 
```

我可以调用@purchase.testing 并返回“测试”。但是，该验证并未运行。

如果我在交易模型中以传统方式包含模块，并带有“包含购买”，那么它们就可以工作。

有什么想法可以让这个工作流程发生吗？我遵循了一点： http: [//paulsturgess.co.uk/articles/84-how-to-include-class-and-validation-methods-using-a-module-in-ruby-on-rails](http://paulsturgess.co.uk/articles/84-how-to-include-class-and-validation-methods-using-a-module-in-ruby-on-rails)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T21:01:42.467

如果您只想处理单表和多列，我认为首选方法是单表继承。如果您搜索单表继承，您可以[在此处](http://api.rubyonrails.org/classes/ActiveRecord/Base.html)阅读相关内容。不过，关于您的问题，关于如何包含模块，我认为您希望将模块包含在元类中，`@purchase`以便它不会包含在所有后续事务中。有点像这样（绝对可以缩短）：

```
@purchase = Transaction.new(params[:purchase])
class << @purchase
  include Purchase
end 
```

然后，您的验证应该有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T21:41:30.687

当你这样做时，你的`included`钩子不会运行`.extend(Purchase)`。你需要一个`extended`钩子。在`extended`钩子内部，您可以在新对象的特征类上调用 Rails 验证助手`Transaction`（类似于 @Adam 演示的内容）。

# c++ - 从 OpenCV 2.4.2 中的 CIF 视频中读取帧

> ID：11369271
> 
> 赞同：1
> 
> 时间：2012-07-06T20:29:27.463
> 
> 标签：c++, c, opencv

问题如下：

有一个 CIF 视频文件应该由 OpenCV 处理。不幸的是，我无法从该视频中读取帧。以下代码

```
cv::VideoCapture cap = cv::VideoCapture("foreman.cif");
if(!cap.isOpened()) {
    std::cout << "Open file error" << std::endl;
    return -1;
} 
```

`Open file error`在控制台中给出。

有没有办法使用 OpenCV 从 CIF 视频中抓取帧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:58:20.640

我不认为 openCV 可以直接读取原始 YUV 流。
您可以使用 memcoder 将其转换为 avi，无论是否压缩。
或者您可以使用常规 c/c++ 读取数据块，将它们复制到图像中并使用 cvCvtColor() 转换 YUV->BGR

# windows - for 循环不会遍历文本文件的行

> ID：11369277
> 
> 赞同：0
> 
> 时间：2012-07-06T20:29:58.080
> 
> 标签：windows, printing, batch-file, for-loop, command-prompt

我有一个 for 循环，它应该打印文本文件的每一行。相反，它正在打印`logPath`.
这是代码：

```
 set enabledelayedexpansion

  for %%G in (C:\ExecutionSDKTest_10.2.2\*.properties) DO (
      Set fileName=%%~nxG
       ...
     set logPath="C:/ExecutionSDKTest_10.2.2/Logs/!fileName!.log"
       ...         
        For /f "tokens=*" %%B in (!logPath!) Do (
      echo Inside the for loop for printing each line!!
      set logLine=%%B
      print !logLine!  REM this prints the logPath instead of each logLine and jumps out of this for loop after the 1st iteration!
     )
 ) 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T09:00:56.967

您没有告诉我们哪一行发出“invalid switch”错误消息，但我看到了几个潜在的问题：

1.  要使用`!variables!`，您需要**启用延迟扩展**

    ```
    SetLocal EnableDelayedExpansion 
    ```

2.  不要`'/'`在文件名中使用，更改为`'\'`

    ```
    set logPath="C:\ExecutionSDKTest_10.2.2\Logs\!fileName!.log" 
    ```

3.  `print`命令将文本文件发送到打印机。将其更改为`echo`

    ```
    echo !logLine! 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T09:05:07.823

使用反斜杠而不是正斜杠。

```
set "logPath=C:\ExecutionSDKTest_10.2.2\Logs\!fileName!.log" 
```

虽然通常您可以在 Windows 中互换使用它们，但这`cmd`是一种特殊情况，因为正斜杠用于内置命令的开关和选项。并且它的解析器经常被正斜杠绊倒。不过，您通常可以安全地将此类路径传递给外部命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T21:30:25.293

```
echo off
For %%G in (C:\ExecutionSDKTest_10.2.2\*.properties) DO (      
      FOR /F "tokens=*" %%i in (%%G) do @echo %%i 
 ) 
```

# mysql - 使用 Ruby/Rails 检索 MySQL BLOB 字段

> ID：11369284
> 
> 赞同：0
> 
> 时间：2012-07-06T20:30:23.230
> 
> 标签：mysql, ruby-on-rails, ruby

我使用这个简单的 MySQL 查询`ActiveRecord::Base`

```
sql = "SELECT * FROM schedules WHERE id = 1"
schedule = (ActiveRecord::Base.connection.select_rows sql)[0] 
```

碰巧 schedule[9] 是`BLOB`数据，但它被检索为 ruby`String`​​ 对象。这正常吗？`BLOB`Ruby 中的对象是如何表示的？来自 Objective-C 世界的`BLOB`数据通常由`NSData`对象表示。Ruby中有某种等价物吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:18:32.457

ruby 中的字符串只是一个任意字节的序列——没有单独的数据类型。

可以给字符串一个编码，告诉 ruby​​ 在对它们进行各种操作时将字节解释为 utf-8、utf-16、ISO-latin 等，但也有 ASCII-8bit 编码（用词不当），这只是意味着任意字节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:02:53.870

如果它不是模型中的序列化记录，那么 Blob 只不过是一个没有大小限制的字符串。字符串是 Ruby 中的基本“数据”对象。

# sharepoint - 如何根据 SharePoint 中的“CurrentDateTime”“过滤”具有“DateTime”格式的数据？

> ID：11369288
> 
> 赞同：0
> 
> 时间：2012-07-06T20:30:58.140
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-designer

如何根据 SharePoint 中的“CurrentDateTime”“过滤”具有“DateTime”格式的数据？

我有一个名为“CreatedOn”（DateTime）的日期时间数据字段，我想在我想仅显示“GreaterThan Or EqualTo”和“CurrentDateTime”的项目中应用过滤器。

我在 where 条件下尝试使用此 CAML 查询但没有成功，它仅根据当前日期而不是“CurrentDateTime”进行过滤

```
<Where>            <Geq>              <FieldRef Name="CreatedOn"/>              <Value Type="DateTime" IncludeDateTime="TRUE">               <Today/>              </Value>             </Geq>             </Where> 
```

任何帮助表示赞赏。

维努

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T21:09:13.943

您的 CAML 中需要以下属性：

```
<Value IncludeTimeValue=’TRUE’ Type=’DateTime’&gt; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T14:28:10.737

这是我从 Emir Liu 那里得到的解决方案

嗨维努，

请在 SharePoint Designer 中以这种方式创建数据视图 Web 部件而不是列表视图 Web 部件：

插入 > 数据视图 > 空数据视图 > 选择您的列表 > 选择您需要在 Web 部件中显示的字段 > 将它们作为多个列表项插入。

因为我们需要使用公式作为筛选值，但列表视图 Web 部件不支持使用公式作为筛选值，所以需要数据视图 Web 部件。

使用以下公式作为过滤值，这样数据视图将只显示其 CreatedOn 字段大于或等于当前日期时间的项目。

number(ddwrt:FormatDateTime(string(@CreatedOn),3081,'yyyyMMdd0000'))+number(ddwrt:FormatDateTime(string(@CreatedOn),3081,'HHmm'))>= number(ddwrt:FormatDateTime(string(ddwrt :TodayIso()),3081,'yyyyMMdd0000'))+数字(ddwrt:FormatDateTime(string(ddwrt:TodayIso()),3081,'HHmm'))

以这种方式添加公式：

将鼠标放在数据视图上 > 单击 SharePoint Designer 功能区中选项选项卡下的筛选按钮 > 启用“添加 XSLT 筛选”选项 > 单击编辑按钮 > 在此处粘贴到 XPath 上方。

如果您有任何问题，请告诉我。

谢谢和问候， 埃米尔

谢谢维努

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-10T16:40:58.050

这是您应该尝试的查询：

```
 <Where>
      <Geq>
         <FieldRef Name='CreatedOn' />
         <Value IncludeTimeValue='TRUE' Type='DateTime'><Today/></Value>
      </Geq>
   </Where> 
```

# php - 将一列分成两列（sql）

> ID：11369292
> 
> 赞同：1
> 
> 时间：2012-07-06T20:31:39.563
> 
> 标签：php, sql

我有以下信息的专栏：

```
Author  varchar(255)    utf8_general_ci 
```

在我之前设计网站的程序员用这个专栏来存储两个东西！首先，作者的英文姓名，然后是他/她的阿拉伯语姓名！因此，该列中的所有数据都具有相同的结构：`تووياما أيما (Tooyama Ema)` 括号之间是英文名称。括号外是阿拉伯语的名称。有什么办法可以取英文名，放到一个新的栏目里。加上去掉括号？我可以同时使用 PHP 和 SQL，所以请你给我一个使用这两种语言的解决方案吗？我希望结果看起来像这样：

> 作者：`تووياما أيما` 作者英文：`Tooyama Ema`

我说的是具有相同结构的许多行。我想改变数据库中的结构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T20:58:14.517

我推荐一个数据库驱动的解决方案，应该比使用 PHP 花费更少的时间编码和运行。

不确定表名，但这里是您需要的内容，根据您的喜好更改：

（假设粗略的表定义）

```
CREATE TABLE Test (
  id int(11) not null auto_increment,
  Author varchar(255),
  primary key (id)
) 
```

新列的更改表：

```
ALTER TABLE Test ADD COLUMN `arabic_name` varchar(255) AFTER `Author`;
ALTER TABLE Test ADD COLUMN `english_name` varchar(255) AFTER `arabic_name`; 
```

用于迁移数据的简单更新语句（不是最漂亮的，但工作正常）：

```
 UPDATE Test
 SET
 arabic_name = SUBSTR(TRIM(Author), 1, LOCATE(' ', TRIM(Author)) - 1),
 english_name = SUBSTR(TRIM(Author), LOCATE('(', TRIM(Author)) + 1, LOCATE(')', TRIM(Author)) -  LOCATE('(', TRIM(Author)) - 1); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T20:35:39.720

```
$str = "تووياما أيما (Tooyama Ema)";
preg_match("/(.+) \((.+)\)/", $str, $matches);

var_dump($matches); 
```

# html - 将 img 标签转换为 div 标签，给出奇数高度结果

> ID：11369293
> 
> 赞同：-1
> 
> 时间：2012-07-06T20:31:48.640
> 
> 标签：html, css

我当然不是 CSS 专家，但我正在解决一个问题，我想让图像的复制对用户来说稍微有点负担。当然，它们仍然可以很容易地被检索到，但这使得您不能只是将它们拖放到桌面上。基本上，我有一堆这样的标记：

```
<img width="400" src="my image.png" class="foo" alt="foo"> 
```

相反，我决定将其放入背景图像并将元素更改为 div：

```
<div width="400" class="foo"> 
```

我遇到的问题是图像的宽度固定，但高度可变。当我使用 img 标签时，这非常有效。当我使用 div 标签时，它没有相同的行为。相反，CSS 要求我强制使用 height 属性来显示任何内容：

这不起作用

```
.foo {
  display: block;
  margin: 0;
  padding: 0;
  width: 400px;
  background-image: url(myimage.png);
  /* height: 200px; */
} 
```

这种排序会：

```
.foo {
  display: block;
  margin: 0;
  padding: 0;
  width: 400px;
  background-image: url(myimage.png);
  height: 200px; 
} 
```

问题是图像的高度都是可变的，正如我之前提到的。因此，如果我对尺寸进行硬编码，它会一遍又一遍地平铺。该容器可以是超过 5,000 个图像的占位符，因此手动设置它是行不通的。如果我能让这个 div 的行为与 img 标签完全一样，那么问题就解决了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:44:00.463

如果您*只是*想阻止人们单击和拖放，我会说将每个都`img`放入它自己`div`的`position: relative`. 在具有以下样式的`div`相对内部添加另一个：`div`

```
div.img_box {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: none;
    z-index: 9999; /* or anything higher than your img's z-index */
} 
```

这将用透明的`div`.

这样图像（这是您的内容的一部分）在 html 中的语法仍然是正确的。

每个人都说他们已经通过访问该站点将图像下载到他们的计算机上当然是正确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T20:40:32.800

如果您试图阻止用户轻松地重用您的内容，一些好的方法是： 1\. 使用分辨率较低的图像来限制重用潜力 2\. 给图像加水印 3\. 在图像精灵中结合两者。

破解它只会是丑陋、无效且难以维护的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T20:37:45.410

你可以用 CSS 做的唯一一件事就是添加一个适用于所有图像的高度。因此，如果您的图像高度范围为 200-250 像素，请将 div 设置为 250 像素。否则，您将需要 javascript 或服务器端脚本来确定图像的高度并设置 CSS。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T20:33:48.523

您只是在设置 div 的背景，而不是在 div 中添加图像。div 可以调整为它不会调整为背景图像的大小。只需使用标签。

# struts2 - 如何在struts2中包含一个包含标签参数作为迭代器标签的值

> ID：11369298
> 
> 赞同：0
> 
> 时间：2012-07-06T20:32:11.733
> 
> 标签：struts2

我有一个 jsp *to_include.jsp*，我想使用传递字符串参数的 < s:include > 标记将其包含在另一个中。这是包含jsp的代码：

```
<div>
    <s:include value="to_include.jsp">
        <s:param name="list">list_of_objects</s:param>
    </s:include>
</div> 
```

该*列表*参数是在包含的 jsp 中迭代的数组对象的名称。我可以使用以下方法轻松访问包含 jsp 中的列表名称：

```
<%= request.getParameter("list") %> 
```

但是在 < s:iterator > 属性*值*中，您不能像刚才显示的那样在标签内包含表达式。我的问题是，如何访问迭代器标签内的*列表参数？*

```
<s:iterator value="?">
    ...
</s:iterator> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T23:00:57.017

相反，使用 s:set 标记来获取操作属性并将其设置为值堆栈上的值，然后包含的页面可以访问该值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T16:11:04.233

如果您想要的是让正在迭代的列表由请求参数确定，那么为什么不在操作中而不是在 jsp 中进行选择呢？

例如：

```
public class ListAction {

    private List<?> list;
    private ListService listService;

    public String execute() {
        return "success";
    }

    public void setListName(String listName) {
        list = listService.getList(listName);
    }

    public void setListService(ListService listService) {
        this.listService = listService;
    }

    public List<?> getList() {
        return list;
    }

} 
```

# javascript - javascript中看似多余的三元运算符

> ID：11369300
> 
> 赞同：2
> 
> 时间：2012-07-06T20:32:18.267
> 
> 标签：javascript, ternary

以下是在线浮动的常见代码，用于检查特定浏览器中是否启用了 cookie：

```
var cookieEnabled = (window.navigator.cookieEnabled) ? true : false;

if (typeof navigator.cookieEnabled == "undefined" && !cookieEnabled) {
    document.cookie = "testcookie"
    cookieEnabled = (document.cookie.indexOf("testcookie") != -1) ? true : false
}

if (!cookieEnabled) {
    // do some work
} 
```

为什么第一行和第五行是三元语句？做

```
var cookieEnabled = (window.navigator.cookieEnabled) ? true : false; 
```

抓住一些情况，以下不会？

```
var cookieEnabled = (window.navigator.cookieEnabled); 
```

第五行也是如此。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T20:36:01.430

第一行的三元语句很有用，因为它将可能的非布尔值转换为布尔值。考虑以下代码

```
window.navigator.cookieEnabled = "evil people do this"; 
```

以上是合法的，正如价值所说，邪恶的人会这样做。如果没有三元语句，以下代码将无法按预期执行

```
if (cookiesEnabled === false) { 
  // ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T20:36:21.033

准确地说：

```
(window.navigator.cookieEnabled) ? true : false 
```

相当于：

```
!!window.navigator.cookieEnabled 
```

然而：

```
(document.cookie.indexOf("testcookie") != -1) ? true : false 
```

可以简单地替换为：

```
document.cookie.indexOf("testcookie") != -1 
```

最后：

```
cookieEnabled == false 
```

可以改为：

```
!cookieEnabled 
```

那么第一种情况有什么问题呢？在 JavaScript 中，非零数字、非空字符串等计算为`true`. 所以`if(window.navigator.cookieEnabled)`通过`cookieEnabled`等于`"foo"`和`42`也是。如果你真的想要一个`boolean`类型的变量，你必须两次否定它。

# android - Android libc.so 崩溃？

> ID：11369301
> 
> 赞同：8
> 
> 时间：2012-07-06T20:32:23.133
> 
> 标签：android, crash, box2d, andengine, libc

我正在使用 AndEngine 和 PhysicsBox2DExtension 来制作游戏。我的游戏不断崩溃，我在未过滤的 LogCat 中得到了这个：

```
07-06 13:25:27.266: I/DEBUG(19582): *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
07-06 13:25:27.266: I/DEBUG(19582): Build fingerprint: 'TMOUS/SGH-T959V/SGH-T959V/SGH-T959V:2.2.1/FROYO/VUVKD1:user/release-keys'
07-06 13:25:27.274: I/DEBUG(19582): pid: 22238, tid: 22263  >>> com.prattia.webs.testgfx5 <<<
07-06 13:25:27.274: I/DEBUG(19582): signal 11 (SIGSEGV), fault addr deadbaad
07-06 13:25:27.286: I/DEBUG(19582):  r0 00000000  r1 afd14921  r2 00000027  r3 00000070
07-06 13:25:27.286: I/DEBUG(19582):  r4 afd42328  r5 00000000  r6 00000000  r7 43095ba0
07-06 13:25:27.297: I/DEBUG(19582):  r8 447d75ac  r9 43095b5c  10 80aa23f4  fp 43095b58
07-06 13:25:27.297: I/DEBUG(19582):  ip 00001730  sp 447d74c8  lr deadbaad  pc afd11f74  cpsr 60000030
07-06 13:25:27.301: I/DEBUG(19582):  d0  6472656767756265  d1  646f426574616572
07-06 13:25:27.301: I/DEBUG(19582):  d2  2074736e6f632879  d3  654479646f423262
07-06 13:25:27.305: I/DEBUG(19582):  d4  73656e69676e655f  d5  69676e45646e412f
07-06 13:25:27.309: I/DEBUG(19582):  d6  6e45646e412f656e  d7  73796850656e6967
07-06 13:25:27.309: I/DEBUG(19582):  d8  40c9de1ed6a7d420  d9  43e0000000000000
07-06 13:25:27.313: I/DEBUG(19582):  d10 41dfffffffc00000  d11 c3e0000000000000
07-06 13:25:27.313: I/DEBUG(19582):  d12 0000000000000000  d13 0000000000000000
07-06 13:25:27.313: I/DEBUG(19582):  d14 0000000000000000  d15 0000000000000000
07-06 13:25:27.317: I/DEBUG(19582):  d16 000000c247d403f0  d17 400921fb54442d18
07-06 13:25:27.317: I/DEBUG(19582):  d18 3f810f1cab7c1816  d19 3f651bd7d319330c
07-06 13:25:27.317: I/DEBUG(19582):  d20 bfc55034095fd11a  d21 be5ae514498b308e
07-06 13:25:27.321: I/DEBUG(19582):  d22 0000000000000000  d23 3de5d93a5acfd57c
07-06 13:25:27.325: I/DEBUG(19582):  d24 bfb3b25552016f7e  d25 3fb10e9526779bed
07-06 13:25:27.325: I/DEBUG(19582):  d26 bfaddfe9639fbb1a  d27 3fa97c111b7b144e
07-06 13:25:27.325: I/DEBUG(19582):  d28 bfa2b4442c6a6c2f  d29 0000000000000000
07-06 13:25:27.325: I/DEBUG(19582):  d30 0000000000000000  d31 0000000000000000
07-06 13:25:27.325: I/DEBUG(19582):  scr 60000012
07-06 13:25:27.469: I/DEBUG(19582):          #00  pc 00011f74  /system/lib/libc.so
07-06 13:25:27.473: I/DEBUG(19582):          #01  pc 0001921e  /system/lib/libc.so
07-06 13:25:27.473: I/DEBUG(19582):          #02  pc 00026558  /data/data/com.prattia.webs.testgfx5/lib/libandenginephysicsbox2dextension.so
07-06 13:25:27.473: I/DEBUG(19582):          #03  pc 00013e7c  /data/data/com.prattia.webs.testgfx5/lib/libandenginephysicsbox2dextension.so
07-06 13:25:27.473: I/DEBUG(19582):          #04  pc 00016e34  /system/lib/libdvm.so
07-06 13:25:27.473: I/DEBUG(19582): code around pc:
07-06 13:25:27.473: I/DEBUG(19582): afd11f54 2d00682d e029d1fb b12b68db c05cf8df 
07-06 13:25:27.473: I/DEBUG(19582): afd11f64 f8442001 4798000c e054f8df 26002227 
07-06 13:25:27.473: I/DEBUG(19582): afd11f74 2000f88e eec2f7fb f7fc2106 f04feff8 
07-06 13:25:27.473: I/DEBUG(19582): afd11f84 91035180 460aa901 96012006 f7fc9602 
07-06 13:25:27.473: I/DEBUG(19582): afd11f94 a905eb7e 20024632 eb88f7fc eeaef7fb 
07-06 13:25:27.473: I/DEBUG(19582): code around lr:
07-06 13:25:27.477: I/DEBUG(19582): deadba8c ffffffff ffffffff ffffffff ffffffff 
07-06 13:25:27.477: I/DEBUG(19582): deadba9c ffffffff ffffffff ffffffff ffffffff 
07-06 13:25:27.477: I/DEBUG(19582): deadbaac ffffffff ffffffff ffffffff ffffffff 
07-06 13:25:27.477: I/DEBUG(19582): deadbabc ffffffff ffffffff ffffffff ffffffff 
07-06 13:25:27.477: I/DEBUG(19582): deadbacc ffffffff ffffffff ffffffff ffffffff 
07-06 13:25:27.477: I/DEBUG(19582): stack:
07-06 13:25:27.477: I/DEBUG(19582):     447d7488  00000000  
07-06 13:25:27.477: I/DEBUG(19582):     447d748c  00000000  
07-06 13:25:27.477: I/DEBUG(19582):     447d7490  afd425a0  /system/lib/libc.so
07-06 13:25:27.477: I/DEBUG(19582):     447d7494  afd4254c  /system/lib/libc.so
07-06 13:25:27.477: I/DEBUG(19582):     447d7498  00000000  
07-06 13:25:27.477: I/DEBUG(19582):     447d749c  afd1596b  /system/lib/libc.so
07-06 13:25:27.481: I/DEBUG(19582):     447d74a0  afd14921  /system/lib/libc.so
07-06 13:25:27.481: I/DEBUG(19582):     447d74a4  afd14921  /system/lib/libc.so
07-06 13:25:27.481: I/DEBUG(19582):     447d74a8  00000070  
07-06 13:25:27.481: I/DEBUG(19582):     447d74ac  afd42328  /system/lib/libc.so
07-06 13:25:27.481: I/DEBUG(19582):     447d74b0  00000000  
07-06 13:25:27.481: I/DEBUG(19582):     447d74b4  447d74dc  
07-06 13:25:27.481: I/DEBUG(19582):     447d74b8  43095ba0  
07-06 13:25:27.481: I/DEBUG(19582):     447d74bc  afd14bc3  /system/lib/libc.so
07-06 13:25:27.481: I/DEBUG(19582):     447d74c0  df002777  
07-06 13:25:27.481: I/DEBUG(19582):     447d74c4  e3a070ad  
07-06 13:25:27.481: I/DEBUG(19582): #00 447d74c8  00000003  
07-06 13:25:27.481: I/DEBUG(19582):     447d74cc  43095b58  
07-06 13:25:27.481: I/DEBUG(19582):     447d74d0  43095ba0  
07-06 13:25:27.485: I/DEBUG(19582):     447d74d4  afd14f29  /system/lib/libc.so
07-06 13:25:27.485: I/DEBUG(19582):     447d74d8  afd4254c  /system/lib/libc.so
07-06 13:25:27.485: I/DEBUG(19582):     447d74dc  fffffbdf  
07-06 13:25:27.485: I/DEBUG(19582):     447d74e0  00000054  
07-06 13:25:27.485: I/DEBUG(19582):     447d74e4  00000003  
07-06 13:25:27.485: I/DEBUG(19582):     447d74e8  43095b58  
07-06 13:25:27.489: I/DEBUG(19582):     447d74ec  afd19223  /system/lib/libc.so
07-06 13:25:27.489: I/DEBUG(19582): #01 447d74f0  00000054  
07-06 13:25:27.489: I/DEBUG(19582):     447d74f4  821412bc  /data/data/com.prattia.webs.testgfx5/lib/libandenginephysicsbox2dextension.so
07-06 13:25:27.489: I/DEBUG(19582):     447d74f8  447d75d0  
07-06 13:25:27.489: I/DEBUG(19582):     447d74fc  8212655c  /data/data/com.prattia.webs.testgfx5/lib/libandenginephysicsbox2dextension.so
07-06 13:25:28.040: I/DEBUG(19582): dumpstate /data/log/dumpstate_app_native.txt
07-06 13:25:28.114: I/dumpstate(22478): begin
07-06 13:25:28.122: I/dalvikvm(2480): threadid=3: reacting to signal 3
07-06 13:25:28.157: I/dalvikvm(2480): Wrote stack traces to '/data/anr/traces.txt'
07-06 13:25:28.192: I/BootReceiver(2480): Copying /data/tombstones/tombstone_09 to DropBox (SYSTEM_TOMBSTONE)
07-06 13:25:28.239: I/dalvikvm(2604): threadid=3: reacting to signal 3
07-06 13:25:28.239: I/dalvikvm(2604): Wrote stack traces to '/data/anr/traces.txt' 
```

谁能向我解释发生了什么以及我如何找到导致崩溃的确切原因？

我的代码中有两个地方崩溃了，但它发生的时候是相当随机的。执行此方法后：

```
private void destroyFiller(){ //Deletes filler
        if(filler[fillerNum].active){
            Log.e("destroyFiller","Destroying filler");
            filler[fillerNum].active=false;
            filler[fillerNum].body.setActive(false);
            scene.detachChild(filler[fillerNum].sprite);
            fillerCount--;
            fillersLeftText.setText("Balls left: "+Integer.toString(fillerCount));

            if(fillerCount==0)
                gameOver();
            Log.e("destroyFiller","Destroyed");
        }
    } 
```

并在此方法中执行指示的行后：

```
private void levelComplete(){
        runOnUiThread(new Runnable() {
            public void run() {
                 Toast.makeText(TestGFX5Activity.this, "Level Complete", Toast.LENGTH_SHORT).show();
            }
        });
        Log.e("Level Complete","Going to reset values");
        //Reset values
        level++;
        destroyerNum++;
        fillerCount = (originalNumberOfFillers + level - 1);
        areaFilled=0;
        fillAreaPercent = 0;

        //Rid scene of sprites
        for(int x=0;x<=fillerNum;x++){  
            filler[x].body.setActive(false);
            scene.detachChild(filler[x].sprite);
            filler[x].active=false;
            filler[x].scale=originalSpriteScale;
            filler[x].body.setUserData("inactive");
        }
        levelText.setText("Level: "+Integer.toString(level));
        fillersLeftText.setText("Balls left: "+Integer.toString(fillerCount));
        percentFilledText.setText("0%");
        fillerNum = -1;

        Log.e("Level Complete","values reset");

        randx = random.nextInt(650) + 25;
        randy = random.nextInt(400) + 25;
        randix = random.nextInt(10);
        randiy = random.nextInt(10);
        if(randix%2==0)
            ix = 5;
        else
            ix = -5;
        if(randiy%2==0)
            iy = 5;
        else
            iy = -5;

        Log.e("Level Complete","Creating destroyer");
        destroyer[destroyerNum] = new Ball(randx, randy, destroyerTR, getVertexBufferObjectManager(), ix, iy); //crashes here
        Log.e("Level Complete","complete"); //This line never reached.
    } 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-06T20:48:35.360

您应该使用[此处](https://stackoverflow.com/questions/5314036/how-to-use-addr2line-in-android)`addr2line`描述的工具并在库中查找这两个地址以查找导致崩溃的原因：

```
#02  pc 00026558  /data/data/com.prattia.webs.testgfx5/lib/libandenginephysicsbox2dextension.so
#03  pc 00013e7c  /data/data/com.prattia.webs.testgfx5/lib/libandenginephysicsbox2dextension.so 
```

所以在 Windows 下你应该：

1.  从设备复制库：

    ```
    adb pull /data/data/com.prattia.webs.testgfx5/lib/libandenginephysicsbox2dextension.so C:\ 
    ```

2.  使用命令行为其运行`addr2line`工具：

    ```
    cd %PATH_TO_YOUR_NDK%\toolchains\arm-linux-androideabi-4.4.3\prebuilt\linux-x86\bin
    arm-linux-androideabi-addr2line -C -f -e C:\libandenginephysicsbox2dextension.so 
    ```

3.  按地址输入地址：

    ```
    00026558 [ENTER]
    > here will be function name and line
    00013e7c [ENTER]
    > and again 
    ```

注意：在 Windows 下运行此工具可能会比在 Linux 下提供更少的信息，因此您可以选择将发行版安装为虚拟机并按照上面原始答案链接中的说明进行操作。

### 更新

另一种（更简单？）方法是使用`ndk-stack`：

1.  如从前那样
2.  将转储保存到文件中。我们称它为“dump.txt”。
3.  运行`ndk-stack`：

    ```
    cd %PATH_TO_YOUR_NDK%
    ndk-stack -sym C:\libandenginephysicsbox2dextension.so -dump C:\dump.txt 
    ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-06T20:39:39.357

libc 正在经历分段违规，几乎可以肯定是因为 andengine 给了它一个错误的指针。您可能没有 libc 的调试符号，但您可以通过 adb pull 和 objdump 找出哪些动态函数被赋予了错误的参数。或者，如果您的 andengine 库有调试符号，您可以使用地址转行工具追踪那里的地址。

您将必须弄清楚它是否是您要求和引擎执行的错误，或者该错误是否存在于andengine 本身。

# c++ - DLL注册返回码0x80029c4a

> ID：11369302
> 
> 赞同：1
> 
> 时间：2012-07-06T20:32:23.833
> 
> 标签：c++, windows, com

我对 COM 编程相当陌生，我有一个可以编译的 DLL，但在我尝试运行它时不会注册。我在这里遵循了本教程[http://msdn.microsoft.com/en-US/library/2wad1c0e(v=vs.80](http://msdn.microsoft.com/en-US/library/2wad1c0e(v=vs.80) ) 并对其进行了修改以生成下面的代码。我不太确定我在这里做错了什么。

```
#pragma once
#define STRICT
#ifndef _WIN32_WINNT
#define _WIN32_WINNT 0x0400
#endif
#define _ATL_ATTRIBUTES
#define _ATL_APARTMENT_THREADED
#define _ATL_NO_AUTOMATIC_NAMESPACE
#include <atlbase.h>
#include <atlcom.h>
#include <atlwin.h>
#include <atltypes.h>
#include <atlctl.h>
#include <atlhost.h>
using namespace ATL;

[module(type=dll, 
        name = "SMTPSink",
        version="1.0",
        uuid="0933FDCB-7CA1-41C7-BBA0-D1EF8C76F7A7",
        helpstring = "SMTPSink SMTPSink type library 1.0") ];
[ emitidl ];

//SMTP server interface functions.
//#import "oaidl.idl";
//#import "ocidl.idl";

#import "msado15.dll"  raw_interfaces_only no_namespace 
#import "cdosys.dll"  raw_interfaces_only rename_namespace("TWGSMTP") raw_native_types no_implementation
#import "seo.dll"  raw_interfaces_only no_namespace 

#include "Config_Loader.h"
using namespace TWGSMTP;
//struct IMessage;

[
   object,
   uuid("6F6CC19F-FC41-4FFD-95BD-717FFE9549E5"),
   dual,
   helpstring("Sink Interface"),
   pointer_default(unique)
]
__interface ISink : ISMTPOnArrival
{
    virtual HRESULT __stdcall OnArrival (/*[in]*/ IMessage * Msg,
        /*[in,out]*/ enum CdoEventStatus * EventStatus );
};

[
   coclass,
   threading(apartment),
   vi_progid("TWG.Sink"),
   progid("TWG.Sink.1"),
   version(1.0),
   uuid("17349758-26FD-49C0-894C-4C59D30F95CD"),
   helpstring("Sink Class")
]
class ATL_NO_VTABLE Sink: 
    public ISink
{
public:
   Sink()
   {
   }
   HRESULT __stdcall OnArrival (struct IMessage * Msg, enum CdoEventStatus * EventStatus );
   void TestMethod();

   HRESULT FinalConstruct()
   {
      return S_OK;
   }

   void FinalRelease() 
   {
   }
}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T20:53:05.173

这是我的 RC 文件没有

```
1                       TYPELIB           "SMTPSink.tlb" 
```

线。不知道为什么一开始就没有。

# javascript - Javascript函数检查日期

> ID：11369303
> 
> 赞同：2
> 
> 时间：2012-07-06T20:32:26.800
> 
> 标签：javascript, function

嗨，我是 Javascript 新手，正在尝试创建一个检查两个日期的函数。我已经读过将 JS 放在文档的开头部分很有用，但这并没有返回任何内容。我也是stackoverflow的新手，所以我希望我做得对。:) 有人看到错误吗？

```
<!DOCTYPE html>
<html>
<head>

var myDate = new Date(); // Your timezone!
var myEpoch = myDate.getTime()/1000;
var deadline = '1341596750.000';

document.write(myEpoch);
document.write("<br>",deadline);

if (myEpoch < deadline) {
  document.write("<p>Just in time!</p>");
} else {
  document.write("<p>Too late!</p>");
}

</head>
<body>

<br><br><br><br>http://www.epochconverter.com/
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T20:35:28.820

你不得不提到它是一个使用`<script>`. `<head>`此外，您不应该像使用 document.write 那样输出 DOM 。像这样操作 DOM：

```
 <head>
    <script type="text/javascript">

    var myDate = new Date(); // Your timezone!
    var myEpoch = myDate.getTime()/1000;
    var deadline = '1341596750.000';

    document.write(myEpoch);
    document.write("<br>",deadline);

    if (myEpoch < deadline) {
      document.getElementById("useme").innerHTML("Just in time!");
    } else {
      document.getElementById("useme").innerHTML("Too late!");
    }
    </script>
    </head>
<body>

<p id="useme"></p> 
```

# git - Windows 上的 Git 接收后挂钩以创建捆绑包

> ID：11369306
> 
> 赞同：0
> 
> 时间：2012-07-06T20:32:40.897
> 
> 标签：git

我有一个托管在 apache 2.2 服务器上的 git 存储库，该服务器作为 Windows 2003 服务器上的本地服务运行。我想添加一个 git post-receive 挂钩来更新 Dropbox 同步目录中的包。客户端拉和推工作，我能够在 Windows 命令行上生成包，我在如何编写和调试钩子的 shell 脚本上磕磕绊绊。

作为第一次尝试，我在 hooks 目录下创建了一个包含以下内容的 post-receive 文件，但是当我将更改推送到服务器时似乎没有发生任何事情

!/bin/sh

git bundle create "C:\Documents and Settings\fkhan\My Documents\Dropbox\git_bundles\cs701.bundle" master --all

当钩子失败时，是否会生成任何可用于调试的日志？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:45:36.813

据我所知，没有生成日志文件。您可以修改脚本以记录您想要的内容。

另外，请确保您的脚本是可执行的。

# extjs - ExtJS 3 网格自动宽度

> ID：11369309
> 
> 赞同：3
> 
> 时间：2012-07-06T20:32:54.990
> 
> 标签：extjs

在 ExtJS 3 中，如何将网格设置为自动宽度？我试过下面的代码，它不起作用。

谢谢

```
var exceptionGrid = new Ext.grid.GridPanel({
    store: exceptionStore,
    loadMask: true,
    frame: true,
    // defaultWidth: 450,
    //height: 560,
    autoHeight: true,
    autoWidth: true,
    colModel: new Ext.grid.ColumnModel({
        defaults: {
            width: 120,
            sortable: true
        },
        columns: [{
            header: 'COL1',
            dataIndex: 'COL1'
        }, {
            header: 'COL2',
            dataIndex: 'COL2'
        }, {
            header: 'COL3',
            dataIndex: 'COL3'
        }, .....]
    }),
    viewConfig: {
        forceFit: false
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T00:27:08.577

来自 extjs 3 文档：

[网格面板](http://docs.sencha.com/ext-js/3-4/#!/api/Ext.grid.GridPanel)

```
Notes:

 - Although this class inherits many configuration options from base
   classes, some of them (such as autoScroll, autoWidth, layout, items,
   etc) are not used by this class, and will have no effect.

 - A grid requires a width in which to scroll its columns, and a height
   in which to scroll its rows. These dimensions can either be set
   explicitly through the height and width configuration options or
   implicitly set by using the grid as a child item of a Container which
   will have a layout manager provide the sizing of its child items (for
   example the Container of the Grid may specify layout:'fit'). 
```

如果未指定，默认情况下网格的宽度当然采用容器宽度。Ext.grid.GridPanel# *autoExpandColumn*将有助于扩展网格中的一列，占用剩余的水平空间。也将有助于查看 Ext.grid.GridView 的*forceFit*和*autoFill*调整列的宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-11T11:55:40.950

根据您的设计，有多种方法可以做到这一点

1.尝试虽然\有时会产生问题`width: '100%'`，但宽度总是可以正常工作。`autoHeight:true``autoHeight:true``height: '100%'`

2.如果您的网格是 iframe/网页的“唯一”部分，请使用以下代码

```
 var viewport=new Ext.Viewport({
       layout: 'fit',
            monitorResize : true,
            items: [exceptionGrid ]
    }) 
```

3.如果问题只是滚动条，然后使用

```
 viewConfig: {
        forceFit: true
    } 
```

4.您始终可以设置`width: window.screen.width - 20`（根据您的需要应用一些数学来制作它）和类似的高度。

# python - 如何获得 Scrapy 0.12 版？

> ID：11369313
> 
> 赞同：1
> 
> 时间：2012-07-06T20:33:14.570
> 
> 标签：python, download, version, scrapy

Scrapy 似乎不允许安装以前的版本。

列出的方法有：

```
easy_install -U Scrapy 
```

和：

```
pip install Scrapy 
```

这两种方式都只是下载我不想要的最新版本的 Scrapy。我如何让 scrapy 下载 0.12 版？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T11:59:21.860

尝试手动安装：

```
vic@wic:~$ git clone git://github.com/scrapy/scrapy.git
Cloning into 'scrapy'...
remote: Counting objects: 24639, done.
remote: Compressing objects: 100% (15949/15949), done.
remote: Total 24639 (delta 8402), reused 24317 (delta 8158)
Receiving objects: 100% (24639/24639), 10.73 MiB | 639 KiB/s, done.
Resolving deltas: 100% (8402/8402), done.

vic@wic:~$ cd scrapy/

vic@wic:~/scrapy$ git tag
0.10
0.10-rc1
0.10.1
0.10.2
0.10.3
0.14.0
0.14.1
0.14.2
0.14.3
0.14.4
0.7
0.7-rc1
0.8
0.9
0.9-rc1

vic@wic:~/scrapy$ git branch -a
* master
  remotes/origin/0.12
  remotes/origin/0.14                                                                                                                                               
  remotes/origin/HEAD -> origin/master                                                                                                                              
  remotes/origin/master                                                                                                                                             
  remotes/origin/singleton_removal                                                                                                                                  

vic@wic:~/scrapy$ git checkout 0.12                                                                                                                                 
Branch 0.12 set up to track remote branch 0.12 from origin.
Switched to a new branch '0.12'

vic@wic:~/scrapy$ sudo python setup.py install 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-14T03:40:05.873

我知道这是一个旧论坛。但我也偶然发现了这个问题并找到了更简单的解决方案

您可以使用

```
pip install scrapy==1.1 
```

只需将 1.1 更改为您想要的版本我想知道为什么他们没有将它放在文档中，因为我很难找到它

# python - Python内括号字符串解析

> ID：11369317
> 
> 赞同：1
> 
> 时间：2012-07-06T20:33:28.623
> 
> 标签：python, string, parsing, parentheses

好的，目前，如果给定这样的字符串：

```
A:0.1,B:0.2,(C:0.3,D:0.4)E:0.5,(F:0.6,G:0.7)H:0.8 
```

我正在使用这个：

```
child = Pstring[Pstring.find('(')+1:Pstring.find(')')] 
```

遍历字符串，并打印出内括号，并将其分配给变量 'child'

现在，我的问题是，我该如何做同样的事情：

```
W:1.0,X:1.1(A:0.1,B:0.2,(C:0.3,D:0.4)E:0.5,(F:0.6,G:0.7)H:0.8)Y:0.9 
```

它只是简单地包含一个外括号来表明所有东西（除了 W 和 X）都是 Y 的孩子

我目前得到“孩子”的输出为：

```
A:0.1,B:0.2,(C:0.3,D:0.4 
```

而我想要代码做的是首先解析外部括号，然后先获取内部括号，然后最后处理外部括号。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T20:41:04.897

如果您只想要内括号的内容，可以使用`re.findall()`以下正则表达式：

```
\(([^()]*)\) 
```

例如：

```
>>> import re
>>> s = 'W:1.0,X:1.1(A:0.1,B:0.2,(C:0.3,D:0.4)E:0.5,(F:0.6,G:0.7)H:0.8)Y:0.9'
>>> re.findall(r'\(([^()]*)\)', s)
['C:0.3,D:0.4', 'F:0.6,G:0.7'] 
```

解释：

```
\(        # literal '('
(         # start capturing group
  [^()]*    # any characters except '(' and ')', any number
)         # end capturing group
\)        # literal ')' 
```

`re.findall()`返回每个匹配的捕获组的内容。

# android - 重新启动设备后自定义创建的 android-calendar 被删除

> ID：11369321
> 
> 赞同：3
> 
> 时间：2012-07-06T20:33:42.847
> 
> 标签：android, calendar

我使用 Android 2.3.5 使用以下代码创建了一个新日历：

```
 if(Build.VERSION.SDK_INT < 14)
    {
        ContentValues calendar = new ContentValues();

        calendar.put("_sync_account", "Com2Cal");
        calendar.put("_sync_account_type", "LOCAL");
        calendar.put("name", "Com2Cal");
        calendar.put("displayName", "Com2Cal");
        calendar.put("color", 0xFF008080);
        calendar.put("access_level", 700);
        calendar.put("sync_events", 1);
        calendar.put("timezone", TimeZone.getDefault().getID());
        calendar.put("ownerAccount", "Com2Cal");
        calendar.put("hidden", 0);
        Uri conentUri;

        if(Build.VERSION.SDK_INT >= 8)
        {
            conentUri = Uri.parse("content://com.android.calendar/calendars");
        }
        else
        {
            conentUri = Uri.parse("content://calendar/calendars");
        }

        Uri newRow = context.getContentResolver().insert(createCompleteUri(conentUri), calendar);

        Log.v(TAG, newRow.toString());
    } 
```

和

```
private static Uri createCompleteUri(Uri uri)
{
    Uri.Builder b = uri.buildUpon();
    b.appendQueryParameter("caller_is_syncadapter", "true");
    b.appendQueryParameter("account_name", "Com2Cal");
    b.appendQueryParameter("account_type", "LOCAL");
    Uri calUri = b.build();
    Log.d("completeUri", calUri.toString());
    return calUri;
} 
```

日历已成功创建，我可以在日历应用程序中看到它。但重启设备后，日历不再存在。我错过了什么？

# php - PHP 脚本更改所有目录中的 URL 结构

> ID：11369324
> 
> 赞同：1
> 
> 时间：2012-07-06T20:34:05.583
> 
> 标签：php, database, url

我刚刚获得了对开发服务器的访问权限。我在 public_html 文件夹中创建了一个名为“test-site”的目录。当我访问[http://developmentdomain.com/test-site/](http://developmentdomain.com/test-site/)时，URL 字符串变为：[http://developmentdomain.com/test-site/?p=test-site](http://developmentdomain.com/test-site/?p=test-site)

发生这种情况的原因是因为根目录中的 index.php 告诉所有子目录将其添加到 URL 的末尾。主站点（托管在根目录中）需要这个文件，但我不希望所有其他子目录都受到它的影响。我将如何更改以下代码，使其仅适用于根目录，而不是子目录？这条线是导致它的原因： `$p = ($_REQUEST['p'] != '' ? $_REQUEST['p'] : 'home');`

代码：

```
<?
session_start();
$_SESSION['bj'] = 1;
include "db.php";
require_once("classes/layout.class.php");
require_once("classes/content.class.php");
$p = ($_REQUEST['p'] != '' ? $_REQUEST['p'] : 'home');

$layout = new layout();
$layout->startPage($p);
$layout->buildHead($p);
$layout->buildBody($p);

$content = new content();
$content->buildHeader($p);
$content->buildLogoNav($p);
$content->buildPage($p);
$content->buildFooter($p);

$layout->closePage($p);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:38:10.773

似乎 $_GET 参数被用作自定义 CMS。

1.  检查任何重写规则。
2.  查看 layout() 类
3.  查看您的服务器端包括`classes/layout.class.php`&`classes/content.class.php`

该 URL 正在以编程方式在某个时间点进行修改。假设由于 #1 而不是问题，那么请留意操纵[header()](http://us3.php.net/manual/en/function.header.php)的部分代码，即`header('Location: some/new/location');`

# android - 使用谷歌购买 REST API 时出现 500 错误

> ID：11369332
> 
> 赞同：9
> 
> 时间：2012-07-06T20:34:57.753
> 
> 标签：android, api, in-app-purchase, google-play

我正在开发一个使用 Google Play 新订阅功能的 android 应用程序。我的应用程序的一部分包含一个 Web 服务器，它通过 API 调用定期检查这些订阅的状态。它还取消了其中一些订阅。

Google 提供了两个 REST API 来实现这一点：

[https://developers.google.com/android-publisher/v1/purchases/get](https://developers.google.com/android-publisher/v1/purchases/get)

[https://developers.google.com/android-publisher/v1/purchases/cancel](https://developers.google.com/android-publisher/v1/purchases/cancel)

使用 OAuth，我可以让第一个工作得很好。但是，当我尝试取消某些订阅时，我收到一个没有详细信息的 500 错误。有没有其他人经历过这个？我使用不正确吗？我确定 OAuth 可以正常工作，因为我可以点击第一个 API。这是我的 curl 输出，隐藏了我的一些帐户数据：

```
curl -X POST 'https://www.googleapis.com/androidpublisher/v1/applications/com.ssd.mypkg/subscriptions/mysku/purchases/mypurchasetoken/cancel' -H 'Authorization: OAuth ya29.myoauth' -d '' -v
* About to connect() to www.googleapis.com port 443 (#0)
*   Trying 209.85.148.95... connected
* Connected to www.googleapis.com (209.85.148.95) port 443 (#0)
* SSLv3, TLS handshake, Client hello (1):
* SSLv3, TLS handshake, Server hello (2):
* SSLv3, TLS handshake, CERT (11):
* SSLv3, TLS handshake, Server finished (14):
* SSLv3, TLS handshake, Client key exchange (16):
* SSLv3, TLS change cipher, Client hello (1):
* SSLv3, TLS handshake, Finished (20):
* SSLv3, TLS change cipher, Client hello (1):
* SSLv3, TLS handshake, Finished (20):
* SSL connection using RC4-SHA
* Server certificate:
*    subject: C=US; ST=California; L=Mountain View; O=Google Inc; CN=*.googleapis.com
*    start date: 2012-06-14 06:42:53 GMT
*    expire date: 2013-06-07 19:43:27 GMT
*    subjectAltName: www.googleapis.com matched
*    issuer: C=US; O=Google Inc; CN=Google Internet Authority
*    SSL certificate verify ok.
> POST /androidpublisher/v1/applications/com.ssd.mypkg/subscriptions/mysku/purchases/mypurchasetoken/cancel HTTP/1.1
> User-Agent: curl/7.21.4 (universal-apple-darwin11.0) libcurl/7.21.4 OpenSSL/0.9.8r zlib/1.2.5
> Host: www.googleapis.com
> Accept: */*
> Authorization: OAuth ya29.myoauth
> Content-Length: 0
> Content-Type: application/x-www-form-urlencoded
> 
< HTTP/1.1 500 Internal Server Error
< Content-Type: application/json; charset=UTF-8
< Date: Fri, 06 Jul 2012 15:23:10 GMT
< Expires: Fri, 06 Jul 2012 15:23:10 GMT
< Cache-Control: private, max-age=0
< X-Content-Type-Options: nosniff
< X-Frame-Options: SAMEORIGIN
< X-XSS-Protection: 1; mode=block
< Server: GSE
< Transfer-Encoding: chunked
< 
{
 "error": {
  "code": 500,
  "message": null
 }
}
* Connection #0 to host www.googleapis.com left intact
* Closing connection #0
* SSLv3, TLS alert, Client hello (1): 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T20:44:34.380

我可以确认有完全相同的问题。获取详细信息完美但取消失败。我正在为 Java 类使用 Google API，所以我认为这是一个普遍问题，我们应该将其作为错误发布给 google。

这是我从谷歌服务器收到的响应：

```
com.google.api.client.googleapis.json.GoogleJsonResponseException: 500 Internal Server Error
{
  "code" : 500,
  "message" : null
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-10T18:32:56.290

我也遇到这个错误。我的应用程序仅在 beta 测试模式下发布。我想知道这可能是问题吗？

如果相关，我正在使用[googlesamples/android-play-publisher-api](https://github.com/googlesamples/android-play-publisher-api/tree/master/v2/python)`basic_list_apks`的修改版本，通过将服务调用定义行修改为如下所示，我将其更改为订阅撤销者：

```
service.purchases().subscriptions().revoke(packageName=package_name,
    subscriptionId=product_id,
    token=purchase_token) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-26T14:25:09.300

我可以确认同样的问题。这是我收到的回复：

```
{
  "error": {
    "code": 500,
    "message": null
  }
} 
```

我认为这个尴尬的错误消息的原因是订阅不再有效，但我们试图取消它。相反，我们应该首先检查订阅是否有效：到期日期、取消原因、自动续订。

在我的特殊情况下，订阅已过期，`cancelReason`这`1`意味着它已被系统取消。

# php - 淘汰赛 JS 和选择的多选不起作用

> ID：11369333
> 
> 赞同：6
> 
> 时间：2012-07-06T20:35:18.393
> 
> 标签：php, jquery, knockout.js, jquery-chosen

我正在使用淘汰赛 js 和选择的插件（https://github.com/harvesthq/chosen）来尝试做出好看的多选。

我尝试了各种方法，但无法让多选与我正在使用的数据一起工作。当我单击多选时，即使选项绑定包含正确的数据，也不会显示任何值。

HTML：

```
<select multiple="multiple" data-bind="options: allCustomers, 
selectedOptions: event().customers, optionsText: 'name', 
optionsValue: 'id', chosen: true " ></select>​ 
```

视图模型的简化版本：

```
 function Event()
    {
        this.customers = ko.observableArray();
    };                     

    //for chosen plugin
    ko.bindingHandlers.chosen = {
        update: function(element, valueAccessor, allBindingsAccessor, viewModel)  {
            $(element).chosen();
        }
    }

    function ViewModel()
    {   
        this.event = ko.observable(new Event());
        this.allCustomers = ko.observableArray();
    };

    var viewModel = new ViewModel();

    $.getJSON("/get_json", function(data) 
    {                                  
        for (var c = 0; c < data.customers.length; c++)
        {
            viewModel.allCustomers.push(data.customers[c]);
        }   
    });

    ko.applyBindings(viewModel); 
```

PHP：

```
function get_json()
{
    $eventData = array(
        'customers' => array(array('name' => 'Bob', 'id' => 1), array('name' => 'John', 'id' => 2)),
        'moreData' => array(),
        'evenMoreData' => array()
        );

    echo json_encode($eventData);
} 
```

这显示了所选样式的选择框，但是当我单击它时，没有出现任何选项。

当我在视图模型中为客户创建一个本地 JS 数组并将其传递给 allCustomers 时，多选可以正常工作（请参阅我的[jsfiddle](http://jsfiddle.net/Bcz4x/1/)），因此它与从服务器获取数据有关，但我一直盯着这个虽然看不到问题！

非常感谢任何帮助

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-06T20:56:52.347

在@Tyrsius 建议它可能在初始绑定后没有更新数据后，我发现了这个问题。

我像这样添加`$(element).trigger("liszt:updated");`到自定义绑定中：

```
ko.bindingHandlers.chosen = {
    update: function(element, valueAccessor, allBindingsAccessor, viewModel)  {
        $(element).chosen();
        $(element).trigger("liszt:updated");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-21T18:11:15.047

出于某种原因，接受版本中的代码对我不起作用。可能是因为该`liszt:updated`命令不会触发选择更新。根据[此处](http://harvesthq.github.io/chosen/)的文档，我编写了自己的版本：

```
ko.bindingHandlers.chosen = {
    init: function (element, valueAccessor, allBindingsAccessor, viewModel) {
        $(element).chosen({ width: "95%", placeholder_text_multiple: "Select..." });
        var value = ko.unwrap(valueAccessor());
    },

    update: function (element, valueAccessor, allBindingsAccessor, viewModel) {
        var value = ko.unwrap(valueAccessor());
        $(element).trigger("chosen:updated");

    }
} 
```

# android - 只有创建视图层次结构的原始线程才能接触其视图。_trd1 启动时发生异常

> ID：11369339
> 
> 赞同：1
> 
> 时间：2012-07-06T20:35:51.883
> 
> 标签：android

_trd1 启动时发生异常。为什么它给出一个例外。我有一个 imageView，我在其上设置了一个动画。就像我在 _imageCard2 上所做的一样，它们都工作得很好......但是当我添加一个新线程时，它在完成后给出了一个异常。

```
public void AnimFunction() {

    TranslateAnimation animation2 = new TranslateAnimation(0, -50, 0, 0);
    animation2.setDuration(100); // duration in ms
    animation2.setRepeatCount(1);
    animation2.setRepeatMode(Animation.REVERSE);
    animation2.setFillAfter(false);
    _imageView.startAnimation(animation2);

    _imageView.setImageResource(R.drawable.b1fv);

    // Animation

    TranslateAnimation animation = new TranslateAnimation(0, 150, 0, 0);
    animation.setDuration(400); // duration in ms
    animation.setRepeatCount(1);
    animation.setRepeatMode(Animation.REVERSE);
    animation.setFillAfter(false);
    _imageCard2.startAnimation(animation);

    Thread _trd1 = new Thread() {
        public void run() {
            try {
                sleep(2000);
                _imageCard2.setImageResource(R.drawable.sk);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    };
    _trd1.start();

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T20:40:50.573

尝试：

```
Thread _trd1 = new Thread() {
        public void run() {
            try {
                sleep(2000);
                runOnUiThread(new Runnable() {

                @Override
                public void run() {
                    _imageCard2.setImageResource(R.drawable.sk);
                }
            });

            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T20:40:55.443

您正在尝试从不同于 UI 线程的线程修改 UI 组件。

考虑在您的线程中使用处理程序。

您还可以在具有更新 UI 的方法的 AsyncTask 中进行后台处理。

**编辑：**一些解释：

UI = 用户界面。

您的活动在作为 UI 线程的主线程中运行。

除了 UI 线程，您不能修改 UI 组件（按钮、ImageView 等）。

当您创建 trd1 线程时，您试图从中修改 ImageView。这就是你得到错误的原因。

`runOnUiThread()`是您可以用来在 UI 线程而不是新创建的线程上进行修改的方法之一。

# php - Facebook Graph API - 数据中缺少评论

> ID：11369341
> 
> 赞同：1
> 
> 时间：2012-07-06T20:35:58.373
> 
> 标签：php, facebook-graph-api

我正在构建一个可以读取 Facebook 页面内容的网络应用程序。它目前正在访问该页面的所有帖子和评论，但其他人添加的评论存在问题

例如，如果我将帖子写为页面，然后在页面中添加评论 - 一切看起来都很好。但是，如果我以个人身份添加评论，而评论的文本通过，“来自”信息（id，name）不会。

这是我正在拨打的电话的一个示例：

```
https://graph.facebook.com/PAGEID_POSTID?access_token=PAGEACCESSTOKEN 
```

这是响应的一个子集：

```
"comments": {
  "data": [
     {
        "id": "PAGEID_POSTID_COMMENTID",
        "from": null,
        "message": "Testing adding a comment",
        "created_time": "2012-07-06T19:27:08+0000"
     }
  ] 
```

我期待“发件人”包含海报的 ID 和名称（就像我在页面中添加评论时一样）。

我也可以尝试根据 PAGE_POST_COMMENT ID 获取评论，但在这种情况下，响应为**false**。除非我通过添加评论的用户的访问令牌，否则它可以正常工作（在绝大多数情况下我不会拥有）。

添加评论的用户具有默认隐私设置（公共），因此这似乎不是问题。

我可以理解这是一个身份验证问题 - 但我不确定为什么它会阻止我查看评论中发布的内容。除非我知道它来自谁，否则给我看评论没什么用！

权限方面，该应用程序具有“manage_pages、publish_stream、read_stream”。

我在这里错过了一些非常明显的东西吗？

干杯，凯夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T07:52:05.247

这似乎是 Facebook 测试用户系统的错误。作为测试用户添加评论时，我遇到了上述问题，但如果我在实时用户的实时页面上尝试它，它工作正常！

我用 Facebook 提出了一个错误：[https ://developers.facebook.com/bugs/331098286974765](https://developers.facebook.com/bugs/331098286974765)

# oracle - 使用 sqlldr 时出现 ORA-01775: looping chain of synonyms 错误

> ID：11369347
> 
> 赞同：1
> 
> 时间：2012-07-06T20:36:50.900
> 
> 标签：oracle, oracle11g

我很抱歉在互联网上发布了一个似乎已被多次询问的问题，但由于某种原因我无法完全解决它。

我试图使用 Oracle 的神奇`sqldr`实用程序填充一些表，但由于某种原因它会引发 ORA-01775 错误。

我在谷歌上的每一个地方，人们都会说这样的话：“业余，把你的同义词整理出来”（这是意译的），这很好，但我没有做任何同义词。

在这里，以下内容在我的系统上不起作用：

```
SQLPLUS user/password
SQL>CREATE TABLE test (name varchar(10), id number);
SQL>exit 
```

然后，我有一个`.ctl`包含以下内容的文件：

```
load data
    characterset utf16
    infile *
    append
    into table test
    (name,
     id
    )
    begindata
    "GURRR"  4567 
```

然后我运行这个命令：

```
sqlldr user@localhost/password control=/tmp/controlfiles/test.ctl 
```

结果：

```
SQL*Loader-702: Internal error - ulndotvcol: OCIStmtExecute()
ORA-01775: looping chain of synonyms 
```

test.log 的一部分：

```
Table TEST, loaded from every logical record.
Insert option in effect for this table: APPEND

Column Name                  Position   Len  Term Encl Datatype
------------------------------ ---------- ----- ---- ---- ---------------------
NAME                                FIRST     2           CHARACTER            
ID                                   NEXT     2           CHARACTER            

SQL*Loader-702: Internal error - ulndotvcol: OCIStmtExecute()
ORA-01775: looping chain of synonyms 
```

而且，如果我尝试手动插入：

```
SQL> insert into test values ('aa', 56);
1 row created. 
```

没有问题。

所以，是的，我被困住了！

如果有帮助，我在 CentOS 上使用 Oracle 11g XE。

谢谢你们的帮助，我很感激。

编辑：

我有点，有点想通了问题的一部分。问题在于，在某个地方，可能是在加载失败或其他情况下，Oracle 给自己提供了损坏的视图和同义词。

受影响的视图是：`GV_$LOADISTAT`、`GV_$LOADPSTAT`和。我不太清楚为什么视图会损坏，但是重新编译它们会导致错误。查询本身使用的同义词已损坏，即、和同义词。`V_$LOADISTAT``V_$LOADPSTAT``compiled with errors``gv$loadistat``gv$loadpstat``v$loadistat``v$loadpstat`

我不确定为什么会发生这种情况，我也不太明白任何事情。所以，我决定放弃同义词并重新创建它们。不幸的是，我无法重新创建它们，因为他们指出的观点（这里发生了一些奇怪的递归......）是腐败的。这些观点是上述`GV_$LOADISTAT`观点和其他观点。换句话说，同义词指向使用这些同义词的观点。谈论一个循环链。

所以...我重新创建了公共同义词，但我没有将视图指定为`GV_$LOADISTAT`，而是将它们指定为`sys.GV_$LOADISTAT`。例如

```
DROP PUBLIC synonym GV$LOADISTAT;
CREATE PUBLIC synonym GV$LOADISTAT for sys.GV_$LOADISTAT; 
```

然后，我重新创建了用户视图以指向这些公共同义词。

```
CREATE OR REPLACE FORCE VIEW "USER"."GV_$LOADISTAT" ("INST_ID", "OWNER", "TABNAME", "INDEXNAME", "SUBNAME", "MESSAGE_NUM", "MESSAGE")
 AS
 SELECT "INST_ID",
   "OWNER",
   "TABNAME",
   "INDEXNAME",
   "SUBNAME",
   "MESSAGE_NUM",
   "MESSAGE"
 FROM gv$loadistat; 
```

这似乎解决了观点/同义词。是的，这有点像黑客，但它以某种方式奏效了。不幸的是，这还不足以运行 SQL Loader。我有一个`table or view does not exist`错误。

我尝试向我的普通用户授予更多权限，但没有奏效。所以，我放弃并以 sysdba 身份运行 SQL Loader。有效！这不是一件好事，但它是一个仅用于测试目的的开发系统，所以，我不在乎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T03:47:24.740

我无法重复您的循环同义词链错误，但似乎控制文件需要一些工作，至少对于我的环境而言。

我能够通过这样修改你的例子来工作：

```
load data
infile *
append
into table test
fields terminated by "," optionally enclosed by '"'
(name,
 id
)
begindata
"GURRR",4567 
```

# sql - 有效地包含不在 SQL 查询的 Group By 中的列

> ID：11369353
> 
> 赞同：9
> 
> 时间：2012-07-06T20:37:18.730
> 
> 标签：sql, sql-server, aggregate-functions

给定

**表 A**

```
Id   INTEGER
Name VARCHAR(50) 
```

**表 B**

```
Id   INTEGER
FkId INTEGER  ; Foreign key to Table A 
```

我希望计算每个`FkId`值的出现次数：

```
SELECT FkId, COUNT(FkId) 
FROM B 
GROUP BY FkId 
```

现在我只想从`Table A`.

这将不起作用：

```
SELECT FkId, COUNT(FkId), a.Name
FROM B b
INNER JOIN A a ON a.Id=b.FkId
GROUP BY FkId 
```

因为`a.Name`不包含在`GROUP BY`子句中（产生`is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause`错误）。

关键是要从这样的输出中移动

```
FkId  Count
1      42
2      25 
```

像这样输出

```
FkId  Count  Name
1      42     Ronald
2      22     John 
```

对于该错误消息，SO 上有很多匹配项，但有些例如[https://stackoverflow.com/a/6456944/141172](https://stackoverflow.com/a/6456944/141172)有诸如“将在表上生成 3 次扫描，而不是 1 次，因此不会缩放”。

如何在查询输出中*有效地*包含来自连接的字段`Table B`（与 1:1 的关系）？`FkId`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-06T20:43:04.810

你可以尝试这样的事情：

```
 ;WITH GroupedData AS
   (
       SELECT FkId, COUNT(FkId) As FkCount
       FROM B 
       GROUP BY FkId
   ) 
   SELECT gd.*, a.Name
   FROM GroupedData gd
   INNER JOIN dbo.A ON gd.FkId = A.FkId 
```

创建一个 CTE（公用表表达式）来处理您的分组/计数`Table B`，然后将该结果（每行`FkId`）加入并从最终结果集中`Table A`获取更多列。`Table A`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T20:42:21.143

您是否尝试将字段添加到分组依据？

```
SELECT FkId, COUNT(FkId), a.Name
FROM B b
INNER JOIN A a ON a.Id=b.FkId
GROUP BY FkId,a.Name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T20:48:31.233

```
select t3.Name, t3.FkId, t3.countedFkId from (a t1 
  join (select t2.FkId, count(FkId) as countedFkId from b t2 group by t2.FkId) 
  on t1.Id = t2.FkId) t3; 
```

# ruby-on-rails - zurb-foundation javascripts 不工作

> ID：11369354
> 
> 赞同：4
> 
> 时间：2012-07-06T20:37:22.370
> 
> 标签：ruby-on-rails, zurb-foundation

Javascripts 不工作。我错过了什么吗？我可以看到 javascript 和 css 文件在生成的 html 中。谢谢。

宝石文件

```
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'compass-rails', '~> 1.0.3'
  gem 'zurb-foundation', '~> 3.0.1'
  gem 'uglifier', '>= 1.0.3'
end 
```

应用程序.js

```
//= require jquery
//= require jquery_ujs
//= require foundation
//= require_tree . 
```

应用程序.css.scss

```
@import "foundation"; 
```

生成的代码

```
<link href="/assets/application.css?body=1" media="all" rel="stylesheet" type="text/css" />
<script src="/assets/jquery.js?body=1" type="text/javascript"></script>
<script src="/assets/jquery_ujs.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/modernizr.foundation.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/jquery.customforms.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/jquery.orbit-1.4.0.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/jquery.placeholder.min.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/jquery.reveal.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/jquery.tooltips.js?body=1" type="text/javascript"></script>
<script src="/assets/foundation/index.js?body=1" type="text/javascript"></script>
<script src="/assets/site.js?body=1" type="text/javascript"></script>
<script src="/assets/application.js?body=1" type="text/javascript"></script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-18T06:03:23.090

如果这与我遇到的问题相同，那是因为`app.js`默认情况下不包含基础文件。

我不知道为什么，因为它看起来确实应该是这样，但是尝试添加`//= require foundation/app`到您的 application.js 并查看是否可以解决它。

# artificial-intelligence - 人工智能扫雷项目

> ID：11369358
> 
> 赞同：8
> 
> 时间：2012-07-06T20:37:33.913
> 
> 标签：artificial-intelligence, game-engine, minesweeper

我需要实现扫雷求解器。我已经开始实施基于规则的代理。我已经执行了一些规则。我有一个启发式函数，用于为正在处理的当前单元格（包含有关周围单元格的信息）选择最佳匹配规则。因此，对于每个选定的单元格，它可以决定 8 个周围的单元格打开它们、标记它们或什么都不做。我是说。目前，代理获取一些显示的单元格作为输入，并决定如何处理周围的单元格（目前，代理不知道如何决定要处理哪个单元格）。

我的问题是，要实施什么算法来决定要治疗哪个细胞？

假设，对于第一步，代理将显示一个角落单元（或其他一些，根据第一步的某些规则）。之后该怎么办？

我知道我需要实现某种搜索。我知道很多搜索算法（BFS、DFS、A-STAR 等），这不是问题，我只是不明白如何在这里使用这些搜索。

我需要在人工智能原则中实施它：一种现代方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-06T21:09:14.770

BFS、DFS 和 A* 在这里可能不合适。如果您在完全了解世界的情况下尝试计划行动方案，那么这些算法非常有用。在扫雷中，你没有这样的知识。

相反，我建议尝试使用本书第三部分中的一些逻辑推理技术，特别是使用 SAT 或第 10 章中的技术。这将让你得出关于矿山在哪里使用诸如“以下之一”之类的事实的结论八个方格是地雷，接下来的八个方格中正好有两个方格是地雷。” 在每一步都这样做将帮助您确定地雷的位置，或者意识到您必须在继续之前猜测。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-02T21:01:51.167

我移植了这个（有一点帮助）。这是它的工作链接：[http](http://robertleeplummerjr.github.io/smartSweepers.js/) ://robertleeplummerjr.github.io/smartSweepers.js/ 。这里是项目：[https ://github.com/robertleeplummerjr/smartSweepers.js](https://github.com/robertleeplummerjr/smartSweepers.js)

玩得开心！

# php - 如何正确设置 PDO 连接

> ID：11369360
> 
> 赞同：93
> 
> 时间：2012-07-06T20:37:42.150
> 
> 标签：php, mysql, sql, class, pdo

我不时看到有关连接到数据库的问题。
大多数答案不是我这样做的方式，或者我可能无法正确得到答案。反正; 我从来没有想过它，因为我这样做的方式对我有用。

但这是一个疯狂的想法；也许我做错了，如果是这样的话；我真的很想知道如何使用 PHP 和 PDO 正确连接到 MySQL 数据库并使其易于访问。

**这是我的做法：**

首先，这是我的文件结构*（精简）*：

```
public_html/

* index.php  

* initialize/  
  -- load.initialize.php  
  -- configure.php  
  -- sessions.php 
```

**index.php**
在最顶部，我有`require('initialize/load.initialize.php');`.

**加载.initialize.php**

```
#   site configurations
    require('configure.php');
#   connect to database
    require('root/somewhere/connect.php');  //  this file is placed outside of public_html for better security.
#   include classes
    foreach (glob('assets/classes/*.class.php') as $class_filename){
        include($class_filename);
    }
#   include functions
    foreach (glob('assets/functions/*.func.php') as $func_filename){
        include($func_filename);
    }
#   handle sessions
    require('sessions.php'); 
```

*我知道有一种更好或更正确的方法来包含类，但不记得它是什么。还没有时间研究它，但我认为它与`autoload`. 类似的东西...*

**configure.php**
这里我基本上只是覆盖一些*php.ini* -properties 并为站点做一些其他的全局配置

**connect.php**
我已经把连接放到一个类上，这样其他类就可以*扩展*这个......

```
class connect_pdo
{
    protected $dbh;

    public function __construct()
    {
        try {
            $db_host = '  ';  //  hostname
            $db_name = '  ';  //  databasename
            $db_user = '  ';  //  username
            $user_pw = '  ';  //  password

            $con = new PDO('mysql:host='.$db_host.'; dbname='.$db_name, $db_user, $user_pw);  
            $con->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION );
            $con->exec("SET CHARACTER SET utf8");  //  return all sql requests as UTF-8  
        }
        catch (PDOException $err) {  
            echo "harmless error message if the connection fails";
            $err->getMessage() . "<br/>";
            file_put_contents('PDOErrors.txt',$err, FILE_APPEND);  // write some details to an error-log outside public_html  
            die();  //  terminate connection
        }
    }

    public function dbh()
    {
        return $this->dbh;
    }
}
#   put database handler into a var for easier access
    $con = new connect_pdo();
    $con = $con->dbh();
// 
```

*在这里，我确实相信自从我最近开始学习 OOP 并使用 PDO 代替 mysql 以来，还有很大的改进空间。
所以我刚刚学习了几个初学者教程并尝试了不同的东西......*

**session.php 除了处理常规会话**
之外，我还将一些类初始化为这样的会话：

```
if (!isset($_SESSION['sqlQuery'])){
    session_start();
    $_SESSION['sqlQuery'] = new sqlQuery();
} 
```

这样，这个课程就可以在所有地方使用。这可能不是一个好的做法（？）......
无论如何，这就是这种方法允许我从任何地方做的事情：

```
echo $_SESSION['sqlQuery']->getAreaName('county',9);  // outputs: Aust-Agder (the county name with that id in the database) 
```

在 my `sqlQuery`- *class*（即`extends`my `connect_pdo`- *class* ）内部，我有一个名为的公共函数`getAreaName`，用于处理对我的数据库的请求。
我觉得很整洁。

**像魅力一样工作**
所以基本上我就是这样做的。
此外，每当我需要从不在类中的数据库中获取某些内容时，我只需执行类似的操作：

```
$id = 123;

$sql = 'SELECT whatever FROM MyTable WHERE id = :id';
$qry = $con->prepare($sql);
$qry -> bindParam(':id', $id, PDO::PARAM_INT);
$qry -> execute();
$get = $qry->fetch(PDO::FETCH_ASSOC); 
```

由于我将连接放入*connect_pdo.php*内的变量中，因此我只是引用了它，我很高兴。有用。我得到了我的预期结果......

但不管怎样；如果你们能告诉我我是否离开这里，我将不胜感激。我应该做什么，我可以或应该改变的地方等等......

我渴望学习...

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2012-07-06T21:09:30.870

### 目标

在我看来，您在这种情况下的目标是双重的：

*   为每个数据库创建和维护单个/可重用的连接
*   确保已正确设置连接

### 解决方案

我建议同时使用匿名函数和工厂模式来处理 PDO 连接。它的使用看起来像这样：

```
$provider = function()
{
    $instance = new PDO('mysql:......;charset=utf8', 'username', 'password');
    $instance->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $instance->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
    return $instance;
};

$factory = new StructureFactory( $provider ); 
```

然后在不同的文件中或在同一文件中：

```
$something = $factory->create('Something');
$foobar = $factory->create('Foobar'); 
```

工厂本身应该是这样的：

```
class StructureFactory
{
    protected $provider = null;
    protected $connection = null;

    public function __construct( callable $provider )
    {
        $this->provider = $provider;
    }

    public function create( $name)
    {
        if ( $this->connection === null )
        {
            $this->connection = call_user_func( $this->provider );
        }
        return new $name( $this->connection );
    }

} 
```

这种方式可以让您拥有一个集中式结构，确保仅在需要时创建连接。它还将使单元测试和维护过程变得更加容易。

在这种情况下，提供者可以在引导阶段的某个地方找到。这种方法还将提供一个明确的位置来定义配置，用于连接到数据库。

请记住，这是一个**极其简化的示例**。您还可以从观看以下两个视频中受益：

*   [全局状态和单例](http://www.youtube.com/watch?v=-FRm3VPhseI)
*   [不要找东西！](http://www.youtube.com/watch?v=RlfLCWKxHJ0)

另外，我强烈建议阅读有关使用 PDO[的正确教程](http://web.archive.org/web/20190330214051/http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)（网上有一篇糟糕教程的日志）。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-07-06T20:48:49.760

我建议不要使用`$_SESSION`全局访问您的数据库连接。

您可以执行以下操作之一（按照从**最差到最佳**实践的顺序）：

*   `$dbh`使用`global $dbh`你的函数和类的内部访问
*   使用单例注册表，并在全局范围内访问它，如下所示：

    ```
    $registry = MyRegistry::getInstance();
    $dbh = $registry->getDbh(); 
    ```

*   将数据库处理程序注入到需要它的类中，如下所示：

    ```
    class MyClass {
        public function __construct($dbh) { /* ... */ }
    } 
    ```

我强烈推荐最后一个。它被称为依赖注入 (DI)、控制反转 (IoC)，或者简称为好莱坞原则（不要打电话给我们，我们会打电话给你）。

但是，它更高级一些，并且在没有框架的情况下需要更多的“布线”。因此，如果依赖注入对您来说太复杂，请使用单例注册表而不是一堆全局变量。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-01-12T00:21:17.233

我最近自己提出了一个类似的答案/问题。这就是我所做的，以防有人感兴趣：

```
<?php
namespace Library;

// Wrapper for \PDO. It only creates the rather expensive instance when needed.
// Use it exactly as you'd use the normal PDO object, except for the creation.
// In that case simply do "new \Library\PDO($args);" with the normal args
class PDO
  {
  // The actual instance of PDO
  private $db;

  public function __construct() {
    $this->args = func_get_args();
    }

  public function __call($method, $args)
    {
    if (empty($this->db))
      {
      $Ref = new \ReflectionClass('\PDO');
      $this->db = $Ref->newInstanceArgs($this->args);
      }

    return call_user_func_array(array($this->db, $method), $args);
    }
  } 
```

要调用它，您只需要修改此行：

```
$DB = new \Library\PDO(/* normal arguments */); 
```

如果您将其用于 (\Library\PDO $DB)，则还有类型提示。

它与接受的答案和您的答案非常相似；但是它有一个显着的优势。考虑这段代码：

```
$DB = new \Library\PDO( /* args */ );

$STH = $DB->prepare("SELECT * FROM users WHERE user = ?");
$STH->execute(array(25));
$User = $STH->fetch(); 
```

虽然它可能看起来像普通的 PDO（它只改变`\Library\`），但它实际上不会初始化对象，直到您调用第一个方法，无论它是什么。这使得它更加优化，因为 PDO 对象的创建稍微昂贵。它是一个透明类，或者它所谓的[Ghost](https://stackoverflow.com/a/9911787)，一种[延迟加载](https://en.wikipedia.org/wiki/Lazy_loading)的形式。您可以将 $DB 视为普通的 PDO 实例，将其传递，执行相同的操作等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-29T11:51:45.720

```
$dsn = 'mysql:host=your_host_name;dbname=your_db_name_here'; // define host name and database name
    $username = 'you'; // define the username
    $pwd='your_password'; // password
    try {
        $db = new PDO($dsn, $username, $pwd);
    }
    catch (PDOException $e) {
        $error_message = $e->getMessage();
        echo "this is displayed because an error was found";
        exit();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-25T06:22:51.980

您的设置中有一些基本缺陷：

1.  该`configure.php`文件不应位于 Web 服务器的文档根目录中——如果服务器配置错误，您可能会向公众公开凭据。你可能认为这不会发生在你身上，但这是你不需要承担的风险。课程也不应该在那里......这并不重要，但任何不需要公开的东西都不应该公开。
2.  除非您正在处理一个特别大的项目，否则您不应该有一个“初始化”目录。加载一个大文件比加载相同内容的十个小文件快大约 10 倍。随着项目的增长，这往往会真正加起来，并且会真正减慢 PHP 站点的速度。
3.  除非你真的需要，否则尽量不要加载东西。例如，除非您确实需要，否则不要连接 PDO。你真的不`session_start()`读/写会话。除非您创建类的实例，否则不要包含类定义文件。您可以拥有的连接数是有限制的。像 session 这样的 API 会建立“锁”，可以为使用相同资源的其他人暂停代码执行。
4.  据我所知，您没有使用 Composer。您应该使用它 - 它会让您自己的代码和第三方依赖项的生活变得更加轻松。

这是我建议的目录结构，类似于我用于中型项目的目录结构：

```
init.php                Replaces public_html/initialize. Your PDO connection details
                        are held here.
classes/                Replaces public_html/classes
vendor/autoload.php     Your class autoload script generated using the
                        industry standard Composer command line tool
composer.json           The file where you describe how autoload.php
                        operates among other things. For example if you
                        don't use namespaces (maybe you should) it might be:
                        {"autoload": {"psr-4": { "": "classes/" }}}
public_html/index.php   Your landing page
public_html/other.php   Some other page
public_html/css/foobar.css ...and so on for all static resources 
```

该`init.php`文件可能类似于：

```
date_default_timezone_set('Etc/UTC');

require 'vendor/autoload.php';

$pdoConnect = function() {
  static $pdo = false;
  if (!$pdo) {
    $pdo = new PDO('mysql:dbname=db;host=localhost', 'user', 'password');
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $pdo->setAttribute(PDO::ATTR_DEFAULT_FETCH_MODE, PDO::FETCH_OBJ);
  }
  return $pdo;
};

// similar anonymous functions for session_start(), etc. 
```

`index.php`可能看起来像：

```
require '../init.php';

$pdo = $pdoConnect();

// go from there 
```

`other.php`可能类似，但它可能没有连接到数据库，因此不执行 $pdoConnect。

您应该尽可能将大部分代码写入类目录。保持`index.php`, `other.php`, 等尽可能简短和甜美。

# asp.net-mvc - HttpHandler 永远不会被调用

> ID：11369362
> 
> 赞同：3
> 
> 时间：2012-07-06T20:37:55.937
> 
> 标签：asp.net-mvc, captcha, httphandler

我有一个 MVC 应用程序，我正在尝试将 ManagedFusion.Web.Captcha.CaptchaImageHandler 添加到其中，以便编写以下代码：

```
<label for="captcha">Enter @Html.Raw(Business.Captcha.CaptchaImage(Html, 50, 180))  Below</label> 
```

并显示图像。该类的代码只是从在线示例中剪切和粘贴的：

```
public static string CaptchaImage(this HtmlHelper helper, int height, int width) {
            ManagedFusion.Web.Controls.CaptchaImage image = new ManagedFusion.Web.Controls.CaptchaImage {
                Height = height,
                Width = width,
            };
            HttpRuntime.Cache.Add(image.UniqueId, image,
                null,
                DateTime.Now.AddSeconds(ManagedFusion.Web.Controls.CaptchaImage.CacheTimeOut),
                Cache.NoSlidingExpiration,
                CacheItemPriority.NotRemovable,
                null);
            StringBuilder stringBuilder = new StringBuilder(256);
            stringBuilder.Append("<input type=\"hidden\" name=\"captcha-guid\" value=\"");
            stringBuilder.Append(image.UniqueId);
            stringBuilder.Append("\" />");
            stringBuilder.AppendLine();
            stringBuilder.Append("<img src=\"");
            stringBuilder.Append("/captcha.ashx?guid=" + image.UniqueId);
            stringBuilder.Append("\" alt=\"CAPTCHA\" width=\"");
            stringBuilder.Append(width);
            stringBuilder.Append("\" height=\"");
            stringBuilder.Append(height);
            stringBuilder.Append("\" />");
            return stringBuilder.ToString();
        } 
```

我已将以下内容添加到我的 web.config

```
<system.web>

<httpHandlers>
  <add  verb="GET" path="test.sample"  type="ManagedFusion.Web.Handlers.CaptchaImageHandler, ManagedFusion.Web.Captcha" validate="false" />
</httpHandlers>
</system.web>

<system.webServer>
<validation validateIntegratedModeConfiguration="false" />
<modules runAllManagedModulesForAllRequests="true" >

</modules>
<handlers>
  <add name="CaptchaImageHandler" verb="GET" path="captcha.ashx"  type="ManagedFusion.Web.Handlers.CaptchaImageHandler, ManagedFusion.Web.Captcha" />
</handlers> 
```

所有以前的 SO 问题都指向 system.web->httpHandlers 被 Cassini 获取，system.webServer->handlers 被 IIS 7 获取。但是每当我导航到具有上述代码的视图时，我总是得到一个/captcha.ashx 为 404。global.asax 中没有路由忽略规则。这里发生了什么？就像我所做的任何事情都不会让处理程序在我的本地计算机或已部署的 IIS 7 实例上触发。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T14:34:49.300

在 Global.asax 文件中，我需要在默认路由映射之前添加忽略路由，所以整个方法如下所示：

```
public static void RegisterRoutes(RouteCollection routes) {
        routes.Ignore("captcha.ashx");

        routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
        );
    } 
```

# sql - ISO8601 将周日期转换为日历日期

> ID：11369372
> 
> 赞同：1
> 
> 时间：2012-07-06T20:38:47.373
> 
> 标签：sql, sql-server, datetime, date

我正在尝试以 ISO 8601 格式确定给定一周日期的日期（即 YYYY-W##）。我的最终目标是将 ISO 8601 周日期转换为 ISO 8601 日历日期。我需要在 TSQL 中执行此操作（我正在使用 SQL Server 2005），我不确定 SQL Server 05 中是否已经内置任何允许此操作的内容，但它有助于查看另一种语言的示例或在通用伪代码中

更新：

抱歉，如果我的问题的结构令人困惑。基本上，我有一个 ISO8601 周日期，我正在尝试将其转换为 ISO8601 日历日期。

示例（来自[维基百科](http://en.wikipedia.org/wiki/ISO_8601)）

ISO 8601 周日期：2012-W02 (YYYY-W##)

转换成...

ISO 8601 日历日期：2012-01-09 (YYYY-MM-DD)

由于在我的星期日期示例中没有给出星期部分，因此可以假设一周的第一天。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:25:46.193

尝试以下解决方案：

```
declare 
    @date varchar(10)
    ,@convertedDate datetime
    ,@wk int
    ,@yr int

set @date = '2012-W02';

set @yr = parsename(replace(@date, '-W', '.'), 2)
set @wk = parsename(replace(@date, '-W', '.'), 1)

set @convertedDate = convert(varchar(10), dateadd(week, @wk, dateadd (year, @yr-1900, 0)) - 5 - datepart(dw, dateadd (week, @wk, dateadd (year, @yr-1900, 0))), 121)

select 
    'Year' = @yr
    ,'Week' = @wk
    ,'Date' = @convertedDate 
```

**输出：**

```
-----------------------------------------
| Year | Week |         Date            |
-----------------------------------------
| 2012 |   2  | 2012-01-09 00:00:00.000 |
----------------------------------------- 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T20:46:07.830

给定[`CREATE FUNCTION`文档](http://msdn.microsoft.com/en-us/library/aa258261%28v=sql.80%29.aspx)中适当的 ISO 周函数（对其中的所有坏习惯进行了一些调整，恕我直言）：

```
CREATE FUNCTION dbo.ISOWeek 
( 
    @dt SMALLDATETIME 
) 
RETURNS TINYINT 
AS 
BEGIN 
    DECLARE @ISOweek TINYINT;

    SET @ISOweek = DATEPART(WEEK, @dt) + 1 
        -DATEPART(WEEK, RTRIM(YEAR(@dt)) + '0104');

    IF @ISOweek = 0 
    BEGIN 
        SET @ISOweek = dbo.ISOweek 
        ( 
            RTRIM(YEAR(@dt)-1)+'12'+RTRIM(24 + DAY(@dt)) 
        ) + 1;
    END 

    IF MONTH(@dt) = 12 AND DAY(@dt) - DATEPART(DAYOFWEEK, @dt) >= 28 
    BEGIN 
        SET @ISOweek = 1; 
    END 

    RETURN(@ISOweek);
END 
GO 
```

我们可以像这样创建一个表：

```
CREATE TABLE dbo.ISOWeekCalendar
(
    [Date] SMALLDATETIME PRIMARY KEY,
    ISOWeekNumber TINYINT,
    [Year] INT,
    ISOWeek CHAR(8)
);
CREATE UNIQUE INDEX iw ON dbo.ISOWeekCalendar(ISOWeek); 
```

我们可以用任何年份的数据填充它，这使用 2000 - 2029 年的 ISO 周 1-52：

```
DECLARE @StartDate SMALLDATETIME,
        @EndDate   SMALLDATETIME;

SELECT @StartDate = '20000102',
       @EndDate   = '20291229';

INSERT dbo.ISOWeekCalendar([Date])
SELECT TOP (DATEDIFF(DAY, @StartDate, @EndDate)+1) n
 = DATEADD(DAY, ROW_NUMBER() OVER (ORDER BY s1.[object_id])-1, @StartDate)
 FROM sys.all_objects AS s1
 CROSS JOIN sys.all_objects AS s2
 ORDER BY s1.[object_id]; 
```

现在我们可以更新数据了。

```
-- delete all non-Mondays:
SET DATEFIRST 1;
DELETE dbo.ISOWeekCalendar WHERE DATEPART(WEEKDAY, [Date]) <> 1;

-- put the proper ISO week number:
UPDATE dbo.ISOWeekCalendar SET ISOWeekNumber = dbo.ISOWeek([Date]);

-- put the year:
UPDATE dbo.ISOWeekCalendar SET [Year] = DATEPART(YEAR, [Date]);

-- update to the correct year for fringe days:
UPDATE dbo.ISOWeekCalendar SET [Year] = [Year] + 1 
  WHERE ISOWeekNumber = 1 AND MONTH([Date]) = 12;

-- finally, build the calculated value for YYYY-W##:
UPDATE dbo.ISOWeekCalendar 
  SET ISOWeek = RTRIM([Year]) + '-W' + RIGHT('0' + RTRIM(ISOWeekNumber), 2); 
```

请注意，上述操作只需执行一次。现在我们可以根据输入运行一个非常简单的查询：

```
SELECT [Date] FROM dbo.ISOWeekCalendar WHERE ISOWeek = '2012-W02'; 
```

结果：

```
Date
-------------------
2012-01-09 00:00:00 
```

我们甚至可以创建一个函数来执行此操作：

```
CREATE FUNCTION dbo.ISOWeekDate(@ISOWeek CHAR(8))
RETURNS SMALLDATETIME
WITH SCHEMABINDING
AS
BEGIN
  RETURN (SELECT [Date] FROM dbo.ISOWeekCalendar
    WHERE ISOWeek = @ISOWeek);
END
GO 
```

还有一个相反的功能：

```
CREATE FUNCTION dbo.ISOWeekFromDate(@Date SMALLDATETIME)
RETURNS CHAR(8)
WITH SCHEMABINDING
AS
BEGIN
  RETURN (SELECT TOP (1) ISOWeek FROM dbo.ISOWeekCalendar
    WHERE [Date] <= @Date
    ORDER BY [Date] DESC);
END
GO 
```

询问：

```
SELECT dbo.ISOWeekDate('2012-W02'), dbo.ISOWeekFromDate('20120110'); 
```

结果：

```
-------------------    --------
2012-01-09 00:00:00    2012-W02 
```

是的，它比复杂的查询需要更多的前期工作，但我更喜欢易用性和更清晰的查询语义。

# git - 如何一次删除所有 Git 存储？

> ID：11369375
> 
> 赞同：1820
> 
> 时间：2012-07-06T20:38:58.513
> 
> 标签：git, git-stash

如何一次删除所有[Git](https://en.wikipedia.org/wiki/Git)存储？

具体来说，我的意思是输入一个命令。

* * *

## 回答 #1

> 赞同：3144
> 
> 时间：2012-07-06T20:41:39.217

以下命令删除所有存储：

```
git stash clear 
```

从[git 文档](http://www.kernel.org/pub/software/scm/git/docs/git-stash.html)：

> **`clear`**
> 
> 删除所有隐藏的状态。
> 
> **重要警告：**这些状态将受到修剪，并且可能无法恢复（...）。

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2018-05-25T07:47:49.490

删除存储有两种方法：

1.  如果您不再需要特定的存储，可以使用以下命令将其删除：`$ git stash drop <stash_id>`。
2.  您可以使用以下命令从存储库中删除所有存储：`$ git stash clear`。

谨慎使用它们，可能很难恢复曾经删除的存储。

这是[参考文章](https://kolosek.com/git-stash/)。

* * *

## 回答 #3

> 赞同：85
> 
> 时间：2019-02-27T08:40:37.620

此命令使您能够查看所有隐藏的更改：

```
git stash list 
```

这是以下命令，使用它来清除所有隐藏的更改：

```
git stash clear 
```

现在，如果您想从存储区域中删除其中一项隐藏更改：

```
git stash drop stash@{index} # Index will be shown after getting stash list 
```

注意：`git stash list`使您能够从 git 的 stash 区域获取索引。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2019-08-21T13:40:42.740

我想保留一些最近的藏匿处，但删除其他所有内容。

因为当你丢弃一个时，所有的 stash 都会重新编号，这实际上很容易用 while 完成。要删除所有早于 stash@{19} 的存储：

```
while git stash drop 'stash@{20}'; do true; done 
```

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2021-10-05T12:59:00.677

一次清除所有藏匿处

```
 git stash clear 
```

列出所有存储

```
 git stash list 
```

删除特定的存储

```
 git stash drop stash@{index} 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2020-05-23T02:55:36.983

要删除所有超过 40 天的存储，请使用：

```
git reflog expire --expire-unreachable=40.days refs/stash 
```

添加`--dry-run`以查看删除了哪些存储。

有关说明和更多详细信息，请参阅[https://stackoverflow.com/a/44829516/946850 。](https://stackoverflow.com/a/44829516/946850)

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2020-04-07T08:09:55.210

> **如果您想删除最新的存储或任何特定索引**-

**git stash drop type_your_index**

```
> git stash list

  stash@{0}: abc
  stash@{1}: xyz
  stash@{1}: pqr

> git stash drop 0

  Dropped refs/stash@{0}

> git stash list

  stash@{0}: xyz
  stash@{1}: pqr 
```

> **如果你想一次删除所有的存储**-

```
> git stash clear
>

> git stash list
> 
```

***警告****：一旦完成，您将无法恢复您的存储*

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2021-06-29T04:30:02.047

如果您只想清除最新的存储，甚至您使用**git stash create**创建了一个存储，那么您应该简单地使用

```
git stash drop 
```

但是如果你想清除当前 git 存储库的所有 git 存储，那么你可以使用

```
git stash clear 
```

警告：这些状态将受到修剪（敲除），并且可能无法恢复

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2019-03-29T12:14:22.847

我有另一个要求，例如只需要删除少量存储，下面的代码在这种情况下会有所帮助。

```
#!/bin/sh
for i in `seq 5 8`
do
   git stash drop stash@{$i}
done 
```

/* 将删除从 5 到 8 的索引*/

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-06-24T08:33:57.673

从列表中清除所有存储： **git stash clear**

从列表中清除特定索引： **git stash drop index**

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-01-14T11:03:48.410

如果您正在使用 VSCode，则 1.64（2022 年 1 月）将包含`git stash clear`在其命令中。

请参阅[问题 123375](https://github.com/microsoft/vscode/issues/123375)并[提交 302c41c](https://github.com/microsoft/vscode/commit/302c41cf4e4c3de5afa8583f6da68248cea0ae86)：

[![https://user-images.githubusercontent.com/26203420/117556727-437aa600-b06c-11eb-9db6-ed80896b12f6.png](../Images/b4080c7dfc21eccae42c1ee636375c67.png)](https://i.stack.imgur.com/ibxxb.png)

> ```
> "command": "git.stashDropAll", 
> ```

# iphone - UITableViewCellIdentifier 的静态 NSString

> ID：11369376
> 
> 赞同：0
> 
> 时间：2012-07-06T20:39:03.657
> 
> 标签：iphone, objective-c, static

我正在查看一些代码，想知道它是如何工作的。在一节课上，我看到这样的事情：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *simpleCellIdentifier = @"SimpleCellIdentifier";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"SimpleCellIdentifier"];
....
return cell
} 
```

然后在另一堂课中，我将看到库存 UITableViewCells 的相同片段。我想知道会发生什么

```
static NSString *simpleCellIdentifier; 
```

由于它是静态的，它会在项目的整个生命周期内分配，对吗？那么如果另一个 viewController 中的代码运行起来，会发生什么？它只是使用`simpleCellIdentifier`在其他类中创建的旧的吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T20:47:23.927

在这种情况下`simpleCellIdentifier`只存在于方法范围内。所以可以有尽可能多`simpleCellIdentifier`的不同方法，因为它们是不同的实例。

如果您`static`在类范围内声明变量，那么每当您在该类中读取/写入该变量时，您都在使用同一个实例。

# android - Android：在 ListActivity 中未调用 onListItemClick

> ID：11369382
> 
> 赞同：0
> 
> 时间：2012-07-06T20:39:47.483
> 
> 标签：android, onclick, listactivity

我的第一个 Android 应用程序出现问题。

我有子类 ListActivity，我没有运气让被覆盖的 onListItemClick() 来响应点击事件。我读过焦点可能是一个问题，但在 XML 文件中更改焦点似乎不起作用。这是相关的代码位。有谁看到我搞砸了什么？

```
public class Notepadv1 extends ListActivity {
    private int mNoteNumber = 1;
    private NotesDbAdapter mDbHelper;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.notepad_list);
        mDbHelper = new NotesDbAdapter(this);
        mDbHelper.open();
        fillData();
    }

 private void fillData() {
    // Get all of the notes from the database and create the item list
    Cursor c = mDbHelper.fetchAllNotes();
    startManagingCursor(c);

    String[] from = new String[] { NotesDbAdapter.KEY_TITLE };
    int[] to = new int[] { R.id.text1 };

    SimpleCursorAdapter notes =
        new SimpleCursorAdapter(this, R.layout.notes_row, c, from, to);
    setListAdapter(notes);
}

@Override
public void onListItemClick (ListView l, View v, int position, long id){
    super.onListItemClick(l, v, position, id);

    AlertDialog alert = new AlertDialog.Builder(this).create();
    String message = "row clicked!";
    alert.setMessage(message);
    alert.show();

} 
```

notepad_list.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content">

  <ListView
      android:id="@android:id/list"
      android:layout_width="wrap_content"
      android:layout_height="wrap_content"
      android:dividerHeight="6dp"/>

  <TextView android:id="@android:id/empty"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/no_notes" />

</LinearLayout> 
```

还有notes_row.xml

```
<?xml version="1.0" encoding="utf-8"?>
<TextView android:id="@+id/text1"
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="60dp"
    android:focusable="false"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:06:54.510

我创建了一个 ListActivity，使用了您的 onListItemClick 和 notes_row.xml。该代码对我有用。但是，我相信您期望*整行*响应单击，根据 notes_row 您需要单击*文本*本身（而不是行中的任何位置）。

尝试将 notes_row.xml 中的 width 属性更改为`"match_parent"`：

```
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/text1"
    android:layout_height="60dp"
    android:layout_width="match_parent"
    android:focusable="false" /> 
```

现在整行响应用户点击。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-12T12:34:10.043

如果这对任何人都有帮助，另一种可能的解决方案是：我的每个列表项中都有一个 Button，这阻止了我的 onListItemClick 事件触发。用看起来完全相同的 TextView 替换 Button 使其工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T20:46:27.123

实现 OnItemClickListener 并执行 list.setOnItemClickListener。

```
public class Notepadv1 extends ListActivity implements OnItemClickListener { 

   onCreate() 
   {
        ....

       ((ListView)findViewById(android.R.id.list)).setOnItemClickListener(this)

    }

} 
```

# c++ - Makefile - 依赖生成

> ID：11369383
> 
> 赞同：0
> 
> 时间：2012-07-06T20:39:50.273
> 
> 标签：c++, makefile, header-files

我正在尝试创建一个生成文件，该文件可以通过 .o 文件自动编译并将我的 .cpp 文件链接到可执行文件中。我无法工作的是自动（甚至手动）依赖生成。当我取消注释下面的注释代码时，运行时不会重新编译任何内容`make build`。我得到的只是`make: Nothing to be done for 'build'.`，即使 xh（或任何 .h 文件）已更改。我一直在尝试从这个问题中学习：[Makefile, header dependencies](https://stackoverflow.com/questions/2394609/makefile-header-dependencies) , dmckee's answer, 特别是。为什么这个makefile不起作用？

澄清：我可以编译所有东西，但是当我修改任何头文件时，依赖它的 .cpp 文件不会更新。因此，如果我例如编译我的整个源代码，那么我`#define`在头文件中更改 a ，然后运行`make build`​​，然后我得到`Nothing to be done for 'build'.`（当我取消注释以下代码的任一注释块时）。

```
CC=gcc
CFLAGS=-O2 -Wall
LDFLAGS=-lSDL -lstdc++
SOURCES=$(wildcard *.cpp)
OBJECTS=$(patsubst %.cpp, obj/%.o,$(SOURCES))
TARGET=bin/test.bin

# Nothing happens when i uncomment the following. (automated attempt)
#depend: .depend
#
#.depend: $(SOURCES)
#   rm -f ./.depend
#   $(CC) $(CFLAGS) -MM $^ >> ./.depend;
#
#include .depend

# And nothing happens when i uncomment the following. x.cpp and x.h are files in my project. (manual attempt)
#x.o: x.cpp x.h

clean:
    rm -f $(TARGET)
    rm -f $(OBJECTS)

run: build
    ./$(TARGET)

build: $(TARGET)

$(TARGET): $(OBJECTS)
    @mkdir -p $(@D)
    $(CC) $(LDFLAGS) $(OBJECTS) -o $@

obj/%.o: %.cpp
    @mkdir -p $(@D)
    $(CC) -c $(CFLAGS) $< -o $@ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T23:10:03.590

这可能需要几次迭代。

1）我无法从您的第一种方法中重现您的结果（并且您必须比“什么都没有发生”更清楚——Make 实际上没有产生任何输出吗？）。这：

```
depend: .depend

.depend: $(SOURCES)
    rm -f ./.depend
    $(CC) $(CFLAGS) -MM $^ >> ./.depend;

include .depend 
```

似乎按预期工作。我建议您尝试`$(info sources: $(SOURCES))`验证该变量是否包含您认为的文件名。

2）我无法从您的第二种方法中重现您的结果（并且您必须比“什么都没有发生”更清楚——Make 实际上没有产生任何输出吗？）。`x.o: x.cpp x.h`当第一种方法被注释掉时，您尝试过，对吗？

**编辑：**
让我们专注于`x.o`. 它包含`#include "x.h"`吗？当您取消注释第一部分`make x.o`时，Make 是否会产生（或修改）`.depend`？是否有与 相关的线`.depend`，`x.o`如果有，那是什么？如果然后修改`x.h`and then `make x.o`，Make 会做什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-08T15:12:39.430

您只解决了一种依赖关系`$(CC) -MM`。还有其他各种，例如更改的命令选项（例如`-DDO_SOMETHING_ELSE`），或由库导出的一组不同的符号。传统的 make 为您提供了很多有趣的调试不一致的可执行文件！

这就是[makepp](http://makepp.sourceforge.net/ "可靠的 GNU 替代品")的用武之地。自动检测依赖关系。它不仅会在任何类型的依赖保证这一点时重建目标。它甚至将所有内容链接在一起，并自下而上构建所需的内容。即，如果您的链接器有一个`-lmystuff`选项，并且您有构建 libmystuff.so 或 .a 的规则，这就是它所需要的，它将及时构建。同样，您可以包含甚至还不存在的文件——这在您的解决方案中是不可能的。

# phantomjs - PhantomJS：抓取多个 URL 时出现空白页面

> ID：11369384
> 
> 赞同：2
> 
> 时间：2012-07-06T20:39:52.867
> 
> 标签：phantomjs

我编写了一个 PhantomJs 脚本，通过递归链接对 page.open() 的调用来抓取多个 URL。（下面的代码片段。）这适用于最多 3 或 4 个 URL，但是如果 URL 数量较多，我只会得到空白页。空白是指 document.URL 包含“about:blank”，并且屏幕截图仅显示空白的白色背景。我还注意到 phantomJs 的内存使用量不断增加，因为它继续处理大量 URL。我需要做些什么来取消分配用于呈现前一页的任何内存吗？

其他人见过这个问题吗？是否可以扩展 PhantomJs 以抓取更多的 URL（比如 100 个）？

谢谢罗希特

用于抓取多个 URL 的递归代码段：

```
srcProducts = [{'url':'http://...' }, { 'url': 'http://...' },...];
destProducts = [];
gRetries = 0;
process();

function process() {
  if (srcProducts.length == 0) {
    // Output to file
    phantom.exit();
  } else {
     product = srcProducts.pop();

     page = require('webpage').create();
     page.open(product['url'], onOpen);
  }
}

function onOpen(status) {
  // check status
  // scrape info into product

  destProducts.push(product);
  process();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T08:04:29.170

有人很友善地在谷歌群组上回答了这个问题。解决方案是在使用完页面对象后调用 page.release()。

[https://groups.google.com/forum/?fromgroups#!topic/phantomjs/lquzLFvZtrA](https://groups.google.com/forum/?fromgroups#!topic/phantomjs/lquzLFvZtrA)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-12T23:19:18.597

page.release() has been deprecated in the current version of PhantomJS (v1.9).

You should now use page.close() instead to free the page from memory.

[http://phantomjs.org/api/webpage/method/release.html](http://phantomjs.org/api/webpage/method/release.html) [http://phantomjs.org/api/webpage/method/close.html](http://phantomjs.org/api/webpage/method/close.html)

# node.js - Node.js：处理流而不会耗尽内存

> ID：11369385
> 
> 赞同：0
> 
> 时间：2012-07-06T20:40:01.520
> 
> 标签：node.js, stream, file-processing

我正在尝试读取一个巨大的日志文件（250,000 行），将每一行解析为一个 JSON 对象，并将每个 JSON 对象插入到 CouchDB 进行分析。

我试图通过创建一个缓冲流来单独处理每个块，但我总是在大约 300 行后耗尽内存。似乎使用[缓冲流](https://github.com/dodo/node-bufferstream)和[util.pump](http://nodejs.org/api/util.html#util_util_pump_readablestream_writablestream_callback)应该避免这种情况，但显然不是。

（也许有比 node.js 和 CouchDB 更好的工具，但我有兴趣学习如何在 node.js 中进行这种文件处理，并认为它应该是可能的。）

下面是 CoffeeScript，这里是 JavaScript：[https ://gist.github.com/5a89d3590f0a9ca62a23](https://gist.github.com/5a89d3590f0a9ca62a23)

```
fs = require 'fs'
util = require('util')
BufferStream = require('bufferstream')

files = [
  "logfile1",
]

files.forEach (file)->
  stream = new BufferStream({encoding:'utf8', size:'flexible'})
  stream.split("\n")
  stream.on("split", (chunk, token)->
    line = chunk.toString()
    # parse line into JSON and insert in database
  )
  util.pump(fs.createReadStream(file, {encoding: 'utf8'}), stream) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-29T20:56:51.300

也许这有帮助： [在 Node.js 中使用流时内存泄漏？](https://stackoverflow.com/questions/19550180/memory-leak-when-using-streams-in-node-js)

尝试使用`pipe()`来解决它。

# java - 在 web.xml 中更改过滤器后出现错误 404

> ID：11369389
> 
> 赞同：0
> 
> 时间：2012-07-06T20:40:12.157
> 
> 标签：java, spring, spring-mvc, spring-security, web.xml

我正在尝试将 Spring Security 添加到项目中。在 web.xml 中添加代码块后，所有 url 都给出 404。

怎么了？

这是一个 Maven 项目，Spring MVC，hibernate，postgres。

（我不知道哪些信息与描述场景相关）

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">

    <!-- The definition of the Root Spring Container shared by all Servlets 
        and Filters -->
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/root-context.xml</param-value>
    </context-param>  

    <!-- Creates the Spring Container shared by all Servlets and Filters -->
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <!-- Processes application requests -->
    <servlet>
        <servlet-name>appServlet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/spring/appServlet/servlet-context.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>appServlet</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>

    <filter>
        <filter-name>encodingFilter</filter-name>
        <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>UTF-8</param-value>
        </init-param>
        <init-param>
            <param-name>forceEncoding</param-name>
            <param-value>true</param-value>
        </init-param>
    </filter>
    <filter-mapping>
        <filter-name>encodingFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!-- After insert this block, all URL's return 404 error -->
    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

</web-app> 
```

更新：

```
Grave: Exception starting filter springSecurityFilterChain
org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'springSecurityFilterChain' is defined
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanDefinition(DefaultListableBeanFactory.java:529)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getMergedLocalBeanDefinition(AbstractBeanFactory.java:1094)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:276)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:196)
    at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1079)
    at org.springframework.web.filter.DelegatingFilterProxy.initDelegate(DelegatingFilterProxy.java:217)
    at org.springframework.web.filter.DelegatingFilterProxy.initFilterBean(DelegatingFilterProxy.java:145)
    at org.springframework.web.filter.GenericFilterBean.init(GenericFilterBean.java:179)
    at org.apache.catalina.core.ApplicationFilterConfig.initFilter(ApplicationFilterConfig.java:277)
    at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:258)
    at org.apache.catalina.core.ApplicationFilterConfig.setFilterDef(ApplicationFilterConfig.java:382)
    at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:103)
    at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4638)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5294)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
    at org.apache.catalina.startup.HostConfig.checkResources(HostConfig.java:1366)
    at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1454)
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:295)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
    at org.apache.catalina.core.ContainerBase.backgroundProcess(ContainerBase.java:1379)
    at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1537)
    at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1547)
    at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1526)
    at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T07:58:04.550

在 web.xml 中定义过滤器

```
 <filter>  
     <filter-name>springSecurityFilterChain</filter-name>  
     <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>  
   </filter>  
   <filter-mapping>  
     <filter-name>springSecurityFilterChain</filter-name>  
     <url-pattern>/*</url-pattern>  
   </filter-mapping> 
```

制作如下所示的 spring-security.xml bean 文件。

```
<?xml version="1.0" encoding="UTF-8"?>  
 <beans:beans xmlns="http://www.springframework.org/schema/security"  
        xmlns:beans="http://www.springframework.org/schema/beans"  
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  
        xsi:schemaLocation="http://www.springframework.org/schema/beans  
 http://www.springframework.org/schema/beans/spring-beans-3.0.xsd  
 http://www.springframework.org/schema/security  
 http://www.springframework.org/schema/security/spring-security-3.0.xsd">  
   <beans:import resource="login-service.xml"/>  
   <http>  
     <intercept-url pattern="/home*" access="ROLE_USER,ROLE_ADMIN" />  
     <intercept-url pattern="/admin*" access="ROLE_ADMIN" />  
     <form-login login-page="/login.jsp" default-target-url="/home" authentication-failure-url="/login.jsp?error=true"/>  
     <logout logout-success-url="/login.jsp" />  
     <anonymous username="guest" granted-authority="ROLE_GUEST"/>  
     <remember-me/>  
   </http>  
   <authentication-manager>  
     <authentication-provider>  
       <!--<user-service>-->  
         <!--<user name="admin" password="secret" authorities="ROLE_ADMIN,ROLE_USER" />-->  
         <!--<user name="user1" password="1111" authorities="ROLE_USER" />-->  
       <!--</user-service>-->  
       <jdbc-user-service data-source-ref="dataSource"  
           users-by-username-query="select username,password, 'true' as enabled from USER_DETAILS where username=?"  
           authorities-by-username-query="select USER_DETAILS.username , USER_AUTH.AUTHORITY as authorities from USER_DETAILS,USER_AUTH  
            where USER_DETAILS.username = ? AND USER_DETAILS.username=USER_AUTH.USERNAME "/>  
     </authentication-provider>  
   </authentication-manager>  
 </beans:beans> 
```

根据您的要求更改属性。你可以在这里找到一些示例项目：http: [//blog.rajithdelantha.com/2012/07/spring-security-part-1-sample-login.html](http://blog.rajithdelantha.com/2012/07/spring-security-part-1-sample-login.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T20:56:33.037

您需要定义过滤器。

像这样：

```
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>

<filter-mapping>
  <filter-name>springSecurityFilterChain</filter-name>
  <url-pattern>/*</url-pattern>
</filter-mapping> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T21:11:45.533

看来您没有配置`springSecurityFilterChain`bean。

也许这个[链接](http://forum.springsource.org/showthread.php?53972-Problem-when-finding-springSecurityFilterChain-bean)可以帮助你。在那里，这个家伙只是在**spring 上下文中**像这样配置 bean ：

```
<beans:bean id="springSecurityFilterChain" class="org.springframework.security.util.FilterChainProxy">
    <filter-chain-map path-type="ant">
        <filter-chain pattern="/**" filters="sif"/>
    </filter-chain-map>
</beans:bean>

<beans:bean id="sif"
        class="org.springframework.security.context.HttpSessionContextIntegrationFilter" /> 
```

**名字真的很重要**

来自 Spring[文档](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/security-filter-chain.html)：

> 请注意，过滤器实际上是一个 DelegatingFilterProxy，而不是实际实现过滤器逻辑的类。DelegatingFilterProxy 所做的是将过滤器的方法委托给从 Spring 应用程序上下文获取的 bean。这使 bean 能够从 Spring Web 应用程序上下文生命周期支持和配置灵活性中受益。bean 必须实现 javax.servlet.Filter 并且它必须与 filter-name 元素中的名称相同。阅读 DelegatingFilterProxy 的 Javadoc 了解更多信息

# r - 如何正确输入国际化文本？

> ID：11369390
> 
> 赞同：7
> 
> 时间：2012-07-06T20:40:15.333
> 
> 标签：r, internationalization

我在 CSV 中有一堆来自外国的作者姓名，R 可以很好地读取。我正在尝试清理它们以上传到 Mechanical Turk（它甚至不喜欢单个国际化字符）。这样做，我有一个问题（稍后发布），但我什至不能`dput`以一种明智的方式：

```
> dput(df[306,"primauthfirstname"])
"Gwena\xeblle M"
> test <- "Gwena\xeblle M"
<simpleError in nchar(val): invalid multibyte string 1> 
```

换句话说，`dput`工作得很好，但粘贴结果失败。为什么不`dput`输出必要的信息以允许复制/粘贴回 R 中（大概它需要做的就是将编码属性添加到结构语句中？）。我如何让它这样做？

请注意，`\xeb`就 R 而言，这是一个有效字符：

```
> gsub("\xeb","", turk.df[306,"primauthfirstname"] )
[1] "Gwenalle M" 
```

但是您不能单独评估字符 - 它是十六进制代码 \x## 或什么都没有：

```
> gsub("\\x","", turk.df[306,"primauthfirstname"] )
[1] "Gwena\xeblle M" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T07:56:57.607

`dput()`的帮助页面说：“写一个 R 对象的 ASCII 文本表示”。因此，如果您的对象包含非 ASCII 字符，则这些字符无法表示并且必须以某种方式进行转换。

所以我建议你在ing`iconv()`之前使用转换你的向量。`dput`一种方法是：

```
> test <- "Gwena\xeblle M"
> out <- iconv(test, from="latin1", to="ASCII", sub="byte")
> out
[1] "Gwena<eb>lle M"
> gsub('<eb>', 'ë', out)
[1] "Gwenaëlle M" 
```

如您所见，这两种方式都有效。您可以稍后使用`gsub()`将字节反向转换为字符（如果您的编码支持它，例如 utf-8）。

第二种方法更简单（我想更适合您的需要），但是单向工作并且您的 libiconv 可能不支持它：

```
> test <- "Gwena\xeblle M"
> iconv(test, from="latin1", to="ASCII//TRANSLIT")
[1] "Gwenaelle M" 
```

希望这可以帮助！

# database - drupal_write_record 不接受对象

> ID：11369395
> 
> 赞同：1
> 
> 时间：2012-07-06T20:40:33.733
> 
> 标签：database, arrays, drupal, object

在drupal 6中，我曾经做过这样的事情：

```
<?php
/*
 * CLASS Example
 */
class example {
  var $id = NULL;
  var $title;
  var $body;

  .....

  // Save
  function save() {
    $primary_key = ($this->id == NULL ? NULL : 'id');
    if (drupal_write_record('mytabble', $this, $primary_key)) {
      return TRUE; 
    } else {
      return FALSE;
    }
  }
}
?> 
```

这工作得很好。但是在 Drupal 7 中，drupal_write_record 只需要一个数组，而不再是对象 $this。新的 db_merge 也只需要一个数组。因为我想将我的对象的属性保存到数据库中，所以上面的代码对于各种类都非常方便和通用。是否有将对象写入数据库的替代方法，或将对象属性放入数组的方法？

任何帮助将不胜感激！

罗伯特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T06:53:32.597

drupal_write_record 确实需要一个对象或一个数组。猜猜你的问题是由其他地方引起的。

drupal_write_record($table, &$record, $primary_keys = array())

$record：表示要写入的记录的**对象或数组**，通过引用传入。如果插入新记录，$record 中未提供的值将使用模式中的默认值以及单个序列（自动增量）字段（如果存在）填充到 $record 和数据库中。如果更新现有记录，则仅在数据库中更新提供的值，并且不会修改 $record。

[有关D7 的 drupal_write_record 的](http://api.drupal.org/api/drupal/includes!common.inc/function/drupal_write_record/7)更多信息。

# jquery - 淘汰赛 - 在dependentObservable（或计算）上的多选列表

> ID：11369397
> 
> 赞同：1
> 
> 时间：2012-07-06T20:40:42.783
> 
> 标签：jquery, knockout.js

我对这个问题有一个小提琴，这已经让我烦恼了几天：[小提琴](http://jsfiddle.net/Quu4f/10/)

包括 selectedUserReport observable 和 SelectedRecorddependentObservable 的模式是我从[这里获取的](https://github.com/SteveSanderson/knockout/wiki/View-Add-Edit-Delete-Design-Pattern)

我遇到的问题是，每当您单击多选列表中的某个项目时，PageModel.SelectedRecord 函数都会进行评估，这会阻止您选择任何项目。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T22:04:35.783

你有一个语法错误，这里是[工作小提琴](http://jsfiddle.net/Quu4f/11/)

```
selectedOptions: SelectedColumns //Shortcut, if prop is in context (it isn't right now)
selectedOptions: $parent.SelectedColumns //illegal
selectedOptions: $parent.SelectedColumns() //Correct 
```

问题是，当单独引用一个可观察对象时，淘汰赛允许您删除括号。但是，像内联函数或其他引用之类的其他任何东西，都需要使用括号。你在中间使用非法线路。

**编辑：**
好的，所以保存有点混乱，但基本上你的保存代码错误地推送数据。这是[另一个小提琴](http://jsfiddle.net/Quu4f/14/)。注意，编辑行现在是：

`self.selectedUserReport(new userReportModel(data));`

你不是在构建一个新模型，你只是在推送数据。这已经破坏了现在关闭的对话框，但是如果您手动关闭它，它将重新打开正确选择的选定选项。我希望你能从这里管理它。

# .net - 查看共享程序集的更改对上游应用程序的影响

> ID：11369398
> 
> 赞同：1
> 
> 时间：2012-07-06T20:40:45.383
> 
> 标签：.net, ndepend

我有一组`WCF`共享多个程序集的服务。当其中一个程序集发生更改时，我想知道对引用它们的任何服务有什么影响。

例如，如果我的`Foo`共享程序集中有一个名为的类，并且它有一个名为 的方法，该方法`DoSomething()`由一个或多个相关服务调用。对于第 1 版，我假设一切都发生了变化，因为没有基线。对于第 2 版，我更改了`DoSomething()`方法，我想知道哪些服务/方法受到更改的影响。

我的直觉是 NDepend 应该能够提供这些信息，但我对它还不够熟悉，无法编写查询。我也欢迎涉及其他工具的解决方案。

基本上，我正在寻找的是在两个不同构建之间发生变化的类/方法的列表，以及依赖于它们的类/方法，以便更好地针对测试工作和（不太重要的）部署。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:10:43.963

为此提供了一些默认的[CQLinq 默认查询](http://www.ndepend.com/DefaultRules/webframe.html)。

*   [直接调用一个或多个方法的方法发生了变化](http://www.ndepend.com/DefaultRules/Q_Methods_directly_calling_one_or_several_methods_changed.html)
*   [间接调用一个或多个方法的方法发生了变化](http://www.ndepend.com/DefaultRules/Q_Methods_indirectly_calling_one_or_several_methods_changed.html)

希望您可以轻松地调整它们。

**要获取更改列表，请查看组Code Diff Summary**中的一组差异查询。

# php - 删除 php 中隐藏的 (display:none) html 标签

> ID：11369399
> 
> 赞同：-2
> 
> 时间：2012-07-06T20:40:46.207
> 
> 标签：php, regex, strip-tags

我需要一个 PHP 正则表达式，它将从 html 代码序列中删除（在他们的风格中使用 display:none）。我尝试爆炸并解决它，但结果却是一团糟。例如下面的html代码

```
 <span>
<span style="display: inline">69</span>
<span style="display:none">113</span>
<span></span>
<span class="" style="">.</span>
<span style="display: inline">86</span>
<span style="display:none">59</span>
<span></span>
.206
<span></span>
.143
</span> 
```

结果应该是这样的：

```
<span>
<span style="display: inline">69</span>
<span></span>
<span class="" style="">.</span>
<span style="display: inline">86</span>
<span></span>
.206
<span></span>
.143
</span> 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T20:47:12.100

HTML 不是正则语言，因此不能被正则表达式解析。

您可以使用它，然后使用它与 php 一起返回的内容：

[http://api.jquery.com/remove/](http://api.jquery.com/remove/)

```
$("span[style='display:none']").remove(); 
```

如果您不想这样做，可以使用 dom 和 removeChild 函数：[http://php.net/manual/en/domnode.removechild.php](http://php.net/manual/en/domnode.removechild.php)

# java - 使用 Java 访问 Instagram API 时出现错误 400

> ID：11369409
> 
> 赞同：1
> 
> 时间：2012-07-06T20:42:05.960
> 
> 标签：java, oauth, instagram

我有一个名为 Autentica 的简单 servlet，它负责获取用于了解 OAuth 令牌的解码参数。API 返回到我的回调页面，从而运行名为回调的 servlet。问题是我无法从 OAuth 获取令牌，因为我从服务器收到错误 400。我不是网络编程专家，可能是一个新手错误。

任何人都可以帮助我吗？遵循 servlet 代码和控制台结果。非常感谢！

1) Servlet Autentica

```
@WebServlet(name = "autentica", urlPatterns = {"/autentica"})
public class Autentica extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        processRequest(req, resp);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        processRequest(req, resp);
    }

    protected void processRequest(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html;charset=UTF-8");
        PrintWriter out = response.getWriter();

        //API Credentials
        String client_id = "XXXX";
        String client_secret = "YYYY";
        String redirect_uri = "http://localhost:8080/InstagramAPI/callback";

        //Set Session Variables
        HttpSession session = request.getSession(true);
        session.setAttribute("client_id", client_id);
        session.setAttribute("client_secret", client_secret);
        session.setAttribute("redirect_uri", redirect_uri);

        try {
            //Redirect User to foursquare login page
            String url = "https://api.instagram.com/oauth/authorize/?client_id=" 
                    + client_id + "&redirect_uri=" + redirect_uri
                    + "&response_type=code";
            response.sendRedirect(url);
        } finally {
            out.close();
        }
    }
} 
```

2) Servlet 回调

```
@WebServlet(name = "callback", urlPatterns = {"/callback"})
public class Callback extends HttpServlet{

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        processRequest(req, resp);
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        processRequest(req, resp);
    }

    protected void processRequest(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        HttpSession session = request.getSession(true);
        String clientID =(String)session.getAttribute("client_id");
        String clientSecret =(String)session.getAttribute("client_secret");
        String redirectURI =(String)session.getAttribute("redirect_uri");  
        String code = request.getParameter("code");

        String url = "https://api.instagram.com/oauth/access_token?"
                + "client_id=" + clientID
                + "&client_secret=" + clientSecret
                + "&grant_type=authorization_code"
                + "&redirect_uri=" + redirectURI
                + "&code="+code;
        getContent(url);
    }

    //Return response after GET Request
    public String getContent(String httpurl){
        try {
            URL url = new URL(httpurl);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("POST");
            BufferedReader in = new BufferedReader(new InputStreamReader(
                    conn.getInputStream()));
            String strLine = "";
            String content = "";
            while ((strLine = in.readLine()) != null){
                 content = content+strLine;
            }
            in.close();
            System.out.println("DEBUG = "+content);
            return content;
        } catch (Exception e) {
            e.printStackTrace();
        }
        return null;
    }
} 
```

3) 控制台

```
INFO: InstagramAPI was successfully deployed in 990 milliseconds.
SEVERE: java.io.IOException: Server returned HTTP response code: 400 for URL: https://api.instagram.com/oauth/access_token?client_id=XXXX&client_secret=YYYY&grant_type=authorization_code&redirect_uri=http://localhost:8080/InstagramAPI/callback&code=7049a73c0dfe43528115fe1a52ff4e0e
    at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1615)
    at sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:254)
    at Callback.getContent(Callback.java:61)
    at Callback.processRequest(Callback.java:52)
    at Callback.doGet(Callback.java:29)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)

SEVERE:     at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1615)
SEVERE:     at sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:254)
SEVERE:     at Callback.getContent(Callback.java:61)
SEVERE:     at Callback.processRequest(Callback.java:52)
SEVERE:     at Callback.doGet(Callback.java:29)
SEVERE:     at javax.servlet.http.HttpServlet.service(HttpServlet.java:668)
SEVERE:     at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
SEVERE:     at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1542)
SEVERE:     at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
SEVERE:     at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
SEVERE:     at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
SEVERE:     at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
SEVERE:     at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
SEVERE:     at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
SEVERE:     at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
SEVERE:     at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
SEVERE:     at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
SEVERE:     at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
SEVERE:     at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
SEVERE:     at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
SEVERE:     at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
SEVERE:     at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
SEVERE:     at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
SEVERE:     at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
SEVERE:     at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
SEVERE:     at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
SEVERE:     at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
SEVERE:     at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
SEVERE:     at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
SEVERE:     at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
SEVERE:     at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T22:40:48.253

您将数据错误地发送到 access_token URL。您需要在 POST 请求的数据中发送字段。不作为 URL 的一部分。URL 应仅为“https://api.instagram.com/oauth/access_token”，其余数据应作为 POST 中的数据进行 urlencoded。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T00:23:19.830

那边已经给你一个完美的答案[了](https://stackoverflow.com/questions/4205980/java-sending-http-parameters-via-post-method-easily)！

您必须添加以下内容：

```
String urlParameters = "client_id=" + clientID
            + "&client_secret=" + clientSecret
            + "&grant_type=authorization_code"
            + "&redirect_uri=" + redirectURI
            + "&code="+code;

connection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded"); 
connection.setRequestProperty("charset", "utf-8");
connection.setRequestProperty("Content-Length", "" + Integer.toString(urlParameters.getBytes().length));

DataOutputStream wr = new DataOutputStream(connection.getOutputStream ());
wr.writeBytes(urlParameters);
wr.flush();
wr.close(); 
```

在你的`conn.setRequestMethod("POST");`.

# jquery - 对 MVC 控制器的多个 JQuery getJSON 调用未同步执行

> ID：11369412
> 
> 赞同：1
> 
> 时间：2012-07-06T20:42:15.197
> 
> 标签：jquery, asp.net-mvc-4, getjson

我正在使用 MVC4 构建 POC。我对 2 个不同的 MVC 控制器有一些 jquery json 调用。我需要第二个等到第一个完成后再运行，因为第二个需要在第一个中创建的 cookie。GetUserItem 应该首先运行，当它完成后 GetMoreFeedItems 应该运行。

这是我的代码片段：

```
var pageNumber = 0;
var feedCount = -1;
var itemsLoaded = 0;
var resultsPerPage = 10;
var loadingData = false;

$(document).ready(function () {

    GetUserItem();
});

function GetUserItem() {

    $.getJSON('/controllers/User/', function (result) {

        var root = $.parseJSON(result);
        var user = root["root"];

        $.each(user, function (i, item) {
            $('#user-container').append('<div style="border-bottom: 1px solid black; height:25px;">Id: ' + item.uid + '<br/>' + '</div>');
            $('#user-container').append('<div style="border-bottom: 1px solid black; height:25px;">Username: ' + item.username + '<br/>' + '</div>');
            $('#user-container').append('<div style="border-bottom: 1px solid black; height:25px;">Name: ' + item.first_name + " " + item.last_name + '<br/>' + '</div>');
            $('#user-container').append('<div style="border-bottom: 1px solid black; height:25px;">Birthday: ' + item.birthday + '<br/>' + '</div>');
            $('#user-container').append('<div style="border-bottom: 1px solid black; height:125px;">Profile Pic: <img alt="' + item.username + '" src="' + item.pic_small + '" /><br/>' + '</div>');
        });

    });

    GetMoreFeedItems();    
}

function GetMoreFeedItems() {
    if (feedCount == -1 || itemsLoaded < feedCount) { 

        if (loadingData === false) {
            loadingData = true;

            //Add loading spinner
            $('#feed-container').append('<div id="loader" style="height:20px; background-image:url(Images/loading_gray.gif);background-repeat:repeat-x;"></div>');

            $.getJSON('/controllers/Feed/' + pageNumber + '/' + resultsPerPage, function (result) {

                feedCount = result.substring(0, result.indexOf(','));

                var feed = $.parseJSON(result.substr(result.indexOf(',') + 1));

                $.each(feed, function (i, item) {
                    if (item.itemtype === "checkin")
                        $('#feed-container').append(buildOne(item));
                    else if (item.itemtype === "like")
                        $('#feed-container').append(buildTwo(item));
                    else if (item.itemtype === "post")
                        $('#feed-container').append(buildThree(item));
                    else if (item.itemtype === "message")
                        $('#feed-container').append(buildFour(item));
                    else if (item.itemtype === "story")
                        $('#feed-container').append(buildFive(item));
                });

                loadingData = false;
                itemsLoaded += resultsPerPage;

                //Remove loading spinner
                $('#loader').remove();
            });
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T20:43:51.250

将调用`GetMoreFeedItems()`放在成功函数中`$.getJSON()`。

```
function GetUserItem() {

    $.getJSON('/controllers/User/', function (result) {

        var root = $.parseJSON(result);
        var user = root["root"];

        $.each(user, function (i, item) {
            $('#user-container').append('<div style="border-bottom: 1px solid black; height:25px;">Id: ' + item.uid + '<br/>' + '</div>');
            $('#user-container').append('<div style="border-bottom: 1px solid black; height:25px;">Username: ' + item.username + '<br/>' + '</div>');
            $('#user-container').append('<div style="border-bottom: 1px solid black; height:25px;">Name: ' + item.first_name + " " + item.last_name + '<br/>' + '</div>');
            $('#user-container').append('<div style="border-bottom: 1px solid black; height:25px;">Birthday: ' + item.birthday + '<br/>' + '</div>');
            $('#user-container').append('<div style="border-bottom: 1px solid black; height:125px;">Profile Pic: <img alt="' + item.username + '" src="' + item.pic_small + '" /><br/>' + '</div>');
        });

        GetMoreFeedItems();    

    });

} 
```

# android - layout_weight 如何让小部件消失？

> ID：11369416
> 
> 赞同：0
> 
> 时间：2012-07-06T20:42:33.600
> 
> 标签：android, android-layout, android-linearlayout, android-layout-weight

我将 LinearLayouts 嵌套在“主布局”中，其宽度设置为`fill_parent`，高度设置为`0dp`.

Master 的权重总和为 100，垂直方向，我有嵌套布局及其各自的权重。目标是分割垂直空间，但它们都消失了。我究竟做错了什么？

这是XML，我只应用`weight/layouts`了前几个。

```
<?xml version="1.0" encoding="UTF-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/LinearLayout02"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" 
android:weightSum="100">

<LinearLayout
    android:id="@+id/LinearLayout03"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="20" >

<ImageView
    android:id="@+id/terranlogo1"
    android:layout_width="0dp"
    android:layout_height="0dp"
    android:layout_weight="1"
    android:src="@drawable/terranlogo" />

<ImageView
    android:id="@+id/protosslogo1"
    android:layout_width="0dp"
    android:layout_weight="1"
    android:layout_height="0dp"
    android:src="@drawable/protosslogo" />

<ImageView
    android:id="@+id/zerglogo1"
    android:layout_width="0dp"
    android:layout_height="0dp"
    android:layout_weight="1"
    android:src="@drawable/zerglogo" />
</LinearLayout>

    <LinearLayout
    android:id="@+id/LinearLayout04"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="5" >

<CheckBox
    android:id="@+id/ck_t1"
    android:layout_width="0dp"
    android:layout_height="0dp" />

<CheckBox
    android:id="@+id/ck_p1"
    android:layout_width="0dp"
    android:layout_height="0dp"
    android:layout_marginLeft="25dp" />

<CheckBox
    android:id="@+id/ck_z1"
    android:layout_width="0dp"
    android:layout_height="0dp"
    android:layout_marginLeft="25dp" />
 </LinearLayout>

  <LinearLayout
    android:id="@+id/LinearLayout05"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="5" >

<ImageView
    android:id="@+id/terranlogo2"
    android:layout_width="0dp"
    android:layout_height="0dp"
    android:layout_weight="1"
    android:src="@drawable/terranlogo" />

<ImageView
    android:id="@+id/protosslogo2"
    android:layout_width="0dp"
    android:layout_height="0dp"
    android:layout_weight="1"
    android:src="@drawable/protosslogo" />

<ImageView
    android:id="@+id/zerglogo2"
    android:layout_width="0dp"
    android:layout_height="0dp"
    android:layout_weight="1"
    android:src="@drawable/zerglogo" />
 </LinearLayout>

<CheckBox
    android:id="@+id/ck_t2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" />

<CheckBox
    android:id="@+id/ck_p2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="25dp" />

<CheckBox
    android:id="@+id/ck_z2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="25dp" />

<TextView
    android:id="@+id/textView4"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_marginRight="18dp"
    android:layout_marginTop="17dp"
    android:gravity="center_vertical|center_horizontal"
    android:text="Choose your opponets race(s) and your race(s)"
    android:textSize="30dp" />

<TextView
    android:id="@+id/textView3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Game Length"
    android:textSize="15dp" />

<Spinner
    android:id="@+id/s_answertime"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
 />

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:gravity="center_horizontal"
    android:text="Mistakes Allowed"
    android:textSize="15dp" />

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Answer Time"
    android:textSize="15dp" />

<Spinner
    android:id="@+id/s_mistakenumber"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
 />

<Spinner
    android:id="@+id/s_gametime"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
 />
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:57:10.230

这是如何平均分配可用空间的方法

```
<LinearLayout 
        xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1.0"
        android:orientation="horizontal" >

        <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Text1"/>
    </LinearLayout>
    <LinearLayout 
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:layout_weight="1.0">
        <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Text2"/>
    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1.0"
        android:orientation="horizontal" >

        <TextView android:layout_width="wrap_content" android:layout_height="wrap_content" android:text="Text3"/>
    </LinearLayout>

</LinearLayout> 
```

# c - 使用 scanf() 输入一个整数的平方

> ID：11369418
> 
> 赞同：0
> 
> 时间：2012-07-06T20:42:39.690
> 
> 标签：c, scanf

我正在编写 ac 项目，需要用户输入 N*N 平方整数：也就是说输入 N 行 N 整数。该算法工作正常。

现在我希望用户输入 N 行，每行 N 个整数，每个连续的整数都用空格分隔。在这里，我没有正确使用 scanf，因为我试图声明整数数组但我无法处理间距。

我尝试过这样的事情，非常不自然并且失败了：

```
int i=0;
int j=0;

int N;
scanf("%d",&N);

char c[N][2*N-1];

while(i < N){
    scanf("%s",&c[i]);
    i++;
}

i=0;
j=0;
while (i<N){
    while (j<N){
        c[i][j]=c[i][2*j]-48;
        j++;
    }
    j=0;
    i++;
} 
```

有人可以帮忙吗？

最好的，纽本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:05:08.883

如果我理解您的原始代码应该做什么，那么这段代码应该真正做到（并再次打印出来以证明它有效）。

您需要动态分配数组，因为它是可变大小的（在 C99 中，您可以在堆栈上使用可变大小的数组，但这确实是一个不同的讨论）。

scanf 将自动忽略整数之间的空格（包括空格和换行符），因此您无需手动解析。

```
#include <stdlib.h>
#include <stdio.h>

int main()
{
    int i=0, j=0, N;
    int **c;

    scanf("%d",&N);

    c = malloc(N*sizeof(int*));

    for (i=0;i<N;i++)
    {
        c[i] = malloc(N*sizeof(int));
        for (j=0;j<N;j++)
        {
            scanf("%d",&c[i][j]);
        }
    }

    for (i=0;i<N;i++)
    {
        for (j=0;j<N;j++)
        {
            printf("%d ",c[i][j]);
        }
        printf("\n");
        free(c[i]);
    }
    free(c);
    return 0;
 } 
```

为了完整性而没有 malloc/free 的 C99 替代方案（我从不喜欢这个 C99 功能，因为无法检查堆栈上的空间是否足够）：

```
#include <stdlib.h>
#include <stdio.h>

int main()
{
    int i=0, j=0, N;

    scanf("%d",&N);

    int c[N][N];

    for (i=0;i<N;i++)
    {
        for (j=0;j<N;j++)
        {
            scanf("%d",&c[i][j]);
        }
    }

    for (i=0;i<N;i++)
    {
        for (j=0;j<N;j++)
        {
            printf("%d ",c[i][j]);
        }
        printf("\n");
    }
    return 0;
 } 
```

# c# - 如何删除选定的文档。评论

> ID：11369426
> 
> 赞同：0
> 
> 时间：2012-07-06T20:43:48.700
> 
> 标签：c#, ms-word, comments, vsto

Word 文档中有一些注释。突出显示一个后，我想删除它。我可以循环浏览所有评论。如何知道选择了哪个评论？我在下面写了代码，但`document.Comments[i].Reference.Start`似乎并不存在。

```
MSWord.Document document = ThisDocument.Instance.InteropDocument;
try
{
    DocumentProtector.Unprotect(document);
    for (int i=1; i<=document.Comments.Count; i++)
    {
        MSWord.Range r = document.Comments[i].Reference;
        if (document.Application.Selection.Range.Start == document.Comments[i].Reference.Start)
            document.Comments[i].Delete();
    }
}
finally
{
    DocumentProtector.Protect(document);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T10:31:12.067

使用[`Range.InRange`](http://msdn.microsoft.com/en-us/library/ff822960)方法：

> 如果应用该方法的范围包含在 Range 参数指定的范围内，则返回 True。

# php - if/else if/else 对数据库的查询结果为假。

> ID：11369430
> 
> 赞同：0
> 
> 时间：2012-07-06T20:44:06.070
> 
> 标签：php, mysql, if-statement

我有一个带有 All 选项的选择框，然后是用户列表。

我正在努力创造这样的东西。除了尝试查询数据库以检查变量是否在数据库中之外，我拥有其中的大部分内容。

```
 if ($variable == 'All') { code here }

   else if ($variable != 'ALL' != *[result in database]*) { code here }

   else { code here } 
```

除了尝试查询数据库以检查变量是否在数据库中之外，我拥有其中的大部分内容。

关于如何在 if 语句中加入对 mySQL 数据库的查询的任何建议。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:49:57.253

```
if ($variable == 'All') {
 ... do something ...
} else {
   $sql = "SELECT ...";
   $result = mysql_query($sql) or die(mysql_error());
   $row = mysql_fetch_assoc($result);
   if ($row['somefield'] == 'whatever') {
       ... do something else ...
   } else {
       ... do something even "elser" ...
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T20:49:11.170

你不能使用这样的运算符。

代替：

```
else if ($variable != 'ALL' != *[result in database]*) { code here } 
```

和：

```
else if ($variable != 'ALL' AND $variable != *[result in database]*) { code here } 
```

# javascript - Node.js - 确保非阻塞调用完成

> ID：11369436
> 
> 赞同：2
> 
> 时间：2012-07-06T20:45:53.970
> 
> 标签：javascript, node.js, postgresql, dom-events, flow-control

我正在使用`pg`postgres 节点模块与我的数据库进行交互。当我使用`pg`事件 API 时，代码可以正常工作。下面是代码示例：

**迁移.js**

```
 exports.up = function(logger){
    var pg = require("pg")
        , connectionString = //process.env.CONNECTIONSTRING
        , client = new pg.Client(connectionString);

    client.connect();

    var cmd = "CREATE TABLE users( "
                + "id SERIAL NOT NULL, "
                + "firstName VARCHAR(50) NOT NULL, "
                + "lastName VARCHAR(50) NOT NULL, "
                + "CONSTRAINT pk_userid PRIMARY KEY (id) "
                + ")";

    var query = client.query(cmd);

    query.on("end", function(){
        client.end();
            logger.log("complete");
    });
}; 
```

我正在使用command.js 围绕这个迁移脚本编写[命令](https://github.com/visionmedia/commander.js)行实用程序；但是，该片段的非阻塞调用`pg`正在释放命令行界面脚本以在数据库更新完成之前完成。下面是一个示例指挥官片段：

**MyCliTool**

```
var program = require('commander');

program
    .version('1.0.2');

program
    .command("up")
    .description("Migrates up")
    .action(function(){
        require("../src/migration").up();
    });

// Additional code removed for brevity 
```

有没有办法可以更改迁移（或`commander.js`应用程序）脚本以确保迁移的`up()`功能将在我的 cli 脚本完成之前完成？我尝试过使用回调，但这似乎不起作用。

**UPDATE** 另一个例子来说明这一点。`mocha`以下是有关该问题的单元测试（用 编写）。

**up-test.js**

```
describe("feature", function(){
    it("should finish", function(){
        var logger = {};
        var finished = false;
        logger.log = function(){finished = true;};

        var migration = require("../src/migration.js");
        migration.up(logger);
        assert(finished, "function didn't finish"); // finished is false when this gets called.
    });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T21:57:39.393

看起来您的原始脚本有一个痛点`program.action(function () {});`：

```
program
    .command("up")
    .description("Migrates up")
    .action(function(){
        require("../src/migration").up();

        // nothing preventing this function from exiting immediately
    }); 
```

我在 command.js 文档中浏览了一下，找不到任何关于为您的`.action()`程序提供回调的信息。如果我正在编写它，代码将如下所示：

```
program
    .command("up")
    .description("Migrates up")
    .action(function (completedCallback) {

        require("../src/migration").up(function () {
            // migration is complete
            completedCallback();
        });

    }); 
```

不过，您与 postgre 相关的脚本看起来不错。一个有点不相关的注释可能是`require("../src/migration").up();`返回一个实例`require("events").EventEmitter`并发出您想要查看的事件，而不是使用`logger`变量。但这只是偏好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T04:39:36.373

尝试设置计时器（http://nodejs.org/api/timers.html）。我们在 Azure CLI 工具中执行此操作，以便在您执行长时间运行的操作时运行微调器。

您可以在此处深入研究代码以了解我们是如何做到的：[https](https://github.com/WindowsAzure/azure-sdk-for-node/blob/master/lib/cli/cli.js) ://github.com/WindowsAzure/azure-sdk-for-node/blob/master/lib/cli/cli.js 。搜索 progress() 函数。

# asp.net-web-api - 内容协商能否用于控制 ASP.NET WebApi 中的返回类型？

> ID：11369441
> 
> 赞同：1
> 
> 时间：2012-07-06T20:46:17.770
> 
> 标签：asp.net-web-api

我们正在构建一个其 GET 方法返回 DTO 的 web api。我们希望构建它，以便在某些情况下，这些 DTO 被剥离了不必要的属性，以控制向下发送到客户端的数据量。例如，当我们返回一封电子邮件 DTO 时，我们有时希望客户指定它只需要主题、日期和 ID，而不需要电子邮件的正文。当然，在其他情况下，需要电子邮件的正文。

MVC WebApi 中执行此操作的最佳方法是什么？我研究了 MediaTypeFormatters，但他们似乎专注于数据的格式（JSONP、XML）而不是内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T14:40:22.583

在我看来，你想要一个自定义的媒体类型。

这可以与自定义 MediaTypeFormatter 结合使用。

例如，您可以定义自己的媒体类型（这是一个*不好*的名称示例）：

```
application/vnd.me-shortform 
```

然后，在您的代码中，您可以省略填写电子邮件正文并让默认格式化程序格式化您的结果。

或者您可以编写自己的 MediaTypeFormatter（继承现有的）并将其注册为您的自定义媒体类型。

然后，在 MediaTypeFormatter 中，您可以通过 DTO 上的属性或类似的方式确定电子邮件正文不是必需的，并省略将其作为结果的一部分。

[供应商媒体类型上的 Mark Seeman](http://blog.ploeh.dk/2012/04/24/VendorMediaTypesWithTheASPNETWebAPI.aspx)应该给你一个很好的起点。

# database - Drupal 7 数据库查询

> ID：11369447
> 
> 赞同：3
> 
> 时间：2012-07-06T20:46:49.323
> 
> 标签：database, drupal-7

我想要做的完美小模块是为drupal 6制作的，但令我沮丧的是它在drupal 7上不起作用。我了解到drupal 7有一个用于数据库的新api。我试图让它发挥作用，但我承认我在这里不合群。我希望有人能给我一点指导。特别是 db_query。

```
function webform_image_validation_webform_validation_validate($validator_name, $items,   
$components, $rule) {
$errors = array();
if ($items) {
switch ($validator_name) {
  case 'max_image_size':
    $dimensions = explode('x', $rule['data']);
    foreach ($items as $key => $val) {
      if (is_numeric($val['_fid'])) {
        $result = db_query("select * from {files} where fid = %d", $val['_fid']);
        while ($data = db_fetch_object($result)) {
          $thefile = $data;
        }
        $image_info = image_get_info($thefile->filepath);
        if (webform_image_validation_validate_image($image_info, $dimensions[0], $dimensions[1], FALSE) === FALSE) {
          $errors[$key] = t('Your image did not match the required width and/or height. (') . $dimensions[0] . t(' x ') . $dimensions[1] . t(')');
        }
      }
    } 
```

这是我收到的错误。

```
Argument 2 passed to db_query() must be an array, string given, called in
/home/designco/public_html/dev/sites/all/modules/webform_image_validation/
webform_image_validation.module on line 69 and defined in
/home/designco/public_html/dev/includes/database/database.inc on line 2310 
```

看来我需要添加一个数组，但我迷路了。任何帮助，将不胜感激。我只是想知道我是否走对了路。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-07T06:49:08.140

db_query 在 Drupal7 中的工作方式不同。

```
 $result = db_query("select * from {files} where fid = %d", $val['_fid']);
while ($data = db_fetch_object($result)) {
  $thefile = $data;
} 
```

``becomes`

```
 $results = db_query("select * from {files} where fid = :fid", array(':fid' => $val['_fid']));
foreach($results as $result) {
  // Do your thing for each result.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T21:40:42.187

尝试改变

```
$result = db_query("select * from {files} where fid = %d", $val['_fid']);
while ($data = db_fetch_object($result)) {
  $thefile = $data;
} 
```

到

```
$query = db_select('files', 'f')
  ->fields('f')
  ->condition('fid', $val['_fid']);
$thefile = $query->execute()->fetchObject(); 
```

Drupal 7 数据库 API 文档[http://drupal.org/node/310069](http://drupal.org/node/310069)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-31T20:09:56.743

谢谢你`JurgenR`的回答。

再补充一件事：在 drupal 6 中，我们使用 '%s' 作为字符串。在 drupal 7 中，对所有人都是一样的。例如：

```
$results = db_query("select * from {files} 
where filename = :fname", array(':fname' => $filename)); 
```

如果要搜索以**模式**开头的记录，则查询将是：

```
$results = db_query("select * from {files} 
where filename = :fname", array(':fname' => $filename.'%')); 
```

希望这是有用的。`

# iphone - UIAutomation：无法授权权限，状态：-60007

> ID：11369449
> 
> 赞同：4
> 
> 时间：2012-07-06T20:46:55.240
> 
> 标签：iphone, objective-c, xcode, ui-automation

所以我`UIAutomation`在命令行上运行

```
$ instruments -t /Developer/Platforms/iPhoneOS.platform/Developer/Library/Instruments/PlugIns/AutomationInstrument.bundle/Contents/Resources/Automation.tracetemplate 
<path-to-your-app>/<appname>.app/ -e UIASCRIPT <path-to-your-js-test-file> -e 
UIARESULTSPATH <path-to-results-folder> 
```

这工作正常，模拟器打开，应用程序运行，但遇到此错误。

```
Failed to authorize rights (0x2) with status: -60007 
```

我相信这与权限有关。

我该怎么做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-10T20:03:46.933

这就是我通过命令行在 Instruments 上发布的答案[- jenkins](https://stackoverflow.com/a/11416025/925622)

这里甚至还有一篇关于[Xcode 命令行授权提示错误的博文](http://www.ama-dev.com/xcode-build-command-line-remove-authorization-prompt-for-uiautomation/)

我将在这里再次解释：

我所做的是以下内容：

*   将 jenkins 用户标记为管理员（不幸的是，似乎没有其他方式 atm）
*   转到**/etc/authorization**
*   搜索密钥**system.privilige.taskport**
*   将 allow-root 的值更改为 true

    ```
    <key>system.privilege.taskport</key>
    <dict>
        <key>allow-root</key>
        <false/> // change to -> <true>
        <key>class</key>
        <string>user</string>
        <key>comment</key>
        <string>Used by task_for_pid(...).
        ...
    </dict> 
    ```

现在我可以使用 jenkins 通过命令行脚本运行我的 UIAutomation-Tests

**编辑**

为了让詹金斯识别成功的构建，我没有完美的解决方案，但有以下解决方法：

```
...
echo "Run instruments simulator"

instruments -t "$ORDER_AUTOMATION_TEST_TEMPLATE_PATH" "$FILE_DEBUG_APP" -e UIASCRIPT "$ORDER_AUTOMATION_TESTSCRIPT_PATH" -e UIARESULTSPATH "$DIRECTORY_INSTRUMENTS_RESULT"

returnCode=0

if test -a "Run 1/Assertion failed.png"; then
echo "failed"
returnCode=1
else
echo "passed"
returnCode=0
fi

rm -fR "Run 1"

rm -fR "instrumentscli0.trace"

echo "Removing app dir"

echo "$FILE_APPLICATIONS"

rm -fR "$FILE_APPLICATIONS"

echo $returnCode

exit $returnCode 
```

**编辑 2** 检查自动化测试是否成功运行的更好方法：

```
# cleanup the tracefiles produced from instruments
rm -rf *.trace

##kill simulator afterwards
killall "iPhone Simulator"

##check if failures occured
# fail script if any failures have been generated
if [ `grep "<string>Error</string>" "$WORKSPACE/Automation Results/Run 1/Automation Results.plist" | wc -l` -gt 0 ]; then
    echo 'Build Failed'
    exit -1
else
    echo 'Build Passed'
    exit 0
fi 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-21T11:26:46.947

这可以帮助小牛队和优胜美地：（基于亚历山大的回答）

`$ security authorizationdb write system.privilege.taskport allow`

# heroku - “heroku ps”显示没有进程正在运行

> ID：11369454
> 
> 赞同：4
> 
> 时间：2012-07-06T20:47:17.747
> 
> 标签：heroku

似乎是一个简单的问题，但我在任何地方都没有找到答案。跑步`heroku ps`什么都没有。`heroku restart`成功执行。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-06T21:28:11.660

您是否尝试过扩展您的一种流程类型？例如`heroku ps:scale web=1`

请参阅[https://devcenter.heroku.com/articles/scaling](https://devcenter.heroku.com/articles/scaling)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-01T12:42:17.640

我犯了一个愚蠢的错误。我正在使用

heroku run ps （因为我使用了其他命令作为“运行”）

代替

heroku ps。（ps 是 heroku 命令而不是系统命令）。

删除运行解决了这个问题。谢谢。

# sql - Oracle/SQL - 多连接优化

> ID：11369458
> 
> 赞同：1
> 
> 时间：2012-07-06T20:47:35.937
> 
> 标签：sql, oracle, left-join, inner-join, self-join

我试图解决这个多连接问题，我有两个表

```
INTERESTED_IN
email           item
-----------------------
bob@email.com   widgetA
karen@email.com widgetA
karen@email.com widgetB
sue@email.com   widgetC
tony@email.com  widgetA
tony@email.com  widgetB
tony@email.com  widgetC

PURCHASED
email           item
-----------------------
bob@email.com   widgetA
karen@email.com widgetA
tony@email.com  widgetB
julie@email.com widgetC 
```

**目标：**返回存在于interested_in 表和购买表中的人的电子邮件和项目，但只返回不在购买表中的项目。所以结果表会像这样

```
email           item
-----------------------
karen@email.com widgetB
tony@email.com  widgetA
tony@email.com  widgetC 
```

从概念上讲，我知道如何做到这一点，但由于数据集可能非常大，我很难找到最有效的方法来做到这一点。有人可以告诉我最好的方法来做到这一点。

谢谢！

* * *

更新

```
SELECT email, item
FROM (
    SELECT i.email, i.item
    FROM interested_in i
    INNER JOIN purchased  p ON i.email = p.email
    ) 

MINUS

SELECT email, item
FROM purchased 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:00:37.713

啊，我想念苏。因此，您需要`INTERESTED_IN`表中电子邮件存在于表中的所有行，`PURCHASED`而不是表中同时存在`EMAIL`和的行。 `ITEM``PURCHASED`

最明显的方法是这样的，尽管它需要`PURCHASED`两次击球。

```
SELECT email, item
  FROM interested_in i
 WHERE EXISTS( SELECT 1
                 FROM purchased p
                WHERE i.email = p.email )
   AND NOT EXISTS( SELECT 1
                     FROM purchased p
                    WHERE i.email = p.email
                      AND i.item  = p.item ) 
```

或者

```
SELECT email, item
  FROM interested_in i
 WHERE EXISTS( SELECT 1
                 FROM purchased p
                WHERE i.email = p.email )
MINUS
SELECT email, item
  FROM purchased 
```

我强烈打赌有一个聪明的方法可以做到这一点，而只打`PURCHASED`一次，尽管这种方法对我来说并不是很明显。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T00:22:58.100

应该不会比上面的好...

```
select
  a.*
from
  interested_in a
  inner join (
    select distinct
      x.email
    from 
      interested_in x
      inner join purchased y
        on x.email = y.email
    ) valid_emails
    on valid_emails.email = a.email 
  left join purchased b
    on a.email = b.email
    and a.item = b.item
where
  b.email is null
; 
```

结果：

```
EMAIL           ITEM
tony@email.com  widgetA
tony@email.com  widgetC
karen@email.com widgetB 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T21:07:28.283

减法应该更有效。第三种方式完全加入其中购买。项目为空

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T01:18:56.193

您需要从对感兴趣的表中选择所有内容，并使用左连接过滤掉人们已经购买的商品。

```
select * from 
   INTERESTED_IN I left join PURCHASED P 
   on I.EMAIL=P.EMAIL and I.ITEM=P.ITEM
where P.EMAIL is null 
```

代表上述查询的中间表是：

```
I.EMAIL         I.ITEM   P.EMAIL         P.ITEM
------------------------------------------------
bob@email.com   widgetA  bob@email.com   widgetA
karen@email.com widgetA  karen@email.com widgetA
karen@email.com widgetB  
sue@email.com   widgetC
tony@email.com  widgetA
tony@email.com  widgetB  tony@email.com  widgetB
tony@email.com  widgetC 
```

# sql - 连接三个表时如何检索不重复的值或空值？

> ID：11369462
> 
> 赞同：0
> 
> 时间：2012-07-06T20:47:41.560
> 
> 标签：sql, sql-server, tsql

从以下三个表中，我需要：

1.  为 People 中的每条记录返回一行，如果他们有多个关联联系人，则不要复制该人。
2.  包括关联的 ContactValue，其中 ContactType 为 HOMEPHONE，日期范围的开始时间早于现在，日期范围的结束时间晚于现在或为空。如果一个人没有家庭电话，仍然显示该人，但显示 NULL 作为 ContactValue 的值。

## 人们

PersonId (PK, int)
全名 (nvarchar)

## 人员联系方式

PersonId (PK, int)
ContactId (PK, int)
StartValidDate (PK, datetime)
EndValidDate (datetime, null)

## 联系人

ContactId (PK, int)
ContactType (nvarchar)
ContactValue (nvarchar)

*People*表包含唯一的人员列表 。*PeopleContacts*可能包含每个人、不同联系人类型的多个联系人关联，以及联系人适合的日期范围。 *联系人*包含特定类型的联系人值列表。例如，“WORKPHONE”的 ContactType 和“(555) 555 5555”的 ContactValue。

要求：

1.  为 People 中的每条记录返回一行，如果他们有多个关联联系人，则不要复制该人。
2.  包括关联的 ContactValue，其中 ContactType 为 HOMEPHONE，日期范围的开始时间早于现在，日期范围的结束时间晚于现在或为空。如果一个人没有家庭电话，仍然显示该人，但显示 NULL 作为 ContactValue 的值。

如果 People 包含三行，其中：

```
1     Jones, Bob
2     Smith, Bob
3     Smith, Fred 
```

PeopleContacts 包含四行，其中：

```
1     4    01/01/2012     NULL
2     1    01/01/2012     02/01/2012
2     2    02/02/2012     NULL
3     3    01/01/2012     NULL
3     4    01/01/2012     NULL 
```

并且联系人包含四行，其中：

```
1     HOMEPHONE     (555) 555 5252
2     HOMEPHONE     (666) 666 6666
3     HOMEPHONE     (777) 777 7777
4     WORKPHONE     (555) 555 5555 
```

正确查询的输出（如果在 2012 年 2 月 2 日之后运行）应如下所示：

```
FullName     ContactValue
--------     ------------
Jones, Bob   NULL
Smith, Bob   (666) 666 6666
Smith, Fred  (777) 777 7777 
```

Jones，Bob 与联系人有关联，但它与 WORKPHONE 关联，因此 ContactValue 应为 NULL。Smith, Bob 与两条 HOMEPHONE 记录有关联，但只有一条 (666) 666 6666 仍然具有有效的日期范围。Smith, Fred 与 HOMEPHONE 和 WORKPHONE 都有关联。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:48:13.207

我会使用公用表表达式来解决这个问题 - 这应该比使用将为每一行评估的 APPLY 更有效。使用 CTE，您将只获得一个结果集，然后对其进行左外连接。

我会使用 RANK 来确保您只得到一个联系人……通过订购 CTE 并按第一名加入 CTE，您只会得到一个联系人。

SQL 看起来像这样：

```
WITH [CTE] AS (
SELECT
        pc.PersonId
    ,   pc.ContactValue
    ,   RANK() OVER (PARTITION BY PersonId ORDER BY ContactValue DESC) AS [Seed]
FROM
    PeopleContacts pc
    INNER JOIN  Contacts c ON (pc.ContactId = c.ContactId AND c.ContactType='HOME')
    WHERE pc.StartValidDate <= GETDATE()
    AND (pc.EndValidDate > GETDATE() OR pc.EndValidDate IS NULL)
)

SELECT      FullName
        ,   ISNULL(CTE.ContactValue, '') 
FROM People p
LEFT OUTER JOIN CTE ON (CTE.PersonId = p.PersonID AND CTE.Seed = 1) 
```

（此代码未经测试，如果您设置了一个[sql fiddle](http://sqlfiddle.com)，那么我很乐意让它工作）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T20:50:47.440

我相信以下查询可以满足我的需要，但我希望获得反馈或更好的方法来执行此操作：

```
SELECT FullName, c.ContactValue FROM People p
OUTER APPLY
    (
    SELECT TOP 1 ContactValue FROM PeopleContacts pc 
    LEFT OUTER JOIN Contacts c ON pc.ContactId = c.ContactId AND c.ContactType='HOME'
    WHERE pc.PersonId = p.PersonId
    AND pc.StartValidDate <= GETDATE()
    AND (pc.EndValidDate > GETDATE() OR pc.EndValidDate IS NULL)
    ORDER BY ContactValue DESC) c 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T21:39:24.140

以下代码似乎正确：

```
declare @tPeoples table (
    id int,
    name nvarchar(50)
)

declare @tContacts table (
    id int,
    type char(10),
    value nvarchar(50)
)

declare @tPeopelContact table (
    peopleId int,
    contactId int,
    starting datetime2,
    ending datetime2
)

insert into @tPeoples (id, name) values
(1, 'Jones, Bob'),
(2, 'Smith, Bob'),
(3, 'Smith, Fred')

insert into @tContacts (id, type, value ) values
(1,     'HOMEPHONE',  '(555) 555 5252'),
(2,     'HOMEPHONE',  '(666) 666 6666'),
(3,     'HOMEPHONE',  '(777) 777 7777'),
(4,     'WORKPHONE',  '(555) 555 5555'),
(5,     'HOMEPHONE',  '(000) 123 5252')

insert into @tPeopelContact (peopleId, contactId, starting, ending) values
(1,     4,    '20120101',    NULL),
(2,     1,    '20120101',   '20120201'),
(2,     2,    '20120201',     NULL),
(3,     3,    '20120101',     NULL),
(3,     4,    '20120101',     NULL)

declare @currentdate datetime
declare @type char(10)

set @currentdate = '20120202'
set @type = 'HOMEPHONE'

select
    p.name, vc.value
from
    @tPeoples p
    left join 
        (select
            ROW_NUMBER () over (partition by peopleId order by starting) as rn, *
        from
            @tPeopelContact pc
            join @tContacts c on pc.contactId = c.id
        where 
            type = @type and
            starting < @currentdate and ( ending is null or ending >= @currentdate) 
        ) vc on rn = 1 and vc.peopleId = p.id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T07:38:52.433

以下查询似乎正确：

```
SELECT A.FullName, B.ContactValue
FROM People A
LEFT JOIN ( SELECT  X.PersonId,
                    Y.ContactValue,
                    ROW_NUMBER() OVER (PARTITION BY X.PersonId ORDER BY ContactId ) AS RowNumber
            FROM PeopleContacts X
            LEFT JOIN Contacts Y ON Y.ContactId = X.ContactId 
        ) B ON B.PersonId = A.PersonId AND B.RowNumber = 1 
```

# android - Android弹出窗口不显示内容

> ID：11369463
> 
> 赞同：0
> 
> 时间：2012-07-06T20:47:41.787
> 
> 标签：android, layout, view, popup

选择某些内容后，我试图在表格中显示一个弹出窗口显示结果。下面是我的弹出窗口的 .xml 和我用来尝试将其拉起的代码。问题是当它弹出时，它只显示一个黑框，而不是其余的内容。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/outerwindow"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:paddingTop="80dp"
android:gravity="center"
android:background="#000000"
android:baselineAligned="true"
>

<TextView
    android:id="@+id/insert"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center_horizontal"
    android:background="@drawable/rectangle"
    android:gravity="top"
    android:padding="7dp"
    android:text="@string/insert" />

<LinearLayout
    android:id="@+id/window"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:baselineAligned="true"
    android:orientation="horizontal"
    android:layout_marginTop="30dp"
    android:weightSum="10" >

    <FrameLayout
        android:layout_width="0dp"
        android:layout_height="fill_parent"
        android:layout_marginLeft="20dp"
        android:layout_weight="2" >

        <LinearLayout
            android:id="@+id/material"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:baselineAligned="false"
            android:orientation="vertical"
            android:weightSum="6" >

            <ImageButton
                android:id="@+id/close"
                android:layout_width="wrap_content"
                android:layout_height="33dp"
                android:layout_gravity="center"
                android:contentDescription="@string/back_arraw"
                android:scaleType="centerCrop"
                android:src="@android:drawable/ic_menu_revert" />

            <TableRow
                android:id="@+id/pRow0"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight="1"
                android:background="#3b7fcc"
                android:baselineAligned="true" >

                <TextView
                    android:id="@+id/p0"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:gravity="center"
                    android:text="@string/p"
                    android:textColor="#b0b0b0"
                    android:textSize="27dp" />
            </TableRow>

            <TableRow
                android:id="@+id/mRow0"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight="1"
                android:background="#ffff57"
                android:baselineAligned="false" >

                <TextView
                    android:id="@+id/m0"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:gravity="center"
                    android:text="@string/m"
                    android:textColor="#b0b0b0"
                    android:textSize="27dp" />
            </TableRow>

            <TableRow
                android:id="@+id/kRow0"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight="1"
                android:background="#cc3333"
                android:baselineAligned="false" >

                <TextView
                    android:id="@+id/k0"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:gravity="center"
                    android:text="@string/k"
                    android:textColor="#b0b0b0"
                    android:textSize="27dp" />
            </TableRow>

            <TableRow
                android:id="@+id/nRow0"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight="1"
                android:background="#356638"
                android:baselineAligned="false" >

                <TextView
                    android:id="@+id/n0"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:gravity="center"
                    android:text="@string/n"
                    android:textColor="#b0b0b0"
                    android:textSize="27dp" />
            </TableRow>

            <TableRow
                android:id="@+id/sRow0"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight="1"
                android:background="#ff8936"
                android:baselineAligned="false" >

                <TextView
                    android:id="@+id/s0"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:gravity="center"
                    android:text="@string/s"
                    android:textColor="#b0b0b0"
                    android:textSize="27dp" />
            </TableRow>

            <TableRow
                android:id="@+id/hRow0"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight="1"
                android:background="#898989"
                android:baselineAligned="false" >

                <TextView
                    android:id="@+id/h0"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:gravity="center"
                    android:text="@string/h"
                    android:textColor="#b0b0b0"
                    android:textSize="27dp" />
            </TableRow>
        </LinearLayout>
    </FrameLayout>

    <TabHost
        android:id="@+id/tabhost"
        android:layout_width="0dp"
        android:layout_height="fill_parent"
        android:layout_marginRight="20dp"
        android:layout_weight="8">

        <LinearLayout
            android:id="@+id/linearLayout1"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:baselineAligned="false"
            android:orientation="vertical" >

            <TabWidget
                android:id="@android:id/tabs"
                android:layout_width="fill_parent"
                android:layout_height="33dp"
                android:layout_gravity="top" />

            <FrameLayout
                android:id="@android:id/tabcontent"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent" >

                <LinearLayout
                    android:id="@+id/tab3"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:baselineAligned="false"
                    android:orientation="vertical"
                    android:weightSum="6" >

                    <TableRow
                        android:id="@+id/pRow3"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#3b7fcc"
                        android:baselineAligned="true" >

                        <TextView
                            android:id="@+id/p3"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/mRow3"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#ffff57"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/m3"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/kRow3"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#cc3333"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/k3"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/nRow3"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#356638"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/n3"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/sRow3"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#ff8936"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/s3"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/hRow3"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#898989"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/h3"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>
                </LinearLayout>

                <LinearLayout
                    android:id="@+id/tab2"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:baselineAligned="false"
                    android:orientation="vertical"
                    android:weightSum="6" >

                    <TableRow
                        android:id="@+id/pRow2"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#3b7fcc"
                        android:baselineAligned="true" >

                        <TextView
                            android:id="@+id/p2"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/space"
                        android:layout_width="fill_parent"
                        android:layout_height="1dp"
                        android:baselineAligned="true" />

                    <TableRow
                        android:id="@+id/mRow2"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#ffff57"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/m2"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/kRow2"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#cc3333"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/k2"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/nRow2"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#356638"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/n2"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/sRow2"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#ff8936"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/s2"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/hRow2"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#898989"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/h2"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>
                </LinearLayout>

                <LinearLayout
                    android:id="@+id/tab1"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:baselineAligned="false"
                    android:orientation="vertical"
                    android:weightSum="6" >

                    <TableRow
                        android:id="@+id/pRow1"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#3b7fcc"
                        android:baselineAligned="true" >

                        <TextView
                            android:id="@+id/p1"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/mRow1"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#ffff57"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/m1"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/kRow1"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#cc3333"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/k1"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/nRow1"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#356638"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/n1"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/sRow1"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#ff8936"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/s1"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>

                    <TableRow
                        android:id="@+id/hRow1"
                        android:layout_width="fill_parent"
                        android:layout_height="0dp"
                        android:layout_weight="1"
                        android:background="#898989"
                        android:baselineAligned="false" >

                        <TextView
                            android:id="@+id/h1"
                            android:layout_width="fill_parent"
                            android:layout_height="fill_parent"
                            android:gravity="center"
                            android:text=""
                            android:textColor="#000000"
                            android:textSize="17dp" />
                    </TableRow>
                </LinearLayout>
            </FrameLayout>
        </LinearLayout>
    </TabHost>
</LinearLayout>
</LinearLayout> 
```

我的主要代码：

```
inflater = (LayoutInflater) this.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    popView = inflater.inflate(R.layout.popup, (ViewGroup) findViewById(R.id.outerwindow));
    popup = new PopupWindow(popView,100,100, true);
    popup.setBackgroundDrawable(new BitmapDrawable()); 
```

后来我用这个命令把它调出来

```
popup.showAtLocation(findViewById(R.id.primary), Gravity.CENTER, 0, 0); 
```

显然我的主屏幕的 ID 被称为主屏幕，当弹出窗口出现时，它只是屏幕中心的一个黑色方块（因为我用黑色看到它实际弹出）并在它外面单击使其消失. 这正在成为一个非常烦人的问题，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T13:14:25.730

是的...所以您可以在上面看到我的窗口只有 100x100...这就是内容为空白的原因...我只显示了第一个 100x100 大声笑。对不起大家笨。我花了好几个小时才意识到这一点。

# java - Spring Security 配置导致重定向循环

> ID：11369467
> 
> 赞同：1
> 
> 时间：2012-07-06T20:48:12.947
> 
> 标签：java, spring, spring-mvc, spring-security

我最近开始学习 Spring Security 并尝试将其整合到我现有的 Web 应用程序中。该应用程序的配置很简单，所以我很困惑我在哪里搞砸了。

我的 web.xml

```
<!-- FilterChain proxy for security -->
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>

<filter-mapping>
  <filter-name>springSecurityFilterChain</filter-name>
  <url-pattern>/*</url-pattern>
</filter-mapping>

<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/appname-servlet.xml</param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener> 

<servlet>
    <servlet-name>nistreq</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/appname-servlet.xml</param-value>
    </init-param>
</servlet>

<servlet-mapping>
    <servlet-name>appname</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>

<welcome-file-list>
    <welcome-file>mainpage.jsp</welcome-file>
</welcome-file-list> 
```

和 security-config.xml

```
<security:http access-denied-page="/denied.jsp" use-expressions="true">
    <security:form-login login-page="/login.jsp"
        authentication-failure-url="/login.jsp?login_error=true" />     
    <security:intercept-url pattern="/*" access="isAuthenticated()"/>
    <security:logout/>
</security:http> 
```

在我为 springSecurityFilterChain ("/ *")、servlet 映射的 URL 模式 ("/") 和 security:intercept-url 模式 ("/* ") 映射的 URI 之间似乎有一些不好的魔力。这会导致重定向循环。我经历了无数种移动术语的变化，将内容推送到子包中以避免保护应用程序根等。我总是最终得到一个 404 的抓包，一个重定向循环等。

我正在做一些非常愚蠢的事情，并且会欣赏另一双眼睛。感谢您的任何见解...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T20:56:06.123

我相信你只需要为你的登录页面添加一个例外。除了 security-config.xml 中的内容之外，添加以下内容：

```
<security:http pattern="/login.jsp" security="none" /> 
```

无论您尝试访问哪个 URL，它都未经过身份验证，因此它会尝试访问登录页面。但是，这也没有经过身份验证，所以它只是旋转和旋转。您的登录页面需要无需经过身份验证即可访问。

# r - 处理 quantcut() 中的关系

> ID：11369471
> 
> 赞同：1
> 
> 时间：2012-07-06T20:48:28.747
> 
> 标签：r, grouping, quantile

我正在尝试使用 R 函数 quantcut() 将数值变量重新编码为具有对应于分位数的水平的因子。例如：

```
> X
[1]  6  4  9  6  1  2  5  3  5  7 10  7  2  7  7  5  6  6  3  4  6  4  2  7  6  7
[27]  4  3  5  3  7  6  8 12  4  4  0  1  7  6  7  4  7  1  1  1  2  3  3  1  1  6
[53]  5  3  1  1  1  3  3  3  1  1  3  1  1  1  3  3  0  1  3  1  8  5  3  0  0  2
[79]  1  3  8  0  1  4  1  1  1  1  1  1  3  2  1  4  1  5  5 12  7  2  6  6  2  6
[105]  0  1  4  1  4  0  7  3  2  1  1  8  5  5  3  0  5  6  2  4  2  2  2  6  4  2
[131]  2  2  2  6  8  5  1  2  8  3  2  7  4  6  6  6  7  5  1  5  5  6  1  4  4  5
[157]  6  2  4  7  2  4 10  6  3  5  2  2  6  6  2  4  5  7  4  5 11  6  6  8  2  4
[183]  4  6 12 16  9  7 14 13 11  5  5  2  2  7  7  6  4  3  4  3  5  4  5  7  9  4
[209]  3 12  4  4  4  8  7  6  1  3  6  7  5  5  6  9  6  4  7  8  5  6  3  6  4  7
[235]  3  3  4  7  5  7  5  9  5  8  3  4  3  2  5  2  4  3  8  4  2  2  1  5  3  5
[261]  8  5  6  4  5  1  1  2  6  2  7  2  4  4  3  3  4 10  5  6 10  2  5  5  0  1
[287]  6  2  5  4  6  6  9  5  5  6  3  8  1  5  1  8  5  2  5  2  4  2  4  4

bins=10
labels = 1:bins
library(gtools)
x2 = quantcut(X, q = seq(0, 1, by=1/bins), labels=labels) 
```

我收到错误消息：“cut.default 中的错误（x[!flag]，bre​​aks = newquant，include.lowest = TRUE，：'breaks' 不是唯一的”。我认为这是因为分位数中有联系，但是quantcut 的文档专门显示了一个示例，说明该函数如何通过使用更少的间隔来处理关系。无论我是否指定标签参数，都会发生错误。

任何建议将不胜感激。

编辑：这是输入变量 X 的代码：

```
X = c(6L, 4L, 9L, 6L, 1L, 2L, 5L, 3L, 5L, 7L, 10L, 7L, 2L, 7L, 7L, 
5L, 6L, 6L, 3L, 4L, 6L, 4L, 2L, 7L, 6L, 7L, 4L, 3L, 5L, 3L, 7L, 
6L, 8L, 12L, 4L, 4L, 0L, 1L, 7L, 6L, 7L, 4L, 7L, 1L, 1L, 1L, 
2L, 3L, 3L, 1L, 1L, 6L, 5L, 3L, 1L, 1L, 1L, 3L, 3L, 3L, 1L, 1L, 
3L, 1L, 1L, 1L, 3L, 3L, 0L, 1L, 3L, 1L, 8L, 5L, 3L, 0L, 0L, 2L, 
1L, 3L, 8L, 0L, 1L, 4L, 1L, 1L, 1L, 1L, 1L, 1L, 3L, 2L, 1L, 4L, 
1L, 5L, 5L, 12L, 7L, 2L, 6L, 6L, 2L, 6L, 0L, 1L, 4L, 1L, 4L, 
0L, 7L, 3L, 2L, 1L, 1L, 8L, 5L, 5L, 3L, 0L, 5L, 6L, 2L, 4L, 2L, 
2L, 2L, 6L, 4L, 2L, 2L, 2L, 2L, 6L, 8L, 5L, 1L, 2L, 8L, 3L, 2L, 
7L, 4L, 6L, 6L, 6L, 7L, 5L, 1L, 5L, 5L, 6L, 1L, 4L, 4L, 5L, 6L, 
2L, 4L, 7L, 2L, 4L, 10L, 6L, 3L, 5L, 2L, 2L, 6L, 6L, 2L, 4L, 
5L, 7L, 4L, 5L, 11L, 6L, 6L, 8L, 2L, 4L, 4L, 6L, 12L, 16L, 9L, 
7L, 14L, 13L, 11L, 5L, 5L, 2L, 2L, 7L, 7L, 6L, 4L, 3L, 4L, 3L, 
5L, 4L, 5L, 7L, 9L, 4L, 3L, 12L, 4L, 4L, 4L, 8L, 7L, 6L, 1L, 
3L, 6L, 7L, 5L, 5L, 6L, 9L, 6L, 4L, 7L, 8L, 5L, 6L, 3L, 6L, 4L, 
7L, 3L, 3L, 4L, 7L, 5L, 7L, 5L, 9L, 5L, 8L, 3L, 4L, 3L, 2L, 5L, 
2L, 4L, 3L, 8L, 4L, 2L, 2L, 1L, 5L, 3L, 5L, 8L, 5L, 6L, 4L, 5L, 
1L, 1L, 2L, 6L, 2L, 7L, 2L, 4L, 4L, 3L, 3L, 4L, 10L, 5L, 6L, 
10L, 2L, 5L, 5L, 0L, 1L, 6L, 2L, 5L, 4L, 6L, 6L, 9L, 5L, 5L, 
6L, 3L, 8L, 1L, 5L, 1L, 8L, 5L, 2L, 5L, 2L, 4L, 2L, 4L, 4L) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:39:46.053

好的，问题可以追溯到这里，正如你所说，70% 和 80% 的分位数是相同的。`quantile`由内部使用`quantcut`

```
quantile(X,probs=seq(0,1,0.1))
  0%  10%  20%  30%  40%  50%  60%  70%  80%  90% 100% 
 0.0  1.0  2.0  3.0  3.6  4.0  5.0  6.0  6.0  8.0 16.0 
```

我看不出如何使用`quantcut`它自己来解决这个问题，但你总是可以只使用`cut`和组合来解决它`quantile`。`unique`据我所知，`quantcut`无论如何，这就是在内部存在联系时所做的事情。

```
result <- cut(X,unique(quantile(X,probs=seq(0,1,0.1))),include.lowest=TRUE)

> result[2:10]
 [1] (3.6,4] (8,16]  (5,6]   [0,1]   (1,2]   (4,5]   (2,3]   (4,5]   (6,8]  
#Levels: [0,1] (1,2] (2,3] (3,3.6] (3.6,4] (4,5] (5,6] (6,8] (8,16]
> X[2:10]
 [1]      4      9      6       1       2       5       3       5       7 
```

# spring - 在 Spring 中格式化错误消息的正确方法是什么？

> ID：11369473
> 
> 赞同：0
> 
> 时间：2012-07-06T20:48:31.043
> 
> 标签：spring, formatting

我正在使用 Spring 3.1.0.RELEASE。如何在 Spring 中正确格式化错误消息？在我的属性文件中，我有……</p>

```
Incomplete.headers.fileData=The file is missing the following required header(s): %s 
```

然后在我的验证课上，我有

```
public void validate(Object target, Errors errors) {
    ...
    final String missingHeadersStr = Joiner.on(",").join(missingHeaders);
    errors.rejectValue("fileData", "Incomplete.headers.fileData", new Object[] {missingHeadersStr}, "The file is missing some required headers."); 
```

然而，即使（通过调试）我已经验证了“missingHeadersStr”字段是非空的，我的 JSP 上显示的所有内容都是

```
The file is missing the following required header(s): %s 
```

在 Spring 中格式化错误消息的正确方法是什么？对于它的价值，我像这样在 JSP 上显示它们

```
<form:errors path="fileData" cssClass="error" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T21:47:45.393

[文档](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/validation/Errors.html#reject%28java.lang.String,%20java.lang.Object%5B%5D,%20java.lang.String%29)说：

> errorArgs - 错误参数，用于**通过 MessageFormat**进行参数绑定 （可以为 null）

（强调我的）。

您正在提供一个可用于`String.format()`. 但是[MessageFormat](http://docs.oracle.com/javase/6/docs/api/java/text/MessageFormat.html)不使用它。模式应该是：

```
The file is missing the following required header(s): {0} 
```

# android - 如何检测用户何时离开 EditText？

> ID：11369479
> 
> 赞同：0
> 
> 时间：2012-07-06T20:48:51.803
> 
> 标签：android

我希望 EditText 在用户触摸 Activity 中的其他 UI 元素（如复选框）或真正触摸 Activity 中 EditText 之外的任何地方时失去焦点，但这并没有发生。只有当用户开始输入另一个 EditText 时，焦点才会改变。例如，当他们单击复选框或单击屏幕的其他区域时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T23:57:28.660

听起来您需要在布局中的所有小部件中添加以下两行：

```
android:focusable="true"
android:focusableInTouchMode="true" 
```

这样他们都可以接收焦点（通常只有某些可以），并且您可以附加`onFocusChangeListener`到有问题的 EditText 并且您应该达到预期的结果。

当然，这也可能对您的其他小部件造成严重破坏（不知道它们是什么，我无法确定），但值得一试。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-06T21:02:39.090

你能不能在另一个视图的点击事件上强制关闭安卓软键盘？

```
InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE); 
imm.toggleSoftInput(InputMethodManager.SHOW_FORCED, 0); 
```

切换调用实际上就是这样做的 - 如果它打开，它将关闭，如果它关闭，它将打开！

# perl - 调试 Perl 单行代码以重命名文件

> ID：11369480
> 
> 赞同：4
> 
> 时间：2012-07-06T20:49:06.067
> 
> 标签：perl

我正在测试/试用[这个 Perl one-liner](https://stackoverflow.com/questions/111868/what-is-your-latest-useful-perl-one-liner-or-a-pipe-involving-perl)，并且试图弄清楚文件发生了什么。我再也看不到这些文件了。我删除了它们还是出了什么问题？

列出的文件名示例（原始）：

```
IMG_0178.JPG
IMG_0182.JPG
IMG_0183.JPG
IMG_0184.JPG
IMG_0186.JPG 
```

我想简单地将文件扩展名更改为小写（.jpg）：

```
perl -e'while(<*.JPG>) { s/JPG$/jpg/; rename <*.jpg>, $_ }' 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-06T20:54:03.943

不要`rename`与 glob 一起使用。使用标量。尝试在替换之前将文件名分配给新变量，并将旧名称重命名为修改后的名称，如下所示：

```
perl -e'while(<*.JPG>) { ($new = $_) =~ s/JPG$/jpg/; rename $_, $new }' 
```

检查输出`ls -1`：

```
IMG_0178.jpg                                                                                                     
IMG_0182.jpg                                                                                                
IMG_0183.jpg                                                                                              
IMG_0184.jpg                                                                                               
IMG_0186.jpg 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-06T21:36:31.050

奇怪的是你的代码应该做你想做的事。

标量上下文中的文件 glob`<*.JPG>`将返回与模式匹配的下一个文件，并且由于两者都`while`应用`rename`标量上下文，因此两个 glob 在每次迭代时返回相同的值。

```
while (<*.JPG>) {
    s/JPG$/jpg/;
    rename <*.jpg>, $_;
} 
```

在循环的第一次迭代中，由`$_`设置为，并且替换将文件类型设置为小写。`IMG_0178.JPG``while`

然后在`<*.jpg>`标量上下文中执行重命名并再次返回`IMG_0178.JPG`- 同一列表中的第一个文件，因为 Windows 文件名不区分大小写。

所以最后重命名`rename 'IMG_0178.JPG', 'IMG_0178.jpg'`按要求执行。

`rename`像这样重写清楚地表明了这一点

```
sub ren($$) {
  print "$_[0] -> $_[1]\n";
}

while (my $file = <*.JPG>) {
  $file =~ s/JPG$/jpg/;
  ren <*.JPG>, $file;
} 
```

**输出**

```
IMG_0178.JPG -> IMG_0178.jpg
IMG_0182.JPG -> IMG_0182.jpg
IMG_0183.JPG -> IMG_0183.jpg
IMG_0184.JPG -> IMG_0184.jpg
IMG_0186.JPG -> IMG_0186.jpg 
```

所以你很幸运，你的文件应该已经按照你的意愿重命名了。

但*不*要这样做。特别是，您应该使用 print 语句代替任何关键操作来运行程序，以便您可以看到将要发生的事情。

这会更好，因为 id 更清楚地做了预期的事情

```
perl -e '($f = $_) =~ s/JPG$/jpg/i and rename $_, $f while <*.JPG>' 
```

# spring - Spring Roo 说“org.apache.maven.plugins:maven-compiler-plugin 需要版本”

> ID：11369485
> 
> 赞同：3
> 
> 时间：2012-07-06T20:49:26.347
> 
> 标签：spring, maven, spring-roo

我正在尝试 Spring Roo 1.2.2 并且无法克服此错误：

> roo>提示
> 
> org.apache.maven.plugins:maven-compiler-plugin 需要版本

我的 Maven 版本：Apache Maven 2.2.1

感谢任何帮助。

**更新：**
更改目录并再次尝试使其消失！但我还是想知道它在看什么，谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T12:01:02.420

Roo 1.2.2 在使用 maven 插件版本时存在问题。您需要确保每个模块中的所有插件声明都指定了版本标签。此处描述了类似的问题[http://forum.springsource.org/showthread.php?132520-Multimodule-application-issue-Spring-Roo-1-2-2](http://forum.springsource.org/showthread.php?132520-Multimodule-application-issue-Spring-Roo-1-2-2)

除此之外，我假设您正在尝试使用 Roo 1.2.2。在现有的代码库上。比你需要遵循这个[http://static.springsource.org/spring-roo/reference/html/existing.html](http://static.springsource.org/spring-roo/reference/html/existing.html)

尽管本文档中没有说明，但您可能需要 Maven 3（3.0.4 附带 Roo/STS 发行版）我建议使用它。最好先将您的项目迁移到 Maven 3。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-08T14:13:26.563

您应该始终在一个空目录（或已经存在的 roo 项目目录）中启动 roo，因为 roo 会扫描工作目录。在您的情况下，可能会检测到 POM。另请注意，当从“拥挤”目录工作时，roo 会变得非常慢。

# c# - 保持面板上的按钮位置调整大小

> ID：11369486
> 
> 赞同：1
> 
> 时间：2012-07-06T20:49:37.737
> 
> 标签：c#, .net, winforms, panel

我一直在搞一些应该很简单的事情。

我已经换了工作，并试图获得一些我以前使用过的基本工具，但当然我没有旧的资源可以查看。

我们扩展了面板以具有一些标准属性和功能（保存、关闭、保存和关闭）。

但是我无法在调整大小时正确定位按钮。我把这个 ExtPanel 放在一个表单上，但是当我调整大小时，按钮一直消失，或者没有按预期移动（冻结在右下角）。

班上

```
public partial class ExtPanel: UserControl
   {
   private System.Windows.Forms.Button btnSaveandClose;
   private System.Windows.Forms.Button btnCancel;
   private System.Windows.Forms.Button btnSave;

   public ExtPanel ()
      {
      InitializeComponent ();
      }

// misc things this class does...

}

public partial class ExtPanel
    {
    private void InitializeComponent ()
       {
        this.btnSaveandClose = new System.Windows.Forms.Button();
        this.btnCancel = new System.Windows.Forms.Button();
        this.btnSave = new System.Windows.Forms.Button();
        this.panel1 = new System.Windows.Forms.Panel();
        this.panel1.SuspendLayout();
        this.SuspendLayout();
        // 
        // btnSaveandClose
        // 
        this.btnSaveandClose.Location = new System.Drawing.Point(899, 689);
        this.btnSaveandClose.Name = "btnSaveandClose";
        this.btnSaveandClose.Size = new System.Drawing.Size(100, 30);
        this.btnSaveandClose.TabIndex = 0;
        this.btnSaveandClose.Text = "Save and Close";
        this.btnSaveandClose.UseVisualStyleBackColor = true;
        this.btnSaveandClose.Click += new System.EventHandler(this.Click_SaveandClose);
        this.btnSaveandClose.Anchor = ((System.Windows.Forms.AnchorStyles) ((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));

        // 
        // btnCancel
        // 
        this.btnCancel.Location = new System.Drawing.Point(687, 689);
        this.btnCancel.Name = "btnCancel";
        this.btnCancel.Size = new System.Drawing.Size(100, 30);
        this.btnCancel.TabIndex = 1;
        this.btnCancel.Text = "Cancel";
        this.btnCancel.UseVisualStyleBackColor = true;
        this.btnCancel.Click += new System.EventHandler(this.Click_Close);
        this.btnCancel.Anchor = ((System.Windows.Forms.AnchorStyles) ((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));

        // 
        // btnSave
        // 
        this.btnSave.Location = new System.Drawing.Point(793, 689);
        this.btnSave.Name = "btnSave";
        this.btnSave.Size = new System.Drawing.Size(100, 30);
        this.btnSave.TabIndex = 2;
        this.btnSave.Text = "Save";
        this.btnSave.UseVisualStyleBackColor = true;
        this.btnSave.Click += new System.EventHandler(this.Click_Save);
        this.btnSave.Anchor = ((System.Windows.Forms.AnchorStyles) ((System.Windows.Forms.AnchorStyles.Bottom | System.Windows.Forms.AnchorStyles.Right)));

        // 
        // panel1
        // 
        this.panel1.AutoScroll = true;
        this.panel1.Controls.Add(this.btnSave);
        this.panel1.Controls.Add(this.btnCancel);
        this.panel1.Controls.Add(this.btnSaveandClose);
        this.panel1.Location = new System.Drawing.Point(0, 0);
        this.panel1.Name = "panel1";
        this.panel1.Size = new System.Drawing.Size(1008, 730);
        this.panel1.TabIndex = 0;
        // 
        // ExtPanel
        // 
        this.Controls.Add(this.panel1);
        this.Name = "ExtPanel";
        this.Size = this.panel1.Size;
        this.Click += new System.EventHandler(this.click_this);
        this.panel1.ResumeLayout(false);
        this.ResumeLayout(false);

        }

    #endregion

    private System.Windows.Forms.Panel panel1;

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-06T20:57:43.890

~~您是否尝试过锚定按钮？~~

...我错过了锚定代码。

如果您在右下角有一个按钮，并且您希望在调整表单大小时将其保留在右下角，请将其锚属性设置为 Bottom, Right。

**更新：**
我加载了你的代码。你有一个面板里面`ExtPanel`。如果您停靠 ( `Fill`) 该面板，那么您应该可以通过调整 ExtPanel 的大小来正常工作。

# c# - 转换为原始类型并用作参数？

> ID：11369487
> 
> 赞同：2
> 
> 时间：2012-07-06T20:49:51.537
> 
> 标签：c#, casting, primitive-types

我正在尝试编译包含此方法的项目；

```
public void Send<T>(object o) where T : struct {
    BinaryWriter bw = new BinaryWriter(stream);
    bw.Write((T)o);
} 
```

我从这种方法（工作）中得到启发；

```
public static T Cast<T>(object o) {
    return (T)o;
} 
```

BinaryWriter.Write 函数支持参数的原始类型，所以我想我可以这样使用它。但是，Visual Studio 说“ *'System.IO.BinaryWriter.Write(bool)' 的最佳重载方法匹配有一些无效参数*”

我试图避免编写包含每个原始类型的长 switch 语句，并为选择类型的方法添加一个参数。这是丑陋的，似乎不正确。

这是简单而优雅的：

*   发送<int>(123);
*   发送<布尔>（真）；

但为什么它不起作用？什么是正确的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T20:53:59.170

重载解决是在*编译时*执行的。所以编译器试图找到一个带有参数的方法，该参数将是有效的*无论类型`T`是什么，（在其约束范围内，这在这里没有帮助）。它找不到这样的方法。鉴于唯一的约束是`T`必须是结构，*唯一*有效的非泛型参数类型将是`object`（通过装箱）。

*如果您的目标是根据对象的执行时*类型使用合适的重载，则需要使用动态类型，如下所示：

```
public void Send(dynamic d) {
    BinaryWriter bw = new BinaryWriter(stream);
    bw.Write(d);
} 
```

...或使用反射获取并执行正确的重载（这是动态类型所做的）。

# ms-access - 如何构建我的 MS Access 图表查询？

> ID：11369489
> 
> 赞同：0
> 
> 时间：2012-07-06T20:50:02.930
> 
> 标签：ms-access, ms-access-2007, ms-office

对于这里的大师来说，这可能是一件容易的事。

我有一个按月排列的员工结果数据表，分为以下字段：

```
Name,Metric,Jan,Feb,Mar,Apr, ...,Dec 
```

**当我按原样获取此数据集并将其全部选择为MS Excel**中简单柱形图的输入时，图表显示每个系列均由 Name+Metric 定义，（y 轴）由值定义在 Jan-Dec 列中，并且图表的列按日期（x 轴）拆分。

`Select`当我通过一个简单的查询将相同的数据集输入 MS Access 时：

```
Select Name, Metric, Jan, Feb, Mar... Dec from Results 
```

我需要能够告诉图表如何使用数据。我该怎么做呢？

另外，我知道我可以展平数据集，使日期成行，然后使用`Crosstab query`for Access 来计算它，但压缩数据似乎效率低下，以便 Access 可以再次展开它。我将假设有一种方法可以以某种方式告诉图表如何使用数据，这就是我在这里的答案中寻找的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:22:17.917

### 选项1

这是一个快速而肮脏的修复。

Excel 本质上是通过连接创建名称+度量的“分组”类别。一个快速而肮脏的解决方案是使用默认条形图并将其 Row Source 属性设置为：

从结果中选择名称 & ' ' & Metric, Jan, Feb, Mar... Dec

之后，如果它仍然需要调整，从设计视图中双击图表对象，看看你可以弄乱哪些图表属性。

### 选项 2

要对图表布局进行更高级的控制，请选择表格结果并在 Access 中使用数据透视图功能。以后可以将此图表作为子表单添加到另一个报表或表单上。

*旁注：您应该尽量避免使用字段名称“名称”，因为它是保留字*

# java - 启动期间 Tomcat 出错：未找到数据库名称

> ID：11369490
> 
> 赞同：6
> 
> 时间：2012-07-06T20:50:04.677
> 
> 标签：java, apache, tomcat, server.xml

在盯着 Tomcat 时，我收到以下错误：

```
SEVERE: Exception looking up UserDatabase under key UserDatabase
javax.naming.NameNotFoundException: Name UserDatabase is not bound in this Context
at org.apache.naming.NamingContext.lookup(NamingContext.java:770)
at org.apache.naming.NamingContext.lookup(NamingContext.java:153)
at org.apache.catalina.realm.UserDatabaseRealm.start(UserDatabaseRealm.java:253)
at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1049)
at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
at org.apache.catalina.core.StandardService.start(StandardService.java:525)
at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Jul 6, 2012 4:32:25 PM org.apache.catalina.startup.Catalina start

SEVERE: Catalina.start: 
LifecycleException:  No UserDatabase component found under key UserDatabase
at org.apache.catalina.realm.UserDatabaseRealm.start(UserDatabaseRealm.java:261)
at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1049)
at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
at org.apache.catalina.core.StandardService.start(StandardService.java:525)
at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414) 
```

我之前在 Server.xml 中使用了相同的 dB 配置，并且 Tomcat 工作正常，但是自从我更改服务器并安装新副本后的最后两天，它抛出了这个错误。

server.xml 中定义的 GlobalNamingResources 如下：

```
<GlobalNamingResources>
<Resource name="jdbc/abcdOracle" auth="Container"
type="javax.sql.DataSource" 
maxActive="100" initialSize="5" maxWait="2000" 
username="xxxxxx" password="xxxxxx" 
driverClassName="oracle.jdbc.driver.OracleDriver"
url="jdbc:oracle:thin:@xxxxxx.xxxxxx.net:1523:ABCDE"
validationQuery="select sysdate from dual" 
validationInterval="30000"
testWhileIdle="true" testOnBorrow="true" testOnReturn="false"
removeAbandoned="true" logAbandoned="true"
removeAbandonedTimeout="60" /> 
</GlobalNamingResources> 
```

任何人都有任何提示如何解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-03-08T13:53:47.590

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-06T20:55:11.487

您已经删除了`tomcat-users.xml`默认情况下`$CATALINA_BASE/conf`在 JNDI 中注册的 。`UserDatabase`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-08T09:28:48.050

我认为您已从 server.xml 中删除了以下代码

```
<Resource name="UserDatabase" auth="Container"
              type="org.apache.catalina.UserDatabase"
              description="User database that can be updated and saved"
              factory="org.apache.catalina.users.MemoryUserDatabaseFactory"
              pathname="conf/tomcat-users.xml" /> 
```

代替它

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-19T07:41:58.937

/var/log/tomcat6/catalina.out 中的错误：

```
GRAVE: Catalina.start:
LifecycleException:  No UserDatabase component found under key UserDatabase 
```

验证tomcat-users.xml的位置：

```
# updatedb
# locate tomcat-users.xml
/etc/tomcat6/tomcat-users.xml 
```

打开 /etc/tomcat6/server.xml 并编辑：

```
<Resource name="UserDatabase" auth="Container"
              type="org.apache.catalina.UserDatabase"
              description="User database that can be updated and saved"
              factory="org.apache.catalina.users.MemoryUserDatabaseFactory"
              pathname="conf/tomcat-users.xml" /> 
```

通过向 tomcat-users.xml 文件插入正确的路径。在我的情况下是：

```
pathname="tomcat-users.xml" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-28T13:48:29.917

这也可能意味着您的 tomcat-users.xml 文件的属性中有一个 XML 字符。

例如，当我在 tomcat-users.xml 中的用户的密码字段中有一个“<”字符时，我已经看到了这种情况

文件摘录：

**/etc/tomcat6/tomcat-users.xml**

```
<role rolename="manager"/>
<user username="admin" password="<password" roles="manager"/> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-28T22:31:24.660

在 server.xml 中，`Resource`元素或其父`GlobalNamingResources`元素不是强制性的。如果您删除资源正在访问的内容（例如，tomcat-users.xml），您只会遇到问题。

如果您注释掉默认`GlobalNamingResources`元素，请确保在 server.xml 中向下滚动并删除`LockOutRealm`。`UserDatabase`默认情况下，它使用`GlobalNamingResources`.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-02-22T16:13:35.657

确保您拥有`<?xml version="1.0" encoding="UTF-8"?>`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-26T18:33:49.687

就我而言，在查看了之前建议的其他解决方案之后，我意识到这只是一个权限问题。我只需要将 tomcat-users.xml 文件的所有权授予运行 tomcat 进程的用户：

```
chown tomcat:tomcat $CATALINA_BASE/conf/tomcat-users.xml 
```

# java - Java：识别字符串中的整数和非整数

> ID：11369492
> 
> 赞同：0
> 
> 时间：2012-07-06T20:50:27.263
> 
> 标签：java, tokenize

您好，我正在尝试修复代码中的错误。在阅读传入的短语时，此代码似乎不计算整数。它计算非整数字的数量没有问题。例如，如果我有以下句子：“我爱我的 4 只猫”它应该表明我有 4 个非整数单词和 1 个整数。但这不是整数的情况，它似乎将它识别为一个单词有什么想法吗？

```
String[] stra = phrase.split(" ");    
         int numInts = 0;    
         int numNonInts = 0;    
         for (String s : stra) {    
             try {    
                 Integer.parseInt(s);    
             }    
             catch(NumberFormatException nfe) {    
                 numNonInts++;    
                 continue;    
             }    
             numInts++;    
         } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T20:56:42.267

```
 String[] stra = phrase.split("\\W+");    // + for sequences
     int numInts = 0;    
     int numNonInts = 0;    
     for (String s : stra) {    
         try {    
             Integer.parseInt(s);    
             numInts++;    
         }    
         catch (NumberFormatException nfe) {    
             numNonInts++;    
         }    
     } 
```

两个空格算作一个词。还`\\W`包括所有非单词字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T20:54:45.453

尝试使用：

```
Integer.valueOf(s); 
```

代替

```
Integer.parseInt(s); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T20:58:14.050

为避免意外的分隔符（如制表符、双空格或换行符），请将 split 替换为：

```
phrase.split("\\s+"); 
```

也许你得到的数字超过了`Integer`.

将循环替换为：

```
for (String s : stra) {
    if(s.matches("\\d+"))
        numInts++;    
    else            
        numNonInts++;    
} 
```

# javascript - 如何通过客户端获取用户控件属性？

> ID：11369493
> 
> 赞同：0
> 
> 时间：2012-07-06T20:50:42.893
> 
> 标签：javascript, asp.net, ajax, .net-3.5, user-controls

我正在创建一些将继承自我的类 BaseControl 的用户控件，该类继承自 UserControl。BaseControl 将包含一些我需要的“东西”。其中之一是名为 ControlValue 的字符串属性。我需要一种从 JavaScript 访问它的方法。我一直在阅读一些关于 RegisterExpandoAttribute() 的内容，但我不确定如何让它工作或我应该把它放在哪里，因为该属性可以随时更改值。我宁愿避免隐藏字段。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:54:17.867

做到这一点的最佳方法取决于很多事情。就像您的自定义控件正在创建什么样的 HTML。

但是，最通用的方法（适用于所有情况的方法）是注册一些设置全局值的 javascript。

像这样的东西应该工作：

```
// Get a ClientScriptManager reference from the Page class.
ClientScriptManager cs = Page.ClientScript;

cs.RegisterStartupScript(this.GetType(), "setupglobal", 
  "<script type=text/javascript>var hiImAGlobal = 'sam'; </script>"); 
```

请记住，我并不是说这是*最好*的方法，只是一种可行的方法。

这是 MSDN 文档：http: [//msdn.microsoft.com/en-us/library/asz8zsxy](http://msdn.microsoft.com/en-us/library/asz8zsxy)

# debugging - NServiceBus pdb/source 步进程序？

> ID：11369498
> 
> 赞同：1
> 
> 时间：2012-07-06T20:51:04.083
> 
> 标签：debugging, nservicebus, pdb

我有一个包含许多项目的应用程序，这些项目引用了几个 NServiceBus NuGet 包。我偶尔希望能够进入 NSB 源来调试问题，但我不知道有一种方法可以做到这一点，除了删除整个地方的现有引用并将它们替换为对我已构建的二进制文件的引用我。委婉地说，这将是一件令人头疼的事情。

有没有相对简单的方法来实现这一点？在 Visual Studio 中，我关闭了“Just My Code”并打开了“Step into .NET Framework Sources”，它似乎在某个符号服务器上找到了 PDB。这导致 NSB 堆栈帧出现在调试器中，但 Visual Studio 不允许我浏览以查找本地驱动器上的源（我从 GitHub 获得的。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T22:48:15.777

您可以使用[反射器](http://www.reflector.net/)工具。具体来说，看看 VSPro 版本。

它将直接从您尝试调试的程序集/dll 生成/逆向工程代码，并让您进入代码。

# facebook-opengraph - 使用 Open Graph 将内容发布到多个（未知）域？

> ID：11369499
> 
> 赞同：3
> 
> 时间：2012-07-06T20:51:05.357
> 
> 标签：facebook-opengraph

我正在开发一个在各种 URL 上发布内容（“文章”）的应用程序，这些 URL 都由同一个 WordPress 安装（映射的域，全部由同一组代码/网络的一部分提供支持）控制。所有的发布都是通过一个中央 Facebook 应用程序完成的。

我不知道这些 URL 的域将是什么，因为它们由我们的用户控制，这些用户注册域然后在他们的帐户中配置它们在我们的服务中。

当我尝试使用 Open Graph 在其中一个站点（具有自定义域）上发布内容时，它们被拒绝并出现以下错误（错误代码 1611028）：

> 'article' 类型的 URL * * * * 处的对象无效，因为*指定的应用程序 ID '* * *' 不允许使用*域 '* * *'。您可以在...验证您配置的“应用程序域”。

由于我无法将所有域都输入 Facebook，而且它们不是从我的应用程序 URL 派生的，有什么方法可以让我完成这项工作吗？我可以在页面中放置某种神奇的 OG 标签之类的东西吗？或者只是不可能做我想做的事？

例子：

我们控制托管所有这些其他网站的中央服务 (website.com)。通常，他们被分配了类似 username.website.com 作为他们的 URL。用户登录 website.com 并转到他们发布内容（博客、静态页面等）的仪表板。该内容出现在他们的网站上，例如 username.website.com/2012/07/04/new-content/ （这是该页面上的全部内容。

该用户还可以选择注册一个域（例如 mydomain.com）并将其映射到他们的帐户。所以现在，在上面的例子中，他们的内容出现在 mydomain.com/2012/07/04/new-content/ 而不是 username.website.com （并且 username.website.com URL 将重定向到那个新的、映射的-域版本）。

当他们发布新内容时，我们希望能够发布到他们的 Wall，以便他们的朋友可以看到他们发布了新内容，然后点击并在 mydomain.com/... 上查看。

问题是 mydomain.com 是数千个不同域之一，没有一个基于 website.com URL，因此我们无法将它们添加到我们的应用程序中。当 FB 尝试从 mydomain.com 读取 OG 数据时，它会拒绝它，因为它没有在我们的应用程序中配置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:12:12.370

是的，与其将内容动态发布到每个单独的域，不如将其发布到远程主机（具有单个域）。然后，为您的每个用户分发一个插件，以从您的远程主机动态提取内容以显示在他们各自的虚拟主机上。

祝你好运！

# java - 无法在 Maven 项目中创建 servlet

> ID：11369501
> 
> 赞同：4
> 
> 时间：2012-07-06T20:51:09.810
> 
> 标签：java, eclipse, jsp, servlets, maven

我在 Eclipse IDE 中使用 --maven-archetype-webapp 创建了一个 maven 项目。

我能够创建并执行 index.jsp，但现在我需要创建一个新的 servlet。但是当我右键单击该项目并选择一个新的 servlet（New->Other->Web->Servlet）时，我在下拉列表中看不到我的 maven 项目，因此我无法在我的 Maven 项目中使用 Eclipse IDE 创建 servlet。

有人可以指出为什么会这样。我是Maven的新手。

谢谢你，

编辑 - 我的 web.xml

```
 <!DOCTYPE web-app PUBLIC
  "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
  "http://java.sun.com/dtd/web-app_2_3.dtd" >
 <web-app>
   <display-name>Archetype Created Web Application</display-name>
   <welcome-file-list>
     <welcome-file>index.jsp</welcome-file>
   </welcome-file-list>  
 </web-app> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-06T20:56:58.820

如果您无法从菜单中创建 servlet。检查以下内容。

1.  检查Web.xml文件是否由maven在WEB-INF文件夹中创建。
    如果不创建它。

2.  该项目是否显示为 Web 项目？
    右键单击项目->属性->项目方面->检查是否选择了动态Web模块。？选择它以将项目制作为 Web 项目。

# perl - 需要将数据作为字符串转换为 Excel 可读格式

> ID：11369502
> 
> 赞同：1
> 
> 时间：2012-07-06T20:51:13.897
> 
> 标签：perl, excel, cygwin

我有一个文件，其中包含这种格式的日期字符串：

```
June 11, 2012 3:47:56 PM GMT-07:00 
```

我已经在使用 Perl 脚本来操作该文件中的一些其他数据元素，然后将其作为 Excel 的 csv 输出。我认为我应该能够在 Perl 中更轻松/更快地完成它，而不是在 Excel 中使用函数和公式来尝试将日期作为字符串转换为 Excel 可以读取的内容。

目的/期望的最终结果是一个时间和日期戳，我可以在 Excel 中进行简单的数学运算（即，通过计算时间戳来获取条目之间的年龄差异）。

为此，我希望我的日期戳看起来像这样：

```
6/11/2012 3:47:56 PM 
```

真的我只需要转换日期，时间是完美的，并删除GMT差异垃圾。

我已经看到代码片段和对模块的引用似乎以另一种方式转换......即，从“2012 年 6 月 24 日”到“2012 年 6 月 24 日”，但这对我来说是错误的方向。

我在cpan中查找了module time::piece，但不太明白。我在 Cygwin exec 中工作，所以不是真正的 unix 系统，并且没有太多的手册页或 perldocs。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T22:28:30.533

您可以使用模块[Date::Parse](http://search.cpan.org/~gbarr/TimeDate-1.20/lib/Date/Parse.pm)和 POSIX 函数`strftime`。CPAN中有很多模块可以解析日期。

[用 strftime 格式化日期真的很酷的文章](http://perltraining.com.au/tips/2009-02-26.html)

```
use strict;
use Date::Parse;
use POSIX qw/strftime/;

my $time = str2time( 'June 11, 2012 3:47:56 PM GMT-07:00' );
my $date = strftime "%m/%d/%Y %H:%M:%S %p", localtime($time);
print $date; 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T00:41:29.610

如果您的原始字符串是：$timestring，那么这应该可以工作（未经测试）：

```
my %months = (January => '1', February =>'2', March => '3', ...); 
```

...

等等

```
$timestring =~ s<^(w+)\x20(\d{1,2}),\x20(\d{4})(\x20\(?:\d{1,2}\:){2}\d{1,2}\x20PM).*$><"$months{$1}/$2/$3$4">eeg 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T21:39:27.520

```
use DateTime;
use DateTime::Format::Strptime;

# YOU MUST ADAPT THIS PATTERN
my $pat = "%b %d, %Y"; #incomplete
my $d  = DateTime::Format::Strptime->new( pattern => $pat, on_error => 'croak' );
my $dt = $d->parse_datetime($strdate);

say $dt->mdy("/") . " "  . $dt->hms(":") . " " . $dt->am_or_pm; 
```

但请注意，Excel 更喜欢 ISO 格式的日期时间类型：

```
say $dt->ymd('-') . 'T' . $dt->hms(':'); 
```

要微调模式 $pat，请阅读[DateTime::Format::Strptime](https://metacpan.org/module/DateTime%3a%3aFormat%3a%3aStrptime)的模块文档。它最适合解析非常统一的输入数据。遇到最轻微的偏差，模块不会解析它（不过你可以解决这个问题）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-23T19:48:20.500

许多人都有他们最喜欢的时间解析技术。我喜欢[Time::Piece](http://perldoc.perl.org/Time/Piece.html)，因为它带有 Perl（至少任何超过 5.10 的版本）：

```
my $time_string = "June 11, 2012 3:47:56 PM GMT-7:00";
my $time_string =~ / GMT.*$//;  # That "GMT-7:00" messes things up!
say $time_string   # June 11, 2012 3:47:56 PM GMT

my $time = Time::Piece->strptime(
    $time_string, "%B %d, %Y %l:%M:%S %p" );

say $time->strftime("%D %l:%M:%S %p"); 
```

面向对象的`$foo->bar`编码风格正在成为 Perl 的未来方式，所以你最好习惯[它](http://perldoc.perl.org/perlootut.html)。

这并不是真的那么复杂。基本上，您创建一个*包含*所有数据的容器。哈希可以保存各种信息的方式。

当我这样做时：

```
my $time = Time::Piece->strptime( "$time_string", "$time_format" ); 
```

我正在创建一个名为存储时间的`Time::Piece`对象（nee 容器） 。`$time`

当您说 时`$time->Weekday`，您实际上是在执行一个名为的子例程`Weekday`，它获取您的`$time` *容器*，从中提取信息，解析时间，并返回工作日。

( **STR** ing **P** ass **TIME** )*构造函数*`strptime`（它是创建容器的函数）正在获取您的时间字符串（第一个参数）和它的格式（第二个参数）并创建该对象。各种和指定的特定时间字段。这些可以在[strptime](http://linux.die.net/man/3/strftime)联机帮助页中找到。*******`$time``%M``%d`*******

 *******您可以使用 Unix`date`命令来处理这些格式：

```
$ date "+%m/%d/%y"
08/23/13
$ date "+%m/%d/%Y"
08/23/2013
$ date "%Y-%m-%d"
2013-08-23 
```

这可能会让你对他们感觉更舒服。

( **STR** ing **F** ormat **TIME**`strftime` ) 方法（nee 子程序）与. 这需要时间（以您指定的格式输入并返回时间。******`strptime``$time`******

 ******* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-26T13:05:44.827

如果您在安装新的额外软件包时遇到问题，您可以使用 plain per 来完成。一旦您有了 Excel 日期序列值，例如 61,59340278，您就可以使用 Excel 在自定义日期中格式化该数字的外观。

例如：

61,59340278 使用自定义日期格式显示在 Excel 中

自定义单元格格式：TT.MM.JJJJ hh:mm:ss

如> **01.03.1900 14:14:30**

下面的函数

```
sub date2excelvalue {
  my($day1, $month, $year, $hour, $min, $sec) = @_;
  my @cumul_d_in_m = (0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365);
  my $doy = $cumul_d_in_m[$month - 1] + $day1;

  #
  full years + your day
  for my $y(1900..$year) {
    if ($y == $year) {
      if ($month <= 2) {

        #
        dont add manually extra date
        if inJanuary or February
        last;
      }
      if ((($y % 4 == 0) && ($y % 100 != 0)) || ($y % 400 == 0) || ($y == 1900)) {
        $doy++;#
        leap year
      }
    } else {#
      full years
      $doy += 365;
      if ((($y % 4 == 0) && ($y % 100 != 0)) || ($y % 400 == 0) || ($y == 1900)) {
        $doy++;#
        leap year
      }

    }
  }#
  end
  for y# calculate second parts as a fraction of 86400 seconds
  my $excel_decimaltimepart = 0;
  my $total_seconds_from_time = ($hour * 60 * 60 + $min * 60 + $sec);
  if ($total_seconds_from_time == 86400) {
    $doy++;#
    just add a day
  } else {#
    add decimal in excel
    $excel_decimaltimepart = $total_seconds_from_time / (86400);
    $excel_decimaltimepart = ~s / 0\. //;
  }
  return "$doy\.$excel_decimaltimepart";

}

sub excelvalue2date {
  my($excelvalueintegerpart, $excelvaluedecimalpart) = @_;
  my @cumul_d_in_m = (0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334, 365);
  my @cumul_d_in_m_leap = (0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335, 366);
  my @cumul_d_in_m_selected;
  my($day1, $month, $year, $hour, $min, $sec);
  $day1 = 0;#
  all days all years
  my $days_in_year;
  my $acumdays_per_month;
  my $daysinmonth;
  my $day;

  #
  full years + your day
  for my $y(1900\. .3000) {
    my $leap_year = 0;#
    leap year
    my $leap_year_mask = 0;#
    leap year
    if ((($y % 4 == 0) && ($y % 100 != 0)) || ($y % 400 == 0) || ($y == 1900)) {
      $leap_year = 1;#
      leap year
      @cumul_d_in_m_selected = @cumul_d_in_m_leap;

    } else {
      $leap_year = 0;#
      leap year
      @cumul_d_in_m_selected = @cumul_d_in_m;
    }

    if (($day1 + (365 + $leap_year)) > $excelvalueintegerpart) {

      #
      found this year $y
      $year = $y;
      print "year $y\n";

      $days_in_year = $excelvalueintegerpart - $day1;
      $acumdays_per_month = 0;
      print "excelvalueintegerpart  $excelvalueintegerpart\n";
      print "day1  $day1\n";
      print "daysinyear $days_in_year\n";
      for my $i(0..$# cumul_d_in_m) {
        if ($i == $# cumul_d_in_m) {
          $month = $i + 1;#
          month 12 December
          $day = $days_in_year - $cumul_d_in_m_selected[$i];
          last;

        } else {

          if (($days_in_year > ($cumul_d_in_m_selected[$i])) && ($days_in_year <= ($cumul_d_in_m_selected[$i + 1]))) {
            $month = $i + 1;
            $day = $days_in_year - $cumul_d_in_m_selected[$i];
            last;
          }

        }

      }#
      end
      for $i months

      # end year
      last;

    } else {#
      full years
      $day1 += (365 + $leap_year);
    }

  }#
  end
  for years interger part comparator

  my $total_seconds_inaday;
  $total_seconds_inaday = "0\.$excelvaluedecimalpart" * 86400;

  $sec = $total_seconds_inaday;
  $hour = int($sec / (60 * 60));
  $sec -= $hour * (60 * 60);
  $min = int($sec / 60);
  $sec -= $min * (60);
  $sec = int($sec);
  return ($day, $month, $year, $hour, $min, $sec);

}
my $excelvariable = date2excelvalue(1, 3, 2018, 14, 14, 30);
print "Excel variable: $excelvariable\n";
my($integerpart, $decimalwithoutzero) = ($1, $2) if ($excelvariable = ~m / (\d + )\.(\d + ) / );
my($day1, $month, $year, $hour, $min, $sec) = excelvalue2date($integerpart, $decimalwithoutzero);
print "Excel Date from value: $day1, $month, $year, $hour, $min, $sec\n"; 
```

好好享受！*************

# c# - 使用 VS 隔离 Shell 作为 UI 脚手架

> ID：11369505
> 
> 赞同：2
> 
> 时间：2012-07-06T20:51:35.723
> 
> 标签：c#, .net, visual-studio-2010, visual-studio-sdk, visual-studio-shell

我正在探索使用 Visual Studio 隔离外壳作为我的 WPF 应用程序的 UI 脚手架的可能性。该应用程序将包含自定义“文档”窗口以及许多用于显示额外信息的辅助工具窗口。我需要工具窗口和文档窗口由主控制器控制或轻松相互通信。

关于 VS 隔离外壳的文档非常少，示例更少。所以我希望以前在使用 VS 隔离外壳开发自定义应用程序或 IDE 方面有经验的人可以帮助我解决这个问题。

仅出于 UI 脚手架目的使用 VS 隔离外壳是否可行？如果是这样，我如何才能从 Visual Studio 中删除所有继承的功能并自定义从菜单栏到文档页面的所有内容？还是使用其他一些 UI 脚手架库更好，例如 AvalonDocks？使用 VS shell 的好处是它更加稳定，如果需要，我可以轻松地将其作为自定义工具窗口移植到 Visual Studio 中。

非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-22T08:04:45.490

您可以查看 Visual Studio 开发团队的最新示例：http: [//blogs.msdn.com/b/vsx/archive/2014/05/30/vs-2013-sdk-samples-released.aspx](http://blogs.msdn.com/b/vsx/archive/2014/05/30/vs-2013-sdk-samples-released.aspx)

# php - 将函数的输出设置为等于变量

> ID：11369506
> 
> 赞同：0
> 
> 时间：2012-07-06T20:51:40.053
> 
> 标签：php, css, function

我如何将自定义 php 函数的输出设置为变量？

功能是：

```
function getRandomColor1() {
global $cols;
$num_cols = count($cols);
$rand = array_rand($cols);
$rand_col = $cols[$rand];
echo $rand_col;
unset($cols[$rand]);
} 
```

我如何设置 getRandomColor1 等于 $RandomColor1？

我需要它是一个变量，所以我可以在 css 中使用它，例如：

```
#boxone1 {  
height: 150px;
width: 150px;
background: <?=$RandomColor1?>; 
float: left;
} 
```

如果无法将其设置为变量，我还能如何将函数的输出放入 css 中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T21:11:07.040

好的，有许多答案指向正确的方向，但要为您说明：

您的函数需要[返回](http://php.net/manual/en/function.return.php)您想要的值。请阅读此链接，因为它是您问题的答案（感谢 egasimus 的链接）。

所以是这样的：

```
function getRandomColor1() {
    global $cols;
    $num_cols = count($cols);
    $rand = array_rand($cols);
    $rand_col = $cols[$rand];
    unset($cols[$rand]);
    return $rand_col;
} 
```

进而

```
#boxone1 {  
    height: 150px;
    width: 150px;
    background: <?php echo getRandomColor1(); ?>; 
    float: left;
} 
```

此外，`<?=`如果您正在使用的服务器没有启用正确的设置（或决定稍后禁用它），可能会导致错误和安全问题。总是使用它可能更安全`<?php echo`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T20:55:24.763

您`return`在函数末尾的值（例如：）`return $rand_col`。有关文档，请参阅[此内容。](http://www.php.net/manual/en/functions.returning-values.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T20:55:48.867

如果 css 和 php 在同一个文件中，你可以这样做：

```
background: <?=getRandomColor1();?>; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-06T20:55:54.050

```
#boxone1 {  
    height: 150px;
    width: 150px;
    background: <?php echo $yourVariable; ?>; 
    float: left;
} 
```

有关更多信息，请参阅[此](http://css-tricks.com/css-variables-with-php/)内容。

# android - 安卓适配屏

> ID：11369509
> 
> 赞同：0
> 
> 时间：2012-07-06T20:52:10.677
> 
> 标签：android, layout, screen

我正在开发具有大量视图（页面）的 Android 应用程序。我必须支持所有不同屏幕尺寸和密度的手机。所以我为布局创建了不同的文件夹`layout-small`：`layout-large`和`layout`。其实我不确定`layout-large`and `layout-xlarge`。但事实并非如此。

然后我为图像创建了不同的文件夹：ldpi、mdpi、hdpi 和 xhdpi。在所有可绘制文件夹中，图像的大小都不同。我用 480x800 160dpi、480x800 240dpi 和 480x800 120dpi 检查了我的应用程序，一切正常。

但在 320x480 160dpi 应用程序不适合屏幕高度。尽管我已经放置了一个 ScrollView ，但它仍然不是滚动每个新视图的正确方法。

我正在为 Android 2.0 及更高版本制作此应用，因此不能使用 layout-w320dp（如 Android 3）。我需要将我的应用调整为 320x480 160dpi！但是怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T20:56:24.707

您是否考虑过使用相对屏幕尺寸，然后android会为您调整

[您如何为多种 Android 屏幕尺寸制作布局？](https://stackoverflow.com/questions/4360868/how-do-you-make-layouts-for-several-android-screen-sizes)

# groovy - 为什么 Groovy 认为我正在从静态方法传递类的实例？

> ID：11369511
> 
> 赞同：2
> 
> 时间：2012-07-06T20:52:26.767
> 
> 标签：groovy, static, configparser, missingmethodexception

我是 Groovy 的新手，所以很可能我做错了什么。我已经编写了一个配置供 ConfigSlurper 使用。但是当我真正尝试解析它时出现了问题。我的代码如下：

```
class CharacterMap {
    public static final String CHARACTER_CONFIGURATION = 'location'
    static Map<String,String> characterMap = null
    public static String ASCIIize(String input)
    {
        if (!characterMap)
        {
            def property = System.getProperty( CHARACTER_CONFIGURATION )
            ConfigObject config = null
            if( property ) {
                ConfigSlurper cs = new ConfigSlurper()
                File file = new File( property )
                URL location = file.toURL()
                config = cs.parse(location)
            }
            if (config)
            {
                characterMap = config.characters
            }
            else
            {
                getAnonymousLogger().logp WARNING, getClass().name, 'constructor',
                        "Server configuration groovy file not configured with system property ${CHARACTER_CONFIGURATION}"
                return input
            }
        }
        for (String key: characterMap.keySet())
        {
            if (input.contains(key))
            {
                input = input.replace(key, characterMap.get(key))
            }
        }
        return input
    }

    public static void main(String[] args)
    {
        print ASCIIize(args[0])
    }
} 
```

当它调用解析方法时，它会在线程“主”groovy.lang.MissingMethodException 中抱怨异常：没有方法签名：groovy.util.ConfigSlurper.parse() 适用于参数类型：(CharacterMap, java.net.URL ) 如您所见，我只传递了一个参数，它被声明为一个 URL。由于类的所有方法都是静态的，并且在任何地方都没有引用构造函数，所以创建一个实例有点奇怪，更奇怪的是它被传递到 parse 方法中。我读过 Stack Overflow 上的其他人得到 MissingMethodException （尽管通常与闭包而不是多余的参数有关），并将其归咎于 Eclipse。我在 IntelliJ 而不是 Eclipse 中运行它。

编辑：针对下面的评论，groovy 版本是 1.8.6。这是堆栈跟踪：

> 线程“主”groovy.lang.MissingMethodException 中的异常：没有方法签名：groovy.util.ConfigSlurper.parse() 适用于参数类型：(CharacterMap, java.net.URL) 值：[CharacterMap@34374a16，文件： /C:/Program Files (x86)/JetBrains/IntelliJ IDEA Community Edition 11.1.2/UCP/config/CharacterMap.groovy]
> 
> 可能的解决方案：parse(java.net.URL), parse(groovy.lang.Script, java.net.URL), parse(groovy.lang.Script), parse(java.lang.Class), parse(java.lang .String），解析（java.util.Properties）
> 
> 在 org.codehaus.groovy.runtime.ScriptBytecodeAdapter.unwrap(ScriptBytecodeAdapter.java:55) 在 org.codehaus.groovy.runtime.callsite.PogoMetaClassSite.callCurrent(PogoMetaClassSite.java:78) 在 org.codehaus.groovy.runtime.callsite .CallSiteArray.defaultCallCurrent(CallSiteArray.java:46) at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:133) at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java :145) 在 groovy.util.ConfigSlurper.parse(ConfigSlurper.groovy:148) 在 groovy.util.ConfigSlurper$parse.call(Unknown Source) 在 org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java :42) 在 org.codehaus.groovy.runtime 的 org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:108)。callsite.AbstractCallSite.call(AbstractCallSite.java:116) at ucp.cms.search.CharacterMap.ASCIIize(CharacterMap.groovy:26) at ucp.cms.search.CharacterMap.main(CharacterMap.groovy:51) at sun.reflect .NativeMethodAccessorImpl.invoke0(Native Method) 在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 在 java.lang.reflect.Method.invoke(Method .java:601) 在 com.intellij.rt.execution.application.AppMain.main(AppMain.java:120)NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 在 java.lang.reflect.Method.invoke(Method.java:601) 在 com.intellij.rt.execution .application.AppMain.main(AppMain.java:120)NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) 在 java.lang.reflect.Method.invoke(Method.java:601) 在 com.intellij.rt.execution .application.AppMain.main(AppMain.java:120)
> 
> 进程以退出代码 1 结束

# android - 如何指定哪个 EditText 应该关注 Activity 启动并自动调出键盘？

> ID：11369518
> 
> 赞同：0
> 
> 时间：2012-07-06T20:53:03.890
> 
> 标签：android

当活动加载并调出软键盘时，我想立即突出显示特定编辑框。我怎样才能做到这一点？onStart() 中也应该有任何内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T20:59:13.740

执行 findViewByID() 后，您可以在视图上调用 : requestFocus()

您可以在 onStart 中执行此操作 - 我现在看到它不起作用的原因。

也在这里检查：

[http://developer.android.com/reference/android/view/View.html](http://developer.android.com/reference/android/view/View.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T20:59:36.383

使用`getSystemService(...)`, 在这种情况下可以获得 ,`Context.INPUT_METHOD_SERVICE`请查看下面的代码示例以进行说明：

```
InputMethodManager imm = (InputMethodManager)context.getSystemService(
                            Context.INPUT_METHOD_SERVICE);

imm.showSoftInput(edittext, 0, null); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T21:01:49.720

在您的布局中将`</requestFocus>`标签放在`EditText`.

`onStart()`通话中

```
getDialog().getWindow().setSoftInputMode(LayoutParams.SOFT_INPUT_STATE_VISIBLE); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T21:01:54.743

理想情况下，这应该有效。

```
 <EditText
                android:id="@+id/Abc"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content">
                <requestFocus />
            </EditText> 
```

但是有一些已知的键盘没有弹出的问题。看到[这个](http://code.google.com/p/android/issues/detail?id=2705)。

您也可以使用 Runnable 执行此操作：

```
public class MyActivity extends Activity {
 private Handler mHandler= new Handler();
    @Override
    protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            // get text
                mHandler.post(new Runnable() {
            public void run() {
                text.requestFocus();                

            }
        });

        }
} 
```

# bash - Bash 实用程序脚本库

> ID：11369522
> 
> 赞同：62
> 
> 时间：2012-07-06T20:53:53.427
> 
> 标签：bash

是否有任何常用（或不公正不常用）的 bash 函数实用程序“库”？类似于 Java 的 Apache commons-lang 之类的东西。Bash 无处不在，以至于在扩展库领域似乎被奇怪地忽视了。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-07-06T21:34:02.483

用于 bash 的库已经存在，但并不常见。bash 库稀缺的原因之一是由于功能的限制。我相信这些限制在“Greg's Bash Wiki”上得到了最好的解释：

职能。Bash 的“功能”有几个问题：

*   **代码可重用性**：Bash 函数不返回任何内容；它们只产生输出流。捕获该流并将其分配给变量或将其作为参数传递的每种合理方法都需要一个 SubShell，它会破坏对外部范围的所有分配。（另请参阅 BashFAQ/084 以了解从函数中检索结果的技巧。）因此，可重用函数库是不可行的，因为您不能要求函数将其结果存储在名称作为参数传递的变量中（除了通过执行评估后空翻）。

*   **范围**：Bash 有一个简单的本地范围系统，大致类似于“动态范围”（例如 Javascript、elisp）。函数可以看到调用者的本地变量（如 Python 的“nonlocal”关键字），但不能访问调用者的位置参数（如果启用了 extdebug，则通过 BASH_ARGV 除外）。除非您采用奇怪的命名规则来使冲突不太可能发生，否则无法保证可重用函数没有命名空间冲突。如果实现的函数期望作用于帧 n-3 中的变量名称，这可能已被您在 n-2 处的可重用函数覆盖，则这尤其是一个问题。Ksh93 可以通过使用“函数名 { ... }”语法声明函数来使用更常见的词法范围规则（Bash 不能，但无论如何都支持这种语法）。

*   **闭包**：在 Bash 中，函数本身总是全局的（具有“文件范围”），因此没有闭包。函数定义可能是嵌套的，但它们不是闭包，尽管它们看起来非常相似。函数不是“可通过的”（一流的），也没有匿名函数（lambdas）。事实上，没有什么是“可以通过的”，尤其是数组。Bash 使用严格的按值调用语义（魔术别名 hack 除外）。

*   还有更多复杂性涉及：子壳；导出函数；“功能崩溃”（定义或重新定义其他功能或自身的功能）；陷阱（及其继承）；以及函数与 stdio 交互的方式。不要因为不了解这一切而咬新人。Shell函数完全是f *** ed。

资料来源： http: [//mywiki.wooledge.org/BashWeaknesses](http://mywiki.wooledge.org/BashWeaknesses)

shell“库”的一个示例是基于 Redhat 的系统上的 /etc/rc.d/functions。该文件包含 sysV 初始化脚本中常用的函数。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2017-07-29T07:48:28.717

我在这里看到了一些好的信息和坏的信息。让我分享一下我所知道的，因为 bash 是我在工作中使用的主要语言（而且我们构建了库..）。总的来说，谷歌对 bash 脚本有一篇不错的文章，我认为这是一本不错的读物：[https](https://google.github.io/styleguide/shell.xml) ://google.github.io/styleguide/shell.xml 。

首先让我说你不应该像使用其他语言的库那样考虑 bash 库。为了使 bash 中的库保持简单、有条理且最重要的是可重用，必须执行某些实践。

除了打印的字符串和函数的退出状态 (0-255) 之外，没有从 bash 函数返回任何内容的概念。这里有预期的限制和学习曲线，特别是如果您习惯于高级语言的功能。一开始可能会很奇怪，如果您发现自己处于字符串无法剪切的情况，您将需要利用外部工具，例如 jq。如果 jq （或类似的东西）可用，您可以开始让您的函数打印格式化输出，以便像对象、数组等一样进行解析和使用。

### 函数声明

在 bash 中声明函数有两种方法。一个在您当前的 shell 中运行，我们称之为 Fx0。并且产生一个子shell来操作，我们称之为Fx1。以下是如何声明它们的示例：

```
Fx0(){ echo "Hello from $FUNCNAME"; }
Fx1()( echo "Hello from $FUNCNAME" ) 
```

这两个函数执行相同的操作 - 实际上。但是，这里有一个关键的区别。Fx1 无法执行任何更改当前 shell 的操作。这意味着修改变量、更改 shell 选项**和声明其他函数**。后者可以用来防止很容易出现的名称间距问题。

```
# Fx1 cannot change the variable from a subshell
Fx0(){ Fx=0; }
Fx1()( Fx=1 )
Fx=foo; Fx0; echo $Fx
# 0
Fx=foo; Fx1; echo $Fx
# foo 
```

话虽这么说，您唯一应该使用“Fx0”类型的函数是当您想要在当前 shell 中重新声明某些内容时。始终使用“Fx1”函数，因为它们更安全，您不必担心其中声明的任何函数的命名。正如您在下面看到的，无辜的函数在 Fx1 内部被覆盖，但是，在执行 Fx1 后它仍然毫发无损。

```
innocent_function()(
    echo ":)"
)
Fx1()(
    innocent_function()( true )
    innocent_function
)
Fx1 #prints nothing, just returns true
innocent_function
# :) 
```

如果您使用了花括号，这将（可能）产生意想不到的后果。有用的“Fx0”类型函数的示例专门用于更改当前 shell，如下所示：

```
use_strict(){
    set -eEu -o pipefail
}
enable_debug(){
    set -Tx
}
disable_debug(){
    set +Tx
} 
```

### 关于声明

使用全局变量，或者至少是那些预期有值的变量，一直都是不好的做法。当您在 bash 中构建库时，您永远不希望函数依赖已设置的外部变量。函数需要的任何东西都应该通过位置参数提供给它。这是我在其他人尝试在 bash 中构建的库中看到的主要问题。即使我发现一些很酷的东西，我也不能使用它，因为我不知道我需要提前设置的变量的名称。它导致挖掘所有代码并最终为自己挑选有用的部分。到目前为止，为库创建的最佳函数都非常小，并且根本不使用命名变量，即使是在本地也是如此。以以下为例：

```
serviceClient()(
    showUsage()(
        echo "This should be a help page"
    ) >&2
    isValidArg()(
        test "$(type -t "$1")" = "function"
    )
    isRunning()(
        nc -zw1 "$(getHostname)" "$(getPortNumber)"
    ) &>/dev/null
    getHostname()(
        echo localhost
    )
    getPortNumber()(
        echo 80
    )
    getStatus()(
        if isRunning
        then echo OK
        else echo DOWN
        fi
    )
    getErrorCount()(
        grep -c "ERROR" /var/log/apache2/error.log
    )
    printDetails()(
        echo "Service status: $(getStatus)"
        echo "Errors logged: $(getErrorCount)"
    )
    if isValidArg "$1"
    then "$1"
    else showUsage
    fi
) 
```

通常，您会在顶部附近看到什么`local hostname=localhost`，`local port_number=80`这很好，但这不是必需的。我认为这些东西应该在构建时进行功能化，以防止将来突然出现一些逻辑来获取值时出现痛苦，例如：`if isHttps; then echo 443; else echo 80; fi`. 您不希望将这种逻辑放置在您的 main 函数中，否则您很快就会使它变得丑陋和难以管理。现在， serviceClient 具有在调用时声明的内部函数，这为每次运行增加了不明显的开销。好处是现在您可以让 service2Client 的函数（或外部函数）与 serviceClient 具有的函数（或外部函数）命名相同，并且绝对没有冲突。要记住的另一件重要的事情是，重定向可以在声明时应用于整个函数。请参阅：isRunning 或 showUsage 这与我认为您应该费心使用 bash 一样接近面向对象。

```
. serviceClient.sh
serviceClient
# This should be a help page
if serviceClient isRunning
then serviceClient printDetails
fi
# Service status: OK
# Errors logged: 0 
```

我希望这可以帮助我的 bash 黑客伙伴。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2017-11-29T14:31:41.900

这是我花了一个小时左右的谷歌搜索后发现的*“值得你花时间”的bash 库列表。*

*   [https://github.com/mietek/bashmenot/](https://github.com/mietek/bashmenot/)

bashmenot 是 Halcyon 和 Haskell 在 Heroku 上使用的库。上面的链接指向带有示例的可用功能的完整列表——令人印象深刻的质量、数量和文档。

*   [http://marcomaggi.github.io/docs/mbfl.html](http://marcomaggi.github.io/docs/mbfl.html)

MBFL 提供了一组实现常用操作的模块和一个脚本模板。相当成熟的项目，仍然活跃在 github

*   [https://github.com/javier-lopez/learn/blob/master/sh/lib](https://github.com/javier-lopez/learn/blob/master/sh/lib)

您需要查看代码以获取简要说明和示例。它背后有几年的发展。

*   [https://github.com/martinburger/bash-common-helpers](https://github.com/martinburger/bash-common-helpers)

这具有较少的最基本功能。对于文档，您还必须查看代码。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-12-26T15:56:11.020

在函数内部声明但没有`local`关键字的变量是全局变量。

最好只在函数内部声明变量，`local`以避免与其他函数和全局冲突（参见下面的 foo()）。

Bash 函数库需要始终是“来源”的。我更喜欢使用“源”同义词而不是更常见的点（。），这样我可以在调试过程中更好地看到它。

**以下技术至少适用于 bash 3.00.16 和 4.1.5 ......**

```
#!/bin/bash
#
# TECHNIQUES
#

source ./TECHNIQUES.source

echo
echo "Send user prompts inside a function to stderr..."
foo() {
    echo "  Function foo()..."              >&2 # send user prompts to stderr
    echo "    Echoing 'this is my data'..." >&2 # send user prompts to stderr
    echo "this is my data"                      # this will not be displayed yet
}
#
fnRESULT=$(foo)                       # prints: Function foo()...
echo "  foo() returned '$fnRESULT'"   # prints: foo() returned 'this is my data'

echo
echo "Passing global and local variables..."
#
GLOBALVAR="Reusing result of foo() which is '$fnRESULT'"
echo "  Outside function: GLOBALVAR=$GLOBALVAR"
#
function fn()
{
  local LOCALVAR="declared inside fn() with 'local' keyword is only visible in fn()"
  GLOBALinFN="declared inside fn() without 'local' keyword is visible globally"
  echo
  echo "  Inside function fn()..."
  echo "    GLOBALVAR=$GLOBALVAR"
  echo "    LOCALVAR=$LOCALVAR"
  echo "    GLOBALinFN=$GLOBALinFN"
}

# call fn()...
fn

# call fnX()...
fnX

echo
echo "  Outside function..."
echo "    GLOBALVAR=$GLOBALVAR"
echo
echo "    LOCALVAR=$LOCALVAR"
echo "    GLOBALinFN=$GLOBALinFN"
echo
echo "    LOCALVARx=$LOCALVARx"
echo "    GLOBALinFNx=$GLOBALinFNx"
echo 
```

**源函数库由...表示**

```
#!/bin/bash
#
# TECHNIQUES.source
#

function fnX()
{
  local LOCALVARx="declared inside fnX() with 'local' keyword is only visible in fnX()"
  GLOBALinFNx="declared inside fnX() without 'local' keyword is visible globally"
  echo
  echo "  Inside function fnX()..."
  echo "    GLOBALVAR=$GLOBALVAR"
  echo "    LOCALVARx=$LOCALVARx"
  echo "    GLOBALinFNx=$GLOBALinFNx"
} 
```

**运行 TECHNIQUES 会产生以下输出...**

```
Send user prompts inside a function to stderr...
  Function foo()...
    Echoing 'this is my data'...
  foo() returned 'this is my data'

Passing global and local variables...
  Outside function: GLOBALVAR=Reusing result of foo() which is 'this is my data'

  Inside function fn()...
    GLOBALVAR=Reusing result of foo() which is 'this is my data'
    LOCALVAR=declared inside fn() with 'local' keyword is only visible in fn()
    GLOBALinFN=declared inside fn() without 'local' keyword is visible globally

  Inside function fnX()...
    GLOBALVAR=Reusing result of foo() which is 'this is my data'
    LOCALVARx=declared inside fnX() with 'local' keyword is only visible in fnX()
    GLOBALinFNx=declared inside fnX() without 'local' keyword is visible globally

  Outside function...
    GLOBALVAR=Reusing result of foo() which is 'this is my data'

    LOCALVAR=
    GLOBALinFN=declared inside fn() without 'local' keyword is visible globally

    LOCALVARx=
    GLOBALinFNx=declared inside fnX() without 'local' keyword is visible globally 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-08-07T17:27:49.107

我在这里找到了一篇不错但很旧的文章，其中提供了实用程序库的完整列表：

[http://dberkholz.com/2011/04/07/bash-shell-scripting-libraries/](http://dberkholz.com/2011/04/07/bash-shell-scripting-libraries/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-03-22T18:37:23.417

我可以告诉你，缺乏可用的函数库与 Bash 的局限性无关，而是如何使用 Bash。Bash 是一种用于自动化而非开发的快速而肮脏的语言，因此很少需要库。然后，您开始在需要共享的函数和将函数转换为要调用的完整脚本之间建立良好的界限。这是从编码的角度来看，由shell加载是另一回事，但通常根据个人喜好运行，不需要。所以......再次缺乏共享库。

以下是我在 .bashrc 中经常使用的一些函数

```
cd () {
   local pwd="${PWD}/"; # we need a slash at the end so we can check for it, too
   if [[ "$1" == "-e" ]]; then
      shift
      # start from the end
      [[ "$2" ]] && builtin cd "${pwd%/$1/*}/${2:-$1}/${pwd##*/$1/}" || builtin cd "$@"
   else
      # start from the beginning
      if [[ "$2" ]]; then
         builtin cd "${pwd/$1/$2}"
         pwd
      else
         builtin cd "$@"
      fi
   fi
} 
```

log()/err() 的一个版本存在于为程序员工作的函数库中——主要是因为我们都使用相同的样式。

```
log() {
   echo -e "$(date +%m.%d_%H:%M) $@"| tee -a $OUTPUT_LOG
}

err() {
   echo -e "$(date +%m.%d_%H:%M) $@" |tee -a $OUTPUT_LOG
} 
```

如您所见，我们在这里使用的上述实用程序并没有那么令人兴奋。我有另一个库可以解决 bash 限制的问题，我认为这是对它们的最佳用途，我建议您创建自己的库。

# c# - 如何在 C# 中使用 Enterprise Library 处理 oracle 异常？

> ID：11369526
> 
> 赞同：0
> 
> 时间：2012-07-06T20:54:08.107
> 
> 标签：c#, oracle, exception, enterprise-library

我正在使用 C#、企业库和 Oracle 为数据库构建一个 ASP.NET Web 应用程序。这是我第一次使用 Oracle 作为数据库，到目前为止我的经验并不是那么好（我更喜欢使用 MS SQL Server）。所以这是场景：

用户可以输入和更改数据库中唯一字段的值（例如，用户名）。如果用户输入一个已经作为不同记录输入的值（在此上下文中为用户名），则要求通知用户。由于插入和/或更新是通过存储过程完成的，我决定在存储过程中处理异常。为此，我声明了一个名为 NUMBER 类型的名为*erCode*的 out 参数，并将以下块添加到 SQL 语句之后的存储过程中。

```
EXCEPTION
    WHEN DUP_VAL_ON_INDEX THEN
        erCode := SQLCODE 
```

如果 INSERT/UPDATE 操作成功，我返回值为 0 的*erCode*。

自然地，由于存在返回值，因此在应用程序的数据访问层 (DAL) 中的代码的 try-catch 块中从未捕获到异常。因此，我将*erCode*的值从 DAL 返回到业务逻辑层（BLL），然后返回到 UI 层，我在 try 块中通过以下方式处理**它**：

```
if (errorCode = -1)
{
    lblMsg.Text = "Username already exists";
}
else
{
    lblMsg.Text = "Username changed successfully";
} 
```

我意识到这是一种可怕的方法，即使 oracle 错误代码是除“-1”之外的值，那么将显示*成功更改的用户名*，这将完全误导。

我不应该使用 System.Data.OracleClient.OracleException 类，因为当我们在我的工作场所与企业库相邻使用该类时，它看起来并不好。如果我们使用的是企业库，那么我们应该将它单独用于所有与数据库相关的功能。

这让我想到了我的问题；我该如何处理这种情况？是否可以单独使用企业库来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:10:33.937

如果您需要将代码作为您正在做的事情并且仍然安全，那么您可以这样做：

*   当没有遇到错误时，如果我假设返回的 ErrorCode 将是一个空值，你可以这样做：

    > ```
    > if(erCode==null)
    > errorCode = 1; 
    > ```

*   设置 ErrorCode =1 肯定会表明操作成功。

*   将您的代码修改为：

    > ```
    > if (errorCode = -1)
    > {
    >     lblMsg.Text = "Username already exists";
    > }
    > else if(errorCode = 1)
    > {
    >     lblMsg.Text = "Username changed successfully";
    > }
    > else{
    >     lblMsg.Text = "Unknown error while updating!";
    > } 
    > ```

*   因此，如果有任何其他错误代码，则会显示相关消息！

*希望你觉得值得！*

# actionscript-3 - 在发布期间包含 XML（或 JSON）数据 - Flash

> ID：11369529
> 
> 赞同：1
> 
> 时间：2012-07-06T20:54:24.187
> 
> 标签：actionscript-3, flash, flash-cs5, flash-ide

我有一个打开的 .fla，一些 actionscript 变量（url、标题等）被更改并发布。这种情况经常发生，而且是相同的变量。我只是将 .swf 文件与 XML 文件一起保存，但它被上传到第三方平台，因此所有信息都需要包含在 .swf 文件中。没有办法将变量信息添加到第三方站点。

我想知道是否有一种方法可以在发布时从 xml 文件或其他内容（如脚本？）中获取新的变量信息，而无需打开 Flash IDE。能够一次做一堆这些也很棒。

任何帮助/链接/线索将不胜感激。谷歌没有帮助我。这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T03:22:18.000

`mxmlc`如果不打开 Flash IDE，则需要使用 ANT 或仅使用编译器加载外部资源或构建脚本，效果如下：

```
mxmlc -o output.swf -source-path="src/" -library-path+=library.swc. 
```

*   [Flex 编译器](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf69084-7ffd.html)

*   [关于 mxmlc](http://www.senocular.com/flash/tutorials/as3withmxmlc/)

当您指出在编译时嵌入 XML 时，您可以使用`[Embed]`元数据标记嵌入 XML 或将您的 XML 粘贴到类中。

**嵌入 XML**

```
package
{
    public class XmlData
    {
        [Embed(source = "data.xml", mimeType = "application/octet-stream")]
        public static const Xml:Class;
    }
} 
```

要使用 XML，请将其实例`xml`化为：

```
var xml:XML = new XML( new XmlData.Xml ); 
```

**XML 变量**

否则，您可以简单地将您的 xml 粘贴到这样的类中：

```
package
{
    public class XmlData
    {
        public static const xml:XML =
            <root>
                <element />
                <element attribute="value">data</element>
            </root>;
    }
} 
```

尽管您必须编译 SWF，但这种方法很简单，因为您可以简单地将 XML 文档粘贴到类中。

这将被 e4x 正常引用，并且不需要异步加载。

```
var data:String = XmlData.xml.element.@attribute; 
```

# php - 过滤用户上传内容的恶意文件类型

> ID：11369532
> 
> 赞同：0
> 
> 时间：2012-07-06T20:54:48.043
> 
> 标签：php, virus, malware

我正在使用一个[简单的文件上传脚本](http://www.w3schools.com/php/php_file_upload.asp "关联")。该脚本允许文件类型过滤，但我不确定我应该允许/禁止哪些文件。

我应该防止上传哪些文件类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:57:35.997

您应该只允许您需要的类型（白名单）。您永远不知道您的服务器、php 或人们可以创建的文件类型会发生什么变化，以及他们可以对服务器做什么。

似乎没有理由牺牲安全性来换取更少的类型检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T20:59:01.630

找到这个（放入.htaccess）：

```
php_flag engine off 
```

'关闭' php，因此无法运行文件！然后你可以允许上传任何你想要的

（感谢 Pekka 的链接）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T21:02:25.643

$_FILES 中提供的 mime 是从浏览器发送的，因此信任它是不安全的。还有其他函数可以确定文件的 mime，但请注意，它们中的大多数都依赖于文件扩展名。这是一种不好的确定方法，因为我可以轻松地将 .exe 重命名为 .png 并且函数会报告它是图像。我不确定您的需求，但您可以将脚本限制为仅允许图像文件并检查它们是否真的是带有 imagemagick 或 gd 库的图像。

没有文件对服务器是危险的。但是，如果存在允许运行用户文件的安全漏洞，则任何文件都可能是潜在威胁。

我建议不要拒绝某些文件类型，而是允许用户可能想要上传的几个文件类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T20:58:38.417

不要列入黑名单。相反，请创建允许的文件类型的白名单。

# android - Android：保存用户使用相机拍摄的照片

> ID：11369537
> 
> 赞同：3
> 
> 时间：2012-07-06T20:55:19.943
> 
> 标签：android

我正在尝试学习如何在我的 android 应用程序中使用相机。我目前有一个带有叠加按钮的工作预览。我已将其设置为成功拍照，但是当我尝试将照片保存到 SD 卡时，它无法正常工作。它总是返回“保存期间出错”。

我知道这不是我的 SD 卡，并且我之前在另一个应用程序中使用过几乎相同的代码来保存位图，它可以成功运行。

我也知道它正在成功拍照，因为我通过让它将照片放入活动中的 ImageView 来测试它。

我不确定为什么这不起作用。

```
Button takePhoto = (Button)findViewById(R.id.takephoto);
    takePhoto.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View arg0) {

            mCamera.takePicture(shutterCallback, rawCallback,
                    jpegCallback);

        }
    });

}

ShutterCallback shutterCallback = new ShutterCallback() {
    public void onShutter() {

    }
};

/** Handles data for raw picture */
PictureCallback rawCallback = new PictureCallback() {
    public void onPictureTaken(byte[] arg0, Camera camera) {

    }
};

/** Handles data for jpeg picture */
PictureCallback jpegCallback = new PictureCallback() {
    public void onPictureTaken(byte[] arg0, Camera camera) {

        Bitmap photo = BitmapFactory.decodeByteArray(arg0, 0, arg0.length);

        tempSavePhoto(photo);

        switchToPolaroidView();

    }
};

public void tempSavePhoto(Bitmap photo){

    File root = new File(Environment.getExternalStorageDirectory() + File.separator + "Photos");
    File image = new File(root, "toSend.jpg");
    sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED, Uri.parse("file://"+ Environment.getExternalStorageDirectory())));

    boolean success = false;

    FileOutputStream outStream;
    try {

        outStream = new FileOutputStream(image);
        photo.compress(Bitmap.CompressFormat.PNG, 100, outStream); 
        /* 100 to keep full quality of the image */

        outStream.flush();
        outStream.close();
        success = true;
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    if (success) {
        Toast.makeText(getApplicationContext(), "Saved successfully",
                Toast.LENGTH_SHORT).show();
    } else {
        Toast.makeText(getApplicationContext(),
                "Error during image saving", Toast.LENGTH_SHORT).show();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T20:58:16.797

将此添加到您的清单中

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

这个应用程序很可能无权保存到您其他应用程序的 SDCard。添加此授予权限

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T23:01:28.820

我尝试了一种不同的方法，它奏效了。不知道为什么另一个不工作，但它现在保存照片就好了。这是我改用的：

```
public void tempSavePhoto(Bitmap photo){

    ByteArrayOutputStream bytes = new ByteArrayOutputStream();
    photo.compress(Bitmap.CompressFormat.JPEG, 40, bytes);

    File f = new File(Environment.getExternalStorageDirectory()
                            + File.separator + "test.jpg");
    try {
        f.createNewFile();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    FileOutputStream fo = null;
    try {
        fo = new FileOutputStream(f);
    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    try {
        fo.write(bytes.toByteArray());
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED, Uri.parse("file://"+ Environment.getExternalStorageDirectory())));

} 
```

请注意，我从[这篇文章](https://stackoverflow.com/questions/4263375/android-saving-created-bitmap-to-directory-on-sd-card)中得到了这个想法，并对对我有帮助的答案投了赞成票。

# ruby-on-rails - 在咖啡脚本文件中使用 url_helpers 和生产中的基本 url

> ID：11369546
> 
> 赞同：1
> 
> 时间：2012-07-06T20:56:06.857
> 
> 标签：ruby-on-rails, asset-pipeline, ruby-on-rails-3.2, rails-routing

我正在尝试在 coffescript 文件中使用 Rails url_helpers。我将 .erb 扩展名附加到文件名 (profile.js.coffee.erb) 并使用 ERB 访问帮助程序，如下所示：

```
jQuery ->
  window.Intl.Models.Profile = Backbone.Model.extend
    url: '<%= Intl::Application.routes.url_helpers.profile_path %>' 
```

这在开发中效果很好，它会返回`/profile`。在生产中，我使用的是 URL 根目录，`/intl`因此我告诉资产预编译器在 deploy.rb 中考虑这一点

```
set :asset_env, "#{asset_env} RAILS_RELATIVE_URL_ROOT='/intl'" 
```

但是，这似乎不会影响 url_helpers 因为它仍然会返回`/profile`而不是`/intl/profile`

我尝试分别在 production.rb 和 development.rb 中设置 ENV["RAILS_RELATIVE_URL_ROOT"] ，但这也不起作用。

任何建议，将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-28T07:59:05.893

这里同样的问题。作为我使用的部分解决方案

```
set :asset_env, "#{asset_env} RAILS_RELATIVE_URL_ROOT=/csc" 
```

在 deploy.rb 中用于 Capistrano 部署。这适用于资产预编译的所有其他方面，除了这个单一方面 (.coffee.erb) 似乎完全不受该设置的影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T06:55:19.257

您可能需要在机架级别进行设置。如果您使用Passenger，您可以设置`RackBaseURI`指令。

# android - 无法将调试器连接到 Jelly Bean Galaxy Nexus

> ID：11369552
> 
> 赞同：6
> 
> 时间：2012-07-06T20:56:52.467
> 
> 标签：android, debugging, android-4.2-jelly-bean

我们有来自 Google IO 的 Jelly Bean Galaxy Nexus，并安装了 Android SDK 的所有最新更新 - 但我们无法在 Intellij IDEA 的设备上使用 USB 调试。

我们将项目设置为使用 4.1 SDK 等进行编译。没有运气。有谁知道如何在新的 Jelly Bean Galaxy Nexus 上进行 USB 调试？

（编辑）这是在运行 OS X 10.7.4 的 Mac 上尝试的——所以理论上驱动程序应该不是问题？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-16T20:20:36.490

最新的 android 似乎在设置中隐藏了开发者菜单，这是你必须玩的游戏才能找回它：

> 1.  设置->关于手机
> 2.  向下滚动到底部，直到看到内部版本号
> 3.  单击内部版本号 7 次

您现在是一名开发人员。返回主设置菜单，您将再次拥有开发者菜单

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-07T12:54:27.300

我通过将 USB 连接从 MTP 更改为 PTP 解决了我的 Nexus 7 上的此类问题（我的 Galaxy Nexus 没有问题）。

转到设置 > 存储 > 角落菜单 > USB 计算机连接 > 选择“PTP”。

我希望这能解决你的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-18T18:58:18.577

奇怪的是，打开 Android SDK 管理器并确保一切都是最新的（它是），然后重新启动 IDEA 修复了这个问题。我现在可以连接到 Galaxy Nexus。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-22T13:15:46.127

我正在运行 Mac OS 10.8 并在安装 Google 的 Filetransfer 应用程序后设法让 ADB 和调试器与 Nexus 7 一起工作：

[http://www.android.com/filetransfer/](http://www.android.com/filetransfer/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-21T18:49:25.770

I have been having issues trying to get IntelliJ to recognize my nexus 7 ever since I installed it. I was about to go back to windows 7 until I found @eyal-lezmy suggestion. Tried it and everything works great. Mind you I tried getting latest drivers for the laptop and from the Android SDK nothing would work till I changed the connection type from mtp to ptp. Also windows detected the device just that IntteliJ would not.

# core-data - 多个索引路径

> ID：11369553
> 
> 赞同：0
> 
> 时间：2012-07-06T20:56:56.437
> 
> 标签：core-data, nsindexpath

我需要在索引路径的 cellForRow 中的 tableview 上实现两个不同的索引路径...一个包含来自我获取的结果控制器的数据，另一个用于简单文本。

解决此问题的最佳方法是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T19:45:13.717

我不确定您的要求是什么，但听起来您想要一个表格，其中一个部分包含 NSFetchedResultController 的结果，另一部分包含来自其他来源的数据。这很容易做到。如果您的数据不需要位于多个部分中，那么这很容易，只需从 fetchedResultController 获取第 0 部分的数据，并为第 1 部分获取其他数据。

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView{
    return 2;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    if(section == 0){    
        id  sectionInfo = [[fetchedResultsController sections] objectAtIndex:section];
        return [sectionInfo numberOfObjects];
     }else{
        return self.someArray.Count;
     }
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
     if(indexpath.section == 0){    
          static NSString *CellIdentifier = @"data cell";
          UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
           NSObject *foo = [self.fetchedResultController objectAtIndexPath:indexPath];
           //configure cell
          return cell;
      }else{
          static NSString *CellIdentifier = @"some other cell";
          UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

           //configure cell
          return cell;
     }
} 
```

# java - 使用 WatchService 监控映射网络驱动器上的多个目录

> ID：11369555
> 
> 赞同：0
> 
> 时间：2012-07-06T20:56:59.060
> 
> 标签：java, nio, java-7

我想使用新的 Java 7 WatchService 来密切关注用户指定的一组目录。在 Windows 7 上，这在本地文件系统和映射网络驱动器上运行良好，可用于任意复杂的文件树。然而，在 Windows XP 上，它在本地文件系统上运行良好，但是当查看映射网络驱动器上的文件夹时，它会在尝试查看超过 50 个目录时抛出 IOException：

```
java.io.IOException: The network BIOS command limit has been reached. 
```

尝试在第 51 个目录上调用 Path.register() 时总是会发生这种情况，因此这似乎是对可以监视的目录数量的硬性限制。有什么方法可以删除此限制，以便它始终在 Win 7 和 Win XP 上监视任意数量的目录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T06:20:46.500

请参阅[http://support.microsoft.com/kb/810886](http://support.microsoft.com/kb/810886)以增加对 windows 的限制

# ruby-on-rails - rails 3.2.6 应用程序无法启动 - wrap_parameters.rb:8: 语法错误，意外 ':'，期待 kEND (SyntaxError)

> ID：11369556
> 
> 赞同：1
> 
> 时间：2012-07-06T20:57:03.800
> 
> 标签：ruby-on-rails, ruby

ruby 版本 - ruby​​ 1.9.3p0（2011-10-30 修订版 33570）[x86_64-linux]

轨道版本 - Rails 3.2.6

宝石版本 - 1.8.15

操作系统 - Ubuntu 12.04

我确实跑来`sudo gem install rubygems-update -v 1.8.24`更新 ruby​​gems 版本

启动rails服务器后，出现异常

```
/var/lib/gems/1.8/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:245:in `load': /home/work/AptanaWorkspace/ordernile/config/initializers/wrap_parameters.rb:8: syntax error, unexpected ':', expecting kEND (SyntaxError)
  wrap_parameters format: [:json]
                         ^
    from /var/lib/gems/1.8/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:245:in `load'
    from /var/lib/gems/1.8/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /var/lib/gems/1.8/gems/activesupport-3.2.6/lib/active_support/dependencies.rb:245:in `load'
    from /var/lib/gems/1.8/gems/railties-3.2.6/lib/rails/engine.rb:588
    from /var/lib/gems/1.8/gems/railties-3.2.6/lib/rails/engine.rb:587:in `each'
    from /var/lib/gems/1.8/gems/railties-3.2.6/lib/rails/engine.rb:587
    from /var/lib/gems/1.8/gems/railties-3.2.6/lib/rails/initializable.rb:30:in `instance_exec'
    from /var/lib/gems/1.8/gems/railties-3.2.6/lib/rails/initializable.rb:30:in `run'
    from /var/lib/gems/1.8/gems/railties-3.2.6/lib/rails/initializable.rb:55:in `run_initializers'
    from /var/lib/gems/1.8/gems/railties-3.2.6/lib/rails/initializable.rb:54:in `each'
    from /var/lib/gems/1.8/gems/railties-3.2.6/lib/rails/initializable.rb:54:in `run_initializers'
    from /var/lib/gems/1.8/gems/railties-3.2.6/lib/rails/application.rb:136:in `initialize!'
    from /var/lib/gems/1.8/gems/railties-3.2.6/lib/rails/railtie/configurable.rb:30:in `send'
    from /var/lib/gems/1.8/gems/railties-3.2.6/lib/rails/railtie/configurable.rb:30:in `method_missing' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:25:06.973

问题描述不足以说明可能导致异常的原因。但很明显，Ruby on Rails 是在 ruby​​ 1.8 而不是 1.9 下运行的。

我的建议是：

*   安装以下 ruby​​ 版本管理工具之一。[RVM](https://rvm.io/)或[rbenv](https://github.com/sstephenson/rbenv/)。他们将帮助您管理整个系统的 Ruby 版本，在不同项目之间切换 Ruby 版本。我个人更喜欢 rbenv，该站点列出了所有优点。

安装和配置您的项目或全局 Ruby 版本后： 1\. 仔细检查您当前的 ruby​​ 版本`ruby --version` 2\. 运行`gem install bundler` 3\. 在项目根文件夹下运行`bundle update`

如果 RoR 的 Gemfile 配置正确，第二步应该可以安装所有的依赖。确保您已完成所有设置并完成数据库配置`rake db:migrate`

# linux - diff命令忽略新目录中的新文件

> ID：11369559
> 
> 赞同：4
> 
> 时间：2012-07-06T20:57:16.593
> 
> 标签：linux, bash, shell, linux-kernel

我在“修改目录”（在第三个子级文件夹中）添加了一个新文件，当我尝试使用以下命令生成补丁文件时，似乎 diff 命令忽略了新文件：

```
diff –ur "original directory" "modified directory" > version1.patch 
```

我感谢您的帮助..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T21:06:14.570

你还需要`-N`标志。来自`man diff`：

```
 -N  --new-file
          Treat absent files as empty. 
```

生成补丁时，“标准”差异标志是`-Npur`. 您已经发现了为什么需要`-N`；`-p`使补丁更易于人类阅读。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-07T01:47:36.890

试试这个命令，

**diff -RuN "原始目录" "修改目录" > version.patch**

# javascript - 未使用的变量设置为什么？

> ID：11369561
> 
> 赞同：0
> 
> 时间：2012-07-06T20:57:24.610
> 
> 标签：javascript

特别是对于`localStorage.foo`

对于 Safari，它设置为：

```
undefined 
```

对于 Firefox，它设置为：

```
null 
```

有人知道 Chrome 和 IE 的值吗？

为什么不一样？只是浏览器程序员的随机选择？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-06T20:58:21.410

它总是`undefined`。也许您的观察方法使您相信不同浏览器中的值不同。

哦，我将为旧版本的 IE 限定该声明，据我所知，它可能会做一些其他事情。我敢打赌他们`undefined`也用。

啊——主角先生有一个有趣的观点。在任何*普通*对象上，不存在的属性将是`null`. 但是，Firefox 确实似乎确实报告`null`了一个不存在的属性的值，特别是`localStorage`. 嗯...我的投票是那是一个错误，但我会检查 w3c 规范（或 proto-spec 或任何它）。

“价值”`undefined`并不是真正的价值。这更像是佛教的*穆*——有点像在说，“你所要求的没有意义”。`null`JavaScript 中的值的处理方式与`undefined`. 因此：

```
var a = {};
var b = a.banana; 
```

变量“b”将是`undefined`。这很奇怪，但它可以让您区分存在`null`的属性与缺少的属性之间的区别。（当然，`in`操作员也可以让您弄清楚。）

# javascript - 为什么我的backbone.js 集合重置只添加了1 个模型

> ID：11369562
> 
> 赞同：12
> 
> 时间：2012-07-06T20:57:25.873
> 
> 标签：javascript, collections, backbone.js

有问题的集合抓住了一堆朋友，然后它`reset`用来保存所有新朋友。我遇到的问题是它只向集合中添加了 1 个朋友。

我做了一个`console.log`，`cModels`它在数组中显示了 300 多个对象，所以我知道不只有 1。重置只会添加 1 的任何原因？

这是我的收藏：

```
FriendsCollection = Backbone.Collection.extend({
    model: UserModel,

    getFriends: function () {
        $.post(baseUrl + dataFriendsUrl, $.proxy(function(data) {
            var friends = $.parseJSON(data);
            var cModels = [];

            for(var key in friends.data) {                
                var user = new UserModel();
                user.set({
                    fbid: friends.data[key].id,
                    username: friends.data[key].name
                });

                cModels.push(user);
            }

            this.reset(cModels);

            console.log(this);

        }, this));
    }
}); 
```

在使用开发人员工具检查模型后，模型看起来很好。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-06T21:16:01.350

这可能是因为模型具有相同的 id。

Backbone 集合不允许具有重复 id 值的模型。（请参阅此[提交](https://github.com/documentcloud/backbone/commit/18fba5772430f667c0d3cfb88d880039381c25fa)）

# syntax - 从哪里获得 EPUB 语法规范？

> ID：11369568
> 
> 赞同：0
> 
> 时间：2012-07-06T20:57:47.013
> 
> 标签：syntax, specifications, epub

我需要知道 EPUB 是如何编写的详细信息，我在哪里可以获得官方规格？哪个实体关心 EPUB 格式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T21:06:30.560

规格在[这里](http://idpf.org/epub/30)。

控制它的组织是国际数字出版论坛 (IDPF)，如[epub](/questions/tagged/epub "显示标记为“epub”的问题")标签 wiki中所述

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T21:05:59.440

国际[数字出版论坛](http://idpf.org/)定义了 EPUB 的[规范](http://idpf.org/epub/30/spec/epub30-overview.html)。

# .net - 通过网络唯一地识别网络表单的移动设备

> ID：11369569
> 
> 赞同：1
> 
> 时间：2012-07-06T20:57:53.123
> 
> 标签：.net, windows-mobile, static-ip-address

我正在为移动设备设计一个系统，一次只能分配给一个工作。因此，我需要能够通过访问它自己的唯一静态 IP 地址或其设备 ID 来了解正在使用哪个移动设备。我不想自己为每台机器分配一个 ID，这就是为什么静态 IP 可以很好地工作的原因。

但是，在尝试检索客户端 IP 地址时，我正在检索无线路由器的 IP 或其他一些不是移动设备 IP 的 IP。

我想将该 ip 存储在一个表中并控制分配给它的作业。我怎样才能做到这一点？

我已经尝试了以下方法，但我得到了无线 ip：

```
 var hostEntry = Dns.GetHostEntry(Dns.GetHostName());
    var ip = (
               from addr in hostEntry.AddressList
               where addr.AddressFamily.ToString() == "InterNetwork"
               select addr.ToString()
        ).FirstOrDefault(); 
```

如果存在更好的选择，我宁愿不设置 cookie。

蒂亚！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T14:08:44.707

当您使用手机访问您的网页时，您对唯一 ID 的选择更加有限（与原生移动应用程序相比）。在过去的 13 年中，我已经构建了 100 多个移动（原生）系统，但从未创建过移动 Web 应用程序，如果我有点“错过目标”，请原谅我。

如果您正在寻找 MAC 地址、GUID 或手机的 IMEI（或其他一些唯一值），在我看来，使用一些 JavaScript 是一个合理的起点——因为此查询需要在手机上执行，并且该值需要作为 GET 或 POST 调用的一部分传入。作为替代方案，您可以检查新的 HTML5 是否支持对其主机的任何类型的直接“查询”能力？

如果我是你，我会远离 IP 地址，因为这会很快改变（用户走到星巴克并通过蜂窝网络访问服务器，然后在点咖啡时拿起 Wi-Fi），然后上电梯并开启办公网络。

不过，您可能希望避免使用 cookie，它仍然是一种有效的方法（如果唯一值需要在会话中保持不变）。此外，如果值不需要跨会话保持不变，只需创建 GUID / UUID 作为服务器初始响应的一部分（包括在来自手机的所有后续会话调用中）。任何与 cookie 相关的内容都存在用户删除 cookie 的潜在问题，从而使客户端显示为新用户 - 具体取决于您的要求。

最后，自己创建一个 GUID (JavaScript) 并将其作为请求的一部分提交（显然这不会在会话中持续存在）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T17:03:01.400

你应该更好地描述你的环境。看起来您正在运行带有 .net 代码的 IIS。如果您正在寻找在 PHP 中获取客户端 IP 地址（如果您也在 IIS 上运行 PHP），您可以使用此处的答案[如何在 PHP 中获取客户端 IP 地址？](https://stackoverflow.com/questions/3003145/how-to-get-client-ip-address)：使用 $_SERVER['HTTP_X_FORWARDED_FOR'] 并保存 $_SERVER['REMOTE_ADDR']

如果您仅使用 .NET（无 PHP）运行 IIS，则可以使用[在负载平衡环境中获取 IIS 服务器变量的客户端值](https://stackoverflow.com/questions/4946538/getting-client-values-of-iis-server-variables-in-load-balanced-environment)的答案：HttpContext.Current.Request.ServerVariables.Item("REMOTE_HOST") 和 Request.ServerVariables( “X-Forwarded-For”）

问候

约瑟夫

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T21:03:43.660

你可以用[`GetDeviceUniqueID`](http://www.pinvoke.net/default.aspx/coredll.GetDeviceUniqueID)这个。看：

[http://blogs.msdn.com/b/windowsmobile/archive/2006/01/09/510997.aspx](http://blogs.msdn.com/b/windowsmobile/archive/2006/01/09/510997.aspx)

...除非您尝试为通过 IE 移动设备发出 Web 请求的设备获取唯一的设备 ID。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T21:12:30.107

您可以使用[MAC 地址](http://en.wikipedia.org/wiki/MAC_address)。您可以使用[.Net Compact Framework](https://stackoverflow.com/questions/42814/mac-address-in-compact-framework)检索它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-09T13:27:33.400

我从这个[网站](http://aspalliance.com/cookbook/ViewSource.aspx?Filename=Recipe2110cs.aspx&RecipeType=ASPX)得到了答案。

我将 Request.ServerVariables["REMOTE_ADDR"] 传递给上述站点中的函数，并获得了我将用来识别每台机器的客户端计算机名称。IP 可以更改，但计算机名称很少会更改。感谢您的输入。

# javascript - d3.js 跳过文本转换（3 个转换中的第二个）

> ID：11369571
> 
> 赞同：1
> 
> 时间：2012-07-06T20:57:58.170
> 
> 标签：javascript, transition, d3.js

改编自“绑定二维数据”部分：[http ://christopheviau.com/d3_tutorial/](http://christopheviau.com/d3_tutorial/)

```
dataset = new Array()
dataset[0] = ['first', 'second', 'third']

d3.select("#viz")
.append("table")
.style("margin", "0 auto")
.selectAll("tr")
.data(dataset)
.enter()
.append("tr")
.selectAll("td")
.data(function(d){return d;})
.enter()
.append("td")
.style("border", "1px black solid")
.style("padding", "10px")
.text(function(d){return d;})
.style('font-size', '18pt')

.transition().delay(1000)
.text('nothing')

.transition()
.delay(1000)
.text('test'); 
```

代码也托管在这里：http: [//jsfiddle.net/LittleBobbyTables/vEfgu/](http://jsfiddle.net/LittleBobbyTables/vEfgu/)

这会跳过文本应该说“无”的阶段并直接说“测试”。

我做错什么了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T23:47:31.637

一个接一个地调用转换不一定“链接”它们，在您的示例中，在 1000 毫秒后，第一个和第二个转换将同时执行 - 所以您看不到第一个转换的结果。解决此问题的最简单方法是更改​​第二次转换的延迟：

```
.transition().delay(2000) 
```

# java - 如何使用 JAXB Marshaller 编组 java.lang.Exception？

> ID：11369582
> 
> 赞同：0
> 
> 时间：2012-07-06T20:59:04.970
> 
> 标签：java, jaxb, marshalling

我正在尝试编组 java.lang.Exception，但没有成功。这是我的代码 -

```
import java.io.File;
import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBException;
import javax.xml.bind.Marshaller;

public class JAXBTester
{
    public static void main(String[] args) throws Exception
    {
       TestReport report = new TestReport();
       report.setReportLog("Tests successful.");

       File file = new File("TestReport.xml");
       JAXBContext jaxbContext = JAXBContext.newInstance(TestReport.class);
       Marshaller jaxbMarshaller = jaxbContext.createMarshaller();

       jaxbMarshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
       jaxbMarshaller.marshal(report, file);
    }
} 
```

这是我要编组的课程-

```
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement
public class TestReport
{
    private String reportLog;
    private Exception exception;

    @XmlElement
    public void setReportLog(String reportLog) { this.reportLog = reportLog; }

    public String getReportLog() { return reportLog; }

    @XmlElement
    public void setException(Exception exception) { this.exception = exception; }

    public Exception getException() { return exception; }

} 
```

我得到以下异常 -

```
Exception in thread "main" com.sun.xml.internal.bind.v2.runtime.IllegalAnnotationsException: 1 counts of IllegalAnnotationExceptions
java.lang.StackTraceElement does not have a no-arg default constructor.
    this problem is related to the following location:
        at java.lang.StackTraceElement
        at public java.lang.StackTraceElement[] java.lang.Throwable.getStackTrace()
        at java.lang.Throwable
        at java.lang.Exception
        at public java.lang.Exception TestReport.getException()
        at TestReport

    at com.sun.xml.internal.bind.v2.runtime.IllegalAnnotationsException$Builder.check(IllegalAnnotationsException.java:91)
    at com.sun.xml.internal.bind.v2.runtime.JAXBContextImpl.getTypeInfoSet(JAXBContextImpl.java:451)
    at com.sun.xml.internal.bind.v2.runtime.JAXBContextImpl.<init>(JAXBContextImpl.java:283)
    at com.sun.xml.internal.bind.v2.runtime.JAXBContextImpl.<init>(JAXBContextImpl.java:126)
    at com.sun.xml.internal.bind.v2.runtime.JAXBContextImpl$JAXBContextBuilder.build(JAXBContextImpl.java:1142)
    at com.sun.xml.internal.bind.v2.ContextFactory.createContext(ContextFactory.java:130)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at javax.xml.bind.ContextFinder.newInstance(ContextFinder.java:248)
    at javax.xml.bind.ContextFinder.newInstance(ContextFinder.java:235)
    at javax.xml.bind.ContextFinder.find(ContextFinder.java:445)
    at javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:637)
    at javax.xml.bind.JAXBContext.newInstance(JAXBContext.java:584)
    at JAXBTester.main(JAXBTester.java:14) 
```

这是因为我正在尝试编组 java.lang.Exception。如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:37:28.503

还有其他方法可以做到这一点，例如评论者引用的方法。但这里有另一种方式......

`Throwable`Java 中的类（的超类`Exception`）在 的意义上是可序列化的`java.io.Serializable`。这意味着您可以将其写入字节流，然后稍后从这些字节中重构它。（您的应用程序可能有编写不佳的不可序列化子类`Throwable`. 如果是这种情况，则以下内容将不起作用。）

`Throwable`所以解决这个问题的一种方法是编写一个自定义适配器，将(or )序列化为`Exception`字节。在 XML 中，您会看到这些字节的十六进制。然后在接收端，您可以取消序列化，然后使用`Throwable`您开始使用的（精确副本）。

这种方式的坏处是异常在 XML 中不是人类可读的。好的部分是它非常简单。在您的`TestReport`班级上，将此注释放在您的`Exception`吸气剂上：

```
@XmlJavaTypeAdapter(ThrowableAdapter.class)
public Exception getException() { return exception; }

public void setException(Exception exception) { this.exception = exception; } 
```

然后将此适配器类添加到您的项目中：

```
import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;

import javax.xml.bind.annotation.adapters.HexBinaryAdapter;
import javax.xml.bind.annotation.adapters.XmlAdapter;

public class ThrowableAdapter extends XmlAdapter<String, Throwable> {
    private HexBinaryAdapter hexAdapter = new HexBinaryAdapter();

    @Override
    public String marshal(Throwable v) throws Exception {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        ObjectOutputStream oos = new ObjectOutputStream(baos);
        oos.writeObject(v);
        oos.close();
        byte[] serializedBytes = baos.toByteArray();
        return hexAdapter.marshal(serializedBytes);
    }

    @Override
    public Throwable unmarshal(String v) throws Exception {
        byte[] serializedBytes = hexAdapter.unmarshal(v);
        ByteArrayInputStream bais = new ByteArrayInputStream(serializedBytes);
        ObjectInputStream ois = new ObjectInputStream(bais);
        Throwable result = (Throwable) ois.readObject();
        return result;
    }
} 
```

然后您的 XML 将包含如下元素：

```
<exception>AED...</exception> 
```

除了 in 而不是`...`你会看到一个巨大的十六进制字符串。当它在另一边未编组时，它会和原来的一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T15:39:43.827

你使用 JRE 1.7 吗？如果我使用随 JRE 分发的 JAXB 版本，则不会出现此异常。但是，如果我明确包含 JAXB v. 2.1.7，我会遇到这个问题。因此，我建议从类路径中删除所有 jaxb 实例，并使用 Java 运行时中包含的实例。

JRE 6 似乎使用 2.1.x，而 JRE 7 2.2.x 可能正确处理 Throwable 实现中的更改。

可以通过运行找到包含在 JDK 中的 JAXB 版本

```
<JDK_HOME>/bin/xjc -version 
```

# java - 重定向到 Java 程序？

> ID：11369586
> 
> 赞同：0
> 
> 时间：2012-07-06T20:59:17.710
> 
> 标签：java, apache-karaf

在一个项目中，我正在尝试为 Apache Karaf 设置一个自动构建系统（我需要在 Karaf 中运行几个命令来设置全新安装的工作环境）。Karaf 包含一个批处理/脚本文件，它设置几个参数，然后调用实际的 Java 程序。本质上，我希望能够执行以下操作：

```
java MyProgramClass.class < commandTextFile.txt 
```

但是当我尝试这个时，它什么也没做。我的目标是简单地复制 karaf.bat 文件，稍微修改它（如下所示）以制作一个我可以运行的“karaf-install.bat”。我修改了 karaf.bat 的部分如下，我所做的只是`< "C:\commandFile.txt`在最后添加（以下都是一行，为便于阅读而中断）：

```
"%JAVA%" %JAVA_OPTS% %OPTS% -classpath "%CLASSPATH%" 
  -Djava.endorsed.dirs="%JAVA_HOME%\jre\lib\endorsed;%JAVA_HOME%\lib\endorsed;%KARAF_HOME%\lib\endorsed" 
  -Djava.ext.dirs="%JAVA_HOME%\jre\lib\ext;%JAVA_HOME%\lib\ext;%KARAF_HOME%\lib\ext"
  -Dkaraf.instances="%KARAF_HOME%\instances" -Dkaraf.home="%KARAF_HOME%" 
  -Dkaraf.base="%KARAF_BASE%" -Dkaraf.data="%KARAF_DATA%" 
  -Djava.util.logging.config.file="%KARAF_BASE%\etc\java.util.logging.properties" 
  %KARAF_OPTS% %MAIN% %ARGS% < "C:\commandFile.txt" 
```

然而，卡拉夫什么也没显示。它就像我正常执行它一样运行；我的命令没有执行。有没有办法从控制台重定向到 Java 程序？我做错了吗？

无论如何，这最终将在 Windows 和 OS X 上完成，但我目前专注于 Windows。

**更新：**原来这似乎对我在 OS X 上工作（卡拉夫挣扎（通过说“找不到命令：”），但我认为这是因为它在初始化所有内容之前获取命令），但 Windows 仍然没有甚至得到命令。我会多打几下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:03:54.323

管道 INTO 时，您可以从`System.in`.

将其视为 Reader，而不是 InputStream。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:02:19.213

我只是将这个问题写成 Karaf 的怪异，因为它可以在 OS X 上运行。我可以通过使用`client`Karaf 附带的程序来解决它（在 OS X 上的 .sh 文件中）：

```
"$KARAF/bin/client" "karaf_command_here" 
```

或（在 Windows 上的 .bat 文件中）

```
call "%KARAF%\bin\client.bat" "karaf_command_here" 
```

而不是有一个命令列表来管道到 Karaf，我只是将命令列表创建为一个 shell/batch 脚本文件，该文件将为`client`每个命令调用 Karaf 的。不像我喜欢的那样漂亮，但它完成了工作。

`client`（注意你需要在使用with之前启动 Karaf `start`（并用 关闭它`stop`））。

# iphone - 如何忽略 iOS 模拟器的一些静态库

> ID：11369589
> 
> 赞同：3
> 
> 时间：2012-07-06T20:59:37.873
> 
> 标签：iphone, ios, xcode, xcode4

我正在尝试为 sdk iphoneos 和 iphonesimulator 构建我的项目。很少有 .a 静态库只能用于 iphoneos。如果这些文件是为 XCode 中的 iphonesimulator 构建的，我在哪里可以忽略这些文件？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-07T03:15:34.520

不要硬链接库，而是使用项目配置设置中的“其他链接器标志”设置。您将能够根据当前的构建配置链接不同版本的库。

默认情况下，您已经有 Debug 和 Release 构建配置，按 Debug 上的“加号”按钮将为特定架构添加配置。选择“任何 iOS 模拟器”并链接您要用于在模拟器上运行应用程序的库。然后再次按下 Debug 上的“加号”按钮，这次选择“Any iOS”并链接您想要用于在设备上运行应用程序的库。

最后，对 Release 配置做同样的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T21:27:22.003

您可以设置两个目标，一个用于模拟器，一个用于设备，并在模拟器目标设置（Build Phases -> Link Binary With Libraries）中删除不需要的 *.a 文件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T01:57:14.787

我刚遇到这个问题，我通过为模拟器创建一个新目标来解决。

在新目标上，您可以转到目标设置 -> 构建阶段 -> 将二进制文件与库链接，并仅为该目标删除静态库。

还要确保不使用`TARGET_IPHONE_SIMULATOR`宏进行检查来包含静态库中的文件，就像@MDT 所做的那样。

# regex - 在代码块中查找字符串（正则表达式）

> ID：11369590
> 
> 赞同：0
> 
> 时间：2012-07-06T20:59:44.237
> 
> 标签：regex, linux, string, grep, newline

我需要在代码块（当然可以包含换行符）中找到包含字符串的文件的名称，或者更具体地说：构造函数中的某些方法调用（我们称之为**methodName**）。我需要查看当前目录及其子目录中的所有 java 代码文件。

可能的匹配是：

```
public myClass() {
  a(1);
  b();
  myMethod("abc");
  c(5);
} 
```

这是我到目前为止提出的表达方式：

```
find . -name *.java | xargs nawk '{print $0 "~("FILENAME")"}' | tr -d "\n" | grep -s -i -o 'public \w\+([^)]*).*methodName([^~]*~([^)]*)' 
```

所以...
- *.java 文件是递归找到的
- 每一行都被打印出来，旁边是它所属的文件名（只是为了跟踪它是在哪里找到
的） - 删除 \n 以便能够使用 grep在一个块中
- 然后查找**methodName**。

问题是每次我需要使用 .* 时，我都必须将表达式更改为下一个表达式的否定，然后是下一个表达式。例如：如果我需要`.*\~`，我需要做`([^~]*~`......这不是很好，但我可以忍受它。问题来自**methodName**，因为否定该字符串会更痛苦。

有任何想法吗？可以用正则表达式完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T05:35:45.800

你正在与贪婪作斗争。`.*`默认情况下会变得贪婪，因此它将尽可能多地消耗，成为一切。只有在它消耗完所有内容后，它才会尝试匹配表达式的下一部分`m`并回溯，直到匹配为止。如果它确实找到了模式的其余部分，它将匹配从 ('public \w+([^)]*)') 前面的模式的第一次出现到( )`.*`后面的模式的最后一次出现的所有内容。`.*``methodName([^~]*~([^)]*)`

解决方法是让`.*`lazy: `.*?`，给你完整的表达方式`public \w\+([^)]*).*?methodName([^~]*~([^)]*)`

有趣的是，在您使用否定字符类的情况下，您使用否定字符类的解决方法是首选解决方案，但是，是的，做类似的事情`methodName`可能会变得有点笨拙。

请参阅：[懒惰而不是贪婪](http://www.regular-expressions.info/repeat.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:51:29.777

尝试使用 sed 代替 grep。以下内容可能会帮助您入门：

```
find . -name *.java | xargs awk '{print $0 "~("FILENAME")"}' | \
sed -n '                                  # start sed with automatic printing suppressed
/public \w\+/,/^}/H                       # append all constructors to hold space
$!d                                       # stop here unless this is the last line
g                                         # copy hold space to pattern space
s/.*methodName([^~]*~(\([^)]*\)).*/\1/p   # if methodName is called, print the file name
' 
```

# sql-server-ce - SQL Server Compact 筛选索引

> ID：11369592
> 
> 赞同：0
> 
> 时间：2012-07-06T21:00:04.400
> 
> 标签：sql-server-ce, filtered-index

任何版本的 SQL Server Compact 都支持筛选索引吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T22:09:30.553

我下载并安装[了适用于 SQL Server Compact 4.0 的联机丛书](http://www.microsoft.com/en-us/download/details.aspx?id=21880)，没有发现过滤索引的痕迹，并且语法图不包含 where 子句：

```
CREATE [UNIQUE] [NONCLUSTERED] INDEX index_name 
ON table_name (column_name [ASC|DESC][,…n])
WITH (STATISTICS_NORECOMPUTE = { ON | OFF })] 
```

所以我相信答案是，不，SQL Server Compact 不支持过滤索引。对不起。

# java - fork / join 是多线程的吗？

> ID：11369593
> 
> 赞同：2
> 
> 时间：2012-07-06T21:00:10.457
> 
> 标签：java, fork-join

如果我有 2 个 CPU 并为 fork / join 框架安排 1000 个任务来处理，这些任务一次最多执行 2 个，还是会在同一个 CPU 上并行执行更多任务？（比如说，也许一个任务正在等待 I/O，在这种情况下 CPU 会变得空闲，另一个线程可以运行）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T21:05:32.753

如果您自己不包含任何限制，则不会应用任何限制，Java 将分叉尽可能多的线程（可能全部 1000 个，具体取决于系统限制）。这并不理想。如果您正在执行的计算可能需要一些 IO 时间，但即使在大量并发处理时也不受 IO 限制，那么您可能能够证明比可用 CPU 数量多运行一个线程是合理的。一次运行所有 1000 个是不明智的。

> 如果我有 2 个 CPU 并为 fork / join 框架安排 1000 个任务来处理，这些任务一次最多执行 2 个，还是会在同一个 CPU 上并行执行更多任务？

如果你有一个双核 CPU，你实际上一次只能执行 2 个线程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T21:55:41.597

根据[ForkJoin 文档](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ForkJoinPool.html)：

> ForkJoinPool 是用给定的目标并行级别构造的； ***默认情况下，等于可用处理器的数量***。池尝试通过动态添加、挂起或恢复内部工作线程来维持足够的活动（或可用）线程，即使某些任务暂停等待加入其他任务也是如此。但是，面对阻塞的 IO 或其他非托管同步，不能保证这样的调整。

因此，它可能会在您的 2 个 CPU 上一次运行两个，如果 CPU 是超线程的，则可能一次运行四个（我不确定）。如果您对默认的并行级别不满意，您可以通过调用将并行级别作为参数的 ForkJoinPool 构造函数来指定请求的并行级别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T21:11:07.080

cpu上是否启用了超线程？如果是这样，您可以同时运行 2 个以上的进程。

> 超线程的工作原理是复制处理器的某些部分——那些存储架构状态的部分——但不复制主要的执行资源。这允许超线程处理器对主机操作系统表现为两个“逻辑”处理器，从而允许操作系统同时调度两个线程或进程。

*   [超线程@维基百科](http://en.wikipedia.org/wiki/Hyper-threading)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T05:15:23.033

我做了一个测试来验证这一点：

```
import java.util.concurrent.*;

public class Test {
    private static class TestAction extends RecursiveAction {
        private int i;

        public TestAction(int i) {
            this.i = i;
        }

        protected void compute() {
            if (i == 0) {
                invokeAll(new TestAction(1), new TestAction(2), new TestAction(3),
                          new TestAction(4), new TestAction(5), new TestAction(6));
                return;   
            }             
            System.out.println(i + " start");
            try { Thread.sleep(2000); } catch (Exception e) { }
            System.out.println(i + " end"); 
        }   
    }       

    public static void main(String[] args) {
        new ForkJoinPool().invoke(new TestAction(0));
    }   
} 
```

使用参考 Oracle 实现运行的结果是：

```
1 start
6 start <- wait 2 seconds
1 end
2 start
6 end
5 start <- wait 2 seconds
2 end
3 start
5 end
4 start <- wait 2 seconds
4 end
3 end 
```

Linux 和 Mac OS X 上的相同行为是一致的。

所以问题的答案是：是的，任务将在并行参数指定的 CPU 数量（或默认情况下的可用 CPU 总数）上执行。如果 CPU 时间可用并且任务只是阻塞等待某事，那么框架将不会自动执行任何操作来运行其他任务。

由于到目前为止我看到的文档对于如果 CPU 空闲，框架应该做什么非常模糊，这可能是一个实现细节。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-02T12:45:26.780

默认情况下，Fork/Join 框架尝试保持线程数等于内核数减一（如果是单核机器，则创建一个线程）。`makeCommonPool`您可以在类的方法中看到此代码`ForkJoinPool`。

如果您认为这未充分利用您的 CPU，您可以为`parallelism`.

但最有趣的是，有一种方法可以让 ForkJoinPool 在当前线程占用 CPU 阻塞 IO 时创建更多线程。`block`您所要做的就是在对象方法的实现中实现实际上阻塞在 IO 上的代码块`ForkJoinPool.ManagedBlocker`，并将该`ManagedBlocker`对象传递给类的`managedBlock`方法`ForkJoinPool`。完成后，`ForkJoinPool`检查调用此方法的当前线程是否是 a 的实例`ForkJoinPoolWorkerThread`。如果是，则`ForkjoinPool`通过创建可以接管 CPU 的新线程来进行补偿。

```
ForkJoinPool fjp = ForkJoinPool.common();
Runnable task = new Runnable(){
  public void run(){
    //Some cpu-intensive code
    ForkJoinPool.managedBlock(new ForkJoinPool.ManagedBlocker(){
      public boolean isReleasable(){
        //return true if an IO/blocking operation is to be done.
      }

      public boolean block(){
       //Do an IO Operation here
       //return true if all blocking code has finished execution.
       //return false if more blocking code is yet to execute.
      }

    });
    //Some more CPU intensive code here
  }
};
fjp.submit(task); 
```

# winapi - 更改默认网关时出现分段错误

> ID：11369597
> 
> 赞同：1
> 
> 时间：2012-07-06T21:00:46.943
> 
> 标签：winapi, qt4, gateway, iphelper

我在 Qt4 上编写了一个简单的应用程序来修改网络适配器参数，为此我有一个名为 的插槽`setInterfaceParams`，实现如下：

```
DWORD WinNetInterface::setInterfaceParams(QString index, QString ip, QString netmask, QString gateway)
{
    DWORD res = NULL;
    HINSTANCE lib = (HINSTANCE) LoadLibrary((WCHAR *)"iphlpapi.dll");
    _SetAdapterIpAddress SetAdapterIpAddress = (_SetAdapterIpAddress) GetProcAddress(lib, "SetAdapterIpAddress");

    PWSTR pszGUID = NULL;
    //char  *szGUID = (char *)index.toStdString().c_str();
    QByteArray a = index.toLocal8Bit();
    char  *szGUID = a.data();
    WideCharToMultiByte(CP_ACP, 0, pszGUID, -1, szGUID, sizeof(szGUID), NULL, NULL);

// Method 01
    res = SetAdapterIpAddress(szGUID,
                        0,
                        inet_addr(ip.toStdString().c_str()),
                        inet_addr(netmask.toStdString().c_str()),
                        inet_addr(gateway.toStdString().c_str()));
// End of method 01

// Method 02
    /*res = SetAdapterIpAddress("{422C5689-A17B-402D-A6A2-22CE13E857B5}",
                                0,
                                inet_addr("192.168.1.10"),
                                inet_addr("255.255.255.0"),
                                inet_addr("192.168.1.1"));*/
// End of method 02
    return res;
} 
```

当我单击连接到 slot 的按钮时，出现`setInterfaceParams`分段错误。如果我评论method01，什么都不会发生，当我使用method02时会发生一些事情。我在一个简单的 c++ 应用程序上尝试了这个功能，它工作正常，在 Windows XP SP3 上测试。

```
#include <windows.h>
#include <winsock2.h>
#include <iphlpapi.h>
#include <stdio.h>
#include <iostream>

typedef DWORD (WINAPI *_SetAdapterIpAddress )(char *szAdapterGUID, 
                                              DWORD dwDHCP, 
                                              DWORD dwIP, 
                                              DWORD dwMask, 
                                              DWORD dwGateway); 

int main()
{
    HINSTANCE lib = (HINSTANCE) LoadLibrary("iphlpapi.dll"); 
    _SetAdapterIpAddress SetAdapterIpAddress = (_SetAdapterIpAddress) GetProcAddress(lib, "SetAdapterIpAddress");

    PWSTR pszGUID = NULL;
    char  szGUID[] = "{422C5689-A17B-402D-A6A2-22CE13E857B5}";
    DWORD dwSize = 0;
    WideCharToMultiByte(CP_ACP, 0, pszGUID, -1, szGUID, sizeof(szGUID), NULL, NULL);

    DWORD res = SetAdapterIpAddress(szGUID, 
                        0, 
                        inet_addr("192.168.1.10"),
                        inet_addr("255.255.255.0"),
                        inet_addr("192.168.1.1"));

    std::cout << res;                   

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T12:24:45.623

```
LoadLibrary((WCHAR *)"iphlpapi.dll"); 
```

那行不通，文字字符串是 8 位的，没有真正转换的情况下强制转换不会使其变宽，因此 dll 加载可能失败。

您应该在传递给 WinAPI 函数的大多数文字字符串周围使用`TEXT`or`_T`宏，以根据编译选项使它们成为常规或宽：

```
LoadLibrary(_T("iphlpapi.dll")); 
```

which will translate to either `LoadLibrary("iphlpapi.dll");` or `LoadLibrary(L"iphlpapi.dll");`.

Also you should always check the value returned by the `LoadLibrary` and `GetProcAddress` functions, which return NULL if the call is unsuccessful.

# php - JavaScript 确认框未出现在 PHP 页面上

> ID：11369598
> 
> 赞同：0
> 
> 时间：2012-07-06T21:00:48.587
> 
> 标签：php

谁能明白为什么 PHP 中的这一行不起作用。游戏卡被删除，但没有出现确认框供用户确认或取消。

```
echo "<a href='gamecard.php?selection=" . $row['gamedate'] . " onclick='return confirm('Delete game card?');'>Delete</a>"; 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:02:24.107

当您应该使用单引号（反之亦然）时，您会遇到一些缺少引号和使用双引号的问题。这应该可以解决问题。

```
echo "<a href='gamecard.php?selection=" . $row['gamedate'] . "' onclick='return confirm(\"Delete game card?\");'>Delete</a>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:04:12.707

```
echo "<a href='gamecard.php?selection=" . $row['gamedate'] . "' onclick=\"confirm('Delete game card?');\">Delete</a>"; 
```

会做的。作为一般惯例，HTML 属性应该用双引号引起来。JS 字符串应该是单引号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T21:05:16.047

```
echo "<a href=\"gamecard.php?selection=" . $row['gamedate'] . "\" onclick=\"return confirm('Delete game card?');\">Delete</a>"; 
```

**[键盘示例](http://codepad.org/F0rtXgj3)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T21:05:27.597

您在单引号内有单引号，您需要转义它们。您还忘记了`href`属性的结束引号。

```
echo "<a href='gamecard.php?selection=" . $row['gamedate'] . "' onclick='return confirm(\"Delete game card?\");'>Delete</a>"; 
```

# salesforce - @readonly 在 VF 上下文中是否总是有 100 万行的限制

> ID：11369601
> 
> 赞同：1
> 
> 时间：2012-07-06T21:00:55.603
> 
> 标签：salesforce, apex-code

VF 控制器方法上的 @readonly 注释是否总是限制为 1 百万行？还是该限制仅在注释位于页面本身时适用？文档不明确： http: [//www.salesforce.com/us/developer/docs/pages/Content/pages_controller_readonly_context.htm](http://www.salesforce.com/us/developer/docs/pages/Content/pages_controller_readonly_context.htm)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T15:58:42.103

我相信当从 Visualforce 调用时，它总是上限为 100 万。但解决此问题的一种方法是从 Apex 准备汇总表，而不是从 Visualforce 调用，然后在处理完成后让 VF 页面引用这些汇总数据。

# jquery - 如何在客户端使用 JQGrid 过滤器工具栏进行增量搜索？

> ID：11369607
> 
> 赞同：1
> 
> 时间：2012-07-06T21:01:48.333
> 
> 标签：jquery, jqgrid, client-side

我可以做到这一点，我可以通过客户端搜索做到这一点吗？我想实现像谷歌的“谷歌即时”这样的东西，这样我就可以在不按回车的情况下进行搜索。

# elmah - 在 web.config 中为 ELMAH 指定过滤器

> ID：11369611
> 
> 赞同：1
> 
> 时间：2012-07-06T21:02:02.770
> 
> 标签：elmah

当我的 asp.net 应用程序中发生这两个异常中的任何一个时，我有兴趣为 ELMAH 指定过滤器。

1.  异常消息包含“这是一个无效的网络资源请求”
2.  异常消息包含“潜在危险...值...”

我在我的 web.config 中使用了以下内容，但如果将其放置为第一个过滤器，它只会过滤无效的 websresource 请求，但如果将其放置为第二个过滤器，则它不适用。配置文件“errorfilter”元素如下所示。如何在 web config 中同时指定这两个条件，是否需要使用 BaseException.Message 或 Exception.Message？

```
 <errorFilter>
    <test>
     <or>
       <and>
        <regex binding="Exception.Message" pattern="(?ix: \b potentially \b.+?\b  
            dangerous \b.+?\b value \b.+?\b detected \b.+?\b client \b )" />
      </and>  
    </or>
    <or>
      <and>
          <equal binding="BaseException.Message" value="This is an invalid webresource
          request." type="String" />
      </and>
    </or>
    </test>   
    </errorFilter> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T12:09:12.617

该`test`元素只能有一个子元素。由于您有两个`or`条件，因此只有第一个条件被应用。正确的方法*或*您的两个条件是将它们分组在一个`or`元素下，下`test`，如下所示：

```
<errorFilter>
  <test>
    <or>
        <regex binding="Exception.Message" 
               pattern="(?ix: \b potentially \b.+?\b  
                        dangerous \b.+?\b value \b.+?\b 
                        detected \b.+?\b client \b )" />
        <equal binding="BaseException.Message" 
               value="This is an invalid webresource request." 
               type="String" />
    </or>
  </test>
</errorFilter> 
```

# asp.net - Asp.net SynchronizationContext 为异步延续锁定 HttpApplication？

> ID：11369614
> 
> 赞同：13
> 
> 时间：2012-07-06T21:02:25.873
> 
> 标签：asp.net, asp.net-mvc, multithreading, asynchronous, async-await

[Stephen Cleary的](https://stackoverflow.com/users/263693/stephen-cleary)[评论](https://stackoverflow.com/questions/7804363/async-ctp-bug-task-never-completes#comment9513880_7804458)是这样说的：

> `AspNetSynchronizationContext`是最奇怪的实现。它视为`Post`同步而不是异步，并**使用锁一次执行一个委托**。

同样，[他写的关于同步上下文](http://msdn.microsoft.com/en-us/magazine/gg598924.aspx)并在该评论中链接到的文章表明：

> 从概念上讲，AspNetSynchronizationContext 的上下文是复杂的。在异步页面的生命周期中，上下文仅从 ASP.NET 线程池中的一个线程开始。异步请求启动后，上下文不包含任何线程。当异步请求完成时，执行其完成例程的线程池线程进入上下文。这些可能是发起请求的相同线程，但更有可能是在操作完成时碰巧空闲的任何线程。
> 
> **如果同一应用程序**一次完成多个操作，AspNetSynchronizationContext 将确保它们一次执行一个。它们可以在任何线程上执行，但该线程将具有原始页面的身份和文化。

挖掘反射器似乎可以验证这一点，因为它`HttpApplication`在调用任何回调时会锁定。

锁定应用程序对象似乎很可怕。所以我的第一个问题是：这是否意味着今天，整个应用程序的所有异步完成都一次执行一个，即使是源自具有单独 HttpContext 的单独线程上的单独请求的那些？对于任何 100% 使用异步页面（或 MVC 中的异步控制器）的应用程序来说，这不是一个巨大的瓶颈吗？如果不是，为什么不呢？我错过了什么？

此外，在 .NET 4.5 中，似乎有一个新`AspNetSynchronizationContext`的，旧的被重命名`LegacyAspNetSynchronizationContext`，并且仅在`UseTaskFriendlySynchronizationContext`未设置新的应用程序设置时使用。所以问题 #2：新的实现会改变这种行为吗？否则，我想随着新的 async/await 支持通过同步上下文封送完成，这种瓶颈会更频繁地被注意到。

[这个论坛帖子](http://social.msdn.microsoft.com/Forums/en-NZ/async/thread/b2e8c51e-2808-46d0-92e9-b825321d0af8)的答案（从[这里](https://stackoverflow.com/questions/9562836/whats-the-meaning-of-usetaskfriendlysynchronizationcontext)的 SO 答案链接）表明这里发生了根本性的变化，但我想弄清楚那是什么以及哪些行为得到了改进，因为我们有一个 .NET 4 MVC 3 应用程序，它几乎100% 异步操作方法进行 Web 服务调用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-31T06:02:27.913

让我回答你的第一个问题。在您的假设中，您没有考虑单独的 ASP.NET 请求由不同的 HttpApplication 对象处理的事实。HttpApplication 对象存储在池中。一旦您请求一个页面，就会从池中检索一个应用程序对象，并在请求完成之前属于该请求。所以，我对你的问题的回答：

> 整个应用程序的所有异步完成一次执行一个，即使是源自具有单独 HttpContext 的单独线程上的单独请求的完成

是：不，他们没有

单独的请求由单独的 HttpApplication 对象处理，锁定的 HttpApplication 只会影响单个请求。同步上下文是一个强大的东西，它可以帮助开发人员同步对共享（在请求范围内）资源的访问。这就是为什么所有回调都在锁定下执行的原因。同步上下文是基于事件的同步模式的核心。

# algorithm - 圆-圆碰撞预测

> ID：11369616
> 
> 赞同：9
> 
> 时间：2012-07-06T21:02:38.333
> 
> 标签：algorithm, geometry, collision, prediction

我知道如何检查两个圆圈是否相互交叉。但是，有时圆圈移动得太快，最终会避免在下一帧发生碰撞。

我目前对该问题的解决方案是在前一个位置和当前位置之间检查任意次数的圆-圆碰撞。

有没有一种数学方法可以找到两个圆碰撞所需的时间？如果我能够得到那个时间值，我可以将圆圈移动到当时的位置，然后在那个点碰撞它们。

编辑：恒速

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-06T21:38:54.650

我假设圆圈的运动是线性的。假设圆 A 的中心位置由向量方程给出`Ca = Oa + t*Da`，其中

`Ca = (Cax, Cay)`是当前位置
`Oa = (Oax, Oay)`是起始位置
`t`是经过时间
`Da = (Dax, Day)`是每单位时间的位移（速度）。

同样对于圆 B 的中心：`Cb = Ob + t*Db`。

然后你想找到 t 使得`||Ca - Cb|| = (ra + rb)`where`ra`和`rb`分别是圆 A 和 B 的半径。

两边平方：
`||Ca-Cb||^2 = (ra+rb)^2`
并展开：
`(Oax + t*Dax - Obx - t*Dbx)^2 + (Oay + t*Day - Oby - t*Dby)^2 = (ra + rb)^2`

从那里你应该得到一个二次多项式，你可以解决 t （如果存在的话）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-06-06T13:49:16.620

这是在 Andrew Durward 的出色答案中求解 t 方程的方法。

要插入值，可以跳到底部。

```
(Oax + t*Dax - Obx - t*Dbx)^2 + (Oay + t*Day - Oby - t*Dby)^2 = (ra + rb)^2

(Oax * (Oax + t*Dax - Obx - t*Dbx) + t*Dax * (Oax + t*Dax - Obx - t*Dbx)
 - Obx * (Oax + t*Dax - Obx - t*Dbx) - t*Dbx * (Oax + t*Dax - Obx - t*Dbx))
+
(Oay * (Oay + t*Day - Oby - t*Dby) + t*Day * (Oay + t*Day - Oby - t*Dby)
 - Oby * (Oay + t*Day - Oby - t*Dby) - t*Dby * (Oay + t*Day - Oby - t*Dby))
=
(ra + rb)^2

Oax^2 + (Oax * t*Dax) - (Oax * Obx) - (Oax * t*Dbx)
 + (t*Dax * Oax) + (t*Dax)^2 - (t*Dax * Obx) - (t*Dax * t*Dbx)
 - (Obx * Oax) - (Obx * t*Dax) + Obx^2 + (Obx * t*Dbx)
 - (t*Dbx * Oax) - (t*Dbx * t*Dax) + (t*Dbx * Obx) + (t*Dbx)^2
+
Oay^2 + (Oay * t*Day) - (Oay * Oby) - (Oay * t*Dby)
 + (t*Day * Oay) + (t*Day)^2 - (t*Day * Oby) - (t*Day * t*Dby)
 - (Oby * Oay) - (Oby * t*Day) + Oby^2 + (Oby * t*Dby)
 - (t*Dby * Oay) - (t*Dby * t*Day) + (t*Dby * Oby) + (t*Dby)^2
=
(ra + rb)^2

t^2 * (Dax^2 + Dbx^2 - (Dax * Dbx) - (Dbx * Dax)
       + Day^2 + Dby^2 - (Day * Dby) - (Dby * Day))
+
t * ((Oax * Dax) - (Oax * Dbx) + (Dax * Oax) - (Dax * Obx)
      - (Obx * Dax) + (Obx * Dbx) - (Dbx * Oax) + (Dbx * Obx)
      + (Oay * Day) - (Oay * Dby) + (Day * Oay) - (Day * Oby)
      - (Oby * Day) + (Oby * Dby) - (Dby * Oay) + (Dby * Oby))
+
Oax^2 - (Oax * Obx) - (Obx * Oax) + Obx^2
  + Oay^2 - (Oay * Oby) - (Oby * Oay) + Oby^2 - (ra + rb)^2
=
0 
```

现在它是一个标准形式的二次方程：

```
ax2 + bx + c = 0 
```

像这样解决：

```
x = (−b ± sqrt(b^2 - 4ac)) / 2a       // this x here is t 
```

在哪里 -

```
a = Dax^2 + Dbx^2 + Day^2 + Dby^2 - (2 * Dax * Dbx) - (2 * Day * Dby)

b = (2 * Oax * Dax) - (2 * Oax * Dbx) - (2 * Obx * Dax) + (2 * Obx * Dbx)
     + (2 * Oay * Day) - (2 * Oay * Dby) - (2 * Oby * Day) + (2 * Oby * Dby)

c = Oax^2 + Obx^2 + Oay^2 + Oby^2
    - (2 * Oax * Obx) - (2 * Oay * Oby) - (ra + rb)^2 
```

t 存在（将发生碰撞）如果--

```
(a != 0) && (b^2 >= 4ac) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-06T21:15:41.630

您可以通过使用方向矢量和速度来预测碰撞，这为您提供了下一步，以及他们何时会发生碰撞（如果有的话）。

你只需要检查线交叉算法来检测...

# c# - 如何向 WCF 发出的 RESTful API 发布 JSON HTTP 请求

> ID：11369619
> 
> 赞同：0
> 
> 时间：2012-07-06T21:02:57.420
> 
> 标签：c#, json, wcf, rest, request

我正在尝试让 Android 使用我自己制作的简单 WCF Web 服务。这是我的 WCF 服务定义：

```
 [WebInvoke(Method = "POST", ResponseFormat = WebMessageFormat.Json,
    RequestFormat = WebMessageFormat.Json,
    BodyStyle = WebMessageBodyStyle.Bare,
    UriTemplate = "/UploadCallLog2")]
    [OperationContract]
    String UploadCallLog2(String number, String cached_name, String duration, String date, String line_number); 
```

我有两个问题： 1\. 我的 HTTP 请求应该是什么样的？添加请求头时应该选择什么样的内容类型？2\. 是否有正确的方法将输入参数作为 JSON 放入正文中，并且 web 服务可以自动检测输入参数的值？

弗雷德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:30:53.630

我建议通过 WCF 服务使用 MVC 项目。

控制器可以返回一个 JsonResult，MVC 库包含 Json 辅助方法，如果属性匹配，则可以将 json 对象序列化和反序列化为 c# 对象。

这也允许从任何支持 XmlHttpRequest 的客户端调用基于 MVC 的服务，使用 ContentType 作为“application/json”。根据您的请求类型和 SSL 下的数据安全性，您可以使用 HttpGet 或 HttpPost。您还可以利用身份验证模型来保护您的方法。

这只是一个非常干净的实现，没有任何复杂的服务器和客户端配置。有关类似方法的更多信息是 MVC 4 中的新 Web API。

# c# - 我应该使 C# 私有方法通用吗？

> ID：11369624
> 
> 赞同：3
> 
> 时间：2012-07-06T21:03:44.517
> 
> 标签：c#, generics, methods, private

我有一个 API，其中包含一些接受类型参数的方法。我现在将它们转换为泛型方法，作为改进 API（更类型安全）的一部分，同时保留非泛型版本以实现向后兼容性。

当前 - 将被淘汰：

```
public object MyMethod(object value, Type expectedType) 
```

新的：

```
public T MyMethod<T>(object value) 
```

然而，Mymethod 调用了一个私有的辅助方法，它也接受一个类型参数：

```
private object HelperMethod(object value, Type expectedType) 
```

**问题**：我是否也应该使这个私有辅助方法通用？

我在下面有自己的答案，但我想知道我是否遗漏了什么。我非常感谢您的见解。

我的回答是否定的，我不应该使这个私有方法通用。

原因 1：这个辅助方法是私有的，所以即使我把它变成通用的，它也不会改进 API。

原因2：如果我让它泛型，那么非泛型的公共方法将不得不使用反射将类型参数传递给这个泛型方法，这意味着更多的开销。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T21:37:56.620

使您的私有辅助方法泛型确实可以通过在您的实现中始终携带泛型类型特异性来改进 API。如果您将类型限制为处理无类型 System.Objects 的核心，那么您的实现并没有完全实现泛型的类型安全优势。

例如，为什么 MyMethod 的参数仍然是 System.Object？如果该参数源自源，那么它也很有可能是类型参数。如果参数源自数据，则最好使用 System.Object。泛型在与源代码一起使用时最有用，因为源代码表达式在大多数上下文中隐式提供了类型。

泛型的隐藏成本取决于将与 API 一起使用的类型组合。如果大多数类型都是值类型（内置和结构），那么将 API 切换到泛型可能会增加内存消耗，因为泛型代码必须针对每种值类型进行不同的 jit。如果与您的通用 API 一起使用的大多数类型是引用类型（类和接口），则代码/内存爆炸不是问题，因为所有引用类型共享相同的 JIT 代码。

让旧 API 调用新的通用 API 的成本是否 a) 可测量和 b) 可接受完全取决于您在私有帮助器方法中所做的事情 - 特别是私有帮助器方法对 Type 参数所做的事情。

如果辅助方法实现相当轻量，并且您确定（通过性能测量）调整旧 API 以调用新的通用辅助方法的成本是不可接受的，我会考虑复制辅助方法实现，并排，一个在旧的样式和一个新的通用样式。这消除了 API 样式之间的交叉转换成本，并消除了将新错误引入旧 API 的风险，但代价是略微增加了内部代码维护工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T21:06:24.010

我认为这取决于您计划支持非泛型方法的时间量、调用频率、对反射的影响等等等等。

我认为您会尽可能多地想要通用功能以利用您想要的类型安全性。然后在必要时改造非通用版本以使用通用版本，并最终尽快弃用它。

# html - 响应式导航，无法以百分比定义宽度/高度

> ID：11369631
> 
> 赞同：0
> 
> 时间：2012-07-06T21:04:16.227
> 
> 标签：html, css, responsive-design

因此，我正在尝试构建一个响应式导航菜单，该菜单将随媒体查询一起扩展。

问题是（这是一个我无法解决的愚蠢问题）我无法让 a 标签显示为块级元素（我认为）。

这是HTML：

```
<div class="navbuttons">
    <ul>
        <li><a href="#">Home</a></li>
        <li><a href="#">About</a></li>
        <li><a href="#">Expertise</a></li>
        <li><a href="#">Capabilities</a></li>
        <li><a href="#">Case Studies</a></li>
        <li><a href="#">Contact</a></li>
    </ul>
 </div> <!-- end div navbuttons --> 
```

和CSS：

```
.navbuttons {
    position: relative;
    height: 100px;
    width: 50%;
    background-color: blue;
    float: left;
    transition:all .2s linear; 
    -o-transition:all .2s linear; 
    -moz-transition:all .2s linear; 
    -webkit-transition:all .2s linear;
}

.navbuttons ul {
    list-style: none;
    margin:0;
    padding:0;
    float: left;
}

.navbuttons li {
    float:left;
}

.navbuttons li a {
    background: #444;
    display: block;
    float: left;
    line-height: 100px;
    height: 100%;
    text-align: center;
    text-decoration: none;
    text-transform: uppercase;
    width: 16.5%;
} 
```

然而，如果我使用 px 来定义宽度/高度，我可以让它看起来大致是我想要的（尽管它显然不是流动的，就像我需要的那样）。

```
.navbuttons {
    position: relative;
    height: 100px;
    width: 50%;
    background-color: blue;
    float: left;
    transition:all .2s linear; 
    -o-transition:all .2s linear; 
    -moz-transition:all .2s linear; 
    -webkit-transition:all .2s linear;
}

.navbuttons ul {
    list-style: none;
    margin:0;
    padding:0;
    float: left;
}

.navbuttons li {
    float:left;
}

.navbuttons li a {
    background: #444;
    display: block;
    float: left;
    line-height: 100px;
    height: 100px;
    text-align: center;
    text-decoration: none;
    text-transform: uppercase;
    width: 100px;
} 
```

哪里出错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:15:05.983

一旦您在 A 标记上指定`display: block;`它们，它们确实是块级的，但是，16.5% 是根据它们的自然宽度计算的（即它们的 100% 宽度基于内部文本）。

根据您的需要，您可能想要删除宽度参数并简单地添加填充。请参阅：http: [//jsfiddle.net/bLS6B/](http://jsfiddle.net/bLS6B/)。这样，宽度取决于导航文本，而不是某些预设宽度。或者，您可以指定具有类似效果的 120%。

# python - Python：反向排序列表中第一个元素的索引小于阈值

> ID：11369634
> 
> 赞同：4
> 
> 时间：2012-07-06T21:04:38.473
> 
> 标签：python, search, sorting

[此处](https://stackoverflow.com/questions/7281760/in-python-how-do-you-find-the-index-of-the-first-value-greater-than-a-threshold "这里")已针对排序列表提出了类似的问题，但使用的解决方案`bisect`不适用于保留排序列表。

假设我有一个列表，以相反的顺序排序，以中间元素为键，

```
my_list = [[3,0.99,1], [2,0.98,54], [10,.85,4], [1,0.7,10], [12,0.69,31], [12,0.65,43], [1.56,0] ....] 
```

我想在中间元素上应用一系列阈值，它在一个单独的排序列表中，比如说

```
threshold = [0.97, 0.90, 0.83, 0.6] 
```

我试图找出小于阈值的第一个元素的索引。在上面的例子中它应该返回，

```
index_list = [2, 2, 3, 6] 
```

建议如何以最快的方式完成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T21:42:21.767

根据@ [gnibbler的这个好](https://stackoverflow.com/users/174728/gnibbler)[答案](https://stackoverflow.com/a/2247433/1407156)，您可以自己重写代码以满足您的需要`bisect`

我稍微修改了@ [gnibbler](https://stackoverflow.com/users/174728/gnibbler)的代码，以便可以在您的情况下使用

一个优化是，由于你的阈值也是排序的，我们不需要每次都搜索整个列表，而是从最后一个结果索引开始

```
def reverse_binary_search(a, x, lo=0, hi=None):
    if lo < 0:
        raise ValueError('lo must be non-negative')
    if hi is None:
        hi = len(a)
    while lo < hi: 
        mid = (lo+hi)/2
        if x > a[mid][4]:
            hi = mid 
        else:
            lo = mid+1
    return lo

my_list = [[3,0.99,1], [2,0.98,54], [10,.85,4], [1,0.7,10], [12,0.69,31], [12,0.65,43], [1.56,0]]
threshold = [0.97, 0.90, 0.83, 0.6]

index_list = []
last_index = 0
for t in threshold:
    last_index = reverse_binary_search(my_list, t, last_index) # next time start search from last_index
    index_list.append(last_index) 
```

感谢[@PhilCooper](https://stackoverflow.com/users/310953/phil-cooper)的宝贵建议。这是他提出的使用生成器的代码：

```
def reverse_binary_search(a, threshold):
    lo = 0
    for t in threshold:
        if lo < 0:
            raise ValueError('lo must be non-negative')
        hi = len(a)
        while lo < hi: 
            mid = (lo+hi)/2
            if t > a[mid][6]:
                hi = mid 
            else:
                lo = mid+1
        yield lo

my_list = [[3,0.99,1], [2,0.98,54], [10,.85,4], [1,0.7,10], [12,0.69,31], [12,0.65,43], [1.56,0]]
threshold = [0.97, 0.90, 0.83, 0.6]

index_list = list(reverse_binary_search(my_list, threshold)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T22:01:43.170

使用 numpy，我认为它看起来比纯 python 实现更干净，并且几乎可以肯定会更快：

```
 import numpy as np
arr = np.array([[3,0.99,1], [2,0.98,54], [10,.85,4], [1,0.7,10], [12,0.69,31], [12,0.65,43], [10,0.50, 24]])
thresholds = [0.97, 0.90, 0.83, 0.60]
idx = [np.min(np.where(arr[:,1] < i)) for i in thresholds if np.where(arr[:,1] < i)[0].size > 0]
print idx
[2, 2, 3, 6] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T21:23:38.057

尝试以下操作：

```
threshold = [0.97, 0.90, 0.83, 0.6]
my_list = [[3,0.99,1], [2,0.98,54], [10,.85,4], [1,0.7,10], [12,0.69,31], [12,0.65,43], [1,.56,0]]
threshold = [0.97, 0.90, 0.83, 0.6]

index_list = []
ti = 0
for i, item in enumerate(my_list):
    if item[1] >= threshold[ti]:
        continue
    while ti < len(threshold) and item[1] < threshold[ti]:
        index_list.append(i)
        ti += 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T21:25:36.747

我想你应该拿到钥匙然后倒车。然后二等分就可以了

```
from bisect import bisect_left

keys = [vals[1] for vals in my_list]
keys.reverse()
mylen = len(my_list)
[mylen-bisect_left(keys,t) for t in threshold] 
```

如果你已经有 numpy：

```
my_array = np.array([[3,0.99,1], [2,0.98,54], [10,.85,4], [1,0.7,10], [12,0.69,31], [12,0.65,43], [10,0.50, 24]])
thresholds = [0.97, 0.90, 0.83, 0.60]

my_array.shape[0]-arr[::-1,1].searchsorted(threshold) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-06T21:44:58.057

```
import bisect
my_list_2  = sorted(my_list, key=lambda x:x[1])
for x in threshold:
    len(my_list) - bisect.bisect([z[1] for z in my_list_2], x) 
```

# php - Doctrine 2 onDelete CASCADE 设置为已删除

> ID：11369638
> 
> 赞同：2
> 
> 时间：2012-07-06T21:04:53.027
> 
> 标签：php, doctrine, cascade

我正在做一个我从未真正删除任何记录的项目。我试图让 Doctrine 在级联上将实体设置为“已删除”（标志）。这里有两个实体来说明我目前的关联；

**Model_Account**

```
/**
 * @OneToMany(targetEntity="Model_Profile",mappedBy="Account")
 */
protected $Profiles; 
```

**Model_Profile**

```
/**
 * @ManyToOne(targetEntity="Model_Account",inversedBy="Profiles")
 * @JoinColumn(name="AccountId",referencedColumnName="Id",onDelete="CASCADE")
 */
protected $Account; 
```

当我删除一个帐户时，我希望与该帐户关联的所有配置文件也被删除，但只能将其“已删除”标志设置为 true。我不知道从这里去哪里。我是否需要利用事件来覆盖默认删除并设置我的标志？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:16:30.423

设置 Doctrine2 软删除（有一个扩展），然后通过设置`cascade={"remove"}`实体来使用 Doctrine 的级联操作而不是 RDBMS 级别的操作。

# javascript - 将输入 html 元素动态关联到颜色选择器

> ID：11369644
> 
> 赞同：0
> 
> 时间：2012-07-06T21:05:24.277
> 
> 标签：javascript, color-picker, dynamically-generated

我正在使用[Izzy 颜色选择器](http://www.izzywebsite.com/tools/jquery-color-picker)。
为了将输入与 izzy 颜色选择器相关联，我只需将输入元素的类属性设置为，`izzyColor`并且输入的 id 必须是唯一的。使用javascript，当我按下按钮时，我会动态地创建一个输入。

```
n = n+1;
id = "txtColor" + n;
input = document.createElement("input");
input.setAttribute("class","izzyColor");
input.setAttribute("id",id); 
```

然后，我将输入附加到`td`表中的一个元素，但出现在相关输入元素旁边的小图像没有出现。似乎问题仅在于我使用 javascript 创建输入时，因为如果我使用 html 创建输入元素，它就可以正常工作。

当我通过源代码检查使用 javascript 创建的 html 输入元素时，所有属性都设置正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:24:04.947

查看源代码后，您似乎可以调用：

```
izzyColor(); 
```

看起来它根本没有命名空间。他们将其定义为`this.izzyColor = function(){...}`，但在那一点上，我很确定`this`它只是窗口。

我不确定这会对现有输入产生什么影响。您可能需要这样做：

```
$('input.izzyColor').removeClass('izzyColor').addClass('izzyExisting');
izzyColor();
$('input.izzyExisting').removeClass('izzyExisting').addClass('izzyColor'); 
```

让我知道进展如何，我们可以从那里开始工作。

# mysql - 构建 SQL 查询以识别丢失的行并使用特定数据更新它们

> ID：11369646
> 
> 赞同：1
> 
> 时间：2012-07-06T21:05:32.943
> 
> 标签：mysql

我知道我应该展示我尝试过的东西，以便获得更好的帮助，但我什至不知道从哪里开始，所以没有什么可展示的。我做得很好，可以把它变成一个聪明的问题。我正在使用 PHP 和 MySQL：

```
arpr_customs (`id`, `customfield_id`, `contact_id`, `stamp_create`, `stamp_update`, `field_value`)
arpr_contacts (`id`, `stamp_create`, `stamp_update`, `key`, `email_address`, `title`, `first_name`, `middle_name`, `last_name`, `full_name`, `format_preference`, `company`, `department`, `address_1`, `address_2`, `address_3`, `city`, `state`, `postal_code`, `country`, `alternative_email_address_1`, `alternative_email_address_2`, `alternative_email_address_3`, `phone_number_1`, `phone_number_2`, `phone_number_3`, `mobile_phone_number_1`, `mobile_phone_number_2`, `mobile_phone_number_3`, `fax_number_1`, `fax_number_2`, `fax_number_3`, `referer_id`, `schedule_pid`, `export_pid`, `import_subscribe_ip_address`, `import_subscribe_date_time`, `import_confirm_ip_address`, `import_confirm_date_time`, `import_customs`, `import_confirmed`) 
```

鉴于这两个表，我需要识别在 arpr_customs 中没有包含该contact_id 和customfield_id '3' 的行的contact_ids。一旦确定，我需要在 arpr_customs 中为每个允许“id”自动递增的行插入一个新行，customfield_id 设置为“3”，“contact_id”设置为找到的 id。并且 field_value 设置为“Susie”

（Susie 代表将拥有所有当前未拥有帐户的销售人员的姓名。）（customfield_id "3" 是销售人员姓名。）

**编辑：** 我会把它放在评论中，但它太大了。我接受了斯宾塞的建议，在一张重复的桌子上工作。这实际上对我有用。谢谢@spencer

```
INSERT INTO testing_customs (`contact_id`,`stamp_create`,`stamp_update`,`customfield_id`,`field_value`) 
SELECT o.id AS contact_id, 1341602090 as stamp_create, 1341602090 as stamp_update, 3 AS customfield_id,'Susie' AS field_value
FROM arpr_contacts o LEFT JOIN testing_customs u ON u.contact_id = o.id
AND u.customfield_id = 3  WHERE u.id IS NULL 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:22:17.677

在 arpr_customs 表中查找没有“匹配”行的 arpr_contacts 行（假设这里`arpr_customs.contact_id`是指向`arpr_contacts.id`

```
SELECT o.id
  FROM arpr_contacts o
  LEFT 
  JOIN arpr_customs u
    ON u.contact_id = o.id
       AND u.customfield_id = 3
 WHERE u.id IS NULL 
```

这是一个熟悉的“反加入”模式。基本上，该语句是说从联系人中获取所有行，以及从海关中获取所有匹配的行......然后丢弃任何匹配的行，所以我们留下了来自联系人的行，但没有匹配。（我们依赖于在海关表中有一个具有 NOT NULL 约束的列，所以我们可以测试我们是否有匹配项。我在这里假设该`id`列是主键，我们知道它永远不可能null。（注意：这个查询的实际执行计划与我描述的有点不同，但从概念上讲，这是正在发生的事情的最终结果。）

作为（通常）较慢的替代方案，您还可以使用相关子查询来获得相同的结果：

```
SELECT o.id
  FROM arpr_contacts o
 WHERE NOT EXISTS (SELECT 1 FROM arpr_customs u 
                    WHERE u.contact_id = o.id 
                      AND u.customfield_id = 3) 
```

或者，如果您要在非常大的表上获得可怕的性能，您可以使用 NOT IN 谓词。（这里要小心避免在列表中获得任何 NULL 值。）

```
SELECT o.id
  FROM arpr_contacts o
 WHERE o.id NOT IN 
       ( SELECT u.contact_id 
           FROM arpr_customs u
           WHERE u.contact_id IS NOT NULL
             AND u.customfield_id = 3
       ) 
```

* * *

这只是部分回答了你的问题。

~~`customfield_id`我现在注意到，正如我正在审查的那样，我在该列上遗漏了任何谓词。~~固定的

它没有解决插入“缺失”行的问题......

您可以获取 arpr_contacts 表中所需的任何列，然后为其他列提供值，以执行 INSERT ... SELECT ...

我建议您只运行 SELECT 部分，然后（如果您不确定）创建一个临时表作为接受插入的替代。（您可以从 a 获取输出`SHOW CREATE TABLE arpr_customs`并对其进行编辑（删除外键约束，并更改表名，并将其用作插入的目标。）

```
INSERT INTO arpr_customs (`contact_id`,`customfield_id`,`field_value`)
SELECT o.id    AS contact_id
     , 3       AS customfield_id
     , 'Susie' AS field_value
  FROM arpr_contacts o
  LEFT
  JOIN arpr_customs u
    ON u.contact_id = o.id
       AND u.customfield_id = 3
 WHERE u.id IS NULL 
```

如果`id`arpr_customs 表中的列定义为 AUTO_INCREMENT，则会自动为其分配一个值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:21:55.287

`not exist`您可以使用、`not in`或`left join`+`is null`查询来做您想做的事情。

所以像：

```
SELECT * FROM arpr_contacts
WHERE id NOT IN (SELECT contact_id FROM arpr_customs) 
```

我不确定确切的 MySQL 语法。

另请访问[此链接](http://explainextended.com/2009/09/18/not-in-vs-not-exists-vs-left-join-is-null-mysql/)以了解 Not Exist/Not In/Left Join 之间的差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T21:23:49.143

```
INSERT INTO arpr_customs (customfield_id,contact_id,field_value)
SELECT '3',arpr_contacts.id,'Susie'
FROM arpr_contacts LEFT JOIN arpr_customs
on arpr_customs.contact_id=apr_contacts.id
where arpr_customs.contact_id is null 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T21:23:56.580

尝试类似的东西

```
Insert arpr_customs(Customfield_id,contact_id,field_value)
Select '3',arpr_contacts.id,'Susie'
From arpr_contacts
outer join arpr_customs On arpr_customs.customfield_id = '3' 
          and arpr_customs.contact_id = arpr_contacts.id
where arpr_customs.contact_id is null 
```

基本上它是'3'类型的联系人和海关的外部连接，其中过滤掉那些有匹配记录的地方，然后将它们用于插入。

不过，我的 Mysql 并不出色，因此您可能在其中的语法很有趣。

# javascript - Ruby On Rails：以相同的形式使用 collection_select 值

> ID：11369649
> 
> 赞同：0
> 
> 时间：2012-07-06T21:06:01.030
> 
> 标签：javascript, ruby-on-rails

我如何能够从表单中的 collection_select 中获取选择的值？我想使用这个值来动态改变表单的内容。这听起来像是涉及javascript，但我找不到有关如何执行此操作的更多信息。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T22:41:34.463

```
 $("#select_tag_id").change(function() {
        value = $(this).val();
        ....
    }) 
```

# php - PHP 与 html 和 php 混合的语法问题

> ID：11369650
> 
> 赞同：-1
> 
> 时间：2012-07-06T21:06:04.350
> 
> 标签：php

我的一些代码有语法问题，我一直在更改语法，但它无处可去。

这是代码：

```
echo '<img style="border:1px solid #f1f1f1;margin:12px 0 12px 0" src="https://chart.googleapis.com/chart?chs=150x150&cht=qr&chl=http://mysite.com/'.$current_user->user.'/'" />'; 
```

似乎在这附近：

```
http://mysite.com/'.$current_user->user.'/'" />'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:08:16.467

尝试：

```
echo "<img style=\"border:1px solid #f1f1f1;margin:12px 0 12px 0\" src=\"https://chart.googleapis.com/chart?chs=150x150&cht=qr&chl=http://mysite.com/".$current_user->user."/\" />"; 
```

**[键盘示例](http://codepad.org/RQ8sytkY)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T21:09:14.400

```
echo '<img style="border:1px solid #f1f1f1;margin:12px 0 12px 0" src="https://chart.googleapis.com/chart?chs=150x150&cht=qr&chl=http://mysite.com/' . $current_user->user . '/" />'; 
```

最后你有一个单引号太多`'/'`改变`'/`了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T21:10:35.107

```
echo '<img style="border:1px solid #f1f1f1;margin:12px 0 12px 0" src="https://chart.googleapis.com/chart?chs=150x150&cht=qr&chl=http://mysite.com/'.$current_user->user.'"/>'; 
```

你挂断的部分应该是：

```
http://mysite.com/'.$current_user->user.'"/>'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T21:09:34.533

在行尾，试试这样：

```
 ...rent_user->user.'/" />';  
            //        ^-----------no <'> sign here 
```

# javascript - jquery 动画 boxshadow

> ID：11369652
> 
> 赞同：0
> 
> 时间：2012-07-06T21:06:15.097
> 
> 标签：javascript, jquery, jquery-ui, css

[http://jsfiddle.net/mstefanko/w5aAn/877/](http://jsfiddle.net/mstefanko/w5aAn/877/)

下面，我正在实现我想要的效果，但有一个悬而未决的问题。因为我使用了一个单独的跨度并将它定位在具有相对位置的盒子的绝对上方。在动画完成之前，我无法访问输入。我猜想缓解这种情况的唯一方法是做一些类似的事情，只为外框的边框设置动画？但是我没有做任何动画 box-shadow:inset 的工作。

**HTML**

```
<div id="wow">
    <span id="pulse"></span>
    <input id="form-input"/>
    <input id="form-input"/>
</div>​ 
```

**CSS**

```
#wow {
width: 500px;
height: 200px;
display: inline-block;
position: relative;
border: 1px solid black;
}

#pulse {
width: 100%; 
height: 100%; 
box-shadow:inset 0 0 20px #6c95c3; 
-moz-box-shadow:inset 0 0 10px #6c95c3; 
position: absolute;
z-index: 20000;
} 
```

**JS**

```
$('#pulse').stop().animate({"opacity": 0}, "fast"); 
$('#pulse').effect("pulsate", { times:4 }, 500,  function() {
    $(this).remove();
}); 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:10:54.880

您可以使用 CSS[`pointer-events`](https://developer.mozilla.org/en/CSS/pointer-events)属性：

> CSS 属性 pointer-events 允许作者控制在什么情况下（如果有）元素可以成为鼠标事件的目标。

```
#pulse {
    pointer-events: none;
    ...
} 
```

[演示](http://jsfiddle.net/w5aAn/878/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:22:55.280

我只是修改了#pulse 的 z-index，因此它将分层在您的输入下方。

```
#pulse {
    ...
    z-index: -20000;
} 
```

# url-rewriting - Yii : Facebook 风格的 url 路由

> ID：11369656
> 
> 赞同：1
> 
> 时间：2012-07-06T21:06:43.597
> 
> 标签：url-rewriting, yii

我想设置我的 Yii webapp 以便 url

/username 将显示该用户的用户记录。

我试过了

```
'<username>'=> 'user/view' 
```

，但这会导致错误 400。

```
'<id:\d+>'=> 'user/view' 
```

作品。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-07T08:31:16.983

我已经设法弄清楚我做错了什么。

您放入 url 路由中的变量需要与控制器操作中的函数相对应。

所以我把gii生成的标准actionView改成了

```
 public function actionView($username) {
         $model=User::model()->find("username = '".$username."'");
     $this->render('view',array('model'=>$model);
     } 
```

现在 。. . `'<username>'=> 'user/view'`作为 url 路由按预期工作。

# ruby-on-rails - 无法在多态字段上设置条件

> ID：11369659
> 
> 赞同：0
> 
> 时间：2012-07-06T21:07:06.683
> 
> 标签：ruby-on-rails, where, polymorphic-associations

我有 3 个模型：玩家、用户、机器人

Player 具有名为“playerable”的多态字段。玩家表如下所示：

```
id, playerable_id, playerable_type 
```

当我尝试这样做时：

```
Player.where(playerable: User.first) 
```

我得到：未知列'players.playerable'

当我这样做时它有效：

```
Player.where(playerable_id: User.first.id, playerable_type: "User") 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T00:31:56.547

如果你有

```
has_many :players, :as => :playerable 
```

在您的用户模型中，您可以这样做

```
User.first.players 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T22:00:44.577

这是因为它本质上是多态关联。这意味着 playerable 可能是 2 个不同的类，因此 rails 不能指望您在调用多态关联类时查找 User.first。

你可以这样做：

```
Player.where(playerable_type: => "User").first 
```

希望这可以帮助。

# sql - 在需要日期但没有日期列时实现分区的最佳方法

> ID：11369661
> 
> 赞同：1
> 
> 时间：2012-07-06T21:07:22.190
> 
> 标签：sql, partitioning, database-indexes

我对如何处理这个有自己的想法，但想看看是否有不同的观点。我遇到的问题是我有以下表格（示例表）

```
---------------------------------------------------------------------------------------
CREATE TABLE Account
(
    AccountId int identity(1,1),
    CreationDate datetime,
    CONSTRAINT [PK_Account] PRIMARY KEY CLUSTERED 
    (
        [AccountId] ASC
    )WITH (FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

CREATE TABLE AccountSales
(
    AccountSalesId int identity(1,1),
    AccountId int,
    CONSTRAINT [PK_AccountSales] PRIMARY KEY CLUSTERED 
    (
       [AccountSalesId] ASC
    )WITH (FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

ALTER TABLE [dbo].[AccountSales]  WITH CHECK ADD  CONSTRAINT [FK_AccountSales_Account]    FOREIGN KEY([AccountId])
REFERENCES [dbo].[Account] ([AccountID])
GO

ALTER TABLE [dbo].[AccountSales] CHECK CONSTRAINT [FK_AccountSales_Account]
GO
--------------------------------------------------------------------------------------- 
```

假设 Account 表为 500GB，AccountSales 为 1TB。出于明显的原因，我想对这些表进行分区。当前逻辑的工作方式是每天处理数据，因此对 Account 表的日期字段进行分区是有意义的，但是 AccountSales 表没有日期字段。此外，当涉及到 id 和 date 时，两个表中的数据也不是连续的，因为数据是在不同时间从不同服务器加载的。所以like账户可能有以下数据

```
Id     Date             Server loaded from (not a column - just for display purposes)
--------------------------
1      1/1/2000 00:00     1
2      1/1/2000 01:00     1
3      1/1/2000 02:00     1
4      1/1/2000 00:00     2
5      1/1/2000 01:00     2
6      1/1/2000 0:300     1 
```

我正在考虑只在 CreationDate 上创建聚集索引并将 AccountId 设置为具有唯一 NC 索引的 PK 的 Accounts 表。然后我会在日期上进行分区。

不过，我不能 100% 确定如何处理 AccountSales 表 - 因为如果我通过 id 进行操作，如果与 Account 表连接，日期将无法正确匹配，但是我看不到解决此问题的方法。

有任何想法吗？处理这个问题的最佳方法是什么？如果需要更多信息，请告诉我。谢谢，如果提前！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T18:15:52.050

您在评论中说，您的目标是使用分区元数据操作来批量更新数据。这意味着您需要对两个表进行分区，因为您肯定希望它们保持同步。此外，您需要对它们进行分区对齐，以便能够在同一个（快速）事务中切换或删除两者。

因此，我建议您在两个表中都包含分区键。即使其中一个是多余的。

# regex - 如何匹配所有国际化文本？

> ID：11369668
> 
> 赞同：2
> 
> 时间：2012-07-06T21:08:12.257
> 
> 标签：regex, r, internationalization

我正在执行一项搜索和销毁任何亚马逊认为令人反感的任务。在过去，我通过`iconv`将“UTF-8”转换为“latin1”来处理这个问题，但在这里我不能这样做，因为它被编码为“未知”：

```
test <- "Gwena\xeblle M"
> gsub("\xeb","", df[306,"primauthfirstname"] )
[1] "Gwenalle M"
> Encoding(df[306,"primauthfirstname"])
[1] "unknown" 
```

那么什么正则表达式消除了所有 \x## 代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T22:20:06.973

我相信这种模式应该有效：

```
pat <- "[\x80-\xFF]"

test <- c("Gwena\xeblle M", "\x92","\xe4","\xe1","\xeb") 
gsub(pat, "", test, perl=TRUE)
# [1] "Gwenalle M" ""           ""           ""           "" 
```

**解释：**

它之所以有效，是因为字符类`"[\x00-\xFF]"`将匹配表单的所有字符`\x##`。但是其中的前半部分——第 0 到第 127（或十六进制数字中的第`00`'th 到'th）——是[ASCII 字符](http://en.wikipedia.org/wiki/ASCII)。所以它是它们的后半部分——第 128 到第 255（或十六进制模式下的第'th 到'th）——你想要搜索并销毁。`7F``80``FF`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T22:26:40.610

我通过 iconvlist() 循环了一下，发现了这个（以及其他组合）：

```
test<-"Gwena\xeblle M"
iconv(test,"CP1163","UTF-8")
 [1] "Gwenaëlle M" 
```

我意识到，这不是您所要求的，但有可能找到正确的编码。

# c++ - 在有声卡的情况下敲钟

> ID：11369670
> 
> 赞同：0
> 
> 时间：2012-07-06T21:08:17.563
> 
> 标签：c++, c, linux, audio

在安装声卡的情况下，是否可以从 Ubuntu 10.04 Linux 中的 C/C++ 发出内置铃声（真的是蜂鸣器）？如果是这样，怎么做？

当然，目标是在声卡出现问题时发出声音。在所有可能的世界中最好的情况下，我的代码可以“说”“音响系统坏了”的备用扬声器。

如果蜂鸣器 (AST200Q) 可以发出更多的声音，那么我将如何让 Alsa 向它发送声音？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:10:47.477

您可以在 ascii 中发出音频/警报字符...示例 `cout << "\a"`
这将使通常在后期测试中使用的蜂鸣器发声。

# jquery - 拉伸 UL 以填充整个 DIV

> ID：11369671
> 
> 赞同：2
> 
> 时间：2012-07-06T21:08:33.307
> 
> 标签：jquery, css

有一个类似的帖子：[Stretch Horizo​​ntal ul to fit width of div](https://stackoverflow.com/questions/5186712/stretch-horizontal-ul-to-fit-width-of-div)

但是我的有点棘手，因为我尝试了上面的示例但失败了。

CSS：

```
body{
  font-size:0.85em;
  font-family:Verdana, Arial, Helvetica, sans-serif;
}

#nav, #nav ul{
  margin:0;
  padding:0;
  list-style-type:none;
  list-style-position:outside;
  position:relative;
  line-height:1.5em;
  display: table;
  width: 100%;
}

#nav a{
  display:block;
  padding:10px 15px 10px 15px;
  border:1px solid #fff;
  color:#fff;
  text-align: center;
  margin:0;
  text-decoration:none;
  background: #C34328;
  border-top:1px solid #EF593B;
  -moz-box-shadow:0px 3px 4px #591E12 inset;
  -webkit-box-shadow:0px 3px 4px #591E12 inset;
  -box-shadow:0px 3px 4px #591E12 inset;
}

#nav a:hover{
  background-color:#fff;
  color:#333;
}

#nav li{
  float:left;
  position:relative;
}

#nav ul {
  position:absolute;
  display:none;
  width:12em;
  top:3.2em;
}

#nav li ul a{
  width:12em;
  height:auto;
  float:left;
}

#nav ul ul{
  top:auto;
}

#nav li ul ul {
  left:12em;
  margin:0px 0 0 10px;
} 
```

HTML：

```
<div style="width: 980px; border: 1px black solid;">
  <ul id="nav">
    <li><a href="#">Find a Doctor</a></li>
    <li><a href="#">Why Interfaith</a></li>
    <li><a href="#">For Patients & Visitors</a>
      <ul>
        <li><a href="#">3.1 jQuery</a></li>
        <li><a href="#">3.2 Mootools</a></li>
        <li><a href="#">3.3 Prototype</a></li>
      </ul>
    </li>
    <li><a href="#">Medical Services</a>
      <ul>
        <li><a href="#">Behavioral Health</a></li>
        <li><a href="#">Clinical Laboratory</a></li>
        <li><a href="#">Dentistry</a></li>
      </ul>
    </li>
  </ul>
</div> 
```

有人可以告诉我必须在哪里编辑才能完成代码吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T01:39:13.430

您不需要为此使用 javascript。

这是一个非常简化的示例：http: [//jsfiddle.net/hghzL/](http://jsfiddle.net/hghzL/)

```
<div style="width: 600px; border: 1px black solid; background: red">
  <ul id="nav">
    <li><a href="#">Find a Doctor</a></li>
    <li><a href="#">Why Interfaith</a></li>
    <li><a href="#">For Patients & Visitors</a></li>
    <li><a href="#">Medical Services</a></li>
  </ul>
</div> 
```

 *```
*{
  margin: 0;
  padding: 0; 
}

html{
  background: #111;    
  font-size: 12px;
  font-family: Verdana, sans-serif;
}

#nav{
  list-style-type:none;
  overflow: hidden;
  background: #222;
}

#nav a{
  color: #fff; 
  display: block;
  padding: 10px;
  text-decoration:none;
  background: #444;
}

#nav a:hover{
  background-color:#fff;
  color:#333;
}

#nav li{
  float:left;
} 
```

这没有所有花哨的子菜单。

更[高级的版本](http://fiddle.jshell.net/teresko/KE48p/show/#)（[source](http://jsfiddle.net/teresko/KE48p/)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:12:32.513

尝试将所需的宽度设置为`width:inherit`!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T21:22:00.243

您为什么不尝试使用 em 而不是百分比，或者您可以使用 JavaScript，例如：

```
document.getElementById('ul').style.width=(document.body.clientWidth-10)*9; 
```

您需要相应地调整 10 和 0.9 的值。

或者，类似：

```
var viewportwidth;
if (typeof window.innerWidth != 'undefined')
{
viewportwidth = window.innerWidth;
}
 var boxwidth = parseInt(viewportwidth)*0.57;
var boxwidth2 = parseInt(boxwidth)+6;
window.onload=function(){

document.getElementById('ul').style.width = boxwidth2 + 'px';
} 
```

我没有测试这段代码。*

# linux - 从另一个文件中删除行号的文本文件中的行

> ID：11369672
> 
> 赞同：5
> 
> 时间：2012-07-06T21:08:53.547
> 
> 标签：linux, string, sed, awk, text-files

我有一个文本文件，其中包含一个巨大的行号列表，我必须将其从另一个主文件中删除。这是我的数据的样子

行.txt

```
1
2
4
5
22
36
400
... 
```

和`documents.txt`

```
string1
string2
string3
... 
```

如果我有一个简短的行号列表，我可以很容易地使用

`sed -i '1d,4d,5d' documents.txt`.

但是有很多行号我必须删除。另外，我可以使用 bash/perl 脚本将行号存储在数组中，并回显不在数组中的行。但我想知道是否有内置命令可以做到这一点。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-06T21:16:19.147

awk oneliner 应该适合您，请参见下面的测试：

```
kent$  head lines.txt doc.txt 
==> lines.txt <==
1
3
5
7

==> doc.txt <==
a
b
c
d
e
f
g
h

kent$  awk 'NR==FNR{l[$0];next;} !(FNR in l)' lines.txt doc.txt
b
d
f
h 
```

正如 Levon 所建议的，我添加了一些解释：

```
awk                     # the awk command
 'NR==FNR{l[$0];next;}  # process the first file(lines.txt),save each line(the line# you want to delete) into an array "l"

 !(FNR in l)'           #now come to the 2nd file(doc.txt), if line number not in "l",print the line out
 lines.txt              # 1st argument, file:lines.txt
 docs.txt               # 2nd argument, file:doc.txt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T21:50:56.280

这是一种方法`sed`：

```
sed ':a;${s/\n//g;s/^/sed \o47/;s/$/d\o47 documents.txt/;b};s/$/d\;/;N;ba' lines.txt | sh 
```

它用于`sed`构建`sed`命令并将其通过管道传输到要执行的 shell。生成的`sed`命令看起来就像 `sed '3d;5d;11d'documents.txt。

为了构建它，外部`sed`命令`d;`在每个数字后添加一个，循环到下一行，分支回到开头 ( `N; ba`)。当到达最后一行 ( `$`) 时，所有换行符都被删除，`sed '`被添加到最后一行，`d`并且`' documents.txt`被添加。然后从-循环`b`分支到最后，因为没有指定标签。`:a``ba`

以下是使用`join`and的方法`cat -n`（假设 lines.txt 已排序）：

```
join -t $'\v' -v 2 -o 2.2 lines.txt <(cat -n documents.txt | sed 's/^ *//;s/\t/\v/') 
```

如果lines.txt 没有排序：

```
join -t $'\v' -v 2 -o 2.2 <(sort lines.txt) <(cat -n documents.txt | sed '^s/ *//;s/\t/\v/') 
```

**编辑：**

修复了`join`原始版本仅输出documents.txt中每行的第一个单词的命令中的错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-06T21:22:30.817

好吧，我不会说 Perl 和 bash，我一次又一次地经历痛苦的​​尝试。然而，Rexx 很容易做到这一点。

```
lines_to_delete = ""

do while lines( "lines.txt" )
   lines_to_delete = lines_to_delete linein( "lines.txt" )
end

n = 0
do while lines( "documents.txt" )
   line = linein( "documents.txt" )
   n = n + 1
   if ( wordpos( n, lines_to_delete ) == 0 )
      call lineout "temp_out,txt", line
end 
```

这会将您的输出保留在 temp_out.txt 中，您可以根据需要将其重命名为documents.txt。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-07T01:21:11.573

这可能对您有用（GNU sed）：

```
sed 's/.*/&d/' lines.txt | sed -i -f - documents.txt 
```

或者：

```
sed ':a;$!{N;ba};s/\n/d;/g;s/^/sed -i '\''/;s/$/d'\'' documents.txt/' lines.txt | sh 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-21T10:48:57.687

[我在Unix SE](https://unix.stackexchange.com/questions/209404/filter-file-by-line-number)上问了一个类似的问题，得到了很好的答案，其中包括以下 awk 脚本：

```
#!/bin/bash
#
# filterline keeps a subset of lines of a file.
#
# cf. https://unix.stackexchange.com/q/209404/376
#
set -eu -o pipefail

if [ "$#" -ne 2 ]; then
    echo "Usage: filterline FILE1 FILE2"
    echo
    echo "FILE1: one integer per line indicating line number, one-based, sorted"
    echo "FILE2: input file to filter"
    exit 1
fi

LIST="$1" LC_ALL=C awk '
  function nextline() {
    if ((getline n < list) <=0) exit
  }
  BEGIN{
    list = ENVIRON["LIST"]
    nextline()
  }
  NR == n {
    print
    nextline()
  }' < "$2" 
```

还有另一个 C 版本，它的性能更高一些：

*   [https://github.com/miku/filterline](https://github.com/miku/filterline)

# excel - 尝试从外部工作簿存储范围时运行时 13 错误

> ID：11369673
> 
> 赞同：0
> 
> 时间：2012-07-06T21:09:05.240
> 
> 标签：excel, range, runtime-error, vba

处理宏以从另一个工作簿复制一些数据并将其粘贴到具有宏的工作簿中的工作表上。我正在使用从另一个线程改编而来的这个函数来获取外部工作​​簿的文件路径：

```
 Public Function RetrieveFileName() As String

    'Show the open dialog and pass the selected file name to the String variable "sFileName"
    RetrieveFileName = Application.GetOpenFilename

    'They have cancelled.
    If RetrieveFileName = "False" Then
        Exit Function
    End If

End Function 
```

它可以工作，我可以打开工作簿，但是当我尝试存储外部工作簿中的范围（下面代码段中的最后一行）时，vba 抛出运行时错误“13”：类型不匹配。

```
Sub CreateSystemExtracts()
Dim thisRow As Long, wbkCheck As Long
Dim countryFilter As String, systemFilter As String
Dim sourceBook As Workbook
Dim sourceHeaders As Range

'Ask user where source data sits
Set sourceBook = Workbooks.Open(RetrieveFileName())

'Make sure they provided a source
If sourceBook Is Nothing Then
    MsgBox "You must select a source file to continue, macro halted."
    Exit Sub
End If

'Check if number of rows in the selected file matches what we expect
sourceHeaders = Workbooks(sourceBook).Worksheets(Sheet1).Range("A2:X2") 
```

你能告诉我哪里出错了吗？我认为这与我在最后一行声明范围的方式有关，但我尝试了很多不同的方法，都给出了运行时错误 13。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T22:31:45.247

分配对象变量时，您需要使用`Set`

```
'Check if number of rows in the selected file matches what we expect 
Set sourceHeaders = Workbooks(sourceBook).Worksheets("Sheet1").Range("A2:X2") 
```

# php - Wordpress 插件如何区分 Wordpress

> ID：11369674
> 
> 赞同：2
> 
> 时间：2012-07-06T21:09:11.433
> 
> 标签：php, wordpress

我创建了一个 wordpress 插件并将其上传到我的测试站点，但在`Plugins`wordpress 下通知我我的插件有可用更新，它会将我带到 wordpress.org 上一个完全独立的插件

为什么 wordpress 让他们感到困惑？插件如何区分为独特的？我应该有一个唯一的代码还是什么？

我的插件中有什么与插件 Wordpress 混淆的相同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T22:17:20.777

WordPress 会间歇性地调用`http://api.wordpress.org/plugins/update-check/1.0/`以确定是否有可用的新版本插件。调用正在检查 WordPress 插件目录。

您的插件名称必须是唯一的，否则您将面临与另一个插件（如您所拥有的）发生冲突的风险。插件名称在主插件文件顶部评论部分的插件元数据中设置。

避免此问题的另一种方法是将您的插件版本号设置为一个高得离谱的数字，因为检查会比较版本号以确定是否有更新的版本可用。仅当您从不打算在 WordPress 插件目录上或在野外发布您的插件时，才可以解决此问题。

作为一个有趣的附注，该检查还会发送您的博客 URL 和所有已安装插件的列表，因此 Googlesk 风格的 WordPress 很可能正在收集使用数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T21:12:34.590

猜测您应该检查插件顶部的元数据（在评论中）：

```
<?php
/*
Plugin Name: Name Of The Plugin
Plugin URI: http://URI_Of_Page_Describing_Plugin_and_Updates
Description: A brief description of the Plugin.
Version: The Plugin's Version Number, e.g.: 1.0
Author: Name Of The Plugin Author
Author URI: http://URI_Of_The_Plugin_Author
License: A "Slug" license name e.g. GPL2
*/
?> 
```

# java - 空指针异常

> ID：11369678
> 
> 赞同：-1
> 
> 时间：2012-07-06T21:09:29.037
> 
> 标签：java, nullpointerexception, poi-hssf

我得到一个空指针异常，但我不知道为什么。在将单元格读入字符串之前，我检查了该单元格是否为空。那么，为什么该字符串为空？

```
private void fillArray() 
{
    try 
    {
        readBook = new HSSFWorkbook(readFile);
    } 
    catch (IOException e) 
    {
        System.out.println("If we know what we're doing, no one should ever see this line.");
    }
    if (readBook != null) 
    {HSSFSheet infoSheet = readBook.getSheetAt(0);
        HSSFRow headingsRow = infoSheet.getRow(0);
        int i = 0;
        HSSFCell cell = headingsRow.getCell(i);
        String columnHeading = cell.toString();
        while (cell != null && !(cell.toString().equals(""))) 
        {
            cell = headingsRow.getCell(i);
            columnHeading = cell.toString();
            columnHeadings.add(columnHeading);
            i++;
        }
        if(columnListIsSetup == false)
        {
            createList();
            columnListIsSetup = true;
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T21:30:15.847

我认为这是问题所在：

```
while (cell != null && !(cell.toString().equals(""))) 
{
    // We know that cell isn't null before this line...
    cell = headingsRow.getCell(i);

    // ... but now we've got a new value for cell, which could be null
    columnHeading = cell.toString();
    columnHeadings.add(columnHeading);
    i++;
} 
```

我怀疑您想将其更改为：

```
while (cell != null && !(cell.toString().equals(""))) 
{
    // We know cell isn't null for this...
    columnHeading = cell.toString();
    columnHeadings.add(columnHeading);

    i++;
    // It's fine to set cell to null here... we'll be
    // checking again in a second...
    cell = headingsRow.getCell(i);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T23:20:06.630

```
while (cell != null && !(cell.toString().equals("")))  {
    cell = headingsRow.getCell(i);      // here, cell gets reassigned so the 
                                        // "cell != null" check in the while 
                                        // loop condition loses it's value,
                                        // you need to check again

    if (cell == null)       // add the following to make sure the NEW cell value is not null
        break;              //

    columnHeading = cell.toString();
    columnHeadings.add(columnHeading);
    i++;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T21:11:43.820

在确保单元格为空（或）为空之前，您正在做的事情`String columnHeading = cell.toString();`可能会在单元格为空的情况下导致 NullPointerException。

# c# - EmguCV 类型初始化异常

> ID：11369684
> 
> 赞同：13
> 
> 时间：2012-07-06T21:10:17.267
> 
> 标签：c#, emgucv

我真的是 EgmuCV 的新手

我尝试使用以下代码从网络摄像头捕获图像：

```
//Program.cs (Winform)
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

using Emgu.CV;
using Emgu.CV.UI;
using Emgu.Util;
using Emgu.CV.Structure;

namespace EgmuCVTest
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            Capture cp = new Capture();
            ImageViewer imv = new ImageViewer();

            Application.Idle += new EventHandler(delegate(object s, EventArgs ea)
            {
                imv.Image = cp.QueryFrame();
            });

            imv.ShowDialog();

        }
    }
} 
```

我收到以下错误：

![在此处输入图像描述](../Images/517d91a8a1d5f0f0eae3c9c4a43f94b0.png)

我检查并在 .exe 文件夹中有所有必要的 dll

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-07T15:44:04.213

在遇到同样的问题一段时间后，我发现解决这个问题的说明（[TypeInitializer Exception](http://www.emgu.com/wiki/index.php/Download_And_Installation#The_type_initializer_for_.27Emgu.CV.CvInvoke.27_threw_an_exception.)）不完整。

1.  对于基本应用程序，您需要`cvextern.dll, Emgu.CV.dll, Emgu.CV.UI.dll, Emgu.Util.dll`在 .EXE 的目录中。

2.  你需要一个 x86(x64) 目录在 .exe 目录和你需要的“x86”目录`opencv_calib3dXXX.dll, opencv_contribXXX.dll, opencv_coreXXX.dll, opencv_features2dXXX.dll, opencv_highguiXXX.dll, opencv_imgprocXXX.dll, opencv_legacyXXX.dll, opencv_mlXXX.dll, opencv_objectdetectXXX.dll, opencv_videoXXX.dll`中`cudart32_42_9.dll, npp32_42_9.dll, opencv_flann240.dll`

只要您包含所有必需的 DLL，该应用程序就会运行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-07-21T02:09:05.300

我正在使用 Emgu 3.0 64 位，解决这个问题我唯一需要做的就是将项目中的构建类型更改为 x64。

> 右键单击您的**项目名称**->**属性**->**构建**->**平台目标**-> **x64**

参考[http://www.codeproject.com/Articles/257502/Creating-Your-First-EMGU-Image-Processing-Project](http://www.codeproject.com/Articles/257502/Creating-Your-First-EMGU-Image-Processing-Project)

希望它可以帮助某人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-28T17:29:02.893

发生在我身上的另一种情况是，我有一个 NuGet 包已安装但未为我的项目加载，因此引用看起来不错，但在运行时，我得到了 TypeInitializationException。

-管理 NuGet 包

-时钟管理包

- 选中当前项目的复选框。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-26T05:09:12.813

如果您使用的是使用 GPU 支持编译的 OpenCV DLL，但您的 PC 没有 GPU，例如，如果您使用带有 Intel 图形芯片组的便携式计算机，也会出现此问题。

在这种情况下，您可以使用旧版本 2.4.0，它仍然提供不支持 GPU 的 DLL：

[https://sourceforge.net/projects/emgucv/files/emgucv/2.4.0/libemgucv-windows-x64-2.4.0.1717.zip](https://sourceforge.net/projects/emgucv/files/emgucv/2.4.0/libemgucv-windows-x64-2.4.0.1717.zip)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-09T21:31:10.320

如果您使用的是 64 位操作系统，只需从 x64 文件夹复制**cvextern.dll文件，然后将其复制到项目的****调试**文件夹中。

**注意：**手动执行，因为*“添加现有项目”*不会复制它。

# c# - 对于我的场景，我不明白如何利用 Web API

> ID：11369685
> 
> 赞同：0
> 
> 时间：2012-07-06T21:10:18.343
> 
> 标签：c#, asp.net, asp.net-mvc, web-services

我正在设计一组不需要典型 CRUD 功能的 API。我只需要向客户端提供数据，这涉及对从我的后端数据库获取的数据应用各种过滤器。例如，目前我有以下 API：

```
Service.asmx/GetEvents 
```

具有以下签名：

```
public CustomObject GetEvents(string Location = "", string Company = "", string PersonType = "", string FromDate = "", string ToDate = "")
{
    ....
} 
```

如果我所有的 API 看起来都像这样，我该如何使用 MVC4 Web API？我目前在我的项目的其余部分和 Web 服务中使用 AVC4 只是为了公开 API，我确信这是一种错误的做事方式。我对我目前的服务很满意，但我确实看到一些帖子散布在 SO 和博客圈中，说 Web API 是必经之路，因为那是未来。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T07:31:15.997

您编写一个从[ApiController](http://msdn.microsoft.com/en-us/library/system.web.http.apicontroller%28v=vs.108%29.aspx)派生的控制器并公开一个操作。您还可以将过滤器逻辑封装到模型中：

```
public class Filter
{
    public string Location { get; set; }
    public string Company { get; set; }
    public string PersonType { get; set; }
    public string FromDate { get; set; }
    public string ToDate { get; set; }
} 
```

和控制器：

```
public EventsController: ApiController
{
    public CustomObject Get(Filter filter)
    {
        ...
    }
} 
```

现在假设默认路由，您的 API 已准备好在`/api/events`.

如果您想了解更多有关 Web API 的信息，建议您从官方网站开始：[http ://www.asp.net/web-api](http://www.asp.net/web-api)

# c++ - 追踪连接的像素

> ID：11369689
> 
> 赞同：1
> 
> 时间：2012-07-06T21:10:48.787
> 
> 标签：c++, c, image-processing, opencv

我想跟踪图像的所有连接像素。我使用精明算法进行边缘检测，现在需要获取每个独特的形状。

![在此处输入图像描述](../Images/9fa79ce1c86f2132a9cff07c2f5537b8.png) 这是我的以下代码

```
x_axis = marker_i;   // x & y co-ordinates of the first detected pixels
y_axis = marker_j;

do
{

for (int i=0;i<8;i++){

if(i==0){x_axis = x_axis-1;  y_axis = y_axis-1;}  // each iteration checks one 
if(i==1){x_axis = x_axis;    y_axis = y_axis+1;}  // of the 8 adjacent pixels 
if(i==2){x_axis = x_axis;    y_axis = y_axis+1;}  // for a match 
if(i==3){x_axis = x_axis+1;  y_axis = y_axis-2;}
if(i==4){x_axis = x_axis;    y_axis = y_axis+2;}
if(i==5){x_axis = x_axis+1;  y_axis = y_axis-2;}
if(i==6){x_axis = x_axis;    y_axis = y_axis+1;}
if(i==7){x_axis = x_axis;    y_axis = y_axis+1;}

if(x_axis >= 1024 || y_axis >= 1280){ x_axis = 0; y_axis = 0;}

if(ch_rd == red [x_axis][y_axis] && ch_gr == green[x_axis][y_axis] 
&& ch_bl == blue[x_axis][y_axis] && pixel_comp[x_axis][y_axis]==0){ 

map++;
pixel_comp[x_axis][y_axis] = 2;                  // marks that pixel as read
pixal[num][0]    = x_axis;
pixal[num][1]    = y_axis;

if (map == 1){ curs[0] = x_axis; curs[1] = y_axis;}
if (map >  1){ div[est] = num; est++;}   // if there is more than one detection
num++;                                   // adds remaining to an array div

}

}

if(map==0){ 
x_axis = pixal[div[prev]][0]; y_axis = pixal[div[prev]][1]; prev++; 
    // if nothing is detected goes to the last item from array div
}
else{ 
x_axis = curs[0]; y_axis = curs[1]; 
} 
if(map==0 && prev>=est){ dead_end = 1;}
map = 0;
}
while (dead_end==0); 
```

我在我的程序的早期版本中使用它，它会不幸地检测到所有形状，即使它们没有连接而不是一个一个连接，现在我一直在尝试 opencv 并且想知道是否有一个函数或实现可以做到这一点甚至是我可以使用的非opencv实现或示例？为此目的的简单算法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T23:17:09.720

一个很好的起点是关于[Flood Fill](http://en.wikipedia.org/wiki/Flood_fill)的 Wikipedia 文章。这有填充算法的动画。

[你没有要求更正你的程序。]

# c# - 实体框架在运行时创建数据库和表

> ID：11369693
> 
> 赞同：6
> 
> 时间：2012-07-06T21:11:19.737
> 
> 标签：c#, wpf, entity-framework

我在 .edmx 文件中创建了一些表，并通过选择“从模型生成数据库”并在数据库上手动执行 .edmx.sql 文件来构建表来生成数据库。

然而，现在我正在创建一个设置对话框，允许用户将程序连接到他们自己的数据库。我认为运行[`context.CreateDatabase`](https://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.createdatabase(v=vs.110).aspx)足以创建数据库以及表，但没有创建表。

最初从模型开始时，当用户指定要使用的自己的服务器和数据库时，创建数据库和表的首选方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-06T23:57:57.227

好的，我想出了一种创建表和数据库的方法（不一定是最好的方法）。[`CreateDatabaseScript`](https://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.createdatabasescript(v=vs.110).aspx)可以执行的结果：

```
// create the database
db.CreateDatabase();
// grab the script to create the tables
string createScript = db.CreateDatabaseScript();
// execute the script on the database
db.ExecuteStoreCommand(createScript); 
```

您必须进行一些检查以确保尚未创建表和数据库，否则应用程序将崩溃。

不过，我将尝试将我的项目切换到代码优先。希望以上内容对寻找的人有所帮助。

# php - PHP：如何访问已在其外部声明的函数内部的变量？

> ID：11369699
> 
> 赞同：2
> 
> 时间：2012-07-06T21:11:47.313
> 
> 标签：php, function, include, visibility

在每一页的开头，我都包含一个启动 SESSION 等的文件，让我们称之为`session.php`。在这个文件`session.php`中，我包含了一个包含函数的文件，我们称之为它`function1.php`，因为我需要该函数在`session.php`.

但是，稍后在主页中我还包含`function2.php`了哪些需要访问设置在中的变量`session.php`，所以我另外尝试包含`session.php`在`function2.php`.

问题是发生错误，因为 function1 将被多次声明......

> 致命错误：无法重新声明 function1()（之前在 ...

那么，什么是更优雅和更干净（er）的解决方案呢？你怎么能解决它？

基本上，我需要访问之前已包含在主页中的函数内的变量......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-06T21:26:02.813

这不是公共变量和私有变量的问题，因为您想要从 session.php 获得的变量不是对象的一部分。它们只是您在全局范围内（可能）声明的变量，现在需要在 function2.php 中访问。

第一：function2.php 的内容......是一个函数吗？如果不是，那么该文件应该与脚本中包含它的位置具有相同的范围，并且应该能够正常访问它们。

如果您需要访问 session.php 变量的位置是一个函数或一个对象，那么您有几个选择。

**0.重新包含文件**

这就是你现在想要做的。它失败是因为 session.php 还包含一个函数定义，并且一旦创建函数就不能重新定义它。作为一种解决方法，您可以将变量定义移动到一个单独的文件中，并将其包含在 function2 中。这很笨拙，但很简单。

**1\. 调用时将变量传递给函数。**

*   优点：简单灵活。
*   缺点：调用函数有点痛苦。您可以通过将它们全部放入单个参数数组中来简化这一点，而不是单独传递每个参数。

**2.使用`global`**

在 function2 的开头，只需添加命令`global $var1, $var2 ...`以导入脚本中其他地方使用的任何变量。

这也很简单，但是许多程序员认为使用全局变量是草率的，并且会使您在其他地方遇到难以调试的错误。

**3.使用常量**

在 session.php 中，将要共享的变量定义为常量。例如，`define("PASSWORD", "coolpassword123")`。常量可以从内部函数或对象等中引用，声明后永远不能更改。例如，`echo(PASSWORD)`（没有引号，没有 $）。

常量通常是此类问题的最佳解决方案，只要 1）您不需要更改它们的值，并且 2）您可以坚持使用简单的数字或字符串值。常量不能是数组、对象等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T21:14:07.350

尝试`include_once`代替`include`

[http://php.net/manual/en/function.include-once.php](http://php.net/manual/en/function.include-once.php)

编辑：完整的例子

**主文件**

```
<?php
include_once 'session.php';
include 'function2.php'; 
```

**会话.php**

```
<?php
include_once 'function1.php';
function1('session.php'); 
```

**函数1.php**

```
<?php
function function1($calledFrom)
{
    echo 'function1 called from: ' . $calledFrom . PHP_EOL;
} 
```

**函数2.php**

```
include_once 'function1.php';
function1('function2.php'); 
```

将这些都放在同一个文件夹中并运行

```
php main.php 
```

输出是：

> 函数1调用自：session.php
> 
> 函数1调用自：function2.php

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T21:30:21.977

首先确保您没有对将包含的文件中的函数使用相同的名称。

之后，您可以简单地将有问题的变量作为函数的参数传递

```
function1($variable1); 
```

然后在函数中检索它

```
function function1($getvar){
    //do something with the passed variable $getvar
} 
```

# ios - 使用 ADFS/AD 和 WebApi 的 REST Web 服务的反向代理

> ID：11369700
> 
> 赞同：2
> 
> 时间：2012-07-06T21:12:01.830
> 
> 标签：ios, rest, proxy, wif, adfs

我需要为防火墙后面的 REST Web 服务实现反向代理。反向代理应针对企业 ADFS 2.0 服务器进行身份验证，最好使用 .net 4.5 中的声明。客户端将是 iOS、Android 和 Web 的混合体。我对这个话题完全陌生；我尝试使用 WebApi、WIF 和 VS 2012 中的新身份和访问控制将服务实现为 REST 服务，但没有成功。我也曾尝试研究 Brock Allen 的 Thinktecture.IdentityModel.45，但后来我头晕目眩，所以我没有看到它与带有身份和访问控制的 Windows Identity Foundation 之间的区别。

所以我想我需要退后一步，就如何做到这一点获得一些建议。据我了解，有几种方法可以做到这一点。

1.  在硬件方面。将我们的 Citrix Netscaler 设置为反向代理。我不知道该怎么做，但是如果这是一个好的解决方案，我总是可以聘请知道的人......</li>
2.  在网络服务器中执行此操作，例如 IIS。我没试过；不知道它是否会起作用。
3.  创建一个 Web 服务来执行此操作。3.1 使用 WCF 将其实现为 SOAP 服务。据我了解，ADFS 不支持 REST，所以我必须使用 SOAP。问题是移动设备不喜欢 SOAP，我也不喜欢……但是，如果这是最好的方法，我必须这样做。3.2 使用 Azure 访问控制服务。它可能会起作用，但是时机不好。我们的企业正在考虑多种云选项，而我们自己跳上天蓝色的马车可能不是现在最明智的做法。但是，如果这是唯一的选择，我们可以做到。我只是不想现在使用它。

现在我觉得有太多的选择，我不知道哪一个会起作用。如果有人能指出我正确的方向，走哪条路，我将不胜感激。

# javascript - Jquery Mouseenter 单击删除类不起作用

> ID：11369702
> 
> 赞同：1
> 
> 时间：2012-07-06T21:12:11.073
> 
> 标签：javascript, jquery

我真的希望有人可以提供帮助。我有一个无序列的锚点列表，在 mouseenter 上淡入不透明度（css 默认为 0.7），然后在 mouseleave 上再次淡出。

单击时，我想添加一个使不透明度保持完整的类。到目前为止，但从匹配的元素中删除类目前不起作用 - 具有该类的其他项目也保持完全不透明。

这是jQuery：

```
 $(document).ready(function () {

        $("#nav a").mouseenter(function () {
            $(this).fadeTo("slow", 1);
            $("#nav a").click(function () {
                $(".activeList").removeClass("activeList"); //THIS PART ISN'T WORKING   
                $(this).addClass("activeList");
            });
        });

        $("#nav a").mouseleave(function () {
            if (!$(this).hasClass("activeList")) {
                $(this).fadeTo("fast", 0.7);
            }
        });
    }); 
```

我认为这是因为我因为 mouseenter 而被困在元素中并且只能影响（this）。已经尝试过 .bind/.unbind，已经尝试过自己的 add/remove 类（它有效）和其他一些东西，但到目前为止还没有运气！任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:15:16.253

尝试这个：

```
 $(document).ready(function () {

        $("#nav a").mouseenter(function () {
            $(this).fadeTo("slow", 1);
        });

        $("#nav a").click(function () {
            $(".activeList").removeClass("activeList"); //THIS PART ISN'T WORKING   
            $(this).addClass("activeList");
        });

        $("#nav a").mouseleave(function () {
            if (!$(this).hasClass("activeList")) {
                $(this).fadeTo("fast", 0.7);
            }
        });
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T12:51:05.733

我发现不透明度是通过添加到元素的样式属性来添加的，因此删除类没有帮助，尝试像这样清除样式：

```
 $("#nav a").click(function () {
        $(".activeList").attr("style", "");
        $(".activeList").removeClass("activeList");
        $(this).addClass("activeList");
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T15:31:39.643

试试下面的（它几乎是相同的代码，但布局不同，有一些调整）：

```
$(document).ready(function () {

    $("#nav a").hover(function(e) { //On hover in
        $(this).fadeTo("slow",1);
    },function(e) { //On hover out
        if(!($(this).hasClass("activeList")))
        {
            $(this).fadeTo("fast",0.7);
        }
    }).click(function(e) { //On click
        $("#nav a").removeClass("activeList");
        $(this).addClass("activeList");
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-07T18:43:27.397

意识到不透明度直到悬停才消失，可能是因为页面没有刷新，不知道。已经编辑了我自己的代码以使其工作，但认为我可能会将我的解决方案应用于您的解决方案，因为您的解决方案更具语义。这是我得到的：

```
 $(document).ready(function () {
    $("#nav a").mouseenter(function () {
    if (!$(this).hasClass("activeList")) // Added IF here, only had it on 
                                         // mouseleave originally
        {
        $(this).stop().fadeTo("slow", 1);
        }
          $("#nav a").click(function () {
          $(".activeList").stop().removeClass("activeList"); 
          $(this).stop().stop().addClass("activeList");
          $("#nav a").stop().not(".activeList").fadeTo("fast",0.7);
   //The class came off, but the opacity didn't fade because no page refresh..?
   //Added extra animation eliminating selected with .not to fix

        });
        });
            //THE REST IS SUPERFLUOUS
        $("#nav a").mouseleave(function () {
        if (!$(this).hasClass("activeList")) 
             {
           $(this).stop().fadeTo("fast", 0.7);
             }
    });
}); 
```

也必须在我的中添加一些 .stop 部分，因为多次悬停并不好。现在将停止发布，也许只是对你的评论发表一条评论，说我是否设法将我的答案整合到你更整洁的代码中。

非常感谢大家的发帖，我真的很感激！

# r - 在 R 中为多个数据子集创建分位数表

> ID：11369707
> 
> 赞同：0
> 
> 时间：2012-07-06T21:12:32.390
> 
> 标签：r, indexing

我正在尝试在**R**中为多个数据子集创建一个分位数表。

现在，我`p_ids`在 table`DATA`中有一个不连续的 ids ( ) 向量。对于 中的每个值`p_ids`，我希望列出分位数。

到目前为止，我已经尝试了以下变体：

```
i <- 1
n <- 1

for (i in p_ids) {
    while(n <= nrow(data)) {
        quantiles[n] <- quantile(subset(alldata$variableA, alldata$variableB == i),
                                 probs = c(0,1,2,3)/3)
        n <- n + 1
    }
} 
```

我知道我的问题出在索引的某个地方，但我似乎无法找到索引应该去的地方。建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:23:04.373

您应该考虑使用聚合为您做分位数 [http://stat.ethz.ch/R-manual/R-devel/library/stats/html/aggregate.html](http://stat.ethz.ch/R-manual/R-devel/library/stats/html/aggregate.html)

设置 FUN=quantiles 和 by=p_ids 应该做你想做的。

那是除非我误解了你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:46:12.447

看看`cut()`。例如：

```
q <- cut(p_ids, 2) 
data.frame(P_id = p_ids, Bin = q) 
```

第二个参数`cut()`是你想要多少个垃圾箱。

# dynamic - ExtJS (4.0) 动态/延迟加载

> ID：11369710
> 
> 赞同：1
> 
> 时间：2012-07-06T21:12:35.703
> 
> 标签：dynamic, extjs, lazy-loading

给定具有西部（导航）和中心区域的边界布局。假设我单击西部区域的主题 A，我想用名为 topic_a.js 的程序代码“extjs”**替换**（替换为“删除最后一个主题”）中心区域

我成功加载了这段代码：

```
dynamicPanel = new Ext.Component({
    loader: {
        url: '/www/file.htm',
        renderer: 'html',
        autoLoad: true,
        scripts: true
    }
});

var oMainContainer = Ext.getCmp('maincontainer');
oMainContainer.show();
oMainContainer.add(dynamicPanel); 
```

但是第二次调用这个在中心区域“添加”东西，当然在“删除”方面失败了，什么是好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T04:28:42.663

你不能做这样的事情：

```
var oMainContainer = Ext.getCmp('maincontainer');
oMainContainer.show();
oMainContainer.removeAll();
oMainContainer.add(dynamicPanel); 
```

[http://docs.sencha.com/ext-js/4-0/#!/api/Ext.container.Container-method-removeAll](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.container.Container-method-removeAll)

我希望我能正确理解你的问题。这将删除所有子组件，您可以将它们添加到新组件中。

# .net - .net webbrowser 控制多线程，抛出“EXCEPTION code=ACCESS_VIOLATION”

> ID：11369713
> 
> 赞同：1
> 
> 时间：2012-07-06T21:12:58.250
> 
> 标签：.net, multithreading, browser, access-violation

我想制作一个控制台程序来监控网页的 htmlsourcecode，因为某些页面内容是由一些 javescript 创建的，所以我必须使用 webbrowser 控件。like :[在 C# 中查看生成的源代码（在 AJAX/JavaScript 之后）](https://stackoverflow.com/questions/1307800/view-generated-source-after-ajax-javascript-in-c-sharp)

我的代码如下：

```
public class WebProcessor
{
    public string GeneratedSource;
    public string URL ;

    public DateTime beginTime;
    public DateTime endTime;

    public object GetGeneratedHTML(object url)
    {
        URL = url.ToString();
        try 
        {
            Thread[] t = new Thread[10];

            for (int i = 0; i < 10; i++) 
            {
                t[i] = new Thread(new ThreadStart(WebBrowserThread));
                t[i].SetApartmentState(ApartmentState.STA);
                t[i].Name = "Thread" + i.ToString();
                t[i].Start();
                //t[i].Join();          
            }

        } 
        catch (Exception ex) 
        {
            Console.WriteLine(ex.ToString());
        }

        return GeneratedSource;
    }

    private void WebBrowserThread()
    {
        WebBrowser wb = new WebBrowser();
        wb.ScriptErrorsSuppressed = true;

        wb.DocumentCompleted += 
            new WebBrowserDocumentCompletedEventHandler(
                wb_DocumentCompleted);

        while(true )
        {
            beginTime = DateTime.Now;

            wb.Navigate(URL);

            while (wb.ReadyState != WebBrowserReadyState.Complete)
            {
                Application.DoEvents();
            Thread.Sleep(new Random().Next(10,100));
            }
        }               

        //wb.Dispose();                 
    }

    private void wb_DocumentCompleted(object sender, 
        WebBrowserDocumentCompletedEventArgs e)
    {
        WebBrowser wb = (WebBrowser)sender;
        if (wb.ReadyState == WebBrowserReadyState.Complete)
        {
            GeneratedSource= wb.Document.Body.InnerHtml;

            endTime = DateTime.Now;
            Console.WriteLine("WebBrowser " + (endTime-beginTime).Milliseconds + Thread.CurrentThread.Name + wb.Document.Title);            
        }
    } 
} 
```

当它运行时，经过一段时间（20-50次），它会抛出这样的异常

```
----------------------------------------------------------------------------
EXCEPTION code=ACCESS_VIOLATION
(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(nul
l)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(n
ull)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)
(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(null)(nul
l)(null)BACKTRACE: 33 stack frames:
 #0 0x083dba8db0 at MatchExactGetIDsOfNames in mshtml.dll
 #1 0x0879f9b837 at StrongNameErrorInfo in mscorwks.dll
 #2 0x0879f9b8e3 at StrongNameErrorInfo in mscorwks.dll
 #3 0x0879f9b93a at StrongNameErrorInfo in mscorwks.dll
 #4 0x0879f9b9e0 at StrongNameErrorInfo in mscorwks.dll
 #5 0x0879f9b677 at StrongNameErrorInfo in mscorwks.dll
 #6 0x0879f9b785 at StrongNameErrorInfo in mscorwks.dll
 #7 0x0879f192a8 at InstallCustomModule in mscorwks.dll
 #8 0x0879f19444 at InstallCustomModule in mscorwks.dll
 #9 0x0879f194ab at InstallCustomModule in mscorwks.dll
 #10 0x0879fa6491 at StrongNameErrorInfo in mscorwks.dll
 #11 0x0879f44bcf at DllGetClassObjectInternal in mscorwks.dll
 #12 0x089bbafa at  in
 #13 0x087b18cc10 at  in System.Windows.Forms.ni.dll
 #14 0x087b91f4c1 at  in System.Windows.Forms.ni.dll
 #15 0x08d00669 at  in
 #16 0x08792d6e46 at  in mscorlib.ni.dll
 #17 0x08792e02cf at  in mscorlib.ni.dll
 #18 0x08792d6dc4 at  in mscorlib.ni.dll
 #19 0x0879e71b4c at  in mscorwks.dll
 #20 0x0879e896ce at  in mscorwks.dll
 #21 0x0879e96ea9 at CoUninitializeEE in mscorwks.dll
 #22 0x0879e96edc at CoUninitializeEE in mscorwks.dll
 #23 0x0879e96efa at CoUninitializeEE in mscorwks.dll
 #24 0x0879f88357 at GetPrivateContextsPerfCounters in mscorwks.dll
 #25 0x0879e9cc8f at CoUninitializeEE in mscorwks.dll
 #26 0x0879e9cc2b at CoUninitializeEE in mscorwks.dll
 #27 0x0879e9cb51 at CoUninitializeEE in mscorwks.dll
 #28 0x0879e9ccdd at CoUninitializeEE in mscorwks.dll
 #29 0x0879f88128 at GetPrivateContextsPerfCounters in mscorwks.dll
 #30 0x0879f88202 at GetPrivateContextsPerfCounters in mscorwks.dll
 #31 0x0879f0e255 at InstallCustomModule in mscorwks.dll
 #32 0x087c80b729 at GetModuleFileNameA in KERNEL32.dll
---------------------------------------------------------------------------- 
```

我尝试了很多方法来解决这个问题，最后，我发现如果我的线程睡眠多毫秒，它会运行更长的时间，但仍然抛出异常。

希望有人给我如何解决这个问题的答案......非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-09T22:53:27.653

你从哪里得到异常（我的意思是行号）。我想它正在通话`wb.ReadyState != WebBrowserReadyState.Complete`中，因为您正在从与创建控件实例的线程不同的线程上的控件中检索一些数据。如果是这种情况，那么您必须从正确的线程调用该属性。

我会将您的 while 循环更改为：

```
System.Windows.Forms.WebBrowserReadyState state = GetState(Program.BrowsingSystem.BrowserLink);
        while (state != System.Windows.Forms.WebBrowserReadyState.Complete)
        {
            Application.DoEvents();
            Thread.Sleep(new Random().Next(10, 100));
        } 
```

将其与以下调用的方法相关联：

```
private System.Windows.Forms.WebBrowserReadyState GetState(System.Windows.Forms.WebBrowser instance)
    {
        if (instance.InvokeRequired)
        {
            var wbFunc = new Func<System.Windows.Forms.WebBrowser, System.Windows.Forms.WebBrowserReadyState>(RetrieveState);
            IAsyncResult FunFuncResult = wbFunc.BeginInvoke(instance, null, null);
            return wbFunc.EndInvoke(FunFuncResult);

        }
        else
        {
            return RetrieveState(instance);
        }
    }

    public System.Windows.Forms.WebBrowserReadyState RetrieveState(System.Windows.Forms.WebBrowser instance)
    {
        return instance.ReadyState;
    } 
```

我无法测试它，因为我错过了应用程序的其余部分，但它应该接近最终解决方案。

# c# - 如何从 mp3 读取元数据？

> ID：11369719
> 
> 赞同：6
> 
> 时间：2012-07-06T21:13:31.173
> 
> 标签：c#, metadata, mp3

我正在尝试从 mp3 文件中读取标签。我想知道是否有人对如何做到这一点有任何建议？我不想使用 3rd 方库为我处理阅读/组织。这样做的目的只是让我弄清楚如何读取编码数据？我知道主要有 2 种不同的格式，ID3v1 和 ID3v2。真的，我的问题只是能够以我可以处理的格式获取信息。我有几个想法来实际存储我需要的数据并在我得到它后解析信息。我主要只是需要一些关于如何以纯文本形式收集元数据的指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T21:35:36.837

好的，我并不反对编写自己的代码（正如我对问题的评论可能暗示的那样）。实际上恰恰相反，感谢您想要开发自己的库。

也就是说，[Taglib sharp](http://download.banshee.fm/taglib-sharp/2.0.3.7/)是开源的，同时处理 Id3v1 和 id3v2（以及更多），它应该是一个很好的起点。不久前，我将它的某些部分移植到 silverlight，如果我没记错的话，这并不是大量的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T21:26:33.737

使用二进制阅读器对象。[http://msdn.microsoft.com/en-us/library/system.io.binaryreader.aspx](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.aspx)

通用 lisp（id3 解析器）示例： http: [//www.gigamonkeys.com/book/practical-an-id3-parser.html](http://www.gigamonkeys.com/book/practical-an-id3-parser.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T21:33:00.057

我建议从 C# ID3 Library 浏览 SVN 以获取您需要的代码。 [http://sourceforge.net/projects/csid3lib/](http://sourceforge.net/projects/csid3lib/)

我在市场上有一些编辑 mp3 文件的 WPF 应用程序，其他推荐 taglib sharp 的应用程序是正确的，你应该避免麻烦并使用它。

# c# - 如何创建托管进程？

> ID：11369723
> 
> 赞同：0
> 
> 时间：2012-07-06T21:13:49.997
> 
> 标签：c#, .net

如何在 C# 中创建托管进程？我想启动一个应用程序（托管）并为其分配一个调试器并从中检索数据（手表的值）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T09:45:49.983

您可以使用[IPC（进程间通信）](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365574%28v=vs.85%29.aspx)。

# php - Jquery 文件上传隐藏的 IFrame

> ID：11369726
> 
> 赞同：2
> 
> 时间：2012-07-06T21:14:15.957
> 
> 标签：php, javascript, jquery, ajax, json

我需要快速解释如何使用隐藏的 iframe 上传 AJAX 样式文件。这是与表单有关的 HTML 代码部分：

```
<div id = "file" class = "info">        
    <form id="file_upload_form" method="post" enctype="multipart/form-data" action='script/uploadScript'>
        <input name="file" id="file" size="27" type="file" /><br />
        <input id = "uploadSubmit" type="submit" name="action" value="Upload" />
        <iframe id="upload_target" name="upload_target" src="" style="width:0;height:0;border:0px solid #fff;"></iframe>
    </form>
</div> 
```

这是相关的PHP：

```
public function uploadScript(){

    $returnVals = array();

    if ($_FILES["file"]["error"] > 0){
        $returnVals['error'] =  "Error: " . $_FILES["file"]["error"] . "<br />";
    }else{
        if ($_FILES["file"]["type"] != "text/plain"){
            $returnVals['error'] = "Badtype";
        }else{
            $returnVals['text'] =  file_get_contents($_FILES["file"]["tmp_name"]);
        }
    }

    echo json_encode($returnVals);
} 
```

因此，本质上，PHP 获取文件并检查它是否是文本文件。然后，我想在 javascript 中访问返回的 json。这就是我感到困惑的地方...

```
$("#file_upload_form").submit(function() {
    $("#file_upload_form").target = "upload_target";
    $("#upload_target").onload = uploadDone();

}); 
```

理想情况下，当上传完成并加载 iframe 时，应该调用

```
function uploadDone() {
    alert($("#upload_target").contents().find("body").text());  
} 
```

但是，那总是空白。本质上，returnVals 被放置在 iframe 主体中，但在警报之后，因此警报中没有任何内容。那么，有没有办法弥补这个小缺陷呢？

有没有更好的解释如何做到这一点？我整天都在用不同的示例代码等敲打我的头，但没有运气：/

我本质上希望能够提醒通过 php 代码返回的文本。顺便说一句，我这样做是因为我希望它能够在 IE7 和之后的所有浏览器上运行。

我会很感激任何帮助。谢谢你的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:18:50.787

好吧，我用过类似的东西：

```
$("#upload_target")[0].contentWindow.document.body.innerHTML 
```

... 反而。但是一般的做法是类似的：检查这个字符串，如果它是空的，什么都不做（即立即返回）。否则继续分析这个 json。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T21:43:51.583

我使用此代码，并为我工作：

```
$(document).ready(function(){
    $('form#myform').submit(function(){
          $("#hiddenIframe").remove();    
          $('<iframe name="hiddenIframe" />').appendTo('body').attr({'id': 'hiddenIframe'});
          var Frame = $('#hiddenIframe');
          var newSrc = 'about:blank?nocache=' + Math.random(); //force new URL
          Frame.attr('src', newSrc); 
          var iframe = $('#hiddenIframe').load(function(){
              var response = iframe.contents().find('body').html();
              var txt = $.parseJSON(response);
              $('#message').append(txt.message);
              if(txt.error == false){
                   $.ajax({
                       type: 'POST',
                       url: '?myurl',
                       dataType: 'json',
                       data: {
                           //some data
                       },
                       success: function(data){
                           //some action
                       } 
                   });                                         
              }           
         });                                             
    });
}); 
```

这会在每次提交时生成一个新的 iframe，我的 PHP 部分

```
$this->message['error'] = true;
$this->message['message'] = "Problem!";

echo/print json_encode($this->message); 
```

试试这个

# android - 启动 Android 设备时重复通知

> ID：11369727
> 
> 赞同：0
> 
> 时间：2012-07-06T21:14:31.957
> 
> 标签：android, android-notifications, android-alarms

在 Android 中，我使用 AlarmManager 设置每天执行一次的重复任务。用户可以选择此警报的时间。例如，当他选择 9:00 点时，每天 9 点执行给定任务，即启动待处理意图，将通知发送到通知栏。

我的应用程序的用户说，当他们的设备当时关闭时，根本没有任何通知。是否真的，当设备在警报响起时关闭时，再次启动后警报不会重复？

如果这是正常行为，如何规避？我应该在触发通知的 IntentService 中编写一个共享首选项（例如“last_execution_time”）吗？在启动时，我可以检查最后一次执行是否超过 24 小时，如果是，重复吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:54:22.847

使用 action 为意图注册广播接收器`android.intent.action.BOOT_COMPLETED`，这将启动与您使用 AlarmManager 计划的任务相同的任务（以前确保它没有被 AlarmManager 在适当的时间触发）。

编辑：为了跟踪尝试这样的事情（它只是一个提示 - 自己安全地处理 9 点左右的确切时间；）

```
public class KeepTrackReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        SharedPreferences p = context.getSharedPreferences(
                TrackedAlarmService.FILE_ALARM_TRACK, Context.MODE_PRIVATE);
        long lastAlarm = p.getLong(TrackedAlarmService.KEY_LAST_ALARM_MILLIS, -1L);
        if(lastAlarm == -1L || lastAlarm < TrackedAlarmService.getClosest9AM(false)) {
            context.startService(TrackedAlarmService.createIntent(context));
        }

    }
}
public class TrackedAlarmService extends IntentService {

    public static final String FILE_ALARM_TRACK = "alarmTrack";
    public static final String KEY_LAST_ALARM_MILLIS = "lastAlarmMillis";

    public static void schedule(Context context) {
        AlarmManager am = (AlarmManager) context.getSystemService(
                Context.ALARM_SERVICE);

        PendingIntent pi = PendingIntent.getService(context, 0, 
                createIntent(context), PendingIntent.FLAG_CANCEL_CURRENT);

        am.setRepeating(AlarmManager.RTC_WAKEUP, getClosest9AM(true), 
                AlarmManager.INTERVAL_DAY, pi);
    }

    public static long getClosest9AM(boolean futurePastFlag) {
        Calendar c = Calendar.getInstance();
        c.setTimeInMillis(System.currentTimeMillis());
        if(futurePastFlag) {
            if(c.get(Calendar.HOUR_OF_DAY) > 9) {
                c.roll(Calendar.DATE, true);
            }
        }
        else {
            if(c.get(Calendar.HOUR_OF_DAY) < 9) {
                c.roll(Calendar.DATE, false);
            }
        }
        c.set(Calendar.HOUR_OF_DAY, 9);
        c.set(Calendar.MINUTE, 0);
        return c.getTimeInMillis();
    }

    public static Intent createIntent(Context context) {
        return new Intent(context, TrackedAlarmService.class);
    }

    public TrackedAlarmService() {
        super("TrackedAlarmService");
    }

    @Override
    protected void onHandleIntent(Intent intent) {

        //save last alarm time  
        getSharedPreferences(FILE_ALARM_TRACK, MODE_PRIVATE)
            .edit()
            .putLong(KEY_LAST_ALARM_MILLIS, System.currentTimeMillis())
            .commit();

        // Do your repeating job....
    }
} 
```

# python - 从 django admin 访问其他模型

> ID：11369728
> 
> 赞同：0
> 
> 时间：2012-07-06T21:14:39.107
> 
> 标签：python, django, admin

我正在编写一个工具来监视外部 api 并验证它是否按文档说明工作。

基本上我有两个模型：

`ServerTest`，它有一个 url 和一个 json 字符串，我们希望目标服务器为该 url 返回

和

`TestResult`它与 具有外键关系`ServerTest`，包含服务器实际响应的字符串，以及测试发生时间的时间戳。

应用程序将定期运行每个`ServerTest`，ping TargetServer，并`TestResult`为每个`ServerTest`.

现在我想做的是查看实际和预期 json 之间的 json 差异。我在想我可能会使用这个小部件： [http](http://tlrobinson.net/projects/javascript-fun/jsondiff/) ://tlrobinson.net/projects/javascript-fun/jsondiff/ 。我还想我可能会将该小部件嵌入到 django 管理员中。问题是，为了生成差异，我需要访问 ServerTest 实例和最新的相应 TestResult 实例。似乎没有直接的方法可以通过 django admin 执行此操作。我应该放弃并单独提出观点吗？我宁愿不这样做，因为我觉得我会继续向该视图添加功能，直到我重新实现了 django 管理界面的一半。

回顾一下，我需要：

1) 访问一个 ServerTest 实例

2) 访问一个 TestResult 实例

3) 添加一个 html 容器（例如，在 ServerTest 管理页面上）

4）运行一些可以访问当前查看的ServerTest的expected_json和最新对应TestResult的actual_json的javascript

5) 让 javascript 将 html 动态注入到上述容器中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:35:40.750

由于您无论如何都在注入 html，我会做一个简单的视图，生成您需要的差异，然后在管理页面中调用它。

为了在 admin 中添加自定义 JS，您可以使用 ModelAdmin [Media](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#modeladmin-media-definitions)

# relational-database - Filemaker Pro 连接表记录未自动创建

> ID：11369730
> 
> 赞同：1
> 
> 时间：2012-07-06T21:14:48.323
> 
> 标签：relational-database, filemaker

在 filemaker pro 12 中

表：

*   部门
*   讲师
*   训练

关系：

*   部门和教师：多对多（很烂，但一名教师可以在两个部门任教）
*   讲师和培训：多对多

两种关系都有带有外键字段的连接表。

我正在尝试使用小计部分创建布局。首先，我希望按部门排序。其次是培训。我按部门编号（部门字段）和事件名称（事件字段）排序。排序显示部门的两个小结和实际工作，但由于某种原因未显示事件。可以看到它的小结，但值为空。我该如何解决？

编辑：我已将其缩小到 Instructor 的 Join 表，Training 没有任何记录。相关表不会自动创建连接表记录是否有原因？

如果您对我的问题还有任何疑问，请告诉我。FMK让我很沮丧

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T10:09:10.507

您希望 FileMaker 如何在连接表中创建记录？FileMaker 不知道要链接哪些记录，因此您必须先创建一些接口。为此，您通常设置与连接表的关系，检查标志以创建记录，然后为该关系添加门户并输入一些数据。正如您设置它一样，它将按预期工作。例如，如果这是一个从 Instructor 到 Instructor-Training 表的入口，那么只要您在入口行中选择 Training ID（带有类似弹出菜单的东西），它就会自动填写 Instructor ID。

# java - Play 2.0 中具有泛型的自定义格式化程序

> ID：11369731
> 
> 赞同：3
> 
> 时间：2012-07-06T21:14:55.033
> 
> 标签：java, generics, data-binding, formatting, playframework-2.0

我想[注册](http://www.playframework.org/documentation/api/2.0.2/java/play/data/format/Formatters.html#register%28java.lang.Class,%20play.data.format.Formatters.AnnotationFormatter%29)一个自定义格式化程序来处理`Set<Integer>`.

显而易见的方式：

`Formatters.register(Set<Integer>.class, new AnnotationIntegerSetFormatter());`

导致“非法开始表达”。这样做的正确方法是什么，或者不可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T15:08:05.473

`Set<Integer>.class`不是合法的 Java，因为该类型的通用组件在编译时被删除。我认为 using`Set.class`应该可以工作，尽管这将为所有`Set<T>`类型注册您的处理程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T16:09:50.850

最终使用`Formatters.register(Set.class, new AnnotationIntegerSetFormatter());`; `parse`仍然可以返回`Set<Integer>`并`print`只需将其`Set`转换为`Set<Integer>`：

```
public class AnnotationIntegerSetFormatter extends Formatters.AnnotationFormatter<IntegerSet,Set> {
    @Override
    public Set<Integer> parse(IntegerSet annotation, String text, Locale locale) {
        Set<Integer> set = new TreeSet<Integer>();
        for (String part : text.split(","))
            set.add(Integer.parseInt(part));

        return set;
    }

    @Override
    public String print(IntegerSet annotation, Set value, Locale locale) {
        List<Integer> sorted = new ArrayList<Integer>();
        sorted.addAll((Set<Integer>) value);
        Collections.sort(sorted);

        return join(",", sorted.toArray());
    }

    private static String join(String separator, Object... values) {
        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < values.length; i++) {
            if (values[i] == null)
                continue;

            if (sb.length() > 0)
                sb.append(separator);

            sb.append(values[i].toString());
        }

        return sb.toString();
    }

} 
```

为了完整起见，我使用的注释：

```
@Target(ElementType.FIELD)
@Retention(RetentionPolicy.RUNTIME)
public @interface IntegerSet {
    int min() default Integer.MIN_VALUE;
    int max() default Integer.MAX_VALUE;
} 
```

由于这是基于注释的，因此您似乎可以为一个`Collection`类型注册多个格式化程序，并通过注释区分它们。

# excel - 如何将文本时间戳转换为 Excel 可以操作的内容？(Excel)

> ID：11369732
> 
> 赞同：0
> 
> 时间：2012-07-06T21:14:55.140
> 
> 标签：excel

我有一个带有此 TEXT 格式时间戳的数据文件：

```
June 11, 2012 3:47:56 PM GMT-07:00 
```

我需要进行计算，例如不同条目之间的时间差，所以显然我必须将时间戳重新格式化为 Excel 可以进行数学运算的东西。

理想情况下，我认为这种格式应该可以工作：

```
6/11/2012 3:47:56 PM 
```

...

这是我到目前为止所做的......使用 MID 结合 DATEVALUE 来获取日期（我的时间戳在单元格 A8 中）：

```
=datevalue(mid(a8, 1, find(",",a8)+5)) 
```

这导致显示：

```
11-Jun-12 
```

我现在可以计算天数的差异，但我的“客户”也想要数小时和数分钟的数据。

所以我想也许我可以使用 TIMEVALUE 和 MID 来解析同一时间戳的时间部分，但我不知道如何有效地正确计算 MID 的长度参数。时间戳的长度可以是 11 或 10 个字符，具体取决于显示的时间，因为它在上午 10 点之前的时间不使用前面的零

如果有更好或更简单的方法来翻译/重新格式化时间戳，我很想听听。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T21:20:36.333

假设总是有 AM 或 PM，则值为：

`=DATEVALUE(LEFT(A8,FIND("M",A8,2)))+TIMEVALUE(LEFT(A8,FIND("M",A8,2)))`

编辑以避免`May`and `March`，谢谢@barry

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T21:36:35.917

可以用这个版本，最后有空无所谓

`=LEFT(A8,FIND(",",A8)+17)+0`

格式化结果单元格以显示日期和时间

# python - Python JSON 模块没有属性“转储”

> ID：11369734
> 
> 赞同：40
> 
> 时间：2012-07-06T21:15:00.877
> 
> 标签：python, json, import, simplejson, attributeerror

我正在运行 Python 2.7 (x64 Linux) 并尝试将 a 转换`dict`为 JSON 对象。

```
>>> import sys
>>> sys.version_info
sys.version_info(major=2, minor=7, micro=0, releaselevel='final', serial=0) 
```

我正在尝试使用`simplejson`（从标准库回退`json`），但出现以下错误：

```
>>> try: import simplejson as json
... except ImportError: import json
...                  
>>> metadata = dict()
>>> metadata['foo'] = 'bar'
>>> print metadata
{'foo': 'bar'}
>>> json.dumps(metadata)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'module' object has no attribute 'dumps' 
```

`json`在使用 Python 2.7或`simplejson`与 Python 2.7 一起使用时，我有什么明显的遗漏吗？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-11-28T18:55:40.670

有类似的问题，它是由另一个自定义模块引起的。我命名了另一个脚本 `json.py`，结果它试图将自定义 json.py 文件作为模块加载。dumps 方法显然在那里不可用。

将 json.py 脚本重命名为其他内容（json2.py）可以解决这个问题。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-07-06T21:24:28.157

原来我`json`从旧的 Python 安装中加载了一个旧库：

```
>>> import json                                                                                                                                                                                                                                                                           
>>> print json.__file__                                                                                                                                                                                                                                                                   
/home/areynolds/opt/lib/python2.5/site-packages/json.pyc 
```

删除旧的东西解决了这个问题。谢谢！

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-07-06T21:19:03.907

您是否有一个名为`json`或`simplejson`在您的路径中不是这两个库之一的文件？如果你这样做了，那么 python 将加载该文件而不是真正的库。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-12-06T00:45:33.077

## 如何重现此 python 错误：

```
AttributeError: 'module' object has no attribute 'dumps' 
```

您可能创建了一个名为 json.py 的文件，该文件可从 python 的`sys.path`. 或者，您在 python 的 sys.path 中添加了一个目录，其中包含一个名为 json.py 的文件。

**选项 1：通过导入 json 来[毒化井](http://en.wikipedia.org/wiki/Variable_shadowing)，然后导入另一个具有相同别名的模块：**

```
eric@dev /var/www/sandbox/eric $ python

>>> import json

>>> json.dumps([])
'[]'

>>> import sys as json

>>> json.dumps([])

Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'module' object has no attribute 'dumps' 
```

**选项 2： 通过在 python 路径中创建一个名为 json.py 的文件来[毒化井：](http://en.wikipedia.org/wiki/Variable_shadowing)**

新建文件json.py，保存。把这段代码放在那里：

```
def foo():
  print "bar" 
```

打开python终端并导入json：

```
eric@dev /var/www/sandbox/eric/wsgi $ python
>>> import json

>>> type(json)
<type 'module'>

>>> json.dumps([])
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'module' object has no attribute 'dumps'

>>> json.foo()
bar 
```

**它告诉你你的方法不存在。所以请 python 告诉你更多关于这个模块的性质，你会找到关于谁中毒它的线索。**

```
>>> print json
<module 'json' from 'json.py'>
>>> dir(json)
['__builtins__', '__doc__', '__file__', '__name__', '__package__', 'foo']
>>> type(json)
<type 'module'> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-02-27T17:30:29.240

您的 Python 路径中可能有另一个名为“json”的脚本，这是您意外导入的。您可以通过重命名您控制下的或使用

```
from __future__ import absolute_import 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2020-04-07T17:32:56.543

我犯的错误我在收到错误时命名了文件名`json.py.` ：

> AttributeError：部分初始化的模块“json”没有属性“dumps”（很可能是由于循环导入）。

我将文件名重命名为，`json1.py`而不是创建新文件。

希望能帮助到你

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2021-03-10T16:13:47.410

我通过卸载我之前添加到项目中的 json_extension 库解决了同样的问题。

```
pip uninstall json_extensions 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-08-30T09:17:42.537

即使我在运行 json.dump() 时也遇到了类似的错误。就我而言，我收到了一个错误字符串：

AttributeError：“文件”对象没有属性“转储”

我是如何解决的-

我在同一个脚本中使用变量名作为文件描述符的“json”，这就是我收到此错误的原因。所以我只是重命名了该变量名并解决了问题。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-08-12T12:47:48.967

我已经在下面讨论了**问题**和**解决方案**

**问题：**当你在 python 上调用 import 函数时，python 会尝试在你的工作目录中找到该模块，如果在你的本地目录中没有找到，那么它将寻找标准库和其他全局 repos。因此，如果您尝试导入 json 模块，那么它会尝试在您的目录中找到它，如果您有一个名为“json.py”的文件，python 将加载该模块并尝试在您的 json 中找到“转储”函数.py。如果在文件中找不到“转储”功能，则会抛出错误“模块”对象没有属性“转储”。

**解决方案**：将您的“json.py”文件重命名为不同的名称：如 json_file.py 或除“json.py”以外的任何名称。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-11-20T14:04:23.620

这个错误只是在不同的上下文中发生在我身上，但仍然是名为 json.json 的两件事之一。我在 Django 中命名了一个“视图”（一个准备对 HTTP 请求的响应的 Python 函数），在本例中是一个处理 json 格式数据请求的视图。

但我已将视图命名为“json”。不好的举动。当 print dir(json) 在我的视图“json”中返回一个无转储响应时，我感到很困惑，而它在类似的视图中将“dumps”显示为一个属性。

这次讨论为我解决了这个问题。

# wpf - 为什么 textbox.focus 会抛出 lostfocus 事件？

> ID：11369738
> 
> 赞同：0
> 
> 时间：2012-07-06T21:15:20.150
> 
> 标签：wpf, vb.net

我在 SO 上看到了一些类似的问题，但似乎没有任何东西能真正解决这个问题。这是该函数的简化版本。

```
Private Sub Check_Quantity(sender As System.Object, e As System.Windows.RoutedEventArgs) _
    Handles textbox_quantity.LostFocus

        Dim worked As Boolean = Integer.TryParse(textbox_quantity.Text, quantity)

        If Not worked Then
            MsgBox("Enter a valid number for the quantity")
            textbox_quantity.Focus()
            textbox_quantity.SelectAll()
            quantity = 0
        End If
End Sub 
```

重要的是要注意这是 WPF。我想做的很简单。当有人完成文本框时，程序会检查他们输入的内容是否为数字。如果是这样，它会将其粘贴在一个整数中。如果没有，它会告诉他们修复它并将焦点放在文本框上。问题是一些事情，但归结为这个函数在无限循环中运行。同样的功能在 WinForms 中运行良好，但在 WPF 中却不行。

在其他一些问题上，人们说出现的消息框会导致焦点丢失，但在测试中这不是真的。不管消息框是否被调用，它仍然循环。问题是对 textbox_quantity.Focus() 的调用。没有它，它工作正常。不管它是否存在，焦点都没有设置到文本框，尽管 textbox_quantity.Focus() 仍然返回 true 值。有没有想过发生了什么，也许我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T09:13:13.987

问题是 focus() 是在您调用它时准确执行的...所以就在将焦点赋予另一个控件之前...因此循环...我发现的一种解决方法是推迟执行此类使用 System.Threading.ThreadPool.QueueUserWorkItem 的代码。但是由于必须从窗口线程调用 focus()，所以我还必须使用 Me.Dispatcher.Invoke。
所以结果有点复杂，但它有效！

```
 System.Threading.ThreadPool.QueueUserWorkItem(
                                  Sub()
                       Me.Dispatcher.Invoke(Sub()
                                                sender.Focus()
                                                sender.SelectAll()
                                            End Sub)
                                  End Sub) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:23:05.927

我会尝试在 SelectAll 调用之后移动 Focus，或者在其中添加一个 e.Handled = true 语句。

# java - 如何在休眠中获取具有不同 HQL 的 POJO 列表？

> ID：11369739
> 
> 赞同：0
> 
> 时间：2012-07-06T21:15:31.593
> 
> 标签：java, hibernate, hql, distinct, type-safety

我正在尝试使用休眠中的“不同”HQL 子句执行查询并获取列表。但是，每当我使用“ditinct”时，我都会得到一个 java 对象列表，而不是不使用“distinct”而返回的 POJO。有没有一种很好的方法来获取 pojos 而不是对象？

按预期返回 POJO 列表的示例：

```
class myPojos () { ... (has some properties/fields) propOne, propTwo, propThree ...} 
```

在 DAO 内部

```
Session s = HibernateUtil.currentSession();

List<myPojos> myPojoList = s
                .createQuery( "select from " getPojoClass().getName())
                .list(); 
```

但是，添加一个'distinct'子句

```
List<myPojos> myPojoList = s
                .createQuery( "select distcinct mpl.propOne, mpl.propTwo, mpl.propThree from " + getPojoClass().getName() + "mpl" )
                .list(); 
```

...而是返回一个对象列表。因此，我释放了 myPojos 类的所有 getter 和 setter，并释放了 type-safetey。

有没有办法做到这一点并获得一个列表来重新定义 getter/setteres 和 type-safey？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:23:18.207

您可以使用以下方法：`select p from Pojo p where p.id in (select distinct id from Pojo)`. 您正在子查询中执行 distinct，让主查询只选择已经唯一选择的 id。

# .net - .Net 4.0 应用程序无法与作为参考添加的 .Net 4.0 控件一起使用

> ID：11369742
> 
> 赞同：0
> 
> 时间：2012-07-06T21:15:48.067
> 
> 标签：.net, vb.net

我有一个我编写的 .Net 4.0 应用程序，它使用了一个我也编写的 .Net 4.0 控件。

我有两个 XP 系统。两者都安装了 .Net 4.0。该应用程序在两个 XP 系统上都崩溃，并在启动时显示应用程序遇到问题。在 Windows 7 上运行良好。

如果我只是删除引用我的控件的代码，应用程序仍然会崩溃。如果我完全删除引用，则应用程序启动正常。

因此，在其中一个系统上，我安装了 VS 2010 Basic Express 以在 XP 下编译应用程序。安装后，XP 编译的应用程序和原始的 Windows 7 编译的应用程序都可以正常运行，并且在安装了 VS 2010 Basic 的 PC 上安装了控件。但是在没有 VS 2010 的情况下，两者都不能在 XP 上运行。

所以看来VS2010装了什么东西，问题是什么？

关于应用程序的一些信息。

使用 .Net 4.0 符合 Win32

用 VS2010 VBASIC Express 编译

一点关于控制

用 VS2010 C++ Express 编译

使用 4.0 为 win32 编译

工具集平台 v100

一点关于.Net控件使用的静态库

用VS2010 C++Express编译

使用 4.0 为 win32 编译

工具集平台 v100

使用 STD 静态库。

难道是XP系统只需要安装Platform Toolset v100？我在哪里可以找到它？我到处搜索。

无论如何要知道那次崩溃的实际原因？

它实际上是 C++ 库的 .Net 包装器

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T00:49:24.480

我刚刚使用了我的控件的 .Net 2.0 版本，并在 2.0/ 下编译了应用程序，仍然对导致上述问题的原因感到好奇。

# windows-server-2008-r2 - 如何在 Windows 2008 R2 上注册 32 位 .DLL COM+ 应用程序

> ID：11369743
> 
> 赞同：4
> 
> 时间：2012-07-06T21:15:50.573
> 
> 标签：windows-server-2008-r2, com+, dcom, dllregistration

我已经阅读了所有类似的问题，但没有找到我的确切问题的答案。我已经尝试了所有类似的建议。

我被迫从 Windows Server 2003 环境迁移到运行 IIS 7.5 的 Windows Server 2008 R2 环境。我有一个在 32 位 DLL 中调用 COM 对象的 Web 应用程序。COM 对象是从 VB6 创建的。这是我迄今为止所做的：

1.  我在我的 IIS 应用程序池上启用了 32 位。
2.  我已经使用 C:/windows/syswow64/regsvr32.exe 注册了 .DLL 及其依赖的 .DLL - 注册成功。
3.  我已经使用 C:/windows/syswow64/regedit 在注册表中验证了 .DLL 及其组件
4.  我在组件服务中创建了一个 COM+ 对象（使用 syswow64/dcomcnfg）并启动了它们。
5.  我创建了一个角色“用户”并将组“每个人”添加到其中。

当我运行我的应用程序时，网页挂起。我可以在 COM 对象的日志文件中找到以下错误：

> ActiveX 组件无法创建对象错误：[429]：CDataAdministrator::OpenCatalog

我已经比较了新服务器和旧服务器之间的设置。我注意到的一件事是，在旧服务器上，DataAdministrator 对象 (DataAdministrator.CDataAdministrator) 列在 DCOM Config 的扩展下，但在新服务器上却没有。而且我似乎无法让它出现在那里。

我在事件历史记录或 IIS Web 日志中没有错误。在我看来，一切都已注册，但它不会运行。我可以在我指定的帐户下运行的任务管理器中看到一个 DLLHOST.EXE*32。

我在这里不知所措....帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T14:47:25.290

**在 64 位服务器上注册 32 位 COM 应用程序**

•开始...运行...C:\WINDOWS\SysWOW64\mmc comexp.msc /32

如此处所述[http://msdn.microsoft.com...dcomcnfg.exe_and_64-bit_applications](http://msdn.microsoft.com/en-us/library/ms678426%28VS.85%29.aspx#dcomcnfg.exe_and_64-bit_applications)

基本上这会运行 32 位版本的 dcomcnfg.exe，以便您可以在 64 位计算机上为您的 32 位应用程序设置 DCOM 设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:26:23.010

您是否仅针对 x86 编译过您的应用程序？

# tcp - 如何从 TCP 套接字获取 RSSI 和 SNR 值

> ID：11369747
> 
> 赞同：2
> 
> 时间：2012-07-06T21:16:16.763
> 
> 标签：tcp, network-programming

我正在使用 TCP 套接字在两台笔记本电脑（都运行 Ubuntu 12.04 ）之间进行通信。有没有办法以编程方式提取每个传入数据包的提取 RSSI 和 SNR 值，就像 radio-tap 一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T10:24:51.887

RSSI 和 SNR 属于较低层，取决于所使用的介质。TCP 没有关于它的信息。

其次，这些值用于点对点通信。TCP 连接将跨越不同的媒体，单个 RSSI / SNR 值没有意义。

这些链接可能会有所帮助：

*   [用于监控移动设备的 WiFi 管理工具](https://superuser.com/questions/217087/wifi-management-tool-to-monitor-a-mobile-device)
*   [从 WiFi 传感器读取 RSSI](https://stackoverflow.com/questions/7142485/to-read-rssi-from-wifi-sensor)

# ruby-on-rails - 为什么 Rails 输出我的数组？

> ID：11369751
> 
> 赞同：2
> 
> 时间：2012-07-06T21:16:38.870
> 
> 标签：ruby-on-rails, ruby

对rails很陌生。构建一个假设的小应用程序以在日历中显示员工的休假日。我正在尝试使用清单列出这些员工（以自定义输出），并且我得到了看起来是数组的东西，一旦循环结束就向我吐口水。不知道为什么——我不要求直接输出。当循环结束时，它似乎正在吐出。有什么帮助吗？

```
<%= @employees.each do |empl| %>
    <label><%= check_box 'employee','id',{:checked => 'checked' },empl.id %>
    <%= link_to empl.name, edit_employee_path(empl), :target => '_blank' %></label>
<% end unless @employees.empty? %>
<%= link_to 'Add Employee', new_employee_path %> 
```

这是输出：

```
<label><input name="employee[id]" type="hidden" value="0" /><input checked="checked" id="employee_id" name="employee[id]" type="checkbox" value="1" />
    <a href="/employees/1/edit" target="_blank">Test 1</a></label>
<label><input name="employee[id]" type="hidden" value="0" /><input checked="checked" id="employee_id" name="employee[id]" type="checkbox" value="2" />
    <a href="/employees/2/edit" target="_blank">Test</a></label>
[#&lt;Employee id: 1, name: &quot;Test 1&quot;, created_at: &quot;2012-07-06 19:58:03&quot;, updated_at: &quot;2012-07-06 19:59:55&quot;&gt;, #&lt;Employee id: 2, name: &quot;Test&quot;, created_at: &quot;2012-07-06 21:10:10&quot;, updated_at: &quot;2012-07-06 21:10:10&quot;&gt;]
<a href="/employees/new">Add Employee</a> 
```

从语义上讲，`unless`循环之后似乎不合适，但我的理解是，如果我想把它放在循环之前，我会在`end`之后添加一个额外的。这有关系吗？知道发生了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T21:19:09.807

更改`<%= @employees.each do |empl| %>`为`<%- @employees.each do |empl| %>`，它将停止输出列表。也就是说，将 更改`=`为`-`。使用`=`告诉 ERB 输出该命令的结果。当您调用时`each`，它会返回列表，以便列表得到输出。

至于你的`unless`，我认为实际上没有必要。如果列表是，`empty?`那么 each 将只返回而不实际执行任何重复，因此循环内的代码将永远不会被调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T23:36:36.327

在 ERB 中，简单地删除`=`就足够了。

```
<% Ruby code -- inline with output %>
<%= Ruby expression -- replace with result %>
<%# comment -- ignored -- useful in testing %>
%% replaced with % if first thing on a line and % processing is used
<%% or %%> -- replace with <% or %> respectively 
```

# sharepoint-2010 - 使用客户端对象模型 Sharepoint 2010 填充 Treeview

> ID：11369755
> 
> 赞同：0
> 
> 时间：2012-07-06T21:17:08.497
> 
> 标签：sharepoint-2010, wcf-client, sharepoint-designer, sharepoint-clientobject

我有一个文档库。在文档库中，我有一个名为 Studies 的文件夹。在研究中，我有 10 个文件夹和后续的子文件夹。

我需要使用客户端对象模型 SharePoint 2010 在树视图中填充相同内容。

```
DocLibrary1>>Studies>>Study1- Folder1
                             -Folder2
                             -Folder3 
```

我想在一个函数中的树视图中发布它，我可以在其中传递文档库并返回树视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T10:27:54.260

The Following code will Display all Libraries and Folders of each Library

```
private void frmForm1_Load(object sender, EventArgs e)
{
    using (ClientContext clientcontext= new ClientContext("http://your server"))
    {

        //Load Libraries from SharePoint
        clientcontext.Load(clientcontext.Web.Lists);
        clientcontext.ExecuteQuery();
        foreach (List list in clientcontext.Web.Lists)
        {
           try
           {
                if (list.BaseType.ToString() == "DocumentLibrary" && !list.IsApplicationList && !list.Hidden && list.Title != "Form Templates" && list.Title != "Customized Reports" && list.Title != "Site Collection Documents" && list.Title != "Site Collection Images" && list.Title != "Images")
                {
                    clientcontext.Load(list);
                    clientcontext.ExecuteQuery();
                    clientcontext.Load(list.RootFolder);
                    clientcontext.Load(list.RootFolder.Folders);
                    clientcontext.ExecuteQuery();
                    TreeViewLibraries.ShowLines = true;
                    TreeNode LibraryNode = new TreeNode(list.Title);
                    TreeViewLibraries.Nodes.Add(LibraryNode);
                        foreach (Folder SubFolder in list.RootFolder.Folders)
                        {
                            if (SubFolder.Name != "Forms")
                            {
                                TreeNode MainNode = new TreeNode(SubFolder.Name);
                                LibraryNode.Nodes.Add(MainNode);
                                FillTreeViewNodes(SubFolder, MainNode, clientcontext);
                            }
                        }

                }
            }

        }
    }
}

//Recursive Function

public void FillTreeViewNodes(Folder SubFolder, TreeNode MainNode, ClientContext clientcontext)
{
    clientcontext.Load(SubFolder.Folders);
    clientcontext.ExecuteQuery();
        foreach (Folder Fol in SubFolder.Folders)
        {
            TreeNode SubNode = new TreeNode(Fol.Name);
            MainNode.Nodes.Add(SubNode);
            FillTreeViewNodes(Fol, SubNode, clientcontext);
        }
} 
```

you can modify the code as per your requirement :-)

# android - 带有 Runnable 的计时器不起作用

> ID：11369756
> 
> 赞同：1
> 
> 时间：2012-07-06T21:17:18.597
> 
> 标签：android, runnable, chronometer

您好，我为我的游戏创建了一个计时器。问题是我在 2 个类中创建。这不起作用。我有一个例外。

```
 public class Crono1 extends Activity implements Callback{

public TextView txtTiempo;
public boolean detenido;
public boolean pausado;
private Handler handler;
String cronometro;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    txtTiempo = (TextView) findViewById(R.id.ConTiempo);
    final Button btn = (Button) findViewById(R.id.BtnAccion);
    final Button btnDetener = (Button) findViewById(R.id.BtnDetener);
    detenido = false;
    pausado = true;
    handler = new Handler(this);

    btn.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub

            Tiempo w = new Tiempo (handler);
            Thread t = new Thread (w);
            t.start();
        }
    });

    btnDetener.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            detenido = true;
            txtTiempo.setText("00:00:00:00");
        }
    });
}
@Override
public boolean handleMessage(Message msg) {
  TextView texto = (TextView) findViewById(R.id.ConTiempo);

  Integer text = (Integer) msg.obj;
    texto.setText(text+"");
    Log.d("ENTRO",msg.obj.toString());
    return true; 
} 
```

* * *

```
 public class Time implements Runnable{
public TextView txtTiempo;
public boolean detenido;
public boolean pausado;
int centesimas = 00,minutos=00, segundos=00, horas=00;
String cronometro;
private Handler handler;

public Time (Handler handler){
    this.handler = handler;
 }

@Override
public void run (){
    while(!detenido)
    {
        while(!pausado)
        {
            try {
                //if(centesimas == 99){
                    //centesimas = 00;
                    segundos++;
                //}
                if (segundos == 59) {
                    segundos = 00;
                    minutos++;
                }
                if (minutos == 59) {
                    minutos = 00;
                    //horas++;
                }
                centesimas++;
                //cronometro = /*horas + ":" +*/ minutos + ":" + segundos /*+ ":" + centesimas*/;
                sendMsg (minutos + ":" + segundos);
                handler.sendEmptyMessage(0);
                Thread.sleep(900);
            } catch (Exception ex) {
                ex.printStackTrace();
            }

        } 
```

}

```
private void sendMsg(String string)
{
    Message message = new Message ();
    message.obj = string;
    handler.sendMessage(message);
} 
```

**Exepction 是 "Unchaught handler" 和 "ClassCastExeption"**。我的错误是什么？以及如何做：如果时间是 1:50，完成应用程序或使用 Intent？

# sql - Postgres 不接受列名之前的表别名

> ID：11369757
> 
> 赞同：37
> 
> 时间：2012-07-06T21:17:19.943
> 
> 标签：sql, postgresql, jodd

我正在使用一个框架 (Jodd)，它将表别名添加到 SQL Select 中的列名中。它看起来像格式良好的 SQL，但 Postgres 对此感到窒息。

```
update GREETING Greeting 
     set Greeting.ID=5, 
         Greeting.NAME='World', 
         Greeting.PHRASE='Hello World!'  
where (Greeting.ID=5) 
```

给出一个错误：

```
Error: ERROR: column "greeting" of relation "greeting" does not exist
SQLState:  42703 
```

有没有办法让 Postgres 接受那个 SQL？我的另一种选择是破解框架，我不想这样做。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-07-06T21:51:53.737

问题是您`SET`在列中包含表别名 in 子句。请参阅[`UPDATE`Postgres 文档中的文档](http://www.postgresql.org/docs/9.1/static/sql-update.html)：

> *`column`*
> 
> 中的列的名称*`table`*。如果需要，列名可以用子字段名或数组下标限定。不要在目标列的规范中包含表的名称——例如，**`UPDATE tab SET tab.col = 1`**是无效的。

这在 Postgres 中有效：

```
update GREETING Greeting 
set 
    NAME='World', 
    PHRASE='Hello World!' 
where Greeting.ID=5 ; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-06T21:54:36.497

检查[`UPDATE`](http://www.postgresql.org/docs/current/interactive/sql-update.html)语句文档，特别是***列***部分：在`SET`子句中使用表别名作为列前缀是非法的。

```
UPDATE GREETING Greeting
   SET ID=5, NAME='World', PHRASE='Hello World!'
 WHERE (Greeting.ID=5); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-27T23:07:10.973

尝试使用最新的 Jodd v3.3.7。解决此问题的地方。

问题出在 Jodd 库中：实体更新方法正在生成带有表别名的更新语句。新版本根本不放表别名；这也适用于 Postgres 和其他数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-08T09:52:53.627

正如其他人所说，postgres 为正在更新的列的名称使用别名是非法的，但请注意，在 rhs 表达式中使用别名是可能的（有时是必要的）。例如：

```
CREATE TABLE greetings (name VARCHAR(20), phrase VARCHAR(100));
INSERT INTO greetings (name, phrase);
VALUES ('palindrome_1', 'Rise to vote sir'),
       ('palindrome_2', 'Race fast, safe car');

-- You can do something like this:
UPDATE greetings g SET phrase = REVERSE (g.phrase);
                                      -- ^
                                      -- |
                                      -- +--- this works 
```

在这个例子中这有点傻，因为我们不需要那个别名。当涉及多个表时，这变得更加有用。

# android - Relativelayout 中的 ImageView 重叠。我想将较低的 imageView 放在顶部

> ID：11369759
> 
> 赞同：1
> 
> 时间：2012-07-06T21:17:35.217
> 
> 标签：android

我在 relativeLayout 中有两个 imageViews 一个在另一个之上。假设 iv1 位于 iv2 之上。用户看不到 iv2，因为它与 iv1 重叠。现在我希望 iv2 位于 iv1 之上，以便 iv1 完全被 iv2 覆盖并且看不到。我想通过使用代码来做到这一点。

例子---- 你从一副牌的底部挑选了一张牌并将它放在牌的顶部。

先生，我有另一个位于 _imageView 之上的 _imageView2

```
public void AnimFunction() {

    TranslateAnimation animation2 = new TranslateAnimation(0, -50, 0, 0);
    animation2.setDuration(100); // duration in ms
    animation2.setRepeatCount(1);
    animation2.setRepeatMode(Animation.REVERSE);
    animation2.setFillAfter(false);
    _imageView.startAnimation(animation2);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:20:24.570

您可以使用可见性来实现这一点，这样的事情应该可以工作：

```
iv1.setVisibility(View.GONE);
iv2.setVisibility(View.VISIBLE); 
```

# c# - For Loop SKIPPING Last Iteration in VB (baffled) Code Included, Tested, still not working

> ID：11369761
> 
> 赞同：-4
> 
> 时间：2012-07-06T21:17:48.543
> 
> 标签：c#, vb.net, vba, vb6, vbscript

这是一个简单的例子：

```
Dim si As Single
For si = 2.6 To 3.3 Step 0.1
  MsgBox si
Next si 
```

我得到的数字如下（它们显示在 MsgBox 中，如下所示）：

```
2.6
2.7
2.8
2.9
3
3.099999
3.199999
3.299999 
```

所以，我想我会将数据类型从 Single 更改为 Double 看看会发生什么。这一次，没有 .099999 类型编号，但最后一项（迭代）被跳过，如中，缺失，不存在。以下是出现在 MsgBox 显示中的结果）：

```
2.6
2.7
2.8
2.9
3
3.1
3.2 
```

我猜在缺少最后一次迭代的情况下，它会像 .299999 一样跟踪它，并且在自己的脑海中永远不会达到 .3，所以跳过它？但是，这样做的问题是，如果发生这种情况，您会得到一个先前的迭代出现两次才能发生这种情况，就像在单一数据类型示例中所做的那样，如果您在第一个小数，你会注意到 3.0 出现了两次。首先是“3”，然后是“3.0”（如果我们忽略/截断“3.0”部分之后出现的 5 次数字 9 - “3.099999”）。

有趣的是，另一个我使用单数据类型循环的函数显示了我们上面的双数据类型示例所存在的确切问题，而我们上面的单数据类型示例没有任何问题。所以，我在这里的真正原因是我的单一数据类型循环丢失并在使用“步骤 0.1”时跳过了最后一项（递增 0.1）。

有没有一种可靠的方法可以使用“Step 0.1”和非整数数据类型来做到这一点？如果不是，我们是否知道这些混乱事物发生的规则（也就是说，混乱是可预测的）？*叹*

我想你们都会觉得这很有趣，我当然很期待理解它。搜索谷歌是没有用的，因为我一输入“for”和“step”的工作，就不断地提出如何使用 step 运算符的示例，没有任何用处。

我很想知道如何忍受这种情况，或者安全地做到这一点，和/或首先为什么会发生这种情况。我宁愿不为这个特定的函数使用整数循环（然后使用另一个变量进行划分以获得我的十进制类型），但是如果我必须这样做并且没有可靠的方法可以做到这一点，我会的。但我把这个留给你们，我的程序员霸主。

我的例子发生在 VB6 中，但是，我也想知道在 VB.NET 甚至 C# 中是否也发生了同样的混乱？我假设它发生在 vba 和 vbscript 中。任何有关这方面的信息也会很有趣并受到赞赏。

先感谢您。

**致版主（问题不需要阅读）：**这不是重复的帖子，可能有其他人用其他语言（例如 C#）发布浮点问题，但这个（VB6）问题的解决方案不一定是与 C# 问题的解决方案相同。可能有一些相同的解决方案，但也会有不同的解决方案，我无法从 C# 帖子中获得不同的解决方案/答案。事实证明，我感兴趣的解决方案是一个特定于 VB6 的解决方案，在引用的 C# 帖子中找不到该解决方案。我敦促模组在尝试关闭帖子之前要勤奋，我看到*许多帖子被不公平地关闭*有时，在一天结束时，您会进入一个阶段，您不会增加任何价值，而是从本网站的 Q 和 A 风格中删除实质性价值。总之，如果一个类似的帖子甚至有可能提供新的信息/答案或解决方案，你最好不要关闭。特别是如果问题是针对不同语言的，即使概念相似或相同，也必然会有不同的解决方案和特定于语言的解决方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-06T21:50:56.380

问题归结为浮点数在内存中的表示方式。许多其他人发布了有关了解浮点数表示方式的良好参考资料的链接。

当您尝试使用双精度而不是单精度时，数字增量如下 - 必须使用调试器逐步获取值，因为`ToString`不会输出值的完整精度。

```
2.6
2.7
2.8000000000000003
2.9000000000000004
3.0000000000000004
3.1000000000000005
3.2000000000000006
3.3000000000000007 
```

如您所见，最终值略高于 for 循环的结尾，因此被跳过。

通过使用整数，您可以避免 for 循环中的浮点问题，但您需要在每次迭代时将数字除以 10 以获得要打印的值。

```
Dim i As Integer
For i = 26 To 33 Step 1
        MsgBox(i / 10)
Next 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T21:24:42.520

尝试使用小数代替精度：

```
For i As Decimal = 2.6 To 3.3 Step 0.1
  MessageBox.Show(i.ToString)
Next 
```

如果使用 VB6，您可以尝试使用 Currency 类型（如 JeffSiver 所述）：

```
Dim i As Currency
For i = 2.6 To 3.3 Step 0.1
  MsgBox i
Next 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-06T21:29:03.850

我乘以 10 并为循环使用整数。即使使用`decimal`我认为您可能会遇到相同类型的问题

# excel - 当我打开工作簿时，Workbook_Open sub 不会运行？

> ID：11369762
> 
> 赞同：21
> 
> 时间：2012-07-06T21:18:00.850
> 
> 标签：excel, vba

该程序应该创建一个按钮，用户可以按下该按钮来激活不同的 sub。从我在网上的搜索来看，打开工作簿时似乎应该激活下面的子，但不是吗？

我究竟做错了什么？

```
Option Explicit
Private Sub Workbook_Open()
Dim btn As Button
Dim rng As Range
With Worksheets("Sheet1")
    Set rng = .Range("B2:C2")
        Set btn = .Buttons.Add(rng.Left, rng.Top, rng.Width, rng.Height)
    With btn
        .Caption = "To begin the program, please click this button"
        .AutoSize = True
        .OnAction = "TableCreation1"
    End With
End With
End Sub 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-07-08T21:23:15.003

确保将**Private Sub Workbook_Open()**子例程粘贴到**This Workbook**对象中，而不是粘贴到 Module、Form 或 Sheet 对象中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-12-02T13:34:08.187

有趣的。在 2009 年，描述了与要打开的工作表的条件格式的冲突，如 [vbforum post](http://www.vbforums.com/showthread.php?555092-RESOLVED-Workbook_Open-event-won-t-run&s=237c4345d8c14bcd1d9cf5204b75005d&p=3431224&viewfull=1#post3431224 "论坛")中所示。

似乎这个错误仍然存​​在于 excel 中并阻止`workbook_open`事件被触发。我有一个工作簿（旧的 XLS 二进制格式），它根本不会在 Excel 2003 和 2007 中触发事件，但在 2013 年会触发。我从第一个工作表中删除了所有条件格式，但仍然无法`workbook_open`在旧 Excel 中运行该过程-版本。

我在分布式工作簿中使用的一种解决方法是在工作簿中使用局部变量和第二个事件，如下所示：

```
''
' private variable
Private wbOpenEventRun as Boolean

''
' procedure to be called by excel when workbook opens
Private Sub Workbook_Open()
    wbOpenEventRun = true
    ' perform tasks
End Sub

''
' the selection change event fires usually.
' performance is not reduced
Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)
    If Not wbOpenEventRun Then Workbook_Open
    ' perform tasks in reaction of selection change events, if required
End Sub 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-08-23T12:31:04.287

我找到的解决方案是运行以​​下代码，然后“打开”事件起作用。

```
Sub EventRestore()

    Application.EnableEvents = True

End Sub 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-10-04T03:37:13.843

我知道这篇文章已经休眠了一段时间，但我只是挣扎了几个小时来解决这个问题。这是最奇怪的事情，但我终于注意到我的一个工作表在“页面视图”中......一旦我把它放到“正常”中，我的 Workbook_Open() 函数又开始正常工作了。非常奇怪 - 绝对是一个 Excel 错误......很高兴我终于解决了它......希望它可以帮助某人......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-01T15:45:33.683

我的解决方案有点晦涩难懂，现在我什至不记得为什么我想到它是一个潜在的解决方案。我创建的 Workbook_Open() 宏无法运行的文件，最初是通过以下步骤创建的：

1.  右键单击相关文件夹，单击**New**，单击**Microsoft Excel Worksheet**。
2.  将文件命名为“ **Workbook_1** ”。
3.  打开**Workbook_1**。
4.  文件，另存为，将文件类型更改为**Excel 启用宏的工作簿 (*.xlsm)**，保存。
5.  编写了包含嵌套在**ThisWorkbook中的****Workbook_Open()**的 VBA 代码。

 **无论出于何种原因，我想知道我的问题是否与文件“作为”标准**.xlsx**的事实有关。所以我简单地说：

1.  在 Excel ( **Book1** ) 中打开了一个新的空白工作簿。
2.  文件，另存为，输入**Workbook_2**，将文件类型更改为**Excel 启用宏的工作簿 (*.xlsm)**，保存。
3.  从原始**Workbook_1**复制 VBA 代码和结构。

与原来的**Workbook_1**不同，新的**Workbook_2**在打开时成功运行了**Workbook_Open()**子。也许这个问题的一个潜在原因与文件的类型历史有关（即，如果它在某些时候是不能运行宏的类型）。或者，也许只是用新文件再次尝试为我解决了这个问题。无论哪种方式，这可能适用于其他解决方案没有的任何人。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-01-21T08:50:57.700

类似于[通过代码解决方案启用Nazim 的事件，](https://stackoverflow.com/a/45839807/1915920)我发现了以下修复：

# 修复

**关闭所有 excel 工作簿和 VBA 窗口并重新打开已`Workbook_Open()`**解决的那个。
（可能是由于启用类似于上面链接的 Nazim 解决方案的事件）。

# 问题经历

在调试和中止执行时，我在中止之前禁用了正在运行的代码中的事件。起初我没有注意到这种情况，即使在关闭/重新打开我的工作簿之后它也不起作用......

# 可能的原因

...其他打开的 excel 工作簿或某些全局实例以某种方式“记住”了重新打开的工作簿的事件已被关闭。**

# android - 将 STL 链接到独立的 Android NDK 可执行文件

> ID：11369763
> 
> 赞同：12
> 
> 时间：2012-07-06T21:18:09.583
> 
> 标签：android, c++, stl, android-ndk

以下代码在打印字符串后导致分段错误：

```
#include <iostream>
using namespace std;

int main()
{
    cout << "ndktest" << endl;
    return 0;
} 
```

*   如果我将 cout 更改为 printf，它不会崩溃。
*   如果我在 main 以外的其他函数中调用 cout，并且该函数从未被访问过，它仍然会崩溃。
*   它在 Froyo 上崩溃，但不是 ICS。

作为参考，这是我的 Android.mk：

```
LOCAL_PATH:= $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE := ndktest
LOCAL_SRC_FILES := main.cpp

include $(BUILD_EXECUTABLE) 
```

和 Application.mk：

```
APP_STL := stlport_static 
```

这是来自 logcat 的崩溃：

```
I/DEBUG   (  872): pid: 4234, tid: 4234  >>> /data/ndktest <<<
I/DEBUG   (  872): signal 11 (SIGSEGV), fault addr 00024004
I/DEBUG   (  872):  r0 00033824  r1 00001000  r2 00024005  r3 bea42cfc
I/DEBUG   (  872):  r4 40008090  r5 0000000a  r6 40008000  r7 afd42328
I/DEBUG   (  872):  r8 00000000  r9 00000000  10 00000000  fp 00000000
I/DEBUG   (  872):  ip 40008084  sp bea42ce8  lr afd192dd  pc 00024004  cpsr 60000030
I/DEBUG   (  872):  d0  0000000000000000  d1  0000000000000000
I/DEBUG   (  872):  d2  0000000000000000  d3  0000000000000000
I/DEBUG   (  872):  d4  0000000000000000  d5  0000000000000000
I/DEBUG   (  872):  d6  0000000000000000  d7  0000000000000000
I/DEBUG   (  872):  d8  0000000000000000  d9  0000000000000000
I/DEBUG   (  872):  d10 0000000000000000  d11 0000000000000000
I/DEBUG   (  872):  d12 0000000000000000  d13 0000000000000000
I/DEBUG   (  872):  d14 0000000000000000  d15 0000000000000000
I/DEBUG   (  872):  scr 00000000
I/DEBUG   (  872): 
I/DEBUG   (  872):          #00  pc 00024004  
I/DEBUG   (  872):          #01  pc 000192da  /system/lib/libc.so
I/DEBUG   (  872):          #02  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #03  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #04  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #05  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #06  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #07  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #08  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #09  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #10  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #11  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #12  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #13  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #14  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #15  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #16  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #17  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #18  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #19  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #20  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #21  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #22  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #23  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #24  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #25  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #26  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #27  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #28  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #29  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #30  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872):          #31  pc 0001972c  /system/lib/libc.so
I/DEBUG   (  872): 
I/DEBUG   (  872): code around pc:
I/DEBUG   (  872): 00023fe4 ffffffff ffffffff ffffffff ffffffff 
I/DEBUG   (  872): 00023ff4 ffffffff ffffffff ffffffff ffffffff 
I/DEBUG   (  872): 00024004 ffffffff ffffffff ffffffff ffffffff 
I/DEBUG   (  872): 00024014 ffffffff ffffffff ffffffff ffffffff 
I/DEBUG   (  872): 00024024 ffffffff ffffffff ffffffff ffffffff 
I/DEBUG   (  872): 
I/DEBUG   (  872): code around lr:
I/DEBUG   (  872): afd192bc f8cde018 f7f4e00c b930ec56 0c0cf844 
I/DEBUG   (  872): afd192cc 46302201 f7f49900 9803ec4e 47909a05 
I/DEBUG   (  872): afd192dc f1153c0c d5d735ff 2e006836 463cd1ce 
I/DEBUG   (  872): afd192ec b9b99901 c03cf8df 300cf857 f8471e58 
I/DEBUG   (  872): afd192fc b978000c 587a490c e0046810 68059900 
I/DEBUG   (  872): 
I/DEBUG   (  872): stack:
I/DEBUG   (  872):     bea42ca8  b000c9b8  
I/DEBUG   (  872):     bea42cac  00000014  
I/DEBUG   (  872):     bea42cb0  b00093e0  /system/bin/linker
I/DEBUG   (  872):     bea42cb4  b001e9b8  
I/DEBUG   (  872):     bea42cb8  b000c9b8  
I/DEBUG   (  872):     bea42cbc  b0001c78  /system/bin/linker
I/DEBUG   (  872):     bea42cc0  b001e724  
I/DEBUG   (  872):     bea42cc4  00000005  
I/DEBUG   (  872):     bea42cc8  b000c9b8  
I/DEBUG   (  872):     bea42ccc  b0001de3  /system/bin/linker
I/DEBUG   (  872):     bea42cd0  b000c9b8  
I/DEBUG   (  872):     bea42cd4  b0002c77  /system/bin/linker
I/DEBUG   (  872):     bea42cd8  00000000  
I/DEBUG   (  872):     bea42cdc  b001ffe8  
I/DEBUG   (  872):     bea42ce0  df002777  
I/DEBUG   (  872):     bea42ce4  e3a070ad  
I/DEBUG   (  872): #01 bea42ce8  00001000  
I/DEBUG   (  872):     bea42cec  00000000  
I/DEBUG   (  872):     bea42cf0  bea42cfc  
I/DEBUG   (  872):     bea42cf4  00033824  
I/DEBUG   (  872):     bea42cf8  00000000  
I/DEBUG   (  872):     bea42cfc  00024005  
I/DEBUG   (  872):     bea42d00  00033824  
I/DEBUG   (  872):     bea42d04  00000000  
I/DEBUG   (  872):     bea42d08  00000000  
I/DEBUG   (  872):     bea42d0c  00000000  
I/DEBUG   (  872):     bea42d10  b000c9b8  
I/DEBUG   (  872):     bea42d14  00000000  
I/DEBUG   (  872):     bea42d18  00000000  
I/DEBUG   (  872):     bea42d1c  afd19731  /system/lib/libc.so
I/BootReceiver(  946): Copying /data/tombstones/tombstone_09 to DropBox (SYSTEM_TOMBSTONE) 
```

通过堆栈跟踪工具运行它并没有产生任何符号信息。

**更新：**

崩溃转储中的 pc 值（/system/lib/libc.so 中的 0001972c）在退出例程中，这与打印字符串后崩溃一致：

```
00019728 <exit>:
   19728:   4604        mov r4, r0
   1972a:   2000        movs    r0, #0
   1972c:   f7ff fd8c   bl  19248 <__cxa_finalize>
   19730:   4620        mov r0, r4
   19732:   f7f3 ee96   blx d460 <_exit>
   19736:   bf00        nop 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-09T15:47:53.250

这可能是因为您使用 stlport_static 而不是 stlport_shared。

在 NDK 文档（包中包含 CPLUSPLUS-SUPPORT.html）中，描述了这种行为。这种不可预测的行为源于这样一个事实，即如果应用程序链接到两个（或更多）共享库，并且都链接到 stlport_static，则某些符号可能会重复，从而导致不正确的行为。

# html - 页眉和页脚之间 100% 的内容

> ID：11369764
> 
> 赞同：15
> 
> 时间：2012-07-06T21:18:10.223
> 
> 标签：html, css, flexbox

假设我有以下布局（见下图）......我有一个顶部的标题（A），底部的页脚（C）和中间的容器（B）应该填充页眉和页脚之间留有 100% 的空间。

![在此处输入图像描述](../Images/d7922d0595538cfd9d0c30afafdcbadc.png)

想不出任何方法如何使用纯 css 来实现这一点。任何想法，将不胜感激！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-06T21:30:14.583

您的问题几乎描述了标准块级元素（例如 DIV）的行为方式。中心 div 将始终占据两者之间 100% 的空间，并且会根据其内部内容而增长。

也就是说，我假设您想要一个 FIXED 页脚 - 一个位于浏览器窗口底部的页脚。这可以通过多种技术实现，其中之一是使用绝对定位：

```
<div id="header">Header</div> 
<div id="content">Main Content</div> 
<div id="footer">Footer</div> 
```

风格：

```
#header, #footer, #content { position: absolute; left: 0; width: 100%; }
#header, #footer { overflow: hidden; background: #444; height: 100px; }
#header { top: 0; }
#content { top: 100px; bottom: 100px; overflow: auto; background: #CCC; }
#footer { bottom: 0; }​ 
```

[http://jsfiddle.net/U9wfy/](http://jsfiddle.net/U9wfy/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-06T21:26:47.003

根据您的页面的设置方式，如果您设置`height: 100%;`(B) 和`position: absolute;`容器元素，它可能会起作用。这是一个例子：

**HTML：**

```
<div id="container">
    <div id="header"></div>
    <div id="body"></div>
    <div id="footer"></div>
</div>​ 
```

**CSS：**

```
#container {
    height: 100%;
    width: 100%;
    background: green;
    position: absolute;
}
#header, #footer {
    height: 100px;
    width: 100%;
    background: red;
}
#body {
    height: 100%;
    width: 100%;
    background: blue;
}​ 
```

[jsFiddle](http://jsfiddle.net/UZDbb/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-02-08T13:35:08.243

我遇到了这个问题，并认为更“现代”的答案会有所帮助。这种布局很容易使用**flexbox** ..

[https://www.codeply.com/go/1QgRb4uFmj](https://www.codeply.com/go/1QgRb4uFmj)

```
<header>
</header>
<main></main>
<footer>
</footer>

html, body {
  margin: 0;
  height: 100%;
}

body {
  display: flex;
  flex-direction: column;
}

header,
footer {
  flex: none;
  background: #ddd;
}

main {
  overflow-y: scroll;
  flex: auto;
} 
```

# ffmpeg - ffmpeg 语法已更改

> ID：11369766
> 
> 赞同：0
> 
> 时间：2012-07-06T21:18:25.483
> 
> 标签：ffmpeg, ubuntu-12.04, libx264

就像这篇文章中谈到的那样：[FFmpeg 无法识别预设，即使它确实存在 Ubuntu 12.04](https://stackoverflow.com/questions/10836888/ffmpeg-cannot-recognize-a-preset-even-though-it-does-exsist-ubuntu-12-04)

我有帮助，**deblockalpha**已经从 ffmpeg 贬值了很长时间，我对所有这些编码业务都不好，但希望有人告诉我如何修复这个过时的语法，因为我收到了这个错误：

*无法识别的选项“deblockalpha”无法为选项“deblockalpha”设置值“0”*

请参阅下面的代码并提供建议？

```
$ffmpeg -i $input -r 30 -vcodec libx264 -s 512x288 -aspect 16:9 -b 1550k -maxrate 1800k -bufsize 4M -bt 1600k -flags +loop -cmp +chroma -deblockalpha 0 -deblockbeta 0 -refs 1 -coder 0 -me_method full -me_range 16 -subq 5 -partitions +parti4x4+parti8x8+partp8x8 -g 250 -keyint_min 25 -level 30 -trellis 2 -sc_threshold 40 -i_qfactor 0.71 -acodec libfaac -ab 128k -ar 44100 -ac 2 $addpre $output"; 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-08T10:49:41.430

替换`-deblockalpha 0 -deblockbeta 0`为`-deblock 0:0`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T23:17:22.760

`-deblockalpha 0`从您的命令中删除。

# powershell - Powershell：无效的正则表达式

> ID：11369768
> 
> 赞同：1
> 
> 时间：2012-07-06T21:18:34.153
> 
> 标签：powershell, file-io, windows-xp

从[这篇](https://stackoverflow.com/questions/11368786/powershell-recursively-replace-string-in-select-sub-files-of-a-directory)文章中，我设法在 Windows XP 上用 Powershell 替换了目录子文件中的字符串。

```
foreach ($f in gci -r -include "*.bat") 
    { (gc $f.fullname) |
       foreach { $_ -replace "D:","C:\path" }  |
       sc $f.fullname 
    } 
```

不幸的是，一些例外情况需要“C:\\”而不是“C:\”。

我尝试使用以下命令来解决此问题（将“C:\path\\”替换为“C:\\path\\”），但它失败了：

```
foreach ($f in gci -r -include "*.bat") 
    { (gc $f.fullname) |
       foreach { $_ -replace "C\path\\","C:\\path\\" }  |
       sc $f.fullname 
    } 
```

错误是：

```
Invalid regular expression pattern: C:\path\\ 
```

我尝试了几种变体来规避该问题，但都产生相同的错误（替换上面的第 3 行）：

```
foreach { $_ -replace "C:\path\\\\","C:\\path\\" } |
foreach { $_ -replace 'C:\path\\',"C:\\path\\" } |
foreach { $_ -replace "`C:\path\\","C:\\path\\" } |
foreach { $_ -replace 'C:\path\\\\',"C:\\path\\" } | 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T21:27:17.220

用“C:\\path\\”替换“C:\path\”

采用

```
$_ -replace "c:\\path\\\\","c:\\path\\" 
```

匹配模式是正则表达式，“\”需要用“\”转义。替换字符串只是一个字符串，不需要转义字符

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-01T02:19:04.543

或者，您可以[使用字符串类的 Replace() 方法](http://itknowledgeexchange.techtarget.com/powershell/string-replacement/)：

> ```
> PS> $folder = "C:\FolderName\NextFolder\ThirdFolder"
> PS> $newfolder = $folder.Replace("C:\FolderName\", "D:\")
> PS> $newfolder
> D:\NextFolder\ThirdFolder 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-27T20:03:22.360

只是为了详细说明 CB 所说的内容，当替换字符串中的“\”时，您必须在字符串的“查找”部分中将它们转义。最简单的方法如下

```
$escapedPath = $path -replace "\\","\\" 
```

或澄清：

```
$escapedPath = $path -replace [RegEx]"\\",[String]"\\" 
```

因为 -replace 中的第一个参数是一个正则表达式，所以它对“\”的处理与后半部分不同，后者是一个字符串数据类型。

# html - 更改嵌入对象的字体大小

> ID：11369770
> 
> 赞同：1
> 
> 时间：2012-07-06T21:18:40.133
> 
> 标签：html, dreamweaver

我有一个嵌入文本文件的网页。文本文件被命名为“Broadcast.txt”，它的顶行有 .LOG 用于在每次打开时输入时间戳。除此之外没有其他特殊功能。我找不到如何更改嵌入对象的显示字体。我在 Dreamweaver 中寻找任何可以让我们显示更大字体的设置，但无济于事。这是我拥有的代码片段：我尝试将字体更改为 42pt，但它仍然有效。我尝试更改 CSS 中的设置，它仍然不会影响对显示的小字体的更改。有任何想法吗？

```
<div class="container">
  <div class="header"><a href="#"><img src="" alt="Insert Logo Here" name="Insert_logo" width="180" height="90" id="Insert_logo" style="background: #C6D580; display:block;" /></a> 
    <!-- end .header --></div>
  <div class="content">
    <h1>&nbsp;</h1>
<h2>&nbsp;</h2>
    <p>  <OBJECT DATA="Broadcast.txt" TYPE="text/html" WIDTH="600" HEIGHT="400" ALIGN="bottom" STYLE="width:96%;margin:2%;">
        <EMBED SRC="U:\Web Pages\Web Templates\greeny_blu\Broadcast.txt" WIDTH="600" HEIGHT="400" ALIGN="bottom"></EMBED>
      </OBJECT> </p>
    <p>&nbsp;</p>
  <!-- end .content --></div> 
```

好的，那么这样做呢？我正在通过 JS 阅读它，它现在在一个框架中。我仍然无法隔离字体。这是我所拥有的：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
  <!-- TemplateBeginEditable name="doctitle" -->
  <title>ISC Impact Summary</title>
  <!-- TemplateEndEditable -->
  <META HTTP-EQUIV="REFRESH" CONTENT="10"> <!--
  This is the automatic refresh setting for this web page. It is in seconds. 
  -->
  <html>  
  <style type="text/css">
  body {
    background-color: #06F;
  }
  .Style1 {
    font-family: Calibri;
    font-size: 24em;
    font-style: normal;
    font-weight: normal;
    font-variant: normal;
    background-color: #C0C0C0;
}
  body,td,th {
    color: #CF0;
}
  </style>
  <head>  
  <script type="text/javascript">   
  function init(){      
  var extText = window.frames[0].document.getElementsByTagName("HTML")[0].outerHTML; 
  document.getElementById("nMessage").innerText = extText; }
  </script>
  <!-- TemplateBeginEditable name="head" -->
  <!-- TemplateEndEditable -->
  </head>  
  <body>
  <div>
    <div align="center">
      <h2>ISC Critical Alert Summary</h2>
    </div>
  </div>

   <div>
  </div>
  <div align="center" style="font-size:42;"><!-- TemplateBeginEditable name="EditRegion1" -->
  <iframe src="Broadcast.txt" width="96%" marginwidth="2%" height="400" marginheight="2%" align="middle"     scrolling="Yes" class="Style1" id="messageTxt" style="font-size:42pt" >ISC Critical status</iframe>
    <!-- TemplateEndEditable -->
  </div>   </body>  
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:29:06.793

您不能从“主”html 更改任何参数。浏览器将 iframe 和嵌入式文档与父级隔离开来。

您可以通过 javascript 加载文本或使用 html 而不是 txt。

* * *

**技术细节**:)

t.txt - 是带有文本的文件。您可以为其设置完整的 url 或将其放置在此页面附近并仅设置其名称。

```
 <!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    <title>ISC Impact Summary</title>
    <style type="text/css">
        .b-box_with_grand_text{
            font-size: 42px;
        }
    </style>
    <!--copy this block. jQuery is get from google servers-->
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript">
        // this possible write on clean JS
        $(document).ready(function(){
            $.get('t.txt', function(data) {
                // #echo_file = id from div
                $('#echo_file').html(data);
                alert('Load was performed.');
            });
        })
    </script>
    <!--end copy-->
</head>
<body>
<!--in this block txt file content will be posted. 
Just copy id in place where you want place text-->
<div id="echo_file" class="b-box_with_grand_text"></div>
</body>
</html> 
```

这可行，但它加载昂贵的库 jQuery。

# java - 使用 Java 多线程时 MySQL 数据库不完整性

> ID：11369771
> 
> 赞同：0
> 
> 时间：2012-07-06T21:18:43.203
> 
> 标签：java, mysql, multithreading

我有一个需要 Java 多线程的程序。该`Main`函数对 MySQL DB 进行查询以选择一个值`name`并一次将一个值发送`name`到每个线程。

每个线程都会进行依赖于此的操作`name`。该`run`函数调用一个方法，例如，`method1`该`Class1`方法执行一些操作并在 table2 中的 DB 中插入值，此外，它还调用另一个方法，`method2`该方法在 table1 中执行操作和插入。

数据库包含表 1 和表 2，一对多。但是我还没有连接表，它们直到现在都是分开的。但是其中有一列`table2`反映了table1中的某个记录`table2`属于哪个记录。我在 table2 中的数据库是正确的，但在 table1 中是错误的（例如：前 3 条记录没有插入，而我发现在 table2 中插入了与它们相关的记录，或者有时在 else 记录中插入的另一条记录的值错误等）。

我在线程构造函数中分配了`name`值。课堂上的这个相关部分`Main`如下所示：

```
 PreparedStatement Stmt1=null;   //for the first table
      PreparedStatement Stmt2=null;  //for the second table
      private static Statement statement = null;
      private static ResultSet resultSet = null;
      String name=null;
      String query1=null, query2=null;

try {
      DBConnection.ConnectDB(); //connect to database

      query1 = " insert into schema1.table1 values
                 (default,?,?)";

      query2 = " insert into sechema1.table2 values (default,?,?)"; 

          Stmt1 = DBConnection.con.prepareStatement(query1);
          Stmt2 = DBConnection.con.prepareStatement(query1);

          statement = DBConnection.con.createStatement();   
          resultSet = statement.executeQuery("select name from schema1.table1"); 

          ExecutorService threadExecutor = Executors.newFixedThreadPool(10 );

        while(resultSet.next()) 
           {
           myname=resultSet.getString("Column1");
              MyRunnable task1 = new  MyRunnable( myname);
              threadExecutor.execute( task1 );
              nameCounter++;
           }

 threadExecutor.shutdown();

// Wait until all threads are finish
while (! threadExecutor.isTerminated()) { }

System.out.println("Finished all threads");

DBConnection.con.close();

}// end try 
catch (Exception e) {
            e.printStackTrace();
            } 
```

MyRunnable 类如下：

```
public class MyRunnable implements Runnable{
private String threadName=null;
private int threadCounter; //to count how many names we have selected

    MyRunnable2 (String name)  

   { 
      synchronized (this){  //I used synchronized as I want to avoid two threads 
                           //taking  the same value.

        this.threadHostName=name;
        this.threadCounter=Main.nameCounter; } //end synchronize
   }     

    public void run() 
    {

       // Here I make a call for the Class1 method1 that I want the thread to perform 

    } //end run()
} //end class MyRunnable

public void Class1 {

       public void method1(String name) 
        {
                  //some calculations

                 //I used synchronized to make the DB records correctly inserted 
                 synchronized(this) { // 
                      for (int i = 0; i < Value.length; i++)
                      {

                        //here I need to insert values in table 2

                         try {
                            synchronized(this){
                Main.Stmt2.setString (1, string1);
                                Main.Stmt2.setString (2, string2);
                                Main.Stmt2.executeUpdate(); 
                              }
                       catch (Exception e)
                        {
                           System.out.println("DB_Error:_"+ e.toString());
                         } 
                      } //end for

                    // Here I made a call for method2 in Class2
                } //end synchronized
               } //end method1
        } //end class1 
```

在`Class2`中，我还需要向数据库中插入记录，我在`Class1`. `Calss2`已经应该是同步的，因为它在同步`Parentheses`的 in 中`Class1`。我对处理多线程完全陌生。

我的代码结构有什么问题？我在周围`Main.Stmt2.setString`和`Main.Stmt2.executeUpdate()`周围是否正确`synchronized`？处理多线程时如何保持数据库完整性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:46:48.333

您是否尝试过使用事务来确保数据在两个表中或都不在两个表中？
如果任何现有的两阶段提交选项不起作用，要么使用一个线程进行写入，要么实现您自己的两阶段提交，即线程 t3 向线程 t1 和 t2 发出信号，如果它们准备好提交。线程 t1 和 t2 都必须回复是或否。如果两者的响应都是肯定的，线程 t3 可以告诉线程 t1 和 t2 继续提交，或者告诉他们不要继续提交/使用回滚。我没有考虑太多 - 可能会避免使用第三个线程并使用两个线程共享的数据结构来存储两个线程是否准备好提交或应该回滚事务。

# php - 使用zend框架将表单从弹出窗口提交到原始窗口

> ID：11369780
> 
> 赞同：2
> 
> 时间：2012-07-06T21:19:21.070
> 
> 标签：php, forms, zend-framework, popup, submit

我不知道这是否可能，我正在使用带有 zend-framwork 的 php，我想在弹出窗口中为用户显示一个编辑器。

我想将此表单提交回原始窗口并关闭窗口。

1）问题是我无法查看表单`$this->view->form = $form`并在该操作的视图中回显它？我正在使用此代码弹出新窗口。我试图通过从控制器回显表单来解决这个问题，它工作但我无法在任何地方提交。

```
<a href="#" onClick="MyWindow=window.open('<?php echo $this->url(array('module' => 'default', 'controller' => 'index', 'action' => 'editor'));         ?>','MyWindow','toolbar=no,location=no,directories=no,status=no, menubar=no,scrollbars=no,resizable=no,width=600,height=300'); return false;">Click Here</a> 
```

2）如何将弹出窗口返回到原始窗口，甚至可以吗？

如果我的问题遗漏了什么，请询问。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-07T14:57:04.827

您可以在打开的弹出窗口的脚本中使用 window.opener 属性。像这样

```
window.opener.TheMethodOfParentWindow(ValueOfTheEditor);
window.close(); 
```

如果您想查看，我已经在此主题上写了一篇详细的帖子： [http ://rupeshpatel.wordpress.com/2012/05/15/how-to-call-javascript-function-of-parent-window-from-新的弹出窗口/](http://rupeshpatel.wordpress.com/2012/05/15/how-to-call-javascript-function-of-parent-window-from-new-pop-up-window/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T06:29:17.693

我不知道是否可以从弹出窗口提交表单到父窗口的操作。

在我的应用程序中，我使用了一个弹出窗口来编辑报价，它提交到同一控制器中的另一个操作，并在提交后使用 jQuery 在 1 或 2 秒内关闭窗口，类似于“报价已编辑”。谢谢！呜呜呜……” 此类编辑的问题是用户无法立即查看已编辑的报价。他应该刷新“父”页面以查看更改。

另一种方法是不使用弹出窗口，而是在同一页面中使用弹出 div。然后您可以在同一页面/操作中提交表单。

# math - 给定值的自然样条值

> ID：11369781
> 
> 赞同：1
> 
> 时间：2012-07-06T21:19:24.253
> 
> 标签：math, spline

[我正在尝试使用来自http://mathworld.wolfram.com/CubicSpline.html](http://mathworld.wolfram.com/CubicSpline.html)的自然样条形式并在[http:// www.cse.unsw.edu.au/~lambert/splines/natcubic.html](http://www.cse.unsw.edu.au/~lambert/splines/natcubic.html)。

不幸的是，这种样条形式对样条的每个段采用 0->1 范围内的 t 值，以便计算沿每个段的 x 和 y 坐标。我想输入给定的 x 坐标并获取相应的 y 坐标，但我不确定如何从我的 x 坐标中获取 t 值。即，样条的系数存储为 y=f(t) 和 x=f(t)，但我想得到 y=f(x)。除了创建查找表之外，是否有任何确切的解决方案可以从这种形式的样条中得到 y=f(x)？

我尝试了其他采用 x 值并返回 y 值的实现（例如，apache commons math，Flanagan 的科学库），但来自上述网站的样条版本似乎在我的应用程序中表现良好。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T04:04:02.030

你想要的并不总是可能的。对于单个 x 值，可以有一个样条线段，它通过两个不同的点。

如果您真的需要它作为 x 的函数，您可以求解三次方程 X(t) = x0 的 t（使用例如[Cardano](http://mathworld.wolfram.com/CubicFormula.html)的公式），然后将 t 的值替换为 Y(t)。

# java - 生成 JAX-WS 源 NullPointerException

> ID：11369782
> 
> 赞同：1
> 
> 时间：2012-07-06T21:19:29.250
> 
> 标签：java, eclipse, wsdl, jax-ws, mule

我正在尝试从我已经创建的 WSDL 定义中生成 Java 服务类。我当前的问题是它失败并显示以下消息，仅此而已：

```
Unable to generate JAX-WS Source.

Reason:
java.lang.NullPointerException 
```

*（耶〜冗长）*

我正在使用基于 Eclipse 3.6.1 的 MuleStudio 1.3.0。我已经尝试从 Mule 的组件和直接从 WSDL 创建这些类，但我得到了同样的错误。

我故意混淆了 WSDL，它正确地开始抛出验证错误。这意味着它正在读取文件并正确解析它。不知道接下来会发生什么。

**我该如何解决这个问题？**

以下是我的 wsdl 文件供参考：

```
<?xml version="1.0" encoding="UTF-8"?>
<wsdl:definitions 
    xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
    xmlns:tns="http://tempuri.org/ListenerService/" 
    xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" 
    xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    name="ListenerService"
    targetNamespace="http://tempuri.org/ListenerService/">
    <!-- types -->
    <wsdl:types>
        <!-- Generic TransactionLog entities -->
        <xsd:schema targetNamespace="http://tempuri.org/ListenerService/" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
            <xsd:simpleType name="LevelEnumeration">
                <xsd:restriction base="xsd:normalizedString">
                    <xsd:enumeration value="Debug" />
                    <xsd:enumeration value="Info" />
                    <xsd:enumeration value="Warning" />
                    <xsd:enumeration value="Error" />
                    <xsd:enumeration value="Fatal" />
                </xsd:restriction>
            </xsd:simpleType>

            <xsd:complexType name="LogEntry">
                <sequence>
                    <xsd:element name="CorrelationToken" type="xsd:normalizedString"/>
                    <xsd:element name="SystemId" type="xsd:normalizedString"/>
                    <xsd:element name="Level" type="tns:LevelEnumeration"/>
                    <xsd:element name="Description" type="xs:string" />
                    <xsd:element name="RecordData" type="xs:string" />
                    <xsd:element name="Timestamp" type="xs:dateTime" />
                </sequence>
            </xsd:complexType>

            <!-- Service Specific Types -->
            <xsd:simpleType name="GenericResponseStatusEnumeration">
                <xsd:restriction base="xsd:normalizedString">
                    <xsd:enumeration value="Success" />
                    <xsd:enumeration value="Error" />
                </xsd:restriction>
            </xsd:simpleType>
            <xsd:complexType name="ListenerServiceGenericResponse">
                <sequence>
                    <xsd:element name="Status" type="tns:GenericResponseStatusEnumeration" />
                    <xsd:element name="Detail" type="xsd:string" minOccurs="0" maxOccurs="1" />
                </sequence>
            </xsd:complexType>

            <xsd:element name="LogEntry" type="tns:LogEntry" />
            <xsd:element name="ServiceResponse" type="tns:ListenerServiceGenericResponse" />
        </xsd:schema>
    </wsdl:types>

    <!-- service message types -->
    <wsdl:message name="SubmitLogRequest">
        <wsdl:part name="LogEntry" type="tns:LogEntry" />
    </wsdl:message>
    <wsdl:message name="SubmitLogResponse">
        <wsdl:part name="Response" type="tns:ListenerServiceGenericResponse" />
    </wsdl:message>

    <!-- service messages -->
    <wsdl:portType name="ListenerService">
        <wsdl:operation name="SubmitLog">
            <wsdl:input message="tns:SubmitLogRequest" />

            <!-- TODO: Remove this to make it a one-way operation -->
            <wsdl:output message="tns:SubmitLogResponse" />
        </wsdl:operation>
    </wsdl:portType>

    <!-- service bindings -->
    <wsdl:binding name="ListenerServiceSOAP">
        <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http" />
        <wsdl:operation name="SubmitLog">
            <soap:operation soapAction="http://tempuri.org/ListenerService/SubmitLog" />
            <wsdl:input>
                <soap:body use="literal" />
            </wsdl:input>
            <wsdl:output>
                <soap:body use="literal" />
            </wsdl:output>
        </wsdl:operation>
    </wsdl:binding>

    <wsdl:service name="ListenerService">
        <wsdl:port binding="tns:ListenerServiceSOAP" name="ListenerServiceSOAP">
            <soap:address location="http://tempuri.org" />
        </wsdl:port>
    </wsdl:service>
</wsdl:definitions> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T08:38:17.147

我会尝试从命令行直接在 Wsdl 上调用 jaxws wsimport 命令。我相信它现在随 JDK 一起提供，因此您甚至不必下载它。
您可能遇到了已在更高版本的 wsimport 中修复的错误。

# android - 在小部件单击时将任务置于最前面

> ID：11369785
> 
> 赞同：1
> 
> 时间：2012-07-06T21:20:08.227
> 
> 标签：android, widget, task, move, back

我发送了一项任务（活动）以返回：

```
 @Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    moveTaskToBack(true);
} 
```

但我需要通过小部件中的 setOnClickPendingIntent 将其放在前面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T09:27:45.993

只需像这样启动应用程序的主要（根）活动：

```
Intent intent = new Intent(context, MainActivity.class);
intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
context.startActivity(intent); 
```

如果活动已经在任务中运行，这只会将该任务带到前台（而不创建活动的任何新实例）。如果该活动尚未运行，那么这将启动一个以该活动为根的新任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T12:11:49.130

在我的情况下，FLAG_ACTIVITY_NEW_TASK 没用。尽管任务中存在活动，但它会重新创建活动。

但是单任务启动模式效果很好。

# java - 有状态会话 bean 与持久实体

> ID：11369787
> 
> 赞同：4
> 
> 时间：2012-07-06T21:20:13.233
> 
> 标签：java, persistence, java-ee-6, stateful-session-bean

有状态会话 bean 通常通过实现购物车来说明。来自 Java EE 外部，我倾向于使用持久模型实体来处理这种状态：具有 Products 和数量的 ShoppingCart 对象。这样，我的状态与我的所有其他状态一起由数据库维护，而不是由应用程序服务器维护。

与“普通”持久性相比，有状态会话 bean 设计的技术优势是什么？基于 Java EE 的 Web 应用程序中的购物车是否确实通常使用 SFSB 编写，或者在其他系统中仅通过更精细的域建模来编写？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T07:32:27.760

有几种方法可以实现购物车。SFSB 和 DB 持久性之间的主要区别是持久性:)

有状态会话 bean 只会在会话期间“保留”数据。因此，如果用户会话变为非活动状态（例如 30 分钟不活动后），购物车将被重置

数据库持久化后，购物车会被永久存储，所以如果用户的购物车已经装满，那么在6个月内不要访问网店，再次访问，购物车还是会被装满

我认为通常使用第一个解决方案，因为涉及非内存数据库不是存储易失性数据的好主意。对于不需要长期持久性的数据，将会有大量的硬盘 I/O 开销

# asp.net - 在 grouptemplate 中有两行的 asp.net listview

> ID：11369788
> 
> 赞同：1
> 
> 时间：2012-07-06T21:20:19.500
> 
> 标签：asp.net, webforms, itemtemplate, valign

关于SO的第一个问题

我必须在其中做一个搜索结果页面，`asp.net`但我遇到了一些问题 - 我将（对于每个“框”）拥有书籍封面的图像和书名

知道所有图像的高度不同，我希望能够将它们垂直对齐到底部。我在网上非常努力地搜索并找到了一些使用显示表/表行/表单元格的解决方案。

一切正常，使用`ListView`'s `GroupTemplate`（作为行）和`ItemTemplate`（作为单元格）如果我只想显示图像 - 但是 - 我希望图像垂直对齐底部和下面的书名（标题下方有一个链接，如“了解更多” ）。

知道我不能将我的书名放在与图像相同的单元格中（因为有时标题会占用两行，这会再次破坏设计......），我认为我需要另一行（比如在我的下面的代码）。我坚持将我的两行放入`GroupTemplate`会起作用，但`ListView`似乎并没有让我能够调用两个不同的项目模板（一个用于图像，一个用于放置在另一行中的文本，位于他的图像下方）。

任何帮助将不胜感激，如果您有其他选择，我愿意接受建议。请记住，我需要一个`DataPager`所以`ListView`- 我认为 - 是唯一的出路。

这是我的CSS

```
#grid{
    background: lightgreen;
    border-spacing: 10px;
    display: table;
}
#grid .row{display: table-row;}
#grid .result{
    display: table-cell;
    vertical-align: bottom;
} 
```

这是我的搜索结果`ListView`草稿（图片很好，但只有蹩脚的“测试”文字）

```
<asp:ListView ID="lvSearchResults" runat="server" OnPagePropertiesChanged="DataPager_PreRender" OnPagePropertiesChanging="DataPager_PreRendering" GroupItemCount="5" >
        <LayoutTemplate>
            <div id="grid">
                <asp:PlaceHolder ID="groupPlaceholder" runat="server" />
            </div>
        </LayoutTemplate>
        <GroupTemplate>
            <div class="row">
                <asp:PlaceHolder ID="itemPlaceholder" runat="server" />
            </div>
            <div class="row">
                <asp:PlaceHolder ID="itemPlaceHolder1" runat="server" />
            </div>
        </GroupTemplate>
        <ItemTemplate>
            <div class="result">
                <p><a href='<%# Container.DataItem.URI %>'><img src='<%# Container.DataItem.LesImages.Petite %>' alt="" /></a></p>
            </div>
        </itemtemplate>
        <ItemTemplate>
            <div class="result">
                <p><a href='<%# Container.DataItem.URI %>'>test</a></p>
            </div>
        </itemtemplate>
    </asp:ListView> 
```

非常感谢， - 埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T12:47:12.660

不知何故，我已经能够做我想做的事：

通过为剩余内容（标题和链接）提供固定高度，图像继续垂直对齐。所以在我的特殊情况下，不需要在 groupTemplate 中创建第二行。

为我的标题固定高度，因为它可以占用（但不能更多）两行或仅一行。由于我标题下方的链接对于每个 itemTemplate 迭代都是相同的，因此无需为他的块指定高度。

感谢 MajoB 的回答，但不知何故它对我不起作用。

这是我的新的和改进的代码... ;)

```
 <GroupTemplate>
            <div class="row">
                <asp:PlaceHolder ID="itemPlaceholder" runat="server" />
            </div>
        </GroupTemplate>
        <ItemTemplate>
            <div class="result">
                <a href='<%# Container.DataItem.URI %>'><img src='<%# Container.DataItem.LesImages.Petite %>' alt="" /></a>
                <div style="height: 40px;margin-top: 10px;"><asp:Literal ID="litTitre" runat="server" Text='<%# TrunkStringRelay(Container.DataItem.Titre, 40) %>' /></div>                    
                <a href='<%# Container.DataItem.URI %>'>En savoir plus &raquo;</a>
            </div>
        </itemtemplate> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T07:33:15.823

而不是两个项目模板：

```
<ItemTemplate>
    <div class="result">
        <p><a href='<%# Container.DataItem.URI %>'><img src='<%# Container.DataItem.LesImages.Petite %>' alt="" /></a></p>
     </div>
 </itemtemplate>
 <ItemTemplate>
     <div class="result">
         <p><a href='<%# Container.DataItem.URI %>'>test</a></p>
     </div>
 </itemtemplate> 
```

试一试：

```
<ItemTemplate>
    <div class="result">
        <p><a href='<%# Container.DataItem.URI %>'><img src='<%# Container.DataItem.LesImages.Petite %>' alt="" /></a></p>
     </div>
     <div style="clear:both"></div>
     <div class="result">
         <p><a href='<%# Container.DataItem.URI %>'>test</a></p>
     </div>
 </itemtemplate> 
```

# asp.net-mvc-3 - MVC3 搜索用户控件

> ID：11369793
> 
> 赞同：0
> 
> 时间：2012-07-06T21:20:30.163
> 
> 标签：asp.net-mvc-3

我在我的网站上有一个部分视图，在许多页面之间共享，用于搜索功能，包括：
从日期
到日期
文件类型
文件名

现在，问题是，在某些页面中我不希望包含**文件类型**，在其他页面中我不希望包含（**从 - 到**）日期标准

我该怎么办？我应该为每个功能创建一个局部视图吗？或从内部显示/隐藏标准？

**_Filters.cshtml**

```
@model Entities.FilterOperations
<table width="85%" border="0" align="center" cellpadding="0" cellspacing="1">
    <tr>
        <td class="formtit">
            Start Date
        </td>
    </tr>
    <tr>
        <td>@Html.TextBoxFor(m => m.StartDate, new { @class = "date" })
        </td>
    </tr>
    <tr>
        <td class="formtit">
            End Date
        </td>
    </tr>
    <tr>
        <td>@Html.TextBoxFor(m => m.EndDate, new { @class = "date" })
        </td>
    </tr>
  <tr>
        <td class="formtit">
            File Type
        </td>
    </tr>
    <tr>
        <td>@Html.TextBoxFor(m => m.FileType)
        </td>
    </tr>
    <tr>
        <td class="formtit">
            File Name
        </td>
    </tr>
    <tr>
        <td>@Html.TextBoxFor(m => m.FileName)
        </td>
    </tr> <tr>
        <td align="right">
            <input type="submit" value="Search" />
        </td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:24:22.113

创建几乎相等的部分是没有意义的。使用 Viewbag。

```
@if(ViewBag.ShowSomething ?? true)
{
    //enter code here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T23:02:10.523

只需向您的 FilterOperations 模型添加一些属性，例如：

```
public bool RenderFileType {get; private set;}
public bool RenderDateTo {get; private set;} 
```

有了一个新的演员：

```
public FilterOperations(bool renderFileType = true, bool renderDateTo = true) {
    RenderFileType = renderFileType;
    RenderDateTo = renderDateTo;
} 
```

现在您可以像这样在您的部分设置条件：

```
@if(Model.RenderFileType) {
<tr>
    <td>@Html.TextBoxFor(m => m.FileType)
    </td>
</tr>
} 
```

然后在您看来，像这样调用您的部分：

```
@Html.Partial("_Filters.cshtml", new FilterOperations(renderDateTo: false)) 
```

# .net - .NET DateTime 使用 ToString("U") 有问题吗？

> ID：11369794
> 
> 赞同：-2
> 
> 时间：2012-07-06T21:20:33.160
> 
> 标签：.net, datetime

我有下一个简单的代码......

```
Console.WriteLine(default(DateTime).Date.ToString("U")); 
```

发出的文本是（我有一个西班牙语安装）：“lunes, 01 de enero de 0001 3:00:00”

为什么它从 3 小时开始，而不是 0？这是一个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:26:05.130

好吧，除非你有一台时间机器或者`DateTime`真的有问题，否则这*不是*你发布的代码的输出，它使用`DateTime.Now`.

我怀疑您的代码*确实*在使用`DateTime.MinValue`（或`new DateTime()`），而您看到凌晨 3 点的原因是（根据[文档](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx#UniversalFull)）：

> 该图案与“F”图案相同。但是，DateTime 值在格式化之前会自动转换为 UTC。

所以我怀疑你所在的时区是当地时间 0001 年 1 月 1 日午夜是 UTC 时间凌晨 3 点。（`DateTimeZone.MinValue`有一种“种类” `Unspecified`，因此当被要求转换为 UTC 时将被视为本地。在这个区域`DateTime`有点[混乱](http://noda-time.blogspot.co.uk/2011/08/what-wrong-with-datetime-anyway.html)。）

# c++ - 如何在静态库中使用共享库而不强制最终用户链接这些库？

> ID：11369796
> 
> 赞同：4
> 
> 时间：2012-07-06T21:20:58.527
> 
> 标签：c++, static-linking, dynamic-linking

假设我正在开发一个静态库`foo.a`，它使用`bar.so`.

我如何以这样一种方式构建这个库，使得`foo.a`在他们的项目中使用的任何人都不必显式链接到`bar.so`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T21:43:18.463

您可以做的`libfoo.a`是调用`dlopen`动态链接`libbar.so`。然后，使用`dlsym`定位您要使用的功能。

```
typedef void (*BarFunctionType) (const char *);
FunctionType barFunction;

void initialize_foo_lib () {
    void *h = dlopen("libbar.so", RTLD_LAZY);
    BarFunctionType barFunction = (BarFunctionType) dlsym(h, "barFunction");
    // Note scary looking cast to get your function pointer.
    //... rest of code can call barFunction now
} 
```

`libbar.so`应该是 C 库，或者函数应该是`extern "C"`C++ 库，以便您正确找到函数名称。否则，您将需要修改名称以使用`dlsym`. 您可以`objdump -T`在库上使用来检查库中的名称是否被损坏。

意识到仍然存在对 的依赖`libbar.so`，但它已被烘焙到您的静态库中。因此，用户在链接时`libfoo.a`不必添加`-lbar`到链接行`-lfoo`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:47:49.867

从扩展来看，您正在寻找一种 Unix 方式；据我所知，g++ 和 clang++ 都不能做到这一点。

Visual C++ 可能可以做到——我只将它用于静态库，而不是 DLL，但是......

# ruby-on-rails-3 - 在 rspec 异常处理之后，为 'expect' 获取 'NoMethodError'

> ID：11369798
> 
> 赞同：5
> 
> 时间：2012-07-06T21:21:14.570
> 
> 标签：ruby-on-rails-3, rspec

对为什么这个 RSpec 方法不起作用感到困惑。我在这里查看答案：[如何使用 RSpec 的 should_raise 有任何异常？](https://stackoverflow.com/questions/1722749/how-to-use-rspecs-should-raise-with-any-kind-of-exception)并尝试了所有建议的组合，但由于某种原因，我仍然收到 NoMethodError。

这是例外

```
Exception encountered: #<NoMethodError: undefined method `expect' for #<Class:0x007fa5bd8e4120>> 
```

这是方法：

```
describe "admin should not be accesible" do
expect { User.new(name: "Example Name", email: "email@example.org", password:    "foobar", password_confirmation: "foobar", admin: "true") }.should raise_error(ActiveModel::MassAssignmentSecurity::Error)
end 
```

我之前收到了这个错误，所以我知道我的方法正在做我想做的事情：

```
1) User admin should not be accesible
Failure/Error: hey = User.new(name: "Hello", email: "hey@hey.org", password: "foobar", password_confirmation: "foobar", admin: "true")
 ActiveModel::MassAssignmentSecurity::Error:
   Can't mass-assign protected attributes: admin 
```

我在跑步：

Rails 3 上的 RSpec 2.1.0，带有 guard-spork 0.3.2 和 spork 0.9.0

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-06T21:25:06.857

这是经典！你错过了`it`街区！

```
describe "admin should not be accesible" do
  it "should bla" do
    expect { User.new(name: "Example Name", email: "email@example.org", password:    "foobar", password_confirmation: "foobar", admin: "true") }.should raise_error(ActiveModel::MassAssignmentSecurity::Error)
  end
end 
```

# javascript - 具有相同文件名的多个 css 文件

> ID：11369802
> 
> 赞同：0
> 
> 时间：2012-07-06T21:22:04.953
> 
> 标签：javascript, jquery, asp.net-mvc-3

我正在尝试使用我的 MVC3 应用程序来完成[这项工作。](http://etimbo.github.com/jquery-print-preview-plugin/example/index.html)看起来 javascript 源代码工作正常。它将整个页面（包括头部和正文）附加到原始页面的底部并尝试使用 css 文件。第一次在页面顶部声明此文件，并带有属性 (media='print')。它不会在页面上应用任何更改。第二次插件在下面声明它，带有属性（media='all'），从这一刻起它应该应用更改，显示打印预览和显示按钮。但是什么都没有发生，直到我在页面顶部手动将属性“媒体”从“打印”更改为“全部”。看起来第一个声明阻止了第二个声明。我不能一直使用这个 css 文件，因为我需要在打印模式下隐藏一些元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:33:20.640

在 css 中添加 @media 规则。

@media rule 允许您在一个 css 文件中按媒体类型对 CSS 规则进行分组：

```
body {
color:#444;
background-color:#fff;
}
@media screen, projection {
body { background-image:url(background.png); }
}
@media print {
body { color:#000; }
}
@media handheld {
body { color:#0f6517; }
} 
```

# android - 地图视图上的自定义可绘制对象

> ID：11369806
> 
> 赞同：0
> 
> 时间：2012-07-06T21:22:27.567
> 
> 标签：android, android-mapview

**矩形.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" android:shape="rectangle" android:layout_weight="100"> 
<solid android:color="#ffffff"/>    

<stroke android:width="3dp"
        android:color="#ff000000"/>

<padding android:left="1dp"
         android:top="1dp"
         android:right="1dp"
         android:bottom="1dp"/> 

<corners android:radius="30dp"/> 
</shape> 
```

**我的地图活动**

```
//Drawable d = getResources().getDrawable(R.drawable.chart); <-- this will get drawn on my map

Drawable rect = getResources().getDrawable(R.drawable.rectangle); // <-- this wont

OverlayItems itemizedoverlay = new OverlayItems(rect, this); 
```

谁能解释为什么我不能在我的地图视图上添加自定义形状？普通的 png 文件效果很好，但如果我尝试制作自定义形状并添加它，它就不会出现。对我来说没有意义，因为它们都是可绘制的？

我错过了什么明显的东西吗？谢谢

# asp.net-mvc - 视图对话框中的 T4MVC 隐藏模型类

> ID：11369810
> 
> 赞同：1
> 
> 时间：2012-07-06T21:22:52.213
> 
> 标签：asp.net-mvc, t4mvc

我最近注意到，在向控制器方法添加视图时，对话框没有列出我的任何模型类。我仍然可以生成视图并指定要使用的模型，但它不再在对话选项中可用。（目前有 v2.10.0）

干杯蒂姆

# jquery - 获取 JQuery 对象中的属性数量

> ID：11369812
> 
> 赞同：0
> 
> 时间：2012-07-06T21:22:55.937
> 
> 标签：jquery, json

我试图弄清楚以下对象中有多少属性。显然，我可以看到 2，但我需要动态知道。

```
var test = $.parseJSON('{ "ddSize": "Size", "ddColor": "Color" }'); 
```

如果我尝试：

```
var mylen = test.length; 
```

.length 未定义。此对象中的属性数量将发生变化。有时是 1，有时是 2 或 3，但我就是不知道如何测试它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T21:36:57.977

这是一个 JavaScript JSON 对象。`length`功能不可用。

纯 JavaScript 的第一个解决方案：

```
var data = $.parseJSON('{ "ddSize": "Size", "ddColor": "Color" }'); 
var keys = [];
for (key in data) {
  keys.push(key);
}
// numberOfKeys should equal to 2
var numberOfKeys = keys.length; 
```

如果您更喜欢 jQuery，则第二种解决方案：

```
var data = $.parseJSON('{ "ddSize": "Size", "ddColor": "Color" }');
var keys = [];
$.each(data, function(key, value) {
  keys.push(key)
});
// numberOfKeys should equal to 2
var numberOfKeys = keys.length; 
```

[jQuery.each 函数](http://api.jquery.com/jQuery.each/)的文档

# android - 如何安装以前的 Android 支持库（版本 8）

> ID：11369814
> 
> 赞同：6
> 
> 时间：2012-07-06T21:22:57.543
> 
> 标签：android, adt

我刚刚安装了最新的 ADT Tools for Eclipse，所以我现在是 v20.0。

这个版本引入了一个新的项目向导，在最后一个步骤中它说它需要 Android 支持库版本 8。
好的，但是在我的 SDK 管理器中它告诉我我已经安装了 Android 支持库版本 9。

我怎样才能让它工作，有没有办法安装旧的 Android 支持库版本 8？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T21:28:43.657

好的，就像我发布我的问题一样，我确实找到了[解决方法](http://code.google.com/p/android/issues/detail?id=34169&colspec=ID%20Type%20Status%20Owner%20Summary%20Stars&start=100)。

> 似乎 ADT 在错误的文件夹中查找支持库...库所在的文件
> 夹是：
> (1) \extras\android\compatibility 但 ADT 在以下位置查找它们：
> (2) \extras\android\支持
> 所以你必须创建文件夹（2）并将文件夹（1）中的所有文件复制到它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-11T12:48:14.383

以上回答基本正确。但简单地复制对我不起作用。对我有用的是：

1.  打开 SDK 管理器

2.  检查“Android 支持库”

3.  点击“删除 1 个包”

4.  然后再次检查“Android SDK Library”并

5.  点击“安装 1 个包”

这从 extras\android\compatibility 中删除了支持库，并在 extras\android\support 下再次安装了它

# php - Android 应用程序未与数据库同步

> ID：11369820
> 
> 赞同：0
> 
> 时间：2012-07-06T21:23:24.640
> 
> 标签：php, android, mysql

我正在开发的 Andriod 应用程序使用 Http Gets/Posts 在我的网站上使用 PHP 文件在 mysql 数据库上执行事务。

在 PHP 方面，我使用 JSON 包装数据，以便在收到响应时在应用程序的 java 端进行解析。我最近修改了其中一张表，并从表中删除了不必要的值。当我使用我网站上的 PHP 脚本进行轮询时，它会正确轮询。当我使用使用相同 PHP 脚本进行轮询的应用程序时，它会返回我已经从数据库中删除的附加值。

我重新启动了 Eclipse，清理了项目，并重新启动了 android VDM 以刷新它；但是，它会继续查找那些被删除的值。关于发生了什么的任何想法？

这是我从应用程序连接到的 php 脚本：

```
<?php
mysql_connect("localhost", "******", "******");
mysql_select_db("bouncet2_pogoapp");

$query = "SELECT * FROM Event_Table ORDER BY Event ASC";
$sql = mysql_query($query);

while($row=mysql_fetch_assoc($sql))
$output[]=$row;

print(json_encode($output));

mysql_close();
?> 
```

至于我在应用程序中使用脚本的代码：

```
try {
        String response = CustomHttpClient.executeHttpGet("http://www.*****.com/****/****/***/GetEvents.php");
        //System.out.println(response);

        try {
            eventArray = new JSONArray(response);
            //Log.i(SelectEventActivity.class.getName(), "Number of entries " + eventArray.length());

            m_adapterForSpinner = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item);
            m_adapterForSpinner.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

            event_Spinner.setAdapter(m_adapterForSpinner);          

            for (int i = 0; i < eventArray.length(); i++) {
                JSONObject jsonObject = eventArray.getJSONObject(i);
                m_adapterForSpinner.add(jsonObject.getString("Event"));
                //Log.i(AddJumpersActivity.class.getName(), jsonObject.getString("Event"));
            }

        } catch (Exception e) {
            e.printStackTrace();
        }           
    } catch (Exception e) {
        e.printStackTrace();
    } 
```

函数 executeHttpGet(URL) 是 CustomHttpClient 类的一部分，如下所示：

```
public static String executeHttpGet(String url) throws Exception {

    StringBuilder builder = new StringBuilder();
    HttpClient client = getHttpClient();
    HttpGet request = new HttpGet();
    request.setURI(new URI(url));

    try {            
        HttpResponse response = client.execute(request);
        StatusLine statusLine = response.getStatusLine();
        int statusCode = statusLine.getStatusCode();

        if (statusCode == 200) {
            Log.i(CustomHttpClient.class.toString(), "System Status OK");
            HttpEntity entity = response.getEntity();
            InputStream content = entity.getContent();
            BufferedReader reader = new BufferedReader(new InputStreamReader(content));
            String line;
            while ((line = reader.readLine()) != null) {
                builder.append(line);
            }
        } else {
            Log.e(CustomHttpClient.class.toString(), "Failed to download file");
        } 
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    return builder.toString();            
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T00:32:27.923

看起来您的响应被缓存在某处，以太在手机和服务器之间的缓存服务器中，或者在手机本身中。

如果缓存发生在手机之外，添加适当的标头来禁用缓存就可以了。这将由服务器添加到响应的标头中。有几种方法可以做到这一点，但我认为这应该工作......

```
header("Expires: Tue, 03 Jul 2001 06:00:00 GMT"); 
```

在电话端，根据您从 getHttpClient 获得的 HTTP 客户端，它可能是打开了缓存的客户端。在 Ice Cream Sandwich 中，Google 将缓存添加到 HttpURLConnection HTTP 客户端。根据文档，必须打开缓存，但许多人似乎在他们不知道的情况下遇到了缓存打开的问题。我不熟悉 Android 上各种 HTTP 客户端的互通，但这应该是一个好的开始......

[http://developer.android.com/reference/java/net/HttpURLConnection.html](http://developer.android.com/reference/java/net/HttpURLConnection.html)

快速而肮脏的检查以查看是否有东西在缓存响应是在调用服务器时向您的 URL 添加一个随机的、未使用的参数，例如......

```
url += "?unused=" + UUID.randomUUID(); 
```

有了这个，您不应该在任何地方缓存，然后您至少可以确定它是缓存问题还是其他问题，然后从那里开始。

# php - PHP：干净的 url 和查询字符串

> ID：11369825
> 
> 赞同：1
> 
> 时间：2012-07-06T21:23:49.607
> 
> 标签：php, query-string, clean-urls

为什么在使用干净的 url 时没有将查询字符串添加到 GET 数组中？例如。使用`/foo/bar?stack=overflow`且`$_GET['stack']`变量为空。

我正在使用以下代码实现干净的 url：

```
$request = rawurldecode($_SERVER['REQUEST_URI']);

// Extracts the index.php file path (eg. /my_app)
// There is no need to specify the path to index.php as the script handles it
$path_to_index = str_ireplace($_SERVER['DOCUMENT_ROOT'].'/', '', $_SERVER['SCRIPT_FILENAME']);
$path_to_index = str_ireplace('/'.basename($_SERVER['SCRIPT_FILENAME']), '', $path_to_index);

    // Get rid of the path to index.php
$request = str_ireplace($path_to_index, '', $request);

// Get rid of index.php in the URL
$request = str_ireplace(basename($_SERVER['SCRIPT_FILENAME']), '', $request);

// Our URL is now clean so we can explode
$request = explode('/', $request);

// Delete empty and reindex
$request = array_values(array_filter($request)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:27:32.143

**如果在 .htaccess 中使用 RewriteRules**

在你的`RewriteRule`行末`[QSA]`这样写：

```
RewriteRule (.*) index.php?stuff=$1 [QSA] 
```

QSA 标志信息：[http ://httpd.apache.org/docs/2.2/rewrite/flags.html#flag_qsa](http://httpd.apache.org/docs/2.2/rewrite/flags.html#flag_qsa)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:26:38.640

也许是 b/c 你没有使用 $_GET ？GET 不是变量，但这应该可以正常工作......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-06T21:37:29.297

您可能忘记在全局变量名称中使用下划线（“_”）。

尝试使用 $_GET['stack']。

# algorithm - Bellman-Ford：所有最短路径

> ID：11369829
> 
> 赞同：4
> 
> 时间：2012-07-06T21:24:08.390
> 
> 标签：algorithm, shortest-path, bellman-ford

当边缘具有负权重/距离时，我已成功实施 Bellman-Ford 以找到最短路径的距离。我无法让它返回所有最短路径（当有最短路径时）。我设法用 Dijkstra 获得了所有最短路径（在给定的一对节点之间）。Bellman-Ford 有可能吗？（只是想知道我是否在浪费时间尝试）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-07T00:03:57.703

[如果你稍微改变一下Bellman-Ford 算法](http://en.wikipedia.org/wiki/Bellman%E2%80%93Ford_algorithm#Algorithm)的第二步，你可以得到非常相似的结果：

```
for i from 1 to size(vertices)-1:
   for each edge uv in edges: // uv is the edge from u to v
       u := uv.source
       v := uv.destination
       if u.distance + uv.weight < v.distance:
           v.distance := u.distance + uv.weight
           v.predecessor[] := u
       else if u.distance + uv.weight == v.distance:
           if u not in v.predecessor:
               v.predecessor += u 
```

其中`v.predecessor`是一个顶点列表。如果新的距离`v`等于尚未包括的路径，则包括新的前任。

为了打印所有最短路径，您可以使用类似

```
procedure printPaths(vertex current, vertex start, list used, string path):
    if current == start:
        print start.id + " -> " + path
    else:
        for each edge ve in current.predecessors:
            if ve.start not in used:
                printPaths(ve.start,start, used + ve.start, ve.start.id + " -> " + path) 
```

用于`printPaths(stop,start,stop,stop.id)`打印所有路径。

注意：`if u not in v.predecessor then v.predecessor += u`如果在算法完成后删除重复元素，则可以从修改后的算法中排除。

# rest - 如何捕获 Symfony2 控制器操作中可能出现的所有异常？

> ID：11369830
> 
> 赞同：18
> 
> 时间：2012-07-06T21:24:16.293
> 
> 标签：rest, exception-handling, symfony

我正在尝试构建一个为所有调用返回 JSON 的 REST Web 服务。通常这很简单，我只是这样做：

```
return new Response(json_encode($return_object)); 
```

我的问题是，我应该如何以全局方式拦截异常？我想这样做，因为如果我的应用程序中的任何地方发生异常，我仍然想向客户端返回一条 JSON 消息，基本上说“Yo dawg，我听说你喜欢异常”。我的想法是，在成功和失败的情况下都返回 JSON 将简化任何客户端实现我的 API 所需的工作。

到目前为止，我唯一能想到的就是像这样编写每个控制器动作：

```
public function generateMemeAction($arg1, $arg2) {
  $return_object = array();
  try {
    // stuff to generate meme here
    $return_object['status'] = "GREAT SUCCESS!";
  } catch (Exception $e) {
    // epic fail
    $return_object['status'] = "UnluckyBrianException";
  }
  return new Response(json_encode($return_object));
} 
```

这一切都很棒而且很棒，但是对于我的应用程序中的每个操作，try-catch 块都是一样的，每次我必须围绕一堆复制意大利面进行编辑时，我都会感到很傻。专业提示？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-06T23:03:14.867

REST 应用程序有不同类型的错误。例如，您可能有逻辑错误或输入错误（并非所有参数都已发送）。应该使用不同的方式处理不同类型的错误。这种情况的最佳方法是手动处理这些错误。

您可以将特殊错误方法添加到您的控制器中（并将其放入例如父类中），它将返回错误代码+错误文本。

但是如果你想使用自动处理，你可以使用异常监听器：

*   ~~[http://api.symfony.com/2.0/Symfony/Component/HttpKernel/Event/GetResponseForExceptionEvent.html](http://api.symfony.com/2.0/Symfony/Component/HttpKernel/Event/GetResponseForExceptionEvent.html)~~
*   [http://api.symfony.com/2.7/Symfony/Component/HttpKernel/Event/GetResponseForExceptionEvent.html](http://api.symfony.com/2.7/Symfony/Component/HttpKernel/Event/GetResponseForExceptionEvent.html)
*   [http://symfony.com/doc/current/book/internals.html](http://symfony.com/doc/current/book/internals.html)

这是一个示例：

```
use Symfony\Component\HttpKernel\Event\GetResponseForExceptionEvent;
use Symfony\Component\HttpFoundation\Response;

public function onKernelException(GetResponseForExceptionEvent $event)
{
    $exception = $event->getException();
    $response = new Response();
    // setup the Response object based on the caught exception
    $event->setResponse($response);

    // you can alternatively set a new Exception
    // $exception = new \Exception('Some special exception');
    // $event->setException($exception);
} 
```

# parallel-processing - 服务完成任务时通知服务机器的最有效方法（全部在本地网络内）？

> ID：11369835
> 
> 赞同：0
> 
> 时间：2012-07-06T21:24:42.797
> 
> 标签：parallel-processing, local-network

我有一个暂定的计划来编写一个脚本，给定一个大型任务，在 linux 机器的本地网络上并行处理该作业。

我的问题是，当孩子完成其大部分工作时，我怎样才能最好地通知将部分工作提供给子计算机的计算机？我的第一个想法是让每个孩子写入一个包含状态更新的已知文件，但这似乎效率低下。有更好的解决方案吗？

PS：我知道这个问题在细节上很少。这是我第一次处理很多这些概念，而且通常涉及到的任何东西。我肯定会边走边学，所以如果有一些我没有包括在内的相关内容，请告诉我，我可以尝试包括在内。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:40:48.850

尝试看看 Gearman (http://gearman.org/)。我希望它适合您和我的任务。基本上，它负责所有客户端工作人员通知。你的任务就是拥有两件：

1.  工人将从 Gearman 挑选一份工作，完成工作并返回结果。
2.  客户端会将整个工作分成几块并将其提供给 Gearman，等待一切完成并由 Gearman 返回“线索”结果。

Gearman 只是服务于任务队列的中间人。

# powershell - 在大文件上选择 -first 1

> ID：11369836
> 
> 赞同：8
> 
> 时间：2012-07-06T21:24:47.807
> 
> 标签：powershell

我正在尝试在一个非常大的文本文件上运行以下命令。但是，它非常缓慢

```
((cat largefile.txt | select -first 1).split(",")).count() 
```

是powershell中的另一种快速方法吗？无论如何，该命令似乎都会扫描整个文件。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-06T21:32:46.403

要仅获取文本文件中的前 x 行，请使用 –totalcount 参数：

```
((Get-Content largefile.txt -totalcount 1).split(",")).count 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-06T21:31:04.950

比这更糟糕 - 它会加载整个文件*并将*其转换为字符串数组。

使用本机 .NET 库仅加载第一行：

```
$reader = [System.IO.File]::OpenText("largefile.txt")
$line = $reader.ReadLine()
$reader.Close() 
```

（借自[How to process a file in Powershell line-by-line as a stream](https://stackoverflow.com/a/4192419/1180926)）

# r - 你如何在 R 中进行条件“左连接”？

> ID：11369837
> 
> 赞同：5
> 
> 时间：2012-07-06T21:25:01.763
> 
> 标签：r, conditional, left-join

我发现自己在 R 中多次执行“条件左连接”。举个例子；如果您有两个数据框，例如：

```
> df
    a b
  1 1 0
  2 2 0

> other.df
    a b
  1 2 3 
```

目标是最终得到这个数据框：

```
> final.df
    a b
  1 1 0
  2 2 3 
```

到目前为止我写的代码：

```
c <- merge(df, other.df, by=c("a"), all.x = TRUE)
c[is.na(c$b.y),]$b.y <- 0
d<-subset(c, select=c("a","b.y"))
colnames(d)[2]<-b 
```

最终得到我想要的结果。

有效地在四行中执行此操作会使代码非常不透明。有没有更好、更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T22:53:30.323

这里有两种方法。在这两种情况下，第一行都会进行左合并，返回所需的列。在这种情况下，`merge`我们必须设置名称。两行中的最后一行将`NA`s替换为`0`。

**合并**

```
res1 <- merge(df, other.df, by = "a", all.x = TRUE)[-2]
names(res1) <- names(df)
res1[is.na(res1)] <- 0 
```

**sqldf**

```
library(sqldf)
res2 <- sqldf("select a, o.b from df left join 'other.df' o using(a)")
res2[is.na(res2)] <- 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:48:23.417

分两行：

```
c <- merge(df, other.df,all=T)
c=c[which(!duplicated(c$a)),] 
```

因此，这会从两个数据集中获取值，并从第二个数据集中省略 id 重复的行。我不确定哪个是左哪个是对的，所以如果你想要另一个：翻转数据并做同样的事情。

```
c=c[length(c$a):1,]
c=c[which(!duplicated(c$a)),] 
```

# iphone - 从应用商店下载时出现奇怪的问题

> ID：11369841
> 
> 赞同：0
> 
> 时间：2012-07-06T21:25:23.213
> 
> 标签：iphone, objective-c, ios, ipad, app-store

从应用商店升级后出现以下错误。我尝试通过安装以前的版本然后通过 XCode 运行新更新在 Xcode 中模拟这个，但我没有收到此错误。到底是怎么回事？这是苹果应用商店 DRM 问题之一吗？

```
 <Error>: libMobileGestalt copyInternationalMobileEquipmentIdentity: No IMEI in CT mobile equipment info dictionary - <CFBasicHash 0xee6c450 [0x3f004650]>{type = mutable dict, count = 3,
    entries =>
        2 : <CFString 0xee6c400 [0x3f004650]>{contents = "kCTMobileEquipmentInfoMEID"} = <CFString 0xee6c430 [0x3f004650]>{contents = "A100001CB0E219"}
        3 : <CFString 0xee6c500 [0x3f004650]>{contents = "kCTMobileEquipmentInfoMIN"} = <CFString 0xee6bcd0 [0x3f004650]>{contents = "5204299292"}
        7 : <CFString 0xee6bd10 [0x3f004650]>{contents = "kCTMobileEquipmentInfoPRLVersion"} = <CFNumber 0xee68de0 [0x3f004650]>{value = +52333, type = kCFNumberSInt64Type}
    }
Jul  6 14:38:31 unknown lockdownd[26] <Notice>: 01633000 copy_imei: MobileGestalt failed to provide an IMEI
Jul  6 14:38:31 unknown lockdownd[26] <Notice>: 01633000 copy_iccid: invalid ICCID from CT/no ICCID available
Jul  6 14:38:31 unknown wifid[13] <Error>: WiFi:[363303511.631083]: Client itunesstored is background application
Jul  6 14:38:31 unknown UserEventAgent[12] <Warning>: TRACE: <MBConnection: 0x145210> sending {
        command = kMBMessageAccountChanged;
    }
Jul  6 14:38:31 unknown configd[45] <Notice>: network configuration changed.
> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:32:35.960

可能是这样，但苹果公司表示他们已经解决了这个问题。你可以查看[这篇文章](http://www.marco.org/2012/07/04/app-store-corrupt-binaries)。

# python - 序列化表单数据 - pickle 还是 XML？

> ID：11369842
> 
> 赞同：0
> 
> 时间：2012-07-06T21:25:25.137
> 
> 标签：python, xml, django, serialization, pickle

我正在尝试保存表单数据，我想知道是否应该使用 Python 的本机[pickle](http://docs.python.org/library/pickle.html)或某种 XML 序列化程序。我想使用 django 的[序列化](https://docs.djangoproject.com/en/dev/topics/serialization/)程序，但这些似乎适用于工作机智模型，而不是常规的 Python 字典/对象。

我要序列化的对象几乎完全由字符串（可能还有整数）组成，看起来像这样：

```
data = {
  'var1': "foo",
  'var2': "bar",
  'var3': ['bar', 'foo', 'moo', 'fish'],
  'var4': 42
} 
```

我想保存它，因为我需要能够在将来的某个时候基于这些值呈现 HTML 页面。

我应该继续保存腌制对象 - 还是应该将其保存为 XML？我没有看到使用 XML 的任何优势，因为我不打算在 django 之外访问它。我做出了错误的决定吗？

几点注意事项：

*   这不是我想保存在会话或缓存中的东西，因为我想无限期地保留这些表单的历史记录
*   表单的格式/布局可能会发生变化，因此制作数据库模式来保存这些信息是不切实际的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:31:19.340

选择序列化格式时需要考虑很多事情，而您并没有真正给出问题中所需的任何序列化特征，因此很难提出好的建议。也就是说，如果您不需要在 python 之外读取数据并且您没有安全顾虑，那么 pickle 是一个合理的默认选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T14:48:26.730

那么 json 呢？它是轻量级的、可读的、可移植的，并且序列化/反序列化对于基本类型（字符串、整数、字典、列表）来说非常简单。

我尽可能地坚持规范化的数据库模式，但在少数情况下，存储序列化的东西实际上是“不太糟糕”的解决方案，我选择 json，至少我可以将我的数据与大多数编程语言一起使用。

# mysql - 如何使用mysql选择表中不同值的总和

> ID：11369843
> 
> 赞同：0
> 
> 时间：2012-07-06T21:25:31.567
> 
> 标签：mysql, sql

```
slno state district company 
1     a       ab     abc
2     a       ab     ac
3     a       ab     abc
4     a       ab     abc
5     a       ab     abc
6     a       ab     ac 
```

输出

```
state district company sumzz
 a      ab       abc    4
 a      ab       ac     2 
```

我试过的

```
select state,district,company,sum(company) as sumzz from company 
```

如何实现基于不同公司的显示最后一行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:29:33.187

编辑：对于更新的问题，您可以`slno`在子查询中检索最大值。然后你可以`in`用来过滤那些：

```
select  state
,       district
,       company
,       slno
from    Company
where   slno in
        (
        select  max(slno)
        from    Company
        group by
                state
        ,       district
        ,       company
        ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T21:32:01.290

这种方法有什么问题：

```
 SELECT state, district, company, COUNT(*) as countzz
    FROM company
GROUP BY state, district, company 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-06T21:32:15.687

我认为您正在尝试计算有多少记录而不是求和。如果那是您想要的，那么您应该这样做：

```
SELECT state, district, company, COUNT(*) as sumzz 
FROM company
GROUP BY state, district, company 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T21:35:05.243

选择 state,district,company,sum(company) as sumzz from company where company = 'abc'

# python - 这个python代码线程安全吗（扭曲的线程）？

> ID：11369845
> 
> 赞同：2
> 
> 时间：2012-07-06T21:25:37.923
> 
> 标签：python, multithreading, udp, twisted

我正在编写一个应用程序来收集 UDP 消息并每 1 秒处理一次。

应用程序原型如下所示：

```
from twisted.internet.protocol import DatagramProtocol
from twisted.internet import reactor
import threading
import time

class UdpListener(DatagramProtocol):

    messages = []

    def datagramReceived(self, data, (host, port)):
        self.messages.append(data)

class Messenger(threading.Thread):

    listener = None

    def __init__(self):
        threading.Thread.__init__(self)

    def run(self):
        while True:
            time.sleep(1)
            recivedMessages = self.listener.messages
            length = len(recivedMessages)
            messagesToProccess = recivedMessages[0:length]
            #doSomethingWithMessages(messagesToProccess)
            del self.listener.messages[0:length]
            print(length)

listener = UdpListener()

messenger = Messenger()
messenger.listener = listener
messenger.start()

reactor.listenUDP(5556, listener)
reactor.run() 
```

我不确定是否可以轻松地从列表 (del self.listener.messages[0:length]) 中删除起始值，而不会有任何传入消息更改列表和应用程序崩溃的风险。

**更新**- 带锁的版本

```
class Messenger(threading.Thread):

listener = None
lock = threading.Lock()

def __init__(self):
    threading.Thread.__init__(self)

def run(self):
    while True:
        time.sleep(1)
        recivedMessages = self.listener.messages
        self.lock.acquire()
        try:
            length = len(recivedMessages)
            messagesToProccess = recivedMessages[0:length]
            del self.listener.messages[0:length]
        except Exception as e:
            raise e
        finally:
            self.lock.release()

        #doSomethingWithMessages(messagesToProccess)
        print(length) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-06T21:29:40.773

您的代码不是线程安全的，不。你需要有一个锁`messages`。

但是，这里不需要线程。为什么不这样做？

```
from twisted.internet.protocol import DatagramProtocol
from twisted.internet import reactor

class UdpListener(DatagramProtocol):
    callingLater = False

    messages = []

    def process(self):
        doSomethingWithMessages(self.messages)
        self.messages = []
        self.callingLater = False

    def datagramReceived(self, data, (host, port)):
        self.messages.append(data)
        if not self.callingLater:
            reactor.callLater(1.0, self.process)
            self.callingLater = True

listener = UdpListener()

reactor.listenUDP(5556, listener)
reactor.run() 
```

* * *

更新：这是原始版本如何使用锁，仅用于教育目的。请注意，这效率不高，而且更容易出现错误。编辑：将所有消息逻辑分开，`UdpListener`以便使用它的类不需要知道其粘糊糊的内部细节。

```
from twisted.internet.protocol import DatagramProtocol
from twisted.internet import reactor
import threading
import time

class UdpListener(DatagramProtocol):
    message_lock = threading.Lock()
    messages = []

    def datagramReceived(self, data, (host, port)):
        with self.message_lock:
            self.messages.append(data)

    def getAndClearMessages(self):
        with self.message_lock:
            res = self.messages
            self.messages = []
        return res

class Messenger(threading.Thread):

    listener = None

    def __init__(self):
        threading.Thread.__init__(self)

    def run(self):
        while True:
            time.sleep(1)
            recivedMessages = self.listener.getAndClearMessages()
            length = len(recivedMessages)
            #doSomethingWithMessages(recivedMessages)
            print(length)

listener = UdpListener()

messenger = Messenger()
messenger.listener = listener
messenger.start()

reactor.listenUDP(5556, listener)
reactor.run() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-04T17:10:44.947

为什么不使用 DeferredQueue 来实现这一点，这正是为此目的。如果您希望使用线程，则需要格外小心。

这是一个带有 DeferredQueue 的示例，允许线程：

```
class UdpListener(DatagramProtocol):

    def __init__(self)
        self._messages = DeferredQueue()

    def datagramReceived(self, data, (host, port)):
        self._messages.put(message)

    @inlineCallbacks
    def _wait_for_and_process_next_message(self):

        # Get message from queue through a deferred call from the DeferredQueue
        # Here we use @inlineCallbacks, so we assign the result from yield 
        # which is the new message, and will "block" (actually releasing control to Twisted) until a message gets in
        message = yield self._message_queue.get()

        # Do something with your message here, and ensure you catch any exceptions!
        # If your message processing may be long, you may wish to run it in another thread,
        # and because of @inlineCallbacks, this call will "block" until your function finishes.
        # In case you did this, ensure you read the notes below.
        yield threads.deferToThread(my_long_function, message)

        # Schedule an immediate call to this method again in order to process next message
        self.wait_for_and_process_next_message()

    def wait_for_and_process_next_message(self):
        reactor.callLater(0, self._wait_for_and_process_next_message)

    def initialize(self):
        # Call this during your application bootstrapping, so you start processing messages
        self.wait_for_and_process_next_message() 
```

请务必注意，如果您选择将消息处理推迟到 Twisted 线程池（使用`threads.deferToThread`），您的代码将在不同的线程中运行。您可能会响应来自不同线程的消息，并且在 Twisted 中，协议不是线程安全对象 ( [http://twistedmatrix.com/documents/13.2.0/core/howto/threading.html#auto0](http://twistedmatrix.com/documents/13.2.0/core/howto/threading.html#auto0) )。

对于这种情况，您将使用它`reactor.callFromThread()`来保护关键资源`transport`，如下例所示：

```
def _send_message_critical_section(self, message):
    self.transport.write(message, (self.host, self.port))

def send_message(self, message):
    reactor.callFromThread(self._send_message_critical_section, message) 
```

完成的其他更改：

*   `messages`将变量重命名为`_messages`，因为它应该被认为是完全私有的。
*   `_messages`将初始化移动到`__init__()`方法内部并分配给`self._messages`，否则消息列表将在所有实例之间共享！我猜你只有一个类的实例但是......（[类 __init__() 函数内部和外部的变量](https://stackoverflow.com/questions/1537202/variables-inside-and-outside-of-a-class-init-function)）

# php - mysql查询中双引号和单引号有什么区别

> ID：11369849
> 
> 赞同：1
> 
> 时间：2012-07-06T21:25:47.620
> 
> 标签：php, mysql

我发现了问题，现在我的插入查询有效，但我不明白为什么。这是我当前的工作查询：

```
$add_movie = mysql_query("INSERT INTO ownedmovies VALUES ('', '{$movie_data['Title']}',
    '{$movie_data['Year']}', '{$movie_data['Rated']}', '{$movie_data['Runtime']}',
    '{$movie_data['Genre']}', '{$movie_data['Director']}', '{$movie_data['Writer']}',
    '{$movie_data['Actors']}', \"{$movie_data['Plot']}\", '{$movie_data['imdbRating']}')"); 
```

请注意，我在绘图字段周围使用了双引号，而在其他所有内容周围使用了正常。当我以与其他人相同的方式制作绘图字段时，它不会出错，但不会将任何内容插入表中......现在它可以完美运行。

谁能告诉我这是为什么？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T21:29:23.877

我怀疑您的情节字符串包含单引号。为避免该问题，您应该使用 转义字符串值[`mysql_real_escape_string`](http://php.net/manual/en/function.mysql-real-escape-string.php)，或者（更好地）使用参数化查询。

在这种情况下，您将单引号更改为双引号的“解决方案”似乎可行，但如果绘图字符串包含双引号，它将失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T21:39:48.553

在 MySQL 查询中使用双引号时要小心 - 根据 MySQL 运行的 SQL 模式，它们具有不同的含义。

```
select "fred" from table 
```

在 ANSI_QUOTE 模式下将返回列 fred 的值，否则将返回字面值*fred*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-06T21:30:43.433

在 PHP 中，双引号将解析它旁边的变量，其中的单引号将只是字符串中的单引号。

要将 varchar 参数传递给 mysql，它们需要用引号括起来，因此单引号将作为 varchar 参数传递给 mysql。

您的 php 变量在双引号内进行解析，并且 sql 字符串将包含您在变量中传递的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-06T21:27:13.977

双引号和单引号一起使用以防止程序混淆查询结束的位置。

例如查询

```
 ("Select 'name' From 'contacts'") 
```

如果您使用所有双引号，那么它看起来像这样

```
 ("Select "name" From "contacts"") 
```

并且可以让程序认为实际查询是“选择”

我认为就是这样。

# java - 取出一个对象并导出到它的类之外

> ID：11369850
> 
> 赞同：1
> 
> 时间：2012-07-06T21:25:55.890
> 
> 标签：java

我有这个类，我想将在其中`httpdStatistics stats`创建的对象导出到它的外部（到另一个类）。这可能是最好的方法？

```
package org.w3c.jigsaw.status ;

import java.util.Date;

import org.w3c.tools.resources.Attribute;
import org.w3c.tools.resources.AttributeHolder;
import org.w3c.tools.resources.AttributeRegistry;
import org.w3c.tools.resources.FramedResource;
import org.w3c.tools.resources.IntegerAttribute;
import org.w3c.tools.resources.Resource;

import org.w3c.tools.resources.store.ResourceStoreManager;

import org.w3c.www.http.HTTP;
import org.w3c.www.http.HttpMessage;

import org.w3c.jigsaw.frames.HTTPFrame;

import org.w3c.jigsaw.http.Reply;
import org.w3c.jigsaw.http.Request;
import org.w3c.jigsaw.http.httpd;
import org.w3c.jigsaw.http.httpdStatistics;

import org.w3c.jigsaw.html.HtmlGenerator;

/**
 * This class exports the server statistics.
 * It makes available a bunch of various parameters about the current
 * server, and uses the Refresh meta-tag (as the ThreadStat) to 
 * make them redisplay.
 * <p>This would benefit from being an applet.
 */

public class StatisticsFrame extends HTTPFrame {
    private static int REFRESH_DEFAULT = 5;

    /**
     * Attribute index - Our refresh interval.
     */
    protected static int ATTR_REFRESH = -1 ;

    static {
    Attribute a   = null ;
    Class     cls = null ;
    try {
        cls = Class.forName("org.w3c.jigsaw.status.StatisticsFrame");
    } catch (Exception ex) {
        ex.printStackTrace() ;
        System.exit(1) ;
    }
    // The refresh interval attribute:
    a = new IntegerAttribute("refresh"
                 , new Integer(5)
                 , Attribute.EDITABLE) ;
    ATTR_REFRESH = AttributeRegistry.registerAttribute(cls, a) ;
    }

    static String time_tbl = ("<table border=\"1\" class=\"time\">"
                  + "<caption>Request processing times"
                  + "</caption><tr>"
                  + "<th>min"
                  + "<th>avg"
                  + "<th>max"
                  + "</tr><tr>") ;

    static String dyn_time_tbl = ("<table border=\"1\" class=\"time\">"
                  + "<caption>Dynamic request processing times"
                  + "</caption><tr>"
                  + "<th>min"
                  + "<th>avg"
                  + "<th>max"
                  + "</tr><tr>") ;

    static String sta_time_tbl = ("<table border=\"1\" class=\"time\">"
                  + "<caption>Static request processing times"
                  + "</caption><tr>"
                  + "<th>min"
                  + "<th>avg"
                  + "<th>max"
                  + "</tr><tr>") ;

    public void registerResource(FramedResource resource) {
    super.registerOtherResource(resource);
    }

    /**
     * Get the current set of statistics.
     * Display the collected statistics in an HTML table.
     * @param request The request to process.
     */

    public Reply get (Request request) {
    HtmlGenerator g = new HtmlGenerator("Statistics") ;
    int refresh = getInt(ATTR_REFRESH, REFRESH_DEFAULT);
    if (refresh > 0) {
        g.addMeta("Refresh", Integer.toString(refresh));
    }
    addStyleSheet(g);
    // Dump the statistics:
    httpdStatistics stats = ((httpd)getServer()).getStatistics() ;
    // Uptime:
    g.append("<h1>Server Statistics</h1>");
    long start_time = stats.getStartTime();
    long uptime     = (System.currentTimeMillis() - start_time) / 1000;
    g.append("<p>Your server was started on <span class=\"date\">");
    g.append(new Date(start_time).toString());
    long duptime = uptime / (3600L*24L);
    long htemp   = uptime % (3600L*24L);
    long huptime = htemp / 3600L;
    long mtemp   = htemp % 3600L;
    long muptime = mtemp / 60L;
    long suptime = mtemp % 60L;
    g.append("</span>\n<p>It has now been running for <span "+
         "class=\"uptime\">");
    g.append(Long.toString(duptime));
    g.append(" days, ");
    g.append(Long.toString(huptime));
    g.append(" hours, ");
    g.append(Long.toString(muptime));
    g.append(" minutes and ");
    g.append(Long.toString(suptime));
    g.append(" seconds.</span>\n");
    // Hits and bytes:
    long  nb_hits      = stats.getHitCount();
    long  dyn_hits     = stats.getDynamicHitCount();
    long  static_hits  = stats.getStaticHitCount();
    float static_pcent = 0;
    float dyn_pcent    = 0;
    if (nb_hits > 0) {
        static_pcent = ((float) static_hits / (float) nb_hits) * 100;
        dyn_pcent = ((float) dyn_hits / (float) nb_hits) * 100;
    }
    g.append("<ul><li>hits: ", Long.toString(nb_hits));
    g.append("  <ul>\n    <li>static: ",Long.toString(static_hits));
    g.append(" (", Float.toString(static_pcent));
    g.append("%)</li>\n    <li>dynamic: ", Long.toString(dyn_hits));
    g.append(" (", Float.toString(dyn_pcent));
    g.append("%)</li>\n  </ul>\n");
    long bytes = stats.getEmittedBytes();
    long kbytes = bytes / 1024;
    long mbytes = kbytes / 1024;
    long gbytes = mbytes / 1024;
        long tbytes = gbytes / 1024;
    if (tbytes != 0) {
        g.append("</li>\n<li>bytes: ", Long.toString( tbytes),"TB, ");
        g.append(Long.toString(gbytes % 1024), "GB, ");
        g.append(Long.toString(mbytes % 1024), "MB, ");
        g.append(Long.toString(kbytes % 1024), "KB, ");
        g.append(Long.toString(bytes % 1024));
    } else if (gbytes != 0) {
        g.append("</li>\n<li>bytes: ", Long.toString(gbytes), "GB, ");
        g.append(Long.toString(mbytes % 1024), "MB, ");
        g.append(Long.toString(kbytes % 1024), "KB, ");
        g.append(Long.toString(bytes % 1024));
    } else if (mbytes != 0) {
        g.append("</li>\n<li>bytes: ", Long.toString(mbytes), "MB, ");
        g.append(Long.toString(kbytes % 1024), "KB, ");
        g.append(Long.toString(bytes % 1024));
    } else if (kbytes != 0) {
        g.append("</li>\n<li>bytes: ", Long.toString(kbytes), "KB, ");
        g.append(Long.toString(bytes % 1024));
    } else {
        g.append("</li>\n<li>bytes: ", Long.toString(bytes));
    }
    // avg hit/sec
    float avghits = 0;
    float avghitsday = 0;
    if (uptime > 0) {
        avghits = ((float) nb_hits) / ((float) uptime);
        avghitsday = ((float) nb_hits * 86400) / ((float) uptime); 
    }
    g.append("</li>\n<li>Average hits per second: ");
    g.append(Float.toString(avghits));
    g.append("</li>\n<li>Average hits per day: ");
    g.append(Integer.toString((int) avghitsday));
    // avg bytes/hit
    long avgbph;

    if (nb_hits > 0) {
        avgbph = bytes / nb_hits;
    } else {
        avgbph = 0;
    }
    kbytes = avgbph / 1024;
    mbytes = kbytes / 1024;
    gbytes = mbytes / 1024;
    if (gbytes != 0) {
        g.append("</li>\n<li>Average bytes per hit: ");
        g.append(Long.toString(gbytes), "GB, ");
        g.append(Long.toString(mbytes % 1024), "MB, ");
        g.append(Long.toString(kbytes % 1024), "KB, ");
        g.append(Long.toString(avgbph % 1024));
    } else if (mbytes != 0) {
        g.append("</li>\n<li>Average bytes per hit: ");
        g.append(Long.toString(mbytes), "MB, ");
        g.append(Long.toString(kbytes % 1024), "KB, ");
        g.append(Long.toString(avgbph % 1024));     
    } else if (kbytes != 0) {
        g.append("</li>\n<li>Average bytes per hit: ");
        g.append(Long.toString(kbytes), "KB, ");
        g.append(Long.toString(avgbph % 1024));
    } else {
        g.append("</li>\n<li>Average bytes per hit: ",
             Long.toString(avgbph));
    }
    // avg throughput
    long avgbps = 0;
    if (uptime > 0) {
        avgbps = bytes / uptime;
    }
    kbytes = avgbps / 1024;
    mbytes = kbytes / 1024;
    gbytes = mbytes / 1024;
    if (gbytes != 0) {
        g.append("</li>\n<li>Average bytes per second: ");
        g.append(Long.toString(gbytes),  "GB, ");
        g.append(Long.toString(mbytes % 1024), "MB, ");
        g.append(Long.toString(kbytes % 1024), "KB, ");
        g.append(Long.toString(avgbps % 1024));
    } else if (mbytes != 0) {
        g.append("</li>\n<li>Average bytes per second: ");
        g.append(Long.toString(mbytes), "MB, ");
        g.append(Long.toString(kbytes % 1024), "KB, ");
        g.append(Long.toString(avgbps % 1024));
    } else if (kbytes != 0) {
        g.append("</li>\n<li>Average bytes per second: ");
        g.append(Long.toString(kbytes), "KB, ");
        g.append(Long.toString(avgbps % 1024));
    } else {
        g.append("</li>\n<li>Average bytes per second: ", 
             Long.toString(avgbps));
    }    
    g.append("</li>\n</ul>");
    // Request times:
    g.append(time_tbl) ;
    g.append("<td>"
         , Long.toString(stats.getMinRequestTime())
         , " <span class=\"unit\">ms</span>") ;
    g.append("</td>\n<td>"
         , Long.toString(stats.getMeanRequestTime())
         , " <span class=\"unit\">ms</span>") ;
    g.append("</td>\n<td>"
         , Long.toString(stats.getMaxRequestTime())
         , " <span class=\"unit\">ms</span>") ;
    g.append("</td>\n</table>\n") ;

    // static
    if (static_hits>0) {
        g.append(sta_time_tbl) ;
        g.append("<td>"
             , Long.toString(stats.getMinStaticRequestTime())
             , " <span class=\"unit\">ms</span>") ;
        g.append("</td>\n<td>"
             , Long.toString(stats.getMeanStaticRequestTime())
             , " <span class=\"unit\">ms</span>") ;
        g.append("</td>\n<td>"
             , Long.toString(stats.getMaxStaticRequestTime())
             , " <span class=\"unit\">ms</span>") ;
        g.append("</td>\n</table>\n") ;
    }

    // dynamic 
    if (dyn_hits>0) {
        g.append(dyn_time_tbl) ;
        g.append("<td>"
             , Long.toString(stats.getMinDynamicRequestTime())
             , " <span class=\"unit\">ms</span>") ;
        g.append("</td>\n<td>"
             , Long.toString(stats.getMeanDynamicRequestTime())
             , " <span class=\"unit\">ms</span>") ;
        g.append("</td>\n<td>"
             , Long.toString(stats.getMaxDynamicRequestTime())
             , " <span class=\"unit\">ms</span>") ;
        g.append("</td>\n</table>\n") ;
    }

    // Get Server internal Stats
    try {
        g.append(((httpd)getServer()).getHTMLStatus());
    } catch (Exception ex) {
        ex.printStackTrace();
    }
    Reply reply = request.makeReply(HTTP.OK) ;
    reply.setNoCache();
    reply.setStream (g) ;
    reply.setDynamic(true);
    return reply ;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:34:04.063

现在看起来您已经将所有数据提取`httpdStatistics`到一个`HtmlGenerator`对象中，然后使用它来构建一个`Reply`. 您还想让`httpdStatistics`对象本身可以从此类外部访问，对吗？

我不知道里面会发生什么`getServer().getStatistics()`，但你能添加一个“getter”方法来返回它吗？然后你也可以在内部使用getter `get()`，以避免代码重复。就像是：

```
public httpdStatistics getStats() {
  return ((httpd)getServer()).getStatistics();
} 
```

并在`get()`：

```
httpdStatistics stats = getStats(); 
```

# objective-c - 在 UIView 中定位最近的开放空间

> ID：11369853
> 
> 赞同：0
> 
> 时间：2012-07-06T21:26:08.767
> 
> 标签：objective-c, ios, algorithm, cocoa-touch, coordinates

我有一个用户可以添加子视图的 UIView。我现在需要应用程序在第一个找到的打开位置为用户自动放置一个子视图。

如果要放置的子视图的框架不与任何其他子视图相交，则该位置被认为是打开的。

定位这个开放区域的计算不需要是即时的 - 它会在用户第一次进入场景时运行，此时它会保存该位置，就好像它是放置它的用户一样。

容器 UIView 将足够大，以始终有一个开放空间来放置子视图（用户可以添加的子视图数量有限）。

确定放置子视图的位置的最简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:30:41.477

不太确定是否存在这样做的内置方法。但是您可以运行迭代循环并获取容器视图内所有视图的边界。根据读数，您将不得不计算开放空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:59:10.097

我在回答这个问题时发布了对通常用于解决这类问题的算法的描述：[Finding Largest Rectangle in 2D Array](https://stackoverflow.com/questions/5931735/finding-largest-rectangle-in-2d-array/5932031#5932031)。使该解决方案适应您的问题相当容易。在那个问题中，填充的空间是在一个网格上，这使得确定前进扫描线的量更容易一些，你必须更加小心。另外另一个问题是寻找具有最大面积的空矩形，一旦找到第一个拟合，您就可以尽早退出算法。

当然，如果您所有的子视图大小相同，则解决方案几乎相同。

希望这可以帮助。

# asp.net-mvc-3 - 使 MVCContrib-generated-column-names 进行 ajax 调用

> ID：11369855
> 
> 赞同：2
> 
> 时间：2012-07-06T21:26:22.883
> 
> 标签：asp.net-mvc-3, mvccontrib, mvccontrib-grid

这听起来像一个简单的问题，但我整个下午都在努力解决这个问题。我正在尝试在 PartialView 中放置一个带有分页、排序和所有内容的网格。我的第一个问题是寻呼机链接：它们没有我的过滤器选项，因为它不在页面查询字符串上。我就是这样解决的：

```
public class PaginationContainer
{
    public IPagination PaginatedResult { get; set; }
    public RouteValueDictionary RouteValueDictionary { get; set; } 
} 
```

我创建了这个类，然后由我的寻呼机使用：

```
@using MvcContrib.UI.Pager
@model AqxWeb.Models.PaginationContainer
@{
    string action = ViewContext.Controller.ValueProvider.GetValue("action").RawValue.ToString();
    string controller = ViewContext.Controller.ValueProvider.GetValue("controller").RawValue.ToString();
}
@functions
{
    public RouteValueDictionary GetRoute(int page)
    {
        var routeValues = new RouteValueDictionary();

        foreach (string key in Model.RouteValueDictionary.Keys)
        {
            routeValues[key] = Model.RouteValueDictionary[key];
        }
        routeValues["page"] = page;

        return routeValues;
    }   
}
<p />
<div class='pagination'>
    <span class='paginationLeft'>Mostrando @Model.PaginatedResult.FirstItem - @Model.PaginatedResult.LastItem
        de @Model.PaginatedResult.TotalItems</span> <span class='paginationRight'>
            @{
                if (Model.PaginatedResult.HasPreviousPage)
                {<text> @Html.ActionLink("Primeira", action, controller, GetRoute(1), new Dictionary<string, object> { { "class", "paging" } })
                | </text>}
                else
                {<text> Primeira | </text>}
                if (Model.PaginatedResult.HasPreviousPage)
                {<text>@Html.ActionLink("Anterior", action, controller, GetRoute(Model.PaginatedResult.PageNumber - 1), new Dictionary<string, object> { { "class", "paging" } })
                | </text>}
                else
                {<text>Anterior | </text>}
                if (Model.PaginatedResult.HasNextPage)
                {<text>@Html.ActionLink("Próxima", action, controller, GetRoute(Model.PaginatedResult.PageNumber + 1), new Dictionary<string, object> { { "class", "paging" } })
                | </text>}
                else
                {<text>Próxima | </text>}
                if (Model.PaginatedResult.HasNextPage)
                {<text>@Html.ActionLink("Última", action, controller, GetRoute(Model.PaginatedResult.TotalPages), new Dictionary<string, object> { { "class", "paging" } })</text>}
                else
                {<text>Última</text>}                                             
            }
        </span>
</div> 
```

我所要做的就是填写这本字典，我在 ActionMethod 上做的事情。

现在我需要一个类似的排序解决方案......我需要覆盖 MVCContrib 创建的表头以添加此过滤器选项并添加一个名为“分页”的类属性，这是我用来进行 ajax 调用的。唯一可以提供帮助的公开方法是`.Header(string)`for `IGridColumn<>`，老实说，它很糟糕（为了实现我的目标，我必须手动做很多事情）。所以我试图创建一个扩展方法来解决这个问题，这被证明是非常困难的，因为`.Header(string)`没有暴露：

（请忽略不好的命名）

```
public static IGridColumn<T> Ajaxify(this IGridColumn<T> column, string columnName, string className, RouteValueDictionary routeValueDictionary)
{
    string newDecoration = "<td> <a href="+GetRoute(routeValueDictionary)+"class=\""+className+"\">"+ columnName + "</a></td>";
     return column.Header(newDecoration);
} 
```

我认为我在这里的意图很干净，但是这种方法行不通，因为不知何故我无法访问该`.Header(string)`方法。有任何想法吗？

# wpf - WPF 如何调用 rendertransform 或触发触发器

> ID：11369858
> 
> 赞同：2
> 
> 时间：2012-07-06T21:26:43.500
> 
> 标签：wpf

在我的按钮的控件模板中，我有一个 IsPressed 触发器，可以将按钮向下和向右移动。当实际单击按钮时，这一切都很好。现在我涉及到我的另一个问题： [WPF Button IsPressed and Accelerator Key Trigger](https://stackoverflow.com/questions/11306030/wpf-button-ispressed-and-accelerator-key-trigger)

当用户按下一个键时，我希望我的按钮也受到相同的 RenderTransform 的影响。我可以触发触发器还是以某种方式将新的或现有的转换应用于按钮？

```
 <Trigger Property="Button.IsPressed" Value="true">
    <Setter TargetName="buttonBorder" Property="RenderTransform" >
        <Setter.Value>
            <TranslateTransform Y="1.0" X="1.0" />
        </Setter.Value>
    </Setter>
</Trigger> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-15T18:02:19.353

> 当用户按下一个键时，我也想让我的按钮受到影响

将翻译操作移动到故事板中，也可以通过按键执行。更改触发器以改为调用该故事板。

```
<Trigger Property="Button.IsPressed" Value="true">
   <BeginStoryboard Storyboard="{StaticResource buttonBorderChange}"/>
</Trigger> 
```

# antlr - 做什么 | 表示当 antlr 中没有右侧时

> ID：11369861
> 
> 赞同：1
> 
> 时间：2012-07-06T21:26:52.753
> 
> 标签：antlr, antlr3

我今天在 antlr 语法中看到了这一点，但不确定它是什么意思。我希望谷歌能让我搜索字符...

结果列表：（星|属性列表|）-> ^（结果属性列表？星？）；

注意第二个“|” 角色没有右侧元素？这意味着什么？

谢谢，院长

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-07T05:19:58.100

它只是意味着它不匹配任何内容。以下稍微详细一点的规则完全相同：

```
resultList
 : STAR          -> ^(RESULT STAR)
 | attributeList -> ^(RESULT attributeList)
 | /* nothing */ -> RESULT
 ; 
```

我认为上面的版本更清晰，并且以后也更容易评估，因为没有两个可选的子节点，`attributeList`并且`STAR`您需要检查它们的存在。

# django - Django 多对多查询集 AND 而不是 OR

> ID：11369862
> 
> 赞同：-1
> 
> 时间：2012-07-06T21:27:00.137
> 
> 标签：django

我有以下查询：

```
things = Thing.objects.filter(tags__in=selected_tags).distinct() 
```

如果 selected_tags 看起来像这样：

```
selected_tags = [<Tag: tag1>, <Tag: tag2>] 
```

那么事物将包含任何具有 tag1 或 tag2 的事物。

我想要一个查询，它给我的东西有 tag1 和 tag2（甚至可能是 tag3，但不一定）。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T22:09:11.817

`__in`本质上是基于 OR 的。它的字面意思是拉出任何具有这些标签中的任何一个的行。要创建基于 AND 的查询，您需要单独过滤每个标签：

```
Thing.objects.filter(tags=tag1, tags=tag2, ...) 
```

这显然不理想，不幸的是，在这种情况下您甚至不能使用扩展字典，因为所有键都是相同的。因此，您唯一的其他选择是使用`Q`：

```
from django.db.models import Q

query = None
for tag in tags:
    if query is None:
        query = Q(tags=tag)
    else:
        query &= Q(tags=tag)

things = Thing.objects.filter(query) 
```

这有点令人费解，但如果您需要动态创建查询（而不是仅仅硬编码您要搜索的每个标签），那么这是您最好的选择。

# javascript - 基于正/负和位置添加类

> ID：11369863
> 
> 赞同：-2
> 
> 时间：2012-07-06T21:27:01.230
> 
> 标签：javascript, jquery, html, css

我正在尝试找到一种方法，根据 td 是正面还是负面，而不是在第一个或不在 a 的第一个内，将一个类添加到`<tr>`td`<td>`中`<tr>`。

通过搜索，我在这两个问题上都找不到太多。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:41:13.150

你的意思是如果`<td>`包含一个正数或负数？如果这就是你想要做的，你可以使用这个：

```
$(document).ready(function() {
    $("tr:not(:first)").find("td:not(:first)").each(function() {
        if ($(this).text() > 0)
            $(this).addClass("positive");
        else if ($(this).text() < 0)
            $(this).addClass("negative");
    })
}); 
```

我在下表中对此进行了测试，效果很好：

```
<table>
    <tr>
        <td>3</td>
        <td>9</td>
        <td>-3</td>
    </tr>
    <tr>
        <td>8</td>
        <td>-4</td>
        <td>9</td>
    </tr>
    <tr>
        <td>-7</td>
        <td>12</td>
        <td>144</td>
    </tr>
</table> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T21:31:39.580

你可以使用[`nth-child selector`](http://api.jquery.com/nth-child-selector/)：

```
 $('td:not(:first):nth-child(2n)').addClass('class') 
```

# eclipse - Tycho 测试因 java.lang.NoClassDefFoundError 失败：junit/framework/AssertionFailedError

> ID：11369864
> 
> 赞同：2
> 
> 时间：2012-07-06T21:27:07.730
> 
> 标签：eclipse, maven, junit, junit4, tycho

我完全被这个弄糊涂了。据我了解，它**应该可以**工作，但我不知道为什么。

我有一个 tycho 构建，它只在 eclipse 工作台中运行一些测试。但是，我的所有测试都因这种异常而失败：

```
java.lang.NoClassDefFoundError: junit/framework/AssertionFailedError
at org.grails.ide.eclipse.commands.test.AbstractCommandTest.tearDown(AbstractCommandTest.java:112)
at junit.framework.TestCase.runBare(TestCase.java:140)
at junit.framework.TestResult$1.protect(TestResult.java:110)
at junit.framework.TestResult.runProtected(TestResult.java:128)
at junit.framework.TestResult.run(TestResult.java:113)
at junit.framework.TestCase.run(TestCase.java:124)
at junit.framework.TestSuite.runTest(TestSuite.java:243)
at junit.framework.TestSuite.run(TestSuite.java:238)
at junit.framework.TestSuite.runTest(TestSuite.java:243)
at junit.framework.TestSuite.run(TestSuite.java:238)
at org.springsource.ide.eclipse.commons.tests.util.ManagedTestSuite.run(ManagedTestSuite.java:231)
at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:83)
at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:53)
at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:123)
at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:104)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:164)
at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:110)
at org.apache.maven.surefire.booter.SurefireStarter.invokeProvider(SurefireStarter.java:175)
at org.apache.maven.surefire.booter.SurefireStarter.runSuitesInProcess(SurefireStarter.java:123)
at org.eclipse.tycho.surefire.osgibooter.OsgiSurefireBooter.run(OsgiSurefireBooter.java:84)
at org.eclipse.tycho.surefire.osgibooter.AbstractUITestApplication$1.run(AbstractUITestApplication.java:35)
at org.eclipse.swt.widgets.RunnableLock.run(RunnableLock.java:35)
at org.eclipse.swt.widgets.Synchronizer.runAsyncMessages(Synchronizer.java:135)
at org.eclipse.swt.widgets.Display.runAsyncMessages(Display.java:3529)
at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3182)
at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine$9.run(PartRenderingEngine.java:1022)
at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
at org.eclipse.e4.ui.internal.workbench.swt.PartRenderingEngine.run(PartRenderingEngine.java:916)
at org.eclipse.e4.ui.internal.workbench.E4Workbench.createAndRunUI(E4Workbench.java:86)
at org.eclipse.ui.internal.Workbench$5.run(Workbench.java:585)
at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:540)
at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:124)
at org.eclipse.tycho.surefire.osgibooter.UITestApplication.runApplication(UITestApplication.java:31)
at org.eclipse.tycho.surefire.osgibooter.AbstractUITestApplication.run(AbstractUITestApplication.java:114)
at org.eclipse.tycho.surefire.osgibooter.UITestApplication.start(UITestApplication.java:37)
at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:353)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:180)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:629)
at org.eclipse.equinox.launcher.Main.basicRun(Main.java:584)
at org.eclipse.equinox.launcher.Main.run(Main.java:1438)
at org.eclipse.equinox.launcher.Main.main(Main.java:1414)

Caused by: java.lang.ClassNotFoundException: junit.framework.AssertionFailedError
at org.eclipse.osgi.internal.loader.BundleLoader.findClassInternal(BundleLoader.java:501)
at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:421)
at org.eclipse.osgi.internal.loader.BundleLoader.findClass(BundleLoader.java:412)
at org.eclipse.osgi.internal.baseadaptor.DefaultClassLoader.loadClass(DefaultClassLoader.java:107)
at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
... 54 more 
```

这对我来说没有意义。 `org.junit`并且`org.junit4`是运行测试的包以及包含`AbstractCommandTest`. 这些测试在我的工作空间内运行时通过了，那么为什么 maven/tycho 无法加载 junit 类？

如果有帮助，我很乐意提供更多信息，例如指向 github 存储库的链接。

* * *

编辑：提供更多细节

github 仓库在这里：[https ://github.com/grails/grails-sts-tests](https://github.com/grails/grails-sts-tests)

你可以看到它是一个简单的、单一的插件，只运行一些测试。测试套件由来自指定为依赖项的其他存储库中的插件的测试组成。请注意，位于其他存储库中的测试插件在另一个 CI 服务器上运行，并且没有 NoClassDefFoundError 问题。我查看了其他 CI 服务器并没有发现任何不同（不幸的是，此 CI 服务器不可公开访问，因此我无法共享指向它的链接）。

显示问题的 hudson 构建作业在这里：[http ://hudson.grails.org/job/grails-sts-tests-2.0.x/17/console](http://hudson.grails.org/job/grails-sts-tests-2.0.x/17/console)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:25:36.983

我们遇到了非常相似的问题。原因是 junit 框架试图创建和使用自定义类加载器，而这与 eclipse 插件类加载器不兼容。我们现在遵循一些使用 Tycho 运行单元测试的指南。

1.  您的单元测试位于插件片段中。单元测试片段依赖于 JUnit。
2.  你的 pom 应该关闭单元测试的系统类加载器的使用。这就是导致junit测试类丢失的原因。
3.  然后您使用与标准插件相同的包装（确切地说是eclipse-plugin）。

所以一个简单的 POM（对我们来说）看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<project
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"
xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <modelVersion>4.0.0</modelVersion>
  <parent>
    <artifactId>master</artifactId>
    <groupId>mgws</groupId>
    <version>0.0.1-SNAPSHOT</version>
    <relativePath>../../mgws/build-environment/pom.xml</relativePath>
  </parent>
  <groupId>mgws</groupId>
  <artifactId>mgws.spectral.test</artifactId>
  <version>1.0.0-SNAPSHOT</version>
  <packaging>eclipse-plugin</packaging>
  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-surefire-plugin</artifactId>
        <version>2.12</version>
        <executions>
          <execution>
            <id>JUnitTest</id>
            <goals>
              <goal>test</goal>
            </goals>
            <phase>install</phase>
            <configuration>
              <useSystemClassLoader>false</useSystemClassLoader>
            </configuration>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>
</project> 
```

这使得单元测试框架使用 eclipse 插件类加载器，现在它可以找到所有的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T05:48:59.937

仍然没有人能够回答这个问题，但感谢您提供的信息，即使它没有直接有用。

我已经取得了一些进展。现在，我的 60 个测试中有 45 个通过了。我只是在 tycho-surefire-pluign 配置区域中添加了一些额外的依赖项：

```
 <dependencies>
                    <dependency>
                        <type>p2-installable-unit</type>
                        <artifactId>org.junit</artifactId>
                        <version>0.0.0</version>
                    </dependency>
                    ...
                </dependencies> 
```

不幸的是，其余的测试仍然以相同的`NoClassDefFoundError`. 我可能需要添加更多依赖项，一切都会正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-09T15:33:13.803

我会做的检查：

1.  检查 NoClassDefFoundError 的原因。最常见的原因有多种，例如 UnSupportedClassVersionError 和 ExceptionINinitializationError。
2.  使用 JVM 选项`-verbose:class`来获取类加载日志并检查类是否从所需类的预期工件中加载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-10T16:15:44.763

我在一个依赖于几个 3rd 方 jar 的 Android 项目上运行 junit 测试时遇到了类似的问题，问题最终是其中一个依赖 jar 是用 jdk v1.5 构建的，其他的都是 1.6。我将一个库更新为使用 1.6 构建的较新版本，然后错误消失了。

不知道是不是同样的问题，或者您是否可以配置 tycho 或更新它，但它可能值得一看.....

# ruby-on-rails-3 - ActiveRecord where 方法

> ID：11369873
> 
> 赞同：0
> 
> 时间：2012-07-06T21:27:43.407
> 
> 标签：ruby-on-rails-3, activerecord, where

我有一个带有属性汽车的模型样本

car 是具有不同汽车名称的 CSV

```
x.car = "BMW,Ferrari,AUDI"
Sample.where(:car => "BMW") 
```

返回 []。

如何将它用作 SQL 中的 like 运算符，以便它返回 x

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:34:12.207

在你的 where 方法中使用这样的条件（就像准备好的查询一样工作）。

```
Sample.where("car LIKE ?", "BMW%") 
```

更多示例可以在[rails guide](http://guides.rubyonrails.org/active_record_querying.html)中找到。

# sql-server - 计算每一行的出现次数并更新到新列

> ID：11369876
> 
> 赞同：-1
> 
> 时间：2012-07-06T21:28:18.170
> 
> 标签：sql-server, tsql

我有这张桌子：![在此处输入图像描述](../Images/5fae80636411bdce5808fb70f789f4a8.png)

我需要在 CloseTime 列中计算同一行的出现次数，并在最后一列 Count 中使用 Item 和同一帐户的 where 子句写入出现次数。

我对具体项目和帐户的单一选择是

```
SELECT CloseTime, COUNT(*) AS CloseTime
FROM Statement 
WHERE Account = 2013169 AND item = 'eurusd'
GROUP BY CloseTime
HAVING COUNT(*) > 1
ORDER BY COUNT(*) DESC 
```

可以计入一个更新查询吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:48:58.847

根据您的用例，这可能不是一个好主意。您最好将“计数”创建为计算列，或者将其完全从基表中移除并创建一个包含计数列的视图。此外，我通常会避免尝试使用名称也是保留字的列，例如 Count。

但是，如果您真的想这样做，您可以在一个查询中完成。只是为了确保我们在同一页面上，我相信您试图仅按关闭时间分组，并且帐户和项目不会包含在分组中（因此，如果相同的关闭时间和不同的项目将被计算在内） ，但希望能够仅更新目标帐户和项目。

在这种情况下，它看起来大致像

```
with cte1 as 
(select 
closetime, COUNT(*) as numCount
from dbo.[statement]
group by closetime)

update dbo.[statement]
set [count] = cte1.numCount
from  dbo.[statement] as sd
join cte1 
    on sd.closetime = cte1.closetime
where
    sd.account = <your account num>
    and sd.item = <your item> 
```

* * *

编辑：

如果我从评论中正确理解了您想要的内容，那么您可以使用如下查询：

```
with cte1 as 
(select 
closetime, COUNT(*) as numCount
from dbo.[statement]
group by closetime)

select sd.*, --I normally  would advise not using * in production
cte1.numCount as [Count]
from statement as sd
join cte1
   on sd.closetime = cte1.closetime
where
        sd.account = <your account num>
        and sd.item = <your item> 
```

虽然这确实使用了 CTE，但它是一条 SQL 语句，将在关闭时间显示所选帐户编号和项目的计数。

# django - 使用 djangorestframework 的 HTTPS PUT 请求

> ID：11369881
> 
> 赞同：4
> 
> 时间：2012-07-06T21:28:58.510
> 
> 标签：django, django-rest-framework

我正在尝试使用 djangorestframework（DRF：[http](http://django-rest-framework.org/) ://django-rest-framework.org/ ）视图向 RESTful API Django Web 服务发送 HTTPS PUT 请求。由于 Django 的跨站点请求伪造 (CSRF) 保护，我无法让它工作。

PUT 请求旨在允许未经身份验证的用户添加资源。

我考虑过/尝试过的：

1.  禁用 CSRF——不可接受。API 与非 API 服务在同一个 Django 实例上运行。禁用 CSRF 保护风险太大。
2.  使用`X-Requested-With: XMLHttpRequest`PUT 请求的标头（我控制客户端）。不起作用 - 我仍然收到 CSRF 错误。
3.  在 PUT 视图上使用`@crsf_exempt`装饰器。如果可以的话，我会的——框架定义了一个类，而不是一个视图。

我目前最好的选择是自己编写 PUT 视图，而不使用 DRF 的 View 类。然后我可以`@crsf_exempt`成功使用装饰器。

我想使用 DRF 的 View 类——但看不到如何使用。你可以吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-15T03:31:26.773

感谢 James Cran Wellward，我还能够通过使用 method_decorator 来解决这个问题。

```
class ExampleView(ResponseMixin,View):
  renderers=DEFAULT_RENDERERS
  def get(self,request):
    response=Response(200,{'msg':'called via GET'})
    return self.render(response)
  def post(self,request):
    response=Response(200,{'msg':'called via POST'})
    return self.render(response)
  @method_decorator(csrf_exempt):
  def dispatch(self,*args,**kwargs):
    return super(EampleView,self).dispatch(*args,**kwargs) 
```

然后测试它：

```
curl -X GET http://www.example.com/rest/exampleview/ 
```

返回：

```
{msg: 'called via GET'} 
```

和

```
curl -X POST http://www.example.com/rest/exampleview/ 
```

返回：

```
{msg: 'called via POST'} 
```

HTH。见[原帖](https://groups.google.com/forum/?fromgroups#!topic/django-rest-framework/JCf4MwNtfwM)。

# java - Android AndEngine 游戏未运行

> ID：11369884
> 
> 赞同：0
> 
> 时间：2012-07-06T21:29:15.660
> 
> 标签：java, android, andengine

我是android游戏新手，我正在使用andEngine制作android游戏我刚刚使用andEngine制作了一个示例，但问题是当我在模拟器上运行我的应用程序时应用程序没有运行我不知道为什么我什至在模拟器上启用了GPU仿真但我的应用程序不起作用。

我已经制作了 .apk 文件以在真实设备中安装游戏，但仍然存在同样的问题应用程序未运行给出错误。帮我解决问题

我的代码，我正在使用 android API 2.3.3

```
package com.game.practice;

import org.andengine.engine.camera.Camera;
import org.andengine.engine.options.EngineOptions;
import org.andengine.engine.options.ScreenOrientation;
import org.andengine.engine.options.resolutionpolicy.RatioResolutionPolicy;
import org.andengine.entity.scene.Scene;
import org.andengine.entity.scene.background.Background;
import org.andengine.entity.util.FPSLogger;
import org.andengine.ui.activity.SimpleBaseGameActivity;

public class GamePracticeActivity extends SimpleBaseGameActivity {
    // ===========================================================
    // Constants
    // ===========================================================
    static final int CAMERA_WIDTH = 480;
    static final int CAMERA_HEIGHT = 800;

    // ===========================================================
    // Fields
    // ===========================================================

    private Camera mCamera;
    private Scene mMainScene;

    // ===========================================================
    // Constructors
    // ===========================================================

    // ===========================================================
    // Getter & Setter
    // ===========================================================

    // ===========================================================
    // Methods for/from SuperClass/Interfaces
    // ===========================================================

    @Override
    public EngineOptions onCreateEngineOptions() {
        this.mCamera = new Camera(0, 0, CAMERA_WIDTH, CAMERA_HEIGHT);

        return new EngineOptions(true, ScreenOrientation.PORTRAIT_FIXED, new RatioResolutionPolicy(CAMERA_WIDTH, CAMERA_HEIGHT), this.mCamera);
    }

    @Override
    protected void onCreateResources() {
        // TODO Auto-generated method stub

    }

    @Override
    protected Scene onCreateScene() {
        this.mEngine.registerUpdateHandler(new FPSLogger()); // logs the frame rate

        /* Create Scene and set background colour to (1, 1, 1) = white */
        this.mMainScene = new Scene();
        this.mMainScene.setBackground(new Background(1, 1, 1));

        return this.mMainScene;
    }

} 
```

LogCat 错误

![这些是我在模拟器上运行应用程序时收到的错误](../Images/d9a594bed44323745fee28a0fa6cf963.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T00:30:27.500

您使用的是最新版本的 Andengine 吗？来自github的那个？[和引擎](https://github.com/nicolasgramlich/AndEngine)

注意：AndEngine 必须使用 ADT-17 或更高版本构建！

如果您将项目从 github 导入到 Eclipse，则不需要执行 libs 文件夹的所有这些步骤，您只需要定义项目之间的依赖关系，Eclipse 将为您完成剩下的工作。

PD：你在清单中声明了 GamePracticeActivity 吗？

编辑：

为了使 Eclipse 与 Github 一起工作，您需要一个插件。我使用[EGIT](http://www.eclipse.org/egit/)。它真的很容易使用。在这里，您可以在 Andengine 的论坛上找到 Andengine 的作者谈论它的主题。[关联](http://www.andengine.org/forums/gles2/use-andengine-as-a-android-library-project-not-as-a-jar-t6142.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T22:38:01.500

你得到一个 ClassNotFoundException。您会收到此错误的原因只有几个：

1.  这个类真的不存在。如果您使用官方示例中的代码并获取此代码，请确保您拥有该库的最新版本
2.  您尚未将 andengine jar 添加到构建路径中。要解决此问题，请右键单击 Eclipse 中的 jar，然后执行 Build Path ► Add to Build Path。
3.  您的 andengine jar 不在 /libs 文件夹中。当您将 jar 添加到构建路径时会发生这种情况，但较新版本的 ADT 需要它位于 /libs 中。将其放在那里并将其重新添加到构建路径中。
4.  确保您已在正确的包中声明了该类，并在您的 AndroidManifest.xml 中提供了相应的完整限定名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T13:55:03.010

我认为您忘记为 andengine 项目添加权限。以下行适合您。

```
<uses-sdk
    android:minSdkVersion="4"
    android:targetSdkVersion="8" />

<uses-permission android:name="android.permission.WAKE_LOCK" /> 
```

# javascript - Javascript - 环绕标签后重新选择文本不起作用？所见即所得

> ID：11369885
> 
> 赞同：1
> 
> 时间：2012-07-06T21:29:18.980
> 
> 标签：javascript, html, selection, range

我想建立另一个所见即所得的编辑器。我已经有一个脚本可以在当前选择周围包装标签，即使对于 Firefox 多项选择，但在我编辑 html 后它不会重新选择范围。这怎么可能发生？

这是我的代码：

```
function wrap(tagName)
{
    var selection;
var elements = [];
var ranges = [];
var rangeCount = 0;
if (window.getSelection)
{
    selection = window.getSelection();
    if (selection.rangeCount)
    {
        rangeCount = selection.rangeCount;
        for (var i=0; i<rangeCount; i++)
        {
            ranges[i] = selection.getRangeAt(i).cloneRange();
            elements[i] = document.createElement(tagName);
            elements[i].appendChild(ranges[i].extractContents());
            ranges[i].insertNode(elements[i]);
            selection.addRange(ranges[i]);
        }
    }
}
} 
```

对不起，我来自荷兰的英语不好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T23:27:43.067

您当前的代码并不遥远，尽管对于从一个块元素（例如 a`<p>`或`<div>`）开始并以另一个块元素结束的范围，您可能会遇到不希望的行为。您缺少的基本位是您需要设置每个范围以包含包装的内容（使用`selectNode()`），并且您需要从选择中删除所有范围并在单独的步骤中将它们添加回来。

现场演示：http: [//jsfiddle.net/timdown/dmhPH/1/](http://jsfiddle.net/timdown/dmhPH/1/)

代码：

```
function wrap(tagName)
{
    var selection;
    var elements = [];
    var ranges = [];
    var rangeCount = 0;
    var frag;
    var lastChild;
    if (window.getSelection)
    {
        selection = window.getSelection();
        if (selection.rangeCount)
        {
            var i = selection.rangeCount;
            while (i--)
            {
                ranges[i] = selection.getRangeAt(i).cloneRange();
                elements[i] = document.createElement(tagName);
                elements[i].appendChild(ranges[i].extractContents());
                ranges[i].insertNode(elements[i]);
                ranges[i].selectNode(elements[i]);
            }

            // Restore ranges
            selection.removeAllRanges();
            i = ranges.length;
            while (i--)
            {
                selection.addRange(ranges[i]);
            }
        }
    }
} 
```

# linq - linq如何从var中获取值

> ID：11369889
> 
> 赞同：4
> 
> 时间：2012-07-06T21:30:04.487
> 
> 标签：linq, c#-4.0

如何从以下 LINQ 查询中获取各个值？（我想获取 DecalExpireDate、DecalExpireMonth 和 DecalExpireYear 的值。）

```
var previousExpirationDate = (from d in db.CT_Decals
                              where d.TankID == decal.TankID
                              && d.DecalStatus == "Approved"
                              select new
                              {
                                  d.DecalExpireDate,
                                  d.DecalExpireMonth,
                                  d.DecalExpireYear
                              }).Max(d => d.DecalExpireDate); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-06T21:37:24.087

我假设您想从具有最高 (last) 的元素中获取`DecalExpireDate`, `DecalExpireMonth`, and 。然后您可以在此日期之前订购：`DecalExpireYear``DecalExpireDate`

```
var latest = (from d in db.CT_Decals
             where d.TankID == decal.TankID && d.DecalStatus == "Approved"
             orderby d.DecalExpireDate descending
             select new
             {
                 d.DecalExpireDate,
                 d.DecalExpireMonth,
                 d.DecalExpireYear
              }).First();
var decalExpireDate  = latest.DecalExpireDate;
var decalExpireMonth = latest.DecalExpireMonth;
var decalExpireYear  = latest.DecalExpireYear; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:57:07.900

做出与蒂姆相同的假设，你也可以选择

```
var result = db.CT_Decals.OrderByDescending(d => d.DecalExpireDate).First(d => d.TankID == decal.TankID && d.DecalStatus == "Approved");

var expireDate = result.DecalExpireDate;
var expireMonth = result.DecalExpireMonth; 
var expireYear = result.DecalExpireYear; 
```

您将在“结果”变量中拥有所需的“CT_Decals”类型对象，因此可以访问它的任何属性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-12T12:02:47.287

```
var q = from r in tab1.dictenaries
                    select new {
                        r.ENGLISH,
                        r.FRENCH
                    };

            List<SomeClass> sml = new List<SomeClass>();

            int starting = 10;
            int ending = 20;
            int cntr = 0;
           foreach( var verObj in q)
           {
               if (cntr >= starting && cntr <= ending)
               {
                   SomeClass sm1 = new SomeClass();
                   sm1.ENGLISH = verObj.ENGLISH.ToString();
                   sm1.FRENCH = verObj.FRENCH.ToString();
                   sml.Add(sm1);
               }
               else if(cntr >ending)
               {
                   break;
               }
               cntr = cntr + 1;
           } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-18T07:54:06.533

在 Tim 和 Dipin 的基础上，`First()`当查询没有产生任何结果时，该方法不幸地抛出 InvalidOperationException。

要么用 try/catch 块包围它

```
try{
    var latest = (from d in db.CT_Decals
                 where d.TankID == decal.TankID && d.DecalStatus == "Approved"
                 orderby d.DecalExpireDate descending
                 select new
                 {
                     d.DecalExpireDate,
                     d.DecalExpireMonth,
                     d.DecalExpireYear
                  }).First();
    var decalExpireDate  = latest.DecalExpireDate;
    var decalExpireMonth = latest.DecalExpireMonth;
    var decalExpireYear  = latest.DecalExpireYear;
}
catch(InvalidOperationException ex){ // tell no Result!} 
```

或者您可以使用`FirstOrDefault()`which 在查询不匹配时返回空引用。

```
//... Example from above

}).FirstOrDefault();

// check for null-reference
if(latest != null)
    var decalExpireDate  = latest.DecalExpireDate;
    var decalExpireMonth = latest.DecalExpireMonth;
    var decalExpireYear  = latest.DecalExpireYear;
} 
```

第三种可能性是使用第一个元素`Take(1)`

```
//... Example from above

}).Take(1).ToList();  // returns an empty list if no match

// check whether something was returned
if(latest.Any())
    var decalExpireDate  = latest[0].DecalExpireDate;
    var decalExpireMonth = latest[0].DecalExpireMonth;
    var decalExpireYear  = latest[0].DecalExpireYear;
} 
```

# symfony - Symfony2 ParameterNotFoundException

> ID：11369894
> 
> 赞同：0
> 
> 时间：2012-07-06T21:30:17.383
> 
> 标签：symfony, fosuserbundle

我按照步骤安装 FOSUserBundle 和（[NmMultiUserBundle](https://github.com/netmeansnet/NmnMultiUserBundle/blob/master/Resources/doc/index.md) ，以便能够拥有多个用户类）。

在完成安装 NmnMultiUserBundle 的步骤并尝试获取新模式（doctrine:schema:update --dump-sql）后，我从控制台收到以下异常：

`[Symfony\Component\DependencyInjection\Exception\ParameterNotFoundException] The service "nmn_user.manager.user_discriminator" has a dependency on a non-existent parameter "nmn_user_discriminator_parameters".`

我以为是缓存，a也是，`cache:clear`但它也给了我例外。

有人知道原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T10:20:42.063

您忘记了捆绑安装的一步，请参阅[https://github.com/netmeansnet/NmnMultiUserBundle/blob/master/Resources/doc/index.md#6-configure-parameters-for-userdiscriminator](https://github.com/netmeansnet/NmnMultiUserBundle/blob/master/Resources/doc/index.md#6-configure-parameters-for-userdiscriminator)

# javascript - 将 mustache.js 部分与 express 一起使用

> ID：11369901
> 
> 赞同：3
> 
> 时间：2012-07-06T21:30:42.140
> 
> 标签：javascript, templates, node.js, express, mustache

所以这可能是我完全误解了功能的情况，但我试图在 node.js 中使用部分，以便在我的各种模板上有一个可重用、可重新插入的页眉和页脚，类似于`{% extends 'something.html' %}`django 或`<? includes 'something.php ?>`php。据我了解，这就是部分的用途。

所以在我的 app.js 中使用这个配置来渲染模板：

```
var mustache = require('mustache');
var template = {
    compile: function (source, options) {
        if (typeof source == 'string') {
            return function(options) {
                options.locals = options.locals || {};
                options.partials = options.partials || {};
                if (options.body) // for express.js > v1.0
                    locals.body = options.body;
                return mustache.to_html(
                    source, options.locals, options.partials);
            };
        } 
        else {
            return source;
        }
    },
    render: function (template, options) {
        template = this.compile(template, options);
        return template(options);
    }
};

// Configuration
app.configure(function(){
    app.register(".html", template);
    app.set('views', __dirname + '/views');
    app.set('view options', {layout: false});
    app.use(express.bodyParser());
    app.use(express.methodOverride());
    app.use(app.router);
    app.use(express.static(__dirname + '/public'));
}); 
```

然后我有这条路线：

```
var header = require("../views/header.html");

module.exports = function(app){
app.all('/test', function(req, res){
    var data = {
        locals: {value: "some value"},
        partials: {header: header}
    }
    res.render('test.html', data);
}); 
```

header.html 就是这样：

```
hello world 
```

test.html 就是这样：

```
{{>header}}
{{ value }} 
```

我希望这会呈现：

```
hello world
some value 
```

但是当我运行`node app.js`指向`hello world`我的 header.html 作为问题时，我得到了一个意外的令牌错误。

我在配置它以使其正常工作时缺少什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T22:19:47.827

对于部分以及如何使它们工作，我建议看一下[consolidate.js](https://github.com/visionmedia/consolidate.js)项目。将多个模板引擎与 express 3.x 集成是一种努力

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-05T06:39:13.593

这个帖子很老了，但也许像我这样留着小胡子的初学者会像我一样在这里遇到同样的问题。

就我而言，问题是我在模板中省略了“>”。

*   快递：“^4.17.1”
*   小胡子快递：“^1.3.0”

在 myRouter.ts

```
router.all('/', (req: Request, res: Response, next: NextFunction)  => {
  res.render('index', {
    pageTitle: 'Welcome',
    partial: res.render('partial',{...})
  });
}); 
```

* * *

在 template.mustache 中

```
<html>
  <head>
    <title>{{pageTitle}}</title>
  </head>
  <body>
    {{>partial}}
   </body>
</html> 
```

* * *

我希望这对其他人有帮助

# regex - 如何在 Perl 中检索整数的序号后缀（如 st、nd、rd、th）

> ID：11369907
> 
> 赞同：14
> 
> 时间：2012-07-06T21:31:10.963
> 
> 标签：regex, perl, perl-module, perl-data-structures

我有数字，需要添加后缀：'st'，'nd'，'rd'，'th'。例如：如果数字是 42 后缀是 'nd' ， 521 是 'st' ， 113 是 'th' 等等。我需要在 perl 中执行此操作。任何指针。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-06T21:35:38.877

使用[Lingua::EN::Numbers::Ordinate](https://metacpan.org/module/Lingua::EN::Numbers::Ordinate)。来自简介：

```
use Lingua::EN::Numbers::Ordinate;
print ordinate(4), "\n";
 # prints 4th
print ordinate(-342), "\n";
 # prints -342nd

# Example of actual use:
...
for(my $i = 0; $i < @records; $i++) {
  unless(is_valid($record[$i]) {
    warn "The ", ordinate($i), " record is invalid!\n"; 
    next;
  }
  ...
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-07-06T21:35:00.987

试试这个：

```
my $ordinal;
if ($foo =~ /(?<!1)1$/) {
    $ordinal = 'st';
} elsif ($foo =~ /(?<!1)2$/) {
    $ordinal = 'nd';
} elsif ($foo =~ /(?<!1)3$/) {
    $ordinal = 'rd';
} else {
    $ordinal = 'th';
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-06T22:04:24.240

试试这个简短的子程序

```
use strict;
use warnings;

sub ordinal {
  return $_.(qw/th st nd rd/)[/(?<!1)([123])$/ ? $1 : 0] for int shift;
}

for (42, 521, 113) {
  print ordinal($_), "\n";
} 
```

**输出**

```
42nd
521st
113th 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-25T00:30:20.417

[这是我最初为代码高尔夫挑战编写](https://codegolf.stackexchange.com/a/4708)的解决方案，稍微重写以符合非高尔夫代码的通常最佳实践：

```
$number =~ s/(1?\d)$/$1 . ((qw'th st nd rd')[$1] || 'th')/e; 
```

它的工作方式是正则表达式`(1?\d)$`匹配数字的最后一位，如果是，则加上前面的数字`1`。然后，替换使用匹配的数字作为 list 的索引`(qw'th st nd rd')`，将 0 映射到`th`1 到`st`2 到`nd`3 到`rd`以及任何其他值到 undef。最后，`||`运算符将 undef 替换为`th`.

如果您不喜欢`s///e`，基本上可以编写相同的解决方案，例如：

```
for ($number) {
    /(1?\d)$/ or next;
    $_ .= (qw'th st nd rd')[$1] || 'th';
} 
```

或作为一个函数：

```
sub ordinal ($) {
    $_[0] =~ /(1?\d)$/ or return;
    return $_[0] . ((qw'th st nd rd')[$1] || 'th');
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-10-16T20:07:11.943

另一种解决方案（尽管我更喜欢独立于使用模块的预先存在的答案）：

```
use Date::Calc 'English_Ordinal';
print English_Ordinal $ARGV[0]; 
```

# javascript - 现在 $.browser 已被弃用，如何使用 jQuery 检测 IE 8？

> ID：11369910
> 
> 赞同：1
> 
> 时间：2012-07-06T21:31:18.990
> 
> 标签：javascript, jquery, internet-explorer, internet-explorer-8

> **可能重复：**
> [检测不支持 HTML5 <canvas> 的最佳方法](https://stackoverflow.com/questions/2745432/best-way-to-detect-that-html5-canvas-is-not-supported)

现在 $.browser[正在从 jQuery](http://api.jquery.com/jQuery.support/)中移除以支持 $.support，我将如何使用 jQuery 或纯 javascript 检测 IE8？

```
if ($.browser.msie  && parseInt($.browser.version, 10) === 8) {
  alert('IE8'); 
} 
```

抱歉，HTML 不适用于我。所以我不能这样做：

```
<!--[if IE 8]>
<script type="text/javascript">
    ie = 8;
</script>
<![endif]--> 
```

具体来说，我希望使用 canvas 标签，而 IE8 不支持 canvas，但 jQuery.support 没有检测到 canvas 支持。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-06T21:41:04.117

改为测试该功能：

```
var el = document.createElement('canvas');
if (el.getContext && el.getContext('2d')) {
    // canvas supported 
} 
```

**编辑：**

正如Brandon Boone[在评论中建议的链接](https://stackoverflow.com/a/2746983/402706)中所建议的那样，这是一个执行此操作的函数：

```
function isCanvasSupported(){
  var elem = document.createElement('canvas');
  return !!(elem.getContext && elem.getContext('2d'));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-06T21:43:07.300

如果 jQuery 不能满足您的需求，我建议改用[Modernizr](http://modernizr.com/)进行特征检测。

当然，另一种选择是简单地坚持使用旧版本的 jQuery，之前`$.browser`已被弃用。它仍然像往常一样工作。没有人强迫您升级到最新版本。

最后，您声明您无法编辑 HTML，因此您无法使用条件注释。然而，值得指出的是，IE 也支持相当于条件注释的 Javascript。我假设您将能够使用此功能。

以下代码取自[Wikipedia](http://en.wikipedia.org/wiki/Conditional_comment) - 根据需要进行调整：

```
<script>
/*@cc_on

  @if (@_jscript_version == 10)
    document.write("You are using IE10");

  @elif (@_jscript_version == 9)
    document.write("You are using IE9");

  @elif (@_jscript_version == 5.8)
    document.write("You are using IE8");

  @elif (@_jscript_version == 5.7 && window.XMLHttpRequest)
    document.write("You are using IE7");

  @elif (@_jscript_version == 5.6 || (@_jscript_version == 5.7 && !window.XMLHttpRequest))
    document.write("You are using IE6");

  @elif (@_jscript_version == 5.5)
    document.write("You are using IE5.5");

  @else
    document.write("You are using IE5 or older");

  @end

@*/
</script> 
```

# ruby-on-rails - 将 XML 文档导入 Rails 数据库？

> ID：11369911
> 
> 赞同：3
> 
> 时间：2012-07-06T21:31:19.143
> 
> 标签：ruby-on-rails, xml, sqlite

我一直在阅读教程后的教程，但似乎没有什么对我有用。目标是获取包含元素和属性的 XML 文档，并将数据插入数据库。每个元素/属性将是数据库中的一列，每个条目是一行。这是我一直在使用的虚构 XML 文档：

```
<?xml version="1.0"?>
<library>
  <NAME><![CDATA[Favorite Books]]></NAME>
  <book ISBN="11342343">
    <title>To Kill A Mockingbird</title>
    <description><![CDATA[Description#1]]></description>
    <author>Harper Lee</author>
  </book>
  <book ISBN="989894781234">
    <title>Catcher in the Rye</title>
    <description><![CDATA[This is an extremely intense description.]]></description>
    <author>J. D. Salinger</author>
  </book>
  <book ISBN="123456789">
    <title>Murphy's Gambit</title>
    <description><![CDATA[Daughter finds her dad!]]></description>
    <author>Syne Mitchell</author>
  </book>
</library> 
```

所以我想要一个有 2 个条目的表，每个条目都有一个 ISBN、标题、描述和作者。这就是基础。（我想 CDATA 是完全可选的。如果这是我的问题的一部分，无论如何让我们摆脱它......）

最终目标有点复杂。拥有多本书的多个图书馆。数据库之间有关系，所以我可以从我的图书数据库中引用图书馆数据库，反之亦然。我完全迷路了，绝对是一个菜鸟，但我有很好的计算机知识，并且愿意测试和尝试。

我正在使用带有默认 SQLite3 数据库 (3.6.20) 的 Rails 3.2.6。我已经安装了 REXML、ROXML、LibXML 等，并通读了 API 和演练，但一切都没有成功。必须有一种简单的方法将 XML 文档转换为带有 Book 对象（具有 .title、.author、.isbn 和 .description 方法）的 Library 对象（使用 .name 方法）。

任何帮助都是真正的赞赏！

**更新！**

好的，下一个问题。我一直在玩弄这背后的逻辑，并想知道执行以下操作的最佳方法...

假设我有这个新的和改进的 XML 文件。

```
<?xml version="1.0"?>
<RandomTag>
  <library name='Favorite Books'>
    <book ISBN="11342343">
      <title>TKAM</title>
      <description>Desc1</description>
      <author>H Lee</author>
    </book>
    <book ISBN="989894781234">
      <title>Catcher in the Rye</title>
      <description>Desc2</description>
      <author>JD S</author>
    </book>
  </library>
  <library name='Other Books'>
    <book ISBN="123456789">
      <title>Murphy\'s Gambit</title>
      <description>Desc3</description>
      <author>Syne M</author>
    </book>
  </library>
</RandomTag> 
```

所以现在我们有两个图书馆，第一个名为“Favorite Books”，有两本书，第二个图书馆名为“Other Books”，只有一本书。

每本书知道它属于哪个图书馆的最佳方法是什么？最初，我创建了一个图书馆数据库和一个图书数据库。每个 Book 对象都有一个 library_id 字段，它引用了正确的 Library。因此，每个数据库都可以使用“@library.books.each do |b| b.title”之类的语法正确填写。但是，这仅在我拥有一个库时才有效。

我尝试将您给我的 Book 循环嵌套在一个类似的 Library 循环中，但是 .css 方法会找到每个匹配项，无论它位于何处。是否有 .css 方法可以找到 UNTIL 一个特定点？

换句话说，我希望能够将每本书导入其各自的图书馆。我无法向 XML 文件添加任何字段。

再次感谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-06T22:51:53.263

[我使用Nokogiri](http://nokogiri.org/)库做了类似的事情。

```
doc = Nokogiri::XML(xml_data)

doc.css('book').each do |node|
  children = node.children

  Book.create(
    :isbn => node['ISBN'],
    :title => children.css('title').inner_text,
    :description => children.css('description').inner_text,
    :author => children.css('author').inner_text
  )
end 
```

**更新**

您可以通过执行以下操作创建快速测试：

首先安装 nokogiri gem：

```
gem install nokogiri 
```

然后创建一个名为 text_xml.rb 的文件，其内容为：

```
require 'nokogiri'

doc = Nokogiri::XML('<?xml version="1.0"?>
  <library>
    <NAME><![CDATA[Favorite Books]]></NAME>
    <book ISBN="11342343">
      <title>To Kill A Mockingbird</title>
      <description><![CDATA[Description#1]]></description>
      <author>Harper Lee</author>
    </book>
    <book ISBN="989894781234">
      <title>Catcher in the Rye</title>
      <description><![CDATA[This is an extremely intense description.]]></description>
      <author>J. D. Salinger</author>
    </book>
    <book ISBN="123456789">
      <title>Murphy\'s Gambit</title>
      <description><![CDATA[Daughter finds her dad!]]></description>
      <author>Syne Mitchell</author>
    </book>
  </library>')

doc.css('book').each do |node|
  children = node.children

  book = {
    "isbn" => node['ISBN'], 
    "title" => children.css('title').inner_text, 
    "description" => children.css('description').inner_text, 
    "author" => children.css('author').inner_text
  }

  puts book
end 
```

最后运行：

```
ruby test_xml.rb 
```

我怀疑您在粘贴 xml 时并没有转义*Murphy's Gambit中的单引号。*

# android - Android中的日期时间不一致

> ID：11369918
> 
> 赞同：0
> 
> 时间：2012-07-06T21:32:10.440
> 
> 标签：android, datetime

我被这个在 Android 上运行的例子困住了：

```
SimpleDateFormat sdf = new SimpleDateFormat("dd-mm-yyyy kkmm"); 
sdf.setTimeZone(TimeZone.getTimeZone(Time.TIMEZONE_UTC));

Date scheduledDateTime = sdf.parse(sms.getScheduledDateTime());

Log.i(TAG, "scheduledDateTime is : " + scheduledDateTime);    // scheduledDateTime is : Fri Jan 06 23:58:00 HNEC 2012
Log.i(TAG, "scheduledDateTime milli : " + scheduledDateTime.getTime());    // scheduledDateTime milli : 1325890680000

Calendar calendar = Calendar.getInstance();
Calendar defaultTZCalendar = Calendar.getInstance(TimeZone.getDefault());
Calendar utcTZCalendar = Calendar.getInstance(TimeZone.getTimeZone(Time.TIMEZONE_UTC));

calendar.setTime(scheduledDateTime);
defaultTZCalendar.setTime(scheduledDateTime);
utcTZCalendar.setTime(scheduledDateTime);

Log.i(TAG, "calendar : " + calendar.getTimeInMillis());    // calendar : 1325890680000
Log.i(TAG, "defaultTZCalendar : " + defaultTZCalendar.getTimeInMillis());    // defaultTZCalendar : 1325890680000
Log.i(TAG, "utcTZCalendar : " + utcTZCalendar.getTimeInMillis());    // utcTZCalendar : 1325890680000 
```

现在看看这个：

```
final long currentTimeMillis = System.currentTimeMillis();
Log.i(TAG, "  currentTimeMillis is " + currentTimeMillis);    //  currentTimeMillis is 1341608182431
Date d = new Date(currentTimeMillis);
Log.i(TAG, "  currentTimeMillis is " + d + " ::: d.getTime() = " + d.getTime());    // currentTimeMillis is Fri Jul 06 22:56:22 HAEC 2012 ::: d.getTime() = 1341608182431 
```

两个看起来相同的日期之间怎么可能有 15713902431 这样的差异：Fri Jan 06 23:58:00 HNEC 2012 和 Fri Jul 06 22:56:22 HAEC 2012

顺便提一句，

HNEC 是（法语）欧洲中部正常时间

HAEC 是高级中欧时间（即 DST）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:34:45.013

在我看来，最后部分一切都很好。日期“看起来不一样”。一个是七月，另一个是一月。所以 15713902431 毫秒 - 将近 182 天 - 似乎完全合理。

现在至于为什么您的*数据*无法正确解析-您的格式已损坏：

```
new SimpleDateFormat("dd-mm-yyyy kkmm"); 
```

注意“dd”和“yyyy”之间的“mm”。`mm`是*分钟*，不是*月*。

我强烈怀疑你应该使用：

```
new SimpleDateFormat("dd-MM-yyyy kkmm"); 
```

然后你可能会在正确的月份获得价值:)

# asp.net - IIS7 403 - 拒绝访问

> ID：11369921
> 
> 赞同：9
> 
> 时间：2012-07-06T21:32:32.420
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, iis, iis-7

我正在尝试在运行 iis7 的服务器上部署我在 mvc3 中构建的网站。我能够让它在我的笔记本电脑上本地通过 iis7 运行，但是当我尝试将它放在服务器上时，我在尝试远程访问它时收到 403 access denied 错误，当我尝试时出现“连接已超时”从服务器本身查看它。

我确保我拥有使用 asp_regiis.exe 的最新 .Net 4 框架。我尝试了多个应用程序池，包括默认值。我允许 .net4 isapi。我已更改权限以允许来自 IUSER、SERVER NETWORK、Authenticated Users 的访问。我已确保默认文档列表与我的笔记本电脑 iis7 上的相同（工作正常）。

我还有多个其他站点（使用 webforms，而不是 mvc）在服务器上运行良好。

这可能与我将文件传递到服务器的方式有关吗？我只是将文件压缩并将它们（并解压缩）放在服务器上，并将 iis 定向到创建的目录。

我错过了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-08T08:04:52.947

我上周遇到了这个错误，它可能是由很多原因引起的：

1.  未安装正确版本的 .NET 框架或未向 asp_regiis.exe 注册
2.  “runAllManagedModulesForAllRequests”在您的 web.config 中设置为 false
3.  服务器中未安装正确版本的 MVC
4.  您有一条忽略您的请求的忽略路线
5.  您的 Application_Start 中有一个早期异常，并且您的站点无法正常启动

就我而言，我忘记将 web.config 中的日志目录路径值更改为现有目录。

要知道这是配置错误还是应用程序中的错误，您可以做的是在 VS 中创建一个新的默认 MVC 项目并将其部署在同一个应用程序池中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-07T02:59:12.893

如果您可以发布它（在 VS 中，右键单击您的项目并发布）并在将其部署到您的网站后（您有多种选择），而不是压缩您的应用程序，那会更好。

之后，对于 IIS，它看起来像是身份验证的问题。尝试允许匿名身份验证。在 IIS 管理器上，转到您的网站，单击身份验证模块并启用“匿名身份验证”。

让我们看看之后会发生什么，即使“超时”问题很奇怪....可以肯定的是，默认情况下，浏览网站内容是禁用的，如果您尝试这样做，您将遇到 403 错误.

你把你的应用程序放在哪里了？有时将其放在特定文件夹（如 Programs 文件等）中可能会出现问题（对于访问配置）。尝试将其安装在 C:\Websites\MyApp 等根目录下，以便在没有用户权限问题的情况下进行测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-07T05:53:38.577

你应该检查几件事。

1.  您是否将解压缩文件的目录设置为 IIS 中的应用程序？该应用程序是否运行 .NET 3.5/4.0？

2.  您的应用程序池管道是否运行您在上面创建的应用程序在集成模式或经典模式下运行？

通常，在部署 MVC 应用程序时，403 不是权限问题。它告诉您不允许目录浏览。这是因为没有上述 2 项中的任何一项（或 IIS 中的自定义通配符映射），Web 服务器不知道如何处理路由，这是 MVC 应用程序的基础。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-07T19:55:34.123

1.  使用所有默认值创建一个新的 MVC 3 互联网应用程序。在本地 IIS 服务器上运行。
2.  将应用程序移动到服务器并将其添加为应用程序。
3.  在服务器上测试本地访问（从 IIS 管理器中浏览 80）。
4.  在找出问题所在之前，不要乱动所有权限。
5.  请参阅我的博客[http://blogs.msdn.com/b/rickandy/archive/2011/04/22/test-you-asp-net-mvc-or-webforms-application-on-iis-7-in-30 -seconds.aspx](http://blogs.msdn.com/b/rickandy/archive/2011/04/22/test-you-asp-net-mvc-or-webforms-application-on-iis-7-in-30-seconds.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-06T21:36:23.627

您需要确保解压缩文件的文件夹具有正确的权限设置。另外，您是否在该站点中进行了身份验证设置？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-07T19:59:28.310

在设置网站时，您是否通过单击测试连接来测试您的 IIS 设置。你有没有得到两个绿色的勾号。如果不是，请检查您的身份验证设置。文件夹访问设置和应用程序池设置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-05T09:57:53.780

如果是 aspx 文件，请确保在 IIS 上设置了默认页面，如果没有安装 asp.net 应用程序。安装后，默认情况下会创建 aspx 文件。

# entity-framework - 实体框架代码优先自动架构迁移

> ID：11369925
> 
> 赞同：0
> 
> 时间：2012-07-06T21:32:53.627
> 
> 标签：entity-framework, ef-code-first, schema, code-first

有没有办法用 EF 做到这一点？

我希望架构动态变化以适应传入的 DTO。本质上类似于 StreamInsight 在幕后所做的事情。

我不希望任何人直接接触数据库，所有修改等都将由程序即时完成。不是通过入门脚本或 Visual Studio 宏单独进行，而是由程序本身根据预设逻辑自动执行。

另一件事是，必须保留所有现有数据，除非修改要求删除列。违反参照完整性应被解释为致命错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T00:42:53.327

听起来您可能正在寻找 4.3 及更高版本中包含的 EF 迁移。在[http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-automatic-migrations-walkthrough.aspx有 EF 迁移介绍](http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-automatic-migrations-walkthrough.aspx)

# spring - Jpa 和 spring 3 mvc 验证

> ID：11369929
> 
> 赞同：0
> 
> 时间：2012-07-06T21:33:13.657
> 
> 标签：spring, spring-mvc, validation

我正在使用 spring 3 mvc，我需要对其进行验证。

实际上验证器不起作用，我无法理解原因。

我做下一个配置：

在 pom.xml 中，我添加了下一个依赖项：

```
 <dependency>
     <groupId>org.hibernate</groupId>
     <artifactId>hibernate-validator</artifactId>
     <version>4.3.0.Final</version>
 </dependency> 
```

我执行 productsForm.jsp 并添加标签：

```
<%@taglib prefix="form" uri="http://www.springframework.org/tags/form"%> 
```

我添加标签： `<form:form>`和`<form:input>`。

我在控制器中写了以下内容：

```
//Here is to show the form

@RequestMapping(value = "Products", method = RequestMethod.GET)
public String ManagmentHome(Map model2,Model model,HttpServletRequest request){
    Product validationForm=new Product();  
    model2.put("validationForm",validationForm);
    return "productsForm";
}

// Here is to process the form

public String addProduct(@RequestParam String product,  BindingResult result, Map model2,Model model, HttpServletRequest request,@Valid Product validationForm) {

    if(result.hasErrors()){
        return "productsForm";
     }
} 
```

我正在使用 Ajax 来获取参数。

如果我不使用验证器，它可以正常工作，但是当我使用验证器时它不起作用，当我提交表单时它会显示 400（错误请求）。

我不知道是什么问题。你能帮助我吗？你有什么例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T22:22:15.343

你的控制器不应该有带有 Ajax Header 的 @RequestMapping 吗？

例如，在控制器中：

```
 public static final String AJAX = "X-Requested-With=XMLHttpRequest";
 @RequestMapping(value = "/url", 
  method = RequestMethod.GET,headers=  AJAX)
  public String someMethod(argument1, ....){...} 
```

另外，我建议设置一个断点来检查请求是否被控制器映射。

# ios - Live555 编译 iOS 构建错误

> ID：11369933
> 
> 赞同：2
> 
> 时间：2012-07-06T21:33:55.057
> 
> 标签：ios, live555

我正在尝试为 iOS 编译 Live555。

我做了以下事情：

```
./genMakefiles iphoneos
make 
```

我收到以下构建错误：

```
/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/g++ -c -I../UsageEnvironment/include -I../groupsock/include -I../liveMedia/include -I../BasicUsageEnvironment/include -I.  -DBSD=1 -O2 -DSOCKLEN_T=socklen_t -DHAVE_SOCKADDR_LEN=1 -D_LARGEFILE_SOURCE=1 -D_FILE_OFFSET_BITS=64 -fPIC -arch armv7 --sysroot=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk -Wall testMP3Streamer.cpp
/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/g++ -o testMP3Streamer -L. -arch armv7 --sysroot=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk testMP3Streamer.o ../liveMedia/libliveMedia.a ../groupsock/libgroupsock.a ../BasicUsageEnvironment/libBasicUsageEnvironment.a ../UsageEnvironment/libUsageEnvironment.a 
ld: in /usr/lib/system/libcache.dylib, missing required architecture armv7 in file for architecture armv7
collect2: ld returned 1 exit status
make[1]: *** [testMP3Streamer] Error 1
make: *** [all] Error 2 
```

我也尝试在 config.iphoneos 中将链接器选项更改为此：

```
LINK_OPTS =             -L. -arch armv7 --isysroot=$(SDK) 
```

当我更改链接器选项时，出现以下错误：

```
cd testProgs ; make
/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/g++ -c -I../UsageEnvironment/include -I../groupsock/include -I../liveMedia/include -I../BasicUsageEnvironment/include -I.  -DBSD=1 -O2 -DSOCKLEN_T=socklen_t -DHAVE_SOCKADDR_LEN=1 -D_LARGEFILE_SOURCE=1 -D_FILE_OFFSET_BITS=64 -fPIC -arch armv7 --sysroot=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk -Wall testMP3Streamer.cpp
/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/g++ -o testMP3Streamer -L. -arch armv7 --isysroot=/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk testMP3Streamer.o ../liveMedia/libliveMedia.a ../groupsock/libgroupsock.a ../BasicUsageEnvironment/libBasicUsageEnvironment.a ../UsageEnvironment/libUsageEnvironment.a 
ld: warning: ignoring file /usr/lib/crt1.o, missing required architecture armv7 in file
ld: warning: ignoring file /usr/lib/libstdc++.dylib, missing required architecture armv7 in file
ld: warning: ignoring file /usr/lib/libgcc_s.1.dylib, missing required architecture armv7 in file
ld: warning: ignoring file /usr/lib/libSystem.dylib, missing required architecture armv7 in file
Undefined symbols for architecture armv7:
  "start", referenced from:
     -u command line option
     (maybe you meant: RTPInterface::startNetworkReading(void (*)(void*, int)), MediaSink::startPlaying(MediaSource&, void (*)(void*), void*))
  "_exit", referenced from:
      play()    in testMP3Streamer.o
  "operator new(unsigned long)", referenced from:
      _main in testMP3Streamer.o
      MP3FileSource::MP3FileSource(UsageEnvironment&, __sFILE*)in libliveMedia.a(MP3FileSource.o)
      MP3FileSource::MP3FileSource(UsageEnvironment&, __sFILE*)in libliveMedia.a(MP3FileSource.o)
      MP3FileSource::createNew(UsageEnvironment&, char const*)in libliveMedia.a(MP3FileSource.o)
      _Tables::getOurTables(UsageEnvironment&, unsigned char)in libliveMedia.a(Media.o)
      MediaLookupTable::remove(char const*)in libliveMedia.a(Media.o)
      MediaLookupTable::ourMedia(UsageEnvironment&)       in libliveMedia.a(Media.o)
      ... 
```

任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-06T03:33:25.513

在运行“genMakefiles iphoneos”之前更改 config.iphoneos 的 LINK_OPTS。它适用于 iOS 5.1 SDK 和 iOS 6 SDK beta。

```
LINK_OPTS =             -L. -arch armv7 --sysroot=$(SDK) -L$(SDK)/usr/lib/system 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T18:34:13.547

我只是更改 compile.iphoneos ：

```
IOS_VERSION =       5.1
LINK_OPTS =                 -L. ..... 
```

到

```
IOS_VERSION =       6.0
LINK_OPTS =             -L. -arch armv7 --sysroot=$(SDK) -L$(SDK)/usr/lib/system 
```

它成功编译。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T02:58:02.697

我认为你必须修改`--isysroot`为`-isysroot`

# jqgrid - jqgrid中的空order_by字段导致tastepie api失败

> ID：11369934
> 
> 赞同：1
> 
> 时间：2012-07-06T21:33:57.537
> 
> 标签：jqgrid, tastypie

我正在使用 jqgrid 访问一个美味的 API。我已将 sidx 更改为“order_by”以匹配默认的 sweetpie API。

Jqgrid 传递 order_by（以前的 sidx）get 参数，而不管它是否按某些东西排序。如果它不排序，它只是传递一个空字符串作为排序标准。美味派被一个空字符串吓坏了，说“没有名为''的字段”

在我看来，有两种选择可以解决：

1.  让 jqgrid 停止发送 order_by 参数，除非它需要
2.  让 sweetpie 忽略一个空的 order_by 字符串...

关于如何做这两件事的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T08:26:38.637

我不确定，我完全理解这个问题。首先要重命名`sidx`为`order_by`一个可以使用

```
prmNames: {sort: "order_by"} 
```

如果您永远不会这样做`sidx`或`order_by`将被发送，您可以使用

```
prmNames: {sort: null} 
```

您可以在`prmNames.sort`动态更改时实现一些场景。您可以使用 jqGrid[回调](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:events#list_of_events)或[事件](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:events#list_of_triggered_events_new_in_v4.3.2)。

控制将发送到服务器的参数列表的另一种方法是`serializeGridData`回调。例如

```
serializeGridData: function (postData) {
    var myPostData = $.extend({}, postData); // make a copy of the input parameter
    if (myPostData.sidx.length === 0) { // or myPostData.order_by.length
        delete myPostData.sidx;
    }
    return myPostData;
} 
```

另一个例子见[答案](https://stackoverflow.com/a/7050224/315935)。

# php - 在 Symfony 2.1+ 中向 Composer 添加库

> ID：11369939
> 
> 赞同：3
> 
> 时间：2012-07-06T21:34:14.887
> 
> 标签：php, symfony-2.1, composer-php

我正在尝试添加一些库`composer.json`

图书馆位于`Symfony/vendor/foo/lib/Foo/*`

在我按照以下`registerNamespaces`方法加载它们之前`autoload.php`：

```
...
'Foo' => __DIR__.'/../vendor/foo/lib',
... 
```

我尝试将它们添加为composer.json`"foo": "*"`并`"foo/foo": "*"`无济于事。在这方面，文档似乎非常缺乏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T21:49:57.563

您必须查看[Composers 文档](http://getcomposer.org/doc/)，因为自动加载完全由那里接管。更新我使用过的 Symfony 2.0 应用程序的一个好的开始是将它与当前的[Symfony Standard](https://github.com/symfony/symfony-standard)进行比较。对于您的问题，您应该查看[app/autoload.php](https://github.com/symfony/symfony-standard/blob/17a0f1696192990017d02e461ebff4e475dfce37/app/autoload.php)。在那里你可以找到

```
$loader = @include __DIR__.'/../vendor/autoload.php' 
```

在第 5 行（在 -`if`表达式中，但这在这里并不重要）。这意味着，只要您让 composer 安装软件包，您就不必再考虑自动加载了。当然，你必须先打电话`php composer.phar install`。如果您不知道包的名称，请查看 packages `composer.json`-file，或在[Packagist中搜索](http://packagist.org/)

# ruby-on-rails - Rails，设计：覆盖 RegistrationsController 时 current_user 为 nil

> ID：11369941
> 
> 赞同：2
> 
> 时间：2012-07-06T21:34:41.020
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

Rails 3.2.5，设计 2.1

使用设计对用户进行身份验证，并且在创建新用户时遇到问题。

用户属于我使用`before_save`用户模型中的过滤器创建的帐户。这工作正常并且有一段时间。

新代码需要用户的帐户信息作为 create 方法的一部分。我依赖于请求中传递的参数，因此这不是模型逻辑的好选择。我已经覆盖了 Devise::RegistrationsController#create 方法：

```
class DeviseCustom::RegistrationsController < Devise::RegistrationsController
  def create
    super                                  # Call Devise's create
    account = current_user.account         # FAIL! (current_user is nil)
    account.partner_id = current_partner
    account.save!
  end
end 
```

`current_user`是`nil`导致代码失败的原因。即使在失败的情况下，我也可以看到用户和帐户记录*正在保存*在数据库中——日志显示`commit`，并且日志`self.inspect`显示我的所有上下文（参数等）都仍然存在。

我原以为`current_user`在这种情况下可以使用-获取我刚刚创建的用户的合适方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-16T06:28:06.293

我可以通过在覆盖时将它们包含在我的控制器中来使用 Devise 辅助方法。

`include Devise::Controllers::Helpers`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T00:07:10.560

**前言**：我从未使用过设计。

我的猜测是 current_user 对象尚未创建，要么是因为在调用链的早期没有理由（没有用户凭据），要么因为它可能还没有发生在 #after_save 中（如果存在？ ）。

Devise 使用 #resource 方法来获取您尝试保存的当前实例变量（或者看起来如此）：

[https://github.com/plataformatec/devise/blob/master/app/controllers/devise_controller.rb#L16](https://github.com/plataformatec/devise/blob/master/app/controllers/devise_controller.rb#L16)

我要做的是将其更改为：

```
class DeviseCustom::RegistrationsController < Devise::RegistrationsController
    def create
      super                                  # Call Devise's create
      account = resource.account         # FAIL! (current_user is nil)
      account.partner_id = resource.current_partner
      account.save!
    end
end 
```

您可能希望将其添加到您的模型中：

```
attr_accessor :current_partner 
```

这将允许您从资源（模型）访问 current_partner。

希望这会有所帮助！

# jquery - jQuery禁用启用带有淡入淡出的点击事件

> ID：11369942
> 
> 赞同：0
> 
> 时间：2012-07-06T21:34:44.763
> 
> 标签：jquery

如何在淡入之前禁用点击事件并在淡出后启用它？

我的js代码：

```
$('a').click(function(){
    // disable click
    $('div').fadeOut(400,
        function(){
            $(this)
                .css('background','yellow')
            .fadeIn(1800, function(){}
             // enable click
             );});
}); 
```

我可以使用 stop() 但我需要禁用/启用请修改我的[http://jsfiddle.net/WBWrM/1/](http://jsfiddle.net/WBWrM/1/) thx

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T21:37:58.317

添加为点击回调的第一行：

```
if ($('div').is(':animated')) return; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-06T21:39:53.417

向元素添加一个类，当该类存在时不要运行事件。

```
$('a').click(function () {
    var $this = $(this);
    if ($this.hasClass('noClick')) return;
    // disable click
    $this.addClass('noClick');
    $('div').fadeOut(400, function () {
        $(this).css('background', 'yellow').fadeIn(1800, function () {
            // enable click
            $this.removeClass('noClick');
        });
    });
}); 
```

# java - 将字符串月份转换为整数java

> ID：11369945
> 
> 赞同：2
> 
> 时间：2012-07-06T21:34:56.480
> 
> 标签：java, android, date, datetime, calendar

如何将月份字符串转换为整数？

在单击方法上，我想显示所选日期，但如果日期有事件，它应该显示更多关于该事件的信息。检查假日事件的方法需要整数值。

这是代码：

**更新：**

```
@Override
public void onClick(View view)
    {
        int m = 0;
        int d, y;
        String date_month_year = (String) view.getTag();
        selectedDayMonthYearButton.setText("Selected: " + date_month_year);

        String [] dateAr = date_month_year.split("-");
        Log.d(tag, "Date Split: " + dateAr[0] + " " + dateAr[1] + " " + dateAr[2]);
        y = Integer.parseInt(dateAr[2]);

        try {
            Calendar c1 = Calendar.getInstance();
            c1.setTime(new SimpleDateFormat("MMM").parse(dateAr[1]));
            m = c1.get((Calendar.MONTH) + 1);
        } 
        catch (ParseException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        //int m = Integer.parseInt(dateAr[1]);
        d = Integer.parseInt(dateAr[0]);
        Log.d(tag, "Date forward: " + d + " " + m + " " + y);

        if (isHoliday(d, m, y))
        {
            Intent i = new Intent(view.getContext(), HijriEvents.class);
            i.putExtra("date_string", date_month_year);
            startActivity(i);

        }

        try
            {
                Date parsedDate = dateFormatter.parse(date_month_year);
                Log.d(tag, "Parsed Date: " + parsedDate.toString());

            }
        catch (ParseException e)
            {
                e.printStackTrace();
            }
    }

    public Boolean isHoliday(int d, int m, int y)
    {
        HijriCalendar hijri = new HijriCalendar(y, m, d);
        if (!hijri.checkIfHoliday().contentEquals(""))
            return true;
        return false;
    } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-06T21:39:16.893

```
Calendar cal = Calendar.getInstance();
cal.setTime(new SimpleDateFormat("MMM").parse("July"));
int monthInt = cal.get(Calendar.MONTH) + 1; 
```

**看**

*   [IDE一演示](http://ideone.com/afBSj)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T21:37:52.550

只有 12 个月，所以只需规范化字符串并进行字符串比较。我不会尝试过度优化。

# c# - 如何计算 3 GB 文件的校验和，但首先删除最后 28 个字节

> ID：11369950
> 
> 赞同：0
> 
> 时间：2012-07-06T21:35:08.477
> 
> 标签：c#, hash

环境：3 GB 数据文件，末尾附加 28 字节 SHA-1 校验和。

是否可以使用 FileStream 或其他类型的流通过从位置 0 读取流到位置 [x - 28(附加校验和的长度)] 来计算 SHA-1 校验和哈希，而无需从物理上删除附加校验和文件末尾先？

目前我们正在使用 FileStream 打开文件，然后使用 BinaryReader 来查找和读取文件的最后 28 个字节。

然后使用 FileStream 再次打开文件并将流的长度设置为长度 - 28 字节，这将从文件中删除校验和。

最后，我们正在计算删除最后 28 个字节的数据文件的校验和，然后将其与我们从文件末尾删除的校验和进行比较，以确保校验和匹配。

基本上我想知道是否可以计算文件数据部分的校验和，而不必先删除附加的校验和。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-06T21:38:52.843

*如果您知道您真正想要*读取多少数据（即长度 - 28 字节），那么当您计算哈希时，只输入那么多数据。您还没有确切说明您是如何计算哈希的，但您通常可以重复地将更多数据“写入”到哈希计算中 - 只要您需要，就这样做，直到您到达最后 28 个字节。

样本：

```
public byte[] Sha1ExceptEnd(Stream input, int bytesToOmit)
{
    long bytesToRead = input.Length - bytesToOmit;
    byte[] buffer = new byte[16 * 1024]; // Hash up to 16K at a time
    using (SHA1 sha1 = SHA1.Create())
    {
        while (bytesToRead > 0)
        {
            int thisPass = (int) Math.Min(buffer.Length, bytesToRead);
            int bytesReadThisPass = input.Read(buffer, 0, thisPass);
            if (bytesReadThisPass <= 0)
            {
                throw new IOException("Unexpected end of data");
            }  
            sha1.TransformBlock(buffer, 0, bytesReadThisPass, buffer, 0);
            bytesToRead -= bytesReadThisPass;
        }
        // Flush the hash
        sha1.TransformFinalBlock(buffer, 0, 0);
        return sha1.Hash;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T21:40:25.723

花哨的方法是创建包装器 Stream 对象，该对象将读取给定底层流的子部分。这样，您就可以为 FileStream 的每个子部分构造其他对象（如阅读器）。

在您感兴趣的范围内直接从流中读取字节会容易得多。

# c# - bindingContext.ModelName 为空？

> ID：11369951
> 
> 赞同：7
> 
> 时间：2012-07-06T21:35:21.187
> 
> 标签：c#, asp.net-mvc-3, defaultmodelbinder

所以我正在尝试应用[Darin Dimitrov 的答案](https://stackoverflow.com/a/7222639/286575)，但在我的实现中 bindingContext.ModelName 等于“”。

这是我的视图模型：

```
public class UrunViewModel
{
    public Urun Urun { get; set; }
    public Type UrunType { get; set; }
} 
```

这是发布模型类型的视图部分：

```
@model UrunViewModel

@{
    ViewBag.Title = "Tablo Ekle";

    var types = new List<Tuple<string, Type>>();
    types.Add(new Tuple<string, Type>("Tuval Baskı", typeof(TuvalBaski)));
    types.Add(new Tuple<string, Type>("Yağlı Boya", typeof(YagliBoya)));
}

<h2>Tablo Ekle</h2>

    @using (Html.BeginForm("UrunEkle", "Yonetici")) {
        @Html.ValidationSummary(true)
        <fieldset>
            <legend>Tablo</legend>

            @Html.DropDownListFor(m => m.UrunType, new SelectList(types, "Item2", "Item1" )) 
```

这是我的自定义模型绑定器：

```
public class UrunBinder : DefaultModelBinder
{
    protected override object CreateModel(ControllerContext controllerContext, ModelBindingContext bindingContext, Type type)
    {
        var typeValue = bindingContext.ValueProvider.GetValue(bindingContext.ModelName + ".Urun");

        var model = Activator.CreateInstance((Type)typeValue.ConvertTo(typeof(Type)));
            bindingContext.ModelMetadata = ModelMetadataProviders.Current.GetMetadataForType(() => model, type);

        return model;
    } 
} 
```

最后，Global.asax.cs 中的行：

```
ModelBinders.Binders.Add(typeof(UrunViewModel), new UrunBinder()); 
```

在被覆盖的`CreateModel`函数内部，在调试模式下我可以看到它`bindingContext.ModelName`等于“”。而且，`typeValue`是 null 所以`CreateInstance`功能失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T22:21:24.243

我不相信您需要该`bindingContext.ModelName`财产来做您想做的事情。

按照Darin [Dimitrov 的回答](https://stackoverflow.com/questions/7222533/polymorphic-model-binding/7222639#7222639)，看来您可以尝试以下方法。首先，您需要在表单上为类型设置一个隐藏字段：

```
@using (Html.BeginForm("UrunEkle", "Yonetici")) {
    @Html.Hidden("UrunType", Model.Urun.GetType()) 
```

然后在您的模型绑定中（基本上是从 Darin Dimitrov 复制的）：

```
protected override object CreateModel(ControllerContext controllerContext, ModelBindingContext bindingContext, Type modelType)
{
    var typeValue = bindingContext.ValueProvider.GetValue("UrunType");
    var type = Type.GetType(
        (string)typeValue.ConvertTo(typeof(string)),
        true
    );
    var model = Activator.CreateInstance(type);
    bindingContext.ModelMetadata = ModelMetadataProviders.Current.GetMetadataForType(() => model, type);
    return model;
} 
```

有关如何填充的更多信息，请参阅[此帖子。](https://stackoverflow.com/questions/2519264/modelbindingcontext-modelname)`bindingContext.ModelName`

# asp.net - Sage ACT for Web 自定义联系人选项卡 - 如何使其响应切换联系人

> ID：11369952
> 
> 赞同：0
> 
> 时间：2012-07-06T21:35:21.223
> 
> 标签：asp.net

我在 Sage ACT CRM for Web 上有一个自定义插件，当我在查看插件时切换联系人时，它不会切换插件页面上的当前联系人。

如果我切换标签并返回，那么它会切换。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T21:37:35.730

您需要在您的 aspx 页面中包含这段 javascript。

```
<script language="javascript" type="text/javascript" >
  function RefreshTabList()
  {
     location.reload(true);
  }
</script> 
```

[您可以在ACT 开发人员社区论坛](http://community.act.com/t5/Sage-ACT-Developer-s-Forum/ACT-for-Web-Custom-Contact-Tab-Not-Switching-when-you-move/m-p/207178/highlight/true#M5732)上找到对此的参考：

此外，[我发现](http://community.act.com/t5/Sage-ACT-Developer-s-Forum/ACT-for-Web-Custom-Contact-Tab-Not-Switching-when-you-move/m-p/207178#M5732)如果您在插件名称中添加一个空格，这将停止工作（至少在 ACT 2011 之前）。

# r - 基于多列的具有独特案例的子集

> ID：11369961
> 
> 赞同：47
> 
> 时间：2012-07-06T21:36:12.003
> 
> 标签：r, unique, subset

我想对数据框进行子集化，以仅包含具有三列唯一组合的行。[我的情况与此](https://stackoverflow.com/questions/2900510/r-equivalent-of-select-distinct-on-two-or-more-fields-variables)问题中提出的情况相似，但我也想保留数据中的其他列。这是我的例子：

```
> df
  v1  v2  v3   v4  v5
1  7   1   A  100  98 
2  7   2   A   98  97
3  8   1   C   NA  80
4  8   1   C   78  75
5  8   1   C   50  62
6  9   3   C   75  75 
```

请求的输出将是这样的，我正在寻找仅基于 v1、v2 和 v3 的独特案例：

```
> df.new
  v1  v2  v3   v4  v5
1  7   1   A  100  98 
2  7   2   A   98  97
3  8   1   C   NA  80
6  9   3   C   75  75 
```

如果我能恢复非唯一的行，那也很棒：

```
> df.dupes
  v1  v2  v3   v4  v5
3  8   1   C   NA  80
4  8   1   C   78  75
5  8   1   C   50  62 
```

[我在 sql (这里](https://stackoverflow.com/questions/10816696/how-to-get-get-unique-records-based-on-multiple-columns-from-a-table))中看到了一个有关如何执行此操作的相关问题，但我无法在 R 中得到它。我确信这很简单，但搞乱 unique() 和 subset() 并没有取得成果。提前致谢。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-07-06T21:46:19.487

您可以使用该`duplicated()`函数查找唯一组合：

```
> df[!duplicated(df[1:3]),]
  v1 v2 v3  v4 v5
1  7  1  A 100 98
2  7  2  A  98 97
3  8  1  C  NA 80
6  9  3  C  75 75 
```

要仅获取重复项，您可以双向检查：

```
> df[duplicated(df[1:3]) | duplicated(df[1:3], fromLast=TRUE),]
  v1 v2 v3 v4 v5
3  8  1  C NA 80
4  8  1  C 78 75
5  8  1  C 50 62 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2018-03-31T17:21:20.740

使用`dplyr`你可以做：

```
library(dplyr)

# distinct
df %>% 
  distinct(v1, v2, v3, .keep_all = T)

# non-distinct only
df %>% 
  group_by(v1, v2, v3) %>% 
  filter(n() > 1)

# exclude any non-distinct
df %>% 
  group_by(v1, v2, v3) %>% 
  filter(n() == 1) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-07T17:18:20.430

您可以使用该`plyr`软件包：

```
library(plyr)

ddply(df, c("v1","v2","v3"), head, 1)
#   v1 v2 v3  v4 v5
# 1  7  1  A 100 98
# 2  7  2  A  98 97
# 3  8  1  C  NA 80
# 4  9  3  C  75 75

ddply(df, c("v1","v2","v3"), function(x) if(nrow(x)>1) x else NULL)
#   v1 v2 v3 v4 v5
# 1  8  1  C NA 80
# 2  8  1  C 78 75
# 3  8  1  C 50 62 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-02T08:46:49.307

是的，但是如果数据太多，使用 plyr 和 ddply 会非常慢。

你 shd 尝试这样的事情：

```
df[ cbind( which(duplicated(df[1:3])), which(duplicated(df[1:3], fromLast=TRUE))),] 
```

或者：：

```
from = which(duplicated(df[1:3])
to = which(duplicated(df[1:3], fromLast=TRUE))
df[cbind(from,to),] 
```

在大多数情况下会更快。

测试一下，让我们知道

有一些错误，但我猜只要你明白了，你就可以解决这些错误。

也尝试独特的一切

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-08-08T17:37:09.217

如果您正在使用`data.table`，就很容易获得关于一个或多个变量的独特案例。语法如下

```
unique(DT, by = c("var1", "var2")) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-12T18:35:58.003

一种不优雅但实用的方法是将给定行的条目粘贴在一起并查找哪些是唯一（或非唯一）行，例如：

```
df.vector=apply(df,1,FUN=function(x) {paste(x,collapse="")})
df.table=table(df.vector) 
```

然后使用以下内容获取重复项的索引：

```
which(df.vector%in%names(which(df.table>1))) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-07-15T14:37:32.083

我知道这是一个非常古老的问题，但无论如何我认为使用 unique() 函数的明显解决方案也应该在这里提出：

```
unique(df[1:3]) 
```

或按名称指定列：

```
unique(df[c("v1","v2","v3)] 
```

...并指定行：

```
unique(df[,c("v1","v2","v3)] 
```

# python - 在终端中从 url 运行 python 脚本

> ID：11369964
> 
> 赞同：3
> 
> 时间：2012-07-06T21:36:32.160
> 
> 标签：python

我想知道有什么方法可以从终端中的 url (www.blahblah.com/script.py) 执行 python 脚本而不将文件下载到磁盘？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-06T21:59:42.533

你想让它在客户端上运行，还是在服务器上运行（这将返回结果）？

如果您想在客户端上运行它，则必须以一种或另一种方式下载它。一种简单的方法是下载、运行、删除：

```
$ wget blahblah.com/script.py && (python script.py; rm script.py) 
```

如果您想在服务器上运行它，您可以使用其他人提到的 CGI。但是，根据您想要做的事情，您可能想要使用 Web 框架。

对于轻量级框架，请查看[Flask](http://flask.pocoo.org/)。他们的文档非常好，我设法在一天内启动并运行了一些东西（我对 Python 和 Web 服务器都很陌生）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-07-28T21:44:06.547

这是您要查找的内容：

```
wget -qO-  https://gist.githubusercontent.com/mattwarrenrnp/6ca5bbeb4959974fb4ac/raw/23196eba76b1f21210f530a05572e38349384e0d/print.py | python - 
```

解释：

**-q**用于安静模式隐藏错误以防止尝试被解释为 python

**O-**将下载定向到标准输出

**使用“ -** ”将该标准输出通过管道传输到 python，以告诉它从标准输入执行。

***警告*：始终确保您信任这样运行的脚本。**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-25T15:44:16.723

由于您没有提及终端中的外壳类型。我假设您正在使用`/bin/bash`. 那么这就是你要找的东西：

```
python <(wget https://bootstrap.pypa.io/get-pip.py -q -O-) 
```

在哪里

`-q`安静（无输出）。

`-O-`将文档写入标准输入

`<`重定向标准输入

参考：[从 URL 执行 bash 脚本](https://stackoverflow.com/questions/5735666/execute-bash-script-from-url)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-03-09T15:55:23.370

我知道这是一个超级旧的线程，但只是想说其他解决方案都没有真正为我们工作，部分原因是我们需要使用`input()`，并且我们对创建临时文件犹豫不决，因为不能保证脚本不会出错. 最后，我们采用了以下对我们有用的方法：

```
python3 -c "$(wget -q -O - https://host.com/script.py)" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-06T21:39:03.213

你问的是所谓的CGI。Python 有一个模块：
[http ://docs.python.org/library/cgi.html](http://docs.python.org/library/cgi.html)

但是 CGI 现在有点过时了，因为它通常是一种为 python 应用程序提供服务的非常低效的方法。最好使用某种[Python Web 框架](http://wiki.python.org/moin/WebFrameworks/)。

[通用网关接口](http://en.wikipedia.org/wiki/Common_Gateway_Interface)

> 支持 CGI 的 Web 服务器可以配置为解释用作 CGI 脚本引用的 URL。一个常见的约定是在目录树的底部有一个 cgi-bin/ 目录，并将其中的所有可执行文件视为 CGI 脚本。另一个流行的约定是使用文件扩展名。例如，如果 CGI 脚本始终以 .cgi 为扩展名，则可以将 Web 服务器配置为将所有此类文件解释为 CGI 脚本。
> 在 HTTP PUT 或 POST 的情况下，用户提交的数据通过标准输入提供给程序。Web 服务器创建一个小而有效的环境变量子集传递给它，并添加与程序执行相关的细节。

这如何适用于您的问题是，您`script.py`首先需要居住在`cgi-bin`您的网络服务器配置为识别类型的类似位置或类似位置内。其次，您需要使用`cgi`python 模块来访问参数（并且还符合请求/响应格式）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-07-06T21:39:39.520

查看[Python 文档](http://docs.python.org/howto/webservers.html)以获取有关在 Web 中使用 Python 的有用信息。

> 这个接口，最常被称为“CGI”，是最古老的，并且几乎每一个开箱即用的 Web 服务器都支持。使用 CGI 与其 Web 服务器通信的程序需要由服务器为每个请求启动。因此，每个请求都会启动一个新的 Python 解释器——这需要一些时间来启动——从而使整个接口仅可用于低负载情况。
> 
> CGI 的优点是它很简单——编写一个使用 CGI 的 Python 程序只需要大约三行代码。这种简单性是有代价的：它对开发人员的帮助很少。
> 
> 虽然仍然可以编写 CGI 程序，但不再推荐。使用 WSGI（本文档后面将介绍的主题），可以编写模拟 CGI 的程序，因此如果没有更好的选择，它们可以作为 CGI 运行。

有一些[更新的替代方案](http://docs.python.org/howto/webservers.html#fastcgi-and-scgi)可以服务于 CGI 的目的，而没有它的一些缺点。

> FastCGI 和 SCGI 试图以另一种方式解决 CGI 的性能问题。他们没有将解释器嵌入到 Web 服务器中，而是创建了长时间运行的后台进程。Web 服务器中还有一个模块可以让 Web 服务器与后台进程“对话”。由于后台进程独立于服务器，它可以用任何语言编写，包括 Python。该语言只需要一个库来处理与网络服务器的通信。
> 
> FastCGI 和 SCGI 之间的区别非常小，因为 SCGI 本质上只是一个“更简单的 FastCGI”。由于对 SCGI 的 Web 服务器支持有限，大多数人使用 FastCGI 代替，其工作方式相同。几乎所有适用于 SCGI 的东西也适用于 FastCGI，所以我们只介绍后者。

# jsf-2 - 支持 bean 的 JSF Jquery 自动完成设置 ID 不起作用

> ID：11369972
> 
> 赞同：0
> 
> 时间：2012-07-06T21:37:06.933
> 
> 标签：jsf-2, jquery-autocomplete

xhtml 中 jsf2.0 中的 Jquery 自动完成工作正常，但是当我尝试在选择函数中为支持 bean 设置值时，它没有被设置，我使用过

```
<div class="ui-widget" style="font-size: 0.9em; padding-left: 0.3em;"  >
                        <label for="organizatiosSelectAuto">Representative Organization: </label>
                        <h:inputText id="organizationSelectAuto"/>
                    </div>
<h:inputText id="orgIDHidden" value="#{letterMBean.orgID}" style="" immediate="true"    onchange="submit()" valueChangeListener="#{letterMBean.orgChanged(this)}"/>

$(function() {
        var availableTags = #{jqueryClientList.arrayObj} ;
        $( '#organizationSelectAuto' ).autocomplete({
            source: availableTags,
            minLength: 2,
            select: function( event, ui ) {    
             alert("id"+ui.item.id);
              document.getElementById('housefrm:orgIDHidden').value = ui.item.id;
              alert("input Text vlaue"+document.getElementById('housefrm:orgIDHidden').value);
            }
        });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T22:36:19.420

它开始工作，因为我必须在选择后在 jquery 函数中提交表单

```
<h:commandButton id="populateOrgId" action="#{letterMBean.orgChanged}" style="display: none" >     </h:commandButton> document.getElementById('housefrm:populateOrgId').click(); 
```

# php - 处理图像而不保存它

> ID：11369974
> 
> 赞同：1
> 
> 时间：2012-07-06T21:37:23.843
> 
> 标签：php, image-uploading

我想对用户上传的图像进行操作。

到目前为止，我所做的是：

1.  `move_uploaded_file`
2.  `imagecreatefrompng`

如何在不保存的情况下对其进行操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-06T21:39:48.287

上传文件后，它必须存储在服务器`/tmp/`文件夹中的某个位置。只需使用`$_FILES['name']['tmp_name']`.

例如：

```
$image = imagecreatefrompng($_FILES['blarg']['tmp_name']); 
```

`blarg`将从它的临时存储位置加载上传的文件（称为`/tmp/php-12bja`. 您不需要调用`move_uploaded_file()`，并且图像不需要保存到磁盘。

# git - 从 Gerrit 中删除补丁

> ID：11369983
> 
> 赞同：4
> 
> 时间：2012-07-06T21:38:20.203
> 
> 标签：git, gerrit

我向 Gerrit 提交了一个补丁供审查，它创建了一个审查页面。我想通过一些修改来更新补丁，但不幸的是最终提交了一个新补丁，它依赖于旧补丁，以及一个新的相应评论页面。发生这种情况是因为我没有修改之前的提交，而是做了一个新的提交并将其推送以供审查。

我现在想知道的是，是否有办法恢复最近的提交，修改对旧提交的更改并将其反映在 Gerrit 上，从而删除最新的评论页面并更新旧的。

随意编辑我的问题，或者问我是否不清楚。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-08T02:06:37.023

当然这是可能的。有 2 个任务 - 清理 Git 存储库并更新 Gerrit。

要清理 git，有几种方法。最自动化的方法是使用`git rebase -i`. 另一种选择是做类似的事情`git checkout HEAD^ && <make edits> && git commit --amend`。

一旦你对你的 git 树感到满意，就推到 Gerrit 为你的原始更改创建一个新的补丁集。然后在您不小心做出的更改上使用“放弃”按钮，您应该一切顺利。

# java - Maven中带有测试阶段的surefire插件的异常

> ID：11369987
> 
> 赞同：6
> 
> 时间：2012-07-06T21:38:51.847
> 
> 标签：java, maven, plugins, surefire

我需要使用surefire v2.12，但每次运行该版本时都会得到附加的堆栈跟踪。如果我运行 v2.10，我不会收到错误消息。我需要这个版本，所以我可以用@Category 注释我的测试类并将它们标记为UnitTests 或IntegrationTests。这是我的命令： mvn test -Dsurefire.version=2.12 -X

```
    [错误] 无法执行目标 org.apache.maven.plugins:maven-surefire-plugin:2.12:test (default-test) on project PROJECT: Execution default-test of goal org.apache.maven.plugins:maven-surefire -插件：2.12：测试失败：java.lang.reflect.InvocationTargetException；嵌套异常是 java.lang.reflect.InvocationTargetException: null: ExceptionInInitializerError: Unexpected ClassNotFoundException 查找类 'org.apache.maven.cli.MavenCli' -> [帮助 1]
org.apache.maven.lifecycle.LifecycleExecutionException：无法在项目 ASPEN 上执行目标 org.apache.maven.plugins:maven-surefire-plugin:2.12:test (default-test)：执行目标 org.apache 的默认测试。 maven.plugins:maven-surefire-plugin:2.12:test failed: java.lang.reflect.InvocationTargetException; 嵌套异常是 java.lang.reflect.InvocationTargetException: null
    在 org.apache.maven.lifecycle.internal.MojoExecutor.execute（MojoExecutor.java:225）
    在 org.apache.maven.lifecycle.internal.MojoExecutor.execute（MojoExecutor.java:153）
    在 org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
    在 org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
    在 org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
    在 org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
    在 org.apache.maven.lifecycle.internal.LifecycleStarter.execute（LifecycleStarter.java:161）
    在 org.apache.maven.DefaultMaven.doExecute（DefaultMaven.java:320）
    在 org.apache.maven.DefaultMaven.execute（DefaultMaven.java:156）
    在 org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
    在 org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
    在 org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
    在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    在 java.lang.reflect.Method.invoke(Method.java:597)
    在 org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced（Launcher.java:290）
    在 org.codehaus.plexus.classworlds.launcher.Launcher.launch（Launcher.java:230）
    在 org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
    在 org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
    引起：org.apache.maven.plugin.PluginExecutionException：执行目标org.apache.maven.plugins的默认测试：maven-surefire-plugin：2.12：测试失败：java.lang.reflect.InvocationTargetException；嵌套异常是 java.lang.reflect.InvocationTargetException: null
    在 org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo（DefaultBuildPluginManager.java:110）
    在 org.apache.maven.lifecycle.internal.MojoExecutor.execute（MojoExecutor.java:209）
    ... 19 更多
    引起：org.apache.maven.surefire.util.SurefireReflectionException: java.lang.reflect.InvocationTargetException; 嵌套异常是 java.lang.reflect.InvocationTargetException: null
    在 org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:197)
    在 org.apache.maven.surefire.util.ReflectionUtils.invokeGetter(ReflectionUtils.java:69)
    在 org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.getSuites(ProviderFactory.java:148)
    在 org.apache.maven.plugin.surefire.booterclient.ForkStarter.getSuitesIterator(ForkStarter.java:317)
    在 org.apache.maven.plugin.surefire.booterclient.ForkStarter.runSuitesForkPerTestSet(ForkStarter.java:149)
    在 org.apache.maven.plugin.surefire.booterclient.ForkStarter.run（ForkStarter.java:118）
    在 org.apache.maven.plugin.surefire.AbstractSurefireMojo.executeProvider(AbstractSurefireMojo.java:199)
    在 org.apache.maven.plugin.surefire.AbstractSurefireMojo.executeAllProviders(AbstractSurefireMojo.java:176)
    在 org.apache.maven.plugin.surefire.AbstractSurefireMojo.executeAfterPreconditionsChecked（AbstractSurefireMojo.java:135）
    在 org.apache.maven.plugin.surefire.AbstractSurefireMojo.execute（AbstractSurefireMojo.java:98）
    在 org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo（DefaultBuildPluginManager.java:101）
    ... 20 更多
    引起：java.lang.reflect.InvocationTargetException
    在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    在 java.lang.reflect.Method.invoke(Method.java:597)
    在 org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
    ... 30 更多
    引起：java.lang.ExceptionInInitializerError
    ... 2 更多
    在 java.lang.Class.forName0（本机方法）
    在 java.lang.Class.forName(Class.java:169)
    在 org.junit.runner.Description.getTestClass(Description.java:207)
    在 org.apache.maven.surefire.common.junit48.FilterFactory$GroupMatcherCategoryFilter.shouldRun(FilterFactory.java:207)
    在 org.apache.maven.surefire.junitcore.JUnitCoreProvider.getSuitesAsList(JUnitCoreProvider.java:169)
    在 org.apache.maven.surefire.junitcore.JUnitCoreProvider.getSuites(JUnitCoreProvider.java:102)
    ... 35 更多
    引起：java.lang.RuntimeException：Unexpected ClassNotFoundException 查找类 'org.apache.maven.cli.MavenCli'
    ... 12 更多

    （此处已删除行）

```

我的 pom.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
<parent>
    <artifactId>sample</artifactId>
    <groupId>sample</groupId>
    <version>1.0</version>
</parent>
<modelVersion>4.0.0</modelVersion>
<artifactId>webapp</artifactId>
<packaging>war</packaging>
<dependencies>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>${org.slf4j-version}</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-log4j12</artifactId>
        <version>${org.slf4j-version}</version>
    </dependency>
    <dependency>
        <groupId>org.mockito</groupId>
        <artifactId>mockito-all</artifactId>
        <version>1.9.0</version>
    </dependency>
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.10</version>
    </dependency>
</dependencies>
<reporting>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>findbugs-maven-plugin</artifactId>
            <version>2.5.1</version>
        </plugin>
    </plugins>
</reporting>
<build>
    <plugins>
        <plugin>
            <artifactId>maven-surefire-plugin</artifactId>
            <dependencies>
                <dependency>
                    <groupId>org.apache.maven.surefire</groupId>
                    <artifactId>surefire-junit47</artifactId>
                    <version>${surefire.version}</version>
                    <scope>test</scope>
                </dependency>
            </dependencies>
            <configuration>
                <groups>com.webapp.api.annotation.type.${group.include}</groups>
                <excludedGroups>com.webapp.api.annotation.type.${group.exclude}</excludedGroups>
            </configuration>
        </plugin>
    </plugins>
</build>
</project> 
```

此外，我能够在我从废品中建立的另一个项目中做到这一点。但在这种情况下，如您所见，我正在覆盖 surefire 插件版本。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T16:19:20.813

为什么不把版本放到这个 pom 中，因为这个 pom 是由你控制的，任何使用你的项目的人都会惊讶于它不起作用，因为他错过了在命令行上提供属性。顺便说一句：您是否通过 mvn -X -Dsurefire.version=2.12 等检查了输出。我认为您会收到相同的错误消息。

我已经重新检查过，如果您以这种方式定义版本，如果有人错过命令行上的选项（-D ...），您的项目将不再正确，您将得到如下信息：

```
INFO] Scanning for projects...
[ERROR] The build could not read 1 project -> [Help 1]
[ERROR]   
[ERROR]   The project com.soebes.katas:code:1.0-SNAPSHOT (/home/katas/pom.xml) has 1 error
[ERROR]     'build.plugins.plugin.version' for org.apache.maven.plugins:maven-surefire-plugin must be a valid version but is '${surefire.version}'. @ line 36, column 20
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/ProjectBuildingException 
```

换句话说，通过命令行上的选项来定义插件版本（或它的依赖项）是一个非常糟糕的主意。我只是建议您在 pom 中定义您需要的所有版本，并通过 surefire 和/或故障安全插件正确使用单元测试和集成测试。这将解决您的问题。