# StackOverflow 问答 000444000-000444999

# wcf - 什么是 HttpContext.Current.Request.RawUrl 的 WCF 等效项？

> ID：444010
> 
> 赞同：34
> 
> 时间：2009-01-14T17:53:08.857
> 
> 标签：wcf, url-rewriting, httpcontext, operationcontext, weboperationcontext

我有一些在纯 WCF 上下文中运行的 RESTful 服务（即未启用 ASP.NET 兼容性，因此没有`HttpContext.Current`可用的对象）。

服务的 URL 在请求开始时使用 an `IHttpModule`（此时确实有 an`HttpContext`并使用 重写它`HttpContext.Current.RewritePath`）重写，以摆脱`.svc`URL 中的扩展等内容。

但是，我需要访问从 WCF 基础结构中请求的原始 URL。`HttpContext.Current.Request.RawUrl`任何地方的`OperationContext`或类上是否有等价物`WebOperationContext`？使用`WebOperationContext.Current.IncomingRequest.UriTemplateMatch.RequestUri`返回重写的 URL，而不是原始 URL。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-05T19:06:54.770

您可以通过执行以下操作获取当前目标的端点及其 Uri：

```
OperationContext.Current.RequestContext.RequestMessage.Headers.To 
```

我认为与以下内容相同：

```
OperationContext.Current.IncomingMessageHeaders.To 
```

这是一个`System.Uri`对象，我相信您可以从中获得`OriginalString`or`PathAndQuery`或任何您想要的部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T13:49:35.880

尝试这样的事情：

```
OperationContext.Current.Channel.LocalAddress.Uri.AbsoluteUri 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-29T21:55:28.650

我发现使用

```
OperationContext.Current.RequestContext.RequestMessage.Headers.To 
```

*大部分*时间都有效，但不适用于我的应用程序。它位于 NLB（网络负载均衡器）后面，这会导致它丢失原始输入主机名。*但是*输入主机仍然在一个名为“主机”的标题中，这令人惊讶地难以获取。它位于：

```
System.ServiceModel.Web.WebOperationContext.Current.IncomingRequest.Headers["Host"] 
```

（**System.ServiceModel.OperationContext.Current.IncomingMessageHeaders**的标头对象并没有真正拥有来自客户端的所有标头）

# .net - Powershell 远程命令

> ID：444012
> 
> 赞同：2
> 
> 时间：2009-01-14T17:53:50.277
> 
> 标签：.net, powershell

我正在尝试在 powershell 中的远程计算机上运行 get-service 命令。在做了一些研究之后，这似乎只是可能的 powershell 2 CTP，我不能使用它，因为我需要使用安装了 exchange 的 powershell 版本，通常是 1。似乎 -computerName 开关仅在 get- 中可用ps 2中的服务。所以我几乎决定不去，但想看看这里是否有人在我放弃之前有一个聪明的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-22T16:07:34.660

这些都是很好的答案，但它们只能帮助您提供服务。你想要的是可以与任何东西一起使用的东西：

**WINRS 是您最好的朋友！**

```
[4120:0]PS> winrs -r:localhost powershell get-service h*

Status   Name               DisplayName
------   ----               -----------
Running  hidserv            Human Interface Device Access
Running  hkmsvc             Health Key and Certificate Management
Stopped  HomeGroupListener  HomeGroup Listener
Running  HomeGroupProvider  HomeGroup Provider 
```

顺便说一句 - WINRS 使用 WS-MAN，这意味着它可以跨防火墙工作。

实验！享受！从事！

Jeffrey Snover [MSFT] Windows 管理合作伙伴架构师

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-14T18:04:44.530

好了，你可以直接去WMI获取服务信息。

```
gwmi Win32_Service -computername FOO 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-14T21:10:45.310

这将在 v1 中工作：

[System.ServiceProcess.ServiceController]::GetServices("String machineName")

# ant - 使用 Ant 属性文件而不是“属性任务”的原因

> ID：444016
> 
> 赞同：4
> 
> 时间：2009-01-14T17:55:39.493
> 
> 标签：ant, properties, build-process

我目前正在与一些喜欢设置定义环境特定变量而不是使用属性文件的 Ant 任务的开发人员合作。他们似乎更喜欢这样做，因为这样更容易输入：

```
ant <environment task> dist 
```

比输入：

```
ant -propertyfile <environment property file> dist 
```

例如：

```
<project name="whatever" default="dist">

<target name="local">
    <property name="webXml" value="WebContent/WEB-INF/web-local.xml"/>
</target>

<target name="remote">
    <property name="webXml" value="WebContent/WEB-INF/web-remote.xml"/>
</target>

<target name="build">
    <!-- build tasks here --->
</target>

<target name="dist" depends="build">
    <war destfile="/dist/foo.war" webxml="${webXml}">
         <!-- rest of war tasks here -->
    </war>
</target> 
```

我发现很难让他们相信属性文件是正确的选择。我相信属性文件更好，因为：

*   它们提供了更大的灵活性——如果您需要一个新环境，只需添加一个新的属性文件
*   发生了什么更清楚了-您必须了解这个小“技巧”​​才能意识到他们正在完成什么
*   不提供默认值和使用覆盖的能力 - 如果他们使用属性文件，他们可以在项目顶部提供默认值，但能够用文件覆盖它们
*   如果未在命令行上提供环境任务，脚本不会中断

当然，他们听到的只是他们需要更改 Ant 脚本并且必须在命令行上输入更多内容。

您能否提供任何其他参数来支持属性文件而不是“属性任务”？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-14T18:11:01.927

属性任务将构建文件与环境紧密耦合。如果您的开发人员同事认为他们“必须根据您的建议更改他们的 ant 脚本”，那么他们为什么不争论每次必须部署到新环境时都更改它呢？:)

也许您可以说服他们同时允许属性文件和命令行配置。我设置了我的 Ant 构建，以便如果 build.properties 存在于与 build.xml 相同的目录中，它将读取它。否则它使用一组硬编码到构建中的默认属性。这是非常灵活的。

```
<project name="example">

    <property file="build.properties"/>

    <property name="foo.property" value="foo"/>
    <property name="bar.property" value="bar"/>

    ...
</project> 
```

我没有为项目提供 build.properties（即 build.properties 在 SCM 中没有版本控制）。这样开发人员就不会被迫使用属性文件。我确实提供了一个开发人员可以参考的 build.properties.example 文件。

由于**Ant 属性一旦设置，就是不可变**的，构建文件将使用按以下顺序定义的属性：

*   通过命令行提供`-D`或`-propertyfile`通过命令行提供的属性
*   从 build.properties 加载的属性
*   build.xml 中的默认属性

这种方法的优点：

*   构建文件更小，因此更易于维护，不易出错
*   无法摆脱在命令行设置属性的开发人员仍然可以使用它们。
*   可以使用属性文件，但不是必需的

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T18:23:17.253

你的论点已经非常有说服力了。如果这些争论没有奏效，那么争论并不能解决问题。事实上，*没有什么*能解决问题。不要以为人是理性的，会做最实际的事情。他们的自负参与其中。

别吵了。即使你赢了，你制造的怨恨和恼怒也不值得。赢得争论可能比失败更糟糕。

做你的案子，然后放手。一段时间后，他们可能会决定改用你的方式（因为它实际上更好）。如果发生这种情况，他们会表现得好像这是他们自己的想法。不会提及你提出的。

另一方面，他们可能永远不会转换。

唯一的解决办法是朝着权威的位置努力，在那里你可以说出事情是如何做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T20:29:32.490

第一个解决方案（使用 ant 属性）的问题基本上是硬编码。当您为自己开始一个项目时可能很方便，但很快您必须改掉这个坏习惯。

除了我直接提交了 build.properties 文件外，我使用的属性文件接近于 robhruska 所说的内容。这样你就有了一个默认的。

另一方面，我知道我可以在 build.xml 中添加这些默认值。（我可能会在接下来的几个小时/几天内尝试这样做;-)）。

无论如何，我真的不喜欢第一种方法，我会强迫那些人遵循第二种方法......

# asp.net - 同步不同子域中的 cookie 和会话 (asp.net)

> ID：444018
> 
> 赞同：10
> 
> 时间：2009-01-14T17:56:33.377
> 
> 标签：asp.net, cookies, session

我在 asp.net 中建立一个站点并有多个子域。例如，one.cookies.com two.cookies.com

我希望我的用户能够登录任一子域并登录两个网站。此外，我希望**会话和 cookie**保持同步。到目前为止，我还没有找到可靠的方法来做到这一点。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-09-11T21:03:12.497

如果您想要同步 ASP.NET 会话并且您没有使用表单身份验证（例如，您的站点没有登录），请尝试将以下代码添加到您的 Globals.asax 文件中。这对我来说就像一个冠军，并为我节省了一些严重的悲伤。

```
protected void Application_PreRequestHandlerExecute(Object sender, EventArgs e)
{
  /// only apply session cookie persistence to requests requiring session information
  #region session cookie

  if (Context.Handler is IRequiresSessionState || Context.Handler is IReadOnlySessionState )
  {
    /// Ensure ASP.NET Session Cookies are accessible throughout the subdomains.
    if (Request.Cookies["ASP.NET_SessionId"] != null && Session != null && Session.SessionID != null)
    {
      Response.Cookies["ASP.NET_SessionId"].Value = Session.SessionID;
      Response.Cookies["ASP.NET_SessionId"].Domain = ".know24.net"; // the full stop prefix denotes all sub domains
      Response.Cookies["ASP.NET_SessionId"].Path = "/"; //default session cookie path root         
    }
  }
  #endregion    
} 
```

我发现这个最初发布在这里： [http ://www.know24.net/blog/ASPNET+Session+State+Cookies+And+Subdomains.aspx](http://www.know24.net/blog/ASPNET+Session+State+Cookies+And+Subdomains.aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-14T18:21:58.317

创建 cookie 时，您可以设置域：

```
HttpCookie cookie = new HttpCookie("name", "value");
cookie.Domain = "cookies.com"; 
```

这将允许从 cookies.com 的所有子域访问您的 cookie。

如果您使用的是 FormsAuthentication，那么您可以在 web.config 中为 auth cookie 设置域：

```
<forms name=".ASPXAUTH"
       loginUrl="login.aspx"
       defaultUrl="default.aspx"
       protection="All"
       timeout="30"
       path="/"
       requireSSL="false"
       domain="cookies.com">
</forms> 
```

请记住，要在多个子域上运行单点登录，您的 ASP.NET 应用程序必须共享相同的[机器密钥](https://msdn.microsoft.com/en-us/library/w8h3skw9%28v=vs.100%29.aspx)，如本 CodeProject[文章中所述](http://www.codeproject.com/KB/aspnet/SingleSignon.aspx)。

在不同的子域（不同的工作进程）之间共享会话更加困难，因为会话受限于应用程序，您必须实现自定义会话同步机制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-27T12:59:22.793

是的，您需要使用“.cookies.com”而不是“cookies.com”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T18:02:33.783

[我相信为http://cookies.com](http://cookies.com)制作 cookie 。（未列出子域或 www）

# asp.net - .Net 母版页性能

> ID：444022
> 
> 赞同：0
> 
> 时间：2009-01-14T17:57:27.040
> 
> 标签：asp.net, master-pages, customization

我正在为我的讨论寻求一些帮助。我们正在讨论定制问题的两种解决方案。一种使用（嵌套）母版页。每个自定义页面一个母版页。此外，所有页面都有一个标准母版页。第二个使用标准页面，如果存在，它会重定向到自定义页面。

我的问题是，哪个更可取？每次都必须加载 2 个母版页，或者只需要加载 1 个母版页，有时需要重定向（Response.Redirect 或 Server.Transfer）到自定义页面。

我真的找不到有关母版页性能的任何信息。我应该将它们视为另一个（有点倒置的）用户控件还是应该轻而易举地使用它们？

编辑：您可以假设 Response.Redirect 进行传输。您可以假设重定向发生在生命周期的 PreInit 阶段。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T18:03:55.577

母版页在某种意义上是倒置的用户控件（它们“围绕”内容，而不是推送到页面中的用户控件内容）。没有一个经验法则说可以轻松使用母版页——母版页的性能成本与它导致将多少代码（HTML 和其他）推送到 HTTP 数据流中成正比。

为了我的钱，我会站在最可读和可维护的代码的一边。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T18:04:25.013

所以，无论如何，它都是一个网络表单应用程序，对吧？您是否考虑过模型视图控制器的视角？

关于嵌套的 MasterPages，我是在客户端 CRM 应用程序上完成的，我可以向您保证，您不会遇到任何加载问题，除非通常关于 Internet 和服务器速度的问题，如果您认为这是完成的最佳方式或目标，去吧。

每个母版页都会触发它们的事件，通常我们会考虑哦，好吧，2 个母版页加上一个内容或几个内容页可能是指向加载时间的问题，但这需要几毫秒的时间来执行所有这些，所以......要安全。

你唯一需要注意的是，不要被你能找到的所有 javascript 插件所迷惑，选择一个好的库并只使用它，JQuery（现在版本 1.3.0 将是最好的选择）。

至少这是我的看法:)

# c# - 在 C# 中使用状态条

> ID：444031
> 
> 赞同：13
> 
> 时间：2009-01-14T18:01:10.463
> 
> 标签：c#, winforms, anchor, statusstrip

考虑[System.Windows.Forms.StatusStrip](https://msdn.microsoft.com/en-us/library/system.windows.forms.statusstrip%28v=vs.110%29.aspx)。我已在我的 Windows 窗体应用程序中添加了一个 StatusStrip，但我遇到了一些问题。

我想在 StatusStrip 的左侧锚定一个标签，并在右侧锚定一个进度条，但我找不到设置这些属性的方法。

然后我想我可能需要创建两个 StatusStrips 并将它们锚定在表单底部的任一侧......这并没有成功；除此之外，它只是感觉不对。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-14T18:19:31.987

只需将`Spring`标签控件上的属性设置为就`True`可以了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-14T18:21:40.393

您需要做的是将进度条的对齐属性设置为正确。然后将 StatusStrip 的 LayoutStyle 设置为 Horizo​​ntalStackWithOverflow。

```
 private void InitializeComponent()
    {
        this.statusStrip1 = new System.Windows.Forms.StatusStrip();
        this.toolStripStatusLabel1 = new System.Windows.Forms.ToolStripStatusLabel();
        this.toolStripProgressBar1 = new System.Windows.Forms.ToolStripProgressBar();
        this.statusStrip1.SuspendLayout();
        this.SuspendLayout();
        // 
        // statusStrip1
        // 
        this.statusStrip1.Items.AddRange(new System.Windows.Forms.ToolStripItem[] {
    this.toolStripStatusLabel1,
    this.toolStripProgressBar1});
        this.statusStrip1.LayoutStyle = System.Windows.Forms.ToolStripLayoutStyle.HorizontalStackWithOverflow;
        this.statusStrip1.Location = new System.Drawing.Point(0, 250);
        this.statusStrip1.Name = "statusStrip1";
        this.statusStrip1.Size = new System.Drawing.Size(467, 22);
        this.statusStrip1.TabIndex = 0;
        this.statusStrip1.Text = "statusStrip1";
        // 
        // toolStripStatusLabel1
        // 
        this.toolStripStatusLabel1.Name = "toolStripStatusLabel1";
        this.toolStripStatusLabel1.Size = new System.Drawing.Size(117, 17);
        this.toolStripStatusLabel1.Text = "toolStripStatusLabel1";
        // 
        // toolStripProgressBar1
        // 
        this.toolStripProgressBar1.Alignment = System.Windows.Forms.ToolStripItemAlignment.Right;
        this.toolStripProgressBar1.Name = "toolStripProgressBar1";
        this.toolStripProgressBar1.Size = new System.Drawing.Size(100, 16);

    }

    private System.Windows.Forms.StatusStrip statusStrip1;
    private System.Windows.Forms.ToolStripStatusLabel toolStripStatusLabel1;
    private System.Windows.Forms.ToolStripProgressBar toolStripProgressBar1; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T18:23:45.567

这可以通过 statusStrip 的默认表格布局来实现，只需在当前标签和 progressBar 之间放置另一个标签并将 Spring 属性设置为 true。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T18:19:27.387

您是否尝试过将 ProgresBarToolStripItem 的[Alignment](http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstripitem.alignment(VS.85).aspx)属性设置为[Right](http://msdn.microsoft.com/en-us/library/system.windows.forms.toolstripitemalignment(VS.85).aspx)？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-19T04:19:33.880

打开您的设计器并设置 this.toolStripStatusLabel1.Alignment = System.Windows.Forms.ToolStripItemAlignment.Right;

# asp.net - 是否可以在 Linux 上托管 ASPX 网站？

> ID：444055
> 
> 赞同：2
> 
> 时间：2009-01-14T18:06:55.757
> 
> 标签：asp.net, linux

我们正在尝试将很多工作中的东西转换为 Linux Red hat。最近安装了 Windows Server 2003。我们目前在 windows 服务器机器上托管一个 asp .net 网站，我想知道是否有任何软件可以让您在 linux 上托管相同的网站？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-14T18:08:46.707

在某种程度上，是的。[Mono 项目](http://www.mono-project.com/Main_Page)支持 ASP.NET 2.0 网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T18:12:45.870

您可以考虑使用 vmware 等虚拟化软件在 linux 主机上运行 windows 虚拟机。我不知道这是否符合你想要做的，但这是另一种选择。

# c# - 如何从 Windows Mobile 应用程序获取 HTML 网页？

> ID：444056
> 
> 赞同：1
> 
> 时间：2009-01-14T18:07:30.123
> 
> 标签：c#, html, windows-mobile

我正在使用 C#.net 为 windows mobile 6 开发应用程序，我需要从网页获取 HTML 代码，我的意思是，我需要下载页面然后获取代码或将其解析为字符串。

有人知道我该怎么做吗？

我知道有用于桌面应用程序的 WebClient 类，但我没有为移动应用程序找到类似的东西

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T18:17:06.283

您可以使用[HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)类发出 GET 请求并读取 HTML 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T18:45:12.810

使用 System.Net.WebClient 类并调用 DownloadStringAsync 以异步方式从 Web 下载任何资源。

# python - python - 可读的对象列表

> ID：444058
> 
> 赞同：5
> 
> 时间：2009-01-14T18:07:54.490
> 
> 标签：python, list

这可能是一个常见的问题，但我可以在这方面提供帮助。我有一个类对象列表，我试图弄清楚如何让它打印该类中的一个项目，而不是在其中显示；

```
<__main__.evolutions instance at 0x01B8EA08> 
```

而是显示类的选定对象的选定属性。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-14T18:12:20.740

如果您只想显示每个类实例的特定属性，您可以这样做

```
print([obj.attr for obj in my_list_of_objs]) 
```

这将打印出`attr`列表中每个对象的属性`my_list_of_objs`。或者，您可以`__str__()`为您的类定义方法，该方法指定如何将您的对象转换为字符串：

```
class evolutions:
    def __str__(self):
        # return string representation of self

print(my_list_of_objs)  # each object is now printed out according to its __str__() method 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T18:11:47.697

检查 __str__() 和 __repr__() 方法。

请参阅[http://docs.python.org/reference/datamodel.html#object.__repr__](http://docs.python.org/reference/datamodel.html#object.__repr__)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-14T18:11:54.483

你会想要覆盖你的类的“to string”方法：

```
class Foo:
    def __str__(self):
        return "String representation of me" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-14T18:19:54.653

您需要覆盖对象 [s] 的[`__str__`](http://docs.python.org/reference/datamodel.html#object.__str__)或方法[`__repr__`](http://docs.python.org/reference/datamodel.html#object.__repr__)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-29T19:17:38.677

我的偏好是定义一个`__repr__`可以重建对象的函数（尽可能）。除非你也有一个，否则`__str__`两者都会调用这个方法。`repr()``str()`

所以例如

```
class Foo(object):
    def __init__(self, a, b):
        self.a = a
        self.b = b
    def __repr__(self):
        return 'Foo(%r, %r)' % (self.a, self.b) 
```

这样做，你有一个可读的字符串版本，作为奖励，它可以被评估以获得原始对象的副本。

```
x = Foo(5, 1 + 1)
y = eval(str(x))

print y
-> Foo(5, 2) 
```

# .net - 在 .net 中验证和读取 xml 文件的最简单方法是什么？

> ID：444064
> 
> 赞同：6
> 
> 时间：2009-01-14T18:09:37.140
> 
> 标签：.net, xml, xsd

什么是最简单/最简单/最干净的方法：

1.  从文件系统中读取一个 xml 文件
2.  针对 xsd 验证 xml
3.  将部分 xml 文件读入变量

使用.net。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-14T20:35:01.840

基本上，要进行 XSD 验证，您需要使用带有 ReaderSettings 的 XmlReader 来定义要验证的 XSD 文件，以及响应/捕获验证错误的事件。

要读取 XSD 文件，请使用以下内容：

```
StreamReader xsdReader = new StreamReader(xsdFileName); 
XmlSchema Schema = new XmlSchema();
Schema = XmlSchema.Read(xsdReader, new ValidationEventHandler(XSDValidationEventHandler)); 
```

并且捕获在读取 XSD 时可能出现的任何错误的事件处理程序（例如，如果它本身无效）将具有以下签名：

```
private static void XSDValidationEventHandler(object sender, ValidationEventArgs e) 
```

错误消息在 e.Message 中。

在内存中加载 XSD 后，实例化 XmlReader 并使用正确的设置来强制执行 XSD 验证：

```
XmlReaderSettings ReaderSettings = new XmlReaderSettings();    
ReaderSettings.ValidationType = ValidationType.Schema;
ReaderSettings.Schemas.Add(Schema);   
ReaderSettings.ValidationEventHandler += new ValidationEventHandler(XMLValidationEventHandler); 
```

此错误事件处理程序具有与上述相同的签名。

然后实际从头到尾读取文件：

```
XmlTextReader xmlReader = new XmlTextReader(xmlFileName);
XmlReader objXmlReader = XmlReader.Create(xmlReader, ReaderSettings);
while (objXmlReader.Read()) { } 
```

如果发生任何验证错误，则调用您的事件处理程序，您可以在其中捕获错误消息并将它们显示给用户（或者只是有一个指示验证是否成功的标志 - 您的呼叫:)）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-14T18:29:08.083

根据您想要的容错级别和错误报告，您可能会发现 .NET 3.5 中引入的新 XML Api 很有用 - 类[XDocument](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx)、[XElement](http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.aspx)、[XAttribute](http://msdn.microsoft.com/en-us/library/system.xml.linq.xattribute.aspx)等等，都来自[System.Xml.Linq 命名空间](http://msdn.microsoft.com/en-us/library/system.xml.linq.aspx).

新 XML Api 的设计深受从旧 XMLDocument 设计中吸取的经验教训的影响，并且更轻量级且更易于使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T18:16:10.043

使用 XMLDocument 和 XMLNode 对象。

您可以使用 XMLDocument 中的 Load 和 LoadXML 方法来加载 xml 文档。然后，您可以使用 SelectSingleNode 根据该节点的 XPath 获取值。或者您可以使用 SelectNodes 方法加载整个节点。

您可以使用 XMLDocument 对象的 Validate 方法根据 XSD 验证 XML。

# eclipse - tcp/ip 监视器

> ID：444065
> 
> 赞同：1
> 
> 时间：2009-01-14T18:10:13.783
> 
> 标签：eclipse, tcp, monitor

在 Eclipse 中，我运行了一个 weblogic 服务器，并在其中部署了一个 j2ee 应用程序。该应用程序在端口 7001 上提供服务。我想将监视器连接到应用程序，我不知道要使用哪些端口。我想我知道要为主机名（localhost：7001）输入什么，但不确定要为类型和本地端口使用什么。在proeferences中，本地端口是什么意思。在应用程序运行之前或之后启动监视器是否重要？我的目标是在我登录时观察流量，通过浏览器从我的本地机器浏览到应用程序的其他部分。谢谢你的帮助

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-18T11:23:06.443

如果您的网络服务原始网址是`http://abc.xyz:5674/ws/wsdl:linkaction`

然后对 tcp/ip 监视器进行这些设置：

```
local monitoring port:8888
hostname:abc.xyz
port:5674
type:http
Start it 
```

并将 web 服务 url 更改为“http://localhost:8888/ws/wsdl:linkaction”

将您的 client.java 作为 java 应用程序运行

所以你的请求将通过 tcp/ip 代理，你可以看到肥皂消息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-14T18:18:42.550

监视器基本上充当代理。本地监控端口是您将向监控器发送请求的端口。它可以是任何空闲端口（例如 7002）。

主机名、端口和类型描述了您希望监视器代理的对象。在您的情况下，它将是 localhost、7001 和 HTTP。

然后，您将使用浏览器访问 localhost:7002，代理的请求和响应将显示在监视器中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-08T07:23:25.397

普通 SOAP 信封流程
1\. 客户端 ----> SOAP 信封 ----> 服务器：9999

2.  服务器：9999 ----> SOAP 信封 ---> 客户端

要拦截 SOAP 信封，您可以在客户端和服务器之间托管另一个服务器（“TcpMonitorServer”），请参阅新流程：

1.  客户端 ----> SOAP 信封 ----> TcpMonitorServer:8888

2.  TcpMonitorServer:8888 --> SOAP 信封 ---> Server:9999

3.  服务器：9999 ----> SOAP 信封 ---> TcpMonitorServer：8888

4.  TcpMonitorServer:8888 ----> SOAP 信封 ---> 客户端

[来源](http://www.mkyong.com/webservices/jax-ws/how-to-trace-soap-message-in-eclipse-ide/)

# project-management - PPM - 项目组合管理

> ID：444066
> 
> 赞同：4
> 
> 时间：2009-01-14T18:10:39.103
> 
> 标签：project-management, projects, portfolio

贵公司的 PPM（管理项目、需求、时间表等）解决方案是什么？您对此有何经验？

我正在尝试了解有关该工具的信息，而不是您公司的特定业务流程。

向大家问好！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-09-07T19:31:36.727

路线图[http://www.ppmroadmap.com/](http://www.ppmroadmap.com/)采用与 Basecamp 相同的轻量级方法并将其应用于 PPM。事实上，Roadmap 支持与 Basecamp 的实时集成。它价格合理且易于使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-05T07:43:07.737

在我们公司，ms项目标准用于管理项目、需求、时间表等。我使用微软项目甘特图进行项目调度和跟踪，它很好地达到了目的。您可以从微软网站下载 ms 项目试用版。[您可以在此链接](http://www.microsoft.com/project/en/us/project-professional-2007.aspx)获得有关 ms 项目的更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-21T19:23:27.123

对于 Visual Studio 团队，Microsoft 的 Team Foundation Server 变得越来越好...与之前的 2008 和 2005 相比，2010 提供了更多的同步和任务分层管理，但仍然不是一个开箱即用的完全健康的 PPM 解决方案...如果您有技能，为您的组织创建一个完整的流程模板，并真正发挥 TFS 的力量。感谢 msft 的 2010 版本和大大改进的 MS Project 2010 产品……我自己正在评估这个。

@task 即使在其标准版套件中也很棒 - 价格昂贵，但允许在 SAAS 模型上开箱即用地进行总跟踪、管理、仪表板、时间表、文档管理等。

Basecamp 已成为对 PPM 问题的流行适应。我已经与客户一起使用过它，但我很想尽快为自己试用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T18:57:41.147

我们使用 Microsoft Great Plains，并且讨厌它！我们还使用 Siebel 服务进行缺陷跟踪……讨厌它！

不久前，我们实现了[Mantis](http://www.mantisbt.org/)，这是一个开源错误跟踪工具，用于需要客户访问它的小项目（我们所有的公司应用程序都仅供内部访问）。Mantis 非常成功，我们有 3 个团队在使用它，并且拒绝转向使用 Siebel。

我们还使用[dotProject](http://www.dotproject.net/)进行项目管理——它很好，但我不确定它是否与更昂贵的项目工具一样好。

因此，我的经验是，基于 Web 的开源工具非常好（例如[OrangeHRM](http://www.orangehrm.com/)、[WebERP](http://weberp.org/)、[vTiger](http://www.vtiger.com/)）、非常有用（而且免费），而且它们做得非常好。商业应用程序有时可能是完整的裤子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-28T10:25:51.510

在我们的组织中，我们使用 Microsoft Project 2010 进行[项目组合管理](http://www.microsoft.com/project/en/us/project-portfolio-management.aspx)。它用于获得所有项目和团队的可见性和控制，有助于增强决策制定，提高与业务战略的一致性，通过增强项目执行帮助最大限度地利用资源和管理项目。绝对推荐它。

# sql-server - VarBinary vs Image SQL Server 数据类型来存储二进制数据？

> ID：444072
> 
> 赞同：92
> 
> 时间：2009-01-14T18:12:07.587
> 
> 标签：sql-server

我需要将二进制文件存储到 SQL Server 数据库。Varbinary 和 Image 中哪种数据类型更好？

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2009-01-14T18:16:17.750

由于图像已被弃用，您应该使用 varbinary。

每个[微软](http://msdn.microsoft.com/en-us/library/ms187993.aspx) **（感谢@Christopher 的链接）**

> ntext 、 text 和 image 数据类型将在 Microsoft SQL Server 的未来版本中删除。避免在新的开发工作中使用这些数据类型，并计划修改当前使用它们的应用程序。请改用 nvarchar(max)、varchar(max) 和 varbinary(max)。
> 
> 用于存储大型非 Unicode 和 Unicode 字符和二进制数据的固定和可变长度数据类型。Unicode 数据使用 UNICODE UCS-2 字符集。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-14T18:27:58.663

**`varbinary(max)`**是要走的路（在 SQL Server 2005 中引入）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-14T18:45:54.087

还有相当漂亮的[`FileStream`](http://technet.microsoft.com/en-us/library/bb933993.aspx)，在 SQL Server 2008 中引入。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-04-10T06:46:25.020

[https://docs.microsoft.com/en-us/sql/t-sql/data-types/ntext-text-and-image-transact-sql](https://docs.microsoft.com/en-us/sql/t-sql/data-types/ntext-text-and-image-transact-sql)

> **图片**
> 
> 从 0 到 2^31-1 (2,147,483,647) 字节的可变长度二进制数据。仍然支持使用图像数据类型，但请注意：

[https://docs.microsoft.com/en-us/sql/t-sql/data-types/binary-and-varbinary-transact-sql](https://docs.microsoft.com/en-us/sql/t-sql/data-types/binary-and-varbinary-transact-sql)

> **varbinary** [ ( n | max) ]
> 
> 可变长度二进制数据。n 可以是 1 到 8,000 之间的值。max 表示最大存储大小为 2^31-1 字节。存储大小是输入数据的实际长度 + 2 个字节。输入的数据长度可以是 0 字节。varbinary 的 ANSI SQL 同义词是二进制变量。

所以两者的大小相同（2GB）。但请注意：

[https://docs.microsoft.com/en-us/sql/database-engine/deprecated-database-engine-features-in-sql-server-2016#features-not-supported-in-a-future-version- of-sql 服务器](https://docs.microsoft.com/en-us/sql/database-engine/deprecated-database-engine-features-in-sql-server-2016#features-not-supported-in-a-future-version-of-sql-server)

虽然“图像”数据类型的结尾仍未确定，但您应该使用“未来”证明等价物。

**但是您必须问自己：为什么将 BLOBS 存储在 Column 中？**

[https://docs.microsoft.com/en-us/sql/relational-databases/blob/compare-options-for-storing-blobs-sql-server](https://docs.microsoft.com/en-us/sql/relational-databases/blob/compare-options-for-storing-blobs-sql-server)

# ruby-on-rails - 有没有很好的资源来获取 Ruby 企业版在野外的使用情况？

> ID：444077
> 
> 赞同：1
> 
> 时间：2009-01-14T18:13:17.867
> 
> 标签：ruby-on-rails, ruby, passenger, interpreter, ruby-enterprise-edition

我们在内部使用 Phusion 堆栈（[Passenger](http://www.modrails.com/)和[Ruby Enterprise Edition](http://www.rubyenterpriseedition.com/index.html)）取得了很好的成果，但我无法找到很多关于它们在野外使用的数据，尤其是 REE。我喜欢类似于 WWR 的[High Profile Organizations Using Rails](http://www.workingwithrails.com/high-profile-organisations)或 Ben Forta 的[Who's Using ColdFusion？](http://www.forta.com/cf/using/list.cfm)列表。

在这方面有一些[谷歌小组](http://groups.google.com/group/phusion-passenger/browse_thread/thread/521dd6281331dd9e/eeee266cad1d3e70?#eeee266cad1d3e70)活动，但我正在寻找更多的东西，因为没有更好的词，PHB 友好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T21:31:13.427

包括Engine Yard在内的很多人都在使用Passenger。

REE 没有被广泛采用。

但是以前 jRuby 也是如此，现在很多人都在使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-15T16:48:59.927

我建议不要使用 REE，当我使用脚本/控制台时，它有稳定性问题给我 malloc 错误。

无法提供一组关于如何复制它的说明。刚刚似乎发生了。

# javascript - 您是否建议在 JavaScript 中的每条语句后使用分号？

> ID：444080
> 
> 赞同：51
> 
> 时间：2009-01-14T18:14:04.260
> 
> 标签：javascript

在许多情况下，如果您忽略分号，JavaScript 解析器会为您插入分号。我的问题是，你把它们排除在外了吗？

如果您不熟悉规则，请参阅[Mozilla 网站](http://www.mozilla.org/js/language/js20-2000-07/rationale/syntax.html)上的分号插入说明。这是关键点：

> 如果JavaScript 程序形式的第一个到第 n^(个标记在语法上有效，但第一个到第 n+1)^(个标记不合法，并且在第 n)^个标记和第 n+1^个标记之间存在换行符，则解析器在第 n^个和第 n+1个标记之间插入虚拟^(分号)标记后，尝试再次解析程序。

该描述可能不完整，因为它没有解释@Dreas 的示例。任何人都有完整规则的链接，或者看看为什么这个例子有一个分号？（我在 JScript.NET 中尝试过。）

[这个stackoverflow问题](https://stackoverflow.com/questions/42247/are-semicolons-needed-after-an-object-literal-assignment-in-javascript)是相关的，但只讨论了一个特定的场景。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-01-14T18:14:14.993

是的，您应该在 JavaScript 中的每条语句后使用分号。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-07-23T04:23:25.423

在没有分号的情况下中断的模棱两可的情况：

```
// define a function
var fn = function () {
    //...
} // semicolon missing at this line

// then execute some code inside a closure
(function () {
    //...
})(); 
```

这将被解释为：

```
var fn = function () {
    //...
}(function () {
    //...
})(); 
```

我们最终将第二个函数作为参数传递给第一个函数，然后尝试将第一个函数调用的结果作为函数调用。第二个函数将在运行时失败并出现“...不是函数”错误。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-01-14T18:19:55.480

是的，您应该始终使用分号。为什么？因为如果您最终使用 JavaScript 压缩器，您的所有代码都将在一行中，这会破坏您的代码。

试试[http://www.jslint.com/](http://www.jslint.com/)；它会伤害您的感受，但会向您展示许多编写更好 JavaScript 的方法（其中一种方法是始终使用分号）。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-07-09T05:57:27.453

每个人似乎都想念的是，JavaScript 中的分号不是语句*终止符*，而是语句*分隔符*。这是一个微妙的区别，但它对解析器的编程方式很重要。像对待他们一样对待他们，你会发现把他们排除在外会感觉更自然。

我用其他语言编程，其中分号是语句*分隔符*，也是可选的，因为解析器在不破坏语法的换行符上执行“分号插入”。所以当我在 JavaScript 中发现它时，我并不陌生。

我不喜欢语言中的噪音（这是我不擅长 Perl 的原因之一），而分号在 JavaScript 中是噪音。所以我省略了它们。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-01-14T18:26:06.653

我想说**一致性比节省几个字节更重要**。我总是包含分号。

另一方面，我想指出，有很多地方在语法上不需要分号，即使压缩器正在清除所有可用的空格。例如，在一个块的末尾。

```
if (a) { b() } 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-01-14T18:50:09.990

JavaScript 在解释你的代码时会自动插入分号，所以如果你把 return 语句的值放在行的下面，它就不会被返回：

您的代码：

```
return
5 
```

JavaScript 解释：

```
return;
5; 
```

因此，由于 JavaScript 的自动分号插入，没有返回任何内容

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-01-14T18:45:57.160

我认为这与上次播客讨论的内容相似。“对你接受的内容保持自由”意味着必须在 Javascript 解析器中投入额外的工作来修复分号被遗漏的情况。现在我们有一大堆页面漂浮着糟糕的语法，当某些浏览器决定对其接受的内容更加严格时，这些页面可能会在未来的某一天被打破。这种类型的规则也应该适用于 HTML 和 CSS。您可以编写损坏的 HTML 和 CSS，但当某些浏览器无法正确解释您的错误代码时，您会遇到奇怪且难以调试的行为，请不要感到惊讶。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-07-11T14:43:58.080

文章[JavaScript 中的分号是可选的](http://mislav.uniqpath.com/2010/05/semicolons/)，它提出了一些关于在 Javascript 中不使用分号的非常好的观点。它涉及该问题的答案所提出的所有要点。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-02-14T19:50:06.943

这是我在任何地方找到[的对自动分号插入的最佳解释。](http://inimino.org/~inimino/blog/javascript_semicolons)它会清除你所有的不确定和怀疑。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-14T18:14:41.123

不，仅在需要时使用分号。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-14T19:07:21.487

我使用分号，因为这是我的习惯。现在我明白了为什么我不能将字符串分成两行......它将分号放在每行的末尾。

# c - 使 GtkScrolledWindow 默认显示所有子级

> ID：444085
> 
> 赞同：1
> 
> 时间：2009-01-14T18:15:13.027
> 
> 标签：c, gtk, scroll

如何初始化[GtkScrolledWindow](http://library.gnome.org/devel/gtk/stable/GtkScrolledWindow.html)以通过尽可能增长来避免滚动条？

默认情况下，它似乎尽可能小。

演示代码（退出`SIGINT`）：

```
#include <gtk/gtk.h>

int main(int argc, char *argv[]) {
    GtkWidget* window;
    GtkWidget* content;
    GtkWidget* sw;

    gtk_init(&argc, &argv);
    window = gtk_window_new(GTK_WINDOW_TOPLEVEL);

    sw = gtk_scrolled_window_new(NULL, NULL);
    gtk_scrolled_window_set_policy(GTK_SCROLLED_WINDOW(sw),
            GTK_POLICY_AUTOMATIC, GTK_POLICY_AUTOMATIC);
    gtk_container_add(GTK_CONTAINER(window), sw);
    gtk_widget_show(sw);

    content = gtk_button_new_with_label("This is a very, very"
            "very very very very very very very very long text");
    gtk_scrolled_window_add_with_viewport(GTK_SCROLLED_WINDOW(sw), content);
    gtk_widget_show(content);

    gtk_widget_show(window);
    gtk_main();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T06:40:59.597

我认为这既有效又不是丑陋的黑客（很多）：

```
int main(int argc, char *argv[]) {
    GtkWidget* window;
    GtkWidget* content;
    GtkWidget* sw;

    GtkRequisition size;
    GtkWidget* viewport;

    gtk_init(&argc, &argv);
    window = gtk_window_new(GTK_WINDOW_TOPLEVEL);

    sw = gtk_scrolled_window_new(NULL, NULL);
    gtk_scrolled_window_set_policy(GTK_SCROLLED_WINDOW(sw),
            GTK_POLICY_AUTOMATIC, GTK_POLICY_AUTOMATIC);
    gtk_container_add(GTK_CONTAINER(window), sw);
    gtk_widget_show(sw);

    content = gtk_button_new_with_label("This is a very, very"
            "very very very very very very very very long text");
    gtk_scrolled_window_add_with_viewport(GTK_SCROLLED_WINDOW(sw), content);
    gtk_widget_show(content);

    gtk_widget_show(window);

    viewport = gtk_widget_get_ancestor(content, GTK_TYPE_VIEWPORT);
    gtk_widget_size_request(viewport, &size);
    gtk_widget_set_size_request(sw, size.width, size.height);

    gtk_main();

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T09:39:05.237

我不确定执行此操作的正确方法是什么，但我发现最适合我的是设置窗口的大小，并且其中包含的小部件通常会正确调整大小：

```
gtk_window_set_default_size(GTK_WINDOW(window), 1000, 500); 
```

或者，您可以设置 GtkScrolledWindow 的大小：

```
gtk_widget_set_size_request(window, 500, 250); 
```

请注意，特别是在最后一种情况下，在计算像素大小时，可能必须考虑本地化、字体大小和其他此类细节。

# mysql - 300+百万条记录的MySQL表有哪些优化技术？

> ID：444099
> 
> 赞同：7
> 
> 时间：2009-01-14T18:17:57.827
> 
> 标签：mysql, database, database-design, optimization, jmx

我正在考虑将来自 JVM 的一些 JMX 数据存储在许多服务器上大约 90 天。该数据将是诸如堆大小和线程数之类的统计信息。这意味着其中一张表将有大约 3.88 亿条记录。

根据这些数据，我正在构建一些图表，以便您可以比较从 Mbean 检索到的统计信息。这意味着我将使用时间戳每隔一段时间抓取一些数据。

所以真正的问题是，是否有办法优化表或查询，以便您可以在合理的时间内执行这些查询？

谢谢，

乔什

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-14T18:34:13.940

您可以做几件事：

1.  构建索引以匹配您正在运行的查询。运行[EXPLAIN](http://dev.mysql.com/doc/refman/5.1/en/explain.html)以查看正在运行的查询类型，并确保它们都尽可能使用索引。

2.  分区你的表。分区是一种通过特定（聚合）键将大表拆分为几个较小表的技术。MySQL 从[版本内部支持这一点。5.1](http://dev.mysql.com/doc/refman/5.1/en/partitioning.html) .

3.  如有必要，构建汇总表来缓存查询中成本较高的部分。然后针对汇总表运行查询。同样，临时内存表可用于存储表的简化视图作为预处理阶段。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T18:29:08.223

3条建议：

1.  指数
2.  指数
3.  指数

ps 对于时间戳，您可能会遇到性能问题——取决于 MySQL 如何在内部处理 DATETIME 和 TIMESTAMP，将时间戳存储为整数可能会更好。（自 1970 年以来的 # 秒或其他时间）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T18:29:36.787

好吧，首先，我建议您使用“离线”处理来生成“图形就绪”数据（对于大多数常见情况），而不是尝试按需查询原始数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T18:36:18.350

如果您使用的是 MYSQL 5.1，则可以使用新功能。但请注意，它们包含很多错误。

首先你应该使用索引。如果这还不够，您可以尝试使用分区来拆分表。

如果这也不起作用，您也可以尝试负载平衡。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-30T10:16:09.627

几点建议。

您可能要对这些东西运行聚合查询，因此在将数据加载到表中之后（或同时），您应该预先聚合数据，例如按小时、按用户或按一周，无论如何，你得到了想法，并将其存储在用于报告图表的缓存表中。如果您可以将数据集缩小一个数量级，那么对您有好处！

> 这意味着我将使用时间戳每隔一段时间抓取一些数据。

所以这意味着你只使用过去 X 天的数据？

如果要删除几千万行，从表中删除旧数据可能会非常慢，分区非常适合（只需删除那个旧分区）。它还将同一时间段的所有记录分组在磁盘上，因此缓存效率更高。

现在，如果您使用 MySQL，我强烈建议您使用 MyISAM 表。你没有防崩溃或事务和锁定是愚蠢的，但表的大小比 InnoDB 小得多，这意味着它可以放入 RAM，这意味着更快的访问。

由于大型聚合可能涉及大量相当连续的磁盘 IO，因此像 RAID10（或 SSD）这样的快速 IO 系统是一个优势。

> 无论如何优化表或查询，以便您可以在合理的时间内执行这些查询？

这取决于表和查询；在不了解更多信息的情况下无法提供任何建议。

如果您需要具有大聚合和连接的复杂报告查询，请记住 MySQL 不支持任何花哨的 JOIN、散列聚合或其他任何真正有用的东西，基本上它唯一能做的就是嵌套循环索引扫描，这在缓存表，如果涉及到一些随机访问，在其他情况下绝对是残酷的。

我建议您使用 Postgres 进行测试。对于大型聚合，更智能的优化器确实可以很好地工作。

例子 ：

```
CREATE TABLE t (id INTEGER PRIMARY KEY AUTO_INCREMENT, category INT NOT NULL, counter INT NOT NULL) ENGINE=MyISAM;
INSERT INTO t (category, counter) SELECT n%10, n&255 FROM serie; 
```

（系列包含 16M 行，n = 1 .. 16000000）

```
MySQL    Postgres     
58 s     100s       INSERT
75s      51s        CREATE INDEX on (category,id) (useless)
9.3s     5s         SELECT category, sum(counter) FROM t GROUP BY category;
1.7s     0.5s       SELECT category, sum(counter) FROM t WHERE id>15000000 GROUP BY category; 
```

在像这样的简单查询中，pg 的速度大约快 2-3 倍（如果涉及复杂的连接，差异会大得多）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-12T04:20:45.573

1.  解释您的 SELECT 查询
2.  LIMIT 1 获取唯一行时 SELECT * FROM user WHERE state = 'Alabama' // 错误 SELECT 1 FROM user WHERE state = 'Alabama' LIMIT 1

3.  索引搜索字段索引不仅用于主键或唯一键。如果您要搜索的表中有任何列，您几乎应该始终为它们编制索引。

4.  为连接建立索引并使用相同的列类型 如果您的应用程序包含许多 JOIN 查询，则需要确保您连接所依据的列在两个表上都有索引。这会影响 MySQL 内部如何优化连接操作。

5.  不要按 RAND() 排序 如果您真的需要从结果中随机排列，有更好的方法来做。当然，它需要额外的代码，但您可以防止瓶颈随着数据的增长而呈指数级恶化。问题是，MySQL 必须对表中的每一行执行 RAND() 操作（需要处理能力），然后再对其进行排序并只给你 1 行。

6.  在 VARCHAR 上使用 ENUM ENUM 类型的列非常快速且紧凑。在内部，它们像 TINYINT 一样存储，但它们可以包含和显示字符串值。

7.  如果可以，请使用 NOT NULL 除非您有非常具体的原因使用 NULL 值，否则您应该始终将列设置为 NOT NULL。

    “NULL 列在行中需要额外的空间来记录它们的值是否为 NULL。对于 MyISAM 表，每个 NULL 列需要额外一位，四舍五入到最接近的字节。”

8.  将 IP 地址存储为 UNSIGNED INT 在您的查询中，您可以使用 INET_ATON() 将 IP 转换为整数，反之亦然。PHP 中也有类似的函数，称为 ip2long() 和 long2ip()。

# c - 在屏幕上打印和文本文件

> ID：444111
> 
> 赞同：2
> 
> 时间：2009-01-14T18:21:05.370
> 
> 标签：c, text, tee

我需要将某些内容转储到文本文件中，并且需要在屏幕上显示相同的内容。（我说的是 C 程序实用程序）菜单选项如下所示，

```
1.显示AA参数
2.显示BB参数
3.显示CC参数
4.全部转储
5\. 退出
选择选项 >

```

如果他们选择1/2/3，它只需要显示在屏幕上，或者如果他们选择选项#4，它需要一个一个显示所有参数，同样需要转储到一个.txt文件中。

我知道，我们可以使用 printf 和 fprintf 函数分别在屏幕上显示和写入文本文件。问题是我显示了超过 20 个参数，每个参数至少有 20 个子参数。

我目前的实施如下，

```
printf (        "Starting serial number       [%ld]\n", 
        serial_info_p->start_int_idx);
fprintf(file_p, "Starting serial number       [%ld]\n", 
        serial_info_p->start_int_idx)
printf (        "Current Serial number         [%d]\n", 
        serial_info_p->current_int_idx);
fprintf(file_p, "Current Serial number         [%d]\n", 
        serial_info_p->current_int_idx); 
```

有没有一种最简单的方法来实现这一点以减少代码行数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T18:42:19.023

*编辑：~~C++ 标签似乎具有误导性，有人可以删除它吗？~~谢谢 ：）*

我使用可变参数宏来自定义 printf 和朋友。

我会写这样的东西：

```
#define     tee(fp,fmt, ...)                             \
        {                                                \
                printf (fmt, __VA_ARGS__);               \
                fprintf (fp, fmt, __VA_ARGS__);          \
        } 
```

（名称来自 tee(1) 实用程序）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T18:43:39.520

像这样的东西允许您添加任意数量的输出流，并允许在运行时通过修改 PrintTarget 链表来更改它们。

```
/** gcc -Wall -o print_target print_target.c && ./print_target */
#include <stdarg.h>
#include <stdio.h>
#include <stdlib.h>

typedef struct PrintTarget* PrintTargetp;

void* xmalloc (size_t size);
PrintTargetp pntCreate (PrintTargetp head, FILE* target);
void pntDestroy (PrintTargetp list);

typedef struct PrintTarget
{
  FILE* target;
  PrintTargetp next;
} PrintTarget;

void myPrintf (PrintTargetp streams, char* format, ...)
{
  va_list args; 
  va_start(args, format);
  while (streams)
    {
      vfprintf(streams->target, format, args);
      streams = streams->next;
    }
  va_end(args);
}

int main(void)
{
  PrintTargetp streams = pntCreate(NULL, stdout);
  streams = pntCreate(streams, fopen("somefile.txt", "a+")); //XXX IO errors?

  myPrintf(streams, "blah blah blah...\n");
  pntDestroy(streams);
  return 0;
} 
```

下面是辅助函数的定义：

```
PrintTargetp pntCreate (PrintTargetp head, FILE* target)
{
  PrintTargetp node = xmalloc(sizeof(PrintTarget));
  node->target = target;
  node->next   = head;
  return node;
} 

void pntDestroy (PrintTargetp list)
{
  while (list) 
    {
      PrintTargetp next = list->next;
      free(list);
      list = next;
      //XXX cycles?
      //XXX close files?
    }
}

void* xmalloc (size_t size)
{
  void* p = malloc(size);
  if (p == NULL)
    {
      fputs("malloc error\n", stderr);
      abort();
    }
  return p;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T18:50:29.180

您也可以将程序的输出通过管道传输到[`tee(1)`](http://en.wikipedia.org/wiki/Tee_(unix))命令。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T18:32:59.807

如果您正在编写控制台应用程序，您应该能够使用以下内容输出到屏幕（标准输出）：

```
fprintf(stdout, "Hello World\n"); 
```

这应该使您能够将打印数据的代码移动到它自己的函数中，并传递一个 FILE* 以便它打印到。然后，如果您传递“stdout”，则该函数可以打印到屏幕，或者如果您传递不同的 FILE*，则该函数可以打印到文件，例如：

```
void print_my_stuff(FILE* file) {
    fprintf( file,"Starting serial number       [%ld]\n", serial_info_p->start_int_idx);
    fprintf(file, "Current Serial number         [%d]\n", serial_info_p->current_int_idx);
    .
    .
    .
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T18:46:14.507

**编辑：**我没有注意到您需要 C 解决方案。我将把这个答案留作参考，但它显然需要 C++。

您可以创建一个新的流类，将输出发送到两个流。[我在http://www.cs.technion.ac.il/~imaman/programs/teestream.html](http://www.cs.technion.ac.il/~imaman/programs/teestream.html)找到了一个实现。我没有尝试过，但它应该可以工作。

这是链接中的代码：

```
#include <iostream>
#include <fstream>

template<typename Elem, typename Traits = std::char_traits<Elem> >
struct basic_TeeStream : std::basic_ostream<Elem,Traits>
{
   typedef std::basic_ostream<Elem,Traits> SuperType;

   basic_TeeStream(std::ostream& o1, std::ostream& o2) 
      :  SuperType(o1.rdbuf()), o1_(o1), o2_(o2) { }

   basic_TeeStream& operator<<(SuperType& (__cdecl *manip)(SuperType& ))
   {
      o1_ << manip;
      o2_ << manip;
      return *this;
   }

   template<typename T>
   basic_TeeStream& operator<<(const T& t)
   {
      o1_ << t;
      o2_ << t;
      return *this;
   }

private:
   std::ostream& o1_;
   std::ostream& o2_;
};

typedef basic_TeeStream<char> TeeStream; 
```

你会像这样使用它：

```
ofstream f("stackoverflow.txt");
TeeStream ts(std::cout, f);
ts << "Jon Skeet" << std::endl; // "Jon Skeet" is sent to TWO streams 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T18:31:14.180

```
#define ARRAY_LEN(x) (sizeof(x) / sizeof(x[0]))

FILE *f = fopen("somefile.txt", "a+");
FILE *fp[] = { stdout, f };
int i = 0;

for (i = 0; i < ARRAY_LEN(fp); i++) {
    fprintf(fp[i], "Starting serial number [%ld]\n", serial_info_p->start_int_idx);
    fprintf(fp[i], "Current serial number [%ld]\n", serial_info_p->start_int_idx);
}

fclose(f); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T14:40:56.110

我会比人们迄今为止建议的更激进，但也许对你来说太过分了。（'inline' 关键字是 C99；如果编码为 C89，则可以省略它而不会产生太大影响。）

```
/*
** These could be omitted - unless you get still more radical and create
** the format strings at run-time, so you can adapt the %-24s to the
** longest tag you actually have.  Plus, with the strings all here, when
** you change the length from 24 to 30, you are less likely to overlook one!
*/
static const char fmt_int[]  = "%-24s [%d]\n";
static const char fmt_long[] = "%-24s [%ld]\n";
static const char fmt_str[]  = "%-24s [%s]\n";   /* Plausible extra ... */

static inline void print_long(FILE *fp, const char *tag, long value)
{
    fprintf(fp, fmt_long, tag, value);
}

static inline void print_int(FILE *fp, const char *tag, int value)
{
    fprintf(fp, fmt_int, tag, value);
}

static inline void print_str(FILE *fp, const char *tag, const char *value)
{
    fprintf(fp, fmt_str, tag, value);
}

static void dump_data(FILE *fp, const serial_info_t *info)
{
    dump_long("Starting serial number", info->start_int_idx);
    dump_int( "Current Serial number",  info->current_int_idx);
    /* ... and similar ... */
} 
```

然后调用代码将为选项 1、2、3调用`dump_data()`一次（带参数），为选项 4 调用两次（一次为，一次为输出文件的文件指针）。`stdout``stdout`

如果参数的数量真的很大（达到数百个），我什至会考虑一个数据结构，它编码类型和偏移信息（`offsetof`from `<stddef.h>`）以及指向函数等的指针，这样就会有只是一个循环`dump_data()`遍历编码所有必要信息的结构。

`long`您还可以通过对数据结构的所有整数成员使用相同的基本整数类型（在您的示例中）来简化生活。

Fred Brooks 在“神话人物月”中——如果你还没有读过这本书，非常值得一读，但请确保你阅读了 20 周年纪念版——在第 9 章中说：

> 给我看你的流程图[代码]并隐藏你的表格[数据结构]，我将继续被迷惑。给我看你的表格，我通常不需要你的流程图；他们会很明显。

此代码的表格驱动版本最终可能会节省空间，并且在必须以相同方式更改一百个相关函数时感到沮丧，而表格数据中的简单更改可能会解决整个问题。

# java - 如何编码 URI 参数值？

> ID：444112
> 
> 赞同：57
> 
> 时间：2009-01-14T18:21:23.623
> 
> 标签：java, url, rest, urlencode, rfc2396

我想发送一个 URI 作为查询/矩阵参数的值。在将其附加到现有 URI 之前，我需要根据 RFC 2396 对其进行编码。例如，给定输入：

`http://google.com/resource?key=value1 & value2`

我期望输出：

`http%3a%2f%2fgoogle.com%2fresource%3fkey%3dvalue1%2520%26%2520value2`

两者都`java.net.URLEncoder`不会`java.net.URI`产生正确的输出。`URLEncoder`用于 HTML 表单编码，与 RFC 2396 不同。`URI`没有一次编码单个值的机制，因此它无法知道 value1 和 value2 是同一个键的一部分。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-14T20:39:17.337

Jersey 的[UriBuilder](http://download.oracle.com/javaee/6/api/javax/ws/rs/core/UriBuilder.html)根据需要使用 application/x-www-form-urlencoded 和 RFC 3986 对 URI 组件进行编码。根据Javadoc

> 构建器方法执行相应 URI 组件中不允许的字符的上下文编码，遵循查询参数的 application/x-www-form-urlencoded 媒体类型和所有其他组件的 RFC 3986 的规则。请注意，只有特定组件中不允许的字符才会进行编码，因此，例如，提供给路径方法之一的路径可能包含矩阵参数或多个路径段，因为分隔符是合法字符并且不会被编码。在允许的情况下，百分比编码值也会被识别，并且不会被双重编码。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2011-07-16T03:48:28.357

你也可以使用 Spring 的[UriUtils](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/util/UriUtils.html)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-12-30T22:05:48.777

我没有足够的声誉来评论答案，但我只想指出，单独下载 JSR-311 api 是行不通的。您需要下载参考实现 ( [jersey](http://jersey.java.net/) )。

当 api 尝试在运行时查找实现时，仅从 JSR 页面下载 api 会给您一个 ClassNotFoundException。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-01-17T06:15:59.537

我自己写的，很短，超级简单，喜欢的可以复制一下： [http ://www.dmurph.com/2011/01/java-uri-encoder/](http://www.dmurph.com/2011/01/java-uri-encoder/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-14T19:30:01.783

似乎来自 Google GData-java-client 的[CharEscapers](http://code.google.com/p/gdata-java-client/source/browse/trunk/java/src/com/google/gdata/util/common/base/CharEscapers.java)有你想要的。它具有 uriPathEscaper 方法、uriQueryStringEscaper 和通用 uriEscaper。（全部返回执行实际转义的 Escaper 对象）。阿帕奇许可证。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-14T18:33:09.637

我认为[URI 类](http://java.sun.com/j2se/1.5.0/docs/api/java/net/URI.html)是您正在寻找的类。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-01-14T19:44:19.227

嗯，我知道你已经放弃了 URLEncoder，但不管文档怎么说，我还是决定试一试。

你说：

> 例如，给定一个输入：
> 
> *[http://google.com/resource?key=value](http://google.com/resource?key=value)*
> 
> 我期望输出：
> 
> *http%3a%2f%2fgoogle.com%2fresource%3fkey%3dvalue*

所以：

```
C:\oreyes\samples\java\URL>type URLEncodeSample.java
import java.net.*;

public class URLEncodeSample {
    public static void main( String [] args ) throws Throwable {
        System.out.println( URLEncoder.encode( args[0], "UTF-8" ));
    }
}

C:\oreyes\samples\java\URL>javac URLEncodeSample.java

C:\oreyes\samples\java\URL>java URLEncodeSample "http://google.com/resource?key=value"
http%3A%2F%2Fgoogle.com%2Fresource%3Fkey%3Dvalue 
```

正如预期的那样。

这会有什么问题？

# c# - 使用 C#/.NET 读/写 XML

> ID：444116
> 
> 赞同：3
> 
> 时间：2009-01-14T18:23:06.880
> 
> 标签：c#, .net, xml

使用 C#/.NET 读取/写入 XML 的最佳功能、实践和/或技术是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-14T18:26:24.750

如果您正在使用 .NET 3.5，LINQ to XML 无疑是与 XML 交互的一种非常好的方式。

[MSDN 链接](http://msdn.microsoft.com/en-us/library/bb308960.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-14T18:34:26.497

有读取 XML 的类：

*   `XmlDocument`速度慢且占用大量内存：它解析 XML 并将其加载到内存中的 DOM 中，如果您想编辑它，这很好。
*   `XmlReader`内存占用较少：它从头到尾扫描 XML，无需一次将所有内容保存在 RAM 中。

同样，对于编写，您可以构造一个`XmlDocument`然后保存它，或者使用一个`XmlWriter`.

* * *

在我写完上面的内容之后，现在有一组新的更易于使用的 API：例如`XDocument`和`XElement`类。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T00:00:07.057

到目前为止，我发现在 C# 中处理 XML 的最简单方法是使用 XML 序列化工具。例如：[http](http://www.dotnetjohn.com/articles.aspx?articleid=173) ://www.dotnetjohn.com/articles.aspx?articleid=173 。

本质上，您可以定义与您的 XML 文件匹配的 C# 类（事实上，如果您有 XML 定义文件，您可以为您创建它们），然后您只需直接从 XML 文件初始化这些类的实例。一旦您将它们作为实例，您就可以随意操作它们并将它们重新写入 XML 文件，也同样容易。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-14T18:34:42.910

在性能关键的应用程序中，为了简单起见， XmlReader/XmlWriter 是一个不错的选择（请参阅[此处），这由 Linq to XML 和 XmlDocument 提供。](http://www.nearinfinity.com/blogs/page/jferner?entry=performance_linq_to_sql_vs)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-15T19:53:03.890

I've found the MvpXml project very useful in past scenarios where performance is a consideration. There's a wealth of knowledge about good practice within their project pages: [http://www.codeplex.com/MVPXML](http://www.codeplex.com/MVPXML)

# google-docs - 从网络应用程序使用 Google Docs

> ID：444117
> 
> 赞同：3
> 
> 时间：2009-01-14T18:23:15.490
> 
> 标签：google-docs

我们要求人们能够查看人们通过我们的网络应用程序上传给我们的文件（主要是文字，可能是一些 rtf）。我们希望用户能够在浏览器中打开文档，但保留原始格式并且不需要其他应用程序（如 word、acrobat 等）。

我们考虑过使用谷歌文档来做到这一点，似乎有一些批量上传选项可以在那里获取东西，但有人知道我们是否可以使用 API 让用户留在我们的网站上，而无需他们自己登录谷歌文档，并将它们留在我们的网站上，并重定向到谷歌文档以查看它们。

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T18:34:25.360

有一个公开文档的选项（在共享->高级选项中的某处）。

使用 api 您可以在您的 google docs 帐户中获取文档列表，您甚至可以搜索 em。在您的应用程序中，您可以在新窗口中打开的 google 文档中创建指向文档的链接。这样，您的用户将永远不会离开您的页面。另一种方法是使用 IFrame，但这被认为是不好的做法。

一种完全不同的方法可能是每次有人上传文件时自动生成和托管一个 pdf。有脚本/程序可以做到这一点，只需在收到文件后调用它们。

# tsql - MS-SQL 2000：在存储过程期间关闭日志记录

> ID：444120
> 
> 赞同：2
> 
> 时间：2009-01-14T18:23:23.337
> 
> 标签：tsql, sql-server-2000, transaction-log

这是我的场景：

我有一个简单的存储过程，它从表中删除一组特定的行（我们会说大约 30k 行），然后插入大约相同数量的行。这通常只需要几秒钟；但是，该表上有一个触发器，用于监视插入/删除，并尝试模仿另一台服务器上的链接表发生的情况。

由于触发器，这个过程又慢得令人难以置信，并且在这个过程中表也被锁定。所以这是我的两个问题：

1.  我猜减速的很大一部分是由于事务日志。有没有办法让我在我的存储过程中指定我不希望记录过程中的内容？
2.  有没有办法让我在整个过程中不锁定表格的情况下执行“删除”和“插入”命令？

谢谢！

*编辑*- 感谢您的回答；我认为是这种情况（无法执行上述任何一项），但想确定一下。触发器是很久以前创建的，看起来不是很有效，所以看起来我的下一步将是深入了解需要什么以及如何改进它。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T18:26:46.607

1）不，你也没有做像 TRUNCATE 或 BULK INSERT 这样的最小记录操作

2) 不，否则您将如何防止腐败？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T18:27:13.983

我不会自动假设性能问题是由于日志记录造成的。事实上，触发器的编写方式很可能会导致您的性能问题。我鼓励您修改原始问题并显示触发器的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T18:28:04.670

修改数据时不能关闭事务完整性。**使用 select * from table (nolock)**选择数据时可以忽略锁；但是，您需要非常小心并确保您的应用程序可以处理脏读。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T18:36:15.073

它对您的触发器没有帮助，但锁定问题的解决方案是小批量执行事务。

代替

```
DELETE FROM Table WHERE <Condition> 
```

做类似的事情

```
WHILE EXISTS ( SELECT * FROM table WHERE <condition to delete>)
BEGIN
  SET ROWCOUNT 1000
  DELETE FROM Table WHERE <Condition>
  SET ROWCOUNT 0
END 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T18:41:51.600

您可以暂时禁用触发器，运行您的 proc，然后以更有效的方式执行触发器正在执行的任何操作。

```
-- disable trigger
ALTER TABLE [Table] DISABLE TRIGGER [Trigger]
GO

-- execute your proc
EXEC spProc
GO

-- do more stuff to clean up / sync with other server
GO

-- enable trigger
ALTER TABLE [Table] ENABLE TRIGGER [Trigger]
GO 
```

# sql - 如何为数据库名称创建 Sql 同义词或“别名”？

> ID：444139
> 
> 赞同：28
> 
> 时间：2009-01-14T18:29:18.833
> 
> 标签：sql, sql-server-2008, alias, synonym

我正在使用 ms sql 2008 并尝试创建一个引用另一个数据库的数据库名称。例如，“Dev”、“Test”、“Demo”是我可以从多个配置文件中引用的数据库名称，但每个名称都指向另一个数据库，例如“db20080101”或“db20080114”。

[编辑]一些配置用于我控制代码的应用程序，而另一些则不是（例如 MS Reporting 服务数据源文件配置）[/Edit]

似乎 sqlserver 只支持 View、Table、Sproc 或 Function 的同义词。Alias 用于表名和列名。

有没有办法做到这一点，我在文档中错过了？有人对解决方法有任何建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T18:31:46.720

在表格中使用 3 部分符号和别名，例如

```
select * from tempdb.dbo.sysobjects a
join master.dbo.sysobjects b on a.id = b.id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-12-20T14:05:11.420

有一种方法可以使用链接服务器来模拟这一点。这假设您有两个 SQL 服务器，它们具有相同的数据库集，一个用于开发/测试，一个用于实时。

1.  **在您的开发/测试服务器上**打开 SQL Server Management Studio
***   右键单击服务器对象 > 链接服务器*   选择新建链接服务器...*   选择常规页面*   在链接服务器字段中指定**别名**- 这通常是您的**实时**服务器的名称*   选择 SQL Native Client 作为提供者*   输入**sql_server**作为产品名称*   在数据源中指定**开发**服务器的名称*   添加安全和服务器选项以品尝*   点击确定**

 **以上适用于 SQL Server 2005，但对于 2008 应该类似

完成后，您可以像这样编写 SQL：

```
SELECT * FROM liveservername.databasename.dbo.tablename 
```

现在，当您的脚本在开发服务器上运行并且链接服务器返回到自身时，它们将正确地从开发服务器中提取数据，并且当完全相同的脚本在实时服务器上运行时，它们将正常工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T18:42:01.460

我使用另一个配置文件做了类似的事情。

新的配置文件将您的通用名称映射到连接到该数据库所需的所有信息（数据库名称、用户名、密码等），然后您的连接函数将您的通用名称作为参数。

数据库配置：

```
DEV_DB_NAME = db20080101
DEV_DB_USER = dev_user
DEV_DB_PASS = dev_pass
TEST_DB_NAME = db20070101
TEST_DB_USER = test_user
TEST_DB_PASS = test_pass 
```

连接代码：

```
db_connection get_connection(string prefix) {
    db_connection db_conn = new db_connection;
    string db_name = get_config_value(config_path, prefix + "_DB_NAME");
    string db_user = get_config_value(config_path, prefix + "_DB_USER");
    string db_pass = get_config_value(config_path, prefix + "_DB_PASS");

    db_conn.connect(db_name, db_user, db_pass);

    return db_conn;
} 
```

然后，您只需使用您的 db 别名作为参数调用 get_connection() 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-15T22:04:48.610

我知道这可能不会在所有情况下都有帮助，但您仍然可以选择使用视图。您可以在视图中插入、删除、更新、选择，只要它具有正确的标识键（主键）。如果将其指向另一个数据库，则应删除并重新创建以获取不同的架构（以防您在生产和测试之间工作，同时在测试和/或生产中更改架构。

当您要去另一个数据库并有一个 3 或 4 个部分的名称时，同义词很有用，但是当您想要使它具有一个集合名称时，一个链接服务器也可以工作，它可以让您使用一个固定的名称如果两个数据库中的表名相同，并且您只是在 prod 和 test 之间指向。

# c# - 如何在 asp:listview 中提取 asp:button 的 clientID 以与 jQuery 一起使用？

> ID：444151
> 
> 赞同：4
> 
> 时间：2009-01-14T18:33:10.993
> 
> 标签：c#, asp.net, jquery

我正在尝试做一些应该相对简单的事情。我正在使用 ListView 显示许多项目，使用 ItemTemplate。在 ItemTemplate 内，我有一个围绕整个项目的 div，以便我可以突出显示悬停事件（已由 jQuery 处理）。

我想做的是让 div 上的 click 事件触发一个按钮来打开该特定项目的详细信息视图。我遇到的问题是在使用 jQuery 时拉回该按钮的 ClientID。我试过了：

```
$('#<%= Button1.ClientID %>') 
```

路线，但这不起作用，因为页面加载时按钮不存在。

基本代码如下：

```
<asp:listview>
 <itemtemplate>
  <td runat="server">
   <div class="container">
    <asp:linkbutton id="Button1" runat="server" text="View Details" />
     fun and exciting stuff here...
   </div>
  </td>
 </itemtemplate>
</asp:listview> 
```

非常感谢任何建议或帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T19:18:43.693

你为什么不给那些链接按钮一个特定的css类呢？

```
<asp:linkbutton id="Button1" runat="server" text="View Details" CssClass="detailsButtons" /> 
```

然后在 jquery 中，只需选择一个类即可在一次调用中将它们全部分配。

```
$(".detailsButtons").click( function() { .... } ); 
```

如果这不起作用，因为当时没有制作对象，您可以使用[jquery](http://api.jquery.com/)`live()`中的新方法。它还将事件分配给任何动态添加的元素。

希望这可以帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T15:58:30.400

而不是使用脚本：

```
$('#<%= Button1.ClientID %>') 
```

使用绑定表达式：

```
$('#<%# Button1.ClientID %>') 
```

请注意，区别在于**#**而不是**=**。

绑定表达式在绑定数据时进行评估，因此您的表达式将在当前数据项的上下文中进行评估。Scriptlet 在页面被渲染时进行评估（在页面生命周期的最后阶段），并在页面的上下文中进行评估，而不是在特定的数据项中进行评估。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T18:57:40.647

将一个方法连接到 ListView 的[ItemDataBound](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listview.itemdatabound.aspx)事件。在那里，您可以使用[ListViewItemEventArgs参数的](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listviewitemeventargs.aspx)[Item](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listviewitemeventargs.item.aspx)属性上的[FindControl](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listviewitem.findcontrol.aspx)方法来获取对列表中每个项目的 LinkBut​​ton 的引用。从该引用中，您可以获得 ClientID，并使用它做任何您需要做的事情。

**更新**
就您*可以*对按钮的引用执行什么操作而言，最简单的可能是在 ItemDataBound 事件中分配您的点击事件，可能是这样的

```
var button = (Button)e.Item.FindControl("Button1");
button.OnClientClick = "ShowEditDialog(" + Eval("ItemId") + ")"; 
```

如果您需要在客户端连接它，也许您可​​以维护一个将 ClientIDs 映射到 Item IDs 的字典，并将该字典发送到客户端，在那里您可以对其进行迭代并将事件连接起来。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T11:41:15.520

您可以使用以下语法选择按钮（假设 Button1 是按钮的服务器 ID）：

```
$("[id$=Button1]") 
```

这将选择 id 以“Button1”结尾的所有 DOM 元素。

这是必要的，因为元素的结果客户端 ID 反映了服务器控制结构。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-06-17T06:27:04.860

您甚至可以使用 cssclass 来触发点击。

```
<a class="confirm" id="alert" onmouseover="got('<%# Eval("Gift_ID") %>','<%= Session["member_id"] %>')">Redeem Now</a> 
```

并使用jquery触发点击甚至基于这个类..

```
$(function() {
        $(".confirm").easyconfirm();
        $(".confirm").click(function() {
            var id = document.getElementById("test").value;
            var mem_id = document.getElementById("test1").value;
            document.getElementById("test").setAttribute("value", "");
            document.getElementById("test1").setAttribute("value", "");
            var param = "{'id':'" + id + "','mem_id':'" + mem_id + "'}"
            $.ajax({

                type: "POST",
                url: "Offer.aspx/Hello_World",
                data: param,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                async: true,
                cache: false,
                success: function(msg) {
                    alert("hello");
                    $('#myDiv').text(msg.d);

                }
            });

        });

    }); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-15T07:15:54.823

如果是您所追求的点击事件，您不能使用链接按钮的 OnClientClick 属性吗？还是他们在 3.5 中删除了它？

# c# - 正则表达式从 Sql 语句中提取更新列

> ID：444152
> 
> 赞同：1
> 
> 时间：2009-01-14T18:33:36.157
> 
> 标签：c#, sql, regex

我需要一个 Regex 语句（在 c# 中运行），它将一个包含 Sql Update 语句的字符串作为输入，并将返回一个要更新的列列表。它应该能够处理被括号包围的列。

```
// Example Sql Statement
Update Employees
Set FirstName = 'Jim', [LastName] = 'Smith', CodeNum = codes.Num
From Employees as em
Join CodeNumbers as codes on codes.EmployeeID = em.EmployeeID 
```

最后我想返回一个 IEnumerable 或 List 包含：

1.  名
2.  姓
3.  代号

有人对实施有什么好的建议吗？

*更新*： sql 是用户生成的，所以我必须按照给定的方式解析 Sql。在我的例子中提取列名的目的是验证用户是否有权更新查询中包含的列。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T18:39:09.110

你倒着做。以分解的形式存储数据，要更新的表、列名和生成新值的表达式都是分开的。根据这个规范表示，生成 SQL（当您需要时）和正在更新的列列表（当您需要时）。

如果您绝对必须从 SQL 语句中提取列名，我认为正则表达式不是正确的方法。例如，在一般情况下，您可能需要跳过包含任意嵌套括号的新值表达式。您可能需要一个完整的 SQL 解析器。Levine、Mason 和 Brown所著的*Lex & Yacc一书有一章是关于解析 SQL 的。*

对更新的回应：你正处于一个受伤的世界。做你想做的事情的唯一方法是完全解析 SQL，因为你还需要确保你没有任何执行未经授权的操作的子表达式。

我非常非常强烈地建议你想出另一种方法来做你正在做的任何事情。也许将可修改的字段分解成一个单独的表并使用访问控制？也许想出另一个界面供他们用来指定他们想要做什么？不管你在做什么，几乎肯定有更好的方法来做。在那条路上，有龙。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T19:12:00.307

正则表达式无法完成这项任务，因为 SQL 不是[正则语言](http://en.wikipedia.org/wiki/Regular_language)。

您可以这样做，但不能使用正则表达式。你需要一个成熟的解析器。

您可以使用[ANTLR](http://www.antlr.org/)在 C# 中生成解析器，并且有免费的语法 [可](http://www.antlr.org/grammar/list)用于在 ANTLR 中解析 SQL。

但是，我同意格洛梅克的观点，即允许用户提供的 SQL 对您的系统运行，即使在您尝试验证它不包含“未经授权的操作”之后也是愚蠢的。有太多的情况可能会绕过您的验证。

相反，如果您只有一个文本字段，您应该定义一种简化的[域特定语言](http://en.wikipedia.org/wiki/Domain-specific_language)，允许用户仅指定他们有权执行的操作。通过此输入，您可以自己构建 SQL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-08T12:31:14.207

SQL 有一个复杂的递归语法，并且总会有一些子选择、分组依据或文字会破坏基于正则表达式的解析器。

为什么不使用 sql 解析器来实现你所需要的，这里有[一篇文章](http://www.dpriver.com/blog/list-of-demos-illustrate-how-to-use-general-sql-parser/decoding-sql-grammar-%E2%80%94-update-statement/)告诉你如何在 3 分钟内实现你所需要的。

# cookies - HttpWebRequest Cookie 怪异

> ID：444163
> 
> 赞同：1
> 
> 时间：2009-01-14T18:36:48.130
> 
> 标签：cookies, httpwebrequest, http-headers

我确定我一定做错了什么。但不能为我的生活弄清楚发生了什么。

我有一个问题，框架中的 HttpWebRequest 类似乎没有正确解析来自 Web 响应的 cookie。

我正在使用 Fiddler 查看发生了什么，在发出请求后，响应的标头如下所示：

```
HTTP/1.1 200 Ok
Connection: close
Date: Wed, 14 Jan 2009 18:20:31 GMT
Server: Microsoft-IIS/6.0
P3P: policyref="/w3c/p3p.xml", CP="CAO DSP IND COR ADM CONo CUR CUSi DEV PSA PSD DELi OUR COM NAV PHY ONL PUR UNI"
Set-Cookie: user=v.5,0,EX01E508801E$97$2E401000t$1BV6$A1$EC$104$A1$EC$104$A1$EC$104$21O001000$1E31!90$7CP$AE$3F$F3$D8$19o$BC$1Cd$23; Domain=.thedomain.com; path=/
Set-Cookie: minfo=v.4,EX019ECD28D6k$A3$CA$0C$CE$A2$D6$AD$D4!2$8A$EF$E8n$91$96$E1$D7$C8$0F$98$AA$ED$DC$40V$AB$9C$C1$9CF$C9$C1zIF$3A$93$C6$A7$DF$A1$7E$A7$A1$A8$BD$A6$94c$D5$E8$2F$F4$AF$A2$DF$80$89$BA$BBd$F6$2C$B6$A8; expires=Sunday, 31-Dec-2014 23:59:59 GMT; Domain=.thedomain.com; path=/
Set-Cookie: accttype=v.2,3,1,EX017E651B09k$A3$CA$0C$DB$A2$CB$AD$D9$8A$8C$EF$E8t$91$90$E1$DC$C89$98$AA$E0$DC$40O$A8$A4$C1$9C; expires=Sunday, 31-Dec-2014 23:59:59 GMT; Domain=.thedomain.com; path=/
Set-Cookie: tpid=v.1,20001; expires=Sunday, 31-Dec-2014 23:59:59 GMT; Domain=.thedomain.com; path=/
Set-Cookie: MC1=GUID=541977e04a341a2a4f4cdaaf49615487; expires=Sunday, 31-Dec-2014 23:59:59 GMT; Domain=.thedomain.com; path=/
Set-Cookie: linfo=v.4,EQC|0|0|255|1|0||||||||0|0|0||0|0|0|-1|-1; expires=Sunday, 31-Dec-2014 23:59:59 GMT; Domain=.thedomain.com; path=/
Set-Cookie: group=v.1,0; expires=Sunday, 31-Dec-2014 23:59:59 GMT; Domain=.thedomain.com; path=/
Content-Type: text/html 
```

但是当我查看 response.Cookies 时，我看到了我所期待的更多 cookie，不同 cookie 的值被分成不同的 cookie。

手动获取标题似乎会导致更多奇怪

例如：代码

```
foreach(string cookie in response.Headers.GetValues("Set-Cookie"))
{
    Console.WriteLine("Cookie found: " + cookie);
} 
```

产生输出：

```
Cookie found: user=v.5
Cookie found: 0
Cookie found: EX01E508801E$97$2E401000t$1BV6$A1$EC$104$A1$EC$104$A1$EC$104$21O00
1000$1E31!90$7CP$AE$3F$F3$D8$19o$BC$1Cd$23; Domain=.thedomain.com; path=/
Cookie found: minfo=v.4
Cookie found: EX019ECD28D6k$A3$CA$0C$CE$A2$D6$AD$D4!2$8A$EF$E8n$91$96$E1$D7$C8$0
F$98$AA$ED$DC$40V$AB$9C$C1$9CF$C9$C1zIF$3A$93$C6$A7$DF$A1$7E$A7$A1$A8$BD$A6$94c$
D5$E8$2F$F4$AF$A2$DF$80$89$BA$BBd$F6$2C$B6$A8; expires=Sunday
Cookie found: 31-Dec-2014 23:59:59 GMT; Domain=.thedomain.com; path=/
Cookie found: accttype=v.2
Cookie found: 3
Cookie found: 1
Cookie found: EX017E651B09k$A3$CA$0C$DB$A2$CB$AD$D9$8A$8C$EF$E8t$91$90$E1$DC$C89
$98$AA$E0$DC$40O$A8$A4$C1$9C; expires=Sunday
Cookie found: 31-Dec-2014 23:59:59 GMT; Domain=.thedomain.com; path=/
Cookie found: tpid=v.1
Cookie found: 20001; expires=Sunday
Cookie found: 31-Dec-2014 23:59:59 GMT; Domain=.thedomain.com; path=/
Cookie found: MC1=GUID=541977e04a341a2a4f4cdaaf49615487; expires=Sunday
Cookie found: 31-Dec-2014 23:59:59 GMT; Domain=.thedomain.com; path=/
Cookie found: linfo=v.4
Cookie found: EQC|0|0|255|1|0||||||||0|0|0||0|0|0|-1|-1; expires=Sunday
Cookie found: 31-Dec-2014 23:59:59 GMT; Domain=.thedomain.com; path=/
Cookie found: group=v.1
Cookie found: 0; expires=Sunday
Cookie found: 31-Dec-2014 23:59:59 GMT; Domain=.thedomain.com; path=/ 
```

如您所见 - 列表原始响应中的第一个 cookie：

1.  设置 Cookie：用户=v.5,0,EX01E508801

正在分成：

1.  找到 Cookie：用户=v.5
2.  发现 Cookie：0
3.  发现 Cookie：EX01E508801E$.......

那么 - 这里发生了什么？

*   我错了吗？
*   HttpWebRequest 类是否错误地解析了 http 标头？
*   吐出请求的网络服务器是否会产生无效的 http 标头？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T18:43:58.507

应避免 cookie 值中的逗号 - 您可能需要对它们进行不同的编码。

cookie的原始[netscape 规范](http://cgi.netscape.com/newsref/std/cookie_spec.html)在这个问题上有点含糊，指出

> NAME=VALUE ：此字符串是一个字符序列，不包括分号、逗号和空格。如果需要在名称或值中放置此类数据，则建议使用一些编码方法，例如 URL 样式 %XX 编码，尽管没有定义或要求编码。

推荐，但不是*必需*的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T18:41:14.050

服务器似乎发送了不正确的 cookie 值。恕我直言，cookie 值中不允许使用逗号。它们需要使用 %2C 进行编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T14:59:11.317

您可能想使用 GetValues(i) 的整数重载；那么你应该只取回 7 个字符串

# css - 在 Web 开发中编写 CSS 使用合同的最佳方式是什么？

> ID：444165
> 
> 赞同：0
> 
> 时间：2009-01-14T18:38:13.057
> 
> 标签：css, design-by-contract

我们的开发团队在 2 年多前就开始开发企业网页。我们很想知道编写 CSS 使用合同的最佳方式是什么。例如，如果我们有一个 COMP，我们如何就合同达成一致，以便我们的开发人员和我们的设计师达成一致，并且我们不必回头。

是否有可用于此类技术写作的工具？

放在 CSS 和 HTML 页面上的信息的线索是什么？我们的一些设计师认为有些东西应该直接进入 HTML 页面。一般的观点是，所有的样式都应该放在 CSS 中，其他的都放在 html 中。

感谢您的输入。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T18:54:05.210

好吧，如果一个网页本身有非常特定的 CSS，我想有一个参数可以在页面中定义 CSS，否则我总是将 CSS 放在外部文件中。

尽量避免或至少尽量减少内联 CSS 作为 HTML 元素的样式属性，但这将是一个需要管理的 PITA。

大多数页面将使用标准内容样式进行模板驱动，因此 CSS 样式将在外部文件中定义。

您可能需要考虑的一件事是 CSS 文件的数量 - 有些人建议您应该将其最小化为站点范围或每个模板（或站点区域）的一个文件，以最小化对服务器的 HTTP 请求并避免延迟 CSS 加载和有趣的样式直到那时。

那么这个“CSS 使用合同”实际上只是 HTML 页面的编码标准？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T18:55:04.193

我是一个纯粹主义者，所以对我来说，HTML 用于内容和结构，而 CSS 用于布局和样式。这就是他们每个人的真正目的。

有关这方面的一个很好的例子，请参阅[CSS Zen Garden 。](http://csszengarden.com/)相同的 HTML 和数百种不同的布局和设计。

你的设计师为什么要在 HTML 中设置样式？

编辑：这里的主要目标是整个站点的一致性，对吗？您从每个页面中提取的内容越多，您必须进行的更改就越少。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-22T19:27:22.653

HTML 应该只编码信息而不是样式的想法称为语义标记。它有几个你已经知道的优点，比如关注点分离，还有一些你可能没有考虑过。

如果您坚持 Web 标准并将您的样式和内容分开，那么您最终也会得到一个更易于残障人士访问的页面。

如果您需要为特定页面设置不同的样式，请仅对该页面使用单独的 CSS 包含文件，然后在要设置样式的元素上使用 CSS 类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T19:21:44.797

如果我的样式是一次性使用的页面，我会考虑将其放在该页面的页眉中，因为我的模板系统允许这样做。

但是，您永远不应该使用内联样式。即使你做了一个页面，里面有一个块。这样，如果您发现“一次性”项目变成了站点范围的样式，您可以简单地将 CSS 移动到外部 CSS 文件中，而不是编辑内容。

# javascript - Javascript中的面向对象问题

> ID：444170
> 
> 赞同：40
> 
> 时间：2009-01-14T18:40:20.917
> 
> 标签：javascript, oop

我使用 javascript 已经有一段时间了，但从未学习过基础知识。我正在阅读 John Resig 的“Pro Javascript Techniques”——我提出了一些问题，但我在书中或谷歌等上找不到答案。

John 在他的书中给出了这个例子：
**Function #1**

```
function User( name, age ){
  this.name = name;
  this.age = age;
}
// Add a new function to the object prototype
User.prototype.getName = function(){
  return this.name;
};
User.prototype.getAge = function(){
  return this.age;
};
var user = new User( "Bob", 44 );
console.log("User: " + user.getName() + ", Age: " + user.getAge()); 
```

我还在学习*原型*属性，所以我试着写一些类似的东西：
**Function #2**

```
function User (name, age ) {
  this.name = name;
  this.age = age;
  this.getName = function() {
    return this.name;
  };
  this.getAge = function() {
    return this.age;
  };
}
var user = new User( "Bob", 44 );
console.log("User: " + user.getName() + ", Age: " + user.getAge()); 
```

它不使用*原型*属性来创建 getName 和 getAge 函数，但输出与 John 的示例相同。

我更进一步，创建了这个：
**函数#3**

```
var User = {
  name: "",
  age: 0,
  setName: function(name) {
    this.name = name;
  },
  setAge: function(age) {
    this.age = age;
  },
  getName: function() {
    return this.name;
  },
  getAge: function() {
    return this.age;
  }
};
User.setName("Bob");
User.setAge(44);
console.log("User: " + User.getName() + ", Age: " + User.getAge()); 
```

再一次 - 它看起来与 John 的示例不同（我必须添加 setter 方法），但输出是相同的。

**问题 #1** - 3 个功能之间有什么区别？原型属性的优势是什么，并且函数#2 做错了什么，因为它似乎更直接地使用代码#2 而不是#1（尽管我确信#1 在看到 John 创建它时做得更好） .

**问题 #2** - 如何修改函数 #3 以不使用 setName 和 setAge 方法，但仍保留 {...} 简写？{...} 简写可以有构造函数吗？

在此先感谢您帮助我学习！

**编辑** 我认为我的第二个问题有点令人困惑。我的意思是我怎么能使用 {...} 简写来创建一个用户对象，但是在我创建对象之后，说如下：

```
var user = new User("Bob", 44); 
```

就像在功能 #1 中一样 - 或者这不可能吗？

**编辑 #2** 哇！感谢大家的真棒答案。这真的让我更清楚了。因此，如果我理解正确，#1 和#2 之间的区别并不算太大。如果我只创建一个“用户”对象 - 它们可能根本没有什么不同。但是，如果我的程序创建了许多用户对象，那么 #1 很可能会更高效并且使用更少的内存，因为所有对象都将共享相同的功能。

我非常感谢所有出色的答案-谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-14T18:48:27.157

每次评估 function() {} 时，它都会创建一个新的函数对象。因此，在#1 中，所有 User 对象都共享相同的 getName 和 getAge 函数，但在 #2 和 #3 中，每个对象都有自己的 getName 和 getAge 副本。所有不同的 getName 函数的行为都完全相同，因此您在输出中看不到任何差异。

{...} 简写*是*一个构造函数。评估时，它构造一个具有给定属性的新“对象”。当您运行“new User(...)”时，它会构造一个新的“User”。您碰巧创建了一个与用户具有相同行为的对象，但它们的类型不同。

回复评论：

你不能，直接。您可以按照#3 创建一个创建新对象的函数。例如：

```
function make_user(name, age) {
    return {
        name: name,
        age: age,
        getName: function() { return name; },
        getAge: function() { return age; },
    };
}

var user = make_user("Joe", "18"); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-14T19:21:15.357

如果您想在 JavaScript 中进行 OOP，我强烈建议您查找闭包。我从这三个网页开始学习这个主题：

[http://www.dustindiaz.com/javascript-private-public-privileged/](http://www.dustindiaz.com/javascript-private-public-privileged/)

[http://www.dustindiaz.com/namespace-your-javascript/](http://www.dustindiaz.com/namespace-your-javascript/)

[http://blog.morrisjohns.com/javascript_closures_for_dummies](http://blog.morrisjohns.com/javascript_closures_for_dummies)

1、2、3 的区别如下： 1) 是向现有对象添加新方法的示例。2) 与#1 相同，只是一些方法包含在 User 函数的对象中。[3) 是使用JSON](http://en.wikipedia.org/wiki/JSON)定义对象的示例。缺点是您不能使用 new（至少在该示例中不能）来定义该对象的新实例。但是，您确实会从方便的 JSON 编码风格中受益。

如果您还不知道 JSON，那么您绝对应该阅读它。当您了解 JSON 时，JavaScript 会更有意义。

*编辑* 如果你想在函数#3中使用new，你可以把它写成

```
function User() {
  return {
    name: "",
    age: 0,
    setName: function(name) {
      this.name = name;
    },
    setAge: function(age) {
      this.age = age;
    },
    getName: function() {
      return this.name;
    },
    getAge: function() {
      return this.age;
    }
  };
} 
```

当然，所有这些功能和属性都将是公开的。要将它们设为私有，您需要使用闭包。例如，您可以使用此语法将年龄和姓名设为私有。

```
function User() {
  var age=0;
  var name="";
  return {
    setName: function(name_) {
      name = name_;
    },
    setAge: function(age_) {
      age = age_;
    },
    getName: function() {
      return name;
    },
    getAge: function() {
      return age;
    }
  };
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-14T18:52:39.520

# 2：

您可以访问姓名和年龄，而无需使用此类功能。在 javascript 中，您必须使用不同的技巧来保持私有或受保护的内容。

这

```
User.name = "BoB";
User.age = 44; 
```

将产生与您的示例相同的输出。

没有构造函数，因为它们出现在其他语言中。最简单的方法是定义 init() 函数并在实例化对象后立即调用它。

但我最大的建议是查看[http://www.prototypejs.org/](http://www.prototypejs.org/)。这是一个 javascript 库，有很多很酷的特性，它试图让 javascript “更 OO*”。

使用原型库，您可以使类的行为更像真正的 OOP 类。它还具有构造函数。

编辑：至于您在评论中提出的问题：

```
person = new User();
person.name = "Bob";
person.age = 44; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-14T18:54:27.143

您的示例 #1 显示了原型属性的用法。此属性可用于您创建的所有 javascript 对象，并允许您向对象声明添加属性或函数，因此您有一个具有 2 个属性的对象，后来您添加了 4 个函数（getter 和 setter）。

您应该将原型属性视为在运行时修改对象规范的方式，假设您有一个名为 name 的对象：

```
var Name = {
  First: "",
  Last: ""
}; 
```

您可以使用原型稍后通过简单地添加函数 getFullName() ：

```
Name.prototype.getFullName = function() { return this.First + " " + this.Last; } 
```

在示例 2 中，您将这些 getter 和 setter 的声明内联在对象声明中，因此最终它们是相同的。最后，在第三个示例中，您使用 JavaScript 对象表示法，您应该会看到[JSON](http://www.json.org/)。

关于您的问题 2，您可以将您的对象声明为：

```
var User = {
  name: "",
  age: 0
}; 
```

这将为您提供没有 getter 和 setter 的相同对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T18:54:16.630

**问题 #1**

`prototype`有[猴子补丁](http://en.wikipedia.org/wiki/Monkey_patch)的好处。如第一个示例所示，该功能是事后添加的。您可以继续此操作以添加或替换您需要的任何方法（尽管有公平的警告）。

定义像 #2 这样的对象更符合经典 OOP 的路线。但是，话又说回来，猴子修补在所有 OOP 语言中都是不允许的。

**问题2**

在您的第三个功能中，您甚至不需要`get`and`set`功能 -`name`并且`age`是公共属性（潜在的缺点`{}`）。

```
var User = {
  name: "",
  age: 0
};

User.name = 'Bob';
User.age = 44;

console.log("User: " + User.name + ", Age: " + User.age); 
```

`{}`当您使用（对象文字）创建对象时，`{}`是构造函数（因浏览器而异）。但是，本质上，不，您不能以这种格式使用构造函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T20:10:42.700

您似乎在这里有一些很好的答案，但您可能想看看这个问题：[best-approach-to-member-variables-in-object-oriented-javascript](https://stackoverflow.com/questions/436234/best-approach-to-member-variables-in-object-oriented-javascript#43648)。这是[我的回答](https://stackoverflow.com/questions/436234/best-approach-to-member-variables-in-object-oriented-javascript#43648)，描述了差异和相似之处。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-24T10:09:17.593

如果你对 JSON 风格的 JavaScript 类声明感兴趣的话……

[http://mahtonu.wordpress.com/2010/04/13/json-style-javascript-object-declaration/](http://mahtonu.wordpress.com/2010/04/13/json-style-javascript-object-declaration/)

# asp.net - 如何为 ASP.Net 网站项目设置不同的构建配置？

> ID：444179
> 
> 赞同：0
> 
> 时间：2009-01-14T18:43:16.760
> 
> 标签：asp.net, visual-studio, visual-studio-2008, configuration, build-environment

根据[先前关于 Visual Studio 配置的问题](https://stackoverflow.com/questions/259311/configuration-manager-only-shows-debug)，无法使用 Visual Studio 的配置管理器为 ASP.net 网站项目创建不同的配置。

对于普通项目，我们有 #if 指令根据我们是在调试还是在生产中切换某些服务器或数据库变量。这不适用于网站。

例如，在定义网站后端服务器连接的类（在 App_Code 中）中，如果您想在本地运行调试服务器，可能会有这样的代码块覆盖 web.config 中的生产值机器：

```
#if DEBUGLOCAL
           ServerProperties.ServerIP = "localhost";
           ServerProperties.DataContextIP = "localhost";
#endif 
```

这不起作用，因为网站没有“本地调试”配置，因此没有定义 DEBUGLOCAL。

您是否找到了解决此类问题的好方法？此外（我希望）重构所有内容，以便所有这些引用都存在于类库项目中？

ETA：[Web 部署项目](http://www.microsoft.com/downloads/details.aspx?familyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&displaylang=en)可以在这里提供帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T18:49:50.960

也许在 web.config 中进行一些交换的 Web 部署项目可能会有所帮助？另一个想法是在 web.config 中有一个连接字符串，它从可以存在于每个环境中的预先指定的数据库中提取各种值，以便轻松更改设置而无需触及任何文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T18:14:46.520

另一种选择可能是将[网站升级为 Web 应用程序](http://weblogs.asp.net/scottgu/archive/2006/02/05/437439.aspx)。

现在进行过渡可能需要做很多工作，但是如果您决定使用网站或 Web 应用程序，那么拥有配置的能力可能有助于调整规模。

# security - 在经典asp中清理输入的好方法

> ID：444181
> 
> 赞同：8
> 
> 时间：2009-01-14T18:43:45.013
> 
> 标签：security, asp-classic, sanitization

我必须更新工作中的旧项目。尽管我熟悉 php 脚本，但我对经典的 asp 没有任何经验。

*   有什么我应该使用的功能吗？
*   能给我提供一些基本保护的好功能吗？
*   asp中是否有类似参数化查询的东西？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-14T20:34:32.947

是的，您可以在经典 ASP（更准确地说，经典 ADO）中使用参数化查询。

这是一个[链接](https://web.archive.org/web/20150207201957/http://support.microsoft.com/kb/200190)。

至于编码输出，我可能很想为最新的 Microsoft Anti-XSS 库创建一个包装器，并使用 Server.CreateObject 调用它。由于我在 .Net 上花费了更多时间，因此我远非这类事情的专家，所以我认为这会起作用。

Server.HTMLEncode 确实不够好，因为它只将一些编码字符列入黑名单。Anti-XSS 库要好得多，因为它将可接受的内容列入白名单。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-14T18:53:13.980

始终使用 Server.HTMLEncode 来清理用户输入。

例如，如果您从表单文本框中设置变量：

firstName = Server.HTMLEncode(trim(request.form("firstname")))

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T19:14:57.930

注意 SQL 注入。不要将用户输入连接到 SQL 字符串然后执行它。相反，始终使用参数化查询。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T19:21:27.883

有很多以 Is 开头的函数，例如等`IsNumber`，`IsArray`可能会引起人们的兴趣。此外，如果您期望一个整数，您可以使用`CLng(Request("blabla"))`它来获取它，因此如果它不是整数，CLng 函数将引发错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T19:35:46.373

一种方法可能是在`header.asp`文件中添加一个检查，该检查遍历`Request`对象以查找不适当的字符。例如：

```
<%
    for each x in Request.Form ' Do this for Request.Querystring also
        If InStr(x,"<") <> 0 Then
            ' encode the value or redirect to error page?
        End If
    next
%> 
```

# c# - 如何防止以下 C# 代码中的死锁？

> ID：444191
> 
> 赞同：2
> 
> 时间：2009-01-14T18:46:55.600
> 
> 标签：c#, .net, multithreading, deadlock

以下 C# 类用于多线程环境。我删除了很多实际代码。几乎同时调用 MethodA 和 MethodB 时会出现问题。IsDepleted 属性中的锁顺序并不能解决问题。从 IsDepleted 属性中删除 lock(WaitingQueue) 可以解决死锁，但是当另一个线程在 WaitingQueue.Count == 0 和 Processing.Count == 0 语句之间从 WaitingQueue 添加/删除项目时，此解决方案会导致问题。

```
using System.Collections.Generic;

class Example
{
    bool IsDepleted
    {
        get
        {
            lock (Processing)
            {
                lock (WaitingQueue)
        {
                    return WaitingQueue.Count == 0
             && Processing.Count == 0;
        }
            }
        }
    }

    private readonly List<object> Processing = new List<object>();
    private readonly Queue<object> WaitingQueue = new Queue<object>();

    public void MethodA(object item)
    {
        lock (WaitingQueue)
        {
            if (WaitingQueue.Count > 0)
            {
                if (StartItem(WaitingQueue.Peek()))
                {
                    WaitingQueue.Dequeue();
                }
            }
        }
    }

    public void MethodB(object identifier)
    {
        lock (Processing)
        {
            Processing.Remove(identifier);
            if (!IsDepleted)
            {
                return;
            }
        }
    //Do something...
    }

    bool StartItem(object item)
    {
        //Do something and return a value
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T18:52:28.957

这取决于您是想要快速修复还是严格修复。

一个快速的解决方法是在所有情况下都使用一个锁对象。

例如`private readonly object _lock = new object();`

然后锁定它。但是，根据您的情况，这可能对性能的影响超出您的接受程度。

即你的代码会变成这样：

```
using System.Collections.Generic;

class Example
{
    private readonly object _lock = new object();

    bool IsDepleted
    {
        get
        {
            lock (_lock)
            {
                return WaitingQueue.Count == 0
                 && Processing.Count == 0;
            }
        }
    }

    private readonly List<object> Processing = new List<object>();
    private readonly Queue<object> WaitingQueue = new Queue<object>();

    public void MethodA(object item)
    {
        lock (_lock)
        {
            if (WaitingQueue.Count > 0)
            {
                if (StartItem(WaitingQueue.Peek()))
                {
                    WaitingQueue.Dequeue();
                }
            }
        }
    }

    public void MethodB(object identifier)
    {
        lock (_lock)
        {
            Processing.Remove(identifier);
            if (!IsDepleted)
            {
                return;
            }
        }
        //Do something...
    }

    bool StartItem(object item)
    {
        //Do something and return a value
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T18:50:19.820

取方法 A 中的 Processing 锁和方法 B 中的 WaitingQueue 锁（换句话说，让它看起来像第一个代码块）。这样，您总是以相同的顺序获取锁，并且您永远不会死锁。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T19:00:03.903

简化您的代码并仅使用一个对象来锁定。您还可以将锁替换为：

Monitor.TryEnter（处理中，1000）

这会给你 1 秒的超时时间。所以本质上：

```
 if (Monitor.TryEnter(Processing, 1000))
        {
            try
            {
                //do x
            }
            finally
            {
                Monitor.Exit(Processing);
            }
        } 
```

现在你不会停止死锁，但你可以处理没有锁的情况。

# c# - IStreamBufferMediaSeeking setPosition 似乎没有呈现

> ID：444192
> 
> 赞同：0
> 
> 时间：2009-01-14T18:47:07.627
> 
> 标签：c#, directshow

我创建了两个 DirectShow 图表。一个从 Hauppauge HD-PVR 捕获并将其存储在 StreamBufferSink 中。第二个使用 a `StreamBufferSource`，将输出发送到 MPEG-2 Demultiplexer，将视频发送到 ArcSoft Video Decoder，然后发送到设置为无窗口模式的 Video Mixing Renderer 9。

这一切都适用于预览数据。当我使用该`IStreamBufferMediaSeeking.SetPositions`方法（从 获取界面`StreamBufferSource`）更改播放位置时，如果我将其设置在流开头以外的任何位置，视频将冻结并停止更新。调用`GetCurrentPosition`显示`IStreamBufferMediaSeeking`位置在流中移动，但视频没有跟随。

我正在使用 C# 和 DirectShowLib-2005 进行编程。

关于出了什么问题或如何找出问题所在的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T21:44:46.567

我发现 StreamBufferSink/StreamBufferSource 只能理解 MPEG-2 或 DV 视频。不支持 H.264，因此它不知道如何在流中搜索，因此我无法使用此组件来完成我想做的事情，除非我将流转码为 MPEG-2，这违背了拥有 H.264 的目的首先是流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-02-15T19:22:49.990

更多信息：这实际上可以在 Windows 7 下使用流式缓冲区引擎的更新。要倒带，我必须在将数据放入 Stream Buffer Sink 之前对流进行解复用并添加 MPEG-2 Video Stream Analyzer 过滤器。

# orm - O/R 映射工具 ASP

> ID：444198
> 
> 赞同：0
> 
> 时间：2009-01-14T18:49:43.987
> 
> 标签：orm, asp-classic

是否有用于 ASP（不是 ASP.NET）的 O/R 映射工具，这些工具在 ASP 中是否有用？

利文·卡登

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T18:59:37.803

快速扫描谷歌搜索，我没有看到任何说明经典 ASP 的内容。鉴于 ASP 是一个有些过时的平台，我怀疑任何主要参与者都会出现在该领域。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T19:12:57.637

几年前我写了自己的 - 它不打扰遍历关系，但非常好地抽象出数据读取和写入。

# asp.net - 防止用户使用“X”关闭浏览器窗口？

> ID：444204
> 
> 赞同：0
> 
> 时间：2009-01-14T18:51:01.627
> 
> 标签：asp.net, javascript, html

我可以使用 javascript 判断用户是否单击了浏览器对话框上的“X”图标，还是“确定”/“取消”按钮？我有代码需要在窗口关闭时运行，但只有在单击“确定”或“取消”时才会运行。

我目前正在捕获窗口的 onunload 事件。我怎样才能做到这一点？

```
window.onunload = function() { alert("unloading"); } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T18:54:43.133

你为什么要这样做？如果您告诉我们您正在尝试做什么，我们可能会帮助您提出不需要这样做的不同设计。

但是，要回答您的问题：不可能在所有情况下都捕捉到该事件。您不能阻止用户关闭浏览器或保证您的代码会在他们关闭时执行。您可以让他们稍微烦人，但他们可以禁用 javascript，或终止进程，或重新启动计算机。使用 unload 函数是最接近在窗口关闭时运行的一些代码（它将在正常关闭或用户导航离开的情况下运行）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T19:15:24.510

如果我理解正确，您的问题是关于浏览器**对话框**，而不是主浏览器**窗口**。

要回答您的问题，您可能无法区分浏览器**对话框**的取消按钮和 X 按钮。他们最终都会返回一个`false`. 如果您需要这种级别的控制，您应该考虑编写自己的模拟对话框（灯箱）而不是真正的 JavaScript 对话框。或者也许看看现有的框架/插件与模态对话框，给你你需要的控制量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-14T18:55:20.853

如果他按 ALT + F4 怎么办？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-14T19:15:50.610

据我所知，您无法检测用户是否通过单击“取消”按钮或 [x] 按钮关闭了对话框，因为除了返回操作结果（例如，confirm() 为真假）。

您可以挂接到 document.onbeforeunload 事件以执行您需要的任何清理操作；我自己通过向服务器发送异步 XMLHTTP 请求来确保用户的会话得到正确清理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T19:06:13.500

不可能捕捉到浏览器的关闭并处理所有其他也会导致回发的事件。你可以尝试，很多人在你之前都失败了。

最好的办法是使用 onbeforeunload 并学习如何处理服务器端的会话超时以清理数据。

# msbuild - 如何为 msbuild 构建的 C++ 项目设置输出目录？

> ID：444207
> 
> 赞同：5
> 
> 时间：2009-01-14T18:51:50.270
> 
> 标签：msbuild

我有一个 MSBuild .proj 文件，它正在编译 C# 和 C++ 项目的混合。

C# 项目将输出 (.exe/.dlls) 编译到我指定的 OutputPath，但是当我为 C++ 项目（调用 vcbuild.exe）指定 OutputPath 时，OutputPath 被忽略，而是进入属性页中指定的目录对于 .vcproj。

这是我的 MSBuild 任务：

```
 <MSBuild Projects="$(SourceFolder)\$(NativeSolutionName)"
             Targets="$(BuildTargets)"
             Properties="Configuration=$(Configuration);PlatformName=Win32;OutputPath=$(ToolsOutputDir)">
    </MSBuild> 
```

如何指定 C++ 输出文件与 C# 输出文件 $(ToolsOutputDir) 位于同一目录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T17:54:02.740

我能够通过执行以下操作来完成这项工作：

1) 安装[Microsoft SDC MSBuild 任务库](http://www.codeplex.com/sdctasks)

2) 在 C++ 项目的属性页中，将输出目录设置为`$(OutputPath)`.

`OutputPath`3) 在通过 VCBuild 构建 C++ 项目之前添加一个 SDC 任务来设置环境变量：

```
 <Microsoft.Sdc.Tasks.SetEnvironmentVariable Variable="OutputPath" Value="$(ToolsOutputDir)" Target="Process"/>

    <!-- Build any CPP code x86 -->
    <MSBuild Projects="$(SourceFolder)\$(NativeSolutionName)"
             Targets="$(BuildTargets)"
             Properties="Configuration=$(Configuration);PlatformName=Win32;OutputPath=$(ToolsOutputDir)">
    </MSBuild> 
```

# perl - 如何使用 Perl 每月轮换日志文件？

> ID：444208
> 
> 赞同：2
> 
> 时间：2009-01-14T18:52:06.430
> 
> 标签：perl, unix, logging, rotation

在 Unix 中，我需要能够将日志文件归档到每月文件夹中，并进行相应标记。我如何在 Perl 中做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T19:06:19.023

它必须是Perl吗？你试过logrotate吗？

至于 Perl 解决方案：**mkdir**将创建目录，如果您**使用 POSIX 'strftime';** ，那么您将能够根据当前时间生成漂亮的目录名称（即，**我的 $dirname = strftime('%Y-%m-%d',localtime())**将生成一个 YYYY-MM-DD 字符串)，您可以使用**rename**移动文件。这只是 Perl 的核心，有大量的 CPAN 模块可以完成部分或全部工作（例如 File::Copy，而不是重命名）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T19:04:40.587

当我完成这项任务时，我使用[cronolog](http://cronolog.org/usage.html)。

该软件包包含一个名为 Perl 的脚本`cronosplit`，您可以使用该脚本将现有的整体日志文件拆分为`%Y/%m/%d`子目录。

Cronolog 本身是用 C 编写的二进制文件，可用作日志记录的管道目标。例如，您可以在 Apache httpd.conf 中使用它：

```
CustomLog "|/usr/sbin/cronolog /web/logs/%Y/%m/%d/access.log" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T23:14:18.057

让我们提供一个实际的 Perl 想法，因为这是我们所要求的：

```
use File::Path qw<mkpath>;
use File::Spec;
use POSIX qw<strftime>;
use Smart::Comments;

my $directory 
    = File::Spec->catfile( $BASE_LOG_DIRECTORY
                         , strftime( "%Y-%B", localtime ) #2009-January
    );
### $directory
unless ( -e $directory ) {
    mkpath( $directory, { verbose => 1 } );
}
my $log_file_path = File::Spec->catfile( $directory, 'system.log' );
### $log_file_path 
```

输出是

```
### $directory: '/my/base/directory/2009-January'
### $log_file_path: '/my/base/directory/2009-January/system.log' 
```

笔记

1.  安装`Smart::Comments`，或将其注释掉。
2.  该常量`$BASE_LOG_DIRECTORY`以 Readonly/PBP 样式编写
3.  其他一切都应该随 Perl 一起提供。

# c# - 如何使用 Exchange 2007 和 c# 在域外发送电子邮件

> ID：444210
> 
> 赞同：5
> 
> 时间：2009-01-14T18:52:35.697
> 
> 标签：c#, smtp, exchange-server-2007

只要发件人和收件人地址都在我的域内，我就可以使用典型的 C# SMTP 代码跨 Exchange 2007 发送电子邮件。

一旦我尝试在域外发送电子邮件，我就会得到：

异常详细信息：System.Net.Mail.SmtpFailedRecipientException：邮箱不可用。服务器响应为：5.7.1 无法中继

如何让 Exchange 接受我的电子邮件并将其发送到互联网？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-14T19:46:07.867

尝试 #2... 改用[Exchange Pickup Folder](http://www.msexchange.org/articles_tutorials/exchange-server-2007/management-administration/exchange-pickup-folder.html)怎么样？它们是通过 Exchange 发送电子邮件的更快方式，因为它只是创建电子邮件并将其放入文件夹中，无需等待连接到服务器或等待回复。另外，我认为它跳过了整个继电器问题。

像这样配置你的 SmtpClient：

```
SmtpClient srv = new SmtpClient("exchsrv2007", 25) {
    DeliveryMethod = SmtpDeliveryMethod.SpecifiedPickupDirectory,
    PickupDirectoryLocation = "\\exchsrv2007\PickupFolder"
}
... 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-14T19:06:11.613

向交换服务器进行身份验证。

[http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.credentials.aspx](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.credentials.aspx)

* * *

> DefaultNetworkCredentials 为用户名等返回空字符串并导致此异常...

这是一个[示例](http://aspalliance.com/867)，这是[另一个](http://www.systemnetmail.com/faq/4.2.aspx)使用 System.Net.Mail 发送经过身份验证的消息的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T19:05:23.267

您需要让您的交换管理员配置交换以允许在域外发送。根据我的经验，由于垃圾邮件问题，他们一直不愿意这样做。

如果它的用途有限，您可以设置服务器端规则以交换在域外转发满足某些条件的邮件。您也许可以在这些中使用 VBA 来美化事物，但我不确定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T19:08:55.600

您是否设置了交换服务器以允许来自您的 Web 服务器的[中继？](http://www.mcpblog.net/Lists/Posts/Post.aspx?List=8f2497f6-e77b-4e70-8400-e020b292165c&ID=47)切换到 Exchange 2007 时，我遇到了同样的问题。

# javascript - 在firefox中，如何使用javascript更改treecell中文本的颜色

> ID：444213
> 
> 赞同：0
> 
> 时间：2009-01-14T18:53:41.483
> 
> 标签：javascript, css, firefox, xul

背景：我有以下 XUL 片段

```
<tree id="treeToChange" flex="1">
  <treecols>
    <treecol label = "First Column" id="c1" flex="1"/>
    <treecol label = "Second Column" id="c2" flex="1"/>
  </treecols>
  <treechildren>
    <treeitem>
      <treerow>
        <treecell label="Data for Column 1"/>
        <treecell label="Data for Column 2"/>
      </treerow>
    </treeitem>
  </treechildren>
</tree> 
```

和下面的css片段

```
tree {  font-size: 120%; color: green;} 
```

这会导致我的列数据以绿色文本显示。

我在 XUL 页面上有很多这样的树对象

问题：在 Firefox 中，为了响应调用 javascript 例程的点击事件，如何将第 1 列中的对象“treeToChange”的数据设置为红色，并将数据设置为蓝色列？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T18:56:50.337

DOM 元素的 style 属性包含该元素的所有 CSS 声明。命名方案略有不同（camelCaps 而不是破折号），但在其他方面完全相同。

```
 element.style.color = 'blue'; 
```

[您可以在Mozilla javascript 手册](http://developer.mozilla.org/en/DOM/element.style)中阅读有关 style 属性的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T19:00:33.323

要设置任何元素的颜色，您可以使用：

```
function changecolour(elid, nc) {
    document.getElementById(elid).style.color = nc;
} 
```

所以

```
changecolour("c1", "red");
var x = document.getElementsByClassName("cell");
for ( var i = 0; i < x.length; i ++ ) {
    changecolour(x, "blue");
} 
```

如果您向单元格添加单元格类，将更改数据的颜色（以避免与文档中的其他树冲突）

顺便说一句，[这里](http://www.robertnyman.com/2005/11/07/the-ultimate-getelementsbyclassname/)是 document.getElementsByClassName：

```
function getElementsByClassName(className, tag, elm){
var testClass = new RegExp("(^|\\s)" + className + "(\\s|$)");
var tag = tag || "*";
var elm = elm || document;
var elements = (tag == "*" && elm.all)? elm.all : elm.getElementsByTagName(tag);
var returnElements = [];
var current;
var length = elements.length;
for(var i=0; i<length; i++){
    current = elements[i];
    if(testClass.test(current.className)){
        returnElements.push(current);
    }
}
return returnElements; 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T15:34:48.397

事实证明 element.style.color 只影响列标题，而在 Firefox 中，树结构中的单元格只能通过编码数据视图来影响。

代码片段如下：

 `````
// DatabaseTreeView: Create a custom nsITreeView
DatabaseTreeView: function(aTableData, aColumns) {

this.getCellProperties   = function(row,col,props){
var aserv=Components.classes["@mozilla.org/atom-service;1"].getService(Components.interfaces.nsIAtomService);
props.AppendElement(aserv.getAtom("color_"+col.id));
props.AppendElement(aserv.getAtom("font_"+col.id));
}; 
```

...

and modify the css as follows

```
treechildren::-moz-tree-cell-text(color_c1){ color:DarkGreen}
treechildren::-moz-tree-cell-text(color_c2){ color:Navy}
treechildren::-moz-tree-cell-text(font_c1){ font-size:120%}
treechildren::-moz-tree-cell-text(font_c1){ font-size:150%} 
````  `我希望这对将来的其他人有所帮助

# console - 如何使控制台程序消失并在后台工作？

> ID：444223
> 
> 赞同：4
> 
> 时间：2009-01-14T18:55:22.070
> 
> 标签：console, background

如何使控制台程序消失并在后台工作？我的意思是，我不想看到程序，但我想看到它在任务管理器中运行。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T19:00:18.427

假设 Windows 和 .NET：

您可以将其输出类型设置为“Windows 应用程序”，它不会打开控制台窗口......

或者您可以创建一个 Windows 服务...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T19:08:59.983

您也可以制作一个进入系统托盘。这也将允许您直接从系统托盘添加终止进程，而不是转到任务管理器。在.NET中，我使用了以下内容：http: [//www.developer.com/net/csharp/article.php/3336751](http://www.developer.com/net/csharp/article.php/3336751)

这可能会提供一些优势。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T19:00:11.470

假设 MS Windows XP 环境：

我的建议是考虑创建一个[Windows 服务](http://www.c-sharpcorner.com/UploadFile/mahesh/window_service11262005045007AM/window_service.aspx)来执行您的要求，尽管另一种可能性是在 msconfig 中设置一些东西以在启动时或在“开始->所有程序->启动”中的启动组中运行该程序“ 部分。

如果您在 Mac、Linux 或其他一些操作系统上，可能存在类似的功能来充当在后台运行程序的地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T19:00:39.550

如果您使用的是 Windows，请尝试

```
start command.exe 
```

如果你使用 *nix

```
nohup command 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T19:04:05.207

假设您无法修改控制台应用程序并使其成为无窗口应用程序，您可以创建一个无窗口应用程序来启动控制台程序并将所有标准输入和输出流重定向到“虚拟”流。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-05T12:36:24.800

在 Windows 上用于`ShowWindow(FindWindowA("ConsoleWindowClass", NULL), false)`隐藏控制台窗口。它仍将在后台运行，并且在任务栏上不可见。

但是，您将不得不运行一个任务管理器`Taskmgr.exe`来找到它并关闭它。

```
#include <windows.h>  
#include <iostream>     
using namespace std;

int main () {   
    ShowWindow(FindWindowA("ConsoleWindowClass", NULL), false);
    while(true) {
                 // Do your hidden stuff here
    }   
return 0;
} 
```

# sql-server-2005 - 连接到 Sql Server 2005 的 Access 2007 项目出现问题

> ID：444225
> 
> 赞同：0
> 
> 时间：2009-01-14T18:57:14.907
> 
> 标签：sql-server-2005, ms-access, ms-access-2007, access-data-project

因此，我为我的一位用户创建了一个 Access 项目，以便他可以连接到报告数据库。.adp 项目连接到数据库，他可以随心所欲地查询数据。问题是，无法保存任何查询。每当他打开项目时，都会出现以下错误：

*“此版本的 Microsoft Access 不支持您的 Access 项目所连接的 Microsoft Sql Server 版本的设计更改。有关最新信息和下载，请参阅 Microsoft Office 更新网站。您的设计更改将不会被保存。”*

再次，这是 Access 2007 和 Sql Server 2005。我的谷歌搜索工作 - 在我似乎特别愚蠢的一天即将到来 - 不断提出有关 Access 2002/2003 试图连接到 Sql Server 2005 的此错误的信息，它显然不是我的问题。

我看到人们可以使用普通的 Access 数据库（2007 年的 .accdb 或类似的数据库）连接到 Sql Server，但我看到关于我是否想要这样做的混合信息。而且由于我无法获得 Access 2007 的副本，因此我无法真正对此进行测试（主题再谈）。

在我沿着这条路走之前，我想深入了解这条路。任何人有任何建议，有用的链接或有用的知识？还是一个知道不再需要的答案的老开发者，让我可以吃掉他，吸收他的知识和力量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T15:56:00.857

The account being used to connect to the DB was only a db_reader. I changed it to DBO and that fixed the problem - user can now create and save queries, and sleep at night knowing that tomorrow will bring a new day with new querying possibilities.

I'm not super crazy about this though the reporting database has been set up on a separate install/server from impotant App databases. I'm not worried about the user (or anyone on his group) blowing anything up. I'd like to understand why this is, and don't (outside of the obvious - reader is read only! I didn't expect that to extend to work in Access), and will try to do so at a later time. One of the unfortunate aspects of working at a dev shop focused on internal app development is, "well, it's working, you have other things to see to".

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T19:47:17.847

我不确定我是否可以在这里提供帮助。

但是您可以在 Access 中拥有一个连接到 SQL 数据库并使用该视图的视图。
或者，你可以走另一条路。有一个带有 SQL Server 的数据库项目并创建一个连接到 MS-Access DB 的服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T19:08:44.363

您是否尝试通过 ODBC 连接链接到表？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T17:14:38.097

CodeSlave，我没有。高层的态度是“它正在工作，继续前进”。我不确定老板是否真的想走那条路，但这是一个有争议的问题。我可能应该尝试授予帐户 dbreader 和 dbwriter 访问权限，看看是否能完成同样的事情，但作为 dbo 并不是什么大不了的事。或者更确切地说，“当权者”希望我立即寻求改变还不够大。

我打算尝试链接表，直到更改 SQl 服务器帐户权限“解决了问题”（非常慎重的引用；感觉就像您在没有正确理解它的工作原理的情况下得出的解决方案之一，这让我很烦恼）。

# communication - 模块之间的通信

> ID：444229
> 
> 赞同：-1
> 
> 时间：2009-01-14T18:58:04.267
> 
> 标签：communication, module

我有一个由以下三个模块组成的应用程序：

*   搜索（搜索对象）
*   列表（显示搜索结果）
*   Painter（允许我编辑对象）- 并不总是加载此模块

（每个对象都是我可以在画家中编辑的图形）。

当我在画家中打开一个对象时，它会添加到画家中已经存在的对象中，我可以移动它并更改它。

我正在使用类似于 EventAggregator 的对象在模块之间进行通信。例如，为了显示搜索结果，我发布了一个由 List 模块捕获的“ShowList”事件（我不确定这是不是最好的方法，如果有人有更好的想法，请发表评论......）。

搜索模块的功能之一要求它在画家中获取所选对象（如果画家可用），我不确定什么是最好的方法......

我想到了这些解决方案：

1.  每当painter中的选定对象发生更改时，它将发布一个“PainterSelectedObjectChanged”事件，该事件将被搜索模块捕获并存储以供以后使用。

2.  当搜索模块需要所选对象时，它将发布一个“RequestingPainterSelectedObject”事件，该事件将被画家模块捕获。然后，painter 模块将在 EventArgs 对象中设置“SelectedObject”属性，当发布完成并且我们返回搜索模块时，我们将在 EventArgs 对象中拥有画家选择的对象。

你怎么看？这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T14:48:26.500

我会说，选项 B。这听起来很常见，也许我没有完全理解它。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T10:40:10.837

我想说，选项A。这听起来很*常见*，也许我没有完全理解它。:)

# .net - 可以在 Windows 应用程序中使用 asp.net 成员资格提供程序吗？

> ID：444230
> 
> 赞同：15
> 
> 时间：2009-01-14T18:58:17.977
> 
> 标签：.net, asp.net, wpf, asp.net-membership

Asp.Net 会员提供程序在 Web 应用程序中有一些明确的用途。我正在考虑尝试利用 Windows 应用程序（更具体地说是 WPF）中的一些功能。有谁知道是否可以在 Windows 应用程序中使用核心功能？我主要只是在寻找它来创建我的数据库表，并维护用户、角色和配置文件。我显然不需要使用内置的网络控件（例如登录）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-14T19:04:55.827

是的。成员资格、角色和配置文件是 Visual Studio 2008 客户端应用程序服务的所有功能（项目属性的服务选项卡）

[http://msdn.microsoft.com/en-us/library/bb384297.aspx](http://msdn.microsoft.com/en-us/library/bb384297.aspx)

[http://channel9.msdn.com/posts/DanielMoth/Client-Application-Services-with-Visual-Studio-2008/](http://channel9.msdn.com/posts/DanielMoth/Client-Application-Services-with-Visual-Studio-2008/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T01:45:38.700

我有一个与 DotNetNuke (DNN) 对话的 winform 应用程序。DNN 使用 Asp.net 成员资格提供程序，因此该来源也适用于使用该成员资格提供程序的其他应用程序。这是一个非常简单的应用程序，因此您应该能够轻松阅读源代码。

[http://www.datakido.com/downloads/Token/ViewInfo/ItemId/3](http://www.datakido.com/downloads/Token/ViewInfo/ItemId/3)

您应该能够调整源以使用 WPF。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T01:20:42.200

是的你可以。

所有配置都可以在 app.config 中完成，而不是在 asp.net 的 web.config 中完成。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-19T17:18:10.027

确保您正在创建 3.5 应用程序（WPF 4 还不能工作） - 然后您必须导入参考 System.Web。这将允许您使用“使用 System.Web.Security;” 就像您通常在 Web 应用程序中一样......现在您可以访问诸如 Membership.CreateUser() 之类的东西

您的 app.config 文件必须与连接字符串一起为您的提供程序配置。

# html - 在 RSS 提要中嵌入 HTML 的最佳方式是什么？

> ID：444231
> 
> 赞同：6
> 
> 时间：2009-01-14T18:58:42.813
> 
> 标签：html, django, rss

我正在使用 Django 的 RSS 功能来构建 RSS 提要。`<description>`RSS 提要项的 包含 HTML 标记。目前，我只是使用以下模板将 HTML 标记注入到提要中：

```
{{ obj.post }} 
```

当然，Django 会将特殊字符（`<`、`>`、`&`等）翻译成它们各自的 HTML 实体。

我知道我可以只输出 HTML 并将所有 HTML 代码包装在`<![CDATA[...]]>`部分中。[这个页面](http://cyber.law.harvard.edu/rss/encodingDescriptions.html)说这两种方法都是可以接受的。如果这是真的，是否有充分的理由选择一种方法而不是另一种方法？如果我使用示例#2，是否有一个过滤器让 Django 自动将 HTML 文本包装在 CDATA 标记中，或者我应该将模板更改为：

```
<![CDATA[
{{ obj.post|safe }}
]]> 
```

* * *

# 编辑

无论如何，无论您是否通过`safe`过滤器，Django 似乎都会自动转义 RSS 提要（或任何 XML）中的特殊字符（此问题已在[此票](http://code.djangoproject.com/ticket/6533)中讨论）。但是，欢迎提供一般性答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T09:33:59.600

When I run into issues like this with Django my first instinct is to run off and find a normal Python lib that does what I want. In this case [PyRSS2Gen](http://www.dalkescientific.com/Python/PyRSS2Gen.html) might be your saviour.

It'll probably require a bit more fannying around (because it'll be unaware of what Django objects are) but it should be raw enough to let you do as you wish.

And if it isn't, it's just a script. You can hack it apart to allow raw HTML if you please =)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T09:52:22.447

Embedding HTML is CDATA has troubled me in the past. Hope RSS readers have evolved to handle such embeds.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T08:51:27.760

与其编写自己的 RSS XML 提要，不如考虑使用以下 Django 联合框架`django.contrib.syndication`：

[https://docs.djangoproject.com/en/dev/ref/contrib/syndication/](https://docs.djangoproject.com/en/dev/ref/contrib/syndication/)

# version-control - 修订控制锁定：陪审团还在吗？

> ID：444235
> 
> 赞同：21
> 
> 时间：2009-01-14T19:00:18.287
> 
> 标签：version-control

当我在线时，似乎每个人都同意在源代码控制中使用独占锁定工作流程是一件坏事。我看到的所有新版本控制系统似乎都是为编辑和合并工作流而构建的，而且很多甚至根本不支持独占锁。

但是，与我一起工作的每个人都认为，独占锁是任何源代码控制系统的“必备”，而以任何其他方式工作将是一场噩梦。即使是最近从其他公司招聘的员工似乎也有这个想法。

我的问题不是谁是对的。我很确定我会得到什么答案。我的问题是，关于这个问题真的还有任何争论吗？是否有一个诚实的“亲锁定”阵营可以提出严重的问题？是否正在做任何工作来推进基于锁定模型的修订控制艺术？还是锁定粉丝在鞭笞一匹死马？

编辑：到目前为止，答案已经很好地解释了为什么独占锁是偶尔使用的好功能。但是，我说的是推广一种对*所有内容*都使用独占锁的工作流程。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-14T19:13:29.243

如果您习惯于独占锁定，那么很难接受编辑合并工作流程。

独占锁定有其好处，尤其是对于无法自动合并或根本无法合并的二进制文件（图像、视频等）。

但是：排他锁的需求总是预示着另一个问题：项目工作人员之间的良好沟通。独占锁定提供了一个糟糕的替代方案：它告诉用户其他人已经在处理该特定文件 - 他们应该知道这一点，而无需使用版本控制系统。

由于有更好的方法来帮助团队成员之间的沟通，大多数（全部？）版本控制系统不再实现排他锁定或只是简化版本（即锁定，但不强制执行这些锁定）。

帮助沟通不是版本控制系统的工作。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-14T19:07:57.850

我喜欢有独占锁定某些文件的**选项。**

排他锁是必需的，例如对于二进制文件。

对于某些机器生成的非二进制文件（例如，对于 Visual Studio 项目文件，如果有两个并行更改要合并，这些文件根本不会“合并”）也是半必要的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-14T19:11:38.700

如果您认为合并很困难（虽然我们已经取得了长足的进步，但在某些情况下可能会如此），并且您没有程序员经常想要编辑同一个文件，那么独占锁定并不一定那么糟糕。

显然，我不会在开源项目中使用它们，但在规则更严格的企业界，你可以走到一个人面前说“我可以打破你的锁吗？”，它可以让人们了解人们是什么工作并避免冲突，因此它们不必在以后解决。

如果两个人确实需要同时处理一个文件，通常您可以对该文件进行分支，只要该工具明确指出该分支需要重新合并，您就可以这样做并解决任何冲突.

也就是说，我认为我不想再次在排他锁定的世界中工作。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-14T20:27:31.073

在最坏的情况下，排他锁是你能做的最好的事情，所以它的存在总是告诉我有更大的问题。

这些更大的问题之一是代码组织不当。在我为一家大型电信公司做的一次咨询工作中，30 名团队成员中有 8 名一直在处理同一个源文件（VB.NET “上帝”形式）。我们会等待其他人完成他们的工作并释放排他锁 (VSS)，然后按顺序排列的下一个人会立即锁定文件以应用他们的更改。这需要很长时间，因为他们必须将所有工作重新集成到他们只能在那时才能看到的新代码中。因为我是新人，所以我处于最底层，我从来没有被允许检查我的代码更改。我最终去找项目经理/主管，并建议我负责应用程序功能的另一部分。这个项目最终自毁，但当我们意识到这种必然性时，我们大多数人都离开了。请注意，VSS 集成的使用也是此失败的关键部分，因为它会强制提前获取宝贵的文件锁。

因此，一个组织良好的项目几乎永远不会导致两个人同时处理同一个源文件的同一部分。因此，不需要排他锁。

另一个更大的问题是将二进制文件放入源代码控制中。源代码控制工具不是为处理二进制文件而设计的，这是一件好事。二进制文件需要不同的处理方式，而源代码控制工具无法支持这种特殊处理方式。二进制文件必须作为一个整体来管理，而不是作为部分（行）。二进制文件往往更加稳定/不变。二进制文件往往需要与源代码控制版本控制不同的显式版本控制，通常同时有多个版本可用。二进制文件通常是从源代码生成的，因此只需要控制源代码（以及生成脚本）。请参阅 Maven 存储库了解二进制友好的存储设计（但请不要使用 Maven 本身，使用 Apache Ivy）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-07-09T22:02:48.853

锁定的论点真的很糟糕。他们基本上说：我们的工具太糟糕了，无法合并，所以我们锁定。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-09-01T15:18:02.070

根据我的经验，通常需要两个人同时处理同一个文件。（大概有些商店不会发生这种情况，但我有相当多的经验可以借鉴。）

在这些情况下，两个人都需要获取原始副本、完成他们的工作并合并他们的更改。在非锁定 VCS 中，这在很大程度上是自动且准确地完成的。

使用锁定 VCS，会发生一个人获得锁定。如果那个人先完成，那就太好了；如果没有，其他人在能够引入更改之前等待。例如，有时有必要在某人处于漫长的更改过程中时进行快速的错误修复。一旦第二个人获得了锁，第二个人需要合并更改，通常是手动的，然后签入新版本。有好几次，我看到第一人称的变化完全放弃了，因为第二人称不用手动合并。这种合并经常是仓促完成的，要么是出于对工作的厌恶，要么是因为时间紧迫。

因此，如果两个人需要同时处理同一个文件，非锁定 VCS 几乎总是更好。

如果这没有出现，并且两个人永远不需要同时处理同一个文件，那么您使用哪个并不重要。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-14T19:10:43.880

这是我的 0.02 美元。

锁定是文本代码的老派思想。一旦程序员使用了几次合并，他们就会学习并且通常喜欢它的强大功能。

锁的有效情况仍然存在。

*   图形改动。99% 的时间你不能合并 2 个人在同一个图形上工作。
*   二进制更新。
*   有时代码可能足够复杂/简单，足以证明一次只有 1 个人在处理它。在这种情况下，使用功能是项目管理的选择。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-14T20:38:27.107

在像游戏这样的开源项目中，将图像保持在版本控制之下是有意义的，并且能够锁定这些图像很不错（Subversion 支持这一点）。对于源文件，最好进入编辑合并工作流程。根据我的经验，这并不难并且可以提高生产力。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-09-01T14:02:39.003

有趣的问题。对我来说，问题不在于是否锁定，而是锁定*多长时间*。在这家店里，我是少数，因为我*喜欢*合并。我想知道其他人对代码做了什么。所以我要做的是：

*   始终在源代码树的本地副本中工作。

*   经常针对“官方”代码运行 Windiff，如有必要，将更改合并到我的本地副本。对于合并，我使用旧的 Emacs (Epsilon) 并将 compare-buffers 命令绑定到热键。另一个键说“使这一行的其余部分像另一个文件中的一样”，因为许多更改都很小。

*   当我准备好签入更改时，Windiff 会告诉我需要锁定、签入和解锁哪些文件。所以我将它们锁定的时间尽可能短，比如几分钟。

所以当 Fearless Leader 说“你检查过你的代码了吗？” 答案是“我没有签出任何东西”。

但正如我所说，我是少数派。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-09-01T15:38:34.253

在我看来，人们使用排他锁的主要原因是它的简单性，对他们来说，没有风险。

如果我对文件有独占访问权，我就不必尝试了解其他人对同一文件的更改。我不必冒险进行更改，然后在办理登机手续时不得不与其他人合并。

如果我对我正在更改的文件有一个排他锁，那么我知道当我签入时，我将能够签入一个一致的变更集；我这样做更简单。

合并（尤其是自动合并）的另一个方面是潜在的回归问题。如果没有良好的自动化测试，每次进行自动合并时，都可能会遇到问题。至少，如果您对某物有独占锁定，您可以确保有人在签入之前查看代码。对于某些人来说，这可以降低风险。

排他锁带走的是变化的潜在并行性。你不能让两个人处理一个文件。

开源模型（世界各地的很多人在不同的东西上进行合作）促进了锁定是不好的观点，但它确实对某些团队有用。它确实避免了真正的问题。我并不是说这些问题无法克服，但它需要人们改变行为；如果您想更改为非锁定模型，则必须说服他们更改为对他们来说似乎更难的工作方式，并且实际上（在他们看来）会增加风险导致回归。

就个人而言，我更喜欢不使用锁，但我可以理解为什么有些人不喜欢它。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-12-04T16:14:38.213

这个讨论有点晚了，但对于任何阅读并消化了 Steve Maguire 的**《Writing Solid Code》**的人来说，中心点是让你的工具检测和识别尽可能多的问题。

编译器在连续 12 小时或更长时间后不会感到疲倦，并且忘记发出语法错误。但是很容易忘记启动通信并稍后付款的手动步骤。

如果您需要对二进制文件进行版本控制，那么您需要某种形式的锁定来防止 - 或至少警告 - 意外覆盖。它必须是任何 VCS 甚至是分布式 VCS 的基本特征。要在 DVCS 中使用这样的功能可能需要创建一个中央存储库，但这有那么邪恶吗？如果您在任何类型的企业环境中使用 DVCS，您将拥有一个中央存储库以确保业务连续性。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-15T00:43:25.927

处理您的编辑评论。

甚至 RCS 和 SCCS（如今大多数在 Unix/Linux 上运行的 VCS 的祖父）也允许对文件进行并发编辑访问，我指的不是单独的分支。使用 SCCS，您可以执行 ' `get -k SCCS/s.filename.c`' 并获取文件的可编辑副本 -- 并且您可以使用选项 ('`-p`' IIRC) 将其输出到标准输出。你可以让其他人也这样做。然后，当需要签入时，您必须确保您从正确的版本开始，或者进行合并以处理自从收集了您的起始版本以来所做的更改等。而且这些检查都不是自动化的，并且冲突没有被自动处理或标记，等等。我没有声称这很容易。只是可以做到。（在这个方案下，锁只会被持有很短的时间，而签入/合并正在进行中。你仍然有锁 - SCCS 需要它们，并且 RCS 可以在需要严格锁定的情况下编译 - 但仅限于短期 - ish 持续时间。但这是一项艰苦的工作——没有人这样做，因为它是如此艰苦的工作。）

现代 VCS 自动或几乎自动处理大多数问题。那是他们相比祖系的强大实力。而且因为合并很容易而且几乎是自动的，它允许不同风格的开发。

我还是喜欢锁。我使用的主要工作系统是（IBM Rational）Atria ClearCase；对于我自己的开发，我使用 RCS（在 Y2K 左右放弃了 SCCS）。两者都使用锁定。但是 ClearCase 有很好的合并工具，我们做了很多，尤其是因为在我工作的产品上至少有 4 个代码行（即 4 个主要版本）。一个版本中的错误修复通常适用于其他版本，几乎一字不差。

因此，仅锁定 VCS 通常没有足够好的合并工具来鼓励使用文件的并发编辑。更现代的 VCS 具有更好的合并（以及分支）设施，因此对锁定时间的需求不会超过最短期限（足以使对文件或更高级系统中的文件的操作具有原子性） .

# .net - 是否有任何不需要安装 Oracle 客户端的 Oracle .NET 数据提供程序？

> ID：444243
> 
> 赞同：5
> 
> 时间：2009-01-14T19:02:27.127
> 
> 标签：.net, oracle, devart

我正在开发一个富客户端应用程序，它将使用实体框架（与 DevArt 的 DotConnect for Oracle）连接到中央 Oracle 数据库。但是，我发现这种情况需要每台客户端计算机都安装 Oracle 客户端才能连接到 Oracle 10g 服务器。有没有简单的方法解决这个问题？其他类型的 Oracle 提供程序（ODP.NET、EntLib Data、MS .NET Oracle 提供程序）是否具有相同的要求？

编辑：感谢 tuinstoel，我做了更多研究并确认 DevArt 的 dotConnect 可以在不需要安装 Oracle 客户端软件的直接模式下运行。这应该可以解决我使用实体框架连接到 Oracle 的问题。我还计划使用 DbConnection 连接到 Oracle，为此我还可以使用 DevArt 的 Oracle 提供程序。我现在的问题是我无法让 Direct 模式工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T19:29:08.760

是的，有第三方供应商......看 [这个](http://www.datadirect.com/products/net/net_for_oracle/index.ssp)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T19:30:12.483

odp.net 需要安装 Oracle 客户端。

我在 Devart 的网站上读到，当您使用 Dotconnect 到 Oracle 时，您不需要（总是）需要 Oracle 客户端：

> dotConnect for Oracle 提供两种到 Oracle 服务器的连接模式：通过 Oracle 调用接口连接和通过 TCP/IP 直接连接。使用 dotConnect for Oracle 编写的应用程序易于部署，不需要安装 Oracle 客户端软件，并且往往比使用其他数据连接解决方​​案的应用程序更快。

那么为什么要问这个问题呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-29T17:47:28.703

新的 Oracle 托管提供程序可在 nuget 上使用，并且不需要您安装完整的 Oracle 客户端。

[http://www.nuget.org/packages/odp.net.managed/](http://www.nuget.org/packages/odp.net.managed/)

# design-patterns - 我如何知道何时创建接口？

> ID：444245
> 
> 赞同：206
> 
> 时间：2009-01-14T19:03:23.833
> 
> 标签：design-patterns, oop, interface, class-design

我正处于开发学习阶段，我觉得我必须更多地了解接口。

我经常阅读它们，但似乎我无法掌握它们。

我读过这样的例子：Animal base class, with IAnimal interface for things like 'Walk', 'Run', 'GetLegs', etc - 但我从来没有做过什么，感觉就像“嘿，我应该使用一个接口这里！”

我错过了什么？为什么我很难掌握这个概念！我只是被这样一个事实吓倒了，我可能永远不会意识到对一个人的具体需求——主要是由于缺乏理解它们的一些方面！这让我觉得作为一名开发人员，我错过了一些顶级的东西！如果有人有过这样的经历并取得了突破，我会很感激一些关于如何理解这个概念的提示。谢谢你。

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2009-01-14T19:06:32.050

它解决了这个具体问题：

您有 4 种不同类型的 a、b、c、d。在你的代码中，你有类似的东西：

```
a.Process();
b.Process();
c.Process();
d.Process(); 
```

为什么不让他们实现 IProcessable，然后做

```
List<IProcessable> list;

foreach(IProcessable p in list)
    p.Process(); 
```

当您添加例如 50 种类型的类都做同样的事情时，这将更好地扩展。

* * *

另一个具体问题：

你看过 System.Linq.Enumerable 吗？它定义了大量的扩展方法，可以对任何实现 IEnumerable 的类型进行操作。因为任何实现 IEnumerable 的东西基本上都说“我支持以无序的 foreach 类型模式进行迭代”，所以您可以为任何可枚举类型定义复杂的行为（Count、Max、Where、Select 等）。

* * *

## 回答 #2

> 赞同：140
> 
> 时间：2009-01-14T19:13:45.637

我非常喜欢吉米的回答，但我觉得我需要添加一些东西。整个事情的关键是IProcessable中的“able **”**. 它表示实现接口的对象的能力（或属性，但意思是“内在品质”，而不是 C# 属性的意义）。IAnimal 可能不是一个很好的接口示例，但如果您的系统有很多可以行走的东西，IWalkable 可能是一个很好的接口。您可能有从 Animal 派生的类，例如 Dog、Cow、Fish、Snake。前两个可能会实现 IWalkable，后两个不会走路，所以他们不会。现在你问“为什么不创建另一个超类，WalkingAnimal，它派生自 Dog 和 Cow？”。答案是当你有完全在继承树之外也可以行走的东西时，比如机器人。Robot 将实现 IWalkable，但可能不会从 Animal 派生。如果你想要一个可以走路的东西的清单，

现在将 IWalkable 替换为更软件化的东西，例如 IPersistable，这个类比变得更接近于您在真实程序中看到的内容。

* * *

## 回答 #3

> 赞同：75
> 
> 时间：2009-01-14T19:10:25.350

当相同功能的实现不同时使用接口。

当您需要共享一个通用的具体实现时，请使用抽象/基类。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2009-01-14T19:05:12.987

想想像合同这样的接口。这是一种说法，“这些类应该遵循这些规则。”

所以在 IAnimal 示例中，这是一种说法，“我必须能够在实现 IAnimal 的类上调用 Run、Walk 等。”

为什么这很有用？您可能想要构建一个函数，该函数依赖于您必须能够在对象上调用 Run 和 Walk 的事实。你可以有以下内容：

```
public void RunThenWalk(Monkey m) {
    m.Run();
    m.Walk();
}

public void RunThenWalk(Dog d) {
    d.Run();
    d.Walk();
} 
```

...并对所有你知道可以跑和走的物体重复这个过程。但是，使用您的 IAnimal 接口，您可以定义一次函数，如下所示：

```
public void RunThenWalk(IAnimal a) {
    a.Run();
    a.Walk();
} 
```

通过针对接口进行编程，您实际上是在信任类来实现接口的意图。因此，在我们的示例中，想法是“我不在乎他们*如何*跑步和走路，只要他们跑步和走路。只要他们履行该协议，我的 RunThenWalk 就会有效。它运行良好，无需了解其他任何信息班上。”

[在这个相关问题](https://stackoverflow.com/questions/122883/interfaces-why-cant-i-seem-to-grasp-them)中也有很好的讨论。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2009-01-14T19:11:02.790

不要太担心。许多开发人员很少需要编写接口。您将经常使用[.NET](http://en.wikipedia.org/wiki/.NET_Framework)框架中可用的接口，但如果您不觉得有必要很快编写一个，那也就不足为奇了。

我总是给别人举的例子是，如果你有一个 Sailboat 类和一个 Viper 类。它们分别继承了 Boat 类和 Car 类。现在说您需要遍历所有这些对象并调用它们的`Drive()`方法。虽然您可以编写如下代码：

```
if(myObject is Boat)
    ((Boat)myObject).Drive()
else
    if (myObject is Car)
        ((Car)myObject).Drive() 
```

写起来会简单得多：

```
((IDrivable)myObject).Drive() 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2011-04-07T11:36:54.740

我喜欢军队的比喻。

中士不在乎你是*软件开发者*、*音乐家*还是*律师*。
你被当作*士兵*对待。

![微升](https://i.stack.imgur.com/I4Lki.png)

中士更容易不理会与他一起工作的人的具体细节，将**每个**
人都视为士兵的抽象（......并在他们没有表现得像他们时惩罚他们）。

人像士兵一样行动的能力称为多态性。

接口是有助于实现多态性的软件结构。

**需要**抽象细节以实现简单性是您问题的答案。

> [多态性](http://www.artima.com/objectsandjava/webuscript/PolymorphismInterfaces1.html)，在词源上意味着“多种形式”，是一种将基类的任何子类的对象视为基类的对象的能力。因此，基类有多种形式：基类本身及其任何子类。
> 
> (..) 这使您的代码更易于编写，也更易于他人理解。它还使您的代码可扩展，因为稍后可以将其他子类添加到类型族中，并且这些新子类的对象也可以与现有代码一起使用。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2009-01-14T19:10:33.663

Jimmy 说得对，当您希望能够将单个变量用于多种类型时，但所有这些类型都通过接口声明实现相同的方法。然后你可以在接口类型变量上调用它们的 main 方法。

然而，使用接口还有第二个原因。当项目架构师与实现编码员是不同的人时，或者有多个实现编码员和一个项目经理。负责人可以写一大堆接口，看看系统互通，然后留给开发人员用实现类来填充接口。这是确保多人编写兼容类的最佳方式，并且他们可以并行执行。

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2009-01-14T19:09:52.510

根据我的经验，直到我开始使用模拟框架进行单元测试时，才会出现创建接口的驱动力。很明显，使用接口将使模拟变得更加容易（因为框架依赖于虚拟方法）。一旦我开始，我就看到了从实现中抽象出我的类的接口的价值。即使我没有创建实际的接口，我现在也尝试使我的方法虚拟化（提供一个可以被覆盖的隐式接口）。

我发现还有很多其他原因可以强化重构接口的良好实践，但是单元测试/模拟是提供实践经验的最初“啊哈时刻”的原因。

**编辑**：为了澄清，通过单元测试和模拟，我总是有两个实现——真实的、具体的实现和用于测试的替代模拟实现。一旦你有了两个实现，接口的价值就变得显而易见了——从接口的角度来处理它，这样你就可以随时替换实现。在这种情况下，我将其替换为模拟接口。我知道如果我的类构造正确，我可以在没有实际接口的情况下做到这一点，但是使用实际接口可以加强这一点并使其更清晰（对读者来说更清楚）。如果没有这种推动力，我认为我不会欣赏接口的价值，因为我的大多数类只有一个具体的实现。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2009-01-14T20:07:22.580

一些非编程示例可能会帮助您了解编程中接口的适当用途。

电气设备和电网之间有一个接口——它是关于插头和插座的形状以及它们之间的电压/电流的一**组约定。**如果你想实现一个新的电气设备，只要你的插头遵守规则，它就能从网络中获得服务。这使得**可扩展性**非常容易，并消除或**降低了协调成本**：您不必通知电力供应商您的新设备如何工作，也不必就如何将新设备插入网络达成单独的协议。

各国有标准的轨距。这允许放下铁轨的工程公司和建造在这些铁轨上运行的火车的工程公司之间**进行分工**，并且使铁路公司可以在不重新构建整个系统的情况下**更换和升级火车。**

**企业向客户提供的服务**可以描述为一个接口：定义良好的接口**强调服务，隐藏手段**。当您将一封信放入邮箱时，您希望邮政系统在给定的时间内送达信件，但您对信件的送达方式没有任何期望：**您不需要知道**，邮政服务可以**灵活地选择**最符合要求和当前情况的交付方式。一个例外是客户选择航空邮件的能力——这不是现代计算机程序员会设计的那种界面，因为它揭示了太多的实现。

来自大自然的例子：我不太喜欢eats()、makesSound()、moves()等例子。它们确实描述了行为，这是正确的，但它们没有**描述交互以及它们是如何启用的**。在自然界中实现交互的接口的明显示例与繁殖有关，例如，一朵花为蜜蜂提供了一个特定的接口，以便可以进行授粉。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-01-14T19:12:11.570

作为 .net 开发人员，完全有可能终其一生，从不编写自己的接口。毕竟，我们在没有它们的情况下存活了几十年，而且我们的语言仍然是图灵完备的。

我不能告诉你为什么需要接口，但我可以给你一个我们在当前项目中使用它们的列表：

1.  在我们的插件模型中，我们通过接口加载插件并将该接口提供给插件编写者以符合。

2.  在我们的机器间消息传递系统中，消息类都实现了一个特定的接口，并使用该接口“解包”。

3.  我们的配置管理系统定义了一个用于设置和检索配置设置的接口。

4.  我们有一个接口可以用来避免讨厌的循环引用问题。（如果不需要，请不要这样做。）

我想如果有一个规则，那就是当你想在一个 is-a 关系中对几个类进行分组时使用接口，但你不想在基类中提供任何实现。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2017-05-26T07:49:18.993

假设您想要模拟当您尝试入睡时可能发生的烦恼。

## 接口前的模型

[![在此处输入图像描述](https://i.stack.imgur.com/lntrE.jpg)](https://i.stack.imgur.com/lntrE.jpg)

```
class Mosquito {
    void flyAroundYourHead(){}
}

class Neighbour{
    void startScreaming(){}
}

class LampJustOutsideYourWindow(){
    void shineJustThroughYourWindow() {}
} 
```

正如您清楚地看到的那样，当您尝试入睡时，许多“事情”可能会很烦人。

## 使用没有接口的类

但是在使用这些类时，我们遇到了问题。他们没有任何共同之处。您必须分别调用每个方法。

```
class TestAnnoyingThings{
    void testAnnoyingThinks(Mosquito mosquito, Neighbour neighbour, LampJustOutsideYourWindow lamp){
         if(mosquito != null){
             mosquito.flyAroundYourHead();
         }
         if(neighbour!= null){
             neighbour.startScreaming();
         }
         if(lamp!= null){
             lamp.shineJustThroughYourWindow();
         }
    }
} 
```

* * *

## 带接口的模型

为了克服这个问题，我们可以引入一个 iterface[![在此处输入图像描述](https://i.stack.imgur.com/Wf9pY.jpg)](https://i.stack.imgur.com/Wf9pY.jpg)

```
interface Annoying{
   public void annoy();

} 
```

并在类中实现它

```
class Mosquito implements Annoying {
    void flyAroundYourHead(){}

    void annoy(){
        flyAroundYourHead();
    }
}

class Neighbour implements Annoying{
    void startScreaming(){}

    void annoy(){
        startScreaming();
    }
}

class LampJustOutsideYourWindow implements Annoying{
    void shineJustThroughYourWindow() {}

    void annoy(){
        shineJustThroughYourWindow();
    }
} 
```

## 使用接口

这将使这些类的使用更加容易

```
class TestAnnoyingThings{
    void testAnnoyingThinks(Annoying annoying){
        annoying.annoy();
    }
} 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-03-20T18:49:35.020

[一个代码示例（Andrew's 与我在what-is-the-purpose-of-interfaces 中](https://stackoverflow.com/questions/667139/what-is-the-purpose-of-interfaces/667216)的一个额外的组合），这也说明了为什么在不支持多重继承的语言上使用接口而不是抽象类（c# 和爪哇）：

```
interface ILogger
{
    void Log();
}
class FileLogger : ILogger
{
    public void Log() { }
}
class DataBaseLogger : ILogger
{
    public void Log() { }
}
public class MySpecialLogger : SpecialLoggerBase, ILogger
{
    public void Log() { }
} 
```

请注意，FileLogger 和 DataBaseLogger 不需要接口（可以是 Logger 抽象基类）。但考虑到您需要使用强制您使用基类的第三方记录器（假设它公开了您需要使用的受保护方法）。由于该语言不支持多重继承，您将无法使用抽象基类方法。

底线是：尽可能使用接口以获得额外的代码灵活性。您的实现没有那么紧密，因此它可以更好地适应变化。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-01-14T19:13:07.463

一旦需要强制类的行为，就应该定义一个接口。

动物的行为可能涉及步行、进食、跑步等。因此，您将它们定义为接口。

另一个实际示例是 ActionListener（或 Runnable）接口。当您需要跟踪特定事件时，您将实施它们。`actionPerformed(Event e)`因此，您需要在您的类（或子类）中提供该方法的实现。同样，对于 Runnable 接口，您提供`public void run()`方法的实现。

此外，您可以让这些接口由任意数量的类实现。

使用接口（在 Java 中）的另一个实例是实现 C++ 中提供的多重继承。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-01-14T19:52:09.960

我不时使用接口，这是我的最新用法（名称已被概括）：

我在 WinForm 上有一堆自定义控件，需要将数据保存到我的业务对象。一种方法是分别调用每个控件：

```
myBusinessObject.Save(controlA.Data);
myBusinessObject.Save(controlB.Data);
myBusinessObject.Save(controlC.Data); 
```

这个实现的问题是，每当我添加一个控件时，我都必须进入我的“保存数据”方法并添加新控件。

我更改了我的控件以实现一个具有方法 SaveToBusinessObject(...) 的 ISaveable 接口，所以现在我的“保存数据”方法只是遍历控件，如果它找到一个 ISaveable，它调用 SaveToBusinessObject。因此，现在当需要一个新控件时，只需在该对象中实现 ISaveable（并且永远不要接触另一个类）。

```
foreach(Control c in Controls)
{
  ISaveable s = c as ISaveable;

  if( s != null )
      s.SaveToBusinessObject(myBusinessObject);
} 
```

接口通常未实现的好处是您可以本地化修改。一旦定义，您将很少更改应用程序的整体流程，但您通常会在细节级别进行更改。当您将详细信息保留在特定对象中时，ProcessA 中的更改不会影响 ProcessB 中的更改。（基类也给你这个好处。）

编辑：另一个好处是行动的特异性。就像在我的示例中一样，我要做的就是保存数据；我不在乎它是什么类型的控件，或者它是否可以做任何其他事情——我只想知道我是否可以将数据保存在控件中。它使我的保存代码非常清晰——没有检查它是否是文本、数字、布尔值或其他任何内容，因为自定义控件处理所有这些。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-01-14T19:13:42.377

最简单的例子是支付处理器（Paypal、PDS 等）。

假设您创建了一个具有 ProcessACH 和 ProcessCreditCard 方法的接口 IPaymentProcessor。

您现在可以实现一个具体的 Paypal 实现。使这些方法调用 PayPal 特定功能。

如果您稍后决定需要切换到另一个提供商，您可以。只需为新提供者创建另一个具体实现。由于您所绑定的只是您的接口（合同），因此您可以在不更改使用它的代码的情况下更换您的应用程序使用的接口。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-01-14T22:31:06.410

如果您浏览 .NET Framework 程序集并深入了解任何标准对象的基类，您会注意到许多接口（名为 ISomeName 的成员）。

接口基本上用于实现框架，无论大小。在我想编写自己的框架之前，我对接口也有同样的感觉。我还发现理解接口帮助我更快地学习框架。当您想为几乎任何事情编写更优雅的解决方案时，您会发现界面非常有意义。这就像一种让班级为工作穿上合适衣服的方法。更重要的是，接口允许系统变得更加自文档化，因为当类实现接口时，复杂对象变得不那么复杂，这有助于对其功能进行分类。

当类希望能够显式或隐式地参与框架时，它们会实现接口。例如，IDisposable 是一个通用接口，它为流行且有用的 Dispose() 方法提供方法签名。在框架中，您或其他开发人员需要了解的关于类的所有信息是，如果它实现了 IDisposable，那么您就知道 ((IDisposable)myObject).Dispose() 可用于调用以进行清理。

经典示例：如果不实现 IDisposable 接口，就不能在 C# 中使用“using()”关键字构造，因为它要求任何指定为参数的对象都可以隐式转换为 IDisposable。

复杂示例：更复杂的示例是 System.ComponentModel.Component 类。此类实现 IDisposable 和 IComponent。大多数（如果不是全部）具有与其关联的可视化设计器的 .NET 对象都实现了 IComponent，以便 IDE 能够与组件进行交互。

结论：随着您对 .NET Framework 越来越熟悉，当您在对象浏览器或 .NET Reflector（免费）工具 ( [http://www.red-gate.com ) 中遇到新类时，首先要做的就是/products/reflector/](http://www.red-gate.com/products/reflector/) ) 是检查它继承自哪个类以及它实现的接口。.NET Reflector 甚至比对象浏览器更好，因为它还可以让您查看派生类。这使您可以了解派生自特定类的所有对象，从而可能了解您不知道存在的框架功能。当更新或新的命名空间添加到 .NET Framework 时，这一点尤其重要。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-01-14T22:36:42.063

它还允许您执行模拟单元测试 (.Net)。如果您的类使用接口，您可以在单元测试中模拟对象并轻松测试逻辑（无需实际访问数据库或 Web 服务等）。

[http://www.nmock.org/](http://www.nmock.org/)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2013-07-15T17:53:05.900

假设您正在制作第一人称射击游戏。玩家有多种枪可供选择。

我们可以有一个`Gun`定义函数的接口`shoot()`。

我们需要类的不同子`Gun`类`ShotGun` `Sniper`，等等。

```
ShotGun implements Gun{
    public void shoot(){
       \\shotgun implementation of shoot.
    } 
}

Sniper implements Gun{
    public void shoot(){
       \\sniper implementation of shoot.
    } 
} 
```

## 射手班

射手的盔甲里有所有的枪。让我们创建一个`List`来表示它。

```
List<Gun> listOfGuns = new ArrayList<Gun>(); 
```

射手在需要时使用该功能循环使用他的枪`switchGun()`

```
public void switchGun(){
    //code to cycle through the guns from the list of guns.
    currentGun = //the next gun in the list.
} 
```

我们可以使用上面的函数设置当前的 Gun ，并在调用 `shoot()`时简单地调用函数`fire()`。

```
public void fire(){
    currentGun.shoot();
} 
```

拍摄功能的行为会根据`Gun`接口的不同实现而有所不同。

## 结论

当一个类函数依赖于*另一个类的函数*时，创建一个接口，该函数会根据实现的类的实例（对象）改变其行为。

例如`fire()`，类中的函数`Shooter`需要 guns( `Sniper`, `ShotGun`) 来实现该`shoot()`函数。所以如果我们换枪开火。

```
shooter.switchGun();
shooter.fire(); 
```

我们改变了`fire()`函数的行为。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-01-14T19:07:28.520

扩展拉塞纳尔所说的内容。接口是所有实现类必须遵循的契约。因此，您可以对合约使用一种称为编程的技术。这使您的软件变得独立于实现。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-01-14T20:02:10.953

当您想要定义对象可以展示的行为时，通常会使用接口。

.NET 世界中的一个很好的例子是[IDisposable](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)接口，它用于任何使用必须手动释放的系统资源的 Microsoft 类。它要求实现它的类具有 Dispose() 方法。

（Dispose() 方法也由[VB.NET](http://msdn.microsoft.com/en-us/library/htd05whh.aspx)和[C#](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)的 using 语言构造调用，仅适用于`IDisposable`s）

请记住，您可以通过使用`TypeOf ... Is`(VB.NET)、`is`(C#)、`instanceof`(Java) 等结构来检查对象是否实现了特定接口...

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-01-14T20:03:05.057

正如一些人可能已经回答的那样，接口可用于在类之间强制执行某些行为，这些行为不会以相同的方式实现这些行为。因此，通过实现一个接口，您是在说您的类具有该接口的行为。IAnimal 接口不会是典型的接口，因为 Dog、Cat、Bird 等类是动物的类型，并且应该可能扩展它，这是继承的一种情况。相反，在这种情况下，接口更像是动物行为，例如 IRunnable、IFlyable、ITrainable 等。

接口有很多好处，关键之一是可插拔性。例如，声明一个具有 List 参数的方法将允许传入实现 List 接口的任何内容，从而允许开发人员在以后删除和插入不同的列表，而无需重写大量代码。

您可能永远不会使用接口，但如果您从头开始设计一个项目，尤其是某种框架，您可能希望熟悉它们。

我建议阅读Coad、Mayfield 和 Kern的[Java 设计中的接口一章。](https://rads.stackoverflow.com/amzn/click/com/0139111816)他们比一般的介绍性文字解释得更好。如果你不使用 Java，你可以阅读本章的开头，主要是概念。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-01-14T20:30:42.877

与任何增加系统灵活性的编程技术一样，接口也增加了一定程度的复杂性。它们通常很棒，你可以在任何地方使用它（你可以为你的所有类创建一个接口）——但是这样做，你会创建一个更复杂的系统，并且更难维护。

像往常一样，这里有一个权衡：灵活性优于可维护性。哪个更重要？没有答案 - 这取决于项目。但请记住，每个软件都必须维护......

所以我的建议：在你真正需要它们之前不要使用接口。（使用 Visual Studio，您可以在 2 秒内从现有类中提取接口 - 所以不要着急。）

话虽如此，你什么时候需要创建一个界面？

当我重构一个*突然*需要处理两个或更多类似类的方法时，我会这样做。然后我创建一个接口，将此接口分配给两个（或更多）相似的类，并更改方法参数类型（将类类型替换为接口类型）。

它有效:o)

一个例外：当我模拟对象时，界面更容易使用。所以我经常为此创建界面。

PS：当我写“接口”时，我的意思是：“任何基类的接口”，包括纯接口类。请注意，抽象类通常比纯接口更好，因为您可以向它们添加逻辑。

问候，西尔万。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-06-24T11:37:04.233

使用接口有很多用途。

1.  在多态行为中使用。您想在其中调用具有对子类的引用的接口的子类的特定方法。

2.  与类签订合同以实现所有必要的方法，就像最常见的使用 COM 对象一样，在继承接口的 DLL 上生成包装类；这些方法在幕后调用，您只需要实现它们，但具有与 COM DLL 中定义的相同结构，您只能通过它们公开的接口知道。

3.  通过在类中加载特定方法来减少内存使用。就像如果您有三个业务对象并且它们在一个类中实现，那么您可以使用三个接口。

例如 IUser、IOrder、IOrderItem

```
public interface IUser()
{

void AddUser(string name ,string fname);

}

// Same for IOrder and IOrderItem
//

public class  BusinessLayer: IUser, IOrder, IOrderItem

{    
    public void AddUser(string name ,string fname)
    {
        // Do stuffs here.
    }

    // All methods from all interfaces must be implemented.

} 
```

如果您只想添加一个用户，请执行以下操作：

```
IUser user = new (IUser)BusinessLayer();

// It will load  all methods into memory which are declared in the IUser interface.

user.AddUser(); 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2012-11-28T20:41:02.800

当您成为*库开发人员*（为其他编码人员编写代码的人）时，接口将变得明显。我们大多数人都是从*应用程序开发人员*开始的，我们使用现有的 API 和编程库。

[就像接口是一种契约](https://stackoverflow.com/a/444253/1168342)一样，没有人提到接口是使代码的某些部分**稳定**的好方法。当它是一个*团队*项目时（或者当您正在开发其他开发人员使用的代码时），这尤其有用。所以，这里有一个具体的场景：

> 当您在*团队*中开发代码时，其他人可能会使用您编写的代码。当他们对您的（稳定的）接口进行编码时，他们会非常高兴，而当您可以自由地更改您的实现（隐藏在接口后面）而不破坏团队的代码时，您会很高兴。它是*信息隐藏*的一种变体（接口是公开的，实现对客户端程序员隐藏）。阅读有关[受保护变体](http://www.martinfowler.com/ieeeSoftware/protectedVariation.pdf)的更多信息。

另请参阅[有关对 Interface 进行编码的相关问题](https://stackoverflow.com/questions/383947/what-does-it-mean-to-program-to-an-interface)。

# c# - 如何防止用户生成的 Sql 查询上的 Sql 注入

> ID：444248
> 
> 赞同：5
> 
> 时间：2009-01-14T19:04:37.873
> 
> 标签：c#, asp.net, sql, regex, sql-injection

我有一个项目（私人，ASP.net 网站，密码保护 https），其中一个要求是用户能够输入将直接查询数据库的 Sql 查询。我需要能够允许这些查询，同时防止它们对数据库本身造成损害，以及访问或更新他们不应该能够访问/更新的数据。

我提出了以下实施规则：

1.  使用**只有**Select Table/View 和 Update Table 权限的 db 用户（因此任何其他命令，如 drop/alter/truncate/insert/delete 都不会运行）。
2.  验证语句是否以“Select”或“Update”开头
3.  验证（使用正则表达式）语句中没有没有被单引号、空格和字母包围的分号实例。（这里的想法是，他们可以包含第二个查询的唯一方法是用不属于输入字符串的分号结束第一个查询）。
4.  验证（使用正则表达式）用户有权访问正在查询/更新的表，包括在连接中等。这包括任何子查询。（实现这一点的部分方法是用户将使用一组实际上并不存在于数据库中的表名，部分查询解析将在正确的对应表名中替换为查询） .

我错过了什么吗？

目标是用户能够以他们认为合适的任何方式查询/更新他们有权访问的表，并防止任何意外或恶意尝试损坏数据库。（并且由于要求是用户生成 sql，因此我无法使用我知道的任何内置工具对查询进行参数化或清理）。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-14T19:20:31.677

这是一个坏主意，不仅仅是从注射预防的角度来看。对于一个不知道更好的用户来说，意外运行一个会占用所有数据库资源（内存/cpu）的查询真的很容易，从而有效地导致拒绝服务攻击。

如果您*必须*允许这样做，最好为这些查询保留一个完全独立的服务器，并使用复制使其非常接近生产系统的精确镜像。当然，这不适用于您的 UPDATE 要求。

但我想再说一遍：这行不通。如果用户可以运行即席查询，您将无法保护您的数据库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T19:09:53.477

这个东西怎么样，想象一下 select 是一个 EXEC

```
select convert(varchar(50),0x64726F70207461626C652061) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-14T19:34:47.140

我的直觉反应是，您应该专注于尽可能严格地设置帐户权限和授权。彻底查看您的 RDBMS 安全文档，可能有一些您不熟悉的特性会证明是有用的（例如，我相信 Oracle 的虚拟专用数据库可能在这种情况下有用）。

特别是，您的想法是“验证（使用正则表达式）用户有权访问正在查询/更新的表，包括在联接中，等等。” 听起来您会尝试重新实现已内置于数据库中的安全功能。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-14T19:37:09.833

您缺少的是攻击者在您的应用程序中发现漏洞的独创性。

我几乎可以向你保证，如果你允许的话，你将无法关闭所有的洞。数据库引擎中甚至可能存在您不知道的错误，但它们确实允许您认为安全的 SQL 语句在您的系统中造成严重破坏。

简而言之：**这是一个非常糟糕的主意！**

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-14T20:11:52.650

好吧，你已经有足够多的人告诉你**“不要这样做”**，所以如果他们无法劝阻你，这里有一些想法：

**包括好的，不要试图排除坏的**
（我认为正确的术语是**Whitelisting** vs **Blacklisting**）也就是说，我的意思*是不要寻找邪恶或无效的东西来扔掉*（它可以写的方式太多了或伪装），而是寻找*有效的东西来包含*并扔掉其他所有东西。

您已经在另一条评论中提到您正在寻找用户友好的表名列表，并替换实际的模式表名。这就是我要说的——如果您要这样做，那么也可以使用字段名称。

不过，我仍然倾向于某种图形用户界面：选择要在此处查看的表，选择要在此处查看的字段，使用一些下拉菜单来构建 where 子句等。虽然很痛苦，但可能仍然更容易。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-14T19:57:32.773

正如其他人所指出的，让最终用户这样做并不是一个好主意。我怀疑这个需求并不是用户真的需要 ad-hoc SQL，而是一种以最初没有预见到的方式获取和更新数据的方法。要允许查询，请按照 Joel 的建议进行操作并保留“只读”数据库，但使用 Microsoft Reporting Services 或 Data Dynamics Active 报告等报告应用程序来允许用户设计和运行临时报告。我相信两者都有办法向用户展示“他们的”数据的过滤视图。

对于更新，它更棘手 - 我不知道现有的工具可以做到这一点。一种选择可能是设计您的应用程序，以便开发人员可以快速编写插件来公开用于更新数据的新表单。该插件需要公开一个 UI 表单、用于检查当前用户是否可以执行它的代码以及用于执行它的代码。您的应用程序将加载所有插件并公开用户有权访问的表单。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-15T05:01:38.603

事件看似安全的技术，如[动态 LINQ，对代码注入问题并不安全](https://stackoverflow.com/questions/438704/dynamic-linq-with-direct-user-input-any-dangers)，您正在谈论提供低级访问。

无论您多么努力地清理查询和调整权限，仍然可能通过发送一些 CPU 密集型查询来冻结您的数据库。

因此，“保护选项”之一是显示一个消息框，告诉**所有访问受限对象或导致不良副作用的查询都将记录在用户帐户中并立即报告给管理员**。

另一种选择 - 只是尝试寻找更好的选择（即，如果您真的需要处理和更新数据，为什么不公开 API 以安全地执行此操作？）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-14T19:11:33.507

一个（可能是矫枉过正）选项可以使用编译器来简化 SQL 语言。像使用 JavaCC 和修改后的 SQL 语法，只允许 SELECT 语句，然后你可能会收到查询，编译它，如果它编译，你可以运行它。

对于 C#，我知道[Irony](http://www.codeplex.com/irony)，但从未使用过它。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-14T19:30:57.007

使用更新语句可以造成巨大的损失。

我有一个类似的项目，我们的解决方案是引导用户完成一个非常烦人的向导，让他们做出选择，但查询本身是由应用程序代码在幕后构建的。创建起来非常费力，但至少我们控制了最终执行的代码。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-14T19:42:31.710

问题是，你信任你的用户吗？如果您的用户必须登录系统，而您使用的是 HTTPS 并采取了预防 XSS 攻击的措施，那么 SQL 注入是一个较小的问题。如果您信任合法用户，则在受限帐户下运行查询就足够了。多年来，我一直在网络上运行 MyLittleAdmin，但还没有遇到任何问题。

如果您在受适当限制的 SQL 帐户下运行，则 select convert(varchar(50),0x64726F70207461626C652061) 不会走得太远，您可以通过在数据库请求上设置短超时来防御资源占用查询。人们仍然可以进行不正确的更新，但是这又回到了您是否信任您的用户？

将任何数据库附加到 Web 时，您总是要承担受管理的风险，但这就是备份的用途。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-14T19:15:57.663

如果他们不必执行真正高级的查询，您可以提供一个只允许某些选择的 ui，例如带有“更新、删除、选择”的下拉列表，然后下一个 ddl 将自动填充可用表的列表等。 . 类似于 sql management studio 中的查询生成器。

然后在您的服务器端代码中，您会将这些 ui 元素组转换为 sql 语句并使用参数化查询来阻止恶意内容

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-14T19:33:27.487

这是一个非常糟糕的做法。我会创建一些存储过程来处理您想做的所有事情，甚至是更高级的查询。将它们呈现给用户，让他们选择他们想要的，然后传递你的参数。

我上面的答案也非常好。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-14T19:50:01.587

尽管我同意 Joel Coehoorn 和 SQLMenace 的观点，但我们中的一些人确实有“要求”。与其让他们发送即席查询，不如创建一个可视化查询构建器，就像在 asp.net 上的 MS 示例应用程序中找到的那样，或者试试这个[链接](http://www.codeproject.com/KB/database/SQLStatementGenerator.aspx)。

我不反对乔尔提出的观点。他是对的。让用户（记住我们在这里谈论的是用户，他们可能不太关心你想要强制执行什么）抛出查询就像一个没有“业务逻辑层”的应用程序，更不用说当某些结果不匹配时要回答的其他问题其他配套申请结果。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-14T20:43:42.273

这是另一个例子

黑客不需要知道真实的表名，他/她可以像这样运行未记录的过程

```
sp_msforeachtable 'print ''?''' 
```

只是代替打印，它将被丢弃

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-01-15T17:31:25.137

很多答案说这是一个坏主意，但有时这就是要求所坚持的。不过，在“如果你仍然必须这样做”的建议中，我没有发现一个问题：确保任何更新语句都包含 WHERE 子句。跑起来太容易了

```
UPDATE ImportantTable
SET VitalColumn = NULL 
```

错过了重要的

```
WHERE UserID = @USER_NAME 
```

如果整个表都需要更新，那么添加很容易

```
WHERE 1 = 1 
```

要求 where 子句不会阻止恶意用户做坏事，但它应该减少意外的整个表更改。

# sql - 如何将列表存储在 db 列中

> ID：444251
> 
> 赞同：66
> 
> 时间：2009-01-14T19:04:50.117
> 
> 标签：sql, database

我想将对象**FOO**存储在数据库中。假设 FOO 包含三个整数和一个“*水果*”列表。

该列表可以有任何长度，我唯一知道的是所有允许的水果都存储在另一个表中。

我可以将水果列表存储在一个列中吗？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-01-14T19:09:03.743

在规范化的关系数据库中，这种情况是不可接受的。您应该有一个联结表，为 FOO 对象的每个不同 ID 和 Fruit 的 ID 存储一行。这样一行的存在意味着水果在 FOO 的列表中。

```
CREATE TABLE FOO ( 
  id int primary key not null,
  int1 int, 
  int2 int, 
  int3 int
)

CREATE TABLE Fruits (
  id int primary key not null,
  name varchar(30)
)

CREATE TABLE FOOFruits (
  FruitID int references Fruits (ID),
  FooID int references FOO(id),
  constraint pk_FooFruits primary key (FruitID, FooID)
) 
```

要将 Apple 水果添加到 ID=5 的特定 FOO 对象列表中，您可以：

```
INSERT FOOFruits(FooID, FruitID)
SELECT 5, ID FROM Fruits WHERE name = 'Apple' 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-14T19:35:32.427

如果您非常确定自己在做什么（例如，您不需要查找列表的值），您还可以序列化您的对象，或者只是列表对象，并将其存储在二进制文件中柱子。

只是字符分隔值也可能很好，并且在保存和加载方面更便宜，但请注意您的数据不包含分隔符或转义它（并在加载时相应地处理转义等......你的不过，选择的语言在这方面可能比你做得更好。;) )

但是，对于“正确”的解决方案，请执行上述 Mehrdad 描述的操作。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-14T19:11:18.077

它在技术上是可行的，但设计非常糟糕，imo。

您可以通过构建字符串并将其存储在 nvarchar(max) 字段中来实现（如果使用 sql server 或其等效项）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T19:11:17.860

可以，但它可能会被视为文本，从而使在此列中的搜索变得困难且缓慢。您最好使用相关表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T19:10:56.190

一些数据库允许将多个值存储在单行的单列中，但使用单独的表通常更方便。

创建一个包含两列的表，一列包含指向对象表的主键的指针，另一列包含指向水果表的主键的指针。然后，如果一个对象有三个水果，那么 object_fruit 表中有三行都指向同一个对象，但指向三个不同的水果。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-14T19:36:54.810

```
INSERT FOOFruits (FooID, FruitID)
SELECT 5, ID 
FROM   Fruits 
WHERE  name IN ('Apple', 'Orange'); 
```

# gcc - 将 Binutils 从 2.16.1 升级到 2.19 有优势吗？为什么？

> ID：444260
> 
> 赞同：4
> 
> 时间：2009-01-14T19:06:33.233
> 
> 标签：gcc, cross-compiling, binutils, pspsdk

在 PSPSDK (Homebrew) 中，我们使用 Binutils 2.16.1 来组装和链接 PlayStation Portable 的代码，但是该版本已经过时了（3 个版本已取代它）。社区和我一直在将 GCC 和 newlib 更新到最新的稳定版本，一切似乎都可以使用旧的 binutils。

GCC 会用 binutils 2.19 生成更好的代码吗？为什么？binutils 2.19 会产生比 2.16.1 更好的 elf 文件和库吗？为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-05T16:47:48.950

`binutils`2.19 有一个新的 ELF 链接器[`gold`](http://sourceware.org/ml/binutils/2008-03/msg00162.html)，它是多线程的，用现代 C++ 编写，比通常的`ld`链接器快很多。但是，我不确定适应它所涉及的工作。

除此之外，新版本总是一个好主意。当然，很可能已经包含了性能和错误修复。我想我一定会尝试的，如果出现问题，您仍然可以后退。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-05T16:33:02.340

一般来说，你不需要升级 binutils，除非你遇到了一些在更高版本的 binutils 中修复的 bug，或者需要新的特性（例如链接器 build-ids）。

特别是，GCC 代码生成在很大程度上独立于 binutils（除了 像这样的结构`__thread`，它需要 binutils 提供一定程度的支持）。

# asp.net - 如何使用jquery计算gridview所有页面上的选中复选框？

> ID：444265
> 
> 赞同：1
> 
> 时间：2009-01-14T19:08:30.220
> 
> 标签：asp.net, jquery, gridview, checkbox

我想立即更新一个状态行，指示在 asp.net gridview 的所有页面上选中的复选框的数量。现在我只能计算在当前 gridview 页面上选中的复选框的数量。

这是我的代码：

```
$(document).ready(initAll);

function initAll(){
   countChecked();
    $(".activeBoxes").click(countChecked);
}

function countChecked() {

      var n = $(".activeBoxes input:checked").length;
      $("#checkboxStatus").text(n + (n == 1 ? " vehicle is" : " vehicles are") + " selected on this page.  ");
      if( n == 0){
           $(".activateButton").hide();
           $("#checkboxStatus").hide();

      }else{
        $("#checkboxStatus").show();
        $(".activateButton").show();
      }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T19:16:23.230

您可以在页面更改时跟踪视图状态（或类似内容）中的总选择。我做了类似的事情来跟踪数组中选定的行 ID。就我而言，当它们返回页面时，我必须重新检查这些项目。此外，如果您允许排序，则选择可能会跨页面移动。

编辑：对不起，这实际上不是你的 Jquery 问题，但也许它会有所帮助......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T19:38:40.860

我正在使用视图状态来跟踪所有页面中的所有检查项目，并在返回页面时重新检查它们。

我将不得不将我的视图状态值添加到页面总数中，并以某种方式减去重叠的总数。由于我的 jquery 不包含 id，这将是棘手的。

```
protected ArrayList savedIds;
 if (ViewState["SavedIds"] == null) savedIds = new ArrayList();
        else savedIds = (ArrayList)ViewState["SavedIds"];

List<int> activateList = new List<int>();

        foreach (GridViewRow tt in GridView2.Rows)
        {
            CheckBox cb = (CheckBox)tt.FindControl("ActivateItem");
            HiddenField id = (HiddenField)tt.FindControl("IdField");
            if (cb.Checked)
            {
                int tempId = 0;
                string tempId2 = id.Value.ToString();
                int.TryParse(tempId2, out tempId);
                activateList.Add(tempId);
            }

        }
        foreach (int activateId in activateList)
        {
            if (!savedIds.Contains(activateId.ToString())) savedIds.Add(activateId.ToString());
        }
        ViewState["SavedIds"] = savedIds; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T20:56:41.140

您缺少的是删除 ID。当检查行并且未检查 tempid 时，请确保它不在 saveids 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T22:34:44.483

你知道谷歌是你的朋友吗？

[使用 JQuery 在 GridView 中选择复选框](http://gridviewguy.com/Articles/404_Selecting_CheckBoxes_Inside_GridView_Using_JQuery_Library.aspx)

[WML 视频](http://gridviewguy.com/Videos/397_Selecting_CheckBoxes_Inside_GridView_Control.aspx)

如果没有 JQuery，但对于更完美主义的行为（如下图），[试试这个链接](http://gridviewguy.com/Articles/228_GridView_CheckBox_Selection_With_a_Twist.aspx)

[替代文字 http://www.gridviewguy.com/ArticleImages/GridViewCheckBoxTwistAni.gif](http://www.gridviewguy.com/ArticleImages/GridViewCheckBoxTwistAni.gif)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T23:54:40.250

在您的页面上保留一个隐藏的文本字段，每次选中一个框时，调用一个 javascript 方法，该方法会将复选框的“id”写入隐藏字段。每次回发页面时，将隐藏字段的值序列化到所需对象结构中的会话（可以是对象、哈希表、数组等）。

在呈现页面时，每个复选框都可以检查会话对象结构（您之前创建的）并确定复选框的状态是否最后被选中。

您可以使用 JQuery 循环浏览页面上的所有复选框，如果选中该复选框，则增加一个计数器。

# http - 使用异步队列连接 http 请求/响应模型

> ID：444271
> 
> 赞同：9
> 
> 时间：2009-01-14T19:10:03.930
> 
> 标签：http, queue, comet, beanstalkd

将同步 http 请求/响应模型与基于异步队列的模型连接起来的好方法是什么？

当用户的 HTTP 请求到来时，它会生成一个进入队列的工作请求（在本例中为[beanstalkd](http://xph.us/software/beanstalkd/)）。其中一名工作人员接听请求，完成工作并准备响应。

队列模型不是请求/响应——只有请求，没有响应。所以问题是，我们如何最好地将响应返回到 HTTP 世界并返回给用户？

想法：

1.  Beanstalkd 支持轻量级主题或队列（他们称之为管）。我们可以为每个请求创建一个管道，让工作人员在该管道上创建一条消息，并让 http 进程在管道上等待响应。不要特别喜欢这个，因为它有 apache 进程坐在那里占用内存。

2.  让 http 客户端轮询响应。用户的初始 HTTP 请求启动队列中的作业并立即返回。客户端（用户的浏览器）定期轮询响应。在后端，worker 将其响应放入 memcached，我们将 nginx 连接到 memcached，因此轮询是轻量级的。

3.  使用[彗星](http://blog.simonwillison.net/post/57956839764/comet)。类似于第二个选项，但使用更高级的 http 通信来避免轮询。

我倾向于 2，因为它很容易而且众所周知（我还没有使用过彗星）。我猜可能还有一个我没有想到的更好的明显模型。你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T21:20:41.543

以下是[如何在 JMS 上有效地实现请求-响应，](http://activemq.apache.org/how-should-i-implement-request-response-with-jms.html)这可能会有所帮助（尽管以 Java/JMS 为中心）。总体思路是为每个客户端/线程创建一个临时队列，然后使用相关 ID 将请求与回复等相关联。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-11T20:37:57.463

轮询是简单的解决方案；彗星是更有效的解决方案。你已经搞定了:)

我个人喜欢彗星（虽然我有偏见，因为我帮助编写了[WebSync](http://www.frozenmountain.com/websync)），它很好地让您的客户订阅频道并在您的服务器进程准备好时收到消息。像冠军一样工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T19:22:15.497

我正在寻找实现一个 Beanstalkd 和 memcached 系统以在请求之后运行多个进程 - 在这种情况下，在用户登录时查找信息（例如用户等待的消息数）。信息存储在 Memcached 中，然后在下一页加载时读回。

但是，如果不了解您正在执行的任务，就很难说出需要做什么或如何做。然而，选项 #2 是最简单的，这可能就是您所需要的 - 取决于您向工人推回的内容。

# ruby - 在 ruby 中将函数作为参数传递

> ID：444285
> 
> 赞同：5
> 
> 时间：2009-01-14T19:11:53.957
> 
> 标签：ruby, functional-programming, closures

我正在尝试用 ruby​​ 进行函数式编程，但那里似乎没有太多好的文档。

本质上，我正在尝试编写一个具有 Haskell 类型签名的组合函数：

```
[a] -> [a] -> (a -> a -> a) -> [a] 
```

所以

```
combine([1,2,3], [2,3,4], plus_func) => [3,5,7]
combine([1,2,3], [2,3,4], multiply_func) => [2,6,12] 
```

等等

我发现了一些关于使用 zip 和 map 的东西，但感觉真的很难用。

实现这样的事情的最“红宝石”方式是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-14T19:27:57.030

好吧，你说你知道 zip 和 map 所以这可能没有帮助。但我会发布以防万一。

```
def combine a, b
    a.zip(b).map { |i| yield i[0], i[1] }
end

puts combine([1,2,3], [2,3,4]) { |i, j| i+j } 
```

不，我也不觉得它漂亮。

**编辑 -** #ruby-lang @ irc.freenode.net 建议：

```
def combine(a, b, &block)
    a.zip(b).map(&block)
end 
```

或者这个，如果你想转发 args：

```
def combine(a, b, *args, &block)
    a.zip(b, *args).map(&block)
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T19:22:56.947

一个非常幼稚的方法：

```
def combine(a1, a2)
  i = 0
  result = []
  while a1[i] && a2[i]
    result << yield(a1[i], a2[i])
    i+=1
  end
  result
end

sum = combine([1,2,3], [2,3,4]) {|x,y| x+y}
prod = combine([1,2,3], [2,3,4]) {|x,y| x*y}

p sum, prod

=>
[3, 5, 7]
[2, 6, 12] 
```

并带有任意参数：

```
def combine(*args)
  i = 0
  result = []
  while args.all?{|a| a[i]}
    result << yield(*(args.map{|a| a[i]}))
    i+=1
  end
  result
end 
```

编辑：我赞成 zip/map 解决方案，但这里有一点改进，它有什么难看的？

```
def combine(*args)
  args.first.zip(*args[1..-1]).map {|a| yield a}
end

sum = combine([1,2,3], [2,3,4], [3,4,5]) {|ary| ary.inject{|t,v| t+=v}}
prod = combine([1,2,3], [2,3,4], [3,4,5]) {|ary| ary.inject(1){|t,v| t*=v}}
p sum, prod 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-16T22:42:31.500

您听起来可能还想要 Symbol.to_proc （Raganwald 的[代码](http://weblog.raganwald.com/2008/02/1100inject.html)）

```
class Symbol
  # Turns the symbol into a simple proc, which is especially useful for enumerations. 
  def to_proc
    Proc.new { |*args| args.shift.__send__(self, *args) }
  end
end 
```

现在你可以这样做：

```
(1..100).inject(&:+) 
```

免责声明：我不是 Rubyist。我只是喜欢函数式编程。所以这很可能不像Ruby。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T19:31:39.347

您可以将方法的名称作为符号传递，并使用`Object#send`（或`Object#__send__`）按名称调用它。（Ruby 没有真正的函数，它有方法。）

您可以传递一个`lambda`或块，它在您想要的参数上调用您想要的方法。传递块可能是首选的 Ruby 方式，当它起作用时（即当你只有一个块要传递时）。

`Method`您直接通过检索对象`Object#method`，然后将它们传递给`call`它们，但是我没有这样做的经验，并且在实践中没有看到它做太多。

# .net - 使应用程序在多个区域中运行

> ID：444286
> 
> 赞同：0
> 
> 时间：2009-01-14T19:11:55.830
> 
> 标签：.net

我目前正在复习考试 70-536。是否有关于如何配置应用程序以在多个环境中运行的示例？例如内联网和互联网。

我找不到一个好的代码示例。有人有吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T19:35:52.177

我认为这些考试题是关于[CAS](http://msdn.microsoft.com/en-us/library/aa302330.aspx)的。确保您了解其背后的概念。您将必须知道如何为您的应用程序配置策略等。

# wcf - 获取 WCF 服务以将 POST 的参数映射到参数

> ID：444289
> 
> 赞同：1
> 
> 时间：2009-01-14T19:12:41.053
> 
> 标签：wcf, asmx

我有一个旧服务，我希望将其更新到 WCF，它的行为之一是允许客户端发布具有以下内容的请求：

MyService.asmx/ProcessDocument 与 Post 数据看起来像：

```
request=<big block of xml> 
```

现在在 ASMX 时代，该服务接受了一个字符串参数，即：

```
public void ProcessDocument(string request) {
} 
```

到目前为止，我只是按照本文中的建议使用 Stream 在 WCF 中工作：http: [//www.dennydotnet.com/post/2008/09/16/WCF-REST-and-POST-让我们跳舞！.aspx](http://www.dennydotnet.com/post/2008/09/16/WCF-REST-and-POST-Lets-Dance!.aspx)

Stream 可以工作，只是需要更多步骤才能使其适用于似乎应该支持开箱即用的东西。

我对 WCF 很陌生 - 我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T20:46:45.107

好的，这个示例让我到达了我需要去的大部分地方：http: [//msdn.microsoft.com/en-us/library/bb943485.aspx](http://msdn.microsoft.com/en-us/library/bb943485.aspx)

我现在让它按要求工作。

# visual-studio-2008 - 使用 /m:x (x > 1) 在 Logger for MSBuild2008 中为项目分配错误

> ID：444292
> 
> 赞同：0
> 
> 时间：2009-01-14T19:13:24.267
> 
> 标签：visual-studio-2008, events, msbuild, parallel-processing, logging

我们使用 MSBuild2005 和自写的 Logger 类进行构建，该类跟踪当前正在构建的项目并将传入的错误/警告分配给项目。这有点棘手，因为 MSBuild 在“以某种方式”访问引用的项目时也会调用 ProjectStarted/FinishedEventArgs。但我得到了它的工作。

现在我们要切换到 MSBuild2008。一切正常，直到我们打开并行构建（/m:2 或更高版本；这是我等待的功能！）。我的理解是，我可以通过查看 BuildEventMessages 中的 ThreadId 属性来跟踪并行任务。但是，一旦您启用并行构建，这将无法按预期工作。我遇到了一个项目是在 ThreadId 1 上构建的，而另一个项目是在 ThreadId 5 上启动的。但之后第三个程序从 ThreadId 5 开始！奇怪的是，这些项目表现得“像堆栈一样”：第二个在第一个之前完成。所以我想：可能没问题，但是我该如何分配错误。检查我是否在一个项目中插入了错误的代码。结果是：错误消息有一个全新的 ThreadId（不是 1 或 5，而是 6）！

所以我的问题是：如何将错误/警告消息分配给项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-15T15:48:19.360

自己喜欢的答案：

在 .Net 3.5 中，BuildEventArgs 类包含一个包含 ProjectContextId 的新属性 BuildEventContext。这一次是唯一的，并且允许精确分配。

# algorithm - 如何有效地从平面结构中构建树？

> ID：444296
> 
> 赞同：186
> 
> 时间：2009-01-14T19:14:09.227
> 
> 标签：algorithm, tree, language-agnostic, hierarchical-data

我有一堆扁平结构的物体。这些对象具有一个`ID`和一个`ParentID`属性，因此它们可以排列在树中。它们没有特定的顺序。每个`ParentID`属性不一定与`ID`结构中的 an 匹配。因此，它们可能是从这些物体中出现的几棵树。

**您将如何处理这些对象以创建结果树？**

我离解决方案不远，但我确信它远非最佳......

我需要创建这些树，然后以正确的顺序将数据插入数据库。

没有循环引用。当 ParentID == null 或在其他对象中找不到 ParentID 时，节点是 RootNode

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2009-01-14T19:17:58.547

将对象的 ID 存储在映射到特定对象的哈希表中。枚举所有对象并找到它们的父对象（如果存在）并相应地更新其父指针。

```
class MyObject
{ // The actual object
    public int ParentID { get; set; }
    public int ID { get; set; }
}

class Node
{
    public List<Node> Children = new List<Node>();
    public Node Parent { get; set; }
    public MyObject AssociatedObject { get; set; }
}

IEnumerable<Node> BuildTreeAndGetRoots(List<MyObject> actualObjects)
{
    Dictionary<int, Node> lookup = new Dictionary<int, Node>();
    actualObjects.ForEach(x => lookup.Add(x.ID, new Node { AssociatedObject = x }));
    foreach (var item in lookup.Values) {
        Node proposedParent;
        if (lookup.TryGetValue(item.AssociatedObject.ParentID, out proposedParent)) {
            item.Parent = proposedParent;
            proposedParent.Children.Add(item);
        }
    }
    return lookup.Values.Where(x => x.Parent == null);
} 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2011-11-23T21:03:46.703

这是一个简单的 JavaScript 算法，用于将平面表解析为 N 次运行的父/子树结构：

```
var table = [
    {parent_id: 0, id: 1, children: []},
    {parent_id: 0, id: 2, children: []},
    {parent_id: 0, id: 3, children: []},
    {parent_id: 1, id: 4, children: []},
    {parent_id: 1, id: 5, children: []},
    {parent_id: 1, id: 6, children: []},
    {parent_id: 2, id: 7, children: []},
    {parent_id: 7, id: 8, children: []},
    {parent_id: 8, id: 9, children: []},
    {parent_id: 3, id: 10, children: []}
];

var root = {id:0, parent_id: null, children: []};
var node_list = { 0 : root};

for (var i = 0; i < table.length; i++) {
    node_list[table[i].id] = table[i];
    node_list[table[i].parent_id].children.push(node_list[table[i].id]);
}

console.log(root); 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2015-04-29T11:17:59.403

根据 Mehrdad Afshari 的回答和 Andrew Hanlon 对加速的评论，这是我的看法。

**与原始任务的重要区别：根节点的 ID==parentID。**

```
class MyObject
{   // The actual object
    public int ParentID { get; set; }
    public int ID { get; set; }
}

class Node
{
    public List<Node> Children = new List<Node>();
    public Node Parent { get; set; }
    public MyObject Source { get; set; }
}

List<Node> BuildTreeAndGetRoots(List<MyObject> actualObjects)
{
    var lookup = new Dictionary<int, Node>();
    var rootNodes = new List<Node>();

    foreach (var item in actualObjects)
    {
        // add us to lookup
        Node ourNode;
        if (lookup.TryGetValue(item.ID, out ourNode))
        {   // was already found as a parent - register the actual object
            ourNode.Source = item;
        }
        else
        {
            ourNode = new Node() { Source = item };
            lookup.Add(item.ID, ourNode);
        }

        // hook into parent
        if (item.ParentID == item.ID)
        {   // is a root node
            rootNodes.Add(ourNode);
        }
        else
        {   // is a child row - so we have a parent
            Node parentNode;
            if (!lookup.TryGetValue(item.ParentID, out parentNode))
            {   // unknown parent, construct preliminary parent
                parentNode = new Node();
                lookup.Add(item.ParentID, parentNode);
            }
            parentNode.Children.Add(ourNode);
            ourNode.Parent = parentNode;
        }
    }

    return rootNodes;
} 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2017-05-02T00:16:35.407

Python解决方案

```
 def subtree(node, relationships):
        return {
            v: subtree(v, relationships) 
            for v in [x[0] for x in relationships if x[1] == node]
        } 
```

例如：

```
 # (child, parent) pairs where -1 means no parent    
    flat_tree = [
         (1, -1),
         (4, 1),
         (10, 4),
         (11, 4),
         (16, 11),
         (17, 11),
         (24, 17),
         (25, 17),
         (5, 1),
         (8, 5),
         (9, 5),
         (7, 9),
         (12, 9),
         (22, 12),
         (23, 12),
         (2, 23),
         (26, 23),
         (27, 23),
         (20, 9),
         (21, 9)
        ]

    subtree(-1, flat_tree) 
```

产生：

```
 {
        "1": {
            "4": {
                "10": {}, 
                "11": {
                    "16": {}, 
                    "17": {
                        "24": {}, 
                        "25": {}
                    }
                }
            }, 
            "5": {
                "8": {}, 
                "9": {
                    "20": {}, 
                    "12": {
                        "22": {}, 
                        "23": {
                            "2": {}, 
                            "27": {}, 
                            "26": {}
                        }
                    }, 
                    "21": {}, 
                    "7": {}
                }
            }
        }
    } 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-12-14T15:04:31.587

JS 版本，它返回一个根或一组根，每个根都有一个包含相关子项的 Children 数组属性。不依赖于有序输入，相当紧凑，并且不使用递归。享受！

```
// creates a tree from a flat set of hierarchically related data
var MiracleGrow = function(treeData, key, parentKey)
{
    var keys = [];
    treeData.map(function(x){
        x.Children = [];
        keys.push(x[key]);
    });
    var roots = treeData.filter(function(x){return keys.indexOf(x[parentKey])==-1});
    var nodes = [];
    roots.map(function(x){nodes.push(x)});
    while(nodes.length > 0)
    {

        var node = nodes.pop();
        var children =  treeData.filter(function(x){return x[parentKey] == node[key]});
        children.map(function(x){
            node.Children.push(x);
            nodes.push(x)
        });
    }
    if (roots.length==1) return roots[0];
    return roots;
}

// demo/test data
var treeData = [

    {id:9, name:'Led Zep', parent:null},
    {id:10, name:'Jimmy', parent:9},
    {id:11, name:'Robert', parent:9},
    {id:12, name:'John', parent:9},

    {id:8, name:'Elec Gtr Strings', parent:5},
    {id:1, name:'Rush', parent:null},
    {id:2, name:'Alex', parent:1},
    {id:3, name:'Geddy', parent:1},
    {id:4, name:'Neil', parent:1},
    {id:5, name:'Gibson Les Paul', parent:2},
    {id:6, name:'Pearl Kit', parent:4},
    {id:7, name:'Rickenbacker', parent:3},

    {id:100, name:'Santa', parent:99},
    {id:101, name:'Elf', parent:100},

];
var root = MiracleGrow(treeData, "id", "parent")
console.log(root) 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-12-12T06:46:20.790

对于任何对 Eugene 解决方案的 C# 版本感兴趣的人，请注意*node_list*作为地图访问，因此请改用字典。

请记住，此解决方案仅在*表*按*parent_id*排序时才有效。

```
var table = new[]
{
    new Node { parent_id = 0, id = 1 },
    new Node { parent_id = 0, id = 2 },
    new Node { parent_id = 0, id = 3 },
    new Node { parent_id = 1, id = 4 },
    new Node { parent_id = 1, id = 5 },
    new Node { parent_id = 1, id = 6 },
    new Node { parent_id = 2, id = 7 },
    new Node { parent_id = 7, id = 8 },
    new Node { parent_id = 8, id = 9 },
    new Node { parent_id = 3, id = 10 },
};

var root = new Node { id = 0 };
var node_list = new Dictionary<int, Node>{
    { 0, root }
};

foreach (var item in table)
{
    node_list.Add(item.id, item);
    node_list[item.parent_id].children.Add(node_list[item.id]);
} 
```

节点定义如下。

```
class Node
{
    public int id { get; set; }
    public int parent_id { get; set; }
    public List<Node> children = new List<Node>();
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-03-20T14:51:56.583

在这里找到了一个很棒的 JavaScript 版本：http: [//oskarhane.com/create-a-nested-array-recursively-in-javascript/](http://oskarhane.com/create-a-nested-array-recursively-in-javascript/)

假设你有一个这样的数组：

```
const models = [
    {id: 1, title: 'hello', parent: 0},
    {id: 2, title: 'hello', parent: 0},
    {id: 3, title: 'hello', parent: 1},
    {id: 4, title: 'hello', parent: 3},
    {id: 5, title: 'hello', parent: 4},
    {id: 6, title: 'hello', parent: 4},
    {id: 7, title: 'hello', parent: 3},
    {id: 8, title: 'hello', parent: 2}
]; 
```

你想让对象像这样嵌套：

```
const nestedStructure = [
    {
        id: 1, title: 'hello', parent: 0, children: [
            {
                id: 3, title: 'hello', parent: 1, children: [
                    {
                        id: 4, title: 'hello', parent: 3, children: [
                            {id: 5, title: 'hello', parent: 4},
                            {id: 6, title: 'hello', parent: 4}
                        ]
                    },
                    {id: 7, title: 'hello', parent: 3}
                ]
            }
        ]
    },
    {
        id: 2, title: 'hello', parent: 0, children: [
            {id: 8, title: 'hello', parent: 2}
        ]
    }
]; 
```

这是一个使它发生的递归函数。

```
function getNestedChildren(models, parentId) {
    const nestedTreeStructure = [];
    const length = models.length;

    for (let i = 0; i < length; i++) { // for-loop for perf reasons, huge difference in ie11
        const model = models[i];

        if (model.parent == parentId) {
            const children = getNestedChildren(models, model.id);

            if (children.length > 0) {
                model.children = children;
            }

            nestedTreeStructure.push(model);
        }
    }

    return nestedTreeStructure;
} 
```

用法：

```
const models = [
    {id: 1, title: 'hello', parent: 0},
    {id: 2, title: 'hello', parent: 0},
    {id: 3, title: 'hello', parent: 1},
    {id: 4, title: 'hello', parent: 3},
    {id: 5, title: 'hello', parent: 4},
    {id: 6, title: 'hello', parent: 4},
    {id: 7, title: 'hello', parent: 3},
    {id: 8, title: 'hello', parent: 2}
];
const nestedStructure = getNestedChildren(models, 0); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2018-09-29T11:27:58.977

这是 Mehrdad Afshari 的答案的 java 解决方案。

```
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;

public class Tree {

    Iterator<Node> buildTreeAndGetRoots(List<MyObject> actualObjects) {
        Map<Integer, Node> lookup = new HashMap<>();
        actualObjects.forEach(x -> lookup.put(x.id, new Node(x)));
        //foreach (var item in lookup.Values)
        lookup.values().forEach(item ->
                {
                    Node proposedParent;
                    if (lookup.containsKey(item.associatedObject.parentId)) {
                        proposedParent = lookup.get(item.associatedObject.parentId);
                        item.parent = proposedParent;
                        proposedParent.children.add(item);
                    }
                }
        );
        //return lookup.values.Where(x =>x.Parent ==null);
        return lookup.values().stream().filter(x -> x.parent == null).iterator();
    }

}

class MyObject { // The actual object
    public int parentId;
    public int id;
}

class Node {
    public List<Node> children = new ArrayList<Node>();
    public Node parent;
    public MyObject associatedObject;

    public Node(MyObject associatedObject) {
        this.associatedObject = associatedObject;
    }
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-01-13T17:35:30.553

我根据@Mehrdad Afshari 的回答用 C# 写了一个通用的解决方案：

```
void Example(List<MyObject> actualObjects)
{
  List<TreeNode<MyObject>> treeRoots = actualObjects.BuildTree(obj => obj.ID, obj => obj.ParentID, -1);
}

public class TreeNode<T>
{
  public TreeNode(T value)
  {
    Value = value;
    Children = new List<TreeNode<T>>();
  }

  public T Value { get; private set; }
  public List<TreeNode<T>> Children { get; private set; }
}

public static class TreeExtensions
{
  public static List<TreeNode<TValue>> BuildTree<TKey, TValue>(this IEnumerable<TValue> objects, Func<TValue, TKey> keySelector, Func<TValue, TKey> parentKeySelector, TKey defaultKey = default(TKey))
  {
    var roots = new List<TreeNode<TValue>>();
    var allNodes = objects.Select(overrideValue => new TreeNode<TValue>(overrideValue)).ToArray();
    var nodesByRowId = allNodes.ToDictionary(node => keySelector(node.Value));

    foreach (var currentNode in allNodes)
    {
      TKey parentKey = parentKeySelector(currentNode.Value);
      if (Equals(parentKey, defaultKey))
      {
        roots.Add(currentNode);
      }
      else
      {
        nodesByRowId[parentKey].Children.Add(currentNode);
      }
    }

    return roots;
  }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-14T19:27:52.037

在我看来这个问题很模糊，我可能会创建一个从 ID 到实际对象的映射。在伪java中（我没有检查它是否工作/编译），它可能是这样的：

```
Map<ID, FlatObject> flatObjectMap = new HashMap<ID, FlatObject>();

for (FlatObject object: flatStructure) {
    flatObjectMap.put(object.ID, object);
} 
```

并查找每个父母：

```
private FlatObject getParent(FlatObject object) {
    getRealObject(object.ParentID);
}

private FlatObject getRealObject(ID objectID) {
    flatObjectMap.get(objectID);
} 
```

通过重用`getRealObject(ID)`并执行从对象到对象集合（或它们的 ID）的映射，您也可以得到一个父->子映射。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-14T20:03:13.353

假设 Dictionary 类似于 TreeMap，我可以在 4 行代码和 O(n log n) 时间内完成此操作。

```
dict := Dictionary new.
ary do: [:each | dict at: each id put: each].
ary do: [:each | (dict at: each parent) addChild: each].
root := dict at: nil. 
```

*编辑*：好的，现在我读到一些 parentID 是假的，所以忘记上面的，然后这样做：

```
dict := Dictionary new.
dict at: nil put: OrderedCollection new.
ary do: [:each | dict at: each id put: each].
ary do: [:each | 
    (dict at: each parent ifAbsent: [dict at: nil]) 
          add: each].
roots := dict at: nil. 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-14T20:31:12.813

大多数答案都假设您希望在数据库之外执行此操作。如果您的树本质上是相对静态的，并且您只需要以某种方式将树映射到数据库中，您可能需要考虑在数据库端使用嵌套集表示。查看 Joe Celko 的书籍（或[此处](http://www.ibase.ru/devinfo/DBMSTrees/sqltrees.html "这里") 查看 Celko 的概述）。

如果仍然绑定到 Oracle dbs，请查看他们的 CONNECT BY 以获得直接的 SQL 方法。

无论采用哪种方法，您都可以在将数据加载到数据库之前完全跳过树的映射。只是想我会提供这个作为替代方案，它可能完全不适合您的特定需求。原始问题的整个“正确顺序”部分在某种程度上暗示您出于某种原因需要数据库中的“正确”顺序？这也可能促使我去处理那里的树木。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-11-11T18:02:13.307

这与提问者所寻找的并不完全相同，但我很难理解这里提供的措辞模棱两可的答案，我仍然认为这个答案符合标题。

我的答案是将一个平面结构映射到一个直接在对象上的树，你所拥有的只是`ParentID`每个对象上的一个。`ParentID`是`null`或者`0`如果它是一个根。与提问者相反，我假设所有 valid 都`ParentID`指向列表中的其他内容：

```
var rootNodes = new List<DTIntranetMenuItem>();
var dictIntranetMenuItems = new Dictionary<long, DTIntranetMenuItem>();

//Convert the flat database items to the DTO's,
//that has a list of children instead of a ParentID.
foreach (var efIntranetMenuItem in flatIntranetMenuItems) //List<tblIntranetMenuItem>
{
    //Automapper (nuget)
    DTIntranetMenuItem intranetMenuItem =
                                   Mapper.Map<DTIntranetMenuItem>(efIntranetMenuItem);
    intranetMenuItem.Children = new List<DTIntranetMenuItem>();
    dictIntranetMenuItems.Add(efIntranetMenuItem.ID, intranetMenuItem);
}

foreach (var efIntranetMenuItem in flatIntranetMenuItems)
{
    //Getting the equivalent object of the converted ones
    DTIntranetMenuItem intranetMenuItem = dictIntranetMenuItems[efIntranetMenuItem.ID];

    if (efIntranetMenuItem.ParentID == null || efIntranetMenuItem.ParentID <= 0)
    {
        rootNodes.Add(intranetMenuItem);
    }
    else
    {
        var parent = dictIntranetMenuItems[efIntranetMenuItem.ParentID.Value];
        parent.Children.Add(intranetMenuItem);
        //intranetMenuItem.Parent = parent;
    }
}
return rootNodes; 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-08-09T20:18:12.330

这是一个红宝石实现：

它将按属性名称或方法调用的结果进行分类。

```
CatalogGenerator = ->(depth) do
  if depth != 0
    ->(hash, key) do
      hash[key] = Hash.new(&CatalogGenerator[depth - 1])
    end
  else
    ->(hash, key) do
      hash[key] = []
    end
  end
end

def catalog(collection, root_name: :root, by:)
  method_names = [*by]
  log = Hash.new(&CatalogGenerator[method_names.length])
  tree = collection.each_with_object(log) do |item, catalog|
    path = method_names.map { |method_name| item.public_send(method_name)}.unshift(root_name.to_sym)
  catalog.dig(*path) << item
  end
  tree.with_indifferent_access
end

 students = [#<Student:0x007f891d0b4818 id: 33999, status: "on_hold", tenant_id: 95>,
 #<Student:0x007f891d0b4570 id: 7635, status: "on_hold", tenant_id: 6>,
 #<Student:0x007f891d0b42c8 id: 37220, status: "on_hold", tenant_id: 6>,
 #<Student:0x007f891d0b4020 id: 3444, status: "ready_for_match", tenant_id: 15>,
 #<Student:0x007f8931d5ab58 id: 25166, status: "in_partnership", tenant_id: 10>]

catalog students, by: [:tenant_id, :status]

# this would out put the following
{"root"=>
  {95=>
    {"on_hold"=>
      [#<Student:0x007f891d0b4818
        id: 33999,
        status: "on_hold",
        tenant_id: 95>]},
   6=>
    {"on_hold"=>
      [#<Student:0x007f891d0b4570 id: 7635, status: "on_hold", tenant_id: 6>,
       #<Student:0x007f891d0b42c8
        id: 37220,
        status: "on_hold",
        tenant_id: 6>]},
   15=>
    {"ready_for_match"=>
      [#<Student:0x007f891d0b4020
        id: 3444,
        status: "ready_for_match",
        tenant_id: 15>]},
   10=>
    {"in_partnership"=>
      [#<Student:0x007f8931d5ab58
        id: 25166,
        status: "in_partnership",
        tenant_id: 10>]}}} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-04-17T07:53:23.763

接受的答案对我来说看起来太复杂了，所以我添加了它的 Ruby 和 NodeJS 版本

假设平面节点列表具有以下结构：

```
nodes = [
  { id: 7, parent_id: 1 },
  ...
] # ruby

nodes = [
  { id: 7, parentId: 1 },
  ...
] # nodeJS 
```

将上面的平面列表结构变成树的函数如下所示

对于红宝石：

```
def to_tree(nodes)

  nodes.each do |node|

    parent = nodes.find { |another| another[:id] == node[:parent_id] }
    next unless parent

    node[:parent] = parent
    parent[:children] ||= []
    parent[:children] << node

  end

  nodes.select { |node| node[:parent].nil? }

end 
```

对于 NodeJS：

```
const toTree = (nodes) => {

  nodes.forEach((node) => {

    const parent = nodes.find((another) => another.id == node.parentId)
    if(parent == null) return;

    node.parent = parent;
    parent.children = parent.children || [];
    parent.children = parent.children.concat(node);

  });

  return nodes.filter((node) => node.parent == null)

}; 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-06-15T08:15:20.333

一种优雅的方法是将列表中的项目表示为字符串，其中包含一个点分隔的父列表，最后是一个值：

```
server.port=90
server.hostname=localhost
client.serverport=90
client.database.port=1234
client.database.host=localhost 
```

当组装一棵树时，你最终会得到类似的东西：

```
server:
  port: 90
  hostname: localhost
client:
  serverport=1234
  database:
    port: 1234
    host: localhost 
```

我有一个[配置库](https://github.com/omry/omegaconf)，它从命令行参数（列表）实现这个覆盖配置（树）。将单个项目添加到树的列表中的算法在[这里](https://github.com/omry/omegaconf/blob/a3156c2e4b614fb96e3e4d975fed61a81e2d82fa/omegaconf/omegaconf.py#L143-L159)。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-14T19:30:02.423

您是否只使用这些属性？如果没有，最好创建一个子节点数组，您可以在其中循环遍历所有这些对象以构建此类属性。从那里，选择有子节点但没有父节点的节点，然后从上到下迭代地构建你的树。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-06-10T10:06:52.737

# 爪哇版

```
// node
@Data
public class Node {
    private Long id;
    private Long parentId;
    private String name;
    private List<Node> children = new ArrayList<>();
}

// flat list to tree
List<Node> nodes = new ArrayList();// load nodes from db or network
Map<Long, Node> nodeMap = new HashMap();
nodes.forEach(node -> {
  if (!nodeMap.containsKey(node.getId)) nodeMap.put(node.getId, node);
  if (nodeMap.containsKey(node.getParentId)) {
    Node parent = nodeMap.get(node.getParentId);
    node.setParentId(parent.getId());
    parent.getChildren().add(node);
  }
});

// tree node
List<Node> treeNode = nodeMap .values().stream().filter(n -> n.getParentId() == null).collect(Collectors.toList()); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-06-05T01:21:45.757

## 请参阅下面带有简单测试程序的完整 Java 8+ 解决方案。

> 这是对接受多个根的@“Vimal Bhatt”版本进行修改的解决方案

```
package tree;

import java.util.*;
import java.util.function.Consumer;
import java.util.stream.Stream;

public class Tree {

    private <T> void swap(T[] input, int a, int b) {
        T tmp = input[a];
        input[a] = input[b];
        input[b] = tmp;
    }

    public static void main(String[] args) {
        Random r = new Random(8);

        MyObject[] myObjects = new MyObject[]{
                new MyObject(6, 3),
                new MyObject(7, 5),
                new MyObject(8, 0),
                new MyObject(1, 0),
                new MyObject(15, 12),
                new MyObject(12, 0),
                new MyObject(3, 5),
                new MyObject(4, 3),
                new MyObject(5, 2),
                new MyObject(2, 1),
                new MyObject(21, 8),
                new MyObject(9, 1)
        };

        Tree t = new Tree();
        // cinco trocas arbitrarias de posição
        for (int i = 0; i < 5; i++) {
            int a = r.nextInt(7) + 1;
            int b = r.nextInt(7) + 1;
            t.swap(myObjects, a, b);
        }
        System.out.println("The list have " + myObjects.length + " objects");
        for (MyObject o: myObjects) {
            System.out.print(" " + o);
        }
        Iterator<Node> iterator = t.buildTreeAndGetRoots(Arrays.asList(myObjects));
        int counter = 0;
        System.out.println("");
        while (iterator.hasNext()) {
            Node obj = iterator.next();
            System.out.println(++counter + "\t" + obj.associatedObject.id + "\t-> " + obj.associatedObject.parentId);
        }
    }

    Iterator<Node> buildTreeAndGetRoots(List<MyObject> actualObjects) {
        Node root = null;
        Map<Integer, Node> lookup = new HashMap<>();
        actualObjects.forEach(x -> lookup.put(x.id, new Node(x)));

        Stream<Node> roots = actualObjects.stream()
                .filter(x -> x.parentId == 0)
                .map(x -> new Node(x));
        Consumer<Node> nodeConsumer = item -> {
            Node proposedParent;
            if (lookup.containsKey(item.associatedObject.parentId)) {
                proposedParent = lookup.get(item.associatedObject.parentId);
                item.parent = proposedParent;
                proposedParent.children.add(item);
            }
        };
        lookup.values().forEach(nodeConsumer);
        Stream<Node> s2 = lookup.values().stream().filter(e -> e.associatedObject.parentId != 0);
        return Stream.concat(roots, s2).iterator();
    }
}

class MyObject { // The actual object
    public int parentId;
    public int id;

    MyObject(int id, int parent) {
        this.parentId = parent;
        this.id = id;
    }

    @Override
    public String toString() {
        return "{ " +
                "parent: " + parentId +
                ", id: " + id +
                " }" ;
    }
}

class Node {
    public List<Node> children = new ArrayList<Node>();
    public Node parent;
    public MyObject associatedObject;

    public Node(MyObject associatedObject) {
        this.associatedObject = associatedObject;
    }
} 
```

# vmware - VMWare - 虚拟操作系统静态 IP 地址

> ID：444297
> 
> 赞同：15
> 
> 时间：2009-01-14T19:14:55.277
> 
> 标签：vmware, virtualization, nat, dhcp, static-ip-address

让虚拟操作系统在 VMWware 中具有静态 IP 地址的最佳方法是什么。我想保持 IP 地址静态，因为它是一个虚拟服务器。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-24T10:12:17.700

您可以配置 VMware DHCP 服务器 [在主机操作系统上运行] 每次为 VM 分配一个固定 IP 地址。

根据[vmware docs](http://pubs.vmware.com/workstation-10/index.jsp?topic=%2Fcom.vmware.ws.using.doc%2FGUID-04D783E1-3AB9-4D98-9891-2C58215905CC.html)，配置存储在以下位置：

视窗

`C:\Documents and Settings\All Users\Application Data\VMware\vmnetdhcp.conf`

Windows Vista 或 Windows 7

`C:\ProgramData\VMware\vmnetdhcp.conf`

Linux（仅限主机）

`/etc/vmware/vmnet1/dhcp/dhcp.conf`

Linux (NAT)

`/etc/vmware/vmnet8/dhcp/dhcp.conf`

适用于 Mac 的 VMWare Fusion（仅限主机）

`/Library/Preferences/VMware Fusion/vmnet1/dhcpd.conf`

适用于 Mac 的 VMWare Fusion (NAT)

`/Library/Preferences/VMware Fusion/vmnet8/dhcpd.conf`

MAC 示例的静态 IP 和 DNS 名称：

```
host ubuntu {
    hardware ethernet 00:0c:29:c0:2c:58;
    fixed-address 192.168.118.3;
} 
```

有关这方面的更多详细信息，请参阅此[博客文章](http://codefry.blogspot.com/2013/04/assigning-fix-ip-address-to-vmware-vm.html)。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-14T19:19:01.523

假设您没有使用基于 NAT 的 VMWare 网络，那么虚拟（来宾）服务器的答案与真实服务器没有任何不同。你可以：

*   通过客户操作系统支持的任何机制分配静态 IP。
*   将客户机操作系统配置为从 DHCP 服务器获取其 IP 地址，并将 DHCP 服务器配置为返回 VMWare 实例 MAC 地址的静态 IP 地址。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-15T00:45:04.143

如果您希望 VM 切片/VM 机器（访客）具有静态 IP，请将其分配给 VM 切片。然后在 VM 服务器上为网络适配器设置选择“桥接”。这告诉 VMWare 使用您在来宾上建立的任何 IP 设置。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-02-13T05:47:46.370

**这适用于我的机器**

遵循这些简单的步骤。只需5分钟。

```
1\. Note the MAC of the VM
2\. On the host machine open C:\ProgramData\VMware\vmnetdhcp.conf
    a. Or C:\Documents and Settings\All Users\Application Data\VMware\vmnetdhcp.conf 
    b. These 2 files are auto synced or mirrored. 
    c. Open the editor in Administrator mode. Eg notepad++. Otherwise you will get access denied message
3\. Add a new entry at bottom of the configuration file, right before the "# End" marker. MyGuestVM is any unique name. Example below

host sunilW2008Server {
hardware ethernet 00-0C-29-05-2B-A0;
fixed-address 192.168.63.222;
}

3\. Shutdown the VM and close the Workstation
4\. Re-start the VMWare DHCP and NAT services for changes to take effect (From services.msc) 
```

注意：以下文件夹自动同步..在一个地方更改，相同的内容将反映在另一个文件夹上

C:\ProgramData\VMware C:\Documents and Settings\所有用户\应用程序数据\VMware

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-18T19:27:46.563

一个简单的解决方法，将*vmware dhcp 服务器*配置为使用更长的租约。在*vmware* config 文件夹中（在*Windows 7*上`C:\ProgramData\vmware`）编辑文件 *vmnetdhcp.conf*`default-lease-time`并将和的值更改为`max-lease-time`更大的值，例如 4 个月（`4mo*30days*24hours*60min*60sec = 10368000`）。然后重新启动*vmware dhcp 服务器*。然后释放并续订客人的租约。现在，您的访客*IP*在接下来的四个月内都是*静态的。*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-27T08:02:05.120

如果您希望将 VM 主机配置保留为默认值，也可以将客户机配置为请求 dhcp 的固定地址。这甚至适用于 NAT 网络。对于 Ubuntu 和`dhclient`，这是通过以下块实现的`dhclient.conf`：

```
interface "eth0" {
    send dhcp-requested-address 192.168.1.222;
} 
```

来源：[https ://serverfault.com/a/381137](https://serverfault.com/a/381137)

# c# - 在 C# 中连接三个文件的最快方法是什么？

> ID：444309
> 
> 赞同：24
> 
> 时间：2009-01-14T19:19:14.877
> 
> 标签：c#, file

我需要使用 C# 连接 3 个文件。一个头文件、内容和一个页脚文件，但我想尽可能酷地做到这一点。

Cool = 非常小的代码或非常快（非汇编代码）。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-06-05T23:33:59.923

[我支持 Mehrdad Afshari，因为他的代码与System.IO.Stream.CopyTo](http://msdn.microsoft.com/en-us/library/system.io.stream.copyto.aspx)中使用的代码完全相同。我仍然想知道他为什么不使用相同的功能而不是重写其实现。

```
string[] srcFileNames = { "file1.txt", "file2.txt", "file3.txt" };
string destFileName = "destFile.txt";

using (Stream destStream = File.OpenWrite(destFileName))
{
    foreach (string srcFileName in srcFileNames)
    {
        using (Stream srcStream = File.OpenRead(srcFileName))
        {
            srcStream.CopyTo(destStream);
        }
    }
} 
```

根据反汇编程序 ( [ILSpy](http://wiki.sharpdevelop.net/ILSpy.ashx) )，默认缓冲区大小为 4096。CopyTo 函数有一个重载，如果您对 4096 字节不满意，您可以指定缓冲区大小。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-14T19:22:05.980

```
void CopyStream(Stream destination, Stream source) {
   int count;
   byte[] buffer = new byte[BUFFER_SIZE];
   while( (count = source.Read(buffer, 0, buffer.Length)) > 0)
       destination.Write(buffer, 0, count);
}

CopyStream(outputFileStream, fileStream1);
CopyStream(outputFileStream, fileStream2);
CopyStream(outputFileStream, fileStream3); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-14T19:21:26.963

如果您的文件是文本且不大，那么对于非常简单、明显的代码来说，有话要说。我会使用以下内容。

```
File.ReadAllText("file1") + File.ReadAllText("file2") + File.ReadAllText("file3"); 
```

如果您的文件是大型文本文件并且您使用的是 Framework 4.0，则可以使用`File.ReadLines`来避免缓冲整个文件。

```
File.WriteAllLines("out", new[] { "file1", "file2", "file3" }.SelectMany(File.ReadLines)); 
```

如果您的文件是二进制文件，请参阅[Mehrdad 的回答](https://stackoverflow.com/a/444316/4435)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-14T19:47:21.203

另一种方式....让操作系统为您做这件事怎么样？：

```
ProcessStartInfo psi = new ProcessStartInfo("cmd.exe", 
        String.Format(@" /c copy {0} + {1} + {2} {3}", 
            file1, file2, file3, dest));
psi.UseShellExecute = false;
Process process = Process.Start(psi);
process.WaitForExit(); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-14T20:18:30.827

你的意思是3个文本文件？？结果是否需要再次成为文件？

怎么样：

```
string contents1 = File.ReadAllText(filename1);
string contents2 = File.ReadAllText(filename2);
string contents3 = File.ReadAllText(filename3);

File.WriteAllText(outputFileName, contents1 + contents2 + contents3); 
```

当然，使用 StringBuilder 和一些额外的智能，您可以轻松扩展它以处理任意数量的输入文件 :-)

干杯

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T19:44:30.757

如果您在[Win32](http://en.wikipedia.org/wiki/Windows_API)环境中，最有效的解决方案可能是使用 Win32 API 函数“WriteFile”。VB 6中有一个[例子](http://support.microsoft.com/kb/165942)，但是用C#重写它并不难。

# c# - c# 在 IE 中托管用户控件

> ID：444319
> 
> 赞同：1
> 
> 时间：2009-01-14T19:23:01.970
> 
> 标签：c#, internet-explorer, .net-2.0, user-controls

我们的网页仅在我们公司内部可用，我们非常希望能够在**.Net 2.0**环境中的部门网站上提供交互式 .net 用户控件。我已经成功地嵌入了对象：

```
<object id="Object1" classid="http:EmbedTest1.dll#EmbedTest1.UserControl1" 
        width="400" height="400">
    <param name="TestStr" value="Test Param String" />
</object> 
```

控件工作得很好，值被毫无问题地传递给控件。但是我在将后续值传递回嵌入式控件时遇到了问题

**尝试从控件接收事件：**

**尝试更新控制：**

```
<script type="text/javascript">
   function UpdateStr()
   {
      Object1.Text = "update string";
   }
</script> 
```

参考：
[http ://www.15seconds.com/issue/030610.htm](http://www.15seconds.com/issue/030610.htm)
[http://windowsclient.net/articles/iesourcing.aspx](http://windowsclient.net/articles/iesourcing.aspx)

**问题：**

1.  这种技术过时了吗？- 如果有，是否有替代品

2.  我应该只使用动作脚本而不是尝试这个吗？

3.  我已经让它部分工作，我试图连接到我正在运行的 web 服务，但我遇到了许多安全异常......当我以相同的方式使用 action scipt2 时，我没有得到相同的异常？

（旁注： - 我如何粘贴 html 脚本示例？）

谢谢。
布拉德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T19:31:26.273

1.  没有过时，很少使用，而且仅限 IE。如果您想为桌面应用程序进行类似 Web 的部署，请使用 ClickOnce。如果您希望 C# 代码在浏览器中运行而没有安全问题，请使用 Silverlight。您还可以查看 XBAP，它们是在浏览器中运行的沙盒 WPF 应用程序，可在 IE 和 Firefox 上运行，但需要在客户端安装完整的 .NET，而 Silverlight 没有这个问题。**底线：**看看 Silverlight。

2.  这当然是一种选择。如果您更熟悉 Microsoft 堆栈，则应该尝试使用 Silverlight，您可以在浏览器中针对 .NET 框架的子集编写 C#。

3.  我们在内部使用了网页中的 .NET 控件，并且遇到了各种各样的奇怪问题，主要与脚本或安全性有关。没有更多信息很难确定问题。

ps 使用 <pre> 标签编写所有代码示例。工具栏上有一个“代码示例”按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T19:29:25.730

如果您使用 Windows 控件执行的操作可以改为使用 ASP.NET Web 控件完成，我建议您考虑切换。您将更好地控制从客户端到服务器的信息交换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T19:30:45.697

1, 2) 是的，它已经过时了。如果您想在 .NET 中工作（并且您一心想要使用控件而不是 ASP.NET 样式的页面/站点），请尝试使用 Silverlight。

3) 在浏览器中运行的 .NET 代码受到非常严格的安全控制（例如，不能回调到它不是来自的网站）。

# javascript - 是否有类似于 HTML Tidy for Javascript 的 Windows 实用程序？

> ID：444321
> 
> 赞同：5
> 
> 时间：2009-01-14T19:27:10.587
> 
> 标签：javascript, editor, code-formatting

我想清理一些 javascript 文件并用漂亮的缩进等重新格式化它们，是否有实用程序在 Windows 下执行此操作的建议？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-14T20:06:48.497

[Beautify Javascript](http://elfz.laacz.lv/beautify/)是一个不错的简单选择。

（哎呀。以为我抓住了应用程序的链接，而不是主页。）；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T19:38:13.577

尝试在线[JavaScript Tidy](http://www.howtocreate.co.uk/tutorials/jsexamples/JSTidy.html)

> 已经进行了几次尝试来生成重新格式化代码的程序，但这些通常无法处理诸如“{”、“}”或“;”之类的情况。字符串、正则表达式或注释中的字符，因此**几乎所有这些字符都以损坏的代码告终**。但是，浏览器已经内置了自己的解析器来处理所有这些情况。**该脚本挂钩到浏览器自己的解析器，通过将代码包装在一个函数中，然后使用本机 toString 方法来获取整理后的代码。**因此，它依赖于浏览器产生整理的输出，而他们不需要这样做。事实上，它依赖于浏览器对整理后的代码进行反编译，而不是仅仅保留原始代码，这在性能方面是一个昂贵的过程，并且在尝试确保反编译的代码仍然有效时会导致额外的复杂性，因此并非所有浏览器都选择这样做。
> 
> 为获得最佳效果，请在此页面上使用 Opera 9.2x-（不是 9.5+）、Safari 或 Konqueror。它在 Firefox 中部分工作（嵌套函数未整理，这意味着您想要整理的大多数脚本仍然无法读取），并且无法在 IE 和 iCab 3- 中重新格式化代码。由于您始终可以在您的计算机上保留一份 Opera 9.2 的副本（以及任何当前版本），我建议您使用 Opera，并保留一份副本以与 JSTidy 一起使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T19:33:11.230

如果您有 Visual Studio，您可以打开 Javascript 文档并按 CTRL+K、CTRL+D 来格式化整个文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T19:38:08.037

[about.com 上的这个页面](http://javascript.about.com/library/blformat.htm)有一个工具，您可以在其中粘贴脚本并为您清理它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T19:55:28.410

[GNU 缩进](http://www.gnu.org/software/indent/)整理了 C 风格的语言。也许 Javascript 也可以用作主题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T21:23:43.817

对于离线使用，[此](https://stackoverflow.com/questions/18985/javascript-beautifier#27343)类似问题的答案解释了如何设置 Jonathan 建议从命令行使用[Rhino](http://www.mozilla.org/rhino/)运行的代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-04T14:59:32.550

我们的[JavaScript 格式化](http://www.semanticdesigns.com/Products/Formatters/ECMAScriptFormatter.html)程序使用语言精确的解析器来读取 Javascript，然后格式化代码。它不会被 HTML、字符串或字符的内容所迷惑。可以在 Windows 上运行。

# c++ - C++关于默认构造函数的问题

> ID：444322
> 
> 赞同：5
> 
> 时间：2009-01-14T19:27:29.963
> 
> 标签：c++, class

像这样调用一个类是什么意思：

```
class Example
{
 public: 
  Example(void);
  ~Example(void);
}

int main(void)
{
 Example ex(); // <<<<<< what is it called to call it like this?

 return(0);
} 
```

就像在这种情况下它似乎没有调用默认构造函数一样。有人可以给出一个不好的理由吗？

感谢所有的答案。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-14T19:31:45.680

目前，您正尝试像这样调用默认构造函数。

```
Example ex(); 
```

这实际上并没有调用默认构造函数。相反，您正在定义一个返回类型为 Example 且不带参数的函数原型。为了调用默认构造函数，省略 () 的

```
Example ex; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-14T19:32:16.833

这为名为 的函数声明了一个函数原型`ex`，返回一个`Example`! 您*不是*在此处声明和初始化变量。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-14T19:30:47.913

它甚至可以编译吗？无论如何，请参阅[此相关主题](https://stackoverflow.com/questions/180172/ctor-with-no-arguments)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T00:10:44.557

如前所述，`Example ex();`声明了一个函数原型。不是任何人所期望的。这个 C++ 缺陷将由新的 C++0x 标准修复。将来首选的语法将是`Example ex{};`. 新制服结构还有许多其他不错的功能，请[在此处](http://en.wikipedia.org/wiki/C%2B%2B0x#Uniform_initialization)查看更多信息。

# c# - WPF BitmapSource 图像源

> ID：444331
> 
> 赞同：7
> 
> 时间：2009-01-14T19:28:46.683
> 
> 标签：c#, wpf, xaml, binding

我将 Image.Source 属性绑定到下面显示的属性的结果。

```
public BitmapSource MyImageSource
{
    get
    {
        BitmapSource source = null;

        PngBitmapDecoder decoder;
        using (var stream = new FileStream(@"C:\Temp\logo.png", FileMode.Open, FileAccess.Read, FileShare.Read))
        {
            decoder = new PngBitmapDecoder(stream, BitmapCreateOptions.PreservePixelFormat, BitmapCacheOption.None);

            if (decoder.Frames != null && decoder.Frames.Count > 0)
                source = decoder.Frames[0];
        }

        return source;
    }
} 
```

由于某种原因，这在图像渲染期间失败（在 PresentationCore 程序集中的深处）。我确定图像没有损坏，因为我可以成功显示没有绑定的相同图像

```
<Image Name="FooImage" Source="/logo.png" /> 
```

我必须在代码中绑定图像源，因为我最终将从 base64 字符串创建图像流。

任何人都知道这是否是 WPF 的错误？还是我做错了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-15T05:54:03.567

问题是 BitmapCacheOption 选项，更改为 BitmapCacheOption.OnLoad 有效。

使用 BitmapCacheOption.None，BitmapSource 在图像渲染之前不会被解码，但是其中包含 png 的流已经在该点被释放。如果您缓存 OnLoad，它会立即解码并缓存结果，而不是稍后在流不再存在时尝试解码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T20:11:35.100

另外，您是否尝试过仅使用 BitmapImage 来加载图像？它适用于 PNG、BMP 和 JPEG。

它也是一种特殊类型的 BitmapSource，因此您可以将属性中的代码替换为：

```
BitmapImage img = new BitmapImage(new Uri(@"C:\Temp\logo.png"));
return img; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T20:03:30.467

您确定它是 PNG 而不仅仅是重命名的位图或 Jpeg 吗？如果您创建一个新的位图图像，然后只是重命名它并更改文件扩展名，则此错误是可重现的。

如果我在您的代码中使用已知的 PNG，我不会遇到您的问题，但会引发 COM 异常：

> 句柄无效。（来自 HRESULT 的异常：0x80070006 (E_HANDLE)）

你能用网络上的随机 PNG 试试看是否得到相同的结果吗？

# sql - sql statistics io scan count解释

> ID：444344
> 
> 赞同：25
> 
> 时间：2009-01-14T19:31:19.440
> 
> 标签：sql, performance, count, statistics, database-scan

简单的问题，但我在谷歌上没有找到很好的解释。使用 Set Statistics IO ON 时，在 management studio 的消息窗口中提供了逻辑读取和扫描计数。如果我有：

tblExample，扫描计数 5，逻辑读取 20

扫描计数意味着什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-08-06T02:31:22.970

至于“表扫描”的*含义*，我能找到的最好的是：

> **扫描计数仅表示在查询期间访问表或索引的次数。**它可能是完全扫描、部分扫描或只是搜索。

换句话说，仅扫描计数本身*不足以*继续进行。您需要确切地知道这些扫描是什么——因此您必须查看实际的执行计划以获取更多详细信息。最重要的是，它本身并不是一个非常有用的指标！

此外：

[http://www.eggheadcafe.com/software/aspnet/32171165/set-statistics-io-scan-count-explanation.aspx](http://www.eggheadcafe.com/software/aspnet/32171165/set-statistics-io-scan-count-explanation.aspx)

> 不幸的是，**这些天的扫描计数信息量不是很大**。嗯，好吧，如果您看到像 19223 这样的数字，则该表可能已通过嵌套循环连接多次访问。
> 
> 曾经有一段时间，“扫描计数”仅表示“访问的时间表”，但那是很久以前的事了，也许在 SQL 6.5 中。唯一可以获得具有 0 定义的扫描计数的查询是...
> 
> ```
> select *
> from TestA1
> where CompanyID = 1
> and CompanyID = 2 
> ```
> 
> ... SQL Server 可以在不访问表的情况下得出该查询不会返回任何行的结论。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-14T19:40:27.940

来自在线书籍

**扫描计数：** 执行的索引或表扫描的数量。

**逻辑读取：** 从数据缓存读取的页数。

**物理读取：** 从磁盘读取的页数。

**预读：** 为查询放入缓存的页数。

另请参阅：[http ://technet.microsoft.com/en-us/library/ms184361.aspx](http://technet.microsoft.com/en-us/library/ms184361.aspx)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2010-11-09T16:34:01.670

如果继续收集msdn引用。然后 [1] 在 [2] 中重复：

*   " **Logical Reads**
    该值表示处理查询所需的页面访问总数。**从数据缓存中读取每个页面，无论是否有必要将该页面从磁盘带入缓存以进行任何给定的读取**。该值为总是至少和物理读取的值一样大并且通常大于物理读取的值。可以多次读取同一页（例如从索引驱动查询时），因此表的逻辑读取计数可以大于表中的页数。

*   **Physical Reads**
    该值表示从磁盘读取的页数；它始终小于或等于 Logical Reads 的值。Performance Monitor 显示的 Buffer Cache Hit Ratio 的值是根据 Logical Reads 和 Physical Reads 值计算得出的，如下所示：

*   **Read Ahead Reads**
    Read Ahead Reads 值表示在处理查询时使用预读机制读入高速缓存的页数。这些页面不一定由查询使用。如果最终需要页面，则计算逻辑读取但不计算物理读取。高值意味着 Physical Reads 的值可能较低并且缓存命中率可能高于... [被 vgv8 截断]

*   **扫描计数**
    Scan Count 值表示访问相应表的次数。嵌套循环连接的外部表的扫描计数为 1。对于内部表，扫描计数可能是“通过循环”访问表的次数。逻辑读取数由扫描计数乘以每次扫描访问的页数的总和确定。但是，即使对于嵌套循环连接，内表的扫描计数也可能显示为 1。SQL Server 可能会将所需行从内表复制到缓存中的工作表中，并使用此工作表访问实际数据行。在计划中使用此步骤时，通常不会在 STATISTICS IO 输出中指示它。您必须使用 STATISTIC TIME 的输出，以及有关使用的实际处理计划的信息，确定执行查询所涉及的实际工作。对于连接中涉及的两个表，散列连接和合并连接通常将扫描计数显示为 1，但这些类型的连接可能涉及更多的内存。您可以在执行查询时检查 sysprocesses 中的 memusage 值，但与 physical_io 值不同的是，这不是累积计数器，仅对当前运行的查询有效。一旦查询完成，就无法查看它使用了多少内存。” 这不是累积计数器，仅对当前运行的查询有效。一旦查询完成，就无法查看它使用了多少内存。” 这不是累积计数器，仅对当前运行的查询有效。一旦查询完成，就无法查看它使用了多少内存。”

[1]
第 4 章。查询性能故障排除。监控
Microsoft® SQL Server™ **2005**
内部的查询性能： Kalen Delaney 的 查询调优和优化

* * *

出版商：Microsoft Press
Pub 日期：2007 年 9 月 26 日
印刷 ISBN-10：0-7356-2196-9
印刷 ISBN-13：978-0-7356-2196-1
页数：448

[2]
监控查询性能
优化查询性能
作者：Ron Soukup，Kalen Delaney，
第 14 章，来自 Microsoft SQL Server 7.0 内部，Microsoft Press 出版
[http://technet.microsoft.com/en-us/library/cc917719.aspx#ECAA](http://technet.microsoft.com/en-us/library/cc917719.aspx#ECAA)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-11-20T19:35:19.513

在这里对此进行了相当全面的总结。

*   [“SCAN COUNT 在 SET STATISTICS IO 输出中的含义” - 第 1 部分](http://blogs.msdn.com/b/sqlserverfaq/archive/2010/09/14/scan-count-meaning-in-set-statistics-io-output.aspx)
*   [“SCAN COUNT 在 SET STATISTICS IO 输出中的含义” - 第 2 部分](http://blogs.msdn.com/b/sqlserverfaq/archive/2010/09/29/scan-count-meaning-in-set-statistics-io-output-part-2.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-07T04:38:51.230

忽略扫描计数，这并不重要。专注于如何降低逻辑读取。基于[http://www.practicalsqldba.com/2013/07/sql-server-performance-tuning.html](http://www.practicalsqldba.com/2013/07/sql-server-performance-tuning.html)。

# c# - 如何在使用 VS MSI 安装程序安装之前备份 Web.config

> ID：444354
> 
> 赞同：3
> 
> 时间：2009-01-14T19:33:35.160
> 
> 标签：c#, windows-installer, web-deployment-project

我正在使用常规的 Visual Studio 安装项目来部署我的 ASP.NET 应用程序。我需要处理目标目录中存在的现有 web.config 的情况。找到后，需要在安装之前对其进行重命名。如果这没有发生，新的 web.config 将不会覆盖旧的。

在复制正在安装的文件之前，如何获得我的自定义操作来重命名旧的 web.config？

到目前为止，我已经尝试从 System.Configuration.Install.Installer 派生并覆盖 OnBeforeInstall、Install 和 Commit。似乎所有这些方法都是在将新文​​件复制到目标目录之后发生的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T19:43:45.610

在提交事件中执行此操作。您说您试图覆盖“提交”，但有两个提交事件；承诺和承诺。第一个发生在安装程序属性提交其安装之前，后者发生在之后。

# c++ - 使用 MSVC 强制符号导出

> ID：444356
> 
> 赞同：8
> 
> 时间：2009-01-14T19:34:10.713
> 
> 标签：c++, dll, plugins, visual-c++

我在 DLL 文件中有一个应用程序和几个插件。插件通过导出库使用来自应用程序的符号。应用程序链接在几个静态库中，这是大多数符号的来源。只要应用程序使用符号，它就可以正常工作。如果那里没有使用该符号，则在编译 DLL 时会出现链接器错误。

如何强制导出仅在插件中使用的符号？

为了触发导出，我尝试了这样的事情：

```
 class MyClassExporter
    {
        MyClass mInstance;
    public:
        MyClassExporter() {}
    };
    static MyClassExporter TheMyClassExporter; 
```

在其中一个静态库中，应用程序用于强制导出，这不起作用。

作为对 Greg 的回应（感谢您的回答）并澄清：我要强制导出的类是 MyClass（定义了 __declspec(...) ，具体取决于我要导出还是导入）。MyClassExport 是我试图强制将未使用的（就应用程序而言）符号包含到应用程序中。我想“触摸”这些符号，以便链接器将它们识别为已使用并将它们包含到应用程序中，以便它可以反过来将它们导出到我的插件中。将静态库链接到插件不是一种选择，因为它们包含会重复的单例（应用程序和 DLL 都有自己的静态变量副本）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-18T19:21:24.503

/ [INCLUDE](http://msdn.microsoft.com/en-us/library/aa278363(VS.60).aspx)指令可用于强制 MSVC 链接器包含符号。或者，[/OPT:NOREF](http://msdn.microsoft.com/en-us/library/aa278533(VS.60).aspx)通常可用于禁用删除未使用的符号。

一种常见的方法是创建一个未使用的函数，该函数引用为插件导出的所有对象。然后，您只需要该函数的单个 /INCLUDE 指令。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T05:17:07.510

你可能想看看 __declspec(export/import)

```
#ifdef DLL_EXPORTING
#define WHDLL __declspec(dllexport)
#else
#define WHDLL __declspec(dllimport)
#endif 
```

将静态模块链接到 dll 时，它只会引入使用的代码。我从来没有从静态库中导入东西来简单地重新导出它。
也许您只需要在编译静态库时在 dll 中将其标记为可导出。

但这让我想起了将 std 容器放入导出的类并在 msvc 中使用一些技巧来导出专用容器的“实例”。模板代码类似于您的静态代码（在我看来）

例如，如果没有模板，您会收到警告，模板代码未导出以支持该类 - 据我了解，这是 MSVC 特有的

```
template class DLL_EXPORTING std::auto_ptr<wxCursor>;
class DLL_EXPORTING imageButton : public wxWindow
{
    std::auto_ptr<wxCursor> m_Cursor;
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-12T20:00:00.357

“使用库依赖输入”选项在 VS2005 中起到了作用！

此选项可以在配置属性 -> 链接器 -> 常规 -> 使用库依赖输入下找到。设置为“true”以强制链接在指定为项目输入的每个 LIB 中声明的所有符号和代码。

您可以执行以下操作来获取要从 DLL 导出的符号：在库项目中定义 LIB_EXPORTS，而在 DLL 项目或 DLL 客户端项目中不定义任何内容。

```
#ifdef LIB_EXPORTS
#define DLLAPI __declspec(dllexport)
#else
#define DLLAPI __declspec(dllimport)
#endif 
```

事实证明，编译 DLL 项目时不需要 #include 来自 LIB 项目的任何头文件；只需将 LIB 指定为链接器输入。但是，如果您需要使用 DLL 中的 LIB 代码，则需要将 DLLAPI #define 为空宏；将符号设置为 dllexport 或 dllimport 将分别生成错误或警告。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-18T19:51:32.210

我试图解决这个问题的是：

1.  用函数构建一个静态库`void afunction( int )`。
2.  构建一个 dll，链接到静态库，导出`afunction`.
3.  `afunction`使用符号构建一个 exe 。

如何？由于可以告诉链接器使用该`__declspec(dllexport)`指令导出函数，因此 dll 只需声明一个要导出的符号即可。

该库有一个头文件“afunction.h”和一个包含函数体的随附 cpp 文件：

```
// stat/afunction.h
namespace static_lib { void afunction(int); }

// stat/afunction.cpp
#include "afunction.h"
namespace static_lib { void afunction(int){ } } 
```

该 dll 有一个包含文件“indirect.h”，其中包含要导出的函数的声明。dll 对静态库具有链接时依赖性。（链接器选项：输入/附加依赖项：“static_library.lib”）

```
// dll/indirect.h
namespace static_lib {
  __declspec( dllexport ) void afunction(int);
} 
```

可执行文件只有间接包含的文件：

```
#include <dll/indirect.h>
int main() { static_lib::afunction(1); } 
```

你猜怎么着？它编译、链接甚至运行！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-15T23:24:20.790

MSDN 上有一些关于这个问题的讨论，非常有用。事实证明，/OPT:NOREF 在这种情况下并不是特别有用。/INCLUDE 可以工作，但很难自动确定需要 /INCLUDE 的内容。不幸的是，没有灵丹妙药。

[http://social.msdn.microsoft.com/forums/en-US/vclanguage/thread/2aa2e1b7-6677-4986-99cc-62f463c94ef3](http://social.msdn.microsoft.com/forums/en-US/vclanguage/thread/2aa2e1b7-6677-4986-99cc-62f463c94ef3)

# php - 在本地计算机上测试 PHP 脚本

> ID：444372
> 
> 赞同：5
> 
> 时间：2009-01-14T19:39:21.950
> 
> 标签：php

一般是 PHP 和 Web 开发的新手。单击提交后，我试图从 HTML 表单中获取信息以显示在另一个网页的表格中。因此，我在本地 PC 上安装了 Apache，然后安装了 PHP，并希望能够在本地测试 PHP 脚本，但是它没有返回我期望的信息。以下是表单的代码：

```
<form method="post" action="showform.php">

Please fill out the following form if you would like to be contacted: <br/>
    Name:<input type="text" name="name" /> <br/><br/>
    Company: <input type="text" name="company"/> <br/><br/>
    Phone: <input type="text" name="phone" /> <br/><br/>
    Email: <input type="text" name="email" /> <br/><br/>

    <input type="submit" name="Submit" value="Submit" />
</form> 
```

以下是 php 脚本的代码：

```
<table>
<tr><th>Field Name</th><th>Value(s)</th></tr>

<?php
if (empty($_POST)) {
print "<p>No data was submitted.</p>";
 } else {

foreach ($_POST as $key => $value) {
if (get_magic_quotes_gpc()) $value=stripslashes($value);
if ($key=='extras') {

if (is_array($_POST['extras']) ){
    print "<tr><td><code>$key</code></td><td>";
    foreach ($_POST['extras'] as $value) {
            print "<i>$value</i><br />";
            }
            print "</td></tr>";
    } else {
    print "<tr><td><code>$key</code></td><td><i>$value</i></td></tr>\n";
    }
} else {

print "<tr><td><code>$key</code></td><td><i>$value</i></td></tr>\n";
}
 }
}
?>
</table>
</body>
</html> 
```

我知道它在互联网上使用时有效，但它为什么在本地不起作用。我检查了 apache 和 php 是否安装正确。可能是什么问题？当前结果是一个表格，其中 $key 和 $value 在正确值应该存在的地方，换句话说，在表格单元格中。谢谢你的帮助。

更新：现在通过 WAMPSERVER 工作-感谢所有提供帮助的人！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-14T19:41:23.540

查看[xampp](http://www.apachefriends.org/en/xampp.html)。它在您的机器上安装 Apache、Mysql、Perl 和 PHP，以便您可以在本地测试整个站点。它是一次性安装程序，并带有一个漂亮的控制面板，可根据需要启用/禁用每项服务。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T20:12:21.340

您也可以尝试[WampServer](http://www.wampserver.com/)。

它是一个包，包含：Apache、MySQL、PHP（预配置为在 Windows 中使用）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-13T06:58:57.607

如果使用 PHP 5.5+，则不需要服务器 - 它有一个内置服务器 ( [http://www.php.net/manual/en/features.commandline.webserver.php](http://www.php.net/manual/en/features.commandline.webserver.php) )

只需使用：

$ cd ~/项目

$ php -S 本地主机：8000

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T19:44:05.857

听起来你的 PHP 脚本如果你真的得到`$value`. 尝试运行基本`phpinfo()`来检查这一点。

如果 PHP 没有选择它，请确保 PHP 的路径设置为`httpd.conf`. 不过，我建议使用 xampp - 我对所有本地配置都很糟糕，只是让自动安装程序为我设置它。我知道以后可以添加新模块等。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-01-14T19:48:22.730

乍一看，您似乎正在尝试放置变量，但您正在将变量放在字符串中。

所以这：

```
print "<tr><td><code>$key</code></td><td><i>$value</i></td></tr>\n"; 
```

应该是这样的：

```
print "<tr><td><code>" . $key . "</code></td><td><i>" . $value . "</i></td></tr>\n"; 
```

# python - 如何找出当前正在执行的脚本的路径？

> ID：444376
> 
> 赞同：3
> 
> 时间：2009-01-14T19:40:24.697
> 
> 标签：python

**重复：[在Python中，如何获取当前正在执行的文件的路径和名称？](https://stackoverflow.com/questions/50499/in-python-how-do-i-get-the-path-and-name-of-the-file-that-is-currently-executing)**

我想找出当前正在执行的脚本的路径。我已经尝试过 os.getcwd() 但它只返回我运行脚本的目录，而不是存储脚本的实际目录。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-14T19:44:52.440

在 Python 中，`__file__`标识当前 Python 文件。因此：

```
print "I'm inside Python file %s" % __file__ 
```

将打印当前的 Python 文件。请注意，这适用于导入的 Python 模块以及脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T19:44:12.067

如何使用 sys.path[0]

你可以做类似
'print os.path.join(sys.path[0], sys.argv[0])'

[https://docs.python.org/library/sys.html](https://docs.python.org/library/sys.html)

# json - 有 JSON 的流 API 吗？

> ID：444380
> 
> 赞同：68
> 
> 时间：2009-01-14T19:42:13.897
> 
> 标签：json, streaming

DOM 是解析 JSON 的唯一方法吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-05-05T06:41:54.903

一些 JSON 解析器确实提供增量（“流式”）解析器；对于 Java，至少以下来自 json.org 页面的解析器提供了这样的接口：

*   [Jackson](http://wiki.fasterxml.com/JacksonInFiveMinutes)（拉接口）
*   [Json-simple](http://code.google.com/p/json-simple/)（SAX 风格的推送接口）

（除了[另一个答案](https://stackoverflow.com/a/444579/8946)提到的 Software Monkey 的解析器）

实际上，这么多 JSON 解析器不提供这个简单的低级接口有点奇怪——毕竟，他们已经需要实现低级解析，所以为什么不公开它。

编辑（2011 年 6 月）：Gson 也有自己的[流 API](http://sites.google.com/site/gson/streaming)（使用 gson 1.6）

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-01-14T20:41:14.900

通过 DOM，我假设您的意思是解析器会在您使用它之前一次读取整个文档。请注意，现在说 DOM 往往意味着 XML，但 IMO 这并不是一个准确的推论。

因此，在回答您的问题时——“是”，有流式 API 和“否”，DOM 不是唯一的方法。也就是说，将 JSON 文档作为流处理通常是有问题的，因为许多对象不是简单的字段/值对，而是包含其他对象作为值，您需要对其进行解析以进行处理，这往往会导致递归。但是对于简单的消息，您可以使用基于流/事件的解析器来做有用的事情。

我已经为 JSON 编写了一个 pull-event 解析器（它是一个类，大约 700 行）。但我见过的大多数其他人都是面向文档的。我在解析器之上构建的层之一是文档阅读器，它占用了大约 30 LOC。我只在实践中将我的解析器用作文档加载器（出于上述原因）。

我敢肯定，如果您搜索网络，您会发现基于拉取和推送的 JSON 解析器。

编辑：我已将[解析器发布](http://tech.dolhub.com/code/JsonParser)到我的网站以供下载。包括一个可工作的可编译类和一个完整的示例。

EDIT2：您还需要查看[JSON 网站](http://json.org/)。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-10-07T19:18:47.397

正如 stefanB 提到的，[http](http://lloyd.github.com/yajl/) ://lloyd.github.com/yajl/是一个用于流解析 JSON 的 C 库。该页面上还提到了许多其他语言的包装器：

> *   yajl-ruby - YAJL 的红宝石绑定
> *   yajl-objc - YAJL 的 Objective-C 绑定
> *   YAJL IO 绑定（用于 IO 语言）
> *   Python 绑定有两种风格，py-yajl 或 yajl-py
> *   yajl-js - node.js 绑定（镜像到 github）。
> *   lua-yajl - lua 绑定
> *   ooc-yajl - ooc 绑定
> *   yajl-tcl - tcl 绑定

其中一些可能不允许流式传输，但其中许多肯定允许。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-02-05T13:37:11.687

免责声明：我建议我自己的项目。

我在 Javascript 中维护了一个流式 JSON 解析器，它结合了 SAX 和 DOM 的一些特性：

[双簧管.js 网站](http://oboejs.com)

这个想法是允许流解析，但不需要程序员像使用原始 SAX 那样监听许多不同的事件。我喜欢 SAX，但对于大多数人的需求来说，它的级别往往很低。您可以通过注册 JSONPath 模式从 JSON 流中侦听任何有趣的节点。

代码在 Github 上：

[Oboe.js Github 页面](https://github.com/jimhigson/oboe.js)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-01-14T03:46:52.750

如果你想使用纯 JavaScript 和一个在 node.js 和浏览器中运行的库，你可以尝试 clarinet：

[https://github.com/dscape/clarinet](https://github.com/dscape/clarinet)

解析器是基于事件的，并且由于它是流式传输的，因此可以处理大文件。API 非常接近 sax，并且代码是从 sax-js 派生的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-11-08T12:29:21.833

如果您专门寻找 Python，那么[ijson](https://pypi.python.org/pypi/ijson/)声称支持它。但是，它只是一个解析器，所以我没有遇到任何可以将 json 生成为流的 Python。

对于 C++，有[rapidjson](https://code.google.com/p/rapidjson/)声称支持以流方式解析和生成。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-08-30T18:10:46.513

LitJSON 支持流式 API。引用[手册](http://litjson.sourceforge.net/doc/manual.html#quickstart.readerwriter)：

“一些开发人员可能熟悉的处理 JSON 数据的替代接口是通过类，这些类可以以类似流的方式读取和写入数据。这些类是`JsonReader`和`JsonWriter`.

“这两种类型实际上是这个库的基础，`JsonMapper`类型是建立在它们之上的，所以在某种程度上，开发人员可以将 reader 和 writer 类视为 LitJSON 的低级编程接口。”

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-10-16T18:50:12.073

这是一个用于解析和处理 JSON 流的 NodeJS NPM 库： [https ://npmjs.org/package/JSONStream](https://npmjs.org/package/JSONStream)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-12-14T15:46:58.487

对于 Python，ijson 的替代方案（显然更轻且更高效）是[jsaone](http://pietrobattiston.it/jsaone)（请参阅该链接以获取粗略的基准，显示 jsaone 大约快 3 倍）。

**免责声明**：我是 jsaone 的作者，我所做的测试非常基础......我很高兴被证明是错误的！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-02-16T22:57:58.747

回答问题标题：[YAJL](http://lloyd.github.com/yajl/) a JSON parser library in C：

> YAJL 会记住支持重新启动解析所需的所有状态。这允许在从磁盘或网络读取数据时逐步进行解析。

所以我猜想使用 yajl 来解析 JSON 可以被认为是处理数据流。

* * *

## 回答 #11

> 赞同：-7
> 
> 时间：2009-01-14T19:47:14.760

在回答您的第二个问题时，不，许多语言都有 JSON 解析器。PHP、Java、C、Ruby 等等。只是谷歌为您选择的语言加上“JSON 解析器”。

# visual-studio - Visual Studio：如何在两个单独的选项卡组中查看同一个文件？

> ID：444382
> 
> 赞同：210
> 
> 时间：2009-01-14T19:42:32.990
> 
> 标签：visual-studio

我希望能够在查看同一文件中的另一种方法时编辑一种方法，作为参考。这可以做到吗？

* * *

## 回答 #1

> 赞同：312
> 
> 时间：2009-01-14T19:53:28.553

您可以在另一个选项卡 ( `Window`-> `New Window`) 中打开该文件。

这样做你有同一个文件的两个副本。然后您可以右键单击标签栏并选择`New Vertical Tab Group`（或`New Horizontal Tab Group`，您更喜欢的那个）。

希望我理解你的问题..

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2017-09-27T11:33:55.737

> **位于**要复制的选项卡上，
> 然后单击顶部**菜单栏中**
> `Window`的>`New Window`

最后将第二个窗口拖放到左侧或右侧以显示两个视图彼此相邻。
瞧，你有它`:)`

![图片说明1](https://i.stack.imgur.com/eQaZK.png) ![图像指令2](https://i.stack.imgur.com/fOiEV.png)

# 编辑

**似乎所有版本的VS都没有实现这个功能。**
在我的情况下 ( `V 15.4.2 (2017)`, `V 15.9.7 (2017)`& `V 16.2.5 (2019)`) 它工作正常。

![版本 15.9.7](https://i.stack.imgur.com/fu7sn.png)

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2009-01-14T19:45:15.980

我只知道垂直方向。查看代码时，垂直滚动条的正上方是一个小矩形，将其向下拖动以获取文件的拆分视图。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2017-02-09T08:57:26.280

您只需使用文件窗口右上角的小拖动箭头图标，如下图所示：

[![拖动前](https://i.stack.imgur.com/prnUM.png)](https://i.stack.imgur.com/prnUM.png)

[![拖动后](https://i.stack.imgur.com/j9HmZ.png)](https://i.stack.imgur.com/j9HmZ.png)

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2017-08-22T07:50:21.000

**1) 并排查看同一文档（针对 Visual Studio 2017 进行了修复）**

可以使用`New Window`和来执行此操作`New Vertical Tab Group`，但是，在我的 Visual Studio 2017 中，菜单中**缺少**`New Window`该命令。要使用它，首先必须**将**命令添加到菜单或为其分配快捷方式。**`Window`**

 ****要添加`New Window`到您的`Window`菜单，请按照以下顺序，从`Tools`菜单开始：

`Tools`> `Customize`> `Commands`> `Menu Bar`> `Window`> `Add Command`> `Window`>`New Window`

仅供参考在这`Commands`一步中，您决定在哪里放置`New Window`命令。我在上面给出的顺序毫不客气地把它放在`Window`菜单的顶部。

**并排查看同一文档**

1.  打开要并排查看的文档
2.  选择您最近添加`New Window`的命令（可能在`Window`>中`New Window`）
3.  右键单击新选项卡并从菜单中选择`New Vertical Tab Group`或选择该命令`Window`

**2）查看同一个文档**

如果您希望在两个视图中查看同一文档，请使用`Window`>`Split`命令或单击并拖动任何窗口滚动条顶部的双箭头。

**3）发挥创意**

仅供参考，您甚至可以组合两个视图选项，在特别宽的显示器上查看同一文档的三个、四个甚至更多视图。在我的 (2560 x 1080) 上，如果需要，我可以轻松地获得三个并排视图**并**垂直拆分它们。 [![多个窗格](https://i.stack.imgur.com/3EeKT.png)](https://i.stack.imgur.com/3EeKT.png)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-08-23T09:21:40.967

一个人可以安装[VsVim](https://visualstudiogallery.msdn.microsoft.com/59ca71b3-a4a3-46ca-8fe1-0e90e3f79329)扩展并`:sp` `:vsp`做到这一点。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-02-20T08:26:08.757

在 Visual Studio 15 中，您只需单击文档内部，然后单击“窗口 → 拆分”

# sql-server - 批量加载 CouchDB 时遇到的问题

> ID：444386
> 
> 赞同：8
> 
> 时间：2009-01-14T19:43:00.587
> 
> 标签：sql-server, xml, json, xslt, couchdb

我在 MSSQL 2005 中有大约 15k 行要迁移到 CouchDB 中，其中一行是一个文档。我有一个 CLR-UDF，它将*n*行写入一个模式绑定的 XML 文件。我有一个将模式绑定的 XML 转换为 JSON 的 XSL 转换。

使用这些现有工具，我想我可以将 MSSQL 转换为 XML 到 JSON。如果我为每个 JSON 文件批处理*n*行，我可以编写 cURL 脚本以循环遍历文件并使用批量 API 将它们发布到 CouchDB `_bulk_docs`。

这行得通吗？以前有人做过这样的迁移吗？你能推荐一个更好的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-19T22:16:20.547

到目前为止，我做了一些从遗留 SQL 数据库到 CouchDB 的转换。我总是有一些不同的方法。

1.  我使用 SQL-DB 的主键作为 Document-Id。这使我可以一遍又一遍地导入，而不必担心重复文件。
2.  我进行了逐行导入而不是批量导入。它使调试更容易。我在 Internet 连接上看到每秒 5-10 次插入。虽然这不是闪电般的速度，但对我来说已经足够快了。我最大的数据库是 600.000 个文档，总计 20GB。在导入期间逐行使数据库膨胀，因此偶尔运行压缩。再说一次，除非您的行很大，否则 15.000 行听起来并不多。

我的导入代码通常如下所示：

```
def main():
 options = parse_commandline()
 server = couchdb.client.Server(options.couch) 
 db = server[options.db] 
 for kdnnr in get_kundennumemrs():
    data = vars(get_kunde(kdnnr)) 
    doc = {'name1': data.get('name1', ''),
           'strasse': data.get('strasse', ''),
           'plz': data.get('plz', ''), 'ort': data.get('ort', ''),
           'tel': data.get('tel', ''), 'kundennr': data.get('kundennr', '')}

    # update existing doc or insert a new one
    newdoc = db.get(kdnnr, {})
    newdoc.update(doc)
    if newdoc != db.get(kdnnr, {}):
        db[kdnnr] = newdoc 
```

# perl - 如何在 Vista 64 中通过文件关联传递命令行参数？

> ID：444388
> 
> 赞同：5
> 
> 时间：2009-01-14T19:43:56.530
> 
> 标签：perl, windows-vista, 64-bit, argument-passing

如何通过 Vista 64 中的文件关联传递命令行参数？

我最近构建了一台运行 Vista Ultimate 64 位的 PC。我注意到我传输的几个 Perl 脚本由于没有传递命令行参数而失败。作为一个简单的测试，我写了以下（foo.pl）：

```
#!/usr/bin/perl -w
use strict;
my $num_args = $#ARGV + 1;
print "${num_args} arguments read\n";
print "$^X\n" # to see what was being used 
```

不希望地运行“foo.pl 1 2 3”会产生：

```
0 arguments read
C:\strawberry\perl\bin\perl.exe 
```

运行“perl foo.pl 1 2 3”预期会产生：

```
3 arguments read
C:\strawberry\perl\bin\perl.exe 
```

在我的旧 Windows XP PC 上，两个调用都返回了 3 个参数。我在这里记录了更多我的侦探（[win32.perl.org wiki talk](http://win32.perl.org/wiki/index.php?title=Talk:Main_Page#fun_with_file_associations)），但我还没有找到一个可行的解决方案。

我也试过 ActivePerl-5.10.0.1004-MSWin32-x64-287188.msi 无济于事。

任何帮助，将不胜感激。这让我发疯。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-14T20:10:32.060

我刚刚在我的 Vista 64 Ultimate 上尝试了 ActivePerl-5.10.0.1004-MSWin32-x64-287188.msi，它成功了。

```
F:\prog\perl>foo.pl 1 2 3
3 arguments read
C:\Perl64\bin\perl.exe 
```

这意味着[devio 是正确的](https://stackoverflow.com/questions/444388/how-can-one-pass-command-line-arguments-via-file-association-in-vista-64#444452)：它必须是“文件关联”问题；

在资源管理器上，右键单击您的 .pl 文件并询问“打开方式”：使用“Perl 命令行解释器”，它将工作（并选择“始终使用此程序打开此类文件”）。

对我来说，“Vista 的文件扩展管理器删除了将参数传递给函数的能力”似乎是错误的......

* * *

我确实看到了：

```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\Perl\shell\Open\command]
@="\"C:\\Perl64\\bin\\perl.exe\" \"%1\" %*" 
```

这意味着如果您的安装没有在您的注册表中添加这种值，那是因为：

*   您在设置 ActivePerl-5.10.0.1004-MSWin32-x64-287188.msi 期间没有选择关联
*   或者您的帐户没有足够的权限在注册表中写入任何内容。

* * *

笔记：

*   Vista上的常规扩展管理器似乎没有传递参数（意味着`\"C:\\Perl64\\bin\\perl.exe\" \"%1\"`没有`%*`参数）
*   [SO 记录](http://win32.perl.org/wiki/index.php?title=Talk:Main_Page#Fun_with_File_Associations)的注册表添加是必要的

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-14T20:02:13.590

不了解 Vista 和 64 位，但在“经典”版本的 Windows 下，您可以编辑注册表：

```
HKEY_CLASSES_ROOT\.pl 
```

包含默认字符串“Perl”

```
HKEY_CLASSES_ROOT\Perl\shell\open\command 
```

包含默认字符串：

```
"C:\path-to\Perl\bin\perl.exe" "%1" %* 
```

其中 %* 是第一个参数之后的所有参数的宏。可能缺少 %* 。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T20:09:08.647

Vista 的文件扩展管理器删除了向程序传递参数的能力。您必须像 devio 提到的那样手动编辑注册表（或使用其他程序来编辑文件扩展名）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-17T10:34:47.110

对于 Perl 初学者来说，另一个有趣的事情是**ARGV 区分大小写**......只需花一个小时试图找出为什么我的命令行参数没有传递，只是我使用了 argv[0] 而不是 ARGV[ 0] ...

# security - 'NT AUTHORITY\NETWORK SERVICE' 没有继承本地组权限？

> ID：444395
> 
> 赞同：0
> 
> 时间：2009-01-14T19:44:38.913
> 
> 标签：security, iis, ntfs

我们正在删除使用 ASP.NET 网页上传到我们服务器的图像。该站点在 IIS 中的“NT AUTHORITY\NETWORK SERVICE”下运行。

在 IIS 服务器上，我们创建了一个本地组“Full_Access”，我们已将“NT AUTHORITY\NETWORK SERVICE”添加到其中。该组对文件启用了 NTFS 修改权限。

当我们从应用程序中删除文件时。该文件不会被删除。

如果我们将“NT AUTHORITY\NETWORK SERVICE”文件显式添加到文件中，并赋予修改权限而不是依赖它从它所在的本地组继承权限，那么它就可以正常工作。

我们已经在安全选项卡上使用了有效的权限检查，无论哪种方式它都应该有权限？但实际上只有我们直接授予服务帐户权限才有效？

'NT AUTHORITY\NETWORK SERVICE' 是否有某些原因不继承它所在的本地组的权限？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T01:41:10.067

为什么不创建一个专用的应用程序池并让它在具有适当权限的普通用户下运行？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T21:41:20.193

只是猜测，但是您是否尝试过重新启动服务器？

组成员身份在登录过程中确定。NETWORK SERVICE 实际上是计算机帐户。而且我认为它的工作方式与其他帐户不同。也就是说，当您启动应用程序时它不会登录。系统帐户（控制 iis）只是以它的身份启动进程。这意味着没有登录，也没有组成员资格检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T19:57:25.440

将组 IIS_WPG 添加到您的“Full_Access”组，而不是 NETWORK SERVICE。

来自[http://msdn.microsoft.com/en-us/library/ms998320.aspx](http://msdn.microsoft.com/en-us/library/ms998320.aspx)：

> **注意** 如果您需要为所有运行 ASP.NET 应用程序的帐户（网络服务或自定义服务帐户）授予对文件资源的相同级别的访问权限，您可以授予对 IIS_WPG 组的访问权限，而不是专门授予网络服务帐户. 任何用于运行 ASP.NET 的帐户都必须是 IIS_WPG 组的成员。

# asp.net - ASP.NET 中更新面板的显示问题

> ID：444397
> 
> 赞同：0
> 
> 时间：2009-01-14T19:44:58.553
> 
> 标签：asp.net, layout

我会尽力解释我的问题，这里是：我在 ASP.NET 页面上有一个更新面板，其中有一个面板服务器控件。我有一个圆角扩展器连接到 Panel 服务器控件，扩展器具有纯色背景和纯色边框。

好的....我还没有找到一个易于定位的更新面板本身，所以，我最终要做的是尝试使用 CSS 定位面板服务器控件。一旦我这样做并运行项目以查看成品，更新面板控件的开始位置和面板的位置之间存在很大差距。

我想知道的是：放置 UpdatePanel 或常规面板的最佳方法是什么，以便我所说的间隙不会出现？

如果有人需要我澄清，请在评论中告诉我，我会尽力而为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T19:50:34.223

我尝试将我的 UpdatePanel 紧紧包裹在需要具有动态效果的实际内容上。

如果您只有以这种方式更新该面板中的内容，我建议“反转”内容，以便您的布局类似于：

```
<Panel>
   <UpdatePanel>
      Pertinent Conent
   </UpdatePanel>
</Panel>
<RoundedCorderExtender /> 
```

看看这是否有助于解决您的间距问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T19:49:57.407

尝试将`RenderMode`更新面板从 Block 更改为 Inline。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T19:51:56.340

并不是说这是最好的答案，但我在玩同样的游戏，本周早些时候在 UpdatePanel 中异步回发后显示间隙。我在 UpdatePanel 中有一些 ajax 扩展器控件，我发现通过移动这些控件的标记使它们位于它们在 aspx 文件中扩展的控件之前，我的差距问题就消失了。

# c# - 为什么我的循环使用 100% CPU 并且永远不会结束？

> ID：444401
> 
> 赞同：0
> 
> 时间：2009-01-14T19:45:36.417
> 
> 标签：c#, delegates, readline, streamreader

我有这个方法：

```
 private delegate void watcherReader(StreamReader sr);
    private void watchProc(StreamReader sr) {
        while (true) {
            string line = sr.ReadLine();
            while (line != null) {
                if (stop) {
                    return;
                }
                //Console.WriteLine(line);
                line = stripColors(line);
                txtOut.Text += line + "\n";

                line = sr.ReadLine();
            }
        }
    } 
```

它从进程 (cmd.exe) 中读取流。当用户关闭 cmd.exe 窗口时，会导致 CPU 使用率跃升至 100%。使用调试器时，我看到它在 sr.ReadLine() 上停止并且永远不会返回。因为这是同时观察 StandardErrorStream 和 StandardOutputStream 它在两个内核上都使用 100%。

如果您需要，这里还有一些项目代码。

```
 [DllImport("User32")]
    private static extern int ShowWindow(int hwnd, int nCmdShow);   //this will allow me to hide a window

    public ConsoleForm(Process p) {
        this.p = p;
        p.Start();
        ShowWindow((int)p.MainWindowHandle, 0);   //0 means to hide the window.

        this.inStream = p.StandardInput;
        this.outStream = p.StandardOutput;
        this.errorStream = p.StandardError;

        InitializeComponent();

        wr = new watcherReader(watchProc);
        wr.BeginInvoke(this.outStream, null, null);
        wr.BeginInvoke(this.errorStream, null, null);
    }

    public void start(string[] folders, string serverPath) {

        this.inStream.WriteLine("chdir C:\\cygwin\\bin");
        this.inStream.WriteLine("bash --login -i");
        this.inStream.WriteLine("");
    }

    //code example from http://geekswithblogs.net/Waynerds/archive/2006/01/29/67506.aspx it is
    //to make the textbox autoscroll I don't understand what it does, but it works.
    #region autoscroll
    [DllImport("User32.dll", CharSet = CharSet.Auto, EntryPoint = "SendMessage")]
    static extern IntPtr SendMessage(IntPtr hWnd, uint Msg, IntPtr wParam, IntPtr lParam);

    const int WM_VSCROLL = 277;
    const int SB_BOTTOM = 7;

    private void txtOut_TextChanged(object sender, EventArgs e) {            
        IntPtr ptrWparam = new IntPtr(SB_BOTTOM);
        IntPtr ptrLparam = new IntPtr(0);
        SendMessage(((RichTextBox)sender).Handle, WM_VSCROLL, ptrWparam, ptrLparam); 
    }
    #endregion

    private void ConsoleForm_FormClosed(object sender, FormClosedEventArgs e) {
        this.stop = true;
        try {
            this.p.Kill();
        } catch (InvalidOperationException) {
            return;
        }
    } 
```

另一个有趣的是，它并不总是像应有的那样隐藏 cmd 窗口。它第一次隐藏它，然后第二次（或之后）它不会隐藏它。这是用户可以关闭 cmd.exe 窗口并使 readline 变得有趣的时候。它也永远不会读取输出到 cmd 的最后一行，除非它退出。

对于如何解决这个问题，有任何的建议吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-14T19:54:17.710

我会改变：

```
while(true) 
```

到：

```
while(!sr.EOS) {

} 
```

这是检查结束循环的更好方法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-14T19:53:49.207

每当您`while(true)`的代码中有一个循环时，您都会将您的 cpu（或至少一个核心）固定在 100%，除非您也有办法跳出循环。在您的情况下，您确实有一个`return`语句，但是在循环中，您从来没有对`stop`保护它的变量做任何事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T19:54:02.187

在`while(true)`循环中没有睡眠将导致 100% 的 CPU 使用率。

您需要休眠一段时间或在某个时间点跳出循环，以便 CPU 可以执行其他操作。

至少你应该按照以下方式做一些事情：

```
while (sr.Peek() >= 0) 
{
    Console.WriteLine(sr.ReadLine());
    Thread.Sleep(0);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T20:05:04.270

这似乎是一个有趣的问题。乍一看，ReadLine 在尝试读取数据时似乎存在从其下方关闭句柄的问题，因此这似乎是框架中的一个错误。但是，我不太容易相信这是 .Net 框架中的一个错误......

但是，这里有几个低级问题。

到目前为止，您得到的其他答案都建议您修改 while 循环。我也会这样做，但我不认为这是你问题的根源。你不需要在那里睡觉，因为你会从 ReadLine() 获得你的等待状态，除非没有数据要读取，它只是返回一个失败，那么你将“紧密循环”。因此，请确保在此循环期间检查所有错误状态。

如果你不这样做，我可以看到问题。

如果其他一切都正常工作，那么如果我是你，我会首先尝试确定你是否可以用一个小的演示程序在你的程序之外复制它。我确信框架的流处理中有很多错误检查。但是，看起来您正在从 Cygwin 运行一些东西，这就是您从 cmd shell 读取的输出。

尝试制作一个简单的应用程序，将数据输出到 stdout 和 stderr，然后确保在您仍在阅读时关闭应用程序。

还可以使用调试器查看失败发生后的行==。

拉里

# sql-server - SQL Server 探查器？

> ID：444402
> 
> 赞同：1
> 
> 时间：2009-01-14T19:45:43.157
> 
> 标签：sql-server

我正在寻找 SQL Server 2008 速成版中的 SQL Server Profiler。我的机器上运行了一个 SQL Server 2008 实例，但我也想要分析器。它是随安装一起提供的，还是必须单独安装？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T19:50:15.127

您需要为探查器安装开发版本或在此处获取此版本：http: [//sqlprofiler.googlepages.com/](http://sqlprofiler.googlepages.com/)

# sql - SQL：以二进制值获取索引处的值

> ID：444405
> 
> 赞同：1
> 
> 时间：2009-01-14T19:46:08.770
> 
> 标签：sql, stored-procedures, indexing, binary

是否有可以在查询、存储过程、函数中使用的 SQL 命令，该命令适用于类似于以下 C# 代码的二进制类型？

```
if (someBinaryArray[index] == 0) { 
... 
```

我想检查二进制中某个位置的索引是否是某个值，而不是拉下整个数组并进行比较？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T19:50:55.390

根据它与二进制列一起使用的文档，您可以使用 Substring()：

```
SELECT *
FROM Table
WHERE Substring(column, index, length) = 'blah' 
```

如果你真的想检查一个空值（如你的例子）......你可以这样做：

```
SELECT *
FROM table
WHERE SUBSTRING(column, 3, 1) = CHAR(0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T19:51:01.600

如果你在 MSSQL Server 上工作，你可以使用[READTEXT](http://msdn.microsoft.com/en-us/library/ms187365.aspx)命令

```
CREATE TABLE #t (b varbinary(1))

DECLARE @ptrval varbinary(16)
SELECT @ptrval = TEXTPTR(mybinarraycolumn) 
FROM mytable WHERE pk = @pk

INSERT INTO #t (b)
READTEXT pub_info.pr_info @ptrval @index 1

DECLARE @b varbinary(1)
SELECT @b = b FROM #t 
```

# http - 在 Restlet 客户端请求中使用参数

> ID：444422
> 
> 赞同：2
> 
> 时间：2009-01-14T19:53:05.170
> 
> 标签：http, parameters, client, restlet

我有：

```
Request request = new Request(Method.GET, "https://www.awebsite.com/login");
Client client = new Client(Protocol.HTTPS);
Response response = client.handle(request);
...
response.getEntity().write(System.out); 
```

但是我不知道如何设置登录参数...

我想要那个代码

*   逃跑等
*   可以轻松地在获取/发布之间切换

* * *

作为一个基于 REST 的平台，我想我可能需要使用一些参数“表示”，但这似乎有点奇怪。我认为构建这个代表性异常会很常见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T04:42:49.203

如果“登录参数”是指使用[基本 HTTP 身份验证发送凭据，](http://en.wikipedia.org/wiki/Basic_access_authentication)则使用[Request.setChallengeResponse()](http://www.restlet.org/documentation/1.1/api/org/restlet/data/Request.html#setChallengeResponse(org.restlet.data.ChallengeResponse))完成，如下所示：

```
Request request = new Request(Method.GET, "https://www.awebsite.com/login");
request.setChallengeResponse(new ChallengeResponse(ChallengeScheme.HTTP_BASIC, username, password)); 
```

这适用于任何请求，使用任何 HTTP 方法。

但是，如果您尝试对其进行身份验证的服务器需要使用基本 HTTP Auth 以外的其他协议的凭据，那么您需要解释该协议——即它是否使用 cookie、标头、令牌等。

顺便说一句，通过发布到[Restlet-Discuss](http://www.restlet.org/community/lists)邮件列表，您可能会得到更快/更好的响应；我已经在那里工作了一年半，这是一个很棒的社区。

# java - Maven 中许多继承的单插件配置文件是个好主意吗？

> ID：444426
> 
> 赞同：4
> 
> 时间：2009-01-14T19:53:54.980
> 
> 标签：java, maven-2

在我们的基础设施中，我们有很多由 Maven2 构建的小型 Java 项目。每个项目都有自己的 pom.xml，它最终继承自我们一家公司的“主”父 pom。

我们最近开始向我们的父 pom 添加小型配置文件，默认情况下禁用，启用后，以传统方式执行单个插件。

例子：

*   ' ***sources*** ' 配置文件执行*maven-source-plugin*以创建项目源的 jar。
*   ' ***clover*** ' 配置文件执行*maven-clover2-plugin*以生成 Clover 报告。它还嵌入了我们的 Clover 许可证文件，因此无需在子项目中重新指定。
*   ' ***fitnesse*** ' 配置文件执行*Fitnesse-maven-plugin*以运行与项目相关的适应度测试。其中包含fitnesse服务器主机和端口等信息，无需重复。

这用于在我们的 CI 服务器中指定构建，例如：

```
mvn test -P clover
mvn deploy site-deploy -P fitnesse,sources 
```

等等。

到目前为止，这似乎提供了一种方便的可选特性组合。

但是，继续使用这种方法是否有任何危险或陷阱（明显或其他）？这种类型的功能可以更好地实现或以另一种方式表达吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T20:15:21.630

此解决方案的问题在于，您可能正在创建一个“挑选和选择”模型，这有点不专横。对于您所描述的个人资料，您介于两者之间；如果每个配置文件本身都能产生不错的结果，那么您可能会没事。当您开始*需要*特定的配置文件组合时，我认为您正在遇到麻烦。

个别开发人员通常会遇到一致性问题，因为他们忘记了应该为给定场景使用哪一组配置文件。您的里程可能会有所不同，但我们在这方面遇到了真正的问题。一半的开发人员会在很短的时间后忘记“正确”的组合，最终会定期浪费*时间，因为他们在错误的时间运行了错误的组合。*

您将遇到的实际问题是，AFAIK 无法拥有一组“元”配置文件来激活一组子配置文件。如果有一种创建伞形配置文件的好方法，这将是一个非常简洁的功能。您的“健身”和“来源”配置文件应该是私有的，由一个或多个元配置文件激活。（您*可以*在 settings.xml 中为每个开发人员激活默认设置）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-30T22:31:31.903

在 Maven 中拥有多个配置文件没有问题，事实上，我认为它们是允许您的构建启用和禁用功能类的绝佳方式。我建议根据它们的功能而不是插件来命名它们，并考​​虑将功能相关的插件分组在同一个配置文件中。

作为一个先例，[Maven 超级 POM](http://maven.apache.org/guides/introduction/introduction-to-the-pom.html)定义了一个“发布配置文件”，其中包括源、javadoc 和部署插件的配置。

您应该考虑采用这种方法，因此您的“健身”配置文件将变为“集成测试”，如果以后需要，您可以选择在该配置文件中定义其他插件。类似地，“clover”配置文件可以重命名为“site”，您可以在该配置文件中定义其他报告，例如 JDepend、JXR、PMD 插件的配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T21:04:27.367

您似乎对这种方法有点怀疑，但您不确定为什么 - 毕竟，它非常方便。无论如何，这就是我对它的感觉：我真的不知道为什么，但这似乎有点奇怪。

让我们考虑这两个问题： a) 配置文件的用途是什么？b) 我们应该将您的方法与哪些替代方法进行比较？

关于 a)，我认为配置文件适用于不同的构建或执行环境。您可能依赖于本地安装的软件，您可以在其中使用配置文件来定义相应环境中可执行文件的路径。或者您可能有不同运行时配置的配置文件，例如“开发”、“测试”、“生产”。有关这方面的更多信息，请参见[http://maven.apache.org/guides/mini/guide-building-for-different-environments.html](http://maven.apache.org/guides/mini/guide-building-for-different-environments.html)和[http://maven.apache.org/guides/introduction/introduction-to- profile.html](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)。

至于b），我想到的想法：

1.  使用命令行属性触发插件。比如 mvn -Dfitnesse=true deploy。就像众所周知的 -DdownloadSources=true 用于 Eclipse 插件，或 -Dmaven.test.skip=true 用于万无一失。但这需要插件有一个标志来触发执行。并非您需要的所有插件都具有此功能。
2.  明确地调用目标。您可以在一个命令行上调用多个目标，例如“mvn clean package war:exploded”。当fitnesse被自动执行（使用各自的配置文件）时，这意味着它的执行被绑定到一个生命周期阶段。也就是说，只要到达生命周期中的那个阶段，就会执行插件。您应该能够包含插件，而不是将插件执行绑定到生命周期阶段，但仅在显式调用时才执行它。所以你的电话看起来像“mvn Fitnesse:run source:jar deploy”。

问题 a) 的答案可能解释了“奇怪”。这不是配置文件的用途。

因此，我认为备选方案 2 实际上可能是更好的方法。当用于不同执行或构建环境的“真实”配置文件发挥作用时，使用配置文件可能会出现问题。您最终会得到一个可能令人困惑的配置文件组合，其中配置文件意味着非常不同的事物（例如，“测试”表示环境，而“健身”表示目标）。如果您只是明确地调用目标，我认为这将非常清晰和灵活。记住插件/目标名称应该不会比记住配置文件名称更难。

# c# - 如何聚焦外国窗口？

> ID：444430
> 
> 赞同：20
> 
> 时间：2009-01-14T19:54:53.183
> 
> 标签：c#, .net, focus

我有一个应用程序，它一次只能打开一个自身实例。为了强制执行此操作，我使用以下代码：

```
System.Diagnostics.Process[] myProcesses = System.Diagnostics.Process.GetProcesses();
System.Diagnostics.Process me = System.Diagnostics.Process.GetCurrentProcess();
foreach (System.Diagnostics.Process p in myProcesses)
{
    if (p.ProcessName == me.ProcessName)
        if (p.Id != me.Id)
        {
            //if already running, abort this copy.
            return;
        }
}
//launch the application.
//... 
```

它工作正常。我还希望它能够专注于已经运行的副本的形式。也就是说，在返回之前，我想将此应用程序的另一个实例带到前台。

我怎么做？

SetForegroundWindow 在一定程度上有效：

```
[System.Runtime.InteropServices.DllImport("user32.dll")]
public static extern bool SetForegroundWindow(IntPtr hWnd); 

// ...
if (p.Id != me.Id)
{
    //if already running, focus it, and then abort this copy.
    SetForegroundWindow(p.MainWindowHandle);
    return;
}
// ... 
```

如果没有最小化，这确实会将窗口带到前台。惊人的。但是，如果窗口被最小化，它仍然是最小化的。

它需要取消最小化。

通过 SwitchToThisWindow 的解决方案（有效！）：

```
[System.Runtime.InteropServices.DllImport("user32.dll")]
public static extern void SwitchToThisWindow(IntPtr hWnd, bool fAltTab);

[STAThread]
static void Main()
{
    System.Diagnostics.Process me = System.Diagnostics.Process.GetCurrentProcess();
    System.Diagnostics.Process[] myProcesses = System.Diagnostics.Process.GetProcessesByName(me.ProcessName);
    foreach (System.Diagnostics.Process p in myProcesses)
    {
        if (p.Id != me.Id)
        {
            SwitchToThisWindow(p.MainWindowHandle, true);
            return;
        }
    }
    //now go ahead and start our application ;-)
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-14T20:39:45.667

我遇到了同样的问题，[SwitchToThisWindow()](http://msdn.microsoft.com/en-us/library/ms633553.aspx)对我来说效果最好。唯一的限制是您必须安装 XP sp1。我玩过 SetForegroundWindow、ShowWindow，它们都在将窗口拉入视野时遇到了问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-02-19T11:13:51.960

C# 相当于 Tom Juergens 的答案。对我来说就像一个魅力。

```
private const  int SW_SHOWNORMAL = 1;

[DllImport("user32.dll", SetLastError = true, CharSet = CharSet.Auto)]
private static extern bool ShowWindow(IntPtr hwnd, int nCmdShow);

[DllImport("user32.dll", SetLastError = true)]
private static extern bool SetForegroundWindow(IntPtr hwnd);

public void SetForeground()
{
    Process[] processes = Process.GetProcessesByName("process name");

    foreach (Process p in processes) {
        ShowWindow(p.MainWindowHandle, SW_SHOWNORMAL);
        SetForegroundWindow(p.MainWindowHandle);
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-01-25T10:27:46.200

和 OP 一样，我发现`SetForegroundWindow`当窗口最小化时，仅靠它是不够的。由于不想用`SwitchToThisWindow`，所以选择了`ShowWindow`后跟`SetForegroundWindow`。

对我来说效果很好！

```
private const SW_SHOWNORMAL = 1

<DllImport("user32.dll", SetLastError:=True, CharSet:=CharSet.Auto)> _
Private Function ShowWindow(ByVal hwnd As IntPtr, ByVal nCmdShow As integer) As Boolean
End Function

<DllImport("user32.dll", SetLastError:=True)> _
Private Function SetForegroundWindow(ByVal hwnd As IntPtr) As Boolean
End Function

Sub SetForeground()
    Dim processes As Process() = Process.GetProcessesByName("myprocess")

    For Each p as Process in processes
        ShowWindow(p.MainWindowHandle, SW_SHOWNORMAL)
        SetForegroundWindow(p.MainWindowHandle)
    Next
End Sub 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-14T20:03:07.550

我相信你会想要使用[SetForegroundWindow](http://msdn.microsoft.com/en-us/library/ms633539(VS.85).aspx)

[MSDN 示例](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/42b3db75-e61e-4f59-bf2b-c96a40cfb4e4/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-14T20:30:24.703

完成旁注...

您可以使用

```
Process.GetProcessesByName(me.ProcessName) 
```

而不是循环遍历系统上运行的所有进程......

**更新**

此类事情的[PInvoke规则...](http://www.pinvoke.net/default.aspx/user32/ShowWindow.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T20:05:44.957

您能否获取 Process 对象的 MainWindowHandle 属性并向其发送 WM_USER 消息，您可以将其解释为“其他实例想要将我带到前面”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-09-04T10:09:14.770

这是桌面应用程序中非常常见的行为，当我创建一个新的 WPF 应用程序时，我经常必须这样做。所以我创建了一个继承自 Application 的 SingletonApp 类：

```
public class SingletonApp : Application
{
    private static readonly System.Threading.Mutex mutex;
    private static readonly string processName;

    [DllImport("user32.dll")]
    private static extern bool ShowWindow(IntPtr hWnd, int flags);

    [DllImport("user32.dll")]
    private static extern bool SetForegroundWindow(IntPtr hwnd);

    static SingletonApp()
    {
        processName = Process.GetCurrentProcess().ProcessName;
        mutex = new System.Threading.Mutex(false, $"Local\\{processName}");
    }

    /// <summary>
    /// A base class for application needing to prevent multiple instances
    /// </summary>
    public SingletonApp()
    {
        if (!mutex.WaitOne(0, false))
        {
            // Give focus to existing instance before shutdown
            BringToFront(processName);

            Current.Shutdown();
        }
    }

    public void BringToFront(string processName)
    {
        Process process = Process.GetProcessesByName(processName).FirstOrDefault();

        if (process != null)
        {
            // In case of window is minimized
            ShowWindow(process.MainWindowHandle, 1);     // 1 = Normal

            SetForegroundWindow(process.MainWindowHandle);
        }
    }
} 
```

要使用它，您只需在 App.xaml.cs 中从 SingletonApp 而不是 Application 继承：

```
public partial class App : SingletonApp 
```

不要忘记更新 App.xaml ：

```
<utils:SingletonApp x:Class="MyApp.App"
             [...]
             xmlns:utils="clr-namespace:MyApp.Utils"
             Startup="App_OnStartup"> 
```

有了这个，在每个新的桌面客户端中实现这个行为变得非常容易。

# api - 使用本机 API 或 J2ME 开发黑莓应用程序？

> ID：444431
> 
> 赞同：17
> 
> 时间：2009-01-14T19:55:05.553
> 
> 标签：api, blackberry, java-me

我们将要构建一个 Blackberry 应用程序，但希望能就是否使用 J2ME（基于 MIDlet）或 Blackberry 本机（UIApplication）来实现一些输入。

我理解一些权衡。如果我们想将应用程序移植到其他设备上，J2ME 会更加灵活。RIM 对黑莓原生有更好的支持。

不过，我仍然缺乏信息的地方是 UI 方面。我们希望构建一款用户体验极佳的应用，并且看起来像 BB 用户习惯的其他应用。如果我们走 J2ME 路线，我们可以这样做吗？

对于这个问题的主观性和技术性较低，我们深表歉意。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-14T20:18:02.840

我已经尝试过两种方式——构建一个纯 MIDP 应用程序以在黑莓和非黑莓平台上运行，以及构建一个单独的黑莓应用程序（通常使用与 MIDP 应用程序相同的业务逻辑和网络代码）。绝对走黑莓原生路线。

这都是关于 BB UI 类的。它们将使您能够（除其他外）响应不同类型的菜单事件（轨迹球和菜单键），响应 BB 特定键码，如果您对 Storm 感兴趣，可以利用方向传感器触摸支持。此外，它们是一组更丰富的 UI 元素可供使用。您可以在纯 MIDP 中构建很多（但不是全部）它们所做的事情，但最终要为每个平台定制太多内容，最终您将无法保存任何内容。从 BB UI 开始并进行自定义可以节省大量时间和精力。

即使在游戏应用程序中，或者对于您自定义绘制所有组件的应用程序，您也可以更好地访问 BlackBerry 图形 API，并通过 BlackBerry 原生应用程序获得更好的性能。而且您仍然可以更好地了解输入事件。

最后，您可以使用 BlackBerry 原生应用程序执行一些不错的生命周期操作，例如推送到后台，或在系统启动时自动运行，而您无法使用 MIDlet 执行这些操作，这可能会根据您的应用程序感兴趣。

还要考虑市场——如果您计划立即支持 BlackBerry，然后可能会支持其他 MIDP 平台，那么在初始平台上尽可能地执行通常是一个更好的计划。如果您没有先在 BlackBerry 上取得成功，以后可能没有太多理由移植到 MIDP。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-08T22:04:56.527

黑莓是一个很难编程的平台。我走的是原生路线，发现它的文档记录很差，总的来说只是一个糟糕的设计。我确实觉得这是必要的，因为如果您走 J2ME 路线，您将失去某些功能（滚轮？）的能力。这是一种权衡，您必须选择更适合您的特定需求的那个。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-03T04:18:12.940

我从 2002 年开始使用 J2ME，当时 Nextel/摩托罗拉手机处于 J2ME 功能的最前沿。我主要处理非游戏应用程序。今天，随着 J2ME 的发展和更多符合 JSR 的手机，我的应用程序继续顺利移植。今年我终于把它移到了黑莓设备上。两天后，我的应用程序在 Blackberry 上完全正常运行。该应用程序是纯粹的通用 J2ME 并使用许多 JSR（位置、蓝牙、xml 等）。强大的 UI 设计会有所帮助。我扩展了一些 UI 类以支持 QWERTY/SureType 键盘。我已经使用了在黑莓设备（不是游戏）上发现的各种本地应用程序，我还没有证明有任何理由冒险使用 RIM API 来看看我会从中受益。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-14T22:34:30.740

在不知道您的应用程序的范围（即您将针对哪些设备）的情况下，您需要考虑的另一件事是每个 BlackBerry 型号的输入差异不断扩大。某些设备（例如 Curve 和 Bold）是标准 QWERTY 垫，而其他设备（例如 PEARL）具有 SureType 垫。然后是根据屏幕方向支持两者的 Storm。此外，如果用户以这种方式设置 SureType 键盘，则需要将其用作标准数字键盘。原生 API 支持所有这些，而标准 MIDP 则无法提供这些功能。

设计用户体验时的另一个提示是，我会尝试一些不同的黑莓型号，并尝试一些标准的应用程序，因为有很多用户习惯使用的快捷方式，你甚至可能没有意识到存在。例如，空格键向下翻页。这对于阅读文档来说非常重要，但是我有一个没有此功能的第三方 RSS 提要阅读器，我总是先尝试使用它，然后才记住它在此应用程序中不存在。这种小细节可以对黑莓用户产生巨大的影响。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-26T10:25:16.010

有一种介于两者之间的方法：您可以在 J2ME 中使用[J2ME-Polish](http://www.j2mepolish.org)和本机代码。波兰语将在一定程度上增加原生 BlackBerry 应用程序的外观和感觉。这具有将您的应用程序移植到其他 J2ME 手机的优势，而不仅限于 BlackBerry。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-08T22:02:09.607

我同意 Anthony 的观点，我会为 BlackBerry 应用程序使用 BlackBerry 特定的 API。J2ME 只是不可移植，而 BlackBerry 对其专有 API 的支持要好得多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-30T15:57:56.620

根据我的经验：坚持使用本机 BlackBerry UiApplication。它是 BlackBerry 的最佳选择，并为 BlackBerry 用户提供最佳的用户体验。你不能用 J2ME 轻易地复制它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-02T14:40:43.143

J2ME 易于开发。而且，BlackBerry API 具有许多功能，您还可以通过简单的签名使用受限类。黑莓出售他们的签名证书，而且很便宜。20 美元。您可以使用此证书来签署和使用所有受限类。在 J2ME 中，有时您必须使用多个证书，即使您不能使用所有电话功能。所以，我的建议是，使用 BlackBerry 原生 API 和一些 J2ME Wrapper Codes。因此，您可以像 J2ME 一样轻松编写代码，并且可以使用 BlackBerry 本机 API 的所有功能。

# c#-4.0 - 在哪里可以找到 C# 4.0 新功能的完整列表？

> ID：444436
> 
> 赞同：0
> 
> 时间：2009-01-14T19:57:58.543
> 
> 标签：c#-4.0

我在这里和那里听到了一些零碎的消息，但我还没有找到 C# 4.0 新特性的完整列表？有谁知道它们是什么或我在哪里可以找到它们？

* * *

**副本：**

[C# 4.0 的新酷特性](https://stackoverflow.com/questions/292265/new-cool-features-of-c-4-0)

和/或：

[C# 4.0 规范测试版？](https://stackoverflow.com/questions/408987/c-4-0-specification-beta)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T20:02:36.633

熟悉它们的最好方法是查看 Anders 的 Future of C# 演示文稿

[http://channel9.msdn.com/pdc2008/TL16/](http://channel9.msdn.com/pdc2008/TL16/)

Charlie Calvert 也有一篇博客文章，列出了 C# 4.0 特性的大量不同资源。包括一个指向 Mad 论文的链接，该链接将为您提供足够多的详细信息。页面上还有几个全面的示例链接。

[http://blogs.msdn.com/charlie/archive/2008/11/04/new-features-in-c-4-0-paper-plus-feedback-and-samples.aspx](http://blogs.msdn.com/charlie/archive/2008/11/04/new-features-in-c-4-0-paper-plus-feedback-and-samples.aspx)

# .net - asp.net Web 应用程序在 x64 与 x86 上编译和部署

> ID：444437
> 
> 赞同：0
> 
> 时间：2009-01-14T19:58:23.520
> 
> 标签：.net, asp.net, visual-studio-2008

由于没有足够的内存错误，我的 Web 应用程序几乎每周崩溃一次。虽然服务器有 8gb 的内存，它是服务器 2003 x64。几乎 5gb 总是免费的。

我在 studio 2008 中使用 Any CPU 选项编译我的应用程序。

我用来构建它的笔记本电脑具有 32 位 vista。

我的 Web 应用程序是在 x86 还是 x64 下运行？

如果不是在 64 位下运行，那么如果我以不同方式编译，我会为我的 Web 应用程序获得更多内存吗？在 .net 中使用 64 位是否有任何优势，或者 .net 本身仅限于使用特定数量的内存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T20:02:01.813

如果您的 Web 应用程序内存不足，那么您可能做错了什么。这可能意味着您有泄漏的旧 COM 对象，或者您正在滥用缓存或会话，或者您有循环引用或内存泄漏。

以 x64 重新编译/运行可以推迟内存不足错误，但不会改变它。

如果您在 x86 上编译它但使用了 AnyCPU 选项，并将其部署到 Windows 2003 上未修改的 IIS6 实例，则它以 x86 运行。您可以通过查看 Windows Server 2003 机器上的 Taskman 来测试这个假设。如果 w3wp.exe 有 *32，那么您正在运行 32 位。

# c# - 单击按钮时动态添加相同用户控件类型的多个实例

> ID：444440
> 
> 赞同：1
> 
> 时间：2009-01-14T19:58:51.070
> 
> 标签：c#, asp.net, .net-3.5, user-controls

是否可以在单击“添加”按钮并维护 ViewState 时添加同一用户控件的实例？

这里的用户界面类似于 Gmail 文件附加过程，用户可以点击“附加另一个文件”，然后出现另一个文件上传框。

我的页面被 UpdatePanel 包围。我能够加载 1 个控件，但按钮的单击事件在 Placeholder_Init 方法之后触发。我尝试在 ViewState 中存储一个整数，以跟踪应该呈现的用户控件的数量，但在 ViewState 恢复之前也会触发 Init 方法。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T20:15:30.007

在 ASP.NET 中动态添加多个控件很容易。假设您在 ASPX 文件中声明了一个名为 Panel 的面板，并且您有一个名为 MyControl 的自定义控件。

在您的 Page_Load 函数（或实际上几乎任何地方）中，添加如下内容：

```
for (int i = 0; i < NumberOfAttachments; i++) {
    Panel.Controls.Add(new MyControl());
} 
```

这也适用于 UpdatePanels，但如果您没有在子回发时更新它，则需要调用 .Update() 函数以使其在客户端更新。

# delphi - 可以禁用特定的 Delphi 提示吗？

> ID：444443
> 
> 赞同：17
> 
> 时间：2009-01-14T19:59:25.857
> 
> 标签：delphi, compiler-construction, directive, hints

在 Delphi 中，您可以使用编译器指令来禁用特定的警告，例如

```
{$WARN USE_BEFORE_DEF OFF} 
```

但是当我试图用一个特定的提示来做这件事时，我从帮助文件中得到了它的 underscore_style_name，编译器说它不知道 {$HINT} 是什么。那么有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-14T20:42:52.243

没有具体的提示，但您可以将它们全部禁用。

```
{$HINTS OFF}
procedure MyProc;
var
  i : integer;
begin
  DoSomething;
end;
{$HINTS ON} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-14T22:03:53.143

小题外话：您应该注意编译器的提示和警告。他们不只是为了好玩。编译器只是说“程序的工作方式可能与您认为的不同，因为您的源代码不准确”。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-08-10T07:44:16.340

为了安全起见，人们想做这样的事情：

```
function TopazGetText(const _s: string): string;
begin
{$IFOPT <something>+}
{$DEFINE HINTS_WERE_ON}
{$HINTS OFF}
{$ELSE}
{$UNDEF HINTS_WERE_ON}
{$ENDIF}
  Result := dzDGetText(_s, TOPAZ_TRANSLATION_DOMAIN);
{$IFDEF HINTS_WERE_ON}
{$HINTS ON}
{$ENDIF}
end; 
```

不幸的是，似乎没有用于检查提示是否关闭的编译器指令，所以你不能这样做。（H+ 不是用于提示，而是用于长字符串）。此外，HINTS OFF / ON 在函数/过程中不起作用。

因此，您最终会无条件地为整个功能关闭和打开提示：

```
{$HINTS OFF}
function TopazGetText(const _s: string): string;
begin
  Result := dzDGetText(_s, TOPAZ_TRANSLATION_DOMAIN);
end;
{$HINTS ON} 
```

（编译器曾经告诉我它不能内联 dzDGetText，在这种情况下我不关心，我不想看到提示，因为这会阻止我（和我的同事）关心重要提示.)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-14T20:07:36.573

我能想到的最好的方法是用条件定义围绕提示的主题，并在可能需要或可能不需要的代码周围使用相同的条件定义，如下所示：

如果你有这个：

```
procedure MyProc;
var
  i : integer;
begin
  DoSomething;
  //SomethingWith_i_IsCommentedOut;
end; 
```

您将得到： *提示：变量“i”已声明但从未使用过*

所以试试这个：

```
procedure MyProc;
  {$IFDEF USE_THE_I_PROCEDURE}
var
  i : integer;
  {$ENDIF}
begin
  DoSomething;
  {$IFDEF USE_THE_I_PROCEDURE}
  SomethingWith_i_IsCommentedOut;
  {$ENDIF}
end; 
```

现在您可以打开或关闭定义，而且您永远不会得到提示。

# infragistics - Infragistics webDataGrid 中的 FindControl

> ID：444455
> 
> 赞同：2
> 
> 时间：2009-01-14T20:02:58.503
> 
> 标签：infragistics, webdatagrid

我有 ig:TemplateDataField 包含标签。在 InitializeRow 事件处理程序中，我尝试使用 e.Row.FindControl 查找该标签，但我得到空值。

我无法找到另一种方法来找到我的标签。如何在 InitializeRow 事件期间在 WebDataGrid 行中查找控件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-12T09:00:18.383

您必须指定要搜索的列，例如`e.Row.Items[0].FindControl("ControlID")`列`0`索引的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-17T10:28:41.770

下面是一个应该有效的解决方案。注意：代码用于 Infragistics UltraWebGrid 控件。WebDataGrid 控件是 UltraWebGrid 的继承者。

C＃：

```
protected void UltraWebGridCustomers_InitializeRow(object sender, Infragistics.WebUI.UltraWebGrid.RowEventArgs e)
{
    TemplatedColumn col = (TemplatedColumn)e.Row.Cells.FromKey("HyperLinkEmailColumn").Column;
    CellItem cellItem = (CellItem)col.CellItems(e.Row.Index);
    HyperLink hyperLinkEmail = (HyperLink)cellItem.FindControl("HyperLinkSendEmail");
    hyperLinkShowDetails.Attributes.Add("onclick", "alert('This is the email link');");
} 
```

VB.NET：

```
Private Sub UltraWebGridCustomers_InitializeRow(ByVal sender As Object, ByVal e As Infragistics.WebUI.UltraWebGrid.RowEventArgs) Handles UltraWebGridCustomers.InitializeRow
        Dim col As TemplatedColumn = CType(e.Row.Cells.FromKey("HyperLinkEmailColumn").Column, TemplatedColumn)
        Dim cellItem As CellItem = CType(col.CellItems(e.Row.Index), CellItem)
        Dim hyperLinkEmail As HyperLink = CType(cellItem.FindControl("HyperLinkSendEmail"), HyperLink)
        hyperLinkShowDetails.Attributes.Add("onclick", "alert('This is the email link');")
End Sub 
```

ASP代码：

```
<infragistics:UltraWebGrid ID="UltraWebGridCustomers" runat="server">
    <Bands>
        <infragistics:UltraGridBand BaseTableName="Customers" Key="BandCustomers">
            <Columns>
                ...
                <infragistics:UltraGridColumn Key="NameColumn" BaseColumnName="Name" IsBound="True">
                    <Header Caption="Name">
                    </Header>
                </infragistics:UltraGridColumn>
                <infragistics:UltraGridColumn Key="EmailColumn" BaseColumnName="Email" IsBound="True">
                    <Header Caption="Email Address">
                    </Header>
                </infragistics:UltraGridColumn>
                <infragistics:TemplatedColumn Key="HyperLinkEmailColumn">
                    <CellTemplate>                        
                        <asp:HyperLink ID="HyperLinkSendEmail" NavigateUrl='<%# "~/EmailForm.aspx?email=" & DataBinder.Eval(Container.DataItem,"Email")%>' ToolTip="Send Email" runat="server" />
                    </CellTemplate>
                </infragistics:TemplatedColumn>
                ...
            </Columns>
            <AddNewRow View="NotSet" Visible="NotSet">
            </AddNewRow>                            
        </infragistics:UltraGridBand>
    </Bands>
    ...
</infragistics:UltraWebGrid> 
```

# asp.net - 无需自定义操作的多个网站的 MSI

> ID：444464
> 
> 赞同：1
> 
> 时间：2009-01-14T20:05:24.427
> 
> 标签：asp.net, visual-studio, windows-installer

我想创建一个安装 6 个网站的安装程序，所有这些网站都依赖于数据访问库。因此该解决方案包含 6 个 Web 应用程序和 1 个类库。

问题是：如何在不使用自定义操作的情况下完成此操作？

到目前为止，我唯一想到的就是从 Web 应用程序项目中制作合并模块，每个模块都放入类库项目的主要输出中，然后制作一个包含所有合并模块的主安装程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T20:08:06.573

我会把每个网站都放在一个功能中，这样你就可以让最终用户控制他们需要哪个网站，如果这是一个选项的话。

虽然，您必须在各自的.wxs 文件中为每个网站重复相同类型的代码。

# sql - 为什么这条 SQL 语句不起作用？

> ID：444467
> 
> 赞同：1
> 
> 时间：2009-01-14T20:06:27.607
> 
> 标签：sql, inner-join

```
选择 * 从表 1、表 2
在哪里 table1.user_id = table2.id
AND table1.content = 新闻
AND table1.content_id = 1

```

那行不通。你不能在一个sql语句中有两个“AND”吗？

//托梅克

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-14T20:08:47.650

您可能想将“新闻”引用为字符串...您也可能想改用内部联接（效率更高）

```
SELECT * FROM table1
INNER JOIN table2 ON table1.user_id = table2.id 
WHERE table1.content = 'news' 
AND table1.content_id = 1 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T20:09:45.137

`news`是什么？某种参数？领域的价值？应该出现在该领域的一个词？您的语法很可能是错误的，请参阅[W3Schools WHERE](http://www.w3schools.com/Sql/sql_where.asp)和[W3Schools AND/OR](http://www.w3schools.com/sql/sql_and_or.asp)运算符页面了解更多信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-14T20:11:22.387

让我用 JOIN 语句为你重写，因为它不再是 1995 年了，你还需要引用新闻

```
SELECT * FROM table1 t1
inner join table2 t2 on t1.user_id = t2.id
AND t1.content = 'news'
AND t1.content_id = 1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T20:10:51.343

*   table1 和 table2 是什么样的？你可以粘贴一个创建脚本吗？
*   我*强烈*建议使用正确的 JOIN 语法：

    select * from table1 inner join table2 on table1.user_id = table2.id ......

*   “table1.content”是什么数据类型？

您绝对可以在 SQL 查询中拥有不止 2 条 AND 语句 - 任何真正支持任何 SQL-xx 标准的数据库都将支持这一点......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T20:20:05.537

首先让我们从摆脱旧式连接开始，以便将连接和 where 子句清楚地分开，以便更容易理解。

```
SELECT * FROM table1 t1.
JOIN table2 t2
ON t1.user_id = t2.id
WHERE t1.content = news
AND t1.content_id = 1 
```

现在让我们讨论一下可能是什么问题。首先，您收到什么错误，因为这可能是完全可以接受的语法？问题可能是您没有注意到来自哪个表消息？如果它在两个表中，则可能会出现错误。如果 news 是该列的值，则您希望它是“news”而不是 news。也可能只是没有记录符合您的条件。

此外，使用 select * 是一种不好的做法，并且永远不应该在连接中使用它，因为您至少要返回一个字段两次，这会浪费数据库和网络资源。始终只指定您需要的列。当懒惰的程序员在每个查询中都这样做时，这每天都会浪费大量资源。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T20:14:02.817

我喜欢 cmartin 的回应。此外，如果需要，您可以使用多个 AND。

# c# - Page_Load 在 Firefox 中调用，但不是 IE

> ID：444468
> 
> 赞同：3
> 
> 时间：2009-01-14T20:06:38.747
> 
> 标签：c#, asp.net, internet-explorer, pageload

我被扔进了一个 ASP.NET 项目，我有一个页面，其中包含一个通过 AJAX 获取的控件。

控件的 Page_Load 函数执行一些必要的逻辑，以从 Query 字符串中获取正确的值。

问题是在 IE 中没有调用 Page_Load 函数。

如果我在其中设置断点，我可以在 FF 中加载页面并观察它停止，但在 IE 中：没有交易。

我是 ASP.NET 的新手（阅读：完全），但我是一位经验丰富的 PHP 开发人员。所以我认为这可能与 IE 执行 AJAX 回调以获取控制权的方式有些不同。

有没有人有任何想法？

干杯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-15T00:26:20.780

这似乎是一个缓存问题，通过执行以下操作解决：

```
protected override void OnLoad(EventArgs e)
{
    Response.Cache.SetNoStore();
    Response.Cache.SetCacheability(HttpCacheability.NoCache);
    Response.Cache.SetExpires(DateTime.Now);
    Response.Cache.SetLastModified(DateTime.Now);
    Response.Cache.SetAllowResponseInBrowserHistory(false);
    base.OnLoad(e);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T20:26:31.560

也许尝试调试 javascript 以查看它是否曾尝试在 IE 中获得控制权？如果你可以的话。更好的是，在 Fiddler 中观看。 [http://www.Fiddler2.com](http://www.Fiddler2.com)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T00:34:15.070

如果是缓存，您应该使用 OutputCache 指令将其关闭：

```
<%@ OutputCache Duration="0" VaryByParam="None" %> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T20:13:23.163

我会尝试使用[IE 开发人员工具栏](http://www.microsoft.com/en-us/download/details.aspx?id=18359)来帮助调试 IE 问题，但我认为你在正确的轨道上。

也可以在IE的高级选项中开启脚本调试，对脚本进行调试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T20:14:23.847

Page_Load 里面是什么？EventWireup 在 ASPX 页面上设置为 false，或者它在代码中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T20:40:39.940

IE8 将让您调试 javascript。AFAIK，您所解释的不应在典型设置中发生，因为服务器处理来自所有浏览器的请求相同。您确定您位于正确的断点和正确的页面上吗？

也许您可以发布一个 page_load 的小样本以及您在哪里设置断点以及回调它的 JS？

供您参考，这里是[ASP.NET 页面生命周期](http://msdn.microsoft.com/en-us/library/ms178472.aspx)。

# python - 如何使用 SQLalchemy 获取列表中提供的键的所有行？

> ID：444475
> 
> 赞同：51
> 
> 时间：2009-01-14T20:08:32.063
> 
> 标签：python, select, sqlalchemy

我有一系列要检索的 ID。这很简单：

```
session.query(Record).filter(Record.id.in_(seq)).all() 
```

有更好的方法吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-19T09:49:39.757

你的代码绝对没问题。

`IN`就像一堆`X=Y`加入的，`OR`并且在当代数据库中非常快。

但是，如果您的 ID 列表很长，您可以通过传递返回 ID 列表的子查询来提高查询效率。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-02-06T16:37:32.963

原样的代码完全没问题。但是，有人问我在进行大 IN 与使用 get() 处理个人 ID 的两种方法之间建立某种对冲系统。

如果有人真的想避免 SELECT，那么最好的方法是提前在内存中设置所需的对象。例如，您正在处理一个大型元素表。将工作分解成块，例如，按主键或日期范围对整套工作进行排序，然后将该块的所有内容本地加载到缓存中：

```
 all_ids = [<huge list of ids>]

 all_ids.sort()
 while all_ids:
     chunk = all_ids[0:1000]

     # bonus exercise!  Throw each chunk into a multiprocessing.pool()!
     all_ids = all_ids[1000:]

     my_cache = dict(
           Session.query(Record.id, Record).filter(
                 Record.id.between(chunk[0], chunk[-1]))
     )

     for id_ in chunk:
         my_obj = my_cache[id_]
         <work on my_obj> 
```

这就是现实世界的用例。

但是为了说明一些 SQLAlchemy API，我们可以创建一个函数，为我们没有的记录执行 IN 并为我们有的记录执行本地 get。这是：

```
from sqlalchemy import inspect

def get_all(session, cls, seq):
    mapper = inspect(cls)
    lookup = set()
    for ident in seq:
        key = mapper.identity_key_from_primary_key((ident, ))
        if key in session.identity_map:
            yield session.identity_map[key]
        else:
            lookup.add(ident)
    if lookup:
        for obj in session.query(cls).filter(cls.id.in_(lookup)):
            yield obj 
```

这是一个演示：

```
from sqlalchemy import Column, Integer, create_engine, String
from sqlalchemy.orm import Session
from sqlalchemy.ext.declarative import declarative_base
import random

Base = declarative_base()

class A(Base):
    __tablename__ = 'a'
    id = Column(Integer, primary_key=True)
    data = Column(String)

e = create_engine("sqlite://", echo=True)
Base.metadata.create_all(e)

ids = range(1, 50)

s = Session(e)
s.add_all([A(id=i, data='a%d' % i) for i in ids])
s.commit()
s.close()

already_loaded = s.query(A).filter(A.id.in_(random.sample(ids, 10))).all()

assert len(s.identity_map) == 10

to_load = set(random.sample(ids, 25))
all_ = list(get_all(s, A, to_load))

assert set(x.id for x in all_) == to_load 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-01-21T19:49:20.697

如果使用复合主键，则可以使用`tuple_`，如

```
from sqlalchemy import tuple_
session.query(Record).filter(tuple_(Record.id1, Record.id2).in_(seq)).all() 
```

请注意，这在 SQLite 上不可用（请参阅[doc](http://docs.sqlalchemy.org/en/rel_0_9/core/sqlelement.html#sqlalchemy.sql.expression.tuple_)）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T20:21:40.120

我建议看一下它产生的 SQL。您可以打印 str(query) 来查看它。

我不知道使用标准 SQL 的理想方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-21T19:57:52.910

还有另一种方法；如果期望相关对象已经加载到会话中是合理的；您之前在同一事务中访问过它们，您可以改为：

```
map(session.query(Record).get, seq) 
```

在这些对象已经存在的情况下，这会快得多，因为不会有任何查询来检索这些对象；另一方面，如果这些对象中的一小部分*没有*被加载，它会非常非常慢，因为它会导致对每个丢失的实例进行查询，而不是对所有对象进行一次查询。

当您在到达上述步骤之前进行查询时，这可能很有用`joinedload()`，因此您可以确定它们已经被加载。通常，您应该默认使用问题中的解决方案，并且仅在您看到您一遍又一遍地查询相同的对象时才探索此解决方案。

# fractals - 什么是分形？

> ID：444480
> 
> 赞同：-1
> 
> 时间：2009-01-14T20:10:03.713
> 
> 标签：fractals

[如何编程分形](https://stackoverflow.com/questions/425953/how-to-program-a-fractal)的副本

* * *

什么是分形？

这是从数学带到编程以简化或解决一组特定问题的概念之一吗？

我正在关闭这个问题并发布了一个相关[问题](https://stackoverflow.com/questions/444628/programming-fractals)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-14T20:14:55.640

如果您想以一般非编程方式了解分形，我建议您查看一般非编程站点。维基百科有[一篇关于它们的好文章](http://en.wikipedia.org/wiki/Fractal)。如果您想了解编程分形，我建议您查看这个已经提出的问题：

[如何编程分形](https://stackoverflow.com/questions/425953/how-to-program-a-fractal)

它甚至有一个分形标签。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T20:18:40.750

分形通常是“一种粗糙或零散的几何形状，可以分割成多个部分，每个部分（至少近似）是整体的缩小尺寸的副本”，这种属性称为自相似性。该术语由 Benoît Mandelbrot 于 1975 年创造，源自拉丁语 fractus，意为“破碎”或“断裂”。数学分形基于经过迭代的方程，一种基于递归的反馈形式。

分形通常具有以下特征：

它具有任意小尺度的精细结构。

它太不规则了，很难用传统的欧几里得几何语言来描述。

它是自相似的（至少是近似的或随机的）。

它的豪斯多夫维数大于其拓扑维数（尽管空间填充曲线如希尔伯特曲线不满足这一要求）。

它有一个简单的递归定义。

[http://en.wikipedia.org/wiki/Fractal](http://en.wikipedia.org/wiki/Fractal)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T20:12:14.850

它是一种自相似形状，通常基于重复的数学函数（但不一定）。它与编程技术无关，但最简单的查看方法是编写程序来绘制它。（用纸笔画分形非常耗时）

我所说的“自相似”是指，如果您继续放大分形的不同部分，它不会像非分形形状那样变得“更平滑”或更线性。它的复杂程度与缩放级别无关。

维基[百科页面](http://en.wikipedia.org/wiki/Fractal)非常有用

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T20:15:55.123

查找[程序生成](http://en.wikipedia.org/wiki/Procedural_generation)，了解如何在编程中使用分形的一种方式。它们是从非常简单的来源生成混乱/看似复杂的数据的绝佳方式。生成的数据通常受益于自相似性和其他使内容对人们更有意义的组织结构。

# java - 使用 java 和 usb：哪个 api？jsr-80，jusb，...？

> ID：444497
> 
> 赞同：2
> 
> 时间：2009-01-14T20:14:46.153
> 
> 标签：java, api, usb, jusb

我希望两个 java 程序直接通过 USB 进行通信，而无需通过设备或电缆。不要问我为什么，我不知道这个决定背后的细节或理由。

我发现 jusb 和 jsr-80 是执行此操作的两个 java/usb API。他们在 linux 和 windows 上工作——我需要两者的能力。

问题：

哪个更标准和被接受？哪个更稳定？哪个更容易完成我的任务？是否有其他标准或常见的 java/usb API？

我想听听你们使用这些或其他 java/usb API 的经验。

谢谢，杰布

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T17:12:26.187

好吧，这两种实现都有其局限性，特别是在 Windows 上。它们都缺乏对 Windows 上的批量传输的支持。

www.icaste.com 上有一个商业图书馆 JCommUSB

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T01:15:17.543

> 我希望两个 java 程序直接通过 USB 进行通信，而无需通过设备或电缆

嗯？USB 通过电缆将设备连接到主机。

编辑：如果我必须快速使用两个 Java 程序进行通信，一个在设备上，一个在主机上，我几乎肯定会使用 USB 链接（在 Java 范围之外配置）充当串行流和使用像[rxtx](http://rxtx.org/)这样的串行库。

# visual-c++ - 按变量名称划分的数据断点

> ID：444502
> 
> 赞同：1
> 
> 时间：2009-01-14T20:15:23.330
> 
> 标签：visual-c++, breakpoints

是否有一种简单的方法可以在 Visual C++ 2005 中定义断点，只要某个值发生更改，就会暂停程序？我找到了数据断点，但它们需要一个内存地址，并且没有提供简单的方法来将它与变量联系起来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T20:19:44.867

“在地址框中，键入一个内存地址或计算为内存地址的表达式。例如，当变量 avar 的内容发生变化时，&avar 将中断。”

[http://msdn.microsoft.com/en-us/library/350dyxd0.aspx](http://msdn.microsoft.com/en-us/library/350dyxd0.aspx)

# python - 调试控制台是如何在 Python 中实现的？

> ID：444509
> 
> 赞同：11
> 
> 时间：2009-01-14T20:17:06.353
> 
> 标签：python, debugging, interactive

我见过几个提供调试控制台的 Python IDE（例如 PyDev Extensions、WingIDE）——一个在断点所在方法的上下文中运行的交互式终端。这使您可以打印成员、调用其他方法并查看结果，并重新定义方法以尝试修复错误。凉爽的。

谁能告诉我这是如何实现的？我知道有 Code 模块，它提供了一个 InteractiveConsole 类，但我不知道如何在当前加载的代码的上下文中运行它。我对 Python 还是很陌生，因此将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T22:18:13.970

您可以尝试查看 python 调试器 pdb。它就像 gdb 在你如何使用它，但在纯 python 中实现。在您的 python 安装目录中查找 pdb.py。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-15T18:25:28.560

是的，我很惭愧地承认它实际上在 InteractiveConsole 的文档中。您可以通过将 locals() 函数的结果传递给 InteractiveConsole 构造函数来使其在本地上下文中运行。我找不到在不终止应用程序的情况下关闭 InteractiveConsole 的方法，因此我将其扩展为仅在捕获 SystemExit 异常时关闭控制台。我不喜欢它，但我还没有找到更好的方法。

这是一些演示调试控制台的（相当简单的）示例代码。

```
import code

class EmbeddedConsole(code.InteractiveConsole):
    def start(self):
        try:
            self.interact("Debug console starting...")
        except:
            print("Debug console closing...")

def print_names():
    print(adam)
    print(bob)

adam = "I am Adam"
bob = "I am Bob"

print_names()
console = EmbeddedConsole(locals())
console.start()
print_names() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T22:53:16.193

[http://docs.python.org/3.0/library/functions.html#input](http://docs.python.org/3.0/library/functions.html#input)
[http://docs.python.org/3.0/library/functions.html#eval](http://docs.python.org/3.0/library/functions.html#eval)

```
def start_interpreter():
     while(True):
          code = input("Python Console >")
          eval(code) 
```

但是，我敢肯定，它们的实现比这更安全。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T23:29:13.033

Python 在[bdb 模块](http://docs.python.org/library/bdb.html)中有一个调试器框架。我不确定您列出的 IDE 是否使用它，但当然可以使用它实现完整的 Python 调试器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-26T17:14:48.360

如果您想尝试自己的 Python 控制台，那么这是一个不错的开始：

```
cmd = None
while cmd != 'exit':
    cmd = raw_input('>>> ')
    try:
        exec(cmd)
    except:
        print 'exception' 
```

但对于实际工作，请改用 InteractiveConsole。

# c# - 自定义动态创建的菜单会产生一些奇怪的错误

> ID：444510
> 
> 赞同：0
> 
> 时间：2009-01-14T20:17:06.867
> 
> 标签：c#, asp.net, aspmenu

背景是我有一个自定义控件，它是一个链接到 xmldatasource 的 asp:Menu。xmldatasource 是根据用户权限动态创建的。这是自定义控件的加载事件：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        string userId = (string)Session["userId"];

        if (userId != null)
        {
            DataSet ds = dal.RetrieveApplications(userId);
            ds.DataSetName = "Menus";
            ds.Tables[0].TableName = "Menu";
            DataRelation relation = new DataRelation
            ("ParentChild",
                ds.Tables["Menu"].Columns["Folder_Id"],
            ds.Tables["Menu"].Columns["Parent_Folder_ID"], true);

            relation.Nested = true;
            ds.Relations.Add(relation);

            xmlDataSource1.Data = ds.GetXml();

        }
} 
```

这非常适合第一个使用它的用户。但似乎每个后续用户实际上都在获得第一个用户的菜单。我已经完成并验证了我的数据集创建得很好，当我在加载结束时检查 XMLDatasource.data 时，xml 是正确的。

我真的被困住了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T20:39:17.773

我找到了答案，虽然我会把它留在这里给其他可能搜索这个的人：

但是我必须在 xmldatasource 上将“ENABLECACHING”设置为 false。

# vb.net - VB.NET 和 Crystal Reports - 数据集等

> ID：444512
> 
> 赞同：0
> 
> 时间：2009-01-14T20:17:41.610
> 
> 标签：vb.net, crystal-reports, dataset

我不确定这是否可能，但这里有：

目前我有一个带有一些标题字段和详细信息行的水晶报表（当然）我传递了一个包含标题数据表和详细数据表的数据集。一切都按预期工作......只要我在标题表中只有 1 条记录。如果标题数据表中有多个记录，我希望能够以某种方式使报告“重复”。这可能吗？有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T20:50:28.533

我相信报告标题只会出现一次。您可以插入一个组，并将该组绑定到表头数据表中的数据，然后删除在将表添加到报表时添加的默认表头和表尾行。这可能意味着将详细表中的数据作为子报告添加，并将子报告放入详细信息区域。

# c# - User32 的 ShowWindow 未按预期运行

> ID：444517
> 
> 赞同：1
> 
> 时间：2009-01-14T20:19:44.397
> 
> 标签：c#, .net, system.diagnostics, user32

我正在使用 User32 的 ShowWindow 方法向用户隐藏一个窗口（cmd.exe）（主要是为了防止他们关闭它）。当用户打开表单时，进程启动并隐藏，然后当表单关闭时，进程被终止。但是，当再次打开表单时，它不会隐藏窗口（有时不是第一次）有人可以帮我解决这个问题吗？

```
 [DllImport("User32")]
    private static extern int ShowWindow(int hwnd, int nCmdShow);   //this will allow me to hide a window

    public ConsoleForm(Process p) {
        this.p = p;
        p.Start();
        ShowWindow((int)p.MainWindowHandle, 0);   //0 means to hide the window. See User32.ShowWindow documentation SW_HIDE

        this.inStream = p.StandardInput;
        this.outStream = p.StandardOutput;
        this.errorStream = p.StandardError;

        InitializeComponent();

        wr = new watcherReader(watchProc);
        wr.BeginInvoke(this.outStream, this.txtOut, null, null);
        wr.BeginInvoke(this.errorStream, this.txtOut2, null, null);
    }

    private delegate void watcherReader(StreamReader sr, RichTextBox rtb);
    private void watchProc(StreamReader sr, RichTextBox rtb) {
        string line = sr.ReadLine();
        while (line != null && !stop && !p.WaitForExit(0)) {
            //Console.WriteLine(line);
            line = stripColors(line);
            rtb.Text += line + "\n";

            line = sr.ReadLine();
        }
    }

    public void start(string[] folders, string serverPath) {

        this.inStream.WriteLine("chdir C:\\cygwin\\bin");
        //this.inStream.WriteLine("bash --login -i");
        this.inStream.WriteLine("");
    }

    private void ConsoleForm_FormClosed(object sender, FormClosedEventArgs e) {
        this.stop = true;
        try {
            this.p.Kill();
            this.p.CloseMainWindow();
        } catch (InvalidOperationException) {
            return;
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T20:24:42.547

这会容易得多：

```
public ConsoleForm(Process p) {
        this.p = p;
        p.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
        p.StartInfo.CreateNoWindow = true;
        p.Start();

        this.inStream = p.StandardInput;
        this.outStream = p.StandardOutput;
        this.errorStream = p.StandardError;

        InitializeComponent();

        wr = new watcherReader(watchProc);
        wr.BeginInvoke(this.outStream, this.txtOut, null, null);
        wr.BeginInvoke(this.errorStream, this.txtOut2, null, null);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T20:35:04.850

你检查过是否`p.MainWindowHandle`是一个有效的句柄吗？至少它必须是非零的。尝试打电话[`IsWindow`](http://msdn.microsoft.com/en-us/library/ms633528.aspx)确认。

[MSDN 建议](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.mainwindowhandle.aspx)[`WaitForInputIdle`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.waitforinputidle.aspx)在检查前打电话`MainWindowHandle`；您可能在新进程创建其窗口之前访问该属性。但是，无论如何，该属性本质上是不稳定的，因为进程实际上并没有“主”窗口的概念。所有的窗户都一视同仁。.Net 框架只是将第一个窗口指定为主窗口，但过程本身并不需要这样考虑。

此外，您是否考虑过最初隐藏该过程，而不是启动它然后在事后隐藏？[像 Scotty2012 演示](https://stackoverflow.com/questions/444517/user32s-showwindow-doesnt-act-as-expected#444527)的那样设置流程的[`StartInfo`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.startinfo.aspx)属性。

# c# - 导入和导出 Excel - 什么是最好的库？

> ID：444522
> 
> 赞同：181
> 
> 时间：2009-01-14T20:20:08.577
> 
> 标签：c#, asp.net, excel, export-to-excel, import-from-excel

在我们使用 C# 编写的 ASP.NET 应用程序之一中，我们获取某个数据集合（SubSonic 集合）并将其导出到 Excel。我们还想以特定格式导入 Excel 文件。我正在寻找可以用于此目的的库。

要求：

*   Excel 2007 文件（Excel 2003 是否支持超过 64k 行？我需要的不止这些。）
*   不需要服务器上的 Excel
*   采用类型化的集合，如果可以，尝试将数字字段作为数字放入 Excel 中。
*   适用于大文件（100k 到 10M） - 足够快。
*   导出 GUID 时不会崩溃！
*   不花一大笔钱（没有像 aspose 这样的企业库）。免费总是很棒，但可以是一个商业图书馆。

你推荐什么图书馆？您是否将其用于大量数据？还有其他解决方案吗？

现在，我正在使用一个简单的工具来生成稍后由 Excel 加载的 HTML，但是我失去了一些功能，而且当我们加载它时 Excel 会抱怨。我不需要生成图表或类似的东西，只需导出原始数据。

我正在考虑平面 CSV 文件，但 Excel 是客户要求。如果我有一个工具可以与 Excel 相互转换，我可以直接使用 CSV。鉴于 Excel 2007 是一种基于 xml（和压缩）的文件格式，我猜这种库应该很容易找到。但是，对我来说最重要的是您的评论和意见。

* * *

编辑：具有讽刺意味的是，在我看来，按照投票最多的答案，最好的 Excel 导入和导出库根本没有导出。并非所有情况都如此，但它适用于我的情况。XLS 文件仅支持 64k 行。XLSX 最多支持 1M。我尝试过的免费库的性能很差（当你有 200k 行时加载一行需要一秒钟）。我没有尝试过付费的，因为我觉得当您需要的只是快速的 XLSX<->CSV 转换程序时，它们提供的价值被高估了。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-01-14T23:34:23.583

如果只是因为您对代码有最大的控制权，我将投入使用平面 csv 文件。只需确保您读取行并一次处理它们（将文档读取到最后并拆分会占用您所有的内存 - 与写入相同，将其流出）。

是的，用户必须先在 Excel 中保存为 CSV，然后才能处理它，但也许可以通过培训和在页面上提供明确的说明来克服这个限制？

最后，当您导出给客户时，如果您将 mime 类型设置为 text/csv，Excel 通常会映射到该类型，因此在用户看来它是“一个 Excel 文件”。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-02-11T04:16:56.313

自从我最初的回答以来，我发现了[Open XML SDK 。](http://msdn.microsoft.com/en-us/library/bb448854(office.14).aspx)它为电子表格对象提供强类型类，除其他外，而且似乎相当容易使用。我将在我的一个项目中将其用于报告。唉，2.0 版应该要到 2009 年底或 2010 年才能发布。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2010-04-28T05:54:33.700

在 LGPL 下免费用于商业项目的 ExcelPackage 的最后一个版本是[https://www.nuget.org/packages/EPPlus/4.5.3.3](https://www.nuget.org/packages/EPPlus/4.5.3.3)

如果您需要最新最好的商业许可证，可在此处获得：[https ://epplussoftware.com/en/LicenseOverview/](https://epplussoftware.com/en/LicenseOverview/)

我仍在与导出到 excel 功能作斗争，因为我的应用程序应该将一些数据导出到 excel-template 2007

这个项目对我来说似乎很好，开发人员对错误和问题非常敏感。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2011-11-07T13:31:45.370

我一直在使用[ClosedXML](http://closedxml.codeplex.com/)，效果很好！

> ClosedXML 使开发人员可以更轻松地创建 Excel 2007/2010 文件。它提供了一种很好的面向对象的方式来操作文件（类似于 VBA），而无需处理 XML 文档的麻烦。它可以被任何 .NET 语言使用，例如 C# 和 Visual Basic (VB)。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-08-29T18:26:39.100

[SpreadsheetGear for .NET](http://www.spreadsheetgear.com/)读取和写入 CSV / XLS / XLSX 并执行更多操作。

[您可以在此处](https://www.spreadsheetgear.com/downloads/register.aspx)查看带有 C# 和 VB 源代码的实时 ASP.NET 示例，并[在此处](http://www.spreadsheetgear.com/support/samples/)下载免费试用版。

当然，我认为 SpreadsheetGear 是在 ASP.NET 中导入/导出 Excel 工作簿的最佳库 - 但我有偏见。[您可以在此页面](http://www.spreadsheetgear.com/products/spreadsheetgear.net.aspx)的右侧看到我们的一些客户所说的话。

免责声明：我拥有 SpreadsheetGear LLC

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2010-02-24T08:35:23.537

NPOI For Excel 2003 开源 [http://www.leniel.net/2009/07/creating-excel-spreadsheets-xls-xlsx-c.html](http://www.leniel.net/2009/07/creating-excel-spreadsheets-xls-xlsx-c.html)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-01-14T20:33:33.840

我过去使用过[Flexcel](http://www.tmssoftware.com/site/flexcelnet.asp)，它很棒。但这更多地用于以编程方式创建和更新 Excel 工作表。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-31T04:26:42.197

CSV 导出简单、易于实施且速度快。不过，有一个潜在的问题值得注意。Excel（截至 2007 年）不保留 CSV 文件中的前导零。这将混淆邮政编码、产品 ID 和其他包含数值的文本数据。有一个技巧可以使 Excel 正确导入值（如果我没记错的话，使用带 = 符号的分隔符和前缀值，例如 ..,="02052",...）。如果您的用户将使用 CSV 执行后处理任务，他们需要注意他们需要将格式更改为 XLS，而不是将文件保存回 CSV。如果他们这样做，前导零将永远丢失。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2010-03-17T19:02:10.390

多年来，我一直为此使用[JExcel](http://jexcelapi.sourceforge.com)，这是一个出色的开源 Java 项目。通过使用 J# 编译它，它也支持 .NET，而且我在这个版本中也取得了巨大的成功。但是，最近我需要将代码迁移到本机 .NET 以支持 64 位 IIS 应用程序，我在该应用程序中创建 Excel 输出。不会加载 32 位 J# 版本。

CSharpJExcel 的代码是 LGPL，目前在[此](http://www.chrislaforetsoftware.com/products.html)页面上可用，同时我们准备在 JExcel SourceForge 站点上部署它。它将与 VS2005 或 VS2008 一起编译。原始 JExcel 文档中的示例将完好无损地转移到 .NET 版本。

希望对这里的人有所帮助。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-04-13T07:20:13.747

我已经使用 excel jetcell 很长时间了，我真的可以推荐它。 [http://www.devtriogroup.com/exceljetcell](http://www.devtriogroup.com/exceljetcell/default.aspx)

*   商业产品
*   Excel 文件 XLS 和 XLSX
*   基于纯网络中的自己的引擎。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-12-01T12:25:15.303

以下站点演示了如何将 DataTable、DataSet 或 List<> 导出到“正确的”Excel 2007 .xlsx 文件（而不是导出 .csv 文件并让 Excel 打开它）。

它使用 OpenXML 库，因此您**无需**在服务器上安装 Excel。

[Mikes 知识库 - ExportToExcel](http://www.mikesknowledgebase.com/pages/CSharp/ExportToExcel.htm)

**免费提供**所有源代码以及演示应用程序。

添加到您自己的应用程序非常容易，您只需调用一个函数，传入 Excel 文件名和您的数据源：

```
DataSet ds = CreateSampleData();
string excelFilename = "C:\\Sample.xlsx";
CreateExcelFile.CreateExcelDocument(ds, excelFilename); 
```

希望这可以帮助。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-14T20:24:15.510

检查[ExcelPackage](http://www.codeplex.com/ExcelPackage)项目，它使用 Excel 2007 的 Office Open XML 文件格式，它是轻量级和开源的......

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-05-28T17:17:47.230

您可以使用`Microsoft.Jet.OLEDB.4.0`

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-10-22T01:26:11.383

我已经尝试过 CSharpJExcel 并且不会推荐它，至少在有一些可用文档之前不会推荐。与开发人员的评论相反，它*不是*一个直接的本地端口。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2011-06-03T00:08:15.900

我知道这已经很晚了，但我不得不从[xPortTools.Net回答](http://www.xporttools.net/Default.aspx)[xPorter](http://www.xporttools.net/xPorter.aspx)（写作）和[xlReader](http://www.xporttools.net/xlReader.aspx)（阅读）。我们测试了很多库，但在性能方面没有任何东西可以接近（我在这里谈论的是在几秒钟内写入数百万行）。不能对这些产品说足够多的好话！

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-14T20:40:24.760

Yogesh Jagota 在 CodeProject 上有一篇非常好的文章和库：

[Excel XML 导入导出库](http://www.codeproject.com/KB/office/excelxmllibrary.aspx)

我用它来将数据从 SQL 查询和其他数据源导出到 Excel - 对我来说效果很好。

干杯

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-01-26T09:46:38.093

我们刚刚确定了类似的需求。我认为考虑用户体验很重要。

我们几乎走上了同样的道路：

1.  在电子表格文件中准备/工作
2.  保存存档
3.  导入文件
4.  处理系统中的数据

... 工作流程

[Add-in Express](http://www.add-in-express.com/ "插件快递")允许您在 Excel 中创建一个按钮，而无需使用 VSTO 进行繁琐的操作。那么工作流程就变成了：

1.  在电子表格文件中准备/工作
2.  导入文件（使用*Excel*中的按钮）
3.  处理系统中的数据

让按钮后面的代码使用“本机”Excel API（通过 Add-in Express）并直接推送到收件人系统。对于开发人员或用户，您无法获得更加透明的信息。值得考虑。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2012-02-24T16:21:04.430

你可以试试下面的库，它很简单，它只是微软 Open XML SDK 的一个轻量级包装器（你甚至可以重用辅助 Excel 文件中的格式、样式甚至整个工作表）： http: [//officehelper.codeplex.com](http://officehelper.codeplex.com/)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-07-20T16:35:18.213

Spreadsheetgear 是我们发现并正在使用的最好的商业图书馆。我们公司做了很多高级的 excel 导入和导出，Spreadsheetgear 支持很多高级的 excel 功能，远远超出了简单的 CSV 所能做的任何事情，而且速度很快。它不是免费的，也不是很便宜，但值得，因为支持非常好。如果您遇到问题，开发人员实际上会回复您。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-10-22T01:30:17.287

apache POI java库怎么样。我没有将它用于 Excel，但确实将它用于 Word 2007。

# sql - SQL Server 2000 - 查询表的外键关系

> ID：444523
> 
> 赞同：5
> 
> 时间：2009-01-14T20:21:32.757
> 
> 标签：sql, sql-server, database, sql-server-2000, foreign-keys

*[与查询表的外键关系](https://stackoverflow.com/questions/85978/query-a-tables-foreign-key-relationships)几乎相同，但适用于 SQL Server 2000*

对于给定的表“foo”，我需要一个查询来生成一组具有指向 foo 的外键的表。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-14T20:39:23.873

```
SELECT o2.name
FROM sysobjects o
INNER JOIN sysforeignkeys fk on o.id = fk.rkeyid
INNER JOIN sysobjects o2 on fk.fkeyid = o2.id
WHERE o.name = 'foo' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T20:31:20.147

试试这个 T-SQL：

```
select col_name(fkeyid, fkey) as column_name, object_name(rkeyid) as referenced_table_name, col_name(rkeyid, rkey) as referenced_column_name from sysforeignkeys where object_name(fkeyid) = 'tableNameHere' order by constid 
```

我稍微重写了查询，为您提供了依赖于特定表的所有其他表：

```
select object_name(fkeyid),
col_name(fkeyid, fkey) as column_name,
col_name(rkeyid, rkey) as referenced_column_name
from sysforeignkeys
where object_name(rkeyid) = 'tableNameHere'
order by constid 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T20:36:42.070

父母和孩子

```
/* this will find out all of the foreign key references for a table*/

DECLARE @tableName varchar(128)
SET @tableName = 'tCounter'

SELECT   
    pt.[name] AS 'parentTable',  
    ct.[name] AS 'childTable',  
    fk.[name] AS 'fkName', 
*   
FROM sys.foreign_keys fk        
    INNER JOIN sys.tables pt              
        ON pt.object_ID = fk.parent_object_id        
    INNER JOIN sys.tables ct              
        ON ct.object_ID = fk.referenced_object_id   
WHERE pt.name = @tableName      
    OR ct.name = @tableName   
ORDER BY pt.name, ct.name 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T20:29:31.257

从这里开始

```
 SELECT cons.TABLE_NAME
    , cons.CONSTRAINT_NAME PK_NAME
    , cols.COLUMN_NAME 
FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS cons
LEFT join INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE cols
ON cons.CONSTRAINT_NAME = cols.CONSTRAINT_NAME
WHERE cons.CONSTRAINT_TYPE = 'foreign KEY'
ORDER BY cons.TABLE_NAME
    , cons.CONSTRAINT_NAME
    , cols.COLUMN_NAME 
```

[编辑] 格式都搞砸了

[edit2] 不再

# .net - 我如何知道我的 Azure 表存储帐户名称？

> ID：444528
> 
> 赞同：9
> 
> 时间：2009-01-14T20:24:46.290
> 
> 标签：.net, azure, azure-storage

我正在尝试将 Azure 中的一些表存储从本地存储移动到云。我一直在使用“devstoreaccount1”进行本地访问，但我不确定我需要在那里放置什么才能迁移到云端。

这不是我用来注册 Azure 帐户的用户帐户，是吗？那只是我的电子邮件地址，这似乎不起作用。我也没有运气尝试过项目名称。

门户中是否有任何地方列出了此帐户名称？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T21:54:10.697

据我了解，帐户名称用于构建指向您的存储的 URL，因此唯一真正的标准是名称必须是唯一的，并且必须解析为有效的 url。例如，如果您在 ServiceConfiguration.cscfg 文件中输入帐户名称“hotsauce”，则存储路径将解析为：

[http://hotsauce.table.core.windows.net](http://hotsauce.table.core.windows.net)

由于“devstoreaccount1”是他们在动手实验中给你的价值，我猜很久以前有人声称过这个名字。我还没有看到任何正式的东西，但我认为这是一场“获胜的第一场”比赛。您的电子邮件地址也可能不起作用，因为 URL 格式错误。

我刚刚在每个项目中使用了我的帐户名称的变体。它是字母和数字的简单组合。

考虑到 Azure 还处于早期阶段，我发现文档非常好，但仍然存在一些歧义。这是提到帐户名称的内容：

[http://msdn.microsoft.com/en-us/library/dd179360.aspx](http://msdn.microsoft.com/en-us/library/dd179360.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-12-23T04:06:33.473

转到[https://windows.azure.com](https://windows.azure.com)并登录。

如果您列出了一个项目，请单击它。

您应该看到您的项目。带有硬盘图标的项目名称就是你的存储项目你

较早创建。这是您的“帐户名称”。

单击您的存储项目。

您现在应该会看到一个“云存储”部分，其中列出了一些端点、一个主访问密钥和一个

辅助访问密钥。主要和次要访问密钥是您的密钥，您可以使用其中任何一个。

如果您需要创建项目，请执行以下操作：

单击新服务链接

选择存储帐户

输入存储帐户的服务标签和描述，例如 myappstorage，然后单击下一步。

为您的存储帐户输入一个公共名称，可以是 [appname]storage 或任何您喜欢的名称。你可以检查

这里的可用性很方便。这将作为您的“帐户名称”。点击创建完成

过程。

享受！

# php - MySQL日期/时间计算

> ID：444544
> 
> 赞同：1
> 
> 时间：2009-01-14T20:31:55.980
> 
> 标签：php, mysql, datetime

我的mysql表中有一个`date`和`time`列，分别称为`start_date`和`start_time`。我希望我的用户能够为自己设置提醒，以便在 X 小时前发送`start_time`，分钟。1 小时，最长 24 小时。

我将运行一个 CRON 脚本来发送这些提醒。现在我做：

```
SELECT * FROM auctions WHERE start_date=CURDATE() AND status='0' 
```

获得所有将于今天开始但尚未开始的拍卖。我的问题是，我怎样才能知道现在的时间是否`X`早于几个小时，如果是`start_time`，我可以向他们发送提醒。

有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T20:35:33.367

像这样的东西：

```
SELECT col1, col2, col3 
FROM records 
WHERE (records.startDate BETWEEN NOW() AND ADDDATE(NOW(), INTERVAL 9 HOUR)) 
AND (records.status = '0'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T20:41:46.803

有什么理由不能只使用一个简单的时间戳字段而不是一个日期和一个时间。这样你就可以找到所有在接下来的 5 小时内开始的（比如说），通过

```
select * from auctions where start_ts between now() and now() + interval '5 hours'; 
```

注意：间隔语法在数据库之间略有不同，这是 postgresql 的语法，因此您可能需要对 mysql 稍作更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T22:26:21.070

在发送所有答案并开始工作之前，我实际上是这样做的。因为我在最后期限，我不能回去改变它:)

```
$sql="SELECT HOUR(ADDTIME(CURTIME(),'$hour')) as remindHour, HOUR(CURTIME()) as curHour";
$result=$this->db->query($sql);

extract($result->getAllSingle());

if ($remindHour <=$curHour) {
    // Send reminders
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T20:54:39.773

你可以使用unixtime来节省时间吗？

由于 PHP 有一个很棒的函数叫做[strtotime](http://is.php.net/manual/en/function.strtotime.php)。

在里面可以说。strtotime("+20 hours") 并获取从现在起 20 小时的 unixtime。

那么它只是哪个字段大于另一个的问题，如果是，则发送通知。

# rest - RESTful 多次更新（例如：清除购物车）？

> ID：444545
> 
> 赞同：6
> 
> 时间：2009-01-14T20:32:29.100
> 
> 标签：rest, shopping-cart

假设我有一个具有“购物车”功能的在线商店，我想以 RESTful 方式实现“空购物车”链接。

为简单起见，假设我的资源是一个包含 CartItems 的 Cart，每个 CartItems 都有一个 Product。我的 URI 可能是：

```
# 将产品添加到当前用户的购物车
发布 /products/product_id/cart_items/

# 从当前用户的购物车中删除一个产品
删除 /cart_items/cart_item_id/

```

如果是这样，“空购物车”链接的 RESTful URI 会是什么样子？

相反，我可以将购物车视为操作的通用持有者（[如此处所述](https://stackoverflow.com/questions/411462/restful-way-to-create-multiple-items-in-one-request)）：

```
# 添加一个产品
# 表单数据包含例如 product_id=123&action=add
发布 /carts/cart_id/actions/

# 删除一个产品
# action_id 是添加产品 123 的操作的 id
删除操作/action_id

＃ 空购物车
# 表单数据包含 action=clear
发布 /carts/cart_id/actions/

```

这种方法似乎比它需要的更复杂。有什么更好的方法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-14T20:41:04.993

不要做第二种方法。通过一个端点进行不同的汇集`actions`不会让人感觉 RESTful IMO。

你已经从他们的购物车`DELETE /cart_items/cart_item_id/`中删除`cart_item_id`了。如何`DELETE /cart_items/`清理购物车本身？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-17T11:15:31.907

将商品添加到购物车：

`POST carts/{cartid}/items`

从购物车中检索特定商品：

`GET carts/{cartid}/items/{itemid}`

从购物车中删除特定商品：

`DELETE carts/{cartid}/items/{itemid}`

获取购物车的状态：

`GET carts/{cartid}/state`

（可以返回一个类似 0,1 的值，表示购物车中的商品数量）

清空购物车：

`PUT carts/{cartid}/state?state=0`

这看起来很直观吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T20:59:11.947

`DELETE /cart_items/`是一个有趣的想法，[这里也讨论过](http://dev.rubyonrails.org/ticket/11022)。

# database - 如何为未知数量的“元”数据设计数据库

> ID：444554
> 
> 赞同：2
> 
> 时间：2009-01-14T20:34:54.337
> 
> 标签：database, database-design, schema, entity-attribute-value

我想将某些项目存储在具有可变数量属性的数据库中。

例如：

一个项目可以有 'url' 和 'pdf' 属性，其他的都没有，而是有 'image' 和 'location' 属性。

所以问题是一些项目可以有一些属性，而另一些则很多。

你将如何设计这个数据库。如何使其可搜索和高性能？

架构会是什么样子？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-14T20:43:50.527

您所追求的有一个名称 -[实体属性值 (EAV)](http://en.wikipedia.org/wiki/Entity-Attribute-Value_model)。它是*“一种数据模型，用于描述事物（“实体”或“对象”）的属性（属性、参数）的数量可能非常庞大，但实际上将适用于给定实体是相对适度的。”*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T21:36:28.690

如果您不一定与 SQL 相关联，那么[三重存储](http://en.wikipedia.org/wiki/Triple_Store)就是专为这项任务而设计的。大多数都设计为使用[SPARQL](http://en.wikipedia.org/wiki/Sparql)查询语言进行查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T20:58:16.503

这听起来像是文档数据库的完美工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T20:40:29.597

从您的对象（项目）开始并为项目创建一个表。您的商品可以有 1 个或多个属性，或者根本没有？因此，设置一个具有唯一 ID 的属性表。现在设置一个包含许多项目（有些可以重复）和许多属性（也可以重复）的表

**物品**

物品编号

商品描述 ...

**属性**

属性ID

属性描述...

**物品属性**

行ID

物品编号

属性ID

现在，当您想要查询时，您可以简单地加入表并过滤您想要的...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T09:26:49.747

实体属性值 (EAV) 模型非常灵活。语义网及其查询语言 sparql 也是基于 EAV。但是有些人不喜欢它，因为这种模型存在性能损失。

首先对数据库进行一些高负载性能测试。完成编码后不要这样做，因为那时为时已晚。

**编辑：**关注您选择语句的速度。用户在搜索时期望快速的结果。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-14T20:39:11.427

我过去曾设计过这样的表格，其中包含以下字段：

1.  ID
2.  类型
3.  亚型
4.  价值

然后我会有另一个表来定义使用的类型和子类型，并可能给出该类型和子类型组合的数据类型，以便您可以以编程方式强制执行它。

它不漂亮，除非你必须这样做，否则你不想这样做。但这是我发现的最好方法。

更新：即使您将子类型留空，我也觉得拥有它是一件好事，因为您经常想要对已经存在的东西进行子分类。您创建类型的示例：地址，现在您需要邮寄地址和帐单地址以及实际地址。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-14T21:49:04.887

对于这种情况，我使用 MS SQL 2005 中的 XML 类型列...您将拥有 XML + SQL 的所有优点。即使用 XPath 表达式作为 SQL 语句的一部分。

这是 MS SQL 2005 的一个特性，我不确定还有哪些其他 RDBMS 支持这个。我不确定性能方面的含义是什么。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-01-14T20:37:22.380

创建一个包含以下字段的属性表：

item_id int（或项目表中的任何 ID 类型） property_name varchar(500) property_value varchar(500)

在 item_id 和 item 的 id 字段之间设置一个外键，就完成了。

这就是在 SQL 中建立多对一关系的方式。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-01-14T20:39:28.447

看起来像一个带有主键“item_id”的“items”表，一个带有主键“property_id”的“properties”表和一个带有“items”表的外键“item_id”。“属性”将包含“名称”和“值”列，均为 varchar 类型。

表现？不知道。

# java - 向 Java 程序员解释 Objective-C 委托

> ID：444558
> 
> 赞同：9
> 
> 时间：2009-01-14T20:35:28.313
> 
> 标签：java, objective-c, delegation

我对 Objective-C 相当陌生，但在 Java 方面经验丰富。Java中是否有Objective-C“委托”的等效概念，以便我可以更好地理解这个概念？有没有办法在 Java 中模拟委托概念？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-14T21:13:13.027

委托只是一种避免像表视图这样的对象子类化来实现应用程序特定行为的方法，而是将责任放在控制器上。当您创建表视图时，您为其分配了一个控制器对象，该对象实现了一组定义的方法（一些可能是必需的，其他可能是可选的）。当表视图需要数据或必须决定如何显示自己时，它会询问委托是否实现了适当的方法，如果实现则调用它来做出决定。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-10-20T22:57:14.473

Here's a way to think of a delegate - in the OOP typical example, I have a car object. I don't want to ever subclass it again, I just want to use it as is, so how do I make it act like a chevy or a mustang? I give it a delegate.

My car would have methods to drive, methods to honk, etc.

My delegate would have methods like "what's my top speed" and "what does the horn sounds like" and "are my windows tinted"

So when I call -drive on my car object, (which isn't subclassed) that method calls my delegate's topSpeed method, and the delegate tells it 120mph, so the car knows how fast it should go without having to be a mustang.

in Objective C there's usually a protocol that defines what a delegate should respond to, i.e. for my car object's delegate there would be a protocol declared like this:

```
 @protocol carDelegate

 -(int)carTopSpeed;
 -(UIColor*)carColor;
 -(BodyShape*)carBodyShape;
 -(DragCoefficient*)carDragCoefficient;
 -(HoodOrnament*)carHoodOrnament     

 @optional
 -(BOOL)windowsTinted;

 @end 
```

Then you can make your own object that conforms to this protocol (implements all the required methods, and any optional ones that are seen as needed)

And the car object would expect an (id) to be passed to it as a delegate.

Then the car object has managed to avoid being subclassed, and still can behave according to the user's needs.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-14T21:18:21.767

[`java.lang.reflect.Proxy`](http://java.sun.com/developer/technicalArticles/JavaLP/Interposing/)是java中最接近的等价物。虽然使用起来很乏味。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-14T20:46:55.997

委托是一种面向对象的设计模式。Wikipedia 上有一个 Java 示例：[委托模式](http://en.wikipedia.org/wiki/Delegation_pattern)

# macos - 我如何判断一个文件或文件夹是否正忙，例如 Finder 正忙于复制到它？

> ID：444561
> 
> 赞同：5
> 
> 时间：2009-01-14T20:35:38.140
> 
> 标签：macos

我试过了：

1.  检查`FSCatalogInfo` `nodeFlags`以查看是否`kFSNodeForkOpenBit`已设置（使用`kFSNodeForkOpenMask`）。

2.  检查创建者代码是否介于`kFirstMagicBusyFiletype`和之间`kLastMagicBusyFiletype`。

3.  检查`ExtendedFileInfo` `extendedFinderFlags`以查看是否`kExtendedFlagObjectIsBusy`已设置。

4.  `GetFileInfo -ab`从外壳运行。

所有这些都报告 Finder 正在复制到的文件*未*打开。

Using`lsof`确实检测到文件已打开，但是（a）我不想`lsof`从我的应用程序中调用，并且（b）我的理解是它依赖于私有 API，因此查看其源代码无济于事。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-01-08T13:13:42.427

现在对你来说已经晚了大约 2 年，但我想为了以后有人发现这个，我会注意你可以检查文件的创建日期。Finder 在复制时将其设置为 kMagicBusyCreationDate (1946-02-14 08:34:56 +0000)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-12T04:41:35.577

# 档案业务

在 Mac OS X v10.4 及更高版本中：

*   [NSFileBusy](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsfilemanager_Class/Reference/Reference.html#//apple_ref/doc/c_ref/NSFileBusy)。

# 查找器和数据完整性

虽然 Finder 会处理文件的副本（而不是之后），但该副本具有：

*   HFS 类型代码`brok`
*   HFS 创建者代码`MACS`

——这两件事加在一起就意味着**文件业务**。

`MACS`是[Finder 的 ID](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/Mac__Apps__Launch5.8.9.3pm.html)。

## 如果副本是到不支持属性的文件系统，例如

虽然 Finder 处理文件的副本（而不是之后），但该副本有一个副本：

*   `._`包含必要扩展属性 (xattr)的点下划线文件。

### 有关的

[为什么要创建点下划线 ._ 文件，如何避免它们？](https://apple.stackexchange.com/q/14980/8546)— 问不同

## Finder 与各种文件系统和操作系统的兼容性

如果使用 Finder 的副本被不恰当地中断，`brok` `MACS`则应确保**损坏/业务的存在可识别**为：

*   所有版本的 OS X
*   所有版本的 Mac OS X
*   Mac OS 9 和一些早期经典版本的操作系统。

## 例子

没有扩展属性的文件`big file.dmg`。

在从 JHFS+ 复制到`example`使用 MS-DOS (FAT32) 的卷上的空目录之前：

```
[macbookpro08:~] gjp22% date
Fri 11 May 2012 17:24:29 BST
[macbookpro08:~] gjp22% ls -h@al /Users/gjp22/Documents/uk/ac/brighton/collaborate/bigfile.dmg
-rw-r--r--  1 gjp22  staff   1.4G 11 May 17:20 /Users/gjp22/Documents/uk/ac/brighton/collaborate/bigfile.dmg
[macbookpro08:~] gjp22% xattr /Users/gjp22/Documents/uk/ac/brighton/collaborate/bigfile.dmg
[macbookpro08:~] gjp22% diskutil list | grep FAT32
   1:                 DOS_FAT_32 FAT32                   2.0 GB     disk3s1
[macbookpro08:~] gjp22% ls -h@al /Volumes/FAT32/example 
total 16
drwxrwxrwx  1 gjp22  staff   4.0K 11 May 17:24 .
drwxrwxrwx  1 gjp22  staff   4.0K 11 May 11:32 .. 
```

### 使用 Finder 开始复制后，完成前

`brokMACS`在扩展属性的值内`com.apple.FinderInfo`：

```
[macbookpro08:~] gjp22% date
Fri 11 May 2012 17:25:08 BST
[macbookpro08:~] gjp22% ls -h@al /Volumes/FAT32/example
total 311320
drwxrwxrwx  1 gjp22  staff   4.0K 11 May 17:25 .
drwxrwxrwx  1 gjp22  staff   4.0K 11 May 11:32 ..
-rwxrwxrwx  1 gjp22  staff   4.0K 11 May 17:25 ._bigfile.dmg
-rwxrwxrwx@ 1 gjp22  staff   152M 11 May 17:25 bigfile.dmg
    com.apple.FinderInfo      32B 
[macbookpro08:~] gjp22% xattr -l /Volumes/FAT32/example/bigfile.dmg
com.apple.FinderInfo:
00000000  62 72 6F 6B 4D 41 43 53 00 00 00 00 00 00 00 00  |brokMACS........|
00000010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  |................|
00000020 
```

### Finder成功完成复制后

该扩展属性被删除：

```
[macbookpro08:~] gjp22% date
Fri 11 May 2012 17:29:19 BST
[macbookpro08:~] gjp22% xattr -l /Volumes/FAT32/example/bigfile.dmg
[macbookpro08:~] gjp22% ls -h@al /Volumes/FAT32/example
total 3000016
drwxrwxrwx  1 gjp22  staff   4.0K 11 May 17:29 .
drwxrwxrwx  1 gjp22  staff   4.0K 11 May 11:32 ..
-rwxrwxrwx  1 gjp22  staff   1.4G 11 May 17:20 bigfile.dmg 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-11T01:35:22.597

在我看来，部分复制的文件的文件类型为“brok”，创建者代码为“MACS”。

我不相信 Finder 会以任何方式标记它正在制作的文件夹副本。“灰显”表示严格限于进行复制的 Finder 进程。您可以在复制文件夹时使用快速用户切换来验证这一点：作为不同的用户，正在复制的文件夹在 Finder 中具有正常外观，您可以打开它并观察子文件和文件夹的出现。Finder 似乎也没有通过 AppleScript 显示有关文件夹的任何差异，我想不出任何其他方式来获取该信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T14:20:44.953

这种方法可能有点笨拙，但我已经将它用于类似目的，它可能对你有用。基本思路是尝试使用排他锁打开文件，检查打开是否成功，然后立即再次关闭。所以，这看起来像：

```
char* pathToFile;
int result;

result = open(pathToFile, O_RDWR | O_NONBLOCK | O_EXLOCK);
if (result != -1)
{
    //The file is not busy
    close(result);
}
else
{
    //The file is busy
} 
```

我从来没有尝试过使用 Finder 复制的文件，但是当系统上的另一个应用程序打开文件时它确实有效。如果您以只读方式而不是读/写方式打开它，我不确定同样的方法是否有效，因此根据您的要求，这可能是另一个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T17:36:28.363

我不知道确切的答案，但是......在 POSIX 和 Carbon 文件管理器 API 下方，还有另一个层被两者使用。它非常接近 VFS，并且使用所有小写的名称。当您使用命令“fs_usage”IIRC 跟踪 FS 调用时，您会看到这些调用。您可能会在这些调用中找到有效的功能。不幸的是，它们没有很好的记录。希望有帮助。

# delphi - 如何在使用 Delphi 制作的 OCX 中添加图标，使其在 VB 中可见？

> ID：444562
> 
> 赞同：3
> 
> 时间：2009-01-14T20:36:21.307
> 
> 标签：delphi, vb6, icons, delphi-2007, ocx

我用Delphi 2007做了一个OCX。现在我的客户声称他安装这个OCX时他的VB中没有图标。

如何将这样的图标添加到我的 OCX？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T21:42:08.973

根据[这个旧页面，在 ActiveX 控件单元的初始化部分中的](http://pw1.netcom.com/~cherrman/dl030.htm)[TActiveXControlFactory](http://docs.codegear.com/docs/radstudio/radstudio2007/RS2007_helpupdates/HUpdate3/EN/html/delphivclwin32/AxCtrls_TActiveXControlFactory_Create.html)的构造函数有一个名为 ToolbarBitmapID 的参数，它是位图的资源 id。这就是您设置图标的方式。

# python - 如何将一串字节转换为int？

> ID：444591
> 
> 赞同：164
> 
> 时间：2009-01-14T20:46:17.777
> 
> 标签：python, arrays, string

如何在python中将一串字节转换为int？

像这样说：`'y\xcc\xa6\xbb'`

我想出了一个聪明/愚蠢的方法：

```
sum(ord(c) << (i * 8) for i, c in enumerate('y\xcc\xa6\xbb'[::-1])) 
```

我知道必须有一些内置的或标准库中的东西可以更简单地做到这一点......

这与[转换可以使用 int(xxx, 16) 的十六进制数字字符串](https://stackoverflow.com/questions/209513/convert-hex-string-to-int-in-python)不同，但我想转换实际字节值的字符串。

更新：

我有点喜欢 James 的回答，因为它不需要导入另一个模块，但 Greg 的方法更快：

```
>>> from timeit import Timer
>>> Timer('struct.unpack("<L", "y\xcc\xa6\xbb")[0]', 'import struct').timeit()
0.36242198944091797
>>> Timer("int('y\xcc\xa6\xbb'.encode('hex'), 16)").timeit()
1.1432669162750244 
```

我的hacky方法：

```
>>> Timer("sum(ord(c) << (i * 8) for i, c in enumerate('y\xcc\xa6\xbb'[::-1]))").timeit()
2.8819329738616943 
```

进一步更新：

有人在评论中询问导入另一个模块有什么问题。好吧，导入一个模块并不一定便宜，看看：

```
>>> Timer("""import struct\nstruct.unpack(">L", "y\xcc\xa6\xbb")[0]""").timeit()
0.98822188377380371 
```

包括导入模块的成本几乎抵消了这种方法的所有优势。我相信这只会包括在整个基准测试运行中导入一次的费用；看看当我每次强制它重新加载时会发生什么：

```
>>> Timer("""reload(struct)\nstruct.unpack(">L", "y\xcc\xa6\xbb")[0]""", 'import struct').timeit()
68.474128007888794 
```

不用说，如果您在每次导入时执行大量此方法，那么这将成为一个不成比例的问题。它也可能是 i/o 成本而不是 cpu，因此它可能取决于特定机器的容量和负载特性。

* * *

## 回答 #1

> 赞同：342
> 
> 时间：2012-03-09T12:56:38.400

在 Python 3.2 及更高版本中，使用

```
>>> int.from_bytes(b'y\xcc\xa6\xbb', byteorder='big')
2043455163 
```

或者

```
>>> int.from_bytes(b'y\xcc\xa6\xbb', byteorder='little')
3148270713 
```

根据您的字节串的[字节序。](https://en.wikipedia.org/wiki/Endianness)

这也适用于任意长度的字节串整数，以及通过指定`signed=True`. 请[参阅`from_bytes`](http://docs.python.org/dev/library/stdtypes.html#int.from_bytes).

* * *

## 回答 #2

> 赞同：111
> 
> 时间：2009-01-14T20:52:39.247

您还可以使用[struct](https://docs.python.org/3.6/library/struct.html)模块来执行此操作：

```
>>> struct.unpack("<L", "y\xcc\xa6\xbb")[0]
3148270713L 
```

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2009-01-14T21:42:52.530

正如格雷格所说，如果您正在处理二进制值，则可以使用 struct ，但如果您只有一个“十六进制数”但采用字节格式，您可能只想将其转换为：

```
s = 'y\xcc\xa6\xbb'
num = int(s.encode('hex'), 16) 
```

...这与：

```
num = struct.unpack(">L", s)[0] 
```

...除了它适用于任意数量的字节。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-04-10T06:35:06.560

我使用以下函数在 int、hex 和 bytes 之间转换数据。

```
def bytes2int(str):
 return int(str.encode('hex'), 16)

def bytes2hex(str):
 return '0x'+str.encode('hex')

def int2bytes(i):
 h = int2hex(i)
 return hex2bytes(h)

def int2hex(i):
 return hex(i)

def hex2int(h):
 if len(h) > 1 and h[0:2] == '0x':
  h = h[2:]

 if len(h) % 2:
  h = "0" + h

 return int(h, 16)

def hex2bytes(h):
 if len(h) > 1 and h[0:2] == '0x':
  h = h[2:]

 if len(h) % 2:
  h = "0" + h

 return h.decode('hex') 
```

资料来源： http: [//opentechnotes.blogspot.com.au/2014/04/convert-values-to-from-integer-hex.html](http://opentechnotes.blogspot.com.au/2014/04/convert-values-to-from-integer-hex.html)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-14T21:55:37.200

```
import array
integerValue = array.array("I", 'y\xcc\xa6\xbb')[0] 
```

警告：以上内容是特定于平台的。"I" 说明符和 string->int 转换的字节顺序都取决于您特定的 Python 实现。但是，如果您想一次转换多个整数/字符串，那么数组模块可以快速完成。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-08-14T02:03:23.257

在 Python 2.x 中，您可以将格式说明符`<B`用于无符号字节，并`<b`使用`struct.unpack`/用于有符号字节`struct.pack`。

例如：

让`x`=`'\xff\x10\x11'`

```
data_ints = struct.unpack('<' + 'B'*len(x), x) # [255, 16, 17] 
```

和：

```
data_bytes = struct.pack('<' + 'B'*len(data_ints), *data_ints) # '\xff\x10\x11' 
```

*这`*`是必需的！*

看[https://docs.python.org/2/library/struct.html#format-characters](https://docs.python.org/2/library/struct.html#format-characters)获取格式说明符列表。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-09-26T21:58:58.663

```
>>> reduce(lambda s, x: s*256 + x, bytearray("y\xcc\xa6\xbb"))
2043455163 
```

测试1：逆：

```
>>> hex(2043455163)
'0x79cca6bb' 
```

测试 2：字节数 > 8：

```
>>> reduce(lambda s, x: s*256 + x, bytearray("AAAAAAAAAAAAAAA"))
338822822454978555838225329091068225L 
```

测试 3：加一：

```
>>> reduce(lambda s, x: s*256 + x, bytearray("AAAAAAAAAAAAAAB"))
338822822454978555838225329091068226L 
```

测试 4：附加一个字节，例如“A”：

```
>>> reduce(lambda s, x: s*256 + x, bytearray("AAAAAAAAAAAAAABA"))
86738642548474510294585684247313465921L 
```

测试 5：除以 256：

```
>>> reduce(lambda s, x: s*256 + x, bytearray("AAAAAAAAAAAAAABA"))/256
338822822454978555838225329091068226L 
```

正如预期的那样，结果等于测试 4 的结果。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-11-07T17:27:15.753

我一直在努力寻找可以在 Python 2.x 下工作的任意长度字节序列的解决方案。最后我写了这个，它有点hacky，因为它执行字符串转换，但它有效。

# Python 2.x 的函数，任意长度

```
def signedbytes(data):
    """Convert a bytearray into an integer, considering the first bit as
    sign. The data must be big-endian."""
    negative = data[0] & 0x80 > 0

    if negative:
        inverted = bytearray(~d % 256 for d in data)
        return -signedbytes(inverted) - 1

    encoded = str(data).encode('hex')
    return int(encoded, 16) 
```

这个函数有两个要求：

*   输入`data`必须是`bytearray`. 你可以这样调用函数：

    ```
    s = 'y\xcc\xa6\xbb'
    n = signedbytes(s) 
    ```

*   数据需要是大端的。如果你有一个 little-endian 值，你应该先反转它：

    ```
    n = signedbytes(s[::-1]) 
    ```

当然，只有在需要任意长度时才应该使用它。否则，请坚持使用更标准的方式（例如`struct`）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-02-25T17:30:35.090

如果您的版本 >=3.2，int.from_bytes 是最好的解决方案。“struct.unpack”解决方案需要一个字符串，因此它不适用于字节数组。这是另一个解决方案：

```
def bytes2int( tb, order='big'):
    if order == 'big': seq=[0,1,2,3]
    elif order == 'little': seq=[3,2,1,0]
    i = 0
    for j in seq: i = (i<<8)+tb[j]
    return i 
```

十六进制（bytes2int（[0x87，0x65，0x43，0x21]））返回“0x87654321”。

它处理大端和小端，并且很容易修改为 8 个字节

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-01-27T09:34:47.483

如上所述，使用**struct**`unpack`的函数是一个好方法。如果您想实现自己的功能，还有另一种解决方案：

 **```
def bytes_to_int(bytes):
    result = 0
    for b in bytes:
        result = result * 256 + int(b)
return result 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-09-05T22:16:20.413

在 python 3 中，您可以通过以下方式轻松地将字节字符串转换为整数列表 (0..255)

```
>>> list(b'y\xcc\xa6\xbb')
[121, 204, 166, 187] 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-06-03T17:04:37.023

使用 array.array 的一种相当快速的方法，我已经使用了一段时间：

预定义变量：

```
offset = 0
size = 4
big = True # endian
arr = array('B')
arr.fromstring("\x00\x00\xff\x00") # 5 bytes (encoding issues) [0, 0, 195, 191, 0] 
```

到 int：（阅读）

```
val = 0
for v in arr[offset:offset+size][::pow(-1,not big)]: val = (val<<8)|v 
```

来自 int：（写）

```
val = 16384
arr[offset:offset+size] = \
    array('B',((val>>(i<<3))&255 for i in range(size)))[::pow(-1,not big)] 
```

不过，这些可能会更快。

编辑：
对于某些数字，这是一个性能测试（Anaconda 2.3.0），显示与读取相比的稳定平均值`reduce()`：

```
========================= byte array to int.py =========================
5000 iterations; threshold of min + 5000ns:
______________________________________code___|_______min______|_______max______|_______avg______|_efficiency
⣿⠀⠀⠀⠀⡇⢀⡀⠀⠀⠀⠀⠀⠀⡇⠀⠀⠀⡀⠀⢰⠀⠀⠀⢰⠀⠀⠀⢸⠀⠀⢀⡇⠀⢀⠀⠀⠀⠀⢠⠀⠀⠀⠀⢰⠀⠀⠀⢸⡀⠀⠀⠀⢸⠀⡇⠀⠀⢠⠀⢰⠀⢸⠀
⣿⣦⣴⣰⣦⣿⣾⣧⣤⣷⣦⣤⣶⣾⣿⣦⣼⣶⣷⣶⣸⣴⣤⣀⣾⣾⣄⣤⣾⡆⣾⣿⣿⣶⣾⣾⣶⣿⣤⣾⣤⣤⣴⣼⣾⣼⣴⣤⣼⣷⣆⣴⣴⣿⣾⣷⣧⣶⣼⣴⣿⣶⣿⣶
    val = 0 \nfor v in arr: val = (val<<8)|v |     5373.848ns |   850009.965ns |     ~8649.64ns |  62.128%
⡇⠀⠀⢀⠀⠀⠀⡇⠀⡇⠀⠀⣠⠀⣿⠀⠀⠀⠀⡀⠀⠀⡆⠀⡆⢰⠀⠀⡆⠀⡄⠀⠀⠀⢠⢀⣼⠀⠀⡇⣠⣸⣤⡇⠀⡆⢸⠀⠀⠀⠀⢠⠀⢠⣿⠀⠀⢠⠀⠀⢸⢠⠀⡀
⣧⣶⣶⣾⣶⣷⣴⣿⣾⡇⣤⣶⣿⣸⣿⣶⣶⣶⣶⣧⣷⣼⣷⣷⣷⣿⣦⣴⣧⣄⣷⣠⣷⣶⣾⣸⣿⣶⣶⣷⣿⣿⣿⣷⣧⣷⣼⣦⣶⣾⣿⣾⣼⣿⣿⣶⣶⣼⣦⣼⣾⣿⣶⣷
                  val = reduce( shift, arr ) |     6489.921ns |  5094212.014ns |   ~12040.269ns |  53.902% 
```

这是一个原始性能测试，因此忽略了字节序翻转。
显示的`shift`函数应用与 for 循环相同的移位或运算操作，并且它具有`arr`仅次于`array.array('B',[0,0,255,0])`的最快迭代性能`dict`。

我可能还应该注意效率是通过平均时间的准确性来衡量的。

# apache - mod_rewrite 规则和内容协商

> ID：444592
> 
> 赞同：0
> 
> 时间：2009-01-14T20:46:24.343
> 
> 标签：apache, mod-rewrite, content-negotiation

我对 mod_rewrite 比较陌生，但是有一个我想拥有“漂亮网址”的网站。类似于SO :)。

我试图有这样的事情：“ [http://www.whatever.com/search/test](http://www.whatever.com/search/test) ”被重写为“ [http://www.whatever.com/search.php?q=test](http://www.whatever.com/search.php?q=test) ”并且有一些限制成功。我相信内容谈判正在妨碍我……

对于初学者，这是我的测试 .htaccess 文件：

```
RewriteEngine on
RewriteBase /~user/mysite/

RewriteRule ^search$ search/ [R]
RewriteRule ^search/([^/]*)/?$ search.php?q=$1 [L] 
```

不幸的是，*它确实*重定向到了 search.php，但没有在 q 变量中传递我的参数。但是，这*确实*有效：

```
RewriteEngine on
RewriteBase /~user/mysite/

RewriteRule ^search$ search/ [R]
RewriteRule ^search/([^/]*)/?$ s.php?q=$1 [L] # here i've renamed the search.php to s.php to dodge the content negotiation that is happening.. 
```

事实上，如果我一起删除所有规则，我会得到与文件的第一个版本相同的结果。所以我的结论是，即使没有任何 mod_rewrite 规则，apache 也很乐意将“foo”重定向到“foo.php”，因此必须是内容协商在处理它。（如果我将我的 foo.php 重命名为 foo.html，这进一步证实了这一点，如果我只是转到“foo”，它仍然会找到该文件）。

所以，问题是。如何正确使用 mod_rewrite 进行内容协商？我可以为特定文件禁用它吗？有没有办法确保我的 mod_rewrite 规则在内容协商发生之前发生？

如果相关，这里是我的 apache conf 的 mod_userdir 部分的 conf 文件（这个测试站点在我用户的 homedir/public_html 中）：

```
# Settings for user home directories

<IfDefine USERDIR>
<IfModule userdir_module>

# UserDir: The name of the directory that is appended onto a user's home
# directory if a ~user request is received.  Note that you must also set
# the default access control for these directories, as in the example below.
UserDir public_html

# Control access to UserDir directories.  The following is an example
# for a site where these directories are restricted to read-only.
<Directory /home/*/public_html>
    AllowOverride FileInfo AuthConfig Limit Indexes
    Options MultiViews Indexes SymLinksIfOwnerMatch IncludesNoExec
    <Limit GET POST OPTIONS>
        Order allow,deny
        Allow from all
    </Limit>
    <LimitExcept GET POST OPTIONS>
        Order deny,allow
        Deny from all
    </LimitExcept>
</Directory>

# Suexec isn't really required to run cgi-scripts, but it's a really good
# idea if you have multiple users serving websites...
<IfDefine SUEXEC>
<IfModule suexec_module>
<Directory /home/*/public_html/cgi-bin>
    Options ExecCGI
    SetHandler cgi-script
</Directory>
</IfModule>
</IfDefine>

</IfModule>
</IfDefine> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T20:53:09.197

在您的配置中查找此选项。

```
Options +Multiviews 
```

它会寻找

```
/foo/test
/foo/
/foo 
```

并将它们重定向到

```
/foo.[any file] 
```

基于它是否存在以及它是否符合请求的内容类型。

将此选项更改为禁用此选项。

```
Options -Multiviews 
```

# ios - iPhone SDK：从按钮播放单个 WAV

> ID：444595
> 
> 赞同：3
> 
> 时间：2009-01-14T20:46:57.027
> 
> 标签：ios, objective-c, avaudioplayer, wav

我目前正在尝试这段代码：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"dream" ofType:@"m4a"];  
AVAudioPlayer* theAudio=[[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath:path] error:NULL];  
theAudio.delegate = self;  
[theAudio play]; 
```

但是，SDK 说 ViewController 没有实现 AVAudioPlayer Delegate。

关于如何使用 2.2 SDK 播放 WAV（或 M4a）的任何想法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-14T20:49:54.993

您需要`<AVAudioPlayerDelegate>`按照以下几行添加到控制器类声明的末尾：

```
@interface MyViewController : UIViewController <AVAudioPlayerDelegate>

```

这可能会产生更多关于您需要实现的委托方法的警告 - 遵循这些，您会很高兴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T21:00:20.570

有趣的。尝试`NSURL -URLWithString:`- 这就是我与您正在使用的捆绑方法结合使用的方法。除此之外，我没有看到任何可能导致问题的东西。您正在设备上对其进行测试，对吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-01T05:01:10.063

[我在这里发布](https://stackoverflow.com/questions/6195581/latency-between-different-sounds-in-iphone-application/6196472#6196472)的答案肯定会对您有所帮助。只需将音频服务用于小波声音，除非您需要并发，否则它会更快。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-27T17:14:51.437

iPhoneToot.com 有自己的 itootSound 类和一个 VIDEO，向您展示如何用 2 行代码播放 wav 文件。在 iPhoneToot.com 上查看它们。如果不是几天的时间，它将为您节省数小时！

# c# - 发布版本不可用 WPF

> ID：444596
> 
> 赞同：1
> 
> 时间：2009-01-14T20:47:07.510
> 
> 标签：c#, wpf, visual-studio-2008, build, release

我正在编写一个相当简单的 WPF 桌面应用程序，并且在构建\配置管理器下，发布不是一个选项。唯一可用的选项是调试、新建和编辑。

有人知道这是为什么吗？

相关：同一解决方案中的控件库确实将发布作为构建选项。它仅在 wpf 应用程序中丢失。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T20:51:48.983

我想到了。

为了修复，我将发布版本的属性组标签从另一个项目中的 xml 复制到缺少它的项目中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T18:36:47.910

propertygroup 标签的东西确实解决了这个问题。

1）在记事本中打开您的项目文件。

2）在“调试”属性组标记之后粘贴：

```
<PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
</PropertyGroup> 
```

# apache - 为什么 Apache 会对我的查询字符串进行 URL 解码？

> ID：444599
> 
> 赞同：3
> 
> 时间：2009-01-14T20:47:51.080
> 
> 标签：apache, cgi, query-string, urldecode

我的网络主机拒绝帮助我解决这个问题，所以我来这里寻求一些“黑盒调试”的帮助。这是我发送给他们的内容的编辑版本：

我在 dreamhost 有两个（除其他外）域：

1) thefigtrees.net 2) shouldivoteformccain.com

我今天注意到，当我在 #1 上托管 CGI 脚本时，当 CGI 脚本运行时，作为 QUERY_STRING 环境变量传递给它的 HTTP GET 查询字符串已经被 URL 解码。这是一个问题，因为这意味着标准 CGI 库（例如 perl 的 CGI.pm）将尝试在 & 符号上拆分，然后对字符串本身进行解码。这有两个潜在的问题：

1）字符串是双重解码的，所以如果一个值被提交给脚本，例如“%2525”，它最终会被视为“%”（解码两次）而不是“%25”（解码一次）

2）（更常见）如果提交的值中有一个＆符号，那么它将（正确）提交为％26，但QUERY_STRING env。变量会将其解码为“&”，然后 CGI 库将在该 & 符号处不正确地拆分查询字符串。这是个大问题！

[http://thefigtrees.net/test.cgi](http://thefigtrees.net/test.cgi)上的脚本演示了这一点。它回显了调用它的环境变量。在浏览器中导航到：

[http://thefigtrees.net/lee/test.cgi?x=y%26z](http://thefigtrees.net/lee/test.cgi?x=y%26z)

您可以看到 REQUEST_URI 正确包含 x=y%26z（未编码），但 QUERY_STRING 已将其解码为 x=y&z。[如果我在域 #2 ( http://www.shoulddivoteformccain.com/test.cgi?x=y%26z](http://www.shouldivoteformccain.com/test.cgi?x=y%26z) )重复测试， 我会看到 QUERY_STRING 仍未解码，因此 CGI.pm 然后会正确拆分和解码。

我尝试在两者上禁用我的 .htaccess 文件以确保这不是问题，并且没有发现任何区别。

由于我的网络主机似乎不愿意帮助我，任何人都可以推测造成这种情况的潜在原因吗？

谢谢，李

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-25T22:45:03.397

我在 Apache 中也有同样的行为。

我相信如果安装了 mod_rewrite 会自动解码 URL，但是，即使没有它，我也看到了自动解码行为。我还没有找到另一个罪魁祸首。

一种常见的解决方法是对输入参数进行双重编码（利用在未编码的 URL 上调用时 URL 解码是安全的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T01:15:48.590

好奇的。从这里我所看到的任何东西都不会给我们一个线索，为什么会发生这种情况......我只能确认这是一个环境错误，并怀疑可能是配置差异，比如可能重写规则。

根据 CGI 1.1，这种解码应该只发生在 SCRIPT-NAME 和 PATH-INFO，而不是 QUERY-STRING。发生这种情况毫无意义且令人讨厌，但这就是规范。使用 REQUEST-URI 而不是那些可用的变量（即 Apache）是您想要在路径部分中放置越界和 Unicode 字符的地方的常见解决方法，因此对查询字符串执行相同操作可能是合理的直到主机提供某种解决方案。

这些天VPS很便宜...

# java - 正则表达式阻止字符串中的所有 <

> ID：444602
> 
> 赞同：-1
> 
> 时间：2009-01-14T20:49:17.910
> 
> 标签：java, regex, sanitization

我正在尝试创建一个正则表达式来阻止所有字符串，除非与 `<`任何人都可以为此建议一个正则表达式吗？我将与.`>``<select>.``javax.util.Pattern`

我正在尝试编写一个解决方案来阻止通过请求和 URL 进行的注入攻击和 XSS 尝试。为此，我将阻止特殊字符和字符序列，但有一些例外。一个例外是，我必须允许`<select>`（在它们之间有选择的尖括号），因为在某些情况下，它会被合法地传递到请求中。但是必须阻止所有其他尖括号组合。这就是我提出问题的原因。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T21:03:45.667

这会从字符串中删除 < 和 > 字符，除非它们是您提到的 <select> 的一部分：

```
someString.replaceAll("<(?!select>)|(?<!\\<select)>", ""); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T21:07:58.997

```
Pattern p = Pattern.compile(
  "(?<!\\<select)>|<(?!\s*select\s*>)",
  Pattern.CASE_INSENSITIVE); 
```

这将发现 > 前面没有 <select 并且 < 后面没有 select> 允许它不区分大小写。

现在通常我会检查元素周围的（合法）空白（“ `< select >`”是有效的），但是后面的问题有我不确定如何解决的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T20:57:27.050

我怀疑它可以用一个正则表达式来完成，但将它分成几个阶段可能更容易，例如：

1.  `"@"`=>`"@0"`
2.  `"<select>"`=>`"@1"`
3.  `"<"`=>`""`
4.  `">"`=>`""`
5.  `"@1"`=>`"<select>"`
6.  `"@0"`=>`"@"`

注意：这些都是文字字符串而不是正则表达式模式。我任意选择`"@"`了转义字符，但它可以是任何东西。

示例： `"a <b> c <select> @ d"`
*步骤 1*
“a <b> c <select> @0 d”
*步骤 2*
“a <b> c @1 @0 d”
*步骤 3*
“a b> c @1 @0 d”
*步骤 4*
“abc @1 @ 0 d”
*步骤 5*
“abc <选择> @0 d”
*步骤 6*
“abc <选择> @ d”

# version-control - 说服大公司使用免费软件？

> ID：444606
> 
> 赞同：5
> 
> 时间：2009-01-14T20:50:51.073
> 
> 标签：version-control, open-source

我目前是一名开发人员，正在从事我大学毕业后的第一份工作。我在一家大公司工作，我注意到他们的趋势是，大约 99% 的时间他们倾向于使用更昂贵的闭源软件，而有非常好的开源替代品可用，其中大部分是大大优于他们的闭源同行。例如，我们使用这个非常糟糕的源代码控制软件，它要花很多钱，而根据我的经验，有相当多的开源和/或免费选项，虽然有限，但要好得多，并且提供基本完全相同的功能。

我想我的问题是： **一个有经验的开发人员会如何使用更多的免费软件进行管理？**

似乎还有另一个与此非常相似的问题在我提出这个问题时没有出现：[我怎样才能让 IT 相信 F/OSS 软件不是邪恶的？](https://stackoverflow.com/questions/375678/how-can-i-convince-it-that-f-oss-software-isnt-evil)

* * *

**编辑：** 来澄清一下。我不一定要尝试改变公司的程序，我正在寻找有关如何就该主题进行管理的建议。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-14T20:55:26.870

1.  开始在小型公用事业和一次性且不需要管理层购买的东西中使用它。这可以证明开源解决方案的价值，并为在其他项目中使用它打开大门。
2.  展示来自贸易杂志的文章，显示其他人正在使用开源解决方案。
3.  选择具有商业支持选项的产品，例如 MySQL，企业似乎更容易接受。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-14T20:57:24.993

仔细选择你的战斗。等到他们受苦。如果他们对自己拥有的东西感到满意，他们就不会改变，无论替代品多么便宜或优越。当他们试图想办法省钱时，或者当他们对当前系统的问题感到反感时，你需要抓住他们。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-14T20:59:54.817

对您所说的免费内容要非常小心。有一个非常大的产品语料库，学生可以完全有效地使用而无需支付企业必须支付的费用。也永远不要忘记总拥有成本 (TCO)。许多相对昂贵的软件很昂贵，因为您可以获得诸如配置之类的东西并为它们提供帮助，而免费软件可能并非如此。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-14T21:32:31.240

我认为你没有问正确的问题。对我来说，挑战是让我的大公司为我购买最好的软件，无论是不是免费软件。

为 Windows 付费或为 Linux 付费并不重要（100 美元对于一家大公司来说是多少？）。

但是把事情做得更好真的很重要。

我认为你对老板的要求不应该是：“嘿，它是免费的，它和 XYZ 一样好，我们为什么要使用 XYZ？”

当 XYZ 看起来不错时，为什么你的老板会冒险尝试你告诉的产品？

最好问：“嘿，这是我不能用 XYZ 做的事情：（你的清单）。用我的产品，我可以做到这一点，而且比我有很多空闲时间要快得多是时候测试我们自己的软件了！”。

小额资金通常不会起到阻碍作用。能够更快地工作*以进行更多测试*（或任何其他可以帮助您的老板拥有更好形象的事情）绝对是一个很好的论据！

最好的祝愿，西尔万。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-14T21:36:15.787

我在一家最近开始对开源解决方案充满热情的大公司工作。有几个大障碍：

*   **客户不会支持它**——我们是国防承包商。没有客户这么说，我们几乎什么都不做。随着客户意见的改变，我们已经能够改变我们的架构和工具的使用。也就是说，仍有一些场景是开源是不可接受的，我们不使用它。
*   **没有技术支持 = 可怕**- 在某些情况下，可以指出开源可能没有单一的公司技术支持点，但它确实有庞大的社区可以免费支持 questios，并且有可用的顾问根据真正困难的东西的需要。加上许多许多用于错误修复的新版本。而且，一些竞争的昂贵产品无法满足技术支持需求。能够用 long 指向特定的内部示例。有据可查的支持问题的历史一直是关键。
*   **对安全问题的恐惧**——我们必须开发一个流程来审查和控制引入的每一个开源项目。我们已经设法找到了我们认为有风险的标准，而不是我们认为基于信息安全政策的相对良性的标准。
*   **害怕诉讼**- 规模大且有利可图，我们害怕诉讼，我们是伟大的目标。我们现在有一个法律团队审查每个开源许可证的流程。事实证明这是一场胜利——因为法律团队现在对典型开源许可证的每个主要版本都有简报，他们可以快速审查大多数内容。
*   **版本控制**——担心如果那些古怪的开发者可以下载他们喜欢的任何东西，世界会自毁。好吧，实际上，“我们如何知道给定产品中的内容”的概念 - 能够显示内部管理的 FOSS 版本控制过程非常重要。

这绝对是一个缓慢的过程——小项目证明是有利可图的，客户开始在提案中鼓励它。这使它对执行管理很有用。那些支持它的人愿意花一些额外的时间来制定商业案例以节省效率/成本，并且愿意与公司基础设施的各个部分反复谈判，这对我们很有帮助。

开源工作需要 IT、信息安全人员、法律团队、采购团队和技术管理人员的努力。在与经理交谈之前了解这一点可能是成功的关键。

还有一些政治头脑 - 对于第一个项目，不要侵犯任何神圣的奶牛 - 即那些可能不会成功，但高调并由拥有大量政治权力的人拥有的项目。相反，选择一些现在不可用的古怪新事物，并以不太可能引起防御反应的方式证明成本节约。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-14T20:58:42.650

当您尝试将开源软件介绍给一家大公司（在很多情况下甚至是小公司）时，您会听到的最大反对意见是“没有技术支持”。公司往往对使用社区支持的软件持谨慎态度，因为无法保证（或在某些情况下，服务协议）有关软件的问题将在合理的时间范围内得到答复，或者根本没有。在许多情况下，您可以找到一家为您想要使用的开源软件包提供支持的公司（例如，Red Hat 为其 Linux 发行版提供支持，即使该发行版的内容主要是开源的）。向管理层展示可以支持该软件的业务实体通常会有很长的路要走。

我最常听到的使用开源软件的另一个反驳是“开源软件有缺陷”。这是困难的一个; 这种观点在某些企业文化中根深蒂固。两种可能的回答是“开源社区快速修复错误”和“既然我们有源代码，我们的工程师可以修复错误”——但这通常不是管理者想要听到的。

因此，从本质上讲，这取决于公司、他们的态度以及他们对您提出关键业务建议的信任程度。我已经使用了上述所有论点，在不同的公司取得了不同程度的成功。

当然，在这些经济时代，“免费”部分可能会走很长一段路。:-)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-14T21:00:26.047

“免费软件”并不一定意味着您的公司将免费获得软件。许多成功的开源项目还提供了许可证和服务，这些许可证和服务需要花费真金白银，并且面向希望或需要得到良好支持的组织。MySQL 就是一个例子

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-14T20:54:09.383

许多大公司使用封闭软件的原因是他们可以致电支持，供应商会发布修补程序、补丁或累积更新

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-14T21:00:51.180

改变一家大公司的习惯，往往就像把油轮转过来一样……需要很长的时间，消耗大量的能源。

如果公司正在为特定任务评估购买新软件的过程中，那么我会确保写一份简明的意见备忘录，说明为什么我的选择更好。

如果该软件是我个人使用的东西，而不是多个开发人员被迫使用的服务器产品，那么我只会要求我的经理使用它。

如果软件到位，可以完成工作（即使我不喜欢它的工作方式），我会尽可能多地了解它，以便为我提供尽可能多的工作机会，或者至少让我的生活更轻松。如果它仍然很糟糕，我可能不会尝试更改它，直到公司支付升级费用。

如果该软件可以工作但只是烦人......我会按照上面的方法做，学习所有关于它的知识只是为了让我的生活更轻松，然后处理它。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-14T21:15:00.213

我明白你的意思。我们花了数年时间才让我们的经理相信，如果我们从使用 Interbase（一种商业关系数据库）转向它的开源对应物 Firebird，一切都会好起来的。主要是害怕没有支持阻止了这一举动。我认为改变主意的因素是：

*   测试显示更好的性能
*   有公司提供并收取支持操作系统替代品的费用
*   热情的开发人员不断推动论点

我认为，如果我们的公司为网站许可证付费，但实际上我们的客户是付费的，我认为节省成本会起到一定的作用。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-14T21:31:31.147

您可能是对的，您推荐的系统比当前使用的系统更好。但就像其他一些海报所说的那样，选择你的战斗，尤其是当这是你在现实世界中的第一份工作时。你可能很快就会变成消耗品。

这并不是什么更好的问题，即使你的方式更好，这也是文化和做事方式以及转换成本的问题。即使假设他们的系统可以神奇地传输到您的 OSS 系统，而不会丢失数据、日期、记录或任何东西，您仍然会有人说“我更喜欢旧方式”。

记住：经验是当你没有得到你想要的东西时你得到的。我知道成为“推荐人人都喜欢的优秀新版本系统的新人”听起来可能很迷人，但您也可以很容易地成为“坚持使用每个人都讨厌的新版本系统的能手”。至少在一段时间内遵守规则，直到你有一些影响力并可以提出一些建议，这是一个更明智的职业选择。与此同时，您甚至可能会了解为什么首选旧系统，或者越使用越喜欢它。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-15T04:18:08.363

我是这样看这个问题的。我使用 .NET 框架。我可以要求我的雇主迁移到 PHP。出于多种原因，这对我和我的公司都是不利的。让我们从显而易见的开始。

1.) 我了解 PHP，但使用 .NET 可以做得更多、更快。2.) 为服务付费，通常可以确保更好的体验。在开发应用程序时，Visual Studio IDE 是首屈一指的。3.) 我在 VS 中开发应用程序的速度比硬编码 PHP 快得多。4.) 这是最重要的一个。如果我在一家大公司工作，我希望我的程序员能够更快地开发我的应用程序，并且我希望它运行得更快。PHP（一种开源语言示例）快速且可靠，但如果我能花钱，我将部署 ASP.NET。

基本上，大企业，甚至小企业，都想花钱，只要有充分的理由。你最好的选择是说，'嘿，如果你想部署 ASP.NET（或其他），请给我一些培训。然后我将能够尽我最大的能力开发我们的应用程序'。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-15T04:36:55.157

不是听起来完全愤世嫉俗，而是：

*   除非他/她已经是开源软件包的专家，否则经验丰富的开发人员可能不会就这样的事情与管理层联系。公司喜欢有一个电话号码可以打电话，当事情不正常时有人可以责备。免费的开源软件包不提供这种“问责制”（是的，我们知道这是个玩笑，但管理层没有）
*   管理层不太可能听取刚从大学毕业的人关于任何重大采购或技术决策的意见。您必须先学习业务并赢得每个人的尊重。[对不起！]

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-14T20:55:50.050

到处都是同样的问题。一旦一个组织超过了一定的规模（例如，邓巴数），它就会开始表现出某种愚蠢的品质，这会让你感到困惑。很多你不知道的历史、人物和议程。让每个人都同意你的解决方案是很困难的。

最好从本地开始。看看你是否可以说服你的经理或 PM 为一个项目在本地使用 SVN、CVS 或 GIT，然后让它扩散。

但这种情况在我工作的地方也是如此。我自己在本地使用 SVN，但作为与他人集成的商业产品。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-14T20:59:12.743

公司将使用最终使他们赚到最多钱的任何东西。这意味着任何软件都能让他们的员工更有效率。如果您认为他们应该使用某个特定的开源软件，那么当需要购买该软件来完成工作 X 时，只要您能证明它会提高员工的工作效率并且他们能够获得可靠的支持只需一个电话，就像使用商业软件一样，他们就会使用它。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-14T21:00:23.007

大公司需要为这样的事情雇用支持人员。当他们从公司购买软件时，他们会得到合同的保证支持。开源项目可以更容易地消亡，而大型软件供应商可以承担更长的时间。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-14T21:10:23.453

每家公司都有一种文化，而与这种文化作斗争可能是一场艰苦的战斗。但如果你愿意尝试：

1.  您可能会更幸运地获得 BSD 和类似 BSD 的项目（MIT 许可证、Apache、Boost 等）的批准；如果大多数反对 GPL 和 LGPL 的论点主要是 FUD 也没关系
2.  您应该将这些项目称为“免版税”
3.  你应该确保事情得到可以批准的人（你的直接经理）的批准，因为让公司陷入困境——尤其是当你是新人时——（即使“束缚”只是在他们的脑海中）不是有利于长期就业
4.  您只需询问选择库或工具的过程可能会走很长一段路

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-01-18T18:29:22.173

从配置管理的角度来看，让开发人员在他们觉得需要管理的严肃 PITA 时随意添加免费软件。

我曾在公司工作过，只要你愿意，你就可以这样做，而在其他公司，你永远做不到。

肯定可以找到平衡点，但是如果您在一家拥有多个项目的大公司中，您必须记住，每次添加新的“工具”都会使构建过程复杂化。

# c# - 我在哪里可以找到设计良好的小型 C# 应用程序的源代码（用于学习目的）？

> ID：444615
> 
> 赞同：2
> 
> 时间：2009-01-14T20:53:49.337
> 
> 标签：c#

谁能指导我使用一个小型 C# 应用程序，它象征着设计程序的“正确方式”？我正在寻找一个相对简单（可能微不足道）的程序来分析和学习。

应用程序应该有一个相对微不足道的问题需要解决，并且应该以一种相当直接的方式解决它，同时展示最佳实践/良好的面向对象设计。

我最近一直在学习 C#，虽然我对自己对部分 .Net 框架和 C# 语法的理解越来越有信心，但我在设计的一般概念和项目如何适应方面遇到了困难一起。

感谢您提供的任何资源！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T20:56:58.533

这个网站上有很多项目：

[http://www.codeplex.com/](http://www.codeplex.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T21:30:11.370

首先，看一下关于这个主题的上一个问题。它位于[https://stackoverflow.com/questions/143088/open-source-c-projects-that-have-very-high-code-quality-to-learn-from](https://stackoverflow.com/questions/143088/open-source-c-projects-that-have-very-high-code-quality-to-learn-from)。

在该列表中，我要添加：

*   ASP.NET MVC 店面（MVC 参考）
*   亚音速
*   Rawr（优秀的 Windows 窗体应用程序）

所有这些都在 Codeplex 上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T21:39:28.993

一个面向对象并使用最佳实践的伟大项目是 SharpDevelop。您可以在此处下载源代码：http: [//www.icharpcode.net/OpenSource/SD/Download/](http://www.icsharpcode.net/OpenSource/SD/Download/)。它实际上是一个 IDE，因此您也可以使用它来编写代码。

我下载了源代码，在 Visual Studio 中加载它，编译它，然后在调试模式下运行它......全部在大约 5 分钟内完成，无需进行任何特殊设置！

唯一的问题是解决方案本身并不是很小，而是分成很多小项目，所以这就是我推荐它的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T21:00:49.277

您可以下载类似[BlogEngine](http://www.codeplex.com/blogengine/Release/ProjectReleases.aspx?ReleaseId=14988)的东西。如果您下载完整的源代码版本，您可以设置断点并遍历代码并查看它们是如何实现的。

否则在[codeplex](http://www.codeplex.com)上有很多项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T21:35:59.720

微软有一个很棒的图书馆：

[ASP.NET 快速入门教程](http://quickstarts.asp.net/QuickstartV20/aspnet/)

[ASP.NET 入门工具包和社区项目](http://www.asp.net/community/projects/)

# java - 如何强制弹簧容器不返回 bean 的单例实例？

> ID：444623
> 
> 赞同：19
> 
> 时间：2009-01-14T20:54:44.593
> 
> 标签：java, spring

当我调用`getBean(name)`a`BeanFactory`时，我会返回一个在应用程序上下文中定义的 bean 实例。但是，当我`getBean(name)`再次调用（使用相同的名称）时，我得到了相同的 bean 实例。我了解在某些（很多？）情况下这将是可取的，但是我如何告诉`BeanFactory`我给我一个新的实例？

示例 Spring 配置（简而言之......我已经省略了一些冗长的内容，但这应该明白这一点）：

```
<beans>
   <bean id="beanA" class="misc.BeanClass"/>
</beans> 
```

示例 Java：

```
for(int i = 0;i++;i<=1) {
    ApplicationContext context = ClassPathXmlApplicationContext("context.xml");
    Object o = context.getBean("beanA");

    System.out.println(o.toString());  // Note: misc.BeanA does not implement 
                                       // toString(), so this will display the OOID
                                       // so that we can tell if it's the same
                                       // instance
} 
```

当我运行它时，我得到类似的东西：

```
misc.BeanClass@139894
misc.BeanClass@139894 
```

请注意，两者都具有相同的 OOID ......所以这些是相同的实例......但我想要不同的实例。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-01-14T20:58:03.180

你需要告诉spring你想要一个原型bean而不是单例bean

```
<bean id="beanA" class="misc.BeanClass" scope="prototype"/> 
```

这将为您提供每个请求的新实例。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-14T20:57:54.943

默认[范围](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#beans-factory-scopes-singleton)是单例，但您可以将其设置为原型、请求、会话或全局会话。

# c# - C#线程池限制线程

> ID：444627
> 
> 赞同：36
> 
> 时间：2009-01-14T20:56:03.793
> 
> 标签：c#, multithreading, c#-2.0, threadpool

好吧...我已经对该网站进行了公平的搜索，并阅读了许多有关此主题的帖子。我发现这个问题：[Code for a simple thread pool in C#](https://stackoverflow.com/questions/435668/code-for-a-simple-thread-pool-in-c)特别有用。

但是，似乎总是如此，我需要的东西略有不同。

我查看了 MSDN 示例并对其进行了一些调整以适应我的需要。我参考的例子在这里：http: [//msdn.microsoft.com/en-us/library/3dasc8as (VS.80,printer).aspx](http://msdn.microsoft.com/en-us/library/3dasc8as(VS.80,printer).aspx)

我的问题是这个。`HttpWebRequest`我有一组相当简单的代码，通过和`WebResponse`类加载网页并通过`Stream`. 我在一个线程中触发了这个方法，因为它需要执行很多次。该方法本身很短，但需要触发的次数（每次使用不同的数据）会有所不同。它可以是 1 到 200 之间的任何值。

我读过的所有内容似乎都表明该`ThreadPool`班级是主要候选人。这就是事情变得棘手的地方。我可能需要启动这个东西说 100 次，但我最多只能运行 3 个线程（对于这个特定任务）。

我试过`MaxThreads`在`ThreadPool`通孔上设置：

```
ThreadPool.SetMaxThreads(3, 3); 
```

我并不完全相信这种方法是有效的。此外，我不想破坏将在其上运行的系统上运行的其他网站或程序。那么，通过限制 上的线程`ThreadPool`数，我可以确定这仅与我的代码和我的线程有关吗？

MSDN 示例使用事件驱动方法和调用`WaitHandle.WaitAll(doneEvents);`，这就是我这样做的方式。

所以我的问题的核心是，如何确保或指定可以为其代码运行的最大线程数，但让代码继续运行更多线程，因为之前的线程完成直到某个任意点？我以正确的方式解决这个问题吗？

真挚地，

杰森

* * *

好的，我添加了信号量方法并完全删除了`ThreadPool`代码。看起来很简单。我的信息来自：[http ://www.albahari.com/threading/part2.aspx](http://www.albahari.com/threading/part2.aspx)

正是这个例子向我展示了如何：

[下面的文字是从网站复制/粘贴]

容量为 one 的A`Semaphore`类似于 a `Mutex`or `lock`，只是它`Semaphore`没有“所有者”——它与线程无关。任何线程都可以调用`Release`a `Semaphore`，而使用`Mutex`and `lock`，只有获得资源的线程才能释放它。

在以下示例中，十个线程执行一个循环，`Sleep`中间有一条语句。A`Semaphore`确保不超过三个线程可以`Sleep`一次执行该语句：

```
class SemaphoreTest
{
    static Semaphore s = new Semaphore(3, 3);  // Available=3; Capacity=3

    static void Main()
    {
        for (int i = 0; i < 10; i++)
            new Thread(Go).Start();
    }

    static void Go()
    {
        while (true)
        {
            s.WaitOne();

            Thread.Sleep(100);   // Only 3 threads can get here at once

            s.Release();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-14T21:06:46.610

注意：如果您将其限制为“3”只是为了不让运行您的应用程序的机器不堪重负，我会首先确保这是一个问题。线程池应该为你管理这个。另一方面，如果您不想压倒其他资源，请继续阅读！

* * *

您无法管理线程池的大小（或者关于它的任何事情）。

在这种情况下，我会使用信号量来管理对资源的访问。在您的情况下，您的资源正在运行网络抓取，或计算一些报告等。

为此，在您的静态类中，创建一个信号量对象：

```
System.Threading.Semaphore S = new System.Threading.Semaphore(3, 3); 
```

然后，在每个线程中，您执行以下操作：

```
System.Threading.Semaphore S = new System.Threading.Semaphore(3, 3);

try
{
    // wait your turn (decrement)
    S.WaitOne();
    // do your thing
}

finally {
    // release so others can go (increment)
    S.Release();
} 
```

每个线程都会在 S.WaitOne() 上阻塞，直到收到继续执行的信号。一旦 S 递减 3 次，所有线程将阻塞，直到其中一个线程递增计数器。

这个解决方案并不完美。

* * *

如果您想要更清洁、更高效的东西，我建议您使用 BlockingQueue 方法，其中您将要执行的工作排入全局 Blocking Queue 对象。

同时，您有三个线程（您创建的——不在线程池中），将工作从队列中弹出来执行。这并不难设置，而且非常快速和简单。

例子：

*   [最佳线程队列示例/最佳实践](https://stackoverflow.com/questions/346268/best-threading-queue-example-best-practice)
*   [在并发程序中从 BlockingQueue 获取对象的最佳方法？](https://stackoverflow.com/questions/23950/best-method-to-get-objects-from-a-blockingqueue-in-a-concurrent-program)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T21:02:31.737

它和其他类一样是一个静态类，这意味着您对它所做的任何事情都会影响当前进程中的所有其他线程。它不会影响其他进程。

然而，我认为这是 .NET 中较大的设计缺陷之一。谁提出了使线程池*静态*化的绝妙主意？如您的示例所示，我们通常需要一个专用于*我们的*任务的线程池，而不会干扰系统中其他地方的不相关任务。

# fractals - 编程分形

> ID：444628
> 
> 赞同：0
> 
> 时间：2009-01-14T20:56:13.717
> 
> 标签：fractals

学习编程分形有助于清楚地思考某些编程问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-05T13:47:29.603

分形编程将向您介绍递归、迭代、图形编程概念、图像处理和用户界面设计。从数学的角度，您将学习几何、复数、莫比乌斯变换（克莱因分形）、仿射变换（IFS 分形）、求根方法（牛顿分形）。

最重要的是，您会看到自己的努力会产生奇怪和不寻常的图像，从而获得回报。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T20:59:07.390

据我所知，如果没有别的，你会很好地处理递归......也许还有一点位图级编程......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-05T14:42:12.310

如果您是初学者，这样的活动肯定会帮助您提高技能。除了根据分形类型和您设定的目标对分形可视化进行编程之外，还可能会为您提供一些特定的技能或知识，例如：

*   从事图形、图像处理工作；
*   理解递归和递归结构；
*   优化技术；
*   低级程序优化；
*   了解计算机是如何运行的（例如，为什么分辨率通常会受到限制 -> 浮点精度和误差累积）；
*   并行编程；
*   一些数学改进并扩展您的兴趣范围；
*   了解各种技术（例如，您可以在[PixelBender中](http://labs.adobe.com/technologies/pixelbender/)[编写 Mandelbrot 集](http://octets.ru/programming/flash-platform/pixel-bender-bystraya-otrisovka-mnozhestv-mandelbrota-i-zhyulia/)，这非常快，因为可以在 GPU 上执行）；
*   理解复杂的压缩算法（例如某种分形压缩）；
*   创造力（例如，您发明了自己的分形集着色算法）；
*   还有更多:)

它确实是一个多才多艺且有趣的领域，有很多东西需要探索和学习。我以前经常画分形:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T21:35:44.883

分形让我想到了复数和[分支点](http://en.wikipedia.org/wiki/Branch_point)。我想，这是否是一件好事，这是一个见仁见智的问题。:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T21:01:01.210

任何类型的编程经验都是有用的。所以是的。

尤其是给：

*   数学问题
*   基本算法
*   当然还有分形编程

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T21:01:51.350

它可能会让你练习实现数学公式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T21:10:27.663

一些分形是显式递归的良好视觉示例；如果您对这个概念有困难，那么它们可能是工作的好问题。您可以从“海龟图形”样式的分形路径开始，例如希尔伯特曲线或经典的“雪花”分形。

许多分形生成方法使用重型数字运算（例如，Mandelbrot 和 Julia 集）。数字运算本身当然是一个领域，调整分形生成器以尽可能快地运行可能是一个很好的优化练习。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T21:12:58.410

我不认为编程分形会特别教你任何东西。根据分形，我想它可能会教你一些关于数学或一般分形的知识。

但是，我确实认为分形作为编程入门很有趣，初学者/学生通常对结果着迷，无论是像 mandelbrot 或 julia 集这样的图形分形，还是更容易理解的 L 系统。

当然，如果您是编程新手，那么它也有望教会您很多关于一般编程的知识。如果不出意外，分形看起来很有趣。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-14T21:16:52.440

当我还是一名本科生时，我们使用分形绘图来为并行处理工作提供动力。它很快就变得相当计算密集，因此拥有多个可用的 CPU 来完成这项工作可以让您看到效率的明显提高。

因此，与递归一起，我想说它有助于学习如何在并行处理器之间平衡 CPU 负载。

... 或者如果设备不可用，它可能会教你禅宗般的耐心。:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-05T15:00:02.003

很好的主意！我认为对分形进行编码是一个很棒的“练习曲”（学习）大小的程序。通过这种方式，它具有一些不错的功能：通常您不需要太多的 3rd 方代码，它们可以在相当短的时间内（和复杂性）实现，并且最终您会得到一些不错的东西，这也验证了您的工作.

此外，在数学和数值算法的实现中，如果你这样做，你会遇到很多基本问题。

从像基本 Mandelbrot 集生成器这样简单的东西，您可以扩展到评论者提到的各种问题。但是，即使坚持这一点，您也可以了解优化技术（为什么我的生成器这么慢）和数值问题（为什么我不能在这里放大），而且如果您想了解一点颜色理论（什么是 L无论如何*都是一个*b* 空间）和其他零碎的东西。

玩得开心！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-05-03T13:09:47.623

分形是一个非常有趣的话题，即使是最简单的实现也会让你了解复数数学、图形生成、缩放图像和一般编程。

# sharepoint - 如何在运行时在性能点中禁用字段列表？

> ID：444632
> 
> 赞同：0
> 
> 时间：2009-01-14T20:57:08.377
> 
> 标签：sharepoint, performancepoint, fieldlist

我有一个正在显示的仪表板，每当我的用户单击数据透视图或数据透视表时，字段列表就会自动弹出。我怎样才能防止这种情况发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T14:58:21.790

如果您希望在这样的仪表板中使用临时分析工具（例如数据透视表和图表），则始终会出现字段列表。

如果您能够使用静态数据，则将其呈现为该格式并用它替换您当前拥有的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-24T21:53:07.713

在仪表板设计器中编辑图表。在**命令和选项**对话框的下拉列表中选择**图表工作区。**一旦你这样做，标签**显示/隐藏**应该出现。在该选项卡上，您可以清除字段列表的复选框。清除该对话框中的任何其他复选框，然后关闭窗口。单击 DD 中的图表并确保不出现字段列表（以及任何其他对话框 - 即命令和选项、拖放区等）。发布您的图表，您应该一切顺利。

# java - 奇怪的 HashMap.put() 行为

> ID：444638
> 
> 赞同：1
> 
> 时间：2009-01-14T20:58:05.910
> 
> 标签：java, hashmap

我正在尝试解决间歇性故障，该故障似乎与从 HashMap 中删除对象然后使用新键放回相同的对象有关。我的 HashMap 创建如下：

```
transactions = new HashMap<Short, TransactionBase>(); 
```

重新分配的代码如下：

```
transactions.remove(transaction.tran_no);
transaction.tran_no = generate_transaction_id();
transactions.put(transaction.tran_no, transaction); 
```

我看到的间歇性行为是，在此之后立即执行的代码取决于可定位的事务对象似乎没有使用新的事务 ID 找到事务对象。但是，在未来的某个时间点，可以定位交易。因此，拉扯稻草，是否有任何异步影响 put() 或 remove 可能导致这种行为？

我应该提一下，据我所知，容器只被一个线程访问。我已经在他的文档中读到 HashMap 类不是“同步的”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-14T21:19:37.180

remove/get 和 put 之间存在细微差别（尽管我猜你有线程问题）。

`remove`/的参数`get`类型为`Object`; 因为`put`它是类型`K`。其原因之前已经说过很多次了。这意味着它在拳击方面存在问题。我什至不会猜测规则是什么。如果一个值`Byte`在一个地方被装箱，而`Short`在另一个地方被装箱，那么这两个对象不可能相等。

`List.remove(int)`和也有类似的问题`List.remove(Object)`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-14T21:25:43.797

我假设每次您检查该项目的存在时，您肯定会使用 a `short`or `Short argument`to `Map.get()`or `Map.contains()`?

这些方法采用 Object 参数，因此如果您将它们传递给它们`int`，它将被转换为 an`Integer`并且永远不会匹配 Map 中的任何项目，因为它们都将具有`Short`键。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-14T21:10:38.087

HashMap 类中没有“异步”效果。只要你把东西放在那里，它就在那里。您应该进行双重和三重检查以确保没有线程问题。

我唯一能想到的另一件事是您正在某处制作 HashMap 的副本。副本显然不会受到您在原件中添加内容的影响，反之亦然。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-14T22:44:56.117

只有一个建议...您专注于对 HashMap 的访问，但我想知道您是否还应该查看您的 generate_transaction_id() 是否是线程安全的，或者它是否以意想不到的方式运行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-14T23:01:23.043

您是否已覆盖`equals()`但不在`hashCode()`模型对象中？怎么样`compareTo()`？如果你弄错了，集合的行为确实会很奇怪。

检查[equals()](http://www.javapractices.com/topic/TopicAction.do?Id=17)和[compareTo()](http://www.javapractices.com/topic/TopicAction.do?Id=10)上的 Java 实践。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T21:01:14.347

所以你知道`HashMap`'s 不是线程安全的。你确定它只被一个线程访问吗？毕竟，间歇性故障与频繁的线程有关。如果没有，你可以用 包裹它[`Collections.synchronizedMap()`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Collections.html#synchronizedMap(java.util.Map))，像这样：

```
Collections.synchronizedMap(transactions); 
```

你总是可以尝试，这样你就可以消除这种可能性。

应该指出的是，这只是用一个所有方法同步的原始地图包装。如果访问是本地化的，您可能需要考虑使用同步块。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-14T23:12:32.987

这个 generate_transaction_id() 函数有什么作用？如果它正在生成类似 16 位 GUID 的东西，则很容易发生哈希冲突。结合线程，您可以获得：

```
T1: transaction1.tran_no = generate_transaction_id();    => 1729
T2: transaction2.tran_no = generate_transaction_id();    => 1729
T1: transactions.put(transaction1.tran_no, transaction1); => map.put(1729, transaction1)
T2: transactions.put(transaction2.tran_no, transaction2); => map.put(1729, transaction2)
T1: int tran_no = transactions.get(1729);               => transaction2
T1: transactions.remove(transaction.tran_no);           => map.remove(1729)
T2: int tran_no = transactions.get(1729);               => null 
```

当然，如果“据您所知”部分不正确，这只能是一个解决方案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T23:25:14.367

已经在一些回复中提到了线程，但是您是否考虑过多个线程使用的对象的可见性问题？如果您将对象放入一个线程中的集合中，则可能（并且很常见）除非您在集合上正确同步，否则它不会“发布”到其他线程。

[线程和锁](http://java.sun.com/docs/books/jls/third_edition/html/memory.html)

[Java中的同步和线程安全](http://www.javamex.com/tutorials/threads/thread_safety.shtml)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-03T19:29:44.930

正如其他人所观察到的，您必须知道 HashMap 是否仅由一个线程访问。**CollectionSpy**是一个新的分析器，它可以让你立即找出所有容器有多少线程执行任何访问。有关详细信息，请参阅[www.collectionspy.com 。](http://www.collectionspy.com)

# c# - 异常与返回码：我们是否失去了一些东西（同时获得了一些东西）？

> ID：444654
> 
> 赞同：8
> 
> 时间：2009-01-14T21:01:18.713
> 
> 标签：c#, exception, return-code

我的问题很模糊:o) - 但这里有一个例子：

当我编写 C 代码时，我能够在失败时记录计数器的值：

```
 <...>
   for ( int i = 0 ; i < n ; i++ )
      if ( SUCCESS != myCall())
         Log( "Failure, i = %d", i );
   <...> 
```

现在，使用异常，我得到了这个：

```
 try
   {
      <...>
      for ( int i = 0 ; i < n ; i++ )
         myCall();
      <...>
   }
   catch ( Exception exception )
   {
      Log( "Failure ! Maybe in myCall() ? Don't know. i's value ? No clue." );
   } 
```

当然，可以在 try/catch 语句之外声明“i”（这就是我正在做的事情）。但我不喜欢它——我喜欢在使用它们的地方声明变量，而不是以前。

但也许我在这里错过了什么。你有什么优雅的解决方案吗？

预先感谢 ！西尔万。

添加：myCall() 是一个不起眼的 API 调用——我不知道它会抛出什么。另外，我当然可以在每个调用周围添加一个 Try/Catch 块，但是我会更好地使用返回码吗？然后我会在重要的代码行周围添加很多噪音吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-14T21:07:24.363

怎么样：

```
for(int i = 0; i < n; i++)
{
  try
  {
    myCall();
  }
  catch(Exception e)
  {
    Log(String.Format("Problem with {0}", i));
  }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-14T22:58:22.563

我认为你弄错了，这并不像许多其他人一样令人惊讶。

异常不能用于程序流。再读一遍，很重要。

例外情况是您希望在运行时永远不会看到的“哇，这不应该发生”错误。显然，当您的第一个用户使用它时，您就会看到它们，这就是为什么您必须考虑它们可能发生的情况，但您仍然不应该尝试将代码放入捕获、处理和继续，就好像什么都没发生一样。

对于这样的错误，您需要错误代码。如果您使用异常，就好像它们是“超级错误代码”，那么您最终会像您提到的那样编写代码 - 将每个方法调用包装在一个 try/catch 块中！您还不如返回一个枚举，它比用 7 行代码而不是 1 行乱扔所有代码*要*快得多，而且更容易阅读错误返回代码。（它也更有可能是正确的代码 - 请参阅 eri​​kkallen 的回复）

现在，在现实世界中，通常情况下，方法会在您不希望它们没有抛出异常的地方抛出异常（例如 EndOfFile），在这种情况下，您必须使用“try/catch wrapper”反模式，但是如果您要设计方法，请不要将异常用于日常错误处理 - 仅将它们用于特殊情况。（是的，我知道这种设计很难，但很多设计工作也是如此）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-14T21:20:19.017

我不喜欢“现在，有例外……”的表达方式。

异常是您在编程中使用它**的工具**——如果您认为它是最佳选择，请使用它，否则不要。

我遵循个人规则，即在内部代码中不抛出任何我可以避免抛出的异常。对于公开可用的 DLL 的 API，应启用前置条件检查并在失败时触发异常，是的；但是对于内部逻辑，我很少（如果有的话）在我的设计中包含异常。相反，当我使用一些记录了如果发生某些不良情况时将抛出的函数时，我倾向于立即捕获异常——毕竟这是一个预期的异常。

如果您认为您的非特殊选择更好 - 坚持下去！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-14T21:09:20.723

是的。2 件事。

**将 try-catch 块放在有意义的地方。**如果您对 myCall 的异常（以及 i 的值）感兴趣，请使用

```
for ( int i = 0 ; i < n ; i++ )
    try { myCall(); } catch ( Exception exception ) {
        Log( "Failure, i = %d", i );
    } 
```

**为不同的错误抛出不同类的对象。**如果您对财务处理中发生的逻辑错误感兴趣，请抛出 finances::logic_error，而不是 std::exception("error msg") 或其他内容。这样你就可以捕捉到你需要的东西。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-14T23:16:28.130

从我的角度来看，这里有两件事。

期望异常本身包含有关 i 的值的信息，或者不太具体地包含有关它被评估的上下文和出了什么问题的信息，这并不令人发指。举个简单的例子，我绝不会直接扔顺子`InvalidArgumentException`；相反，我会确保将准确的描述传递给构造函数，例如

```
 public void doStuff(int arg) {
      if (arg < 0) {
         throw new InvalidArgumentException("Index must be greater than or equal to zero, but was " + arg);
      }
      ... 
```

这可能不会*显式地*记录 i 的值，但在大多数情况下，您将能够了解导致错误的输入的问题所在。这也是一个支持异常链接的论据——如果你在每个概念级别捕获、包装和重新抛出异常，那么每个包装都可以添加自己的相关变量，这些变量太高而无法被基本的低级错误看到或理解.

或者，如果事情真的太抽象以至于您的`myCall`函数无法知道发生了什么，那么我发现在进行调用之前以更高的详细程度记录日志效果很好，例如

```
try
   {
      <...>
      for ( int i = 0 ; i < n ; i++ )
         DebugLog("Trying myCall with i = " + i);
         myCall();
      <...>
   }
   catch ( Exception exception )
   {
      Log( "Failure ! Maybe in myCall() ? Don't know. i's value ? No clue." );
   } 
```

这样，如果确实出现问题，您可以检查您的高详细调试日志并找到`i`引发异常的调用之前的内容。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-15T06:25:21.570

考虑 Raymond Chen 的意见以及 Microsoft 的 x64 思维。
(( raymond chen exceptions )) 作为谷歌查询足以让你看到他的经典文章“更干净、更优雅、更错误——仅仅因为你看不到错误路径并不意味着它不存在。” 以及“更干净、更优雅、更难识别”的说明。
（（x64 异常模型））将您带到 MSDN 文章“开始编程 64 位 Windows 系统您需要知道的一切”，其中包含引用“基于表的异常处理的缺点（相对于基于 x86 堆栈的模型）是从代码地址查找函数表条目比仅仅遍历链表需要更多时间。好处是函数不会
总结一下这句话，在 x64 中，设置一个从未使用过的“catch”是免费的或几乎是免费的，但实际上 throw-catch 异常比 x86 慢。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-14T21:06:51.603

如果您抛出的对象可以保存告诉您有关错误性质的某些内容的上下文信息，则它可以更优雅。

从 istream 派生一个可抛出对象，您可以使用 >> 将信息流式传输到其中。教对象如何显示自己<<。

当您检测到错误情况时，在以下级别或以下 N 级别。用好的上下文信息填充你的对象，然后扔掉它。当您捕获对象时，告诉它在日志文件和/或屏幕和/或您想要的任何地方显示其上下文信息。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-14T21:07:24.363

> 当然，可以在 try/catch 语句之外声明“i”（这就是我正在做的事情）。

好吧……如果你真的需要知道它的价值，`i`那么这似乎是一个日志工具——结构化异常处理可能不是最好的方法。如果您想有条件地处理异常（即仅在调试时），请将`try`块*放入*循环中。由于这可能会损害性能（取决于您的环境），因此只能在调试模式下执行此操作。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-14T21:08:09.103

第一件事，第一件事。如果您捕获异常，您就错了。您应该捕获您期望的特定异常。

但除此之外，如果您的异常是由您自己的代码引发的，您可以使用智能异常来包含您需要了解的有关该异常的所有数据。

例如，ArrayIndexOutOfBoundsException 将包含寻址的索引。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-14T21:09:56.433

您可以通过两种方式获得更具体的信息。首先，不要捕捉异常，捕捉特定的异常。其次，在一个函数中使用多个 try/catch 语句，您需要确定哪个函数调用引发了异常。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-14T21:13:26.303

在我看来，在这种情况下不应该使用异常，但如果你真的需要它们，我会采用以下方式：

您可以将“i”作为参数传递给 myCall(); 函数，如果发生任何错误，将抛出一些特殊异常。像：

```
public class SomeException : Exception
{
     public int Iteration;

     public SomeException(int iteration) { Iteration = iteration; }
} 
```

循环块：

```
try
{
    for(int i = 0; i < n; ++i)
    {
        myCall(i);
    }
}catch(SomeException se)
{
    Log("Something terrible happened during the %ith iteration.", se.Iteration);
} 
```

最后是 myCall() 函数：

```
void myCall(int iteration)
{
    // do something very useful here

    // failed.
    throw new SomeException(iteration);
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-14T22:28:39.147

我们失去了轻松查看代码如何处理不同位置的故障的可能性。Raymond Chen 写了[一篇关于它的好文章](https://web.archive.org/web/20060314174214/http://blogs.msdn.com/oldnewthing/archive/2005/01/14/352949.aspx)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-14T21:08:55.437

好！你可以这样做：

```
 try
   {
      <...>
      for ( int i = 0 ; i < n ; i++ )
         try {
            myCall();
         } catch(Exception e) {
            println("bloody hell! " + i);
         }
      <...>
   } 
```

我认为异常比 Java 向您展示的要酷。真正有趣的是让调试器出现在每个未处理的异常上，然后在失败的那一刻查看堆栈，这样您就可以检查 i 而无需更改一行代码。也就是说，我相信例外应该是什么。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-14T21:13:14.507

许多异常处理工具（ Delphi 的[MadExcept](http://madshi.net)就是其中之一）允许您在捕获异常时检索整个堆栈跟踪。所以，你会*确切地*知道它被扔到了哪里。

获取“i”的常用技术是捕获异常，并在重新抛出异常之前向其添加额外数据（istream 技术）。这很少见，但如果你坚持...

# visual-studio - 如何从 Visual Studio 引用 GAC 中的 dll？

> ID：444655
> 
> 赞同：55
> 
> 时间：2009-01-14T21:01:35.950
> 
> 标签：visual-studio, assemblies, gac

此程序集位于 GAC 中：Microsoft.SqlServer.Management.RegisteredServers.dll

如何在 Visual Studio 中添加对此程序集的引用？

我可以在 c:\windows\assembly\ 中查看文件

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2010-09-16T15:57:18.463

正如其他人所说，大多数时候您不想这样做，因为它不会将程序集复制到您的项目中，也不会与您的项目一起部署。但是，如果您像我一样，并尝试添加所有目标机器在其 GAC 中的引用，但它不是 .NET Framework 程序集：

1.  打开 Windows 运行对话框（Windows 键 + r）
2.  键入 C:\Windows\assembly\gac_msil。这是一种让你浏览 GAC 的奇怪技巧。您只能通过运行对话框访问它。希望我传播这些信息最终不会导致微软对其进行修补和阻止。（太偏执了？：P）
3.  找到您的程序集并从地址栏中复制其路径。
4.  在 Visual Studio 中打开“添加引用”对话框并选择“浏览”选项卡。
5.  粘贴到 GAC 程序集的路径中。

我不知道是否有更简单的方法，但我还没有找到。我还经常使用步骤 1-3 将 .pdb 文件与其 GAC 程序集一起放置，以确保当我以后需要使用远程调试器时它们不会丢失。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-14T21:54:04.487

将程序集注册到 GAC 中不会在添加引用对话框中放置对程序集的引用。您仍然需要为您的项目按路径引用程序集，主要区别在于您不需要使用复制本地选项，您的应用程序将在运行时找到它。

在这种特殊情况下，您只需要通过路径（浏览）引用您的程序集，或者如果您真的想在添加引用对话框中拥有它，那么您可以在注册表设置中添加其他路径。

请注意，如果您将应用程序发送给未安装此程序集的人，则需要发送它，在这种情况下，您确实需要使用 SharedManagementObjects.msi 可再发行组件。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-04-29T08:07:45.583

我创建了一个完全免费的工具，它将帮助您实现目标。Muse VSReferences 将允许您从“添加 GAC 引用”菜单项添加对项目的全局程序集缓存引用。

希望这有助于[Muse VSExtensions](http://visualstudiogallery.msdn.microsoft.com/en-us/36a6eb45-a7b1-47c3-9e85-09f0aef6e879)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-04-29T08:38:05.997

在 VS2010 中，您可以从“添加参考”窗口单击“浏览”并导航到 C:\Windows\Assembly 并添加对所需程序集的引用。请注意，这些文件可能被分组在不同的文件夹下，如 GAC、GAC_32、GAC_64、GAC_MSIL 等。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-14T21:11:34.510

在 VS 中，右键单击您的项目，选择“添加引用...”，您将看到 GAC 中存在的所有命名空间。选择 Microsoft.SqlServer.Management.RegisteredServers 并单击确定，您应该一切顺利

编辑：

这就是你大多数时候想要这样做的方式。然而，经过一番摸索，我在 MS Connect 上发现[了这个问题。](http://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=369377)MS 说这是一个已知的部署问题，他们没有解决方法。那家伙说，如果他从 GAC 文件夹中复制 dll 并将其放入他的 bin 中，它就可以工作。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-01-18T08:49:20.107

对我有用的唯一方法是将dll复制到桌面或其他东西中，添加对它的引用，然后从桌面删除dll。Visual Studio 将自行刷新，并最终从 GAC 自身引用 dll。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-14T21:14:32.727

假设您已经尝试按照上面的说明“添加参考...”但没有成功，您可以在[这里查看](http://social.msdn.microsoft.com/forums/en-US/sqlsmoanddmo/thread/7fa941bd-68d3-4ae2-9673-8ab4f7cb2602/)。他们说您必须满足一些先决条件： - .NET 3.5 SP1 - Windows Installer 4.5

编辑：根据这篇[文章](http://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=369377)，这是一个已知问题。

这[可能](http://support.microsoft.com/kb/306149/en-us)是您正在寻找的解决方案:)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-06-19T14:59:22.377

回答可能为时已晚，但我找到了一种非常简单的方法（无需破解）。

1.  将您的 dll 放入**GAC**（对于 3.5 Drag Drop 内*"C:\Windows\assembly\"*）
2.  转到项目 --> 属性
3.  单击**参考路径**（对于 3.5，它是*"C:\Windows\assembly\"*）
4.  并建立

希望能帮助到你

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-01-13T14:17:14.007

相关文件和参考资料可以在这里找到：

[http://msdn.microsoft.com/en-us/library/cc283981.aspx](http://msdn.microsoft.com/en-us/library/cc283981.aspx)

请注意有关实施/等的链接。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-08-14T09:38:44.800

我为 VS 2013 [Vitevic GAC Reference](https://visualstudiogallery.msdn.microsoft.com/b797c1e1-7483-4352-80fd-4fabfb23e0fa)找到了这个扩展。

# sql - 如何在 SQL Server Management Studio 中将列值设置为 NULL？

> ID：444657
> 
> 赞同：280
> 
> 时间：2009-01-14T21:01:51.753
> 
> 标签：sql, sql-server, ssms

如何清除单元格中的值并将其设为 NULL？

* * *

## 回答 #1

> 赞同：396
> 
> 时间：2009-01-14T21:05:05.303

我认为[@Zack](https://stackoverflow.com/a/444658/1165522)正确回答了这个问题，但只是为了涵盖所有基础：

```
Update myTable set MyColumn = NULL 
```

正如问题标题所要求的那样，这会将整个列设置为空。

要将特定列上的特定行设置为空，请使用：

```
Update myTable set MyColumn = NULL where Field = Condition. 
```

正如内部问题所要求的那样，这会将特定单元格设置为空。

* * *

## 回答 #2

> 赞同：217
> 
> 时间：2009-01-14T21:02:00.943

如果您已经打开了一个表并且想要将现有值清除为 NULL，请单击该值，然后按``Ctrl``+ ``0``。

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2009-01-14T21:04:49.097

如果您使用的是表格界面，您可以输入 NULL（全部大写）

否则，您可以运行更新语句，您可以：

```
Update table set ColumnName = NULL where [Filter for record here] 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-05-29T12:56:26.787

用这个：

```
Update Table Set Column = CAST(NULL As Column Type) where Condition 
```

像这样：

```
Update News Set Title = CAST(NULL As nvarchar(100)) Where ID = 50 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-14T21:04:55.290

Ctrl+0 或清空该值并按 Enter。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-21T17:10:19.260

连接到 Azure DB 时，CTRL+0 似乎不起作用。

但是，要创建一个空字符串，您始终可以在单元格内点击“任意键然后删除”。

# c# - 使用 Reflection.Emit 的奇怪参数序列

> ID：444662
> 
> 赞同：1
> 
> 时间：2009-01-14T21:02:58.897
> 
> 标签：c#, reflection, reflection.emit, dynamicmethod

我最近一直在看 Reflection.Emit。我写了一个简单的程序，它生成一个 DynamicMethod ，它简单地调用另一个具有相同参数的方法

```
class Program
{
    static void Main(string[] args)
    {
        Program p = new Program();
        p.Test();
    }

    public delegate void TestHandler(int a, int b, int c, int d, int e, int f);

    public void Test()
    {
        DynamicMethod method = new DynamicMethod(string.Empty, typeof(void), new[] { typeof(Int32), typeof(Int32), typeof(Int32), typeof(Int32), typeof(Int32), typeof(Int32) }, typeof(Program));

        MethodInfo method1 = typeof(Program).GetMethod("Question",BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic,null,new Type[]{typeof(Int32),typeof(Int32),typeof(Int32),typeof(Int32),typeof(Int32),typeof(Int32)},null);
        MethodInfo method2 = typeof(MethodBase).GetMethod("GetCurrentMethod", BindingFlags.Static | BindingFlags.Public | BindingFlags.NonPublic, null, new Type[] { }, null);
        MethodInfo method3 = typeof(Console).GetMethod("WriteLine", BindingFlags.Static | BindingFlags.Public | BindingFlags.NonPublic, null, new Type[] { typeof(Object) }, null);

        ILGenerator gen = method.GetILGenerator();

        gen.Emit(OpCodes.Nop);
        gen.Emit(OpCodes.Ldarg_S, 0);
        gen.Emit(OpCodes.Ldarg_S, 1);
        gen.Emit(OpCodes.Ldarg_S, 2);
        gen.Emit(OpCodes.Ldarg_S, 3);
        gen.Emit(OpCodes.Ldarg_S, 4);
        gen.Emit(OpCodes.Ldarg_S, 5);
        gen.Emit(OpCodes.Ldarg_S, 6);
        gen.Emit(OpCodes.Call, method1);
        gen.Emit(OpCodes.Nop);
        gen.Emit(OpCodes.Call, method2);
        gen.Emit(OpCodes.Call, method3);
        gen.Emit(OpCodes.Nop);
        gen.Emit(OpCodes.Ret);

        TestHandler handler = method.CreateDelegate(typeof(TestHandler)) as TestHandler;
        handler(1, 2, 3, 4, 5, 6);
    }

    public void Question(int a, int b, int c, int d, int e, int f)
    {
        Console.WriteLine("{0},{1},{2},{3},{4},{5}", a, b, c, d, e, f);
    }
} 
```

当我运行此示例时，我希望它输出 1,2,3,4,5,6 但是，它输出 2,3,4,5,6,1

我不太清楚为什么......如果你们知道使用 Reflection.Emit 的任何好的资源，你能指出我那个方向吗？我一直在使用 Reflector 和 Emit AddIn。

干杯

罗汉

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T22:35:20.113

您遇到的问题是您正在调用动态方法，而不是静态方法。您生成的方法没有对 Program 类的实例的引用。

另请注意，对于 6 参数方法，您将 7 个参数压入堆栈。第一个参数应该是对您正在调用该方法的对象的引用。

您看到的奇怪行为可能是由于没有索引 6 的参数，并且它回绕回参数数组的开头。

请参阅 VS 帮助中的“如何：定义和执行动态方法”。

您可以通过在方法调用中接受对象参数或使其成为静态来使其工作：

公共委托无效TestHandler（对象实例，int a，int b，int c，int d，int e，int f）；

```
public void Test()
{
    DynamicMethod method = new DynamicMethod(string.Empty, typeof(void), new[] { typeof(object), typeof(Int32), typeof(Int32), typeof(Int32), typeof(Int32), typeof(Int32), typeof(Int32) }, typeof(Program));

    MethodInfo method1 = typeof(Program).GetMethod("Question", BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic, null, new Type[] { typeof(Int32), typeof(Int32), typeof(Int32), typeof(Int32), typeof(Int32), typeof(Int32) }, null);
    MethodInfo method2 = typeof(MethodBase).GetMethod("GetCurrentMethod", BindingFlags.Static | BindingFlags.Public | BindingFlags.NonPublic, null, new Type[] { }, null);
    MethodInfo method3 = typeof(Console).GetMethod("WriteLine", BindingFlags.Static | BindingFlags.Public | BindingFlags.NonPublic, null, new Type[] { typeof(Object) }, null);

    ILGenerator gen = method.GetILGenerator();

    gen.Emit(OpCodes.Nop);
    gen.Emit(OpCodes.Ldarg_S, 0);
    gen.Emit(OpCodes.Ldarg_S, 1);
    gen.Emit(OpCodes.Ldarg_S, 2);
    gen.Emit(OpCodes.Ldarg_S, 3);
    gen.Emit(OpCodes.Ldarg_S, 4);
    gen.Emit(OpCodes.Ldarg_S, 5);
    gen.Emit(OpCodes.Ldarg_S, 6);
    gen.Emit(OpCodes.Call, method1);
    gen.Emit(OpCodes.Nop);
    gen.Emit(OpCodes.Call, method2);
    gen.Emit(OpCodes.Call, method3);
    gen.Emit(OpCodes.Nop);
    gen.Emit(OpCodes.Ret);

    TestHandler handler = method.CreateDelegate(typeof(TestHandler)) as TestHandler;
    handler(this, 1, 2, 3, 4, 5, 6);
}

public void Question(int a, int b, int c, int d, int e, int f)
{
    Console.WriteLine("{0},{1},{2},{3},{4},{5}", a, b, c, d, e, f);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T22:58:55.513

为了使它工作，你应该

1.  做`Question`一个`static`方法
2.  评论`gen.Emit(OpCodes.Ldarg_S,6);`
3.  `MethodInfo method1 = ...`相应地修改

一种“气味”是停止调试`Question`您无法评估`this`参考的方法。这不应该是实例方法... ;-)

编辑：操作。我刚刚看到罗伯特瓦格纳的答案，这比我的解释要好得多。如果需要，准备取消我的帖子... :-)

# perl - 什么会导致 Perl 转储内核？

> ID：444663
> 
> 赞同：2
> 
> 时间：2009-01-14T21:03:02.063
> 
> 标签：perl, memory, scripting, coredump

运行 Perl 脚本时出现此错误的最常见原因是什么：

```
Memory fault(coredump) 
```

我事先运行了两个 SQL 命令，它们只存储约 1500 行，每行有 6 个字段。SQL 在脚本中运行良好，所以我认为我不会从中得到错误。我的一半代码在它发生炸弹并给我那个错误之前运行。

那么这个错误的最常见原因是什么？我的原因可能是什么？

编辑 - 这是有效的代码

```
my $i;
$i = 0;    
while ($DBS->SQLFetch() == *PLibdata::RET_OK)
    {
        while ($i != $colnamelen)
        {
            if ($i == 1)
            {
                $rowfetch = $DBS->{Row}->GetCharValue($colname[$i]);
                $rowfetch =~ s/(?=..$)/:/;
                printline($rowfetch);
                $i++;       
            }
            if ($i == 2)
            {
                $rowfetch = $DBS->{Row}->GetCharValue($colname[$i]);
                $rowfetch =~ s/(?=..$)/:/;
                printline($rowfetch);
                $i++;       
            }
            if ($i == 10)
            {
                $rowfetch = $DBS->{Row}->GetCharValue("meetdays");
                $rowfetch =~ s/-//gi;
                printline($rowfetch);
                $i++;
            }
            if ($i == 12)
            {
                $rowfetch = $DBS->{Row}->GetCharValue("fullname");
                my ($lname, $fname) = split /,\s*/, $rowfetch;
                $rowfetch = $fname;
                printline($rowfetch);
                $rowfetch = $lname;
                printline($rowfetch);
                $i=$i+2;
            }
            else
            {
                $rowfetch = $DBS->{Row}->GetCharValue($colname[$i]);
                printline($rowfetch);
                $i++;
            }
        }
        $i=0;   
        printf $fh "\n";
    } 
```

这是不起作用的代码 - 所做的只是优化 sql fetch 命令

```
my $i;
$i = 0;      
while ($DBS->SQLFetch() == *PLibdata::RET_OK)
    {
        while ($i != $colnamelen)
        {
                $rowfetch = $DBS->{Row}->GetCharValue($colname[$i]);
            if ($i == 1)
            {
                $rowfetch =~ s/(?=..$)/:/;
                printline($rowfetch);
                $i++;       
            }
            if ($i == 2)
            {
                $rowfetch =~ s/(?=..$)/:/;
                printline($rowfetch);
                $i++;       
            }
            if ($i == 10)
            {
                $rowfetch =~ s/-//gi;
                printline($rowfetch);
                $i++;
            }
            if ($i == 12)
            {
                my ($lname, $fname) = split /,\s*/, $rowfetch;
                $rowfetch = $fname;
                printline($rowfetch);
                $rowfetch = $lname;
                printline($rowfetch);
                $i=$i+2;
            }
            else
            {
                printline($rowfetch);
                $i++;
            }
        }
        $i=0;   
        printf $fh "\n";
    } 
```

哦，顺便说一句，在这个 while 循环开始运行之前，有一个有效的 SQL 语句。我只是不想浪费空间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T21:06:03.947

您正在处理 Perl 解释器或其 C 模块之一中的错误。如果您的 Perl 二进制文件没有调试符号，请编译一个有调试符号的版本并进行核心转储。将核心转储加载到 gdb 并进行回溯。找到错误，看看它是否在最新版本中，如果不是，则提交修复它的补丁。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T22:37:26.257

您能否将有问题的脚本简化为显示相同错误的简短内容？它在脚本的哪里转储核心？

我的第一个怀疑是您正在使用的模块之一有一个不能很好玩的 XS 组件。找出脚本爆炸的地方，然后开始调查那里的部分。继续删减部分，直到你能想出重现问题的最小脚本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T21:06:05.287

当 DBD 驱动程序针对与当前系统上不同版本的共享库进行编译时，我看到了类似的事件。（比如有 MySQL4，然后升级到 MySQL5 而不重新编译 DBD）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-03T20:56:25.880

在代码更改之前，您在检查 $i 是否为您想要的值后调用了 GetCharValue。更改后，即使不是 1、2、10、12，也可以调用它。是否有可能是 $i 的值而不是那些 4 导致了问题？

# asp.net-mvc - 无法在 Vista 上附加 ASPNETDB.MDF

> ID：444667
> 
> 赞同：0
> 
> 时间：2009-01-14T21:04:28.380
> 
> 标签：asp.net-mvc, visual-studio-2008, sql-server-2008, windows-vista, ssms

我无法连接到 App_Data 中的 ASPNETDB.MDF 文件，该文件由 Visual Studio 2008 或 Vista 上的 SQL Management Studio 2008 Express 的 ASP.NET MVC Beta 项目创建。该项目位于 C:\Users\Matthew\Documents\Visual Studio 2008\Projects\MVCTest 中，因此 MDF 文件位于 C:\Users\Matthew\Documents\Visual Studio 2008\Projects\MVCTest\MVCTest\App_Data 中。

当我尝试连接到 Visual Studio 2008 Server Explorer 中的数据库时，我收到以下错误消息。

> 尝试为文件 C:\Users\Matthew\Documents\Visual Studio 2008\Projects\MVCTest\App_Data\ASPNETDB.MDF 附加自动命名数据库失败。存在同名数据库，或指定文件无法打开，或位于 UNC 共享上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-16T19:25:23.237

我将此归结为 Vista 的一些奇怪之处。我没有让 asp.net 自动创建 Forms auth 数据库，而是`aspnet_regsql -W`在我的 SQLEXPRESS 2008 实例中运行并创建了 Forms auth 数据库。我可以在 Visual Studio 2008 和 Sql Management Studio Express 2008 中附加一次，没有任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T21:08:51.803

首先，检查您是否真的有另一个附加到您的 sqlexpress 实例。如果您不这样做，请转到该文件，右键单击，转到属性，然后是安全性，然后查看权限是什么样的。如果您的用户没有读取权限，那可能就是问题所在。

# algorithm - 我在哪里可以了解有关“蚁群”优化的更多信息？

> ID：444671
> 
> 赞同：8
> 
> 时间：2009-01-14T21:05:03.433
> 
> 标签：algorithm, computer-science, graph-theory, montecarlo, ant-colony

我一直在这里和那里阅读有关使用“蚁群”模型作为优化各种类型算法的启发式方法的内容。但是，我还没有找到一篇文章或书籍以介绍性的方式讨论蚁群优化，甚至是非常详细的讨论。谁能指出我可以了解更多关于这个想法的一些资源？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T21:09:58.477

如果你知道德语（是的，对不起……），我和一个朋友写了一篇[介绍](http://activevb.de/tutorials/tut_antalgo/tut_antalgo.html)这个主题的代码，我自己觉得这很过得去。文和代码以TSP为例介绍概念。

即使**你不懂德语，看看**文本中的代码和公式，这可能仍然有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-12-10T01:46:26.987

[链接维基百科](http://en.wikipedia.org/wiki/Ant_colony_optimization)实际上让我开始了。我阅读了这篇文章并开始编码。我正在解决旅行商问题的一个邪恶变体。这是一个了不起的元启发式算法。基本上，任何可以放入图中的搜索问题（节点和边，对称与否）都可以用 ACO 解决。

注意全局和本地信息素轨迹之间的差异。当地的信息素会*阻止*一代蚂蚁走同样的路。它们使模型无法收敛。全球信息素是吸引子，每代至少应该吸引一只蚂蚁。他们鼓励经过几代人的最佳路径。

我最好的建议就是简单地使用算法。设置一个基本的 TSP 求解器和一些基本的菌落可视化。然后找点乐子。从概念上讲，与蚂蚁一起工作非常酷。你对它们的基本行为进行编程，然后将它们放开。我什至越来越喜欢他们。:)

ACO 是一种更贪婪的遗传算法。和他们一起玩。改变他们的交际行为和打包行为。您将很快开始以完全不同的方式看待网络/图形编程。这是他们最大的好处，而不是大多数人认为的食谱。

你只需要玩它才能真正理解它。书籍和研究论文只能给出一般的天价理解。就像自行车一样，您只需开始骑行。:)

到目前为止，ACO 是我最喜欢的图问题抽象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-14T21:35:12.250

国家地理不久前写[了一篇有趣的文章](http://ngm.nationalgeographic.com/2007/07/swarms/miller-text)，讨论了一些理论。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-18T19:25:28.910

这些主题的最佳资源是[Google 学者](http://scholar.google.com/)。我一直在研究蚁群优化算法，这里有一些不错的论文：

*   [蚁群优化——一种新的元启发式算法](http://www.betsaonline.com/tahghigh/AntColonyOptimizationB.pdf)
*   [蚁群优化 - 作为计算智能技术的人工蚂蚁](http://iridia.ulb.ac.be/IridiaTrSeries/IridiaTr2006-023r001.pdf)

只需[在谷歌学者上搜索“蚁群”即可](http://scholar.google.com/scholar?hl=de&lr=&safe=off&q=ant+colony&btnG=Suche&lr=)。

此外，搜索[Marco Dorigo](http://scholar.google.com/scholar?hl=de&lr=&safe=off&q=Marco+Dorigo&btnG=Suche&lr=)发表的论文。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-01-13T10:51:51.713

我很惊讶没有人提到 ACO 的圣经：

[Marco Dorigo 和 Thomas Stützle：蚁群优化](http://mitpress.mit.edu/books/ant-colony-optimization)

本书由ACO作者撰写，可读性强。你可以把它带到海滩上，享受阅读的乐趣。但它也是所有资源中最完整的，非常适合作为实现事物时的参考。

[您可以在 Google 图书上](http://books.google.co.uk/books/about/Ant_Colony_Optimization.html?id=_aefcpY8GiEC)阅读一些摘录

另一个重要的智慧来源是[ACO 主页](http://www.aco-metaheuristic.org/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T21:11:02.593

例如见[这篇](http://www.scholarpedia.org/article/Ant_colony_optimization)关于学术百科的文章。

在[What is the most effective way of find a path through a small world graph?中也有讨论。](https://stackoverflow.com/questions/221311/what-is-the-most-efficient-way-of-finding-a-path-through-a-small-world-graph)问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-14T21:36:25.350

乍一看，这似乎与[Metropolis algorithm](http://en.wikipedia.org/wiki/Metropolis-Hastings_algorithm)密切相关（或者可能是一个特例） 。所以这是另一个可能的搜索方向。

**补充：** [此 PDF 文件](http://kossi.physics.hmc.edu/courses/p170/Metropolis.pdf)包含对 1953 年 Metropolis 原始论文的引用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-18T19:42:55.800

好吧，我发现[Eric Rollins 的主页](http://eric_rollins.home.mindspring.com/)和他的 ACO 算法的不同实现（Haskell、Scala、Erlang...）很有帮助。还有 Enrique Alba 的书，标题为“Parallel Metaheuristics: A New Class of Algorithms”，您可以在其中找到一整章关于 ACO 算法及其不同用法的解释。

Hth

# sql - SQL - 在一个语句中使用查询结果作为其他两个查询的基础

> ID：444673
> 
> 赞同：2
> 
> 时间：2009-01-14T21:05:19.377
> 
> 标签：sql, optimization, count, nested

我正在做一个概率计算。我有一个查询来计算事件发生的总次数。从这些事件中，我想获得子事件发生的次数。获取总事件的查询有 25 行长，我不想只是复制 + 粘贴两次。

我想对这个查询做两件事：计算其中的行数，并计算这个查询的查询结果中的行数。现在，我能想到的唯一方法是（用复杂的查询替换 @total@ 以获取所有行，并将 @conditions@ 替换为来自@total@ 的行必须匹配的不太复杂的条件子事件）：

```
SELECT (SELECT COUNT(*) FROM (@total@) AS t1 WHERE @conditions@) AS suboccurs, 
       COUNT(*) AS totaloccurs FROM (@total@) as t2 
```

如您所见，@total@ 重复了两次。有没有办法解决？有没有更好的方法来做我想做的事情？

再次强调：@conditions@ 确实取决于@total@ 返回的内容（它会执行类似的操作`t1.foo = bar`）。

最后一点：@total@ 本身需要大约 250 毫秒。这个更复杂的查询需要大约 300 毫秒，因此 postgres 本身可能会进行一些优化。尽管如此，查询看起来非常难看，@total@ 字面上粘贴了两次。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-14T21:22:57.047

如果您的 sql 支持子查询分解，则可以使用 WITH 语句重写它。它允许子查询多次使用。With 会将它们创建为 Oracle 中的内联视图或临时表。

这是一个人为的例子。

```
WITH
x AS
(
    SELECT this
    FROM THERE
    WHERE something is true
),
y AS
(
    SELECT this-other-thing
    FROM somewhereelse
    WHERE something else is true
), 
z AS
(
    select count(*) k
    FROM X
)
SELECT z.k, y.*, x.*
FROM x,y, z
WHERE X.abc = Y.abc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T21:11:29.020

```
SELECT COUNT(*) as totaloccurs, COUNT(@conditions@) as suboccurs
FROM (@total@ as t1) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T21:12:32.700

将重复使用的子查询放入临时表中，然后从临时表中选择您需要的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-15T01:55:42.317

@EvilTeach：

我还没有看到“with”（可能没有在 Sybase 中实现 :-()。我喜欢它：在一块中完成您需要的操作，然后消失，甚至比临时表更少杂乱无章。酷。

# sql-server - 在没有预定义结构的情况下将 XML 解析为 SQL 表。可能的？

> ID：444678
> 
> 赞同：2
> 
> 时间：2009-01-14T21:06:49.780
> 
> 标签：sql-server, xml

所以使用下面的代码......我可以在*不*预定义结构的情况下解析`@xml_data`成表结构吗？

 *```
DECLARE @receiveTable TABLE(xml_data XML) DECLARE @xml_data XML
DECLARE @strSQL NVARCHAR(2000)
SET @strSQL = 'SELECT * INTO #tmp1 FROM sysobjects;
DECLARE @tbl TABLE(xml_data xml);
DECLARE @xml xml;    
Set @xml = (Select * from #tmp1 FOR XML AUTO);
INSERT INTO @tbl(xml_data) SELECT @xml;
SELECT * FROM @tbl'

INSERT INTO @receiveTable EXEC (@strSQL)    
SET @xml_data = (SELECT * FROM @receiveTable)    
SELECT @xml_data 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T19:00:05.370

与您的一样`@xml_data`，如果`/element[1]`具有相同数量的属性，`/element[n]`并且它们的顺序相同，则可以。

它不漂亮，但你可以：

```
declare @tbl_xml xml 
set @tbl_xml = (
  select @xml_data.query('
      <table>
        {for $elem in /descendant::node()[local-name() != ""] 
        return <row name="{local-name($elem)}">
          {for $attr in $elem/@*
            return <col name="{local-name($attr)}" value="{$attr}" />}
        </row>}
      </table>'
  )
)

declare @sql_def_tbl varchar(max)
select @sql_def_tbl = 
  coalesce(@sql_def_tbl,'')
    +'declare @tbl table ('+substring(csv,1,len(csv)-1)+') '
  from (
    select (
      select ''+col.value('@name','varchar(max)')+' varchar(max),'
      from row.nodes('col') r(col) for xml path('')
    ) csv from @tbl_xml.nodes('//row[1]') n(row)
  ) x

declare @sql_ins_rows varchar(max)
select @sql_ins_rows = 
  coalesce(@sql_ins_rows,'')
    +'insert @tbl values ('+substring(colcsv,1,len(colcsv)-1)+') '
  from (
    select (
      select ''''+col.value('@value','varchar(max)')+''','
      from row.nodes('col') r(col) for xml path('')
    ) colcsv from @tbl_xml.nodes('//row') t(row)
  ) x

exec (@sql_def_tbl + @sql_ins_rows + 'select * from @tbl') 
```

# asp.net-mvc - MVC：存储库和服务

> ID：444694
> 
> 赞同：5
> 
> 时间：2009-01-14T21:09:55.513
> 
> 标签：asp.net-mvc, repository-pattern

我对在存储库中定义的内容以及留给服务的内容的限制感到困惑。存储库应该只创建与数据库中的表匹配的简单实体，还是可以创建具有这些实体组合的复杂自定义对象？

换句话说：服务是否应该在存储库上进行各种 Linq to SQL 查询？还是应该在存储库中*预定义*所有查询，而业务逻辑只是决定调用哪个方法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-14T22:52:07.867

[实际上，您在这里提出了一个问题，该问题目前在开发人员社区中引起了很多讨论 - 请参阅我的存储库是否应该公开 IQueryable](http://mikehadlow.blogspot.com/2009/01/should-my-repository-expose-iqueryable.html)的后续评论？

存储库可以并且应该创建包含多个关联实体的复杂组合对象。在领域驱动设计中，这些被称为**聚合**——相关对象的集合组织成某种内聚的结构。您的代码不必单独调用`GetCustomer()`, `GetOrdersForCustomer()`，`GetInvoicesForCustomer()`您只需调用`myCustomerRepository.Load(customerId)`，就可以返回一个具有已实例化属性的深层客户对象。我还应该补充一点，如果您基于特定的数据库表返回单个对象，那么这是一种完全有效的方法，但它并不是真正的存储库*——*它只是一个数据访问层。

一方面，有一个令人信服的论点，即具有“智能”属性和延迟执行（即在您实际使用之前不加载 Customer.Orders）的 Linq-to-SQL 对象是存储库模式的完全有效实现，因为您实际上并没有运行数据库代码，所以您正在运行 LINQ 语句（然后由底层 LINQ 提供程序将其转换为 DB 代码）

另一方面，正如 Matt Briggs 的帖子所指出的，L2S 与您的数据库结构紧密耦合（每个表一个类）并且有局限性（例如，没有多对多映射） - 您最好使用 L2S用于存储库**中**的数据访问，然后将 L2S 对象映射到您自己的域模型对象并返回这些对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T21:16:55.267

存储库应该是您的应用程序中唯一了解您的数据访问技术的部分。所以它根本不应该返回由 L2S 生成的对象，而是将这些属性映射到您自己的模型对象。

如果您正在使用这种模式，您可能需要重新考虑 L2S。它为您生成了一个数据访问层，但并不能真正处理阻抗不匹配，您必须手动进行。如果您查看 NHibernate 之类的东西，则该映射是以更健壮的方式完成的。L2S 更适用于 2 层应用程序，在这种应用程序中，您需要一个可以轻松扩展的快速而肮脏的 DAL。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T23:08:04.057

如果您使用的是 LINQ，那么我认为存储库应该是您的 LINQ 语法的容器。这使您可以从模型对象接口中对数据库访问例程进行一定程度的抽象。正如上面 Dylan 提到的，对此事还有其他看法，有些人喜欢返回 IQueryable，以便他们可以在存储库之后继续查询数据库。只要您清楚自己的应用程序标准，这两种方法都没有错。 [这里有更多关于我用于 LINQ 存储库的最佳实践的信息。](http://oddiandeveloper.blogspot.com/2009/01/linq-best-practice-1-repository-pattern.html)

# asp.net - 可以在机器之间复制 cookie 来冒充用户吗？

> ID：444698
> 
> 赞同：13
> 
> 时间：2009-01-14T21:10:23.670
> 
> 标签：asp.net, security, cookies, xss, index.dat

我们有一个应用程序，除其他外，它检查 cookie 的存在并读取和解密 cookie 的内容。虽然存储在 cookie 中的数据并不敏感，但它已通过 TripleDes 加密进行了加密。今天提出了一个问题，是否可以将保存在单台 PC 上的 cookie 复制到另一台 PC 上，以及 Web 应用程序是否会检测到此复制的 cookie 在另一台机器上的存在，并最终解密它在原始 PC 上的内容。

我的问题是：我们使用标准的 ASP.NET 实现来保存 cookie（即通过 HttpResponse），index.dat 文件是否会阻止将 cookie 从一台机器移植到另一台机器？如果 index.dat 文件也被传输和复制了，或者 index.dat 中是否有一些内部结构将 cookie 与特定机器联系起来怎么办？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-14T21:16:48.307

绝对地。这是[跨站点脚本 (XSS) 攻击](http://en.wikipedia.org/wiki/Cross-site_scripting)的一种工作方式：

1.  我将javascript注入页面
2.  我等着有人看页面
3.  我注入的 javascript 向我发送了你的 cookie
4.  我以你的身份登录并做坏事

在私人测试版期间，这个特殊问题[有点 SO 。](http://www.codinghorror.com/blog/archives/001171.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-14T21:14:05.503

是的，窃取 cookie 是窃取用户会话的常用技术。

一些站点尝试将 cookie 绑定到客户端的 IP，但面对具有多个出站接口或其他非驻留设置的大型公司代理，这会失败。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-03T16:12:21.220

即使其他一切正常，如果有人可以物理访问用户的机器，他们也可以将 cookie 复制到另一台机器。

例如，如果需要，只需克隆磁盘！

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-14T21:18:52.220

除了其他答案。永远不要相信来自 Web 应用程序用户的任何东西，无论它是否已加密。

这与在客户端和服务器上验证输入的想法有关。不要相信客户端的验证已经完成。

# html - 适用于 Windows 的脱机 HTML 模板处理器

> ID：444705
> 
> 赞同：0
> 
> 时间：2009-01-14T21:11:29.363
> 
> 标签：html, templates

我正在教我的朋友如何制作网站。我想让网站保持静态，这样他就不必[还] 必须学习 PHP，不必担心在他的 Windows 机器上进行测试，担心服务器配置、安全性等。不好的是，如果没有一些工具支持，他会不得不重复很多代码，例如每一页的菜单块几乎是一样的。有什么简单的工具可以帮助他吗？

我想要在 Windows 上运行而无需太多工作的东西，即。没有 Perl、Cygwin、IIS、PHP 等。（一个简单的 GUI 工具或对此有一些特殊支持的文本编辑器会很好。）我想要一些不需要保持单独的“源”和“构建”文件版本的东西，即。带有一些特殊标记的源文件和带有常规 HTML 的构建文件。（我讨厌在每次更改代码后重新制作整个东西。）我想要一些免费且简单的东西。

有这样的事吗？

* * *

*更新：*我梦想着可以像这样工作的东西：

```
$ cat page.html
<h1>A page</h1>
<!-- insert menu -->
<!-- menu ends -->
$ cat menu.tmpl
<ul id="#menu">…&lt;/ul>
$ update-templates page.html && cat page.html
<h1>A page</h1>
<!-- insert menu -->
<ul id="#menu">…&lt;/ul>
<!-- menu ends -->
$ echo "Moo" > menu.tmpl
$ update-templates page.html && cat page.html
<h1>A page</h1>
<!-- insert menu -->
Moo
<!-- menu ends --> 
```

…仅在 GUI 中。顺便说一句：感谢 JavaScript 解决方案。我没有想到这些，但即使 JS 关闭，该网站也必须工作。

* * *

*更新：*由于我没有找到任何现有的解决方案，我将脚本编写为[Google Code project](http://code.google.com/p/turnplate/)。有一些怪癖需要处理（例如不同系统上的不同行尾），但模板替换的东西有效。该脚本需要 Perl，但除此之外，您只需双击一个图标即可更新 HTML 源代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T21:22:08.483

最简单的可能是（尽管它需要一些设置）带有服务器端包含的 Web 服务器。这是我能想到的最简单的模板形式，如果您不想从某种来源“构建” html 文件，那么您需要一些主动服务请求的东西。

我不知道它是否标准化，但 Apaches SSI 看起来像这样：

```
<!--#include file="menu.html" --> 
```

希望有帮助。

**编辑：**
我确信没有单独的源和目标/构建文件，如果没有活动的服务器就不可能实现。但是，当您评论注释标记时，我想到了一个想法，构建一个包含文件的简单 perl 脚本应该不难，替换开始注释标记和结束注释标记之间的所有内容。您还说您不想弄乱 perl，这是否包括他只需要执行的准备好的 perl 脚本？

**编辑 2**
使用 /e-regexp 修饰符的简单几行 perl 脚本就足够了，因为您使用的是 windows 我不知道您是否可以使用反引号`cat $file`，所以我添加了一个 readfile 子。

```
sub readfile($) {
  open(FILE, 'r', shift);
  my $buffer;
  read (FILE, $buffer, 2 ** 20); # one megabyte maximum.
  close(FILE);
  return $buffer;
}
sub writefile($$) {
  open(FILE, 'w', shift);
  print FILE shift;
  close(FILE);
}

for my $file(@ARGV) {
  my $content = readfile($file);
  $content =~ s/\<!--\s+include\s+(\S+\)\s+--\>.*?\<!--\s+end\s+\1\s+--\>/"<!-- include $1 -->".readfile($1)."<!-- end $1 -->"/ge;
  writefile($file, $content);
} 
```

但要小心，崩溃或有点贪婪的替换（可能是由于拼写错误）会杀死整个文件，而这无需维护源文件。我也不确定 LHS 是否会与反向引用正确匹配，我需要调查一下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T02:06:16.600

我过去设置了类似的东西。我只将我的内容编写为一系列 HTML 文件，而不用担心`<html>`、`<head>`、`<body>`、 菜单等 - 只是内容。PHP 脚本读取该目录中的所有文件并执行一些非常简单的模板（字符串替换）来创建输出文件。我知道您说过您希望避免使用源代码和构建版本，但这种方法实际上非常简单，因为脚本会自动找到您的所有源文件。另外，您可以从命令行（或作为批处理文件）运行脚本，因此您无需费心设置服务器或任何东西：只需下载 php 并将其解压缩到目录中。这是我的意思的一个非常粗略的想法：

模板文件：page.tpl

```
<html>
<head> ... whatever ...</head>
<body>
    <div id="menu">
        Item 1
        Item 2
        (this could even be generated automatically from the files)
    </div>
    <div id="content">
        <!-- CONTENT -->
    </div>
</body>
</html> 
```

内容页面`src/page1.txt`：

```
<p>This is my page content.</p> 
```

PHP脚本伪代码：

```
$template = get_contents(page.tpl)
for each of the .txt files in the src directory {
    $c = get_contents($file)
    write(string_replace("<!-- CONTENT -->", $c, $template)) into page1.html
} 
```

运行脚本：

```
$ php script.php 
```

当然，这适用于您选择的任何语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T21:39:50.023

这是一个解决方法。

您可以使用 JavaScript 包含，并包含本地文件。不过，您必须通过 JavaScript 将 HTML 插入文档中的正确位置。学习如何做到这一点本身可能是一个坏主意。但是，在包含文件中转义引号可能会让人头疼。

文件：

```
<p id='moo'></p>
<script type="text/javascript" src="moo.js"></script> 
```

moo.js：

```
$('moo').innerHTML="hello world" 
```

（我正在使用[原型](http://prototypejs.org)快捷方式）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T08:35:05.630

如果您愿意花一些钱，那么[Adob​​e Dreamweaver](http://www.adobe.com/products/dreamweaver/)有一些非常不错的[模板](http://www.adobe.com/devnet/dreamweaver/templates.html)功能，可以像您描述的那样工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T21:17:32.190

好的旧复制和粘贴将公共元素从一页转移到另一页有什么问题吗？或者更好的是，制作一个简单的文本文件，其中已经安排了所有常见元素，然后当他想要制作一个新页面时，只需复制该文件并重命名该副本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T21:41:50.690

在 apache 建议上搭便车：我认为 Windows 有一个可以安装的“个人”IIS 服务器。放入足够多的 javascript 以获取每个页面上的重复块并更新粘贴的占位符标记上的内部 html。

可能想给他一个漂亮的 CSS 文件并包含要粘贴的行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-15T01:51:02.513

安装tomcat :-)

如果这很可口，不要使用 java 代码，只需给你的朋友一个神奇的秘诀，将 include 调用放在带有有趣的 jsp 后缀的“神奇”html 文件中？？？

好的，这与设置 PHP 差不多，不是吗。

如果你想生成一些东西，你可能需要一些软件来完成它。我不知道你的“疼痛阈值”是多少。

# wcf - 我的 IIS 托管 wcf 服务在什么用户帐户下运行？

> ID：444709
> 
> 赞同：3
> 
> 时间：2009-01-14T21:12:37.940
> 
> 标签：wcf, iis, identity, impersonation

当我在 IIS 7 中托管我的 .Net WCF 服务时，它在哪个用户帐户下运行？

是`IUSR_machine`账户吗？

我在不同帐户下运行的最简单方法是什么？（仅针对此服务，我不希望托管在我的 IIS 中的其他内容受到影响）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T21:40:20.757

要仅更改单个应用程序，您需要创建一个新的应用程序池并更改该池的标识。这样，所有其他应用程序将继续按原样运行，因为使用您的新应用程序池的应用程序将使用该新身份。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T05:03:17.617

要为特定网站设置匿名用户使用的帐户，请打开该网站的属性。然后，转到目录安全选项卡。单击身份验证和访问控制框中的“编辑”按钮。在出现的窗口中，您可以指定将用于匿名访问该站点的用户帐户。这将控制用于访问文件的帐户，但可能不适用于 ISAPI 应用程序（在这种情况下，将需要一个具有自己权限的新应用程序池，如前所述）。

# c++ - 处理 COM 相关错误的有效方法 (C++)

> ID：444726
> 
> 赞同：1
> 
> 时间：2009-01-14T21:17:33.267
> 
> 标签：c++, com

**在C++**中处理 COM 相关错误的有效方法。

例如：

```
 switch (HRESULT_CODE(hresult)) {
    case NOERROR:
                cout << "Object instantiated and "
                "pointer to interface IS8Simulation " 
                "obtained" << endl;
        break;
    //Specifed Class not registered
    case REGDB_E_CLASSNOTREG:
        cerr << "Specified Class not registered." << endl;
        exit (EXIT_FAILURE);
        break;
    case CLASS_E_NOAGGREGATION:
                cerr << "The Class does not support aggregation "
                "(or class object is remote)." << endl;
        exit (EXIT_FAILURE);
        break;
    //Interface not supported - exit with error
    case E_NOINTERFACE:
        cerr << "No such interface supported." << endl;
        exit (EXIT_FAILURE);
        break;
    case E_UNEXPECTED:
    default:
        cerr << "Catastrophic failure." << endl;
        exit (EXIT_FAILURE);
        break;
 } 
```

与**前者**相比：

```
if (SUCCEEDED(hresult))
{
            cout << "The COM library was initialised"
            " successfully on this thread" << endl;
} else {
            cerr << "Fatal Error: COM library was not"
            " initialised" << endl;
    exit (EXIT_FAILURE);
} 
```

问题：

*   还有其他更适用的方法吗？

问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T21:23:02.693

使用[FormatMessage](http://msdn.microsoft.com/en-us/library/ms679351.aspx)获取错误文本——它已经知道如何查找大多数 HRESULT 和 Win32 结果代码的本地化文本。

使用`FAILED`和`SUCCEEDED`宏来确定某些东西是否有效。

`exit`采用 32 位数字。您可以使用 HRESULT 作为您的进程退出代码：

```
HRESULT hr;
if (FAILED(hr = p->QueryInterface(...)))
{
    cerr << MessageFromHResult(hr); // left as an exercise for the reader
    exit(hr);
} 
```

# c# - 在虚拟模式下循环遍历 ListView 中的所有元素

> ID：444727
> 
> 赞同：0
> 
> 时间：2009-01-14T21:17:46.120
> 
> 标签：c#, .net, winforms, listview

我有一个报告模块，它从 ListViews 创建 PDF 报告。

现在，我有一个处于虚拟模式的 ListView，因此我无法遍历 Items 集合。

如何从报告模块遍历列表视图中的所有元素？

我可以得到`VirtualListSize`属性，所以我知道列表中有多少元素。我可以以某种方式`RetreiveVirtualItem`显式调用吗？

报告模块不知道 ListView 中的底层列表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T21:21:43.400

所以，虚拟模式下的列表视图只是底层列表的可视化，对吗？

也许报告应该从底层列表而不是虚拟列表视图中获取数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T17:39:11.603

在虚拟 ListView 中，您不能迭代`Items`，但您仍然可以通过它们的索引访问它们：

```
for (int i = 0; i <  theVirtualListView.VirtualListSize; i++) {
    this.DoSomething(theVirtualListView.Items[i]);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-15T06:47:23.040

我想出的最佳解决方案是在报表类中有一个委托，其中传递与我在 ListView.RetrieveVirtualItem 上设置的委托相同的委托。

```
class Report {
   [...]
   // Called when the content of an VirtualItem is needed.
   public event RetrieveVirtualItemEventHandler RetrieveVirtualItem;
   [...]

   private AddRows() {
      for (int i = 0; i < GetItemCount(); i++) 
         AddRow(GetItem(i));
   }

   private ListViewItem GetItem(n) {
      if (_listView.VirtualMode)
         return GetVirtualItem(n);
      return _listView.Items[n];
   }

    private ListViewItem GetVirtualItem(int n)
    {
        if (RetrieveVirtualItem == null)
            throw new InvalidOperationException(
                "Delegate RetrieveVirtualItem not set when using ListView in virtual mode");

        RetrieveVirtualItemEventArgs e = new RetrieveVirtualItemEventArgs(n);
        RetrieveVirtualItem(_listView, e);
        if (e.Item != null)
        {
            return e.Item;
        }
        throw new ArgumentOutOfRangeException("n", "Not in list");
    }

   private static int GetItemsCount()
   {
      if (_listView.VirtualMode)
          return _listView.VirtualListSize;
      return _listView.Items.Count;
   }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T22:12:11.817

您始终可以将底层列表暴露给外界：

```
foreach (object o in virtListView.UnderlyingList)
{
  reportModule.DoYourThing(o);
} 
```

# asp.net - Javascript：在水平 Div 中延迟加载图像？

> ID：444730
> 
> 赞同：0
> 
> 时间：2009-01-14T21:18:26.043
> 
> 标签：asp.net, javascript, html, lazy-loading

我有一个 div 有一堆水平显示的缩略图（带有水平滚动条）。有没有办法延迟加载这些缩略图，并且只在用户水平滚动到他们的位置时才显示它们？我见过的所有示例都检查浏览器窗口，而不是 div。

这是针对参赛作品的，因此有时会有数百个参赛作品，这会极大地影响性能。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T00:14:21.007

~~我为 jQuery 分叉了[延迟加载插件](http://plugins.jquery.com/project/lazyload)，并在容器 div 中添加了对延迟加载图像的支持。~~jQuery的[延迟加载插件](http://plugins.jquery.com/project/lazyload)现在直接支持这一点。如果需要，删除对 j​​Query 的依赖或将其调整到另一个库应该不会太难。

~~您可以从 github 获取我的分叉项目：http: [//github.com/silentmatt/jquery_lazyload/tree/master](http://github.com/silentmatt/jquery_lazyload/tree/master)。~~

要使用它，就像在原始图像中一样调用lazyload，除了你需要添加一个带有滚动div元素的“容器”选项。因此，如果您的 HTML 如下所示：

```
<div id="container" style="width: 765px; overflow: scroll;">
    <img src="image1.jpg" width="765" height="574">
    <img src="image2.jpg" width="765" height="574">
    <img src="image3.jpg" width="765" height="574">
    ...
</div> 
```

你会这样调用lazyload：

```
$("#container img").lazyload({ container: $("#container") }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T21:24:00.087

请参阅我遇到类似问题的问题。[Jason Bunting](https://stackoverflow.com/users/1790/jason-bunting)给了我一个方便的小脚本来分块加载图像：

[如何使用预加载器和多个图像显示加载状态？](https://stackoverflow.com/questions/334325/how-to-display-loading-status-with-preloader-and-multiple-images)

# java - 在 Ubuntu 上安装 Tomcat 5.5（使用 apt）使 CATALINA_HOME 未设置

> ID：444731
> 
> 赞同：2
> 
> 时间：2009-01-14T21:18:29.553
> 
> 标签：java, linux, tomcat, ubuntu

我正在设置使用 Java 编写 Web 应用程序的开发环境，我需要一些帮助。

*我做了什么：*

**从 Sun 安装 Java SE 6**

我安装了（sudo apt-get install ...）以下软件包（一次一个，因为其中一些需要用户交互）以从 Sun 获取 Java SE 6：sun-java6-bin sun-java6-doc sun-java6-fonts sun -java6-javadb sun-java6-jdk sun-java6-jre sun-java6-plugin sun-java6-source 。

我还通过将 JAVA_HOME=”/usr/lib/jvm/java-6-sun/” 添加到 /etc/environment 来设置 JAVA_HOME。

**开始安装和配置 Tomcat 5.5**

我安装了（sudo apt-get install ...）以下软件包：tomcat5.5 tomcat5.5-admin

**我目前拥有的：**

我能够连接到[http://localhost:8180/admin](http://localhost:8180/admin)并获取我通过安装 tomcat5.5-admin 软件包安装的管理 Web 应用程序。Tomcat 服务器作为守护进程运行。

**我的问题和疑问：**

1.  似乎没有定义环境变量 $CATALINA_HOME。我应该如何定义它？（可能和我的 $JAVA_HOME 一样？但如果是这样，我应该分配哪个路径？）
2.  要部署战争，我可以将 JAR 复制到 $CATALINA_HOME/webapps 吗？还是我需要更改战争的文件权限？（这里我假设 $CATALINA_HOME 设置正确。）
3.  我安装的管理 Web 应用程序需要什么用户名和密码？我该如何改变它们？
4.  我应该考虑 Ubuntu 上的 Tomcat 5.5 的最佳实践吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T13:11:06.227

您必须手动添加它。您可以在文件中执行此操作：

```
 ~/.bashrc  <---- for session-wide variables
 /etc/environment <---- for system-wide variables 
```

您应该通过添加以下行在此处设置 CATALINA_HOME：

```
 CATALINA_HOME=PATH_TO_WHERE_YOU_ARE_RUNNING_TOMCAT 
```

之后，如果您编辑了 .bashrc，请重新加载文件，输入：

```
 Source .bashrc 
```

如果是 /etc/environment，我相信你也可以做同样的事情。如果这不起作用，请尝试注销然后登录。如果这不起作用，只需重新启动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T02:46:48.173

1.  安装 Tomcat 的路径。我不知道，我在openSUSE上，通常将tomcat安装在我的首选目录中，很可能在我的/home/adeel/下。*您可以在控制台上使用whereis tomcat*命令检查它，或者可以尝试*whereis catalina*。它可能会给你你的tomcat的路径。这次我在我的Netbeans下运行tomcat，只是为了试一试，并没有设置环境变量。

2.  您可以只复制*CATALINA_HOME/webapps/*目录下的*war*文件。或者你甚至可以把它炸开。我认为你不需要改变你的*战争*特权。

***   您可以在 *CATALINA_HOME/webapps/tomcat-users.xml*中设置它。下面是例子，

    <?xml 版本='1.0' 编码='utf-8'?>

    <tomcat-users>
    <role rolename="manager"/>
    <role rolename="tomcat"/> <user username="tomcat" password="tomcat" roles="tomcat,manager"/>

    </tomcat-users>

    *   并不真地。目前我唯一的建议是将其设置为用户变量，而不是系统变量。** 

 **注意：如果您在 Netbeans 下使用 Tomcat，则在 IDE 中提供了一些 tomcat 配置，例如，您可以更改端口、用户名/密码、VM 选项等。注意 Netbeans 保留自己的位置和文件以供 web- Tomcat 中的应用程序部署，并且不使用*CATALINA_HOME/webapps/*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T23:41:47.407

您可以执行“echo $CATALINA_HOME”来检查它是否已被定义。

应该设置为tomcat的安装目录。我的设置为 /usr/local/tomcat

你在使用 IDE 吗？在 NetBeans 中添加 Tomcat 作为服务器时，我能够为管理员提供用户名和密码。您需要先设置 Catalina_Home。

使用 NetBeans 在 Ubuntu 上安装 Tomcat（通过 sudo apt-get install 和突触管理器）时遇到了一些麻烦。最好的选择是下载 tar 文件（使用 wget）并将其解压缩到您选择的路径。

# c# - C#的多线程和并发性

> ID：444739
> 
> 赞同：3
> 
> 时间：2009-01-14T21:22:24.240
> 
> 标签：c#, multithreading, concurrency, asynchronous

在 Windows 窗体窗口中，多个事件可以触发异步方法。此方法下载文件并缓存它。我的问题是我希望该方法执行一次。换句话说，我想防止文件被多次下载。

**如果下载文件的方法被触发两次，我希望第二次调用等待文件（或等待第一个方法完成）。**

有人知道如何实现这一目标吗？

**更新**：我只是想防止不必要的下载。在我的例子中，当客户端将鼠标悬停在 ListBox 中的某个项目上超过几毫秒时，我们开始下载。我们假设用户会点击并请求文件。可能发生的情况是用户将鼠标悬停在项目上一秒钟，然后单击。在这种情况下，两个下载开始。我正在寻找处理这种情况的最佳方法。

**更新2：：**用户有可能将鼠标移到多个项目上。结果，将发生多次下载。我对这种情况并不是很严格，但现在如果我们遇到这种情况，我们不会放弃下载。该文件将被下载（文件通常在 50-100kb 左右），然后将被缓存。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T21:25:30.177

维护表单变量中正在发生的事情的状态，并让您的异步方法在执行任何操作之前检查该状态。不过，请确保您同步访问它！互斥量和信号量对这类事情很有用。

如果您可以同时下载不同的文件，则需要在列表中跟踪下载的内容以供参考。

如果一次只能下载一个文件，并且您不想排队，您也可以在下载内容时取消挂钩事件，并在下载完成后重新挂钩。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T21:50:36.010

这是一个支持多个文件下载的虚拟实现：

```
 Dictionary<string, object> downloadLocks = new Dictionary<string, object>();

    void DownloadFile(string localFile, string url)
    {
        object fileLock; 
        lock (downloadLocks)
        {
            if (!downloadLocks.TryGetValue(url, out fileLock))
            {
                fileLock = new object(); 
                downloadLocks[url] = fileLock;
            }
        }

        lock (fileLock)
        {
            // check if file is already downloaded 

            // if not then download file
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T21:24:30.990

您可以简单地将您的方法调用包装在这样的锁定语句中

```
private static readonly Object padLock = new Object();

...
lock(padLock)
{
    YourMethod();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T21:24:53.313

我不确定如何在 C# 中完成，但在 java 中，您将在下载文件之前同步类中的私有静态最终对象。这将阻止任何进一步的请求，直到当前请求完成。然后，您可以检查文件是否已下载并采取适当措施。

```
private static final Object lock = new Object();
private File theFile;

public method() {
  synchronized(lock) {
    if(theFile != null) {
      //download the file
    }
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T22:02:43.083

一般来说，我同意[Michael](https://stackoverflow.com/questions/444739/multithreading-and-concurency-with-c#444756)`lock`的观点，在实际获取文件的代码周围使用 a 。但是，如果有一个事件总是首先发生并且您始终可以加载文件，那么请考虑使用[Futures](http://ayende.com/Blog/archive/2008/01/02/Its-the-future-now.aspx)。在初始事件中，开始未来的运行

```
Future<String> file = InThe.Future<String>(delegate { return LoadFile(); }); 
```

在所有其他事件中，等待未来的价值

```
DoSomethingWith(file.Value); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T22:12:46.977

如果您希望一个线程等待另一个线程完成任务，您可能需要使用 ManualResetEvent。也许是这样的：

```
private ManualResetEvent downloadCompleted = new ManualResetEvent();
private bool downloadStarted = false;

public void Download()
{
   bool doTheDownload = false;

   lock(downloadCompleted)
   {
       if (!downloadStarted)
       { 
            downloadCompleted.Reset();
            downloadStarted = true;
            doTheDownload = true;
       }
   }

   if (doTheDownload)
   {
       // Code to do the download

       lock(downloadCompleted)
       {
           downloadStarted = false;
       }
       // When finished notify anyone waiting.
       downloadCompleted.Set();
   }
   else
   {
       // Wait until it is done... 
       downloadCompleted.WaitOne();
   }

} 
```

# oracle - Hinky Oracle 连接（TNSNAMES.ora 帮助）

> ID：444741
> 
> 赞同：2
> 
> 时间：2009-01-14T21:23:00.243
> 
> 标签：oracle, tnsnames, ora-12545

我们最近更改了物理数据库、新服务器、新位置、相同的数据库架构和数据，自从更改后，每当我们尝试在自己的桌面类型应用程序中直接连接到数据库时，大约有一半的时间会出现此错误：

```
SQL*Loader-704: Internal error: ulconnect: OCIServerAttach[0]
ORA-12545: Connect failed because target host or object does not exist 
```

其余时间，它会立即连接，没有任何问题。我们通过 JDBC 建立连接的应用程序似乎没有任何问题，但我们在执行 tnsnames.ora 查找时会遇到问题（或者至少这是我的预感）。TNSPING 100% 有效，但使用像 SQLLDDR 这样的 oracle 可执行文件至少有 50% 的时间会失败。这是我们的 TSNNAMES 文件的匿名 snppet 和 TNSPING 输出：

```
DB_CONNECTION =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = TCP)(HOST = 1.2.3.4)(PORT = 1521))
  )
  (CONNECT_DATA =
    (SERVICE_NAME = MY.URL.COM)
  )
) 
```

和 TNSPING：

```
C:\>TNSPING DB_CONNECTION
TNS Ping Utility for 32-bit Windows: Version 9.2.0.1.0

Copyright (c) 1997 Oracle Corporation.  All rights reserved.

Used parameter files:
C:\oracle\ora92\network\admin\sqlnet.ora

Used TNSNAMES adapter to resolve the alias
Attempting to contact (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)
(HOST = 1.2.3.4)(PORT = 1521))) (CONNECT_DATA = (SERVICE_NAME = MY.URL.COM)))
OK (200 msec) 
```

我有数据库的 SID，这是 JDBC 连接所依赖的，但将其添加到 tnsnames.ora 并不能提高建立连接的几率。我不太了解 oracle 如何使用 tnsnames 文件来智能地解决此问题，因此，如果您有建议或发现明显缺失的内容，请告诉我。

编辑：新数据库可能是两个负载平衡的数据库，这可能是问题的一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T18:45:25.173

我们最近在我们的应用程序中遇到了类似的问题。应用程序有时会连接到 Oracle RAC，有时会报 ORA-12545。简而言之，问题是当我们在 TNSNAMES.ORA 中使用虚拟 IP 地址时，服务器具有真实名称。一旦我们通过 system32\drivers\etc\hosts 文件添加了服务器名称到 IP 地址的映射，一切都开始正常工作。

[我在我的博客 <shameless advert> http://dcarapic.blogspot.com/2009/04/intermittent-ora-12545-error.html](http://dcarapic.blogspot.com/2009/04/intermittent-ora-12545-error.html) </shameless advert>中写了更多内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T00:38:12.597

啊，必须喜欢间歇性问题:) （在下面我不得不替换下划线字符，因为我不知道这个 wiki 语言的转义字符）

您是否总是使用同一个操作系统用户来连接和执行 tnsping？

检查指向不同 tnsnames.ora 位置的环境变量 TNS[下划线]ADMIN。扫描客户端是否有重复的 tnsnames.ora；在 $TNS[underscore]ADMIN 指向的位置或不同的 $ORACLE[underscore]HOMES 中（例如，如果您安装了 2 个 Oracle 客户端）。

同样检查您是否对所有连接尝试和 tnsping 使用相同的 $ORACLE[underscore]HOME 和 $PATH 环境变量。（例如，始终相同的操作系统用户或每个用户具有相同的值）

我看到 tnsping 输出报告版本 9.2，所以这不太可能，但在 11g 中，DB 向侦听器注册，这可能需要一分钟左右。（也许 10 克也是如此）。在此之前尝试连接将找不到目标。

另一种不太可能的可能性 - 具有相同服务名称的服务是否仍在旧主机服务器上发布？如果可能，请将其删除。

之后，我将开始研究网络本身。ping 服务器总是成功且快速的吗？如果您在 tnsnames.ora 中使用主机名而不是 IP，主机名是否可靠地解析为正确的 IP (nslookup)。是否有本地防火墙，如果有，它的行为如何？

问候卡尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T18:54:12.237

如果您正在使用`Oracle 10g`，则可以改用`Easy Connect`处理程序：

```
//servername/instancename 
```

,

```
//1.2.3.4/my.url.com 
```

在你的情况下。

**它对许多**问题免疫`TNSNAMES`。

# c++ - 在 C++ 中将数组作为函数参数传递

> ID：444746
> 
> 赞同：22
> 
> 时间：2009-01-14T21:24:11.180
> 
> 标签：c++, arrays, pointers, parameters, arguments

在 C++ 中，数组不能简单地作为参数传递。这意味着如果我创建一个这样的函数：

```
void doSomething(char charArray[])
{
    // if I want the array size
    int size = sizeof(charArray);
    // NO GOOD, will always get 4 (as in 4 bytes in the pointer)
} 
```

我无法知道数组有多大，因为我只有一个指向数组的指针。

在不更改方法签名的情况下，我有哪种方式来获取数组的大小并迭代它的数据？

* * *

**编辑：**只是关于解决方案的补充。具体来说，如果 char 数组是这样初始化的：

```
char charArray[] = "i am a string"; 
```

然后`\0`已经附加到数组的末尾。在这种情况下，答案（标记为已接受）开箱即用，可以这么说。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-14T21:47:31.193

使用模板。这在技术上不符合您的标准，因为它会更改签名，但不需要修改调用代码。

```
void doSomething(char charArray[], size_t size)
{
   // do stuff here
}

template<size_t N>
inline void doSomething(char (&charArray)[N])
{
    doSomething(charArray, N);
} 
```

Microsoft 的[Secure CRT 函数](http://msdn.microsoft.com/en-us/library/td1esda9%28VS.80%29.aspx)和 STLSoft 的[array_proxy](http://www.stlsoft.org/doc-1.9/classstlsoft_1_1array__proxy.html)类模板使用了这种技术。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-01-14T21:25:27.743

不改签名？附加一个哨兵元素。特别是对于 char 数组，它可能`'\0'`是用于标准 C 字符串的空终止符。

```
void doSomething(char charArray[])
{
    char* p = charArray;
    for (; *p != '\0'; ++p)
    {
         // if '\0' happens to be valid data for your app, 
         // then you can (maybe) use some other value as
         // sentinel
    }
    int arraySize = p - charArray;

    // now we know the array size, so we can do some thing
} 
```

当然，那么您的数组本身不能包含哨兵元素作为内容。对于其他类型的（即非字符）数组，它可以是任何不是合法数据的值。如果不存在这样的值，则此方法不起作用。

此外，这需要调用方的合作。您确实必须确保调用者保留一个`arraySize + 1`元素数组，并*始终*设置哨兵元素。

但是，如果您真的无法更改签名，那么您的选择就相当有限。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-14T22:03:35.017

在数组的第一个元素中传递长度实际上曾经是一种非常常见的解决方案。这种结构通常被称为`BSTR`（用于“BASIC 字符串”），尽管这也表示不同（但相似）的类型。

与公认解决方案相比的优势在于，对于大字符串，使用哨兵确定长度的速度很慢。缺点显然是这是一个相当低级的黑客攻击，既不尊重类型也不尊重结构。

在下面给出的形式中，它也仅适用于长度 <= 255 的字符串。但是，这可以通过将长度存储在一个以上字节中来轻松扩展。

```
void doSomething(char* charArray)
{
    // Cast unnecessary but I prefer explicit type conversions.
    std::size_t length = static_cast<std::size_t>(static_cast<unsigned char>(charArray[0]));
    // … do something.
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-14T22:44:41.577

通常，在使用 C 或低级 C++ 时，您可能会考虑重新训练您的大脑，不要考虑将数组参数写入函数，因为 C 编译器无论如何都会将它们视为指针。本质上，通过键入这些方括号，您是在自欺欺人地认为正在传递一个真正的数组，其中包含大小信息。实际上，在 C 中您只能传递指针。功能

```
void foo(char a[])
{
    // Do something...
} 
```

是，从 C 编译器的角度来看，完全等同于：

```
void foo(char * a)
{
    // Do something
} 
```

显然，nekkid char 指针不包含长度信息。

如果您被困在角落并且无法更改函数签名，请考虑使用上面建议的长度前缀。*一个不可移植但兼容的技巧是在位于数组之前*的size_t 字段中指定数组长度，如下所示：

```
void foo(char * a)
{
    int cplusplus_len = reinterpret_cast<std::size_t *>(a)[-1];
    int c_len = ((size_t *)a)[-1];
} 
```

显然，您的调用者需要在将它们传递给 foo 之前以适当的方式创建数组。

不用说这是一个可怕的 hack，但这个技巧可以在紧要关头摆脱麻烦。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-14T21:26:30.987

如果它是空终止的， strlen() 会起作用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-14T21:26:36.430

您无法`charArray`单独确定大小。该信息不会自动传递给函数。

当然，如果它是一个以 null 结尾的字符串，您可以使用`strlen()`，但您可能已经考虑过了！

考虑传递一个`std::vector<char>`& 参数，或者一对指针，或者一个指针加上一个大小参数。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-14T21:28:44.163

这实际上是 C 而非 C++，在 C++ 中您可能更愿意使用 std::vector。然而，在 C 中没有办法知道数组的大小。如果数组是在当前范围内声明的，编译将允许您执行 sizeof，并且仅当它使用大小显式声明时（**编辑：**和“具有大小”，我的意思是它要么是用整数大小声明的）或在声明时初始化，而不是作为参数传递，感谢您的反对）。

C 中常见的解决方案是传递第二个参数来描述数组中元素的数量。

**编辑：**
对不起，错过了不想更改方法签名的部分。然后除了其他人描述的那样没有解决方案，如果数组中有一些不允许的数据，它可以用作终止符（C字符串中的0，-1也很常见，但这取决于你的实际数据类型，假设 char 数组是假设的）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-14T21:34:12.703

为了让函数知道传递给它的数组中的项目数，您必须执行以下两项操作之一：

1.  传入一个大小参数
2.  以某种方式将大小信息放入数组中。

您可以通过以下几种方式执行后者：

*   用 NULL 或其他一些不会出现在正常数据中的标记来终止它。
*   如果数组包含数字，则将项目计数存储在第一个条目中
*   如果数组包含指针，则存储指向最后一个条目的指针

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-06-07T06:03:57.450

尝试使用 strlen(charArray); 使用 cstring 头文件。这将产生包括空格在内的字符数，直到它到达结尾“。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-18T08:52:22.907

保证您在 32 位 PC 中收到 4，这是正确的答案。[因为这里](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=241)和[这里](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=207)解释的原因。简短的回答是，您实际上是在测试指针而不是数组的大小，因为“数组被隐式转换或衰减为指针。唉，指针不存储数组的维度；它不甚至告诉你有问题的变量是一个数组。”

现在您正在使用 C++，[boost::array](http://www.boost.org/doc/libs/1_38_0/doc/html/array.html)是比原始数组更好的选择。因为它是一个对象，所以您现在不会丢失维度信息。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2012-11-19T17:49:18.153

我认为你可以这样做：

```
size_t size = sizeof(array)/sizeof(array[0]); 
```

PS：我觉得这个题目的标题也不对。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2013-01-16T08:36:22.510

伙计，您可以有一个全局变量来存储数组的大小，该数组可以在整个程序中访问。至少您可以将数组的大小从 main() 函数传递给全局变量，并且您甚至不必更改方法签名，因为该大小将在全局范围内可用。

请看例子：

```
#include<...>
using namespace std;

int size; //global variable

//your code

void doSomething(char charArray[])
{
    //size available

} 
```

# c# - Spring.net 删除所有 adotemplate 连接？

> ID：444750
> 
> 赞同：0
> 
> 时间：2009-01-14T21:25:07.137
> 
> 标签：c#, sql-server, spring.net

我有一个通过 spring.net AdoTemplate 连接到数据库的应用程序。我负责创建一种恢复数据库方法，该方法使应用程序保持运行但断开网络连接，以便删除旧数据库并启动新数据库。我的问题是如何删除此应用程序与此 AdoTemplate 的所有当前连接？我在 spring 1.1 中没有看到任何删除网络连接的公共方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T22:17:30.090

AdoTemplate 和 SQL 数据库之间没有物理“连接”。撇开事务不谈，AdoTemplate 为从 ADO.NET 执行的每个方法创建一个新的 SqlConnection 对象，然后执行一个命令并释放 SqlConnection 对象。在幕后，ADO.NET 将物理连接缓存到池中的数据库。当您创建一个新的 SqlConnection 对象时，将从池中获取其中 1 个缓存的物理连接来为该 SqlConnection 提供服务。这意味着，您将需要不同的策略来解决您的问题。我想到的一种策略是从 sysprocesses 数据库中获取活动连接列表并对其执行 KILL 语句。简短的谷歌搜索提出了这篇[文章](http://www.sqlservercentral.com/scripts/Maintenance+and+Management/30024/). 请注意，本文指的是 mssql 2000。我很确定，您需要更多地搜索 google 才能找到 2005 年的解决方案。自 2005 年以来，它不再被允许访问系统表。

hth，埃里希

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T21:14:32.037

最终效果很好的是：

```
 SqlConnection.ClearAllPools();
   // if any connections were being used at the time of the clear, hopefully waiting
   // 3 seconds will give them time to be released and we can now close them as well
   Thread.Sleep(3000);
   //clear again
   SqlConnection.ClearAllPools(); 
```

# nhibernate - 删除父级时如何使 NHibernate 删除子级引用？

> ID：444753
> 
> 赞同：5
> 
> 时间：2009-01-14T21:25:21.847
> 
> 标签：nhibernate

我有一个这样映射的 NewsFeed 对象：

```
<class name="NewsFeed">
    <id name="NewsFeedId">
        <generator class="guid"/>
    </id>

    <property name="FeedName" not-null="true" />
    <property name="FeedURL" not-null="true" />
    <property name="FeedIsPublished" not-null="true" />
</class> 
```

可以拥有一组他们可能感兴趣的选定提要的用户，映射如下：

```
<class name="SystemUser">
    <id name="SystemUserId">
        <generator class="guid"/>
    </id>

    <set name="SelectedNewsFeeds" table="SystemUserSelectedNewsFeeds" cascade="all">
        <key column="SystemUserId" />
        <many-to-many column="NewsFeedId" class="NewsFeeds.NewsFeed, Domain"/>
    </set>

</class> 
```

我想要发生的是，当我删除父 NewsFeed 时，所有 SelectedNewsFeed 引用也会被删除，而无需加载每个 SystemUser 并手动删除 NewsFeed。

实现这一目标的最佳方法是什么？

**更新**：删除 NewsFeed 时，使用 cascade="all-delete-orphan" 而不是 "all" 仍然会导致异常：

> DELETE 语句与 REFERENCE 约束“FKC8B9DF81601F04F4”冲突。冲突发生在数据库“System”、表“dbo.SystemUserSelectedNewsFeeds”、列“NewsFeedId”中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T15:38:48.380

JMCD

你的第二种方法：

> 另一种选择是通过中间的连接类打破多对多关系，nHiberate 将能够确定父子关系并且级联应该工作。

实际上是 nHibernate 的人们在他们的文档中推荐的。

> **不要使用奇异的关联映射。**
> 
> 真正多对多关联的良好用例很少见。大多数时候，您需要存储在“链接表”中的附加信息。在这种情况下，最好使用两个一对多关联到一个中间链接类。事实上，我们认为大多数关联都是一对多和多对一的，在使用任何其他关联方式时你应该小心，问问自己是否真的有必要。

使用两个一对多关联增加了轻松将其他属性添加到“订阅”的灵活性，例如该特定订阅的通知首选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-15T11:10:47.767

由于集合内的关系是多对多的，nHibernate 无法分辨关系的哪一端是子关系，哪一端是父关系，而实现我想要的最快的方法就是编写一些 SQL我通过我的存储库发送，从集合中删除了相应的新闻提要，然后删除了父新闻提要。下次收集水合时，变化就会反映出来。

另一种选择是通过中间的连接类打破多对多关系，nHiberate 将能够确定父子关系并且级联应该工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T21:33:12.377

改变

```
cascade="all" 
```

到

```
cascade="all-delete-orphan" 
```

[参考](http://ayende.com/Blog/archive/2006/12/02/NHibernateCascadesTheDifferentBetweenAllAlldeleteorphansAndSaveupdate.aspx)

# actionscript-3 - 你可以在 Flex 3 中基于非 UIComponent 的对象创建自定义事件吗？

> ID：444754
> 
> 赞同：2
> 
> 时间：2009-01-14T21:25:27.010
> 
> 标签：actionscript-3, apache-flex, flex3

我有一个简单的对象，它从 Google Maps API 获取地理编码数据，我希望它根据 Google 的响应调度一组自定义事件。但是，我没有这个类的 addEventListener() 和 dispatchEvent() 方法，因为它没有扩展 UIComponent。有没有办法在 Flex 3 中创建自定义事件而不从 UIComponent 继承？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-14T21:46:08.047

绝对没错。要利用事件处理，您的自定义对象应该扩展 EventDispatcher：

```
public class MyClass extends EventDispatcher
{
    // ...

    public function myFunction():void
    {
        dispatchEvent(new Event("myEvent"));
    }
} 
```

这负责调度事件。

然后，如果您有需要，您还可以创建一个扩展 Event 的单独类，它为您提供了附加事件特定数据以在处理程序中使用的选项（除其他外）：

```
public class MyClass extends EventDispatcher
{
    // ...

    public function myFunction():void
    {
        dispatchEvent(new MyEvent(someData));
    }
}

public class MyEvent extends Event
{
    private var _myEventData:Object;

    public function MyEvent(eventData:Object)
    {
        _myEventData = eventData;
    }
} 
```

..所以在你的处理程序中，你只需：

```
private function myHandler(event:MyEvent):void
{
    trace(event.myEventData.toString());
} 
```

有道理？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T21:33:14.593

扩展 EventDispatcher 类，或实现 flash.events 包中的 IEventDispatcher 接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T21:41:31.330

是的，这应该是可能的。像这样扩展 EventDispatcher：

```
 import flash.events.*;  
  public class MyDispatcher extends EventDispatcher { 
    private function doIt(event:Event):void {  
      dispatchEvent(new Event("myEvent"));  
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-22T13:25:12.023

这正是我所做的！扩展的 EventDispatcher 和继承的 dispatchEvent

谢谢小伙子们

# asp.net-mvc - NHibernate IQuery.List 错误“此 SqlParameterCollection 的索引 4 无效，Count=4。”

> ID：444763
> 
> 赞同：0
> 
> 时间：2009-01-14T21:29:33.197
> 
> 标签：asp.net-mvc, nhibernate

长标题，我知道，但我搜索了一遍，找不到来自该函数调用的错误消息，所以我认为这可能更有用。

这是代码片段：

```
string hql = " from LabRequest r where 1 = 1 ";
hql += " and 0 < (select count(rs) ";
hql += "            from r.Statuses rs ";
hql += "           where rs.StatusType.Description IN ('Assigned','Submitted')";
hql += "         ) ";
//Session.Clear();          
IQuery query = Session.CreateQuery(hql);
IQueryable<LabRequest> requests = query.List<LabRequest>().AsQueryable<LabRequest>(); 
```

这是我正在处理的 MVC 应用程序中的数据访问对象中的一个功能（或大部分功能）。这是一个搜索页面，当页面运行时，这个函数会被调用，就像你在代码中看到的一样，并且可以正常工作。

然后，在不进行任何更改的情况下，我刷新页面，该页面执行相同的步骤并再次调用此代码，就像您看到的那样。但是第二次通过它在最后一行的 query.List() 部分崩溃，主题中有错误。

Session 在另一个 DAO 中定义为：

```
session = NHibernateHelper.GetCurrentSession(); 
```

我知道如果没有实际的数据库，这很难分析，但我只是想看看是否有人能指出我正确的方向，或者指出关于 NHibernate 的一些显而易见的事情，因为我基本上对此一无所知。

编辑：忘了提到当我取消注释 Session.Clear() 时它工作正常，所以认为答案与此有关，如果它确实我应该如何处理何时清除（）？

编辑2：这是答案的一部分，但我第二次在此之前调用了一个非常相似的函数。我无法弄清楚为什么那个会影响我发布的那个。“查询”变量是本地的，所以它似乎是 Session.CreateQuery 的东西。有谁知道那会是什么？

谢谢，杰夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-14T23:36:32.050

虽然我不确定为什么 Session 上的 'Statistics' 属性似乎有来自第一个查询的数据，但我认为这是导致错误的原因，因为如果我执行 Session.Clear 它会删除统计信息中的集合财产。

作为我当前的（可能是临时的）修复，我刚刚为 CreateQuery 函数创建了一个扩展方法，它接受一个 bool 来询问是否清除 Session 并且我只是使用它而不是提供的那个。

如果其他人对此有任何真正的答案，请添加它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T00:04:40.513

关于您的“编辑 1”和“编辑 2”注释，是的，它与共享的会话有关（假设您使用的是 NHibernate 中处理会话的标准方法之一）。

使用 Session.Clear() 有充分的理由吗？通常，Clear 仅在刷新后使用，以确保 Session 缓存不会变得太大而导致性能下降。您是这样使用它，还是出于您的问题中未提及的某些商业原因？

# c# - WPF EventRouting to Children

> ID：444764
> 
> 赞同：0
> 
> 时间：2009-01-14T21:30:04.363
> 
> 标签：c#, .net, wpf, events, xaml

有没有办法在 WPF 中向我所有的孩子广播 RoutedEvent？

例如，假设我有一个有 4 个孩子的窗口。其中 2 人知道 RoutedEvent 'DisplayYourself' 并正在监听它。如何从窗口引发此事件并将其发送给所有孩子？

我查看了[RoutingStrategy](http://msdn.microsoft.com/en-us/library/system.windows.routingstrategy.aspx)和 Bubble 是错误的方向，Tunnel 和 Direct 不起作用，因为我不知道我想将它发送给哪些孩子。我只想广播这条消息，让关心它的人处理它。

更新：我在静态类中声明了这些事件。

```
 public static class StaticEventClass
    {
      public static readonly RoutedEvent ClickEvent = 
        EventManager.RegisterRoutedEvent("Click", RoutingStrategy.Bubble, typeof(RoutedEventHandler), typeof(StaticEventClass));

      public static readonly RoutedEvent DrawEvent = 
        EventManager.RegisterRoutedEvent("Draw", RoutingStrategy.Bubble, typeof(RoutedEventHandler), typeof(StaticEventClass));
    } 
```

问题是当我从窗口提出事件时，孩子们永远看不到它。

```
RoutedEventArgs args = new RoutedEventArgs(StaticEventClass.DrawEvent, this);
this.RaiseEvent(args); 
```

再次更新..这是孩子的处理程序。

```
public ChildClass()
{
  this.AddHandler(StaticEventClass.DrawEvent, new RoutedEventHandler(ChildClass_Draw));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-05-06T21:05:28.350

I think the problem is that you don't want a routed event. Just put a regular old public clr event on the static class and attach anything you want to it.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-14T21:38:15.550

If you create a routed event like "MyWindow.MyRoutedEvent" you just created an event handler on your children that listen for the event. Since the RoutedEvent is declared as static on your window you have access to it from other windows.

# iphone - iphone sdk 应用程序的最佳正则表达式库？

> ID：444772
> 
> 赞同：10
> 
> 时间：2009-01-14T21:32:28.290
> 
> 标签：iphone, objective-c, regex

我对 iPhone SDK 中可用的正则表达式库感到困惑。例如 RegexLite 看起来需要一个动态链接，据我了解，这对于 iPhone 上的 SDK 是不可能的。

我想要一个用于数据验证的 RegEx 库......哪一个是最好的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-12-02T15:36:04.100

只想在这里补充一点，iOS 4 现在有 NSRegularExpression。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-06-21T15:08:35.473

John Englehart（regexkitlite 开发人员）已向 cocoa-dev 发帖称，应用程序因使用它而被拒绝。[http://lists.apple.com/archives/Cocoa-dev/2010/Jun/msg00564.html](http://lists.apple.com/archives/Cocoa-dev/2010/Jun/msg00564.html)

（抱歉，这声称是一个“答案”，如果我还有 49 个声望点，这将是对 Kendall Helmstetter Gelner 的回复）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-16T17:09:17.270

[RegexKitLite](http://regexkit.sourceforge.net/)可以在 iPhone 上正常工作，无论是作为 Xcode 项目的一部分从源代码中包含，还是通过链接到静态库中（SDK 的 ToS 允许）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-18T05:09:35.507

使用 RegexKitLite 只需将源文件和头文件拖到您的项目中，并且效果非常好 - 它提供了您希望从 regex 库中获得的大部分功能。它基本上只是围绕已经存在的底层框架的一个非常薄的包装器。

在将头文件和 .m 文件添加到项目后，确保它们的源类型为“sourcecode.c.objc”（在给定的源文件上使用“获取信息”并查看“常规”选项卡）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-06T07:19:23.350

**RegexKitLite 使用libicucore.A.dylib**库提供的正则表达式引擎。然而，Apple 不正式支持直接链接到这个库。有关详细信息，请参阅Xcode 用户邮件列表中的[这篇文章。](http://lists.apple.com/archives/xcode-users/2005/Jun/msg00633.html)然而，尽管如此，App Store 上还有许多 iPhone 应用程序可用而不是使用 RegexKitLite，因此 Apple 不太可能（但并非不可能）拒绝您的应用程序使用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-22T16:54:16.937

这是 RegexKitLite 的一个不错的轻量级替代品：[https ://github.com/bendytree/Objective-C-RegEx-Categories](https://github.com/bendytree/Objective-C-RegEx-Categories)

# svn - 如何从 svn hotcopy 备份中恢复

> ID：444778
> 
> 赞同：13
> 
> 时间：2009-01-14T21:34:21.767
> 
> 标签：svn, recovery

我们当前的备份过程是每晚执行一次 SVN HOTCOPY，到另一台机器上的备份位置。我可以以某种方式从该备份中恢复并保留所有修订历史记录吗？还是我需要使用 svn dump/load？

谢谢，钱德拉吉

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-14T21:40:34.033

“svnadmin hotcopy”实际上将整个存储库复制到另一个位置。该副本与原始存储库没有区别，实际上可以用作存储库本身。因此，您应该能够将 svnadmin hotcopy 的结果复制回您的存储库位置，并拥有一个完全有效的恢复存储库。

与常规文件系统副本相比，热复制的优势在于它尊重 Subversion 的锁定机制。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-14T21:53:18.903

作为日常备份的一部分，您可能希望运行`svnadmin verify <REPOSITORY>`

您可以验证原件或热拷贝。

在从备份恢复之前一定要这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T21:53:48.763

我会做更多的事情，然后每天晚上简单地运行一个 hotcopy。我会使用“svnadmin dump”来创建转储文件的修订历史，可以将其恢复到工作存储库。

您应该按照标准备份过程将这些转储文件备份到磁带或异地磁盘。如果损坏的存储库在被捕获之前持续存在数天（例如在周末或假期），您可以返回到最后一个好的文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-22T17:18:28.477

可能你想看看我对类似问题的回答： [“从多个文件中恢复 SVN 备份”](https://stackoverflow.com/questions/190454/restore-svn-backups-from-multiple-files#191218)

您还应该考虑恢复您的 SVN 工作副本的策略：如果您只是恢复一个热复制（或转储）的 repo，所有更高版本的工作副本都将无效，开发人员必须再次检查。通常，与单独恢复回购相比，这需要更多的时间才能重新走上正轨。

转储的问题是：它们的创建和回放非常耗时。

此外，如果您使用钩子脚本，它们将包含在您的热拷贝中，但它们不会在您的转储中。

那就是说我会推荐 hotcopy 和 per-commit 转储的组合

# .net - 如何使用静态成员创建 .NET 接口？

> ID：444781
> 
> 赞同：12
> 
> 时间：2009-01-14T21:35:17.553
> 
> 标签：.net, interface, singleton, design-patterns

在 .NET 3.5 中，我想创建一个单例接口：

```
interface ISingleton <T>
{
  public static T Instance {get;}
} 
```

当然这不起作用，但这是我想要的。有什么建议么？

编辑：我只想知道所有的单例都会有一个名为 Instance 的类类型的静态属性。它总是在那里。接口将是表达这一点的明确方式。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-14T21:38:17.920

据我所知，接口不能是单例，因为它实际上并不存在。接口是实现必须遵循的契约。因此，实现可以是单例，但接口不能。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-14T23:43:04.847

虽然我同意单例被过度使用的其他海报，但您问题的一个可能解决方案是提供一个抽象基类，其类型参数为派生单例：

```
public abstract class Singleton<T> where T : Singleton<T>
{
  private static T _instance;

  public static T Instance
  {
    get { return _instance; }
    protected set { _instance = value; }
  }
} 
```

任何从 Singleton 派生的类都将具有正确类型的静态 Instance 属性：

```
public class MySingleton : Singleton<MySingleton>
{
    static MySingleton()
    {
        Instance = new MySingleton();
    }

    private MySingleton() { } 
} 
```

不过，在使用这样的东西之前，您应该真正考虑是否需要单例，或者您是否最好使用普通的静态类。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-14T22:26:22.287

好的，我将此答案设为 Wiki，因为我将提供与您的问题相切的观点。

我个人认为 Singleton 被过度使用了，它是 IMO 实际上相当罕见的用例，在大多数情况下，静态类更适合用例，而在其他情况下，工厂创建的不可变对象是最好的选择，实际的单身人士比人们想象的要少得多。

我不会有一个接口来描述一个通用模式，因为我实际上希望对单例的每一次使用都进行非常仔细和合理的考虑。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-14T21:46:08.840

> 我只想知道所有的单例都会有一个名为 Instance 的类类型的静态属性。它总是在那里。接口将是表达这一点的明确方式。

改为编写单元测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-14T23:23:28.333

我知道这不是你的问题，但你有多少单身人士需要一个接口？这对我来说闻起来像是糟糕的设计——你能清楚地解释为什么这些类应该是单例而不是实例吗？如果您的答案是记忆，我建议您过度考虑您的应用程序，如果您真的担心，请查看享元模式（或者可能是简单的工厂模式）。很抱歉没有直接回答这个问题，但这听起来不是一个好主意。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T21:39:32.817

除此之外，正如您所说，它不起作用，您将如何使用此接口和实现类？

您可以尝试使用工厂风格的界面

```
interface ISingletonFactory<T>
{
    public T Instance {get;}
}

public class SingletonFactory: ISingletonFactory<Singleton>
{
    public Singleton Instance {get { return Singleton.Instance;}}
}

public class Singleton
{
    private Singleton foo;
    public static Singleton Instance { get { return foo; } }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T21:42:35.930

鉴于接口的 OOP 的经典概念将其定义为实现类之间的契约，您不能向其中添加静态方法之类的东西。如果你能做到，你会以更类似于抽象类的东西结束，你有你的类的部分实现和扩展类所需的其他部分。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-14T22:10:24.377

正如所指出的，您不能这样做，并且有充分的理由不应该这样做。

我过去实现的方法创建了一个接口和一个实现该接口的抽象基类。它看起来像这样：

```
public interface IMyCompanySetting
{
    XmlNode Serialize();
    IMyCompanySetting Deserialize(XmlNode pattern);
    string SettingName { get; } 
```

字符串键 { 获取；} 对象设置值 { 获取；放; } 设置范围范围 { 获取；放; } }

```
public abstract class MyCompanySettingBase : IMyCompanySetting
{
    public MyCompanySettingBase() {}
    public MyCompanySettingBase(XmlNode pattern)
    {
        Deserialize(pattern);
    }
    #region IMyCompanySetting Members

    public abstract XmlNode Serialize();
    public abstract IMyCompanySetting Deserialize(XmlNode pattern);
    public abstract string SettingName{ get; }
public abstract string Key { get; }
    public abstract SettingScope Scope{ get; set; }
    public abstract object SettingValue{ get; set; }

    #endregion

public static XmlNode WrapInSettingEnvelope(XmlNode innerNode, IMyCompanySetting theSetting)
{
    // Write the top of the envelope.
    XmlTextWriter xtw = null;
    MemoryStream theStream = OpenSettingEnvelope(theSetting, ref xtw);

    // Insert the message.
    xtw.WriteNode(new XmlTextReader(innerNode.OuterXml, XmlNodeType.Element, null), true);

    // Close the envelope.
    XmlNode retNode = CloseSettingEnvelope(xtw, theStream);
    return retNode;

}

public static MemoryStream OpenSettingEnvelope(IMyCompanySetting theSetting, ref XmlTextWriter theWriter)
{
    MemoryStream theStream = new MemoryStream();
    theWriter = new XmlTextWriter(theStream, Encoding.ASCII);
    System.Type messageType = theSetting.GetType();

    string[] fullAssembly = messageType.Assembly.ToString().Split(',');
    string assemblyName = fullAssembly[0].Trim();

    theWriter.WriteStartElement(theSetting.SettingName);
    theWriter.WriteAttributeString("type", messageType.ToString());
    theWriter.WriteAttributeString("assembly", assemblyName);
    theWriter.WriteAttributeString("scope", ConfigurationManager.ScopeName(theSetting.Scope));

    return theStream;
}

public static XmlNode CloseSettingEnvelope(XmlTextWriter xtw, MemoryStream theStream)
{
    XmlDocument retDoc = new XmlDocument();
    try
    {
        // Close the envelope.
        xtw.WriteEndElement();
        xtw.Flush();

        // Return the node.
        string xmlString = Encoding.ASCII.GetString(theStream.ToArray());
        retDoc.LoadXml(xmlString);
    }
    catch (XmlException)
    {
        string xmlString = Encoding.ASCII.GetString(theStream.ToArray());
        Trace.WriteLine(xmlString);
        retDoc.LoadXml(@"<error/>");
    }
    catch (Exception)
    {
        retDoc.LoadXml(@"<error/>");
    }
    return retDoc.DocumentElement;
}

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-12-23T05:50:48.813

2年前有一个支持的提案

[https://github.com/dotnet/csharplang/issues/1711](https://github.com/dotnet/csharplang/issues/1711)

但是，是的，目前还不可能，特别是在 dotnet 3.5 中不可能

# javascript - 旋转 javascript 菜单

> ID：444782
> 
> 赞同：0
> 
> 时间：2009-01-14T21:35:18.910
> 
> 标签：javascript, flash, menu, navigation

我想创建一个类似于[此处在 Flash 中完成的旋转菜单。](http://accuval.net)您是否知道任何相关链接可以帮助您完成这项工作？

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T21:45:40.247

您可以使用一系列图像来完成，然后交换它们。在不涉及跨浏览器画布/svg 的复杂性的情况下，这可能是最简单的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-14T21:48:41.253

您可以使用 <canvas> 标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T22:03:22.487

您可以使用鼠标悬停制作圆形图像映射，然后使用[css](http://simonjobling.com/blog/2008/rotating-with-css/)在 jQuery 之类的角度上旋转动画，以便当前选定的项目位于顶部。但是，这将受到支持它的浏览器数量的限制（mozilla 和 webkit）。我认为 IE 中也有类似的东西，但需要 ActiveX 覆盖

# java - 如何从包含 MSFT 序列化：GUID 数据类型的 XSD 生成 Java 代码？

> ID：444783
> 
> 赞同：0
> 
> 时间：2009-01-14T21:35:29.363
> 
> 标签：java, web-services, xsd, guid, auto-generate

我之前使用 Jaxme 2 库从 .XSD 文件生成 Java 代码没有问题。我目前在从包含[http://schemas.microsoft.com/2003/10/Serialization/](http://schemas.microsoft.com/2003/10/Serialization/)命名空间的 XSD 文件生成 Java 时遇到问题。

我的 .XSD 中的一些示例代码是：

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema xmlns:tns="http://schemas.datacontract.org/2004/07/MyMessagingTypes"
       xmlns:ser="http://schemas.microsoft.com/2003/10/Serialization/"
       elementFormDefault="qualified"
       xmlns:xs="http://www.w3.org/2001/XMLSchema">

  <xs:import namespace="http://schemas.microsoft.com/2003/10/Serialization/" />
  <xs:complexType name="MyMessage">
    <xs:sequence>
      ...
      <xs:element minOccurs="0" name="MyPlanID" type="ser:guid" />
      ...
    </xs:sequence>
  </xs:complexType>
  <xs:element name="MyMessage" nillable="true" type="tns:MyMessage" />
</xs:schema> 
```

* * *

我得到的错误是：

无效元素：类型 { [http://schemas.microsoft.com/2003/10/Serialization/](http://schemas.microsoft.com/2003/10/Serialization/) }guid 未定义。

任何想法是什么问题或者我如何从这个 xsd 生成 Java 代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-02T01:23:31.920

我不知道[http://schemas.microsoft.com/2003/10/Serialization/](http://schemas.microsoft.com/2003/10/Serialization/)的架构在哪里，但您必须找到它，并确保 Java 可以看到这两种架构。或者，您可以编辑 XSD 以包含您自己的 GUID 类型。

# windows - PostMessage 偶尔会丢失一条消息

> ID：444787
> 
> 赞同：0
> 
> 时间：2009-01-14T21:35:58.283
> 
> 标签：windows, multithreading, synchronization, messaging, race-condition

我编写了一个多线程 Windows 应用程序，其中线程：
A – 是一个处理用户交互并处理来自 B 的数据的 Windows 窗体
。B – 偶尔生成数据并将两个 A 传递给它。

线程安全队列用于将数据从线程 B 传递到 A。入队和出队函数使用 Windows 临界区对象进行保护。

如果调用 enqueue 函数时队列为空，该函数将使用 PostMessage 告诉 A 队列中有数据。该函数检查以确保对 PostMessage 的调用成功执行，如果不成功则重复调用 PostMessage（PostMessage 尚未失败）。

这在相当长的一段时间内运行良好，直到一台特定的计算机开始丢失偶尔的消息。丢失的意思是， PostMessage 在 B 中成功返回，但 A 从未收到消息。这会导致软件出现冻结。

我已经想出了几个可接受的解决方法。我很想知道为什么 Windows 会丢失这些消息，以及为什么这只发生在一台计算机上。

这是代码的相关部分。

```
// Only called by B
procedure TSharedQueue.Enqueue(AItem: TSQItem);
var
 B: boolean;
begin
  EnterCriticalSection(FQueueLock);
  if FCount > 0 then
    begin
      FLast.FNext := AItem;
      FLast := AItem;
    end
  else
    begin
      FFirst := AItem;
      FLast := AItem;
    end;

  if (FCount = 0) or (FCount mod 10 = 0) then // just in case a message is lost
    repeat
      B := PostMessage(FConsumer, SQ_HAS_DATA, 0, 0);
      if not B then 
  Sleep(1000); // this line of code has never been reached
    until B;

  Inc(FCount);
  LeaveCriticalSection(FQueueLock);
end;

// Only called by A 
function TSharedQueue.Dequeue: TSQItem;
begin
  EnterCriticalSection(FQueueLock);
  if FCount > 0 then
    begin
      Result := FFirst;
      FFirst := FFirst.FNext;
      Result.FNext := nil;
      Dec(FCount);
    end
  else
    Result := nil;
  LeaveCriticalSection(FQueueLock);
end;

// procedure called when SQ_HAS_DATA is received
procedure TfrmMonitor.SQHasData(var AMessage: TMessage);
var
  Item: TSQItem;
begin
  while FMessageQueue.Count > 0 do
    begin
      Item := FMessageQueue.Dequeue;
      // use the Item somehow
    end;
end; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-15T03:25:01.763

`FCount`也受`FQueueLock`保护？如果不是，那么您的问题在于`FCount`在已处理发布的消息后递增。

以下是可能发生的情况：

1.  B进入临界区
2.  B 电话`PostMessage`
3.  A 收到消息但不做任何事情，因为`FCount`是`0`
4.  B 递增`FCount`
5.  B 离开临界区
6.  A 像鸭子一样坐在那里

一个快速的补救措施是`FCount`在调用`PostMessage`.

请记住，事情发生的速度可能比预期的要快（即在您有机会在几行之后增加 FCount 之前，使用 PostMessage 发布的消息被另一个线程捕获并处理），尤其是当您处于真正的多线程中时线程环境（多个 CPU）。这就是为什么我之前问过“问题机器”是否有多个 CPU/内核。

解决此类问题的一种简单方法是在每次输入方法、进入/离开关键部分等时使用附加日志记录代码来记录代码。然后您可以分析日志以查看事件的真实顺序。

在单独的说明中，可以在像这样的生产者/消费者场景中完成的一个很好的小优化是使用两个队列而不是一个。当消费者醒来处理完整队列时，您将完整队列与空队列交换并锁定/处理完整队列，而新的空队列可以被填充而无需两个线程尝试锁定彼此的队列。不过，您仍然需要在两个队列的交换中进行一些锁定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T22:11:06.700

> 如果调用 enqueue 函数时队列为空，该函数将使用 PostMessage 告诉 A 队列中有数据。

您是否在检查队列大小并发出之前锁定了消息队列`PostMessage`？您可能会遇到竞争情况，您检查队列并发现它非空，而实际上 A 正在处理最后一条消息并且即将空闲。

要查看您是否确实遇到了竞争条件而不是 的问题`PostMessage`，您可以切换到使用事件。工作线程 (A) 将等待事件而不是等待消息。B 将简单地设置该事件而不是发布消息。

> 这在相当长的一段时间内运行良好，直到一台特定的计算机开始丢失偶尔的消息。

无论如何，这台特定计算机的 CPU 或内核数量是否与您认为没有问题的其他计算机不同？有时，当您从单 CPU 机器切换到具有多个物理 CPU/内核的机器时，可能会出现新的竞争条件或死锁。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-14T21:57:07.757

是否有第二个实例在不知不觉中运行并吃掉消息，将它们标记为已处理？

# c# - 可以将智能感知从 Visual Studio 导出或提取到文本文件吗？

> ID：444790
> 
> 赞同：2
> 
> 时间：2009-01-14T21:36:16.567
> 
> 标签：c#, vb.net, visual-studio, documentation, intellisense

我正在尝试为我们的供应商之一为我们正在集成的应用程序提供的 Web 服务编写一些文档。一堆接口是在 Web 服务本身中定义的自定义对象。供应商强烈反对为此应用程序提供任何文档，因此我自己承担了为他们完成工作的责任[根据我更好的判断]。

*他们坦率地*提供的文档令人尴尬，我正在尝试尽可能短地完成这些工作，以便将一些高质量的文档放在一起。我知道，由于我无法访问他们的源代码，我不能只通过 nDoc/Sandcastle 运行它来吐出 API 文档，但我想知道（作为中途之家）是否有一种简单的方法来将智能感知导出到文本文件，而无需编写实用程序来专门迭代定义的每个对象类型并将成员反映到文本中？

如果我能做到这一点，它至少可以确保我有一个高质量的文档结构，我可以在其中填写空白。必须来回跳到 Visual Studio 来检查每个班级成员的智能感知是一种非常费力的方法。

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T22:03:12.003

如果它是您尝试记录的 Web 服务，那么您不能解析出 WSDL 吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T22:13:22.123

如果您正在访问远程 Web 服务，那么我认为您可以访问相应的 WSDL：如何解析它并仅查找您需要的信息？或者使用工具来做到这一点（我用谷歌搜索“wsdl 文档生成器”）？或者甚至使用 WSDL.exe 从 WSDL 生成一些虚拟代码，然后记录它，也许是 GhostDoc 的帮助？高温高压

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T21:45:34.880

您可以使用反射来转储方法等吗？

> 反射是 .Net 中的特性，它使我们能够在运行时获取有关对象的一些信息。该信息包含类的数据。它还可以获取该对象的类和构造函数内部的方法的名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T22:01:45.643

我认为 VS.net 为智能感知生成文档。对于现有程序集，它已经在您的文件系统上（例如 C:\Windows\Microsoft.NET\Framework\v2.0.50727\en）

尝试在 VS.NET 中使用供应商提供的程序集。使用进程资源管理器或 sysinternals 中的任何此类工具来查看正在加载哪些**文件。**我敢肯定，您会发现为自定义程序集创建了一个 xml 文件（用于显示 Intellisense 和可用的文档）。

希望有帮助。

编辑：我认为同一个文件夹（您的自定义程序集所在的位置）将包含用于文档的 xml 文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T21:47:24.237

如果你有 dll，你能不反编译它们然后重新编译并使用 nDoc 吗？这应该给你一个合理的开始。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T21:58:08.630

您能否仅使用[反射器（来自 redgate）](http://www.red-gate.com/products/reflector/)来查看程序集（反编译）而不是复制 API 文档。我不确定你会得到什么来反映和构建你在反射器中看不到的文档（当然这取决于他们编写的*可读代码*。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-14T21:58:48.940

也许这很疯狂，但是您能否截取完整列表的屏幕截图，并通过 OCR 程序运行它？

# c# - 不区分大小写的“包含（字符串）”

> ID：444798
> 
> 赞同：3228
> 
> 时间：2009-01-14T21:39:46.670
> 
> 标签：c#, string, contains, case-insensitive

有没有办法使以下返回为真？

```
string title = "ASTRINGTOTEST";
title.Contains("string"); 
```

似乎没有允许我设置区分大小写的过载。目前我将它们都大写，但这很愚蠢（我指的是上下大小写带来的[i18n问题）。](http://en.wikipedia.org/wiki/Internationalization_and_localization)

**更新**

这个问题很古老，从那时起，我意识到如果您愿意全面调查，我会要求一个非常广泛而困难的主题的简单答案。

在大多数情况下，在单语英语代码库中，[这个](https://stackoverflow.com/a/444818/11333)答案就足够了。我怀疑是因为大多数来这里的人都属于这一类，这是最受欢迎的答案。

[然而，这个](https://stackoverflow.com/a/15464440/11333)答案带来了一个固有的问题，即在我们知道两个文本是相同的文化并且我们知道那种文化是什么之前，我们无法比较不区分大小写的文本。这可能是一个不太受欢迎的答案，但我认为它更正确，这就是我将其标记为这样的原因。

* * *

## 回答 #1

> 赞同：2942
> 
> 时间：2009-01-14T21:44:11.623

您可以使用[`String.IndexOf`Method](https://msdn.microsoft.com/en-us/library/ms224425(v=vs.110).aspx)并[`StringComparison.OrdinalIgnoreCase`](https://msdn.microsoft.com/en-us/library/system.stringcomparer.ordinalignorecase(v=vs.110).aspx)作为要使用的搜索类型传递：

```
string title = "STRING";
bool contains = title.IndexOf("string", StringComparison.OrdinalIgnoreCase) >= 0; 
```

更好的是为字符串定义一个新的扩展方法：

```
public static class StringExtensions
{
    public static bool Contains(this string source, string toCheck, StringComparison comp)
    {
        return source?.IndexOf(toCheck, comp) >= 0;
    }
} 
```

请注意，自 C# 6.0 (VS 2015) 起可以使用[空传播](https://stackoverflow.com/questions/25666993/c-sharp-null-propagating-operator-conditional-access-expression-if-blocks) `?.`，对于旧版本使用

```
if (source == null) return false;
return source.IndexOf(toCheck, comp) >= 0; 
```

用法：

```
string title = "STRING";
bool contains = title.Contains("string", StringComparison.OrdinalIgnoreCase); 
```

* * *

## 回答 #2

> 赞同：1536
> 
> 时间：2013-03-17T18:22:11.727

测试字符串是否`paragraph`包含字符串`word`（感谢@QuarterMeister）

```
culture.CompareInfo.IndexOf(paragraph, word, CompareOptions.IgnoreCase) >= 0 
```

描述文本所用语言`culture`的实例在哪里。[`CultureInfo`](http://msdn.microsoft.com/en-gb/library/system.globalization.cultureinfo(v=vs.110).aspx)

**这个解决方案对于不区分大小写的定义**是透明的，它是依赖于语言的。例如，英语使用字符`I`and`i`表示第九个字母的大写和小写版本，而土耳其语使用这些字符表示其 29 个字母长的字母表中的[第十一个和第十二个字母。](http://en.wikipedia.org/wiki/Dotted_and_dotless_I)土耳其语大写版本的“i”是不熟悉的字符“İ”。

因此，字符串`tin`和*在英语*`TIN`中是同一个词，但*在土耳其语中*是不同的词。据我了解，一个意思是“精神”，另一个是象声词。（土耳其人，如果我错了，请纠正我，或者提出一个更好的例子）

 ***总而言之，如果您知道文本的语言*，您只能回答“这两个字符串是否相同但在不同情况下”的问题。如果你不知道，你将不得不采取一个平底船。鉴于英语在软件方面的霸主地位，您可能应该求助于[`CultureInfo.InvariantCulture`](https://stackoverflow.com/questions/9760237/what-does-cultureinfo-invariantculture-mean)，因为它会以熟悉的方式出错。

* * *

## 回答 #3

> 赞同：252
> 
> 时间：2009-01-14T21:48:46.357

你可以`IndexOf()`这样使用：

```
string title = "STRING";

if (title.IndexOf("string", 0, StringComparison.CurrentCultureIgnoreCase) != -1)
{
    // The string exists in the original
} 
```

由于 0（零）可以是一个索引，因此您检查 -1。

[MSDN](https://msdn.microsoft.com/en-us/library/k8b1470s(v=vs.110).aspx)

> 如果找到该字符串，则 value 的从零开始的索引位置，否则为 -1。如果 value 为 String.Empty，则返回值为 0。

* * *

## 回答 #4

> 赞同：156
> 
> 时间：2010-07-28T17:18:28.480

使用正则表达式的替代解决方案：

```
bool contains = Regex.IsMatch("StRiNG to search", Regex.Escape("string"), RegexOptions.IgnoreCase); 
```

* * *

## 回答 #5

> 赞同：138
> 
> 时间：2018-10-13T09:26:54.980

### .NET Core 2.0+（包括 .NET 5.0+）

自 2.0 版以来，.NET Core 有两种方法来处理这个问题：

*   String.Contains(Char, **StringComparison** )
*   String.Contains（字符串，**字符串**比较）

例子：

```
"Test".Contains("test", System.StringComparison.CurrentCultureIgnoreCase); 
```

它现在正式成为 .NET Standard 2.1 的一部分，因此是实现此版本标准（或更高版本）的基类库的所有实现的一部分。

* * *

## 回答 #6

> 赞同：96
> 
> 时间：2009-01-14T21:42:37.273

您总是可以先将字符串向上或向下转换。

```
string title = "string":
title.ToUpper().Contains("STRING")  // returns true 
```

哎呀，刚刚看到最后一点。无论如何，不​​区分大小写的比较可能`*`会`*`做同样的事情，如果性能不是问题，我认为创建大写副本并比较它们没有问题。我可以发誓我曾经看过一次不区分大小写的比较......

* * *

## 回答 #7

> 赞同：53
> 
> 时间：2010-12-07T21:11:34.190

答案的一个问题是，如果字符串为空，它将引发异常。您可以将其添加为支票，这样它就不会：

```
public static bool Contains(this string source, string toCheck, StringComparison comp)
{
    if (string.IsNullOrEmpty(toCheck) || string.IsNullOrEmpty(source))
        return true;

    return source.IndexOf(toCheck, comp) >= 0;
} 
```

* * *

## 回答 #8

> 赞同：40
> 
> 时间：2010-11-18T16:48:07.710

StringExtension 类是前进的方向，我结合上面的几篇文章给出了一个完整的代码示例：

```
public static class StringExtensions
{
    /// <summary>
    /// Allows case insensitive checks
    /// </summary>
    public static bool Contains(this string source, string toCheck, StringComparison comp)
    {
        return source.IndexOf(toCheck, comp) >= 0;
    }
} 
```

* * *

## 回答 #9

> 赞同：35
> 
> 时间：2012-11-09T04:25:31.363

这是干净和简单的。

```
Regex.IsMatch(file, fileNamestr, RegexOptions.IgnoreCase) 
```

* * *

## 回答 #10

> 赞同：32
> 
> 时间：2014-06-17T10:31:23.523

**OrdinalIgnoreCase、CurrentCultureIgnoreCase 还是 InvariantCultureIgnoreCase？**

由于缺少此功能，因此以下是有关何时使用哪一个的一些建议：

## 多斯

*   用于`StringComparison.OrdinalIgnoreCase`比较作为与文化无关的字符串匹配的安全默认值。
*   使用`StringComparison.OrdinalIgnoreCase`比较来提高速度。
*   向用户显示输出时使用`StringComparison.CurrentCulture-based`字符串操作。
*   基于不变的文化切换当前使用的字符串操作以使用非语言`StringComparison.Ordinal`或 `StringComparison.OrdinalIgnoreCase`当比较在
    语言上不相关时（例如，符号）。
*   在规范化字符串进行比较时使用`ToUpperInvariant`而不是。`ToLowerInvariant`

## 不要做

*   对未显式或隐式指定字符串比较机制的字符串操作使用重载。
*   大多数情况下使用`StringComparison.InvariantCulture`基于字符串的
    操作；少数例外之一是
    保留具有语言意义但与文化无关的数据。

* * *

根据这些规则，您应该使用：

```
string title = "STRING";
if (title.IndexOf("string", 0, StringComparison.[YourDecision]) != -1)
{
    // The string exists in the original
} 
```

而 [YourDecision] 取决于上面的建议。

来源链接：http: [//msdn.microsoft.com/en-us/library/ms973919.aspx](http://msdn.microsoft.com/en-us/library/ms973919.aspx)

* * *

## 回答 #11

> 赞同：25
> 
> 时间：2018-07-12T09:25:53.640

这些是最简单的解决方案。

1.  按索引

    ```
    string title = "STRING";

    if (title.IndexOf("string", 0, StringComparison.CurrentCultureIgnoreCase) != -1)
    {
        // contains 
    } 
    ```

2.  通过更改大小写

    ```
    string title = "STRING";

    bool contains = title.ToLower().Contains("string") 
    ```

3.  通过正则表达式

    ```
    Regex.IsMatch(title, "string", RegexOptions.IgnoreCase); 
    ```

* * *

## 回答 #12

> 赞同：19
> 
> 时间：2019-12-10T22:32:51.050

简单而有效

```
title.ToLower().Contains("String".ToLower()) 
```

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2014-07-13T09:54:28.820

像这样：

```
string s="AbcdEf";
if(s.ToLower().Contains("def"))
{
    Console.WriteLine("yes");
} 
```

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2011-09-09T13:23:12.973

我知道这不是C#，但在框架（VB.NET）中已经有这样的功能

```
Dim str As String = "UPPERlower"
Dim b As Boolean = InStr(str, "UpperLower") 
```

C#变体：

```
string myString = "Hello World";
bool contains = Microsoft.VisualBasic.Strings.InStr(myString, "world"); 
```

* * *

## 回答 #15

> 赞同：11
> 
> 时间：2013-12-06T14:11:23.373

`InStr`如果您担心国际化（或者您可以重新实现它），VisualBasic 程序集的方法是最好的。查看 dotNeetPeek 显示，它不仅考虑大写和小写，还考虑假名类型和全角与半角字符（主要与亚洲语言相关，尽管也有全角版本的罗马字母表）。我跳过了一些细节，但请查看私有方法`InternalInStrText`：

```
private static int InternalInStrText(int lStartPos, string sSrc, string sFind)
{
  int num = sSrc == null ? 0 : sSrc.Length;
  if (lStartPos > num || num == 0)
    return -1;
  if (sFind == null || sFind.Length == 0)
    return lStartPos;
  else
    return Utils.GetCultureInfo().CompareInfo.IndexOf(sSrc, sFind, lStartPos, CompareOptions.IgnoreCase | CompareOptions.IgnoreKanaType | CompareOptions.IgnoreWidth);
} 
```

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2011-07-11T07:53:22.780

用这个：

```
string.Compare("string", "STRING", new System.Globalization.CultureInfo("en-US"), System.Globalization.CompareOptions.IgnoreCase); 
```

* * *

## 回答 #17

> 赞同：10
> 
> 时间：2021-01-07T19:42:35.587

您可以使用字符串比较参数（可从 .net 2.1 及更高版本获得） [String.Contains Method](https://docs.microsoft.com/en-us/dotnet/api/system.string.contains?view=netcore-2.1#System_String_Contains_System_String_System_StringComparison_)。

```
public bool Contains (string value, StringComparison comparisonType); 
```

例子：

```
string title = "ASTRINGTOTEST";
title.Contains("string", StringComparison.InvariantCultureIgnoreCase); 
```

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2015-10-17T07:46:58.717

这与此处的其他示例非常相似，但我决定将 enum 简化为 bool, primary 因为通常不需要其他替代方案。这是我的例子：

```
public static class StringExtensions
{
    public static bool Contains(this string source, string toCheck, bool bCaseInsensitive )
    {
        return source.IndexOf(toCheck, bCaseInsensitive ? StringComparison.OrdinalIgnoreCase : StringComparison.Ordinal) >= 0;
    }
} 
```

用法类似于：

```
if( "main String substring".Contains("SUBSTRING", true) )
.... 
```

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2019-02-14T08:53:57.880

只是为了建立这里的答案，您可以创建一个字符串扩展方法以使其更加用户友好：

```
 public static bool ContainsIgnoreCase(this string paragraph, string word)
    {
        return CultureInfo.CurrentCulture.CompareInfo.IndexOf(paragraph, word, CompareOptions.IgnoreCase) >= 0;
    } 
```

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2013-09-18T13:08:27.210

使用 RegEx 是一种直接的方法：

```
Regex.IsMatch(title, "string", RegexOptions.IgnoreCase); 
```

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2017-11-16T12:23:46.303

如果你想检查你传递的字符串是否在字符串中，那么有一个简单的方法。

```
string yourStringForCheck= "abc";
string stringInWhichWeCheck= "Test abc abc";

bool isContained = stringInWhichWeCheck.ToLower().IndexOf(yourStringForCheck.ToLower()) > -1; 
```

如果字符串被包含或不包含，这个布尔值将返回

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2020-07-13T12:02:26.480

类似于以前的答案（使用扩展方法），但有两个简单的空检查（C# 6.0 及更高版本）：

```
public static bool ContainsIgnoreCase(this string source, string substring)
{
    return source?.IndexOf(substring ?? "", StringComparison.OrdinalIgnoreCase) >= 0;
} 
```

如果源为空，则返回假（通过空传播运算符？。）

如果 substring 为 null，则将其视为空字符串并返回 true（通过 null-coalescing operator ??）

如果需要，StringComparison 当然可以作为参数发送。

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2021-09-27T19:52:03.770

**评分最高的几个答案都以自己的方式很好且正确**，我写在这里是为了添加更多信息、上下文和观点。

**为清楚起见**，让我们考虑如果 A 中的任何代码点子序列等于 B，则字符串 A 包含字符串 B。如果我们接受这一点，问题就归结为两个字符串是否相等的问题。

**几十年来，人们一直在详细考虑字符串何时相等的问题。**许多当前的知识状态都封装在 SQL 排序规则中。Unicode 范式接近这个的真子集。但除了 SQL 排序规则之外，还有更多内容。

**例如**，在 SQL 排序规则中，您可以

*   **严格二进制敏感**- 以便不同的 Unicode 规范化形式（例如预组合或组合重音）比较不同。

    例如，`é`可以表示为`U+00e9`(precombined) 或`U+0065 U+0301`(e with combined accent Accent)。

    这些是相同的还是不同的？

*   **Unicode 标准化**- 在这种情况下，上述示例将彼此相等，但不等于`É`or `e`。

*   **口音不敏感**，（例如西班牙语、德语、瑞典语等文本）。在这种情况下`U+0065`= `U+0065 U+0301`= `U+00e9`= `é`=`e`

*   **不区分大小写和重音**，以便（例如西班牙语、德语、瑞典语等文本）。在这种情况下`U+00e9`= `U+0065 U+0301`= `U+00c9`= `U+0045 U+0301`= `U+0049`= `U+0065`= `E`= `e`= `É`=`é`

*   **Kanatypesensitive 或 insensitive**，即您可以将日文平假名和片假名视为等效或不同。这两个音节包含相同数量的字符，以（大部分）相同的方式组织和发音，但书写方式不同，用途不同。例如，片假名用于借词或外国名称，但平假名用于儿童读物、发音指南（例如红宝石），以及没有汉字的单词（或者可能作者不知道汉字，或认为读者可能不知道）。

*   **全角或半角敏感**- 由于历史原因，日语编码包括某些字符的两种表示 - 它们以不同的大小显示。

*   **合字是否等同**：见[https://en.wikipedia.org/wiki/Ligature_(writing)](https://en.wikipedia.org/wiki/Ligature_(writing))

    是`æ`一样`ae`还是不一样？它们具有不同的 Unicode 编码，重音字符也是如此，但与重音字符不同，它们看起来也不同。

    这让我们...

*   **阿拉伯语表示形式等价**

    阿拉伯文字具有优美的书法文化，其中相邻字母的特定序列具有特定的表示形式。其中许多已在 Unicode 标准中编码。我不完全理解规则，但在我看来它们类似于连字。

*   **其他文字和系统：**我对卡纳达语、马拉雅拉姆语、僧伽罗语、泰语、古吉拉特语、藏语或几乎所有未提及的数十或数百种文字一无所知。我假设他们对程序员有类似的问题，并且考虑到到目前为止提到的问题的数量和如此少的脚本，他们可能还有程序员应该考虑的其他问题。

这使我们摆脱了“编码”杂草。

现在我们必须输入“意义”杂草。

*   等于？`Beijing`_ `北京`如果不是，`Bĕijīng`等于`北京`？如果不是，为什么不呢？是拼音拼音。

*   `Peking`等于`北京`? _ 如果不是，为什么不呢？这是韦德-吉尔斯的罗马化。

*   `Beijing`等于`Peking`? _ 如果不是，为什么不呢？

你为什么要这样做？

例如，如果您想知道两个字符串（A 和 B）是否可能指代同一地理位置或同一个人，您可能想问：

*   这些字符串可以是一组汉字序列的 Wade-Giles 或拼音表示吗？如果是这样，相应的集合之间是否有任何重叠？

*   这些字符串中的一个可能是汉字的西里尔字母转录吗？

*   这些字符串中的一个可能是拼音罗马化的西里尔字母音译吗？

*   这些字符串中的一个可能是英文名字的中国化的拼音罗马化的西里尔字母音译吗？

显然，这些都是难题，没有确定的答案，而且无论如何，答案可能会根据问题的目的而有所不同。

以一个具体的例子结束。

*   如果您正在递送信件或包裹，显然, 和`Beijing`都是`Peking`平等的。为此，它们都同样出色。毫无疑问，中国邮局认可许多其他选项，例如法语、葡萄牙语、越南语和蒙古语。`Bĕijīng``北京``Pékin``Pequim``Bắc Kinh``Бээжин`

**单词没有固定的含义。**

文字是我们用来导航世界、完成任务以及与他人交流的工具。

虽然看起来像 , 或 具有固定含义的词会有所帮助`equality`，`Beijing`但`meaning`可悲的事实是它们没有。

然而，我们似乎不知何故得过且过。

**TL;DR：**如果你正在处理与现实有关的问题，在其所有模糊不清（模糊、不确定、缺乏明确的界限）中，每个问题基本上都有三个可能的答案：

*   大概
*   可能不是
*   也许

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2016-05-03T14:36:16.130

这里的诀窍是寻找字符串，忽略大小写，但保持完全相同（使用相同的大小写）。

```
 var s="Factory Reset";
 var txt="reset";
 int first = s.IndexOf(txt, StringComparison.InvariantCultureIgnoreCase) + txt.Length;
 var subString = s.Substring(first - txt.Length, txt.Length); 
```

输出是“重置”

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2016-10-26T14:34:14.147

```
if ("strcmpstring1".IndexOf(Convert.ToString("strcmpstring2"), StringComparison.CurrentCultureIgnoreCase) >= 0){return true;}else{return false;} 
```

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2016-12-11T13:39:03.507

你可以使用`string.indexof ()`函数。这将不区分大小写

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2017-06-14T03:16:07.850

```
public static class StringExtension
{
    #region Public Methods

    public static bool ExContains(this string fullText, string value)
    {
        return ExIndexOf(fullText, value) > -1;
    }

    public static bool ExEquals(this string text, string textToCompare)
    {
        return text.Equals(textToCompare, StringComparison.OrdinalIgnoreCase);
    }

    public static bool ExHasAllEquals(this string text, params string[] textArgs)
    {
        for (int index = 0; index < textArgs.Length; index++)
            if (ExEquals(text, textArgs[index]) == false) return false;
        return true;
    }

    public static bool ExHasEquals(this string text, params string[] textArgs)
    {
        for (int index = 0; index < textArgs.Length; index++)
            if (ExEquals(text, textArgs[index])) return true;
        return false;
    }

    public static bool ExHasNoEquals(this string text, params string[] textArgs)
    {
        return ExHasEquals(text, textArgs) == false;
    }

    public static bool ExHasNotAllEquals(this string text, params string[] textArgs)
    {
        for (int index = 0; index < textArgs.Length; index++)
            if (ExEquals(text, textArgs[index])) return false;
        return true;
    }

    /// <summary>
    /// Reports the zero-based index of the first occurrence of the specified string
    /// in the current System.String object using StringComparison.InvariantCultureIgnoreCase.
    /// A parameter specifies the type of search to use for the specified string.
    /// </summary>
    /// <param name="fullText">
    /// The string to search inside.
    /// </param>
    /// <param name="value">
    /// The string to seek.
    /// </param>
    /// <returns>
    /// The index position of the value parameter if that string is found, or -1 if it
    /// is not. If value is System.String.Empty, the return value is 0.
    /// </returns>
    /// <exception cref="ArgumentNullException">
    /// fullText or value is null.
    /// </exception>
    public static int ExIndexOf(this string fullText, string value)
    {
        return fullText.IndexOf(value, StringComparison.OrdinalIgnoreCase);
    }

    public static bool ExNotEquals(this string text, string textToCompare)
    {
        return ExEquals(text, textToCompare) == false;
    }

    #endregion Public Methods
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2020-10-29T10:06:35.537

根据现有答案和 Contains 方法的文档，我建议创建以下扩展，该扩展也可以处理极端情况：

```
public static class VStringExtensions 
{
    public static bool Contains(this string source, string toCheck, StringComparison comp) 
    {
        if (toCheck == null) 
        {
            throw new ArgumentNullException(nameof(toCheck));
        }

        if (source.Equals(string.Empty)) 
        {
            return false;
        }

        if (toCheck.Equals(string.Empty)) 
        {
            return true;
        }

        return source.IndexOf(toCheck, comp) >= 0;
    }
} 
```

* * *

## 回答 #29

> 赞同：-3
> 
> 时间：2017-04-17T08:04:00.380

*新手的简单方法：*

```
title.ToLower().Contains("string");//of course "string" is lowercase. 
```

# javascript - 使用 jquery 在表中移动 X 行

> ID：444801
> 
> 赞同：1
> 
> 时间：2009-01-14T21:40:30.990
> 
> 标签：javascript, jquery

我正在尝试使用 jQuery 在表格中向下移动 X 行...

我可以执行以下操作并且它有效....

```
/* Now let's move next 3 times to arrive at the foo account */
for (var rowCount = 1; rowCount <=3; rowCount++) {
    foobarRow = $(foobarRow).next('tr');
} 
```

我意识到我可以去

```
 foobarRow = $(foobarRow).next('tr');
    foobarRow = $(foobarRow).next('tr');
    foobarRow = $(foobarRow).next('tr'); 
```

还...

但我想知道是否没有更 jQueryish 的方式来完成同样的事情？

就像，我不知道，但是（完全由 jQuery 语法组成）......

```
foobarRow = $(foobarRow).next('tr').number(3); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-14T21:43:15.477

您可以通过索引匹配元素[`:eq(index)`](https://api.jquery.com/eq-selector/)。

`$("tr:eq(2)")`选择第三个`<tr>`。请注意，这是一个从零开始的索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T21:44:42.743

这应该这样做：

```
foobarRow = $(foobarRow).siblings().get(2); 
```

# c - 从 PDF 文件中获取 CGImage

> ID：444815
> 
> 赞同：0
> 
> 时间：2009-01-14T21:42:54.340
> 
> 标签：c, macos, pdf, quartz-graphics

我有一个 PDF 文件，其中每一页都是 (LZW) TIFF 文件。我知道这一点，因为我创造了它。我希望能够加载它并将其保存为一堆 TIFF 文件。

我可以使用 CGPDFDocumentCreateWithURL 打开 PDF 文件，并获得一个页面。我什至可以将页面绘制到屏幕上。

我想做的是将页面绘制到 bitmapContext 中，这样我就可以使用 CGBitmapContextCreateImage 将图像放入 CGImageRef 中。但是，为了创建位图上下文，我需要知道图像的大小和分辨率。我似乎无法找到如何获取 CGPDFDocument 或 CGPDFPage 来告诉我该页面上图像对象的分辨率。

有没有我没有意识到的更简单的方法来做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T13:54:09.363

[Ghostscript](http://pages.cs.wisc.edu/~ghost/)将在这里为您工作：

**gs [-sDEVICE=tiff32nc](http://pages.cs.wisc.edu/~ghost/doc/cvs/Devices.htm#TIFF) -sOutputFile=foo-Page%d.tif foo.pdf**

对于 2 页文档 foo.pdf，您应该得到：

*   foo-Page1.tif
*   foo-Page2.tif

从内存中我认为 GS 的输出分辨率是包含页面的分辨率，不一定是嵌入文件的分辨率（除非它们一开始是相同的）。

如果是这种情况，并且您想恢复原始图像，您可以使用[iText](http://www.lowagie.com/iText/) (java) 或[iTextSharp](http://itextsharp.sourceforge.net/) (.net)[获取图像](https://stackoverflow.com/questions/452667/how-can-i-tell-the-resolution-of-scanned-pdf-from-within-a-shell-script#453291)内容流（即字节）并将它们写入将内容流转换为 PdfImage iirc 后，以您选择的格式磁盘。

希望ghostscript选项适用于节省编写另一个实用程序...

# sql - 两列性能问题的左外连接

> ID：444820
> 
> 赞同：11
> 
> 时间：2009-01-14T21:45:11.527
> 
> 标签：sql, oracle, join, oracle10g, left-join

我正在使用类似于以下形式的 SQL 查询：

```
SELECT col1, col2
FROM table1
LEFT OUTER JOIN table2
ON table1.person_uid = table2.person_uid
AND table1.period = table2.period 
```

它要么太慢，要么陷入僵局，因为返回至少需要 4 分钟。如果我将其更改为：

```
SELECT col1, col2
FROM table1
LEFT OUTER JOIN table2
ON table1.person_uid = table2.person_uid
WHERE table1.period = table2.period 
```

然后它工作正常（尽管没有返回正确的列数）。有什么办法可以加快这个速度吗？

**更新**：如果我切换后一个查询的最后两行，它会做同样的事情：

```
SELECT col1, col2
FROM table1
LEFT OUTER JOIN table2
ON table1.period = table2.period
WHERE table1.person_uid = table2.person_uid 
```

**更新2：** 这些实际上是我加入的观点。不幸的是，它们位于我无法控制的数据库中，因此我无法（轻松）对索引进行任何更改。我倾向于同意这是一个索引问题。我会在接受答案之前稍等片刻，以防有一些我不知道的神奇方法来调整这个查询。否则，我将接受当前答案之一，并尝试找出另一种方法来做我想做的事情。感谢大家到目前为止的帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-14T21:52:16.253

请记住，陈述 2 和 3 与第一个不同。

如何？好吧，您正在执行左外连接，而您的 WHERE 子句没有考虑到这一点（就像 ON 子句一样）。至少，尝试：

```
SELECT col1, col2
FROM table1, table2
WHERE table1.person_uid = table2.person_uid (+)
AND table1.period = table2.period (+) 
```

看看你是否遇到同样的性能问题。

这些表上有哪些索引？这种关系是由外键约束定义的吗？

您可能需要的是 person_uid 和 period（在两个表上）的复合索引。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-15T01:35:46.333

我认为您需要了解为什么最后两个查询与第一个查询不同。如果您进行左连接，然后添加一个 where 子句引用连接右侧表中的一个字段（可能并不总是有一条记录与第一个表匹配），那么您实际上已将连接更改为一个内部连接。有一个例外，那就是如果你引用类似的东西

```
SELECT col1, col2
FROM table1
LEFT OUTER JOIN table2
ON table1.person_uid = table2.person_uid
WHERE table2.person_uid is null 
```

在这种情况下，您要求第二个表中没有记录的记录。但除了这种特殊情况，如果您在 where 子句中引用 table2 中的字段，则将左连接更改为内连接。

如果您的查询速度不够快，我会查看您的索引。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-15T18:16:37.390

任何人根据您提供的信息告诉您的任何事情都是猜测。

查看查询的执行计划。如果您没有看到计划缓慢的原因，请在此处发布计划。

[http://download.oracle.com/docs/cd/B28359_01/server.111/b28274/ex_plan.htm#PFGRF009](http://download.oracle.com/docs/cd/B28359_01/server.111/b28274/ex_plan.htm#PFGRF009)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-14T21:48:51.393

您是否在两个表`person_uid`上都有覆盖索引？`period`

如果没有，请添加它们并重试。

查看执行计划并查看查询实际在做什么。

另外：字段的数据类型是什么？它们在两个表中是否相同？隐式转换确实可以减慢速度。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-14T21:50:11.097

这些表是否在您要加入的列上有索引？安装 Oracle 的免费 SQLDeveloper 产品并使用它对该查询进行“解释”，并查看它是否正在对两个表进行顺序扫描。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-15T16:50:21.357

在左连接中，您将在 table1 中扫描 (person_uid,period) 的每个唯一组合，然后在 table2 中搜索所有对应的记录。如果 table2 没有适当的索引，这也可能涉及扫描整个表。

在没有看到执行计划的情况下，我最好的猜测是第一个查询（唯一一个似乎正确的查询）必须对 table2 和 table1 进行表扫描。

正如您所说，您无法更改索引，您需要更改查询。据我所知，只有一种现实的选择......

```
SELECT
   col1, col2
FROM
   table2
FULL OUTER JOIN
   table1
      ON table1.person_uid = table2.person_uid
      AND table1.period = table2.period
WHERE
   table1.person_uid IS NOT NULL 
```

这里的希望是您扫描 table2 以查找 (person_uid, period) 的每个唯一组合，但使用 table1 上的索引。（与扫描 table1 并使用 table2 上的索引相反，这是我从您的查询中所期望的。）

但是，如果 table1 没有适当的索引，那么您根本看不到任何性能改进......

民主党。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-19T16:36:15.753

在其中一项更新中，OP 声明他实际上是在查询视图而不是表。在这种情况下，可以通过直接查询他需要的表来提高性能，特别是当视图很复杂并且连接到许多其他不包含他需要的信息的表或者它们是调用视图的视图时。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-08T18:45:52.327

ANSI 连接语法在 JOIN 条件和 FILTER 谓词之间提供了非常清晰的区别；这在编写外连接时非常重要。使用 emp/dept 表，查看以下两个外连接的结果

第一季度

```
SELECT dname, d.deptno, e.ename, e.mgr, d.loc
FROM dept d
LEFT OUTER JOIN emp e
on  d.deptno = e.deptno
and loc in ('NEW YORK','BOSTON' )
;

DNAME              DEPTNO ENAME             MGR LOC
-------------- ---------- ---------- ---------- -------------
ACCOUNTING             10 CLARK            7839 NEW YORK
ACCOUNTING             10 KING                  NEW YORK
ACCOUNTING             10 MILLER           7782 NEW YORK
RESEARCH               20                       DALLAS
SALES                  30                       CHICAGO
OPERATIONS             40                       BOSTON 
```

====

```
Q2
SELECT dname, d.deptno, e.ename, e.mgr, d.loc
FROM dept d
LEFT OUTER JOIN emp e
on  d.deptno = e.deptno
where loc in ('NEW YORK','BOSTON' )
;

DNAME              DEPTNO ENAME             MGR LOC
-------------- ---------- ---------- ---------- -------------
ACCOUNTING             10 CLARK            7839 NEW YORK
ACCOUNTING             10 KING                  NEW YORK
ACCOUNTING             10 MILLER           7782 NEW YORK
OPERATIONS             40                       BOSTON 
```

第一个示例，Q1 显示的是“加入常量”的示例。本质上，过滤条件是在执行外部连接之前应用的。因此，您消除了行，这些行随后作为外连接的一部分添加回来。这不一定是错误的，但这是您真正要求的查询吗？通常需要 Q2 中显示的结果，在（外部）连接之后应用过滤器。

对于大型数据集，也有性能影响。在许多情况下，常量连接必须由优化器通过创建横向视图在内部解决，这通常只能通过嵌套循环连接而不是哈希连接进行优化

对于熟悉 Oracle 外连接语法的开发人员，查询可能会写成

```
SELECT dname, d.deptno, e.ename, e.mgr, d.loc
FROM dept d
        ,emp e
where  d.deptno = e.deptno(+)
and loc in ('NEW YORK','BOSTON' ) 
```

此查询在语义上与上面的 Q2 等效。

所以总而言之，在编写 ANSI 外连接时，了解 JOIN 子句和 WHERE 子句之间的区别非常重要。

# css - 影响 jQuery datepicker 外观的蓝图 CSS

> ID：444842
> 
> 赞同：4
> 
> 时间：2009-01-14T21:50:42.560
> 
> 标签：css, jquery-ui, blueprint-css

有没有人有任何指示如何解决在使用 jquery ui 的 datepicker 和侧蓝图 css 框架时出现的样式问题？具体来说，带有日期的表格看起来比它所在的容器更大（更宽）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-10-22T12:07:37.560

我尝试了其他答案，但他们没有为我做。在解决这个问题几个小时后，我想出了一个适合我的解决方案（Blueprint 1.0，Jquery UI 1.8.5，在 Chrome 和 IE 中使用 Smoothness、Redmond 和 Dark Hive 主题进行了测试）：

```
/* remove blue backgrounds - separate for TH to work in IE */
.ui-datepicker-calendar tbody tr:nth-child(even) td,  
.ui-datepicker-calendar tbody tr.even td {
  background-color:inherit;
 }
.ui-datepicker-calendar thead th {
  background-color:inherit;
 }
/* set correct line height */
.ui-datepicker-calendar tbody tr td {  
  line-height: 1.1;
}
/* (optional)  make same size as example */
.ui-datepicker { font-size: 0.9em; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T22:04:05.310

添加了以下CSS来解决问题：

```
.ui-datepicker-calendar table{
  margin: 0; }
.ui-datepicker-calendar th , .ui-datepicker-calendar td {
  padding: 0; text-align: center; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-09T09:38:03.527

我发现我必须非常具体地访问元素并删除一些填充。

```
/* JQUERY-UI + BLUEPRINT CSS CALENDAR FIX */
.ui-datepicker table{
  margin: 0; }
.ui-datepicker-calendar thead tr th , .ui-datepicker tbody tr td {
  background:white; color:#333;  }
.ui-datepicker-calendar thead tr th{
  padding: 5px 0; }
.ui-datepicker-calendar tbody td{
  padding:0 2px 2px 0; }
.ui-datepicker-calendar tbody td a{
  padding:0 1px 0 0; }
.ui-datepicker-calendar {
  font-size:0.8em; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T15:29:08.840

谢谢您的帮助。

我发现在它看起来更接近默认样式之前，我必须进行更多更改：

```
/*JQUERY-UI + BLUEPRINT CSS CALENDAR FIX*/
.ui-datepicker-calendar table{
  margin: 0; }
.ui-datepicker-calendar th , .ui-datepicker-calendar td {
  padding: 0; text-align: center; background:white; color:#333;  }
.ui-datepicker-calendar th{
  padding: 5px 0; }
.ui-datepicker-calendar td{
  padding:0 2px 2px 0; }
.ui-datepicker-calendar td a{
  padding:0 1px 0 0; }
.ui-datepicker {
  font-size:0.8em; } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-29T19:09:52.643

oneBelizean 是在正确的轨道上，但它对我不起作用，直到我用 table 限定了 th 和 td 选择器：

```
.ui-datepicker-calendar table{
  margin: 0; }
.ui-datepicker-calendar table th , .ui-datepicker-calendar table td {
  padding: 0; text-align: center; } 
```

完成此操作后，我不再需要 Simon 添加的任何额外内容。

# php - 一个类有多少个静态方法太多了？

> ID：444844
> 
> 赞同：3
> 
> 时间：2009-01-14T21:51:02.310
> 
> 标签：php, oop, static

**更新：**在这个类结构中改写问题，“有太多”静态方法（我意识到现在只有 4 个，但我最初从 2 个开始）？如果是这样，关于如何重构这些类以使用某种 Finder 类以便我可以从模型类中删除静态函数的任何建议？

我有以下抽象类：

```
abstract class LP_Model_Abstract
{
protected static $_collectionClass = 'LP_Model_Collection';

protected $_row = null;

protected $_data = array();

public function __construct($row = null)
{
    $this->_row = $row;
}

public function __get($key)
{
    if(method_exists($this, '_get' . ucfirst($key)))
    {
        $method = '_get' . ucfirst($key);
        return $this->$method();            
    }
    elseif(isset($this->_row->$key))
    {
        return $this->_row->$key;
    }
    else
    {
        foreach($this->_data as $gateway)
        {
            if(isset($gateway->$key))
            {
                return $gateway->$key;
            }
        }
    }   
}

public function __set($key, $val)
{
    if(method_exists($this, '_set' . ucfirst($key)))
    {
        $method = '_set' . ucfirst($key);
        return $this->$method($val);            
    }
    elseif(isset($this->_row->$key))
    {
        $this->_row->$key = $val;
        return $this->_row->$key;
    }
    else
    {
        foreach($this->_data as $gateway)
        {
            if(isset($this->_data[$gateway]->$key))
            {
                $this->_data[$gateway]->$key = $val;
                return $this->_data[$gateway]->$key;
            }
        }
    }
}

public function __isset($key)
{
    return isset($this->_row->$key);
}

public function save()
{
    $this->_row->save();
}

abstract public static function get($params);
abstract public static function getCollection($params = null);
abstract public static function create($params); 
```

}

然后这个类为类表继承方案提供额外的功能（其中类型对于以工厂方式确定额外功能很重要）：

```
abstract class LP_Model_Factory_Abstract extends LP_Model_Abstract
{
    protected static $_collectionClass = 'LP_Model_Collection_Factory';

    abstract public static function factory($row);
} 
```

这些最终导致以下类型的类声明：

```
class Model_Artifact extends LP_Model_Factory_Abstract
{
    protected static $_artifactGateway = 'Model_Table_Artifact';

    public static function create($params)
    {

    }

    public static function get($params) 
    {
        $gateway = new self::$_artifactGateway();

        $row = $gateway->fetchArtifact($params);

        return self::factory($row);        
    }

    public static function getCollection($params = null) 
    {
        $gateway = new self::$_artifactGateway();

        $rowset = $gateway->fetchArtifacts($params);

        $data = array(
            'data' => $rowset,
            'modelClass' => __CLASS__
        );

        return new self::$_collectionClass($data);
    }

    public static function factory($row)
    {
        $class = 'Model_Artifact_' . $row->fileType;
    }
} 
```

你什么时候知道一个类中有太多的静态方法？您将如何重构现有设计，以便将静态方法封装在某种 Finder 类中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T22:06:01.377

我必须同意 Brubaker 的观点，并在我的想法中补充一点，与其说是方法的数量，不如说是所述方法的功能。如果您开始认为您的类具有许多方法（静态或其他），那么您可能会发现它们可以重新分组并重构为更直观的架构。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T21:59:56.957

在确定是否需要许多静态方法时，我使用的第一个指标是方法功能是否不是无状态的。如果静态方法改变了它们所在对象的状态，它们可能不应该是静态的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T23:45:40.690

我同意 BaileyP 的观点，我会加几分钱：

我一直认为一个类应该有一个存在的理由。它应该有一项工作，而且应该做得很好。在决定了这一点并弄清楚该类的接口应该是什么之后，我检查了所有不会更改类实例状态的函数并将其标记为静态。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-15T02:10:05.813

如果你想构建可重用和可测试的代码，你应该[完全避免使用静态方法](http://googletesting.blogspot.com/2008/12/static-methods-are-death-to-testability.html)。调用静态方法（或非类数据类的构造函数）的代码不能单独测试。

是的，如果您消除静态方法，您将不得不传递更多的对象。这不一定是坏事。它迫使您以规范的方式思考组件之间的边界和合作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T22:32:33.710

我会投入我的 2 美分。

首先，我同意设置某种任意限制是没有帮助的，例如“一旦我在一个类中有超过 10 个静态变量就太多了！”。在有意义的时候进行重构，但不要仅仅因为你已经达到了一些想象的边界就开始这样做。

我不会 100% 同意 Brubaker 关于有状态与无状态的评论——我认为问题更多是关于类与实例。因为静态方法可以更改另一个静态属性的值，这是一个有状态的更改。

所以，这样想——如果方法/属性属于或属于*类*，那么它可能应该是静态的。如果方法/属性属于或属于类的*实例*，则它不应该是静态的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T23:24:01.687

就我个人而言，我发现任何数量的静态方法都是麻烦的迹象。如果您的类具有实例方法和静态方法，那么您很可能可以将类拆分为两个单独的实体并将静态方法更改为实例方法。

将类视为一种特殊的对象，具有其本质上是全局的独特属性。由于它是一个全局变量，它意味着非常强的耦合度，因此您需要减少对它的任何引用。需要引用静态成员，这意味着您的代码将获得与类的高度耦合。

# eclipse - 烦人的日食自动关闭引号

> ID：444845
> 
> 赞同：96
> 
> 时间：2009-01-14T21:51:14.620
> 
> 标签：eclipse

我一直发现 eclipse 的自动右引号和括号功能毫无用处。例如，点击单个 " 将导致

```
"<cursor>" 
```

我不需要第二个报价。之后删除很烦人。如何关闭此功能？

**更新：** 我现在保持设置。如果您键入另一个引号 " 它将突破。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-01-14T21:58:19.067

尝试 Window -> Preferences -> Java -> Editor -> Typing 并取消选中“Automatically close”组中的“Strings”复选框。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-07-27T12:21:17.630

您需要为所有编辑器关闭此功能：转到首选项并在“输入文件管理器文本”框中输入“打字”。然后单击每个结果并取消选中所有不需要的自动关闭选项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T21:58:20.267

输入完字符串内容后（至少在 java 编辑器中），只需按 Enter 即可跳出引号。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-14T19:27:21.980

要在 Titanium Studio 中关闭自动引号，请在首选项 -> Titanium Studio -> 编辑器 -> 取消选中“自动关闭匹配字符对”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-31T09:10:05.657

当您想退出自动完成报价时，您也可以点击报价。这会将您置于报价之外，就像您自己关闭报价一样。所以这个特性并没有真正打断你的编程流程。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-05T17:58:42.240

PyDev for eclipse 中类似自动引用功能的位置：Windows -> PyDev -> Editor -> Typing -> "Automatic literal closing"。

为了启用按 Enter 退出引号，请选中​​“启用自动括号或文字关闭的链接”。

# c# - ASP.NET 中的简单 Facebook Connect 演示

> ID：444846
> 
> 赞同：14
> 
> 时间：2009-01-14T21:51:26.070
> 
> 标签：c#, asp.net, openid, facebook

有没有人在 asp.net 应用程序中有一个简单而成功的 facebook connect 演示实现。我正在开发一个 asp.net Web 应用程序，并希望 facebook connect 成为登录的主要方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-15T00:06:54.313

我也遇到了麻烦，但发现[这个stackoverflow问题](https://stackoverflow.com/questions/323019/facebook-connect-and-asp-net)让我在服务器端的事情上走上了正确的轨道

但是，首先你必须让 facebook 连接按钮从这里[Facebook Wiki工作](http://wiki.developers.facebook.com/index.php/Logging_In_And_Connecting)

然后检测他们是否登录并将他们适当地重定向到欢迎页面。 [通过 Javascript 检测登录](http://wiki.developers.facebook.com/index.php/Detecting_Connect_Status)

大多数其他操作可以通过使用 Facebook 工具包的服务器端完成。（例如获取他们的信息、朋友等。）

我想我应该提到的最后一件事是注销用户，所以看看这个。[Facebook 维基：注销](http://wiki.developers.facebook.com/index.php/Logging_Out_And_Disconnecting)

希望这可以帮助

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-03-28T19:12:33.717

如我所见，上述所有示例和链接都已过时。新的 Facebook Graph API 使整个过程变得更加容易，无需任何其他组件：

[http://area72.ro/general-it/how-to-login-via-facebook-in-asp-net.html](http://area72.ro/general-it/how-to-login-via-facebook-in-asp-net.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T22:42:13.987

尝试使用名为[Facebook Developer Toolkit的工具包](http://www.codeplex.com/FacebookToolkit)

你在[Steve](http://www.stevetrefethen.com/)博客上有一篇[关于它](http://www.stevetrefethen.com/wiki/Default.aspx?Page=Facebook%20application%20development%20in%20ASP.NET&AspxAutoDetectCookieSupport=1)的帖子，你甚至可以下载他的[Starter Kit](http://www.stevetrefethen.com/files/FacebookApp2008v2.0.vsi)，这样你就可以查看所有代码 :)

希望能帮助到你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T22:55:28.530

我知道您要求提供 ASP.NET 资源。Facebook Connect 页面提供了一些有用的信息以及使用 PHP 的示例实现的源代码。希望您可以从 PHP 代码中提取一些好的信息。

[http://developers.facebook.com/connect.php](http://developers.facebook.com/connect.php) 查看右侧的链接。

提供的演示可以在这里访问...[http://www.somethingtoputhere.com/therunaround/](http://www.somethingtoputhere.com/therunaround/)

# visual-studio-2008 - MSBUILD MSB4075

> ID：444857
> 
> 赞同：0
> 
> 时间：2009-01-14T21:55:40.583
> 
> 标签：visual-studio-2008, msbuild

我将我的 VS2005 转换为 VS2008 并收到以下错误：

错误 MSB4075：项目文件必须在 Visual Studio IDE 中打开并转换为最新版本，然后才能由 MSBuild 构建。

任何帮助表示赞赏。谷歌这次让我失望了哈哈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T21:57:50.423

听起来您转换了解决方案，但没有转换项目文件。也许在您进行转换时项目文件已被卸载？无论如何，尝试在 Visual Studio 中打开项目文件并让它进行转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-13T09:47:36.130

就像 Odez 在他的评论中所说的那样，由于 .user 文件，我也遇到了这个错误。在我的情况下，它是一个较旧的转换项目，它在转换为 svn 时签入了 .user 文件。从版本控制中删除它们修复了错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T22:58:41.020

Rob Prouse 是对的 - 听起来项目文件尚未转换。如果您由于某种原因无法按照他的建议转换项目文件，您应该可以手动运行旧版本的 MSBuild。MSBuild 与 .NET 框架一起安装，应在*%WinDir%\Microsoft.NET\Framework\v2.0.50727\MSBuild.exe 中*找到。从内存中，命令行只是“MSBuild *ProjectFilename* ”。

# java - 转义发布到 Servlet 的特殊字符

> ID：444874
> 
> 赞同：2
> 
> 时间：2009-01-14T22:00:42.930
> 
> 标签：java, jsp, web-applications, servlets

我有一个 jsp，其中包含一个发布到 servlet 的表单，当 servlet 从表单接收参数时，井号 (£) 前面带有以下字符 Â。所以£变成了£。是什么原因造成的，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T22:15:42.777

这听起来很像字符编码问题。包含井号的响应以 UTF-8 字符集发送，但以不同的字符集（可能是 ISO-8859-1）进行解释。

检查您为 JSP 指定的字符编码，如果问题仍然存在，请使用嗅探器调查表单发布的响应，特别是它指定的任何字符集。默认情况下，表单应该使用与提供它的页面相同的字符集，因此您应该能够通过检查页面的字符集来控制它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-15T08:55:57.327

您可以做的是，在从请求对象检索之前，在您的 JSP 页面中，为您的请求设置内容类型。[例如 request.setCharacterEncoding("utf-8");]

现在你可以做 request.getParameter("yourParamName");

我也遇到了同样的问题并如上所述解决了。

# java - 我可以使用 java.util.Set 在 Java 中为 DFA 实现状态转换吗

> ID：444889
> 
> 赞同：3
> 
> 时间：2009-01-14T22:04:42.907
> 
> 标签：java, computer-science, set, finite-automata

我正在实施一个尽可能接近正式定义的 DFA 作为学习练习（和博客材料）

我计划使用一个 java.util.Set ，其中定义中涉及一个集合。

该定义涉及一组元组来定义合法的状态转换：(state,symbol) -> nextState。

我有一个带有成员 state、symbol 和 nextState 的 Transition 类。我已经实现了 equals() 和 hashCode() 来指示如果两个转换在状态和符号上匹配，则它们是相等的。然后我有一个 java.util.Set 的 Transition 实例。

在我的处理算法中，当我读取下一个符号时，我拥有当前状态。我预计使用这两个构建一个 Transition 对象，从 Set 中提取匹配的 Transition，然后它会告诉我下一个状态，我可以迭代。

但是 - 我看不到任何提取 java.util.Set 成员以供进一步使用的方法。我可以删除（对象 o），但这只是返回布尔值。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T22:08:27.610

Set 可能不是您想要使用的。我的建议是使用 List<Transition>，或者可能是 Map<State,List<Transition>>。如果不实际构建它并进行一些基准测试，我不确定哪个会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T22:14:44.087

听起来好像您对 equals() 和 hashCode() 的覆盖是可疑的，因为原始转换根据 equals() 与集合中的转换匹配，但两者不可互换（否则您只需使用新转换到位原来的。）

您可能想要一个只是状态和符号组合而没有其他属性的类，并将其用作 Map 中的键。或者，您可以使用`Map<State, Map<Symbol, State>>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T22:15:29.763

我同意 Matthew Brubaker 的观点，这`Set`可能不是您所需要的。您可能想尝试一下`enums`；有关示例，请参见[Java 词汇表。](http://mindprod.com/jgloss/finitestate.html#STRATEGY)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T22:20:23.670

如果没有一些外部状态集合，甚至是 Transistion 对象，你就不能做到这一点吗？如果 State 类的定义如下：

```
public class State
{
    private Map<Symbol, State> transitions = new HashMap<Symbol, State>();

    public State() { /* populate transitions somehow */ }

    public State nextState(Symbol symbol) { return transitions.get(symbol); }
} 
```

然后，如果你有对初始状态的引用，你可以像这样从一个状态移动到另一个状态：

```
State initial = getInitialStateSomehow();
State second = initial.nextState(SYMBOL_1);
State third = initial.nextState(SYMBOL_2);  // etc... 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-14T22:31:56.113

是的，我有点困惑为什么甚至需要一个集合。

对于一个简单的状态机，您可以使用静态整数和 case 语句来执行您的状态机，如下所示：

```
int STATE1 = 1; 
int STATE2 = 2;
int STATE3 = 3;
int STATE4 = 4;

int currentstate = STATE1 ;
int input = nextInput();

while(currentstate != STATE4 ){
   switch(input){
      case STATE1: 
          if(input == 'a') currentstate = STATE2; 
          break;
      case STATE2: 
          if(input == 'b') currentstate = STATE3;
          else currentstate = STATE1;
          break;
      case STATE3: 
          if(input == 'c')  currentstate = STATE4;
          else currentstate = STATE1;
      }
 } 
```

这是一个基本状态机，它将查找任何包含“abc”的字符串。你也可以很容易地扩展它来寻找 ab*c 或任何你想要的东西。

那么如果你想要一个在运行时构建的动态状态机呢？嗯，我也做过这个。这不是太难。我所做的是创建一个带有转换列表的状态类。每个转换都有一个指向下一个状态的指针，以及链接的标准。

因此，例如，STATE1 将具有条件“a”的转换和指向表示 STATE2 的某个对象的指针。代码会检查条件（它可以是一个将 int 作为参数并在匹配时返回 true 或 false 的对象），如果条件匹配，它会将状态指针移动到转换所指向的状态。

代码可能看起来像这样

 `````
public void move(int input){
   for(transition t : currentState.transitions){
      if(t.getCriteria().matches(input)){
         currentState = t.getNextState();
         break;
      }
   }
} 
````  `* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-14T22:40:42.227

如果您只想实现模式匹配引擎，则可能不需要状态设计模式，因为模式不太可能改变。正如 Chad 所指出的，`switch`在这种情况下，使用 a 对转换函数进行编码是完全可以接受的。

这是一个使用集合的非确定性模式匹配自动机的示例：

```
public boolean validate() {
    Set<Integer> currentStates = new HashSet<Integer>();
    final Set<Integer> acceptingStates = new HashSet<Integer>();

    currentStates.add(0); // Initial state.
    acceptingStates.add(1);
    acceptingStates.add(3);
    acceptingStates.add(6);

    for (int i = 0; i < getInput().length(); i++) {
        char c = getInput().charAt(i);
        Set<Integer> newStates = new HashSet<Integer>();

        for (int state : currentStates) {
            switch (state) {
                case 0:
                    if (c == 'a')
                        newStates.add(1);
                    break;
                case 1:
                    if (c == 'b') {
                        newStates.add(2);
                        newStates.add(4);
                    }
                    break;
                case 2:
                    if (c == 'b')
                        newStates.add(3);
                    break;
                case 3:
                    if (c == 'b')
                        newStates.add(2);
                    break;
                case 4:
                    if (c == 'b')
                        newStates.add(5);
                    break;
                case 5:
                    if (c == 'b')
                        newStates.add(6);
                    break;
                case 6:
                    if (c == 'b')
                        newStates.add(4);
                    break;
            }
        }

        if (newStates.size() == 0)
            return false;
        currentStates = newStates;

        System.out.printf("Character read: %c\n", c);
        System.out.printf("Current states: ");
        printStates(currentStates);
    }

    for (int state : acceptingStates)
        if (currentStates.contains(state))
            return true;
    return false;
} 
```

该自动机识别由模式`"a(bb*|bbb*)`“”描述的常规语言的输入词，即“a”后跟两个的倍数或三个许多“b”的倍数。

# javascript - AJAX/getJSON 中的 jQuery 范围或竞争条件

> ID：444890
> 
> 赞同：9
> 
> 时间：2009-01-14T22:05:17.087
> 
> 标签：javascript, jquery, ajax, json, timing

我有一段 jQuery 代码可以`getJSON()`快速连续调用多个调用：

```
var table = $("table#output");
for (var i in items) {
    var thisItem = items[i];
    $.getJSON("myService", { "itemID": thisItem }, function(json) {
        var str = "<tr>";
        str += "<td>" + thisItem + "</td>";
        str += "<td>" + json.someMember + "</td>";
        str += "</tr>";
        table.append(str);
    });
} 
```

当我在一个滞后的服务器上运行它时，表中填充了预期`json.someMember`值（它们乱序到达：我不介意），但是该`thisItem`列填充了来自各种迭代的不可预测的混合值。

我假设这与范围和时间有关 - 回调函数正在`thisItem`从更广泛的范围读取？我对吗？我该如何防止这种情况？

我目前的解决方法是让 JSON 服务返回其输入的副本 - 至少可以说是不令人满意的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-14T22:11:27.823

由于循环，这似乎是一个范围问题。试试这个：

```
var table = $("table#output");
for (var i in items) {
    var thisItem = items[i];
    $.getJSON("myService", { "itemID": thisItem }, (function(thisItem) {
        return function(json) {
            var str = "<tr>";
            str += "<td>" + thisItem + "</td>";
            str += "<td>" + json.someMember + "</td>";
            str += "</tr>";
            table.append(str);
        }
    })(thisItem));
} 
```

*编辑*：我所做的只是`thisItem`回调的`$.getJSON`范围。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T23:14:45.433

Javascript 不使用块作为范围。范围仅基于功能。

如果你想要一个新的作用域，你必须声明一个新的内部函数并立即运行它，这是在 Javascript 中创建新作用域的唯一方法。

```
var table = $("table#output");
for( var i in items ) 
{
    (function(){
        var thisItem = items[i];
        $.getJSON("myService", { "itemID": thisItem }, function(json) 
        {
            var str = "<tr>";
            str += "<td>" + thisItem + "</td>";
            str += "<td>" + json.someMember + "</td>";
            str += "</tr>";
            table.append(str);
        });
    })();
} 
```

# javascript - jQuery 1.3 - 设置属性值的问题

> ID：444892
> 
> 赞同：1
> 
> 时间：2009-01-14T22:06:15.213
> 
> 标签：javascript, jquery, attributes

这是我的第一个 stackoverflow 问题，所以尽量表现得很好。;-D

我的问题是，我正在重构一些现有的 javascript 代码并使用 jQuery 来完成它。在几个地方，我遇到了类似于以下的 javascript 代码：

```
// some js code working with the customAttribute value
javascriptElementObject.customAttribue = void(0); 
```

javascriptElementObject 现在是一个 jQuery 对象，我一直在尝试使用以下代码来做同样的事情：

```
// some js code working with the customAttribute value
javascriptElementObject.attr("customAttribute", void(0)); 
```

但是，这似乎没有做任何事情。但是，以下代码有效：

```
javascriptElementObject.get(0).customAttribute = void(0); 
```

我知道 jQuery 的 removeAttr() 函数，但到目前为止还没有使用它，因为我不知道它是否相当于将属性值设置为 void(0)。

所以我想这真的意味着我有两个问题：

1.  为什么第一个 jQuery 版本不起作用？
2.  是 .get(0).customAttribue = void(0); 和 .removeAttr("customAttribute); 等效？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T22:37:01.343

jQuery 喜欢重载它的方法，所以：

```
obj.attr( name ) //retrieves the attribute value
obj.attr( name, value ) //sets the attribute

obj.attr( name, void(0) ) == obj.attr( name, null ) == obj.attr( name ) //i.e retrieving the attribute 
```

如果要设置空属性，您可能想尝试以下操作

```
obj.attr( name, '' ) 
```

这也适用于其他方法`jQuery.html()`，例如

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T22:20:57.493

你想达到什么目的？

如果目标是删除名称/值对中的值，您不妨完全删除该属性。我不知道维护没有价值的属性有任何内在价值。在不太符合标准的浏览器中，它甚至可能导致问题。

一般来说，$(selector).attr(name, value) 和 $(selector).removeAttr(name) 的语法工作得很好（至少我从未见过它失败。）

如果您尝试使用 void(0) 来防止触发 A HREF，那么最好使用“return false”作为这些 A 标签上的点击事件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T16:31:14.977

通过 jQuery 对象使用自定义属性的唯一方法是：

```
obj.get(0).myCustomAttr = 'some value'; 
```

这是因为 jQuery 的 attr() 方法**不适用于自定义属性**（除非应用于 XML 文档）。

另请注意，meouw 关于 jQuery 重载函数的回答并不完全正确，因为 jQuery 以以下方式检查传递给它的参数：

```
jQuery.funcname(param) 
```

和

```
jQuery.funcname(param, null) 
```

不同，因为`null !== undefined`。例如：

```
var params_test = function(a) {
    if (a === undefined) {
        return 'called with no parameters';
    } else {
        return 'called with one parameter: ' + a;
    }
};
params_test(); // results in 'called with no parameters'
params_test(null); // results in 'called with one parameter: null' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T22:22:29.283

嗯，试试这个：

```
javascriptElementObject.attr("customAttribute", void(0));
var _void = javascriptElementObject.attr("customAttribute");
alert(_void); 
```

# testing - 虚拟机的虚拟网络

> ID：444901
> 
> 赞同：0
> 
> 时间：2009-01-14T22:11:26.903
> 
> 标签：testing, networking, virtualization

我正在开发旨在在 LAN 上运行的软件。当软件的多个实例在网络上运行时，它们会相互干扰。

我希望多个团队成员能够同时测试该程序。我该怎么做（不改变程序）。

我的第一个想法是创建一堆在本地机器上运行的虚拟机，并将这些机器联网在一起。重要的是我无法在我的真机之外生成网络流量。

哪种虚拟化软件是完成这项任务的最佳选择？我将如何配置软件以这种方式运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T22:15:19.623

就个人而言，我喜欢[VMWare 服务器](http://vmware.com/products/server/)……它几乎可以开箱即用，而且它可以很好地处理 vm 网卡，允许它们被视为物理设备（就 DHCP 等而言）。

至于配置软件，就机器而言，它们是真实的。如果您为它们分配静态 IP，它们也可能是真实的机器 - 尽管您会发现通过远程桌面管理它们比使用 vmware 控制台界面更容易。

编辑：我实际上在生产环境中使用 VMWare 服务器，在同一个物理机器上运行虚拟网络服务器、虚拟数据库服务器和虚拟应用程序服务器。VMWare 还附带了一个很棒的转换器工具，可以虚拟化物理机。这让我可以更轻松地整合和维护我的服务器，从三台物理机减少到一台。

编辑2：它也是免费的；）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T22:44:27.240

我会建议[VirtualBox](http://www.virtualbox.org/)。我认为它设置的虚拟网卡可以连接到按名称标识的虚拟网络，在那里它们可以互相看到。

用户手册有针对各种场景的详细组网说明。从手册：

> 6.6\. 内部网络 内部网络类似于主机接口网络，因为虚拟机可以直接与外部世界通信。但是，“外部世界”仅限于连接到同一内部网络的其他 VM。

它在多个平台上运行：windows linux osx solaris。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T22:22:54.150

我使用[Sun xVM](http://www.virtualbox.org/) .... 默认情况下，它的网络位于 10.x 网络上，位于您的实际 IP 后面。所以我不确定这是否会干扰网络上的其他实例。但它是免费的并且运行良好，如果您使用的是 64 位操作系统并且有支持它的处理器，它支持 hyper-v 启动。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T05:57:59.177

几乎任何虚拟化软件都可以让您配置各种类型的网络。

例如，VMware 提供以下网络类型：

*   桥接 - 机器在物理局域网上显示为主机（不是您想要的）
*   NAT - 共享您的 PC 的 IP（如果您想允许您的应用程序访问物理 LAN/互联网）
*   仅限主机 - 仅对 VM 和您的 PC 可见的专用网络。如果您想允许 Internet/LAN 访问，您需要在主机 PC 上运行其他软件。
*   自定义 - 如果您需要运行多个虚拟网络来测试防火墙/webserver/vpn 组合配置等内容

就简单性和最少的配置而言，VMWare Workstation 可能是理想的选择。它非常易于使用，设置轻而易举。许可成本非常合理（单个许可 190 美元，或 5 个许可 900 美元），然后为了支付自己的许可费用，我建议为每个团队成员订阅 Microsoft Technet（如果他们都是开发人员并且你有 MSDN，那么你已经被覆盖了）

我建议将更便宜的替代品用于业余爱好，但如果您处于时间就是金钱的商业环境中，那么 VMware 将非常非常快地为自己的生产力提升付出代价。

最后，如果成本是一个问题，那么您*可以*使用单个 VMware 许可证来配置机器，然后使用免费的 VMware 播放器来运行它们，但是我不确定它是否具有所有相同的沙盒网络功能存在于 VMware Workstation 中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-06-10T14:12:21.910

最近有很多人在谈论 linux 网络命名空间，这是一种创建轻量级虚拟主机的方法。我相信这也是解决您问题的一种方法。

Mininet ( [http://mininet.org/](http://mininet.org/) ) 使用它来创建模拟网络，它工作得非常好。我刚刚开始使用网络命名空间进行测试，性能非常好，内存使用率非常低。

另请参阅[http://www.opencloudblog.com/?p=66](http://www.opencloudblog.com/?p=66)。

我从最后一个链接中获取了一系列命令并创建了一个测试设置：

```
#!/bin/bash
# add the namespaces
ip netns add ns1
ip netns add ns2
# create the switch
BRIDGE=ovs-test
ovs-vsctl add-br $BRIDGE
#
#### PORT 1
# create an internal ovs port
ovs-vsctl add-port $BRIDGE tap1 -- set Interface tap1 type=internal
# attach it to namespace
ip link set tap1 netns ns1
# set the ports to up
ip netns exec ns1 ip link set dev tap1 up
#
#### PORT 2
# create an internal ovs port
ovs-vsctl add-port $BRIDGE tap2 -- set Interface tap2 type=internal
# attach it to namespace
ip link set tap2 netns ns2
# set the ports to up
ip netns exec ns2 ip link set dev tap2 up

# add external port eth11
ovs-vsctl add-port $BRIDGE eth11

# configure ip addresses
ip netns exec ns1 ifconfig tap1 192.168.201.1/24
ip netns exec ns2 ifconfig tap2 192.168.201.2/24 
```

上面的命令基本上创建了两个连接到 Open vSwitch 网桥的主机。两台主机相互连接，并通过我的 eth11 以太网适配器连接到外部世界。与外界的桥接是完全可选的。

我可以像这样在虚拟主机之间运行 ping 和 iperf（输出有点乱，但我认为可以理解）：

```
# ip netns exec ns1 iperf -s &
[1] 22158
# ------------------------------------------------------------
Server listening on TCP port 5001
TCP window size: 85.3 KByte (default)
------------------------------------------------------------

# ip netns exec ns2 iperf -c 192.168.201.1
------------------------------------------------------------
Client connecting to 192.168.201.1, TCP port 5001
[  4] local 192.168.201.1 port 5001 connected with 192.168.201.2 port 43469
TCP window size: 85.0 KByte (default)
------------------------------------------------------------
[  3] local 192.168.201.2 port 43469 connected with 192.168.201.1 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0-10.0 sec  17.3 GBytes  14.9 Gbits/sec
[ ID] Interval       Transfer     Bandwidth
[  4]  0.0-10.0 sec  17.3 GBytes  14.9 Gbits/sec
# 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T22:41:42.410

如果你在 Windows 或 Linux 上运行，[VMWare Server](http://vmware.com/products/server/)（另一张海报提到）和[VirtualBox](http://www.virtualbox.org/)都应该做你想做的事，而且它们都是免费的。如果您愿意的话，VirtualBox 也可以在 Mac OS X 和 Solaris 上运行。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-14T22:18:01.553

在我之前的项目中，托管公司的人告诉我他们正在使用 VMWare 来配置网络农场，但我不知道如何做到这一点。

# web-services - 使用其 Web 服务参考部署 SharePoint WebPart

> ID：444905
> 
> 赞同：2
> 
> 时间：2009-01-14T22:12:53.810
> 
> 标签：web-services, sharepoint, sharepoint-2007, wss-3.0

我正在尝试构建一个 SharePoint Web 部件，其中包含对我需要从 vb 代码中调用的*另一个SharePoint 服务器的服务引用。*但是，当我第一次尝试调用远程 Web 服务时，我在日志中得到以下信息：

* * *

在 ServiceModel 客户端配置部分中找不到引用合同“ListReference.ListsSoap”的默认端点元素。这可能是因为没有为您的应用程序找到配置文件，或者因为在客户端元素中找不到与此合同匹配的端点元素。在 System.ServiceModel.Description.ConfigLoader.LoadChannelBehaviors(ServiceEndpoint serviceEndpoint, String configurationName) 在 System.ServiceModel.ChannelFactory.ApplyConfiguration(String configurationName) 在 System.ServiceModel.ChannelFactory.InitializeEndpoint(String configurationName, EndpointAddress address) 在 System.ServiceModel.ChannelFactory `1..ctor(String endpointConfigurationName, EndpointAddress remoteAddress) at System.ServiceModel.EndpointTrait`1.CreateSimplexFactory() 在 System.ServiceModel.ClientBase `1.CreateChannelFactoryRef(EndpointTrait`1 endpointTrait) 在 System.ServiceModel.ClientBase`1.InitializeChannelFactoryRef() at System.ServiceModel.ClientBase`1..ctor() 在 VSeWSS.ChangeRequestWorkflow.ChangeRequest.SubmitForm(Object sender, EventArgs e)

* * *

使用服务引用部署 Web 部件的正确方法是什么，我会做错什么吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T23:43:23.333

您需要将端点配置添加到使用 Web 服务的 SharePoint 站点的 web.config 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-22T09:24:53.360

我发现这个问题解决了我的问题。基本上，我只需要创建一个 BasicHttpBinding 对象并使用 SVC 生成器在我的 app.config 中创建的属性填充它的属性。

[没有配置文件的 WCF 配置](https://stackoverflow.com/questions/54579/wcf-configuration-without-a-config-file)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-05T08:19:22.143

其实我解决了我的问题。我的应用程序有很多项目，配置文件在调用WebService的项目中，但似乎它必须在启动项目中......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-21T14:06:09.610

嗯，如果我理解你的要求正确，我正在这样做。我刚刚将 Web 服务从正确的端点之一添加到 VS 中的项目中，然后在我在实际代码中调用它之前，我从 Codeplex 的分层对象存储中获取了我想通过此调用连接到的 URL，然后设置网址属性。所以：

```
MyService srv = new MyService();
srv.Url = SPContext.Current.Web.Properties["serviceurl"]; 
```

它工作得很好。hth。

# java - Java - 修改二进制序列化对象的 serialVersionUID

> ID：444909
> 
> 赞同：1
> 
> 时间：2009-01-14T22:14:13.153
> 
> 标签：java, serialization, serialversionuid

几个月前，我将一个 java.io.Serializable 对象序列化到一个文件中。现在我需要阅读内容，但从那以后 serialVersionUID 发生了变化，现在我收到“类不兼容”错误。我知道所有数据成员都没有改变，所以唯一的障碍是 serialVersionUID 检查。

有没有办法禁用检查或修改二进制文件中的 serialVersionUID？

澄清

这个问题假设我无法编辑源。有没有办法破解 .class 文件或破解序列化的目标文件（使用十六进制编辑器并在某个偏移量处更改值）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T22:20:35.543

[为什么不按照序列化](http://java.sun.com/j2se/1.5.0/docs/api/java/io/Serializable.html)文档中的说明修改当前版本中的 serialVersionUID ？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T22:24:35.457

作为 hack，您可以使用 serialver 工具生成您的 jvm 可能正在使用的 serialVer：

serialver -classpath 无论 com.foo.bar.MyClass

如果您随后在您的类中手动设置 serialVerUID，它应该匹配并且您应该能够加载，假设您没有以使类无效的方式更改类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-16T13:04:43.697

我最近发现自己处于类似的情况——我有一些我必须阅读的序列化对象，`serialVersionUID`这些对象与最新版本不同，在我的情况下，`serialVersionUID`文件中存储了几个不同的 s 用于同一类（显然存储在不同时间）。所以我没有修改类和设置它的奢侈`serialVersionUID`；我实际上不得不进入并修改存储的数据。

我发现（通过阅读 java.io 源代码）是通过首先存储类名（使用`writeUTF()`）然后在使用后立即`writeLong()`保存`serialVersionUID`.

我的解决方案是捕获异常然后返回，查找类名，并在类名之后立即将旧的替换`serialVersionUID`为新的。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-01-14T22:16:59.433

据记载，序列化不打算用于持久化数据。为了取回该数据，您需要将您的 JVM 版本降级到用于输出该数据的版本。

为了将来参考，不要使用序列化在 JVM 的会话之间持久化数据。

# codeigniter - 如何修改在 codeigniter 中完成的图像处理功能以提高效率

> ID：444916
> 
> 赞同：1
> 
> 时间：2009-01-14T22:17:54.020
> 
> 标签：codeigniter, resize, gd

我认为此功能没有应有的效率。我很感激一些关于如何将其构建得更快并占用更少内存的建议。这就是代码的作用：

1.  检查图像是否已上传
2.  将有关它的详细信息（标签、名称、详细信息）添加到数据库
3.  如果设置了变量 $orientation，则旋转图像
4.  如果图像宽于 600 像素，请调整其大小
5.  创建缩略图

我认为效率低下的原因在于将步骤 3、4、5 全部分开。有什么方法可以巩固它们吗？谢谢！

```
 function insert()
  {
    $config['upload_path'] = './uploads/';
    $config['allowed_types'] = 'jpg';
    $config['max_size'] = '5000';
    $config['max_width']  = '4096';
    $config['max_height']  = '4096';

    $this->load->library('upload', $config);

    if (!$this->upload->do_upload())
    {
      $data = array('error' => $this->upload->display_errors());

      $data['title'] = "Add Photo | Mark The Dark";
      $this->load->view('photo_add_view', $data);
    }   
    else
    {
      //get uploaded image info
      $data = array('upload_data' => $this->upload->data());

      //clean the data
      $data = $this->input->xss_clean($data);

      //get orientation info and erase it from POST variable
      //$orientation = $_POST['orientation'];
      //unset($_POST['orientation']);

      //grab the tags
      $tags = $_POST['tags'];
      unset($_POST['tags']);

      //add in some other stuff
      $_POST['time'] = date('YmdHis');
      $_POST['author'] = $this->dx_auth->get_user_id();

      //insert it in the database
      $this->db->insert('photos', $_POST);
      $photo_id = $this->db->insert_id();

      //add stuff to tags table
      /*
      $tags_array = preg_split('/[\s,;]+/', $tags);
      foreach($tags_array as $tag)
      {
        if($tag != "" || $tag != null)
          $this->db->insert('tags', array('id' => $photo_id, 'word' => $tag));
      }*/

      //CXtags
      /*$tags_array = preg_split('/[\s,;]+/', $tags);
      foreach($tags_array as $tag)
      {
        if($tag == "" || $tag == null)
        {unset($tags_array[$tag]);}
      }
      */
      $tags_array = $this->CXTags->comma_to_array($tags);
      foreach($tags_array as $tag)
      {$tags_array[$tag] = $this->CXTags->make_safe_tag($tag);}
      $topass = array(
        'table' => 'photos',
        'tags' => $tags_array,
        'row_id' => $photo_id,
        'user_id' => $_POST['author']
      );
      $this->CXTags->add_tags($topass);

      //rename the file to the id of the record in the database
      rename("./uploads/" . $data['upload_data']['file_name'], "./uploads/" . $photo_id . ".jpg");

      list($width, $height, $type, $attr) = getimagesize("./uploads/" . $photo_id . '.jpg');

      if (($orientation == 1) || ($orientation == 2))
      {
        //echo $orientation;
        //rotate image
        $config['image_library'] = 'GD2';
        $config['source_image'] = './uploads/' . $photo_id . '.jpg';
        if ($orientation == 1)
        {
          $config['rotation_angle'] = 270;
        }
        elseif ($orientation == 2)
        {
          $config['rotation_angle'] = 90;
        }
        $this->load->library('image_lib', $config);
        $this->image_lib->initialize($config);
        if(!$this->image_lib->rotate())
        {
          echo $this->image_lib->display_errors();
        }
      }

      $this->load->library('image_lib');
      if ($width > 600)
      {
        //resize image
        $config['image_library'] = 'GD2';
        $config['source_image'] = './uploads/' . $photo_id . '.jpg';
        $config['new_image'] = './uploads/photos/' . $photo_id . '.jpg';
        $config['create_thumb'] = FALSE;
        $config['maintain_ratio'] = TRUE;
        $config['width'] = 600;//180
        $config['height'] = 480;
        $config['master_dim'] = 'width';
        $this->image_lib->initialize($config);
        $this->load->library('image_lib', $config);
        if(!$this->image_lib->resize())
        {
          echo $this->image_lib->display_errors();
        }
      }
      else
      {

        $source = './uploads/' . $photo_id . '.jpg';
        $destination = './uploads/photos/' . $photo_id . '.jpg';
        rename($source, $destination);
      /*//buggy php???
        $result = copy($source, $destination);
        echo "HO" . $result;
        */

      }

      //create thumbnail
      $config['image_library'] = 'GD2';
      $config['source_image'] = './uploads/photos/' . $photo_id . '.jpg';
      $config['new_image'] = './uploads/thumbnails/' . $photo_id . '.jpg';
      $config['create_thumb'] = TRUE;
      $config['thumb_marker'] = '_thumb';
      $config['maintain_ratio'] = TRUE;
      $config['width'] = 180;//180
      $config['height'] = 100;
      $config['master_dim'] = 'width';
      $this->image_lib->initialize($config);
      $this->load->library('image_lib', $config);
      $this->image_lib->resize();

      redirect('photo/show/' . $photo_id);

    }

    //redirect('photo/photo_add/');
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T23:00:08.567

对于使用代码 igniter 为您公开的对象进行图像处理所需的所有工作，您可能希望自己严格使用 php.ini 中的 gd 函数来执行此操作。我没有用过code igniter，但是我在php中做了很多关于图像处理的东西，而且不是很困难。

仅通过查看您的代码，并且我假设这是代码点火器方式，我看到您调用`image_lib->initialize()`并`load->library()`为每个单独的操作。我会查看这些方法以及您正在使用的方法`rotate()`和`resize()`方法，看看它们是否在每次操作时创建和破坏图像资源。如果您使用 gd 库，则可以在每个步骤中重复使用相同的图像资源，然后在准备好时将其写入文件（重复使用相同的图像资源来创建缩略图）。这可能会在执行速度和使用的内存方面带来巨大的性能提升。

[PHP 中的 GD 函数](http://us3.php.net/manual/en/ref.image.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T23:55:58.807

好吧，我可以回答您的部分问题-您可以`exif`使用**Codeigniter**旋转带有旋转的图像。

**首先：** 检测上传的图片`exif`数据。
查看`$exif`数组并处理 Orientation 项。
传递所需的旋转角度以`codeigniters image_lib->rotate()`发挥作用。

例如：

```
public function auto_rotate_image($upload_data){//iphone rotation fix

        $path = $upload_data['full_path'];

        $exif = exif_read_data($path);
        if(isset($exif['Orientation'])){
            $rotate = false;
            switch($exif['Orientation']){//only really interested in the rotation
                case 1: // nothing
                break;
                case 2:// horizontal flip
                break;     
                case 3: // 180 rotate left
                    $rotate = 180;
                break;   
                case 4: // vertical flip
                break;
                case 5: // vertical flip + 90 rotate right
                break;
                case 6: // 90 rotate right
                    $rotate = 270;
                break;
                case 7: // horizontal flip + 90 rotate right
                break; 
                case 8: // 90 rotate left
                    $rotate = 90;
                break;
            }

            if($rotate){

                $config=array();
                $config['image_library'] = 'gd2';
                $config['source_image'] = $path;
                $config['rotation_angle'] = $rotate;
                $config['overwrite'] = TRUE;
                $this->load->library('image_lib',$config);

                if(!$this->image_lib->rotate()){
                    echo $this->image_lib->display_errors();
                }
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T22:34:06.107

您可以根据[codeigniter 文档](http://codeigniter.com/user_guide/libraries/config.html)将您的配置存储在其他地方，这将收紧代码。我不知道你怎么能把这些事件串起来。

# javascript - 隐藏元素背后的逻辑

> ID：444927
> 
> 赞同：2
> 
> 时间：2009-01-14T22:21:11.797
> 
> 标签：javascript, jquery, dom

我对这个特定问题的逻辑进退两难。如果这是一个新手问题，请原谅我，但我宁愿有一个坚实的背景。

网络上有很多这样的例子，你点击一个元素来显示另一个元素。这种情况可能是一个菜单，当您将鼠标悬停在它上面（或单击它）时，它就会显示出来。后来，该元素在鼠标移出或单击任何其他元素时被隐藏。那么，这是如何实现的？我确信解决方案不是在所有元素上绑定“hideElem”函数。

问候，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T22:26:31.770

我有一段时间没有这样做了，但一个简单的解决方案是在 DOM 树的顶部添加一个单击事件，该事件将关闭打开的元素。这是psuedo-javascript中的一个示例：

```
document.body.onclick = function() { 
   element.style.display = "none";
} 
```

如果您需要“显示”元素中的复杂行为，请确保阻止必要的事件在 DOM 树上传播。

```
element.onclick = function(e) {
  e.stopPropagation()
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-14T22:34:53.330

一般来说，逻辑是相反的（至少对于菜单），即相关元素被隐藏，直到状态事件取消隐藏它，然后按照指示再次隐藏。关键是隐藏/取消隐藏逻辑通常与元素本身相关，而不是页面上的所有其他内容。

至于它是如何完成的，方法各不相同。有很多 Javascript 解决方案，大部分都与已经概述的那些相同，但菜单也可以纯粹使用 CSS 来完成 - 通常使用*display: none;* 属性，尽管您也可以执行诸如设置/取消设置负边距之类的操作，以便将元素“移出并移到页面上”。

以我自己的一些工作为例：

*   [带有 Javascript 的下拉菜单](http://www.grandhall.eu/)
*   [带有 jQ​​uery 的下拉菜单](http://cleanteq.com/)
*   [带有 CSS 的下拉菜单](http://aboutmyage.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T22:29:23.170

一种廉价的方法可能是将事件处理程序绑定到可点击项目和/或其目标的“（on）blur”事件。如果您的设计允许。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T23:03:04.740

```
$('#target').bind('click', function(event)
{
    var $element = $('#element');
    $element.show();

    $(document).one('click', function()
    {
       $element.hide();
    });

    // If you don't stop the event, it will bubble up to the document
    // and trigger the click event we just bound. 
    // This will hide the element right now just after showing it, 
    // we don't want that.
    event.stopPropagation();
} 
```

您必须记住，Javascript 事件在开始触发时会在整个树中上下移动。因此，当您想要侦听许多元素上的事件时，您可以将事件侦听器绑定到任何父级。

这称为事件委托。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T22:25:13.443

这是一种方法。

您还可以编写一个方法来捕获（挂钩）所有“单击”事件，而不管元素如何，并从那里隐藏您的菜单。

JQuery 将使您更轻松地完成这项任务。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T22:41:49.477

第 1 步 - 使用 javascript 库，这样您就可以让代码尽可能跨浏览器 - 否则您必须迎合 Internet Explorer 和基于 Gecko/webkit 的浏览器之间的两种不同事件模型。JQuery、Mootools、YUI——所有这些都会为你处理——还有更多，但那 3 个是我最喜欢的，并且有据可查。

第 2 步 - 您可能希望为此实现一个 clickshield - 本质上是一个块级 dom 元素，它绝对定位在整个页面上，具有比页面其余部分更高的 z-index。附加一个点击事件，你可以执行你的逻辑来隐藏页面上的元素。clickshield 可以很容易地让 javascript 代码使用上述任何 javascript 库的方法将其扩展为页面后 DOM 渲染的宽度 - 高度。

# java - Hibernate 使用 MySQL 生成无效的 SQL 查询

> ID：444932
> 
> 赞同：11
> 
> 时间：2009-01-14T22:23:10.873
> 
> 标签：java, hibernate, orm, jpa

我有以下 JPA 实体类（示例）。一所房子属于一条街道。一条街有许多房子。

```
@Entity
public class House {
    @Id
    @GeneratedValue(strategy=GenerationType.IDENTITY)
    public Integer id;

    public String name    

    @ManyToOne
    public Street street;
}

@Entity
public class Street {
    @Id
    @GeneratedValue(strategy=GenerationType.IDENTITY)
    public Integer id;

    @OneToMany(mappedBy="street")
    public Set<House> houses;
} 
```

我将生成类型设置为身份，它应该自动分配一个新的 ID。

当用新街道创建新房子时，我必须首先创建并坚持街道，然后是房子。这是因为我没有将 CascadeType 设置为 PERSIST，因此必须手动完成 [1]。但是，在插入新创建的街道时：

```
Street street = new Street();
entityManager.persist(street); 
```

Hibernate/JPA 生成以下 SQL 查询：

```
insert into Street default values 
```

MySQL 不喜欢的。

```
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'default values' at line 1 
```

任何想法为什么？我正在使用 Java 6、MySQL 5.0.67 和 Hibernate 的 JPA 实现（版本 3.2.1.ga）。

[1] EJB 3 in Action 第 318-319 页

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-07T02:04:52.257

如果您的 SQL 语句中没有错误，那么您可能需要检查您的表列名称，因为它可以包含 Mysql 使用的预定义名称；例如 'column' 不能用作表列名

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-14T22:47:01.887

标准 SQL 为 指定此可选语法`INSERT`：

```
INSERT INTO <Table Name> DEFAULT VALUES 
```

这是合法的 SQL 语法，例如，[Microsoft SQL Server](http://msdn.microsoft.com/en-us/library/ms174335(SQL.90).aspx)、[PostgreSQL](http://www.postgresql.org/docs/current/static/dml-insert.html)和[SQLite](http://www.sqlite.org/lang_insert.html)支持，但 Oracle、IBM DB2 或 MySQL 不支持。

MySQL 支持实现相同结果的其他语法：

```
INSERT INTO <Table Name> () VALUES ()

INSERT INTO <Table Name> (col1, col2, col3) VALUES (DEFAULT, DEFAULT, DEFAULT) 
```

在 Hibernate 中，您应该正确[配置](http://www.hibernate.org/hib_docs/reference/en/html/session-configuration.html)SQL 方言，并由 Hibernate 为目标 RDBMS 品牌生成有效的 SQL。

```
import org.hibernate.cfg.Configuration;

Configuration cfg = new Configuration();
cfg.setProperty("hibernate.dialect", "org.hibernate.dialect.MySQLInnoDBDialect"); 
```

`hibernate.properties`您还可以通过在类路径的根目录中放置一个名为的文件来指定属性。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-10T10:11:07.283

可能出现此异常的另一种情况是您将保留字作为表的列。例如 'to' 和 'from' 不适合 MySQL 的 clumn 名称。这显然是 Hibernate 中的错误，它不检查这些列，而且即使没有创建表，它也继续工作而没有错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-09T19:08:44.080

确保 spring.jpa.database-platform=org.hibernate.dialect.MySQL5Dialect 有正确的 MySQL 版本

# html - 在设计师和工程师之间平衡 HTML/CSS

> ID：444948
> 
> 赞同：15
> 
> 时间：2009-01-14T22:29:05.370
> 
> 标签：html, css, process

我有一个开发过程问题。

**背景：**我在一个规模适中的网站工作，从历史上看，设计师创建了他们想要的页面和组件外观的模型/屏幕截图，并且工程团队（包括我自己）将它们变成了 html/css。

从代码清洁度的角度来看，这工作得相对较好，并且在编写 javascript 时有很大帮助。然而，它在帮助保持一个页面/组件到另一个页面/组件的一致性方面失败了。在一个页面上，标题字体可能是 12 像素，而另一种是 11 像素，主要是因为它是一个复杂的网站，需要跟踪很多内容（我们已经循环访问了 4 位设计师。）我们只有几个真正通用的样式，而且它们只有当工程师识别风格时使用 - 而不是当设计师告诉他们时。

我们最近的设计师是一个比较有能力的 HTML/CSS 编码器。我们认为我们可以让他在 HTML/CSS 中创建模型并将代码交给我们以便快速集成。我们希望设计师能够更好地保持他的风格一致，并且可以为我们节省一些前期开发时间。

我们发现，我们的设计器不如我们希望的 CSS 好，而且他的代码经常有点臃肿并且与我们需要做的不兼容。此外，他的编码风格与工程团队的其他成员根本不同，并且与我们既定的编码实践不太相符。

**问题：**您如何完成从设计到工程的交接？我知道我听说过让他们的设计团队完成所有模板编码的公司，但我很好奇它是如何工作的。设计团队是否真的在这些场景中纳入了工程团队的成员？

由于我们现在的结构，即使他是一个精通 HTML 专家，我们也不可能让我们的设计师编写最终模板并将它们签入 SVN。模板中有太多需要了解我们的代码库和潜在性能问题的知识。

我们如何让这个过程发挥作用？这是白日梦吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-14T22:47:28.640

具体来说 - 就个人而言 - 因为我来自网络开发和小商店背景，所以我自己做 CSS 工作并切片 PSD（通常）。但后来我喜欢认为我是那样的全面:)

一般来说，我在这方面的最佳体验是一家大型公司，拥有非常明确的开发人员群体，包括制作 gfx 的设计团队、进行大量服务器端编码和应用程​​序架构的应用程序团队，以及 UE （用户体验）团队将两者缝合在一起，通常生成 XSLT/JSP/HTML 标记，以及用于客户端的 CSS 和 JS。

有一个非常结构化的过程：

1.  用户故事->
2.  “线框”（文档）->
3.  设计（PSD）->
4.  “平面”标记（仅限 DHTML）->
5.  集成标记（带有网络应用程序）

其中“线框”将接近 UE 的规范，使用 UML 或 visio 生成。我听说过适用于第 4 步的术语，我认为它更适合，但这就是那里所说的。

虽然这对手头的问题很有效，但我发现它还存在其他问题。跨团队工作非常困难，而且由于时间尺度，设计团队很少让 UE 参与决策（这使 UE 处于一些尴尬的位置)，应用程序团队和设计可能会在不同的目的上工作，并且在这些封闭的团队中没有太多的学习空间。

我的怀疑（我认为理想的情况）是项目的开发人员每个人都能够使用所涉及的技术（例如 CSS、SQL 等）的 80% 来分散决策控制和风险，但是每个域都会有一个（更多？）“沙皇”，他可以在域内充当权威和监督者。实际上，在我看来，制作这些设计本身就是一种奇怪而神奇的技能，所以我认为那里的开发人员没有真正的重叠，但我认为一群艺术家和跨技能程序员的项目团队将非常强大。

*Apols 的长篇大论。我可以继续讨论这个问题，我已经花了很多时间思考它。*

* * *

顺便说一句，看起来你可以在那里与一些严肃的网络开发人员一起做，（没有冒犯）。“保持从一个页面/组件到另一个页面/组件的一致性”的问题导致无法理解 CSS

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-15T00:05:09.700

根据我的经验，除非您严格限制您的设计，否则您需要真正的编码技能来构建具有交互性的网页。让我详细说明一些。如果你已经构建了非常模块化的页面（想想 GUI 工具包小部件），你可以给你的设计师一些，他可以构建基本结构，就像玩玩具积木一样，涂上漂亮的油漆。

通常，仅模块化不足以实现所需的交互性。因此，一些块也需要仔细设计它们的交互（如动画、流畅的布局以适应不确定的内容、通过额外的 javascript 定制行为、缓存以消除冗余请求并加速事情）或适应微小的表示变化的能力，这会带来我们进入编程领域，您可以在其中计算尺寸、启用/禁用部件、跟踪时间、预加载内容、使预加载内容无效等等。

输入 HTML/CSS/JS。它们更像是进化的产物，而不是智能设计。你不能总是宣布你的意图并完成它。你需要在你的 html 中声明的属性，在 CSS 中加上额外的标记的愚蠢的 hack，大量的 js 来平滑粗糙的边缘，在服务器端重复渲染代码。这些工具从来都不是用来构建应用程序的。

我不认为在手头的这些工具中可以实现设计和应用程序开发的完全分离。所需的努力太高，不足以证明边际回报是合理的。如果您最终大量修改了设计人员的*代码*（如果他不是开发人员之一，情况也会如此），那么让他忍受尝试使用错误的工具来表达他的意图，或者开发人员在修改时破坏设计是没有意义的它并因此修复它。我什至不提用户体验。

在我看来，任何想要在合理时间内交付产品的小型互联网企业都不应该将稀缺的资源投入到逆势而上。如有必要，让人们*在协作中*做他们最擅长的事情。如果你不能在任意令人满意的点上划分设计过程，你还不如根本不费心去分开。流水线适用于目标确定到最后一个细节并且不改变的机器。对于人类构建和设计软件或硬件，我不能说同样的话。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T22:32:42.803

我工作的地方基本一样。设计师创建 UI 设计的模型和规范，直至像素，开发人员从中创建 HTML/CSS/代码。

我之所以说代码，是因为我们使用了 UI 框架（即 GWT），而且尽管我们想要，代码和 CSS 样式仍然非常耦合。我不相信存在一个 UI 框架可以将代码与 UI 设计完全分离。

所以我想现在它仍然完全是开发人员的工作。虽然我想听听能够将一些工作交给设计师的组织。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T00:11:30.263

交接的问题在于，一组的想法和实施与下一组的能力和实施不匹配。就其本质而言，交接会带来问题。那么什么是无处不在的切换场景的替代方案呢？我认为将用户体验 (UX) 集成到敏捷和迭代的开发过程中可以确保真正重要的事情发生：

1.  研究并验证客户的需求。
2.  可用性专家、设计师和程序员之间的早期和持续合作。

实际流程的运作方式是让每个人都提前与客户就他们的需求进行协作。然后在编码开始之前的迭代中对设计进行研究和原型设计。因此，当编码发生时，下一组设计正在开发中。程序员应该向前看设计师正在做的事情，而设计师应该回头看看，以确保程序员在目标上。一旦设计被编码，它就会被客户接受，那时程序员正在开发下一组接口。

Jeff Patton 最近做了一个[关于敏捷 UX 的播客，介绍](http://www.uie.com/events/uiconf/2008/seminars/patton/)了一些实现概念和常见问题。

雅虎上有一个专门研究[敏捷可用性](http://tech.groups.yahoo.com/group/agile-usability/)的小组（主要涉及界面设计）。

对于 CSS 不一致...我只是建议制作一个样式指南，然后尝试坚持下去。让某人负责“设计一致性”，这样可以打击任何发明另一种显示用户的方式的人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-15T09:00:13.287

在我的公司，我理想的工作流程并不经常奏效，但有时会奏效。我喜欢这种情况：工程师只用最少的 CSS 编写 webapp 并输出语义 html。然后你让设计师做 CSS。

我喜欢这种方式，因为：

*   编写语义 HTML 对我来说很容易。
*   我不太擅长为我的语义 html 设计一个好的设计。
*   完全有可能在不问我问题的情况下完成 CSS。标记不言自明。

但是，这很少奏效。因为：

*   每当 HTML 更改并且设计人员的时间很少时，都必须修改 CSS。
*   此外，我们的设计师不喜欢为我的标记设计样式，而且为他们的时间而战并不愉快。
*   我们的设计师经常想要更改标记。主要是因为他们认为如果不更改标记就无法完成某些布局，或者因为他们认为这是使 IE 服从的唯一方法。不过，他们在技术上无法更改标记。

我对他们的许多案件表示怀疑。很多时候他们声称 IE 不兼容，我强烈怀疑他们是否真的了解 IE。有一些简洁的 CSS hack 可以让 IE 服从，而无需求助于

```
<br clear="all"> 
```

所以，可悲的是，通常这个理想对我来说有点偏离。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-28T05:24:57.797

单独的设计师 - 开发人员工作流程是最好的方法。设计网站和编码是完全不同的工作。除了要处理的编码标准之外，还有跨浏览器兼容性、CSS、XHTML 等问题。

您还可以选择将您的 HTML 外包给像我们这样的专业[PSD 到 HTML 转换](http://www.butterflyhtml.com/psd-to-html-wordpress-joomla-order.html)专家 (ButterflyHTML)。从长远来看，它可能具有成本效益

# zsh - zsh：在目录分隔符上停止向后杀死字

> ID：444951
> 
> 赞同：62
> 
> 时间：2009-01-14T22:30:13.683
> 
> 标签：zsh

在[zsh](http://www.zsh.org/)中，如何设置行编辑器`backward-kill-word`以在目录分隔符处停止？目前在我的 bash 设置中，如果我输入

```
cd ~/devel/sandbox 
```

然后命中`C-w`点就在之后`devel/`。在我的 zsh 设置中，点将在`cd` . 我想设置 zsh，使其行为类似于 bash。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-09-17T12:20:39.663

对于最新版本的 zsh，您可以简单地添加：

```
autoload -U select-word-style
select-word-style bash 
```

到您的 zshrc，如[zsh 手册](http://zsh.sourceforge.net/Doc/Release/User-Contributions.html#Widgets)（也`man zshcontrib`）中所述。

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2012-06-26T05:01:55.743

另一种选择是将`WORDCHARS`（非字母数字字符视为单词的一部分）设置为不包含`/`.

如果您希望`^w`在点、下划线等处打断，也可以对此进行调整。在`~/.zshrc`我有：

```
WORDCHARS='*?_-.[]~=&;!#$%^(){}<>' 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2009-01-14T22:36:12.187

一个快速的谷歌揭示：

[向后杀](http://www.zsh.org/mla/users/2001/msg00870.html)

或者，也许是更好的解决方法：

[Bash 风格的反向杀戮](http://www.zsh.org/mla/users/2001/msg00868.html)

# windows - 是否可以通过 USB 直接通信？

> ID：444964
> 
> 赞同：0
> 
> 时间：2009-01-14T22:35:20.100
> 
> 标签：windows, api, usb

是否可以在同一台计算机上让两个应用程序直接通过 USB 相互通信（无电缆，无关联设备）？容易/难吗？你们会推荐什么API？

是的，我发布了一个类似的帖子，但它专门要求我找到一个 JAVA/USB 实现，但我需要 Windows 支持。所以现在我正在寻找任何 USB API - 它不必在 java 中工作。我总是可以只使用 JNI/JNative 来使用本机代码/库。

我在互联网上没有发现很多人做过同样的事情。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-15T00:00:17.633

USB“总线”是电线。USB 不适用于进程间甚至点对点通信。它仅用于主机和外围设备之间通过主机发起任何/所有流量的电缆进行通信。您不能（通常）将 2 个主机连接在一起，也不能将两个设备连接在一起，或者在主机/设备之间进行任何类型的对称通信。

如果您只想在同一台机器上的两个进程之间进行进程间通信，那么 USB 不是可行的方法。这是完全没有意义的。如果要在两台不同机器上的两个进程之间进行进程间通信，则应使用 TCP/IP。

如果您要开发 USB 设备并想在任何原型硬件准备好之前开发主机和设备软件，而您真正想要的是一些开发或模拟环境，您可以在同一台机器上完成这些，将它们连接起来，并对其进行测试，那是完全不同的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-14T22:57:49.790

如果您只是希望允许两个进程进行通信，则可以使用 Unix 或域套接字。我想不出在本地通过 USB 进行进程间通信会成为优势的情况。Java 对此有很好的支持。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T23:26:26.703

没有电缆和/或没有设备

因此，您当时所问的问题是不可能的（甚至没有任何意义），这就像问两个应用程序如何在没有连接的情况下通过串行端口进行通信..

也许您可以尝试找出实际的最终目标是什么，如果它只是进程间通信，那么有很多不同的方法可以给猫换皮……（com、wcf、内存映射文件等）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-14T23:59:26.403

通过 USB 进行的通信必然涉及电气连接和上拉电阻器以及在特定时间出现在特定线路上的特定电压。如果没有实际的电缆，这些都很难模拟。

[Jan Axelson 的 USB Central](http://janaxelson.com/usb.htm)是开始了解 USB 通信的好地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-15T17:45:35.847

我想通过**大量**内核工作，您可能会得到类似的工作。现有[产品](http://www.usb-over-network.com/)可以转usb其他网络。所以我猜它模拟了usb主机控制器或类似的东西。如果您可以模拟主机控制器，则可以模拟连接到该控制器的实际设备。并让用户态应用程序来控制这个设备。
但我估计它对于经验丰富的内核程序员来说是一个至少 6 MM 的项目，并且对 USB 协议有深入的了解。
主要问题是为什么？我找不到这个用例的任何逻辑原因（并不意味着它不存在）。

# php - 如何在 PHP 中处理 IPv6 地址？

> ID：444966
> 
> 赞同：32
> 
> 时间：2009-01-14T22:35:45.217
> 
> 标签：php, ip, ipv6

在彻底搜索之后，我注意到 PHP 中稍微缺乏处理[IPv6](http://en.wikipedia.org/wiki/IPv6)的函数。为了我个人的满意，我创建了一些函数来帮助过渡。

该`IPv6ToLong()`功能是对此处提出的问题的临时解决方案：[如何在关系数据库中存储 IPv6 兼容地址](https://stackoverflow.com/questions/420680/)。它将 IP 拆分为两个整数并将它们返回到一个数组中。

```
/**
 * Convert an IPv4 address to IPv6
 *
 * @param string IP Address in dot notation (192.168.1.100)
 * @return string IPv6 formatted address or false if invalid input
 */
function IPv4To6($Ip) {
    static $Mask = '::ffff:'; // This tells IPv6 it has an IPv4 address
    $IPv6 = (strpos($Ip, '::') === 0);
    $IPv4 = (strpos($Ip, '.') > 0);

    if (!$IPv4 && !$IPv6) return false;
    if ($IPv6 && $IPv4) $Ip = substr($Ip, strrpos($Ip, ':')+1); // Strip IPv4 Compatibility notation
    elseif (!$IPv4) return $Ip; // Seems to be IPv6 already?
    $Ip = array_pad(explode('.', $Ip), 4, 0);
    if (count($Ip) > 4) return false;
    for ($i = 0; $i < 4; $i++) if ($Ip[$i] > 255) return false;

    $Part7 = base_convert(($Ip[0] * 256) + $Ip[1], 10, 16);
    $Part8 = base_convert(($Ip[2] * 256) + $Ip[3], 10, 16);
    return $Mask.$Part7.':'.$Part8;
}

/**
 * Replace '::' with appropriate number of ':0'
 */
function ExpandIPv6Notation($Ip) {
    if (strpos($Ip, '::') !== false)
        $Ip = str_replace('::', str_repeat(':0', 8 - substr_count($Ip, ':')).':', $Ip);
    if (strpos($Ip, ':') === 0) $Ip = '0'.$Ip;
    return $Ip;
}

/**
 * Convert IPv6 address to an integer
 *
 * Optionally split in to two parts.
 *
 * @see https://stackoverflow.com/questions/420680/
 */
function IPv6ToLong($Ip, $DatabaseParts= 2) {
    $Ip = ExpandIPv6Notation($Ip);
    $Parts = explode(':', $Ip);
    $Ip = array('', '');
    for ($i = 0; $i < 4; $i++) $Ip[0] .= str_pad(base_convert($Parts[$i], 16, 2), 16, 0, STR_PAD_LEFT);
    for ($i = 4; $i < 8; $i++) $Ip[1] .= str_pad(base_convert($Parts[$i], 16, 2), 16, 0, STR_PAD_LEFT);

    if ($DatabaseParts == 2)
            return array(base_convert($Ip[0], 2, 10), base_convert($Ip[1], 2, 10));
    else    return base_convert($Ip[0], 2, 10) + base_convert($Ip[1], 2, 10);
} 
```

对于这些函数，我通常通过首先调用此函数来实现它们：

```
/**
 * Attempt to find the client's IP Address
 *
 * @param bool Should the IP be converted using ip2long?
 * @return string|long The IP Address
 */
function GetRealRemoteIp($ForDatabase= false, $DatabaseParts= 2) {
    $Ip = '0.0.0.0';
    // [snip: deleted some dangerous code not relevant to question. @webb]
    if (isset($_SERVER['REMOTE_ADDR']) && $_SERVER['REMOTE_ADDR'] != '')
        $Ip = $_SERVER['REMOTE_ADDR'];
    if (($CommaPos = strpos($Ip, ',')) > 0)
        $Ip = substr($Ip, 0, ($CommaPos - 1));

    $Ip = IPv4To6($Ip);
    return ($ForDatabase ? IPv6ToLong($Ip, $DatabaseParts) : $Ip);
} 
```

如果我在这里重新发明轮子或者我做错了什么，请告诉我。

此实现将 IPv4 转换为 IPv6。它不涉及的任何 IPv6 地址。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-18T18:46:55.883

怎么样[`inet_ntop()`](http://php.net/inet_ntop)？然后，您不必将事物切成整数，而只需使用 a`varbinary(16)`来存储它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T18:38:28.613

PHP.net 的[过滤器扩展](http://www.php.net/manual/en/filter.php)包含[一些用于匹配 IPv4 和 IPv6 地址的常量](http://www.php.net/manual/en/filter.constants.php)，这对于检查地址可能很有用。不过，我还没有看到任何转换实用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-23T14:23:01.870

您还可以将地址存储在 mysql 中的二进制 (16) 中，因此您应该可以选择从 IPv6ToLong() 以二进制形式输出它。

这确实是需要在 PHP 中本地添加的东西，尤其是当许多启用 IPv6 的 Web 服务器报告 ::FFFF:1.2.3.4 作为客户端 IP 并且它与 ip2long 不兼容时，会破坏很多东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-25T09:09:21.653

这是使用 filter_var (PHP >= 5.2) 的替代函数

```
function IPv4To6($ip) {
 if (filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV6) === true) {
  if (strpos($ip, '.') > 0) {
   $ip = substr($ip, strrpos($ip, ':')+1);
  } else { //native ipv6
   return $ip;
  }
 }
 $is_v4 = filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4);
 if (!$is_v4) { return false; }
 $iparr = array_pad(explode('.', $ip), 4, 0);
    $Part7 = base_convert(($iparr[0] * 256) + $iparr[1], 10, 16);
    $Part8 = base_convert(($iparr[2] * 256) + $iparr[3], 10, 16);
    return '::ffff:'.$Part7.':'.$Part8;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-08T18:22:39.267

回过头来，我写了两个函数，`dtr_pton`它们`dtr_ntop`都适用于 IPv4 和 IPv6。它将在可打印和二进制之间来回转换它们。

第一个函数`dtr_pton`将检查提供的参数是有效的 IPv4 还是有效的 IPv6。根据结果​​，可能会引发异常，或者可能会返回 IP 的二进制表示。通过使用此函数，您可以对结果执行 AND'ing 或 OR'ing（用于子网划分/whathaveyou）。我建议您将这些作为`VARBINARY(39)`or存储在您的数据库中`VARCHAR(39)`。

```
/**
* dtr_pton
*
* Converts a printable IP into an unpacked binary string
*
* @author Mike Mackintosh - mike@bakeryphp.com
* @param string $ip
* @return string $bin
*/
function dtr_pton( $ip ){

    if(filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4)){
        return current( unpack( "A4", inet_pton( $ip ) ) );
    }
    elseif(filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV6)){
        return current( unpack( "A16", inet_pton( $ip ) ) );
    }

    throw new \Exception("Please supply a valid IPv4 or IPv6 address");

    return false;
} 
```

第二个函数`dtr_ntop`会将 IP 的二进制表示转换回可打印的 IP 地址。

```
/**
* dtr_ntop
*
* Converts an unpacked binary string into a printable IP
*
* @author Mike Mackintosh - mike@bakeryphp.com
* @param string $str
* @return string $ip
*/
function dtr_ntop( $str ){
    if( strlen( $str ) == 16 OR strlen( $str ) == 4 ){
        return inet_ntop( pack( "A".strlen( $str ) , $str ) );
    }

    throw new \Exception( "Please provide a 4 or 16 byte string" );

    return false;
} 
```

此外，这是扩展[StackOverflow 上的 IPv6 地址的快速方法](https://stackoverflow.com/q/12095835/1431239)

```
function expand($ip){
    $hex = unpack("H*hex", inet_pton($ip));         
    $ip = substr(preg_replace("/([A-f0-9]{4})/", "$1:", $hex['hex']), 0, -1);

    return $ip;
} 
```

此外，可以在我的博客[HighOnPHP 上找到有关该主题的好读物：在 PHP 中使用 IPv6 的 5 个技巧](http://www.highonphp.com/5-tips-for-working-with-ipv6-in-php#comment-12521)。本文在一个面向对象的类中使用了上述一些方法，该类可以在[GitHub 上找到：mikemackintosh\dTR-IP](https://github.com/mikemackintosh/dTR-IP/)

# datetime - 解析模棱两可的日期（与语言无关）

> ID：444972
> 
> 赞同：2
> 
> 时间：2009-01-14T22:37:49.190
> 
> 标签：datetime, parsing, date, text-parsing

我很好奇在任何给定语言中处理模棱两可的日期字符串的最佳方法是什么。如果无法预先验证您的用户输入，应该如何解析 MM/dd/YYYY 日期？

您将如何解析以下模棱两可的日期以及出于什么原因（统计、文化等）？

**'1111900'**是 1900 年 1 月 11 日 [ **M/dd/YYYY** ] 还是 1900 年 11 月 1 日 [ **MM/d/YYYY** ]？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-14T22:45:41.437

除非您确切知道该格式来自什么语言/文化，否则您需要建立一个通用的日期格式。

我会推荐一种称为区域设置中性日期格式的东西。(YYYY-MM-DD)

它要么使用它，要么清楚地知道年、月和日是什么部分。（DD MON YYYY 或 2003 年 4 月 22 日）

请参阅：[w3](http://www.w3.org/International/questions/qa-date-format)对日期格式的看法。

编辑：输入错误的区域中性日期格式

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-14T22:53:20.640

根据软件的重要性，我会将任何不明确的日期输入视为无效输入。您应该确保（在源头上）您获得的日期输入采用合理、明确的格式。如果您仍然设法得到“1111900”之类的内容，那么输入不正确，显然有人以某种方式绕过了有效性检查代码，您可以做的最正确的事情可能是丢弃数据。

当然，如果这不是一个选项并且获得日期位置并不重要，您总是可以猜测 - 但这*将*是一个猜测。如果可能的话，我肯定会避免这种情况。一般来说，接受未经处理的输入并不是最好的主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-14T23:02:32.290

在这样的系统中，了解 1 月 11 日和 11 月 1 日之间差异的唯一方法是通过上下文。否则，您需要进行某种消歧。这种特定的日期格式将是病态破坏性压缩的完美示例。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-14T23:44:55.480

当重要的日期是使用报价下拉菜单或日历时，我的偏好是它总是以预期的格式出现。

# sql - SQL/T-SQL - 如何从 N 列中的 1 列中获取 MAX 值？

> ID：444976
> 
> 赞同：3
> 
> 时间：2009-01-14T22:39:27.033
> 
> 标签：sql, tsql

在 SQL/Transact SQL 中，我试图更新一个临时表以从 3 个不同的日期列（在该临时表中）获取最新日期，并将该 MAX 日期放入“最新日期”列。

使用更新语句的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-14T22:47:31.027

只有三个并不难......这绝对不能扩展到任意数量的日期时间列！

```
 Select Case When DT1 > DT2 And DT1 > DT3 Then DT1
             When DT2 > Dt3 Then Dt2 Else DT3 End
 From TableName 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-14T22:44:13.200

我认为您需要从

记录 ID、列 1、列 2、列 3

到

记录 ID、列 ID、值

然后您将能够轻松找到三列中的最大值...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-14T22:56:08.560

也许是工会？

```
select max(myDate)
from (
    select field_1 myDate from myTable where ...
    union all
    select field_2 myDate from myTable where ...
    union all
    select field_3 myDate from myTable where ...
) d 
```

当然，对于同一行，这会在表中命中 3 次。CTE 可能会解决这个问题：

```
with myRow as (
    select field_1, field_2, field_3 from myTable where ...
)
select max(myDate)
from (
    select field_1 myDate from myRow
    union all
    select field_2 myDate from myRow
    union all
    select field_3 myDate from myRow
) d 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-14T22:51:43.140

```
SELECT 
(CASE WHEN field_1 > field_2 THEN 
    CASE WHEN field_1 > field_3 THEN field_1 ELSE field_3 END
ELSE
    CASE WHEN field_2 > field_3 THEN field_2 ELSE field_3 END
END) AS maximum_date
FROM table 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-14T22:47:14.910

您可以使用 3 个“如果”语句，从第一个日期开始。然后在第三个“如果”语句之后，您将知道哪个是最高（最大）日期......

然后将其存储在一个变量中并从那里开始工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T22:55:29.497

Oracle 有 GREATEST 语句，你可以用函数或案例语句来模拟它

看到这个问题：

[SQL Server 中是否有一个 Max 函数，它接受两个值，例如 .NET 中的 Math.Max？](https://stackoverflow.com/questions/124417/is-there-a-max-function-in-sql-server-that-takes-two-values-like-mathmax-in-net)

# sql - 同步 SQL Server 2005 登录密码

> ID：444988
> 
> 赞同：3
> 
> 时间：2009-01-14T22:43:40.753
> 
> 标签：sql, sql-server, sql-server-2005

背景：
我们正在运行一个 Web 应用程序，其中每个用户都可以登录系统。应用程序登录映射到实际的 SQL Server 2005 登录（我们需要创建）。我们的开发和灾难恢复站点只是此设置的副本。每晚都会备份生产数据库，归档转储，然后我们使用此文件恢复 dev 和 DR。完成后，我们需要为每个用户运行 sp_change_users_login 以将数据库用户重新映射到 SQL 登录。

问题：
当用户在生产环境中更改密码时，SQL 登录密码也会更改。这不会同步到 dev/DR，因此如果他们尝试登录其中一个站点，他们就不能，并且需要重置他们的密码。有没有一种[好的]方法可以让这些 SQL 登录在多个安装之间保持同步？

该产品的下一个版本消除了 SQL 登录需求，但升级不是当前的优先事项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-15T10:37:20.687

使用散列密码编写登录脚本，然后在删除数据库之后和恢复数据库备份之前在目标服务器上删除并重新创建它们。这就是我们使用脚本软件编写 SQL2005 登录脚本的方式。您可能想尝试该软件 - www.dbghost.com - 或构建您自己的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-23T20:43:57.813

解决方案：

这是对 markbaekdal 的回答的跟进。我是这样做的：

我对生产数据库运行以下命令：

```
SELECT  'ALTER LOGIN ' + CAST(name AS VARCHAR) + ' WITH PASSWORD = ', password_hash, ' HASHED;'
FROM    sys.sql_logins 
JOIN    mydatabase..mytable
ON      mycolumn = name
GO 
```

并通过“findstr ALTER”（啊，windows）将其传送到名为loginUpdates.sql 的文件。然后我针对开发和灾难恢复数据库运行该文件。它就像一个魅力。

如果您想获得真正的铁杆，这是我的一位同事发现的支持文章：http: [//support.microsoft.com/kb/918992](http://support.microsoft.com/kb/918992)。``***********``**