# StackOverflow 问答 12206000-12206999

# java - 奇怪的崩溃。很少的代码，了解堆栈跟踪

> ID：12206001
> 
> 赞同：1
> 
> 时间：2012-08-30T21:45:17.480
> 
> 标签：java, android, stack-trace

打开几乎没有代码的应用程序时发生崩溃。

代码是：

```
package com.spotsofmagic.spotsofmagic;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;
import android.content.Intent;
import android.nfc.NdefMessage;
import android.nfc.NdefRecord;
import android.nfc.NfcAdapter;
import android.os.Bundle;
import android.os.Parcelable;
import android.util.Log;
import android.bluetooth.*;

public class CardActivity extends Activity implements OnClickListener {

    private static final String TAG = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.card_activity);

    public void onClick(DialogInterface dialog, int which) {
        // TODO Auto-generated method stub

    }
} 
```

应用程序立即崩溃。堆栈跟踪如下，这对我来说意义不大：

```
08-30 22:37:31.698: W/dalvikvm(8852): threadid=1: thread exiting with uncaught exception (group=0x40ceb300)
08-30 22:37:31.718: E/AndroidRuntime(8852): FATAL EXCEPTION: main
08-30 22:37:31.718: E/AndroidRuntime(8852): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.spotsofmagic.spotsofmagic/com.spotsofmagic.spotsofmagic.CardActivity}: android.view.InflateException: Binary XML file line #2: Error inflating class <unknown>
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.os.Handler.dispatchMessage(Handler.java:99)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.os.Looper.loop(Looper.java:137)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.app.ActivityThread.main(ActivityThread.java:4745)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at java.lang.reflect.Method.invokeNative(Native Method)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at java.lang.reflect.Method.invoke(Method.java:511)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at dalvik.system.NativeStart.main(Native Method)
08-30 22:37:31.718: E/AndroidRuntime(8852): Caused by: android.view.InflateException: Binary XML file line #2: Error inflating class <unknown>
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.view.LayoutInflater.createView(LayoutInflater.java:613)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.view.LayoutInflater.onCreateView(LayoutInflater.java:660)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:685)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.view.LayoutInflater.inflate(LayoutInflater.java:466)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:256)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.app.Activity.setContentView(Activity.java:1867)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at com.spotsofmagic.spotsofmagic.CardActivity.onCreate(CardActivity.java:23)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.app.Activity.performCreate(Activity.java:5008)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
08-30 22:37:31.718: E/AndroidRuntime(8852):     ... 11 more
08-30 22:37:31.718: E/AndroidRuntime(8852): Caused by: java.lang.reflect.InvocationTargetException
08-30 22:37:31.718: E/AndroidRuntime(8852):     at java.lang.reflect.Constructor.constructNative(Native Method)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.view.LayoutInflater.createView(LayoutInflater.java:587)
08-30 22:37:31.718: E/AndroidRuntime(8852):     ... 23 more
08-30 22:37:31.718: E/AndroidRuntime(8852): Caused by: android.content.res.Resources$NotFoundException: File Spots of Magic from drawable resource ID #0x7f040000
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.content.res.Resources.loadDrawable(Resources.java:1935)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.content.res.TypedArray.getDrawable(TypedArray.java:601)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.view.View.<init>(View.java:3336)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.view.ViewGroup.<init>(ViewGroup.java:427)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.widget.FrameLayout.<init>(FrameLayout.java:101)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.widget.FrameLayout.<init>(FrameLayout.java:97)
08-30 22:37:31.718: E/AndroidRuntime(8852):     ... 26 more
08-30 22:37:31.718: E/AndroidRuntime(8852): Caused by: java.io.FileNotFoundException: Spots of Magic
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.content.res.AssetManager.openNonAssetNative(Native Method)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.content.res.AssetManager.openNonAsset(AssetManager.java:407)
08-30 22:37:31.718: E/AndroidRuntime(8852):     at android.content.res.Resources.loadDrawable(Resources.java:1927)
08-30 22:37:31.718: E/AndroidRuntime(8852):     ... 31 more 
```

Card_Activity.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="@string/app_name"
    android:gravity="center"
    android:orientation="vertical"
    android:padding="25dp" >

    <ImageView 
            android:id="@+id/card_view"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:scaleType="fitCenter"
    />
</FrameLayout> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T21:51:14.443

`android:background="@string/app_name"`这就是问题。

背景应该是这样的颜色或可绘制的。

```
android:background="@drawable/name of drawable" 
```

或者

```
 android:background="@color/name of color" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-30T21:51:06.623

您正在将字符串设置为背景。

```
android:background="@string/app_name" 
```

你应该设置一个drawable。

```
android:background="@drawable/my_icon" 
```

并将您的图像放入`res/drawable-...`文件夹中

# php - 自动完成：格式化结果

> ID：12206002
> 
> 赞同：1
> 
> 时间：2012-08-30T21:45:17.780
> 
> 标签：php, jquery, codeigniter, jquery-autocomplete

让我尝试用我尝试过的代码片段再次询问这个问题

我正在尝试格式化 Jquery 自动完成以包含每个数据源的标题并突出显示该术语。我正在使用 Codeigniter，并认为最简单的方法是在将其发回之前对其进行格式化：

**JS：**

```
$( ".auto-search" ).autocomplete({
        source: '/json/autocomplete_search',
        minLength: 2,

    }); 
```

**PHP（代码点火器）**

```
public function autocomplete_search()
{
    $term = $this->input->get('term');

    //load model and get results
    $this->load->model("mymodel");
    $results1= $this->mymodel->search_one($term);
    $results2= $this->mymodel->search_two($term);

    //Start JSON string
    $json='[';

    //first source
    if ($result1->num_rows() > 0)
    {
        $json .= '{"value":"<h3>Heading One<h3>"}';
        foreach ($results1->result_array() as $r1)
        {
            $result = str_replace($term,"<strong>".$term."</strong>",$r1['title']);
            $json .= ',{"value":"'.$result.'"}';
        }
    }

    //second source
    if ($result2->num_rows() > 0)
    {
        if ($result1->num_rows() > 0){$json .=  ',';}
        $json .= '{"value":"<h3>Heading Two<h3>"}';

        foreach ($results2->result_array() as $r2)
        {
            $result = str_replace($term,"<strong>".$term."</strong>",$r2['location']);
            $json .= ',{"value":"'.$result.'"}';
        }
    }

    //Close JSON string
    $json .= ']';
    echo  $json;
}` 
```

不幸的是，我没有得到格式化的输出，相反，它实际上在输出中添加了 <h1> 和 <strong> 这两个词。这是示例输出：

![在此处输入图像描述](../Images/6d5db3c7fac77890f5f038f3d9687c47.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T23:24:24.223

好的，所以我找到了一种方法。这是我的做法：

**Javascript：**

```
 $( ".auto-search" ).autocomplete({
        source: '/hotpepper/json/autocomplete_search2',
        minLength: 2,
        open: function(event, ui) {
            $(".ui-autocomplete .ui-menu-item a").each(function (i) {
                var row = $(this).html();
                row=row.replace(/&lt;/g,"<");
                row=row.replace(/&gt;/g,">");
                $(this).html(row);
              });   
        },

    }); 
```

PHP（代码点火器）：

```
public function autocomplete_search2()
{
    $term = $this->input->get('term');

    //load model and get results
    $this->load->model("establishment_model");
    $results1= $this->establishment_model->search_autocomplete_est($term);
    $results2= $this->establishment_model->search_autocomplete_loc($term);

    //Start JSON string
    $json='[';

    //first source
    if ($results1->num_rows() > 0)
    {
        $header= "<h3 style='font-weight:bold'>Accommodation:</h3>";
        $json .= '{"value":"'.$header.'"}';
        foreach ($results1->result_array() as $r1)
        {
            $result = str_replace($term,"<strong style='color:#C00'>".$term."</strong>",$r1['establishment_name']);
            $json .= ',{"value":"'.$result.'"}'; 
        }
    }

    //second source
    if ($results2->num_rows() > 0)
    {
        if ($results1->num_rows() > 0){$json .=  ',';}
        $header= "<h3 style='font-weight:bold'>Destinations:</h3>";
        $json .= '{"value":"'.$header.'"}';

        foreach ($results2->result_array() as $r2)
        {
            $result = str_replace($term,"<strong style='color:#C00'>".$term."</strong>",$r2['establishment_location']);
            $json .= ',{"value":"'.$result.'"}';
        }
    }

    //Close JSON string
    $json .= ']';
    echo  $json;
} 
```

由于自动完成转义了我发送的 html，因此当我打开自动完成框时，我只需通过用 <>替换`&lt;`和来取消转义它。`&gt;`

编辑：还必须添加以下事件来格式化结果：

```
close: function(event, ui) {
                var result = $(this).val();
                if (result.search("</h3>") ==-1)
                {
                    result=result.replace(/<strong style='color:#C00'>/g,"");
                    result=result.replace(/<\/strong>/g,"");
                }
            else
            {
                result="";
            }
            $(this).val(result);
        } 
```

# javascript - 显示超大图像的方法

> ID：12206003
> 
> 赞同：1
> 
> 时间：2012-08-30T21:45:18.493
> 
> 标签：javascript, html

我希望这对 SO 来说不是一个太宽泛的问题，但我正在为一个艺术学生开发一个网站，他将 80 英尺长的卷轴扫描成三个单独的 .tiff 文件。我一直在寻找一种在框架中显示整个图像的方法。总文件大小约为 900mb。我的总体想法是将图片分成几个较小的图像，并根据放大的位置加载每个图像。

但是，我想知道这种类型的东西是否已经可用。我记得看到一个网站在更大的情况下做了类似的事情，但我很难想出解决方案。

任何帮助将不胜感激。

# actionscript-3 - AS3 Stage3D：如何使用整体 alpha 渲染所有三角形？

> ID：12206010
> 
> 赞同：1
> 
> 时间：2012-08-30T21:45:53.370
> 
> 标签：actionscript-3, alpha, alpha-transparency, stage3d

我正在开发一个 2D AS3 项目，其中不同的图层通过 Stage3D 在单个 drawTriangles() 调用中呈现为单个网格。（如果你熟悉 BunnyMark GPUSprite 迷你渲染引擎，那会给你一个想法：[http](http://www.bytearray.org/?p=4074) ://www.bytearray.org/?p=4074 ）

我想要的是绘制这些完整的“渲染层”之一，具有一个整体的 alpha 透明度值，这将适用于所有绘制的三角形，并添加到它们自己的 alpha 值。

IE 我不希望通过使用具有 alpha 透明度的纹理或必须通过单独设置每个三角形以具有相同的 alpha 来更改 alpha：我想要一个会影响绘制的所有内容的 alpha 值的主开关？（计算上便宜的东西）

这可能吗？也许通过着色器或 setProgramConstantsFromVector 命令？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:10:52.887

好吧，您可以将您的图层渲染为纹理，然后您可以将此纹理放在舞台上并使用您想要的 alpha，这样您的整个图层将具有相同的 alpha！

您可以通过两种方式做到这一点，第一种方式是将其渲染为纹理，并使用 Stage3D 显示该纹理并创建一个调整 alpha 的着色器。

第二种方法是将其渲染为 bitmapData，并在普通舞台上显示。我将举例说明这种方式：

```
var bmd:BitmapData = new BitmapData(renderWidth, renderHeight, true, 0);
var bit:Bitmap = new Bitmap(bmd);
bit.alpha = 0.5;
addChild(bit);

//In your render loop at the beginning
context3D.renderToBitmapData(bmd); 
```

# asp.net-mvc - 为什么我在使用 Godaddy 服务器的 MVC3 应用程序中有不稳定的会话

> ID：12206012
> 
> 赞同：6
> 
> 时间：2012-08-30T21:45:57.473
> 
> 标签：asp.net-mvc, session, login, logout

我在 godaddy 服务中有一个 MCV3 应用程序，会话非常不稳定。

当我登录时它工作正常，但是在应用程序中导航时它会注销我，并点击刷新或在应用程序内部导航更多一点，就像那样（不询问凭据或任何东西）。在我的远程测试服务器和本地工作正常。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-30T21:56:30.883

这可能不是会话问题，而是身份验证 cookie/票证问题。GoDaddy（很可能）使他们的服务器负载平衡。这意味着您的应用程序实际上一次存在于多个服务器上。

在您的 web.config 中，如果您没有正确定义`<machineKey>`属性，那么 IIS 会为您组成一个机器密钥。如果您未定义，则运行该应用程序的每台服务器都将创建自己的机器密钥。结果，一个服务器能够解密并读取您的身份验证票，而下一个请求会发送到另一台无法解密身份验证票的服务器，因为它是使用不同的密钥加密的，并且该服务器认为您没有登录。

要解决此问题，请打开您的 web.config 文件并定义您的`<machineKey>`属性并重新部署。使用新部署的应用程序登录后，您应该会看到此问题消失。

[MSDN 上的表单身份验证和机器密钥信息](http://msdn.microsoft.com/en-us/library/ff649308.aspx#paght000007_webfarmdeploymentconsiderations)

[机器密钥生成器](http://www.developerfusion.com/tools/generatemachinekey/)（很可能，到这里的每个人都应该使用生成的 .NET 2.0 版本）

# powershell - PowerShell 中的省略号有什么作用？

> ID：12206013
> 
> 赞同：6
> 
> 时间：2012-08-30T21:46:05.247
> 
> 标签：powershell

我熟悉基本[范围运算符](http://technet.microsoft.com/en-us/library/hh847732)：

```
.. Range operator
Represents the sequential integers in an integer array, given an upper and lower boundary.
    1..10
    10..1
    foreach ($a in 1..$max) {write-host $a} 
```

但是，我今天不小心使用了省略号 ( `...`) 而不是范围运算符 ( `..`)，并注意到它出于某种原因从 N 枚举到 0：

```
PS C:\> 5...3
5
4
3
2
1
0 
```

这是怎么回事？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-30T21:46:05.247

范围运算符仍在使用 - 事实证明，范围运算符的第二个输入（在本例中`.3`为 ）被隐式转换为整数，因为范围运算符仅接受整数作为输入。

这可以通过使用高于 的右侧值来验证`.5`：

```
PS C:\> 5...6
5
4
3
2
1 
```

当您使用明显的非整数值作为范围运算符的右侧值时，这更容易看到：

```
PS C:\> 5..'3'
5
4
3 
```

# css - css 文字阴影

> ID：12206014
> 
> 赞同：3
> 
> 时间：2012-08-30T21:46:05.990
> 
> 标签：css, styles

我在一个网站上工作，我想为我的文本添加一些阴影，有没有一种简单的方法可以只使用 css 来做到这一点？我尝试在其下放置一个较暗的文本克隆，但这对于不同的尺寸会很困难。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T21:46:44.507

您可以使用**CSS3** `text-shadow`属性实现此目的。指定它的一般格式是：

```
text-shadow: *left-offset* *top-offset* *blur-distance* *color*; 
```

示例用法：

```
text-shadow: 2px 2px 1px #000000; 
```

您可以通过用逗号分隔它们的定义来创建多个阴影：

```
text-shadow: 2px 2px 1px #000000, -2px -2px 1px #111111; 
```

不过，旧版本的 IE 不支持此属性；你需要使用`filter`：

```
filter: DropShadow(Color=#000000, OffX=2, OffY=2); 
```

在哪里用您的偏好替换值。

**注意：使用强大的搜索引擎**[Google](http://www.google.com)可以很容易地找到您问题的答案。请在下次提问之前尝试一下。

**另一个注意事项：**您确实不必提及您正在处理的网站是成人网站。这完全无关紧要，甚至可能对某些用户来说有点不受欢迎。

不过，欢迎使用 Stackoverflow！我希望这有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:00:56.137

您可以随时在文本上使用 css text-shadow：

```
text-shadow:1px 0px 2px grey, -1px 0px 2px grey, 0px 1px 2px grey, 0px -1px 2px grey; 
```

将在文本周围创建一个整体阴影。

# php - 在表单中有多个“提交”按钮的最佳方式？

> ID：12206019
> 
> 赞同：4
> 
> 时间：2012-08-30T21:46:22.683
> 
> 标签：php, html, forms

假设我有一个简单的表格（但它相当长）。

此表单将用户数据提交到数据库中，第一次提交后，很少 (99.99%) 再次对其进行完整编辑，一次只编辑一个部分。

我不希望用户必须向下滚动到他们需要的部分，然后必须再次滚动相同的距离才能提交它。

```
<form>

    <div>
        <input type="text" />
    </div>
    <div>
        <input type="text" />
    </div>
    <div>
        <input type="text" />
    </div>
    <div>
        <input type="text" />
    </div>

    <input type="submit" />

</form> 
```

这就是它的“非常”基本结构。做这样的事情会被认为是一种体面的做法

```
<form>

    <div>
        <input type="text" />
    </div>
    <input type="submit" />
    <div>
        <input type="text" />
    </div>
    <input type="submit" />
    <div>
        <input type="text" />
    </div>
    <input type="submit" />
    <div>
        <input type="text" />
    </div>

    <input type="submit" class="afterFormSubmit"/>

</form> 
```

我不确定是否有“更好”的方法来做到这一点，或者这是否是实现它的更好方法之一？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T21:52:28.013

除非您使用 AJAX 执行此操作，否则最好的方法是使用两种形式。您可以使用 ajax 请求在同一个表单中提交两个不同的东西。

或者，如果您想在每个部分上使用带有提交按钮的相同表单，只需一个提交链接，就像这样

```
<a href="JavaScript:submit_form();">Submit</a> 
```

这样，无论他们在提交的哪个部分都适用于您想要的表单。

另一种选择可能是使用选项卡将其拆分，即[http://jqueryui.com/demos/tabs/](http://jqueryui.com/demos/tabs/)

您可以在选项卡区域之外提交 1 次。更多信息在这里：[http ://www.jankoatwarpspeed.com/post/2009/02/18/How-to-deal-with-large-webforms.aspx](http://www.jankoatwarpspeed.com/post/2009/02/18/How-to-deal-with-large-webforms.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T21:54:38.573

将您的提交按钮放在不可滚动的视图上。

```
<form>
  <input type='text'/>
  ...
  ...
  <input type='submit' style="display:fixed; top:100px; left:200px;" />
</form> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T21:48:38.093

`<form>`在您的情况下，我认为您应该为您想要的每个提交按钮使用不同的表单，而不是只有一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-30T22:00:33.357

是的，我曾经为一位只需要带有 Xs 的简单日历的客户做过一次

我在每个日历上都放了一个提交按钮，所有这些都嵌入到 php_self 的 1 个表单中

我的程序文件很大，即使我更喜欢 OOP

# excel - 自定义选项卡默认

> ID：12206022
> 
> 赞同：1
> 
> 时间：2012-08-30T21:46:38.547
> 
> 标签：excel, vsto

我在 VSTO 的功能区中有一个自定义选项卡。我第一次打开 excel 表时，默认选项卡是“主页”。我希望在打开我的 excel 表时默认打开我的自定义选项卡。请告诉我如何完成此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-06-29T22:19:36.723

我有同样的问题，看到这个问题没有得到解决。我在 Excel 2013 中使用 VSTO。这可以通过在自定义功能区类（Microsoft.Office.Tools.Ribbon.RibbonBase 的子类）的 Load 事件处理程序中添加与此类似的代码轻松完成：

```
private void YourCustomRibbon_Load(object sender, RibbonUIEventArgs e)
{
    RibbonUI.ActivateTab("yourCustomTabName");
} 
```

“yourCustomTabName”是自定义 RibbonTab 对象的 ControlId。当您在 RibbonTab 设计器中打开功能区选项卡时，可以在 ControlId 属性中找到它 - 就在 (Name) 属性下方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T16:51:04.477

您必须使用计时器来完成此操作，因为功能区是异步加载的并且没有`StartupTab`属性。

如果您使用的是 Excel 2007，则必须通过功能区的`IAccessible`属性访问功能区，我在对[Select VSTO Custom Ribbon in Excel](https://stackoverflow.com/questions/2008359/select-vsto-custom-ribbon-in-excel/6847758#6847758 "在 Excel 中选择 VSTO 自定义功能区")问题的回答中对此进行了描述。

```
System.Timers.Timer tmr { get; set; }

private void Ribbon1_Load(object sender, RibbonUIEventArgs e)
{
    tmr = new System.Timers.Timer(500)
    {
        Enabled = true
    };
    tmr.Elapsed += new System.Timers.ElapsedEventHandler(RibbonActivateTimer);
}

private void RibbonActivateTimer(object source, System.Timers.ElapsedEventArgs e)
{
    var tab = this.Tabs.SingleOrDefault(c => ((RibbonTab)c).Label == "YourStartupTab");
    if (tab != null)  // check to see if ribbon tab contains the ribbon deal
    {
        if (double.Parse(Globals.ThisWorkbook.Application.Version) >= 14) //14 = xl2010
        {
            this.RibbonUI.ActivateTab(tab.ControlId.CustomId);
            DeRegisterTimer();
        }
    }
}

private void DeRegisterTimer()
{
    tmr.Dispose();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-19T14:30:23.007

对于最近的 Office，在 YourRibbon.cs 文件中，在事件 Load 方法中放置以下行：

```
 private void YourRibbon_Load(object sender, RibbonUIEventArgs e)
    {
        Globals.Ribbons.YourRibbon.RibbonUI.ActivateTab("YOUR_TAB_CONTROL_ID");
    } 
```

# php - 从 PHP 脚本发送 Mutt 电子邮件

> ID：12206031
> 
> 赞同：0
> 
> 时间：2012-08-30T21:47:30.380
> 
> 标签：php, email, mutt

我有一个电话系统，它调用 PHP 脚本在通话后发送电子邮件。现在我的服务器设置为使用 sendmail 发送它，但我正在切换到使用 Mutt 发送电子邮件。我的 php 中现在发送电子邮件的行是这样的：

执行（邮件（$to，$subject，$message，$headers））；

有没有等效的东西可以让我从脚本中通过 mutt 发送电子邮件？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T11:37:29.003

您可以在 PHP 脚本中通过 shell 执行命令行

```
shell_exec('mutt -s "Subject" to@mail.com < message.txt'); 
```

[http://php.net/manual/en/function.shell-exec.php](http://php.net/manual/en/function.shell-exec.php)

# .net - 阻止实体框架刷新身份字段？

> ID：12206033
> 
> 赞同：0
> 
> 时间：2012-08-30T21:47:34.023
> 
> 标签：.net, sql-server, entity-framework

我有使用实体框架创建/插入记录的场景，但我不关心保存操作完成后的状态 - Web 服务环境。

SQL Server 端的典型跟踪：

```
exec sp_executesql N'insert [dbo].[Log]([CreatedOn], [DeviceKey], [DeviceTime], [Message], [Source], [StackTrace], [Category], [Priority])
values (@0, @1, @2, @3, @4, @5, @6, @7)
select [LogKey]
from [dbo].[Log]
where @@ROWCOUNT > 0 and [LogKey] = scope_identity()',N'@0 datetime2(7),@1 int,@2 datetime2(7),@3 varchar(250),@4 varchar(250),@5 varchar(max) ,@6 tinyint,@7 tinyint',@0='2012-08-30 21:43:16.6633154',@1=6,@2='2012-08-30 21:43:14.4310000',@3='Test 2',@4='',@5='Somewhere',@6=0,@7=3 
```

EF插入部分`select [LogKey] from dbo.Log where @@ROWCOUNT > 0 and LogKey = scope_identity()`

我真的不希望这段代码运行。是否可以阻止 EF 这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T08:55:13.953

如果您使用的是数据库生成的密钥（身份列），则无法避免这种情况。EF 需要自动生成的 ID 作为其插入逻辑的一部分。

# c++ - C++ 静态友元方法示例（需要说明）

> ID：12206035
> 
> 赞同：1
> 
> 时间：2012-08-30T21:47:47.280
> 
> 标签：c++, implementation, static-methods, friend

这是 C++ 如何工作的问题。

我一直在研究`friend`修饰符，并在此处找到了一个`static friend`方法示例[。](http://bytes.com/topic/c/answers/539425-static-friend-function)

但是现在我很难理解**为什么**要采取某些措施来使其发挥作用。

我也很好奇这可以用于什么***实际应用？***你**想**什么时候使用`static friend`？应该避免这种情况吗？

这是添加了注释的代码，以指出我感到困惑的部分。

```
#include <iostream>

class A; //1\. why declare class A here and define it below?

class B
{
public:
    B();
    ~B();

    static void SetAiPrivate(int value); //Makes SetAiPrivate static
    static A *pa; //static instance of class A for class B's static 
                  //methods to use
};

class A
{
friend void B::SetAiPrivate(int); //Gives Class B's SetAiPrivate method access
                                  //to A's private variables

public:
    A(){iPrivate = 0;}
    ~A(){}
    void PrintData(){ std::cout << "iPrivate = "<< iPrivate<<"\n";}

private:
    int iPrivate;
};

A *B::pa;//2\. Why is this needed? 
         //   If commented out it causes an external linking error.

B::B()
{
    pa = new A;
}     
B::~B()
{
    delete pa;
}

void B::SetAiPrivate(int value)
{
    pa->iPrivate = value;
}

int main()
{
    B b; //3\. Is this necessary? Doesn't C++ automatically initiate static
         //   member variables when a class is referenced

    B::SetAiPrivate(7);
    B::pa->PrintData();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T21:54:56.220

我们先来看代码：

> A类；//1\. 为什么在这里声明A类并在下面定义它？

这是一个前瞻性声明。`B`有一个 type 的成员`A*`，所以`A`必须事先声明。

> A *B::pa;//2\. 为什么需要这个？

静态数据成员仅在类定义中声明。这就是定义，标准要求它存在于单个翻译单元中。

> 乙乙; //3\. 这是必要的吗？引用类时，C++ 不会自动初始化静态成员变量吗？

没有必要。除非当然`static`方法`B`依赖于构造函数的运行。如果他们这样做，这是一个糟糕的设计。

到`friend`问题上。通常，有朋友会打破封装，无论是成员还是整个班级。这没有什么不同。它只是告诉编译器`A::iPrivate`可以从`B::SetAiPrivate`.

这在我看来是错误的，因为您可能希望能够`A`直接设置成员 from `A`，而不是 from `B`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T21:55:55.493

> 1 为什么在这里声明A类并在下面定义呢？

如果 A 是在 B 类之后定义的，则需要转发声明 A，因为 B 类包含指向 A 实例的指针。如果您在 B 类之前定义了 A 类，则不需要

> 2 为什么需要这个？

静态成员必须在类定义之外的某个地方初始化

> 3 这有必要吗？引用类时，C++ 不会自动启动静态成员变量

AFAIK 知道由于您提到的原因，这不是必需的

# ruby-on-rails - Rails 3.如何使用reduce和has_many关系？

> ID：12206036
> 
> 赞同：1
> 
> 时间：2012-08-30T21:47:51.213
> 
> 标签：ruby-on-rails, ruby

我有这段代码可以与. 一起使用`shipment has one invoice`，但现在我不得不将其更改为`shipment has many invoices`. 如何修改以下代码以反映新的关联？

```
@totals = {
    :overall => @shipments.reduce(0) { |total, shipment| total + shipment.invoice.customer_total },
    :paid => @shipments.reduce(0) { |total, shipment| total + shipment.invoice.customer_amount_paid },
    :balance => @shipments.reduce(0) { |total, shipment| total + shipment.invoice.customer_open_balance }
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T21:52:52.293

我会做这样的事情：

```
# collect all the invoices at once
invoices = @shipments.map(&:invoices).flatten

@totals = {
  # collect all the customer_totals and sum them... repeat
  :overall => invoices.map(&:customer_total).reduce(0, :+),
  :paid    => invoices.map(&:customer_amount_paid).reduce(0, :+),
  :balance => invoices.map(&:customer_open_balance).reduce(0, :+)
} 
```

注意：[Enumerable#reduce](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-reduce)以及 中的许多其他方法`Enumerable`都能够使用命名方法或运算符的块或符号。这允许您替换`[1,2,3,4,5].reduce{ |sum, x| sum + x }`为`[1,2,3,4,5].reduce(:+)`

此外，如果没有给出参数，则假定集合中的第一个值是备忘录的初始值。

正如 tokland 指出的那样，如果数组为空，您将希望将备忘录的初始值作为 0 传递。这可以防止您获得`@totals[:balance] == nil`.

# strongly-typed-dataset - LINQ - 具有强类型数据集的 SelectMany

> ID：12206044
> 
> 赞同：0
> 
> 时间：2012-08-30T21:48:12.610
> 
> 标签：strongly-typed-dataset, linq

我有以下查询可以准确返回我需要的内容，

```
var dataRows = 
            (from headerLocationRow in headerLocationDataTable
             select WellsDao.Instance.GetAllWellData(headerLocationRow.HEADER_ID).WELL_BORE_CONSOLIDATED)
             .SelectMany(x => x.Select()); 
```

但我不喜欢它如何将内联查询与扩展方法混合在一起。这是一个较旧的项目，所以我坚持使用强类型数据集。我尝试使用两个*from*语句，但它不喜欢那样。 **headerLocationDataTable**是一个强类型数据表。WellsDao.Instance.Get ...废话遍历DataSet并根据headerLocationDataTable中的**HEADER_ID****字段**返回强类型为**WELL_BORE_CONSOLIDATED的DataTables****集合**。

 ****这不是什么大问题，因为查询有效，但我真的想掌握 LINQ，所以我只想知道如何将整个事情作为内联来完成。或者，如果您知道更优雅的写作方式，请分享。最终，我想返回一个包含所有**WELL_BORE_CONSOLIDATED**行的 DataRows 平面列表，无论它们与哪个父**headerLocationRow**关联。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:03:07.467

这应该做你想要的：

```
var dataRows =  from headerLocationRow in headerLocationDataTable
                from wbcRow in WellsDao.Instance.GetAllWellData(headerLocationRow.HEADER_ID).WELL_BORE_CONSOLIDATED
                select wbcRow; 
```

这是 a 的查询语法`SelectMany`。****

# php - PDO 错误（准备好的语句） - 不能使用 PDOStatement 类型的对象作为数组

> ID：12206047
> 
> 赞同：2
> 
> 时间：2012-08-30T21:48:22.483
> 
> 标签：php, mysql, pdo, prepared-statement

我决定将我的项目迁移到准备好的语句，执行以下代码后出现错误：

```
$sql = 'SELECT clanID FROM clan_users WHERE userID = :uid LIMIT 1';
$data = $this->pdo->prepare($sql);
$data->execute(array(':uid' => $uid));
$data->fetchAll();

return $data['0']['clanid']; 
```

返回错误：

```
 Fatal error: Cannot use object of type PDOStatement as array in
/var/www/game/classes/Clan.class on line 689 
```

var_dump($data) 返回：

```
object(PDOStatement)[122]
    public 'queryString' => string 'SELECT clanID FROM clan_users WHERE userID = :uid LIMIT 1' (length=57) 
```

$uid 的值是正确的，在 mysql 上手动选择会返回预期的行。我也尝试更改为

```
$data->fetch(PDO::FETCH_OBJ); 
```

但也没有用。

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-30T21:51:26.983

`$data`变量只是语句。您实际上需要将结果`$data->fetchAll()`填充到这样的不同变量中

```
$data_array = $data->fetchAll(); 
```

然后您使用 $data_array，而不是`$data`直接使用。

# ms-access - 使用 VBA 从 MSAccess 打开 MSWord - 429 错误

> ID：12206050
> 
> 赞同：1
> 
> 时间：2012-08-30T21:48:33.913
> 
> 标签：ms-access, vba, runtime, activex

我在 Ms Access 2010 中尝试了一段非常简单的代码。我想要一个表单上的控件来打开一个 word 文档。我已经尝试了几件事，但我拼凑在一起的最简单的代码如下：

```
Private Sub CmdWord_Click()

Set wordApp = GetObject(, "Word.Application")

    With wordApp
        .Visible = True
        Set wordDoc = .Documents.Add

    End With

End Sub 
```

这可以编译，但是当我在没有打开 Word 的情况下运行它时，我得到“运行时 429 错误：activex 组件无法创建对象。

打开 Word 后，我打开了一个新文档。

我曾尝试更新对 ADO 6.0 的引用，但无济于事。我是 VBA 的新手，所以任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T21:51:55.540

您通常可以使用 FollowHyperlink 打开已注册应用程序的文件。

```
 FollowHyperlink "z:\docs\word.docx" 
```

否则，您可以在 Word 未运行时使用 CreateObject。

```
On Error Resume Next
Set oWord = GetObject(,"Word.Application")

If Err.Number <> 0 Then
   Set oWord = CreateObject("Word.Application")
End If

oWord.Visible = True 
```

# c# - 在 Windows 8 上发送帖子数据

> ID：12206055
> 
> 赞同：3
> 
> 时间：2012-08-30T21:48:47.703
> 
> 标签：c#, windows-8

我正在尝试将发布数据（json）发送到网络服务器。这是非常基本的东西，但在 Windows 8 api 中，一切都必须很复杂：/ Microsoft 提供的示例根本不起作用[http://code.msdn.microsoft.com/windowsapps/HttpClient-sample-55700664/sourcecode?fileId=50955&pathId =797575364 scenerio](http://code.msdn.microsoft.com/windowsapps/HttpClient-sample-55700664/sourcecode?fileId=50955&pathId=797575364) 5 - 它正在向服务器发送一些东西，但没有应该发送的东西（也许当我将字符串转换为流时有一些问题......）

```
 byte[] byteArray = Encoding.Unicode.GetBytes( data );
            MemoryStream stream = new MemoryStream( byteArray );
            StreamContent streamContent = new StreamContent(stream);

            HttpRequestMessage request = new HttpRequestMessage(HttpMethod.Post, url);
            request.Content = streamContent;
            request.Headers.TransferEncodingChunked = true; 
            var httpClient = new HttpClient();

            HttpResponseMessage response = await httpClient.SendAsync(request);

            string responseString = await response.Content.ReadAsStringAsync(); 
```

但我想出了另一个想法，这个解决方案有效（但是......）

```
 var request = (HttpWebRequest)WebRequest.Create(url);
            request.ContentType = "application/json";
            request.Method = "POST";

            using (var requestStream = await request.GetRequestStreamAsync())
            {
                var writer = new StreamWriter(requestStream);
                writer.Write(data);
                writer.Flush();
            }

            using (var response = await request.GetResponseAsync()) 
            {
                using (var responseStream = response.GetResponseStream())
                {
                    var reader = new StreamReader(responseStream);
                    var answer = reader.ReadToEnd();
                    return answer;
                }
            } 
```

正如我之前所说，这种解决方案有很大的缺点——服务器响应可能有 http 代码 422，然后应用程序立即崩溃。如何使用第二种解决方案检查 http 响应代码？（我不确定这是否可能，因为它会崩溃`request.GetResponseAsync`）

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:03:32.467

用 try-catch 块包装代码的主体并处理`WebException`错误调用。`WebException.Status`包含请求失败原因的状态代码。

```
var request = (HttpWebRequest)WebRequest.Create(url);
request.ContentType = "application/json";
request.Method = "POST";
try {
// Your code
}
 catch (WebException)
{ //error handling
} 
```

# jquery - 使用可跨浏览器窗口排序的 jQuery UI

> ID：12206058
> 
> 赞同：1
> 
> 时间：2012-08-30T21:48:59.527
> 
> 标签：jquery, jquery-ui, popup

我正在尝试使用 jQuery UI 的 sortable 使浏览器弹出窗口（即`window.open()`，不是某种模式）中的列表项可排序。基本上：

```
popup = window.open("", "_blank").document.body;
list = popup.appendChild(...);
$(list).sortable(); 
```

然而，jQuery UI 中的定位计算似乎变得一团糟。拖动东西并不会显示流畅的移动——似乎什么都没有发生，但是点击足够多的东西会在整个页面上移动元素（它们被困在位置：绝对样式中）。

在弹出窗口本身的相同样式/标记上运行可排序的 jQuery UI 可以正常工作，因此问题似乎源于父窗口上的 jQuery 试图计算子窗口 DOM 中的位置。将子 DOM 上的容器传递给 jQuery UI sortable 的`containment`选项没有帮助。

有什么方法可以告诉父窗口 jQ​​uery 它需要针对子窗口的文档进行所有计算？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-10T10:08:04.200

我可能会选择绕过这个问题，并简单地创建一个空白文档，其中包含一个容器和 JS 包装器，用于您希望从父级调用的任何函数——而不是打开一个完全空白的文档，而是打开一个主要为空的文档，其中包含内置的任何必要函数以及它自己对 jQuery 库的引用，但它接受来自父级的函数调用来填充它（例如，popup.FunctionName(var) 等）。如果孩子需要和家长交流，基本同理即可。

这样一来，您就可以通过隔离 jQuery 调用来简单地避免 jQuery 在其操作范围上变得模糊时遇到的任何问题，基本上只在它们应该影响的窗口中调用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T16:20:44.987

我同意 DoctorJest 的观点，即打开另一个窗口可能不是最好的解决方案。如果您已经在使用 jquery UI，您是否考虑过`.dialog()`？[jsFiddle](http://jsfiddle.net/sinetheta/QfbsD/5/)

```
$( "#dialog-modal" ).dialog({
    modal: true,
    open: function(){
        $( "#sortable" ).sortable();
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T16:24:59.373

一种解决方案（如下）是使用 HTML5 拖放 API 创建连接的可排序列表（即，您可以从弹出窗口拖动到父级，反之亦然）。

另一种方法是简单地将相关的 jQuery UI 功能（在本例中为 jquery.ui.sortable.js）复制到弹出窗口。但是，您将无法从弹出窗口拖动到父窗口。

## 解决方案1：

这使用 Ali Farhadi 的 jQuery HTML5 Sortable 插件来创建多窗口可排序列表。

JavaScript：

```
var popup = window.open("", "_blank").document.body;
var list = popup.appendChild($("#list")[0]);
var parentList = $("#parent-list")[0];

$(parentList).sortable({
    connectWith: ".connected"
});

$(list).sortable({
    connectWith: ".connected"
}); 
```

演示：http: [//jsfiddle.net/SO_AMK/VED6D/](http://jsfiddle.net/SO_AMK/VED6D/)

*我正在研究第二种解决方案，但我还不知道它有多可行。*

# c# - KeyEventArgs 事件不起作用

> ID：12206060
> 
> 赞同：-3
> 
> 时间：2012-08-30T21:49:05.913
> 
> 标签：c#, winforms, visual-studio

为什么这在 VS 2010 中不起作用？单击后，我在表单中按“a”，但没有任何反应。

```
private void Form1_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.KeyData == Keys.A)
        {
            MessageBox.Show("A");
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-17T17:18:56.830

在相关表单上使用 KeyPreview：

```
public Form1()
{
    InitializeComponent();
    this.KeyPreview = true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T21:56:13.863

当您按下该键时，您的表单可能没有焦点。

> 获取或设置一个值，该值指示在将事件传递给具有焦点的控件之前窗体是否将接收键事件。

```
this.KeyPreview = true; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T21:56:39.897

你搞好了没

```
KeyPreview = true; 
```

[http://msdn.microsoft.com/en-us/library/system.windows.forms.form.keypreview(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.keypreview(v=vs.100).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-27T15:56:23.047

是否分配了 KeyEventHandler？

```
KeyDown += Form1_KeyDown; 
```

# jquery - jQuery 自定义滑块查询

> ID：12206061
> 
> 赞同：2
> 
> 时间：2012-08-30T21:49:22.507
> 
> 标签：jquery

我让这个网站的人帮我解决了我遇到的滑块问题，我只需要有人帮我解决最后一块拼图。

这是小提琴[http://jsfiddle.net/gajjuthechamp/vrqdh/2/](http://jsfiddle.net/gajjuthechamp/vrqdh/2/)

当您单击“缩略图”时，内容会出现在上面的主 div 中。

我需要“extraContent”下的 div/缩略图在“mainContent”下拥有自己独特的内容 div。

希望这是有道理的。

谢谢

jQuery：

```
$(function(){
  $("#parent").on("click", ".extraContent div", function(){
       newHtml=$(this).html();
       $("#parent").find(".mainContent p").fadeOut(1000,function(){
              $(this).parent().html(newHtml);
              $(this).parent().fadeIn(1000);
       });
    });
}); 
```

HTML：

```
<div id="parent">
    <div class="mainContent"> <p>This is the default Text</p></div>
    <div class="extraContent">
        <div><p>test and Image Goes hear for 1 div</p></div>
        <div><p>test and Image Goes hear for 2 div</p></div>
        <div><p>test and Image Goes hear for 3 div</p></div>
        <div><p>test and Image Goes hear for 4 div</p></div>
    </div>
</div> 
```

CSS：

```
#parent { width:400px; margin:auto}
.mainContent { width:430px; height:300px; border:1px solid #000;padding:5px; }
.extraContent {overflow:auto; width:450px;}
.extraContent div{float:left; width:90px; height:90px; border:1px solid #00F; margin:5px; padding:5px }
.extraContent div:hover { border:1px solid #0F0;cursor:pointer } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:10:05.377

## *[jsFiddle 演示](http://jsfiddle.net/vrqdh/3/)*

HTML：

```
<div id="parent">
    <div class="mainContent">
        <div class="cont"> Content 1....</div>
        <div class="cont"> Content 2....</div>
        <div class="cont"> Content 3....</div>
        <div class="cont"> Content 4....</div>  
    </div>
    <div class="extraContent">
        <div><p>1 Custom content here</p></div>
        <div><p>2 Custom content here</p></div>
        <div><p>3 Custom content here</p></div>
        <div><p>4 Custom content here</p></div>
    </div>
</div> 
```

添加的CSS：

```
.cont{position:absolute;} 
```

jQuery：

```
$(function(){
  $('.cont:gt(0)').hide();
  $("#parent").on("click", ".extraContent div", function(){
       var ind = $(this).index();
       $("#parent").find(".cont").stop().fadeTo(600,0,function(){
           $('#parent').find('.cont').eq(ind).stop().fadeTo(300,1);
       });
    });
}); 
```

# wix - WIX - 安装程序失败并出现错误 0x80070005：未能为对象设置安全信息

> ID：12206062
> 
> 赞同：1
> 
> 时间：2012-08-30T21:49:37.773
> 
> 标签：wix

我为 WCF/Silverlight 应用程序创建了一个安装程序。在用户将安装路径更改为 C:\Program Files 之前一切正常。所有其他路径都可以正常工作。

> 未能为对象设置安全信息：C:\Program Files (x86)\

它在 Windows 2008 Server R2 上。即使用户选择 C:\Program Files\ 日志显示 C:\Program Files (x86)\

**安装日志的最后几行：**

> MSI (s) (90:08) [13:22:10:334]：LocalSQLConfigDataSource 在远程上下文中返回 1。MSI (s) (90:08) [13:22:10:344]：执行操作：ActionStart(Name=ExecSecureObjects,,) Action 13:22:10: ExecSecureObjects。MSI (s) (90:08) [13:22:10:353]：执行操作：CustomActionSchedule(Action=ExecSecureObjects,ActionType=3073,Source=BinaryData,Target=ExecSecureObjects,CustomActionData=C:\Program Files (x86) \CreateFolderEveryone269221888) MSI (s) (90:B0) [13:22:10:358]：调用远程自定义操作。DLL：C:\Windows\Installer\MSIF980.tmp，入口点：ExecSecureObjects ExecSecureObjects：在 C:\Windows\Installer\MSIF980.tmp 中输入 ExecSecureObjects，版本 3.6.3005.0 ExecSecureObjects：保护对象：C:\Program Files (x86)\类型：CreateFolder 用户：Everyone ExecSecureObjects：错误 0x80070005：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:31:58.047

32 位安装程序无法写入 64 位 ProgramFiles。这需要 64 位 MSI。

为什么要更改 Program Files 文件夹的权限？这对操作系统来说是非常具有侵入性的。

# c - ANSI C - 创建良好 API 接口的技巧

> ID：12206064
> 
> 赞同：2
> 
> 时间：2012-08-30T21:49:54.930
> 
> 标签：c, api, ansi

我正在尝试创建一个易于正确使用且难以错误使用的 API。

想象一下，您有一个函数`"bool MyObject_SetLocalDateTime(MyObject *pMyObject, params...)"`允许客户端以`YYYY MM DD HH MM SS`格式设置日期和时间：

```
MyObject *pMyObject = MyObject_Create();
...
MyObject_SetLocalDateTime(pMyObject, params...);
...
MyObject_Destroy(&pMyObject); 
```

该功能的良好接口是什么？对于如何使接口在 ANSI C（而不是 C++）中易于正确使用和难以正确使用的任何提示，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:07:22.460

我首先要说决定什么是“正确”。严重地。

您希望输入是最准确的吗？您希望该功能不会失败吗？你想限制可以输入的值吗？您可能需要考虑您正在创建的内容的要求。

如果此时调用此函数，数据的格式是什么？它可能只是在用户输入的“YYYY MM DD HH MM SS”的字符串中，那么采用一个字符串并自己解析出值可能是最明智的。当然，这在你的函数中还有很多工作要做。

此外，如果您是为自己编写函数，您可以对输入值和测试更加宽容，因为您可能知道预期的内容。如果您正在为一个将有数十万人使用这些 API 的操作系统创建一个函数，那么您需要更明确地说明允许的内容并在您的函数中测试它们。

根据您的情况最“正确”的情况，有多种方法可以指定您引用的简单函数。

bool MyObject_SetLocalDateTime(pMyObject, int YYYY, unsigned int MM, unsigned int DD, int HH, int MM, int SS); // 返回值表示成功或失败。

但是，如果消费者为 MM 传入零怎么办？如果消费者在 13 中通过怎么办？您是使用 base-0（通常是 C 使用的）还是常规的 1-12 来表示月份（jan-dec）的数字，从人类月份的角度来看，这更有意义，但有点奇怪C程序员的思维方式？

对于日期和时间之类的内容，C 库对此进行了定义，这将使您更容易。此外，由于 C 库已经这样做了，因此对于使用您的函数的其他用户来说，它可能看起来更自然。

您还需要定义“难以正确使用”的含义。再说一次，我是认真的。也许您想为月份（和几天）创建一个枚举，并将其传递给 int。这将使编译器对 API 进行额外的类型检查，但你的 API 的聪明消费者可能会转换为另一个值，所以不要认为你可以跳过对有效输入的测试。

在您的函数中，您需要验证输入值，无论它们以何种形式传递，以确保它们有效，检查您不允许 2 月的 30 天，并且您允许 2 月的 29 天，但是仅每四年一次。日期和时间有很多隐藏的复杂性，因此明智地依赖已经在操作系统中开发的例程或运行时库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T21:57:09.230

你为什么不简单地使用`time_t`和/或`struct tm`？

像下面这样就可以了：

```
time_t my_local_time ;

MyObject_SetLocalDateTime(pMyObject, my_local_time ) ; 
```

或者

```
struct tm my_local_time ;

MyObject_SetLocalDateTime(pMyObject, my_local_time ) ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T21:59:07.420

您可以在名称中给出提示：MyObject_SetLocalDateTime_YMDHMS

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-30T22:07:15.947

在`C`，我会遵循以下规则：

1.  返回正确的错误代码作为返回类型。
2.  使用`struct const* struct_param`如此可变的输入/输出参数，以便它们的指针值无法在该 API 内更改。

3.  用于`struct const * const structParam`不可变输入参数，以便它们的指针值和内容不能在该 API 内更改。

在 C++ 中使用引用而不是指针，我的意思是，C++ 显式提供了引用传递，因此您可以减少指针的值传递。

# javascript - 防止 WordPress javascript 冲突的良好做法？

> ID：12206068
> 
> 赞同：0
> 
> 时间：2012-08-30T21:50:16.323
> 
> 标签：javascript, wordpress, conflict

我遵循了有关创建自己的自定义 WP 主题的教程。在我更深入地添加脚本之前，它们被简化为基础并且工作得很好。每次我尝试添加新插件或涉及 javascript 的东西时，滑块都会停止工作，或者新插件不起作用。

我只是在添加插件、手动添加脚本等时寻求有关良好编程技术或实践的建议。

如果您手动将javascript粘贴到`<head>`您应该将其放在某些代码之上还是之下以防止冲突？

不要求讲义或厨房水槽。我只是不明白添加脚本的顺序或最好的方法。这是我的基本 WP header.php 文件的外观示例，在我开始添加插件之前它可以完美运行：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">    <html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
<title><?php bloginfo('name'); ?><?php wp_title(); ?></title>
<meta http-equiv="Content-Type" content="<?php bloginfo('html_type'); ?>; charset=<?php bloginfo('charset'); ?>" /> 
<meta name="generator" content="WordPress <?php bloginfo('version'); ?>" /> <!-- leave this for stats please -->
<link rel="stylesheet" href="<?php bloginfo('stylesheet_url'); ?>" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="<?php bloginfo('rss2_url'); ?>" />
<link rel="alternate" type="text/xml" title="RSS .92" href="<?php bloginfo('rss_url'); ?>" />
<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="<?php bloginfo('atom_url'); ?>" />
<link rel="pingback" href="<?php bloginfo('pingback_url'); ?>" />
<?php wp_get_archives('type=monthly&format=link'); ?>
<?php //comments_popup_script(); // off by default ?>
<?php wp_head(); ?>

<script type="text/javascript" src="click2call.js"></script>
<script type="text/javascript">
    function send_call() {
        document.getElementById("CallBtn").value="Dialing.."; 
        var button_id  = document.getElementById('button_id').value;
        var cid_number = document.getElementById('cid_number').value;
        var cid_name   = document.getElementById('cid_name').value;
        click2call(button_id, cid_number, cid_name);
    }
    jQuery('.sub-menu').parent().find('a:first').removeAttr('href').css('cursor','default');
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T23:29:31.087

通常，防止命名冲突的最安全方法是始终为函数和变量名称添加唯一前缀。

假设您编写了一个名为“begin_slide()”的函数。这可能会与 NUMEROUS 其他插件和脚本冲突，所以如果你想确保你的 - 并且只有你的 - 被调用，你可以将它命名为“LITguy_begin_slide()”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T15:31:04.937

我强烈推荐阅读[Addy Osmani 关于 JavaScript 中良好命名空间模式的大量文章](http://addyosmani.com/blog/essential-js-namespacing/)。使用立即调用的函数表达式来防止全局范围问题并使用唯一的对象名称作为所有专有函数的前缀将使所有代码保持独立。

此外，如果您的主题具有特定的 JavaScript 库依赖项（如 jQuery、Underscore 等），您应该学习[如何以“WordPress 方式”包含内容，](http://designisphilosophy.com/tutorials/using-javascript-libraries-in-wordpress-the-right-way/)以防止在多次意外包含公共库时常见的命名冲突。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T00:13:20.473

您可以做几件事。

*   您可以尝试确认一个插件是“ADSafe”： http: [//www.adsafe.org/](http://www.adsafe.org/)，但有很多插件不是我仍然会使用的。
*   确保命名空间是这样的：

> var mynamespace = 命名空间 || {};
> 
> ```
> (function() {  
>    function myClass() {  
>    }  
> 
>    mynamespace.myClass = myClass();  
> }()); 
> ```

或者

```
(function(){
   mynamspace.something = {
      something : function(){
      }
   }
}()); 
```

*   您可以尝试查看您的库或插件是否存在“noConflict”模式并设置该变量。
*   尽可能避免使用全局变量
*   希望和祈祷？

# image - 加载的图像在 MATLAB 中不保留单独的颜色

> ID：12206075
> 
> 赞同：0
> 
> 时间：2012-08-30T21:50:58.450
> 
> 标签：image, matlab

我有一张在 MATLAB 中加载的地图图像。

在地图加载到 MATLAB 之前，外观是：

美国大陆：绿色

海洋：蓝色

加拿大：黄色

在我加载它显示的地图后：

加拿大和美国是一种颜色，但我需要按颜色将它们分开。

我的代码是：

```
im = double(imread('US.png'))
figure;
colormap summer;
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T00:40:40.903

作为一个粗略的猜测，我假设您没有正确缩放强度（颜色）值，即不在 [0, 1] 中，因此任何高于 1 的值都由颜色图（任何颜色或灰度）映射到相同的值.

只要`length(unique(im))==3`（您在加载之前看到的三个灰度值的三个不同索引），那么以下两个都应该缩放您的视觉输出：

```
imshow(im, []); colormap summer;
imshow(im./max(im(:))); colormap summer; 
```

# php - 如何在 Aptana Studio 3 中设置远程托管项目（在 linux 服务器上）？

> ID：12206077
> 
> 赞同：0
> 
> 时间：2012-08-30T21:50:58.997
> 
> 标签：php, installation, aptana3

警告！我是一个完整的 PHP 新手……我的整个职业生涯都在 MS 生态圈中。不要以为我什么都知道。谢谢！

这是地形：

1.  在windows 7机器上开发。安装了 Aptana Studio。
2.  安装了 PHP 和框架的 Linux 服务器。

这是我希望能够做到的：

1.  在 Aptana Studio 中创建 PHP 项目
2.  从 Aptana 工作室内部开发
3.  测试应用程序
4.  将文件上传到服务器（或者，它们托管在服务器上，而 Aptana 只是在编辑它们。

我该如何设置？我不想在我的开发机器上安装 WAMP 或任何东西。我只想使用要使用的远程服务器上的 PHP 库。

我假设如果我在 Aptana Studio 中创建一个 PHP 项目，除非我安装了 WAMP 或使用支持 PHP 的远程 Linux 服务器来测试和运行该应用程序，否则它将无法工作。

最后...如果我想使用 cakePHP，我假设使用这个设置我要求我可以将它安装在远程服务器上然后使用库？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T11:14:26.650

我的个人设置与您的非常相似。我创建一个项目，然后添加一个连接。此连接使用 SFTP 连接到 Linux 服务器，并指向包含 PHP 文件的文件夹。然后，您可以在 Aptana 中打开、编辑和保存所有这些文件（当然，只要您已连接）。

唯一的缺点是，由于 Aptana 不会将此 SFTP 连接视为本地连接，因此您无法使用更广泛的代码搜索等。如果这不适合您，您可以看看将 SFTP 文件夹挂载为 Windows 上的驱动器。然后你可以欺骗 Aptana 认为它是一个本地文件夹，然后所有的花里胡哨都会起作用，只是有点慢:)

# javascript - (typeof variable === "function") 和 jQuery.isFunction() 有什么区别？

> ID：12206083
> 
> 赞同：8
> 
> 时间：2012-08-30T21:51:24.777
> 
> 标签：javascript, jquery, function, typeof

我一直使用`(typeof variable === "function")`，我偶然发现`jQuery.isFunction()`，我想知道：

1.  typeof方法和jQuery的方法有什么区别？不仅有什么区别，而且
2.  什么时候适合使用 typeof 方法，什么时候适合使用 jQuery 的方法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-30T21:55:05.577

几乎*没有*区别，除了使用 jQuery 稍微慢一些。查看源代码：

```
isFunction: function( obj ) {
    return jQuery.type(obj) === "function";
}, 
```

它调用一个函数，该函数调用另一个函数来确定与您显示的*完全相同*的事情：P

在这种情况下，jQuery 确实没有任何优势 [或者对于这种方式，库的 90% 的用例]。查看[Vanilla-JS](http://vanilla-js.com/)并查看它的一些功能：P

TLDR：不要为此使用 jQuery ......或任何东西。

### 更新

这是一个基准，显示 Vanilla JS 比 jQuery 快大约 93%：http: [//jsperf.com/jquery-isfunction-vs-vanilla-is-function](http://jsperf.com/jquery-isfunction-vs-vanilla-is-function)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-30T21:53:33.943

~~没有区别。jQuery 使用相同的概念：~~

```
// ...
isFunction: function( obj ) {
    return jQuery.type(obj) === "function";
} 
```

**更新：**

在深入挖掘之后，我发现 jQuery 的`isFunction`方法是将链上的`toString`方法与字符串进行比较。这就是它与您之前的示例的不同之处以及它比.`Object.prototype``function() {}``[object Function]``typeof`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-30T22:01:31.437

isFunction 的 jQuery 源代码是

```
isFunction: function( obj ) {
    return jQuery.type(obj) === "function";
},

type: function( obj ) {
return obj == null ?
   String( obj ) :
   class2type[ core_toString.call(obj) ] || "object";
},

//...

jQuery.each("Boolean Number String Function Array Date RegExp Object".split(" "),
   function(i, name) {
      class2type[ "[object " + name + "]" ] = name.toLowerCase();
});

core_toString = Object.prototype.toString, 
```

因此`jQuery.isFunction`当且仅当调用`Object.prototype.toString.call`它的参数返回true `[object Function]`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-07-25T08:35:32.203

通常你可以通过这个测试来测试 JS 对象是否是函数：

```
(typeof fn === 'function') 
```

但是，这并不总是有效（IE8）：

```
typeof alert => 'object'
typeof document.createElement('input').getAttribute => 'object' 
```

在 jQuery 1.4 之前，他们在内部使用了相同的检查，但现在他们已经修复了它。所以要确保传递的对象是一个可以调用的函数，只需使用 $.isFunction 方法：

```
$.isFunction(function() {}) => true
$.isFunction(alert) => true
$.isFunction(document.createElement('input').getAttribute) => true 
```

从这个博客复制：http: [//nuald.blogspot.co.uk/2012/07/why-jqueryisfunction.html](http://nuald.blogspot.co.uk/2012/07/why-jqueryisfunction.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-30T22:03:46.913

不同之处在于 JQuery 调用与以下内容等效的内容并检查“Function”字符串标记：

```
var toString = Object.prototype.toString;
var func = function(){};

console.log(toString.call(func)); // "returns [object Function]" 
```

而typof，只返回“函数”：

```
var fType = typeof func; 

console.log(fType); // returns "function" 
```

[这是一个例子。](http://jsfiddle.net/JzPvw/)

# android - 开发模型并将其用于移动和平板电脑

> ID：12206087
> 
> 赞同：-2
> 
> 时间：2012-08-30T21:51:35.210
> 
> 标签：android, model-view-controller, business-logic

我有一个团队为 iPhone 和 iPad 开发了一个 iOS 应用程序。

他们使用了 MVC（可能是内置于 iOS 中的？）。他们构建了业务逻辑，并在 iPhone 和 iPad 上都使用了它，只是具有不同的 UI/视图和相同的控制器（可能？）。

我们如何在 Android 中实现这一点？MVC / MVP？在这种情况下，我们如何构建文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:12:59.427

Android 和 iOS 是明显不同的实现，数据、ui 和控件可以在概念上分开，但与 iOS 中的方式不完全相同

这是一个类似的 SO [question](https://stackoverflow.com/questions/2925054/mvc-pattern-in-android)以及一些答案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T23:41:07.787

[您在此处](http://developer.android.com/guide/practices/tablets-and-handsets.html)的 Android SDK 文档中得到了描述。根据我的经验 - 如果您想正确执行此操作，则必须正确设计它并将您的应用程序拆分`fragments`为/o 适当的设计。

# sql-server - 如何在 SQL Server management Studio 2012 中查找匹配的开始和结束语句？

> ID：12206088
> 
> 赞同：16
> 
> 时间：2012-08-30T21:51:35.973
> 
> 标签：sql-server, ssms

如何在 SQL Server Management Studio 2012 中查找匹配的开始和结束语句？我有一个很长的存储过程，其中包含多个级别的多页嵌套 if 语句。SQL 已经格式化。[我的问题与这个](https://stackoverflow.com/questions/8085741/how-to-find-matching-begin-end-pairs-in-complex-sql-server-query)问题非常相似，但我使用的是 SSMS 2012，它现在使用 Visual Studio Shell。我想知道 MS 是否添加了此功能，或者是否有外部工具或 SSMS 插件可以做到这一点。

否则我将不得不求助于旧问题中的解决方案。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2016-09-15T18:31:29.227

如果有人仍在寻找答案，那就是*CTRL+]*。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-30T22:53:40.063

我似乎能够让 BEGIN / END 的代码崩溃没问题。在工具 > 选项 > 文本编辑器 > Transact-SQL 下观察我的设置：

![在此处输入图像描述](../Images/f6cc777f4e458788b57b005d96c3a40e.png)

请注意，我启用了 IntelliSense，并在“工具”>“选项”>“文本编辑器”>“Transact-SQL”>“智能感知”下选中了“大纲语句”：

![在此处输入图像描述](../Images/aea50eefb23b7fe08cd1eef3716fedfb.png)

行号真的很有帮助。如果我折叠包含 BEGIN 的行，则下一个行号是END*之后的行：*

![在此处输入图像描述](../Images/dafa06d52b361944311b8ca628ce5bfe.png)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-09-26T17:35:24.413

`CTRL`+用于从匹配`]`跳转。从.跳转到匹配的相同键。`BEGIN``END``BEGIN``END`

`CTRL`++在`SHIFT`和之间`]`跳转时选择代码块。`BEGIN``END`

如果您已安装 SQL Prompt，单击`BEGIN`( `END`)，将匹配的`END`( `BEGIN`) 突出显示为灰色。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-08-30T22:08:04.337

这不是答案，我还没有足够的声誉发表评论。

除了您提到的另一个主题中指出的解决方案之外，我认为没有办法。我所做的是，删除`END`，再次写入`END`，它会变灰，`BEGIN` 与此匹配的`END`也会变灰。然后我只是在代码中搜索灰色单词。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-30T22:15:16.120

您需要的功能称为 Edit.GotoBrace，并且存在于 SSMS v 2008 和 2012 中。它具有不同的快捷方式，具体取决于您的 ssms 的语言版本。我有 SSMS2008 EN 和 SSMS2012 German，我的键盘布局是德语。所以快捷方式是：

**SSMS 2008 中文**

只需找到匹配的开始/结束

`Edit.GotoBrace Text Editor::Ctrl+´`

相同，但也扩展了选择

`Edit.GotoBraceExtend Text Editor::Ctrl+Shift+´`

**SSMS 2012 德语**

`Edit.GotoBrace (Bearbeiten.GehezuKlammer) Text-Editor::Ctrl+´`

`Edit.GotoBrace (Bearbeiten.GehezuKlammer) Text-Editor::Ctrl+9`

`Edit.GotoBraceExtend (Bearbeiten.ErweiternbisKlammer) Text-Editor::Ctrl+Shift+´`

`Edit.GotoBraceExtend (Bearbeiten.ErweiternbisKlammer) Text-Editor::Ctrl+Shift+9`

在 SSMS 2012 中，您可以使用本机键盘快捷方式管理器来查看/更改此命令或任何其他命令的快捷方式。但是：本机命令有一个缺点：您必须在开始/结束时才能跳转到配对标记。

我为 ssms 开发了一个免费插件，并实现了昨天改进的功能，允许从嵌套代码中的任何位置跳转到父开始/结束标记。它将在下一个版本中提供。所以如果你喜欢我的想法 - 等到下一个版本。加载项称为 SSMSBoost。我还用它来快速找到您的问题的答案： - 它具有“转储 SSMS 快捷方式”和“转储 SSMS 命令”功能，它列出了 ssms 中所有可用功能的完整列表（并且它允许在SSMS2008，没有快捷方式管理器）

# c - gsoap/valgrind；没有泄漏但内存错误

> ID：12206090
> 
> 赞同：8
> 
> 时间：2012-08-30T21:51:54.180
> 
> 标签：c, valgrind, gsoap

我正在用 gSoap 编写一个 Web 服务客户端，并使用 Valgrind 检查内存问题。

Valgrind 报告没有泄漏，但显示了这个奇怪的（至少对我而言）内存错误消息：

```
==3529== Conditional jump or move depends on uninitialised value(s)
==3529==    at 0x405D6DC: soap_reference (stdsoap2.c:6926)
==3529==    by 0x405305D: soap_serialize_string (sepomexC.c:4982)
==3529==    by 0x404AF5E: soap_serialize_ns1__asentamientosPorCodigoPostalRqType (sepomexC.c:2629)
==3529==    by 0x40500F3: soap_serialize_PointerTons1__asentamientosPorCodigoPostalRqType (sepomexC.c:4103)
==3529==    by 0x4046666: soap_serialize___sep__consultarAsentamientosPorCodigoPostal (sepomexC.c:1233)
==3529==    by 0x4053A7D: soap_call___sep__consultarAsentamientosPorCodigoPostal (sepomexClient.c:186)
==3529==    by 0x40417CA: consultarAsentamientosPorCodigoPostal (main.c:73)
==3529==    by 0x804870C: main (sepomexmain.c:31)
==3529== 
==3529== Conditional jump or move depends on uninitialised value(s)
==3529==    at 0x4061AA5: soap_element_id (stdsoap2.c:9583)
==3529==    by 0x4068B0C: soap_outstring (stdsoap2.c:12681)
==3529==    by 0x4052DAE: soap_out_xsd__integer (sepomexC.c:4918)
==3529==    by 0x404B062: soap_out_ns1__asentamientosPorCodigoPostalRqType (sepomexC.c:2643)
==3529==    by 0x4050179: soap_out_PointerTons1__asentamientosPorCodigoPostalRqType (sepomexC.c:4111)
==3529==    by 0x4046698: soap_out___sep__consultarAsentamientosPorCodigoPostal (sepomexC.c:1238)
==3529==    by 0x4046818: soap_put___sep__consultarAsentamientosPorCodigoPostal (sepomexC.c:1274)
==3529==    by 0x4053AF6: soap_call___sep__consultarAsentamientosPorCodigoPostal (sepomexClient.c:193)
==3529==    by 0x40417CA: consultarAsentamientosPorCodigoPostal (main.c:73)
==3529==    by 0x804870C: main (sepomexmain.c:31)

==3529== 
==3529== HEAP SUMMARY:
==3529==     in use at exit: 0 bytes in 0 blocks
==3529==   total heap usage: 160 allocs, 160 frees, 16,161 bytes allocated
==3529== 
==3529== All heap blocks were freed -- no leaks are possible
==3529== 
==3529== For counts of detected and suppressed errors, rerun with: -v
==3529== Use --track-origins=yes to see where uninitialised values come from
==3529== ERROR SUMMARY: 3 errors from 2 contexts (suppressed: 21 from 8) 
```

NO LEAKS 是个好消息，但是，这些错误重要吗？据我了解，它们是在 stdsoap2.c （一个 gSoap 文件）中生成的。

谢谢。

编辑：感谢您的回答。正如你们中的一些人告诉我的那样，我有未初始化的东西，这是我的请求结构变量。我这样修复它：

```
struct ns1__myRequestType request;
memset(&request, 0, sizeof(struct ns1__myRequestType)); 
```

现在 Valgrind 的输出是“干净的” :) 非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T21:58:39.067

它基本上是指基于未初始化的变量采取一些分支的事实。`if`它们可以简单地是库函数范围内的自动变量，这些变量在堆栈上分配并且在用于 a , `while`,之前没有被赋值`switch`，或其他形式的分支表达式。一般来说，这不是一件好事，因为它可能导致未定义的行为，但如果错误是库内部的，则编写者可能正在使用使它们非正式地“初始化”，而不是用标准 C 语法显式初始化。另一种可能性是您还可以将指向未初始化变量的指针传递给其中一个库函数，这将是糟糕的编程形式，并且可能会产生不可预测的结果或安全风险。

# php - 在每次页面加载时将大量数据存储在缓存或大型数据库查询中

> ID：12206099
> 
> 赞同：0
> 
> 时间：2012-08-30T21:52:58.440
> 
> 标签：php, mysql, database, caching

我的网站对每个客户都有一个非常精细的权限系统，使其规模相当大。

为了限制数据库查询，我一直在用户会话开始时从 mysql 数据库加载位掩码，然后将其保存为会话数据，所以它看起来像这样。这使我可以为每个用户会话进行一次（尽管它是复杂的 JOIN 查询）查询，而无需创建巨大的会话文件。

```
"permissions" => array(
    "type 1" => 'bitfield'
    "type 2" => 'bitfield'
     "type 3" => array(
         entity id = 'bitfield'
         entity id = 'bitfield')
     "type 4" => array(
         entity id = 'bitfield'
         entity id = 'bitfield')
) 
```

权限完全基于组，因此给定组中的每个人都会在他们的会话数据中复制此权限。

然而，位掩码开始使用起来很痛苦，我希望转向使用 acl。然而，我一开始没有使用 acl 的原因是为了尽量减少数据库的使用。

所以.. 现在我将拥有一个完全由数据库/缓存驱动的 acl，没有任何位掩码。然而，在用户会话数据中存储大量权限似乎并不理想。（你同意？）

我认为要走的路是使用平面文件缓存来存储组权限。最简单的方法是每组一个文件吗？当有 4,000 + 个组，每个组具有 4 种权限类型（2 种权限类型是全局的，具有 40 个左右的权限，2 种类型是本地权限，每个实体有 40 个左右的权限（每种类型可能有 3 或 4 个20 个权限！）。**编辑：为清楚起见，这意味着每组 160 - 200 个权限条目**

这似乎是一个相当大的缓存！每次页面加载时都使用大量数据库会更好吗？这种数据大小使位掩码变得容易得多，但它们只是不够灵活了。

由于文件由 2 个不同的服务器提供服务（会话粘着，因此将位域保存到会话数据不是问题），这使得这变得更加困难，因此任何缓存都必须在服务器之间同步。数据库位于通过专用网络连接的单独服务器上，据称是 1gig 连接。

可以提出任何解决方案吗？我认为具有这么多数据的快速访问缓存（例如 memcached）只会让我的内存使用量大增？我很想只使用大量的数据库查询，但我认为这可能会给数据库服务器带来太大的压力。

相当大的问题，我希望它清楚。如果有任何需要澄清，请告诉我。任何解决方案将不胜感激！

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:25:46.857

我不认为存储在会话中的具有约 40 个条目的数据结构特别庞大。所以实际上，这可能归结为设计方面的问题是如何以最佳性能最好地将这些信息导入应用程序中。

如果您开始遇到性能问题并且您的基础架构预算允许，我认为您可能会考虑将此解决方案迁移到更多可以在任意数量的服务器之间共享的面向服务的架构。我个人非常相信这种架构，因为它可以真正帮助您处理规模问题。

您可以将“权限”公开为可以由该应用程序（或者将来可能需要开发的其他应用程序）使用的服务。它可能看起来像这样：

*   内存缓存层（memcached 或类似），这是应用程序进行初始调用以根据组查找权限信息的地方。如果此处不存在数据，则下一层为请求提供服务
*   RESTful API。在第一次缓存未命中后，您对组的权限发出简单的 GET 请求。这将需要调用数据库层来获取信息。它还会做一些事情，比如在缓存未命中时填充缓存，在客户端 POST 一些新权限数据或 PUT 更新到现有权限集的情况下使缓存无效并重新填充缓存。
    *   仅由 RESTful 服务访问的 DB 层。如果您有更复杂的非关系数据结构，也许 MySQL 可能是一种 NoSQL 技术。

对于您的服务，您可能有一个非常小的数据库服务器（因为一旦填充了缓存，就应该不经常查询数据库本身）。一个内存缓存服务器，它有足够的内存来满足您的存储需求（或者如果需要冗余，可能是一个小型服务器集群），以及一个相对较小的服务器来处理 REST API（一旦开发了缓存，这也应该不经常访问。好消息是它们是几个 memcached 或类似的服务，你可以相对便宜地使用（如 Amazon Elasticache）。实际上，内存缓存将首当其冲来自应用程序服务器的流量，因此您不需要扩展随着流量的增长，完全启动数据库服务器的 REST 服务器。

希望这对您的思考过程有所帮助。

# coldfusion - 如何让 iCalendar 订阅在多个浏览器/操作系统之间工作？

> ID：12206104
> 
> 赞同：2
> 
> 时间：2012-08-30T21:53:47.547
> 
> 标签：coldfusion, icalendar, webcal

在我们的服务器上，我们已经实现了一种为我们的活动获取动态 iCalendar 提要的方法。这是通过首先调用呈现 iCalendar 文件的 Coldfusion 脚本来处理的，并在将内容类型设置为“text/calendar; charset=UTF-8”后返回该脚本。被称为是这样的：`http://www.mysite.com/ical.cfm?calendar_id=1`

但是，我们注意到这会导致移动设备等设备之间出现问题。iPad 不会“订阅”它，而是导入事件；这不好，因为我们希望这些更新。其他浏览器只是提示下载 ICS 文件，这又会导致人们导入单个文件而不是真正“订阅”事件（我们还使用 Content-Disposition 标头将文件名固定为“.ics”下载为“.cfm”）。

然后我们尝试在链接上使用“webcal://”而不是“http://”。这似乎解决了 iPad 的问题，然后 Firefox 会要求在另一个应用程序中打开链接（我猜有人可以选择他们的日历应用程序）。但是，现在 Chrome 不会做任何事情；我们点击链接，它什么也不做。Webcal 不是标准的“协议”，所以我可能会遇到问题。

现在，我打开 Wireshark 来检查一个提供 Google iCalendar 文件的数据包（它在任何浏览器和 iPad 中都可以很好地链接），除了一些缓存头和自定义的“X”头之外，它并没有什么特别之处，唯一的需要注意的是内容类型被设置为我们提供的内容。

所以，我想知道是否有人有一些关于让它在所有浏览器和 iPad/iPhone 上同样工作的建议。难道是链接调用“.cfm”而不是“.ics”的事实正在抛出一些东西吗？如果是这样，我想我们可以实施重写规则来解决这个问题......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:51:09.027

在对此进行了更多试验之后，不太确定是否有一种可靠的方法可以让它在多个平台上工作。似乎对于 iPhone 和 iPad 之类的东西，它们需要一个“webcal://”链接才能通过 Apple 的日历应用程序订阅。一些浏览器可以接受这种格式，而其他浏览器则不然。

这实际上将涉及创建一个界面，允许人们为他们的设备选择正确的下载，或者使用服务器端请求中的用户代理来针对给定设备/浏览器以适当格式定位链接。

# nhibernate - 会话.Get 和急切的加载

> ID：12206114
> 
> 赞同：2
> 
> 时间：2012-08-30T21:54:41.337
> 
> 标签：nhibernate, lazy-loading, eager-loading

我知道关于 NHibernate 上的急切加载和延迟加载已经说过和发布了很多。我已经阅读了所有（谎言！）关于为什么我应该或不应该在映射时使用“lazy=false”的线程和帖子以及答案，或者当我认为是一个好地方时如何使用 HQL 或 Criteria 来急切加载对象. 虽然，当我使用 ISession.Get 方法时，我还没有发现任何关于急切加载集合属性的信息。让我解释一下场景：

我想使用一个通用存储库（所有其他专业后代类的基础），它看起来像这样：

```
class Repository<T>
{
  public T GetById(long id)
  {
    using (ISession session = NHibernateHelper.OpenSession())
    {
      return session.Get<T>(id);
    }
  }
} 
```

我的问题是：**有没有什么方法可以使用通用的“GetById”方法（就像上面一样），即使如此使用急切加载的所有对象**？

我知道有些人会回答“只使用 NHibernateUtil.Initialize”，但为此我必须“了解”我的实体，在这种情况下，我将不得不*重写*我的方法并失去我的存储库的通用优势。使用 HQL 或 Criteria 或任何其他不使用“Get”简单性的方式也可以这样说。此外，我想拥有 Get（或 Load）方法的其他优点（[因此](http://ayende.com/blog/3988/nhibernate-the-difference-between-get-load-and-querying-by-id)）。

任何想法？我是不是丢了什么东西？难道我不知道我在说什么（很可能）？

# java - 是否可以在数组列表中多次存储相同的字符串？

> ID：12206115
> 
> 赞同：-3
> 
> 时间：2012-08-30T21:54:40.930
> 
> 标签：java, arraylist

我想在数组列表中存储很多小字符串。可以将相同的字符串存储两次吗？

```
 ArrayList<String> list = new ArrayList<String>();
    list.add("string1");
    list.add("string2");
    list.add("string1");
    list.add("string3"); 
```

System.out.println(list); 然后应该给出： [string1, string2, string1, string3]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T21:58:37.100

> 是否可以在数组列表中多次存储相同的字符串？

是的

> `System.out.println(list);`然后应该给出： [string1, string2, string1, string3]

确实如此。

# html - 在 Bootstrap 中将缩略图作为链接使其不居中

> ID：12206117
> 
> 赞同：2
> 
> 时间：2012-08-30T21:54:51.747
> 
> 标签：html, css, twitter-bootstrap

我正在使用 Bootstrap 进行设计，当我尝试使通常居中的缩略图可点击时，它会向左对齐。我无法弄清楚导致它的 CSS 来自哪里。

我将 HTML 和 CSS 添加到[http://jsfiddle.net/DLYds/的 jsfiddle](http://jsfiddle.net/DLYds/)

第一个框是它的外观，其余的缩略图都是链接。

这可能是非常简单的事情，但由于某种原因我没有看到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T06:53:29.050

`.thumbnail`Bootstrap 将图像与以下代码对齐：

```
.thumbnail > img {
    display: block;
    margin-left: auto;
    margin-right: auto;
    max-width: 100%;
} 
```

您的问题是父选择器`>`。因此，只需创建您自己的 CSS 规则，该样式会影响每个图像，而不管其与以下内容的关系如何`.thumbnail`：

```
.thumbnail img {
    display: block;
    margin-left: auto;
    margin-right: auto;
    max-width: 100%;
} 
```

此解决方案尊重 Bootstrap 的图像居中方式，并且不会影响您的文本对齐方式。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-30T22:02:56.703

尝试使用 text-align:center 将链接设置为块元素；[http://jsfiddle.net/DLYds/1/](http://jsfiddle.net/DLYds/1/)

# c# - 用于 WPF 导航的窗口、页面和用户控件？

> ID：12206120
> 
> 赞同：211
> 
> 时间：2012-08-30T21:55:05.093
> 
> 标签：c#, wpf

我目前正在编写一个桌面应用程序，但在将某人重定向到应用程序的新部分时，我似乎无法理解使用什么。

我的选择似乎是

*   窗户
*   页
*   用户控制

但我不明白它们之间的区别是什么，以及何时应该使用它们。

有人可以为我解释这些差异，并举例说明您可以将每种情况/应用程序用于哪些情况/应用程序？

* * *

## 回答 #1

> 赞同：373
> 
> 时间：2012-08-31T13:11:55.837

**Window**对象就是它听起来的样子：它是您的应用程序的新对象`Window`。当你想弹出一个全新的窗口时，你应该使用它。我在 WPF 中不经常使用多个`Window`，因为我更喜欢将动态内容放在我的主窗口中，这些内容会根据用户操作而变化。

**页面**是窗口内的页面。它主要用于基于 Web 的系统，例如 XBAP，在其中您有一个浏览器窗口，并且可以在该窗口中托管不同的页面。它也可以用在像[sellmeadog所说的](https://stackoverflow.com/a/12206173/302677)[导航应用程序](http://windowsclient.net/learn/video.aspx?v=4190)中。

**UserControl**是可重用的用户创建控件，您可以像添加任何其他控件一样将其添加到 UI。通常，`UserControl`当我想构建一些自定义功能（例如 a `CalendarControl`）时，或者当我有大量相关的 XAML 代码`View`时，例如使用 MVVM 设计模式时，我会创建 a 。

在窗口之间导航时，您可以简单地创建一个新`Window`对象并显示它

```
var NewWindow = new MyWindow();
newWindow.Show(); 
```

但就像我在这个答案开头所说的那样，如果可能的话，我不喜欢管理多个窗口。

我首选的导航方法是使用 a 创建一些动态内容区域，并使用包含当前视图的任何内容[`ContentControl`](http://msdn.microsoft.com/en-us/library/system.windows.controls.contentcontrol.aspx)填充该区域。`UserControl`

```
<Window x:Class="MyNamespace.MainWindow" ...>
    <DockPanel>
        <ContentControl x:Name="ContentArea" />
    </DockPanel>
</Window> 
```

在您的导航事件中，您可以简单地使用

```
ContentArea.Content = new MyUserControl(); 
```

但如果您使用 WPF，我强烈推荐 MVVM 设计模式。[我的博客上](http://rachel53461.wordpress.com/2011/12/18/navigation-with-mvvm-2/)有一个非常基本的示例，说明了如何使用 MVVM 进行导航，使用以下模式：

```
<Window x:Class="SimpleMVVMExample.ApplicationView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:SimpleMVVMExample"
        Title="Simple MVVM Example" Height="350" Width="525">

   <Window.Resources>
      <DataTemplate DataType="{x:Type local:HomeViewModel}">
         <local:HomeView /> <!-- This is a UserControl -->
      </DataTemplate>
      <DataTemplate DataType="{x:Type local:ProductsViewModel}">
         <local:ProductsView /> <!-- This is a UserControl -->
      </DataTemplate>
   </Window.Resources>

   <DockPanel>
      <!-- Navigation Buttons -->
      <Border DockPanel.Dock="Left" BorderBrush="Black"
                                    BorderThickness="0,0,1,0">
         <ItemsControl ItemsSource="{Binding PageViewModels}">
            <ItemsControl.ItemTemplate>
               <DataTemplate>
                  <Button Content="{Binding Name}"
                          Command="{Binding DataContext.ChangePageCommand,
                             RelativeSource={RelativeSource AncestorType={x:Type Window}}}"
                          CommandParameter="{Binding }"
                          Margin="2,5"/>
               </DataTemplate>
            </ItemsControl.ItemTemplate>
         </ItemsControl>
      </Border>

      <!-- Content Area -->
      <ContentControl Content="{Binding CurrentPageViewModel}" />
   </DockPanel>
</Window> 
```

![截图1](../Images/a71b4e0951139918736016003be55aab.png) ![截图2](../Images/50e51b286361a907510b8a8ab8518953.png)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-08-30T21:58:50.097

*   **窗口**就像`Windows.Forms.Form`，所以只是一个新窗口
*   **根据[在线文档，](http://msdn.microsoft.com/en-us/library/system.windows.controls.page.aspx)**页面**是：**

     **> 封装可以导航到 Windows Internet Explorer、NavigationWindow 和 Frame 并由其托管的内容页面。

    所以如果你想可视化一些 HTML 内容，你基本上会使用它** 
***   **UserControl**适用于您想要创建一些可重用组件（但不是独立组件）以在多个不同的情况下使用它的情况`Windows`** 

 *** * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-30T21:59:28.387

一切都取决于您要构建的应用程序。`Window`如果您正在构建基于对话框的应用程序，请使用s。`Page`如果您正在构建基于[导航的应用程序](http://windowsclient.net/learn/video.aspx?v=4190)，请使用s 。`UserControl`s 将非常有用，因为您可以在 Windows 和 Pages 中使用它们。

一个开始探索的好地方是：http: [//windowsclient.net/learn](http://windowsclient.net/learn)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-08-28T09:35:01.803

我们通常将 One Main`Window`用于应用程序，而其他窗口可以在需要弹出窗口的情况下使用，因为我们可以使用在设计时可见的窗口，而不是在 XAML 中使用不可见的弹出控件，这样就很容易了跟...共事

另一方面，我们使用许多页面从一个屏幕导航到另一个屏幕，例如用户管理屏幕到订单屏幕等。在主窗口中，我们可以使用`Frame`控件进行导航，如下面的 XAML

```
 <Frame Name="mainWinFrame" NavigationUIVisibility="Hidden"  ButtonBase.Click="mainWinFrame_Click">
    </Frame> 
```

C＃

```
 private void mainWinFrame_Click(object sender, RoutedEventArgs e)
    {
        try
        {
            if (e.OriginalSource is Button)
            {
                Button btn = (Button)e.OriginalSource;

                if ((btn.CommandParameter != null) && (btn.CommandParameter.Equals("Order")))
                {

                    mainWinFrame.Navigate(OrderPage);
                }
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message, "Error");
        }
    } 
```

这是一种方法我们也可以使用 Tab Control 代替 Fram 并使用 Dictionary 添加页面，同时添加新页面检查控件是否已存在然后仅导航，否则添加和导航。我希望这会帮助某人

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-25T10:40:26.853

最重要的是发布了正确的答案。我想添加一些链接，以便您可以参考它们并对此有清晰和更好的想法：

用户控制：http : [//msdn.microsoft.com/en-IN/library/a6h7e207 (v=vs.71).aspx](http://msdn.microsoft.com/en-IN/library/a6h7e207(v=vs.71).aspx)

关于 WPF 的页面和窗口之间的区别：WPF [中的页面与窗口？](https://stackoverflow.com/questions/5243910/page-vs-window-in-wpf)**

# coldfusion - 寻找Coldfusion UDF 插入br 中间不分词

> ID：12206124
> 
> 赞同：1
> 
> 时间：2012-08-30T21:55:38.840
> 
> 标签：coldfusion, user-defined-functions

就像标题说的那样，如果标题包含的字符多于显示内容，我希望插入一个 <br> 。我知道它存在，但我根本找不到它，我真的很想得到一些帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:13:42.827

找到了！

[http://cflib.org/index.cfm?event=page.udfbyid&udfid=329](http://cflib.org/index.cfm?event=page.udfbyid&udfid=329)

# arrays - 如何遍历这个 Perl 结构？

> ID：12206128
> 
> 赞同：2
> 
> 时间：2012-08-30T21:55:54.523
> 
> 标签：arrays, perl, printing, hash, reference

给定以下代码，我试图弄清楚如何遍历哈希引用数组（或者至少我认为它是哈希引用数组）。也就是说，`$Policy->rules()`?

也许有更好的方法来创建结构数组，我愿意接受建议。

```
use Class::Struct;
use Data::Dumper;

struct Policy => {         
    listings    => '@',  # Will treat like rules eventually.     
    rules       => '@',  # an array of rules      
};

struct Rule => {                
    direction   => '$',        
    id          => '$',        
};

$policy = Policy->new();

$rule1 = Rule->new();
$rule1->direction('Any');
$rule1->id(1);

$rule2 = Rule->new();
$rule2->direction('Inbound');
$rule2->id(2);

$rule3 = Rule->new();
$rule3->direction('Outbound');
$rule3->id(3);

push($policy->rules(),$rule1);
push($policy->rules(),$rule2);
push($policy->rules(),$rule3);

$Data::Dumper::Indent = $Data::Dumper::Terse = 1;
print Dumper \$policy; 
```

输出：

```
\bless( {
    'Policy::listings' => [],
    'Policy::rules' => [
      bless( {
        'Rule::id' => 1,
        'Rule::direction' => 'Any'
      }, 'Rule' ),
      bless( {
        'Rule::id' => 2,
        'Rule::direction' => 'Inbound'
      }, 'Rule' ),
      bless( {
        'Rule::id' => 3,
        'Rule::direction' => 'Outbound'
      }, 'Rule' )
    ]
  }, 'Policy' ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:08:44.543

```
visit_policy($policy);

sub visit_policy {
   my ($policy) = @_;

   my $listings = $policy->listings;
   my $rules    = $policy->rules;

   for my $listing (@$listings) {
      visit_listing($listing);
   }

   for my $rule (@$rules) {
      visit_rule($rule);
   }
}

sub visit_listing {
   my ($listing) = @_;
   # ...
}

sub visit_rule {
   my ($rule) = @_;

   my $direction = $rule->direction;
   my $id        = $rule->id;

   # ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T14:02:33.300

谢谢你的帮助。它看起来很接近，但仍然需要几个星期。见下文。现在，当我运行它并尝试打印规则-> id 时，我得到以下信息：

无法在 D:/SLC/Aiken/Policy/POC/OLAP/test.pl 第 66 行的未受祝福的参考上调用方法“方向”。

```
visit_policy($policy);

sub visit_policy {
   my ($policy) = @_;

   my $listings = $policy->listings;
   my $rules    = $policy->rules;

   for my $listing (@$listings) {
      visit_listing($listing);
   }

   for my $rule (@$rules) {
      visit_rule($rules);
   }
}

sub visit_listing {
   my ($listing) = @_;
   # ...
}

sub visit_rule {
   my ($rule) = @_;

   my $direction = $rule->direction;  #<-- Line 66 
   my $id        = $rule->id;

    print $id . "\n";

   # ...
} 
```

# c# - 为什么非逐字字符串不能包含换行符？

> ID：12206133
> 
> 赞同：7
> 
> 时间：2012-08-30T21:56:25.580
> 
> 标签：c#, string

我开始学习 C#，但我不明白为什么常规字符串文字（即`" "`）不能包含文字换行符。（我不是在谈论转义序列`\n`）。我知道您必须`@" "`对多行字符串使用逐字字符串文字（即，），但为什么呢？

![常规字符串产生](../Images/7725b1167c951d1855206343fe03b2ea.png) ![逐字字符串不会产生错误](../Images/51c74f04f193a8eddaca1666c38627e8.png)

我没有看到它明确指出您不能在常规字符串中使用它们。不仅如此，除了顺便提到我可以为此使用逐字字符串之外，我读过的所有内容似乎都表明在常规字符串文字中允许使用文字换行符。

[开始 Visual C# 2010](http://msdn.microsoft.com/en-us/library/hh147285%28v=vs.88%29)和[代码：生成多行字符串文字 (Visual C#)](http://msdn.microsoft.com/en-us/library/aa287596(v=vs.71).aspx)显示逐字多行字符串的示例，无需进一步解释。

[学习 C# 3.0](http://msdn.microsoft.com/library/orm-9780596521066-01-03.aspx)是这样说的：

> 在 C# 语言中，空格、制表符和换行符被认为是空格......在 C# 语句中通常会忽略额外的空格。...该规则的例外是字符串中的空格被视为文字；它没有被忽视。

所以是字面意思？这也是我所期望的，但事实并非如此。
它甚至包括这个提示框：

> **提示**
> Visual Basic 程序员注意：在 C# 中，行尾没有特殊意义。语句以分号结尾，而不是换行符。没有行继续字符，因为不需要。

（我意识到这是在谈论字符串之外，但是如果它不在字符串之外，为什么行尾在字符串*内部具有特殊的解析意义？）*

终于找到了[字符串（C# 参考）](http://msdn.microsoft.com/en-us/library/362314fe.aspx)本身的方法，我仍然没有获得任何见解：

> 字符串文字可以包含任何字符文字。包括转义序列。以下示例`\\`对反斜杠、`\u0066`字母 f 和`\n`换行符使用转义序列。

它说*可以*使用转义序列，但没有说*必须*使用它们。“任何字符文字”中是否不包含文字换行符？如果我有一个包含文字制表符而不是其转义序列的字符串，`\t`则没有错误。但是如果我有一个文字换行符，我会得到一个错误。我什至将文件的行尾从`\r\n`to更改`\n`为`\r`无效。

* * *

显然，我可以从示例和 Visual Studio 错误中推断出，如果它包含文字换行符，则需要逐字字符串，但我读过的所有内容都表明不应该是这种情况。为什么有区别？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T21:56:25.580

嗯，开枪。就在我提交这个的时候，我找到了答案。

> “任何字符文字”中是否不包含文字换行符？

显然，不，他们不是。

[2.4.4.4 字符文字](http://msdn.microsoft.com/en-us/library/aa691087%28v=vs.71%29)：

> 字面量：
> 
> > ' 特点 '
> 
> 特点：
> 
> > 单字
> 
> 单字：
> 
> > **除**' (U+0027)、\ (U+005C) 和**换行符之外的任何字符**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:08:40.977

为什么 C/C++ 字符串文字声明必须是单行[的？](https://stackoverflow.com/questions/3093632/why-must-c-c-string-literal-declarations-be-single-line)

简而言之，因为C语言不支持它。

使字符串文字未闭合的拼写错误会将文件的其余部分作为单个标记吞下，给程序员留下一条编译器错误消息，类似于“在第 xxx 行，第 yyy 列期望分号”，其中指示的位置是源文件的结尾。

大多数情况下，您不使用多行文字。最好从用户体验的角度明确它们。

此外，在受限环境中，C 语言是在（8K PDP-11？）中开发的，我怀疑这种溢出可能会使编译器崩溃。

不过，C 语言确实支持文字拼接，这很有帮助：

```
char *txt = "this is line 1\n"
            "this is line 2\n"
            "this is line 3\n"
            ; 
```

它还支持线拼接：

```
char *txt = "this is my\n\
 multi-line string literal\n\
 isn't it nice?\n" ; 
```

我希望 C# 拥有的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T22:15:40.223

C#（以及影响其语法的 C++、C、Java）对空格有一个非常简单的规则：

你可以用它做你想做的事。

这可以让你使用任何你想要的格式来提高可读性。现在，Python 爱好者可能会说这个优势被高估了，但它是我们确实利用的优势。

字符串中的换行符可能会搞砸。如果您不确定源代码中的换行符是否应该意味着我们将`"\u000D"`, `"\u000A"`, `"\u000A\u000D"`, `"\u0085"`, `"\u000B"`,`"\u000C"`或换行的方式，其他人都错了”。`"\u2028"``"\u2029"`

你仍然可以争辩说，允许它的缺点被高估了。C# 确实如此——毕竟，与人们对 C++ 等的期望不同的字符串形式*确实*允许*它*。

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-27T19:10:56.073

看起来这个限制将在 C# 11 中删除。

从[C# 11 Preview: Allow newlines in the "holes" of interpolated strings](https://devblogs.microsoft.com/dotnet/early-peek-at-csharp-11-features/#c-11-preview-allow-newlines-in-the-holes-of-interpolated-strings)：

> C# 支持两种类型的插值字符串：逐字和非逐字插值字符串（分别为`$@""`和`$""`）。它们之间的一个关键区别是非逐字插值字符串不能在其文本段中包含换行符，而必须使用转义符（如`\r\n`）。逐字插值字符串可以在其文本段中包含换行符，并且不会转义换行符或其他字符（除了`""`转义引号本身）。所有这些行为保持不变。
> 
> 以前，这些限制扩展到非逐字插值字符串的孔。孔是表示插值表达式的简写方式，是花括号内提供运行时值的部分。孔本身不是文本，不应遵守内插字符串文本段的转义/换行规则。
> 
> 例如，以下内容会导致 **C# 10中的编译器错误，并且在此****C# 11**预览版中是合法的：

```
var v = $"Count ist: { this.Is.Really.Something()
                            .That.I.Should(
                                be + able)[
                                    to.Wrap()] }."; 
```

这是相关的 Github 问题：[https ://github.com/dotnet/cshaplang/issues/4935](https://github.com/dotnet/csharplang/issues/4935)*

# c - >> 班次操作员未按预期工作

> ID：12206134
> 
> 赞同：1
> 
> 时间：2012-08-30T21:56:27.253
> 
> 标签：c, gdb

我正在学习C语言。我有这个代码，如果需要可以提供更多：

```
int result = 0;
int mask1 = 0x0000ffff;
mask1 = mask1 >> 28; 
```

当我使用 gdb 和 print 时`/x mask1`，我得到`0x0`了，这是正确的。那为什么会这样：

```
int result = 0;
int mask1 = 0xffffffff;
mask1 = mask1 >> 28;

print 0xffffffff 
```

不应该打印`0x0000000f`吗，因为我要左移 28 位？

它与我的 64 位机器上 int 占用的位数有关吗？我看着[这个](https://stackoverflow.com/questions/5812406/16-bit-int-vs-32-bit-int-vs-64-bit-int)，但它并没有完全回答所有问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T21:58:12.820

负整数右移的行为是实现定义的。一种常见的行为是算术移位，它进行符号扩展。这样做的好处是右移也是除以 2 的幂（四舍五入到负无穷大），就像正数一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:07:33.937

你在*右移*。这是右：`>>`，这是左：`<<`。

通常，当您将（有符号）整数右移时，假定您正在更改*值*而不是*符号*：这就是丹尼尔所说的*符号扩展*的意思。标准没有要求，并非所有平台都这样做。

实际上，在使用二进制补码的系统上，这意味着负值将用 填充新的最高位`1`，而正值将用填充`0`。

例如，在 8 位 2s 补码系统上：

```
before          after >> 1
11111110 = -2   11111111 = -1 (so new top bit was 1)
00000010 = +2   00000001 = +1 (so new top bit was 0) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T22:06:16.843

如果您将 0xffffffff 打印为整数，您将意识到它被视为 -1。

Bitshift 对负数的工作方式不同，因为它用 1 填充最高位。所以基本上，0xffffffff >> 1 == 0xffffffff。

如果您将掩码声明为`unsigned int`，那么它可能会执行您想要的操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-30T22:28:55.467

是的，正如@veer 指出的那样，`int`您正在进行右算术移位，这非常适合将有符号数除以 2 的幂（以二进制补码表示）：

![算术右移](../Images/9a7866acc4eeccdc4d58d1d9653b2852.png)

通过将类型更改为`unsigned int`它将成为右位移位，这非常适合将无符号数除以 2 的幂（这是您的方案）：

![右逻辑移位](../Images/57002145e7aab8989a53a03c1d7109ae.png)

[Wikipedia Bitwise operation](http://en.wikipedia.org/wiki/Bitwise_operation "维基百科 - 位运算")上有一些很好的解释。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-30T22:19:38.057

负整数的按位右移是实现定义的。

这是做什么`gcc`的：

> *对有符号整数（C90 6.3、C99 6.5）的一些按位运算的结果。*
> 
> 带符号的 `>>' 通过符号扩展作用于负数。

[http://gcc.gnu.org/onlinedocs/gcc/Integers-implementation.html](http://gcc.gnu.org/onlinedocs/gcc/Integers-implementation.html)

# android - SetOnclick 到动态创建的按钮

> ID：12206139
> 
> 赞同：0
> 
> 时间：2012-08-30T21:56:32.270
> 
> 标签：android, button, pass-by-reference

我有一个带有两个标签的活动。**第一个**有一个按钮。如果按下此按钮，则会**在第二个选项卡中创建一个包含 3 个视图（ImageView、TextView、Button）的表格**

我想在按下此按钮（我们刚刚创建的那个）时开始一项新活动，但我不知道如何引用它。

注意：可能有无限的 tableRows。

谢谢！！

```
TableRow tr = new TableRow(this);
ImageView view = new ImageView(this);
TextView view2 = new TextView(this);
Button view3 = new Button (this);

view.setImageBitmap(thumbnail);
view.setPadding(1, 5, 0, 0);
view.setScaleType(ImageView.ScaleType.CENTER_INSIDE);

Calendar c = Calendar.getInstance();
SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy/MM/dd");

view2.setText("" + et.getText()  + dateFormat.format(c.getTime()) );
view2.setGravity(Gravity.CENTER_HORIZONTAL);
view2.setGravity(Gravity.CENTER_VERTICAL);

view3.setGravity(Gravity.RIGHT);
view3.setGravity(Gravity.CENTER_VERTICAL);

DisplayMetrics metrics = new DisplayMetrics();
getWindowManager().getDefaultDisplay().getMetrics(metrics);

tr.addView(view, metrics.widthPixels/3, 150);
tr.addView(view2, metrics.widthPixels/2, 100);
tr.addView(view3, metrics.widthPixels/6, 20);
tl.addView(tr); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:02:53.943

创建按钮时，您会引用它；只需像添加任何其他按钮一样向其添加 OnClickListener：

```
Button view3 = new Button(this);
view3.setOnClickListener(new OnClickListener() {
   public void onClick() {
     // do stuff
   }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:17:12.593

如果你最终有一个 Button 列表，那么最简单的方法是使用 for each 循环浏览集合，并在每个循环上调用 setOnClickListener 方法（是否使用相同的侦听器实例，具体取决于你要）：

```
// Instantiate the listener that will be used by the buttons.
View.OnClickListener clickListener = new View.OnClickListener() {
   public void onClick(View v) {
     // do something...
   }
});

List<Button> buttons = new ArrayList<Button>();

// add button instances to the buttons list

for (Button button : buttons) {
    button.setOnClickListener(clickListener);
} 
```

根据作者的评论更新：

快速而肮脏的实现，您为每个按钮实例化其中一个，还有其他许多其他解决方案：

```
private class RowButtonListener implements View.OnClickListener {

    private final Context mContext;
    private final String mActivityText;

    public RowButtonListener(Context context, String activityText) { // could be cleaner by providing resource id (int) if you use strings.xml
        mContext = context;
        mActivityText = activityText;
    }

    public void onClick(View v) {
        Intent intent = new Intent(mContext, MyActivity.class);
        intent.putExtra(MyActivity.TEXT_KEY, mActivityText);
        startActivity(intent);
    }

} 
```

# php - XML 操作

> ID：12206151
> 
> 赞同：1
> 
> 时间：2012-08-30T21:57:46.090
> 
> 标签：php, xml, json, perl, xmlserializer

我正在编写一个 php 应用程序来操作 XML 文件。我尝试了 Perl XML 序列化器/反序列化器来转换 XML->php obj->json 进行操作然后将 json 转换回 xml 以打印出来。

这是原始 XML 的示例

```
<module name="AssignId" active="true"  description="user description">
  <dict name="params">
    <entry key="Adds">
     ...
    </entry>
  </dict>
</module> 
```

转换为 JSON 如下所示：

```
{"name":"AssignId","active":"true","description":"add draggable class to figure","dict":{"name":"params","entry":[{"key":"Adds" ...
}} 
```

最终结果 XML 如下所示：

```
<name>AssignId</name>
    <active>true</active>
    <description>add draggable class to figure</description>
    <dict>
        <name>params</name>
        <entry>
            <XML_Serializer_Tag>
                <key>Adds</key>
                  ...
            </XML_Serializer_Tag>
        </entry>
    </dict>
</name> 
```

这是我的 2 节课

```
class JSON_toXML {

    var     $jsonObj,
            $phpObj,
            $serializer;

    public function __construct($options, $file_path) {
        $this->serializer = new XML_Serializer($options);
        $serializedDoc = $this->serializer->serialize(json_decode($file_path));
        if ($serializedDoc === true) {
            $this->jsonObj = $this->serializer->getSerializedData();
        } else {
            $this->jsonObj = NULL;
        }
    }
    public function print_obj() {
        echo "<pre>";
        echo($this->jsonObj);
        echo "</pre>";
    }
}

class XML_toJSON {

        var     $phpObj,
                $jsonObj,
                $unserializer;

        public function __construct($options, $file_path) {

            $this->unserializer = &new XML_Unserializer($options);
            $unserializedDoc = $this->unserializer->unserialize($file_path, true);
            $this->phpObj = $this->unserializer->getUnserializedData();
            $this->jsonObj = json_encode($this->phpObj);
        }

        public function print_phpObj() {
            echo "<pre>";
            print_r($this->phpObj);
            echo "</pre>";
        }

        public function get_phpObj() {
            return $this->phpObj;
        }

        public function print_jsonObj() {
            echo $this->jsonObj;
        }

        public function get_jsonObj() {
            return $this->jsonObj;
        }

    } 
```

我想知道如何保持最终结果 XML 与原始格式相同？也许有更好的方法来做到这一点？谢谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:14:37.737

您需要能够区分属性和元素，但您的格式不能传达该信息。您需要首先更改格式，可能类似于以下内容：

```
{
   "element": "module",
   "attribs": {
      "name":        "AssignId",
      "active":      "true",
      "description": "add draggable class to figure"
   },
   "children": [
      {
         "element": "dict",
         "attribs": {
            "name": "params"
         },
         "children:" [
            ...
         ]
      }
   ]
} 
```

# c# - 如何使用 Java 或 C# 从 Google 获取搜索结果？

> ID：12206155
> 
> 赞同：-3
> 
> 时间：2012-08-30T21:57:55.793
> 
> 标签：c#, java

我想在我的应用程序中使用谷歌搜索（包括获取特定结果的选项，例如：'仅来自最后一天的结果'）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T22:03:00.090

只需使用 Google 自定义搜索 API

[https://developers.google.com/custom-search/v1/overview](https://developers.google.com/custom-search/v1/overview)

# android - 为什么我的 RelativeLayout 右侧有一个空白区域？

> ID：12206164
> 
> 赞同：-1
> 
> 时间：2012-08-30T21:58:56.360
> 
> 标签：android, android-layout, android-relativelayout, gravity

我有两个相同、大小相同的 RelativeLayout，其中包含一些文本和一个我想与右侧对齐的图像。然而，似乎有某种填充物不允许我把它放在右边，即使我从未指定过这一点。

![在此处输入图像描述](../Images/5f5fe66dca6292f951bc0d8f688bf443.png)

这是我的代码：

```
<LinearLayout
    android:baselineAligned="false"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal">

    <RelativeLayout
        android:id="@+id/my_relativelayout"
        android:background="@drawable/my_background"
        android:layout_weight="1"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:gravity="right">
        <TextView
            android:id="@+id/my_textview"
            android:textAppearance="?android:attr/textAppearanceButton"
            android:layout_centerVertical="true"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content">
        </TextView>
        <ImageView
            android:id="@+id/my_imageview"
            android:layout_centerVertical="true"
            android:scaleType="center"
            android:src="@drawable/my_image"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_toRightOf="@id/my_textview">
        </ImageView>
    </RelativeLayout>

    <RelativeLayout
        ... same thing here ...>
    </RelativeLayout>

</LinearLayout> 
```

**编辑：空白空间不是另一个RelativeLayout。另一个RelativeLayout是另一个带有文本和图像的“蓝色矩形”，并且也遇到了右侧空间的问题。像这样：**

![在此处输入图像描述](../Images/91bef16382a5c32844c1b3c8d4e63602.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:07:12.180

这是因为您正在使用该`android:layout_toRightOf`属性。这将使您当前视图的左边缘与您正在引用的视图的右边缘（my_textview）对齐。如果您希望视图的右侧与父视图的右侧匹配，请尝试`android:layout_alignParentRight="true"`改用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:09:26.417

试试这个布局：

```
 <ImageView
        android:id="@+id/my_imageview"
        android:layout_centerVertical="true"
        android:scaleType="center"
        android:src="@drawable/my_image"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:Layout_alignParentRight="true">
    <TextView
        android:id="@+id/my_textview"
        android:textAppearance="?android:attr/textAppearanceButton"
        android:layout_centerVertical="true"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toLeftOf="@id/my_imageview">
    </TextView> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T15:27:37.650

检查您在图像视图中使用的图像的边界（在图像编辑器中）。看起来图像中有一些透明区域导致了混乱/问题。

如果这不是问题：试试这个添加属性`alignParentRight="true"`，`ImageView` 而不是 对s`android:gravity="right"`不起作用`RelativeLayout`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T21:20:22.190

最终奏效的解决方案是

```
android:paddingRight="0dip" 
```

在每个相对布局中，奇怪的是，虽然我从未说过应该有任何填充。几天来，我一直在努力解决这个问题；谢谢各位的意见！

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-08-30T22:05:37.450

因为您`LinearLayout`有一个水平布局，`android:orientation="horizontal"`所以该空间将被第一个旁边的任何对象占用`RelativeLayout`，在您的情况下，它看起来像第二个`RelativeLayout`。

如果这没有帮助，我会尝试调整这两个相对布局的 layout_weight 和 layout_width 属性。

# php - 第二个选项假

> ID：12206165
> 
> 赞同：0
> 
> 时间：2012-08-30T21:58:59.523
> 
> 标签：php

我将如何设置它以便我的 if 语句仅在未设置第二个选项时才有效。

```
$options[options1] && $options[option2] 
  {
    // this would be evaluated
  } 
```

所以我需要的是，只有当这些选项中的第一个为真而第二个为假时，它才能工作。它们都来自数据库，第二个选项是字符串值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:01:56.807

```
 if($options[options1] && (!isset($options[option2]))) {
        // this would be evaluated
      } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:04:33.497

`$options[option2]`如果评估为假，这将被评估：

```
if($options[options1] && !$options[option2]) 
  {
    // this would be evaluated
  } 
```

如果未设置，将对其进行评估

```
if($options[options1] && !isset($options[option2]) )
  {
    // this would be evaluated
  } 
```

这是第一个更好的版本：

```
if($options[options1] && (!isset($options[option2] || !$options[option2])) 
  {
    // this would be evaluated
  } 
```

小心字符串`"0"`。它被评估为`FALSE`

# javascript - 如果打开/关闭 javascript，则隐藏和显示 html 代码

> ID：12206169
> 
> 赞同：3
> 
> 时间：2012-08-30T21:59:08.177
> 
> 标签：javascript, html, noscript

所以我有 2 个链接，我想显示 javascript 是否打开并在关闭时隐藏，当 javascript 关闭时，我想在其位置显示 2 个带有 noscript 标记的其他链接。

到目前为止，我所拥有的是：

-js here- 如果 js 打开则显示 2 个链接，并在禁用时隐藏 -js here-

-noscript- 链接 1 链接 2 -noscript-

我只有 PHP 方面的经验，对 javascript 不是很熟悉。

解决此问题的最佳方法是什么？是否应该有某种 javascript 函数来使显示/隐藏功能起作用？但是如果关闭了 javascript，该函数将如何运行以隐藏链接？

如果有人能指出我正确的方向来解决这个问题或为我提供一个简单的代码片段，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T22:03:40.467

1.  使用 CSS 隐藏链接 - 默认情况下不可见

    ```
    <a id="link1" href="#" style="display: none">Script link 1</a>
    <a id="link2" href="#" style="display: none">Script link 2</a> 
    ```

2.  使用 Javascript 显示链接 - 当然，它们仅在 Javascript 开启时可见

    ```
    <script type="text/javascript">
         document.getElementById('link1').style.display="block";
         document.getElementById('link2').style.display="block";
    </script> 
    ```

    根据您的需要，您可以使用任何其他`display`属性（链接`inline`默认情况下，我`block`在这里添加，使用任何您需要的）。

3.  添加`noscript`东西 - 仅在关闭 Javascript 时可见

    ```
    <noscript>
    -two other links-
    </noscript> 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-30T22:06:32.767

我经常看到这是通过 BODY 标签上的 CSS 类来完成的。例如：

```
<html>
<head>
  <style type="text/css">
    BODY A { display: none; }
    BODY.script A { display: inherit; }
  </style>
</head>
<body>
    <a href="#">Shows with Script</a>
</body>
</html> 
```

然后，您可以使用该脚本：

```
document.body.className = 'script'; 
```

对于支持 Javascript 的浏览器，`script`将添加 CSS 类并`BODY.script`使用样式。否则，`BODY`将使用常规样式。

然后，您可以准确定义页面上的任何元素在启用或不启用脚本的情况下如何显示。同样，您可以将其反转并赋予 BODY`noscript`样式，然后通过脚本将其删除。

[JSFiddle 链接](http://jsfiddle.net/ZgHky/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T22:13:23.130

您也可以不使用`noscript`，如下所示

**HTML**

```
<a href="" style="display:none" id='javascript_link1'>JS link-1</a>
<a href="" style="display:none" id='javascript_link2'>JS link-2</a>
<a  href="" id='nonjs_link1'>link-1</a>
<a href="" id='nonjs_link2'>link-2</a> 
```

**JS**

```
document.getElementById('javascript_link1').style.display="block";
document.getElementById('javascript_link2').style.display="block";
document.getElementById('nonjs_link1').style.display="none";
document.getElementById('nonjs_link2').style.display="none";​ 
```

[**演示**](http://jsfiddle.net/RS8m6/2/)。

# hibernate - 未找到 hibernate.properties（我正在使用 xml）

> ID：12206176
> 
> 赞同：1
> 
> 时间：2012-08-30T21:59:55.103
> 
> 标签：hibernate

我是新来的冬眠。当我实例化会话工厂时，我得到了错误

信息：HHH000206：找不到 hibernate.properties

但是 hibernate.cfg.xml 是 src 的根目录。

这是我尝试实例化它的方式：

```
SessionFactory hbrntFctry;
    Session rslt = null;
    ServiceRegistry serviceRegistry = new ServiceRegistryBuilder().configure().buildServiceRegistry();

    try
    { 
        hbrntFctry = new Configuration().configure().buildSessionFactory(serviceRegistry);
        rslt = hbrntFctry.openSession();
    }
    catch (Throwable ex) 
    { 
        System.err.println("Failed to create sessionFactory object." + ex); 
        throw new ExceptionInInitializerError(ex); 
    } 
```

但后来它说：

线程“主”org.hibernate.internal.util.config.ConfigurationException 中的异常：**无法在资源 hibernate.cfg.xml 中的第 4 行和第 26 列执行解组。**消息：cvc-elt.1：找不到元素“休眠配置”的声明。在 org.hibernate.service.internal.JaxbProcessor.unmarshal(JaxbProcessor.java:120) 在 org.hibernate.service.internal.JaxbProcessor.unmarshal(JaxbProcessor.java:69) 在 org.hibernate.service.ServiceRegistryBuilder.configure(ServiceRegistryBuilder .java:162) 在 org.hibernate.service.ServiceRegistryBuilder.configure(ServiceRegistryBuilder.java:147) 在 com.foampile.collect.UsgsRetriever.openHibernateSession(UsgsRetriever.java:250) 在 com.foampile.collect.UsgsRetriever.getStateGauges( UsgsRetriever.java:78) at com.foampile.base.MainApp.main(MainApp.java:22) 原因：javax.xml.bind.UnmarshalException - 带有链接异常：[org.xml.sax.SAXParseException; 行号：4；列号：26；cvc-elt.1：在 com.sun.xml.internal.bind 的 com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallerImpl.handleStreamException(UnmarshallerImpl.java:419) 中找不到元素“休眠配置”的声明。 .v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:356) 在 com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal(UnmarshallerImpl.java:326) 在 org.hibernate.service .internal.JaxbProcessor.unmarshal(JaxbProcessor.java:108) ... 6 更多原因：org.xml.sax.SAXParseException; 行号：4；列号：26；cvc-elt.1：找不到元素“休眠配置”的声明。在 com.sun.org.apache.xerces.internal.util 的 com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:198)。

这是我的cfg文件：

```
<hibernate-configuration xmlns="http://www.hibernate.org/xsd/hibernate-configuration">

<session-factory> 

    <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property> 
    <property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property> 
    <!-- Assume test is the database name --> 
    <property name="hibernate.connection.url">jdbc:mysql://localhost/foampile</property> 
    <property name="hibernate.connection.username">root</property> 
    <property name="hibernate.connection.password"></property> 
    <!-- List of XML mapping files --> 

    <mapping resource="SiteRecord.hbm.xml"/>

</session-factory> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T09:06:03.140

hibernate.cfg.xml 文件中有错误。`</hibernate-configuration>`不见了。

```
<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE hibernate-configuration PUBLIC
    "-//Hibernate/Hibernate Configuration DTD//EN"
    "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">

<hibernate-configuration>
    <session-factory>
       ...
    </session-factory>
</hibernate-configuration> 
```

# database - 建模几个多对多关系的最自然方式

> ID：12206177
> 
> 赞同：3
> 
> 时间：2012-08-30T22:00:06.197
> 
> 标签：database, database-design

可以说我有书和人。一个人可以写很多本书，一本书可以由很多人写。一个人读过很多书，一本书被很多人读过。

```
Person               Book
------               -----
personId             bookId 
```

我可以使用两个关系表：

```
has_read             has_authored
--------             ------------
personId, bookId     personId, bookId 
```

或者一个：

```
person_book_relation
--------------------
personId, bookId, relationType ("read", "authored") 
```

另一个示例可能是 Actor 和 Event 之间的某种订阅者/发布者关系。

有什么指导方针可供选择吗？

如果有更多类型的关系怎么办？这会改变你的解决方案吗？

一个团队有很多人扮演一个角色。一个人可以在多个团队中。（只是编造这个）

```
Team_Person_relation
--------------------
TeamId, PersonId, Role ('Defender', 'Attacker', 'Goalkeeper', 'Midfielder'... etc) 
```

如果您要使用单独的表，这将至少是 4 个表。但是，感觉团队角色之间的联系比“阅读/撰写”关系更紧密？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T22:20:41.903

我会使用第二种类型的表，除非我遇到关系类型实际上影响表中的列的情况。

例如，在图书示例中，作者可能有一个日期，将其发送给出版商，这使得将所有信息保存在一个表中的想法无效，因为该信息不适用于读者。

同样，“进球得分”仅适用于您的守门员。

我想诚实的，如果有些陈词滥调的回答是“这取决于您要提取的信息”-但通常，您可以越明确地表明“这是描述表 x 和表 y 之间关系的表”越清楚并且更容易维护您的数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:27:20.103

作为数据库创建者，这主要取决于您，因为这两种解决方案都是正确的。应该考虑的主要是数据将在未来如何使用（或至少现在预测如何使用）。一些例子：

1.  如果您在一张表中强制使用太多多对多关系，则在使用其中一个表时，您需要始终记住“那里还有其他关系”。例如，如果您希望查看所有未创作任何书籍的人，您需要以过滤“已读”关系的方式构建左连接查询。随着您的查询变得更加复杂并包含更多表和更多外部连接，很容易获得不需要的结果。

2.  团队角色的示例表明角色列表将来可能会发生变化。因此，将此角色保留在关系列中是更好的解决方案。此外，这里的关系指定“成为团队的成员”，并且该成员的角色只是该成员的财产。

3.  如果您希望通过多对多关系存储一些附加信息（例如创作日期，或读者喜欢这本书的程度），它将建议单独的表，否则将使用许多稀疏列来处理所有可能的关系.

4.  最后但同样重要的是：性能。如果表试图包含太多“不相关”的数据，有时可能很难有效地设计和使用索引。

# xslt - xslt 在所有特定值时删除表列

> ID：12206179
> 
> 赞同：2
> 
> 时间：2012-08-30T22:00:09.007
> 
> 标签：xslt, html-table

使用 XSLT，当一列仅包含“0.00”或“-”时，我需要删除一个完整的表格列（标题 + 正文单元格）。

即，如果一列或多列的单元格中的所有值都是 0.00/-，则应删除整列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T00:26:20.367

我假设您的意思不是说该列的所有数据单元格是否都是 0.00/- 然后删除它，而不仅仅是其中一个。如果我有误解，请告知，我会相应地更新解决方案样式表。

创建表格有很多不同的方法和选项，因此您的解决方案需要根据表格的类型和结构进行调整。这里显示的是一种简单表格形式的解决方案。

# XSLT 1.0 解决方案

这个 XSLT 1.0 样式表...

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes"/>
<xsl:strip-space elements="*"/>

<xsl:template name="ident" match="@*|node()">
 <xsl:copy>
   <xsl:apply-templates select="@*|node()"/>
 </xsl:copy>
</xsl:template>

<xsl:template match="td">
  <xsl:variable name="col" select="count(preceding-sibling::td)+1" />
  <xsl:if test="../../tr/td[$col][. != '0.00'][. != '-']">
    <xsl:call-template name="ident" />
  </xsl:if>  
 </xsl:template>

</xsl:stylesheet> 
```

...当应用于此输入文档时...

```
<table>
  <th>
    <td>Contestant</td><td>Score</td><td>Country</td>
  </th> 
  <tr>
    <td>Jack</td><td>0.00</td><td>AUS</td>
  </tr> 
  <tr>
    <td>Jill</td><td>-</td><td>-</td>
  </tr> 
</table> 
```

...将产生...

```
<table>
  <th>
    <td>Contestant</td>
    <td>Country</td>
  </th>
  <tr>
    <td>Jack</td>
    <td>AUS</td>
  </tr>
  <tr>
    <td>Jill</td>
    <td>-</td>
  </tr>
</table> 
```

仅删除一列 - 包含所有“空”非标题单元格的一列。

# XSLT 2.0 解决方案

这是 XSLT 2.0 等价物...

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="xml" indent="yes"/>
<xsl:strip-space elements="*"/>

<xsl:template match="@*|node()">
 <xsl:copy>
   <xsl:apply-templates select="@*|node()"/>
 </xsl:copy>
</xsl:template>

<xsl:template match="td[ not(
  for $c in count(preceding-sibling::td)+1 return
    ../../tr/td[$c][.!='0.00'][.!= '-']  )]" />

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T03:42:54.027

**一、类似但更高效的 (O(N)) XSLT 1.0 解决方案**（Sean 的 XSLT 1.0 解决方案是 O(N^2)，其中 N 是列数）：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common" exclude-result-prefixes="ext">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:variable name="vrtfColProps">
  <xsl:for-each select="/*/tr[1]/td">
    <xsl:variable name="vPos" select="position()"/>
    <col pos="{$vPos}">
          <xsl:if test="/*/tr/td[$vPos][not(. = 0.00 or . ='-')]">
           1
          </xsl:if>
      </col>
      </xsl:for-each>
 </xsl:variable>

 <xsl:variable name="vColProps" select="ext:node-set($vrtfColProps)/*"/>

 <xsl:template match="node()|@*" name="identity">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="td">
  <xsl:variable name="vPos" select="position()"/>
  <xsl:if test="$vColProps[@pos=$vPos]/node()">
   <xsl:call-template name="identity"/>
  </xsl:if>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下文档时**：

```
<table border="1">
  <th>
   <tr>
    <td>Contestant</td><td>Score</td><td>Country</td>
   </tr>
  </th>
  <tr>
    <td>Jack</td><td>0.00</td><td>AUS</td>
  </tr>
  <tr>
    <td>Jill</td><td>-</td><td>-</td>
  </tr>
</table> 
```

**产生了想要的正确结果**：

```
<table border="1">
   <th>
      <tr>
         <td>Contestant</td>
         <td>Country</td>
      </tr>
   </th>
   <tr>
      <td>Jack</td>
      <td>AUS</td>
   </tr>
   <tr>
      <td>Jill</td>
      <td>-</td>
   </tr>
</table> 
```

* * *

**二、更高效（线性与 Sean 的二次复杂度）XSLT 2.0 解决方案：**

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:variable name="vColProps">
  <xsl:for-each select="/*/tr[1]/td">
    <xsl:variable name="vPos" select="position()"/>
    <col pos="{$vPos}">
          <xsl:if test="/*/tr/td[$vPos][not(. = '0.00' or . = '-')]">
           1
          </xsl:if>
      </col>
      </xsl:for-each>
 </xsl:variable>

 <xsl:template match="node()|@*" name="identity">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match=
 "td[for $vPos in position()
      return
         not($vColProps/*[@pos=$vPos]/node())
    ]"/>
</xsl:stylesheet> 
```

**当将此转换应用于同一个 XML 文档（上图）时，会产生相同的所需、正确的结果**：

```
<table border="1">
   <th>
      <tr>
         <td>Contestant</td>
         <td>Country</td>
      </tr>
   </th>
   <tr>
      <td>Jack</td>
      <td>AUS</td>
   </tr>
   <tr>
      <td>Jill</td>
      <td>-</td>
   </tr>
</table> 
```

# java - 泛型类在 Java 6 中编译，但不是 Java 7

> ID：12206181
> 
> 赞同：17
> 
> 时间：2012-08-30T22:00:19.357
> 
> 标签：java, generics, collections, java-7, java-6

我在 Java 6 中有一个可以正确编译的接口：

```
public interface IMultiMap<K, V> extends Map<K, Set<V>> {

    public int valueSize();

    public boolean put(K key, V value);

    public void clear(Object key);

    public boolean isEmpty(Object key);
} 
```

但是在 Java 7 中，这个接口不能编译。我收到一个编译错误`boolean put(K, V)`，它与`V put(K, V)`. 编译器的完整错误：

```
error: name clash: put(K#1,V#1) in IMultiMap and put(K#2,V#2) in Map have the same erasure, yet neither overrides the other
    public boolean put(K key, V value);
  where K#1,V#1,K#2,V#2 are type-variables:
    K#1 extends Object declared in interface IMultiMap
    V#1 extends Object declared in interface IMultiMap
    K#2 extends Object declared in interface Map
    V#2 extends Object declared in interface Map 
```

作为记录，添加任何类型的覆盖都不起作用。我尝试显式覆盖`Map.put`，但仍然出现错误。更改 my 的返回类型`put`没有实际意义，因为此错误阻止了该潜在错误的发生，并且如果此错误已修复，那么这两种方法无论如何都不会具有相同的名称/参数签名。

我想我可能会尝试对 Java 6 进行一些反思，看看实际参数类型最终会出现在 Java 6 的编译字节码中。很明显，这两种 Java 7 方法都被删除为`put(Object, Object)`. 一旦我这样做，我会在这里发布反射结果。

同时，我的临时解决方法只是重命名`put`为`putSingle`，但这种新行为是否正确？Java 7 的某些泛型规范是否发生了更改，导致旧的 Java 6 行为错误？或者这是 Java 7 编译器中的错误？

提前致谢。

**编辑：**我运行了反射代码。在下面查看我的答案。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-30T22:14:27.543

我认为这是在 1.7 中修复的 1.6 中的错误。[从此页面](http://www.oracle.com/technetwork/java/javase/compatibility-417013.html#jdk7)摘录：

> **概要：**一个类不能定义两个具有相同擦除签名但返回类型不同的方法
> **描述：**一个类不能定义两个具有相同擦除签名的方法，无论返回类型是否相同。这来自 JLS，Java SE 7 版，第 8.4.8.3 节。JDK 6 编译器允许具有相同擦除签名但返回类型不同的方法；此行为不正确，已在 JDK 7 中修复。
> **示例：**

```
class A {
   int m(List<String> ls) { return 0; }
   long m(List<Integer> ls) { return 1; }
} 
```

> 此代码在 JDK 5.0 和 JDK 6 下编译，在 JDK 7 下被拒绝。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:31:19.390

我在 Java 6 上运行了反射代码。

这是代码：

```
public static void main(String[] args) {
    Class<IMultiMap> immClass = IMultiMap.class;
    Method[] methods = immClass.getMethods();
    for (Method method : methods) {
        if (method.getName().equals("put"))
            System.out.println(method.toString());
    }
} 
```

以下是该类的方法签名：

```
public abstract boolean IMultiMap.put(java.lang.Object,java.lang.Object)
public abstract java.lang.Object java.util.Map.put(java.lang.Object,java.lang.Object) 
```

或更简洁地说：

```
boolean put(Object, Object)
Object  put(Object, Object) 
```

因此它们被擦除为具有不同返回类型的相同参数。根据 assylias 的回答，我猜这是Java 6 JLS 中未指定的边缘情况~~的错误。~~我想知道 Java 6 如何在运行时正确解析这些方法？

**编辑：**根据 x4u 的评论，调用字节码在编译时维护对*整个*签名的引用，这就是 JVM 调用正确方法的原因。由于编译器可能能够通过访问源代码（从而访问泛型信息）来判断我正在调用哪个方法，因此编译器可能通过整个签名将其链接到正确的方法。很有趣知道！

# firefox - 托管在我的域上的 Firefox 插件不会自动更新

> ID：12206188
> 
> 赞同：0
> 
> 时间：2012-08-30T22:00:56.307
> 
> 标签：firefox, firefox-addon, firefox-addon-sdk

由于我们还没有准备好将我们的插件加载到应用商店，我们决定将它托管在我们的服务器上。手动检查更新时，会选择更新并安装正确的版本。根据我所阅读的内容，Firefox 应该每天至少检查一次插件更新。已经 3 天了，插件还没有更新，但如上所述，当我手动检查更新时它会更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T04:01:27.790

我也注意到了这种行为，但我认为这是因为浏览器会在检查更新之前检查它是否真的在使用中。即，如果您只是将其打开而不使用它，则不会发生更新。我怀疑这是因为我可以看到我的用户正在获取我的更新。

您可以尝试使用浏览器一天，看看它是否更新。

# bash - 来自 Windows 桌面的 cygwin ssh 快捷方式

> ID：12206190
> 
> 赞同：12
> 
> 时间：2012-08-30T22:00:59.760
> 
> 标签：bash, windows-7, ssh, cygwin

我有多个需要远程访问的服务器。我更喜欢 Cygwin 而不是 Putty 这样做。

无论如何 - 打开我很酷的 Mintty 窗口然后输入以下命令的过程需要太长时间。PS - 我正在对这些服务器使用“密钥”身份验证。

首先，我从 Windows 桌面双击 Cygwin 终端快捷方式。

然后，一旦终端会话启动，从命令提示符输入以下内容 -

```
$ eval `ssh-agent`
$ ssh-add
$ ssh <username>@<servername> 
```

请记住，我的“服务器名”是可变的。事实上，我有大约 10 个不同的服务器名称可能会插入其中 - 因此我需要 10 个不同的快捷方式。我宁愿双击桌面上的某个东西，它会启动我的 Mintty 并自动执行上述 bash shell 命令。

有没有人有或可以推荐一个很好/优雅的解决方案来做到这一点？

（我感觉它与我点击的 Windows 快捷图标的 Target 属性有关。）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-31T12:39:19.843

你可以毫不费力地做到这一点。复制现有的 Cygwin 终端图标，右键单击它，然后选择属性。您应该在“目标”字段中看到类似以下内容：

```
C:\cygwin\bin\mintty.exe -i /Cygwin-Terminal.ico - 
```

将其替换为以下内容（替换`<username>`并`<servername>`视情况而定）：

```
C:\cygwin\bin\mintty.exe -i /Cygwin-Terminal.ico /bin/bash -l -c "eval `ssh-agent` ; ssh-add ; ssh <username>@<servername>" 
```

根据需要对您的其他服务器重复此操作。就是这样！

（细节：我们将`-`参数 [表示使用标准登录 shell] 替换为对 bash 的显式调用以运行您的命令。这`-l`部分表示使用登录 shell，这特别意味着您的`PATH`变量已设置，因此 bash 可以find `ssh`。该`-c`部分只是介绍了命令，您应该从您的问题中识别出来。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-31T16:25:07.967

为此，我执行了以下步骤：

第 1 步：创建一个目录，我在其中安装 Cygwin，称为脚本

第 2 步：在此目录中创建一个名为 servername.sh 的 BASH 脚本

第三步： servername.sh 将有以下内容（单行）：

```
eval `ssh-agent`;ssh-add;ssh user@servername 
```

（确保用适当的信息替换用户名和服务器名）

第 4 步：创建 Cygwin 终端图标的快捷方式

第 5 步：将其粘贴到我想要的位置（在我的桌面上 - 但您可以选择要放置的位置）。

第6步：右键单击并重命名我的快捷方式（将其命名为我的服务器名称）

第七步：右键选择属性

第 8 步：在目标属性部分，我有以下代码行 -

```
C:\Cygwin\bin\mintty.exe -e /bin/sh -l -c '/scripts/servername.sh' 
```

并确保您的路径与您的环境相匹配！

干杯。

# asp.net - SimpleMembershipProvider/WebSecurity 配置

> ID：12206192
> 
> 赞同：0
> 
> 时间：2012-08-30T22:01:34.543
> 
> 标签：asp.net, asp.net-membership, membership-provider

WebSecurity 类是否提供对密码失败次数的检查？如果是这样，这是在哪里配置的？

对于旧的成员资格提供程序，这可以在成员资格部分的 web.config 中进行配置。简单会员有类似的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T00:34:53.260

我不这么认为，SimpleMembership 基本上没有任何逻辑来自动锁定帐户。

相反，您可以通过以下方式确定锁定状态：

WebSecurity 的 IsAccountLockedOut 方法：

```
public static bool IsAccountLockedOut(string userName, int allowedPasswordAttempts, int intervalInSeconds) 
```

# php - 如何用php锁定mysql myisam表

> ID：12206193
> 
> 赞同：-2
> 
> 时间：2012-08-30T22:01:37.523
> 
> 标签：php, mysql

任何人都可以使用 2 个 php 脚本测试 mysql 表锁。和 mysql_query()。

我试了一天，但我无法锁定桌子。

我希望当一个 php 脚本使用 mysql 表时，所有其他脚本都无法访问它。

您能否提供 2 个经过简单测试的 php 脚本。如果你能展示他们是如何在线工作的，那就太完美了。

但应该是这样，当第一个脚本工作并锁定 mysql 表时，其他脚本应该等待轮到它。

就像队列一样，只有一个脚本可以同时访问 myisam mysql 表。但是请在回答之前测试您的脚本，因为我尝试了很多建议但没有任何效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:04:15.630

您不使用 PHP 锁定表。您确实使用 mysql 查询锁定。所以基本上你用[mysql docs中描述的](http://dev.mysql.com/doc/refman/5.0/en/lock-tables.html)语法进行查询，就是这样。例如：

```
mysqli_query("LOCK TABLES my_table READ"); 
```

并放弃`mysql_`支持`mysqli_`或`PDO`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:06:29.637

有两种锁。一个是@WebnetMobile.com 发布的内容。

另一种称为咨询锁——你竖起一个标志，每个人都必须在被允许访问之前检查这个标志。您可以在任何需要它的地方检查标志。但优点是您可以根据需要精确调整锁定。

此外，使用 InnoDB，您可以锁定表的特定行，而无需锁定整个表。

见：[http ://dev.mysql.com/doc/refman/5.0/en/innodb-locking-reads.html](http://dev.mysql.com/doc/refman/5.0/en/innodb-locking-reads.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T22:13:31.950

如果不是为了在事务级别管理复杂的数据库逻辑，我不建议明确锁定数据库表。查询仍然会被发送出去，但由于锁而失败，或者更糟糕的是，其他事务由于在错误的时间获取锁而死锁。

因此，您喜欢在应用程序中破坏任何表面上的性能。

编辑：

[http://dev.mysql.com/doc/refman/5.1/en/lock-tables.html](http://dev.mysql.com/doc/refman/5.1/en/lock-tables.html)

mysql 的文档详细说明了锁的操作方式。为使用它的会话获取锁，因此如果您希望您的会话无权访问某些表和别名，那么您希望锁定除您要拒绝会话访问的表之外的所有内容。

不确定您希望测试什么锁作为示例。

```
 define("READ_LOCK", 0)
       define("WRITE_LOCK",1) 
       function lock_on_to_tables ($Tables, $lockType=0)
       {
         $sql = "LOCK TABLES "
        foreach ($Tables as $table)
           $sql .=  $table . " ,";
         $sql = substr($sql, 0, -1); // cut off last comma
         $sql .= $lockType ? " WRITE" : " READ;
         mysqli_query($sql); // or pdo or whatever is in use.  
       } 
```

解锁只是

```
 mysqli_query("UNLOCK TABLES") ; 
```

# javascript - 我应该如何在 javascript 中实例化这个日期？

> ID：12206196
> 
> 赞同：1
> 
> 时间：2012-08-30T22:02:10.657
> 
> 标签：javascript

> **可能重复：**
> [在 Javascript 中格式化日期](https://stackoverflow.com/questions/4503504/format-date-in-javascript)

我有这个日期：

```
var newDate = "/Date(1333609200000)/"; 
```

我需要做的是：

```
var myDate = new Date(1333609200000); 
```

我想只是修剪一下`"/Date()/"`，然后只得到里面的数字，但我不确定这是否是最好的。我应该只是简单地正则表达式中的数字吗？有更好的方法吗？

注意：日期由 c# 创建`JavascriptSerializer`并采用上述格式`newDate`。由于约束，它不能在 c# 中更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:05:04.363

你可以这样做：

```
var newDate = "/Date(1333609200000)/";

 newDate= new Date(parseInt(newDate.match(/\d/g).join(""))); 
```

# java - 无法获取 UTC 格式的日期

> ID：12206199
> 
> 赞同：0
> 
> 时间：2012-08-30T22:02:21.263
> 
> 标签：java, calendar

我写了两个函数 -`today()`和`todayUTC()`- 作为：

```
public static Date today() {
  Calendar cal = Calendar.getInstance();
  return cal.getTime();
}

public static Date todayUTC() {
  Calendar cal = Calendar.getInstance(TimeZone.getTimeZone("UTC"));
  return cal.getTime();
} 
```

但是当我使用以下方法打印这些函数的结果时：

```
public void todayTest() {
  Date date1 = OOTBFunctions.today();
  System.out.println("today: "+date1);

  Date dateUTC1 = OOTBFunctions.todayUTC();
  System.out.println("todayUTC: "+dateUTC1);
} 
```

我看到两个语句都打印相同的值，即

```
today: Thu Aug 30 14:48:56 PDT 2012
todayUTC: Thu Aug 30 14:48:56 PDT 2012 
```

任何人都可以建议我在获取本地时区日期的 UTC 函数中缺少什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T22:03:52.780

Java 在打印时使用默认区域设置，这就是您看到该行为的原因。使用如下代码格式化并以您想要的语言环境/格式打印。记住

*   创建 Date 对象时，它始终采用 UTC。
*   在用户的区域设置中显示日期。
*   以 UTC 格式存储日期。

代码

```
final SimpleDateFormat sdf = new SimpleDateFormat("the format you want");
sdf.setTimeZone(TimeZone.getTimeZone("UTC"));
final String utcTime = sdf.format(new Date()); 
```

您不需要 today() 和 todayUTC() 方法。保持并喜欢下面

```
public static Date nowInUTC() 
{
  return new Date();
} 
```

你不需要测试任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:07:36.120

您的两种方法都将返回相同的值 -`Date`对象没有任何时区概念（与 a 不同`Calendar`）。A`Date` *仅*表示时间的瞬间，内部存储为自 UTC 时间 1970 年 1 月 1 日午夜以来的毫秒数。实际上，您有两种方法等效于：

```
return new Date(System.currentTimeMillis()); 
```

`Date.toString()`始终使用系统默认时区。

如果您想使用时区维护日期/时间，请考虑仅使用`Calendar`. 如果要在时区中格式化特定时刻，只需使用`SimpleDateFormat`设置时区。

理想情况下，改为使用[Joda Time](http://joda-time.sf.net)代替`Date`或`Calendar`虽然 - 这是一个更清洁的 API。

# objective-c - Xcode 为什么我的 UISwitch 一段时间后不起作用？

> ID：12206201
> 
> 赞同：2
> 
> 时间：2012-08-30T22:02:36.587
> 
> 标签：objective-c, ios, xcode, uiswitch

我在我的一个选项卡式应用程序中使用 UISwitch。UISwitch 位于屏幕底部。当我第一次启动应用程序时，开关工作正常。我可以从纵向旋转到横向，一切正常。我什至可以转到其他选项卡并返回，并且该开关仍然可以在横向和纵向中使用。但是，如果我在选项卡之间来回切换五次，则该开关以纵向工作，而不是横向工作。有没有人见过或听说过这个？有人知道这可能发生的原因吗？我用过

```
[infoSwitch setOn:NO]; 
```

在我看来WillAppear，这样开关总是开始关闭。关于使用开关，我有什么遗漏吗？我做了与过去相同的事情来让开关正常工作。任何帮助都感激不尽！再次感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:45:23.673

`UIView`s 可能是可见的，但如果它们超出其父视图的范围，将无法获得输入。所以第一个诊断是给父视图一些明显的花哨的颜色，这样你就可以明显地看到它的边界，然后尝试你的旋转和切换，看看你是否可以在那里强制出错。

您还可以设置`clipsToBounds`为`YES`确保视图不显示超出范围的子视图。

# asp.net-mvc-4 - 使用模型绑定从 RC 到 RTM 的 Web API 路由错误

> ID：12206207
> 
> 赞同：0
> 
> 时间：2012-08-30T22:02:59.830
> 
> 标签：asp.net-mvc-4, asp.net-web-api

将 rc 升级到 rtm web api 项目

> 简单类型参数的默认参数绑定现在是 [FromUri]：在以前版本的 ASP.NET Web API 中，简单类型参数的默认参数绑定使用模型绑定。简单类型参数的默认参数绑定现在是 [FromUri]。

我相信是导致我 greif 的变化。

好吧，现在我不太确定。[StrathWeb](http://www.strathweb.com/2012/08/asp-net-web-api-is-released-whats-new-in-web-api-rtm-and-how-to-use-it/)似乎让我觉得它应该按原样工作。

鉴于此端点

```
 [HttpGet]
    public HttpResponseMessage Method(string a, string b)
    {
     ...
    } 
```

我使用在客户端上生成一个 url

```
@Url.RouteUrl("route", new { httproute = "", controller = "Controller", version = "1" })"> 
```

让它为这条路线生成 url。

```
routes.MapHttpRoute(
name: "route",
routeTemplate: "api/v{version}/{controller}/Method",
defaults: new
{
    action = "Method",
    controller = "Controller",
    version = "1"
}); 
```

它可以很好地创建 url。网址看起来像

```
.../api/v1/Controller/Method?optional=z
.../api/v1/Controller/Method?a=x&b=y&optional=z 
```

它在请求时抛出 404。如果我删除 api 控制器中的参数 a 和 b ，那么它就可以很好地进入方法。

使这些绑定的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T22:47:40.470

如果您需要 'a' 和 'b' 是可选的，那么您需要将它们设为可选参数：

公共 HttpResponseMessage 方法（字符串 a **= null**，字符串 b **= null**）

# javascript - xml 文件在哪里适合 js 项目目录结构？

> ID：12206215
> 
> 赞同：0
> 
> 时间：2012-08-30T22:03:32.073
> 
> 标签：javascript, xml, version-control, architecture, organization

我正在开发一个遵循此目录结构的 js 项目：

```
/doc
/src
/test
/etc 
```

这个客户端 js 应用程序可以由服务器应用程序（一个完全独立的应用程序）通过 json 配置。我们使用一些 xml 文件为该 json 数据定义结构、属性、属性描述和允许的属性值。这些 xml 文件由服务器应用程序解析，因此它可以发送正确的 json 对象。

我应该为这些 xml 创建一个新的“dist”目录，因为它们被分发到服务器应用程序团队。或者我应该将它们放在我的 doc 目录中，因为它们以某种方式记录了服务器和客户端应用程序之间的接口。还是我应该做一些不同的事情？我正在寻求最佳实践。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T23:35:00.897

听起来这些文件是一种资源，所以我会将它们放在一个`resource`目录下。可能类似于`/src/resource`or `/resource`。

# imagemagick - 使用 ImageMagick 高效生成缩略图并进行转换

> ID：12206217
> 
> 赞同：12
> 
> 时间：2012-08-30T22:03:38.073
> 
> 标签：imagemagick, thumbnails, imagemagick-convert

我希望在 Python 中使用 ImageMagick 的转换实用程序有效地生成各种大小的缩略图。我的一些图像文件非常大（~15MB JPG）。

我可以做到的一种方法是获取全尺寸图像，并从全尺寸图像生成各种缩略图，如下所示：

```
convert sample_image.jpg -resize 1024x768  sample_image-1024x768.jpg
convert sample_image.jpg -resize 800x600   sample_image-800x600.jpg
convert sample_image.jpg -resize 400x300   sample_image-400x300.jpg
convert sample_image.jpg -resize 200x150   sample_image-200x150.jpg 
```

但另一种方法是相互调整图像的大小：

```
convert sample_image.jpg           -resize 1024x768  sample_image-1024x768.jpg
convert sample_image-1024x768.jpg  -resize 800x600   sample_image-800x600.jpg
convert sample_image-800x600.jpg   -resize 400x300   sample_image-400x300.jpg
convert sample_image-400x300.jpg   -resize 200x150   sample_image-200x150.jpg 
```

这样做有什么缺点，或者可能有更好的方法吗？看起来这样会更有效率。

作为推论，是否有任何标志或“技巧”转换用于加速该过程？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-02T10:44:40.633

ImageMagick 有一些技巧可以帮助您在想要处理大图像以及想要从相同的原始图像创建不同的输出时优化速度：

1.  利用 ImageMagick 的`mpr:{name}`功能，它可以将输入图像临时保存到一个命名的*内存程序寄存器*中，以后（在处理时）从中读取数据的速度比从硬盘读取的快得多。

2.  *在一个进程*中执行所有调整大小操作，写出您需要的不同输出大小。

更好的消息是您可以将这两者组合成一个命令。

因此，您不需要运行多个进程以及它们的所有上下文切换开销——一次完成所有操作。

以下示例还从原始图像中裁剪了两个单独的区域，并从中创建了重新调整大小的缩略图，只是为了显示 IM 可以在一个命令行中执行多少不同的操作。当然，它还会输出您要求的尺寸。（当然，您需要一个非常大尺寸的输入图像才能使裁剪参数起作用）。

```
convert                           \
  huge-original.jpg               \
 -quality 80                      \
 -colorspace rgb                  \
 +profile '*'                     \
 -filter Lanczos                  \
 -write mpr:copy-of-huge-original \
 +delete                          \
  mpr:copy-of-huge-original -crop '3000x2000+0+480'   -resize '200x125!>' -write thumb1-extract.jpg +delete \
  mpr:copy-of-huge-original -crop '2000x1500+280+220' -resize '75x75!>'   -write thumb2-extract.jpg +delete \
  mpr:copy-of-huge-original -resize '1024x768'  -write sample-1024x768.jpg +delete \
  mpr:copy-of-huge-original -resize '800x600'   -write sample-800x600.jpg  +delete \
  mpr:copy-of-huge-original -resize '400x300'   -write sample-400x300.jpg  +delete \
  mpr:copy-of-huge-original -resize '200x150'   -write sample-200x150.jpg  +delete \
  mpr:copy-of-huge-original -resize '163x163!>' -write sample-163x163.jpg 
```

* * *

## 更新

我现在才看到@JonathanOng 提出的问题：如何将输出流式传输到`<stdout>`？

假设，您希望标准输出的格式也是 JPEG，您可以试试这个：

```
convert                           \
  huge-original.jpg               \
 -quality 80                      \
 -colorspace rgb                  \
 +profile '*'                     \
 -filter Lanczos                  \
 +write mpr:copy-of-huge-original \
  mpr:copy-of-huge-original -crop '3000x2000+0+480'   -resize '200x125!>' +write thumb1-extract.jpg \
  mpr:copy-of-huge-original -crop '2000x1500+280+220' -resize '75x75!>'   +write thumb2-extract.jpg \
  mpr:copy-of-huge-original -resize '1024x768'  +write jpeg:- \
  mpr:copy-of-huge-original -resize '800x600'   +write jpeg:- \
  mpr:copy-of-huge-original -resize '400x300'   +write jpeg:- \
  mpr:copy-of-huge-original -resize '200x150'   +write jpeg:- \
  mpr:copy-of-huge-original -resize '163x163!>' +write jpeg:- 
```

这样每个变体都会进入标准输出。那么，如何处理这些连续图像流取决于您...

***请注意***，`-write filename +delete`您可以使用`+write filename`. 这相当于相同的效果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-16T14:40:13.640

我尝试[`vipsthumbnail`](http://www.vips.ecs.soton.ac.uk/)针对@KurtPfeifle 的出色回答进行计时。我使用 10k x 10k 像素的 RGB JPG 图像（大约 15MB）运行它：

```
convert                           \
  /data/john/pics/wtc.jpg         \
 -quality 80                      \
 -colorspace rgb                  \
 +profile '*'                     \
 -filter Lanczos                  \
 -write mpr:copy-of-huge-original \
 +delete                          \
  mpr:copy-of-huge-original -resize '1024x768'  -write sample-1024x768.jpg +delete \
  mpr:copy-of-huge-original -resize '800x600'   -write sample-800x600.jpg  +delete \
  mpr:copy-of-huge-original -resize '400x300'   -write sample-400x300.jpg  +delete \
  mpr:copy-of-huge-original -resize '200x150'   -write sample-200x150.jpg  +delete \
  mpr:copy-of-huge-original -resize '163x163!>' -write sample-163x163.jpg  x.jpg 
```

我发现我`x.jpg`最后需要额外的，我不知道为什么。在这台机器上（E5-1650 3.2 GHz，IM 6.8.9-9）我看到：

```
$ time ./m.sh 
real    0m6.560s
user    0m31.908s
sys     0m0.264s
peak RES 711MB 
```

这（我认为）相当于`vipsthumbnail`：

```
img=/data/john/pics/wtc.jpg
icc=/usr/share/color/argyll/ref/sRGB.icm

for size in 1024x768 800x600 400x300 200x150 163x163; do
  vipsthumbnail $img --size $size --eprofile $icc -o vips-sample-$size.jpg[Q=80]
done 
```

`vipsthumbnail`默认为 Lanczos3。用 vips-8.4.4 计时我看到：

```
$ time ./n.sh
real    0m2.376s
user    0m2.412s
sys     0m0.108s
peak RES 70MB 
```

所以一个有用的加速，和内存使用的大幅下降。

因为内存使用率很低，所以您可以`vipsthumbnail`并行运行许多而不杀死您的服务器。如果我将脚本更改为：

```
img=/data/john/pics/wtc.jpg
icc=/usr/share/color/argyll/ref/sRGB.icm

parallel vipsthumbnail $img \
  --size {} --eprofile $icc -o vips-sample-{}.jpg[Q=80] ::: \
  1024x768 800x600 400x300 200x150 163x163 
```

我现在看到：

```
$ time ./n.sh 
real    0m0.593s
user    0m1.960s
sys     0m0.100s
peak RES 280MB 
```

比 ImageMagick 快 10 倍以上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T22:23:46.513

在我看来，经过测试，将 1024x768 的大小调整为 800x600 对重新缩放算法不利。由于整数 (2) 的倍数，下一次调整大小更容易。

所以，出于质量原因，我个人认为，这更好：

```
convert sample_image.jpg -resize 1024x768  sample_image-1024x768.jpg
convert sample_image.jpg -resize 800x600   sample_image-800x600.jpg
convert sample_image-800x600.jpg   -resize 400x300   sample_image-400x300.jpg
convert sample_image-400x300.jpg   -resize 200x150   sample_image-200x150.jpg 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-02T09:38:47.600

15MB JPG 真的很大。[我会首先使用最快的“ -sample](http://www.imagemagick.org/script/command-line-options.php?#sample) ”参数将其调整为合理的大小（比如 2500x2500），然后将这个较小的图像调整为不同的缩略图。

您可以根据图像大小做出明智的决定，并选择正确的调整大小方式。

我建议关注缩略图质量而不是转换速度，因此请查看不同的过滤器 ( [-filter](http://www.imagemagick.org/script/command-line-options.php#filter) )、锐化 ( [-unsharp](http://www.imagemagick.org/script/command-line-options.php#unsharp) ) 和[推荐的下采样方法](http://www.imagemagick.org/Usage/resize/#nicolas_downsample)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-12T17:36:43.430

我正在缩略图〜50MB JPG文件。产生最大差异的一个选项（约 5 倍加速）是在输入文件名*之前的“-define jpeg:size 128x128”。*这里给出的例子：

[http://www.imagemagick.org/Usage/formats/#jpg_read](http://www.imagemagick.org/Usage/formats/#jpg_read)

...产生了巨大的变化：

```
convert -define jpeg:size=128x128 jpeg_large.jpg -thumbnail 64x64  jpeg_thumbnail.jpg 
```

-define jpeg:size 允许 ImageMagick 仅从磁盘读取所需的数据，这大大减少了非常大的图像的加载时间。

正如链接页面所建议的那样，使用两倍于最终缩略图大小的 jpeg:size= 以避免混叠。

-thumbnail 选项，在此处描述：

[http://www.imagemagick.org/Usage/resize/#thumbnail](http://www.imagemagick.org/Usage/resize/#thumbnail)

...对图像进行采样和剥离，进一步加快处理速度。

# ios - NSDateComponents 的 NSLog 分秒 - 如何显示前导零？

> ID：12206223
> 
> 赞同：4
> 
> 时间：2012-08-30T22:04:11.887
> 
> 标签：ios, xcode

我真的需要帮助。代码结果是`2:0:0`格式设置为`hh:mm:ss`. 我希望结果是`2:00:00`（`0`在分钟和秒的前面加上`10`）。

```
NSDateFormatter *test = [[NSDateFormatter alloc] init];
[test setDateFormat:@"HH:mm:ss"];
NSDate *date1 = [test dateFromString:@"18:00:00"];
NSDate *date2 = [test dateFromString:@"20:00:00"];
NSCalendar* gregorian = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
unsigned int uintFlags =  NSHourCalendarUnit | NSMinuteCalendarUnit | NSSecondCalendarUnit;
NSDateComponents* differenceComponents = [gregorian components:uintFlags fromDate:date1 toDate:date2 options:0];

NSLog(@"%d:%d:%d",[differenceComponents hour],[differenceComponents minute],[differenceComponents second]); 
```

这该怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T00:42:40.033

使用说明`%02ld`符记录，例如：

```
NSLog(@"%ld:%02ld:%02ld",[differenceComponents hour],[differenceComponents minute],[differenceComponents second]); 
```

输出：

```
2:00:00 
```

另外`NSStrings`像这样创建：

```
NSString *theString = [NSString stringWithFormat:@"%ld:%02ld:%02ld",[differenceComponents hour],[differenceComponents minute],[differenceComponents second]];
NSLog(@"%@",theString); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T00:40:28.577

问题是：00-00 是 0。我曾经有这个问题并这样解决

```
-(NSString*)formatIntToString:(int)inInt{
if (inInt <10) {
    NSString *theString = [NSString stringWithFormat:@"0%d",inInt];
    return theString;
}
else {
    NSString *theString = [NSString stringWithFormat:@"%d",inInt];
    return theString;
}} 
```

在你的 NSLog 中像这样使用它：

```
NSLog(@"%@:%@:%@",[self formatIntToString:[differenceComponents hour]],[self formatIntToString:[differenceComponents minute]],[self formatIntToString:[differenceComponents second]]); 
```

# matlab - matlab fprintf 处理 *.c 文件

> ID：12206229
> 
> 赞同：2
> 
> 时间：2012-08-30T22:04:36.983
> 
> 标签：matlab, printf

我想要的只是读取 *.c 文件，删除标题，更改标题并将文件保存为 *.c 格式。我使用“fprintf”，问题出在 *.c 文件中有一些带有“\n”的 printf，fprintf 将其解释为新行:(，我最终得到了一个损坏的 *.c 文件。有吗一种使用 matlab 命令处理 *.c 文件的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T01:27:29.290

读取文件后，应将`\`字符替换为 ，再次写入文件时`\\`将转换回该字符。非常适合：`\``strrep`

```
str = 'a\nb';
str = strrep(str,'\','\\');
fprintf(str)

a\nb 
```

（请注意，`fprintf`没有文件标识符会打印到命令行。对调试非常有用）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-14T21:06:57.380

不要将用户提供的数据作为格式字符串传递，这将被解释。相反，将其作为数据参数传递。像这样的东西应该工作：

```
fprintf(file_id, '%s', the_c_source_code); 
```

# php - 如何让用户在列表中的任何位置插入？

> ID：12206233
> 
> 赞同：1
> 
> 时间：2012-08-30T22:04:51.860
> 
> 标签：php, mysql, algorithm, sorting

我有一个存储在数据库中的项目列表。每个项目都有一个 id 列、一个标题和一个位置列 (int)。

默认情况下，每当用户向列表中添加新项目时，其 id 都会放在该位置。因此，如果您有 3 个项目，ID 为 1、2、3，它们的位置也将是 1、2、3。

然后在获取职位时，我将`ORDER BY position ASC`在我的 SQL 查询中进行。

问题是，用户想要一个可以在现有项目中的任何位置添加新项目的功能。

因此，如果您的项目 1、2、3 的位置为 1、2、3，他可以选择在位置 2 添加一个新项目，这将导致项目 1、2、3、4 的位置为：1 3 4 2

所以项目#4将被放置在位置2，项目#2和3将被推到位置3和4，等等。

完成此插入的最简单/最有效的算法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T22:19:57.403

从代码的角度来看，最简单的方法是使用链表样式，其中您有一个下一个元素 id，而不是一个订单值。这在小型列表中不太有用，但是当您开始增加列表大小时，它会使更新/移动/删除更加干净，并防止可能更新数千个元组以进行 1 个订单更改。

++ 我手头没有确切的代码示例，但您可以调用用户的所有列表

```
SELECT Posts.id, Posts.next, Posts.content, User.firstPost FROM db.posts AS Posts 
JOIN db.user as User ON Posts.ownerid = User.id 
WHERE User.id='123' AND Posts.active = 1; 
```

这将获取单个用户的所有帖子，然后您将拥有一个包含下一个帖子 id 的字段。首先，您需要一个密钥来识别第一篇文章（将第一篇文章的 id 存储在用户信息中）。拉出第一个帖子后，您获取它的“下一个”值，并使用它来识别下一个帖子。

对于一个简短的列表来说，这似乎有点疯狂，但想想一个有 1000 个帖子的用户。如果他们需要在第二个位置添加 1 个帖子。在传统的数字排序系统中，您现在需要使用 +1 更新来更新 999 行。使用此解决方案，如果您需要在第二个位置插入帖子，您只需查询第一个帖子以获取它的下一个值。获得后，将其更改为新的第二个帖子的值，并将第二个帖子的下一个值设置为第一个帖子最初持有的值。

```
[1st Post] --Next---> [2nd Post] --Next---> [3rd Post] 
```

插入后：

```
[1st Post] -.                          .--> [2nd Post] --Next---> [3rd Post]
            `--Next--> [New 2nd Post]--` 
```

# backbone.js - 使用 Backbone.Marionette 在 CompositeView 上渲染事件之后

> ID：12206235
> 
> 赞同：5
> 
> 时间：2012-08-30T22:05:08.070
> 
> 标签：backbone.js, marionette

我有一个带有搜索面板和结果数据集合的 Marionette CompositeView。

我想在以下情况下调用一个函数：

*   呈现搜索面板。
*   该集合尚未呈现。
*   呈现集合时不应调用此函数。

我是这样做的：（但是“afterRender”函数被调用了两次）

```
// VIEW
App.MyComposite.View = Backbone.Marionette.CompositeView.extend({
    // TEMPLATE
    template: Handlebars.compile(templates.find('#composite-template').html()),
    // ITEM VIEW
    itemView: App.Item.View,
    // ITEM VIEW CONTAINER
    itemViewContainer: '#collection-block',

    //INITIALIZE
    initialize: function() {        
        this.bindTo(this,'render',this.afterRender);
    },

    afterRender: function () {
        //THIS IS EXECUTED TWICE...
    }

}); 
```

我怎样才能做到这一点？

===========================编辑======================= ===========

我以这种方式解决了它，如果您有任何观察，请告诉我。

```
// VIEW
App.MyComposite.View = Backbone.Marionette.CompositeView.extend({

    //INITIALIZE
    initialize: function() {        
        //this.bindTo(this,'render',this.afterRender);
        this.firstRender = true;
    },

    onRender: function () {
        if (firstRender) {
            //DO STUFF HERE..............
            this.firstRender = false;         

        }
    }

}); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-31T11:58:24.057

Marionette 提供了一个`onRender`内置于所有视图的方法，因此您可以摆脱`this.bindTo(this, 'render', this.afterRender)`调用：

```
 // VIEW
App.MyComposite.View = Backbone.Marionette.CompositeView.extend({
    // TEMPLATE
    template: Handlebars.compile(templates.find('#composite-template').html()),
    // ITEM VIEW
    itemView: App.Item.View,
    // ITEM VIEW CONTAINER
    itemViewContainer: '#collection-block',

    //INITIALIZE
    initialize: function() {        
        // this.bindTo(this,'render',this.afterRender); // <-- not needed
    },

    onRender: function () {
        // do stuff after it renders, here
    }

}); 
```

但是要让它在集合未呈现时不执行工作，您必须向 onRender 方法添加逻辑，以检查集合是否已呈现。

这在很大程度上取决于您在集合中没有呈现任何项目时尝试对呈现进行的操作。

例如...如果您想呈现“No Items Found”消息，您可以使用`emptyView`复合视图的内置配置。

```
 NoItemsFoundView = ItemView.extend({
  // ...
});

CompositeView.extend({

  emptyView: NoItemsFoundView

}); 
```

但是，如果您有一些特殊的代码需要运行并执行此选项未涵盖的某些事情，那么您必须放入一些您自己的逻辑。

```
 CompositeView.extend({

  onRender: function(){
    if (this.collection && this.collection.length === 0) {
      // do stuff here because the collection was not rendered
    }
  }

}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-04-01T16:27:37.593

只需使用`onShow`功能

```
Backbone.Marionette.ItemView.extend({
  onShow: function(){
    // react to when a view has been shown
  }
}); 
```

[http://marionettejs.com/docs/marionette.view.html#view-onshow](http://marionettejs.com/docs/marionette.view.html#view-onshow)

# c++ - 将 std::stack .pop() 方法的结果存储到变量中

> ID：12206242
> 
> 赞同：38
> 
> 时间：2012-08-30T22:05:45.647
> 
> 标签：c++, stack

我想做以下事情：

```
std::stack <int> s;
int h = 0;
s.push(2);
h = s.pop(); 
```

比如`h`保持值2。当我尝试我的方法时，我得到“空值没有被忽略”。

这不是`.pop()`方法的意图吗？这样做的首选方法是什么？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-08-30T22:17:11.283

标准库容器分开`top()`:`pop()`返回`top()`对顶部元素的引用，并`pop()`删除顶部元素。（同样适用于`back()`/`pop_back()`等）。

这种分离有一个很好的理由，而不是`pop`删除顶部元素*并*返回它：C++ 的一个指导原则是你不需要为你不需要的东西付费。单个函数别无选择，只能按值返回元素，这可能是不受欢迎的。分离关注点为用户提供了如何使用数据结构的最大灵活性。（参见[原始 STL 文档中的](http://www.sgi.com/tech/stl/stack.html)注释 #3 。）

（奇怪的是，您可能会注意到，对于*并发*容器， -like`pop`函数实际上*被迫*以原子方式删除并返回顶部值，因为在并发上下文中，没有“在顶部”（或“是空的”）。这是并发数据结构如何为提供保证而遭受重大性能损失的明显示例之一。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-19T13:19:42.050

您可以使用：

```
h = s.top(); 
```

然后在那次使用之后（如果你想删除最近的值，否则什么都不做）

```
 s.pop(); 
```

它的工作方式相同！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-07-10T12:36:50.203

您实际上可以使用`s.top()`来存储元素，然后使用弹出它

```
s.pop(). 
```

采用

```
int h=s.top();
s.pop() 
```

代替

```
int h=s.pop() 
```

您不能直接分配`s.pop()`给某些数据类型，因为`s.pop()`从堆栈中删除元素并且不返回任何内容。

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2015-11-24T16:59:49.123

`S.pop()`不返回任何值。因为`pop()`是void函数。如果您想查看堆栈的顶部，那么它将是`S.top()`. 如果您存储此值，则写入`value = S.top()`.

# objective-c - Objective-C中的'while'循环

> ID：12206247
> 
> 赞同：1
> 
> 时间：2012-08-30T22:06:37.780
> 
> 标签：objective-c, loops, while-loop

下面的程序计算并删除一个数字的余数，将计算出的余数相加并显示出来。

```
#import <Foundation/Foundation.h>
int main (int argc, char * argv[]) {
    @autoreleasepool {
        int number, remainder, total;
        NSLog(@"Enter your number");
        scanf("%i", &number);

        while (number != 0)
        {
            remainder = number % 10;
            total += remainder;
            number /= 10;
        }
        NSLog(@"%i", total);    
    }
    return 0;
} 
```

我的问题是：

1.  为什么程序设置为只要数字不等于0就继续？只要余数不等于0，它不应该继续吗？

2.  什么时候从 的值中丢弃余数`number`？为什么之前没有`number -= remainder`声明`n /=10`？

[额外问题：Objective-C 变得更容易理解了吗？]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:16:35.860

1.  我们继续 until`number != 0`而不是使用余数的原因是，如果我们的输入可以被`10`精确整除，那么我们就不会得到正确的输出（以 10 为底的数字之和）。

2.  由于整数除法，余数被丢弃。请记住，整数不能保留小数位，因此当我们将 16 除以 10 时，我们得到的不是 1.6，而是 1。

是的，随着时间的推移，Objective-C 确实变得更容易了（但是，作为旁注，这绝对使用了 Objective-C 的 0 个特性，所以它基本上是带有`NSLog`调用的 C）。

请注意，输出并不总是您所期望的，但是，就像在 C / ObjC 中一样，（与 D 或 JS 等语言不同）变量并不总是初始化为设定值（在这种情况下，您假设0)。这可能会导致 UB 走下坡路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:22:48.793

1.  它检查数字是否不等于零，因为余数很可能永远不会为零。如果我们输入 5 作为我们的输入值，第一次通过循环的余数将被设置为 5（因为 5 % 10 = 5），并且由于 5 / 10 = 0.5 和 ints 不存储，所以 number 将变为零浮点值，因此 .5 将被截断，数字的值将等于零。
2.  余数不会从此代码中的 number 值中删除。我认为您可能对模运算符的作用感到困惑（请参阅[此解释](http://en.wikipedia.org/wiki/Modulo_operation)）。

奖励答案：一开始学习编程语言很困难，但从长远来看是非常有益的（如果你坚持下去的话）。您在第一次学习之后学习的每种新语言也很可能更容易学习，因为您将了解一般的编程结构和实践。祝你的努力好运！

# java - 如何使用关闭挂钩优雅地停止 Guava AbstractScheduledService？

> ID：12206248
> 
> 赞同：4
> 
> 时间：2012-08-30T22:06:52.583
> 
> 标签：java, multithreading, service, guava, shutdown-hook

我正在使用带有调度程序的 AbstractScheduledService。一个简单的模式，如：

```
class MyService extends AbstractScheduledService {

   // KEEP THIS VAR IN MIND W.R.T the SHUTDOWN_HOOK BELOW
   public static volatile boolean keepRunning = true;

   protected void startUp() throws Exception {
     // startup stuff
   }

   protected void runOneIteration() throws Exception {
     // main logic stuff
   }

   protected void shutDown() throws Exception {
     // shutdown stuff
   }

   protected Scheduler scheduler() {
     return Scheduler.newFixedRateSchedule(0, 1, TimeUnit.SECONDS);
   }
 } 
```

现在，我想像这样实现一个典型的关闭钩子：（下面的代码片段将在 main 方法中）

```
final Thread mainThread = Thread.currentThread();
        LOGGER.debug("Adding the shutdown hook");
        Runtime.getRuntime().addShutdownHook(new Thread() {
            @Override
            public void run() {
                keepRunning = false;
                LOGGER.debug("The shutdown hook was engaged. Setting keepRunnning to false.");
                try {
                     // Is this appropriate?
                     mainThread.join();
                } catch (InterruptedException e) {
                    // handle exception here
                }
            }
        }); 
```

关闭挂钩来自典型的文档示例。它似乎不适用于 Guava 服务模式，因为服务本身运行在不同的线程上。

我的服务在 runOneIteration() 逻辑中有一个轮询循环。我希望它完成手头的当前任务，然后在看到 keepRunning 现在为假时优雅地关闭，因为 Shutdown 钩子在最近一段时间忙于当前迭代时被使用。

有什么想法可以优雅地完成（完成当前迭代然后关闭）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T13:13:56.747

你不会直接调用 stopAndWait() 吗？

```
Runtime.getRuntime().addShutdownHook(new Thread() {
        @Override
        public void run() {
            service.stopAsync().awaitTerminated(60, TimeUnit.SECONDS);
        }
}); 
```

# python - Django 中间件：无法让 urlredirect 工作

> ID：12206249
> 
> 赞同：2
> 
> 时间：2012-08-30T22:07:06.587
> 
> 标签：python, django, middleware

所以我对 Django 很陌生，但是已经完成了几次关于 (https://docs.djangoproject.com/en/1.4/intro/tutorial01/) 的教程，感觉我已经掌握了它.

我要处理的下一个项目是创建、安装和配置中间件（更具体地说，我正在努力做到这一点，以便当本地主机访问该站点时它可以正常启动，并且当本地主机以外的其他人启动它时它转发到 google.com 或其他一些随机站点。）我主要是根据老板的要求做这件事来积累经验，所以任何帮助都将不胜感激！:)

我已阅读以下站点，但似乎无法弄清楚如何使 url 重定向工作。

$https://docs.djangoproject.com/en/dev/topics/http/middleware/?from=olddocs

$https://docs.djangoproject.com/en/dev/ref/middleware/

$http://djangosnippets.org/snippets/510/

我从上述网站 (www.djangosnippets.org) 获取的代码

```
import re

from django.http import HttpResponsePermanentRedirect
from django.conf import settings

class UrlRedirectMiddleware:
"""
This middleware lets you match a specific url and redirect the request to a
new url.

You keep a tuple of url regex pattern/url redirect tuples on your site
settings, example:

URL_REDIRECTS = (
    (r'www\.example\.com/hello/$', 'http://hello.example.com/'),
    (r'www\.example2\.com/$', 'http://www.example.com/example2/'),
)

"""
def process_request(self, request):
    host = request.META['HTTP_HOST'] + request.META['PATH_INFO']
    for url_pattern, redirect_url in settings.URL_REDIRECTS:
        regex = re.compile(url_pattern)
        if regex.match(host):
            return HttpResponsePermanentRedirect(redirect_url) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:19:34.160

添加到您的设置（假设您正在使用开发服务器）：

例如

```
URL_REDIRECTS = (
    (r'127.0.0.1:8000/hello', 'http://www.google.com'),
) 
```

还要在您的设置中添加`UrlRedirectMiddleware`python-path 。`MIDDLEWARE_CLASSES`

例如，如果你是在一个名为的应用程序内部调用`UrlRedirectMiddleware`的模块中定义的`my_middle.py``app`

添加`'app.my_middle.UrlRedirectMiddleware'`到您的`MIDDLEWARE_CLASSES`

# visual-studio-2010 - 一个页面上有多个fancybox | 视觉工作室

> ID：12206252
> 
> 赞同：0
> 
> 时间：2012-08-30T22:07:15.663
> 
> 标签：visual-studio-2010, visual-studio, visual-studio-2008, fancybox, webforms

我需要3个**不同内容****的 Fancybox**。

 ****点击时“触发**” Fancybox没有问题，但我的问题是如果有意义，我如何将**Web 表单**或**用户控件**关联到 Fancybox？

***示例***：假设用户单击名为“**添加到购物篮**”的锚点。我需要相应的具有适当内容的 Fancybox 才能在点击时呈现。我不知道的是：

1.  我需要为内容使用另一个**Web 表单**吗？
2.  我需要对内容使用**用户控件**吗？
3.  如何让fancybox根据用户点击的锚点来**识别**要呈现的**Web表单**或**用户控件**，因为会有**多个不同的fancybox实例**......再次，如果这有意义的话。**

# android - 将页脚添加到 ListFragments 的列表视图之一会自动将页脚添加到另一个

> ID：12206259
> 
> 赞同：0
> 
> 时间：2012-08-30T22:07:38.643
> 
> 标签：android, android-listview, android-fragments, android-listfragment

所以我的应用程序由两个`ListFragment`s 组成。让我们打电话给他们`ContentsList`和`TextList`。问题是当我向这样的 ListView 添加页脚时`ContentsList`（在`onActivityCreated()`方法中：

```
lv = getListView();
v = getActivity().getLayoutInflater().inflate(R.layout.add_new,
                null);
lv.addFooterView(v); 
```

它也会自动将页脚添加到 ListView 的列表视图中`TextList`。知道为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T10:24:42.730

乌胡解决了。

问题是我的一个片段实际上被称为“ListFragment”，在某些时候我的片段和实际的 ListFragment 类混淆了，这导致了一个问题。

我从[本教程](http://www.vogella.com/articles/Android/article.html)中汲取了这个想法，但似乎那个人已经对其进行了更好的调整。无论如何，我会在第一次打他的脸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:40:59.877

试试这个 。`@android:id/list`我认为的问题是您在不同片段使用的单个活动中有两个布局。您可以做的是区分包含具有不同 ID 的列表视图的布局。

进而

```
LinearLayout layout = (LinearLayout)findViewbyId(R.id.contentslayout);

Yourlistview = (ListVIew)layout.findviewbyid(R.id.list) 
```

如果这不起作用，那么您可能必须为每个列表视图设置不同的标签并使用 findViewbytag

# java - 找不到 Java 主目录

> ID：12206262
> 
> 赞同：7
> 
> 时间：2012-08-30T22:07:40.190
> 
> 标签：java, linux, unix, jsvc

我正在编写一个应用程序，它利用`jsvc`将 Java 服务作为守护程序启动。我需要使用类似的东西，`jsvc`因为我的应用程序使用 1024 以下的端口，但我真的不想以 root 身份运行它，以便创建的文件归另一个用户所有。我还希望将依赖项和配置保持在最低限度，以便客户端所需的只是 JVM 和已`jsvc`安装的二进制文件。

但是，似乎`jsvc`有一个主要问题。它无法在给定的 Unix 操作系统上检测到 Java 的主文件夹，这非常令人沮丧：

```
$ ./startup.sh
Cannot locate Java home 
```

至少通过手动设置 JVM 主目录，我已经能够在 Ubuntu 上解决这个问题：

```
jsvc ... -home /usr/lib/jvm/default-java/ ... 
```

有没有办法从 Bash 脚本动态确定 Java 主目录，以便我可以在大多数 Unixes/Linuxes 上进行这项工作？我晚上可以睡得更好，做一些类似的事情：

```
JAVA_HOME="$( ... )"

jsvc ... -home "$JAVA_HOME" ... 
```

...而不是对每个单独的操作系统进行硬编码。有没有办法，给定一个`java`二进制文件，我可以找到它的 JVM/JRE 的主目录？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T22:32:11.400

不确定这是否适用于 *nixes，但找到了这个解决方案：

```
JAVA_HOME="$( readlink -f "$( which java )" | sed "s:bin/.*$::" )" 
```

我已经在 Ubuntu 上对其进行了测试，它可以工作，但它不适用于 OSX。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-27T18:26:08.720

[我的解决方案是编译原生 linux 源代码，如http://commons.apache.org/proper/commons-daemon//jsvc.html](http://commons.apache.org/proper/commons-daemon//jsvc.html)中的主 jsvc 页面所述

这是我的分步程序

下载 www.fightrice.com/mirrors/apache/commons/daemon/source/commons-daemon-1.0.13-src.tar.gz

提取文件后，转到 ...../commons-daemon-1.0.13-src/src/native/unix

在终端中以 root 身份执行以下操作：

$ 支持/buildconf.sh

$ ./configure --with-java=/usr/lib/jvm/default-java

$ 制作

测试生成的 jsvc 二进制应用程序

$ ./jsvc -帮助

有用！干净地。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T22:16:00.197

使用`dirname`and`which`命令查找 Java 的 bin 目录：

```
echo `dirname \`which java\``
JAVA_HOME=`dirname \`which java\`` 
```

...仅当 Java 已经在`$PATH`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-27T21:03:50.023

另一种方法是：

```
 type -p java 
```

期望这会返回正确的 JAVA 安装文件夹。

# pdcurses - PDcurses 版本在 VC++ 上编译失败

> ID：12206265
> 
> 赞同：0
> 
> 时间：2012-08-30T22:07:53.873
> 
> 标签：pdcurses

我有一个使用 PDCurses 的应用程序。它在调试下编译良好，但是当我尝试在发布模式下编译时，出现以下错误：

```
main.cpp(1): fatal error C1083: Cannot open include file: 'curses.h': No such file or directory 
```

我不知道我是否没有正确设置链接器或可能是什么原因。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:11:14.127

此消息正在寻找头文件：curses.h。此特定消息与链接器无关。可能有一个 #ifdef 仅在进行发布构建时包含它，但在进行调试构建时不包含它（这可能是也可能不是错误）。很可能没有为您的编译器指定头文件的路径。我不确定您使用的是哪个编译器/版本，但您可以添加其他路径来搜索头文件。这将在编译器选项中。

编辑：查看文件 main.cpp，您应该会看到 #includes 文件“curses.h”的行。但是，它也可能是您在其中包含的头文件之一，而该头文件又包含该文件。

# javascript - 在 Backbone.js 中将回调绑定到 this

> ID：12206267
> 
> 赞同：1
> 
> 时间：2012-08-30T22:08:15.727
> 
> 标签：javascript, backbone.js, underscore.js, trigger.io

这可能很简单，但是对于我的生活，我无法弄清楚为什么这不能正确绑定。

在我的主要观点中：

```
initMap: function() {
    forge.logging.log('... Initializing map');
    var createMap = function(position) {
        var latLng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude, true);
        var options = {
            zoom: 15,
            center: latLng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        this.map = new google.maps.Map(document.getElementById('map_canvas'), options);
        this.addMarkers();
    };
    _.bind(createMap, this);
    forge.geolocation.getCurrentPosition(createMap);
    forge.logging.log('Created map ...');
},
addMarkers: function() {
    alert('addMarkers');
    forge.logging.log('... Adding markers');
    var tempData = ["xxxxxxxx",
                    "xxxxxxx",
                    "xxxxxxxx"];

    _.each(tempData, function(addr){
        google.maps.Geocoder.geocode({'address': addr}, function(res, status){
            if (status == google.maps.GeocoderStatus.OK) {
                new google.maps.Marker({
                    map: this.map,
                    position: res[0].geometry.location
                });
            }
        });
    });

    forge.logging.log('Added markers ...');
} 
```

由于某种原因， this.addMarkers() 似乎没有被调用。我猜这是因为这没有正确绑定。然而，地图显示得非常好。

我应该如何将它绑定到我的 createMap 回调函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T23:24:05.063

来自[精美手册](http://underscorejs.org/#bind)：

> **绑定** `_.bind(function, object, [*arguments])`
> 
> **将函数**绑定到**对象**，这意味着每当调用该函数时，*this*的值就是**对象**。或者，将**参数**绑定到**函数**以预填充它们，也称为**部分应用**。
> 
> ```
> var func = function(greeting){ return greeting + ': ' + this.name };
> func = _.bind(func, {name : 'moe'}, 'hi');
> func();
> => 'hi: moe' 
> ```

文档可能更明确一点，但重要的是在示例中：

```
func = _.bind(func, ...) 
```

所以`_.bind`返回绑定函数，它不会就地修改函数。你想说这个：

```
createMap = _.bind(createMap, this); 
```

或者这个：

```
var createMap = function(position) { ... };
forge.geolocation.getCurrentPosition(_.bind(this, createMap)); 
```

也许你对`_.bindAll`在其他地方使用感到困惑。该[`_.bindAll`](http://underscorejs.org/#bindAll)函数看起来像是就地修改了函数，但实际上是`object`在就地修改了函数，因此：

```
_.bindAll(obj, 'm1', 'm2'); 
```

或多或少是在内部执行此操作：

```
obj.m1 = _.bind(obj, obj.m1);
obj.m2 = _.bind(obj, obj.m2); 
```

# javascript - 如何以编程方式添加到可变嵌套对象？

> ID：12206268
> 
> 赞同：4
> 
> 时间：2012-08-30T22:08:17.880
> 
> 标签：javascript, object, variable-assignment

我需要一种将对象添加到另一个对象中的方法。通常这很简单，只需

```
obj[property] = {'name': bob, 'height': tall} 
```

但是有问题的对象是嵌套的，因此需要以下内容：

```
obj[prop1][prop2] = {'name': bob, 'height': tall} 
```

不过，关键是嵌套是可变的。那就是我不知道每个新对象在运行前会嵌套多深。基本上我将生成一个代表对象路径的字符串，例如

“object.secondObj.thirdObj.fourthObj”

然后我需要在第四个对象内部设置数据，但是我不能使用括号[]方法，因为我事先不知道需要多少个括号。有没有办法做到这一点？如果有必要，我也在使用 jQuery。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T22:15:44.693

当然，您可以使用递归或简单迭代。我更喜欢递归。以下示例旨在进行概念验证，可能不应在生产中使用。

```
var setDeepValue = function(obj, path, value) {
    if (path.indexOf('.') === -1) {
        obj[path] = value;
        return;
    }

    var dotIndex = path.indexOf('.');
    obj = obj[path.substr(0, dotIndex)];

    return setDeepValue(obj, path.substr(dotIndex + 1), value);
}; 
```

但递归不是必需的，因为在 JavaScript 中您可以只更改引用。

```
var objPath = 'secondObj.thirdobj.fourthObj';
var valueToAdd = 'woot';

var topLevelObj = {};
var attributes = objPath.split('.');
var curObj = topLevelObj;

for (var i = 0; i < attributes.length; i++) {
    var attr = attributes[i];
    if (typeof curObj[attr] === 'undefined') {
        curObj[attr] = {};
    }

    curObj = curObj[attr];

    if (i === (attributes.length - 1)) {
        // We're at the end - set the value!
        curObj['awesomeAttribute'] = valueToAdd;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:22:54.040

而不是生成一个字符串...

```
var o="object";
//code
o+=".secondObj";
//code
o+=".thirdObj";
//code
o+=".fourthObj"; 
```

...你可以做

```
var o=object;
//code
o=o.secondObj;
//code
o=o.thirdObj;
//code
o=o.fourthObj; 
```

然后你可以像这样添加数据：

```
o.myprop='myvalue'; 
```

并将`object`随着更改进行更新。

在这里看到它：http: [//jsfiddle.net/rFuyG/](http://jsfiddle.net/rFuyG/)

# python - 如何检查给定的单词是复数形式还是单数形式？

> ID：12206276
> 
> 赞同：11
> 
> 时间：2012-08-30T22:09:17.130
> 
> 标签：python, nlp

主题中的问题 - 我正在尝试在 Google App Engine 中的应用程序的 python 中执行此操作。我知道 PyEnchant 库用于自然语言识别，但我不知道是否可以将它用于我的问题以及如何使用它。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2016-08-22T11:05:23.070

Ashwini 提到了有用的[变形](https://pypi.python.org/pypi/inflect/0.2.5)库，但没有解释如何检查给定单词是复数形式还是单数形式。

如果你知道这个词是单数还是复数，你可以使用：

```
singular_noun(word) 
```

`False`如果单词不是复数，这将返回，因此您的单词理论上应该是单数。

请注意我的示例中显示的经典复数形式的缺点，可以是单数或复数形式，以及对于一般无法识别的形式它将返回 False 的事实。

```
import inflect
inflect = inflect.engine()

english_words = ["hat", "hats",
                 "hero", "heroes",
                 "cherry", "cherries",
                 "dish", "dishes",
                 "stadium", "stadia", "stadiums",
                 "mitochondrion", "mitochondria",
                 "sheep", "a sheep", "the sheep",
                 "whjkjhkjh", "msipelling"]

for en in english_words:
    if inflect.singular_noun(en) == False:
        print (en, "is singular")
    else:
        print (en, "is plural")

>>>
hat is singular
hats is plural
hero is singular
heroes is plural
cherry is singular
cherries is plural
dish is singular
dishes is plural
stadium is singular
stadia is singular
stadiums is plural
mitochondrion is singular
mitochondria is singular
sheep is plural
a sheep is plural
the sheep is plural
whjkjhkjh is singular 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-08-30T22:27:26.797

签出[inflect 0.2.4](https://pypi.python.org/pypi/inflect/0.2.4)库。

> **变形 0.2.4**
> 
> 正确生成复数、单数名词、序数、不定冠词；将数字转换为单词

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-31T08:16:04.477

您不会说您的问题是孤立的单词还是英语句子上下文中的单词。

例如“ **thesheep** ”可以是单数也可以是复数。然而：

> 羊在地里

是单数并且

> 羊在田里

是复数。

对于后者，您需要一个词性标注器，它将识别句子中名词的角色。有很多免费的和商业的，维基百科有[一个很好的列表](http://en.wikipedia.org/wiki/List_of_natural_language_processing_toolkits)。NLTK 可能是 Python 的自然选择。

如果你只有孤立的词，你能做的最好的就是参考许多字典（例如 [Wordnet](http://wordnet.princeton.edu/)，它会指示名词的单数和复数形式）。

# ruby-on-rails-3 - 试图找出 Rails 路由中的嵌套范围

> ID：12206278
> 
> 赞同：0
> 
> 时间：2012-08-30T22:09:20.873
> 
> 标签：ruby-on-rails-3, rails-routing

我有一个网站，我正在制作如下所示的 URL（供用户查看信息）：

```
/:state/:data_type/:category/:subcategory/:item_id 
```

data_type 是“目录”、“文章”或“文档”之一。这个想法是存储每个状态的信息，基于类别和子类别，并且可以这样查看。

任何特定的部分都是有效的路径。例如：

/IN - 显示印第安纳州的主页（控制器 region_home，操作索引）

/IN/directory - 印第安纳州的类别和子类别列表（控制器 region_categories）

/IN/directory/schools - 印第安纳州“学校”类别下的子类别列表（控制器是 region_subcategories）

/IN/directory/schools/elementary - 印第安纳州小学列表（控制器为 region_directory，操作索引）

/IN/directory/schools/elementary/10-meridian-street - 深入到特定学校（控制器是 region_directory，动作是 show）

这主要是为了显示信息。我已经为所有区域、类别、子类别等创建了“slugs”。这部分有效。

我实际上可以让它像这样工作：

```
match ':region_slug/directory(/:category_slug(/:subcategory_slug(/:directory_entry_id)))' => 'region_directory#index', :as => :region_directory 
```

问题是每个请求都转到同一个控制器/动作，然后必须分派请求。

我可以把它切成小块：

```
match ':region_slug' => 'region_home#index'
match ':region_slug/directory' => 'region_categories#index'
match ':region_slug/directory/:category_slug' => 'region_subcategories#index'
match ':region_slug/directory/:category_slug/:subcategory_slug' => 'region_directory#index'
match ':region_slug/directory/:category_slug/:subcategory_slug/:directory_entry_id' => 'region_directory#show' 
```

但这打破了 DRY，我必须为文章等重复这一点。我不知道如何使用范围来做到这一点。有任何想法吗？

# django - 通过基于 django 构建的 RESTfull Web 服务对 Web 和移动应用程序进行身份验证

> ID：12206279
> 
> 赞同：6
> 
> 时间：2012-08-30T22:09:23.387
> 
> 标签：django, authentication, restful-authentication

我正在为我的公司开发一个具有以下架构的解决方案：基于 django 构建的**RESTfull Web 服务，它为****Web 客户端应用程序**和**移动客户端应用程序**（使用**phonegap**编写）提供身份验证和持久层。

我们一直在互联网上寻找有关客户端身份验证方法的大量信息，为 Web 和移动客户端应用程序提供支持，并且根据我们的发现（非常糟糕），我们正在考虑为每个用户生成一个 API 密钥从移动客户端应用程序登录，并将此 API 密钥保存在设备的本地存储中；并且，在 Web 客户端中，使用传统的 cookie 会话管理，包括 POST、PUT 和 DELETE 请求中的 CSRF 令牌。

我们想知道身份验证方法的最佳实践是什么，这种方法是否足够好？还有其他方法可以处理身份验证吗？哪一个是最好的？

我们试图避免使用**oAuth**，因为它增加了我们开发的复杂性。

我们已经检查了[这个问题](https://stackoverflow.com/questions/12015182/restful-web-services-consumed-by-web-and-native-mobile-apps-with-authentication)，但它的答案对我们没有太大帮助，因为我们使用的是 phonegap，并且具有上述架构。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T14:24:10.410

如果您真的真的很想创建自己的解决方案。这是我在 oAuth 时代之前的旧错误解决方案。

1.  创建使用用户名/密码成功登录后返回一些密钥的视图，并将生成的 access_key 添加到数据库
2.  检查请求中的密钥 => 如果数据库中存在 => 登录

    ```
    #pseudo code
    #view  
    from django.contrib.auth import authenticate, login

    def get_my_token(request, username, password):
        user = authenticate(username, password)
        if user is not None:
            login(request,user)
            #first  should check has access_key 
            try:
                return  UserAuth.objects.filter(user=user).access_key
            except:
               pass
            access_key = 'somecrazy_random_unique_number' 

            user_auth = UserAuth()
            user_auth.user = user
            user_auth.access_key = access_key
            user_auth.save()
            return access_key 
    ```

现在您可以将 access_key 保存在某处，并将作为标题“access_key_or_any_other_name”添加到每次调用休息资源时。创建身份验证中间件，而不是身份验证后端。

```
 #auth_middelware 
    class StupidNoAuthMid(object):
        def process_request(self, request):  
            access_key = reuest.META['access_key_or_any_other_name']:
            try:
                user = UserAuth.objects.filter(access_key=acces_key).user
                auth.login(request, user) 
            except:
                pass 
```

你不想重新发明轮子。使用 oAauth，您可以保存 access_token 以备将来使用。

# java - Vaadin 和 Liferay IPC 不同步错误

> ID：12206282
> 
> 赞同：0
> 
> 时间：2012-08-30T22:09:52.590
> 
> 标签：java, liferay, vaadin

我在 Liferay 的同一页面上使用了 2 个 Vaadin Portlet。第一个显示条目表，每一行都有一个按钮来显示有关此条目的详细信息。

单击按钮时，将发送 IPC 事件，该事件由第二个 portlet 接收，然后切换到显示内容的表格视图。

通过单击第一个 portlet 上的关闭按钮，第二个 portlet 将再次收到 IPC 事件并返回到其原始状态，这是一个空白视图，仅附加了 Liferay IPC 侦听器。

我的问题是，在第三次单击后，Liferay 出现了不同步错误。当视图改变时，我总是将它附加到主窗口。所以我不创建具有相同名称的其他窗口。

当我在页面上只使用一个 portlet 时，我可以毫无问题地来回切换。可能是浏览器在某些时候想要在客户端触发一个事件，但 IPC 已经在服务器端消失了？

很难确定这个问题的根源。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T06:25:33.777

你在正确的轨道上。IPC 在客户端工作，不同步是由从客户端调用到服务器的不存在的组件引起的。

可能有一些原因导致这种情况，但需要检查一些场景：

*   你说你有一个清除显示的关闭按钮。调用 Application.close() 可能吗？这实际上可能会导致创建和调用一个新的（服务器端）应用程序实例，而不是原来的。
*   您可能正在创建 IPC 组件的新实例，但旧实例仍已注册并尝试发送某些内容（到其不存在的服务器部分）。
*   JavaScript 计时问题可能会导致 IPC 事件以您可能期望的不同顺序发送。如果行为始终一致，我认为这不太可能，但仍有可能。

希望这可以帮助您缩小案例范围并找到解决方案。保持这个问题更新。

# git - 您如何合并分支以使新提交位于顶部？

> ID：12206283
> 
> 赞同：1
> 
> 时间：2012-08-30T22:09:55.717
> 
> 标签：git

假设我有分支`A`。现在我创建新分支并`B`进行`A`一些提交。假设在这段时间内`A`也有一堆提交。有没有办法将这些新提交合并到`B`我所做的提交`B`将成为顶部？

为了显示：

```
A -> a1 -> a2 -- B created here -- -> a3 -> a4
                 B -> a1 -> a2 -> b1 -> b2 
```

我如何合并这样`B`最终像

```
 B -> a1 -> a2 -> a3 -> a4 -> b1 -> b2 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T22:15:01.570

你想`rebase`，不是`merge`

开启时`B`，执行

```
git rebase A 
```

这不会影响 A 分支，但会改写 B 分支的近期历史。

之前，你有

```
... -> a1 -> a2 -> a3 -> a4 -> A
              \--> b1 -> b2 -> B 
```

之后您将拥有：

```
... -> a1 -> a2 -> a3 -> a4 -> A
                          \--> b1 -> b2 -> B 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:26:35.440

利用`git rebase`

我的典型工作流程，包括在分支中工作和合并到 master 是：

```
git status # Make sure I am in the master branch, "git checkout master" if not
git pull
git checkout -b new_branch # New branch called new_branch
# do the work, tests, etc.
git add .
git commit
git checkout master
git pull # Get the very latest master
git checkout my_branch
git rebase master
git checkout master
git merge my_branch  
git push master 
```

# mongodb - 视图存在于 mongodb 中吗？

> ID：12206284
> 
> 赞同：0
> 
> 时间：2012-08-30T22:10:01.003
> 
> 标签：mongodb, mongodb-java, mongodb-query

> **可能重复：**
> [MongoDB 中的 SQL 视图](https://stackoverflow.com/questions/11507995/sql-view-in-mongodb)

我是 mongodb (java) 的新手。

我需要知道 mongodb 中是否存在诸如视图（关系）之类的东西？

是否可以创建视图 mongodb？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:33:46.807

不。

...除非您将查询视为视图。

# javascript - 无法在 D3 的径向树布局中移除旋转

> ID：12206287
> 
> 赞同：1
> 
> 时间：2012-08-30T22:10:23.110
> 
> 标签：javascript, d3.js

我有这个 D3 径向树图，我需要的是不旋转的图像，而是直接一起显示它对应的蓝色圆圈。[这](http://codepen.io/anon/pen/icBjJ)是在 Codepen 中工作的代码，我在这里复制它：

```
var radius = 960 / 2;

var tree = d3.layout.tree()
  .size([360, radius - 120])
  .separation(function (a, b) { return (a.parent == b.parent ? 1 : 2) / a.depth; });

var diagonal = d3.svg.diagonal.radial()
  .projection(function (d) { return [d.y, d.x / 180 * Math.PI]; })

var vis = d3.select('#graph').append('svg:svg')
  .attr('width', radius * 2)
  .attr('height', radius * 2 - 150)
  .append('g')
  .attr('transform', 'translate(' + radius + ',' + radius + ')');

d3.json('flare2.json', function (json) {
  var nodes = tree.nodes(json);
  var link = vis.selectAll('path.link')
    .data(tree.links(nodes))
    .enter().append('path')
    .attr('class', 'link')
    .attr('d', diagonal);
  var node = vis.selectAll('g.node')
    .data(nodes)
    .enter().append('g')
    .attr('class', 'node')
    .attr("transform", function(d) { return "rotate(" + (d.x - 90) + ")translate(" + d.y + ")"; });
  node.append('circle')
    .attr('r', 4.5);
  node.append('image')
    .attr('xlink:href', 'img/avatar.40.gif')
    .attr('width', 40)
    .attr('height', 40)
    .attr('x', 10);
  node.append('image')
    .attr('xlink:href', 'img/avatar.41.gif')
    .attr('width', 40)
    .attr('height', 40)
    .attr('x', 50 );
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T02:27:05.653

您的节点已旋转

```
.attr("transform", function(d) { return "rotate(" + (d.x - 90) + ")translate(" + d.y + ")"; }) 
```

并且您的图像被附加到您的节点

```
node.append('image') 
```

所以你需要将图像旋转回来

```
.attr("transform", function(d) { return "rotate(" + (90 - d.x) + ")"; }) 
```

我不确定你想如何定位它们，但你需要在`x`和上翻译它们`y`。

查看一个工作示例：[http ://codepen.io/anon/pen/qiCeG](http://codepen.io/anon/pen/qiCeG)

# git - gitolite post接收特定裸回购的挂钩

> ID：12206290
> 
> 赞同：7
> 
> 时间：2012-08-30T22:10:44.383
> 
> 标签：git, gitolite

在我将本地 git repo 推送到服务器后：

```
$ git push origin master 
```

我希望服务器上的裸仓库（在它收到我的推送之后）到：

```
$ cd /Users/me/Sites
$ git pull
$ exit 
```

我在这里查看了一些问题，他们提到了 $HOME/gitolite/hooks 中的钩子，

但这是我正在使用的：

```
git@mm:gitolite $ pwd
/Users/git/gitolite
git@mm:gitolite $ ls
.git/                 README.txt            install*
CHANGELOG             check-g2-compat*      src/
COPYING               convert-gitosis-conf* t/ 
```

如何为特定的裸仓库添加接收后挂钩？

如果我进入我的裸仓库：

```
git@mm:bare-repo.git $ ls hooks
applypatch-msg.sample*     pre-rebase.sample*
commit-msg.sample*         prepare-commit-msg.sample*
post-update.sample*        update@
pre-applypatch.sample*     update.sample*
pre-commit.sample* 
```

我没有看到接收后挂钩。是什么赋予了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-31T05:54:12.527

# javascript - AJAX：为什么我的 javascript 没有加载内容？

> ID：12206292
> 
> 赞同：0
> 
> 时间：2012-08-30T22:10:55.070
> 
> 标签：javascript, jquery, ajax

这是我第一次使用 AJAX。单击链接时，我正在尝试加载我的一个页面（我知道我可以这样做`<a href="something.html">`，但我这样做只是为了使用 AJAX，并且遇到了我的页面加载但页面的 javascript 的问题没有。这是正常的 AJAX 后果吗？我猜它与`dataType: html`? 这是我的代码：

```
function getContent(filename) {
    $.ajax({
        url: filename,
        type: "GET",
        dataType: "html",
        beforeSend: function(){
            $('html').html('<img src="../images/loading.gif">');
        },
        success: function (data, textStatus, xhr) {
            if (filename == "second.html") {
                setTimeout(function (){
                    $('html').html(data);
                }, 2000);
            } else {
                $('html').html(data);
            }
        },
        error: function(xhr, textStatus, errorThrown) {
            $('html').html(textStatus);
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:18:06.263

这是因为 ajax 页面只返回渲染的内容，而不是像普通页面那样运行。例如，您可以在ajax页面上使用PHP，服务器渲染它然后发送它，因为PHP是预渲染，据我所知，javascript在页面渲染后运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T00:50:37.083

你能检查一下chrome的网络监视器吗？首先，有什么东西会得到 404 吗？文件字面上是 second.html 吗？如果是这样，那么不应该有路径问题。接下来该项目出现的“响应”是什么？这个反应看起来还行吗？

接下来，您为什么不尝试将 JS 从 head 移动到 body 以用于第二页？出于性能原因，JS 应该始终位于结束 body 标记之前。此外，JS 可能存在问题，因此无法执行。

您应该能够通过 AJAX 在您的域上加载任何内容而不会出现任何问题，但是需要注意路径问题。

# javascript - CRM 2011 调用 getAttribute 失败

> ID：12206293
> 
> 赞同：1
> 
> 时间：2012-08-30T22:10:55.313
> 
> 标签：javascript, dynamics-crm, dynamics-crm-2011, crm

截至今天早上，我们的 CRM 网站出现了问题。任何失败的调用`Xrm.Page.getAttribute`，无论属性如何。此外，如果我使用 IE9 进行调试，我发现这`Xrm.Page`是有效的，但检查`Xrm.Page.data`返回 null，因此之后对任何内容的任何调用都将失败（`Xrm.Page.data.entity`等）

知道为什么会这样吗？该错误甚至被 CRM 调用，当我请求将其发送给 Microsoft 时，XML 中的错误是：

> 对象不支持属性或方法“getAttribute”

很可能是因为上述问题。

任何意见是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-14T20:17:52.927

当自定义 JScript 函数与作为 Dynamics CRM 表单的内置部分的 JScript 函数之间存在命名冲突时，可能会发生此类错误。您的自定义函数可以简单地替换 CRM 表单所依赖的函数。

删除所有自定义脚本并一一检查。

一个好的做法是将所有自定义函数放在您自己的命名空间中。它通常会这样声明：

```
var MySpace = MySpace || {}; 
```

然后像这样添加你的函数：

```
MySpace.MyFunction = function() {
    alert('Example');
}; 
```

# java - 如何允许itext pdfTable中的列溢出

> ID：12206294
> 
> 赞同：1
> 
> 时间：2012-08-30T22:10:55.627
> 
> 标签：java, itext

我有一个 3 列的 PdfPTable。所有列都有其宽度。当我想在比列宽长的列中添加文本时，如何允许列溢出到下一列？

我想实现这一点：

![在此处输入图像描述](../Images/037614e12f6d2410b3a8a24a21a8f6c6.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T07:49:38.293

参见 iText in Action - Second Edition 中的图 4.6；它显示了此示例的结果： [http](http://itextpdf.com/examples/iia.php?id=81) ://itextpdf.com/examples/iia.php?id=81 查找它显示的行：cell.setNoWrap(true);

# asp.net-mvc - MVC jQuery 移动 iPad

> ID：12206295
> 
> 赞同：0
> 
> 时间：2012-08-30T22:10:58.870
> 
> 标签：asp.net-mvc, ipad, jquery-mobile

我将这个示例用于 MVC：

[http://www.asp.net/mvc/tutorials/mvc-4/aspnet-mvc-4-mobile-features](http://www.asp.net/mvc/tutorials/mvc-4/aspnet-mvc-4-mobile-features)

当我部署该站点时，它在我的 Windows Phone 上看起来不错。当我在 iPad 上访问我的网站时，我看不到 jQuery mobile。如何启用平板电脑支持？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T13:17:16.253

我必须将 iPad 添加为注册设备。这是我的 global.asax

```
using System;
using System.Web.Http;
using System.Web.Mvc;
using System.Web.Optimization;
using System.Web.Routing;
using System.Web.WebPages;
using MvcMobile;
using System.Web.Http;
using System.Collections.Generic;
using System.Web;
using System.Linq;

namespace JMA.Web
{
// Note: For instructions on enabling IIS6 or IIS7 classic mode, 
// visit http://go.microsoft.com/?LinkId=9394801

public class MvcApplication : System.Web.HttpApplication
{
    public static void RegisterGlobalFilters(GlobalFilterCollection filters)
    {
        filters.Add(new HandleErrorAttribute());
    }

    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
        );

    }

    protected void Application_Start()
    {
        WebApiConfig.Register(GlobalConfiguration.Configuration);
        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
        RouteConfig.RegisterRoutes(RouteTable.Routes);
        BundleConfig.RegisterBundles(BundleTable.Bundles);
        BundleMobileConfig.RegisterBundles(BundleTable.Bundles);
        RegisterCustomDisplayModes();

    }

    private void RegisterCustomDisplayModes()
    {
        Dictionary<string, Func<HttpContextBase, bool>> displayModes = new Dictionary<string, Func<HttpContextBase, bool>>
        {
            {"Mobile", c => c.Request.UserAgent.IndexOf("iPad", StringComparison.InvariantCultureIgnoreCase) > 0}
        };

        displayModes.Keys.ToList().ForEach(
            key => DisplayModeProvider.Instance.Modes.Insert(0, new DefaultDisplayMode(key)
            {
                ContextCondition = c =>
                    {
                        if (c == null || c.Request == null || string.IsNullOrEmpty(c.Request.UserAgent))
                        {
                            return false;
                        }

                        return displayModes[key](c);
                    }
            }));
    }
}
} 
```

移动一词将用户重定向到 Shared/Layout/_Layout.Mobile。iPad 一词用于查找设备。更多信息可以在这里找到：

[http://www.asp.net/mvc/tutorials/mvc-4/aspnet-mvc-4-mobile-features](http://www.asp.net/mvc/tutorials/mvc-4/aspnet-mvc-4-mobile-features)

“浏览器特定视图”

如果我将 Mobile 更改为 iPad，浏览器将重定向到 _Layout.iPad

转到 ~/Shared/_ViewSwitcher 并更改代码：

```
@if (Request.Browser.IsMobileDevice && Request.HttpMethod == "GET" ||     

Request.UserAgent.IndexOf("iPad", StringComparison.InvariantCultureIgnoreCase) > 0 )
{
<div class="view-switcher ui-bar-d" data-theme="d">
    @if (ViewContext.HttpContext.GetOverriddenBrowser().IsMobileDevice || Request.UserAgent.IndexOf("iPad", StringComparison.InvariantCultureIgnoreCase) > 0 )
    {
        @: Displaying mobile view
        @Html.ActionLink("Desktop view", "SwitchView", "ViewSwitcher", new { mobile = false, returnUrl = Request.Url.PathAndQuery }, new { rel = "external" })
    } 
    else 
    {
        @: Displaying desktop view
        @Html.ActionLink("Mobile view", "SwitchView", "ViewSwitcher", new { mobile = true, returnUrl = Request.Url.PathAndQuery }, new { rel = "external" })
    }
</div>
} 
```

# caching - Cloudflare - 我还需要缓存吗？

> ID：12206299
> 
> 赞同：1
> 
> 时间：2012-08-30T22:11:22.573
> 
> 标签：caching, cloudflare

我在 5 分钟前听说过 cloudflare，它看起来非常好。我读到即使我的服务器离线，他们也可以保持我的网站在线，所以我猜他们正在缓存我的网站。

所以我对网络开发非常陌生，但我认为我的访问者会访问 cloudflare 服务器而不是我的服务器。它是否正确？

（我说的是每个人都一样的新闻页面，而不是用户特定的动态内容）

所以我想我不必再缓存那些“静态”网站了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:17:26.660

Cloud Flare 提供的只是您网站的一张图片，并且在您的服务器离线时某些页面可能不可用，这与 Google 所做的非常相似。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T13:16:43.180

事实上，CloudFlare 可以缓存您网站上的所有内容。您必须通过创建“Cache-everything”PageRule 来强制它。对于大多数静态网站来说，这实际上是一个不错的主意。

在此处查找更多详细信息：http: [//blog.cloudflare.com/introducing-pagerules-advanced-caching](http://blog.cloudflare.com/introducing-pagerules-advanced-caching)

# knockout.js - 有人可以解释如何将两个 observableArrays 重做为一个吗？

> ID：12206306
> 
> 赞同：0
> 
> 时间：2012-08-30T22:12:20.937
> 
> 标签：knockout.js, observable

[http://jsfiddle.net/Gm64C/2/](http://jsfiddle.net/Gm64C/2/)

使用的数据内嵌在 javascript 面板的顶部。

如果您单击结果面板中的“显示详细信息”链接，您将在表格的列表下方获得与该药物相关的更多数据。如果您点击 drugName 行中的“编辑”，您可以更改该药物名称。如果更改名称，它将反映在数据表和数据表上方的表头中。它**不会**在结果面板顶部的列表中更新（即不同的 observableArray）。

我不知道如何使用一个 observableArray 来完成这一切。我正在使用 data.preferredDrugs 填充我的drugList **oservableArray** **（**这是一个对象数组，然后我使用 foreach: drugList 进行迭代）。如果我只用数据填充它，我不确定如何只迭代preferredDrugs 对象数组。这就是为什么我最终得到了两个 observableArrays - 一个用于药物名称，另一个用于药物详细信息。

我怎样才能使用一个 observableArray 来完成这项工作，所以如果您在表格中编辑药物名称，它会**随处**反映。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T16:59:50.537

我修改了你的小提琴以消除对 jquery 的依赖。

[http://jsfiddle.net/jeff1203/EPFbQ/](http://jsfiddle.net/jeff1203/EPFbQ/)

在修复中需要指出的一些事项：

*   由于您希望能够编辑名称并使更改可见，因此您至少需要使名称可观察。

    ```
    self.drugList = ko.observableArray(
        ko.utils.arrayMap(data.preferredDrugs, function (obj) {
            return ko.utils.extend(obj, {
                "drugName": ko.observable(obj["drugName"]),
            });
        })
    ); 
    ```

*   如果您跟踪所选药物、编辑文本框的内容以及您是否正在编辑的状态，将会更容易。这将有助于简化您的视图和视图模型代码。淘汰赛将解决所有其余的问题。

    ```
    // current drug
    self.currentDrug = ko.observable();

    // flag indicating we're editing the currently selected drug name
    self.isEditing   = ko.observable(false);
    // observable representing the editing text box
    self.editTextBox = ko.observable();
    // this will help with setting focus on the text box
    self.editTextBox.hasfocus= ko.observable(false); 
    ```

*   保存编辑现在只需将选定对象的名称设置为编辑文本框的内容。

    ```
    // save an edit
    self.editSave = function (obj) {
        // copy the edited name to the current drug name
        obj.drugName(self.editTextBox());

        self.isEditing(false);
    }; 
    ```

*   您可以使用[`with`绑定](http://knockoutjs.com/documentation/with-binding.html)来设置绑定的上下文，而不是`foreach`像以前那样。

*   使用绑定设置 css 类和切换可见性，淘汰赛将为您完成繁重的工作。

    ```
    <td data-bind="css: { 'editing': $root.isEditing }">
        <span data-bind="visible: !$root.isEditing(), text: drugName" class="readonly"></span>
        <input id="edit_drugname" data-bind="value: $root.editTextBox, hasfocus: $root.editTextBox.hasfocus, css: { 'edit_textfield': !$root.isEditing() }" type="text" value="" size="35" />
        <button data-bind="click: $root.editSave, css: { 'edit_buttons': !$root.isEditing() }" class="save">Save</button>
        <button data-bind="click: $root.editCancel, css: { 'edit_buttons': !$root.isEditing() }" class="cancel">Cancel</button>
        <ul class="detail_actions" data-bind="visible: !$root.isEditing()">
            <li><a data-bind="click: $root.edit" href="#" class="edit">edit</a></li>
        </ul>
    </td> 
    ```

# jquery - jQuery验证，改变单独标签的颜色

> ID：12206311
> 
> 赞同：0
> 
> 时间：2012-08-30T22:12:55.700
> 
> 标签：jquery, css, validation, colors, label

我想首先说我是 jQuery 新手，但不是一般的编程。这正在杀死我，我无法在任何地方找到答案。

这是我正在尝试做的事情：

我有一个表格，对于这个例子，我将使用我的两个主要要求。我正在尝试输入零件名称和零件编号。当用户没有输入其中之一时，我想更改输入框旁边标签的颜色，同时禁用验证的消息部分。

所以，例如。当用户不输入零件号时，我想更改：

```
<label for="part_name">Part Name</label> 
```

对于这样的事情：

```
<label for="part_name" style="color: #fa0008;">Part Name</label> 
```

到目前为止，这是我的代码。

**HTML**

```
<div class='type_left'><label for="part_name">Part Name</label></div>
<div class='type_left'><input type="text" id="part_name" name="part_name"></div>

<div class='type_left'><label for="hj_part">hj Part Number</label></div>
<div class='type_left'><input type='text' name='hj_part'></div> 
```

**jQuery**（注意：这一切都很好。我在调试模式下运行，所以它不会尝试提交。）

```
// Validate "Add Part" form ----------------
//------------------------------------------

$j('#addpartform').validate({
    debug: true,
    rules: {
        part_name: {
         required: true
        },
        hj_part: {
         required: true
        },
    },

    errorPlacement: function(error, element) { },

    invalidHandler: function(form, validator) { 
        var errors = validator.numberOfInvalids();
        if (errors) {
            alert("Hey man, you didn't enter something.")
        }           
    },
    submitHandler: function(form) { alert("works!") }

});

//------------------------------------------
// End "Add Part" form validation ---------- 
```

我需要在我的验证功能中添加什么来做到这一点？

对我来说，这听起来很简单，但我就是想不通。

在此先感谢您的帮助。担

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T01:52:34.223

在 if(errors) 中，试试这个：

```
$('#addpartform :input').each(function(){
    if ( $(this).val() == "") ){
        $('label[for="' + $(this).attr('id') + '"]').css('color', '#fa0008');
    }
}); 
```

本质上，您正在遍历表单，如果任何输入为空，则使用与“id”相同的“for”属性将颜色添加到标签。

# visual-c++ - 检测是否安装了 Visual C++ Redistributable for Visual Studio 2012

> ID：12206314
> 
> 赞同：121
> 
> 时间：2012-08-30T22:13:14.040
> 
> 标签：visual-c++

如何检测是否安装了 Visual C++ Redistributable for Visual Studio 2012？

我用谷歌搜索了一下，没有人问过这个问题，很惊讶！

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2015-12-10T19:02:32.273

这取决于您使用的版本。这两个 2012 密钥对我来说效果很好，它们对应的版本可以下载更新 4。请注意，其中一些 reg 位置可能与操作系统有关。**我从Windows 10 x64**框中收集了此信息。我将继续转储所有这些 redist 版本和我搜索以检测安装的 reg 密钥。：

* * *

## 视觉 C++ 2005

```
Microsoft Visual C++ 2005 Redistributable (x64)
Registry Key: HKLM\SOFTWARE\Classes\Installer\Products\1af2a8da7e60d0b429d7e6453b3d0182
Configuration: x64
Version: 6.0.2900.2180 
```

直接下载网址：[https ://download.microsoft.com/download/8/B/4/8B42259F-5D70-43F4-AC2E-4B208FD8D66A/vcredist_x64.EXE](https://download.microsoft.com/download/8/B/4/8B42259F-5D70-43F4-AC2E-4B208FD8D66A/vcredist_x64.EXE)

```
Microsoft Visual C++ 2005 Redistributable (x86)
Registry Key: HKLM\SOFTWARE\Classes\Installer\Products\c1c4f01781cc94c4c8fb1542c0981a2a 
Configuration: x86
Version: 6.0.2900.2180 
```

直接下载网址：[https ://download.microsoft.com/download/8/B/4/8B42259F-5D70-43F4-AC2E-4B208FD8D66A/vcredist_x86.EXE](https://download.microsoft.com/download/8/B/4/8B42259F-5D70-43F4-AC2E-4B208FD8D66A/vcredist_x86.EXE)

* * *

## 视觉 C++ 2008

```
Microsoft Visual C++ 2008 Redistributable - x64 9.0.30729.6161 (SP1)
Registry Key: HKLM\SOFTWARE\Classes\Installer\Products\67D6ECF5CD5FBA732B8B22BAC8DE1B4D 
Configuration: x64
Version: 9.0.30729.6161 (Actual $Version data in registry: 0x9007809 [DWORD]) 
```

直接下载网址：[https ://download.microsoft.com/download/2/d/6/2d61c766-107b-409d-8fba-c39e61ca08e8/vcredist_x64.exe](https://download.microsoft.com/download/2/d/6/2d61c766-107b-409d-8fba-c39e61ca08e8/vcredist_x64.exe)

```
Microsoft Visual C++ 2008 Redistributable - x86 9.0.30729.6161 (SP1)
Registry Key: HKLM\SOFTWARE\Classes\Installer\Products\6E815EB96CCE9A53884E7857C57002F0
Configuration: x86
Version: 9.0.30729.6161 (Actual $Version data in registry: 0x9007809 [DWORD]) 
```

直接下载网址：[https ://download.microsoft.com/download/d/d/9/dd9a82d0-52ef-40db-8dab-795376989c03/vcredist_x86.exe](https://download.microsoft.com/download/d/d/9/dd9a82d0-52ef-40db-8dab-795376989c03/vcredist_x86.exe)

* * *

## 视觉 C++ 2010

```
Microsoft Visual C++ 2010 Redistributable (x64)
Registry Key: HKLM\SOFTWARE\Classes\Installer\Products\1926E8D15D0BCE53481466615F760A7F 
Configuration: x64
Version: 10.0.40219.325 
```

直接下载网址：[https ://download.microsoft.com/download/1/6/5/165255E7-1014-4D0A-B094-B6A430A6BFFC/vcredist_x64.exe](https://download.microsoft.com/download/1/6/5/165255E7-1014-4D0A-B094-B6A430A6BFFC/vcredist_x64.exe)

```
Microsoft Visual C++ 2010 Redistributable (x86)
Registry Key: HKLM\SOFTWARE\Classes\Installer\Products\1D5E3C0FEDA1E123187686FED06E995A 
Configuration: x86
Version: 10.0.40219.325 
```

直接下载网址：[https ://download.microsoft.com/download/1/6/5/165255E7-1014-4D0A-B094-B6A430A6BFFC/vcredist_x86.exe](https://download.microsoft.com/download/1/6/5/165255E7-1014-4D0A-B094-B6A430A6BFFC/vcredist_x86.exe)

* * *

## 视觉 C++ 2012

```
Microsoft Visual C++ 2012 Redistributable (x64)
Registry Key: HKLM\SOFTWARE\Classes\Installer\Dependencies\{ca67548a-5ebe-413a-b50c-4b9ceb6d66c6} 
Configuration: x64
Version: 11.0.61030.0 
```

直接下载网址：[https ://download.microsoft.com/download/1/6/B/16B06F60-3B20-4FF2-B699-5E9B7962F9AE/VSU_4/vcredist_x64.exe](https://download.microsoft.com/download/1/6/B/16B06F60-3B20-4FF2-B699-5E9B7962F9AE/VSU_4/vcredist_x64.exe)

```
Microsoft Visual C++ 2012 Redistributable (x86)
Registry Key: HKLM\SOFTWARE\Classes\Installer\Dependencies\{33d1fd90-4274-48a1-9bc1-97e33d9c2d6f} 
Configuration: x86
Version: 11.0.61030.0 
```

直接下载网址：[https ://download.microsoft.com/download/1/6/B/16B06F60-3B20-4FF2-B699-5E9B7962F9AE/VSU_4/vcredist_x86.exe](https://download.microsoft.com/download/1/6/B/16B06F60-3B20-4FF2-B699-5E9B7962F9AE/VSU_4/vcredist_x86.exe)

***版本警告***：根据用户[Wai Ha Lee](https://stackoverflow.com/users/1364007/wai-ha-lee)的调查结果，“...... *VC++ 2012 更新 4 ( )**附带的二进制文件具有ATL 和 MFC 二进制文件以及其他所有文件的版本，例如 msvcp110.dll 和 msvcr110.dll`11.0.61030.0``11.0.60610.1``11.0.51106.1`*。 ..”

***附加警告——2012 更新 4***：每个用户[Krptodr](https://stackoverflow.com/users/3311255/krptodr) VC++ 2012 更新 4 (x86) 在 GUID 下显示`{95716cce-fc71-413f-8ad5-56c2892d4b3a}`

VC++ 2012 Update 4 (x64) 在 GUID 下显示`{a1909659-0a08-4554-8af1-2175904903a1}`

^^ 提供的 GUID 用于安装程序包。但是，这些分支分为各自的拱形类型的另外两个 GUID。有关详细信息，请参阅以下来源[如何检查是否安装了 Microsoft Visual C++ 运行时](https://pingfu.net/how-to-detect-which-version-of-visual-c-runtime-is-installed)

* * *

## 视觉 C++ 2013

```
Microsoft Visual C++ 2013 Redistributable (x64)
Registry Key: HKLM\SOFTWARE\Classes\Installer\Dependencies\{050d4fc8-5d48-4b8f-8972-47c82c46020f} 
Configuration: x64
Version: 12.0.30501.0 
```

直接下载网址：[https ://download.microsoft.com/download/2/E/6/2E61CFA4-993B-4DD4-91DA-3737CD5CD6E3/vcredist_x64.exe](https://download.microsoft.com/download/2/E/6/2E61CFA4-993B-4DD4-91DA-3737CD5CD6E3/vcredist_x64.exe)

```
Microsoft Visual C++ 2013 Redistributable (x86)
Registry Key: HKLM\SOFTWARE\Classes\Installer\Dependencies\{f65db027-aff3-4070-886a-0d87064aabb1} 
Configuration: x86
Version: 12.0.30501.0 
```

直接下载网址：[https ://download.microsoft.com/download/2/E/6/2E61CFA4-993B-4DD4-91DA-3737CD5CD6E3/vcredist_x86.exe](https://download.microsoft.com/download/2/E/6/2E61CFA4-993B-4DD4-91DA-3737CD5CD6E3/vcredist_x86.exe)

* * *

## 视觉 C++ 2015

[^(考虑使用 2015-2019 捆绑包作为替代方案)]

```
Microsoft Visual C++ 2015 Redistributable (x64) - 14.0.24215
Registry Key: HKLM\SOFTWARE\Classes\Installer\Dependencies\{d992c12e-cab2-426f-bde3-fb8c53950b0d}
Configuration: x64
Version: 14.0.24215.1 
```

直接下载网址：[https ://download.microsoft.com/download/6/A/A/6AA4EDFF-645B-48C5-81CC-ED5963AEAD48/vc_redist.x64.exe](https://download.microsoft.com/download/6/A/A/6AA4EDFF-645B-48C5-81CC-ED5963AEAD48/vc_redist.x64.exe)

```
Microsoft Visual C++ 2015 Redistributable (x86) - 14.0.24215
Registry Key: HKLM\SOFTWARE\Classes\Installer\Dependencies\{e2803110-78b3-4664-a479-3611a381656a}
Configuration: x86
Version: 14.0.24215.1 
```

直接下载网址：[https ://download.microsoft.com/download/6/A/A/6AA4EDFF-645B-48C5-81CC-ED5963AEAD48/vc_redist.x86.exe](https://download.microsoft.com/download/6/A/A/6AA4EDFF-645B-48C5-81CC-ED5963AEAD48/vc_redist.x86.exe)

* * *

## 视觉 C++ 2017

[^(考虑使用 2015-2019 捆绑包作为替代方案)]

*警告*：要么正在使用新的 2017 年注册表约定，要么尚未最终确定。正如我猜测的最上面的键： `[HKEY_CLASSES_ROOT\Installer\Dependencies\,,amd64,14.0,bundle]` 和 `[HKEY_CLASSES_ROOT\Installer\Dependencies\,,x86,14.0,bundle]`

可能会发生变化，或者至少有不同的嵌套 GUID，我将使用列出以 GUID 结尾的键。

```
Microsoft Visual C++ 2017 Redistributable (x64) - 14.16.27012
Registry Key: [HKEY_CLASSES_ROOT\Installer\Dependencies\VC,redist.x64,amd64,14.16,bundle\Dependents\{427ada59-85e7-4bc8-b8d5-ebf59db60423}]
Configuration: x64
Version: 14.16.27012.6 
```

直接下载网址：[https ://download.visualstudio.microsoft.com/download/pr/9fbed7c7-7012-4cc0-a0a3-a541f51981b5/e7eec15278b4473e26d7e32cef53a34c/vc_redist.x64.exe](https://download.visualstudio.microsoft.com/download/pr/9fbed7c7-7012-4cc0-a0a3-a541f51981b5/e7eec15278b4473e26d7e32cef53a34c/vc_redist.x64.exe)

```
Microsoft Visual C++ 2017 Redistributable (x86) - 14.16.27012
Registry Key: [HKEY_CLASSES_ROOT\Installer\Dependencies\VC,redist.x86,x86,14.16,bundle\Dependents\{67f67547-9693-4937-aa13-56e296bd40f6}]
Configuration: x86
Version: 14.16.27012.6 
```

直接下载网址：[https ://download.visualstudio.microsoft.com/download/pr/d0b808a8-aa78-4250-8e54-49b8c23f7328/9c5e6532055786367ee61aafb3313c95/vc_redist.x86.exe](https://download.visualstudio.microsoft.com/download/pr/d0b808a8-aa78-4250-8e54-49b8c23f7328/9c5e6532055786367ee61aafb3313c95/vc_redist.x86.exe)

* * *

## Visual C++ 2019（*2015-2019 捆绑包*）

*警告*：Visual C++ 2019 使用了另一个新的注册表约定。Visual C++ 2019 似乎也没有独立的安装程序，只有 Visual C++ 2015 到 2019 的捆绑安装程序。

**14.21.27702**

```
Microsoft Visual C++ 2015-2019 Redistributable (x64) - 14.21.27702
Registry Key: [HKEY_CLASSES_ROOT\Installer\Dependencies\VC,redist.x64,amd64,14.21,bundle\Dependents\{f4220b74-9edd-4ded-bc8b-0342c1e164d8}]
Configuration: x64
Version: 14.21.27702 
```

直接下载网址：[https ://download.visualstudio.microsoft.com/download/pr/9e04d214-5a9d-4515-9960-3d71398d98c3/1e1e62ab57bbb4bf5199e8ce88f040be/vc_redist.x64.exe](https://download.visualstudio.microsoft.com/download/pr/9e04d214-5a9d-4515-9960-3d71398d98c3/1e1e62ab57bbb4bf5199e8ce88f040be/vc_redist.x64.exe)

```
Microsoft Visual C++ 2015-2019 Redistributable (x86) - 14.21.27702
Registry Key: [HKEY_CLASSES_ROOT\Installer\Dependencies\VC,redist.x86,x86,14.21,bundle\Dependents\{49697869-be8e-427d-81a0-c334d1d14950}]
Configuration: x86
Version: 14.21.27702 
```

直接下载网址：[https ://download.visualstudio.microsoft.com/download/pr/c8edbb87-c7ec-4500-a461-71e8912d25e9/99ba493d660597490cbb8b3211d2cae4/vc_redist.x86.exe](https://download.visualstudio.microsoft.com/download/pr/c8edbb87-c7ec-4500-a461-71e8912d25e9/99ba493d660597490cbb8b3211d2cae4/vc_redist.x86.exe)

**14.22.27821**

```
Microsoft Visual C++ 2015-2019 Redistributable (x86) - 14.22.27821
Registry Key: [HKEY_CLASSES_ROOT\Installer\Dependencies\VC,redist.x86,x86,14.22,bundle\Dependents\{5bfc1380-fd35-4b85-9715-7351535d077e}]
Configuration: x86
Version: 14.22.27821 
```

直接下载网址： [https ://download.visualstudio.microsoft.com/download/pr/0c1cfec3-e028-4996-8bb7-0c751ba41e32/1abed1573f36075bfdfc538a2af00d37/vc_redist.x86.exe](https://download.visualstudio.microsoft.com/download/pr/0c1cfec3-e028-4996-8bb7-0c751ba41e32/1abed1573f36075bfdfc538a2af00d37/vc_redist.x86.exe)

```
Microsoft Visual C++ 2015-2019 Redistributable (x86) - 14.22.27821
Registry Key: [HKEY_CLASSES_ROOT\Installer\Dependencies\VC,redist.x64,amd64,14.22,bundle\Dependents\{6361b579-2795-4886-b2a8-53d5239b6452}]
Configuration: x64
Version: 14.22.27821 
```

直接下载网址： [https ://download.visualstudio.microsoft.com/download/pr/cc0046d4-e7b4-45a1-bd46-b1c079191224/9c4042a4c2e6d1f661f4c58cf4d129e9/vc_redist.x64.exe](https://download.visualstudio.microsoft.com/download/pr/cc0046d4-e7b4-45a1-bd46-b1c079191224/9c4042a4c2e6d1f661f4c58cf4d129e9/vc_redist.x64.exe)

* * *

**变更日志**：
2021 年 10 月 26 日——更新以进一步阐明 10 月 21 日的调查结果。
2021 年 10 月 21 日 - 根据 Krptodr 的调查结果，为 VC++2012 Update 4 (x86) 和 (x64) GUID 添加了额外的警告细节。
2019 年 8 月 19 日 -- 添加了 2015-2019 捆绑版本的新版本
2019 年 6 月 13 日 -- 为 2015-2019 捆绑版本添加了一个新部分，`14.21.27702`并在 2015 和 2017 部分添加了关于考虑使用新版本的[^(小注释)]捆绑作为替代。2018 年 12 月 14 日 --根据 Jim Wolff 的调查结果
更新 MSVC2008 以获取 Service Pack 1 的更新 2018 年 11 月 27 日 -- MSVC2017 v. 更新信息`9.0.30729.6161`
`14.16`
2018 年 9 月 12 日——根据 Wai Ha Lee 的调查结果为 2012 更新 4 添加了版本警告 2018 年
8 月 24 日——更新了 2017 年版本 14.15.26706，更新的 Visual C++ 依赖项与 VS 2017 15.8.1 打包在一起
2018 年 5 月 16 日——将 14.14.26405.0 的 2017 版本更新为新的 C++ 2017 条目
2017 年 9 月 8 日 - 将 14.11.25325.0 的 2017 版本更新为新的 Visual C++ 2017 条目
2017 年 4 月 7 日 - 将 2017 的版本 14.10.25008.0 更新为新的 Visual C++ 2017 条目
2016 年 10 月 24 日 -- 更新 2015 年版本信息 14.0.24215.1
2016 年 8 月 18 日 -- 更新 2015 年版本信息 14.0.24212
2016 年 5 月 27 日 -- 更新 MSVC2015 更新 2 信息

如果其中任何一个变得过时，请在此处与我联系。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-01-28T14:30:43.420

尝试

```
HKLM\SOFTWARE\Microsoft\DevDiv\VC\Servicing\11.0 
```

作为起点。我将使用它作为安装 VC++ 11 (VS 2012) 运行时的检查。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2013-02-14T15:28:12.733

您可以检查此注册表位置中的`Installed`值：在 64 位系统上。在会导致访问注册表项的代码中。注意没有。`1``HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\VisualStudio\11.0\VC\Runtimes\x86``HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\11.0\VC\Runtimes\x86``Wow6432Node`

在 32 位系统上，注册表是相同的，但没有`Wow6432Node`：`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\11.0\VC\Runtimes\x86`

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-08-31T06:52:47.920

Visual C++ 附带的引导程序包清单中没有 installcheck 元素。如果您将其设置为先决条件，猜猜微软希望始终安装。

当然你仍然可以调用 MsiQueryProductState 来检查是否通过 MSI 安装了 VC redist 包，可以通过运行找到包代码

```
wmic product get 
```

在命令行，或者如果你已经在 wmic:root\cli，运行

```
product where "Caption like '%C++ 2012%'" 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-11-12T10:05:20.780

不幸的是，这个简单问题的答案并不简单，而是在 100% 的所有系统中工作，甚至可以扩展到众多 .net 框架。

复杂性来自这样一个事实，即存在（并且曾经）许多 VC 运行时修订，这可能导致尽管安装了 VC10 运行时，但它们的内部版本号不够新，因此除非您安装了非常您需要的确切运行时或较新的运行时之一，它使同一主要版本的此版本和以前的版本能够与它一起运行（并排地狱）。此外，如果您有 64 位 EXE，则必须同时检查 32 位和 64 位运行时。

也就是说，确定您的 EXE 的运行时是否已安装的唯一可靠方法*是尝试运行该 EXE* - 或另一个与您的主 EXE 具有相同设置且其唯一目的是不执行任何操作的 EXE。只是运行（这意味着运行时已安装）或运行失败（未安装时）。

我为需要安装 VC10 32 位和 64 位运行时的安装程序执行了以下操作：安装程序尝试启动所有虚拟 EXE，如果成功，则认为已安装相应的运行时。这也解决了 32/64 位方案。

顺便说一句，这也可以确定是否安装了正确的 .net 框架，这在 Windows 8 和 10 中非常棘手，因为可下载的内置 .net 3.5 支持也支持 .net 版本 3.0 和 2.0 - 那里没有这些的注册表项。（更糟糕的是，您甚至不能在这里使用标准框架安装程序，您**必须**使用内置支持并通过 Windows 下载它，或者使用 .net 4 重新构建您的应用程序，但那是另一回事了）。

可以使用具有以下代码的项目构建 C++ 虚拟 EXE（如果需要，还可以使用 64 位配置的另一个项目）：

```
int _tmain(int argc, _TCHAR* argv[])
{
    return 0;
} 
```

请记住将项目的属性**Use of MFC**设置为**Use MFC in a shared DLL**。可执行文件的大小约为 4KB - 为获得确定的结果付出了很小的代价。

为了给您的用户提供良好的安装体验，您可以执行以下操作（示例代码适用于**NSIS**）：

```
Function TryLaunchApplication
  Pop $1 ; pathname
  nsExec::Exec $1
  Pop $0

  ${If} $0 == "error"
  ${OrIf} $0 != 0
    Push 0
  ${Else}
    Push 1
  ${EndIf}
FunctionEnd 
```

并在函数中调用它，例如**CheckRuntimes**

```
Function CheckRuntimes
  ; Try to execute VC++ 10 application (32 bit)
  Push "Vc10RuntimeCheckerApp.exe"
  Call TryLaunchApplication
  Pop $Vc10RuntimesFound

  ; Add 64 bit check if required.
  ; Remember to try running the 64 bit EXE only on a 64 bit OS,
  ; which requires further checks.

  ; Try to execute .net application
  Push "DotNetRuntimeCheckerApp.exe"
  Call TryLaunchApplication
  Pop $DotNetFrameworkFound
FunctionEnd 
```

然后启动运行时检查，例如在离开**欢迎**页面并缓存结果时，这样您就不必在每次用户单击“返回”和“下一步”按钮时重新检查。

接下来，在安装树中创建一个只读部分，并在显示**组件**页面之前执行的功能上预先选择或取消选择它。

这将确保每个缺少的运行时组件的安装都是强制性的，如果它已经存在则跳过它。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-01-29T01:05:05.513

由于 Visual Studio 2010 及更高版本停止使用 WinSxS，因此只需检查 %windir%\system32\msvcr110.dll 就足够了。如果要验证是否有足够新的版本，可以检查文件版本是 11.0.50727.1 (VS2012 RTM) 还是 11.0.51106.1 (VS2012 Update 1)。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-05-16T18:58:03.583

我遇到了这个问题，在检查作为由 WiX 创建的 MSI 安装程序的一部分的 Visual C++ 可再发行组件的上下文中寻找答案。

我不喜欢 GUID 随版本和操作系统的变化，所以我最终创建了一个用 C# 编写的自定义操作来检查 Visual C++ 可再发行组件。

以下所有内容都专门针对 Visual C++ 2015 Redistributable (x64)，但可以轻松修改为任何版本。

```
using Microsoft.Deployment.WindowsInstaller;
using Microsoft.Win32;

namespace CustomActions
{
    public class DependencyChecks
    {
        [CustomAction]
        public static ActionResult IsVC2015RedistInstalled(Session session)
        {
            session.Log("Begin Visual C++ 2015 Redistributable installation check.");

            var dependenciesKey = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Classes\\Installer\\Dependencies");

            foreach(var subKey in dependenciesKey.GetSubKeyNames())
            {
                var dependency = dependenciesKey.OpenSubKey(subKey);
                var displayName = (string)dependency.GetValue("DisplayName");
                if(displayName != null)
                {
                    if (displayName.Contains("Microsoft Visual C++ 2015 Redistributable (x64)"))
                    {
                        session.Log("Visual C++ 2015 Redistributable is installed.");
                        return ActionResult.Success;
                    }
                }
            }

            session.Log("Visual C++ 2015 Redistributable is not installed.");
            session.Message(InstallMessage.Error, new Record(1, "This application requires Visual C++ 2015 Redistributable. Please install, then run this installer again. https://www.microsoft.com/en-us/download/details.aspx?id=53587"));
            return ActionResult.Failure;
        }
    }
} 
```

然后在wxs文件中

```
<Binary Id='VC2015RedistCheck' SourceFile='!(wix.ResourcesDir=resources)\CustomActions.CA.dll'/>
    <CustomAction
      Id='VC2015RedistCheckAction'
      Execute='immediate'
      BinaryKey='VC2015RedistCheck'
      DllEntry="IsVC2015RedistInstalled"
      Return='check'/>

<InstallExecuteSequence>
  <Custom Action='VC2015RedistCheckAction' After='InstallInitialize'/>
</InstallExecuteSequence> 
```

**编辑** 我正在使用有关创建和使用自定义操作的一些基本信息来更新此答案。

为了在安装了 WiX Toolset Visual Studio 2017 扩展的 Visual Studio 2017 中创建自定义操作，我使用项目模板来创建自定义操作（C# Custom Action Project for WiX v3）。

我检查了生成的项目，它似乎已经在本文开头列出了更改：[https](https://www.codeproject.com/Articles/132918/Creating-Custom-Action-for-WIX-Written-in-Managed) ://www.codeproject.com/Articles/132918/Creating-Custom-Action-for-WIX-Written-in-Managed所以我在该部分选择了那篇文章，`Adding Custom Action to the Installer`并对其进行了一些调整。

我做的另一件事是将构建项目的 .NET 框架的版本更改为 3.5。

我没有发现它真的很有用，但您也可以查看[http://wixtoolset.org/documentation/manual/v3/wixdev/extensions/authoring_custom_actions.html](http://wixtoolset.org/documentation/manual/v3/wixdev/extensions/authoring_custom_actions.html)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-09-19T13:08:59.890

对我来说，这个位置有效：HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\DevDiv\vc\Servicing\11.0\RuntimeMinimum\Version

安装软件包后检查您拥有的版本，并将其用作安装程序中的条件。（安装 VCred 后我的设置为 11.0.50727）。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-11-25T19:21:43.863

只需转到控制面板>程序和功能，它们都会出现在那里。

我不是专家，与人们回答的内容（检查注册表）相比，这个答案非常简单，所以我不确定它是否是正确的答案，但它对我有用。

![程序和特点](../Images/883c31dcb932af94f46dec137ced7980.png)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-11-29T20:26:40.997

```
if RegRead("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\10.0\VC\VCRedist\x86","Installed") = 0 Then
  if RegRead("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\11.0\VC\Runtimes\x86","Installed") = 0 Then 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-01-09T08:00:19.837

我已经用 InnoSetup 成功地做到了这一点。

我检查了注册表项的存在：

`HKLM\SOFTWARE\Microsoft\VisualStudio\11.0\VC\Runtimes`

如果卸载，则不存在。如果已安装，则存在。

顺便说一句，它也可能在 Wow6432Node 中：

`HKLM\SOFTWARE\Wow6432Node\Microsoft\VisualStudio\11.0\VC\Runtimes`

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-12-08T21:13:04.473

这个 PowerShell 代码应该可以解决问题

```
Get-ItemProperty
HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall\* | 
Select-Object DisplayName, DisplayVersion, Publisher, InstallDate |
Format-Table –AutoSize 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-06-24T15:17:12.707

[通过MsiQueryProductState](https://msdn.microsoft.com/en-us/library/windows/desktop/aa370363(v=vs.85).aspx)检查产品的安装状态几乎等同于直接检查注册表，但您仍然需要[ProductCode](https://msdn.microsoft.com/en-us/library/windows/desktop/aa370854(v=vs.85).aspx)的 GUID 。

如其他地方所述，这些方法的一个缺点是每次更新都有自己的 ProductCode！

值得庆幸的是，MSI 提供了一个[UpgradeCode](https://msdn.microsoft.com/en-us/library/windows/desktop/aa372375(v=vs.85).aspx)来标识一个“系列”产品。您可以使用 orca 打开其中一个 MSI 以提取此信息。例如，VS2015 的可再发行组件的 UpgradeCode 是`{65E5BD06-6392-3027-8C26-853107D3CF1A}`

您可以使用[MsiEnumRelatedProducts](https://msdn.microsoft.com/en-us/library/windows/desktop/aa370103(v=vs.85).aspx)获取该 UpgradeCode 的所有产品 ID。在实践中，由于每个 redist 更新都会替换前一个，因此只会产生一个 ProductCode - 例如`{B5FC62F5-A367-37A5-9FD2-A6E137C0096F}`VS2015 Update 2 x86。

无论如何，您可以通过[MsiGetProductInfo](https://msdn.microsoft.com/en-us/library/windows/desktop/aa370130(v=vs.85).aspx) (productCode, INSTALLPROPERTY_VERSIONSTRING, ...) 或类似功能检查版本，以与您想要的版本进行比较，例如检查等效或更高版本。

请注意，在 C++ 应用程序中，您还可以使用`_VC_CRT_MAJOR_VERSION`, `_VC_CRT_MINOR_VERSION`，`_VC_CRT_BUILD_VERSION`如果您`#include <crtversion.h>`-- 这样您可以确定计算构建二进制文件的 CRT 版本。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-02-27T14:17:27.297

我需要同样的东西，虽然 AFAIK 这不能以编程方式完成，但它对我有用。

我只是去开始 --> 卸载程序，然后向下滚动，直到找到 VC++ 可再发行组件，其中包括一个版本号。谷歌搜索版本号，告诉我它属于 VS2012 SP1。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2015-08-26T06:53:38.950

老问题，但这是我们自 Visual Studio 2005 以来成功使用的方法。我刚刚也使用 Visual Studio 2012 Update 4 对其进行了测试（因为我们最终将软件从 2010 年更新到 2012 年）。

由于 Visual C++ Redistributable 包在 windows 中注册了它们的卸载程序（因此它显示在控制面板的“程序和功能”列表中），我们只需检查注册表中卸载程序键的显示名称。

以下是相关的 NSIS 代码：

```
ReadRegStr $0 HKLM "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\{33d1fd90-4274-48a1-9bc1-97e33d9c2d6f}\" "DisplayName"
StrCmp $0 "Microsoft Visual C++ 2012 Redistributable (x86) - 11.0.61030" vs2012redistInstalled
DetailPrint "Microsoft Visual C++ 2012 Update 4 Redistributable not found!"
DetailPrint "Downloading from www.mywebsite.com"
; insert applicable download code here
ExecWait '"<downloaded redist exe>" /promptrestart /passive'
vs2012redistInstalled: 
```

请注意，由于我们的安装程序是 32 位 exe，Windows 会处理确定注册表项是否实际上位于虚拟化的 Wow6432Node 而不是上述位置，因此上述代码适用于 64 位和 32 位 Windows 安装，而无需显式检查这两个键。

另请注意，要将上述代码更新为不同版本的 VC++ Redist，只需将注册表项路径中的 GUID 和显示名称更改为您需要的任何内容。

虽然这可能不是推荐的方法，但在过去 10 年中，它已经在 10,000 多台机器上运行，运行从 XP/XP64 到 Windows 10 的各种 Windows 版本，使用 2005、2010、2010sp1 和现在的 2012u4 的 redist。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-02-02T16:40:56.103

我会检查的`Installed`值

`HKLM\SOFTWARE\[WOW6432Node]\Microsoft\Windows\CurrentVersion\Uninstall\{VCRedist_GUID}`钥匙

*   其中的 GUID`VC++ 2012 (x86)`是`{33d1fd90-4274-48a1-9bc1-97e33d9c2d6f}`
*   `WOW6432Node`是否存在取决于`VC++ redist`产品

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-02-07T18:15:45.850

大多数人错过的是`/reg:32`在 Windows x64 上检查密钥的要求。

请参阅有关此主题的[Microsoft 帮助文章。](https://support.microsoft.com/en-us/help/948698/you-cannot-use-the-reg.exe-utility-to-access-64-bit-registry-keys-on-a-64-bit-computer-from-a-computer-that-is-running-a-32-bit-version-of-windows-server-2003,-windows-xp,-windows-server-2008,-or-windows-vista "测试")

这是一个演示如何正确检查 Visual C++ Redistributable for Visual Studio 2012 Update 4 的脚本。

```
@ECHO OFF

:Author
REM "CREATED BY WAR59312"
REM "FEB 7th 2017"

REM Clear Screen
CLS

TITLE Detect Visual C++ 2012 Redistributables

REM This Batch Script Detects If Visual C++ Redistributable for Visual Studio 2012 Update 4 Is Installed

:DetectWindowsOS
REM Are We Running On x86 Or x64
IF NOT DEFINED PROCESSOR_ARCHITEW6432 (
IF %PROCESSOR_ARCHITECTURE% EQU x86 (
REM Windows Is x86
GoTo Check32Bit
) ELSE (
REM Windows Is x64
SET NeededFor64BitOnly=/reg:32
GoTo Check64Bit
)) ELSE (
REM Windows Is Unknown But Assume x64 To Be Safe
SET NeededFor64BitOnly=/reg:32
GoTo Check64Bit
)

:Check64Bit
REM Checks If Visual C++ 64Bit Redistributable for Visual Studio 2012 Update 4 Is Installed
REG QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\11.0\VC\Runtimes\x64" /v "Version" %NeededFor64BitOnly% 2>NUL^ | (
  FIND "v11.0.61030.00" >NUL
) && (
  ECHO.
  ECHO 64bit Visual C++ Redistributable for Visual Studio 2012 Update 4 Is Installed
  ECHO.
  GoTo Check32Bit
) || (
   ECHO.
   ECHO 64bit Visual C++ Redistributable for Visual Studio 2012 Update 4 Is NOT Installed
   ECHO.
   GoTo Check32Bit
)

:Check32Bit
REM Checks If Visual C++ 32Bit Redistributable for Visual Studio 2012 Update 4 Is Installed
REG QUERY "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\11.0\VC\Runtimes\x86" /v "Version" %NeededFor64BitOnly% 2>NUL^ | (
  FIND "v11.0.61030.00" >NUL
) && (
   ECHO.
   ECHO 32bit Visual C++ Redistributable for Visual Studio 2012 Update 4 Is Installed
) || (
   ECHO.
   ECHO 32bit Visual C++ Redistributable for Visual Studio 2012 Update 4 Is NOT Installed
)

:END
ECHO.
PAUSE

EXIT 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-03-29T21:06:08.870

我在 Server 2019 和 Windows 10 中为 PowerShell 使用了这一衬里。我不知道这是多么向后兼容。

```
Get-CimInstance -Class Win32_Product -Filter "Name LIKE '%Visual C++ %Redistri%'" | Select Name, Caption, Version 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-02-22T17:27:58.230

很难获得 VC 2012 的所有注册表值，所以我编写了一个小函数，它将遍历所有依赖项并匹配指定版本。

```
public static bool IsVC2012Installed()
{
    string dependenciesPath = @"SOFTWARE\Classes\Installer\Dependencies";

    using (RegistryKey dependencies = Registry.LocalMachine.OpenSubKey(dependenciesPath))
    {
        if (dependencies == null) return false;

        foreach (string subKeyName in dependencies.GetSubKeyNames().Where(n => !n.ToLower().Contains("dotnet") && !n.ToLower().Contains("microsoft")))
        {
            using (RegistryKey subDir = Registry.LocalMachine.OpenSubKey(dependenciesPath + "\\" + subKeyName))
            {
                var value = subDir.GetValue("DisplayName")?.ToString() ?? null;
                if (string.IsNullOrEmpty(value)) continue;

                if (Regex.IsMatch(value, @"C\+\+ 2012")) //here u can specify your version.
                {
                    return true;
                }
            }
        }
    }

    return false;
} 
```

依赖项：

```
using System.Text.RegularExpressions;
using Microsoft.Win32;
using System.Linq; 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-01-08T13:31:40.923

**powershell脚本解决方案：**

根据@kayleeFrye_onDeck 的回答中的信息

我创建了一个 powershell 脚本来检查和安装用户指定的版本，我没有对它进行过广泛的测试，但是对于我自己的 CI（持续集成）场景，它可以完美地工作。

[github](https://github.com/JimWolff/PowershellVsRedistInstaller)上的完整脚本和信息

我使用的方法是根据此处提供的信息检查 regkeys。以下是脚本所做的要点：

```
function Test-RegistryValue {
param (
 [parameter(Mandatory=$true)]
 [ValidateNotNullOrEmpty()]$Path,
 [parameter(Mandatory=$true)]
 [ValidateNotNullOrEmpty()]$Value
)
    try {
    Get-ItemProperty -Path "$($Path+$Value)" -ErrorAction Stop | Out-Null
        return $true
    }
    catch {
        return $false
    }
} 
```

基于它的检查/下载/静默安装`$redistInfo`包含来自kayleeFrye_onDeck的编译信息。

```
$redistInstalled = Test-RegistryValue -Path $redistInfo.RegPath -Value $redistInfo.RegValue
if($redistInstalled -eq $False) {
    Invoke-WebRequest -Uri $redistInfo.DownloadUrl -OutFile $downloadTargetPath
    Start-Process -FilePath $downloadTargetPath -ArgumentList "$($redistInfo.SilentInstallArgs)" -Wait -NoNewWindow | Wait-Process
} 
```

完整的脚本和更多信息可以在[github上找到](https://github.com/JimWolff/PowershellVsRedistInstaller)

欢迎任何人贡献，如果我有时间，我将对脚本进行更广泛的测试，并在此处添加信息时继续尝试添加新包。

* * *

## 回答 #21

> 赞同：-5
> 
> 时间：2012-08-31T06:48:38.837

你可以在注册表中搜索。实际上我没有vs2012，但我有vs2010。

3 个平台包中的每一个都有 3 个不同（但非常相似）的注册表项。每个键都有一个名为“Installed”的 DWORD 值，值为 1。

*   HKLM\SOFTWARE\Microsoft\VisualStudio\10.0\VC\VCRedist\x86

*   HKLM\SOFTWARE\Microsoft\VisualStudio\10.0\VC\VCRedist\x64

*   HKLM\SOFTWARE\Microsoft\VisualStudio\10.0\VC\VCRedist\ia64

您可以使用注册表功能......

# ruby-on-rails - ruby on rails I18 循环

> ID：12206317
> 
> 赞同：4
> 
> 时间：2012-08-30T22:13:23.797
> 
> 标签：ruby-on-rails, internationalization

我想知道是否可以为每个 I18 子项创建一个循环。假设我有一个 .yml 文件，如下所示：

```
subject:
    item1:
       title:
       text:
    item2:
       title:
       text:
    item3:
       title:
       text: 
```

我想做的是：

```
I18.t('subject').each { |item| title = item.title } 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T07:28:52.250

尝试：

```
I18.t('subject').map{ |key, value| value[:title] } #or value["title"] I can't recall 
```

# node.js - 自定义内存缓存

> ID：12206318
> 
> 赞同：3
> 
> 时间：2012-08-30T22:13:24.360
> 
> 标签：node.js, memcached

想象有一个网络服务：

*   在服务器集群 (nginx/node.js) 上运行
*   所有数据都远程存储
*   必须在 20ms 内响应

必须为响应读取的数据是这样拆分的..

**批次A**

*   数百万个存储在 AWS DynamoDB 中的小对象
*   在随机时间随机更新
*   只有一致的读取，不能被捕获

**批次B**

*   约 2,000 条 SQL 记录
*   很少更新，记录最多1KB
*   最长可捕获 60-90 秒

我们不能一次全部读取它们，因为我们不知道从 BatchB 中获取哪些记录，直到我们从 BatchA 中读取。

从 DynamoDB 读取最多需要 10 毫秒。如果我们从远程位置读取 BatchB，我们将没有时间进行计算，或者我们已经超时。

我目前的想法是将所有 BatchB 记录加载到每个节点的内存中（只有 ~2MB）。启动时，系统将连接到 SQL 服务器并获取所有记录，然后每 60 或 90 秒更新一次。问题是**最好的方法是什么**？

我可以简单地将它们全部读入 node.js 中的变量（数组），然后在 60-90 秒后使用 SetTimeout 更新数组。但这**是最好的解决方案**吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T20:32:22.497

你的解决方案听起来不错。它符合您的需求。去吧。

我建议在从远程位置更新缓存的过程中保留两个缓存副本。在收到 2MB 时，您已经获得了数据的部分副本。我会保留旧缓存，直到完全接收到新数据。

另一种方法是只维护一个缓存集并在每条记录到达时对其进行更新。然而，这更难以实现并且容易出错。（例如，如果不再在远程位置找到记录，您不应该忘记从缓存中删除它们。）这种方法可以节省内存，但我认为 2MB 并不是什么大问题。

# ruby-on-rails - Rails 型号名称可以包含数字吗？

> ID：12206320
> 
> 赞同：2
> 
> 时间：2012-08-30T22:13:34.843
> 
> 标签：ruby-on-rails

我有约 6000 条记录的数据集，其中每条记录都有一个日期字段，我想按年份对其进行隔离以使其更易于管理。我成功地生成了一个脚手架，然后运行了一次迁移，并将当年的记录放入数据库中。然后我销毁了脚手架，以便为每年生成单独的脚手架。我尝试将第一个命名为“2012Violation”（我成功创建然后销毁的脚手架简称为“Violation”），但我得到了 NameError“错误的常量名称 2012Violation”。我怀疑也许 rails 不允许在型号名称中使用数字。如果这确实是导致此错误的原因，关于如何命名一堆不同的脚手架/模型的任何建议，这些脚手架/模型将主要根据记录的年份而有所不同？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-30T22:16:02.287

您可以使用数字，但第一个字符不能是数字。

# .net - 我的针对多个目标框架的构建脚本是否正常工作？

> ID：12206323
> 
> 赞同：5
> 
> 时间：2012-08-30T22:13:47.667
> 
> 标签：.net, visual-studio, msbuild, visual-studio-2012, .net-4.5

我写了一个小 MSBuild 脚本来在多个版本上构建我的项目。当我从 VS2012 命令提示符运行它时，它可以工作，我没有收到任何错误或异常。但是，当我比较生产的组件时，它们是相同的。我的脚本有问题吗？

```
<Target Name="Build">

  <MSBuild Projects=".\WcfClientBase\WcfClientBase.csproj" 
           Properties="Configuration=Release;OutputPath=.\BuildArtifacts\net45;TargetFrameworkVersion=v4.5" />

  <MSBuild Projects=".\WcfClientBase\WcfClientBase.csproj"
           Properties="Configuration=Release;OutputPath=.\BuildArtifacts\net40;TargetFrameworkVersion=v4.0" />

  <MSBuild Projects=".\WcfClientBase\WcfClientBase.csproj"
           Properties="Configuration=Release;OutputPath=.\BuildArtifacts\net35;TargetFrameworkVersion=v3.5" />

</Target> 
```

我安装了 VS2012 Professional。我还注意到 .NET 4.5 没有自己的 MSBuild.exe。它使用的是 4.0 版中的那个吗？

**更新**

我使用 Visual Studio 为每个版本构建了它，并且所有程序集都不同。我的脚本有问题。我故意打错了 TargetFrameworkVersion 参数名称，但它仍然构建并产生了相同的输出。也许它无法从项目文件中覆盖该参数，或者我缺少其他参数。还有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T21:20:19.903

您还需要自定义 IntermediateOutputPath 属性，否则所有 3 种风格共享相同的中间目录`obj\Release`。尝试这个：

```
<Target Name="Build"> 
     <MSBuild Projects="WcfClientBase\WcfClientBase.csproj"  
         Properties="Configuration=Release;OutputPath=BuildArtifacts\net45\;IntermediateOutputPath=obj\Release\net45\;TargetFrameworkVersion=v4.5" /> 
     <MSBuild Projects="WcfClientBase\WcfClientBase.csproj"  
         Properties="Configuration=Release;OutputPath=BuildArtifacts\net40\;IntermediateOutputPath=obj\Release\net40\;TargetFrameworkVersion=v4.0" /> 
     <MSBuild Projects="WcfClientBase\WcfClientBase.csproj"  
         Properties="Configuration=Release;OutputPath=BuildArtifacts\net35\;IntermediateOutputPath=obj\Release\net35\;TargetFrameworkVersion=v3.5" /> 
 </Target> 
```

# javascript - 如何在 ajax 回调中使用类变量？

> ID：12206325
> 
> 赞同：0
> 
> 时间：2012-08-30T22:14:04.977
> 
> 标签：javascript

我是 javascript 新手，我想知道如何在我的 ajax 回调中访问我的类变量

```
success: function(data) {
            var obj = jQuery.parseJSON(data);
            this.baralho = obj.countBaralho; 
```

我的课

```
var Placar = {
    descarte : 0,
    jogador1: 0,
    jogador2: 0,
    baralho: 0,

    fetchFromServer: function(){
        $.ajax({
            url: baseUrl+'get-placar',
            success: function(data) {
                var obj = jQuery.parseJSON(data);
                this.baralho = obj.countBaralho;
                this.descarte = obj.countDescarte;
                this.jogador1 = obj.numCartas1;
                this.jogador2 = obj.numCartas2;
            }
        });

    },

    update: function() {
        $('#num-cartas-1').html(this.jogador1);
        $('#num-cartas-2').html(this.jogador2);
        $('#cartas-restantes').html(this.baralho);
        $('#num-cartas-descarte').html(this.descarte);
    }

} 
```

这些值不是从服务器设置的，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:27:00.767

ajax的`this`成功函数中的不是你的对象（它可能是一个 XMLHttpRequest 对象）。

我将使用构造函数而不是对象文字来创建对象，并创建一个闭包以便能够在任何上下文中访问该对象。

```
var Placar = new (function(){
    this.descarte = 0;
    this.jogador1 = 0;
    this.jogador2 = 0;
    this.baralho = 0;
            var self = this;        
    this.fetchFromServer = function(){
        $.ajax({
            url: baseUrl+'get-placar',
            success: function(data) {
                var obj = jQuery.parseJSON(data);
                self.baralho = obj.countBaralho;
                self.descarte = obj.countDescarte;
                self.jogador1 = obj.numCartas1;
                self.jogador2 = obj.numCartas2;
            }
        });

    };

    this.update = function() {
        $('#num-cartas-1').html(self.jogador1);
        $('#num-cartas-2').html(self.jogador2);
        $('#cartas-restantes').html(self.baralho);
        $('#num-cartas-descarte').html(self.descarte);
    };

})(); 
```

# php - PHP spl_autoload_register 什么都不做

> ID：12206327
> 
> 赞同：0
> 
> 时间：2012-08-30T22:14:12.230
> 
> 标签：php, oop, autoload

我正在更新我的代码并尝试使用 spl_autoload_register 但它根本不起作用！！！我在 Centos / Ubuntu / Win7 上使用 PHP 5.3.8 - Apache 2.22 并试图回应一些东西，但我什么也没得到......一直试图让它在过去 3 个小时内工作但没有结果......这是快把我逼疯了！！！

```
class ApplicationInit {
    // Constructor
    public function __construct() {
        spl_autoload_register(array($this, 'classesAutoloader'));
        echo 'construct working...!';
    }

    // Autoloading methods
    public function classesAutoloader($class) {
        include 'library/' . $class . '.php';

        echo 'autoload working...!';
    }
} 
```

来自 __construct 的第一个回显有效，但“classesAutoloader”根本不起作用，此类定义在文件夹内的 php 文件中，我从 index.php 调用它，如下所示：

```
define('DS', DIRECTORY_SEPARATOR);
define('ROOT', getcwd() . DS);
define('APP', ROOT . 'application' . DS);

// Initializing application
require(APP.'appInit.php');
$classAuto = new ApplicationInit(); 
```

任何帮助都非常感谢，在此先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:21:29.637

好像你在做错事。您传递给的函数`spl_autoload_register`负责加载类文件。

您的代码正在调用

```
$classAuto = new ApplicationInit(); 
```

但是到那时，`ApplicationInit`已经加载了，所以不会调用自动加载函数

一个更合乎逻辑的方式是让你打电话

```
spl_autoload_register(function($class){
    include 'library/' . $class . '.php';
}); 
```

然后当你打电话

```
$something = new MyClass(); 
```

并且`MyClass`未定义，然后它将调用您的函数来加载该文件并定义类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T08:03:56.197

你有什么问题？您的代码工作正常。

```
class ApplicationInit {
    public function __construct() {
        spl_autoload_register(array($this, 'classesAutoloader'));
        echo 'construct working...!';
    }

    public function classesAutoloader($class) {
        include 'library/' . $class . '.php';

        echo 'autoload working...!';
    }
}

$classAuto = new ApplicationInit(); //class already loaded so dont run autoload

$newclass = new testClass(); //class not loaded so run autoload 
```

# python - Sphinx 自动摘要“目录树包含对不存在文档的引用”警告

> ID：12206334
> 
> 赞同：48
> 
> 时间：2012-08-30T22:15:00.403
> 
> 标签：python, python-2.7, python-sphinx, toctree, sphinx-napoleon

我正在尝试使用 Sphinx 为大型 python 代码库自动创建 api 文档。

我尝试过使用 build_modules.py 和 sphinx-apidoc。使用任何一个，我都可以在我的输出目录中为包和顶级模块成功创建第一个文档。

但是，当我使用

```
make html 
```

它给出了数千个这种类型的错误：

```
<autosummary>:None: WARNING: toctree contains reference to nonexisting document 'rstDocs/src.Example1.class1.method1' 
```

对于代码库中的每个类和方法。通过一些实验，我想我发现 autosummary/autoclass 指令正在创建期望每个类和方法都有 rst 文件的目录树。

除了警告之外，文档似乎运行良好，但我想摆脱它们，我想我可能配置错误。

我也尝试过[nipype/tools](https://github.com/nipy/nipype/tree/5e03d93f518857a4cfced10e59ab734612c9d94b/tools)来达到同样的效果。

我修改[了 apigen.py](https://github.com/nipy/nipype/blob/master/tools/apigen.py)和[build_modref_templates.py](https://github.com/nipy/nipype/blob/master/tools/build_modref_templates.py)来为这些“缺失”的每个文档创建第一个存根，并根据需要使用 autoclass/autofunction/automethods。但是，构建需要相当长的时间（10 分钟），最终由于最后构建步骤中的内存错误而崩溃。

这是一个创建所有警告的示例模块 rst 文件：

```
src Package
===========

:mod:`src` Package
------------------

.. automodule:: src.__init__
    :members:
    :undoc-members:
    :show-inheritance:

:mod:`Example1` Module
------------------------------------

.. automodule:: src.Example1
    :members:
    :undoc-members:
    :show-inheritance:

:mod:`Example2` Module
------------------

.. automodule:: src.Example2
    :members:
    :undoc-members:
    :show-inheritance: 
```

感谢您提供有关如何解决这些警告的任何建议！我想远离任何涉及修改 sphinx 站点包文件的解决方案。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-03-04T20:46:22.790

抱歉这么晚的答案（如果可以考虑的话），但我发现这个链接讨论了你可能发生的事情：

[https://github.com/phn/pytpm/issues/3#issuecomment-12133978](https://github.com/phn/pytpm/issues/3#issuecomment-12133978)

如果您的文档代码中有一些特殊的 Doc scraper 在 autosummary 已经运行之后构建 autosummary 文档，那么如果您仍然遇到此问题，则可能需要考虑这个想法。虽然，我不确定这会有多大帮助。

`numpydoc_show_class_members = False`链接中的关键是添加：`conf.py`

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-04-05T17:30:05.020

如果您正在使用`numpydoc`扩展程序，则可以考虑将其删除并`sphinx.ext.napoleon`改用。

从 1.3 版开始，这个内置扩展实际上支持 Numpy 和 Google 样式的文档字符串。

因此，在您的遗嘱中删除`numpydoc`和使用可能会解决您的问题。`sphinx.ext.napoleon``conf.py`

* * *

### 来源

*   [拿破仑——迈向清晰的文档字符串](http://sphinxcontrib-napoleon.readthedocs.io/en/latest)
*   [Sphinx Doc - 支持 NumPy 和 Google 样式的文档字符串](http://www.sphinx-doc.org/en/stable/ext/napoleon.html)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2019-05-20T14:46:44.620

我也遇到了这个问题并花了几个小时，以下对我有用：

> 狮身人面像可能会很挑剔，有时会涉及到您没有预料到的事情。例如，您会遇到类似的情况：
> 
> ```
> WARNING: toctree contains reference to nonexisting document u'all-about-me'
> ...
> checking consistency...
> <your repository>/my-first-docs/docs/all-about-me.rst::
> WARNING: document isn't included in any toctree' 
> ```
> 
> 很可能，这里发生的事情是你在你`.. toctree::`的四个空格中缩进了 all-about-me，而 Sphinx 期待三个空格。

来源：[文档](https://dont-be-afraid-to-commit.readthedocs.io/en/latest/documentation.html)！

# iphone - 如何在 iOS 的 UIDatePicker 中阻止天数

> ID：12206336
> 
> 赞同：6
> 
> 时间：2012-08-30T22:15:00.910
> 
> 标签：iphone, ios, xcode, datepicker, uipickerview

我在我的 IOS 应用程序上使用日期选择器，我想知道是否可以阻止某些日子。例如，我需要阻止一年中的所有星期一，这可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T06:39:44.953

您唯一能做的就是添加自定义 UIPickerView 如评论中所述或实现为事件调用的方法，如此[处](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIDatePicker_Class/Reference/UIDatePicker.html)`UIControlEventValueChanged`所述

然后检查有效工作日的新值。您可以通过以下方式获得工作日：

```
NSCalendar* calendar = [NSCalendar currentCalendar];
NSDateComponents* components = [calendar components:NSWeekdayCalendarUnit fromDate:[NSDate date]];
return [components weekday]; // 1 = Sunday, 2 = Monday, ... 
```

无法在滚轮中隐藏某些日子。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-11-29T08:14:00.683

这是该问题的**Swift 4**答案（Nicholas Harlen 的原始答案）：

```
let datePicker: UIDatePicker = UIDatePicker(frame: .zero)
    datePicker.datePickerMode = .date
    datePicker.addTarget(self, action: #selector(datePickerValueChanged(_:)), for: .valueChanged)

@objc func datePickerValueChanged(_ sender: UIDatePicker) {
    let calender: Calendar = Calendar(identifier: .gregorian)
    let weekday = calender.component(.weekday, from: sender.date)
    //sunday
    if weekday == 1 {
        datePicker.setDate(Date(timeInterval: 60*60*24*1, since: sender.date), animated: true)
    } else if weekday == 7 {
        datePicker.setDate(Date(timeInterval: 60*60*24*(-1), since: sender.date), animated: true)
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-23T01:38:52.797

我不得不做类似的事情，但找不到删除日期的方法。但是，我最终做的是，如果选择了无效日期，它将反弹到最近的有效日期，类似于如果您设置最小日期并尝试选择之前的日期，控件的处理方式。

```
-(void)init
{
    datePicker = [[UIDatePicker alloc] initWithFrame:CGRectZero];
    [datePicker setDatePickerMode:UIDatePickerModeDate];
    [datePicker setMinimumDate: [NSDate date]];
    [datePicker addTarget:self action:@selector(onDatePickerValueChanged:) forControlEvents:UIControlEventValueChanged];
}

-(void)onDatePickerValueChanged:(UIDatePicker *)picker
{
    // Work out which day of the week is currently selected.
    NSCalendar *gregorian = [[[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar] autorelease];
    NSDateComponents *comps = [gregorian components:NSWeekdayCalendarUnit fromDate:picker.date];
    int weekday = [comps weekday];

    // Bounce Sundays (weekday=1) forward a day
    if (weekday == 1)
    {
        [datePicker setDate:[NSDate dateWithTimeInterval:60*60*24*1 sinceDate:picker.date] animated: true];
    }
    // Bounce Saturdays (weekday=7) back a day
    else if (weekday == 7)
    {
        [datePicker setDate:[NSDate dateWithTimeInterval:60*60*24*-1 sinceDate:picker.date] animated: true];
    }
} 
```

# android - 如何从 onStartCommand 获取上下文

> ID：12206338
> 
> 赞同：3
> 
> 时间：2012-08-30T22:15:10.967
> 
> 标签：android

我有一个服务，我需要从服务 onStartCommand 访问上下文。

我怎么能那样做。我是安卓新手。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-30T22:18:42.663

您可以使用`ServiceName.this`获取`Context`、`Service`扩展`Context`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:23:55.500

[服务](http://developer.android.com/reference/android/app/Service.html)是一个上下文。你可以使用这个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T22:30:25.757

使用`this.`. [服务扩展了 Context](http://developer.android.com/reference/android/app/Service.html)。

# php - 如何根据当前记录的用户凭据从 MYSQL 数据库中检索信息

> ID：12206339
> 
> 赞同：0
> 
> 时间：2012-08-30T22:15:12.283
> 
> 标签：php, mysql

如果这个问题的标题有点荒谬，我很抱歉，但我真的想不出更好的了。

现在，我基本上试图做的是以下内容：

让用户登录并被重定向到其中包含表单的页面，一旦用户填写表单，就会向用户和邮件列表发送一封电子邮件。

现在，在数据库中，我显然有用户名和密码，除了这两行，我还有一个相应的电子邮件。

我不希望用户输入他的电子邮件，我想以某种方式访问​​包含电子邮件的数据库行，并让电子邮件发送脚本自动用用户的电子邮件填写 from 字段。

如果我发布代码的顺序让您跳来跳去，我真的很抱歉，我不确定哪种顺序最有意义。

验证登录的代码：

```
require 'Mysql.php';

class Membership {

function validate_user($un, $pwd) {
    $mysql = New Mysql();
    $ensure_credentials = $mysql->verify_Username_and_Pass($un, $pwd);

    if($ensure_credentials) {
        $_SESSION['status'] = 'authorized';
        header("location: index.php");
    } else return "Please enter a correct username and password";

} 

function log_User_Out() {
    if(isset($_SESSION['status'])) {
        unset($_SESSION['status']);

        if(isset($_COOKIE[session_name()])) 
            setcookie(session_name(), '', time() - 1000);
            session_destroy();
    }
}

function confirm_Member() {
    session_start();
    if($_SESSION['status'] !='authorized') header("location: login.php");
}

} 
```

访问数据库以检索用户名和密码的代码：

```
require_once 'includes/constants.php';

class Mysql {
private $conn;

function __construct() {
    $this->conn = new mysqli(DB_SERVER, DB_USER, DB_PASSWORD, DB_NAME) or 
                  die('There was a problem connecting to the database.');
}

function verify_Username_and_Pass($un, $pwd) {

    $query = "SELECT *
            FROM members
            WHERE usr = ? AND pass = ?
            LIMIT 1";

    if($stmt = $this->conn->prepare($query)) {
        $stmt->bind_param('ss', $un, $pwd);
        $stmt->execute();

        if($stmt->fetch()) {
            $stmt->close();
            return true;
        }
    }

}
} 
```

在电子邮件脚本中：mail("$row", "test", $messagebody, "From: Website@site.com");

最后，下面是我目前位于包含表单的页面上方的代码：

```
<?php

require_once 'classes/Membership.php';
require_once 'includes/constants.php';
$membership = New Membership();

$membership->confirm_Member();
session_start();

if (isset($_SESSION['username']));
$username = $_SESSION['username'];
$dbc = new mysqli(DB_SERVER, DB_USER, DB_PASSWORD, DB_NAME);
$query = "SELECT email FROM members";
$result = mysqli_query($dbc, $query);
$row = mysqli_fetch_array($result);
?> 
```

我有实际的登录系统运行，它拒绝不正确的用户并传递组合，接受正确的用户并重定向到表单，这只是我不知道该怎么做的邮件部分。我拥有的代码实际上是通过数小时的谷歌搜索拼凑而成的，当它不起作用时，我真的不应该感到惊讶。

任何帮助将不胜感激。（请假装我在发布回复时尽可能简单，编程真的让我头疼）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:25:49.520

你做的部分正确。您使用了会话。但是保持“授权”（如您所见）毫无用处。为什么不保留登录用户的个人资料？通常，您会检查会话中是否有“个人资料”。如果您这样做，则意味着它已被授权使用。如果不是，那就不是。相同的效果，但现在更有用了。所以保留用户引用（通常是他的唯一 ID 甚至是从数据库中获取的整个个人资料，这样你就可以节省一些查询），所以在其他页面上，你可以简单地根据你从会话中获得的 id 获取他的个人资料，并用电子邮件或他的名字预先填写表格管他呢

# asp.net-mvc - jQuery Mobile MVC 箭头 CSS

> ID：12206343
> 
> 赞同：1
> 
> 时间：2012-08-30T22:15:26.640
> 
> 标签：asp.net-mvc, jquery-mobile

我有一个 jQuery 移动网站，在我的 Windows Phone 模拟器和我的 Windows Phone 上看起来不同。

这是 Windows Phone 模拟器上的图片：

![在此处输入图像描述](../Images/6659b28caa831809200b360d76ccb881.png)

在我的 Windows Phone 上，我看不到白色箭头。我只看到灰点。这是我的标记：

```
@model PagedList.IPagedList<product>
@{
    ViewBag.Title = "Index";
}
<div data-role="button" data-theme="c">
@Html.ActionLink("Create New", "Create")
</div>
<br />
<br />
<ul data-role="listview" data-filter="true">
@foreach (var item in Model)
{        
    <li><a href="@Url.Action("Edit", "Admin", new { id = item.ID })">
        <h3>@item.Name</h3>
        <p>
            <strong>@item.FoodCategoryName</strong></p>
    </a></li>
}
</ul>
<br />
<br />
<br />
<div class="pager">
Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber)
of @Model.PageCount
@if (Model.HasPreviousPage)
{
    @Html.ActionLink("<<", "Index", new { page = 1, sortOrder = ViewBag.CurrentSort,    currentFilter = ViewBag.CurrentFilter })
    @Html.Raw(" ");
    @Html.ActionLink("< Prev", "Index", new { page = Model.PageNumber - 1, sortOrder = ViewBag.CurrentSort, currentFilter = ViewBag.CurrentFilter })
}
else
{
    @:<<
    @Html.Raw(" ");
    @:< Prev
            }
@if (Model.HasNextPage)
{
    @Html.ActionLink("Next >", "Index", new { page = Model.PageNumber + 1, sortOrder = ViewBag.CurrentSort, currentFilter = ViewBag.CurrentFilter })
    @Html.Raw(" ");
    @Html.ActionLink(">>", "Index", new { page = Model.PageCount, sortOrder = ViewBag.CurrentSort, currentFilter = ViewBag.CurrentFilter })
}
else
{
    @:Next >
    @Html.Raw(" ")
    @:>>
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T07:59:06.777

似乎是 png 渲染问题。

如果windows phone 有其他浏览器，您可以尝试在其他浏览器中浏览同一页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T13:40:13.550

它实际上是在错误的地方寻找：

~/jquerymobile/images/icon-18-white.png

我改变了这段代码：

\Content\jquery.mobile-1.1.1.css

```
.ui-icon,
.ui-icon-searchfield:after {
background:                         #666 /*{global-icon-    color}*/;
background:                         rgba(0,0,0,.4) /*{global-icon-disc}*/;
background-image: url(Content/images/icons-18-white.png) /*{global-icon-set}*/;
background-repeat: no-repeat;
-moz-border-radius:                 9px;
-webkit-border-radius:              9px;
border-radius:                      9px;
} 
```

# eclipse - Eclipse 隐形编辑器

> ID：12206348
> 
> 赞同：39
> 
> 时间：2012-08-30T22:16:01.180
> 
> 标签：eclipse

我有日食朱诺。我不确定如何，但我在 Eclipse 中的编辑器现在是“不可见的”。我的意思是不可见，编辑器窗格不在可见窗口中。我不是 eclipse 的新手，我知道您可以最小化编辑器或最大化不同的面板 - 但事实并非如此。在编辑器应该位于的这个空白区域上甚至没有最小化/最大化按钮。

但是，标题栏显示当前打开的文件（但在不可见的编辑器中，因此不可见）。我的大纲侧边栏显示了文件的大纲。

我认为这可能发生在拆分编辑器窗格（我经常这样做，喜欢并排比较）以及切换视角时。

关于如何让编辑器回到可见窗口的任何想法？

![在此处输入图像描述](../Images/5321f6d9749292f8674994562bc27bec.png)

上面是它的外观截图。在截屏时，我刚刚单击了一个文件将其打开，它似乎已在隐形编辑器中打开。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2013-03-01T20:59:24.903

我已经尝试了所有给定的解决方案，但没有一个解决了问题。仅使用***Window->New Window***给了我一个新的固定 Eclipse 窗口。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-08-31T01:42:35.223

尝试*Window* > *Reset Perspective*让事情恢复正常。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-13T12:11:24.737

我最小化了sharedArea，恢复后它是空的。编辑器运行良好（打开、关闭、保存等），但我看不到它们。关闭**所有**视角有帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-01T20:21:14.300

当我尝试通过拖动编辑器选项卡来拆分编辑器组时，有时会发生这种情况。唯一对我有用的解决方案是关闭应用程序工具栏中的每个透视图，然后`Window -> New Window`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-16T01:04:11.990

我在拆分窗格时偶尔会发生这种情况。重新启动 Eclipse 对我不起作用，重置透视图也不起作用。

我偶然发现的解决方案是赋予编辑器区域焦点（通过单击它应该在的区域，我想）并使用 Ctrl+W 关闭不可见编辑器中的文件，直到编辑器重新出现。您可能会注意到窗口标题更改为跟随隐藏编辑器中的文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-31T20:26:15.350

我遇到了同样的问题，只需停止/重新启动 Eclipse 即可修复它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-03T12:57:20.703

当重置透视图或重新启动 eclipse 都无济于事时，我有修复：在文件菜单的底部，有你最近尝试取回的文件名。单击它，它应该返回。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-19T14:33:13.457

开始日食：

```
eclipse.exe -repair 
```

# sql - SQL Server：从日期时间获取小时然后更改它

> ID：12206353
> 
> 赞同：0
> 
> 时间：2012-08-30T22:16:23.977
> 
> 标签：sql, sql-server, datetime, sql-server-2008-r2, hour

我已经尝试了一段时间，到目前为止，除了我需要使用一种叫做的东西`DATEPART`（我不知道如何使用它）之外，研究并没有让我走得更远。我的 SQL Server 不是最好的。

我有`declare @DueDate datetime`并且通过游标`@DueDate`将始终是当前行的`DueDate`( `datetime`) 列。到目前为止，这完美无缺。

现在我要做的是从 中取出小时`@DueDate`，检查它是否为 0，如果小时为 0，则将`@DueDate`小时设置为午夜，然后使用此`@DueDate`变量更新行 DueDate 列。

如上所述，我的游标和变量都在工作，我只是不知道如何从中获取小时`@DueDate`，检查小时值是多少，然后更新 @DueDate 变量，使其小时现在是午夜。我知道如何更新表格，这很容易。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T22:19:35.923

我认为这完全符合您的要求，而无需使用光标。

```
UPDATE [MyTable]
SET DueDate = DATEADD(dd, 1, DueDate) -- add one day (set to midnight)
WHERE DATEPART(hh, DueDate) = 0 -- do this for dates where hour is zero (midnight) 
```

请注意，您应该尽可能避免使用游标。SQL 开发需要不同的思维方式。不要考虑迭代，想想原子。您可以在一个语句中完成大多数事情（如果足够复杂，一个语句可能会很长）。

# jquery - 使用 jquery 平滑滚动图像

> ID：12206354
> 
> 赞同：2
> 
> 时间：2012-08-30T22:16:27.547
> 
> 标签：jquery, css, animation, jquery-animate, slider

我正在使用 jQuery 制作徽标滑块。我的第一个想法是使用由所有徽标组成的大型单个图像作为背景并为其位置设置动画。这背后的想法是通过仅加载单个文件来减少 http 请求。

jQuery 代码是这样的：

```
<script>
  $(function(){
    var current = 0;
    function bgscroll(){
      // 20 pixel row at a time
      current -= 20;
      // move the background with backgrond-position css properties
      $('#slider').animate({'background-position' : current+'px'}, 100, 'linear');}
      setInterval(bgscroll, 1);
    });
</script> 
```

但是动画有问题。它闪烁并且不平滑。所以有人知道如何让这个动画更流畅吗？

当前的 CSS

```
#slider{
  height: 97px;
  overflow: hidden;
  background-image: url("../img/logos-long.jpg");
  background-repeat: repeat-x;
  width: 100%;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:19:41.607

在您的示例中，在一个周期结束`interval`之前触发了更多次，所以......`animation`

## *[jsBin 演示](http://jsbin.com/emoruz/2)*

**不需要`setInterval`**
我们何时可以使用您的函数和动画回调创建循环！

```
$(function(){
  function bgscroll(){
    $('#slider').stop().animate({'background-position':'-=1000'},10000,'linear',bgscroll);
  }
  bgscroll(); // initiate!!
}); 
```

使用清除动画队列`.stop()`将使它（不完美但）好得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:19:47.497

您的超时执行速度似乎比每个动画周期完成的速度要快。如果将超时延迟增加到 100 毫秒，我认为闪烁会停止。

# php - 获取连接到路由器的 DHCP 地址

> ID：12206363
> 
> 赞同：0
> 
> 时间：2012-08-30T22:17:28.623
> 
> 标签：php, localhost, dhcp

我运行 MAMP 来进行本地 wordpress 开发，出于各种原因，我需要通过类似`http://192.162.1.99:8888`而不是`http://localhost:8888`. 在我自己的连接上，这通常不是问题，因为我总是使用相同的 IP 连接。但是，当我外出时，我必须弄乱并更改各种常量以反映我使用该路由器的 IP。

那么有没有一种使用 PHP 的技术可以确定这个 DHCP 地址呢？没有任何内容返回`$_SERVER`此地址，`['SERVER_ADDR']`& contains和contains 。`['REMOTE_ADDR']``::1``['HTTP_HOST']``localhost:8888`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T23:39:07.990

可能不是最干净的解决方案，但如果您运行的是 Linux/Unix，您可以在脚本中运行以下 php 系统调用。我没有测试过它，但我相信它会在变量中为您提供正确的 IP。请记住使用您系统的实际以太网/无线适配器名称切换 en1。您可能还需要使用 ifconfig 命令的确切路径。

```
$ipAddress = system('ifconfig en1 | grep inet | cut -d" " -f2' , $returnVal); 
```

抱歉，如果变量名不在 php 标准中，我这些天通常用 Java 开发。

# .net - Windows 8/Chrome 上的 Process.Start(url) 损坏 - 有替代方案吗？

> ID：12206368
> 
> 赞同：23
> 
> 时间：2012-08-30T22:17:48.740
> 
> 标签：.net, google-chrome, process, windows-8, process.start

要从 .NET 应用程序打开 URL，许多站点（[包括 StackOverflow 上](https://stackoverflow.com/questions/58024/open-a-url-from-windows-forms)的站点）都引用了以下示例：

```
Process.Start("http://www.google.com/"); 
```

在 Windows 8 上，如果 Internet Explorer 是默认浏览器，则此方法有效。但是，如果 Google Chrome 是默认设置，则会失败并显示：

```
Unhandled Exception: System.ComponentModel.Win32Exception: Class not registered 
```

这是否表明此方法不再是在 Windows 上打开 URL 的正确方法？存在哪些替代方案？直接启动 Internet Explorer 是否更安全？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-09-03T13:34:07.313

您可以尝试明确指定进程文件名“explorer.exe”，如以下线程中建议的那样：

[http://social.msdn.microsoft.com/Forums/nl-BE/toolsforwinapps/thread/e051a102-469e-4ede-882c-c2c89377652a](http://social.msdn.microsoft.com/Forums/nl-BE/toolsforwinapps/thread/e051a102-469e-4ede-882c-c2c89377652a)

```
var startInfo = new ProcessStartInfo("explorer.exe", url);
Process.Start(startInfo); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T00:34:02.713

使用[Launcher](http://msdn.microsoft.com/en-us/library/windows/apps/br241801.aspx)对象打开 URL。

例子：

```
await Launcher.LaunchUriAsync(new Uri("www.google.com")); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T17:17:42.913

我尝试了很多解决方案，但由于我在 UI 项目（wpf 或 winform）中，我最终使用了嵌入式浏览器控件。调用导航，将 url 然后目标设置为“_blank”会启动一个外部浏览器窗口。

```
_webBrowser.Navigate(uri, "_blank"); 
```

希望这可以帮助。直流

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-13T21:59:07.230

我发现这个问题的唯一可靠的解决方案在这里描述：[https ://web.archive.org/web/20160304114550/http://www.seirer.net/blog/2014/6/10/solved-how -to-open-a-url-in-the-default-browser-in-csharp](https://web.archive.org/web/20160304114550/http://www.seirer.net/blog/2014/6/10/solved-how-to-open-a-url-in-the-default-browser-in-csharp)

基本上，您需要查看 Windows 注册表以查找所选的默认浏览器是什么，然后将其作为进程直接启动，并以 URL 作为参数。

# c++ - 检测和修复 C++ 中的堆损坏

> ID：12206372
> 
> 赞同：2
> 
> 时间：2012-08-30T22:18:40.027
> 
> 标签：c++, visual-studio, heap-memory, heap-corruption

我在（win32）C++ 应用程序中遇到堆损坏问题。在将 _heapchk() 插入代码后，我设法缩小了原因。应用程序运行；但是它“时不时地”崩溃。这是代码：

```
void parse_config(void) {
     int *regex_d;                  // regex data parsed fields(from a line from config_file)
     vector<string> input_fields;            // filtered data
     ifstream file(param.topology_file.c_str());// open file for input
     ifstream reg_file(param.regex_file.c_str());   // open the regex file and read contents(all content is placed on a single line -- no new line characters allowed)

     if(reg_file.is_open())
     {
      // read regex content into the string regex variable 
      param.regex.assign((istreambuf_iterator<char>(reg_file)), istreambuf_iterator<char>()); 
      reg_file.close();
     }

     split_regex();                     
     string buff;                       // store contents of input file
     string::const_iterator start, end;
     int temp, temp1, temp2;
     int n_of_fields = 0;            // number of fields found in an input line
     const size_t l = 10;           // number of digits each data field has

     for(unsigned i = 0; i < strlen(topology_component); i++)
     {
         if(topology_component[i] == ':')
             n_of_fields++;
     }

     input_fields.resize(n_of_fields);
     regex_d = new int[n_of_fields]; 

     for(vector<string>::iterator iter = input_fields.begin(); iter != input_fields.end(); iter++) 
     {
        (*iter).reserve(l);
     } 

      if (file.is_open())
      {
         file.seekg(0, ios::end);   
         buff.reserve(file.tellg());
         file.seekg(0, ios::beg);

         buff.assign((istreambuf_iterator<char>(file)), istreambuf_iterator<char>()); // read contents of file in buff
         file.close();
         boost::regex expression(topology_component);
         boost::match_results<string::const_iterator> m_res; 
         boost::match_flag_type flags = boost::match_default;

         start = buff.begin();
         end = buff.end();

         // searching the buffer for valid entries 
         while(boost::regex_search(start, end, m_res, expression, flags))
         {
             start = m_res[0].second;
             flags |= boost::match_prev_avail;
             flags |= boost::match_not_bob;

             int i = 1;

             for(vector<string>::iterator iter = input_fields.begin(); iter != input_fields.end(); iter++, i++)
             {
                (*iter).erase();
                (*iter).append(m_res[i]);
                sscanf((*iter).c_str(), "%d", &regex_d[i]);     
             }
                         ...
          }

      n_of_fields = 0;
      for(unsigned i = 0; i < strlen(routing_component); i++)
      {
         if(routing_component[i] == ':')
              n_of_fields++;
      }

      delete[] regex_d;
      regex_d = NULL;
      input_fields.resize(n_of_fields);
      regex_d = new int[n_of_fields];

      for(vector<string>::iterator iter = input_fields.begin(); iter != input_fields.end(); iter++) // allocate memory
      {
           iter->reserve(l);
      }

      boost::regex expression(routing_component);
      boost::match_results<string::const_iterator> m_res; 
      boost::match_flag_type flags = boost::match_default;

      start = buff.begin();
      end = buff.end();

      // searching the buffer for valid entries 
      // rtable_cur:0 rtable_dst:0 rtable_nxt:0 rtable_vc:0
      while(boost::regex_search(start, end, m_res, expression, flags))
      {
          start = m_res[0].second;
          flags |= boost::match_prev_avail;
          flags |= boost::match_not_bob;

          // parse one line from config file
          int i = 1;

          for(vector<string>::iterator iter = input_fields.begin(); iter != input_fields.end(); iter++, i++)
          {
              (*iter).erase();   // <== HEAP CORRUPTION OCCURS HERE
              (*iter).append(m_res[i]); // <== HEAP CORRUPTION
              sscanf((*iter).c_str(), "%d", &regex_d[i]); // <== HEAP CORRUPTION
          }

            ...
      }
       ...
   } 
```

当我尝试重用 input_fields 向量时，堆在整个程序中变得并保持损坏。param 是一个包含经过验证的用户输入的容器。split_regex() 方法用于获取两个字符串：topology_component 和 routing_component。两者都是 char* 类型。

```
 void split_regex(void) // regex is of type "topology_component|routing_component"
     {
      bool split = false;
      unsigned i, j = 0;

      if(topology_component == NULL)
      {
          topology_component = (char*)malloc(REGEX_SIZE);
      }

      if(routing_component == NULL)
      {
          routing_component = (char*)malloc(REGEX_SIZE);
      }

      for(i = 0; i < param.regex.size(); i++)
      {
         if(split == false)
         {
             if(param.regex.at(i) == '|')
             {
                 split = true;
                 j = 0;
                 continue;
             }
             topology_component[i] = param.regex[i];
          }
          else
          {
             topology_component[i-1] = '\0';
             routing_component[j++] = param.regex[i];
          }
      }

    routing_component[j] = '\0';
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:54:49.153

assert(_CrtCheckMemory()) 非常适合检测内存泄漏。将它放在代码的各个位置，它将帮助您缩小问题范围。您的应用程序必须使用调试配置构建。它也可能会减慢执行速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:32:22.550

代码可能会写到`regex_d`数组的末尾。在几个地方，有代码分配`i = 1;`然后执行`scanf`到 regex_d。我怀疑它应该从零开始：

```
 int i = 1;  <== should be 0?

         for(vector<string>::iterator iter = input_fields.begin(); iter != input_fields.end(); iter++, i++)
         {
            <snip>
            sscanf((*iter).c_str(), "%d", &regex_d[i]); 
```

此外，似乎该循环应该进行检查以验证它不会增加超过原始分配大小的`regex_d`.

# java - Java 转换器出错

> ID：12206375
> 
> 赞同：0
> 
> 时间：2012-08-30T22:18:51.030
> 
> 标签：java, xml, xslt

我编写了一个简单的类，它读取 XML 文档并将其转换为基于 XSL 样式表的 CSV。这个过程已经完美运行了好几天，但现在当我尝试转换过程时系统崩溃并产生此错误。

```
 (Location of error unknown)java.net.MalformedURLException: unknown protocol: c
    java.io.FileNotFoundException: C:\Abbeyleefinal.csv (Access is denied)
at java.io.FileOutputStream.open(Native Method)
at java.io.FileOutputStream.<init>(FileOutputStream.java:194)
at java.io.FileOutputStream.<init>(FileOutputStream.java:84)
at Simplex.simplexTransform(Simplex.java:41) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:38:16.420

它不能理解`C:\`为 URI 的开头。它被解释`C:`为方案，类似于`http:`，当您当然想要`C:`表示驱动器 C时。

试试`file:///C:/...`吧。

另请参阅@Michael Kay 关于使用`File.toURI()`将文件路径转换为正确 URI 的评论。

# python - 如何自动安装本地“开发模式”包？

> ID：12206384
> 
> 赞同：2
> 
> 时间：2012-08-30T22:19:37.153
> 
> 标签：python, dependencies, development-environment, virtualenv, setuptools

如果您`python setup.py develop`在同一个包中运行多个包，则`virtualenv`可以同时开发它们，而无需在更改后重新安装。

我最近将项目中的功能提取到一个单独的包中，我现在正在以这种方式进行开发。

有没有办法在我的`setup.py`文件中表达这种依赖关系，所以新开发人员可以简单地`python setup.py develop`在主项目的目录中运行一次？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T12:15:17.417

我相信并担心你的问题的答案只是“不”。

setup.py 只是不符合您的需求。尽管如此，寻找技巧可能会给新开发人员带来更多问题。

可悲的是，我无法提供完美的选择：

*   就像 Lukas Graf 在评论中描述的那样看 zc.buildout。
*   如果您知道开发人员的平台，则分发一个压缩的快速入门工作目录，其中包含所有配置。
*   提供一个完成整个设置的 shell 脚本。
*   教你的开发人员正确使用 setuptool (setup.py) 和 virtualenv 的理念，并让他们为他们需要的每个包明确调用“setup.py develop”。

请记住，显式优于隐式是 python zen 的一部分。我会选择最后一个，但 YMMV。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-28T05:53:59.437

这个mod允许使用`python setup.py develop`它允许使用本地开发文件进行[开发模式](http://packages.python.org/distribute/setuptools.html#development-mode) 安装。抄自[django-tastypie](https://github.com/toastdriven/django-tastypie/blob/master/setup.py)。

# jquery - 将数据从 jquery 对话框传递到 asp.net mvc 控制器

> ID：12206386
> 
> 赞同：0
> 
> 时间：2012-08-30T22:19:42.320
> 
> 标签：jquery, ajax, asp.net-mvc

jquery 对话框中的数据究竟应该如何传递给控制器​​？我不确定要为数据添加什么（请参阅 Index.cshtml 代码）

**控制器**

```
public ActionResult CreateUser() {
        return PartialView("_Create", new RegisterModel());
    }

[HttpPost]
public ActionResult CreateUser(RegisterModel user) {
    //...
} 
```

**索引.cshtml**

```
<script type="text/javascript">
$(document).ready(function () {
    $('#dialog').dialog({
        //...dialog information
        open: function(event, ui) {
            $(this).load('@Url.Action("CreateUser")');
        },
        buttons: {
            "Submit": function () {
                $.ajax({
                    url: 'Users/CreateUser',
                    type: 'POST',
                    data: /* What is passed here? */,
                });
            }
        }
    });

    $('#btnCreate').click(function (e) {
        e.preventDefault();
        $('#dialog').dialog('open');
    });

});
</script>

@Html.ActionLink("Create New User", "CreateUser", null, new { id= "btnCreate" })
<div id="dialog" title="Create User" style="overflow: hidden;"></div> 
```

---Edit--- 这是从 open 函数调用的模型

**模型**

```
public class RegisterModel {
    [Required]
    [Display(Name = "User name")]
    public string UserName { get; set; }

    [Required]
    [DataType(DataType.EmailAddress)]
    [Display(Name = "Email address")]
    public string Email { get; set; }

    [Required]
    [StringLength(100, ErrorMessage = "The {0} must be at least {2} characters long.", MinimumLength = 6)]
    [DataType(DataType.Password)]
    [Display(Name = "Password")]
    public string Password { get; set; }

    [DataType(DataType.Password)]
    [Display(Name = "Confirm password")]
    [Compare("Password", ErrorMessage = "The password and confirmation password do not match.")]
    public string ConfirmPassword { get; set; }

    [Required]
    [Display(Name = "Roles")]
    public string RolesId { get; set; }
    public IEnumerable<SelectListItem> RolesItem {
        get { return new SelectList(Roles.GetAllRoles()); }
    }
} 
```

**局部视图**

```
@model MvcApp.Models.RegisterModel

@{
    ViewBag.Title = "Register";
}

<h2>Create a New User</h2>
<p>
    Passwords are required to be a minimum of @Membership.MinRequiredPasswordLength characters in length.
</p>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

<div id="CreateModel"></div>

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true, "Account creation was unsuccessful. Please correct the errors and try again.")
    <div>
        <fieldset>
            <table>
                <tr>
                    <td>@Html.LabelFor(m => m.UserName)</td>
                    <td>@Html.EditorFor(m => m.UserName)</td>
                    <td>@Html.ValidationMessageFor(m => m.UserName)</td>
                </tr>
                ... more fields... 

            </table>
        </fieldset>
    </div>
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:24:09.150

我想您想显示表单以在对话框中创建用户，如果是这样，只需在此`<div id="dialog" title="Create User" style="overflow: hidden;"></div>` 元素内正常创建表单，只需确保使用 javascript 验证，否则页面将被刷新并且对话框将丢失如果用户提交无效信息。

# ruby - 查找仅在最后一项不同的所有频繁项集对

> ID：12206389
> 
> 赞同：1
> 
> 时间：2012-08-30T22:19:59.820
> 
> 标签：ruby, algorithm, apriori

我正在尝试实现先验算法，并且在编写生成候选项目集的方法时遇到了麻烦。这是此功能的屏幕截图。 ![在此处输入图像描述](../Images/15ba482394ed6fb5e5ab1474a87c3a54.png)

主要问题是第 2-5 行。我不知道如何获得 f1 和 f2。f1 和 f2 是最后一项不同的数组，f1 的最后一项小于 f2 的最后一项。

有人知道如何用 Ruby 编写这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T13:05:18.813

```
f1 = [1,2,3]
f2 = [1,2,4]
z = [f1,f2].transpose

if(((z[0...(z.size-1)].collect {|el| el[0] == el[1]}.uniq == [true])) & (z[z.size-1][0] < z[z.size-1][1])) do

# f1 = f2 , except the last element, where the last f1 element is smaller than the last f2 element

end 
```

# r - R中arima函数的季节性参数问题

> ID：12206390
> 
> 赞同：0
> 
> 时间：2012-08-30T22:20:15.813
> 
> 标签：r, forecasting

这是我的代码：

```
arimafit <- arima(x1, order = c(5,1,5), seasonal = list(order = c(0,1,0)))

fcast1 <- forecast(arimafit,50)

summary(fcast1) 
```

结果是：

```
Forecast method: ARIMA(5,1,5)                   

Model Information:

Series: x1 

ARIMA(5,1,5) 
```

也就是说，使用季节性参数并不合适。我已经做了很多谷歌搜索和玩弄这个论点，但无济于事。任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T04:39:49.790

`x1`如果尚未设置的频率，则季节参数还需要指定周期。阅读帮助功能`arima()`。

# java - 对象值空

> ID：12206392
> 
> 赞同：0
> 
> 时间：2012-08-30T22:20:19.110
> 
> 标签：java, null, nullpointerexception, linked-list

我是 Java 新手，我正在尝试实现一个链接列表（我确实知道为此目的存在一个列表类，但是从头开始让我了解该语言在内部是如何工作的）

在 main 方法中，我声明了 4 个节点并初始化了 3 个。链表的头节点设置为 null。第一次使用参数head和newNode调用add函数时，head为null，所以我初始化head并将newNode的值赋给它。在 main 方法中，我希望 head 对象应该从 add 方法中设置新值。但是 head 仍然为空。

我很感激理解为什么会这样。

如果代码不干净，请致歉，非常感谢！

```
public class LinkedList
{
    public void add(Node newNode, Node head)
    {
        if(head == null) 
        {
            head = new Node(); 
            head = newNode;              
        }
        else 
        {
            Node temp = new Node(); 
            temp = head; 

            while(temp.next!=null)
            {
                temp = temp.next; 
            }
            temp.next = newNode; 
        }    
    }

    public void traverse(Node head)
    {
        Node temp = new Node(); 
        temp = head; 

        System.out.println("Linked List:: ");

        while(temp.next!=null);  
        {
           System.out.println(" "  + temp.data); 
            temp = temp.next;
        }
    }

    public static void main(String args[])
    {
        Node head = null;
        Node newNode = new Node(null, 5); 
        Node newNode2 = new Node(null, 15); 
        Node newNode3 = new Node(null,30); 

        LinkedList firstList = new LinkedList(); 

        firstList.add(newNode,head); 

       // Part that I don't understand
       // why is head still null here? 

        if(head==null)
        {
         System.out.println("true");
        }

        firstList.traverse(head); 
        firstList.add(newNode2,head); 
        firstList.traverse(head); 
        firstList.add(newNode3,head); 
        firstList.traverse(head); 

    }

}

public class Node
{
    public Node next; 
    public int data; 

    public Node(Node next, int data)
    {
        this.next = next; 
        this.data = data; 
    }

    public Node()
    {
        this.next = null; 
        this.data = 0; 
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T23:07:35.810

我认为问题出在“添加”函数内部。您只是在函数范围内更改“head”的值，而不是在它之外。[您可以在此处](http://docs.oracle.com/javase/tutorial/java/javaOO/arguments.html)找到有关 Java 处理传递参数值的方式的有用信息。

Java 中 LinkedList 的一个很好的实现在 [这里](https://stackoverflow.com/questions/10042/how-do-i-implement-a-linked-list-in-java)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T22:26:17.497

Java 方法参数是按值传递的。

> ```
> public void add(Node newNode, Node head)
> {
>     if(head == null) 
>     {
>         head = new Node(); 
>         head = newNode;              
>     }
>     ... 
> ```

`head`上面只修改了 .范围内的局部变量`add`。不可能引用`head`范围内的局部变量。`main`如果您希望调用者能够检索新值，也许您应该返回该值。

* * *

老实说，面向对象编程的一个主要原则是*封装*；理想情况下`head`，您`LinkedList`应该是内部维护的字段。为什么它应该是一个单独的部分？如果你真的希望有`head`孤立的，那为什么不`traverse`和`add`静态呢？您应该尝试修改您的设计。我决定在[这里](http://ideone.com/PADWs#view_edit_box)重写你的代码。

```
final class List {

  private Node head;

  public void add(final Node node) {
    if (head == null) {
      head = new Node();
    }
    Node cur;
    for (cur = head; cur.next != null; cur = cur.next)
      ;
    cur.next = node;
  }

  public String toString() {
    final StringBuilder builder = new StringBuilder("Linked List::");
    for (Node cur = head.next; cur != null; cur = cur.next) {
      builder.append("\n ").append(cur.data);
    }
    return builder.toString();
  }
}

final class Node {

  int data;
  Node next;

  Node(final int data) {
    this.data = data;
  }

  Node() { }
} 
```

...然后，测试：

```
 private static Node[] nodesFor(final int... values) {
    int n = values.length;
    final Node[] nodes = new Node[n];
    while (n > 0) {
      nodes[--n] = new Node(values[n]);
    }
    return nodes;
  }

  public static void main(final String[] argv) {
    final List list = new List();
    for (final Node node : nodesFor(5, 15, 30)) {
      list.add(node);
      System.out.println(list);
    }
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T22:29:41.690

使“head”引用另一个节点对调用代码没有影响（java传递引用，在java中是地址的“值”）。

你需要一个对头部的永久引用，所以让它成为你类的一个字段：

```
private Node head = new Node(); // the head of your Node tree

public void add(Node newNode, Node parent) {
    // add node to parent.
    // for some calls, the parent will be the head
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-30T23:09:43.670

这是您的链接列表的更好植入。请注意：

1.  _head 应该是私有成员
2.  节点是一种内部机制。你应该给你的 add 方法一个 data 参数而不是一个 Node 对象
3.  我写了这个，简单，但基于你的代码，实现

    ```
    public class LinkedList{
    private Node _head;
    public void add(int data)
    {               
            //Understand this code! What happens if _head=null?                 
            _head=new Node(_head,data); 
            /*
                 //Use the following code for a "Normal" nodes-order
                 if(_head==null)
                    _head=new Node(null,data);
                 else{
                   Node temp=_head;
                   while( temp.next!=null)
                      temp=temp.next;            
                   temp.next=new Node(null,data); 
                 }
            */
    }
    public void traverse()
    {
        System.out.println("Linked List:: ");
        Node temp=_head;
        while(temp!=null){
                System.out.println(" "  + temp.data); 
                temp = temp.next;
        }
    }
    public LinkedList(){
        _head=null;         //null is our lists anchor
    }

    public static void main(String args[])
    {
        LinkedList firstList = new LinkedList(); 

        firstList.add(5); 
        firstList.traverse(); 
        firstList.add(15); 
        firstList.traverse(); 
        firstList.add(30); 
        firstList.traverse(); 

    } 
    ```

    }

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-30T22:27:11.617

```
 firstList.add(newNode,head); 

   /*
    Part you should know is, head is a local variable pointing to null.
    Passing head as parameter doesn't make it feasible to alter this local variable.
    Your check is worthless.
    Make public Node add(Node newNode, Node head) and return head from there.
   */ 
    head=firstList.add(newNode,head);

    if(head==null)
    {
     System.out.println("true");
    } 
```

# r - 在 R 中合并两个数据框：一个包含每个因子一行，另一个包含每个因子多行

> ID：12206396
> 
> 赞同：1
> 
> 时间：2012-08-30T22:20:40.617
> 
> 标签：r, merge, dataframe

**更新：**抱歉...我应该指定*某些*测试缺少值（进行了 n 次，其他进行了 m 次），我认为这会影响基于[`merge`文档](http://stat.ethz.ch/R-manual/R-patched/library/base/html/merge.html)的答案：

> `all.x` 合乎逻辑的；如果为 TRUE，那么额外的行将被添加到输出中，x 中的每一行在 y 中没有匹配的行。这些行将在那些通常用来自 y 的值填充的列中具有 NA。默认值为 FALSE，因此只有包含 x 和 y 数据的行才会包含在输出中。

我不想要这些选项中的任何一个：即，我不希望只保留匹配的行/列值，也不希望用 NA 填充不匹配的行/列交叉值。

* * *

我有来自实验的数据，并将我的化学成分存储在一个文件中，并在另一个文件中进行测试。我想合并这些，这样我就可以绘制按组成因子级别划分的箱线图，但是很难弄清楚如何去做。这是一些示例数据（根据上述调整）：

```
set.seed(1)
df.ids <- data.frame(lot=c("A","B","C"),
                     var1=c(1,2,3),
                     var2=c(4,5,6))

df.testing <- data.frame(lot=c(rep("A",4), rep("B",4),rep("C",4)),
                         test1=rep(c(runif(3,min=1,max=5),NA),3),
                         test2=rep(c(runif(2,min=1,max=5),NA,NA),3),
                         test3=rep(runif(4,min=1,max=5),3)) 
```

像我的真实数据一样，ids 数据框每个因子级别有一行，但测试数据对于每个测试重复都有多个。我如何合并这些以便为每个批次填写作品？换句话说，我的结果数据框将如下所示：

```
| lot |    test1 | test2    |    test3 | var1 | var2 |
|-----+----------+----------+----------+------+------|
| A   | 2.062035 | 4.632831 | 4.593559 | 1    | 4    |
| A   | 2.488496 | 1.806728 | 4.778701 | 1    | 4    |
| A   | 3.291413 | NA       | 3.643191 | 1    | 4    |
| A   |       NA | NA       | 3.516456 | 1    | 4    |
| B   | 2.062035 | 4.632831 | 4.593559 | 2    | 5    |
| B   | 2.488496 | 1.806728 | 4.778701 | 2    | 5    |
| B   | 3.291413 | NA       | 3.643191 | 2    | 5    |
| B   |       NA | NA       | 3.516456 | 2    | 5    |
| C   | 2.062035 | 4.632831 | 4.593559 | 3    | 6    |
| C   | 2.488496 | 1.806728 | 4.778701 | 3    | 6    |
| C   | 3.291413 | NA       | 3.643191 | 3    | 6    |
| C   |       NA | NA       | 3.516456 | 3    | 6    | 
```

最后，我想我要做的就是匹配唯一的批次 ID，然后将`df.ids`每个列的值复制到`df.testing`. 我只是不知道怎么做（好吧，我想用`for()`循环来做，但我相信有更好的方法）！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:35:40.433

您可以重新排列列的顺序：

```
> merge(df.ids, df.testing)
  lot var1 var2    test1    test2
1   A    1    4 3.389578 11.55608
2   A    1    4 9.502077 15.47929
3   A    1    4 9.173870 17.18321
4   B    2    5 4.349115 12.85377
5   B    2    5 2.815137 14.45693
6   B    2    5 6.947180 17.45857
7   C    3    6 9.085507 17.92857
8   C    3    6 6.155680 12.58901
9   C    3    6 6.662026 19.92715

> merge(df.ids, df.testing)[c(1,4:5,2:3)]
  lot    test1    test2 var1 var2
1   A 3.389578 11.55608    1    4
2   A 9.502077 15.47929    1    4
3   A 9.173870 17.18321    1    4
4   B 4.349115 12.85377    2    5
5   B 2.815137 14.45693    2    5
6   B 6.947180 17.45857    2    5
7   C 9.085507 17.92857    3    6
8   C 6.155680 12.58901    3    6  
9   C 6.662026 19.92715    3    6 
```

结果证明这是一个内连接，因为在合并列中没有丢失的项目，但是可以选择 by.x 和 by.y 参数，以便在需要时获得左外连接或右外连接. 如果出于某种原因您希望保持 df.testing 中项目的顺序，则需要创建一个随身携带的列，然后由 order()ed-by。

# iphone - 在 iOS 中将键值对添加到 plist 文件时出现问题

> ID：12206398
> 
> 赞同：0
> 
> 时间：2012-08-30T22:20:51.240
> 
> 标签：iphone, objective-c, ios

我在 iphone 应用程序中有一个视图控制器，它将键值对添加到 plist 文件中。然后它将整个 plist 显示在带有表格视图的视图控制器中。我遇到的问题是它只会显示 iPhone 模拟器中的值，并且如果我完全重新启动应用程序，它只会显示新的键值对。

注意：plist 文件应该添加到应用程序的资源目录更新：下面的代码是我的问题的解决方案，此外，为了查看 plist 中的新条目，我实现了一个刷新按钮，该按钮基本上在 viewDidLoad 中运行该部分.

添加键值对的视图控制器的代码如下：

```
- (IBAction)addAction:(UIBarButtonItem *)sender
{    
    NSString *myFile=[[NSBundle mainBundle] pathForResource:@"File" ofType:@"plist"];

    dictionary = [[NSMutableDictionary alloc] initWithContentsOfFile:myFile];

    NSArray *docDir=NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask, YES);
    NSString *filePath=[docDir objectAtIndex:0];
    NSString *plistPath=[filePath stringByAppendingPathComponent:@"File.plist"];

    //Check plist's existance using FileManager
    NSError *err=nil;
    NSFileManager *fManager=[NSFileManager defaultManager];

    if(![fManager fileExistsAtPath:plistPath])
    {
        //file doesn't exist, copy file from bundle to documents directory

        NSString *bundlePath=[[NSBundle mainBundle] pathForResource:@"File" ofType:@"plist"];
        [fManager copyItemAtPath:bundlePath toPath:plistPath error:&err];
    }

    //Get the dictionary from the plist's path
    dictionary =[[NSMutableDictionary alloc] initWithContentsOfFile:plistPath];
    //Manipulate the dictionary
    [dictionary setObject:textContent forKey:textName];
    //Again save in doc directory.
    [dictionary writeToFile:plistPath atomically:YES];    
} 
```

这是在另一个视图控制器的表视图中显示 plist 的代码：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Initialize table data

    NSArray *docDir=NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask, YES);
    NSString *filePath=[docDir objectAtIndex:0];
    NSString *plistPath=[filePath stringByAppendingPathComponent:@"File.plist"];

    dictionary = [[NSMutableDictionary alloc] initWithContentsOfFile:**plistPath**];
    verses = [dictionary allKeys];

    [self.mainTableView reloadData];

} 
```

感谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:28:19.480

在设备上，主包是只读的，您要写入文档目录路径。你可以通过

NSArray 路径 = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

您的更改仅在启动时出现的原因是文件名不匹配

# google-apps-script - 将单元格引用传递给电子表格函数

> ID：12206399
> 
> 赞同：18
> 
> 时间：2012-08-30T22:20:55.967
> 
> 标签：google-apps-script, google-sheets, custom-function

当我调用电子表格函数时，例如`int(f2)`，该函数对单元格中的值进行操作。如果`cell("F2")`包含 3.14159，结果将是 3。但是当我调用不同类型的函数时——例如：`row(f8)`——函数获取单元格引用，而不是值，在这种情况下，返回 8。

如何让我的自定义函数与引用而不是值一起使用？

我可以传递一个字符串，然后使用`getRange()`，但是，如果我移动或更新工作表上的单元格，则字符串不会改变。

非常简单的例子：

```
function GetFormula(cellname) {
  return SpreadsheetApp.getActiveSheet().getRange(cellname).getFormula();
} 
```

在我的工作表代码中，我可以像这样检索 C4 中的公式：`=GetFormula("C4")`

但是，这个参数是一个字符串，我宁愿传递一个单元格引用。一个更复杂的问题要求调用单元格在复制和粘贴时进行更新。

有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-06-22T14:12:57.880

（来自我对 Web Apps 的[回答](https://webapps.stackexchange.com/a/92156)。）可以通过解析活动单元格中的公式来获取对传递范围的引用，该单元格是包含公式的单元格。这假设自定义函数是单独使用的，而不是作为更复杂表达式的一部分：例如，`=myfunction(A1:C3)`， not `=sqrt(4+myfunction(A1:C3))`。

该方法还支持对其他工作表的引用，例如 `=myfunction(Sheet2!A3:B5)`或`=myfunction('Another Sheet'!B3:G7)`。

作为演示，此函数返回传递范围的第一列索引。该位在函数的最后；其中大部分处理范围提取。

```
function myfunction(reference) {
  var sheet = SpreadsheetApp.getActiveSheet();
  var formula = SpreadsheetApp.getActiveRange().getFormula();
  var args = formula.match(/=\w+\((.*)\)/i)[1].split('!');
  try {
    if (args.length == 1) {
      var range = sheet.getRange(args[0]);
    }
    else {
      sheet = ss.getSheetByName(args[0].replace(/'/g, ''));
      range = sheet.getRange(args[1]);
    }
  }
  catch(e) {
    throw new Error(args.join('!') + ' is not a valid range');
  }

  // everything so far was only range extraction
  // the specific logic of the function begins here

  var firstColumn = range.getColumn();  // or whatever you want to do with the range
  return firstColumn;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-11T13:52:54.850

几个月前我正在研究这个并想出了一个非常简单的组合：创建一个新工作表，其中每个单元格的名称作为其内容：单元格 A1 可能如下所示：

```
= arrayformula(cell("address",a1:z500)) 
```

编辑：以上不再有效。我的“Ref”新公式！A1 是

```
= ArrayFormula(char(64+column(A1:Z100))&row(A1:Z100)) 
```

将工作表命名为“Ref”。然后，当您需要将单元格的引用作为字符串而不是内容时，您可以使用：

```
= some_new_function('Ref'!C45) 
```

当然，您需要检查函数是否传递了字符串（一个单元格）或一维或二维数组。如果你得到一个数组，它将所有单元格地址作为字符串，但从第一个单元格和宽度和高度，你可以找出你需要什么。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-09-05T16:56:28.167

当您将范围传递给自定义函数时，参数的类型为[Range](https://developers.google.com/apps-script/class_range)，然后您可以使用获取值等。

**编辑**：这是不正确的。

# controller - 涡轮齿轮。编写控制器方法

> ID：12206400
> 
> 赞同：0
> 
> 时间：2012-08-30T22:21:04.493
> 
> 标签：controller, turbogears

该`index`方法是任何 TurboGears 控制器类的起点。每个网址

*   `localhost:8080`
*   `localhost:8080/`
*   `localhost:8080/index`

映射到`RootController.index()`方法。

我如何将`localhost:8080`and映射`localhost:8080/`到`.index()` but`localhost:8080/index`和`localhost:8080/index.html`the `._lookup()`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-22T17:53:49.510

不要在控制器中放置任何索引方法，只需使用 _lookup 根据您想要执行的操作返回正确的控制器。

这将为*http://localhost:8080*和*http://localhost:8080/*返回“INDEX1”，同时为*http://localhost:8080/index*和*http://localhost:8080/index.html返回“INDEX2”*

```
class IndexController(BaseController):
    @expose()
    def index(self, *args, **kw):
        return 'INDEX2'

class NoPathController(BaseController):
    @expose()
    def index(self, *args, **kw):
        return 'INDEX1'

class RootController(BaseController):
    @expose()
    def _lookup(self, *remainder, **params):
        if not remainder:
            return NoPathController(), remainder

        return IndexController(), remainder 
```

# objective-c - 在 Cocoa 中本地绘制边框和高光

> ID：12206406
> 
> 赞同：0
> 
> 时间：2012-08-30T22:21:37.700
> 
> 标签：objective-c, ios, macos, nsview, nsgradient

如何在 Cocoa 中本地绘制高光和非 4 边边框？

下图就是一个例子。顶部有一个小的 1px 白色内边框，底部有一个灰色的 1px 内边框。仅在视图的顶部和底部还有一个深灰色边框。

这可以在本地完成吗？或者这需要图像吗？

![在此处输入图像描述](../Images/e91bb4cae6264cec2a5b5f83df36b129.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T22:35:08.427

获得内边框的一种快速方法是使用您想要加边框的视图中的图层阴影属性（注意 -1，它将边框放在边缘内）：

```
myView.layer.shadowOpacity = 1.0;
myView.layer.shadowColor = [UIColor blackColor].CGColor;
myView.layer.shadowOffset = CGSizeMake( 0, -1 ); 
```

否则，您可以将视图子类化并在您的 drawRect: 方法中放置类似的内容：

```
[super drawRect: rect];

CGContextRef context = UIGraphicsGetCurrentContext();
CGContextSaveGState( context );
CGContextSetStrokeColorWithColor( context, [UIColor blackColor].CGColor );
CGContextSetLineWidth( context,  1.0 );

CGContextMoveToPoint( context, 0, 0 );

CGContextAddLineToPoint( context,  self.bounds.size.width, 0 );
CGContextStrokePath( context );        

CGContextRestoreGState( context ); 
```

# ios - 滚动视图内的“绝对位置”视图

> ID：12206407
> 
> 赞同：0
> 
> 时间：2012-08-30T22:21:47.487
> 
> 标签：ios, cocoa-touch, uiscrollview, css-position

我不知道这是否可能，但也许有人可以帮助我：我的滚动视图大小为 400*400 像素，我想要的是滚动视图左侧的列/视图（40 像素宽），当用户始终保持可见时水平滚动，但当用户垂直滚动时与视图一起移动。

[这是一个例子](http://i.stack.imgur.com/ZrhI5.png)

所以红色部分在水平滚动时应该始终可见，黄色部分在垂直滚动时可见。任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:25:47.483

将自己设置为滚动视图的代表并实施`-scrollViewDidScroll:`. 在此方法中，检查`contentOffset`scrollView 并相应地调整“绝对定位”视图的位置。

请注意，滚动的每一帧都会调用此方法，因此请尽量不要在这里做任何特别昂贵的事情。每秒可以调用 60 次。

# android - Drive 使用什么 auth_token_type？

> ID：12206413
> 
> 赞同：0
> 
> 时间：2012-08-30T22:22:30.570
> 
> 标签：android, google-drive-api

就像[这个](https://stackoverflow.com/questions/8708638/auth-token-type-for-google-apis)问题的海报一样，我对 google api 范围感到困惑。

我想要完全访问 Drive API。我请求这样的令牌：

```
private static final String AUTH_TOKEN_TYPE = "oauth2:https://www.googleapis.com/auth/drive";
accountManager.getAuthToken(account, AUTH_TOKEN_TYPE, null, this, new AccountManagerCallback<Bundle>() {
        public void run(AccountManagerFuture<Bundle> future) {
... 
```

但是，我总是看到一个屏幕告诉我“无法登录。与 Google 服务器通信时出现问题。请稍后再试。”

当然，我确保通过浏览器访问互联网正常工作。

另外，我看不出[这](https://stackoverflow.com/questions/10759432/android-app-acquire-access-token-for-google-drive-api)家伙的所作所为有什么不同，他没有任何问题。

最后，在我提到的第二篇文章中，用户 Nivco 确认 Drive API 的使用非常有限。有人可以确认我无法创建文件或设置权限吗？如果是这样的话，这个 api 对我来说没有任何价值。

注意：我没有使用任何选项，这似乎在我提到的第二篇文章中使用过。但我不知道哪些可用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:27:36.747

要回答您的最后一个问题，您可以使用 Drive API v2 创建文件并设置权限（以及执行许多其他操作）：

[https://developers.google.com/drive/v2/reference/](https://developers.google.com/drive/v2/reference/)

请注意，API 有多个您可以请求的范围，并且您可以使用 API 执行的操作因它们而异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T08:14:47.117

一天后我再次尝试使用同一设备，一切似乎都很好。所以要么服务器因为尝试失败太多而拒绝我，要么设备内存中的缓存密钥仍在使用中......

# php - 我可以使用带魔法属性的空吗？

> ID：12206418
> 
> 赞同：1
> 
> 时间：2012-08-30T22:22:53.907
> 
> 标签：php

引用[PHP 文档中关于重载](http://de2.php.net/manual/en/language.oop5.overloading.php#object.isset)的内容：

> 除了 isset() 之外，不能在其他语言结构中使用重载属性。这意味着如果对重载属性调用 empty()，则不会调用重载方法。
> 
> 要解决该限制，必须将重载的属性复制到范围内的局部变量中，然后交给 empty()。

这真的意味着我不能使用类似的东西

```
if (empty($this->foobar)) 
```

在课堂上，`$this->foobar`通过 解决的魔法属性在哪里`__get()`，或者我在这里误解了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T23:01:21.457

`__isset`如果您也覆盖该方法，它将起作用。如此编写文档的原因是因为您无法调用`empty() or isset()`方法调用的结果。

# vb.net - 如何将对象列表绑定到 WinForms 应用程序中的标准 MS GridView？

> ID：12206419
> 
> 赞同：0
> 
> 时间：2012-08-30T22:23:02.410
> 
> 标签：vb.net, winforms, datagridview

这是一个非常基本的问题 - 我在 VB.net WinForms 应用程序中有一个 List(Of MyClass)。

MyClass 包含两个公共字符串属性。

我想将 List(Of MyClass) 绑定到 WinForm 上的普通 MS GridView，以便添加到 List(Of MyClass) 的项目出现在 MS GridView 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:37:53.567

我不熟悉 vb 语法，但在 c# 中，您可以轻松地将列表作为数据源绑定到 datagridview。像这样的东西（c#）：

```
 List<Class2> list = new List<Class2>();
        list.Add(new Class2 { test1 = "test", test2 = "test2" });
        list.Add(new Class2 { test1 = "test", test2 = "test2" });
        list.Add(new Class2 { test1 = "test", test2 = "test2" });
        list.Add(new Class2 { test1 = "test", test2 = "test2" });
        list.Add(new Class2 { test1 = "test", test2 = "test2" });
        list.Add(new Class2 { test1 = "test", test2 = "test2" });

        dataGridView1.DataSource = list; 
```

我认为你在 vb.net 中重现它并不难。

# ruby-on-rails - 使用“资源”更改 Rails 中的路线

> ID：12206420
> 
> 赞同：0
> 
> 时间：2012-08-30T22:23:03.610
> 
> 标签：ruby-on-rails, ruby, url

我在 routes.rb 上有这个

```
 resources :items do
   resources :requisitos
   resources :videos
 end 
```

这会产生：

```
 GET    /items/:item_id/requisitos(.:format)          requisitos#index
                POST   /items/:item_id/requisitos(.:format)          requisitos#create
                GET    /items/:item_id/requisitos/new(.:format)      requisitos#new
                GET    /items/:item_id/requisitos/:id/edit(.:format) requisitos#edit
                GET    /items/:item_id/requisitos/:id(.:format)      requisitos#show
                PUT    /items/:item_id/requisitos/:id(.:format)      requisitos#update
                DELETE /items/:item_id/requisitos/:id(.:format)      requisitos#destroy
                GET    /items/:item_id/videos(.:format)              videos#index
                POST   /items/:item_id/videos(.:format)              videos#create
                GET    /items/:item_id/videos/new(.:format)          videos#new
                GET    /items/:item_id/videos/:id/edit(.:format)     videos#edit
                GET    /items/:item_id/videos/:id(.:format)          videos#show
                PUT    /items/:item_id/videos/:id(.:format)          videos#update
                DELETE /items/:item_id/videos/:id(.:format)          videos#destroy
                GET    /items(.:format)                              items#index
                POST   /items(.:format)                              items#create
                GET    /items/new(.:format)                          items#new
                GET    /items/:id/edit(.:format)                     items#edit
                GET    /items/:id(.:format)                          items#show
                PUT    /items/:id(.:format)                          items#update
                DELETE /items/:id(.:format) 
```

现在，我想在所有路由中将 /items 更改为 /admin，如何使用这个嵌套资源中的资源来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:30:31.780

您可以像这样设置资源的路径

```
resources :items, path: 'admin' do
    resources :requisitos
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:30:26.830

我不确定这是否是你想要的，但你可以做

```
resources :items, path: "admin" 
```

这将在您的网址中将“项目”替换为“管理员”

# php - 在多个字段中查找多个字符串

> ID：12206421
> 
> 赞同：0
> 
> 时间：2012-08-30T22:23:06.470
> 
> 标签：php, mysql

我试图通过在多个字段中搜索多个术语来从 MySQL 数据库中获取结果。下面的脚本正在运行，但不是我需要的方式，而且我很难找到一种方法来实现它。

目前，如果我搜索*“apples peaches”*，它将返回任何字段中包含*“apples”*或*“peaches”的每个结果。*即，如果记录有*“苹果”*但没有*“桃子”*，它将产生结果。

对于预期的行为，只有在给定记录中找到任何字段上的所有搜索词时，我才应该得到结果。即*“苹果”*可以在字段f1 上找到，*“桃子”*可以在字段f2 上找到。如果只找到*“苹果”*，那么它不是结果。

```
<?php
if (!isset($_REQUEST['term'])) exit;
$dblink = mysql_connect('localhost', 'root', 'pass') or die(mysql_error());
mysql_select_db('mytable');
mysql_set_charset('utf8', $dblink);
// query the database table for strings that match 'term'
$lcSearchVal = mysql_real_escape_string($_REQUEST['term']);
$lcSearchVal = explode(' ', $lcSearchVal);
$sql = 'SELECT id, f1, f2, f3, f4 FROM mytable 
        WHERE (';
$parts = array();
foreach($lcSearchVal as $lcSearchWord) {
    if ($lcSearchWord <> "") {
        $parts[] = '`id` LIKE "%' . $lcSearchWord . '%"';
    }
    if ($lcSearchWord <> "") {
        $parts[] = '`f1` LIKE "%' . $lcSearchWord . '%"';
    }
    if ($lcSearchWord <> "") {
        $parts[] = '`f2` LIKE "%' . $lcSearchWord . '%"';
    }
    if ($lcSearchWord <> "") {
        $parts[] = '`f3` LIKE "%' . $lcSearchWord . '%"';
    }
    if ($lcSearchWord <> "") {
        $parts[] = '`f4` LIKE "%' . $lcSearchWord . '%"';
    }
}
$sql.= implode(' OR ', $parts) . ') order BY id desc limit 0,10';
$rs = mysql_query($sql, $dblink);
// loop through each string returned and format the response for jQuery
$data = array();
$data[] = array('value' => "", 'label' => " >> Last 10 results:", 'desc' => "");
if ($rs && mysql_num_rows($rs)) {
    while ($row = mysql_fetch_array($rs, MYSQL_ASSOC)) {
        if (strlen($row['f3']) > 250) {
            $row['f3'] = substr($row['f3'], 0, 250) . " [...]";
        }
        $data[] = array('value' => $row['id'], 'label' => $row['id'] . '/' . $row['f1'] . ' (' . $row['f2'] . ') ' . $row['f4'], 'desc' => $row['f3']);
    }
}
// jQuery wants JSON data
echo json_encode($data);
flush();
?> 
```

谢谢您的意见

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:40:05.513

研究做全文索引和查询：

[http://www.devarticles.com/c/a/MySQL/Getting-Started-With-MySQLs-Full-Text-Search-Capabilities/](http://www.devarticles.com/c/a/MySQL/Getting-Started-With-MySQLs-Full-Text-Search-Capabilities/)

比对这类东西使用 like 语句要好得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:45:54.540

考虑以下：

```
$lcSearchVal = 'one two three';
$lcSearchVal = explode(' ', $str);
foreach ($lcSearchVal as &$lcSearchWord) {
    $lcSearchWord = '`id` LIKE "%' . $lcSearchWord . '%" AND ';
}
$conditions = rtrim(implode('', $val), ' AND ');

echo $conditions; //returns `id` LIKE "%one%" AND `id` LIKE "%two%" AND `id` LIKE "%three%" 
```

然后可以将 $conditions 作为 WHERE 条件插入到查询中。

# jquery - MVC3 应用程序中的 Jquery UI 自动完成

> ID：12206427
> 
> 赞同：3
> 
> 时间：2012-08-30T22:23:49.993
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-3, jquery-ui, jquery-ui-autocomplete

您好，我在控制器中有此代码：

```
 ViewBag.localitate = db.Localitatis.OrderBy(p => p.Localitate).ToList(); 
```

在视图中，我尝试通过以下方式获取它：

```
<script type="text/javascript">
    $(function () {
        var availableTags = [
         @foreach (var item in ViewBag.localitate)
              {
                       @item.Localitate 
             }

    ];
        $("#destination").autocomplete({
            source: availableTags
        });
    });
</script> 
```

我不知道如何格式化它以获得像 jquery 演示示例中的数组：

```
"ActionScript",
        "AppleScript",
        "Asp",
        "BASIC",
        "C",
        "C++",
        "Clojure",
        "COBOL",
        "ColdFusion",
        "Erlang",
        "Fortran",
        "Groovy",
        "Haskell",
        "Java",
        "JavaScript",
        "Lisp",
        "Perl",
        "PHP",
        "Python",
        "Ruby",
        "Scala",
        "Scheme" 
```

为了使自动完成功能与我在数据库中的值一起工作，

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:31:46.360

```
<script type="text/javascript">
    $(function () {
        $("#destination").autocomplete({
            source: @Html.Raw(Json.Encode(ViewBag.localitate))
        });
    });
</script> 
```

如果您有大量数据，请考虑使用服务器端控制器操作来执行过滤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:29:53.907

首先，将您的视图数据设置为只有您想要的实际名称：

```
ViewBag.localitate = db.Localitatis.Select(p => p.Localitate).OrderBy(p => p).ToList(); 
```

那么在 javascript 中呈现它的最简单方法是：

```
var availableTags = [" @String.Split("\,\"", ViewBag.localitate) "]; 
```

但我建议改用 JSON.NET 之类的 JSON 解析器。这样您就不必担心跨站点脚本攻击等，因为事情已经为您逃脱了。

```
var availableTags = @(JsonConvert.Serialize(ViewBag.localitate)); 
```

# php - 从数组中获取foreach的值

> ID：12206433
> 
> 赞同：0
> 
> 时间：2012-08-30T22:24:25.670
> 
> 标签：php, arrays

如何使用foreach从这个具有std对象的数组中获取值？

```
Array (
    [0] => stdClass Object (
        [SubmissionValueId] => 28
        [FormId] => 3
        [SubmissionId] => 4
        [FieldName] => Typ
        [FieldValue] => Panoramiczny
        ) 
    [1] => stdClass Object (
        [SubmissionValueId] => 29
        [FormId] => 3
        [SubmissionId] => 4
        [FieldName] => Producent
        [FieldValue] => sony
        )
    [2] => stdClass Object (
        [SubmissionValueId] => 30
        [FormId] => 3
        [SubmissionId] => 4
        [FieldName] => Model
        [FieldValue] => sony
        )
    [3] => stdClass Object (
        [SubmissionValueId] => 31
        [FormId] => 3
        [SubmissionId] => 4
        [FieldName] => Rok produkcji
        [FieldValue] => 1993
        )
    [4] => stdClass Object (
        [SubmissionValueId] => 32
        [FormId] => 3
        [SubmissionId] => 4
        [FieldName] => Nr seryjny
        [FieldValue] => sdadas
        )
    [5] => stdClass Object (
        [SubmissionValueId] => 33
        [FormId] => 3
        [SubmissionId] => 4
        [FieldName] => Nr seryjny lampy
        [FieldValue] => sdadsd
        )
    [6] => stdClass Object (
        [SubmissionValueId] => 34
        [FormId] => 3
        [SubmissionId] => 4
        [FieldName] => data2
        [FieldValue] => 05.08.2012
        )
    [7] => stdClass Object (
        [SubmissionValueId] => 35
        [FormId] => 3
        [SubmissionId] => 4
        [FieldName] => Wyslij
        [FieldValue] => Wyślij
        ) 
    [8] => stdClass Object (
        [SubmissionValueId] => 36
        [FormId] => 3
        [SubmissionId] => 4
        [FieldName] => formId
        [FieldValue] => 3 
        ) 
    ) 
```

F.ex 我需要 ['FieldName'] 我试过了

```
 foreach ($wartosci as $value)
    { echo $value['FieldName'];} 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:37:08.260

我明白了，感谢 Grzegorz，这是解决方案：

```
foreach ($wartosci as $value)
        {
        echo $value->FieldName;
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T06:27:09.237

因为它不是数组对象，而是 std 对象，所以你不能用它来调用它`$array['key']`

对于数组变量。

```
foreach ($wartosci as $value)
    { echo $value['FieldName']; } 
```

对于标准对象。

```
foreach ($wartosci as $value)
    { echo $value->FieldName; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T22:29:16.193

在请开发人员帮助您之前，您应该先在 Internet 上进行搜索。

这是手册： http: [//php.net/manual/en/control-structures.foreach.php](http://php.net/manual/en/control-structures.foreach.php)

# javascript - jQuery Cycle 寻呼机追加较小的图像大小

> ID：12206437
> 
> 赞同：1
> 
> 时间：2012-08-30T22:24:54.793
> 
> 标签：javascript, jquery, wordpress

使用以下代码，我将图像加载到 Wordpress 上 jquery 滑块的缩略图寻呼机中。这工作正常，但问题是它使用巨大的图像并将它们调整为小尺寸。这使我的页面加载缓慢。所以我在函数中创建了一个自定义图像大小。这将创建一个名为 slide-181x86.jpg 的新小图像。我的问题是如何修改 jquery 的最后一行以在 url 的末尾添加 -181x86 而不是在 jpg 的末尾？我不断收到 slide.jpg-181x86 这显然不正确。

我一直在自杀，任何帮助将不胜感激。

```
<script type="text/javascript">
jQuery(function() {
jQuery('.homeslider').cycle({
    speed:  'fast',
    timeout: 7000,
    fx: 'fade',
  slideResize: false,
containerResize: false,
fit:1,
    pager:  '#slitemshome',
    pagerAnchorBuilder: function(idx, slide) {
return '<li><a href="#"><img src="'
    + jQuery(slide).find('img').attr('src')
    + '" width="181" height="86" /></a></li>'; 
}
});
});
</script> 
```

编辑：

我只是在函数之后尝试这样做

```
jQuery('#slitemshome img').attr('src', function(){this.src.replace('.jpg', '-181x86.jpg')}) 
```

这似乎对网址没有任何作用。啊

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T00:45:01.780

这应该有效：

```
$('img').each(function() {
    $(this).attr('src', $(this).attr('src').replace(/\.jpg/, '-181x86.jpg'));
}); 
```

[http://jsfiddle.net/charlescarver/3hLH4/](http://jsfiddle.net/charlescarver/3hLH4/)

* * *

本来我打算找到所有`img`变量，去掉`.jpg`结尾，然后追加`-181x86.jpg`到结尾，但后来我想，为什么不直接`.jpg`用 the`-181x86.jpg`替换呢？

[PS JSFiddle 图像不起作用，因为没有`-181x86.jpg`附加到末尾的占位符图像。]

# sql - SQL 查询而不是 CakePHP 样式的查询

> ID：12206438
> 
> 赞同：0
> 
> 时间：2012-08-30T22:24:54.907
> 
> 标签：sql, cakephp-2.0

我有一个非常复杂的查询：这么多表（和……这么多嵌套模型）。我感觉更舒服，使用原始 SQL 查询而不是 CakePHP 查询语法。据我所知，我应该更喜欢 CakePHP 语法，因为它几乎不受攻击。

考虑到我不会使用 Cake 的语法，有没有办法将 cake 方法的安全性与原始 SQL 方法的实用性结合起来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:43:44.957

我认为如果你使用 mysql 的 pdo 适配器，它可以为 sql 注入提供安全性。

我还可以使用[Sanitize::clean](http://book.cakephp.org/2.0/en/core-utility-libraries/sanitize.html)和[Sanitize::escape](http://book.cakephp.org/2.0/en/core-utility-libraries/sanitize.html)来逃避您的查询。

# jquery - 单击缩略图并将图像加载到空 div

> ID：12206443
> 
> 赞同：1
> 
> 时间：2012-08-30T22:25:45.500
> 
> 标签：jquery, load, thumbnails

从缩略图加载图像似乎已经令人作呕，但我就是无法将我的大脑包裹在它周围。这是我的html，其中#sideWall 握着拇指，我希望高分辨率进入#photoHolder ...

```
<div id="graphicContainer">
<div id="sideWall">
    <span class="sideHead">EXHIBITS</span><br/>
    <span class="sideChatter">Click an image to learn more.</span><br/>
    <img src="images/frisco4501_t.jpg" full="frisco4501.jpg" />
    <img src="images/centennial_t.jpg" full="centennial.jpg" />
    <!--     etc...     -->
</div> <!--End of sidewall-->
<div id="photoHolder"></div> 
```

这是我的美元。alert() 正在返回正确的目录并且淡入淡出工作，图像只是没有加载......

```
$('#sideWall img').each(function(){
    $this = $(this);
    $image = "../images/"+$this.attr('full');
    $this.click(function(){
        alert($image);
        $("#photoHolder").html('<img src="'+$image +'" />');
        $("#photoHolder").fadeIn(2000);         
    })
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T22:34:26.683

我认为，解决方案可以更简单地完成：

```
$('#sideWall img').click(function(){
  var c = $(this).attr("src").replace('_t.','.');
  $("#photoHolder").html('<img src="'+ c +'" />');
  $("#photoHolder").fadeIn(2000);         
}) 
```

确定以防万一（常见实践）-拇指具有相同的名称并且位于同一目录中。那么就不需要属性“full”了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:34:57.070

不需要`.each()`. jQuery 开箱即用地处理集合。
此外，使用 HTML5`data-*`属性来存储较大的图像 src 字符串：

```
$('#sideWall').on('click', '[data-src2x]', function() {
  const src2x = $(this).data('src2x');
  $("#photoHolder").hide().html(`<img src="${src2x}">`).fadeIn();         
});
```

```
<div id="graphicContainer">

  <div id="sideWall">
      <h4 class="sideHead">EXHIBITS</h4>
      <p class="sideChatter">Click an image to learn more.</p>
      <img src="http://placehold.it/100x50/cf5" data-src2x="http://placehold.it/200x100/cf5" />
      <img src="http://placehold.it/100x50/f0f" data-src2x="http://placehold.it/200x100/f0f" />
  </div>

  <div id="photoHolder"></div>

</div>

<script src="//code.jquery.com/jquery-3.1.0.js"></script>
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T22:36:26.523

我会尝试这样的事情：

```
$('#sideWall img').click(function(){
    $image = "../images/"+$(this).attr('data-full');
    alert($image);
    $("#photoHolder").html('<img src="'+$image +'" />').fadeIn(2000);         
}); 
```

不必测试它，但它应该可以工作。请注意，我将 attr 'full' 更改为 'data-full' 以使其 HTML5 有效。

# java - 在 BufferedImage.setRGB() 中保留 alpha 值？

> ID：12206448
> 
> 赞同：0
> 
> 时间：2012-08-30T22:25:56.040
> 
> 标签：java

我想将几张图像合成在一起。每个图像都有一些透明度。我正在尝试为此使用 BufferedImage 但似乎没有任何方法可以为此目的使用它？

我们只得到 BufferedImage.setRGB() 方法。相反，我需要透明像素不会覆盖它们下面的像素值的东西。我该怎么做呢？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:30:23.830

```
/* imageType should be one of the variants that includes alpha  */
final BufferedImage composited = new BufferedImage(width, height, imageType);
final Graphics graphics = composited.getGraphics();
for (final Image layer : layers) {
  /* draw the image at 0,0 */
  graphics.drawImage(layer, 0, 0, null);
}
graphics.dispose(); 
```

# objective-c - 为什么 UIView 动画不起作用

> ID：12206449
> 
> 赞同：0
> 
> 时间：2012-08-30T22:25:56.110
> 
> 标签：objective-c

我要做的是以编程方式在屏幕的左上角创建一个 UIView 矩形，然后将其移动到右上角、右下角、左下角，最后回到左上角。但它没有按预期工作。我的代码有什么问题？

```
#import "ViewController.h"

@interface ViewController ()
@property (nonatomic,strong) UIView *myView;
@end

@implementation ViewController
@synthesize myView = _myView;

- (IBAction)animation:(UIButton *)sender {
    [UIView animateWithDuration:3.0 animations:^{
        self.myView.alpha = 0.75;
        self.myView.frame = CGRectMake(160, 0, 160,230);}];

    [UIView animateWithDuration:3.0 animations:^{
        self.myView.alpha = 0.50;
        self.myView.frame = CGRectMake(160, 230, 160,230);}];

     [UIView animateWithDuration:3.0 animations:^{
     self.myView.alpha = 0.25;
     self.myView.frame = CGRectMake(0, 230, 160,230);}];

     [UIView animateWithDuration:3.0 animations:^{
     self.myView.alpha = 0.00;
     self.myView.frame = CGRectMake(0, 0, 160,230);}
     completion:^(BOOL finished) {
     [self.myView removeFromSuperview];
     }];

}

- (void)viewDidLoad
{
    [super viewDidLoad];
    CGRect viewRect = CGRectMake(0, 0, 160, 230);
    UIView *mv = [[UIView alloc] initWithFrame:viewRect];
    self.myView = mv;
    self.myView.backgroundColor = [UIColor redColor];
    [self.view addSubview:self.myView];

}
@end 
```

**编辑：我解决了嵌套完成块的问题：**

```
- (IBAction)animation:(UIButton *)sender {
    [UIView animateWithDuration:3.0 animations:^{
        self.myView.alpha = 0.75;
        self.myView.frame = CGRectMake(160, 0, 160,230);}
     completion:^(BOOL finished) {
         [UIView animateWithDuration:3.0 animations:^{
             self.myView.alpha = 0.50;
             self.myView.frame = CGRectMake(160, 230, 160,230);}
          completion:^(BOOL finished) {
              [UIView animateWithDuration:3.0 animations:^{
                  self.myView.alpha = 0.25;
                  self.myView.frame = CGRectMake(0, 230, 160,230);}
          completion:^(BOOL finished) {
              [UIView animateWithDuration:3.0 animations:^{
                  self.myView.alpha = 0.00;
                  self.myView.frame = CGRectMake(0, 0, 160,230);}
                               completion:^(BOOL finished) {
                                   [self.myView removeFromSuperview];
          }];}];}];}];} 
```

**然而读起来很可怕。还有其他方法吗？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:44:59.070

这不是特定的动画，但您应该尝试这种模式以使动画的各个部分依次启动：

```
[UIView animateWithDuration:3.0 animations:^{
    // first part of the animation
} completion:^(BOOL finished) {
    [UIView animateWithDuration:3.0 animations:^{
        // second part of animation
    } completion:^(BOOL finished) {
        [UIView animateWithDuration:3.0 animations:^{
            // third part of the animation
        } completion:^(BOOL finished) {
            [UIView animateWithDuration:3.0 animations:^{
                // forth part of the animation
            } completion:^(BOOL finished) {
                // finish and clear the animation
            }];
        }];
    }];
}]; 
```

# java - 计算放置在具有不同速度和方向的其他两个对象中间的对象的速度

> ID：12206452
> 
> 赞同：0
> 
> 时间：2012-08-30T22:26:05.620
> 
> 标签：java, android, physics

我在 2D 中有两个点

```
//Point1 has velocity 
vX = 100;
vY = 50;
posX = 300;
posY = 100;

//Point2  has velocity 
vX = -20;
vY = 80;
posX = -800;
posY = 1000; 
```

另外我有一个点直接放在这两个点的中间，我如何计算这个中间点的速度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:37:14.597

通过确定它的 vX 和 vY 是什么。

它的 x 和 y 是

```
x = (-800 - 20 * t + 300 + 100 * t) / 2
y = (1000 + 80 * t + 100 + 50 * t) / 2 
```

简化

```
x = -250 + 40 * t
y = 550 + 65 * t 
```

所以它的 vX 是 40，它的 vy 是 65。我的朋友毕达哥拉斯告诉我这里的速度是`sqrt((40 * 40) + (65 * 65))`或大约**76 个单位每滴答声**。

# java - 我可以使用预配置的机器映像 w/Ruby/Java 预安装在具有 diff.RAM+CPU 的机器上吗

> ID：12206453
> 
> 赞同：1
> 
> 时间：2012-08-30T22:26:10.253
> 
> 标签：java, ruby, amazon-ec2, cloud, rackspace-cloud

我创建了一个机器映像，其中安装了一些语言/框架——例如 Java、Ruby 等。

我的想法是，我可以用这个机器映像快速初始化一个新的虚拟机（例如在 Amazon EC2 或 Rackspace Cloud 上），然后在那个虚拟机上运行一些代码。

我不确定的是，假设我在具有 1GB RAM /2 Ghz CPU 的服务器中创建了我的机器映像——我能否像在具有不同 CPU+RAM 配置的虚拟机中一样使用此映像？例如，我能否在具有 8GM RAM 的虚拟机中直接使用我的图像？

或者我必须进行任何手动配置/调整，以确保我的机器映像在具有差异的虚拟机上工作。CPU+内存配置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T15:26:18.343

您当然可以将图像映射到 CPU 和 RAM 的更高/更低配置。但是，您不能更改图像的位架构。例如，64 位机器不能配置 32 位图像，32 位机器也不能配置 64 位图像。您无需进行任何配置即可使其至少在 amazon ec2 中工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T16:42:03.730

您当然可以在 Amazon EC2 上执行此操作；您创建一个[Amazon 系统映像](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/AMIs.html)(AMI)，它是您的虚拟机及其所有配置的完整定义，然后您可以使用具有不同 CPU/RAM 配置的不同[实例类型启动它的新实例。](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/instance-types.html#AvailableInstanceTypes)

我不熟悉 Rackspace Cloud，但如果他们不提供类似的东西，我会感到惊讶。

# playframework - Play Framework: 2.0.2 PersistenceException:Cannot register class in Ebean server

> ID：12206457
> 
> 赞同：5
> 
> 时间：2012-08-30T22:26:29.270
> 
> 标签：playframework, persistence, playframework-2.0, ebean

首先，这个问题可能看起来很像： [Play Framework: PersistenceException: The type is not an registered entity? （Ebean）](https://stackoverflow.com/questions/9824190/play-framework-persistenceexception-the-type-is-not-a-registered-entity-ebea)但它不是......

我正在尝试保存一个实体，但它甚至不呈现模板，在我重新启动 Play 后它只会给出主题中的错误。当然，应用程序会编译。

我已经完成了在 Play 中使用 EBean 的所有步骤：

*   `@Entity`带有（javax.persistence.Entity）的注释模型
*   模型扩展模型 ( `play.db.ebean.Model`)
*   我的 Ebean 已启用`application.conf` `ebean.default="models.*"`（我的课程在`models`包中）

有什么建议么？我能做的测试？要检查的东西？公平地说，stackoverflow 是我最后的手段......

提前致谢，

完整的堆栈跟踪：

```
play.api.Configuration$$anon$1: Configuration error [Cannot register class [models.Producer] in Ebean server]
    at play.api.Configuration$.play$api$Configuration$$configError(Configuration.scala:71) ~[play_2.9.1.jar:2.0.2]
    at play.api.Configuration.reportError(Configuration.scala:258) ~[play_2.9.1.jar:2.0.2]
    at play.Configuration.reportError(Configuration.java:119) ~[play_2.9.1.jar:2.0.2]
    at play.db.ebean.EbeanPlugin.onStart(EbeanPlugin.java:71) ~[play_2.9.1.jar:2.0.2]
    at play.api.Play$$anonfun$start$1.apply(Play.scala:60) ~[play_2.9.1.jar:2.0.2]
    at play.api.Play$$anonfun$start$1.apply(Play.scala:60) ~[play_2.9.1.jar:2.0.2]
Caused by: java.lang.ExceptionInInitializerError: null
    at java.lang.Class.forName0(Native Method) ~[na:1.7.0_02]
    at java.lang.Class.forName(Class.java:264) ~[na:1.7.0_02]
    at play.db.ebean.EbeanPlugin.onStart(EbeanPlugin.java:69) ~[play_2.9.1.jar:2.0.2]
    at play.api.Play$$anonfun$start$1.apply(Play.scala:60) ~[play_2.9.1.jar:2.0.2]
    at play.api.Play$$anonfun$start$1.apply(Play.scala:60) ~[play_2.9.1.jar:2.0.2]
    at scala.collection.LinearSeqOptimized$class.foreach(LinearSeqOptimized.scala:59) ~[scala-library.jar:0.11.3]
Caused by: java.lang.RuntimeException: DataSource user is null?
    at com.avaje.ebeaninternal.server.lib.sql.DataSourcePool.<init>(DataSourcePool.java:198) ~[ebean.jar:na]
    at com.avaje.ebeaninternal.server.lib.sql.DataSourceManager.getDataSource(DataSourceManager.java:210) ~[ebean.jar:na]
    at com.avaje.ebeaninternal.server.lib.sql.DataSourceGlobalManager.getDataSource(DataSourceGlobalManager.java:63) ~[ebean.jar:na]
    at com.avaje.ebeaninternal.server.core.DefaultServerFactory.getDataSourceFromConfig(DefaultServerFactory.java:427) ~[ebean.jar:na]
    at com.avaje.ebeaninternal.server.core.DefaultServerFactory.setDataSource(DefaultServerFactory.java:388) ~[ebean.jar:na]
    at com.avaje.ebeaninternal.server.core.DefaultServerFactory.createServer(DefaultServerFactory.java:168) ~[ebean.jar:na] 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-09T22:19:46.087

我在第一篇文章中描述了完全相同的问题。就我而言，这很奇怪，只是在运行

```
# play 

> clean
> compile
> run 
```

该应用程序再次开始工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-06T16:30:14.753

问题是 Ebeans 配置，一些关联不正确。也许您更改了他们的应用程序模型中的某些内容并且没有记录在 Ebean 中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-31T07:17:55.143

从日志中，您似乎必须设置 Datasource 用户：

```
Caused by: java.lang.RuntimeException: DataSource user is null? 
```

您可以通过编辑 pour conf/application.con 文件来做到这一点：

```
db.default.driver=org.h2.Driver
db.default.url="jdbc:h2:mem:DB_NAME"
db.default.user=sa        <-- HERE !!
db.default.password=""
db.default.logStatements=true 
```

# php - 如何在指定字符之前获取 1 个字符

> ID：12206459
> 
> 赞同：2
> 
> 时间：2012-08-30T22:26:31.967
> 
> 标签：php

我的字符串`"**7:00am-4:00pm** M-F"` 我想做的是提取`"7"`和`"4"`，但是这些数字可能因字符串而异。我查找了一些可以找到出现的函数，`":"` 但它们要么返回开始的一半，只匹配第一次出现，要么返回真或假。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T22:31:26.813

似乎是正则表达式的好例子。这是一个可以解决问题的方法：

```
<?php 

function get_times($str) {
    preg_match('#\*\*(\d{1,2}):\d\d\w+-(\d{1,2}):\d\d\w+\*\*#', $str, $matches);
    return array($matches[1], $matches[2]);
}

$strs = array();
$strs[] = "**7:00am-4:00pm** M-F";
$strs[] = "**11:00am-1:00pm** M-F";
$strs[] = "**4:00am-11:00pm** M-F";
$strs[] = "**11:00am-11:00pm** M-F";

foreach ($strs as $str) {
    echo $str . "\n";
    list($start, $end) = get_times($str);
    echo "Start: $start, End: $end\n\n";
} 
```

**输出**

```
**7:00am-4:00pm** M-F
Start: 7, End: 4

**11:00am-1:00pm** M-F
Start: 11, End: 1

**4:00am-11:00pm** M-F
Start: 4, End: 11

**11:00am-11:00pm** M-F
Start: 11, End: 11 
```

**注意**
这适用于 1 位或 2 位数字的时间，如示例中所示。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:31:46.903

您可以使用爆炸功能

```
$string = "**7:00am-4:00pm** M-F";

$string = explode(":",$string);

$first  = preg_replace("/[^0-9]/","", substr($string[0],-2));
$second = preg_replace("/[^0-9]/","", substr($string[1],-2)); 
```

它的工作时间是两位数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T22:41:20.630

```
preg_match_all('/([0-9]+):/', '**7:00am-4:00pm** M-F', $matches); 
$numbers = end($matches); 
$start = $numbers[0];
$end = $numbers[1]; 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-08-30T22:31:12.210

使用`strpos()`并减去 1：

```
$index = strpos($text, ":");

if ($index > 0) {
  $value = substr($test, $index - 1, 1);
} 
```

# wcf - WCF DataContract 继承

> ID：12206470
> 
> 赞同：0
> 
> 时间：2012-08-30T22:27:24.680
> 
> 标签：wcf, c#-4.0

我有`DataContract`定义的 WCF 和其他`DataContract`一些扩展它的 WCF。所以它的原始形式看起来像这样：

```
 [DataContract(Name = "FacilityPerson"]
    [KnownType(typeof(Student))]
    [KnownType(typeof(Teacher))]
    public class Person
    {
        [DataMember(IsRequired=true)]
        public string FirstName { get; set; }
        [DataMember]
        public string LastName { get; set; }
        [DataMember]
        public DateTime? DOB { get; set; }   

    }

    [DataContract]
    public class Student
    {
        [DataMember(IsRequired=true)]
        public int StudentID { get; set; }

    }

[DataContract]
public class Teacher
{
    [DataMember(IsRequired=true)]
    public int StaffID { get; set; }

} 
```

我有一个`ServieContract`只有一个操作，看起来像这样：

```
[OperationContract(Name = "ReportNewPerson")]
void ReportNewTeacherOrStudent(Person person); 
```

我的问题是当我实现它时，我无法访问父对象的子属性。

```
public class UniversityService : IUniversityServiceContract  
{

        void ReportNewTeacherOrStudent(Person person)
        {
             if(person.GetType().FullName == "Student")
             {
                     //here I have a parent object so I cannot getStudentId which is a child property           
                     Console.Writeline(person.StudentId);

             }

        }
} 
```

我应该在这里做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T23:18:09.367

不要从名称上比较类型；相反，请使用演员表或`as`运算符来做到这一点：

```
public class UniversityService : IUniversityServiceContract  
{
    public void ReportNewTeacherOrStudent(Person person)
    {
        Student student = person as Student;
        if (student != null)
        {
            Console.Writeline(student.StudentId);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T01:46:13.953

检查卡洛斯菲盖拉的答案。他是对的。

您还需要为您的`Teacher`和`Student`类添加继承：

```
[DataContract]
public class Student: Person
{
    ...
}

[DataContract]
public class Teacher: Person
{
   ...    
} 
```

更新：是的，您必须在父项和子项中指定属性。

# c# - 如何使用 ServiceStack CacheClient 和 Redis 来增加或创建计数器

> ID：12206472
> 
> 赞同：3
> 
> 时间：2012-08-30T22:27:27.427
> 
> 标签：c#, .net, caching, redis, servicestack

我正在使用 ServiceStacks CacheClient 和 Redis 库。我想缓存用户执行的某些事务的数量。如果密钥不存在，我正在使用以下内容获取缓存值或从数据库创建它：

```
public int GetTransactionCountForUser(int userID)
{
    int count;

    //get count cached in redis...
    count = cacheClient.Get<int>("user:" + userID.ToString() + ":transCount");

    if (count == 0)
    {
        //if it doent exists get count from db and cache value in redis
        var result = transactionRepository.GetQueryable();
        result = result.Where(x => x.UserID == userID);
        count = result.Count();

        //cache in redis for next time...
        cacheClient.Increment("user:" + userID.ToString() + ":transCount", Convert.ToUInt32(count));
    }

    return count;
} 
```

现在，在另一个操作中（当事务发生时）我将向数据库添加一行，我想将我的 Redis 计数器增加 1。

在递增之前，我是否首先需要检查特定键是否存在？我知道缓存客户端的 Increment 方法会在不存在的情况下创建记录，但在这种情况下，即使数据库中有事务记录，计数器也会从 0 开始。

处理这种情况的正确方法是什么？获取密钥，如果为空，则查询数据库以获取计数并使用此数字创建密钥？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T04:11:55.640

有几点需要注意：

1.  您可以使用[EXISTS](http://redis.io/commands/exists)检查密钥是否已存在。这更好，因为您现在可以缓存实际拥有 0 个事务的用户。
2.  `INCR``INCRBY`如果密钥不存在，命令将创建密钥

所以，在伪代码中，这就是你应该做的 -

```
if EXISTS user:<userid>:transcount
    return GET user:<userid>:transcount
else
    int transCountFromDB = readFromDB();
    INCRBY user:<userid>:transcount transCountFromDB
    return transCountFromDB 
```

您可能还想在执行`EXPIRE`后立即对键执行命令`INCRBY`，以便仅在可接受的时间内缓存记录。

# ios - 将自定义图像添加到 iPad 应用程序的工具栏

> ID：12206474
> 
> 赞同：1
> 
> 时间：2012-08-30T22:27:39.527
> 
> 标签：ios, uitoolbar, uitoolbaritem

我环顾四周，似乎无法在我的工具栏中使用自定义图像。我的 ViewController.m 的自定义初始化部分中有以下代码，这是添加它的正确位置吗？我在上方工具栏中没有看到任何图像。我想把它放在视图的右上方。

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self) {
    // Custom initialization
    UIImage *image = [UIImage imageNamed:@"camera_30_30.png"];
    UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
    [button setImage:image forState:UIControlStateNormal];

    button.frame = CGRectMake( 0, 0, image.size.width, image.size.height);
    button.showsTouchWhenHighlighted = YES;

    [button addTarget:self action:@selector(myAction) forControlEvents:UIControlEventTouchUpInside];
    UIBarButtonItem *barButtonItem = [[UIBarButtonItem alloc] initWithCustomView:button];

    NSMutableArray *items = [[NSMutableArray alloc] init];
    [items addObject:barButtonItem];
    self.toolbarItems = items;
}
return self;
} 
```

感谢您的关注。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T23:20:22.437

这可能与您分配工具栏项的时间有关。我假设一旦加载了 UI，就需要在 viewDidLoad 方法中进行设置。

您可能还可以通过以下方式简化栏按钮的创建：

```
UIBarButtonItem *barButtonItem = [[UIBarButtonItem alloc]initWithImage:@"camera_30_30.png" style:UIBarButtonItemStyleBordered target:self action:@selector(myAction)]; 
```

此外，在您的代码中，您需要在最后发布项目

# javascript - 修改表单提交字符串

> ID：12206475
> 
> 赞同：2
> 
> 时间：2012-08-30T22:27:56.327
> 
> 标签：javascript, mootools

我想限制在我的表单中传递的值。例如：

```
<form action="" method="get">
    <input name="check1" type="radio" value="123" checked>
    <input name="check2" type="radio" value="456" checked>
    <input name="check3" type="radio" value="789" checked>
    <input type="submit" title="submit" id="btn_submit">
</form> 
```

现在，如果我提交，我会得到类似下面的 url

> www.domain.com/?check1=123&check2=456&check3=789

我怎样才能控制它只发送'check3'？所以网址是

> www.domain.com/?check3=789

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:37:06.137

您的单选按钮应具有相同的名称。如果您需要用 JS 识别它们，请给它们唯一的 ID。

```
<form action="" method="get">
    <input name="check3" type="radio" value="123" checked>
    <input name="check3" type="radio" value="456" checked>
    <input name="check3" type="radio" value="789" checked>
    <input type="submit" title="submit" id="btn_submit">
</form> 
```

如果这不是您想要的，请仅在您希望将输入字段包含在提交中时将其包含在表单中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:46:22.950

```
<input name="check1" type="radio" value="123" checked>
<input name="check2" type="radio" value="456" checked>
<input name="check3" type="radio" value="789" checked>

<form action="" method="get">
    ... other form elements
    <input type="submit" title="submit" id="btn_submit">
</form> 
```

# javascript - 当使用 jquery 检查三个复选框时，如何使 div 变灰？

> ID：12206476
> 
> 赞同：3
> 
> 时间：2012-08-30T22:27:56.957
> 
> 标签：javascript, jquery

我有一个页面，需要在检查三个复选框时淡出DIV。我正在使用下面的代码，但它不起作用。任何建议为什么？

```
<script>
function countChecked() {
var n = $("input:checked").length;
if($("input:checked").length > 3) {

    }
    else
    {
   $(".chkExample")
     .fadeTo(500, 0.2)
    }

}
countChecked();

$(":checkbox").click(countChecked);

</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T22:33:14.250

我稍微格式化了你的代码。这是检查`> 3`. 这与`>= 4`本例中的情况相同。因此，您要检查 4 个或更多，而不是 3 个或更多。

如果您想检查 3 个框，您需要这样做`n === 3`。如果您想要 3 次或更多使用`n >= 3`和 3 次或更少使用`n <= 3`

此外，如果您只想在点击事件上选中该框，则不需要手动调用`countChecked`

此外，根据评论，使用局部变量来保存 JQuery 对象的长度。

此外，根据 mcp 的回答、使用`[type="checkbox"]`和`on`方法。

**结果：**

```
function countChecked() {
    var n = $("input[type="checkbox"]:checked").length;
    if(n === 3) {
        $(".chkExample").fadeTo(500, 0.2)
    } else {
    }
}
$('input[type="checkbox"]').on('change', countChecked);​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:34:28.577

```
function countChecked() {
    var count = $('input[type="checkbox"]:checked').length;

    // this will test for 3 or more >=
    if (count >= 3) { alert('3 or more checked!'); }
    else { $(".chkExample").fadeTo(500, 0.2) }
}

countChecked();
// assuming you are using at least 1.7.2 of jQuery
// but start using `.on()` and with checkboxes/radios I always use 'change'
$('input[type="checkbox"]').on('change', countChecked);​ 
```

现在在随机方面：复选框实际上已折旧。使用`[type="checkbox"]`它会使用本机 javascript 来让它们更快。

```
​ 
```

[jsFiddle 演示](http://jsfiddle.net/VR4j6/2/)

# c# - 如何以编程方式从 datagridview 中的一个单元格移动到另一个单元格？

> ID：12206478
> 
> 赞同：5
> 
> 时间：2012-08-30T22:28:09.073
> 
> 标签：c#, windows, datagridview, keydown, datagridviewtextboxcell

我只需要允许一个字符输入到可编辑的 datagridview 单元格中（每隔一列，奇数列，都是可编辑的）；如果用户在其中一个单元格中添加第二个字符，则光标应向下移动到下一个单元格并将第二个值放在那里（再次按下该键再次向下移动，依此类推）。如果在网格的底部（第 12 行），它应该移动到第 0 行，并向右移动两列。

我试过这样做：

```
private void dataGridViewPlatypus_KeyDown(object sender, KeyEventArgs e) {
    var currentCell = dataGridViewPlatypus.CurrentCell;
    int currentCol = currentCell.ColumnIndex;
    int currentRow = currentCell.RowIndex;
    if (currentCell.Value.ToString().Length > 0) {
        if (currentRow < 11) {
            dataGridViewPlatypus.CurrentCell.RowIndex = currentRow+1;
        } else if (currentRow == 11) {
            currentCell.RowIndex = 0;
            currentCell.ColumnIndex = currentCell.ColumnIndex + 2;
            dataGridViewPlatypus.CurrentCell = currentCell;
        }
    }
} 
```

...但是我收到了无法将 RowIndex 和 ColumnIndex 分配给的错误消息，因为它们是只读的。

那么我怎样才能做到这一点呢？

警告：我知道如果当前位于最后一个可编辑列的底部，我还必须添加逻辑以移动到第 1 列。

## 更新

从 tergiver 的回答来看，这就是我到目前为止所得到的，但我不知道如何前进到下一个单元格。

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData) {
    if (this.ActiveControl == dataGridViewPlatypus)
    {
        var currentCell = dataGridViewPlatypus.CurrentCell;
        if (currentCell.Value.ToString().Length == 1) 
        {
            ;//Now what?
        }
    }
    return base.ProcessCmdKey(ref msg, keyData);
} 
```

## 更新 2

谢谢大家；这就是我用来让它几乎工作的东西（我仍然希望能够让用户简单地按住键，并在后续单元格中连续输入该值）：

```
private void dataGridViewPlatypus_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e) {
    int columnIndex = (((DataGridView)(sender)).CurrentCell.ColumnIndex);
    if (columnIndex % 2 == 1) {
        e.Control.KeyDown -= TextboxNumeric_KeyDown;
        e.Control.KeyDown += TextboxNumeric_KeyDown;
        e.Control.KeyUp -= TextboxNumeric_KeyUp;
        e.Control.KeyUp += TextboxNumeric_KeyUp;
    }
}

private void TextboxNumeric_KeyDown(object sender, KeyEventArgs e) {
    var tb = sender as TextBox;
    if (tb != null) {
        tb.MaxLength = 1;
    }
}

// TODO: Now need to find a way to be able to just press down once
private void TextboxNumeric_KeyUp(object sender, KeyEventArgs e) {
    var tb = sender as TextBox;
    if (tb != null && tb.TextLength >= 1) {
        if (dataGridViewPlatypus.CurrentCell.RowIndex != dataGridViewPlatypus.Rows.Count - 1) {
            dataGridViewPlatypus.CurrentCell = dataGridViewPlatypus[
                dataGridViewPlatypus.CurrentCell.ColumnIndex,
                dataGridViewPlatypus.CurrentCell.RowIndex + 1];
        } else { // on last row
            this.dataGridViewPlatypus.CurrentCell = this.dataGridViewPlatypus.CurrentCell.ColumnIndex !=    dataGridViewPlatypus.Columns.Count - 1 ? this.dataGridViewPlatypus[this.dataGridViewPlatypus.CurrentCell.ColumnIndex    + 2, 0] : this.dataGridViewPlatypus[1, 0];
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T12:29:14.793

的`CurrentCell`属性`DataGridView`有一个设置器，允许您传入一个新单元格。

解决此问题的一种方法是处理`EditingControlShowing`网格事件并将`KeyPress`处理程序附加到编辑控件，如下所示：

```
private void dataGridView1_EditingControlShowing(object sender, DataGridViewEditingControlShowingEventArgs e)
{                
    if ((int)(((System.Windows.Forms.DataGridView)(sender)).CurrentCell.ColumnIndex) == 1)
    {
        e.Control.KeyPress += TextboxNumeric_KeyPress;
    }
} 
```

然后在按键处理程序中你有：

```
private void TextboxNumeric_KeyPress(object sender, KeyPressEventArgs e)
{
    TextBox tb = sender as TextBox;
     if (tb.TextLength >= 5)
     {
         dataGridView1.CurrentCell = dataGridView1[dataGridView1.CurrentCell.ColumnIndex + 1, dataGridView1.CurrentCell.RowIndex];
     }
} 
```

上面的逻辑当然不适合您的情况，但传入新 CurrentCell 的原则（在从网格中检索所需的单元格之后）仍然存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:34:56.327

DGV 上的 KeyDown 不起作用，因为 DataGridViewTextBoxColumn 使用就地 TextBox 控件，它使其可见并及时移动到适当位置以进行编辑。

由于所有文本列只有一个就地 TextBox，因此您可以订阅其 KeyDown 事件，但获取对该控件的引用可能存在先有鸡还是先有蛋的问题。

最好使用表单的 ProcessCmdKey 覆盖并在那里执行此逻辑。发生按键按下时，检查DGV是否为ActiveControl，检查当前单元格是否为文本单元格，检查单元格是否已经包含字符，然后在允许处理按键之前更改当前单元格。

**更新 - 拿 2**

```
using System;
using System.Drawing;
using System.Linq;
using System.Runtime.InteropServices;
using System.Windows.Forms;

class Item
{
    public string A { get; set; }
    public string B { get; set; }
    public string C { get; set; }
    public string D { get; set; }
}

class Form1 : Form
{
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form1());
    }

    DataGridView dataGridViewPlatypus;

    public Form1()
    {
        ClientSize = new Size(480, 260);
        Controls.Add(dataGridViewPlatypus = new DataGridView
        {
            Dock = DockStyle.Fill,
            DataSource = Enumerable.Range(1, 10).Select(i => new Item { A = "", B = "", C = "", D = "" }).ToList(),
        });
    }

    [DllImport("User32.dll")]
    extern static int PostMessage(IntPtr hWnd, int msg, IntPtr wParam, IntPtr lParam);

    protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
    {
        if (msg.Msg == 256) // WM_KEYDOWN
        {
            if (this.ActiveControl == dataGridViewPlatypus.EditingControl)
            {
                var currentCell = dataGridViewPlatypus.CurrentCell;
                if (currentCell.OwningColumn is DataGridViewTextBoxColumn && dataGridViewPlatypus.EditingControl.Text.Length > 0)
                {
                    int rowIndex = currentCell.RowIndex;
                    int columnIndex = currentCell.ColumnIndex;

                    if (++columnIndex >= dataGridViewPlatypus.Columns.Count)
                    {
                        columnIndex = 0;
                        if (++rowIndex >= dataGridViewPlatypus.Rows.Count)
                            rowIndex = 0;
                    }

                    dataGridViewPlatypus.CurrentCell = dataGridViewPlatypus[columnIndex, rowIndex];
                    PostMessage(dataGridViewPlatypus.Handle, msg.Msg, msg.WParam, msg.LParam);
                    return true; // Don't process this message, we re-sent it to the DGV
                }
            }
        }
        return base.ProcessCmdKey(ref msg, keyData);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T22:35:10.207

单元格具有`Selected`您可以设置的属性。只需按列和行索引访问单元格。

我相信你能做到

`dgView.rows[0].cells[0].selected = true`,

这将为您提供 (0,0) 或第一行第一列相交的单元格。或者，您可以像这样抓取行：

我认为这就是类-->`DataGridViewRow row = dgView.rows[0]`

接着

`row[0].cells[0].Selected = true`.

```
 Column 1  Column 2
Row 1 [this guy][        ]
Row 2 [        ][        ] 
```

## 编辑：

要获取下一个单元格，只需执行以下操作：

```
sameRow.cells[currentCell.ColumnIndex+1].Selected = true; 
```

我可能错过了那里的一些大写字母，但你明白了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-07-19T22:11:19.053

如果选定的单元格在第一列，我有一个过程会爆炸。因此，在该过程的按钮代码中，这是其中的第一个代码：（顺便说一句，我在网格中使用单元格选择）

```
if (dgvGrid.CurrentCell.ColumnIndex == 0) // first column
    dgvGrid.Rows[dgvGrid.CurrentCell.RowIndex].Cells[1].Selected = true; 
```

这有效地“选项卡”到下一列，然后我的其余过程开始工作。

# php - 剥离字符的左右两侧

> ID：12206479
> 
> 赞同：0
> 
> 时间：2012-08-30T22:28:12.230
> 
> 标签：php

在php中剥离左右字符的最佳方法是什么？我有它剥离权利，但无法弄清楚左边。我尝试了 ltrim，但似乎效果不佳。

```
$rawsubject = 'RE: [#4152] - Registration Issues';
$casenumber_param="]";
$casenumber_strip = strpos($rawsubject,$casenumber_param);
$casenumber = substr($rawsubject,0,$casenumber_strip); 
```

目前的输出是：`RE: [#4152`

我需要剥离剩下的`[#`所有东西，所以我只剩下`4152`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T22:32:19.400

有几种方法可以做到这一点，但最好使用[正则表达式](http://www.regular-expressions.info/tutorial.html)。这个行为与您当前的代码完全一样：找到右方括号并隔离它之前的所有连续数字。

```
if (preg_match('/\d+(?=\])/', $rawsubject, $matches)) {
    $casenumber = $matches[0];
} 
```

您很可能更喜欢更直接的东西，例如“抓住方括号之间的数字”：

```
if (preg_match('/\[#(\d+)\]/', $rawsubject, $matches)) {
    $casenumber = $matches[1];
} 
```

**[看到它在行动](http://ideone.com/cKYTj)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:33:13.657

您当前代码的逻辑扩展只是做另一面：

```
$rawsubject = 'RE: [#4152] - Registration Issues';
$casenumber_start="#";
$casenumber_end="]";
$start = strpos($rawsubject,$casenumber_start)+1;
$end  = strpos($rawsubject,$casenumber_end);
$casenumber = substr($rawsubject,$start,$end-$start); 
```

但我会选择基于正则表达式的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T22:36:16.977

用 ltrim 剥离那些你需要这样写：

```
$rawsubject = ltrim($rawsubject, "RE:[# "); 
```

# php - 面向对象的PHP，从方法返回时数组为空

> ID：12206482
> 
> 赞同：0
> 
> 时间：2012-08-30T22:28:56.043
> 
> 标签：php, oop, scope

试图了解面向对象的 PHP。我有一个递归方法来返回评论及其回复并将它们编译成一个平面数组`$comments_list`。

```
<?php

class RedditPosts
{
    public function get_post_ids($from, $limit)
    {
        // GET POSTS
        $list = json_decode(file_get_contents("http://www.reddit.com/$from.json?limit=$limit"));
        sleep(2); //after every page request

        $post_ids = array();
        foreach($list->data->children as $post) {
            $post_ids[] = $post->data->id;
        }
        return $post_ids;
    }
}

class RedditComments
{
    static $comments_list = array();

    public function get_comments($post_id)
    {
        $comments_object = json_decode(file_get_contents("http://www.reddit.com/comments/$post_id.json"));
        sleep(2);

        $top_comments = $comments_object[1]->data->children;
        //var_dump($top_comments);
        self::get_sub_comments($top_comments);
    }

    static function get_sub_comments($root_comments)
    {
        foreach($root_comments as $comment)
        {
            self::$comments_list[] = $comment;
            //echo $comment->data->body . "<br/>"

            if ($comment->data->replies != '')
            {
                self::get_sub_comments($comment->data->replies->data->children);
            }
        }
        var_dump(self::$comments_list);
        return self::$comments_list;

    }
}

/******************************MAIN************************************/

$ps = new RedditPosts();
$my_posts = $ps->get_post_ids("r/learnprogramming", 2);

$cm = new RedditComments();
$my_comments = $cm->get_comments($my_posts[0]);
var_dump($my_comments);

?> 
```

我在返回它之前做了一个 var_dump 并且它被填充并且看起来正确但是当我在方法之外调用它时它是空的。可能是范围的问题，但我是新手，无法弄清楚我在哪里碰壁了。帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:31:52.417

您不会从`get_post_ids`. `self::get_sub_comments($top_comments);`应该是`self::get_sub_comments($top_comments);`？

# php - 将 CSS 元素应用于 PHP 动态数据

> ID：12206484
> 
> 赞同：-1
> 
> 时间：2012-08-30T22:29:06.250
> 
> 标签：php, css

我是将印刷和页面布局元素应用于动态数据的新手。

我用过这段代码 -`<p><?php echo preg_replace('/[\r\n]+/', '</p><p>', $row_rs_AZ_Products_Detail_pg['ItemLongDesc']); ?></p>`

插入下面从我的数据库生成的段落。段落完全分开，但我需要创建一个需要信息的列表格式或在段落中间编号。我被指示放置此代码 -

```
p {
    margin: 0 0 0.25em 0;
} 
```

进入页面，但我不知道该怎么做。任何人都可以帮助我或提出更好的建议吗？您的帮助将不胜感激。

数据输出：

```
Make someone special feel special with a Customized and Personalized full color Autograph Photo Football Sports Ball. Before clicking the Add to Cart button to place your order, please cut and past the INFORMATION NEEDED below into your email and email to tony@awardzone.net.

INFORMATION NEEDED:

TEXT ABOVE PHOTO - 1 Line Recommended [Type your text here]

CENTER PHOTO OR LOGO - (attach jpeg format image)

TEXT BELOW PHOTO - 1 Line Recommended [Type your text here]

TEAM COLORS - [Type your colors here]

YOUR CONTACT PHONE - [Type your text here]

YOUR EMAIL ADDRESS - [ [Type your text here]

(Optional) MASCOT NAME - [Type your text here]

And/or MASCOT LOGO (attach jpeg format image)

YOUR IN HAND DATE? - [Type your date here]

IMPORTANT - Your final layout proof will be approved by YOU before imprinting and shipment. *All personal information will remain confidential and will not be sold.

QUESTIONS? Email tony@awardzone.net or call Tony at 973-347-6819 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:40:49.173

这取决于您的数据的固定程度，但是根据您所展示的内容，我会：

*   在多个换行符上分解输入（使用 preg_split）以获得包含所有行的数组
*   从数组中删除前两个条目以用作前导段落并回显它们
*   从数组中删除最后两个条目以用作结尾段落
*   开始一个列表（`<ul>`或`<ol>`）
*   将剩余的数组作为列表项回显
*   关闭列表
*   呼出两个结尾段落

# design-patterns - 这是工厂方法吗？

> ID：12206488
> 
> 赞同：1
> 
> 时间：2012-08-30T22:29:24.483
> 
> 标签：design-patterns, factory-pattern

工厂模式由实现特定接口的类组成。它总是必须是一个接口吗？当我的子类继承自其他类而不是接口时，它仍然是工厂方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T22:33:39.240

[工厂方法模式](http://en.wikipedia.org/wiki/Factory_method_pattern)不一定与接口有任何关系（就语言的*关键字*或`interface`构造而言）。您可以拥有创建类实例的工厂方法，并且可以像使用接口一样轻松地构造子类而不是基类。

例如，请参阅[此 Wikipedia 示例](http://en.wikipedia.org/wiki/Factory_method_pattern#Java_2)。在这里，`Room`创建了 a，主类型的子类创建了不同的具体类型的`Room`实例。这仍然使用工厂方法模式，即使没有涉及“接口”。

> 我的问题是，如果我用父类“替换”接口，它仍然是工厂方法吗？

是的 - 它仍然是一种工厂方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:33:57.930

这不是那个意思。交互上下文中的接口，控制（创建）而不是 Java 的`interface`

# javascript - document.getElementById('id') 或 $('#id') 仍然需要按 ID 选择元素吗？

> ID：12206490
> 
> 赞同：6
> 
> 时间：2012-08-30T22:29:47.340
> 
> 标签：javascript, html, dom

我今天遇到了这个[要点](https://gist.github.com/2992949)，作者在评论中提到

```
var log = document.getElementById('log'); 
```

是不必要的，因为在 Javascript 中您可以只使用它`log`来访问 DOM 元素。在所有浏览器中都是这样吗？这种技术有名称/参考吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T22:33:58.663

在 Internet Explorer 下，ID 将成为全局变量，并可通过该名称在任何地方访问。

我认为这种“错误特征”是一件坏事。

我不记得它的所有特征和方面，我尽我所能试着假装它从未发生过。

简而言之：仅限 IE 的“功能”——最好忽略。阅读[这篇文章](http://blogs.msdn.com/b/alvar/archive/2009/10/22/internet-explorer-creates-global-variables-for-each-object-in-the-dom.aspx)了解更多详情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-14T23:56:45.583

令人惊讶的是，这实际上是在 HTML5 规范中，所以是的，它会起作用，不，它不是建议的遗留功能（至少现在 - 它曾经是 IE 唯一的技巧）。

您可以在此处阅读规范， [http://www.whatwg.org/specs/web-apps/current-work/#named-access-on-the-window-object](http://www.whatwg.org/specs/web-apps/current-work/#named-access-on-the-window-object)

我同意它实际上使命名空间变得混乱，并且冒昧地建议不要使用它 - 但它会并且确实适用于每个主要浏览器！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T22:44:54.477

这是一个可疑的“功能”，不应该用于任何事情。它引入了全局状态和全局范围的变量，这是在任何应用程序中要避免的要点之一，更重要的是，它似乎只适用于 Internet Explorer 和某些版本的 Chrome。几乎可以肯定它的性能会降低，因为浏览器不仅必须访问 DOM，而且还必须查找`log`预先命名的变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-30T22:32:48.467

对于现代浏览器的新版本，它可能会工作，但旧版本不能很好地处理它。如果您希望您的网站在旧版浏览器中运行，请使用 document.getElementById。

# html - html5 indexeddb 的 UML

> ID：12206491
> 
> 赞同：1
> 
> 时间：2012-08-30T22:29:51.417
> 
> 标签：html, uml, indexeddb

我想知道这是否是 indexeddb 的正确 UML：

**DB** 1 <-- 0..***对象存储**1 <-- 0..***对象存储中的一个对象**

用人物画这个很难，但我希望你能明白。数据库中的每个对象存储都可以包含 0 个或多个对象。

参考：[http ://www.w3.org/TR/IndexedDB/#introduction](http://www.w3.org/TR/IndexedDB/#introduction)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T12:53:34.943

是的，这是正确的对象模型。一个 DB 可以有 0 个或多个对象存储，并且相同的关系适用于对象存储中的对象之间。

# python - 在 shell 脚本中解析标准输出

> ID：12206503
> 
> 赞同：0
> 
> 时间：2012-08-30T22:31:10.950
> 
> 标签：python, shell, stdout

继续我最初的问题：

[从 python 程序获取输入的 shell 脚本](https://stackoverflow.com/questions/12204857/shell-script-taking-input-from-python-program)

所以我的 python 程序的标准输出存储在我的 shell 脚本中的一个变量中。现在，我必须解析这个输出，以便获取最后 22 个字符的子字符串。这些是唯一对我重要的。不幸的是，没有办法真正识别这些最后的字符（“keyword=”等），这意味着我必须完全按照它们的位置来做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:37:42.563

如果需要字符串的最后 N 个字符，可以使用简单的切片：

```
>>> v="this is the stdout from my shell command stored in a variable"
>>> v[-22:]
'd stored in a variable' 
```

返回最后 22 个字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:38:49.937

假设您正在使用`bash`，您可以使用子字符串扩展：

```
key=$(python ...)   # From  your previous question

suffix=${key: -22}  # The space between : and - is important 
```

# javascript - 进度条平滑填充徽标（jQuery）

> ID：12206504
> 
> 赞同：0
> 
> 时间：2012-08-30T22:31:12.550
> 
> 标签：javascript, jquery, flash

我有一个页面询问用户填写表格的信息。当他们提交时，我会将他们带到一个显示“正在计算您的结果...”的屏幕。

我想要一个在 10 秒左右从 0-100% 流畅加载的进度条。更重要的是，我希望进度条是我的标志的灰色版本（标志是纯文本，但非网络文本），它像进度条一样慢慢填充颜色，达到 100%。

有没有办法在 jQuery 中做到这一点？还是我必须在 Flash 中制作一些东西？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:47:12.087

另一种方法是使用新`<progress></progress>`标签并使用 CSS 将您的徽标放在背景中。这是在 Firefox 中对其进行样式设置的快速概述，我相信现在有更多信息，因为它已经有一年多了：

[http://blog.oldworld.fr/index.php?post/2011/07/The-HTML5-progress-element-in-Firefox](http://blog.oldworld.fr/index.php?post/2011/07/The-HTML5-progress-element-in-Firefox)

# c++ - C++、Allegro、Ubuntu 和 libpng/LoadPNG

> ID：12206507
> 
> 赞同：0
> 
> 时间：2012-08-30T22:31:25.513
> 
> 标签：c++, ubuntu, libpng, allegro

我已经四处寻找了很长一段时间，但我还没有找到回答我问题的来源。我想在 Allegro 中使用 PNG。我知道 Allegro 的 libpng 和 loadpng，但我不知道如何处理这些。显然，我对此很陌生。谁能向我解释如何下载这些资源，将它们放在哪里，如何链接到它们，以及可能如何使用它们。我想一旦一切就绪，我应该能够弄清楚如何使用它们。我正在使用 g++、Ubuntu 12.04、Allegro 4.2.2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:38:18.910

如果您在 ubuntu 上，您正在查看用于 libpng 的 libpng12-dev 或 libpng++-dev 库以及用于 allegro 的 liballegro4.2-dev 包。然后只需使用 pkg-config 进行实际编译： g++ alleg.cpp -o alleg`pkg-config --cflags --libs allegro`

我还看到使用了一个名为 allegro-config 的程序，但我不熟悉它的操作。

# javascript - 如何从参数数组中调用回调？

> ID：12206518
> 
> 赞同：0
> 
> 时间：2012-08-30T22:32:12.010
> 
> 标签：javascript, callback, arguments

我了解如何正常调用回调，但是当我尝试使用参数数组调用回调时，它不起作用。这是正常情况的代码：

```
function someFunc(parameter1, callback){
  alert(parameter1);
  callback.call();
}

someFunc('Hello', function(){
  alert('World!');
}); 
```

并且使用参数数组的完全相同的格式，这是行不通的。

```
function someFunc(parameter1){
  alert(parameter1);
  arguments[arguments.length-1].call();
}

someFunc('Hello', function(){
  alert('World!');
}); 
```

这里发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:42:21.817

您的代码没有任何错误，应该可以自己正常工作。这个例子表明它运行良好。-- [http://jsfiddle.net/FDT8N/](http://jsfiddle.net/FDT8N/)

# .htaccess - 将 PHP 重定向到 HTML，但让 HTML 指向 PHP

> ID：12206525
> 
> 赞同：1
> 
> 时间：2012-08-30T22:33:03.290
> 
> 标签：.htaccess

考虑以下规则

```
RewriteRule ^index\.html$ index.php [L]
RewriteRule ^index\.php$ index.html [R=301] 
```

我想`.html`使用该`.php`文件，但我希望 url`.html`始终具有扩展名。

上面的规则创建了一个重定向循环。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:40:15.677

您可以检查实际请求，也可以完全防止循环。

1.  选项 1，检查请求：

    ```
    RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /index\.php
    RewriteRule ^index\.php$ index.html [R=301] 
    ```

    这使得如果实际请求不是`index.php`，重定向将不会发生。

2.  选项 2，防止重写引擎完全循环。将此添加到 htaccess 文件的顶部：

    ```
    RewriteCond %{ENV:REDIRECT_STATUS} 200
    RewriteRule ^ - [L] 
    ```

    这样做的缺点是您可能有真正想要循环的规则。

# sql-server - 引用列上的 SQL Server 约束

> ID：12206532
> 
> 赞同：1
> 
> 时间：2012-08-30T22:33:54.933
> 
> 标签：sql-server

我有一个看起来像这样的表：

```
CREATE TABLE A (
  A_UNIQUE_ID int NOT NULL PRIMARY KEY,
  A_OTHER_ID int NOT NULL,
  A_CURRENT_FL bit NOT NULL ) 
```

它具有与此类似的值

```
INSERT INTO TABLE A VALUES (1, 1, 0);
INSERT INTO TABLE A VALUES (2, 1, 0);
INSERT INTO TABLE A VALUES (3, 1, 1); 
```

我想像这样创建另一个表 B

```
CREATE TABLE B (
  B_UNIQUE_ID int NOT NULL PRIMARY KEY,
  A_OTHER_ID int NOT NULL) 
```

where`B.A_OTHER_ID`被限制为 A 中的唯一行。所以`B.A_OTHER_ID = A.A_OTHER_ID AND A.CURRENT_FL = 1`. 这可能与某种类型的检查约束设置吗？非常感谢示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T07:39:41.463

好的开始，您需要对表 A 进行约束以使其独一无二，如上所述。使用这个[答案](https://stackoverflow.com/a/866100/345659)，您可以创建一个函数并在新的检查约束中调用它。例如：

```
CREATE FUNCTION Check_A_CURRENT_FL_Count(@Id INT) RETURNS INT AS 
BEGIN
  DECLARE @ret INT;
  SELECT @ret = COUNT(*) FROM A WHERE A_OTHER_ID = @Id AND A_CURRENT_FL = 1;
  RETURN @ret;
END
GO

alter table A add constraint [CK_A] CHECK (NOT (dbo.Check_A_CURRENT_FL_Count(A_OTHER_ID) > 1 AND A_CURRENT_FL = 1))
GO 
```

然后，如果我正确理解了您想要的内容-您可以在表 B 的检查约束中使用相同的函数。虽然显然您使用的是人为的示例，但不完全确定这样做的目的是什么。如果您想要表 A 中的唯一 ID 列表 - 您可以使用 A_OTHER_ID 作为表 B 中的主键，并去掉 B_UNIQUE_ID？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T07:46:46.213

您可以使用一些计算列来做到这一点，但它看起来不是很漂亮：

```
CREATE TABLE A (
  A_UNIQUE_ID int NOT NULL PRIMARY KEY,
  A_OTHER_ID int NOT NULL,
  A_CURRENT_FL bit NOT NULL,
  OTHER_XREF as CASE WHEN A_CURRENT_FL = 1 THEN A_OTHER_ID END persisted,
  UNIQ as CASE WHEN A_CURRENT_FL = 0 THEN A_UNIQUE_ID ELSE 0 END persisted 
  constraint UQ_OTHER_XREF UNIQUE (OTHER_XREF,UNIQ)
  )

INSERT INTO A VALUES (1, 1, 0);
INSERT INTO A VALUES (2, 1, 0);
INSERT INTO A VALUES (3, 1, 1);

CREATE TABLE B (
  B_UNIQUE_ID int NOT NULL PRIMARY KEY,
  A_OTHER_ID int NOT NULL,
  XREF as 0 persisted,
  constraint FK_B_A FOREIGN KEY (A_OTHER_ID,XREF) references A (OTHER_XREF,UNIQ)) 
```

这有效：

```
 insert into B VALUES (2,1) 
```

这打破了 FK 约束：

```
 insert into B VALUES (3,2) 
```

表 A 中的两个计算列确保任何带有`A_CURRENT_FL`=`1`的行在`OTHER_XREF`. 其他行将`NULL`在该列中。然而，为了应用一个`UNIQUE`约束（外键的目标），我们需要一个对于带有 a 的每一行都明显不同的东西，同时对于带有=`NULL`的行来说是一个众所周知的值。在这种情况下，我制作了众所周知的 value 。`A_CURRENT_FL``1``0`

最后，外键约束需要匹配*这两个*列，所以我们在表 B 中添加一个新的计算列，该列具有众所周知的值`0`。

列名不是特别好，但我相信你能想出一些。

* * *

Note, also, that by the above, we've also implemented another constraint that you didn't mention, but that also may be important - there can't be two rows now in table A that both have `A_CURRENT_FL` set to 1, for the same `A_OTHER_ID` value. This also generates an error:

```
INSERT INTO A VALUES (4,1,1); 
```

# php - 将 php assoc 数组键和值传递给 MySql SELECT 语句

> ID：12206536
> 
> 赞同：3
> 
> 时间：2012-08-30T22:33:59.307
> 
> 标签：php, mysql, sql, select, rows

我正在使用 php + mysql，我在 DB 中有这样的表：

```
col1-col2-col3
A - val1 - str1
A - val2 - str2
A - val3 - str3
B - val4 - str4
B - val5 - str5
... 
```

还有 php 中的 assoc 数组：

```
$arr = array('A'=>'value1','B'=>'value2', ...); 
```

然后我在 MySql 字符串中的占位符中传递这个数组来制作完整的 SELECT 语句。

如何选择第 1 列的值等于数组的键和第 2 列的值分别小于数组值的第 3 列值？也许以某种方式使用带有两个选择的 GROUP 并将它们连接在一起......

结果应该只是满足要求的所有第 3 列值的列表。

它可以使用这样的东西来完成：

```
$aReturn = array();
$sql = "SELECT col3 FROM MyTab WHERE col1 = ? AND col2 < ?d";
foreach ($arr as $k=>$v) {
    $aReturn = array_merge($aReturn, $this->select($sql, $k, $v));
} 
```

其中 select 是对 DB 进行选择并返回值列表中最后一列的值的方法，然后我们将列表添加到结果 $aReturn。但是在这种情况下它会查询几次，但是有没有办法只在**一个**SELECT 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T23:23:09.653

我认为这不能用占位符来完成，因为查询的结构不是固定的——WHERE 子句中需要的条件与数组中的元素一样多。这是未经测试的代码：

更新：使用准备好的语句

```
$wheres = array();
$types = '';
$col1s = array();
$params = array(null, null);
$i = 0;
foreach ($assoc as $key => $val) {
  $wheres[] = '(col1 = ? AND col2 < ?)';
  $types .= 'ss';
  $col1s[$i] = $key;
  $params[] = &$col1s[$i];
  $params[] = &$assoc[$key];
  $i++;
}
$whereclause = implode(' OR ', $wheres);
$sql = "SELECT * FROM my_table WHERE $whereclause";
$stmt = mysqli_prepare($link, $sql);
$params[0] = $stmt;
$params[1] = $types;
call_user_func_array('mysqli_stmt_bind_params', $params);
mysqli_stmt_execute($stmt); 
```

# android - 创建一个额外的表或创建一个新的数据库

> ID：12206539
> 
> 赞同：0
> 
> 时间：2012-08-30T22:34:31.130
> 
> 标签：android, android-contentprovider, android-sqlite

我可以选择创建一个新的 SqLite 数据库，或者将另一个表添加到通过内容提供程序评估的现有数据库中。

在 1) CPU 使用率 2) 内存 3) 处理时间 4) 编程最佳实践方面，哪个选择更好？

我重新阅读了这个问题的常见问题解答，并相信这个问题属于这里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:37:17.867

如果您的新表数据与您已有的所有其他数据在逻辑上连接，那么下一个表看起来是正确的选择。至于您要考虑的“优化”方面 - 不要。这是相当无关紧要的。

# javascript - Javascript从数组中选择随机并按字母顺序排列

> ID：12206543
> 
> 赞同：0
> 
> 时间：2012-08-30T22:34:40.850
> 
> 标签：javascript, sorting

我正在尝试编写一个脚本，从对象列表中随机选择三个项目，按一个字段将它们按字母顺序排列，然后显示另一个字段的字母顺序值。到目前为止，我可以让它随机选择项目并显示它们，但它仍然没有排序。这是我的代码：

```
function random_text() {};
var random_text = new random_text();
var number = 0;
random_text[number++] = {
    show: "Bob",
    sort: "A"
}
random_text[number++] = {
    show: "Casey",
    sort: "B"
}
random_text[number++] = {
    show: "Dan",
    sort: "C"
}
random_text[number++] = {
    show: "Alfred",
    sort: "D"
}

var random_number = Math.floor(Math.random() * number);
var random_number1 = Math.floor(Math.random() * number);
var random_number2 = Math.floor(Math.random() * number);

if (random_number !== random_number1) {
    var name1 = random_text[random_number1].show;
} else {
    var name1 = "";
}

if (random_number !== random_number2 && random_number1 !== random_number2) {
    var name2 = random_text[random_number2].show;
} else {
    var name2 = "";
}

var name3 = random_text[random_number].show;

var objs = [name1 + " " + name2 + " " + name3];

objs.sort(function (a, b) {
    var nameA = a.sort.toLowerCase(),
        nameB = b.sort.toLowerCase()
        if (nameA < nameB) //sort string ascending
    return -1
    if (nameA > nameB) return 1
    return 0 //default return value (no sorting)
})

document.write(objs.sort()); 
```

在此先感谢您的帮助。如果有任何方法可以清理代码，我也很感激这方面的提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T23:12:48.613

见[http://jsfiddle.net/Nc2Je/](http://jsfiddle.net/Nc2Je/)

```
var random_text = [
    {
        show: "Bob",
        sort: "A"
    },
    {
        show: "Casey",
        sort: "B"
    },
    {
        show: "Dan",
        sort: "C"
    },
    {
        show: "Alfred",
        sort: "D"
    }
],random_numbers = new Array(),
    objs=new Array();
for(var i=0;i<3;i++){
    function random(){
        var n=Math.floor(Math.random() * random_text.length);
        if(random_numbers.indexOf(n)===-1){return n;}
        return random();
    }
    random_numbers.push(random());
    objs.push(random_text[random_numbers[i]])
}
var alphabetized=new Array();
outerloop:
for(var i=0;i<objs.length;i++){
    for(var j=0;j<alphabetized.length;j++){
        if(alphabetized[j].sort>objs[i].sort){
            alphabetized.splice(j,0,objs[i]);
            continue outerloop;
        }
    }
    alphabetized.push(objs[i]);
}
alphabetized.getNames=function () {
    var arr=new Array();
    for(var i=0;i<this.length;i++){
        arr.push(this[i].show);
    }
    return arr;
}

document.write(alphabetized.getNames()); 
```

**编辑：**

你做了一些奇怪的事情：

1-为什么要创建一个空函数，然后用它自己的实例覆盖它？

```
function random_text() {};
var random_text = new random_text(); 
```

2-如果您想要一个像数组一样工作的对象，为什么不使用数组而不是将类似数组的属性设置为`random_text`？

```
var number = 0;
random_text[number++] = {
    show: "Bob",
    sort: "A"
}
random_text[number++] = {
    show: "Casey",
    sort: "B"
}
random_text[number++] = {
    show: "Dan",
    sort: "C"
}
random_text[number++] = {
    show: "Alfred",
    sort: "D"
} 
```

3-您应该使用数组`random_numbers`而不是那些变量：

```
var random_number = Math.floor(Math.random() * number);
var random_number1 = Math.floor(Math.random() * number);
var random_number2 = Math.floor(Math.random() * number); 
```

4- 而不是那些奇怪的检查，你应该确保你的随机数与以前的随机数不同。用你的支票，可能三个随机数是一样的，所以你只有一个名字。

```
if (random_number !== random_number1) {
    var name1 = random_text[random_number1].show;
} else {
    var name1 = "";
}

if (random_number !== random_number2 && random_number1 !== random_number2) {
    var name2 = random_text[random_number2].show;
} else {
    var name2 = "";
}

var name3 = random_text[random_number].show; 
```

5- 为什么要创建一个只有一个元素（字符串）的数组？

```
var objs = [name1 + " " + name2 + " " + name3]; 
```

6-我没有使用您的以下代码，因为我从未使用过，所以我编写了自己的排序函数。

```
objs.sort(function (a, b) {
    var nameA = a.sort.toLowerCase(),
        nameB = b.sort.toLowerCase()
        if (nameA < nameB) //sort string ascending
    return -1
    if (nameA > nameB) return 1
    return 0 //default return value (no sorting)
}) 
```

7- 对对象进行排序后，如果要编写它们，则应不`document.write(objs)`使用`sort()`.

**编辑2：**

`alphabetized.getNames`返回一个数组。

这样你就可以做到

```
var names=alphabetized.getNames();
names.length;
names[0];
... 
```

如果你想要一个字符串，你可以做`alphabetized.getNames().join(" ");`

# javascript - clearInterval / setInterval

> ID：12206544
> 
> 赞同：2
> 
> 时间：2012-08-30T22:34:45.390
> 
> 标签：javascript, clearinterval

我正在使用以下脚本将 jpg 图像显示为动画：

```
var interval;

function Play() {
  setInterval(Playimages, 100);
}

function Stop() {
  alert("stop");

  clearInterval(interval);
}

function Playimages() {
  i = (i < sl - 1) ? (i + 1) : 0;

  $('#Image1').attr('src', images[i].src);
} 
```

播放效果很好，但我无法停止或暂停；我的 clearInterval 有错误。将不胜感激您的建议。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-30T22:36:02.327

您永远不会将*间隔 id*分配给`interval`. 应该

```
interval = setInterval(Playimages, 100); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-30T22:36:19.450

你需要改变

```
 setInterval(Playimages, 100); 
```

至

```
interval = setInterval(Playimages, 100); 
```

`setInterval`返回一个可与 . 一起使用的 id `clearInterval`。在你的代码`interval`中可能是未定义的，所以`clearInterval`什么都不做，因为它没有引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T22:36:33.443

您需要将间隔 id 分配给`interval`.

```
var interval;

function Play() {
  interval = setInterval(Playimages, 100);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-30T22:38:47.213

您必须在 setInterval 中分配区间变量

```
interval = setInterval(Playimages, 100);
clearInterval(interval); 
```

# jquery - 使用边距的 JQuery 动画

> ID：12206545
> 
> 赞同：1
> 
> 时间：2012-08-30T22:34:45.097
> 
> 标签：jquery, jquery-animate, margin, mouseleave

我所拥有的正在工作，但我想看看是否有更好的方法来编写代码，而且我在 mouseleave 上也遇到了延迟。实际动画以所需的速度发生，但在我的鼠标离开后，它似乎需要大约 2-3 秒才能执行任何操作。

CSS 最初设置为 margin-left:-64px

```
$('.homeButton').mouseover(function(){
  $('.homeButton').animate({marginLeft:'0px'},'slow');  
});

$('.homeButton').mouseleave(function(){
   $('.homeButton').animate({marginLeft:'-64px'},200);  
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:36:56.690

你可以使用`stop`和`hover`方法。

> 停止匹配元素上当前正在运行的动画。

```
$('.homeButton').hover(function(){
     $(this).stop(true, true).animate({marginLeft:'0px'},'slow');  
}, function(){
     $(this).stop(true, true).animate({marginLeft:'64px'},'slow');  
}) 
```

# php - 正确的 PHP 和 HTML 编码以直接形成依赖 URL

> ID：12206550
> 
> 赞同：0
> 
> 时间：2012-08-30T22:35:03.367
> 
> 标签：php, variables, url-redirection

好的，我的页面上有一个表单，人们可以在其中输入特定数据。然后我希望将该数据带到我服务器上的 php 页面，该页面获取表单数据并将其附加到 url，但要么在新窗口中执行该功能（我更喜欢隐藏 url，但不是必需的）或执行不指向 url 的操作（即 url 已打开但不会出现在用户面前）

例如说我在表单中有 5 个字段，所以基本 url 是 example.com/ 并且我希望在输入字段后直接到 example.com/field1&field2&field3&field4&field5

我已经能够使用 getelement 代码执行操作，但它会在同一个窗口中打开，并在返回时清除表单。我希望表单保持不变，以便他们可以重新输入新信息并继续执行 url 操作。

到目前为止，这就是我想出的我正在寻找的东西，但它不会执行我遇到服务器问题的操作。

形式：

```
<form method="post" action="http://gamerzacademy.com/trsrequest.php" target="blank">
<input type="text" name="ids" />
<input type="hidden" name="tab_clicked" value="Cafe" />
<input type="hidden" name="request_id" value="100172873469866" />
<input type="text" name="signed_request" />    <
<select name="gid" name="gid">
<option value="8631">Drums    </option>
<option value="8632">Guitar Strings    </option>
<option value="8633">Drumsticks    </option>
<option value="8634">Guitar Straps    </option>
<option value="8635">Microphones    </option>
<option value="8636">Speakers    </option>
<option value="8637">Handle Bar    </option>
<option value="8638">Spark Plug    </option>
<option value="8639">Leather Seat    </option>
<option value="8640">Motor Oil    </option>
<option value="8641">Metallic Paint    </option>
<option value="8642">Welding Torch     </option>
</select>
<input type="hidden" name="today" value="1" />
<input type="hidden" name="time" value="1345953369" />
<input type="hidden" name="ref" value="gift_today" />
<input type="hidden" name="cafe_token" value="OAlF7gSlMbQxAtBhvnprTyCLwuJFvNnvHwDcqeIrZ2YIofJzlyiZ2%2FVvflh2ih24wK1TsWdSyBH0xR205Q9+WwR%2F6ckIv4ozN4YdVvvWP2NmFlq95685hw%3D%3D" />

..... more fields .....

</form> 
```

PHP

```
<?php
header("Location: http://fb-0.cafe.zynga.com/current/iframe//mfs_sent.php?'.'$_GET['ids'].'.'$_GET['tab_clicked'].'.'$_GET['request_id'].'.'$_GET['signed_request'].'.'$_GET['gid'].'.'$_GET['today'].'.'$_GET['time'].'.'$_GET['ref'].'.'$_GET['cafe_token'].'.'$_GET['from_page'].'.'$_GET['kingdom'].'.'$_GET['phylum'].'.'$_GET['uid'].'.'$_GET['sendkey'].'.'$_GET['mode'].'.'$_GET['trs_key'].'.'$_GET['stage'].'.'$_GET['mfs_time'].'.'$_GET['snood'].'.'$_GET['hash'].'.'$_GET['limiter_channel'].'.'$_GET['limiter_type'].'.'$_GET['ajax'].';"
?> 
```

但是我收到此错误：

> 解析错误：语法错误，意外的 T_ENCAPSED_AND_WHITESPACE，在第 2 行的 /home/content/15/9484115/html/trsrequest.php 中需要 T_STRING 或 T_VARIABLE 或 T_NUM_STRING

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:42:16.503

您的标头函数应如下所示：

```
<?php
header("Location: http://fb-0.cafe.zynga.com/current/iframe//mfs_sent.php?".
urlencode($_POST['ids'])."&".
urlencode($_POST['tab_clicked'])."&".
urlencode($_POST['request_id'])."&".
urlencode($_POST['signed_request'])."&".
urlencode($_POST['gid'])."&".
urlencode($_POST['today'])."&".
urlencode($_POST['time'])."&".
urlencode($_POST['ref'])."&".
urlencode($_POST['cafe_token'])."&".
urlencode($_POST['from_page'])."&".
urlencode($_POST['kingdom'])."&".
urlencode($_POST['phylum'])."&".
urlencode($_POST['uid'])."&".
urlencode($_POST['sendkey'])."&".
urlencode($_POST['mode'])."&".
urlencode($_POST['trs_key'])."&".
urlencode($_POST['stage'])."&".
urlencode($_POST['mfs_time'])."&".
urlencode($_POST['snood'])."&".
urlencode($_POST['hash'])."&".
urlencode($_POST['limiter_channel'])."&".
urlencode($_POST['limiter_type'])."&".
urlencode($_POST['ajax']));
?> 
```

或者你可以这样做：

```
<?
$urlArgs = http_build_query($_POST);
header("Location: http://fb-0.cafe.zynga.com/current/iframe//mfs_sent.php?".$urlArgs);
?> 
```

请注意，这会创建一个参数字符串，但它是键值对。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:40:26.863

您在双引号中使用字符串`"`，但在连接时使用单引号`'`。

# objective-c - sqlite sum() 到 nsinteger

> ID：12206551
> 
> 赞同：1
> 
> 时间：2012-08-30T22:35:04.953
> 
> 标签：objective-c, xcode, fmdb, nsinteger

我想构建一个函数，它获取名为小时的列中所有行的总和。然后它应该返回一个整数值，我将用它与另一个数字相乘。

```
-(NSInteger)calculateTotal{

FMDatabase *dbHandler = [FMDatabase databaseWithPath:[Utility getDatabasePath]];

[dbHander open];

FMResultSet *results = [dbHandler executeQuery:@"SELECT SUM(hours) FROM inputs"];

NSInteger totalHours;
while ([results next]) {
    totalHours = [results intForColumn:@"hours"];
}

return totalHours;
} 
```

但它不起作用，它返回 0，并带有警告说没有名为“小时”的列

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T01:09:29.390

我认为大多数数据库引擎会在最外面的聚合函数之后命名查询结果中的列 - `SUM`。

尝试将您的查询更改为`SELECT SUM(hours) AS hours FROM inputs`. （或者，如果你正在查询 Oracle，你这个倒霉的人，查询没有`AS`.）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T05:46:09.883

以下代码将起作用：

```
-(NSInteger)calculateTotal
{
  FMDatabase *dbHandler = [FMDatabase databaseWithPath:[Utility getDatabasePath]];

  if(![dbHander open])
  {
        NSLog(@"Could not open DB, try again");
        return -1; //return some value that tells you that there was an error
  }

  FMResultSet *results = [dbHandler executeQuery:@"SELECT SUM(hours) AS sum_hours FROM inputs"];

  NSInteger totalHours = -1;
  while ([results next]) {
      totalHours = [results intForColumn:@"sum_hours"];
  }

  [results close];
  [dbHandler close];
  return totalHours;
} 
```

# apache - 将 Apache 重写规则转换为 nginx 配置文件

> ID：12206560
> 
> 赞同：1
> 
> 时间：2012-08-30T22:36:15.073
> 
> 标签：apache, .htaccess, nginx, rewrite

我有一个非常简单的`.htaccess`文件，我需要将其转换为 nginx 配置：

```
RewriteRule ^api$ api.php [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . index.php [L] 
```

我试着做一个开始：

```
location / {
    rewrite ^(.*)$ /index.php;
} 
```

但是每当我加载网页的基本 URL 时，我的浏览器只会下载 index.php 文件。我的配置中也有这个：

```
location ~ \.php$ {
    fastcgi_split_path_info ^(.+\.php)(/.+)$;
    fastcgi_pass unix:/var/run/php5-fpm.sock;
    fastcgi_index index.php;
    include fastcgi_params;
} 
```

但由于某种原因，nginx 仍然将其作为下载传递。这里的正确配置是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T09:29:42.253

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . index.php [L] 
```

前 3 个您将使用 try_files 而不是在 nginx 中重写（有关该指令的详细信息，请参见[http://nginx.org/en/docs/http/ngx_http_core_module.html#try_files ）：](http://nginx.org/en/docs/http/ngx_http_core_module.html#try_files)

```
location / {
  try_files $uri $uri/ $uri/index.php$args;
}

location = /api {
  rewrite ^ /api.php$args
} 
```

# mysql - 用于 Android 的 SQL Server 或 MYSQL？

> ID：12206562
> 
> 赞同：1
> 
> 时间：2012-08-30T22:36:16.773
> 
> 标签：mysql, sql-server, json

我将在接下来的几天内为托管的 sql 数据库付费。我将使用它来存储数据并与 Android 应用程序交互。使用 phpmyadmin、PHP 后端以及使用 JSON 解析和发送 htttp 帖子是否对 MySQL 有更多支持？还是有更好（更容易/更简单）的方式来使用 SQL Server？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T23:40:56.243

如果 Android 设备正在向服务发送 json http 流量，那么对于“Android”您选择哪个后端数据库都没有关系

这更多的是关于您存储的数据类型以及您对这些系统的舒适度的问题。如果你有一个合适的接口，你也可以在不影响设备的情况下无缝地换掉它。

真正的问题是您是使用 sql（原子事务/关系存储等）还是“无 sql”数据库（最终一致 - hadoop、mongodb、couchdb、S3）。不要忘记混合是一个有效的选项，具体取决于您的数据需求。

对您的数据进行的比较和分析可能超出了 SO 帖子的范围，但有很多内容可以讨论每种方法的优缺点。

另一条建议 - 如果您为数据存储付费并为一些前端服务器付费，请尽可能将它们放在相同的地理位置或相同的数据中心。出于这个原因，有时最好从同一个云供应商（Azure、Amazon 等）获得两者——更不用说方便的计费了。

# architecture - 依赖注入解决方案架构

> ID：12206567
> 
> 赞同：1
> 
> 时间：2012-08-30T22:36:38.037
> 
> 标签：architecture, dependency-injection

在将我的解决方案的不同层抽象为单独的项目（例如 DataAccess、BusinessLogic、ApplicationService、UserInterface (ASP.NET MVC)）并强制上层仅引用下一层以确保没有来自上层的调用可以规避之后在这个架构中，我尝试将构造函数注入（使用 Unity）引入到我当前的项目中。

我并不像我想象的那样对结果感到高兴，并希望有更好的方法。

在我的 UI 层的 Global.asax 中，我不喜欢这种方式，为了构建容器，我必须引用从每一层一直到数据访问存储库的每一个项目。这只是感觉不对，因为现在可以轻松绕过多层设计。

你采取什么方法来避免这种情况？您是否为依赖注入创建了一个单独的项目并让该项目引用所有内容？那么UI层只需要引用依赖注入项目吗？

有没有更好的方法来实现这一点？

提前感谢您的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T05:44:20.483

> 这只是感觉不对，因为现在可以轻松绕过多层设计

好。你总是可以绕过它。您还可以破解您的代码（或任何其他可以访问它的程序员）。您可以引入错误。您可以跳过层并直接在 UI 层中使用 EF。

但你不会，因为这是不好的做法。

但是，您可以使用反射跳过这些引用（在运行时加载程序集）。这样做的问题是其他程序集不会自动包含在安装项目中或发布项目时。

如果这不是问题并且您想自动完成所有操作：使用我的容器。它让您在每个项目中都有一个组合根。然后只需在 UI 层执行此操作即可加载所有其他程序集：

```
public void Application_Start(string[] args)
{
    var registrar = new ContainerRegistrar();

    // will load all modules from all assemblies which starts with "MyApp."
    registrar.RegisterModules(Environment.CurrentDirectory, "MyApp.*.dll");

    var container = registrar.Build();
} 
```

更详细的解释：

[http://www.codeproject.com/Articles/440665/Having-fun-with-Griffin-Container](http://www.codeproject.com/Articles/440665/Having-fun-with-Griffin-Container)

# c# - 如何从 DataTable 更新 SQL，而不在 DataAdaper 初始化中选择查询

> ID：12206568
> 
> 赞同：0
> 
> 时间：2012-08-30T22:36:40.393
> 
> 标签：c#, datatable, sql-update, dataadapter, sqldataadapter

我有应用程序，它将数据从 CSV 加载到 DataTable，并从这个填充的 DataTable 将数据插入到 MS SQL。

我发现了一些注意如何进行更新，但我正在寻找如何避免在初始化 DataAdapter 时选择：

```
conn_update.Open();

string sql_q = "@"SELECT * FROM [publicDB].[dbo].[customers]"

SqlDataAdapter SQLUpdateAdapter = new SqlDataAdapter(sql_q, conn_update);

cmdBuilder = new SqlCommandBuilder(SQLUpdateAdapter);

cmdBuilder.GetUpdateCommand();

 SQLUpdateAdapter.Update(treti); 
```

第一个问题：

在初始化 SQL DataAdapter 时，有什么方法可以在不使用 Select Command 的情况下进行此更新？

由此

> SqlDataAdapter SQLUpdateAdapter = new SqlDataAdapter( **sql_q** , conn_update);

对于这样的事情（例如，对于我想找到的解决方案）

```
 SqlDataAdapter SQLUpdateAdapter = new SqlDataAdapter(conn_update); 
```

或者另一种方式如何避免无意义的选择表格数据库？

第二个（愚蠢的）问题：使用 SqlCommandBuilder 的目的是什么：

```
cmdBuilder = new SqlCommandBuilder(SQLUpdateAdapter);

cmdBuilder.GetUpdateCommand(); 
```

非常感谢您的回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T23:04:19.800

对于问题 #2：

`SqlCommandBuilder`自动生成 TSQL 查询以更新与您的数据集相关的单个表。这是必要的，因为`SqlDataAdapter`没有生成`DataSet`与 SQL Server 实例之间的更改匹配的查询。`SqlCommandBuilder`还将自己注册为`RowUpdating`事件的侦听器。

# javascript - 多个 javascript 远程处理功能完成时的功能/事件

> ID：12206569
> 
> 赞同：0
> 
> 时间：2012-08-30T22:36:53.403
> 
> 标签：javascript, ajax, asynchronous, salesforce, remoting

我正在开发基于 SalesForce 构建的 HTML5 移动 Web 应用程序。我们大量使用 JavaScript Remoting 函数，我想知道一种方法来等待 N（多个）这些远程函数调用完成，然后触发另一个事件或函数调用。我们试图完成的用例如下：

1.  使用 $.mobile.showPageLoadingMsg() 显示 jQuery Spinner/Loader；
2.  调用远程函数 1、2、3、...、N。
3.  等待远程功能 1、2、3、...、N 返回，但不要冻结浏览器。
4.  使用 $.mobile.hidePageLoadingMsg(); 隐藏 jQuery Spinner/Loader；

    ```
    // Show a Loading Spinner while we wait for our remote requests to complete.
    $.mobile.showPageLoadingMsg();

    // Remote Request 1
    MyController.f1(
        function(result, event){
            if(event.type == 'exception') {
                alert('Error: ' + event.message);                     
            } else {
                // Do stuff here such as fill in a form with the results from f1
            }
        },
        {escape:true});

    // Remote Request 2
    MyController.f2(
        function(result, event){
            if(event.type == 'exception') {
                alert('Error: ' + event.message);                     
            } else {
                // Do stuff here such as fill in a form with the results from f2
            }
        },
        {escape:true});

    // ...

    // Remote Request N
    MyController.fN(
        function(result, event){
            if(event.type == 'exception') {
                alert('Error: ' + event.message);                     
            } else {
                // Do stuff here such as fill in a form with the results from fN
            }
        },
        {escape:true});

    // I want to wait until all of my requests to finish before I hide the loading spinner.
    wait_for_all(); 
    $.mobile.hidePageLoadingMsg(); 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T23:15:14.063

这是我通常处理这种情况的方式：

```
 function doManyAsync(doneCallback) {
        // Async worker counters
        var workers = 0;

        function tickWorkers() {
            workers--;
            if ( workers === 0 ) {
                if ( doneCallback )
                    doneCallback();
            }

        }

        // Queue off first one
        doAsyncFunc1(1,2,3, tickWorkers);
        workers++;

        // Queue off second
        doAsyncFunc2(function() {
            tickWorkers();
        });
        workers++;

    } 
```

在异步函数范围之外使用异步工作计数器来跟踪它们。对于每个启动的异步函数，递增计数器。当它们完成时，回调将递减，直到它们都完成并调用完成的回调。这依赖于每个函数的递增。如果存在异步函数失败的风险，那么您可以设置超时以不时检查工作人员计数，如果它超过阈值且不是 0，则根据需要失败或生成错误。

以下是您的代码的外观：

```
 function doManyAsync(doneCallback) {

        // Async worker counters
        var workers = 0;

        function tickWorkers() {
            workers--;
            if ( workers === 0 ) {
                if ( doneCallback )
                    doneCallback();
            }

        }

        // Remote Request 1
        MyController.f1(
            function(result, event){
                tickWorkers();
                if(event.type == 'exception') {
                    alert('Error: ' + event.message);                     
                } else {
                    // Do stuff here such as fill in a form with the results from f1
                }
            },
            {escape:true});
        workers++;

        // Remote Request 2
        MyController.f2(
            function(result, event){
                tickWorkers();
                if(event.type == 'exception') {
                    alert('Error: ' + event.message);                     
                } else {
                    // Do stuff here such as fill in a form with the results from f2
                }
            },
            {escape:true});
        workers++;

        // ...

        // Remote Request N
        MyController.fN(
            function(result, event){
                tickWorkers();
                if(event.type == 'exception') {
                    alert('Error: ' + event.message);                     
                } else {
                    // Do stuff here such as fill in a form with the results from fN
                }
            },
            {escape:true});
        workers++;

    }

    // You would then
    $.mobile.showPageLoadingMsg();
    doManyAsync(function() {
        $.mobile.hidePageLoadingMsg();
    }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T23:20:12.013

尝试使用 jQuery **when**和**done**函数。

```
$.when(asyncFunc1, asyncFunc2).done(yourCallbackHere) 
```

这样，当第一个子句中的所有操作都完成时，您的回调函数就会被调用。

您也可以将**done**替换为**then**，并且无论提供的延迟对象是已解决还是被拒绝，都会调用您的回调。

这是您可以尝试的简单示例：

```
// Remote Request 1
MyController.f1(
  function(result, event){
    var dfr = $.Deferred(); // New deferred object.
    if(event.type == 'exception') {
        dfr.reject(); // Error, object should be rejected.
    } else {
        // Do stuff here such as fill in a form with the results from f1
        dfr.resolve(); // Success, object is resolved.
    }
    return dfr; // Return the deferred object.
}); 
```

可以理解，您的`f1`函数可能不会返回与内部回调相同的结果，`dfr`. 如果是这样，现在这是合理的：

```
$when(MyController.f1).done(successCallback); // Callback only if resolved.
$when(MyController.f2).then(alwaysCallback); // Callback if resolved or rejected. 
```

# javascript - HTML5 / JS - 我可以在 iOS 上同时播放两个或多个音频吗？

> ID：12206575
> 
> 赞同：0
> 
> 时间：2012-08-30T22:37:15.710
> 
> 标签：javascript, ios, html, audio

我需要同时播放两种不同的声音。我尝试了[SoundManager2](http://www.schillmania.com/projects/soundmanager2/)的示例和[转盘](http://wheelsofsteel.net/)示例，但我尝试的所有示例都没有在 Ipad 2 上运行。

甚至可以同时播放更多声音吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:53:56.443

我自己开发了 HTML5/JS 应用程序，我发现，在 iOS 上，使用 HTML/JS 一次只能播放一种声音……关于声音、HTML/JS 和 iOS 的组合有很多奇怪的事情…… （[见这里](https://getsatisfaction.com/schillmania/topics/ipad_weirdness_with_multiple_sounds)）。

# php - PHP：Tank Auth，需要特定的电子邮件地址才能登录

> ID：12206579
> 
> 赞同：0
> 
> 时间：2012-08-30T22:37:30.780
> 
> 标签：php, codeigniter, tankauth

所以我刚刚设置了 tank auth，我还没有改变任何东西，所以一切都应该是默认的。它工作得很好。但是，我想要求某个域才能使电子邮件能够登录。现在我会说gmail。那么我怎样才能使它在用户注册之前检查电子邮件地址是否包含@gmail.com。我找到了有效电子邮件错误消息的位置并且可以更改它，但我找不到实际检查有效电子邮件的位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:44:17.440

Tank auth 使用 CI 的默认`valid_email`验证规则，可在 Form Validation 类中找到。

想做这件事绝对是一件很奇怪的事情，但是你可以创建一个[回调验证函数](http://codeigniter.com/user_guide/libraries/form_validation.html#callbacks)，并在注册页面上将它添加到你的表单验证规则中。

这基本上相当于一条`ends_with`规则，但添加了“@”：

```
// Check if the inputs last characters matches the parameter
function is_email_domain($input, $domain) {
   $domain_str = '@'.$domain;
   $result = strpos($input, $domain_str) === (strlen($input) - strlen($domain_str));
   if ( ! $result) $this->form_validation->set_message('is_email_domain', 'The %s field must be a %s email address');
   return $result;
} 
```

因此，在您的控制器中创建回调函数并将其添加到验证中：

```
$this->form_validation->set_rules(
    'email',
    'Email',
    'trim|required|xss_clean|valid_email|callback_is_email_domain[gmail.com]'
); 
```

# python - 记忆类实例，直到其方法之一抛出

> ID：12206583
> 
> 赞同：0
> 
> 时间：2012-08-30T22:37:43.887
> 
> 标签：python, decorator

我有几个不同的类，它们的实例化成本相对较高，它们的方法可以正常工作，直到其中一个抛出，此时没有必要保留对象，因为状态以某种方式搞砸了。

我通常只会记住一个实例化对象的函数，但在这种情况下这不起作用，因为 memoize 装饰器只知道实例化时的对象，它不知道每个方法调用。

我该如何解决这个问题？是否可以创建一个装饰器来单独包装所有方法并在其中一个抛出时实例化一个新对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:43:54.603

您可以使用`dir(cls)`它来获取所有内容，并对其中的每个可调用项应用除装饰器之外的尝试...然后当您捕获异常时，在类上设置一个标志 (valid=False)，然后引发错误。 ..然后memoize在返回之前检查那个标志......如果没有标志就返回......

至少这是我能想到的唯一方法......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T10:10:47.227

您可以为实例添加“._valid”属性，然后在从缓存中返回它之前，您可以检查它是否为真。如果不将其视为缓存未命中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T22:46:10.490

我假设你的记忆器有一个内部功能，如：

```
def memocall(function, *args, **kwargs):
    try:
        return cache[(args, kwargs)]
    except KeyError:
        result = function(*args, **kwargs)
        cache[(args, kwargs)] = result
        return result 
```

将其稍微更改为：

```
def memocall(function, *args, **kwargs):
    try:
        return cache[(args, kwargs)]
    except KeyError:
        try: 
            result = function(*args, **kwargs)
        except:
            cache = {}  # Clear the cache
            raise       # Re-throw the exception
        cache[(args, kwargs)] = result
        return result 
```

# django - Django 中间模型

> ID：12206588
> 
> 赞同：0
> 
> 时间：2012-08-30T22:37:55.103
> 
> 标签：django

我正在尝试构建一种允许多个实体定期更新项目的关系。更准确地说，我想定义模型中使用的术语。

Lead => 这将是项目。

公司 => 将被允许投标该项目的承包商。在对项目进行投标/谈判时，他们必须定期更新潜在客户的状态字段。

Lead update => 用于保持更新的表。

但是当我尝试运行服务器时，我得到了这个错误

```
"companies.leadupdate: Reverse query name for field 'lead' clashes with m2m field 'Lead.leadupdate'. Add a related_name argument to the definition for 'lead'" 
```

我决定根据 Django 网站[https://docs.djangoproject.com/en/1.4/topics/db/models/](https://docs.djangoproject.com/en/1.4/topics/db/models/)上的示例走这条路线，这与我试图实现的目标相似。我也可能完全关闭:)

```
from django.db import models
class Company(models.Model):
    comp_name = models.CharField(max_length=200)
    comp_address = models.CharField(max_length=200)
    comp_email = models.CharField(max_length=200)
    comp_zip = models.IntegerField()
    comp_phone = models.IntegerField()
    comp_city = models.CharField(max_length=40)
    def __unicode__(self):
        return self.comp_name

class Leadsource(models.Model):
    assetname = models.CharField(max_length=100)
    def __unicode__(self):
        return self.assetname

class Lead(models.Model):

    numberofstations = models.IntegerField()
    comment = models.CharField(max_length=500)
    #company = models.ManyToManyField(Company)
    leadsource = models.ForeignKey(Leadsource)
    submissiondate = models.DateField('Submission Date')
    cname = models.CharField('Business Name', max_length=100)
    crep = models.CharField('Principle Contact', max_length=100)
    cemail = models.CharField(max_length=100)
    caddress = models.CharField(max_length=100)
    cnumber = models.CharField(max_length=100)
    leadupdate = models.ManyToManyField(Company,through='Leadupdate')

    def __unicode__(self):
        return u"%s %s %s" % (self.cname, self.crep, self.leadsource)

class Leadupdate(models.Model):
    updatedate = models.DateField()
    update = models.CharField(max_length=400)
    updatefrom = models.ForeignKey(Company)
    lead = models.ForeignKey(Lead)
    def __unicode__(self):
        return u" %s - %s " % (self.update, self.updatedate) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T06:49:19.030

就像错误所说的尝试将相关名称参数添加到 Lead 字段的定义中，例如：

```
lead = models.ForeignKey(Lead, related_name="lead_related") 
```

这应该可以解决问题。

# javascript - Jquery ui datetimepicker 不适用于淘汰赛

> ID：12206590
> 
> 赞同：2
> 
> 时间：2012-08-30T22:37:59.957
> 
> 标签：javascript, jquery-ui, knockout.js

我正在引用[KnockoutJS 未捕获的 jQuery UI datepicker 更改事件，](https://stackoverflow.com/questions/6612705/knockout-with-jquery-ui-datepicker)以使[datetimepicker](http://trentrichardson.com/examples/timepicker/)与淘汰赛一起工作。所以我基本上替换`datepicker`为`datetimepicker`制作以下代码

```
ko.bindingHandlers.datetimepicker = {
    init: function(element, valueAccessor, allBindingsAccessor) {   
        //initialize datetimepicker with some optional options
        var options = allBindingsAccessor().datetimepickerOptions || {};
        $(element).datetimepicker(options);

        //handle the field changing
        ko.utils.registerEventHandler(element, "change", function () {
            var observable = valueAccessor();
            observable($(element).datetimepicker("getDate"));
        });

        //handle disposal (if KO removes by the template binding)
        ko.utils.domNodeDisposal.addDisposeCallback(element, function() {
            $(element).datetimepicker("destroy");
        });

    },
    update: function(element, valueAccessor) {
        var value = ko.utils.unwrapObservable(valueAccessor());

        //handle date data coming via json from Microsoft
        if (String(value).indexOf('/Date(') == 0) {
            value = new Date(parseInt(value.replace(/\/Date\((.*?)\)\//gi, "$1")));
        }

        current = $(element).datetimepicker("getDate");

        if (value - current !== 0) {
            $(element).datetimepicker("setDate", value);
        }
    }
}; 
```

在html中：

```
<input data-bind="datetimepicker: myDate, datetimepickerOptions: { minDate: new Date() }" /> 
```

使用该代码，它看起来可以工作，但它无法将用户更改为相应的淘汰赛 observable 更新。

我调试了代码，发现

1.  `datetimepicker("getDate")`仅给出时间为 00:00 的日期部分。
2.  `observable($(element).datetimepicker("getDate"));`不时抛出异常，因为 observable(x) 有时不存在。

有没有人解决这个问题？

更新：#2 通过捕获偶尔的异常得到解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T13:08:30.143

您可能想尝试使用最新版本的 jQuery UI。在将小提琴更新为更新的 jQuery/jQuery UI 之前，我看到的行为与您相同。

这是最新位的小提琴：http: [//jsfiddle.net/rniemeyer/MWHNg](http://jsfiddle.net/rniemeyer/MWHNg)

# gstreamer - gstreamer 中的两个独立管道

> ID：12206596
> 
> 赞同：1
> 
> 时间：2012-08-30T22:38:37.413
> 
> 标签：gstreamer

我有两种不同的来源，一种用于音频，另一种用于视频。我使用appsrc 从源中提取数据。我可以单独播放视频和音频。但是，我不确定如何使它们一起工作。

请让我知道是否有人以前这样做过或知道两个人如何完成这项工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T07:04:46.850

您可以使它们成为同一管道的一部分。管道可以有两个源和两个接收器以及将源连接到接收器的中间组件。这样他们将使用相同的流水线时钟。

编辑：音频驱动并不意味着两者都不需要相同的时钟。除非您不关心音频-视频同步，否则最终两者都必须使用相同的时钟。音频驱动的东西是分开的，所以不要在你的脑海中混合这两者。如果您不希望它们使用相同的时钟，为什么要说“我不确定如何使它们一起工作”那么它们只是独立的管道，不存在一起运行它们的问题。如果你想要 AV 同步，你需要时钟同步。要么通过 rtsp [根本不需要漫长而复杂的路径] 要么只是在同一管道上运行。

# php - PHP $_GET 函数，错误信息未显示

> ID：12206599
> 
> 赞同：0
> 
> 时间：2012-08-30T22:39:17.777
> 
> 标签：php

我编写了一个脚本来在我的网站上显示我的新闻帖子，并使用该`$_GET`函数进行扩展，以便在该页面上显示按其 ID 列出的某个帖子，然后使用 else 函数列出页面上的所有帖子（如果该函数）不使用。

我的问题是，当我查看我想要的例如 ID '9' 的帖子时，它会显示，但是如果我转到一个不存在的帖子，例如 '3958389583'，那么它只会显示我的样式框，用于显示新闻数据的位置应该打印，而不是我用 if 语句回显的错误消息。

这是代码的这一部分：

```
if(isset($_GET['postid'])) {
    $id = mysql_real_escape_string(stripslashes($_GET['postid']));
    $result = @mysql_query("SELECT * FROM news WHERE id = '".$id."'");
    if (!$id) {
    echo("Error! The post you are trying to view does not exist or has been removed.");
    } else { 
```

在 else 语句继续打印我的新闻信息的其余代码之后。有人请帮忙，我只需要显示错误消息。谢谢，如果您出于任何原因需要其余代码，请告诉我:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:43:28.843

我想你想要做的是：

```
if(isset($_GET['postid'])) {
    $id = mysql_real_escape_string(stripslashes($_GET['postid']));
    $result = @mysql_query("SELECT * FROM news WHERE id = '".$id."'");
    if (mysql_num_rows($result) == 0) {
    echo("Error! The post you are trying to view does not exist or has been removed.");
    } else { 
```

但是，您应该[停止使用`mysql_`函数](http://www.deprecatedphp.com/mysql)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:50:09.703

只是一个想法。`id`它的名字似乎是一个数字，你使用`id = 'id'` 因为你抑制错误查询 -`@mysql_query`你没有看到任何错误。以防万一 - 删除抑制。它可能会给你答案。

# sql - 如何加快 PostgreSQL 中的插入性能

> ID：12206600
> 
> 赞同：261
> 
> 时间：2012-08-30T22:39:25.693
> 
> 标签：sql, postgresql, bulkinsert, sql-insert

我正在测试 Postgres 插入性能。我有一个表，其中有一列以数字作为其数据类型。上面也有索引。我使用此查询填充了数据库：

```
insert into aNumber (id) values (564),(43536),(34560) ... 
```

我使用上面的查询一次非常快速地插入了 10,000 行 400 万行。在数据库达到 600 万行后，性能急剧下降到每 15 分钟 100 万行。有什么技巧可以提高插入性能吗？我需要这个项目的最佳插入性能。

在具有 5 GB RAM 的计算机上使用 Windows 7 Pro。

* * *

## 回答 #1

> 赞同：546
> 
> 时间：2012-08-30T23:58:56.250

请参阅PostgreSQL 手册中的[填充数据库、](http://www.postgresql.org/docs/current/interactive/populate.html) [depesz](http://www.depesz.com/2007/07/05/how-to-insert-data-to-database-as-fast-as-possible/)关于该主题的优秀文章以及[这个 SO question](https://stackoverflow.com/questions/758945/whats-the-fastest-way-to-do-a-bulk-insert-into-postgres)。

*（请注意，此答案是关于将数据批量加载到现有数据库中或创建新数据库。如果您对使用`pg_restore`或`psql`执行`pg_dump`输出的数据库恢复性能感兴趣，其中大部分内容并不适用，因为`pg_dump`并且`pg_restore`已经执行了创建等操作完成模式+数据还原后的触发器和索引）*。

有很多事情要做。理想的解决方案是导入一个`UNLOGGED`没有索引的表，然后将其更改为记录并添加索引。不幸的是，在 PostgreSQL 9.4 中，不支持将表从更改`UNLOGGED`为记录。9.5 添加`ALTER TABLE ... SET LOGGED`允许您执行此操作。

如果您可以使数据库脱机以进行批量导入，请使用[`pg_bulkload`](http://ossc-db.github.io/pg_bulkload/index.html).

除此以外：

*   禁用表上的任何触发器

*   在开始导入之前删除索引，然后重新创建它们。（与逐步向其中添加相同数据相比，一次构建索引所需的时间*要*少得多，并且生成的索引要紧凑得多）。

*   如果在单个事务中执行导入，则删除外键约束、执行导入并在提交之前重新创建约束是安全的。如果导入拆分为多个事务，请不要这样做，因为您可能会引入无效数据。

*   如果可能，请使用`COPY`代替`INSERT`s

*   如果您不能使用，请`COPY`考虑在可行的情况下使用多值`INSERT`s。你似乎已经在这样做了。不要试图在一个单一的列表中列出*太多*`VALUES`的值；这些值必须在内存中适应几次，所以每条语句保持在几百个。

*   将您的插入批处理到显式事务中，每个事务执行数十万或数百万次插入。AFAIK 没有实际限制，但是通过在输入数据中标记每个批次的开始，批处理可以让您从错误中恢复。同样，您似乎已经在这样做了。

*   使用`synchronous_commit=off`一个巨大`commit_delay`的来减少 fsync() 成本。但是，如果您将工作批量处理为大事务，这将无济于事。

*   `INSERT`或`COPY`从多个连接并行。多少取决于硬件的磁盘子系统；根据经验，如果使用直连存储，您需要每个物理硬盘驱动器一个连接。

*   设置一个高`max_wal_size`值（`checkpoint_segments`在旧版本中）并启用`log_checkpoints`. 查看 PostgreSQL 日志并确保它没有抱怨检查点发生得太频繁。

*   当且仅当您不介意在导入过程中系统崩溃时将整个 PostgreSQL 集群（您的数据库和同一集群上的任何其他集群）丢失为灾难性损坏，您可以停止 Pg，设置`fsync=off`，启动 Pg，进行导入，然后（重要地）停止 Pg 并`fsync=on`再次设置。请参阅[WAL 配置](http://www.postgresql.org/docs/current/static/runtime-config-wal.html)。**如果 PostgreSQL 安装上的任何数据库中已经存在您关心的任何数据，请不要这样做。**如果你设置了`fsync=off`，你也可以设置`full_page_writes=off`；同样，请记住在导入后重新打开它，以防止数据库损坏和数据丢失。请参阅Pg 手册中的[非持久设置](http://www.postgresql.org/docs/current/static/non-durability.html)。

您还应该考虑调整您的系统：

*   尽可能使用*优质SSD 进行存储。*具有可靠、受电源保护的回写高速缓存的优质 SSD 可让提交速度快得令人难以置信。当您遵循上述建议时，它们的用处不大——这减少了磁盘刷新/ `fsync()`s 的数量——但仍然可以提供很大的帮助。除非您不关心保存数据，否则不要使用没有适当电源故障保护的廉价 SSD。

*   如果您将 RAID 5 或 RAID 6 用于直连存储，请立即停止。备份您的数据，将您的 RAID 阵列重组为 RAID 10，然后重试。RAID 5/6 对批量写入性能毫无希望——尽管具有大缓存的良好 RAID 控制器可以提供帮助。

*   如果您可以选择使用具有大电池支持的回写缓存的硬件 RAID 控制器，这可以真正提高具有大量提交的工作负载的写入性能。如果您使用带有 commit_delay 的异步提交，或者您在批量加载期间执行的大事务较少，则它没有多大帮助。

*   如果可能，将 WAL（`pg_wal`或`pg_xlog`旧版本）存储在单独的磁盘/磁盘阵列上。在同一个磁盘上使用单独的文件系统没有什么意义。人们经常选择为 WAL 使用 RAID1 对。同样，这对具有高提交率的系统影响更大，如果您使用未记录的表作为数据加载目标，它几乎没有影响。

您可能还对[优化 PostgreSQL 以进行快速测试](https://stackoverflow.com/a/9407940/398670)感兴趣。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2018-08-10T23:19:26.710

我今天在同一个问题上花了大约 6 个小时。插入以“常规”速度（每 100K 不到 3 秒）直到 5MI（总共 30MI）行，然后性能急剧下降（一直下降到每 100K 1 分钟）。

我不会列出所有不起作用并直接切肉的东西。

我在目标表上**删除了一个主键**（这是一个 GUID），我的 30MI 或行以每 100K 不到 3 秒的恒定速度愉快地流向目的地。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-06-13T07:05:09.657

`COPY table TO ... WITH BINARY`根据文档使用“[比文本和 CSV 格式要快一些](https://www.postgresql.org/docs/current/sql-copy.html)”。仅当您有数百万行要插入并且您对二进制数据感到满意时才这样做。

这是[Python 中的示例配方，使用带有二进制输入的 psycopg2](https://stackoverflow.com/a/8150329/)。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-11-04T14:12:07.810

除了优秀的 Craig Ringer 的文章和 depesz 的博客文章之外，如果您想通过在事务中使用准备好的语句插入来加速通过 ODBC ( [psqlodbc](https://odbc.postgresql.org/) ) 接口的插入，您需要做一些额外的事情来实现它快速工作：

1.  `Protocol=-1`通过在连接字符串中指定，将错误回滚级别设置为“事务” 。默认情况下 psqlodbc 使用“语句”级别，它为每个语句而不是整个事务创建一个 SAVEPOINT，从而使插入速度变慢。
2.  `UseServerSidePrepare=1`通过在连接字符串中指定来使用服务器端准备好的语句。如果没有这个选项，客户端会发送整个插入语句以及插入的每一行。
3.  使用禁用每个语句的自动提交`SQLSetConnectAttr(conn, SQL_ATTR_AUTOCOMMIT, reinterpret_cast<SQLPOINTER>(SQL_AUTOCOMMIT_OFF), 0);`
4.  插入所有行后，使用`SQLEndTran(SQL_HANDLE_DBC, conn, SQL_COMMIT);`. 无需显式打开事务。

不幸的是，psqlodbc`SQLBulkOperations`通过发出一系列未准备好的插入语句来“实现”，因此要实现最快的插入，需要手动编写上述步骤。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2019-10-23T21:12:50.310

如果您碰巧插入带有 UUID 的列（这不*完全是*您的情况）并添加到@Dennis[答案](https://stackoverflow.com/a/51795080/12265096)（我还不能评论），建议不要使用 gen_random_uuid() （需要 PG 9.4 和 pgcrypto 模块）是（a很多）比 uuid_generate_v4() 快

```
=# explain analyze select uuid_generate_v4(),* from generate_series(1,10000);
                                                        QUERY PLAN
---------------------------------------------------------------------------------------------------------------------------
 Function Scan on generate_series  (cost=0.00..12.50 rows=1000 width=4) (actual time=11.674..10304.959 rows=10000 loops=1)
 Planning time: 0.157 ms
 Execution time: 13353.098 ms
(3 filas) 
```

对比

```
 =# explain analyze select gen_random_uuid(),* from generate_series(1,10000);
                                                        QUERY PLAN
--------------------------------------------------------------------------------------------------------------------------
 Function Scan on generate_series  (cost=0.00..12.50 rows=1000 width=4) (actual time=252.274..418.137 rows=10000 loops=1)
 Planning time: 0.064 ms
 Execution time: 503.818 ms
(3 filas) 
```

此外，这是[建议](https://www.postgresql.org/docs/11/uuid-ossp.html)的官方方法

> 笔记
> 
> 如果您只需要随机生成的（版本 4）UUID，请考虑使用 pgcrypto 模块中的 gen_random_uuid() 函数。

这将 370 万行的插入时间从约 2 小时减少到约 10 分钟。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-30T22:43:06.330

为了获得最佳插入性能，如果您可以选择，请禁用索引。除此之外，更好的硬件（磁盘、内存）也很有帮助

* * *

## 回答 #7

> 赞同：-6
> 
> 时间：2018-03-13T21:29:04.040

我也遇到了这个插入性能问题。我的解决方案是生成一些 goroutine 来完成插入工作。同时，`SetMaxOpenConns`应该给一个适当的数字，否则会警告太多打开连接错误。

```
db, _ := sql.open() 
db.SetMaxOpenConns(SOME CONFIG INTEGER NUMBER) 
var wg sync.WaitGroup
for _, query := range queries {
    wg.Add(1)
    go func(msg string) {
        defer wg.Done()
        _, err := db.Exec(msg)
        if err != nil {
            fmt.Println(err)
        }
    }(query)
}
wg.Wait() 
```

我的项目的加载速度要快得多。这个代码片段只是给出了它是如何工作的想法。读者应该能够轻松地对其进行修改。

# php - 在 PHP foreach 循环中使用条件

> ID：12206604
> 
> 赞同：1
> 
> 时间：2012-08-30T22:39:59.173
> 
> 标签：php, html

我正在使用这样的 php foreach 语句：

```
<?php foreach($files as $f): ?> 
```

大量的 HTML

```
<?php endforeach; ?> 
```

我怎样才能在循环中放置一个条件，以便它可以跳到下一次迭代。我知道我应该使用 continue，但我不确定如何使用这样的封闭 php 语句来做到这一点。它会是一个单独的php语句吗？是否可以将其放置在 HTML 的中途，以便执行循环中的部分但不是全部内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T22:42:41.677

是的，您可以在任意位置插入条件`continue`：

```
<?php foreach($files as $f): ?>

lots of HTML

<?php if (condition) continue; ?>

more HTML

<?php endforeach; ?> 
```

[**看到它在行动**](http://ideone.com/WbiWH)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-10T08:52:27.487

我有一个非常相似的问题，所有搜索都把我带到了这里。希望有人发现我的帖子有用。从我自己的代码：对于 PHP 5.3.0，这有效：

```
foreach ($aMainArr as $aCurrentEntry) {
    $nextElm = current($aMainArr); //the 'current' element is already one element ahead of the already fetched but this happens just one time!
    if ($nextElm) {
        $nextRef = $nextElm['the_appropriate_key'];
        next($aMainArr); //then you MUST continue using next, otherwise you stick!
    } else { //caters for the last element
    further code here...
    }
//further code here which processes $aMainArr one entry at a time...
} 
```

对于 PHP 7.0.19，以下工作：

```
reset($aMainArr);
foreach ($aMainArr as $aCurrentEntry) {
    $nextElm = next($aMainArr);
    if ($nextElm) {
        $nextRef = $nextElm['the_appropriate_key'];
    } else { //caters for the last element
    further code here...
    }
//further code here which processes $aMainArr one entry at a time...
} 
```

# regex - 请求跟踪器“脚本”如何在 RT4 的新 IP 地址自定义字段中插入多个 IP 地址？

> ID：12206606
> 
> 赞同：2
> 
> 时间：2012-08-30T22:40:12.047
> 
> 标签：regex, rt

RT4 允许新的 CustomField 由经过验证的 ipv4 或 ipv6 地址组成，并且还允许多个值。这允许我拥有一个“IP 地址”自定义字段，其中包含多个票证地址。

我似乎无法`scrip`从电子邮件（或任何与此相关的`correspond`事件）中接受多个地址，只接受一个地址。

`scrip`我正在使用的是一个自定义操作，如下所示：

```
my $Ticket = $self->TicketObj;
my $Transaction = $self->TransactionObj;
my $body = $Transaction->Content();
my $cf = new RT::CustomField($RT::SystemUser);
my $id;
my $msg;
my $queue = 'Testes';

#---IPS
if($body =~ /X-addresses\:(.*)\n/i){
my $iplist = $1;
($id,$msg) = $cf->LoadByNameAndQueue (Name=>'addresses', Queue=>$queue);
($id,$msg) = $Ticket->AddCustomFieldValue (Field => $cf, Value =>$iplist);
}
return(1); 
```

我不反对被告知我这样做是错误的。我的 RT 安装目前的做法是让 Web 表单提交请求，目前该请求将具有一个由类似的 IP 地址字段`scrip`（除了 x-fqdn、x-contact、x-OS 和其他信息正在收集）我在想一个逗号分隔的混合 ipv4、ipv6 列表可以在一行中被捕获，只要 RT 的地址解析器验证它，我们就可以开展业务。

任何建议都将不胜感激，除了那些将我引向可怕的 BestPractical wiki 的建议外，我已经梳理了每一个充满风滚草的页面，但都是空的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T04:59:06.623

这里的问题是您只执行一次正则表达式，并且只获得第一个匹配项。您听起来像是想循环并找到尽可能多的匹配项。为了演示我制作了一些快速的 perl 脚本（我面前没有 RT 安装，所以我省略了 RT 特定的东西）。

第一个与您的非常相似，抓取第一场比赛并打印它：

```
~/perl/test$ cat testRegex.pl
#! /usr/bin/perl

my $body = <<END;
X-Addresses:1.2.3.4
X-Addresses:2.3.4.5
X-Addresses:10.0.0.1
some other text
another line of content
END

if($body =~ /X-addresses\:(.*)\n/i){
        my $iplist = $1;
        print $iplist, "\n";
} 
```

这个脚本的输出是：

```
~/perl/test$ ./testRegex.pl
1.2.3.4 
```

第二个演示了您要使用的语法：

```
~/perl/test$ cat testRegex2.pl
#! /usr/bin/perl

my $body = <<END;
X-Addresses:1.2.3.4
X-Addresses:2.3.4.5
X-Addresses:10.0.0.1
some other text
another line of content
END

while ($body =~ /X-addresses\:(.*)\n/gi){
        my $ip = $1;
        print $ip, "\n";
} 
```

该脚本的输出是：

```
~/perl/test$ ./testRegex2.pl
1.2.3.4
2.3.4.5
10.0.0.1 
```

您可以将其传递给另一个函数或方法，例如 AddCustomFieldValue，而不是打印 $ip 变量。

解释一下：正则表达式稍作更改以使用 g （或全局）开关，表明它将搜索整个字符串而不是在第一个匹配处停止 if 更改为一段时间 - 您可能可以使用 if 执行此操作不知何故-我只是不知道怎么做。如果你这样做了，你将不得不在一个变量中获取所有匹配项 - 可能是一个数组。之后，无论如何您都需要遍历数组，为每个元素运行 AddCustomFieldValue。我的 perl 不够强大，无法使用 if 来计算它，但我认为它在一段时间内更易读和更整洁。

# css - bootstrap - 导航栏选项卡在 ie 9 中未正确呈现

> ID：12206609
> 
> 赞同：0
> 
> 时间：2012-08-30T22:40:26.990
> 
> 标签：css, twitter-bootstrap

使用 Twitter bootstrap 2.1.0 中的最新样式表，我无法在 IE explorer 9 中获得带有正确呈现选项卡的导航栏。

图片在这里

![](../Images/ebf1dc0af4b18e4933f9a8137d3fed18.png)

（对不起，我无法嵌入）

它在 Chrome 中正确呈现。

这是完整的示例：http: [//jsbin.com/usugiz/3/edit](http://jsbin.com/usugiz/3/edit)

```
<html>
<head>
<script src="http://code.jquery.com/jquery.min.js"></script>
<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" rel="stylesheet" type="text/css" />
<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap-responsive.css" rel="stylesheet" type="text/css" />
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap.js"></script>
<meta charset=utf-8 />
<title>JS Bin</title>
</head>
<body>

  <ul class="nav nav-tabs">
  <li class="active">
    <a href="#">Home</a>
  </li>
  <li><a href="#">...</a></li>
  <li><a href="#">...</a></li>
</ul>

</body>
</html> 
```

奇怪的是，它在 JS Bin 预览中正确呈现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:51:24.977

`<!DOCTYPE html>`在HTML 的顶部放置一个。

如果您好奇，本页顶部将解释[原因](http://twitter.github.com/bootstrap/scaffolding.html)。

# php - 重音字符正在崩溃独立的 PHP 解释器

> ID：12206610
> 
> 赞同：4
> 
> 时间：2012-08-30T22:40:39.453
> 
> 标签：php, windows, encoding, non-ascii-characters

我有一个通过命令行和独立 PHP 解释器运行的 PHP 脚本。该脚本将大量 html 输出到 CSV 文件中，然后将其批量上传到 WP 站点。

重音字符似乎使解释器崩溃。前任：

```
$output = "Não encontrou o que você está procurando?";  
$english = "Did not find what you're looking for?"; 
```

每当我尝试操作`$output`字符串时，不会向 CSV 文件输出任何内容，但如果我改用 $english 翻译，则一切正常。

我确信它与不使用 UTF-8 编码的解释器有关，但我不知道如何修复它。

我试过了：

1.  使用以下命令分隔 PHP.INI 文件：`default_charset = utf-8`
2.  第一行脚本：`ini_set('default_charset', 'UTF-8');`
3.  确保我的代码编辑器 (ConText) 以 unicode 格式保存。
4.  谷歌搜索了过去一小时我能想到的一切

我知道我可以将字符串分解成它的 html 实体 (ã = & atilde;)，但我真的不想那样做，因为会有很多这样的字符串，其中一些会经常更改.

有没有其他解决方案可以让 PHP 解释器解析重音字符而不爆炸？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T23:51:09.697

我没有`utf8_encode()`在任何地方使用。一旦我添加了它，一切都很好。

```
$output = "Não encontrou o que você está procurando?";  
$output = utf8_encode($output); // THIS FIXED IT  
$english = "Did not find what you're looking for?"; 
```

# php - 你可以创建“产品订单号”和“ID”号是mysql吗？

> ID：12206612
> 
> 赞同：0
> 
> 时间：2012-08-30T22:40:58.523
> 
> 标签：php, mysql, phpmyadmin

我是编码新手，需要帮助，我想在 mysql 中记录新订单，所以订单从 php 发布到 mysql 数据库我相信 php 代码应该如下所示：

```
$p_account = $_POST['account'];
$p_account_id = $_POST['accountid'];
$p_email = $_POST['email'];
$p_id = $_POST['id'];
$p_name = $_POST['name'];
$p_width = $_POST['width'];
$p_height = $_POST['height'];
$p_price = $_POST['price'];
$p_order_id = $_POST['orderid'];
$p_date = $_POST['date'];
$p_quantity = $_POST['quantity'];
$p_product = $_POST['product'];
$p_product_id = $_POST['productid']; 
```

但是我遇到了麻烦，而不是发布诸如电子邮件、价格、姓名、宽度、高度、数据、产品 ID 或产品等输入或永久的数据

例如，我遇到了“ID”号码的问题。

我想要它，以便新用户加入的 id 获得用户不可见的帐户 ID，但是当他们在不同的位置登录时，他们可以发布其余信息。然后，当它发布产品数据时，它会生成一个我想要设置的新订单号，因此订单号将为 1001，然后每次发布包含上述所有帖子的新帖子时 +1。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T07:54:34.167

创建数据库：

```
CREATE TABLE jos_xxxx
(
Id int NOT NULL AUTO_INCREMENT,
account varchar(255) NOT NULL,
accountid varchar(255),
email varchar(255),
PRIMARY KEY (Id)
) 
```

您可以像这样插入值

```
INSERT INTO jos_xxxx (account,accountid,email) VALUES ('qwe1','12',test@test.com) 
```

的值`Id`会自动递增

# gwt - GWT ImageResource 背景位置

> ID：12206619
> 
> 赞同：1
> 
> 时间：2012-08-30T22:41:27.590
> 
> 标签：gwt, uibinder, clientbundle

我正在尝试在使用 UIBinder 的 GWT 中使用单个 .png 作为具有悬停效果（a la [this](http://inspectelement.com/tutorials/create-a-button-with-hover-and-active-states-using-css-sprites/)）的按钮，但我遇到了困难。

这是我的 ui.xml 文件：

```
<ui:with field="functionResources" type="myapp.client.application.functions.FunctionResources"/>

<ui:style>

    .clickableIcon{
        cursor: hand;
        cursor: pointer;            
    }

    .clickableIcon:hover{
        cursor: hand;
        cursor: pointer;                        
        background-position: 0 -76px;
        border: 1px solid blue;
    }
</ui:style>

<g:VerticalPanel ui:field="buttonPanel">
    <g:Image ui:field="survivalIcon" debugId="survivalIcon" width="76px" resource="{functionResources.survivalIcon}" styleName="{style.clickableIcon}"/>

</g:VerticalPanel> 
```

我能够将 .png 捆绑并显示在浏览器中就好了。但是，我的 :hover CSS 没有按预期工作。当我悬停时，它确实会在图像周围显示一个蓝色边框，所以我知道 CSS 正在工作，但图像不会改变。

看起来捆绑的图像像`0 0`元素样式本身一样覆盖了背景位置属性，这否定了我的类级样式。有没有办法告诉 GWT 不要为捆绑的 ImageResource 设置背景位置？还是有更好的方法来完全做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-07T17:58:47.107

从我在网上找到的糟糕文档中，您无法覆盖`g:Image`的背景位置属性。

另一种方法是使用 GWT 的 sprite 系统生成背景图像，您可以在其上覆盖`background-position`属性。

例如，

```
<div class="{functionResources.style.survivalIcon} {style.clickableIcon}"/> 
```

哪里`FunctionResources`会有：

```
public interface FunctionResources extends ClientBundle {
    public interface Style extends CssResource {
        String survivalIcon();
    }

    Style style();
    ImageResource survivalIconImage();
} 
```

并且，在一个名为 的单独 CSS 文件中`style.css`，您将拥有：

```
@sprite .survivalIcon {
    gwt-image: "survivalIconImage";
} 
```

这将生成一个 div，其中包含您想要的背景图像。您将能够随意修改 div 的`background-position`属性。

当然，这种方法可以应用于任何支持 background-image 的 DOM 元素。

# perl - 如何使用 msoPattern 常量将模式应用于使用 Perl Win32::OLE 的 Excel 图表中的系列

> ID：12206625
> 
> 赞同：1
> 
> 时间：2012-08-30T22:42:25.090
> 
> 标签：perl, excel, design-patterns, ole

我正在使用 Win32::OLE Perl 模块来更改图表中特定数据点的模式。

我可以这样做：

```
$chart->SeriesCollection(2)->Points(5)->{Interior}->{Pattern} = xlPatternUp; 
```

例如。需要明确的是，这完全符合预期。但是 xlPattern* 常量只允许 Excel 识别的模式子集。似乎在 msoPattern* 常量中指定了全套模式（至少我要使用的特定模式是）。

我尝试以相同的方式使用其中一个 msoPattern* 常量：

```
$chart->SeriesCollection(2)->Points(5)->{Interior}->{Pattern} =
msoPatternWideUpwardDiagonal; 
```

但这没有效果。数据点将以“实心”（默认）模式呈现。我已经确认我正确地导入了常量，例如：

```
use Win32::OLE::Const 'Microsoft Office 12.0 Object Library'; 
```

如何使用 msoPattern* 常量来更改模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T22:43:28.687

不幸的是，看起来你不能做你想做的事。

如果您查看*“应用于内部对象的模式属性”*部分中的[http://msdn.microsoft.com/en-us/library/office/aa224995](http://msdn.microsoft.com/en-us/library/office/aa224995) ，您将找到所有有效选项的列表。不幸的是，只有[xlPattern](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.xlpattern)是有效的。

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T19:05:14.037

msoPatterns 可以通过属性的`Patterned`方法进行更改。`{Format}->{Fill}`

例如

```
$chart->SeriesCollection(2)->Points(5)-
{Format}->Fill}->Patterned(msoPatternWideUpwardDiagonal); 
```*

# c - C警告：赋值使指针从没有强制转换的整数

> ID：12206627
> 
> 赞同：0
> 
> 时间：2012-08-30T22:42:37.183
> 
> 标签：c, arrays, pointers

我无法弄清楚为什么我的程序给了我这个错误。该函数假设对数组中的所有数字求和，然后求平均值。现在，我在总结元素时遇到了问题。

```
float Average(int **array, int n) {
  int sum = 0;
  int i;
  for (i = 0; i < n; i++){
    sum = sum + array[i];
  }
  return sum/n;
} 
```

该参数`array`是在main方法中动态分配的，`n`是数组的大小。

错误来自这一行，但我不知道为什么。

```
sum = sum + array[i]; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T23:01:03.437

你可能想要这个：

```
float Average(int *array, int n) {
  int sum = 0;
  int i;
  for (i = 0; i < n; i++){
    sum = sum + array[i];
  }
  return sum/n;
} 
```

如果出于某种原因想要更改 *array 指向的位置，则只需要 **array。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-30T22:45:38.603

发生这种情况的原因是数组是双指针。IE。尊重数组：

```
*array 
```

给你这个：

```
int *array 
```

这仍然是一个指针。

考虑您是否需要双指针，如果不需要，您将需要尊重它两次：

```
array[1][2] 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-30T22:45:55.250

您的数组实际上是一个数组数组（**），因此您正在计算数组中每个数组的起始虚拟内存地址的平均值。

编译器只是想告诉你，在大多数情况下，这不是程序员想要的结果。如果指针值大于 32 位整数，转换也可能失败。

演员表会告诉编译器*我确定我在做什么*：

```
(int)array[i] 
```

但我不认为那是你想要的，对吧？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-30T23:06:34.273

本是正确的。如果您的数组是一个简单的列表，这是一个示例解决方案，

```
main(int argc, char * argv[])
{
int ia[10] = {3,2,3,4,5,6,7};
float ans = 0;

  ans = Average(ia,7);
  printf("Ans %f\n",ans);
  exit(0);
}

float Average(int *array, int n)
{
int sum = 0;
int i;

  for (i = 0; i < n; i++){
    sum = sum + array[i];
  }
  printf("Calc %d / %d\n",sum,n);
  return (float)sum/n;
} 
```

# sql - 将 SQL 内联查询排列为多行查询的快捷键

> ID：12206629
> 
> 赞同：1
> 
> 时间：2012-08-30T22:42:53.420
> 
> 标签：sql, inline, shortcut

有没有什么快捷键可以将SQL查询从内联到多行查询，方便阅读。

例子 ：

从 EMP_ID = 23 和 EMP_NAME = 'JOHN' 的员工中选择 *

快捷键将与查询一致

```
SELECT * 
FROM EMPLOYEE 
WHERE EMP_ID = 23 
AND EMP_NAME = 'JOHN' 
```

我记得在使用 SQL Server 2005 时，我使用了一个快捷键。现在忘了。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:46:57.083

我使用[即时 SQL 格式化程序](http://www.dpriver.com/pp/sqlformat.htm)！！！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T23:52:06.930

有很多工具可以做到这一点。目前我正在使用**[Red Gate SQL Prompt](http://www.red-gate.com/products/sql-development/sql-prompt/)**。但是有很多选择，例如

**[Instant SQL Formatter（在线格式化工具）](http://www.dpriver.com/pp/sqlformat.htm)**
**[Poor Man's T-SQL Formatter（免费插件）](http://www.architectshack.com/PoorMansTSqlFormatter.ashx)**
**[SQL Formatter（在线）](http://www.freeformatter.com/sql-formatter.html)**
**[T-SQL Tidy（在线）](http://www.tsqltidy.com/)**
**[Poor SQL（在线）](http://poorsql.com/)**
**[SQL Complete](http://www.devart.com/dbforge/sql/sqlcomplete/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T22:45:26.213

www.sqlinform.com 上还有另一个带有许多格式化选项的 SQL 格式化程序。它还具有 Windows 热键功能。因此，您可以在 SQL 管理工具中一键格式化 SQL。在线版本是免费的。

# javascript - 从主干中的咖啡脚本返回一个对象

> ID：12206630
> 
> 赞同：0
> 
> 时间：2012-08-30T22:42:53.360
> 
> 标签：javascript, function, backbone.js, coffeescript

我想我在这里遗漏了一些非常基本的东西。我只想从咖啡脚本中的函数中获取值。我正在为那个值做console.log..

```
class App.Views.PlotModal extends Backbone.ModalView
  template: JST['plots/plot_modal'],

  render: ->
    console.log(@getSize.w);
    $(@el).html(@template(plot: @model));
    this.showModal();

  getSize: ->
    cell_div = document.getElementById("bgr");
    w : cell_div.offsetWidth * 3;
    h : cell_div.offsetHeight * 2; 
```

当我在萤火虫中进入控制台时，我一直不确定。如果我只记录@getSize，我会恢复该功能。如何在这里返回变量 w 和 h？

在主干视图中执行这种操作（我想动态调整 iframe 的大小）也是一个好主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T23:18:14.023

在 CoffeeScript 中，这`f`将变量中的方法保留`x`为一个简单的函数：

```
x = @f 
```

如果要调用该函数，则必须提供参数：

```
x = @f 'pancakes' 
```

或添加括号：

```
x = @f() 
```

所以你想要这个：

```
console.log(@getSize().w) 
```

至于在 Backbone 中做这种事情，当然，为什么不呢？Backbone 倾向于将政策留给您。

# javascript - 除非手动触发一次，否则 HTML5 音频无法通过 Javascript 播放

> ID：12206631
> 
> 赞同：38
> 
> 时间：2012-08-30T22:42:54.617
> 
> 标签：javascript, android, html, html5-audio

我正在尝试使用标签和 javascript 自动播放一个小的声音文件来启动它。

```
<audio id="denied" preload="auto" controls="false">
    <source src="sound/denied.wav" />
 </audio> 
```

然后通过javascript，在适当的时候：

```
$('#denied')[0].play() 
```

在我桌面上的 Chrome 上运行良好。在 Android 4.1.1 中，声音不会播放，除非我在 javascript 尝试播放之前在 HTML5 音频控件上点击“播放”。

所以基本上Android浏览器（股票或海豚）不会播放音频，除非用户在javascript之前的某个时间点启动它。这是故意的吗？有没有办法解决？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-21T18:26:53.487

好吧，出于我的目的，这就是我所做的：

幸运的是，在用户触发开始音频的行为之前，他们必须单击一个按钮。我将元素的音量设置为 0.0，并在他们单击此按钮时让它“播放”。

静音播放后，我只需将音量属性设置回 1.0，无需用户干预即可播放。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-03-02T14:49:36.067

就我而言，这是一个简单的解决方案：
[https](https://stackoverflow.com/a/28011906/4622767)
://stackoverflow.com/a/28011906/4622767 将其 复制并粘贴到您的 chrome 中：

```
chrome://flags/#autoplay-policy 
```

我的网络应用程序有很多页面重新加载，所以我不能强迫用户每次都按下按钮；但它是供内部使用的，所以我可以强制用户使用 chrome 并配置该选项。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-08-31T17:58:34.357

我知道在移动 Safari 中，任何对 play() 的 JavaScript 调用都必须与 **用户**初始化的点击事件在同一个调用堆栈中。使用 javascript 触发器欺骗点击也不起作用。

在我的 nexus 7 上，我可以确认除非 javascript 是由用户点击触发的，否则它不会播放。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-03-22T10:15:10.267

主要问题是声音（在 iOS 和 Android 上）必须由用户点击触发。我的解决方法非常简单。将 绑定`audio.play()`到单击事件侦听器，然后立即暂停它。从那时起，声音就完美了。

```
var myAudio = new Audio('assets/myAudio.mp3');
...
button.addEventListener("click", function() {
    myAudio.play();
    myAudio.pause();
    ...
}); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-01-29T00:12:40.390

这是一篇关于原因以及如何通过在第一次用户交互时加载所有音频文件并稍后以编程方式播放它们来克服它的博客文章：[https ://blog.foolip.org/2014/02/10/media- play-restrictions-in-blink/](https://blog.foolip.org/2014/02/10/media-playback-restrictions-in-blink/)采用这种方法，GitHub 上有一个小的 javascript 模块[https://github.com/MauriceButler/simple-audio](https://github.com/MauriceButler/simple-audio)

我自己尝试了这种简单的方法 - 无缝且很棒！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-12-21T18:04:16.723

对我来说幸运的是，我正在开发的 html5 应用程序只需要在 Android 4.1 中工作，但如果你想制作跨平台的东西，你需要稍微调整一下。将音量设置为 0.0 然后返回或在控件上自动播放都不适合我。我也试过静音，但也没有用。然后我想，如果我设置持续时间并且只播放极少量的文件怎么办？这是另一个实际上确实有效的黑客脚本：

```
function myAjaxFunction() {
  clearTimeout(rstTimer); //timer that resets the page to defaults
  var snd=document.getElementById('snd');
  snd.currentTime=snd.duration-.01; //set seek position of audio near end
  snd.play(); //play the last bit of the audio file
  snd.load(); //reload file
  document.getElementById('myDisplay').innerHTML=defaultDisplay;
  var AJAX=new XMLHttpRequest(); //won't work in old versions of IE
  sendValue=document.getElementById('myInput').value;
  AJAX.open('GET', encodeURI('action.php?val='+sendValue+'&fn=find'), true);
  AJAX.send();
  AJAX.onreadystatechange=function() {
    if (AJAX.readyState==4 && AJAX.status==200) {
      document.getElementById('myDisplay').innerHTML=AJAX.responseText;
      if (document.getElementById('err')) { //php returns <div id="err"> if fail
        rstTimer = setTimeout('reset()', 5000); //due to error reset page in 5 seconds
        snd.play(); //play error sound
        document.getElementById('myInput').value=''; //clear the input
      }
    }
  }
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-10-25T01:40:41.100

您不需要 JavaScript 进行自动播放，我在您的代码中发现了几个问题：

```
<audio id="denied" preload="auto" controls="false">
    <source src="sound/denied.wav" />
</audio> 
```

我会将其更改为（在 HTML5 中，在某些情况下您不需要 attribute="value" 语法，这适用于 XHTML）：

```
<audio id="denied" autobuffer controls autoplay>
    <source src="sound/denied.wav" />
</audio>
<a href="#" id="play-button">play!</a> 
```

在 iOS 自动播放被禁用时，您需要单击播放按钮或使用 JavaScript 将**用户**单击事件放在自定义控件上，如下所示：

```
var audio = document.getElementById('denied');
var button = document.getElementById('play-button');
button.addEventListener('click',function(){
    audio.play();
}); 
```

或使用 jQuery：

```
$('#play-button').click(function(){ audio.play(); });} 
```

## 编辑

请记住，HTML5 是相当新的技术（至少是一些功能），因此浏览器兼容性和功能每隔一段时间就会发生变化。

我鼓励每个人随时了解当前状态，因为有时事情开始不那么依赖黑客了，或者相反。

一个好的起点：[http](http://caniuse.com/#feat=audio) ://caniuse.com/#feat=audio （检查底部的标签）。

对于全局音频解决方案，我建议使用[SoundManager2](http://www.schillmania.com/projects/soundmanager2/) JS 库

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-06-20T02:55:30.583

它也发生在我身上。这是我破解的方法：

我将音频设置为并将音量`autoplay`设置为`0`。当我需要它播放时，我使用该`load()`方法，它会自动播放。这是一个轻量级的 mp3 文件，每隔一小时/两小时播放一次，所以这对我来说很好用。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-10-26T11:51:24.883

我在我的应用程序中遇到了同样的问题。我的应用使用场景是这样的：

1.  单击按钮以显示包含信息的表格（用户操作）
2.  通过 AJAX 显示表格并刷新其中的数据
3.  数据更改时播放声音

幸运的是，我有用户操作（步骤 1），因此我能够通过它“启动”声音，然后通过 javascript 播放它，而无需用户操作。查看代码。

**HTML**

```
<audio id="kohoutAudio">
    <source src="views/images/kohout.mp3">
</audio>

<button id="btnShow">Show table</button> 
```

**Javascript**

```
$("#btnShow").click(function () {
    //some code to show the table
    //initialize the sound
    document.getElementById('kohoutAudio').play();
    document.getElementById('kohoutAudio').pause();
});

function announceChange(){
    document.getElementById('kohoutAudio').play();
}; 
```

# html - 缓存静态内容的cdn服务？

> ID：12206632
> 
> 赞同：2
> 
> 时间：2012-08-30T22:42:58.643
> 
> 标签：html, caching, cdn

我开始发布我的第一个网站。我有一个想法，我很好奇是否有这样的服务。

例如，我有一个新闻页面，如果它发生变化，我总是将其缓存。现在我很好奇是否有一项服务可以扫描我的网站以查找更改的静态内容。

这样，我的访问者将访问 cdn 服务器而不是我的服务器。这个想法是让我的 Heroku 服务器负载，所以我必须使用更少的 dynos -> 更少的钱。

我现在认为这不适用于我的所有内容，例如特定用户生成的内容。

我知道 Cloudflare 正在做类似的事情，但他们只每 4 小时扫描一次整个站点。

*   是否存在这样的服务，它会降低我的服务器成本吗？

![http://postimage.org/image/j7jscj88l/](../Images/63cbfcb8d2fa54894878690c030f3ea8.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T14:17:29.610

您应该考虑使用[cloudflare](http://cloudflare.com)作为静态内容的 CDN。它是免费的，流量不受限制，并且具有许多附加功能，例如增加的安全性、谷歌分析集成等。

此外，如果您使用的是 heroku，您的 html 会被 heroku 的清漆缓存缓存。这是自动的；您所要做的就是设置一个有效的过期标头，以便清漆重新识别。[您可以在此处](https://devcenter.heroku.com/articles/http-caching)阅读有关 Heroku 清漆设置的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-07T14:10:24.037

这完全取决于您的 CDN 托管公司。我的 CDN 提供商每 60 分钟刷新一次内容。这意味着，如果在特定节点上，60 分钟内没有 xyz.jpg 的访问者，则该文件将从该节点刷新。

如果我有一个小型网站（每月使用少于 10 GB），我将专注于 CDN 网络上具有最大节点数的 CDN 提供商。

如果我有一个大型网站（每个月使用 100 多个 GIG），我将关注成本因素而不是节点总数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T22:51:55.853

几乎大多数主要的 CDN 都提供源源提取，以允许 CDN 从您选择的源服务器中提取内容。有一些免费的 CDN 服务，比如 CoralCDN，但根据我的经验，性能参差不齐。归根结底，大多数人希望将 CDN 用于性能目的而不是节省成本（顶级 CDN 网络并不便宜）。

# python - 列表中的计数在 python 中介于 1 和 10 之间

> ID：12206636
> 
> 赞同：1
> 
> 时间：2012-08-30T22:43:08.033
> 
> 标签：python

我希望在 python 中创建一个程序，要求用户以 [] 格式输入数字列表。

然后它必须计算并显示列表中有多少这些数字介于 1 和 10、10 和 20、20 和 30 等之间。

这是我到目前为止所拥有的。

```
my_num = [int(i) for i in raw_input("Enter numbers... ").split(",")]

the_list = eval(my_num)

number = 0

if 1<= my_num and my_num <=10:
    number = number + 1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T22:48:40.330

```
import itertools

numbers = sorted(map(int, raw_input().split(",")))
for k, g in itertools.groupby(numbers, lambda x: x // 10):
    print k, list(g) 
```

这将为您提供一组数字，您可以通过调用来计算组中的实例`len()`。例如，替换

```
 # print k, list(g)
    print k, len(list(g)) 
```

重要的是首先对数字进行排序。

以此作为输入：

```
1, 5, 6, 89, 43, 43, 25, 76, 12, 32, 23, 25, 27, 13, 5, 7

0 [1, 5, 5, 6, 7]
1 [12, 13]
2 [23, 25, 25, 27]
3 [32]
4 [43, 43]
7 [76]
8 [89] 
```

或者使用 len 调用的输出：

```
0 5
1 2
2 4
3 1
4 2
7 1
8 1 
```

然后可以像这样格式化：

```
print "%d - %d: %d" % (k * 10 + 1, (k + 1) * 10, len(list(g)) 
```

产量：

```
 1 - 10: 5
11 - 20: 2
21 - 30: 4
31 - 40: 1
41 - 50: 2
71 - 80: 1
81 - 90: 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T23:15:35.163

使用 a`Counter`是有效的，因为您只需要遍历列表一次

```
>>> L = [1, 5, 6, 89, 43, 43, 25, 76, 12, 32, 23, 25, 27, 13, 5, 7]
>>> from collections import Counter
>>> Counter(x//10 for x in L)
Counter({0: 5, 2: 4, 1: 2, 4: 2, 3: 1, 7: 1, 8: 1})
>>> sorted(Counter(x//10 for x in L).items())
[(0, 5), (1, 2), (2, 4), (3, 1), (4, 2), (7, 1), (8, 1)]

>>> for k,v in sorted(Counter(x//10 for x in L).items()):
...     print "%d - %d: %d"%(k*10, k*10+9, v)
...
0 - 9: 5
10 - 19: 2
20 - 29: 4
30 - 39: 1
40 - 49: 2
70 - 79: 1
80 - 89: 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T22:45:41.120

使用`len()`和列表理解：

```
>>> lis=[1, 5, 6, 89, 43, 43, 25, 76, 12, 32, 23, 25, 27, 13, 5, 7]

>>> [(i,[x for x in lis if x//10==i]) for i in range(0,(max(lis)//10)+1)]
[(0, [1, 5, 6, 5, 7]), (1, [12, 13]), (2, [25, 23, 25, 27]), (3, [32]), (4, [43, 43]), (5, []), (6, []), (7, [76]), (8, [89])] 
```

长度使用`len()`：

```
>>> [(i,len([x for x in lis if x//10==i])) for i in range(0,(max(lis)//10)+1)]
[(0, 5), (1, 2), (2, 4), (3, 1), (4, 2), (5, 0), (6, 0), (7, 1), (8, 1)] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-30T23:07:28.557

如果我理解，您想确定不同范围内的数字数量：[1;10]​​、[11; 20]；[21; 30], ..., [91; 100]

```
# Example of user input
your_list = [2, 10, 93, 1, 20]

# All the ranges' right part (sorry if my english is bad). my_ranges = [10, 20, 30, ..., 100]
my_ranges = []

# Array determining how many of those numbers in the list are in [1; 10], [11; 20], ..., [91; 100]
numbers = []

for i in range(1, 11):
    my_ranges.append(i*10)
    numbers.append(0)

for i in range(0, len(your_list)):
    out = False
    j = 0
    while not out and j<len(my_ranges):
        if your_list[i] <= my_ranges[j]:
            out = True
            numbers[j]+=1
        j+=1

for i in range(0, len(numbers)):
    print "Number of numbers in ["+str(my_ranges[i]+1-10)+";"+str(my_ranges[i])+"] = "+str(numbers[i]) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-30T23:11:55.217

不一定是最简单的方法，但[`ast.literal_eval`](http://docs.python.org/library/ast.html#ast.literal_eval)可以是`eval`.

至于计算每组十个数字中有多少个，该`itertools`模块有一个[`itertools.groupby`](http://docs.python.org/library/itertools.html#itertools.groupby)

```
import ast
import itertools

the_input = raw_input("Enter numbers... ")

# Lazy way to parse '[1,2,3]' into [1,2,3]
the_list = ast.literal_eval(the_input)

# Or, parse it manually (this is probably better in this case):
the_list = [int(x) for x in the_input.strip("[]").split(",")]

# Group by dividing number by 10, the result as an integer (15//10==1)
# This means 0-9 are in "group 0", 10-19 are in "group 1" etc
groups = itertools.groupby(the_list, key = lambda k: k // 10)

# Show stats for each block of ten
for group_count, group_members in groups:
    print "There were {count} numbers in {start}-{end}".format(
        count = len(list(group_members)),
        start = group_count * 10, # 15/10 becomes 1, then we do 1*10 for 10
        end = group_count * 10 + 9) # and 1*10+9 to get 19 (displayed as "in 10-19" 
```

示例运行：

```
$ python script.py
Enter numbers... [1,2, 11,12,13, 22,23, 44,45,46,47]
There were 2 numbers in 0-9
There were 3 numbers in 10-19
There were 2 numbers in 20-29
There were 4 numbers in 40-49 
```

要将其调整为组 1-10、11-20 等，只需`group =`像这样更改行线：

```
groups = itertools.groupby(the_list, key = lambda k: k // 10 + 1) 
```

或者，更简单一点：

```
the_input = raw_input("Enter numbers... ")

# Parse "[1,2,3]" into a list of numbers
the_list = [int(x) for x in the_input.strip("[]").split(",")]

group_counter = {}

for number in the_list:
    group_start = (number // 10) * 10
    group_end = group_start + 9
    group_name = "%s-%s" % (group_start, group_end)

    group_counter.setdefault(group_name, 0)
    group_counter[group_name] += 1

for name, count in group_counter.items():
    # Note that the sorting is wrong
    print "There were %s in %s" % (count, name) 
```

[`collections.Counter`](http://docs.python.org/library/collections.html#collections.Counter)如果您使用 Python 2.7 或更高版本，也可以使用

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-14T06:04:33.270

> 1.  计算列表中的数字总数
> 2.  列表中所有数字的总和和平均值
> 3.  计算列表中所有奇数的总和
> 4.  计算列表中所有偶数的总和
> 5.  在列表中找到最大的数字
> 6.  在列表中找到最小的数字
> 
> 显示具有适当标题的所有值。

```
listNo = [6,8,10,44,33,21,7,1,0,2]
c = 0
s = 0
avg = 0
sOdd = 0
sEven = 0
cOdd = 0
cEven = 0
for i in listNo :
    c += 1
    s = s+i
    avg = s/c
    if i % 2 == 0 :
        sEven = sEven + i
        cEven = cEven + 1
    else :
        sOdd = sOdd + i
        cOdd = cOdd + 1
print ("total number of numbers in the list  : ", c)
print("sum of all numbers : ",s)
print("average of all numbers : ",avg)
print("count odd numbers : ",cOdd)
print("sum of odd numbers : ",sOdd)
print("count even numbers : ",cEven)
print("sum of odd numbers : ",sEven)
print("largest number in the list : " ,max(listNo))
print("smallest number in the list  : ",min(listNo)) 
```

# node.js - 在nodejs中包含对象

> ID：12206638
> 
> 赞同：1
> 
> 时间：2012-08-30T22:43:11.920
> 
> 标签：node.js

我正在尝试在项目中使用 nodejs，并且需要包含一个包含对象的文件。仅仅包含是行不通的。我一直在研究，发现我必须将文件转换为模块。从那里我添加了行“var generator = require('./generator.js');” 到“app.js”和“exports.Generator = new Generator();” 文件包含，但导致此错误：

```
D:\Users\Miguel Borges\Dropbox\Trabalhos\Lero Lero\nodejs\app.js:14
        var phrase = generator.generatePhrases(1);
                               ^ 
TypeError: Object #<Object> has no method 'generatePhrases'
    at Server.<anonymous> (D:\Users\Miguel Borges\Dropbox\Trabalhos\Lero Lero\nodejs\app.js:14:25)
    at Server.EventEmitter.emit (events.js:91:17)
    at HTTPParser.parser.onIncoming (http.js:1783:12)
    at HTTPParser.parserOnHeadersComplete [as onHeadersComplete] (http.js:111:23)
    at Socket.socket.ondata (http.js:1680:22)
    at TCP.onread (net.js:410:27) 
```

## 编辑

现在，@Brandon Tilley 的答案是：

```
D:\Users\Miguel Borges\Dropbox\Trabalhos\Lero Lero\nodejs\app.js:20
console.log(g.Generator.generatePhrases(1));
                        ^
TypeError: Cannot call method 'generatePhrases' of undefined
    at Object.<anonymous> (D:\Users\Miguel Borges\Dropbox\Trabalhos\Lero Lero\nodejs\app.js:20:25)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.runMain (module.js:492:10)
    at process.startup.processNextTick.process._tickCallback (node.js:244:9) 
```

**应用程序.js**

```
var uri = '127.0.0.1';
var port = 8001;

var http = require('http');
var url = require('url');
var g = require('./generator.js');

http.createServer(function (request, response) {
    response.writeHead(200, {'Content-Type': 'text/plain'});

    var path = url.parse(request.url).pathname;
//  var generator = new g.Generator();

    var phrase = g.Generator.generatePhrases(1);

    response.end(path + '\n' + phrase);
}).listen(port, uri);

console.log('Server running at http://' + uri + ':' + port + '/');
console.log(g.Generator.generatePhrases(1)); 
```

**生成器.js**

```
function Generator () {

}

Generator.prototype.generatePhrases = function(nrPhrases) {
    return 'hi ' + nrPhrases;
};

// exports.Generator = new Generator(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:46:29.177

你想要`module.exports = new Generator()`。现在的写法，你需要：

```
var generator = require('./generator');
generator.Generator.generatePhrases(1); 
```

因为

```
exports.Generator = new Generator(); 
```

说，“当我需要这个模块时，我想要一个对象，它有一个名为 的属性`Generator`；该属性是 Generator 的一个实例并且有一个`generatePhrases`方法。”

如果您需要更多关于如何工作的解释，请查看[我的模块截屏视频。](http://nodecasts.net/episodes/3-modules)`module.exports`

# c#-4.0 - 无法加载文件或程序集“ServiceStack.Text”

> ID：12206640
> 
> 赞同：1
> 
> 时间：2012-08-30T22:43:25.253
> 
> 标签：c#-4.0, servicestack

这是我从引用 ServiceStack.Text 的控制台应用程序中得到的运行时错误。我已经手动删除了 nuget 包并使用包管理器控制台重新安装了它。目标框架是 .Net Framework 4，而不是 Client Profile。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:34:33.503

事实证明它与 ServiceStack.text 无关。它与一些相互矛盾的引用有关。

# iphone - iOS 用户位置不断恢复

> ID：12206646
> 
> 赞同：1
> 
> 时间：2012-08-30T22:44:15.440
> 
> 标签：iphone, objective-c, ios, xcode, mkmapview

我有一张地图，当按下按钮时，它会显示用户的位置并放大。但是，一旦按下该按钮，您就无法在地图上滚动，它会一直快速回到用户的位置。我需要添加/更改什么？谢谢。

```
// Set action for when the refreh button is pressed

-(IBAction)refreshMapView:(id)sender {

[self refreshMap];
}

// Set action for when the show user location button is pressed

-(IBAction)getlocation {

mapView.showsUserLocation = YES;
[self.mapView.userLocation addObserver:self forKeyPath:@"location" options:(NSKeyValueObservingOptionNew|NSKeyValueObservingOptionOld) context:nil];

}

// Display segment button to change map views

-(IBAction)changeSeg:(id)sender {

if (segment.selectedSegmentIndex == 0) {
    mapView.mapType = MKMapTypeStandard;
}
if (segment.selectedSegmentIndex == 1) {
    mapView.mapType = MKMapTypeSatellite;
}
if (segment.selectedSegmentIndex == 2) {
    mapView.mapType = MKMapTypeHybrid;
}
}

// Listen to change in the userLocation

-(void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
{

MKCoordinateRegion region;
region.center = self.mapView.userLocation.coordinate;

MKCoordinateSpan span;
span.latitudeDelta  = 0.2; // Change these values to change the zoom
span.longitudeDelta = 0.2;
region.span = span;

[self.mapView setRegion:region animated:YES];
}   

// Load everying when map tab is accessed

-(void)viewDidLoad {

// Load mapView from MKMapKit

[super viewDidLoad];

mapView = [[MKMapView alloc] initWithFrame:self.view.bounds];
[self.view insertSubview:mapView atIndex:0];

[mapView setMapType:MKMapTypeStandard];
[mapView setZoomEnabled:YES];
[mapView setScrollEnabled:YES];
[mapView setDelegate:self];

// Display WCCCA HQ annotation pin.

MKCoordinateRegion WCCCA = { {0.0, 0.0} , {0.0, 0.0} };
WCCCA.center.latitude = 45.53540820864449;
WCCCA.center.longitude = -122.86178648471832;
WCCCA.span.longitudeDelta = 0.02f;
WCCCA.span.latitudeDelta = 0.02f;
[mapView setRegion:WCCCA animated:YES];

Annotation *ann1 = [[Annotation alloc] init];
ann1.title = @"WCCCA";
ann1.subtitle = @"Washington County Consolidated Communications Agency";
ann1.coordinate = WCCCA.center;
[mapView addAnnotation: ann1];

// Display call annotations based on xml parser data.

NSArray *callsArray = [xmlParser calls];

for (JointCAD *call in callsArray) {
    NSString *callnumber = [call.callnumber stringByAppendingFormat:@". "];
    NSString *callandnumber = [callnumber stringByAppendingString:call.currentCallType];
    Annotation *ann = [[Annotation alloc] init];
    ann.title = callandnumber;
    ann.subtitle = [call location];
    ann.coordinate = CLLocationCoordinate2DMake([call.latitude doubleValue], [call.longitude doubleValue]);
    [mapView addAnnotation:ann]; }

}

// Annotation details.

-(MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id<MKAnnotation>)annotation {

// Set user location annotation to blue point instead of red pin

if ([annotation isKindOfClass:[MKUserLocation class]])
    return nil;

MKPinAnnotationView *MyPin=[[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:@"current"];
MyPin.pinColor = MKPinAnnotationColorRed;

UIButton *advertButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
[advertButton addTarget:self action:@selector(button:) forControlEvents:UIControlEventTouchUpInside];

// MyPin.rightCalloutAccessoryView = advertButton;
MyPin.draggable = NO;
MyPin.highlighted = YES;
MyPin.animatesDrop= TRUE;
MyPin.canShowCallout = YES;

return MyPin;
}

 // Set default view when accessing Maps tab.

- (void)viewWillAppear:(BOOL)animated {

[super viewWillAppear:animated];

CLLocationCoordinate2D coord = {.latitude =  45.422424, .longitude =  -122.76};
MKCoordinateSpan span = {.latitudeDelta =  0.60, .longitudeDelta =  0.60};
MKCoordinateRegion region = {coord, span};
[mapView setRegion:region];
}

@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T01:45:52.170

在`getlocation`您设置并开始观察用户位置变化的方法`showsUserLocation`中，使用.`YES``addObserver`

因此，只要用户位置发生变化（设备移动或获得更新位置时），该`observeValueForKeyPath`方法就会触发。在该方法中，您将地图的区域重置为以用户位置为中心。

在用户平移或缩放其他位置后，如果发生另一个用户位置更改，则该方法将再次触发并且地图将返回到用户位置。

在您的情况下，最简单的解决方法是在您第一次缩放到用户位置后立即停止观察。在`observeValueForKeyPath`方法中，在该`setRegion`行之后，添加：

```
[self.mapView.userLocation removeObserver:self forKeyPath:@"location"]; 
```

请注意，从 iOS 4.0 开始，您不需要使用 KVO（所有 addObserver 的东西）来观察用户位置的变化。相反，您可以使用[`didUpdateUserLocation`](http://developer.apple.com/library/ios/DOCUMENTATION/MapKit/Reference/MKMapViewDelegate_Protocol/MKMapViewDelegate/MKMapViewDelegate.html#//apple_ref/doc/uid/TP40008204-CH3-SW16)委托方法。

从 iOS 5.0 开始，缩放到用户位置的另一个选项是将地图视图设置[`userTrackingMode`](http://developer.apple.com/library/ios/DOCUMENTATION/MapKit/Reference/MKMapView_Class/MKMapView/MKMapView.html#//apple_ref/doc/uid/TP40008205-CH3-SW61)为`MKUserTrackingModeFollow`或`MKUserTrackingModeFollowWithHeading`。这样，您不必手动设置区域。地图将缩放到用户并跟随用户，但仍让用户自由平移或缩放。

# jquery - 数据切换：药丸没有按预期工作

> ID：12206648
> 
> 赞同：3
> 
> 时间：2012-08-30T22:44:21.920
> 
> 标签：jquery, ruby-on-rails, twitter-bootstrap

我正在使用 Twitter Bootstrap 2 开发 Rails 应用程序。我正在尝试做一些我认为应该很简单的事情，但我不熟悉将 Rails 与 jQuery 一起使用。这是我的部分：模板（实际上是部分）。

```
<div class="container">
 <div class="row">
   <div class="span2">
     <ul class="nav nav-pills nav-stacked">
       <li>
         <a href="#" data-toggle="pill">Trend lines for all questions</a>
       </li>
       <li>
       <%= link_to "Summary of all questions", program_reports_path(@program),
                   remote: true, id: "reports-navlist", data: {toggle: "tab"} %>
       <li class="active">
         <a href="#" data-toggle="pill">Trend lines for all questions</a>
       </li>
       <li>
         <a href="#" data-toggle="pill">Details on all questions</a>
       </li>
     </ul>
   </div>
   <div class="span10">
   </div>
 </div>
</div> 
```

我的问题是我无法让导航“药丸”激活正常工作。第一个、第三个和第四个 li 标签工作正常（因为它们什么都不做。）

但是第二个，测试，抛出了一个 JavaScript 错误。它没有变为活动状态，并且药丸的渲染不正确。如果我删除 remote:true 或使其成为 remote:false 这并不能解决问题。但是，如果我将 url 更改为“#”，那么它就可以工作。所以那里有一个我不明白的交互。

这是生成的完整 HTML：http: [//pastebin.com/nKUzwvif](http://pastebin.com/nKUzwvif)

以下是 Safari 中 JS 出现的错误：

> 其他问题。错误：语法错误，无法识别的表达式。

生成错误的代码在 Sizzle 中：

```
Sizzle.error = function( msg ) {
    throw new Error( "Syntax error, unrecognized expression: " + msg );
}; 
```

# java - java程序编译导致eclipse出现FileNotFound错误

> ID：12206650
> 
> 赞同：0
> 
> 时间：2012-08-30T22:44:29.820
> 
> 标签：java, eclipse, maven

我在eclipse内部使用maven构建了我的java程序，我遇到了以下错误：

```
 Caused by: java.io.FileNotFoundException: C:\Users\BennyJ\workspace\Tom\common\target\classes (Access is denied)
at java.io.FileInputStream.open(Native Method)
at java.io.FileInputStream.<init>(FileInputStream.java:106)
at      org.codehaus.plexus.util.io.FileInputStreamFacade.getInputStream(FileInputStreamFacade.java:39)
at org.codehaus.plexus.util.FileUtils.copyStreamToFile(FileUtils.java:1106)
at org.codehaus.plexus.util.FileUtils.copyFile(FileUtils.java:1013)
at org.apache.maven.plugin.war.packaging.AbstractWarPackagingTask.copyFile(AbstractWarPackagingTask.java:293)
at org.apache.maven.plugin.war.packaging.AbstractWarPackagingTask$1.registered(AbstractWarPackagingTask.java:150)
at org.apache.maven.plugin.war.util.WebappStructure.registerFile(WebappStructure.java:211)
at org.apache.maven.plugin.war.packaging.AbstractWarPackagingTask.copyFile(AbstractWarPackagingTask.java:145)
at org.apache.maven.plugin.war.packaging.ArtifactsPackagingTask.performPackaging(ArtifactsPackagingTask.java:106)
... 27 more 
```

作为更新，以管理员身份运行 eclipse 解决了这个问题。但是，现在它给出了一个新错误，如下所示：

```
org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.3.2:compile (default-compile) on project client: Compilation failure
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:213)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
    at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
    at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
Caused by: org.apache.maven.plugin.CompilationFailureException: Compilation failure
    at org.apache.maven.plugin.AbstractCompilerMojo.execute(AbstractCompilerMojo.java:656)
    at org.apache.maven.plugin.CompilerMojo.execute(CompilerMojo.java:128)
    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
    ... 19 more` 
```

这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:48:56.693

确保您的当前用户具有访问该文件的必要权限。如果他们这样做了，请确保没有其他任何东西（其他线程、程序或用户）锁定必要的文件。

# java - 如何从无线和网络列表中删除“蓝牙”（Android Gingerbread）

> ID：12206651
> 
> 赞同：0
> 
> 时间：2012-08-30T22:44:48.503
> 
> 标签：java, android, kernel

在我的工作中，我需要`"bluetooth`从设置中删除“ `"Wireless & networks"`。所以我不知道第一步是什么。我认为它是编辑 `Kernel` 或Android的UI。

请问有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T23:32:52.463

除非您正在构建自己的 ROM，否则您不能删除系统的任何部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T01:15:47.630

如果你想从 settings.apk 中删除蓝牙选项，你所要做的就是从 settings.xml 中删除蓝牙行（在反编译设置之后）。

此外，如果您想完全禁用蓝牙，您应该从系统/应用程序中删除所有与蓝牙相关的 apk。不过要小心fcs。

# java - “java.net.BindException：地址已在使用中”尝试使用新线程创建与前一个线程相同的套接字时

> ID：12206655
> 
> 赞同：2
> 
> 时间：2012-08-30T22:45:03.827
> 
> 标签：java, multithreading, sockets, networking, tcp-ip

我正在使用 Java 进行客户端-服务器模拟，其中客户端（线程）连接到服务器以获取一些数据。几秒钟后，需要杀死随机选择的客户端（线程）之一。我关闭了用于与服务器通信的套接字并让他死了（通过退出 run() 方法）。问题是当新创建的线程试图创建与以前使用的相同的套接字（相同的地址和相同的端口）连接到服务器时，我得到：

```
java.net.BindException: Address already in use
    at java.net.PlainSocketImpl.socketBind(Native Method)
    at java.net.AbstractPlainSocketImpl.bind(AbstractPlainSocketImpl.java:374)
    at java.net.Socket.bind(Socket.java:627)
    at java.net.Socket.<init>(Socket.java:423)
    at java.net.Socket.<init>(Socket.java:319) 
```

创建套接字的代码：

```
private void createNewSocket(InetAddress sIP, int sPort, 
        InetAddress cIP, int cPort) {
    try {
        socket = new Socket(sIP, sPort, cIP, cPort);
    } catch (IOException e) {
        e.printStackTrace();
        System.err.println("Socket unsuccessfully created");
    }
    try {
        in = new BufferedReader(new InputStreamReader(
                socket.getInputStream()));

        out = new PrintWriter(new BufferedWriter(new OutputStreamWriter(
                socket.getOutputStream())), true);

    } catch (IOException e) {
        e.printStackTrace();    
        try {
            socket.close();
        } catch (IOException e2) {
            System.err.println("Socket unsuccessfully closed");
        }
    }
}

public void run() {

    createNewSocket(gprsServerIP, Util.PORT_SERVER_PORT,
            clientIP, sendPort);

    out.println(REQUEST);   
    try {
        serverPort = Integer.parseInt(in.readLine());   
        TCPClient.serverPort[clientID] = serverPort;
        System.out.println("Server port: " + serverPort + '\n' + 
                            "Send port: " + sendPort + '\n');
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        try {
            socket.close();
        } catch (IOException e) {
            System.err.println("Socket unsuccessfully closed");
        }
    }

    while (true) {      

        if (clientID == TCPClient.selectedID) {

            TCPClient.selectedID = -1;

            createNewSocket(gprsServerIP, Util.PORT_SERVER_PORT, 
                    clientIP, sendPort);

            out.println(FREE_PORT + serverPort);
            try {
                socket.close();
            } catch (IOException e2) {
                System.err.println("Socket unsuccessfully closed");
            }
            //System.out.println(socket.isClosed());
            System.out.println("Port:" + serverPort + " is free");
            TCPClient.id[clientID] = -1;
            break;              
        }                           
    }
    clientCount--;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:55:36.717

当一个进程异常终止时，有时端口不会立即解除绑定，您必须等待几分钟才能使端口可用。如果可能的话，你的程序应该优雅地失败（即即使它必须被杀死，一个关闭钩子也应该关闭套接字）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T23:29:31.147

客户端套接字可能仍然处于 in[`CLOSE_WAIT`或`TIME_WAIT`status](http://en.wikipedia.org/wiki/Transmission_Control_Protocol#Protocol_operation)。操作系统确保在另一个应用程序可以重新使用之前，所有数据都已通过套接字传递。否则，新客户端可能会从先前的连接中获得垃圾重复数据包。

我建议您的客户使用一系列端口而不是常量。然后他们可以使用范围内的下一个端口，并在到达范围末端时循环。

但是，如果您不需要设置客户端端口，那么您根本不应该通过将端口 0 传递给`Socket`. 在这种情况下，JDK 和操作系统会做正确的事情并为您选择合适的空闲端口。

引用自[维基百科](http://en.wikipedia.org/wiki/Transmission_Control_Protocol#Protocol_operation)：

> **CLOSE-WAIT：** 服务器从本地应用程序接收到它完成的通知。服务器将其 fin 发送给客户端。
> 
> **TIME-WAIT：** 表示等待足够的时间以确保远程对等方收到其连接终止请求的确认。根据 RFC 793，连接可以在 TIME-WAIT 中停留最多四分钟，称为 MSL（最大分段寿命）。

# android - android垂直滚动器/寻呼机？

> ID：12206658
> 
> 赞同：1
> 
> 时间：2012-08-30T22:45:19.063
> 
> 标签：android, android-layout, android-viewpager, android-gallery

我需要能够垂直翻转一组图像。我看过 using `ViewPager`，但它似乎只支持水平分页。

我也看过`Gallery`，但我也看不到垂直分页的方法。无论如何，它已被弃用`HorizontalScrollView`，显然它不会起作用。

碰巧我可能会使用 a `ListView`，但它不会捕捉到页面，我也不能轻松地将每个列表项调整到大约“页面”的大小。

有垂直滚动/分页的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T23:13:25.657

Jake Wharton有一个[垂直 ViewPager的实现。](https://github.com/JakeWharton/Android-DirectionalViewPager)你可能想看看那个。

很容易集成：

```
<com.directionalviewpager.DirectionalViewPager
    android:id="@+id/pager"
    android:layout_height="fill_parent"
    android:layout_width="fill_parent" /> 
```

# jquery - 如何使用jQuery从数组中的元素中检索值？

> ID：12206660
> 
> 赞同：16
> 
> 时间：2012-08-30T22:45:35.780
> 
> 标签：jquery, html, arrays

我有多个输入字段，如下所示：

```
<input type="text" name="card[]">
<input type="text" name="card[]">
<input type="text" name="card[]"> 
```

用户可以根据需要添加或删除这些字段，因此字段的名称是一个数组。要获取数组的长度，这可以正常工作：

```
var n = $("input[name^= 'card']").length; 
```

如何从数组中读取值？

我试过这个没有用：

```
var n = $("input[name^='card']").length;
var array = $("input[name^='card']");
for(i=0;i<n;i++)
{
 card_value=  array[i].val();
 alert(card_value);
} 
```

这也不起作用：

```
var n = $("input[name^='card']").length;

for(i=0;i<n;i++)
{
 card_value=  $("input[name^='card["+i+"]']").val();
 alert(card_value);
} 
```

如何从这个数组中读取值？帮助！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2016-03-29T09:44:03.050

使用地图功能

```
var values = $("input[name^='card']").map(function (idx, ele) {
   return $(ele).val();
}).get(); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-30T22:48:07.883

你应该使用：

```
card_value=  array.eq(i).val(); //gets jquery object at index i 
```

或者

```
card_value=  array[i].value; //gets dom element at index i 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-30T22:48:43.610

`jQuery`集合有一个内置的迭代器`.each`：

```
$("input[name^='card']").each(function () {
   console.log($(this).val());
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-30T22:48:31.747

使用：http: [//jsfiddle.net/xH79d/](http://jsfiddle.net/xH79d/)

```
var n = $("input[name^='card']").length;
var array = $("input[name^='card']");

for(i=0; i < n; i++) {

   // use .eq() within a jQuery object to navigate it by Index

   card_value = array.eq(i).attr('name'); // I'm assuming you wanted -name-
   // otherwise it'd be .eq(i).val(); (if you wanted the text value)
   alert(card_value);
} 
```

​</p>

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-30T22:48:55.620

您可以循环浏览这些项目：

```
$("input[name^='card']").each(function() {
    console.log($(this).val());
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-30T22:50:46.820

你的语法不正确。

`card_value = $(array[i]).val();`或者`card_value = array[i].value;`

array[i] 不是 jQuery 对象（出于某种原因）。

检查浏览器的控制台可能有助于解决此类问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-03T06:35:57.947

阅读一个`array`，你也可以利用“ `each`”的方法`jQuery`：

```
$.each($("input[name^='card']"), function(index, val){
    console.log(index + " : " + val);
}); 
```

**奖励**：您还可以通过此方法读取对象。

[来源](http://api.jquery.com/jquery.each/)

# android - 需要 sqlite db 不接受空值

> ID：12206665
> 
> 赞同：0
> 
> 时间：2012-08-30T22:45:58.843
> 
> 标签：android, sqlite, insert, null

我的 sqlite db 接受空值，我不知道为什么。我将表作为“主键”，将列作为“文本非空”。Db 不应接受空值、非唯一值和大于第 1 行的插入。

D B：

```
 public void onCreate(SQLiteDatabase db) {

        String sqlDataStore = "create table if not exists " +
        TABLE_NAME_CREDENTIALS + " ("+ BaseColumns._ID + " integer primary key ,"

                    + COLUMN_NAME_USERNAME + " text not null unique,"
                    + COLUMN_NAME_PASSWORD + " text not null unique);";

        db.execSQL(sqlDataStore);
    }

    public static boolean Login(String username, String password) {

        Boolean Login = true;
        Cursor c =  db.rawQuery(
                "SELECT * FROM " + TABLE_NAME_CREDENTIALS + " WHERE "
                        + COLUMN_NAME_USERNAME + " = '" + username +"' AND "+ COLUMN_NAME_PASSWORD +" = '"+ password +"'" ,  null);
         if (c.getCount() > 0) {
                Login = false;
            }
            c.close();
            return Login;
    } 
```

插入方法：

```
 private void insertCredentials(RegDetails regDetails){

        LoginDB androidOpenDBHelper = new LoginDB(this);
        SQLiteDatabase sqliteDB = androidOpenDBHelper.getWritableDatabase();

        ContentValues contentValues = new ContentValues();
        contentValues.put(LoginDB.COLUMN_NAME_USERNAME, rUsername);
        contentValues.put(LoginDB.COLUMN_NAME_PASSWORD, rPasscode);

        long affectedColumnid = sqliteDB.insert(LoginDB.TABLE_NAME_CREDENTIALS, null, contentValues);

        if(affectedColumnid > 1){
        Toast.makeText(getApplicationContext(), "Account Already Exist! Please login" + affectedColumnid, Toast.LENGTH_SHORT).show();
        finish();
        }else {
            Toast.makeText(getApplicationContext(), "Credentials Saved! Please login" + affectedColumnid, Toast.LENGTH_SHORT).show();
        }
        sqliteDB.close();
        finish();
    }   

  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T22:55:22.177

它来自您没有使用 SQLite 网站上描述的 ON CONFLICT FAIL 的事实：[http ://www.sqlite.org/lang_conflict.html](http://www.sqlite.org/lang_conflict.html)

如果您想要查询示例，可以查看上一个问题：[SQLite 中的 NOT NULL 列和错误捕获](https://stackoverflow.com/questions/9935991/not-null-columns-in-sqlite-and-error-catching)

希望这会帮助你。

旁注：要构建长字符串，最好使用 StringBuilder。

# c# - 我需要修改一个 Word MERGEFIELD 正则表达式

> ID：12206667
> 
> 赞同：0
> 
> 时间：2012-08-30T22:46:06.700
> 
> 标签：c#, regex

我正在使用这个库在我的应用程序中实现 Word 文档邮件合并：http: [//www.codeproject.com/Articles/38575/Fill-Mergefields-in-docx-Documents-without-Microso](http://www.codeproject.com/Articles/38575/Fill-Mergefields-in-docx-Documents-without-Microso)

它工作得很好，但我已经大量重构了代码并执行了其他任务，以便将它与我自己的应用程序集成。

该库使用此正则表达式来捕获 Word 邮件合并字段：

```
private static readonly Regex _instructionRegEx = new Regex(
    @"^[\s]*MERGEFIELD[\s]+(?<name>[#\w]*){1}             # This retrieves the field's name (Named Capture Group -> name)
       [\s]*(\\\*[\s]+(?<Format>[\w]*){1})?               # Retrieves field's format flag (Named Capture Group -> Format)
       [\s]*(\\b[\s]+[""]?(?<PreText>[^\\]*){1})?         # Retrieves text to display before field data (Named Capture Group -> PreText)
       [\s]*(\\f[\s]+[""]?(?<PostText>[^\\]*){1})?        # Retrieves text to display after field data (Named Capture Group -> PostText)",
    RegexOptions.Compiled | RegexOptions.CultureInvariant | RegexOptions.ExplicitCapture | RegexOptions.IgnoreCase | RegexOptions.IgnorePatternWhitespace | RegexOptions.Singleline
); 
```

这捕获了示例，`MERGEFIELD FieldNameGoesHere`但是我遇到了字段名称被双引号括起来的示例，`MERGEFIELD "FieldNameGoesHere"`但是正则表达式没有捕获这些示例。

如您所见，正则表达式有点硬核，超出了我当前的 regex-fu 来修改它以使用双引号但也接受未引用的 MERGEFIELD。

显然第一行需要修改，但我不确定如何准确修改它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:52:58.030

更新：将双引号移到命名组的外部。

在您的第一行中，替换`(?<name>[#\w]*)`为`"?(?<name>[#\w]*)"?`让`"?`RegEx 查找可选的双引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-01T10:25:51.433

```
^[\s]*MERGEFIELD[\s]+"?(?<name>[#\w]*){1}"? 
```

如果字段名称包含空格，则不起作用：MERGEFIELD“我的字段名称”。

可以使用：

```
MERGEFIELD\s+"(.*?)" 
```

或者

```
MERGEFIELD\s+([#\w]+) 
```

# xml - 构建地图[String,String]

> ID：12206675
> 
> 赞同：2
> 
> 时间：2012-08-30T22:46:46.067
> 
> 标签：xml, scala

我有以下功能。它可以很好地打印我要存储的值。我想建立一个 Map[String, String]

```
def storePlayerEntry(n: Node, moved: Boolean) = {

    moved match {
      // storing a current player record
      // rowkey = playerid
      case true => {
        //println("current: " + teamId + ":" + n)
        println("id: " + n \ "@uID")
        for (
          s <- Seq("first_name",
            "last_name",
            "known_name",
            "birth_date",
            "weight",
            "height",
            "jersey_num",
            "real_position",
            "real_position_side",
            "join_date",
            "country")
        ) {
          val stat = (n \\ "Stat").filter(_.attribute("Type").filter(_.toString() == s).isDefined)
          Option(stat.text) match {
            case Some(st) if (st == "") => // do nothing
            case Some(st) => println(st)
            case None => // do nothing
          }
        }
        //val ret = dataApi.upsertMulti("players", 
      }
      case false => {
        //println("old: " + teamId + ":" + n)            
      }
    }
  } 
```

我避免声明地图然后只是添加方法，因为我确信这里有更多的 scala-ish 要做。

我正在寻找的地图将包含类似 s -> st

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T23:13:05.740

@jdevelop 很接近。应该是这样的：

```
val x = (for (
              s <- Seq("first_name",
                "last_name",
                "known_name",
                "birth_date",
                "weight",
                "height",
                "jersey_num",
                "real_position",
                "real_position_side",
                "join_date",
                "country");
              val st = (n \\ "Stat").filter(_.attribute("Type").filter(_.toString() == s).isDefined).text if (st != "")
            ) yield (s -> st)).toMap 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T23:25:58.473

这是一种更惯用的方法：首先，我们制作一组我们关心的所有键：

```
val keys = Set(
 "first_name",
 "last_name",
 "known_name",
 "birth_date",
 "weight",
 "height",
 "jersey_num",
 "real_position",
 "real_position_side",
 "join_date",
 "country"
) 
```

请注意，为了效率和逻辑，这可以在方法之外定义。

在方法内部，我们为所有`Stat`具有属性的元素制作一个映射`Type`，然后使用我们的集合过滤键：

```
 val stats: Map[String, String] = (n \\ "Stat").flatMap {
    s => s.attribute("Type").map(_.toString -> s.text)
  }.toMap.filterKeys(keys) 
```

现在我们有了一个从我们感兴趣的键到适当`Stat`元素的文本内容的映射。因此，例如，如果我们`n`看起来像这样：

```
<Player uID="john">
  <Stat Type="first_name">John</Stat>
  <Stat Type="last_name">Doe</Stat>
  <Stat Type="some_irrelevant_thing">blah</Stat>
</Player> 
```

根据需要，我们的结果将是`Map(first_name -> John, last_name -> Doe)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T23:01:18.323

```
(for (
      s <- Seq("first_name",
        "last_name",
        "known_name",
        "birth_date",
        "weight",
        "height",
        "jersey_num",
        "real_position",
        "real_position_side",
        "join_date",
        "country");
      val Some(st) = (n \\ "Stat").filter(_.attribute("Type").filter(_.toString() == s).isDefined)
      if (st != "")
    ) yield (s -> st)).toMap 
```

类似的东西

# zend-framework - 如何在类中加载模块的控制器？

> ID：12206677
> 
> 赞同：0
> 
> 时间：2012-08-30T22:47:04.570
> 
> 标签：zend-framework, zend-form

我已经尝试了许多不同的方法来解决我在网上找到的这个问题，但它们没有奏效，所以请有人帮助我。

我收到此错误

致命错误：在第 13 行的 pathToProject/modules/admin/controllers/LoginController.php 中找不到类“Admin_Form_Login”

我的项目是

应用

--- 模块

- - - 行政

--------控制器

- - - - 形式

- - - - 楷模

--------观看次数

- - - 默认

--------控制器

- - - - 形式

- - - - 楷模

--------观看次数

- - - 关于我们

--------控制器

- - - - 形式

- - - - 楷模

--------观点等

我的控制器

```
class Admin_LoginController extends Zend_Controller_Action
{

  public function init()
  {
     /* Initialize action controller here */
  }

  public function indexAction()
  {
      $form = new Admin_Form_Login();
      $this->view->form = $form;
      // action body
  }
} 
```

我的表格

```
class Admin_Form_Login extends Zend_Form
{

public function init()
{
    /* Form Elements & Other Definitions Here ... */

    $this->setAction("/admin/index/login")->setMethod("post");

    $username = new Zend_Form_Element_Text('username');
    $username->setLabel('Username')
    ->setOptions(array('size' => '30'));

    $password = new Zend_Form_Element_Password('password');
    $password->setLabel('Password')
    ->setOptions(array('size' => '30'));

    $submit = new Zend_Form_Element_Submit('submit');
    $submit->setLabel('Log in')
    ->setOptions(array('class' => 'submit'));

    $this->addElement($username)
    ->addElement($password)
    ->addElement($submit);

}

} 
```

我的 Bootstrap.php

```
class Admin_Bootstrap extends Zend_Application_Module_Bootstrap
{
    protected function _initAutoload() {
        $autoloader = new Zend_Application_Module_Autoloader(array(
        'namespace' => 'Admin_',
        'basePath' => APPLICATION_PATH."/modules/admin",
    ));
    return $autoloader;
    }
} 
```

这是我的 App ini 可能里面有东西

```
[bootstrap]

Autoloadernamespaces[] = "Admin_"
Autoloadernamespaces[] = "Default_"
Autoloadernamespaces[] = "Aboutus_"

resources.frontController.moduleDirectory = APPLICATION_PATH "/modules"
resources.frontController.defaultModule = "default"
resources.modules[] = ""

resources.view.encoding = "UTF-8"
resources.view.basePath = APPLICATION_PATH "/views/"

bootstrap.path = APPLICATION_PATH "/Bootstrap.php"
bootstrap.class = "Bootstrap"

[production]
phpSettings.display_startup_errors = 0
phpSettings.display_errors = 0
includePaths.library = APPLICATION_PATH "/../library"

resources.frontController.moduleDirectory = APPLICATION_PATH "/modules"
resources.frontController.params.prefixDefaultModule = "1"
resources.layout.layoutPath = APPLICATION_PATH "/layouts/scripts/"

admin.resources.layout.layout = layout
admin.resources.layout.layoutPath = APPLICATION_PATH "/layouts/scripts/"
default.resources.layout.layout = default
default.resources.layout.layoutPath = APPLICATION_PATH "/layouts/scripts/"

[staging : production]

[testing : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1

[development : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1
resources.frontController.params.displayExceptions = 1 
```

和我的看法

```
$this->form 
```

谢谢你的帮助。

* * *

我在生产部分中添加了以下内容，我的 application.ini 并开始工作不知道为什么。

```
Autoloadernamespaces[] = "Admin_"
Autoloadernamespaces[] = "Default_"
Autoloadernamespaces[] = "Aboutme_"

resources.frontController.moduleDirectory = APPLICATION_PATH "/modules"
resources.frontController.defaultModule = "default"
resources.modules[] = ""

resources.view.encoding = "UTF-8"
resources.view.basePath = APPLICATION_PATH "/views/"

bootstrap.path = APPLICATION_PATH "/Bootstrap.php"
bootstrap.class = "Bootstrap" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T07:08:01.677

听 Dave，清空你的 Admin_Bootstrap 类。如果您需要任何 _init 方法，请将它们放在您的应用程序级引导程序中。无论如何，所有引导类都在每个请求上运行，因此将任何 _init 方法放在应用程序级别以防止无意覆盖。

确保您的模块引导程序位于`application/modules/admin/Bootstrap.php`（*每个模块都需要一个引导程序*），以确保资源自动加载器正常工作。表单是自动加载器中的[预定义资源](http://framework.zend.com/manual/en/zend.loader.autoloader-resource.html#zend.loader.autoloader-resource.module)，因此不需要 _init 方法。

确保您的 application.ini 包含激活模块所需的最低要求：

```
resources.modules = ""
resources.frontController.moduleDirectory = APPLICATION_PATH "/modules" 
```

最后不要忘记`echo`在您的意见中：

```
$this->form 
```

应该：

```
echo $this->form 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T07:42:41.127

这对我有用：

在 application/configs/application.ini

```
resources.frontController.moduleDirectory = APPLICATION_PATH "/modules"
resources.modules[] = "" 
```

在应用程序/Bootstrap.php

```
class Bootstrap extends Zend_Application_Bootstrap_Bootstrap
{
    /**
     * @return Zend_Application_Module_Autoloader
     */
    protected function _initAutoload()
    {
        $autoloader = new Zend_Application_Module_Autoloader(array('namespace' => '', 'basePath' => APPLICATION_PATH));
        return $autoloader;
    }
} 
```

在模块/管理员/Bootstrap.php

```
class Admin_Bootstrap extends Zend_Application_Module_Bootstrap
{

} 
```

登录表单必须位于*modules/admin/forms*中，控制器位于*modules/admin/controllers*中。

我希望检查是有帮助的！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-30T23:05:01.607

尝试这个：

```
protected function _initAutoload() {
    $autoloader = new Zend_Application_Module_Autoloader(array(
        'namespace' => '',
        'basePath' => APPLICATION_PATH,
    ));
    return $autoloader;
} 
```

**没有命名空间（只有当你有一个，即Application_）。**

至于配置文件：

```
[production]
phpSettings.display_startup_errors = 0
phpSettings.display_errors = 0

includePaths.library = APPLICATION_PATH "/../library"
bootstrap.path = APPLICATION_PATH "/Bootstrap.php"

resources.frontController.moduleDirectory = APPLICATION_PATH "/modules"
resources.modules[] =

resources.layout.layout = "layout"
default.resources.layout.layoutPath = "/views/layout"
admin.resources.layout.layoutPath = "/views/layout" 

[staging : production]

[testing : production]

[development : production]
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1 
```

# android - 删除 SQLite 数据库

> ID：12206681
> 
> 赞同：0
> 
> 时间：2012-08-30T22:47:18.843
> 
> 标签：android, database, sqlite

我使用这个引用来复制我拥有的数据库：

[在 Android 应用程序中使用您自己的 SQLite 数据库](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)

但是当数据库被复制并且我从我的资产文件夹中删除数据库文件并运行我的应用程序时，它仍然会读取数据库。所以我一直在做的是重命名 db 文件并再次运行它以进行测试。我不喜欢这个，因为我觉得它占用了不必要的空间。但我想知道我是否可以以某种方式删除复制过来的数据库，这样我就不必继续重命名了。有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T23:01:03.953

据我所知，您将无法删除它，但是通过这种方式，您可以通过更改版本来生成一个新的：

```
private static class DatabaseHelper extends SQLiteOpenHelper {

       private static final int DATABASE_VERSION = 1; // Increase ==> new empty DB created

        DatabaseHelper(Context context) {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
        }
} 
```

在您的代码中版本为 1，您可以增加它并生成一个新的空数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T23:14:28.583

尝试在资产文件夹中重命名数据库，但不要忘记在 DbHelper 中更改名称！

# c# - ASP.NET MVC 视图可以在 ASP.NET WebForms 中呈现吗？

> ID：12206682
> 
> 赞同：1
> 
> 时间：2012-08-30T22:47:33.860
> 
> 标签：c#, asp.net, asp.net-mvc

我的情况是，我是 MVC 的新手，而我团队中的其他程序员不是，所以有时我的学习曲线会稍微减慢可交付成果，所以我试图弄清楚我在 MVC 中混合的选择是什么使用 WebForms 的视图（或部分视图）作为短期解决方案，使功能在 beta 版本中可用，并让我有机会在 MVC 中重新编写以进行生产。

我阅读[了这篇文章](http://www.packtpub.com/article/mixing-aspnet-webforms-and-aspnet-mvc)，它解释了如何引用这两个框架的程序集，但似乎没有解释如何将它们混合在一个页面中。

例如，我可以获取一个用户控件 (.ascx) 和一个视图 (.cshtml) 并将它们轻松地呈现到母版页 (.master.aspx) 中吗？

就好像我想要一个在服务器端执行视图并将内容写入响应流的服务器控件。我想另一种选择是将 javascript ajax 视图放入 asp.net 页面，但我想知道是否可以避免这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T22:53:27.490

是和不是。

您可以混合使用 ASP.NET MVC 和 WebForms，但不建议这样做，而且对混合的内容也有限制。在我的整个帖子中，我指的是 ASPX 视图，而不是 Razor / CSHTML 视图。使用带有 WebForms 的替代 ViewEngines 几乎是不可能的。

WebForms 可以单独使用 MVC 视图（ASPX，而不是 CSHTML），前提是您正确初始化它并在需要时提供模型对象（视图就像常规 aspx 页面一样，除了没有 CodeBehind 类）。

您还可以`System.Web.UI.Control`通过一些小技巧将 ASCX 控件和子类加载到 ASP.NET MVC 视图中（这并不完美 - 例如，不会触发控件生命周期事件，但更多的是让它们呈现到您的视图中）。

您还可以在与 MVC Web 应用程序相同的环境中拥有 ASPX 页面（只要您让路由工作）。CodeBehind 风格的 ASPX 可以将用户重定向到 MVC 控制器操作，反之亦然。

但是，如果没有大量艰苦的工作，您就无法从 WebForms 页面 CodeBehind 中调用 MVC 控制器操作，但我真的看不出您想要这样做的任何理由。

我认为你应该改写你原来的问题，想想你最终想要完成什么。就个人而言，如果这是一项维护任务，我会坚持使用纯 WebForms，并且只将 MVC 用于新项目。WebForms 并没有死，只要问问 ScottGu。

# pointers - C++/CX WinRT 指针的引用计数的线程安全

> ID：12206686
> 
> 赞同：1
> 
> 时间：2012-08-30T22:48:08.243
> 
> 标签：pointers, windows-runtime, reference-counting, c++-cx

在给定用例的情况下，我的印象是对 WinRT 对象的引用计数是线程安全的。但是我遇到了一个我不知道任何其他方式来解释的错误。例如，以下代码很快崩溃：

```
ref class C sealed {
public:
    C() { }
    virtual ~C() {}
};

[Windows::Foundation::Metadata::WebHostHidden]
public ref class MainPage sealed {
public:
    MainPage() : _latest(nullptr) {
        InitializeComponent();
        Windows::System::Threading::ThreadPool::RunAsync(
            ref new Windows::System::Threading::WorkItemHandler(
                this, 
                &MainPage::SetLatest));
        Windows::System::Threading::ThreadPool::RunAsync(
            ref new Windows::System::Threading::WorkItemHandler(
                this, 
                &MainPage::OnRendering));
    }
    virtual ~MainPage(){}
private:
    C^ _latest;
    void SetLatest(Windows::Foundation::IAsyncAction^ operation){
        while (true) {
            _latest = ref new C(); 
        }
    }
    void OnRendering(Windows::Foundation::IAsyncAction^ operation) {
        while (true) {
            auto c = _latest;
        }
    }
}; 
```

当读/写竞速时， WinRT 指针（即 ref 类类型`C^`）是否应该被正确引用计数？是否有一个我不知道的单独问题导致了这次崩溃？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T12:06:46.383

对`ref class`对象引用计数的更改是同步的，但对`T^`对象的更改不是。

您有两个线程`_latest`同时访问，其中一个线程正在修改`_latest`，因此您需要同步访问`_latest`，例如使用`std::mutex`.

# c++ - 是否可以将 Windows 8 (Metro) C++/DirectX 游戏与 (Metro) C#/XAML 启动器结合使用？

> ID：12206688
> 
> 赞同：0
> 
> 时间：2012-08-30T22:48:19.553
> 
> 标签：c++, windows, xaml, directx, microsoft-metro

是否可以准备 Windows 8 C#/XAML Metro 应用程序，它能够启动我为 Metro 编写的游戏，但使用 C++/DirectX？我需要准备一种能够一个接一个地启动多个 C++/DirectX 游戏的管理器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T00:24:07.000

我认为一个应用程序不应该只启动另一个应用程序，但您可以注册由其他一些应用程序处理的自定义文件格式，然后您可以使用 Launcher.LaunchFileAsync() 方法启动它们 - 假设它们都已安装.

另一方面，如果您拥有所有这些游戏的代码 - 您可以使用其中一种[DirectX/XAML 互操作](http://msdn.microsoft.com/en-us/library/windows/apps/hh825871.aspx)技术来运行 DirectX 代码。

# javascript - 如何在循环中使用 jQuery .on() 方法，而不覆盖我循环的对象

> ID：12206694
> 
> 赞同：4
> 
> 时间：2012-08-30T22:48:58.657
> 
> 标签：javascript, jquery, javascript-events

我必须将 mousedown 事件分配给对象集合。

但是 .on() 方法似乎每回合都会覆盖我的对象。

这是我的代码中的一个非常简化的示例。

Javascript：

```
$(document).ready(function() {
    var myArray = {
        0: {"id": "box1", "color": "blue"},
        1: {"id": "box2", "color": "green"}
    };

    for (i in myArray) {
        box = $('div#'+myArray[i]['id']);
        color = myArray[i]['color'];
        box.data('color', color);
        box.on({
            mousedown: function() {
                var color = myArray[i]['color'];
                $(this).css({'background': $(this).data('color')});
                myArray[i]['color'] = (i==0) ? "orange" : "pink";
            }
        });
    }
}); 
```

和 HTML：

```
​&lt;div id="container">
    <div id="box1"></div>
    <div id="box2"></div>
</div> 
```

​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ ​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​另外，你可以在这里看到它的行动：http: [//jsfiddle.net/ae3En/ 6/](http://jsfiddle.net/ae3En/6/)

希望有人可以帮助我，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T22:53:20.187

因为您`box`在函数中使用（并且`box`是在外部定义的）。因此，它将始终引用最后一个绑定框。`.on`与具体无关。有几种方法可以解决这个问题，但最简单的是：

```
mousedown: function () {
   $(this).css(...)
} 
```

编辑：我不完全确定为什么它只使用变量中的最后一种颜色。我能够通过使用将预期的颜色绑定到 div 本身来解决这个问题`.data`。希望此解决方案对您有用：

[http://jsfiddle.net/ae3En/5/](http://jsfiddle.net/ae3En/5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:53:26.083

代码中的小改动：替换此行

```
box.css({'background': myArray[i]['color']}); 
```

经过

```
 $(this).css({'background': myArray[i]['color']}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T23:00:18.103

直到循环运行后才会触发 mousedown 代码，因此您始终分配最后一个对象。这有效：**[jsFiddle 示例](http://jsfiddle.net/j08691/ae3En/4/)**。

```
var myArray = {
    "0": { "id": "box0","color": "blue" },
    "1": {"id": "box1", "color": "green" }
};
$('#container div').each(function(i) {
    $(this).on({
        mousedown: function() {
            $(this).css({
                'background': myArray[i]['color']
            });
        }
    })
});​ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-30T23:13:06.507

您可以使用它`.each`来迭代数组并避免所有范围问题：

```
$.each(myArray, function(i, obj) {
    $('div#'+obj['id']).on({
        mousedown: function() {
            $(this).css({'background': obj['color']});
        }
    });
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-30T23:12:22.623

您还可以将当前框变量发送到侦听器函数：

```
$(document).ready(function() {
    var myArray = {
        "0": {"id": "box1", "color": "blue"},
        "1": {"id": "box2", "color": "green"}
    };
    function listener(box,i)
    {
        box.on({
            mousedown: function() {
                box.css({'background': myArray[i]['color']});
            }
        });
    }
    for (i in myArray) {

        var box  = $('div#'+myArray[i]['id']);
        listener(box,i);

    }
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-30T23:21:35.847

```
$(document).ready(function() {
    var myArray = {
        "0": {"id": "box1", "color": "blue"},
        "1": {"id": "box2", "color": "green"}
    };

    for (i in myArray) {
        var box = $('div#'+myArray[i]['id']);
        var color = myArray[i]['color'];
        box.data('color', color);

        box.on({
            mousedown: function() {
                $(this).css({'background': $(this).data('color')});
            }
        });
    }
}); 
```

​</p>

[**演示**](http://jsfiddle.net/ae3En/7/)

# ruby - 我如何级联保存与 mongoid 的 has_and_belongs_to_many 关系？

> ID：12206695
> 
> 赞同：2
> 
> 时间：2012-08-30T22:49:06.633
> 
> 标签：ruby, mongoid

我有一个标签和一个问题类。

```
class Question
  include Mongoid::Document
  include Mongoid::Timestamps
  identity type: String
  has_and_belongs_to_many :tags # Refer to tag_ids
end

class Tag
  include Mongoid::Document
  identity type: String    
  has_and_belongs_to_many :questions
end 
```

但是，当我执行以下操作时，标签不会保存：

```
t = Tag.new(id: "politics")
q = Question.new({tags: [t]})
q.save! 
```

但是，当我这样做时会创建标签：

```
Question.create!({tags: [Tag.new(id: "politics")]}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T18:11:57.320

如果我执行以下操作，那么它将正常工作：

```
has_and_belongs_to_many :tags, autosave: true # Refer to tag_ids 
```

# sql - 在 T-sql 中使用 for XML 来透视数据

> ID：12206696
> 
> 赞同：1
> 
> 时间：2012-08-30T22:49:16.690
> 
> 标签：sql, sql-server, tsql, sql-server-2005

我正在尝试使用 for XML 函数来透视一些数据。我的数据如下：

```
VenNum_A   VenNum_B
0001       0002
0001       0003
0001       0004
0005       0006
0005       0007
0005       0008 
```

我试图得到以下结果：

```
venNum_A   VenNum_B
0001       0002,0003,0004
0005       0006,0007,0008 
```

到目前为止我的代码：

```
; with t as
        (
        select Distinct 
            A_VenNum, B_VenNum, SUM(1) as Cnt
        From 
            #VenDups_Addr
        Group by 
            A_VenNum, B_VenNum
        )
        select distinct
            B_Vennum,
             A_Vennum =cast(substring((
            select distinct 
                  [text()] =  ', ' + t1.A_Vennum 
            from 
                  t as t1
            where 
                t.A_Vennum =t1.A_VenNum
            for XML path('')
                ),3,99) as Varchar(254))

        From t 
```

目前我的结果与选择两个原始字段没有什么不同。

此外，如果这不是实现最终目标的最佳方法，我完全愿意接受替代解决方案，这是我知道的唯一方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T04:49:13.657

尝试

```
Declare @t table(VenNum_A VARCHAR(10),   VenNum_B VARCHAR(10))
Insert Into @t 
Select '0001','0002' Union All Select '0001','0003' Union All Select '0001','0004' Union All 
Select '0005','0006' Union All Select '0005','0007' Union All Select '0005','0008'

SELECT 
    VenNum_A
    ,VenNum_B = STUFF((Select ',' + CAST(VenNum_B AS VARCHAR(1000)) 
      FROM  @t t2 
      WHERE t1.VenNum_A = t2.VenNum_A
      FOR XML PATh ('')
      ),1,1,'')
FROM @t t1
GROUP BY t1.VenNum_A 
```

//结果

```
VenNum_A    VenNum_B
0001    0002,0003,0004
0005    0006,0007,0008 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:36:04.243

**您是否知道 CodePlex 具有用户定义的聚合GROUP_CONCAT**的开源 CLR 实现。安装就像在您的服务器上运行 SQL 脚本一样简单。

[http://groupconcat.codeplex.com/](http://groupconcat.codeplex.com/)

它有 4 个 group_concat 实现

*   GROUP_CONCAT --默认分隔符是 ,（逗号）

*   GROUP_CONCAT_D -- 你可以指定分隔符

*   GROUP_CONCAT_DS - 您可以指定分隔符，排序顺序（1 为 asc 顺序，2 为 desc 顺序）

*   GROUP_CONCAT_S -- 你可以指定排序顺序

在您的示例中，您将像这样使用它

```
SELECT  VenNum_A        
       ,dbo.GROUP_CONCAT(VenNum_B) AS VenNum_B        
FROM YourTable
GROUP BY
    VenNum_A 
```

# python - 遍历目录

> ID：12206697
> 
> 赞同：4
> 
> 时间：2012-08-30T22:49:22.557
> 
> 标签：python, linux

我正在寻找一种方法来**遍历**包含 100,000 个文件的目录。使用`os.listdir`非常慢，因为此函数首先从整个指定路径中获取路径列表。

最快的选择是什么？

注意：投反对票的人肯定从未遇到过这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T00:22:39.887

另一个问题在评论中被称为重复：
[List files in a folder as a stream to begin process](https://stackoverflow.com/a/4403746/496445)

...但我发现这个例子是半不工作的。这是适合我的固定版本：

```
from ctypes import CDLL, c_int, c_uint8, c_uint16, c_uint32, c_char, c_char_p, Structure, POINTER
from ctypes.util import find_library

import os

class c_dir(Structure):
    pass

class c_dirent(Structure):
    _fields_ = [ 
        ("d_fileno", c_uint32), 
        ("d_reclen", c_uint16),
        ("d_type", c_uint8), 
        ("d_namlen", c_uint8),
        ("d_name", c_char * 4096),
        # proper way of getting platform MAX filename size?
        # ("d_name", c_char * (os.pathconf('.', 'PC_NAME_MAX')+1) ) 
    ]

c_dirent_p = POINTER(c_dirent)
c_dir_p = POINTER(c_dir)

c_lib = CDLL(find_library("c"))
opendir = c_lib.opendir
opendir.argtypes = [c_char_p]
opendir.restype = c_dir_p

# FIXME Should probably use readdir_r here
readdir = c_lib.readdir
readdir.argtypes = [c_dir_p]
readdir.restype = c_dirent_p

closedir = c_lib.closedir
closedir.argtypes = [c_dir_p]
closedir.restype = c_int

def listdir(path):
    """
    A generator to return the names of files in the directory passed in
    """
    dir_p = opendir(".")
    try:
        while True:
            p = readdir(dir_p)
            if not p:
                break
            name = p.contents.d_name
            if name not in (".", ".."):
                yield name
    finally:
        closedir(dir_p)

if __name__ == "__main__":
    for name in listdir("."):
        print name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T00:23:05.583

你对目录中的每个文件做了什么？我认为使用 os.listdir 并没有真正的选择，但取决于你在做什么，你可能能够并行处理文件。例如，我们可以使用多处理库中的 Pool 来生成更多 Python 进程，然后让每个进程遍历文件的较小子集。

[http://docs.python.org/library/multiprocessing.html](http://docs.python.org/library/multiprocessing.html)

这有点粗略，但我认为它明白了这一点......

```
import sys
import os
from processing import Pool

p = Pool(3)
def work(subsetOfFiles):
    for file in subsetOfFiles:
        with open(file, 'r') as f:
           #read file, do work
    return "data"

p.map(work, [[#subSetFiles1],[#subSetFiles2],[#subSetFiles3]]) 
```

大体思路是从os.listdir中获取文件列表，但是我们不是一个个去10万多个文件，而是将10万个文件拆分成20个5000个文件的列表，每个进程处理5000个文件。这种方法的好处之一是它将受益于当前的多核系统趋势。

# silverlight - 使用 Windows Identity Foundation 添加条件重定向

> ID：12206701
> 
> 赞同：0
> 
> 时间：2012-08-30T22:49:59.893
> 
> 标签：silverlight, redirect, wif

我的 Silverlight 项目 Relaying Party (RP) 使用带有被动身份验证的 WIF 来控制访问。我需要添加向登录路径添加重定向的功能。

当有人试图访问一个页面时，他们会被重定向到 IP-STS 进行身份验证。一旦通过身份验证，我想显示许可协议。一旦用户点击确定，他们将被重定向到原始页面。

路径将是：

RP 内的任何站点 => IP-STS => 许可协议 => 原始站点

如果更简单，在去 STS 之前显示协议也是可以接受的，例如：

RP 内的任何站点 => 许可协议 => IP-STS => 原始站点

最终，我想在许可协议上设置一个 cookie，这样一旦被接受，用户就不必再看到许可协议了。

有人对此有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T22:00:19.477

一旦我在Terms.aspx 页面上使用FederatedPassiveSignIn 对象正确配置了Terms.aspx 页面，在配置文件中包含这两个部分就可以正常工作了。

在配置标签中：

```
<authentication mode="Forms">
  <forms loginUrl="~/Terms.aspx" />
</authentication> 
```

在 system.web 标签中：

```
<location path="Terms.aspx">
  <system.web>
    <authorization>
      <allow users="*"/>
    </authorization>
  </system.web>
</location> 
```

# python - Python Regex 的工作方式因实现而异？

> ID：12206706
> 
> 赞同：0
> 
> 时间：2012-08-30T22:50:25.973
> 
> 标签：python, regex, python-3.x

我正在开发一个需要从 JavaScript 代码中删除注释的文件解析器。问题是它必须很聪明，所以它不会将 `'//'`字符串中的序列作为评论的开始。我有以下想法：

遍历行。首先查找序列，然后在行中查找所有用引号 (或)`'//'`包围的字符串，然后遍历所有字符串匹配项以检查序列是在其中一个字符串之内还是之外。如果它在他们之外，很明显这将是一个适当的评论开始。`'``"``'//'`

在以下行测试代码时（当然是更大的 js 文件的一部分）：

`document.getElementById("URL_LABEL").innerHTML="<a name=\"link\" href=\"http://"+url+"\" target=\"blank\">"+url+"</a>";`

我遇到了问题。**我的正则表达式代码：**

```
re_strings=re.compile("""   "
                            (?:
                            \\.|
                            [^\\"]
                            )*
                            "
                            |
                            '
                            (?:
                                [^\\']|
                                \\.
                            )*
                            '
                            """,re.VERBOSE);

for s in re.finditer(re_strings,line):
            print(s.group(0)) 
```

在 python 3.2.3（和 3.1.4）**中返回以下字符串：**

```
"URL_LABEL"
"<a name=\"
" href=\"
"+url+"
" target=\"
">"
"</a>" 
```

这显然是错误`\"`的，因为不应退出字符串。我已经调试我的正则表达式很长时间了，它不应该在这里退出。所以我在[http://re-try.appspot.com/上使用](http://re-try.appspot.com/)**了 RegexBuddy**（与 Python 兼容）和**Python 正则表达式测试器**作为参考。最奇怪的是**，除了我的代码之外，它们都返回相同的正确结果，即：**

 **```
"URL_LABEL"
"<a name=\"link\" href=\"http://"
"\" target=\"blank\">"
"</a>" 
```

**我的问题是这些差异的原因是什么？我忽略了什么？**我是 Python 和正则表达式的初学者，所以答案可能很简单......

PS我知道`'//'`可以使用一个更大的正则表达式来查找序列是否在字符串引号内。我已经尝试过并遇到了同样的问题。

PPS我想知道我做错了什么，为什么我的代码和正则表达式测试应用程序的行为存在差异，没有找到如何解析JavaScript代码的其他想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T03:02:15.607

您只需要使用原始字符串来创建正则表达式：

```
re_strings=re.compile(r"""   "
                             etc.
                             "
                        """,re.VERBOSE); 
```

你得到它的方式`\\.|[^\\"]`变成了正则表达式`\.|[^\"]`，它匹配一个文字点 ( `.`) 或任何不是引号 ( `"`) 的东西。将`r`前缀添加到字符串文字中，它会按您的预期工作。

[**在此处**](http://ideone.com/t0yvw)查看演示。（我还使用了一个原始字符串来确保反斜杠出现在目标字符串中。我不知道你在测试中是如何安排的，但反斜杠显然是存在的；问题是你的正则表达式中缺少它们。 )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T22:52:47.140

你**不能**用正则表达式处理匹配的引号......事实上你**不能** 保证任何匹配的任何东西对（尤其是嵌套对）......你需要一个更复杂的状态机（LLVM等......）

资料来源：很多 CS 课程...

另请参阅：[Matching pair tag with regex](https://stackoverflow.com/questions/1692830/matching-pair-tag-with-regex)以获得更详细的解释

我知道这不是你想听到的，但它基本上就是它的方式......是的，正则表达式的不同实现可以为正则表达式不能真正做的事情返回不同的结果**

# lisp - Lisp的理论基础

> ID：12206710
> 
> 赞同：3
> 
> 时间：2012-08-30T22:51:07.263
> 
> 标签：lisp, racket, language-theory

我刚刚开始学习 lisp 的方言（[球拍](http://racket-lang.org/)），我想知道是否有人有链接或可以指出我的 lisp 语言家族的理论基础，资源是指论文、文章或书籍你能想到的任何东西。

最好表明它使用了哪些数学概念，它如何构造它的运算符，它如何解析它们，统一身份等等。我在 wikipedia 中阅读了[SEXP](https://en.wikipedia.org/wiki/S-expression)，但我觉得它有点肤浅。

我对基金会很感兴趣，因为我喜欢能够向他人解释事物是如何运作的。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-30T23:03:40.483

你可以从头开始：[http ://www-formal.stanford.edu/jmc/recursive.html](http://www-formal.stanford.edu/jmc/recursive.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-30T23:15:30.860

[http://library.readscheme.org](http://library.readscheme.org)

[http://en.wikipedia.org/wiki/Lisp_in_Small_Pieces](http://en.wikipedia.org/wiki/Lisp_in_Small_Pieces)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-30T23:43:34.117

我还将 Landin 的“The Next 700 Programming Languages”添加到此列表中；McCarthy 揭示了程序解释其他程序的概念，Landin 展示了相同的理论框架如何被视为几乎*所有*编程语言的基础。

事实上，我认为将类 LISP 语言的理论简单地说成是……编程语言的理论并不是没有道理的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-31T00:45:56.017

Paul Graham 有一些关于 Lisp 历史的不错的迷你文章：http: [//www.paulgraham.com/lisp.html](http://www.paulgraham.com/lisp.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-02T10:25:46.227

不要错过 Guy Steele 和 Gerald Sussman 的原始 lambda 论文。

*   “Lambda：终极命令”
*   “Lambda：终极宣言”
*   “Lambda：终极 GOTO”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-30T23:02:08.227

这里有几个链接：

[艾伦和达加特的 Lisp Primer](http://mypage.iu.edu/~colallen/lp/)

[Lisp 教程](http://logic.stanford.edu/classes/cs157/2004/programming/lisp.pdf)

# prototypejs - 在javascript中创建另一个对象的实例

> ID：12206718
> 
> 赞同：2
> 
> 时间：2012-08-30T22:51:38.827
> 
> 标签：prototypejs, prototype-programming, javascript

我想知道这句话是否正确？

你可以做：

```
var a = new A(); 
```

当且仅当`A`是`instanceof Function`。

只需创建一个函数实例，就知道函数是一个对象。为什么我们不能创建其他用户定义对象的实例？像这样：

```
var b={};
var c = new b();  //error 
```

编辑：我怎样才能改变`b`，以便我可以创建一个实例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T22:58:38.847

实际上，您可以`Object.create()`在 ECMAscript 的原型性质周围使用一些糖。像

```
var b = { };
var c = Object.create( b ); 
```

现在，c 将拥有`b`它的原型链。ECMAscript 或更准确地说，原型继承与“经典继承”的工作方式并不完全相同。通过`new`在调用函数时调用，您实际上也收到了一个新创建的对象。*您可以通过构造函数*`this`中的值修改和访问该对象。

 *但是，到目前为止，您没有继承任何东西。`.prototype`在创建构造函数的实例之前，您需要为构造函数创建并填充- 对象。这种模式惹恼了很多人，因此 ES5 带来了一种更方便的方式来使用`Object.create()`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-30T23:04:23.960

> 只需创建一个函数实例，就知道函数是一个对象。为什么我们不能创建其他用户定义对象的实例？

说“您可以创建函数实例”并不完全正确。这个`new`关键字有点误导——它使 JavaScript 看起来像是使用类实现了面向对象，而实际上它并没有。

你实际上在做的`new A()`是使用构造函数创建一个对象`A`。关键字告诉 JavaScript 解释器`new`返回一个对象`A`——特别是`this`在`A`.

> 编辑：我怎样才能改变`b`，以便我可以创建一个实例？

在您的示例中，`b`是一个对象 ( `var b={};`)。如果您更改`b`为构造函数，则可以使用它创建对象。（按照惯例，JavaScript 中的构造函数以大写字母开头。）

所以：

```
function B () {
}

var c = new B(); 
```

您可以将东西添加到 的`prototype`对象`B`，并且它们也可以访问`c`（以及您使用创建的任何其他对象`B`）：

```
function B () {
}

B.prototype.NAME = 'B';

B.prototype.hello = function () {
    alert('Hello!');
}

var c = new B();
c.NAME // 'B'
c.hello() // alerts 'Hello!' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-30T23:01:07.650

简短回答：`new`运算符要求其操作数具有`[[Construct]]`通用对象所没有的特殊内部方法。

长答案：

```
11.2.2 The new Operator
The production NewExpression : new NewExpression is evaluated as follows:
    1\. Evaluate NewExpression.
    2\. Call GetValue(Result(1)).
    3\. If Type(Result(2)) is not Object, throw a TypeError exception.
    4\. If Result(2) does not implement the internal [[Construct]] method, throw a TypeError exception.
    5\. Call the [[Construct]] method on Result(2), providing no arguments (that is, an empty list of arguments).
    6\. Return Result(5).

    The production MemberExpression : new MemberExpression Arguments is evaluated as follows:

    1\. Evaluate MemberExpression.
    2\. Call GetValue(Result(1)).
    3\. Evaluate Arguments, producing an internal list of argument values (11.2.4).
    4\. If Type(Result(2)) is not Object, throw a TypeError exception.
    5\. If Result(2) does not implement the internal [[Construct]] method, throw a TypeError exception.
    6\. Call the [[Construct]] method on Result(2), providing the list Result(3) as the argument values.
    7\. Return Result(6). 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-30T22:59:27.667

你也可以做

```
var b = new a.constructor(); 
```*

# hibernate - hibernate 4 的功能 hibernate.cfg.xml

> ID：12206721
> 
> 赞同：6
> 
> 时间：2012-08-30T22:51:58.957
> 
> 标签：hibernate

有人有hibernate 4的功能cfg文件示例吗？我可以在网上找到的所有参考资料都低于 v4，这不起作用。我尝试在此处粘贴我的文件的内容，但该站点删除了休眠配置标签。

所以这就是结果：

```
<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE hibernate-configuration PUBLIC
"-//Hibernate/Hibernate Configuration DTD//EN"
"http://www.hibernate.org/dtd/">

<hibernate-configuration xmlns="http://www.hibernate.org/xsd/hibernate-configuration">

  <session-factory> 

    <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property> 
    <property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property> 
    <!-- Assume test is the database name --> 
    <property name="hibernate.connection.url">jdbc:mysql://localhost/foampile</property> 
    <property name="hibernate.connection.username">root</property> 
    <property name="hibernate.connection.password"></property> 
    <!-- List of XML mapping files --> 

    <mapping resource="SiteRecord.hbm.xml"/>

  </session-factory> 

</hibernate-configuration> 
```

一旦我改为

```
<hibernate-configuration xmlns="http://www.hibernate.org/xsd/hibernate-configuration"
        xsi:schemaLocation="http://www.hibernate.org/xsd/hibernate-configuration hibernate-configuration-4.0.xsd"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> 
```

我得到这个例外：

```
Caused by: org.xml.sax.SAXParseException; lineNumber: 9; columnNumber: 63; Attribute "xmlns" must be declared for element type "hibernate-configuration". 
```

但是指定了 xmlns (xmlns="http://www.hibernate.org/xsd/hibernate-configuration")

这是 HIBERNATE 4.1 中的错误吗？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-04T17:37:55.710

我遇到了同样的问题，我可以通过从休眠配置中删除所有属性来让它工作，尽管文档和错误消息说:) 所以最后，我的 DOCTYPE 有这个：

```
<!DOCTYPE hibernate-configuration PUBLIC
    "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
    "http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd"> 
```

然后我只有：

```
<hibernate-configuration>
....
</hibernate-configuration> 
```

这对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T12:28:47.497

...对于它的价值，我最终让 IntelliJ 创建了存根文件，只是为了开始它（对于休眠 4.1）：

```
<!DOCTYPE hibernate-configuration PUBLIC
  "-//Hibernate/Hibernate Configuration DTD//EN"
  "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"> 
```

# python - 在 numpy 中查找 z 通过测试的 (x,y) 坐标

> ID：12206722
> 
> 赞同：1
> 
> 时间：2012-08-30T22:52:01.310
> 
> 标签：python, image-processing, numpy

我在 Numpy 中有一个 16x16x4 数组。

维度 1：水平位置 [0,15]

维度 2：垂直位置 [0,15]

维度 3：RGB 值 0-255 [0,3]

将 16x16 替换为 2048x1285 并且：

```
for x in range(0,15):
    for y in range(0,15): 
```

不削减它（超过 7 分钟的时间来执行此操作，并在每个有趣的点进行洪水填充）。迭代 PIL 图像非常快，但是 numpy 数组会拖累（即 7 分钟以上）。

```
numpy.where(bitmap == [red, green, blue, alpha]) 
```

看起来这不是我要找的。什么是一种相当快速的方法来解决这个问题？

编辑：

```
bitmap == [red, green, blue, alpha] 
```

实际上几乎有用。如何从 16x16x4 数组转到 16x16x1 数组，如果 z = [True,True,True,True] 则数组 [x,y] 为 1，否则为 0？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T02:51:06.287

我无法重现你的速度——即使是我现在古老的笔记本上的蛮力迭代也快了大约 14 倍——而且我不确定`where`你认为它的工作方式，所以我怀疑你的大部分时间用在其他地方（比如你自己填）。反正：

> 如何从 16x16x4 数组转到 16x16x1 数组，如果 z = [True,True,True,True] 则数组 [x,y] 为 1，否则为 0？

我会：

```
In [169]: m = numpy.random.randint(0, 16, size=(2048, 1285, 4))

In [170]: b = [4,5,6,7]

In [171]: matches = (m == b).all(axis=2)*1

In [172]: matches.shape
Out[172]: (2048, 1285) 
```

它非常快：

```
In [173]: timeit matches = (m == b).all(axis=2)*1
10 loops, best of 3: 137 ms per loop 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T02:47:20.643

事实证明，我描述的是通过

```
zip(*numpy.where(numpy.logical_and.reduce(image == [255,255,255]))) 
```

根据任何文件都不清楚，但你有它。（编辑：缺少 alpha 通道并不重要。）

我感兴趣的测试实际上并不是一个点的相等性，而是到那个点的欧几里得距离在一个阈值内。

```
numpy.apply_along_axis(distance_from_white ... 
```

其中 distance_from_white 是返回与白色的欧几里得距离的函数，在 16x16 下工作，但在 2048x1245 下需要几分钟。scipy.spatial.distance.pdist （或 cdist？）可能是那里的答案，但我不知道如何让它计算与单个点的距离而不是 2 个数组中所有点之间的距离（这适用于 16x16，但它浪费了太多的计算，我什至不敢尝试实际尺寸）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T23:44:48.727

`for`正如您所注意到的，在 a 上使用循环进行迭代`ndarray`不是很有效。如果您想找到满足您条件的条目的索引，您确实应该使用

```
indices = np.where(bitmap == [R, G, B, A]) 
```

这将返回一个 3 元素元组，给出沿第 1、第 2 和第 3 轴的解的索引。由于您只对前两个维度感兴趣，因此您可以删除第三个项目。如果你想要一系列索引`(x,y)`，你只需要使用类似的东西

```
zip(*indices[:2]) 
```

第二种可能性是将`(N,M,4)`标准整数查看`ndarray`到`(N,M)`结构化数组中`dtype=[[('',int)]*4]`（不要打扰字段名称，它们将自动扩展为`'f0', 'f1', ...`：

```
alt_bitmap = bitmap.view([('',int)'*4).squeeze() 
```

（`squeeze`引入了将数组折叠`(N,M,1)`成`(N,M)`数组）

然后您可以使用该`np.where`函数，但您要测试的值也必须是 a `np.array`：

```
indices = np.where(bitmap==np.array((R, G, B, A), dtype=bitmap.dtype)) 
```

这一次，`indices`将只有一个 2 元组，并且您可以获得前面介绍的`(x,y)`情侣。`zip(*indices)`

# fortran - .or 的遗留代码使用

> ID：12206727
> 
> 赞同：4
> 
> 时间：2012-08-30T22:52:44.663
> 
> 标签：fortran

在较旧的 fortran 代码中，当`.or.`与两种整数类型一起使用时，结果是按位还是操作数或 0/1？

我正在更新旧代码，并相信我应该用 替换这些实例`.or.`，`IOR`但不确定这是否是旧代码的预期结果。我应该将结果设置为 0 还是 1？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-31T00:04:21.973

我相信您所看到的确实是自定义扩展。我以前没有见过这个在使用中，但我确实在网上找到了关于实际存在于野外的这些东西的参考：

> 当 Fortran 程序直接与数字硬件通信时，可能需要对位模式执行按位逻辑运算。标准 Fortran 没有提供任何直接的方法来做到这一点，因为逻辑变量本质上只存储一位信息，而整数变量只能用于算术。许多系统提供了作为扩展的内在函数来对整数执行按位运算。函数名称各不相同：通常是 IAND、IOR、ISHIFT。**一些系统提供允许正常的逻辑运算符，例如 .AND。和.OR。与整数参数一起使用**：这是一个更激进的扩展并且不太令人满意，不仅因为它降低了可移植性，而且还降低了编译器检测正常算术表达式中的错误的能力。

[参考](http://www.star.le.ac.uk/~cgp/prof77.html#tth_sEc6.1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T12:45:41.190

具有 DEC/VMS 链接或遗产的编译器支持将允许整数参数扩展为 .OR。（和其他逻辑运算符）。那组编译器定义了.OR。对整数的操作是按位操作的。

当前支持的具有这种传统的编译器是 Intel Fortran（通过 Compaq Fortran、通过 Digital Fortran 等）。

# c# - Gecko WebBrowser.DocumentComplete 事件

> ID：12206731
> 
> 赞同：0
> 
> 时间：2012-08-30T22:52:55.190
> 
> 标签：c#, .net, webbrowser-control, gecko, readystate

我正在 c# 中创建一个包含“geckoWebBrowser”的应用程序。但我必须等待网页加载完成，然后继续执行其他指令。有类似于 geckowebbrowser1.DocumentComplete 的东西，但我不知道如何使用它。

请帮助我的代码：

```
 geckoWebBrowser1.Navigate(textBox1.Text);

                // i want to perform below thing after web page load completes

                listBox1.Items.RemoveAt(listBox1.SelectedIndex);
                listBox1.SelectedIndex = 0;
                int i = listBox1.Items.Count;
                string str = Convert.ToString(i);
                label2.Text = str; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T15:44:18.457

你可以使用事件：

```
geckoWebBrowser1_OnDocumentCompleted(EventArgs e) 
```

但请记住，在同一页面结束加载之前，此事件可能会触发多次......相应地编写逻辑。

# php - 我怎样才能使这个 PHP 代码更有效率？（编辑 CSV 文件中的一行）

> ID：12206733
> 
> 赞同：0
> 
> 时间：2012-08-30T22:52:54.740
> 
> 标签：php, csv

这段代码有效，但我只是利用我对 PHP 的有限知识将其破解，我确信有一种更优雅、更有效的方法来处理它。如果你能指出我如何改进，那就太好了！

所以我有一个 CSV 文件，结构如下：

```
Code        Class     Value    Status      Date Created    Date Redeemed
========================================================================
a51f3g45    gold      50       valid       2012-08-20      
4f6a2984    silver    200      redeemed    2012-08-23      2012-08-27      
gf3eb54b    gold      150      valid       2012-08-30      

etc... 
```

用户填写表格以更改给定行的**Class**、**Value**和**Status**字段。我拼凑了以下代码以用新值替换旧值：

```
$file = 'codes.csv';
$old_csv_string = file_get_contents($file);

preg_match('/('.$_POST['code'].',.*,.*,.*,.*,.*)\n/',$old_csv_string,$matches);
$old_row = $matches[1];

preg_match('/'.$_POST['code'].',(.*,.*,.*),.*,.*\n/',$old_csv_string,$matches_part);
$old_row_part = $matches_part[1];

$new_row_part = $_POST['class'].",".$_POST['value'].",".$_POST['status'];
$new_row = str_replace($old_row_part,$new_row_part,$old_row);
$new_csv_string = str_replace($old_row,$new_row,$old_csv_string);
file_put_contents($file,$new_csv_string); 
```

那么我能比 10 行代码做得更好吗？任何建议将不胜感激 ：）

*注意：我尝试使用`fgetcsv`，但我不知道如何在二维数组中找到唯一代码，然后替换它的兄弟姐妹。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T23:03:09.097

尝试对每一行使用这样的拆分：

```
list($code, $class, $value, $status, $created, $redeemed) = split(",", $line, 6) ; 
```

因此，您将每个字段都放在单独的变量中。当然，如果您不想复制标题，则需要注意第一行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T23:58:35.690

你为什么做这个 ？我认为您应该将数据存储在 SQL 表中。
每次用户更新数据时，都在表中进行。
如果您希望随时可以下载 CSV。仅当 your.csv 不存在时，使用 .htaccess 将 your.csv 重定向到 csv_generator.php。
如果 csv_generator.php 不存在，它将重新生成整个 csv，将其保存在硬盘上供以后使用，并在标题中使用正确的 mime/type 发送它（因此它对用户是透明的）。用户没有看到他正在请求一个 php 页面。
然后，每次有人更新数据时，您都需要删除硬盘上的 csv（因此它将在下一次请求时重新生成）

我认为这是随时准备在线下载 csv 的方法。

你知道谷歌文档这样做吗？用户可以更改电子表格中的数据，该电子表格可以从 url 下载为 csv（您需要将此电子表格发布为 csv 文件）。

# css - 由于第二个 CSS 文件带有一些重复的类而清除 CSS 样式

> ID：12206749
> 
> 赞同：1
> 
> 时间：2012-08-30T22:54:31.353
> 
> 标签：css

由于样式名称重复，是否有一种全局方法可以从 div 中清除 CSS 样式？我们正在合并内容，并试图通过使用多个样式表来最小化工作。这是我一直在做的一个测试：http: [//jsfiddle.net/Codewalker/yU2sW/7/](http://jsfiddle.net/Codewalker/yU2sW/7/)。但是，由于它是 JSFiddle，我没有引用两个外部样式表，而是将它们组合在 CSS 窗口中。注意 secondary_container div 如何从另一个容器继承蓝色文本。我还粘贴了下面的代码：

```
<div class="container">
<h1>This is in an h1 tag.</h1>
<p>This is at the very top, outside the secondary_container stuff. All kinds of content     can go down here. All of this is within a paragraph tag. I'll write one more sentence then     copy all this over again. Sound good? Wait that's two more sentences. Actually four. Oh well. So much for that. Here goes a little copying and pasting. All kinds of content can go down here. All of this is within a paragraph tag. I'll write one more sentence then copy all this over again. Sound good? Wait that's two more sentences. Actually four. Oh well. So much for that. Here goes a little copying and pasting.</p>

<div id="secondary_container">
<div class="container">

<p>This is within the container div that's within the secondery_container div. All kinds of content can go down here. All of this is within a paragraph tag. I'll write one more sentence then copy all this over again. Sound good? Wait that's two more sentences. Actually four. Oh well. So much for that. Here goes a little copying and pasting. All kinds of content can go down here. All of this is within a paragraph tag. I'll write one more sentence then copy all this over again. Sound good? Wait that's two more sentences. Actually four. Oh well. So much for that. Here goes a little copying and pasting.</p>
</div>
</div>
</div> 
```

这是 CSS，它实际上是两个独立的外部样式表：

```
/* BEGINNING OF FIRST CSS FILE styler.css */

.container {
background-color: #00FF00;
height: auto;
width:960px;
margin: 0 auto;
line-height: 20px;
}

h1 { font-family:Arial, Helvetica, sans-serif; font-size:14px; color: #F00; text-transform:uppercase; }
p { font-family:Arial, Helvetica, sans-serif; font-size:12px; color:#00F; 

}

/* BEGINNING OF SECOND CSS FILE secondary_container.css 
*/

#secondary_container .container h1 { font-family:Georgia, "Times New Roman", Times, serif; color: #0F0; }
#secondary_container .container p { font-style:italic; line-height:14px;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T23:09:03.753

您似乎有点名称空间的冲突，理想情况下，如果经过深思熟虑，您不应该遇到这种情况。要么更精确，或者更确切地说，不那么模糊。例如，您可以将元素包装在单独的 div 中，或者使用 css 链接。

CSS 有许多有用的片段，如果你遇到麻烦可以使用，例如`>`，当这样使用时`div > p.myClass`，只会适用于`p`'s 的类`myClass`，即 a 的子级`div`。然后，您甚至可以使用`:first-child`, 选择器使其更具体，这意味着它仅适用于第一个`p`标签，其类为`.myClass`，它是 div 的子标签。`div > p.myClass:first-child`.

真的，如果类不需要样式属性，为什么要使用它？

# java - 如何使 java 程序在远程机器上运行，以便我可以使用其记录的消息

> ID：12206753
> 
> 赞同：0
> 
> 时间：2012-08-30T22:55:05.330
> 
> 标签：java

我想在远程机器上运行一个 java 程序。

另外，我希望该程序记录的所有日志消息在另一台机器上可供我使用。如果我可以过滤/接收某种类型的消息，例如仅调试消息/错误消息，那将是一个加分项。

这可能吗？我不想更改将在远程机器上实际运行的程序的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T01:16:21.913

Syslog 是一个远程日志系统，允许您在一台机器上生成日志消息，并在另一台机器上接收它们：

*   在要接收日志消息的机器上运行 syslog 守护程序
*   对于您的 Java 程序，请使用支持 syslog 的日志框架，并将其配置为向您的 syslog 守护程序发送消息。例如，log4j 支持可插入的“appenders”，并且 log4j 存在一个 syslog appender。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T22:57:17.857

如果您愿意更改代码，您可以随时打开到您的家庭服务器的套接字并通过网络记录消息。

如果您不愿意更改本地代码，则需要一个外部进程来拦截程序的输出流，或者监视其输出日志。在这两种情况下，它只是打开一个套接字主页并发送数据。

# java - 在 ServletOutputStream 中写入字节时管道损坏

> ID：12206754
> 
> 赞同：13
> 
> 时间：2012-08-30T22:55:06.313
> 
> 标签：java, servlets, jboss

在执行此代码时，

```
ServletOutputStream out = response.getOutputStream();
out.write(bytes, 0, bytes.length);
out.flush();  
out.close(); 
```

我经常遇到这个异常，我不知道为什么会这样。

```
Caused by: ClientAbortException:  java.net.SocketException: Broken pipe
    at org.apache.catalina.connector.OutputBuffer.realWriteBytes(OutputBuffer.java:358)
    at org.apache.tomcat.util.buf.ByteChunk.append(ByteChunk.java:354)
    at org.apache.catalina.connector.OutputBuffer.writeBytes(OutputBuffer.java:381)
    at org.apache.catalina.connector.OutputBuffer.write(OutputBuffer.java:370)
    at org.apache.catalina.connector.CoyoteOutputStream.write(CoyoteOutputStream.java:89) 
```

我有一个在 JBoss 4.2.3 和 MySQL 下的 linux 服务器上运行的 web 应用程序。

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-30T23:04:16.847

通常这是由于客户端断开连接。客户端可能已断开连接的原因有多种（超时、浏览器已关闭等）。此外，作为一般做法，如果您没有打开流，则不要关闭。更多关于在此处关闭流的信息[我应该关闭 servlet 输出流吗？](https://stackoverflow.com/questions/1829784/should-i-close-the-servlet-outputstream).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-04T13:22:07.407

这可以通过添加适当的 response.setBufferSize(bufferSizeneeded+200); 来改善。默认缓冲区大小为 8124，可能不适用于所有用户！和 response.setHeader("Content-Length", String.valueOf(exportData.length));

# c# - 是否可以强制 WebBrowser 替换当前打开的窗口，而不是在新窗口中打开？

> ID：12206758
> 
> 赞同：2
> 
> 时间：2012-08-30T22:55:42.520
> 
> 标签：c#, browser, webbrowser-control

所以我有一个链接，我试图点击一个 WebBrowser 控件。问题是它在一个新选项卡中弹出，使 IE 打开。在 IE 中打开后我无法管理网页，所以我需要强制它以某种方式留在我的程序中。是否需要打开另一个 WebBrowser 控件或其他任何东西都没有关系，只要它在我的程序中说明即可。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T19:39:17.687

有几种方法可以做到这一点，一种方法是遍历 DOM（文档对象模型）并找到在新窗口中打开的链接，并将其“target=”属性值更改为“target=_top”它将在当前 WB Control 容器的当前顶级页面中打开。

否则，您可以拦截一个 NewWindow2 事件，在该事件中编写以下代码（其中 WB1 是您的 WebBrowser 控件名称）：

```
Processed = True
WB1.Navigate2 URL 
```

这将告诉您的 WB Control 该请求已被处理（诱使它相信它已被处理），如果您只是这样做，什么都不会发生，所以在第一行之后您编写第二行告诉它打开它刚刚尝试在新窗口中打开的 URL，在当前窗口 (WB1) 中，所以实际上您只是重新发出请求，但是对于单击链接的同一个容器/WB 控件。

我已经用VB编写了代码，但是我确信理解并转移到c#没有问题。

让我知道你们相处得如何，如果还有什么我可以帮忙的。

# iphone - 如何从仪器中导出编辑器日志

> ID：12206760
> 
> 赞同：1
> 
> 时间：2012-08-30T22:56:06.893
> 
> 标签：iphone, xcode, cocoa-touch, instruments

我正在仪器中运行测试脚本，并希望导出编辑器日志消息。有什么办法可以将它们导出到文件中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T18:41:20.857

我不知道有什么方法可以将控制台中记录的消息导出到 Instruments 的文件中。您应该能够将消息文本复制并粘贴到文本文件中。

# javascript - 保持纵横比

> ID：12206763
> 
> 赞同：0
> 
> 时间：2012-08-30T22:57:19.757
> 
> 标签：javascript, css, image, aspect-ratio, jcrop

我目前正在开发一个图像裁剪工具，图像裁剪工具来自 jCrop，我试图使用户从中进行裁剪的图像小于上传的原始图像。基本上，如果上传横向图像，我需要在不改变镜头纵横比的情况下将图像设为 304 像素宽。

例如，如果用户上传了一张人像照片，我需要在不改变照片纵横比的情况下将图像设为 237 像素。

这可能吗？我可以在我的代码中访问原始图像尺寸，但我无法确定我没有改变纵横比？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T23:18:20.750

是的，如果源图像已经足够宽，这是可能的。如果它不够宽，没有足够的数据可以裁剪，并且如果你想保持纵横比，你需要在裁剪之前放大图像。

这样的事情应该让你开始：

```
CropWidth=237;
AspectRatio= SourceWidth/SourceHeight; 
CropHeight = CropWidth*AspectRatio; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T00:24:57.467

要正确保持纵横比，您应该使用 GCD：

```
function gcd(a, b) {
    return (b == 0) ? a : gcd(b, a % b);
} 
```

然后你应该做这样的事情：

```
function calcRatio(objectWidth, objectHeight) {
    var ratio = gcd(objectWidth, objectHeight),
        xRatio = objectWidth / ratio,
        yRatio = objectHeight / ratio;
    return  { "x": xRatio, "y": yRatio };
} 
```

这将为您提供某些对象的比率。您可以使用此信息来确定生成的图像应该有多大。

```
function findSize (targetHeight, xRatio, yRatio) { 
    var widthCalc = Math.round((xRatio * targetHeight) / yRatio);
    return { "width" : widthCalc, "height" : targetHeight };
} 

var test = calcRatio(1280,720),
    dimensions = findSize(400, test.x, test.y); 
    //400 is what we want the new height of the image to be 
```

这些是你的尺寸。如果您的图像周围没有任何需要考虑的额外“空间”，那么您的工作就完成了。否则，您需要处理几个案例。

# css - 为什么使用带有文本的 webkit-transition 会导致文本最后对齐？

> ID：12206766
> 
> 赞同：4
> 
> 时间：2012-08-30T22:57:39.870
> 
> 标签：css, webkit, css-transitions, transitions

请参阅以下内容：http: [//jsfiddle.net/2Vdef/1/](http://jsfiddle.net/2Vdef/1/)

当您将鼠标移到 div 上时，文本会显示动画，但在结尾处有一个非常不吸引人的 opacity:1。为什么这么突然？这怎么能顺利呢？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T15:49:53.123

我遇到了同样的问题，虽然这个解决方案在我的情况下不起作用，但在你的情况下起作用。

[http://jsfiddle.net/2Vdef/13/](http://jsfiddle.net/2Vdef/13/)

添加背面可见性。

```
-webkit-backface-visibility: hidden;
-moz-backface-visibility:    hidden;
-ms-backface-visibility:     hidden;
backface-visibility:         hidden; 
```

编辑：在我的情况下，解决方案确实是背面可见性。您只需要将其应用于正确的元素。我为 的不透明度设置了动画`a`，并假设`backface-visbility`需要将其应用于`a`. 相反，它需要应用于`a`.

不工作： http: [//jsfiddle.net/9PmXu/](http://jsfiddle.net/9PmXu/) 固定：http: [//jsfiddle.net/9PmXu/1/](http://jsfiddle.net/9PmXu/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-30T23:23:11.813

在我看来，在 Chrome 和 FF Win 7 / OS X 上看起来不错，但在 IE 上当然没有逐渐的不透明度变化。对于所有浏览器，您可以尝试使用 jQuery 实现相同的效果，并根据需要调整动画速度。[http://jsfiddle.net/2Vdef/8/](http://jsfiddle.net/2Vdef/8/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T23:58:55.717

尝试改变这个：

```
-webkit-transition: opacity 1s ease;
-moz-transition: opacity 1s ease;
-o-transition: opacity 1s ease;
transition: opacity 1s ease; 
```

对此：

```
-webkit-transition: all 1s ease;
-moz-transition: all 1s ease;
-o-transition: all 1s ease;
transition: all 1s ease; 
```

它应该只是让你所有的过渡问题更加顺利。

此外，@Slave 的上述答案也是正确的，但将“200”更改为“600”以使其更流畅。答案是正确的，但我的答案是纯 CSS。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-31T00:40:58.927

事实证明，您可以通过以下方式防止波动：

```
-webkit-transform: translateZ(0); 
```

[http://chrissilich.com/blog/fix-css-animation-slow-or-choppy-in-mobile-browsers/](http://chrissilich.com/blog/fix-css-animation-slow-or-choppy-in-mobile-browsers/)

# c++ - 发现符号使用

> ID：12206769
> 
> 赞同：6
> 
> 时间：2012-08-30T22:58:02.457
> 
> 标签：c++, symbols

* * *

## **问题**

我最近发现自己在处理一个大型的、不熟悉的、多部门的 C++ 代码库，需要更好的组织。我想找到一种方法来映射任何给定标头的哪些源文件使用哪些符号。这是希望如果只有一个部门使用给定的功能，那么它可以移出共享区域并进入该部门的区域。

* * *

## **尝试**

我的第一个想法是使用符号表：即。编译项目并转储每个目标文件的符号。从那里我想我可以简单地编写一个脚本来检查我的头文件中的符号是否被使用。虽然这种方法似乎可行，但它需要我从标题中创建一个我正在寻找的符号列表。以我有限的知识，我不确定如何自动化这样的过程，并且有数百个头文件要测试，手动执行是不可能的。

* * *

## **问题**

*   我的方法有效吗？如果是这样的话..
    *   我可以使用什么从头文件中生成符号名称？
*   如果不..
    *   我还可以做些什么？

此外，当我使用 Linux 时，大多数开发团队都在仅 Windows 的环境中工作。我可以在两个平台上使用哪些实用程序？

* * *

非常感谢任何和所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T23:09:11.577

当我需要清理 API 时，我有时会使用来自[callcatcher](http://www.skynet.ie/~caolan/Packages/callcatcher.html)的信息。它基本上在编译时构建所有符号的数据库，并允许您确定在某些构建产品中使用了哪些符号。

我有时也使用[DXR](http://dxr.mozilla.org/)（[github 上的代码](https://github.com/mozilla/dxr)，[一个示例安装](http://dxr.mozilla.org/)）来浏览定义了哪些代码在哪里使用是如何使用的。与使用 DXR 的 callcatcher 相比，您可以深入了解更精细的细节。设置 DXR 相当繁重，但如果您有足够的代码可以使用，这可能是值得的。

另一方面，有[cscope](http://cscope.sourceforge.net/)之类的工具。尽管它不能很好地与 C++ 代码一起工作，但它仍然非常有用。如果你处理超过几个 100kloc，你很快就会感到有限。

如果我必须只选择其中一个工具并且要处理大型代码库 (>1Mloc)，我肯定会选择 DXR。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T23:17:03.667

非常老派，简单，可能只有 unix，但你知道[etags](http://www.linuxjournal.com/article/153)吗？还有[gnu global](http://www.gnu.org/software/global/)我认为是相似的。

gnu 全局链接指的是[此处的“与类似工具的比较”讨论，](https://github.com/OpenGrok/OpenGrok/wiki/Comparison-with-Similar-Tools)这也可能有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T23:25:56.050

您可以使用[doxygen](http://www.doxygen.org)对您所描述的信息有一个合理的起点。

即使对于不包含 doxygen 格式注释的源，创建的文档也可以包含使用特定符号的位置列表（即源文件）。

而且，由于 doxygen 可用于生成 html 文档，因此在源代码树中导航变得微不足道。如果您启用点功能来为源代码树中的类生成关系图，那就更好了。

# heroku - 将 Heroku 应用程序从竹堆栈迁移到雪松堆栈

> ID：12206773
> 
> 赞同：0
> 
> 时间：2012-08-30T22:58:25.510
> 
> 标签：heroku

如何将我的 Heroku 应用程序从竹堆栈迁移到雪松堆栈？

我正在尝试遵循本指南[https://devcenter.heroku.com/articles/bundler](https://devcenter.heroku.com/articles/bundler)

但是当我尝试时`git push heroku master`它只是说

> 一切都是最新的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-24T01:40:53.947

请尝试关注[这篇](https://devcenter.heroku.com/articles/cedar-migration)文章。（我假设您正在运行一个 Rails 应用程序。）

# ios - 将字符串转换为日期到带有时髦错误的字符串！（仅在设备上运行时）

> ID：12206775
> 
> 赞同：0
> 
> 时间：2012-08-30T22:58:28.277
> 
> 标签：ios, cocoa-touch, ios-simulator, nsdateformatter, nsdatecomponents

当我在我的设备上运行它（但不是在模拟器上）时，我遇到了最奇怪的错误：

我从 JSON 对象中获取日期，如下所示：

```
NSDateFormatter *df = [[NSDateFormatter alloc]init];
[df setDateFormat:@"EEE MMM d HH:mm:ss Z yyyy"];
NSDate *dateX = [df dateFromString: [info objectForKey:@"created_at"]];

NSUInteger desiredComponents = NSYearCalendarUnit | NSMonthCalendarUnit  | 
                               NSWeekCalendarUnit | NSHourCalendarUnit   | 
                               NSDayCalendarUnit  | NSMinuteCalendarUnit | 
                               NSSecondCalendarUnit;

NSDateComponents *elapsedTimeUnits = [[NSCalendar currentCalendar] 
                                      components:desiredComponents
                                      fromDate:dateX
                                      toDate:[NSDate date]
                                      options:0]; 
```

如您所见，我使用格式化程序将字符串转换为日期，这很有效。然后我创建 NSDateComponents，然后用它来做`elapsedTimeUnits.hour`等等`.day`来计算从`dateX`到`NSDate date`（现在）的时间量。

它有效！或者我认为，在模拟器上测试所有内容时。

我刚刚收到这个疯狂的错误消息，说 dateX 为零，但只有当我在我的设备上运行它时。所以每次我在模拟器中运行它时，它都会显示从日期开始的正确时间。当我在设备上运行它时，它会显示一个特定的日期，即 4 周、1 天和 23 小时前。我已经 NSLogged 了`[info objectForKey:@"created_at"]`，并且知道它得到了正确的日期作为开始的输入。显然，该应用程序无法在设备上进行从字符串到日期的转换，而是在模拟器上进行。从这里开始的一切都是我得到的输出：

```
2012-08-31 00:26:19.773 App[1676:907] *** -[__NSCFCalendar 
components:fromDate:toDate:options:]: fromDate cannot be nil

I mean really, what do you think that operation is supposed to mean with a nil fromDate?

An exception has been avoided for now.

A few of these errors are going to be reported with this complaint, 
then further violations will simply silently do whatever random thing 
results from the nil.

Here is the backtrace where this occurred this time 
(some frames may be missing due to compiler optimizations):

(

0   CoreFoundation                      0x36a5e8bf <redacted> + 86

1   App                                0x00082d67 -[NewsViewController tableView:cellForRowAtIndexPath:] + 478

2   UIKit                               0x384d1b81 <redacted> + 412

3   UIKit                               0x384b693b <redacted> + 1310

4   UIKit                               0x384cde17 <redacted> + 206

5   UIKit                               0x38489f2b <redacted> + 258

6   QuartzCore                          0x357d7e9b <redacted> + 214

7   QuartzCore                          0x357d7a39 <redacted> + 460

8   QuartzCore                          0x357d8975 <redacted> + 16

9   QuartzCore                          0x357d8353 <redacted> + 238

10  QuartzCore                          0x357d8161 <redacted> + 316

11  UIKit                               0x3849000b <redacted> + 126

12  CoreFoundation                      0x36a8caed <redacted> + 20

13  CoreFoundation                      0x36a8ade1 <redacted> + 276

14  CoreFoundation                      0x36a8b137 <redacted> + 742

15  CoreFoundation                      0x369fe39d CFRunLoopRunSpecific + 356

16  CoreFoundation                      0x369fe229 CFRunLoopRunInMode + 104

17  GraphicsServices                    0x353b331b GSEventRunModal + 74

18  UIKit                               0x384da8f9 UIApplicationMain + 1120

19  App                                0x0006107f main + 86

20  App                                0x0005f450 start + 40

) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T00:01:19.050

检查设备上的设置并确保 12/24 小时模式与设备区域设置一致。（美国 12 小时，世界其他大部分地区 24 小时。）

美元与甜甜圈发生冲突，使您陷入iOS“费用”。

看到[这个线程](https://stackoverflow.com/questions/6613110/what-is-the-best-way-to-deal-with-the-nsdateformater-locale-feature)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-18T12:50:48.913

我为我解决了这个问题。我希望这对任何人都有帮助。我的问题是注释的代码。我用这个注释代码下面的新书面代码解决了这个问题。代码如下：

```
//    NSDateFormatter *df = [[NSDateFormatter alloc] init];
    //    df.dateStyle = NSDateFormatterMediumStyle;
    //
    //    NSCalendar *calendar = [NSCalendar currentCalendar];
    //    int year   =    [[calendar components:NSYearCalendarUnit  fromDate:[datePickerView date]] year];
    //    int month  =    [[calendar components:NSMonthCalendarUnit fromDate:[datePickerView date]] month];
    //    int day    =    [[calendar components:NSDayCalendarUnit   fromDate:[datePickerView date]] day];
    //    

    NSDateComponents *components = [[NSCalendar currentCalendar] components:NSDayCalendarUnit | NSMonthCalendarUnit | NSYearCalendarUnit fromDate:[datePickerView date]];
    NSInteger day = [components day];
    NSInteger month = [components month];
    NSInteger year = [components year];

    date = [NSString stringWithFormat:@"%d-%d-%d",year,month, day];
    NSLog(@"Updated Date: %@",date); 
```

# c# - 如何将字符串/糟糕的 JSON 映射到 C# 对象成员？（最终到 MySQL 数据库）

> ID：12206777
> 
> 赞同：0
> 
> 时间：2012-08-30T22:58:37.777
> 
> 标签：c#, mysql, json, linq

（这是所有类型的背景，可以为您提供有关我的问题的背景信息。您可以跳到“问题”并阅读该内容，然后如果您想直截了当，可以返回并略读背景。抱歉，这是文字墙！）

* * *

我有一堆可怕的 JSON 需要存储在数据库中。本质上，有人使用 XML 的 XPath 将一个大的 XML 文件序列化为一个大的、扁平的 JSON 对象。这是我的意思的一个例子：

**原始 XML：**

```
<statistics>
    <sample>
        <date>2012-5-10</date>
        <duration>11.2</duration>
    </sample>
    <sample>
        <date>2012-6-10</date>
        <duration>13.1</duration>
    </sample>
    <sample>
        <date>2012-7-10</date>
        <duration>10.0</duration>
    </sample>
</statistics> 
```

* * *

**我必须使用的可怕 JSON：（**基本上只是上面的 XPath）

```
{
    "statistics":"",

    "statistics/sample":"",
    "statistics/sample/date":"2012-5-10",
    "statistics/sample/duration":"11.2",

    "statistics/sample@1":"",
    "statistics/sample/date@1":"2012-6-10",
    "statistics/sample/duration@1":"13.1",

    "statistics/sample@2":"",
    "statistics/sample/date@2":"2012-7-10",
    "statistics/sample/duration@2":"10.0",
} 
```

现在我需要把它放在一个数据库中，该数据库包含一个`statistics`带有`date`和`duration`列的表。

**我目前是如何做的：（**或者至少是一个简单的例子）

```
Tuple<string, string>[] jsonToColumn = // maps JSON value to SQL table column
{
    new Tuple<string, string>("statistics/sample/date", "date"),
    new Tuple<string, string>("statistics/sample/duration", "duration")
};

// Parse the JSON text
// jsonText is just a string holding the raw JSON
JavaScriptSerializer serializer = new JavaScriptSerializer();
Dictionary<string, object> json = serializer.DeserializeObject(jsonText) as Dictionary<string, object>;

// Duplicate JSON fields have some "@\d+" string appended to them, so we can
// find these and use them to help uniquely identify each individual sample.
List<string> sampleIndices = new List<string>();
foreach (string k in json.Keys)
{
    Match m = Regex.Match(k, "^statistics/sample(@\\d*)?$");
    if (m.Success)
    {
        sampleIndices .Add(m.Groups[1].Value);
    }
}

// And now take each "index" (of the form "@\d+" (or "" for the first item))
// and generate a SQL query for its sample.
foreach (string index in compressionIndices)
{
    List<string> values = new List<string>();
    List<string> columns = new List<string>();
    foreach (Tuple<string, string> t in jsonToColumn)
    {
        object result;
        if (json.TryGetValue(t.Item1 + index, out result))
        {
            columns.Add(t.Item2);
            values.Add(result);
        }
    }

    string statement = "INSERT INTO statistics(" + string.Join(", ", columns) + ") VALUES(" + string.Join(", ", values) + ");";
    // And execute the statement...
} 
```

但是，我想使用 ADO.NET 实体数据模型（或类似 LINQ 的东西）而不是这种骇客，因为我需要在插入和应用一些更新之前开始执行一些查询，并创建和执行我自己的 SQL 语句只是……很麻烦。我创建了一个 ADO.NET 实体数据模型 (.edmx) 文件并进行了设置，现在我可以轻松地使用该模型与我的数据库进行交互和写入。

* * *

**问题/问题**

问题是我不确定如何最好地将我的 JSON 映射到我的 ADO.NET 实体数据模型`Statistic`对象（代表表中的样本/记录`statistics`）。最简单的方法是更改​​我的`Tuple`列表以使用诸如指向成员的指针（`Tuple<string, Statistic::*Duration>("statistics/sample/duration", &Statistic::Duration)`如果这是 C++ 的话，那就太好了），但是 a）我什至认为这在 C# 中是不可能的，并且 b）即使它是我`Tuple`的都有不同的类型。

我在这里有哪些选择？如何最好地将 JSON 映射到我的`Statistic`对象？我对 LINQ 世界有点陌生，我想知道是否有办法（通过 LINQ 或其他方式）映射这些值。

这是我所处的次优位置（使用如此糟糕的 JSON），我认识到考虑到我的情况，我目前的方法可能比其他任何方法都好，如果是这样的话，我什至会接受它作为我的回答。但我真的很想探索将这个 JSON 映射到 C# 对象（并最终映射到 SQL 数据库）的选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T00:57:58.303

如果您使用 ORM（例如 EntityFramework），那么您只是在针对数据模型工作，因此假设您将定义一个模型类，例如...

```
public class Sample
{
    public string Date { get; set; }
    public double Duration { get; set; }
} 
```

然后你可以做这样的事情......

```
List<Sample> samples = new List<Sample>();
Dictionary<string, object> data = ser.DeserializeObject(json) as Dictionary<string, object>;
var keys =  data.Keys.ToList();
for (int i = 0; i <keys.Count; i++)
{
    string k = keys[i];
    if (Regex.IsMatch(k, "^statistics/sample(@\\d*)?$"))
    {
        samples.Add(new Sample
        {
            Date = (string)data[keys[i + 1]],
            Duration = double.Parse((string)data[keys[i + 2]])
        });
    }
} 
```

我只是为示例填充了一个列表，如果您使用的是 EntityFramework 之类的东西，那么您可以直接将实例添加到您的存储库/数据上下文中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T00:58:40.160

如果整个问题是将您必须的“JSON”映射到 POCO 实体，这里有一个关于如何使用 Custom 反序列化它的示例`JavascriptConverter`：

您的 POCO 实体：

```
public class Statistics
{
    public Statistics()
    {
        Samples = new List<Sample>();
    }

    public List<Sample> Samples { get; set; }
}

public class Sample
{

    public DateTime Date { get; set; }
    public float Duration { get; set; }
} 
```

您的 StatsConverter：

```
public class StatsConverter : JavaScriptConverter
{
    public override object Deserialize(IDictionary<string, object> dictionary, Type type, JavaScriptSerializer serializer)
    {
        if (dictionary == null)
            throw new ArgumentNullException("dictionary");
        else if (type == typeof(Statistics))
        {
            Statistics statistics = null;
            Sample sample = null;
            {
                foreach (var item in dictionary.Keys)
                {
                    if (dictionary[item] is string && item.Contains("duration"))
                        sample.Duration = float.Parse(dictionary[item].ToString());
                    else if (dictionary[item] is string && item.Contains("date"))
                        sample.Date = DateTime.Parse((dictionary[item].ToString()));
                    else if (dictionary[item] is string && item.Contains("sample"))
                    {
                        sample = new Sample();
                        statistics.Samples.Add(sample);
                    }
                    else if (dictionary[item] is string && item.Contains("statistics"))
                        statistics = new Statistics();
                }
            }
            return statistics;
        }
        return null;
    }    

    public override IDictionary<string, object> Serialize(object obj, JavaScriptSerializer serializer)
    {
        throw new NotImplementedException();
    }

    public override IEnumerable<Type> SupportedTypes
    {
        get { return new ReadOnlyCollection<Type>(new List<Type>(new Type[] { typeof(Statistics)})); }
    }
} 
```

现在是关于如何反序列化它的示例：

```
string json = @"{
""statistics"":"""",

""statistics/sample"":"""",
""statistics/sample/date"":""2012-5-10"",
""statistics/sample/duration"":""11.2"",

""statistics/sample@1"":"""",
""statistics/sample/date@1"":""2012-6-10"",
""statistics/sample/duration@1"":""13.1"",

""statistics/sample@2"":"""",
""statistics/sample/date@2"":""2012-7-10"",
""statistics/sample/duration@2"":""10.0"" 
```

}";

```
//These are the only 4 lines you'll require on your code
JavaScriptSerializer serializer = new JavaScriptSerializer();
StatsConverter sc = new StatsConverter();
serializer.RegisterConverters(new JavaScriptConverter[] { new StatsConverter() });
Statistics stats = serializer.Deserialize<Statistics>(json); 
```

`stats`上面的对象将反序列化为其集合中`Statistics`有 3 个对象的对象。`Sample``Samples`

# xcode - 如何将可执行二进制文件添加到 Xcode4 项目

> ID：12206778
> 
> 赞同：0
> 
> 时间：2012-08-30T22:58:47.820
> 
> 标签：xcode, cocoa, xcode4

我有一些二进制文件（可执行文件和一些动态库），我想将它们包含在应用程序包中。我该如何将它们添加到 xcode 中，例如存档时它们都已正确签名？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T06:02:30.620

您可以将二进制文件放在捆绑包中的任何位置。只需在您的目标中创建一个“复制文件”构建阶段。而且，**在**签署主包之前，您必须单独签署此二进制文件。您还可以创建“运行脚本”阶段并在此阶段内签署您的二进制文件。

```
codesign -s "authority" "${TARGET_BUILD_DIR}/path/to/your/lib.dylib" 
```

# git - git push heroku master 权限被拒绝（公钥）。致命：远端意外挂断

> ID：12206779
> 
> 赞同：85
> 
> 时间：2012-08-30T22:59:00.107
> 
> 标签：git, heroku

请原谅我有点沮丧，因为 Heroku 使用 SO 作为他们的客户支持（我认为至少可以说是粗制滥造的），所以我会尽量保持检查。

在过去的五个小时里，我一直在尝试发布一个应用程序，但总是会出现密钥问题。我已经阅读了数十篇文章，并尝试了一个又一个提示，以找出 Heroku 在愚蠢、完全不透明的过程中搞砸的地方。

我的用例并不难：我为我的 heroku 应用程序创建了一个新的密钥对。我已将该密钥设置为我的密钥：

```
 > heroku keys
  === travis@xxxx.com Keys
  ssh-rsa AAAAB3NzaC...avOqfA7ZBd travis@xxxx.com 
```

我可以毫无问题地登录并“创建”一个应用程序（愚蠢的名字，因为它似乎是在创建一个 git repo，而不是任何类型的应用程序）。但是*每次*我尝试推送我的应用程序时，我都会得到*：*

```
 > git push heroku master
  Permission denied (publickey).
  fatal: The remote end hung up unexpectedly 
```

我不知道 WTF 正在发生什么；我只是把头撞在键盘上，没有追索权，但希望谷歌的全能之神能回答它。谷歌没有回答它（好吧，让我收回，我已经看到了大约十几种方法来回答这个问题）。

对于一个应该很简单的系统来说，这是一个笑话。我喜欢 Heroku 的想法，但是在服用了 5 次之后完全*没有*做任何事情，我想这可能是错误的选择。

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2013-03-04T22:38:59.217

网络上有各种各样的解决方案。我将尝试将可用选项浓缩到一篇文章中。请在每一步后再次尝试连接。

*   第 1 步：尝试将您的公钥添加到 Heroku

    ```
    heroku keys:add ~/.ssh/id_rsa.pub // or just heroku keys:add and it will prompt you to pick one of your keys 
    ```

*   第 2 步：生成一组新的 SSH 密钥，然后再次尝试第一步

    [https://help.github.com/articles/generating-ssh-keys](https://help.github.com/articles/generating-ssh-keys)

*   第 3 步：验证和/或修改您的配置文件

    ```
    vim ~/.ssh/config

    Host heroku.com
    Hostname heroku.com 
    Port 22 
    IdentitiesOnly yes 
    IdentityFile ~/.ssh/id_rsa    <--- Should be your public SSH key
    TCPKeepAlive yes 
    User jsmith@gmail.com 
    ```

*   第 4 步：从 git 中删除 heroku 远程，重新创建连接，通过 heroku create 添加远程将只是新存储库的一个选项。请务必删除您最初尝试创建的旧存储库

    ```
     $ git remote rm heroku
     $ heroku create 
    ```

*   第 5 步：重新安装 Heroku Toolkit

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-06-08T23:33:36.827

您的 heroku 密钥和 github 密钥不同步。

*   确定要使用的密钥（建议创建一个新密钥，即 heroku_rsa）。

*   将密钥添加到 github。

*   **使用以下命令将相同**的密钥添加到 heroku：`heroku keys:add`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T19:20:12.550

[部署 heroku 代码时权限被拒绝（公钥）。致命：远端意外挂断](https://stackoverflow.com/questions/4269922/permission-denied-publickey-when-deploying-heroku-code-fatal-the-remote-end)

我认为这可能有你的解决方案，它至少对我有用

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-27T01:00:06.330

我遇到了同样的问题，这是我关于发生了什么的*理论：*

我很久以前就注册了 Heroku，给了他们我的 github 公钥。尝试通常`git push heroku master`时，它会查找我的私钥，在`~/.ssh/github_rsa`. 然后它会以您发布的消息静默失败。

但是，我稍后尝试`ssh`使用该标志进入另一台服务器`-i`来指定我的“身份文件”（即私钥），它提示我输入私钥的密码。在“解锁”私钥后，该`git push heroku master`命令起作用。一些结论：

*   虽然`ssh`会提示您输入身份文件的密码，但`git`不会。
*   如果您使用其他方法解锁身份文件，例如`ssh`，它将保持解锁状态以供您`git`使用。
*   似乎没有*任何*关于如何永久删除身份文件上的密码保护的文档，包括使用 common unix command `keytool`。
*   上述创建新公钥/私钥对的解决方案似乎是解决此密码问题的方法，但并不知道这是问题所在。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-23T15:21:30.957

对我来说，问题似乎是我在后台运行了 ssh-agent，并且没有添加相关的私钥。

```
ps -afe | grep ssh-agent

ssh-add ~/.ssh/id_rsa_heroku_github 
```

我还必须将公钥添加到 github（手动）和 heroku

```
heroku keys:add ~/.ssh/id_rsa_heroku_github.pub 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-15T00:36:25.897

如果其他解决方案都不适合您，请确保您使用自己**的**帐户而**不是*****root***帐户登录 linux shell。

这样，如果您使用不是 ssh 密钥所有者的用户运行，git 将查找错误的密钥进行身份验证

# python - 如何使用不同的 clsid 注册代码？

> ID：12206780
> 
> 赞同：0
> 
> 时间：2012-08-30T16:50:17.180
> 
> 标签：python, windows

我已经修改了 pywin 包演示，该演示创建了一个用于 excel 功能区栏的按钮。按下按钮后，所选文本将在命令行中运行，所选文本将被输出替换。

使用不同的 clsid 文件名组合注册程序时出现问题。我无法更改代码的 clsid 和/或文件名。如果我创建此文件的副本，修改并注册它，运行的 COM 对象是原始的 excelAddin.py，而不是我新修改的文​​件。我现在缺少 COM 注册过程中的一个步骤。我应该在哪里添加哪一行？

```
from win32com import universal
from win32com.server.exception import COMException
from win32com.client import gencache, DispatchWithEvents
import winerror
import pythoncom
from win32com.client import constants, Dispatch
import sys
import win32traceutil

# Support for COM objects we use.
gencache.EnsureModule('{00020813-0000-0000-C000-000000000046}', 0, 1, 3, bForDemand=True) # Excel 9
gencache.EnsureModule('{2DF8D04C-5BFA-101B-BDE5-00AA0044DE52}', 0, 2, 1, bForDemand=True) # Office 9

# The TLB defiining the interfaces we implement
universal.RegisterInterfaces('{AC0714F2-3D04-11D1-AE7D-00A0C90F26F4}', 0, 1, 0, ["_IDTExtensibility2"])
class ButtonEvent:
    def OnClick(self, button, cancel):
        import win32ui # Possible, but not necessary, to use a Pythonwin GUI
        import win32con
        import subprocess
        app = Dispatch("Word.Application")
        cmd = app.Selection

        #subprocess.Popen(str(cmd))
        cmdP = subprocess.Popen(str(cmd), shell = True, stdout = subprocess.PIPE)
        txt = cmdP.stdout.readlines()
        output = ''
        for line in txt:
            output += line

        app.Selection.TypeText(output)
        #win32ui.MessageBox(txt, "Python Test",win32con.MB_OKCANCEL)
        return cancel

class ExcelAddin:
    _com_interfaces_ = ['_IDTExtensibility2']
    _public_methods_ = []
    _reg_clsctx_ = pythoncom.CLSCTX_INPROC_SERVER
    #_reg_clsid_ = ""
    _reg_clsid_ = "{C5482ECA-F559-45A0-B078-B2036E6F011A}"
    #_reg_clsid_ = "{E44EF798-7FDF-4015-AED6-00234CBBBA77}"
    #_reg_clsid_ = "{91A89B71-56C0-4a76-BF1F-CF52E3671740}"
    _reg_progid_ = 'Juha.test'#"Python.Test.ExcelAddin2"
    _reg_policy_spec_ = "win32com.server.policy.EventHandlerPolicy"

    def __init__(self):
        self.appHostApp = None    

    def OnConnection(self, application, connectMode, addin, custom):
        print "OnConnection", application, connectMode, addin, custom
        try:
            self.appHostApp = application
            cbcMyBar = self.appHostApp.CommandBars.Add(Name="PythonBar", 
                                                       Position=constants.msoBarTop, 
                                                       MenuBar=constants.msoBarTypeNormal, 
                                                       Temporary=True)
            btnMyButton = cbcMyBar.Controls.Add(Type=constants.msoControlButton, Parameter="Greetings")
            btnMyButton=self.toolbarButton = DispatchWithEvents(btnMyButton, ButtonEvent)
            btnMyButton.Style = constants.msoButtonCaption
            btnMyButton.BeginGroup = True
            btnMyButton.Caption = "&Run..."
            btnMyButton.TooltipText = "Runs the selected text in command line"
            btnMyButton.Width = "34"
            cbcMyBar.Visible = True
        except pythoncom.com_error, (hr, msg, exc, arg):
            print "The Excel call failed with code %d: %s" % (hr, msg)
            if exc is None:
                print "There is no extended error information"
            else:
                wcode, source, text, helpFile, helpId, scode = exc
                print "The source of the error is", source
                print "The error message is", text
                print "More info can be found in %s (id=%d)" % (helpFile, helpId)

    def OnDisconnection(self, mode, custom):
        print "OnDisconnection"
        self.appHostApp.CommandBars("PythonBar").Delete
        self.appHostApp=None

    def OnAddInsUpdate(self, custom):
        print "OnAddInsUpdate", custom
    def OnStartupComplete(self, custom):
        print "OnStartupComplete", custom
    def OnBeginShutdown(self, custom):
        print "OnBeginShutdown", custom

def RegisterAddin(klass):
    import _winreg
    key = _winreg.CreateKey(_winreg.HKEY_CURRENT_USER, "Software\\Microsoft\\Office\\Word\\Addins")
    #key = _winreg.CreateKey(_winreg.HKEY_LOCAL_MACHINE, "Software\\Classes\\CLSID")
    subkey = _winreg.CreateKey(key, klass._reg_progid_)
    _winreg.SetValueEx(subkey, "CommandLineSafe", 0, _winreg.REG_DWORD, 0)
    _winreg.SetValueEx(subkey, "LoadBehavior", 0, _winreg.REG_DWORD, 3)
    _winreg.SetValueEx(subkey, "Description", 0, _winreg.REG_SZ, "Runs selection in command line and pastes output")
    _winreg.SetValueEx(subkey, "FriendlyName", 0, _winreg.REG_SZ, "cmdlineRunner")

def UnregisterAddin(klass):
    import _winreg
    try:
        _winreg.DeleteKey(_winreg.HKEY_CURRENT_USER, "Software\\Microsoft\\Office\\Word\\Addins\\" + klass._reg_progid_)
    except WindowsError:
        pass

if __name__ == '__main__':
    import win32com.server.register
    win32com.server.register.UseCommandLine(ExcelAddin)
    if "--unregister" in sys.argv:
        UnregisterAddin(ExcelAddin)
    else:
        RegisterAddin(ExcelAddin) 
```

# coldfusion - 如何在自定义 Web 服务的身份验证失败时返回正常错误

> ID：12206782
> 
> 赞同：0
> 
> 时间：2012-08-30T22:59:26.663
> 
> 标签：coldfusion, coldfusion-9

我有一个`<cflogin>`用于身份验证的 Web 服务启动并运行，当您提供**有效**的用户名/密码时，一切都按预期工作。我遇到的问题是，如果身份验证在一侧（客户端）**失败**`<cfinvoke>`，我会收到一个巨大的数据错误转储，而不是从服务返回的正常错误消息（即：“错误的用户名和/或密码。请联系您的管理员”）。

我正在使用 cflogin 方法来保护 Web 服务，如下所述：[help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec13a13-7fe0.html](http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec13a13-7fe0.html)

这是我在提供错误的用户名/和/或/密码时返回的 CFDUMP (DUMP.Diagnostics) 的片段：

```
Cannot perform web service invocation service_name. The fault returned when invoking the web service operation is:<br> <pre>AxisFault faultCode: {http://xml.apache.org/axis/}HTTP faultSubcode: faultString: (401)Unauthorized faultActor: faultNode: faultDetail: {}:return code: 401 &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt; &lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt; &lt;head&gt; &lt;title&gt;IIS 7.5 Detailed Error - 401.5 - Unauthorized&lt;/title&gt; &lt;style type=&quot;text/css&quot;&gt; &lt;!-- body{margin:0;font-size:.7em;font-family:Verdana,Arial,Helvetica,sans-serif;background:#CBE1EF;} code{margin:0;color:#006600;font-size:1.1em;font-weight:bold;} .config_source code{font-size:.8em;color:#000000;} pre{margin:0;font-size:1.4em;word-wrap:break-word;} ul,ol{margin:10px 0 10px 40px;} ul.first,ol.first{margin-top:5px;} fieldset{padding:0 15px 10px 15px;} .summary-container fieldset{padding-bottom:5px;margin-top:4px;} legend.no-expand-all{padding:2px 15px 4px 10px;margin:0 0 0 -12px;} legend... ''</pre> <br>The error occurred on line 25. 
```

我怀疑它与下面的片段（来自上面的文章）有关，但尝试返回字符串会导致“文件过早结束”错误：

```
<cfif not isAuthorized>
    <!--- If the user does not pass a user name/password, return a 401 error.  
    The browser then prompts the user for a user name/password. ---> 
    <cfheader statuscode="401">
    <cfheader name="WWW-Authenticate" value="Basic realm=""Test"""> 
    <cfabort> 
</cfif> 
```

# xcode - self presentModalViewController 在 ViewDidLoad 上不起作用？

> ID：12206787
> 
> 赞同：0
> 
> 时间：2012-08-30T22:59:40.990
> 
> 标签：xcode

我正在编写一个 iPhone 应用程序，我需要它使用 ViewDidLoad 中的 if 语句检查某些内容，如果它发现我拥有的 NSString 中没有任何内容，那么它会调用一个方法。它工作正常，我可以通过调用的方法进行 NSLog，但我不能这样做：
testing * test = [[testing alloc] initWithNibName:@"UserSetupViewController" bundle:nil];
[自我presentModalViewController：测试动画：否]；
有谁知道为什么？我可以用 IBAction 来做到这一点。这是怎么回事？我已经在视图中尝试了上述代码确实加载了 if 语句，但这也不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T23:11:33.683

改为在 viewDidAppear 中执行。您的视图可能甚至还不可见。

# vb.net - vb.net 如果文本框是一个字符串

> ID：12206788
> 
> 赞同：-1
> 
> 时间：2012-08-30T22:59:45.327
> 
> 标签：vb.net, visual-studio-2010

很抱歉标题不好，因为我不知道如何调用标题我想保存文本框值，如果它是一个整数到名称为 IP 的配置文件，如果它是一个字符串到名称 DNS 这是代码 ：

```
Public Class ServerSettings

Private Sub OK_Button_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles OK_Button.Click
    If IPHostInfo.Text = "" Then ' here if it's a string save it to my.settings.dns
        My.Settings.DNS() = IPHostInfo.Text

    Else : IPHostInfo.Text = ""
        My.Settings.IP() = IPHostInfo.Text 'and if it's an integer
    End If
    My.Settings.PORT() = IPInfo.Text
    My.Settings.TOut() = TOut.Text
    IPHostInfo.Text = IPHostInfo.Text
    IPInfo.Text = IPInfo.Text
    TOut.Text = TOut.Text
    Me.DialogResult = System.Windows.Forms.DialogResult.OK
    Me.Close()
End Sub

Private Sub Cancel_Button_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Cancel_Button.Click
    Me.DialogResult = System.Windows.Forms.DialogResult.Cancel
    Me.Close()
End Sub 
```

结束类

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T13:13:16.930

如果您需要确定字符串是否是有效的 IP 地址，我认为最简单的方法是简单地调用`IPAddress.TryParse`，例如：

```
If IPAddress.TryParse(IPHostInfo.Text, Nothing) Then
    ' It's an IP Address
    My.Settings.IP() = IPHostInfo.Text
Else
    ' It's not an IP Address, so it must be a DNS name
    My.Settings.DNS() = IPHostInfo.Text
End If 
```

# jquery - 除以css计算的宽度而不是jQuery的元素宽度属性

> ID：12206790
> 
> 赞同：1
> 
> 时间：2012-08-30T22:59:47.107
> 
> 标签：jquery, html, css

我目前有这个代码：

```
$('.blogimages img').css('marginLeft', function() { 
    return - $(this).width()/2;
}); 
```

但是，它采用的是`width="750"`属性，而不是使用我的样式表新计算的属性。

图像设置示例：

```
<div class="img-wrap" style="position: relative; ">
    <img class="insert-all wide" title="23" src="http://www.threefishfiesta.com/wp-content/uploads/2012/08/231.jpeg" alt="" width="750" height="500">
</div> 
```

CSS：

```
.client-small .img-wrap {
    width: 200px;
    height: 200px;
    overflow: hidden;
    text-align: center;
}

.img-wrap .wide{
    height: 100%;
    width: auto;
}

.img-wrap .tall{
    width: 100%;
    height: auto;
} 
```

有没有办法重写它以采用 css 生成的宽度而不是 html 属性宽度？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T00:40:10.577

您可以使用 outerWidth() - [http://api.jquery.com/outerWidth/](http://api.jquery.com/outerWidth/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T00:40:55.990

您是否尝试过获取 css 值？$(this).css('width')/2;

# javascript - 丢失引导程序的奥秘

> ID：12206791
> 
> 赞同：0
> 
> 时间：2012-08-30T22:59:54.967
> 
> 标签：javascript, jquery, web

在我的页面上，我将一个 javascript 文件添加到了 head 部分。网址是正确的。Javascript 文件存在于我的服务器上那个正确的 URL。我检查了 fiddler2，它显示从未为该文件发送服务器请求。该文件有一个简单的测试脚本

```
$(document).ready(function() {
alert("blah blah");
}); 
```

现在它工作得很好。每当我在该特定页面上工作 30 分钟时刷新页面时，它都会触发警报。我起身去拿苏打水和一些剩下的披萨。当然是爸爸约翰。但是当我回来刷新页面时.. javascript 文件不再显示引导到 head 部分。警报也不再触发。

```
<script type="text/javascript" src="js/events.js"></script> 
```

*   嗯，所以我清除了缓存。刷新，但没有。
*   试过 Firefox、Opera、IE、Safari 和 Chrome。没有。
*   检查服务器。仍然在那里，什么都没有。chmod 777 到文件及其目录。没有。
*   检查控制台是否有错误。没有错误，仍然没有。
*   保存文件并在记事本++中打开，检查显示所有字符（找到隐藏的危险键），没有什么不寻常的。只是回车和标签。但当然还是什么都没有。

脑洞大开。帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T23:17:52.270

我重新启动了我的服务器，神秘地它又开始工作了。我确信对此有完全合乎逻辑的解释，但这超出了我的知识范围。如果有人有解释，我真的很想听听。如果需要，我可以提取服务器日志。

但只要说它再次工作就足够了。

# javascript - 从文本链接触发的 JQuery UI 日期选择器

> ID：12206793
> 
> 赞同：2
> 
> 时间：2012-08-30T23:00:04.870
> 
> 标签：javascript, jquery, jquery-ui

我正在尝试设置我的 css 菜单，以便其中一个文本链接触发日期选择器日历打开。我已将所有内容简化为下面的代码。我遇到的问题是下面的代码不起作用但是当我删除 ul, li 标签时它开始工作。

我正在使用 1.8.0 JQuery 和 1.8.23 JQuery UI。

```
<!DOCTYPE html>
<head>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $("#dp").datepicker({
        onSelect: function(dateText, inst) {
            alert(dateText);
        },
    });

    $("#datep").click(function() {
        $("#dp").datepicker("show");
    });
});
</script>
</head>
<body>
<ul>
    <li><a href="#" id="datep">Test</a><input type="hidden" id="dp" /></li>
</ul>
</body>
</html> 
```

我注意到了一些奇怪的事情。如果我在 ul 下移动输入，它可以工作，但在点击几下后会出现错误，但如果我在该输入下添加空 div，那么它似乎会开始正常工作。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-30T23:32:19.280

所以这是一个错误。您必须在隐藏输入之后添加一个块级元素：

**HTML：**

```
<ul>
    <li><a href="#" id="datep">Test</a>
        <input type="hidden" id="dp" />
        <div></div>
    </li>
</ul>​ 
```

**示例：http:** [//jsfiddle.net/andrewwhitaker/LE2CG/1/](http://jsfiddle.net/andrewwhitaker/LE2CG/1/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-30T23:24:58.307

另一个**带有隐藏文本的版本：http:** [//jsfiddle.net/sKXJt/](http://jsfiddle.net/sKXJt/) **工作演示** [http://jsfiddle.net/BhqmY/](http://jsfiddle.net/BhqmY/)

这将有助于隐藏文本框：

*   [http://forum.jquery.com/topic/attaching-datepicker-to-an-icon-for-a-hidden-input-field](http://forum.jquery.com/topic/attaching-datepicker-to-an-icon-for-a-hidden-input-field)

*   [通过单击没有输入字段的图像打开 JQuery Datepicker](https://stackoverflow.com/questions/1112035/open-jquery-datepicker-by-clicking-on-an-image-w-no-input-field)

希望它会有所帮助，因为`:)`我不确定是否`:)`投反对票，请在此处查看带有隐藏文本的版本：http: [//jsfiddle.net/sKXJt/](http://jsfiddle.net/sKXJt/)

**代码**

```
$(document).ready(function() {
    $("#dp").datepicker({
        onSelect: function(dateText, inst) {
            alert(dateText);
        },
    });

    $('#datep').click(function() {
        $('#dp').datepicker('show');
    });

});​ 
```

**工作形象**

![在此处输入图像描述](../Images/f45769f5f0a99a7ab917a8cea00c997d.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-12T18:56:58.973

由于我在整个项目中都在使用它，因此我创建了一个紧凑的 jQuery 插件来执行此操作，并决定分享。

JSFiddle：[https ://jsfiddle.net/yahermann/xyjhyqma/](https://jsfiddle.net/yahermann/xyjhyqma/)

HTML：

```
<span class="some-datepicker-class">
  <a href="(some link)" data-date-param="(some date param)">(some initial date)</a>
</span> 
```

JAVASCRIPT：

```
$('span.some-datepicker-class').datepicker_link();  // see jsfiddle for options 
```

默认的 onSelect 处理程序采用初始 HTML 中设置的可选链接和日期参数。如果两者都提供，则在选择新日期后，插件将加载提供的链接并将所选日期作为值包含到提供的参数中。例子：

```
<a href="http://example.com" data-date-param="mydate">2018-05-05</a> 
```

将显示初始日期 2018-05-05。选择新日期后，插件将加载以下页面：[http://example.com?mydate=(new_date)](http://example.com?mydate=(new_date))

如果不需要此功能，只需设置 href="#" 和/或提供您自己的 onSelect 回调。

# java - 您的机器上有多个 GAE SDK 实例会导致冲突吗？

> ID：12206795
> 
> 赞同：2
> 
> 时间：2012-08-30T23:00:30.613
> 
> 标签：java, google-app-engine, ant, sdk, google-eclipse-plugin

我想为我的 Eclipse 实例安装 Google-Eclipse 插件（我*相信*它也安装了 GAE SDK），这样我就可以利用它附带的许多 IDE 工具和功能，也让我可以从 Eclipse 内部运行我的应用程序。

我还想只安装纯 GAE SDK，以便我可以在常规系统上在 Eclipse 之外运行我的应用程序。

因为 GAE SDK 是一个多样化和复杂的野兽，我担心在同一台机器上安装两个 GAE SDK 实例（设置冲突的 ENV VAR，尝试打开相同的端口号等）。

显然，我会注意不要同时运行 2 个 GAE 开发服务器（1 个带有 Eclipse 插件，另一个带有纯 SDK），但这可能不能保证我有 0 个冲突。

*如果*有一种方法可以配置它附带的 GAE SDK 以从 Eclipse 和 bash shell 运行，我也可以只安装 Eclipse 插件。这可能是最简单的，但我不相信这是可能的。

关于我的选择有什么想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T15:32:55.303

您可以通过安装一个 SDK 并将其用于 Eclipse 和 bash shell 来实现。

您可以按照以下步骤进行操作：

1.  [从这里](https://developers.google.com/appengine/downloads)下载合适的 GAE SDK并安装它。
2.  打开 Eclipse 并选择帮助->安装新软件。
3.  在***使用框中***输入 url 作为`http://dl.google.com/eclipse/plugin/4.2`并从可用软件列表中仅选择“ ***Google Plugin for Eclipse*** ”软件并选择任何其他必需**的插件，但不选择** ***SDK***。保持不检查！
4.  安装选定的插件后，在 Window->Preferences->Google->AppEngine 单击添加，然后选择安装目录作为步骤 1 中的目录并给出合适的名称。将其设为默认值。

现在你可以走了。
如果需要从 shell 运行，请`dev_appserver`从安装目录调用。或者，如果您想从 Eclipse 运行，只需从那里运行它。

# c - 从正在用 C 修改的文件中读取

> ID：12206802
> 
> 赞同：1
> 
> 时间：2012-08-30T23:01:10.770
> 
> 标签：c, unix

我有一个程序正在将结果写入文件，我想从该文件中实时读取。它是一个普通的文本文件，外部程序总是写一整行。我只需要在 Linux 系统上运行它。

```
int last_read = 0;
int res;
FILE *file;
char *buf;
char *end = buf + MAXLINE - 1;
int c;
int fileSize;
char *dst;
while (external_programme_is_running()) {
   file = fopen(logfile, "r"); //without opening and closing it's not working
   fseek(file, 0, SEEK_END);
   fileSize = ftell(file);
   if (fileSize > last_read) {
      fseek(file, last_read, SEEK_SET);
      while (!feof(file)) {
        dst = buf;
        while ((c = fgetc(file)) != EOF && c != '\n' && dst < end)
            *dst++ = c;
        *dst = '\0';
        res = ((c == EOF && dst == buf) ? EOF : dst - buf);

         if (res != -1) {
            last_read = ftell(file);
            parse_result(buf)
         }
      }
  }
  fclose(file);
} 
```

这是一个正确的方法吗？或者检查修改时间然后打开文件会更好吗？如果文件同时被修改，读取是否可能会崩溃？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-30T23:54:47.133

为了避免每次循环迭代都需要关闭、重新打开和重新查找，请`clearerr`在读取 EOF 后调用流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-30T23:09:33.803

如果您在其他程序写入的同时阅读，您应该没有任何问题。最糟糕的情况是直到下次打开文件时才能看到写入的内容。

此外，您将最后一次查找位置与文件末尾进行比较的方法是查找文件添加内容的好方法，因为外部程序只是编写额外的行。不过，我建议您在循环结束时添加一个 sleep(1)，这样您就不会使用大量 CPU。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T23:39:26.333

在另一个进程正在写入文件时读取文件没有问题。标准`tail -f`实用程序经常用于该目的。

唯一需要注意的是，写入过程不能以独占方式锁定文件。

关于您读取的代码（即使用`fgetc()`），由于您说写入过程将一次写入一行，因此您可能需要查看`fgets()`。

# ruby - 需要基本的 rspec 帮助来测试类行为和命令行输出

> ID：12206805
> 
> 赞同：0
> 
> 时间：2012-08-30T23:01:39.007
> 
> 标签：ruby, rspec

我花了 3 个小时来主演这个，需要一些帮助。

我对 RSpec 很陌生，我正在尝试为我的一个名为“游戏”的类的行为编写测试

我想测试一下，当调用 game.play 时会向输出发送一个 3x3 网格……这就是我想要做的。我有 RSpec 书，我正在努力弄清楚这一点，但我很难过。我已将我认为关键的地方标记为“FIXME”

到目前为止，这是我的测试...

```
require_relative '../spec_helper'

# the universe is vast and infinite....and...it is empty

describe "the game class" do
  it "must output a 3x3 game grid on the CLI" do
    player_h = double('human', :player_h => "X") # FIXME - do I stub or mock this?
    player_c = double('computer', :player_c => "O")# FIXME - do I stub or mock this?
    game = Game.new(player_h, player_c)

    #FIXME - how do I get the line below to read this as if it where coming from SDOUT on the cli?
    should_receive(:puts).with("a #{$thegrid[:a1]}|#{$thegrid[:a2]}|#{$thegrid[:a3]} \n")
    game.play
  end
  it "must have a human player" do
    pending "human is X"
  end
  it "must have a computer player" do
    pending "ai is O"
  end
end 
```

这是我正在构建这个测试的课程（是的，我知道那是倒退的......我应该编写测试然后编写代码......但就像我说的，我是一个菜鸟......整个游戏代码都已经写好了……我现在真的只是想了解 RSpec。）……

```
require_relative "player"
#
#Just a Tic Tac Toe game class
class Game
  #create players
  def initialize(player_h, player_c)
    #bring into existence the board and the players
    @player_h = player_h
    @player_c = player_c
    #value hash for the grid lives here
    $thegrid = {
        :a1=>" ", :a2=>" ", :a3=>" ",
        :b1=>" ", :b2=>" ", :b3=>" ",
        :c1=>" ", :c2=>" ", :c3=>" "
    }
    #make a global var for drawgrid used by player
    $gamegrid = drawgrid

  end
  #display grid on console
  def drawgrid

    board = "\n"
    board << "a #{$thegrid[:a1]}|#{$thegrid[:a2]}|#{$thegrid[:a3]} \n"
    board << "----------\n"
    board << "b #{$thegrid[:b1]}|#{$thegrid[:b2]}|#{$thegrid[:b3]} \n"
    board << "----------\n"
    board << "c #{$thegrid[:c1]}|#{$thegrid[:c2]}|#{$thegrid[:c3]} \n"
    board << "----------\n"
    board << "  1 2 3 \n"
    return board

  end
  #start the game
  def play
    #draw the board
    puts drawgrid
    #make a move
    #alternate player turns
  end

end 
```

非常感谢任何指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T00:01:05.100

IIRC 在 RSpec 书中他们传递了一个 IO 对象，该对象在测试中被模拟，但如果您希望`STDOUT`收到 put，它也应该工作：

```
STDOUT.should_receive(:puts).with("foo") 
```

# clojure - 如何创建惰性序列向量

> ID：12206806
> 
> 赞同：5
> 
> 时间：2012-08-30T23:01:44.543
> 
> 标签：clojure, lazy-sequences

运行它按预期工作：

```
(defn long-seq [n]
  (lazy-seq (cons 
             (list n {:somekey (* n 2)})
             (long-seq (+ n 1)))))
(take 3 (long-seq 3))
; => ((3 {:somekey 6}) (4 {:somekey 8}) (5 {:somekey 10})) 
```

但是我想对向量做同样的事情：

```
(defn long-seq-vec [n]
  (lazy-seq (into 
             (vector (list n {:somekey (* n 2)}))
             (long-seq-vec (+ n 1)))))
(take 3 (long-seq-vec 3)) 
```

这给了我一个堆栈溢出。为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-31T00:44:22.147

主要原因是**向量不是惰性**的——所以`into`调用贪婪地消耗产生的递归序列`long-seq-vec`并导致堆栈溢出。作为这个推论，不可能创建一个无限向量（通常，如果它是惰性或循环的，您只能创建一个无限数据结构）。

它在第一个示例中起作用，因为`cons`当 consing 到一个惰性序列的前面时，它很乐意表现出惰性，因此该序列可以是无限的。

假设您实际上想要一个无限的向量序列，我建议您这样做：

```
(defn long-seq-vec [n]
  (lazy-seq (cons 
              (vector n {:somekey (* n 2)})
              (long-seq-vec (+ n 1)))))

(take 3 (long-seq-vec 3))

=> ([3 {:somekey 6}] [4 {:somekey 8}] [5 {:somekey 10}]) 
```

或者作为替代方案，您可以使用`for`其本身是惰性的：

```
(defn long-seq-vec [n]
  (for [x (iterate inc n)]
    (vector x {:somekey (* x 2)}))) 
```

我更喜欢这个，因为它避免了`lazy-seq`/`cons`样板，避免了递归，并且在表达你的函数的作用时稍微更清楚......如果你愿意，它会更“声明性”。您也可以`map`以类似的方式使用。

# objective-c - UITableView 没有取消选择？

> ID：12206807
> 
> 赞同：0
> 
> 时间：2012-08-30T23:01:50.337
> 
> 标签：objective-c, ios, cocoa-touch

我在 xib 文件中有一个非常简单的 tableview，它的委托和数据源连接到 TestVC。TestVC 很简单：

```
#import "TestVC.h"

@implementation TestVC

- (UITableViewCell *)tableView:(UITableView *)_tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *IDEN = @"IDEN";
    UITableViewCell *cell = [_tableView dequeueReusableCellWithIdentifier:IDEN];
    if (!cell) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:IDEN];
    }

    cell.textLabel.text = @"test";
    return cell;

}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return 10;

}

- (void)tableView:(UITableView *)_tableView didDeselectRowAtIndexPath:(NSIndexPath *)indexPath {
    NSLog(@"called");
    [_tableView deselectRowAtIndexPath:indexPath animated:YES];
}

@end 
```

当我单击一个单元格时，它不会被取消选择。我什至在那里放了一条日志语句，以查看是否调用了 didDeselectRowAtIndexPath 方法并且确实如此。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T23:05:00.377

您使用了错误的方法 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath

是你需要的

# mysql - 无法连接到部署到 CloudBees 的应用程序上的主机 MySQL 数据库

> ID：12206808
> 
> 赞同：1
> 
> 时间：2012-08-30T23:01:52.860
> 
> 标签：mysql, cloudbees

我按照[此处](https://run.cloudbees.com/a/xinco#db-manage%3axincodemo)的说明进行操作，但尝试时出现以下错误：

```
hudson.util.IOException2: remote file operation failed: /scratch/jenkins/workspace/Xinco Demo Publish/Xinco/target/Xinco-2012-08-30_00-20-05.war at hudson.remoting.Channel@1fc6bdea:s-50b0ae50
    at hudson.FilePath.act(FilePath.java:783)
    at hudson.FilePath.act(FilePath.java:769)
    at com.cloudbees.plugins.deployer.DeployPublisher.perform(DeployPublisher.java:108)
    at hudson.tasks.BuildStepMonitor$1.perform(BuildStepMonitor.java:19)
    at hudson.model.AbstractBuild$AbstractRunner.perform(AbstractBuild.java:707)
    at hudson.model.AbstractBuild$AbstractRunner.performAllBuildSteps(AbstractBuild.java:682)
    at hudson.model.AbstractBuild$AbstractRunner.performAllBuildSteps(AbstractBuild.java:660)
    at hudson.model.Build$RunnerImpl.post2(Build.java:162)
    at hudson.model.AbstractBuild$AbstractRunner.post(AbstractBuild.java:629)
    at hudson.model.Run.run(Run.java:1433)
    at hudson.model.FreeStyleBuild.run(FreeStyleBuild.java:46)
    at hudson.model.ResourceController.execute(ResourceController.java:88)
    at hudson.model.Executor.run(Executor.java:238)
Caused by: hudson.remoting.ProxyException: hudson.util.IOException2: Server.InternalError - Invalid WEB-INF/cloudbees-web.xml: resource
    at com.cloudbees.plugins.deployer.deployables.Deployable.deployFile(Deployable.java:151)
    at com.cloudbees.plugins.deployer.deployables.Deployable$DeployFileCallable.invoke(Deployable.java:342)
    at hudson.FilePath$FileCallableWrapper.call(FilePath.java:2048)
    at hudson.remoting.UserRequest.perform(UserRequest.java:118)
    at hudson.remoting.UserRequest.perform(UserRequest.java:48)
    at hudson.remoting.Request$2.run(Request.java:287)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662)
Caused by: hudson.remoting.ProxyException: com.cloudbees.api.BeesClientException: Server.InternalError - Invalid WEB-INF/cloudbees-web.xml: resource
    at com.cloudbees.api.BeesClient.readResponse(BeesClient.java:850)
    at com.cloudbees.api.BeesClient.applicationDeployArchive(BeesClient.java:435)
    at com.cloudbees.plugins.deployer.deployables.Deployable.deployFile(Deployable.java:123)
    ... 11 more
Build step 'Deploy to CloudBees' marked build as failure 
```

完整的输出可以在[这里](https://xinco.ci.cloudbees.com/job/Xinco%20Demo%20Publish/4/console)看到。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-31T01:24:15.513

```
Caused by: hudson.remoting.ProxyException: com.cloudbees.api.BeesClientException: Server.InternalError - Invalid WEB-INF/cloudbees-web.xml: resource 
```

Your `cloudbees-web.xml` doesn't follow the correct format.

See [http://wiki.cloudbees.com/bin/view/RUN/CloudBeesWebXml](http://wiki.cloudbees.com/bin/view/RUN/CloudBeesWebXml) - as the `cloudbees-web.xml` needs to be wrapped in an outer `<cloudbees-web-app>` element

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T11:35:40.593

如果您不想，也不必使用 cloudbees-web.xml - 如果您将应用程序绑定到数据库，它会自动将其作为命名数据源提供。

（参见 bees app:bind 命令）。

您只需执行一次 - 然后应用程序就会知道数据源。

[http://developer.cloudbees.com/bin/view/RUN/Resource+Management](http://developer.cloudbees.com/bin/view/RUN/Resource+Management)

和

[https://developer.cloudbees.com/bin/view/RUN/DatabaseGuide](https://developer.cloudbees.com/bin/view/RUN/DatabaseGuide)

（对不起，仍在处理文档）。

# android - 在android媒体控制器上显示时间

> ID：12206813
> 
> 赞同：1
> 
> 时间：2012-08-30T23:02:49.957
> 
> 标签：android, android-videoview, mediacontroller

我错过了什么吗？使用 videoview 播放视频后，我无法在媒体控制器上看到视频的当前时间。（在 ICS 设备上运行应用程序，没有时间；但是在 Honeycomb 设备上，有时间）

代码：

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    VideoView videoView = (VideoView) findViewById(R.id.videoView);
    // Use a media controller so that you can scroll the video contents
    // and also to pause, start the video.
    MediaController mediaController = new MediaController(this);
    mediaController.setAnchorView(videoView);
    videoView.setMediaController(mediaController);
    videoView
            .setVideoURI(Uri
                    .parse("rtsp://v6.cache5.c.youtube.com/CiILENy73wIaGQmCZld_oqDeJhMYDSANFEgGUgZ2aWRlb3MM/0/0/0/video.3gp"));
    videoView.start();

} 
```

实际上我注意到时间在那里，但它是如此昏暗，我看不到它。有什么办法可以改变媒体控制器的主题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T18:16:39.117

答案对于所有控制器来说都是通用的，例如媒体控制器、对话框、吐司等。您可以使用 ContextThemeWrapper：

而不是： MediaController mediaController = new MediaController(this);

你可以使用： MediaController mediaController = new MediaController(new ContextThemeWrapper(this,R.style.CustomTheme));

# jqgrid - 有什么方法可以使用对象的函数作为 jqGrid 数据数组的值？

> ID：12206816
> 
> 赞同：1
> 
> 时间：2012-08-30T23:03:13.827
> 
> 标签：jqgrid

我正在使用 jqGrid 来显示一组 JavaScript 对象。我要显示的值之一是对象的函数，而不是属性。在下面的示例中，所有值都是属性，但 'timeliness()' 是一个计算交货日期和到期日期之间差异并返回及时性值的函数。

```
$("#list").jqGrid({
  datatype: 'local',
  data: assignments,
  colNames: ['Project', 'Date Due', 'Date Delivered', "Timeliness"],
  colModel: [
    {name: 'project.title', index: 'project.title', width: 100}, 
    {name: 'title', index: 'title', width: 250}, 
    {name: 'dueDate',index: 'dueDate', width: 100},
    {name: 'deliveryDate', index: 'deliveryDate', width: 100},
    {name: 'timeliness()', index: 'timeliness()', width: 100}
  ],
  sortname: 'Project',
  rowNum: 10000,
  sortorder: 'asc',
  viewrecords: true,
  loadonce: true,
  gridview: true,
  height: 'auto',
  caption: 'Projects'
}); 
```

如图所示，我已经尝试过了，没有调用该函数，也没有返回任何值。我试过不带括号（例如名称：及时性），并且正如预期的那样，它返回函数定义。

使用格式化程序有效，但它让我无法对列进行排序（这是用户想要排序的列）。我想解决这个问题的另一种方法是简单地为这个对象创建一个新属性，并在我将它传递到要显示的网格之前将它设置在所有对象上（一旦在网格中我不期望值改变）。只是想知道这在 jqGrid 中是否可行，也许我只是没有正确处理这个字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T14:11:31.370

> 我想解决这个问题的另一种方法是简单地为这个对象创建一个新属性，并在我将它传递到要显示的网格之前将它设置在所有对象上（一旦在网格中我不期望值改变）

这是最简单的解决方案。请记住，jqGrid 旨在处理许多不同类型的数据源，其中大多数涉及来自外部源（例如 XML 或 JSON）的数据，其中函数不适用。

# java - 什么是 Java 原始数据类型修饰符？

> ID：12206819
> 
> 赞同：6
> 
> 时间：2012-08-30T23:03:26.433
> 
> 标签：java, primitive, prefix, primitive-types, modifier

好吧，我已经用 Java 编程了三年的大部分时间，现在，我认为自己非常有经验。然而，在查看 Java SE 源代码时，我遇到了一些我没想到的事情：

在`class` `Double`：

```
public static final double MIN_NORMAL = 0x1.0p-1022; // 2.2250738585072014E-308

public static final double MIN_VALUE = 0x0.0000000000001P-1022; // 4.9e-324 
```

我没想到这一点，无法找出它的意思。如果你不知道，我指的是在这些数字之后，减法运算符之前的`p`and 。`P`我知道您可以使用后缀将数字强制为`double`, `long`,`float`等，但我从未遇到过`p`or `P`。我检查[了 Java API](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)，但没有提及。**某处是否有*完整*的 Java 原始数字文字修饰符列表？有人认识他们吗？**

作为参考，以下是我使用或遇到的那些，其目的用粗体带问号（`#`代表各自限制内的任意数字）使我难以理解：

后缀：

*   `#`= 32 位整数`int`
*   `#L`= 64 位整数`long`
*   **`#l`= 另一个 64 位整数`l`？**
*   `#f`= 32 位浮点`float`
*   **`#F`= 另一个 32 位浮点数`float`？**
*   `#d`= 64 位浮点`double`
*   **`#D`= 另一个 64 位浮点数`double`？**
*   `#e#`= 科学记数法
*   **`#E#`= 另一个科学记数法？**
*   **`#p`= ?**
*   **`#P`= ?**
*   **还有吗？**

前缀：

*   `0b#`= 二进制（以 2 为基数）文字
*   **`0B#`=另一个二进制（基数2）文字？**
*   `0#`= 八进制（以 8 为基数）文字
*   `#`= 十进制（以 10 为底）文字
*   `0x#`= 十六进制（以 16 为基数）文字
*   **`0X#`= 另一个十六进制（以 16 为底）文字？**
*   **还有吗？**

其他（**这些有后缀或前缀吗？**）：

*   `(byte)#`= 8 位整数`byte`
*   `(short)#`= 16 位整数`short`
*   `(char)#`- 32 位字符`char`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-30T23:08:06.067

P 是指数。不管是不是资本。

根据[Javadoc`toHextString`](http://docs.oracle.com/javase/6/docs/api/java/lang/Double.html#toHexString(double))（我们知道正在使用它，因为它以 开头`0x`：

> `public static String toHexString(double d)`返回双参数的十六进制字符串表示。下面提到的所有字符都是 ASCII 字符。如果参数为 NaN，则结果为字符串“NaN”。否则，结果是一个字符串，表示参数的符号和大小。如果符号为负，则结果的第一个字符为'-'（'\u002D'）；如果符号为正，则结果中不会出现符号字符。至于大小 m：
> 
> *   如果m为无穷大，则用字符串“Infinity”表示；因此，正无穷产生结果“Infinity”，负
>     无穷产生结果“-Infinity”。
>     
>     
> *   如果 m 为零，则用字符串“0x0.0p0”表示；因此，负零产生结果“-0x0.0p0”，正零产生结果“0x0.0p0”。
>     
>     
> *   如果 m 是具有标准化表示的双精度值，则使用子字符串来表示有效数字和指数字段。有效数字由字符“0x1”表示。后跟小写十六进制表示的有效数字的其余部分作为分数。除非所有数字都为零，否则十六进制表示中的尾随零被删除，在这种情况下使用单个零。接下来，**指数由“p”表示，后跟无偏指数的十进制字符串，**就好像通过对指数值调用 Integer.toString 产生的一样。
>     
>     
> *   如果 m 是具有次正规表示的双精度值，则有效数字由字符“0x0”表示。后跟以分数表示的其余有效数字的十六进制表示。十六进制表示中的尾随零被删除。接下来，指数由“p-1022”表示。请注意，次正规有效数中必须至少有一个非零数字。

根据[JLS](http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.10)，接受以下语法：

`3.10.1\. Integer Literals`

> `IntegerTypeSuffix`：
> 
> *   l
> *   大号
> 
> 八进制数：
> 
> *   0 个八进制数
> *   0 下划线 OctalDigits
> 
> 十六进制数：
> 
> *   0 x 十六进制数
> *   0 X 十六进制数
> 
> 二进制数字：
> 
> *   0 b 二进制数
> *   0 B 二进制数

`3.10.2\. Floating-Point Literals`

> 指数指标：其中之一
> 
> *   e
> *   乙
> 
> FloatTypeSuffix：其中之一
> 
> *   F
> *   F
> *   d
> *   D
> 
> 十六进制符号：
> 
> *   十六进制数
> *   十六进制数。
> *   0 x HexDigitsopt 。十六进制数
> *   0 X HexDigitsopt 。十六进制数
> 
> BinaryExponentIndicator：其中之一
> 
> *   p
> *   磷

没有为这些目的指定其他单字符文字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-30T23:09:39.763

声明文字的所有合法方式都在[JLS](http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.10)中定义。

*   `p`or`P`是一个数字的二进制指数。
*   `l`或`L`定义一个`long`.
*   `f`或`F`定义一个`float`.
*   `d`或`D`定义一个`double`.
*   `0B`或`0b`定义二进制文字。
*   `0x`或`0X`定义十六进制文字。
*   `e`or`E`也是一个指数，但因为`e`是十六进制的有效字符，`p`所以也被使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-30T23:12:00.203

`P`或者`p`是一个`BinaryExponentIndicator`。请参阅 Java 语言规范。

请参阅[http://docs.oracle.com/javase/specs/jls/se5.0/html/lexical.html#3.10.2](http://docs.oracle.com/javase/specs/jls/se5.0/html/lexical.html#3.10.2)

# asp.net-mvc - 如何根据角色在登录方法上重定向 asp.net 会员用户

> ID：12206822
> 
> 赞同：0
> 
> 时间：2012-08-30T23:03:57.593
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-membership, forms-authentication

我正在使用具有 .net 成员资格的 MVC3。我想根据用户的角色将用户重定向到不同的视图。

我尝试使用 AccountControler 控制器的 LogOn 方法来使用 User.IsInRole(xxx) 但它不起作用。从我在这里看到的： [Forms Authentication User.IsInRole() random not working in LogOn](https://stackoverflow.com/questions/11919538/forms-authentication-user-isinrole-randomly-not-working-in-logon)

无法在该方法上调用会员用户（因为它没有登录，尚未设置用于登录用户的cookie）

我认为这无关紧要，但以防万一，这是 MVC3 项目中默认提供的 LogOn 方法，也是我尝试修改的方法。

```
 [HttpPost]
    public ActionResult LogOn(LogOnModel model, string returnUrl)
    {
        if (ModelState.IsValid)
        {
            if (Membership.ValidateUser(model.UserName, model.Password))
            {
                FormsAuthentication.SetAuthCookie(model.UserName, model.RememberMe);
                if (Url.IsLocalUrl(returnUrl) && returnUrl.Length > 1 && returnUrl.StartsWith("/")
                    && !returnUrl.StartsWith("//") && !returnUrl.StartsWith("/\\"))
                {
                    return Redirect(returnUrl);
                }
                else
                {
                    return RedirectToAction("Index", "Home");
                }
            }
            else
            {
                ModelState.AddModelError("", "The user name or password provided is incorrect.");
            }
        }

        // If we got this far, something failed, redisplay form
        return View(model);
    } 
```

我的问题是：在登录时根据用户的角色（我只有几个角色）重定向用户的优雅方法是什么？我看到一些建议说“只需查询会员数据库”，但我认为这不是正确的方法。

有什么建议吗？

谢谢！..

即插即用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T23:06:20.817

既然你链接到我的问题，这就是我发现的。`User.IsInRole()`从响应中获取用户名。由于操作中没有用户名`log on`（不使用 Model.UserName 查找），因此不会在角色中找到用户。如果你重定向它们，用户信息将被添加到重定向中，它可以按角色对用户进行排序。（至少我认为这是我发现的。）这就是你想要做的：

在您的帐户控制器中替换：

```
if (Membership.ValidateUser(model.UserName, model.Password))
{
    FormsAuthentication.SetAuthCookie(model.UserName, model.RememberMe);
    if (Url.IsLocalUrl(returnUrl) && returnUrl.Length > 1 && returnUrl.StartsWith("/")
                && !returnUrl.StartsWith("//") && !returnUrl.StartsWith("/\\"))
    {
        return Redirect(returnUrl);
    }
    else
    {
        return RedirectToAction("Index", "Home");
    }
} 
```

和：

```
if (Membership.ValidateUser(model.UserName, model.Password))
{
    FormsAuthentication.SetAuthCookie(model.UserName, model.RememberMe);
    if (Url.IsLocalUrl(returnUrl) && returnUrl.Length > 1 && returnUrl.StartsWith("/")
                && !returnUrl.StartsWith("//") && !returnUrl.StartsWith("/\\"))
    {
        return Redirect(returnUrl);
    }
    else
    {
        return RedirectToAction("Redirect", "Account");
    }
} 
```

并添加：

```
public ActionResult Redirect()
{ 
    if(User.IsInRole("Role1"))
        return RedirectToAction("Index", "Home")
    else if(User.IsInRole("Role2"))
        return RedirectToAction("SomethingElse", "Home")
    else
        return RedirectToAction("AnotherThing", "Home")
} 
```

# gcc - 为什么 rsyslogd 找不到 libgcc_s.so.1？

> ID：12206827
> 
> 赞同：10
> 
> 时间：2012-08-30T23:04:26.720
> 
> 标签：gcc, ubuntu, rsyslog, lxc, libgcc

场景：在 Ubuntu 12.4 lxc 主机（均为 64 位）上运行 debootstrapped Ubuntu 11.4 lxc guest

在 lxc 来宾内部，rsyslogd 不断崩溃并显示 SIGABRT 声明：

```
libgcc_s.so.1 must be installed for pthread_cancel to work
0334.380551272:7f4128a84700: 
Signal 6 (SIGABRT) occured, execution must be terminated. 
```

我不确定为什么找不到 libgcc_s.so.1。如果我运行 ldconfig -p：

```
$# ldconfig -p | grep libgcc
        libgcc_s.so.1 (libc6,x86-64) => /lib/x86_64-linux-gnu/libgcc_s.so.1
        libgcc_s.so.1 (libc6) => /usr/lib32/libgcc_s.so.1 
```

它被列出。这两个链接都是有效的。

我该如何解决这个问题？

编辑：objdump -T 请求输出：

```
/lib/x86_64-linux-gnu/libgcc_s.so.1:     file format elf64-x86-64

DYNAMIC SYMBOL TABLE:
00000000000025d8 l    d  .init  0000000000000000              .init
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 memset
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 abort
0000000000000000  w   D  *UND*  0000000000000000              __gmon_start__
0000000000000000  w   D  *UND*  0000000000000000              _Jv_RegisterClasses
0000000000000000  w   D  *UND*  0000000000000000              pthread_key_create
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 malloc
0000000000000000  w   D  *UND*  0000000000000000              pthread_once
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 free
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 strlen
0000000000000000  w   D  *UND*  0000000000000000              pthread_getspecific
0000000000000000  w   DF *UND*  0000000000000000  GLIBC_2.2.5 __cxa_finalize
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 memcpy
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 dl_iterate_phdr
0000000000000000  w   D  *UND*  0000000000000000              pthread_cancel
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 calloc
0000000000000000  w   DF *UND*  0000000000000000  GLIBC_2.2.5 pthread_mutex_lock
0000000000000000      DF *UND*  0000000000000000  GLIBC_2.2.5 realloc
0000000000000000  w   DF *UND*  0000000000000000  GLIBC_2.2.5 pthread_mutex_unlock
0000000000000000  w   D  *UND*  0000000000000000              pthread_setspecific
0000000000002de0 g    DF .text  0000000000000028  GCC_3.0     __mulvsi3
000000000000a8c0 g    DF .text  000000000000034c  GCC_4.3.0   __floatuntitf
000000000000c160 g    DF .text  00000000000001cf  GCC_4.3.0   __letf2
00000000000050a0 g    DF .text  0000000000000223  GCC_3.0     __modti3
0000000000009530 g    DF .text  0000000000000094  GCC_4.3.0   __unordtf2
0000000000004660 g    DF .text  0000000000000007  GCC_4.3.0   __bswapdi2
0000000000004ea0 g    DF .text  0000000000000045  GCC_4.2.0   __floatuntixf
0000000000011d80 g    DF .text  000000000000017f  GCC_4.3.0   __emutls_get_address
0000000000000000 g    DO *ABS*  0000000000000000  GCC_3.0     GCC_3.0
0000000000006ac0 g    DF .text  0000000000000a0f  GCC_4.3.0   __divtf3
0000000000002b70 g    DF .text  0000000000000032  GCC_3.0     __ucmpti2
0000000000000000 g    DO *ABS*  0000000000000000  GCC_3.3     GCC_3.3
0000000000000000 g    DO *ABS*  0000000000000000  GCC_3.4     GCC_3.4
0000000000002ac0 g    DF .text  0000000000000062  GCC_3.0     __ashrti3
0000000000002c60 g    DF .text  000000000000002d  GCC_3.0     __addvdi3
0000000000003270 g    DF .text  0000000000000036  GCC_3.4     __paritydi2
0000000000002cc0 g    DF .text  0000000000000042  GCC_3.4.4   __addvti3
00000000000032b0 g    DF .text  0000000000000039  GCC_3.4     __parityti2
00000000000098b0 g    DF .text  00000000000000ee  GCC_4.3.0   __floatsitf
0000000000002a60 g    DF .text  000000000000005f  GCC_3.0     __ashlti3
000000000000f830 g    DF .text  00000000000000e5  GCC_3.0     _Unwind_Resume
000000000000fa40 g    DF .text  00000000000000ab  GCC_3.3     _Unwind_Backtrace
0000000000000000 g    DO *ABS*  0000000000000000  GCC_3.4.2   GCC_3.4.2
00000000000036a0 g    DF .text  00000000000002e7  GCC_4.0.0   __muldc3
000000000000cb30 g    DF .text  0000000000000630  GCC_4.3.0   __multc3
000000000000cb30 g    DF .text  0000000000000630 (GCC_4.0.0)  __multc3
0000000000000000 g    DO *ABS*  0000000000000000  GCC_3.4.4   GCC_3.4.4
00000000000029d0 g    DF .text  0000000000000026  GCC_3.0     __negti2
000000000000c330 g    DF .text  0000000000000132  GCC_4.3.0   __eqtf2
0000000000003340 g    DF .text  000000000000004d  GCC_4.0.0   __powidf2
000000000000d160 g    DF .text  00000000000000a7  GCC_4.3.0   __powitf2
0000000000003180 g    DF .text  0000000000000009  GCC_3.4     __clzdi2
000000000000d160 g    DF .text  00000000000000a7 (GCC_4.0.0)  __powitf2
0000000000003190 g    DF .text  0000000000000022  GCC_3.4     __clzti2
00000000000052d0 g    DF .text  0000000000000113  GCC_3.0     __udivti3
0000000000009e00 g    DF .text  00000000000000fe  GCC_4.3.0   __floatditf
000000000000b540 g    DF .text  000000000000052f  GCC_4.3.0   __trunctfdf2
0000000000004b10 g    DF .text  00000000000000ca  GCC_3.0     __floattisf
0000000000009c80 g    DF .text  0000000000000173  GCC_4.3.0   __fixunstfdi
000000000000ac10 g    DF .text  0000000000000172  GCC_4.3.0   __extendsftf2
000000000000d6a0 g    DF .text  0000000000000008  GCC_3.0     _Unwind_GetLanguageSpecificData
000000000000d6c0 g    DF .text  0000000000000023  GCC_3.3     _Unwind_FindEnclosingFunction
000000000000d670 g    DF .text  0000000000000015  GCC_4.2.0   _Unwind_GetIPInfo
000000000000a2a0 g    DF .text  000000000000024a  GCC_4.3.0   __fixunstfti
00000000000112c0 g    DF .text  0000000000000132  GCC_3.0     __deregister_frame_info_bases
0000000000003150 g    DF .text  0000000000000010  GCC_3.0     __ffsdi2
0000000000003160 g    DF .text  000000000000001e  GCC_3.0     __ffsti2
00000000000047c0 g    DF .text  0000000000000039  GCC_3.0     __fixxfti
000000000000d6f0 g    DF .text  0000000000000008  GCC_3.0     _Unwind_GetDataRelBase
0000000000004070 g    DF .text  00000000000002ef  GCC_4.0.0   __divdc3
000000000000c470 g    DF .text  00000000000006b1  GCC_4.3.0   __divtc3
000000000000c470 g    DF .text  00000000000006b1 (GCC_4.0.0)  __divtc3
0000000000000000 g    DO *ABS*  0000000000000000  GCC_4.2.0   GCC_4.2.0
0000000000002dc0 g    DF .text  0000000000000020  GCC_3.0     __mulvdi3
0000000000002c00 g    DF .text  000000000000001b  GCC_3.0     __absvsi2
0000000000002e10 g    DF .text  000000000000028c  GCC_3.4.4   __mulvti3
00000000000112a0 g    DF .text  000000000000001a  GCC_3.0     __register_frame_table
0000000000008170 g    DF .text  00000000000013ba  GCC_4.3.0   __subtf3
000000000000af30 g    DF .text  000000000000016b  GCC_4.3.0   __extendxftf2
0000000000003990 g    DF .text  0000000000000413  GCC_4.0.0   __mulxc3
0000000000007e30 g    DF .text  000000000000033e  GCC_4.3.0   __negtf2
0000000000011210 g    DF .text  0000000000000072  GCC_3.0     __register_frame_info_table_bases
0000000000003390 g    DF .text  000000000000005f  GCC_4.0.0   __powixf2
0000000000004be0 g    DF .text  00000000000000ca  GCC_3.0     __floattidf
000000000000d6b0 g    DF .text  0000000000000008  GCC_3.0     _Unwind_GetRegionStart
000000000000a4f0 g    DF .text  00000000000003c1  GCC_4.3.0   __floattitf
0000000000004cb0 g    DF .text  000000000000002d  GCC_3.0     __floattixf
000000000000ba70 g    DF .text  0000000000000503  GCC_4.3.0   __trunctfxf2
0000000000011440 g    DF .text  00000000000001fd  GCC_3.0     _Unwind_Find_FDE
000000000000d690 g    DF .text  0000000000000008  GCC_3.0     _Unwind_SetIP
00000000000053f0 g    DF .text  000000000000018e  GCC_3.0     __umodti3
000000000000d660 g    DF .text  0000000000000008  GCC_3.0     _Unwind_GetIP
00000000000046d0 g    DF .text  000000000000006b  GCC_3.0     __fixunsxfdi
0000000000011130 g    DF .text  000000000000009a  GCC_3.0     __register_frame_info_bases
0000000000004940 g    DF .text  00000000000001ce  GCC_3.0     __fixunsxfti
0000000000004360 g    DF .text  00000000000002e6  GCC_4.0.0   __divxc3
0000000000002d40 g    DF .text  000000000000002c  GCC_3.0     __subvsi3
0000000000004740 g    DF .text  0000000000000037  GCC_3.0     __fixsfti
00000000000057c0 g    DF .text  00000000000012f7  GCC_4.3.0   __addtf3
0000000000000000 g    DO *ABS*  0000000000000000  GCC_4.3.0   GCC_4.3.0
00000000000030d0 g    DF .text  0000000000000024  GCC_3.0     __negvsi2
0000000000002bd0 g    DF .text  0000000000000025  GCC_3.0     __absvdi2
0000000000002980 g    DF .text  000000000000004c  GCC_3.0     __multi3
000000000000fa20 g    DF .text  000000000000001a  GCC_3.0     _Unwind_DeleteException
0000000000002c20 g    DF .text  0000000000000034  GCC_3.4.4   __absvti2
000000000000d600 g    DF .text  0000000000000008  GCC_3.3     _Unwind_GetCFA
0000000000002a00 g    DF .text  000000000000005f  GCC_3.0     __lshrti3
0000000000002bc0 g    DF .text  0000000000000002  GCC_3.4.2   __enable_execute_stack
00000000000031f0 g    DF .text  000000000000002c  GCC_3.4     __popcountdi2
0000000000000000 g    DO *ABS*  0000000000000000  GCC_4.0.0   GCC_4.0.0
0000000000003220 g    DF .text  0000000000000045  GCC_3.4     __popcountti2
0000000000002bb0 g    DF .text  0000000000000002  GCC_3.0     __clear_cache
000000000000c330 g    DF .text  0000000000000132 (GCC_3.0)    __netf2
000000000000c330 g    DF .text  0000000000000132  GCC_4.3.0   __netf2
0000000000004780 g    DF .text  0000000000000040  GCC_3.0     __fixdfti
00000000000099a0 g    DF .text  00000000000000db  GCC_4.3.0   __floatunsitf
00000000000095d0 g    DF .text  0000000000000190  GCC_4.3.0   __fixtfsi
0000000000002b30 g    DF .text  0000000000000032  GCC_3.0     __cmpti2
000000000000ad90 g    DF .text  0000000000000195  GCC_4.3.0   __extenddftf2
0000000000004650 g    DF .text  0000000000000005  GCC_4.3.0   __bswapsi2
000000000000f5d0 g    DF .text  000000000000016c  GCC_3.0     _Unwind_RaiseException
0000000000009f00 g    DF .text  00000000000000d3  GCC_4.3.0   __floatunditf
0000000000002c90 g    DF .text  000000000000002c  GCC_3.0     __addvsi3
0000000000004ce0 g    DF .text  00000000000000d6  GCC_4.2.0   __floatuntisf
000000000000bf80 g    DF .text  00000000000001df (GCC_3.0)    __gttf2
000000000000bf80 g    DF .text  00000000000001df  GCC_4.3.0   __gttf2
0000000000011410 g    DF .text  0000000000000021  GCC_3.0     __deregister_frame
0000000000000000 g    DO *ABS*  0000000000000000  GCC_3.3.1   GCC_3.3.1
00000000000031c0 g    DF .text  0000000000000005  GCC_3.4     __ctzdi2
0000000000004ef0 g    DF .text  00000000000001ab  GCC_3.0     __divti3
00000000000033f0 g    DF .text  00000000000002a5  GCC_4.0.0   __mulsc3
00000000000031d0 g    DF .text  000000000000001b  GCC_3.4     __ctzti2
0000000000011290 g    DF .text  0000000000000009  GCC_3.0     __register_frame_info_table
00000000000111e0 g    DF .text  0000000000000026  GCC_3.0     __register_frame
00000000000032f0 g    DF .text  000000000000004b  GCC_4.0.0   __powisf2
000000000000bf80 g    DF .text  00000000000001df  GCC_4.3.0   __getf2
0000000000004670 g    DF .text  000000000000002c  GCC_3.0     __fixunssfdi
000000000000b0a0 g    DF .text  000000000000049b  GCC_4.3.0   __trunctfsf2
00000000000074d0 g    DF .text  000000000000095f  GCC_4.3.0   __multf3
000000000000f920 g    DF .text  00000000000000f9  GCC_3.3     _Unwind_Resume_or_Rethrow
0000000000011f00 g    DF .text  0000000000000035  GCC_4.3.0   __emutls_register_common
0000000000002d10 g    DF .text  000000000000002d  GCC_3.0     __subvdi3
0000000000004800 g    DF .text  000000000000009f  GCC_3.0     __fixunssfti
0000000000002d70 g    DF .text  0000000000000042  GCC_3.4.4   __subvti3
0000000000009a80 g    DF .text  00000000000001fc  GCC_4.3.0   __fixtfdi
00000000000111d0 g    DF .text  0000000000000009  GCC_3.0     __register_frame_info
00000000000030a0 g    DF .text  000000000000002a  GCC_3.0     __negvdi2
0000000000005590 g    DF .text  000000000000022a  GCC_3.0     __udivmodti4
000000000000c160 g    DF .text  00000000000001cf (GCC_3.0)    __lttf2
0000000000003100 g    DF .text  000000000000004e  GCC_3.4.4   __negvti2
000000000000c160 g    DF .text  00000000000001cf  GCC_4.3.0   __lttf2
00000000000046a0 g    DF .text  0000000000000030  GCC_3.0     __fixunsdfdi
0000000000009fe0 g    DF .text  00000000000002b6  GCC_4.3.0   __fixtfti
0000000000011400 g    DF .text  0000000000000005  GCC_3.0     __deregister_frame_info
0000000000009760 g    DF .text  000000000000014b  GCC_4.3.0   __fixunstfsi
0000000000011800 g    DF .text  000000000000045c  GCC_3.3.1   __gcc_personality_v0
00000000000048a0 g    DF .text  0000000000000097  GCC_3.0     __fixunsdfti
000000000000d610 g    DF .text  0000000000000050  GCC_3.0     _Unwind_SetGR
0000000000004dc0 g    DF .text  00000000000000d6  GCC_4.2.0   __floatuntidf
0000000000003db0 g    DF .text  00000000000002b8  GCC_4.0.0   __divsc3
000000000000d5b0 g    DF .text  0000000000000048  GCC_3.0     _Unwind_GetGR
000000000000d700 g    DF .text  0000000000000008  GCC_3.0     _Unwind_GetTextRelBase
000000000000f740 g    DF .text  00000000000000ef  GCC_3.0     _Unwind_ForcedUnwind

/usr/lib32/libgcc_s.so.1:     file format elf32-i386

DYNAMIC SYMBOL TABLE:
00000000      DF *UND*  00000000  GLIBC_2.0   abort
00000000  w   D  *UND*  00000000              __gmon_start__
00000000  w   D  *UND*  00000000              _Jv_RegisterClasses
00000000      DF *UND*  00000000  GLIBC_2.0   realloc
00000000      DF *UND*  00000000  GLIBC_2.0   calloc
00000000  w   D  *UND*  00000000              pthread_key_create
00000000      DF *UND*  00000000  GLIBC_2.0   memset
00000000  w   D  *UND*  00000000              pthread_once
00000000      DF *UND*  00000000  GLIBC_2.0   free
00000000  w   D  *UND*  00000000              pthread_getspecific
00000000  w   DF *UND*  00000000  GLIBC_2.0   pthread_mutex_unlock
00000000      DF *UND*  00000000  GLIBC_2.0   memcpy
00000000      DF *UND*  00000000  GLIBC_2.0   strlen
00000000      DF *UND*  00000000  GLIBC_2.0   malloc
00000000  w   DF *UND*  00000000  GLIBC_2.0   pthread_mutex_lock
00000000  w   D  *UND*  00000000              pthread_cancel
00000000      DF *UND*  00000000  GLIBC_2.2.4 dl_iterate_phdr
00000000  w   DF *UND*  00000000  GLIBC_2.1.3 __cxa_finalize
00000000  w   D  *UND*  00000000              pthread_setspecific
00007c10 g    DF .text  000001d0  GLIBC_2.0   __moddi3
00002450 g    DF .text  00000038  GCC_3.0     __mulvsi3
0000c120 g    DF .text  00000225  GCC_4.4.0   __letf2
000103e0 g    DF .text  00000096  GCC_4.4.0   __unordtf2
000074b0 g    DF .text  0000000f  GCC_4.3.0   __bswapdi2
000187b0 g    DF .text  000001a8  GCC_4.3.0   __emutls_get_address
00000000 g    DO *ABS*  00000000  GCC_3.0     GCC_3.0
00002200 g    DF .text  0000003d  GCC_3.0     __ucmpdi2
0000a810 g    DF .text  0000156b  GCC_4.4.0   __divtf3
00002160 g    DF .text  00000060  GCC_3.0     __ashrdi3
00015da0 g    DF .text  000000d9  GLIBC_2.0   __frame_state_for
00000000 g    DO *ABS*  00000000  GCC_3.3     GCC_3.3
00000000 g    DO *ABS*  00000000  GCC_3.4     GCC_3.4
00002330 g    DF .text  00000069  GCC_3.0     __addvdi3
000028d0 g    DF .text  0000002f  GCC_3.4     __paritydi2
00013490 g    DF .text  00000033  GCC_4.4.0   __fabstf2
000020f0 g    DF .text  00000061  GCC_3.0     __ashldi3
000109a0 g    DF .text  000001e8  GCC_4.4.0   __floatsitf
00016100 g    DF .text  000000e2  GCC_3.0     _Unwind_Resume
00016300 g    DF .text  00000089  GCC_3.3     _Unwind_Backtrace
00000000 g    DO *ABS*  00000000  GCC_3.4.2   GCC_3.4.2
00002fd0 g    DF .text  00000408  GCC_4.0.0   __muldc3
00002050 g    DF .text  00000031  GCC_3.0     __negdi2
000037e0 g    DF .text  000018a8  GCC_4.4.0   __multc3
0000bd80 g    DF .text  00000185  GCC_4.4.0   __eqtf2
00002960 g    DF .text  00000054  GCC_4.0.0   __powidf2
00007950 g    DF .text  0000002c  GCC_3.0     __floatdidf
00002790 g    DF .text  00000020  GCC_3.4     __clzdi2
00002a20 g    DF .text  000001ad  GCC_4.4.0   __powitf2
00007de0 g    DF .text  00000104  GLIBC_2.0   __udivdi3
000112f0 g    DF .text  00000210  GCC_4.4.0   __floatditf
00012720 g    DF .text  0000067b  GCC_4.4.0   __trunctfdf2
00007980 g    DF .text  0000002c  GCC_3.0     __floatdixf
00011050 g    DF .text  00000294  GCC_4.4.0   __fixunstfdi
000116f0 g    DF .text  0000039e  GCC_4.4.0   __extendsftf2
00013980 g    DF .text  0000000b  GCC_3.0     _Unwind_GetLanguageSpecificData
000139a0 g    DF .text  00000037  GCC_3.3     _Unwind_FindEnclosingFunction
00013950 g    DF .text  00000016  GCC_4.2.0   _Unwind_GetIPInfo
000076b0 g    DF .text  00000047  GCC_3.0     __fixxfdi
00017c20 g    DF .text  0000010f  GCC_3.0     __deregister_frame_info_bases
00002750 g    DF .text  0000002f  GCC_3.0     __ffsdi2
00000000 g    DO *ABS*  00000000  GCC_4.5.0   GCC_4.5.0
000139e0 g    DF .text  0000000b  GCC_3.0     _Unwind_GetDataRelBase
000075a0 g    DF .text  00000062  GCC_3.0     __fixunsxfsi
00005390 g    DF .text  000002f9  GCC_4.0.0   __divdc3
00005990 g    DF .text  00001b0f  GCC_4.4.0   __divtc3
00000000 g    DO *ABS*  00000000  GCC_4.2.0   GCC_4.2.0
00002490 g    DF .text  000001fe  GCC_3.0     __mulvdi3
00002260 g    DF .text  00000033  GCC_3.0     __absvsi2
00017be0 g    DF .text  00000033  GLIBC_2.0   __register_frame_table
0000dd70 g    DF .text  00002668  GCC_4.4.0   __subtf3
00011ea0 g    DF .text  00000293  GCC_4.5.0   __extendxftf2
000027f0 g    DF .text  00000050  GCC_3.4     __popcountsi2
000033e0 g    DF .text  000003f8  GCC_4.0.0   __mulxc3
0000d7c0 g    DF .text  000005a9  GCC_4.4.0   __negtf2
00017b00 g    DF .text  00000093  GCC_3.0     __register_frame_info_table_bases
000029c0 g    DF .text  00000054  GCC_4.0.0   __powixf2
00013990 g    DF .text  0000000b  GCC_3.0     _Unwind_GetRegionStart
00012da0 g    DF .text  000006ab  GCC_4.4.0   __trunctfxf2
00017da0 g    DF .text  000001de  GCC_3.0     _Unwind_Find_FDE
00013970 g    DF .text  0000000e  GCC_3.0     _Unwind_SetIP
00007ef0 g    DF .text  00000145  GLIBC_2.0   __umoddi3
00013940 g    DF .text  0000000b  GCC_3.0     _Unwind_GetIP
000027b0 g    DF .text  00000009  GCC_3.4     __ctzsi2
000077e0 g    DF .text  000000e0  GCC_3.0     __fixunsxfdi
00013450 g    DF .text  0000003e  GCC_4.4.0   __copysigntf3
000179c0 g    DF .text  000000a7  GCC_3.0     __register_frame_info_bases
000079b0 g    DF .text  00000059  GCC_4.2.0   __floatundisf
00005690 g    DF .text  000002fb  GCC_4.0.0   __divxc3
00007610 g    DF .text  00000047  GCC_3.0     __fixsfdi
000023a0 g    DF .text  0000003c  GCC_3.0     __subvsi3
00008230 g    DF .text  000025da  GCC_4.4.0   __addtf3
00000000 g    DO *ABS*  00000000  GCC_4.3.0   GCC_4.3.0
00002010 g    DF .text  00000035  GCC_3.0     __muldi3
00002690 g    DF .text  00000036  GCC_3.0     __negvsi2
000022a0 g    DF .text  00000050  GCC_3.0     __absvdi2
000162e0 g    DF .text  0000001f  GCC_3.0     _Unwind_DeleteException
000074c0 g    DF .text  00000062  GCC_3.0     __fixunssfsi
00002090 g    DF .text  0000005f  GCC_3.0     __lshrdi3
000138c0 g    DF .text  0000000b  GCC_3.3     _Unwind_GetCFA
00007660 g    DF .text  00000047  GCC_3.0     __fixdfdi
00002250 g    DF .text  00000005  GCC_3.4.2   __enable_execute_stack
00002840 g    DF .text  0000005b  GCC_3.4     __popcountdi2
00000000 g    DO *ABS*  00000000  GCC_4.0.0   GCC_4.0.0
00002240 g    DF .text  00000005  GCC_3.0     __clear_cache
0000bd80 g    DF .text  00000185  GCC_4.4.0   __netf2
00010b90 g    DF .text  000001a7  GCC_4.4.0   __floatunsitf
00010480 g    DF .text  000002b2  GCC_4.4.0   __fixtfsi
000021c0 g    DF .text  0000003d  GCC_3.0     __cmpdi2
00011a90 g    DF .text  00000401  GCC_4.4.0   __extenddftf2
00007530 g    DF .text  00000062  GCC_3.0     __fixunsdfsi
000074a0 g    DF .text  0000000a  GCC_4.3.0   __bswapsi2
00007a10 g    DF .text  00000037  GCC_4.2.0   __floatundidf
00015e90 g    DF .text  0000018e  GCC_3.0     _Unwind_RaiseException
00011500 g    DF .text  000001e7  GCC_4.4.0   __floatunditf
000022f0 g    DF .text  0000003c  GCC_3.0     __addvsi3
000028a0 g    DF .text  0000002a  GCC_3.4     __paritysi2
00007a50 g    DF .text  00000037  GCC_4.2.0   __floatundixf
0000bf10 g    DF .text  00000206  GCC_4.4.0   __gttf2
00017d60 g    DF .text  00000031  GLIBC_2.0   __deregister_frame
00000000 g    DO *ABS*  00000000  GCC_3.3.1   GCC_3.3.1
00007a90 g    DF .text  00000177  GLIBC_2.0   __divdi3
000027c0 g    DF .text  00000025  GCC_3.4     __ctzdi2
00002bd0 g    DF .text  000003f0  GCC_4.0.0   __mulsc3
00017ba0 g    DF .text  0000003a  GLIBC_2.0   __register_frame_info_table
00017ab0 g    DF .text  00000042  GLIBC_2.0   __register_frame
00002900 g    DF .text  00000054  GCC_4.0.0   __powisf2
00002780 g    DF .text  0000000c  GCC_3.4     __clzsi2
0000bf10 g    DF .text  00000206  GCC_4.4.0   __getf2
00007700 g    DF .text  0000006c  GCC_3.0     __fixunssfdi
00012140 g    DF .text  000005d4  GCC_4.4.0   __trunctfsf2
0000c350 g    DF .text  0000146a  GCC_4.4.0   __multf3
000161f0 g    DF .text  000000e2  GCC_3.3     _Unwind_Resume_or_Rethrow
00018960 g    DF .text  00000033  GCC_4.3.0   __emutls_register_common
000023e0 g    DF .text  00000069  GCC_3.0     __subvdi3
00000000 g    DO *ABS*  00000000  GLIBC_2.0   GLIBC_2.0
00010d40 g    DF .text  0000030d  GCC_4.4.0   __fixtfdi
00017a70 g    DF .text  0000003a  GLIBC_2.0   __register_frame_info
00002730 g    DF .text  00000014  GCC_4.3.0   __ffssi2
00008050 g    DF .text  000001d8  GCC_3.0     __udivmoddi4
000078c0 g    DF .text  0000008f  GCC_3.0     __floatdisf
000026d0 g    DF .text  0000005a  GCC_3.0     __negvdi2
00000000 g    DO *ABS*  00000000  GCC_4.4.0   GCC_4.4.0
0000c120 g    DF .text  00000225  GCC_4.4.0   __lttf2
00007770 g    DF .text  0000006c  GCC_3.0     __fixunsdfdi
00017d30 g    DF .text  00000023  GLIBC_2.0   __deregister_frame_info
00010740 g    DF .text  0000025a  GCC_4.4.0   __fixunstfsi
000181d0 g    DF .text  00000463  GCC_3.3.1   __gcc_personality_v0
000138d0 g    DF .text  0000006d  GCC_3.0     _Unwind_SetGR
00005090 g    DF .text  000002f1  GCC_4.0.0   __divsc3
00013850 g    DF .text  00000065  GCC_3.0     _Unwind_GetGR
000139f0 g    DF .text  0000000b  GCC_3.0     _Unwind_GetTextRelBase
00016020 g    DF .text  000000d8  GCC_3.0     _Unwind_ForcedUnwind 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T05:49:33.507

这听起来有点类似于在 ubuntu 上报告的 rsyslogd[错误。](https://bugs.launchpad.net/ubuntu/+source/rsyslog/+bug/1024731)如果您用完了选项，那么升级到更高版本的 rsyslogd 可能是要走的路。您可能必须从源代码构建它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T01:19:22.933

仅供参考：可能是64位系统造成的，可能不是。我不确定，但我之前遇到过一些类似的问题，我只是使用 32bit lib，看起来还可以。但是，我现在正在迁移到 openSUSE-12.X，似乎问题解决了......

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-04-06T09:35:16.953

您需要安装`libgcc 32 bit`. 如果你在下面检查，`/libs`你会发现一个`x86_64-linux-gnu`文件夹，但没有`i386-linux-gnu`。这是由于 64 位机器中的 32 位库不可用。您需要执行命令：

`aptitude install libgcc1:i386`

之后，您会发现该文件夹`i386-linux-gnu`已在其中创建并存在于`libs`该文件夹`libgcc_s.so.1`下。这应该可以解决问题。

# perl - Perl：将打开的文件句柄传递给读取 STDIN 的程序

> ID：12206828
> 
> 赞同：6
> 
> 时间：2012-08-30T23:04:31.597
> 
> 标签：perl, redirect, fork, filehandle

我从 STDIN 读了几行。如何将剩余的 STDIN 传递给从标准输入（例如`md5sum`or `wc`）读取的命令？

我可以做一个：

```
read_a_few_lines_from_diamond_operator();
open (C, "|cmd");
while(<>) { print C }
close C;
cleanup_after_C(); 
```

但出于效率原因，我不想触摸输入，而是传递 STDIN 的文件句柄。有点像：

```
seq 10 | (read A; wc) 
```

在`read`将其余部分传递给`wc`. 但是，我不能使用这个解决方案，因为我需要从我的 perl 程序中启动命令，并且我需要在`cmd`完成后进行工作。

* * *

我从文件'foo'中读取了几行。如何将剩余部分传递给从标准输入（例如`md5sum`or `wc`）读取的命令？

我可以做一个：

```
open (F, "<foo");
read_a_few_lines_from_F();
open (C, "|cmd");
while(<F>) { print C }
close C;
cleanup_after_C(); 
```

但出于效率原因，我不想触摸输入，而是传递文件“foo”的其余部分。

* * *

我有一种感觉，可以使用诸如`select`, `open(FOO,">&STDOUT)`, `exec 6<&0`, `fork`,之类的诡计来完成`pipe`。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-30T23:27:30.153

答案很简单：你不需要做任何特别的事情。您的孩子将自动继承您的`STDIN`with`system`和`exec`. 您尚未从 STDIN 读取的所有内容都可以被孩子阅读。

但是，有一个问题。因为一次读取一个字符会非常低效，Perl 一次从文件中读取一个块。也就是说，您从文件中读取的内容比从 Perl 返回的“几行”要多。使用以下命令可以清楚地看到这一点：

```
perl -E'say $_ x 500 for "a".."z"' \
   | perl -e'<>; <>; exec("cat");' \
   | less 
```

不是从第二行的开头开始，而是从`cat`“q”的中间开始（字节 8192）！

如果你想让它工作，你必须从使用`readline`( )读取行切换`<>`到读取单个字节。`sysread`

* * *

着眼于大局，我认为有一个解决方案：

```
open(STDIN, "<", "foo") or die $!;
read_a_few_lines(*STDIN);
my $pos = tell(STDIN);
open(STDIN, "<", "foo") or die $!;
sysseek(STDIN, $pos, SEEK_SET);
system(@cmd);
... 
```

甚至可能：

```
open(STDIN, "<", "foo") or die $!;
read_a_few_lines(*STDIN);
sysseek(STDIN, tell(STDIN), SEEK_SET);
system(@cmd);
... 
```

未经测试。

# xmpp - 向房间发送 XMPP IM 消息

> ID：12206829
> 
> 赞同：-1
> 
> 时间：2012-08-30T23:04:32.330
> 
> 标签：xmpp

我试图找出是否可以将 XMPP IM 消息发送到房间而不是个人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-24T12:37:24.723

分组发送消息和发送个人消息是不同的。两者都以不同的方式处理。虽然！您可以使用您房间的对象，即 XMPPRoom（专门用于 iOS 客户端）在群组中发送消息，如下所示：

```
 [XMPPRoom sendMessage:@"Your Message"]; 
```

有关 XMPP MUC 的更多信息，请遵循 XEP-0045 文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T10:23:27.103

您需要的一切都应该在[XEP-0045](http://xmpp.org/extensions/xep-0045.html)扩展标准中定义。对于其他一切，您必须更具体地询问。

# jquery-ui - 回发后 JQuery 自动完成功能停止工作

> ID：12206834
> 
> 赞同：1
> 
> 时间：2012-08-30T23:05:12.673
> 
> 标签：jquery-ui, sharepoint-2010, jquery-ui-autocomplete

我有一个自动完成脚本，它可以在用户键入 2 个字母后显示可供选择的选项。现在，我遇到的问题是，在做出选择并填写了文本字段后，脚本停止了。例如，如果我从给定的条目中进行选择，并且由于某种原因我清除了文本字段，那么一旦我再次开始输入，自动完成就不会显示任何内容。

每次我从几个下拉控件中选择值时，表单都会执行回发，我注意到一旦触发回发，脚本就会停止。有什么办法可以让脚本在每次回发后运行？

如果有人能指出正确的方向，我将不胜感激。

谢谢。

```
<script language="javascript" src="/Scripts/jquery-1.7.1.min.js" type="text/javascript"></script>
<script language="javascript" src="/Scripts/jquery.SPServices-0.7.1a.min.js" type="text/javascript"></script>
<script language="javascript" src="/Scripts/jquery-ui-1.8.22.custom.min.js" type="text/javascript"></script>
<link href="/Scripts/jquery-ui-1.8.22.custom.css" rel="stylesheet" type="text/css"/>
<script language="javascript" type="text/javascript">

//Wait ##### seconds for form to load before calling the function.
window.onload = function(){
    window.setTimeout(readyCall, 1000);
}

function readyCall(){

//Variable for Array where Title column values will be pushed to.
var Requestors = [];

//Variable for the Requestor Text Field.
var RequestorField = "input[id$='FormControl0_V1_I1_T2']"

//Call the SPServices library.
$().SPServices({
    operation: "GetListItems",
    listName: "Requestor",
    CAMLViewFields: "",
    async: false,
    completefunc: function (xData, Status){
        $(xData.responseXML).SPFilterNode("z:row").each(function(){
            Requestors.push($(this).attr("ows_Title"));
        }); 
    } 
}); 

//Input field from form.
$(RequestorField).autocomplete({
    source: Requestors,
    minLength: 3,
    focus: function(event, ui){
        $(RequestorField).val(ui.item.value);
        return false;
        }       
    }); 
} 
</script> 
```

# c++ - 所有者使用 Windows API 绘制按钮的文本

> ID：12206839
> 
> 赞同：0
> 
> 时间：2012-08-30T23:05:47.427
> 
> 标签：c++, windows, winapi

我想拥有/自定义绘制按钮的文本，但只有文本（或内容）。所以我可以用多种彩色字体渲染按钮。

如果我处理`WM_DRAWITEM`，我必须绘制整个按钮。我只想绘制文本。

是否可以调用一些 API 让 Windows 绘制没有文本的按钮，然后我可以自己绘制文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T00:49:32.050

您必须自己绘制整个按钮。但是，如果在 XP+ 上启用了 CommCtrl v6，您可以使用该`DrawFrameControl()`函数或`DrawThemeParentBackground/Ex()`and`DrawThemeBackground/Ex()`函数，让 Windows 为您绘制按钮的背景和边框。然后，您可以在其上绘制所需的文本。

# java - “并发应用程序中 LinkedBlockingQueue 的不可预测性能”是什么意思？

> ID：12206840
> 
> 赞同：4
> 
> 时间：2012-08-30T23:05:52.467
> 
> 标签：java, concurrency, producer-consumer, blockingqueue

对于我正在处理的日志记录功能，我需要一个处理线程，它会等待作业并在计数达到或超过一定数量时分批执行它们。由于这是生产者消费者问题的标准案例，我打算使用[BlockingQueues](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html)。我有许多生产者使用**add()**方法将条目添加到队列中，而只有一个消费者线程使用**take()**来等待队列。

[LinkedBlockingQueue](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/LinkedBlockingQueue.html)似乎是一个不错的选择，因为它没有任何大小限制，但是我很困惑从文档中阅读此内容。

> 链接队列通常比基于数组的队列具有更高的吞吐量，但**在大多数并发应用程序中性能更不可预测**。

没有清楚地解释这句话的含义。有人可以照亮它吗？这是否意味着 LinkedBlockingQueue 不是线程安全的？你们中的任何人在使用 LinkedBlockingQueue 时遇到过任何问题吗？

由于生产者的数量要多得多，所以我总是会遇到这样一种情况，即队列被大量要添加的条目压得喘不过气来。如果我改用[ArrayBlockingQueue](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ArrayBlockingQueue.html)，它将队列的大小作为构造函数中的参数，我总是会遇到与容量满相关的异常。为了避免这种情况，我不确定如何确定我应该用什么大小来实例化我的 ArrayBlockingQueue。您是否必须使用 ArrayBlockingQueue 解决类似的问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-30T23:08:10.987

> 这是否意味着 LinkedBlockingQueue 不是线程安全的？

这当然*不是*那个意思。短语“更不可预测的性能”只是在谈论**性能**——而*不是*违反线程安全或 Java 集合合同。

我怀疑这更多地是因为它是一个链表，因此对集合的迭代和其他操作会更慢，因此类将持有更长时间的锁。它还必须处理更多的内存结构，因为每个元素都有一个链表节点，而不仅仅是数组中的一个条目。这意味着它必须在同步时在处理器之间刷新更多的脏内存页面。同样，这会影响性能。

他们想说的是，如果*可以*，您应该使用，`ArrayBlockingQueue`否则我不会担心。

> 你们中的任何人在使用 LinkedBlockingQueue 时遇到过任何问题吗？

我已经使用了很多，没有发现任何问题。它在`ExecutorService`无处不在的类中也被大量使用。

# jsf - Primefaces 数据表选择对象

> ID：12206844
> 
> 赞同：5
> 
> 时间：2012-08-30T23:06:47.853
> 
> 标签：jsf, primefaces

我对 Primefaces 数据表有疑问，尤其是对选择对象。

在我的以下代码中，对于绑定到带有选择的数据表的变量“选定问题”，我总是为空。

jsf如下：

```
 <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets">

    <ui:composition template="mainTemplate.xhtml">
        <ui:define name="contentTitle">Your Questions</ui:define>
        <ui:define name="content">
            <h:form id="formAllQuestion">
                <p:growl id="allQuestionGrowl" showDetail="true"/>

                <p:dataTable id="allQuestionsTable" var="question" value="#{allQuestionBean.allQuestionDataHelper}" paginator="true" rows="10"
                            selection="#{allQuestionBean.selectedQuestion}" selectionMode="single">

                    <p:ajax event="rowSelect" listener="#{allQuestionBean.onRowSelect}" update=":formAllQuestion:AnswerToQuestionDialogTable :formAllQuestion:allQuestionGrowl"
                            oncomplete="questDialog.show()"/>
                    <p:ajax event="rowUnselect" listener="#{allQuestionBean.onRowUnselect}" update=":formAllQuestion:allQuestionGrowl"/>

                    <f:facet name="header">Select a Row to display your Question Details</f:facet>

                    <p:column headerText="QuestionID">
                        #{question.questionId}
                    </p:column>
                    <p:column headerText="Question Name">
                        #{question.questionName}
                    </p:column>
                    <p:column headerText="Question Description">
                        #{question.questionText}
                    </p:column>
                    <p:column headerText="Question Short Description">
                        #{question.questionShortText}
                    </p:column>
                    <p:column headerText="Author">
                        #{question.professor.profSurename} #{question.professor.profName}
                    </p:column>
                </p:dataTable>

                <p:dialog header="Question Details" widgetVar="questionDialog" resizable="true" id="questDialog"
                          showEffect="fade" hideEffect="fade" modal="true">
                    <p:dataTable id="AnswerToQuestionDialogTable" var="answer" value="#{allQuestionBean.answers}">

                        <f:facet name="header">
                            Hier kommt der QR_Code rein!

                            #{allQuestionBean.selectedQuestion.questionId} - #{allQuestionBean.selectedQuestion.questionName}
                        </f:facet>

                        <p:column headerText="Answer">
                            <h:outputText value="#{answer.answerText}"/>
                        </p:column>
                        <p:column headerText="Counts For this Answer">
                            <h:outputText value="Bis jetz noch nix!"/>
                        </p:column>
                    </p:dataTable>
                </p:dialog>

            </h:form>
        </ui:define>
    </ui:composition>

</html> 
```

以及相关的 Bean 类（AllQuestionBean.class）：

```
 @ManagedBean(name = "allQuestionBean")
    @ViewScoped
    public class AllQuestionBean implements Serializable {

    private static final long serialVersionUID = 7038894302985973905L;

    @ManagedProperty(value = "#{questionDAO}")
    private QuestionDAO questionDAO;

    @ManagedProperty(value = "#{profSession.professor}")
    private Professor professor;

    @ManagedProperty(value = "#{answerDAO}")
    private AnswerDAO answerDAO;

    @ManagedProperty(value = "#{answeredDAO}")
    private AnsweredDAO answeredDAO;

    private List<Question> questions;
    private Question selectedQuestion;
    private List<Answer> answers;
    private AllQuestionDataHelper allQuestionDataHelper;

    public AllQuestionBean(){
        System.out.println("Starting Bean: "+this.getClass().getName());
    }

    @PostConstruct
    public void initVariables(){
        questions = questionDAO.readByProfessor(professor);
    }

    public void onRowSelect(SelectEvent event) {

        FacesMessage msg = new FacesMessage("Question Selected", selectedQuestion.getQuestionId()+" -- "+selectedQuestion.getQuestionName());

        FacesContext.getCurrentInstance().addMessage(null, msg);
    }

    public void onRowUnselect(UnselectEvent event) {

        FacesMessage msg = new FacesMessage("Question Selected", selectedQuestion.getQuestionId()+" -- "+selectedQuestion.getQuestionName());

        FacesContext.getCurrentInstance().addMessage(null, msg);
    }

    //---GETTER and SETTER

    public AllQuestionDataHelper getAllQuestionDataHelper() {
        allQuestionDataHelper = new AllQuestionDataHelper(questions);
        return allQuestionDataHelper;
    }

    public void setAllQuestionDataHelper(AllQuestionDataHelper allQuestionDataHelper) {
        this.allQuestionDataHelper = allQuestionDataHelper;
    }

    public QuestionDAO getQuestionDAO() {
        return questionDAO;
    }

    public void setQuestionDAO(QuestionDAO questionDAO) {
        this.questionDAO = questionDAO;
    }

    public Professor getProfessor() {
        return professor;
    }

    public void setProfessor(Professor professor) {
        this.professor = professor;
    }

    public AnswerDAO getAnswerDAO() {
        return answerDAO;
    }

    public void setAnswerDAO(AnswerDAO answerDAO) {
        this.answerDAO = answerDAO;
    }

    public AnsweredDAO getAnsweredDAO() {
        return answeredDAO;
    }

    public void setAnsweredDAO(AnsweredDAO answeredDAO) {
        this.answeredDAO = answeredDAO;
    }

    public List<Question> getQuestions() {
        return questions;
    }

    public void setQuestions(List<Question> questions) {
        this.questions = questions;
    }

    public Question getSelectedQuestion() {
        System.out.println("getSelectedQuestion");
        return selectedQuestion;
    }

    public void setSelectedQuestion(Question selectedQuestion) {
        System.out.println("Set selected Question: "+selectedQuestion);
        this.selectedQuestion = selectedQuestion;
    }

    public List<Answer> getAnswers() {
        answers = answerDAO.getAllAnswersForQuestion(selectedQuestion);
        return answers;
    }

    public void setAnswers(List<Answer> answers) {
        this.answers = answers;
    }
    } 
```

数据模型：

```
public class AllQuestionDataHelper extends ListDataModel<Question> implements SelectableDataModel<Question> {

    public AllQuestionDataHelper() {
    }

    public AllQuestionDataHelper(List<Question> list) {
        super(list);
    }

    @Override
    public Object getRowKey(Question question) {
        if(!(question == null)){
        System.out.println("Your Questions --> Getting RowKey");
        System.out.println("RowKey: "+question);
        System.out.println("RowKey: "+question.getQuestionId());
        }else{
            System.out.println("Warning Row Key is null");
        }
        return question.getQuestionId();
    }

    @Override
    public Question getRowData(String rowKey) {
        System.out.println("Your Questions --> Getting RowData");
        System.out.println("RowData: "+rowKey);

        List<Question> questionList = (List<Question>) getWrappedData();

        for(Question q : questionList){
            if(rowKey.equals(q.getQuestionId())){
                System.out.println("Returning "+q.getQuestionId());
                return q;
            }
        }
        return null;
    }
} 
```

我调试了一些运行并提到 AllQuestionBean.class 中的变量“selectedQuestion”从未设置。会说，“onRowSelect”中的事件变量包含一个 NULL 对象。如您所见，*.xhtml 中有两个数据表。第一个将正常加载，没有问题。Bean 的 onClick-Method 应该使用第二个数据表启动一个对话框，但会以一个 Nullpointer 退出。

对于数据表，我遵循 Primefaces 的教程 (http://www.primefaces.org/showcase-labs/ui/datatableRowSelectionInstant.jsf)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-05T14:03:49.740

在 上使用`rowKey`属性`p:dataTable`。

`rowKey`是一个唯一标识符，可帮助 Primefaces 引擎根据选择返回所选对象。

通常，您提供给`rowKey`属性的值是您要填充到的 POJO 的唯一属性`p:dataTable`。

如果您的 POJO 中没有任何此类唯一字段。然后制作一个总是有用的，例如：`int rowId;`，您可以在将它们添加到列表时增加并放入 POJO。

# html - 如何在保留布局的同时向此 HTML 模板添加粘性页脚？

> ID：12206845
> 
> 赞同：0
> 
> 时间：2012-08-30T23:06:48.940
> 
> 标签：html, css, sticky-footer, css3pie

是否可以为这个在 IE 兼容模式下工作并且跨浏览器兼容的[HTML 模板](http://jsfiddle.net/johntrepreneur/7Xk85/1/embedded/result/)添加一个粘性页脚？

我尝试添加[Ryan Fait 粘性页脚](http://www.google.com/url?sa=t&rct=j&q=sticky%20footer&source=web&cd=1&cad=rja&ved=0CCIQFjAA&url=http://ryanfait.com/sticky-footer/&ei=NfA_UPecIM_kiwL0rYGwBg&usg=AFQjCNH2eGGZjDDeJcH7bSZswM4d0AnDTw)，但是当我添加它时，一切似乎都中断了。

不能使用在父容器上使用 100% 高度的粘性页脚，然后对页脚使用负上边距并将其拉回视口，因为这将消除查看页脚和页脚之间背景颜色的能力主要内容。由于模板使用圆角，因此无法在其中注入背景颜色的间距 div，这似乎很困难。

我还尝试了类似于 Ryan Fait 方法的“[顶部边框吸收粘性页脚”，但我也无法让它发挥作用。](http://www.css-lab.com/demos/stickfoot/border-soak-up.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T18:42:30.803

解决了。基本上，就像您说的那样，我应用了 Ryan Fait 粘性页脚并执行了以下操作：
-将页脚移到包装器之外，将页眉移到包装器内。
-从身体上移除了填充物。
-从页脚中删除了上边距、下边框、框阴影（和底部圆角）。
- 将包装边距拉上一个额外的像素 (.063em) 以说明页脚的顶部边框。
-添加填充底部：10px；到#innerwrap 以获得我正在寻找的 div 间距（就像它在 Ryan Fait 页面上所说的那样）。
- 使页脚的宽度和边距与包装器匹配。

# asp.net-mvc - Razor 视图：Microsoft.Web.WebPages.OAuth.PreApplicationStartCode 类型上的预应用程序启动初始化方法 Start 引发异常

> ID：12206851
> 
> 赞同：5
> 
> 时间：2012-08-30T23:07:55.490
> 
> 标签：asp.net-mvc, razor, asp.net-mvc-4, visual-studio-2012

我在 Visual Studio 2012 中的 Asp.net MVC 4 项目中工作，当我打开视图时出现此错误：

> *ASP.NET 运行时错误：在类型 Microsoft.Web.WebPages.OAuth.PreApplicationStartCode 上的应用程序启动前初始化方法 Start 引发异常，并显示以下错误消息：“DotNetOpenAuth.Reporting”的类型初始化程序引发异常.. C： \Users\escobar5\Desktop\WindowsAzure1\MvcWebRole1\Views\Shared_LoginPartial.cshtml*

所以我失去了智能感知，因为在该错误之后，每次调用 ViewBag 或模型时都会说：“找不到编译动态表达式所需的一种或多种类型”

我从 Nuget 更新了 OAuth 包，但仍然出现错误。

该项目运行良好，问题只是剃须刀。

这是错误的屏幕截图以获取更多详细信息：

![错误](../Images/83278e99452cd583909ea6877bc3c785.png)

有任何想法吗？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T14:54:13.000

我找到了以下解释并使用 nuget 包管理器更新 DotNetOpenAuth.OAuth.Consumer 解决了错误问题。

[https://groups.google.com/forum/?fromgroups=#!topic/dotnetopenid/js58kMaWvvo](https://groups.google.com/forum/?fromgroups=#!topic/dotnetopenid/js58kMaWvvo)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T01:53:29.820

当我通过 NuGet 将 log4net 添加到我的应用程序时，我发现虽然错误没有消失，但 Intellisense 在文件中工作。

[看起来](https://github.com/DotNetOpenAuth/DotNetOpenAuth/blob/master/src/DotNetOpenAuth.Core/Reporting.cs)DotNetOpenAuth的报告模块依赖于一个名为 Logger 的类，而后者又依赖于 log4net。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-27T14:42:40.533

在包管理器控制台中选择了错误的项目....我的愚蠢错误。我想我应该在做这个之前喝更多的咖啡。

我通过进入解决方案的管理 NuGet 包并单击 ASP.NET MVC 4 旁边的管理来解决此问题，然后将该包添加到解决方案中的 MVC4 项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-08T11:45:23.240

如果你的文件中有[这一行](http://forums.asp.net/t/1774365.aspx/1)`web.config`

```
<add key="webpages:Enabled" value="true" /> 
```

然后删除它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-16T11:26:41.350

我必须执行以下两个步骤来解决此问题。

1.  更新 DotNetOpenAuth.OAuth.Consumer NuGet 包。这一点归功于 Magnus Karlsson - 请参阅[他的答案](https://stackoverflow.com/a/13219607/81595)以获取更多详细信息。
2.  从 Web.Config 文件中删除 System.Web.Razor 的程序集绑定。这是[来自拉纳的回答](https://stackoverflow.com/a/17525778/81595)。

```
<dependentAssembly>
    <assemblyIdentity name="System.Web.Razor" publicKeyToken="31bf3856ad364e35" culture="neutral" />
    <bindingRedirect oldVersion="0.0.0.0-3.0.0.0" newVersion="3.0.0.0" />
</dependentAssembly> 
```

# python - 从文本文件中读取列表并交换项目

> ID：12206856
> 
> 赞同：0
> 
> 时间：2012-08-30T23:08:16.787
> 
> 标签：python

我在这种格式的文本文件中有一个列表。该列表有 1000 个这样的条目，这是一个小样本。

```
myitems =[
      ['some text, A', '12345'],
      ['place name 1', 'AAA'],
      ['some text, A', '12345'],
      ['some text', '12345'],
      ['some text CC', 'wwww'],
      ['new text', '12345'],
      ['other text, A', '12345'],
    ] 
```

我如何从文本文件中读取列表并获得这样的输出。

```
newItems = [
  ['12345', 'some text, A'],
  ['AAA', 'place name 1'],
  ['12345', 'some text, A'],
  ['12345', 'some text'],
  ['wwww', 'some text CC'],
  ['12345', 'new text'],
  ['12345', 'other text, A'],
] 
```

我能够从文件中读取并将其作为字符串进行操作，但我如何将其作为列表获取。不能以逗号分隔，因为单个列表项可能有逗号。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T23:19:44.410

最简单的是列表理解：

```
new_items = [i[::-1] for i in myitems] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-30T23:29:31.750

```
 newItems = [[b, a] for a, b in myitems] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-30T23:31:33.040

```
import sys

# Reading your file (the path has been passed in argument) and storing each lines in the array called "input"
input = []
with open(sys.argv[1], 'r') as all_lines:
    for line in all_lines:
        if line:
            input.append(line)

# Creating your array "newItems"
for j in input: 
    print j

newItems = []
if len(input)>2:
    for i in range(1, len(input)-1):
        # Getting content inside brackets. Ex: {{ 'some text, A', '12345' }}
        my_str = input[i].split("[")[1].split("]")[0]
        my_elements = my_str.split("'")

        # Appending elements
        newItems.append([my_elements[1], my_elements[3]])

print  newItems 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T01:13:06.233

要读取文件，请使用 CSV，因为您声明“个别项目可能有逗号”

例子：

如果您的文件实际上如下所示：

```
'some text, A','12345'
'place name 1','AAA'
'some text, A','12345' 
'some text','12345'
'some text CC','wwww' 
'new text','12345'
'other text, A','12345' 
```

然后此代码读取 csv 文件并反转字段：

```
import csv

with open('test.csv','rb') as csvIN:
    for row in csv.reader(csvIN, delimiter=',',quotechar="'"):
        print row
        row=row[::-1]
        print '==>',row,'\n' 
```

印刷：

```
['some text, A', '12345']
==> ['12345', 'some text, A'] 

['place name 1', 'AAA']
==> ['AAA', 'place name 1'] 

['some text, A', '12345 ']
==> ['12345 ', 'some text, A'] 

['some text', '12345']
==> ['12345', 'some text'] 

['some text CC', 'wwww ']
==> ['wwww ', 'some text CC'] 

['new text', '12345']
==> ['12345', 'new text'] 

['other text, A', '12345']
==> ['12345', 'other text, A'] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-30T23:16:50.547

如果它真的看起来像那样

```
 with open(my_file) as f:
   exec(f.read()) #read in the text and evaluate it in python creating myitems variable
   my_list = [reversed(l) for l in myitems] 
```

exec 非常危险，很可能不应该使用......但这应该可以

更好的解决方案

```
 #name yourfile with the myitems = [...] to items.py
 import items
 new_items = [reversed(l) for l in items.myitems] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-30T23:39:53.187

```
import re

f = open('myfile.txt', 'r')
newItems = []
for line in f:
    foo = re.search("\'(.*)\'.*\'(.*)\'", line) #we assume the values are 
                                                #in single quotes
    if foo is not None:
        a, b = foo.groups()
        newItems.append([b, a]) 
```

# php - PHP 无法读取 /var/tmp 上的文件

> ID：12206857
> 
> 赞同：4
> 
> 时间：2012-08-30T23:08:22.887
> 
> 标签：php, apache, fedora

我有一个非常奇怪的错误。PHP 无法读取确实存在的文件...一些想法？我还没有安装 SELinux。我正在使用 Fedora 17 和 php 5.4。

我已经尝试了我所知道的一切，但问题仍然存在。

```
[root@sqd var]# ls -lia 
total 92
  8194 drwxrwxrwx. 23 root   root   4096 ago 17 10:30 .
     2 dr-xr-xr-x. 19 root   root   4096 ago 13 16:00 ..
 32139 drwxr-xr-x.  2 root   root   4096 may 22 13:42 account
   288 drwxr-xr-x.  2 root   root   4096 feb  3  2012 adm
    13 drwxr-xr-x. 14 root   root   4096 ago  8 10:26 cache
796005 drwxr-xr-x   2 root   root   4096 feb  6  2012 cvs
   289 drwxr-xr-x.  3 root   root   4096 ago 21 18:07 db
   290 drwxr-xr-x.  3 root   root   4096 may 22 13:42 empty
263682 drwxr-xr-x.  3 root   root   4096 ago  7 11:15 ftp
   291 drwxr-xr-x.  2 root   root   4096 feb  3  2012 games
 35931 drwxrwx--T.  2 root   gdm    4096 jun  8 16:05 gdm
   292 drwxr-xr-x.  2 root   root   4096 feb  3  2012 gopher
    15 drwxr-xr-x. 45 root   root   4096 ago 10 10:42 lib
   296 drwxr-xr-x.  2 root   root   4096 feb  3  2012 local
   308 lrwxrwxrwx.  1 root   root     11 may 22 13:39 lock -> ../run/lock
    12 drwxr-xr-x. 14 root   root   4096 ago 26 03:17 log
   297 lrwxrwxrwx.  1 root   root     10 may 22 13:39 mail -> spool/mail
   298 drwxr-xr-x.  2 root   root   4096 feb  3  2012 nis
931987 drwxrwxrwx   3 nobody nobody 4096 ago 17 10:32 nodejs
   299 drwxr-xr-x.  2 root   root   4096 feb  3  2012 opt
   300 drwxr-xr-x.  2 root   root   4096 feb  3  2012 preserve
   307 lrwxrwxrwx.  1 root   root      6 may 22 13:39 run -> ../run
   301 drwxr-xr-x. 15 root   root   4096 may 22 13:43 spool
   305 drwxrwxrwx.  5 nobody nobody 4096 ago 30 14:13 tmp
262637 drwxr-xr-x.  7 root   root   4096 ago  7 11:20 www
   306 drwxr-xr-x.  2 root   root   4096 feb  3  2012 yp

[root@sqd var]# ls -lia tmp/
total 216
    305 drwxrwxrwx.  5 nobody nobody   4096 ago 30 14:13 .
   8194 drwxrwxrwx. 23 root   root     4096 ago 17 10:30 ..
   3030 -rwxrwxrwx   1 nobody nobody 199397 ago 30 14:13 file_thumb_5363_1_0.jpg 
```

但

```
<?php
highlight_file(__FILE__);

var_dump(file_exists('/var/tmp/file_thumb_5363_1_0.jpg')); 
```

打印：

```
bool(false) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-30T23:13:51.453

**Fedora 16**引入了“**私有 tmp** ”的概念`/tmp`，`/var/tmp`我会在这个方向上投入 2 美分。

**[从手册](http://docs.fedoraproject.org/en-US/Fedora/17/html/Release_Notes/sect-Release_Notes-Changes_for_Sysadmin.html)：**

> 2.3.3。服务私有 /tmp
> 由 systemd 管理的许多服务已被修改，以利用其为它们提供私有 /tmp 目录的能力。以前发现使用 /tmp 和 /var/tmp 的特权服务容易受到非特权用户的干扰，从而可能导致特权升级。为服务使用私有 /tmp 目录可以防止这种攻击方式。
> 
> 为修改后的服务添加到 systemd 单元文件的指令是：
> 
> [服务]
> PrivateTmp=true

# c - 如何通过在 C 中传递多个参数的指针调用函数？

> ID：12206865
> 
> 赞同：1
> 
> 时间：2012-08-30T23:09:25.060
> 
> 标签：c, function, pointers, function-pointers

我需要创建一个“函数调用者”函数：它接收一个通用函数指针 ( `void *`) 和可变数量的参数作为参数，它必须调用这个函数，传递参数，并返回一个指向返回值的通用指针。但是，这个入口函数指针可以指向任何类型的函数（具有任何返回类型），甚至可以指向具有恒定数量参数的函数。它会是这样的：

```
void * function_caller(void * function_pointer, ...) {
  void * returning_value;

  // Call the function and get the returning value

  return returning_value;   // this returning value will be properly casted outside
} 
```

这样，以下代码将起作用：

```
int function1(int a, char b) {
  // ...
}

void function2(float c) {
  // ...
}

float function3() {
  // ...
}

int main() {
  int v1;
  float v3;

  v1 = *(int *) function_caller((void *) &function1, 10, 'a');  // Which would be equivalent to v1 = function1(10, 'a');
  function_caller((void *) &function2, 3.0);    // Which would be equivalent to function2(3.0);
  v3 = *(float *) function_caller((void *) &function3); // Which would be equivalent to v3 = function3();

  return 0;
} 
```

我知道我必须使用 a `va_list`，但我不知道如何通过传递参数的指针调用函数。

所以，伙计们，有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T23:13:41.623

坏消息是，这在 C 中是不可能的，即使在不可移植的 C 中也是如此。（GCC 有一些扩展，*听起来好像*它们可以完成这项工作，但它们在一般情况下不起作用。）有必要编写汇编语言填充程序。

好消息是，其他人已经为您编写了垫片：看看[libffi](http://sourceware.org/libffi/)。（[此处为手册](http://www.manpagez.com/info/libffi/libffi-3.0.11/libffi_3.php#The-Basics)。如果可以避免，请不要使用“闭包”API。）

# php - PHP从数据库中的字段将html写入php页面

> ID：12206871
> 
> 赞同：1
> 
> 时间：2012-08-30T23:09:46.177
> 
> 标签：php, html, echo

我对此比较陌生，并且熟悉 PHP 中的 echo，但我需要将数据库中的字段内容放在页面中（但不是作为书面字段）

例如

```
<?php echo $product_description['description']; ?> 
```

字段描述中已经有 html 格式，所以当我使用“echo”时，它会写出例如

```
<p>text on firstline <br> text on next line 
```

我想要的是来自数据库中这个字段的这个 html 已经具有 html 格式的简单放置在 php 页面中，这将使它看起来像这样

第一行文字
下一行文字

我假设我只需要使用与 ECHO 不同的命令，但不知道是哪一个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T23:14:44.370

尝试

```
echo html_entity_decode($product_description["description"]); 
```

如果可行，则数据库中的 HTML 已使用 htmlentities 进行编码，因此您必须对其进行解码才能写入页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T23:16:49.550

strip_tags 是您所追求的。

像这样使用它：`echo strip_tags($your database bit to echo here);` [strip_tags 的 PHP 文档](http://www.php.net/manual/en/function.strip-tags.php)

# c# - 如何绑定我的列表视图组合框的选定项目

> ID：12206873
> 
> 赞同：3
> 
> 时间：2012-08-30T23:10:09.073
> 
> 标签：c#, wpf, mvvm-light

我对此感到非常困惑-如果答案真的很明显，我很抱歉，但我对编程很陌生。

我将用户控件设置为视图，该视图加载到我的主视图中的内容控件中。用户控件（称为 SetView）的数据上下文在 MainView 中设置。我可以愉快地将 SetView 绑定到 UserControlVM（称为 SetVM）。

在 SetVM 中，我加载了我创建的类的 ObservableCollection：

```
 public class WeightSet : Weights
{

    public string BodyArea { get; set; }
    public string ExerciseType { get; set; }
    public int SetNumber { get; set; }
    public static ObservableCollection<int> Reps { get; set; }

    #region Constructor

    //This is the main constructor
    public WeightSet(string bodyarea, string exerciseType, int setNumber)
    {
        BodyArea = bodyarea;
        ExerciseType = exerciseType;
        SetNumber = setNumber;
        Reps = new ObservableCollection<int>();
        AddReps();

    }

    #endregion Constructor

    #region Methods

    public void AddReps()
    {
        for (int i = 1; i < 100; i++)
        {
            Reps.Add(i);
        }
    }
    #endregion Methods 
```

我的 SetView 然后有一个 ListView 其 ItemsSource 是

```
public ObservableCollection<WeightSet> Sets 
```

这是 ListView 的 xaml：

```
<UserControl x:Class="CalendarTest.SetView"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         xmlns:forcombo="clr-namespace:CalendarTest.Model.Repository.Local_Data"
         xmlns:VM="clr-namespace:CalendarTest.ViewModel"
         mc:Ignorable="d" 
         d:DesignHeight="165" d:DesignWidth="300">
<Grid >
    <StackPanel>
    <StackPanel Orientation="Horizontal">
        <Label Content="{Binding CurrentExercise}" Width="100" Height="40"></Label>
        <Label Content="{Binding BodyArea}" Width="100" Height="40"></Label>

    </StackPanel>
        <ListView ItemsSource="{Binding Sets}">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="Set Number" DisplayMemberBinding="{Binding Path=SetNumber}" Width="100"></GridViewColumn>
                    <GridViewColumn Header="Select Reps" Width="120">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <ComboBox Width="100" ItemsSource="{Binding Source={x:Static forcombo:WeightSet.Reps }}" ></ComboBox>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>

                    </GridViewColumn>
                    <GridViewColumn DisplayMemberBinding="{Binding Path=Reps}"></GridViewColumn>
                </GridView>
            </ListView.View>

        </ListView>
    </StackPanel>

</Grid> 
```

当我加载 SetView 时，我有一组数字列表和一个带有静态列表的组合框。这是一个镜头：

![在此处输入图像描述](../Images/20f9def7a5cae638f99432ecbad247e3.png)

我似乎无法将组合框的选定项绑定回我的 ViewModel。有没有办法在 WeightSet 类中设置所选项目？我需要能够保存所选号码吗？

我知道我不能只绑定到一个属性，因为 ComboBox 的数量将由用户决定？对我当前设计的任何提示或更正将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T01:08:43.940

您可以在您的组合框上绑定该`SelectedItem`属性，并在您的 WeightSet 类中添加一个依赖属性

xml:

```
<ComboBox ItemsSource="{Binding Source={x:Static forcombo:WeightSet.Reps }}"
          SelectedItem="{Binding SelectedItem}" /> 
```

和财产

```
public static readonly DependencyProperty SelectedItemProperty =
    DependencyProperty.Register("SelectedItem", typeof (int), typeof (WeightSet), new PropertyMetadata(default(int)));

public int SelectedItem {
    get { return (int) GetValue(SelectedItemProperty); }
    set { SetValue(SelectedItemProperty, value); }
} 
```

然后`SelectedItem`，当在组合框中选择一个值时，您的 Sets 实例将被更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T02:08:24.757

这里的关键是将组合框的 SelectedItem 依赖属性绑定到视图模型中的合适属性

首先，您需要在 Weightset 类中实现[INotifyPropertyChanged 。](http://msdn.microsoft.com/en-us/library/ms229614.aspx)

接下来在 WeightClass 中引入一个名为 say SelectedRep 的属性，它看起来像

```
int _selectedRep;
///<summary>Gets or sets SelectedRep.</summary>            
public int SelectedRep
{
    get { return _selectedRep; }
    set { _selectedRep = value; OnPropertyChanged("SelectedRep"); }
} 
```

最后修改 Xaml 以将 ComboBox 的 SelectedItem 绑定到 SelectedRep 属性。

```
<ComboBox Width="100" ItemsSource="{Binding Source={x:Static forcombo:WeightSet.Reps }}"  SelectedItem="{Binding SelectedRep, Mode=TwoWay}" /> 
```

# objective-c - 编写远程 I/O 渲染回调函数时遇到问题

> ID：12206875
> 
> 赞同：5
> 
> 时间：2012-08-30T23:10:17.843
> 
> 标签：objective-c, ios, callback, core-audio, audiounit

我正在编写一个 iOS 应用程序，它从麦克风获取输入，通过高通滤波器音频单元运行它，然后通过扬声器播放它。通过使用 AUGraph API，我已经能够成功地做到这一点。在其中，我放置了两个节点：一个远程 I/O 单元和一个效果音频单元 ( `kAudioUnitType_Effect`, `kAudioUnitSubType_HighPassFilter`)，并将 io 单元的输入元素的输出范围连接到效果单元的输入，并将效果节点的输出连接到 io 单元的输出元素的输入范围。但是现在我需要根据处理后的音频样本做一些分析，所以我需要直接访问缓冲区。这意味着（如果我错了，请纠正我）我不能再使用`AUGraphConnectNodeInput`为了在效果节点的输出和 io 单元的输出元素之间建立连接，并且必须为 io 单元的输出元素附加一个渲染回调函数，这样我就可以在扬声器需要新样本时访问缓冲区。我已经这样做了，但是当我`AudioUnitRender`在渲染回调中调用该函数时出现 -50 错误。我相信我有两个音频单元之间的 ASBD 不匹配的情况，因为我在渲染回调中没有对此做任何事情（并且 AUGraph 之前已经处理过它）。这是代码：

音频控制器.h：

```
@interface AudioController : NSObject
{
    AUGraph mGraph;
    AudioUnit mEffects;
    AudioUnit ioUnit;
}

@property (readonly, nonatomic) AudioUnit mEffects;
@property (readonly, nonatomic) AudioUnit ioUnit;

-(void)initializeAUGraph;
-(void)startAUGraph;
-(void)stopAUGraph;

@end 
```

音频控制器.mm：

```
@implementation AudioController

…

static OSStatus renderInput(void *inRefCon, AudioUnitRenderActionFlags *ioActionFlags, const AudioTimeStamp *inTimeStamp, UInt32 inBusNumber, UInt32 inNumberFrames, AudioBufferList *ioData)
{
    AudioController *THIS = (__bridge AudioController*)inRefCon;

    AudioBuffer buffer;

    AudioStreamBasicDescription fxOutputASBD;
    UInt32 fxOutputASBDSize = sizeof(fxOutputASBD);
    AudioUnitGetProperty([THIS mEffects], kAudioUnitProperty_StreamFormat, kAudioUnitScope_Output, 0, &fxOutputASBD, &fxOutputASBDSize);

    buffer.mDataByteSize = inNumberFrames * fxOutputASBD.mBytesPerFrame;
    buffer.mNumberChannels = fxOutputASBD.mChannelsPerFrame;
    buffer.mData = malloc(buffer.mDataByteSize);

    AudioBufferList bufferList;
    bufferList.mNumberBuffers = 1;
    bufferList.mBuffers[0] = buffer;

    //TODO prender ARM y solucionar problema de memoria

    OSStatus result = AudioUnitRender([THIS mEffects], ioActionFlags, inTimeStamp, inBusNumber, inNumberFrames, &bufferList);
    [THIS hasError:result:__FILE__:__LINE__];

    memcpy(ioData, buffer.mData, buffer.mDataByteSize);

    return noErr;
}

- (void)initializeAUGraph
{
    OSStatus result = noErr;

    // create a new AUGraph
    result = NewAUGraph(&mGraph);

    AUNode outputNode;
    AUNode effectsNode;

    AudioComponentDescription effects_desc;
    effects_desc.componentType = kAudioUnitType_Effect;
    effects_desc.componentSubType = kAudioUnitSubType_LowPassFilter;
    effects_desc.componentFlags = 0;
    effects_desc.componentFlagsMask = 0;
    effects_desc.componentManufacturer = kAudioUnitManufacturer_Apple;

    AudioComponentDescription output_desc;
    output_desc.componentType = kAudioUnitType_Output;
    output_desc.componentSubType = kAudioUnitSubType_RemoteIO;
    output_desc.componentFlags = 0;
    output_desc.componentFlagsMask = 0;
    output_desc.componentManufacturer = kAudioUnitManufacturer_Apple;

    // Add nodes to the graph to hold the AudioUnits
    result = AUGraphAddNode(mGraph, &output_desc, &outputNode);
    [self hasError:result:__FILE__:__LINE__];
    result = AUGraphAddNode(mGraph, &effects_desc, &effectsNode );
    [self hasError:result:__FILE__:__LINE__];

    // Connect the effect node's output to the output node's input
    // This is no longer the case, as I need to access the buffer
    // result = AUGraphConnectNodeInput(mGraph, effectsNode, 0, outputNode, 0);
    [self hasError:result:__FILE__:__LINE__];

    // Connect the output node's input scope's output to the effectsNode input
    result = AUGraphConnectNodeInput(mGraph, outputNode, 1, effectsNode, 0);
    [self hasError:result:__FILE__:__LINE__];

    // open the graph AudioUnits
    result = AUGraphOpen(mGraph);
    [self hasError:result:__FILE__:__LINE__];

    // Get a link to the effect AU
    result = AUGraphNodeInfo(mGraph, effectsNode, NULL, &mEffects);
    [self hasError:result:__FILE__:__LINE__];

    // Same for io unit
    result = AUGraphNodeInfo(mGraph, outputNode, NULL, &ioUnit);
    [self hasError:result:__FILE__:__LINE__];

    // Enable input on io unit
    UInt32 flag = 1;
    result = AudioUnitSetProperty(ioUnit, kAudioOutputUnitProperty_EnableIO, kAudioUnitScope_Input, 1, &flag, sizeof(flag));
    [self hasError:result:__FILE__:__LINE__];

    // Setup render callback struct
    AURenderCallbackStruct renderCallbackStruct;
    renderCallbackStruct.inputProc = &renderInput;
    renderCallbackStruct.inputProcRefCon = (__bridge void*)self;

    // Set a callback for the specified node's specified input
    result = AUGraphSetNodeInputCallback(mGraph, outputNode, 0, &renderCallbackStruct);
    [self hasError:result:__FILE__:__LINE__];

    // Get fx unit's input current stream format...
    AudioStreamBasicDescription fxInputASBD;
    UInt32 sizeOfASBD = sizeof(AudioStreamBasicDescription);

    result = AudioUnitGetProperty(mEffects, kAudioUnitProperty_StreamFormat, kAudioUnitScope_Input, 0, &fxInputASBD, &sizeOfASBD);
    [self hasError:result:__FILE__:__LINE__];

    // ...and set it on the io unit's input scope's output 
    result = AudioUnitSetProperty(ioUnit,
                                  kAudioUnitProperty_StreamFormat,
                                  kAudioUnitScope_Output,
                                  1,
                                  &fxInputASBD,
                                  sizeof(fxInputASBD));
    [self hasError:result:__FILE__:__LINE__];

    // Set fx unit's output sample rate, just in case
    Float64 sampleRate = 44100.0;

    result = AudioUnitSetProperty(mEffects,
                                  kAudioUnitProperty_SampleRate,
                                  kAudioUnitScope_Output,
                                  0,
                                  &sampleRate,
                                  sizeof(sampleRate));
    [self hasError:result:__FILE__:__LINE__];

    // Once everything is set up call initialize to validate connections
    result = AUGraphInitialize(mGraph);
    [self hasError:result:__FILE__:__LINE__];
}

@end 
```

正如我之前所说，我在`AudioUnitRender`通话中收到 -50 错误，而且我几乎没有找到关于它的文档。

任何帮助都感激不尽。

感谢 Tim Bolstad ( [http://timbolstad.com/2010/03/14/core-audio-getting-started/](http://timbolstad.com/2010/03/14/core-audio-getting-started/) ) 提供了出色的起点教程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T16:19:40.047

检查以确保您确实在进行所有必要的连接。看来您正在初始化几乎所有必要的东西，但如果您只是想通过音频，则不需要渲染回调函数。

现在，如果您想做过滤器，您可能需要一个，但即便如此，请确保您实际上将组件正确连接在一起。

这是我正在开发的应用程序的一个片段：

```
AUGraphConnectNodeInput(graph, outputNode, kInputBus, mixerNode, kInputBus);
AUGraphConnectNodeInput(graph, mixerNode, kOutputBus, outputNode, kOutputBus); 
```

这会将 RemoteIO 单元的输入连接到多通道混音器单元，然后将混音器的输出连接到 RemoteIO 的输出到扬声器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T16:38:05.003

有使用 RemoteIO 来播放音频缓冲区的更简单的工作示例。也许从第一个而不是图表开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-05T01:17:52.220

在我看来，您将错误的音频单元传递给`AudioUnitRender`. 我认为您需要传入`ioUnit`而不是`mEffects`. 无论如何，请仔细检查您传入的所有参数`AudioUnitRender`。当我看到 -50 返回时，那是因为我搞砸了其中一个。

# javascript - 我有一个 JavaScript“意外标识符”错误。谁能帮我？

> ID：12206878
> 
> 赞同：1
> 
> 时间：2012-08-30T23:10:51.703
> 
> 标签：javascript, json, function

错误发生在 if 语句内的第 38 行和第 39 行之间（根据 Chrome JS 控制台。我认为这意味着我的错误在第 39 行）。我不知道我做错了什么，如果有人可以帮助我，那就太棒了。谢谢。如果你想在我破解它之前查看代码，这个应用程序在[http://piratena.me/上实时运行](http://piratena.me/)

```
/*This object is a simple dictionary that matches every letter of the alphabet to a pirate-related string.*/

var altDictionary = {
    a: 'arr', 
    b: 'pegleg', 
    c: 'timber', 
    d: 'monkey', 
    e: 'knife', 
    f: 'powder', 
    g: 'grog', 
    h: 'scuttle', 
    i: 'keel', 
    j: 'cannon', 
    k: 'sparrow', 
    l: 'cutlass', 
    m: 'mast', 
    n: 'plank', 
    o: 'matey', 
    p: 'bag', 
    q: 'doubloon', 
    r: 'rope', 
    s: 'rum', 
    t: 'chip', 
    u: 'lubber', 
    v: 'spit', 
    w: 'patch', 
    x: 'salt', 
    y: 'tack', 
    z: 'tortuga'
}

/*This function loops through the input from the user, replacing each letter in their name with a pirate-related string.*/

var altName = function(name) {
    var result = "";
    for (i=0; i<name.length; i++) {
        var ind=name[i];
        if isAlpha(ind) === true {
            ind = toLowerCase(ind);
            var syl = altDictionary[ind];
            result = result + syl + "-";
        } else {
            alert("Your name can only contain alphabetical letters.");
        }
    }
    result = result.substring(0, result.length - 1)
    return result;
};

/*This block of jQuery inserts the newly created Pirate Name into the output field*/

$(document).ready(function() {
    $('form #click_button').click(function(event) {
        event.preventDefault();
        var name = $('#input_box').val();   
        $('#output p').text(altName(name));
    });
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-30T23:13:32.747

我注意到的第一件事是：

```
if isAlpha(ind) === true 
```

为什么没有括号？

```
if (isAlpha(ind) === true) 
```

顺便说一句，建议我们查看您的实时示例以发现您运行的代码与您在问题中提供的代码不同，这无济于事。

# java - java-如何编写一个进程来拦截远程机器上运行的程序的输出流/知道远程程序何时停止/完成

> ID：12206879
> 
> 赞同：0
> 
> 时间：2012-08-30T23:10:59.090
> 
> 标签：java, python, ruby, remote-debugging

我想在远程机器上运行一个 java 程序，并截取它的日志——我还想知道程序是否已完成执行，以及它是否成功执行或是否由于错误而停止执行。

是否有任何现成的 java 库可用于此目的？另外，我希望能够使用这个程序来获取不同语言的远程程序的日志/执行完成——比如 Java/Ruby/Python 等——

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T23:14:36.123

如果您只想确定它何时完成（而不是真正捕获所有输出，如在您的其他问题中），您可以简单地检查进程 id 的存在，并且当您找不到进程 id 时，打电话回家。你真的不需要日志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T23:33:57.433

您应该查看 Apache Commons [Tailer](http://commons.apache.org/io/api-release/org/apache/commons/io/input/Tailer.html)以从另一个进程的日志中读取。至于检查进程是否成功完成，这有点棘手。我会将进程的执行包装在一个 shell 脚本中，该脚本将状态写入一个 Java 程序可以检查的文件。有关如何执行此操作的更多信息，请参见[此处。](http://www.cyberciti.biz/faq/shell-how-to-determine-the-exit-status-of-linux-and-unix-command/)

# javascript - 将 JQuery Promise 数组转换为数组的 JQuery Promise 的最简洁方法是什么？

> ID：12206885
> 
> 赞同：15
> 
> 时间：2012-08-30T23:11:27.793
> 
> 标签：javascript, jquery, coffeescript, promise

我遇到了一个数组中有多个 JQuery Promise 的情况

```
var arrayOfPromises = [ $.Deferred(), $.Deferred(), $.Deferred(), $.Deferred() ] 
```

并且需要把它变成一个数组的 JQuery Promise

```
var promiseOfArray = someTransform(arrayOfPromises) 
```

在哪里

```
promiseOfArray.done(function(anArray){
  alert(anArray.join(","));
}); 
```

创建带有文本的警报

> 结果1，结果2，结果3，结果4

我目前在咖啡脚本中定义`someTransform`为

```
someTransform = (arrayOfPromises) ->
  $.when(arrayOfPromises...).pipe (promises...) ->
    promises 
```

转换为以下 javascript

```
var someTransform,
  __slice = [].slice;

someTransform = function(arrayOfPromises) {
  return $.when.apply($, arrayOfPromises).pipe(function() {
    var promises;
    promises = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    return promises;
  });
}; 
```

这是我正在寻找的结果[的 jsFiddle 。](http://jsfiddle.net/qk2mT/3/)

我想知道是否有更好（更短，更清洁）的定义方式`someTransform`来实现相同的结果？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-08-30T23:12:55.307

您可以[将](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)数组作为参数应用到`$.when`.

```
var promiseOfArray = $.when.apply($, arrayOfPromises); 
```

为了更清楚地使用它，我喜欢添加一个方法`$`：

```
$.whenall = function(arr) { return $.when.apply($, arr); }; 
```

现在你可以这样做：

```
$.whenall([deferred1, deferred2, ...]).done(...); 
```

* * *

**更新：**默认情况下，`done`处理程序将每个结果作为单独的参数传递；你没有得到一系列结果。

由于您需要处理任意数量的 Deferred，您可以使用特殊的隐式[`arguments`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments)对象来循环结果。

```
$.whenall([d1, d2, ...]).done(function() {
    for (var i = 0; i < arguments.length; i++) {
        // do something with arguments[i]
    }
}); 
```

如果你真的只想加入所有延迟的字符串结果，我们可以使用一个小数组黑客。 `arguments`类似于数组，但不是`Array`：

```
$.whenall([d1, d2, ...]).done(function() {
    alert(Array.prototype.join.call(arguments, ','));
}); 
```

* * *

如果您想将结果数组返回给您的`done`回调，我们可以进行`whenall` [调整](http://jsfiddle.net/josh3736/9YEsP/)：

```
$.whenall = function(arr) {
    return $.when.apply($, arr).pipe(function() {
        return Array.prototype.slice.call(arguments);
    });
}; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-30T23:15:52.183

`$.when.apply`当我们需要在多个 Promise 上调用它时，总是输入“丑陋”的行也让我很困扰。但是`Function.prototype.bind`为了救命！

```
var when = Function.prototype.apply.bind( jQuery.when, null ); 
```

现在，我们可以打电话

```
when( someArrayWithPromises ).done(function() {
}); 
```

^(`Function.prototype.bind`是 ES5 的一部分，并且可以在浏览器中广泛使用。如果您还需要支持非常旧的浏览器，则有大量简单的*shims可用*)

# matlab - Matlab中的逆不完全伽马函数

> ID：12206890
> 
> 赞同：4
> 
> 时间：2012-08-30T23:12:03.703
> 
> 标签：matlab, math, numerical-computing

我有一个问题是由不完全 Gamma 函数和反不完全 Gamma 函数提出的。回想一下，当 Gamma 函数是从 0 到无穷大的特定积分时，不完整的 gamma 函数添​​加另一个参数 x，并从 0 到 x（下不完整）和从 x 到无穷大（上不完整）积分。

我知道 Matlab 具有涵盖所有这些函数的函数：完整的 Gamma 函数、上下不完整的 Gamma 函数以及逆函数。然而，Matlab 将它们的不完全 Gamma 函数实现为**正则化**的不完全 Gamma 函数，也就是说，它们被完全 Gamma 函数相除。

我正在寻找**非正则化**不完全 Gamma 函数的 Matlab 实现，尤其是**逆不完全**Gamma 函数。有谁知道这样的事情，或者构造一个简单的方法？（“前向”不完全 Gamma 函数很容易通过缩放来实现，但可能有更快的实现。如果有一个简单的逆实现，我就想不通了。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-04-25T18:38:03.727

自 R2014a 版本以来，MATLAB 合并了函数*igamma*，它可以满足您的需求（当时是 2012 年......）：

> 我正在寻找非正则化不完全 Gamma 函数的 Matlab 实现，尤其是逆不完全 Gamma 函数。

只为让大家知道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T20:08:23.873

如果您愿意与 C/C++ 交互，GSL（GNU 科学库）具有规范化和非规范化不完全 Gamma 函数的实现，例如 gsl_sf_gamma_inc。

或者在 C 中运行 GSL 版本，以快速检查您的 Matlab 结果。

# c++ - C ++ - 在另一个类中实例化对象时调用默认构造函数以外的构造函数

> ID：12206895
> 
> 赞同：1
> 
> 时间：2012-08-30T23:12:37.630
> 
> 标签：c++, class, constructor

随意编辑标题我不知道如何表达这个。

我试图弄清楚如何在另一个类中实例化一个类的构造函数而不是默认值。我的意思是这个...

```
class A
{
public:
    A(){cout << "i get this default constructor when I create a B" << endl;}
    A(int i){cout << "this is the constructor i want when I create a B" << endl;}
};

class B
{
    A a;
};

int main()
{
    B *ptr = new B;
    return 0;
} 
```

我已经做了一些搜索，但我没有看到一种方法来做我想做的事。我想也许在 B 的声明中我可以做到`A a(5)`，但这不起作用。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-30T23:13:45.257

您可以使用[构造函数初始化列表](http://www.learncpp.com/cpp-tutorial/101-constructor-initialization-lists/)来做到这一点（您可能还想查看[这个问题](https://stackoverflow.com/questions/4589237/c-initialization-lists)和其他类似的问题）。

这意味着您将不得不手动编写一个构造函数`B`：

```
class B
{
    A a;

    public: B() : a(5) {}
}; 
```

**[看到它在行动](http://ideone.com/sH4T0)**。

# c++ - GLM - 来自方向的矩阵正在创建行主矩阵而不是列主矩阵？

> ID：12206908
> 
> 赞同：3
> 
> 时间：2012-08-30T23:13:53.930
> 
> 标签：c++, math, matrix

在弄清楚我上一个[问题](https://stackoverflow.com/questions/12132969/opengl-camera-view-matrix-from-quaternion-behaves-incorrectly-and-pitch-is-too)的答案后，我发现原因是某种数学上的怪异。

使用 GLM (OpenGL) 库我创建一个方向如下

```
glm::gtx::quaternion::orientation = 
    glm::gtx::quaternion::angleAxis(pitchAccum, 1.0f, 0.0f, 0.0f) * 
    glm::gtx::quaternion::angleAxis(yawAccum, 0.0f, 1.0f, 0.0f); 
```

现在，如果我从这个方向创建一个矩阵，它不再是列主要的，而是以某种方式成为行主要的

```
 glm::mat4 view = glm::gtx::quaternion::toMat4(orientation); 
```

换句话说，通过使用行主索引访问矩阵来找到 3 个坐标轴

```
view[0][0], view[1][0], view[2][0]  // X axis
view[0][1], view[1][1], view[2][1]  // Y axis
view[0][2], view[1][2], view[2][2]  // Z axis 
```

换句话说，旋转部分的转置。

矩阵的平移部分仍应使用主要列设置，以使最终视图矩阵按预期工作。

```
view[3][0] = -glm::dot(glm::vec3(view[0][0], view[1][0], view[2][0]), position);    // Right
view[3][1] = -glm::dot(glm::vec3(view[0][1], view[1][1], view[2][1]), position);    // Up
view[3][2] = -glm::dot(glm::vec3(view[0][2], view[1][2], view[2][2]), position);    // Forward 
```

为什么在使用方向时旋转矩阵从列主要翻转到行主要（转置？）？

编辑：

```
// Move forward
if (glfwGetKey('W') == GLFW_PRESS)
{
    //movement += glm::vec3(view[2][0], view[2][1], view[2][2]);  // incorrect
    movement += -glm::vec3(view[0][2], view[1][2], view[2][2]);   // correct
}
// Move backward
if (glfwGetKey('S') == GLFW_PRESS)
{
    //movement += -glm::vec3(view[2][0], view[2][1], view[2][2]); // incorrect
    movement += glm::vec3(view[0][2], view[1][2], view[2][2]);    // correct
}
// Strafe left
if (glfwGetKey('A') == GLFW_PRESS)
{
    //movement += -glm::vec3(view[0][0], view[0][1], view[0][2]);  // incorrect
    movement += -glm::vec3(view[0][0], view[1][0], view[2][0]);    // correct
}
// Strafe right
if (glfwGetKey('D') == GLFW_PRESS)
{
    //movement += glm::vec3(view[0][0], view[0][1], view[0][2]);  // incorrect
    movement += glm::vec3(view[0][0], view[1][0], view[2][0]);    // correct
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-31T01:41:30.907

从空间 A 变换到空间 B 的矩阵 M 具有空间 A 的基向量，但相对于空间 B 表示。

相机矩阵从世界空间转换到相机空间。因此，从相机空间看，相机矩阵的基向量是*世界空间的基向量。*不是*相机空间*的基向量。

相机相对于世界空间的方向是这种变换的*倒数*。而且由于旋转矩阵的逆矩阵是*transpose*，所以您有问题。

问题不在于矩阵。*问题在于你认为*矩阵所说的和它实际所说的之间的差异。

# objective-c - 如何创建应用内设置视图？

> ID：12206910
> 
> 赞同：0
> 
> 时间：2012-08-30T23:14:08.330
> 
> 标签：objective-c, ios, cocoa-touch, xcode4.3

我想创建一个应用内设置视图，如下图所示：

![设置截图](../Images/4aed49833dae7075ee5a3fedc8e09d02.png)

这些字段叫什么？以及创建设置的最佳方式是什么？

我发现了很多教程，但它们都指的是在手机设置中创建设置页面，使用设置包，我想要的是在应用程序本身中创建设置页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T15:03:00.970

[http://www.inappsettingskit.com](http://www.inappsettingskit.com)和[http://inscopeapps.com/#inappsettings](http://inscopeapps.com/#inappsettings)都使用标准的 Settings.app 包。因此，您可以在您的应用和标准 Settings.app 中设置默认值。它们很简单，可以添加您的项目并且运行良好。

如果您只希望设置在应用程序中，那么您的屏幕截图只会显示一个`UINavigationController`带有`UITableViews`. 您可以使用 Interface Builder 或以编程方式以标准方式创建类似的内容，然后通过保存`NSUserDefaults`对象/整数/布尔值/URL 来响应任何更改的设置。

无论您选择哪种方法，`NSUserDefaultsDidChangeNotification`在任何需要立即响应更改的视图中添加一个观察者（如果您不需要立即响应，您可以简单地实时读取`NSUserDefaults`对象/整数/布尔值/URL的当前值）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T23:16:14.963

尝试使用应用内设置工具包。

可以在这里找到：http: [//www.inappsettingskit.com](http://www.inappsettingskit.com)

# c# - ASP.NET 问题设置 CompareValidator.ValueToCompare

> ID：12206912
> 
> 赞同：2
> 
> 时间：2012-08-30T23:14:31.840
> 
> 标签：c#, asp.net, semantics, comparevalidator

我希望有人能帮忙。我到处都检查过这个问题的答案，但找不到任何东西。我无法让我的第一个 if 语句“开火”。

在我的表单中，我有一个文本框供用户输入数量，当它是子类别名称中带有“箔”和“标准”或“印刷”和“迷你”的产品时，我试图将其验证为 150 . 如果它没有这 4 个单词中的任何一个，那么最小数量应默认为 250。这是我的“数量”文本框的代码：

```
<asp:TextBox ID="txtQuantity" runat="server" Text="Quantity" Width="300" />
<asp:RequiredFieldValidator ID="rfvQuantity" runat="server" ControlToValidate="txtQuantity" ErrorMessage="Quantity Required" Display="None" ValidationGroup="Quote" />
<asp:CompareValidator ID="cmvQuantity" runat="server" ControlToValidate="txtQuantity" ErrorMessage="Insufficient Quantity" Display="None" ValueToCompare="250" Operator="GreaterThanEqual" Type="Integer" ValidationGroup="Quote" />
<asp:CompareValidator ID="cmvQuantityText" runat="server" ControlToValidate="txtQuantity" ErrorMessage="Quantity Required" Display="None" Operator="DataTypeCheck" Type="Integer" ValidationGroup="Quote" /> 
```

这是背后的代码：

```
protected void rptProduct_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {

        ((CompareValidator)e.Item.FindControl("cmvQuantity")).ValueToCompare = ((Product)e.Item.DataItem).SubCategory.Category.Name.Contains("Foil") && ((Product)e.Item.DataItem).SubCategory.Name.Contains("Standard") ? "150" : "250";
        ((CompareValidator)e.Item.FindControl("cmvQuantity")).ValueToCompare = ((Product)e.Item.DataItem).SubCategory.Category.Name.Contains("Printed") && ((Product)e.Item.DataItem).SubCategory.Name.Contains("Mini") ? "150" : "250";
    }
} 
```

由于某种原因，它似乎只适用于最后一个条件，而不是第一个，即使我切换条件语句的位置，它仍然只适用于最后一个语句，而不是第一个。
所以我认为这是一个语义问题？任何帮助将不胜感激！！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T08:13:59.460

我看到的问题是您`ValueToCompare`为相同的比较验证器控件设置了`cmvQuantity`两次，这是完全错误的方式，因为最后要执行的最后一个将是对属性值的最终更改，所以下面是应该在您的情况下工作的实现。

```
protected void rptProduct_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
       Product productInstance = e.Item.DataItem as Product; //safely type cast
       CompareValidator cmvQuantity = e.Item.FindControl("cmvQuantity") as CompareValidator; //safely type cast
       if (cmvQuantity != null && productInstance != null) //check if type cast suceeded and/or control was found.
       {
           if((productInstance.SubCategory.Category.Name.Contains("Foil") && productInstance.SubCategory.Name.Contains("Standard")) ||
              (productInstance.SubCategory.Category.Name.Contains("Printed") && productInstance.SubCategory.Name.Contains("Mini"))
           {
               cmvQuantity.ValueToCompare = "150";
           }
           else
           {
               cmvQuantity.ValueToCompare = "250";
           }
       }
    }
} 
```

一些可能对您有帮助的要点

*   尝试从页面中查找对象并将其放入变量中，而不是在每个新行中查找。例如，不要执行以下操作：

    ```
    public void Method()
    {
        ((CompareValidator)e.Item.FindControl("cmvQuantity")).ValueToCompare = "Test value";
        ((CompareValidator)e.Item.FindControl("cmvQuantity")).ControlToValidate = "txtControlId";
    } 
    ```

    将其实现为：

    ```
    public void Method()
    {
       CompareValidator cmvQuantity = e.Item.FindControl("cmvQuantity") as CompareValidator;
       if (cmvQuantity != null)
       {
           cmvQuantity.ValueToCompare = "Test value";
           cmvQuantity.ControlToValidate = "txtControlId";
       }
    } 
    ```

*   不要在 If-Else-if 中为相同的代码块添加每个新的。例如

    ```
    if (test == 1)
    {
       txtControl.Text = "150";
    }
    else if (test == 2)
    {
        txtControl.Text = "150";
    }
    else
    {
        txtControl.Text = "250";
    } 
    ```

    将其实现为：

    ```
    if (test == 1 || test == 2)
    {
       txtControl.Text = "150";
    }
    else
    {
       txtControl.Text = "250";
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T06:48:04.050

在这里你有或条件，所以我建议你区分条件，

```
 if (e.Item.ItemType == ListItemType.Item)
    {
        ((CompareValidator)e.Item.FindControl("cmvQuantity")).ValueToCompare = ((Product)e.Item.DataItem).SubCategory.Category.Name.Contains("Foil") && ((Product)e.Item.DataItem).SubCategory.Name.Contains("Standard") ? "150" : "250";
        ((CompareValidator)e.Item.FindControl("cmvQuantity")).ValueToCompare = ((Product)e.Item.DataItem).SubCategory.Category.Name.Contains("Printed") && ((Product)e.Item.DataItem).SubCategory.Name.Contains("Mini") ? "150" : "250";
    }
    else if (e.Item.ItemType == ListItemType.AlternatingItem)
    {
        ((CompareValidator)e.Item.FindControl("cmvQuantity")).ValueToCompare = ((Product)e.Item.DataItem).SubCategory.Category.Name.Contains("Foil") && ((Product)e.Item.DataItem).SubCategory.Name.Contains("Standard") ? "150" : "250";
        ((CompareValidator)e.Item.FindControl("cmvQuantity")).ValueToCompare = ((Product)e.Item.DataItem).SubCategory.Category.Name.Contains("Printed") && ((Product)e.Item.DataItem).SubCategory.Name.Contains("Mini") ? "150" : "250";
    } 
```

并检查它是否工作。我没有测试过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T06:53:59.860

如果您考虑一下您的代码的作用，那应该是显而易见的。

首先，你这样做：

```
((CompareValidator)e.Item.FindControl("cmvQuantity")).ValueToCompare = ((Product)e.Item.DataItem).SubCategory.Category.Name.Contains("Foil") && ((Product)e.Item.DataItem).SubCategory.Name.Contains("Standard") ? "150" : "250"; 
```

然后，没有进一步的条件检查，你这样做：

```
((CompareValidator)e.Item.FindControl("cmvQuantity")).ValueToCompare = ((Product)e.Item.DataItem).SubCategory.Category.Name.Contains("Printed") && ((Product)e.Item.DataItem).SubCategory.Name.Contains("Mini") ? "150" : "250"; 
```

因此，如果`(Product)e.Item.DataItem`包含*Foil*和*Standard*，则第一行将 设置`ValueToCompare`为 150。

但是在下一行，这会立即改回 250 ，*除非*`(Product)e.Item.DataItem`还包含`Printed`and `Mini`。

尝试将您的代码更改为：

```
protected void rptProduct_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
        var validator = e.Item.FindControl("cmvQuantity") as CompareValidator;
        var product = (Product)e.Item.DataItem;
        if (validator != null)
        {
            if (product.SubCategory.Category.Name.Contains("Foil") && product.SubCategory.Category.Name.Contains("Standard"))
            {
                validator.ValueToCompare = "150";
            }
            else if (product.SubCategory.Category.Name.Contains("Printed") && product.SubCategory.Category.Name.Contains("Mini"))
            {
                validator.ValueToCompare = "150";
            }
            else
            {
                validator.ValueToCompare = "250";
            }
        }
    }
} 
```

# .net - Redis：我如何INCR和插入？

> ID：12206914
> 
> 赞同：1
> 
> 时间：2012-08-30T23:14:38.300
> 
> 标签：.net, redis, booksleeve

我打开了 CLI 并打开了一个 .NET 虚拟解决方案。我想创建一个用户并一次性插入一些数据。我是如何在 CLI/REPL 中编写的

```
redis 127.0.0.1:6379> incr userCount
(integer) 1
redis 127.0.0.1:6379> set user:1:name acid
OK
redis 127.0.0.1:6379> set user:1:pw zombie
OK 
```

没关系，但是我怎么一口气做到这一点？如果我能在操作结束时获得用户 ID，那就太好了，但在这个例子中我真的不需要它，我想一​​次管道化 3 个命令。我怎么做？另外，也许我应该在交易中这样做？另外我可能应该在插入之前检查名称是否存在，但我还没有做到这一点。

```
using BookSleeve;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace RedisEx
{
    class Program
    {
        static void Main(string[] args)
        {
            using (var conn = new RedisConnection("localhost"))
            {
                conn.Open();
                var userC = conn.Strings.Increment(1, "userCount");
                var userid = conn.Wait(userC);
                if (userid > 1)
                {
                    var sz = conn.Wait(conn.Strings.GetString(1, string.Format("user:{0}:name", userid - 1)));
                    Console.WriteLine(sz);
                }
                conn.Strings.Set(1, string.Format("user:{0}:name", userid), "acid");
                conn.Strings.Set(1, string.Format("user:{0}:pw", userid), "zombie");
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T00:19:40.810

请看这个 C# 示例：

*   [https://github.com/ServiceStack/ServiceStack.Redis](https://github.com/ServiceStack/ServiceStack.Redis)

它说明了将“托运人”记录添加到 Redis“列表”。只需将“用户”替换为“托运人”，并丢失“增量”。您的“计数”只是成为列表中的 #/items :)

示例使用 ServiceStack 代替 Booksleeve，但原理应该完全一样。

'希望有帮助.. PSM

# javascript - 无法在 iOS 中使用 getComputedStyle 访问样式

> ID：12206924
> 
> 赞同：2
> 
> 时间：2012-08-30T23:15:54.353
> 
> 标签：javascript, ios, styles

好的，所以我设计了这个函数来从指定元素返回所需的计算样式。它适用于我测试过的所有桌面浏览器，但是，它不适用于移动 safari。如果我将 getComputedStyle 调用记录回控制台，它是一个很棒的 [object CCStyleDeclaration]，但是当我记录 getPropertyValue 调用时，它只会返回“null”而不是正确的样式。任何帮助都会很棒。谢谢！

```
Utils.getStyle = function(element, style){
    var strValue = "";
     if(document.defaultView && document.defaultView.getComputedStyle){
        strValue = document.defaultView.getComputedStyle(element, "").getPropertyValue(style);
     }else if(element.currentStyle){
        style = style.replace(/\-(\w)/g, function (strMatch, p1){
            return p1.toUpperCase();
        });
        strValue = element.currentStyle[style];
    };
    return strValue;
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T02:58:25.350

如果我对`window.getComputedStyle`vs的评论`document.defaultView.getComputedStyle`有任何实质内容，我会在自己的库中使用此函数：

```
getComputedStyle : function(element){
    var styles = element.currentStyle || getComputedStyle(element, null);
    return styles;
} 
```

适应您的函数签名：

```
Utils.getStyle = function(element, style){
    var styles = element.currentStyle || getComputedStyle(element, null);

    // Prevent a 'Cannot read property X of null' error 
    if(styles != null){
        return styles[style];
    } else {
        return null;
    }
} 
```

不幸的是，我无法在 iOS 中对此进行测试，但我很想知道它是否有效。

# opengl-es - 在 OpenGLes 1.1 中设置边界形状？

> ID：12206926
> 
> 赞同：1
> 
> 时间：2012-08-30T23:16:06.973
> 
> 标签：opengl-es, 3d, geometry

基本上，我正在尝试使用 OpenGL|es 制作一个分层系统，该系统必须支持**层层次结构**（层可以有子层等等）。当图层有父图层时，必须在绘制时将其剪辑到其父图层。当所有层都是矩形时，它是相当直接的，我可以计算出交叉点并裁剪出越界位。但是，每一层也可以有一个变换矩阵，如果我们在另一层中变换一个层，它将不再是矩形，这意味着我不能只计算交叉点。

下图显示了问题（*父母为粉红色，而孩子为浅绿色*）：

![问题](../Images/a2c9eaac2dd6cd0873c70446cccc1369.png)

对于上面的示例，`glScissor`调用就足以设置一个矩形边界框，但这不会这样做，因为父层也可以转换（因此它将不再是矩形）。此外，如果父层被变换，子层的变换矩阵会在子层被渲染之前乘以父层，因此即使在子层被变换时也会产生子层在父层内部的错觉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T23:22:25.657

几点建议：

*   自己剪裁子层的几何图形（速度很快，但你需要做数学）。
*   将每一层渲染成一个纹理（灵活但多层慢）。
*   使用模板缓冲区（填充率密集，层数较多）。

# amazon-web-services - 使用 Chef 以编程方式查找 AWS 公共 DNS

> ID：12206927
> 
> 赞同：2
> 
> 时间：2012-08-30T23:16:11.810
> 
> 标签：amazon-web-services, chef-infra

我目前正在使用 Chef 尝试自动部署几台服务器，但遇到了一些问题。长话短说，我需要以编程方式查找 AWS 实例的公共 dns，但我似乎找不到任何类型的命令来执行此操作。该实例已经是一个节点，所以我正在寻找类似于 Chef::Config[:node_name] 的东西，但要使用公共 dns （Chef::Config[:node_public_dns] 可以解决问题......如果它存在） . 我确信这个功能以某种形式存在，因为在创建节点时 Chef 会将 public_dns 字段吐出到屏幕上。

无论如何，提前谢谢你们！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-01T03:01:38.810

[Ohai](http://wiki.opscode.com/display/chef/Ohai)已经为您挑选了。所以只需在你的食谱中使用 node 属性：

```
node[:ec2][:public_hostname] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-31T12:51:57.270

您可以通过 curl 实例的[元数据服务来获取它，](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/AESDG-chapter-instancedata.html)特别是对于`public-hostname`.

应该是这样的：

```
http://169.254.169.254/latest/meta-data/public-hostname 
```

# html - 在此示例中，如何使边框隐藏在 h3 后面？

> ID：12206929
> 
> 赞同：0
> 
> 时间：2012-08-30T23:16:21.147
> 
> 标签：html, css

[http://jsfiddle.net/fjZfL/31/](http://jsfiddle.net/fjZfL/31/)

我真的希望“谁”部分出现在它前面，你知道吗？我尝试使用 z-index，但无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-30T23:21:11.377

它确实出现在 h3 后面。例如，将段落边框的颜色更改为红色并将其设为 5px，您会看到它位于黑色字母的后面。

# css - 是否有 CSS“haschildren”选择器？

> ID：12206935
> 
> 赞同：28
> 
> 时间：2012-08-30T23:16:59.280
> 
> 标签：css

> **可能重复：**
> [是否有 CSS 父选择器？](http://stackoverflow.com/questions/1014861/is-there-a-css-parent-selector)

是否只有当存在子元素时才能使用 css 选择器？

考虑：

```
<div> <ul> <li></li> </ul> </div> 
```

`display:none`只有当 div 没有至少一个子`<li>`元素时，我才想申请它。

我可以使用任何选择器来执行此操作吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-08-30T23:22:09.707

有点，`:empty`但它是有限的。

示例：http: [//jsfiddle.net/Ky4dA/3/](http://jsfiddle.net/Ky4dA/3/)

即使是文本节点也会导致父节点不被视为空，因此 DIV 内的 UL 会阻止 DIV 匹配。

```
<h1>Original</h1>
<div><ul><li>An item</li></ul></div>

<h1>No Children - Match</h1>
<div></div>

<h1>Has a Child - No Match</h1>
<div><ul></ul></div>

<h1>Has Text - No Match</h1>
<div>text</div>

DIV {
 background-color: red;
 height: 20px;    
}

DIV:empty {
 background-color: green;
} 
```

参考：[http ://www.w3.org/TR/selectors/#empty-pseudo](http://www.w3.org/TR/selectors/#empty-pseudo)

如果你走脚本路线：

```
// pure JS solution
​var divs = document.getElementsByTagName("div");
for( var i = 0; i < divs.length; i++ ){
    if( divs[i].childNodes.length == 0 ){ // or whatever condition makes sense
        divs[i].style.display = "none";
    }        
}​ 
```

当然，jQuery 使这样的任务变得更容易，但是这一项任务不足以包含整个库。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-30T23:18:27.447

不，不幸的是，CSS 选择器无法做到这一点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-30T23:23:34.247

不幸的是，CSS（还）没有任何父规则，如果您必须仅应用包含特定子项的父项，则唯一的解决方法是使用 Javascript，或者更容易使用名为[jQuery](http://jquery.com/)的 javascript 库。

Javascript 可以在某种程度上以类似于 CSS 的方式编写，对于您的示例，我们将在 HTML 页面的底部执行以下操作：

```
<script type="text/javascript">
     $('div:has(ul li)').css("color","red");
</script> 
```

（为此，您需要在文档中包含 jQuery 库，只需将以下内容放入您的`<head></head>`

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-30T23:23:40.687

如果你使用jquery，你可以试试这个功能

```
jQuery.fn.not_exists = function(){
    return this.length <= 0;
}

if ($("div#ID > li").not_exists()) {
    // Do something
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-30T23:39:23.343

还有另一种选择

```
$('div ul').each(function(x,r) {
    if ($(r).find('li').length < 1){
        $(r).css('display','block'); // set display none
    }
}) 
```

# memory-management - 用于处理 Linux 内核中 TLB 未命中的调用图

> ID：12206936
> 
> 赞同：4
> 
> 时间：2012-08-30T23:17:02.170
> 
> 标签：memory-management, linux-kernel, tlb, mmu

我试图了解 linux 内核如何处理 TLB 未命中。具体来说，我知道页表遍历发生在其中`follow_page`，`mm/memory.c`但是当发生 TLB 未命中时，follow_page 是如何调用的。follow_page的返回值 ( `struct page`) 是如何传回硬件的？有人可以说明从硬件引发 TLB 未命中异常到何时`follow_page`被调用的 TLB 未命中处理的调用图吗？

`follow_page`我在内核代码中搜索了[http://lxr.linux.no/linux+v3.4.4/+search=follow_page](http://lxr.linux.no/linux+v3.4.4/+search=follow_page)但结果似乎没有多大帮助。为了清楚起见，假设硬件是 x86_64。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T18:28:53.650

我发现对于大多数 x86 架构，当发生 TLB 未命中时，硬件会执行页面遍历。`follow_page`在`mm/memory.c`TLB 未命中期间不调用软件页面步入代码。因此，据我了解，在 linux 内核中没有用于处理 TLB 未命中的调用图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T16:30:08.600

正如您自己注意到的，自 80386 以来的英特尔处理器的 MMU 具有用于填充转换后备缓冲区的硬件分辨率。这就解释了为什么这种架构的页表具有如此严格的结构。`follow_page`在这个架构上，有很多地方需要遍历页表（如 中），但是，尤其是。在 中`handle_mm_fault`，尽管通常可以预期更具体的情况并放弃大多数测试。

# php - 将循环数组值从 PHP 传递到 JavaScript 和 JQuery

> ID：12206951
> 
> 赞同：0
> 
> 时间：2012-08-30T23:18:54.403
> 
> 标签：php, jquery

我正在尝试在我的 Web 应用程序中创建一个搜索框，并使用 ajax post 向我的服务器发出请求。我的问题是：

是否可以将循环数组值从 PHP 发送到我的 JavaScript？我想从我的服务器获取所有结果。

客户端：Ajax POST 请求

```
<script type="text/javascript">
$(document).ready( function() {
   $.ajax({
       type: "POST",
       url: "searchPlaces.php",
       data: { searchInput: form.searchTxtId.value },
       success: function (result)
       {
            // Get the search result
       }
   });
});
</script> 
```

服务器端（从 ajax 检索帖子并进行查询后）：

```
while ($result = mysql_fetch_assoc ($query))
{
   $resultName = $result['name'];
   $resultAddress = $result['address'];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T23:21:12.843

```
$results = array();
while ($result = mysql_fetch_assoc ($query)) {
   $results[] = $result;
}
echo json_encode(array('results' => $results)); 
```

然后，在您的`success`回调中，您可以迭代`result.results`其中包含一个对象，该对象将查询中的列名作为属性。

```
success: function(result) {
    $.each(results, function(i, row) {
        console.log(row.name, row.address);
    })
} 
```

还建议`dataType: 'json'`在您的`$.ajax({...});`论点中使用，以避免对响应类型进行不必要的猜测。

如果 SQL 结果集中的列多于您想要转发给客户端的列，您可以在循环中添加一个自定义数组：

```
$results[] = array('name' => $row['name'], 'address' => $row['address']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T23:21:46.843

是的，你可以返回一个 json 字符串：

```
$.ajax({
       type: "POST",
       dataType: 'json', // return type is json ;
       url: "searchPlaces.php",
       data: { searchInput: form.searchTxtId.value },
       success: function (result)
       {
            $.each($result,function(index, value){
                 // use params
            } 
       }
   }); 
```

在您的 php 方面，您使用[json_encode()](http://php.net/manual/en/function.json-encode.php)

# statistics - 学习/检测日志中 URL 的可变部分

> ID：12206952
> 
> 赞同：3
> 
> 时间：2012-08-30T23:18:59.673
> 
> 标签：statistics, analysis, logparser

假设您有一个网络服务器日志（apache、nginx 等）。从中提取大量 URL：

```
/article/1/view
/article/2/view
/article/1/view
/article/1323/view
/article/1/edit
/help
/article/1/view
/contact
/contact/thank-you
/article/8/edit
... 
```

或者

```
/blog/2012/06/01/how-i-will-spend-my-summer-vacation
/blog/2012/08/30/how-i-wasted-my-summer-vacation
... 
```

你将这些 url 分解成它们的片段，这样你就有 ['article', '1323', 'view'] 或 ['blog', '2012', '08', '30', 'how-i-wasted-my -暑假']。

如何分析和比较这些 url 以检测和调用 url 路径中的“变量”。也就是说，您需要识别诸如`/article/XXX/view`、`/article/XXX/edit`和`/blog/XXX/XXX/XXX/XXX`之类的内容，以便您可以在日志中汇总有关这些行的信息。

我假设对于构成可变片段与外观相似但不同的模板的差异数量需要一些统计阈值。我也不确定什么样的数据结构可以让这个分析变得又快又容易。

我希望脚本的输出能够输出它认为服务器上存在的所有 url 模板，如果合适的话，可能带有一些置信度值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-31T04:58:56.480

一个简单的解决方案是计算路径出现次数并了解哪些值对应于模板。假设该文件`input`包含您的第一个片段中的 URL。然后计算每个路径的访问：

```
awk -F '/' '{ for (i=2; i<=NF; ++i) { for (j=2; j<=i; ++j) printf "/%s", $j; printf "\n" }}' input \
    | sort \
    | uniq -c \
    | sort -rn 
```

这产生：

```
7 /article
4 /article/1
3 /article/1/view
2 /contact
1 /help
1 /contact/thank-you
1 /article/8/edit
1 /article/8
1 /article/2/view
1 /article/2
1 /article/1323/view
1 /article/1323
1 /article/1/edit 
```

现在每个路径都有一个权重，您可以将其输入到分数函数*f(x, y)*中，其中*x*表示计数，*y*表示路径的深度。例如，第一行将导致调用*f(7,2)*并可能返回*[0,1]*中的值，例如 0.8，以告诉您给定的参数化对应于 80% 的模板。当然，所有的魔法都发生在*f*中，您必须根据您看到的访问路径提出合理的值。要开发一个好的*f*，您可以在一些小数据集上使用逻辑回归，看看它是否能很好地预测作为模板的二元特征。

你也可以采取普通的方法：只掉尾巴，例如，所有值 <= 1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T01:08:55.527

使用[DAWG](http://en.wikipedia.org/wiki/Directed_acyclic_word_graph)怎么样？除了节点不会存储字母，而是 URI 片段。像这样：

![在此处输入图像描述](../Images/65c2f6f01e8bbee9530fe2f8c9969fcc.png)

这是一个非常好的数据结构：它对内存的要求非常低，很容易遍历，而且，作为一个 DAG，有很多简单且经过充分研究的算法。它也恰好描述了接受样本中所有 URL 并拒绝所有其他 URL 的状态机（因此我们实际上可能会从中构建一个正则表达式，这非常简洁，但我不够聪明，不知道该怎么做从那里开始）。

无论如何，使用这样的结构，您的问题会转化为寻找“瓶颈”的问题。我猜想有合适的算法，但是有足够大的样本，其中变量变化很大，基本上是这样的：在一定深度的节点越多，它就越有可能是一个可变部分。

一种可能很幼稚的方法是这样的：为每个起始部分保留单独的 DAWG，我会找到 DAWG 的平均宽度（可能基于深度加权）。如果一个级别的宽度高于该平均值，我会认为它是一个变量，其概率取决于它与平均值的距离。在这一点上，您可能会很好地释放统计数据的力量。对宽度的分布进行建模。

This approach wouldn't fare well with independent patterns starting with the same part, like "shop/?/?" and "shop/admin/?/edit". This could be perhaps mitigated by examining the DAWG-s in a more dynamic fashion, using a sliding window of sorts, always examining only a part of the DAWG at once, but I don't know how. Oh and, the whole thing fails horribly if the very first part is a variable, but that's thankfully rare.

You may also look out for certain little things like all nodes of the same level having numerical values (more likely to be a variable), and I'd certainly check for common date patterns in the sample before building the DAWGs, factoring them out would make handling the blog-like patterns easier.

(Oh and, adding the "algorithm" tag would probably attract more attention to the question.)

# jquery - jQuery Deferred 对象，用于目录树形式的请求

> ID：12206955
> 
> 赞同：2
> 
> 时间：2012-08-30T23:19:21.560
> 
> 标签：jquery, jquery-deferred

我想做 AJAX 请求以遵循树状结构，有点像文件系统目录，其中目录链接到其他目录。只有在我的情况下，我才遵循我遵循 ID 的 REST API。就像每个请求一样，我都会收到一个子目录的 ID 列表（最后是“文件”）。

所以我想做的是使用 forEach 在 AJAX 调用中进行 AJAX 调用。我想检查是否发生了错误，并且我想确保它等待请求完成，以便最终我能够处理并返回我收到的数据。我该怎么做？

所以我基本上有这样的 JSON 并从 /directories 开始。我想获取所有文件并将它们作为一个大 JSON 从函数返回。

/目录

```
["directoryA", "directoryB"] 
```

/目录/目录A

```
["subDirectory1", "subDirectory2"] 
```

/目录/目录B

```
["subDirectory4"] 
```

/目录/子目录1

```
["fileA", "fileB"] 
```

/目录/子目录2

```
["fileC"] 
```

/文件/文件A

```
{"some content"} 
```

/文件/文件B

```
{"Hello world"} 
```

/文件/文件C

```
{"nickname": "Clown", "id": 9247234} 
```

...

我目前关于这个的代码（对不起，原来的代码是 CoffeeScript 并且做了很多其他的事情来帮助决定得到什么以及如何最终对它们进行排序）：

```
function getFiles(settings){
  $.ajax("/directories", settings, function(directories) {
    data.forEach(function (directory) {
      $ajax("/directory/" + directory, settings, function(subdirectory) {
        // and so on, in the innermost processing the file contents,
        // but unable to return them.
      });
    });
  });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T18:11:46.847

您可以使用 jQuery Deferreds 或 Promises 发出一堆请求并使用[`jQuery's $.when`](http://api.jquery.com/jQuery.when/).

为每个目录和文件进行大量往返可能会很慢。在获取目录和文件或让服务器获取更大的数据块（如`ls -R`）或将请求与[ql.io](http://ql.io/)之类的东西结合起来时，可能会更快。

# javascript - 在javascript中的表中动态添加/删除行

> ID：12206959
> 
> 赞同：5
> 
> 时间：2012-08-30T23:20:00.530
> 
> 标签：javascript, html, forms

我想动态添加/删除表中的行。我有 javascript 函数来添加和删除行。但是，我想要每一行旁边的删除按钮，这样我就可以删除特定的行。

并且我只想在第一行完全填满时添加一行。

删除行的功能

```
 function removeRowFromTable()
{
  var tbl = document.getElementById('tblSample');
  var lastRow = tbl.rows.length;
  if (lastRow > 2) tbl.deleteRow(lastRow - 1);
} 
```

添加行的函数：

```
function addRow(tableID) {

            var table = document.getElementById(tableID);

            var rowCount = table.rows.length;
            var row = table.insertRow(rowCount);

            var cell1 = row.insertCell(0);
            var element1 = document.createElement("input");
            element1.type = "text";
            cell1.appendChild(element1);

            var cell2 = row.insertCell(1);
            var element2 = document.createElement("input");
            element2.type = "text";
            cell2.appendChild(element2);
        } 
```

我的桌子：

```
<table id="tableId">
<tr><td>Host Name</td><td>Directory</td></tr>
<tr><td><input type="text"/></td><td><input type="text"/></td></tr>
<tr><td><input type="button" value="+" onclick="addRow(tableId)"/></td>
<td><input type="button" value="-" onclick="removeRowFromTable()"/></td></tr>
</table> 
```

任何帮助表示赞赏！提前致谢！！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-31T00:47:04.973

如果在每一行上放置一个删除按钮，则：

```
<tr>
  <td><input type="button" value="Delete row" onclick="deleteRow(this)">
  <td><input type="text">
  <td><input type="text">
</tr> 
```

deleteRow 函数可以是：

```
function deleteRow(el) {

  // while there are parents, keep going until reach TR 
  while (el.parentNode && el.tagName.toLowerCase() != 'tr') {
    el = el.parentNode;
  }

  // If el has a parentNode it must be a TR, so delete it
  // Don't delte if only 3 rows left in table
  if (el.parentNode && el.parentNode.rows.length > 3) {
    el.parentNode.removeChild(el);
  }
} 
```

顺便说一句，如果您的所有行都具有相同的内容，那么通过克隆现有行来添加行会快得多：

```
function addRow(tableID) {
  var table = document.getElementById(tableID);

  if (!table) return;

  var newRow = table.rows[1].cloneNode(true);

  // Now get the inputs and modify their names 
  var inputs = newRow.getElementsByTagName('input');

  for (var i=0, iLen=inputs.length; i<iLen; i++) {
    // Update inputs[i]
  }

  // Add the new row to the tBody (required for IE)
  var tBody = table.tBodies[0];
  tBody.insertBefore(newRow, tBody.lastChild);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-30T23:57:36.480

使用 jquery 可以避免很多跨浏览器的麻烦。这是一个示例。

[http://jsfiddle.net/piyushjain7/gKJEs/](http://jsfiddle.net/piyushjain7/gKJEs/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-30T23:55:43.873

Javascript 有一个名为[deleteRow](http://www.w3schools.com/jsref/met_table_deleterow.asp)的非常有用的函数，如果您知道要从中删除的索引，您可以简单地输入该数字，然后它将删除该特定行（索引从 0 - tbl.rows.length 开始）。

我还发现了一个很好的[例子](http://viralpatel.net/blogs/dynamically-add-remove-rows-in-html-table-using-javascript/)，它在行动中使用它。不过，您可以对其进行调整以满足您的需求（尽管他使用的复选框可能比仅在每一行旁边制作一个按钮要干净得多）。我不鼓励您公然复制代码，所以如果有任何让您感到困惑的地方，请告诉我们。希望这可以帮助。

编辑：在您发现最后一行已完全填满后，我没有看到您想添加行。当我弄清楚时，我会更新我的答案。但是，其基本思想是检查`<td>`标签中是否有文本（也许检查标签内的文本是否不是空白或者是否有`<td>`标签，然后如果它不为空，则制作一个新`<tr>`元素，否则不要。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-31T00:32:28.340

见[http://jsfiddle.net/9gnAx/](http://jsfiddle.net/9gnAx/)

HTML & JavaScript (正文):

```
<table id="tableId">
    <tr>
        <th>Host Name</th>
        <th>Directory</th>
        <td><input class="add" type="button" value="+" /></td>
    </tr>
    <tr>
        <td></td><td></td>
        <td><input class="add" type="button" value="+" /></td>
    </tr>
</table>
<script type="text/javascript">
    (function(){
    var els=getElementsByClassName("add","tableId");
    for(var i=0;i<els.length;i++){
        els[i].onclick=addRow;
    }
    els[0].onclick();
    })();
</script> 
```

CSS（头部）：

```
.add,.del{
    width:25px;
} 
```

JavaScript（头部）：

```
function getElementsByClassName(c,el){
    if(typeof el=='string'){el=document.getElementById(el);}
    if(!el){el=document;}
    if(el.getElementsByClassName){return el.getElementsByClassName(c);}
    var arr=[],
        allEls=el.getElementsByTagName('*');
    for(var i=0;i<allEls.length;i++){
        if(allEls[i].className.split(' ').indexOf(c)>-1){arr.push(allEls[i])}
    }
    return arr;
}
function killMe(el){
    return el.parentNode.removeChild(el);
}
function getParentByTagName(el,tag){
    tag=tag.toLowerCase();
    while(el.nodeName.toLowerCase()!=tag){
        el=el.parentNode;
    }
    return el;
}
function delRow(){
    killMe(getParentByTagName(this,'tr'));
}
function addRow() {
    var table = getParentByTagName(this,'table')
    var lastInputs=table.rows.length>2?
        table.rows[table.rows.length-2].getElementsByTagName('input'):[];
    for(var i=0;i<lastInputs.length-1;i++){
        if(lastInputs[i].value==''){return false;}
    }
    var rowCount = table.rows.length;
    var row = table.insertRow(rowCount-1);

    var cell1 = row.insertCell(0);
    var element1 = document.createElement("input");
    element1.type = "text";
    cell1.appendChild(element1);

    var cell2 = row.insertCell(1);
    var element2 = document.createElement("input");
    element2.type = "text";
    cell2.appendChild(element2);

    var cell3 = row.insertCell(2);
    var element3 = document.createElement("input");
    element3.type = "button";
    element3.className="del";
    element3.value='-';
    element3.onclick=delRow;
    cell3.appendChild(element3);
} 
```

**更新：**

RobG 让我意识到，`getParentByTagName`如果没有任何`nodeName`通过的父级，则会引发错误。

如果你想要一个更通用的`getParentByTagName`，它不会抛出错误，你可以使用

```
function getParentByTagName(el,tag){
    tag=tag.toLowerCase();
    while(el&&el.nodeName.toLowerCase()!=tag){
        el=el.parentNode;
    }
    return el||null;
} 
```

当您调用该函数时，您应该检查结果是否为`null`.

更新了 jsfiddle：http: [//jsfiddle.net/9gnAx/1/](http://jsfiddle.net/9gnAx/1/)

# c# - 注册表中的 UrlAcl 信息

> ID：12206963
> 
> 赞同：2
> 
> 时间：2012-08-30T23:20:41.813
> 
> 标签：c#, .net, windows

有谁知道 UrlAcl 数据如何存储在注册表中的规范？我知道我可以在 HKLM\System\CurrentControlSet\services\HTTP\Parameters\UrlAclInfo 中找到值。每个值名称都是要注册的实际 URL，但是实际数据的其余部分是二进制的。我需要能够获取 urlacl 注册到的用户名。有谁知道我在哪里可以找到如何解析二进制数据以获取我需要的信息？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-31T00:01:38.167

另一种方法是让您的程序运行`netsh http show urlacl`，重定向输出，然后解析它。有关示例，请参阅[将控制台输出重定向到另一个应用程序](https://stackoverflow.com/q/3514727/56778)。

理想情况下，您应该能够从 Windows API 访问信息。我知道在某一时刻，有问题的 API 是“未发布的”。我不知道它现在是否已记录在案。

更新：也许[HttpQueryServiceConfiguration](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364491%28v=vs.85%29.aspx)是您正在寻找的？HttpApi 函数有几个 C# 包装器。搜索 [httpapi C#]。我不知道他们是否会做你想做的事，但他们看起来很有希望。

根据文档，HttpApi 可用于带有 SP2 的 Windows XP、Windows Server 2003 和所有更高版本。

# jquery - jquery切换按钮图像播放/停止

> ID：12206965
> 
> 赞同：1
> 
> 时间：2012-08-30T23:21:01.573
> 
> 标签：jquery, toggle

您好我正在使用以下脚本更改按钮图像以在播放和停止之间切换：

```
<input type="image" src="../../Content/images/play.png" name="btn" style="width:22; height:22;"  />
   $(document).ready(function () {
            $('#btn').bind("click", function () {
                if ($(this).attr("scr") == "../../Content/images/play.png")
                    $(this).attr("scr", "../../Content/images/puase.png");
                else
                    $(this).attr("scr", "../../Content/images/play.png");
            });
        }); 
```

它不起作用，将感谢您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-30T23:23:33.627

你应该使用

```
$('input[name=btn]').bind("click", function () { 
```

并更改`scr`为`src`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T23:24:11.167

试试这个：

```
$(document).ready(function () {
    var is_play = true;

    $('#btn').click(function () {
        if (is_play){
            is_play  = false;
            $(this).attr("src", "../../Content/images/puase.png");
        }
        else{
            $(this).attr("src", "../../Content/images/play.png");
            }
    });
}); 
```

还添加`id="btn"`到：

```
<input type="image" id="btn" src="../../Content/images/play.png" name="btn" style="width:22; height:22;"  /> 
```

# java - 使用 GAE Datastore Multitenancy for Java 结果空白页

> ID：12206969
> 
> 赞同：0
> 
> 时间：2012-08-30T23:21:25.833
> 
> 标签：java, google-app-engine, google-cloud-datastore

几周以来，我一直在尝试使用 Datastore Multitenancy。而且我似乎无法让它工作。每次我尝试在我自己的（计算机）服务器上运行它时，它似乎根本没有显示任何内容。我也尝试在 GAE 服务器上发布它，但它似乎仍然没有显示。

我想要实现的是与另一个用户和数据子实体的公司实体合作，该子实体未连接到任何电子邮件、Oauth 或第三方应用程序。作为命名空间的公司实体将分离每个公司的所有数据和用户。这样，它将包含用户及其所有其他数据而不会泄漏。

我试图确保应用程序有自己的公司实体的 NamespaceFilter 类。什么导致空白页？（或者也许正确的问题是，我做错了什么？）

**更新：**

代码没有错误，也没有任何异常。但是，我试图显示的 JSP 页面就消失了，没有任何关于它如何显示的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T21:45:33.053

多租户只能与 Google Apps 一起使用。以下是 Google App Engine 关于实施多租户的说明。

```
Most App Engine developers will use their Google Apps domain as the current 
namespace. Google Apps lets you deploy your app to any domain that you own, 
so you can easily use this mechanism to configure different namespaces for 
different domains. Then, you can use those separate namespaces to segregate 
data across the domains. 
```

**澄清：**它`Google Apps`允许您部署到任何域并使用多租户。您需要使用`Google App Engine`可以使您使用多租户的 API。`Google Apps`并且`Google App Engine`应该连接。通过将域注册到 Google Apps，您可以使用多租户。因此，如果您使用用户，则需要在 Google Apps 中注册。

# windows - Visual Studio 2012“许可证数据无效。需要重新安装”

> ID：12206974
> 
> 赞同：6
> 
> 时间：2012-08-30T23:21:49.420
> 
> 标签：windows, visual-studio-2012

我有一个新建的 Windows 8 VM，上面运行 VS 2012 Premium，当我尝试打开任何 sln 文件时，我收到以下模式弹出错误

> Visual Studio 2010 外壳
> 
> 无效的许可证数据。需要重新安装。

如果我打开VS然后打开项目，我可以打开sln，这真的很烦人，有什么想法可以解决吗？

*注意我已经进行了 VS 修复，但没有解决...而且我的机器上从来没有任何 VS RC 版本，所有新版本的软件都是从 MSDN 下载的

干杯

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-21T03:10:03.380

***当我在一台机器上使用完整版的 Visual Studio 2012 Professional***创建解决方案，然后尝试在另一台机器上使用 Visual Studio 2012 ***Express***的副本打开解决方案文件时，我遇到了同样的错误。双击解决方案文件时出现错误，但在将解决方案加载到已打开的实例时却没有。

我通过使用记事本打开***解决***方案文件 (.sln) 并更改`Visual Studio 2012`说`Visual Studio Express 2012 for Windows Desktop`.

之后，我可以在安装了 Express 的机器上双击打开解决方案文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-03-10T12:53:13.603

我正在使用 VS 2013。我通过右键单击 .sln 并将 Open With 参数设置为 Visual Studio 2013 而不是 VS 版本选择器或 VS 2010 来解决此问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T09:38:56.810

我遇到了同样的问题。当我将系统日期和时间设置为当前日期和时间时，问题自行解决。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-10T13:08:40.713

看起来该`.sln`扩展由“Visual Studio 2010 Shell”拥有，这是 Visual Studio 的最小版本，它附带 SQL Server 和 Office 等产品，以提供对插件开发的支持，而无需任何其他功能。由于这是一个最小版本，它无法加载 Visual Studio Express、Professional 或更高版本附带的任何项目类型。

当您在完整版本的 Visual Studio 旁边安装 Visual Studio Express 时，可能会发生同样的情况。

在安装 Visual Studio 后安装旧版本的 Office 或 SQL Server 时，可能会发生这种情况。旧的安装程序将劫持扩展。

要修复此问题：

1.  使用 Windows 的“打开方式”选项并选择“Visual Studio 版本选择器”作为默认操作。
2.  或者在 Windows 中打开“默认程序”选项，查找 .sln 扩展名并确保它默认使用“Visual Studio 版本选择器”：![在此处输入图像描述](../Images/5e158105d4c66040e9d6fc0f0ac3c8d9.png)
3.  或者在 Windows 的程序和功能窗口中找到 Visual Studio 2012 并选择“更改”，会弹出 Visual Studio 安装程序，选择“修复”让它修复文件关联以及安装 Visual Studio 版本可能出现的任何其他问题以相反的顺序（例如，它也可能会弄乱 MsBuild 目录）。

请记住，当 Visual Studio 2010 发布时，它还不知道 Visual Studio 2012 会发生什么变化，因此，最好按照发布顺序安装 Visual Studio 版本。这有时可能会很困难，因为其他产品可能会在您不知情的情况下安装 Visual Studio 版本。

# linux - 模板错误：必须给出模板文件

> ID：12206976
> 
> 赞同：1
> 
> 时间：2012-08-30T23:22:06.580
> 
> 标签：linux, apache, cpanel, whm

我有一个正在运行的开发服务器 - 我正在尝试将不同的域指向该服务器......

例如 - 我的开发服务器地址是这样的：

[http://dev.domain.com](http://dev.domain.com)

现在我在我拥有的另一个域名上设置了一个子域，并像这样指向了这个域..

[http://dev.newdomain.com](http://dev.newdomain.com)

我没有传输文件，我只是做了一个 A 记录，将我的新 dev.newdomain.com 指向我在 dev.domain.com 上的旧服务器 IP，这样我就不必传输所有文件

现在唯一的问题是我收到此错误：

```
Template Error: The template file must be given 
```

我不知道如何解决这个问题 - 我很感激任何帮助

我真的希望我的描述不会太混乱

# joomla - Joomla 2.5 - 如何访问模块参数？

> ID：12206979
> 
> 赞同：0
> 
> 时间：2012-08-30T23:22:19.590
> 
> 标签：joomla, parameters, module

有谁知道我如何从模块的 helper.php 中获取模块的“访问”参数的值（例如公共、注册..等）？我只能看到 $params，它们都是模块类型特定的参数，而不是通用参数。

我需要检索访问权限并将它们提供给插件。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T00:04:39.547

您需要为此运行 SQL 查询。

**对于 1 个特定模块：**

```
$db =& JFactory::getDBO();
$query = 'SELECT access FROM #__modules WHERE element="mod_yourmodule"';
$db->setQuery($query);
$result = $db->loadResult();
print_r($result); 
```

不要忘记更改`mod_yourmodule`为您想要数据的任何模块。

**对于所有模块：**

```
$db =& JFactory::getDBO();
$query = 'SELECT access FROM #__modules';
$db->setQuery($query);
$result = $db->loadResult();
print_r($result); 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-31T00:45:15.890

你的意思是当你在页面上渲染一个模块或者你想知道它什么时候没有被渲染？如果用户有权访问，JModuleHelper 只会呈现模块。

但是如果你想找出除了渲染之外的其他原因，你需要查询 jos_modules。模块访问级别实际上不能通过查询 jos_extensions 表找到，因为它不涉及模块的特定实例（例如主菜单与其他一些菜单，它们都是 mod_menu 的实例并且可能具有不同的访问级别）。（当然使用你自己的前缀。）

PS我认为将它作为拉取请求放入可能是值得的，这样你就可以从助手那里得到它。对我来说似乎有点武断，它没有在数组中返回。

# sitecore - 未配置为将 Sitecore 媒体发布到文件系统

> ID：12206987
> 
> 赞同：1
> 
> 时间：2012-08-30T23:23:36.797
> 
> 标签：sitecore, sitecore6, sitecore-media-library

我有一个 SiteCore 实例，其中媒体的 web.config 值如下：

```
<setting name="Media.DisableFileMedia" value="false" />
<setting name="Media.UploadAsFiles" value="false" />
<setting name="Media.FileFolder" value="/App_Data/MediaFiles" />
<setting name="Media.UseItemPaths" value="true" /> 
```

那么，这应该意味着该项目将存储在数据库中而不是文件系统中，对吗？我问是因为它们存储在文件系统上，路径如下所示：

/App_Data/Replicated/MediaFiles/6/4/E/{64EC628B-9C94-4416-B9BD-5A90EA7D8971}220px-Liliumbulbiferumflowertop.jpg

有谁知道为什么会这样？这是我试图理解的一个更大谜题的一小部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-07-14T16:02:54.543

我了解到用户可以手动指定文件是否应作为文件上传到文件系统上。我发现我一直在开发的网站上的内容编辑器根据他们过去工作过的网站习惯这样做。为防止用户有此选择，您可以将 Upload.UserSelectableDestination 设置为 false（默认为 true）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-10T10:19:20.973

我遇到了同样的问题。经过 5 个小时的调查，我发现**App_config\Include\ScalabilitySettings.config**覆盖了**Media.FileFolder**值。所以禁用**ScalabilitySettings.config 并重**试。它将所有文件存储在**Media.FileFolder**设置指定的文件夹中。

解决问题的答案：禁用 **App_config\Include\ScalabilitySettings.config**或**更改**此配置中 Media.FileFolder 的值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-31T12:51:25.833

**Media.DisableFileMedia**更多的是打开或关闭将媒体项存储在 SC 或文件系统上的选项（在实际的 SC UI 中）

**Media.UploadAsFiles**用于指示媒体项目是放在 SC 中（如果为 false）还是放在文件系统中（如果为 true） - 如果您将 DisableFileMedia 设置为 true，则将其忽略并视为“true”

**Media.FileFolder**显然是将文件放在文件系统上的位置，如果上述任何设置为 true。

**Media.UseItemPaths**实际上与在文件系统上存储媒体项目无关。它只是显示“~/media/[item id]”之类的 URL 与媒体项目的完整路径之间的切换。

# django - Django：django-facebook 重定向到 /facebook/connect/

> ID：12206995
> 
> 赞同：1
> 
> 时间：2012-08-30T23:24:21.537
> 
> 标签：django, facebook, redirect, django-settings, django-facebook

我阅读了有关 django-facebook 的所有文档，但我仍然不明白为什么在设置 settings.py 后，注册会重定向到 django-facebook 上的模板。

设置.py

```
FACEBOOK_LOGIN_DEFAULT_REDIRECT = '/profile/'
FACEBOOK_REGISTRATION_BACKEND = 'django_facebook.registration_backends.UserenaBackend'
LOGIN_REDIRECT_URL = '/profile/'
AUTHENTICATION_BACKENDS = (
    'userena.backends.UserenaAuthenticationBackend',
    'django_facebook.auth_backends.FacebookBackend',
    'django.contrib.auth.backends.ModelBackend',
    'guardian.backends.ObjectPermissionBackend',

) 
```

该模板不应该在我的应用程序的模板文件夹中可编辑？有什么我想念的吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T10:35:36.797

我认为这都是关于模板加载器优先级的。尝试在设置 INSTALLED_APPS 中的 django-facebook 之前列出您的自定义应用程序，您应该获得正确的模板。

# java - 如何在 Swing 中实现“进行中”动画？

> ID：12206998
> 
> 赞同：2
> 
> 时间：2012-08-30T23:24:46.267
> 
> 标签：java, multithreading, swing

我正在开发一个执行某些长时间运行的功能的应用程序。为了让用户知道正在处理，我需要一个标签来显示一些可以代表它的标签。所以，我为这样的标签创建了一个小部件。

下面的程序运行 find ，我得到了我想要的输出。

```
import java.awt.Dimension;
import java.util.ArrayList;
import java.util.List;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

/**
 * This is an extension to a JLabel that can be used to display an ongoing progress.
 * @author Ankit Gupta
 */
public class ProgressLabel extends JLabel {

    /**
     * The prefix label to which periods are added.
     */
    private String startLabel;
    /**
     * The label to display end of an operation.
     */
    private String endLabel;

    /**
     * Flag to indicate whether the animation is running or not.
     */
    private boolean running = false;
    //list to hold intermediate labels
    List<String> intermediateLabels;

    public ProgressLabel(String slbl, String elbl) {
        this.startLabel = slbl;
        this.endLabel = elbl;
        //initialize all the labels to be used once as creating them again and again is expensive
        intermediateLabels = new ArrayList<String>();
        intermediateLabels.add(startLabel+".");
        intermediateLabels.add(startLabel+"..");
        intermediateLabels.add(startLabel+"...");
        intermediateLabels.add(startLabel+"....");
    }

    public void done(){
        running = false;
    }

    public void start(){
        running = true;
        new LabelUpdateThread().start();
    }

    private class LabelUpdateThread extends Thread{
        int i;

        public LabelUpdateThread(){
            i=0;
        }

        @Override
        public void run(){
            while(running){
                SwingUtilities.invokeLater(new Runnable(){
                    @Override
                    public void run() {
                        setText(intermediateLabels.get((i++)%3));
                    }
                });

                try {
                    Thread.sleep(1000);
                } catch (InterruptedException ex) {}
            }
            setText(endLabel);
        }
    }

    public static void main(String []args) throws InterruptedException{
        final JFrame frame = new JFrame("Testing ProgressLabel");
        JPanel panel = new JPanel();
        ProgressLabel progressLabel = new CZProgressLabel("Searching", "Done");
        panel.add(progressLabel);
        frame.add(panel);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setPreferredSize(new Dimension(500,500));
        frame.pack();
        progressLabel.start();
        SwingUtilities.invokeLater(new Runnable(){
            @Override
            public void run() {
                frame.setVisible(true);
            } 
        });
        Thread.sleep(5000);
        progressLabel.done();
    }
} 
```

但是，当我尝试将其包含在应用程序中时，它并没有按预期工作。我创建了一个带有按钮的小面板，在按钮的代码`actionPerfomed()`中我像以前一样使用了**start()**和**done()**方法，但是这一次，标签直到长度过程完成才更新为*Done 。*这是另一段使用with的代码：`ProgressLabel`*****`ProgressLabel``actionPerformed()`*****

 *****```
public class SearchPanel extends JPanel {

    private JTextArea queryBox;
    private JButton searchBtn;
    private ProgressLabel progressLabel;
    private JSeparator queryAreaSeparator;

    public SearchPanel() {
        setLayout(new GridBagLayout());
        GridBagConstraints gbc = new GridBagConstraints();

        //First Row
        gbc.gridy = 0;
        gbc.gridwidth = 2;
        gbc.gridx = 0;
        queryBox = new JTextArea();
        queryBox.setRows(25);
        queryBox.setColumns(25);
        this.add(queryBox, gbc);

        //Second Row
        gbc.gridy = 1;

        gbc.gridwidth = 1;
        progressLabel = new ProgressLabel("Searching", "Done");
        this.add(progressLabel, gbc);

        gbc.gridx = 1;
        searchBtn = new JButton("Search");
        this.add(searchBtn, gbc);
        searchBtn.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                progressLabel.start();
                try {
                    Thread.sleep(10000);
                } catch (InterruptedException ex) {
                    Exceptions.printStackTrace(ex);
                }
                //the above sleep() call will be replace by some time-consuming process. It is there just for testing now

                progressLabel.done();
            }
        });

        gbc.gridx = 0;
    }

    /**
     * function to test CZSemanticSearchLabel
     */
    public static void main(String[] args) throws InterruptedException {
        final JFrame frame = new JFrame();
        CZSemanticSearchPanel panel = new CZSemanticSearchPanel();
        frame.add(panel);
        frame.setPreferredSize(new Dimension(500, 500));
        frame.pack();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);
        Thread.sleep(10000);
        frame.dispose();

        final JFrame frame1 = new JFrame("Testing ProgressLabel");
        JPanel panel1 = new JPanel();
        CZProgressLabel progressLabel = new CZProgressLabel("Searching", "Done");
        panel1.add(progressLabel);
        frame1.add(panel1);
        frame1.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame1.setPreferredSize(new Dimension(500, 500));
        frame1.pack();
        progressLabel.start();
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                frame1.setVisible(true);
            }
        });
        Thread.sleep(5000);
        progressLabel.done();
    }
} 
```

我相信我已经用 Swing 的事件调度模型搞砸了。但是，我想不通是什么？有人能告诉我这段代码有什么问题吗？我该如何纠正？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-30T23:34:30.063

您可以使用[SwingWorker：](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/simple.html)为此类事情制作的简单后台任务，而不是自己使用线程来实现这一点，并且链接的示例与您的问题非常相似。

你`start()`不执行你的`LabelUpdateThread().run()`，但你的`LabelUpdateThread().start()`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-30T23:46:03.497

我不知道你的实际代码，但你的示例代码有缺陷......

在你的`ActionListener`你正在这样做......

```
progressLabel.start();
try {
    Thread.sleep(10000);
} catch (InterruptedException ex) {
    Exceptions.printStackTrace(ex);
}
//the above sleep() call will be replace by some time-consuming process. It is there just for testing now

progressLabel.done(); 
```

这将停止**事件**[调度线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)，防止任何重绘请求被处理（即没有屏幕更新）10 秒......这也会使您的应用程序看起来像是“挂起”。

我更新了你`ActionListener`的阅读方式（注意我添加了一个从标签`isRunning`返回成员的方法）`running`

```
if (progressLabel.isRunning()) {
    progressLabel.done();
} else {
    progressLabel.start();
} 
```

它工作正常。

您可能想通读[Swing](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)中的 Currency 以获得更多想法。

此外，正如已经建议的那样，SwingWorker 可能是一种更好的方法*****