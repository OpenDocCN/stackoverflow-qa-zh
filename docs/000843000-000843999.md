# StackOverflow 问答 000843000-000843999

# perl - 我从 Perl 的 Image::Info::image_info() 中得到的所有二进制内容是什么？

> ID：843011
> 
> 赞同：1
> 
> 时间：2009-05-09T09:10:36.860
> 
> 标签：perl, image, encoding

运行图片[代码](https://stackoverflow.com/questions/789162/how-can-you-get-the-metadata-of-an-image-by-the-perl-module)后，我得到以下输出

```
[1459]./image_info.pl lah.png 
$VAR1 = {
          'width' => 206,          'file_media_type' => 'image/png',
          'file_ext' => 'png',
          'PNG_Chunks' => [
                            'IHDR',
?V?????O?H??^#?C&?fu?M?5V??m6???M?s',
                            'IEND' 9   :˺??:?E??(;t??[/????o?4?4?O??TܲD
#PJ?EHͨ??ƥ8???#u   ?t??1?I/=?!w"???)?,??????X?|?{                                              M?N??A?  V``?&?
{8.?"???I)?W?_??|k?.c??l??s?8?~^Z??????_;?,,+,/?4~]ů?ZìU?+???i?s`C}??/?_??>?d~?lrn?n^???2???z?-???B??n?D;??aXHoeh?3???
DA5?N?Aw??? ???J?-????P?> 'RGB',
C?~&?1?cd 'heiga~H.`ha162,         H2?I???P?p?HsZ?&?P? Y`??;?q4Kov??3?Z???L???? ?F??&???aq?H???????"Ri?F? ??ٵ???L  B??r??H%??@??٩qiLJ?pres??on' => 'Deflate',
        ??/?Z?w,?k???g?=> '2835 dpm',
          'Compression' ? ((~??_^A ?c?vV??w????m,7????Eb???0J5?? ??? ????9????:?,24m[1460] 
```

我不明白文件的最后一位。

**如何将编码更改为可读？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T09:22:07.440

Perl`Image::Info`模块根本不应该显示所有编码数据。我自己对该模块的测试从未这样做过，例如：

```
$VAR1 = {
          'width' => 58,
          'file_media_type' => 'image/png',
          'file_ext' => 'png',
          'PNG_Chunks' => [
                            'IHDR',
                            'IDAT',
                            'IEND'
                          ],
          'PNG_Filter' => 'Adaptive',
          'color_type' => 'Gray',
          'height' => 56,
          'SampleFormat' => 'U8',
          'Compression' => 'Deflate',
          'resolution' => '1/1'
        }; 
```

在另一个 PNG 文件上尝试一下，这个看起来可能已损坏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T09:15:08.330

您将二进制块显示为文本。这在任何编码中都不可读。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T09:15:32.277

将脚本的输出重定向到文件：

```
./image_info.pl lah.png >log.txt 2>&1 
```

然后`log.txt`在您最喜欢的 GUI 文本编辑器（例如 kate、gedit、notepad++）中打开，在打开的对话框中指定 ISO-8859-1 或 UTF-8。尝试两种编码。

# php - 使用javascript将焦点放在具有变量名的文本区域内

> ID：843016
> 
> 赞同：2
> 
> 时间：2009-05-09T09:19:20.083
> 
> 标签：php, javascript, html

我有一个网站，列出了几个即将发生的事件，每个事件都有一个评论按钮来发表评论。它看起来像这样（它是瑞典语，但我认为您可以弄清楚结构）：

![](https://i.stack.imgur.com/trals.png)
[（来源：[shipit.se](http://www.shipit.se/dump/event.png)）]

包含用于编写评论的文本区域的 div 最初是隐藏的，当单击“评论”图标时，它会使用以下 javascript 显示：

```
<script language="javascript" type='text/javascript'>
    function showhide_comment(comment_id, change_id) {
        if (document.getElementById(comment_id).style.display == 'none') { 
            if (document.getElementById(change_id).style.display == 'block') {
                document.getElementById(change_id).style.display = 'none';
                document.getElementById(comment_id).style.display = 'block';
                document.getElementById(change_id).style.display = 'block';
            } else {
                document.getElementById(comment_id).style.display = 'block';
            }
        } else {
            if (document.getElementById(change_id).style.display == 'block') {
                document.getElementById(change_id).style.display = 'none';
                document.getElementById(comment_id).style.display = 'none';
                document.getElementById(change_id).style.display = 'block';
            } else {
                document.getElementById(comment_id).style.display = 'none';
            }
        }   
    } 
```

该脚本包含一个技巧，可以在 IE 中正确显示隐藏的 div，同时还显示另一个（最初隐藏的）div，其中可以对事件进行更改。但别介意。

显示评论表单的 php 代码如下所示：

```
//Comment form, initially hidden
            echo "<div id=\"comment" . $row->id . "\" class=\"submit-comment\" style=\"display: none\">";
            echo "<form name=\"make_comment\" method=\"post\" action=\"submit_comment.php\">";
            echo "Kommentar:<br/>";
            echo "<textarea name=\"comment\" class=\"comment\" rows=\"0\" cols=\"0\"></textarea><br/>";
            echo "<input type=\"hidden\" name=\"event_id\" value=\"$row->id\"/>";
            echo "<input class=\"comment\" type=\"submit\" name=\"submit_comment\" value=\"Skicka\" />";
            echo "</form>";
            echo "</div>"; 
```

此代码位于一个循环中，该循环显示存储在 mySQL 数据库中的所有即将发生的事件。可以看出，为 div 赋予了变量名称，如 comment1、comment2 等，以便将评论绑定到正确的事件。

这是显示注释图标并将其链接到 javascript 的代码：

```
echo "<li class=\"icon-left\">
            <a href=\"javascript:showhide_comment('comment" . $row->id . "', 'change" . $row->id . "')\">
            <img src=\"images/comment-24x24.png\" title=\"Kommentera körning\" alt=\"Kommentera körning\" />
            </a></li>"; 
```

我想做的是将焦点放在正确的 textarea 字段中，当单击评论图标时该字段变为可见，以便用户可以直接开始输入。我曾尝试使用 focus() 修改上面的 javascript，但我无法让它工作。关于如何实现我想要的任何想法？

谢谢。

/莱纳斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T09:28:09.470

这将聚焦 div 中的第一个 textarea，这就是您想要的：

```
document.getElementById(comment_id).getElementsByTagName('textarea')[0].focus(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T09:23:56.030

在用于显示表单的 javascript 函数中：

```
 if (document.getElementById(comment_id).style.display == 'none') { 
                        if (document.getElementById(change_id).style.display == 'block') {
                                document.getElementById(change_id).style.display = 'none';
                                document.getElementById(comment_id).style.display = 'block';
                                document.getElementById(change_id).style.display = 'block';
                                document.getElementById(comment_id).focus(); //This will set the focus 
```

我猜这里`comment_id`将是 textarea 用于评论的 id。如果不是，`document.getElementById();`则在最后一行中使用 textarea 的 id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T12:35:21.000

我建议您开始使用[JQuery](http://www.jquery.com)或[Dojo](http://www.dojotoolkit.org) Javascript 框架。
他们会让你的生活更轻松。它使 DOM 操作变得非常简单、快速、简洁，甚至更加灵活。
这样你就不会在简单的事情上遇到太多麻烦了。
我自己经常使用 Dojo。这真的很棒。

# internet-explorer - 如何让我的 ATL COM DLL IE 插件在 Mozilla 中工作？

> ID：843018
> 
> 赞同：0
> 
> 时间：2009-05-09T09:21:38.457
> 
> 标签：internet-explorer, visual-c++, dll, plugins, mozilla

我有处理 IExplorer 中的下载对话框的 COM DLL（ATL 项目）。我希望相同的 DLL 在 Mozilla 中工作。我该怎么做？可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T10:43:11.927

每个浏览器（让我们不要忘记 Chrome、Safari、Opera 等）都有自己的插件/扩展机制。

您需要根据浏览器的 API 为每个浏览器创建不同的插件。

也许如果您在文件保存中解释您想要的“附加功能”，那么可能会采用不同的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T09:27:06.680

Mozilla 和 IE 使用的是完全不同的插件系统。基本上你不能简单地这样做。

# hibernate - 如何在多对多休眠注释的连接表中插入记录？

> ID：843020
> 
> 赞同：6
> 
> 时间：2009-05-09T09:23:45.470
> 
> 标签：hibernate

我在两个表之间有多对多关系并在休眠中生成新的连接表现在如何通过更新两个表在连接表中插入一条记录说两个表是 tbluser 和 tbldomain

我必须从两侧（即来自 tbluser 和 tbldomain）在 tbluserdomainrelation 中插入记录

目前我只能在保存或更新 tbluser 时在连接表中插入记录，但我也希望在更新域表中的关系时插入记录

在`user.class`我写过

```
@ManyToMany(targetEntity = VirtualDomain.class, cascade = {CascadeType.PERSIST, CascadeType.MERGE},fetch=FetchType.EAGER)

@JoinTable(name = "tblUserDomainRel", joinColumns = @JoinColumn(name = "userid"), inverseJoinColumns = @JoinColumn(name = "domainid"))

public Set<VirtualDomain> getVirtualdomainset() {
        return virtualdomainset;
}

public void setVirtualdomainset(Set<VirtualDomain> virtualdomainset) {
        this.virtualdomainset = virtualdomainset;
} 
```

在域表中我有条目

```
@ManyToMany(cascade = {CascadeType.PERSIST, CascadeType.MERGE},fetch=FetchType.EAGER, mappedBy = "virtualdomainset", targetEntity = User.class)

public Set<User> getUserset() {
        return userset;
}

public void setUserset(Set<User> userset) {
        this.userset = userset;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-04T12:48:18.037

我怀疑您可能会在第一个障碍中跌倒：

如前所述，Hibernate 将更新您调用的对象，`update()`然后按照您在属性中指定的规则级联到任何需要更新的后续对象`@Cascade`。

问题是您的`User`类拥有关系并且将`User`对象添加到`VirtualDomain.userset`集合中不会`User`以任何方式改变对象。因此，即使有级联，Hibernate 也不会更新`User`对象，因为它认为它不必这样做。

相反，当您将对象添加到`VirtualDomain.userset`集合中时，请确保也将对象`VirtualDomain`添加到`User.virtualdomainset`集合中。

```
// given a VirtualDomain object
VirtualDomain domain = getSession().load( VirtualDomain.class, 1234 );

// and a User object
User user = getSession().load( User.class, 5678 );

// add the User to the VirtualDomain
domain.getUserset().add( user );
// but also add the VirtualDomain to the user
user.getVirtualdomainset().add( domain );

// update the VirtualDomain and the Cascade settings will also update the User
getSession().update( domain ); 
```

在这种情况下，我发现提供一种将对象添加到集合中的辅助方法很有用，而不是直接访问集合本身。例如

```
public class VirtualDomain {

    Set userset;

   /* snip... */

    public void addUser( User user ) {
        getUserset().add( user );
        user.getVirtualdomainset().add( this );
    }
} 
```

尽管值得记住 Hibernate 祖先的建议：

> “在实际系统中，您可能没有多对多关联。我们的经验是，几乎总是有其他信息必须附加到每个链接……最好的方法……是通过中间*关联类*。” （Java Persistence With Hibernate，第 297/298 页，ISBN 1-932394-88-5）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T17:54:37.460

您已将 User 类设置为关系的所有者。如果你想换一种方式，那么你需要切换它们的映射，以便 Domaintable 具有@JoinTable。或者您必须通过在 Domaintable 上使用 @PrePersist 或 @PreUpdate 来强制调用 User 上的更新，从而将行插入连接表中。我相信还有其他方法可以实现它，但这是我想到的两种。

```
@PreUpdate example :

@EntityListeners( Domaintable.class )
@Entity
public class Domaintable
{

User  user;

....

@PreUpdate
public void onPreUpdate( DomainTable domainTable )
{
   if( domainTable.getUser() != null )
   {
       entitymanager.update( domainTable.getUser() );
    }
}

....

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T09:28:53.773

你的课看起来怎么样？

我想你有一个类域和一个类用户。在 Domain 类中，假设您有一个 Users 集合。将 User 对象添加到 Users 集合，并在 Domain 对象上调用 SaveOrUpdate。还要确保您指定了正确的级联选项（例如 cascading="save-update".

这有点大局观。我们需要更多关于什么不起作用的详细信息。

# c# - WPF - Canvas.GetTop 返回 NeuN

> ID：843028
> 
> 赞同：-1
> 
> 时间：2009-05-09T09:28:19.407
> 
> 标签：c#, wpf, canvas

我试图从鼠标移动处理程序中获取画布的位置，但它返回 NeuN。

画布在另一个画布内，代码是：

```
Console.WriteLine(Canvas.GetTop(canvas2)); 
```

这是里面：

```
private void move(object sender, MouseEventArgs e)
{
Console.WriteLine(Canvas.GetTop(canvas2));
} 
```

我会说这不是范围问题，因为 SetTop 工作正常。

有任何想法吗？提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T12:07:13.153

好的，我找到了解决方法。如果有人有更好的方法，我仍然会很感激其他选择。

基本上，由于 GetTop 不起作用，我认为我可以获得 RenderTransform 对象。它奏效了！

```
canvas2.RenderTransform.Value.OffsetY 
```

谢谢。

**编辑：** 您也可以这样做：

```
Double current_y = (double)this.GetValue(Canvas.TopProperty); 
```

# mysql - MySQL 插入后和更新后触发器

> ID：843031
> 
> 赞同：1
> 
> 时间：2009-05-09T09:29:28.780
> 
> 标签：mysql, insert, triggers

我有两个表 t1 和 t2。我在 t1 上插入后创建了两个触发器 tr1，在 t2 上更新后创建了 tr2。在两个表中，我正在更新表 t2。所以，它抛出一个错误，说 t2 表已经在另一个触发器中更新，所以不能再次更新它。

请让我知道是否有人遇到过此类问题并已解决。

提前致谢！MySQL 数据库管理员。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-09T09:52:47.833

如果要修改*正在更新或插入的数据，*则应使用 BEFORE UPDATE 和/或 BEFORE INSERT 触发器，然后使用 NEW 别名（它引用正在插入的行或看起来的行应用更新后） - 您实际上可以修改正在插入的字段。OLD 别名引用应用更新之前的行或删除之前的行（在删除时触发的触发器中）。

因此，对于触发器 tr2，您可能需要以下内容：

```
DELIMITER $$
    CREATE TRIGGER tr2 BEFORE UPDATE ON t2
    FOR EACH ROW BEGIN
      SET NEW.field1 = some_value_you_want_to_set_it_to;
    END;
$$
DELIMITER ; 
```

因为在触发器中，您实际上不能更新已经更新的表，这是正确的。

* * *

## 回答 #2

> 赞同：-6
> 
> 时间：2009-06-09T05:11:36.053

我已经解决了这个问题，当我试图从两个触发器更新和插入同一个表 tb1 时出现问题，但我认为 Mysql 不允许修改同一个表。

谢谢

# ruby - Ruby 无法将字母中的英文单词组合起来

> ID：843034
> 
> 赞同：1
> 
> 时间：2009-05-09T09:33:40.267
> 
> 标签：ruby, knuth

我需要找到所有可以由字符串中的字母组成的英语单词

```
 sentence="Ziegler's Giant Bar" 
```

我可以通过

```
 sentence.split(//) 
```

**如何从 Ruby 中的句子中生成超过 4500 个英语单词？**

[编辑]

最好将问题分成几部分：

1.  只制作一个包含 10 个或更少字母的单词数组
2.  较长的单词可以单独查找

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-18T07:18:36.973

[假设您可以在一个单词中重复使用源字母]：对于字典列表中的每个单词，构造两个字母数组 - 一个用于候选单词，一个用于输入字符串。从单词 array-of-letters 中减去输入的字母 array，如果没有剩下任何字母，那么你就有了匹配项。执行此操作的代码如下所示：

```
def findWordsWithReplacement(sentence)
    out=[]
    splitArray=sentence.downcase.split(//)
    `cat /usr/share/dict/words`.each{|word|
        if (word.strip!.downcase.split(//) - splitArray).empty?
            out.push word
        end
     }
     return out
end 
```

您可以像这样从 irb 调试器调用该函数：

```
output=findWordsWithReplacement("some input string"); puts output.join(" ") 
```

...或者这是一个包装器，您可以使用它来从脚本交互地调用该函数：

```
puts "enter the text."
ARGF.each {|line|
    puts "working..."
    out=findWordsWithReplacement(line)
    puts out.join(" ")
    puts "there were #{out.size} words."
} 
```

在 Mac 上运行时，输出如下所示：

> $ ./findwords.rb
> 输入文本。
> Ziegler's Giant Bar
> working...
> A a aa aal aalii Aani Ab aba abaiser abalienate Abantes Abaris abas abase abaser Abasgi abasia Abassin abatable abater abatis abaze abb Abba abbas abbasi abbassi abbatial abbess Abbie Abe abear Abel abele Abelia Abelian Abelite abelite abeltree Aberia aberrant aberrate abet abettal Abie Abies abietate abietene abietin Abietineae Abiezer Abigail abigail abigeat abilla abintestate
> [....]
> Z za Zabaean zabeta Zabian zabra zabti zabtie zag zain Zan zanella zant zante Zanzalian zanze Zanzibari zar zaratite zareba zat zati zattare Zea zeal zealless zeallessness zebra zebras Zebrina zebrine zee zein zeist zel zig zigzag zigzagger Zilla zing zingel Zingiber zingiberene Zinnia zinsang Zinzar zira zirai Zirbanit Zirian Zirianian Zizania Zizia zizz
> 共有 6725 个单词。

那远远超过 4500 个单词，但那是因为 Mac 词典非常大。如果您想准确重现 Knuth 的结果，请从此处下载并解压缩 Knuth 的字典：http: [//www.packetstormsecurity.org/Crackers/wordlists/dictionaries/knuth_words.gz](http://www.packetstormsecurity.org/Crackers/wordlists/dictionaries/knuth_words.gz)并将“/usr/share/dict/words”替换为解压替代目录的路径。如果你做对了，你会得到 4514 个单词，以这个集合结尾：

> zanier zanies zaniness Zanzibar zazen zeal zebra zebras Zeiss zeitgeist Zen Zennist zest zestier zeta Ziegler zig zigging zigzag zigzagging zigzags zing zingier zings zinnia

我相信这回答了最初的问题。

或者，提问者/读者可能想要列出可以从字符串构造的所有单词，*而无需*重复使用任何输入字母。我建议的代码来完成这个工作如下：复制候选词，然后对于输入字符串中的每个字母，从副本中破坏性地删除该字母的第一个实例（使用“slice！”）。如果此过程吸收了所有字母，则接受该单词。

```
def findWordsNoReplacement(sentence)
    out=[]
    splitInput=sentence.downcase.split(//)
    `cat /usr/share/dict/words`.each{|word|
        copy=word.strip!.downcase
        splitInput.each {|o| copy.slice!(o) }
        out.push word if copy==""
     }
     return out
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T13:09:39.033

如果您想查找其字母和频率受给定短语限制的单词，您可以构建一个正则表达式来为您执行此操作：

```
sentence = "Ziegler's Giant Bar"

# count how many times each letter occurs in the 
# sentence (ignoring case, and removing non-letters)
counts = Hash.new(0)
sentence.downcase.gsub(/[^a-z]/,'').split(//).each do |letter|
  counts[letter] += 1
end
letters = counts.keys.join
length = counts.values.inject { |a,b| a + b }

# construct a regex that matches upto that many occurences
# of only those letters, ignoring non-letters
# (in a positive look ahead)
length_regex = /(?=^(?:[^a-z]*[#{letters}]){1,#{length}}[^a-z]*$)/i
# construct regexes that matches each letter up to its
# proper frequency (in a positive look ahead)
count_regexes = counts.map do |letter, count|
  /(?=^(?:[^#{letter}]*#{letter}){0,#{count}}[^#{letter}]*$)/i
end

# combine the regexes, to form a regex that will only
# match words that are made of a subset of the letters in the string
regex = /#{length_regex}#{count_regexes.join('')}/

# open a big file of words, and find all the ones that match
words = File.open("/usr/share/dict/words") do |f|
  f.map { |word| word.chomp }.find_all { |word| regex =~ word }
end

words.length #=> 3182
words #=> ["A", "a", "aa", "aal", "aalii", "Aani", "Ab", "aba", "abaiser", "Abantes",
          "Abaris", "abas", "abase", "abaser", "Abasgi", "abate", "abater", "abatis",
          ...
          "ba", "baa", "Baal", "baal", "Baalist", "Baalite", "Baalize", "baar", "bae",
          "Baeria", "baetzner", "bag", "baga", "bagani", "bagatine", "bagel", "bagganet",
          ...
          "eager", "eagle", "eaglet", "eagre", "ean", "ear", "earing", "earl", "earlet",
          "earn", "earner", "earnest", "earring", "eartab", "ease", "easel", "easer",
          ...
          "gab", "Gabe", "gabi", "gable", "gablet", "Gabriel", "Gael", "gaen", "gaet",
          "gag", "gagate", "gage", "gageable", "gagee", "gageite", "gager", "Gaia",
          ...
          "Iberian", "Iberis", "iberite", "ibis", "Ibsenite", "ie", "Ierne", "Igara",
          "Igbira", "ignatia", "ignite", "igniter", "Ila", "ilesite", "ilia", "Ilian",
          ...
          "laang", "lab", "Laban", "labia", "labiate", "labis", "labra", "labret", "laet",
          "laeti", "lag", "lagan", "lagen", "lagena", "lager", "laggar", "laggen",
          ...
          "Nabal", "Nabalite", "nabla", "nable", "nabs", "nae", "naegate", "naegates",
          "nael", "nag", "Naga", "naga", "Nagari", "nagger", "naggle", "nagster", "Naias",
          ...
          "Rab", "rab", "rabat", "rabatine", "Rabi", "rabies", "rabinet", "rag", "raga",
          "rage", "rager", "raggee", "ragger", "raggil", "raggle", "raging", "raglan",
          ...
          "sa", "saa", "Saan", "sab", "Saba", "Sabal", "Saban", "sabe", "saber",
          "saberleg", "Sabia", "Sabian", "Sabina", "sabina", "Sabine", "sabine", "Sabir",
          ...
          "tabes", "Tabira", "tabla", "table", "tabler", "tables", "tabling", "Tabriz",
          "tae", "tael", "taen", "taenia", "taenial", "tag", "Tagabilis", "Tagal",
          ...
          "zest", "zeta", "ziara", "ziarat", "zibeline", "zibet", "ziega", "zieger",
          "zig", "zing", "zingel", "Zingiber", "zira", "zirai", "Zirbanit", "Zirian"] 
```

积极的前瞻让您可以创建一个匹配字符串中某些指定模式匹配的*位置*的正则表达式，而不会消耗匹配的字符串部分。我们在这里使用它们将相同的字符串与单个正则表达式中的多个模式进行匹配。只有当我们所有的模式都匹配时，该位置才匹配。

如果我们允许无限重复使用原始短语中的字母（就像 Knuth 根据[glenra](https://stackoverflow.com/users/98221/glenra)的评论所做的那样），那么构建正则表达式会更容易：

```
sentence = "Ziegler's Giant Bar"

# find all the letters in the sentence
letters = sentence.downcase.gsub(/[^a-z]/,'').split(//).uniq

# construct a regex that matches any line in which
# the only letters used are the ones in the sentence
regex = /^([^a-z]|[#{letters.join}])*$/i

# open a big file of words, and find all the ones that match
words = File.open("/usr/share/dict/words") do |f|
  f.map { |word| word.chomp }.find_all { |word| regex =~ word }
end

words.length #=> 6725
words #=> ["A", "a", "aa", "aal", "aalii", "Aani", "Ab", "aba", "abaiser", "abalienate",
           ...
           "azine", "B", "b", "ba", "baa", "Baal", "baal", "Baalist", "Baalite",
           "Baalize", "baar", "Bab", "baba", "babai", "Babbie", "Babbitt", "babbitt",
           ...
           "Britannian", "britten", "brittle", "brittleness", "brittling", "Briza",
           "brizz", "E", "e", "ea", "eager", "eagerness", "eagle", "eagless", "eaglet",
           "eagre", "ean", "ear", "earing", "earl", "earless", "earlet", "earliness",
           ...
           "eternalize", "eternalness", "eternize", "etesian", "etna", "Etnean", "Etta",
           "Ettarre", "ettle", "ezba", "Ezra", "G", "g", "Ga", "ga", "gab", "gabber",
           "gabble", "gabbler", "Gabe", "gabelle", "gabeller", "gabgab", "gabi", "gable",
           ...
           "grittiness", "grittle", "Grizel", "Grizzel", "grizzle", "grizzler", "grr",
           "I", "i", "iba", "Iban", "Ibanag", "Iberes", "Iberi", "Iberia", "Iberian",
           ...
           "itinerarian", "itinerate", "its", "Itza", "Izar", "izar", "izle", "iztle",
           "L", "l", "la", "laager", "laang", "lab", "Laban", "labara", "labba", "labber",
           ...
           "litter", "litterer", "little", "littleness", "littling", "littress", "litz",
           "Liz", "Lizzie", "Llanberisslate", "N", "n", "na", "naa", "Naassenes", "nab",
           "Nabal", "Nabalite", "Nabataean", "Nabatean", "nabber", "nabla", "nable",
           ...
           "niter", "nitraniline", "nitrate", "nitratine", "Nitrian", "nitrile",
           "nitrite", "nitter", "R", "r", "ra", "Rab", "rab", "rabanna", "rabat",
           "rabatine", "rabatte", "rabbanist", "rabbanite", "rabbet", "rabbeting",
           ...
           "riteless", "ritelessness", "ritling", "rittingerite", "rizzar", "rizzle", "S",
           "s", "sa", "saa", "Saan", "sab", "Saba", "Sabaean", "sabaigrass", "Sabaist",
           ...
           "strigine", "string", "stringene", "stringent", "stringentness", "stringer",
           "stringiness", "stringing", "stringless", "strit", "T", "t", "ta", "taa",
           "Taal", "taar", "Tab", "tab", "tabaret", "tabbarea", "tabber", "tabbinet",
           ...
           "tsessebe", "tsetse", "tsia", "tsine", "tst", "tzaritza", "Tzental", "Z", "z",
           "za", "Zabaean", "zabeta", "Zabian", "zabra", "zabti", "zabtie", "zag", "zain",
           ...
           "Zirian", "Zirianian", "Zizania", "Zizia", "zizz"] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T10:36:36.170

我不认为 Ruby 有英文词典。但是您可以尝试将原始字符串的所有排列存储在一个数组中，然后对照 Google 检查这些字符串？说一个词实际上是一个词，如果有超过 100.000 次点击或什么？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T11:10:48.210

你可以得到一个这样的字母数组：

```
sentence = "Ziegler's Giant Bar"
letters = sentence.split(//) 
```

# qt4 - QTextEdit 中未正确显示不间断空格

> ID：843035
> 
> 赞同：5
> 
> 时间：2009-05-09T09:33:47.037
> 
> 标签：qt4

`QTextEdit t; t.setHtml("&nbsp;");`显示带有尖锐重音的小“a”而不是不间断空格。这只发生在 Windows 上，而不是 Linux 或 FreeBSD。这可能是什么原因造成的？Windows/Qt 中的错误？我怎样才能解决这个问题？

（Windows Vista x64 pro 上的 Qt 4.5。我的语言环境是默认的“C”。）

更新：我感觉这是 Qt/Windows 中的错误（已经提交了错误报告）。我已经创建了一个解决方法，但它很丑陋，并且涉及更改我的格式算法并`<pre> </pre>`与 CSS 一起使用来产生所需的输出。

有没有更简单的解决方法？

更新：&8194; &8195; 两者都按照“wcm”的建议工作。假设这也适用于其他用户是否安全？ `&nbsp;`不工作可能仍然是一个错误，但是 &8194; 似乎是一个可接受的解决方法（？）。

更新：原来我错过了一些重要的事情：`&nbsp;`在 Qt/Windows 中，仅使用我使用的称为“终端”的特定单型字体才能正确呈现。当我切换到“Lucida Console”（或任何其他字体）时，`&nbsp;`渲染正确！伙计，我真希望我早点注意到这一点！该死。所以很明显某处存在错误（很可能在Qt中）。但没关系，至少对我来说使用不同的字体已经解决了这个问题。

更新：这不是我之前认为的 Qt 中的错误。`&nbsp;`要了解渲染不正确的原因，请参阅 Tewha 的回答。

[解决了]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T12:29:28.970

对这个主题不太了解，所以对此持保留态度，但是您是否尝试过其中一个 unicode 变体，例如`&#160;`or`&#8194;`或`&#8195;`？

我自己不使用 QT，但是我在使用 XML/XSLT 生成的一些文档时遇到了这个问题。使用`&#160;`为我解决了这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T00:39:59.143

我看到你基本上已经弄清楚了，但我想我会添加它的“为什么”。终端字体基于代码页 437，即 DOS-US。á 位于 160 位。

代码页 437 的字体并不多。事实上，我认为 Terminal 是唯一的 TrueType 字体！无论如何，如果您没有明确地尝试显示老式的 DOS 图形，那么您不应该使用终端。

什么是代码页 437？它是“高 ASCII”，大约 1981 年。除了通常的 32-127 个字符外，它还包括一些重音字母、用于在事物周围绘制边框的方框图形字符、一些数学符号，甚至是四张牌的符号！但是世界以不同的方式发展，因此除了 32-127 之外，即使是通常以其他字体提供的字形也不是您期望的。如果您在窗口中运行旧的文本模式 MSDOS 程序，它将使用代码页 437 字体。

有关更多信息，请参阅“[代码页 437](http://en.wikipedia.org/wiki/Code_page_437) ”（维基百科）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T16:04:46.093

我最好的猜测是： t.setHtml("<html> </html>");

```
t.setHtml("<html>&nbsp;</html>"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T11:27:48.910

我实际上在文档（[此处](http://doc.trolltech.com/4.2/richtext-html-subset.html)）中看不到任何关于它是否支持 & 号项目的内容。您可能想测试其他一些，例如`"&amp;"`或`"&lt;"`。

提到了对标签的支持，因此*您*`nobr`可能可以获得类似的效果（这是这些标签之间的空格）：

```
QTextEdit t;
t.setHtml("<nobr> </nobr>"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T04:00:11.910

我使用 Qt 4.5.0 在 Mac 上对此进行了测试。非破坏空间实体与其他实体一起工作得非常好。我所做的只是修改 Qt 4 附带的 MDI 示例项目中的源代码。

MdiChild继承了QTextEdit，所以在mdichild.cpp中，我`setHtml()`在构造函数中添加了调用：

[mdichild.cpp http://krsna.ca/dev/images/mdichild.png](http://krsna.ca/dev/images/mdichild.png)

这产生了以下 QTextEdit，包含所有实体，包括不间断空格：

[MDI 截图 http://krsna.ca/dev/images/mdi-screenshot.png](http://krsna.ca/dev/images/mdi-screenshot.png)

我的猜测是这是一个 Windows 错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T14:57:04.600

我使用 Qt 4.5.0 在 Windows XP SP3 x32 下对其进行了测试，它按预期工作。不确定这是否可能是您的 Windows 语言环境或 x64 特定错误的问题，尽管我对此表示怀疑。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-04T13:12:53.847

我会考虑做类似的事情来创建在 QtextEdit（或 QTextBrowser）中工作的空格：

```
QString msg = "Some   Text   with  3   Whitespaces";
msg.replace(" ","&nbsp;"); 
```

然后所有空格将被替换为 html 代码   ; （硬编码空格）这对我来说效果很好。

编辑：抱歉，这只适用于以下情况：

```
msg.prepend("<font></font>"); 
```

我不明白为什么（标签已关闭，所以有意义吗？）也许有人想解释一下...

# windows - 在 wxPython/wxWidgets 中添加系统菜单项

> ID：843036
> 
> 赞同：0
> 
> 时间：2009-05-09T09:36:01.137
> 
> 标签：windows, wxpython, wxwidgets

如何在 wxPython/wxWidgets 中将菜单项添加到框架的系统菜单中？
（我说的是单击 Windows 中的应用程序图标时出现的菜单 - 具有最小化、最大化、关闭...的菜单）。

我想为一个不需要完整顶部菜单的简单应用程序添加我自己的菜单项。

仅 Windows 的解决方案，如果存在（并且足够简单），也会很有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T21:08:52.060

我不认为 wxWidgets/wxPython 允许您操作系统菜单，但有一些例外情况不足以满足您的需求：

*   您可以通过将样式标志传递给 wx.Frame 来删除系统菜单：`style=wx.DEFAULT_FRAME_STYLE & ~wx.SYSTEM_MENU`

*   在 Mac OS X 上，带有 id 的菜单项，如`wx.ID_EXIT`和`wx.ID_HELP`被移动到应用程序菜单中。

我试图绑定`wx.EVT_MENU_OPEN`事件，虽然调用了事件处理程序，但传递的事件不包含任何在 Windows 上有用的东西。当我打开 Frame 的系统菜单时，下面的代码会打印“None 0”：

```
import wx

class Frame(wx.Frame):
    def __init__(self, *args, **kwargs):
        super(Frame, self).__init__(*args, **kwargs)
        self.Bind(wx.EVT_MENU_OPEN, self.onMenuOpen)

    def onMenuOpen(self, event):
        print event.GetMenu(), event.GetMenuId()
        event.Skip()

app = wx.App(0)
frame = Frame(None)
frame.Show()
app.MainLoop() 
```

# java - 分析单词文本的算法

> ID：843037
> 
> 赞同：1
> 
> 时间：2009-05-09T09:37:29.197
> 
> 标签：java, php, algorithm, string, nlp

我想要一种算法，可以在文本块中创建所有可能的短语。例如，在文本中：

```
"My username is click upvote. I have 4k rep on stackoverflow" 
```

它将创建以下组合：

```
"My username"
"My Username is"
"username is click"
"is click"
"is click upvote"
"click upvote"
"i have"
"i have 4k"
"have 4k"
.. 
```

你明白了。基本上，重点是从句子中获得所有可能的“短语”组合。关于如何最好地实现这一点的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T10:55:50.553

基本上，您需要首先将文本块分成句子。这很棘手，即使在英语中也是如此，因为您需要注意句号、问号、感叹号和任何其他句子终止符。

然后在删除所有标点符号（逗号、分号、冒号等）后一次处理一个句子。

然后，当您留下一组单词时，它变得更简单：

```
for i = 1 to num_words-1:
    for j = i+1 to num_words:
        phrase = words[i through j inclusive]
        store phrase 
```

就是这样，非常简单（在对文本块进行初始按摩之后，这可能*不像*您想象的那么简单）。

这将为您提供每个句子中包含两个或多个单词的所有短语。

分句、分词、去除标点符号等将是最难的部分，但我已经向您展示了一些简单的初始规则。每次文本块破坏算法时，都应添加其余部分。

**更新：**

根据要求，这里有一些给出短语的 Java 代码：

```
public class testme {
    public final static String text =
        "My username is click upvote." +
        " I have 4k rep on stackoverflow."; 
```

```
 public static void procSentence (String sent) {
        System.out.println ("==========");
        System.out.println ("sentence [" + sent + "]");

        // Split sentence at whitspace into array.

        String [] sa = sent.split("\\s+");

        // Process each starting word.

        for (int i = 0; i < sa.length - 1; i++) {

            // Process each phrase.

            for (int j = i+1; j < sa.length; j++) {

                // Build the phrase.

                String phrase = sa[i];
                for (int k = i+1; k <= j; k++) {
                    phrase = phrase + " " + sa[k];
                }

                // This is where you have your phrase. I just
                // print it out but you can do whatever you
                // wish with it.
                System.out.println ("   " + phrase);
            }
        }
    } 
```

```
 public static void main(String[] args) {
        // This is the block of text to process.

        String block = text;
        System.out.println ("block    [" + block + "]");

        // Keep going until no more sentences.

        while (!block.equals("")) {
            // Remove leading spaces.

            if (block.startsWith(" ")) {
                block = block.substring(1);
                continue;
            }

            // Find end of sentence.

            int pos = block.indexOf('.');

            // Extract sentence and remove it from text block.

            String sentence = block.substring(0,pos);
            block = block.substring(pos+1);

            // Process the sentence (this is the "meat").

            procSentence (sentence);

            System.out.println ("block    [" + block + "]");
        }
        System.out.println ("==========");
    }
} 
```

输出：

```
block    [My username is click upvote. I have 4k rep on stackoverflow.]
==========
sentence [My username is click upvote]
   My username
   My username is
   My username is click
   My username is click upvote
   username is
   username is click
   username is click upvote
   is click
   is click upvote
   click upvote
block    [ I have 4k rep on stackoverflow.]
==========
sentence [I have 4k rep on stackoverflow]
   I have
   I have 4k
   I have 4k rep
   I have 4k rep on
   I have 4k rep on stackoverflow
   have 4k
   have 4k rep
   have 4k rep on
   have 4k rep on stackoverflow
   4k rep
   4k rep on
   4k rep on stackoverflow
   rep on
   rep on stackoverflow
   on stackoverflow
block    []
========== 
```

现在，请记住这是非常基本的 Java（有些人可能会说它是用 Java 方言编写的 C :-)。它只是为了说明如何根据您的要求从句子中输出单词分组。

它并*没有*完成我在原始答案中提到的所有花哨的句子检测和标点删除。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-09T09:42:10.683

好吧，我不知道 PHP 或 java，但基本上你想要对文本中的所有单词进行双重循环。这是一些伪代码：

```
words = split(text)
n = len(words)
for i in 1...n-1 {        // i = first word in phrase 
    for j in i+1...n {       // j = last word in phrase
        phrase = join(words[i:j])
        print phrase
    }
} 
```

请注意，第二个循环从 i 开始，而不是 1。这将为您提供从单词编号 i 开始到大于 i 的单词编号 j 的所有短语（因此所有短语至少有两个单词）。

啊，我刚刚意识到您可能不希望短语跨越句子边界。所以你需要一个外部循环，它首先将文本分成句子，然后在每个句子上运行它。

如果您有任何编程经验，这似乎很清楚，但以防万一：`for`语句是循环 [like `for(i=1; i<=n; i++)`]，`split`是一些函数，它接受一个字符串并将其拆分为一个单词数组——这并非完全无关紧要，但可能有一个库函数可以做到这一点，`len`给出数组的长度，`join`将它们放回一起，中间有空格，语法`[i:j]`意味着所有元素 from`i`到`j`inclusive （在python中，这实际上是`[i:j+1]`）。哦，我已经隐含地假设数组从索引 1 而不是零开始；我将更改为基于 0 的`C`数组作为练习...

最后，回答具体问题：

*   请注意，“第二个”循环实际上是一个*内部*循环；对于`i`（短语的第一个单词）的每个值，我们循环`i+1`到句子的末尾以给出短语的最后一个单词。

*   现在我们有了第一个单词和最后一个单词的数量，这个`join`函数——你必须编写它——将各个字符串`word[i], word[i+1], ... word[j]`与它们之间的空格连接起来以形成短语。在实践中，这可能意味着函数可以声明为类似`join(words, i, j)`并返回字符串，尽管有些语言有办法使这更容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T15:10:56.000

只需对句子进行标记并使用 CombinationGenerator。该算法由 Kenneth H. Rosen 描述，离散数学及其应用，第 2 版（纽约：McGraw-Hill，1991），第 284-286 页。

这是代码和使用示例： [http ://www.merriampark.com/comb.htm](http://www.merriampark.com/comb.htm)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T17:51:24.950

可以随心所欲地玩`str_word_count();`和构建它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-05-23T03:44:08.450

您可能已经知道此类短语的技术术语是 Shingle。您可以使用 Lucene 的[ShingeMatrixFilter](http://lucene.apache.org/java/3_0_0/api/all/org/apache/lucene/analysis/shingle/ShingleMatrixFilter.html)为输入文本获取带状疱疹。

# javascript - 如何替换javascript中最后出现的单词？

> ID：843049
> 
> 赞同：9
> 
> 时间：2009-05-09T09:59:12.217
> 
> 标签：javascript, regex

例如：

```
var str="<br>hi<br>hi"; 
```

替换 last(second) `<br>`，

变成`"<br>hihi"`

我试过了：</p>

```
str.replace(/<br>(.*?)$/,\1); 
```

但这是错误的。什么是正确的版本？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-09T10:07:41.417

您可以使用量词是贪婪的事实：

```
str.replace(/(.*)<br>/, "$1"); 
```

但缺点是会导致回溯。

另一种解决方案是拆分字符串，将最后两个元素放在一起，然后连接部分：

```
var parts = str.split("<br>");
if (parts.length > 1) {
    parts[parts.length - 2] += parts.pop();
}
str = parts.join("<br>"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T10:06:30.140

我想你想要这个：

```
str.replace(/^(.*)<br>(.*?)$/, '$1$2') 
```

这贪婪地匹配从开头到 a 的所有内容`<br>`，然后是 a `<br>`，然后不贪婪地匹配所有内容到结尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-13T22:54:33.623

```
String.prototype.replaceLast = function(what, replacement) { 
    return this.replace(new RegExp('^(.*)' + what + '(.*?)$'), '$1' + replacement + '$2');
}

str = str.replaceLast(what, replacement); 
```

# .net - .NET 中的本地化地区/国家名称

> ID：843055
> 
> 赞同：5
> 
> 时间：2009-05-09T10:02:24.037
> 
> 标签：.net, globalization

是否可以在 .NET 中检索国家/地区的本地化名称？

RegionInfo[类](http://msdn.microsoft.com/en-us/library/system.globalization.regioninfo(VS.80).aspx)只有 EnglishName、DisplayName 和 NativeName - 但似乎无法获得例如“Austria”的丹麦本地名称“Østrig”。无论线程使用哪种 Culture 或 UICulture 运行，它们都将始终返回英文名称。

有没有我可以使用的技术，或者我必须为此创建一个数据存储？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T10:59:00.857

仅当框架具有所需语言的资源时，本地化名称才可用。因此，您需要在 DisplayName 返回所需名称之前安装语言包（当然，在应用程序中设置正确的文化）。

在此处下载[丹麦语 3.5 SP1 语言包](http://www.microsoft.com/downloads/details.aspx?displaylang=da&FamilyID=8489ed13-b831-4855-96f7-dd35e4c02a20)（也可以选择许多其他语言）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T10:52:10.157

伙计们，您完全误解了 MSDN 声明：

> DisplayName 属性以 .NET Framework**本地化版本的语言**显示国家/地区名称。

因此，您需要为国家/地区名称实施自己的本地化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T10:07:30.793

根据 MSDN 文档，[`RegionInfo.DisplayName`](http://msdn.microsoft.com/en-us/library/system.globalization.regioninfo.displayname.aspx)应该获取该国家/地区的本地化（在您的情况下为丹麦语）名称。鉴于它仍在为您返回英文版本，我怀疑您只需要在（重新）安装 .NET Framework 时配置语言环境。让我知道这是否有用。

# database - 分析 Twitter 推文等

> ID：843057
> 
> 赞同：-1
> 
> 时间：2009-05-09T10:03:58.667
> 
> 标签：database, twitter

我对编程知之甚少，所以会雇用某人为我做这件事，但我想知道你认为需要什么东西才能从 Twitter 获取某些推文——可能使用搜索 API，然后分析它们并链接它们到其他推文，然后将它们输出到电子表格或类似内容中。我的意思是——它需要是 mySQP、RoR、C# 等吗——正如你所见，我对这类东西知之甚少！

感谢您的任何回答 - 非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T10:12:48.800

这是一个非常笼统的问题，所以恐怕我只能给出一个非常笼统的答案。

您描述的内容可以用大多数编程语言完成。C# 或 Ruby（你并不真正需要 rails 部分，用于构建网站）肯定是不错的选择。Java、Python 等也可以做到这一点。有用于访问所有这些语言的 twitter api 的库。将推文匹配和输出到电子表格也完全独立于语言，因为大多数电子表格将读取逗号分隔值文件。

MySQL 是一个数据库，不是一个好的候选者，您可以对大多数数据库进行有限的编程，但这可能不是您想要的。

我会先找一个好的程序员，然后让他/她用自己选择的语言工作。通常找到优秀的程序员是最困难的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T10:10:34.423

我相信大多数主要编程语言都有一个 twitter API。

就我个人而言，我会选择一种非常高级的语言，比如 python。这是[python-twitter 接口](http://code.google.com/p/python-twitter/)的链接，从那里输出到其他格式（XML、电子表格、CSV）非常简单。

我想这也取决于你想对数据进行什么处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T11:08:24.750

如前所述，这几乎可以用任何语言轻松完成。

就个人而言，我会在 Perl 中执行此操作。以我的经验，尽管 Perl 多年来受到的所有负面报道，它仍然是文本处理的最佳选择，这就是你想要做的事情。

Perl 也有 Net::Twitter 模块，它允许您非常简单地从 Twitter 访问数据。例如，我展示了一些[使用 Perl 和 Net::Twitter 监控标签的](http://code.sherohman.org/monitoring-hashtags-perl-and-net-twitter)代码，几天前我在我的编码博客上发布了这些代码。（希望它也有助于对抗 Perl 作为一种只写语言的持久神话......）

# javascript - JavaScript synchronization options

> ID：843058
> 
> 赞同：10
> 
> 时间：2009-05-09T10:04:46.480
> 
> 标签：javascript, ajax, caching, synchronization

I was wondering whenever exists a solution to perform synchronization in JavaScript code. For example I have the following case: I'm trying to cache some response values from AJAX call, the problem is, that it's possible to perform simultaneously several calls, therefore it leads to race condition in the code. So I'm very curious to find solution for that? Any one has idea that to do?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-09T11:36:42.717

I can offer a possible solution, but without seeing the code ... not completely sure what you are doing, but there is no reason why you couldn't do this.

Basic code in jQuery : (not tested and abbreviated ... but I have done things similar)

```
var needAllThese = {};

$(function(){

      $.ajax("POST","/somepage.aspx",function(data) {
          needAllThese.A = "VALUE";
      });

      $.ajax("POST","/somepage2.aspx",function(data) {
          needAllThese.B = "VALUE";
      });

      $.ajax("POST","/somepage3.aspx",function(data) {
          needAllThese.C = "VALUE";
      });

      startWatching();
});

function startWatching() {
   if (!haveEverythingNeeded()) {
       setTimeout(startWatching,100);
       return;
   }
   everythingIsLoaded();
}

function haveEverythingNeeded() {
    return needAllThese.A && needAllThese.B && needAllThese.C;
}

function everythingIsLoaded() {
   alert("Everything is loaded!");
} 
```

EDIT: (re: your comment)

You're looking for callbacks, the same way jQuery would do it.

```
 var cache = {};

   function getSomeValue(key, callback) {
       if (cache[key]) callback( cache[key] );

       $.post( "url",  function(data) {
           setSomeValue(key,data);
           callback( cache[key] );
       }); 
   }

   function setSomeValue(key,val) {
        cache[key] = val;
   }

   $(function(){       
        // not sure you would need this, given the code above
        for ( var i = 0; i < some_length; ++i)  {
            $.post( "url", function(data){ 
                setSomeValue("somekey",data); 
            });
        }

        getSomeValue("somekey",function(val){            
             $("#element").txt( val );              
        };            
    }); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-09T10:21:02.103

Javascript is inherently single-threaded, at least for the normal browser environment. There will never two simultaneous executions of scripts accessing the same document. (the new Javascript worker threads might be an exception here, but they're not meant to access documents at all, just to communicate by message passing).

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-11T14:02:42.183

I have found solution for my problem. I have to say it's not that perfect as I was looking for, but so far it works and I think about that more as temporarily work around.

```
$.post( "url1", function( data)
{
     // do some computation on data and then
     setSomeValue( data);
});

var setSomeValue = ( function()
{
    var cache = {};
    return function( data)
    {
        if ( cache[data] == "updating")
        {
             setTimeout( function(){ setSomeValue( data);}, 100);
             return;
        }
        if ( !cache[date])
        {
             cache[date] = updating;
             $.post( "url2", function( another_data)
             {
                  //make heavy computation on another_data
                  cache[data] = value;
                  // update the UI with value
             });
        }
        else
        {
             //update the UI using cached value
        }
    }
})(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-09T10:36:39.663

Yes you can make your xmlHttpRequests synchronous, in non-IE set the [asynch option](https://developer.mozilla.org/en/XMLHttpRequest#Parameters_5) to false on the open method, in IE browsers [do the same](http://msdn.microsoft.com/en-us/library/ms536648(VS.85).aspx) with the bAsync parameter.

Maybe you might want to chain your requests somehow. Create a que stack and send the requests as you make your way down the que.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-09T11:07:19.107

First, it's important to know that all current JS implementations are single-threaded, therefore we are not discussing race-conditions and synchronizing in the context it is usually used.

As a side note, browsers are now introducing worker threads which will allow concurrency in JS, but for now this is not the case.

Anyway, you still are facing issues with what data you are expecting to receive back form asynchronous calls and you have no guarantee as to the order you will receive things.

JS gives you a very nice solution to this with callbacks. For each asynchronous event you will be sending, attach a proper callback function to it, which will handle the event properly. *Synchronization*, in the way you mean it, should be happening there.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-09-19T17:01:16.527

I know it is way after but thought I would just give an improvement. Artem Barger worked out his own solution which uses setTimeout if the cached value is "updating" ... Instead just tag the function onto a linked queue against the cached value so you have an object which holds the actual cached data and the queue of functions to call with the cached data once the data is returned.

So, if it is "updating" just add your function to the queue which is linked against the item data and when the data returns...set the data and then iterate over the queue of functions (callbacks) and call them with the returned data.

if you wanted to get technical you could set a specific QOS timeout as you go through the queue, set a stop watch at the beginning of the iteration and if you reach a specific time then call a setTimeout to go back into the queue to continue the iteration...I hope you got that :) - It basically saves X amount of setTimout calls one only one is needed.

View Artem Bargers code above and you should get the gist of what I propose.

# subsonic - 亚音速三 (3) CreatedBy 字段未更新

> ID：843062
> 
> 赞同：1
> 
> 时间：2009-05-09T10:07:20.327
> 
> 标签：subsonic

使用 Subsonic 3 我有以下字段：

```
 o CreatedOn (datetime)
      o CreatedBy (nvarchar(50))
      o ModifiedOn (datetime)
      o ModifiedBy (nvarchar(50)) 
```

当我向表中添加数据时，它不会向这些列添加数据。我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T14:01:44.747

除非您使用 ActiveRecord 模板，否则这些字段不会像在版本 2 中那样在版本 3 中自动填充。您可以非常简单地修改模板以自己添加功能。

# java - JList 使用所有鼠标按钮选择项目

> ID：843064
> 
> 赞同：1
> 
> 时间：2009-05-09T10:07:41.013
> 
> 标签：java, swing, jlist

我怎样才能让一个摆动 JList 用任何鼠标按钮选择它的项目，而不仅仅是左边的？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T10:28:57.263

哦，刚刚找到了功能

```
 int s = list.locationToIndex(e.getPoint());
            list.setSelectedIndex(s); 
```

当您在鼠标侦听器中执行此操作时，它就可以完成工作。

# sql - 仅使用多个 from 和 join 有什么区别？

> ID：843069
> 
> 赞同：3
> 
> 时间：2009-05-09T10:11:09.427
> 
> 标签：sql, join

假设我有这个查询：

```
SELECT bugs.id, bug_color.name FROM bugs, bug_color
    WHERE bugs.id = 1 AND bugs.id = bug_color.id 
```

为什么要使用联接？它会是什么样子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T10:16:20.197

连接是合成糖，更容易阅读。

您的查询将与连接如下所示：

```
SELECT bugs.id, bug_color.name 
FROM bugs
INNER JOIN bug_color ON bugs.id = bug_color.id
WHERE bugs.id = 1 
```

对于两个以上的表，连接通过将与表相关的条件保存在一个位置来帮助使查询更具可读性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T10:41:03.850

`join`关键字是连接表的新方法。

当我学习 SQL 时，它还不存在，所以加入是按照您在问题中显示的方式完成的。

现在我们有诸如连接和别名之类的东西来使查询更具可读性：

```
select
    b.id, c.name
from
    bugs as b
inner join
    bug_color as c on c.id = b.id
where
    b.id = 1 
```

还有其他的连接变体， as和`left outer join`，用旧语法更难完成。`right outer join``full join`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T10:17:10.413

连接语法允许外连接，所以你可以去：

```
SELECT bugs.id, bug_color.name 
FROM bugs, bug_color 
LEFT OUTER JOIN bug_color ON bugs.id = bug_color.id
WHERE bugs.id = 1 
```

# subsonic - 如何在 Subsonic 中为 Subqueires 编写查询

> ID：843078
> 
> 赞同：1
> 
> 时间：2009-05-09T10:22:02.350
> 
> 标签：subsonic, subquery

如何在亚音速 2.2 中执行以下查询

```
select Table1.Id, Table1.Name, Table1.Age from Table1
where Table1.Id =
(
select Max(T.Id) from Table1 T
Where T.Age = 20
) 
```

谁能给我举个例子。

谢谢。nRk

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T10:02:14.367

Subsonic 2.2 可以做子查询：

正如亚当建议的那样，使用 In 编辑和改进了示例，这对我有用：

```
SubSonic.Select s = new SubSonic.Select(SSDAL.Customer.CustomerIDColumn, SSDAL.Customer.NameColumn);
SubSonic.Aggregate a = new SubSonic.Aggregate(SSDAL.Customer.CustomerIDColumn, SubSonic.AggregateFunction.Max);
SSDAL.CustomerCollection COL = new SSDAL.CustomerCollection();
SubSonic.Select sq = new SubSonic.Select("LastCustomerId");
sq.Aggregates.Add(a);
sq.From(Tables.Customer);
a.Alias = "LastCustomerId";
s.From(Tables.Customer);
s.Where(SSDAL.Customer.CustomerIDColumn).In(sq);
COL = s.ExecuteAsCollection<SSDAL.CustomerCollection>();
; 
```

此代码生成以下 SQL：

```
SELECT [dbo].[Customer].[CustomerID], [dbo].[Customer].[Name]
 FROM [dbo].[Customer]
 WHERE [dbo].[Customer].[CustomerID] IN (SELECT MAX([dbo].[Customer].[CustomerID]) AS 'LastCustomerId'
 FROM [dbo].[Customer]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T16:06:34.563

亚当可能正在做某事，但它看起来有点难看。这是一个更具可读性的示例，它返回 IDataReader

```
new SubSonic.Select(Table1.IdColumn,Table1.NameColumn,Table1.AgeColumn)
.From(Table1.Schema)
.Where(Table1.IdColumn).In(new SubSonic.Select(Aggregate.Max(Table1.IdColumn)).From(Table1.Schema))
.ExecuteReader(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-09T17:56:58.463

据我所知，SubSonic 中不支持子查询。您需要将查询放在存储过程中并使用生成的 SPs.SprocName() 方法。

编辑：我错了，请参阅下面的其他答案。

# apache-flex - Mate Framework - 在进行远程调用之前检查数据

> ID：843080
> 
> 赞同：1
> 
> 时间：2009-05-09T10:26:09.127
> 
> 标签：apache-flex, mate

直到最近我一直在使用 cairngorm 作为 flex 的框架。然而，在这个最新的项目中，我切换到了 Mate。它仍然让我有点困惑，因为我有点习惯于将数据留在模型中。我有几个组件依赖于相同的数据集（集合）。在组件中，创建完成处理程序发送一个被其中一个事件映射捕获的“GiveMeMyDataEvent”。现在在我的命令类的 cairngorm 中，我可以快速查看模型以确定是否需要从服务器获取数据，然后从模型返回数据或调用 db。我将如何在 Mate 中执行此操作？或者有没有更好的方法来解决这个问题，我正在尝试利用已经从服务器收到的数据，但同时我不确定我是否已经加载了数据。如果已实例化使用相同数据的组件，则答案为是，否则为否。非常感谢任何帮助/提示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T16:06:54.377

Mate 中的大多数事情都是间接的。您有管理数据的管理器，并在管理器和视图之间设置注入器（它们是绑定）。注入器确保您的视图与您的管理器同步。这样视图总是有最新的数据。视图不会作为调度事件的*直接*结果而更新，而是作为*间接*结果。

当您要加载新数据时，您分派一个被事件映射捕获的事件，该事件又调用一些服务，该服务加载数据并将其返回给事件映射，并且事件映射将其粘贴到适当的管理器中。

当管理器更新时，注入器确保视图已更新。

通过使用注入器，您可以保证视图中始终包含最新数据，因此如果视图有数据，则数据会被加载——除非您需要定期更新，在这种情况下，您可以确定数据是否过时并分派触发服务调用的事件，触发更新，触发注入器将新数据再次推送到视图中，然后循环。

因此，简而言之，您的问题的答案是您需要确保正确使用注射器。如果这对您来说太高级了，我知道您可以在[Mate 论坛](http://mate.asfusion.com/forums)中获得更多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-08T10:07:45.260

我目前正在开发的应用程序遇到了类似的情况，并发现当您开始考虑拥有**两个**事件时，它很容易在 Mate 中实现。

第一个事件类似于`DataEvent.REFRESH_MY_DATA`. 这个事件由一些 DataManager 处理，它可以决定要么忽略它（因为数据已经存在于客户端并被认为是最新的），或者管理器可以调度一个事件，如`DataEvent.FETCH_MY_DATA`.

该`FETCH_MY_DATA`事件触发事件映射中的服务调用，该调用会更新管理器中的值。此更新是属性注入到视图中，快乐的日子 :)

# c++ - 在 C++ 中按完整路径打开文件

> ID：843083
> 
> 赞同：20
> 
> 时间：2009-05-09T10:27:49.357
> 
> 标签：c++, file, path, ifstream

我希望用户给我文件所在的完整路径，而不仅仅是文件名。如何以这种方式打开文件？

是这样的吗：

```
ifstream file;
file.open("C:/Demo.txt", ios::in); 
```

这似乎不起作用。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-09T10:32:05.977

通常在 Windows 中使用反斜杠字符作为路径分隔符。所以：

```
ifstream file;
file.open("C:\\Demo.txt", ios::in); 
```

请记住，当用 C++ 源代码编写时，您必须使用双反斜杠，因为反斜杠字符本身在双引号字符串中具有特殊含义。所以上面指的是文件`C:\Demo.txt`。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-09T10:31:50.673

您可以对 fstream 类使用完整路径。以下代码尝试在 C: 驱动器的根目录中打开文件 demo.txt。请注意，由于这是一个输入操作，因此该文件必须已经存在。

```
#include <fstream>
#include <iostream>
using namespace std;

int main() {
   ifstream ifs( "c:/demo.txt" );       // note no mode needed
   if ( ! ifs.is_open() ) {                 
      cout <<" Failed to open" << endl;
   }
   else {
      cout <<"Opened OK" << endl;
   }
} 
```

此代码在您的系统上产生什么？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-17T14:31:39.060

该代码似乎对我有用。我认为@Iothar 也是如此。

检查您是否包含所需的标头以进行编译。如果已编译，请检查是否存在这样的文件，以及所有内容、名称等是否匹配，并检查您是否有权读取该文件。

要进行交叉检查，请检查是否可以使用 fopen..

```
FILE *f = fopen("C:/Demo.txt", "r");
if (f)
  printf("fopen success\n"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-02T04:31:01.663

对于那些动态获取路径的人......例如**拖放：**

一些主要结构使用双引号拖放文件，例如：

```
"C:\MyPath\MyFile.txt" 
```

快速而好的解决方案是使用此函数从字符串中删除字符：

```
void removeCharsFromString( string &str, char* charsToRemove ) {
   for ( unsigned int i = 0; i < strlen(charsToRemove); ++i ) {
      str.erase( remove(str.begin(), str.end(), charsToRemove[i]), str.end() );
   }
} 

string myAbsolutepath; //fill with your absolute path
removeCharsFromString( myAbsolutepath, "\"" ); 
```

`myAbsolutepath`现在只包含`C:\MyPath\MyFile.txt`

该函数需要这些库：`<iostream>` `<algorithm>` `<cstring>`.
该功能基于[此答案](https://stackoverflow.com/questions/5891610/how-to-remove-characters-from-a-string)。

**工作小提琴：http:** [//ideone.com/XOROjq](http://ideone.com/XOROjq)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-15T01:12:35.463

对这个问题有不同的看法，这可能会对某人有所帮助：

我来到这里是因为我在 Windows 上的 Visual Studio 中进行调试，我对所有这些`/`与`\\`讨论感到困惑（在大多数情况下这真的无关紧要）。

对我来说，问题是：“当前目录”没有设置为我在 Visual Studio 中想要的。它默认为可执行文件的目录（取决于您如何设置项目）。

通过以下方式更改它：右键单击解决方案 -> 属性 -> 工作目录

我只提到它是因为这个问题似乎以 Windows 为中心，这通常也意味着以 VisualStudio 为中心，这告诉我这个提示可能是相关的（：

# php - 使用 PHP 进行 DOM 操作

> ID：843098
> 
> 赞同：1
> 
> 时间：2009-05-09T10:40:52.167
> 
> 标签：php, dom, parsing

我想用 PHP 对 DOM 元素进行简单但不平凡的操作，但我迷路了。

假设有一个像 Wikipedia 这样的页面，其中有段落和标题 ( `<p>`, `<h2>`)。他们是兄弟姐妹。我想按顺序采用这两个元素。

我已经尝试过`GetElementbyName`，但是您无法组织信息。我试过`DOMXPath->query()`了，但我发现它真的很混乱。

只是解析类似的东西：

```
<html>
  <head></head>
  <body>
    <h2>Title1</h2>
    <p>Paragraph1</p>
    <p>Paragraph2</p>
    <h2>Title2</h2>
    <p>Paragraph3</p>
  </body>
</html> 
```

进入：

```
标题1
第 1 段
第2段
标题2
第 3 段

```

只需几位 HTML 代码，我就不需要所有这些。

谢谢你。我希望问题看起来不像家庭作业。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T10:52:09.017

我认为`DOMXPath->query()`是正确的做法。`<h2>`此 XPath 表达式将返回同一级别的 a或 a的所有节点`<p>`（因为您说它们是同级节点）。

```
/html/body/*[name() = 'p' 或 name() = 'h2']
```

节点将以正确的顺序（文档顺序）作为[节点列表返回。](http://us2.php.net/manual/en/class.domnodelist.php)然后，您可以在结果上构造一个 foreach 循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T12:22:28.220

我已经多次使用 SCChhen 的简单 html dom。

访问 dom 元素的完美类。

例子：

```
// Create DOM from URL or file
$html = file_get_html('http://www.google.com/');

// Find all images
foreach($html->find('img') as $element)
       echo $element->src . '<br>';

// Find all links
foreach($html->find('a') as $element)
       echo $element->href . '<br>'; 
```

在这里查看。[简单的htmldom](http://simplehtmldom.sourceforge.net/)

可能有助于未来的项目

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T12:47:10.677

尝试看看这个库和相应的项目：

[简单的 HTML DOM](http://simplehtmldom.sourceforge.net/)

这允许您从文件系统打开在线网页或 html 页面，并通过类名、标签名和 ID 访问其项目。如果您熟悉 jQuery 及其语法，您无需花时间习惯这个库。

# c# - 如何改进我的代码以提高视频质量？

> ID：843100
> 
> 赞同：0
> 
> 时间：2009-05-09T10:41:43.020
> 
> 标签：c#, windows, video, media, encoder

我正在使用以下代码来利用 Windows Media Encoder 来录制屏幕。我使用的是 Windows Vista，屏幕分辨率 1024 × 768， 32 位。我的问题是，视频可以录制成功，但是当我播放录制的视频时，视频质量不是很好——例如字符非常模糊。我想知道我应该尝试调整哪些参数以获得更好的录像机视频质量？

我的代码，

```
 static WMEncoder encoder = new WMEncoder();

            IWMEncSourceGroup SrcGrp;
            IWMEncSourceGroupCollection SrcGrpColl;
            SrcGrpColl = encoder.SourceGroupCollection;
            SrcGrp = (IWMEncSourceGroup)SrcGrpColl.Add("SG_1");

            IWMEncVideoSource2 SrcVid;
            SrcVid = (IWMEncVideoSource2)SrcGrp.AddSource(WMENC_SOURCE_TYPE.WMENC_VIDEO);
            SrcVid.SetInput("ScreenCap://ScreenCapture1", "", "");
            IWMEncFile File = encoder.File;
            File.LocalFileName = "C:\\OutputFile.avi";

            // Choose a profile from the collection.
            IWMEncProfileCollection ProColl = encoder.ProfileCollection;
            IWMEncProfile Pro;
            for (int i = 0; i < ProColl.Count; i++)
            {
                Pro = ProColl.Item(i);
                if (Pro.Name == "Windows Media Video 8 for Local Area Network (384 Kbps)")
                {
                    SrcGrp.set_Profile(Pro);
                    break;
                }
            }

        encoder.Start(); 
```

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T11:03:49.193

视频编码器使用特定的 kbit/s 比率来限制生成的流的大小。kbits/sec 越少，您获得的细节就越少，因为 DCT 的系数越少，量化值越大。换句话说：您放入视频的 kbits/sec 越多，编码器可以将更多细节存储在流中。

从您的代码来看，您选择了一个使用 384 kbit/s 的配置文件，这对于 1024*768 视频来说不是很多。您应该尝试其他配置文件或设置自己想要的比特率。

# javascript - 字符文字中的字符过多

> ID：843108
> 
> 赞同：0
> 
> 时间：2009-05-09T10:50:58.693
> 
> 标签：javascript

我正在使用 StringBuilder 添加一些脚本。脚本如下图所示。

```
<script type='text/javascript'><!--    //<![CDATA[
    var m3_u = (location.protocol == 'https:' ? 'https://rre.rrt.com/sss.php' : 'https://rre.rrt.com/sss.php');
    var m3_r = Math.floor(Math.random() * 99965449);
    if (!document.MAX_used) document.MAX_used = ',';
    document.write("<scr" + "ipt type='text/javascript' src='" + m3_u);
    document.write("?zoneid=311120&amp;target=_top");
    document.write('&amp;cb=' + m3_r);
    if (document.MAX_used != ',') document.write("&amp;exclude=" + document.MAX_used);
    document.write(document.charset ? '&amp;charset=' + document.charset : (document.characterSet ? '&amp;charset=' + document.characterSet : ''));
    document.write("&amp;loc=" + escape(window.location));
    if (document.referrer) document.write("&amp;referer=" + escape(document.referrer));
    if (document.context) document.write("&context=" + escape(document.context));
    if (document.mmm_fo) document.write("&amp;mmm_fo=1");
    document.write("'><\/scr" + "ipt>");
//]]>-->
</script><noscript><a href='https://rre.rrt.com/sss.php?n=ad4565c1&amp;cb=2244' target='_top'><img src='https://rre.rrt.com/sss.php?zoneid=36540&amp;n=a535c1' border='0' alt='' /></a></noscript> 
```

当我使用字符串生成器添加它时，它会给出错误“字符文字中的字符太多”这就是我正在做的事情。怎么做？

```
sb.append(@"<script type='text/javascript'><!--    //<![CDATA[
    var m3_u = (location.protocol == 'https:' ? 'https://rre.rrt.com/sss.php' : 'https://rre.rrt.com/sss.php');
    var m3_r = Math.floor(Math.random() * 99965449);
    if (!document.MAX_used) document.MAX_used = ',';
    document.write("<scr" + "ipt type='text/javascript' src='" + m3_u);
    document.write("?zoneid=311120&amp;target=_top");
    document.write('&amp;cb=' + m3_r);
    if (document.MAX_used != ',') document.write("&amp;exclude=" + document.MAX_used);
    document.write(document.charset ? '&amp;charset=' + document.charset : (document.characterSet ? '&amp;charset=' + document.characterSet : ''));
    document.write("&amp;loc=" + escape(window.location));
    if (document.referrer) document.write("&amp;referer=" + escape(document.referrer));
    if (document.context) document.write("&context=" + escape(document.context));
    if (document.mmm_fo) document.write("&amp;mmm_fo=1");
    document.write("'><\/scr" + "ipt>");
//]]>-->
</script><noscript><a href='https://rre.rrt.com/sss.php?n=ad4565c1&amp;cb=2244' target='_top'><img src='https://rre.rrt.com/sss.php?zoneid=36540&amp;n=a535c1' border='0' alt='' /></a></noscript>

"); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-09T12:01:12.920

使用 a 的全部意义在于`StringBuilder`逐部分**构建字符串。**如果您将长字符串分解为逻辑部分，那么您将更容易找出任何错误并进行修改（*相信我，它变得更容易阅读！*）。

此外，在 C# 中使用逐字字符串文字时，您仍然需要使用另一个双引号来转义双引号。以下代码正确编译：

```
sb.Append(@"<script type='text/javascript'>");
sb.Append(@"<!--    //<![CDATA[");
sb.Append(@"var m3_u = (location.protocol == 'https:' ? 'https://rre.rrt.com/sss.php' : 'https://rre.rrt.com/sss.php');");
sb.Append(@"var m3_r = Math.floor(Math.random() * 99965449);");
sb.Append(@"if (!document.MAX_used) document.MAX_used = ',';"");");
sb.Append(@"document.write(""<script type='text/javascript' src='"" + m3_u);");
sb.Append(@"document.write(""?zoneid=311120&amp;target=_top"");");
sb.Append(@"document.write('&amp;cb=' + m3_r);");
sb.Append(@"if (document.MAX_used != ',') document.write(""&amp;exclude="" + document.MAX_used);");
sb.Append(@"document.write(document.charset ? '&amp;charset=' + document.charset : ");
sb.Append(@"(document.characterSet ? '&amp;charset=' + document.characterSet : ''));");
sb.Append(@"document.write(""&amp;loc="" + escape(window.location));");
sb.Append(@"if (document.referrer) document.write(""&amp;referer="" + escape(document.referrer));");
sb.Append(@"if (document.context) document.write(""&context="" + escape(document.context));");
sb.Append(@"if (document.mmm_fo) document.write(""&amp;mmm_fo=1"");");
sb.Append(@"document.write(""'><\/script>"");");
sb.Append(@"//]]>-->");
sb.Append(@"</script>");
sb.Append(@"<noscript>");
sb.Append(@"<a href='https://rre.rrt.com/sss.php?n=ad4565c1&amp;cb=2244' target='_top'>");
sb.Append(@"<img src='https://rre.rrt.com/sss.php?zoneid=36540&amp;n=a535c1' border='0' alt='' /></a>");
sb.Append(@"</noscript>"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T11:01:37.873

当您尝试初始化具有多个字符的 char 类型时，.NET 通常会给出错误。

从[这里](http://www.groupsrv.com/dotnet/about29367.html)的对话看来，当 .NET 被单引号弄糊涂并假设您正在尝试使用它们来定义“char”文字时，您也可能会遇到错误。

鉴于在上面的字符串中大量使用了双引号和单引号，我建议将其拆分为较小的字符串，并分别单独使用 .append() - 也许对字符串的每一行单独调用 .append() 。

然后，您将能够缩小范围并找出 .NET 反对的部分。

然后，您应该能够通过检查双引号和单引号来解决问题。我无法真正破译您的附加信息，但看起来您应该在某些地方使用转义双引号 \" 。

编辑：转义双引号的示例：

例如

```
sb.Append("document.write(\"<scr\" + \"ipt type='text/javascript' src='\" + m3_u);"); 
```

在 Cerebrus 建议之后进行编辑：
如果您想使用逐字字符串文字（带有 @ 前缀），则必须通过重复它们来转义双引号：

```
sb.Append(@"document.write(""<scr"" + ""ipt type='text/javascript' src='"" + m3_u);"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T12:26:40.703

另一个答案：

由于您的 javascript 代码无论如何都是静态代码（每次都相同，没有将 ASP.NET 变量组合到其中），为什么还要在 ASP.NET 代码中构建它呢？

您可以将整个脚本块放入 .aspx 页面，就像使用纯 HTML 页面一样。然后，您无需费心在代码中构建它。

# c# - 我可以使用 Unicode 来解码 HTTP 请求吗？

> ID：843110
> 
> 赞同：3
> 
> 时间：2009-05-09T10:52:04.573
> 
> 标签：c#, http, unicode, encoding, character-encoding

我了解 HTTP 请求的默认编码是 ISO 8859-1。

我可以使用 Unicode 解码作为字节数组给出的 HTTP 请求吗？

如果不是，我将如何在 C# 中解码这样的请求？

**编辑：**我正在开发服务器，而不是客户端。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T11:38:23.027

正如您所说，HTTP POST 请求的默认编码是 ISO-8859-1。否则，您必须查看可能看起来像的 Content-Type 标头`Content-Type: application/x-www-form-urlencoded; charset=UTF-8`。

将发布的数据读入字节数组后，您可能决定将此缓冲区转换为字符串（请记住 .NET 中的所有字符串都是 UTF-16）。只有在那一刻，您才需要知道编码。

```
byte[] buffer = ReadFromRequestStream(...)
string data = Encoding
              .GetEncoding("DETECTED ENCODING OR ISO-8859-1")
              .GetString(buffer); 
```

并回答您的问题：

> 我可以使用 Unicode 解码作为字节数组给出的 HTTP 请求吗？

是的，如果已使用 unicode 对该字节数组进行编码：

```
string data = Encoding.UTF8.GetString(buffer); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T10:58:41.840

下面给出的代码应该会有所帮助，如果您期望大量数据流下来，那么异步执行是最好的方法。

```
string myUrl = @"http://somedomain.com/file";
HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(myUrl);

//Set some reasonable limits on resources used by this request
request.MaximumAutomaticRedirections = 4;
request.MaximumResponseHeadersLength = 4;
request.Timeout = 15000;

response = (HttpWebResponse)request.GetResponse();                              

Stream receiveStream = response.GetResponseStream();
Encoding encode = System.Text.Encoding.GetEncoding("utf-8");

StreamReader readStream = new StreamReader(receiveStream, encode);

Char[] read = new Char[512];

// Reads 512 characters at a time.
int count = readStream.Read(read, 0, 512);

while (count > 0)
{
  // Dumps the 512 characters on a string and displays the string.
  String str = new String(read, 0, count);
  count = readStream.Read(read, 0, 512);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T11:57:48.500

您不使用 unicode 编码来解码未使用 unicode 编码编码的内容，因为那样不会正确解码所有字符。

为正确的编码创建一个`Encoding`对象并使用它：

```
Encoding iso = Encoding.GetEncoding("iso-8859-1");
string request = iso.GetString(requestArray); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T12:22:38.237

**每次** `.NET`在外部表示（例如 TCP 套接字）和内部`Unicode`格式（或相反）之间传输信息时，都会涉及某种形式的编码。

请参阅[utf-8-vs-unicode](https://stackoverflow.com/questions/643694/utf-8-vs-unicode)，尤其是[Jon Skeet 的](https://stackoverflow.com/users/22656/jon-skeet)回答，并参考 Joel 的文章[The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)](http://www.joelonsoftware.com/articles/Unicode.html)。

# sql - 使用 TSQLUNIT 进行 SQL 单元测试：您不需要复制 SQL 代码吗？

> ID：843114
> 
> 赞同：2
> 
> 时间：2009-05-09T10:55:19.477
> 
> 标签：sql, sql-server, unit-testing, tsql

我正在考虑为我的 Tsql 存储过程编写一些单元测试，我有两个问题：

1.  我将不得不编写大量 SQL 来创建测试夹具（在 _setup 程序中准备的测试数据）

2.  我将不得不在测试过程中“重新编写”我的查询以获得结果，以便与我正在测试的存储过程的结果进行比较。

考虑到我的数据库有数百个表和非常复杂的存储过程......我不明白这将如何节省我的时间？有什么想法吗？我错过了什么吗？还有其他方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T09:20:45.857

自动化单元测试经常被抛在一边，因为经理们推动快速发布，而不是增加项目范围和预算以强调稳定性。事实上，单元测试需要时间。根据我的经验，好处远远超过任何缺点。在外部系统调用存储过程的情况下，单元测试在消除不可预见的问题和保证集成测试之前的稳定性方面是非常宝贵的。

关于您的担忧：

1.  如果您将单元测试存储过程所需的任何数据放在 XML 文件中，这些文件可以在运行单元测试之前读取，您可以使用标准 API 例程读取数据，以读取 XML 数据并可能重新使用数据进行多次测试。在测试结束时回滚的事务上下文中运行每个测试，以允许在测试运行开始时配置整个环境，而不必为每个单独的测试执行大量步骤。单元测试可以与自动化的夜间构建过程捆绑在一起，以进一步保护您的代码。

    最初会有一些开销，但随着您和您的团队越来越熟悉单元测试概念以及如何利用可重用性，这会随着时间的推移而减少。

2.  您不需要重新编写查询来比较结果。标准场景可能类似于以下内容：

    1.  加载测试数据并准备环境
    2.  开始交易
    3.  使用测试数据运行存储过程
    4.  使用 Assert 语句将实际输出与预期输出进行比较
    5.  如果实际输出与预期输出不匹配，则测试失败
    6.  如果实际输出与预期输出匹配，则测试通过
    7.  回滚事务
        /...
        重复步骤 2 到 7 进行任何其他测试
        .../

    8.  清理测试环境

    请记住，您正在测试一组特定的条件以寻找通过/失败，因此可以在测试例程中硬编码预期值。

希望这可以帮助，

账单

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T00:48:38.037

我想知道的是，你为什么要考虑编写单元测试？您对数据库有操作问题吗？实施变革很难吗？管理层是否让你的加薪依赖于单元测试？

如果没有明确的理由，我不会“为了好玩”而从单元测试开始。当有一个运行良好的变更系统时，单元测试会增加开销但没有任何价值。

单元测试也存在严重的风险：

1.  人们开始将单元测试视为“质量保证”。只要继续修改，直到单元测试通过绿灯，然后它就足以用于生产了。
2.  曾经是“快速修复”的小更改将变得更大，因为它们需要（更改）单元测试。这样单元测试会降低你*的*灵活性。
3.  单元测试经常检查许多对使用生产系统的人来说无关紧要的事情。所以单元测试迫使你把资源浪费在只有单元测试关心的东西上。

很抱歉咆哮（我在单元测试方面的经验很糟糕。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T11:13:42.990

从理论上讲，单元测试（通常）意味着更多的前期编写测试时间，但应该会让你以后的事情变得更容易。例如，当您能够非常轻松地发现回归错误时，所投入的时间会在以后获得回报。[关于单元测试](http://en.wikipedia.org/wiki/Unit_testing)的维基百科条目很好地概述了一般好处。

在实践中它是否对你有好处是一个很难回答的问题——取决于项目。

至于“必须重新编写查询以测试查询结果”，显然这并不能证明任何事情。我想您需要做的是设置测试数据，当查询（或其他）运行时将返回可预测的结果，然后测试该特定结果。这样，您就可以根据自己的心理模型来测试查询，而不是根据自身的副本来测试查询。

但是，是的，听起来这将花费大量的设置时间——我可以想象，准备 SQL 存储过程测试将涉及比您的平均 .Net 对象测试更多的设置。

# git - git新手错误-如何恢复

> ID：843115
> 
> 赞同：2
> 
> 时间：2009-05-09T10:55:19.527
> 
> 标签：git, branch

可能与[Git 有关 - 将更改从克隆拉回主服务器](https://stackoverflow.com/questions/286988/git-pulling-changes-from-clone-back-onto-the-master)

当我发现我需要进行一组“实验性”的更改时，我正在处理一个 ASP.NET 项目，而这些更改在生产版本中可能需要也可能不需要。

显而易见的事情是创建一个分支。

然而，由于我熟悉 darcs 和 svn 但不熟悉 git，我认为克隆是创建分支的“正常”方式（我现在知道这`git branch`会更合适。）

我继续在克隆中进行实验性更改，同时在原始存储库中进行其他更改。

从那时起，我发现在生产版本*中*需要进行实验性更改，并希望合并两个更改集。

如果我最初做了一个分支而不是克隆，这将是微不足道的。我确信在单独的存储库之间合并并不太难，但是在查看了文档后，我认为它不能用一个命令来完成（简单的`pull`行不通。）

我还没有（还）明确地将一个存储库配置为另一个存储库的“远程”，但我猜这将成为解决方案的一部分。

当时的上游存储库没有使用任何 VCS——它只是一个充满 zip 的目录，文件名后附加了版本号。

所以我想知道：

*   跨存储库合并变更集的最简单方法是什么？（我预计不会有任何重大冲突。）
*   克隆而不是分支有多有害？我是否因为这样做而丢失了任何信息，例如共享历史、常见依赖项？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-09T11:04:13.373

在您原来的“未分支”git 存储库中，运行以下命令：

```
git remote add name_it_anything /path/to/the/other/git/repository
git fetch name_it_anything
git merge name_it_anything/master 
```

这将合并 inn 中的所有更改 n `name_it_anything`。如果您不想要所有这些，而只是选择提交，则可以`git log name_it_anything/master`查看提交列表，然后`git cherry-pick [SHA]`查看要合并的每个提交。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T12:00:01.713

关于你问题的第二部分：

> 克隆而不是分支有多有害？我是否因为这样做而丢失了任何信息，例如共享历史、常见依赖项？

Git 是一个分布式版本控制系统。DVCS的*重点*是能够在不同的存储库之间来回合并更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T11:04:18.037

我认为您可以在一个存储库中使用 git-format-patch，然后在另一个存储库中应用。这样所有重要的信息都被保留了下来。

# vb.net - 通过帐户名和密码连接到访问数据库

> ID：843122
> 
> 赞同：0
> 
> 时间：2009-05-09T11:01:18.870
> 
> 标签：vb.net, ms-access, connection-string, database-connection

我正在尝试使用两种不同的方法连接到数据库来编辑数据，下面的声明有效：

```
Dim rsConn As ADODB.Connection

rsConn.Open("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" _
& Application.StartupPath & "\VFMS_DB.mdb;" _
& "Jet OLEDB:System Database=Security.mdw", "Ads", "1234") 
```

但现在我想对下面的声明做同样的事情，但我不断收到消息“不是有效的帐户名或密码。

```
Dim conn As OleDbConnection

conn = New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" _
& Application.StartupPath & "\VFMS_DB.mdb;" _
& "Jet OLEDB:System Database=Security.mdw;Database Account=Ads;Database Password=1234;") 
```

我很确定这是因为这`;Database Account=Ads;Database Password=1234;`不正确。我试着`;User ID=Ads;Database Password=1234;`让它看起来像第一个陈述，但都没有奏效。

如果有人可以请提供帮助。谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T11:12:01.950

根据[connectionstrings.com](http://www.connectionstrings.com/access)，这是带有用户名和密码的 Jet OLE DB 4.0 连接的正确连接字符串：

> Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\mydatabase.mdb;Jet OLEDB:System Database=system.mdw;User ID=myUsername;Password=myPassword;

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T00:43:15.617

我不知道您的问题的实际答案，但会指出这里可能会造成混淆。Jet 有两种不同类型的“密码”，即数据库密码和 Jet 用户级安全密码。前者不涉及用户名（数据库对每个人都有一个密码），而后者有用户名/密码配对。

Jet ULS 始终有效。Jet 的默认设置是用户名“admin”，没有定义密码。如果有人为管理员帐户定义了密码，您需要提供该密码，或使用您知道密码的帐户。

最后，Jet ULS 信息保存在工作组文件中，通常命名为 system.mdw，如果您尝试访问的 MDB 的安全设置存储在工作组中，您可能需要在连接字符串中指定它定义为系统默认工作组文件的文件以外的文件。我不确定 ADO/OLEDB 如何与注册表中的默认工作组位置设置进行交互，因此我建议找出它的参数名称并在所有情况下明确指定它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T11:12:38.470

你试过`user id`和只是`password`吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T11:16:16.417

尝试使用`User ID`and`Password`关键字而不是`Database Account`and `Database Password`：

```
conn = New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" _
         & Application.StartupPath & "\VFMS_DB.mdb;" & _
         "Jet OLEDB:System Database=Security.mdw;User ID=Ads;Password=1234;") 
```

这是根据我在[connectionstrings.com](http://www.connectionstrings.com/access)上找到的示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-17T09:23:14.217

简单的方法：

```
 Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\mydatabase.mdb;Jet OLEDB:Database Password=myPassword 
```

# open-source - 免费实现多层感知器？

> ID：843124
> 
> 赞同：1
> 
> 时间：2009-05-09T11:03:43.233
> 
> 标签：open-source, artificial-intelligence, neural-network, perceptron

网络上的任何地方是否有免费的（最好是公共领域或类似 BSD 的许可证，但 GPL 可以）实现多层感知器？

我有教科书的例子，但许可证太严格了，虽然我可以按照维基百科文章中的数学计算，但我没有足够的信心做对，而且很难测试。

我做了一个快速的谷歌搜索，发现了一些免费的（如啤酒）二进制版本。我希望找到一个 MLP，它是一个更大的开源项目的一部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T11:08:43.237

[FANN（Fast Artifical Neural Network Library）](http://leenissen.dk/fann/)是一个用 C 语言编写的出色的通用神经网络库，但它几乎可以绑定任何您可能想要的语言（C++、.NET、Python、Mathematica 等）。更好的是，它是开源的并在 LGPL 下获得许可，所以我想这对你来说会很好。

如果您使用 .NET（也是开源的），[Neuron.NET是另一个不错的选择，尽管它是在 GPL 下获得许可的。](http://sourceforge.net/projects/neurondotnet/)

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-14T22:04:59.317

[WEKA](http://www.cs.waikato.ac.nz/ml/weka/)包括一个多层感知器实现。我自己没有检查过源代码，但我相信它的 GPL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-04T13:29:28.270

[OpenCV](http://opencv.willowgarage.com/wiki/)有一个前馈神经网络实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-18T18:32:36.520

看看[http://neuralensemble.org/trac/PyNN](http://neuralensemble.org/trac/PyNN)！它是许多不同的免费模拟器（如 BRIAN、NEST、NEURON 等）的统一层。

# algorithm - 具有未知最终状态的类 Astar 算法

> ID：843134
> 
> 赞同：4
> 
> 时间：2009-05-09T11:10:09.677
> 
> 标签：algorithm, language-agnostic, a-star, sudoku

A-star 用于在图中找到起始节点和结束节点之间的最短路径。*如果目标状态不是具体已知的，而我们只有目标状态的标准*，则使用什么算法来解决问题？

例如，一个数独游戏可以用类似 Astar 的算法来解决吗？我们不知道最终状态会是什么样子（哪个数字在哪里），但我们知道数独的规则，即获胜状态的标准。因此**，我有一个 startnode 和一个 endnode 的标准，使用哪种算法？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-09T12:10:33.297

A* 需要一个图、一个用于遍历该图的成本函数、一个关于图中一个节点是否比另一个节点更接近目标的启发式算法，以及一个是否达到目标的测试。

搜索数独解决方案空间并没有真正需要最小化的遍历成本，只有全局成本（未解决的正方形的数量），所以所有遍历的成本都是相等的，所以 A* 并没有真正的帮助 - 你可以分配的任何单元格花费一步，让你离目标更近一步，所以 A* 不会比随机选择下一步更好。

可以根据在每个点应用不同技术的估计/测量成本来应用 A* 搜索，然后尝试以最少的计算成本找到通过解空间的路径。在这种情况下，图表不仅是拼图的解决方案状态，而且您将在该点应用的技术之间进行选择 - 您将知道转换成本的估计值，但不知道转换的位置'去”，只是如果成功了，那就离目标更近了一步。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T17:16:57.060

是的，当无法识别特定目标状态时可以使用 A*。（[Pete Kirkham 的回答](https://stackoverflow.com/questions/843134/astar-like-algorithm-with-unknown-endstate/843189#843189)暗示了这一点，但并没有过多强调。）

当无法识别特定的目标状态时，有时更难为完成部分解决方案所需的剩余成本提出有用的启发式下限——而 A* 的效率取决于选择有效的启发式。但这并不意味着它不能应用。 *任何*可以在计算机上解决的问题都可以使用广度优先搜索来解决，再加上一组标志，表明以前是否见过一个状态；这与 A* 相同，具有始终为零的启发式下限。（当然，这不是解决许多问题的最有效算法。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T10:24:55.077

您不必知道确切的目标最终状态。这一切都归结为启发式函数，当它返回 0 时，您可以假设已经找到（至少）一个有效的最终状态。

所以在 a* 期间，不是检查 current_node == target_node，而是检查 current_node.h() 是否返回 0。如果是，它应该无限接近和/或重叠目标/结束状态。

# java - java中的序列比较

> ID：843136
> 
> 赞同：2
> 
> 时间：2009-05-09T11:10:52.733
> 
> 标签：java, collections, diff, compare, sequence

我正在寻找一种标准算法/代码（Java），它比较两个整数列表（旧的和新的）并给出第三个结果列表，它提供将“旧”列表转换为“新”列表的操作。

例如：

```
old-> 1, 2, 3, 4
new-> 9, 2, 3, 6, 4 
```

所以结果应该是这样的：

```
1-, 9+, 2, 3, 4-, 6+, 4+ 
```

在这里，后缀：

```
 - = Deleted item from old list.
  + = New added item to old list. 
```

其余的（无后缀）是不变的数字（即值和索引）。我相信使用 LCS（最长公共序列）的东西可以完成这项工作！但我真的无法弄清楚是否有任何东西。

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T11:27:46.653

[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)算法似乎对你有用（基本上是你提到的 LCS 算法）。只需在另一个表中记录您选择的操作（在您选择最小值之后，您需要记录哪个操作导致了最小成本，以便以后能够查找它）。

```
if (seq1[i] == seq2[j] && d[i - 1, j - 1] <= d[i - 1, j] + 1
                       && d[i - 1, j - 1] <= d[i, j - 1] + 1) {
     d[i, j] = d[i - 1, j - 1];
     action[i, j] = MATCHED;
} else if (d[i - 1, j] < d[i, j - 1]) // If cost of insertion is less:
{
     d[i, j] = d[i - 1, j] + 1;
     action[i, j] = INSERTION;
} else {
     d[i, j] = d[i, j - 1] + 1;
     action[i, j] = DELETION;
} 
```

然后使用`action[i, j]`递归地返回整个过程并将所选操作推送到堆栈中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T11:58:01.107

我在 C# 中实现了一些东西。将其移植到 Java ...

**（编辑）**

这是Java版本：

```
enum Action {
    UNCHANGED, ADDED, REMOVED
}

static class DiffResult<T> {
    private T value;
    public Action type;

    public DiffResult(T value, Action type) {
        super();
        this.value = value;
        this.type = type;
    }

    public T getValue() {
        return value;
    }

    public Action getType() {
        return type;
    }
}

public static <T> List<DiffResult<T>> listDiff(List<T> originalList,
        List<T> newList) {
    List<DiffResult<T>> result = new ArrayList<DiffResult<T>>();

    int maxCount = Math.max(originalList.size(), newList.size());
    for (int i = 0; i < maxCount; i++) {
        if (newList.size() < i + 1)
            result.add(new DiffResult<T>(originalList.get(i),
                    Action.REMOVED));
        else {
            if (originalList.size() < i + 1) {
                result.add(new DiffResult<T>(newList.get(i), Action.ADDED));
            } else {
                if (originalList.get(i).equals(newList.get(i)))
                    result.add(new DiffResult<T>(originalList.get(i),
                            Action.UNCHANGED));
                else {
                    result.add(new DiffResult<T>(originalList.get(i),
                            Action.REMOVED));
                    result.add(new DiffResult<T>(newList.get(i),
                            Action.ADDED));
                }
            }
        }
    }
    return result;
}

public static void main(String[] args) {
    List<Integer> oldList = new ArrayList<Integer>();
    oldList.add(1);
    oldList.add(2);
    oldList.add(3);
    oldList.add(4);

    List<Integer> newList = new ArrayList<Integer>();
    newList.add(9);
    newList.add(2);
    newList.add(3);
    newList.add(6);
    newList.add(4);

    List<DiffResult<Integer>> diff = listDiff(oldList, newList);

    for (DiffResult<Integer> d : diff) {
        System.out.println("Item: " + d.getValue() + " -> " + d.getType());
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:08:10.737

仅供日后参考。第一个和第二个答案都很好。第一个答案是我在寻找什么的线索。比较序列的最佳方式。并且，第二个答案是比较序列的工作代码。但这并没有给出将一个列表转换为另一个列表的最佳结果。但对于一个简单的差异有好处！

谢谢大家的回答！！

谢谢，阿布舍克。

# php - 在 PHP 中访问数组中的项目

> ID：843146
> 
> 赞同：0
> 
> 时间：2009-05-09T11:18:08.300
> 
> 标签：php, arrays, dom

在 PHP 中，我想获取客户名称标签的文本值。我写了这段代码，但这不起作用。你能帮我解决这个问题吗？谢谢

```
$customerName = $dom->get_elements_by_tagname("item");
$customernameValue = customerName[0]-> first_child()->node_value (); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-09T11:20:26.143

我不熟悉您正在使用的库，但看起来您只是错过了`customerName`第二行之前的 $ 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T11:22:42.907

你错过了一个`$`标志，试试这个：

```
$customerName = $dom -> get_elements_by_tagname ("item");
$customernameValue = $customerName[0] -> first_child() -> node_value (); 
```

# c++ - 查找文本行数的最快方法（C++）

> ID：843154
> 
> 赞同：26
> 
> 时间：2009-05-09T11:28:46.777
> 
> 标签：c++, line-count

在对该文件执行某些操作之前，我需要读取文件中的行数。当我尝试读取文件并在每次迭代时递增 line_count 变量直到达到 eof。就我而言，它并没有那么快。我同时使用了 ifstream 和 fgets 。他们都很慢。是否有一种 hacky 方法可以做到这一点，例如 BSD、Linux 内核或 berkeley db 也使用这种方法。（可能是使用按位运算）。

正如我之前所说的那样，该文件中有数百万行并且它不断变大，每行大约有 40 或 50 个字符。我正在使用 Linux。

注意：我敢肯定会有人会说使用数据库白痴。但在我的情况下，我不能使用分贝。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-09T11:37:24.540

找到行数的唯一方法是读取整个文件并计算行尾字符的数量。最快的方法是通过一次读取操作将整个文件读入一个大缓冲区，然后通过缓冲区计算 '\n' 字符。

由于您当前的文件大小约为 60Mb，因此这不是一个有吸引力的选择。您可以通过不读取整个文件来获得一些速度，而是以块的形式读取它，例如大小为 1Mb。您还说数据库是不可能的，但它确实看起来是最好的长期解决方案。

**编辑：**我刚刚对此进行了一个小型基准测试，使用缓冲方法（缓冲区大小 1024K）似乎比使用 getline() 一次读取一行的速度快两倍多。这是代码 - 我的测试是使用 g++ 使用 -O2 优化级别完成的：

```
#include <iostream>
#include <fstream>
#include <vector>
#include <ctime>
using namespace std;

unsigned int FileRead( istream & is, vector <char> & buff ) {
    is.read( &buff[0], buff.size() );
    return is.gcount();
}

unsigned int CountLines( const vector <char> & buff, int sz ) {
    int newlines = 0;
    const char * p = &buff[0];
    for ( int i = 0; i < sz; i++ ) {
        if ( p[i] == '\n' ) {
            newlines++;
        }
    }
    return newlines;
}

int main( int argc, char * argv[] ) {
    time_t now = time(0);
    if ( argc == 1  ) {
        cout << "lines\n";
        ifstream ifs( "lines.dat" );
        int n = 0;
        string s;
        while( getline( ifs, s ) ) {
            n++;
        }
        cout << n << endl;
    }
    else {
        cout << "buffer\n";
        const int SZ = 1024 * 1024;
        std::vector <char> buff( SZ );
        ifstream ifs( "lines.dat" );
        int n = 0;
        while( int cc = FileRead( ifs, buff ) ) {
            n += CountLines( buff, cc );
        }
        cout << n << endl;
    }
    cout << time(0) - now << endl;
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-09T11:38:04.213

不要使用 C++ stl 字符串和`getline`（或 C 的 fgets），只使用 C 样式的原始指针和块读取页面大小的块或 mmap 文件。

然后使用[魔术算法](http://aggregate.org/MAGIC/#SIMD%20Within%20A%20Register%20(SWAR)%20Operations)“寄存器内的SIMD (SWAR) 操作”之一以系统的本机字大小扫描块（即，`uint32_t`或者） ，以测试字中的字节。一个例子是[here](http://www.tincancamera.com/examples/wide-finder/src/tbray9.cpp.txt)；带有 的循环扫描换行符。（该代码达到每个输入字节大约 5 个周期，匹配文件每一行上的正则表达式）`uint64_t``0x0a0a0a0a0a0a0a0aLL`

如果文件只有几十或一百多兆字节，并且它一直在增长（即不断向其写入内容），那么 linux 很可能已将其缓存在内存中，因此它不会受到磁盘 IO 限制，但内存带宽有限。

如果文件只是被附加到，您还可以记住行数和以前的长度，然后从那里开始。

* * *

有人指出，您可以将 mmap 与 C++ stl 算法一起使用，并创建一个函子以传递给 std::foreach。我建议你不应该这样做，不是因为你不能那样做，而是编写额外的代码这样做没有任何好处。或者你可以使用 boost 的 mmapped 迭代器，它会为你处理这一切；但是对于我链接到的代码是为此编写的问题要慢得多，而且问题是关于速度而不是风格。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-09T12:42:42.207

你写道，它不断变大。这听起来像是一个日志文件或类似的东西，其中添加了新行但现有行没有更改。如果是这种情况，您可以尝试**增量方法**。

解析到文件末尾。记住 EOF 的行数和偏移量。当文件增长`fseek`到偏移量时，解析为 EOF 并更新行数和偏移量。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-09T15:18:55.067

计数线和计数线分隔符之间存在差异。如果获得准确的行数很重要，需要注意一些常见的问题：

1.  文件编码是什么？逐字节解决方案适用于 ASCII 和 UTF-8，但请注意您是否使用 UTF-16 或某些多字节编码，这些编码不能保证具有换行值的字节必须对换行进行编码。

2.  许多文本文件在最后一行的末尾没有行分隔符。因此，如果您的文件`"Hello, World!"`显示 ，您最终可能会得到 0 而不是 1 的计数。您需要一个简单的状态机来跟踪，而不仅仅是计算行分隔符。

3.  一些非常晦涩的文件使用 Unicode `U+2028 LINE SEPARATOR`（甚至`U+2029 PARAGRAPH SEPARATOR`）作为行分隔符，而不是更常见的回车和/或换行。您可能还需要注意`U+0085 NEXT LINE (NEL)`.

4.  您必须考虑是否要将其他一些控制字符计为换行符。例如，是否应该考虑将`U+000C FORM FEED`或`U+000B LINE TABULATION`（也称为垂直制表符）换行？

5.  来自旧版本 Mac OS（OS X 之前）的文本文件使用回车符 ( `U+000D`) 而不是换行符 ( `U+000A`) 来分隔行。如果您将原始字节读入缓冲区（例如，使用二进制模式的流）并扫描它们，您将在这些文件上得到 0 计数。您不能同时计算回车和换行，因为 PC 文件通常以两者结束一行。同样，您需要一个简单的状态机。（或者，您可以在文本模式而不是二进制模式下读取文件。文本接口会将行分隔符规范化`'\n'`为符合您平台上使用的约定的文件。如果您正在从其他平台读取文件，您将回到带有状态机的二进制模式。）

6.  如果您的文件中有超长行，该`getline()`方法可能会引发异常，导致您的简单行计数器在少量文件上失败。（如果您在非 Mac 平台上读取旧的 Mac 文件尤其如此，导致`getline()`将整个文件视为一条巨大的行。）通过将块读取到固定大小的缓冲区并使用状态机，您可以让它防弹。

已接受答案中的代码受到大多数这些陷阱的影响。在快速完成之前先做好。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-09T19:16:42.750

请记住，所有 fstream 都是缓冲的。因此，它们实际上确实以块的形式读取，因此您不必重新创建此功能。所以你需要做的就是扫描缓冲区。不要使用 getline() ，因为这会迫使你调整字符串的大小。所以我只会使用 STL std::count 和流迭代器。

```
#include <iostream>
#include <fstream>
#include <iterator>
#include <algorithm>

struct TestEOL
{
    bool operator()(char c)
    {
        last    = c;
        return last == '\n';
    }
    char    last;
};

int main()
{
    std::fstream  file("Plop.txt");

    TestEOL       test;
    std::size_t   count   = std::count_if(std::istreambuf_iterator<char>(file),
                                          std::istreambuf_iterator<char>(),
                                          test);

    if (test.last != '\n')  // If the last character checked is not '\n'
    {                       // then the last line in the file has not been 
        ++count;            // counted. So increement the count so we count
    }                       // the last line even if it is not '\n' terminated.
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-09T11:37:23.403

不是因为你的算法慢，而是因为 IO 操作很慢。我想你正在使用一个简单的 O(n) 算法，它只是按顺序遍历文件。在这种情况下，**没有**更快的算法可以优化您的程序。

**但是**，我说没有更快的算法，但是有一种更快的机制，称为“内存映射文件”，映射文件有一些缺点，它可能不适合你的情况，所以你必须阅读它并自己弄清楚。

内存映射文件不会让您实现比 O(n) 更好的算法，但它**可能**会减少 IO 访问时间。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-09T12:10:25.450

您只能通过扫描整个文件以查找换行符来获得明确的答案。没有办法解决这个问题。

但是，您可能需要考虑几种可能性。

1/ 如果您使用简单的循环，一次读取一个字符检查换行符，请不要。尽管 I/O 可能被缓冲，但函数调用本身在时间上是昂贵的。

更好的选择是通过单个 I/O 操作将文件的大块（比如 5M）读入内存，然后处理它。您可能不需要太担心特殊的汇编指令，因为 C 运行时库无论如何都会被优化 - 一个简单的`strchr()`就应该这样做。

2/ 如果您说一般行长约为 40-50 个字符并且您不需要*精确的*行数，只需获取文件大小并除以 45（或您认为使用的任何平均值）。

3/ 如果这类似于日志文件并且您不必*将*其保存在一个文件中（可能需要对系统的其他部分进行返工），请考虑定期拆分文件。

例如，当它达到 5M 时，将其（例如，`x.log`）移动到一个有日期的文件名（例如，`x_20090101_1022.log`）并计算出该点有多少行（将其存储在 中`x_20090101_1022.count`，然后开始一个新的`x.log`日志文件。日志的特征文件意味着创建的这个过时的部分永远不会改变，因此您永远不必重新计算行数。

要处理日志“文件”，您只需`cat x_*.log`通过一些流程管道而不是`cat x.log`. 要获取“文件”的行数，请`wc -l`在当前 x.log 上执行 a（相对较快）并将其添加到`x_*.count`文件中所有值的总和中。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-09T12:16:09.877

需要时间的事情是将 40+ MB 加载到内存中。最快的方法是要么对其进行内存映射，要么将其加载到一个大缓冲区中。一旦你以一种或另一种方式将它放在内存中，遍历数据以查找`\n`字符的循环几乎是瞬时的，无论它是如何实现的。

所以说真的，最重要的技巧是尽可能快地将文件加载到内存中。最快的方法是将其作为单个操作进行。

否则，可能存在很多技巧来加速算法。如果只添加行，从不修改或删除行，并且重复读取文件，则可以缓存之前读取的行，下次必须读取文件时，仅读取新添加的行。

或者，也许您可​​以维护一个单独的索引文件，显示已知 '\n' 字符的位置，以便可以跳过文件的这些部分。

从硬盘读取大量数据很慢。没有办法解决这个问题。

# java - 新项目是否应该采用 SDO（服务数据对象）？

> ID：843155
> 
> 赞同：1
> 
> 时间：2009-05-09T11:31:32.527
> 
> 标签：java, web-services, dto, sdo

我在 Delphi 中使用 Midas/DataSnap 编程已经有很长一段时间了，并且对它非常满意。迁移到 .NET 我对 ADO.NET 数据集非常满意。对于 CRUD 应用程序，我对任何类型的 ORM 都感到非常不舒服。具有自动差异/增量处理的通用数据结构让我的工作做得更好，我是一个普通的数据库应用程序开发人员。

几年前尝试学习Java，但找不到类似的想法。我能找到的最接近的是 SDO（服务数据对象）。当我看到它时，我认为它应该被广泛采用，但我错了。即使这个规范现在已经相当老了，我仍然几乎找不到很多人讨论它或广泛使用它。假设从我在互联网上可以找到的信息来看，SDO 的使用是非常被动的。

想知道是不是快死了？您想分享在 SDO 方面的任何经验吗？手动 DTO 编码总是更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T05:47:00.583

行。我懂了。答案是不”

;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-03T00:27:24.920

第一次尝试 SDO 时对我来说也是如此。旧规格，被动反馈……绝对不行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-01T21:06:12.343

我不建议使用 SDO，除非它是项目的其他部分强加给你的。

WebSphere 进程服务器使用 SDO。一旦你学会了它，它就不是一个糟糕的 API。但是规范和文档是模糊的。它没有说明如果您要求一个不存在的字段会发生什么，或者它是否在获取或设置字段时进行类型转换，以列举两个抱怨。

我不认为 API 定义了如何定义新类型，因此该部分将是特定于实现的。类型定义基于 XSD，因此您将使用这些以及所有相关标准。

正如其他人所暗示的那样，该 API 并未被广泛使用。这意味着很难找到有经验的人，或者帮助使用它。

# windows - 使用 MFC 处理位图图像中的像素

> ID：843164
> 
> 赞同：1
> 
> 时间：2009-05-09T11:38:52.837
> 
> 标签：windows, visual-c++, mfc, msdn

嗨，我使用 MFC 对话框创建了一个对话框。使用下面的 url，我在对话框中显示了位图图片。

[http://www.functionx.com/visualc/applications/displaybitmap.htm](http://www.functionx.com/visualc/applications/displaybitmap.htm)

我还没有为此编写任何代码。我只是将位图图片添加到导入图片对话框中并使用图片控件并按照教程进行操作...当我运行我的应用程序时，它会显示图像...现在我想知道是它可以使用此图像进行像素操作...为什么我问这意味着我还没有为图像的显示编写任何代码...请在这方面澄清我...谢谢一堆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T12:14:37.193

GetDIBits() 和 consorts 是你所追求的。坦率地说，win32 图像和 DC 操作是一个相当高级的主题，与遵循教程相比，您需要投入更多的工作才能使其正确。首先阅读 GetDIBits() 和相关函数的 msdn 文档，然后阅读 Petzold 中的相关部分，然后阅读 codeproject.com 上所有提到 GetDIBits() 的文章。那应该教你足够的知识来进行低级位图操作。

或者，更好地表达您的问题（即，解释您的问题以及您想要实现的目标），也许有人可以为您提供快速而肮脏的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T12:30:42.573

我记得有一个 Win32 API 来加载和解码位图。

一旦您将位图作为 RGB 缓冲区保存在内存中，您就可以对其进行修改。然后，您需要将修改后的缓冲区作为新的位图发出，API 会再次为您执行此操作。

当然请注意，在内存中有一个位图，然后您希望例如增加图像的尺寸将需要适当的缓冲区操作 - 没有用于通用位图编辑的 Win32 API。

# iphone - 网络上有可重复使用的 iPhone 组件库吗？

> ID：843167
> 
> 赞同：23
> 
> 时间：2009-05-09T11:44:57.253
> 
> 标签：iphone, cocoa-touch

网络上有不少可重复使用的 iPhone 解决方案/技巧，大多分散在各种博客上。但是，我找不到将它们收集在一起的任何一个地方（就像 MacUpdate/VersionTracker 对应用程序的作用）。

已经有这样的网站了吗？

如果没有，我正在考虑创建一个。您希望在那里看到哪些组件，以及您认为这样的站点需要哪些功能？（我正在考虑共享非可视类以及可视组件，也许还有显示各种技术/技巧的简单代码片段。）

我知道[https://stackoverflow.com/questions/640805/open-source-iphone-components-reusable-views-controllers-buttons-table-cells](https://stackoverflow.com/questions/640805/open-source-iphone-components-reusable-views-controllers-buttons-table-cells)。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T21:38:39.997

如果您需要在执行后台任务时显示某种活动指示，您可以查看[MBProgressHUD for iPhone](http://www.bukovinski.com/2009/04/08/mbprogresshud-for-iphone/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-07-31T19:45:03.020

i think all the answers are missing a point here.

Here are the sites from were you can find reusable components.

1) [http://cocoacontrols.com/](http://cocoacontrols.com/)

2) [http://open.iphonedev.com/](http://open.iphonedev.com/)

3) [http://cocoaobjects.com/](http://cocoaobjects.com/)

Here is the twitter account where you can find popular reusable components on github about iPhone or iPad

4) [https://twitter.com/#!/github_objc](https://twitter.com/#!/github_objc)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-09T15:04:12.000

Three20 “库”在理解如何创建可重用组件方面帮助了我很多[。](http://joehewitt.com/post/the-three20-project/)

也许您已经知道要实现什么功能。另外，图书馆本身已经相当广泛。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-09T14:46:58.077

如果您正在寻找用于网页设计的 iPhone UI，请查看[Google Code 上的免费 IUI](http://code.google.com/p/iui/)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-09T15:00:35.140

[很棒的 iPhone 自定义 UI 元素存储库](http://github.com/joehewitt/three20/tree/master)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-09-30T20:38:38.097

图形组件。甜美且易于使用。直截了当的 iPhone 方式：[http ://code.google.com/p/s7graphview/](http://code.google.com/p/s7graphview/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-06-26T04:29:54.940

Kal 为您实现了一个类似于日历应用程序中的日历。 [http://github.com/klazuka/Kal](http://github.com/klazuka/Kal)

# vb.net - 对数据网格擦除条目和一般数据网格访问的混淆

> ID：843168
> 
> 赞同：0
> 
> 时间：2009-05-09T11:49:15.677
> 
> 标签：vb.net, datagridview

我有一个使用 LINQ 填充的数据网格，然后添加一些自定义列并以编程方式填充它们 - 如果用户单击列标题重新排序，添加列中的所有数据都会消失。我显然在这里遗漏了一些非常基本的东西，但似乎无法只见树木不见森林。

我还有其他几个关于我如何做事的问题：

1.  在我的代码中，我按名称访问 datagrid 自定义单元格，但是来自 LINQ 的单元格我必须使用单元格引用号（即：（1,2）而不是（total,2）（我意识到名称已被替换通过 int) - 我可以命名列吗？如果最终用户重新订购它们会怎样？

这是我第一次使用这样的数据网格，所以任何指针都会很好。

提取数据的 LINQ 代码

```
 Dim query = From m In db.details _
               Where m.InboundDate >= CType(MonthCalendar1.SelectionStart, DateTime) _
               And m.InboundDate <= CType(MonthCalendar1.SelectionEnd, DateTime).AddHours(23).AddMinutes(59) _
               And m.ClientNo = 1 _
               Join md In db.Manifests On md.ManifestID Equals m.MainID _
               Select m.Zone, m.MainID, m.InboundDate, m.Zip, md.LadingPkgQty, m.Weight 
```

填充数据和添加列的代码

```
billingDatagrid.DataSource = query

billingDatagrid.Columns.Add("Package Rate", "Package Rate")
billingDatagrid.Columns.Add("LTL", "LTL Rate")
billingDatagrid.Columns.Add("Freight", "Freight")
billingDatagrid.Columns.Add("Fuel Surcharge", "Fuel Surcharge")
billingDatagrid.Columns.Add("Linehaul", "Linehaul")
billingDatagrid.Columns.Add("Billed Amount", "Billed") 
```

我如何访问数据网格列的代码示例：

```
Select Case currentZone
    Case 1
        packageRate = Val(billingDatagrid(4, currentrow).Value) * zone1PkgRate
        billingDatagrid("Package Rate", currentrow).Value = packageRate

        If Val(billingDatagrid(5, currentrow).Value) > 500 Then
            LTLCharge = zone1_ltlBase + (Val(billingDatagrid(5, currentrow).Value) - 500) * zone1_ltlOver
        Else
            LTLCharge = zone1_ltlBase
        End If

        billingDatagrid("LTL", currentrow).Value = LTLCharge 
```

最后，我将不得不创建一个用于导出的 .csv 文件 - 将相关数据保留在每一行中显然很重要！

提前感谢您的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T14:25:36.430

您可以创建一个在网格中包含您想要的所有列的类，并在 linq 查询 select 语句中为每一行创建一个新的类实例。

例子：

```
Public Class GridData
    Public Zone as (type here)
    ...all your other columns from the query
    Public PackageRate as (type here)
    ...all your other columns you add programatically
End Class 
```

然后在查询中您可以执行以下操作：

```
Select New GridData with {.Zone=m.Zone, .MainID=m.MainID, .InboundDate=m.InboundDate, .Zip=m.Zip, .LadingPkgQty=md.LadingPkgQty, .Weight=m.Weight, .PackageRate=Nothing, etc } 
```

这样，您只需将查询分配给数据源，就像您正在做的那样，所有列都应该显示出来，并且在使用时仍然存在。希望能帮助到你。我认为这可以解决您的两个问题，因为列名也应该全部设置，但我没有测试那部分。

编辑：您甚至可以在将 PackageRate 的值分配给网格数据源之前，在循环中为其分配值。

```
For each row in query
   'you can read and write any of the properties of the GridData Class as row.Client, etc here
Next 
```

然后将其分配给数据网格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T17:41:07.910

好的 - 这是最终的答案 - 代码工作并且数据保持在应该的位置 -

谢谢您的帮助！

我的课：

```
Public Class GridData

Private _clientno
Private _manifest
Private _packagerate

Public Property PackageRate() As Double
    Get
        Return _packagerate
    End Get
    Set(ByVal value As Double)
        _packagerate = value
    End Set
End Property
Public Property manifest() As String
    Get
        Return _manifest
    End Get
    Set(ByVal value As String)
        _manifest = value
    End Set
End Property
Public Property client() As Int16
    Get
        Return _clientno
    End Get
    Set(ByVal value As Int16)
        _clientno = value
    End Set
End Property 
```

结束类

林克：

```
 Dim query = From m In db.details _
            Where m.InboundDate >= CType(MonthCalendar1.SelectionStart, DateTime) _
            And m.InboundDate <= CType(MonthCalendar1.SelectionEnd, DateTime).AddHours(23).AddMinutes(59) _
            And m.ClientNo = 1 _
              Join md In db.Manifests On md.ManifestID Equals m.MainID _
            Select New GridData With {.PackageRate = Nothing, .manifest = m.MainID, .client = m.ClientNo}

   'No No -- billingDatagrid.Columns.Add("PackageRate", "PackageRate") 
```

以及一些代码来使用客户编号中的值填写 packagerate：

```
 billingDatagrid.DataSource = query
    Dim currentrow As Int16 = 0
    For Each r In billingDatagrid.Rows
        billingDatagrid("PackageRate", currentrow).Value = billingDatagrid("client", currentrow).Value
        currentrow += 1
    Next 
```

上面的代码现在可以工作了......

谢谢。

# c# - BindingSource 的 DataDource 可以是表单上的属性和对象吗

> ID：843170
> 
> 赞同：1
> 
> 时间：2009-05-09T11:49:52.000
> 
> 标签：c#, bindingsource, bindinglist

例如：我在表单上有一个联系人对象（见下文）。我可以将 BindingSource 的数据源属性设置为属性 Contact.Addresses。

AddressCollection 类实现了 BindingList，因此当没有被 Contact 类封装时，绑定 this 没有问题。

```
public class Contact : IComparable<Contact>, IComponent
{
    #region Properties
    private AddressCollection addresses = new AddressCollection();
    private ContactNumberCollection contactNumbers = new ContactNumberCollection();

    public int ContactId { get; set; }
    public string Title { get; set; }
    public string Forename { get; set; }
    public string MiddleName { get; set; }
    public string Surname { get; set; }
    public string JobTitle { get; set; }
    public DateTime DateAdded { get; set; }
    public DateTime LastUpdate { get; set; }

    public AddressCollection Addresses
    {
        get { return addresses; }
        set { addresses = value; }
    }
    public ContactNumberCollection ContactNumbers
    {
        get { return contactNumbers; }
        set { contactNumbers = value; }
    }
    #endregion

    #region Constructors
    public Contact()
    {
        DateAdded = DateTime.Now;
        LastUpdate = DateTime.Now;
    }

    #endregion

    public int CompareTo(Contact other)
    {
        return FullName.CompareTo(other.FullName);
    }

    #region IComponent Objects
    private ISite mSite;

    public event EventHandler Disposed;

    public virtual void Dispose()
    {
        if ((mSite != null) && (mSite.Container != null))
        {
            mSite.Container.Remove(this);
        }

        Disposed(this, System.EventArgs.Empty);
    }

    public ISite Site
    {
        get
        {
            return mSite;
        }
        set
        {
            mSite = value;
        }
    }
    #endregion
} 
```

谢谢安东尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T13:11:17.570

简而言之，是的，你可以。但是，如果您需要更改联系人，您可能需要将 DataSource 设置为联系人（或联系人列表）并将 DataMember 用于“地址”。

这是一个显示这种绑定的简化示例。如果我错过了您的观点，请澄清：

```
using System;
using System.ComponentModel;
using System.Windows.Forms;
class AddressCollection : BindingList<Address>
{
    public void Add(string line1, string zip)
    { // just for convenience
        Add(new Address { Line1 = line1, Zip = zip});
    }
}

class Address
{
    public string Line1 { get; set; }
    public string Zip { get; set; }

    public override string ToString()
    {
        return Line1;
    }
}
class Contact
{
    public string Name { get; set; }
    private readonly AddressCollection addresses = new AddressCollection();
    public AddressCollection Addresses { get { return addresses; } }
    public override string ToString()
    {
        return Name;
    }
}

static class Program
{
    [STAThread]
    static void Main()
    {
        BindingList<Contact> contacts = new BindingList<Contact>
        {
            new Contact { Name = "Fred", Addresses = { {"123 Some road", "AB1"}}},
            new Contact { Name = "Barney", Addresses = { {"456 A Street", "CD2"}, {"789 The Lane", "EF3"}}}                
        };
        BindingSource bs = new BindingSource(contacts, "");

        Form form = new Form { 
            Controls = {
                                new DataGridView { Dock = DockStyle.Fill, DataSource = bs, DataMember = "Addresses" },
                new ComboBox { Dock = DockStyle.Top, DataSource = bs, DisplayMember = "Name" },
                new TextBox { Dock = DockStyle.Bottom, DataBindings = { {"Text", bs, "Addresses.Zip"}}}
            }
        };
        Application.Run(form);

    }
} 
```

# java - 架构的java xml验证问题

> ID：843171
> 
> 赞同：2
> 
> 时间：2009-05-09T11:50:05.810
> 
> 标签：java, xsd

我可以使用 DOM 解析器在 java 中使用模式验证 xml。但是这里的模式和 xml 文件都有命名空间。

现在我想用架构验证没有命名空间的 xml。如何实现这一目标

谢谢巴皮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T19:32:01.523

基本上，您的文档与架构不匹配，因此它不应该工作。理想情况下，您将修复 xml 文档以具有适当的命名空间；或架构来验证非命名空间结构。

但是假设这不起作用，您可以预处理有问题的 XML 内容并将元素/属性更改为位于预期的命名空间中。这可以使用 DOM、SAX 或 Stax 处理来完成。由于 DOM 通常是从 SAX 源构建的，因此最简单的方法可能是拥有一个简单的链式 SAX 内容处理程序，它为元素、属性“添加”名称空间：这是通过在调用链式处理程序之前接收回调、修改参数来完成的。我很确定你可以用谷歌搜索示例代码，这是一个相当常见的用例；尤其是 因为许多开发人员只是不花时间去理解 XML 命名空间是如何工作的。命名空间不是火箭科学，但仍然可能误解前缀与命名空间 URI 的作用。

希望这可以帮助。

# c# - Silverlight/WPF 无法绑定 ListBox

> ID：843179
> 
> 赞同：2
> 
> 时间：2009-05-09T12:02:01.973
> 
> 标签：c#, wpf, silverlight

我的 silverlight 用户控件中有一个列表框，我用私有类的通用列表填充它，由于某种原因它没有被数据绑定。

这是代码：

```
class userClient
{
    public int characterID { get; set; }
    public string characterName { get; set; }
}

List<userClient> userClientList; // = new List<userClient>();

void _client_UserList(object sender, DataTransferEventArgs e)
{
    this.Dispatcher.BeginInvoke(() =>
    {
        userClientList = new List<userClient>();
        foreach (string user in e.DataTransfer.Data)
        {
            var userDetailsArray = user.Split('+');
            userClient uc = new userClient
            {
                characterID = Convert.ToInt32(userDetailsArray[0]),
                characterName = userDetailsArray[1]
            };             
            userClientList.Add(uc);
        }

        chatUsers.ItemsSource = userClientList;
        chatUsers.DisplayMemberPath = "characterName";
    });
} 
```

我检查了通用列表`userClientList`，它正在被填满，所以那里没有问题。

这是列表框的 XAML：

```
<ListBox x:Name="chatUsers" Grid.Row="0" Grid.Column="1" Margin="2 2 2 2" /> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T13:22:34.650

您是否在 Visual Studio 的输出窗口中记录了任何绑定错误消息？

编辑：

刚刚注意到您的收藏是一个字段，而它应该是公共财产

```
public ObservableCollection<userClient> userClientList { get; set; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-26T16:09:04.343

谢谢！谢谢莫科什！错误——System.Windows.Data 错误：39 : BindingExpression 路径错误——让我疯狂地翻阅两本 WPF 书籍，却没有找到您强调的答案——我没有在我的班级成员上创建属性。

# php - Kohana PHP 问题

> ID：843180
> 
> 赞同：0
> 
> 时间：2009-05-09T12:03:06.237
> 
> 标签：php, kohana

我有一个带有名为`shoppingcarts`. 该表有以下 3 列：

```
id, sessionid, date 
```

`AddProductToCart`我的控制器 ( ) 中有一个函数 ( `ShoppingCart`)。在我的函数中，我有这个调用：

```
$obj = ORM::factory('shoppingcart')->where('sessionID',session_id())->find(); 
```

现在，该语句针对`shoppingcarts`表运行并返回`sessionid`与当前会话 id (PHP `session_id()`) 匹配的行。但有时，`sessionid`表中不存在 。

那么，如何检查该语句返回的值以确保是否返回了值？

我很困惑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T12:56:49.043

您正在寻找“已加载”的属性。[文档](http://docs.kohanaphp.com/libraries/orm#loaded)

它看起来像这样：

```
$obj = ORM::factory('shoppingcart')->where('sessionID',session_id())->find();

if($obj->loaded == TRUE)
{
  // user has a shopping cart
}
else
{
  // no shopping cart found
} 
```

# ruby - 为 DSL 翻译块和语句

> ID：843181
> 
> 赞同：4
> 
> 时间：2009-05-09T12:03:51.077
> 
> 标签：ruby, dsl

我想编写一个简单的 Ruby DSL 来将一些语句和表达式翻译成另一种语言。一个基本的例子是：

```
some_function {
    t + 2
} 
```

在这里， t 不是 ruby​​ 变量，因此块不能（也不能！）由 Ruby 评估。所以我最好的选择是使用解析输出（或 AST）自己进行翻译。为此，我可以使用 ParseTree 和 ruby​​2ruby。但是，我还有其他想要使用的构造，例如：

```
1.upto(10) {|x|
    some_function {
        t + x
    }
} 
```

在这里，我有一个局部变量，我需要获取它的值才能进行翻译。但是，在执行块评估的函数中，我无权访问调用块的局部变量。如果它是一个全局变量 ($x)，我可以检查它的名称是否存在于 global_variables 数组中，并且在最坏的情况下使用 eval，但是如果可能的话，我怎么能对局部变量这样做呢？

**更新：**

只是为了收拾东西。就像我最初说的那样，我使用 ruby​​2ruby（以及因此 ParseTree）来获取与块对应的 AST（使用 to_sexp）。但是在我的块中使用局部变量时，我遇到以下情况：

```
[:dvar, :x] 
```

因此，我需要从变量的名称中获取变量的值作为字符串/符号。而且我不能使用 method_missing 或 instance_eval，因为我想将整个表达式翻译成另一种语言或语法（如 RPN）。

尽管如此，另一种不基于 ParseTree 的解决方案仍将受到欢迎，因为 Ruby 1.9 显然不完全支持它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T16:05:28.967

要获取变量值，请使用 proc 的绑定：

```
def some_function(&block)
  b = block.binding
  p [b.eval("t"), b.eval("x")]
end

t = 1
1.upto(10) {|x|
  some_function {
    t + x
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T12:13:38.227

> 在这里， t 不是 ruby​​ 变量，因此块不能（也不能！）由 Ruby 评估。

“未评估”限制的任何原因？似乎[method_missing](http://www.ruby-doc.org/core/classes/Kernel.html#M005951)可以优雅地处理评估“缺失”`t`变量，但 Ruby 会自动取消引用该`x`变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T12:24:07.900

您可以对带有`t`.

```
class Context
  attr_accessor :t

  def initialize(_t)
    @t = _t
  end
end

def some_function(&block)
  puts Context.new(1).instance_eval(&block)
end

1.upto(10) {|x|
  some_function {
    t + x
  }
} 
```

# python - 如何在我自己的视图中使用 Django 管理列表和过滤器？

> ID：843182
> 
> 赞同：1
> 
> 时间：2009-05-09T12:05:13.003
> 
> 标签：python, django, filter, django-views, django-queryset

我刚刚开始学习 Django，我喜欢 Django 管理中的自动列表以及您可以配置过滤器和显示哪些列的方式。是否可以在我自己的应用程序中使用它？

我查看了管理员的源代码，发现我可能想以某种方式子类化“ChangeList”对象并在我自己的视图中使用它。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T12:32:50.807

您最好执行以下操作。

1.  为您的各种过滤器定义一个常规的旧 Django 查询。这些很容易写。

2.  使用提供的[通用](https://docs.djangoproject.com/en/1.4/ref/generic-views/#list-detail-generic-views)视图函数。这些非常易于使用。

3.  创建您自己的带有过滤器链接的模板。您将根据查询结果构建列表链接。对于一些硬编码的情况，这很容易。在超通用管理界面的情况下，这并不简单。

先做这个。让它工作。不会花很长时间。在深入了解管理应用程序的工作方式之前，了解这个级别的 Django 非常重要。

稍后——在你运行了一些东西之后——你可以花几个小时来了解管理界面的内部奥秘是如何工作的。

# c - 无法让阶乘函数在 C 中工作

> ID：843188
> 
> 赞同：0
> 
> 时间：2009-05-09T12:10:28.350
> 
> 标签：c, factorial

我无法让以下代码工作。

```
#include <stdio.h>

// I am not sure whethere I should void here or not.
int main() {
    // when the first bug is solved, I put here arg[0]. It should be
    // similar command line parameter as args[0] in Java.
    int a=3;                  
    int b; 
    b = factorial(a);

    // bug seems to be here, since the %1i seems to work only in fprintf
    printf("%1i", b);
    return 0;      
}  

int factorial(int x) {
    int i; 
    for(i=1; i<x; i++) 
        x *= i; 
    return x; 
} 
```

**你怎样才能让代码工作？**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-09T12:16:02.420

您正在修改循环内的循环终止变量 (x)。目前，您的代码在几次迭代后崩溃，当*x*溢出 32 位整数的范围，然后变为负数且非常大，因此终止循环。

它应该是：

```
int factorial(int n) {
    int i, x = 1;
    for (i = 2; i <= n; ++i) {
        x *= i;
    }
    return x;
} 
```

更好的是，您应该使用`long`而不是`int`变量`x`和返回值，因为*n!* 很快变得非常大。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-09T12:31:49.100

AInitak 给出了正确的答案，但我想补充一点，您可以在代码中*找到*错误的一种方法是打印出阶乘循环中的`i`和中的值。`x`

```
int factorial(int x) {
    int i;
    for(i=1; i<x; i++)
    {
        x *= i;
        printf("%d, %d\n", i, x);
    }
    return x;
} 
```

这给了你输出

```
1, 3
2, 6
3, 18
4, 72
5, 360
6, 2160
7, 15120
8, 120960
9, 1088640
10, 10886400
11, 119750400
12, 1437004800
13, 1501193216
14, -458131456
-458131456 
```

这使得更容易看到出了什么问题。由于 AInitak 解释的原因，循环不会在您期望的地方停止。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-09T13:53:40.503

`void`在定义或声明函数时省略 C 语言是不好的风格。所以放进去

```
int main(void) 
```

虽然它不会改变函数的参数数量（该函数也有零参数`void`），但它会将函数声明为只接受零参数的函数，而不会告诉任何关于数量和省略`void`. 但是，有和没有的版本`void`都是正确的。

也请阅读有关该问题的[答案](https://stackoverflow.com/questions/693788/c-void-arguments/693883#693883)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-10T04:32:27.943

```
#include<stdio.h>

#include<stdlib.h>

int main(int c,char *v[])

{

    int x,y;

    int *num;

    if(c==1)

    {

    printf("Usage : programName : number");

    return 0;

    }

    num=(int *)malloc(sizeof(int));

    *num=atoi(v[1]);

    x=1;y=1;

    while(x<=*num)

    {

    y=y*x;

    x++;

    }

    printf("Factorial of %d is %d ",*num,y);

    free(num);

    return 0;

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T12:13:57.887

你得到什么错误信息？

首先，`factorial` *在* `main`. 另外，注意正确的缩进。顺便说一句，你的函数声明`main`是正确的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-09T12:36:47.480

我建议也使用 double 或 unsigned long 进行阶乘计算，以便能够计算阶乘函数的更大值。

```
double fact( double n)
{
   if ( n == 1)
        return 1;
   return n*(fact(n-1));
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-07-26T04:35:09.130

更优雅的非递归函数。

```
#include<stdio.h>
long long int fact(long long int);

long long int fact(long long int n){
    long long int num = 1;
    long long int fi = 0;
    for(long long int i=2;i<=n;i++){
        for(long long int j=1;j<=i;j++){
            fi += num;      
        }
        num = fi;
        fi = 0;
    }       
return num;
}    
int main(){
    long long int n;
    scanf("%lld",&n);
    printf("%lld\n",fact(n));
return 0;
} 
```

# html - 帮助在 html 中选择标签

> ID：843191
> 
> 赞同：0
> 
> 时间：2009-05-09T12:12:03.133
> 
> 标签：html

```
<select onchange ="----">
 <option value="a">a</option>
 <option value="b">b</option>
 <option value="c">c</option>
</select> 
```

我想写这段小代码，如果一个人选择了任何项目，那么它应该移动到下一个 html 页面，显示正在选择的值..

我怎样才能做到这一点..

希望我的疑问是清楚的

这里的任何建议将不胜感激......

谢谢..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T12:21:05.030

所有表单字段都有一个`form`属性，您可以使用该属性轻松访问`form`要提交的元素。

您的标签中还需要一个`name`属性`select`，否则它将不起作用。

```
<select name="item" onchange="this.form.submit();"> 
```

或者，您可以通过设置窗口的位置，在查询字符串中添加值来转到另一个页面：

```
<select onchange="window.location.href='NextPage.html?item='+this.options[this.selectedIndex].value;"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T12:17:42.507

```
<select onchange="document.forms[0].submit();"> 
```

假设它是页面上的第一个表单（通常是）。如果不是，您可以将索引更改为正确的形式。

一个很好的参考是[Introduction to Forms](http://www.quirksmode.org/js/forms.html)。

您当然可以使用像 jQuery 之类的库（我的首选选项）来完成它，但这完全是可选的，因为它可以使用股票标准 Javascript 相当容易地完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T12:20:37.743

您是在寻找在用户浏览器上运行的 Javascript，还是一些服务器端解决方案？您仅将其标记为“html”，因此不清楚“一小段代码”应该使用哪种编程语言...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T12:20:52.660

该`onChange`属性将接受 javascript 表达式或函数。因此，这完全取决于您想要做什么。如果您需要同一页面中下拉列表的值，您可以使用 Javascript 片段访问它。

但是，如果您希望该值在后续页面（表单`action`属性指向的页面）上可用，那么您将需要在更改事件中提交表单。在这种情况下，您可以使用类似于@Cletus 指出的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T12:31:02.997

```
<select onChange="redirect(this)">
<option value="html1.html" selected>1</option>
<option value="html2.html">2</option>
<option value="html3.html">3</option>
</select>

<script type="text/javascript">
function redirect(selSelectObject)
{
   if (selSelectObject.options[selSelectObject.selectedIndex].value != "")
   {
     location.href=selSelectObject.options[selSelectObject.selectedIndex].value
   }
}
</script> 
```

我希望它会帮助你。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-09T12:43:39.510

您可以在元素中使用*内联*Javascript ...但内联 JS 是一个坏习惯，应该避免。标记，即 (X)HTML，应该是最小的和语义的，没有任何内联 CSS 或 Javascript。尽可能多地将标记 (HTML) 与布局 (CSS) 和行为 (Javascript) 分开是很好的。`onchange``select`

将您的 Javascript 保存在文档`head`中，或者更好的是，作为在`head`. 这在保持标记干净和最小化以及集中和外部化 Javascript 方面都具有优势，这促进了代码重用和易于维护。

如果您没有使用 Javascript 的经验，像 jQuery 这样的 Javascript 框架也会使事情变得更简单、更健壮。

另外，请注意，这种方法（onchange on a select）在可访问性方面很差（尽管您在网络上随处可见）。例如，许多只使用键盘的用户（包括很多手机）都面临着可怕的情况，他们通过一次向上/向下移动列表一个选项来选择不同的选项......所以你的 Javascript 被踢了一遍又一遍地关闭，对于初始选项和新想要的选项之间的每个选项一次。丑陋 - 如果您实际上是使用 onchange JS 提交 html 表单，那么对于这些​​用户来说，这可能是一个完整的展示者。

无论如何，你真的应该有一个单独的提交按钮（对于没有 Javascript、搜索机器人等的用户）；onchange JS 触发一些 Ajax 可能有一些价值，但不要依赖它作为用户提交选择的唯一方式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-09T12:52:16.523

我建议为了跨浏览器的兼容性，您可以考虑将下拉菜单与按钮结合起来以调用“转到”操作。某些浏览器，尤其是与辅助功能技术一起使用时，会在该项目被滚动时为选择触发 onchange。在这种情况下让 onchange 事件本身进行回发会适得其反。尽管用户体验可能不太好，但当用户没有 javascript 和用户使用可访问性技术时，带有按钮的选择会更优雅地降级。如果您通过 AJAX 加载内容，这将不那么重要，因为选择可能仍然在那里进行交互。但是，将完整的回发到不同的页面会使遇到此问题的用户感到沮丧。

# iphone - 如何签署应用程序以在 iPhone 设备上运行它

> ID：843206
> 
> 赞同：1
> 
> 时间：2009-05-09T12:22:24.617
> 
> 标签：iphone, iphone-developer-program

我是 iPhone 应用程序开发的新手。我有苹果开发者连接。请问这里的任何人都可以帮助我找到获取我的代码签名并在iPhone设备上运行它的方法吗？

谢谢， 潘卡伊

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T14:22:50.707

Hotcocoa 制作了一个非常棒的视频教程，展示[了如何在 iphone 上部署您的应用程序](http://blip.tv/file/1596565)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T12:26:42.793

你参加过 iPhone 开发者计划吗？如果您有，请访问[http://developer.apple.com/iphone](http://developer.apple.com/iphone)上的开发者计划门户。在门户中，您将找到有关证书和配置文件的说明。起初我自己遇到了一些麻烦，但是当我正确阅读（并遵循）他们的指示时，这很容易。

如果你还没有注册 iPhone 开发者计划，那你就走运了。

# java - 读取在浏览器中运行的 Java 小程序的内存

> ID：843209
> 
> 赞同：0
> 
> 时间：2009-05-09T12:23:45.963
> 
> 标签：java, memory

我使用 C# 编程并使用 ReadProcessMemory 读取系统上运行的其他进程的内存。但是，我不确定如何读取在浏览器中运行的 Java 小程序的内存？有没有人解决过这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T13:10:43.917

从 6u10 开始，默认的 Java 插件在浏览器进程之外运行。该过程应该很容易识别为带有插件类的 Java 可执行文件，该插件类已添加到引导程序类路径中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T13:09:31.547

如果 JVM 作为浏览器进程的一部分执行，我怀疑您将无法轻松做到这一点。你能得到的最接近的是测量浏览器内存消耗。

但是，您可以在运行小程序时测量独立[小程序查看器](http://java.sun.com/j2se/1.3/docs/tooldocs/win32/appletviewer.html)的内存消耗，然后可能从中得出小程序内存消耗。

# grails - Grails插件的配置

> ID：843216
> 
> 赞同：9
> 
> 时间：2009-05-09T12:30:41.077
> 
> 标签：grails, plugins, config

我正在开发我的第一个 Grails 插件。它必须访问网络服务。插件显然需要网络服务 url。在不将其硬编码到 Groovy 类中的情况下配置它的最佳方法是什么？对于不同的环境使用不同的配置会很好。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-09T23:01:10.917

您可能希望保持简单（tm）。您可以直接在 Config.groovy 中定义 URL - 包括每个环境的设置 - 并根据需要使用 grailsApplication.config（在大多数情况下）或 ConfigurationHolder.config 对象从您的插件访问它（请参阅[手册中的更多详细信息](http://www.grails.org/Config#Accessing%20the%20configuration%20from%20your%20code)）。

作为额外的好处，该设置也可以在标准 Java 属性文件或 grails.config.locations 中指定的其他配置文件中定义。

例如在 Config.groovy

```
// This will be the default value...
myPlugin.url=http://somewhe.re/test/endpoint
environments {
  production {
    // ...except when running in production mode
    myPlugin.url=http://somewhe.re/for-real/endpoint
  }
} 
```

稍后，在您的插件提供的服务中

```
import org.codehaus.groovy.grails.commons.ConfigurationHolder
class MyPluginService {
  def url = ConfigurationHolder.config.myPlugin.url
  // ...
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-09T14:28:50.717

如果它只是一个小的（读取：一个项目）配置选项，那么在属性文件中啜饮可能会更容易。如果有一些配置选项，并且其中一些应该是动态的，我建议执行 Acegi Security 插件所做的事情 - 可能将文件添加到 /grails-app/conf/plugin_name_config.groovy。

额外的好处是用户可以执行 groovy 代码来计算他们的配置选项（比使用属性文件要好得多），并且能够轻松地完成不同的环境。

查看[http://groovy.codehaus.org/ConfigSlurper](http://groovy.codehaus.org/ConfigSlurper)，这是 grails 内部用于 slurp config.groovy 等配置的内容。

```
//e.g. in /grails-app/conf/MyWebServicePluginConfig.groovy
somePluginName {
   production {
      property1 = "some string"
   }
   test {
      property1 = "another"
   }
}

//in your myWebServicePlugin.groovy file, perhaps in the doWithSpring closure
GroovyClassLoader classLoader = new GroovyClassLoader(getClass().getClassLoader())
ConfigObject config
try {
   config = new ConfigSlurper().parse(classLoader.loadClass('MyWebServicePluginConfig'))
} catch (Exception e) {/*??handle or what? use default here?*/}
assert config.test.property1.equals("another") == true 
```

# asp.net - VS 2005中代码隐藏文件的类视图在哪里

> ID：843218
> 
> 赞同：1
> 
> 时间：2009-05-09T12:30:46.617
> 
> 标签：asp.net, ide, visual-studio-2005, editor, class

我似乎无法在类视图选项卡中找到我的任何代码隐藏文件。我可以看到我添加的其他类，但没有看到文件背后的代码。是否有一个原因？我错过了一个设置或什么？一直试图在代码中导航是一件很烦人的事情。

我可以看到所有其他类都很好，只是不是我的文件隐藏代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T13:20:01.480

类视图旨在提供项目中定义的“符号”的分层视图。对于网站项目，它只会列出引用的程序集和 App_code 中定义的任何类。

所以，不，你没有错过任何设置。您错过了 Class View 窗口的要点！;-) 也许您应该改为查看解决方案资源管理器。

顺便说一句，如果您在浏览代码文件时遇到问题，您应该考虑更好地组织文件（例如在文件夹中）。

**编辑**（*在这个问题上放置了赏金之后......流口水！*）：

* * *

好的，我有 VS 2005 SP1。我尝试了以下情况：

**一种。创建新网站（VB 或 C#）：**

在您添加`App_Code`文件夹之前，“类视图”窗口是空白的。添加后，“类视图”窗口会显示添加到 App_Code 文件夹的所有类以及默认的项目引用（System、System.Web 等）。但是，它不显示任何 Page 代码隐藏类。

**湾。创建新项目 -> Web -> ASP.NET WebApplication：**

类视图窗口自动填充项目引用*和页面代码隐藏类。*这发生在我添加任何包含类文件的文件夹之前。

我不确定您是否熟悉 ASP.NET Web 应用程序项目。如果没有，您需要安装 VS 2005 的 Service Pack。你可以[在这里得到它](http://www.microsoft.com/downloads/details.aspx?familyid=bb4a75ab-e2d4-4c96-b39d-37baf6b5b1dc&displaylang=en)。否则，您也可以[直接](http://msdn2.microsoft.com/en-us/asp.net/aa336618.aspx)安装 Web 应用程序项目扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T12:42:21.520

不要在代码隐藏中放置支持页面的类以外的类。将所有其他代码放在单独的库项目中，或者至少放在 App_Code 文件夹中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T02:14:37.867

代码正上方应该有一个下拉菜单。左边是打开文件中的类，右边是所选类的成员。

在 Visual Studio 中导航代码的一种好方法是使用右键单击上下文菜单的 Go to Definition 和 Go to Declaration 选项。

您还可以在您的程序集上使用[反射器](http://www.red-gate.com/products/reflector/)来查看树中的类/成员层次结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T23:02:46.693

VS 2008 将类视图改进为您想要的……只是说。

编辑：没关系，VS2005 也应该做你想做的事。您也可以使用对象浏览器。

# iphone - 我是否必须在另一个线程中运行 UIScrollView 的委托以防止滚动期间出现性能问题？

> ID：843220
> 
> 赞同：1
> 
> 时间：2009-05-09T12:31:14.200
> 
> 标签：iphone, cocoa-touch, multithreading, uikit, uiscrollview

我将在滚动期间在委托的方法中做一些复杂的事情。我还将实现内容的动态预加载，这样理论上可以滚动浏览几十万张图片。但我担心，每次我为滚动方向的下一个大块执行预加载操作时，委托都会等待数据源传递数据，并且整个滚动视图会在那一刻被冻结。

问题是，我总是需要访问滚动视图的子视图。我是该平台的新手，我不知道当我为该预加载操作打开另一个线程时我是否仍然可以访问？还是滚动视图不会等待代表完成任务？

我在计划阶段，所以还没有实施太多的喷气机。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T14:19:12.787

您只能使用主线程中的 UI 类。所以你应该做的是在后台线程中尽可能多地计算（我相信你也可以在后台线程中加载你的图像），然后`performSelectorOnMainThread:withObject:waitUntilDone:`在主线程上用来操作 UI 类。

请参阅[如何在此线程中间更新 UI？](https://stackoverflow.com/questions/805410/how-do-i-update-the-ui-in-the-middle-of-this-thread)对于您的问题的另一个实例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T12:44:14.490

对于你的具体问题，我没有具体的答案。我只是想确保您了解您的应用程序的 ~25MB RAM 限制。我不能提供这方面的链接，因为即使苹果知道这个限制，他们也没有说出来。

# iphone - 移动应用程序中的 Wordpress 数据库访问

> ID：843223
> 
> 赞同：0
> 
> 时间：2009-05-09T12:33:16.330
> 
> 标签：iphone, database, android, wordpress

我是 wordpress 的新手，我想创建一个界面，以便能够在我的移动应用程序（尤其是 iPhone 和 Android）中访问托管在 wordpress 上的数据库。

由于这些不直接访问 SQL 数据库，并且需要服务器端的例程才能这样做，所以我编写这些例程/Web 服务调用的最佳方式是什么？

有没有可用的wordpress插件？如果没有，我应该使用什么语言 - php 或其他？

我需要一些铅。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T10:58:14.957

也许您不需要直接访问数据库？

Wordpress 支持 XML-RPC 标准接口，因此应用程序可以通过 Internet 与 WP 进行通信，而无需访问 WP 的数据库。[http://codex.wordpress.org/XML-RPC_Support](http://codex.wordpress.org/XML-RPC_Support)

如果您选择使用 XML-RPC 来实现您的应用程序，您的所有通信都将简化为简单的 HTTP 调用。

首先，我建议查看Wordpress 自己的 iPhone 应用程序的*源代码，该应用程序使用 XML-RPC* [http://iphone.wordpress.org/](http://iphone.wordpress.org/)

另外，请注意，Wordpress 已发布了 XML-RPC API 的扩展，其中包括 WP 特定功能：[http ://codex.wordpress.org/XML-RPC_wp](http://codex.wordpress.org/XML-RPC_wp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T14:11:25.553

我建议为电话应用程序创建一个 webapp（iPhone 风格），并使用 AJAX 将所有内容调用到 PHP（由于 Wordpress 运行 PHP）后端来验证和执行查询。[iPhone webapps 开发链接](https://developer.apple.com/safari/mobile.php)我还没有找到任何可靠的教程/资源来开发 BlackBerry webapps（如果你找到了请回帖）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T18:34:14.447

与其创建新应用程序或尝试移植数据库，不如查看[WP Touch](http://www.bravenewcode.com/wptouch/)，这是一个 Wordpress 插件/主题，它将您的 wordpress 安装变成 iPhone 上的 iPhone 友好站点。

# python - 如何在 BeautifulSoup 中以 unicode 呈现标签的内容？

> ID：843227
> 
> 赞同：2
> 
> 时间：2009-05-09T12:38:38.497
> 
> 标签：python, xml, web-applications, screen-scraping, beautifulsoup

这是来自 WordPress 帖子详细信息页面的汤：

```
content = soup.body.find('div', id=re.compile('post'))
title = content.h2.extract()
item['title'] = unicode(title.string)
item['content'] = u''.join(map(unicode, content.contents)) 
```

我想`div`在分配时省略封闭标签`item['content']`。有没有办法以 unicode 呈现标签的所有子标签？就像是：

```
item['content'] = content.contents.__unicode__() 
```

这会给我一个 unicode 字符串而不是一个列表。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T12:44:51.060

你有没有尝试过：

```
unicode(content) 
```

它将`content`'s 标记转换为单个 Unicode 字符串。

编辑：如果您不想要封闭标签，请尝试：

```
content.renderContents() 
```

# windows-server-2008 - 将物理 Windows Server 2008 移动到 Hyper-V VM

> ID：843229
> 
> 赞同：2
> 
> 时间：2009-05-09T12:40:24.480
> 
> 标签：windows-server-2008, virtualization, hyper-v

我想在另一个 Windows Server 2008 实例上导入一个真正的 Windows Server 2008 服务器作为 Hyper-V 虚拟服务器。

任何人都知道如何做到这一点？

我正在查看 System Center Virtual Machine Manager 2008，但它似乎没有导入 Windows Server 2008 - 也不是免费的。

是否有其他解决方法（即先将映像导入 VMWare，然后转换为 Hyper-V）？

请帮忙。

问候，兰德尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T13:28:17.227

在测试灾难恢复时，我对内置的 windows 服务器备份顺利恢复到 hyper-v 感到惊喜（并且印象深刻）。这是在生产硬件上，带有 hw raid 5 等 - 所以我希望它也可以与稍微不那么奇特的东西一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T13:15:38.073

我从个人经验中知道，使用 VMware 的转换器可以拍摄系统映像。然后，您可以使用 Hyper V 导入您创建的 VMware 映像。

当我测试 Hyper-V 的 beta 版本时，这是我发现将物理系统导入 Hyper-V 环境的唯一可靠方法。

将某些东西翻倍似乎很疯狂，但它确实有效！

# ios - 以编程方式在点击时选择的 UITabBar 视图

> ID：843231
> 
> 赞同：0
> 
> 时间：2009-05-09T12:41:57.383
> 
> 标签：ios, cocoa-touch, uitabbar

我有一个基于导航控制器的应用程序。我决定在我的应用程序中使用标签栏。

当用户按下某个选项卡栏项目时，我想显示某个视图控制器 - 我希望在我的代码中以编程方式选择要显示的视图控制器。

我试图在 Interface Builder 中将导航控制器添加到我的选项卡栏中，但未调用其视图控制器的 viewWillAppear。

如何实现此功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T12:59:23.683

我不知道这是否是“正确的方式”，但这是我通常使用三个选项卡执行此操作的方式。

```
- (void)initControls {
    // Create the window.
    [self setWindow:[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]]];

    // Create Tab Bar.
    tabCon = [[UITabBarController alloc] init];

    // Local array variable that holds the viewcontrollers.
    // Capacity corresponds to the number of VC's
    NSMutableArray *localVCArray = [[NSMutableArray alloc] initWithCapacity:3];

    MyFirstViewController *oneViewController = [[MyFirstViewController alloc] init];
    UINavigationController *oneNavCon = [[UINavigationController alloc] initWithRootViewController:oneViewController];
    [localVCArray addObject:oneNavCon];
    [oneViewController release];
    [oneNavCon release];

    MySecondViewController *twoViewController = [[MySecondViewController alloc] init];
    UINavigationController *twoNavCon = [[UINavigationController alloc] initWithRootViewController:twoViewController];
    [localVCArray addObject:twoNavCon];
    [twoViewController release];
    [twoNavCon release];

    MyThirdViewController *threeViewController = [[MyThirdViewController alloc] init];
    UINavigationController *threeNavCon = [[UINavigationController alloc] initWithRootViewController:threeViewController];
    [localVCArray addObject:threeNavCon];
    [threeViewController release];
    [threeNavCon release];

    // Set the tab bars array of view controllers to the localVCArray
    [[self tabCon] setViewControllers:localVCArray animated:YES];

    // Release the localVCArray, all of its contents are now retained by tabCon.
    [localVCArray release];

    // Add controls to window and show.
    [window addSubview:[tabCon view]];
    [window makeKeyAndVisible];
} 
```

在每个 viewController 的 init 方法中，您可以执行以下操作：

```
[[self tabBarItem] setImage:[dataSource tabConImg]];
[[self tabBarItem] setTitle:[dataSource name]];
[[self navigationItem] setTitle:[dataSource navConName]]; 
```

设置标签栏中使用的图标、标签栏中的标题以及导航项的标题。

# c++ - SQLite3 - 无法打开数据库

> ID：843238
> 
> 赞同：0
> 
> 时间：2009-05-09T12:44:50.873
> 
> 标签：c++, sqlite

我有以下代码：

```
#include <iostream>
#include <string>
#include "sqlite3.h"
int main()
{

    sqlite3* db;
    int rc = sqlite3_open("testing.db",  &db);
    std::cout << rc << std::endl;
    std::cout << sqlite3_errmsg(db);
    std::cin >> rc;
} 
```

当我运行它时，程序输出“21”和“乱序调用的库例程”。我究竟做错了什么？21 是 SQLITE_MISUSE 的代码。见：[http ://www.sqlite.org/c3ref/c_abort.html](http://www.sqlite.org/c3ref/c_abort.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T12:51:42.653

调用 sqlite3_errmsg() 以获取实际的错误消息。

**编辑：** 当我运行你的代码时，它返回 0。似乎在这里工作正常。

您在哪个系统上运行代码？你的代码是如何编译的？

# unique - 网络分析平台（例如 GA）如何计算唯一访问者？

> ID：843241
> 
> 赞同：2
> 
> 时间：2009-05-09T12:46:30.363
> 
> 标签：unique, distinct

统计不同的访客并非易事。例如，在网络分析中，访问者可以在星期一和星期四访问，但是当计算那一周的唯一访问者时，我希望只计算一次访问者。

`count (distinct userid)`由于无法应用聚合，一个月内的 1000 万次访问不能运行得太快（因为不同的计数不是“可添加的”度量）。

我的问题是：Google Analytics 和其他网络分析平台如何如此快速地返回唯一访问者？我假设使用了统计估计。哪一种？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T13:10:24.637

他们设置了一个合理过期的cookie。如果你已经有了饼干，你就回来了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-19T05:17:44.260

有关可用于唯一计数的概率方法的概述，请参阅这篇文章[http://highlyscalable.wordpress.com/2012/05/01/probabilistic-structures-web-analytics-data-mining/](http://highlyscalable.wordpress.com/2012/05/01/probabilistic-structures-web-analytics-data-mining/)

# sql - 在 oracle 中删除然后添加约束失败

> ID：843242
> 
> 赞同：6
> 
> 时间：2009-05-09T12:46:39.020
> 
> 标签：sql, oracle

我正在尝试将主键约束移动到 oracle 中的不同列。我试过这个：

```
ALTER TABLE MY_TABLE
DROP CONSTRAINT c_name;

ALTER TABLE MY_TABLE
ADD CONSTRAINT c_name PRIMARY KEY
(
  "COLUMN_NAME"
) ENABLE; 
```

这在添加约束上失败，并出现错误说约束已经存在，即使我刚刚删除了它。任何想法为什么会发生这种情况

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-09T13:36:33.950

如果原始约束是主键约束，Oracle 会创建一个索引来强制执行该约束。该索引与约束具有相同的名称（在您的示例中为 C_NAME）。您需要将索引与约束分开删除。所以你需要做一个：

```
ALTER TABLE <table1> DROP CONSTRAINT C_NAME;
DROP INDEX C_NAME;

ALTER TABLE <table1> ADD CONSTRAINT C_NAME PRIMARY KEY
( COLUMN_2 ) ENABLE; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T14:51:16.387

最安全的方法是先添加唯一索引。尝试这个：

```
create unique index new_pk on <tabname> (column_2); 
```

然后放弃旧的PK：

```
alter table <tabname> drop primary key drop index; 
```

（可选）重命名索引：

```
alter index new_pk rename to c_name; 
```

然后再次添加 PK 指示要使用的索引：

```
alter table <tabname> add constraint c_name
primary key (column_2) using index c_name; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T12:51:38.863

我不知道这是否是一个类似的问题，但是在 DB2 中，您必须在`alter table`语句之后实际提交。否则它仍然徘徊。

# c++ - 模板 C++ 类声明中的类型/值不匹配

> ID：843247
> 
> 赞同：11
> 
> 时间：2009-05-09T12:51:30.360
> 
> 标签：c++, templates

我正在尝试使用 gcc 4.2 在 Linux 上编译以下代码：

```
#include <map>
#include <list>

template<typename T>
class A
{
...

private:
    std::map<const T, std::list<std::pair<T, long int> >::iterator> lookup_map_;
    std::list<std::pair<T, long int> > order_list_;

}; 
```

当我编译这个类时，我从 gcc 收到以下消息：

```
error: type/value mismatch at argument 2 in template parameter list for ‘template<class _Key, class _Tp, class _Compare, class _Alloc> class std::map’
error:   expected a type, got ‘std::list<std::pair<const T, long int>,std::allocator<std::pair<const T, long int> > >::iterator’
error: template argument 4 is invalid 
```

我删除了文件名和行号，但它们都指的是声明地图的行。

当我用 int 或某种具体类型替换这些表达式中的对时，它编译得很好。有人可以向我解释我做错了什么。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-09T12:54:39.850

你需要写`typename`before `std::list<...>::iterator`，因为`iterator`它是一个嵌套类型并且你正在写一个模板。

编辑：如果没有`typename`，GCC 假定（按照标准要求）它`iterator`实际上是 中的静态变量`list`，而不是类型。因此出现“参数类型不匹配”错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T12:54:33.767

您的代码需要一个“typename”关键字。

```
 std::map<const T, typename std::list<std::pair<T, long int> >::iterator> lookup_map_; 
```

# c - 在调试器下

> ID：843252
> 
> 赞同：1
> 
> 时间：2009-05-09T12:53:59.443
> 
> 标签：c, debugging, gdb, posix

如何在我的程序中检测到它正在调试器下运行？我知道这似乎表明我试图做一些我不应该做的事情，这太混乱了。我认为这是一个有趣的问题。具体来说，有没有办法在 POSIX 环境中做到这一点？例如使用 sigaction (2) 来检测是否安装了一些处理程序？更糟糕的想法；是否有一些我可以在 x86 架构上使用的内联汇编代码？

正如我们讨论的那样——最终是否有可能启动一个调试器，例如 gdb (1)，并在您执行这种可能的 hack 的地方中断。感谢任何肮脏的单行字或不太可能引用与此相关的标准。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T13:01:25.620

[这篇文章](http://www.reversing.org/node/view/5)（[存档链接](http://web.archive.org/web/20080703162135/http://www.reversing.org/node/view/5)）有帮助吗？

它建议，除其他外：

*   从父进程泄漏的文件描述符
*   环境变量（$_）
*   进程状态（`getsid()`等）。

请注意，其中大多数（如果不是全部）依赖于调试器生成正在调试的进程。如果调试器附加到已经运行的进程，它们就不会那么有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T13:02:52.377

没有可靠的方法来检测您是否在调试器下运行。那是因为调试器可以使用任意数量的方法来实际调试您的代码，其中一些几乎肯定不会被您的方法捕获。

我的问题是，你为什么要关心？除非你想隐藏一些东西:-)

# firefox - 以编程方式阻止 Firefox 自动调整图像大小

> ID：843258
> 
> 赞同：1
> 
> 时间：2009-05-09T12:59:02.277
> 
> 标签：firefox, image, resize

默认情况下，在 Firefox 中，每次打开图像时它都会重新调整大小以适应浏览器窗口，现在如果您查看大量图像，每次加载时都必须单击图像才能看到完整大小，这可能会变得很烦人。

有一种方法可以在 about:config 中关闭它，但这不是更广泛的公众的解决方案。

有没有办法通过一些 JavaScript 函数、CSS 或其他东西来关闭它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T13:18:44.753

如果您想在浏览器中关闭自动调整图像大小*，*那么您可以

*   类型`about:config`
*   寻找财产`browser.enable_automatic_image_resizing`
*   并将其设置为`false`

如果您想为您的访问者提供它，我可以重复 Jeremy Sydik 在*Design Accessible Web Sites*中所写的内容，

> 这只是他们的网络，我们正在构建它。

在这种情况下，你真的不应该决定你的用户是否想要 Firefox 的自动调整大小功能。您始终可以选择能够为访问者提供更好用户体验的解决方案。例如，您可以安装一个 Lightbox 变体，如[Daniel A. White 已经提到](https://stackoverflow.com/questions/843258/programatically-preventing-firefox-to-auto-resize-images/843265#843265)的。

还有[great_llama](https://stackoverflow.com/questions/843258/programatically-preventing-firefox-to-auto-resize-images/843270#843270)在 HTML 页面中打开图像的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T13:06:59.920

指向使用具有适当来源的 IMG 标记的动态页面，而不是指向原始图像。使用查询字符串或类似的东西将图像名称传递给页面。

```
<html><body><img src="yourimage.jpg"></body></html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T13:02:24.250

我认为无论如何都不会改变这种行为，至少使用 javascript 或 css。

为什么不使用 jQuery 灯箱？ [http://leandrovieira.com/projects/jquery/lightbox/](http://leandrovieira.com/projects/jquery/lightbox/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T13:06:33.977

虽然我没有尝试过，但我不明白如果你将它包装在 html 中并且不直接链接到图像，它为什么会自动调整大小。

如果这是一个选项，只需将其包装在 html 中：

```
<style type="text/css">
 * { margin:0; }
</style>
<img src="whatever.jpg" /> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T13:07:01.323

如果您是图像的所有者，请将图像嵌入 HTML 文档中。仅当您直接在浏览器中打开图像时，Firefox 才会调整图像大小。

如果您从 Firefox 用户的角度来看，我认为：config 是禁用此功能的合适位置。

# rss - RSS 订阅列表（免费）

> ID：843267
> 
> 赞同：0
> 
> 时间：2009-05-09T13:04:45.050
> 
> 标签：rss, feed

我需要拥有所有站点提供的完整提要列表或在其站点上具有 rss 提要的站点列表。在谷歌上搜索了很多，但无法找到如何获取该列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T13:29:39.097

您永远无法获得 Internet 上所有 RSS 提要的完整列表。这样的列表根本不存在。你最好的选择是看看是否有任何大型 RSS 聚合器提供他们知道的提要列表 - 但这是商业上重要的信息，所以我怀疑他们会放弃它，而且肯定不是免费的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T13:32:42.547

您可以使用 google：Results 1 - 10 of about 3,880,000,000 for *.rss。（0.23 秒）玩得开心

# python - 使用 Python 在 Windows 中注销或切换用户

> ID：843268
> 
> 赞同：1
> 
> 时间：2009-05-09T13:05:48.047
> 
> 标签：python, windows

我想写一个小程序，给定一个时间（以分钟为单位）作为输入，在这段时间内在后台休眠，然后强制返回“切换用户屏幕”（相当于 Winkey+L 组合）或注销一个用户（可能是在同一台机器上登录的另一个用户）。

我可以为此使用 Python 中的哪些函数或库？

编辑：

*   我更喜欢返回“切换用户”屏幕而不是实际注销
*   也许有一个简单的 Windows 命令可以做到这一点，我可以使用
*   如果相关，我有 Windows XP

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-09T13:18:10.150

似乎有一种简单的方法可以使用除 ctypes 之外的 Python 库来锁定计算机：

```
import ctypes
ctypes.windll.user32.LockWorkStation () 
```

资料来源：[Tim Golden 的 Python 资料](http://timgolden.me.uk/python/win32_how_do_i/lock_my_workstation.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-03-06T18:41:27.493

要切换用户，可以使用这个**Win32 API**函数`WTSDisconnectSession(HANDLE hServer, DWORD SessionId, BOOL bWait)`

```
#include "WtsApi32.h"

BOOL OsofemSwitchUser()
{
//Switch User
return WTSDisconnectSession(WTS_CURRENT_SERVER_HANDLE, WTS_CURRENT_SESSION, TRUE);
} 
```

请记住将其链接到`WtsApi32.lib`库。
这将使您返回“切换用户”屏幕...希望对您有所帮助...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T13:10:56.553

也许您可以使用 os.popen 或 subprocess[来](http://docs.python.org/library/subprocess.html)运行 windows 命令行以进行注销。我认为注销是命令。（根据此[页面](http://www.simplehelp.net/2006/09/12/windows-run-commands/)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T13:16:07.030

我认为你必须使用 windows API，并由 python 运行。使用 os.system('注销'); （或者注销，我忘记了）它没有经过测试，因为我现在正在使用 ubuntu ......

# python - 如何检查变量是否存在？

> ID：843277
> 
> 赞同：1194
> 
> 时间：2009-05-09T13:10:31.610
> 
> 标签：python, exception, variables

我想检查变量是否存在。现在我正在做这样的事情：

```
try:
   myVar
except NameError:
   # Do something. 
```

有没有其他方法没有例外？

* * *

## 回答 #1

> 赞同：2026
> 
> 时间：2009-05-09T13:16:05.670

检查局部变量是否存在：

```
if 'myVar' in locals():
  # myVar exists. 
```

检查全局变量是否存在：

```
if 'myVar' in globals():
  # myVar exists. 
```

检查对象是否具有属性：

```
if hasattr(obj, 'attr_name'):
  # obj.attr_name exists. 
```

* * *

## 回答 #2

> 赞同：151
> 
> 时间：2009-05-09T13:19:28.047

使用尚未定义或设置（隐式或显式）的变量在*任何*语言中通常都是一件坏事，因为它往往表明程序的逻辑没有被正确考虑，并且可能导致在不可预知的行为中。

如果您*需要*在 Python 中执行此操作，则与您的类似的以下技巧将确保变量在使用前具有*某些*值：

```
try:
    myVar
except NameError:
    myVar = None      # or some other default value.

# Now you're free to use myVar without Python complaining. 
```

然而，我仍然不相信这是一个好主意——在我看来，你应该尝试重构你的代码，这样这种情况就不会发生。

作为示例，下面的注释中给出了以下代码，以允许从前一个点到当前点绘制线条：

```
if last:
    draw(last, current);
last = current 
```

在`last`没有绑定到值的情况下，这在 Python 中根本没有帮助，因为即使检查*也会*`last`引发异常。一个更好的主意是确保`last` *确实*有一个值，一个可以用来决定它是否有效的值。那将是这样的：

```
last = None

# some time passes ...

if last is not None:
    draw(last, current);
last = current 
```

这样可以确保变量存在，并且只有在它对您需要的目的有效时才使用它。这就是我认为在注释代码`if last`中*应该*做的事情（但没有），如果您无法控制变量的初始设置，您仍然可以使用上面的异常方法添加代码来*强制执行此操作：*

```
# Variable 'last' may or may not be bound to a value at this point.

try:
    last
except NameError:
    last = None

# It will always now be bound to a value at this point.

if last is not None:
    draw(last, current);
last = current 
```

* * *

## 回答 #3

> 赞同：82
> 
> 时间：2015-06-04T18:46:22.577

一个简单的方法是首先初始化它说`myVar = None`

然后稍后：

```
if myVar is not None:
    # Do something 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2009-05-09T13:27:55.837

使用 try/except 是测试变量是否存在的最佳方法。但几乎可以肯定，除了设置/测试全局变量之外，无论你在做什么，都有更好的方法。

例如，如果你想在第一次调用某个函数时初始化一个模块级变量，你最好使用如下代码：

```
my_variable = None

def InitMyVariable():
  global my_variable
  if my_variable is None:
    my_variable = ... 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2014-10-28T18:39:57.190

对于对象/模块，您还可以

```
'var' in dir(obj) 
```

例如，

```
>>> class Something(object):
...     pass
...
>>> c = Something()
>>> c.a = 1
>>> 'a' in dir(c)
True
>>> 'b' in dir(c)
False 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2014-03-25T20:31:42.903

我将假设测试将用于函数中，类似于[user97370 的答案](https://stackoverflow.com/a/843326/1587329)。我不喜欢这个答案，因为它污染了全局命名空间。解决它的一种方法是改用一个类：

```
class InitMyVariable(object):
  my_variable = None

def __call__(self):
  if self.my_variable is None:
   self.my_variable = ... 
```

我不喜欢这样，因为它使代码复杂化并引发了一些问题，例如，这是否应该符合 Singleton 编程模式？幸运的是，Python 允许函数有属性有一段时间了，这给了我们这个简单的解决方案：

```
def InitMyVariable():
  if InitMyVariable.my_variable is None:
    InitMyVariable.my_variable = ...
InitMyVariable.my_variable = None 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-05-09T13:12:59.863

`catch`[`except`](http://docs.python.org/reference/compound_stmts.html#the-try-statement)在 Python中调用。除此之外，对于这种简单的情况很好。有[`AttributeError`](http://docs.python.org/library/exceptions.html#exceptions.AttributeError)可以用来检查对象是否具有属性。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2010-09-08T03:05:58.337

处理这种情况的一种通常效果很好的方法是不显式检查变量是否存在，而是继续将可能不存在的变量的第一次使用包装在 try/except NameError 中：

```
# Search for entry.
for x in y:
  if x == 3:
    found = x

# Work with found entry.
try:
  print('Found: {0}'.format(found))
except NameError:
  print('Not found')
else:
  # Handle rest of Found case here
  ... 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2020-01-31T11:41:26.950

我创建了一个自定义函数。

```
def exists(var):
     return var in globals() 
```

然后调用函数如下替换`variable_name`您要检查的变量：

```
exists("variable_name") 
```

将返回`True`或`False`

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-02-22T06:48:59.107

像这样：

```
def no(var):
    "give var as a string (quote it like 'var')"
    assert(var not in vars())
    assert(var not in globals())
    assert(var not in vars(__builtins__))
    import keyword
    assert(var not in keyword.kwlist) 
```

然后后来：

```
no('foo')
foo = .... 
```

如果你的新变量`foo`使用起来不安全，你会得到一个`AssertionError`异常，指向失败的行，然后你会知道得更好。这是明显的人为的自我引用：

```
no('no')

---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-88-d14ecc6b025a> in <module>
----> 1 no('no')

<ipython-input-86-888a9df72be0> in no(var)
      2     "give var as a string (quote it)"
      3     assert( var not in vars())
----> 4     assert( var not in globals())
      5     assert( var not in vars(__builtins__))
      6     import keyword

AssertionError: 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-06-10T07:32:42.607

它可能不是高性能的，但您将解决方案推广到一个检查局部变量和全局变量的函数。

```
import inspect
def exists_var(var_name):
    frame = inspect.currentframe()
    try:
        return var_name in frame.f_back.f_locals or var_name in globals()
    finally:
        del frame 
```

然后你可以像这样使用它：

```
exists_var('myVar') 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-08-06T13:49:48.207

短变体：

```
my_var = some_value if 'my_var' not in globals() else my_var: 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-09-15T21:56:14.187

这是我的场景：

```
for i in generate_numbers():
    do_something(i)
# Use the last i. 
```

我无法轻易确定[iterable 的长度](https://stackoverflow.com/questions/390852/is-there-any-built-in-way-to-get-the-length-of-an-iterable-in-python)，这意味着它`i`可能存在也可能不存在，具体取决于 iterable 是否产生空序列。

如果我想使用最后一个`i`可迭代对象（`i`空序列不存在），我可以做以下两件事之一：

```
i = None  # Declare the variable.
for i in generate_numbers():
    do_something(i)
use_last(i) 
```

或者

```
for i in generate_numbers():
    do_something(i)
try:
    use_last(i)
except UnboundLocalError:
    pass  # i didn’t exist because sequence was empty. 
```

第一个解决方案*可能*有问题，因为我无法判断（取决于序列值）是否`i`是最后一个元素。第二种解决方案在这方面更准确。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-06-08T13:53:01.913

也是对象的一种可能性，使用`__dict__`.

```
class A(object):
    def __init__(self):
        self.m = 1

a = A()
assert "m" in a.__dict__
assert "k" not in a.__dict__ 
```

# java - Java NIO 中的异步通道关闭

> ID：843283
> 
> 赞同：3
> 
> 时间：2009-05-09T13:11:23.340
> 
> 标签：java, asynchronous, nio

假设我有简单的基于 nio 的 java 服务器。例如（简化代码）：

```
while (!self.isInterrupted()) {
  if (selector.select() <= 0) {
    continue;
  }

  Iterator<SelectionKey> iterator = selector.selectedKeys().iterator();
  while (iterator.hasNext()) {
    SelectionKey key = iterator.next();
    iterator.remove();
    SelectableChannel channel = key.channel();

    if (key.isValid() && key.isAcceptable()) {
      SocketChannel client = ((ServerSocketChannel) channel).accept();
      if (client != null) {
        client.configureBlocking(false);
        client.register(selector, SelectionKey.OP_READ);
      }
    } else if (key.isValid() && key.isReadable()) {
      channel.read(buffer);
      channel.close();
    }
  }
} 
```

所以，这是一个简单的单线程非阻塞服务器。

问题在于以下代码。

```
channel.read(buffer);
channel.close(); 
```

当我在同一个线程（接受连接和读取数据的线程）中关闭通道时，一切正常。但是当连接在另一个线程中关闭时我遇到了问题。例如

```
((SocketChannel) channel).read(buffer);
executor.execute(new Runnable() {
   public void run() {
     channel.close();
   }
}); 
```

在这种情况下，我最终在服务器上的状态为 TIME_WAIT 的套接字和在客户端的 ESTABLISHED 状态下结束。所以连接没有优雅地关闭。有什么想法有什么问题吗？我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-05T16:53:39.857

TIME_WAIT 表示操作系统已收到关闭套接字的请求，但等待来自客户端的可能延迟通信。客户显然没有得到 RST，因为它仍然认为它已经建立。这不是 Java 的东西，它是操作系统。RST 显然被操作系统延迟了——无论出于何种原因。

为什么它只发生在你在另一个线程中关闭它时——谁知道呢？可能是操作系统认为在另一个线程中关闭应该等待原始线程退出，或者什么。正如我所说，它是操作系统的内部机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T14:11:30.607

我不明白为什么它会有所作为，除非关闭抛出异常。如果是，您将不会看到异常。我建议将关闭放在一个 catch(Throwable t) 中并打印出异常（假设有一个）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T12:01:07.320

这可能与[这里提到的问题有关](http://markmail.org/message/of4h63wogwhxpge5)。如果它真的*是*BSD / OS X poll() 方法的行为，我认为你不走运。

我想我会将这段代码标记为不可移植，因为 - 据我所知 - BSD / OS X 中的一个错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-12T08:44:44.170

You have a major problem in your example.

With Java NIO, the thread doing the *accept()* **must** only be doing the *accept()*. Toy examples aside you are probably using Java NIO because of anticipated high number of connections. If you even *think* about doing the read in the same thread as the selects, the pending unaccepted selects will time out waiting for the connection to be established. By the time this one overwrought thread gets around to accepting the connection, the OS's on either side will have given up and the accept() will fail.

Only do the absolute minimum in the selection thread. Any more and you will just being rewriting the code until you do only the minimum.

*[In response to comment]*

Only in toy examples should the reading be handled on the main thread.

Try to handle:

*   300+ simultaneous connection attempts.
*   Each connection once established sends 24K bytes to a single server - i.e. a small web page, a tiny .jpg.
*   Slow down each connection slightly ( the connection is being established over a dialup, or the network is having a high-error/retry rate) - so the TCP/IP ACK takes longer than ideal (out of your control OS level thing)
*   Have some of your test connections, send a single bytes every 1 milliseconds. (this simulates a client that is having its own high load condition, so is generating the data at a very slow rate.) The thread has to spend almost the same amount of effort processing a single bytes as it does 24K bytes.
*   Have some connections be cut with no warning ( connection lost issues ).

As a practical matter, the connection needs to be established within 500ms -1500ms before the attempting machine drops the connection.

As a result of all these issues, a single thread will not be able to get all the connections set up fast enough before the machine on the other end gives up the connection attempt. The reads must be in a different thread. period.

**[Key Point]** I forgot to really be clear about this. But the threads doing the reading will have their own Selector. The Selector used to establish the connection should not be used to listen for new data.

*Addition (in response to Gnarly's contention that no I/O actually occurs during the java call to read the stream.*

Each layer has a defined buffer size. Once that buffer is full, the IO is halted. For example, TCP/IP buffers have between 8K-64K buffers per connection. Once the TCP/IP buffer fills, the receiving computer tells the sending computer to stop. If receiving computer does not process the buffered bytes fast enough the sending computer will drop the connection.

If the receiving computer is processing the buffered bytes, the sender will continue to stream the bytes, *while the java io read call is being made*.

Furthermore, realize that the first byte to arrive triggers the "bytes available to be read" on the selector. There is no guarantee as to how many have arrived.

The buffer sizes defined in the java code have no relationship to the buffer size of the OS.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T07:19:33.640

你知道，经过更仔细的测试，我无法在我的 Mac 上重现你的结果。

虽然在服务器端关闭后连接确实会在 TIME_WAIT 中保持大约 1 分钟，但它会在客户端立即关闭（当我使用 telnet 客户端连接到它进行测试时）。

无论我在哪个线程上关闭通道，这都是一样的。你在什么机器上运行，什么版本的java？

# c# - C# 何时使用“This”关键字

> ID：843288
> 
> 赞同：27
> 
> 时间：2009-05-09T13:14:16.060
> 
> 标签：c#, constructor, this

> **可能重复：**
> [您何时使用“this”关键字？](https://stackoverflow.com/questions/23250/when-do-you-use-the-this-keyword)

你好，我知道`This`关键字是用来引用类的一个实例，但是，假设我有一个名为的类`Life`，它定义了两个字段，人（*他们的名字*）和他们的伙伴（*他们的名字*）：

```
class Life
{
    //Fields
    private string _person;
    private string _partner;

    //Properties
    public string Person
    {
        get { return _person; }
        set { _person = value; }
    }

    public string Partner
    {
        get { return _partner; }
        set { _partner = value; }
    }

    //Constructor 1
    public Life()
    {
        _person = "Dave";
        _partner = "Sarah";

        MessageBox.Show("Life Constructor Called");
    }

    //Constructor 2
    public Life()
    {
        this._person = "Dave";
        this._partner = "Sarah";

        MessageBox.Show("Life Constructor Called");
    }
} 
```

构造函数1和构造函数2有区别吗！？还是使用“This”关键字只是更好的编码习惯？

问候

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-09T13:17:19.480

构造函数是相同的。 ~~我更喜欢第二个的原因是它允许您从私有变量名称中删除下划线并保留上下文（提高可理解性）。我习惯于`this`在引用实例变量和属性时始终使用它。~~

`this`转到不同标准的不同公司后，我不再以这种方式使用关键字。我已经习惯了，现在在提及实例成员时很少使用它。我仍然建议使用属性（显然）。

我的你的班级版本：

```
class Life
{
    //Fields
    private string person;
    private string partner;

    //Properties
    public string Person
    {
        get { return this.person; }
        set { this.person = value; }
    }

    public string Partner
    {
        get { return this.partner; }
        set { this.partner = value; }
    }

    public Life()
    {
        this.person = "Dave";
        this.partner = "Sarah";

        MessageBox.Show("Life Constructor Called");
    }
} 
```

`this`或者，甚至更好，但对with 字段的使用不是很清楚。

```
class Life
{

    //Properties
    public string Person { get; set; }
    public string Partner { get; set; }

    public Life()
    {
        this.Person = "Dave";
        this.Partner = "Sarah";

        MessageBox.Show("Life Constructor Called");
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-09T13:26:08.550

"this" 也用于 .Net 3.5 的扩展方法：

```
public static class MyExtensions
{    
    public static string Extend(this string text)
    {
       return text + " world";
    }
} 
```

将扩展字符串类

```
var text = "Hello";
text.Extend(); 
```

回答您的问题：不，您的两个构造函数没有区别。Imo，“this”使代码混乱，只应在必要时使用，例如，当参数和字段变量具有相同名称时。

还有一种情况是类显式实现了接口。如果您需要从类中调用接口方法，则必须将其强制转换为接口：

```
class Impl : IFace
{

    public void DoStuff()
    {
        ((IFace)this).SomeMethod();
    }

    void IFace.SomeMethod()
    {
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-09T13:20:24.100

两种说法没有区别...

```
//These are exactly the same.

this._person 

//and 

_person 
```

在 _person 的情况下暗示了对“this”的引用。我不会说这一定是“更好”的编码实践，我会说这只是偏好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-09T13:19:08.840

[已经讨论过了](https://stackoverflow.com/questions/23250/when-do-you-use-the-this-keyword)

[你什么时候使用“this”关键字？](https://stackoverflow.com/questions/23250/when-do-you-use-the-this-keyword)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-09T13:25:55.510

由于您使用的是下划线，因此名称之间没有冲突；所以“ `this.`”是多余的，可以省略。IL 将不受影响。

只要字段和变量/参数之间没有歧义，就只有一种情况，其中`this`关键字（在表示当前实例的上下文中 - 不是 ctor 链接）是严格必要的 - 调用定义的扩展方法分别地：

```
this.SomeExtensionMethod();  // works
SomeExtensionMethod();  // fails 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-09T13:28:50.533

Both constructors do the same thing anyway in the second one the `this` is redundant

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-09T13:19:39.123

您可以使用它来区分名为 X 的局部变量和同名的类级别字段/属性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-09T13:21:53.633

您不应该使用私有变量 _person 和 _parter。这就是你的 getter 和 setter 的目的。

就结构而言，它们之间没有真正的区别。话虽如此，我总是更喜欢使用 This 关键字，因为它有助于提高可读性。

# url - 短网址冲突。更喜欢项目还是项目列表？

> ID：843289
> 
> 赞同：1
> 
> 时间：2009-05-09T13:14:26.450
> 
> 标签：url, seo, short-url

我正在构建一个包含教程和其他内容的网站。我正在尝试找到一个好的 URL 结构。但是，我有一个冲突：

```
tutorials/ <-- list of all tutorials
tutorials/a-very-cool-tutorial <-- points to the very cool tutorial
tutorials/java <-- a list of tutorials tagged java
tutorials/java+soap <-- a list of tutorials tagged java and soap
tools/soap <-- soap tools
tools/wsdl-generator <-- points to the tool
resources/foo <-- resources for a foo
resources/foo+bar <!-- resource for a foo and a bar
tutorials/java?sort=newest
tutorials/php?showhidden=yes&count=30 
```

不可能自动解决差异，因此必须更改其中之一。我应该做哪一个

```
tutorials/show/a-very-cool-tutorial
   VS
tutorials/list/java
or list-of-tutorials or something like that? 
```

我倾向于使用 tutorials/list/ （并将 tutorials/ 也重定向到那个）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T13:26:19.377

为什么不在 URL 结构中表达文章层次结构？你可以写：

```
tutorials/ ← list of all tutorials
tutorials/java ← a list of java tutorials
tutorials/java/a-very-cool-tutorial ← points to the very cool tutorial 
```

通过这种方式，访问者可以知道*一个非常酷的教程*是一个 Java 教程，如果你介意 SEO，这个版本也很适合。

**编辑**

根据您的评论，一篇文章可能有多个标签，并且您的网站有属于一个标签集的文章列表。在这种情况下，您可以选择这个概念：

```
tutorials/
tutorials/a-very-cool-tutorial
tags/java ← tags have a separate prefix
tags/java+soap 
```

或其他：

```
tutorials/
tutorials/a-very-cool-tutorial.html
tutorials/java/
tutorials/java+soap/ ← the trailing slash indicates that it's a listing 
```

（你可以写第三个，可能更好也可能不好。）这取决于你的品味。

除了你选择的方案，我建议你把文章ID或发表日期放在URL中，以避免URL冲突。

```
tutorials/20090509/a-very-cool-tutorial ← a visitor friendly way
tutorials/928/a-very-cool-tutorial ← ID in URL like how Stack Overflow does 
```

**编辑 2**

您对该问题的最新更新澄清说，除了标签之外，你们都有类似类别的东西——我的意思是教程、工具、资源。它给问题带来了不必要的复杂性。我认为将这些额外的方面也作为标签处理会更好。所以*tutorial*只是另一个标签，比如*java*，它适用于上述所有想法。

```
/a-very-cool-tutorial ← article (beware of URL collision)
/java/ ← all Java posts
/tutorials+java+soap/ ← all Java related SOAP tutorials
/tags/tutorials+soap/ ← you can use an extra prefix 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T13:18:58.420

为什么不

```
tutorials/ <-- all tutorials

tutorials/java <-- all Java tutorials

tutorial/a-very-cool-tutorial <-- the very cool tutorial 
```

从而通过使用单数/复数来区分单个教程和教程列表。这消除了任何歧义的可能性，这可能会给你一些安全感:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T13:21:20.950

这不是“不可能的”。您始终可以使用一种方法来检查路径中的最后一项是组还是项并采取相应的行动 - 将控制权传递给相关代码。我以前在购物网站上使用过这种技术。

由于项目的数量通常大于组的数量，我建议您检查您是否将组作为特殊情况处理并默认使用项目。

这并不是说在 URL 中有一个额外的参数是错误的、更好或更坏。但是你可以按照你最初所说的方式来做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T13:42:30.567

```
tutorials/by-tag/java
tutorials/search/user-search-string
tutorials/   <-- all
tutorials/a-nice-tutorial 
```

在解析 url 时，可以查找这些关键字。如果它是未知的，它是一个变量索引传递给父“资源”来解析（教程集合得到“/a-nice-tut”，一个搜索对象被传递给搜索字符串，等等）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T15:01:03.470

这有什么问题？

```
tutorials/ <-- list of all tutorials
tutorials/a-very-cool-tutorial <-- points to the very cool tutorial
tutorials/tags/java <-- a list of tutorials tagged java
tutorials/tags/java+soap <-- a list of tutorials tagged java and soap 
```

对我来说似乎更直观，并且避免了任何歧义。

# sql - 以 1 个条件查询三个表

> ID：843290
> 
> 赞同：0
> 
> 时间：2009-05-09T13:15:33.253
> 
> 标签：sql, mysql

我有以下表格：

**标签**

id tag_name

**例子**

id 类别标题

**示例标签**

id tag_id example_id

如何检索每个标签下的示例数？（实际上有点像stackoverflow :)）

我还想要一个附加条件：examples.category = "english examples"

我就是这样开始的...

```
SELECT tags.id, tags.tag_name, COUNT( examples_tags.tag_id ) AS 'no_tags'
WHERE tags.id = examples_tags.tag_id

&&
examples.category = 'english examples' 
```

分组标签.id

谢谢 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T13:26:18.817

这是一个 3 表连接，在标签和示例表之间使用多对多表 examples_tags。您还必须按选择列表中不是聚合的每一列进行分组。

```
SELECT t.id, t.tag_name, COUNT( *) AS 'no_tags'
FROM tags t
 JOIN examples_tags et
   ON t.id = et.tag_id
 JOIN examples e
   ON e.example_id = e.id
WHERE 
  e.category = 'english examples'
GROUP BY t.id, t.tag_name
ORDER BY t.tag_name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T13:26:35.320

没有正确的连接将是下一个：

```
SELECT tags.id, tags.tag_name, COUNT(*) AS num_tags
FROM tags, examples_tags, examples
WHERE tags.id = examples_tags.tag_id 
    and examples_tags.example_id=examples.id
    and examples.category = 'english examples'
GROUP BY tags.id, tags.tag_name 
```

您需要按所有非聚合字段分组。

否则，您可以使用内部联接，使查询更具可读性：

```
SELECT tags.id, tags.tag_name, COUNT(*) AS num_tags
FROM tags 
    inner join examples_tags on examples_tags.tag_id=tags.id
    inner join examples on examples_tags.example_id=examples.id
WHERE examples.category = 'english examples'
GROUP BY tags.id, tags.tag_name 
```

# asp.net - 如何在 ASP.NET 应用程序中映射根 URL？

> ID：843295
> 
> 赞同：4
> 
> 时间：2009-05-09T13:16:31.350
> 
> 标签：asp.net, httphandler

我的 Web.config 中有以下内容：

```
<httpHandlers>
    . . .
    <add verb="GET,HEAD" path="/" type="Vis.Web.BootHandler, Vis" />
</httpHandlers> 
```

该 HTTP 处理程序返回一个静态 HTML 页面，只是为了查看它是否有效。

现在，当我运行我的 Web 应用程序（没有 Default.aspx 等）时，我得到的是默认目录列表。当我改变它的路径时，`"/foo"`它工作得很好。

我尝试`""`了路径，它也产生了目录列表。与拥有它相同，`"/foo"`然后将 URL 映射添加到 for `""`、`"~"`和`"~/"``"/"`

如何使用 HTTP 处理程序处理 Web 根目录/覆盖目录列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T13:19:27.517

**更新：关于评论** 这不能在开发服务器中完成，因为它需要 IIS 的功能。

**原始：** 您需要将通配符应用程序映射添加到 asp.net DLL，以便所有请求（甚至是目录）都通过 .net 运行时运行，因此您的 HTTP 处理程序。

查看[http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/IIS/5c5ae5e0-f4f9-44b0-a743-f4c3a5ff68ec.mspx](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/IIS/5c5ae5e0-f4f9-44b0-a743-f4c3a5ff68ec.mspx)

了解更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T13:27:19.830

除了@Greg B 所说的之外，您还需要添加一个虚拟的 default.aspx 页面并使用 /* 路径注册您的处理程序：

```
<httpHandlers>
    . . .
    <add verb="GET,HEAD" path="/*" type="Vis.Web.BootHandler, Vis" />
</httpHandlers> 
```

# sqlite - 带有 MFC 的 SQLite

> ID：843303
> 
> 赞同：1
> 
> 时间：2009-05-09T13:19:14.630
> 
> 标签：sqlite, mfc

我想在我的 MFC 应用程序中使用 SQLite。

为此，我将创建一个对象，其工作是直接与 DB(SQLite) 交互，以将应用程序的其余部分与 DB 代码隔离开来。

谁能指点我一个好的教程？我需要诸如（创建、删除、插入、更新、createdb、dropdb 等...）之类的操作

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T14:45:09.710

SQLite 站点中有一个页面列出了许多可用的包装器 -[这里](http://www.sqlite.org/cvstrac/wiki?p=SqliteWrappers)。Daniel 在他的回答中提到的 C++ 包装器可能是最常见的一种，尽管它不支持 Unicode，而且它附带的 SQLite dll 已经过时了。[这里](http://softvoile.com/development/CppSQLite3U/)有该包装器的 Unicode 版本，但它有点错误，需要更多的工作。但是，它可以为您省去从头开始编写整个内容的麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T13:34:21.080

看看这个。这真的很容易移植到 MFC 类，但它会让你开始。

[http://www.codeproject.com/KB/database/CppSQLite.aspx](http://www.codeproject.com/KB/database/CppSQLite.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T04:10:50.537

或者您可以只执行#include "sqlite3.h"，将 sqlite3.lib 添加到您的链接器并直接使用 sqlite3.dll 与 C api。这就是我在 MFC 应用程序中所做的。

您甚至可以将 sqlite3 静态链接到您的应用程序中。下载合并并包含它！它增加了大约 400 k。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T13:36:42.733

请更清楚地定义您的问题。sqlite 可以使用 c 进行编码，您可以在他们的网站上阅读示例。

# asp.net-mvc - mvccontrib 网格默认排序顺序

> ID：843304
> 
> 赞同：2
> 
> 时间：2009-05-09T13:19:21.633
> 
> 标签：asp.net-mvc, model-view-controller, grid, mvccontrib

任何人都知道如何设置 mvccontrib 网格的默认排序顺序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T14:03:41.093

在我看来，网格本身不进行任何排序。它只是按照它们出现的顺序呈现数据源中的项目。因此，您需要在创建网格之前对数据源进行排序，或者在使用按所选列正确排序的项目进行排序时重新分配数据源。

[可在此处](http://mvccontrib.googlecode.com/svn/trunk/src/MVCContrib/UI/Grid/)获得源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-24T23:47:45.597

您可以使用 labda 表达式 .OrderBY(x => x.Col)

为什么不让您的用户选择排序顺序？

搜索 * 文件：jquery.dataTables.min.js * 版本：1.4.3 * 作者：Allan Jardine (www.sprymedia.co.uk)

他做了一些杀手级的例子，它与 mvcContrib 配合得很好

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T14:13:00.763

大多数网格控件都要求您提供自己的订购代码，这一点也不例外。这允许您提供您认为合适的排序 - 例如使用自然顺序而不是比较顺序对带有数字的字符串进行排序。

# .net - 使用 Kerberos 对网站和 Web 服务进行身份验证是个好主意吗？

> ID：843317
> 
> 赞同：6
> 
> 时间：2009-05-09T13:23:50.187
> 
> 标签：.net, security, authentication, openid, kerberos

通过收购，我们有许多需要认证和授权的产品。产品包括网站和客户端应用程序，客户端应用程序使用一些网络服务。我们是一家.Net 商店，服务器将运行 Server 2008，客户端将运行 XP SP？然后。

产品的用户不属于我们的组织，从具有独立 PC 的单个用户到运行 Active Directory 等的组织中的用户运行。

目前没有通用的身份验证或身份存储，我们正在寻求补救。我们的目标是：

*   所有产品的单一用户名和密码（或证书）。
*   理想情况下是单点登录（如果我们从客户端应用程序启动网站，这很容易，如果用户先登录网站然后再启动客户端应用程序，则可能不太容易）。
*   加上平时；健壮、可扩展...

像大多数公司一样，我们的资源有限，时间紧迫。

一种建议的身份验证路径是 Kerberos，这可能是客户端应用程序对 Web 服务进行身份验证的理想途径，但我不太乐意在用户提交用户名和密码的网站上使用它，而 Web 服务器将是负责票务（然后将票存储在 cookie 中？）。我觉得使用单一身份存储和我们自己的身份验证服务可能会更好，该服务接受用户名和密码，与排序的哈希值进行比较，然后发布一个自定义的、基于时间的安全令牌。也许使用 SqlMembershipProvider？

感谢读到这里的任何人。Kerberos 是否最适合这种情况，还是我应该寻找其他地方？如果不合适，为什么不呢？

我们也在寻找 AD LDS 的授权，但我认为这篇文章已经足够长了......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-23T15:36:29.607

除了 Kerberos 并不是真正为这种用例设计的，而且通常不能很好地与防火墙配合使用之外，它本身并没有什么错。例如，您可能不想打开对您在内部使用的同一个 Kerberos KDC 的外部访问。

另外，如果您的意思是 MS Kerberos，并且您显然是这样做的，那么打开 Kerberos 会附带一个完整的其他 MS 协议的老鼠巢，您迟早必须打开这些协议，因为更高级别的东西与 AD 等以及 Kerberos 纠缠在一起.

那说：

> 我觉得使用我们自己的身份验证服务可能会更好

几乎可以肯定不是。你通常不想重新发明轮子，如果你必须，那就不要*那个*轮子。身份验证协议通常很难执行，对于 Web 访问来说更难。坚持已经存在的东西 - 基本身份验证 + SSL 或客户端证书和 SSL，加上会话跟踪（如果这些东西真的很重要，则再次通过 SSL），或者与您的 AD 不同的 LDAP 服务。这些方法都有自己的问题，但没有你自己滚动的东西那么多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T13:38:44.577

你考虑过[OpenID](http://openid.net/)吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T19:48:05.980

您的单个用户帐户的 OpenID 和授权应用程序访问另一个网站上的数据的 OAuth 是一个很好的分布式解决方案。是的，Active Directory 或其他纯单点登录解决方案在同构环境中运行良好，但在您的组织中听起来却大相径庭。

设置一个安全的 OpenID 提供程序实际上是一项重大责任，不应该只是通过将库与 Web 服务器一起拍打来完成的事情。您可以让您的用户使用他们自己的 OpenID，然后拥有一个数据库，您的用户在其中注册他们的 OpenID，以便他们在整个系统中被识别为员工/成员。系统的各个部分可以直接针对数据库检查 OpenID 的成员资格，或者您也可以使用 OAuth 来帮助验证成员资格。

您可以将这两种技术结合起来的方式非常有趣。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-13T23:49:15.597

对于网站，您可以使用 SPNego/GSS-API/Kerberos。所有主流浏览器和网络服务器都支持 SP Nego。由于 LDAP、NFS 和 HAdoop 都支持 Kerberos，您应该看看这个解决方案。查看带有协商选项的 curl 命令。

# javascript - jQuery“修改”事件

> ID：843318
> 
> 赞同：0
> 
> 时间：2009-05-09T13:23:56.630
> 
> 标签：javascript, jquery, events

所以我最近仔细研究了 JavaScript 和 jQuery，然后偶然发现了名为 Greasemonkey 的 Firefox 扩展。

好吧，让我解释一下“修改”事件的含义：我为某个页面安装了 2-3 个用户脚本，它们会自动查看页面是否发生了任何变化，如果有，它们会加载新内容并将其附加到已加载的页面（他们修改 DOM）。

所以基本上，我的用户脚本需要知道什么时候发生，但我不知道我应该怎么做。有任何 jQuery 事件吗？帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T14:42:51.607

```
var orig;

$(function(){
     orig = getContent();
})

function watchContent() {
     var mod = getContent();
     if (mod != orig){ resetContent(orig); }
     setTimeout(watchContent,1000)
}

function resetContent(html) {
  $("body").append( html );
}

function getContent() {
    return $("body").html();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T13:30:09.533

使用 jQuery 事件，如果您希望将事件应用于新元素，您将使用[.live](http://docs.jquery.com/Events/live)方法，但是 jQuery 1.3 不支持将`blur`、`focus`、`mouseenter`、`mouseleave`、`change`或`submit`事件作为实时事件，`change`您需要使用它。( `change`, `submit`, 和`blur/focus`都在jQuery 1.4的[路线图上)](http://docs.jquery.com/JQuery_1.4_Roadmap#Events)

作为替代方案，您可以使用[liveQuery](http://plugins.jquery.com/project/livequery)插件。

# java - 如何使用泛型实现比较器？

> ID：843334
> 
> 赞同：2
> 
> 时间：2009-05-09T13:30:50.753
> 
> 标签：java, generics

只是一个小问题`Arraylist`。我想`ArrayList<Client>`按名称排序。

```
Class Client{ String name; int phonenumber ..} 
```

这段代码可以工作，但我有一个编译器警告：“使用未经检查或不安全的操作”。有什么问题？

```
 public void sortByName(){
    Collections.sort(ListofClients, new NameComparator());
 } 
```

我的比较器看起来像这样：

```
public class NameComparator implements Comparator{
  public int compare(Object client1, Object client) {
   String name1 = ((Client) client1).getName();
   String name2 = ((Client) client2).getName();

   return name1.toUpperCase()).compareTo(name2.toUpperCase(); 
  }
} 
```

如果我使用“ `implements Comparator<Client>`”，我会得到一个错误：“NameComparator 不是抽象的，并且不会覆盖 java.util.Comparator 中的抽象方法 compare(Client, Client)。我的比较器错了吗？抱歉这个菜鸟问题，java 新手

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-09T14:11:34.163

之后你`implement Comparator<Client>`需要改变：

```
public int compare(Object client1, Object client) 
{
  ...
} 
```

对此

```
public int compare(Client client1, Client client)
{
    // Now you don't have to cast your objects!
} 
```

这都是因为比较器的定义

```
public interface Comparator<T>
{
    public compare(T o1, T o2);
} 
```

注意泛型参数 T 如何出现在方法名称中。

像 Eclipse / Netbeans / IntelliJ 这样的 IDE 将在这种情况下提供帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T13:35:57.460

我认为您的客户列表属于

```
List<Client> 
```

在这种情况下，您的比较器应该是 type `Comparator<Client>`，并执行适当的比较（在这种情况下按名称）

# objective-c - 释放属性（Objective-C）

> ID：843337
> 
> 赞同：2
> 
> 时间：2009-05-09T13:32:56.307
> 
> 标签：objective-c, iphone

我有一个@property，它的定义如下：

@property（非原子，保留）名称；

在一个函数中，我解析一些 xml 并设置 name 属性。我的问题是我应该在保留新实例之前明确释放以前保留的实例吗？

举个例子 ：

myObj.name = [otherObj getName]; // 保留计数 +1

..

myObj.name = [otherObj getName]; // 这是一个名称的新实例，之前的名称是否已发布？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T16:33:51.983

在综合属性设置器中，代码执行的操作大致类似于此（我们将`name`是属性名称，并且`_name`将是它所引用的实例变量）：

```
- (void) setName: (NSString *) newValue
{
  if ( newValue == _name )
    return;

  [newValue retain];
  [_name release];
  _name = newValue;
}
```

现在，这显示了根据您上面的财产声明会发生什么。根据该属性的其他可能属性，该函数将使用`[newValue copy]`代替`[newValue retain]`（如果指定了“复制”属性），或者将全部包装在一个`@synchronized(self)`块中（如果未提供“非原子”属性**）**。

我还应该注意，由于您的属性是指实现 NSCopying 协议的 NSString，因此您应该真正使用复制而不是保留，即：

```
@property (nonatomic, copy) NSString * name; 
```

这将导致合成的 setter 使用`-copy`而不是`-retain`，当您实际传递 NSMutableString 对象时，这会更安全。一个不可变的字符串最终只会被`-copy`调用保留，而一个可变的字符串会创建一个新的不可变副本。不这样做意味着字符串本身可以在它被传递到 setter 后被更改，在你的对象不知情的情况下更改值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T13:36:56.277

如果您已经为您的属性合成了访问器（使用`@synthesize`指令），他们将负责在重新分配属性时释放支持该属性的 ivar。您可能想要显式释放 ivar 的唯一时间是当您的对象被释放时。因此，您的 dealloc 方法可能如下所示：

```
- (void)dealloc {
  [name release];
  // other cleanup here
  [super dealloc];
} 
```

# objective-c - 为什么 UIView.exclusiveTouch 不起作用？

> ID：843338
> 
> 赞同：13
> 
> 时间：2009-05-09T13:33:30.753
> 
> 标签：objective-c, iphone, cocoa-touch, uiview, uikit

在我的一个 iPhone 项目中，我有三个视图，您可以通过触摸和拖动来移动它们。但是，我想通过使用两个手指来阻止用户同时移动两个视图。因此，我尝试尝试使用 UIView.exclusiveTouch，但没有任何成功。

为了了解该属性的工作原理，我创建了一个全新的项目，在视图控制器中使用以下代码：

```
- (void)loadView {

    self.view = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 460)];
    UIButton* a = [UIButton buttonWithType:UIButtonTypeInfoDark];
    [a addTarget:self action:@selector(hej:) forControlEvents:UIControlEventTouchUpInside];
    a.center = CGPointMake(50, 50);
    a.multipleTouchEnabled = YES;

    UIButton* b = [UIButton buttonWithType:UIButtonTypeInfoDark];
    [b addTarget:self action:@selector(hej:) forControlEvents:UIControlEventTouchUpInside];
    b.center = CGPointMake(200, 50);
    b.multipleTouchEnabled = YES;

    a.exclusiveTouch = YES;

    [self.view addSubview:a];
    [self.view addSubview:b];

}

- (void)hej:(id)sender
{
    NSLog(@"hej: %@", sender);
} 
```

当运行这个时，hej: 被调用，不同的发件人，当按下任何一个按钮时——即使其中一个将 ExclusiveTouch 设置为 YES。我试过评论multipleTouchEnabled-lines，但无济于事。有人可以向我解释我在这里缺少什么吗？

谢谢， 伊莱

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-14T07:18:20.717

来自[iPhone OS 编程指南](https://developer.apple.com/library/ios/documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/multitouch_background/multitouch_background.html)：

> 将事件传递限制为单个视图：
> 
> 默认情况下，视图的 ExclusiveTouch 属性设置为 NO。如果将该属性设置为 YES，则标记视图，以便在跟踪触摸时，它是窗口中唯一跟踪触摸的视图。窗口中的其他视图无法接收这些触摸。但是，标记为“独占触摸”的视图不会接收与同一窗口中的其他视图相关联的触摸。如果手指接触独占触摸视图，则仅当该视图是该窗口中跟踪手指的唯一视图时才传递该触摸。如果手指触摸非独占视图，则仅当独占触摸视图中没有另一个手指跟踪时才传递该触摸。

它声明独占触摸属性不会影响视图框架之外的触摸。

过去为了处理这个问题，我使用主视图来跟踪屏幕上的所有触摸，而不是让每个子视图跟踪触摸。最好的方法是：

```
if(CGRectContainsPoint(thesubviewIcareAbout.frame, theLocationOfTheTouch)){
    //the subview has been touched, do what you want
} 
```

# firefox - 通过命令行设置firefox代理

> ID：843340
> 
> 赞同：43
> 
> 时间：2009-05-09T13:35:56.400
> 
> 标签：firefox, command-line

如何在 windows xp/2k 上通过命令行更改 Firefox 代理设置？

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-09T13:51:30.817

代理设置存储在用户的`prefs.js`Firefox 配置文件中。

Firefox 配置文件目录和文件的路径是：

```
%APPDATA%\Mozilla\Firefox\Profiles\7b9ja6xv.default\prefs.js
```

其中“ `7b9ja6xv`”是一个随机字符串。但是，默认配置文件的目录始终以“.default”结尾。无论如何，大多数时候只会有一个配置文件。

你所追求的设置被命名为“ `network.proxy.http`”和“ `network.proxy.http_port`”。

现在这取决于您能够/准备使用什么技术来更改文件。

PS：如果这是关于通过登录脚本或类似方式更改一组用户的代理设置，我建议研究使用自动代理发现 ( [WPAD](http://en.wikipedia.org/wiki/Web_Proxy_Autodiscovery_Protocol) ) 机制的可能性。您将永远不必再次更改用户计算机上的代理配置。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-09T13:50:14.530

我不认为你可以。但是，您可以为每个代理设置创建不同的配置文件，并在运行 Firefox 时使用以下命令在配置文件之间切换：

```
firefox -no-remote -P <profilename> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-03-24T15:46:48.413

只是想以更简洁的格式发布代码......最初由 sam3344920 发布

```
cd /D "%APPDATA%\Mozilla\Firefox\Profiles"
cd *.default
set ffile=%cd%
echo user_pref("network.proxy.http", "148.233.229.235 ");>>"%ffile%\prefs.js"
echo user_pref("network.proxy.http_port", 3128);>>"%ffile%\prefs.js"
echo user_pref("network.proxy.type", 1);>>"%ffile%\prefs.js"
set ffile=
cd %windir% 
```

* * *

如果有人想**删除**代理设置，这里有一些代码可以为你做到这一点。

```
cd /D "%APPDATA%\Mozilla\Firefox\Profiles"
cd *.default
set ffile=%cd%
type "%ffile%\prefs.js" | findstr /v "user_pref("network.proxy.type", 1);" >"%ffile%\prefs_.js"
rename "%ffile%\prefs.js" "prefs__.js"
rename "%ffile%\prefs_.js" "prefs.js"
del "%ffile%\prefs__.js"
set ffile=
cd %windir% 
```

**说明：**代码运行并找到 perfs.js 文件。然后在其中查找*“user_pref("network.proxy.type", 1);"行* . 如果找到它，它会删除带有 /v 参数的文件。我添加重命名和删除行的原因是，一旦我删除了代理行，我就找不到覆盖文件的方法。我确信有一种更*有效/更安全*的方法来做到这一点......

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-03-25T18:43:45.463

> cd /D "%APPDATA%\Mozilla\Firefox\Profiles" cd *.default set ffile=%cd% echo user_pref("network.proxy.http", "%1");>>"%ffile%\prefs. js" echo user_pref("network.proxy.http_port", 3128);>>"%ffile%\prefs.js" echo user_pref("network.proxy.type", 1);>>"%ffile%\prefs. js" 设置 ffile= cd %windir%

这很好！谢谢你写这个。我需要这段用于 Windows 的确切代码。我的目标是通过首先学习使用 Linux 来做到这一点，然后学习 Windows shell，我不喜欢这样做，所以你节省了我一些时间！

我的 Linux 版本在这篇文章的底部。我一直在尝试将首选项插入哪个文件。似乎很挑剔。首先，我在 ~/.mozilla/firefox/*.default/prefs.js 中进行了尝试，但加载得不是很好。about:config 屏幕从未显示我的更改。目前我一直在尝试编辑实际的 Firefox 默认文件。如果有人突然想到了这些知识，他们是否可以重写 Windows 代码以仅在它们不存在的情况下添加行？如果不先安装 Cygwin，我不知道如何在 Windows 中执行 sed/awk 操作。

我能够对 Windows 脚本进行的唯一更改是上面引用的部分。我将 IP 更改为 %1，因此当您从命令行调用脚本时，您可以为其提供一个选项，而不必更改文件。

```
#!/bin/bash
version="`firefox -v | awk '{print substr($3,1,3)}'`"
echo $version " is the version."
# Insert an ip into firefox for the proxy if there isn't one
if
! grep network.proxy.http /etc/firefox-$version/pref/firefox.js 
  then echo 'pref("network.proxy.http", "'"$1"'")";' >> /etc/firefox-$version/pref/firefox.js 
fi

# Even if there is change it to what we want
sed -i s/^.*network.proxy.http\".*$/'pref("network.proxy.http", "'"$1"')";'/  /etc/firefox-$version/pref/firefox.js 

# Set the port
if ! grep network.proxy.http_port /etc/firefox-$version/pref/firefox.js 
  then echo 'pref("network.proxy.http_port", 9980);' >> /etc/firefox-$version/pref/firefox.js 
  else sed -i s/^.*network.proxy.http_port.*$/'pref("network.proxy.http_port", 9980);'/ /etc/firefox-$version/pref/firefox.js 
fi

# Turn on the proxy
if ! grep network.proxy.type  /etc/firefox-$version/pref/firefox.js 
  then echo 'pref("network.proxy.type", 1);' >> /etc/firefox-$version/pref/firefox.js 
  else sed -i s/^.*network.proxy.type.*$/'pref("network.proxy.type", 1)";'/ /etc/firefox-$version/pref/firefox.js 
fi 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-26T15:52:20.390

最简单的方法是将 Firefox 配置为使用带有文件 URL 的 PAC，然后在启动 Firefox 之前从 line 命令更改文件 URL。

这是最简单的方法。您不必编写一个脚本来记住 prefs.js 的路径（可能会随着时间而改变）。

您配置您的配置文件一次，然后您可以随时编辑外部文件。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-05-10T13:51:56.310

```
it working perfect.

cd /D "%APPDATA%\Mozilla\Firefox\Profiles"
cd *.default
set ffile=%cd%
echo user_pref("network.proxy.ftp", "YOUR_PROXY_SERVER"); >>prefs.js
echo user_pref("network.proxy.ftp_port", YOUR_PROXY_PORT); >>prefs.js
echo user_pref("network.proxy.http", "YOUR_PROXY_SERVER"); >>prefs.js
echo user_pref("network.proxy.http_port", YOUR_PROXY_PORT); >>prefs.js
echo user_pref("network.proxy.share_proxy_settings", true); >>prefs.js
echo user_pref("network.proxy.socks", "YOUR_PROXY_SERVER"); >>prefs.js
echo user_pref("network.proxy.socks_port", YOUR_PROXY_PORT); >>prefs.js
echo user_pref("network.proxy.ssl", "YOUR_PROXY_SERVER"); >>prefs.js
echo user_pref("network.proxy.ssl_port", YOUR_PROXY_PORT); >>prefs.js
echo user_pref("network.proxy.type", 1); >>prefs.js
set ffile=
cd %windir% 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-06-02T19:35:11.683

您可以使用 -proxy-server 选项从带有代理服务器的命令行轻松启动 Firefox。

这适用于 Mac、Windows 和 Linux。

path_to_firefox/firefox.exe -proxy-server %proxy_URL%

Mac 示例：

/Applications/Firefox.app/Contents/MacOS/firefox -proxy-server proxy.example.com

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-10-09T21:02:47.667

我需要设置一个附加选项以允许 SSO 直通到我们的 Intranet 站点。我在上面的示例中添加了一些代码。

```
pushd "%APPDATA%\Mozilla\Firefox\Profiles\*.default"
echo user_pref("network.proxy.type", 4);>>prefs.js
echo user_pref("network.automatic-ntlm-auth.trusted-uris","site.domain.com, sites.domain.com");>>prefs.js
popd 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-07-17T15:11:04.027

这里的所有其他答案都解释了如何将您的代理设置编程到 Firefox 中，这是[WPAD](http://en.wikipedia.org/wiki/Web_Proxy_Autodiscovery_Protocol)的发明目的。如果您配置了 WPAD，那么只需告诉 Firefox 使用它来自动检测其设置，就像您在 GUI 中所做的那样。

![连接设置](https://i.stack.imgur.com/DE266.png)

要从 cmd 文件或命令行执行此操作：

```
pushd "%APPDATA%\Mozilla\Firefox\Profiles\*.default"
echo user_pref("network.proxy.type", 4);>>prefs.js
popd 
```

*这当然需要您配置 WPAD 并正常工作。此外，我相信`prefs.js`在您运行一次 Firefox 之前不会存在。*

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-10-02T22:19:29.323

我找到了一种在 Windows 下使用 powershell 执行此操作的更好方法（但实际上只是因为我正在寻找一种脚本更改用户代理字符串的方法，而不是使用代理）。

```
function set-uas
{
    Param
    (
            [string]$UAS = "Default"
    )

    $FirefoxPrefs = "C:\Users\Admin\AppData\Roaming\Mozilla\Firefox\Profiles\*.default\prefs.js"

    if ($UAS -eq "Default")
    {
        $fileinfo = type $FirefoxPrefs
        $fileinfo = $fileinfo | findstr /v "general.appname.override"    
        $fileinfo = $fileinfo | findstr /v "general.appversion.override"
        $fileinfo = $fileinfo | findstr /v "general.platform.override"  
        $fileinfo = $fileinfo | findstr /v "general.useragent.appName"  
        $fileinfo = $fileinfo | findstr /v "general.useragent.override" 
        $fileinfo = $fileinfo | findstr /v "general.useragent.vendor"   
        $fileinfo = $fileinfo | findstr /v "general.useragent.vendorSub"
        $fileinfo += "user_pref(`"useragentswitcher.import.overwrite`", false);`n"
        $fileinfo += "user_pref(`"useragentswitcher.menu.hide`", false);`n"
        $fileinfo += "user_pref(`"useragentswitcher.reset.onclose`", false);`n"
        $fileinfo | Out-File -FilePath $FirefoxPrefs -Encoding ASCII
    }
    else
    {
        set-uas Default
    }

    if ($UAS -eq "iphone")
    {
        $fileinfo = ""
        $fileinfo += "user_pref(`"general.appname.override`", `"Netscape`");`n"
        $fileinfo += "user_pref(`"general.appversion.override`", `"5.0 (iPhone; U; CPU iPhone OS 3_0 like Mac OS X; en-us) AppleWebKit/528.18 (KHTML, like Gecko) Version/4.0 Mobile/7A341 Safari/528.16`");`n"
        $fileinfo += "user_pref(`"general.platform.override`", `"iPhone`");`n"                                                                                                                                      
        $fileinfo += "user_pref(`"general.useragent.appName`", `"Mozilla`");`n"                                                                                                                                     
        $fileinfo += "user_pref(`"general.useragent.override`", `"Mozilla/5.0 (iPhone; U; CPU iPhone OS 3_0 like Mac OS X; en-us) AppleWebKit/528.18 (KHTML, like Gecko) Version/4.0 Mobile/7A341 Safari/528.16`");`n"
        $fileinfo += "user_pref(`"general.useragent.vendor`", `"Apple Computer, Inc.`");`n"                                                                                                                         
        $fileinfo += "user_pref(`"general.useragent.vendorSub`", `"`");`n"                                                                                                                                          
        $fileinfo += "user_pref(`"useragentswitcher.reset.onclose`", false);`n"
        $fileinfo | Out-File -FilePath $FirefoxPrefs -Encoding ASCII -Append
    }
    elseif ($UAS -eq "lumia")
    {
        $fileinfo = ""
        $fileinfo += "user_pref(`"general.appname.override`", `"Netscape`");`n"
        $fileinfo += "user_pref(`"general.appversion.override`", `"9.80 (Windows Phone; Opera Mini/9.0.0/37.6652; U; en) Presto/2.12.423 Version/12.16`");`n"
        $fileinfo += "user_pref(`"general.platform.override`", `"Nokia`");`n"                                                                                                                                       
        $fileinfo += "user_pref(`"general.useragent.appName`", `"Mozilla`");`n"                                                                                                                                     
        $fileinfo += "user_pref(`"general.useragent.override`", `"Opera/9.80 (Windows Phone; Opera Mini/9.0.0/37.6652; U; en) Presto/2.12.423 Version/12.16`");`n"
        $fileinfo += "user_pref(`"general.useragent.vendor`", `"Microsoft`");`n"                                                                                                                            
        $fileinfo += "user_pref(`"general.useragent.vendorSub`", `"`");`n"                                                                                                                                          
        $fileinfo += "user_pref(`"useragentswitcher.reset.onclose`", false);`n"
        $fileinfo | Out-File -FilePath $FirefoxPrefs -Encoding ASCII -Append
    }
} 
```

我还安装了 firefox 插件“useragentswitcher”，没有它还没有测试过。
我还设置了“user_pref("useragentswitcher.reset.onclose", false);"

[编辑] 我已经修改了我的代码，它偶尔会输出一些坏字符或其他东西。由于某种原因，这被 Firefox 检测为损坏的配置文件，并且整个配置文件被丢弃，并使用默认配置文件进行刷新。

此外，应归功于信用：此代码大致基于 xBoarder 在他对 sam3344920 ( [https://stackoverflow.com/a/2509088/5403057](https://stackoverflow.com/a/2509088/5403057) ) 的回复中发布的内容。此外，我能够在 Phoenix14830 ( [https://stackoverflow.com/a/32080395/5403057](https://stackoverflow.com/a/32080395/5403057) )的帖子的帮助下修复编码错误

[Edit2] 添加了对将 UAS 设置为 lumia 的支持。这实际上是在使用 Opera 移动 UAS，因为我仍然希望 bing 工作，如果您使用常规 lumia UAS www.bing.com 重定向到 bing://?%^&* Firefox 不知道如何处理

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-06-20T11:08:20.703

这是对我有用的最终编译解决方案......经过尝试和测试......

# 在 Windows 中通过 cmd 在 Mozilla Firefox 中更改代理设置的步骤

1.  cd /D "%APPDATA%\Mozilla\Firefox\Profiles"
2.  cd *.default

# 用用户定义的设置替换已经存在的代理设置

3.  powershell -Command "(gc prefs.js) -replace 'user_pref(\"network.proxy.http\", \"*已经存在IP* \")\;', 'user_pref(\"network.proxy.http\", \"*你的 http 代理 ip* \");' | 设置内容 prefs.js"
4.  powershell -Command "(gc prefs.js) -replace 'user_pref(\"network.proxy.http_port\",*已经存在的端口*)\;', 'user_pref(\"network.proxy.http_port\",*你的http代理端口*);' | 设置内容 prefs.js"
5.  powershell -Command "(gc prefs.js) -replace 'user_pref(\"network.proxy.share_proxy_settings\",*已经存在的值*)\;', 'user_pref(\"network.proxy.share_proxy_settings\", *true* );' | 设置内容 prefs.js"
6.  powershell -Command "(gc prefs.js) -replace 'user_pref(\"network.proxy.type\",*已经存在的值*)\;', 'user_pref(\"network.proxy.type\", *1* );' | 设置内容 prefs.js"

    # 0 - 无代理

    # 1 - 手动代理配置

    # 4 - 自动检测代理设置

    # 5 - 使用系统设置（默认）

7.  cd %windir%

# 检查已经存在的代理设置

8.  cd C:\Users\{用户名}\AppData\Roaming\Mozilla\Firefox\Profiles\sat2m7dr.default\
9.  查找 /i "network.proxy" prefs.js

# 使用您定义的代理设置从 CMD 启动 Firefox

12.  cd C:\程序文件\
13.  cd "Mozilla 火狐"
14.  firefox.exe -ProfileManager
15.  从列表中选择default（默认选择default-release），然后单击ok。

注意：您可能不必再次运行第 14 步。相反，您可以直接运行 firefox.exe

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-10-13T10:59:47.580

```
@echo off
color 1F

cd /D "%APPDATA%\Mozilla\Firefox\Profiles"
cd *.default 
set ffile=%cd%
cd %ffile%
echo user_pref("network.proxy.http", "192.168.1.235 ");>>"prefs.js" 
echo user_pref("network.proxy.http_port", 80);>>"prefs.js" 
echo user_pref("network.proxy.type", 1);>>"prefs.js" 
set ffile=
cd %windir% 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-01-29T02:17:00.453

对于最新的 Firefox，您必须更改

```
cd *.default 
```

至

```
cd *.default* 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-09T13:48:45.810

我认为没有直接的方法来设置代理（在 Windows 上）。

但是，您可以安装像 FoxyProxy 这样的附加组件，为不同的代理创建多个配置，然后在启动 FireFox 之前将适当的配置移动到 FireFox 配置文件中的正确文件夹（使用批处理文件）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-08-06T06:29:08.160

非常感谢，我在这个网站上找到了答案。

这里我指的是一个cmd文件的制作

通过 minimo

```
cd /D "%APPDATA%\Mozilla\Firefox\Profiles"
cd *.default
set ffile=%cd%
echo user_pref("network.proxy.http", "192.168.1.235 ");>>"%ffile%\prefs.js"
echo user_pref("network.proxy.http_port", 80);>>"%ffile%\prefs.js"
echo user_pref("network.proxy.type", 1);>>"%ffile%\prefs.js"
set ffile=
cd %windir% 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-08-01T14:05:02.423

您也可以使用我编写的这个 Powershell 脚本来执行此操作，以及所有其他 Firefox 设置。

[https://bitbucket.org/remyservices/powershell-firefoxpref/wiki/Home](https://bitbucket.org/remyservices/powershell-firefoxpref/wiki/Home)

使用它，您可以使用计算机启动和用户登录脚本轻松管理 Firefox。有关如何使用它的说明，请参阅 wiki 页面。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-03-13T17:17:43.660

user.js 更适合自定义，因为您可以只包含您想要操作的行，即您可以覆盖整个文件，而不是 find-replace。此外，prefs.js（至少在 Firefox 65.0.1 for Mac 上）以警告开头：

```
// DO NOT EDIT THIS FILE.
//
// If you make changes to this file while the application is running,
// the changes will be overwritten when the application exits.
//
// To change a preference value, you can either:
// - modify it via the UI (e.g. via about:config in the browser); or
// - set it within a user.js file in your profile. 
```

在我的情况下，user.js 不存在，所以我创建了它并包含在“无代理”和“手动代理配置”之间切换的行（我一直只使用一个 SOCKS 代理，所以不需要更改端口号或任何其他详细信息，只需在以下行中将 0 翻转为 1）：

`user_pref("network.proxy.type", 1);`

我最终得到了一个放在 /usr/local/bin/firefox 的 bash 脚本：

```
#!/bin/bash
if [ $# -eq 0 ]; then
  echo 'user_pref("network.proxy.type", 0);' > ~/Library/Application\ Support/Firefox/Profiles/t5rvw47o.default/user.js
  open -a Firefox
else
  case $1 in
    vpn)
      echo 'user_pref("network.proxy.type", 1);' > ~/Library/Application\ Support/Firefox/Profiles/t5rvw47o.default/user.js
      open -a Firefox
  esac 
fi 
```

要使用它，我确保没有 Firefox 正在运行，然后运行`firefox`以建立直接连接并`firefox vpn`使用代理。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2019-04-13T04:25:45.083

你好我得到了完美的鳕鱼使用这个代码

cd /D "%APPDATA%\Mozilla\Firefox\Profiles"

cd *.default

设置 ffile=%cd%

echo user_pref("network.proxy.http", "127.0.0.1"); >>prefs.js

echo user_pref("network.proxy.http_port", 8080); >>prefs.js

设置 ffile=

cd %windir

* * *

## 回答 #19

> 赞同：-5
> 
> 时间：2009-05-09T13:38:20.100

火狐？我不认为你可以。IE 是另一回事。

# visual-studio-2008 - 在 Visual Studio 2008 中从文件中读取输入

> ID：843342
> 
> 赞同：5
> 
> 时间：2009-05-09T13:36:27.320
> 
> 标签：visual-studio-2008, file-io

有没有办法模拟：`yourprogram < inputFile.txt`在 Visual Studio 2008 中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-09T13:46:06.200

当您开发了您的应用程序（例如 ConsoleApplication）后，您通常会从命令行启动它

```
ConsoleApplication1.exe < inputfile.txt 
```

命令的一部分 `< inputfile.txt`是应用程序的命令行参数。

您可以在项目属性中设置这些

*   右键单击项目文件
*   点击`properties`
*   单击`Debug`选项卡
*   在开始选项部分输入

    ```
    < Path/To/inputfile.txt 
    ```

当您下次使用调试器启动应用程序时，它将使用这些命令行参数执行您的应用程序

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-10-02T15:56:53.950

*   在顶部的菜单中单击项目，然后单击属性（底部选项）
*   在“属性页”窗口中，展开左侧的“配置属性”
*   选择左侧的“调试”
*   在右侧的“命令参数”字段中，键入“< inputFile.txt”

当您执行此操作时，请注意在“属性页”窗口顶部您已选择当前配置和平台。因此，如果您更改配置（例如从“调试”到“发布”），突然这些选项不适用，您将不得不返回此属性窗口为该配置/平台设置这些配置。

此外，这似乎只适用于使用“开始而不调试”（F5）而不是使用“开始调试”（Ctrl + F5）时。我认为有一些方法可以让输入文件使用 Ctrl+F5 工作，但我还没有找到它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T13:40:31.333

Visual Studio 是 IDE（= 修饰编辑器），而不是编程语言。您使用什么语言/环境？

以上导致文件`inputFile.txt`被流式传输到程序的标准输入流中。所有语言都提供了不同的机制来访问这个流并从中读取。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T13:44:52.533

假设您要阅读`stdin`，您应该看一眼[OpenStandardInput](http://msdn.microsoft.com/en-us/library/system.console.openstandardinput(VS.71).aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-26T16:04:36.260

我只是发现如何使它与 Ctrl + F5 一起工作。只需将 inputFile.txt 放在项目的 .exe 的同一文件夹中

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T15:48:19.593

我可以在项目属性中（至少）为您提供 C++ 的答案：配置属性 -> 在命令参数中调试：inputfile.txt 并确保工作目录与文件所在的目录相同

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-11T05:38:44.847

将测试数据输入文件保存在存在 *.cpp 文件的项目工作目录中右键单击项目->属性->配置属性->调试

在调试中，单击命令参数选项卡并添加以下行

< Your_project_directory_path\input.txt

# java - 为什么我在 Java 中会出现此编译错误？

> ID：843349
> 
> 赞同：2
> 
> 时间：2009-05-09T13:39:44.670
> 
> 标签：java, sorting, compiler-errors

我收到以下错误：

```
quicksort(int[],int,int)cannot be applied to(int[]) 
```

当我编译这个：

```
import java.util.*;

public class Sort {

public static void main(String[] args){

Random rand = new Random();
int[] tab = new int[10];

for(int i = 0; i < tab.length; i++) {
tab[i] = rand.nextInt(100);

System.out.println("Before: ");
show(tab);

quicksort (tab);
System.out.println("After: ");
show(tab);
  }
}
static void quicksort(int tab[], int x, int y) {

        int i,j,v,temp;

        i=x;
        j=y;
        v=tab[(x+y) / 2];
        do {
            while (tab[i]<v) 
                i++;
            while (v<tab[j]) 
                j--;
            if (i<=j) {
                temp=tab[i];
                tab[i]=tab[j];
                tab[j]=temp;
                i++;
                j--;
            }
        }
        while (i<=j);
        if (x<j) 
            quicksort(tab,x,j);
        if (i<y) 
            quicksort(tab,i,y);
    }

static void show (int tab[]) {
for (int i = 0; i <tab.length; i++) {
System.out.println(tab[i]);

  }
 }
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-09T13:44:44.967

在打印出“之前”的行之后，您有：

```
quicksort (tab); 
```

您设计的函数需要三个参数。您可以添加额外的参数：

```
quicksort (tab, 0, tab.length - 1) 
```

或者添加一个新功能，例如：

```
public quicksort(int[]) {
  quicksort(tab, 0, tab.length - 1);
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-09T13:42:51.800

您定义的函数“快速排序”要求 3 个参数，但您只提供一个。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-09T13:43:56.090

因为您的快速排序函数有 3 个参数，但您的调用只给出了一个。

编辑：第二个:(

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T13:44:05.327

你的代码应该调用

```
quicksort (tab,0,10); 
```

在您的外部调用中，您可以对列表进行排序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T15:21:28.417

在不知道您在用什么编写代码的情况下，如果您还没有采用 IDE，我强烈建议您使用 IDE。特别是用于 Java 的[Eclipse 。](http://www.eclipse.org/downloads/packages/compare-packages)

Eclipse 会强调有问题的代码行并向您提出一些建议（除了提供代码完成之外）。文本编辑器，如 JEdit 没有。

注意：有人告诉我 IntelliJ 很好，但你无法击败 Eclipse 的价格（免费）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-09T14:16:05.580

顺便说一句：您可以只使用内置函数 Arrays.sort() 。在现实生活中你不会写这样的函数。（仅作为作业）

# windows-mobile - Windows Mobile掌上电脑如何静音| 取消静音（麦克风）

> ID：843353
> 
> 赞同：1
> 
> 时间：2009-05-09T13:43:00.007
> 
> 标签：windows-mobile

我怎么能静音 | 以编程方式取消静音 Windows 移动袖珍电脑设备（我正在使用符号 MC70）？我需要使用什么 API？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T13:57:05.107

尝试使用[waveOutSetVolume](http://msdn.microsoft.com/en-us/library/aa908146.aspx)。
**编辑：**也检查这个[链接](http://www.pocketpcdn.com/articles/soundvolume.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T14:08:32.120

您的设备运行 Windows Mobile 5。从那里您需要查看[Hardware Audio Mixer](http://msdn.microsoft.com/en-us/library/ms923403.aspx)，它看起来像是用于在设备上设置/控制音频属性的正确 API。

# hibernate - 从休眠多对多关系中检索数据时出现问题

> ID：843354
> 
> 赞同：0
> 
> 时间：2009-05-09T13:43:03.890
> 
> 标签：hibernate, orm

我有两个具有多对多关系的表，当我将 findbyall 方法应用于该表时，它将多次检索一条记录（也就是说，该表将显示该特定表的记录，因为与其他表有不同的关系）所以我怎样才能只显示每条记录一次。预先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T13:55:42.610

将“不同”转换器添加到您的 Criteria 对象，如下所示： crit.setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY);

# xslt - XSLT 字符转义查询

> ID：843363
> 
> 赞同：1
> 
> 时间：2009-05-09T13:49:25.747
> 
> 标签：xslt

假设我在下面有以下代码片段，我如何也将禁用输出转义应用于标题属性中的 {name}？

```
<a title="{name}"><xsl:value-of select="name" disable-output-escaping="yes" /></a> 
```

这真的让我很难过。

多谢你们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T17:13:42.853

这不能用 XSLT 完成。[规范](http://www.w3.org/TR/xslt#disable-output-escaping)说：

> 对于用于结果树中文本节点以外的其他内容的文本节点，禁用输出转义是错误的。

因此，使用 Attribute Value Templates 或`xsl:attribute`with没有区别`xsl:value-of`，因为您生成的是属性节点，而不是文本节点。这是语言的限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T13:53:37.993

你不能照原样。{name} 快捷方式不允许附加参数。请改用 <xsl:attribute> 标记。

# c# - 您最喜欢的自定义扩展方法是什么？

> ID：843367
> 
> 赞同：6
> 
> 时间：2009-05-09T13:53:18.257
> 
> 标签：c#, .net, extension-methods

### 复制：

> [发布 C# .Net 的扩展好东西 (codeplex.com/extensionoverflow)](https://stackoverflow.com/questions/271398/post-your-extension-goodies-for-c-net-codeplex-com-extensionoverflow)

* * *

让我们创建一个您最喜欢的扩展方法列表。要使其符合条件，它应该是您经常使用的扩展方法，并且通过优雅、聪明、强大或非常酷来使编码更容易。

我将从我最喜欢的 3 个扩展方法开始，我觉得它们很优雅并且一直在使用（我省略了检查参数是否有效的代码以保持简短）：

# 1: String.FormatWith(...)

```
public static string FormatWith(this string text, params object[] values) {
    return String.Format(text, values);
} 
```

所以不必写

```
String.Format("Some text with placeholders: {0}, {1}", "Item 1", "Item 2"); 
```

你可以写

```
"Some text with placeholders: {0}, {1}".FormatWith("Item 1", "Item 2"); 
```

# 2：对象.To()

```
public static T To<T>(this object obj) {
    return (T) obj;
} 
```

所以不必写

```
object o = 5; //integer as object
string value = ((int)o).ToString(); //get integer value as string
int number = (int) o; 
```

你可以写

```
object o = 5; //integer as object
string value = o.To<int>().ToString();
int number = o.To<int>(); 
```

# 3：IEnumerable.Apply（动作动作）

```
public static void Apply<T>(this IEnumerable<T> enumerable, Action<T> action) {
    foreach (T item in enumerable) action(item);
} 
```

所以不必写

```
private void PrintNumbers(int number) { Debug.WriteLine(number); }

int[] numbers = new []{ 1, 2, 3, 4, 5};
foreach (int number in numbers)
   WriteLine(number); 
```

你可以写

```
private void PrintNumbers(int number) { Debug.WriteLine(number); }

int[] numbers = new int[] { 1, 2, 3, 4, 5};
numbers.Apply(PrintNumbers) 
```

# objective-c - 如何使用复选框打开和关闭菜单栏中的状态项？

> ID：843379
> 
> 赞同：0
> 
> 时间：2009-05-09T14:02:50.970
> 
> 标签：objective-c, cocoa

我已经为菜单栏创建了一个状态项，但我想添加一个复选框以使其能够打开和关闭。

因此，选中复选框后，将显示状态项，并且未显示未检查复选框时。

我需要什么代码来做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-09T15:25:30.143

首先在你的控制器类中创建一个实例变量来保存对这个项目的引用：

```
NSStatusItem *item; 
```

然后创建一个方法来创建这个状态项，当该框被选中时：

```
- (BOOL)createStatusItem
{
NSStatusBar *bar = [NSStatusBar systemStatusBar];

//Replace NSVariableStatusItemLength with NSSquareStatusItemLength if you
//want the item to be square
item = [bar statusItemWithLength:NSVariableStatusItemLength];

if(!item)
  return NO;

//As noted in the docs, the item must be retained as the receiver does not 
//retain the item, so otherwise will be deallocated
[item retain];

//Set the properties of the item
[item setTitle:@"MenuItem"];
[item setHighlightMode:YES];

//If you want a menu to be shown when the user clicks on the item
[item setMenu:menu]; //Assuming 'menu' is a pointer to an NSMenu instance

return YES;
} 
```

然后创建一个方法以在未选中该项目时将其删除：

```
- (void)removeStatusItem
{
NSStatusBar *bar = [NSStatusBar systemStatusBar];
[bar removeStatusItem:item];
[item release];
} 
```

现在通过创建一个在复选框被切换时调用的操作将它们联系在一起：

```
- (IBAction)toggleStatusItem:(id)sender
{
BOOL checked = [sender state];

if(checked) {
  BOOL createItem = [self createStatusItem];
  if(!createItem) {
    //Throw an error
    [sender setState:NO];
  }
}
else
  [self removeStatusItem];
} 
```

然后在 IB 中创建复选框并将操作设置为您的`toggleStatusItem:`方法；确保未选中该复选框。

**编辑（响应错误）** 如前所述，你需要在你放置了和方法`NSStatusItem`的类的接口中声明；这成为实例变量而不是方法本地变量的原因是，无法检索指向已添加到 Apple 菜单状态栏中的项目的指针，并且无法删除该项目一次该复选框未选中，您必须存储指向该项目的指针。这也将解决您的第三个错误。`createStatusItem``removeStatusItem``createStatusItem`

针对您的第二个错误，我只是在演示，如果您想在单击状态项时向其添加菜单，则必须自己添加代码，检索指向`NSMenu`;的指针。我正在展示如何将此菜单项添加到状态栏项，如果您的指针被调用`menu`，因此我在代码行旁边的注释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T14:17:23.940

获取要切换的按钮的出口，然后创建复选框指向的操作方法，该方法根据复选框状态切换原始按钮的隐藏属性。

# django - Django 实例前的 HAProxy 负载均衡器

> ID：843382
> 
> 赞同：3
> 
> 时间：2009-05-09T14:05:55.257
> 
> 标签：django

我想要 haproxy 缓存/重定向我的 django 实例的 /static/.+ url 路径以加快静态文件服务。最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-11T01:22:30.217

据我所知，HAProxy 不做缓存。为此，您需要像 Squid 这样的东西。

至于单独处理 /static/ ，您可以设置 HAProxy 配置以将任何匹配模式的 URL 重定向到另一个后端集群：

```
frontend my_website *:80
    mode http
    acl static url_beg /static/
    use_backend my_static_proxy if static
    default_backend my_django_server 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-02-11T20:59:14.810

你可能想试试清漆而不是鱿鱼。它更加灵活并且具有更新的设计，您应该阅读 [http://www.varnish-cache.org/trac/wiki/ArchitectNotes](http://www.varnish-cache.org/trac/wiki/ArchitectNotes)

# python - 为什么 django 给出错误：没有名为 django.core 的模块？

> ID：843383
> 
> 赞同：6
> 
> 时间：2009-05-09T14:06:16.367
> 
> 标签：python, windows, django, django-admin

当我尝试创建一个项目时，我得到了有问题的错误。我按照[如何在 windows vista 中安装 python 和 django 中](http://i.justrealized.com/2008/04/08/how-to-install-python-and-django-in-windows-vista/)的说明进行操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T15:52:07.930

还要确保您有权访问所有 django 的文件。我之前已经看到由于权限问题而发生此类错误。

**编辑**：我还没有尝试过，但是该页面上有一个指向[Instant Django](http://www.instantdjango.com/)的链接，看起来很容易设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-31T16:09:14.240

您可以通过提供 django-admin.py 文件的完整路径来解决此问题

```
python c:\python25\scripts\django-admin.py startproject mysite 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T15:26:58.890

很可能您的 Python 路径上没有 Django。要进行测试，请快速启动 Python 并运行：

```
>>> import django 
```

如果失败了，只需让 Django 进入你的 Python 路径即可。要么设置环境变量，要么将 django 移动到`python2x/Lib/site-packages`目录中。如果它确实有效，请尝试导入`core`. 如果在那里失败，那么您的 Django 安装可能有问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T18:32:36.733

从您的命令行 ( `cmd`) 运行“ftype Python.File”并确保您的 .py 文件正在由正确版本/安装的 Python 执行。

可能是另一个应用程序在后台偷偷改变了这一点。

# delphi - 什么时候应该在 Delphi 中使用增强的记录类型而不是类？

> ID：843387
> 
> 赞同：16
> 
> 时间：2009-05-09T14:10:22.777
> 
> 标签：delphi, oop, class, record, delphi-2006

[Delphi 2006](https://stackoverflow.com/questions/830168/when-were-extended-records-introduced)为记录引入了新功能，使它们更加“面向对象”。

在哪些情况下，记录类型比类类型更适合设计？使用这些记录类型有什么优势？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-09T17:45:13.903

你有记录、对象和类。

记录从 turbo pascal 1 开始可用。它们是轻量级的，能够具有属性和方法，但它们不支持继承，返回记录的函数存在一些问题。如果这些记录有方法，这有时会产生内部错误：

```
type
  TRec = record 
    function Method1: Integer;
  end;

function Func: TRec;

procedure Test;
var
  x : TRec;

begin
  Func.Method1; // Sometimes crashes the compiler
  // Circumvention:
  x := Func;
  x.Method1; // Works
end; 
```

如果我是正确的，对象是用 turbo pascal 5 引入的。然后他们为 OO 提供了一种使用 pascal 的方法。随着 Delphi 的引入，它们或多或少地被弃用了，但您仍然可以使用它们。对象可以实现接口。

Delphi 1 和最通用的类​​引入了类。它们实现接口并支持继承。但是每个类变量都是一个隐藏指针。这意味着需要在堆上创建类。幸运的是，这个过程大部分是隐藏的。

下表列出了三者之间的差异。我添加了完成的界面。

```
 |Class|Object|Record|Interface|
------------------|-----------------------------|
Are pointers?     |  y  |  n   |  n   |    y    |
Inheritance       |  y  |  y   |  n   |    y    |
Helpers           |  y  |  n   |  y   |    n    |
Impl. Interface   |  y  |  y   |  n   |    -    |
Visibility        |  y  |  y   |  n   |    n    |
Method            |  y  |  y   |  y   |    y    |
Fields            |  y  |  y   |  y   |    n    | 
Properties        |  y  |  y   |  y   |    y    |
Consts            |  y  |  y   |  y   |    n    |
Types             |  y  |  y   |  y   |    n    |
Variants          |  n  |  n   |  y   |    n    |
Virtual           |  y  |  n   |  y   |    -    |
------------------|-----------------------------| 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-09T14:55:31.373

我认为这些功能在 Delphi 8 和 2005 中也可用。

主要准则：如果您有疑问，请使用课程。

对于其余部分，您必须了解主要区别：类对象始终通过引用使用，并通过调用构造函数创建。

Records 的内存管理和分配与基本类型（即整数、双精度）相同。这意味着它们按值传递给方法（除非使用 var）。此外，您不需要 Free 记录，这就是它们支持运算符重载的原因。但是没有继承或虚拟方法等。新记录可以有一个构造函数，但它的使用是可选的。

使用记录的主要领域和标准：

*   在处理来自 Win32 API 的结构时

*   当类型没有身份时（因为分配意味着复制）

*   当实例不是太大时（复制大记录变得昂贵）

*   在构建值类型时，其行为应模仿数字类型。例如日期时间、复数、向量等。然后运算符重载是一个不错的功能，但不要将其作为决定因素。

在效率方面，不要过度这样做：

*   对于您经常放入数组的较小类型。

最后，从早期版本的 Delphi 中，使用类或记录的规则并没有真正改变。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-09T15:54:26.287

除了其他答案（运算符重载、轻量级值类型）之外，让您的枚举器记录而不是类是一个好主意。由于它们是在堆栈上分配的，因此无需构造和销毁它们，这也消除了编译器在类类型枚举器周围放置的隐藏 try..finally 块的需要。

有关更多信息，请参阅[http://hallvards.blogspot.com/2007/10/more-fun-with-enumerators.html](http://hallvards.blogspot.com/2007/10/more-fun-with-enumerators.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T14:51:39.457

您可以使用[运算符重载](http://edn.embarcadero.com/article/34324)（如隐式转换）。您也可以在 Delphi 2007+ 或 2006.NET 上对对象执行此操作，但仅限于 2006 win32 上的这些记录。

# mfc - iPod 交互

> ID：843388
> 
> 赞同：2
> 
> 时间：2009-05-09T14:10:51.933
> 
> 标签：mfc

假设我想编写一个 Windows 应用程序，我想在其中将一些文件传输到我连接的 iPod 设备或任何其他 MP3 播放器。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T14:15:53.227

看看这个图书馆。 [http://libipod.sourceforge.net/](http://libipod.sourceforge.net/)

# c++ - 实践中的 Pimpl 成语

> ID：843389
> 
> 赞同：49
> 
> 时间：2009-05-09T14:10:55.630
> 
> 标签：c++, pimpl-idiom

*关于pimpl idiom*有一些关于 SO 的问题，但我更好奇它在实践中的使用频率。

我知道在性能和封装之间存在一些权衡，以及由于额外的重定向而导致的一些调试烦恼。

有了这个，这是应该在每个班级还是全有或全无的基础上采用的东西？这是最佳实践还是个人偏好？

我意识到这有点主观，所以让我列出我的首要任务：

*   代码清晰
*   代码可维护性
*   表现

我总是假设我需要在某个时候将我的代码公开为一个库，所以这也是一个考虑因素。

**编辑：**完成同样事情的任何其他选项都是受欢迎的建议。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-09T14:25:50.067

我想说的是，你是按班级做还是在全有或全无的基础上做这件事，取决于你首先选择 pimpl 成语的原因。在建立图书馆时，我的原因是以下之一：

*   想要隐藏实施以避免泄露信息（是的，这不是 FOSS 项目 :)
*   想要隐藏实现以减少客户端代码的依赖。如果您构建一个共享库 (DLL)，您可以更改您的 pimpl 类，甚至无需重新编译应用程序。
*   希望减少使用库编译类所需的时间。
*   想要修复命名空间冲突（或类似的）。

这些原因都没有提示采用全有或全无的方法。在第一种情况下，您只需要隐藏您想要隐藏的内容，而在第二种情况下，对于您希望更改的类，这样做可能就足够了。同样由于第三和第四个原因，只有隐藏重要的成员才能受益，这些成员又需要额外的标头（例如，第三方库，甚至 STL）。

无论如何，我的观点是我通常不会发现这样的东西太有用：

```
class Point {
  public:      
    Point(double x, double y);
    Point(const Point& src);
    ~Point();
    Point& operator= (const Point& rhs);

    void setX(double x);
    void setY(double y);
    double getX() const;
    double getY() const;

  private:
    class PointImpl;
    PointImpl* pimpl;
} 
```

在这种情况下，权衡开始打击你，因为需要取消引用指针，并且不能内联方法。但是，如果您只为非平凡的类执行此操作，那么通常可以容忍轻微的开销而不会出现任何问题。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-09T14:34:01.913

pimpl ideom 的最大用途之一是创建稳定的 C++ ABI。几乎**每个**Qt 类都使用类似于 pimpl 的“D”指针。这允许在不破坏 ABI 的情况下执行更简单的更改。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-09T14:54:08.643

## 代码清晰度

代码清晰度是非常主观的，但在我看来，具有单个数据成员的标头比具有许多数据成员的标头更具可读性。然而，实现文件比较嘈杂，因此那里的清晰度降低了。如果该类是基类，主要由派生类使用而不是维护，这可能不是问题。

## 可维护性

为了 pimpl'd 类的可维护性，我个人发现在数据成员的每次访问中额外的取消引用是乏味的。如果数据纯粹是私有的，访问器将无济于事，因为无论如何您都不应该为它公开访问器或修改器，并且您会被不断取消引用 pimpl 所困扰。

对于派生类的可维护性，我发现这个习惯用法在所有情况下都是一个纯粹的胜利，因为头文件列出了更少的不相关细节。所有客户端编译单元的编译时间也得到了改善。

## 表现

性能损失在许多情况下很小，在少数情况下很重要。从长远来看，它是虚函数性能损失的数量级。我们正在讨论每个数据成员每次访问的额外取消引用，加上 pimpl 的动态内存分配，以及销毁时内存的释放。如果 pimpl'd 类不经常访问其数据成员，则 pimpl'd 类的对象经常被创建并且是短暂的，那么动态分配可能会超过额外的取消引用。

## 决定

我认为性能至关重要的类，例如一个额外的取消引用或内存分配会产生重大影响，无论如何都不应该使用 pimpl。如果编译时间显着改善，那么性能下降并不显着且头文件广泛#include'd 的基类可能应该使用 pimpl。如果编译时间没有减少，则取决于您的代码清晰度。

对于所有其他情况，这纯粹是口味问题。在做出决定之前尝试一下并测量运行时性能和编译时性能。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-09T14:29:58.407

pImpl 在您使用强异常保证来实现 std::swap 和 operator= 时非常有用。我倾向于说，如果你的班级支持其中任何一个，并且有多个非平凡的领域，那么它通常不再取决于偏好。

否则，它是关于您希望客户端通过头文件绑定到实现的紧密程度。如果二进制不兼容的更改不是问题，那么您可能不会在可维护性方面受益匪浅，尽管如果编译速度成为问题，通常会节省很多。

性能成本可能与内联损失有关，而不是与间接有关，但这是一个疯狂的猜测。

您可以随时添加 pImpl，并声明从今天起客户端不必因为您添加了私有字段而重新编译。

因此，这一切都不是一种全有或全无的方法。你可以有选择地为它给你带来好处的课程做它，而不是为那些它没有好处的课程做它，然后改变你的想法。例如，将迭代器实现为 pImpl 听起来像是设计太多......

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-09T14:25:48.863

这个习惯用法对大型项目的编译时间有很大帮助。

[外部链接](http://c2.com/cgi-bin/wiki?PimplIdiom)

[这个也不错](http://www.gotw.ca/gotw/024.htm)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-09T14:26:40.767

当我想避免头文件污染我的代码库时，我通常会使用它。Windows.h 就是一个完美的例子。它表现得如此糟糕，我宁愿自杀也不愿让它随处可见。因此，假设您想要一个基于类的 API，将其隐藏在 pimpl 类之后可以巧妙地解决问题。（如果您满足于只公开单个函数，则可以直接声明这些函数，当然，无需将它们放入 pimpl 类）

我不会在任何地方都使用 pimpl *，*部分原因是性能受到影响，部分原因是它需要大量额外的工作才能获得通常很小的好处。它为您提供的主要内容是实现和接口之间的隔离。通常，这不是一个非常高的优先级。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-09T14:31:10.810

我在我自己的库中的几个地方使用了这个习惯用法，在这两种情况下，都是为了将​​接口与实现清晰地分开。例如，我有一个在 .h 文件中完全声明的 XML 阅读器类，它具有一个 RealXMLReader 类的 PIMPL，该类在非公共 .h 和 .cpp 文件中声明和定义。RealXMlReader 反过来又是我使用的 XML 解析器（目前是 Expat）的便利包装器。

这种安排让我将来可以从 Expat 更改为另一个 XML 解析器，而无需重新编译所有客户端代码（当然我仍然需要重新链接）。

请注意，我这样做不是出于编译时性能的原因，只是为了方便。有一些 PIMPL fabnatics 坚持认为，任何包含三个以上文件的项目都将无法编译，除非您始终使用 PIMPL。值得注意的是，这些人从来没有拿出任何实际证据，只是模糊地提到了“Latkos”和“exponential time”。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-02-23T12:19:38.023

当我们有 r-value 语义时，pImpl 将工作得最好。

pImpl 的“替代方案”，也将实现隐藏实现细节，是使用抽象基类并将实现放在派生类中。用户调用某种“工厂”方法来创建实例，并且通常会使用指向抽象类的指针（可能是共享的）。

pImpl 背后的基本原理可以是：

*   保存在 v-table 上。是的，但是您的编译器会内联所有转发，并且您真的会保存任何东西。
*   如果您的模块包含多个彼此详细了解的类，尽管您将其隐藏在外部世界中。

pImpl 的容器类的语义可能是： - 不可复制，不可分配......所以你在构造时“新建”你的 pImpl，在销毁时“删除” - 共享。所以你有 shared_ptr 而不是 Impl*

使用 shared_ptr，只要类在析构函数处是完整的，就可以使用前向声明。即使是默认的（可能是），也应该定义您的析构函数。

*   可交换。您可以实现“可能为空”并实现“交换”。用户可以创建一个实例，并通过一个“交换”向它传递一个非常量引用来填充它。

*   2阶段建设。你构造一个空的然后在它上面调用“load()”来填充它。

shared 是唯一一个没有 r-value 语义的我什至偏爱的人。有了它们，我们还可以正确实现不可复制不可分配。我喜欢能够调用一个给我的函数。

然而，我发现我现在更倾向于使用抽象基类而不是 pImpl，即使只有一个实现也是如此。

# python - Python：从 urllib2.urlopen 调用中获取 HTTP 标头？

> ID：843392
> 
> 赞同：51
> 
> 时间：2009-05-09T14:11:51.417
> 
> 标签：python, urllib, forwarding

拨打电话 时是否`urllib2`获取整个页面？`urlopen`

我想只阅读 HTTP 响应标头而不获取页面。看起来像是`urllib2`打开了 HTTP 连接，然后获得了实际的 HTML 页面......或者它只是开始通过`urlopen`调用缓冲页面？

```
import urllib2
myurl = 'http://www.kidsidebyside.org/2009/05/come-and-draw-the-circle-of-unity-with-us/'
page = urllib2.urlopen(myurl) // open connection, get headers

html = page.readlines()  // stream page 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-10-29T00:17:31.327

使用`response.info()`方法获取标题。

来自[urllib2 文档](https://docs.python.org/2/library/urllib2.html)：

> urllib2.urlopen(url[, 数据][, 超时])
> 
> ...
> 
> 这个函数返回一个类似文件的对象，它有两个额外的方法：
> 
> *   geturl() — 返回检索到的资源的 URL，通常用于确定是否遵循了重定向
> *   info() — 以 httplib.HTTPMessage 实例的形式返回页面的元信息，例如标题（请参阅 HTTP 标题快速参考）

因此，对于您的示例，请尝试逐步`response.info().headers`查看您正在寻找的结果。

请注意，使用 httplib.HTTPMessage 的主要警告记录在[python 问题 4773](http://bugs.python.org/issue4773)中。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-05-09T14:17:34.550

发送 HEAD 请求而不是普通的 GET 请求怎么样。以下剪辑（从类似[问题](https://stackoverflow.com/questions/107405/how-do-you-send-a-head-http-request-in-python)复制）正是这样做的。

```
>>> import httplib
>>> conn = httplib.HTTPConnection("www.google.com")
>>> conn.request("HEAD", "/index.html")
>>> res = conn.getresponse()
>>> print res.status, res.reason
200 OK
>>> print res.getheaders()
[('content-length', '0'), ('expires', '-1'), ('server', 'gws'), ('cache-control', 'private, max-age=0'), ('date', 'Sat, 20 Sep 2008 06:43:36 GMT'), ('content-type', 'text/html; charset=ISO-8859-1')] 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-02-19T14:27:46.290

实际上，似乎 urllib2 可以执行 HTTP HEAD 请求。

上面@reto 链接到的[问题](https://stackoverflow.com/questions/107405/how-do-you-send-a-head-http-request-in-python)显示了如何让 urllib2 执行 HEAD 请求。

这是我的看法：

```
import urllib2

# Derive from Request class and override get_method to allow a HEAD request.
class HeadRequest(urllib2.Request):
    def get_method(self):
        return "HEAD"

myurl = 'http://bit.ly/doFeT'
request = HeadRequest(myurl)

try:
    response = urllib2.urlopen(request)
    response_headers = response.info()

    # This will just display all the dictionary key-value pairs.  Replace this
    # line with something useful.
    response_headers.dict

except urllib2.HTTPError, e:
    # Prints the HTTP Status code of the response but only if there was a 
    # problem.
    print ("Error code: %s" % e.code) 
```

如果您使用 Wireshark 网络协议分析器之类的工具进行检查，您会发现它实际上是在发送 HEAD 请求，而不是 GET。

这是上面代码中的 HTTP 请求和响应，由 Wireshark 捕获：

> HEAD /doFeT HTTP/1.1
> 接受编码：身份
> 主机：bit.ly
> 连接：关闭
> 用户代理：Python-urllib/2.7
> 
> HTTP/1.1 301 移动
> 服务器：nginx
> 日期：2012 年 2 月 19 日星期日 13:20:56 GMT
> 内容类型：text/html；charset=utf-8
> 缓存控制：私有；max-age=90
> 位置： [http](http://www.kidsidebyside.org/?p=445)
> ://www.kidsidebyside.org/?p=445 MIME 版本：1.0
> 内容长度：127
> 连接：关闭
> Set-Cookie：_bit=4f40f738-00153-02ed0-421cf10a;domain= .bit.ly;expires=2012 年 8 月 17 日星期五 13:20:56;路径=/; HttpOnly

但是，正如另一个问题的其中一条评论中所提到的，如果有问题的 URL 包含重定向，那么 urllib2 将向目标发出 GET 请求，而不是 HEAD。如果您真的只想发出 HEAD 请求，这可能是一个主要缺点。

上面的请求涉及重定向。这是 Wireshark 捕获的对目的地的请求：

> GET /2009/05/come-and-draw-the-circle-of-unity-with-us/ HTTP/1.1
> 接受编码：身份
> 主机：www.kidsidebyside.org
> 连接：关闭
> 用户代理：Python-urllib/ 2.7

使用 urllib2 的替代方法是使用 Joe Gregorio 的[httplib2](http://code.google.com/p/httplib2/ "httplib2")库：

```
import httplib2

url = "http://bit.ly/doFeT"
http_interface = httplib2.Http()

try:
    response, content = http_interface.request(url, method="HEAD")
    print ("Response status: %d - %s" % (response.status, response.reason))

    # This will just display all the dictionary key-value pairs.  Replace this
    # line with something useful.
    response.__dict__

except httplib2.ServerNotFoundError, e:
    print (e.message) 
```

这具有对初始 HTTP 请求和重定向到目标 URL 的请求都使用 HEAD 请求的优点。

这是第一个请求：

> HEAD /doFeT HTTP/1.1
> 主机：bit.ly
> 接受编码：gzip，放气
> 用户代理：Python-httplib2/0.7.2 (gzip)

这是到目的地的第二个请求：

> HEAD /2009/05/come-and-draw-the-circle-of-unity-with-us/ HTTP/1.1
> 主机：www.kidsidebyside.org
> 接受编码：gzip，放气
> 用户代理：Python-httplib2/0.7 .2 (gzip)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-09T14:18:33.533

urllib2.urlopen 执行 HTTP GET（或 POST，如果您提供数据参数），而不是 HTTP HEAD（如果它执行后者，您当然不能对页面正文执行 readlines 或其他访问）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-03-30T08:11:23.743

单线：

```
$ python -c "import urllib2; print urllib2.build_opener(urllib2.HTTPHandler(debuglevel=1)).open(urllib2.Request('http://google.com'))" 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-07-28T09:25:02.920

```
def _GetHtmlPage(self, addr):
  headers = { 'User-Agent' : self.userAgent,
            '  Cookie' : self.cookies}

  req = urllib2.Request(addr)
  response = urllib2.urlopen(req)

  print "ResponseInfo="
  print response.info()

  resultsHtml = unicode(response.read(), self.encoding)
  return resultsHtml 
```

# perl - 为什么这个 Perl 片段没有检测到“undef”？

> ID：843405
> 
> 赞同：2
> 
> 时间：2009-05-09T14:19:26.530
> 
> 标签：perl, undef

由于 undef 值，我希望输入第二个“if”语句中的块，但日志显示它没有被输入。

```
sub getcmd{
  my $self = $_[0];
  if ( $self->_recv == OK ){
      push @{$self->{'log'}}, ['NOTICE', "OK"];
      return "My command";          
  }
  push @{$self->{'log'}}, ['ERROR', "Did not get OK back"];
  return undef;
}

...

if (!($ret = $self->getcmd)){
  push @{$self->{'log'}}, ['ERROR', "failed to read after asking for NEXT"];
}
else {
  push @{$self->{'log'}}, ['ERROR', "'undef' not detected in next()"];
} 
```

日志文件显示：

```
[Fri May  8 19:25:56 2009]: ERROR: Did not get OK back
[Fri May  8 19:26:02 2009]: ERROR: 'undef' not detected in next() 
```

任何想法都欣然接受。

**编辑：**对不起，我已经编辑了代码以显示基本流程。我应该把它校对好一点。

*   我在 getcmd() 中添加了 $ret 来模拟日志记录函数中发生的情况，该函数只打印出 $ret 的当前值，这是一个始终用于捕获返回值的全局变量。
*   我削减了日志消息并错过了额外的“后退”

感谢您的建议和意见。我没有注意到日志时间戳的六秒差异，所以现在我怀疑您对执行顺序与我最初预期的不同是正确的。

我回去再看看。猜猜这就是你在一天 13 个小时试图完成一个“必须在星期一上线”项目之后查看其他人的“平均”Perl 时得到的结果！

我没有编写代码，只是继承了它。该代码是由几个认为他们“不需要警告或严格”的人编写的。

想象一下 800 行 Perl 和许多“if”，但没有 else 语句！根本没有防御性编码！8-O

再次感谢您的帮助。

干杯，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-09T14:36:37.027

减少到最低限度，这将打印“未检测到”。

```
#!/bin/perl -w

use strict;

sub getcmd
{
    return undef;
}

my $ret;

if (!($ret = getcmd()))
{
    print "undef detected\n";
}
else
{
    print "undef undetected\n";
} 
```

因此，您的问题很可能是 $self->getcmd() 没有返回 undef，即使您认为它应该返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T14:32:12.900

我认为这里发生了更复杂的事情——这些日志消息似乎相隔 6 秒，而推送语句、返回和 if 检查不可能需要 6 秒。

第一条日志消息是否有可能来自应用程序中其他位置的方法调用？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T15:58:41.197

使用[perl 调试器](http://perldoc.perl.org/perldebug.html)(perl -d) 单步执行代码以查看发生了什么。在调试代码时，重要的是要让你的头脑从每一个假设中解放出来。

此外，这些行在每个 perl 程序之上都是必须的：

```
use strict;
use warnings; 
```

# iphone - 你最喜欢的 UITableView / UITableViewCell 技巧是什么？

> ID：843427
> 
> 赞同：12
> 
> 时间：2009-05-09T14:40:51.360
> 
> 标签：iphone, cocoa-touch

UITableView 是一个非常强大的类，为 iPhone 上的许多导航和偏好视图提供支持。许多人提出了有用的 UITableView 提示、技巧和示例：

*   将 Interface Builder 用于表格单元格的各种方法
*   如何创建偏好样式的单元格
*   确保良好的滚动速度
*   等等

请发布您最喜欢的关于使用 UITableView 的提示，每个问题一个提示。我将首先发布我在 Stack Overflow 上找到的内容以及我的书签中的内容。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-09T15:03:42.453

有没有想过 UITableViewController 的真正作用是什么？

*   在 viewWillAppear 中，它取消选择任何选定的行，使用`animated:YES`.

    顺便说一句，这就是为什么当您在 UINavigationController 中导航回来时，您之前触摸过的行会被动画很好地取消选择。当您将一个新的视图控制器推送到 UINavigationController 上时，您已经选择了该行。当您弹出它并返回表视图时，viewWillAppear 会触发并取消选择该行。UINavigationController 甚至不知道发生了这种情况。

*   在 viewWillAppear 中，`reloadData`如果表视图不包含行，它会调用。

*   在 viewDidAppear 中，它调用`flashScrollIndicators`.

*   它监视键盘的出现和消失，并适当地调整表格视图的大小，以便当您点击表格视图中的文本字段时，它在键盘出现后仍然可见。

如果您不需要键盘监控行为，如果需要，您可以很容易地自行完成其他所有操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T14:50:25.933

在编辑模式下实现“复选标记”以一次操作多行：“<a href="http://cocoawithlove.com/2009/01/multiple-row-selection-and-editing-in.html" rel="nofollow noreferrer">在 UITableView 中进行多行选择和编辑”来自伟大的 Cocoa With Love 博客。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-09T15:15:34.450

如何实现自定义单元格背景视图？

Mike Akers 在“<a href="https://stackoverflow.com/questions/400965/how-to-customize-the-background-border-colors-of-a-grouped-table-view" 中的优秀示例课程>如何自定义分组表视图的背景/边框颜色？” 关于堆栈溢出。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-05-20T12:46:09.137

如果要删除分隔线，请使用以下命令：

```
[self.tableView setSeparatorStyle:UITableViewCellSeparatorStyleNone]; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-10T06:15:31.357

为确保良好的滚动性能，尽可能避免任何元素的透明度非常重要 - 因此，如果您正在创建自定义单元格，请使它们全部不透明并正确设置背景。

您可以使用 Core Animation Performance Tool 直观地查看单元格中的透明度 - 您必须在设备上运行才能使用此工具。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-09T14:56:13.680

实现首选项样式的分组表：[Three20](http://github.com/joehewitt/three20/)库（从 Facebook iPhone 应用程序中提取）具有一组包含各种控件的现成单元格。

（但不确定你是否想使用它们。Three20 有点“未发明”的问题，并尝试子类化和扩展所有内容，因此添加它会给你的项目添加相当多的混乱。但至少你可以拿来做例子。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-09T15:07:54.163

如何使用 Interface Builder 来创作你的单元格？在单独的 Stack Overflow 讨论中找到答案：“<a href="https://stackoverflow.com/questions/134575/using-interface-builder-for-uitableviews">为 UITableView 使用 Interface Builder”</p>

# perl - readdir() 的“0”结果如何在一段时间内不为假？

> ID：843430
> 
> 赞同：6
> 
> 时间：2009-05-09T14:42:52.090
> 
> 标签：perl, while-loop, readdir, defined

另请参阅：[文档中的什么地方说，虽然测试 readdir 的定义？](https://stackoverflow.com/questions/844625/where-in-the-documentation-does-it-say-that-while-tests-readdir-for-definedness). （*不是重复的；只是密切相关。*）

* * *

许多人将下面的循环视为惯用的：

```
while (defined(my $file = readdir($dir)) {
    ...
} 
```

代替：

```
while (my $file = readdir($dir)) {
    ...
} 
```

因为如果文件名只是“0”（零），它应该终止循环，而当没有更多文件时它返回“undef”。

然而，在过去的某个时候，这个测试`defined()`不再是必要的——似乎有特殊情况的代码允许后一个版本无论如何都可以工作。

我想知道这是如何工作的？

奇怪的是，如果我将调用替换为`readdir()`调用`foo()`：

```
sub foo
{
    my ($dir) = @_;
    return readdir($dir);
}

while (my $file = foo($dir)) {
    ...
} 
```

然后代码*会*按照我的预期进行，并在找到名为“0”的文件时终止循环。

（在 MacOS X 10.5.6 上使用 Perl 5.8.9 测试）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-09T16:54:46.480

这是魔术。特别是魔法（记录在[`perlsyn`](http://perldoc.perl.org/perlsyn.html#Loop-Control), [`perlop`](http://perldoc.perl.org/perlop.html#I%2fO-Operators)，可能还有其他我不记得的地方）。Perl 允许您使用某些速记符号。如果你想看看 Perl 在你背后做什么，你可以使用[`B::Deparse`](http://perldoc.perl.org/B/Deparse.html). 这是一个使用速记循环的文件：

```
#!/usr/bin/perl

use strict;
use warnings;

opendir my $dir, "/tmp" or die "$!";

while (my $file = readdir($dir)) {
    print "$file\n";
} 
```

如果你运行`perl -MO=Deparse filename.pl`你会得到 Perl 看到的代码：

```
use warnings;
use strict 'refs';
die "$!" unless opendir my $dir, '/tmp';
while (defined(my $file = readdir $dir)) {
    do {
        print "$file\n"
    };
}
filename.pl syntax OK 
```

# jquery - django/jQuery 调用的简单视图问题

> ID：843433
> 
> 赞同：1
> 
> 时间：2009-05-09T14:43:39.407
> 
> 标签：jquery, django

我试图弄清楚如何将 html 传递回 jQuery 调用，但由于某种原因，我的代码拒绝工作。

```
t = get_template('success.html')
html = t.render(Context({'success': True}))    # should render '<p><h1>aoeu</h1></p>'
x = "{'success' : '" + html + "'}"
return HttpResponse(x) 
```

jQuery代码：

```
$.post("adduser", data, function(responseData){
    $('#content').html(responseData.success);
}, "json"); 
```

如果我用文字字符串（只是'asdf'或其他东西）替换html，#content会正确更改。如果我使用呈现的 html，它不会显示。我究竟做错了什么？另外，这是用 django 进行动态调用的正确方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T14:52:12.157

您正在使用数据类型“json”，而需要使用“html”。（[来源](http://docs.jquery.com/Ajax/jQuery.get#urldatacallbacktype)）

```
$.post("adduser", data, function(responseData){
    $('#content').html(responseData.success);
}, "html"); 
```

# sql-server - 如何防止 SQL Server 系统管理员用户写入权限？

> ID：843437
> 
> 赞同：1
> 
> 时间：2009-05-09T14:45:34.880
> 
> 标签：sql-server, sysadmin

我在 SQL Server 2005 中创建了一个具有系统管理员权限的测试用户（系统管理员，因为我也想使用这个用户名进行分析）。但我想限制测试用户对生产数据库的访问权限。

它位于“登录”下，并且在其属性的“用户映射”选项卡下选择了数据库名称，默认模式为“db_denydatareader”。但它仍然可以运行选择语句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T15:08:20.933

抱歉，一旦您授予 SysAdmin 访问权限，您就放弃了农场。您必须为测试用户创建不同的角色，然后仅授予对所需数据库的访问权限。

# css - Cross browser way to hide selection display

> ID：843445
> 
> 赞同：2
> 
> 时间：2009-05-09T14:51:09.600
> 
> 标签：css, browser, selection

I am making a browser based javascript game. As such, within the game there is nowhere users need to copy/paste text. However there are many places where the user needs to click and drag to make selections in the game.

Within the game there are many cells, internally just normal table cells, with a non breaking space to stop them collapsing in firefox (I could stop the collapsing in IE, Safari and Opera with CSS, but for some reason it didn't work in firefox so I resorted to non breaking spaces), with either a solid background colour or a background image.

As the player drags a selection across them, the game highlights the cells by changing the background colour. However, the browser also highlights the non breaking spaces, leaving grey rectangles across some of the cell.

Also the browser uses a different way to determine what is selected than the game.

e.g. in a 5 x 5 square, if the user selects (1, 1) to (3, 3), the game highlights the following selection:

```
|   |   |   |   |   |
|   | X | X | X |   |
|   | X | X | X |   |
|   | X | X | X |   |
|   |   |   |   |   | 
```

but the browser highlights the non breaking spaces in the following:

```
|   |   |   |   |   |
|   |   | X | X | X |
| X | X | X | X | X |
| X | X | X | X |   |
|   |   |   |   |   | 
```

Is there any way to stop the browser selection styling showing through? At the very least in firefox and Chrome, but preferably cross browser.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T14:56:04.477

For firefox you can add the css style: ([mozilla guide](https://developer.mozilla.org/En/CSS/-moz-user-select))

```
-moz-user-select: none 
```

For chrome and safari: (couldn't find a reliable source yet)

```
-khtml-user-select:none 
```

If you prefer a javascript solution, here is the one I found from a [previous answer](https://stackoverflow.com/questions/69430/is-there-a-way-to-make-text-unselectable-on-an-html-page/69500#69500):

```
<div onselectstart="return false">some stuff</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T12:26:20.730

```
-webkit-touch-callout: none;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none; 
```

Duplicate of: [https://stackoverflow.com/a/4407335/746491](https://stackoverflow.com/a/4407335/746491) ?

# python - Python中的条形图（o图）3D

> ID：843449
> 
> 赞同：6
> 
> 时间：2009-05-09T14:53:16.303
> 
> 标签：python, matplotlib, plot, 3d

我需要以各种形式绘制一些数据。目前我正在使用[Matplotlib](http://en.wikipedia.org/wiki/Matplotlib)，我对能够制作的图相当满意。

这个问题是关于如何绘制最后一个。数据类似于“距离表”，像[这样](http://www.southernct.edu/wellness/uploads/textWidget/wysiwyg/documents/Campus_Walking_Map__Distance_Chart.pdf)（更大，我的表是 128x128，每个元素仍然有 3 个或更多数字）。

现在，我的数据比距离表“结构化”要好得多（我的数据不会像按字母顺序排序的距离表那样“随机”变化），因此 3D[条形图](http://www.scipy.org/Cookbook/Matplotlib/BarCharts)，或者其中的 3 个，将是完美的。我的理解是 Matplotlib 中缺少这样的图表。

我可以使用像这样的（彩色）Countor3d[或](http://www.scipy.org/Cookbook/Matplotlib/mplot3D)像 imshow 这样的 2D 东西，但它并不能很好地代表数据是什么（数据仅在我的 128 点中有意义，两点之间没有任何东西） . 条形的高度比颜色更易读，IMO。

因此问题：

1.  是否可以在 Matplotlib 中创建 3D 条形图？应该清楚的是，我的意思是使用 2D 域，而不仅仅是出于美学目的而带有“假”3D 渲染的 2D 条形图
2.  如果上一个问题的答案是否定的，那么是否有其他图书馆能够做到这一点？我非常喜欢基于 Python 的东西，但我对其他 Linux 友好的可能性表示满意
3.  如果上一个问题的答案是否定的，那么您对如何显示该数据有什么建议吗？例如，创建一个包含值的表，叠加到 imshow 或其他彩色方式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-09T16:56:07.617

一段时间以来，matplotlib 没有 3D 支持，但[最近](http://thread.gmane.org/gmane.comp.python.matplotlib.devel/6762/focus=6820)又重新添加了。您将需要使用 svn 版本，因为此后没有发布任何版本，并且文档有点稀疏（请参阅示例/mplot3d/demo.py）。我不知道 mplot3d 是否支持真正的 3D 条形图，但其中一个演示看起来有点像可以扩展到类似的东西。

编辑：演示的源代码在[示例](http://matplotlib.sourceforge.net/examples/mplot3d/demo.html)中，但由于某种原因结果不是。我的意思是`test_polys`函数，它是这样的：

[示例图 http://www.iki.fi/jks/tmp/poly3d.png](http://www.iki.fi/jks/tmp/poly3d.png)

该`test_bar2D`功能会更好，但在演示中已将其注释掉，因为它会导致当前 svn 版本出错。可能是一些微不足道的问题，或者更难解决的问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-09T16:10:51.140

[MyavaVi2](http://code.enthought.com/projects/mayavi/)可以制作[3D 条形图](http://code.enthought.com/projects/mayavi/docs/development/html/mayavi/mlab.html#d-data)（向下滚动一点）。一旦你有了[MayaVi](http://en.wikipedia.org/wiki/MayaVi) / [VTK](http://en.wikipedia.org/wiki/VTK) / [ETS](http://en.wikipedia.org/wiki/Enthought) /etc。安装它一切都很好，但安装它可能需要一些工作。Ubuntu 已将其全部打包，但它们是我所知道的唯一一个这样做的 Linux 发行版。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-12T11:50:19.637

另一种可能性是 Gnuplot，它可以绘制某种[伪 3D 条形图](http://t16web.lanl.gov/Kawano/gnuplot/plotpm3d-e.html#6.9)，并且[gnuplot.py](http://gnuplot-py.sourceforge.net/)允许从 Python 连接到 Gnuplot。不过，我自己还没有尝试过。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-20T08:19:08.323

这是我使用 matplotlib 的简单 Bar-3d 的代码。

```
import mpl_toolkits
from mpl_toolkits.mplot3d import Axes3D   
import matplotlib.pyplot as plt
%matplotlib inline

## The value you want to plot 
zval=[0.020752244,0.078514652,0.170302899,0.29543857,0.45358061,0.021255922,0.079022499,\
  0.171294169,0.29749654,0.457114286,0.020009631,0.073154019,0.158043498,0.273889264,0.419618287]    

fig = plt.figure(figsize=(12,9))
ax = fig.add_subplot(111,projection='3d')
col=["#ccebc5","#b3cde3","#fbb4ae"]*5
xpos=[1,2,3]*5
ypos=range(1,6,1)*5
zpos=[0]*15
dx=[0.4]*15
dy=[0.5]*15
dz=zval

for i in range(0,15,1):
     ax.bar3d(ypos[i], xpos[i], zpos[i], dx[i], dy[i], dz[i],     
color=col[i],alpha=0.75)

ax.view_init(azim=120)
plt.show() 
```

[http://i8.tietuku.com/ea79b55837914ab2.png](http://i8.tietuku.com/ea79b55837914ab2.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T22:09:16.933

您可以查看 Chart Director：

> [http://www.advsofteng.com](http://www.advsofteng.com)

它有各种各样的图表和图形，并有一个很好的 Python（和其他几种语言）API。

有两个版本：免费版在生成的图像上添加了简介，付费版的价格相当合理。

这是看起来更有趣的 3d 堆叠条形图之一：

[![示例图](https://i.stack.imgur.com/gQjx0.png)](https://i.stack.imgur.com/gQjx0.png)
[（来源：[advsofteng.com](http://www.advsofteng.com/images/demo10.png)）]

# python - Python 中的垃圾收集如何与类方法一起工作？

> ID：843459
> 
> 赞同：3
> 
> 时间：2009-05-09T15:03:38.633
> 
> 标签：python, garbage-collection

```
class example:

    def exampleMethod(self):
        aVar = 'some string'
        return aVar 
```

在这个例子中，每次调用 example.exampleMethod() 后垃圾回收是如何工作的？一旦方法返回，aVar 会被释放吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T15:22:55.420

该变量永远不会被释放。

对象（在这种情况下是一个字符串，其值为 ）`'some string'`被一次又一次地重用，因此该对象永远不会被释放。

当没有变量引用对象时，对象将被释放。想想这个。

```
a = 'hi mom'
a = 'next value' 
```

`'hi mom'`在这种情况下，执行第二个语句时，脚本中的任何位置都不再引用第一个对象（值为 的字符串）。对象 ( `'hi mom'`) 可以从内存中删除。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T15:31:25.280

每次将对象分配给变量时，都会增加该对象的引用计数器。

```
a = MyObject() # +1, so it's at 1
b = a # +1, so it's now 2
a = 'something else' # -1, so it's 1
b = 'something else' # -1, so it's 0 
```

没有人可以访问我们在第一行创建的 MyObject 对象了。

当计数器达到零时，垃圾收集器释放内存。

有一种方法可以制作一个不会增加引用计数器的棘手引用（如果您不希望一个对象仅仅因为它在某个缓存字典中而被保存在内存中）。

更多关于 cPython 的引用计数可以在[这里](http://www.python.org/doc/2.5.2/ext/refcounts.html)找到。

Python 是语言，cPython 是它的（相当流行的）实现。Afaik 语言本身并没有指定*如何*释放内存。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-09T15:50:36.730

从您的示例中，如果您调用 example.exampleMethod() ，而不分配结果（例如`a = example.exampleMethod()`），那么它将立即被释放（在 CPython 中），因为 CPython 使用引用计数机制。字符串不是一个很好的使用示例，因为它们还具有许多特定于实现的优化。字符串可以被缓存，并且不会被释放以便它们可以被重用。这特别有用，因为字符串在字典中用作键非常常见。

同样，垃圾收集是特定于实现的，因此 CPython、Jython 和 IronPython 将有不同的行为，其中大部分都记录在各自的站点/手册/代码/等中。如果您想稍微探索一下，我建议您创建一个定义了**del** () 方法的类，该方法将在被垃圾收集的对象（它是析构函数）时调用。让它打印一些东西，这样你就可以追踪它的调用:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T16:23:19.990

正如 Nico 的回答，这取决于您如何处理 exampleMethod 返回的结果。Python（或 CPython）使用引用计数。在方法过程中，aVar 引用了字符串，之后变量 aVar 被删除，可能没有任何引用，在这种情况下，它被删除。

下面是一个带有析构函数（**del** (self) 的自定义类的示例，它打印出“对象 1 被破坏”或类似内容。gc 是垃圾收集器模块，它自动删除引用计数为 0 的对象。它是为了方便起见，否则无法保证垃圾收集器何时运行。

```
import gc
class Noisy(object):
    def __init__(self, n):
        self.n = n
    def __del__(self):
        print "Object " + str(self.n) + " being destructed"     
class example(object):
    def exampleMethod(self, n):
        aVar = Noisy(n)
        return aVar
a = example()
a.exampleMethod(1)
b = a.exampleMethod(2)
gc.collect()
print "Before b is deleted"
del b
gc.collect()
print "After b is deleted" 
```

结果应如下所示：

```
Object 1 being destructed
Before b is deleted
Object 2 being destructed
After b is deleted 
```

请注意，第一个 Noisy 对象在方法返回后被删除，因为它没有分配给变量，所以引用计数为 0，但只有在变量 b 被删除后才删除第二个对象，留下引用计数0。

# php - php中fopen错误的应急计划

> ID：843464
> 
> 赞同：0
> 
> 时间：2009-05-09T15:05:01.453
> 
> 标签：php, fopen

我正在编写一个 PHP 应用程序，它有一个“控制面板”，可以编写一个带有某些变量的 prefs 文件。在每个 上`POST`，如果文件不存在，则创建它。如果确实存在，则它是`unlinked`并且新文件`touched`具有相同的文件名和新变量。然后，此文件将包含在另一个页面上，并根据其中的变量显示内容。

```
$file = "phpsettings.php";

if (!file_exists($file)) {
   touch($file);
  $handle = fopen ($file, 'r+'); 
$str = "<?php \$pref1 = \"$mypref\"; ?>";

} else {

unlink($file);
   touch($file);
   $handle = fopen ($file, 'r+'); 
   $str = "<?php \$pref1 = \"$mypref\"; ?>";

}

fwrite ($handle, $str); 
fclose ($handle); 
```

如果该文件每天将被覆盖多次，这是一种安全的编写首选项的方式吗？如果文件未正确保存，有什么好方法可以提醒此控制面板的用户，在这种情况下，避免破坏包含此首选项文件的页面的良好应急计划是什么？要填充的默认变量集 if `!(file_exists)`?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T15:22:23.173

如果将设置存储在数组中，则可以将它们序列化（）并写入文本文件，而不是将原始 php 写入 php 文件并包含它。

如果您没有针对这些偏好清理您的输入，并且说 $mypref1 代表某人的姓名，那么没有什么可以阻止他们在表单字段中填写此内容：

```
\"; echo \"PWNED 
```

你生成的 PHP 将变成

```
<?php \$pref1 = \"$mypref\"; echo \"PWNED\"; ?> 
```

因此，首先，将您的首选项存储在数组中并使用 serialize() 更安全：

```
$prefs = array('mypref1' => 'somethingorother');
$handle = fopen ($file, 'w'); 
fwrite($handle, serialize($prefs));
fclose($h);

// example code demonstrating unserialization
$prefs2 = unserialize(file_get_contents($file));
var_dump($prefs == $prefs2); // should output "(bool) true" 
```

在您的问题中，您还提到如果该文件确实存在，则它是未链接的。您可以通过将“w”作为第二个参数传递给 fopen 来简单地将其截断为零长度 - 您不需要手动删除它。无论如何，这应该设置 mtime，不需要调用 touch()。

如果写入文件的值是首选项，那么每个首选项肯定都有默认值，除非有数百个？array_merge 将允许您基于每个键进行覆盖，因此如果您执行以下操作：

```
// array of defaults
$prefs = array(
    'mypref1' => 'pants',
    'mypref2' => 'socks',
);
if (file_exists($file)) {
    // if this fails, an E_NOTICE is raised. are you checking your server error
    // logs regularly?
    if ($userprefs = unserialize(file_get_contents($file))) {
        $prefs = array_merge($prefs, $userprefs);
    }
} 
```

如果问题是存在堆，并且您不想将它们全部初始化，则可以有一个 get_preference 方法，它只包装对 prefs 数组的 isset 调用。

```
function get_preference($name, &$prefs) {
    if (isset($pref[$name]))
        return $pref[$name];
    return null;
}
var_dump(get_preference('mypref1', $prefs)); 
```

除了这引发的所有问题之外，现实情况是，对于您的应用程序，万一fopen 出现问题，无论如何*它*都应该被视为严重失败，并且您可能会遇到少数用户如果出现问题，使用此功能将很快与您联系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T15:13:05.717

为什么不直接使用 fopen() 的截断功能呢？我相信你需要传递“w+”而不是“r+”......然后如果文件存在，它将被截断，如果不存在，你只需创建一个新文件。所以代码变成了：

```
$file = "phpsettings.php";
$handle = fopen( $file, 'w+' );
$str = "<?php \$pref1 = \"$mypref\"; ?>";
fwrite ($handle, $str); 
fclose ($handle); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T15:18:34.053

将用户状态存储在会话中并仅在需要时保留该状态总是更好。

# asp.net - 回发后未选中 RadioButtonList

> ID：843479
> 
> 赞同：4
> 
> 时间：2009-05-09T15:13:18.413
> 
> 标签：asp.net, radiobuttonlist

当我单击 asp.net 页面上的按钮控件时，我的单选按钮列表在回发后返回未选中状态。

```
<asp:RadioButtonList ID="rblSgkOzel" runat="server" EnableViewState="true">
    <asp:ListItem Text="SGK Kapsamında" Value="sgk" Selected="True"/>
    <asp:ListItem Text="Özel" Value="ozel" />
    <asp:ListItem Text="Hasta Adına" Value="hasta" />
</asp:RadioButtonList> 
```

* * *

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="denemeRepeater.aspx.cs"
    Inherits="KlinikMuhasebe.denemeRepeater" %>

<%@ Import Namespace="MedulaRADClassLib" %>
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="cc1" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <link href="JS/reset-fonts-grids.css" rel="stylesheet" type="text/css" />
    <link href="css.css" rel="stylesheet" type="text/css" />
    <link href="_cssV3.css" rel="stylesheet" type="text/css" />

    <script src="JS/jquery-1.3.2.min.js" type="text/javascript"></script>

    <script src="JS/liquid-canvas.js" type="text/javascript"></script>

    <script src="JS/liquid-canvas-plugins.js" type="text/javascript"></script>

    <script type="text/javascript" src="js_Eski/JScript.js" language="javascript"></script>

    <script type="text/javascript" src="js_Eski/overlib.js" language="javascript"></script>

    <script src="JS/boxy/jquery.boxy.js" type="text/javascript"></script>

    <style>
        .imgOpenClose
        {
        }
        body
        {
            color: Black;
        }
    </style>

    <script type="text/javascript">
        $(document).ready(function() {

            $('.imgOpenCloseKurum').click(function() {
                if ($(this).attr("src") == "images/openTree.gif") {
                    $(this).attr("src", "images/closeTree.gif");
                    $($(this).parent().get(0)).find('div').eq(0).show();
                }
                else {
                    $(this).attr("src", "images/openTree.gif");
                    $($(this).parent().get(0)).find('div').eq(0).hide();
                }
            });

            $('.imgOpenClose').click(function() {
                if ($(this).attr("src") == "images/openTree.gif") {
                    $(this).attr("src", "images/closeTree.gif");
                    $(this).parent().find('div').eq(0).show();
                }
                else {
                    $(this).attr("src", "images/openTree.gif");
                    $(this).parent().find('div').eq(0).hide();
                }
            });

            $("input:radio").click(function() {
                $("input:radio").each(function() {
                    $(this).attr("checked", "")
                });
                $(this).attr("checked", "checked");
            }).attr("checked", "");

            $("input:checkbox").click(function() {
                if ($(this).attr('checked')) {
                    $(this).next().html("Ücretli Seans");
                    //$(this).attr('checked', '');
                }
                else {
                    $(this).next().html("Bedelsiz Seans");
                    //$(this).attr('checked', 'checked');
                }

            })
        });
    </script>

</head>
<body>
    <form id="form1" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server">
    </asp:ScriptManager>
    <div style="text-align: left;">
        <div class="divKriter">
            <table>
                <thead>
                    <tr>
                        <th colspan="2">
                            FATURA BASKI KRİTERLERİ
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <asp:RadioButtonList ID="rblSgkOzel" runat="server" EnableViewState="true">
                                <asp:ListItem Text="SGK Kapsamında" Value="sgk" Selected="True"/>
                                <asp:ListItem Text="Özel" Value="ozel" />
                                <asp:ListItem Text="Hasta Adına" Value="hasta" />
                            </asp:RadioButtonList>
                        </td>
                        <td>
                            <asp:TextBox ID="txtTarihi" runat="server" ToolTip="Son Tarihi" />
                            <cc1:CalendarExtender ID="txtTarihi_CalendarExtender" runat="server" Enabled="True"
                                TargetControlID="txtTarihi" Format="dd.MM.yyyy">
                            </cc1:CalendarExtender>
                            &nbsp;<br />
                            <asp:CheckBox ID="cbBedelsiz" runat="server" Text="Ücretli Seans" Checked="true" />
                            <br />
                            <asp:Button ID="btnFaturaNolariGetir" runat="server" Text="Faturaları Getir" OnClick="btnFaturaNolariGetir_Click" />
                            &nbsp;
                        </td>
                    </tr>
                    <tr>
                        <td>
                            &nbsp;
                        </td>
                        <td>
                            <asp:DropDownList ID="ddlFaturaNolar" runat="server" />
                            <asp:Button ID="btnFaturaDetaylariniGetir" runat="server" Text="Fatura Detayları"
                                OnClick="btnFaturaDetaylariniGetir_OnClick" />
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <br />
        <br />
        <br />
        <br />
        <asp:Repeater ID="rptSGK" runat="server" OnItemDataBound="rpt_OnItemDataBound">
            <ItemTemplate>
                <div class="divKurumItem">
                    <img class="imgOpenCloseKurum" src="images/openTree.gif" />
                    <asp:RadioButton ID="rbKurum" runat="server" GroupName="rbKurumlar" />
                    <%# DataBinder.Eval(Container.DataItem, "kurumAdi")%>
                    <div style="display: none; margin-left: 10px;">
                        <asp:Repeater ID="rptHastalar" runat="server" OnItemDataBound="rptHastalar_OnItemDataBound">
                            <ItemTemplate>
                                <div style="display: block; margin-left: 10px;">
                                    <img class="imgOpenClose" src="images/openTree.gif" />
                                    <%# DataBinder.Eval(Container.DataItem, "adiSoyadi")%><br />
                                    <div id='hid_<%# DataBinder.Eval(Container.DataItem, "refHasta_id")%>' style="margin: 10px;
                                        display: none;">
                                        <asp:HiddenField runat="server" ID="hdn1" Value='<%# total = 0 %>' />
                                        <asp:Repeater ID="rptSeanslar" runat="server">
                                            <HeaderTemplate>
                                                <table border="1" cellpadding="5" cellspacing="2" style="margin-left: 30px;">
                                                    <thead>
                                                        <tr>
                                                            <th>
                                                                Seans Tarihi
                                                            </th>
                                                            <th>
                                                                Başvuru No.
                                                            </th>
                                                            <th>
                                                                Fatura Teslim No.
                                                            </th>
                                                            <th>
                                                                Fatura No.
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                            </HeaderTemplate>
                                            <ItemTemplate>
                                                <tr>
                                                    <td>
                                                        <%# DataBinder.Eval(Container.DataItem, "tarihi", "{0:d}") %>
                                                    </td>
                                                    <td>
                                                        <%# (rblSgkOzel.SelectedIndex==0) ? DataBinder.Eval(Container.DataItem, "basvuruNo") : "" %>
                                                    </td>
                                                    <td>
                                                        <%# (rblSgkOzel.SelectedIndex==0) ? DataBinder.Eval(Container.DataItem, "faturaTeslimNo") : "" %>
                                                    </td>
                                                    <td>
                                                        <%# (rblSgkOzel.SelectedIndex==0) ? DataBinder.Eval(Container.DataItem, "faturaNo") : ""%>
                                                    </td>
                                                </tr>
                                            </ItemTemplate>
                                            <FooterTemplate>
                                                </tbody> </table> </div>
                                            </FooterTemplate>
                                        </asp:Repeater>
                                    </div>
                                    <asp:HiddenField runat="server" ID="hdn" Value='<%# total = total + 1 %>' />
                            </ItemTemplate>
                            <FooterTemplate>
                                <div style="width: 500px; text-align: right; display: block;">
                                    Toplam Satır Sayısı:
                                    <%# total %>
                                </div>
                            </FooterTemplate>
                        </asp:Repeater>
                    </div>
                    <br />
                </div>
            </ItemTemplate>
        </asp:Repeater>
        <br />
        <br />
        <asp:Repeater ID="rptOzel" runat="server" OnItemDataBound="rpt_OnItemDataBound">
            <ItemTemplate>
                <div class="divKurumItem">
                    <img class="imgOpenCloseKurum" src="images/openTree.gif" />
                    <asp:RadioButton ID="rbKurumOzel" runat="server" GroupName="rbKurumlar" />
                    <%# DataBinder.Eval(Container.DataItem, "kurumAdi")%>
                    <div style="display: none; margin-left: 10px;">
                        <asp:Repeater ID="rptHastalar" runat="server" OnItemDataBound="rptHastalar_OnItemDataBound">
                            <ItemTemplate>
                                <div style="display: block; margin-left: 10px;">
                                    <img class="imgOpenClose" src="images/openTree.gif" />
                                    <%# DataBinder.Eval(Container.DataItem, "adiSoyadi")%><br />
                                    <div id='hid_<%# DataBinder.Eval(Container.DataItem, "refHasta_id")%>' style="margin: 10px;
                                        display: none;">
                                        <asp:HiddenField runat="server" ID="hdn1" Value='<%# total = 0 %>' />
                                        <asp:Repeater ID="rptSeanslarOzel" runat="server">
                                            <HeaderTemplate>
                                                <table border="1" cellpadding="5" cellspacing="2" style="margin-left: 30px;">
                                                    <thead>
                                                        <tr>
                                                            <th>
                                                                Seans Tarihi
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                            </HeaderTemplate>
                                            <ItemTemplate>
                                                <tr>
                                                    <td>
                                                        <asp:CheckBox ID="cbSeansOzel" runat="server" Text='<%# DataBinder.Eval(Container.DataItem, "tarihi", "{0:d}") %>' />
                                                    </td>
                                                </tr>
                                            </ItemTemplate>
                                            <FooterTemplate>
                                                </tbody> </table> </div>
                                            </FooterTemplate>
                                        </asp:Repeater>
                                    </div>
                                    <asp:HiddenField runat="server" ID="hdn" Value='<%# total = total + 1 %>' />
                            </ItemTemplate>
                            <FooterTemplate>
                                <div style="width: 500px; text-align: right; display: block;">
                                    Toplam Satır Sayısı:
                                    <%# total %>
                                </div>
                            </FooterTemplate>
                        </asp:Repeater>
                    </div>
                    <br />
                </div>
            </ItemTemplate>
        </asp:Repeater>
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T15:33:08.040

**更新：**在您发布更新后的代码后，我可以看出问题出在您的 jQuery 代码中。它设置为在页面加载后立即取消选中所有单选按钮。

你需要改变这个：

```
$("input:radio").click(function() {
     $("input:radio").each(function() {
         $(this).attr("checked", "")  //uncheck all radio buttons in page
     });
     $(this).attr("checked", "checked"); //check only the selected radio
  }).attr("checked", ""); //Unchecks all radio buttons when page loads 
```

对此：

```
$("input:radio").click(function() {
     $("input:radio").each(function() {
         $(this).attr("checked", "")
     });
    $(this).attr("checked", "checked");
}); 
```

我添加了注释来解释你的 jQuery 代码在做什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T15:41:04.780

您是否在方法中绑定列表`Page_Load`？

如果是这样，请确保仅在页面未回发时才具有约束力，如下所示：

```
protected void Page_Load(object sender, EventArgs) 
{
    if (!IsPostBack) 
    {
        //Bind to the list in this block
    }
} 
```

# flash - 是否可以制作 FileReference.upload() 块（在 ActionScript 3.0 中）？

> ID：843480
> 
> 赞同：0
> 
> 时间：2009-05-09T15:15:10.800
> 
> 标签：flash, actionscript-3

我正在开发一个 Flash 文件上传小部件，我希望它一次上传一个文件。在我的上传功能中，我目前有一个`FileReferenceList`，我正在循环通过它，调用`upload`每一个。但是，由于`FileReference.upload`是非阻塞的，所有的上传都是同时进行的。

是否可以制作`uplaod`功能块？或者我是否需要通过注册一个事件以在第一个 Event.COMPLETE 事件触发时上传下一个事件来将上传链接在一起？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T15:40:26.450

不，您通常不能使用 AS3 来执行此操作，您必须通过链接来管理“异步”请求。

我通常会有我的文件列表并上传一个，捕捉完整的事件，然后再做另一个。同样的原则也适用于使用 URLLoader 下载或检索文件。

# c++ - WebKit 或 Gecko - 哪个更适合嵌入 C++ 应用程序？

> ID：843490
> 
> 赞同：11
> 
> 时间：2009-05-09T15:23:44.247
> 
> 标签：c++, webkit, embedding, gecko

你会选择哪一个，**为什么**？
我想听听有在 C++ 应用程序中嵌入 Web 浏览器引擎**经验的人的意见。**
我应该强调我需要 Web 浏览器引擎的所有功能，**除了渲染**，即 HTTP 客户端、cookie 处理、DOM 样式 HTTP 解析器、JavaScript 引擎。如何*剥离*WebKit 或 Gecko 的渲染代码以避免编码和运行时开销？

这是对 C++ 项目的嵌入式浏览器的跟进[？](https://stackoverflow.com/questions/835201/what-embedded-browser-for-c-project)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T16:05:43.957

至少存在一个项目具有类似的要求并且嵌入了 Gecko。那是[Aptana 的 Jaxer](https://github.com/aptana/Jaxer)。据我所知，他们在这方面取得了很好的成功。这并不能完全回答您的问题，但它确实证明了这对于 Gecko 肯定是可行的，并且有可用的 GPL 代码，您可以查看如何执行此操作（Jaxer 是一个开源项目）。

过去也有人就此[提出过类似的问题](https://stackoverflow.com/questions/184373/what-is-the-best-html-rendering-engine-to-embed-in-an-application)。我不同意所有这些答案，因为那里存在一些错误信息，例如 Firefox 是 Gecko 中发生的事情的独裁者（它肯定会影响，但不是决定因素）。

完全披露：我在 Mozilla 代码库工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-26T21:40:52.203

我有偏见，但我会说 WebKit。尤其是通过使用 QtWebKit，应该很容易拥有一个非可视化的 Web 引擎（除了绘画，所有的花里胡哨）。如果一个人真的关心排除所有与绘画相关的代码，代码库是足够模块化的（尤其是平台抽象层），这可以在合理的时间框架内完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-24T10:44:11.913

请注意，QtWebkit（和我认为一般的 webkit）将要求您拥有一个活动的 x 服务器 - 即使您没有显示任何 GUI（它在 Qt 的核心中是必需的，因为 QWebPage 使用 QWidget）。这可能是 Qt 中的一个设计缺陷——我还没有进一步调查他们为什么会这样做。

# concurrency - 为并发编程语言选择一致性模型

> ID：843493
> 
> 赞同：7
> 
> 时间：2009-05-09T15:27:11.963
> 
> 标签：concurrency, language-design, message-passing, transactional-memory

我处于编程语言的设计阶段，目前正在考虑并发方面。我需要找出一个[一致性模型](http://en.wikipedia.org/wiki/Consistency_model)，即用这种语言编程的并发进程如何处理数据。

有两个重要的标准：

*   我更喜欢易用性而不是性能，只要一致性模型允许良好的扩展，
*   我不能使用需要阻塞或动态内存分配的一致性模型。

我现在的两个候选人一方面是**非阻塞软件事务内存，另一方面是在不共享***la* Erlang的**情况下复制消息传递语义。**

 *我特别担心易用性，所以我将介绍我反对这两个模型的主要论点。

在 STM 的情况下，用户必须了解类的哪些成员必须以原子方式改变并正确界定原子代码段。这些必须写成可以重复未定义的次数，它们不能执行任何 I/O，不能调用一些外部函数等。我认为这对于没有经验的程序员来说远非易事。

Erlang 风格的无共享并发很有吸引力，但有一个问题：实时进程无法复制它们发送过来的对象，因为它们无法执行任何内存分配，因此对象必须从一个进程“移动”到另一个进程通过队列。用户必须知道，如果一个实时进程对一个对象有两个引用，那么如果他将对象发送到另一个进程，这两个引用都将被清除。这有点像在任何使用点都可能为空或不为空的弱指针：这可能令人惊讶。

我倾向于第二种模型，因为它看起来更容易理解，并且自然地扩展到分布式系统。

**你有什么建议吗？**

*   非阻塞软件事务内存？
*   Erlang 风格的并发具有实时约束的困难？
*   还有什么我没有考虑过的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T15:59:13.440

我用 Erlang 做了一点，不多，但是尽管 share-nothing 消息传递范式对我来说是新的，但我想说它在视觉和物理方面很容易理解。

如果你的语言要普及，我会说 Erlang 风格至少是我可以不用太多工作就可以概括的东西。我认为其他人将能够比 STM 方法更容易地学习和应用这种模型。

我不是根据经验说话，但似乎 Erlang 模型更容易实现，因为它不必处理很多低级内存操作，您只需不共享任何内容，并管理内存之间的传递过程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-18T12:02:00.967

我不认为单一的范式可以解决所有问题并且是不兼容的。例如，一个应用程序可以对程序的某些部分使用消息传递接口，对其他部分使用 STM，对其他更具体的部分使用直接锁定。

您还可以查看 Join calculus ( [JoCaml](http://jocaml.inria.fr/) , [Boost.Join](http://channel.sourceforge.net/) )，可以将其视为消息传递接口的变体。

# apache-flex - 为什么 Flex 编译器在连续编译完全相同的源代码时会生成不同的文件大小？

> ID：843494
> 
> 赞同：2
> 
> 时间：2009-05-09T15:27:48.673
> 
> 标签：apache-flex, actionscript-3, compiler-construction, filesize

我正在使用命令行编译器构建 SWF `mxmlc.exe`。编译器将输出文件大小作为其标准输出的一部分写入。如果我在不更改实际源代码的情况下连续多次运行编译器，我会看到文件大小一次上下跳动几个字节。

```
C:\>mxmlc.exe Gallery.as
C:\Gallery.swf (28443 bytes)

C:\>mxmlc.exe Gallery.as
C:\Gallery.swf (28442 bytes)

C:\>mxmlc.exe Gallery.as
C:\Gallery.swf (28440 bytes)

C:\>mxmlc.exe Gallery.as
C:\Gallery.swf (28442 bytes) 
```

我想不出为什么会这样。即使我每次都删除输出文件，重新生成的文件大小仍然以这种方式变化。

任何想法为什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-09T15:44:33.667

Flex 编译器在您的 SWF 中包含一些信息，这些信息在构建之间会发生变化，例如构建的日期和时间。然后压缩 SWF。有时，对于不同的元数据，压缩比其他压缩效果更好，因此文件大小的微小变化。

[http://livedocs.adobe.com/flex/3/html/help.html?content=compilers_16.html#145380](http://livedocs.adobe.com/flex/3/html/help.html?content=compilers_16.html#145380)

# localization - Windows 设备管理器和硬件 ID

> ID：843504
> 
> 赞同：1
> 
> 时间：2009-05-09T15:34:01.843
> 
> 标签：localization, hardware, device-driver, device-manager

我很好奇 Windows 设备管理器如何获取设备的硬件 ID，即使尚未为该设备加载任何设备驱动程序。有人知道Windows是如何处理这个问题的吗？

在相关的说明中，我有兴趣支持我们正在编写的软件的语言本地化；设备和/或驱动程序是否可以以本地化方式报告其友好名称和描述？这已经有一个普遍的做法了吗？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-28T14:56:04.493

首先，要了解驱动加载的顺序，建议您将设备管理器切换到*查看| 按连接*模式排列的设备。

如您所见，这些设备位于其总线驱动程序下方。对于 PCI 设备，它将是“PCI 总线”。对于 USB 设备，它将是它们的 USB 集线器。每个总线驱动程序对如何格式化标识符字符串都有自己的想法：

*   设备实例 ID
*   硬件 ID
*   兼容的 ID
*   地点等

它返回它们以响应`IRP_MN_QUERY_ID`( `BusQueryInstanceID`, `BusQueryHardwareIDs`, `BusQueryCompatibleIDs`) 和`IRP_MN_QUERY_DEVICE_TEXT`( `DeviceTextDescription`,`DeviceTextLocationInformation`等)

当然，由于总线驱动程序首先枚举了设备（即创建了您所看到的子设备）（通过适用于总线的任何标准接口；例如 USB 上的“获取设备/字符串描述符”），它知道它们的供应商 ID、产品 ID 等

此时不必加载设备的驱动程序。事实上，它无法加载。设备 ID 正是指示 PnP 系统哪个驱动程序与设备匹配的内容。

至于本地化：

与`IRP_MN_QUERY_ID`提供用于设备匹配的不透明字符串不同，该`IRP_MN_QUERY_DEVICE_TEXT`信息确实旨在本地化。为此，您会在输入数据 ( ) 中收到请求的区域设置 ID (LCID `Parameters.QueryDeviceText.LocaleId`)。

[正如 Alphaneo 所指出的，USB 集线器驱动程序可能会将此 LCID 向前传递给 USB 设备（在 Get String Descriptor 请求中），希望 USB 设备本身具有本地化字符串。]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T16:07:56.997

顶层过程称为枚举。大多数现代设备总线都支持一种机制，让操作系统可以查询总线并确定哪些设备连接到总线。

PCI 系列总线都支持枚举。PCI 总线为此有一个特殊的[枚举空间](http://en.wikipedia.org/wiki/PCI_Configuration_Space)。这就是“即插即用”ID 的来源。

设备 ID 唯一标识总线上的设备，并使操作系统能够找到该设备的正确驱动程序。

包括 USB 和 FireWire 在内的其他总线具有枚举策略

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T09:03:45.287

设备 ID，是设备提供的信息的组合。例如，对于 USB 设备，字符串基于 VID 和 PID（供应商 ID 和产品 ID）。现在，如果没有加载驱动程序，这将不会发生。至少需要一些驱动程序，总线驱动程序必须为操作系统加载才能获取设备 ID。

现在，对于语言支持，我猜对于 WDM 驱动程序，有一个 QUERY_LANG 之类的，我记不太清了，或者像 USB 之类的一些设备有语言 ID 支持。此语言 ID 确定产品描述符字符串的语言。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-07T13:54:27.457

请注意，硬件标识符/序列号与真正的唯一硬件 ID 之间存在差异。也许这会更好地解释它：http: [//www.soft.tahionic.com/download-hdd_id/hardware%20ID%20programmer%27s%20DLL.html](http://www.soft.tahionic.com/download-hdd_id/hardware%20ID%20programmer%27s%20DLL.html)

# c# - 外壳图标覆盖 (C#)

> ID：843506
> 
> 赞同：6
> 
> 时间：2009-05-09T15:35:18.987
> 
> 标签：c#, c++, icons, overlay, shell-extensions

我需要一种方法来使用 C# 或 C++ 在 Windows XP/Vista 中为文件夹和文件创建图标覆盖？有什么例子吗？

谢谢，-肖恩！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-09T16:10:09.813

不**要这样做**！请，请不要。

你会破坏很多应用程序。Shell 扩展永远不能使用 .net 框架（或任何其他类似框架）。

[这是](http://blogs.msdn.com/oldnewthing/archive/2006/12/18/1317290.aspx)一个解释为什么你不能这样做。

用 C/C++ 编写你的扩展，而不是 C#。

更新：尽管从 .NET4 开始，可以在一个进程中拥有多个框架版本，但微软仍然**不**推荐也不支持它！请参阅[这篇](http://msdn.microsoft.com/en-us/magazine/ee819091.aspx)文章了解原因：

> [...] 这些问题导致我们正式建议反对（而不是支持）使用托管代码开发进程内 shell 扩展。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-09T15:49:45.907

Tigris 的[TortoiseSVN](http://tortoisesvn.net/downloads)产品大量使用由多个 Tortoise 产品共享的库提供的图标覆盖，这些覆盖本身是用 C++ 而不是 C# 编写的。

[TortoiseOverlays 项目](http://tortoisesvn.tigris.org/svn/tortoisesvn/TortoiseOverlays/version-1.0.5/Documentation.txt)的文档解释了他们如何使用它以及他们遇到的问题（用户名：guest，空密码），GPL 的源代码在[Subversion 存储库](http://tortoisesvn.tigris.org/svn/tortoisesvn/TortoiseOverlays/version-1.0.5/)中（与上面相同的用户名/密码）。

来自文档的片段：

> TortoiseOverlays 向资源管理器注册自己来处理上面提到的九个状态，即它注册了九个覆盖处理程序。资源管理器进程初始化 TortoiseOverlays 处理程序，调用它的 IShellIconOverlayIdentifier::GetOverlayInfo()。TortoiseOverlays 在 HKLM\Software\TortoiseOverlays\Statusname 下查找已注册的覆盖处理程序并调用它们的 GetOverlayInfo() 方法，以便它们也可以初始化（请注意，对图标名称、索引的任何更改......您的处理程序所做的任何更改都会在稍后被覆盖并赢得'不被使用 - 现在是 TortoiseOverlays 处理图标）。初始化之后，TortoiseOverlays 会将对其 IShellIconOverlayIdentifier::IsMemberOf() 方法的每个调用中继到其他处理程序。返回 S_OK 的第一个处理程序确定是否显示图标。

# asp.net-mvc - ASP.NET MVC/DDD 架构帮助

> ID：843513
> 
> 赞同：1
> 
> 时间：2009-05-09T15:42:16.947
> 
> 标签：asp.net-mvc, domain-driven-design

我正在使用 ASP.NET MVC 创建一个 Web 应用程序，并且我正在尝试使用域驱动设计。我有一个架构问题。

我有一个 WebControl 表来存储列表的键和值，以便它们可以编辑。我已经将它整合到我的业务模型中，但它会导致大量冗余代码，我不确定它是否属于那里。例如，在我的 Request 类中，我有一个名为 NeedType 的属性。因为它来自一个列表，所以我创建了一个 NeedType 类来为单选按钮提供值。我在这里只展示一个示例，但表单可能会有十几个需要来自数据库的列表。

[编辑，澄清问题]有什么更好的方法来做到这一点？这些列表对象真的是我的域的一部分还是仅存在于 UI 中？如果不是域的一部分，那么它们就不属于我的核心项目，那么它们会去哪里呢？

```
public class Request : DomainObject
{
   public virtual int RequestId { get; set; }
   public virtual DateTime SubmissionDate { get; set; }
   public virtual string NeedType { get; set; }
   public virtual string NeedDescription { get; set; }
   // etc.
}

public class NeedType : DomainObject
{
    public virtual int NeedTypeId { get; set; }
    public virtual string NeedTypeCode { get; set; }
    public virtual string NeedTypeName { get; set; }
    public virtual int DisplayOrder { get; set; }
    public virtual bool Active { get; set; }
}

public class RequestController : Controller
{
    private readonly IRequestRepository repository;

    public RequestController()
    {
        repository = new RequestRepository(new HybridSessionBuilder());
    }

    public RequestController(IRequestRepository repository)
    {
        this.repository = repository;
    }

    public ViewResult Index(RequestForm form)
    {
        ViewData.Add("NeedTypes", GetNeedTypes());
        if (form == null)
        {
            form = new RequestForm();
            form.BindTo(repository.GetById(125));
        }
    }

    private NeedType[] GetNeedTypes()
    {
        INeedTypeRepository repo = new NeedTypeRepository(new HybridSessionBuilder());
        return repo.GetAll();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T18:00:48.220

使用视图中所需的数据创建单独的视图模型。MVC 的 M 中的 Model 与 domainmodel 不同。MVC 视图模型是愚蠢的 DTO，没有行为，只有属性。域模型具有尽可能多的行为。带有 get;set; 的域模型 properties only 被认为是一种称为“贫血域模型”的反模式。大多数人将视图模型放在两个地方：在 Web 层，靠近视图和控制器，或者在应用程序服务层。

编辑：

当您只需要显示数据库中所有需求类型的列表和视图中的一个请求时，我确实会创建一个视图模型，其中请求和需求类型列表作为属性。我不认为在控制器中调用多个存储库是一种气味，除非您有一个更大的应用程序并且您可能想要一个单独的应用程序服务层，它通过一个方法调用返回整个视图模型。

我认为遵循 Todd Smith 关于价值对象的建议可能也是一个好主意。当用户可以在运行时添加或编辑需求类型时，需求类型应该是一个实体。当需要类型被硬编码并且仅随着项目的新版本而更改时，需要类型应该是一个值对象，并且需要类型的列表可以由诸如 NeedType.GetAll() 之类的东西填充，并通过向请求表中添加一列来存储在数据库中而不是单独的需要类型表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T17:16:56.530

如果它来自一个列表，那么我打赌这是一个外键。在设计域模型时根本不要考虑你的 UI。这只是 NeedType 是外键的情况。将字符串 NeedType 替换为对实际 NeedType 对象的引用。在您的数据库中，这将是对 id 的引用。

当您构建您的 NeedType 选项列表时，您只需提取每个 NeedType。如果它没有太大变化，也许保持缓存是一个好主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T18:02:38.620

你的 NeedType 对我来说就像一个价值对象。如果它是只读数据，那么它应该被视为 DDD 架构中的值对象，并且是您的域的一部分。

很多人在处理 DDD 时会遇到“omg so much冗余”问题，因为您不再使用旧的 Database -> DataTable -> UI 方法。

# jquery - 我如何 jquery 文档的一部分？

> ID：843515
> 
> 赞同：0
> 
> 时间：2009-05-09T15:44:35.290
> 
> 标签：jquery, dom

我查看了[JQuery 文档](http://docs.jquery.com/Main_Page)，阅读了常见问题解答并看到了很多示例。它看起来像获取文档中由规则描述的所有元素的集合，您编写代码

```
$(rule) 
```

其中 rule 是一个字符串，其语法在[此处](http://docs.jquery.com/Selectors)描述。Document 似乎是一个隐藏的输入参数。我可以对 DOM 的子树做同样的事情吗？如果我有一个 DOM 元素，我可以编写类似的代码吗

```
element.$(rule) 
```

?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T15:53:51.267

```
$(rule, element) 
```

从文档：

> jQuery（表达式，上下文）
> 
> jQuery 的核心功能围绕着这个功能。jQuery 中的所有内容都基于此，或以某种方式使用此。该函数最基本的用途是传入一个表达式（通常由 CSS 组成），然后查找所有匹配的元素。
> 
> 默认情况下，如果没有指定上下文，$() 会在当前 HTML 文档的上下文中查找 DOM 元素。如果您确实指定了上下文，例如 DOM 元素或 jQuery 对象，则表达式将与该上下文的内容相匹配。
> 
> 有关表达式允许的 CSS 语法，请参阅选择器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T16:14:17.013

有几种方法可以做到这一点。如果你有这样的文件：

```
<html>
<body>
  <p>Test</p>
  <div id="box">
    <p>Hi There</p>
    <div id="subbox">
      <p>Bye</p>
    </div>
  </div>
  <p>Boo</p>
</body>
</html> 
```

而您只想要框中的段落，您可以[`specify a context`](http://docs.jquery.com/Core/jQuery#expressioncontext)搜索：

```
$('p','#box'); // only find paragraphs inside of #box 
```

或者您可以使用诸如[`find`](http://docs.jquery.com/Traversing/find#expr)or之类的函数[`children`](http://docs.jquery.com/Traversing/children#expr)：

```
$('#box').find('p'); // will return both the paragraphs inside of #box

$('#box').children('p'); // will only return the immediate children 
```

我通常喜欢尽可能多地分隔搜索词，而不是使用非常长的选择器，因为 a) 我认为这样考虑更有意义，b) 它有助于 jQuery 进行解析，因此它稍微快一些。因此，每当我只想搜索文档的一部分时，我有时会结合使用上下文和附加功能：

```
$(myelement, mygreatercontext).find(myrefinedsearch); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T15:50:41.303

`$(element).find(rule)`

# mysql - 更新 db 6000 次需要几分钟？

> ID：843524
> 
> 赞同：1
> 
> 时间：2009-05-09T15:50:29.510
> 
> 标签：mysql, ruby-on-rails, ruby, sqlite, activerecord

我正在用 Ruby 和 ActiveRecord 编写一个测试程序，它会读取一个 6000 字长的文档。然后我只是通过

```
recordWord = Word.find_by_s(word);
if (recordWord.nil?)
  recordWord = Word.new
  recordWord.s = word
end
if recordWord.count.nil?
  recordWord.count = 1
else
  recordWord.count += 1
end
recordWord.save 
```

所以这部分循环了6000次......至少使用sqlite3运行需要几分钟。正常吗？我期待它可以在几秒钟内运行...... MySQL 可以加快速度吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-09T15:58:49.387

通过 6000 次调用写入数据库，您将看到速度问题。我会将各种记录保存在内存中，最后保存到数据库一次，而不是一路上保存 6000 次。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-10T01:30:59.183

看看 AR:Extensions 以及处理批量插入。

[http://rubypond.com/articles/2008/06/18/bulk-insertion-of-data-with-activerecord/](http://rubypond.com/articles/2008/06/18/bulk-insertion-of-data-with-activerecord/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T19:59:03.630

我用 perl 写了一些简单的代码：

1.  创建数据库
2.  插入仅包含单个整数的记录
3.  检索最近的记录并验证它是否返回它插入的内容

它执行步骤#2 和#3 6000 次。这显然比拥有一个完整的对象/关系桥的工作量要轻得多。对于这个使用 SQLite 的简单案例，它仍然需要 17 秒才能执行，因此您希望花费“几秒钟”的时间在“传统硬件”上是不现实的。

使用监视器，我确认主要是磁盘活动导致其变慢。基于此，如果由于某种原因您确实需要数据库快速运行，我建议您选择以下两个选项之一：

1.  做人们建议的事情并绕过要求
2.  尝试购买一些固态磁盘。

我认为＃1是一个很好的开始:)

代码：

```
#!/usr/bin/perl

use warnings;
use strict;

use DBI;

my $dbh = DBI->connect('dbi:SQLite:dbname=/tmp/dbfile', '', '');

create_database($dbh);
insert_data($dbh);

sub insert_data {
  my ($dbh) = @_;

  my $insert_sql = "INSERT INTO test_table (test_data) values (?)";
  my $retrieve_sql = "SELECT test_data FROM test_table WHERE test_data = ?";

  my $insert_sth = $dbh->prepare($insert_sql);
  my $retrieve_sth = $dbh->prepare($retrieve_sql);

  my $i = 0;
  while (++$i < 6000) {
     $insert_sth->execute(($i));
     $retrieve_sth->execute(($i));

     my $hash_ref = $retrieve_sth->fetchrow_hashref;

     die "bad data!" unless $hash_ref->{'test_data'} == $i;
  }
}

sub create_database {
   my ($dbh) = @_;

   my $status = $dbh->do("DROP TABLE test_table");
   # return error status if CREATE resulted in error
   if (!defined $status) {
     print "DROP TABLE failed";
   }

   my $create_statement = "CREATE TABLE test_table (id INTEGER PRIMARY KEY AUTOINCREMENT, \n";
   $create_statement .= "test_data varchar(255)\n";
   $create_statement .= ");";

   $status = $dbh->do($create_statement);

   # return error status if CREATE resulted in error
   if (!defined $status) {
     die "CREATE failed";
   }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T19:41:38.977

您使用的是哪种数据库连接？一些数据库允许您“直接”连接，而不是使用通过网络堆栈的 TCP 网络连接。换句话说，如果您正在建立互联网连接并通过这种方式发送数据，它可能会减慢速度。

提高数据库连接性能的另一种方法是将 SQL 语句组合在一个命令中。

例如，制作一条 6,000 行的 SQL 语句，如下所示

```
"update words set count = count + 1 where word = 'the'
update words set count = count + 1 where word = 'in'
...
update words set count = count + 1 where word = 'copacetic'" 
```

并将其作为单个命令运行，性能会好很多。默认情况下，MySQL 的“数据包大小”限制为 1 兆字节，但如果需要，您可以在 my.ini 文件中将其更改为更大。

由于您通过 ActiveRecord 抽象出数据库调用，因此您无法控制如何发出命令，因此很难优化您的代码。

**您可以**做的另一件事是将单词计数保留在内存中，然后仅将最终总数插入数据库，而不是每次遇到单词时进行更新。这可能会大大减少插入的数量，因为如果您每次遇到“the”这个词时都进行更新，那将是巨大的浪费。单词具有“长尾”分布，最常见的单词比更晦涩的单词更常见。然后底层 SQL 看起来更像这样：

```
"update words set count = 300 where word = 'the'
update words set count = 250 where word = 'in'
...
update words set count = 1 where word = 'copacetic'" 
```

如果您担心占用太多内存，您可以数单词并定期“刷新”它们。因此，阅读几兆字节的文本，然后花几秒钟更新总数，而不是每次遇到每个单词时都更新它。如果你想进一步提高性能，你应该考虑直接批量发出SQL命令

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T20:12:43.160

在不了解 Ruby 和 Sqlite 的情况下，一些一般提示：

在 Word.s 上创建唯一索引（您没有说明是否有）

为数据库中的 Word.count 定义一个默认值（DEFAULT 1）

优化计数分配：

```
recordWord = Word.find_by_s(word);
if (recordWord.nil?)
    recordWord = Word.new
    recordWord.s = word
    recordWord.count = 1
else
    recordWord.count += 1
end
recordWord.save 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-11T19:56:58.900

在更新之前使用 BEGIN TRANSACTION，然后在最后使用 COMMIT。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T06:33:54.683

好的，我发现了一些一般规则：

1）首先使用哈希来保持计数，而不是数据库
2）最后，将所有插入或更新包装在一个事务中，这样它就不会击中数据库 6000 次。

# wcf - 使用带有 WCF 且没有浏览器的 OpenID，这可能吗？

> ID：843529
> 
> 赞同：9
> 
> 时间：2009-05-09T15:52:05.263
> 
> 标签：wcf, openid

从我对 OpenID 所做的大部分阅读来看，似乎可能需要浏览器。我正在编写一个 WCF 应用程序并想使用 OpenID 作为身份验证方法，但我的应用程序不是 Web 应用程序。是否可以在不需要 Web 浏览器的情况下同时使用 WCF 和 OpenID？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-09T19:56:13.730

虽然 OpenID 可以吹捧其规范独立于 cookie 等，因为规范实际上并没有规定如何使用这些东西，但实际上，除了登录网站之外，我从未见过一个好的 OpenID 解决方案，这真的是它的主要用例。

但是，有一个好方法可以继续使用 WCF 和 OpenID。将 OAuth 添加到组合中。[DotNetOpenAuth](http://dotnetopenid.googlecode.com/)库有一个示例，该示例显示了 WCF 客户端如何获得授权以通过 OAuth 调用 WCF 服务，在服务端，用户使用 OpenID 作为授权过程的一部分进行登录。

因此，基本上，如果您的 WCF 应用程序需要“登录”才能调用 WCF 服务，则作为一次性设置的一部分：

1.  该应用程序会弹出一个浏览器，用户可以在其中看到 WCF 服务网站（OAuth 服务提供者）
2.  用户使用他们的 OpenID 登录（尽管用户可能已经登录，在这种情况下他们可以跳过这一步）
3.  OAuth SP 询问用户“您要授权此 [wcf 应用程序] 访问此站点吗？”
4.  用户说是，然后关闭浏览器。
5.  由于 OAuth 协议，WCF 应用现在可以访问 WCF 服务。

这是因为在幕后，当用户通过 Web 浏览器对服务说“是”时，会为 WCF 应用程序分配一个特殊的机器友好凭证，该凭证用于每个 WCF 服务调用，类似于用户名/密码是。

查看 DotNetOpenAuth 库。它有样本和一切你需要让它工作的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T16:07:02.847

通过阅读[OpenID Authentication 2.0 Specification](http://openid.net/specs/openid-authentication-2_0.html)，我似乎得到了答案：

> **虽然协议中的任何内容都不需要 JavaScript 或现代浏览器**，但身份验证方案与“AJAX”风格的设置很好地配合。这意味着最终用户无需离开当前网页即可向依赖方证明其身份。
> 
> OpenID 身份验证仅使用标准 HTTP(S) 请求和响应，因此**它不需要用户代理或其他客户端软件的任何特殊功能**。OpenID 与 cookie 的使用或依赖方或 OpenID 提供者会话管理的任何其他特定机制无关。对用户代理的扩展可以简化最终用户交互，但不需要使用该协议。

现在我只需要想出一个聪明的方法让它与基于 WCF 的依赖方一起工作......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T20:16:16.210

拿一个[OpenIdMembershipProvider](http://www.codeplex.com/OpenIDMembership)（也许其他人存在）。 [然后在 WCF 中配置消息安全性，使用用户名身份验证，然后您可以使用 ASPNET MembershipProvider 对您的用户进行身份验证。](http://msdn.microsoft.com/en-us/library/ms731049.aspx) 我认为您找不到更简单的解决方案；）

# python - 在 Mac OS X 上使用 virtualenv

> ID：843531
> 
> 赞同：4
> 
> 时间：2009-05-09T15:53:02.733
> 
> 标签：python, macos, virtualenv

我一直在 Ubuntu 上使用 virtualenv，它很糟糕，所以我试图在我的 Mac 上使用它，但遇到了麻烦。

该`virtualenv`命令成功创建了目录，并`easy_install`很乐意在其中安装软件包，但我无法导入我安装的任何内容。似乎`sys.path`没有正确设置：它不包括 virtual `site-packages`，即使我使用该`--no-site-packages`选项。难道我做错了什么？

我在 Mac OS 10.5.6 上使用 Python 2.5.1 和 virtualenv 1.3.3

**编辑**：这是我尝试使用 virtualenv 时发生的情况：

```
$ virtualenv test
New python executable in test/bin/python
Installing setuptools............done.
$ source test/bin/activate
(test)$ which python
/Users/Justin/test/bin/python
(test)$ which easy_install
/Users/Justin/test/bin/easy_install
(test)$ easy_install webcolors
[...]
Installed /Users/Justin/test/lib/python2.5/site-packages/webcolors-1.3-py2.5.egg
Processing dependencies for webcolors
Finished processing dependencies for webcolors
(test)$ python
[...]
>>> import webcolors
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named webcolors
>>> import sys
>>> print sys.path
['',
 '/Library/Python/2.5/site-packages/SQLObject-0.10.2-py2.5.egg',
 '/Library/Python/2.5/site-packages/FormEncode-1.0.1-py2.5.egg',
 ...,
 '/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5',
 '/Users/Justin/test/lib/python25.zip',
 '/Users/Justin/test/lib/python2.5',
 '/Users/Justin/test/lib/python2.5/plat-darwin',
 '/Users/Justin/test/lib/python2.5/plat-mac',
 '/Users/Justin/test/lib/python2.5/plat-mac/lib-scriptpackages',
 '/Users/Justin/test/Extras/lib/python',
 '/Users/Justin/test/lib/python2.5/lib-tk',
 '/Users/Justin/test/lib/python2.5/lib-dynload',
 '/Library/Python/2.5/site-packages',
 '/Library/Python/2.5/site-packages/PIL'] 
```

**编辑 2**：使用`activate_this.py`脚本有效，但运行`source bin/activate`无效。希望这有助于缩小问题范围？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T16:00:13.127

我对相同的 OS X/Python/virtualenv 版本（OS X 10.5.6、Python 2.5.1、virtualenv 1.3.1）没有任何问题

```
$ virtualenv test
New python executable in test/bin/python
Installing setuptools............done.
$ source test/bin/activate
(test)$ which python
/Users/dbr/test/bin/python
$ echo $PATH
/Users/dbr/test/bin:/usr/bin:[...]
$ python
[...]
>>> import sys
>>> print sys.path
['', '/Users/dbr/test/lib/python2.5/site-packages/setuptools-0.6c9-py2.5.egg', 
```

要检查的一件事 - 在干净的 shell 中，运行以下命令：

```
$ virtualenv test
$ python
[...]
>>> import sys
>>> sys.path
['', '/Library/Python/2.5/site-packages/elementtree-1.2.7_20070827_preview-py2.5.egg'[...]
>>> sys.path.append("test/bin/")
>>> import activate_this
>>> sys.path
['/Users/dbr/test/lib/python2.5/site-packages/setuptools-0.6c9-py2.5.egg' 
```

或者来自 virtualenv 文档：

```
activate_this = '/path/to/env/bin/activate_this.py'
execfile(activate_this, dict(__file__=activate_this)) 
```

这应该强制当前的 Python shell 进入 virtualenv

此外，在运行带有标志（详细）`source test/bin/activate`的尝试运行 python之后，它可能会产生一些有用的东西。`-v`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T23:54:38.483

事实证明，virtualenv 的问题是我自己的错：我`.bash_profile`将环境变量配置为 muck `PYTHONPATH`，这导致了导入问题。

感谢所有花时间回答的人；很抱歉没有自己进一步调查这个问题。

# iphone - 翻转视图 Iphone

> ID：843534
> 
> 赞同：15
> 
> 时间：2009-05-09T15:55:20.170
> 
> 标签：iphone, flip

请考虑下面的代码，并告诉我我做错了什么。

我想在两个 UIView 之间切换。

不知何故，当我从初始视图翻转时，我只是得到翻转的视图，没有动画。当我向后翻转时，动画显示得很好。

翻转是从视图本身的按钮触发的。

```
- (IBAction)showMoreInfo:(id)sender
{
    UIView *moreInfo = self.flipView;

    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:2.0];
    [UIView setAnimationBeginsFromCurrentState:NO];
    [UIView setAnimationTransition:UIViewAnimationTransitionFlipFromRight forView:self.view cache:YES];

    UIView *parent = self.view.superview;
    [self.view removeFromSuperview];

    [parent addSubview:moreInfo];

    [UIView commitAnimations];

}

- (IBAction)showLessInfo:(id)sender
{
    UIView *lessInfo = self.view;

    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:2.0];
    [UIView setAnimationBeginsFromCurrentState:NO];
    [UIView setAnimationTransition:UIViewAnimationTransitionFlipFromLeft forView:self.flipView cache:YES];

    UIView *parent = self.flipView.superview;
    [self.flipView removeFromSuperview];

    [parent addSubview:lessInfo];

    [UIView commitAnimations];

} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-09T16:11:41.667

这可能是因为您没有使用容器视图作为过渡视图。请参阅有关[setAnimationTransition:forView:cache 的文档：](http://developer.apple.com/iPhone/library/documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/clm/UIView/setAnimationTransition:forView:cache:)

> 如果你想在过渡期间改变视图的外观——例如，从一个视图翻转到另一个——然后使用容器视图，即 UIView 的一个实例，如下所示：
> 
> 1.  开始一个动画块。
> 2.  在容器视图上设置过渡。
> 3.  从容器视图中移除子视图。
> 4.  将新的子视图添加到容器视图。
> 5.  提交动画块。

尝试`self.view.superview`在动画过渡视图中使用`showMoreInfo:`

该`showLessInfo:`方法有效的原因是您使用的是容器视图。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-01-21T00:29:45.757

你可以使用你的 MainWindow (UIWindow) 作为 UIView 继承的 UIWindow 的容器视图吗？

iPhone 3.0 还通过 presentModalViewController 方法引入了翻转事务：

```
CustomViewController *vc = [[CustomViewController alloc]
    initWithNibName:@"CustomViewController" bundle:nil];

vc.delegate = self;

// The magic statement. This will flip from right to left.
// present the modal view controller then when you dismissModalViewController
// it will transition flip from left to right. Simple and elegant.
vc.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;

[self presentModalViewController:vc animated:YES];

[vc release]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-07T21:39:08.210

在 iOS 4.0 之后，您可以通过以下方式在视图之间切换：

```
[UIView transitionFromView:sourceView toView:destinationView duration:0.35f options:UIViewAnimationOptionTransitionFlipFromRight completion:^(BOOL finished) {
    NSLog(@"I just flipped!");
}]; 
```

正如 Jason 所提到的，您需要在容器视图中执行此操作。

# c++ - 当添加子选项卡时，如何使 qtabwidget 实例自动调整大小？

> ID：843540
> 
> 赞同：0
> 
> 时间：2009-05-09T16:01:26.353
> 
> 标签：c++, qt, qt4

我试图让 QTabWidget 在添加子项时自动调整大小以适合子选项卡，但无法这样做。我使用 Qt Designer 创建了一个表单，并使用如下的单一继承方法继承了它。

```
class MyWidget : public QWidget
{
    Q_OBJECT

public:
    MyWidget(QWidget *parent = 0);
private:
    Ui::MyForm ui;
}; 
```

我有一个 QTabWidget，我正在使用 addTab() 将对象的实例添加到我的 QTabWidget。当我显示 QTabWidget 时，我注意到它没有调整大小以适应 MyWidget 实例。我需要做什么来确保 QTabWidget 实例自动调整大小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T19:28:41.230

在设计器中，确保向小部件添加布局。单击小部件的背景，以便在应用布局时将其应用于整个小部件。诀窍是构建表单的基础（父）小部件需要布局，而不仅仅是表单中的项目。

网格通常很容易使用。但有时其他的更好。Designer 使用起来可能很棘手，需要一段时间才能习惯。基本上每个小部件都应该应用一个布局。如果你不这样做，奇怪的事情就会发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-20T14:57:53.533

我相信这是 Creator 的错误（至少对于 V4.7.4 开源）。我的解决方案如下。

不要在主项目中创建 QTabWidget 对象。

独立创建它（通过创建 Qt-> Form-class）。

然后，将 3 个文件（.h、.cpp、.ui）复制到项目中，并将它们添加到项目中。

结果是：它调整大小作为主窗口调整大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T18:08:38.730

要将任何小部件放入其父小部件中，您需要使用特定的布局（网格、水平、垂直等）。

# sql-server - SQL server 和 T-SQL 有什么好的在线资源？

> ID：843541
> 
> 赞同：0
> 
> 时间：2009-05-09T16:04:22.383
> 
> 标签：sql-server, tsql

背景：

下周某个时间我有一个需要 SQL Server 的面试（对于 Jr 职位）。职位描述声明“必须能够在 C# 和 SQL Server 设计测试中取得高分”。

我觉得我在 C# 部分很扎实，而且我认为我在与实现无关的数据库设计方面做得很好（重读 Carlis & Maguire 的“Mastering Data Modeling”，它在大学里教过，并通读了“Database Design For Mere凡人”过去一周）。我对基本 SQL 有相当的了解，但主要来自 2 年前的课程（我在当前工作中没有使用 RDBMS），并且在我的外部项目中，我使用的是 LINQ to SQL，因此没有太多直接的 DB 交互，并且更多的是程序驱动了对数据的需求，而对于这个职位，我觉得情况正好相反。

有哪些好的在线资源或教程可以加快速度？这是一个初级职位，所以我不想在几天内成为专家，但我至少需要知道我在说什么。理想情况下，我想要类似于我非常喜欢的[Dive Into Python](http://www.diveintopython.org/toc/index.html)的东西。寻找可以在 2-3 天左右消化的东西，以便将理论转化为实践，还需要复习语法，以及需要注意的特定于 SQL Server/T-SQL 的东西。

也可能一些基本的 ADO.NET 资源也可能很好。我正在采访的公司尚未升级到 .NET 3.5，因此 LINQ to SQL 和实体框架将不可用。不太确定我是否需要这么多的面试，但还是很高兴知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T16:09:04.153

我正在为此整理笔记。我知道有更好的资源，但这就是我正在做的事情来跟踪我的笔记，你可能有兴趣在学习时做同样的事情。[http://tinyurl.com/r2y5tw](http://tinyurl.com/r2y5tw)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T23:32:19.827

SQL Server 联机丛书

*   [按工作角色浏览](http://msdn.microsoft.com/en-us/library/bb510422.aspx)
*   [教程](http://msdn.microsoft.com/en-us/library/ms169620.aspx)
*   [操作方法主题](http://msdn.microsoft.com/en-us/library/bb964704.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T06:29:55.590

[SQLTeam.com](http://www.sqlteam.com) is a great resource for this everything T-SQL.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T07:06:08.920

In addition to Books Online:

[Introduction to SQL Server](http://www.functionx.com/sqlserver/) (contains step by step walkthroughs)

[Common Solutions for T-SQL Problems](http://code.msdn.microsoft.com/SQLExamples)

[Script Repository: SQL Server 2005](http://www.microsoft.com/technet/scriptcenter/scripts/sql/sql2005/default.mspx?mfr=true)

SO has some answers pointing at very useful resources:

*   [Library of Useful (Difficult) SQL scripts](https://stackoverflow.com/questions/197369/library-of-useful-difficult-sql-scripts/197378#197378)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T08:18:58.360

Brent Ozar 是社区中著名且备受推崇的 SQL Server DBA，其网站的整个区域都致力于成为 DBA。

[http://www.brentozar.com/becoming-a-dba/](http://www.brentozar.com/becoming-a-dba/)

关于数据库设计，我相信您已经考虑过这一点，但是我建议您复习一下您对规范化过程的知识和理解。事务隔离级别是另一个常见的主题领域，因此请在 SQL Server 联机丛书中查找它们。

如果您在学习方面需要任何帮助或有任何 SQL Server 查询，欢迎随时与我联系。

[http://www.johnsansom.com](http://www.johnsansom.com)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T08:06:00.820

我一直喜欢[SQL Server Central](http://sqlservercentral.com)。他们有很多好文章，每天都有一个你可以尝试回答的每日问题。QOTD 是一种很好的方法，可以强迫自己了解您通常不了解的 SQL Server 领域。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-20T13:00:40.443

提供一些鲜为人知且可能更棘手的资源：

[http://wiki.lessthandot.com/index.php/Category:Microsoft_SQL_Server](http://wiki.lessthandot.com/index.php/Category:Microsoft_SQL_Server)
[http://rusanu.com/articles/](http://rusanu.com/articles/)

否则，您可能想在有限的时间内投资在线订阅[Safari 图书。](https://ssl.safaribooksonline.com/trial?)他们有大部分书籍可供在线阅读，或最终下载一些章节。

# regex - 如何有效地处理同一字符串上的多个 Perl 搜索/替换操作？

> ID：843542
> 
> 赞同：5
> 
> 时间：2009-05-09T16:05:13.117
> 
> 标签：regex, perl, hash, substitution

所以我的 Perl 脚本基本上接受一个字符串，然后尝试通过对其进行多次搜索和替换来清理它，如下所示：

```
$text =~ s/<[^>]+>/ /g;
$text =~ s/\s+/ /g;
$text =~ s/[\(\{\[]\d+[\(\{\[]/ /g;
$text =~ s/\s+[<>]+\s+/\. /g;
$text =~ s/\s+/ /g;
$text =~ s/\.*\s*[\*|\#]+\s*([A-Z\"])/\. $1/g; # replace . **** Begin or . #### Begin or ) *The 
$text =~ s/\.\s*\([^\)]*\) ([A-Z])/\. $1/g; # . (blah blah) S... => . S... 
```

如您所见，我正在处理令人讨厌的 html，并且必须击败它才能提交。

我希望有一种更简单、更美观的方式来做到这一点。我有大约 50 行看起来就像上面的一样。

我已经通过使用哈希解决了这个问题的一个版本，其中键是注释，哈希是 reg 表达式，如下所示：

```
%rxcheck = (
        'time of day'=>'\d+:\d+', 
    'starts with capital letters then a capital word'=>'^([A-Z]+\s)+[A-Z][a-z]',
    'ends with a single capital letter'=>'\b[A-Z]\.'
} 
```

这就是我使用它的方式：

```
 foreach my $key (keys %rxcheck) {
if($snippet =~ /$rxcheck{ $key }/g){ blah blah  }
 } 
```

当我尝试一个哈希值时，问题就出现了，其中键是表达式，它指向我想要替换它的内容......并且里面有一个 $1 或 $2。

```
%rxcheck2 = (
        '(\w) \"'=>'$1\"'
} 
```

上面就是这样做的：

```
$snippet =~ s/(\w) \"/$1\"/g; 
```

但我似乎无法将“$1”部分逐字传递到正则表达式中（我认为这是正确的词......即使我使用了 ' 标记，似乎 $1 正在被解释。）所以这导致：

```
if($snippet =~ /$key/$rxcheck2{ $key }/g){  } 
```

那是行不通的。

所以2个问题：

简单：如何以易于编辑的方式处理大量正则表达式，以便我可以更改和添加它们，而无需剪切和粘贴之前的行？

更难：我如何使用散列（或数组，如果我想包含多个部分，例如 1）要搜索的部分，2）替换 3）注释，4）全局/不区分大小写的修饰符），如果这实际上是最简单的方法吗？

谢谢你的帮助 -

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-09T16:56:29.753

## 问题 #1

由于各个正则表达式似乎没有多少结构共享，因此没有比仅列出您所做的命令更简单或更清晰的方法。在这样的代码中减少重复的一种常见方法是`$text`进入`$_`, 这样就不必说：

```
$text =~ s/foo/bar/g; 
```

你可以说：

```
s/foo/bar/g; 
```

这样做的一个常见习惯用法是使用退化`for()`循环作为主题化器：

```
for($text)
{
  s/foo/bar/g;
  s/qux/meh/g;
  ...
} 
```

此块的范围将保留 的任何预先存在`$_`的值，因此无需显式地`local`ize `$_`。

至此，您已经消除了几乎所有非样板字符——即使在理论上，它还能缩短多少？

除非你真正想要的（正如你的问题 #2 所暗示的）是改进的*模块化*，例如，迭代、报告、计数等所有正则表达式的能力。

## 问题 #2

您可以使用`qr//`语法来引用替换的“搜索”部分：

```
my $search = qr/(<[^>]+>)/;
$str =~ s/$search/foo,$1,bar/; 
```

但是我不知道如何充分引用“替换”部分。我曾希望这`qr//`也能解决这个问题，但事实并非如此。有两种选择值得考虑：

**1.`eval()`在你的`foreach`循环中使用。** 这将使您能够保留当前的`%rxcheck2`哈希值。缺点：您应该始终关注 string`eval()`的安全性。

**2\. 使用匿名子程序数组：**

```
my @replacements = (
    sub { $_[0] =~ s/<[^>]+>/ /g; },
    sub { $_[0] =~ s/\s+/ /g; },
    sub { $_[0] =~ s/[\(\{\[]\d+[\(\{\[]/ /g; },
    sub { $_[0] =~ s/\s+[<>]+\s+/\. /g },
    sub { $_[0] =~ s/\s+/ /g; },
    sub { $_[0] =~ s/\.*\s*[\*|\#]+\s*([A-Z\"])/\. $1/g; },
    sub { $_[0] =~ s/\.\s*\([^\)]*\) ([A-Z])/\. $1/g; }
);

# Assume your data is in $_
foreach my $repl (@replacements) {
    &{$repl}($_);
} 
```

您当然可以使用散列代替一些更有用的键作为散列，和/或您可以使用多值元素（或散列值），包括注释或其他信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T16:47:57.960

哈希不好，因为它们是无序的。我发现一个数组数组，其第二个数组包含一个已编译的正则表达式和一个要评估的字符串（实际上它是一个双重评估）效果最好：

```
#!/usr/bin/perl

use strict;
use warnings;

my @replace = (
    [ qr/(bar)/ => '"<$1>"' ],
    [ qr/foo/   => '"bar"'  ],
);

my $s = "foo bar baz foo bar baz";

for my $replace (@replace) {
    $s =~ s/$replace->[0]/$replace->[1]/gee;
}

print "$s\n"; 
```

我认为 j_random_hacker 的第二个解决方案比我的要好得多。单个子程序为您提供最大的灵活性，并且比我的`/ee`解决方案快一个数量级：

```
bar <bar> baz bar <bar> baz
bar <bar> baz bar <bar> baz
         Rate refs subs
refs  10288/s   -- -91%
subs 111348/s 982%   -- 
```

这是产生这些数字的代码：

```
#!/usr/bin/perl

use strict;
use warnings;

use Benchmark;

my @subs = (
    sub { $_[0] =~ s/(bar)/<$1>/g },
    sub { $_[0] =~ s/foo/bar/g },
);

my @refs = (
    [ qr/(bar)/ => '"<$1>"' ],
    [ qr/foo/   => '"bar"'  ],
);

my %subs = (
    subs => sub {
        my $s = "foo bar baz foo bar baz";
        for my $sub (@subs) {
            $sub->($s);
        }
        return $s;
    },
    refs => sub {
        my $s = "foo bar baz foo bar baz";
        for my $ref (@refs) {
            $s =~ s/$ref->[0]/$ref->[1]/gee;
        }
        return $s;
    }
);

for my $sub (keys %subs) {
    print $subs{$sub}(), "\n";
}

Benchmark::cmpthese -1, \%subs; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-09T17:09:37.993

你说你正在处理 HTML。您现在意识到这几乎是一场短暂而脆弱的解决方案的失败战斗。

一个合适的 HTML 解析器会让你的生活更轻松。[HTML::Parser](http://search.cpan.org/~gaas/HTML-Parser-3.60/)可能很难使用，但[CPAN](http://search.cpan.org)上还有其他非常有用的库，如果你可以指定*你*正在尝试做什么而不是*如何*.

# iphone - iPhone 3.0 beta 5 更新：“错误：更新基带：无法验证 fls”

> ID：843543
> 
> 赞同：-2
> 
> 时间：2009-05-09T16:05:15.347
> 
> 标签：iphone

我正在尝试将我的 iPhone 更新到 3.0 beta 5 操作系统，但在更新过程结束时出现此错误：

错误：更新基带：无法验证 fls

然后手机进入粉红色的“连接到 iTunes”屏幕。

有想法该怎么解决这个吗？谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T19:44:31.527

发生此错误是因为

1.  我尝试使用 Organizer 更新 iPhone 软件
2.  在我的开发机器上恢复了 iPhone，而不是 iPhone 同步到的机器上

我终于想出了如何解决它。我在 iPhone 同步到的机器上使用了 iTunes，并将其恢复到 2.2.1 操作系统。为此，我必须将 iPhone 置于 DFU 模式，然后在 iTunes 中的“恢复”按钮上单击（Windows）并选择 2.2.1 .ipsw。

iPhone 恢复后，我通过单击 iTunes 中的检查更新按钮并从文件浏览器中选择 3.0 操作系统，将手机更新到 3.0 操作系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T20:48:09.420

> 我有同样的问题，虽然我似乎找不到旧的 2.2.1 .ipsw 文件的副本。我可以在哪里找到这个的任何想法？我在苹果网站的开发者区域到处找。可以找到 sdk 但找不到 .ipsw....

尝试按下 iTunes 上的“恢复”按钮。它应该开始为您下载最新的固件版本（2.2.1）。

# javascript - 解析 JavaScript 以检测代码

> ID：843546
> 
> 赞同：7
> 
> 时间：2009-05-09T16:05:33.803
> 
> 标签：javascript, python, parsing, spidermonkey

我需要将 JavaScript 文件拆分为单个指令。例如

```
a = 2;
foo()
function bar() {
    b = 5;
    print("spam");
} 
```

必须分成三个指令。（赋值、函数调用和函数定义）。

基本上我需要检测代码，在这些指令之间注入代码以执行检查。用“;”分割 显然不会起作用，因为您也可以用换行符结束指令，也许我不想在函数和类定义中检测代码（我还不知道）。我参加了关于[flex](http://en.wikipedia.org/wiki/Flex_lexical_analyser) / [Bison](http://en.wikipedia.org/wiki/GNU_bison)语法的课程，但在这种情况下，该规则的语义操作将是“打印解析树中的所有后代并将我的代码放在最后”，我认为这是基本的 Bison 无法完成的. 我该怎么做呢？我还需要拆分代码，因为我需要使用 python-spidermonkey 与 Python 交互。或者......是否已经有一个图书馆可以让我免于重新发明轮子？它不必在 Python 中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T16:28:39.230

为什么不使用 JavaScript 解析器？有很多，包括用于 ANTLR 的 Python API 和围绕 SpiderMonkey 的 Python 包装器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-27T04:32:51.010

JavaScript 很难解析；你需要一个完整的 JavaScript 解析器。[DMS Software Reengineering Toolkit](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)可以解析完整的JavaScript 并构建相应的[AST](http://en.wikipedia.org/wiki/Abstract_syntax_tree)。然后可以使用 AST 运算符遍历树以“拆分它”。然而，更简单的是应用源到源的转换，寻找一种表面语法 (JavaScript) 模式，然后用另一种替换它。您可以使用此类转换将插桩插入代码中，而不是拆分代码以保留进行插入的操作。转换完成后，DMS 可以重新生成有效的 JavaScript 代码（如果不受影响，则包含原始注释）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T16:29:54.113

为什么不使用现有的 JavaScript 解释器，如[Rhino](http://www.mozilla.org/rhino/) (Java) 或[python-spidermonkey](http://pypi.python.org/pypi/python-spidermonkey)（不确定这个解释器是否还活着）？它将解析 JS，然后您可以检查生成的解析树。我不确定重新创建原始代码有多容易，但这主要取决于检测代码的可读性。如果没有人看过它，只需生成一个非常紧凑的表格。

[睡衣](http://pyjamas.sourceforge.net/)也可能很有趣；这是一个 Python 到 JavaScript 的转译器。

[编辑] 虽然乍一看这并不能解决您的问题，但您可以将其用于不同的方法：而不是检测 JavaScript，而是用 Python 编写代码（可以轻松检测；所有工具都已经存在）和然后将结果转换为 JavaScript。

最后，如果您想在 Python 中解决问题但找不到解析器：使用 Java 引擎将注释添加到代码中，然后您可以在 Python 中搜索以检测代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-18T11:44:45.373

忘记我的解析器。[https://bitbucket.org/mvantellingen/pyjsparser](https://bitbucket.org/mvantellingen/pyjsparser)是伟大而完整的解析器。我在这里修复了一些错误：[https ://bitbucket.org/nullie/pyjsparser](https://bitbucket.org/nullie/pyjsparser)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T18:28:34.910

为什么不试试 javascript 美化器？

例如[http://jsbeautifier.org/](http://jsbeautifier.org/)

或查看[适用于 Windows 和 Linux 的命令行 JavaScript 代码美化器](https://stackoverflow.com/questions/18985/javascript-beautifier)

# geolocation - Google 地理编码 API（City => long, lat）

> ID：843549
> 
> 赞同：22
> 
> 时间：2009-05-09T16:06:33.003
> 
> 标签：geolocation, google-api, geocoding

Google 是否提供 RESTful API，我可以在其中传递城市名称（或 zip）并返回经度和纬度。

我知道如何使用 Google Maps API 来做到这一点，**但**我真的不想让我的用户仅仅为了对位置进行地理编码而下载巨大的 200k Google Maps API。

有谁知道基于 URL (REST) 的城市/zip 到经度和纬度 API？

由于对这些信息进行地理编码会启动多个其他进程，因此第一步对于让它快速执行至关重要，因为它现在是使用 Google Maps API b/c 的巨大下载和 JavaScript 加载的瓶颈。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-11-05T00:25:36.007

[Yahoo! PlaceFinder](http://developer.yahoo.com/geo/placefinder/)是 Yahoo! 提供的一项新服务。提供将地址（包括城市名称）转换为纬度/经度对的服务。该服务还能够执行相反的操作（将坐标转换为地址）。

与 Google 的[地理编码 API](http://code.google.com/apis/maps/documentation/geocoding/index.html)不同，Yahoo PlaceFinder 的 TOS 不禁止使用地图 API 之外的数据。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-12-27T11:07:08.163

您可以使用 geonames.org 网络服务（或下载服务器）

[http://www.geonames.org/export/reverse-geocoding.html](http://www.geonames.org/export/reverse-geocoding.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T22:40:55.853

另请记住，如果您使用直接 HTTP 调用方法的流量很大，您可能会超出当天的配额。Google 根据 IP 地址限制使用，因此使用客户端代码将大大增加您每天可以执行的地理代码查找的数量，因为它们将与用户的计算机而不是您的服务器相关联。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-03-09T03:30:21.960

```
$.get("http://ipinfo.io", function(response) {
    console.log(response.city, response.country);
}, "jsonp"); 
```

这是一个更详细的 JSFiddle 示例，它还打印出完整的响应信息，因此您可以查看所有可用的详细信息：http: [//jsfiddle.net/zK5FN/2/](http://jsfiddle.net/zK5FN/2/)

# apache - 使用 Apache 在 URL 中显示 DirectoryIndex

> ID：843555
> 
> 赞同：0
> 
> 时间：2009-05-09T16:08:54.373
> 
> 标签：apache

有没有办法在 URL 中默认显示 DirectoryIndex 文件？例如，如果 DirectoryIndex 是 index.html，当我输入 www.someurl.com 时，它会自动显示 www.someurl.com/index.html

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T16:24:43.763

我认为没有选项可以触发 Apache 自动执行此操作。

但是如果你知道索引文档，你可以使用[mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)来重定向这样的请求：

```
RewriteEngine on
RewriteRule ^/$ /index.html [L,R=301] 
```

# database - 数据字典还是 ORM？

> ID：843560
> 
> 赞同：1
> 
> 时间：2009-05-09T16:10:10.860
> 
> 标签：database, frameworks

我正在为一个相当复杂的业务 Web 应用程序替换框架。我们的应用程序在 LAMP 平台上运行，新框架将是[CodeIgniter 的扩展。](http://www.codeigniter.com) 在我对框架设计的研究中，我决定研究 ORM，我以前从未做过 ORM，我想知道它是否对我们的应用程序有价值。然后我偶然发现了一篇非常有趣的博客文章，题为[“为什么我不使用 ORM”。](http://database-programmer.blogspot.com/2008/06/why-i-do-not-use-orm.html) 这个博客似乎证实了我对使用 ORM 的许多担忧，它还提供了一个类似于我已经计划好的解决方案。

通过“数据字典”，我计划使用[“数据库程序员”](http://database-programmer.blogspot.com)博客中的这个定义：

> 许多人，包括我自己，都使用术语“数据字典”来表示一组单独的表，这些表描述了应用程序表。数据字典包含列名、类型和大小等信息，还包含标题、标题、主键、外键和用户界面有关如何显示字段的提示等描述性信息。

因此，在选择 ORM 上的“数据字典”时，我可能会表现出确认偏差，不管这是我厌倦 ORM 的原因：

1.  之前没用过ORM，不太了解。
2.  这个框架需要相当快地构建，我的老板没有多少时间，我需要制作一个可以顺利升级到更现代框架的工作应用程序。
3.  我的老板已经认为我过度设计了这个框架（相信我，我离那个框架还差得远），并且对这个框架感到偏执，它会阻止我们做我们需要做的事情，并产生我们不能做的错误在规定的时间内解决。到目前为止，我在说服他改变是好的方面做得很差，我不是一个非常有效的推销员，虽然其他开发人员可以帮助我，但老板仍然需要很多保证。
4.  我们的旧框架是程序化的，我们的代码是 PHP，我们的开发人员非常了解 SQL。ORM 将是一个很大的变化。
5.  我们的数据库有几十个表，其中许多表在相当旧的服务器上运行着数十万个条目。过去，我们一直被循环中重复轮询数据库的代码所困扰，而不是一次查询来一次提取所有需要的数据。使用手工编码的 SQL 来避免这个问题是相当直接的。确保在 ORM 必要时始终发生这种情况对我来说是一个巨大的未知数，而且似乎很冒险。

无论如何，数据字典的解决方案对我来说似乎很有希望，因为这篇博文[“使用数据字典”](http://database-programmer.blogspot.com/2008/06/using-data-dictionary.html)似乎提供了许多有用的功能，其中一些是新框架的要求。以下是我偏爱数据字典解决方案的原因：

1.  对表行本身实施访问控制规则将是非常宝贵的。
2.  自动生成数据库更改、文档和模式检查也很有用。
3.  该框架的一个要求是通用数据历史记录/审计功能，可以应用于我们应用程序中的任何子功能。基本上需要数据字典或等价物来提供这样的功能。历史记录必须包含有关数据库中结构和数据类型的详细信息。
4.  我们的系统拥有各种各样的数据类型，如果将它们视为应用程序中的正式类型，这些数据类型会更恰当地处理。一方面，HTML 片段（我们的数据中有很多片段，它们是必需的）在某些情况下需要编码为实体，在其他情况下需要解码为 HTML，在某些情况下解析链接和图像，并始终验证其正确性。然后是日期、度量、货币和各种其他字段，可以从代码中明确定义如何操作这些数据中受益。

我想实现的数据字典的想法是在单独的 PHP 文件中的一系列对象，并且会有很多 OOP，但是它将以非常类似于“数据库程序员”中提出的数据字典概念的方式使用“ 博客。这将是整个框架的完整数据库模式的单一来源定义。

现在我的问题是，我是否忽略了 ORM 的价值，或者在这种情况下数据字典是适合这项工作的工具吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T18:56:47.447

如果您做出初始架构决策而不是重构现有应用程序，我认为您的问题会更有趣。我在您的问题中没有看到一个断言表明在 ORM 中设计可以解决的问题；但它会创建几个。如果两个主要的利益相关者群体（所有者和其他开发人员对更传统的设计更满意，那么在我看来，ORM 将逆流而上。

我可以想象，一旦查询缓慢或事务锁定问题开始出现，就会与 ORM 相关联的（可能是不应有的）认可。更不用说对开发进度的影响了。为什么要创建一个未量化的风险因素？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T17:01:27.120

您是否有支持使用“数据字典”构建应用程序的框架？如果是这样，请尝试一下，它可能会解决您的问题。如果你还没有，那么那里有很多优秀且有效的 ORM 框架，它们有大型社区，并附带源代码（因此即使“供应商”拒绝帮助你，你也可以自己修复错误）。

如果你想快速浏览一个不错的基于 Web 的 ORM 框架，我建议使用[Django](http://www.djangoproject.com/)或[TurboGears](http://turbogears.org/)。它们基于 Python，在使用 PHP 之后将是一个很好的变化。我通常更喜欢 TurboGears，但 Django 目前似乎更流畅。两者都很容易设置，您应该能够在一两天内构建原型。这将使您对赔率有所了解。

PS：我也不认为 ORM 工具是 TEH SOLUT10N。我会在有意义的时候使用 Hibernate 或 SQL Alchemy，但我经常使用自己的简单映射器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T18:49:30.007

我认为你对你的情况做了很好的分析。您知道为什么选择数据字典方法。所以去吧。

稍后你可能会重新考虑。如果是这样，那么并行使用数据字典和 ORM 进行新开发应该没有问题。这两种技术并不相互排斥。

如果您不喜欢混合不同技术的想法：坚持可靠的 OOP 设计并清晰地分离域逻辑和数据访问之间的关注点，那么切换到 ORM 应该不会那么痛苦或至少是可能的。

祝你好运！

# php - jquery查询：在没有新页面加载的情况下传递消息

> ID：843569
> 
> 赞同：1
> 
> 时间：2009-05-09T16:13:32.727
> 
> 标签：php, jquery

请原谅这个问题的尴尬，老实说，我不知道如何表达更好的查询......

情况：

我正在升级的 xhtml/php 页面中有一个基本的联系表格。我最近在这个页面上添加了一个新的不相关的 jquery 插件，所以如果可能的话，我想使用 jquery 功能来帮助进行一些简单的表单验证。验证已通过 PHP 在联系表单提交的单独文件中完成。

我想要发生的事情是将 PHP 验证消息传递回主（联系表单）页面，而不需要新的页面加载。我在某处看到过通过 jquery 完成此操作，但我似乎无法在这里或通过 google 再次找到它。任何人都可以帮忙吗？

我真的在这里寻找速度和简单性，乍一看，jquery 验证插件的大小和复杂性令人望而生畏，所以我不愿意走上这条特定的路线......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T16:31:11.253

您正在寻找的就是 AJAX，它没有什么难的，尤其是 jQuery！将数据发送到 PHP 进行验证的问题在于，它会立即否定您对“速度”的要求——当 Javascript 向服务器发出请求以查看是否一切正常时，表单需要挂起。出于这个原因，通常的做法是在服务器端和客户端*都进行验证。*注意我说的是两者，因为您应该*始终*验证服务器上的数据。

考虑到这一点，让我们开始吧！我将展示如何在不使用验证插件的情况下验证表单 - 对于更大的项目，您可能需要考虑它，但没有它也很容易：

```
<form id='myform' action='whatever.php' method='POST'>
First Name: <input type='text' name='first_name' class='required'><br>
Last Name: <input type='text' name='last_name'><br>
Email: <input type='text' name='email' class='required'><br>
Zip: <input type='text' name='zip'><br>
</form> 
```

如您所见，我们的名字和电子邮件都带有一个 required 类，所以我们可以这样做：

```
$(function() { // wait for the document to be loaded
    $('#myform').submit(function() {
        var valid = true; // assume everything is okay
        // loop through each required field in this form
        $('input.required', this).each(function() {
            // if the field is empty, mark valid as false
            // and add an error class
            if($.trim($(this).val()) == '') {
                valid = false;
                $(this).addClass('error_input');
            }
        });

        // additional validation for email, zip, perhaps

        return valid; // if valid is true, continue form submission
    });
}); 
```

Validation 插件使这一切变得更加整洁，但是如果您只需要做一个快速表单，那么上面的方法没有任何问题。它确实很糟糕，因为您必须在两个地方设置验证规则，但除了在服务器上执行 Javascript 或调用服务器获取数据之外，如果您想快速告诉用户有问题，别无选择。

希望这可以帮助。

**编辑**：似乎我误解了你的问题。如果您想将表单数据传递给 PHP 脚本，让它验证值，并在不加载的情况下将成功或错误返回到页面，您可以执行以下操作：

```
$('#myform').submit(function() {
    // allow submit if we've validated this already
    if($(this).data('done')) return true;
    var data = $(this).serialize(); // serialize the form data
    // you could get the two variables below from the actual form (DRY)
    // with $(this).attr('action'); and $(this).attr('method'); but I am
    // not sure if that is what you want...
    var action = 'validate.php'; // what script will process this
    var method = 'POST'; // type of request to make
    $.ajax({
        type: method,
        url: action, 
        data: data,
        dataType: 'json',
        success: function(d) {
            if(d.code == 'success') {
                 // everything went alright, submit
                 $(this).data('done', true).submit();
            } else {
                 alert('something is wrong!');
            }
        }
    });
    return false; // don't submit until we hear back from server   
}); 
```

然后您的 PHP 脚本所要做的就是返回类似这样的内容，使用[`json_encode`](http://www.php.net), 来指示一切是否正常：

```
// verify everything...
// data will be in $_POST just like a normal request
if($everythingOK) {
    $code = 'success';
} else {
    $code = 'error';
}
print json_encode(array('code' => $code));
exit; 
```

我还没有测试过上面的 Javascript，但我很确定它应该是正确的。我希望*这*会有所帮助。:)

# c# - 浮点计算错误

> ID：843576
> 
> 赞同：2
> 
> 时间：2009-05-09T16:19:54.820
> 
> 标签：c#

在 C# 中

```
float ratio = 185 / srcRect.Width; 
```

在哪里`srcRect.Width = 400`

返回`0`它应该返回的地方`0.45`......

浮动的最小值是`-3.40282347E+38`这样的，这怎么可能？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-09T16:22:42.193

您正在执行整数除法，因此`185/srcRect.Width`将返回 0。您需要将表达式更改为

```
float ratio = 185.0f / srcRect.Width; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T16:25:46.117

185 是一个整数文字，因此执行的除法是整数除法。

要执行浮点除法，请改用 185.0 或 185.0f（前者是双精度，后者是浮点数）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T16:43:44.490

可以将“f”或“d”后缀添加到文字数字中，以分别将它们转换为浮点数或双精度数。

像这样：

```
float ratio = 185f / srcRect.Width; 
```

请注意，“185.0”实际上是双精度，除非它也有“f”后缀。

# c - 将浮点数读入数组

> ID：843577
> 
> 赞同：2
> 
> 时间：2009-05-09T16:21:48.980
> 
> 标签：c, floating-point, floating-point-conversion

我如何读取 10 个浮点数并将它们存储在一个数组中而不浪费任何内存？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T16:30:34.093

```
int size = 10;
float vet[size];
   for(i = 0; i < size; i++){
      scanf("%f", &vet[i]);
   } 
```

尽可能简单:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T17:13:41.793

啊哈。问题不是读取浮点数，而是内存。您读入*i ，并且需要一个恰好包含**i*浮点数的数组。

这确实闻起来像家庭作业，这很好，但我太老师了，无法给你完整的答案。所以我会告诉你，你需要的是一个名为*malloc()的 C 函数和一个名为**sizeof*的 C 运算符（它看起来像一个函数，但它实际上是内置在语言中的）。

看看[这个教程](http://www.exforsys.com/tutorials/c-language/dynamic-memory-allocation-in-c.html)。

* * *

是的，你明白了。这是您评论中的代码，已格式化。

```
int n,index;
float temp;
scanf("%d",&n);
float *pValues=(float *)calloc(n,sizeof(float));
for(index=0;index<n;index++) {
    scanf("%f",&temp); 
    *(pValues+index)=temp;
} 
```

我会做两个改变：

1.  `malloc`除了字符之外，它更适合用于任何东西
2.  在 C 中，数组和指针有着非常密切的关系；实际上`*(pValues+index)`完全等价于`pValues[index]`。

所以我将其重写为：

```
int n,index;
float temp;
scanf("%d",&n);
float *pValues=(float *)malloc(n*sizeof(float));
for(index=0;index<n;index++) {
    scanf("%f",&temp); 
    pValues[index]=temp;
} 
```

让我们再看一下代码的另一种转换。你有`pValues`，它是一个指向`float`. 您有`&temp`，它也是指向 的指针`float`，因为`&`它是地址运算符并且`temp`是`float`. 而且，您只是在使用索引进行指针运算。因此，我们可以再次将其重写为：

```
int n,index;    // Don't need temp
scanf("%d",&n);
float *pValues=(float *)malloc(n*sizeof(float));
for(index=0;index<n;index++) {
    scanf("%f",pValues+index); 
} 
```

现在，测验问题：如果你做了循环会发生什么

```
for(index=0;index<n;index++) {
    scanf("%f",pValues++); 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T16:29:26.907

您必须更具体地了解问题。

除非您需要对这些数字进行其他处理，否则节省内存的最简单方法是不要将它们存储在数组中。

这听起来像你想要的东西。

总和 = 0;
do
  read current
  sum += current
while（你还没有读过 10 个数字）；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T16:41:56.613

您的问题的答案是您不能将内容添加到数组并期望数组使用任何内存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T17:09:11.053

```
float arr[10];
for(i = 0; i < 10; i++){
    scanf("%f", &arr[i]);
} 
```

我知道，就像上面那样，但不使用额外的 int 以防它没有被优化。呵呵

要使用更少的内存，请使用下面的代码。它们都被读入一个数组，但只有最后一个被读入的是数组：

```
float arr[1];
for(i = 0; i < 10; i++){
    scanf("%f", &arr[0]);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-24T14:58:34.423

听起来像家庭作业。

从输入中读取浮点数。将其乘以单个浮点数的大小 分配将地址存储在指向浮点数的指针中的确切字节数 从输入中读取浮点数 有一个循环将数组中的所有浮点数相加

我的猜测是家庭作业课是实现术语指针和数组之间的联系，虽然你可以在没有任何数组索引的情况下做到这一点，但你的问题暗示你必须使用数组。

# python - 编写一个 __init__ 函数用于 django 模型

> ID：843580
> 
> 赞同：76
> 
> 时间：2009-05-09T16:23:35.933
> 
> 标签：python, django, django-models

我正在尝试为`__init__`我的一个模型编写一个函数，以便我可以通过以下方式创建一个对象：

```
p = User('name','email') 
```

当我编写模型时，我有：

```
def __init__(self, name, email, house_id, password):
    models.Model.__init__(self)
    self.name = name
    self.email = email 
```

这可行，我可以将对象保存到数据库中，但是当我这样做时`User.objects.all()`，除非我取出我的`__init__`函数，否则它不会拉出任何东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-05-09T17:55:47.513

依靠 Django 的内置功能并传递命名参数将是最简单的方法。

```
p = User(name="Fred", email="fred@example.com") 
```

但是，如果您打算保存一些击键，我建议向该类添加一个静态便捷方法，而不是弄乱初始化程序。

```
# In User class declaration
@classmethod
def create(cls, name, email):
  return cls(name=name, email=email)

# Use it
p = User.create("Fred", "fred@example.com") 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-05-09T17:10:33.530

Django 期望模型的构造函数的签名是`(self, *args, **kwargs)`，或者一些合理的传真。您将签名更改为完全不兼容的内容已经破坏了它。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2015-01-29T15:45:04.887

正确的答案是避免覆盖并编写[Django 文档](https://docs.djangoproject.com/en/stable/ref/models/instances/#creating-objects)`__init__`中描述的类方法。

但这可以像您尝试的那样完成，您只需要添加`*args, **kwargs`即可被您的 接受`__init__`，并将它们传递给超级方法调用。

```
def __init__(self, name, email, house_id, password, *args, **kwargs):
        super(models.Model, self).__init__(self, *args, **kwargs)
        self.name = name
        self.email = email 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-20T16:13:03.837

不要使用 args 参数创建模型。如果你制作这样的模型：

```
 User('name','email') 
```

由于大多数模型需要的不仅仅是初始化，它很快就会变得非常不可读。你很容易得到：

```
User('Bert', 'Reynolds', 'me@bertreynolds.com','0123456789','5432106789',....) 
```

这里的另一个问题是您不知道“Bert”是名字还是姓氏。最后两个数字很容易成为电话号码和系统 ID。但是如果不明确，您将更容易将它们混合在一起，或者如果您使用标识符，则混淆顺序。更重要的是，基于顺序的做法会给使用这种方法的其他开发人员带来另一个限制，并且不会记住参数的任意顺序。

你应该更喜欢这样的东西：

```
User(
    first_name='Bert',
    last_name='Reynolds',
    email='me@bertreynolds.com',
    phone='0123456789',
    system_id='5432106789',
) 
```

如果这是用于测试或类似的东西，您可以使用工厂快速创建模型。工厂男孩链接可能有用： http: [//factoryboy.readthedocs.org/en/latest/](http://factoryboy.readthedocs.org/en/latest/)

# windows - Windows：如何显示非阻塞警报/确认窗口？

> ID：843585
> 
> 赞同：3
> 
> 时间：2009-05-09T16:24:52.640
> 
> 标签：windows, batch-file, blocking, alert, confirmation

我想实现一个简单的确认/警报框，可以通过 CLI 使用 Windows XP/Vista 批处理脚本调用它。

标准警报框似乎被阻止，这意味着整个批处理脚本将在警报窗口调用时停止，这不是我想要的。

如果需要编码，请提供示例或文档。语言可以是任何可编译的东西，而无需介于两者之间的虚拟机。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T17:10:41.753

您可以使用该`msg`工具：

```
Send a message to a user.

MSG {username | sessionname | sessionid | @filename | *}
    [/SERVER:servername] [/TIME:seconds] [/V] [/W] [message]

  username            Identifies the specified username.
  sessionname         The name of the session.
  sessionid           The ID of the session.
  @filename           Identifies a file containing a list of usernames,
                      sessionnames, and sessionids to send the message to.
  *                   Send message to all sessions on specified server.
  /SERVER:servername  server to contact (default is current).
  /TIME:seconds       Time delay to wait for receiver to acknowledge msg.
  /V                  Display information about actions being performed.
  /W                  Wait for response from user, useful with /V.
  message             Message to send.  If none specified, prompts for it
                      or reads from stdin. 
```

通话

```
msg * Some text 
```

不阻塞。如果需要，它还具有在设定的时间后再次关闭消息框的好功能。

On a side note, though, you shouldn't really use those things. Monologs (like message boxes with exactly an OK button) have an information efficiency of 0 % (cf. Jef Raskin: *The Humane Interface*. Section 4–3: *Measurement of Interface Efficiency* or [Aza Raskin: *Monolog Boxes and Transparent Messages*](http://humanized.com/weblog/2006/09/11/monolog_boxes_and_transparent_messages/) or [Aza Raskin: *Know When to Stop Designing, Quantitatively*](http://humanized.com/weblog/2006/07/22/know_when_to_stop_designing_quantitatively/)).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T16:27:53.553

```
start MessageBox.vbs 
```

...其中`MessageBox.vbs`包含对 MsgBox 函数的调用。

# vim - 无法限制 Ctrl-O 在 Vim 中仅打开当前缓冲区

> ID：843589
> 
> 赞同：1
> 
> 时间：2009-05-09T16:26:51.310
> 
> 标签：vim, buffer

当我按下时，我会打开旧缓冲区

```
Ctrl-O 
```

我只想浏览在当前 Vim 会话中打开的缓冲区。

**如何**使用 Ctrl-O 在 Vim 中的当前缓冲区之间快速浏览？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-11T06:28:45.760

不幸的是，我不知道如何`CTRL-O`表现得像你想要的那样。但我可以为您提供一些可能对您有所帮助的提示。

1.  您可以使用`g;`和`g,`跳转到**您进行更改**的地方，但仅限于**当前缓冲区**。

    我知道这与 不同`CTRL-O/I`，因为这只是关于*“更改”*，它只跟踪当前缓冲区，但无论如何它可能很有用。

2.  您可以使用`.vimrc`如下映射快速导航打开的缓冲区：

    ```
    nmap <special> <C-Up> :bnext<CR>
    nmap <special> <C-Down> :bprevious<CR> 
    ```

我知道这并不能真正回答您的问题，但我认为这几个技巧可能会对您的 vimming 有所帮助。

* * *

**编辑：**我想补充一点，既然您对快速浏览缓冲区感兴趣，我个人推荐一个名为 QuickBuf 的小插件：

[http://www.vim.org/scripts/script.php?script_id=1910](http://www.vim.org/scripts/script.php?script_id=1910)

我将其映射`.vimrc`为：

```
let g:qb_hotkey = ",b" 
```

试试吧，它比打字快得多`:ls`，另一个巧妙的事情是您可以在列表上移动`j/k`并按下`<enter>`以选择缓冲区。

# vim - 在 Vim 中无法使用 Ctrl-O 的反转

> ID：843599
> 
> 赞同：24
> 
> 时间：2009-05-09T16:33:09.207
> 
> 标签：vim, buffer, keyboard-shortcuts

我想要相反的

*   `Ctrl`+`O`

成为

*   `Shift`+ `Ctrl`+`O`

原来的反面是

*   `Ctrl`+`I`

您如何将Vim 中`CTRL`+的反面重新映射为++ ？`O``Shift``CTRL``O`

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-05-09T16:58:49.623

如帮助中所示

```
:help C-o 
```

`Ctrl`+的“反向”`o`是

`Ctrl`+`i`或`Tab`

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-12T13:01:37.813

不幸的是，Vim 将 Control-o 和 Control-O 识别为同义词。[这里](http://groups.google.com/group/vim_use/browse_thread/thread/cb3afd343edcb9e4?pli=1&safe=on)
有一些关于为什么你不能映射 Control-Shift-o 的信息，但看起来不可能。

我赞成 Idigas 的回答，记住 Control-I 并不难。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-11-28T21:34:05.083

实际上，如果您使用*xterm*，您可以通过重新映射文​​件中的键来绕过终端仿真器的限制`.Xresources`。使用一个无论如何都不会使用的键序列，例如 CM-7 (0x9f)：

```
XTerm*vt100*translations: #override\n\
    Ctrl Shift <Key> O: string(0x9f) 
```

然后`xrdb -merge ~/.Xresources`在 Vim 中将 CM-7 映射到 Ci。

诚然，这是一个 hack，但它对我帮助很大。查看我的[.Xresources](http://pastebin.com/ZRczRKsx)以获得灵感。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-30T22:07:38.960

*由于终端仿真器的限制，*Vim*将`Ctrl`++视为`Shift`+ 。`O``Ctrl``O`*

 *# search - vim — 如何搜索缓冲区？

> ID：843602
> 
> 赞同：15
> 
> 时间：2009-05-09T16:34:44.413
> 
> 标签：search, vim, buffer

我正在寻找一些命令，例如：

```
:b1!g/something_here/ 
```

我应该在缓冲区“b1”中搜索单词“something_here”。我该怎么做？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-10T01:56:12.727

我经常这样做：

```
:rew
:bufdo 0
:bufdo g/something here/
:ls 
```

最后一个 :ls 允许我查看所有未位于第 1 行的缓冲区

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-09T16:54:33.687

好吧，去缓冲区 b1 和

```
:g/something here/ 
```

为了搜索所有打开的缓冲区，有各种插件，我认为最好看看[www.vim.org](http://www.vim.org)

编辑：喜欢这个 - [buffergrep](http://www.vim.org/scripts/script.php?script_id=2255)
我个人最喜欢的各种搜索：[compview](http://www.vim.org/scripts/script.php?script_id=1803)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-14T12:43:22.263

您可以尝试一些简单的方法： :b0 |?somethingToSearch

# iphone - SQLite 查询中的子查询不起作用

> ID：843604
> 
> 赞同：2
> 
> 时间：2009-05-09T16:35:40.637
> 
> 标签：iphone, sql, database, sqlite

我正在使用嵌套集模型将大量数据层次结构存储在 iPhone 上的本地 SQLite 数据库中。我从他们的网站上阅读了有关如何执行此操作的[MySQL 技术文章](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)，但他们建议的查询之一（以及我需要的）似乎不适用于 SQLite，我不知道如何解决它。

```
SELECT node.name, (COUNT(parent.name) - (sub_tree.depth + 1)) AS depth
FROM line_items AS node,
    line_items AS parent,
    line_items AS sub_parent,
    (SELECT node.name, (COUNT(parent.name) - 1) AS depth
        FROM line_items AS node,
        line_items AS parent
        WHERE node.lft BETWEEN parent.lft AND parent.rgt
        AND node.name = 'Power Up'
        GROUP BY node.name
        ORDER BY node.lft
    ) AS sub_tree
WHERE node.lft BETWEEN parent.lft AND parent.rgt
    AND node.lft BETWEEN sub_parent.lft AND sub_parent.rgt
    AND sub_parent.name = sub_tree.name
GROUP BY node.name
HAVING depth <= 1
ORDER BY node.lft; 
```

SQLite 报告`sub_tree.name`不是一列，我认为这是因为它的子查询实现不完整。有没有人对如何解决这个限制有任何想法？

查询的目的是获取给定父节点的所有直接子节点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T19:27:20.993

尝试在子查询中使用“node.name AS name”，即

```
SELECT node.name, (COUNT(parent.name) - (sub_tree.depth + 1)) AS depth
FROM line_items AS node,
    line_items AS parent,
    line_items AS sub_parent,
    (SELECT node.name AS name, (COUNT(parent.name) - 1) AS depth
        FROM line_items AS node,
        line_items AS parent
        WHERE node.lft BETWEEN parent.lft AND parent.rgt
        AND node.name = 'Power Up'
        GROUP BY node.name
        ORDER BY node.lft
    ) AS sub_tree
WHERE node.lft BETWEEN parent.lft AND parent.rgt
    AND node.lft BETWEEN sub_parent.lft AND sub_parent.rgt
    AND sub_parent.name = sub_tree.name
GROUP BY node.name
HAVING depth <= 1
ORDER BY node.lft; 
```

至少似乎摆脱了错误。

# javascript - farbtastic 插件回调函数

> ID：843608
> 
> 赞同：1
> 
> 时间：2009-05-09T16:39:16.840
> 
> 标签：javascript, jquery, colors, picker

我只是在设置一个带有颜色选择器的网页。我选择[了 farbtastic](http://acko.net/dev/farbtastic)。

我的问题是，回调函数不起作用。这是我使用的代码：

```
$('#colorPicker1').farbtastic('#background-color', function callback() { 
    /*commands*/
}); 
```

当用户选择颜色时，不会调用回调函数。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-06-25T08:18:49.290

我知道你的帖子很旧，但以防万一：

```
var picker = $.farbtastic('#colorPicker1');  //picker variable
picker.setColor("#b6b6ff"); //set initial color
picker.linkTo(onColorChange); //link to callback

function onColorChange(color) {
  dosomeStuff();
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-09T21:12:22.300

farbtastic 像你一样打电话

```
$('selector').farbtastic(...) 
```

仅等待**一个**可选参数。这可以是 DOM 节点、jQuery 对象、jQuery 选择器或函数。所以你应该调用如下所示的函数

```
$('#colorPicker1').farbtastic(function(color){
   // commands
}); 
```

如果你想使用#background-color 元素，你应该在回调正文中使用它

```
$('#colorPicker1').farbtastic(function(color){
   $('#background-color').css({'background-color':color});
   // commands
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-25T21:42:06.277

在您提出问题将近 1 年后，我在进行一些搜索后一无所获，我认为除了手动编码之外别无选择。

在破解了一些[farbtastic](http://acko.net/dev/farbtastic)和[colorpicker](http://www.eyecon.ro/colorpicker/) jquery 插件之后，我提出了这个解决方案：

```
/*
 * ColorPicker.
 */
// Utility functions.
function convertHexToRGB(hex) {
    var hex = parseInt(((hex.indexOf('#') > -1) ? hex.substring(1) : hex), 16);
    return [hex >> 16,(hex & 0x00FF00) >> 8,(hex & 0x0000FF)];
}

function convert_RGB_to_HSL(rgb) {
    var min, max, delta, h, s, l;
    var r = rgb[0], g = rgb[1], b = rgb[2];
    min = Math.min(r, Math.min(g, b));
    max = Math.max(r, Math.max(g, b));
    delta = max - min;
    l = (min + max) / 2;
    s = 0;
    if (l > 0 && l < 1) {
      s = delta / (l < 0.5 ? (2 * l) : (2 - 2 * l));
    }
    h = 0;
    if (delta > 0) {
      if (max == r && max != g) h += (g - b) / delta;
      if (max == g && max != b) h += (2 + (b - r) / delta);
      if (max == b && max != r) h += (4 + (r - g) / delta);
      h /= 6;
    }
    return [h, s, l];
}

$('#footer-text-color-selector').hide();
$.farbtastic('#footer-text-color-selector')
    .setColor('#21759B')
    .linkTo(function(color){
        $('#footer-text-color').css({
            'backgroundColor':color,
            'color': (convert_RGB_to_HSL(convertHexToRGB(color))[2] > 125) ? '#000' : '#FFF'
        });

        $('#footer-preview a').css('color', color);

        // XXX Any other things-to-do when the input change.
    });

// Hide & Show behaviour.
$('#footer-text-color').click(function() {
    $('#footer-text-color-selector').fadeIn();
});

$(document).mousedown(function() {
    $('#footer-text-color-selector').each(function() {
        var display = $(this).css('display');
        if ( display == 'block' )
            $(this).fadeOut();
    });
});

// Initial behaviour.
$('#footer-text-color').css({
    'backgroundColor': $('#footer-text-color').val(),
    'color': (convert_RGB_to_HSL(convertHexToRGB($('#footer-text-color').val()))[2] > 125) ? '#000' : '#FFF'
});

$('#footer-preview a').css('color', $('#footer-text-color').val()); 
```

# python - 时间间隔之间调用函数

> ID：843614
> 
> 赞同：0
> 
> 时间：2009-05-09T16:42:36.833
> 
> 标签：python, datetime, time, timezone

在应用程序引擎中，如果当前时间在特定时间间隔之间，我想调用一个函数。这就是我现在正在做的事情。

```
ist_time = datetime.utcnow() + timedelta(hours=5, minutes = 30)
ist_midnight = ist_time.replace(hour=0, minute=0, second=0, microsecond=0)
market_open = ist_midnight + timedelta(hours=9, minutes = 55)
market_close = ist_midnight + timedelta(hours=16, minutes = 01)
if ist_time >= market_open and ist_time <= market_close:
    check_for_updates() 
```

任何更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T16:58:09.937

这更紧凑，但不是那么明显：

```
if '09:55' <= time.strftime(
   '%H:%M', time.gmtime((time.time() + 60 * (5 * 60 + 30)))) <= '16:01':
  check_for_updates() 
```

根据您绝对正确地进行计算的重要性，您可能需要考虑夏令时（为此使用*pytz* - 可以将捆绑到您的应用程序的*pytz*上传到 AppEngine）以及秒和毫秒（例如使用`< '16:02'`代替`<= '16:01'`，因为前者不依赖于秒/亚秒精度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T20:23:33.417

似乎您可能想要 datetime 的“时间”类型，它不关心日期。

```
import datetime
ist_time = datetime.utcnow() + datetime.timedelta(hours=5, minutes = 30)
# Turn this into a time object (no day information).
ist_time = ist_time.time()
if datetime.time(9, 55) <= ist_time <= datetime.time(16, 1):
   ... 
```

我确信有一种更优雅的方式来使用 tzinfo 处理时区调整，但我必须承认我从未处理过时区。

# php - 如何使用 Kohana PHP 编写搜索查询？

> ID：843617
> 
> 赞同：1
> 
> 时间：2009-05-09T16:44:11.307
> 
> 标签：php, kohana

我有一个`product_shoppingcart`包含 4 列的表 ()：

```
id, product_id, shoppingcart_id, product_quantity. 
```

我正在使用 Kohana 的 ORM。

我想编写一个搜索查询，它返回该`shoppingcart_id`列包含 1 的所有行（例如）。

我已经尝试过：

```
$arr = ORM::factory('product_shoppingcart')->where('shoppingcart_id',$shoppingcartID)->find_all(); 
```

但这不起作用。

谁能帮帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T03:23:03.443

您的示例代码应该可以工作，但问题可能是您没有迭代结果集？

```
$results = ORM::factory('product_shoppingcart')
           ->where('shoppingcart_id', $shoppingcartID)
           ->find_all();
foreach ($results as $product_shoppingcart) {
  print Kohana::debug($product_shoppingcart->as_array());
} 
```

如果您有不止一行具有该 ID，这应该会在 $results 中为您提供一个结果迭代器，然后您可以使用 foreach 循环遍历它。如果您仍然无法使其正常工作，我有很多类似工作代码的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-06T12:06:39.470

这是它的样子：

```
$arr = ORM::factory('product_shoppingcart')->where(
                    'shoppingcart_id',"=",$shoppingcartID)->find_all(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T03:15:01.087

你的桌子不应该是“product_shoppingcarts”还是我错过了什么？

# c++ - 未能在模板化函数/类中使用 stl 容器

> ID：843618
> 
> 赞同：2
> 
> 时间：2009-05-09T16:45:06.810
> 
> 标签：c++, stl, templates

当我尝试编译以下代码时...

```
#include <vector>

template <class T> void DoNothing()
{
    std::vector<T>::iterator it;
}

int main(int argc, char**argv)
{
    return 0;
} 
```

g++ 说：

> test.cpp:5：错误：预期的 `;' 在“它”之前</p>

我不明白为什么这是一个问题。例如，如果我将其替换为`std::vector<int>::iterator`，它会按预期工作。

如您所见，我没有实例化该函数，因此 g++ 模板定义本身肯定有问题，但我看不出它是如何无效的。

感谢您对正在发生的事情提出任何建议。

注意我实际上是在尝试编写一个模板类并且遇到了地图而不是矢量的问题，但这是解决我的问题的最简单的测试用例。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-09T16:51:22.680

您需要使用`typename`关键字，因为`std::vector<T>::iterator`类型取决于模板参数：

```
template <class T> void DoNothing()
{
    typename std::vector<T>::iterator it;
} 
```

当您需要使用`typename`和不需要它（甚至不允许使用它）时，它实际上可能会令人困惑。这篇文章有一个不错的概述：

*   [http://pages.cs.wisc.edu/~driscoll/typename.html](http://pages.cs.wisc.edu/~driscoll/typename.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T17:08:39.383

我同意这令人困惑。如果没有`typename`关键字，名称将被视为静态成员。Vandevoorde 和 Josuttis所著的*C++ Templates*一书详细解释了这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T16:50:43.617

`typename std::vector<T>::iterator it;`行得通吗？

编辑：更改`template`为`typename`...让我的关键字混淆了。

# flash - 我可以在 ActionScript 中扩展 Function 的原型吗？

> ID：843630
> 
> 赞同：3
> 
> 时间：2009-05-09T16:51:55.860
> 
> 标签：flash, actionscript-3, prototype

我正在尝试将prototype.js 的`bind()`功能合并到我的Flash 组件中。我发现了 Jordan Broughs 的[这篇文章，这给了我希望。](http://jordan.broughs.net/archives/2007/11/resurrecting-actionscripts-delegate-for-function-binding-in-as3)他建议使用以下代码片段：

```
 Function.prototype.bind = function():Function {
          var __method:Function = this;
          var object:Object = arguments[0];
          return function():void {
            __method.apply(object, arguments);
          }
        } 
```

所以，我把它放在我的类中，在任何方法或构造函数之外。但是，当我尝试在函数上调用 bind() 时，会出现以下编译器错误：

> 1061：调用一个可能未定义的方法，通过静态类型函数的引用绑定。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T17:02:32.300

您正在扩展`Function`对象的`prototype`. 它不属于一个类。这不是你班级的方法。

该`Function`对象基本上是一个内置类型，它`prototype`是它的基类。`prototype`通过添加`bind`继承自 的所有对象`Function`（包括您定义的所有函数）来扩展它，将有一个`bind`创建闭包的方法。

**编辑：**

这个问题实际上是重复的，并已在此处得到解答：

[原型和静态类型变量的 ActionScript 问题](https://stackoverflow.com/questions/565154/actionscript-problem-with-prototype-and-static-type-variables)

根据该问题，您已删除 :Function 以使其正常工作。

# objective-c - Objective-c 中的“实例变量”和“属性”有区别吗？

> ID：843632
> 
> 赞同：84
> 
> 时间：2009-05-09T16:53:08.403
> 
> 标签：objective-c

Objective-c 中的“实例变量”和“属性”有区别吗？

我不太确定这一点。我认为“属性”是具有访问器方法的实例变量，但我可能认为是错误的。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-05-09T17:29:08.203

属性是一个更抽象的概念。实例变量实际上只是一个存储槽，就像结构中的一个槽。通常其他对象不应该直接访问它们。另一方面，属性是可以访问的对象的属性（听起来很模糊，但应该如此）。通常一个属性会返回或设置一个实例变量，但它可以使用来自多个或根本不使用的数据。例如：

```
@interface Person : NSObject {
    NSString *name;
}

    @property(copy) NSString *name;
    @property(copy) NSString *firstName;
    @property(copy) NSString *lastName;
@end

@implementation Person
    @synthesize name;

    - (NSString *)firstName {
        [[name componentsSeparatedByString:@" "] objectAtIndex:0];
    }
    - (NSString *)lastName {
        [[name componentsSeparatedByString:@" "] lastObject];
    }
    - (NSString *)setFirstName:(NSString *)newName {
        NSArray *nameArray = [name componentsSeparatedByString:@" "];
        NSArray *newNameArray [[NSArray arrayWithObjects:newName, nil] arrayByAddingObjectsFromArray:[nameArray subarrayWithRange:NSMakeRange(1, [nameArray size]-1)]];
        self.name = [newNameArray componentsJoinedByString:@" "];
    }
    - (NSString *)setLastName:(NSString *)newName {
        NSArray *nameArray = [name componentsSeparatedByString:@" "];
        NSArray *newNameArray [[nameArray subarrayWithRange:NSMakeRange(0, [nameArray size]-2)] arrayByAddingObjectsFromArray:[NSArray arrayWithObjects:newName, nil]];
        self.name = [newNameArray componentsJoinedByString:@" "];
    }
@end 
```

（注意：上面的代码是错误的，因为它假设名称已经存在并且至少有两个组件（例如“Bill Gates”而不仅仅是“Gates”）。我觉得修复这些假设将使代码的实际意义不太清楚，所以我只是在这里指出，所以没有人会无辜地重复这些错误。）

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-05-09T17:53:32.777

属性是为某个值实现 getter/setter 的一种友好方式，具有额外的有用特性和语法。属性可以由实例变量支持，但您也可以定义 getter/setter 来做一些更动态的事情，例如，您可以在字符串上定义一个 lowerCase 属性来动态创建结果，而不是返回某个成员的值多变的。

这是一个例子：

```
// === In your .h ===

@interface MyObject {
    NSString *propertyName;

}

// ...

@property (nonatomic, retain) NSString *propertyName;

// === In your .m @implementation ===

@synthesize propertyName /* = otherVarName */; 
```

该`@property`行定义了一个名为`propertyName`type的属性`NSString *`。这可以使用以下语法获取/设置：

```
myObject.propertyName = @"Hello World!";
NSLog("Value: %@", myObject.propertyName); 
```

当您分配给或从中读取时，`myObject.propertyName`您实际上是在调用对象上的 setter/getter 方法。

该`@synthesize`行告诉编译器为您生成这些 getter/setter，使用与属性同名的成员变量来存储值（或者`otherVarName`如果您使用注释中的语法）。

您仍然`@synthesize`可以通过定义自己的方法来覆盖其中一个 getter/setter。这些方法的命名约定适用`setPropertyName:`于 setter，而`propertyName`（或`getPropertyName`，非标准）适用于 getter。另一个仍会为您生成。

在您的`@property`行中，您可以在括号中为属性定义许多属性，这些属性可以自动执行诸如线程安全和内存管理之类的事情。默认情况下，属性是原子的，这意味着编译器将`@synthesiz`使用适当的锁包装 get/set 调用以防止并发问题。您可以指定`nonatomic`属性来禁用此功能（例如，在您希望将大多数属性默认为 的 iPhone 上`nonatomic`）。

有 3 个属性值可以控制任何`@synthesized`setter 的内存管理。第一个是`retain`自动发送`release`到属性的旧值和`retain`新值。这非常有用。

第二个是`copy`复制传入的任何值而不是保留它们。使用 NSString 是一种很好的做法，`copy`因为调用者可以传入 NSMutableString 并将其从您下面更改出来。`copy`将制作只有您可以访问的输入的新副本。

第三个是`assign`直接分配指针而不在旧对象或新对象上调用保留/释放。

最后，您还可以使用该`readonly`属性来禁用该属性的设置器。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-06-15T13:54:49.757

我使用接口部分的属性——对象与其他对象和实例变量的接口是你在类中需要的东西——除了你应该没有人看到和操作它们。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-05-28T11:13:21.813

默认情况下，读写属性将由实例变量支持，该变量将再次由编译器自动合成。

实例变量是一个存在并在对象生命周期内保持其值的变量。用于实例变量的内存在第一次创建对象时分配（通过 alloc），并在对象被释放时释放。

除非您另外指定，否则合成的实例变量与属性具有相同的名称，但带有下划线前缀。例如，对于名为 firstName 的属性，合成的实例变量将称为 _firstName。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-06-07T13:15:18.777

以前人们公开使用属性，私人使用 ivars，但从几年前开始，您还可以定义属性`@implementation`以私下使用它们。但如果可能的话，我仍然会使用 ivars，因为要输入的字母更少，而且根据[这篇文章](https://www.bignerdranch.com/blog/should-i-use-a-property-or-an-instance-variable/)，它运行得更快。这是有道理的，因为属性意味着“重”：它们应该从生成的 getter/setter 或手动编写的 getter/setter 中访问。

但是，在 Apple 最近的代码中，不再使用 ivar。我猜是因为它更像`objc`而不是, 加上使用,等`C/C++`属性更容易。`assign``nullable`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-02-16T22:30:00.073

**Objective-C 属性与实例变量 (iVar)**

[[Swift 变量、属性...]](https://stackoverflow.com/a/60913330/4770877)

实例变量

```
@interface SomeClass: NSObject
NSString *someVariable;
@end 
```

财产

```
@interface SomeClass: NSObject
@property (nonatomic, strong) NSString *someVariable;
@end 
```

`Property`在里面使用`Instance variable`。`property = variable + bounded getter/setter`. 它是一种具有可变语法和访问权限的方法调用

*   `@property`生成`getter`和使用（也称为支持字段）的`setter` **方法**（访问器方法）`backing ivar`，您可以通过下划线`_<var_name>`( `_someVariable`) 使用它们。

*   因为它调用了一个方法 -`method dispatch`使用了机制，这就是为什么可以应用`KVO`[^([About])](https://stackoverflow.com/a/66179947/4770877)

*   当您覆盖访问器方法时，不会生成支持 iVar，这就是为什么您可以显式声明新属性或使用`@synthesize`[^([About])](https://stackoverflow.com/a/67561769/4770877)生成新属性或与现有属性链接的原因

```
#import "SomeClass.h"

@interface SomeClass()
@property (nonatomic, strong) NSString *someVariable;
@end

@implementation SomeClass

- (void) foo {

    //property getter method
    NSString *a1 = self.someVariable; //NSString *a1 = [self someVariable];

    //property setter method
    self.someVariable = @"set someVariable"; //[self setSomeVariable:@"set someVariable"];

    //iVar read
    NSString *a2 = _someVariable;
    //iVar write
    _someVariable = @"set iVar";

}

//if you overriding someVariable getter and setter the iVar(_someVariable) is not generated, that is why you can:

//1\. create some variable explicitly
NSString *_someVariable;

//or

//2\. use @synthesize 
@synthesize someVariable = _someVariable;

//overriding
- (NSString*) someVariable {
    return _someVariable;
}

- (void)setSomeVariable: (NSString*) updatedSomeVariable {
    _someVariable = updatedSomeVariable;
}

@end 
```

[【属性】](https://stackoverflow.com/a/66282129/4770877)

# php - 如何更改 Zend_Form_Element_Submit 的值

> ID：843633
> 
> 赞同：4
> 
> 时间：2009-05-09T16:53:10.197
> 
> 标签：php, zend-framework, zend-form

我有几种形式，唯一的区别是提交按钮中的文本。
我试图通过更改它的值来更改提交文本，但无济于事。

```
$form=getForm()//get a full Zend_Form object with elements.
$form->getElement('mySubmit')->setValue('new value');
....
....
$form->render(); //This will still put 'mySubmit' in the [submit] (var_dumping it shows the new value in the _value member, tried also with setAttrib(); 
```

和这个：

```
$form=getForm()//get a full with elements Zend_Form object.
$form->getElement('mySubmit')->setName('new value');
....
....
$form->render(); //This will still put 'newvalue' in the [submit] NO SPACES, no good :-( 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-09T17:13:43.073

```
$form->getElement('mySubmit')->setLabel('new value') 
```

这是否实现了您正在寻找的东西？

# sql - SQL 组合几个 SELECT 结果

> ID：843642
> 
> 赞同：4
> 
> 时间：2009-05-09T16:56:39.097
> 
> 标签：sql, sql-server

我有三个 SELECT 语句，每个语句都返回一个总数，“新案例”、“关闭案例”、“现有案例”。我如何组合这些，以便它们在一个结果集中返回。

即我需要一个包含 3 个字段的表格，“新案例”、“关闭案例”和“现有案例”，每个字段都有一个

```
SELECT     COUNT(CaseID) AS 'New Cases'
FROM         dbo.ClientCase
WHERE     (CaseStartDate >= CONVERT(DATETIME, '2009-01-01 00:00:00', 102))
  AND     (CaseStartDate <= CONVERT(DATETIME, '2009-03-31 00:00:00', 102))

SELECT     COUNT(CaseID) AS 'Closed Cases'
FROM         dbo.ClientCase
WHERE     (CaseClosedDate >= CONVERT(DATETIME, '2009-01-01 00:00:00', 102))
  AND     (CaseClosedDate <= CONVERT(DATETIME, '2009-03-31 00:00:00', 102))

SELECT     COUNT(CaseID) AS 'Existing Cases'
FROM         dbo.ClientCase
WHERE     (CaseStartDate <= CONVERT(DATETIME, '2009-03-31 00:00:00', 102)) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-09T17:10:02.393

当您计算相同的数据时，您可以并行进行：

```
select
   sum(case when CaseStartDate between '2009-01-01' and '2009-03-31' then 1 else 0 end) as [New Cases],
   sum(case when CaseClosedDate between '2009-01-01' and '2009-03-31' then 1 else 0 end) as [Closed Cases],
   sum(case when CaseStartDate <= '2009-03-31' then 1 else 0 end) as [Existing Cases]
from
   dbo.ClientCase 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T17:29:13.630

@Mitch，@Guffa .. 一个很好的解决方案，但为了获得正确的结果，您需要同时考虑 CaseStartDate 和 CaseClosedDate 字段。例如。在新案例中，如果您不过滤 CaseClosedDate 数据，您将无法获得正确的编号。NewCases 的数量，因为它仍将计入已结案的案件中。

抱歉，我必须将其发布为答案，因为我没有 enuf 声誉来添加评论。

# emacs - 一个好的 Emacs 项目树浏览器？

> ID：843645
> 
> 赞同：46
> 
> 时间：2009-05-09T16:58:18.203
> 
> 标签：emacs, project

除了 Emacs 代码浏览器 (ECB) 之外，您还知道用于 Emacs 的优秀项目树浏览器吗？我看重的特性是简单、轻量级和语言不可知论。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2015-06-10T19:00:10.077

[Projectile](https://github.com/bbatsov/projectile) + [NeoTree](http://www.emacswiki.org/emacs/NeoTree)是我的首选组合。

![新树](https://i.stack.imgur.com/FRUHn.png)

Projectile 只是使用您的版本控制系统来跟踪文件，并且在项目功能中具有很棒的文件跳转功能。

![弹丸](https://i.stack.imgur.com/eaCYk.png)

另外，请检查将两者集成在一起[的说明](http://www.emacswiki.org/emacs/NeoTree#toc8)。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-09T17:03:16.977

[速度条](http://cedet.sourceforge.net/speedbar.shtml)？

如果您只想管理相关文件，也许您会喜欢[eproject](http://github.com/jrockway/eproject)。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-05-09T21:34:14.057

我自己还没有尝试过这个，但是[emacs-nav](http://code.google.com/p/emacs-nav/)是来自 Google 的一个新的 Emacs 项目浏览器，它似乎具有您所重视的功能。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-09-16T03:50:39.483

你可以试试[sr-speedbar](http://www.emacswiki.org/emacs/SrSpeedbar)。太棒了。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-09T19:00:50.120

[cedet](http://cedet.sourceforge.net/)的不同部分会做你想做的事。Speedbar 有树结构的东西，EDE 处理项目等。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-11-02T23:53:47.943

我刚才在 中搜索了“探索” `package-list-packages`，然后发现了`project-explorer`。似乎完全符合我今天想要的（我几乎不编码，但我掌握了我的 Jekyll 网站的结构）。

关键包括：

*   `TAB`用于折叠和展开目录
*   `RET`用或打开文件`f`。带有`C-u`前缀，它会很好地提示哪个窗口，甚至从那里你可以决定使用窗口还是打开一个新的窗口（我没有在包代码中找到提示字符串，所以它似乎很好地利用了内置的 Emacs 功能；实际上它看起来很`dired`均匀）。

它可以在 Melpa 和 Marmalade 上买到。它可以在 Github 的[sabof/project-explorer](https://github.com/sabof/project-explorer)上找到。

为方便起见，我包括了网站的图片：

![项目浏览器截图](https://i.stack.imgur.com/gfkXZ.png)

我不使用`projectile`or `helm`，但它有一些集成。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-10-06T22:47:50.097

以下是我对几个竞争文件资源管理器类型包的想法。请参阅下面每个包上方的评论：

```
;; Dired itself allows one to do 'i' to insert (display in same buffer) the
;; subdirectory under point and C-u k on subdir header line to remove. However,
;; I have found that dired-subtree-toggle and dired-subtree-remove are a better solution for the removal
;; part. Plus dired-subtree let's you customize colors of subdirs to set them apart
;; visually. However, I set all depths of subdirectories custom faces to be the same as I found it distracting.
(use-package dired-subtree
  :ensure t
  :bind (:map dired-mode-map ("i" . 'dired-subtree-toggle))
  :bind (:map dired-mode-map ("I" . 'dired-subtree-remove)))

;; This works nicely. It provides the parent, '..', directory unlike nav.
(use-package project-explorer
  :ensure t
  :config
  (evil-set-initial-state 'project-explorer-mode 'emacs))

;; This can't go above the directory you started it in. It is nice, but I prefer the flexibility
;; of getting to parent directories in most cases.
(use-package dirtree
  :ensure t)

;; Google's file explorer
;; Nice, but doesn't maintain visited nodes in view, preferring instead to offer only
;; the current directory or lower in a side window. No better than ivy which is my main file explorer system.
(use-package nav
  :ensure t)

;; This is buggy on Emacs 26.1.
(use-package eproject
  :disabled t
  :ensure t)

;; speedbar is included with Emacs (since 24.x I believe). It has to use a separate frame, which is
;; inconvenient most of the time. There are better options (above).
;; (use-package speedbar)

;; Buggy; doesn't work on Emacs 26.1 (at least with my config).
(use-package sr-speedbar
  :disabled t
  :load-path "../lisp")

;; Buggy on Emacs 26.1 (at least with my config). I couldn't even get it to activate.
(use-package ecb
  :disabled t
  :ensure t)

;; Nice, but similar to ivy which I've already committed to, so not necessary.
(use-package lusty-explorer
  :disabled t
  :ensure t) 
```

对我来说，ivy plus dired 让我成功了 98%。ivy、dired 和 dired-subtree 让我完成了 99% 的工作。project-explorer，以及在较小程度上，nav，只是 ivy plus dired 或 ivy plus dired 和 dired-subtree 的不错替代品。希望这会为您节省一些时间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-25T06:59:56.537

我用过[treemacs](https://github.com/Alexander-Miller/treemacs)，效果很好，尤其是。与弹丸。

# graphics - 开罗路径上的布尔运算？

> ID：843647
> 
> 赞同：6
> 
> 时间：2009-05-09T16:59:50.667
> 
> 标签：graphics, path, vector, 2d, cairo

有没有办法在开罗通过布尔运算（例如 Union、Difference 和 Intersection）将两条路径组合在一起来构建路径？我正在开发一个矢量图形应用程序，该应用程序使用 Cairo 进行渲染，并希望让我的用户能够以这种方式将路径组合在一起，但我在 Cairo 找不到方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-03-11T22:31:56.553

我还没有找到一种方法来使用 cairo 库来做到这一点。但这也是我一直在寻找的功能。当（例如）抚摸两条路径的组合时肯定会有所帮助 - ntd 提到的合成运算符似乎无法做到这一点。

与此同时，我正在尝试为inkscape 编写脚本，并让inkscape 进行联合/差异化。我正在处理的问题可以接受，但绝对不适合你的问题。你有没有运气，无论是开罗还是任何其他 svg 库？经过几天的谷歌搜索，这似乎并不简单：/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-08T22:12:38.173

将路径与运算符结合起来对我来说没有任何意义。你从“线与曲线或弧”中得到什么？

相反，您可以使用: 来应用[合成运算符](http://cairographics.org/operators/)`cairo_set_operator()`，它将设置当前绘图操作（无论是它`cairo_fill()`，`cairo_stroke()`还是其他）应如何与表面的旧内容混合。

# search - 无法在屏幕中有效搜索

> ID：843652
> 
> 赞同：1
> 
> 时间：2009-05-09T17:02:28.837
> 
> 标签：search, gnu-screen

我知道你应该可以在 Screen by 中搜索

```
C-a / 
```

或者

```
C-a ? 
```

或者

```
C-a s 
```

或者

```
C-a r 
```

但是，没有一个命令对我有用。我有以下.screenrc。

**我的 .screenrc**

```
markkeys h=d:j=h:k=t:l=n

# to change the escape key from ^Aa to 
# NB ^n to move btw Screens
escape ^Tt

# I want to use Vim's navigation keys
bind h focus down 
bind t focus up

### Keybindings# {{{

# to disable xoff
bind s

# remove some key bindings                                                                                                                                                                                    
bind W
#bind ^\
#bind \\
bind ^h

# same as C-a "
bind 'W' windowlist 
```

**如何在 Screen 中有效地搜索，**以便获得所有匹配的颜色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T17:08:28.573

您必须先进入复印模式（按`C-a [`）。在复制模式下，按`/`向前搜索（然后键入要搜索的内容，然后按*Enter*），或`?`向后搜索。按两次*Enter*退出复印模式。

# twitter - 推特状态更新 URL 中的数字是多少？

> ID：843667
> 
> 赞同：1
> 
> 时间：2009-05-09T17:10:14.110
> 
> 标签：twitter

我最新的 Twitter 状态更新有 URL [http://twitter.com/dinomite/status/1743967905](http://twitter.com/dinomite/status/1743967905) 有人知道这个数字背后是否有任何押韵或原因`1743967905`吗？在我看来，它可能是一个为所有 Twitter 用户按顺序分配的数字；我当然没有更新 1.7b 次，但所有的 Twitter 可能都在这个范围内。有人知道吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T17:18:49.910

根据 Twitter API 文档，它是状态的数字 ID。我猜它在所有用户中都是唯一且连续的，但我不确定。如果您需要了解更多信息，请查看[此处](http://apiwiki.twitter.com/Twitter-REST-API-Method%3A-statuses%C2%A0show)的官方文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T17:15:49.107

那可能是状态表中的主键。该 URL 格式用于查看特定的推文。

请注意， http: [//twitter.com/dinomite](http://twitter.com/dinomite)是实际的提要。

此外，根据它的增量增长方式，这可能是一个 IDENTITY 列或类似的列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T17:17:24.577

是的，它们是连续的。

它有帮助的一件事是在编写 Twitter 客户端时，您可以要求比您已经看到的最后一个数字更新的任何内容，这样您就不会得到并且必须解析重复项。

# python - Python 中的分析：谁调用了该函数？

> ID：843671
> 
> 赞同：56
> 
> 时间：2009-05-09T17:10:52.750
> 
> 标签：python, profiling

我在 Python 中使用`cProfile`. 我发现了一个占用大量 CPU 时间的函数。如何找出哪个函数调用这个繁重的函数最多？

**编辑：**

我将解决一个变通办法：我可以在那个繁重的函数中编写一条 Python 行来打印调用它的函数的名称吗？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-05-09T17:41:25.270

我几乎总是使用[Gprof2dot](https://github.com/jrfonseca/gprof2dot)查看 cProfile 模块的输出，基本上它将输出转换为 graphvis 图（一个`.dot`文件），例如：

[![示例 gprof2dot 输出](https://i.stack.imgur.com/1LrS7.png)](https://raw.githubusercontent.com/jrfonseca/gprof2dot/733b59379592c39d9f595de7323260d397b8d3b9/sample.png)

它可以很容易地确定哪个函数最慢，以及哪个函数调用了它。

用法是：

```
python -m cProfile -o output.pstats path/to/your/script arg1 arg2
gprof2dot.py -f pstats output.pstats | dot -Tpng -o output.png 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-05-09T17:18:58.210

这可能不会直接回答您的问题，但肯定会有所帮助。如果使用带有选项的分析器 --sort 累积，它将按累积时间对函数进行排序。这不仅有助于检测繁重的函数，还有助于检测调用它们的函数。

```
python -m cProfile --sort cumulative myScript.py 
```

有一个解决方法来获取调用者函数：

```
import inspect
print inspect.getframeinfo(inspect.currentframe().f_back)[2] 
```

您可以根据需要添加任意数量的 f_back 以防您想要呼叫者呼叫者等如果您想计算频繁呼叫，您可以这样做：

```
record = {}

caller = inspect.getframeinfo(inspect.currentframe().f_back)[2]
record[caller] = record.get(caller, 0) + 1 
```

然后按频率顺序打印它们：

```
print sorted(record.items(), key=lambda a: a[1]) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-09T17:25:37.773

[inspect.stack()](http://docs.python.org/library/inspect.html#inspect.stack)会给你当前的调用者堆栈。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-10T19:16:22.037

您可能想看看[pycallgraph](http://pycallgraph.slowchop.com/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-10-16T05:22:07.270

`cProfile`可以使用标准库 中的分析器来做到这一点。
在`pstats.Stats`（探查器结果）中有方法`print_callees`（或替代方法`print_callers`）。

示例代码：

```
import cProfile, pstats
pr = cProfile.Profile()
pr.enable()

# ... do something ...

pr.disable()
ps = pstats.Stats(pr).strip_dirs().sort_stats('cumulative')
ps.print_callees() 
```

结果将类似于：

```
Function                           called...
                                       ncalls  tottime  cumtime
ElementTree.py:1517(_start_list)   ->   24093    0.048    0.124  ElementTree.py:1399(start)
                                        46429    0.015    0.041  ElementTree.py:1490(_fixtext)
                                        70522    0.015    0.015  ElementTree.py:1497(_fixname)
ElementTree.py:1527(_data)         ->   47827    0.017    0.026  ElementTree.py:1388(data)
                                        47827    0.018    0.053  ElementTree.py:1490(_fixtext) 
```

左边是调用者，右边是被调用者。
（例如`_fixtext`从`_data`47827 次和从`_start_list`46429 次调用）

也可以看看：

*   [docs.python.org/..#print_callees](https://docs.python.org/2/library/profile.html#pstats.Stats.print_callees) - 显示调用层次结构。按呼叫者分组。（上面用过）
*   [docs.python.org/..#print_callers](https://docs.python.org/2/library/profile.html#pstats.Stats.print_callers) - 显示调用层次结构。按被叫方分组。

几点注意事项：

*   为此需要编辑您的代码（插入那些配置文件语句）。
    （即不能从命令行使用，例如`python -m cProfile myscript.py`。虽然可以为此编写单独的脚本）
*   有点无关，但`strip_dirs()`必须先去`sort_stats()`（否则排序不起作用）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-09T17:20:00.767

我自己没有使用过 cProfile，但大多数分析器都会给你一个调用层次结构。
谷歌搜索我发现这张关于 cProfile 的[幻灯片。](http://us.pycon.org/media/2009/talkdata/PyCon2009/015/fletcher-profiling-2009.pdf)也许这有帮助。第 6 页看起来 cProfile 确实提供了层次结构。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-10T18:45:34.580

抱歉，我不熟悉 Python，但有一个[通用的方法](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)可以工作，假设您可以在随机时间手动中断执行。

只需这样做，并显示调用堆栈。它很有可能会告诉您您想知道的内容。如果你想更确定，就多做几次。

它之所以有效，是因为有罪的调用者必须在调用堆栈上浪费一部分时间，这会在大部分时间将其暴露给您的中断，无论它是分布在许多短调用还是几个长调用中。

注意：这个过程更像是诊断而不是测量。假设糟糕的调用浪费了 90% 的时间。然后每次你停止它，错误的调用语句就在调用堆栈上供你查看的概率是 90%，你将能够看到它是错误的。但是，如果您想准确测量损耗，那就是另一个问题了。为此，您将需要更多样本，以查看其中包含该调用的百分比。或者，只需修复有罪的电话，计时加速，这将告诉您确切的浪费是什么。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-21T13:18:29.693

Pycscope 就是这样做的。我今天才发现它，所以我不能说它有多好，但我尝试过的几个例子都很好（虽然并不完美）。

[https://pypi.python.org/pypi/pycscope/](https://pypi.python.org/pypi/pycscope/)

您将使用它来生成一个 cscope 文件，然后从编辑器（特别是 VIM）生成一个 cscope 插件。我尝试将它与 vanilla cscope 一起使用，似乎普通的 cscope 会感到困惑。

# android - 如何确定 Android 设备的 GPS 是否已启用

> ID：843675
> 
> 赞同：210
> 
> 时间：2009-05-09T17:13:01.187
> 
> 标签：android, gps, android-sensors, android-1.5-cupcake

在支持 Android Cupcake (1.5) 的设备上，如何检查和激活 GPS？

* * *

## 回答 #1

> 赞同：467
> 
> 时间：2009-05-09T17:33:00.987

最好的方法似乎如下：

```
 final LocationManager manager = (LocationManager) getSystemService( Context.LOCATION_SERVICE );

    if ( !manager.isProviderEnabled( LocationManager.GPS_PROVIDER ) ) {
        buildAlertMessageNoGps();
    }

  private void buildAlertMessageNoGps() {
    final AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setMessage("Your GPS seems to be disabled, do you want to enable it?")
           .setCancelable(false)
           .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
               public void onClick(@SuppressWarnings("unused") final DialogInterface dialog, @SuppressWarnings("unused") final int id) {
                   startActivity(new Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS));
               }
           })
           .setNegativeButton("No", new DialogInterface.OnClickListener() {
               public void onClick(final DialogInterface dialog, @SuppressWarnings("unused") final int id) {
                    dialog.cancel();
               }
           });
    final AlertDialog alert = builder.create();
    alert.show();
} 
```

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2011-11-03T06:14:41.027

在 android 中，我们可以使用 LocationManager 轻松检查设备中是否启用了 GPS。

这是一个简单的检查程序。

GPS 是否启用：- 在 AndroidManifest.xml 中添加以下用户权限行以访问位置

```
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" /> 
```

你的java类文件应该是

```
public class ExampleApp extends Activity {
    /** Called when the activity is first created. */
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        LocationManager locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);

        if (locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER)){
            Toast.makeText(this, "GPS is Enabled in your devide", Toast.LENGTH_SHORT).show();
        }else{
            showGPSDisabledAlertToUser();
        }
    }

    private void showGPSDisabledAlertToUser(){
        AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(this);
        alertDialogBuilder.setMessage("GPS is disabled in your device. Would you like to enable it?")
        .setCancelable(false)
        .setPositiveButton("Goto Settings Page To Enable GPS",
                new DialogInterface.OnClickListener(){
            public void onClick(DialogInterface dialog, int id){
                Intent callGPSSettingIntent = new Intent(
                        android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS);
                startActivity(callGPSSettingIntent);
            }
        });
        alertDialogBuilder.setNegativeButton("Cancel",
                new DialogInterface.OnClickListener(){
            public void onClick(DialogInterface dialog, int id){
                dialog.cancel();
            }
        });
        AlertDialog alert = alertDialogBuilder.create();
        alert.show();
    }
} 
```

输出看起来像

![在此处输入图像描述](https://i.stack.imgur.com/vv8KA.png)

![在此处输入图像描述](https://i.stack.imgur.com/9jht8.png)

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2010-02-05T00:01:21.170

是的，GPS 设置不能再以编程方式更改，因为它们是隐私设置，我们必须检查它们是否已从程序中打开，如果未打开，则对其进行处理。您可以通知用户 GPS 已关闭，并根据需要使用类似的方式向用户显示设置屏幕。

检查位置提供程序是否可用

```
 String provider = Settings.Secure.getString(getContentResolver(), Settings.Secure.LOCATION_PROVIDERS_ALLOWED);
    if(provider != null){
        Log.v(TAG, " Location providers: "+provider);
        //Start searching for location and update the location text when update available
        startFetchingLocation();
    }else{
        // Notify users and show settings if they want to enable GPS
    } 
```

如果用户想要启用 GPS，您可以通过这种方式显示设置屏幕。

```
Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
startActivityForResult(intent, REQUEST_CODE); 
```

在您的 onActivityResult 中，您可以查看用户是否启用了它

```
 protected void onActivityResult(int requestCode, int resultCode, Intent data){
        if(requestCode == REQUEST_CODE && resultCode == 0){
            String provider = Settings.Secure.getString(getContentResolver(), Settings.Secure.LOCATION_PROVIDERS_ALLOWED);
            if(provider != null){
                Log.v(TAG, " Location providers: "+provider);
                //Start searching for location and update the location text when update available. 
// Do whatever you want
                startFetchingLocation();
            }else{
                //Users did not switch on the GPS
            }
        }
    } 
```

这是一种方法，我希望它有所帮助。如果我做错了什么，请告诉我。

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2014-03-05T09:37:54.553

以下是步骤：

**第 1 步：**创建在后台运行的服务。

**第 2 步：**您还需要在 Manifest 文件中获得以下权限：

```
android.permission.ACCESS_FINE_LOCATION 
```

**第三步：**编写代码：

```
 final LocationManager manager = (LocationManager)context.getSystemService    (Context.LOCATION_SERVICE );

if ( !manager.isProviderEnabled( LocationManager.GPS_PROVIDER ) )
  Toast.makeText(context, "GPS is disabled!", Toast.LENGTH_LONG).show(); 
else
  Toast.makeText(context, "GPS is enabled!", Toast.LENGTH_LONG).show(); 
```

**第 4 步：**或者您可以使用以下命令进行检查：

```
LocationManager manager = (LocationManager) getSystemService(Context.LOCATION_SERVICE );
boolean statusOfGPS = manager.isProviderEnabled(LocationManager.GPS_PROVIDER); 
```

**第 5 步：**持续运行您的服务以监控连接。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2015-03-19T08:25:51.997

Yes you can check below is the code:

```
public boolean isGPSEnabled (Context mContext){
    LocationManager locationManager = (LocationManager)
                mContext.getSystemService(Context.LOCATION_SERVICE);
    return locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER);
} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2019-11-25T12:17:47.110

在 Kotlin 中：如何检查 GPS 是否启用

```
 val manager = getSystemService(Context.LOCATION_SERVICE) as LocationManager
        if (!manager.isProviderEnabled(LocationManager.GPS_PROVIDER)) {
            checkGPSEnable()
        } 

 private fun checkGPSEnable() {
        val dialogBuilder = AlertDialog.Builder(this)
        dialogBuilder.setMessage("Your GPS seems to be disabled, do you want to enable it?")
                .setCancelable(false)
                .setPositiveButton("Yes", DialogInterface.OnClickListener { dialog, id
                    ->
                    startActivity(Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS))
                })
                .setNegativeButton("No", DialogInterface.OnClickListener { dialog, id ->
                    dialog.cancel()
                })
        val alert = dialogBuilder.create()
        alert.show()
    } 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2018-12-20T09:27:58.233

此方法将使用**LocationManager**服务。

**来源[链接](https://www.freakyjolly.com/android-useful-methods-and-functions/#2method)**

```
//Check GPS Status true/false
public static boolean checkGPSStatus(Context context){
    LocationManager manager = (LocationManager) context.getSystemService(Context.LOCATION_SERVICE );
    boolean statusOfGPS = manager.isProviderEnabled(LocationManager.GPS_PROVIDER);
    return statusOfGPS;
}; 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2016-09-21T07:28:05.210

这是在我的案例中工作的片段

```
final LocationManager manager = (LocationManager) getSystemService(Context.LOCATION_SERVICE );
if ( !manager.isProviderEnabled( LocationManager.GPS_PROVIDER ) ) {
    buildAlertMessageNoGps();
} 
```

`

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-05-10T12:40:58.333

如果用户允许在其设置中使用 GPS，则将使用 GPS。

你不能再明确地打开它，但你不必这样做——它真的是一个隐私设置，所以你不想调整它。如果用户对获得精确坐标的应用程序感到满意，它将启用。然后，如果可以，位置管理器 API 将使用 GPS。

如果您的应用在没有 GPS 的情况下真的没有用，并且它已关闭，您可以使用 Intent 在右侧屏幕上打开设置应用，以便用户启用它。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2021-01-26T12:59:14.610

Kotlin 解决方案：

```
private fun locationEnabled() : Boolean {
    val locationManager = getSystemService(Context.LOCATION_SERVICE) as LocationManager
    return locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER)
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-08-08T12:03:22.637

在您的`LocationListener`, 实现`onProviderEnabled`和`onProviderDisabled`事件处理程序中。当您拨打电话时`requestLocationUpdates(...)`，如果手机上禁用了 GPS，`onProviderDisabled`则会被呼叫；如果用户启用 GPS，`onProviderEnabled`将被调用。

# javascript - 如何使用 Javascript 替换 DOM 元素？

> ID：843680
> 
> 赞同：194
> 
> 时间：2009-05-09T17:14:12.417
> 
> 标签：javascript, dom

我正在寻找替换 DOM 中的元素。
例如，有一个`<a>`元素我想用 a`<span>`代替。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：218
> 
> 时间：2009-05-09T17:15:41.663

通过使用[replaceChild()](https://developer.mozilla.org/en-US/docs/Web/API/Node/replaceChild)：

```
<html>
<head>
</head>
<body>
  <div>
    <a id="myAnchor" href="http://www.stackoverflow.com">StackOverflow</a>
  </div>
<script type="text/JavaScript">
  var myAnchor = document.getElementById("myAnchor");
  var mySpan = document.createElement("span");
  mySpan.innerHTML = "replaced anchor!";
  myAnchor.parentNode.replaceChild(mySpan, myAnchor);
</script>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2016-11-05T23:18:51.357

# [`A.replaceWith(span)`](https://developer.mozilla.org/en-US/docs/Web/API/ChildNode/replaceWith)- 不需要父母

**通用形式：**

```
target.replaceWith(element) 
```

比以前的方法更好/更清洁。

**对于您的用例：**

```
A.replaceWith(span) 
```

## 高级用法

1.  您可以传递多个值（或使用扩展运算符`...`）。
2.  任何字符串值都将作为文本元素添加。

**例子：**

```
// Initially [child1, target, child3]

target.replaceWith(span, "foo")     // [child1, span, "foo", child3]

const list = ["bar", span]
target.replaceWith(...list, "fizz")  // [child1, "bar", span, "fizz", child3] 
```

### 安全处理`null`目标

如果您的目标有机会为空，您可以考虑使用新的`?.` *可选链接*运算符。如果目标不存在，什么都不会发生。[在这里](https://stackoverflow.com/a/62824031/974045)阅读更多。

```
target?.replaceWith?.(element) 
```

## 相关 DOM 方法

1.  [阅读更多](https://stackoverflow.com/a/45656649/974045)-`child.before`和`child.after`
2.  [阅读更多](https://stackoverflow.com/a/43838105/974045)-`parent.prepend`和`parent.append`

[Mozilla 文档](https://developer.mozilla.org/en-US/docs/Web/API/ChildNode/replaceWith)

[支持的浏览器](https://caniuse.com/#feat=dom-manip-convenience)- 22 年 2 月 96%

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2009-05-09T17:20:27.537

```
var a = A.parentNode.replaceChild(document.createElement("span"), A); 
```

a 是被替换的 A 元素。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-05-22T18:59:26.257

这个问题很老了，但我发现自己正在学习微软认证，并且在学习书中建议使用：

```
oldElement.replaceNode(newElement) 
```

我查了一下，似乎只有 IE 支持。呵呵..

我想我只是在这里添加它作为一个有趣的旁注；）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-03-24T07:45:31.430

我有一个类似的问题，并找到了这个线程。替换对我不起作用，而且我的情况很难由父母去。Inner Html 替换了孩子，这也不是我想要的。使用 outerHTML 完成了工作。希望这对其他人有帮助！

```
currEl = <div>hello</div>
newElem = <span>Goodbye</span>
currEl.outerHTML = newElem
# currEl = <span>Goodbye</span> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-03-04T08:11:14.843

[`replaceChild`](https://developer.mozilla.org/en-US/docs/Web/API/Node/replaceChild)创建新元素 ( ) 后，您可以在目标元素的父级上使用[`createElement`](https://developer.mozilla.org/en-US/docs/Web/API/Document/createElement)：

```
const newElement = document.createElement(/*...*/);
const target = document.getElementById("my-table");
target.parentNode.replaceChild(newElement, target); 
```

如果新元素的起点是 HTML，则可以在父元素（或元素本身，在现代环境中）上使用[`insertAdjacentHTML`](https://developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentHTML)然后：[`removeChild`](https://developer.mozilla.org/en-US/docs/Web/API/Node/removeChild)[`remove`](https://developer.mozilla.org/en-US/docs/Web/API/ChildNode/remove)

```
const target = document.getElementById("my-table");
target.insertAdjacentHTML("afterend", theHTMLForTheNewElement);
target.parentNode.removeChild(target); // Or: `target.remove()` 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-05-02T00:31:19.843

您可以替换`HTML Element`或`Node`使用`Node.replaceWith(newNode)`。

此示例应保留原始节点的所有属性和子节点：

```
const links = document.querySelectorAll('a')

links.forEach(link => {
  const replacement = document.createElement('span')

  // copy attributes
  for (let i = 0; i < link.attributes.length; i++) {
     const attr = link.attributes[i]
     replacement.setAttribute(attr.name, attr.value)
  }

  // copy content
  replacement.innerHTML = link.innerHTML

  // or you can use appendChild instead
  // link.childNodes.forEach(node => replacement.appendChild(node))

  link.replaceWith(replacement)
}) 
```

如果你有这些元素：

```
<a href="#link-1">Link 1</a>
<a href="#link-2">Link 2</a>
<a href="#link-3">Link 3</a>
<a href="#link-4">Link 4</a> 
```

运行上述代码后，您将得到以下元素：

```
<span href="#link-1">Link 1</span>
<span href="#link-2">Link 2</span>
<span href="#link-3">Link 3</span>
<span href="#link-4">Link 4</span> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-12-10T08:13:26.213

最好的方法。不需要父母。只需使用`Element.outerHTML = template;`

```
// Get the current element
var currentNode = document.querySelector('#greeting');

// Replace the element
currentNode.outerHTML =
    '<div id="salutations">' +
        '<h1>Hi, universe!</h1>' +
        '<p>The sun is always shining!</p>' +
    '</div>'; 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2018-10-01T06:22:01.077

替换 LI 元素的示例

```
function (element) {
    let li = element.parentElement;
    let ul = li.parentNode;   
    if (li.nextSibling.nodeName === 'LI') {
        let li_replaced = ul.replaceChild(li, li.nextSibling);
        ul.insertBefore(li_replaced, li);
    }
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2019-05-26T22:48:10.507

鉴于已经提出的选项，最简单的解决方案无需找到父母：

```
var parent = document.createElement("div");
var child = parent.appendChild(document.createElement("a"));
var span = document.createElement("span");

// for IE
if("replaceNode" in child)
  child.replaceNode(span);

// for other browsers
if("replaceWith" in child)
  child.replaceWith(span);

console.log(parent.outerHTML); 
```

# objective-c - Cocoa NSView 更改自动调整大小的属性

> ID：843683
> 
> 赞同：21
> 
> 时间：2009-05-09T17:15:56.827
> 
> 标签：objective-c, cocoa, macos

使用界面生成器，您可以选择对象在调整大小时应该坚持的角。你怎么能以编程方式做到这一点？

![界面生成器](https://i.stack.imgur.com/Jsp4f.png)

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-09T19:25:25.130

我发现`autoresizingBit`面具的名字很可怕，所以我在 NSView 上使用了一个类别来使事情更加明确：

```
// MyNSViewCategory.h:
@interface NSView (myCustomMethods)

- (void)fixLeftEdge:(BOOL)fixed;
- (void)fixRightEdge:(BOOL)fixed;
- (void)fixTopEdge:(BOOL)fixed;
- (void)fixBottomEdge:(BOOL)fixed;
- (void)fixWidth:(BOOL)fixed;
- (void)fixHeight:(BOOL)fixed;

@end 
```

```
// MyNSViewCategory.m:
@implementation NSView (myCustomMethods)

- (void)setAutoresizingBit:(unsigned int)bitMask toValue:(BOOL)set
{
    if (set)
    { [self setAutoresizingMask:([self autoresizingMask] | bitMask)]; }
    else
    { [self setAutoresizingMask:([self autoresizingMask] & ~bitMask)]; }
}

- (void)fixLeftEdge:(BOOL)fixed
{ [self setAutoresizingBit:NSViewMinXMargin toValue:!fixed]; }

- (void)fixRightEdge:(BOOL)fixed
{ [self setAutoresizingBit:NSViewMaxXMargin toValue:!fixed]; }

- (void)fixTopEdge:(BOOL)fixed
{ [self setAutoresizingBit:NSViewMinYMargin toValue:!fixed]; }

- (void)fixBottomEdge:(BOOL)fixed
{ [self setAutoresizingBit:NSViewMaxYMargin toValue:!fixed]; }

- (void)fixWidth:(BOOL)fixed
{ [self setAutoresizingBit:NSViewWidthSizable toValue:!fixed]; }

- (void)fixHeight:(BOOL)fixed
{ [self setAutoresizingBit:NSViewHeightSizable toValue:!fixed]; }

@end 
```

然后可以按如下方式使用：

```
[someView fixLeftEdge:YES];
[someView fixTopEdge:YES];
[someView fixWidth:NO]; 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-09T17:32:17.773

请参阅 NSView 的[setAutoresizingMask:](http://developer.apple.com/mac/library/documentation/Cocoa/Reference/ApplicationKit/Classes/NSView_Class/Reference/NSView.html#//apple_ref/occ/instm/NSView/setAutoresizingMask:)方法和相关的[调整大小掩码](http://developer.apple.com/mac/library/documentation/Cocoa/Reference/ApplicationKit/Classes/NSView_Class/Reference/NSView.html#//apple_ref/doc/constant_group/Resizing_masks)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-09T18:10:55.917

每个视图都有标志掩码，通过设置 autoresizingMask 属性与您想要从[调整大小掩码](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/nsview%5FClass/Reference/NSView.html#//apple%5Fref/doc/constant%5Fgroup/Resizing%5Fmasks)中获得的行为的 OR 来控制。此外，需要配置 superview 以[调整其 subviews](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/nsview%5FClass/Reference/NSView.html#//apple_ref/occ/instm/NSView/setAutoresizesSubviews:)的大小。

最后，除了基本的掩码定义的调整大小选项外，您还可以通过实现[-resizeSubviewsWithOldSize 来完全控制子视图的布局：](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/nsview%5FClass/Reference/NSView.html#//apple_ref/occ/instm/NSView/resizeSubviewsWithOldSize:)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-08-04T23:53:46.183

@e.James 的回答给了我一个想法，即简单地创建一个具有更熟悉命名的新枚举：

```
typedef NS_OPTIONS(NSUInteger, NSViewAutoresizing) {
    NSViewAutoresizingNone                 = NSViewNotSizable,
    NSViewAutoresizingFlexibleLeftMargin   = NSViewMinXMargin,
    NSViewAutoresizingFlexibleWidth        = NSViewWidthSizable,
    NSViewAutoresizingFlexibleRightMargin  = NSViewMaxXMargin,
    NSViewAutoresizingFlexibleTopMargin    = NSViewMaxYMargin,
    NSViewAutoresizingFlexibleHeight       = NSViewHeightSizable,
    NSViewAutoresizingFlexibleBottomMargin = NSViewMinYMargin
}; 
```

另外，从我的研究中，我发现@James.s**在 NSView 添加中有一个严重的错误。**Cocoa 中的坐标系在 iOS 坐标系中具有翻转的 y 轴。因此，为了固定底部和顶部边距，您应该编写：

```
- (void)fixTopEdge:(BOOL)fixed
{ [self setAutoresizingBit:NSViewMaxYMargin toValue:!fixed]; }

- (void)fixBottomEdge:(BOOL)fixed
{ [self setAutoresizingBit:NSViewMinYMargin toValue:!fixed]; } 
```

来自可可文档：

> NSViewMinYMargin
> 
> ```
> The bottom margin between the receiver and its superview is flexible.
> Available in OS X v10.0 and later. 
> ```

# c# - 如何将一个窗口锁定到另一个窗口？[winforms]

> ID：843689
> 
> 赞同：2
> 
> 时间：2009-05-09T17:18:54.560
> 
> 标签：c#, winforms

我希望我的软件在第一次启动时显示一个教程窗口，并让这个窗口“锁定”在主窗口的右侧，这样，每当我移动主窗口时，孩子就会跟随。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T18:15:07.717

正如[John Gietzen](https://stackoverflow.com/questions/843689/how-to-lock-a-window-to-another-winforms/843695#843695)所提到的，您需要捕获主窗口的移动并重新定位子窗口。

但是，如果用户直接移动子窗口，这将失败。

如果您想强制两者始终保持在一起，最好将它们放在一个窗口中。拥有两个窗口并试图覆盖正常的 Windows 行为可能不是一个干净的方法——它比仅仅尝试创建一个“正常”窗口更令人困惑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T17:21:03.807

通常，您需要为父窗口捕获 OnMove 事件并重新定位子窗口。

我不相信有 WinAPI 方法可以做到这一点，所以它会有点手动编码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T17:25:24.123

正如 John Gietzen 所说，没有办法让 Windows 为您执行此操作，如果您通过处理 OnMove 事件来执行此操作，您将在用户移动或调整主窗口大小时出现延迟。

另一种方法是扩大主窗口并将教程窗口放入其中，在右侧下方。

# .net - ASP.NET 数据库错误捕获

> ID：843693
> 
> 赞同：0
> 
> 时间：2009-05-09T17:20:17.303
> 
> 标签：.net, ado.net, exception-handling

我很好奇人们如何在 .NET 中捕获某些数据库错误，特别是外键或唯一索引违规。来自经典的 ASP/VB 背景，我的第一个倾向是测试错误号，然后向用户创建一个友好的消息，告诉用户有问题。但是，我认为在 .NET 世界中，会有类似 SqlForeignKeyException 或类似的东西。如果存在这样的事情，我在任何地方的文档中都找不到它。您如何处理此类错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T17:26:35.760

如果您的应用程序正在生成外键或唯一索引违规，则该应用程序可能存在问题，您需要通知开发人员，而不是用户。也就是说，通常验证用户提供的输入应该可以防止抛出这些类型的异常。

一种常见的方法是在 Application_Error 事件中捕获未处理的错误，并将它们记录到文件或数据库中。还有一些工具可以帮助记录错误，例如[ELMAH](https://code.google.com/archive/p/elmah/)

对于用户来说，只需要一条通用消息就可以了……但开发人员应该密切关注错误日志。请参阅 Jeff Atwood 关于[异常驱动开发](https://blog.codinghorror.com/exception-driven-development/)的帖子。

编辑：回答您问题的另一部分 - .NET 中有各种不同的异常对象，但大多数 SQL 异常似乎都是作为通用 SqlException 类出现的。您可以通过检查 Message 和 StackTrace() 属性以及深入了解 InnerException 属性来了解有关错误的更多信息。诸如外键违规之类的事情可能会表现为一个 HttpException，其中嵌套了一个 SqlException。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T13:34:00.687

通过说 SqlException，您必须使用 SQL Server-

如果您想知道它是否具体是外键错误，请检查 SqlExceptions 内部异常并[检查 Number 属性。这个](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlexception.number.aspx)数字对应于 master.dbo.sysmessages 表中的一个条目，数字 0 到 50000 是 SQL 错误，50000+ 是用户定义的。

不要忘记[遍历错误集合](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlexception.aspx)——SQL 可以返回多个错误。

如果您正在使用[返回值，请同时检查](http://www.codeguru.com/forum/archive/index.php/t-182960.html)。您必须阅读 TSQL 源代码以查看是否使用了这种特殊的错误报告样式。

警告是级别 10 或更低的错误，必须通过 SqlInfoMessage 事件捕获。

如果程序返回@@error，请[确保它被保留](http://msdn.microsoft.com/en-us/library/aa175920(SQL.80).aspx)，因为@@error 在批处理中的下一个后续命令重置为成功。

# python - 如何选择在 PyObjC 程序中运行的 Python 安装？

> ID：843698
> 
> 赞同：1
> 
> 时间：2009-05-09T17:22:14.583
> 
> 标签：python, objective-c, macos, pyobjc

我使用 Python 2.6 比使用 Leopard 的默认 python 安装更多，所以我将它设置为我的主要 Python 安装。但我宁愿将默认 Python 用于我正在开发的 PyObjC 程序。有没有办法指定只使用它而不是 Python 2.6？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-10T15:57:20.377

终于自己搞定了这个。这样做的关键是使用 /System/Library/Frameworks/Python.framework 而不是 /Library/Frameworks/Python.framework 建立最终的可执行链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T17:25:05.933

尝试在命令行中指定 Python 解释器的完整路径，例如：

```
/foo/bar/python2.6 script.py
/baz/python objcscript.py 
```

您还可以在脚本的开头添加一个 shebang（第一行）：

```
#! /foo/bar/python2.6 script.py 
```

如果您设置了环境变量`PYTHONPATH`，则可能必须取消设置或更改它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-10T10:07:34.887

AFAIR 这对我有帮助（在 main.m 中）：

```
 NSArray *pythonPathArray = [NSArray arrayWithObjects: resourcePath, [resourcePath stringByAppendingPathComponent:@"PyObjC"], @"/System/Library/Frameworks/Python.framework/Versions/Current/Extras/lib/python/", @"/Library/Python/2.5/site-packages", nil]; 
```

此外，请确保这指向您要使用的 Python 安装 (main.m)：

```
 Py_SetProgramName("/usr/bin/python"); 
```

# vim - 无法消除 Vim 的 Taglist 中的 T

> ID：843699
> 
> 赞同：1
> 
> 时间：2009-05-09T17:23:23.787
> 
> 标签：vim, dvorak, taglist

我在 .vimrc 中有以下代码

```
" to eliminate the effect of the line 1560 in taglist.vim 
if v:version >= 700
         nnoremap <buffer> <silent> t
                     \ 
         nnoremap <buffer> <silent> <C-t>
                     \                                                                                                                                                                                        
         endif 
```

该命令执行它应该执行的操作。但是，该命令在 Vim 启动时也给了我以下错误

```
No mapping found
No mapping found 
```

**您如何消除键盘快捷键，**这样您就不会在 Taglist 中收到消息，但您仍然可以使用默认的“T”在 Dvorak 中向上浏览？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T19:03:58.410

删除它。我不使用 taglist，但是您在帖子中给出的示例什么也没做。它应该将某些东西映射到某些东西，但是缺少右侧，即应该将某些东西映射到“t”和“Ct”，但是没有定义某些东西。

或者，您可以这样做：

```
:silent nnoremap <buffer> <silent> t (and analoguous for the second line) 
```

（映射保留但不会显示消息）

# c++ - 本机应用程序的大量初始内存占用

> ID：843705
> 
> 赞同：3
> 
> 时间：2009-05-09T17:26:40.970
> 
> 标签：c++, windows, debugging, memory, native

我注意到我正在处理的本机 C++ 应用程序在进入我的任何代码之前就具有相当大的内存占用 (20MB)。

（我指的是 Windows 中的“私有字节”度量，据我了解，这是最有用的度量）。

我在“main()”函数的第一行放置了一个断点，果然，当它到达那个位置时，占用空间是 20MB。

EXE 的大小只有几兆，所以这还不算。

我还故意删除了所有的 DLL，只是为了证明它们不是原因。正如预期的那样，它收到“找不到 Dll”消息，但占用空间仍然是 20MB！

所以然后我想知道可能是静态初始化的对象是原因。

因此，我在“new”和“malloc”中都添加了断点。在第一次命中（对于第一个静态初始化程序）时，内存已经是 20MB。

有人对我如何诊断是什么消耗了这段记忆有任何想法吗？

因为它似乎是通常的 new/malloc 范式之外的内存，所以我很难理解如何调试。

干杯，

约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T17:41:35.537

您可能会在没有调试信息的情况下编译您的应用程序，看看这是否会改变某些内容，调试能力会占用一些内存。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T17:57:18.103

可能是您的应用程序使用了很多库。它们中的大多数在执行交给你的 main() 之前被初始化。检查您链接的任何非标准库。

编辑：一个非常简单的解决方案是创建一个新项目，然后一个一个链接您正在使用的库，每次检查内存使用情况。即使这是一种丑陋的方法，您也应该以这种方式找到罪魁祸首。

那里可能有一个更优雅的解决方案，因此您可能想花一些时间在谷歌上搜索（免费）内存分析解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T17:46:48.237

在我的系统上，一个简单的 MFC 应用程序和一个空的 Delphi 应用程序都占用相同数量的私有字节——大约 400K。因此，如果您的应用程序占用 20Mb，那肯定是您的应用程序正在做的事情，而不是一些操作系统膨胀。您需要发布有关您的应用程序的功能、它使用的库等的更多详细信息。

# php - 有人可以向我描述一些 DI 术语吗？

> ID：843706
> 
> 赞同：1
> 
> 时间：2009-05-09T17:27:32.170
> 
> 标签：php, dependency-injection, terminology

我正在为 PHP 5 编写 DI 框架，我一直在尝试找到与依赖注入相关的一些词的“官方”定义。其中一些词是“**上下文**”和“**生命周期**”。而且，我将如何称呼**创建/注入**的对象？最后，组件和服务之间有什么区别，我应该调用哪个术语（如果有的话）可以注入的对象？

我已阅读 Martin Fowler 的文章并查看了其他 DI 框架（Phemto、Spring、Google Guice、Xyster 等），但我想知道您的想法。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T18:40:07.783

计算机编程中的依赖注入 (DI) 是指向软件组件提供外部依赖的过程。它是一种特定形式的控制反转，其中反转的关注点是获得所需依赖关系的过程。

*   生命周期：单例，每个请求，瞬态......应该在容器中存活多长时间
*   components ：更简单的定义可以是：组件是写入规范的对象。规范是什么并不重要：COM、Enterprise JavaBeans 等，只要对象符合规范即可。
*   服务：术语服务是指一组离散定义的连续和自主的业务或技术功能。
*   context ：在容器级别向消费者提供的实现的分离。例如，绿色页面上的黄金合伙人将有 15% 的红色袜子折扣。

玩得开心 ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T17:41:42.947

我不知道有一个“官方”的定义。Fowler 的文章是我在 DI 上阅读的第一篇文章。如果这对您来说不够权威，我看不出 SO 将如何改进。

“透视”对您意味着什么？您阅读了多少文档？您是否尝试过用它编写任何应用程序？如果您已经使用 Spring 和 Guice 编写过代码，那么您已经很好地完成了自己的调查。如果您刚刚阅读了 Google 带回的几篇文章，那么您还有更多工作要做。

Spring 中的“上下文”表示用于为您实例化对象的工厂。我通常每个应用程序或网络应用程序都有一个。我的应用程序通常是创建对象的“上下文”。

“生命周期”对于 DI 没有什么不同——它与对象的创建、初始化、使用和销毁时间有关。

组件是单个软件工件中的数据和操作。服务是执行重要业务操作的特殊类型的组件，通常分布在网络上。服务通常是组件，但并非所有组件都是服务。它们不是同义词。

您可以在没有 DI 框架的情况下编写组件或服务。如果它可以帮助您将注入的对象称为“组件”，请成为我的客人。

我很好奇：为什么要强调这些东西的名称？命名当然很重要，但这不是 DI 的主要问题。

# c++ - 如何拦截发送到窗口的消息？

> ID：843711
> 
> 赞同：11
> 
> 时间：2009-05-09T17:31:40.100
> 
> 标签：c++, windows, subclass

我想截获在不同进程中发送到窗口的消息。做这个的最好方式是什么？使用 WH_GETMESSAGE 挂钩时看不到消息，并且不确定是否可以跨进程进行子类化？任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-09T18:23:30.850

您需要将自己的代码注入拥有您希望从中拦截消息的窗口的进程中。幸运的是，[`SetWindowsHookEx()`](http://msdn.microsoft.com/en-us/library/ms644990.aspx)这使这变得相当容易，尽管如果您到目前为止只将它用于进程内连接，那么一开始您可能会遇到一些麻烦。

我可以推荐两篇关于这个主题的优秀文章：

1.  Joseph Newcomber 的[Hooks 和 DLL](http://www.codeproject.com/KB/DLL/hooks.aspx)
2.  Robert Kuster[将代码注入另一个进程的三种方法](http://www.codeproject.com/KB/threads/winspy.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-09T18:12:40.907

如果消息是发送而不是发布`WH_GETMESSAGE`，则不会看到它。你需要`WH_CALLWNDPROC`. 如果您正在跨进程工作，则需要在 DLL 中使用系统范围的挂钩。你没有提到你是如何调用 SetWindowsHookEx 的，所以我不知道你的钩子失败是因为它不是全局的，还是因为你正在寻找的消息是*发送*的。

如果您以前没有使用过系统范围的钩子，我的网站上有一个系统范围的钩子[示例](http://www.bobmoore.dx.am/Win32/w32tip69.htm)。那是一个键盘钩子，但原理是一样的。

如果我无意中在这里说话，请阻止我-您的问题太短了，我无法推断您的专业水平。但是乱用钩子*确实*意味着一些经验......

# java - Java网络服务；未生成方法

> ID：843712
> 
> 赞同：1
> 
> 时间：2009-05-09T17:32:01.847
> 
> 标签：java, web-services

我有一个简单的网络服务。公开的方法之一返回“数据”类型的 java 对象。这个 Data 类有一个名为“getName()”的方法。我编译项目，在其上运行“wsgen”，然后启动服务（使用 JDK6 的嵌入式 HTTP 服务器，而不是 tomcat 或 glassfish 等）

到目前为止一切顺利，我可以在浏览器中的相应 url 上看到 wsdl。

但是，当我尝试将该 wsdl 导入另一个项目时，导入过程成功创建了“数据”类（这是在服务器项目中找到的一个类），但是没有为该类创建方法，所以我不能做类似“data.getName()”的事情。

我的问题是服务器项目的Data类中存在“getName()”方法，但在客户端项目中，虽然创建了Data类，但wsdl导入没有创建“getName()”方法过程。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-18T19:30:45.277

WSDL 不包含有关方法中逻辑的任何信息，因此您无法为内部对象生成代码。

简单的解决方案是将生成的客户端类替换为您在服务器端使用的相同类，但是这可能被认为是不好的样式。

传递给 WS 的对象应该是没有特殊逻辑的简单数据持有者，您不仅限于原始类型，JAXB 甚至可以处理非常复杂的对象，但是您不能除了将自定义逻辑从服务器复制到客户端这样的行为不能标准化，会造成代码重复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T18:08:22.070

除非客户端和服务器在它们的 CLASSPATH 中都有一个 JAR 文件，让它们都知道“数据”的含义，否则它无法工作。您需要创建一个可以分发的通用 JAR。

将对象放入 Web 服务签名中太脆弱了。非 Java 客户端永远无法使用您；对您的课程的任何更改都会在整个系统中产生影响。

更常见的做法是从合同开始并以 XML 模式、JSON 或 REST 的形式表达它，并让客户端和服务器将这些数据映射到他们认为合适的任何对象中。我建议您的 Web 服务也采用这种方法。

# c++ - 使用 c++ stl 容器和 MFC 容器哪一个？

> ID：843714
> 
> 赞同：3
> 
> 时间：2009-05-09T17:32:42.750
> 
> 标签：c++, visual-c++, mfc, stl, containers

对于每个 stl 容器，在 Visual c++ 中都有一个可用的 MFC 容器。在什么意义上，哪个比另一个更好，你使用什么？

我总是使用 STL 容器是不是错了？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-09T17:34:57.127

由于可移植性，我总是更喜欢 STL 容器。

MFC 容器几乎永远不会在 Linux 上可用。

即使你不打算在 Linux 上使用你的代码……你永远不知道未来会发生什么。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-09T17:56:42.427

人们已经指出代码的可移植性是使用 STL 的一个理由，但还有一个更好的理由，也更符合您的个人利益：技能和经验的可移植性。在我看来，当你去寻找你的下一份工作时，在你的简历上有 STL 的经验会给你更多的机会。为什么？STL 实际上是标准 C++ 的一部分，如果我正在招聘，我会假设知道 STL 的人可以相当快地拿起 MFC 容器，但如果我正在寻找具有 STL 技能的人，我不一定会做出相反的假设。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-09T19:57:50.840

[从来源：](http://www.codeguru.com/forum/archive/index.php/t-391319.html)

“坦率地说，团队会给你同样的答案。MFC 集合类只是为了向后兼容。C++ 有一个集合类标准，那就是标准 C++ 库。使用任何标准库都没有技术缺陷在 MFC 应用程序中。

我们不打算在这方面做出重大改变。

Ronald Laeremans 代理产品部门经理 Vsual C++ 团队“

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-09T19:10:03.717

*如果*您在 MFC 范围内工作，MFC 集合类确实有一些优势。例如，您可以获得序列化（如果您的容器元素继承自 CObject 或类似元素）和一些“免费”的调试支持。MSDN 详细介绍了如何在不同的 MFC 集合类型之间进行选择 [此处]( [http://msdn.microsoft.com/en-us/library/y1z022s1(VS.80).aspx)](http://msdn.microsoft.com/en-us/library/y1z022s1(VS.80).aspx))。

不过，默认情况下，我会倾向于 STL 类。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-09T17:57:07.730

偏爱便携性和自由，而不是私有制。选择 STL 和 Boost (www.boost.org)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-09T17:35:27.360

STL 的。严重地。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-22T04:21:20.663

我使用 STL 容器的原因有很多：它们经过了充分的测试、有据可查，并且为全世界的人们所理解。它们也在不断改进：看看 Boost 添加的所有新功能，它们都是向后兼容的。如果您真的想改变主意，请阅读 Alexandrescu 的 Modern C++ Design: Generic Programming and Design Patterns Applied。使用他的许多技术都需要使用 Boost 和 STL。

其他需要考虑的是**S** TL 是“标准”，但**M** **FC**只是“**微软**”。任何随机的通用 C++ 编码器都可能了解 STL，但只有旧的 Microsoft 编码器会了解 MFC。此外，微软几乎已经放弃了 MFC。

 *** * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-09T18:21:08.890

即使他们向您显示 MFC 容器更快的数字，也可以无异常并制作免费的双份浓缩咖啡：只需闭上眼睛并使用 DEL 键（也称为 NO-LOCK-IN 键）。

你可以做所有这些，而且更便携，并且以道具解决方案只能梦想的可插入方式。一路STL..

# xml - 如何使用 XML 模式验证选择列表

> ID：843715
> 
> 赞同：2
> 
> 时间：2009-05-09T17:32:55.540
> 
> 标签：xml, xsd

我遇到了这个问题，我一辈子都找不到简单的解决方案。

我正在尝试编写一个操作系统列表，其中 XML 文件包含给定人员拥有的操作系​​统列表。有一个固定的操作系统列表（XP、Vista、Win7、OSX 和 Ubuntu）。
我有以下 XML

```
<operatingSystems>
   <operatingSystem name="Windows XP" />
   <operatingSystem name="Windows Vista" />
   <operatingSystem name="Windows 7" />
   <operatingSystem name="OS X" />
   <operatingSystem name="Ubuntu Linux" />
</operatingSystems> 
```

该`<operatingSystems>`元素可以包含 0 个或多个列出的操作系统。

所以有效的例子是：

```
<operatingSystems>
   <operatingSystem name="Windows XP" />
   <operatingSystem name="OS X" />
   <operatingSystem name="Ubuntu Linux" />
</operatingSystems> 
```

或者

```
<operatingSystems /> 
```

我正在尝试编写一个 XSD 架构来验证这一点。我的问题是验证`<operatingSystems>`元素仅包含`<operatingSystem>`名称来自给定集合的子元素并且每个名称元素不出现多次的最佳方法是什么。

无效的例子是：

```
<operatingSystems>
   <operatingSystem name="OS X" />
   <operatingSystem name="OS X" />
   <operatingSystem name="Ubuntu Linux" />
</operatingSystems> 
```

或者

```
<operatingSystems>
   <operatingSystem name="Sun Solaris" />
</operatingSystems> 
```

我试过这个：

```
<element name="operatingSystems">
  <complexType>
    <sequence>
       <element name="operatingSystem" minOccurs="0" maxOccurs="1">
         <complexType>
           <attribute name="name" fixed="Windows XP" />
         </complexType>
       </element>
       <element name="operatingSystem" minOccurs="0" maxOccurs="1">
         <complexType>
           <attribute name="name" fixed="Windows Vista" />
         </complexType>
       </element>
      .......
     </sequence>
   </complexType>
</element> 
```

但它忽略了 minOccurs 为 0 的事实，并且如果缺少任何元素操作系统会抱怨。

任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-09T17:56:27.793

你可以使用`xs:unique`元素：

```
<xs:element name="operatingSystems">
  <xs:complexType>
    <xs:sequence>
      <xs:element ref="operatingSystem" minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
  </xs:complexType>
  <xs:unique name="oneOperatingSystem">
    <xs:selector xpath="operatingSystem"/>
    <xs:field xpath="@name"/>
  </xs:unique>
</xs:element>
<xs:element name="operatingSystem">
  <xs:complexType>
    <xs:attribute name="name" use="required">
      <xs:simpleType>
        <xs:restriction base="xs:token">
          <xs:enumeration value="Windows XP"/>
          <xs:enumeration value="Windows Vista"/>
          <xs:enumeration value="Windows 7"/>
          <xs:enumeration value="OS X"/>
          <xs:enumeration value="Ubuntu Linux"/>
        </xs:restriction>
      </xs:simpleType>
    </xs:attribute>
  </xs:complexType>
</xs:element> 
```

# iphone - 响应者链中的 iPhone 自定义类/对象

> ID：843717
> 
> 赞同：3
> 
> 时间：2009-05-09T17:34:14.477
> 
> 标签：iphone

我正在寻找将自定义类添加到响应者链的策略、最佳实践和解决方案。这是因为我意识到我在几个不同的应用程序中以相同的方式处理触摸事件。为了让生活更轻松，我想将功能移动到自定义类中，并让该类成为触摸事件的第一响应者。由于我最初的几个想法没有奏效，我意识到这不是我可以解决的临时问题。

我根据阅读过的不同文件、帖子等进行了几次尝试（这就是我现在不发布源代码的原因）。我最近的尝试源自 UIResponder 并有一个 UIView 成员，该成员存储指向当前视图的指针。

在我花太多时间“弄清楚”之前，我想看看是否有人有任何想法。

所以我的问题是'如何添加一个自定义类作为第一响应者，特别是接收触摸事件'？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T23:25:42.057

使用 Roger 的建议，我使用的解决方案如下所示：

声明（touchmyself.h）

```
#import <UIKit/UIViewController.h>
@interface UIViewController (TouchMyself)
    - (void) touchesBegan: (NSSet *) touches withEvent: (UIEvent *) event;
    - (void) touchesMoved: (NSSet *) touches withEvent: (UIEvent *) event;
    - (void) touchesEnded: (NSSet*) touches withEvent: (UIEvent*) event;
    - (void) touchesCancelled: (NSSet*)touches withEvent: (UIEvent*) event;
@end 
```

实施（touchmyself.m）

```
#import "touchmyself.h"
@implementation UIViewController (TouchMyself)
- (void) touchesBegan: (NSSet *) touches withEvent: (UIEvent *) event
{
    // Do Stuff
}

...
@end 
```

消费者声明 (some_view_controller.h)

```
@interface ViewSwitchBox : UIViewController 
{
    // Declare Stuff
} 
```

在阅读了一些关于类别的文档后，“iPhone SDK 应用程序开发”第 1.5 章对其进行了透视。

-isdi-

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T21:11:05.440

您的解决方案听起来很奇怪，因为 UIView 本身就是一个 UIResponder。

如果您有通用的事件处理代码，为什么不在 UIView 或 UIResponder 上声明一个类别，然后您将能够从您的所有 UIView（或 UIResponder）子类（包括 UIApplication、UIWindow 和 UIControl）访问它。

# java - 在 iPhone 或 Java 上实现地形破坏，如 Scorched Earth Game

> ID：843718
> 
> 赞同：4
> 
> 时间：2009-05-09T17:34:14.820
> 
> 标签：java, iphone, opengl

我正在寻找一个示例，说明如何实现您在焦土之类的游戏或 iphone [iShoot](http://www.appvee.com/t/ishoot)上看到的 2D 地形破坏。

我正在寻找实现一个需要做可破坏地形并使用 OpenGL（Java 中的 LWJGL）和在 iPhone 上使用 OpenGL ES 渲染它的游戏。

[![替代文字](https://i.stack.imgur.com/M1RSH.png)](https://i.stack.imgur.com/M1RSH.png)
[（来源：[vintagecomputing.com](http://www.vintagecomputing.com/wp-content/images/shareware/scorch_3_large.png)）]

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-09T17:56:48.183

我记得，在 Worms 中，他们使用了两个图像；带有颜色的“漂亮”地形，以及纯黑白的蒙版地形。命中检测总是在掩码上完成。

如果您真的希望地形像坦克大战中那样坍塌，您需要遍历图像的每一列并让它搜索地形和运动场底部之间的间隙。如果检测到任何间隙，请将间隙上方的地形向下移动到列中可能的最低点。

一个简单的例子可以用一个数组来完成，其中 1 代表实心地形，0 代表空白空间。在这种情况下，我将阵列的左侧设置为地面，元素`[0]`将在地面上：

```
[1,1,1,1,1,1,0,0,0,0] 
```

让我们假设从侧面撞击地形并打出一个洞：

```
[1,1,0,0,1,1,0,0,0,0] 
```

现在，您在另一块地形上方留下了一块浮动的地形。要使浮动地形折叠，请遍历数组，跟踪找到 0（空白空间）的第一个位置。然后，随着您继续迭代，在发现 1（地形）时，只需将 1 移到 0 所在的位置。通过从旧的 0 位置 + 1 迭代来重复该过程。

```
[1,1,1,0,0,1,0,0,0,0]

[1,1,1,1,0,0,0,0,0,0] 
```

这是基本方法，不是最有效的方法。例如，同时向下移动间隙上方的*所有*地形索引会快得多。

**编辑：**

正如第一条评论所述，列表上的排序更加容易。我保持我原来的反应不变，因为它有助于解释崩溃地形背后的实际原理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-03T15:27:21.337

苏维特的回答很棒！[我在Scorched Earth for iPhone](http://itunes.com/app/scorch)的破坏性地形特征中使用了类似的算法。我决定忠实于原版并让地形立即稳定，但是当我考虑动画地形稳定时，我遇到了一些性能问题。您也可以在 iShoot 中看到这方面的证据，因为 iShoot 使用缓慢沉降的动画地形。在某些情况下，当下一个玩家开火时，地面仍然从一个玩家的回合开始稳定下来。这可能会干扰射门，并且干扰会根据下一个玩家开火的速度而改变。由于 Scorched Earth 是一款回合制游戏，让游戏等到地面稳定后再切换到下一个玩家似乎是个好主意。

为了渲染地形，我使用 OpenGL 在每个水平屏幕位置绘制了一个具有一对顶点的多边形，如下所示：

```
1 3 5 7 9
0 2 4 6 8 
```

偶数点代表屏幕底部的像素线。奇数点代表地形的垂直像素位置。此信息被复制到一个点数组中，该数组使用 glVertexPointer、glColorPointer 和 glDrawArrays 呈现为三角形条带，如下所示：

```
// prepare vertex buffer
for (int i=0,j,k=0,K=480;k<=K;k++) {
    j = (k-(int)offsetX+480)%480;
    vGroundLevel[i++] = k;
    vGroundLevel[i++] = offsetY>0 ? 0 : offsetY;
    vGroundLevel[i++] = k;
    vGroundLevel[i++] = [env groundLevelAtIndex:j]+offsetY;
}
....
// render vertex buffer
glVertexPointer(2, GL_FLOAT, 0, vGroundLevel);
glEnableClientState(GL_VERTEX_ARRAY);
glColorPointer(4, GL_UNSIGNED_BYTE, 0, cGround);
glEnableClientState(GL_COLOR_ARRAY);
glDrawArrays(GL_TRIANGLE_STRIP, 0, 2*480); 
```

offsetX 和 offsetY 参数允许地形相对于屏幕重新定位，允许玩家交互地在环境中移动，同时将游戏环境保持为环绕的连续体。

# asp.net - 从 ASP.NET 3.5 站点将 PDF 文件推送到 IE

> ID：843730
> 
> 赞同：5
> 
> 时间：2009-05-09T17:45:50.720
> 
> 标签：asp.net, internet-explorer, .net-3.5, pdf

我的应用程序将 PDF 文件推送到弹出式（例如，没有菜单/工具栏）浏览器窗口（响应用户单击按钮）。这适用于除 IE7 之外的所有浏览器。在 IE7 中，我得到的只是一个空白窗口。

这是推出 PDF 的服务器端代码：

```
private void StreamPDFReport(string ReportPath, HttpContext context)
{
    context.Response.Buffer = false;
    context.Response.Clear();
    context.Response.ClearContent();
    context.Response.ClearHeaders();        

    // Set the appropriate ContentType.
    context.Response.ContentType = "application/pdf";
    context.Response.AddHeader("Content-Disposition", "inline; filename=Report.pdf");
    context.Response.Cache.SetCacheability(HttpCacheability.NoCache);        

    // Write the file directly to the HTTP content output stream.
    context.Response.WriteFile(ReportPath);
    HttpContext.Current.ApplicationInstance.CompleteRequest();
    //context.Response.End();
} 
```

在客户端，当用户按下按钮时，onClick 处理程序中会发生以下情况：

onclick="window.open('RptHandler.ashx?RptType=CaseInfo', '报告', 'top=10,left=10,width=1000,height=750')

我错过了一些非常基本的东西吗？为什么它在所有浏览器中都可以使用，但在 IE 中不行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T20:22:31.110

事实证明，以下语句导致 IE 不显示 PDF：

```
context.Response.Cache.SetCacheability(HttpCacheability.NoCache); 
```

不知道为什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T18:24:38.897

对于 IE7，我们发现您需要添加一个额外的标题“内容长度”设置为您发送的 PDF 的大小。就像是：

Response.AddHeader("content-length", *{pdf 的大小}* );

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-12T07:59:07.083

似乎`context.Response.Cache.SetCacheability(HttpCacheability.NoCache);`只有在使用 IIS7 时才有效。

我将其更改为`context.Response.AddHeader("Cache-Control", "no-cache");`，它似乎可以与 IE7 和 IE8 一起使用。

# php - wsdl模式下的php5 soap客户端如何访问与wsdl中指定的不同的svc端点

> ID：843734
> 
> 赞同：2
> 
> 时间：2009-05-09T17:51:06.013
> 
> 标签：php, soap, service, wsdl, client

我是 php5 肥皂的新手...

我需要使用第三方公司提供的 wsdl，出于测试目的，我应该为我需要的服务使用不同的访问地址位置，而不是 wsdl 文档中指定的访问地址位置。

有什么方法可以在 wsdl 模式下创建我的肥皂客户端，并覆盖 wsdl 中指定的地址位置以获得不同的位置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T18:16:45.297

使用可选的第二个参数传递位置，如下所示：

```
$sc = new SoapClient('urlofmywsdl', array('location' => 'urltowebservice')); 
```

# c - 计算数字中的位数

> ID：843737
> 
> 赞同：0
> 
> 时间：2009-05-09T17:52:09.317
> 
> 标签：c, assembly, bit-manipulation, bitmask

### 复制：

> [计算 32 位整数中设置位数的最佳算法？](https://stackoverflow.com/questions/109023/best-algorithm-to-count-the-number-of-set-bits-in-a-32-bit-integer)

* * *

假设你有一个号码。有没有办法计算该数字的二进制表示中等于 1 的位，而不是使用迭代？我的意思是，有没有办法使用一些按位运算符和掩码在恒定时间内做到这一点。我需要适用于 32 位和 64 位架构的解决方案。啊差点忘了，我需要的是C语言或者汇编也不错。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T17:57:37.760

[在http://graphics.stanford.edu/~seander/bithacks.html](http://graphics.stanford.edu/~seander/bithacks.html)有一个没有循环的位计数算法。[http://gurmeetsingh.wordpress.com/2008/08/05/fast-bit-counting-routines/](http://gurmeetsingh.wordpress.com/2008/08/05/fast-bit-counting-routines/)上有很多位计数算法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T18:02:13.613

嗯，当然有，但你不会喜欢它。

当然，您可以构建一个包含所有正确值的查找表：

表[1] = 1，表[2] = 1，表[3] = 2，等等。

所以，这会给你一个**非常快速**的答案，但它本身是一个完全无用的解决方案，因为表必须非常非常大。

你可以稍微优化一下，但它只需要一点迭代。只需创建一个 8 位版本的表解决方案，一个只有 256 个条目的表，然后遍历要检查的值中的每个 BYTE，对表查找的结果求和。就像是：

```
short int tableLookup[256] = { 0, 1, 1, 2, 1, ... };
unsigned int valueToCheck = 89392491;
int result = 0;
while ( valueToCheck != 0 ) {
   result += tableLookup[ (valueToCheck & 0xFF) ];
   valueToCheck >>= 8;
}
// result should now have the correct bit count, if the table is correct. 
```

嗯，这似乎是众所周知的（在这里我是在做这件事）： http: [//graphics.stanford.edu/~seander/bithacks.html#CountBitsSetNaive](http://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetNaive)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T17:57:52.347

是的，您可以使用[查找表](http://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetTable)来做到这一点。

# comparison - 评估数据挖掘工具的行业基准

> ID：843738
> 
> 赞同：1
> 
> 时间：2009-05-09T17:52:36.383
> 
> 标签：comparison, benchmarking, data-mining

我正在为一个项目寻找数据挖掘工具，与此一致，我在 SO 中发布了另一篇文章。我目前正在研究不同的工具，并且想知道是否存在任何行业基准来评估不同的数据挖掘工具，以便我可以参考它来更好地评估工具。

请让我知道是否存在任何此类基准，或者归结为选择适合您需求的工具...

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T21:16:57.473

对于特征/等数据挖掘工具的评估，这些链接怎么样：

*   [领先数据挖掘工具的比较](http://datamininglab.com/pubs/kdd98_elder_abbott_nopics.pdf)(1998) - 过时但信息量很大
*   [客户数据挖掘应用程序魔力象限](http://mediaproducts.gartner.com/reprints/sas/vol5/article3/article3.html)(2008) - 有点非技术性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-10T19:04:50.353

以下是一些标准的测试数据集，用于对准确性性能进行基准测试：

*   UC Irvine - 数据库中的知识发现[(KDD) 数据集存档](http://kdd.ics.uci.edu)

*   UToronto - 在有效实验中评估学习的数据 ( [DELVE](http://www.cs.toronto.edu/~delve) )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-22T21:55:32.310

该站点：[http](http://clopinet.com/challenges/) ://clopinet.com/challenges/包含大量用于机器学习技术的数据集。最好的部分是您还可以将自己的表现与其他人的表现进行比较。

# php - 这是好的会员支付数据库模式吗？

> ID：843748
> 
> 赞同：3
> 
> 时间：2009-05-09T17:57:22.423
> 
> 标签：php, mysql, database, database-design, schema

我正在做一个项目来管理会员资格和其他类型的付款，但主要是会员资格，所以我创建了一个多态模式。任何想法，改进，出于某种原因，我并不完全相信架构。

如您所见，将月、年设为 NULL-ABLE 的想法是允许保存任何其他付款的记录

```
CREATE TABLE IF NOT EXISTS `orders` (
  `id` int(11) NOT NULL auto_increment,
  `partner_id` int(11) NOT NULL,
  `status` enum('pending','accepted','cancelled','other') NOT NULL,
  `created_on` datetime NOT NULL,
  `concept` varchar(250) NOT NULL,
  `type` enum('membership','other') NOT NULL default 'membership',
  `source` enum('dineromail','casati','deposit','other') NOT NULL default 'dineromail',
  `notes` text NULL,
  `last_check_on` datetime default NULL,
  PRIMARY KEY  (`id`)
) ENGINE=MyISAM  ;

CREATE TABLE IF NOT EXISTS `payments` (
  `id` int(11) NOT NULL auto_increment,
  `order_id` int(11) NOT NULL,
  `month` int(11) default NULL,
  `year` int(11) default NULL,
  `amount` float NOT NULL,
  PRIMARY KEY  (`id`),
  UNIQUE KEY `idx-order_id-month-year` (`order_id`,`month`,`year`)
) ENGINE=MyISAM ;

CREATE TABLE IF NOT EXISTS `partners` (
  `id` int(10) unsigned NOT NULL auto_increment,
  `name` varchar(255) default NULL,
  `last_name` varchar(255) default NULL,

) ENGINE=MyISAM; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T18:07:37.220

我还将包括收到付款的日期时间戳，并可能标记付款是否完整或不完整。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-14T23:51:33.983

几个commnets：

1.  在这种情况下，我会考虑将月份设为枚举。它当然可以消除所有歧义，除非您需要在该领域进行数学运算（这是较早的）。

2.  钱应该存储为十进制，而不是浮点数。如果没有，奇怪的四舍五入的东西会慢慢渗入。

3.  没有订单价格的概念。如果他们少付，你怎么知道少了多少？

4.  （与 3 相关）您通常会将其视为发票和付款类型表示（即使您不开具发票），这意味着一笔付款可能代表多个订单，反之亦然，所以这将意味着多对多的关系。

5.  你在乎他们是如何付款的吗？（支票、信用卡、现金等？）

6.  如果一个月只能收到一次，为什么还要进行多次付款的订单？如果在同一个月内收到付款，您会怎么做？这里真的应该只是一对一的关系吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T20:42:43.880

我同意 jtyost2 和 Yishai 之前的回答。

另请注意，我们的约定是以单数形式命名实体表，与类名匹配。也就是说，我们命名一行（我们命名类的一个实例）而不是命名集合。我们要问的问题是，这个表中的一行代表一个什么？我们为类和表使用这个单数名称。（预料到反对意见，是的，我确实认识到其他开发人员和其他框架遵循“表名复数化”的约定。Rails 在复数化方面甚至足够聪明，可以从 Person 类生成“人”表。）

但是当表名开始复数时，我注意到通常只有一些表名是复数的，并且最终是单数和复数名称的混合。

```
`partner_id`
`order_id` 
```

您的外键列的命名方式与我们命名它们的方式完全相同。对于外键列，我们遵循的约定是使用父表的名称，后跟_id。对于同一个表的多个关系，我们使用角色的名称来补充或代替表名。

我还建议在数据库中添加外键约束定义，即使 MyISAM 引擎不强制它们。

在每张表的 ID 列上添加主键约束（表中似乎缺少它`partner`。

使用 unqiue 索引识别自然键。

在我看来，有两种付款模式：

*   每个订单一次全额付款

这是亚马逊似乎使用的模型。订单上可能有优惠券和信用额度，但是当涉及到付款时，我只为该订单支付了一笔款项。

*   向账户余额支付的款项

另一种模式是使用一个账户，并将费用、信用和付款应用到该账户。这是电话公司等公用事业公司常用的模型。这允许诸如当前余额和应付金额之类的概念。

在这方面，您的设计似乎非常规。没有客户帐户的概念。然而，似乎一个订单会有多次付款。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T05:07:55.977

*   同上小数而不是浮点数。
*   订单金额在哪里？你怎么知道他们是否欠钱？
*   添加`payment_date`到`payments`会让你摆脱有`orders.last_check_on`利于视图
*   付款没有识别信息吗？检查#还是什么？重复的条目似乎在这里会成为一个问题......
*   `payments.month`并且`payments.year`看起来很奇怪。如果这是针对会员制的，我假设您只是现收现付。因此，6 次付款可以让您同时获得 6 个月的会员资格 - 从订单日期开始。无需跟踪付款的月份（否则，当我为第 6 个月和第 7 个月付款，而不是 1-5 个月付款时，这意味着什么？）如果这里有一些更复杂的情况，可能需要另外一两张桌子那个概念。

> ...管理会员资格和其他类型付款的项目
> 
> `type`枚举（'会员'，'其他'）
> 
> 拥有月、年 NULL-ABLE 的想法是允许保存任何其他付款的记录

我可能不在此处，但听起来您正在尝试猜测未来的要求。如果是这样的话......不要。没有一种万能的数据库模式——所以不要为了将来可能构建或不构建的应用程序而损害您正在构建的应用程序。

如果您在成员资格之外有具体的用例，请分享它们。但是，我觉得最好使用 2 种不同的型号。`Type`并且可为空的列通常会尖叫您试图将不同的东西硬塞到同一张表中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T05:51:12.497

```
CREATE TABLE [dbo].PaymentLog(  
    TransactionNumber int IDENTITY(1,1) NOT NULL,  
    ReferenceID int NOT NULL,  
    ReferenceType varchar(20) NULL,  
    TransactionID int NULL,  
    CustomerID int NULL,  
    PaymentMethod char(4) NULL,  
    LogType varchar(20) NULL,  
    UserHostAddress varchar(20) NULL,  
    Content nvarchar(4000) NULL,  
    ReasonCode varchar(20) NULL ,  
    Flag nvarchar(20) NULL ,  
    Note nvarchar(200) NULL,  
    [InDate] [datetime] NOT NULL CONSTRAINT DF_PaymentLog_InDate DEFAULT (GETDATE()),    
    [InUser] [nvarchar](100) NULL,  
    CONSTRAINT PK_PaymentLog PRIMARY KEY CLUSTERED (  
        TransactionNumber  
    )   
)
GO

CREATE NONCLUSTERED INDEX [IX_PaymentLog_ReferenceID] ON [dbo].PaymentLog (  
    ReferenceID ASC  
) WITH FILLFACTOR = 90  
GO 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-09T20:49:32.697

此外，我会将源放在不同的表中，因为当应用程序增长时您可能需要添加一些源。

# python - list.append 或 list +=?

> ID：843751
> 
> 赞同：30
> 
> 时间：2009-05-09T17:59:10.173
> 
> 标签：python

哪个更pythonic？

```
list.append(1) 
```

或者

```
list += [1] 
```

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-05-09T18:05:12.890

`list.append(1)`更快，因为它不会创建临时列表对象。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-05-09T18:05:09.397

来自[Python 之禅](http://www.python.org/dev/peps/pep-0020/)：

> 显式优于隐式。

所以：`list.append(1)`

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-09T20:02:44.247

这是两个不同的操作，你用 += 做的是扩展操作。以下是 Python 文档对此的看法：

> list.append(x)：将一个项目添加到列表的末尾；相当于 a[len(a):] = [x]。
> 
> list.extend(L)：通过附加给定列表中的所有项目来扩展列表；等价于 a[len(a):] = L。

因此，在 += 中您提供了一个列表，在追加中您只需添加一个新元素。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-09T19:50:50.157

由于还有

```
list.extend(l) 
```

它附加给定列表的所有元素，我会使用

```
list.append(1) 
```

为了对称和可读性。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-09T23:12:50.920

虽然这里的大多数人更喜欢 append 选项，但我个人更喜欢另一个选项，因为它看起来更好，即使它可能更慢（或者可能是优化的）。

> 美丽总比丑陋好。

当您编写大量 Python 代码时，我通常不会看到这样的内容：

```
list.append(1) 
```

它更像是这样的：

```
somecollectionname.append(anotherelementname+5*10) 
```

所以至少对我来说，看到以下内容会更好：

```
somecollectionname += [anotherelementname+5*10] 
```

因为它很容易一目了然地识别您正在添加到列表中。话虽如此，我有时会发现自己同时使用这两种形式。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-09T23:47:43.720

如果您有一个`a`想要添加到列表中的元素，`l`那么将`a`其放入自己的列表中并`l`随其扩展似乎增加了不必要的复杂性。因此我更喜欢

```
l.append(a) 
```

超过

```
l += [a] 
```

如果`a`已经是一个列表，那么选择

```
l += a 
```

或者

```
l.extend(a) 
```

是一个偏好问题，IMO。另一方面，如果您要进行大量扩展，则可以通过“提升”方法查找来提高性能：

```
extend = l.extend
for sublist in bunch_of_lists:
    extend(sublist) 
```

最后，我认为 append 操作在 Pythonic 代码中并没有经常使用，因为 append 在“累加器”习语中经常使用，我希望更有经验的 Python 程序员使用列表理解/等。

所以而不是：

```
l = []
for a in numbers:
    l.append(str(a)) 
```

你可能会看到：

```
l = [str(a) for a in numbers] 
```

或者

```
l = map(str, numbers) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-09T18:13:40.793

list.append(1) 更具可读性并与上下文一致

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-02-23T14:29:53.283

## 谨防原教旨主义

您是否注意到问题中的“更多pythonic”一词？我认为这意味着您在问一个不太有用的问题。

如果一个只是比另一个*更*Pythonic（而不是 Pythonic 而另一个不是），那么可以说你在元层面上违反了 Python 的禅宗： *“简单胜于复杂”*也应该适用于这个过程寻找表达逻辑的形式——一旦你找到了pythonic的东西，这就足够了。保持搜索简单。

所以我的回答是：他们都不是更pythonic。 **最pythonic的事情是继续写一个漂亮的程序。**

# flash - Flash 中的变音符号

> ID：843752
> 
> 赞同：0
> 
> 时间：2009-05-09T17:59:37.600
> 
> 标签：flash, actionscript-3, diacritics

我的问题可能是一个愚蠢的问题，但我无法帮助自己 - 我创建了一个带有动态插入文本字段的 Flash 电影，它从文件中加载其文本，但我在查看像 ľščťžýáíé 这样的变音符号时遇到问题。我试图改变字体，但它没有帮助。有谁能够帮助我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T15:22:47.787

首先，您必须确保正确嵌入字体，只需在文本字段中输入这些字符即可轻松测试，如果它们出现在导出时，您就可以开始了。

至于阅读文本文件，事情稍微复杂一些，但不是很多。您需要做的是确保您正在阅读的文本文件是 UTF8 格式，任何合理的文本编辑器都应该能够保存它（见鬼，现在甚至记事本也可以）。您可以让 flash 尊重您的本地字符编码，但这很容易出错，并且如果使用不同编码的人查看您的应用程序可能会中断。所以选择 UTF8，flash 可以轻松处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T19:57:51.807

为了使用这些，您需要将它们嵌入到您的应用程序中。最简单的方法是在您的舞台上创建一个新的 TextField，然后在属性面板下，嵌入这些字符（您需要为您使用的特定字体嵌入它们）。只需在视野之外创建您的 TextField，您就可以开始了。

# python - FastCgi 崩溃——想要捕获所有异常但是如何捕获？

> ID：843753
> 
> 赞同：0
> 
> 时间：2009-05-09T18:00:25.210
> 
> 标签：python, django, fastcgi, wsgi, flup

我有一个使用 fastcgi 在 apache 上运行的 django 应用程序（使用 Flup 的 WSGIServer）。

这通过 dispatch.fcgi 进行设置，连接如下：

```
#!/usr/bin/python

import sys, os

sys.path.insert(0, os.path.realpath('/usr/local/django_src/django'))

PROJECT_PATH=os.environ['PROJECT_PATH']

sys.path.insert(0, PROJECT_PATH)

os.chdir(PROJECT_PATH)

os.environ['DJANGO_SETTINGS_MODULE'] = "settings"

from django.core.servers.fastcgi import runfastcgi

runfastcgi(method="threaded",daemonize='false',) 
```

runfastcgi 负责完成这项工作，最终在 WSGIHandler 上运行 WSGIServer。

有时会发生导致 fastcgi 崩溃的异常。

编辑：我不知道什么错误使 fastcgi 崩溃，或者 fastcgi 是否甚至崩溃。我只知道有时网站会宕机——一直宕机——直到我重新启动 apache。error.log 中出现的唯一错误是损坏的管道和不完整的标头，如下所列。

不完整的标题：

注意：我已将敏感信息或杂乱信息替换为“...”

```
[Sat May 09 ...] [error] [client ...] (104)Connection reset by peer: FastCGI: comm with server ".../dispatch.fcgi" aborted: read failed
[Sat May 09 ...] [error] [client ...] FastCGI: incomplete headers (0 bytes) received from server ".../dispatch.fcgi"
[Sat May 09 ...] [error] [client ...] (32)Broken pipe: FastCGI: comm with server ".../dispatch.fcgi" aborted: write failed, 
```

断管：

注意：这恰好是针对 trac 站点而不是 django 应用程序，但它看起来是一样的。

```
Unhandled exception in thread started by <bound method Connection.run of <trac.web._fcgi.Connection object at 0xb53d7c0c>>
Traceback (most recent call last):
  File "/usr/lib/python2.4/site-packages/Trac-0.12dev_r7715-py2.4.egg/trac/web/_fcgi.py", line 654, in run
    self.process_input()
  File "/usr/lib/python2.4/site-packages/Trac-0.12dev_r7715-py2.4.egg/trac/web/_fcgi.py", line 690, in process_input
    self._do_params(rec)
  File "/usr/lib/python2.4/site-packages/Trac-0.12dev_r7715-py2.4.egg/trac/web/_fcgi.py", line 789, in _do_params
    self._start_request(req)
  File "/usr/lib/python2.4/site-packages/Trac-0.12dev_r7715-py2.4.egg/trac/web/_fcgi.py", line 773, in _start_request
    req.run()
  File "/usr/lib/python2.4/site-packages/Trac-0.12dev_r7715-py2.4.egg/trac/web/_fcgi.py", line 582, in run
    self._flush()
  File "/usr/lib/python2.4/site-packages/Trac-0.12dev_r7715-py2.4.egg/trac/web/_fcgi.py", line 589, in _flush
    self.stdout.close()
  File "/usr/lib/python2.4/site-packages/Trac-0.12dev_r7715-py2.4.egg/trac/web/_fcgi.py", line 348, in close
    self._conn.writeRecord(rec)
  File "/usr/lib/python2.4/site-packages/Trac-0.12dev_r7715-py2.4.egg/trac/web/_fcgi.py", line 705, in writeRecord
    rec.write(self._sock)
  File "/usr/lib/python2.4/site-packages/Trac-0.12dev_r7715-py2.4.egg/trac/web/_fcgi.py", line 542, in write
    self._sendall(sock, header)
  File "/usr/lib/python2.4/site-packages/Trac-0.12dev_r7715-py2.4.egg/trac/web/_fcgi.py", line 520, in _sendall
    sent = sock.send(data)
socket.error: (32, 'Broken pipe') 
```

我查看了 /var/log/apache2/error.log，但似乎找不到崩溃的原因。我有时会遇到内存交换问题，但我认为这是不同的。（请原谅我的无知。我愿意学习如何更好地实现和调试服务器管理的东西。）

我想用 try/except 包装 runfastcgi。处理随机异常的最佳方法是什么（直到我找出实际原因）？

我相信 WSGIServer 处理许多请求。如果我发现异常，我可以重新调用 runfastcgi 而不必担心无限循环吗？我应该为有问题的异常调用请求返回一个错误 HttpRequest 吗？我什至不知道该怎么做。

我一直在查看 django/core/servers/fastcgi.py 和 django/core/handlers/wsgi.py 和 django/http/ **init** .py

我无法在理解 Flup 方面取得进展。

有我可以学习的想法或经验吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T18:37:04.980

这可能是一个 Flup[错误](http://trac.saddi.com/flup/ticket/18)。当基于 Flup 的服务器的客户端连接在 Flup 完成发送数据之前关闭时，它会引发 socket.error: (32, 'Broken pipe') 异常。

试图通过 runfastcgi 周围的 try catch 来捕获异常是行不通的。仅仅因为异常是由线程引发的。

好的，我将解释为什么将您自己的代码包装在 try catch 中不起作用。如果您仔细查看异常回溯，您会发现跟踪中的第一条语句不是 runfastcgi。那是因为异常发生在不同的线程中。如果要捕获异常，则需要将跟踪列出的任何语句包装在 try/catch 中，如下所示：

```
# in file /usr/lib/python2.4/site-packages/Trac-0.12dev_r7715-py2.4.egg/trac/web/_fcgi.py", line 654, in run
try:
    self.process_input()
except socket.error:
    # ignore or print an error
    pass 
```

关键是，您可以通过修改 Flup 的代码来捕获错误。但我看不出这有什么好处。特别是因为这个异常似乎是无害的，并且已经有一个补丁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T21:36:13.723

*破损的管道*通常不是确定性的。如果对管道或套接字的写操作由于另一端已关闭连接而失败，您将得到一个*Broken pipe 。*所以如果你的 FastCGI 得到一个*Broken pipe*，这意味着网络服务器过早地关闭连接。在某些情况下，这不是问题，可以默默地忽略它。

作为一个快速破解，尝试捕捉并忽略`socket.error`with `Broken pipe`。您可能需要在`except:`更多地方添加一个子句。

# user-interface - 用户生成和修改内容的版本比较

> ID：843758
> 
> 赞同：1
> 
> 时间：2009-05-09T18:02:55.063
> 
> 标签：user-interface, comparison, wiki-engine, user-generated-content

我正在做一个构建在线协作工具的项目。查看 Wikipedia，我注意到用户生成**的页面迭代可以很容易地相互比较**；比较突出了差异。

**从概念上讲，我需要实现什么来做几乎完全相同的事情？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T11:00:28.130

*综合良好的建议：*

**最简单的方法是使用任何现有的 wiki 引擎。有*很多*好的 wiki 引擎。不要重新发明轮子。**

例如，StackOverflow 本身就是一个自定义构建的 wiki。查看 Stack Overflow 上的编辑查看器，了解其功能与问题中描述的功能的匹配程度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T22:31:04.670

您将需要一个*版本化的数据存储*和一个*差异算法。*

通过为每个资源提供修订号来存储资源的版本。当用户编辑资源而不是替换资源时，将编辑保存为数据存储中的新条目，并使用新的更高修订号。当您要检索资源时，返回具有最高修订版本的资源。

您可以使用时间戳来代替修订号。不仅时间戳总是增加，而且修订号本身也可用于识别资源何时被修改。

根据您存储资源的方式选择差异算法。Wikitext 通常是逐行的，所以如果用户正在编辑它，使用像标准 Unix`diff`实用程序这样的逐行差异是有意义的。如果资源是 XML，您可能希望找到一种特定于 XML 的差异算法，以便用户清楚地知道差异在哪里。

# php - 如何确定是否已安装和设置 Web 应用程序？

> ID：843763
> 
> 赞同：2
> 
> 时间：2009-05-09T18:05:21.640
> 
> 标签：php, zend-framework, installation

我不确定我的问题是否足够......好吧，我正在使用 Zend 框架在 PHP 中开发一个 CMS。我想有一个很好的 web gui 来安装和设置应用程序，然后在某个地方解压......一些 CMS 或任何应用程序，只需输入一个“安装 url”，如“ [http:// ”，就可以提供这种方式本地主机/应用程序/安装](http://localhost/app/install)'

我也想做同样的事情，但我不想让任何用户设置它，所以我正在寻找一种方法来确定应用程序是否已设置。

受到 unix 世界中 pid 文件的启发，我想对 InstallState 文件做同样的事情。在里面写任何布尔值然后检查可能是一个想法..

你怎么看？你有更好的主意吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T18:23:05.093

虽然我赞成 Sam152 的回答，但我觉得有必要进一步澄清（只是不适合评论）。我在这些情况下使用的做法如下：

1.  让用户运行安装程序。
2.  成功完成后，生成某种形式的锁定文件（许多应用程序只是创建一个“installer.lock”文件，其中没有任何内容）。该文件的存在**应该会阻止用户** **再次运行*****安装程序*** 。
***   阻止执行主脚本（即使在成功安装后），直到从服务器中删除**整个安装目录。****

 **这提供了两个层面的保障。它可以防止安装程序再次运行（这对您的应用程序可能是也可能不是问题），并且它会阻止产品运行。您可以使用锁定文件的存在来告诉用户他们已经成功完成了安装，他们不需要再次安装，并且他们应该删除该目录。

简单、安全、分类。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T18:12:05.853

您可以在某处写入数据库的值，或者在安装完成后简单地让文件自行删除。许多软件要求用户在完成后删除 /install 文件。要强制执行此操作，您可以检查安装目录是否存在并让管理员在脚本的其余部分运行之前将其删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T18:12:33.980

目前，许多 Web 应用程序在某处都有一个类似配置的文件，它们存储数据库登录信息等内容。在新安装的应用程序上，代码可能会检查配置文件或其中的一些变量是否存在，如果不存在，则重定向到安装脚本。

如果存在配置文件，则相同的脚本稍后可能会拒绝工作。此外，通常的做法是告诉用户在设置后删除安装脚本/文件夹。如果文件存在，有些人甚至会通过根本不工作来强制删除。

还有其他方法可以做你想做的事，但我发现这是开源网络应用程序中最常见的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T16:36:11.457

以 Drupal 的安装脚本为例...

```
if ( ! config_file_exists()) {
    tell_user_to_write_config_file();
} elseif ( ! can_connect_to_db()) {
    tell_user_to_fix_config_file();
} elseif ( ! check_db_if_installed() ) {
    do_install_stuff();
} else {
    tell_user_system_installed()
} 
```

显然，魔法发生在`do_install_stuff()`Drupal 的情况下，它检查设置表 ( `variable`) 中是否存在名为`install_task`. 只要这是您进行初始系统安装时写的最后一件事，您就可以开始了。

# many-to-many - 联结表（join table）也可以用于一对多关系吗？

> ID：843772
> 
> 赞同：11
> 
> 时间：2009-05-09T18:09:05.783
> 
> 标签：many-to-many, database, one-to-many, junction-table

**根据定义，[Junction Table](http://en.wikipedia.org/wiki/Junction_table)（桥表/链接表）用于多对多关系，使用时如下：**

```
CREATE TABLE Users
(
UserLogin varchar(50) PRIMARY KEY,
UserPassword varchar(50) NOT NULL,
UserName varchar(50) NOT NULL
)

CREATE TABLE Permissions
(
PermissionKey varchar(50) PRIMARY KEY,
PermissionDescription varchar(500) NOT NULL
)

--This is the junction table.
CREATE TABLE UserPermissions
(
UserLogin varchar(50) REFERENCES Users (UserLogin),
PermissionKey varchar(50) REFERENCES Permissions (PermissionKey),
PRIMARY KEY (UserLogin, PermissionKey)
) 
```

***但是它不能也像在这个例子中一样容易地用于一对多关系，在这个例子中，一个用户与许多订单相关联：***

**（我不太了解数据库，所以如果我误解了什么，请纠正我。）**

```
CREATE TABLE Users
(
UserLogin varchar(50) PRIMARY KEY,
UserPassword varchar(50) NOT NULL,
UserName varchar(50) NOT NULL
)

CREATE TABLE Orders
(
OrderKey varchar(50) PRIMARY KEY,
OrderDescription varchar(500) NOT NULL
)

--This is the junction table.
CREATE TABLE UserOrders
(
UserLogin varchar(50) REFERENCES Users (UserLogin),
OrderKey varchar(50) REFERENCES Orders (OrderKey),
PRIMARY KEY (UserLogin, OrderKey)
) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-09T18:15:07.437

没有任何理由*不能*将连接表用于一对多关系。问题通常是性能之一。为什么在不需要时让数据库加入一个额外的表？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-09T18:16:34.000

是的，仍然可以在联结表中存储和强制执行一对多关系。

在您的示例中，您没有对`UserOrders`联结表实施任何约束，因此单个订单可以属于两个用户（假设这是不正确的）。为了强制您可以成为联结表`OrderKey`的主键`UserOrders`（或对该列具有唯一约束）。从技术上讲，这将成为and之间*的多对一*关系，而and之间具有*一对一的*关系。`UserOrders``Users`*`Orders``UserOrders`*

 *我只能考虑使用联结表设计*多对一*关系的一个原因 - 如果您计划将来允许*多对多*关系并且不想处理数据迁移。但与此同时，您将支付存储和加入附加表的成本。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-01-28T06:22:28.253

这将是多对多的：

```
CREATE TABLE UserOrders
(UserLogin varchar(50) REFERENCES Users (UserLogin),
OrderKey varchar(50) REFERENCES Orders (OrderKey),
PRIMARY KEY (UserLogin, OrderKey)); 
```

这将是一对多的（一个用户有很多订单）：

```
CREATE TABLE UserOrders
(UserLogin varchar(50) REFERENCES Users (UserLogin),
OrderKey varchar(50) REFERENCES Orders (OrderKey),
PRIMARY KEY (OrderKey)); 
```

注意 PRIMARY KEY 约束的区别。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-09T19:37:11.717

一旦你建立了一个表，它就没有“Junction”表、“associative”表、“join”表——它只是一个表。

我们使用这些术语来描述最初创建实体（和结果表）的特定原因。最初创建关联实体是为了解决多对多的情况。但是这些表通常都有自己的属性（例如关联的时间、关联的原因等）。所以 SQL Server、Oracle 或您的代码没有理由知道为什么要创建一个表……只是它是一个表。

从技术角度来看，关联表和任何其他表之间确实没有任何区别。

因此，这些表可以充当任何其他表可以履行的任何角色。没有关于其他表如何与它们关联的规则。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-30T12:06:01.833

您可以在连接/连接表中强制执行“一个”约束，将唯一约束（或使其成为连接表的主键，因为只是该属性本身标识关系）到作为“多”的一面。那是因为您希望多方中的 rwos 只有一个关系，并且关系在联接/联结表中说明。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-23T14:53:11.597

我认为您的概念错了-如果有帮助，这是简单的解释： ***要在两个表（例如，A 和 B）之间实现多对多关系，我们需要借助联结表（例如，表c) 这将与表 A 和 B 都具有一对多的关系。***

# php - 在 WordPress 中调试“register_activation_hook”

> ID：843774
> 
> 赞同：1
> 
> 时间：2009-05-09T18:11:57.880
> 
> 标签：php, sql, wordpress

在我在 Twitter 上询问人们什么是有用的之后，我正在尝试通过为自己设定一个目标来编写一个 WordPress 插件，即编写一个用户生成的词汇表插件（好吧，我不妨利用我的学习经验来不仅仅是有用的）我）。

无论如何，在安装插件时，它会设置一个数据库表，并向其中添加一些测试数据。然后，当显示内容时，foreach 循环会更改每个短语并将其替换为 DHTML 浮动框。

但是，问题是，我无法弄清楚 ; 发生了什么`register_activation_hook`。它可能被调用并且 SQL 失败或者它可能没有被调用（无论哪种方式，我激活插件后数据库中都没有额外的表）。

钩子看起来像这样：

```
register_activation_hook(__FILE__, "bot_install"); 
```

像这样的 bot_install 代码

```
function bot_install()
{
    global $wpdb;
    $table = $wpdb->prefix."sh_gloss";

    $structure = "CREATE TABLE $table (
        id INT(9) NOT NULL AUTO_INCREMENT,
        phrase VARCHAR(80) NOT NULL,
        desc VARCHAR(255) NOT NULL,
    UNIQUE KEY id (id)
    );";
    $wpdb->query($structure);

    // Populate table
    $wpdb->query("INSERT INTO $table(phrase, desc)
        VALUES('Scott Herbert', 'Rockstar Programmer')");

} 
```

好的，所以首先请原谅自我数据库条目，它只是为了测试......

其次，有什么我应该看到但我错过的东西吗？第三（也是最重要的）如何调试“bot_install”？我可以添加如下语句：

```
echo "in xxxx"; 
```

还是会弄乱标题（因为我猜所有这些代码都是在主输出之前运行的）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-04T11:01:47.260

要回答你的第三个（也是“最重要的”！）问题，很晚。

要调试激活错误，请在`activated_plugin`钩子上添加一个操作，将输出缓冲区（将包含您的错误）写入文件，然后检查它。

您可能还想[在配置文件中打开调试](https://codex.wordpress.org/Debugging_in_WordPress)，这样您就可以在文件中获得更多信息。

```
function save_output_buffer_to_file()
{
    file_put_contents(
      ABSPATH. 'wp-content/plugins/activation_output_buffer.html'
    , ob_get_contents()
    );
}
add_action('activated_plugin','save_output_buffer_to_file'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T18:52:14.493

我对 WordPress 一无所知，但是......由于代码中没有错误处理，你怎么知道这`$wpdb`是一个有效的数据库连接句柄，以及代码如何检测到某些东西不起作用 - 例如，CREATE TABLE声明失败？代码显然盲目地（愉快地）假设没有任何事情可以或不会出错，但我的经验是事情可以而且确实会出错。

* * *

我仍然不是专家，但引用的[URL](http://codex.wordpress.org/Function_Reference/wpdb_Class)说：

> ### 在数据库上运行任何查询
> 
> 查询功能允许您对 WordPress 数据库执行任何 SQL 查询。但是，对于 SELECT 查询，最好使用更具体的函数（见下文）。

```
<?php $wpdb->query('query'); ?> 
```

> 询问
> 
> （字符串）您希望执行的 SQL 查询。
> 
> 该函数返回一个与受影响/选择的行数相对应的整数。如果存在 MySQL 错误，该函数将返回 FALSE。（注意：由于 0 和 FALSE 都可以返回，因此请确保使用正确的比较运算符：相等 == 与相同性 ===）。
> 
> [...]
> 
> 例子
> 
> 从 Post 13 中删除 'gargle' 元键和值。
> 
> ```
>  $wpdb->query("
>        DELETE FROM $wpdb->postmeta WHERE post_id = '13'
>              AND meta_key = 'gargle'"); 
> ```

因此，据推测，如果 CREATE TABLE 操作失败，您会从中得到 FALSE，您可以使用适当的操作员对其进行测试——我不确定它是哪一个。

再往下，关于错误的主题，页面说：

> ### 显示和隐藏 SQL 错误
> 
> 您可以分别使用 show_errors 和 hide_errors 打开和关闭错误回显。

```
<?php $wpdb->show_errors(); ?>
<?php $wpdb->hide_errors(); ?> 
```

> 您还可以使用 print_error 打印最近查询生成的错误（如果有）。

```
<?php $wpdb->print_error(); ?> 
```

最后，对于开发初期的调试来说，只要能看到信息，响应是否乱码也无所谓。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T04:49:06.483

不久前我不得不处理这个问题。register_activation_hook 有一些棘手的问题，由于某种原因，运行查询对我不起作用，请使用 dbDelta 函数。

```
function bot_install()
{
    global $wpdb;
    $table = $wpdb->prefix."sh_gloss";

    require_once(ABSPATH . 'wp-admin/includes/upgrade.php');

    $structure = "CREATE TABLE $table (
        id INT(9) NOT NULL AUTO_INCREMENT,
        phrase VARCHAR(80) NOT NULL,
        desc VARCHAR(255) NOT NULL,
        UNIQUE KEY id (id));";

    dbDelta($structure);

    // Populate table
    $wpdb->query("INSERT INTO $table(phrase, desc)
        VALUES('Scott Herbert', 'Rockstar Programmer')");

} 
```

如果这不起作用，请告诉我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-17T15:27:28.380

嗯，有一些叫做 PHP 错误日志的东西，所以，如果你想在 WordPress (PHP) 中调试一些东西，你可以调用

```
error_log(ob_get_contents(), 3, plugin_dir_path(__FILE__) . 'errors'); 
```

在这一行中，您将在插件目录中创建一个名为 error 的文件。

[PHP 错误日志手册](https://www.php.net/manual/en/function.error-log.php)

编辑：有时这种方法是一个更好的解决方案，因为 PHP 总是有权写下文件，这在`file_put_contents`

# tfs - 为什么我可以在 TFS 2008 中将任务分配给 LOCAL SERVICE？

> ID：843779
> 
> 赞同：0
> 
> 时间：2009-05-09T18:12:50.920
> 
> 标签：tfs

我不是 100% 肯定它并不总是这样，我从来没有注意到......但我很确定这是新的，并且在某个地方搞砸了。

我能够在 TFS 2008（工作组版）中将工作项分配给名为 LOCAL SERVICE 的用户（参见屏幕截图）。这似乎是错误的，但我不知道如何解决这个问题。

这不是世界末日，但它困扰着我。

提前感谢您的帮助。

![TFS - 本地服务用户](https://i.stack.imgur.com/ANOgW.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T04:06:10.527

默认情况下，分配给列表来自名为“贡献者”的团队项目组的成员。如果您右键单击 Team Project，选择 Team Project Settings，然后选择 Group Membership，并检查 Contributors 组的成员。如果在其中看不到它，请尝试使用 TFSSecurity.exe：

```
C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE>tfssecurity /imx
n:"[TeamProjectName]\Contributors" /server:ServerNameOrUrl 
```

问候，

William D. Bartholomew（团队系统 MVP）

# sqlite - 在 SQLite 中存储布尔值

> ID：843780
> 
> 赞同：333
> 
> 时间：2009-05-09T18:13:12.230
> 
> 标签：sqlite

SQLite 中 BOOL 值的类型是什么？我想在我的表中存储 TRUE/FALSE 值。

我可以创建一个 INTEGER 列并在其中存储值 0 或 1，但这不是实现 BOOL 类型的最佳方式。

有办法吗？

* * *

## 回答 #1

> 赞同：411
> 
> 时间：2009-05-09T18:15:38.637

SQLite 没有本机布尔数据类型。根据[数据类型文档](http://www.sqlite.org/datatype3.html)：

> SQLite 没有单独的布尔存储类。相反，布尔值存储为整数 0（假）和 1（真）。

* * *

## 回答 #2

> 赞同：127
> 
> 时间：2014-03-05T00:49:19.483

在 SQLite 中，您可以做的最好的事情是使用整数 0 和 1 来表示 false 和 true。您可以像这样声明列类型：

```
CREATE TABLE foo(mycolumn BOOLEAN NOT NULL CHECK (mycolumn IN (0, 1))); 
```

除了 0 和 1 之外，`NOT NULL`如果要允许，则省略。`NULL`

此处使用类型名称`BOOLEAN`是为了便于阅读，对于 SQLite 来说，它只是一个[具有 NUMERIC 亲和力](http://www.sqlite.org/datatype3.html#affname)的类型。

请注意，自[SQLite 3.3.0](http://www.sqlite.org/releaselog/3_3_0.html) (2006)起就支持[CHECK 约束。](http://www.sqlite.org/lang_createtable.html#ckconst)

以下是一些可以使用的示例 INSERT：（注意字符串和浮点数如何被解析为整数）

```
sqlite> INSERT INTO foo VALUES(0);
sqlite> INSERT INTO foo VALUES(1);
sqlite> INSERT INTO foo VALUES(0.0);
sqlite> INSERT INTO foo VALUES(1.0);
sqlite> INSERT INTO foo VALUES("0.0");
sqlite> INSERT INTO foo VALUES("1.0");
sqlite> select mycolumn, typeof(mycolumn) from foo;
0|integer
1|integer
0|integer
1|integer
0|integer
1|integer 
```

还有一些会失败：

```
sqlite> INSERT INTO foo VALUES("-1");
Error: constraint failed
sqlite> INSERT INTO foo VALUES(0.24);
Error: constraint failed
sqlite> INSERT INTO foo VALUES(100);
Error: constraint failed
sqlite> INSERT INTO foo VALUES(NULL);
Error: foo.mycolumn may not be NULL
sqlite> INSERT INTO foo VALUES("true");
Error: constraint failed
sqlite> INSERT INTO foo VALUES("false");
Error: constraint failed 
```

* * *

## 回答 #3

> 赞同：93
> 
> 时间：2012-01-31T07:37:47.280

SQLite[布尔数据类型：](http://www.sqlite.org/datatype3.html)
SQLite 没有单独的布尔存储类。相反，布尔值存储为整数 0（假）和 1（真）。

您可以通过这种方式将 boolean 转换为 int：

```
int flag = (boolValue)? 1 : 0; 
```

您可以将 int 转换回布尔值，如下所示：

```
 // Select COLUMN_NAME  values from db. 
 // This will be integer value, you can convert this int value back to Boolean as follows
Boolean flag2 = (intValue == 1)? true : false; 
```

如果你想探索 sqlite，[这里有一个教程](http://zetcode.com/databases/sqlitetutorial/)。
我在[这里](https://stackoverflow.com/questions/9074865/set-flag-in-sqlite-database-in-android/9075127#9075127)给出了一个答案。它正在为他们工作。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-02-27T04:16:36.303

使用值为 0 和 1 的整数数据类型是最快的。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-10-07T22:32:24.583

进一步了解埃里克瓦的回答。CHECK 约束可以通过强制 TEXT 数据类型启用伪布尔列，并且只允许 TRUE 或 FALSE 特定值，例如

```
CREATE TABLE IF NOT EXISTS "boolean_test"
(
    "id" INTEGER PRIMARY KEY AUTOINCREMENT
,   "boolean" TEXT NOT NULL 
        CHECK( typeof("boolean") = "text" AND
               "boolean" IN ("TRUE","FALSE")
        )
);

INSERT INTO "boolean_test" ("boolean") VALUES ("TRUE");
INSERT INTO "boolean_test" ("boolean") VALUES ("FALSE");
INSERT INTO "boolean_test" ("boolean") VALUES ("TEST");

Error: CHECK constraint failed: boolean_test

INSERT INTO "boolean_test" ("boolean") VALUES ("true");

Error: CHECK constraint failed: boolean_test

INSERT INTO "boolean_test" ("boolean") VALUES ("false");

Error: CHECK constraint failed: boolean_test

INSERT INTO "boolean_test" ("boolean") VALUES (1);

Error: CHECK constraint failed: boolean_test

select * from boolean_test;

id  boolean
1   TRUE
2   FALSE 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-02-18T02:35:30.777

但是，如果你想存储一堆它们，你可以对它们进行位移并将它们全部存储为一个 int，有点像 unix 文件权限/模式。

例如，对于模式 755，每个数字代表不同的用户类别：所有者、组、公共。在每个数字内，读取 4，写入 2，执行 1，因此 7 都是二进制 111。读取并执行 5，因此 101。制定自己的编码方案。

我只是在写一些东西来存储来自 Schedules Direct 的电视节目表数据，并且我有二进制或是/否字段：立体声、高清电视、新的、ei、隐藏式字幕、杜比、西班牙语的 sap、季节首映。所以 7 位，或者一个最大为 127 的整数。真的是一个字符。

我现在正在研究的 AC 示例。has() 是一个函数，如果第二个字符串在第一个字符串中，则返回 1。inp 是此函数的输入字符串。misc 是一个初始化为 0 的无符号字符。

```
if (has(inp,"sap='Spanish'") > 0)
  misc += 1;
if (has(inp,"stereo='true'") > 0)
  misc +=2;
if (has(inp,"ei='true'") > 0)
  misc +=4;
if (has(inp,"closeCaptioned='true'") > 0)
  misc += 8;
if (has(inp,"dolby=") > 0)
  misc += 16;
if (has(inp,"new='true'") > 0)
  misc += 32;
if (has(inp,"premier_finale='") > 0)
  misc += 64;
if (has(inp,"hdtv='true'") > 0)
  misc += 128; 
```

所以我将 7 个布尔值存储在一个整数中，还有更多空间。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-08-18T19:00:18.993

您可以使用以下公式简化上述方程：

```
boolean flag = sqlInt != 0; 
```

如果 boolean 的 int 表示（sqlInt）为 0（false），则 boolean（flag）为 false，否则为 true。

简洁的代码总是更好用:)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-01-21T17:04:32.340

带有 SQLAlchemy 的 Flask 具有布尔值。

[https://overiq.com/flask-101/database-modelling-in-flask/](https://overiq.com/flask-101/database-modelling-in-flask/)

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2014-01-07T06:40:45.927

另一种方法是使用 TEXT 列。然后在从数据库中保存/读取值之前/之后在布尔值和字符串之间转换布尔值。

前任。你有`"boolValue = true;`“

到字符串：

```
//convert to the string "TRUE"
string StringValue = boolValue.ToString; 
```

并返回布尔值：

```
//convert the string back to boolean
bool Boolvalue = Convert.ToBoolean(StringValue); 
```

# vb.net - DateGrid 视图 - 作为和未绑定控件

> ID：843787
> 
> 赞同：1
> 
> 时间：2009-05-09T18:15:55.827
> 
> 标签：vb.net, winforms, datagridview, controls

尝试使用像旧的 VB6 FlexGrid 这样的 DataGridView，并通过 addrow 手动添加列（构建了一个包含 TextCells 的行）并且我的列都已添加（并显示正常）但是一旦我尝试添加一行，我就会收到消息“当控件绑定数据时，不能以编程方式将行添加到 DataGridView 的行集合中。” 但是为了爱，上帝我能看到一种将其设置为未绑定控件的方法（我没有将数据源设置为任何东西）

所以真的有两个问题，

1.  有更好的控制使用吗？
2.  有没有办法将 DataGridView 设置为未绑定控件

最后的第三个问题

3.  你如何手动添加行？

我如何做到这一点的片段

提前致谢

```
 Dim lRow As New DataGridViewRow

                    Dim lCell As New DataGridViewTextBoxCell
                    lCell.Value = "Cell 1"
                    lRow.Cells.Add(lCell)

                    lCell = DataGridViewTextBoxCell
                    lCell.Value = "Cell 2"
                    lRow.Cells.Add(lCell)

                    DataGridView1.Rows.Add(lRow) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T18:55:06.890

## 有没有更好的控件可以使用？

有点主观，但我会说不。DataGridview 将为您提供构建网格状结构的最大灵活性。它非常灵活，几乎可以肯定适合您的场景

## 有没有办法将 DataGridView 设置为未绑定控件

是的。确保 DataSource 属性设置为 Nothing。这将强制它进入非绑定模式。只要您将此属性设置为任何内容，它将成为绑定控件

```
DataGridView1.DataSource = Nothing ' force unbound 
```

## 如何手动添加一行？

正如你所做的那样。一旦它解除绑定，这将起作用。

# javascript - 使用来自 Processing-JS 的 JSON

> ID：843792
> 
> 赞同：3
> 
> 时间：2009-05-09T18:17:21.283
> 
> 标签：javascript, ajax, json, processing

我想使用[processing-JS](http://processingjs.org)编写一个应用程序，并且我希望能够使用服务器端数据加载它。我还没有编写服务器端，所以我可以使用任何东西，但显然 AJAX 的事情是使用 JSON 将数据上传到页面中。

如何从我的处理代码中访问该数据？它是像数据在范围内一样简单，还是可以附加到窗口对象并直接从处理代码访问？

**更新**：让我稍微完善一下这个问题。我对 JSON（但感谢链接）以及为客户端和服务器编写代码感到满意；我真正的问题（诚然可能有点傻）是：如果我使用例如 JQuery 获取数据，并想在 processing-js 中操作它，它是否在同一个命名空间中？我必须做任何特别的事情才能访问它吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-11-02T22:07:50.393

您的处理代码被“草率地”解析并转换为 JavaScript。解析器不理解的任何内容都会被忽略，这意味着您可以在处理中自由地混合一些 JavaScript 代码，并且通常“正常工作”。

在这里查看更多信息： http: [//processingjs.org/reference/articles/best-pratice](http://processingjs.org/reference/articles/best-pratice)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T19:04:36.773

您可以像[这样使用](http://docs.jquery.com/Ajax/jQuery.getJSON#urldatacallback)[jQuery](http://jquery.com/)从您的服务器获取 JSON 结果并迭代它们以执行任何操作。我确信同时使用 processing-JS 和 jQuery 不会有问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T20:10:12.277

我认为你应该访问[www.json.org](http://www.json.org)
那里它解释了如何在 web 应用程序中同时使用服务器端和客户端的 json。
实际上应该有许多服务器端的库实现，您可以将它们包含在您的 Web 应用程序中，以将您的平台对象转换为 json 对象。
肯定有一个实现将 java 对象转换为 JSON 对象。要解释客户端数据，我认为您可以使用另一个应该位于同一网站上的库。唯一的问题是我不知道你是否可以使用 javascript 脚本来处理 javascript 以使用 javascript 对象

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-22T18:36:47.650

拍摄，我希望这里会有更好的答案。这是 processing.js 网站上的[教程](http://processingjs.org/reference/articles/PomaxGuide#json)。他们所做的只是使用 javascript 处理 JSON 并使用它来调用处理代码中的函数。

显然你不想只传递 JSON。但是，您可以传入 XML，尽管不支持 XPath，因此如果您想从中获得任何东西，就必须抽出 for 循环。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-01T11:05:23.777

要将数据从 JQuery/Javascript 传递到 Processing.js，您调用全局范围函数 Processing.getInstanceById，它为您提供对 Processing PApplet 对象的引用（嗯，javascript 等价物）：

```
// get a reference to the Processing PApplet object:
var proc = Processing.getInstanceById("the_id_of_your_canvas"); 
```

然后您可以调用处理草图中可用的任何函数，例如：

```
// call any function that is defined inside the Processing sketch
// in this case, one of the built in ones:
proc.frameRate(4); 
```

所以你用 Javascript/JQuery 编写你的 JSON 解析代码，然后可以将数据传递给这样的处理函数。

# html - 用于比较两个图像的可降解 HTML 布局

> ID：843801
> 
> 赞同：1
> 
> 时间：2009-05-09T18:24:47.960
> 
> 标签：html, css, image, comparison

如何创建用于比较两个图像的网页，最好只使用 (X)HTML 和 CSS，而不使用 JavaScript 和 DHTML / AJAX？

最简单的解决方案是将两个图像并排放置在一起，或者接触或几乎接触并居中，或者每个都居中在它自己的一半页面中。稳健解决方案的问题在于**可降解**部分。

*   有问题的两个图像不需要具有相同的大小，例如一个可以调整另一个图像的大小版本；一个问题是是否使用 HTML 属性将它们缩放到相同的视觉大小，以及是否将两个图像居中或将它们对齐到页面的中心（如果它们的宽度不相等）：

    ```
    |_______|_______|
    |___[xx][xxxx]___| 
    ```

    （整体居中）vs

    ```
    |_______|_______|
    |____[xx][xxxx]__| 
    ```

    （对齐到页面中心）

*   图像可能比页面的一半宽；我宁愿避免水平滚动，所以也许在这种情况下，图像而不是并排将是一个在另一个之上，这应该是自动的，而不使用 JavaScript 来比较图像的宽度与浏览器窗口的宽度并更改布局苍蝇。

    在这种情况下，布局应该如下所示：

    ```
    |____[xxxxxxx]___|
    |_____[xxxxx]____| 
    ```

这样做的*目标*是有一种方法可以在版本控制系统的 Web 界面中比较图像。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T18:28:10.230

我不希望它们在版本控制差异系统中缩放到相同的视觉大小，但您可以使用：

```
<img width='x' height='y'> 
```

这样做（或者只是指定`width`是否希望每个图像保持其纵横比）。

当它们不水平放置时，要使一个低于另一个，只需将其中一个浮动到左侧：

```
<html><body><p align='center'>
<img src='http://stackoverflow.com/content/img/so/logo.png' float='left'>
<img src='http://stackoverflow.com/content/img/so/logo.png'>
</p></body></html> 
```

（纯粹主义者不会喜欢`align='center'`等等——请想象我已经使用 CSS 8 正确地做到了这一点——）

# firefox - 如何从 Firefox 扩展向网页添加元素

> ID：843802
> 
> 赞同：0
> 
> 时间：2009-05-09T18:24:57.477
> 
> 标签：firefox, elements, gecko, xpi

我将开发一个 Firefox 扩展，当`<input type="file" ... >`找到标签并选择一个文件时，它应该在加载的页面中放置一个按钮。

同样，我认为 Skype 工具栏做了类似的事情：当网站包含电话号码时，Skype 扩展程序会自动将其转换为可以单击以呼叫 Skype 联系人的按钮。

我在 GNU/Linux 系统上，不幸的是，Skype 扩展在 Linux 版本的 Firefox/Skype 上不起作用，所以我什至无法尝试对任何东西进行逆向工程......

firefox 扩展包含文件 overlay.js：该文件包含扩展的主要逻辑。在这里，我可以`<input type="file" ... >`使用以下代码简单地找到节点：

```
onFileChosen: function(aEvent) {
var input = aEvent.explicitOriginalTarget; 
if(input.type=="file"){
    alert(input.value); }
}

window.addEventListener("change", function(e) {xpitest.onFileChosen(e)},false); 
```

So, when a file has been chosen, an alert window appears and shows the file name.

但是，选择文件后，如何在页面中添加按钮？

我一直在尝试各种 document.parentNode 和类似的东西，但似乎没有任何效果。

或者有没有可能我不能把东西放到加载的页面中？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T21:36:14.147

在 chrome 上下文中，您可以使用 top.window.content.document 获取当前内容文档（例如带有文件选择器的页面）。那时，就像你的 JS 在页面上运行一样。如果这没有帮助，请尽可能多地发布*您的代码。*另请参阅[在 chrome 代码中使用窗口](https://developer.mozilla.org/en/Working_with_windows_in_chrome_code)。

而且您绝对可以将内容注入页面。

# apl - 我在哪里可以学习 APL？

> ID：843803
> 
> 赞同：10
> 
> 时间：2009-05-09T18:27:23.633
> 
> 标签：apl, dyalog

我想学习 APL（更具体地说是 Dyalog APL），但我似乎找不到任何好的学习资源。

我能找到的唯一来源是[Dyalog 的文档下载](http://www.dyalog.com/documentation_library.htm)，但除此之外，谁能推荐一个好的来源？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-09T19:28:11.770

我找到了[APL: An Interactive Approach](http://scanserver.ulib.org/is/scanserver/book24/xml/doc.scn?rs=1&br=0.0&rt=0&rp=http%3A%2F%2Fscanserver.ulib.org%2Fis%2Fscanserver%2FBrowseList.asp%3FgroupId%3Drefmanual&pg=1&auth=752b47040a02a7ee50&x=0&y=0)的扫描。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T20:36:57.440

用于下载所有扫描的 Python 脚本：

```
def download(url, filename):
     import urllib
     webfile = urllib.urlopen(url)
     file = open(filename, 'w')
     file.write(webfile.read())
     webfile.close()
     file.close()

for i in xrange(1, 390):
     download('http://scanserver.ulib.org/is/scanserver/book24/tiff/apli%.4d.tif?rs=1&br=0.0&rt=0' % i, 'apl%.4d.tif' % i) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-09-08T18:15:46.347

[在http://aplwiki.com](http://aplwiki.com)上查找教程

它提供了一个品尝者。使用开源 APL NARS2000，您不必花一分钱购买 APL 解释器。要认真学习 APL，请选择 APLX 或 Dyalog。

小心！你很快就会上瘾——或者不会。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-18T11:02:40.837

[APL 的 K&R 书籍可能是 Gilman 和 Rose 的“一种交互式方法”，但APL Wiki](http://aplwiki.com/)上列出了许多其他书籍、教程、练习、谜题、处理器和链接

# subdomain - 通配符应该属于 CNAME 还是 A NAME？

> ID：843806
> 
> 赞同：1
> 
> 时间：2009-05-09T18:28:59.447
> 
> 标签：subdomain, wildcard, cname, wildcard-subdomain

通配符应该属于 CNAME 还是 A NAME？两者对我来说看起来都一样，谷歌搜索给了我一个不确定的结果。

选择一个而不是另一个背后的任何理性和含义？（底层 DNS 服务器软件？网络托管软件？速度？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T19:23:21.797

我认为这实际上并不重要。

通配符可用于任何 DNS 记录类型，因此它不是 *.domain 的通配符，它​​只是特定记录类型的通配符。

[RFC 4592](https://www.rfc-editor.org/rfc/rfc4592) 非常详细地介绍了它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-08-29T17:23:50.873

您可以在 A 记录和 CNAMES 中添加通配符。

为什么要在 A 记录中添加通配符的典型示例是当您有专用 IP 地址时，例如 1.2.3.4。

如果有人访问[http://wildcard.mytestdomain.com](http://wildcard.mytestdomain.com)，并且子域“wildcard”不存在，服务器将响应指定为通配符的 IP 地址。

`A * 1.2.3.4`

# user-interface - 使用多点触控用户界面提高工作效率

> ID：843807
> 
> 赞同：2
> 
> 时间：2009-05-09T18:30:53.467
> 
> 标签：user-interface, touch

鉴于典型的开发人员使用情况，我想知道从多点触控 Win7 笔记本电脑或 Surface 设备中可以获得多少收益/效用。

如果人们有经验可以分享，或者对此有一些研究，请分享

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T20:32:38.323

我们正处于多点触控技术的早期阶段。如果没有正确的软件工具，多点触控就没有优势。话虽如此，目前使用多点触控显示器没有任何优势。

在控制台编码的日子里，vi 和 emacs 很流行。当图形环境和计算机鼠标变得流行时，它们被整合到下一代编程环境中。如果多点触控显示器流行起来，完全有理由认为开发人员工具将配备触控和手势。

有些事情我可以想象在 IDE 中使用多点触控。这些功能很可能永远不会实现。

*   **上下文相关的触摸按钮。**在您选择的代码上“单击”（第一根手指触摸）时，屏幕左侧或右侧边缘会出现许多按钮。在按住第一根手指的同时，用另一只手的手指按下其中一个按钮。

    *   这减少了鼠标选择代码块并一直向上移动到工具栏以单击一个小按钮的疲劳——全部在左手或右手。出现的按钮应该足够大以便于点击，并且只应该出现那些常见且适用于所选代码的按钮。

    *   假设我按下“更改缩进”按钮。现在我用一根手指左右拖动代码来选择它的缩进级别。

*   **同时操作多个控件。**在重大重构和内置差异被混淆后有两个文件要合并？每只手用一根手指独立滚动文件的两个版本。

*   **手势。**用两根手指在屏幕上滚动。也许可以通过用六个手指从三点钟位置开始逆时针画一个四分之三圈来撤销。这些东西一开始并不完美，但滚动很有希望。有一种方法可以避免瞄准小滚动条*并且*不会因为小滚轮上的主要滚动操作而让您的中指关节炎是一件好事。

别搞错了：这需要一些时间才能赶上。此外，与每项技术一样，大多数开发人员将开始尝试利用该技术到可用性受损的地步。最后，当它确实稳定并变得有用时，您可能实际上并不想使用它。使用 vim 的人比 Visual Studio 更喜欢 vim，但有些 vim 用户确实喜欢将 vim 用作 GUI。喜欢 Visual Studio 的人可能会更多地使用 Visual Studio，而不是任何基于触控的开发环境，但最终 Visual Studio 将开始添加触控功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T19:25:00.530

您专门询问开发人员，因此结果与一般用户群明显不同。要记住的关键一件事是，每当有经验的人不得不将手从键盘上移开（无论出于何种原因）时，它都会减慢他/她的速度，并且比相应的击键花费更多的时间。

这适用于鼠标、轨迹球或其他任何东西。在代码窗口中键入的程序员通常使用键盘加速器比将手放在鼠标右键单击要快得多。触摸屏也应该如此。

餐厅服务员的环境大不相同。很少，如果有的话，他们会在编辑器中输入大量的“文本”。他们站立时正在寻找和啄食触摸屏上的大按钮。

我认为绝对可以从多点触控屏幕中受益的一类开发人员是构建丰富用户界面的 UI/UX 设计师。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T19:32:07.690

这在很大程度上取决于你在做什么。对于任何与编程有关的东西，它基本上是无用的。多点触控的真正亮点在于绘图和信息处理。它使某些操作（例如拖动东西或调整图像大小）更加直观，但除此之外，它并没有比普通触摸屏有用得多。除了绘图之外，普通的触摸屏并不比鼠标有用得多。

99% 的情况下，多点触控不会提高您的工作效率。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T20:36:28.610

与我们内心的开发者交谈……我正在等待多点触控 Starcraft/Warcraft/C&C 的那一天。说真的，RTS 游戏是为多点触控而设计的！

# vim - 如何测试 VIM 的功能？

> ID：843809
> 
> 赞同：1
> 
> 时间：2009-05-09T18:35:35.267
> 
> 标签：vim

*使用命令 ":version" 看到的特性引起了我的兴趣。*

我对这些特性特别感兴趣，例如 Ruby、Python 和 Emacs-tags。我在手册中找不到说明。经过一番谷歌搜索后，我找到了一个命令“--with-features=huge”，但它没有显示如何真正安装这些功能。我已经使用 Vim 一年多了，所以我对这些功能感到相当惊讶。我已经安装了一些东西，比如 Taglist。他们的主要区别是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-09T19:37:51.887

您所指的“功能”是 Vim 的构建时功能。将这些功能视为您在购买汽车时可以获得的选项。例如，许多汽车采用 4 门或 2 门版本。你需要预先指定你想要哪一辆，除非你想买一辆新车，否则你以后不能改变主意。同样，如果不构建新的二进制文件，就无法更改 Vim 中的编译时选项。

许多这些功能也是相互排斥的。例如，您不能同时启用 gui 的主题和 gnome 版本。（就像你不能拥有一辆既是四门又是两门的车）

此外，某些功能是特定于操作系统的。例如，除非您在 Amiga 上运行 Vim，否则您不会获得“amiga”功能。

也就是说，您可能遇到的大多数 Vim 预构建二进制文件都将启用大多数有趣的功能。您可以使用`:version`来找出在您的 vim 构建中启用了哪些功能。完成此操作后，请查看`:help feature-list`（向下滚动一点）功能列表以及指向每个功能的相关文档的链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T18:48:22.833

我不确定你到底在问什么。“Vim 的特性，也许是全部”是一个可以在非常广泛的上下文中使用的术语。

如果您对 vimscript 或 Python、Ruby 中的脚本感兴趣...下载安装 vim 的独立安装程序 - 它带有对这些的预编译支持。当然，您仍然需要安装 Python、Ruby……。

如果你对 vim 的一般特性感兴趣，比如编辑文本、宏、插件、对这个和那个的支持……一般来说就是 vim，那么我只能建议网上的教程或一[本书](http://iccf-holland.org/click5.html)。我在下面提供了一些教程链接：

[Vim Wikia](http://vim.wikia.com/wiki/Main_Page)
[Vim 教程](http://www.linuxconfig.org/Vim_Tutorial)
[Vi 和 Vim 编辑器](http://www.yolinux.com/TUTORIALS/LinuxTutorialAdvanced_vi.html)
[最好的 vim 技巧](http://www.rayninfo.co.uk/vimtips.html?dupe=with_honor)
[快速参考。卡](http://tnerual.eriogerg.free.fr/vimqrc.html)
[学习 vim](http://en.wikibooks.org/wiki/Learning_vi:Vim)
……反正网上满是

编译下是什么意思？我不会尝试猜测，但试试这些：

```
:help make
:help makeprg 
```

细化你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-09T18:50:49.910

就个人而言，如果您是 vim 的新手，我只会安装二进制文件。

通常额外的 vim 功能是通过自定义脚本和插件添加的，而不是通过编译它们。只需安装 vim，然后使用优秀的[Vim 技巧 wiki](http://vim.wikia.com/wiki/Main_Page)来查找和添加您想要的附加功能。

祝你好运 ：）

# c# - 测试互联网连接的最快方法

> ID：843810
> 
> 赞同：22
> 
> 时间：2009-05-09T18:36:10.367
> 
> 标签：c#, networking

C# 2008 SP1

我正在使用此代码连接到我们的客户网站。这是针对软件电话应用程序的。在用户拨打电话之前，软件电话必须测试是否有活动的 Internet 连接。

所以，我想做的是使用 httpWebRequest 类连接到我们的客户网站。如果响应正常，则可以继续进行 Internet 连接。

但是，我注意到响应时间过长。我不确定这是否不是一种非常有效的测试方法。

但是，当我浏览他们的网站时，加载页面只需不到一秒钟的时间。但是当我使用 HttpWebRequest 类时需要很长时间

所以对此的要求是：

有时会在客户办公室使用代理。我不能使用 TCPClient 类（没有代理属性）。

代理不支持 SOCKS，因此无法使用 Sockets 类。

我需要使用超时属性。所以不能使用 WebClient 类。这是因为软件电话会冻结，直到返回响应。所以几秒钟后超时。

所以我唯一能想到的就是 HttpWebRequest 类。

```
 HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://www.xxxxxxxxx.com");
            request.Timeout = 5000;
            request.Credentials = CredentialCache.DefaultNetworkCredentials;
            HttpWebResponse response = (HttpWebResponse)request.GetResponse();

            if (response.StatusCode == HttpStatusCode.OK)
            {
                Console.WriteLine("IsSIPServerAvailable: " + response.StatusCode);
                isAvailable = true;
            } 
```

======== 使用 p\Invoke 编辑 ====

```
 [DllImport("wininet.dll", CharSet = CharSet.Auto)]
    private extern static bool InternetGetConnectedState(ref InternetConnectionState_e lpdwFlags, int dwReserved);

 [Flags]
    enum InternetConnectionState_e : int
    {
        INTERNET_CONNECTION_MODEM = 0x1,
        INTERNET_CONNECTION_LAN = 0x2,
        INTERNET_CONNECTION_PROXY = 0x4,
        INTERNET_RAS_INSTALLED = 0x10,
        INTERNET_CONNECTION_OFFLINE = 0x20,
        INTERNET_CONNECTION_CONFIGURED = 0x40
    }

 // In function for checking internet
 InternetConnectionState_e flags = 0;          
 bool isConnected = InternetGetConnectedState(ref flags, 0); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-09T18:44:06.743

尝试使用 P/Invoke 调用[InternetGetConnectedState](http://msdn.microsoft.com/en-us/library/aa384702(VS.85).aspx)。这应该告诉您是否配置了连接。然后，您可以尝试使用[InternetCheckConnection](http://msdn.microsoft.com/en-us/library/aa384346(VS.85).aspx)检查与您的服务的特定连接。这（有时）比直接连接连接更快，但我会对其进行测试，看看它是否比预先进行完整连接更好。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-09T18:47:00.777

软件电话将使用什么进行真正的通信？是通过 HTTP/HTTPS 访问同一个网站吗？如果是这样，那绝对是正确的方法——下一步就是弄清楚为什么要花这么长时间。

在您提出请求之前，网络连接是否已确定？你确定*没有*事先提出任何要求吗？我问是因为我注意到您没有处理响应 - 如果这也发生在其他地方，您可能会发现您正在运行连接池，只为您提供到特定服务器的几个连接。道德是*始终*将`HttpWebResponse`s 放在`using`陈述中。当然，这可能*不是*您的问题，但值得一试。

如果您的实际应用程序要连接到其他地方，那么这也是您的测试应该检查的地方。基本上，让它尽可能接近真实的东西。

出于兴趣，你说它是一个“软电话”应用程序——它实际上是在某种描述的手机上运行*，*​​使用紧凑的框架，还是桌面应用程序？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-11T01:43:31.513

我有类似的情况，我们要向客户端进行 WCF 调用，如果客户端无法访问（无论出于何种原因），这将花费太长时间。我所做的是打开一个原始 TCP 套接字到客户端地址......如果客户端没有在端口（在你的情况下是端口 80）上侦听，这会很快失败，如果它们在那里，则会很快成功。

这给了我最快和最准确的答案，以确定我是否能够与我试图到达的端点进行通信。唯一的缺点是您必须自己在套接字上管理超时，因为只有发送和接收超时不连接的选项。

它是这样的......

```
Socket socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);

    try
    {
         IAsyncResult result = socket.BeginConnect("www.xxxxxxxxx.com", 80, null, null );
         //I set it for 3 sec timeout, but if you are on an internal LAN you can probably 
         //drop that down a little because this should be instant if it is going to work
         bool success = result.AsyncWaitHandle.WaitOne( 3000, true );

         if ( !success )
         {
                throw new ApplicationException("Failed to connect server.");
         }

         // Success
         //... 
    }
    finally
    {
         //You should always close the socket!
         socket.Close();
    } 
```

我没有在我面前使用的实际代码，但这应该让你走上一般道路。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T20:20:59.257

您可以引用 Microsoft.VisualBasic.Devices 命名空间来使用 NetworkAvailableEventHandler 委托和 Network 类。我使用 Network.IsAvailable 属性和 Network.NetworkAvailabilityChanged 事件来检查网络是否存在（或稍后受到影响），然后对我的服务器执行 HTTP GET 以查看服务器是否存在。

这有助于更具体地报告问题，而不是“看不到网络”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-25T21:45:16.863

更好的选择是添加对 Microsoft.VisualBasic 的引用并添加 using 语句 Microsoft.VisualBasic.Device 然后您可以使用以下代码行来检查与任何网络的连接。

```
public static bool isConnectedToNetwork {
   get {
      Network network = new Network();
      return network.IsAvailable;
   }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-02-01T03:14:01.930

Use Exception Handling.

```
 try
        {
            using (WebClient client = new WebClient())
            {
                string htmlCode = client.DownloadString("https://www.google.com/");                    
            }
        }
        catch
        {
            //No Internet 
            Console.WriteLine("No Internet")
        } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-12T07:30:41.457

`request.GetResponse()` *但是，如果无法解析主机名，*它本身*会给您一个异常，因此您可能需要在它周围放置一个 try-catch， catch 并在属性`System.Net.WebException`中检查其错误状态。`Status`不过，我不确定哪些状态确切地表明没有互联网；大多数响应也可能是由于 dns 或其他连接问题。*

 *# svn - 如果我有 Windows、Mac 和 Linux，那么设置 SVN 服务器的最简单方法是什么？

> ID：843813
> 
> 赞同：3
> 
> 时间：2009-05-09T18:40:37.610
> 
> 标签：svn

我有 Windows Vista、Mac 10.5、Linux Ubuntu……想知道设置 SVN 服务器的最简单方法是什么？一些设置它的指令似乎相当复杂。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T19:00:31.883

对于 Windows 服务器，您应该查看[Visual SVN Server](http://www.visualsvn.com/)。正如他们的网站所述：

> VisualSVN Server 是一个包，其中包含您在 Windows 平台上为您的团队安装、配置和管理 Subversion 服务器所需的一切。它包括 Subversion、Apache 和一个管理控制台。

我可以确认这是真的。

# automated-tests - 如何使用验证码对表单进行自动化测试？

> ID：843817
> 
> 赞同：1
> 
> 时间：2009-05-09T18:46:39.700
> 
> 标签：automated-tests, captcha

如何使用验证码对表单进行自动化测试？我正在使用 selenium 创建测试..我必须通过验证码测试并验证下一页........

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T18:56:56.557

您需要构建一种方法来将已知的验证码引入页面。然后，您只需根据需要填写字段并提交表格。如果您可以使用任意的验证码来做到这一点，那么您的验证码不会对您有多大好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T13:17:53.923

正如 tvanfosson 所建议的那样，要么在页面上有一个已知的验证码，要么有一个配置设置来关闭你的测试环境的验证码验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-01T09:58:21.953

I used message popup which will be displayed until pressed ok and our execution will be paused so that manually we can enter captcha code. It will be better approach than `Thread.sleep();`

```
JOptionPane.showMessageDialog(null, "Hello"); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-14T06:43:27.183

尝试免费试用 Automation Anywhere。我认为你可以创建一个任务，看看它是如何进行的。

[http://www.automationanywhere.com/solutions/automatedtesting.htm](http://www.automationanywhere.com/solutions/automatedtesting.htm)

# uiwebview - iPhone UIWebView 本地资源使用 Javascript 并处理 onorientationChange

> ID：843820
> 
> 赞同：29
> 
> 时间：2009-05-09T18:47:44.877
> 
> 标签：uiwebview, iphone

我正在尝试从 iPhone 应用程序的本地资源中提供 HTML Javascript 和 CSS 内容，但在处理 onOrientationChange 事件和包括外部 Javascript 时遇到了问题。

我似乎能够正确链接 CSS，但不能正确链接 javascript。我正在尝试使用以下处理 onOrientationChange 的示例（[如何构建 iPhone 网站](http://www.engageinteractive.co.uk/blog/2008/06/19/tutorial-building-a-website-for-the-iphone/)），但我正在从我的应用程序的 NSBundle mainBundle 提供网页。

我尝试将 javascript 函数附加到 body.onorientationchange 和 window.onorientationchange 但在本地（或远程）从 UIWebView 提供时都不起作用，但如果我使用的是 iPhone Safari，它会起作用。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <title>How to build an iPhone website</title>

    <meta name="author" content="will" />
    <meta name="copyright" content="copyright 2008 www.engageinteractive.co.uk" />
    <meta name="description" content="Welcome to engege interactive on the iPhone!" />
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;">
    <link rel="apple-touch-icon" href="images/template/engage.png"/>

    <style type="text/css">
        @import url("iphone.css");
    </style>
    <!--
    <script type="text/javascript" src="orientation.js"></script>
    -->
    <script type="text/javascript">

function updateOrientation(){
    try  {
        var contentType = "show_normal";
        switch(window.orientation){
            case 0:
                contentType = "show_normal";
                break;

            case -90:
                contentType = "show_right";
                break;

            case 90:
                contentType = "show_left";
                break;

            case 180:
                contentType = "show_flipped";
                break;
        }

        document.getElementById("page_wrapper").setAttribute("class", contentType);
        //alert('ORIENTATION: ' + contentType);
    }
    catch(e) {
        alert('ERROR:' + e.message);
    }
} 

window.onload = function initialLoad(){
    try {
        loaded();
        updateOrientation();
    }
    catch(e) {
        alert('ERROR:' + e.message);
    }
}

        function loaded() {
            document.getElementById("page_wrapper").style.visibility = "visible";

        }

    </script>

</head>

<body onorientationchange="updateOrientation();">

    <div id="page_wrapper">
        <h1>Engage Interactive</h1>
        <div id="content_left">
            <p>You are now holding your phone to the left</p>
        </div>
        <div id="content_right">
            <p>You are now holding your phone to the right</p>
        </div>
        <div id="content_normal">
            <p>You are now holding your phone upright</p>
        </div>
        <div id="content_flipped">
            <p>This doesn't work yet, but there is a chance apple will enable it at some point, so I've put it in anyway. You would be holding your phone upside down if it did work.</p>
        </div>
    </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-05-12T05:59:54.513

答案可以从我在 XCode 中得到的警告中找到：

> 警告：没有规则为架构 i386 处理 sourcecode.javascript 类型的文件“$(PROJECT_DIR)/html/orientation.js”

XCode setup *.js javascript 作为某种类型的源代码需要在应用程序中编译，当我想将它作为资源包含时，所以我通过做两件事来解决它。

1.  选择 .js 文件并在“详细信息”视图中取消选择表示它是编译代码的靶心列
2.  在“组和文件”视图中展开“目标”树并展开应用程序，然后转到“复制捆绑资源”并将 *.js 文件拖入其中

Apple 开发者论坛发布了一个解决方案：

*   [UIWebView 和 JavaScript](https://devforums.apple.com/message/32282#32282)

> 您似乎被“Xcode 认为 .js 是要编译的东西”功能所吸引。基本上，Xcode 认为脚本应该以某种方式运行或编译，因此将其标记为源代码的一部分。当然，源代码不会复制到资源中。
> 
> 所以你需要做两件事——在你的项目中选择 .js 文件，并关闭表示它已编译的复选框（“bullseye”列）。如果您不这样做，您将在构建日志中收到有关无法编译文件的警告（这应该是您的第一个警告 - 始终尝试找出并纠正出现在您的构建中的任何和所有警告）。
> 
> 然后将其拖放到目标的“复制捆绑资源”中。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2010-02-03T08:54:47.723

在 UIWebView 中未调用 onorientationchange 处理程序的第二个问题的答案：

我注意到 window.orientation 属性不能正常工作，并且 window.onorientationchange 处理程序没有被调用。大多数应用程序都会遇到这个问题。这可以通过设置 window.orientation 属性并在包含 UIWebView 的视图控制器的 willRotateToInterfaceOrientation 方法中调用 window.onorientationchange 来解决：

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    switch (toInterfaceOrientation)
    {
        case UIDeviceOrientationPortrait:
            [webView stringByEvaluatingJavaScriptFromString:@"window.__defineGetter__('orientation',function(){return 0;});window.onorientationchange();"];
            break;
        case UIDeviceOrientationLandscapeLeft:
            [webView stringByEvaluatingJavaScriptFromString:@"window.__defineGetter__('orientation',function(){return 90;});window.onorientationchange();"];
            break;
        case UIDeviceOrientationLandscapeRight:
            [webView stringByEvaluatingJavaScriptFromString:@"window.__defineGetter__('orientation',function(){return -90;});window.onorientationchange();"];
            break;
        case UIDeviceOrientationPortraitUpsideDown:
            [webView stringByEvaluatingJavaScriptFromString:@"window.__defineGetter__('orientation',function(){return 180;});window.onorientationchange();"];
            break;
        default:
            break;
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-04-30T18:01:56.960

最好使用

*   (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation

因为 safari 实际上是在视图旋转后调用orientationChange。

这对我来说很重要，因为我需要在页面旋转后调整 HTML5 画布的大小，并且我知道它的容器有多大。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-03-16T12:51:24.070

我发现了一些关于将 UIWebView 与本地资源一起使用的附加信息。

我在一个简短的博客中将它们收集在一起。如果有人感兴趣，可以下载一个工作示例。

[http://mentormate.com/blog/iphone-uiwebview-class-local-css-javascript-resources/](http://mentormate.com/blog/iphone-uiwebview-class-local-css-javascript-resources/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-04-01T16:31:14.240

我发现 iOS 4.2 不支持 UIWebView 中的 window.orientation 属性，而在移动 safari 中它可以工作......所以，为了让我的 JS 对方向变化做出反应，我发现的唯一方法是让我的 Objective-c代码调用当前显示的 UIWebView 网页中定义的 javascript 函数。这是一个示例代码，覆盖 ViewController 的 didRotateFromInterfaceOrientation 方法：

```
- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    [webView stringByEvaluatingJavaScriptFromString:
          [NSString stringWithFormat:@"didRotateTo('%@')", 
            [self currentOrientationAsString]]];
}
- (NSString*) currentOrientationAsString {
    switch([[UIDevice currentDevice] orientation]) {
        case UIDeviceOrientationLandscapeLeft:
        case UIDeviceOrientationLandscapeRight:
            return @"landscape";
    }
    return @"portrait"; // assuming portrait is default
} 
```

您必须按如下方式定义您的 Javascript 函数：

```
function didRotateTo(ori) {
  if (ori=="portrait") {
    // ... do something
  } else {
    // ... do something else
  }
} 
```

享受！:)

# vim - 在 VIM 的普通模式下如何使用“K”按钮？

> ID：843823
> 
> 赞同：11
> 
> 时间：2009-05-09T18:49:23.453
> 
> 标签：vim, manuals

K 用于打开手册。我很感兴趣你如何使用它。你能用它来写各种手册吗，比如C、java和其他东西？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-09T19:15:49.617

简单地说，K 在光标下的“单词”上运行由 'keywordprg' 选项指定的命令（其中，“单词”是由字母、数字和任何其他由 'iskeyword' 选项指定的字符组成的连续块）。

在基于 Unix 的系统上，'keywordprg' 默认为 'man'，因此在此默认设置中，可以使用 K 查找“man”命令返回有用手册的任何内容。大多数 Unix 系统都有 C 库的手册页，因此您可以很容易地查找 C 库函数。

然而，大多数系统没有 Java 手册页，因此要查找 Java 文档，您需要安装 Java 手册页或更改“keywordprg”设置以调用将显示的程序（“man”除外） Java 文档。

这是您可以使用的 Python 脚本：

```
#!/usr/bin/python

import urllib, os, sys, commands

os.system('firefox' + commands.mkarg(
  'http://www.google.com/search?q='
  + urllib.quote_plus(' '.join(sys.argv[1:]))
  + '+site%3Ajava.sun.com+inurl%3Ajavase%2F6%2Fdocs%2Fapi&btnI=')
  + ' &') 
```

将其另存为`javaman.py`, `chmod +x javaman.py`，将其放在您的路径中，然后在 vim 中：

```
:setlocal keywordprg=javaman.py 
```

然后按 K 将调用 javaman.py，而 javaman.py 又会在 Google 上执行“我感觉很幸运”搜索相关的 Java API 文档。

在非 Unix 系统上，您可能需要在命令中包含 python：

```
:let &keywordprg='python javaman.py' 
```

您可能还需要修改脚本（例如，它当前使用“&”来作为 Unix 主义的后台 firefox）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-09T18:52:39.907

`:help K`可以给你比这里任何人都多的解释

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T18:59:40.170

是的。您需要更新 keywordprg 变量以指向可以以您选择的语言查找关键字的程序。一般来说，您可以搜索特定的语言和解决方案。这是其中的几个

*   Java：http: [//vim.wikia.com/wiki/Vim_Doclet](http://vim.wikia.com/wiki/Vim_Doclet)
*   Perl：http: [//vimrc-dissection.blogspot.com/2009/02/vims-keywordprg-for-perl-and-vim-itself.html](http://vimrc-dissection.blogspot.com/2009/02/vims-keywordprg-for-perl-and-vim-itself.html)

# python - 如何在不转换为二进制的情况下检查汉明权重？

> ID：843828
> 
> 赞同：14
> 
> 时间：2009-05-09T18:54:53.970
> 
> 标签：python, algorithm, discrete-mathematics

如何在不实际转换和计数的情况下获得数字二进制表示中**“1”的数量？**

例如

```
 def number_of_ones(n):
      # do something
      # I want to MAKE this FASTER (computationally less complex).
      c = 0
      while n:
        c += n%2
        n /= 2
      return c

>>> number_of_ones(5)
    2
>>> number_of_ones(4)
    1 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-09T19:05:58.297

我不是 python 程序员，但希望它足以让你遵循。

```
c = 0
while n:
    c += 1
    n &= n - 1

return c 
```

虽然有点晦涩，但它的主要优势是速度和简单性。对于 n 中设置为 1 的每个位，while 循环仅迭代一次。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-09T20:12:20.213

你不能让这在计算上不那么复杂。这将是 O(n) 的位数，或者，正如 & 技巧的答案所示，O(n) 设置为 1 的位数；但除非您使用的所有数字都是特殊情况，否则后者平均应为 n/2，因此这两个 O(n) 数字是相同的。

当然，查找表技巧实际上对计算复杂度没有任何作用。它只是用空间来支付时间，但不会改变基本的经济学原理，即你必须*以某种方式*检查每一位，并且没有办法解决这个问题。从逻辑上讲，如果不检查每个位，您就无法回答有关数字中的位的问题。

现在，我想我有点草率，因为其中许多示例实际上都是 O(n^2)，因为在 Python 中，您必须一次检查整数，因此使用 Python 长整数，例如 100 字节, + 或 & 或 / 操作将至少查看每个字节一次，并且会一遍又一遍地发生，直到数字减少到零（在上面概述的方案中），所以这些，再次，真的是 O( n^2) 操作。我不确定 Python 是否会在这里允许真正的 O(n) 解决方案。

无论如何：如果您真的在询问*计算*复杂性，这特别是指大 O 分析，这就是您的答案。:-)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-09T19:46:52.630

IMO，一个好的方法是使用查找表 - 创建一个字典，将字节转换为 1 的数量（您可以使用您发布的代码来生成它，它只需要运行一次），然后使用一些东西像这样：

```
def number_of_ones(n):
    sum = 0
    while n != 0:
        sum += lookup_table[n & 0xff]
        n >>= 8
    return sum 
```

我相信这是空间和运行时间之间相当好的权衡。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-09T20:03:13.340

如果你想在一行中完成，你可以使用：

```
sum( [x&(1<<i)>0 for i in range(32)] ) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T19:12:23.477

如果您真的关心速度，请用 C 编写代码（请参阅[这个问题了解如何），并使用类似](https://stackoverflow.com/questions/109023/best-algorithm-to-count-the-number-of-set-bits-in-a-32-bit-integer)[ctypes](http://docs.python.org/library/ctypes.html)的东西与 C 实现接口。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-11T17:47:35.523

这里：

```
def bitCount(int_no):

    c = 0
    while(int_no):
        int_no &= (int_no - 1)
        c += 1
    return c 
```

这可能是一种古老而有效的方法……最初是用 C 实现的（Algo 有一个我不记得的名字）。它对我有用，希望对其他人有用

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-02-01T08:31:22.090

[https://en.wikipedia.org/wiki/Hamming_weight](https://en.wikipedia.org/wiki/Hamming_weight)。

O(log(n)) 的解决方案，n 是位长

```
m1  = 0x5555555555555555 #binary: 0101...
m2  = 0x3333333333333333 #binary: 00110011..
m4  = 0x0f0f0f0f0f0f0f0f #binary:  4 zeros,  4 ones ...
m8  = 0x00ff00ff00ff00ff #binary:  8 zeros,  8 ones ...
m16 = 0x0000ffff0000ffff #binary: 16 zeros, 16 ones ...
m32 = 0x00000000ffffffff #binary: 32 zeros, 32 ones
h01 = 0x0101010101010101 #the sum of 256 to the power of 0,1,2,3...

def hammingWeight(self, x: int) -> int:
    x -= (x>>1)&m1
    x = (x&m2) + ((x>>2)&m2)
    x = (x+(x>>4))&m4
    return ((x*h01)>>56)&0x7f 
```

而在 python 3.10 中，int 类型将有一个 bit_count() 方法

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-04-08T15:03:25.387

p= λ n:n 和 1+p(n&(n-1))

这使用了短路和递归，当n大于0时，它切换到计算1+p(n&(n-1))，其中调用p(n&(n-1))等等，当n为0时它返回 0。复杂度为 O(n)，因为它运行二进制文件中存在的数量的次数。

示例：p(9)=1+p(8)=1+1+p(0)=1+1+0=2

# wordpress - 如何在 wordpress 主题中进行多级下拉导航？

> ID：843839
> 
> 赞同：3
> 
> 时间：2009-05-09T19:01:26.217
> 
> 标签：wordpress

我需要在 wordpress 主题中与此站点[http://www.salesforce.com/aloha.jsp相同的菜单。](http://www.salesforce.com/aloha.jsp)多级下拉鼠标悬停。有没有人知道和技巧，技术或 wp-plugin 做同样的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T00:07:10.173

您也可以使用[Suckerfish 方法](http://www.alistapart.com/articles/dropdowns)在直接的 CSS 中执行此操作。

这是一个声称更易于访问的[替代版本。](http://htmldog.com/articles/suckerfish/dropdowns/)

**编辑**：另外，这是[Jakob Nielsen 关于下拉启发式的一篇好文章](http://www.useit.com/alertbox/mega-dropdown-menus.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T19:14:18.760

如果您可以将 jQuery 集成到您的 wordpress 博客中，那么您可以使用 superfish jquery 插件，如此[处所示](http://users.tpg.com.au/j_birch/plugins/superfish/)。单击示例，然后单击导航栏样式（由于某种原因，我无法直接链接）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-09T10:01:25.833

```
Slide down and slide up all tears of wordpress menu items on click function:

<script> 
jQuery('.sub-menu').hide(); 
jQuery(document).ready(function($){
  jQuery('li.menu-item-has-children a').on("click", function(e){ 
    e.stopPropagation();
    e.preventDefault(); 
    if(!$(this).closest('li').hasClass('menu-item-has-children')){
       window.location.href = $(this).attr('href');
        } 
    jQuery(this).next('.sub-menu').slideToggle();
  });
}); 
</script> 
```

# squeak - SqueakMap 无法在新的 3.10 开发映像中工作

> ID：843840
> 
> 赞同：1
> 
> 时间：2009-05-09T19:02:00.383
> 
> 标签：squeak

我刚刚从 Damien Cassou 下载了一个新的 Squeak-dev 图像，点击了 SqueakMap，并得到了在 SqueakMap>>categories 中的错误，objects 实例变量是 nil，但不应该是。我不可能是唯一一个有这个错误的人，是吗？我应该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T20:20:09.600

这修复了它：

```
SMSqueakMap default loadUpdates 
```

容易吧？

# c++ - GetShortPathName 不可预知的结果

> ID：843843
> 
> 赞同：4
> 
> 时间：2009-05-09T19:04:14.557
> 
> 标签：c++, windows, winapi

GetShortPathName() 在 XP SP3 上无法正常工作

[http://msdn.microsoft.com/en-us/library/aa364989(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa364989(VS.85).aspx)

正在返回路径的输入字符串，例如：

```
C:\Test\LongFolderNameToTestWith\BinarySearch.ini 
```

和发送的一样吗？

然而：

```
C:\Documents and Settings\LocalService\NTUSER.DAT 
```

确实为路径命名，所以我知道我正确地调用了 API。

然而：

```
C:\Documents and Settings\LocalService\BinarySearch.ini 
```

不会从文件名中提取短名称，但会为路径创建短名称！？

有人可以帮助我理解这种行为，并可能提出解决方法。

**添加：**

**我需要能够制作 8.3 路径/文件名以传递给旧版应用程序**

**如何才能做到这一点？**

**补充：解决方案**

经过大量阅读/实验后，似乎唯一可靠的方法是使用自动化：

```
' ------------------------------------------------------------
' Library Name:      Microsoft Scripting Runtime 1.0
' Library File:      C:\WINDOWS\system32\scrrun.dll
' ------------------------------------------------------------
' Version Info:
' -------------
' Company Name:      Microsoft Corporation
' File Description:  Microsoft (R) Script Runtime
' File Version:      5.7.0.16599
' Internal Name:     scrrun.dll
' Legal Copyright:   Copyright (C) Microsoft Corp. 1996-2006, All Rights Reserved
' Original Filename: scrrun.dll
' Product Name:      Microsoft (R) Script Runtime
' Product Version:   5.7.0.16599
' ------------------------------------------------------------
' ProgID:            Scripting.FileSystemObject
' Interface Name:    ScriptingFileSystemObject
'
' Interface Prefix:  Scripting 
```

这行得通。

BASIC 中的一个简单实现是：

```
$PROGID_ScriptingFileSystemObject = "Scripting.FileSystemObject"

Interface Dispatch ScriptingFileSystemObject
    Member CALL GetFile  <&H0000271C>(IN FilePath   AS STRING<&H00000000>) AS ScriptingIFile
    Member CALL GetFolder<&H0000271D>(IN FolderPath AS STRING<&H00000000>) AS ScriptingIFolder 
END Interface

Interface Dispatch ScriptingFile
    Member GET ShortPath<&H000003EA>() AS STRING
    Member GET ShortName<&H000003E9>() AS STRING    
END Interface

Interface Dispatch ScriptingFolder
    Member GET ShortPath<&H000003EA>() AS STRING
    Member GET ShortName<&H000003E9>() AS STRING
END Interface

'-----------------------------------------------------------------------------      
FUNCTION FileShortPath( BYVAL sPathnFile AS STRING, sShort AS STRING ) AS LONG

  LOCAL vResult, vFilePath AS Variant

  LOCAL fso   AS ScriptingFileSystemObject
  LOCAL oFile AS ScriptingFile

    IF LEN(sPathnFile) = 0 THEN EXIT FUNCTION  ' Nothing sent

    SET fso   = NEW ScriptingFileSystemObject IN $PROGID_ScriptingFileSystemObject
    IF IsNothing(fso) THEN FUNCTION = -1 : EXIT FUNCTION

    SET oFile = NEW ScriptingFile             IN $PROGID_ScriptingFileSystemObject
    IF IsNothing(oFile) THEN FUNCTION = -2 : EXIT FUNCTION     

    vFilePath = sPathnFile 

    vResult = Empty
    OBJECT CALL fso.GetFile(vFilePath) TO vResult

    SET oFile = vResult 
    IF IsNothing(oFile) THEN FUNCTION = -3 : EXIT FUNCTION 

    vResult = Empty
    Object GET oFile.ShortName TO vResult
    sShort = VARIANT$(vResult) 

    vResult = Empty
    Object GET oFile.ShortPath TO vResult
    sShort = VARIANT$(vResult) 

    IF LEN(sShort) THEN FUNCTION = 1 ' Success

END FUNCTION 
```

谢谢大家的建议。

* * *

我仍在尝试找到一种可靠地制作 8.3 路径/文件名的方法。

除了使用 GETSHORTPATHNAME 之外，还有什么方法可以做到这一点？

解决了。看上面

似乎 MS 仅继续支持 COM deciples ......为什么它现在在 C API 中不可靠仍然是一个谜。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-09T19:15:41.380

这是因为文件名没有现有的短名称，并且 XP SP3 不会自动为文件创建短名称。

您可以检查此注册表设置（如果存在）以查看当前设置的内容。

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem\NtfsDisable8dot3NameCreation

当 NtfsDisable8dot3NameCreation 设置为 1 时，您将获得以下行为：

如果文件夹/文件已经有一个短名称，例如“Program Files”，那么它将返回该文件夹/文件的短名称。但是，如果不存在短名称，您将获得文件的长名称，因为它是该对象存在的唯一名称。如果短名称被禁用，则没有短名称可获取。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T20:05:42.460

根据前面引用的文档，仅当 NtfsDisable8dot3NameCreation 为 0 时才会生成短名称。如果更改了值，您可能有一些文件/目录只有长名称。这可以解释为什么您对 GetShortPathName 的调用可以为目录的短名称和文件的长名称。

我无法确认这一点，但我怀疑 Windows 中可能存在特殊逻辑，总是为关键目录创建短名称，例如“文档和设置”，因为如果不这样做，一些古老的程序可能会中断。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T01:12:51.493

你试过[SetFileShortName](http://msdn.microsoft.com/en-us/library/aa365543(VS.85).aspx)吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-25T09:54:55.153

我知道这是一个很老的帖子，但生活在旋转中。所以，我在这里研究同样的事情。

*如[https://support.microsoft.com/en-gb/help/121007/how-to-disable-8-3-file-name-creation-on-ntfs-partitions所述](https://support.microsoft.com/en-gb/help/121007/how-to-disable-8-3-file-name-creation-on-ntfs-partitions)*

Windows Vista、Windows Server 2008、Windows 7、Windows Server 2008 R2、Windows 8 和 Windows Server 2012

要在所有 NTFS 分区上禁用 8.3 名称创建，请在提升的命令提示符处键入 fsutil.exe behavior set disable8dot3 1，然后按 Enter。

此操作立即生效（无需重新启动）。

笔记

当未指定卷时，操作会更新注册表值：

*   0 - 在系统上的所有卷上启用 8dot3 名称创建
*   1 - 在系统上的所有卷上禁用 8dot3 名称创建
*   2 - 在每个卷的基础上设置 8dot3 名称创建
*   3 - 在除系统卷之外的所有卷上禁用 8dot3 名称创建

# pointers - 为什么我的 64 位 ISAPI dll 中的指针混乱了？

> ID：843845
> 
> 赞同：0
> 
> 时间：2009-05-09T19:04:46.787
> 
> 标签：pointers, 64-bit, isapi

我正在将 32 位 ISAPI dll 迁移到 64 位。我正在使用 Visual Studio 2008。HttpExtensionProc 函数中的 EXTENSION_CONTROL_BLOCK 指针出现问题。EXTENSION_CONTROL_BLOCK 结构中的字符指针在进入函数时无效；它们在监视窗口中标有 。如果我通过交换指针的前 4 个字节和后 4 个字节来手动修改 char 指针，则会显示正确的值。任何想法为什么会发生这种情况？

这是修改指针前的监视窗口，注意lpszQueryString: [link text](http://i41.tinypic.com/2rxwbr4.jpg) [![替代文字](https://i.stack.imgur.com/fShB1.jpg)](https://i.stack.imgur.com/fShB1.jpg)

这是修改指针后的监视窗口，注意lpszQueryString: [link text](http://i39.tinypic.com/2hnar7n.jpg) [![替代文字](https://i.stack.imgur.com/HyS1n.jpg)](https://i.stack.imgur.com/HyS1n.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-11T16:23:10.090

问题是我正在使用 1 字节对齐进行构建。我需要这样做：

```
#pragma pack(push, 8)
#include <httpext.h>
#pragma pack(pop) 
```

[感谢 nobugz 的回答。](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/dac8de78-b987-4d1c-85ba-a8c5a98276c4)

# c# - 对于每个获取 RowIndex

> ID：843847
> 
> 赞同：1
> 
> 时间：2009-05-09T19:06:17.050
> 
> 标签：c#, .net-3.5, extension-methods

有没有一种方法可以获取行索引？

例子 ：

```
int rowIndex = 0;
foreach (int a in numbers)
{
    // Manipulation
    rowIndex++;
} 
```

我想拥有什么

```
foreach (int a in numbers)
{
    a.RowIndex;
} 
```

有没有快速的方法？也许使用扩展方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T19:09:43.687

尝试以下

```
foreach ( var item in numbers.Select( (x,i) => new { Index = i, Value = x })) {
  var index = item.Index;
  var value = item.Value;
  ...
} 
```

选择的重载会向下传递项目的索引。此代码将为包括索引和值的每个项目创建一个新的匿名类型。

这是另一种使语法更具可读性的方法。

```
public static void ForEach<T>(this IEnumerable<T> source, Action<T,int> del) {
  int i = 0;
  foreach ( var cur in source ) { 
    del(cur, i);
    i++;
  }
}

numbers.ForEach( (x,i) =>
{
  // x is the value and i is the index
} 
```

这不会在定义本地并手动增加它的解决方案上增加很多。你有什么特别的原因不想那样做吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T19:13:36.487

如果您要坚持使用 foreach 循环，这可能是最简单的方法。没什么水平，但我认为这是最好的方法。

```
int rowIndex = 0;
foreach (int a in numbers)
{
    rowIndex++; // You could of course inline this wherever rowIndex first
                // gets used, and then simply reference rowIndex (without
                // the increment) later.

    // ...
} 
```

但是一旦你开始这样做，最好还是使用普通的 for 循环（除非你不能因为集合只实现`IEnumerable`而不是`IList`/`ICollection`当然）。

# delphi - 杀死 BDE 的幽灵

> ID：843852
> 
> 赞同：0
> 
> 时间：2009-05-09T19:11:02.340
> 
> 标签：delphi, firebird, bde

在我的 Delphi7 应用程序中，我可以在以管理员身份（“Dave”）登录时连接到数据库，但在以标准或受限用户（“Paris”）身份登录时不能。发生在 XP Home 和 Vista Business Ultimate 64 上。我为 db 使用别名。数据库是 Firebird，中间件是 IBO 4.7。

我在另一个线程中发布了这个，但我知道我有更多信息，而且 BDE 似乎是问题所在。显然 DB.Pas 已链接。我可以在 project.map 文件中看到它，并且 exe 读取注册表以获取 BDE 别名。

我已经删除了所有与 BDE 相关的源和 dcu 文件，我已经在项目中详尽地搜索了一个 DB 组件并且它变得干净了。

有人去过吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-10T07:48:41.473

假设您没有使用包构建 - 从磁盘中删除 db.pas 和 db.dcu（例如，将它们重命名为 db!.pas 和 db!.dcu）并重建。编译器应该在引用 db 的地方停止。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T21:03:12.587

顺便提一下，你是否也检查了所有的USES子句？

你不必担心的不是 Db.pas，我不熟悉 IBO，但我怀疑它也使用 Db.pas (TDataSet, TDatasource)。

您必须在其中查找 DbTables 单元和组件。它包含一个全局声明和实例化的 Session 变量。和 TSession 链接到 BDE。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-11T01:23:37.363

我在你的帮助下解决了。首先 gabr 建议我删除 .dcus。我有，但找到了一些，包括 db.dcu。杀了它。现在编译停止在使用 IB.dcu（Borlands 接口到 Interbase）。杀了它，并得到了编译。在 .map 中为 DB 寻找 - 不存在。仍然不能像巴黎那样工作，所以我在消息来源中发现了一条 Jason 评论，其中显示 TConnection 的 AliasName 属性是用于 BDE 别名，而不是 FireBird 别名，所以我将该属性设置为空白。

在 Paris 下运行 exe，它起作用了！

现在，我需要告诉你我周末把这个带回家了，希望能集中注意力。当它起作用时，我大叫 BLOODY BONZER！在我的声音的最高点 - 所有三只猫都躲了起来。

“IB”——70 万行代码中的 3 个字符！

因此，如果有人被这个鬼魂困扰，请 grep 寻找 IB！

谢谢大家（女孩？）-我如何为您提供最佳答案？

谢谢，戴夫。

# expressionengine - 表达式引擎：在管理部分之外更改状态

> ID：843856
> 
> 赞同：0
> 
> 时间：2009-05-09T19:13:33.193
> 
> 标签：expressionengine

是否可以在管理部分之外编辑条目的状态？我希望能够从首页打开和关闭条目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-17T14:40:11.743

你可以这样做，使用 {exp:weblog:entry_form} 标签然后例如使用：

```
<select name="status">
 <option value="open">Open</option>
 <option value="closed">Closed</option>
</select> 
```

只是使用状态名称作为值^^

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T15:48:30.133

必须有某种 php 钩子！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-27T20:27:16.970

这不是默认的 EE 行为。似乎您可以通过一些工作进行内联编辑。

这是使用 EE 和 Ajax 进行内联编辑的详细操作方法。 [http://www.3roadsmedia.com/use-a-modal-box-to-edit-content-inline-with-expressionengine/](http://www.3roadsmedia.com/use-a-modal-box-to-edit-content-inline-with-expressionengine/)

# sql - 与 SQL 2008 命名实例的 ASP 连接

> ID：843864
> 
> 赞同：0
> 
> 时间：2009-05-09T19:19:40.700
> 
> 标签：sql, asp-classic

我有一个运行三个实例的 SQL 2008 服务器。每个实例都分配有一个唯一的 IP 地址并侦听端口 1433。仅启用 TCPIP。

我所有的 ASP.Net 应用程序都使用 IP 地址成功连接，连接字符串类似于：

```
User ID=SQLUser;Password=userpass;Database=TestDB;Data Source=sqlserver 
```

我的 ASP 应用程序只会连接到默认实例；每当我尝试连接到另一个实例时，我都会收到此错误：

```
Microsoft OLE DB Provider for ODBC Drivers error '80004005' <br />
[Microsoft][ODBC SQL Server Driver][DBNETLIB]Invalid connection. 
```

ASP 连接字符串是这样的：

```
driver={SQL Server};server=sqlserver;uid=SqlUser; pwd=userpass; database=TestDB 
```

我暂时关闭了 IIS 和 SQL Server 上的 Windows 防火墙。SQL Server 和 IIS 服务器之间没有任何其他防火墙。SQL Browser 正在 SQL Server 上运行。我尝试修改 ASP 连接字符串以包含实例名称，例如：

```
driver={SQL Server};server=sqlserver/InstanceName;uid=SqlUser;pwd=userpass;database=TestDB 
```

但我得到同样的错误。

有什么方法可以从 ASP 连接到命名实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-10T02:35:25.597

像这样写服务器名称：

```
server=sqlserver\InstanceName 
```

另外，检查端口号，因为它可能不在 1433 上。

相关的SO问题：

*   [SQL Server 2005 命名实例端口问题](https://stackoverflow.com/questions/272429/sql-server-2005-named-instance-port-problem)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T00:21:50.940

编辑：Sql Server 名称不是[UNC](http://en.wikipedia.org/wiki/Path_(computing)) ;)

尝试使用 \ 而不是 / 之类的：

```
mysqlserver\myinstance 
```

就我个人而言，我总是尝试包括端口。它节省了客户端尝试找出端口号的往返：

```
server=mysqlserver\myinstance,1433;uid=SqlUser;pwd=userpass;database=TestDB 
```

有趣的是，数据库是初始目录的同义词吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-10T03:09:46.340

这是纯粹的猜测。

从 ASP.net 连接到服务器时，您可能正在使用 SQL OLE DB 提供程序。
然而，当涉及到 ASP 时，您将 OLEDB 用于 ODBC（或者它正在选择那种连接以根据您的连接字符串来选择）。

是这样吗？
如果是这样，则可能是连接字符串有问题。有关 SQL Server 连接字符串的示例，请参见 www.connectionstrings.com。

如果您使用 ODBC，请确保您安装了正确的驱动程序集以便连接到 SQL Server ***2008***。

这有帮助吗？

[编辑：我认为在使用 ADO 以使用此http://www.connectionstrings.com/sql-server-2008#20](http://www.connectionstrings.com/sql-server-2008#20)时，您必须更改 ASP 中的连接字符串

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T19:54:31.393

尝试提供 IP 地址。我怀疑当它解析服务器的名称时，它会获取默认实例的 IP 地址。由于您已将它们绑定到单独的 IP 地址，因此您需要提供 IP 地址，或者，如果 IP 地址解析为不同的主机名，则使用该 IP 地址附带的主机名。我认为您不需要指定实例名称，但我不确定。我们的生产服务器上有两个实例——一个用于公共网络应用程序，另一个用于非公共网络应用程序。每个都绑定到一个单独的 IP 地址，但地址反向映射到不同的名称。我只需要在连接到每个实例时使用正确的服务器名称。

# c# - 创建测试和部署 Windows 服务时的最佳实践？

> ID：843866
> 
> 赞同：0
> 
> 时间：2009-05-09T19:22:20.817
> 
> 标签：c#, .net, windows-services

我构建了一个小型 Windows 服务（不是 Web 服务），它定期检查一些数据并基于这些数据并调用一个类库来做一些工作

顺便说一句：这是我第一次尝试创建 Windows 服务

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-09T19:42:12.500

Windows 服务根据定义很难测试，因为每次更改某些内容时都必须始终安装和卸载它们。

最好将您为服务编写的 BL 解耦，并将其放在单独的类中。之后，您可以编写简单的 win 桌面应用程序，您将在其中使用和测试这个 BL 类。完成测试后，很容易将相同的逻辑包含到 Windows 服务项目中。

要调试 Windows 服务，您必须附加到进程，然后直接测试代码非常容易。

希望这会有所帮助...

# xslt - 使用 XSLT/XPath 查找有向无环图 (DAG) 最小元素（顶点）？

> ID：843874
> 
> 赞同：8
> 
> 时间：2009-05-09T19:28:10.490
> 
> 标签：xslt, xpath, graph-theory, directed-acyclic-graphs, build-system

我有一个 XML 文件，它对表示[偏序的有](http://en.wikipedia.org/wiki/Partially_ordered_set)[向无环图 (DAG)](http://en.wikipedia.org/wiki/Directed_acyclic_graph)进行编码 。这样的图对于指定依赖关系和查找[关键路径](http://en.wikipedia.org/wiki/Critical_path_method)等事情很有用。出于好奇，我当前的应用程序是为[构建系统](https://stackoverflow.com/questions/1622506/programming-definitions-what-exactly-is-building/1622520#1622520)指定组件依赖项，因此顶点是组件，边指定编译时依赖项。这是一个简单的例子：

```
<?xml version="1.0"?>
<dag>
    <vertex name="A">
        <directed-edge-to vertex="C"/>
    </vertex>
    <vertex name="B">
        <directed-edge-to vertex="C"/>
        <directed-edge-to vertex="D"/>
    </vertex>
    <vertex name="C">
        <directed-edge-to vertex="E"/>
    </vertex>
    <vertex name="D">
        <directed-edge-to vertex="E"/>
    </vertex>
    <vertex name="E">
        <directed-edge-to vertex="G"/>
    </vertex>
    <vertex name="F">
        <directed-edge-to vertex="G"/>
    </vertex>
    <vertex name="G"/>
</dag> 
```

这个 DAG 可以这样绘制：

[![](https://i.stack.imgur.com/TzDqf.png)](https://i.stack.imgur.com/TzDqf.png)
[（来源：[iparelan.com](http://iparelan.com/dag.png)）]

我想应用一个[XSLT](http://www.w3.org/TR/xslt) [样式表](http://www.w3.org/TR/xslt20/)来生成另一个 XML 文档，该文档只包含与偏序的[*最小元素相对应的顶点。*](http://en.wikipedia.org/wiki/Maximal_element)也就是说，那些没有传入边的顶点。示例图的最小顶点集是`{A, B, F}`。对于我的构建依赖应用程序，找到这个集合很有价值，因为我知道如果我构建这个集合的成员，那么我的项目中的所有内容都将被构建。

这是我当前的样式表解决方案（我正在使用 Apache Ant 的`xslt`任务在 Java 上使用 Xalan 运行它）。`directed-edge-to`一个关键的观察是在任何元素中都不会引用最小顶点：

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:xalan="http://xml.apache.org/xslt"
                exclude-result-prefixes="xalan">
    <xsl:output method="xml" indent="yes" xalan:indent-amount="4"/>

    <xsl:template match="dag">
        <minimal-vertices>
            <xsl:for-each select="//vertex">
                <xsl:if test="not(//vertex/directed-edge-to[@vertex=current()/@name])">
                    <minimal-vertex name="{@name}"/>
                </xsl:if>
            </xsl:for-each>
        </minimal-vertices>
    </xsl:template>
</xsl:stylesheet> 
```

应用此样式表会产生以下输出（我认为这是正确的）：

```
<?xml version="1.0" encoding="UTF-8"?>
<minimal-vertices>
    <minimal-vertex name="A"/>
    <minimal-vertex name="B"/>
    <minimal-vertex name="F"/>
</minimal-vertices> 
```

问题是，我对这个解决方案并不完全满意。**我想知道是否有一种方法可以将`select`of the`for-each`和`test`of the`if`与 XPath 语法结合起来。**

我想写一些类似的东西：

```
<xsl:for-each select="//vertex[not(//vertex/directed-edge-to[@vertex=current()/@name])]"> 
```

但这并不符合我的要求，因为该`current()`函数没有引用外部`//vertex`表达式选择的节点。

到目前为止，我的解决方案使用[XPath 1.0](http://www.w3.org/TR/xpath)和[XSLT 1.0](http://www.w3.org/TR/xslt/)语法，尽管我也对[XPath 2.0](http://www.w3.org/TR/xpath20/)和[XSLT 2.0](http://www.w3.org/TR/xslt20/)语法持开放态度。

如果您愿意，这是 Ant 构建脚本：

```
<?xml version="1.0"?>
<project name="minimal-dag" default="default">
    <target name="default">
        <xslt in="dag.xml" out="minimal-vertices.xml" style="find-minimal-vertices.xsl"/>
    </target>
    <target name="dot">
        <xslt in="dag.xml" out="dag.dot" style="xml-to-dot.xsl"/>
    </target>
</project> 
```

`dot`目标生成用于渲染图形的Graphviz [Dot](http://www.graphviz.org) [语言](http://www.graphviz.org/doc/info/lang.html) [代码。](http://en.wikipedia.org/wiki/DOT_language)这里是`xml-to-dot.xsl`：

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:xalan="http://xml.apache.org/xslt"
                exclude-result-prefixes="xalan">
    <xsl:output method="text"/>

    <xsl:template match="dag">
        digraph {
        rankdir="BT";
        node [style="filled", fillcolor="cyan", fontname="Helvetica"];
        <xsl:apply-templates select="//directed-edge-to"/>
        }
    </xsl:template>

    <xsl:template match="directed-edge-to">
        <xsl:value-of select="concat(ancestor::vertex/@name, '->', @vertex, ';')"/>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-10T10:38:00.023

您可以利用 XPath 对`=`运算符的隐式存在量化：

```
<xsl:for-each select="//vertex[not(@name = //vertex/directed-edge-to/@vertex)]"> 
```

当您使用六个比较运算符（`=`、`!=`、`<`、`<=`、`>`和`>=`）中的任何一个来比较节点集时，如果节点集中的任何节点满足条件，则表达式将返回 true。在将一个节点集与另一个节点集进行比较时，如果第一个节点集中的任何节点在与第二个节点集中的任何节点进行比较时满足条件，则表达式返回 true。XPath 2.0 引入了六个不执行这种存在量化的新运算符（`eq`、`ne`、`lt`、`le`、`gt`和`ge`）。但在你的情况下，你会想要使用 " `=`" 来获得存在量化。

当然请注意，您仍然希望像以前`not()`一样使用该功能。大多数时候，最好避开`!=`操作员。如果您在这里使用它而不是`not()`，那么如果有任何`@vertex`不等于该`@name`值的属性，它将返回 true，这不是您的意图。（如果任一节点集为空，则返回 false，因为与空节点集的比较总是返回 false。）

如果你想`eq`改用，那么你必须做一些像你一样的事情：将条件从迭代中分离出来，这样你就可以绑定`current()`. 但在 XPath 2.0 中，您可以在表达式中执行此操作：

```
<xsl:for-each select="for $v in //vertex
                      return $v[not(//directed-edge-to[@vertex eq $v/@name])]"> 
```

当您的条件不是简单的相等比较（因此不能使用“ `=`”进行存在量化）时，这很有用。例如：`starts-with(@vertex, $v/@name)`。

XPath 2.0 还具有执行存在量化的显式方法。代替`for`上面的表达式，我们可以这样写：

```
<xsl:for-each select="//vertex[not(some $e in //directed-edge-to
                                   satisfies @name eq $e/@vertex)]"> 
```

除了 " `some`" 语法之外，XPath 2.0 还提供了相应的 " `every`" 语法来执行*通用*量化。

除了使用`for-each`，您还可以使用更模块化（且功能强大）的模板规则：

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:template match="/">
    <minimal-vertices>
      <xsl:apply-templates/>
    </minimal-vertices>
  </xsl:template>

  <!-- Copy vertex elements that have no arrows pointing to them -->
  <xsl:template match="vertex[not(@name = //directed-edge-to/@vertex)]">
    <minimal-vertex name="{@name}"/>
  </xsl:template>

</xsl:stylesheet> 
```

同样，在这种情况下，我们依赖于存在量化`=`。

XSLT 1.0 禁止`current()`在模式中（即在`match`属性中）使用函数，但 XSLT 2.0 允许这样做。在这种情况下，`current()`指的是当前正在匹配的节点。所以在 XSLT 2.0 中，我们也可以这样写（不必使用`for`表达式）：

```
<xsl:template match="vertex[not(//directed-edge-to[@vertex eq current()/@name])]"> 
```

请注意，此模式本质上与您尝试在 in 中使用的表达式相同`for-each`，但是虽然它没有执行您想要的 in `for-each`，但它*确实*执行了您想要在模式中执行的操作（因为`current()`绑定到的内容不同）。

最后，我将添加一个在某些方面简化逻辑的变体（删除`not()`）。这也可以追溯到使用 XSLT 1.0：

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:template match="/">
    <minimal-vertices>
      <xsl:apply-templates/>
    </minimal-vertices>
  </xsl:template>

  <!-- By default, copy vertex elements -->
  <xsl:template match="vertex">
    <minimal-vertex name="{@name}"/>
  </xsl:template>

  <!-- But strip out vertices with incoming arrows -->
  <xsl:template match="vertex[@name = //directed-edge-to/@vertex]"/>

</xsl:stylesheet> 
```

如果您不喜欢输出空格，请为文本节点添加一个空规则，这样它们就会被剥离（覆盖文本节点的默认规则，即复制它们）：

```
<xsl:template match="text()"/> 
```

或者，您可以在将模板应用到的节点上更具选择性：

```
<xsl:apply-templates select="/dag/vertex"/> 
```

您采用哪种方法部分取决于品味，部分取决于样式表的更广泛上下文和预期数据（输入结构可能有多少变化等）。

我知道我远远超出了你的要求，但我希望你至少觉得这很有趣。:-)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-10T13:51:25.757

*一种这样的 XPath 1.0 表达式是*：

        **`/*/vertex[not(@name = /*/vertex/directed-edge-to/@vertex)]`**

**然后将其放入这样的 XSLT 样式表中**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

    <xsl:template match="/">
      <minimal-vertices>
          <xsl:for-each select=
          "/*/vertex[not(@name = /*/vertex/directed-edge-to/@vertex)]"
          >
           <minimal-vertex name="{@name}"/>
          </xsl:for-each>
      </minimal-vertices>
    </xsl:template>
</xsl:stylesheet> 
```

**当此样式表应用于最初提供的 XML 文档时**：

```
<dag>
    <vertex name="A">
        <directed-edge-to vertex="C"/>
    </vertex>
    <vertex name="B">
        <directed-edge-to vertex="C"/>
        <directed-edge-to vertex="D"/>
    </vertex>
    <vertex name="C">
        <directed-edge-to vertex="E"/>
    </vertex>
    <vertex name="D">
        <directed-edge-to vertex="E"/>
    </vertex>
    <vertex name="E">
        <directed-edge-to vertex="G"/>
    </vertex>
    <vertex name="F">
        <directed-edge-to vertex="G"/>
    </vertex>
    <vertex name="G"/>
</dag> 
```

**产生了想要的结果**：

```
<minimal-vertices>
  <minimal-vertex name="A" />
  <minimal-vertex name="B" />
  <minimal-vertex name="F" />
</minimal-vertices> 
```

**请注意**： [**此处**](http://www.stylusstudio.com/xmldev/200401/post40440.html)*的 XSLT 提供了遍历完整（可能是循环）图的解决方案* 。[](http://www.stylusstudio.com/xmldev/200401/post40440.html)

 **# jsf - 那里有免费的 JSF Webhost 吗？

> ID：843878
> 
> 赞同：6
> 
> 时间：2009-05-09T19:31:57.080
> 
> 标签：jsf, hosting, web-hosting

我正在为 JSF 网站寻找一个免费的虚拟主机。
不幸的是，我没有通过 Google 找到任何虚拟主机。

它只是为了测试..我知道..我可以用 localhost 测试它。但我确实想要实时条件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-09T19:41:45.263

所以我担心它们不是免费的，但它们非常接近。

您是否考虑过使用云计算服务。您按小时付费，通常是几美分，当您不需要机器实例时，可以将其关闭。您将需要找到一个服务器实例来满足您的需求或自己制作，但一旦完成，您就有一台或多台按需可用的机器，在不使用时无需任何成本。

[Amazon EC2](http://aws.amazon.com/ec2/)和[Rack Space Mosso](http://www.mosso.com/)是最大的两个，尽管还有其他

例如，Mosso 的起价为每小时 0.015 美元。对于具有 1GB RAM 和 40GB HD 的机器，每小时 0.06 美元。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T08:24:43.213

试试谷歌应用引擎。尽可能接近免费。

这是[一篇](http://ctpjava.blogspot.com/2009/04/jboss-seam-on-google-app-engine-first.html)关于让 Jboss Seam 在 GAE 上运行的文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T19:43:47.193

只需购买虚拟主机并设置您想要的任何内容。[EC2 可以工作，但您可以从linode.com](http://www.linode.com/)获得一个全职服务器，起价仅为每月 20 美元左右。我敢肯定还有其他选择。对于最便宜的选项，整月运行一个 EC2 实例的成本约为 70 美元。

# django - ForeignKeyRawIdWidget 的正确参数是什么？

> ID：843882
> 
> 赞同：1
> 
> 时间：2009-05-09T19:34:56.387
> 
> 标签：django, django-admin

我有一个使用 raw_id_fields 的管理类。我不想显示数字键，而是将其转换`__unicode__`为对应的外键对象。

我认为这样做的一种方法是向管理类添加一个表单。此表单将是我想要更改的字段被我自己的小部件覆盖的表单。

作为中间步骤，我只想复制现有行为 - 因此原始 id 字段将与其相邻的图标一起显示。我有一个带有小部件的表单`ForeignKeyRawIdWidget`。这个小部件需要一个参数，但我不知道该给它什么。`ForeignKeyRawIdWidget(DBObjectName.objects.get(pk=53))`例如，我尝试过，但我得到错误 DBObjectName object has no attribute 'to'。

我可以从它在related.py 中的定义中看到该小部件需要一个 to 参数，但我不知道它在寻找什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-15T21:29:38.800

It's looking for an argument in the form of `Class._meta.get_field('field to link').rel`.

For example, I have a class called Photo whose image field is a ForeignKey to another class, and I want that ForeignKey's widget to appear different. The argument that the ForeignKeyRawIDWidget wants for rel is `Photo._meta.get_field('image').rel`.

# ajax - 高级聊天网络应用

> ID：843889
> 
> 赞同：2
> 
> 时间：2009-05-09T19:40:48.837
> 
> 标签：ajax, gmail, comet, chat, xmpp

我希望实现类似于 facebook/gmail 聊天的东西。我知道他们使用 comet & jabber 作为他们的技术。但是我对几件事感到困惑。

1.  我真的需要jabber吗？我可以使用一个简单的 mysql 表来代替 from、to、message、send 和 recd 吗？使用mysql有没有效率低下的地方？有没有性能损失？

2.  可以使用常规网络服务器实现彗星吗？我需要一些特殊的服务器吗？AFAIK，apache+php 无法处理太多打开的连接？我应该使用简单的轮询，这会对我的系统产生不利影响吗？我可以在普通虚拟主机上开箱即用地使用什么？（因为如果我出售聊天应用程序，它应该适用于大多数人。）

3.  哪个是（目前）实施彗星的最佳方式？无限 iframe 是个好主意吗？一段时间后不会php超时吗？它会是一个跨浏览器解决方案还是我必须写一些丑陋的黑客？这会导致服务器负载吗？gmail 和 facebook 使用什么来实现永久连接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T19:56:31.000

很好的问题，希望这不会在周末消失在堆栈中。如果你想使用 flash kirupa 有一个关于如何使用 PHP 和套接字的很好的教程。就彗星而言，我相信你必须有某种服务器实现。这就是我现在薄弱的知识的终点。

简单的轮询示例（jquery + asp.net） [http://trappedinhoth.blogspot.com/2009/04/ajax-jquery-chat-demo.html](http://trappedinhoth.blogspot.com/2009/04/ajax-jquery-chat-demo.html)

Kirupa 的教程（php5 sockets + flash 8） [http://www.kirupa.com/developer/flash8/php5sockets_flash8.htm](http://www.kirupa.com/developer/flash8/php5sockets_flash8.htm)

开源 Flash 聊天客户端（谷歌，还有更多） [https://blueimp.net/ajax/](https://blueimp.net/ajax/)

彗星信息 [http://cometdaily.com/](http://cometdaily.com/)

我并没有真正回答您的问题，只是向您指出更多资源。我很好奇别人会怎么回答。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T18:48:57.443

> 我真的需要jabber吗？我可以使用一个简单的 mysql 表来代替 from、to、message、send 和 recd 吗？使用mysql有没有效率低下的地方？有没有性能损失？

是的，您确实需要使用 jabber 而不是 mysql。您可以阅读 Stonebraker 等人的 [The End of an Architectural Era (It's Time for a Complete Rewrite)][1]，了解为什么不适合使用 RDBMS。

> 可以使用常规网络服务器实现彗星吗？我需要一些特殊的服务器吗？...我应该使用简单的轮询，这会对我的系统产生不利影响吗？我可以在普通虚拟主机上开箱即用地使用什么？gmail 和 facebook 使用什么来实现永久连接？

彗星是一个有点模糊的术语，但不用担心。你不需要特殊的服务器，你不应该使用轮询。您可以使用 [BOSH][2] - 这也是 Facebook（我怀疑是 Gmail）使用的。

在客户端使用 [JSJaC][3]（或 [my fork on Github][4]），在服务器端使用 [ejabberd][5]。两者都支持 [BOSH][6]（和 [XMPP over BOSH][7]），这意味着您可以直接与 XMPP 服务器建立 HTTP 连接，避免轮询并处理高流量负载。

所有这些的链接都在[http://delicious.com/petef/stackoverflow-843889上添加了书签](http://delicious.com/petef/stackoverflow-843889)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T19:53:19.977

我认为 Jabber 可以安全地概念化为（妈妈）中间件，而 MySQL 肯定是（持久存储）后端。这就是苹果和橙子。

考虑到由于 RDMBS 的 ACID 保证及其扩展特性而遇到的限制，没有一个大型 web2.0 应用程序可以依赖 RDBMS 进行实时消息传递。（考虑在运行中对 SQL 表进行分区以添加更多服务器以了解所涉及的问题之一。）

最重要的考虑因素是系统中消息的持久性。它们是要永久保留还是仅在给定的时间窗口内保留。鉴于它是一个聊天应用程序，很可能是后者。为什么不使用基于内存的存储而不是 RDBMS？

为什么要使用 Jabber？好吧，它是一种标准，因此您将在未来打开互操作的可能性，即使此时这不是问题。

更重要的是，它是一个经过长期认真开发的系统（在互联网狗时代），因此假设它（截至目前）并且将继续比您设法设计的任何东西都更加成熟，这当然是公平的、实施、调试并在内部做好生产准备。

对彗星一无所知，所以不予置评！

# oracle10g - 如何将数据导入oracle中存在的数据库

> ID：843896
> 
> 赞同：-1
> 
> 时间：2009-05-09T19:44:58.000
> 
> 标签：oracle10g

我有一个公司的程序 这家公司有多个部门，并且每个部门的数据库处于相同的状态 Ardid 并且每天从分支机构导入的数据或根据需要到总部的数据库并通过 Aldata Balimiol 发送例如，我该怎么做，并且没有错误消息表明数据已经存在或表格请帮忙举个例子，谢谢 fatah_q@yahoo.com

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-15T21:01:20.473

我不太明白你的问题。您是否试图让多个现有数据库包含相同的信息？或者您是否试图将一些信息插入多个单独的数据库？

# c# - 跨域 iframe 中的安全错误

> ID：843900
> 
> 赞同：0
> 
> 时间：2009-05-09T19:46:57.170
> 
> 标签：c#, .net, asp.net, security, ssl

我有一个客户的点击跟踪器。跟踪器只不过是一个将 iframe（不同域）写入页面的 javascript 片段。

如果我有一个普通的 iframe，我可以更准确地跟踪点击（我比较来自另一个跟踪解决方案的数据），而不是 iframe 是安全的（通过 ssl 访问网站）。

在尝试调试问题时，我遇到了一个场景，即 iframe 出现安全错误。它在某种程度上说安全证书无效。

现在的问题是，我只能看到一次这个错误，之后我无法重现它。有什么办法可以复制错误吗？如果 iframe 是安全的，有什么方法可以弄清楚为什么我跟踪的点击次数更少？

**技术堆栈**：
dotNet 框架 3.5
操作系统：Win 2003 服务器
Web 服务器：IIS 6.0
SSL 证书颁发者：Go Daddy。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T20:05:11.853

iframe 应该共享同一个域，例如 foo.com 和 subdomain.foo.com 在 SSL 方面是不同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-15T18:59:51.803

当脚本将 document.domain 属性分配给站点名称空间的后缀时，可以扩展页面的允许访问范围，直至二级域。例如，www.microsoft.com 上的页面可以将 document.domain 属性（最初为 www.microsoft.com）分配为 microsoft.com，以扩大访问范围以包括 home.microsoft.com 或任何其他站点中的页面，只要其他页面也将 document.domain 属性设置为相同的值。 [关于跨框架脚本和安全性：MSDN](http://msdn.microsoft.com/en-us/library/ms533028(VS.85).aspx)

# ruby-on-rails - 对于部署 Web 应用程序，您有什么建议？

> ID：843901
> 
> 赞同：1
> 
> 时间：2009-05-09T19:48:04.857
> 
> 标签：ruby-on-rails, deployment, web-applications

对于部署应用程序（在我的例子中是 Ruby 应用程序），我使用了[Capistrano](http://www.capify.org/)，目前使用[的是 Vlad the Deployer](http://rubyhitsquad.com/Vlad_the_Deployer.html)。

您使用什么进行部署，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T07:30:01.217

我使用 capistrano 和颠覆。

Capistrano 有很好的内联文档，并且在线文档越来越好。

看到[绝对白痴的Capistrano指南](http://www.softiesonrails.com/2007/4/5/the-absolute-moron-s-guide-to-capistrano)（不要冒犯）

需要一点时间才能滚动，但它的祝福。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T23:15:12.787

过去我使用过 Subversion（源代码控制）来处理对 Web 的部署，我知道随着时间的推移它变得越来越流行。如果您有问题（在代码方面），它可以很容易地回滚。这是一篇关于它的文章：

[http://arstechnica.com/open-source/news/2005/04/linux-20050406.ars](http://arstechnica.com/open-source/news/2005/04/linux-20050406.ars)

这是一篇关于将其设置为更具 unix 风格的文章：

[http://www.jejik.com/articles/2008/08/easy_develop_and_deploy_web_applications_from_subversion/](http://www.jejik.com/articles/2008/08/easily_develop_and_deploy_web_applications_from_subversion/)

对于 Windows，我使用免费的 VisualSVN 包：

[http://www.visualsvn.com/](http://www.visualsvn.com/)

然后只需使用命令行工具进行实际结帐。我还发现了这个先前的问题（但对于 PHP）：

[如何开始从 subversion 存储库部署 PHP 应用程序？](https://stackoverflow.com/questions/800294/how-to-get-started-deploying-php-applications-from-a-subversion-repository)

就我个人而言，我不喜欢让它完全自动化——我仍然手动触发部署并观察它，但有些人可能很乐意让机器自己处理。:)

# c - C 程序 argv 不包含双引号

> ID：843904
> 
> 赞同：3
> 
> 时间：2009-05-09T19:48:52.593
> 
> 标签：c

我想编写调用另一个exe的c程序。这个包装器 c 程序除了在我调用我的原始 exec 之前设置一些环境变量之外什么都不做。例如，假设我有一个 exe 被调用`test.exe`并且我写了`testwrapper.exe` 我想将它称为`testwrapper.exe < parameter >`，并且在内部它应该调用`test.exe < parameter >`

我的问题是，当我调用`test.exe`as时`test.exe "c:\program files\input"`，C 以 " 作为参数传递

是什么导致了这个问题，我能做些什么来解决它？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-09T19:55:17.850

引号应该允许带有空格的参数。例如：

```
test.exe "this is an argument with spaces" 
```

为了在参数中加上引号，请转义它们：

```
test.exe "\"c:\program files\input\"" 
```

如果您在 C 程序中调用它，则必须对引号进行双重转义。例如：

```
system("test.exe \"\\\"c:\\program files\\input\\\"\""); 
```

不过，查看您运行的代码行会很有帮助`test.exe`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-10T11:56:22.160

好吧，如果你想传递确切的参数，只需使用 execv：

execv(argv[0], argv);

什么都不需要逃避...

所有这些 execX 功能的手册应该会有所帮助：

[http://www.openbsd.org/cgi-bin/man.cgi?query=execvp&apropos=0&sektion=0&manpath=OpenBSD+Current&arch=i386&format=html](http://www.openbsd.org/cgi-bin/man.cgi?query=execvp&apropos=0&sektion=0&manpath=OpenBSD+Current&arch=i386&format=html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T19:58:34.287

通过在引号前添加反斜杠来转义引号：\"

此外，您可能希望使用正斜杠作为目录分隔符： / 这样，您不必转义反斜杠（如果您愿意，您仍然可以： \\ ）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-11T09:45:49.197

如果您使用的是 unix 系统，请按照 sucuri 的建议使用 execv。在 Windows 上使用 process.h 中定义的 _execv()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T13:13:27.807

```
int main (int argc, char *argv[])
{    
    char *install_dir = 0;
    char perlbin[MAX_PATH];
    char **new_argv;
    int index = 0;

    setlocale(LC_ALL, "");
    install_dir = get_install_dir();

    sprintf(perlbin,"%sbin%cperl.bin",install_dir,sep);
    set_env_variable(install_dir);

    new_argv = malloc(MAX_PATH);
    new_argv[0] = malloc(sizeof(char)*(strlen("perl.bin")+1));
    strcpy ( new_argv[0],"perl.bin");
    for ( index = 1 ; index < argc ; index++)
    {
        new_argv[index] = malloc( sizeof(char)*(strlen(argv[index])+1));
        strcpy ( new_argv[index], argv[index]);
    }
    new_argv[index] = NULL;

    _execv( perlbin,new_argv);
    exit (0);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T13:27:39.437

您也可以自己添加双引号。

（警告：快速破解，未经测试）

```
char ** quoted_argv = malloc((argc - 1) * sizeof(char *));
size_t i;
for(i = 0; i < argc - 1; i++)
{
    quoted_argv[i] = malloc(strlen(argv[i + 1]) + 3); /* allocate space for \0 and quotes */
    sprintf(quoted_argv[i], "\"%s\"", argv[i + 1]);
}

/* ... use quoted_argv ... */

for(i = 0; i < argc - 1; i++)
    free(quoted_argv[i]);
free(quoted_argv); 
```

# java - JFreeChart 中的 ohlc 图表

> ID：843906
> 
> 赞同：0
> 
> 时间：2009-05-09T19:49:35.213
> 
> 标签：java, finance, jfreechart, stockquotes

我目前正在开发一个财务警报应用程序，对于客户端界面，我决定使用 JFreeChart。但是，由于我是新手，对于 ohlc 图表，有一些重要的事情我无法理解：

- 我希望能够在图表中只放入有限数量的柱（比如说 300），并且在达到这个数量之后，最旧的柱会滑出图表。

-我注意到，如果一段时间内没有 bar ，域斧头仍然会前进。例如，如果开始时间是 12:00，并且我有一个酒吧，则第一个酒吧将是 12:00-13:00，下一个将是 13:00-14:00，但如果我得到的下一个更新是在 17:38，那么下一个栏应该是 17:00-18:00 间隔。我想知道如何将 17:00-18:00 栏放在没有 x 的 13:00-14:00 栏旁边，以便在 4 小时之间前进。

- 是否可以为这种图表编写我自己的鼠标事件？

欢迎任何建议或参考！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T20:23:24.133

您可以尝试创建自己的[org.jfree.chart.axis.SegmentedTimeline](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/axis/SegmentedTimeline.html)实现，然后使用[org.jfree.chart.ChartFactory](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/ChartFactory.html#createHighLowChart(java.lang.String,%20java.lang.String,%20java.lang.String,%20org.jfree.data.xy.OHLCDataset,%20org.jfree.chart.axis.Timeline,%20boolean))中的以下内容：

```
ChartFactory.createHighLowChart(java.lang.String title,
                                java.lang.String timeAxisLabel,
                                java.lang.String valueAxisLabel,
                                OHLCDataset dataset,
                                Timeline timeline,
                                boolean legend) 
```

# debugging - 调试和二分查找

> ID：843909
> 
> 赞同：3
> 
> 时间：2009-05-09T19:52:08.857
> 
> 标签：debugging, binary-search, programming-pearls

第 2 栏（“啊哈！算法”）中的“编程珍珠”讨论了二分搜索如何帮助排序、树遍历等各种过程。但它提到二进制搜索可以用于“程序调试”。有人可以解释一下这是怎么做到的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-09T19:57:32.510

如果您不知道 100 行程序中的哪一行是错误的，您会尝试运行前 50 行并跳过其余的。如果问题出现，您就会知道第一段包含错误。接下来您将尝试拆分它并运行前 25 行并查看问题是否存在等等，直到您找到足够短的部分来查看。

二进制搜索背后的想法是识别/隔离一个有问题的小区域。但是，与所有方法一样，这并非适用于所有情况。例如：递归函数对于这样的工具将非常笨拙。当执行路径太多时，对要运行的代码进行分段可能会变得很困难。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-08-31T20:42:20.527

二进制搜索是在排序列表中查找项目的[有效方法。](https://en.wikipedia.org/wiki/Binary_search_algorithm#Performance)例如，如果您正在寻找一本书中的特定页面（例如，第 147 页），您将在靠近中间的位置打开这本书，并确定打开的页面是在您要查找的页面之前还是之后。然后，您将选择已缩小范围的部分并重复该过程：将其分成两半并确定哪一半包含第 147 页。更好的是，您可以猜测第 147 页有多远——如果这本书是很长，接近一本短书的结尾——并用这个猜测作为第一个划分点。这种二分搜索的变体称为[插值搜索](https://en.wikipedia.org/wiki/Interpolation_search)。

因此，如果您有可能隐藏的错误和排序列表，则插值搜索通常是压缩它的方法。其他答案解释了隐藏在一系列行或源代码提交中某处的错误的常见情况。但该技术可以应用于其他情况：

*   **日志搜索**

    在一个长期运行的系统上，尤其是一个处理大量数据的系统上，你必须每天轮换日志，今天看到几周/几个月/几年前还好的东西坏掉的情况并不少见。使用复杂的联锁系统，可以在不更改任何代码的情况下发现错误。查找硬件、网络、操作系统、配置（尽管*应该*与代码一起存储）、输入、手动过程等方面的变化可能很困难，因为这些事情中的很多都在很长一段时间内发生变化。日志的全文搜索（无论是在表中还是在文件中）通常是不切实际的。

    在这种情况下，几乎没有其他选择，只能在中间的某个地方打开日志，看看问题是否存在。然后剪切你知道错误隐藏的部分并再次查找错误。最终，您应该能够在您的错误出现的第一时间发现，这使得找到罪魁祸首变得容易得多。

*   **输入搜索**

    前几天，我注意到一个[带有长文本的晦涩“错误”](https://meta.stackexchange.com/questions/263922/link-titles-are-sometimes-displayed-in-the-text-when-a-long-text-is-pasted-in)。找出有效文本和破坏系统的文本之间确切边界的最快方法是将文本切成两半，直到找到分界线。（事实证明[我是个白痴](https://meta.stackexchange.com/a/263923/1438)，但我[数香蕉](https://meta.stackexchange.com/a/254551/1438)比较好。）

*   **概念过程步骤**

    大多数人甚至不知道他们大部分时间都在使用二进制（或更好的插值）搜索。这是解决问题的一种非常自然的方式。在考虑包含潜在错误的一长串步骤时，通常明智的做法是首先检查中间步骤之一的输出，以避免检查整个代码时才发现问题出在最后一步。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-09T20:43:35.130

另一种可能性是您有一个错误，并且您知道它在您的 2 月版本中不存在，但它在您的 4 月版本中（或者更确切地说，您的 4 月版本*候选*- 您永远不会真正向您的用户发布错误，对？）。

您可以通过修订控制历史进行手动二进制搜索，以缩小引入错误的时间。首先检查两个版本之间的代码，构建它，看看是否存在错误。继续分区，直到你知道它是什么时候被引入的。如果您不知道从哪里开始寻找错误，这可能非常有效，尤其是在您进行相当小的提交时。

[这对Subversion](http://subversion.tigris.org/)非常有效，因为它具有存储库范围的修订号。如果您的 2 月版本是 rev 533，而您的 4 月版本是 rev 701，那么您更新到 rev 617，对其进行测试，然后从那里开始。（实际上，我通常会四舍五入到 600，所以我不必在脑海中做太多的数学运算。）一旦我开始缩小范围，我就会开始查看提交评论并做出有根据的猜测（“我真的不认为这个提交会破坏它”），所以我通常不需要做所有的 log [2] (n) checkouts。

我从未使用过[Git ，但他们使用内置的“](http://git-scm.com/) [bisect](http://www.kernel.org/pub/software/scm/git/docs/git-bisect.html) ”命令更进一步。你给它一个起点（什么时候知道它可以工作？）和终点（你什么时候注意到它坏了？），它会自动获取二进制搜索中途点的代码。然后在你构建和测试之后，你告诉它这个版本是通过还是失败；然后它获取下一个中点的代码。您甚至可以告诉它为每个 rev 运行一个命令，并使用命令的退出代码来确定 rev 是通过还是失败，此时它可以全自动运行。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-09T20:02:03.607

二进制搜索可以通过以下方式帮助调试：

1.  假设控制必须达到某个点，而您怀疑它没有。将打印语句放在第一行和最后一行代码中。假设您看到第一个但不是第二个语句的结果。在中间放一个打印语句，然后再试一次。这样，您可以在代码行空间上使用二进制搜索将错误归零。
2.  假设您使用版本控制系统。版本 10 通过了所有测试。即将发布的版本 70 未能通过一些测试。查看版本 40 并在其上运行测试。如果工作正常，请尝试版本 55。如果版本 40 失败，请尝试版本 25。这样，您可以在程序版本空间上使用二进制搜索，以便在错误进入程序的第一个版本上归零。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-09T19:59:28.980

假设您有一个错误，但您不知道它在哪里。您可以在代码中随机或单步放置断点，在每一站验证数据。然而，更好的策略是在您正在查看的代码块中间选择一个位置。如果那里存在问题，则在起点和当前点之间的中间选择一个点，然后再试一次。如果问题不存在，则在当前点和结束点之间选择一个点，然后重试。继续这种方式，直到您将代码量缩小到一个足够大的块，以便比停止/重新启动更有效地单步执行。这基本上是对您的代码进行二进制搜索。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-31T20:51:09.430

完整的算法称为*Delta Debugging*，由信息学教授和《[为什么程序失败](https://rads.stackoverflow.com/amzn/click/com/0123745152)》一书的作者 Andreas Zeller 开发。

但是，这不仅仅是二进制搜索。二进制搜索仅在开始时完成，一旦二进制搜索不再最小化输入，则采用另一种方法。

完整的算法并不难理解，其实很简单。但是，有时很难重现错误并应用问题是否已重现的决定。

除了这本书，还有关于[Udacity](https://www.udacity.com/course/software-debugging--cs259)的免费在线课程。如果您更喜欢简短版本，请阅读他的[IEEE 论文](https://www.cs.purdue.edu/homes/xyzhang/fall07/Papers/delta-debugging.pdf)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-09T00:49:29.883

您可以注释掉代码、添加日志注释或简单地设置断点

非常适合没有错误但功能无法运行的代码，并且您充满了自我怀疑

首先在代码中间设置断点，如果一切顺利，那么你就知道问题不存在

然后将其设置为代码点的 75% - 如果问题出现在这里，那么您知道它在 50% 和 75% 之间的代码中

所以接下来你将它设置为 57%

如果问题仍然存在，那么你再次将其分成两半

基本上你可以在几分钟内找到问题，而不是花费数小时重新分析你的代码

然后它仍然由你来修复它。

# c# - C# 能力？

> ID：843914
> 
> 赞同：4
> 
> 时间：2009-05-09T19:55:58.583
> 
> 标签：c#, .net, .net-3.5, c#-3.0

我一直在搜索 .net 3.0 和 3.5 框架的内容列表，因为我一直在使用哈希表等旧技术而不是字典（新技术）进行编程。

我一直在努力，想知道在哪里可以找到 C# 和 .Net 框架的所有最新功能的列表，以便我可以开始思考如何使用其中的一些东西。

帮助将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T20:10:18.767

老实说，[维基百科](http://en.wikipedia.org/wiki/.NET_Framework)在这里做得很合理......

.NET 3.0 引入：

*   WCF - 希望取代 asmx 和远程处理的通信框架
*   WF - 顺序和状态流的工作流框架
*   WPF - 替换 Windows 窗体

.NET 3.5 引入：

*   LINQ
    *   LINQ 到 SQL
    *   LINQ 到对象
    *   `HashSet<T>`, `Action<...>`, `Func<...>`, `Expression<...>`,`Lookup<,>`
*   C# 3.0
*   其他一些小调整；-p

.NET 3.5 SP 1 引入：

*   LINQ
    *   实体框架
    *   ADO.NET 数据服务

编辑：（jonskeet）[C#](http://en.wikipedia.org/wiki/C_Sharp_(programming_language))页面具有类似的布局，显示哪些版本引入了哪些功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T20:02:49.847

“C# 的最新功能”...

**隐式类型的局部变量：**

编译器从初始化值派生出类型。

```
// Implicitly typed local variables.
var myInt = 0;
var myBool = true;
var myString = "Time, marches on..."; 
```

这些在与 LINQ 一起使用时非常有用。

**自动属性：**

无需编写整个属性语法。

```
class Car
{
  // Automatic property syntax.
  public string PetName { get; set; }
} 
```

**扩展方法：**

当您需要将新功能注入到您没有现有代码库的类型中时，此技术非常有用。

有关 Scott Gu 博客的更多信息，请[点击此处](http://weblogs.asp.net/scottgu/archive/2007/03/08/new-c-orcas-language-features-automatic-properties-object-initializers-and-collection-initializers.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T20:01:10.380

您是否尝试过[MSDN](http://msdn.microsoft.com/en-us/netframework/default.aspx)上的 .Net Framework 页面？链接页面是很多新技术的一个很好的起点，包括 Windows Communication Foundation (WCF) 和 Windows Presentation Foundation (WPF)。有关基类库的详细信息，该页面的此[链接](http://msdn.microsoft.com/en-us/netframework/aa569603.aspx)是一个很好的起点。您可能还想浏览[Phil Haack](http://haacked.com/)或[Scott Guthrie](http://weblogs.asp.net/scottgu/)的博客。

有关 C# 的信息 - 包括 C#4.0 中即将推出的功能 - MSDN 上的[VisualC#](http://msdn.microsoft.com/en-us/vcsharp/default.aspx)页面是一个很好的起点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-09T20:10:10.763

既然你提到`Dictionary`了，我会以提到的方式回应`HashSet`。我不认为`Dictionary`它实际上是新的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-09T20:23:40.013

我有两页可能对你有用：

*   [虚张声势的 C# 2 指南](http://csharpindepth.com/Articles/General/BluffersGuide2.aspx)
*   [虚张声势的 C# 3 指南](http://csharpindepth.com/Articles/General/BluffersGuide3.aspx)

这些都是关于 C# 而不是 .NET 框架，但它们是从 1 到 2 以及从 2 到 3 的更改的快速指南。

对于更详细的指南，我不禁推荐我自己的书[C# in Depth](http://manning.com/skeet)。同样，这主要是关于*语言*更改（没有 WPF、WCF 等），但希望你会喜欢它:)

我的“[版本](http://csharpindepth.com/Articles/Chapter1/Versions.aspx)”页面简要介绍了 C#*和*.NET 的不同版本，因此这对您也可能有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-09T20:11:26.563

我发现[此](http://www.developer.com/net/csharp/article.php/3561756)页面具有新的 3.0 功能，而[此](http://geekswithblogs.net/SudheersBlog/archive/2008/03/27/120813.aspx)页面具有新的 3.5 功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-09T21:04:35.330

当您谈论在框架 1.1 之后实际上已经过时的 HashTables 时，您应该开始查看框架 2 和 C# 2 中的新功能。

像：

*   泛型
*   可空类型
*   匿名代表

[.NET Framework 2.0 版](http://msdn.microsoft.com/en-us/library/t357fb32.aspx)
[中的新功能 C# 2.0 语言和编译器中的新功能](http://msdn.microsoft.com/en-us/library/7cz8t42e(VS.80).aspx)

# http - 为什么服务器 HTTP 标头存在？

> ID：843917
> 
> 赞同：21
> 
> 时间：2009-05-09T19:56:36.600
> 
> 标签：http, http-headers

服务器 HTTP 响应标头有什么用？我还没有真正看到它的用途。为什么请求网页的人需要知道网页托管在哪个服务器上？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-09T20:23:06.490

这让我想起了我写的第一个 HTTP 服务器，它（显然）返回了服务器头：`Why do you want to know?`

这个问题的一个可能答案是“因为我正在做一项调查”。例如，如果没有 Server 标头，[这将是不可能的。](http://news.netcraft.com/archives/web_server_survey.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-09T20:18:05.300

*服务器*并不意味着提供资源的服务器。[这是为了宣传实施](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.38)。至于它的实用性，这是一个很好的问题。可以将 Apache httpd 配置为不包含该标头，因为它可以被视为安全问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T20:17:55.410

有趣的问题。在一个层面上，也许它最初被视为一种能力设备，类似于请求中的用户代理（browscap 等）。实际上，在这方面两者都不是真正有用的，现在大多数代码都使用其他方法来测试选项。在许多方面，服务器（间接）控制来自表现良好的客户端的请求（如果有影响因素，至少）。

这些天来，它有时被视为一个安全问题，而且我知道很多地方会在 html 流量中阻止此标头。但是对于非 html（但仍然是 http）流量（例如 Web 服务），它仍然可以用于有用的版本控制目的（尽管在这种情况下您经常会看到特定于产品的版本控制标头）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T09:18:17.217

标头的唯一目的似乎是安全扫描仪和调查每台服务器的市场份额。在 Apache 中，无法完全删除标头，只能将其设置为最小，以便仅宣传“Apache”。需要修补二进制文件以完全删除它或自己重新编译它。

我认为使用 IIS 也不能直接删除它。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-09T20:24:29.827

统计数据..无论是谁，都会让您了解事情何时以及如何传播..

尝试使用 dons Google 并查看 3 个字母的服务器：响应.. 周围有很多人，因为他们多年前购买了大量的盒子。

[这就像声称 Apache 或 IIS 的传播速度太快了，就靠我 MP 的开支..]

# c# - 当其他类在 C# 中得到结果时，在类上回滚或提交（企业库事务）

> ID：843919
> 
> 赞同：0
> 
> 时间：2009-05-09T19:56:59.347
> 
> 标签：c#, design-patterns, class, transactions

我有一门课是桌子的镜子。

```
 public class Patient
    {
        public int Patient_id { get; set; }
        public string Name { get; set; }
        public string Address { get; set; }
        public bool Sex { get; set; }

        public Patient f_UpdatePatient(Patient _patient)
        {
            string QUpdate = "  UPDATE Patients "
                             + "   SET Name    = '" + _patient.Name + "'"
                             + "      ,Address = '" + _patient.Address + "'"
                             + "      ,Sex = " + (_patient.Sex ? "M" : "F")
                             + " WHERE patient_id = " + _patient.Patient_id;

            Database db1 = DatabaseFactory.CreateDatabase("cnnStr");
            DataSet ds = db1.ExecuteDataSet(CommandType.Text, QUpdate);

            // First, How can i set my instance which is coming as a parameter 
            // to my real object. Without passing each value to eac prop of obj.
            return this = _patient;
        }
    } 
```

我有另一个使用 Patient 的课程。在使用它之前，它会为 Patient 类的一个实例设置新值，因此我可以将最后一个值发送到 Web 服务。（实际上我需要在使用不在我的项目中的 Web 服务之前编写 db）

```
 public class ServiceConnection
    {
        public static void Main(string[] args)
        {
            Patient pt = new Patient(12);

            // Just want to show that i need DB update.
            pt.Name = args[0];
            pt.Address = args[1];

            try
            {
                // Now i am connection web service and sending pt instance
                bool isOk = f_SendToService(pt);
            }
            catch (Exception ex)
            {
                // Now, at this point, I WANT TO ROLLBACK MY UPDATE with TRANSACTION 
                // or something else
                throw (ex);
            }
        }

        private static bool f_SendToService(Patient pt)
        {
            // trying to send. But sometimes, i get timeout errors
            // sometimes i get false result.
            throw new WebException("Sorry it couldn't reach to WS");
        }
    } 
```

如果我得到异常或错误结果，您对我该如何处理有什么建议吗？

我想使用 TRANSACTION （因为我不想再次设置同一行。）但是如何？

谢谢指教...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-24T11:14:51.937

您可以实现 System.ComponentModel.IEditableObject 接口并像这样使用该实体

```
 Patient pt = new Patient(12);
  pt.BeginEdit();
  pt.Name = args[0];
  pt.Address = args[1];
  if (WSCallIsOK())
     pt.EndEdit();       // save is OK
  else
     pt.CancelEdit();   // sets values back 
```

仅适用于属性 Sex 的示例代码

```
// holds backup of values
private string __Sex;
private string _Sex;
public string Sex
{
    get
    {
        return _Sex;
    }
    set
    {
        bool changed = _Sex != value;
          if (changed)
            {
                this.RaisePropertyChanged("Sex");
            }

    }
}

#region IEditableObject Members

private bool _editing = false;

public void BeginEdit()
{
    if (!_editing)
    {
        // create copy of property
        __Sex = _Sex;
        //other properties here
        _editing = true;
    }
}

public void CancelEdit()
{
    if (_editing)
    {
        // revert back
        _Sex = __Sex;
        //other properties here
        _editing = false;

    }
}

public void EndEdit()
{
    if (_editing)
    {
        _editing = false;
    }
}

#endregion 
```

# nhibernate - 使用 Fluent NHibernate 更新一对多

> ID：843925
> 
> 赞同：1
> 
> 时间：2009-05-09T19:57:54.663
> 
> 标签：nhibernate, fluent-nhibernate

我正在尝试构建具有以下类/关系结构的修改后的角色系统：

项目项目角色员工

在哪里

ProjectEmployee 将三个实体映射在一起。

我有一个从 Project 到 ProjectEmployee 的一对多映射以及从 ProjectEmployee 到 Project 的引用映射。

我可以添加新的 ProjectEmployee 就好了（这意味着我的 Create 活动也很好），但我想将关系限制为每个员工只有一个条目。这会影响我的更新活动的逻辑。

在一起破解时，我试图清空 Project.ProjectEmployees（通过将值设置为新列表），然后添加具有适当角色的 ProjectEmployee 的新实例，等等。

在执行此操作时，我收到与将 Project.ProjectEmployees 设置为空列表相关的错误。

“无法将值 NULL 插入 'ProjectId' 列，表 'AppDB.dbo.ProjectEmployees'；列不允许空值。更新失败。语句已终止。”

如果我删除列表中的新闻行，则会添加后续记录，但是我盯着每个员工的记录太多了。

这是我的项目-> ProjectEmployees 映射：

```
mapping.HasMany<ProjectEmployee>(x => x.ProjectEmployees)    
    .Cascade.All()
    .WithKeyColumn("ProjectId"); 
```

以及 ProjectEmployee -> Project 中的映射：

```
mapping.References(x => x.Project, "ProjectId"); 
```

应该很简单吧？

值得一提的是，我还在我的 Project 类中添加了一个名为 AddProjectEmployee 的方法，该方法搜索有问题的 Employee，如果他存在则删除他的 ProjectEmployee，然后添加新的 ProjectEmployee。当我调用它时，我得到了同样的错误。

任何帮助，将不胜感激。

缺口

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-10T02:57:52.953

这是[在 Fluent NHibernate 组上交叉发布的，](http://groups.google.com/group/fluent-nhibernate/browse_thread/thread/b5c3eb713f2f82f3)并由 Hudson Akridge 在那里回答。正如 Hudson 所说，解决方案是`Clear()`在集合上使用，因为它允许 NHibernate 跟踪更改（而更新集合会导致属性引用 NH 不知道的实例）。

# linq - 实体框架执行

> ID：843930
> 
> 赞同：0
> 
> 时间：2009-05-09T20:00:13.830
> 
> 标签：linq, entity-framework

我是实体框架的新手，想知道何时实际从数据库中获取数据。如果我这样做：

```
from order in orderQuery where order select car; 
```

然后是从数据库中选择数据，还是在我像下面的代码一样操作它时首先选择数据？

```
(from order in orderQuery where order select car).ToList(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T20:03:25.290

实体框架以延迟加载方式工作，仅在实际需要数据时才查询数据库。

所以查询只会在你的第二个例子上执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T20:03:53.900

LINQ 查询有一个称为延迟执行的属性。这将查询的构建和执行分为 2 个不同的部分。您给出的第一个示例仅定义了一个查询，因此不会导致任何执行。然而，第二个将强制查询运行完成

# c# - 如何更快地刷新控件？

> ID：843934
> 
> 赞同：1
> 
> 时间：2009-05-09T20:02:40.313
> 
> 标签：c#, controls, drawing, refresh

我在 C# 中有一个自定义控件。我注意到调用`Refresh`比我想要的慢得多（大约 0.1 毫秒），即使我有一个空`RePaint`函数。基本上，我的应用程序处理一个网格，并一个一个地刷新每个网格单元。这种相当低效的行为是设计使然。启用后，我希望能够实际查看每个处理步骤所做的工作，并且每个步骤最终只会更改一个单元格。切换双缓冲没有太大区别。

任何人都可以提供任何建议吗？

目前，我想出的最佳改进是将我`Refresh`的呼叫替换为对`Refresh2`. 后一个函数是 的精确副本`Repaint`，除了在顶部添加两行`Graphics g = Graphics.FromHwnd(this.Handle); g.Clear(BackColor);`并替换`e.Graphics`为`g`. 我怀疑这有一些缺点，但它确实将绘图速度减半。请注意，我正在使用的控件没有子组件，因此验证之类的事情并没有那么重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T20:15:44.667

刷新太多会减慢您的体验，尝试压缩事件，即在获得新网格时不刷新，但在需要更新时设置变量，并让计时器每 1 秒检查一次该变量并刷新然后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-09T20:50:44.210

刷新是自动重复事件还是响应用户事件？

在第一种情况下，它应该是异步的（在它自己的线程中）。如果响应用户事件，那么在“刷新”对事件不重要的情况下也是如此。

如果更新接口的代码太慢，请确保它只更新接口（它应该已经准备好数据......这是双缓冲的脉络）。如果不是这种情况，请进行一些日志记录，找出花费太多时间的原因。

如果它必须首先获取数据，那么预计会有一些滞后。如果这是不可接受的，那么您将需要一些缓存机制。您可以让缓存自动异步更新，或者让它返回缓存的内容，获取新数据，然后导致另一个更新..或类似的东西。

# c# - C# 中的电子邮件处理

> ID：843935
> 
> 赞同：1
> 
> 时间：2009-05-09T20:02:43.013
> 
> 标签：c#, .net, email

我需要知道在 C#/.NET Framework 中处理电子邮件的对象名称。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-09T20:07:21.847

您需要命名空间 System.Net.Mail。

[这](http://weblogs.asp.net/scottgu/archive/2005/12/10/432854.aspx)是 ScottGu 博客中的一个示例。

```
MailMessage message = new MailMessage();
message.From = new MailAddress("sender@foo.bar.com"); 

message.To.Add(new MailAddress("recipient1@foo.bar.com"));
message.To.Add(new MailAddress("recipient2@foo.bar.com"));
message.To.Add(new MailAddress("recipient3@foo.bar.com")); 

message.CC.Add(new MailAddress("carboncopy@foo.bar.com"));
message.Subject = "This is my subject";
message.Body = "This is the content";

SmtpClient client = new SmtpClient();
client.Send(message); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-09T20:06:55.547

[System.Net.Mail](http://msdn.microsoft.com/en-us/library/system.net.mail.aspx)是要查看的命名空间。从[SmtpClient](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.aspx)或[MailMessage](http://msdn.microsoft.com/en-us/library/system.net.mail.mailmessage.aspx)开始。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T20:20:31.113

除了 Ekeko 的回答之外，如果您想使用外部邮件服务器，您必须在 SmtpClient 构造函数中指定主机。

```
SmtpClient client = new SmtpClient("mail.yourmailserver.com"); 
```

如果您的服务器需要，您可能还需要指定身份验证。

```
client.Credentials = new NetworkCredential("username", "password"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T20:41:51.610

这些答案假设您正在询问 SMTP 处理。POP3 不是在 .NET 框架中本机处理的。您将不得不购买第三方库。我推荐 Ostrosoft POP3 库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T20:41:55.523

堆栈溢出中有一堆问题描述了如何发送。

*   [使用 C# 发送电子邮件](https://stackoverflow.com/questions/449887/sending-e-mail-using-c)
*   [发送电子邮件 C#](https://stackoverflow.com/search?q=send%20email%20c%23&page=2&tab=relevance)

# vb.net - 更改数据网格列顺序或索引

> ID：843955
> 
> 赞同：6
> 
> 时间：2009-05-09T20:11:19.733
> 
> 标签：vb.net, linq, datagridview, anonymous-types

这是我无法相信我无法弄清楚的事情 - 请告诉我我错过了一些简单的事情......

我有一个数据网格，我用 LINQ 和一个自定义类来填充它以向它添加数据。

之后，我需要按特定顺序的数据 - 它似乎忽略了我。

如何更改列属性，如索引等？

这是我正在使用的 LINQ 代码：

提前致谢...

```
 Dim query = From m In db.details _
                Where m.InboundDate >= CType(MonthCalendar1.SelectionStart, DateTime) _
                And m.InboundDate <= CType(MonthCalendar1.SelectionEnd, DateTime).AddHours(23).AddMinutes(59) _
                And m.ClientNo = 1 _
                  Join md In db.Manifests On md.ManifestID Equals m.MainID _
                Select New GridData With {.manifestID = m.MainID, .InboundDate = m.InboundDate, .Zip = m.Zip, .LadingPkgQty = md.LadingPkgQty, .Weight = m.Weight, .Zone = m.Zone, .Fuel = 23, .LineHaul = Nothing, .Freight = Nothing, .BilledAmount = Nothing, .PackageRate = Nothing, .LTL = Nothing} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-09T21:50:39.447

解决了

我简直不敢相信为了找到这个我必须经历多少东西！

现在看起来太明显了（就像事实发生后的大部分.net一样！）

`Datagrid.Columns("Zone").DisplayIndex = 0`

或者

`Datagrid.columns(1).DisplayIndex=0`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T20:16:38.953

您所看到的是 VB 如何在 Visual Studio 2008 RTM 中生成匿名类型的效果。编译器会按字母顺序对属性进行排序。因此，无论您指定什么顺序，如果您对查询进行数据绑定，列将按字母顺序显示。

在 Visual Studio 2008 SP1 中，VB 编译器进行了更改以解决此问题。匿名类型现在将以您在代码中指定它们的相同方式生成匿名类型成员。如果您升级到 VS2008 SP1，您应该会看到此行为发生了变化。

有关该主题的详细文章

*   [http://www.thinqlinq.com/default/VB-Ordering-of-Anonymous-Type-Properties-change-with-VS-2008-SP1.aspx](http://www.thinqlinq.com/default/VB-Ordering-of-Anonymous-Type-Properties-change-with-VS-2008-SP1.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T20:41:19.270

我不确定具体发生了什么，但需要考虑一些事情......

您在什么时候修改列？如果为时已晚，可能需要将其反弹到网格，从而导致重新绘制。通常，当我更改某些内容并且在屏幕上看不到它的效果时，这是由于绑定顺序所致。

# objective-c - 弹跳 UITableView 导致崩溃

> ID：843971
> 
> 赞同：1
> 
> 时间：2009-05-09T20:18:10.260
> 
> 标签：objective-c, iphone

我正在开发一个使用 RSS 的 iPhone 应用程序。当我滚动我`UITableView`的`__TERMINATING_DUE_TO_UNCAUGHT_EXCEPTION__`.

这是我的代码： [http://pages.stern.nyu.edu/~abc329/SS/](http://pages.stern.nyu.edu/~abc329/SS/)

这是我得到的错误：

```
warning: Unable to read symbols for 
 "/System/Library/Frameworks/UIKit.framework/UIKit" (file not found).

warning: Unable to read symbols from 
 "UIKit" (not yet mapped into memory).

warning: Unable to read symbols for 
  "/System/Library/Frameworks/CoreGraphics.framework/CoreGraphics" (file not found).

warning: Unable to read symbols from 
  "CoreGraphics" (not yet mapped into memory).
Program loaded.
sharedlibrary apply-load-rules all

Attaching to program: `/Users/abc329/Library/Application Support/
                      iPhone Simulator/User/Applications/
                      D1B397C8-9464-4979-9F12-4302A502680E/
                      street-spotted.app/street-spotted', process 18528.

(gdb) 
```

# image - 图像比较 - 快速算法

> ID：843972
> 
> 赞同：432
> 
> 时间：2009-05-09T20:18:18.263
> 
> 标签：image, algorithm, comparison, computer-vision

我正在寻找创建图像的基表，然后将任何新图像与其进行比较以确定新图像是否是基础的精确（或接近）副本。

例如：如果您想将同一图像的存储量减少 100 次，您可以存储一份副本并提供指向它的参考链接。输入新图像时，您想与现有图像进行比较以确保它不是重复的……想法？

我的一个想法是缩小为一个小缩略图，然后随机选择 100 个像素位置并进行比较。

* * *

## 回答 #1

> 赞同：483
> 
> 时间：2009-05-09T21:27:43.247

以下是解决此问题的三种方法（还有许多其他方法）。

*   第一种是计算机视觉中的标准方法，即关键点匹配。这可能需要一些背景知识来实现​​，并且可能很慢。

*   第二种方法仅使用基本图像处理，并且可能比第一种方法更快，并且易于实现。然而，它在可理解性方面获得了什么，但它缺乏鲁棒性——在缩放、旋转或变色的图像上匹配失败。

*   第三种方法既快速又健壮，但可能是最难实现的。

**关键点匹配**

比选择 100 个随机点更好的是选择 100 个*重要*点。图像的某些部分比其他部分具有更多信息（特别是在边缘和角落），这些是您想要用于智能图像匹配的部分。谷歌“[关键点提取](http://www.google.com/search?q=keypoint+extraction)”和“[关键点匹配](https://www.google.com/search?q=keypoint+matching)”，你会发现相当多的关于该主题的学术论文。如今，[SIFT 关键点](http://en.wikipedia.org/wiki/Scale-invariant_feature_transform)可以说是最受欢迎的，因为它们可以匹配不同比例、旋转和照明下的图像。可以在[此处](http://people.csail.mit.edu/albert/ladypack/wiki/index.php?title=Known_implementations_of_SIFT)找到一些 SIFT 实现。

关键点匹配的一个缺点是简单实现的运行时间：O(n^2m)，其中 n 是每个图像中关键点的数量，m 是数据库中图像的数量。一些聪明的算法可能会更快地找到最接近的匹配，例如四叉树或二进制空间分区。

* * *

**替代解决方案：直方图法**

另一个不太健壮但可能更快的解决方案是为每个图像构建特征直方图，并选择直方图最接近输入图像直方图的图像。我作为本科生实现了这一点，我们使用了 3 个颜色直方图（红色、绿色和蓝色），以及两个纹理直方图，方向和比例。我将在下面给出详细信息，但我应该注意，这仅适用于匹配与数据库图像非常相似的图像。使用这种方法重新缩放、旋转或变色的图像可能会失败，但像裁剪这样的小变化不会破坏算法

计算颜色直方图很简单——只需选择直方图桶的范围，并为每个范围计算该范围内颜色的像素数。例如，考虑“绿色”直方图，假设我们为直方图选择 4 个桶：0-63、64-127、128-191 和 192-255。然后对于每个像素，我们查看绿色值，并将计数添加到适当的桶中。当我们完成计数后，我们将每个桶的总数除以整个图像中的像素数，以获得绿色通道的归一化直方图。

对于纹理方向直方图，我们首先对图像进行边缘检测。每个边缘点都有一个法向量，指向垂直于边缘的方向。我们将法线向量的角度量化为 0 和 PI 之间的 6 个桶之一（由于边缘具有 180 度对称性，我们将 -PI 和 0 之间的角度转换为 0 和 PI 之间）。在计算了每个方向上的边缘点数量之后，我们有一个表示纹理方向的未归一化直方图，我们通过将每个桶除以图像中边缘点的总数来对其进行归一化。

为了计算纹理比例直方图，对于每个边缘点，我们测量到具有相同方向的下一个最近边缘点的距离。例如，如果边缘点 A 的方向为 45 度，则算法会沿该方向行走，直到找到另一个方向为 45 度（或在合理偏差范围内）的边缘点。在计算每个边缘点的距离后，我们将这些值转储到直方图中，并通过除以边缘点的总数对其进行归一化。

现在每个图像都有 5 个直方图。要比较两个图像，您需要获取每个直方图桶之间差异的绝对值，然后将这些值相加。例如，为了比较图像 A 和 B，我们将计算

```
|A.green_histogram.bucket_1 - B.green_histogram.bucket_1| 
```

对于绿色直方图中的每个桶，对其他直方图重复，然后总结所有结果。结果越小，匹配越好。对数据库中的所有图像重复，结果最小的匹配获胜。您可能希望有一个阈值，超过该阈值算法得出未找到匹配的结论。

* * *

**第三选择 - 关键点 + 决策树**

第三种可能比其他两种快得多的方法是使用[语义文本森林](http://jamie.shotton.org/work/publications/cvpr08.pdf)(PDF)。这涉及提取简单的关键点并使用集合决策树对图像进行分类。这比简单的 SIFT 关键点匹配要快，因为它避免了昂贵的匹配过程，而且关键点比 SIFT 简单得多，因此关键点提取要快得多。但是，它保留了 SIFT 方法对旋转、缩放和光照的不变性，这是直方图方法所缺乏的一个重要特征。

**更新**：

我的错误——Semantic Texton Forests 论文不是专门关于图像匹配，而是区域标签。进行匹配的原始论文是： [Keypoint Recognition using Randomized Trees](https://www.epfl.ch/labs/cvlab/wp-content/uploads/2018/08/LepetitF06a.pdf)。此外，以下论文继续发展这些想法并代表最先进的技术（c. 2010）：

*   [使用 Random Ferns 进行快速关键点识别](https://www.epfl.ch/labs/cvlab/wp-content/uploads/2018/08/OzuysalCLF10.pdf)- 比 Lepetit 06 更快且更具可扩展性
*   [~~简介：二进制鲁棒独立基本特征~~](https://www.cs.ubc.ca/~lowe/525/papers/calonder_eccv10.pdf)- 不太健壮但非常快 - 我认为这里的目标是在智能手机和其他手持设备上进行实时匹配

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2011-11-09T22:17:32.530

我知道的最好的方法是使用感知哈希。这种散列似乎有一个很好的开源实现，可在以下位置获得：

[http://phash.org/](http://phash.org/)

主要思想是通过识别原始图像文件中的显着特征并对这些特征的紧凑表示进行散列（而不是直接对图像数据进行散列），将每个图像缩减为一个小的散列码或“指纹”。这意味着误报率比简单的方法大大降低，例如将图像缩小为微小的指纹大小的图像并比较指纹。

phash 提供多种类型的哈希，可用于图像、音频或视频。

* * *

## 回答 #3

> 赞同：42
> 
> 时间：2013-12-01T20:21:32.513

*这篇文章是我解决方案的起点，这里有很多好主意，所以我想分享我的结果。主要的见解是，我找到了一种通过利用 phash 的速度来解决基于关键点的图像匹配缓慢的方法。*

对于一般解决方案，最好采用多种策略。每种算法都最适合某些类型的图像转换，您可以利用它。

在顶部，最快的算法；在底部最慢（虽然更准确）。如果在较快的级别上找到了良好的匹配，您可能会跳过较慢的级别。

*   基于文件哈希（md5、sha1 等）的精确重复项
*   重新缩放图像的感知散列（phash）
*   修改图像的基于特征 (SIFT)

我在使用 phash 时取得了很好的效果。对于重新缩放的图像，精度很好。它不适用于（感知）修改的图像（裁剪、旋转、镜像等）。为了处理散列速度，我们必须使用磁盘缓存/数据库来维护干草堆的散列。

phash 的真正好处是，一旦你建立了你的哈希数据库（对我来说大约是 1000 张图像/秒），搜索可以非常非常快，特别是当你可以将整个哈希数据库保存在内存中时。这是相当实用的，因为散列只有 8 个字节。

例如，如果您有 100 万张图像，则需要一个包含 100 万个 64 位哈希值 (8 MB) 的数组。在某些 CPU 上，这适合 L2/L3 缓存！在实际使用中，我看到 corei7 的比较速度超过 1 Giga-hamm/sec，这只是 CPU 的内存带宽问题。10 亿张图像数据库在 64 位 CPU（需要 8GB RAM）上是实用的，搜索不会超过 1 秒！

对于修改/裁剪的图像，看起来像 SIFT 这样的变换不变特征/关键点检测器是可行的方法。SIFT 会产生很好的关键点来检测裁剪/旋转/镜像等。但是与 phash 使用的汉明距离相比，描述符比较非常慢。这是一个主要限制。有很多比较要做，因为有最大的 IxJxK 描述符比较查找一个图像（I=num haystack 图像，J=每个 haystack 图像的目标关键点，K=每个针图像的目标关键点）。

为了解决速度问题，我尝试在每个找到的关键点周围使用 phash，使用特征大小/半径来确定子矩形。使这项工作顺利进行的技巧是增大/缩小半径以生成不同的子矩形级别（在针图像上）。通常第一级（未缩放）会匹配，但通常需要更多。我不是 100% 确定为什么会这样，但我可以想象它启用了太小而无法使用 phash 的功能（phash 将图像缩小到 32x32）。

另一个问题是 SIFT 不会最优地分布关键点。如果图像的某个部分有很多边缘，则关键点将聚集在那里，而您将不会在其他区域得到任何边缘。我在 OpenCV 中使用 GridAdaptedFeatureDetector 来改进分布。不确定哪种网格尺寸最好，我使用的是小网格（1x3 或 3x1，具体取决于图像方向）。

在特征检测之前，您可能希望将所有干草堆图像（和针）缩放到更小的尺寸（我沿最大尺寸使用 210 像素）。这将减少图像中的噪声（对于计算机视觉算法来说总是一个问题），还将检测器集中在更突出的特征上。

对于人的图像，您可以尝试人脸检测并使用它来确定要缩放到的图像大小和网格大小（例如，最大的人脸缩放为 100 像素）。特征检测器考虑了多个尺度级别（使用金字塔），但它使用的级别有一个限制（这当然是可调的）。

当关键点检测器返回的特征数量少于您想要的数量时，它可能工作得最好。例如，如果您要求 400 并获得 300 回来，那很好。如果您每次都返回 400，则可能必须忽略一些好的功能。

针图像的关键点可以比干草堆图像少，并且仍然可以获得良好的结果。添加更多并不一定会给您带来巨大的收益，例如在 J=400 和 K=40 的情况下，我的命中率约为 92%。在 J=400 和 K=400 的情况下，命中率仅上升到 96%。

我们可以利用汉明函数的极速来解决缩放、旋转、镜像等问题。可以使用多通道技术。在每次迭代中，变换子矩形，重新散列，并再次运行搜索功能。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2019-05-02T20:04:08.060

我的公司每月有大约**2400 万**张来自制造商的图像。我一直在寻找一种快速的解决方案，以确保我们上传到目录的图像是*新*图像。

我想说我已经在互联网上进行了广泛的搜索，试图找到一个理想的解决方案。我什至开发了自己的边缘检测算法。
我已经评估了多个模型的速度和准确性。我的图像具有白色背景，非常适用于 phashing。就像*redcalx*说的，我推荐 phash 或 ahash。**不要**使用 MD5 散列或任何其他加密散列。除非，您只想要精确的图像匹配。图像之间发生的任何调整大小或操作都会产生不同的哈希值。

对于 phash/ahash，请查看：[imagehash](https://pypi.org/project/ImageHash/)

我想通过发布我的代码和我的准确性来扩展 *redcalx'* 的帖子。

我做什么：

```
from PIL import Image
from PIL import ImageFilter
import imagehash

img1=Image.open(r"C:\yourlocation")
img2=Image.open(r"C:\yourlocation")
if img1.width<img2.width:
    img2=img2.resize((img1.width,img1.height))
else:
    img1=img1.resize((img2.width,img2.height))
img1=img1.filter(ImageFilter.BoxBlur(radius=3))
img2=img2.filter(ImageFilter.BoxBlur(radius=3))
phashvalue=imagehash.phash(img1)-imagehash.phash(img2)
ahashvalue=imagehash.average_hash(img1)-imagehash.average_hash(img2)
totalaccuracy=phashvalue+ahashvalue 
```

以下是我的一些结果：

```
item1  item2  totalsimilarity
desk1  desk1       3
desk1  phone1     22
chair1 desk1      17
phone1 chair1     34 
```

希望这可以帮助！

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-09T20:47:03.390

正如卡特曼指出的那样，您可以使用任何类型的哈希值来查找精确的重复项。

寻找近距离图像的一个起点可能是[这里](http://pdiff.sourceforge.net/)。这是 CG 公司用来检查修改后的图像是否仍然显示基本相同的场景的工具。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-06-11T21:22:11.020

我有一个想法，它可以工作，而且很可能很快。您可以对图像进行二次采样以说 80x60 分辨率或类似分辨率，并将其转换为灰度（二次采样后会更快）。处理要比较的两个图像。然后运行两个图像（查询图像和数据库中的每个图像）之间的归一化平方和，或者甚至更好的归一化互相关，如果两个图像相似，则响应更接近 1。然后，如果图像相似，您可以继续使用更复杂的技术来验证它是否是相同的图像。显然，该算法在数据库中的图像数量方面是线性的，因此即使在现代硬件上它的速度非常快，可以达到每秒 10000 张图像。如果您需要旋转不变性，则可以为这个小图像计算一个主要梯度，然后可以将整个坐标系旋转到规范方向，但这会慢一些。不，这里没有可缩放的不变性。

如果您想要更通用的东西或使用大型数据库（数百万张图像），那么您需要研究图像检索理论（过去 5 年出现了大量论文）。其他答案中有一些指示。但这可能是矫枉过正，建议直方图方法可以完成这项工作。虽然我认为许多不同的快速方法的组合会更好。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-11-05T13:04:01.037

我相信将图像的大小降低到几乎是图标大小，比如 48x48，然后转换为灰度，然后获取像素之间的差异或 Delta，应该可以很好地工作。因为我们比较的是像素颜色的变化，而不是实际的像素颜色，所以图像稍微亮一点还是暗一点都没有关系。大的变化很重要，因为太亮/太暗的像素会丢失。您可以将其应用于一行，或任意数量以提高准确性。最多你需要做 47x47=2,209 次减法来形成一个可比较的 Key。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-09T20:31:03.337

选择 100 个随机点可能意味着相似（或偶尔甚至不相似）的图像将被标记为相同，我认为这不是您想要的。如果图像格式不同（png、jpeg 等）、大小不同或元数据不同，则 MD5 哈希将不起作用。将所有图像缩小到较小的尺寸是一个不错的选择，只要您使用良好的图像库/快速语言并且尺寸足够小，进行逐像素比较不应该花费太长时间。

您可以尝试使它们变小，然后如果它们相同，则在更大的尺寸上进行另一次比较-可能是速度和准确性的良好结合...

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-09T20:26:42.893

如果您有大量图像，请查看[Bloom filter](http://en.wikipedia.org/wiki/Bloom_filter)，它使用多个散列来获得概率但有效的结果。如果图像的数量不是很大，那么像 md5 这样的加密哈希就足够了。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-04-15T01:53:49.927

我们松散地称为重复的东西对于算法来说很难辨别。您的重复项可以是：

1.  精确重复
2.  近乎精确的重复。（图像等的小幅编辑）
3.  感知重复（相同的内容，但不同的视图、相机等）

No1 和 2 更容易解决。No 3\. 非常主观，仍然是一个研究课题。我可以为 No1 和 2 提供一个解决方案。两种解决方案都使用了优秀的图像散列库：[https ://github.com/JohannesBuchner/imagehash](https://github.com/JohannesBuchner/imagehash)

1.  精确重复 可以使用感知散列测量找到精确重复。phash 库在这方面做得很好。我经常用它来清理训练数据。用法（来自 github 站点）很简单：

```
from PIL import Image
import imagehash

# image_fns : List of training image files
img_hashes = {}

for img_fn in sorted(image_fns):
    hash = imagehash.average_hash(Image.open(image_fn))
    if hash in img_hashes:
        print( '{} duplicate of {}'.format(image_fn, img_hashes[hash]) )
    else:
        img_hashes[hash] = image_fn 
```

2.  Near-Exact Duplicates 在这种情况下，您必须设置一个阈值并比较散列值之间的距离。这必须通过对图像内容的反复试验来完成。

```
from PIL import Image
import imagehash

# image_fns : List of training image files
img_hashes = {}
epsilon = 50

for img_fn1, img_fn2 in zip(image_fns, image_fns[::-1]):
    if image_fn1 == image_fn2:
        continue

    hash1 = imagehash.average_hash(Image.open(image_fn1))
    hash2 = imagehash.average_hash(Image.open(image_fn2))
    if hash1 - hash2 < epsilon:
        print( '{} is near duplicate of {}'.format(image_fn1, image_fn2) ) 
```

# apache-flex - 如何从 ActionScript 中具有相同名称的类中引用全局类？

> ID：843981
> 
> 赞同：0
> 
> 时间：2009-05-09T20:22:31.267
> 
> 标签：apache-flex, actionscript-3

由于我无法控制的要求（不要问，这很荒谬），我需要创建一个名为“Math”的 AS3 类，它引用 Global AS Math 类。因此，例如：

```
package my.package
{
    public class Math
    {
        public static function pow( a:Number, b:Number ):Number {
            // How do I call the Global.as$Math#pow(..) function?
            return Math.pow(a,b);  
        }
    }
} 
```

上面的代码显然是错误的——导致无限递归。我不知道怎么说我想委托给 Global.as$Math 类而不是这个 Math 类......

我目前尴尬的解决方案是委托给另一个传递给全局数学类的类（未命名为数学）。有一个更好的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T14:14:10.077

在阅读 Josh Tynjala关于 actionscript 中的包如何只是名称空间上的抽象层的[帖子后，我想到了另一种方式：](http://joshblog.net/2009/05/13/packages-are-actually-namespaces-in-actionscript-3/)

```
public class Math
{
        namespace globalNs = "";  
        public static function pow( a:Number, b:Number ):Number 
        {
            return globalNs::Math.pow(a, b);  
        }

} 
```

globalNs::Math.pow 明确引用顶级数学类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T13:09:04.787

保存对 Flash 播放器数学对象的静态引用，并在您的静态方法中使用它：

```
package test 
```

{ 导入 flash.utils.getDefinitionByName;

```
public class Math
{
        private static var _flashMath:Class = Class(getDefinitionByName("Math"));  
        public static function pow( a:Number, b:Number ):Number 
        {
            return _flashMath.pow(a, b);  
        }

} 
```

}

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T20:27:12.377

尝试使用[AS3 命名空间](http://livedocs.adobe.com/flex/201/html/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Book_Parts&file=04_OO_Programming_161_11.html)来引用 AS3 Math 对象。或者您的类可以简单地扩展 Math 对象，它会自动拥有 Math 对象的所有功能，而无需您重写所有这些包装函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T21:15:22.277

作为对 apphackers 回复的一个小型跟进，您不能简单地扩展 AS3 Math 对象并拥有它所建议的所有功能。静态方法在扩展对象时会丢失，因为它们静态绑定到定义它们的对象。此外，您不能扩展具有相同名称的类。但是，您可能在命名空间解决方案方面取得了一些成功，尽管我不确定它是否适用于静态方法，但我很想看看您的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-09T22:21:27.313

数学是 AS3 中的一个特例，因为它实际上不应该是全局的，但它确实是。所以据我所知，它没有命名空间。您提出的通过另一个类路由的解决方案实际上非常聪明。但是您知道，真正的解决方案是将类命名为 Math2 或 MathHelper 或 MathUtils 而不是 Math。请告诉我你无法控制的原因是什么！不知道杀了我！！！

# c# - 如何编写正则表达式来捕获没有链接文本的链接？

> ID：843993
> 
> 赞同：1
> 
> 时间：2009-05-09T20:27:47.227
> 
> 标签：c#, .net, regex

如何编写正则表达式来替换没有链接文本的链接，如下所示：

```
<a href="http://www.somesite.com"></a> 
```

和

```
<a href="http://www.somesite.com">http://www.somesite.com</a> 
```

?

这就是我试图捕捉比赛的方法，但它没有捕捉到任何比赛。我究竟做错了什么？

```
string pattern = "<a\\s+href\\s*=\\s*\"(?<href>.*)\">\\s*</a>"; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-09T20:48:08.677

我不会使用正则表达式 - 我会使用[Html Agility Pack](http://www.codeplex.com/htmlagilitypack)和如下查询：

```
foreach(HtmlNode link in doc.DocumentElement.SelectNodes("//a[.='']")) {
    link.InnerText = link.GetAttribute("href");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T20:34:11.033

我可能是错的，但我认为您只需将`href`组内的量词更改为懒惰而不是贪婪。

```
string pattern = @"<a\s+href\s*=\s*""(?<href>.*?)"">\s*</a>"; 
```

（为了更好的可读性，我还更改了字符串文字的类型以使用 @。）

正则表达式的其余部分对我来说*似乎*很好。您根本没有捕获任何匹配项让我不这么认为，但其余代码（甚至输入数据 - 您是否验证过？）可能存在问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-09T20:34:19.613

我会建议

```
string pattern = "(<a\\b[^>]*href=\"([^\"]+)\"[^>]*>)[\\s\\r\\n]*(</a>)"; 
```

这种方式还可以捕获与它们在`href`其他地方的属性的链接。

用。。。来代替

```
"$1$2$3" 
```

通常的警告词：HTML 和正则表达式本质上是不兼容的。小心使用，这可能会爆炸。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T21:20:52.700

[Marc Gravell](https://stackoverflow.com/questions/843993/how-can-i-write-a-regular-expression-to-capture-links-with-no-link-text/844032#844032)有正确的答案，正则表达式根本不擅长解析 HTML（请参阅[Can you provide some examples of why it is hard to parse XML and HTML with a regex?](https://stackoverflow.com/questions/701166) for why）。请参阅[您能否提供一个使用您最喜欢的解析器解析 HTML 的示例？](https://stackoverflow.com/questions/773340)对于使用各种解析器的示例。

# c++ - 通过引用传递 C++ 迭代器有什么问题？

> ID：843996
> 
> 赞同：46
> 
> 时间：2009-05-09T20:31:20.400
> 
> 标签：c++, pass-by-reference, iterator

我用这样的原型编写了一些函数：

```
template <typename input_iterator>
int parse_integer(input_iterator &begin, input_iterator end); 
```

这个想法是调用者将提供一系列字符，并且该函数会将字符解释为整数值并返回它，`begin`在最后使用的字符之后留下一个。例如：

```
std::string sample_text("123 foo bar");
std::string::const_iterator p(sample_text.begin());
std::string::const_iterator end(sample_text.end());
int i = parse_integer(p, end); 
```

这将`i`设置为 123 并`p`“指向”之前的空间`foo`。

从那以后我被告知（没有解释）通过引用传递迭代器是不好的形式。是不是形式不好？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-09T21:12:12.143

没有什么真正的错误，但它肯定会限制模板的使用。您将不能只放置由其他东西返回或生成的迭代器`v.begin()`，因为它们将是临时的。您将始终首先必须制作本地副本，这是某种不太好的样板。

一种方法是重载它：

```
int parse_integer(input_iterator begin, input_iterator end, 
                  input_iterator &newbegin);

template<typename input_iterator>
int parse_integer(input_iterator begin, input_iterator end) {
    return parse_integer(begin, end, begin);
} 
```

另一种选择是有一个输出迭代器，其中数字将被写入：

```
template<typename input_iterator, typename output_iterator>
input_iterator parse_integer(input_iterator begin, input_iterator end,
                             output_iterator out); 
```

您将有返回值来返回新的输入迭代器。然后，如果您已经知道数字的数量，您可以使用插入器迭代器将解析后的数字放入向量或指针中，以将它们直接放入整数或数组中。

```
int i;
b = parse_integer(b, end, &i);

std::vector<int> numbers;
b = parse_integer(b, end, std::back_inserter(numbers)); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-09T20:35:12.373

**一般来说：**

如果传递非`const`引用，调用者不知道迭代器是否正在被修改。

您可以传递`const`引用，但通常迭代器足够小，与按值传递相比没有优势。

**在你的情况下：**

我不认为你所做的有什么问题，只是它在迭代器的使用方面并不太标准。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-09T20:46:57.807

当他们说“不要通过引用传递”时，这可能是因为将迭代器作为值参数传递更正常/惯用，而不是通过 const 引用传递它们：你为第二个参数所做的。

然而，在这个例子中，您需要返回两个值：解析的 int 值和新的/修改的迭代器值；并且鉴于一个函数不能有两个返回码，将其中一个返回码编码为非常量引用是 IMO 正常的。

另一种方法是将其编码如下：

```
//Comment: the return code is a pair of values, i.e. the parsed int and etc ...
pair<int, input_iterator> parse(input_iterator start, input_iterator end)
{
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-09T22:10:24.407

在我看来，如果你想这样做，参数应该是一个指向你将要改变的迭代器的指针。我不是非常量引用参数的忠实粉丝，因为它们隐藏了传递的参数可能会更改的事实。我知道有很多 C++ 用户不同意我对此的看法——这很好。

但是，在这种情况下，将迭代器视为值参数是*很常见的，我认为通过非常量引用传递迭代器并修改传递的迭代器是一个特别糟糕的主意。*它只是违背了通常使用迭代器的惯用方式。

由于有一种很好的方法可以做你想做的没有这个问题的事情，我认为你应该使用它：

```
template <typename input_iterator>
int parse_integer(input_iterator* begin, input_iterator end); 
```

现在来电者必须这样做：

```
int i = parse_integer(&p, end); 
```

很明显，迭代器是可以改变的。

顺便说一句，我也喜欢[litb 的建议](https://stackoverflow.com/questions/843996/whats-wrong-with-passing-c-iterator-by-reference/844078#844078)，即返回新的迭代器并将解析的值放入输出迭代器指定的位置。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-12-20T16:51:58.020

在这种情况下，我认为通过引用传递迭代器是完全明智的，只要它有据可查。

值得注意的是，您的方法（通过引用传递迭代器以跟踪您在标记流时的位置）正是[boost::tokenizer](http://www.boost.org/doc/libs/1_48_0/libs/tokenizer/index.html)采用的方法。特别是，请参阅[TokenizerFunction 概念](http://www.boost.org/doc/libs/1_48_0/libs/tokenizer/tokenizerfunction.htm)的定义。总的来说，我发现 boost::tokenizer 设计得非常好并且经过深思熟虑。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-09T20:46:16.747

我认为标准库算法仅按值传递迭代器（现在有人会发布一个明显的例外）——这可能是这个想法的起源。当然，没有什么说你自己的代码必须看起来像标准库！

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-09T20:39:04.703

您的函数声明的第二个参数缺少引用，是吗？

无论如何，回到你的问题：不，我从来没有读过任何说你不应该通过引用传递迭代器的东西。引用的问题在于它们允许您更改引用的对象。在这种情况下，如果您要更改迭代器，您可能会在该点之外搞砸整个序列，从而使进一步的处理变得不可能。

只有一个建议：仔细输入您的参数。

# java - Java中的CSV解析 - 工作示例..？

> ID：843997
> 
> 赞同：19
> 
> 时间：2009-05-09T20:32:16.937
> 
> 标签：java, csv

我想为一个学校的 java 项目编写一个程序来解析一些我不知道的 CSV。我确实知道每列的数据类型——尽管我不知道分隔符。

我什至不知道如何解决的问题是解析日期甚至日期时间列。它们可以是多种格式之一。

我找到了很多库，但不知道哪个最适合我的需要： [http://opencsv.sourceforge.net/](http://opencsv.sourceforge.net/) [http://www.csvreader.com/java_csv.php](http://www.csvreader.com/java_csv.php) [http://supercsv.sourceforge.net/](http://supercsv.sourceforge.net/) [http ://flatpack.sourceforge.net/](http://flatpack.sourceforge.net/)

问题是我是一个完全的java初学者。恐怕这些图书馆都不能做我需要的事情，或者我无法说服他们去做。

我敢打赌这里有很多人有代码示例，可以让我立即开始我需要的东西：

*   自动拆分为列（分隔符未知，列类型已知）
*   强制转换为 Columntype（应处理 $、% 等）
*   将日期转换为 Java 日期或日历对象

最好通过电子邮件获得尽可能多的代码示例。

非常感谢！作为

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-09T22:15:27.483

您还拥有[Apache Commons CSV](http://commons.apache.org/proper/commons-csv/)库，也许它可以满足您的需求。请参阅[指南](http://commons.apache.org/proper/commons-csv/user-guide.html)。于 2014-11 更新至 1.1 版。

另外，对于万无一失的版本，我认为您需要自己编写代码...通过[`SimpleDateFormat`](http://java.sun.com/javase/6/docs/api/java/text/SimpleDateFormat.html)您可以选择格式并指定各种类型，如果与`Date`您预先考虑的类型不同，则不是一个约会。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-12-01T01:58:43.103

使用有严重问题

```
String[] strArr=line.split(","); 
```

为了解析 CSV 文件，这是因为数据值中可以有逗号，在这种情况下，您必须引用它们，并忽略引号之间的逗号。

有一个非常非常简单的方法来解析这个：

```
/**
* returns a row of values as a list
* returns null if you are past the end of the input stream
*/
public static List<String> parseLine(Reader r) throws Exception {
    int ch = r.read();
    while (ch == '\r') {
        //ignore linefeed chars wherever, particularly just before end of file
        ch = r.read();
    }
    if (ch<0) {
        return null;
    }
    Vector<String> store = new Vector<String>();
    StringBuffer curVal = new StringBuffer();
    boolean inquotes = false;
    boolean started = false;
    while (ch>=0) {
        if (inquotes) {
            started=true;
            if (ch == '\"') {
                inquotes = false;
            }
            else {
                curVal.append((char)ch);
            }
        }
        else {
            if (ch == '\"') {
                inquotes = true;
                if (started) {
                    // if this is the second quote in a value, add a quote
                    // this is for the double quote in the middle of a value
                    curVal.append('\"');
                }
            }
            else if (ch == ',') {
                store.add(curVal.toString());
                curVal = new StringBuffer();
                started = false;
            }
            else if (ch == '\r') {
                //ignore LF characters
            }
            else if (ch == '\n') {
                //end of a line, break out
                break;
            }
            else {
                curVal.append((char)ch);
            }
        }
        ch = r.read();
    }
    store.add(curVal.toString());
    return store;
} 
```

这种方法有很多优点。请注意，每个字符都被触摸一次。没有提前读取，推回缓冲区等。没有提前搜索到行尾，然后在解析之前复制该行。此解析器纯粹从流中工作，并创建每个字符串值一次。它适用于标题行和数据行，您只需处理适合的返回列表。您给它一个阅读器，因此基础流已使用您选择的任何编码转换为字符。流可以来自任何来源：文件、HTTP 发布、HTTP 获取，您可以直接解析流。这是一个静态方法，所以没有要创建和配置的对象，当它返回时，没有内存被占用。

您可以在我的博客文章中找到有关此代码的完整讨论，以及为什么首选这种方法： [CSV 文件所需的唯一类](http://agiletribe.wordpress.com/2012/11/23/the-only-class-you-need-for-csv-files/)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-10T13:19:00.363

我的方法*不是*从编写自己的 API 开始。生命太短暂，还有更多紧迫的问题需要解决。在这种情况下，我通常：

*   找到一个看起来可以做我想做的事的图书馆。如果不存在，*则*执行它。
*   如果确实存在一个库，但我不确定它是否适合我的需要，请围绕它编写一个精简的适配器 API，以便我可以控制它的调用方式。适配器 API 表达了*我*需要的 API，并将这些调用映射到底层 API。
*   如果该库不适合，我可以在不影响调用者的情况下以最少的努力在适配器 API 下交换另一个库（无论是另一个开源库还是我自己编写的库）。

从某人已经写过的东西开始。很可能，它会做你想做的事。如有必要，您以后可以随时编写自己的。OpenCSV 是一个很好的起点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-09T22:06:25.197

大约 5 年前，我不得不使用 csv 解析器。似乎至少有两个 csv 标准：[http](http://en.wikipedia.org/wiki/Comma-separated_values) ://en.wikipedia.org/wiki/Comma-separated_values以及微软在 excel 中所做的事情。

我发现了这个同时吃的 libaray：http: [//ostermiller.org/utils/CSV.html](http://ostermiller.org/utils/CSV.html)，但是 afaik，它无法推断列是什么数据类型。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-09T21:28:44.303

您可能想查看[此 CSV 规范](http://www.creativyst.com/Doc/Articles/CSV/CSV01.htm)。请记住，没有官方认可的规范。

如果您现在不使用分隔符，则无法执行此操作，因此您必须以某种方式找出。如果您可以手动检查文件，您应该能够很快看到它是什么并在您的程序中对其进行硬编码。如果分隔符可以改变，您唯一的希望是能够从已知数据的格式中推断出。当 Excel 导入 CSV 文件时，它允许用户选择分隔符，这也是您可以使用的解决方案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-12-08T15:19:40.870

我同意@Brian Clapper。尽管结果好坏参半，但我使用 SuperCSV 作为解析器。我喜欢它的多功能性，但是在我自己的 csv 文件中存在一些我“还”无法协调的情况。我对这个产品有信心，并且会整体推荐它——我只是缺少一些简单的东西，毫无疑问，我在自己的实现中正在做的事情。

SuperCSV 可以将列解析为各种格式，对列进行编辑等，值得一看。它也有示例，并且易于理解。

我遇到的一个/唯一限制是捕获一个“空”列并将其解析为整数或空白等。我收到空指针错误，但 javadocs 建议每个 cellProcessor 首先检查空值。所以，我先责备自己，现在。:-)

无论如何，看看 SuperCSV。 [http://supercsv.sourceforge.net/](http://supercsv.sourceforge.net/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-09T20:38:05.690

您至少需要知道列分隔符。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-09T21:11:46.170

基本上你需要逐行读取文件。

然后你需要用分隔符分割每一行，比如逗号（CSV代表逗号分隔值），用

```
String[] strArr=line.split(","); 
```

这会将它变成一个字符串数组，然后您可以对其进行操作，例如使用

```
String name=strArr[0];
int yearOfBirth = Integer.valueOf(strArr[1]);
int monthOfBirth = Integer.valueOf(strArr[2]);
int dayOfBirth = Integer.valueOf(strArr[3]);
GregorianCalendar dob=new GregorianCalendar(yearOfBirth, monthOfBirth, dayOfBirth);
Student student=new Student(name, dob); //lets pretend you are creating instances of Student 
```

您需要对每一行都执行此操作，因此将此代码包装到 while 循环中。（如果您不知道分隔符，只需在文本编辑器中打开文件。）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-10T06:39:41.530

我建议您首先将您的任务分解为它的组成部分。

1.  从 CSV 读取字符串数据
2.  将字符串数据转换为适当的格式

一旦你这样做了，使用你链接到的库之一应该是相当简单的（它肯定会处理任务#1）。然后遍历返回的值，并将每个 String 值转换/转换为您想要的值。

如果问题是如何将字符串转换为不同的对象，这将取决于您开始使用的格式以及您想要结束的格式。

例如，DateFormat.parse() 将从字符串中解析日期。请参阅 SimpleDateFormat 以快速构建特定字符串表示的 DateFormat。Integer.parseInt() 将从字符串中解析整数。

货币，您必须决定如何获取它。如果您只想捕获为浮点数，那么 Float.parseFloat() 将起到作用（只需在解析之前使用 String.replace() 删除所有 $ 和逗号）。或者您可以解析为 BigDecimal （因此您没有舍入问题）。可能有更好的货币处理类（我没有做太多，所以不熟悉 JDK 的那个领域）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-08-09T18:46:56.670

编写自己的解析器很有趣，但您可能应该看看 [Open CSV](http://opencsv.sourceforge.net/#what-is-opencsv)。它提供了多种访问 CSV 的方法，还允许生成 CSV。它*确实可以*正确处理转义。如另一篇文章所述，Apache Commons 中还有一个 CSV 解析库，但尚未发布。

# iphone - sqlite3_enable_shared_cache 和 sqlite_backup_init 在 iPhone 上减慢执行速度

> ID：843998
> 
> 赞同：0
> 
> 时间：2009-05-09T20:32:33.330
> 
> 标签：iphone, sql, performance, sqlite

我在我的 iPhone 应用程序中运行了一些相对复杂的 sqlite 查询，有些查询花费了太多时间（超过 15 秒）。数据库中只有 430 条左右的记录。我注意到的一件事是打开一个新的数据库连接（我只做一次）并单步执行查询结果（使用`sqlite3_step()`）导致`sqlite3_backup_init()`并`sqlite3_enable_shared_cache()`运行，在整个测试期间分别需要 4450 毫秒和 3720 毫秒的处理时间。我尝试`sqlite3_enable_shared_cache(0);`在打开数据库连接之前使用禁用共享缓存，但这似乎没有效果。

有谁知道如何禁用这些，以便我可以提高某种速度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T20:51:19.993

好吧，我想这并不能直接回答这个问题，但部分问题是我使用了交叉连接而不是左连接。这将查询时间从大约 4000 毫秒减少到 60 毫秒。此外，该`backup_init`函数不再被调用并且`enable_shared_cache`不会旋转太多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-06T20:54:39.490

我通过用左连接替换内部连接来修复我的应用程序。我的数据允许。如果您的数据不允许考虑添加 where 子句

苹果 a 内连接香蕉 b 上 b.id=a.id

对比

apples a left join bananas b on b.id=a.id where b.id is not null**********