# StackOverflow 问答 11997000-11997999

# asp.net-4.0 - 替换 Cambro dbcombo 控件

> ID：11997003
> 
> 赞同：0
> 
> 时间：2012-08-16T23:46:25.240
> 
> 标签：asp.net-4.0

我需要一个可以在 ASP.Net 4 上运行的 Cambro.Web.DbControl 版本，或者一个可以从数据库中提取与在控件中键入的用户匹配的记录并填充下拉列表的 Web 控件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T12:33:52.230

您可以使用**Telerik RadControl (ComboBox)**来满足您的要求：

[按需加载的 ComboBox 演示](http://demos.telerik.com/aspnet-ajax/combobox/examples/populatingwithdata/autocompletesql/defaultcs.aspx)

[LoadOnDemand 概述](http://www.telerik.com/help/aspnet-ajax/combobox-load-on-demand-overview.html)

[自动 LoadOnDemand 概述](http://www.telerik.com/help/aspnet-ajax/combobox-automatic-load-on-demand.html)

# android - 将垂直彩色线条添加到搜索栏背景可绘制对象

> ID：11997005
> 
> 赞同：3
> 
> 时间：2012-08-16T23:46:32.217
> 
> 标签：android, seekbar

如何将单个垂直彩色线动态添加到搜索栏的进度条？

我已经将progress.xml、progress_fill.xml 和background_fill 文件创建为单独的drawables，允许我在某种程度上自定义我的seekbar。但是，根据情况，可能需要在搜索栏上的任何位置以多种不同的颜色绘制各个垂直线。它们不能在 XML 布局文件中设置。

我想我需要以编程方式将小彩色矩形写入 background_fill.xml 可绘制对象（我的 progress_fill 已设置为大部分透明）。

如何以编程方式将这些小矩形写入我的 background_fill.xml 可绘制对象？

我在 TextView 中做了类似的事情，因为我使用 SpannableStringBuilder 和 ImageSpan 将小矩形写入 TextView。但我不认为这可用于搜索栏小部件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T14:55:35.123

Did this by extending the SeekBar widget. Two steps: first, create a new class called CustomSeekBar to extend the SeekBar:

```
package com.example.seekbar;

class CustomSeekBar extends SeekBar {

public CustomSeekBar(Context context) {
    super(context);
}

public CustomSeekBar(Context context, AttributeSet attrs) {
    super(context, attrs);
}

public CustomSeekBar(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
}

protected void onDraw(Canvas canvas) {

    super.onDraw(canvas);

    private Paint paintRect = new Paint();
    paintRect.setColor(Color.rgb(142, 196, 0));

    private Rect audioRect = new Rect();
    audioRect.set(5, 7, 4, 18);

    canvas.drawRect(audioRect, paintRect);
}
} 
```

Second, reference this CustomSeekBar in the layout xml file as:

```
 <view class="com.example.seekbar.CustomSeekBar"
    android:id="@+id/seekBar0"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_margin="10dp" /> 
```

# matlab - Cellfun：如何对矩阵单元数组中的每一行求和？MATLAB

> ID：11997009
> 
> 赞同：0
> 
> 时间：2012-08-16T23:47:29.233
> 
> 标签：matlab, sum, cells

假设我有 3x3 个单元格，每个单元格包含一个 9x9 的矩阵，我将如何使用 cellfun 对整个单元格数组的每一行求和？

当我尝试在大括号中使用 : 时，我不断收到错误“错误的单元格引用”。

我宁愿不将其转换为矩阵，然后再次转换回单元格。

非常感谢你们的智慧！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T00:09:49.480

如果您的意思是对每个单元格条目中的每一行求和，那么您可以执行以下操作：

```
% random input
A = cell(3,3);
for i=1:9
    A{i} = randi(9,3,3);
end;

B = cellfun(@(x) sum(x, 2), A, 'UniformOutput', false); 
```

**更新：**要对单元格数组中的所有行求和，就好像它是一个矩阵一样，而不转换为矩阵，将上述修改为：

```
B = num2cell(zeros(3, 1)); % initialize
for i=1:3
    B = cellfun(@plus, B, A(:,i), 'UniformOutput', false); % add column-wise
end
B = cellfun(@(x) sum(x, 2), B, 'UniformOutput', false); % add within each remaning cell 
```

这将给出一个数组`3x1`单元格，`3x1`其中包含跨行的总和。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T00:24:23.973

这是将每个矩阵的行与一个单元格相加的解决方案，如果您`cellfun`仔细阅读文档，我认为您应该能够得到它。

```
clc;
clear all;
a=cell(3,3);
for i=1:3
    for j=1:3
        a{i,j}=randi(10,[9 9]);
    end
end

row_sum_cell=cellfun(@(a) sum(a,2),a,'UniformOutput',false); 
```

以下解决方案对元胞数组中的整行求和：

```
clc;
clear all;
a=cell(3,3);
for i=1:3
    for j=1:3
        a{i,j}=randi(10,[9 9]);   %generating the cell array
    end
end

[r,c]=size(a);          %getting the size of the array to concatenate it at runtime
horzCat_A=cell(r,1);

for i=1:r
    for j=1:c
        horzCat_A{i,1}=[horzCat_A{i,1} a{i,j}];    %concatenating
    end
end

%after getting a concatenated matrix, apply a cellfun same as in previous example.
cell_row_sum=cellfun(@(horzCat_A) sum(horzCat_A,2),horzCat_A,'UniformOutput',false); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T07:12:21.653

另一种选择是使用[cell2mat](http://www.mathworks.nl/help/techdoc/ref/cell2mat.html)和[num2cell](http://www.mathworks.nl/help/techdoc/ref/num2cell.html)：

```
a=num2cell(randi(10,3)); % random input generation

result = num2cell(sum(cell2mat(a),2)); 
```

下一个问题是：为什么要使用标量单元矩阵？你不能只使用一个普通的矩阵（你可以使用 获得`cell2mat`）吗？

# mysql - MySQL：无法创建/写入文件'/tmp/#sql_3c6_0.MYI'（Errcode：2） - 它甚至意味着什么？

> ID：11997012
> 
> 赞同：44
> 
> 时间：2012-08-16T23:47:38.677
> 
> 标签：mysql, exception, jdbc

出于某种原因，我的生产数据库决定喷出这条消息。所有应用程序调用都失败到数据库并出现以下错误：

```
PreparedStatementCallback; SQL [ /*long sql statement here*/ ]; 
Can't create/write to file '/tmp/#sql_3c6_0.MYI' (Errcode: 2); 
nested exception is java.sql.SQLException: Can't create/write to file '/tmp/#sql_3c6_0.MYI' (Errcode: 2) 
```

我不知道，这甚至意味着什么。没有文件`#sql_3c6_0.MYI`，由于某种原因`/tmp`，我无法创建带有角色的文件。`#`有没有人听说过或看到过这个错误？可能有什么问题以及需要注意的一些事情？

MySQL DB 似乎已启动并正在运行，可以通过控制台查询，但应用程序似乎无法访问它。应用程序代码/文件没有变化。它只是突然发生了。所以我什至不确定从哪里开始寻找或应用什么解决策略。有任何想法吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-02T16:15:49.933

当我在我的 Fedora 系统上运行 wordpress 时，我也遇到了这个错误。

我用谷歌搜索了它，并找到了解决此问题的方法。

也许这对你也有帮助。

1.  检查mysql配置：my.cnf

    ```
     cat /etc/my.cnf | grep tmpdir 
    ```

    我看不到任何东西`my.cnf`

2.  添加`tmpdir=/tmp`到`my.cnf`下`[mysqld]`

3.  重启 web/app 和 mysql 服务器

    `/etc/init.d/mysqld restart`

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-08-17T00:18:25.983

这通常意味着您的`/tmp`分区已用完空间并且无法创建文件，或者`mysqld`由于权限问题，该进程无法写入该目录。`selinux`有时，当你的游行下雨时就是这种情况。

默认情况下，任何需要“临时文件”的操作都将进入该`/tmp`目录。您看到的名称只是一些内部随机名称。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-01-22T09:58:00.260

在带有 systemd 的 Fedora 上，MySQL 获取私有 /tmp 目录。在 /proc/PID_of_MySQL/mountinfo 中，您会发现如下行：

> 156 129 8:1 /tmp/systemd-namespace-AN7vo9/private /tmp rw,relatime - ext4 /dev/sda1 rw,seclabel,data=ordered

这意味着一个临时文件夹 /tmp/systemd-namespace-AN7vo9/private 作为 /tmp 挂载在 MySQL 进程的私有命名空间中。**不幸的是，如果不经常使用，tmpwatch 会删除此文件夹。**

我修改了 /etc/cron.daily/tmpwatch 并像这样插入了排除模式`-X '/tmp/systemd-namespace*'`：

```
/usr/sbin/tmpwatch "$flags" -x /tmp/.X11-unix -x /tmp/.XIM-unix \
        -x /tmp/.font-unix -x /tmp/.ICE-unix -x /tmp/.Test-unix \
        -X '/tmp/systemd-namespace*' \
        -X '/tmp/hsperfdata_*' 10d /tmp 
```

副作用是未使用的私有命名空间文件夹不会被自动删除。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-03-07T07:14:04.907

非常感谢 ArturZ 为我指明了正确的方向。我的系统上没有安装 tmpwatch，所以这不是我的问题的原因。但最终结果是一样的：systemd 创建的私有 /tmp 被删除。这是发生的事情：

1.  systemd 通过带有 CLONE_NEWNS 标志的 clone() 创建一个新进程以获得私有命名空间。或者它用 CLONE_NEWNS 调用 unshare()。一样。

2.  systemd 在 /tmp 中创建一个子目录（例如 /tmp/systemd-namespace-XRiWad/private）并将其安装在 /tmp 上。因为 CLONE_NEWNS 是在 #1 中设置的，所以这个挂载点对所有其他进程都是不可见的。

3.  systemd 然后在这个私有命名空间中调用 mysqld。

4.  一些特定的数据库操作（例如“describe ;”）创建和删除临时文件，其副作用是更新 /tmp/systemd-namespace-XRiWad/private 上的时间戳。其他数据库操作根本不使用 /tmp 来执行。

5.  最终 10 天过去了，即使数据库本身仍然处于活动状态，也不会发生更新 /tmp/systemd-namespace-XRiWad/private 上的时间戳的操作。

6.  /bin/systemd-tmpfiles 出现并删除了“旧” /tmp/systemd-namespace-XRiWad/private 目录，有效地使私有 /tmp 无法用于 mysqld，而公共 /tmp 仍然可用于系统上的所有其他内容。

重新启动 mysqld 可以正常工作，因为这会在第 1 步重新启动所有内容，并使用全新的私有 /tmp 目录。然而，问题最终又回来了。然后再次。

简单的解决方案是配置 /bin/systemd-tmpfiles 以便它保留 /tmp 中名称为 /tmp/systemd-namespace-* 的任何内容。我通过使用以下内容创建 /etc/tmpfiles.d/privatetmp.conf 来做到这一点：

```
x   /tmp/systemd-namespace-*
x   /tmp/systemd-namespace-*/private 
```

问题解决了。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2012-11-02T16:55:11.947

文件名看起来像一个由 MySQL 中的查询创建的临时表。这些文件的寿命通常很短，它们是在一个特定查询期间创建的，然后立即清理。

然而，它们可能会变得非常大，具体取决于查询需要在临时表中处理的数据量。或者您可能有多个并发查询创建临时表，如果同时运行足够多的这些查询，它们可能会耗尽磁盘空间。

我做 MySQL 咨询，我帮助了一个客户，他的根分区出现间歇性磁盘已满错误，即使他每次查看，他都有大约 6GB 的可用空间。在我们检查了他的查询日志后，我们发现他有时会同时运行四个或更多查询，每个查询都会在 /tmp 中创建一个 1.5GB 的临时表，该表位于他的根分区上。繁荣！

我给他的解决方案：

*   增加 MySQL 配置变量`tmp_table_size`，`max_heap_table_size`以便 MySQL 可以在内存中创建非常大的临时表。但是允许 MySQL 在内存中创建 1.5GB 的临时表并不是一个好主意，因为没有办法限制同时创建的临时表的数量。通过这种方式，您可以很快耗尽您的记忆。

*   将 MySQL 配置变量设置为`tmpdir`另一个具有更多空间的磁盘分区上的目录。

*   找出您的哪些查询正在创建如此大的临时表，并优化查询。例如，使用索引来帮助该查询减少对表的较小部分的扫描。或者存档故事中的一些数据，这样查询就没有太多要扫描的行了。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-07-19T12:33:54.830

对我来说，这个问题是在长时间不使用 mysql 和网络服务器之后出现的。所以我确信我的设置是正确的；只需重新启动服务即可解决此问题；关于这个问题的奇怪部分是仍然可以连接到数据库，甚至可以使用 mysql 工具查询/添加表。例如 ：

```
mysql -u root -p 
```

我重新开始使用：

```
systemctl start mysqld.service 
```

或 service mysqld restart 或 /etc/init.d/mysqld restart

注意：根据这些命令中的机器/环境，应该重新启动服务。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-04-17T17:54:48.147

一种更好的方法对我有用。

```
 chown root:root /tmp
  chmod 1777 /tmp
  /etc/init.d/mysqld restart 
```

这就对了。

见这里： http: [//nixcraft.com/databases-servers/14260-error-1-hy000-cant-create-write-file-tmp-sql_9f3_0-myi-errcode-13-a.html](http://nixcraft.com/databases-servers/14260-error-1-hy000-cant-create-write-file-tmp-sql_9f3_0-myi-errcode-13-a.html)

[http://smashingweb.info/solved-mysql-tmp-error-cant-createwrite-to-file-tmpmykbo3bl-errcode-13/](http://smashingweb.info/solved-mysql-tmp-error-cant-createwrite-to-file-tmpmykbo3bl-errcode-13/)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-07-15T08:14:08.730

这很容易，您只需将 /tmp 文件夹授予 777 权限即可。只需输入：

```
chmod -R 777 /tmp 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-03-28T13:33:35.190

在 debian 7.5 上，我遇到了同样的错误。我意识到`/tmp`文件夹所有者和权限已关闭。正如另一个答案所建议的那样，我做了如下（必须是root）：

```
chown root:root /tmp && chmod 1777 /tmp 
```

我什至不必重新启动 mysql 守护进程。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-01-06T05:21:14.320

在 Ubuntu 机器上，将 /tmp 移动到不同的卷（符号链接）后，我开始收到此错误。即使在设置了所需的权限 1777 之后，问题也没有解决。

MySQL 受 AppArmor 保护，它不允许写入新的 tmp 位置 /mnt/tmp。我必须将以下行添加到 /etc/apparmor.d/abstractions/user-tmp 来解决这个问题

> 所有者 /mnt/tmp/** rwkl,
> 
> /mnt/tmp/rw,

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-08-22T12:56:44.563

我正在使用mariadb。当我尝试将这一行放在 /etc/my.cnf 中时：

```
[mysqld]
tmpdir=/tmp 
```

它解决了与 /tmp 相关的网站前端生成的错误。但是，它有 /tmp 的后端问题。例如，当我尝试从后端重建 mariadb 时，它无法读取 /tmp 目录，然后产生了类似的错误。

```
mysqldump: Couldn't execute 'show fields from `wp_autoupdate`': Can't create/write to file '/tmp/#sql_1680_0.MAI' (Errcode: 2 "No such file or directory") (1) 
```

所以这个适用于前端和后端：

**1\. mkdir /var/lib/mysql/tmp**

**2\. chown mysql:mysql /var/lib/mysql/tmp**

**3\. 将以下行添加到 [mysqld] 部分：**

```
 tmpdir = /var/lib/mysql/tmp 
```

**4.重启mysqld(eg.centos7:systemctl restart mysqld)**

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-05-19T20:23:09.673

由于访问控制安全策略，特别是在启用 SELinux 时，它不允许外部可执行文件在系统位置创建临时文件。

通过发出以下命令禁用 SELinux：

**回声 0 >/selinux/enforce**

您现在可以启动 mysql，它在读取/写入 /tmp 或系统目录时不会给出任何权限相关的错误。

如果您希望启用 SELinux 安全性，请将上述命令中的 0 更改为 1。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-07-17T10:18:47.080

检查权限问题，mysql 配置。

还要检查你是否没有达到磁盘空间、配额限制。

**注意：**一些系统限制了文件的数量（不仅仅是空间），删除一些旧的会话文件有助于解决我的问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-01-22T12:48:37.683

对于那些使用 VPS / 虚拟主机的人。

我正在使用 VPS，出现 MySQL 无法写入 /tmp 的错误，并且一切看起来都正确。我**有足够的可用空间、足够的可用 inode、正确的权限**。原来问题出在我的 VPS 之外，**是托管 VPS 的机器已满**。我的文件系统中只有“虚拟空间”，但托管 VPS 的后台机器没有“物理空间”。我不得不联系他们修复它的任何 VPS 公司。

如果您认为这可能是您的问题，您可以测试将更大的文件写入 /tmp (1GB)：

```
dd if=/dev/zero of=/tmp/file.txt count=1024 bs=1048576 
```

我收到一条`No space left on device`错误消息，这表明它是后台的磁盘/卷已满。

# c - select() 语句的问题

> ID：11997019
> 
> 赞同：1
> 
> 时间：2012-08-16T23:48:19.923
> 
> 标签：c, sockets, unix-socket

我有一个程序正在使用 select() 来轮询准备连接的套接字。

我有另一个绑定到套接字并发出 send() 命令的程序。

我的问题是文件描述符是否可以跨两个这样的可执行文件工作。

即，如果我将程序 A 中的文件描述符 5 添加到 FD_SET，并且程序 B 中的套接字 fd 为 5，这是否意味着该套接字上的 send() 将唤醒正在对包含 5 的 FD_SET 进行选择的程序 A？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T00:22:03.643

不，文件描述符编号是特定于进程的。在不同的进程中使用相同的 fd 编号没有隐含的影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T05:20:03.397

给定进程（0-1023）支持大多数描述符（文件/套接字）（请参阅 /proc//limits 中进程支持的文件/套接字描述符的最大限制）。

前 3 个描述符（0、1 和 2）分别分配给 stdin、stdout 和 stderr。下一个值为 3 的描述符将被分配给下一个打开的文件/套接字描述符，并且可以达到 /proc 中指定的限制。注意：您还可以更改最大支持的描述符。

您可以在 /proc//fd 中查看给定进程打开的文件描述符列表。每个进程描述符/信号/事件范围仅特定于进程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T23:53:09.150

它与文件描述符编号无关。

如果您通过套接字通过连接发送，该连接的另一端是正在选择读取的套接字，则选择器将检测读取事件。

# javascript - 读取远程 html 正文

> ID：11997022
> 
> 赞同：0
> 
> 时间：2012-08-16T23:48:47.803
> 
> 标签：javascript, html

我觉得这个问题很愚蠢，但我尝试了一切，但没有任何效果......所以就这样吧：我正在做一个 BHO 来拒绝一些被禁止的网站。因此，当我找到某个目标 URL 时，我只需取消导航并调用一个程序来读取另一个正文。而这个程序就是问题所在。我通过 iframe 尝试过这样的：

```
iFrame:= Document.createElement('iframe');
iFrame.setAttribute('src', 'denied.html', 0);
iFrame.setAttribute('position', 'absolute', 0);
iFrame.style.width:= '100%';
iFrame.style.height:= '100%';
iFrame.style.left:= '0px';
iFrame.style.top:= '0px';
iFrame.style.border:= '0px';
(Document.body as IHTMLDomNode).appendChild(iFrame as IHTMLDomNode); 
```

但没有奏效。iframe 不会与整个网站重叠，只是其中的一部分。所以我尝试了这个：

```
Document.body.insertAdjacentHTML('afterbegin', '<body onload="document.location=denied.html">'); 
```

但也没有...并为此尝试了许多其他html代码，但没有任何效果。我怎样才能以这种方式阅读另一个远程页面？记得我正在使用 ihtmldocument2,ihtmlelement...而且我是这个主题的新手。等待答案！谢谢兄弟。

# sql - SQL 存储过程无法正常工作

> ID：11997023
> 
> 赞同：0
> 
> 时间：2012-08-16T23:48:52.670
> 
> 标签：sql, sql-server, stored-procedures

下面是存储过程的代码。

代码的第一部分按预期工作。它获取变量，在一个表中执行 INSERT，然后使用从该操作创建的主键在单独的表上执行另一个 INSERT。

然而，没有发生的是 if/else if/else 块中的代码接近 then 结束。基本上应该检查以确保两个 ID 列正确匹配。如果不是，它会将列调整为适当的值，然后返回旧值加上输入者的日期和用户名 (lastChangeOperator)。

我花了一整天的时间来写这个和这个程序的另一部分，所以我希望第二双眼睛能起到作用。

```
ALTER PROCEDURE [dbo].[sp_AgentIdAprCheck] 
  (
    @companyCode char(3),
    @agentId char(10),
    @firstName nvarChar(50),
    @lastname nvarChar(50),
    @suffix char(10),
    @ssn int, 
    @taxIdType char(1),
    @entityType char(1),
    @corporateName nvarChar(100),
    @currentUniqueId int OUTPUT,
    @currentAgentId int OUTPUT,
    @operator nvarchar(50) OUTPUT,
    @date datetime OUTPUT
  )
  AS
    DECLARE @rows int = 0
    DECLARE @uniqueAgentId int = 0
    DECLARE @lastChangeOperator char(6) = 'LVOMQ1'
    DECLARE @LastChangeDate datetime
    --DECLARE @currentUniqueId int = 0
    --DECLARE @currentAgent int = 0
    --DECLARE @operator nvarchar(50)
    --DECLARE @date datetime

    SELECT @rows = COUNT(AgentTaxId) 
      FROM AgentIdentification
      WHERE AgentTaxId = @ssn

    if @rows > 0
      return 1
    else
      BEGIN TRANSACTION
      SET @LastChangeDate = GETDATE()
      INSERT INTO Agent (EntityType, FirstName, LastName, 
        NameSuffix, CorporateName, LastChangeOperator, LastChangeDate)
      VALUES (@entityType, @firstName, @lastname, 
        '', @corporateName, @lastChangeOperator, @LastChangeDate)

      SELECT @uniqueAgentId = @@IDENTITY
      SELECT UniqueAgentId
        FROM Agent

      INSERT INTO AgentIdentification (UniqueAgentId, TaxIdType, 
        AgentTaxId, LastChangeOperator, LastChangeDate)
      VALUES (@uniqueAgentId, @taxIdType, @ssn, @
        lastChangeOperator, @lastChangeDate)

      DECLARE @uniqueIdRows int = 0
      SELECT @uniqueIdRows = COUNT(UniqueAgentId)
    FROM UniqueAgentIdToAgentId
    WHERE UniqueAgentId = @uniqueAgentId

      DECLARE @agentIdRows int = 0
      SELECT @agentIdRows = COUNT(AgentId)
        FROM UniqueAgentIdToAgentId
        WHERE AgentId = @agentId

      if @uniqueIdRows = 0 AND @agentIdRows = 0
        BEGIN
          INSERT INTO UniqueAgentIdToAgentId (UniqueAgentId, AgentId, 
            CompanyCode, LastChangeOperator, LastChangeDate)
          VALUES (@uniqueAgentId, @agentId, @companyCode, 
            @lastChangeOperator, @LastChangeDate)
        END
      else if @agentIdRows = 0
        BEGIN           
          SELECT @currentUniqueId = UniqueAgentId, 
            @operator = LastChangeOperator, @date = @LastChangeDate
          FROM UniqueAgentIdToAgentId

          UPDATE UniqueAgentIdToAgentId
            SET UniqueAgentId = @uniqueAgentId
            WHERE AgentId = @agentId AND UniqueAgentId = @currentUniqueId
        END
      else
        BEGIN           
          SELECT @currentAgentId = AgentId, 
            @operator = LastChangeOperator, @date = @LastChangeDate
          FROM UniqueAgentIdToAgentId

          UPDATE UniqueAgentIdToAgentId
            SET AgentId = @agentId
            WHERE  UniqueAgentId = @uniqueAgentId --AND AgentId = @currentAgentId
          return 2
        END
        COMMIT TRANSACTION 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:58:39.523

您是否尝试过使用`SCOPE_IDENTITY()`而不是`@@IDENTITY`？我猜这可能是你的问题。

正如皮纳尔戴夫[在这里所说](http://blog.sqlauthority.com/2007/03/25/sql-server-identity-vs-scope_identity-vs-ident_current-retrieve-last-inserted-identity-of-record/)

*“为避免与稍后添加触发器相关的潜在问题，请始终使用 SCOPE_IDENTITY() 来返回 T SQL 语句或存储过程中最近添加的行的标识。”*

# arrays - 二维数组的输入行

> ID：11997025
> 
> 赞同：0
> 
> 时间：2012-08-16T23:48:58.953
> 
> 标签：arrays, multidimensional-array

我有一个二维数组，想一次写一行而不是通过循环。

我该怎么做呢？

```
double mat[3][3];

row1={1,2,3}
row2={4,5,6}
row3={7,8,9} 
```

我想写的是

```
mat[0]={1,2,3} 
```

但我知道这不是正确的语法。有谁知道是什么？

我在C工作。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T16:42:32.787

我假设您的行定义如下：

```
double row1[] = { 1, 3, 5 }; 
```

然后您可以使用 memcpy() 将整行复制到您的二维数组中。

```
#include <string.h>

memcpy( mat[0], row1, 3 * sizeof(double) ); 
```

# mstest - 对配置敏感的 local.testsettings 文件

> ID：11997026
> 
> 赞同：2
> 
> 时间：2012-08-16T23:49:15.970
> 
> 标签：mstest

我正在构建一个在 x86 和 x64 配置中构建的库。在单元测试中，我必须手动选择两个文件，一个具有来自 x64 目录的部署项目，另一个具有来自 x86 目录的部署项目。我还必须使用属性 hostProcessPlatform="MSIL" 修改标记，以使 x64 COM 组件能够正确运行和加载。我的问题是如何在文件中编写部署项和执行项，以便根据当前配置设置它做正确的事情

我想做这样的事情

```
<DeploymentItem filename = "$(Config)\file">
...
...
about 50  different deployment items then 

<Execution Configuration="x86" >
...
</Execution>
<Execution Configuration="x64">
...
</Execution> 
```

有没有人遇到过这个并想通了？

# objective-c - 使用 NSPointerArray 访问对象？

> ID：11997027
> 
> 赞同：0
> 
> 时间：2012-08-16T23:49:15.943
> 
> 标签：objective-c, pointers, casting, nspointerarray

我有一个`NSPointerArray`and 在我的一种方法中，我想访问存储在其中的对象`NSPointerArray`（因为我必须使用其中一个对象`properties`）。我不想`NSArray`用 allObjects 方法创建一个新的，因为这在我的程序中是多余的。现在，我正在做以下使用了很多`memory`? （对不起，我是菜鸟）。

```
-(void) print
{
    for (int i=0; i<[list count]; i++){
        NSLog(@"%@",[((__bridge Song*)[list pointerAtIndex: i])  title]);
    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-04-23T15:01:47.637

看起来你的问题已经解决了。想提一下它更容易用循环来`NSPointerArray`循环`foreach`。在这种情况下，您可以这样做：

```
-(void) print {
    for (Song *s in list){
        NSLog(@"%@", [s title]);
    }
} 
```

这样你就可以专注于对象而不是使用`integer`你的循环。

# iphone - UIButton 导航到另一个 ViewController 中的 WebView

> ID：11997030
> 
> 赞同：-2
> 
> 时间：2012-08-16T23:49:41.433
> 
> 标签：iphone, ios, xcode4.2

我有一个带有两个 ViewController 的应用程序。一个有一个 WebView，另一个有一个按钮。我希望当按下按钮时，在另一个 ViewController 中的 WebView 中携带一个页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T12:05:12.700

单击按钮时，

```
-(void)ButtontnCliked:(UIButton*)sender 
{
  //create object of class to which you want to navigate.

  NewView *viewController = [[NewView alloc]initWithNibName:@"NewView" bundle:nil]; //NewView is my new class
  [self.navigationController pushViewController:viewController animated:YES];  // it will pushes your current view to newView.
  [viewController release];
} 
```

**注意：**假设您的 rootViewController 是导航控制器。

# c# - 如何将字符串数组发送到 COM PORT？

> ID：11997031
> 
> 赞同：0
> 
> 时间：2012-08-16T23:49:58.823
> 
> 标签：c#, serial-port

一旦我确定了在 Windows 7 上与之通信的串行端口（使用`Win32_SerialPort WMI method`，您如何建议使用 c# 向其发送字符串数组？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T00:14:07.567

您可以使用`SerialPort`该类，如 MSDN 上所述：http: [//msdn.microsoft.com/en-us/library/system.io.ports.serialport.aspx](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.aspx)

可用的原型是`Write(string)`，您可以在循环中使用它来满足您的要求。

# html - 如何仅在左侧和右侧获得框阴影

> ID：11997032
> 
> 赞同：240
> 
> 时间：2012-08-16T23:49:59.470
> 
> 标签：html, css

任何方法都可以在没有黑客或图像的情况下在左右（水平？）两侧获得盒子阴影。我在用：

```
box-shadow: 0 0 15px 5px rgba(31, 73, 125, 0.8); 
```

但它给周围的阴影。

我没有围绕元素的边界。

* * *

## 回答 #1

> 赞同：282
> 
> 时间：2012-08-16T23:56:34.360

> **注意：**我建议在下面查看[@Hamish 的答案](https://stackoverflow.com/a/17323375/605707)；它不涉及此处描述的解决方案中不完美的“掩蔽”。

* * *

你可以接近多个盒子阴影；每边一个

```
box-shadow: 12px 0 15px -4px rgba(31, 73, 125, 0.8), -12px 0 8px -4px rgba(31, 73, 125, 0.8); 
```

[http://jsfiddle.net/YJDdp/](http://jsfiddle.net/YJDdp/)

**编辑**

再为顶部和底部添加 2 个盒子阴影，以掩盖渗出的阴影。

```
box-shadow: 0 9px 0px 0px white, 0 -9px 0px 0px white, 12px 0 15px -4px rgba(31, 73, 125, 0.8), -12px 0 15px -4px rgba(31, 73, 125, 0.8); 
```

[http://jsfiddle.net/LE6Lz/](http://jsfiddle.net/LE6Lz/)

* * *

## 回答 #2

> 赞同：191
> 
> 时间：2013-06-26T14:47:03.903

我对 Deefour 解决方案中阴影的圆形顶部和底部不满意，因此创建了我自己的解决方案。

`inset` `box-shadow`创建一个很好的均匀阴影，顶部和底部被切断。

要在元素的侧面使用此效果，请创建两个伪元素`:before`并`:after`绝对定位在原始元素的侧面。

```
div:before, div:after {
  content: " ";
  height: 100%;
  position: absolute;
  top: 0;
  width: 15px;
}
div:before {
  box-shadow: -15px 0 15px -15px inset;
  left: -15px;
}
div:after {
  box-shadow: 15px 0 15px -15px inset;
  right: -15px;
}

div {
  background: #EEEEEE;
  height: 100px;
  margin: 0 50px;
  width: 100px;
  position: relative;
}
```

```
<div></div>
```

* * *

**编辑**

根据您的设计，您可能可以使用`clip-path`，如@Luke 的回答所示。但是，请注意，在许多情况下，这仍会导致阴影在顶部和底部逐渐变细，如您在此示例中所见：

```
div {
  width: 100px;
  height: 100px;
  background: #EEE;
  box-shadow: 0 0 15px 0px #000;
  clip-path: inset(0px -15px 0px -15px);
  position: relative;
  margin: 0 50px;
}
```

```
<div></div>
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2014-07-01T16:35:53.450

## 负扩散和遮蔽阴影

CSS [box-shadow](https://www.w3schools.com/cssref/css3_pr_box-shadow.asp)使用 4 个参数`h-shadow, v-shadow, blur, spread`：

```
box-shadow: 10px 0 8px -8px black; 
```

该`blur`参数添加了渐变效果，但也在顶部和底部边框上添加了一点阴影。为了摆脱这种副作用，我们可以使用：

*   Negative`spread`减少所有边框上的阴影：您可以尝试使用它来尝试移除那个小的垂直阴影，而不会过多地影响侧面的阴影（对于 5 到 10px 的小阴影更容易。）

*   遮蔽与背景颜色相同的阴影（在本例中为白色），这允许出现自动收报机阴影。请注意，此遮罩阴影需要 blur = 0 才能完全覆盖副作用。

这里举两个例子，第二个使用Masking shadow：

```
div{
    width: 100px;
    height: 100px;
    border: 1px solid green;
    margin: 10px;
    float: left;
}
#example1{
    box-shadow: -10px 0 8px -8px black, 10px 0 8px -8px black;
}
#example2{
    box-shadow: 
        0 -6px white,
        0 6px white, 
        -7px 0 4px -3px black, 
        7px 0 4px -3px black;
}
```

```
<div id="example1"></div>
<div id="example2"></div>
```

* * *

如果这些方法都不适合您的需求，您还可以在任何现有 div 的一侧添加绝对 div。

只要记住将容器 div 设置为`position: relative`这样，这个绝对 div 就会留在里面。

```
#example3 {
  position: relative;
  width: 100px;
  height: 100px;
  margin: 10px;
  border: 1px solid green;
}

.shadow {
  position: absolute;
  height: 100%;
  width: 4px;
  left: 0px;
  top: 0px;
  box-shadow: -4px 0 3px black;
}
```

```
<div id="example3">
  content here
  <div class="shadow"></div>
</div>
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2013-08-19T07:29:06.980

试试这个，它对我有用：

```
 box-shadow: -5px 0 5px -5px #333, 5px 0 5px -5px #333; 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2020-06-14T00:27:43.263

`clip-path`现在（2020 年）是我发现在元素的特定侧面实现盒子阴影的最佳方法，**尤其是当所需的效果是特定边缘的“干净切割”阴影时**，如下所示：

```
.shadow-element {
    width: 100px;
    height: 100px;
    background-color: #FFC300;
    box-shadow: 0 0 10px 5px rgba(0,0,0,0.75);
    clip-path: inset(0px -15px 0px -15px);

    /* position and left properties required to bring element out from edge of parent
    so that shadow can be seen; margin-left would also achieve the same thing */
    position: relative;
    left: 15px;
}
```

```
<div class="shadow-element"></div>
```

...与像这样的衰减/减少/变薄阴影相反：

```
.shadow-element {
    width: 100px;
    height: 100px;
    background-color: #FFC300;
    box-shadow: 15px 0 15px -10px rgba(0,0,0,0.75), -15px 0 15px -10px rgba(0,0,0,0.75);

    /* position and left properties required to bring element out from edge of parent
    so that shadow can be seen; margin-left would also achieve the same thing */
    position: relative;
    left: 15px;
}
```

```
<div class="shadow-element"></div>
```

* * *

只需将以下 CSS 应用于相关元素：

```
box-shadow: 0 0 Xpx Ypx [hex/rgba]; /* note 0 offset values */
clip-path: inset(Apx Bpx Cpx Dpx); 
```

在哪里：

*   `Apx`设置顶部边缘的阴影可见性
*   `Bpx`对
*   `Cpx`底部
*   `Dpx`剩下

为应隐藏阴影的任何边缘输入值 0，为应显示阴影的任何边缘输入负值（与模糊半径 + 散布值 - 的组合结果相同`Xpx + Ypx`）。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-07-30T13:22:12.733

另一种方法是`overflow-y:hidden`在父级上使用填充：

```
body {
    padding: 30px;
}
#wrap {
    overflow-y: hidden;
    padding: 0 10px;
}
#wrap > div {
    width: 100px;
    height: 100px;
    box-shadow: 0 0 20px -5px red;
}
```

```
<div id="wrap">
    <div></div>
</div>
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-11-08T12:04:10.780

这适用于所有浏览器：

```
-webkit-box-shadow: -7px 0px 10px 0px #000, 7px 0px 10px 0px #000;
-moz-box-shadow: -7px 0px 10px 0px #000, 7px 0px 10px 0px #000;
box-shadow: -7px 0px 10px 0px #000, 7px 0px 10px 0px #000; 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-01-10T05:38:50.767

您必须使用多个`box-shadow;`. `inset`属性使它看起来很漂亮和内部：

```
div {
    box-shadow: inset 0 12px  15px -4px rgba(31, 73, 125, 0.8), inset 0 -12px  8px -4px rgba(31, 73, 125, 0.8);
    width: 100px;
    height: 100px;
    margin: 50px;
    background: white;
}
```

```
<div></div>
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-07-12T13:18:35.470

要在图像或任何其他内容的右侧和左侧获得漂亮的嵌入阴影，请以这种方式使用它（`z-index:-1`在显示带有插图的图像或内部对象时，这是一个很好的技巧）：

```
.shadowcontainer{
    display:inline-flex;
    box-shadow: inset -40px 0px 30px -30px rgba(0,0,0,0.9),inset 40px 0px 30px -30px rgba(0,0,0,0.9);
}

.innercontent{
    z-index:-1
}
```

```
<div class="shadowcontainer">
<img src="https://www.google.es/images/srpr/logo11w.png" class="innercontent" style="with:100%"/>
</div>
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-11T04:33:01.903

在某些情况下，您可以通过另一个容器隐藏阴影。例如，如果在带有阴影的 DIV 上方和下方都有一个 DIV，则可以`position: relative; z-index: 1;`在周围的 DIV 上使用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-02-25T10:25:48.053

仅对于水平，您可以`box-shadow`在其父 div 上欺骗 using 溢出：

```
.parent{
    overflow:hidden;
}
.box-shadow{
    box-shadow: box-shadow: 0 5px 5px 0 #000;
}
```

```
<div class="parent">
    <div class="box-shadow">content</div>
</div>
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-03-20T10:38:05.257

另一个想法可能是创建一个最终具有透明度的深色模糊伪元素来模仿阴影。使其高度略低，宽度略大 ig

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-08-18T06:33:21.163

您可以在其中使用 1 个 div 来“擦除”阴影：

```
.yourdiv{
    position:relative;
    width:400px;
    height:400px;
    left:10px;
    top:40px;
    background-color:white;
    box-shadow: 0px 0px 1px 0.5px #5F5F5F;

}
.erase{
    position:absolute;
    width:100%;
    top:50%;
    height:105%;
    transform:translate(0%,-50%);
    background-color:white;
} 
```

你可以玩“身高：%;” 和“宽度：%；” 抹去你想要的影子。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-10-12T06:09:21.280

这对我有用：

```
box-shadow: 0 5px 5px 0 #000; 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-05-02T16:24:29.970

我试图在右侧复制引导程序 shadow-sm，这是我的代码：

```
.shadow-rs{
    box-shadow: 5px 0 5px -4px rgba(237, 241, 235, 0.8);
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-11-10T13:10:46.057

如果您希望您的 div 顶部有一个箭头，请使用以下命令：

```
box-shadow: -1px -1px 1px rgba(0, 0, 0, 0.1); 
```

# postgresql - 如何在 postgres 中编写组合函数？

> ID：11997037
> 
> 赞同：6
> 
> 时间：2012-08-16T23:50:31.160
> 
> 标签：postgresql, plpgsql, combinatorics

我有一个这种形式的 PostgreSQL 表：

```
base_id int | mods smallint[]
     3      |   {7,15,48} 
```

我需要填充这种形式的表格：

```
combo_id int | base_id int | mods smallint[]
     1       |     3       |      
     2       |     3       |      {7}
     3       |     3       |      {7,15}   
     4       |     3       |      {7,48}   
     5       |     3       |      {7,15,48}
     6       |     3       |      {15}
     7       |     3       |      {15,48}
     8       |     3       |      {48} 
```

我想我可以使用一个几乎完全完成此操作的函数来完成此操作，迭代第一个表并将组合写入第二个表： [在 SQL 中生成所有组合](https://stackoverflow.com/questions/3686062/generate-all-combinations-in-sql)

但是，我是 Postgres 新手，我一辈子都无法弄清楚如何使用 plpgsql 来做到这一点。它不需要特别快；它只会在后端定期运行。第一个表大约有 80 条记录，粗略计算表明我们可以预期第二个表大约有 2600 条记录。

谁能至少指出我正确的方向？

**编辑：**克雷格：我有 PostgreSQL 9.0。我成功地使用了 UNNEST()：

```
FOR messvar IN SELECT * FROM UNNEST(mods) AS mod WHERE mod BETWEEN 0 AND POWER(2, @n) - 1
LOOP
    RAISE NOTICE '%', messvar;
END LOOP; 
```

但后来不知道下一步该去哪里。

**编辑：**作为参考，我最终使用了 Erwin 的解决方案，添加了一行以向每个集合添加空结果 ('{}')，并且 Erwin 所指的特殊情况已删除：

```
CREATE OR REPLACE FUNCTION f_combos(_arr integer[], _a integer[] DEFAULT '{}'::integer[], _z integer[] DEFAULT '{}'::integer[])
RETURNS SETOF integer[] LANGUAGE plpgsql AS
$BODY$
DECLARE
 i int;
 j int;
 _up int;
BEGIN
 IF array_length(_arr,1) > 0 THEN 
    _up := array_upper(_arr, 1);

    IF _a = '{}' AND _z = '{}' THEN RETURN QUERY SELECT '{}'::int[]; END IF;
    FOR i IN array_lower(_arr, 1) .. _up LOOP
       FOR j IN i .. _up  LOOP
          CASE j-i
          WHEN 0,1 THEN
             RETURN NEXT _a || _arr[i:j] || _z;
          ELSE
             RETURN NEXT _a || _arr[i:i] || _arr[j:j] || _z;
             RETURN QUERY SELECT *
             FROM f_combos(_arr[i+1:j-1], _a || _arr[i], _arr[j] || _z);
          END CASE;
       END LOOP;
    END LOOP;
 ELSE
    RETURN NEXT _arr;
 END IF;
END;
$BODY$ 
```

然后，我使用该函数来填充我的表：

```
INSERT INTO e_ecosystem_modified (ide_ecosystem, modifiers) 
(SELECT ide_ecosystem, f_combos(modifiers) AS modifiers FROM e_ecosystem WHERE ecosystemgroup <> 'modifier' ORDER BY ide_ecosystem, modifiers); 
```

从我的源表中的 79 行和修饰符数组中最多 7 个项目开始，查询花费了 250 毫秒来填充我的输出表中的 2630 行。极好的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T01:16:59.190

在我睡过之后，我有了一个全新的、更简单、更快的想法：

```
CREATE OR REPLACE FUNCTION f_combos(_arr anyarray)
  RETURNS TABLE (combo anyarray) LANGUAGE plpgsql AS
$BODY$
BEGIN
    IF array_upper(_arr, 1) IS NULL THEN
        combo := _arr; RETURN NEXT; RETURN;
    END IF;

    CASE array_upper(_arr, 1)
--  WHEN 0 THEN -- does not exist
    WHEN 1 THEN
        RETURN QUERY VALUES ('{}'), (_arr);
    WHEN 2 THEN
        RETURN QUERY VALUES ('{}'), (_arr[1:1]), (_arr), (_arr[2:2]);
    ELSE
        RETURN QUERY
        WITH x AS (
            SELECT f.combo FROM f_combos(_arr[1:array_upper(_arr, 1)-1]) f
            )
        SELECT x.combo FROM x
        UNION ALL
        SELECT x.combo || _arr[array_upper(_arr, 1)] FROM x;
    END CASE;
END
$BODY$; 
```

称呼：

```
SELECT * FROM f_combos('{1,2,3,4,5,6,7,8,9}'::int[]) ORDER BY 1; 
```

512 行，总运行时间：2.899 毫秒

### 解释

*   `NULL`用空数组处理特殊情况。
*   为两个原始数组构建组合。
*   任何更长的数组都分解为：
    *   长度为 n-1 的相同数组的组合
    *   加上所有与元素 n .. 结合的*递归*。

真的很简单，一旦掌握。

*   **适用于以下标 1**开头的一维整数数组（见下文）。
*   比旧解决方案快 2-3 倍，扩展性更好。
*   再次适用于*任何*元素类型（使用多态类型）。
*   在问题中显示的结果中包含空数组（正如@Craig 在评论中向我指出的那样）。
*   更短，更优雅。

这假定[**数组下标**](http://www.postgresql.org/docs/current/interactive/arrays.html#ARRAYS-MODIFYING)从**1**（默认）开始。如果您不确定自己的值，请调用如下函数进行标准化：

```
SELECT * FROM  f_combos(_arr[array_lower(_arr, 1):array_upper(_arr, 1)]); 
```

不确定是否有更优雅的方法来规范化数组下标。我发布了一个问题：
[Normalize array subscripts for 1-dimensional array so they start with 1](https://stackoverflow.com/q/12011569/939860)

## 旧解决方案（较慢）

```
CREATE OR REPLACE FUNCTION f_combos2(_arr int[], _a int[] = '{}', _z int[] = '{}')
 RETURNS SETOF int[] LANGUAGE plpgsql AS
$BODY$
DECLARE
   i int;
   j int;
   _up int;
BEGIN
   IF array_length(_arr,1) > 0 THEN 
      _up := array_upper(_arr, 1);

      FOR i IN array_lower(_arr, 1) .. _up LOOP
         FOR j IN i .. _up  LOOP
            CASE j-i
            WHEN 0,1 THEN
               RETURN NEXT _a || _arr[i:j] || _z;
            WHEN 2 THEN
               RETURN NEXT _a || _arr[i:i] || _arr[j:j] || _z;
               RETURN NEXT _a || _arr[i:j] || _z;
            ELSE
               RETURN NEXT _a || _arr[i:i] || _arr[j:j] || _z;
               RETURN QUERY SELECT *
               FROM f_combos2(_arr[i+1:j-1], _a || _arr[i], _arr[j] || _z);
            END CASE;
         END LOOP;
      END LOOP;
   ELSE
      RETURN NEXT _arr;
   END IF;
END;
$BODY$; 
```

称呼：

```
SELECT * FROM f_combos2('{7,15,48}'::int[]) ORDER BY 1; 
```

适用于一维整数数组。这可以进一步优化，但这当然不是这个问题的范围所需要的。
`ORDER BY`强加问题中显示的顺序。

`NULL`如评论中所述，提供 NULL 或空数组。

使用 PostgreSQL 9.1 测试，但应该适用于任何半现代版本。 [`array_lower()`并且`array_upper()`](http://www.postgresql.org/docs/7.4/interactive/functions-array.html#ARRAY-FUNCTIONS-TABLE)至少从 PostgreSQL 7.4 开始就已经存在了。只有参数默认值在 8.4 版中是新的。可以轻松更换。

性能不错。

```
SELECT DISTINCT * FROM f_combos('{1,2,3,4,5,6,7,8,9}'::int[]) ORDER BY 1; 
```

511 行，总运行时间：7.729 毫秒

### 解释

它建立在这种*简单的形式*之上，它只创建相邻元素的所有组合：

```
CREATE FUNCTION f_combos(_arr int[])
  RETURNS SETOF int[] LANGUAGE plpgsql AS
$BODY$
DECLARE
   i  int;
   j  int;
  _up int;
BEGIN
   _up := array_upper(_arr, 1);

   FOR i in array_lower(_arr, 1) .. _up LOOP
      FOR j in i .. _up LOOP
         RETURN NEXT _arr[i:j];
      END LOOP;
   END LOOP;
END;
$BODY$; 
```

但是对于具有两个以上元素的子数组，这将失败。所以：

*   对于任何具有 3 个元素的子数组，添加一个仅具有外部两个元素的数组。这是这种特殊情况的捷径，可以提高性能，*但并非绝对需要*。

*   对于具有超过 3 个元素的任何子数组，我采用*外部两个元素*并用同一函数**递归构建***的内部元素的所有组合*填充。

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T02:14:05.137

一种方法是使用递归 CTE。不过，Erwin 更新后的递归函数明显更快并且可扩展性更好，因此这作为一种有趣的不同方法非常有用。Erwin 的更新版本更加实用。

我尝试了一种计数方法（见最后），但没有一种快速的方法从数组中提取任意元素，结果证明它比递归方法慢。

## 递归 CTE 组合函数

```
CREATE OR REPLACE FUNCTION combinations(anyarray) RETURNS SETOF anyarray AS $$
WITH RECURSIVE
    items AS (
            SELECT row_number() OVER (ORDER BY item) AS rownum, item
            FROM (SELECT unnest($1) AS item) unnested
    ),
    q AS (
            SELECT 1 AS i, $1[1:0] arr
            UNION ALL
            SELECT (i+1), CASE x
                    WHEN 1 THEN array_append(q.arr,(SELECT item FROM items WHERE rownum = i))
                    ELSE q.arr END
            FROM generate_series(0,1) x CROSS JOIN q WHERE i <= array_upper($1,1)
    )
SELECT q.arr AS mods
FROM q WHERE i = array_upper($1,1)+1;
$$ LANGUAGE 'sql'; 
```

它是一个多态函数，因此它适用于任何类型的数组。

逻辑是使用工作表迭代未嵌套输入集中的每个项目。从工作表中的一个空数组开始，代号为 1。对于输入集中的每个条目，将两个新数组插入到工作表中，代号递增。两者中的一个是上一代输入数组的副本，另一个是输入数组中附加了输入集中第 (generation-number) 项的输入数组。当世代数超过输入集中的项目数时，返回上一代。

## 用法

您可以使用该`combinations(smallint[])`函数来产生您想要的结果，将其用作与`row_number`窗口函数结合的集合返回函数。

```
-- assuming table structure
regress=# \d comb
       Table "public.comb"
 Column  |    Type    | Modifiers 
---------+------------+-----------
 base_id | integer    | 
 mods    | smallint[] | 

SELECT base_id, row_number() OVER (ORDER BY mod) AS mod_id, mod 
FROM (SELECT base_id, combinations(mods) AS mod FROM comb WHERE base_id = 3) x
ORDER BY mod; 
```

## 结果

```
regress=# SELECT base_id, row_number() OVER (ORDER BY mod) AS mod_id, mod 
regress-# FROM (SELECT base_id, combinations(mods) AS mod FROM comb WHERE base_id = 3) x
regress-# ORDER BY mod;
 base_id | mod_id |    mod    
---------+--------+-----------
       3 |      1 | {}
       3 |      2 | {7}
       3 |      3 | {7,15}
       3 |      4 | {7,15,48}
       3 |      5 | {7,48}
       3 |      6 | {15}
       3 |      7 | {15,48}
       3 |      8 | {48}
(8 rows)

Time: 2.121 ms 
```

零元素数组产生空结果。如果你想`combinations({})`返回一行`{}`，那么`UNION ALL`with`{}`将完成这项工作。

## 理论

看来您想要[k-multicombination 中所有 k 的 k-combinations](http://en.wikipedia.org/wiki/Combination#Number_of_k-combinations_for_all_k)，而不是简单的组合。请参阅[重复组合的数量](http://en.wikipedia.org/wiki/Combination#Number_of_combinations_with_repetition)。

换句话说，您需要集合中元素的所有 k 组合，对于从 0 到 n 的所有 k，其中 n 是集合大小。

相关的 SO 问题：[SQL - Find all possible combination](https://stackoverflow.com/questions/4352263/sql-find-all-possible-combination)，其中有关于位计数的非常有趣的答案。

Pg中存在[位操作](http://www.postgresql.org/docs/9.1/static/functions-bitstring.html)，因此应该可以使用[位计数方法。](https://stackoverflow.com/a/4352525/398670)您希望它更有效，但由于从数组中选择分散的元素子集非常慢，它实际上运行起来*更慢*。

```
CREATE OR REPLACE FUNCTION bitwise_subarray(arr anyarray, elements integer)
RETURNS anyarray AS $$
SELECT array_agg($1[n+1]) 
FROM generate_series(0,array_upper($1,1)-1) n WHERE ($2>>n) & 1 = 1;
$$ LANGUAGE sql;

COMMENT ON FUNCTION bitwise_subarray(anyarray,integer) IS 'Return the elements from $1 where the corresponding bit in $2 is set';

CREATE OR REPLACE FUNCTION comb_bits(anyarray) RETURNS SETOF anyarray AS $$ 
SELECT bitwise_subarray($1, x) 
FROM generate_series(0,pow(2,array_upper($1,1))::integer-1) x;
$$ LANGUAGE 'sql'; 
```

如果你能找到一种更快的写作方式，`bitwise_subarray`那`comb_bits`将会非常快。比如说，一个小的 C 扩展函数，但[我只是疯狂地写一个这样的答案](https://dba.stackexchange.com/a/22571/7788)。**

# java - ListView 编辑没有将单元格切换到输入状态

> ID：11997041
> 
> 赞同：0
> 
> 时间：2012-08-16T23:50:52.930
> 
> 标签：java, events, listview, javafx

我有一个包含表名的 ListView 和一个添加按钮。

```
tablesListView.setEditable(true);
tablesListView.setCellFactory(TextFieldListCell.forListView());
tablesListView.getSelectionModel().setSelectionMode(SelectionMode.SINGLE);
addTableButton.setOnAction(new EventHandler<ActionEvent>(){
    @Override
    public void handle(ActionEvent evt) {
        tablesListView.getItems().add("");
        tablesListView.getSelectionModel().selectLast();
        tablesListView.edit(tablesListView.getSelectionModel().getSelectedIndex());
    }
}); 
```

因此，当我单击列表中的某个单元格时，它会将其状态切换为 TextField，但这不适用于按钮，单元格会被选中，但不会切换。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T08:52:56.713

尝试

```
tablesListView.setEditable(true);
tablesListView.setCellFactory(TextFieldListCell.forListView());
tablesListView.getSelectionModel().setSelectionMode(SelectionMode.SINGLE);

final Timeline animation = new Timeline(
        new KeyFrame(Duration.seconds(.1),
        new EventHandler<ActionEvent>() {
            @Override
            public void handle(ActionEvent actionEvent) {
                tablesListView.edit(tablesListView.getSelectionModel().getSelectedIndex());
            }
        }));
animation.setCycleCount(1);

addTableButton.setOnAction(new EventHandler<ActionEvent>(){
    @Override
    public void handle(ActionEvent evt) {
        tablesListView.getItems().add("");
        tablesListView.getSelectionModel().selectLast();
        animation.play();
    }
}); 
```

实际上`Platform.runLater()`有效，但只是偶尔，因为它在“未来某个未指定的时间”运行可运行文件。因此，您需要指定编辑命令应该运行的时间，例如我的代码示例中的时间线。编辑命令延迟了 0.1 秒。

# c# - 为什么 linq-2-sql 会创建额外的不必要对象？

> ID：11997048
> 
> 赞同：14
> 
> 时间：2012-08-16T23:51:49.520
> 
> 标签：c#, .net, linq, linq-to-sql, orm

我在这样的数据库中有一个简单的父子表

```
CREATE TABLE [Parent](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [Name] [nvarchar](256) NOT NULL)    
ALTER TABLE [Parent] ADD CONSTRAINT [PK_Parent_Id] PRIMARY KEY ([Id])    

CREATE TABLE [Child](
    [Id] [int] IDENTITY(1,1) NOT NULL,
    [ParentId] [int] NOT NULL,
    [Name] [nvarchar](256) NOT NULL)    
ALTER TABLE [Child] ADD CONSTRAINT [PK_Child_Id] PRIMARY KEY ([Id])
ALTER TABLE [Child] ADD CONSTRAINT [FK_Child_Parent_ID] 
    FOREIGN KEY([ParentId]) REFERENCES [Parent] ([Id]) 
```

我在其中的数据是

**父表**

```
Id  Name
1   John 
```

**子表**

```
Id ParentId  Name
1     1    Mike
2     1    Jake
3     1    Sue
4     1    Liz 
```

这些表使用 Visual Studio 中的 Linq-2-SQL 设计器映射到`Parent`C `Child`# 对象，没有非标准选项。

我做了一个简单的测试程序来查询所有孩子和他们的父母

```
public partial class Parent
{
    static int counter = 0;
    //default OnCreated created by the linq to sql designer
    partial void OnCreated()
    {
        Console.WriteLine(string.Format("CreatedParent {0} hashcode={1}",
            ++counter , GetHashCode()));
    }
}

class Program
{
    static void Main(string[] args)
    {
        using (var db = new SimpleDbDataContext())
        {
            DataLoadOptions opts = new DataLoadOptions();
            opts.LoadWith<Child>(c => c.Parent);
            db.LoadOptions = opts;
            var allChildren = db.Childs.ToArray();
            foreach (var child in allChildren)
            {
                Console.WriteLine(string.Format("Parent name={0} hashcode={1}",
                    child.Parent.Name, child.Parent.GetHashCode()));

            }
        }
    }
} 
```

上述程序的输出是

```
CreatedParent 1 hashcode=53937671
CreatedParent 2 hashcode=9874138
CreatedParent 3 hashcode=2186493
CreatedParent 4 hashcode=22537358
Parent name=John hashcode=53937671
Parent name=John hashcode=53937671
Parent name=John hashcode=53937671
Parent name=John hashcode=53937671 
```

如您所见，为数据库中`Parent`的每个对象创建了一个对象`Child`，但最终被丢弃。

问题：

1.  为什么 Linq-2-Sql 会创建这些不必要的额外`Parent`对象？
2.  是否有任何选项可以避免创建额外的`Parent`对象？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-20T21:14:59.563

这是一种副作用的方式，`LoadWith`被执行了。LINQ to SQL 在内部将您的查询转换为：

```
from c in children
select { Child = c, Parent = c.Parent } 
```

如您所见，我们为每个孩子加载一次父级（内部连接）。由于恒等映射，此效果通常不可见。ORM 确保实体对象永远不会被（表、主键）重复。这在您进行更新时会派上用场。

LINQ to SQL 读取从服务器返回的结果集（它包含相同的 Parent N 次！）并将其具体化为对象。只有在物化完成后，身份映射才会完成它的工作并丢弃重复的父实例。

**相同的效果适用于多次返回相同实体的所有查询。**

# mysql - 在规范化关系数据库中存储派生数据的策略

> ID：11997049
> 
> 赞同：0
> 
> 时间：2012-08-16T23:52:04.177
> 
> 标签：mysql, hibernate, jpa

我正在使用 Spring 和 Hibernate 编写一个 Web 应用程序，它将人员、组、帖子、附件、评论等相当复杂的域模型映射到 mysql 数据库中。这个问题源于尝试优化评论查询，但也适用于网站的其他方面。

为了简化问题，评论与帖子具有多对一关系，而帖子与群组具有多对一关系。每个组都有一个基本 url ({/group_slug})，每个帖子都可以通过该 url 后跟斜杠和帖子 ID (/{group_slug}/{post_slug}) 访问。这些帖子有对其父级的引用，并以瞬态方法计算它们的 url，该方法向父级询问其 url 并将其 slug 附加到它的末尾。如果评论想要它的 url，它会询问它的父级（帖子），然后查询组并创建 url。它工作正常，除了以下性能问题：

在主页上，我想在一个列表中显示来自每个用户组的所有最近评论。在每条评论下方应该是一个链接，指向该评论所写的帖子。重要的是这是一个相对快速的查询，但是对于当前的模型，我无法弄清楚如何有效地做到这一点。我当前的休眠查询（jpql）看起来像这样，对于用户所属的每个组：

```
select c from Comment c where c.target.group.id = :groupId and c.dateCreated > :date 
```

但是随后要获取目标项目的每个 url（由于休眠急切地加载从评论到目标然后是目标到组的一对多关系），目标和组都必须从数据库中加载，对于每条评论。

有没有更好的方法来组织这个查询，或者重新设计域模型，这样我就不必每次都加载这么多数据？如果不是，那么每次创建新评论时，对数据库进行反规范化并将评论父级的 url 与它一起存储在数据库中的缺点是什么？没有一个实体经常更改 url，但帖子的 slug 可能会更改。我可以通过遍历所有关于任何 slug 更改的相关评论并更新 url 来处理这种情况，但这似乎仍然违反最佳实践。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T04:15:41.623

您可以在查询中急切加载它以防止 SELECT N+1 发生

```
select c from Comment c join fetch c.target t join fetch t.group g where g.id = :groupId and c.dateCreated > :date 
```

# python - 烧瓶 url_for() 没有缓存

> ID：11997051
> 
> 赞同：4
> 
> 时间：2012-08-16T23:52:22.627
> 
> 标签：python, caching, flask

我将一些文件放在静态目录中，这些文件通过一些后端处理保持更新。我曾经`url_for()`将 url 返回到客户端。

但是我发现即使我从静态目录中删除旧文件并重新生成更新的文件，它仍然会在客户端浏览器上显示旧文件的内容。我认为旧文件已被缓存。

有谁知道如何为该`url_for()`功能设置无缓存？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T10:45:55.617

不久前，我写了[一篇](http://www.subdimension.co.uk/2012/05/31/Flask_Response_headers_and_IEs_cache.html)关于此的博客文章。

基本上，您需要创建一个要发送的响应，然后在响应上设置一些额外的标头，然后发送响应：

```
def send_url(method):

    response = app.make_response(url_for(method))

    response.headers.add('Last-Modified', datetime.datetime.now())
    response.headers.add('Cache-Control', 'no-store, no-cache, must-revalidate, post-check=0, pre-check=0')
    response.headers.add('Pragma', 'no-cache')

    return response 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-29T09:21:45.727

仅仅因为偶尔有一个新版本就禁用所有缓存确实不是一个好习惯。css 和 js 的缓存带来了巨大的性能优势。

好的网站所做的是将文件的时间戳添加到资源 URL 中。例如，在 Flask 中，这是一种透明地执行此操作的方法：http: [//flask.pocoo.org/snippets/40/](http://flask.pocoo.org/snippets/40/)

# c# - Web 服务在处理线程的同时响应调用者

> ID：11997052
> 
> 赞同：3
> 
> 时间：2012-08-16T23:52:40.700
> 
> 标签：c#, asp.net, web-services, asmx

**我正在创建一个 Web 服务**
在 Web 服务内部，我做了一些处理，这非常快，我使用 SmtpClient.SendAsync() 异步发送 2 到 3 封电子邮件。

我的问题是，即使它们是异步发送的，我也必须等待它们完成处理，然后才能结束服务并向用户发回响应。如果我不等待 SendCompletedEventHandler 触发，则永远不会发送电子邮件。有时邮件服务器需要一些时间来响应。

用户实际上并不需要知道电子邮件是否已发送。最好只发送电子邮件并让他们在其他地方处理并尽快回复用户。

有人会对此有一个好的解决方案吗？也许我的搜索措辞错误，但我没有提出任何解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:20:40.603

您可以启动一个新线程来进行发送：

```
ThreadPool.QueueUserWorkItem(delegate {
    SmtpClient client = new SmtpClient();
    // Set up the message here
    using (MailMessage msg = new MailMessage()) {
        client.Send(msg);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T07:12:01.047

这是我已经测试并使用 WCF 的完整示例。控制立即返回给客户端，服务器开始发送，休眠以模拟延迟，然后完成。只需添加对 System.ServiceModel 的引用即可获取必要的类。

```
class Program
{
    static void Main(string[] args)
    {
        ServiceHost host = new ServiceHost(typeof(HelloWorldService), new Uri("http://localhost:3264"));
        ServiceMetadataBehavior mdb = new ServiceMetadataBehavior();
        mdb.HttpGetEnabled = true;
        host.Description.Behaviors.Add(mdb);
        host.Open();

        Console.WriteLine("Service Hosting...");
        Console.ReadLine();
    }
}

[ServiceContract]
class HelloWorldService
{
    [OperationContract]
    public void SendEmails()
    {
        Task.Factory.StartNew(() =>
        {
            Console.WriteLine("Start Sending Emails...");
            Thread.Sleep(10000);
            Console.WriteLine("Finish Sending Emails...");
        });
    }
} 
```

}

# jquery-ui - jQueryUI droppable，停止传播到重叠的兄弟

> ID：11997053
> 
> 赞同：11
> 
> 时间：2012-08-16T23:52:45.293
> 
> 标签：jquery-ui, jquery-ui-droppable

正如你在这里看到的：http: [//jsfiddle.net/rA4CB/6/](http://jsfiddle.net/rA4CB/6/)

当我在重叠区域中放置它时，它会在两个可放置对象中接收，当项目是兄弟时，贪婪不起作用。有什么方法可以阻止接收 zIndex 中较低的 droppables 吗？

顺便说一句，mouseOver 不会触发可放置元素，因为鼠标实际上是在可拖动元素上。

相关JS：

```
$(function() {
    $( "#draggable" ).draggable();
    $( "#droppable" ).droppable({
        tolerance:'pointer',
        drop: function( event, ui ) {
            $( this )
                .addClass( "ui-state-highlight" )
                .find( "p" )
                    .html( "Dropped!" );
        }
    });
    $( "#droppable2" ).droppable({
        tolerance:'pointer',
        greedy:true,
        drop: function( event, ui ) {
            $( this )
                .addClass( "ui-state-highlight" )
                .find( "p" )
                    .html( "Dropped!" );
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-17T00:03:50.877

好的，所以我花了一个小时试图弄清楚，然后我一问就找到答案

[http://jsfiddle.net/rA4CB/7/](http://jsfiddle.net/rA4CB/7/)

将 JS 修改为以下内容：

```
$(function() {
    $( "#draggable" ).draggable();
    $( "#droppable" ).droppable({
        tolerance:'pointer',
        drop: function( event, ui ) {
            $( this )
                .addClass( "ui-state-highlight" )
                .find( "p" )
                    .html( "Dropped!" );
        }
    });
    $( "#droppable2" ).droppable({
        tolerance:'pointer',
        greedy:true,
        drop: function( event, ui ) {
            $( this )
                .addClass( "ui-state-highlight" )
                .find( "p" )
                    .html( "Dropped!" );
        },
        over: function(event, ui){
            $( "#droppable" ).droppable( "disable" )
        },
        out: function(event, ui){
            $( "#droppable" ).droppable( "enable" )
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-02-09T09:57:07.807

```
$( "#droppable" ).droppable({
    greedy: true,
    drop: function( event, ui ) {
       if(ui.helper.is(".dropped")) {
           return false;
       }
       ui.helper.addClass(".dropped");
    }
}); 
```

只需在可拖动的 ui.helper 上设置一个 css 类。如果该可拖动对象已被接受一次，它将被所有其他可放置对象拒绝（也可以使用可放置的“接受”参数来完成，例如`accept : ":not(.dropped)"`添加到 ui.draggable 的类）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-25T11:46:46.160

如果您在容器区域中有**许多 droppable**，那么呢？？？？

你必须重新考虑这个问题。**贪婪**只适用于**父子关系**，而不适用于**兄弟姐妹**。所以你必须编辑 droppable js 或者为它添加你自己的逻辑。

因此，如果您有许多 droppable，那么您必须编写一些额外的代码来处理完美 droppable 上的删除，就像在这个示例[中一样。](http://jsfiddle.net/rA4CB/58/)

为了使完美的**兄弟姐妹可**放置，请修改您的**droppbale**，如下所示

```
 var topElement = undefined;
        var topElementArray = Array();

        $( "#draggable" ).draggable();
        $( ".droppableBox" ).droppable({
            activeClass: "active-droppable",
            tolerance:'pointer',
            over: function( event, ui ) { 
                // This is for only show a message that z-index must be required for proppable
                // you can remove it after testing or after development
                if ($(this).css("z-index") == 'auto') {
                    alert("Please provide z-index for every droppable.");
                    return;
                }
                //

                topElement = undefined;
                topElementArray = Array();
                // Change it as you want to write in your code
                // For Container id or for your specific class for droppable or for both
                $('#demo > .droppableBox').each(function(){                     
                    _left = $(this).offset().left, _right = $(this).offset().left + $(this).width();
                    _top = $(this).offset().top, _bottom = $(this).offset().top + $(this).height();
                    if (event.pageX >= _left && event.pageX <= _right && event.pageY >= _top && event.pageY <= _bottom) {   
                          topElementArray.push($(this).attr('id'));
                    }
                });
            },
            drop: function( event, ui ) {
                if (!topElement) {
                    topElement = determineTopElement(topElementArray);
                }                   
                if ($(this).attr('id') == $(topElement).attr('id')) {
                    $( this ).addClass( "ui-state-highlight" ).find( "p" ).html( "Dropped!" );
                  // Your code after successful dropped element on specific siblings
                  // Start writing code for dropped element & perfect droppable
                }

            }
        });

        determineTopElement = function(_array) {
            var topElement;
            var zIndexHighest = 0;
            for (i = 0; i < _array.length; i++){
               var element = $("#"+ _array[i]);
               var z_index = $(element).css("z-index");
               if( z_index > zIndexHighest){
                   zIndexHighest = z_index;
                   topElement = element;
               }
            }
            return topElement;       
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-18T06:51:25.760

在某些情况下：

```
myjQuery.droppable({
  over:function(evt,ui){
    ui.draggable.attr('drg_time', this.drg_time = evt.timeStamp)
  },
  accept:function(draggeds){
    if(draggeds.attr('drg_time'))
    {
      return draggeds.attr('drg_time') == this.drg_time
    }
    return draggeds.hasClass('acceptable_classes_here')
  },
  out:function(evt,ui){
    // useless but cleaner
    ui.draggable.removeAttr('drg_time')
  }
  drop:...,
}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-26T00:07:53.523

我有同样的问题并做了一个小插件:)

一探究竟：

[https://stackoverflow.com/a/16720944/1308461](https://stackoverflow.com/a/16720944/1308461)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-31T19:30:37.980

我发现使用#invertedSpear 的方法会导致UI 状态发生变化，这在某些情况下是不可取的。这是代码。

```
var lastOpertion = new Date().getTime();

drop: function (event, ui) {
        if (new Date().getTime() - lastOpertion < 100) return;
        lastOpertion = new Date().getTime();
        ....
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-03T11:36:29.997

所以，当试图找到简单的解决方案时，我想出了这个（它对我有用）：

```
 window.overNowOnThis = "";
            window.olderOnes = [];
            $obj.droppable({
                accept: ".draggable_imgs",
                drop: function(e, ui) {
                    if(window.overNowOnThis == this){
                        // Do whatever
                    }
                },
                over: function(event, ui){
                    window.olderOnes.push(window.overNowOnThis);
                    window.overNowOnThis = this;
                },
                out: function(){
                    var lastElem = window.olderOnes.pop();
                    window.overNowOnThis = lastElem;
                }
            }); 
```

将选择顶部元素，因为它“over”会触发最后一个元素。另外 - 如果有两个以上的兄弟姐妹 - 那么当移出元素时，我们将最后一个设置为当前。例如，使用全局“窗口”。更好的选择是使用类，因为它可以安全地保存数据。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-11-22T01:03:34.463

它与invertedSpear 的答案非常相似。我不得不稍微改变它，因为在“over”/“out”内部启用/禁用对我不起作用。我必须在下面做

```
$("#droppable2").droppable({
    greedy: true,
    drop: function (event, ui) {
        $("droppable").droppable("disable");
    }
} 
```

当我需要它时，我必须明确启用“droppable” div。例如，在启动拖动事件时启用它。例如

```
$("#drageMe").draggable({
 start:function(event,ui){
   $("droppable").droppable("enable"); 
```

} })

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-02-11T10:18:12.963

在 ui dropable 中尝试贪婪选项。请参阅下面的小提琴链接进行演示：

[http://jsfiddle.net/creators_guru/3vT5C/embedded/result/](http://jsfiddle.net/creators_guru/3vT5C/embedded/result/)

```
$( ".circles" ).droppable({
    greedy: true,
    drop: function( event, ui ) {
        $_data  =   ('drgged class = ' + ui.draggable.attr('class'));
        $_data1 =   ('droped id = #' + $(this).attr('id'));
        $('#data').html($_data + '<br/>'+$_data1);
        return false;
    }
}); 
```

# c# - 如何防止命名空间污染？

> ID：11997055
> 
> 赞同：2
> 
> 时间：2012-08-16T23:53:01.963
> 
> 标签：c#

我有一个定义类的程序

```
namespace @default
{
    public class Test
    {
    }
} 
```

然后，我引用另一个没有命名空间的库，其中包含一个名为`Test`. 如何隐藏这个其他库`Test`类，以便我的程序看不到`@default.Test`其他库`Test`类？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T00:02:41.437

默认情况下，在您的`default`命名空间内，`default.Test`该类是您说`Test`.

在您的`default`命名空间之外，您需要在 using 语句中执行以下操作：

```
using ExternalTest = global::Test;
using Test = default.Test; 
```

第一行并不是绝对必要的，因为您可以`global::Test`在任何地方使用。

对于那些以前没有遇到过 global 的人：[global (C# Reference)](http://msdn.microsoft.com/en-us/library/cc713620.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T00:42:35.717

在标识符名称前加上前缀，`global::`表示应该从全局（未命名）命名空间开始找到它。例如：

```
class Test { }

namespace Default {
    public class Test {
        global::Test theOtherOne;
    }
} 
```

您会经常看到它在自动生成的代码中使用，以避免意外的名称冲突。像 Resources.Designer.cs

# android - 在 Mac OS X 上运行的 Android 模拟器的键盘快捷键

> ID：11997059
> 
> 赞同：1
> 
> 时间：2012-08-16T23:53:11.837
> 
> 标签：android, macos, emulation

我四处搜索，只是找不到 Android 模拟器的某些键盘快捷键。具体来说，相当于输入/单击。我发现 fn+left 箭头将从突出显示一个图标移动到另一个但没有动作。

只需单击 似乎对 Android 模拟器没有任何影响。（我正在运行 OS X Lion）。也许我需要配置一些东西？

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T02:42:52.110

我猜您的 AVD（硬件属性）中没有将**键盘支持**设置为**yes**，这就是您的键盘无法正常工作的原因。
然后大多数键将按预期工作。

# ember.js - Ember-Data 递归 hasMany 关联

> ID：11997066
> 
> 赞同：11
> 
> 时间：2012-08-16T23:54:20.143
> 
> 标签：ember.js, ember-data

有没有人使用 ember-data 来建模数据树？

我会假设它会是这样的：

```
Node = DS.Model.extend({
    children: DS.hasMany(Node),
    parent:   DS.belongsTo(Node)
}); 
```

但是，我无法让这个工作，这导致人们相信：1）我在设置它的方式上完全错误，或者，2）目前无法使用 ember 对树建模-数据。

我希望是前者而不是后者...

当然它可能是 JSON ......我假设 JSON 应该是以下形式：

```
{
    nodes: [
        { id: 1, children_ids: [2,3], parent_id: null },
        { id: 2, children_ids: [], parent_id: 1 },
        { id: 3, children_ids: [], parent_id: 1 }
    ]
} 
```

对此问题的任何提示/建议将不胜感激。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-21T08:16:21.127

有几件小事会阻止你的小提琴工作：

*   该`DS.hasMany`函数要求一个字符串作为参数。不要忘记引号：`DS.hasMany('Node')`

*   在夹具定义中，`hasMany`关系不应以`_ids`或任何东西为后缀。只需使用简单的名称。例如：`{ id: 42, children: [2,3], parent_id: 17 }`

*   的`length`属性`DS.ManyArray`应该使用以下`get`函数访问：`root.get('children.length')`

*   默认情况下，fixture 适配器模拟一个 ajax 调用。查询将`find`在等待 50 毫秒后填充记录。在你的小提琴中，`root.get('children.length')`电话来得太早了。您可以配置夹具适配器，使其进行同步调用：

    ```
    App.store = DS.Store.create({
        revision: 4,
        adapter: DS.FixtureAdapter.create({
            simulateRemoteResponse: false
        })
    }); 
    ```

    或者您可以在没有任何适配器的情况下将数据加载到商店：

    ```
    App.store.loadMany(App.Node, [
        { id: 1, children: [2, 3] },
        { id: 2, children: [], parent_id: 1 },
        { id: 3, children: [], parent_id: 1 }
    ]); 
    ```

*   最后一个：似乎 Ember 应用程序应该在全局范围内声明（否`var`），而 Ember 数据模型应该在应用程序范围内声明（替换`var Node = ...`为`App.Node = ...`）

完整示例：

```
App = Ember.Application.create();

App.store = DS.Store.create({
    revision: 4
});

App.Node = DS.Model.extend({
    children: DS.hasMany('App.Node'),
    parent:   DS.belongsTo('App.Node')
});

App.store.loadMany(App.Node, [
    { id: 1, children: [2, 3] },
    { id: 2, children: [], parent_id: 1 },
    { id: 3, children: [], parent_id: 1 }
]);

var root = App.store.find(App.Node, 1);

alert(root.get('children'));
alert(root.get('children.length')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-23T16:03:41.140

在我设置逆向之前，这对我不起作用：

```
App.Node = DS.Model.extend({
    children: DS.hasMany('App.Node', {inverse: 'parent'}),
    parent:   DS.belongsTo('App.Node', {inverse: 'children'}) }); 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-03-07T06:30:03.153

不确定，但根据 ember 指南中给出的示例

```
App.Post = DS.Model.extend({
  comments: DS.hasMany('App.Comment')
}); 
```

JSON 应该将关系编码为 ID 数组：

```
{
  "post": {
    "comment_ids": [1, 2, 3]
  }
} 
```

# java - 如何检查字符串生成器的内容

> ID：11997069
> 
> 赞同：0
> 
> 时间：2012-08-16T23:56:03.573
> 
> 标签：java, android

我正在尝试解析一些 JSON 并将其发送到我的 android 应用程序中的 EditText 字段。我最近发现我遇到的一个错误源于我的 StringBuilder 的内容。我没有使用我的 StringBuilder，而是将一个 json 样本硬编码为一个字符串并将其发送到 EditText 字段。这很好用，我得到了我正在寻找的价值。但是我需要通过访问我正在使用的 API 而不是硬编码来工作。下面是我的 JSON Parser 类。有没有一种方法可以在 inputStream 关​​闭之前附加后检查我的 stringBuilder 中的内容。这样我就可以解决这个问题并将我的 jSon 返回到 stringBuilder.toString() 而不是硬编码它。

```
package com.apitest.rottentomatoestest;

import java.io.*;
import org.apache.http.*;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.*;

import android.util.Log;

public class JSONParser {

static InputStream inputStream = null;
static JSONObject jObject = null;
static String jSon = "";

public JSONParser() {
    // TODO Auto-generated constructor stub
}

public JSONObject getJSONFromUrl(String url){

    //Make HTTP Request
    try {
        //defaultHttpClient
        DefaultHttpClient httpClient = new DefaultHttpClient();
        HttpPost httpPost = new HttpPost(url);

        HttpResponse httpResponse = httpClient.execute(httpPost);
        HttpEntity httpEntity = httpResponse.getEntity();
        inputStream = httpEntity.getContent();

    } catch (UnsupportedEncodingException e){
        e.printStackTrace();
    } catch (ClientProtocolException e){
        e.printStackTrace();
    }catch (IOException e){
        e.printStackTrace();
    }

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream, "UTF-8"), 8);
        StringBuilder stringBuilder = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null){
            stringBuilder.append(line + "\n");
        }
        inputStream.close();

        jSon = "{\"cast\":[{\"id\":\"162661723\",\"name\":\"Snoop Dogg\"}]}";

    } catch (Exception e){
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }
    //try to parse the string to JSON Object
    try {
        jObject = new JSONObject(jSon);

    } catch (JSONException e){
        Log.e("JSON Parser", "Error parsing data " + e.toString());
    }
    //return JSON String
    return jObject;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T00:02:24.917

您可以使用：

```
Log.d("JSON Contents", stringBuilder.toString()); 
```

就在你关闭 inputStream 之前。

更新：该`596 Service Not Found`消息通常是由[不正确的 URL](https://developer.bodymedia.com/forum/read/122978)引起的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T00:29:44.600

尝试这样做：

```
BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T09:19:18.370

您可以`org.json.JSONObject`用于将 JSON 解析为可用的 Java 对象。

# wso2 - WSO2 ESB - 如何为端点启用跟踪

> ID：11997070
> 
> 赞同：1
> 
> 时间：2012-08-16T23:56:08.697
> 
> 标签：wso2, wso2esb, wso2carbon

在 WSO2 4.0.2 ESB 的文档中，它说如下

> 端点还有一个 trace 属性，它打开发送到端点的消息的详细跟踪信息。这些在通过 log4j.properties 文件配置的 trace.log 中可用（解压缩 wso2 ESB ZIP 后，可以在 lib 文件夹中找到该文件）。将跟踪日志级别设置为 TRACE 将转储详细的跟踪信息，包括消息有效负载。

您能否分享示例 log4j 片段以开始跟踪端点。我是否还必须启用对代理服务的跟踪才能启用对端点的跟踪？

你能详细说明一下吗？谢谢阿比吉特

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T07:29:56.787

您可以将类的命名空间添加到应该被跟踪的 log4j.properties（在 WSO2 的 lib 文件夹中）。使用以下行，您将启用端点跟踪：

```
log4j.category.org.apache.synapse.endpoints=TRACE 
```

这可以跟踪所有端点（不幸的是，不仅针对您的特定端点）。顺便说一句，这种配置对于为您自己的类启用跟踪或日志记录也很重要：

```
log4j.logger.com.yourCompany=DEBUG 
```

上述端点跟踪的启用将导致这样的日志（端点指向 JMS 队列）：

```
[2012-08-17 09:22:13,855] DEBUG - AddressEndpoint Sending message through endpoint : endpoint_9b9ef24d0d136e3e709a6c21cac87806d5d547bc5ba68dc6 resolving to address = jms:/myJMS?transport.jms.DestinationType=topic&transport.jms.ConnectionFactoryJNDIName=QueueConnectionFactory&java.naming.factory.initial=org.apache.activemq.jndi.ActiveMQInitialContextFactory 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T07:43:16.817

正如 FiveO 所说，您可以编辑 log4j 文件以查看发生了什么。但是还有另一种方法可以为端点启用跟踪属性。您只需将`trace="enable"`属性添加到端点配置中即可。

```
<address uri="http://abc.com" trace="enable"> 
```

# mysql - Magento-Check.php 认为我使用的 MySQL 版本比我现在低

> ID：11997072
> 
> 赞同：3
> 
> 时间：2012-08-16T23:56:15.287
> 
> 标签：mysql, magento

我在开发过程中遇到了一些网站问题，因此决定运行 magento-check.php 文件以查看是否一切正常。结果是。

```
Your server does not meet the following requirements in order to install Magento.
The following requirements failed, please contact your hosting provider in order to receive assistance with meeting the system requirements for Magento:

You need MySQL 4.1.20 (or greater)
The following requirements were successfully met:
You have PHP 5.2.0 (or greater)
Safe Mode is off
You have the curl extension
You have the dom extension
You have the gd extension
You have the hash extension
You have the iconv extension
You have the mcrypt extension
You have the pcre extension
You have the pdo extension
You have the pdo_mysql extension
You have the simplexml extension 
```

问题是我正在运行 MySql Server 版本：5.5.24-0ubuntu0.12.04.1

另请注意，Magento 已安装在服务器上并正在运行。我遇到的问题是仅在产品页面上出现一致的 500 Internal Server Errors。我不认为这些问题是相关的，但它仍然很奇怪。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T00:13:07.730

我不确定那里有问题，但是如果您在谈论此处分发的 magento-check.php 脚本

```
http://www.magentocommerce.com/knowledge-base/entry/how-do-i-know-if-my-server-is-compatible-with-magento/ 
```

这将获得带有以下注释的 mysql 版本

```
preg_match('/[0-9]\.[0-9]+\.[0-9]+/', shell_exec('mysql -V'), $version); 
```

然后比较使用

```
if(version_compare($version[0], '4.1.20', '<')) { 
```

换句话说，脚本运行以下 shell 命令

```
$ mysql -V 
```

然后在输出中查找 XXX 版本号。例如，这个

```
/usr/local/mysql/bin/mysql  Ver 14.14 Distrib 5.1.41, for apple-darwin9.5.0 (i386) using readline 5.1 
```

表示脚本认为版本是`5.1.41`.

我的猜测是您正在使用删除服务器。**这意味着上面的脚本会检查本地**运行的 mysql cli 客户端的版本。也有可能你没有在本地运行任何 mysql，这意味着脚本会尝试解析文本

```
mysql: command not found 
```

要版本号，但找不到。

至于您的 500 Internal Server Errors，这意味着 apache 有错误，或者 PHP 有错误。分别检查他们的错误日志，看看错误是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-16T07:12:39.053

您需要使用 php 和 mysql 检查确切的 magento 版本支持，我希望下面的代码可能有助于检查 PHP 和 MySQL 的确切版本

```
##Test What Exact Version PHP & MySQL
echo "<h2>Exact Version PHP & MySQL: </h2>";
printf("PHP version: %s\n", PHP_VERSION); 
$mysql = mysqli_connect('localhost', 'devonbd_com', 'XSZefjGW'); 
#$mysql = mysqli_connect('localhost', 'root', ''); 
## Test the MySQL connection 
if (mysqli_connect_errno()) {
printf("</br> Connection failed: %s\n", mysqli_connect_error());
exit();
}
## Print the MySQL server version 
printf("</br> MySQL server version: %s\n", mysqli_get_server_info($mysql)); 
##Close the MySQL connection 
mysqli_close($mysql); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-18T15:09:52.540

我刚刚解决了这个问题。事实证明，MySQL 警告可能是误报；对我来说，将 PHP 版本（我正在使用 MAMP）从 7 更改为 5.6 就可以了。查看一些论坛，将 PHP 版本从 5.3 降低到 5.2 也适用于某些人。

# python - 基于多个相邻值的 XPATH

> ID：11997085
> 
> 赞同：2
> 
> 时间：2012-08-16T23:58:06.340
> 
> 标签：python, xml, xpath

正确执行以下操作的以下语法是什么？

```
title_node.find("EST/EST_Version
                       [Master_Type_HD_SD='HD'] AND [Version_Type='Standard']
                     /Vendor_ID").text 
```

以下是 xml 的外观：

```
<EST_Version>
  <Vendor_ID>1660023-200455</Vendor_ID>
  <Version_Type>Standard</Version_Type>
  <Master_Type_HD_SD>SD</Master_Type_HD_SD>
</EST_Version> 
```

这本质上就是我想要做的（虽然以下是不正确的）

```
title_nod.find("EST/EST_Version[Master_Type_HD_SD='SD']/../
                   EST_Version[Version_Type='Directors Cut']/Vendor_ID").text 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:28:02.947

对于多个谓词过滤器（方括号），不要将它们与`and`. 只需按顺序使用它们。第一个谓词过滤器应用于集合，然后应用下一个谓词过滤器：

```
EST/EST_Version[Master_Type_HD_SD='HD'][Version_Type='Standard']/Vendor_ID 
```

在单个谓词过滤器中，您将使用`and`多个条件：

```
EST/EST_Version[Master_Type_HD_SD='HD' and Version_Type='Standard']/Vendor_ID 
```

# javascript - Rally App SDK 2.0：Ext.Element 方法“不可选择”没有那么规范化

> ID：11997086
> 
> 赞同：1
> 
> 时间：2012-08-16T23:58:21.687
> 
> 标签：javascript, extjs, extjs4, rally

即使“不可选择”方法应该禁用文本选择，它在 IE 中也不能正常工作，至少在 IE8 中。文本光标仍然存在，并允许输入。

我应该假设它在 IE9 中也不起作用，因为 Microsoft 等效 CSS 属性“-ms-user-select”最近才在 IE10 中引入，尚未“正式”发布，目前也不支持Windows 7的。

我还应该质疑为什么也不包括 webkit 版本（“-webkit-user-select”）。我知道 webkit 是 khtml 的一个分支，它似乎在 Chrome 中按预期工作，但我仍然质疑这个遗漏。

```
/**
* Disables text selection for this element (normalized across browsers)
* @return {Ext.Element} this
*/
unselectable : function(){
    var me = this;
    me.dom.unselectable = "on";

    me.swallowEvent("selectstart", true);
    me.applyStyles("-moz-user-select:-moz-none;-khtml-user-select:none;");
    me.addCls(Ext.baseCSSPrefix + 'unselectable');

    return me;
} 
```

是否有一种简单的方法来修改此代码，以便在 IE10 之前的 IE 版本中提供适当的功能？

**编辑**：我在让它工作时遇到了一些麻烦。我在 onReady 调用中插入了以下内容，但在应用程序之前。

```
(function() {
    var Ext = window.Ext4 || window.Ext;

    Ext.override(Ext.dom.Element, {
        unselectable: function() {
            var me = this;
            me.dom.unselectable = "on";

            me.swallowEvent("selectstart", true);

            me.applyStyles([
                '-moz-user-select: none;', 
                '-khtml-user-select: none;', 
                '-webkit-touch-callout: none;', 
                '-webkit-user-select: none;', 
                '-ms-user-select: none;', 
                'user-select: none'
            ].join());

            me.addCls(Ext.baseCSSPrefix + 'unselectable');

            return me;
        },

        selectable: function() {
            var me = this;
            me.dom.unselectable = "off";
            // Prevent it from bubles up and enables it to be selectable
            me.on('selectstart', function(e) {
                e.stopPropagation();
                return true;
            });

            me.applyStyles([
                '-moz-user-select: text;', 
                '-khtml-user-select: text;', 
                '-webkit-touch-callout: text;', 
                '-webkit-user-select: text;', 
                '-ms-user-select: text;', 
                'user-select: text'
            ].join());

            me.removeCls(Ext.baseCSSPrefix + 'unselectable');
            return me;
        },
    });
})(); 
```

但是，我收到此错误：

> 未捕获的类型错误：无法读取未定义的属性“元素”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T17:07:47.403

该行`me.dom.unselectable = "on";`用于处理`unselectable`IE9 及更低版本。这将为元素添加一个属性，如`<div unselectable="on">blah</div>`，这将导致 div 的文本不再可编辑。那不适合你吗？

不幸的是，Ext似乎并不能很好地处理 webkit，您可以通过覆盖这些方法来解决这个问题`unselectable`。`selectable`如何覆盖该方法取决于您使用的 SDK 版本。

# 适用于 App SDK 2.0p 和 2.0p2

这些版本的 SDK 是针对 ExtJS 4.0.7 构建的。在 Ext 4.0 中，您不能使用`Ext.override`来修补`Ext.Element`. 因此，您需要更加手动并更改原型：

```
Ext.core.Element.prototype.unselectable = function() {
   var me = this;
   me.dom.unselectable = "on";

   me.swallowEvent("selectstart", true);

   me.applyStyles([
    '-moz-user-select: none;', 
    '-khtml-user-select: none;', 
    '-webkit-touch-callout: none;', 
    '-webkit-user-select: none;', 
    '-ms-user-select: none;', 
    'user-select: none'
    ].join());

   me.addCls(Ext.baseCSSPrefix + 'unselectable');

   return me;
};

Ext.core.Element.prototype.selectable = function() {
   var me = this;
   me.dom.unselectable = "off";
   // Prevent it from bubles up and enables it to be selectable
   me.on('selectstart', function(e) {
       e.stopPropagation();
       return true;
   });

   me.applyStyles([
    '-moz-user-select: text;', 
    '-khtml-user-select: text;', 
    '-webkit-touch-callout: text;', 
    '-webkit-user-select: text;', 
    '-ms-user-select: text;', 
    'user-select: text'
    ].join());

   me.removeCls(Ext.baseCSSPrefix + 'unselectable');
   return me;
}; 
```

您应该将其作为内部的第一件事`Rally.onReady()`

# 适用于 App SDK 2.0p3 及更高版本

适用于 2.0p3 及更高版本的 App SDK 是针对 ExtJS 4.1 构建的。他们将 Ext.Element 更改为 support `Ext.override`，所以在这里我们可以做一个稍微干净的解决方案（这基本上是我最初发布的内容）：

```
Ext.override(Ext.dom.Element, {
    unselectable: function() {
        var me = this;
        me.dom.unselectable = "on";

        me.swallowEvent("selectstart", true);

        me.applyStyles([
            '-moz-user-select: none;', 
            '-khtml-user-select: none;', 
            '-webkit-touch-callout: none;', 
            '-webkit-user-select: none;', 
            '-ms-user-select: none;', 
            'user-select: none'
        ].join());

        me.addCls(Ext.baseCSSPrefix + 'unselectable');

        return me;
    },

    selectable: function() {
        var me = this;
        me.dom.unselectable = "off";
        // Prevent it from bubles up and enables it to be selectable
        me.on('selectstart', function(e) {
            e.stopPropagation();
            return true;
        });

        me.applyStyles([
            '-moz-user-select: text;', 
            '-khtml-user-select: text;', 
            '-webkit-touch-callout: text;', 
            '-webkit-user-select: text;', 
            '-ms-user-select: text;', 
            'user-select: text'
        ].join());

        me.removeCls(Ext.baseCSSPrefix + 'unselectable');
        return me;
    }
 }); 
```

在这两种情况下，只需稍微调整函数即可为 webkit、IE 等添加样式。

# vim - 有没有办法在不使用 --servername 的情况下区分 gvim 的实例？

> ID：11997087
> 
> 赞同：2
> 
> 时间：2012-08-16T23:58:26.443
> 
> 标签：vim

由于我的问题[在 vimrc 中设置服务器名而不是命令行开关](https://stackoverflow.com/questions/11922732/setting-servername-in-vimrc-as-opposed-to-command-line-switch)被证明是不可行的，我正在寻求帮助。有什么方法可以区分 gvim 的不同实例吗？

场景：我正在为 vim 制作一个轻量级的实时 LaTeX 插件。目前，只要我只有一个 gvim 实例运行，它就可以工作。但是，如果我`.tex`在不同的窗口中打开了两个文件，我用来让我的预览器 yap 与 vim 对话的命令

```
"C:\Program Files (x86)\Vim\vim73\gvim.exe" --remote +%l "%f 
```

并不总是与 gvim 运行的正确实例对话。在我之前的问题中，我试图使用该`--servername`选项使其与正确的实例对话，但是由于我通过右键单击->打开方式->gvim打开gvim，并且由于我无法在运行时设置服务器名称，我无法让 gvim 的每个实例都获得唯一的服务器名。

那么有什么方法可以唯一地识别 gvim 的每个实例吗？我最后的破解方法是使用 autohotkey 解析窗口标题中的文件名并通过 autohotkey 发送密钥，但我觉得应该有一种更简单的方法......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T06:54:31.817

每个启动的 Vim 实例都会自动拥有一个唯一的`v:servername`; 在 Windows 上，我得到`GVIM`, `GVIM1`, `GVIM2`, ...

[（Peter Rincker 在评论中已经提到过。）]

# c# - MonoTouch 库项目仅在直接引用时有效

> ID：11997088
> 
> 赞同：1
> 
> 时间：2012-08-16T23:58:27.107
> 
> 标签：c#, ios, xamarin.ios, monodevelop

我创建了一个简单的库项目以在另一个 monotouch 项目中使用。当 ProjectA 引用 LibraryProjectB.csproj 时，它可以完美运行。但是，当 ProjectA 引用由 LibraryProjectB (LibraryProjectB.dll) 创建的 .dll 时，我会收到一些编译器错误，例如“编译器错误，方法*_*不存在”

为什么直接链接项目会起作用，而项目创建的 DLL 会导致错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T14:55:47.780

这是因为当您执行此操作时，您的构建步骤会出现问题。因此，您将一个方法添加到您的库中，并在您的项目中使用它。好吧，您的应用程序可以先构建，然后无法引用新方法。

您需要直接引用该项目。

# git - 由于 SSL 问题，Sublime Text 2 包控制无法安装包

> ID：11997092
> 
> 赞同：1
> 
> 时间：2012-08-16T23:58:53.250
> 
> 标签：git, sublimetext2

我在 Windows 7 Ultimate 64bit 上运行 Sublime Text 2，当我尝试安装包时，提示以下错误：

```
Package Control: There are no packages available for installation 
```

这个错误出现在控制台中：

```
Package Control: Error submitting usage information. URL error _ssl.c:480: error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed downloading https://sublime.wbond.net/submit?package_control_version=1.5.0&sublime_platform=windows&package=Package+Control&sublime_version=2217&version=1.5.0&operation=install.
Package Control: Skipping automatic upgrade, last run at 2012-08-16 16:40:50, next run at 2012-08-16 17:40:50 or after 
```

Package Control 之前在完全相同的网络和计算机上工作，唯一不同的是这是我安装在分区中的新系统。

我没有任何代理运行；关闭防火墙试了下，还是一样的结果。

另外，我在 Windows 命令行中 git 克隆了一些存储库，并且还有一个 SSL 错误。所以我在互联网上搜索它并通过使用以下命令关闭 SSL 验证来解决它，但 Sublime Text 2 仍然无法通过 SSL 验证。

```
git config --global http.sslVerify false 
```

有人可以帮我解决这个问题。如果没有包控制，生活会变得更加艰难。

谢谢

# c# - 通过 c# 渲染 javascript（或 css）

> ID：11997097
> 
> 赞同：0
> 
> 时间：2012-08-16T23:59:16.747
> 
> 标签：c#, asp.net, sharepoint-2010

我想通过 C# 为 Sharepoint-2010 页面执行下面的 javascript。做这个的最好方式是什么？

```
<script type="text/javascript" >
  document.getElementById("LeftNavigationAreaCell").style.display="none";     
</script> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T01:34:16.917

我不知道这是否适用于 sharepoint 但[ScripManager](http://msdn.microsoft.com/es-es/library/system.web.ui.scriptmanager.aspx)类用于在 WebPages 中执行此类操作，请检查`RegisterStartupScript`或`RegisterClientScriptBlock`方法

希望能帮助到你...

# python - 使用wsgi脚本调用exe

> ID：11997099
> 
> 赞同：2
> 
> 时间：2012-08-16T23:59:26.350
> 
> 标签：python, django, exe, wsgi

我正在运行 apache、Django 和 wsgi。我还使用另一个名为**SAS**的软件进行统计分析。只是给你一些背景。我的最终目标是当客户端在用 django 编写的表单上点击提交时，调用适当的 sas 脚本*（通过 python wsgi 脚本）*在服务器上执行计算，然后将客户端重定向到输出页面。

我有一个名为`test5.py`. 它看起来像这样：

```
import os
import subprocess

def application(environ, start_response):

  status = '200 OK'
  output = 'Running External Program!'

  f = open("C:\Documents and Settings\eric\Desktop\out.txt", 'a')
  f.write('hi')
  f.close()

  #os.system(r'start "C:\Program Files\SAS92\SASFoundation\9.2\sas.exe"')
  #subprocess.call([r'C:\Program Files\SAS92\SASFoundation\9.2\sas.exe'])
  #os.startfile(r'C:\Program Files\SAS92\SASFoundation\9.2\sas.exe')
  response_headers = [('Content-type', 'text/plain'),
                      ('Content-Length', str(len(output)))]

  #start_response('301 Redirect', [('Location', 'http://myserver/reports'),])
  start_response(status, response_headers)

  return [output] 
```

所以发生的事情是`out.txt`文件确实被创建并`hi`写入了文件。这很酷。前 3 行注释是 3 次尝试让同样的脚本也调用`sas.exe`位于服务器上。我只是想让 any`.exe`现在开始工作，所以调用油漆或写字板就可以了。然而，这些行似乎并没有在`wsgi`上下文中执行。如果我只是加载 Python 命令行，我可以`.exes`很好地执行。此外，最后一条评论似乎在重定向中正常工作。我不确定是否需要配置 apache 来添加可执行文件。如果我使用的术语不正确，请原谅我。我对这一切还是很陌生。

谢谢

* * *

嗨，保罗，

我试图调查你的最后评论。我对我在寻找什么或如何寻找它感到有点困惑。这是我收集到的一些信息。顺便说一句，我在 Windows XP 上运行并使用 Apache 2.2。

我的 apache 是为所有用户安装的，因为在 regedit 中，变量 ServerRoot 位于 HKEY_LOCAL_MACHINE (http://httpd.apache.org/docs/2.2/platform/windows.html) 下。我也相信 SAS 安装在所有用户下。我通过让我的同事使用她的登录名登录来测试这一点，我仍然可以访问。我不确定这是否是一个足够的测试。

我运行 wsgi 时得到的日志如下。我不确定该过程是否为空是否重要。

[2012 年 8 月 20 日星期一 10:33:17] [info] [client 10.60.8.71] mod_wsgi (pid=5980, process='', application='..com|/test5'): 重新加载 WSGI 脚本 'C:/站点/cprm/pyscripts/test5.wsgi'。

我还尝试了我在之前发布的评论中发布的链接中的 .bat 技巧，但无济于事。我制作了一个简单的批处理文件，它只回显“hi”并将其放在我的 wsgi 脚本所在的同一目录中。我觉得那里应该没有访问问题，但我可能弄错了。我也只是尝试使用 subprocess 调用一个简单的 python 脚本来测试。同样什么也没发生。

也只是为了向您展示，我的 httpd.conf 文件如下所示：

AllowOverride 无 选项 无 订单允许，拒绝 全部允许

WSGIScriptAlias /test1 "C:/sites/cprm/pyscripts/test1.wsgi" WSGIScriptAlias /test2 "C:/sites/cprm/pyscripts/test2.py" WSGIScriptAlias /test3 C:/sites/cprm/pyscripts/test3.py WSGIScriptAlias /test4 "C:/sites/cprm/pyscripts/test4.py" WSGIScriptAlias /test5 "C:/sites/cprm/pyscripts/test5.wsgi" WSGIScriptAlias / "C:/sites/cprm/wsgi.py"

这些信息是否有用？另外，我是在寻找特定的环境变量还是什么？

再次感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:27:07.693

对于执行后台计算或其他任务的 Web 应用程序，恕我直言，最好将任务排队等待处理，而不是从 Django 视图调用外部进程并将所有内容挂起，直到任务完成。这会带来更好的结果：

*   用户体验（请求立即返回 - 使用 ajax 指示任务状态并在任务完成后显示下载链接）
*   安全性（后台进程可以在更安全的凭据下运行）
*   可扩展性（任务可以分布在服务器之间）
*   弹性（默认情况下，如果您的应用程序在 30 秒左右未能响应，许多网络服务器将发送“错误 500”）

对于处理队列中所有条目的后台守护程序，有几种方法取决于您想要扩展的大小：

*   一个 cron 工作
*   使用[主管](http://supervisord.org/)（或您选择的看门狗）的守护进程
*   像[django-celery这样的 AMQP 模块](http://celery.github.com/celery/index.html)

[编辑]

您从 WSGI 脚本启动的进程将在运行 Web 服务器的同一用户下运行。在 linux 中通常是“www-data”或“nobody”，在 Windows/IIS 中是“IUSR_MachineName”（如果使用 IIS 身份验证，则为经过身份验证的用户）。检查您是否可以使用运行 WSGI 的相同凭据启动程序。

# javascript - 基于单选/选择选项重定向

> ID：11997104
> 
> 赞同：-1
> 
> 时间：2012-08-17T00:00:43.347
> 
> 标签：javascript, jquery

作为 javascript 的新手，我有点不知所措。但我正在尝试：P

基本上我需要做的是根据下表中选择的选项重定向到一个 url。总共将进行 4 次检查。

*   如果选择了 Windows 和高级，则重定向到 A
*   如果选择了 Windows 和 Basic，则重定向到 B
*   如果选择 Mac 和 Basic，则重定向到 C
*   如果选择 Linux 和 Basic，则重定向到 D

但是，我不太确定如何获取每个单选按钮的特定名称并选择选项，更不用说查看它们是否被选中，并进行上面列出的检查。

如果有人能指出我正确的方向，将不胜感激。谢谢。

```
 <form action="process_form.php" class="TTWForm" method="post" novalidate="">
        <div id="field3-container" class="field f_100">
          <label for="field3">Your Operating System</label>
          <select name="field3" id="field3" required="required">
            <option id="field3-1" value="Windows"> Windows </option>
            <option id="field3-2" value="Mac"> Mac </option>
            <option id="field3-3" value="Linux"> Linux </option>
          </select>
        </div>
        <div id="field2-container" class="field f_100 checkbox-group required">
          <label for="field2-1">Version</label>
          <div class="option clearfix">
            <input type="radio" name="field2[]" id="field2-1" value="Basic">
            <span class="option-title"> Basic </span> <br>
          </div>
          <div class="option clearfix" id="optional">
            <input type="radio" name="field2[]" id="field2-2" value="Advanced">
            <span class="option-title"> Advanced </span> <br>
          </div>
        </div>
      </form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T00:19:21.583

我会添加一个按钮，并在提交表单时做一些事情：

```
$(".TTWForm").on('submit', function(e) {
    e.preventDefault();
    var field2 = $("#field2-1").is(':checked') ? 'Basic' : $("#field2-2").is(':checked') ? 'Advanced' : null,
        field3 = $("#field3").val();

    if (!field2) {
        alert('Select a version!');
        return;
    }

    var url = 'http://mysite.com/' + field2 + '/' + field3 + '/';
    document.location.href = url;
});​ 
```

[**小提琴**](http://jsfiddle.net/Jnat5/1/)

# java - JPA + Hibernate 得到 NoSuchFieldError

> ID：11997106
> 
> 赞同：0
> 
> 时间：2012-08-17T00:00:57.473
> 
> 标签：java, hibernate, jpa

我遇到了奇怪的 java.lang.NoSuchFieldError: NONE 运行时错误，它试图将 JPA 与 Oracle DB 一起使用。我正在使用 Maven 构建。这是关键文件。我猜有些JAR有问题。

pox.xml

```
 <dependency>
              <groupId>javax.persistence</groupId>
              <artifactId>persistence-api</artifactId>
              <version>1.0.2</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>3.5.6-Final</version>
    </dependency> 
```

持久性.xml

```
 <persistence-unit name="ifp-test" transaction-type="RESOURCE_LOCAL">
      <provider>org.hibernate.ejb.HibernatePersistence</provider>
      <properties>
         <property name="javax.persistence.jdbc.driver" value="oracle.jdbc.OracleDriver"/>
         <property name="javax.persistence.jdbc.user" value="something"/>
         <property name="javax.persistence.jdbc.password" value="something"/>
          <property name="javax.persistence.jdbc.url" value="jdbc:oracle:thin://@something_here"/>
         <property name="hibernate.dialect" value="org.hibernate.dialect.Oracle10gDialect"/>
         <property name="hibernate.hbm2ddl.auto" value="create-drop"/>
      </properties>
   </persistence-unit>
</persistence> 
```

Java 代码

```
 List arr_cust = entityManagerFactory.createEntityManager().createNativeQuery(sql_query).getResultList(); 
```

有人可以指出正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T23:27:27.247

我找到了解决方案。问题出在 pom.xml 中。这是正确的 pom.xml。

```
 <dependency>
        <groupId>org.hibernate.javax.persistence</groupId>
        <artifactId>hibernate-jpa-2.0-api</artifactId>
        <version>1.0.0.Final</version>
    </dependency>
    <dependency>
    <groupId>org.hibernate</groupId>
    <artifactId>hibernate-entitymanager</artifactId>
    <version>3.5.6-Final</version>
</dependency> 
```

# arduino - 当我按 Enter 键时，PuTTY 会发送什么？

> ID：11997108
> 
> 赞同：14
> 
> 时间：2012-08-17T00:01:14.760
> 
> 标签：arduino, ascii, putty, control-characters

我正在拼命地让蓝牙加密狗与我的 Arduino 一起工作，但我无法向它发送它需要的命令。当我通过 USB 转 UART 芯片将它插入我的计算机并`C`从 PuTTY 发送命令（）然后按时，我可以使用它`Enter`。

蓝牙加密狗的[命令表](http://www.sparkfun.com/datasheets/Wireless/Bluetooth/rn-bluetooth-um.pdf)显示我正在尝试发送的命令，`C<cr>`但我不知道如何从 Arduino 代码中发送正确的回车符。我已经尝试使用该`Serial.println()`功能以及将`\r`角色添加到我的当前角色中，`Serial.write("C\r")`但这些都不起作用。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-07-31T03:50:27.903

有趣的是，我可以在 Win 7 上报告相反的情况：我的 PuTTY 和我的嵌入式项目仅`\r`通过 COM 端口发送。好奇，阅读：令人沮丧地无法解释，但我只是在串行连接的另一端寻找任何一个字符。

然后，如果您在终端选项下启用“每个 CR 中的隐式 LF”，它将同时发送`\r\n`. 默认行为似乎类似于 Commodore 机器：D（[http://en.wikipedia.org/wiki/Newline](http://en.wikipedia.org/wiki/Newline)）。谁知道...

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2018-09-05T21:00:21.627

在修改后的 PuTTY 中可以发送 CR+LF。源代码在[https://github.com/gniemirowski/putty-crlf](https://github.com/gniemirowski/putty-crlf)和 Windows 二进制文件在[https://www.grzegorz.net/pliki/putty-crlf.zip](https://www.grzegorz.net/pliki/putty-crlf.zip)当你运行这个版本只是去终端 - >键盘并为“回车键”选项选择“CR LF”。

[![在此处输入图像描述](../Images/c235724926b4bb65e3a5a9e7a3a706e9.png)](https://i.stack.imgur.com/BOCQT.png)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-07-19T20:42:45.633

PuTTY 模拟了模拟 vt100 的 xterm。要让 putty 在按 enter 时发送 CR/LF，请在连接到串行设备后在 putty 中键入 ESC[20h。这将 VT100 LNM 设置为真。

[http://vt100.net/docs/vt100-ug/chapter3.html](http://vt100.net/docs/vt100-ug/chapter3.html)

换行/换行 换行 ESC [20h Line feed ESC [20l

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-08T13:44:41.293

如果您观看 ascii 表或类似的参考资料，您可能会觉得有趣：\r ou \x0D

为了更好地理解，请参阅：[http://www.grok2.com/sedfaq6.html](http://www.grok2.com/sedfaq6.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-09-27T12:09:40.733

修改后的 PuTTY 是最简单的解决方案。如果你想坚持使用标准的 PuTTY，还有其他一些选择......你可以在按 enter 之前使用 ctrl+j 发送换行符，但那是一个小问题。要使其自动化，您可以在 PuTTY 窗口处于活动状态时使用 AutoHotKey 将 {ENTER} 更改为 ^J{ENTER}：

```
#if WinActive("ahk_exe putty.exe")
    Enter::
        SendInput ^J{Enter}
    Return
#if 
```

要对一个 PuTTY 窗口执行此操作，您可以为 AHK 指定窗口名称：

```
#if WinActive("COM8 - PuTTY")
    Enter::
        SendInput ^J{Enter}
    Return
#if 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-28T22:32:37.443

在标准配置中（在 Windows 和 Linux 上），如果您键入“help”然后按 enter，串行端口上将出现以下字节链（通过 RS232 与外部连接终端和逻辑分析仪检查）：

0x68(h) 0x65(e) 0x6c(l) 0x70(p) 0x0d(CR: 回车 U+000D)

所以看起来 PUTTY 将 CR 放在 ENTER 上（无论您使用的是 Linux 还是 Windows）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-06-18T13:17:51.173

在 arduino 程序上，只需使用`Serial.write`和 两个字符代码：

```
Serial.write(13);    // CR
Serial.write(10);    // LF 
```

并且避免`Serial.print`，因为它旨在为人类可读，所以格式化。

参考：[写](http://arduino.cc/en/Serial/Write) [打印](http://arduino.cc/en/Serial/Print)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-08-19T18:14:27.113

我几乎可以肯定您正在寻找`\n`换行符。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-07-24T16:04:50.447

我尝试了这个非常简单的代码（cr =回车）

```
Serial.write(13); 
```

而且因为下一个“打印”的字符会提供剩余的文本，所以没关系。

# php - 如何在 PHP 中将数组分组并编码为 JSON？

> ID：11997109
> 
> 赞同：2
> 
> 时间：2012-08-17T00:02:16.163
> 
> 标签：php, mysql, arrays, grouping, encode

我在 MySql 中有 2 个表

**部分**

```
section_id       name
=====================
1              Section1
2              Section2 
```

**类别**

```
 category_id        section_id     name
    =========================================
    1                  1           Category1
    2                  1           Category2
    3                  2           Category3
    4                  2           Category3 
```

这就是我现在所拥有的：

```
$sections = mysql_query($sql_section) or die("Could not execute query.");
$categories = mysql_query($sql_category) or die("Count not execute query");

$result = array('sectionlist' => array());
    for ($i=0; $i < mysql_num_rows($sections); $i++ ){
        for ($j=0; $j < mysql_num_rows($categories); $j++){
            if (mysql_result($sections,$i,"section_id") == mysql_result($categories,$j,"section_id")){
                $result['sectionlist'][] = array('sectionName' => mysql_result($sections,$i,"name"), 'categorylist' => array(array('category' => mysql_result($categories,$j,"name"))));
            }
        }
    }
echo json_encode($result); 
```

结果出来是这样的：

```
 {sectionlist:[
    {sectionName: "Section1", categoryList: [{categoryName: "category1"}]},
    {sectionName: "Section1", categoryList: [{categoryName: "category2"}]},
    {sectionName: "Section2", categoryList: [{categoryName: "category3"}]},
    {sectionName: "Section2", categoryList: [{categoryName: "category4"}]},
  ]} 
```

这不是我的预期结果，我想要一个看起来像这样的对象：

```
{sectionlist:[
    {sectionName: "Section1", categoryList: [{categoryName: "category1"}, {categoryName: "category2"}]},
    {sectionName: "Section2", categoryList: [{categoryName: "category3"}, {categoryName: "category4"}]}
]} 
```

因此，如何将第 1 部分与第 1 部分和第 2 部分分组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T00:26:50.243

要回答您的问题，您首先要创建类别数组。

```
for ($i=0; $i < mysql_num_rows($sections); $i++ ){
    $categorylist = array();
    for ($j=0; $j < mysql_num_rows($categories); $j++){
        if (mysql_result($sections,$i,"section_id") == mysql_result($categories,$j,"section_id")){
            $categorylist[] = array('category' => mysql_result($categories,$j,"name");
        }
    }
    $result['sectionlist'][] = array('sectionName' => mysql_result($sections,$i,"name"), 'categorylist' => $categorylist));
} 
```

作为旁注，[PHP 鼓励使用其他数据库扩展](http://us2.php.net/manual/en/function.mysql-num-rows.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T00:29:30.300

@Greg 的评论非常重要，需要注意上面的内容。另外，我建议将您的查询重写为带有连接的单个查询，以便仅检索您想要的数据。我不是 100% 确定你需要什么，但它可能是这样的：

```
SELECT section.section_id, category.name, section.name FROM category 
  LEFT JOIN section ON section.section_id = category.section_id; 
```

这将返回一个类别名称数组，这些名称与它们关联的 section_id 和部分名称键控（如果您愿意，您也可以选择 category_id）。

# android - 如何在 Rails for Android 中使用 gzip 压缩 JSON？

> ID：11997110
> 
> 赞同：9
> 
> 时间：2012-08-17T00:02:18.413
> 
> 标签：android, ruby-on-rails-3, json, gzip, httpclient

我正在运行带有 Ruby 1.9.3p194 的 Rails 3.2.7 以从 SQLite 数据库输出 JSON 数据。

```
render :json => result.to_json 
```

Android 应用程序使用通过以下方式加载的 JSON 文件`HTTP-GET`：

```
HttpClient httpclient = new DefaultHttpClient();
HttpGet httpGet = new HttpGet(urlPath);
HttpResponse response = httpclient.execute(httpGet);
HttpEntity entity = response.getEntity();
String result = EntityUtils.toString(entity, HTTP.UTF_8);
JSONObject jsonObject = new JSONObject(result); 
```

## 平台支持：

我在 API 中读到[Rails 提供 gzip 支持](http://api.rubyonrails.org/classes/ActiveSupport/Gzip.html)，如下所示：

```
ActiveSupport::Gzip.compress(result) 
```

我还从[HTTP/1.1、RFC2626、第 14.3 节](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.3)猜测我可以配置 HTTP 请求的标头：

```
httpPost.setHeader("Accept-Encoding", "gzip"); 
```

[我还发现第 3.5 节“内容编码”](http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.5)中包含的信息非常有趣：

> *   所有内容编码值都不**区分大小写**。
> *   HTTP/1.1 在**Accept-Encoding**（第 14.3 节）和**Content-Encoding**（第 14.11 节）标头字段中使用内容编码值。
> *   互联网号码分配机构 (IANA) 充当内容编码价值令牌的注册机构。最初，注册表包含以下标记：
>     *   **gzip**由文件压缩程序“gzip”（GNU zip）产生的一种编码格式，如 RFC 1952 [25] 中所述。

这篇文章进一步解释了[如何使用 Android 处理 GZIP 编码的内容](https://stackoverflow.com/a/1576513/356895)。

## 服务器测试：

因此，我不知道如何找出数据是否已被服务器压缩。为了测试 Rails 是否输出 gzip，我尝试按照[此处](https://stackoverflow.com/a/251012/356895)的建议使用*curl*：

```
$ curl --head -H "Accept-Encoding: gzip" http://localhost:3000/posts.json 
```

但是，输出并没有向我透露是否支持 gzip：

```
HTTP/1.1 200 OK 
Content-Type: application/json; charset=utf-8
X-Ua-Compatible: IE=Edge
Etag: "f6f6732c747466f75052f88b1eff393b"
Cache-Control: max-age=0, private, must-revalidate
X-Request-Id: 74ee0562c05adea679deb701f1b8fd88
X-Runtime: 0.004205
Content-Length: 0
Server: WEBrick/1.3.1 (Ruby/1.9.3/2012-04-20)
Date: Thu, 16 Aug 2012 23:33:25 GMT
Connection: Keep-Alive 
```

我也试过[*curl*](http://curl.haxx.se/docs/manpage.html)`--compressed`的参数...[](http://curl.haxx.se/docs/manpage.html)

 *```
$ curl --compressed --head -H "Accept-Encoding: gzip" http://localhost:3000/posts.json 
```

它输出与前一个命令相同的标头信息。当我跑...

```
$ curl --compressed -H "Accept-Encoding: gzip" http://localhost:3000/posts.json 
```

JSON 数据作为可读文本打印到控制台。我看不到压缩是否发生。也许，因为*curl*已经解压缩了响应？！

## 在线测试

我也试过[这里](https://webmasters.stackexchange.com/a/543)提到的在线测试[HTTP Compression Test](http://www.whatsmyip.org/http-compression-test/)。它确认 JSON 内容“未压缩”。[此处](https://webmasters.stackexchange.com/a/4613)链接的第二个网站[GIDZipTest](http://www.gidnetwork.com/tools/gzip-test.php)承认了阴性测试结果。

## 问题：

1.  如何从 Rails 输出 gzip 压缩的 JSON？
2.  如何配置 HTTP 客户端以请求 gzip 压缩数据？
3.  当我在 Heroku (PostgreSQL) 上运行 Rails 服务器时，相同的配置是否仍然有效，...？

* * *

## 得到教训

据我所知，我必须为 REST 服务器配置的是`use Rack::Deflater`. 需要明确的是：我不在`ActiveSupport::Gzip.compress()`我的代码中使用。如果有人感兴趣，这就是启用 GZIP 压缩时标头的样子。

```
HTTP/1.1 200 OK 
Content-Type: application/json; charset=utf-8
X-Ua-Compatible: IE=Edge
Etag: "8170a04be41673bf25824256740a9460"
Cache-Control: max-age=0, private, must-revalidate
X-Request-Id: 700b9536f6a20164d31b8528bde423af
X-Runtime: 0.369337
Vary: Accept-Encoding
Content-Encoding: gzip
Server: WEBrick/1.3.1 (Ruby/1.9.3/2012-04-20)
Date: Tue, 21 Aug 2012 12:10:48 GMT
Content-Length: 20
Connection: Keep-Alive 
```

现在我知道了神奇的关键字，很容易[在`use Rack::Deflater`](http://bit.ly/PtAmzg).

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-19T17:35:08.693

也许你应该使用 Rack::Deflater？在 config.ru 中插入：

```
require ::File.expand_path('../config/environment',  __FILE__)
use Rack::Deflater
run MyAppName::Application 
```

并配置您的 http 请求标头：

> 我可以配置 HTTP 请求的标头：
> 
> httpPost.setHeader("接受编码", "gzip");

PS 相同的配置适用于 Heroku*

# android - 在 ViewPager 中以声明方式定义片段

> ID：11997118
> 
> 赞同：0
> 
> 时间：2012-08-17T00:03:31.367
> 
> 标签：android, android-viewpager

我有 5 个独特的 xml 页面，它们相当复杂。我想把 5 页放在 ViewPager 中。我能找到的所有示例都只是通过代码将相同的内容放在每个页面中。我想在 viewpager 中以声明方式定义 xml，就像下面粘贴的 xml 一样。但这不起作用 - 应用程序以这个 xml 停止。

如果我不能以声明方式定义它，那么我可以将单个 xml 页面加载到 viewpager 中吗？我找不到这样做的例子。谢谢，加里布莱克利

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<fragment >
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
    <ImageView android:layout_width="match_parent"
        android:layout_height="match_parent" android:id="@+id/imageView1"
        android:src="@drawable/flashright" android:adjustViewBounds="true" android:scaleType="fitXY">
    </ImageView>
    </LinearLayout>       
</fragment>

<fragment >
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >
    <ImageView android:layout_width="match_parent"
        android:layout_height="match_parent" android:id="@+id/imageView1"
        android:src="@drawable/flashleft" android:adjustViewBounds="true" android:scaleType="fitXY">
    </ImageView>
    </LinearLayout>             
</fragment> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T00:25:39.180

如果我遵循，您希望在 XML 中声明所有内容，并避免在包含 ViewPager 的 Activity 中进行任何编程初始化。我能想到的唯一方法是定义 3 个不同的 Fragment 类，它们引用 3 个不同的 xml 布局。然后，您可以将它们嵌入到您上面的 xml 中，用 etc 替换每个`<Fragment>`元素`<FragmentX>` `<FragmentY>` `<FragmentZ>`。就个人而言，我宁愿编写 3 个 xml 布局并创建一个 Fragment 实现，该实现采用单个 int 参数来指定要加载的布局，然后执行少量使这样的解决方案起作用所必需的程序初始化。理由是重复的代码更少。

编辑：另一种可能更全面地满足您的要求的方法是用标签替换您`<Fragment>`的`<Layout>`标签并给它们 id。然后在您的活动代码中，将引用存储到它们，在 onCreate() 中将它们从视图中删除，最后将每个存储的引用添加到以编程方式创建的 Fragment 实例中，然后将其添加到 ViewPager。非常丑陋，但这是我所知道的在 XML 中以声明方式定义所有内容的唯一方法。您仍然会遇到这样的问题，即从 XML 中不清楚这些元素嵌套在 ViewPager 中，所以我个人不明白这一点。ListView 和 ListFragment 使用相同类型的隐式关联进行操作，但并非史无前例。

# c# - wcf AfterReceiveRequest 没有被调用

> ID：11997119
> 
> 赞同：0
> 
> 时间：2012-08-17T00:03:31.547
> 
> 标签：c#, wcf

当我通过webiste iis7托管我的 wcf 服务时，**没有**调用**AfterReceiveRequest****方法**。

 ****请帮忙..

谢谢

```
public class CultureMessageInspector : IClientMessageInspector, IDispatchMessageInspector
{
    private const string HeaderKey = "culture";
    #region IDispatchMessageInspector Members

    public object AfterReceiveRequest(ref System.ServiceModel.Channels.Message request, System.ServiceModel.IClientChannel channel, System.ServiceModel.InstanceContext instanceContext)
    {
        int headerIndex = request.Headers.FindHeader(HeaderKey, string.Empty);
        if (headerIndex != -1)
        {
            Thread.CurrentThread.CurrentCulture = new CultureInfo(request.Headers.GetHeader<String>(headerIndex));
        }
        return null;
    }

    public void BeforeSendReply(ref System.ServiceModel.Channels.Message reply, object correlationState)
    {
    }

    #endregion

    #region IClientMessageInspector Members

    public void AfterReceiveReply(ref System.ServiceModel.Channels.Message reply, object correlationState)
    {
    }

    public object BeforeSendRequest(ref System.ServiceModel.Channels.Message request, System.ServiceModel.IClientChannel channel)
    {
        request.Headers.Add(MessageHeader.CreateHeader(HeaderKey, string.Empty, Thread.CurrentThread.CurrentCulture.Name));
        return null;
    }

    #endregion
} 
```

我的行为扩展类、Service.svc 和配置设置如下：

```
<system.serviceModel>
    <services>
      <service name="C:\Visual Studio 2010\WebSites\WCFService8">
        <endpoint binding="netTcpBinding" bindingConfiguration="" behaviorConfiguration="Default" contract="CultureServer.IHelloWorld" />
      </service>
    </services>
    <behaviors>

      <endpointBehaviors>
        <behavior name="Default">
          <CultureExtension/>
        </behavior>
      </endpointBehaviors>

      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>

    <extensions>
      <behaviorExtensions>
        <add name="CultureExtension" type="Extension.CultureBehaviorExtension, Extension, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null"/>
      </behaviorExtensions>
    </extensions>

    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>

public class CultureBehaviorExtension : BehaviorExtensionElement
{
    // BehaviorExtensionElement members
    public override Type BehaviorType
    {
        get { return typeof(CultureBehaviour); }
    }

    protected override object CreateBehavior()
    {
        return new CultureBehaviour();
    }
}

<%@ ServiceHost Language="C#" Debug="true" Service="CultureServer.Server"%> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T03:26:38.620

```
<services> 
  <service name="C:\Visual Studio 2010\WebSites\WCFService8"> 
    <endpoint binding="netTcpBinding" bindingConfiguration="" behaviorConfiguration="Default" contract="CultureServer.IHelloWorld" /> 
  </service> 
</services> 
```

标签的`name`属性错误。`<service>`它应该有类名，而不是路径。尝试用下面的代码替换它。

```
<services> 
  <service name="CultureServer.Server"> 
    <endpoint binding="netTcpBinding" bindingConfiguration="" behaviorConfiguration="Default" contract="CultureServer.IHelloWorld" /> 
  </service> 
</services> 
```****

# objective-c - 从 iOS 应用程序向 Facebook 发布状态更新

> ID：11997121
> 
> 赞同：0
> 
> 时间：2012-08-17T00:03:43.423
> 
> 标签：objective-c, ios, facebook

我正在创建一个 iOS 应用程序，并且正在添加一些共享选项。我已经下载了 Facebook 3.0 SDK 并按照 Facebook 开发者页面将其放入我的项目中。我需要我的应用程序做的就是在 UIActionSheet 上单击某个按钮时将**纯文本状态更新发布到 Facebook。**这是我到目前为止的代码：

```
#import <FacebookSDK/FacebookSDK.h>

-(void) actionSheet:(UIActionSheet *)actionSheet clickedButtonAtIndex:(NSInteger)buttonIndex
{
    if (buttonIndex == 0) {
        NSArray *permissions = [NSArray arrayWithObject:@"publish_actions"];
        [FBSession openActiveSessionWithPermissions:permissions allowLoginUI:YES
                              completionHandler:^(FBSession *session,
                                                  FBSessionState status,
                                                  NSError *error) {
                                  // session might now be open.
                                  if (session.isOpen)
                                      //don't know what to do from here
                              }];
    }
} 
```

**我不知道从这里开始。**身份验证发生，然后我的 iPhone 上的 Facebook 应用程序打开，这就是它的结束。另外，如果还有什么我应该补充的，我想念请告诉我。我是 Facebook SDK 的新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T00:18:31.783

[Facebook 的 iOS 文档在其示例应用程序](https://developers.facebook.com/docs/getting-started/getting-started-with-the-ios-sdk/#samples)和教程中很好地介绍了这一点。

**具体来说**

> HelloFacebookSample：结合使用 FBLoginView、FBProfilePictureView、FBFriendsPickerViewController、FBPlacePickerViewController 和 FBRequest 进行个人资料访问、状态更新和照片上传。

*   来自 developer.facebook.com

# sql - Rails 查询与数组操作

> ID：11997125
> 
> 赞同：0
> 
> 时间：2012-08-17T00:04:07.543
> 
> 标签：sql, ruby-on-rails

在 Rails 中查找对象时，最好先组合查询条件然后执行查询，还是从不太严格的条件开始并对结果执行数组操作以缩小我想要的范围。我想知道哪一个会执行得更快和/或标准使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:42:17.987

如果可能，在 SQL 中缩小结果通常会更快，因此如果查询不太复杂，请根据需要添加尽可能多的查询条件。在 Ruby 中运行代码以缩小结果并不比 SQL 快，因为无论如何都会解释 Ruby。

但是，使用 SQL 缩小结果范围的好处是：

*   如果索引的列上有查询条件（例如，为 created_by 添加索引，然后查找在特定时间范围内创建的结果）或该列上的排序子句，则通过索引搜索结果要快得多
*   从 SQL 数据库到 Ruby/Rails 的通信更少（如果在同一台计算机上，则速度会略有提高，否则数据库在单独的计算机上，使用更少的带宽 - 结果返回更快）

# javascript - 如何在 Blueimp jquery 文件上传器中发送会话数据？

> ID：11997126
> 
> 赞同：0
> 
> 时间：2012-08-17T00:04:44.830
> 
> 标签：javascript, jquery, codeigniter, blueimp

我正在尝试为我目前正在处理的项目使用 codeigniter 和 Blueimp Jquery File Upload 插件：Filtering images for display based on an authenticated user。我需要能够根据包含插件的页面上的 GET 变量来更改上传的路径。我希望它为每个用户连接到一个单独的文件夹。

为此，我相信我只需要再完成一个步骤：在 $_request、$_POST 或 $_GET 数组的情况下，使我在表单中的隐藏字段中对服务器端脚本可用的 codeigniter 会话 ID没有**设置**。

从谷歌搜索看来，[Jquery File Upload plugin: Dynamically change upload path?](https://stackoverflow.com/questions/11056171/jquery-file-upload-plugin-dynamically-change-upload-path) 这正是我想要做的。

唯一的问题是最后一步没有解释！我是 JS、Jquery 和 ajax 的新手。有人可以解释如何使用 jquery 使会话 ID 在 php 脚本中可用。

作为提示，blueimp 作者在[https://github.com/blueimp/jQuery-File-Upload/issues/241中写了以下内容](https://github.com/blueimp/jQuery-File-Upload/issues/241)

> 看一下example/application.js，第二部分注释为 // Load existing files: There, add + '?ext=VAR1¬a=VAR2' behind $('#file_upload').fileUploadUIX('option', ' url') 并将 VAR1 和 VAR2 调整为所需的路径变量。

当前 main.js 文件中的代码是

```
$('#fileupload').each(function () {
        var that = this;
        $.getJSON(this.action, function (result) {
            if (result && result.length) {
                $(that).fileupload('option', 'done')
                    .call(that, null, {result: result});
            }
        });
    }); 
```

谢谢，

账单

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T12:10:33.080

这是我用来运行 blueimp 上传并在生产站点上运行的一段代码。如您所见，我根本不关心附加任何会话数据。我只是告诉它要上传到的 url，然后在它工作时调用一些回调方法。我要在这里添加的一个警告是，我只使用我自己设计的基本插件。

```
$("#file").fileupload({
        dataType: 'json',
        url: "/Upload/Photo"
        start: function () {
            progress.show();
        },
        progress: function (e, data) {
            progress.progressbar({ value: (data.loaded / data.total) * 100 });
        },
        done: function (e, data) {
            progress.hide();
        },
        fail: function (e, data) {
            progress.hide();
            var message = "An error was encountered!";

            // Use the simplemodal plugin to show my error
            modal.showError(message);
        }
    }); 
```

# java - 如何生成特定的 GUI - Java

> ID：11997127
> 
> 赞同：-5
> 
> 时间：2012-08-17T00:04:53.540
> 
> 标签：java, user-interface

> **可能重复：**
> [Java 对话框](https://stackoverflow.com/questions/11992506/java-dialog-box)

我想知道如何使用 Java GUI 生成这种类型的窗口：

[http://postimage.org/image/61aa8hrvb/](http://postimage.org/image/61aa8hrvb/)

我不是在问如何用数据填充窗口——只是问如何生成窗口。似乎它只有一个固定的大小（长度和宽度）和一个边框。它似乎是一个准系统窗口。

有什么你能想到的类似于这种风格的窗户吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T00:19:31.613

您可以使用[JWindow](http://docs.oracle.com/javase/7/docs/api/javax/swing/JWindow.html)来获取准系统窗口。
然后`JPanel`使用`window.add(panel);`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T00:08:08.570

如果您使用的是 Swing，您可以尝试使用[TableLayout](http://java.sun.com/products/jfc/tsc/articles/tablelayout/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T00:10:29.413

使用 Swing，使用 JWindow，将 JPanel 添加到此 JWindow 的内容窗格中，然后覆盖 JPanel 的 Paint 方法以绘制边框。

# memory-management - 从内核模块更改用户空间内存保护标志

> ID：11997129
> 
> 赞同：5
> 
> 时间：2012-08-17T00:05:02.277
> 
> 标签：memory-management, process, linux-kernel, mmap

我正在编写一个可以访问特定进程内存的内核模块。我已经对一些用户空间内存进行了匿名映射`do_mmap()`：

```
#define MAP_FLAGS   (MAP_PRIVATE | MAP_FIXED | MAP_ANONYMOUS)

prot = PROT_WRITE;
retval = do_mmap(NULL, vaddr, vsize, prot, MAP_FLAGS, 0); 
```

`vaddr`并且`vsize`设置得更早，并且调用成功。从内核模块（通过）写入该内存块后`copy_to_user`，我想删除`PROT_WRITE`它的权限（就像我`mprotect`在普通用户空间中所做的那样）。我似乎找不到允许这样做的功能。

我尝试取消映射该区域并使用正确的保护重新映射它，但这会将内存块清零，擦除我刚刚写入的所有数据；设置`MAP_UNINITIALIZED`可能会解决这个问题，但是，从手册页：

> MAP_UNINITIALIZED（自 Linux 2.6.33 起）
> 
> 不要清除匿名页面。此标志旨在提高嵌入式设备的性能。仅当使用 CONFIG_MMAP_ALLOW_UNINITIALIZED 选项配置内核时才使用此标志。由于安全隐患，该选项通常仅在嵌入式设备上启用（即，可以完全控制用户内存内容的设备）。

所以，虽然这可能会做我想要的，但它不会很便携。有没有标准的方法来完成我的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T04:33:44.470

经过更多研究，我发现了一个名为`get_user_pages()`（我找到的最佳文档是[here](http://www.makelinux.net/ldd3/chp-15-sect-3)）的函数，它从给定地址的用户空间返回页面列表，可以映射到内核空间`kmap()`并以这种方式写入（在我的情况下，使用`kernel_read()`）。这可以用作替代，`copy_to_user()`因为它允许在检索的页面上强制写入权限。唯一的缺点是您必须逐页编写，而不是一口气写完，但它确实解决了我在问题中描述的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T04:47:52.957

在用户空间中有一个系统调用`mprotect`可以修改现有映射上的保护标志。您可能需要遵循该系统调用的实现，或者直接从您的代码中调用它。见`mm/protect.c`。

# gwt - 在 GWT DataGrid 中延迟加载数据

> ID：11997130
> 
> 赞同：3
> 
> 时间：2012-08-17T00:05:13.813
> 
> 标签：gwt

是否可以将数据延迟加载到 GWT DataGrid 中，类似于 GWT CellList 延迟加载数据的方式？

我有一个 GWT DataGrid，它可能会带回数百行，但一次只显示大约 20 行。发生这种情况时，网格的加载非常缓慢。

我想使用 DataGrid 而不是 CellTList，因为我有多列需要显示的数据。而且我选择了 DataGrid 而不是 CellTable，因为我希望修复标题列。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-17T23:27:10.897

由于`DataGrid`不公开它`ScrollPanel`，因此创建一个内部类来扩展`DataGrid`并提供对 的引用`ScrollPanel`：

```
private static class MyDataGrid<T> extends DataGrid {
    public ScrollPanel getScrollPanel() {
        HeaderPanel header = (HeaderPanel) getWidget();
        return (ScrollPanel) header.getContentWidget();
    }
} 
```

初始化此工作所需的变量：

```
private MyDataGrid<MyDataType> myDataGrid;
private int incrementSize = 20;
private int lastScrollPos = 0; 
```

在构造函数中，创建网格：

```
myDataGrid = new MyDataGrid<MyDataType>(); 
```

然后使用刚刚创建的 getScrollPanel() 引用添加一个 ScrollHandler：

```
myDataGrid.getScrollPanel().addScrollHandler(new ScrollHandler(){

    @Override
    public void onScroll(ScrollEvent event) {

        int oldScrollPos = lastScrollPos;
        lastScrollPos = myDataGrid.getScrollPanel().getVerticalScrollPosition();

        // If scrolling up, ignore the event.
        if (oldScrollPos >= lastScrollPos) {
            return;
        }

        //Height of grid contents (including outside the viewable area) - height of the scroll panel
        int maxScrollTop = myDataGrid.getScrollPanel().getWidget().getOffsetHeight() - 
                           myDataGrid.getScrollPanel().getOffsetHeight();

        if(lastScrollPos >= maxScrollTop) {
            myDataGrid.setVisibleRange(0,myDataGrid.getVisibleRange().getLength()+incrementSize);
        }
    }
}); 
```

# android - 将带有撇号的 XML 解析为 ' 时出错

> ID：11997131
> 
> 赞同：1
> 
> 时间：2012-08-17T00:05:17.690
> 
> 标签：android, xml-parsing, android-xml

我正在尝试使用 DOM 解析 XML 提要。当一个节点看起来像这样时：

```
<title>&#039;Star Wars&#039; May the force live</title> 
```

返回的 XML 只是 ' 然后解析器继续到下一个节点。

这是我解析它的方式：

```
NodeList list = node.getChildNodes();
    for (int j=0; j<list.getLength(); j++) {
        Node innerItem = list.item(j);
        String name = innerItem.getNodeName();

        if (name.equalsIgnoreCase("title")) {
            vo.setTitle(innerItem.getFirstChild().getNodeValue());
        }
    } 
```

我怎样才能解决这个问题？该代码在 Android 4 中解析良好，但在 Android 2.3.3 中失败

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T04:22:48.200

看起来你的问题与这个问题非常相似：[android 解码 html in xml file](https://stackoverflow.com/questions/4131906/android-decoding-html-in-xml-file)

似乎 HTML 字符会破坏 DOM 解析器，因此无法从 xml 实体中获取字符串。有一个 HTML 函数可以解析字符串中的 HTML。

```
TextView tv;
String s = "<quote>&#039;Star Wars&#039; May the force live</quote>";
tv.setText(HTML.fromHtml(s)); 
```

输出：

```
"Star Wars" May the force live 
```

但是似乎 DOM 没有得到要转换的字符串，所以下面的文章可能有用：[Using XPATH and HTML Cleaner to parse HTML/XML](http://thinkandroid.wordpress.com/2010/01/05/using-xpath-and-html-cleaner-to-parse-html-xml/)

# php - 宿舍分配系统php函数

> ID：11997138
> 
> 赞同：0
> 
> 时间：2012-08-17T00:06:42.757
> 
> 标签：php, random

我正在编写一个投票宿舍分配系统。该系统假设在学生输入他们的注册号码时为他们分配号码。注册号--------

提交时：系统应该分配一个 0-300 的唯一值：//这让我使用下面的代码

```
$random = rand(0,299);//this assign a unique random number

if($random <= 50){
 echo " you have being allocated a room "
}else{
 echo "No  room is allocated to u"

} 
```

我如何确保两个候选人没有收到相同的随机数。

坦克很多的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T00:25:28.400

如果您不使用数据库进行持久性，您几乎无法将冲突的机会减少到零。如果此记录将被输入到数据库表中，您应该在插入时执行 mysql 计数，如果输入的记录不超过房间数，则插入新记录，否则向用户返回消息，表示没有剩余房间。房间号列的mysql自动增加将在这里有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T00:45:16.097

如果你绝对不能使用数据库，也许使用 time() 函数加上一些随机数。

例如：

```
$random = time() . rand(0,1000); 
```

这将回显一个像“1345164397568”这样的数字，并且两个人获得相同数字的几率是千分之一，并且只有他们在完全相同的时间访问。

# c# - DelegatingHandler 不执行 ASP.Net Web Api

> ID：11997140
> 
> 赞同：14
> 
> 时间：2012-08-17T00:06:50.227
> 
> 标签：c#, asp.net, asp.net-web-api

今天我在我的 Web Api 应用程序中遇到了一个奇怪的行为

```
protected void Application_Start() {

    FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
    RouteConfig.RegisterRoutes(RouteTable.Routes);
    GlobalConfiguration.Configuration
        .MessageHandlers.Add(new DummyMessageHandler());
} 
```

我的 DelegatingHandler 看起来像这样。

```
public class DummyMessageHandler : DelegatingHandler {

    protected override Task<HttpResponseMessage> SendAsync(
        HttpRequestMessage request, CancellationToken cancellationToken) {

*       if (request.Headers.Authorization.Scheme == "Basic")
            Thread.CurrentPrincipal = new GenericPrincipal(
                new GenericIdentity("Authenticated"), new string[0]);

        return base.SendAsync(request, cancellationToken);
    }
} 
```

我遇到的问题是委托处理程序没有被执行。我在标有 * 的行中有一个断点，并且我的代码的执行永远不会停在那里。

我的 nuget packages.config 如下：

```
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="Microsoft.AspNet.Mvc" version="4.0.20710.0" targetFramework="net40" />
  <package id="Microsoft.AspNet.Razor" version="2.0.20710.0" targetFramework="net40" />
  <package id="Microsoft.AspNet.Web.Optimization" version="1.0.0" targetFramework="net40" />
  <package id="Microsoft.AspNet.WebApi" version="4.0.20710.0" targetFramework="net40" />
  <package id="Microsoft.AspNet.WebApi.Client" version="4.1.0-alpha-120809" targetFramework="net40" />
  <package id="Microsoft.AspNet.WebApi.Core" version="4.0.20710.0" targetFramework="net40" />
  <package id="Microsoft.AspNet.WebApi.WebHost" version="4.0.20710.0" targetFramework="net40" />
  <package id="Microsoft.AspNet.WebPages" version="2.0.20710.0" targetFramework="net40" />
  <package id="Microsoft.Net.Http" version="2.0.20710.0" targetFramework="net40" />
  <package id="Microsoft.Web.Infrastructure" version="1.0.0.0" targetFramework="net40" />
  <package id="Newtonsoft.Json" version="4.5.8" targetFramework="net40" />
  <package id="WebGrease" version="1.1.0" targetFramework="net40" />
</packages> 
```

我看这个很久了，你能指出我缺少的东西吗？谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-05-06T19:38:33.547

你所做的是正确的。问题可能会发生，因为**只有在您调用 Web API 控制器**操作**时才会运行。`DelegatingHandler`**例如：

**这将调用您的 Message Handler**，因为它是一个 ApiController。

```
public class ValuesController : ApiController
{
    // GET api/values
    public IEnumerable<string> Get()
    {
        return new string[] { "value1", "value2" };
    }
} 
```

**这不会**，因为它只是一个控制器。

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        ViewBag.Title = "Home Page";

        return View();
    }
} 
```

确保您正在调用 Web API 控制器操作，否则调试器将不会达到您的断点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-02-12T22:54:38.380

您应该在 WebApiConfig 文件中注册您的处理程序，而不是在 global.asax

```
 public static class WebApiConfig
    {
        public static void Register(HttpConfiguration config)
        {

            config.MapHttpAttributeRoutes();
            config.MessageHandlers.Add( new DummyMessageHandler());
            config.Routes.MapHttpRoute(
                name: "DefaultApi",
                routeTemplate: "api/{controller}/{id}",
                defaults: new { id = RouteParameter.Optional }
            );
        }

    } 
```

# c++ - 在自定义文本区域中呈现光标的正确方法？

> ID：11997146
> 
> 赞同：3
> 
> 时间：2012-08-17T00:07:47.957
> 
> 标签：c++, user-interface, textbox, sdl, freetype

我正在使用 SDL 和 libfreetype 并构建一个非常基本的 GUI，我正在实现一个文本框，但我无法弄清楚我应该如何生成标准的闪烁光标部分。好像和人物不太一样`|`。此外，如果我将其绘制为`|`改变文本宽度的字符。

在带有光标的文本框中呈现文本的规范正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-19T06:05:38.557

最简单的方法是只绘制一个线图元，这使您可以更好地控制插入符号的间距、长度和宽度。

如果你想在你的字体系统中保留它作为文本字符，你可以做一个渲染到纹理并将它复制出来，或者在你的字体图集上做一个简单的内存 blit（这样你就可以保持管道字符分开，使用像 0x01 这样的控制字符作为插入符号）。

# triggers - 如何从 SQL Server 2012 调试 CLR 触发器

> ID：11997147
> 
> 赞同：1
> 
> 时间：2012-08-17T00:07:50.560
> 
> 标签：triggers, sqlclr, sql-server-2012

我已经安装了 SSDT 以连接到 sql server 2012 实例，我想知道如何从数据库中调试 CLR 触发器，我已经创建了一个数据库项目来创建 clr 触发器，并且可以部署到该数据库。

问题是因为我没有像以前的版本那样添加任何“测试脚本”的选项我不知道如何从那里调试，

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T05:03:01.133

*   在解决方案资源管理器中，将“脚本（不在构建中）”添加到项目中并将您的测试 TSQL 放在那里
*   在项目属性的调试下，选择“启动脚本”并在下拉列表中选择新的脚本文件

除了通常的 SQLCLR 设置之外，请确保在 SQL Server 对象资源管理器中右键单击数据库并启用“允许 SQL/CLR 调试”。

# php - 关于安装 PHP Memcache 的困惑

> ID：11997155
> 
> 赞同：0
> 
> 时间：2012-08-17T00:09:10.520
> 
> 标签：php, memcached

我正在使用 PHP 5.3 开发 Win7(x64)。我已经安装了 memcached，并且该服务使用端口 11211 运行。并且 *php_memcache.dll* 已被复制到*ext*文件夹中，并将此扩展名正确添加到*ini*文件中。但是应用程序总是报错*'The Memcache Extension must be loaded to use Memcached Cache'*并且无法使用Memcache。

我知道 Memcache 和 Memcached 之间的区别，并且我尝试了许多类型的 memcache 和 php 扩展，最后，它并没有像往常一样工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T00:49:56.910

您遇到的错误通常是由不兼容的版本 ( [`Possible duplicate`](https://stackoverflow.com/questions/2394532/apache-is-unable-to-initialize-module-because-of-modules-and-phps-api-dont)) 引起的。

您可以从 5.3 升级到 5.4.6 [`here`](http://windows.php.net/download/)，然后自己构建 memcache 或尝试[`this dll`](http://stalk.s3-website-eu-west-1.amazonaws.com/php-5.4.0-Win32-VC9-x86.zip).

或者，您可以尝试[`this dll`](http://shikii.net/blog/downloads/php_memcache-cvs-20090703-5.3-VC6-x86.zip)当前安装的 PHP。

不幸的是，没有用于 Windows 的 PECL 二进制文件的维护版本。您应该考虑在 *nix 环境中加入我们的特权者 :)

# backbone.js - 除了名称之外，如何访问模板中的属性？

> ID：11997159
> 
> 赞同：1
> 
> 时间：2012-08-17T00:09:36.493
> 
> 标签：backbone.js, underscore.js

在下划线模板中，除了通过名称之外，还有其他方法可以访问属性吗？我有一个叫“2a”，我不能直接引用它，因为它的第一个字符是一个数字。例如，这不起作用：

```
 <input type="checkbox" name="6a"  <%= 6a ? "checked" : "" %>> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:41:06.703

除了重命名有问题的属性之外，您还有其他一些选择。

下划线[`_.template`](http://underscorejs.org/#template)有一个`variable`选项：

> 默认情况下，**模板**`with`通过语句将数据中的值放在本地范围内。**但是，您可以使用变量**设置指定单个变量名称。

所以你可以这样做：

```
<input type="checkbox" name="6a"  <%= v['6a'] ? "checked" : "" %>> 
```

还有这个：

```
var t = _.template($('#whatever').html(), null, { variable: 'v' });
var h = t({ '6a': true });​ 
```

演示：http: [//jsfiddle.net/ambiguous/hBhfu/](http://jsfiddle.net/ambiguous/hBhfu/)

您也可以在调用模板函数时手动包装它：

```
t({ v: { '6a': true  }}); 
```

在这种情况下，您将使用与上述相同的模板。

演示：http: [//jsfiddle.net/ambiguous/8AZKw/](http://jsfiddle.net/ambiguous/8AZKw/)

# html - 在 div 中定位锚文本

> ID：11997161
> 
> 赞同：0
> 
> 时间：2012-08-17T00:09:50.167
> 
> 标签：html, css, text, anchor

鉴于标记

```
<div id="header">
<a href="cattle.html" class="current">Cattle Farms</a>
</div> 
```

和风格

```
#header
{
width: 960px;
height: 200px;
margin-bottom: 20px;
}

#header a
{
width: 100%;
height: 100%;
display: block;
font-size: 25px;
} 
```

我应该如何放置/定位/对齐文本“cattle farms”，使其位于距左侧 20px 和距底部 20px 的位置，即使在查看时也不会在视觉上破坏 div 的 a萤火虫。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:16:06.663

您需要`position: relative`在父容器上指定：

**CSS**：

```
#header {
  position: relative;

  width: 960px;
  height: 200px;
}

#header a {
  position: absolute;

  bottom: 20px;
  left: 20px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T00:21:56.073

您可以简单地将 a 添加`<span>`到锚点并为其添加一些填充。像这样：

```
<div id="header">
  <a href="cattle.html" class="current"><span>Cattle Farms</span></a>
</div> 
```

并添加这些额外的样式：

```
#header a span {
padding-left: 20px;
padding-bottom: 20px;
} 
```

编辑：

另外，在标题中添加溢出：隐藏。

```
#header {
overflow: hidden;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T00:22:37.673

我建议去掉 100% 的宽度和高度。通过这样做，您将能够将其放置在标题中。如果不这样做，您将被扩大到标题的大小，因此没有空间来更改您的展示位置。

由于它是一个块元素，因此您可以通过几种方式执行此操作。您可以使用边距将其“推”离其他元素（如果您决定在其之上添加更多）。或者您可以使用“位置：相对”和“顶部”或“左侧”。我建议将其与 % 一起使用。我尝试了这段代码，它达到了我认为你想要的效果：

```
#header{
width: 960px;
height: 200px;
}

#header a {
display: block;
position: relative;
top: 95%;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T00:51:56.400

好。我不知道为什么会这样。但它确实

```
div#header a
{
width: 100%;
height: 100%;
display: block;
text-indent: 20px;
line-height: 350px;
} 
```

# ruby-on-rails - 提交表单后遇到 Rails 路由问题

> ID：11997162
> 
> 赞同：0
> 
> 时间：2012-08-17T00:09:52.817
> 
> 标签：ruby-on-rails, routing

所以我正在尝试制作一个允许用户对特定帖子发表评论的表单。单击提交按钮后，我目前遇到问题。该条目确实已放入数据库中，但是看起来我遇到了一些路由问题。

这是我重定向到的 URL：“localhost:3000/groups/13/posts/62/comments”

提交后出现以下错误：

> 没有路线匹配 {:action=>"show", :controller=>"groups"}

我跑了 rake 路线来找到这个：

> ```
>  group GET    /groups/:id(.:format)           groups#show 
> ```

这是我的评论控制器：

```
class CommentsController < ApplicationController
  def create
    @post = Post.find(params[:post_id])
    @comment = @post.comments.create(params[:comment].merge({:user_id => current_user.id}))
    redirect_to :action => :show, :controller => :groups
  end
end 
```

这是我的评论表格：

```
 <%= form_for([post.group, post, post.comments.build]) do |f| %>
                      <p>
                        <%= f.label :comment %><br />
                        <%= f.text_area :body, :rows => 3, :cols => 55 %>
                      </p>
                      <p>
                        <%= f.submit %>
                      </p>
                    <% end %> 
```

有谁知道可能出了什么问题？为什么它会重定向到 url “localhost:3000/groups/13/posts/62/comments”

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:28:22.740

我会做：

```
class CommentsController < ApplicationController
    respond_to :html

    def create
        @post = Post.find(params[:post_id])
        @comment = @post.comments.create(params[:comment]) do |comment|
            comment.user = current_user # user_id shouldn't be an attr_accessible
        end
        respond_with @comment, location: group_path(@post.group)
    end 
```

# .net - 如何等待取消的任务完成？

> ID：11997166
> 
> 赞同：24
> 
> 时间：2012-08-17T00:10:17.683
> 
> 标签：.net, c#-4.0, parallel-processing

当谈到使用 .NET 4.0 进行并行编程时，我显然不知道自己在做什么。我有一个简单的 Windows 应用程序，它启动一个任务来做一些无意识的工作（输出数字 1-1000）。我在中途暂停以模拟长时间运行的过程。当这个长时间的停顿发生时，如果我点击 Stop 按钮，它的事件处理程序会调用 CancellationTokenSource 的 Cancel 方法。我不想在停止按钮的事件处理程序中做任何进一步的处理（在这种情况下，输出一条消息），直到取消的任务通过其当前迭代完成。我该怎么做呢？我尝试在停止按钮的事件处理程序中使用 Task.WaitAll 等，但这只会引发未处理的 AggregateException。如果按照上述方式运行，以下代码将有助于解释我的问题：

```
 private Task t;
  private CancellationTokenSource cts;

  public Form1()
  {
     InitializeComponent();
  }

  private void startButton_Click(object sender, EventArgs e)
  {
     statusTextBox.Text = "Output started.";

     // Create the cancellation token source.
     cts = new CancellationTokenSource();

     // Create the cancellation token.
     CancellationToken ct = cts.Token;

     // Create & start worker task.
     t = Task.Factory.StartNew(() => DoWork(ct), ct);
  }

  private void DoWork(CancellationToken ct)
  {
     for (int i = 1; i <= 1000; i++)
     {
        ct.ThrowIfCancellationRequested();

        Thread.Sleep(10);  // Slow down for text box outout.
        outputTextBox.Invoke((Action)(() => outputTextBox.Text = i + Environment.NewLine));

        if (i == 500)
        {
           Thread.Sleep(5000);
        }
     }
  }

  private void stopButton_Click(object sender, EventArgs e)
  {
     cts.Cancel();

     Task.WaitAll(t);  // this doesn't work :-(

     statusTextBox.Text = "Output ended.";
  }

  private void exitButton_Click(object sender, EventArgs e)
  {
     this.Close();
  } 
```

对此的任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-17T00:16:43.337

您通常只使用`Task.Wait`( 而不是`WaitAll`)，因为它是一个单一的任务。然后适当地处理异常：

```
private void stopButton_Click(object sender, EventArgs e)
{
    cts.Cancel();
    try
    {
        t.Wait();  // This will throw
    }
    catch (AggregateException ae)
    {
       ae.Handle<OperationCanceledException>(ce => true);
    }

    statusTextBox.Text = "Output ended.";
} 
```

当您取消 a`Task`时，`OperationCanceledException`将被包装成 an`AggregateException`并在您调用`Wait()`或尝试获取 Task 时立即被抛出`Result`（如果它是 a `Task<T>`）。

* * *

仅供您参考 - 这是一个地方，特别是考虑到您在这里所做的事情，C# 5 简化了事情。使用新的异步支持，您可以将其编写为：

```
// No need for "t" variable anymore 
// private Task t;

private async void startButton_Click(object sender, EventArgs e)
{
   statusTextBox.Text = "Output started.";

   // Create the cancellation token source.
   cts = new CancellationTokenSource();

   try
   {
      // Create & start worker task.
      await Task.Run(() => DoWork(cts.Token));
      statusTextBox.Text = "Output ended.";
   }
   catch(OperationCanceledException ce) 
   {
      // Note that we get "normal" exception handling
      statusTextBox.Text = "Operation canceled.";
   }
}

private void stopButton_Click(object sender, EventArgs e)
{
   // Just cancel the source - nothing else required here
   cts.Cancel();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-03T22:57:20.927

抱歉，没有足够的声誉来添加一个问题作为对该答案的评论。我想问一下解决方法如何被视为答案。

答案中的代码是否依赖于某种用户界面调整来防止用户一次启动多个后台进程？当然，这总是一个问题。

在这里，我提出了一个替代方案来回答所提出的问题。它显示了如何等待取消请求完成。如果管理不善，它仍然会让 UI 搞砸，但如果确实需要的话，它的代码实际上会在取消后等待。这是一个更大的 C# 类的摘录：

```
AutoResetEvent m_TaskFinishedEvent = new AutoResetEvent( false );
private IAsyncAction m_Operation = null;

private Task WaitOnEventAsync( EventWaitHandle WaitForEvent )
{
    return Task.Run( () => { WaitForEvent.WaitOne(); } );
}

public async void Start()
{
if( m_Operation != null )
    {
        // Cancel existing task
        m_Operation.Cancel();
        // Wait for it to finish. This returns control to the UI.
        await WaitOnEventAsync( m_TaskFinishedEvent );
    }
    // Start the background task.
    m_Operation = ThreadPool.RunAsync( WorkerMethod );
}

private void WorkerMethod( IAsyncAction operation )
{
    while( m_Operation.Status != AsyncStatus.Canceled )
        ; // Add real work here.

    m_TaskFinishedEvent.Set();
} 
```

此代码依赖于一个事件对象来表示任务已基本完成。WorkerMethod() 代码尚未返回，但所有有用的工作都在事件发出信号时完成。

由于我使用此代码的方式，我没有提供 Stop() 函数。如果代码需要这样工作，则执行等待的代码将只进入该 Stop() 函数。

是的，由于取消异常，您不能使用常规的 Wait() 函数。但接受的答案更多的是一种解决方法，没有冒犯（也许我错了？）。

# c# - 编码为欧洲字符返回一个字节

> ID：11997169
> 
> 赞同：0
> 
> 时间：2012-08-17T00:10:22.583
> 
> 标签：c#, encoding, utf-8

如果我将以下字符串编码为 UTF8：

咖啡店

它以 5 个字节而不是 4 个字节返回。如果可能，我希望它返回 4 个字节。

```
Encoding encoding = Encoding.UTF8;
string testString = "café";
Byte[] bytes = encoding.GetBytes(testString); 
```

回报：

```
[0] 99
[1] 97
[2] 102
[3] 195
[4] 169 
```

而“cafe”仅返回 4 个字节。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T00:15:29.053

您不能使用正常的编码方案。

您需要使用所需的代码页创建自定义编码，如下所示：

```
Encoding encoding = Encoding.GetEncoding(437);
byte[] bytes = encoding.GetBytes("café"); 
```

输出：

```
{ 99, 97, 102, 130 } 
```

é 在[代码页 437](http://en.wikipedia.org/wiki/Code_page_437)中为 130 。

假设您要对其进行解码，则需要使用相同的编码对其进行解码。否则你会得到奇怪的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T00:15:43.540

é 是 Unicode U+00E9。Unicode 字符 U+0080 到 U+07FF 在 UTF8 中占用两个字节。有关详细信息，请参阅[http://en.wikipedia.org/wiki/Utf8 。](http://en.wikipedia.org/wiki/Utf8)

如果只需要 4 个字节，则不能使用 UTF8。理论上，您可以使用[ISO 8859-1](http://en.wikipedia.org/wiki/ISO/IEC_8859-1)，它是一种单字节字符编码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-17T00:20:52.140

UTF-8 中的字符可以占用 1 到 6 个字节。因此，对于您的情况，“é”需要 2 个字节。您可以在此处阅读有关 UTF-8 的更多信息：[UTF-8，一种 ISO 10646 的转换格式](https://www.rfc-editor.org/rfc/rfc3629)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T00:29:20.510

最终转换`UTF8`为`ISO8859-1`，现在返回 4 个字节而不是 5 个。

```
Encoding utf8 = Encoding.UTF8;
string testString = "café";
byte[] utfBytes = utf8.GetBytes(testString); // 5 bytes

Encoding iso = Encoding.GetEncoding("ISO-8859-1");
byte[] isoBytes = iso.GetBytes(testString); // 4 bytes
byte[] convertedUtf8Bytes = Encoding.Convert(utf8, iso, utfBytes); // 4 bytes

string msg = iso.GetString(isoBytes);
string msgConverted = iso.GetString(convertedUtf8Bytes);

Console.WriteLine(msg);
Console.WriteLine(msgConverted); 
```

输出：

咖啡店

咖啡店

# css - 页面菜单在悬停时跳跃

> ID：11997171
> 
> 赞同：0
> 
> 时间：2012-08-17T00:10:54.933
> 
> 标签：css, button

当悬停在我的第二个菜单上时（可以在那里找到：http: [//justxp.plutohost.net/survive/index.html](http://justxp.plutohost.net/survive/index.html)）

项目正在跳跃。

一旦我向它们添加了带有填充的背景，它就会发生，这就是它所需要的，但它应该只是出现，而不是跳跃？

我的代码：

HTML + CSS 可以在这里找到：

[http://pastebin.com/cbLDRefB](http://pastebin.com/cbLDRefB)

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T00:15:43.153

为了不跳跃，您不应更改悬停时元素的大小

你有

```
.nav6 a:hover {
    padding: 21px;
} 
```

因此，您不仅需要为所有链接添加填充`:hover`

```
.nav6 a {
    padding: 21px;
} 
```

# javascript - if 和 elseif 语句都触发

> ID：11997175
> 
> 赞同：2
> 
> 时间：2012-08-17T00:11:08.777
> 
> 标签：javascript, jquery, if-statement

我正在构建一个远离鼠标并“环绕”窗口的按钮。对于 jQuery/JavaScript 来说相对较新，我将其构建为一个学习练习（我受到此页面上的 #4 的启发：http: [//panjiva.com/jobs/challenges](http://panjiva.com/jobs/challenges)）。

背景：这实际上是我的第二次尝试，可能不是解决问题的最优雅的方法。基本上，在第二个版本中，隐藏的“临时”按钮与按钮一起移动，并在按钮开始离开屏幕时出现。（我的第一次尝试只有两个按钮，但我在那里遇到了问题。）

下面是一个嵌套的 if/else 语句，它检测按钮的一部分何时移出窗口，如果是，则在正确的位置显示一个临时按钮以提供“换行”效果。它还检查整个按钮是否已移出屏幕，如果是，则将按钮移动到新坐标（临时按钮已暴露的位置）。

我认为整个 if/else 语句应该只允许按钮环绕到一侧，即使按钮留在角落也是如此。然而，当离开一个角落时，它有时会缠绕到 2 或 3 个角落。为什么会这样？

我用完整的代码创建了一个 JSFiddle：http: [//jsfiddle.net/aaronmacy/AVwpU/](http://jsfiddle.net/aaronmacy/AVwpU/)

所有帮助/建议将不胜感激！

```
// Is any part of the button about to move off the page?

// To the top?
if (edgeTop < 0) {

    // Always wrap to the bottom
    bottom.show();

    // Is the button disappearing?
    if (edgeBottom < 0) {
        // Move the button
        buttonNextY += parseInt(viewportHeight);
        moveAll();
        // Hide everything else
        hideTemps();
    }
    else {
        moveAll();
    }
}
// To the right?
else if (edgeRight > parseInt(viewportWidth)) {

    // Wrap to the left
    left.show();

    // Is the button disappearing?
    if (edgeLeft > parseInt(viewportWidth)) {
        buttonNextX -= parseInt(viewportWidth);
        moveAll();
        hideTemps();
    }
    else {
        moveAll();
    }
}
// To the bottom?
else if (edgeBottom > parseInt(viewportHeight)) {

    // Wrap to the top
    top.show();

    // Is the button disappearing?
    if (edgeTop > parseInt(viewportHeight)) {
        buttonNextY -= parseInt(viewportHeight);
        moveAll();
        hideTemps();
    }
    else {
        moveAll();
    }
}
// To the left?
else if (edgeLeft < 0) {

    // Wrap to the right
    right.show();

    // Is the button disappearing?
    if (edgeRight < 0) {
        buttonNextX += parseInt(viewportWidth);
        moveAll();
        hideTemps();
    }
    else {
        moveAll();
    }
}
// If the button is completely inside the window
else {
    moveAll();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T12:12:19.563

我认为他们的要求不清楚“屏幕的另一面”......我会说你的脚本工作正常。他们并没有真正考虑奖金要求，他们只是添加它以查看哪个候选人会付出更多努力....无论如何，在您的按钮之间增加距离，至少在 x 轴上添加按钮宽度和在 y 轴上添加按钮高度。 ..不要隐藏任何副本。相信我，它会自然包裹起来；）

# css - 在 CSS 透视图中使用单位

> ID：11997177
> 
> 赞同：5
> 
> 时间：2012-08-17T00:11:08.487
> 
> 标签：css, perspective, css-transforms

只是一个快速的问题，以消除我对 CSS 上的单位的一些困惑`perspective`。

在 CSS Transforms 规范中，它使用`px`eg来引用它，`perspective: 1000px;`但我已经使用过，并且在许多其他地方其他人也没有使用过它，`px`例如`perspective: 1000;`在 W3Schools 上。

哪种方式更受欢迎？有关系吗？

只是想澄清一下，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T00:24:57.087

仅仅因为它被（某些）浏览器接受并不意味着它是正确的。[CSS 规范要求](http://www.w3.org/TR/css3-values/#lengths)指定度量单位，除非该值为零。

规范说：

> 长度是指距离测量值，在属性定义中由 <length> 表示。长度是一个维度。零长度可以表示为 <number> '0'。（换句话说，对于零长度，单位标识符是可选的。）
> 
> 维度是**紧跟单位标识符的数字。**

（强调我的）

有关示例，请参见[距离单位](http://www.w3.org/TR/css3-values/#lengths)和[其他单位](http://www.w3.org/TR/css3-values/#other-units)。

另见[长度的 MDN 讨论](https://developer.mozilla.org/en-US/docs/CSS/length)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T00:18:31.887

px（或其他绝对单位）是正确的方法。这是文档（比 w3 学校更好）:)

[https://developer.mozilla.org/en-US/docs/CSS/perspective](https://developer.mozilla.org/en-US/docs/CSS/perspective)

# delphi - 平滑滚动字符串网格

> ID：11997180
> 
> 赞同：2
> 
> 时间：2012-08-17T00:11:30.727
> 
> 标签：delphi, delphi-xe2, tstringgrid

我需要一个可以平滑滚动的字符串网格，而不是锁定在顶行/左列位置。当您滚动 a`TStringGrid`时，左侧可见列和顶部可见行沿顶部/左侧边缘对齐到位。我需要用户能够平滑滚动，而不是将这些边缘锁定到位。

我认为这不可能在 VCL 中修改`TStringGrid`（或`TCustomGrid`就此而言），因为它依赖于诸如`TopRow`、`LeftCol`、`VisibleRowCount`等属性。我很确定我需要第三方控件，但我会如果可能的话，我喜欢使用`TStringGrid`，因为我已经有很多代码围绕着它。如果我确实需要第三方网格，那么我希望它能够像`TStringGrid`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T01:27:42.280

简短的回答是否定的，你不能像素滚动 a `TStringGrid`。您可以使用`TScrollBox`. 您可以在 中放置一个网格`TScrollBox`，使网格足够大以容纳所有行和列，并关闭其滚动条，但某些操作（如键盘导航）将不起作用。

其他替代方法是使用`TVirtualTree`网格模式或`TListView`. 两者都有你想要的这个像素滚动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T19:04:52.747

我正在寻找类似的东西。不幸的是，你不能用 Borland 的代码做到这一点，但 Lazarus 可以做到 [逐像素滚动 TStringGrid](https://stackoverflow.com/questions/7876629/scrolling-the-tstringgrid-pixel-by-pixel)
你可能想看看他们的代码。

# ios - 实现可重用线程安全核心数据模式时的问题/问题

> ID：11997181
> 
> 赞同：0
> 
> 时间：2012-08-17T00:11:42.220
> 
> 标签：ios, core-data, nsthread

我在实现[本教程](http://www.cimgf.com/2011/05/04/core-data-and-threads-without-the-headache/)中概述的线程安全核心数据概念时遇到了麻烦。我的目标是拥有一段可重用的代码，可以接受参数，执行核心数据操作（添加、更新、删除），然后在完成后异步回调。

所以这是“安全”修改核心数据对象的块：

```
+ (void)saveDataInContext:(void(^)(NSManagedObjectContext *context))saveBlock
{
    NSManagedObjectContext *context = [NSManagedObjectContext context];
    [context setMergePolicy:NSMergeByPropertyObjectTrumpMergePolicy];
    [defaultContext setMergePolicy:NSMergeObjectByPropertyStoreTrumpMergePolicy];
    [defaultContext observeContext:context];                    

    block(context);                                     
    if ([context hasChanges])                               
    {
        [context save];
    }
} 
```

根据我的理解，这会执行一段代码？我不明白“上下文”是如何在数字中传递的。这是块签名的一部分吗？

所以这是在后台执行操作并添加完成调用的包装器：

```
+ (void)saveDataInBackgroundWithContext:(void(^)(NSManagedObjectContext *context))saveBlock completion:(void(^)(void))completion
{
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0), ^{
        [self saveDataInContext:saveBlock];

        dispatch_sync(dispatch_get_main_queue(), ^{
            completion();
        });
    });
} 
```

这是一个使用它的例子：

```
NSArray *listOfPeople = ...;
[NSManagedObjectHelper saveDataInBackgroundWithContext:^(NSManagedObjectContext *localContext){
    for (NSDictionary *personInfo in listOfPeople)
    {
        PersonEntity *person = [PersonEntity createInContext:localContext];
        [person setValuesForKeysWithDictionary:personInfo];
    }
} completion:^{
    self.people = [PersonEntity findAll];
}]; 
```

这里传入的“localContext”是什么？我认为我在这里的大部分问题都围绕着不理解块。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T02:27:42.530

对该教程的简要介绍表明它正在谈论神奇的记录。我从来没有用过，所以我不能说它。

```
// This declares a class method that returns void and takes a block as parameter.
// The block returns void and has one parameter, namely, a pointer to an
// NSManagedObjectContext object.
+ (void)saveDataInContext:(void(^)(NSManagedObjectContext *context))saveBlock; 
```

你会这样调用那个方法......

```
[SomeClass saveDataInContext:^(NSManagedObjectContext *context){
    // Some code
}]; 
```

这意味着您正在将一段代码传递给该函数。在某些时候，它会执行你给它的代码块。当它这样做时，它会将托管对象上下文传递到块中，以便它可以用它做一些事情。

现在，看看该方法的实现......

```
+ (void)saveDataInContext:(void(^)(NSManagedObjectContext *context))saveBlock
{
    // Create a MOC - note there is no concurrency type, so it will get
    // NSConfinementConcurrencyType, which means it must be used exclusively
    // from the thread in which it was created.  Since it is a local variable
    // and it gets destroyed after this function is called, that should be cool
    // PROVIDED the using block does not do anything untoward with it.
    NSManagedObjectContext *context = [NSManagedObjectContext context];

    // Set the merge policy
    [context setMergePolicy:NSMergeByPropertyObjectTrumpMergePolicy];

    // MR must set some default context...
    // Some how the above context needs a persistent store to save...
    [defaultContext setMergePolicy:NSMergeObjectByPropertyStoreTrumpMergePolicy];

    // Probably setting up notification handler for DidSave
    [defaultContext observeContext:context];                    

    // Now, this is where the block you passed in gets called.
    // Note, that the managed object context has already been setup for you.
    // Now that it's setup, the block of code that you passed in is going
    // to be called, and it will be given a context that it can use to execute
    // code in the calling thread.
    block(context);                 

    // If you changed something to the context in your block of code, the save.
    if ([context hasChanges])                               
    {
        [context save];
    }
} 
```

让我们回顾一下调用这个方法的代码......

```
[SomeClass saveDataInContext:^(NSManagedObjectContext *context){
    // Now, the saveDataInContext method has been called.  However, inside
    // that method, a call was made to the block that was passed in.
    // That would be this here block of code.  So, if you look up in
    // the method, where is calls "block(context)" this block of code will
    // be executed right there.  Mentally, you can cut and paste this code
    // in that spot.
    // The context parameter is the context that was passed to this block.
    // you can use it to do any Core Data stuff...
}]; 
```

现在，这段代码非常相似，但它需要两个块。一个用于在上下文中执行一些代码，另一个是异步保存完成后将执行的块。

saveBlock 应该很熟悉。这与上面示例中的概念相同。

完成是一个块，它返回 void，并且不接受参数。完成所有工作后，它将被调用。

```
+ (void)saveDataInBackgroundWithContext:(void(^)(NSManagedObjectContext *context))saveBlock completion:(void(^)(void))completion
{
    // Dispatch some work on one of the global concurrent queues.  It will
    // get done on some thread, nobody knows which one, but it does not matter
    // because the code in this block calls saveDataInContext, and passes the
    // block it was given that does some modifications to the context.
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0), ^{
        [self saveDataInContext:saveBlock];

        // Now, when the above work is done, we are still running in some random
        // thread.  I guess the library wants all callbacks to happen on the main
        // thread, so this block is dispatched on the main thread.  Note that it
        // calls the second bock passed in as the completion block.
        // So the <saveBlock> will be run on some random thread, and then, when
        // it is done, the <completion> block will be called on the main thread.
        dispatch_sync(dispatch_get_main_queue(), ^{
            completion();
        });
    });
} 
```

像之前一样，当您调用该方法时，您可以在脑海中将 替换为您传入的第一个块，然后替换为第二个块。

```
[NSManagedObjectHelper saveDataInBackgroundWithContext:^(NSManagedObjectContext *localContext){
    // This is the first block.  It gets executed where you see <saveBlock>
    // being used in the earlier method.  You are being given the already
    // prepared MOC, and it's name is <localContext>.  Do your managed object
    // context stuff with it.  Note that it will be running in some unknown thread.
    for (NSDictionary *personInfo in listOfPeople)
    {
        PersonEntity *person = [PersonEntity createInContext:localContext];
        [person setValuesForKeysWithDictionary:personInfo];
    }
} completion:^{
    // Now, this is the second block, which is run when all the core data saving
    // has been completed.  It will run on the main thread.
    self.people = [PersonEntity findAll];
}]; 
```

希望这可以帮助您了解正在发生的事情，即使我不知道神奇唱片在幕后的真正作用。

**编辑**

回应这个评论...

> 我想我不明白这些块是如何工作的。如果一个块具有此方法签名“+ (void)saveDataInContext:(void(^)(NSManagedObjectContext *context))saveBlock”，为什么该块不使用“context”或“saveBlock”？哪个是块的返回值，哪个是传入的值？– 迈克小号

首先，该*块*没有这个签名......

```
+ (void)saveDataInContext:(void(^)(NSManagedObjectContext *context))saveBlock; 
```

那是一个类方法。让我们一块一块地分解。然而，首先，让我们忘记块参数，并使用一些简单的东西来进行比较。

```
+ (void)foo:(NSInteger)someInteger; 
```

即 a 是一个类方法，`foo:`它返回`void`并接受一个参数。该单个参数的类型是`NSInteger`. 如果我想调用它，我会这样做：

```
[SomeClass foo:42]; 
```

同样地...

```
+ (void)saveDataInContext:(void(^)(NSManagedObjectContext *context))saveBlock; 
```

是一个类方法，`saveDataInContext:`它返回 void 并接受一个参数。该单个参数的类型是`void(^)(NSManagedObjectContext *context)`.

现在，不要让那个狼吞​​虎咽的人愚弄你。它只是一种类型（尽管如果你不太了解 C 的话，解析起来会有些混乱）那么，什么是`void(^)(NSManagedObjectContext *context)`

首先，它是一个`block`. 如果那`(^)`之后`void`是`(*)`一个函数指针。

基本上，这意味着该参数的类型是 a `block`，它返回`void`并具有一个参数，即指向 a 的指针`NSManagedObjectContext`（带有 name `context`）。

所以，如果我们大声读出来...

```
+ (void)saveDataInContext:(void(^)(NSManagedObjectContext *context))saveBlock; 
```

是一种类方法，选择器`saveDataInContext:`返回`void`并具有一个参数，该参数具有名称`saveBlock`并且属于“返回 void 并具有一个类型参数的块`NSManagedObjectContext *`”。

就像我们这样称呼第一个例子......

```
[SomeClass foo:42]; 
```

我们这样称呼后一个例子......

```
[SomeClass saveDataInContext:^(NSManagedObjectContext *context){
    // We are creating a bock of code, so stuff some code in here.
}]; 
```

现在，就像您将整数传递`42`给`foo:`您一样，您将块之间的块`{}`作为参数传递给`saveDataInContext:`.

现在，请注意该`saveDataInContext:`方法的签名需要一个本身具有参数的块。所以，当你提供你的块时，你基本上是在说，“嘿，这里有一段代码供你调用，当你这样做时，请确保给我一个指向 `NSManagedObjectContext`我可以使用的对象的指针。

这意味着当你的块被调用时，调用代码将调用你的块并为`NSManagedObjectContext *`你提供一个变量 name `context`。

可以这样想，作为`saveDataInContext:`.

```
+ (void)saveDataInContext:(void(^)(NSManagedObjectContext *context))saveBlock {
    // Create a context to give the block we are going to call..
    NSManagedObjectContext *moc = //       
    saveBlock(moc);
} 
```

现在，当您的代码被调用时，您将获得该`moc`对象作为您的参数。基本上，该方法创建一个托管对象上下文，执行所有线程安全工作，然后调用您的代码块，并为您提供指向它已安全创建的托管对象上下文的指针。您的代码在该安全环境的范围内执行，使用作为函数（块）参数传递给它的 MOC。

我希望这没有让事情变得更糟......

# python - 需要帮助来解决这个 UnicodeDecodeError

> ID：11997184
> 
> 赞同：1
> 
> 时间：2012-08-17T00:12:45.277
> 
> 标签：python, google-app-engine, unicode, utf-8, unicode-string

当我使用此代码时（改编自 [Stephen Holiday 代码](http://stephenholiday.com/articles/2011/gender-prediction-with-python/)- 感谢 Stephen 提供您的代码！）：

```
#!/usr/bin/env python    
# -*- coding: utf-8 -*-
# -*- coding: utf-8 -*-

"""
USSSALoader.py
"""
import os
import re
#import urllib2
from zipfile import ZipFile
import csv
import pickle

def getNameList():
    namesDict=extractNamesDict()
    maleNames=list()
    femaleNames=list()
    for name in namesDict:
        counts=namesDict[name]
        tuple=(name,counts[0],counts[1])
        if counts[0]>counts[1]:
            maleNames.append(tuple)
        elif counts[1]>counts[0]:
            femaleNames.append(tuple)
    names=(maleNames,femaleNames)
    return names

def extractNamesDict():
    zf=ZipFile('names.zip', 'r')
    filenames=zf.namelist()

    names=dict()
    genderMap={'M':0,'F':1}

    for filename in filenames:
        file=zf.open(filename,'r')
        rows=csv.reader(file, delimiter=',')

        for row in rows:
            name=row[0].upper()
           # name=row[0].upper().encode('utf-8')
            gender=genderMap[row[1]]
            count=int(row[2])

            if not names.has_key(name):
                names[name]=[0,0]
            names[name][gender]=names[name][gender]+count

        file.close()
        print '\tImported %s'%filename
    return names

if __name__ == "__main__":
    getNameList() 
```

我收到了这个错误：

```
 iterator = raw_query.Run(**kwargs)
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\api\datastore.py", line 1622, in Run
    itr = Iterator(self.GetBatcher(config=config))
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\api\datastore.py", line 1601, in GetBatcher
    return self.GetQuery().run(_GetConnection(), query_options)
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\api\datastore.py", line 1490, in GetQuery
    filter_predicate=self.GetFilterPredicate(),
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\api\datastore.py", line 1534, in GetFilterPredicate
    property_filters.append(datastore_query.make_filter(name, op, values))
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\datastore\datastore_query.py", line 107, in make_filter
    properties = datastore_types.ToPropertyPb(name, values)
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\api\datastore_types.py", line 1745, in ToPropertyPb
    pbvalue = pack_prop(name, v, pb.mutable_value())
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\api\datastore_types.py", line 1556, in PackString
    pbvalue.set_stringvalue(unicode(value).encode('utf-8'))
UnicodeDecodeError: 'ascii' codec can't decode byte 0xe1 in position 1: ordinal not in range(128) 
```

当我的名称包含非 ASCII 字符（如“Chávez”或“Barañao”）时，就会发生这种情况。我试图解决这个问题：

```
 for row in rows:
           # name=row[0].upper()
            name=row[0].upper().encode('utf-8')
            gender=genderMap[row[1]]
            count=int(row[2]) 
```

但是，然后，我得到了另一个错误：

```
 File "C:\Users\CG\Desktop\Google Drive\Sci&Tech\projects\naivebayes\USSSALoader.py", line 17, in getNameList
    namesDict=extractNamesDict()
  File "C:\Users\CG\Desktop\Google Drive\Sci&Tech\projects\naivebayes\USSSALoader.py", line 43, in extractNamesDict
    name=row[0].upper().encode('utf-8')
UnicodeDecodeError: 'ascii' codec can't decode byte 0xed in position 3: ordinal not in range(128) 
```

我也试过这个：

```
def extractNamesDict():
    zf=ZipFile('names.zip', 'r', encode='utf-8')
    filenames=zf.namelist() 
```

但`ZipFile`没有这样的论据。

那么，如何解决`UnicodeDecodeError`非 ASCII 名称的问题呢？

我正在将此代码与 GAE 一起使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T01:37:49.940

看起来您的第一个回溯与 AppEngine 相关。您是否正在构建将填充数据存储的加载程序？如果是这样，查看包含模型的代码并执行`put`'ing 会很有帮助。我可能会被某人纠正，但是为了使该部分起作用，我相信您实际上需要`decode`代替`encode`（即，当您在 之前阅读工作表时`put`，使用`decode('utf-8')`or将字符串转换为unicode `decode('latin1')`，具体取决于您的情况）。

至于您的本地代码，我不会假装知道 Unicode 处理的深层内部结构，但我通常使用`decode()`并`encode()`处理这些类型的情况。我相信要使用的正确编码取决于底层文本（这意味着您需要知道它是否被编码`utf-8`或`latin-1`等）。这是您的示例的快速测试：

```
>>> s = 'Chávez'
>>> type(s)
<type 'str'>
>>> u = s.decode('latin1')
>>> type(u)
<type 'unicode'>
>>> e = u.encode('latin1')
>>> print e
Chávez 
```

在这种情况下，我需要使用`latin1`来解码编码的字符串（我使用的是终端），但在你的情况下使用`utf-8`可能会很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T03:25:37.933

除非我遗漏了什么，否则图书馆中的这一行：

```
pbvalue.set_stringvalue(unicode(value).encode('utf-8')) 
```

应该：

```
pbvalue.set_stringvalue(value.decode(filename_encoding).encode('utf-8')) 
```

`filename_encoding`如果没有以某种方式存储在 zip 存档中（并且至少在格式的早期版本中，我怀疑它是否被存储），那么从您的代码传入的值。这是假设字节和“字符”是同一事物的经典错误的又一次出现。

如果您感到头晕目眩，请深入研究代码并修复它，甚至可以贡献一个补丁。否则，您将不得不编写英雄代码来检查文件名中的 U+0080 及更高版本并执行特殊处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-31T08:43:20.820

在 python 2.7（和 linux Mint 17.1）中，您必须使用：hashtags=['transito','tránsito','ñandú','pingüino','fhürer'] 用于标签中的 h：u=h.decode('utf -8') 打印(u.encode('utf-8'))

> > transto tránsito ñandú pingüino fhürer

# matlab - 如何在matlab的图中手动编辑不同的轴？

> ID：11997187
> 
> 赞同：0
> 
> 时间：2012-08-17T00:13:25.003
> 
> 标签：matlab, axes

我在 matlab 中使用 plotyy 在同一个图中使用两个数据集。我想使用图形菜单手动编辑轴属性。但我发现我只能选择和编辑第一个轴，而不能选择和编辑第二个轴。当然，我可以使用命令“set”编辑那些，但只是想知道如何选择第二个轴。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T00:22:43.257

在您的图中，单击“查看 -> 绘图浏览器”，第二个轴将列在底部并且可以选择。

# windows-8 - WinJS 不卸载 js/css

> ID：11997190
> 
> 赞同：7
> 
> 时间：2012-08-17T00:14:09.507
> 
> 标签：windows-8, microsoft-metro, winjs

我正在开发一个 Windows 8 Metro 应用程序，我发现（即使在我没有触及代码的他们的示例应用程序中）当您在页面之间导航时，顶级“default.html”获取每个 js 和在应用程序运行期间加载的 css 文件。

这让我很头疼，因为我的 css 在不同的页面之间发生冲突。我错过了什么还是这是严重的错误？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-17T21:00:14.297

不卸载 JavaScript 和 CSS 是经过深思熟虑的选择，而不是意外或疏忽。

首先，要了解页面控件纯粹是一种 JavaScript 结构——浏览器引擎完全不了解它们。浏览器只会看到由脚本动态生成的 DOM 块。

Web 平台不允许您卸载脚本文件——一旦它们被加载到上下文中，它们就会永远存在。

使用 CSS，他们本可以尝试删除标签，但它打开了一罐蠕虫。根据导航到的订单页面，您最终可能会在同一个应用程序中应用不同的样式。如果两个页面引用同一个样式表怎么办？您是否两次添加相同的链接标签？你删除哪一个？

一团糟。相反，WinJS 保证脚本和样式表将在第一次被引用时加载一次且仅一次。因此，您可以让应用程序中的每个页面都引用“myStyles.css”，并且它只会被加载一次（并且只有一个样式标签）。

那么，您会采取什么措施来防止出现这些问题呢？首先，请记住您正在构建一个应用程序，而不是一个会任意增加新内容的网站。决定你的一般风格和课程。将共享样式放入您的 default.css 并从您的 default.html 文件中引用它。

对于单个页面，最简单的做法是在样式前面加上页面名称。代替：

```
<div class='intro'></div> 
```

做

```
<div class='page1-intro'></div> 
```

那么你就可以保证避免碰撞。

如果您通过 ID 引用页面元素，请不要这样做。在页面中使用 ID 会导致各种潜在的怪异（如果您同时渲染相同的页面控件两次怎么办？另外，ID 直到页面加载到 DOM 后才存在，这意味着数据获胜按 ID 引用的选项不起作用）。但是，如果您再次坚持，请考虑在页面前加上 id 前缀。

基本上，设置临时命名空间以防止发生冲突。这比手动撕掉链接标签要容易得多，并且会比进行完整导航带来更好的应用体验。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T02:40:46.820

它不是错误，它是 WinJS 模板使用的默认应用程序模式的一部分。默认的 WinJS 模板使用单页模型，这意味着所有内容都使用 PageNavigatorControl 加载到 default.html 中。因此，内存中始终只有一个 DOM。如果您在常规浏览器中遵循类似的模式，您会看到相同的行为。

如果需要，您可以使用多个页面和传统的 href 链接来使用更传统的导航。这不是推荐的方法，但如果您尝试引入使用该模型构建的现有 Web 资产，它可以使事情变得更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T08:01:38.437

`link`您可以通过在文档中查询导入样式的元素并禁用不需要的元素来解决此问题。您需要确保没有禁用项目中的 MS CSS 文件和 default.css 文件，假设您使用它来定义应用程序的通用样式。

这是一个示例，向您展示如何执行此操作。这是一个名为 page2.html 的文件，当被该`WinJS.Pages.UI.render`方法加载时，它将定位并禁用`link`它不需要的元素。它确保 page2.css 文件已启用并保留它简单忽略的文件的列表。

（我把它放在`ready`处理程序函数中，但我倾向于在处理程序中使用这种技术来处理 WinJS.Navigation 事件，并依靠一致的文件命名来获得我想要的结果）。

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>UnloadCSS</title>

    <!-- WinJS references -->
    <link href="//Microsoft.WinJS.1.0/css/ui-dark.css" rel="stylesheet" />
    <script src="//Microsoft.WinJS.1.0/js/base.js"></script>
    <script src="//Microsoft.WinJS.1.0/js/ui.js"></script>

    <!-- UnloadCSS references -->
    <link href="/css/page2.css" rel="stylesheet" />

<script>
    WinJS.UI.Pages.define("/page2.html", {
        ready: function () {

            var ignoreList = ["/css/ui-dark.css", "/css/ui-light.css", "/css/default.css"];
            var myCSS = "/css/page2.css";

            WinJS.Utilities.query("link").forEach(function (linkElem) {
                if (linkElem.href.indexOf(myCSS) > -1) {
                    linkElem.disabled = false;
                } else {
                    var ignore = false;
                    ignoreList.forEach(function (ignoreItem) {
                        if (linkElem.href.indexOf(ignoreItem) > -1) {
                            ignore = true;
                        }
                    });
                    if (!ignore) {
                        linkElem.disabled = true;
                    }
                }
            });
        }
    });
</script>
</head>
<body>
    <button>Change </button>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-14T19:09:54.810

这可能是使用约定名称方法的一个很好的解决方案：

```
var currentPage = Application.navigator.pageControl.uri.replace("ms-appx://" + Windows.ApplicationModel.Package.current.id.name.toLowerCase(), "");
var currentCss = currentPage.replace(".html", ".css");

var ignoreList = ["/css/ui-dark.css", "/css/ui-light.css", "/css/default.css"];

WinJS.Utilities.query("link").forEach(function (linkElem) {
    if (linkElem.href.toLowerCase().indexOf(currentCss) > -1) {
        linkElem.disabled = false;
    } else {
        var ignore = false;
        ignoreList.forEach(function (ignoreItem) {
        if (linkElem.href.toLowerCase().indexOf(ignoreItem.toLowerCase()) > -1) {
            ignore = true;
        }});
        if (!ignore) {
            linkElem.disabled = true;
        }
        }
}); 
```

# clojure - Clojure：for循环中的缓冲阅读器

> ID：11997191
> 
> 赞同：4
> 
> 时间：2012-08-17T00:14:16.723
> 
> 标签：clojure

我有一个要在 Clojure 中处理的大文本文件。
我需要一次处理 2 行。

我决定使用 for 循环，因此我可以使用以下绑定为每次传递拉 2 行（rdr 是我的读者）：

```
[[line-a line-b] (partition 2 (line-seq rdr))] 
```

（我很想知道其他方法来为每个循环迭代获取 2 行，但这不是我的问题的重点）。

当试图让循环工作（对这些测试使用更简单的绑定）时，我看到了以下我无法解释的行为：

为什么

```
(with-open [rdr (reader "path/to/file")]  
    (for [line (line-seq rdr)]  
          line)) 
```

触发流关闭异常

尽管

```
(with-open [rdr (reader "path/to/file")]  
    (doseq [line (line-seq rdr)]  
        (println line))) 
```

作品？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T00:19:24.493

for 是惰性的，只返回最终将从文件中读取数据的序列的头部。当您的 repl**打印 for 的内容时，该文件已经关闭。**你可以修复这个包裹`for`在一个`doall`

```
(with-open [rdr (reader "path/to/file")]  
    (doall (for [line (line-seq rdr)]  
      line))) 
```

尽管这使序列变得不那么懒惰。

这是我的 misc.clj 中的一个函数示例，它在文件末尾懒洋洋地关闭文件：

```
(defn byte-seq [rdr]
  "create a lazy seq of bytes in a file and close the file at the end"
  (let [result (. rdr read)]
    (if (= result -1)
     (do (. rdr close) nil)
     (lazy-seq (cons result (byte-seq rdr)))))) 
```

# ruby-on-rails - 如何在 Rails 应用程序中为 Heroku 上的生产环境设置邮件程序

> ID：11997192
> 
> 赞同：18
> 
> 时间：2012-08-17T00:14:16.037
> 
> 标签：ruby-on-rails, heroku, devise, actionmailer, production

我需要使用邮件程序向用户发送电子邮件，以将他们的密码设置为 Devise 和活动管理员的“可恢复”功能。在开发环境中，我通过将以下内容添加到这些文件中来完成此操作：

配置/环境/开发

```
#Added per active admin install instructions
config.action_mailer.default_url_options = { :host => 'localhost:3000' }

#These settings are for the sending out email for active admin and consequently the   devise mailer
ActionMailer::Base.delivery_method = :smtp
ActionMailer::Base.perform_deliveries = true
ActionMailer::Base.raise_delivery_errors = true
ActionMailer::Base.smtp_settings = 
{

  :address            => 'smtp.gmail.com',
  :port               => 587,
  :domain             => 'gmail.com', #you can also use google.com
  :authentication     => :plain,
  :user_name          => 'XXXXX@gmail.com',
  :password           => 'XXXXXXX'
} 
```

如何在生产环境中获得相同的功能？我想将我的应用程序部署到 Heroku。我需要添加哪些文件和代码？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-05-26T22:05:37.270

您在开发模式下设置的所有配置都将起作用，除了您需要重新配置默认邮件程序 url。

所以。

1.  从 development.rb 复制粘贴您的设置。

2.  将您的默认邮件程序指向您的 heroku 应用程序：

    ```
    config.action_mailer.default_url_options = { :host => 'YOURAPPNAME.herokuapp.com' } 
    ```

此外，请注意您的 smtp 在迁移到生产环境时可能存在的任何电子邮件限制。例如，在开发过程中很难触发 gmail 的 smtp 限制，但在生产中更容易触发它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-17T00:51:02.523

如果它在开发模式下工作，那么它将在生产模式下工作。

假设一切设置正确，在开发中重置密码将已经使用您的 gmail 帐户发送实际电子邮件。

设计仅依赖于正确的邮件配置设置（您已完成），并配置设计以允许密码重置，以及可能的电子邮件“发件人”字段的另一个设置。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-07-30T14:23:34.867

这应该可以正常工作！

只要 config/environments/production.rb 有相同的东西有一个例外。default_url_options 的 :host 值应仅在开发中为“localhost”，在 heroku 生产中应为“YOURAPPNAME.herokuapp.com”。

IE

```
config.action_mailer.default_url_options = { :host => 'YOURAPPNAME.herokuapp.com' } 
```

记得在 gmail 上解锁验证码，否则它不会从 heroku 发送电子邮件（来源不明）。您可以通过以下链接进行操作：[http ://www.google.com/accounts/DisplayUnlockCaptcha](http://www.google.com/accounts/DisplayUnlockCaptcha)

作为一个建议，我会说从environments.rb中移出这个

```
ActionMailer::Base.perform_deliveries = true
ActionMailer::Base.raise_delivery_errors = true 
```

并且位置在environments/development.rb中

```
config.action_mailer.perform_deliveries = true
config.action_mailer.raise_delivery_errors = true 
```

生产中不需要它。

从 Rails 应用程序（在临时环境中）发送电子邮件时，请参阅[Net::SMTPAuthenticationError](https://stackoverflow.com/questions/18124878/netsmtpauthenticationerror-when-sending-email-from-rails-app-on-staging-envir)以获取有关 gmail 将 heroku 视为未知主机的更多信息。

# clearcase-remote-client - 尝试在 ClearCase Remote Client 中创建视图时出现“非法参数 - 无效的 copyarea 根路径”

> ID：11997193
> 
> 赞同：1
> 
> 时间：2012-08-17T00:14:26.180
> 
> 标签：clearcase-remote-client

在新视图创建对话框上按“*完成*”后出现 $subj 错误。路径看起来绝对有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:14:26.180

该错误是由`.copyarea.dat`（可能是`.copyarea.db`）您要在其中创建视图的相同或更高目录级别上的文件引起的。它看起来像是对嵌套视图的保护，但是如果您在您的`$HOME`（意外或出于备份目的）中创建了该文件，那么您就不走运了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T04:18:06.480

您不能在以下位置创建 CCRC 视图`$HOME`：

如“[关于 CCRC .ccase_wvreg 文件](http://www-01.ibm.com/support/docview.wss?&rs=984&uid=swg21228258)”中所述：

> ClearCase 远程客户端在用户的主目录中创建并存储每个名为**`.ccase_wvreg`**（Web 视图注册表）的 CCRC 客户端的本地文件。
> 当使用 CCRC 创建第一个视图时，此文件为给定用户存储系统上每个 CCRC 视图的视图根（复制区域）的本地路径。

因此，尝试创建一个包含*所有*视图的“视图注册表”的视图是……不可能的。

> 从 CCRC 创建视图后，`.ccase_wvreg`文件存储在：
> 
> *   在 Windows 上：
>     `C:\Documents and Settings\<username>`在哪里`<username>`创建视图的实际用户名或从环境变量推断的路径`%USERPROFILE%`（此路径可能是本地或远程）。
> *   在 UNIX/Linux:
>     `/export/home/<username>`上，这是创建视图的用户主目录或 cd'ing to 指示的路径`~<username>`。

# objective-c - 将图像保存到目录

> ID：11997196
> 
> 赞同：0
> 
> 时间：2012-08-17T00:14:37.160
> 
> 标签：objective-c, xcode, nsstring, nsurl, nsfilemanager

嗨，我想将图像保存到目录中，我传递 NSData 并执行我认为会将文件保存在我创建的目录中的操作，但问题是它不保存。这就是我到目前为止所拥有的。为什么不起作用`initWithContentsOfURL:encoding:error:`，它返回 null 但我使用的另一种方法有效？主要问题是`WRITETOURL`它返回一个 0 我认为这意味着信息没有正确存储，有什么提示吗？

```
 NSFileManager *fm = [[NSFileManager alloc] init];
        NSArray * directoryPaths = [fm URLsForDirectory:NSCachesDirectory inDomains:NSUserDomainMask];
        NSLog(@"%@", directoryPaths);
        NSURL* dirPath = nil;    
        dirPath = [[directoryPaths objectAtIndex:0] URLByAppendingPathComponent:[NSString stringWithFormat:@"photos.jpeg"]];
       NSError* theError = nil;
       [fm createDirectoryAtURL:dirPath withIntermediateDirectories:YES attributes:nil error:&theError];

    UIImage* photoToStore = [UIImage imageWithData:photoToSave];

    NSString *pathContainingPhoto = [[NSString alloc] initWithFormat:@"%@.jpeg", UIImageJPEGRepresentation(photoToStore, 1.0)];
    NSError *error = nil;

    BOOL OK = [pathContainingPhoto writeToURL:dirPath atomically:YES encoding:NSUTF8StringEncoding error:&error];

    NSLog(@"OK = %d", OK); //Returns 0
    NSLog(@"%@", dirPath);

    //WHY DOESNT THIS VERSION WORK?
    // NSString *pathToFile = [[NSString alloc] initWithContentsOfURL:dirPath encoding:NSUTF8StringEncoding error:&error];
    NSLog(@"%@", pathToFile);

      NSString* pathToFile = [NSString stringWithContentsOfURL:dirPath encoding:nil error:nil];
    NSArray *dirContents = [fm contentsOfDirectoryAtPath:pathToFile error:nil];
    NSLog(@"%@", dirContents); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T04:41:26.067

在 .h 文件中这样做和 int count 并设置其初始值 count = 0; 在 viewDidLoad 中：

```
NSString *stringPath = [[NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES)objectAtIndex:0]stringByAppendingPathComponent:[NSString stringWithFormat:@"Image_%d.png",count];
error = nil;
if (![[NSFileManager defaultManager] fileExistsAtPath:stringPath]) // removing item it already exuts
{
   [[NSFileManager defaultManager] removeItemAtPath:stringPath error:&error];
}

if(photoToSave) // nsdata of image that u have
{
  [photoToSave writeToFile:stringPath atomically:YES];
}
count++; // maintaining count of images 
```

# javascript - JavaScript 不能在 IE9 上运行，而是在其他浏览器上运行？怎么了？

> ID：11997202
> 
> 赞同：0
> 
> 时间：2012-08-17T00:15:27.190
> 
> 标签：javascript, html

我一直在开发这个小应用程序，它在我可以尝试的每个浏览器（我在 Mac 上）都运行良好，我尝试过 Firefox、Chrome、Opera 和 Safari，并且它运行良好。我把它发给了一位同事（他使用 PC），他说它适用于 Chrome、Firefox 和 Opera，但不适用于 IE9。

我让另一位同事尝试了它，他说它适用于 Chrome，但不适用于 IE9。

到目前为止，它似乎适用于除 IE9 之外的所有浏览器。另一位同事说第一次在 Chrome 中它只是刷新屏幕，然后他重新输入所有内容，之后即使重复使用它也能正常工作。

谁能告诉它有什么问题？这是我第一个真正使用的应用程序，所以如果这个问题对每个人来说都很明显，我很抱歉。

```
<html>
<head>
<title>Daily Calorie Limit</title>

</head>
<body>

<script type="text/javascript" language="javascript">

function Calculate() {

    var gender = document.getElementById("gender").value;
    var weight = document.getElementById("weight").value;
    var inches = parseInt(document.getElementById("inches").value, 10);
    var height = (parseInt(document.getElementById("feet").value, 10) * 12) + inches;
    var age = document.getElementById("age").value;
    var goal = document.getElementById("goal").value;

    if(gender=="male") 
        {
            val1 = 6.23 * weight;
            val2 = 12.7 * height;
            val3 = 6.8 * age;
            dailyDeficit = (goal * 3500) / 90;

            result = 66 + val1 + val2 - val3;

            cals = result * 1.55;
            calMax = cals - dailyDeficit;

        }
    else if (gender=="female")
        {
            val1 = 6.23 * weight;
            val2 = 4.7 * height;
            val3 = 4.7 * age;
            dailyDeficit = (goal * 3500) / 90;

            result = 655 + val1 + val2 - val3;

            cals = result * 1.55;
            calMax = cals - dailyDeficit;
        }

document.getElementById("answer").textContent = 'Your Daily Calorie Limit is: ' + calMax.toFixed(0); 

}

</script>

<form action="#">
    Gender  : <select id="gender"><option value="male">Male</option><option value="female">Female</option></select><br />
    Weight  : <input type="text" id="weight" />lbs.<br />
    Height  : <input type="text" id="feet" />ft. <input type="text" id="inches" />in.<br />
    Age     : <input type="text" id="age" /><br />
    Goal    : <select id="goal"><option value=5>Lose 5 Pounds</option><option value=10>Lose 10 Pounds</option><option value=15>Lose 15 Pounds</option><option value=20>Lose 20 Pounds</option><option value=25>Lose 25 Pounds</option></select><br />

    </fieldset>
    <input type="submit" value="Give me my Daily Calorie Limit!" onclick="Calculate()" />
</form>
<div id="answer"></div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T00:27:02.583

我发现您的脚本存在以下问题：

1.  `.textContent`并非所有浏览器都支持。IE`.innerText`改为使用。它可能是最容易使用的`.innerHTML`，它适用于任何地方。
2.  您的按钮是一个提交按钮，因此在按下它后页面会重新加载。
3.  您的许多变量未声明，因此它们是隐式全局变量（坏）。
4.  您有一个`</fieldset>`标签，但没有匹配`<fieldset>`的 .

这是一个固定的工作版本：http: [//jsfiddle.net/jfriend00/b2DgP/](http://jsfiddle.net/jfriend00/b2DgP/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T01:04:22.287

别人给了你答案，一些意见和建议，你要的就用，不要的忽略：

1.  表单控件必须有一个名称才能成功（即与表单一起提交）
2.  除非您使用 XML 或 XHTML 并将文档作为应用程序/XML 发送（极不可能），否则不需要 XML 样式的标记
3.  脚本元素的语言属性在 HTML 4 中已弃用，它已从 HTML5 中删除
4.  按照惯例，以大写字母开头的变量名是为构造函数保留的
5.  当对字符串应用除“+”之外的数学运算时，它将被转换为数字，并且可以使用一元“+”代替 parseInt。
6.  可以使用 Math.round 代替 toFixed(0)
7.  val2、val3 和 result 的因子可以取决于所选的性别，删除 if..else 语句。
8.  选择元素中的一个选项应设置为默认选择

可以对代码进行整理和重构以消除冗余：

```
<script type="text/javascript">

function calculate() {
    var form   = document.forms['f0'];
    var height = form.feet.value * 12 + +form.inches.value;
    var factor = form.gender.value == 'male'? [12.7, 6.8, 66] : [4.7, 4.7, 655];

    var val1 = 6.23 * form.weight.value;
    var val2 = factor[0] * height;
    var val3 = factor[1] * form.age.value;
    var result = factor[2] + val1 + val2 - val3;

    dailyDeficit = form.goal.value * 3500 / 90;
    calMax = result * 1.55 - dailyDeficit;

    document.getElementById("answer").innerHTML = 'Your Daily Calorie Limit is: ' +
                                                   calMax.toFixed(0); 
}

</script>

<form action="#" id="f0">
    Gender  : <select id="gender">
               <option value="male">Male
               <option value="female">Female
              </select>
              <br>
    Weight  : <input type="text" id="weight">lbs.
              <br>
    Height  : <input type="text" id="feet">ft. <input type="text" id="inches">in.
              <br>
    Age     : <input type="text" id="age">
              <br>
    Goal    : <select id="goal">
                <option value="5">Lose 5 Pounds
                <option value="10">Lose 10 Pounds
                <option value="15">Lose 15 Pounds
                <option value="20">Lose 20 Pounds
                <option value="25">Lose 25 Pounds
              </select>
              <br>
              <input type="button" value="Give me my Daily Calorie Limit!"
                     onclick="calculate()">
</form>
<div id="answer"></div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T00:26:23.180

我想我发现了问题所在：您用于`textContent`设置 DIV 的内容。Internet Explorer 不支持此类属性（欢迎加入 IE-haters 俱乐部）。尝试替换`textContent`为`nodeValue`，它具有更好的跨浏览器兼容性。

# qt - 在哪里托管基于 Qt 的翻译文件

> ID：11997204
> 
> 赞同：1
> 
> 时间：2012-08-17T00:15:37.330
> 
> 标签：qt, open-source

我有几个基于 Qt 的应用程序，我想向其他人开放翻译权限，但我不知道是否有网站可以做到这一点？

或者你对这种情况有什么建议，我认为维护者不应该通过电子邮件维护翻译文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T05:59:51.810

您可以在[Subversion](http://subversion.tigris.org/)或[Git等存储库中管理翻译文件，并将它们托管在](http://git-scm.com/)[Sourceforge](http://sourceforge.net/)或[GitHub](https://github.com/)等页面上。

# ios - iOS NSTimer 不工作？

> ID：11997205
> 
> 赞同：5
> 
> 时间：2012-08-17T00:15:38.417
> 
> 标签：ios, ios5, methods, nstimer

这是我的确切代码，它似乎不起作用。你能告诉我我做错了什么吗？请注意，refreshTimer 已在私有接口中声明。

```
-(void)viewDidLoad {
refreshTimer = [NSTimer timerWithTimeInterval:1 target:self selector:@selector(timerTest)      userInfo:nil repeats:YES];

}
-(void)timerTest {
NSLog(@"Timer Worked");
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-17T00:18:24.377

试一试`scheduledTimerWithTimeInterval`：

```
NSTimer *myTimer = [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(myMethod) userInfo:nil repeats:YES]; 
```

引用：[NSTimer timerWithTimeInterval：不工作](https://stackoverflow.com/questions/11058571/nstimer-timerwithtimeinterval-not-working)

`scheduledTimerWithTimeInterval:invocation:repeats`: 和`scheduledTimerWithTimeInterval:target:selector:userInfo:repeats`: 创建自动添加到 的计时器`NSRunLoop`，这意味着您不必自己添加它们。将它们添加到 an`NSRunLoop`是导致它们触发的原因。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-17T00:41:28.993

有两种选择。

如果使用`timerWithTimeInterval`

使用以下喜欢它。

```
refreshTimer = [NSTimer timerWithTimeInterval:1.0f target:self selector:@selector(timerHandler) userInfo:nil repeats:YES];
[[NSRunLoop currentRunLoop] addTimer:refreshTimer forMode:NSRunLoopCommonModes]; 
```

模式也是两个选项。`NSDefaultRunLoopMode`对比`NSRunLoopCommonModes`

更多信息。请参阅此文档：[RunLoopManagement](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Multithreading/RunLoopManagement/RunLoopManagement.html)

* * *

如果使用`scheduledTimerWithTimeInterval`

使用以下喜欢它。

```
refreshTimer = [NSTimer scheduledTimerWithTimeInterval:1.0f target:self selector:@selector(timerHandler) userInfo:nil repeats:YES]; 
```

计划的计时器会自动添加到运行循环中。

更多信息。请参阅此文档：[Timer Programming Topics](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Timers/Articles/usingTimers.html#//apple_ref/doc/uid/20000807-CJBJCBDE)

## **总之**

> `timerWithTimeInterval`您必须记住将计时器添加到要添加的运行循环中的“ ”。
> 
> " `scheduledTimerWithTimeInterval`" 默认自动创建一个在当前循环中运行的计时器。

# c - （C代码）我将如何在函数之间传递我的全局变量并在主函数也需要它们时返回它们？

> ID：11997209
> 
> 赞同：1
> 
> 时间：2012-08-17T00:15:54.300
> 
> 标签：c

（C代码）我将如何在函数之间传递我的全局变量并在主函数也需要它们时返回它们？我在下面发布了我的代码以供参考。当然，我也有一个头文件，其中也包含我的函数原型，但它们只在右括号内列出变量类型，而不是变量名......

```
#include <stdio.h>
#include <ctype.h>
#include <string.h>
#include "myheader.h"

char user_filename[150];
char user_filename2[150];
FILE *fp;
FILE *fp2;
int num_shift;

int main()
{
    int choice;     // main variables
    int option;

    char result;
    char ch;
    int offset;
    char character;
    int tmp;

    option = 0;
    num_shift = 0;
    strncpy(user_filename, "not set", sizeof("not set"));
    strncpy(user_filename2, "not set", sizeof("not set"));
    fp = NULL;
    fp2 = NULL;

    choice = menu(num_shift, user_filename, option);   // get user's first selection

    while(choice != QUIT)   //execute so long as choice is not equal to QUIT
    {
        switch(choice)
            {
                case INPUT_FILE:
                    input(user_filename);
                    break;
                case OUTPUT_FILE:
                    output();
                    break;
                case NUM_TO_SHIFT:
                    num_shift = shift(num_shift);
                    printf ("Shift by %d\n",num_shift);
                    break;
                case ENCODE:
                    encode(result, ch, num_shift, character);
                    break;
                case QUIT:
                    quit();
                    break;
                case REVIEW:
                    review (user_filename);
                    break;
                default:
                    printf("Oops! An invalid choice slipped through.  ");
                    printf("Please try again.\n");
            }
      choice = menu(num_shift, user_filename, 0); /* get user's subsequent selections */
    }

   quit();

}

int menu(int num_shift, char * user_filename, int option)
{
    printf("\nText Encoder Service\n\n");
    printf("1.\tEnter name of input file (currently '%s')\n", user_filename);
    printf("2.\tEnter name of output file (currently '%s')\n", user_filename2);
    printf("3.\tEnter number of characters data should be shifted (currently %d)\n", num_shift);
    printf("4.\tEncode the text\n");
    printf("5.\tReview the text in the input file\n");
    printf("\n0.\tQuit\n\n");
    printf("Make your selection: \n");

   while( (scanf(" %d", &option) != 1) /* non-numeric input */
          || (option < 0)               /* number too small */
          || (option > 5))              /* number too large */
   {
      fflush(stdin);                    /* clear bad data from buffer */
      printf("That selection isn't valid. Please try again.\n\n");
      printf("Your choice? ");
   }

    printf("Selecting %d\n\n", option);

    return option;
}

int input(char * user_filename)
{
    printf("Enter the filename of the file to encode:\n");
    printf("(hit the Enter key when done)\n");
    scanf("%s", user_filename);
    printf("Getting %s\n\n", user_filename);

    fp = fopen (user_filename, "r");

    if (fp == NULL)
    {
        printf("\nSorry, I'm unable to open the file (%s) for reading\n", user_filename);
        printf("Please try again.\n");
    }

    else
    {
        fclose(fp);
    }

    return INPUT_FILE;
}

int output()
{
    printf("Enter the filename of the output file to store encoded information:\n");
    printf("(hit the Enter key when done)\n");
    scanf("%s", user_filename2);
    printf("Opening File for Writing %s\n\n", user_filename2);

    fp2 = fopen (user_filename2, "w");

    if (fp2 == NULL)
    {
        printf("\nSorry, I'm unable to open the file (%s) for writing\n", user_filename2);
        printf("Please try again.\n");
    } else
    {
        fclose(fp2);
    }

    //return user_filename;
    return INPUT_FILE;
}

int shift(int num_shift)
{
    printf("Enter the number of letters to shift for each character: \n");
    printf("(hit the Enter key when done)\n");
    scanf("%d", &num_shift);
    printf("Setting shift value to: %d\n\n", num_shift);

    return num_shift;
}

int encode(char result, char ch, int offset, char character2)
{

    int character;

    printf("starting encoding with offset of %d\n", offset);

    fp = fopen(user_filename, "r");
    fp2 = fopen(user_filename2, "w+bc");

    if ((fp == NULL) || (fp2 == NULL))
    {
        printf ("File not found\n");
        return (0);
    }

    fseek(fp, 0, SEEK_SET);

    printf("staring Encoding from %s to %s at position %ld\n", user_filename, user_filename2, ftell(fp));

    int i = 0;
    while(character = fgetc(fp))
    {
        if ( character == EOF)
        {
            //printf("%c",character);
            //fprintf(fp2,"%c",result);
            fclose(fp);
            fflush(fp2);
            fclose(fp2);
            return(0);
        }

        if (isalpha (character))
        {
            if (character >= 'a' && character <= 'z')
            {
                result = character - 'a';
                result = (result + offset) % 26; // 26 letters in the alphabet
                result += 'a';
                if (result < 'a')
                {
                    result = 'z' - ('a' - result)+1;
                }

            } else if (character >= 'A' && character <= 'Z')
            {
                result = character - 'A';
                result = (result + offset) % 26; // 26 letters in the alphabet
                result += 'A';
                if (result < 'A')
                {
                    result = 'Z' - ('A' - result)+1;
                }
            }
            //printf("(%c)",result);
        } else
        {
            result = character;
            //printf("(%x)", result);
        }
        printf("%c",result);
        fprintf(fp2,"%c",result);

    }

    return 0;
}

void quit()
{
    //fclose(fp);
    //fclose(fp2);
    printf("Quiting...Bye!");
    printf("\n");
    exit(0);
}

int review(char * user_filename)
{
    char character;

    fp = fopen(user_filename, "r");

    printf("Showing text from %s file\n", user_filename);
    printf("----------BEGIN OF TEXT--------------\n");
    while(character = fgetc(fp))
    {
        if ( character == EOF)
        {
            printf("%c",character);
            printf("\n----------END OF TEXT--------------\n");
            fclose(fp);
            return(0);
        }
        printf("%c",character);
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T00:18:08.230

您不需要将它们作为参数传递，您可以从任何地方访问它们（因此是全局的，只要您可以看到变量）。

对这些变量所做的任何修改对每个人都是可见的（除了多线程问题），因此您在函数和 main 中使用它们也没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T00:56:53.983

您不需要传递全局变量，因为全局变量具有全局[范围](http://en.wikipedia.org/wiki/Scope_%28computer_science%29)，即可以在任何地方访问它们。这是**非常糟糕**的编程实践，因为当您决定将相同的名称用于其他目的时，它可能会在程序后期引入副作用。

有关详细信息，请参阅[维基百科](http://en.wikipedia.org/wiki/Global_variable)。

# c# - 在c#中将通知声音文件添加到exe

> ID：11997210
> 
> 赞同：2
> 
> 时间：2012-08-17T00:15:56.920
> 
> 标签：c#, embedded-resource, resource-files

我正在尝试在用户按下按钮时添加通知警报

```
 private void button1_Click(object sender, EventArgs e)
    {
        SoundPlayer simpleSound = new SoundPlayer(@"C:\Users\.........\ambbrdg7.wav");
        simpleSound.Play();
    } 
```

我想将**ambbrdg7.wav**添加到我的 exe 文件中，以确保我的程序始终可以访问该文件

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-17T00:36:38.200

项目 + 属性，资源选项卡，单击“添加资源”按钮上的箭头并选择您的 .wav 文件。那么它很简单：

```
var player = new System.Media.SoundPlayer();
player.Stream = Properties.Resources.tada;
player.Play(); 
```

其中“tada.wav”是我添加的资源，将其更改为您的资源名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T00:17:55.673

您要么想将文件添加为内容（将文件添加到项目中并将其设置为构建操作 - > 内容），要么将其添加为资源 - 请参阅[http://msdn.microsoft.com/en-us/library/ 7k989cfy(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/7k989cfy(v=vs.80).aspx)

# java - 使用谷歌应用引擎时显示迭代错误

> ID：11997211
> 
> 赞同：3
> 
> 时间：2012-08-17T00:15:58.443
> 
> 标签：java, google-app-engine

我遇到了以下问题：我试图从用户的手机中获取 x [英里/公里] 内的用户。我正在使用谷歌应用引擎的数据存储 api，我不知道是什么问题。问题是，当我使用迭代获取记录时——出现一个错误，告诉我我不能在组合过滤器中使用不同的属性。

```
 package com.linkedlive.business;

    import java.io.IOException;
    import java.util.Iterator;

    import javax.servlet.http.*;

    import org.json.JSONArray;
    import org.json.JSONObject;

    import com.biomedica.server.geolocation.GeoLocation;
    import com.biomedica.server.searchtools.SearchForGeolocEntitiy;
    import com.google.appengine.api.datastore.DatastoreService;
    import com.google.appengine.api.datastore.DatastoreServiceFactory;
    import com.google.appengine.api.datastore.Entity;
    import com.google.appengine.api.datastore.KeyFactory;

    @SuppressWarnings("serial")
    public class Venue extends HttpServlet {

    public void doGet(HttpServletRequest req, HttpServletResponse resp)
            throws IOException {
        this.doPost(req, resp);

    }

    public void doPost(HttpServletRequest req, HttpServletResponse resp)
            throws IOException {

        DatastoreService datastore =
      DatastoreServiceFactory.getDatastoreService();

        String cmd=req.getParameter("cmd");
        if(cmd.equals("venuenearby"))
        {
            GeoLocation geo=new GeoLocation();
            SearchForGeolocEntitiy search=new
    SearchForGeolocEntitiy("accounts");// this is a class that i created to set the
    query filters see bellow
            // get request parameters
            float lat=Float.valueOf(req.getParameter("lat"));
            float lng=Float.valueOf(req.getParameter("lng"));
            float rad=Float.valueOf(req.getParameter("rad"));
            // calculate the distance

            Iterable<Entity>
    ent=search.GetJSONForEntitiyNearByUsingBounds(lat,
    lng,geo.getGeoLocationBounds(lat, lng, rad) );
            Iterator<Entity> i=ent.iterator();
            JSONObject json=new JSONObject();
            JSONArray injson=new JSONArray();
            json.put("result", "venuenearby");

            while(i.hasNext())
            {
                try {
                    JSONObject j=new JSONObject();
                    Entity t=i.next();
                    j.put("key",
    KeyFactory.keyToString(t.getKey()));
                    j.put("userid",
    t.getProperty("userid"));
                    j.put("filepath",
    t.getProperty("filepath"));
                    injson.put(j);
                } catch (NullPointerException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

            }
            json.put("body",injson);
            resp.getWriter().write(json.toString());
        }

    }
    }

///////////////////////////////////////////////////////////////////////////////
////////////////////
//////////////////////////  SearchForGeolocEntitiy      
////////////////////////////////////

    package com.biomedica.server.searchtools;

    import java.lang.reflect.Array;
    import java.util.Arrays;

    import com.biomedica.server.geolocation.GeoLocation;
    import com.google.appengine.api.datastore.DatastoreService;
    import com.google.appengine.api.datastore.DatastoreServiceFactory;
    import com.google.appengine.api.datastore.Entity;
    import com.google.appengine.api.datastore.PreparedQuery;
    import com.google.appengine.api.datastore.Query;
    import com.google.appengine.api.datastore.Query.CompositeFilterOperator;
    import com.google.appengine.api.datastore.Query.Filter;
    import com.google.appengine.api.datastore.Query.FilterOperator;
    import com.google.appengine.api.datastore.Query.FilterPredicate;
    import com.google.appengine.api.datastore.Query.CompositeFilter;

     public class SearchForGeolocEntitiy {
     private String EntitiyName;
     private Query q;

     public SearchForGeolocEntitiy(String name)
    {
        EntitiyName=name;
        q=new Query(name);

    }
    public Iterable<Entity> GetJSONForEntitiyNearBy(double lang,double
    lat,double rad,int max_result)
    {
        DatastoreService datastore =
    DatastoreServiceFactory.getDatastoreService();
        // decleeraing filter object

                Filter filter_min_lngt=new
    FilterPredicate("lng", FilterOperator.GREATER_THAN, lang-rad);
                Filter filter_max_lngt=new
    FilterPredicate("lng", FilterOperator.LESS_THAN, lang+rad);
                Filter filter_min_lat=new
    FilterPredicate("lat", FilterOperator.GREATER_THAN, lat-rad);
                Filter filter_max_lat=new
    FilterPredicate("lat", FilterOperator.LESS_THAN, lat+rad);

                Filter filter_lng=new
    CompositeFilter(CompositeFilterOperator.AND,Arrays.asList(filter_min_lngt,filte
    r_max_lngt));
                Filter filter_lat=new
    CompositeFilter(CompositeFilterOperator.AND,Arrays.asList(filter_min_lat,filter
    _max_lat));

                Filter filter=new
    CompositeFilter(CompositeFilterOperator.AND,Arrays.asList(filter_lng,filter_lat
     ));

                q.setFilter(filter);
                PreparedQuery pq = datastore.prepare(q);

                return pq.asIterable();

    }
    public Iterable<Entity> GetJSONForEntitiyNearByUsingSSID(String
    EntityName,String entityID,String SSID)
    {
        DatastoreService datastore =
    DatastoreServiceFactory.getDatastoreService();
        // decleeraing filter object

            Filter filter_entityID=new FilterPredicate(EntityName,
    FilterOperator.EQUAL, entityID);

                Filter filter_min_lngt=new
    FilterPredicate("lng", FilterOperator.EQUAL, SSID);

                Filter filter=new
    CompositeFilter(CompositeFilterOperator.AND,Arrays.asList(filter_entityID,filte
    r_min_lngt));

                q.setFilter(filter);

                PreparedQuery pq = datastore.prepare(q);
                return pq.asIterable();

    }
    public Iterable<Entity> GetJSONForEntitiyNearByUsingBounds(float
    lng,float lat,GeoLocation.GeoLocationBoundry bound)
    {
        DatastoreService datastore =
    DatastoreServiceFactory.getDatastoreService();

        Filter filter_min_lngt=new FilterPredicate("lng",
    FilterOperator.LESS_THAN, bound.lng1);
        Filter filter_max_lngt=new FilterPredicate("lng",
    FilterOperator.LESS_THAN, bound.lng2);
        Filter filter_min_lat=new FilterPredicate("lat",
    FilterOperator.GREATER_THAN, bound.lat1);
        Filter filter_max_lat=new FilterPredicate("lat",
    FilterOperator.LESS_THAN, bound.lat2);

        Filter filter_lng=new
    CompositeFilter(CompositeFilterOperator.AND,Arrays.asList(filter_min_lngt,filte
    r_max_lngt));
        Filter filter_lat=new
    CompositeFilter(CompositeFilterOperator.AND,Arrays.asList(filter_min_lat,filter
    _max_lat));

        Filter filter=new
    CompositeFilter(CompositeFilterOperator.AND,Arrays.asList(filter_lng,filter_lat
    ));

        q.setFilter(filter);

        PreparedQuery pq = datastore.prepare(q);

        return pq.asIterable();
    }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T01:48:53.160

您遇到了数据存储的限制。不等式过滤器只能在一个属性上。

[https://developers.google.com/appengine/docs/java/datastore/queries#Restrictions_on_Queries](https://developers.google.com/appengine/docs/java/datastore/queries#Restrictions_on_Queries)

解决此问题的最简单方法是使用 Search API。否则，您需要构建自己的类似地理散列的机制来在不使用多个不等式过滤器的情况下在一个范围内进行搜索。

# javascript - 追加/前置到容器

> ID：11997214
> 
> 赞同：3
> 
> 时间：2012-08-17T00:16:33.133
> 
> 标签：javascript, jquery, html, append, prepend

我有以下 HTML 代码：

```
<div class="container">
    <div><div>...</div><a class="child" href="#">Example</a></div>..</div></div>
</div>
<div class="container">
    <div><div>...</div><a class="child" href="#">Example</a></div>..</div></div>
</div>
.
.
.
<div class="container">
    <div><div>...</div><a class="child" href="#">Example</a></div>..</div></div>
</div> 
```

我有以下 JavaScript 脚本：

```
$('a.child').prependTo('div.container'); 
```

但是这段代码并没有将每个`a`元素都添加到它们自己的容器中，而是将*所有* `a`元素添加到*每个*容器中。我怎样才能解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T00:19:18.157

遍历每个`a.child`，并将其添加到前面。

```
$('a.child').each(function ()
{
    var $this = $(this);
    $this.prependTo($this.closest('div.container'));
}); 
```

[http://jsfiddle.net/mattball/tRNUS](http://jsfiddle.net/mattball/tRNUS)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T00:19:38.927

你可以试试这个`each`方法：

```
$('a.child').each(function(){
  $(this).prependTo($(this).closest('.container'));
}) 
```

[小提琴](http://jsfiddle.net/X674N/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T00:20:37.397

`div.container`并`a.child`充当单独的选择器。他们没有关系。

您必须遍历`a.child`元素并选择父元素：

```
$('a.child').each(function() {
  var $this = $(this);

  $this.parents('div.container').prepend($this);
}); 
```

# php - 改进登录系统

> ID：11997218
> 
> 赞同：0
> 
> 时间：2012-08-17T00:16:47.737
> 
> 标签：php, logging, login, acl

我有四种不同类型的用户登录到我的网站，例如`admin`、`superadmin`、`company`和`employees`。他们每个人都有不同的页面集可供查看，但也有一些常见的页面。现在我有四个不同的表来管理它们，它们具有相同的登录屏幕`admin`和`superadmin`. 当任何一个`admin`或`superadmin`登录时，我将在授予访问权限之前一一检查两个表。我有一个单独的登录屏幕`company`和`employees`. 这是公认的做法吗？

实际上，我希望将其更改为包含所有用户的单个表和一个角色表以区分角色。我相信四张桌子的概念真的很糟糕。我不能简单地把它放在一张桌子上，因为以前的开发人员习惯于将用户评论和用户活动保存在网站上使用的文本文件中。

我是否正确地认为四表登录系统不好？将日志存储在直接在网站中使用的文本文件中是否是一个好主意？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T00:19:58.217

你有4张桌子？只需使用一个用户表和一个可以是“admin”、“superadmin”、“company”或“employees”的字段。然后，您可以拥有无​​限类型的帐户。（我会使用 1、2、3 或 4 之类的数字代码，而不是字符串代码或[ENUM](http://dev.mysql.com/doc/refman/5.0/en/enum.html)类型字段）。

但是，是的，你的单桌想法很好。如果您想要一个角色表，请对您的角色字段执行外键并将其链接到您的角色表。您也可以有一个登录，而不是为不同的用户使用不同的登录，并根据该外键值检查权限。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-17T00:40:50.717

这是我的建议，

与其为您的用户使用四个表，不如使用*一个*。

您可以像这样创建基本用户表（将排名更改为适合您的站点/脚本）：

```
ID username password email bla bla bla rank 
```

因此，您可以让 PHP 脚本检查用户是否具有所需的访问级别，而不是使用四个表。

这是一个保护页面免受访问级别较低的用户访问的简单功能：

```
function required_level($level){
    $user_level = mysql_return(mysql_query("SELECT $rank FROM `Accounts` WHERE `user_id` =  $user_id"));
    if($user_level<$level){
        header("Location:index.php");
    }
} 
```

然后在每个页面上，您要防止较低级别的用户访问它。您只需拨打电话`required_level(4);`，该页面将只允许具有此级别或更高级别的用户访问该页面。

例子：

*   Bob 是一名员工，因此他的用户等级为 1，
*   Joe 是超级管理员，因此他的用户等级为 4

两个用户都正常登录，并且都尝试访问`admin.php`.

admin.php 以 required_level(4) 开头；所以 Bob 将被重定向到主页（您也可以传递一个错误）但是，Joe 将无法访问此页面，因为他的排名与访问此页面所需的排名相同或更高。

So, here's my super long explanation on what you can do! I hope this helps and gives you some ideas on how to make your user tables better and easier to create protect pages :)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-17T00:26:26.510

首先，你可以用一张桌子做所有的事情。在该表中，您应该具有用户名、密码、用户类型和其他必要信息等字段。

检索用户信息，例如：

```
$username = $_POST['username'];  //Retrieving a username from HTML login form
$row = mysql_query(sprintf("SELECT * FROM table WHERE username ='%s'", mysql_real_escape_string($username)));  //Retrieving a row from the database
$res = mysql_fetch_array($row);
$type = $row['typeofuser']; //Retrieving whether it is administrator, super administrator, user, etc.
if ($type == "admin")
    header(Loction:adminpge); 
```

同样，您可以检查任何类型的用户并可以重定向到另一个页面。

# iphone - iPhone：无法启动简单的应用程序

> ID：11997220
> 
> 赞同：0
> 
> 时间：2012-08-17T00:17:23.573
> 
> 标签：iphone

我正在尝试在这里制作一个 iPhone 应用程序，但我已经把它归结为一个简单的 HelloWorld 问题。出于某种原因，以下内容在 XCode 4.4 中不起作用。我真的很感激弄清楚发生了什么。

我遵循以下步骤：

1.  启动“空项目”类型
2.  给它命名
3.  添加一个带有 .xib 的新objective-c 类。假设这个新的视图控制器是 StartViewController，所以我现在有了 StartViewController .xib、.h 和 .m。
4.  检查： .xib 的文件所有者与 .h 文件匹配。在 IB 中确实如此。
5.  将 .xib 的背景更改为黑色以外的其他颜色（我喜欢条纹）。
6.  将这些行添加到主应用程序委托中：

# 导入“StartViewController.h”

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
 {
   self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
   StartViewController* theController = [[StartViewController alloc]init];
   [self.window addSubview:theController.view];
   [self.window makeKeyAndVisible];
   return YES;
 } 
```

该应用程序在运行时立即崩溃：

***由于未捕获的异常而终止应用程序'`NSInternalInconsistencyException', reason: '-[UIViewController _loadViewFromNibNamed:bundle:]`加载了“StartView”笔尖，但未设置视图出口。'

我怎样才能让它工作？

**编辑**： PS，我不知道为什么代码格式化似乎失败了。我的印象是一行的开头只有四个空格......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T00:40:05.080

我回答这个是因为它太可笑了。

事实证明，顺序很重要。

我删除了旧的控制文件，然后添加了'startingviewcontroller'，将appdelegate函数编辑为startingviewcontroller，然后一切正常。不知道为什么这很重要，但是嘿。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T00:28:56.597

做错误告诉你做的事情。在您的 VC 中为 Startview 设置一个出口。

# android - 地图加载和写入，我应该使用哪个 Reader/Writer？

> ID：11997222
> 
> 赞同：1
> 
> 时间：2012-08-17T00:17:56.203
> 
> 标签：android, file, maps

我正在为一个学校项目做我的第一个游戏。在谈论 Android 编程时，我并不陌生，但我不确定加载游戏地图时需要使用哪个`reader`和（BufferedReader、Scanner、DataInputStrem）。 另外，我应该制作一个写地图的程序吗？还是只写在记事本上？`writer`

编辑：这个游戏是一个boxman，如果有人对此感兴趣[，](http://code.google.com/p/move-the-garbage/)那就是它的网站。请不要吃我...

# svn - 如何在 SVN 设置上自动进行 php 代码验证？

> ID：11997230
> 
> 赞同：0
> 
> 时间：2012-08-17T00:18:33.663
> 
> 标签：svn, tortoisesvn

当我在我们的 SVN 存储库上提交它时，我的代码在哪里被拒绝，因为那里 SVN 存储库被配置为首先验证 php 代码并在 Tortoise GUI 上给你行错误，因为它不能是原因坚定的。

那么任何人都可以帮助我如何设置SVN吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:23:33.937

我不确定细节，但通常它是使用**hooks**完成的，它可以是服务器端或客户端。以下链接可帮助您找到所需内容：

*   [http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-settings.html](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-settings.html)
*   [http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-repository-hooks.html](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-repository-hooks.html)

# json - 三.js JSONLoader 回调

> ID：11997234
> 
> 赞同：5
> 
> 时间：2012-08-17T00:18:58.463
> 
> 标签：json, callback, geometry, three.js, loader

在 THREE.js 中，如果我多次调用 JSONLoader 来加载多个像这样的对象（简化示例）：

```
function init() {    
  var loader = new THREE.JSONLoader();    
  loader.load("mesh1.js", createScene);    
  loader.load("mesh2.js", createScene);
}    

function createScene( geometry ) {    
  if (geometry.filename == "mesh1.js") {    
    mesh1 = new THREE.Mesh( geometry, material );
    scene.add( mesh1 );    
  } else if (geometry.filename == "mesh2.js") {    
    mesh2 = new THREE.Mesh( geometry, material );
    scene.add( mesh2 );
  }
} 
```

如何确定回调时返回了哪个网格，尤其是当它们经常乱序到达时？

我正在尝试使用单个通用回调函数处理多个返回的网格。返回的几何图形中是否有一些属性指示我可以测试的原始文件名？

或者也许有更优雅的方式？也许为每个调用创建一个新的 THREE.JSONLoader 对象将有助于回调函数确定哪个网格已经到达？

我感谢任何帮助/想法！谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T09:19:49.107

好吧，有一种比 WestLangley 提出的更通用的方法。

```
loader.load( "mesh1.js", meshloader("mesh1.js")); 
loader.load( "mesh2.js", meshloader("mesh2.js")); 
```

然后

```
function meshloader(fileName){
    return function(geometry){
        ...
    }
} 
```

这样，您可以在每个加载的文件上添加一个标识符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T01:08:04.537

这样的事情怎么样？

```
loader.load( "mesh1.js", function( geometry ) { createScene( geometry, 1 ) } ); 
loader.load( "mesh2.js", function( geometry ) { createScene( geometry, 2 ) } ); 
```

然后，

```
function createScene( geometry, id ) {
 ...
} 
```

如果您愿意，`id`可以是网格名称。

# jquery - Firefox Addon SDK 中内容脚本中的 JQuery UI

> ID：11997241
> 
> 赞同：2
> 
> 时间：2012-08-17T00:19:49.077
> 
> 标签：jquery, jquery-ui, firefox-addon, firefox-addon-sdk

我正在使用 Addon Builder 开发一个 Firefox 插件。我在我的插件面板中使用 JQuery UI，并且还想从绑定到面板的内容脚本中使用它。在面板页面中一切正常。在内容脚本中，JQuery 似乎可以工作，但我看不到 JQuery UI 调用的任何影响，例如下面的滑块案例。

这是定义面板的**main.js的一部分：**

```
var panel = require("panel").Panel({
    width: 350,
    height: 400,
    contentURL: require("self").data.url("panel.html"),
    contentStyleFile: data.url("css/jquery-ui-1.8.22.custom.css"),
    contentScriptFile: [
        data.url("js/jquery-1.8.0.js"),
        data.url("js/jquery-ui-1.8.22.custom.min.js"),
        data.url("panel.js")
        ]
}); 
```

这是触发自定义事件的调用：

```
panel.port.emit("loadingDataEvent", t ); 
```

在**panel.js**中，以下部分尝试使用 JQuery 和 JQuery UI。JQuery 调用已成功完成，但是尝试更新滑块对象的 JQuery UI 调用对任何内容都没有任何影响：

```
self.port.on("loadingDataEvent", function (t) {
    $("#load-counter").html("<br />Not enough data yet. Approx. " + t + " secs. to go...");
    $( "#progressbar" ).progressbar( "option", "value", (60-t)/60*100 );
    document.defaultView.postMessage('{}', '*');
}); 
```

在我的**panel.html 中**，我可以通过以传统方式包含 JQuery 和 JQueryUI 来毫无问题地使用它们：

```
<link type="text/css" href="css/jquery-ui-1.8.22.custom.css" rel="Stylesheet" />    
<script type="text/javascript" src="js/jquery-1.8.0.js"></script>
<script type="text/javascript" src="js/jquery-ui-1.8.22.custom.min.js"></script>
 ...
<script>
  $(function() {
    $( "#tabs" ).tabs();
    ....
  });
</script> 
```

关于我可能在哪里犯错的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T00:52:16.613

找到答案的时间比我预期的要短得多。我的错误是在 html 文件中的脚本标记内使用 JQuery，例如声明滑块，因此内容脚本无法访问这些对象。将所有脚本分离到不同的文件并将其添加到内容脚本将使用的脚本文件列表中，解决了问题：

```
var panel = require("panel").Panel({
    width: 350,
    height: 400,
    contentURL: require("self").data.url("panel.html"),
    contentStyleFile: data.url("css/jquery-ui-1.8.22.custom.css"),
    contentScriptFile: [
        data.url("js/jquery-1.8.0.js"),
        data.url("js/jquery-ui-1.8.22.custom.min.js"),
        data.url("panelpage.js"), // <------ this is the new file
        data.url("panel.js")
        ]
}); 
```

编辑：

在我写了这个之后，我还发现了以下内容：一旦将 data.url("panelpage.js") 传递到 contentScriptFile 中，需要从包含它的 HTML 文件中删除对脚本文件的相应引用脚本标签之间，否则似乎会导致一些冲突。

# ruby-on-rails - 使用 Active Relation 改进 Thinking Sphinx 搜索浮动字段

> ID：11997244
> 
> 赞同：0
> 
> 时间：2012-08-17T00:20:03.473
> 
> 标签：ruby-on-rails, activerecord, thinking-sphinx, active-relation

我有产品数据库，我使用[Thinking Sphinx](http://freelancing-god.github.com/ts/en/)搜索它们。我有一组非常复杂的条件来在正确的类别和详细信息中找到正确的产品。但是，我想优化搜索，以便我可以对产品的价格和数量进行限制，它们都是 Product 模型的浮动属性。

例如：

```
1.9.2p290 :014 > Product.search('eggs').map { |p| "#{p.name}, $#{p.price}" }
  Sphinx Query (4.6ms)  eggs
  Sphinx  Found 984 results
  Product Load (0.9ms)  SELECT "products".* FROM "products" WHERE "products"."id" IN (7635, 7636, 7637, 7638, 7639, 7640, 7641, 7642, 7643, 7644, 7645, 7646, 7647, 7648, 7650, 7651, 7652, 7653, 7654, 7655)
[
    [ 0] "Egg Beaters Pour Spout, $2.89",
    [ 1] "Fleischman Regular Egg Beaters Egg Substitute, $3.09",
    [ 2] "Fleischman Southwest Egg Beaters Egg Substitute, $2.89",
    [ 3] "Lucerne Best Of The Egg, $2.79",
    [ 4] "Lucerne Best Of The Egg, $2.69",
    [ 5] "Lucerne Best Of The Egg, $5.29",
    [ 6] "Lucerne Best Of The Egg Whites, $2.79",
    [ 7] "Lucerne Best Of The Egg Whites, $5.29",
    [ 8] "Papetti Foods All Whites Liquid Egg Whites, $5.89",
    [ 9] "Papetti Foods Healthier Real Egg Product Better N Eggs, $5.89",
    [10] "Papettis 100% All Egg Whites, $2.5",
    [11] "Eating Right Eggs With Omega A, $3.99",
    [12] "Egglands Best Cage Free Large Eggs, $3.29",
    [13] "Egglands Best Cage Free Large Grade AA Brown Eggs, $4.39",
    [14] "Egglands Best Classic Large Eggs, $5.49",
    [15] "Egglands Best Grade AA Large Eggs, $4.09",
    [16] "Hard Boiled Eggs Peeled And Ready To Eat, $1.49",
    [17] "Land O Lakes Cage Free All Natural Large Grade A Brown Eggs, $4.39",
    [18] "Land O Lakes Farm Fresh Extra Large Brown Eggs, $2.49",
    [19] "Land O Lakes Organic All Natural Large Grade A Brown Eggs, $5.49"
]

1.9.2p290 :015 > Product.search('eggs').class
ThinkingSphinx::Search < Array

1.9.2p290 :016 > Product.search('eggs').where("price < ?", 3)
NoMethodError:   Sphinx Query (5.5ms)  eggs
  Sphinx  Found 984 results
  Product Load (0.8ms)  SELECT "products".* FROM "products" WHERE "products"."id" IN (7635, 7636, 7637, 7638, 7639, 7640, 7641, 7642, 7643, 7644, 7645, 7646, 7647, 7648, 7650, 7651, 7652, 7653, 7654, 7655)
undefined method `where' for #<ThinkingSphinx::Search:0x007feaf30e1880>
  from /Users/neil/.rvm/gems/ruby-1.9.2-p290/gems/thinking-sphinx-2.0.10/lib/thinking_sphinx/search.rb:174:in `method_missing'
  from (irb):16
  from /Users/neil/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.5/lib/rails/commands/console.rb:47:in `start'
  from /Users/neil/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.5/lib/rails/commands/console.rb:8:in `start'
  from /Users/neil/.rvm/gems/ruby-1.9.2-p290/gems/railties-3.2.5/lib/rails/commands.rb:41:in `<top (required)>'
  from script/rails:6:in `require'
  from script/rails:6:in `<main>' 
```

如何在 TS find 的匹配文本之后使用 ActiveRelation 来优化我的搜索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T09:06:16.213

这应该有效：

```
Product.search 'eggs', :with => {:price => price, :quantity => quantity} 
```

假设您有三个不同的输入框来定义搜索字符串 ( `'eggs'`)、the`price`和 the `quantity`，我会在尝试搜索完全匹配时使用类似这样的内容：

```
scope = params[:query].present? Product.search params[:query] : scope = Product.search nil

scope = scope.search with: { :price => params[:price] } if params[:price].present?
scope = scope.search with: { :price => params[:quantity] } if params[:quantity].present?

@products = scope 
```

但这不会过滤“低于 x 的价格”或“x 和 y 之间的数量”。为此，您需要使用范围，因为thinking-sphinx。例如，如果您要搜索价格低于给定值的产品：

```
Product.search 'eggs', :with => {:price => 0..value} 
```

这将返回与查询匹配`'eggs'`且价格介于 0 和给定值之间的产品。

如果要搜索价格高于给定值的产品：

```
Product.search 'eggs', :with => {:price => value..Float::MAX} 
```

这将返回与查询匹配的产品`'eggs'`，其价格在给定值和最大可表示有限浮点数之间。

# ruby-on-rails-3 - 将 Ckeditor 值绑定到 AngularJS 和 Rails 中的模型文本

> ID：11997246
> 
> 赞同：33
> 
> 时间：2012-08-17T00:20:11.053
> 
> 标签：ruby-on-rails-3, angularjs

我想将 CKEditor 文本绑定到`ng-model`文本。我的观点：

```
 <form name="postForm" method="POST" ng-submit="submit()" csrf-tokenized class="form-horizontal">

    <fieldset>
    <legend>Post to: </legend>
    <div class="control-group">
      <label class="control-label">Text input</label>
      <div class="controls">
        <div class="textarea-wrapper">
          <textarea id="ck_editor" name="text" ng-model="text" class="fullwidth"></textarea>
        </div>
        <p class="help-block">Supporting help text</p>
      </div>
    </div>

    <div class="form-actions">
      <button type="submit" class="btn btn-primary">Post</button>
      <button class="btn">Cancel</button>
      <button class="btn" onclick="alert(ckglobal.getDate())">Cancel123</button>
    </div>
  </fieldset>
</form> 
```

控制器

```
 function PostFormCtrl($scope, $element, $attrs, $transclude, $http, $rootScope) {
      $scope.form = $element.find("form");
      $scope.text = "";

      $scope.submit = function() {
          $http.post($scope.url, $scope.form.toJSON()).
          success(function(data, status, headers, config) {
                  $rootScope.$broadcast("newpost");
                  $scope.form[0].reset();
              });
      };

      $scope.alert1 = function(msg) {
          var sval = $element.find("ckglobal");
          //$('.jquery_ckeditor').ckeditor(ckeditor);                                                                                                                      
          alert(sval);
      };
    }
    PostFormCtrl.$inject = ["$scope", "$element", "$attrs", "$transclude", "$http", "$rootScope"]; 
```

我想在`$scope.text`表单提交时设置 CKEditor 值。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-08-18T19:29:19.793

CKEditor 在输入时不会更新 textarea，所以你需要注意它。

**这是一个使 ng-model 绑定与 CK 一起工作的指令：**

```
angular.module('ck', []).directive('ckEditor', function() {
  return {
    require: '?ngModel',
    link: function(scope, elm, attr, ngModel) {
      var ck = CKEDITOR.replace(elm[0]);

      if (!ngModel) return;

      ck.on('pasteState', function() {
        scope.$apply(function() {
          ngModel.$setViewValue(ck.getData());
        });
      });

      ngModel.$render = function(value) {
        ck.setData(ngModel.$viewValue);
      };
    }
  };
}); 
```

在 html 中，只需使用：

```
<textarea ck-editor ng-model="value"></textarea> 
```

* * *

前面的代码将在每次更改时更新 ng-model。

**如果您只想在保存时更新绑定，请覆盖“保存”插件，除了触发“保存”事件之外什么都不做。**

```
// modified ckeditor/plugins/save/plugin.js
CKEDITOR.plugins.registered['save'] = {
  init: function(editor) {
    var command = editor.addCommand('save', {
      modes: {wysiwyg: 1, source: 1},
      readOnly: 1,
      exec: function(editor) {
        editor.fire('save');
      }
    });

    editor.ui.addButton('Save', {
      label : editor.lang.save,
      command : 'save'
    });
  }
}; 
```

然后，在指令中使用这个事件：

```
angular.module('ck', []).directive('ckEditor', function() {
  return {
    require: '?ngModel',
    link: function(scope, elm, attr, ngModel) {
      var ck = CKEDITOR.replace(elm[0]);

      if (!ngModel) return;

      ck.on('save', function() {
        scope.$apply(function() {
          ngModel.$setViewValue(ck.getData());
        });
      });
    }
  };
}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-01-09T00:54:33.623

如果您只是想以角度检索编辑器文本区域中的文本，请调用`CKEDITOR.instances.editor1.getData();`以直​​接在 angularjs 函数中获取值。见下文。

在你的 html

在 test.controller.js

```
(function () {
    'use strict';

    angular
        .module('app')
            .controller('test', test);

    test.$inject = []; 

    function test() {

        //this is to replace $scope
        var vm = this;

        //function definition
        function postJob()
        {          
            vm.Description = CKEDITOR.instances.editor1.getData();
            alert(vm.Description);
        }
    } 
})(); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-09-01T02:47:53.250

Vojta回答部分工作

在这篇文章中，我找到了解决方案

[https://stackoverflow.com/a/18236359/1058096](https://stackoverflow.com/a/18236359/1058096)

最终代码：

```
.directive('ckEditor', function() {
                return {
                    require : '?ngModel',
                    link : function($scope, elm, attr, ngModel) {

                        var ck = CKEDITOR.replace(elm[0]);

                        ck.on('instanceReady', function() {
                            ck.setData(ngModel.$viewValue);
                        });

                        ck.on('pasteState', function() {
                            $scope.$apply(function() {
                                ngModel.$setViewValue(ck.getData());
                            });
                        });

                        ngModel.$render = function(value) {
                            ck.setData(ngModel.$modelValue);
                        };
                    }
                };
            }) 
```

编辑：删除未使用的括号

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-28T06:27:49.713

感谢 Vojta 的出色指导。有时它不加载。这是修复该问题的修改版本。

```
angular.module('ck', []).directive('ckEditor', function() {
  var calledEarly, loaded;
  loaded = false;
  calledEarly = false;

  return {
    require: '?ngModel',
    compile: function(element, attributes, transclude) {
      var loadIt, local;

      local = this;
      loadIt = function() {
        return calledEarly = true;
      };

      element.ready(function() {
        return loadIt();
      });

      return {
        post: function($scope, element, attributes, controller) {
          if (calledEarly) {
            return local.link($scope, element, attributes, controller);
          }
          loadIt = (function($scope, element, attributes, controller) {
            return function() {
              local.link($scope, element, attributes, controller);
            };
          })($scope, element, attributes, controller);
        }
      };
    },

    link: function($scope, elm, attr, ngModel) {
      var ck;
      if (!ngModel) {
        return;
      }

      if (calledEarly && !loaded) {
        return loaded = true;
      }
      loaded = false;

      ck = CKEDITOR.replace(elm[0]);
      ck.on('pasteState', function() {
        $scope.$apply(function() {
          ngModel.$setViewValue(ck.getData());
        });
      });

      ngModel.$render = function(value) {
        ck.setData(ngModel.$viewValue);
      };
    }
  };
}); 
```

或者如果你在咖啡脚本中需要它

```
angular.module('ck', []).directive('ckEditor', ->
  loaded = false
  calledEarly = false
  {
    require: '?ngModel',
    compile: (element, attributes, transclude) ->
      local = @
      loadIt = ->
        calledEarly = true

      element.ready ->
        loadIt()
      post: ($scope, element, attributes, controller) ->
        return local.link $scope, element, attributes, controller if calledEarly

        loadIt = (($scope, element, attributes, controller) ->
          return ->
            local.link $scope, element, attributes, controller
        )($scope, element, attributes, controller)
    link: ($scope, elm, attr, ngModel) ->
      return unless ngModel

      if (calledEarly and not loaded)
        return loaded = true
      loaded = false

      ck = CKEDITOR.replace(elm[0])

      ck.on('pasteState', ->
        $scope.$apply( ->
          ngModel.$setViewValue(ck.getData())
        )
      )

      ngModel.$render = (value) ->
        ck.setData(ngModel.$viewValue)
  }
) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-05T22:45:46.670

如果您想在一个页面中使用多个编辑器，这只是为了记录，这可以派上用场：

```
mainApp.directive('ckEditor', function() {
    return {
        restrict: 'A', // only activate on element attribute
        scope: false,
        require: 'ngModel',
        controller: function($scope, $element, $attrs) {}, //open for now
        link: function($scope, element, attr, ngModel, ngModelCtrl) {
            if(!ngModel) return; // do nothing if no ng-model you might want to remove this
            element.bind('click', function(){
                for(var name in CKEDITOR.instances)
                    CKEDITOR.instances[name].destroy();
                var ck = CKEDITOR.replace(element[0]);
                ck.on('instanceReady', function() {
                    ck.setData(ngModel.$viewValue);
                });
                ck.on('pasteState', function() {
                    $scope.$apply(function() {
                        ngModel.$setViewValue(ck.getData());
                    });
                });
                ngModel.$render = function(value) {
                    ck.setData(ngModel.$viewValue);
                };
            });
        }
    }
}); 
```

这将销毁所有以前的 ckeditor 实例并创建一个新实例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-10-17T08:47:16.447

带有 CKEditor v5 的 ES6 示例。

注册指令使用：

```
 angular.module('ckeditor', []).directive('ckEditor', CkEditorDirective.create) 
```

指示：

```
import CkEditor from "@ckeditor/ckeditor5-build-classic";
export default class CkEditorDirective {

   constructor() {
     this.restrict = 'A';
     this.require = 'ngModel';
   }

  static create() {
    return new CkEditorDirective();
  }

  link(scope, elem, attr, ngModel) {
    CkEditor.create(elem[0]).then((editor) => {
      editor.document.on('changesDone', () => {
        scope.$apply(() => {
          ngModel.$setViewValue(editor.getData());
        });
      });

      ngModel.$render = () => {
        editor.setData(ngModel.$modelValue);
      };

      scope.$on('$destroy', () => {
        editor.destroy();
      });
    })
  }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-28T03:05:38.150

现在有一个“更改”事件可以用于此。

这是我刚刚创建的一个指令，它有几个不同的工具栏配置选项，我正在使用 jQuery 适配器来初始化 ckeditor。有关更多信息，请查看[此博客文章](http://jasonwatmore.com/post/2016/05/26/Angular-CKEditor-Directive-with-ngModel-Binding.aspx)。

```
(function () {
    'use strict';

    angular
        .module('app')
        .directive('wysiwyg', Directive);

    function Directive($rootScope) {
        return {
            require: 'ngModel',
            link: function (scope, element, attr, ngModel) {
                var editorOptions;
                if (attr.wysiwyg === 'minimal') {
                    // minimal editor
                    editorOptions = {
                        height: 100,
                        toolbar: [
                            { name: 'basic', items: ['Bold', 'Italic', 'Underline'] },
                            { name: 'links', items: ['Link', 'Unlink'] },
                            { name: 'tools', items: ['Maximize'] },
                            { name: 'document', items: ['Source'] },
                        ],
                        removePlugins: 'elementspath',
                        resize_enabled: false
                    };
                } else {
                    // regular editor
                    editorOptions = {
                        filebrowserImageUploadUrl: $rootScope.globals.apiUrl + '/files/uploadCk',
                        removeButtons: 'About,Form,Checkbox,Radio,TextField,Textarea,Select,Button,ImageButton,HiddenField,Save,CreateDiv,Language,BidiLtr,BidiRtl,Flash,Iframe,addFile,Styles',
                        extraPlugins: 'simpleuploads,imagesfromword'
                    };
                }

                // enable ckeditor
                var ckeditor = element.ckeditor(editorOptions);

                // update ngModel on change
                ckeditor.editor.on('change', function () {
                    ngModel.$setViewValue(this.getData());
                });
            }
        };
    }
})(); 
```

这是几个如何在 HTML 中使用指令的示例

```
<textarea ng-model="vm.article.Body" wysiwyg></textarea>
<textarea ng-model="vm.article.Body" wysiwyg="minimal"></textarea> 
```

这是我从 CDN 中包含的 CKEditor 脚本，以及我下载的几个额外插件，以启用从 word 中粘贴图像。

```
<script src="//cdn.ckeditor.com/4.5.7/full/ckeditor.js"></script>
<script src="//cdn.ckeditor.com/4.5.7/full/adapters/jquery.js"></script>
<script type="text/javascript">
    // load extra ckeditor plugins
    CKEDITOR.plugins.addExternal('simpleuploads', '/js/ckeditor/plugins/simpleuploads/plugin.js');
    CKEDITOR.plugins.addExternal('imagesfromword', '/js/ckeditor/plugins/imagesfromword/plugin.js');
</script> 
```

# php - 是否有提供来自 Google 等网站的 apple-touch-icon 的服务提供 favicon？

> ID：11997247
> 
> 赞同：3
> 
> 时间：2012-08-17T00:20:18.120
> 
> 标签：php, html, favicon, apple-touch-icon

多年来，我一直使用这个整洁的、未发布的 Google 服务从网站上检索网站图标。

```
http://www.google.com/s2/u/0/favicons?domain=stackoverflow.com 
```

这允许我在列出 URL 时为`<li>`标签等创建图标。我想知道苹果触摸图标是否存在变得越来越普遍的东西，尤其是在主要网站中。

如果不是，那么使用 PHP 检索它的最有效方法是什么？

以下是图标标签的一些示例：

```
<link rel="apple-touch-icon" href="apple-touch-iphone.png" />
<link rel="apple-touch-icon" sizes="72x72" href="apple-touch-ipad.png" />
<link rel="apple-touch-icon" sizes="114x114" href="apple-touch-iphone4.png" />
<link rel="apple-touch-icon" sizes="144x144" href="apple-touch-ipad-retina.png" /> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-24T22:57:30.803

大多数网站（不是全部，但大多数）都会在根目录中保存 apple-touch-iphone.png。

通过 PHP 解析 HTML 的一个更简单的替代方法是加载 domain.com/apple-touch-iphone.png

# php - 使用 Gmail 从 CakePHP 应用程序发送电子邮件

> ID：11997249
> 
> 赞同：0
> 
> 时间：2012-08-17T00:20:36.550
> 
> 标签：php, email, cakephp, gmail

我正在尝试让我正在开发的网站发送密码提醒电子邮件。我有使用我的 Gmail 帐户只是为了测试的想法。从蛋糕食谱中，我得到了这个代码：

```
$this->Email->from = 'support@site.com';
$this->Email->smtpOptions = array(
    'port'=>'465',
    'timeout'=>'30',
    'host' => 'ssl://smtp.gmail.com',
    'username'=>'notmyrealemail@gmail.com',
    'password'=>'notmyrealpassword');
$this->Email->delivery = 'smtp';
$this->Email->from = 'support@imgstore.in';
$this->Email->to = $this->request->data['User']['email'];
$this->Email->subject = 'Your account reset request';
$this->Email->send('testing');
$this->Email->send();
debug($this->Email->smtpError); 
```

但是，当执行此代码时，我收到此错误：

```
Error: Call to a member function messageID() on a non-object    
File: C:\xampp\htdocs\site\lib\Cake\Controller\Component\EmailComponent.php 
Line: 312

Notice: If you want to customize this error message, create app\View\Errors\fatal_error.ctp 
```

我在这里做错了什么？目前我只想测试我的应用程序是否可以正确发送电子邮件。但是，Gmail 会是一种向生产中的用户发送电子邮件的好方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T04:18:30.307

它似乎是您没有将组件类包含到您的控制器中。将 包含`EmailComponent`到您的控制器文件中。

```
public $components = array('Email'); 
```

# javascript - 使用 javascript 调用外部网页（跨域）

> ID：11997256
> 
> 赞同：2
> 
> 时间：2012-08-17T00:21:01.727
> 
> 标签：javascript, jquery, ajax

我正在尝试使用[此问题](https://stackoverflow.com/questions/11996430/check-if-a-url-is-a-valid-feed)中的 Web 服务来验证提要。

但是浏览器不允许我向另一台服务器发送 ajax GET 请求。并且该 Web 服务中的每个请求都有一秒钟的限制，因此我无法镜像来自服务器的请求。

这是我当前的 jQuery 代码：

```
var reqUrl = "http://validator.w3.org/feed/check.cgi?url=" + encodeURIComponent(theUrl);
$.get(reqUrl, function(data) {
    // do something
}); 
```

难道没有别的办法了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T00:28:18.277

我搜索了谷歌并找到[了这个](https://stackoverflow.com/questions/3506208/jquery-ajax-cross-domain)。第三个答案说：

> 在计算中，同源策略是许多浏览器端编程语言（例如 JavaScript）的重要安全概念。该策略允许在源自同一站点的页面上运行的脚本无特定限制地访问彼此的方法和属性，但禁止跨不同站点的页面访问大多数方法和属性。[（来源）](http://en.wikipedia.org/wiki/Same_origin_policy)

你最好看看[这个](https://stackoverflow.com/questions/3506208/jquery-ajax-cross-domain)问题的答案。

我认为您不能使用 JSONP，因为您无法访问 W3C 脚本。

**更新（说明）**

我链接到的问题还有另一种方式可以向您解释。如果您将`Access-Control-Allow-Origin`标头设置`*`为答案，您可以将请求发送到另一个域。并在 MVC 应用程序中轻松使用它，您可以看到[这个](http://blog.gregbrant.com/post/Adding-Custom-HTTP-Headers-to-an-ASPNET-MVC-Response.aspx)解决方案。**祝你好运**

**更新2**

只允许`http://validator.w3.org/`你应该设置`Access-Control-Allow-Origin`为`http://validator.w3.org/`

有关答案的更多详细信息，请转到[此处](https://developer.mozilla.org/en-US/docs/HTTP_access_control#Access-Control-Allow-Origin)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T00:28:19.347

[除非您使用JSONP](http://en.wikipedia.org/wiki/JSONP)，否则 Ajax 调用在不同域之间无效。[JQuery-ajax-cross-domain](https://stackoverflow.com/questions/3506208/jquery-ajax-cross-domain)是一个类似的问题，可能会给您一些见解。此外，正如 Luis 在评论中所指出的，JSONP 也必须在您从中获取数据的域上实现。

这是 jquery ajax() 的示例，但您可能需要查看[$.getJSON()](http://api.jquery.com/jQuery.getJSON/)：

```
$.ajax({
    url: 'http://yourUrl?callback=?',
    dataType: 'jsonp',
    success: processJSON
}); 
```

另一个选项是[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)（跨源资源共享），但是，这需要其他服务器启用 CORS，这在这种情况下很可能不会发生。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T00:35:31.953

如前所述，您可以使用 JSONP，但端点也必须实现它，并且仅在您从调用中请求 json 数据时使用。看起来您正在检索 html。

您还可以在您的域中实现一个简单的代理，从外部位置提取数据并将其提供给 ajax 调用。您可以使用例如 CURL 在 php 中开发一个简单的代理。

确保您了解这种安全方面的含义，例如确保您保护您的代理只调用该外部 url（白名单）。

更新：我刚刚注意到您不能使用代理解决方案。在遵循您建议的链接之后，我遇到了我不知道的[CORS 。](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)很明显，您可以在为域中的页面提供服务时设置一些标头，这些标头将指示浏览器可以完成对某些域的请求。

检查此页面以了解如何实现它：

[http://enable-cors.org/](http://enable-cors.org/)

我已经读到您可能需要对其进行一些调整才能与 IE 一起使用，但似乎所有浏览器现在都在实现它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-25T14:59:49.550

我知道这是一个老问题，但我自己也一直在尝试向 validator.w3.org 创建 AJAX 请求，遇到完全相同的问题并偶然发现了这个 SO 问题。

但是，我确实找到了解决方案；

正如人们已经说过的，这里的主要问题是服务器必须发出有效的 CORS 标头，即

访问控制允许来源：*

我使用 Fiddler 检查来自 validator.w3.org 的响应标头，果然，标头没有设置。但是，他们在 validator.w3.org/nu/ 上还有另一个工具。

这是一个例子：[http ://codepen.io/DDN-Shep/pen/ogdGgO/](http://codepen.io/DDN-Shep/pen/ogdGgO/)

```
$('form').on('submit', function(e) {
  e.preventDefault();

  var data = new FormData(this);

  $.ajax({
    url: 'http://validator.w3.org/nu/', // Trailing '/' is important or you get a 301 HTTP response status code
    type: 'POST',
    data: data,
    processData: false, // Required for jQuery & FormData
    contentType: false, // Set by FormData, required by the server
    success: function(data, status, xhr) { /* TODO */ },
    error: function(xhr, status, error) { /* TODO */ },
    complete: function(xhr, status) { /* TODO */ }
  });
}); 
```

如果您不确定服务器是否允许 CORS，您可以使用这个非常有用的在线工具；

test-cors.org = [http://client.cors-api.appspot.com/client](http://client.cors-api.appspot.com/client)

# java - 以编程方式将 .html 文件放入 ZIP 会打乱文本

> ID：11997258
> 
> 赞同：0
> 
> 时间：2012-08-17T00:21:15.740
> 
> 标签：java, html, servlets, utf-8, zip

使用 java，我采用一个代表一些 HTML 的字符串：

```
String webPage = "<!DOCTYPE html><html xmlns:csi='http://www.massimocorner.com/libraries/csi/' lang='de'>" +
                        "<head><meta http-equiv='Content-Type' content='text/html;charset=UTF-8'/> ..... </html> 
```

并将其放入一个 zip 文件中，如下所示：

```
ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream(); 
ZipStreamOutput output = new ZipStreamOutput( byteArrayOutputStream );
OutputStream os = output.addStream(Integer.toString(i) +".html");
os.write(webPage.getBytes()); 
os.flush();
output.finish(); 
byte[] data = byteArrayOutputStream.toByteArray(); 
```

然后我从我的 serverlet 提供 ZIP 文件，如下所示：

```
response.setCharacterEncoding("UTF-8");
response.setContentType( "application/zip"); 
response.setContentLength( data.length ); 
response.setHeader( "Content-Disposition", "inline; filename="  + "filename.zip"); 
response.getOutputStream().write( data ); 
```

当我提取 ZIP 文件并在浏览器中打开 HTML 文件时，即使 HTML 表明它应该以 UTF-8 呈现，它也不会呈现。

如果我只是提供 HTML 文件而不压缩它，它会正常呈现。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T01:22:34.490

如果您尝试发送 HTML 的压缩版本并让浏览器呈现 HTML，那么您希望将 Content-Encoding 标头设置为“gzip”，将 Content-Type 标头设置为“text/html”。使用 GZIPOutputStream 而不是 ZIPOutputStream 压缩页面。检查“接受”请求标头以确保浏览器支持这种压缩。

请参阅[如何使用 gzip 设置内容编码](https://stackoverflow.com/questions/864448/how-to-set-content-encoding-with-gzip)

您也可以使用 Servlet 过滤器执行此操作：http: [//onjava.com/onjava/2003/11/19/filters.html](http://onjava.com/onjava/2003/11/19/filters.html)

# iphone - Xcode 中的 Segue 头痛

> ID：11997273
> 
> 赞同：0
> 
> 时间：2012-08-17T00:22:56.437
> 
> 标签：iphone, objective-c, ios, xcode, ios4

我有一个 tableview，我创建了一个 segue 将它推送到另一个视图控制器。我可以保证，每隔一段时间，这个转场就会在我不碰它的情况下中断。我什至没有编辑我放入的文件。

我的代码：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *acell = [tableView cellForRowAtIndexPath:indexPath];
    [self performSegueWithIdentifier:@"cellWasSelected" sender:acell];
}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    if ([segue.identifier isEqualToString:@"cellWasSelected"])
    {
        if ([sender isKindOfClass:[UITableViewCell class]])
        {
            UITableViewCell *selectedCell = sender;
            ViewController *myDetViewCont = segue.destinationViewController;
            myDetViewCont.navigationItem.title = selectedCell.textLabel.text;
        }
    }
} 
```

首先，单击单元格后，xcode 会将我定向到此 segue 推送到的文件。它把我重定向到这里：`action:@selector(handleSingleTap:)];` 我用这个来触发我的图像：`[self.navigationController popToRootViewControllerAnimated:YES]`

如果我在线程 1 中选择我的主要视图，我看到的问题是：

`[self performSegueWithIdentifier:@"cellWasSelected" sender:acell];`

但是我用了几千次的问题是什么，它开始崩溃而我没有改变它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T04:05:17.670

您的代码没有任何错误，问题出在其他地方。可能是您没有在界面生成器中给 segue 一个标识符。试试这个代码。它在我这边工作，如果您的文件没有任何问题，它也应该在您这边运行。

```
-(void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

NSString* identifier = [segue identifier];

if ([identifier isEqualToString:@"cellWasSelected"]) {
    NSLog(@"Performing Seque");

    if ([sender isKindOfClass:[UITableViewCell class]]) {
        NSLog(@"correct");
        UITableViewCell *selectedCell = sender;
        UIViewController* myDetViewCont = segue.destinationViewController;
        myDetViewCont.navigationItem.title = selectedCell.textLabel.text;
    }
}

}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
   NSLog(@"%@",@"Cell Selected");
   UITableViewCell* cell = [tableView cellForRowAtIndexPath:indexPath];
   [self performSegueWithIdentifier:@"cellWasSelected" sender:cell];
} 
```

PS如果您仍然遇到问题，那么您可能是故事板的新手，您需要足够的知识来处理它们。 [http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1](http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1)

# objective-c - 苹果会拒绝我的非单元测试应用程序吗？

> ID：11997274
> 
> 赞同：-1
> 
> 时间：2012-08-17T00:23:12.070
> 
> 标签：objective-c, unit-testing, xcode4.2

好吧，我是 Objective-C 和编程的新手（初学者）......我已经在 Xcode 上完成了一个 iPhone 应用程序......我之前不知道单元测试......当我测试我的应用程序时，它给出了包含单元测试的我的错误尚未实现，因为我在开始制作我的应用程序时检查了单元测试框..如果我取消选中该框怎么办..苹果会拒绝我的应用程序还是什么？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T00:24:48.443

Apple 不会拒绝没有单元测试的应用程序。

# sed - 如何找到和更换分音符？

> ID：11997278
> 
> 赞同：0
> 
> 时间：2012-08-17T00:23:43.033
> 
> 标签：sed, replace, nawk

我有一个包含一些分音符号的文件，`̈`. 我需要用 , 替换它们以`\textdiaeresis`在 TeX 中使用。

似乎与其他符号一起使用的常用命令总是导致输出为`\\textdiaeresis`or `\ extdiaeresis`，后者`\t`被解释为“tab”。

我试过这些`sed`命令：

```
sed -i 's/\ ̈/\textdiaeresis /g' ./file.txt
sed -i 's/\ ̈/\\textdiaeresis /g' ./file.txt
sed -i 's/\ ̈/\\\textdiaeresis /g' ./file.txt
sed -i "s/\ ̈/\textdiaeresis /g" ./file.txt
sed -i "s/\ ̈/\\textdiaeresis /g" ./file.txt
sed -i "s/\ ̈/\\\textdiaeresis /g" ./file.txt 
```

我试过这些`nawk`命令：

```
nawk '{sub(/ ̈/,"\textdiaeresis"); print}' file.txt > file.txt2
cp file.txt2 file.txt
nawk '{sub(/ ̈/,"\\textdiaeresis"); print}' file.txt > file.txt2
cp file.txt2 file.txt
nawk '{sub(/ ̈/,"\\\textdiaeresis"); print}' file.txt > file.txt2
cp file.txt2 file.txt 
```

如何用这个 TeX 代码替换分音符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T02:36:05.820

在 Mac OS X 10.7.4 下`bash`（版本 3.2.48），我发现`sed`（这是 Mac OS X `sed`，而不是 GNU `sed`）没有问题。

```
$ x="s, ̈. "
$ echo "$x" | ~/src/sbcs2utf8/utf8-unicode
(standard input):
0x73 = U+0073
0x2C = U+002C
0x20 = U+0020
0xCC 0x88 = U+0308
0x2E = U+002E
0x20 = U+0020
0x0A = U+000A
$ echo "$x" | sed 's/ ̈/\\textdiaresis/'
s,\textdiaresis. 
$ 
```

字符是U+0308组合分音；我复制了`x`从问题中分配给的片段。Unicode 标准规定（第 2 章，第 2.11 节）：

> 在 Unicode 标准中，所有组合字符都将在它们适用的基本字符之后按顺序使用。Unicode字符序列U+0061“a”拉丁小写字母A，U+0308“¨”组合分音符号，U+0075“u”拉丁小写字母U明确表示“äu”而不是“aü”。

因此，问题文本中的分音符应该在空间上呈现。使用 Firefox (14.0.1)，在 shell 输出中，分音符显示在`.`下面，这是错误的。并且在`sed`命令中，分音符号似乎与下面的斜杠组合在一起，这也是错误的。那好吧！但是我的翻译`sed`看起来是正确的。

# python - 使用按字段数将文件拆分为较小的文件

> ID：11997279
> 
> 赞同：2
> 
> 时间：2012-08-17T00:23:47.730
> 
> 标签：python, unix, csv, sed, awk

我很难将大型（50GB）csv 文件分成更小的部分。每行有几千个字段。一些字段是双引号中的字符串，其他字段是整数、小数和布尔值。

我想逐行解析文件并按每行中的字段数分割。字符串可能包含几个逗号（例如 ），以及一些空字段。

> ,,1,30,50,"父子三女以 4,000 美元出售" ,,,,, 12,,,20.9,0,

我尝试使用

```
perl -pe'  s{("[^"]+")}{($x=$1)=~tr/,/|/;$x}ge  '  file >> file2 
```

将引号内的逗号更改为 | 但这没有用。我打算用

```
awk -F"|" conditional statement appending to new k_fld_files file2 
```

请问有没有更简单的方法来做到这一点？我在看python，但我可能需要一个实用程序来逐行处理文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T00:50:02.687

使用 Python - 如果您只想解析包含嵌入式分隔符的 CSV，并使用新的分隔符流出，那么例如：

```
import csv
import sys
with open('filename.csv') as fin:
    csvout = csv.writer(sys.stdout, delimiter='|')
    for row in csv.reader(fin):
        csvout.writerow(row) 
```

否则，让它做各种各样的事情并不难。

每列输出到文件的示例（未经测试）：

```
cols_to_output = {}
for row in csv.reader(fin):
    for colno, col in enumerate(row):
        output_to = cols_to_output.setdefault(colno, open('column_output.{}'.format(colno), 'wb')
        csv.writer(output_to).writerow(row)

for fileno in cols_to_output.itervalues():
    fileno.close() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T11:55:45.700

这是一个`awk`替代方案。

假设引用的字符串格式正确，即始终具有起始和终止引号，并且在其他引号中没有引号，您可以通过`gsub`在每个其他字段上替换`,`为`|`.

**带管道**

以下是使用 抓取第 3 到 6、11 和 14-15 列时可能发生的情况的示例`coreutils` `cut`：

```
awk -F'"' -v OFS='' '
  NF > 1 { 
    for(i=2; i<=NF; i+=2) { 
      gsub(",", "|", $i);
      $i = FS $i FS;       # reinsert the quotes
    }
    print
  }'\
| cut -d , -f 3-6,11,14-15 \
| awk -F'"' -v OFS='' -e '
    NF > 1 { 
      for(i=2; i<=NF; i+=2) { 
        gsub("\\|", ",", $i)
        $i = FS $i FS;       # reinsert the quotes
      }
      print
    }' 
```

请注意，还有一个额外的后处理步骤可以`|`将`,`.

**完全在 awk**

`awk`或者，您可以在范围规范方面失去一般性来完成整个事情。这里我们只抓取第 3 到 6 列：

*提取.awk*

```
BEGIN {
  OFS   = ""
  start = 3
  end   = 6
}
{
  for(i=2; i<=NF; i+=2) {
    gsub(",", "|", $i)
    $i = FS $i FS
  }
  split($0, record, ",")
  for(i=start; i<=end-1; i++) {
    gsub("\\|", ",", record[i])
    printf("%s,", record[i])
  }
  gsub("\\|", ",", record[end])
  printf("%s\n", record[end])
} 
```

# css - 关于添加间隔 div 以修复 CSS 浮动 div 问题

> ID：11997289
> 
> 赞同：0
> 
> 时间：2012-08-17T00:25:02.297
> 
> 标签：css, css-float

我目前正在学习 CSS。我正在努力正确排列我的表单元素。`submitBtn`特别是div的最后一个元素，这是我的问题：

![在此处输入图像描述](../Images/389be9f8cb73831c33bed2b164f19a9d.png)

浮动`submitBtn`的 div 不包含在`formContainer`div 中，这是我的代码（`spacer`div 已关闭）：

```
* {
    margin: 0;
    padding : 0;    
}

li {
    list-style : none;
}

#mainContainer {
    width : 760px;
    margin : 20px auto ;
    background-color : red;
}

#header {
    background-color: blue;
}

#formContainer {
    background-color : green;
}

#textInfo {
    background-color : yellow ;
}

#occupationInfo {
    background-color : purple ;
}

#hobbyInfo {
    background-color : pink ;   
}

#birthdayInfo {
    background-color : brown ;
}

#briefInfo {
    background-color : darkblue;
}

#submitBtn {
    width : 50px;
    float : right;
    clear : both;
    background-color : black ; 
}

/*#spacer {
    clear : both;
}*/ 
```

但是当我取消注释时，它解决了问题：

![在此处输入图像描述](../Images/81108f3bcec1c9c4db7423a09872ec6d.png)

除了添加间隔 div 之外，还有什么更清洁的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T02:18:14.847

除了 Diego 的解决方案，您还可以尝试添加`overflow:auto`到 formContainer。发生这种情况的原因是因为父元素永远不会扩展为包含浮动元素。浮动元素将“溢出”其容器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T00:27:44.990

是的，您可以使用[clearfix](http://www.webtoolkit.info/css-clearfix.html)方法。

将以下代码添加到您的 CSS 中：

```
/*** Clearfix ***/
.clearfix:after {
    content: ".";
    display: block;
    clear: both;
    visibility: hidden;
    line-height: 0;
    height: 0;
}

.clearfix {
    display: inline-block;
}

html[xmlns] .clearfix {
    display: block;
}

* html .clearfix {
    height: 1%;
} 
```

然后将类分配`clearfix`给您的容器`div`。

# maven-2 - 使用 maven2 故障安全和嵌入式 glassfish 进行集成测试

> ID：11997291
> 
> 赞同：2
> 
> 时间：2012-08-17T00:25:12.277
> 
> 标签：maven-2, glassfish-embedded, maven-failsafe-plugin

我创建了一个新项目，它只会运行集成测试

*   maven-ear-插件
*   maven-failsafe-插件
*   maven 嵌入式 glassfish 插件

当我将包装设置为 ear 时，ear 文件被创建，glassfish 运行但测试被忽略，我收到以下消息

> [failsafe:integration-test] 没有要运行的测试。

并且 glassfish 取消部署失败

> [嵌入式玻璃鱼：取消部署]
> 2012 年 8 月 17 日上午 10:08:17 PluginUtil doUndeploy
> 信息：部署者 = com.sun.enterprise.admin.cli.embeddable.DeployerImpl@105f0f87 2012 年
> 8 月 17 日上午 10:08:17 com.sun.enterprise.loader.ASURLClassLoader$SentinelInputStream
> 报告
> 警告：输入流已被最终确定或强制关闭，但未明确
> 关闭； 在 com.sun.enterprise.loader.ASURLClassLoader$SentinelInputStream的以下堆栈跟踪
> java.lang.Throwable 中报告了流实例化。(ASURLClassLoader.java:1230)

当我将包装设置为罐子时，我得到

> 运行 packageName.MyServiceTest
> 17/08/2012 10:09:34 AM com.sun.enterprise.v3.server.CommonClassLoaderServiceImpl
> findDerbyClient 信息：找不到 javadb 客户端 jar 文件，derby jdbc 驱动程序默认
> 不可用。org.omg.CORBA.COMM_FAILURE：FINE：IOP00410001：连接失败：socketType：IIOP_CLEAR_TEXT；主机名：本地主机；端口：3700 vmcid：OMG 次要代码：1 已完成： 在 sun.reflect.GeneratedConstructorAccessor27.newInstance 处没有（未知来源）

并且 glassfish 没有启动

我知道它与 Maven 生命周期有关，它不允许我创建 ear 文件、启动 glassfish 嵌入式服务器并在同一个项目中运行集成测试。

有人可以建议我一个解决方案吗？我正在尝试仅使用 EJB 和业务实体项目创建 ear 文件并将其部署到嵌入式 glassfish 服务器以使用 maven-failsafe-plugin 运行集成测试，而不是部署由父 pom.xml 创建的 ear 文件，它添加UI等项目放入ear文件。

这是我的 pom.xml 文件

http://maven.apache.org/xsd/maven-4.0.0.xsd">4.0.0

```
<parent>
    <groupId>company.MyProject</groupId>
    <artifactId>MyProject</artifactId>
    <version>3.8.1-SNAPSHOT</version>
</parent>

<artifactId>MyProject-integration-test</artifactId>
<packaging>jar</packaging>

<name>MyProject Integration Tests</name>

<properties>
    <ear-final-name>MyProject-integration-test-${project.version}</ear-final-name>
</properties>

<dependencies>
    <dependency>
        <groupId>org.glassfish.extras</groupId>
        <artifactId>glassfish-embedded-all</artifactId>
        <version>3.1.1</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>org.concordion</groupId>
        <artifactId>concordion</artifactId>
        <version>1.4.2</version>
        <scope>test</scope>
        <type>jar</type>
    </dependency>
    <dependency>
        <groupId>org.concordion</groupId>
        <artifactId>concordion-extensions</artifactId>
        <version>1.0.2</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>${project.groupId}</groupId>
        <artifactId>MyProject-ejb</artifactId>
        <version>${project.version}</version>
        <type>ejb</type>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>com.aspose</groupId>
        <artifactId>aspose-words-jdk15</artifactId>
        <version>${aspose.libraryVersion}</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>javax.persistence</groupId>
        <artifactId>persistence-api</artifactId>
        <version>1.0.2</version>
        <scope>test</scope>
    </dependency>
    <dependency>
        <groupId>hibernate-entitymanager</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>3.4.0.GA</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-core</artifactId>
        <version>3.3.2.GA</version>
    </dependency>
    <dependency>
        <groupId>hibernate-annotations</groupId>
        <artifactId>hibernate-annotations</artifactId>
        <version>3.4.0.GA</version>
    </dependency>
    <dependency>
        <groupId>hibernate-commons-annotations</groupId>
        <artifactId>hibernate-commons-annotations</artifactId>
        <version>3.4.0.GA</version>
    </dependency>
    <dependency>
        <groupId>com.oracle</groupId>
        <artifactId>ojdbc14</artifactId>
        <version>10.1.0.5.0</version>
    </dependency>
    <dependency>
        <groupId>ehcache</groupId>
        <artifactId>ehcache</artifactId>
        <version>1.2.3</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.6.6</version>
    </dependency>
    <dependency>
        <groupId>org-apache-commons-logging</groupId>
        <artifactId>org-apache-commons-logging</artifactId>
        <version>1.1.0</version>
    </dependency>
</dependencies>

<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-ear-plugin</artifactId>
            <version>2.5</version>
            <configuration>
                <version>5</version>
                <displayName>MyProject</displayName>
                <defaultLibBundleDir>lib</defaultLibBundleDir>
                <finalName>${ear-final-name}</finalName>
                <name>MyProject-integration-test</name>
                <modules>
                    <ejbModule>
                        <groupId>company.MyProject</groupId>
                        <artifactId>MyProject-ejb</artifactId>
                        <bundleFileName>MyProject-ejb.jar</bundleFileName>
                    </ejbModule>
                    <jarModule>
                        <groupId>company.MyProject</groupId>
                        <artifactId>MyProject-business-entities</artifactId>
                        <bundleFileName>MyProject-business-entities-3.8.1-SNAPSHOT.jar</bundleFileName>
                    </jarModule>
                    <jarModule>
                        <groupId>company.MyProject</groupId>
                        <artifactId>MyProject-util</artifactId>
                        <bundleFileName>MyProject-util-3.8.1-SNAPSHOT.jar</bundleFileName>
                    </jarModule>
                </modules>
            </configuration>
        </plugin>

        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-failsafe-plugin</artifactId>
            <version>2.12</version>
            <executions>
                <execution>
                    <id>failsafe-integration-tests</id>
                    <phase>integration-test</phase>
                    <goals>
                        <goal>integration-test</goal>
                    </goals>
                </execution>
                <execution>
                    <id>failsafe-verify</id>
                    <phase>verify</phase>
                    <goals>
                        <goal>verify</goal>
                    </goals>
                </execution>
            </executions>
            <dependencies>
                <dependency>
                    <groupId>junit</groupId>
                    <artifactId>junit</artifactId>
                    <version>4.8.2</version>
                </dependency>
            </dependencies>
        </plugin>

        <plugin>
            <groupId>org.glassfish</groupId>
            <artifactId>maven-embedded-glassfish-plugin</artifactId>
            <version>3.1.1</version>
            <configuration>
                <goalPrefix>embedded-glassfish</goalPrefix>
                <autoDelete>true</autoDelete>
                <app>${basedir}/target/MyProject-integration-test-${project.version}.ear</app> 
                <port>8080</port>
                <configFile>src/test/resources/glassfish/config/domain.xml</configFile>
            </configuration>
            <executions> 
                <execution>
                    <id>start-glassfish</id>
                    <phase>pre-integration-test</phase>
                    <goals>
                        <goal>start</goal>
                    </goals>
                </execution>
                <execution>
                    <id>glassfish-deploy</id>
                    <phase>pre-integration-test</phase>
                    <goals>
                        <goal>deploy</goal>
                    </goals>
                </execution>
                <execution>
                    <id>glassfish-undeploy</id>
                    <phase>post-integration-test</phase>
                    <goals>
                        <goal>undeploy</goal>
                    </goals>
                </execution>

                <execution>
                    <id>stop-glassfish</id>
                    <phase>post-integration-test</phase>
                    <goals>
                        <goal>stop</goal>
                    </goals>
                </execution>
            </executions> 
        </plugin> 
    </plugins>

</build> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T12:32:09.157

是的，它现在工作。原来问题出在我的 domain.xml 文件上。默认 domain.xml 带有前缀为 2 的端口号，应将其删除，并且在嵌入式 glassfish 3.1 <port> 8080 < /port> 中如果设置了 <configFile> 则不起作用（参考此文档） [http://embedded- glassfish.java.net/nonav/plugindocs/3.1/stop-mojo.html](http://embedded-glassfish.java.net/nonav/plugindocs/3.1/stop-mojo.html)。

我只需将 domain.xml 中的 IIOP 端口设置为 3700 并在我的测试中

```
 Properties props = new Properties();  
 props.put("org.omg.CORBA.ORBInitialPort", "3700");
 Context ctx = new InitialContext(props); 
```

多谢你们

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T07:14:34.737

您可以在一次调用中完成打包和启动 glassfish。

你有没有尝试过：

```
mvn verify 
```

这样做？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-23T23:31:55.633

可能是另一种指定 Glassfish 的 IIOP 端口的解决方案（首先需要确认服务器 IP 和 IIOP 侦听器端口）：

```
System.setProperty("org.omg.CORBA.ORBInitialHost", "127.0.0.1");
System.setProperty("org.omg.CORBA.ORBInitialPort", "8037");
Context ctx = new InitialContext(); 
```

# c# - 在外部 Javascript 文件中进行内联 C# 调用

> ID：11997292
> 
> 赞同：3
> 
> 时间：2012-08-17T00:25:22.470
> 
> 标签：c#, javascript, asp.net

随着我的 javascript 越来越大，我想清理我的 ASPX 文件。

问题是我的很多 javascript 涉及很多内联 C# 调用。IE：

```
'<%=C# method call)%>' 
```

但是，当它隐藏在 .js 文件中时，这似乎不起作用。

有没有一种解决方法，所以我可以将我的 javascript 分成 js 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T00:29:27.277

当然，您不能从 .js 文件调用 C#。C# 代码在服务器上执行，而不是在客户端上。您的 .js 文件未在服务器上解析。

没有什么可以阻止您将实际的 JavaScript 放入 .js 文件中，这与服务器端 C# 代码动态发出的 JavaScript 不同。

如果您有大量生成 JavaScript 的 C# 代码，您仍然可以使用部分视图来组织代码（这是 MVC 术语，但我确信标准 ASP.Net 也有类似的东西）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T00:40:25.210

您可以使用[WebMethods](http://msdn.microsoft.com/en-us/library/byxd99hx%28v=vs.90%29.aspx)并通过 Ajax 调用它们。

```
[WebMethod]
public static int SomeMethod()
{
    ...
} 
```

然后用 Ajax 调用它。（我在这个例子中使用了[jQuery 。）](http://api.jquery.com/jQuery.ajax/)

```
$.ajax({
    type:        "POST"  
    url:         "/yourwebpage.aspx/SomeMethod"
    data:        "{}"
    contentType: "application/json; charset=utf-8",
    dataType:    "json",
    success:     function(data) {
                     // do something with the return value
                 }
}); 
```

# git - 仅将提交中的更改与当前工作目录进行比较

> ID：11997316
> 
> 赞同：1
> 
> 时间：2012-08-17T00:28:36.737
> 
> 标签：git, svn, branch

我有一个非常大的回购，需要一些清理。回购来自 SVN，一开始就很混乱。

有许多分支，其中一些合并到主干中，而另一些则没有。不幸的是，SVN 没有跟踪这一点，因此来自 SVN 的合并/未合并分支看起来是一样的。（就像树枝在风中挂在那里）

我想剪掉这些多余的树枝，把东西清理一下。

如何获取提交的 SHA1，并仅将该提交中发生的更改与 master 中的更改进行比较？（因此，如果某个分支的提交中的所有更改都在 master 中，我可以删除该分支，否则我可以适当地维护该分支）。

树的例子：

```
 o--o--o--o--o Unmerged from SVN
          /
o--o--o--o--o--o--o--o--o--o--o--o--o--o--o--o--o--o--o Master
    \                             \         /
     o--o--o Merged from SVN        o--o--o 
```

（请注意，据 Git 所知，两个分支如何没有合并回 master，但在其中一个分支中，所有更改都在 master 中，因为它是在 SVN 存储库时合并的，我想删除这个）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:02:39.263

无论如何尝试合并一个分支：

```
git merge --no-commit  YourDanglingBranch 
```

这将尝试合并 YourDanglingBranch 但实际上并不进行提交。

如果 YourDanglingBranch 已经合并，那么 git 足够聪明，可以在我的测试中什么都不做。所以只需使用`git merge --abort`完成这个分支，安全地删除它并继续另一个。

如果 YourDanglingBranch 尚未合并，则无需提交即可完成合并。您可以检查更改，解决可能的冲突，然后提交合并的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T12:43:59.573

分支是否有不同的哈希？如果没有，只需运行`git checkout master && git branch -d <branch>`并完成它。使用小写`-d`标志，git 将拒绝删除未合并到签出分支中的分支（在此示例中，`master`，但它可以是您选择的任何分支）。

事实上，您可以轻松地自动执行此操作。[这个答案](https://stackoverflow.com/a/11395096/877115)显示了一个 git 别名，它将删除任何未与当前分支合并的分支。看着它工作有点可怕，但它工作得很好。

# mysql - CI 插入失败

> ID：11997317
> 
> 赞同：0
> 
> 时间：2012-08-17T00:28:45.690
> 
> 标签：mysql, codeigniter, phpmyadmin

我在**Code Igniter**中注册新用户时遇到问题，但失败了。我知道如何设法回显查询，当我在 phpmyadmin 上手动运行它时，它给了我以下错误 **#1205 - 超过锁定等待超时；尝试重启事务**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T03:27:07.247

MySQL 错误 1205 可能发生在您的应用程序（在本例中为 PHP）在事务中间死机并且连接未关闭时。

重新启动 MySQL 将解决问题，但您应该尝试找出错误在代码中的位置。它应该在 PHP 错误日志中。如果 Code Igniter 能够捕捉到错误（在这种情况下不太可能），那么它可能在`application/logs`.

如果执行时间可能是罪魁祸首，请检查[PHP: Runtime Configuration](http://php.net/manual/en/info.configuration.php)。具体来说：

`max_execution_time`并且，此外，[`memory_limit`](http://www.php.net/manual/en/ini.core.php#ini.memory-limit)

增加这些值（您必须试验的数量）应该可以消除脚本执行时间这个潜在问题。您可以在 php.ini 中设置这些。由于您使用的是 xampp，因此该位置将是`<installation drive/directory>\xampp\php`或`<installation drive/directory>\xampp\apache\bin`。

希望这可以帮助您解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T19:55:38.067

这个问题在我的本地服务器上，我正在使用 xampp，但查询在开发服务器上运行良好。xampp 可能存在一些执行时间问题。但是现在问题已经解决了。谢谢大家 ：）

# jquery - 如何格式化json数据

> ID：11997320
> 
> 赞同：1
> 
> 时间：2012-08-17T00:28:59.947
> 
> 标签：jquery, json, getjson

我是 json 新手，我真的在为我的数据格式苦苦挣扎。
它需要具有以下格式：**music.genre.album**，但只需**genre.album**也可以。

请问有人可以帮助以下结构吗？我将使用 getJSON 来遍历它。

```
{"music": [{

"Genre_Blues": [{
    "Album": "224",
    "Path": "images/library/",
    "FileName": "AlbumCover224.png"
    },
    {
    "Album": "277",
    "Path": "images/library/",
    "FileName": "AlbumCover277.png"
    },
    {
    "Album": "885",
    "Path": "images/library/",
    "FileName": "AlbumCover885.png"
    }],
"Genre_Jazz": [{
    "Album": "442",
    "Path": "images/library/",
    "FileName": "AlbumCover442.png"
    },
    {
    "Album": "467",
    "Path": "images/library/",
    "FileName": "AlbumCover467.png"
    },
    {
    "Album": "724",
    "Path": "images/library/",
    "FileName": "AlbumCover724.png"
    }],
"Genre_Rock": [{
    "Album": "022",
    "Path": "images/library/",
    "FileName": "AlbumCover022.png"
    },
    {
    "Album": "609",
    "Path": "images/library/",
    "FileName": "AlbumCover609.png"
    },
    {
    "Album": "067",
    "Path": "images/library/",
    "FileName": "AlbumCover067.png"
    }]
  }]

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T01:18:42.063

JSON 就像 JavaScript（因为它是）。

如果你想在流派中存储多个东西（这就是流派......），那么它需要是一个数组。

但是想想常规的 JS 对象和数组。

```
music = {};
music.genre = {};
music.genre.blues = [];
music.genre.blues[0] = {}; 
```

可以写成：

```
json = { 
    music : {
        genre : {
            blues : [],
            rock  : [],
            soul  : []
        }
    }
} 
```

然后你有：

```
json.music.genre.blues[0].album_title;  // "Some Kind of Blue"
json.music.genre.blues[0].album_artist; // "Miles Davis" 
```

你可以设置一个循环来穿过你的布鲁斯，或者你的摇滚或任何东西......

如果您不想循环它们，那么您必须找到其他方法来索引它们，因为您不能拥有一个具有 8 个“专辑”属性的对象。也许你可以在那时按标题列出它们......但这并不是那么有帮助。在这一点上，你只是摆脱了阵列。

您也可以将其设置为流派是一个数组（这就是您现在所拥有的）。

所以你可能有：

```
music = {
    genre : [
        {
            name : "Blues",
            albums : [
                {
                    title : "Some Kind of Blue",
                    artist : "Miles Davis"
                }
             ]
         },  {
             name : "Soul",
             albums : [
                 {
                     title : "Innervisions",
                     artist : "Stevie Wonder"
                 }, {
                     title : "Talking Book",
                     artist : "Stevie Wonder"
                 }
             ]
         }
     ]
}; 
```

然后你有：

```
music.genre[0].name;             // "Blues"
music.genre[1].albums[0].artist; // "Stevie Wonder" 
```

这样做的好处是：

```
music.genre.forEach(function (genre) { console.log(genre.name); }); // "Blues", "Soul"

music.genre.forEach(function (genre) {
    console.log("---" + genre.name + "---");
    genre.albums.forEach(function (album) {
        console.log("Title: " + album.title);
        console.log("Artist: " + album.artist);
    });
}); 
```

这一切都取决于你想用它做什么。你可以自由地做任何你想做的事，只要你知道那是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T00:31:00.057

快到*了*。您需要做的就是取出`[`和`]`

# antlr - 有没有办法检测一个可选的（？运算符）树语法规则是否在一个动作中执行？

> ID：11997322
> 
> 赞同：4
> 
> 时间：2012-08-17T00:29:22.843
> 
> 标签：antlr

```
path[Scope sc] returns [Path p]
@init{
List<String> parts = new ArrayList<String>();
}
    :   ^(PATH (id=IDENT{parts.add($id.text);})+ pathIndex? )
{// ACTION CODE
 // need to check if pathIndex has executed before running this code.
    if ($pathIndex.index >=0 ){
        p = new Path($sc, parts, $pathIndex.index);
    }else if($pathIndex.pathKey != ""){
        p = new Path($sc, parts, $pathIndex.pathKey);
}
; 
```

有没有办法检测 pathIndex 是否被执行？在我的操作代码中，我尝试测试 $pathIndex == null，但 ANTLR 不允许您这样做。ANTLRWorks 给出了一个语法错误，上面写着“在规则范围内缺少属性访问：pathIndex。”

我需要这样做的原因是因为在我的操作代码中我​​这样做：

```
$pathIndex.index 
```

如果变量 $pathIndex 被转换为 null，则返回 0。当您访问属性时，ANTLR 会生成`pathIndex7!=null?pathIndex7.index:0`这会导致对象出现问题，因为它会将我预设为 -1 的值更改为错误标志为 0。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T06:11:54.043

有几个选项：

## 1

将您的代码放在可选的 pathIndex 中：

```
rule
 : ^(PATH (id=IDENT{parts.add($id.text);})+ (pathIndex {/*pathIndex cannot be null here!*/} )? )
 ; 
```

## 2

使用布尔标志来表示 的存在（或不存在）`pathIndex`：

```
rule
@init{boolean flag = false;}
 : ^(PATH (id=IDENT{parts.add($id.text);})+ (pathIndex {flag = true;} )? )
   {
     if(flag) {
       // ...
     }
   }
 ; 
```

## 编辑

您也可以`pathIndex`不匹配任何内容，这样您就不需要在内部将其设为可选`path`：

```
path[Scope sc] returns [Path p]
 : ^(PATH (id=IDENT{parts.add($id.text);})+ pathIndex)
   {
     // code
   }
 ;

pathIndex returns [int index, String pathKey]
@init {
  $index = -1;
  $pathKey = "";
}
 : ( /* some rules here */ )?
 ; 
```

PS。意识到表达式`$pathIndex.pathKey != ""`很可能会计算为`false`。要比较 Java 中字符串的内容，请改用它们的`equals(...)`方法：

```
!$pathIndex.pathKey.equals("") 
```

或者如果`$pathIndex.pathKey`可以`null`，您可以通过以下方式规避 NPE：

```
!"".equals($pathIndex.pathKey) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T06:26:18.240

更多信息会有所帮助。但是，如果我理解正确，当您要测试的输入中不存在索引值时`$pathIndex.index == null`。此代码使用 pathIndex 规则将 Integer $index 返回到路径规则：

```
 path
    : ^(PATH IDENT+ pathIndex?)
            { if ($pathIndex.index == null)
                    System.out.println("path index is null");
              else      
                System.out.println("path index = " + $pathIndex.index); }
    ;

 pathIndex returns [Integer index]
      : DIGIT 
            { $index = Integer.parseInt($DIGIT.getText()); }
      ; 
```

为了测试，我创建了这些简单的解析器和词法分析器规则：

```
path    : 'path' IDENT+ pathIndex? -> ^(PATH IDENT+ pathIndex?)
        ;
pathIndex : DIGIT
        ;

/** lexer rules **/
DIGIT  :   '0'..'9' ;
IDENT  : LETTER+ ;
fragment LETTER : ('a'..'z' | 'A'..'Z') ; 
```

当输入中存在索引时，如 中`path a b c 5`，输出为：

```
Tree = (PATH a b c 5)
path index = 5 
```

当输入中不存在索引时，如 中`path a b c`，输出为：

```
Tree = (PATH a b c)
path index is null 
```

# java - 如何在Java中找到排序的排列

> ID：11997326
> 
> 赞同：9
> 
> 时间：2012-08-17T00:29:58.970
> 
> 标签：java, algorithm, sorting, array-algorithms

我想对数组进行排序并按排序顺序查找每个元素的索引。因此，例如，如果我在数组上运行它：

```
[3,2,4] 
```

我会得到：

```
[1,0,2] 
```

有没有一种简单的方法可以在 Java 中做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-17T00:43:30.947

假设您的元素存储在数组中。

```
final int[] arr = // elements you want
List<Integer> indices = new ArrayList<Integer>(arr.length);
for (int i = 0; i < arr.length; i++) {
  indices.add(i);
}
Comparator<Integer> comparator = new Comparator<Integer>() {
  public int compare(Integer i, Integer j) {
    return Integer.compare(arr[i], arr[j]);
  }
}
Collections.sort(indices, comparator); 
```

现在`indices`包含数组的索引，按它们的排序顺序。您可以`int[]`使用足够简单的`for`循环将其转换回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T01:39:46.337

```
import java.util.*;
public class Testing{
   public static void main(String[] args){
       int[] arr = {3, 2, 4, 6, 5};
       TreeMap map = new TreeMap();
       for(int i = 0; i < arr.length; i++){
            map.put(arr[i], i);
       }
       System.out.println(Arrays.toString(map.values().toArray()));
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T03:14:50.080

实现此目的的一种方法是制作一个配对列表，其中起始索引作为配对的第二部分。按字典顺序对对列表进行排序，然后从排序后的数组中读取起始位置。

起始数组：

```
[3,2,4] 
```

添加具有起始索引的对：

```
[(3,0), (2,1), (4,2)] 
```

按[字典顺序排序](http://en.wikipedia.org/wiki/Lexicographical_order)

```
[(2,1), (3,0), (4,2)] 
```

然后读出每对的第二部分

```
[1,0,2] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T11:37:36.147

```
import java.io.*;

public class Sample {
    public static void main(String[] args) {
        int[] data = {0, 3, 2, 4, 6, 5, 10};//case:range 0 - 10
        int i, rangeHigh = 10;
        int [] rank = new int[rangeHigh + 1];
        //counting sort
        for(i=0; i< data.length ;++i) ++rank[data[i]];
        for(i=1; i< rank.length;++i) rank[i] += rank[i-1];
        for(i=0;i<data.length;++i)
            System.out.print((rank[data[i]]-1) + " ");//0 2 1 3 5 4 6
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-11T03:51:25.650

作为更新，在 Java 8 中使用流 API 相对容易做到这一点。

```
public static int[] sortedPermutation(final int[] items) {
  return IntStream.range(0, items.length)
    .mapToObj(value -> Integer.valueOf(value))
    .sorted((i1, i2) -> Integer.compare(items[i1], items[i2]))
    .mapToInt(value -> value.intValue())
    .toArray();
} 
```

不幸的是，它需要对索引进行装箱和拆箱步骤，因为在 上没有`.sorted(IntComparator)`方法`IntStream`，甚至没有`IntComparator`功能接口。

推广到 a `List`of`Comparable`对象非常简单：

```
public static <K extends Comparable <? super K>> int[] sortedPermutation(final List<K> items) {
  return IntStream.range(0, items.size())
    .mapToObj(value -> Integer.valueOf(value))
    .sorted((i1, i2) -> items.get(i1).compareTo(items.get(i2)))
    .mapToInt(value -> value.intValue())
    .toArray();
} 
```

# matlab - 不规则域的 MATLAB 等高线图

> ID：11997333
> 
> 赞同：2
> 
> 时间：2012-08-17T00:31:21.073
> 
> 标签：matlab, polygon, contour

我被这个问题困扰了很长时间。我有一个多边形区域（比如说，一个六边形）。我可以计算多边形内任意点的某个函数的值。现在我需要为这些数据创建一个填充轮廓（在 MATLAB 中使用 contourf）。我该怎么做。我在下面的链接（第 121 页）中找到了有关此主题的一些讨论

[http://www-personal.umich.edu/~jpboyd/eng403_chap4_contourplts.pdf](http://www-personal.umich.edu/~jpboyd/eng403_chap4_contourplts.pdf)

这有点效果，但它仍然会产生我不想要的锯齿状边缘。有人对这个问题有什么建议吗？谢谢。这是我的代码

```
close all
Node  = [ 1.0  0
          0.5  0.8660
         -0.5  0.8660
         -1.0  0
         -0.5 -0.8660
          0.5 -0.8660];
[x,y] = meshgrid(-1:0.1:1,-1:0.1:1);

N = zeros(size(x));
for i=1:size(x,2)
    for j=1:size(y,2)
        p = [x(i,j) y(i,j)];
        IN = inpolygon(p(1),p(2),Node(:,1),Node(:,2));
        if IN
            N(i,j)= rand;            
        else
            N(i,j)= NaN;
        end
    end
end

figure
contourf(x,y,N,'LineStyle','none'), hold on;     
xlabel('X'), ylabel('Y'), axis equal; axis off; colorbar;    
line([Node(:,1);Node(1,1)],[Node(:,2);Node(1,2)],'Color',[1 1 1],'LineWidth',2.0)
clear IN i j p x y 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T11:45:04.137

假设您在六边形上定义了一个函数。然后取一些包含六边形的正方形。

一个简单的第一个测试可能是在正方形上扩展您的函数，以将值 = 0 用于六边形之外的点。

根据您的功能范围，这可能会或可能不会给您一个很好的答案。

如果这不起作用，则使用`min(min(A)))`nxn 矩阵 A 在六边形上找到函数的最小值。然后将函数定义为`min(min(A)) - 1.0`在六边形之外但在正方形中。

然后使用`contourf(x, y, z, v)`where v 是输出值的向量，所以 take`v(1) = min(min(A)) - 1.0`和`v(2:n) = linspace(min(min(A)), max(max(A)), n)`对于某个整数 n。您可能可以将关卡的颜色指定`min(min(A)) - 1.0`为白色，但我从未这样做过。我以前必须做这样的事情，并且在六边形之外设置 function = 0 就足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T07:14:17.090

如果您的函数只能在多边形区域*内*进行评估，那么我的六边形网格答案仍然有效。但是，如果您的函数可以（或修改为）在多边形*之外*进行评估，您可能需要使用作弊：

```
figure(1), clf, hold on

%# External contour, square.
x1 = [-3 -3 +3 +3 -3]/2;
y1 = [-3 +3 +3 -3 -3]/2;

%# internal contour, some polygon 
x2  = [1.0 0.5 -0.5 -1.0 -0.5 0.5];
y2 = [0 0.8660 0.8660 0 -0.8660 -0.8660];

%# convert to patches
[f, v] = poly2fv({x1, x2}, {y1, y2});
patch(...
    'Faces'    , f,...
    'Vertices' , v,...
    'FaceColor', get(0, 'defaultuicontrolbackgroundcolor'), ...
    'EdgeColor', 'none'...
    );

%# Generate function for contourplot
[x, y] = meshgrid(-2.8/2:0.1:2.8/2);
N = rand(size(x));

%# make contour plot
contourf(x,y,N,'LineStyle','none'), hold on;     
xlabel('X'), ylabel('Y'), axis equal; 
axis off; colorbar; 
```

它基本上在一个正方形区域上创建你的轮廓图，并覆盖一个带有六边形孔的蒙版，所以它*看起来*只是六边形的轮廓。我怀疑调整你的函数以允许在区域之外进行函数评估要容易得多，然后是（重新）发明某种包含边界的网格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T08:43:22.610

您正在使用方形网格对六边形区域进行采样。这确实会导致边界问题。

更好的解决方案（但仍然不是最佳）是使用[六边形网格](http://matlabdatamining.blogspot.nl/2008/04/generating-hexagonal-grids-for-fun-and.html)：

```
%# define hexagon
Node  = [ 1.0  0
          0.5  0.8660
         -0.5  0.8660
         -1.0  0
         -0.5 -0.8660
          0.5 -0.8660];

%# Generate hexagonal grid
Rad3Over2 = sqrt(3) / 2;
[x, y] = meshgrid(0:51);
n = size(y,1);
x = Rad3Over2 * x;
y = y + repmat([0 0.5],[n,n/2]);

%# re-scale to -1..1
x = 2*x/max(x(:))-1;
y = 2*y/max(y(:))-1;

%# insode-polygon check 
N = zeros(size(x));
for i=1:size(x,2)
    for j=1:size(y,2)
        p = [x(i,j) y(i,j)];
        IN = inpolygon(p(1),p(2),Node(:,1),Node(:,2));
        if IN
            N(i,j)= rand;            
        else
            N(i,j)= NaN;
        end
    end
end

%# make contour plot
figure(1)
contourf(x,y,N,'LineStyle','none'), hold on;     
xlabel('X'), ylabel('Y'), axis equal; axis off; colorbar;    
line([Node(:,1);Node(1,1)],[Node(:,2);Node(1,2)],'Color',[1 1 1],'LineWidth',2.0) 
```

如果您想要更好的覆盖范围，则必须设计一个网格来更好地覆盖您的区域和/或增加采样点的数量。

对于任意不规则区域，您可能想要尝试不规则/随机网格，其分布使得靠近边界的点多于区域中间的点。