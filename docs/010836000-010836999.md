# StackOverflow 问答 10836000-10836999

# mysql - 用不同的表格做一些相当基本的总结

> ID：10836001
> 
> 赞同：0
> 
> 时间：2012-05-31T14:52:11.100
> 
> 标签：mysql, sql

我有以下表格：

**交易**： `Transaction_ID` `Datetime` `Giver_ID` `Recipient_ID` `Points` `Category_ID` `Reason`

**奖励**： `Reward_ID` `Title` `Description` `Image_URL` `Date_Inactive` `Stock_Count` `Cost_to_User` `Cost_to_System`

**采购**：`Purchase_ID` `Datetime` `Reward_ID` `Quantity` `Student_ID` `Student_Name` `Date_DealtWith` `Date_Collected`

* * *

工作人员奖励学生*积分*，这些积分将成为*交易*表的条目，如下所示：

**`Transaction_ID` `Datetime` `Giver_ID` `Recipient_ID` `Points` `Category_ID` `Reason`**
`8` `2011-09-07` `36761` `127963` `2` `1` `Excellent behaviour in behaviour unit`

然后，学生可以购买成为*购买表条目的**奖励*，如下所示：

 ***`Purchase_ID` `Datetime` `Reward_ID` `Quantity` `Student_ID` `Student_Name` `Date_DealtWith` `Date_Collected`**
`1570` `2012-05-30 12:46:36` `2` `1` `137616` `Bradley Richardson` `NULL` `NULL`

所有*奖励*都手动存储在*奖励*数据库表中：

**`Reward_ID` `Title` `Description` `Image_URL` `Date_Inactive` `Stock_Count` `Cost_to_User` `Cost_to_System`**
`1` `Lunch Time Queue Pass (month)` `Beat the queue and get to the hot food early!` `/user/74/167976.png` `2012-04-16 11:50:00` `0` `100` `0`

* * *

我的问题是：
**给定一个 Reward_ID 和一个 Student_ID，如果学生有足够的积分来购买奖励，我可以使用什么 SQL 语句来计算？**

我以前在 PHP 中做过这个，但如果可能的话，我希望能够使用单个 SQL 语句来做到这一点。伪代码有点像`SELECT ( SumOfPointsEarned - SumOfPointsOfPurchasesMade )`，但我完全不知道该怎么做！

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:03:11.470

一种方法是使用内联视图。去做这个

*   创建一个查询获得的积分总和
*   创建一个查询所花费的积分
*   将这些查询连接在一起（一个左连接，以防他们还没有花费任何东西）
*   做你的减法

```
SELECT SumOfPointsEarned.Points - COALESCE(SumOfPointsOfPurchasesMade.Points, 0) AS CurrentPoints
FROM   
(
    SELECT SUM(Points) AS Points, Recipient_ID 
    FROM   transactions 
            WHERE Recipient_ID= 137642
    GROUP  BY Recipient_ID
) AS SumOfPointsEarned 
    LEFT JOIN 
    (
        SELECT purchases.Student_ID,  SUM(rewards.Cost_to_User) AS Points 
        FROM   purchases 
            INNER JOIN rewards 
            ON purchases.Reward_ID = rewards.Reward_ID 
                    WHERE Student_ID = 137642
        GROUP  BY purchases.Student_ID
    ) AS SumOfPointsOfPurchasesMade 
    ON SumOfPointsEarned.Recipient_ID = SumOfPointsOfPurchasesMade.Student_ID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:03:06.853

交易： Transaction_ID Datetime Giver_ID Recipient_ID Points Category_ID 原因

奖励 : Reward_ID Title Description Image_URL Date_Inactive Stock_Count Cost_to_User Cost_to_System

购买：Purchase_ID Datetime Reward_ID 数量 Student_ID Student_Name Date_DealtWith Date_Collected

* * *

SELECT SUM(a.Points) Total_Points, b.Reward_ID, b.Student_ID, b.Student_Name from transactions a inner join purchase b ON a.Student_ID = b.Student_ID;

这应该是一张表，在 points_table 中插入，然后您可以使用 WHERE Total_Points > Cost_to_User 将其加入奖励表中...*

# wordpress - wordpress 不会显示帖子

> ID：10836002
> 
> 赞同：0
> 
> 时间：2012-05-31T14:52:16.340
> 
> 标签：wordpress

我遇到的问题是我无法让 Wordpress 在我需要的地方显示帖子。

我已经尝试使用两种方法，第一种方法是在阅读设置中选择一个页面来显示不起作用的帖子。第二个是 getpost 插件，它使用短代码 [get_posts] 显示帖子，它只显示短代码并且插件处于活动状态。

我希望它看起来像这样[http://www.completesource.co.uk/category/ironkey-id-theft/](http://www.completesource.co.uk/category/ironkey-id-theft/)但在这个页面上[http://beta.completesource.co.uk/it-news/](http://beta.completesource.co.uk/it-news/)

我一直在寻找这个，任何帮助将不胜感激。

谢谢

编辑：代码

```
<?php
if (is_page() ) {
$category = get_post_meta($posts[0]->ID, 'category', true);
}
if ($category) {
$cat = get_cat_ID($category);
$paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
$post_per_page = -1; // -1 shows all posts
$do_not_show_stickies = 1; // 0 to show stickies
$args=array(
'category__in' => array($cat),
'orderby' => 'date',
'order' => 'DESC',
'paged' => $paged,
'posts_per_page' => $post_per_page,
'caller_get_posts' => $do_not_show_stickies
);
$temp = $wp_query;  // assign orginal query to temp variable for later use   
$wp_query = null;
$wp_query = new WP_Query($args); 
if( have_posts() ) : 
    while ($wp_query->have_posts()) : $wp_query->the_post(); ?>
    <div <?php post_class() ?> id="post-<?php the_ID(); ?>">
    <h2><a href="<?php the_permalink() ?>" rel="bookmark" title="Permanent Link to <?     php the_title_attribute(); ?>"><?php the_title(); ?></a></h2>
    <small><?php the_time('F jS, Y') ?> <!-- by <?php the_author() ?> --></small>
    <div class="entry">
      <?php the_excerpt('Read the rest of this entry »'); ?>
     <a href="<?php the_permalink() ?>">Read More..</a>
     <BR><BR>
    </div>

  </div>
<?php endwhile; ?>
<div class="navigation">
  <div class="alignleft"><?php next_posts_link('« Older Entries') ?></div>
  <div class="alignright"><?php previous_posts_link('Newer Entries »') ?></div>
</div>
 <?php else : ?>
    <h2 class="center">Not Found</h2>
<p class="center">Sorry, but you are looking for something that isn't here.</p>
    <?php get_search_form(); ?>
<?php endif; 
$wp_query = $temp;  //reset back to original query
  }  // if ($category)
 ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T14:59:00.077

我个人会为页面编写一个页面模板，然后创建一个新页面并使用该模板。开始阅读[页面模板](http://codex.wordpress.org/Pages#Page_Templates)并从那里开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T14:57:41.137

市场上的每个 Wordpress 主题都会以非常不同的方式处理帖子的显示。它可以非常按页面、简码、模板、设置等。

我们需要知道您正在使用什么主题才能为您提供帮助。为了帮助自己，请通过检查您的主题文档文件或主题开发人员或该主题的任何帮助论坛来研究如何激活博客。

# vba - 在具有指定名称的工作表上运行宏

> ID：10836012
> 
> 赞同：1
> 
> 时间：2012-05-31T14:52:46.873
> 
> 标签：vba, excel

我正在尝试编写一个宏，该宏将其值粘贴在某些命名工作表中的公式上，从而使它们可导出。我已经成功地让宏来复制和重命名工作表，但无法让复制/粘贴在它们上运行，因为我想要。

目前我的宏复制所有可见的工作表，除了一个指定的（“仪表板”），然后重命名它们，用“_VARIABLES”替换“（2）”。到现在为止还挺好。然后应该用值覆盖新创建的工作表中的公式；这部分不起作用。

这是整个代码：

```
Private Sub testestssss()

Dim ws As Worksheet

'Copy all visible worksheets except "Dashboard" to the end

For Each ws In Sheets

If ws.Name = "Dashboard" Then
Else
If ws.Visible Then ws.Copy after:=Worksheets(Worksheets.Count)
End If

Next

'Rename all "wk * (2)" sheets to "wk *_VARIABLES"

For Each ws In Sheets
If ws.Name Like "* (2)" Then
ws.Name = Replace(ws.Name, " (2)", "_VARIABLES")
End If
Next

'Overwrite all "wk *_VARIABLES" formulae with values

For Each ws In Sheets
If ws.Name Like "*_VARIABLES" Then
Columns("A:B").Select
Selection.Copy
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
End If
Next

End Sub 
```

因此，上述所有内容都有效，直到“用值覆盖所有“wk *_VARIABLES”公式”部分。这似乎是无效的。

任何帮助将不胜感激！

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T14:57:06.057

您继续选择活动工作表的列。这应该符合您的期望：

```
For Each ws In Sheets
    If ws.Name Like "*_VARIABLES" Then
        ws.Select
        Columns("A:B").Select
        Selection.Copy
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
                                    :=False, Transpose:=False
    End If
Next 
```

或者，您可以简单地编写此代码（无需选择，没有它们运行速度会更快）：

```
For Each ws In Sheets
    If ws.Name Like "*_VARIABLES" Then
        ws.Columns("A:B").Copy
        ws.Columns("A:B").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _
                                       SkipBlanks:=False, Transpose:=False
    End If
Next 
```

最后节省一些击键：

```
For Each ws In Sheets
    If ws.Name Like "*_VARIABLES" Then
        With ws.Columns("A:B")
            .Copy
            .PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _
                          SkipBlanks:=False, Transpose:=False
        End With
    End If
Next 
```

并且不要忘记在复制/粘贴部分之后添加以下语句：

```
Application.CutCopyMode = False 
```

保持清洁。

# google-maps - 谷歌手机地图有变化吗？

> ID：10836021
> 
> 赞同：0
> 
> 时间：2012-05-31T14:53:30.610
> 
> 标签：google-maps, jquery-mobile

我无法让谷歌地图在我的移动网站上工作[这](http://yellowgreenmedia.nl/2/contact/routeplanner.php)是我已经使用了一段时间的谷歌地图方向页面。[这](http://yellowgreenmedia.nl/2/contact/route-code.txt)是txt文件中的代码

问题是谷歌地图不再显示路线，而只是谷歌地图手机的首页。

是否有一些我不知道的变化，这曾经总是有效？

谢谢

戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T17:04:22.947

确保您的表单有一个 saddr 和一个 eaddr 字段（我的设置为隐藏）并将表单操作更改为“http://maps.google.com”，不需要“m”或“directions”，根据我猜的用户代理，它现在会弄清楚它应该采取什么行动。

然而，在移动平台上，这将在 android 上提示活动选择器或在 iPhone 上自动启动谷歌地图。

从我在游戏中看到的这一点来看，强制执行任何操作的唯一方法是使用 cURL 和 PHP 的 json_decode 函数的组合为 Google Directions API 编写自己的解析器

:\可悲的是

# deployment - Azure 部署虚拟目录

> ID：10836023
> 
> 赞同：0
> 
> 时间：2012-05-31T14:53:36.600
> 
> 标签：deployment, azure

向我的 Web 应用程序添加了一个新的 azure 部署项目，并且部署成功。

将虚拟目录添加到 ServiceDefinition.csfef 后，应用程序仍处于循环状态，因此我使用 azure 控制台删除了实例并再次成功部署并使用虚拟目录。

当我访问该网站时，我会得到一个页面：

暂停服务

http错误503服务不可用。

在分析了 Intellitrace 后得到了这个消息：

[https://picasaweb.google.com/112383217404623421937/Dropbox#5748710219235327730](https://picasaweb.google.com/112383217404623421937/Dropbox#5748710219235327730)

在事件查看器中：

警告：

属于站点“1”的应用程序“/”设置了无效的 AppPoolId“DefaultAppPool”。因此，该应用程序将被忽略。

站点 1 被禁用，因为为站点定义的根应用程序无效。有关根应用程序无效的原因的信息，请参阅前面的事件日志消息。

文件服务器资源管理器无法枚举共享路径或 DFS 路径。从本地文件路径到共享和 DFS 路径的映射可能不完整或暂时不可用。FSRM 将在稍后重试该操作。

帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T22:17:39.680

这是您分享的内容，我认为有几个问题。首先，我认为当应用程序在 Azure 上运行时，您的目录位置是正确的，或者您没有在项目中添加任何内容，这就是目录存在的原因。

```
<Site name="PT" physicalDirectory="..\RIS2048.ConsultaClick.WWWPacientes"> 
<VirtualDirectory name="images" physicalDirectory="..\RIS2048.ConsultaClick.WWWPacientes\imgpt" /> 
<Bindings> 
 <Binding name="Endpoint1" endpointName="Endpoint1" hostHeader="pt.consultaclick.com" /> 
</Bindings> 
</Site> 
```

接下来，因为您正在解析主机标头上的请求，这使得网站可以区分为应用程序，因此最好同时设置虚拟应用程序设置。

否则，您确实需要至少有两个站点并设置两个绑定。一个绑定用于您的 pt.consultaclick.com 和另一个用于任何其他剩余主机标头，否则您的站点将根据主机标头提供非常有限的请求。

我喜欢[这个博客](http://blog.elastacloud.com/2011/01/11/azure-running-multiple-web-sites-in-a-single-webrole/)，它详细地解释了这个博客，这肯定会对你有所帮助。我的这个[博客](http://blogs.msdn.com/b/avkashchauhan/archive/2011/01/01/windows-azure-how-to-define-virtual-directories-in-service-definition-csdef-for-your-site.aspx)有这方面的一些信息。

# jquery - 如何制作一个未绑定到元素的简单 jQuery 插件？

> ID：10836032
> 
> 赞同：4
> 
> 时间：2012-05-31T14:54:29.740
> 
> 标签：jquery, plugins

出于某种原因，我只能找到直接绑定到现有元素的插件示例，例如 $(selector).myPlugin();

我想要做的只是简单地调用带有选项的 new myPlugin() 。

```
new myPlugin({
    'option1': 'option 1 value',
    'option2': 'option 2 value',
    'option3': 'option 3 value',
    'option4': 'option 4 value'
}); 
```

我有一个最多有 8 个参数的常规函数​​，但我并不总是需要全部定义它们，而且我讨厌必须包含我不需要定义的所有参数的默认值。

```
function myFunction(param1, param2, param3, param4, param5, param6, param7, param8){
    // Operations here
} 
```

有时我只需要定义第一个和第五个参数或任何其他参数，其余的我需要默认值。这是一种痛苦。

也许我在搜索中错过了这样的例子。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T14:58:41.517

您可以只使用`$`命名空间来声明您的新函数并使用`$.extend()`来处理您的默认值：

```
(function($) {
    var defaults = {
       name: 'Jack',
       number: '555-jack'
    }

    $.myPlugin = function(options) {
        var settings = $.extend({}, defaults, options);

        this.someFunction = function() {
            // you can use settings here
        }
    }
}(jQuery)); 
```

我将默认值定义为私有变量（外部代码无法访问它）并在`myPlugin`构造函数中使用它。调用如何工作的示例：

```
var x = new $.myPlugin({
    number: '666-something'
}); 
```

在构造函数内部，`settings`变量包含`defaults`来自构造函数参数的名称和编号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T14:57:03.220

您可以将数组或 JSON 作为单个参数而不是单个值传递给您的函数。

# c - 编写 C 程序的网络部分

> ID：10836033
> 
> 赞同：-1
> 
> 时间：2012-05-31T14:54:32.153
> 
> 标签：c, networking, tcp

我已经开始（用 C 语言）编写一个依赖 TCP 的小型客户端/服务器应用程序。我缺乏网络编程方面的经验。我很抱歉这篇文章的开放式角色。

我想知道如何最好地编码和解码消息。我选择了以下方法：

客户端向服务器发送命令。每个命令都有一个分配给它的数字和一个结构。该结构存储命令的参数以及参数在内存中的布局方式（以及在流中）。当客户端想要发送命令时，它会用数据填充相应的结构。为了让服务器识别命令，客户端发送一个包含命令号的字节。在命令编号字节之后，消息本身被馈送到流中（其字段正确转换为网络字节顺序）。

这种方法导致了工作代码，但它需要大量冗余（我发现自己一遍又一遍地编写 switch 语句）。有没有更好的办法？标准程序是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:29:08.577

Google 的[协议缓冲区](http://code.google.com/p/protobuf/)是序列化/反序列化数据的好方法。有 C 的实现。

# ios - iOS：将 URL 分配给变量，然后在表格视图中打开 URL

> ID：10836034
> 
> 赞同：0
> 
> 时间：2012-05-31T14:54:38.850
> 
> 标签：ios, xcode, ipad, parsing

iOS 新手。

当我硬编码一个参数，将它作为一个字符串传递给 URLWithString 时，事情就起作用了：像这样 -

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
[super tableView:tableView didSelectRowAtIndexPath:indexPath];
UIApplication *ourApplication = [UIApplication sharedApplication];
NSURL *url = [NSURL URLWithString:@"http://files.parse.com/81b196c3-d103-4db1-bb6f-0c74acedfa8c/5f0718e2-a79a-454c-ae9c-082ba28a74-Kontractor_test2.pdf"];
[ourApplication openURL:url];
} 
```

但是当我尝试添加一个 object: 方法然后将一个变量传递给 URLWithString: 像这样

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath object:(PFObject *)object
{
[super tableView:tableView didSelectRowAtIndexPath:indexPath];
static NSString *CellIdentifier = @"Cell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
cell.textLabel.text = [object objectForKey:@"link"];
NSString *fileURL;
fileURL = cell.textLabel.text;
UIApplication *ourApplication = [UIApplication sharedApplication];
NSURL *url = [NSURL URLWithString:fileURL];
[ourApplication openURL:url];
} 
```

当我单击表格单元格时，模拟器不会调出浏览器。知道为什么会这样吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:54:16.990

您传递的 url 必须不受模拟器支持（电话：、本地资源等）。

# c++ - GCC 警告初始化顺序与声明顺序不匹配

> ID：10836039
> 
> 赞同：3
> 
> 时间：2012-05-31T14:54:59.427
> 
> 标签：c++, gcc, constructor

以下代码：

```
class C
{
    int a, b;
public:
    C()
    :b(0), a(0)
    {}
}; 
```

导致 GCC 抱怨初始化顺序错误。具体来说：

```
../AppSrc/MainForm.cpp: In constructor 'C::C()':
../AppSrc/MainForm.cpp:51:9: warning: 'C::b' will be initialized after
../AppSrc/MainForm.cpp:51:6: warning:   'int C::a' 
```

这里有什么大不了的，为什么抱怨？成员之间并不存在或可能存在相互依赖关系。原语，呵呵。

哦，我该如何关闭这个警告，或者至少让它不那么激进？

编辑：在 C++ 中有很多方法可以让自己陷入困境；成员相互依赖就是其中之一。我知道这一点并且无论如何我都会避免这种情况，就像我会避免空指针取消引用一样。

任意的初始化顺序可以是完全安全的，就像上面的代码片段一样。我对编译器无法识别此类情况并抱怨感到不满。我的意思是，它不会抱怨每个没有立即进行空检查的指针取消引用，是吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-31T14:57:30.450

在此特定示例中，可以安全地忽略警告。如果他们相互依赖，你就会遇到问题。您可以使用 将其关闭`-Wno-reorder`。

**但**最好重新订购它们。它可能对编译器没有影响，但您会养成按照成员出现的顺序初始化成员的习惯，这是一件好事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T00:38:03.717

> 成员之间并不存在或可能存在相互依赖关系。原语，呵呵。

嗯，除非有人改变它：

```
class C
{
  int a, b;
public:
  C()
  :b(a), a(0)
  {}
}; 
```

大多数人认为最好在问题发生*之前*得到警告，这样他们就可以修复代码。您似乎是少数想要故意留下代码缺陷并抱怨编译器的人。

> 任意的初始化顺序可以是完全安全的，就像上面的代码片段一样。

关键是初始化的顺序不是任意的，它总是按照声明成员的顺序，当我们以错误的顺序编写 mem-initializers 时，我们中的一些人希望得到警告。

> 我对编译器无法识别此类情况并抱怨感到不满。

如果您不喜欢警告将其关闭，如何做到这一点在文档中（以及较早的答案，所以您甚至不必看远;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T00:53:35.327

**这是抱怨**的一个**非常**重要的原因，有关详细信息，请参阅*Scott Myers*的书*Effective C++* Item 13 第 57 页。

 ****或者正如他在第 58 页所说的那样：

```
class Wacko {
   public:
      Wacko(const char *s): s1(s), s2(0) {}
      Wacko(const Wacko &rhs): s2(rhs.s1), s1(0) {}
   private:
      string s1, s2;
};

Wacko w1 = "Hello World!";
Wacko w2 = w1; 
```

是`w2`一样的`w1`吗？****

# jquery - jQuery JSONP 解析器错误。获取返回的数据

> ID：10836041
> 
> 赞同：2
> 
> 时间：2012-05-31T14:55:04.693
> 
> 标签：jquery, jsonp

请考虑以下 JavaScript

```
$.ajax({
    url: 'http://www.example.com/jsfunc/mycallback',
    cache: true,
    dataType: 'jsonp',
    jsonp: false, // defined by jsfunc/ argument
    jsonpCallback: "mycallback",
    timeout: 10000,
    error: function(jqXHR, textStatus, errorThrown) {
        window.console.log('JSONP Error: ' + textStatus + ' ' + errorThrown);
    },
    complete: function(jqXHR, textStatus) {
        window.console.log('JSONP was retrieved successfully');
    }
});

window.mycallback = function(data) {
    window.console.log('Callback with ' + data);
} 
```

在标准操作中，请求 URL，mycallback 命中并运行完整的函数。

我遇到的问题是 URL 有时会返回触发错误**parsererror mycallback was not called**的数据。我想记录返回的数据，显然这个数据不包含 mycallback({[...]}) 因为回调没有被触发。由于这种情况仅在负载较重的情况下偶尔发生，而且我不知道服务返回的数据是什么，所以我想记录它以便调试它。

我查看了 jqXHR.responseText 和 jqXHR.responseXML ，它们都是空的。

如果 jQuery JSONP 请求返回的数据没有调用回调，如何检索？

非常感谢，
皮特

# tsql - 试图通过非常大的调用来防止多个数据库调用

> ID：10836044
> 
> 赞同：0
> 
> 时间：2012-05-31T14:55:17.987
> 
> 标签：tsql, asp-classic

所以我们运行了一个下线报告。这聚集了登录者下线中的每个人。一些客户的人运行这个没有问题，因为它返回的记录少于 100 条。

然而，有些客户返回 4,000 - 6,000 行，这些行的信息价值约为 8 MB。实际上，我不得不提高我的开发机器上的缓冲区限制来处理大请求。

存储大量数据并帮助防止其连续运行多次的最佳方法是什么？

它可以存储在cookie中吗？会话是不可能的，因为这会占用服务器上的大量内存。

在这一点上，我几乎对任何事情都持开放态度，试图将旧流程更好地简化为更高效的流程。

现在要做的是，它加载整个记录集，它循环遍历记录集，将数据构建到 return_value 单元格中。

变成 jquery/ajax 调用会更好吗？

唯一的主要要求是：

经典的 asp jquery/javascript T-SQL

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T18:37:13.027

为什么不更改要分页的报表？阶段 1：运行整个查询，但页面仅显示基于所选页面的正确行集。现在您的响应缓冲区问题已解决。第 2 阶段：使用 Row_Number() 将分页移动到查询中，现在您的数据库使用问题已得到解决。第 3 阶段：为用户提供“显示到屏幕”（使用上述方法）或“导出到 csv”选项，您很可能可以导出所有数据，因为 csv 既美观又紧凑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T18:30:29.580

[鉴于对Web 浏览器的 cookie 密钥的最大大小是多少？](https://stackoverflow.com/q/640938/847420 "网络浏览器的 cookie 密钥的最大大小是多少？")这个问题的回答，使用 cookie 似乎是不明智的。.

我建议使用 ASP 在 Web 服务器上创建一个文件并将数据写入该文件。当用户请求报告时，您可以确定是否已经过“足够的时间”以使其值得再次运行报告，或者缓存的版本是否足够。用户的登录详细信息可能用于命名文件或 Session.SessionID，或者您可以在用户的​​会话中存储一些新内容。使用他们的登录名的好处是您的报告缓存可以存在比用户会话更长的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-13T21:52:14.717

进一步了解Brian[的回答](https://stackoverflow.com/a/10839307/491837)，查询页数，这将被`records returned / items per page`四舍五入。然后在客户端加入每个页面查询的结果。页面从查询提供的偏移量开始。现在您在客户端上拥有全部金额，而不会溢出缓冲区。它可以根据界面和用户选项进行定制（每页显示 x 个）。

# ios - 如何从数据库中在导航栏上显示标题

> ID：10836046
> 
> 赞同：0
> 
> 时间：2012-05-31T14:55:34.640
> 
> 标签：ios, database, xcode, title, navigationbar

真的感谢大家在我的第一个问题中的回答。

现在我喜欢做一些我认为简单的事情，但我尝试了几天，但我最终还是做不到。

我继续使用第一个问题的同一个项目 www.raywenderlich.com/913/sqlite-101-for-iphone-developers-making-our-app

请看这张图片。

[http://d1xzuxjlafny7l.cloudfront.net/wp-content/uploads/2010/04/FailedBanksTableView.jpg](http://d1xzuxjlafny7l.cloudfront.net/wp-content/uploads/2010/04/FailedBanksTableView.jpg)

在这里，我们在 ListView 的导航栏上看到“失败的银行”。我知道如何更改该标题，但我喜欢在 DetailView 的导航栏上显示银行名称。

看到这张图片。例如，我喜欢在导航栏上显示“McIntosh Commercial Bank”。

[http://d1xzuxjlafny7l.cloudfront.net/wp-content/uploads/2010/04/DetailView.jpg](http://d1xzuxjlafny7l.cloudfront.net/wp-content/uploads/2010/04/DetailView.jpg)

我认为这并不复杂，但我还不能解决它。

也许你能解释一下怎么做或者告诉我代码必须是怎样的。

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T14:58:37.273

只需在“viewDidLoad”中执行以下操作（或将其放在您从数据库中获得标题的位置）：

```
self.title = @"McIntosh Commercial Bank"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:11:53.473

由于您的 DetailView 控制器由 UINavigationController 管理，因此您需要设置`title`DetailView 的 UINavigationItem 的属性，以便它显示在顶部导航栏中，如下所示：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    self.navigationItem.title = @"McIntosh Commercial Bank";
} 
```

# apache - 在 VPS 上使用 VirtualHost 指令

> ID：10836050
> 
> 赞同：0
> 
> 时间：2012-05-31T14:55:37.387
> 
> 标签：apache, .htaccess, virtualhost

我试图弄清楚为什么我不能在我客户的 VPS 主机帐户上使用 VirtualHost 指令。无论我如何定义指令，我总是会收到 500 内部服务器错误。

我厌倦了向托管公司寻求帮助，他们回答说您的帐户启用了“mod_rewrite”。不是很有帮助。

这与它是虚拟专用服务器有关吗？

这是我正在使用的：

```
##Start Virtual Host

NameVirtualHost x.x.x.x

<VirtualHost x.x.x.x>

##Define Rewrite Map
RewriteMap categorymap txt: categorymap.txt
RewriteMap rangemap txt: rangemap.txt

</VirtualHost>

##End Virtual Host 
```

非常感谢任何见解或帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:05:51.350

尝试输入一个简单的重写规则而不是 RewriteMAP 并测试

不确定是否会导致问题，但删除 txt: 后的空格，即：

```
RewriteMap categorymap txt:categorymap.txt 
```

# sql - Sql server：内部工作

> ID：10836051
> 
> 赞同：0
> 
> 时间：2012-05-31T14:55:38.053
> 
> 标签：sql, sql-server, time-complexity

其中一些可能没有什么意义，但是：

1.  Sql 代码解释或编译（和什么）？
2.  连接翻译成什么 - 我的意思是一些循环或什么？
3.  算法复杂性分析是否适用于查询，例如是否可以编写非常糟糕的选择 - 时间按选择的行数呈指数增长？如果是这样，如何分析查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T14:58:00.127

通过阅读 Itzik Ben-Gan 的一本书，你会得到很多这样的答案。他详细介绍了您提到的这些主题。

[http://tsql.solidq.com/books/index.htm](http://tsql.solidq.com/books/index.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:07:07.403

嗯......很笼统的问题，所以一些非常笼统的答案

1) Sql 代码解释或编译（和什么）？

SQL 代码被编译到执行计划中。

2）连接翻译成什么 - 我的意思是一些循环或什么？

取决于加入和你加入的表（据我所知）。SQL Server 有一些连接原语（散列连接、嵌套循环连接），根据您的 sql 代码中涉及的对象，查询优化器会尝试选择最佳选项。

3) 不是真的算法复杂性分析是否适用于查询，例如是否可以编写非常糟糕的选择 - 选择的行数在时间上呈指数增长？如果是这样，如何分析查询？

不太清楚，你的意思是什么。但是在某些情况下，您可以做一些非常糟糕的事情，例如使用

```
SELECT TOP 1 col FROM Table ORDER BY col DESC 
```

在没有 col 索引的表上找到 col 的最大值而不是

```
SELECT MAX(col)  FROM Table 
```

您应该阅读 SQL Server 内部系列中的部分/全部书籍。它们非常出色，非常详细地涵盖了许多事物。

# jquery - JQuery，当div向下滑动时如何使页面滚动以便您可以看到它

> ID：10836052
> 
> 赞同：0
> 
> 时间：2012-05-31T14:55:38.537
> 
> 标签：jquery

我有一些 jquery 代码可以从动态数据列表中打开页面上的隐藏 div，问题是如果您从页面下方单击一行，它会打开页面底部下方的 div，您必须向下滚动到看到它，有没有办法设置某种锚或让 jqyer 在打开时滚动到 div 的底部以便用户可以看到它？

这是我的代码：

```
//CHECK IF ROW IS VISIABLE
if (!$('#'+rowid).is(':visible')) {
//HIDE ANY OPEN ROWS
$("#tableToggle tr.toggleable").fadeOut('fast', function() { });
//DO SLIDE LOAD FUNCTION
$('#'+rowid).slideDown('slow', function() { });
$("#einfo"+rowid).load(url, function(response, status, xhr) {
if (status == "success") { $("#loader"+rowid).hide(); $('#einfo'+rowid).slideDown('slow'); } });
//HIDE ALL TOGGLEABLE ROWS
}else { $("#tableToggle tr.toggleable").fadeOut('fast', function() { });} 
```

感谢关注，希望能帮到你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:04:44.380

您可以滚动到有问题的 div，使用`$('html').scrollTop()`它可以将窗口的滚动条调整到正确的位置。要确定正确的高度，请获取目标元素的 scrollTop() 属性。

示例代码可能如下所示：

```
$('html').scrollTop($('#myDivContainer').scrollTop()); // Scroll to desired element 
```

此外，您可以使用 jQuery 的 animate 函数进行更平滑的过渡：

```
$('html').animate({ scrollTop: $('#myDivContainer').scrollTop() }, 2000); // Animated scroll over 2 seconds 
```

请注意，这`.scrollTop`将对样式元素返回零`display:none`，因此请务必在取消隐藏容器后触发此代码。

# git - 子模块未在 Windows 上正确签出

> ID：10836053
> 
> 赞同：1
> 
> 时间：2012-05-31T14:55:41.640
> 
> 标签：git, github

我在 github 上有一个存储库：

`git@github.com:daviddoria/InteractiveImageGraphCutSegmentation.git`

它有几个子模块。当我克隆它（在 linux 上）然后执行`'git submodule update --init --recursive'`时，一切正常。

但是，我的一个朋友在 windows 上得到一个错误：

```
"fatal: Not a git repository: ../../../../..//d/Repo/InteractiveImageGraphCutSegm" . 
```

有谁知道会导致什么？我尝试将子模块 URL (in `.gitmodules`) 更改为所有不同的协议，但错误仍然存​​在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T09:24:47.563

路径不对？这么多级别的“../”。这不能存在于 github 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-09T12:47:13.730

这实际上是 msysgit 中的一个错误。我相信它已经在master中修复了。

# android - 使用http在android上调用我的apache webservice

> ID：10836054
> 
> 赞同：0
> 
> 时间：2012-05-31T14:55:42.513
> 
> 标签：android, database, web-services, http, servlets

我正在开发一个 android 应用程序，它允许用户通过我的 tomcat 网络服务在数据库上创建帐户。我已经用浏览器测试了 web 服务，它工作正常。因此，我尝试使用我的安卓应用程序对该 URL 发出 Http 请求，但它不起作用。

这是我的代码

```
try{

        HttpClient client = new DefaultHttpClient();
        HttpGet request = new HttpGet();
        URI webservice = new URI("http://my-machine-ip:8080/Login/login?username=jimmy&password=javajava");
        request.setURI(webservice);
        HttpResponse response = client.execute(request);            
    }catch (Exception e1) {
        e1.printStackTrace();
    } 
```

我还设置了互联网权限。`<uses-permission android:name="android.permission.INTERNET" />`

检查我的日志我有一个连接错误

```
05-31 17:46:50.299: W/System.err(17395): org.apache.http.conn.ConnectTimeoutException: Connect to /192.168.0.3:8080 timed out

enter code here 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:09:13.627

使用您的响应对象获取`getEntity().getStatusLine()`然后获取`getStatusCode()`和`getReasonPhrase()`。

检查状态是`200`，原因是`OK`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T09:27:07.607

显然，这是一个连接问题导致我的防火墙。快速重新配置可访问防火墙的应用程序已经解决了所有问题

# java - 为什么 Java 7 中的 switch 语句比 String 的 if else 更快？

> ID：10836055
> 
> 赞同：18
> 
> 时间：2012-05-31T14:55:46.257
> 
> 标签：java, if-statement, switch-statement, java-7

在**Java 7**中，`string`对象可以在`switch`语句的表达式中。[有人可以从官方文档](https://docs.oracle.com/javase/7/docs/technotes/guides/language/strings-switch.html)中解释以下声明吗？

> **Java 编译器从使用String 对象**的 switch 语句生成的字节码通常比从链式 if-then-else 语句生成的字节码更有效。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-31T15:38:03.130

## Java 代码

有两个版本的类，例如

与`if-then-else`：

```
public class IfThenElseClass {
    public static void main(String[] args) {
        String str = "C";
        if ("A".equals(str)) {

        } else if ("B".equals(str)) {

        } else if ("C".equals(str)) {

        }
    }
} 
```

与`switch`：

```
public class SwitchClass {
    public static void main(String[] args) {
        String str = "C";
        switch (str) {
            case "A":
                break;
            case "B":
                break;
            case "C":
                break;
        }
    }
} 
```

## 字节码

让我们看一下字节码。获取`if-then-else`版本的字节码：

```
Compiled from "CompileSwitch.java"
public class CompileSwitch {
  public CompileSwitch();
    Code:
       0: aload_0
       1: invokespecial #8  // Method java/lang/Object."<init>":()V
       4: return

  public static void main(java.lang.String[]);
    Code:
       0: ldc           #16 // String C
       2: astore_1
       3: ldc           #18 // String A
       5: aload_1
       6: invokevirtual #20 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
       9: ifne          28
      12: ldc           #26 // String B
      14: aload_1
      15: invokevirtual #20 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      18: ifne          28
      21: ldc           #16 // String C
      23: aload_1
      24: invokevirtual #20 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      27: pop
      28: return
} 
```

获取`switch`版本的字节码：

```
Compiled from "CompileSwitch.java"
public class CompileSwitch {
  public CompileSwitch();
    Code:
       0: aload_0
       1: invokespecial #8 // Method java/lang/Object."<init>":()V
       4: return

  public static void main(java.lang.String[]);
    Code:
       0: ldc           #16 // String C
       2: astore_1
       3: aload_1
       4: dup
       5: astore_2
       6: invokevirtual #18 // Method java/lang/String.hashCode:()I
       9: lookupswitch  { // 3
                    65: 44
                    66: 56
                    67: 68
               default: 77
          }
      44: aload_2
      45: ldc           #24 // String A
      47: invokevirtual #26 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      50: ifne          77
      53: goto          77
      56: aload_2
      57: ldc           #30 // String B
      59: invokevirtual #26 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      62: ifne          77
      65: goto          77
      68: aload_2
      69: ldc           #16 // String C
      71: invokevirtual #26 // Method java/lang/String.equals:(Ljava/lang/Object;)Z
      74: ifne          77
      77: return
} 
```

### 结论

*   在第一个版本中，通过调用`equals`每个条件的方法来比较字符串，直到找到它。

*   在第二个版本中获得第一个`hashCode`字符串。然后将其与 <code>hashCode each 的值进行比较`case`。见`lookupswitch`。如果这些值中的任何一个重复，则恰好运行`case`. 否则，调用`equals`绑定案例的方法。这比`equals`仅调用该方法要快得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T15:02:20.097

`switch`on strings 可能更快，原因与在字符串哈希集中查找可能比在字符串列表中查找更快的原因相同：您可以在 in`O(1)`而不是 in 中查找`O(N)`，其中`N`是字符串的数量。

回想一下，这`switch`比`if-then-else`语句链更有效，因为它是计算跳转：根据值计算代码中的偏移量，然后执行到该偏移量的跳转。Java 可以使用类似于哈希映射和哈希集的机制来对字符串进行类似的技巧。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T15:00:03.460

它更有效，例如：

```
switch(yourString) {
    case "text1":
        // your code
        break;
    case "text2":
        // etc.
} 
```

比记者：

```
if (yourString.equals("text1")) {
     // your code
} else if (yourString.equals("text2")) {
     // etc.
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-31T15:01:37.147

我猜这意味着什么，或者我理解的是，使用字符串从 switch 语句创建的字节码（当你编译你的 java 类时）比使用字符串从 if-else 语句创建的字节码更快、更有效。两者都可以做同样的工作，位开关显然更有效。

```
switch (str) {
            case "A":  
                     // do something
                     break;
            case "B":
                     // do something
                     break;
            default: 
                     //do something
                     break;
} 
```

好于

```
if(str.equals("A")) {
//do something
} else if(str-equals("B")) {
//do something
} else {
//do something
} 
```

# powershell - 按 GUID 获取分发列表

> ID：10836056
> 
> 赞同：0
> 
> 时间：2012-05-31T14:55:51.170
> 
> 标签：powershell, active-directory, exchange-server, exchange-server-2010

我必须`Distributionlist`通过使用 powershell 来获得 Exchange。我对列表的唯一了解是`GUID`. 所以我尝试了以下方法：

```
function GroupGetName([string]$ADGuid)
{
$DISGR = Get-DistributionGroup -filter { Guid -like $ADGuid}
$DISGR
} 
```

但它不起作用（我认为“Guid”是 powershell 的内部名称）

有谁知道如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:47:04.390

尝试使用 -match 运算符而不是 -like。如果您将部分字符串传递给 -like，它将期望通配符填充其余部分。

```
'asdf' -like 'a' # result: false
'asdf' -match 'a' # result: true 
```

要进行测试，请在没有 -Filter 的情况下运行 Get-DistributionGroup，并检查其中一个返回对象的 GUID 属性。这应该让您了解您正在寻找的房产价值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T20:26:41.887

`Get-DistributionGroup $ADGuid`应该足够了。根据文档 (http://technet.microsoft.com/en-us/library/bb124755.aspx)，objectGuid 是`Identity`参数的有效输入。

# silverlight - 如何将 SL4 中 MessageBox 的按钮文本从 OK/CANCEL 更改为 YES/NO？

> ID：10836059
> 
> 赞同：1
> 
> 时间：2012-05-31T14:56:04.073
> 
> 标签：silverlight, silverlight-4.0

SL 4 通过 MessageBox 提供了一个对话框，但 MessageBoxButton 只提供了按钮的选项，如确定、取消。如何将其更改为 YES、NO 按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:11:53.610

Silverlight 中内置的这个 MessageBox 不能在公开的功能之外进行更改。

您唯一的解决方案是制作一个自定义 ChildWindow 类，它提供您想要的功能。这[方面](https://stackoverflow.com/questions/5458282/custom-styled-messagebox-in-silverlight)的[例子](http://community.devexpress.com/blogs/theonewith/archive/2008/08/06/custom-silverlight-controls-creating-a-reusable-messagebox-dialog-part-i.aspx)[很多](http://www.codeproject.com/Articles/42477/Custom-MessageBox-Control-for-Silverlight-3) 。

这具有更像其他silverlight弹出窗口的优点，并且可以根据您的喜好设置主题和皮肤，无论您选择实现什么按钮和功能。

这样做的缺点是您被迫使用回调模型而不是更常见的命令式流控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:12:27.717

你最好的选择是使用`System.Windows.Controls.Primitives.Popup`

```
<Grid x:Name="LayoutRoot" Background="White">
    <Button x:Name="showPopup"  Click="showPopup_Click" Height="100" Width="100" Content="Show Popup"/>
    <Popup x:Name="myPopup" IsOpen="False" VerticalAlignment="Top" HorizontalAlignment="Center" >
        <Canvas  Height="200" Width="300" Background="Azure">
            <Button x:Name="closePopup" Click="closePopup_Click" Height="50" Width="100" Content="Close Popup"/>
        </Canvas>
    </Popup>
    <Canvas x:Name="myCanvas" Visibility="Collapsed" Background="Black"  Opacity=".4"></Canvas>
</Grid>

public partial class Page : UserControl
    {
        public Page()
        {
            InitializeComponent();
        }

        private void closePopup_Click(object sender, RoutedEventArgs e)
        {
            myPopup.IsOpen = false;
            myCanvas.Visibility = Visibility.Collapsed;
        }

        private void showPopup_Click(object sender, RoutedEventArgs e)
        {
            myPopup.IsOpen = true;
            myCanvas.Visibility = Visibility.Visible;
        }
    } 
```

如果您不想创建自己的弹出窗口，则可能有 3rd 方消息框，但使用此解决方案，您可以掌控一切。

# python - 如何使 wxpython 密码 textctrl 显示字符？

> ID：10836062
> 
> 赞同：4
> 
> 时间：2012-05-31T14:56:09.437
> 
> 标签：python, user-interface, wxpython

使用 wxPython 可以将密码字段创建为：

`wx.TextCtrl(frm, -1, '', style=wx.TE_PASSWORD )`

我想知道是否有办法将此密码字段动态更改为普通的 textctrl，以便用户可以看到密码是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T16:08:57.087

创建控件后无法更改样式标志。

您可以销毁控件并在没有密码标志的情况下创建一个新控件，或者在 sizer 中并排保持两个控件，其中一个始终隐藏。当您想要切换时，您可以将文本复制到另一个文本控件中，隐藏一个并显示另一个，然后在 sizer 上调用 Layout。

```
import wx

class Frame(wx.Frame):
    def __init__(self,*args,**kwargs):
        wx.Frame.__init__(self,*args,**kwargs)
        panel= wx.Panel(self)
        self.password_shown= False

        sizer= wx.BoxSizer(wx.VERTICAL)
        self.password_sizer= wx.BoxSizer(wx.HORIZONTAL)
        self.text_password= wx.TextCtrl(panel,style=wx.TE_PASSWORD)
        self.password_sizer.Add(self.text_password,0,wx.ALL,5)
        self.text_no_password= wx.TextCtrl(panel)
        self.text_no_password.Hide()
        self.password_sizer.Add(self.text_no_password,0,wx.ALL,5)
        sizer.Add(self.password_sizer)
        self.button= wx.Button(panel,-1,"Toggle Password")
        sizer.Add(self.button,0,wx.ALL,5)
        self.button.Bind(wx.EVT_BUTTON,self.OnButton)
        panel.SetSizer(sizer)

        self.Show()

    def OnButton(self,event):
        self.text_password.Show(self.password_shown)
        self.text_no_password.Show(not self.password_shown)
        if not self.password_shown:
            self.text_no_password.SetValue(self.text_password.GetValue())
            self.text_no_password.SetFocus()
        else:
            self.text_password.SetValue(self.text_no_password.GetValue())
            self.text_password.SetFocus()
        self.text_password.GetParent().Layout()
        self.password_shown= not self.password_shown

if __name__ == "__main__":
    app= wx.App(0)
    Frame(None)
    app.MainLoop() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T16:11:43.427

我不知道在创建后动态更改文本控件小部件上的样式标志的方法。有些小部件在某些操作系统上允许这种事情，而有些则不允许。您可以在正常模式下创建两个文本控件，第二个控件并将其隐藏。然后，当您想要切换时，您获取受密码保护版本的值并将其隐藏，将值赋予正常版本并显示它。您可能还需要在最后调用 Layout() 。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-31T15:23:35.813

那么它就不是密码条目，但您可以使用 style=wx.TE_MULTILINE 或 TE_RICH。如果那是你要问的。

希望这可以帮助

# c# - 封闭对象嵌套模型的元数据

> ID：10836063
> 
> 赞同：0
> 
> 时间：2012-05-31T14:56:12.753
> 
> 标签：c#, .net, asp.net-mvc-3, validation, metadata

我想为嵌套对象提供元数据，有问题的对象对我关闭，所以我不能直接添加 [Required] 属性。我添加了第一级属性，但我似乎无法使用验证元数据获得嵌套级属性。这在 MVC3 中不支持吗？

```
[MetadataType(typeof(Meta))]
public sealed class EditModel
{
    public Employee {get;set;}

    internal sealed class Meta
    {
        [Required]
        // this is not valid syntax but hopefully shows what I am after
        public object Employee.Username { get; set; }   
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T14:58:04.833

> 我错过了什么？

[FluentValidation.NET](http://fluentvalidation.codeplex.com/)及其[与 ASP.NET MVC 的出色集成](http://fluentvalidation.codeplex.com/wikipage?title=mvc&referringTitle=Documentation)。您缺少的另一件重要的事情是视图模型。

# javascript - anObject.prototype.constructor 做了什么？

> ID：10836064
> 
> 赞同：1
> 
> 时间：2012-05-31T14:56:16.030
> 
> 标签：javascript

假设我们有这个构造函数：

```
var Foo = function(){
   this.x = "y";
} 
```

`Foo`并`Foo.prototype.constructor`评估相同的功能，但`Foo.prototype.constructor = function(){this.x="z"}`似乎并没有改变`new Foo()`. 然而，它确实改变了结果

```
var i = new Foo();
i.constructor; // evals to function (){this.x = "z"} 
```

这里发生了什么？我不打算*将*它用于任何事情，我只是对这种语言感到好奇。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:01:37.287

`constructor`函数属性的属性`prototype`是指指向函数，以便您可以询问对象是什么构造了它。它是作为创建函数对象的一部分自动设置的（请参阅规范的[第 13.2 节[或](http://ecma-international.org/ecma-262/5.1/#sec-13.2)[此处](https://tc39.es/ecma262/#sec-makeconstructor)获取更新的版本]。）如您所见，您可以根据需要覆盖`constructor`属性`Foo.prototype`，改变它，但默认情况下这就是它的用途。多年来，JavaScript 规范只说该`constructor`属性将存在并具有给定的默认值（`function Foo() { }`这意味着默认情况下`Foo.prototype.constructor`是`Foo`.）。但是从 ES2015 开始，情况发生了变化，规范中的各种操作现在实际上都使用了该`constructor`属性，例如[这里](https://tc39.es/ecma262/#sec-speciesconstructor)，[这里](https://tc39.es/ecma262/#sec-arrayspeciescreate)，[这里](https://tc39.es/ecma262/#sec-regexp-pattern-flags)，[这里](https://tc39.es/ecma262/#sec-promise-resolve)。

（请注意，以下内容是在`class`添加 ES2015 的功能之前编写的。以下是在 ES5 及更早版本中如何执行此操作。在 ES2015+ 中，如果您正在执行构造函数和继承层次结构，则没有充分的理由执行以下操作；只需使用`class`。[如果你不使用构造函数来构建继承层次结构——你不必这样做，在 JavaScript 中还有其他方法可以做到——你不会执行以下操作*或*使用`class`.]）

有一个很好的理由可以覆盖它，这与继承有关。假设您想要一个`Base`构造函数来创建基础对象，以及`Derived`创建派生对象的构造函数，该构造函数`Base`具有`Derived`. 您看到完成的通常（尽管在我看来不是理想的）方式（缺少帮助脚本）是：

```
function Base() {
}
Base.prototype.foo = function() {
    console.log("I'm Base#foo");
};

function Derived() {
}
Derived.prototype = new Base(); // So we get all the `Base` stuff
Derived.prototype.bar = function() {
    console.log("I'm Derived#bar");
};

var d = new Derived();
d.foo(); // "I'm Base#foo"
d.bar(); // "I'm Derived#bar" 
```

问题是现在，`d.constructor === Base`而不是`Derived`. 所以能够解决这个问题很重要：

```
...
Derived.prototype = new Base();                           // So we get all the `Base` stuff
Object.defineProperty(Derived.prototype, "constructor", { // Fix up
    value: Derived,
    writable: true,
    configurable: true
});
... 
```

（旁注：所有这些管道——以及围绕超级调用的复杂性——是 ES2015+ 具有`class`语法的原因。）

* * *

请注意，上述内容并不是设置继承层次结构的理想方式。这是您通常看到的，但正如我上面所说，并不理想。为了完整起见，在仅限于 ES5 语法的环境中，这样会更好：

```
function Base() {
}
Base.prototype.foo = function() {
    console.log("I'm Base#foo");
};

function Derived() {
    Base.call(this); // So Base sets up its stuff
}
Derived.prototype = Object.create(Base.prototype); // So we get all the `Base` stuff
Object.defineProperty(Derived.prototype, "constructor", {
    value: Derived,
    writable: true,
    configurable: true
});
Derived.prototype.bar = function() {
    console.log("I'm Derived#bar");
};

var d = new Derived();
d.foo(); // "I'm Base#foo"
d.bar(); // "I'm Derived#bar" 
```

...在 ES5 之前的环境中，您将 shim/polyfill 用于`Object.create`. 但同样，我不直接这样做（也不推荐这样做），我使用帮助脚本，所以它是声明性的和可重复的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T15:01:50.060

`.prototype.constructor`只是一个辅助属性，以便创建的对象可以轻松地引用构造函数`this.constructor`，或者在您的情况下`i.constructor`。

将其任意设置为其他内容不会产生任何影响，除非代码期望通过以下方式获取对象的构造函数`obj.constructor`：

```
if( obj.constructor === Foo ) {
 //It's a Foo
} 
```

因此，保留它是一个很好的约定。

es5shim依赖于[shim](https://github.com/kriskowal/es5-shim/blob/master/es5-shim.js)`.constructor.prototype``Object.getPrototypeOf`

# android - 无法追踪的 AsyncTask 错误

> ID：10836070
> 
> 赞同：0
> 
> 时间：2012-05-31T14:56:28.673
> 
> 标签：android, android-asynctask

我有一个在多个活动中使用 AsyncTask 的实时应用程序，并且出现了无法追踪的错误（如下）。*我的用户发送到 Google Play 的bto.org.monitoring.birdtrack.ce.doInBackground(Unknown Source)*的关键行（当然没有消息）不允许我调试这个问题，所以我不能找到合适的代码没关系在此处发布。有任何想法吗？

```
java.lang.RuntimeException: An error occured while executing doInBackground()
at android.os.AsyncTask$3.done(AsyncTask.java:200)
at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:274)
at java.util.concurrent.FutureTask.setException(FutureTask.java:125)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:308)
at java.util.concurrent.FutureTask.run(FutureTask.java:138)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
at java.lang.Thread.run(Thread.java:1019)
Caused by: java.lang.NullPointerException
at bto.org.monitoring.birdtrack.ce.doInBackground(Unknown Source)
at android.os.AsyncTask$2.call(AsyncTask.java:185)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:306)
... 4 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T14:46:17.667

好的，现在猜到了。我正在使用 Proguard，并且可以通过抓取错误并将其运行通过 using 来检测 doInBackground() 方法的位置：

```
retrace.sh -verbose myApp/proguard/mapping.txt myErrorFile.txt 
```

这会将错误转换为显示导致它的类。万岁！

# php - 函数内部的mysqli / mysql查询不起作用

> ID：10836078
> 
> 赞同：12
> 
> 时间：2012-05-31T14:56:53.823
> 
> 标签：php, mysql, function, mysqli

我正在尝试为我的网站构建一些功能，其中一些功能包括从 mysql 数据库中获取数据。当我在函数之外测试代码时，它似乎工作正常。所以这里是第一页：

```
require('db.php');
require('functions.php');

$email = 'sample@gmail.com';

if (user_exists($email) == true){
 echo "Good news, this exists";
} 
```

现在 db.php ：

```
$db = new MySQLi("localhost","test","test","test");
if ($db->connect_errno){
    echo "$db->connect_errno";
} 
```

和functions.php文件：

```
function sanitize ($data){
    $db->mysqli_real_escape_string($data);
}
function user_exists($usermail){
    $usermail = sanitize($usermail);
    $query = $db->query("SELECT COUNT(userId) FROM users WHERE userEmail= '$usermail' ");
    $check = $query->num_rows;
    return ($check == 1) ? true : false;
} 
```

我在访问第一个文件时遇到的错误是：

```
Notice: Undefined variable: db in C:\xampp\htdocs\auctior\inc\functions.php on line 6

Fatal error: Call to a member function query() on a non-object in C:\xampp\htdocs\auctior\inc\functions.php on line 6 
```

所以我需要/包含了 db.php，其中 $db 是 mysqli 连接。在同一个文件（第一个文件）中，我调用位于 functions.php 的函数

提前谢谢你，我会很感激你的帮助，因为这让我很生气......

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-31T14:59:29.467

您可能需要使用`global`关键字，否则`$db`在本地范围内被视为 var。

```
function sanitize ($data){
    global $db;
    $db->mysqli_real_escape_string($data);
}

function user_exists($usermail){
    global $db;
    $usermail = sanitize($usermail);
    $query = $db->query("SELECT COUNT(userId) FROM users WHERE userEmail= '$usermail' ");
    $check = $query->num_rows;
    return ($check == 1) ? true : false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:00:33.990

尝试在函数内部进行连接，在包含函数之前需要包含连接。

像这样的东西：

```
function user_exists($usermail){
    $db = new MySQLi("localhost","test","test","test");
    $usermail = sanitize($usermail);
    $query = $db->query("SELECT COUNT(userId) FROM users WHERE userEmail= '$usermail' ");
    $check = $query->num_rows;
    return ($check == 1) ? true : false;
} 
```

# c# - Taped 事件处理程序

> ID：10836079
> 
> 赞同：0
> 
> 时间：2012-05-31T14:56:55.510
> 
> 标签：c#, windows-8, windows-runtime

如何检测文本框是否已被点击。用户通常会在输入内容之前点击文本框。我试过 textbox.tapped = true , .selected ，它不适用于 WinRT/Windows 8 Metro 应用程序。有人可以帮我吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:13:30.507

它不能更简单。正如 dotNetNin​​ja 所说，您必须注册 Tapped 活动。示例如下，请注意xaml 代码和后面的 cs 代码中的**TextBox_Tapped方法。**

.xaml 代码：

```
<Page x:Class="TappedEventExample.BlankPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:TappedEventExample"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
    <Grid Background="{StaticResource ApplicationPageBackgroundBrush}">
        <TextBox
            x:Name="MyTextBox"
            HorizontalAlignment="Left"
            Margin="100,100,0,0"
            TextWrapping="Wrap"
            Text="My TextBox"
            VerticalAlignment="Top"
            Height="100" Width="200"
            Tapped="TextBox_Tapped"/>
    </Grid>
</Page> 
```

.xaml.cs 代码：

```
public sealed partial class BlankPage : Page
{
    public BlankPage()
    {
        this.InitializeComponent();
    }

    /// <summary>
    /// Invoked when this page is about to be displayed in a Frame.
    /// </summary>
    /// <param name="e">Event data that describes how this page was reached.  The Parameter
    /// property is typically used to configure the page.</param>
    protected override void OnNavigatedTo(NavigationEventArgs e)
    {
    }

    private void TextBox_Tapped(object sender, TappedRoutedEventArgs e)
    {
        this.MyTextBox.Text = "I was tapped.";
    }
} 
```

就这样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:05:12.063

您应该能够订阅控件的点击事件。这是[这里的文件](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.uielement.tapped)

# php - foreach 正在发挥作用

> ID：10836086
> 
> 赞同：0
> 
> 时间：2012-05-31T14:57:29.330
> 
> 标签：php, arrays, codeigniter

我有两个数组：

$item 日期基本上是这样的：

```
Array ( 
    [0] => 2012-05-28 
    [1] => 2012-05-29 
    [2] => 2012-05-30 
    [3] => 2012-05-31 
    [4] => 2012-06-01 
) 
```

`$m['details']`看起来像这样：

```
Array (
    [details] => Array (
        [0] => Array (
            [Id] => 20003
            [MTimeInt] => 0
            [Date] => 2012-05-28
            [Name] => item
        )
        [1] => Array (
            [Id] => 20004
            [MTimeInt] => 1
            [Date] => 2012-05-29
            [Name] => item2
        )
        [2] => Array (
            [Id] => 20005
            [MealTimeInt] => 0
            [Date] => 2012-05-29
            [Name] => item3
        )
    )
)

//start of main bit
<?php foreach($m['details'] as $item) { ?>
<?php if($item['MTimeInt'] == 0 && $item['Date'] == $itemDates[0]) { ?> 
<?php echo $item['Name']; ?> <br>
<?php } ?>
<?php if($item['MTimeInt'] == 0 && $item['Date'] == $itemDates[1]) { ?> 
<?php echo $item['Name']; ?>
<?php } ?>
<?php } ?> 
```

我遇到的问题是 foreach 循环在迭代一次后中断。当 if 语句完成后，它应该继续循环（通过移动到列表中的下一个索引/项目），直到所有项目都被检查。

我之前使用了一个while循环，但没有取得多大成功。

知道为什么会这样吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:01:24.737

如果您显示的代码是正确的，那么在 $m['details'] 内还有另一个 ['details']，它可以解释单次迭代。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:03:02.010

只有`$m['details']`一个元素，仔细看。

也许想要你迭代`$m['details']['details']`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:05:37.773

您正在对单个数组项调用 foreach 。如果您单独在 $m 上调用它并用 if 分隔您需要的项目，您应该会看到会发生什么。当我使用电脑时，我会正确扩展我的答案

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T15:06:46.820

您没有遍历正确的数组，在您的情况下，数组中只有一项，请尝试使用 $m['details']['details']

# sql-server - 如何根据 XML 参数更新表

> ID：10836092
> 
> 赞同：2
> 
> 时间：2012-05-31T14:57:41.090
> 
> 标签：sql-server, xml, sql-server-2008, tsql

我有一个表，我想根据 XML 参数中的值更新它的一个 varchar 字段。

我有下表：

```
ID  Constraint_Value
1   (OldVal_1) (OldVal_2)
2   (OldVal_2) (OldVal_1) 
```

我想使用以下 XML 来更新该`Constraint_Value`字段：

```
<qaUpdates>
    <qaUpdate><old>OldVal_1</old><new>NewVal_1</new></qaUpdate>
    <qaUpdate><old>OldVal_2</old><new>NewVal_2</new></qaUpdate>
</qaUpdates> 
```

更新后，我的目标是：

```
ID    Constraint_Value
1     (NewVal_1) (NewVal_2)
2     (NewVal_2) (NewVal_1) 
```

以下 SQL 说明了我的问题（无需任何设置即可在 SQL Management Studio 中运行）：

```
IF OBJECT_ID('tempdb..#tmpConstraint') IS NOT NULL DROP TABLE #tmpConstraint
GO 

CREATE TABLE tempdb..#tmpConstraint ( constraint_id INT PRIMARY KEY, constraint_value varchar(256) )
GO

insert into #tmpConstraint
values (1, '(OldVal_1) (OldVal_2)')

insert into #tmpConstraint
values (2, '(OldVal_2) (OldVal_1)')

select * from #tmpConstraint

declare @myXML XML
set @myXML = N'<qaUpdates>
    <qaUpdate><old>OldVal_1</old><new>NewVal_1</new></qaUpdate>
    <qaUpdate><old>OldVal_2</old><new>NewVal_2</new></qaUpdate>
</qaUpdates>'

update c
set constraint_value = REPLACE(constraint_value, Child.value('(old)[1]', 'varchar(50)'), Child.value('(new)[1]', 'varchar(50)'))
from #tmpConstraint c
cross join @myXML.nodes('/qaUpdates/qaUpdate') as N(Child) 

select * from #tmpConstraint 
```

这给出了结果：

```
(Before)
1   (OldVal_1) (OldVal_2)
2   (OldVal_2) (OldVal_1)

(After)
1   (NewVal_1) (OldVal_2)
2   (OldVal_2) (NewVal_1) 
```

如您所见，刚刚`OldVal_1`更新。`OldVal_2`一直保持不变。

**如何使用 xml 参数中指定的所有元素更新字段？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T19:22:29.477

使用递归 cte 可以让我得到你正在寻找的结果。如下图所示。但至少它不是游标/while循环；）

```
declare @tmpConstraint table (ID int , Constraint_Value varchar(256))
insert into @tmpConstraint values 
(1, '(OldVal_1) (OldVal_2)'),
(2, '(OldVal_2) (OldVal_1)')

declare @myXML XML
set @myXML = N'<qaUpdates>
    <qaUpdate><old>OldVal_1</old><new>NewVal_1</new></qaUpdate>
    <qaUpdate><old>OldVal_2</old><new>NewVal_2</new></qaUpdate>
</qaUpdates>'

declare @xmlData table (oldValue varchar(256), newValue varchar(256))
insert into @xmlData 
select 
    oldValue = Child.value('(old)[1]', 'varchar(50)'), 
    newValue = Child.value('(new)[1]', 'varchar(50)')
from @myXML.nodes('/qaUpdates/qaUpdate') as N(Child) 
```

以上只是为以下设置。

```
;with cte (ID, Constraint_Value, CLevel)
as
(
    select c.ID, c.Constraint_Value, 1
    from @tmpConstraint c

    union all

    select p.ID, cast(replace(p.Constraint_Value, x.oldValue, x.newValue) as varchar(256)), p.CLevel + 1
    from cte p
    join @xmlData x on p.Constraint_Value like '%' + x.oldValue + '%'
)
update c
set c.Constraint_Value = t.Constraint_Value
from @tmpConstraint c
join (
    select 
        *,
        rn = row_number() over (partition by ID order by CLevel desc)
    from cte
) t on t.ID = c.ID and rn = 1

select * from @tmpConstraint 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T19:23:53.023

我认为这里的问题与 XML 无关。这是一个单一的 UPDATE 只会更新每行一次，而不管存在多少连接行。我认为您可以添加 WHERE 子句和 WHILE 循环来获取所有替换：

```
WHILE @@ROWCOUNT>0
BEGIN
  update c 
  set constraint_value = REPLACE(constraint_value, Child.value('(old)[1]', 'varchar(50)'), Child.value('(new)[1]', 'varchar(50)')) 
  from #tmpConstraint c 
  cross join @myXML.nodes('/qaUpdates/qaUpdate') as N(Child)  
  WHERE constraint_value LIKE '%' + Child.value('(old)[1]', 'varchar(50)') + '%'
END 
```

只要确保这遵循设置@@RowCount 的语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T18:09:34.847

我意识到这已经得到了回答，但我很想知道是否有办法在不使用 cte 的情况下做到这一点。无论如何，更大的问题实际上是您将 2 条数据存储在同一列/行中。再加上您无法在单个更新语句中两次更新同一行的事实导致了您的问题。无论如何，我的方法是这样的（我提前为复杂性道歉）：

```
DECLARE @tmpConstraint TABLE (
    constraint_id INT PRIMARY KEY
    ,constraint_value VARCHAR(256)
    )

INSERT INTO @tmpConstraint
VALUES (
    1
    ,'(OldVal_1) (OldVal_2)'
    )

INSERT INTO @tmpConstraint
VALUES (
    2
    ,'(OldVal_2) (OldVal_1)'
    )

INSERT INTO @tmpConstraint
VALUES (
    3
    ,'(OldVal_3) (OldVal_21) (OldVal_1)'
    )

DECLARE @myXML XML

SET @myXML = N'<qaUpdates>     <qaUpdate><old>OldVal_1</old><new>NewVal_1</new></qaUpdate>     <qaUpdate><old>OldVal_2</old><new>NewVal_2</new></qaUpdate> </qaUpdates>'

SELECT *
FROM @tmpConstraint

UPDATE C
SET constraint_value = c.New_Val
FROM (
    SELECT Constraint_ID UpdID
        ,Constraint_value
        ,STUFF((
                SELECT (' ' + New_value)
                FROM (
                    --Converts XML into a Table effectively splitting the string
                    SELECT constraint_id
                        ,t.value('.', 'varchar(200)') Current_value
                        ,Coalesce(Nullif('(' + new + ')', '()'), t.value('.', 'varchar(200)')) New_Value
                    FROM
                        --Converts single column into an xml document to split rows. Uses a blank space as the identifer of rows
                        (
                        SELECT constraint_id
                            ,convert(XML, ('<R>' + replace(constraint_value, ' ', '</R><R>')) + '</R>') xmldoc
                        FROM @tmpConstraint
                        ) AS a
                    CROSS APPLY a.xmldoc.nodes('./R') AS b(t)
                    --Join to table containing proposed changes based on value to change            
                    LEFT JOIN (
                        SELECT Child.value('./old[1]', 'varchar(100)') old
                            ,Child.value('./new[1]', 'varchar(100)') new
                        FROM @myXML.nodes('/qaUpdates/qaUpdate') AS N(Child
                        )
                    ) q2 ON '(' + old + ')' = t.value('.', 'varchar(200)')
                ) Modified WHERE Modified.constraint_id = base.constraint_id FOR XML path(''))
        ,1,1,'') New_Val
FROM @tmpConstraint Base ) c

SELECT *
FROM @tmpConstraint 
```

它看起来比现在更混乱，如果你有一些 UDF 在那里可以清理。但基本上我将你的多值列分成多行。转动这个

```
1   (OldVal_1) (OldVal_2)
2   (OldVal_2) (OldVal_1)
3   (OldVal_3) (OldVal_21) (OldVal_1) 
```

进入这个

```
1   (OldVal_1)
1   (OldVal_2)
2   (OldVal_2)
2   (OldVal_1)
3   (OldVal_3)
3   (OldVal_21)
3   (OldVal_1) 
```

我对 xml 文件做同样的事情。把它变成这样的关键数据对集

```
OldVal_1    NewVal_1
OldVal_2    NewVal_2 
```

将它与之前创建的表连接起来以获得这个（复制没有确定替换的原始值）

```
1   (OldVal_1)  (NewVal_1)
1   (OldVal_2)  (NewVal_2)
2   (OldVal_2)  (NewVal_2)
2   (OldVal_1)  (NewVal_1)
3   (OldVal_3)  (OldVal_3)
3   (OldVal_21) (OldVal_21)
3   (OldVal_1)  (NewVal_1) 
```

将分隔的行重新组合成一个字符串，再次按约束 id 分组，如下所示：

```
1   (OldVal_1) (OldVal_2)       (NewVal_1) (NewVal_2)
2   (OldVal_2) (OldVal_1)       (NewVal_2) (NewVal_1)
3   (OldVal_3) (OldVal_21) (OldVal_1)   (OldVal_3) (OldVal_21) (NewVal_1) 
```

然后在我的 from 语句中使用它来更新原始表中的数据。无论如何，我意识到代码可以稍微清理一下，甚至可能简化，但这就是我想出的概念。真正更大的问题是您如何存储这些数据。但我不知道你的情况，所以我保留判断。

# asp.net-mvc-3 - 可以在自定义视图引擎中动态修改布局视图值吗？

> ID：10836093
> 
> 赞同：0
> 
> 时间：2012-05-31T14:57:44.713
> 
> 标签：asp.net-mvc-3, razor

目前我有一个自定义视图引擎，它将检测应用程序配置文件中的设置并相应地将字符串附加到视图文件的末尾。以州为例，如果它检测到佛蒙特州，它将附加`"_VT"`到视图文件名的末尾。它工作正常，如果没有`"_VT"`找到它默认为没有任何特殊结尾的文件。

在我的 Razor 视图中，我可以使用该`Layout = ""`选项为视图指定布局。我的问题是，有没有办法可以像在视图引擎中所做的那样对布局做类似的事情？基本上，如果在配置中检测到 Vermont，则添加`"_VT"`到 Layout View 文件名。

当前视图引擎：

```
public class PlanSpecificRazorViewEngine : RazorViewEngine
{
    public PlanSpecificRazorViewEngine()
    {
        ViewLocationFormats = new[] { "~/Views/{1}/{0}.cshtml", "~/Views/Shared/{0}.cshtml" };
        PartialViewLocationFormats = new[] { "~/Views/{1}/{0}.cshtml", "~/Views/Shared/{0}.cshtml" };
        AreaViewLocationFormats = new[] { "~/Areas/{2}/Views/{1}/{0}.cshtml", "~/Areas/{1}/Views/Shared/{0}.cshtml" };
        AreaPartialViewLocationFormats = new [] {"~/Areas/{2}/Views/{1}/{0}.cshtml", "~/Areas/{2}/Views/Shared/{0}.cshtml" };
    }

    public override ViewEngineResult FindView(ControllerContext controllerContext, string viewName, string masterName, bool useCache)
    {
        string Plan = System.Configuration.ConfigurationManager.AppSettings["Plan"];
        return base.FindView(controllerContext, viewName + "_" + Plan, masterName, useCache);
    }

    public override ViewEngineResult FindPartialView(ControllerContext controllerContext, string partialViewName, bool useCache)
    {
        string Plan = System.Configuration.ConfigurationManager.AppSettings["Plan"];
        return base.FindPartialView(controllerContext, partialViewName + "_" + Plan, useCache);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:02:33.553

`MasterLocationFormats`您可以在构造函数中设置默认值：

```
public PlanSpecificRazorViewEngine()
{
    ...

    string Plan = System.Configuration.ConfigurationManager.AppSettings["Plan"];
    MasterLocationFormats = new string[] 
    { 
        "~/Views/Shared/{0}_" + Plan + ".cshtml",
        "~/Views/Shared/{0}_" + Plan + ".vbhtml"
    };
} 
```

# c# - WPF 文本框 RaiseEvent

> ID：10836096
> 
> 赞同：0
> 
> 时间：2012-05-31T14:57:53.043
> 
> 标签：c#, wpf, textbox, raiseevent

我有一些使用掩码和文本框上的 PreviewTextInput 和 PreviewKeyDown 事件的验证代码。当我手动更改文本框中的值时，验证工作完美。当我以编程方式设置值时，验证不会开始，直到我单击框并删除一个字符并重新添加它，手动触发上述事件中的一个或两个。

有没有办法手动触发这些事件中的任何一个以便验证工作？

我尝试过类似的东西：

```
this.TextBox.RaiseEvent(this.TextBox.PreviewTextInput); 
```

但似乎没有任何效果。我也找不到匹配的类型。欢迎任何想法。

我正在使用的基于屏蔽的验证代码可以在这里看到：[如何定义文本框输入限制？](https://stackoverflow.com/questions/1103765/how-to-define-textbox-input-restrictions/10759912#10759912)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-11-04T10:03:06.227

To complete [Trevor Elliott](https://stackoverflow.com/a/10836430/4456593)'s answer, I had to reuse the same `TextCompositionEventArgs` reference to make it work :

```
 TextCompositionEventArgs eventArgs =
      new TextCompositionEventArgs(
        InputManager
          .Current
          .PrimaryKeyboardDevice,
        new TextComposition(
          InputManager.Current, 
          target, 
          ((char) KeyInterop.VirtualKeyFromKey(KBB.Key)).ToString()));

    eventArgs.RoutedEvent = TextCompositionManager.PreviewTextInputStartEvent;
    target.RaiseEvent(eventArgs);

    eventArgs.RoutedEvent = TextCompositionManager.TextInputStartEvent;
    target.RaiseEvent(eventArgs);

    eventArgs.RoutedEvent = TextCompositionManager.PreviewTextInputEvent;
    target.RaiseEvent(eventArgs);

    eventArgs.RoutedEvent = TextCompositionManager.TextInputEvent;
    target.RaiseEvent(eventArgs); 
```

Hope this helps

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T06:02:46.377

或者您可以在通过代码输入文本后选择文本框中的文本，例如 t.Select()。

这样，一旦用户将焦点从文本框移开，验证就会触发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:18:20.820

您可以使用以下代码来伪造文本输入到 TextBox。

```
TextCompositionEventArgs args = new TextCompositionEventArgs(
    InputManager.Current.PrimaryKeyboardDevice,
    new TextComposition(InputManager.Current, txtBox, "Test text")
);
args.RoutedEvent = TextCompositionManager.PreviewTextInputEvent;

txtBox.RaiseEvent(args);

args = new TextCompositionEventArgs(
    InputManager.Current.PrimaryKeyboardDevice,
    new TextComposition(InputManager.Current, txtBox, "Test text")
);
args.RoutedEvent = TextCompositionManager.TextInputEvent;

txtBox.RaiseEvent(args); 
```

# objective-c - 如何从异步 NSURLConnection 返回到调用类？

> ID：10836106
> 
> 赞同：4
> 
> 时间：2012-05-31T14:58:18.633
> 
> 标签：objective-c, ios5, xcode4

我有以下类，它异步发出 HTTP 发布请求以避免主 UI 线程上的问题：

```
@implementation DataFeeder

-(void) doLookup:(NSString *)inputValue
{
    NSString *myRequestString = [NSString stringWithFormat:@"val=%@", inputValue];
    NSMutableData *myRequestData = [ NSMutableData dataWithBytes: [ myRequestString UTF8String ] length: [ myRequestString length ] ];

    NSURL * myUrl = [NSURL URLWithString: @"http://mywebsite/results.php"];
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL: myUrl]; 
    [request setHTTPMethod: @"POST"];
    [request setHTTPBody: myRequestData];
    [request setTimeoutInterval:10.0];

    [[NSURLConnection alloc] initWithRequest:request delegate:self];
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
    responseData = [[NSMutableData alloc] init];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    [responseData appendData:data];
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {
    // Show error message
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    // Use responseData
    // Got all my response data here, so build up an object ready to send back
}

@end 
```

我正在`ViewController`使用以下代码行调用上述内容：

`MyObject * myObj = [feeder doLookup:@"SomeStaticStringForNow"];`

所以，这就是我的理解：

1.  将`doLookup`在异步连接上执行请求。
2.  当数据已完全加载时，它将调用`connectionDidFinishLoading`
3.  数据加载完成后，我将从响应数据构建一个对象，并将其发送回调用控制器

我怎样才能让调用控制器监听这个？我是否需要在 ViewController 中实现自己的回调方法来监听调用，然后停止微调器并根据内容更新 UI `myObj`？

我希望有一个我忽略的非常简单的方法......

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T15:00:33.793

是的，你应该使用委托模式来实现你的回调。也就是说，在我看来，这是最简单、最标准的方法。如您在其他回复中所见，还有其他方法。

在您的`DataFeeder.h`文件中：

```
@protocol DataFeederDelegate
 - (void)dataReady:(NSData*)data;
@end

@interface DataFeeder : NSObject {
 id delegate_;
}
- (id)initWithDelegate:(id<DataFeederDelegate>)delegate;
@end 
```

在你的`DataFeeder.m`：

```
@implementation DataFeeder
- (id)initWithDelegate:(id<DataFeederDelegate>)delegate {
  self = [super init];
  if(self) {
    delegate_ = delegate;
  }
  return self;
}
- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
 [delegate_ dataReady:responseData];
}
@end 
```

您将像这样实例化一个 DataFeeder 对象：

```
DataFeeder *dataFeeder = [[DataFeeder alloc] initWithDelegate:self]; 
```

当然，调用视图控制器必须实现 DataFeederDelegate 方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-31T15:04:02.397

您有几种方法可以`ViewController`在数据存在时通知您：

1.  `ViewController`在和之间定义一个委托协议`DataFeeder`，以便后者在 中向前者发送消息`connectionDidFinishLoading:`；

2.  使用`NSNotificationCenter`so 解耦:将自己作为观察者添加到默认通知中心`DataFeeder`：`ViewController``ViewController`

    ```
     [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(dataIsThere:) name:kMyNetworkNotificationDataIsThere object:nil]; 
    ```

在`DataFeeder`正确的时间发送通知：

```
 [[NSNotificationCenter defaultCenter] postNotificationName:kMyNetworkNotificationDataIsThere object:self]; 
```

1.  make`ViewController`实现委托方法`NSURLConnection`并处理响应本身（这需要将其作为参数传递给`DataFeeder`构造函数）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T15:07:00.633

一个很好的方法是使用块。您的`doLookup:`方法可以接受一个块对象，并且您可以在连接完成时调用它。

由于您可能希望能够使用不同的完成块执行多个查找，因此您需要将传入的块与适当的 NSURLConnection 相关联。

为此，您可以使用具有属性的`NSURLConnection`子类`completionBlock`，或使用与 Objective-C 关联的对象（通过使用`objc_setAssociatedObject`and`objc_getAssociatedObject`函数）将块附加到连接对象。

当方法中的一切准备就绪`connectionDidFinishLoading:`并且您已经准备好最终响应对象时，您从`NSURLConnection`对象中获取块并调用它，将最终数据传递给它。

因此，您最终希望您的客户端代码如下所示：

```
[feeder doLookup:@"Something" completionBlock:(FetchedData *data, NSError *error) {
    if (error) {
        // ...
        return;
    }

    // access the returned data
}]; 
```

我希望这对你来说已经足够详细了。

# android - 为持久登录设置数据库/API

> ID：10836110
> 
> 赞同：0
> 
> 时间：2012-05-31T14:58:29.143
> 
> 标签：android, iphone, database, security

我负责为一家小型初创公司编写服务器，该初创公司有兴趣为 Android、iPhone 等编写日历共享应用程序。我们这样做的方式是使用每个移动平台都可以使用的公共 API登录，更新日历等。如果他们想扩展他们的网站以获得更多功能，这也将变得容易。这些脚本是使用 PHP 和 MySQL 数据库编写的。

现在应用程序的流程是用户点击应用程序图标：

如果之前登录然后转到主屏幕，否则转到登录屏幕

我应该如何设计数据库以便有“记住我”选项？我是否应该在服务器和本地存储一个令牌，如果它们匹配，那么我们知道用户之前已经登录过？如果用户没有选择“记住我”选项，那么当他退出应用程序时，会向服务器发送请求以将他注销？

设计此数据库的最快、最安全和最简单的方法是什么？

# jquery - 为什么我不能让 jQuery 在线工作？

> ID：10836112
> 
> 赞同：1
> 
> 时间：2012-05-31T14:58:35.527
> 
> 标签：jquery, offline

我是第一次使用 jQuery，也许有一些我没有注意到的东西。此页面[http://iziratig.zymichost.com/index.html](http://iziratig.zymichost.com/index.html)在离线时可以正常工作，但 jQuery 适合嵌入的 MySpace 视频和右下角的幻灯片在在线时不能。

ps 我花了几个晚上和谷歌一起寻找解决方案：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:02:40.967

这可能是一个问题：

> 不安全的 JavaScript 尝试从 URL http://www.youtube.com/embed/30hMJMvPxGo 的框架访问具有 URL [http://iziratig.zymichost.com/index.html](http://www.youtube.com/embed/30hMJMvPxGo)[的](http://iziratig.zymichost.com/index.html)框架 。域、协议和端口必须匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:02:54.520

您应该在 .js 中加载您的 jQuery 库和其他 js `<head>`，因此在您的`<head>`.

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="js/slider.js" type="text/javascript" charset="utf-8"></script> 
```

并添加`type="text/javascript"`到`<script>`您编写 Javascript/jQUery 代码的标签中。

```
<script type="text/javascript">

  $(document).ready(function() {
     // code
  });

</script> 
```

# php - 照片上传和显示 PHP, MySQL

> ID：10836118
> 
> 赞同：1
> 
> 时间：2012-05-31T14:58:55.543
> 
> 标签：php, mysql, image, upload

我有一个图片上传脚本如下：

```
$product = $_POST['name'];
$detail = $_POST['detail'];
$price = $_POST['price'];
$class = $_POST['class'];
$category = $_POST['category'];
$name = $_FILES['image']['name'];
$tmpName  = $_FILES['image']['tmp_name'];

if ($name) {
    //start upload process
    $location = "images/" . $name;
    move_uploaded_file($tmpName, $location);
}

$query="INSERT INTO shop_products VALUES ('','$product','$location','$detail','$price','$class','$category','yes')";
$result=mysql_query($query) or die(mysql_error());

header("location: ../admin/index.php"); 
```

图像的显示如下：

```
<img class="item-img" src="scripts/images/<? echo $image; ?>" /> 
```

如您访问 ltyboards.com/boards 所见，文档源为图像提供了适当的文件名，并且图像确实存在于服务器上，但没有显示任何内容。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:04:10.447

看起来你的路径是错误的

`scripts/images/images/`

应该

`scripts/images/`

# php - PHPUnitSeleniumTestcase 的代码覆盖率

> ID：10836121
> 
> 赞同：12
> 
> 时间：2012-05-31T14:59:04.263
> 
> 标签：php, selenium, code-coverage

我已经为 PHP 编写了 Selenium 测试用例。我想在执行这些测试用例时获得代码覆盖率。我的测试用例：

```
<?php
class Example extends PHPUnit_Extensions_SeleniumTestCase
{
  protected $coverageScriptUrl = 'http://applicationname/phpunit_coverage.php';

  protected function setUp()
  {
    $this->setBrowser("*firefox");
    $this->setBrowserUrl("http://applicationname");
    $this->setCollectCodeCoverageInformation(true);
    $this->setTestId("10001");
    $this->setHost("applicationname");
  }

  public function testMyTestCase()
  {
    $this->open("http://applicationame");
    $this->assertEquals("title", $this->getTitle());
    $this->type("id=ext-comp-1002", "testuser");
    $this->fireEvent("id=ext-comp-1002", "blur");
    $this->type("id=ext-comp-1003", "testpassword");
    $this->fireEvent("id=ext-comp-1003", "blur");
    $this->click("ext-gen45");
    $this->waitForPageToLoad("200000");
}
}
?> 
```

我已按照链接“http://www.phpunit.de/manual/current/en/selenium.html”中提到的步骤进行操作

运行测试后，我无法找到代码覆盖率。在 phpunit_coverage.php 中，它正在查找名称为 PHPUNIT_SELENIUM_TEST_ID 的 cookie。这个 cookie 是在 Driver.php 中创建的，我看到 cookie 可用，但它的主机名设置为“localhost”，而不是我的应用程序名称。

Cookie 生命周期设置为会话，即意味着在测试用例执行后该 cookie 将不再可用，当我尝试启动 phpunit_coverage.php 时，它无法找到 cookie 和信息，因此没有出现代码覆盖。

我不明白的事情：

1.  `protected $coverageScriptUrl = 'http://applicationname/phpunit_coverage.php';`
2.  如果 cookie 具有与应用程序不同的主机，则该 cookie 是否可以访问

我在很多论坛上都看到过这个问题，但是有一个给出了具体的答案

许多论坛建议使用`localhost`而不是`127.0.0.1`作为服务器名称。就我而言，它已经是本地主机。

在这方面的任何建议都会有所帮助。

谢谢， 拉武里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T18:10:17.390

Selenium 的集成或功能测试并没有覆盖代码，因为它们覆盖了行为。像这样的测试代码覆盖率报告不会生成任何有用的信息。单元测试将生成更有意义的代码覆盖率报告。测试是根据提供给和来自 Selenium 的信息运行的，可以说它并不是真正测试你的“代码”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T01:13:16.900

我认为frosty 的答案可能会变得更强大，但我对 PHPUnit 和 Selenium 都是一个完全的菜鸟，所以我不完全确定我在说什么。所以我会说出来，看看我是否得到纠正。

单元测试在 PHPUnit 的直接控制下运行您的应用程序代码。您在代码中为 PHPUnit 提供要调用的方法，它会在 Xdebug 下调用该方法来收集覆盖信息。我认为它是让您的代码在与 PHPUnit 相同的地址空间中运行，即使严格来说这可能不是真的 - 有人知道它是否是这样吗？

在 Selenium 下运行测试时，您的代码根本不受 PHPUnit 的直接控制。代替代码中的方法，您给 PHPUnit 一个 URL，它会安排将该 URL 提供给真正的 Web 浏览器。Web 浏览器本身不需要与 PHPUnit 运行在同一主机上；即使是这样，您正在测试的应用程序代码也会在 URL 指定的网络服务器上运行。PHPUnit 不可能告诉 Firefox 告诉服务器处理请求，如果处理请求调用 PHP，然后在 Xdebug 下运行该 PHP 代码并将跟踪输出与响应一起发送回来！PHPUnit 只能看到您指定的 URL 和为请求提供服务的 Web 浏览器的输出。它无法找出处理请求的网络服务器实际运行的代码。

因此，前面的答案说这些测试的代码覆盖率报告不会提供有用的信息，并且单元测试会生成更有意义的报告，我会一直说这些测试***不可能***测量代码覆盖率根本，所以你不应该在运行它们时询问代码覆盖率报告！或者更确切地说，如果您确实为 selenium 测试生成代码覆盖率报告，并且报告说即使您的代码运行了一行，那么您的设置存在严重错误。

# php - 如何删除谷歌分析cookies？

> ID：10836122
> 
> 赞同：3
> 
> 时间：2012-05-31T14:59:04.650
> 
> 标签：php, cookies, google-analytics

使用新的 Cookie 法，我试图找到一种方法，可以使用 PHP 脚本从我的站点中删除所有 cookie。我有一个有效的脚本，但它不会删除谷歌分析 cookie。

如何删除谷歌分析 cookie？

```
foreach($_COOKIE as $key => $value) {
      setcookie($key, '', time()-1000);
      setcookie($key, '', time()-1000, '/');
  } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T15:05:33.457

您需要将域作为第 5 个参数传递...

```
 setcookie($key, '', time()-1000, '/', '.domain.com'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T15:22:43.723

您**无法**删除属于不同域 .google 的客户端浏览器上的 cookie，但您可以让用户选择添加分析代码。

第一步是使用 PHP 检查[dnt](http://en.wikipedia.org/wiki/Do_Not_Track)标头[[示例函数]](http://robert-lerner.com/do-not-track-headers-in-php.php)，许多浏览器已经支持这个 + AVG 有这个作为浏览器插件，如果它存在则默认不添加 js 代码。或者，如果未设置 dnt 标头，则您可以提示用户您的跟踪/分析 cookie，然后将选择存储在 cookie 或会话中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-12T17:20:20.883

通常，Firefox 会显示 cookie 是设置在 www.yourdomain.com 还是 domain.com 下。在我的例子中，谷歌分析 cookie 是为 domain.com 设置的。这段代码完成了这项工作，删除了所有 3 个与 Google 相关的 cookie：

```
foreach ( $_COOKIE as $key => $value ){
if($_POST[$key]==1){
unset($_COOKIE[$key]);
if($key=='language'  || $key=='currency'){
setcookie($key, null, -1, '/', 'www.mydomain.com');
}else if($key=='_ga' || $key=='_gid' || $key == '_gat_gtag_UA_whatever_1' ){
setcookie($key, null, -1, '/', '.mydomain.com');
}else{
foreach ( $_COOKIE as $key => $value ){
if($_POST[$key]==1){
unset($_COOKIE[$key]);
if($key=='language'  || $key=='currency'){
        setcookie($key, null, -1, '/', 'www.mydomain.com');
}else if($key=='_ga' || $key=='_gid' || $key == '_gat_gtag_UA_whatever_1' ){
        setcookie($key, null, -1, '/', '.mydomain.com');
}else{
        setcookie($key, null, -1, '/');
}
$n++;
}
} 
```

我让它以表单操作的形式运行，其中列出了当前存储在客户端浏览器中的所有 cookie，并让他选择要删除的 cookie。选择的那些以 $_POST[$key]==1 的形式出现，然后由脚本处理。未选中的保持活力。这是针对 OpenCart 下的在线商店的。不用说，将“mydomain.com”替换为您的，并将跟踪 cookie 中的“whatever”替换为您的 Google 帐号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T09:47:02.437

```
foreach($_COOKIE as $key => $value) {    
    setcookie($key, '', time()-1000, '/', '.domain.com');
} 
```

上面的例子对我不起作用——所有其他的 cookie 都被删除了，只剩下 GA 的。有人知道为什么这可能是更好的方法吗？

# symfony - 如何在教义 2 中设置日期？

> ID：10836123
> 
> 赞同：27
> 
> 时间：2012-05-31T14:59:09.923
> 
> 标签：symfony, doctrine, doctrine-orm

我在学说实体中有一个名为“生日”的字段。

我想创建一个对象以使用教义添加到数据库中。

控制器内部：

```
$name = "John Alex";
$birthday = "11-11-90";
$student = new Student();
$student->setName($name);
$student->setBirthday(strtotime($birthday);
... 
```

但是当我尝试坚持时，我得到了这个错误

```
Fatal error: Call to a member function format() on a non-object in /Library/WebServer/Documents/Symfony/vendor/doctrine-dbal/lib/Doctrine/DBAL/Types/DateType.php on line 44 
```

**编辑：**

我的实体：

```
/**
 * @var string $name
 *
 * @ORM\Column(name="name", type="string", length=255)
 */
private $name;

/**
 * @var date $birthday
 *
 * @ORM\Column(name="birthday", type="date", nullable=true)
 */
private $birthday;

/**
 * Set birthday
 *
 * @param date $birthday
 */
public function setBirthday($birthday)
{
    $this->birthday = $birthday;
}

/**
 * Get birthday
 *
 * @return date 
 */
public function getBirthday()
{
    return $this->birthday;
} 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-31T16:16:30.493

```
$name = "John Alex";
$birthday = "11-11-1990"; // I changed this
$student = new Student();
$student->setName($name);
$student->setBirthday(new \DateTime($birthday)); // setting a new date instance
// ... 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-03-20T09:07:13.307

您的实体的字段映射为`"datetime"`或`"date"`应包含[`DateTime`](http://php.net/manual/en/class.datetime.php).

因此，您的 setter 应进行如下类型提示：

```
/**
 * Set birthday
 *
 * @param \DateTime|null $birthday
 */
public function setBirthday(\DateTime $birthday = null)
{
    $this->birthday = $birthday ? clone $birthday : null;
}

/**
 * Get birthday
 *
 * @return \DateTime|null 
 */
public function getBirthday()
{
    return $this->birthday ? clone $this->birthday : null;
} 
```

这允许为生日设置一个`null`或一个实例。`DateTime`

如您所见，我还`clone`设置了生日日期的值以避免破坏封装（请参阅[Doctrine2 ORM 不会保存对 DateTime 字段的更改](https://stackoverflow.com/questions/15486402/doctrine2-orm-does-not-save-changes-to-a-datetime-field/15488230#15488230)）。

要设置生日，您只需执行以下操作：

```
$student->setBirthday(new \DateTime('11-11-90')); 
```

# ruby - SQLite/Sequel：Dataset#max 返回日期和时间戳的字符串

> ID：10836124
> 
> 赞同：2
> 
> 时间：2012-05-31T14:59:12.000
> 
> 标签：ruby, sqlite, sequel

我使用`Dataset#max`日期和时间戳列 ( `DB[:data].max(:timestamp)`，但我得到一个字符串作为结果，而不是时间戳或日期。

例子：

```
require 'sequel'
DB = Sequel.sqlite()
#~ DB.use_timestamp_timezones = true #no effect
DB.create_table(:data){
  Fixnum :num
  timestamp :timestamp
  Date :date
} unless DB.table_exists?(:data)

#Insert some testdata
1.upto(10){|i|
  DB[:data].insert(i, Time.now - 24*60*60*i, Date.today - i)
}

#
#my self written max function.
#
def max(ds,field)
    timestamp = nil
    ds.select(field).each{|ds|
      timestamp = ds[field] if ! timestamp or timestamp < ds[field]
    }
    timestamp
end

##Ok
p max(DB[:data],:num)
p DB[:data].max(:num)   #ok

p max(DB[:data],:timestamp)     #timestamp -> ok
p DB[:data].max(:timestamp)     #String!!

p max(DB[:data],:date)     #date -> ok
p DB[:data].max(:date)     #String!! 
```

我做了一个交叉检查，如果数据真的是时间戳/日期，这似乎没问题：

```
##Crosscheck:
DB[:data].each{|ds|
  puts "Error" unless ds[:timestamp].is_a?(Time)
  puts "Error" unless ds[:date].is_a?(Date)
  puts "Error" unless ds[:num].is_a?(Fixnum)
} 
```

我可以`Time#parse`用来再次获得时间戳：

```
p Time.parse(DB[:data].max(:timestamp)) 
```

但我更愿意在同一类型中获得最大值。

有没有办法将最大结果作为时间戳/日期？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T16:42:50.517

不，SQLite 实际上没有日期或时间戳类型 (http://www.sqlite.org/datatype3.html)。您获得日期和时间戳列的 ruby​​ Date 和 Time/DateTime 值的唯一原因是 Sequel 可以查看列的命名类型（在 CREATE TABLE 语句中使用的类型），并自动将 SQLite 存储为字符串的值转换为日期或时间/日期时间。SQLite 表达式（例如 max(column)）与列无关，因此 Sequel 不能使用该方法进行类型转换。

简而言之，如果您想要真正的日期/时间戳处理，请使用实际支持日期/时间戳列的数据库。不幸的是，除非您使用 JRuby 可以通过 JDBC 使用 H2/HSQLDB/Derby，否则我不相信 Sequel 支持的另一个嵌入式数据库库具有真正的日期/时间戳类型。

# java - PKCS12 到 JKS 转换失败

> ID：10836126
> 
> 赞同：2
> 
> 时间：2012-05-31T14:59:18.783
> 
> 标签：java, ssl, keytool, jks

我正在尝试使用以下命令将 PKCS12 格式文件转换为 JKS 密钥库：

```
keytool -v -importkeystore -trustcacerts -srckeystore cert.p12 -srcstoretype PKCS12 -destkeystore md_keystore.jks -deststoretype JKS 
```

这将返回以下消息：

```
0 entries successfully imported, 0 entries failed or cancelled 
```

我查看了使用 openSSL 的 cert.p12 文件，它似乎很好 - 它包含完整的证书链和私钥。也没有返回堆栈跟踪，并且生成的密钥库文件也是空的。

任何人都知道为什么密钥库无法导入看似有效的证书，但又不产生任何堆栈跟踪等？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T16:05:06.683

我最近使用此命令行导入了一些 PKCS12 证书：

```
keytool -importkeystore -srckeystore cert.p12 -srcstoretype PKCS12 -srcstorepass certificatePassword -keystore keystore_file_name.jks -storepass keystore_password 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-23T09:05:42.720

蒂姆斯，我打赌你设置了一个空密码来加密你的 p12 密钥库。

尝试使用非空值再次创建 p12。我有同样的问题，这为我解决了。我还没有弄清楚如何让 keytool 接受带有空密码的 p12 文件。

# javascript - Jquery 数据表 onClick

> ID：10836130
> 
> 赞同：0
> 
> 时间：2012-05-31T15:00:05.150
> 
> 标签：javascript, jquery, json, jsp, servlets

我正在使用 datatables jquery 插件来表示使用 Servlet 的 JSP 页面中的数据库信息。我尝试按照以下教程进行操作：

[http://www.codeproject.com/Articles/359750/jQuery-DataTables-in-Java-Web-Applications](http://www.codeproject.com/Articles/359750/jQuery-DataTables-in-Java-Web-Applications)

在单击表单上的提交按钮后，我试图填充表格，经过几次尝试后我被卡住了。

小服务程序代码：

```
package servlets;

import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.codehaus.jackson.JsonGenerationException;
import org.codehaus.jackson.map.JsonMappingException;
import org.codehaus.jackson.map.ObjectMapper;

import classes.DBConnection;

public class Search extends HttpServlet
{
    private static final long serialVersionUID = 1L;
    private int echo;
    private int totalrecords;
    private int totalDisplayRecords;

    public Search() 
    {
        super();
    }

    /**
     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException 
    {
    }

    /**
     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException 
    {
        String sEcho = request.getParameter("sEcho");

        Connection connect = new DBConnection().returnConnection();
        Map<String, String[]> parameters = request.getParameterMap();
        String sql = buildQuerytring(filterParameters(parameters));
        ResultSet rs = executeQuery(connect, sql);

        try {
            List<Object> aaData = buildAaData(rs);
            String JsonString = buildJsonResonse(aaData, sEcho);
            response.setContentType("application/Json");
            response.getWriter().print(JsonString);
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    private ResultSet executeQuery(Connection connect, String sql)
    {
        ResultSet rs = null;
        try {
            PreparedStatement presmt = connect.prepareStatement(sql);
            rs = presmt.executeQuery();
        } 
        catch (SQLException e) {
            e.printStackTrace();
        }
        return rs;
    }

    private String buildQuerytring(Map<String, String> map)
    {
        String select = "SELECT messagecaseid, messagesubject, messagesender, messagereceiver FROM berichtenarchief";
        StringBuilder sb  = new StringBuilder(select);
        boolean mapIsEmpty = map.isEmpty();

        if(mapIsEmpty == false)
        {
            int counter = 0;
            for(Map.Entry<String, String> entry : map.entrySet())
            {
                sb.append(" WHERE " + entry.getKey() + "=" + entry.getValue());
                counter++;
                if(counter > 1)
                {
                    sb.append(" AND " + entry.getKey() + "=" + entry.getValue());
                }
            }
        }
        System.out.println(sb.toString());
        return sb.toString();
    }

    private Map<String, String> filterParameters(Map<String, String[]> parameters)
    {
        Map<String, String> searchParameters = new HashMap<String, String>();
        for(Map.Entry<String, String[]> entry : parameters.entrySet())
        {
            String[] value = entry.getValue();
            if(value[0].isEmpty() == false)
            {
                searchParameters.put(entry.getKey(), value[0]);
            }
        }
        return searchParameters;
    }

    private List<Object> buildAaData(ResultSet rs) throws SQLException, JsonGenerationException, JsonMappingException, IOException
    {
        List<Object> JsonArray = new ArrayList<Object>();
        ResultSetMetaData rsmd = rs.getMetaData();
        int colCount = rsmd.getColumnCount();
        int rowCounter = 0;

        while(rs.next())
        {
            Map<String, Object> JsonObject = new LinkedHashMap<String, Object>();
            for(int colCounter = 1; colCounter<=colCount; colCounter++)
            {
                String JsonString = rsmd.getColumnName(colCounter);
                String JsonValue = rs.getObject(colCounter).toString();
                JsonObject.put(JsonString, JsonValue);
            }
            JsonArray.add(JsonObject);
            rowCounter++;
        }
        this.totalrecords = rowCounter;
        return JsonArray;
    }

    private String buildJsonResonse(List<Object> aaData, String sEcho) throws JsonGenerationException, JsonMappingException, IOException
    {
        totalDisplayRecords = 10;
        Map<String, Object> jsonObject = new LinkedHashMap<String, Object>();
        ObjectMapper mapper = new ObjectMapper();

        jsonObject.put("sEcho", echo);
        jsonObject.put("totalRecords", totalrecords);
        jsonObject.put("TotalDisplayRecords", totalDisplayRecords);
        jsonObject.put("aaData", aaData);

        return mapper.writeValueAsString(jsonObject);
    }
} 
```

此 servlet 生成以下 JSON 输出：

```
{"sEcho":0,"totalRecords":1,"TotalDisplayRecords":10,"aaData":[{"xxxx":"xxxx","xxx":"xxxxxx","xxxxxx":"xxxxxx","xxxxxx":"xxxxxxx"}]} 
```

因为我使用了这个“结构”，所以我必须将以下代码添加到生成表的 .js 文件中。

JS文件：

```
function generateTable () {
    $("#searchResults").dataTable({
        "bFilter" : false,
        "bServerSide": true,
        "sAjaxSource": "/ArchiveSearch/Search",
        "bProcessing": true,
        "sPaginationType": "full_numbers",
        "bJQueryUI": true,
        "aoColumns":    [
                                {"mDataProp": "xxxxxxxx"},
                                {"mDataProp" : "xxxxxxx"},
                                {"mDataProp" : "xxxxxxxx"},
                                {"mDataProp" : "xxxxxx"}
                            ]
        });
    }; 
```

我删除了 $(document).ready 行以使用 onClick 事件加载这只小狗。在我的 JSP 文件中，我有以下代码：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jstl/core" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <link href="/ArchiveSearch/resources/css/style.css" rel="stylesheet" type="text/css">

    <script type="text/javascript" src="/ArchiveSearch/resources/js/jquery-1.7.2.js"></script>
    <script type="text/javascript" src="/ArchiveSearch/resources/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" scr="/ArchiveSearch/resources/js/datatablesConfig.js"></script>

    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <title>searchArchive</title>
</head>
<body>
        <div class="wrapper">
        <div class="navmenu">
            <ol>
                <li><a href="index.jsp" >Home</a></li>
                <li><a href="connection.jsp" >Archive Connection</a></li>
                <li><a class="current" href="searchArchive.jsp">Zoeken in archief</a></li>
            </ol>
        </div>
        <div class="content">
            <form action="/ArchiveSearch/Search" method="post">
            <div class="searchCiteria">
                <div id="searchValueBlock1">
                        <div><span class="label">xxxxxx:</span><input type="text" name="xxxxx"  size="25"/></div>
                        <div><span class="label">xxxxxx:</span><input type="text" name="xxxx" size="25" /></div>
                        <div><span class="label">xxxxxxx:</span><input type="text" name="xxxxxx"  size="25"/></div>
                        <div><span class="label">xxxxxxx:</span><input type="text" name="xxxxxxxx"  size="25"/></div>
                </div>

                <div id= "searchValueBlock2">
                    <div><span class="label">xxxxxxxx:</span><input type="text" name="xxxxxx"  size="25"/></div>
                    <div><span class="label"></span><input type="text" name="xxxxxx"  size="25"/></div>

                    <div class="submit">
                        <input type="submit" value="Search" onclick="generateTable()">
                    </div>
                </div>
            </div>
            </form>
            <div class="result">
                <div id="demo_jui">
                    <table id="searchResults">
                        <thead>
                            <tr>
                                <th>xxxxxxx</th>
                                <th>xxxxxxx</th>
                                <th>xxxxxxx</th>
                                <th>xxxxxxxx</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
</body>
</html> 
```

最好的办法是，如果我可以在加载 JSP 页面时生成一个空表，然后当我单击提交按钮时，该表将填充 servlet 返回的 JSON 数组的值。

关于如何实现这一目标的任何指示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:14:16.637

与其使用该`bServerSide`选项，不如尝试手动填充它？

```
var table;

function generateTable () {
    table = $("#searchResults").dataTable({
        "bFilter" : false,
        "sAjaxSource": "/ArchiveSearch/Search",
        "bProcessing": true,
        "sPaginationType": "full_numbers",
        "bJQueryUI": true,
        "aoColumns":    [
                {"mDataProp": "xxxxxxxx"},
                {"mDataProp" : "xxxxxxx"},
                {"mDataProp" : "xxxxxxxx"},
                {"mDataProp" : "xxxxxx"}
            ]
    });
};

$(document).ready(function(){
    $('.submit input').click(function(){
        $.getJSON('/ArchiveSearch/Search', function(data){
            table.fnAddData(data.aaData);
        });
    });
    generateTable();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T15:04:20.060

以下解决方案使用带有 servlet 的“预过滤”的 Datatables 服务器端处理。

```
Servlet code:

package servlets;

import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.codehaus.jackson.JsonGenerationException;
import org.codehaus.jackson.map.JsonMappingException;
import org.codehaus.jackson.map.ObjectMapper;

import classes.DBConnection;

public class Search extends HttpServlet
{
    private static final long serialVersionUID = 1L;
    private int echo;
    private int totalrecords;
    private int totalDisplayRecords;

    public Search() 
    {
        super();
    }

    /**
     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException 
    {
    }

    /**
     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException 
    {
        Connection connect = new DBConnection().returnConnection();
        System.out.println(request.getParameter("formData"));
        Map<String, String> searchParameterMap = seperateFormString(request.getParameter("formData"));
        echo = Integer.parseInt(request.getParameter("sEcho"));
        String sql = buildQuerytring(searchParameterMap);
        ResultSet rs = executeQuery(connect, sql);

        try {
            List<Object> aaData = buildAaData(rs);
            String JsonString = buildJsonResonse(aaData, echo);
            response.setContentType("text/x-json;charset=UTF-8");
            response.setHeader("Cache-Control", "no-cache");
            response.getWriter().print(JsonString);
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    private Map<String, String> seperateFormString(String formData){

        Map<String, String> searchParameterMap = new HashMap<String, String>();
        String[] strings = formData.split("&");
        for(String s : strings)
        {
            String[] parameters = s.split("=");
            int value = parameters.length-1;
            if(parameters.length>1){
                searchParameterMap.put(parameters[0], parameters[value]);
            }
        }
        return searchParameterMap;
    }

    private ResultSet executeQuery(Connection connect, String sql)
    {
        ResultSet rs = null;
        try {
            PreparedStatement presmt = connect.prepareStatement(sql);
            rs = presmt.executeQuery();
        } 
        catch (SQLException e) {
            e.printStackTrace();
        }
        return rs;
    }

    private String buildQuerytring(Map<String, String> map)
    {
        String select = "SELECT messagecaseid, messagesubject, messagesender, messagereceiver FROM berichtenarchief";
        StringBuilder sb  = new StringBuilder(select);
        boolean mapIsEmpty = map.isEmpty();
        int counter = 0;

        if(mapIsEmpty == false)
        {
            for(Map.Entry<String, String> entry : map.entrySet())
            {
                if(counter >= 1)
                {
                    sb.append(" AND " + entry.getKey() + " LIKE " + "'%" + entry.getValue() + "%'");
                }
                else if(counter == 0)
                {
                    sb.append(" WHERE " + entry.getKey() + " LIKE " + "'%" + entry.getValue() + "%'");
                }
                counter++;
            }
        }
        System.out.println(sb.toString());
        return sb.toString();
    }

    private List<Object> buildAaData(ResultSet rs) throws SQLException, JsonGenerationException, JsonMappingException, IOException
    {
        List<Object> JsonArray = new ArrayList<Object>();
        ResultSetMetaData rsmd = rs.getMetaData();
        int colCount = rsmd.getColumnCount();
        int rowCounter = 0;

        while(rs.next())
        {
            Map<String, Object> JsonObject = new LinkedHashMap<String, Object>();
            for(int colCounter = 1; colCounter<=colCount; colCounter++)
            {
                String JsonString = rsmd.getColumnName(colCounter);
                String JsonValue = rs.getObject(colCounter).toString();
                JsonObject.put(JsonString, JsonValue);
            }
            JsonArray.add(JsonObject);
            rowCounter++;
        }
        this.totalrecords = rowCounter;
        return JsonArray;
    }

    private String buildJsonResonse(List<Object> aaData, int echo) throws JsonGenerationException, JsonMappingException, IOException
    {
        totalDisplayRecords = 10;
        Map<String, Object> jsonObject = new LinkedHashMap<String, Object>();
        ObjectMapper mapper = new ObjectMapper();

        jsonObject.put("sEcho", echo);
        jsonObject.put("iTotalRecords ", totalrecords);
        jsonObject.put("iTotalDisplayRecords ", totalDisplayRecords);
        jsonObject.put("aaData", aaData);

        return mapper.writeValueAsString(jsonObject);
    }
} 
```

来自带有服务器端处理的表单的信息，以及来自所选行的数据的弹出窗口，可用于您需要的其他事情。

jQuery代码：

```
var table;
var gaiSelected =  [];

$(document).ready(function() {
    $("#searchResults").dataTable({
        "bJQueryUI": true
        });
    $('.searchsubmit').click(function() {
        var formData = $('form').serialize();
        table = $("#searchResults").dataTable({
            "bDestroy": true,
            "bProcessing": true,
            "bServerSide": true,
            "sAjaxSource": 'Search',
            "sServerMethod": "POST",
            "aoColumns": [
                          { "mDataProp": "xxxxxxx" },
                          { "mDataProp": "xxxxxxx" },
                          { "mDataProp": "xxxxxxxx" },
                          { "mDataProp": "xxxxxxxxx" }
                      ],
            "fnServerParams": function ( aoData ) {
                aoData.push({"name": "formData", "value": formData}
                        );
            }
        });
        return false;
    });

     $('#searchResults tbody tr').live('dblclick', function () {
         var aData = table.fnGetData( this,0 );
         alert(aData);
            });
}); 
```

重要提示：在 onClick 方法结束时使用 return false。感谢有人指出这一点。（我稍后会尝试找到您并给出一些观点。）进一步的touti，Succes参数不是必需的，请参阅Jquery doc。

如果我稍后想到一些重要的事情，我会在稍后将其添加到帖子中。

# objective-c - NSView 中的 NSImage 旋转不起作用

> ID：10836131
> 
> 赞同：1
> 
> 时间：2012-05-31T15:00:07.720
> 
> 标签：objective-c, macos, cocoa, core-animation, cabasicanimation

我正在尝试在 NSView 中旋转 NSImage。首先，我将向您展示我到目前为止所做的事情。

* * *

## 图片 ：

* * *

![在此处输入图像描述](../Images/8869aa505ea70b57e034b01d8f52d440.png)

* * *

## 头文件

* * *

```
#import <Foundation/Foundation.h>
#import <QuartzCore/QuartzCore.h>

@interface AppController : NSObject {
    CALayer *syncFirst;
}

@property (weak) IBOutlet NSView *nsview;

- (IBAction)buttonClicked:(id)sender;
- (CGImageRef) convertToCGImageFromNasImage:(NSImage *) image;

@end 
```

* * *

## 实现文件，只有相关方法

* * *

```
- (void)awakeFromNib {

    NSImage *image = [NSImage imageNamed:@"SyncRing.png"];
    //init layer
    syncFirst = [CALayer layer];

    //animatated content size init
    syncFirst.bounds = CGRectMake(0, 0, image.size.width, image.size.height);
    syncFirst.position = CGPointMake(10, 10);
    syncFirst.contents = (id)[self convertToCGImageFromNasImage:image];

    [nsview.layer addSublayer:syncFirst];
}

 /*To convert NSImage in CGImage*/

- (CGImageRef) convertToCGImageFromNasImage:(NSImage *) image {
     NSData* cocoaData = [NSBitmapImageRep TIFFRepresentationOfImageRepsInArray: [image representations]];
     CFDataRef carbonData = (__bridge CFDataRef)cocoaData;
     CGImageSourceRef imageSourceRef = CGImageSourceCreateWithData(carbonData, NULL);
     CGImageRef myCGImage = CGImageSourceCreateImageAtIndex(imageSourceRef, 0, NULL);
     return myCGImage;
}

/*When button click animate the image*/

- (IBAction) buttonClicked:(id)sender {
    CABasicAnimation* rotationAnimation = [CABasicAnimation animationWithKeyPath:@"transform.rotation.z"];
    rotationAnimation.toValue = [NSNumber numberWithFloat:(2 * M_PI) * 1];
    rotationAnimation.duration = 1.0f;
    rotationAnimation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];
    [syncFirst addAnimation:rotationAnimation forKey:@"rotateAnimation"];
} 
```

* * *

## 问题 ：

* * *

基本上我试图在单击按钮后旋转此图像。我正在尝试的代码不是 100% 实现，而是从包括 Apple 文档在内的几个不同地方学习的。现在，很明显我犯了一些天真的错误，但从逻辑上讲，我的代码对我来说似乎是正确的。如果有人能指出我的错误并让我了解它为什么不起作用，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:15:38.367

对于任何未来的访问者，该代码可以完美运行，如果需要，您可以使用它，除非确保在 nsview 中添加层之前，我们必须设置 nsview 想要层。

所以，变化将是......

* * *

```
- (void)awakeFromNib {

    NSImage *image = [NSImage imageNamed:@"SyncRing.png"];
    //init layer
    syncFirst = [CALayer layer];

    //animatated content size init
    syncFirst.bounds = CGRectMake(0, 0, image.size.width, image.size.height);
    syncFirst.position = CGPointMake(10, 10);
    syncFirst.contents = (id)[self convertToCGImageFromNasImage:image];

    /*HERE SETWANTSLAYER TO TRUE IN ORDER TO FIX*/
    [nsview setWantsLayer:YES];

    [nsview.layer addSublayer:syncFirst];
} 
```

* * *

## 在使用此代码之前

请参阅评论中的讨论。有一些有用的提示，我在解决问题时忽略了这些提示。归功于-[彼得霍西](https://stackoverflow.com/users/30461/peter-hosey)

# django - 为什么 django 在进行 ./manage.py 测试时会运行自己的测试

> ID：10836132
> 
> 赞同：1
> 
> 时间：2012-05-31T15:00:11.107
> 
> 标签：django, unit-testing

在 django 1.4 中。我现在创建了一些应用程序，每个应用程序都包含 tests.py。

但是当我这样做时`./manage.py test`，django 运行它自己的 412 测试，但我想跳过它们，只运行我的测试用例。我该如何配置呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:14:37.517

您可以这样做`./manage.py test app_name`，其中`app_name`是您的应用程序的名称

见这里[https://docs.djangoproject.com/en/1.4/topics/testing/#running-tests](https://docs.djangoproject.com/en/1.4/topics/testing/#running-tests)

# ant - Ant & Concordion：类路径问题

> ID：10836133
> 
> 赞同：0
> 
> 时间：2012-05-31T15:00:14.053
> 
> 标签：ant, junit, classpath, concordion

我是 Ant/Concordion 的新手，我的第一个问题是关于 Stack Overflow 的，所以希望你能温柔一点。

尝试设置一个 Ant 任务来自动运行我的 Concordion 验收测试并生成一个摘要/概述/索引 html 页面，其中列出了哪些测试通过、失败等。

我正在使用[Concordion Ant Task](http://badrobot.googlecode.com/svn/trunk/bad.robot/concordion-ant-task/manual/Overview.html)，但遇到一个问题，我认为我的类路径不正确。

包结构镜像 test/java/spec & test/resources/spec 作为夹具和规范之间的分离。

这是我的 build.xml。

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="Bowling" default="run.acceptance.tests">
    <path id="dependencies">
        <fileset dir="lib" includes="concordion-ant-task-*.jar"/>
        <fileset dir="lib" includes="freemarker*.jar"/>
        <fileset dir="lib" includes="junit*.jar"/>
    </path>

    <taskdef name="junit" 
        classname="org.apache.tools.ant.taskdefs.optional.junit.JUnitTask" />
    <taskdef name="generate-test-overview"    
        classname="bad.robot.concordion.ant.GenerateTestOverviewTask" 
        classpathref="dependencies"/>

    <target name="check.dependencies"
        unless="classpath.as.supplied.by.maven">
        <!--  <fail message="Missing dependencies, run using Maven instead (*blush*) or switch to use classpathref='dependencies'"/>-->
    </target>

    <target name="generate-overview"
        depends="check.dependencies">
        <generate-test-overview 
            template="src\test\resources\spec\bowlingGame\Overview.ftl"      
            output="src\test\resources\spec\bowlingGame\Overview.html">
            <fileset dir="${basedir}\src\test\resources\spec\bowlingGame\">
                <include name="**/*.html"/>
                <exclude name="**/Overview.html" />
                <exclude name="**/BowlingGame.html" />
            </fileset>
        </generate-test-overview>
    </target>

    <echo message="${basedir}" />

    <target name="run.acceptance.tests"
        depends="generate-overview">
        <junit printsummary="on" haltonfailure="yes">
            <classpath>
                <pathelement location="${basedir}"/>
            </classpath>
            <formatter type="plain"/>
            <test name="Overview"/> <!-- corresponding java fixture, must match the overview page generated -->
        </junit>
    </target>  
</project> 
```

这是蚂蚁的输出。

```
 Apache Ant version 1.7.1 compiled on June 27 2008
    Using C:\Documents and Settings\gafitzgerald\training\Bowling\ant.log file as build log.
Buildfile: C:\Documents and Settings\gafitzgerald\training\Bowling\build.xml
parsing buildfile C:\Documents and Settings\gafitzgerald\training\Bowling\build.xml with URI = file:/C:/Documents%20and%20Settings/gafitzgerald/training/Bowling/build.xml
Project base dir set to: C:\Documents and Settings\gafitzgerald\training\Bowling
[antlib:org.apache.tools.ant] Could not load definitions from resource org/apache/tools/ant/antlib.xml. It could not be found.
     [echo] C:\Documents and Settings\gafitzgerald\training\Bowling
Build sequence for target(s) `run.acceptance.tests' is [check.dependencies, generate-overview, run.acceptance.tests]
Complete build sequence is [check.dependencies, generate-overview, run.acceptance.tests, ]
check.dependencies:
generate-overview:
[generate-test-overview] looking for files in C:\Documents and Settings\gafitzgerald\training\Bowling\src\test\resources\spec\bowlingGame...
[generate-test-overview]    scoring\Scoring.html
[generate-test-overview]    scoring\Spare.html
run.acceptance.tests: 
```

**修剪过的**

```
[junit] Implicitly adding C:\Documents and Settings\gafitzgerald\training\lib\junit-4.8.2.jar;C:\java\eclipse-helios\plugins\org.apache.ant_1.7.1.v20100518-1145\lib\ant-launcher.jar;C:\java\eclipse-helios\plugins\org.apache.ant_1.7.1.v20100518-1145\lib\ant.jar;C:\java\eclipse-helios\plugins\org.apache.ant_1.7.1.v20100518-1145\lib\ant-junit.jar to CLASSPATH
    [junit] Using CLASSPATH C:\Documents and Settings\gafitzgerald\training\Bowling;C:\Documents and Settings\gafitzgerald\training\lib\junit-4.8.2.jar;C:\java\eclipse-helios\plugins\org.apache.ant_1.7.1.v20100518-1145\lib\ant-launcher.jar;C:\java\eclipse-helios\plugins\org.apache.ant_1.7.1.v20100518-1145\lib\ant.jar;C:\java\eclipse-helios\plugins\org.apache.ant_1.7.1.v20100518-1145\lib\ant-junit.jar
    [junit] Running Overview
    [junit] Tests run: 1, Failures: 0, Errors: 1, Time elapsed: 0 sec

BUILD FAILED
C:\Documents and Settings\gafitzgerald\training\Bowling\build.xml:31: Test Overview failed
    at org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.actOnTestResult(JUnitTask.java:1840)
    at org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute(JUnitTask.java:837)
    at org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.executeOrQueue(JUnitTask.java:1785)
    at org.apache.tools.ant.taskdefs.optional.junit.JUnitTask.execute(JUnitTask.java:785)
    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:288) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T14:22:25.537

我重新格式化了你的 Ant 文件，所以它更容易阅读。

我注意到了几件事：

*   您不必*通过*`<taskdef>`. 该`<junit>`任务是 Ant 的一部分。我认为这就是你得到的原因：`[antlib:org.apache.tools.ant] Could not load definitions from resource org/apache/tools/ant/antlib.xml. It could not be found.`
*   您需要先编译 JUnit 测试，然后才能运行它们。那个`<generate-test-overview>`任务是这样做的吗？通常，当你编译 JUnit 测试时，你应该在类路径中包含：
    *   编译时使用的所有 jar。
    *   您构建的 JUnit 测试将运行的类。
    *   jar的位置`junit`（ant-junt.jar 已经在类路径中）。
*   运行 JUnit 测试时分叉它们。我不知道为什么`fork`设置为 false，但应该分叉 JUnit 测试。
*   子实体的`name`参数应该是你要执行的类的名称。`<test>`我不认为`Overview`是这样。
*   不要在失败时停止 JUnit 测试。一项测试可能会失败，但其他测试可能会成功。

# iphone - NSURLIsExcludedFromBackupKey 无法正确设置

> ID：10836134
> 
> 赞同：15
> 
> 时间：2012-05-31T15:00:15.933
> 
> 标签：iphone, ios

我试图防止整个文件夹被iTunes备份。我遵循了技术报告[http://developer.apple.com/library/ios/#qa/qa1719/_index.html](http://developer.apple.com/library/ios/#qa/qa1719/_index.html)但似乎 falg 每次都是零。我使用在模拟器和设备上试用过的 IOS 5.1。但没有任何帮助。这些方法每次都返回“成功”，但标志仍然为零。

```
+ (BOOL) hasSkipBackupAttributeToItemAtURL:(NSURL *)URL
{
    NSError *error = nil;

    id flag = nil;
    BOOL success = [URL getResourceValue: &flag
                                  forKey: NSURLIsExcludedFromBackupKey error: &error];

    if(!success){

        NSLog(@"Error excluding %@ from backup %@", [URL lastPathComponent], error);
        return false;
    }

    if (!flag)
        return false;

    return [flag boolValue];
}

+ (BOOL)addSkipBackupAttributeToItemAtURL:(NSURL *)URL
{
    NSError *error = nil;

    BOOL success = [URL setResourceValue: [NSNumber numberWithBool: YES]
                                  forKey: NSURLIsExcludedFromBackupKey error: &error];

    if(!success){

        NSLog(@"Error excluding %@ from backup %@", [URL lastPathComponent], error);

    }

    return success;

}

+ (BOOL)removeSkipBackupAttributeToItemAtURL:(NSURL *)URL
{
    NSError *error = nil;

    BOOL success = [URL setResourceValue: [NSNumber numberWithBool: NO]
                                  forKey: NSURLIsExcludedFromBackupKey error: &error];

    if(!success){

        NSLog(@"Error excluding %@ from backup %@", [URL lastPathComponent], error);

    }

    return success;

} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-13T09:47:22.833

我刚刚在我的应用程序中修复了这个问题，虽然有点令人沮丧，但一切都很好。所以，这里是[addSkipBackupAttributeToItemAtURL](https://gist.github.com/1999985)的代码。你可能想检查一下。它也处理 5.0.1 和 5.0。您只在代码中处理 5.1 及更高版本。

**但：**

假设您有一个 NSString *path - 文件 /folder 的路径，**不要使用以下方法调用该方法**：

`[NSURL urlWithString:path];` *它适用于 5.0.1，但不适用于 5.1 及更高版本。*

反而`use [NSURL fileURLWithPath:path];`

所以：**[MyClass addSkipBackupAttributeToItemAtURL:[NSURL fileURLWithPath:path]];**

事实上，我认为这是您的代码的唯一问题。采用我链接的方法，只会提供向后兼容性，这是一个很好的补充。

希望这可以帮助。

问候，乔治

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-15T09:27:35.697

对我来说同样的问题。我也解决了它改变我调用 addSkipBackupAttributeToItemAtURL 的方式这是正确的方法：

```
[MyClass addSkipBackupAttributeToItemAtURL:[NSURL fileURLWithPath:path]]; 
```

# facebook - 我什么时候需要 fb:app_id 或 fb:admins？

> ID：10836135
> 
> 赞同：85
> 
> 时间：2012-05-31T15:00:29.723
> 
> 标签：facebook, facebook-graph-api

facebook like button 的文档说：“当您的网页代表一个真实世界的实体时，例如电影、运动队、名人和餐馆，使用 Open Graph 协议来指定有关该实体的信息。”

我正在向不是真正实体的博客文章/视频/文章添加点赞按钮。正确的？所以我不需要 fb:app_id 或 fb:admins？但是然后在创建点赞按钮的第 2 步中说“获取打开的图形标签”，当我使用 Linter 验证没有 fb:admins 和 fb:app_id 的点赞按钮时，我得到一个“fb:admins 和 fb:app_id 标签是失踪。”

如果事实证明我需要 fb:admins 和 fb:app_id 标签，我是否需要 Facebook 之类的页面才能找到它们？

也是 fb:admins AND fb:app_id 还是 fb:admins OR fb:app_id，我不知道我是否需要两者。

在 graph.facebook/somepage 它给出了一个 id，但那是什么 id？例如： [如何获取 facebook 元的 fb:app_id](https://stackoverflow.com/questions/6307324/how-to-get-fbapp-id-for-facebook-meta)

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2012-05-31T15:21:16.203

在 HTML HEAD 中包含`fb:app_id`标签将允许 Facebook 抓取工具将该 URL 的 Open Graph 实体与应用程序相关联。这将允许该应用程序的任何管理员查看有关该 URL 和与之连接的任何社交插件的见解。

该`fb:admins`标签类似，但允许您只指定您希望授予执行上述权限的每个用户 ID。

您可以包含这些标签中的任何一个或同时包含这两个标签，具体取决于您想要管理 Insights 的人数等。单个 as`fb:admins`几乎是最低要求。当人们分享和喜欢您的 URL 时，其余的 Open Graph 标签仍然会被选中，但是它可能会在将来引起问题，因此请包括上述之一。

fb:admins 是这样指定的：
`<meta property="fb:admins" content="USER_ID"/>`
或者
`<meta property="fb:admins" content="USER_ID,USER_ID2,USER_ID3"/>`

和 fb:app_id 像这样：
`<meta property="fb:app_id" content="APPID"/>`

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-31T15:27:24.617

要使用 Like 按钮并让 Open Graph 检查您的网站，您需要一个应用程序。

因此，您需要将 Like Button 与`fb:app_id`

如果您希望其他用户在 Facebook 上看到您网站的管理页面，请添加`fb:admins`. 因此，如果您是应用程序的开发者和网站所有者，则无需添加`fb:admins`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-31T15:17:27.043

我认为文档很有帮助！

如果你再读一遍，它说在你的网站上添加开放图形元素将使你的网站充当一个 facebook 页面，你将能够发布更新等。

所以我认为这取决于你——你可以只拥有一个没有 OG 元素的页面，这样工作量更少，但对你的“奖励”也更少。

如果您确实使用 og，则将 type 设置为：`blog`

最后：`fb:admins` **或** `fb:app_id`- 页面管理员的 Facebook ID 或 Facebook 平台应用程序 ID 的逗号分隔列表。**至少，只包含您自己的 Facebook ID。**

所以只要把你自己的 fbid 放在那里。作为提示，您可以通过在 facebook 上查看您的个人资料照片的 url 轻松获得此信息。

# javascript - 更改 jQuery 点击处理程序功能

> ID：10836136
> 
> 赞同：0
> 
> 时间：2012-05-31T15:00:31.590
> 
> 标签：javascript, jquery, html

我在我的页面中使用拖动和滚动，它与 3 个简单的处理程序 mousedown、mousemove 和 mouseup 一起使用。

现在我有2个问题：

1.  我所有的`.on('click'`和`.click(`事件都有点坏了，因为由于 div 是用鼠标滚动的，所以光标停留在同一个对象上并且事件触发。如何更改处理程序，使其仅在 mousedown 和 mouseup 之间的 mousemove 距离小于固定值时触发？甚至有可能还是我必须创建一个自己的并更改所有代码？ - -解决了 - -
2.  我`event.preventDefault();`在此拖动和滚动期间使用以防止选择。这导致用户无法单击表单字段。有没有简单的方法来解决这个问题，还是我必须以另一种方式停止选择？---通过变通方法解决---

任何想法都会有所帮助。

这些是滚动的 3 个处理程序：

```
 mouseDownHandler : function(event) {

        if (!$(event.target).closest('.stopscroll').length) {

            event.data.lastCoord = {left: event.clientX, top: event.clientY}; 

            $.event.add( document, "mouseup", dragscroll.mouseUpHandler, event.data );
            $.event.add( document, "mousemove", dragscroll.mouseMoveHandler, event.data );

            $('body').addClass('dragcursor'); //// Add Move Cursor

            if (!$(event.target).closest('.noformelement').length) {
                event.preventDefault();
                return false;
            }
        }

    },

    mouseMoveHandler : function(event) { 
        var delta = {left: (event.clientX - event.data.lastCoord.left), top: (event.clientY - event.data.lastCoord.top)};

        event.data.scrollable.scrollLeft(event.data.scrollable.scrollLeft() - delta.left);

        $('.th-header').css('margin-left', -event.data.scrollable.scrollLeft()); //// Scrollsync with header

        event.data.scrollable.scrollTop(event.data.scrollable.scrollTop() - delta.top);

        event.data.lastCoord={left: event.clientX, top: event.clientY}

        if (!$(event.target).closest('.noformelement').length) {
            event.preventDefault();
            return false;
        }

    },

    mouseUpHandler : function(event) {
        $.event.remove( document, "mousemove", dragscroll.mouseMoveHandler);
        $.event.remove( document, "mouseup", dragscroll.mouseUpHandler);

        $('body').removeClass('dragcursor');

        if (!$(event.target).closest('.noformelement').length) {
            event.preventDefault();
            return false;
        }
    } 
```

更新/凹凸：我猜只需一次禁用每个点击事件就可以解决问题。我试过`$(document).on('click', '*', function() {return false;});`了，但它不起作用......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T18:38:55.260

解决了

```
mouseDownHandler : function(event) {

    if (!$(event.target).closest('.stopscroll').length) {

        event.data.lastCoord = {left: event.clientX, top: event.clientY}; 
        event.data.startCoord = {left: event.clientX, top: event.clientY};
        event.data.allowClick = true;
        $('*').off('click.stop');

        $.event.add( document, "mouseup", dragscroll.mouseUpHandler, event.data );
        $.event.add( document, "mousemove", dragscroll.mouseMoveHandler, event.data );

        if (!$(event.target).closest('.noformelement').length) {
            event.preventDefault();
            return false;
        }
    }

},

mouseMoveHandler : function(event) { 
    var delta = {left: (event.clientX - event.data.lastCoord.left), top: (event.clientY - event.data.lastCoord.top)};
    var range = {left: (event.clientX - event.data.startCoord.left), top: (event.clientY - event.data.startCoord.top)};
    if (event.data.allowClick && (Math.abs(range.left)>=5 || Math.abs(range.top)>=5)) {
        event.data.allowClick = false;
        $('*').on('click.stop', function() {return false;});
        $('body').addClass('dragcursor'); //// Add Move Cursor
    }

    event.data.scrollable.scrollLeft(event.data.scrollable.scrollLeft() - delta.left);

    $('.th-header').css('margin-left', -event.data.scrollable.scrollLeft()); //// Scrollsync with header

    event.data.scrollable.scrollTop(event.data.scrollable.scrollTop() - delta.top);

    event.data.lastCoord={left: event.clientX, top: event.clientY}

    if (!$(event.target).closest('.noformelement').length) {
        event.preventDefault();
        return false;
    }

} 
```

# java - 获取 javax.crypto.IllegalBlockSizeException：使用填充密码解密时输入长度必须是 16 的倍数？

> ID：10836139
> 
> 赞同：18
> 
> 时间：2012-05-31T15:00:49.220
> 
> 标签：java, encryption

使用tomcat，我有两个web 应用程序，即app1 和app2。我以加密形式（使用下面的代码）将 url 从 app1 发送到 app2 。然后在 app2 我解密了这个加密的 url。但是我在方法的第 50 行低于异常`decryp`。

```
"Getting javax.crypto.IllegalBlockSizeException: Input length must be multiple of 16 when decrypting with padded cipher" 
```

虽然当我尝试在 app1 解密（使用相同的代码）加密的 url 时进行调试，但它工作正常。但无法找出导致 app2 出现此异常的原因？

**这是代码**

```
import java.security.Key;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;

import sun.misc.BASE64Decoder;
import sun.misc.BASE64Encoder;

public class AESEncryptionDecryptionTest {

    private static final String ALGORITHM       = "AES";
    private static final String myEncryptionKey = "ThisIsFoundation";
    private static final String UNICODE_FORMAT  = "UTF8";

    public static String encrypt(String valueToEnc) throws Exception {
        Key key = generateKey();
        Cipher c = Cipher.getInstance(ALGORITHM);
        c.init(Cipher.ENCRYPT_MODE, key);  
        byte[] encValue = c.doFinal(valueToEnc.getBytes());
        String encryptedValue = new BASE64Encoder().encode(encValue);
        return encryptedValue;
    }

    public static String decrypt(String encryptedValue) throws Exception {
         Key key = generateKey();
         Cipher c = Cipher.getInstance(ALGORITHM);
         c.init(Cipher.DECRYPT_MODE, key);
         byte[] decordedValue = new BASE64Decoder().decodeBuffer(encryptedValue);
         byte[] decValue = c.doFinal(decordedValue);//////////LINE 50
         String decryptedValue = new String(decValue);
         return decryptedValue;
    }

    private static Key generateKey() throws Exception {
         byte[] keyAsBytes;
         keyAsBytes = myEncryptionKey.getBytes(UNICODE_FORMAT);
         Key key = new SecretKeySpec(keyAsBytes, ALGORITHM);
         return key;
    }

    public static void main(String[] args) throws Exception {

         String value = "password1";
         String valueEnc = AESEncryptionDecryptionTest.encrypt(value);
         String valueDec = AESEncryptionDecryptionTest.decrypt(valueEnc);

         System.out.println("Plain Text : " + value);
         System.out.println("Encrypted : " + valueEnc);
         System.out.println("Decrypted : " + valueDec);
    }

} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-31T16:13:44.710

在我的机器上工作。如果您在将字节转换为字符串（反之亦然）的每个实例中都使用“UNICODE_FORMAT”，它会有所帮助吗？这条线可能是个问题：

```
byte[] encValue = c.doFinal(valueToEnc.getBytes()); 
```

应该

```
byte[] encValue = c.doFinal(valueToEnc.getBytes(UNICODE_FORMAT)); 
```

无论如何，如果您使用“AES”作为算法并使用 JCE，那么实际使用的算法将是“AES/ECB/PKCS5Padding”。除非您 100% 确定自己在做什么，否则不应将 ECB 用于任何事情。我建议始终明确指定算法以避免这种混淆。“AES/CBC/PKCS5Padding”将是一个不错的选择。但请注意，使用任何合理的算法，您还必须提供和管理 IV。

在加密密码的上下文中使用 ECB 密码甚至更不可取，如果我正确解释您的示例，您似乎正在使用加密。为此，您应该使用 PKCS#5 中指定的基于密码的加密，在 Java 中，这是在[SecretKeyFactory](http://docs.oracle.com/javase/7/docs/api/javax/crypto/SecretKeyFactory.html)中为您提供的。确保使用具有足够高迭代次数的“PBKDF2WithHmacSHA1”（任何范围从 ~ 5-20 000，取决于您的目标机器），以便使用密码从中派生对称密钥。

如果它实际上是密码存储而不是您想要实现的密码加密，则可以使用相同的技术。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2018-07-21T15:09:24.663

我建议不要使用字符串，而是使用 byte[] 本身。我猜当您将其转换为字符串时会修改一些字节。以下代码对我有用 -

```
public static final String ENC_KEY = "abcdefghijklmnop";
public static final String DATA = "Hello World";

public static void test(){

    try {
        Cipher c = Cipher.getInstance("AES");

        SecretKeySpec secretKeySpec = new SecretKeySpec(ENC_KEY.getBytes("UTF-8"), "AES");

        c.init(Cipher.ENCRYPT_MODE, secretKeySpec);
        byte[] encBytes = c.doFinal(DATA.getBytes("UTF-8"));
        String encStr =  new String(encBytes, "UTF-8");
        System.out.println("Encrypted String: " + encStr);

        c.init(Cipher.DECRYPT_MODE, secretKeySpec);
        String decStr = new String(c.doFinal(encBytes),"UTF-8");
        System.out.println("Decrypted String: " + decStr);

    } catch (Exception ex) {
        System.out.println("Error in encrypting data");
        ex.printStackTrace();
    }
} 
```

但是如果你把它改成——

```
public static void test(){

    try {
        Cipher c = Cipher.getInstance("AES");

        SecretKeySpec secretKeySpec = new SecretKeySpec(ENC_KEY.getBytes("UTF-8"), "AES");

        c.init(Cipher.ENCRYPT_MODE, secretKeySpec);
        byte[] encBytes = c.doFinal(DATA.getBytes("UTF-8"));
        String encStr =  new String(encBytes, "UTF-8");
        System.out.println("Encrypted String: " + encStr);

        c.init(Cipher.DECRYPT_MODE, secretKeySpec);
        String decStr = new String(c.doFinal(encStr.getBytes("UTF-8")),"UTF-8");
        System.out.println("Decrypted String: " + decStr);

    } catch (Exception ex) {
        System.out.println("Error in encrypting data");
        ex.printStackTrace();
    }
} 
```

你会得到

> javax.crypto.IllegalBlockSizeException：在 com.sun.crypto.provider.CipherCore.doFinal( CipherCore.java:847) 在 com.sun.crypto.provider.AESCipher.engineDoFinal(AESCipher.java:446) 在 javax.crypto.Cipher.doFinal(Cipher.java:2164) 在 com.osfg.HelloWorld.test(HelloWorld .java:38) 在 com.osfg.HelloWorld.main(HelloWorld.java:22)

注意

```
String decStr = new String(c.doFinal(encBytes),"UTF-8");
VRS
String decStr = new String(c.doFinal(encStr.getBytes("UTF-8")),"UTF-8"); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-10-08T02:10:40.380

双重解密一个值时，我看到了这个错误（密码通过就好了，就像你在这里说的那样）。请务必检查您是否多次进行解密。（我的错误是 8 的倍数，但我在那里使用了不同的方案......）在我的情况下，我在读取文件时解密，然后在填写字段时再次解密。（桌面应用程序）

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-05-22T14:04:45.980

此错误表明您使用的选择组合仅需要 16 个字符的源文本。如果要对密码进行加密，可以将原始密码截断或填充为 16 字符进行加密，解密后进行修整。这种方式必须限制真实密码不超过 16 个字符，但您可能会使用更长的密码来混淆那些不应该知道您的密码的人。

# c# - 文件扩展名和 C#

> ID：10836140
> 
> 赞同：0
> 
> 时间：2012-05-31T15:00:49.933
> 
> 标签：c#, asp.net

我是 C# 和 ASP.NET 的新手，我正在尝试从目录中读取文件以便在页面上显示它们。我遇到的问题是我尝试读取的文件来自专有电话录音软件，并且文件没有扩展名，因此当我尝试使用 Directory.GetFiles( directoryName) 我没有得到任何回报，就好像目录是空的一样。但是，当我使用文件具有扩展名的不同目录时，我能够获取文件列表。

有任何想法吗？

代码示例

```
string path = "C:\\Users\\directoryName";

foreach (string filename in Directory.GetFiles(path))
{
 FileInfo file = new FileInfo(filename);
 string name = file.Name;
 Response.Write(name);
} 
```

预先感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:09:43.127

我有点怀疑它不适用于无扩展名文件。因此，我尝试了您在带有无扩展名文件的测试目录上的控制台应用程序中提供的代码。它对我来说很好，我不相信它没有扩展的事实是问题所在。

我会检查目录是否正确，IIS（您的应用程序的应用程序池帐户）是否有权访问目录中的文件，并且该目录中有文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:03:35.900

```
Use Directory.GetFiles(path, "*.*") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T15:13:26.847

如果您只想获取没有扩展名的文件，您可以执行以下操作：

```
 foreach (String sFile in Directory.GetFiles("PATH", "*."))
        {
            Responce.Write(System.IO.Path.GetFileName(sFile));
        } 
```

我也同意 Chris 的观点，IIS 可能无权访问目录以列出文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T15:03:48.543

您可以使用[Directory.GetFiles](http://msdn.microsoft.com/en-us/library/wz42302f)重载来包含所有文件。

```
Directory.GetFiles(path, "*") 
```

# elasticsearch - 带有分页的 ElasticSearch 重复结果

> ID：10836142
> 
> 赞同：10
> 
> 时间：2012-05-31T15:00:56.387
> 
> 标签：elasticsearch

我正在使用带有pyes的elasticsearch。我在最后一页的结果中得到了重复。这是我的查询：

```
"query": {
    "query": {
        "filtered": {
            "filter": {
                "and": [
                    {
                        "match_all": {

                        }
                    }
                ]
            },
            "query": {
                "bool": {
                    "minimum_number_should_match": 1,
                    "should": [
                        {
                            "text": {
                                "name.keyword_name": {
                                    "operator": "and",
                                    "query": "kentucky",
                                    "type": "boolean",
                                    "fuzziness": 0.8
                                }
                            }
                        },
                        {
                            "text": {
                                "address": {
                                    "operator": "and",
                                    "query": "kentucky",
                                    "type": "boolean"
                                }
                            }
                        },
                        {
                            "text": {
                                "neighborhoods.name": {
                                    "operator": "and",
                                    "query": "kentucky",
                                    "type": "boolean",
                                    "fuzziness": 0.8
                                }
                            }
                        },
                        {
                            "text": {
                                "categories.name": {
                                    "operator": "and",
                                    "query": "kentucky",
                                    "type": "boolean",
                                    "fuzziness": 0.8
                                }
                            }
                        }
                    ]
                }
            }
        }
    },
    "facets": {
        "neighborhoods.id": {
            "terms": {
                "field": "neighborhoods.id",
                "size": 10
            }
        },
        "categories.id": {
            "terms": {
                "field": "categories.id",
                "size": 10
            }
        }
    },
    "size": 15,
    "from": 15,
    "fields": [
        "id",
        "categories.id",
        "name",
        "address",
        "city",
        "state",
        "zipcode",
        "location",
        "_id",
        "pos_review_count",
        "neg_review_count",
        "wishlist_count",
        "recommender_count",
        "checkin_count"
    ]
}, 
```

在这个查询中，我有

```
 "size": 15,
    "from": 15, 
```

而且对于这个特定的查询，返回的对象的总计数是 24。“从”为 15，总计数为 24，我想在这里得到 9 个结果。但相反，因为我将“大小”设置为 15，所以我得到 15 个结果条目。由于只剩下 9 个唯一结果，因此将显示 6 个文档两次。关于如何使这个给我9个结果而不是15个重复的任何想法？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-05-14T15:48:44.290

如果你有多个分片上的数据，它可能会返回多次，我不知道为什么。抱歉，这不是很具体，因为我不知道为什么会这样。

尝试使用首选项：[http ://www.elastic.co/guide/en/elasticsearch/reference/1.4/search-request-preference.html](http://www.elastic.co/guide/en/elasticsearch/reference/1.4/search-request-preference.html)

我们使用首选项自定义字符串，它修复了我们的重复数据问题。

你的复制设置是什么？数据是否可能在多个分片上？你用的是什么版本？

不幸的是，使用 pyes，您无法在多搜索调用中指定首选项。尝试在搜索调用中将首选项指定为查询参数。

搜索（索引=...，.....，偏好=）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-10-05T14:36:43.907

问题是您正在按在文档中具有重复值的字段（或默认情况下按 _score）进行排序。我的理解是，不同的分片可能以不同的顺序对重复的字段值进行排序。

因此，当您为每个请求获得不同的分片时，您可能会获得不同的排序顺序，因此，您可能会将相同的文档排序到两个不同的页面上（取决于您询问的分片）。

正如上面提到的 TheJeff，解决方法是指定 _search?preference=my-paging-key 以确保每个页面请求使用一致的分片

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-19T07:51:20.693

只是想在这里分享与此相关的经验，由于多个分片，在使用 from/size 分页参数和搜索查询时，我还在不同的页面中获得了重复的结果。

我尝试了这里记录的一些关于[ElasticSearch](https://www.elastic.co/guide/en/elasticsearch/reference/6.8/search-request-preference.html#search-request-preference)中的首选项的事情，并且在主分片上执行查询已经为我解决了这个问题。

> “偏好”：“_primary_first”

如果你使用的是 python 库，你可以考虑这个参考：

[https://elasticsearch-py.readthedocs.io/en/master/api.html#elasticsearch.Elasticsearch.search](https://elasticsearch-py.readthedocs.io/en/master/api.html#elasticsearch.Elasticsearch.search)

# session - Node.js：无法在 redis pubsub 事件中更新会话？

> ID：10836143
> 
> 赞同：0
> 
> 时间：2012-05-31T15:00:56.703
> 
> 标签：session, node.js, redis, publish-subscribe

我正在尝试开发一个 node.js 应用程序，它使用 redis 在后端进程和节点之间传递消息。

我希望能够在收到消息的用户会话（连接会话）指示器中保存。

当用户执行 ajax 查询“IsMessageRecieved”时，我想向他返回我在会话中放置的值。

我试图用下面的代码来做这件事，但没有成功，会话没有被更新。

```
redisSub.on("message", (channel, connectsid) ->
  sessionStore.get connectsid, (err, session) ->
    if (err || !session)
      return
    else
      session.MessageRecieved = true
      redisSub.unsubscribe('USER_DATA_READY_' + connectsid)
      return
  return
) 
```

你知道可能是什么问题吗？

谢谢，里奥

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T03:39:36.480

我将您的示例简化为：

```
var redisSub = require('redis').createClient();
redisSub.subscribe('USER_DATA_READY_abc');
redisSub.on("message", function(channel, connectsid) {
    console.log(channel, connectsid);
}); 
```

然后运行 ​​redis-cli 手动发布到频道，值为“abc”。

```
~ % redis-cli
redis 127.0.0.1:6379> publish USER_DATA_READY_abc abc
(integer) 1 
```

并得到了预期的输出：

```
USER_DATA_READY_abc abc 
```

**这是我的建议**

*   通过添加日志消息确保实际调用了 on("message")。
*   使用 redis-cli 手动发布现有会话，看看是否会触发回调中的任何结果。

我怀疑没有发布，或者您没有订阅正确的频道。

# android - 将表情符号从 iPhone 发送到 android

> ID：10836144
> 
> 赞同：0
> 
> 时间：2012-05-31T15:00:58.217
> 
> 标签：android, iphone, emoji

我正在开发一个具有聊天功能的 android 和 iPhone 应用程序。

我已经实现了对两者的表情符号支持。
Android keboards 正在使用 iPhone 可以理解的 SoftBank 表情符号编码，但我对 iPhone -> 带有表情符号的 Android 消息传递有疑问。例如，在 iPhone 2 中选择“Pile of Poo”（SoftBank 编码 0xe05a）时，发送的字符是：
0xD83D 0xDCA9

如何将这些字符转换回 SoftBank 编码？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T16:06:22.637

有点重复[如何将旧的表情符号编码转换为iOS5中的最新编码？](https://stackoverflow.com/questions/7856775/how-to-convert-the-old-emoji-encoding-to-the-latest-encoding-in-ios5)

另请注意受影响的 iOS 版本。

表格地图可以在[这里](http://punchdrunker.github.com/iOSEmoji/table_html/)找到。看来代码 0xD83D 0xDCA9 是正确的 UTF16 编码。

# c++ - 细粒度访问说明符 c++

> ID：10836150
> 
> 赞同：3
> 
> 时间：2012-05-31T15:01:18.950
> 
> 标签：c++, oop, private-members, access-specifier

我有以下课程：-

```
class A {
  public:
    // some stuff that everyone should see
  protected:
    // some stuff that derived classes should see
  private:
    // some stuff that only I can see
    void f();
    void g();
}; 
```

现在，我希望 f() 只能从特定的类集（比如 B、C、D 类）访问，而 g() 可以从特定的其他类集（比如 D、E、F 类）访问。有没有办法在 C++ 中指定这个？如果我让所有班级成为 A 的朋友，那么 f 和 g 都可以从 B、C、D、E、F（以及 A 的其他私有成员）访问，这不是我想要的。

这是可能的还是我应该改变我的对象模型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:14:51.977

```
class A_f {
    friend class B;
    void f();
};

class A_g {
    friend class C;
    void g();
};

class A: public A_f, public A_g {
    friend class A_f;
    friend class A_g;
private:
    void do_f();
    void do_g();
};

inline void A_f::f() { static_cast<A *>(this)->do_f(); }
inline void A_g::g() { static_cast<A *>(this)->do_g(); }

void B::something(A *a) {
    a->f();
} 
```

# javascript - .replace() 不适用于使用雪豹的 safari 上的变音符号

> ID：10836159
> 
> 赞同：0
> 
> 时间：2012-05-31T15:01:47.000
> 
> 标签：javascript, jquery, special-characters

我有一个从任何给定值中删除特殊字符的功能，但是我对德语变音符号的替换似乎不适用于雪豹的 safari：

```
this_string = this_string.replace(/Ä/g, '&#196;'); 
```

我假设，它没有在文本中找到变音符号。我对此不太确定，所以我检查了我的替换不会被接受的情况，并用一个词替换了变音符号：

```
this_string = this_string.replace(/Ä/g, 'test'); 
```

但我仍然以原始内容结束。浏览谷歌寻找解决方案最终只能找到将我的代码作为替换字符的正确方法的帖子。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:05:52.820

试试这个：

```
this_string = this_string.replace("Ä", 'test'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-24T01:07:55.867

对于这个问题的所有未来读者：

问题是我必须将我的 .js 文件的编码设置为与变音符号兼容的格式。

玩得开心编码！=)

# facebook - Facebook 仅使用 JavaScript SDK 上传视频

> ID：10836164
> 
> 赞同：4
> 
> 时间：2012-05-31T15:01:54.427
> 
> 标签：facebook, video, upload

如何？？我试试这段代码：

```
FB.api('/me/videos', 'post', {
   message: FacebookMessage,
   access_token: accessToken,
   source: "@HERE_WORKING_URL",
  // url: type[1],
   type: 'video',    
}, function(response){
    if (!response || response.error) {
        console.log('Error occured'+response.error.message);
    } else {
        console.log('Post ID: ' + response.id);
    }
    comp(s++,photon.length);
}); 
```

我得到错误：发生错误（#353）缺少视频文件

怎么了？我如何发送视频？请帮忙！

如果我张贴照片，它的工作！

# javascript - RequireJS 使用多个数据主

> ID：10836170
> 
> 赞同：9
> 
> 时间：2012-05-31T15:02:16.767
> 
> 标签：javascript, requirejs

我正在使用 RequireJs 2.0（或尝试使用）。

目前，我的资产分为“常规”和“自定义”部分。所有页面都应该使用通用脚本，而只有一些页面应该使用自定义。

据我所知，RequireJs 接受一个`data-main`包含您的配置和基本上您的模块需要的值。如果所有页面都使用相同的资产，这很好，但我将如何为自定义页面添加额外的`data-main`脚本？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T19:17:04.990

使用您的`data-main`属性加载您的常规脚本。在自定义页面上，无论您要做什么需要自定义模块，只需将其包装在`require`调用中即可。您的母版页（或模板或布局或在您的服务器平台上调用的任何内容）将具有以下内容：

```
<html><head>
<script language="javascript" src="require.js" data-main="general" ></script>
</head> 
```

您的自定义页面标记可能如下所示（内存中的语法；仔细检查！）

```
<p class="funny">I'm a funny paragraph</p>
<script language="javascript">
require(['funny-stuff'], function(fs) {
  fs.doSomthing();
});
</script> 
```

该`funny-stuff`模块只会被请求它的页面加载。如果您不想或不能在某些页面上使用单独的标记，则可以通过将`require`调用包装在`if`语句中来从主脚本动态加载依赖项。内`general.js`：

```
// Determine if we need the custom module
if (isFunnyPage()) {
  require(['funny-stuff'], function(fs) {
    fs.doSomething();
  });
} 
```

运行优化器时必须小心，因为它会找到`require`调用中引用的依赖项，并默认将其与主文件一起打包。因此，您需要配置优化器以排除自定义模块。

# javascript - 我想在实例化一个对象时返回 false

> ID：10836172
> 
> 赞同：0
> 
> 时间：2012-05-31T15:02:26.487
> 
> 标签：javascript

好吧，这不是一个简单的问题，但在[小提琴](http://jsfiddle.net/DpdVd/)中你会看到我正在尝试做的事情的简化版本：

我想实例化一个对象，执行初始化它所需的所有操作，但我想要以下语句：

```
var obj = new class; 
```

在某些条件下将“假”返回给 obj。

无论如何，这是代码：

```
var cl = function(id){
   this.init(id);
   if(this.id > 5){
       return false;
   }
};

cl.prototype = {
    init: function(id){
        this.id = id;                        

    }
}

var arr = [];

for(i = 0; i < 10; i++){
    var obj = new cl(i);
    if(obj){
         arr.push(obj);
    }
}

console.log(arr); 
```

我知道最终结果可以通过为对象创建一个控制属性来实现，但我很好奇是否有任何模式可以做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:22:31.030

也许不完全是您所要求的，但解决方案可能是使用工厂模式。当然，您必须调用`factory`方法而不是构造函数。看看[这个小提琴](http://jsfiddle.net/DpdVd/1/)

# javascript - 遍历和读取 json 数据

> ID：10836174
> 
> 赞同：0
> 
> 时间：2012-05-31T15:02:41.010
> 
> 标签：javascript, ajax, json

我正在使用 ajax 从服务器获取 json 字符串，然后使用 eval 将其转换为对象。当我遍历json数据时，我只得到了密钥。如何获取密钥的值。这就是我所拥有的：

```
var jsonobj = eval('(' + xmlhttp.responseText + ')');

for (i in jsonobj){
     alert(i);
} 
```

这会提醒按键。如何获取密钥的值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:04:09.080

使用子脚本表示法：`jsonobj[i]`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T15:04:15.973

试试这个：

```
var jsonobj = eval('(' + xmlhttp.responseText + ')');
var value;

for (i in jsonobj){
     value = jsonobj[i];
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-31T15:05:39.977

如果服务器返回 JSON，则不需要使用 eval。只需指定`dataType`jQuery 就会自动为您解析结果：

```
$.ajax({
    url: '/script',
    type: 'POST',
    dataType: 'json',
    success: function(result) {
        for (var key in result) {
            if (result.hasOwnProperty(key)) {
                alert('key: ' + key + ', value: ' + result[key]);
            }
        }
    }
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-31T15:05:51.780

```
var jsonobj = eval('(' + xmlhttp.responseText + ')');

for (i in jsonobj){
    alert(jsonobj[i]);
} 
```

# serial-port - 如何在串行通信中读/写回车/换行符

> ID：10836183
> 
> 赞同：1
> 
> 时间：2012-05-31T15:03:05.383
> 
> 标签：serial-port, ascii

我正在建立一个到一个非常简单的嵌入式平台的串行连接。单个字节旨在作为命令发送并作为状态代码返回。我想：

*   发送命令时 - 当我按 Enter 发送一些 ascii 符号来代表含义时，通常与“Enter”相关联 - 继续

*   接收代码时 - 我想发送字符串，以换行符结尾。

[ascii](http://www.asciitable.com/)表中是否有一个符号用于处理这些情况，或者是否有两个单独的符号，或者没有。

我在 XP 下使用[RealTerm](http://realterm.sourceforge.net/)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:05:09.870

取决于操作系统，但通常 10 是换行符，13 是回车

# javascript - 在javascript函数中使用它的目的是什么？

> ID：10836192
> 
> 赞同：0
> 
> 时间：2012-05-31T15:03:38.413
> 
> 标签：javascript

我看到了一种使用的风格

```
var test = function() {
    var that = this;
    this.show() {
        that.***；
    }
} 
```

我想知道为什么`that`在函数中使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:06:10.773

using 的目的`that`是在构造函数的上下文中捕获`this`。当函数被调用时，`this`在不同的上下文中（我相信调用者），所以当 test() 被调用时，`this`它不会是你所期望的（除非你理解 JavaScript，在这种情况下它会是你所期望的）它是，但不是你想要的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:05:14.997

捕获 的正确值`this`。JS 的`this`语义有点……时髦，IMO。

什么是“正确的”取决于您实际需要什么，但`this`评估较晚。换句话说，`this`运行时的值很可能与函数定义时的值不同。通过在定义时捕获它，您可以确保它是您需要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:06:08.740

因为`this`关键字在javascript中的函数之间不是持久的。如果您将其保存在局部变量中`that = this`，则可以从局部函数中访问它，无论您对它们应用什么上下文。

```
var test = function() {
    console.log(this); // foo
    var that = this;
    var inner = function() {
        console.log(this); // bar
        console.log(that); // foo
    }
    inner.call('bar');
};

test.call('foo'); 
```

# c# - 忽略 C# 中的无效邮件服务器证书

> ID：10836195
> 
> 赞同：1
> 
> 时间：2012-05-31T15:03:52.813
> 
> 标签：c#, .net, windows

我正在尝试发送电子邮件，尽管返回了一条错误消息：

> 根据验证程序，远程证书无效

我的代码如下：

```
 static void sendEmail()
        {
            var fromAddress = new MailAddress("xxxxxxxx@xxxxxxxx", "xxxxxxx");
            var toAddress = new MailAddress("xxxxxxxx@xxxxxxxx", "xxxxxxxx");
            const string fromPassword = "xxxxxxxxxxxx";
            const string subject = "xxxxxxxxxxxxxxxxxxxxx";

            var smtp = new SmtpClient
            {
                Host = "mailserver",
                Port = 587,
                EnableSsl = true,
                DeliveryMethod = SmtpDeliveryMethod.Network,
                UseDefaultCredentials = false,
                Credentials = new NetworkCredential("username", fromPassword)
            };
            using (var message = new MailMessage(fromAddress, toAddress)
            {
                Subject = subject,
                Body = bodyglobal
            })
            {
                smtp.Send(message);
            }

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:31:39.847

尝试设置

```
 EnableSsl = false; 
```

几周前我遇到了这个问题，这就是解决方法。如果您的程序不需要/使用 SSL，则 smtpexecption 将触发该错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:46:12.353

发送电子邮件取决于 SMTP 服务器的配置方式。

> 根据 gmail confiruged 你需要删除这行代码

```
UseDefaultCredentials = false, 
```

只需评论此行，您的消息就会被发送。

```
 var smtp = new SmtpClient
        {
            Host = "mailserver",
            Port = 587,
            EnableSsl = true,
            DeliveryMethod = SmtpDeliveryMethod.Network,
            // do not use this command
           // UseDefaultCredentials = false,
            Credentials = new NetworkCredential("username", fromPassword)
        }; 
```

Microsoft 建议尽可能不要使用 defaultcredentials。看到 [这个](http://msdn.microsoft.com/en-us/library/system.net.webclient.usedefaultcredentials%28v=vs.100%29.aspx)

# sql-server - 如何从此文本文件在 SQL 中创建表？

> ID：10836196
> 
> 赞同：2
> 
> 时间：2012-05-31T15:03:58.147
> 
> 标签：sql-server, sql-server-2008

我正在尝试使用 SQL 在数据库中创建一个表。数据当前位于一个看起来像[这样](http://i.imgur.com/rYUnY.png)的文本文件中，但有数千行这样的。

我的麻烦主要在于“CREATE TABLE”函数的参数。有没有办法说我想要所有的列？现在代码看起来像：

```
CREATE TABLE dbo.CFTC_Fin_Data
(

)

BULK INSERT dbo.CFTC_Fin_Data
    FROM 'H:\user\Desktop\CFTCData1.txt' 
    WITH 
    ( 
        FIELDTERMINATOR = ',', 
        ROWTERMINATOR = '\n' 
    ); 
```

谢谢你的帮助。我对 SQL 很陌生，所以如果已经回答了类似的问题，我深表歉意，但我无法理解我阅读的任何答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:08:39.807

您的数据文件中有 4 列，您必须指定它们：

```
CREATE TABLE dbo.CFTC_Fin_Data
(
column_name1 data_type,
column_name2 data_type,
column_name3 data_type,
column_name4 data_type
) 
```

（插入适当的列名和数据类型）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:11:47.917

好吧，你必须查看你的文件，看看你在每个领域都有什么样的信息。

使用文件中的行，似乎

Field1 是一个字符串（3 个字符，其他行可能更多）？=>`NVARCHAR(100)`

Field2 是一个字符串（xx 字符）=>`NVARCHAR(255)`

Field3 是 DATE => DATE

Field4 似乎是各种东西 =>`NVARCHAR(100)`

所以像

```
CREATE TABLE dbo.CTFC_Fin_Data (
column1 NVARCHAR(100),
column2 NVARCHAR(255),
column3 DATE,
column4 NVARCHAR(100)
) 
```

但是您需要检查所有文件以找到真正正确的值和数据类型

**编辑 ：**

事实上，你真的需要用代码来做吗？

因为使用导入导出向导（在 SQL Server Management Studio 中），您可以导入数据文件，如果需要，向导可以为您创建表。

尝试 ：

右键单击您的数据库名称，=> 任务 => 导入数据

并按照向导。

如果需要，您还可以保存 SSIS 包。

认为它会更适合你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T17:02:50.893

只是为了添加上面发布的答案，如果您不限于使用批量插入，那么您可能可以使用 openrowset。使用 Openrowset 的优点是您可以将值插入到动态创建的表中。由于列数不同，您可以尝试使用以下语法

```
 SELECT * INTO newTable

 FROM OPENROWSET(...) 
```

# objective-c - 带图像的选择器视图

> ID：10836203
> 
> 赞同：-1
> 
> 时间：2012-05-31T15:04:14.660
> 
> 标签：objective-c, ios, xcode, image, uipickerview

我试图实现一个选择器视图，但我希望它有图像而不是文本，因此用户滚动图像以选择一个，例如带有标志而不是文本的国家选择器。

有没有办法做到这一点？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:12:14.640

使用[`UIPickerViewDelegate`](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIPickerViewDelegate_Protocol/Reference/UIPickerViewDelegate.html)and[`UIPickerViewDataSource`](http://developer.apple.com/library/ios/#documentation/iPhone/Reference/UIPickerViewDataSource_Protocol/Reference/Reference.html)您可以指定高度，以及每行的自定义视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:13:33.853

您可以使用此方法：

```
- (UIView *)viewForRow:(NSInteger)row forComponent:(NSInteger)component 
```

在您的委托和数据源类中为您的选择器中的自定义视图。只需将图像添加到您的 UIView。

# python - 在 ElementTree 中使用 XPath 按文本查找元素

> ID：10836205
> 
> 赞同：18
> 
> 时间：2012-05-31T15:04:23.950
> 
> 标签：python, xml, xpath, elementtree

给定如下的 XML：

```
<root>
    <element>A</element>
    <element>B</element>
</root> 
```

如何使用 ElementTree 及其对 XPath 的支持将元素与内容 A 匹配？谢谢

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-05-31T15:12:55.040

AFAIK ElementTree 不支持 XPath。它改变了吗？

无论如何，您可以使用[lxml](http://lxml.de)和以下 XPath 表达式：

```
import lxml.etree
doc = lxml.etree.parse('t.xml')
print doc.xpath('//element[text()="A"]')[0].text
print doc.xpath('//element[text()="A"]')[0].tag 
```

结果将是：

```
A
element 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-31T15:58:00.547

如果您想使用标准库[ElementTree](http://docs.python.org/library/xml.etree.elementtree.html)而不是 lxml，您可以使用迭代来查找具有特定文本值的所有子元素。例如：

```
import sys
import xml.etree.ElementTree as etree

s = """<root>
    <element>A</element>
    <element>B</element>
</root>"""

e = etree.fromstring(s)

if sys.version_info < (2, 7):
    found = [element for element in e.getiterator() if element.text == 'A']
else:
    found = [element for element in e.iter() if element.text == 'A']

print found[0].text # This prints 'A', honestly! 
```

注意：您可能希望`text`在列表推导中对元素的值进行一些剥离。

**编辑**这将适用于您的 XML 树中的任何深度。例如，

```
s = """<root>
    <element>A</element>
    <element><sub>A</sub></element>
</root>"""

found = [element for element in e.getiterator() if element.text == 'A']

for f in found:
    print f 
```

将打印

```
<Element element at 7f20a882e3f8>
<Element sub at 7f20a882e4d0> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-11-07T23:18:26.610

您可以[在 ElementTree 中使用 XPath](https://docs.python.org/2/library/xml.etree.elementtree.html#xpath-support)的子集。不需要安装任何库。

```
config.findall('.//*[element="A"]/element') 
```

正如@Bionicegenius 的评论所解释的那样，如果您的元素没有兄弟姐妹，上面的表达式才有效，但您明白了。

**可以在 ElementTree 中使用 XPath**，这是最简单的解决方案。

# jquery - JQuery UI 对话框 - IE 中没有滚动条

> ID：10836206
> 
> 赞同：0
> 
> 时间：2012-05-31T15:04:34.563
> 
> 标签：jquery, jquery-ui, internet-explorer, scrollbar, jquery-ui-dialog

我在 JQuery UI 对话框中显示大量信息，该对话框在除 IE 之外的所有浏览器中都运行良好；在 IE 中，垂直滚动条永远不会出现，将对话框拉伸到页面下方。在所有其他浏览器中，框会自动添加滚动条，防止框改变大小。

我在创建对话框时明确设置了高度。我还尝试在创建对话框后显式更改高度，如

```
$('#dialogID').dialog( ... ).height('600'); 
```

无济于事。我已经搞砸了！DOCTYPE，也是徒劳的。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T16:26:58.223

你可以试着把这个放在 div`style=" overflow:scroll"`

# c# - 用于检测和替换列表中的组的算法

> ID：10836208
> 
> 赞同：1
> 
> 时间：2012-05-31T15:04:40.493
> 
> 标签：c#, algorithm, grouping

我有一个对象列表：例如`A, A, B, C, D, E, E`

我已经定义了告诉对象类型如何分组的模板，例如

```
 Group Alpha --> A 1..n --> any number of 'A's can be grouped
 Group Charlie --> Sequences of 'BCD' can be grouped
 Group Epsilon --> E 1..n --> any number of 'E's can be grouped 
```

现在我想在原始列表中应用这些组定义，这应该会给出结果：

```
 Group Alpha (2x'A'), Group Charlie (1x'BCD'), Group Epsilon (2x'E') 
```

如何才能最好地实现这一目标？我的问题是否有已知的搜索算法/模式？我尝试了一种非常基本的方法，在列表中循环多次，并尝试从每个列表条目和匹配模式中向前看，但由于复杂性而完全迷失了......

提前感谢您的任何提示！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:20:47.223

这是一个修改后的字符串匹配问题。您有两种类型的输入：

1.  像“BCD”这样的。如果你只有这个，可以在[这里使用任何常规算法进行匹配](http://en.wikipedia.org/wiki/String_searching_algorithm)

2.  一行中任意数量的相同对象。

我想到了两个解决方案：

1.  使用传统的字符串算法（KMP 或其他），但为第二种类型的输入制定例外规则。

2.  构建一个有向图，如：

![在此处输入图像描述](../Images/ccd3e5192771740aecb3681dc655f626.png)

好吧，上图画得不好。如果您有任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T16:35:00.560

我不完全确定这是您需要的，但是通过这个小代码，我可以创建您指定的输出

简单用法（带断言）：

```
var a1 = new List<string> { "A", "A", "B", "C", "D", "E", "E" };

a1.ApplyCriteria("A").Criteria.Should().Be("A");
a1.ApplyCriteria("A").Count.Should().Be(2);

a1.ApplyCriteria("E").Criteria.Should().Be("E");
a1.ApplyCriteria("E").Count.Should().Be(2);

a1.ApplyCriteria("BCD").Criteria.Should().Be("BCD");
a1.ApplyCriteria("BCD").Count.Should().Be(1);

a1.ApplyCriteria("CD").Criteria.Should().Be("CD");
a1.ApplyCriteria("CD").Count.Should().Be(1);

// not found
a1.ApplyCriteria("CDA").Criteria.Should().Be("CDA");
a1.ApplyCriteria("CDA").Count.Should().Be(0); 
```

ApplyCriteria 方法返回的我的 GroupResult 类如下所示：

```
class GroupResult
{
    public string Criteria { get; set; }
    public int Count { get; set; }
} 
```

这些是做实际工作的扩展方法

```
static class Ext
{
    public static GroupResult ApplyCriteria(this IEnumerable<string> source, string criteria)
    {
        var elements = source.ToConcatenedString();

        return new GroupResult { Criteria = criteria, Count = elements.CountOcurrences(criteria) };
    }

    public static int CountOcurrences(this string source, string phrase)
    {
        return source
            .Select((c, i) => source.Substring(i))
            .Count(sub => sub.StartsWith(phrase));
    }

    public static string ToConcatenedString<TSource>(this IEnumerable<TSource> source)
    {
        var sb = new StringBuilder();

        foreach (var value in source)
        {
            sb.Append(value);
        }

        return sb.ToString();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T15:21:33.323

假设您有某种代码来比较对象，并告诉什么是 A 和什么 B，您可以将模板定义为一个数组，然后遍历您的原始列表，搜索模板的出现。

```
CustomObj[] template = new CustomObj[]{B,C,D};
for (int i=0; i< originalList.Length- template.Length + 1; i++)
{
     bool found= true;
     for(int j=0; j< template.Length;j++)
     {
        found = template[j] == originalList[i +j];
     }
     if (found)
     {
        //add to results list
      }
} 
```

搜索比较算法（其中最简单的，据我所知）使用这些概念，也使用了一些压缩算法，但它们从另一端工作（构建模板以通过创建模板索引来减少存储）

**编辑**
原来我实际上实现了[简单的 Rabin-Karp 算法](http://en.wikipedia.org/wiki/Rabin%E2%80%93Karp_string_search_algorithm)
，我记得它是这样的:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T15:27:40.440

在最基本的基础上，您可以构建一个[状态机](https://stackoverflow.com/questions/525004/short-example-of-regular-expression-converted-to-a-state-machine)。它将有 6 个状态，“Init”、“alpha”、“B”、“C”、“charlie”和“epsilon”。

从初始化开始：

*   如果下一个对象是“A”，则进入状态 alpha，将 alpha 计数器加 1。
*   如果下一个 obj 是 B，则转到状态 B。
*   如果下一个对象是“E”，则进入状态 epsilon，增加 Epsilon 计数器。
*   如果有任何其他对象，则保持 init 状态。

在 aplha 州：

*   如果下一个对象是 A，则保持状态 alpha。
*   如果下一个对象是 B，则转到状态 B
*   如果下一个 obj 是 E ，则进入状态 epsilon 并增加 epsilon 计数器。
*   如果还有其他问题，请转到 init。

在状态 B：

*   如果下一个是 A，则转到 alpha 和 inc 计数器
*   如果下一个是 E，则转到 epsilon，inc 其计数器。
*   如果next是C，则进入状态C
*   其他任何东西->进入初始化

在状态 C：

*   如果下一个是 A，则转到 alpha 和 inc 计数器
*   如果下一个是 E，则转到 epsilon，inc 其计数器。
*   如果下一个是D，去状态查理，增加查理计数器
*   其他任何东西->进入初始化

在状态 D：

*   如果下一个是 A，则转到 alpha 和 inc 计数器
*   如果下一个是 E，则转到 epsilon，inc 其计数器。
*   如果next是B，则进入状态B
*   其他任何东西->进入初始化

在状态 epsilon 中：

*   如果下一个对象是“A”，则进入状态 alpha，将 alpha 计数器加 1。
*   如果下一个 obj 是 B，则转到状态 B。
*   如果下一个对象是“E”，则什么也不做。
*   如果有任何其他对象，则进入初始状态。

我知道它看起来很复杂，但实际上并非如此，至少在这一点上，尤其是在创建状态图时。当然，如果你想要更通用的东西，或者你想不断添加新的模式，或者你有更多的模式，它很快就会变得非常复杂。在这种情况下，我相信你最好的办法是让一种[字符串匹配算法](http://en.wikipedia.org/wiki/Category:String_matching_algorithms)适应你的问题。

# templates - Play 2.0 中的普通 Scala 模板

> ID：10836211
> 
> 赞同：1
> 
> 时间：2012-05-31T15:04:51.977
> 
> 标签：templates, scala, playframework-2.0

由于 Intellij 还不支持 Play-Scala-Template-Engine 我暂时考虑使用普通 Scala，因为没有代码完成，导入帮助确实减慢了我的开发速度。

是否可以在 Play 2.0 中使用**普通的 Scala**而不是 @-ish 包装器作为模板引擎？我想我可以简单地`return ok(Htmp.apply("fooo"))`从我的（java）控制器中构建视图生成静态方法在 scala 作为我的伪模板，但我希望项目的整体结构类似于“原始”。

为了显示：

我的 -Controller 的普通模板`Meetings`将存储在

`/app/views/Meetings/list.scala.html`

看起来类似于这样：

```
@(currentUser: User, meetings: Set[Meeting])

@main("Possible Meeting Dates") {
 @for(meeting <- meetings){
  "do fancy layout"
 }
} 
```

我**希望**整个东西都存储在

`/app/views/Meetings/list.scala`

并包含类似于此的内容：

```
import play.api.templates._

def render(user: User, meetings:Set[Meeting]): Html = {
  Html("doing the layout here")
} 
```

所以我的 IDE 知道这是 Scala 并相应地提供帮助。在将文件重命名为时执行后者`list.scala.html`并不完全有效：`play compile`导致生成一些引用。我可以打电话

`views.html.Meetings.list.render()`

像预期的那样，但它不带任何参数。

我是否需要遵守特定的签名才能使编译器魔术起作用，或者整个想法根本不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T20:35:07.303

我尝试了一个非常个人化的解决方案。报告（但不喜欢：-（）在这里：

[https://stackoverflow.com/questions/7731573/how-would-you-improve-this-scala-basic-xml-template](https://stackoverflow.com/questions/7731573/how-would-you-improve-this-scala-basic-xml-template)

希望能有所帮助...

# javascript - 将 .detach() 与页面上的多个 ajax 元素一起使用

> ID：10836213
> 
> 赞同：0
> 
> 时间：2012-05-31T15:05:06.893
> 
> 标签：javascript, jquery, ajax, detach

我正在使用 jQuery ajax 将数据库中的内容加载到页面中。我有多个内容 div，但一次只想查看一个 div。

我已经成功地将元素与 dom 分离，但我不知道如何管理多个 div，以便一次只显示 1 个 div（而其他 div 保持分离）。

下面是我的代码，这里是一个小提琴：http: [//jsfiddle.net/XkzUK/](http://jsfiddle.net/XkzUK/)

HTML：

```
<nav>
<ul id="site-nav">
<li class="nav1"><a href="#recent">Recent</a></li>
<li class="nav2"><a href="#highlights">Highlights</a></li>
</ul>
</nav>

<div id="content-listing">

<div id="recent">
<ul class="top-level">
</ul>
</div><!--end recent-->

<div id="highlights">
<ul class="top-level">
</ul>
</div><!--end highlights-->

</div><!--end content-listing-->​ 
```

JS：

```
var test; var test2
     //Recent $("#site-nav .nav1").on("click", function (event) {
    $("#site-nav li a").parents().removeClass("nav-active");
    $(this).addClass("nav-active");
    if(typeof test === 'undefined') {
        test = $("#recent ul.top-level").load('/echo/html/', { html: '<li>1</li> <li>2</li> <li>3</li>' }, function () {
            //$(this).show().siblings().detach();
            alert("I'm new");
        });
    } else {
        test.appendTo("#content-listing");
        alert("I'm old");
    }
    event.preventDefault(); });

//Highlights $("#site-nav .nav2").on("click", function(event) {
    //test = $("#recent").detach();
    $("#site-nav li a").parents().removeClass("nav-active");
    $(this).addClass("nav-active");
    if(typeof test2 === 'undefined') {
        test2 = $("#highlights ul.top-level").load('/echo/html/', { html: '<li>Apples</li> <li>Oranges</li> <li>Pears</li>' }, function () {
            //$(this).show().siblings().detach();
            alert("I'm new");
        });
    } else {
        test2.appendTo("#content-listing");
        alert("I'm old");
    }
    event.preventDefault(); });​ 
```

CSS：

```
.nav-active,.nav-active a{background-color:#fff;color:#e84182 !important;outline:none;}
.sub-active,.sub-active a{background-color:#fff;color:#e84182 !important;border:dotted 1px pink;border-width:1px 0 ;margin:-1px 0;outline:none;/*background:url(/assets/img/icon-branch.png) 2% 5px no-repeat #fff;*/}

#content-listing{background-color:#ea528d;}/*230px*/
#content-listing ul.top-level ul li{margin-left:5.882352941176%}
#content-listing li a{font-size:.8125em;line-height:1em;text-decoration:none;padding:2px 0;display:block;text-indent:2.678571428571%;outline:none;}
.visited{color:#ccc;}

#content-listing ul{z-index:4;position:relative;}/*230px*/
#content-listing ul.top-level{margin-top:5.3125em/*85px*/;}
#content-listing ul.top-level ul li{margin-left:6.521739130435%;}
#content-listing{width:29.113924050633%;float:left;padding-bottom:20010px;margin-bottom: -20000px;}
#content-listing li a{text-indent:6.521739130435%;/*15px*/}​ 
```

和 jsFiddle：http: [//jsfiddle.net/XkzUK/](http://jsfiddle.net/XkzUK/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:57:05.310

如果要修复此代码，则在附加选项卡主体时，如果已初始化另一个选项卡，则还应将其分离。

```
if(test2) test2.detach() 
```

更通用的代码是：

```
for(var i = 0; i < tabs.length; i++) {
    if(i != tabIndexToShow && tabs[i] != null) {
        tabs[i].detach()
    }
} 
```

[http://jsfiddle.net/nLMas/1/](http://jsfiddle.net/nLMas/1/)

但是，您应该认真考虑使用[JQuery UI 选项卡](http://jqueryui.com/demos/tabs/)（例如）来执行您正在尝试做的事情。

另外，请在此处发布之前清理、缩进和评论您的代码（或者更好，一直;=）

# javascript - 使用更大的数字时循环崩溃

> ID：10836220
> 
> 赞同：0
> 
> 时间：2012-05-31T15:05:16.343
> 
> 标签：javascript, jquery, loops, crash

我正在尝试制作一个简单的信用卡还款计算器脚本，但似乎遇到了“while”循环的问题。它适用于低数字，但是当您开始输入较大的数字时，它会冻结浏览器，然后您必须退出并重新打开。

这是我拥有的 JavaScript (jQuery)：

```
$('#calculate').click(function()
{
    var currentBalance = parseFloat($('#current_balance').val().substring(1)); // substring so it doesnt grab the £ sign
    var interestRate = parseFloat($('#interest_rate').val());
    var interestType = $('#interest_type').val();
    var monthlyPayment = parseFloat($('#monthly_payment').val().substring(1));
    var totalInterest = 0;
    var interest = 0;
    var months = 0;

    while(currentBalance > 0) // while there is still a balance on the card run the following
    {
        interest = (currentBalance/100)*interestRate; // find interest amount for this month

        currentBalance = currentBalance+interest; // add the interest to the balance

        currentBalance = currentBalance-monthlyPayment; // subtract monthly payment from balance

        totalInterest = totalInterest+interest; // total amount of interest paid
        months++;
    }

    var years = parseInt(months / 12);
    var remainingMonths = months % 12;

    totalInterest = Math.round(totalInterest);

    $('#clear_balance').val(years+' years and '+remainingMonths+' months');
    $('#interest_paid').val('£'+totalInterest);
}); 
```

这是我的 HTML：

```
 <table id="card-info">
            <tbody>
                <tr>
                    <td><label for="current_balance">Current balance</label></td>
                    <td><input type="text" id="current_balance" /></td>
                </tr>
                <tr>
                    <td><label for="interest_rate">Interest rate</label></td>
                    <td>
                        <input type="text" id="interest_rate" />
                        <select id="interest_type">
                            <option value="monthly">Monthly</option>
                            <option value="yearly">Yearly</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><label for="monthly_payment">Monthly payment</label></td>
                    <td><input type="text" id="monthly_payment" /></td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td colspan="2"><button id="calculate">Calculate</button></td>
                </tr>
            </tbody>
        </table>
    </div>
    <div id="results">
        <table id="results-info">
            <tbody>
                <tr>
                    <td>
                        <label for="clear_balance">Time to clear balance</label><br />
                        <input type="text" id="clear_balance" />
                    </td>
                    <td>
                        <label for="interest_paid">Total interest paid</label><br />
                        <input type="text" id="interest_paid" />
                    </td>
                </tr>
            </tbody>
        </table> 
```

有什么我做错了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T15:07:12.863

您的代码没有考虑每月付款不足以支付每月收取的利息的情况。

在这种情况下，它会进入一个无限循环，因为贷款永远不会还清！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:18:04.070

您的 currentBalance 永远是正数！

# c++ - 我应该为 std::string 使用右值编写构造函数吗？

> ID：10836221
> 
> 赞同：14
> 
> 时间：2012-05-31T15:05:18.527
> 
> 标签：c++, string, constructor, c++11, rvalue-reference

我有一个简单的课程：

```
class X
{
    std::string S;
    X (const std::string& s) : S(s) { }
}; 
```

我最近读了一些关于右值的文章，我一直在想，我是否应该为`X`使用右值编写构造函数，这样我就能够检测到临时`std::string`类型的对象？

我认为它应该看起来像：

```
X (std::string&& s) : S(s) { } 
```

据我所知，在支持 C++11 的编译器中实现 std::string 应该在可用时使用它的移动构造函数。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-31T15:10:41.140

```
X (std::string&& s) : S(s) { } 
```

这不是采用*rvalue*的构造函数，而是采用*rvalue-reference*的构造函数。在这种情况下，您不应该使用*右值引用。*而是按值传递，然后*进入*成员：

```
X (std::string s) : S(std::move(s)) { } 
```

经验法则是，如果您需要复制，请在界面中进行。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-05-31T15:59:31.533

为了澄清：按值传递的答案没有错。`string&&`但是，除了一个细节之外，您对添加重载的第一个猜测也不是：

添加：

```
X (std::string&& s) : S(std::move(s)) { } 
```

也就是说，您仍然需要 ，`move`因为尽管`s`声明了 rvalue 引用的类型`string`，但用于初始化的**表达式** 是 type 的左值表达式。`s``S``string`

实际上，您首先提出的解决方案（添加了移动）比传递值解决方案略快。但两者都是正确的。当将左值和 xvalue 参数传递给 X 的构造函数时，按值传递的解决方案会额外调用字符串的移动构造函数。

在左值参数的情况下，无论如何都会进行复制，并且字符串的复制构造函数可能比字符串的移动构造函数昂贵得多（除了适合短字符串缓冲区的字符串，在这种情况下移动和复制大致相同速度）。

对于 xvalue 参数（xvalue 是已传递给 的左值`std::move`），按值传递解决方案需要两个移动构造而不是一个。因此它的成本是通过右值参考解决方案传递的两倍。但仍然非常快。

这篇文章的重点是要明确：按值传递是一种可接受的解决方案。但这不是唯一可接受的解决方案。使用 pass-by-rvalue-ref 进行重载更快，但缺点是随着参数数量 N 的增加，所需的重载数量会缩放为 2^N。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-05-31T15:09:36.217

不，你不应该。你应该做的是用这样的一个替换你当前的构造函数：

```
X (std::string s) :S(std::move(s)) {} 
```

现在您可以处理两个 l 值，它将被复制到参数然后移动到您的类的字符串中，以及 r 值，它将被移动两次（您的编译器希望可以优化这个额外的工作）。

在大多数情况下（有一些我不会在这里讨论的例外情况），你不应该编写带有 r 值引用的函数，除了你编写的类的移动构造函数。任何时候您需要自己的值副本，并且这不仅仅适用于构造函数，您应该按值获取它，并将其移动到需要去的地方。您让类自己的移动构造函数根据它收到的是右值还是左值来决定是否应该复制或移动该值。毕竟，引入 r 值参考是为了让我们的生活更轻松，而不是更难。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-31T15:10:00.973

由于您需要参数的副本，因此按值获取参数。然后，将其移动到您的会员数据中。`std::string`负责检测给定参数是右值还是左值的是构造函数，而不是你。

```
class X
{
    std::string s_;
    X(std::string s) : s_(std::move(s)) {}
}; 
```

# java - Spring Security - 将模式应用于自定义 http 过滤器？

> ID：10836222
> 
> 赞同：1
> 
> 时间：2012-05-31T15:05:20.993
> 
> 标签：java, spring, spring-security

我使用 Spring Security 3.0，我想仅在我的应用程序中的特定 URL 子集上定义基本身份验证过滤器。

是否可以向自定义过滤器添加模式？

我想添加这样的**模式**属性：

```
<security:custom-filter ref="basicAuthenticationFilter" position="BASIC_AUTH_FILTER" pattern="/services/**"/> 
```

我看到可以在**拦截 URL上使用****过滤器**属性，但我不必全部列出。

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T09:03:21.327

我用a`filer-chain-map`来解决这个问题。

```
 <security:filter-chain-map path-type="ant">
        <security:filter-chain pattern="/ws/**" filters="basicAuthenticationFilter"/>
    </security:filter-chain-map> 
```

不过可能有更好的解决方案。**

# xtend - Xtend 的备忘单？

> ID：10836239
> 
> 赞同：0
> 
> 时间：2012-05-31T15:06:16.323
> 
> 标签：xtend

我正在学习[Xtend](http://www.eclipse.org/xtend/)。有人有 Xtend 2.3 M7 的备忘单可以分享吗？我在 Google 上进行了快速搜索，但找不到任何内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:54:12.243

我认为没有可用的备忘单。参考[文档](http://www.eclipse.org/xtend/documentation.html)和[网站](http://xtend-lang.org)是最好的官方可用资源。你有什么具体的想法，你希望在这样的备忘单上找到吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-24T14:45:51.467

见这里[http://jadogg.phatcode.net/wp/?p=49](http://jadogg.phatcode.net/wp/?p=49) 我刚做了一个，点击链接获取pdf

# php - 创建没有数据库的照片库

> ID：10836244
> 
> 赞同：0
> 
> 时间：2012-05-31T15:06:45.803
> 
> 标签：php, readdir

我正在使用 readdir 创建照片库，在该目录中也有非图像文件。目录中有数千个文件，我真的很难过滤扩展名。任何帮助将不胜感激

```
if ($handle = opendir(getcwd())) {

    while (false !== ($entry = readdir($handle))) {
        //but there are other files like doc,pdf,html,php how to fiter them
        echo "<img src='$entry' height='100' width='100'>";
    }

    closedir($handle);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:09:05.670

试试这个[`glob()`](http://php.net/glob)函数，它允许文件名使用通配符，就像你可以直接在命令行上一样。例如

```
$files = glob('*.jpg');
foreach($files as $file) {
   echo ....
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:10:17.533

同意 marc 但您也可以使用小技巧过滤各种扩展

```
foreach (glob('*.{jpg,gif,bmp,jpeg}', GLOB_BRACE) as $filename) {
    echo "<img src=".$filename.">";
} 
```

# iphone - 为 iPhone/iPad 指定字体

> ID：10836247
> 
> 赞同：0
> 
> 时间：2012-05-31T15:06:55.203
> 
> 标签：iphone, ipad, uifont, retina-display

我有应用程序字体的视网膜规范。如果我将它们除以 2，我会得到非视网膜字体大小。我应该为应用程序提供非视网膜尺寸，它会自动缩放它以适应视网膜吗？还是我需要两者都提供？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:24:51.070

通常，您在 Retina 设备上以非 Retina 值指定所有定位和尺寸。操作系统会自动为您处理字体的缩放，因此您无需担心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:15:58.967

我认为 iOS 中的所有字体都是 TrueType，并且会自动适应低分辨率和视网膜显示。

您应该始终使用点单位来测量 UI 元素（例如字体大小）。iOS 会在视网膜显示中将 1 点缩放为 2 像素。

# javascript - 使用 JQuery 动态确定点击了哪个链接

> ID：10836252
> 
> 赞同：2
> 
> 时间：2012-05-31T15:07:08.750
> 
> 标签：javascript, jquery, html, dynamic, hyperlink

所以我正在开发仪表板（单页）类型的应用程序，并且我有一组链接：

```
<a href = "#">3s01</a>
<a href = "#">5e02</a>
<a href = "#">2k01</a>
<a href = "#">3a01</a>
<a href = "#">5j01</a>
etc... 
```

填充标记之间的文本的方式是使用 JQuery 从 xml 文件中获取数据。因为 xml 文件可以更改，所以链接不是静态的。我的任务是能够单击链接并找出标签之间的文本是什么，以便我可以相应地在页面上填充表格。唯一的问题是我不知道如何使用 JQuery/Javascript/html/whatever 获取这些数据。任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:07:59.807

`this`在处理程序中使用。

```
$('a[href="#"]').click(function() { alert(this); }); 
```

* * *

要获取文本，请使用`.text()`...

```
alert($(this).text()); 
```

* * *

或者没有官方支持但更快的版本，`$.text()`...

```
alert($.text([this])); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:09:37.260

```
$('a[href=#]').on('click', function(e) {
  e.preventDefault();
  alert($(this).text());
}); 
```

但是如果你`a`是动态生成的，这意味着在 DOM 准备好之后生成，那么你应该尝试

```
$('body').on('click', 'a[href=#]', function(e) {
     e.preventDefault();
     alert($(this).text());
}); 
```

在这里，`body`您可以使用已经属于 DOM`ANY Valid Selector`的标签的父级。`a`

阅读更多关于**[`.on()`](http://api.jquery.com/on)**

# sml - 子句右侧与函数结果 sml 不一致

> ID：10836256
> 
> 赞同：0
> 
> 时间：2012-05-31T15:07:16.157
> 
> 标签：sml, smlnj

```
fun can_move    0 0 0 nil = false
|   can_move    limit_down V 0 a  = true
|   can_move    limit_down V count a =  if  ((V-limit_down)>hd a) then false else               can_move limit_down V (count-1) tl a ; 
```

嘿，这是我的代码，我只想检查值 V-limit_down 是否低于 int 列表 a 中的数字。我想从 a 列表中检查的参数数量是 V/10 。例如，如果我有 20 V，那么我想检查列表的前两个参数。为什么我会收到此错误？

```
can_move.sml:1.6-3.114 Error:right-hand-side of clause doesn't agree with function     result type
[tycon mismatch] 
expression: int -> int -> int list -> bool
result type: int -> int -> (Z' list -> 'Z list) -> int list -> bool
in declaration:

can_move (fn arg =) (fn <pat> => <exp>)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:36:39.780

看起来您忘记了模式匹配最后右侧的括号。在递归调用`can_move limit_down V (count-1) tl a`中，请注意您的最后一个参数是`tl a`. 通常，解析器可以确定这是一个函数应用程序。不幸的是，当应用程序的结果是另一个应用程序的一部分时，它是模棱两可的，就像这里一样。

解决方案是将调用括起来：`can_move limit_down V (count-1) (tl a)`.

# java - 使 TimePicker 不可更改

> ID：10836257
> 
> 赞同：0
> 
> 时间：2012-05-31T15:07:32.350
> 
> 标签：java, android, timepicker

在 Android java 中，如何使 TimePicker 不可更改？就像使用 EditText 可编辑或启用一样。我正在制作一个应用程序，它显示预设时间，然后我不希望用户能够更改它，直到他们勾选一个复选框。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:20:45.830

如果 setEnabled(false) 不起作用，请尝试扩展 DatePicker 小部件，覆盖 onTouch 并从 DatePicker（或 DatePicker 子项）中移除焦点

# mysql - EasyPHP 无法连接到本地主机（端口 8080）

> ID：10836258
> 
> 赞同：0
> 
> 时间：2012-05-31T15:07:32.490
> 
> 标签：mysql, phpmyadmin, localhost, easyphp

我对 EasyPHP 5.3.9 有疑问！Apache 和 MySQL 正在工作，但是当我点击：Administration、PhpMyAdmin 或 LocalWeb 时，它会打开 Google Chrome，页面显示：糟糕！谷歌浏览器无法连接到 127.0.0.1:8080 我已经更改了配置中的字符串： Listen 127.0.0.1:8080 to 127.0.0.1:80 但没有结果......我已经尝试了一切。我已经下载了 TCPview 并且端口 80 和 8080 是免费的...防火墙已关闭等...我不知道该怎么办：/ 任何解决方案？（对不起我的英语不好）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-12T19:39:51.857

不确定这是否是您的问题，但在 Windows 8（可能还有 Windows 7）上，EasyPHP 在启动时不会以管理员身份运行，导致从系统托盘访问的大多数工具都失败了。我通过以下方式打开本地网络：

1.  通过系统托盘停止和退出easyphp。
2.  浏览到 C:\Program Files (x86)\EasyPHP-12.1
3.  右键单击 EasyPHP-12.1 并选择属性
4.  选择兼容性选项卡并选中以管理员身份运行此程序框
5.  从图标或开始屏幕再次启动 EasyPHP
6.  本地 Web 和管理现在为我工作。

为我工作，但可能是其他问题。

# c++ - 使用嵌入式 Python 3 部署应用程序

> ID：10836259
> 
> 赞同：5
> 
> 时间：2012-05-31T15:07:39.750
> 
> 标签：c++, python, deployment, scripting, packaging

我目前正在开发一个用 C++ 编写的应用程序。出于编写脚本的目的，我使用 Python 3.2，这很好——在我的开发人员机器上安装了 Python，并且所有 DLL 都在正确的位置。

在使用出色的 py2exe 之前，我部署了“纯”Python 应用程序（即没有本机代码），但我不知道如何使用嵌入式 Python 部署它。

从我的直觉来看，我认为以下组件是必要的：

*   Python3.dll & Python32.dll
*   Python 的“DLLs”目录中的 .pyd 文件
*   Python 库

最后一点是困扰我的问题：我该如何部署*它*？那是几千个文件，我真的不想复制它。Py2exe 将其打包成一个 zip 文件，我想我也可以这样做吗？而且，更重要的是：我如何在运行时告诉 Python 解释器他在哪里找到库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T18:18:50.110

据我所知，您需要捆绑的内容取决于您的 python 脚本调用或使用的内容。如果你真的只使用核心解释器，我认为你只需要捆绑 dll。

话虽如此，通过禁用已安装 python 的任何路径并将您的应用程序和 python dll 和库放入同一个测试文件夹中，在您的开发盒上测试它应该不会太难。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-01-27T12:21:01.850

这已在 Python 3.5 版本中得到解决，该版本提供了一个用于集成的最小包。

[https://docs.python.org/3.5/using/windows.html#embedded-distribution](https://docs.python.org/3.5/using/windows.html#embedded-distribution)

> 嵌入式分发是一个包含最小 Python 环境的 ZIP 文件。它旨在充当另一个应用程序的一部分，而不是由最终用户直接访问。

[在https://docs.python.org/3/faq/windows.html#how-can-i-embed-python-](https://docs.python.org/3/faq/windows.html#how-can-i-embed-python-into-a-windows-application)中给出了一些关于如何将 Python 实际嵌入应用程序（链接 python3.dll）的指示。[进入 Windows 应用程序](https://docs.python.org/3/faq/windows.html#how-can-i-embed-python-into-a-windows-application)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T16:47:52.020

这个[网站](http://effbot.org/zone/python-compile.htm)应该很好地指导你。您基本上所做的是将python脚本编译为.exe，而不是让python每次都解释.py文件。它也会快得多。

# c# - 以编程方式启动 Windows 服务

> ID：10836260
> 
> 赞同：0
> 
> 时间：2012-05-31T15:07:56.920
> 
> 标签：c#, windows-services

我设置了一个quartz.NET 项目，它应该安排一个Windows 服务每隔一段时间运行一次。目前，我正在尝试像这样启动服务：

```
Process.Start("path/app.exe"); 
```

但我得到：“无法从命令行或调试器启动服务。必须首先安装 Windows 服务，然后使用 ServerExplorer、Windows 服务管理工具或 NET START 命令启动。

所以我想知道，首先，这会在发布模式下消失吗？或者我将不得不找到另一种方法来解决这个问题。无论哪种方式，我都需要能够以编程方式安排这项工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:19:31.593

该消息告诉您如何启动服务的几种方法，但这些不是从 C# 执行此操作的正确方法。有一个更好的方法：使用`System.ServiceProcess.ServiceController`类来启动服务。

# zend-framework - Apache 上的 Zend 框架和 Smarty

> ID：10836263
> 
> 赞同：0
> 
> 时间：2012-05-31T15:08:00.320
> 
> 标签：zend-framework, smarty

我有一个非常奇怪的问题。我有 macintosh 和 apache 服务器。操作系统是 OSX 10.7 Lion

我正在使用 zend 框架在某个站点上工作，并且正在本地对其进行测试。

当我在其他服务器上上传文件时，一切正常，但是当我在本地测试站点时，它不起作用。页面的某些部分显示，有些则不显示。未显示的部分页面正在使用 smarty tpl 文件。

我在我的 zend 框架中使用 smarty，不要问我为什么。

看起来我的本地系统无法读取 tpl 文件。

有谁知道可能是什么问题？

我希望你能理解我的问题。

提前致谢

# iphone - 检测 null 和类似“null”的 JSON 值？代码

> ID：10836264
> 
> 赞同：3
> 
> 时间：2012-05-31T15:08:07.120
> 
> 标签：iphone, objective-c, ios, sbjson

我在向 tableView 中的单元格插入数据时遇到问题。当我搜索错误源时，我看到我的 web 服务正在返回空值。因此，当我将名称调用到单元格时，它会崩溃为空的参数。所以，原因是数据库问题，我只想跳过添加例如：{“name”：“null”}

在其他服务中，我将空值设为空......所以它不会引起问题......我认为它是作为字符串的空值。

这是一个例子：

```
{
    "24_7" = 0;
    address = "avenue innsbruck";
    city = GRENOBLE;
    country = FR;
    dst = "14007.2046741012";
    "h_saturday" = " - ";
    "h_sunday" = " - ";
    "h_week" = " - ";
    id = 324;
    "location_lat" = "45.154";
    "location_long" = "5.73387";
    name = "<null>";
    "tel_1" = 0476544254;
    "tel_2" = "";
    zipcode = 38000;
} 
```

当我在这里解析 json 时，我只想跳过添加这个。

```
NSString *theJSON = [request responseString];

SBJsonParser *parser = [[SBJsonParser alloc] init];

NSDictionary *jsonDictionary = [parser objectWithString:theJSON error:nil];

//NSLog(@"OkRequest || %@ ", jsonDictionary);

[_jsonStation removeAllObjects];
for (NSDictionary *taxi in jsonDictionary)
{

    [_jsonStation addObject:taxi];

} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-31T15:10:06.637

您可以通过在循环中执行以下操作来测试您的对象是否为空：

```
if ([taxi isKindOfClass:[NSNull class]])
    continue;
//else, process it 
```

# java - HibernateTemplate 与 SessionFactory

> ID：10836265
> 
> 赞同：4
> 
> 时间：2012-05-31T15:08:14.603
> 
> 标签：java, hibernate

也许有人可以解释使用哪一个？什么时候，为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-31T17:11:33.257

HibernateTemplate的[javadoc](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/orm/hibernate3/HibernateTemplate.html)说：

> 注意：从 Hibernate 3.0.1 开始，事务性 Hibernate 访问代码也可以用普通的 Hibernate 样式编码。因此，对于新启动的项目，请考虑采用基于 SessionFactory.getCurrentSession() 的标准 Hibernate3 编码数据访问对象的风格。

所以即使是 Spring 也告诉你不要再使用 Spring 的 HibernateTemplate 了。Hibernate4 没有 HibernateTemplate。选择应该是显而易见的。

# android - Galaxy Nexus 上没有显示背景图像（仅）？

> ID：10836268
> 
> 赞同：5
> 
> 时间：2012-05-31T15:08:28.720
> 
> 标签：android, xml, user-interface, background, android-4.0-ice-cream-sandwich

这里有一个非常特殊的问题，除了 Galaxy Nexus（或者我到目前为止发现的），所有手机上的背景图像资产都可以正常显示

在多部不同手机中的应用程序库下方找到，但请注意在图片编号 SIX 中，nexus 没有背景？

我已经设置了对所有密度和大 + XL 屏幕尺寸的支持，我将发布一种布局的 XML，但是它跨越所有布局，无论它是否具有任何控件/线性布局或其他任何内容。

图片：http: [//goo.gl/59c8C](http://goo.gl/59c8C)

```
<?xml version="1.0" encoding="utf-8"?>
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
     android:layout_width="match_parent"
     android:layout_height="match_parent" android:background="@drawable/app_bg">

     <ScrollView
         android:id="@+id/scrollView12"
         android:layout_width="fill_parent"
         android:layout_height="fill_parent" android:layout_alignParentBottom="true" android:fillViewport="true">

         <RelativeLayout
             android:layout_width="match_parent"
             android:layout_height="match_parent" >

                 <LinearLayout
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
             android:orientation="vertical" android:layout_alignParentBottom="true">

             <com.quickcontact.CustomTextView
                 android:id="@+id/CustomTextView01"
                 android:layout_width="wrap_content"
                 android:layout_height="wrap_content"
                 android:layout_marginTop="10dp"
                 android:gravity="center"
                 android:text="Tap the buttons below to create your contact profiles. You will be able to assign contact details to each of your profiles and share them with others."
                 android:textColor="#3f3f3f"
                 android:textSize="15sp" android:layout_marginLeft="10dp" android:layout_marginRight="10dp" android:layout_gravity="center_horizontal"/>

             <com.quickcontact.CustomTextView
                 android:id="@+id/receiveHeadertxt"
                 android:layout_width="wrap_content"
                 android:layout_height="wrap_content"
                 android:layout_marginTop="20dp"
                 android:gravity="center"
                 android:text="-- Create Profile --"
                 android:textColor="#3f3f3f"
                 android:textSize="15sp" android:layout_gravity="center_horizontal"/>

             <com.quickcontact.CustomButton
                 android:id="@+id/butPersonal"
                 android:layout_width="match_parent"
                 android:layout_height="78dp"
                 android:background="@drawable/standard_button"
                 android:padding="1dp"
                 android:text="Personal"
                 android:textColor="#3f3f3f"
                 android:textSize="16sp" />

             <com.quickcontact.CustomButton
                 android:id="@+id/butSocial"
                 android:layout_width="match_parent"
                 android:layout_height="78dp"
                 android:layout_marginTop="5dp"
                 android:background="@drawable/standard_button"
                 android:padding="1dp"
                 android:text="Social"
                 android:textColor="#3f3f3f"
                 android:textSize="16sp" />

             <com.quickcontact.CustomButton
                 android:id="@+id/butBusiness"
                 android:layout_width="match_parent"
                 android:layout_height="78dp"
                 android:layout_marginTop="5dp"
                 android:background="@drawable/standard_button"
                 android:padding="1dp"
                 android:text="Business"
                 android:textColor="#3f3f3f"
                 android:textSize="16sp" android:layout_marginBottom="20dp"/>

             <com.quickcontact.CustomButton
                 android:id="@+id/butNext"
                 android:layout_width="fill_parent"
                 android:layout_height="58dp"
                 android:background="@drawable/blue_button"
                 android:gravity="center_vertical|center_horizontal"
                 android:paddingBottom="1dp"
                 android:text="NEXT"
                 android:textColor="#3f3f3f"
                 android:textSize="16sp" />

         </LinearLayout>

         </RelativeLayout>

     </ScrollView>

 </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T15:30:39.420

Galaxy Nexus 是一个 xhdpi 设备。背景图像是否位于`/res/drawable-xhdpi/`目录中？

另一种选择，如果您的背景只是一个渐变，那么您可以在 xml 中编写一个渐变脚本并将其放在您的`/res/layout/app_bg.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" 
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

<item>
    <shape>
        <gradient
            android:startColor="@color/green2"
            android:endColor="@color/green1"
            android:gradientRadius="555"
            android:type="radial" />
    </shape>
</item>
</selector> 
```

然后将您的背景引用为`android:background="@layout/app_bg"`

我的偏好是为整个应用程序中的一致样式创建一个单一的布局样式 xml，然后将它们包含在所有其他 xml 布局中。

# .net - SSIS - 加载 Excel 会删除百分比符号

> ID：10836269
> 
> 赞同：0
> 
> 时间：2012-05-31T15:08:30.540
> 
> 标签：.net, sql, excel, ssis

我正在通过 SSIS 将一些 Excel 数据加载到数据库中。加载数据时，SSIS 会忽略工作表中的 % 符号。

例如：

```
Col1    Col2    Col3    Col4
----------------------------
98.7%   76.2%   3.09    23% 
```

在上述情况下，我需要找到具有 % 的列（以区分数字和百分比），但 SSIS 将数据读取为 0.9868998899、0.75478490944、0.03688899973、0.230000

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:21:29.770

这是因为`%`Excel 中的符号可能是格式的一部分，而不是数据的一部分。

如果您想让`%`符号成为数据的一部分（顺便说一句，这将停止字段为数字），那么您需要使用***选择性粘贴***或公式来转换它以连接`%`符号：

```
=A1&"%" 
```

对您来说可能更好的是保持数据数字直到它到达 SSIS 之后，然后在目标中重新格式化它*。*这样，您将避免舍入错误和其他转换问题。

# jquery - 嵌套子菜单中的 javascript/jquery 活动链接

> ID：10836271
> 
> 赞同：1
> 
> 时间：2012-05-31T15:08:35.607
> 
> 标签：jquery, html, css

如果在主要元素之一或我正在处理的标题的嵌套列表之一`li`中找到链接，我将尝试突出显示父元素。`li`我觉得JS应该可以工作，但事实并非如此。任何指向正确方向的人都将不胜感激。

[http://jsfiddle.net/fGGrf/](http://jsfiddle.net/fGGrf/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:17:03.737

这是你想要的？

```
 $('.submenu-link').hover (function (e) {
        $(this).parent().parent().children('a').css('backgroundColor', 'red');
    }, function (e) {
        $(this).parent().parent().children('a').css('backgroundColor', 'white');
    }); 
```

**JSFiddle:** : [http://jsfiddle.net/fGGrf/5/](http://jsfiddle.net/fGGrf/5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:27:49.343

尝试这个：

```
$(document).ready(function(){
var dropdown = $('.dropdown');
var link= $('.submenu-link');

var cur = "www.domain.com/overview.php" // document.location.href ? document.location.href : document.location;
cur = cur.split('/' , -1);

    $('li a').each(function() {
        if ($(this).attr('href') == '/' + cur[1]) {
           $(this).parent().addClass('active');
        }
    })

}); 
```

[http://jsfiddle.net/fGGrf/6/](http://jsfiddle.net/fGGrf/6/)

# python - django celery：update_state 没有做任何事情

> ID：10836276
> 
> 赞同：4
> 
> 时间：2012-05-31T15:08:54.757
> 
> 标签：python, django, celery, django-celery

我正在为 django-celery 编写一个小测试任务，我想在其中设置自定义状态（和一些数据，但让我们先从自定义状态开始）。

我使用 django 作为消息传递后端。我的python版本是2.6。

这是tasks.py的内容

```
import time
from djcelery import celery

@celery.task
def generate():
    generate.update_state(state="PROGRESS")
    time.sleep(10)
    return True 
```

当我试一试时，会发生以下情况：

```
>>> import tasks
>>> result = tasks.generate.delay()
>>> result
<AsyncResult: f72574aa-f8c5-49dc-89d4-47d2012a4d6d>

# status and state are the same, but just to make sure
>>> result.status
u'PENDING'
>>> result.state
u'PENDING'
>>> result.result
# empty, as in None

# wait a few seconds
>>> result.status
u'SUCCESS'
>>> result.state
u'SUCCESS'
>>> result.result
True 
```

我无法弄清楚为什么状态应该是 PENDING 而它应该是 PROGRESS。任何的想法？

我已经查看了文档，这里是相关链接：[http ://docs.celeryproject.org/en/latest/userguide/tasks.html#custom-states](http://docs.celeryproject.org/en/latest/userguide/tasks.html#custom-states)

我做了完全相同的事情（减去元数据，但我也尝试过但没有成功），所以它应该可以工作。

**更新：我发现了原因，看起来你必须在更新任务时重新启动 celery 守护程序，以便将更改考虑在内。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T18:25:09.170

我发现了原因，看起来您必须在更新任务时**重新启动 celery 守护程序**，以便将更改考虑在内。

# ssl - 没有 CA 根的 SSL 和 openssl s_client

> ID：10836281
> 
> 赞同：5
> 
> 时间：2012-05-31T15:09:17.930
> 
> 标签：ssl, curl, openssl

所以，我有使用 CURL 没有问题的密钥和证书文件。

```
curl -k --key key --cert cert --url myurl 
```

没问题。如果测试与 openssl s_client 的连接，我在链中出现错误 19 自签名证书。

```
openssl s_client -key key -cert cert -connect myurl:443 
```

因此，似乎 openssl 必须具有 curl 的替代选项“-k”，这意味着不安全，允许连接到没有证书 (H) 的 SSL 站点。有人知道吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-31T15:30:57.507

`curl``-k`如果证书不受信任，则根本不会建立连接。

相反，`openssl s_client`无论如何都会建立连接，但如果证书不受信任，则会显示警告。（您必须使用`-CApath`或`-CAfile`删除该警告指定受信任的 CA 证书列表。）

# android - 在 android 4.0 上以编程方式设置 VPN 连接

> ID：10836282
> 
> 赞同：23
> 
> 时间：2012-05-31T15:09:20.180
> 
> 标签：android, android-4.0-ice-cream-sandwich, vpn

我正在以编程方式在 android 设备上设置 VPN 连接。对于使用 OS 2.3.5 及之前的设备，我成功地做到了这一点（我使用反射来访问隐藏类）。但是在 android 4.0 中，他们摆脱了旧的类并改用 VPNService 类。

我认为最好的起点是使用 Android 提供的 ToyVPN 示例，但我面临着很多挑战。在示例代码中，他们只需要发送服务器地址：

```
InetSocketAddress server = new InetSocketAddress(mServerAddress, Integer.parseInt(mServerPort)); 
```

然后通过打开通道创建 VPN 隧道：

```
tunnel = DatagramChannel.open(); 
```

但就我而言，我需要发送服务器地址、用户名和密码。到目前为止，我还没有弄清楚如何做到这一点。我最好的猜测是做这样的事情：

```
Authenticator.setDefault(new Authenticator(){
        protected PasswordAuthentication getPasswordAuthentication() {
            return new PasswordAuthentication("user","pass".toCharArray());
        }});

    try {
        // Create a DatagramChannel as the VPN tunnel.

        tunnel = DatagramChannel.open(); 
```

但这没有用。所以我要问的是：

1.  除了在 ToyVpn 中使用的方法之外，还有其他方法可以以编程方式创建 VPN 连接吗？
2.  如果没有，当我想与服务器建立连接时如何发送凭据？

**编辑**

我忘了提到我需要指定 VPN 类型（PPTP、L2TP、L2TP/IPSec PSK 或 L2TP/IPSec CRT）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-05-19T07:46:07.377

基本上，Android 4.0+ 中引入的 VPN API 只允许您实现**自己的**VPN 实现。它只是打开 Linux TUN 设备并将文件描述符传递给您，以及设置您提供的路由/DNS 服务器/等。整个 VPN 协议的实施完全取决于您。

所以简短的回答是：不。您不能使用*VPN API*来设置任何

> PPTP、L2TP、L2TP/IPSec PSK 或 L2TP/IPSec CRT

VPN 连接，除非您自行实施上述 VPN 类型。

话虽如此，您仍然可以尝试广播 Intent 以将您的用户带到系统 VPN 设置活动并要求他们手动配置/启动 VPN。

Oh and one more thing to add. At the time of this writing, Android's latest DevicePolicyManager (API level 21) already provides [WiFi settings provisioning support](http://developer.android.com/reference/android/app/admin/DevicePolicyManager.html#EXTRA_PROVISIONING_WIFI_PAC_URL). I would personally guess that Google might continue to add more [Android for Work](https://www.google.com/work/android/) features, which may include VPN provisioning support you need. [I/O 2015](https://events.google.com/io2015/) is only a few days away so let's wait and see...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-02-25T18:16:57.093

有一种以编程方式设置 VPN 连接的方法。您可能想查看[OpenVPN for Android (ics-openvpn)](https://code.google.com/p/ics-openvpn/)项目的源代码。如果您的应用不需要直接建立连接，您还可以使用意图触发来自 ics-openvpn 的连接。OpenVPN 提供了广泛的设置，但您仍然需要查看它是否与您的服务器兼容。

Android 4.0（ICS）中引入的VpnService类只能做一些设置，比如创建网络接口（只有tun模式），一些路由和DNS服务器。您的应用程序仍然需要能够在没有 root 权限的情况下进行连接。您可能想在[此处](http://www.thegeekstuff.com/2014/06/android-vpn-service/)查看有关如何使用 VpnService 的更多信息。

就我探索 ics-openvpn 的代码而言，该应用程序集成了一个可在应用程序 APK 中运行的 OpenVPN 二进制文件。该应用程序执行此二进制文件，通过本地套接字发送和接收命令。二进制文件几乎处理所有事情，您只需解析输入以了解您将调用的 VpnService.Builder 的哪些方法，以及您将通过套接字发送回哪些信息（这包括确认、配置文件、凭据、字节数， ETC）

# xml - 在 SQL Server 中有条件地粉碎 XML

> ID：10836283
> 
> 赞同：1
> 
> 时间：2012-05-31T15:09:20.740
> 
> 标签：xml, sql-server-2008, xquery, shred

考虑以下 XML 文件：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<Input Control="1234567890">
   <Patient>
      <AccountID>johnsmith@gmail.com</AccountID>
      <Name>
         <Title>Mr</Title>
         <First>John</First>
         <Middle>J</Middle>
         <Last>Smith</Last>
      </Name>
      <Addresses>
         <Address Type="Billing">
            <Line1>123 Main St</Line1>
            <Line2>Unit #1</Line2>
            <City>Anytown</City>
            <State>MD</State>
            <PostalCode>78470</PostalCode>
            <Country>USA</Country>
            <Zone>TR89</Zone>
         <Address Type="Contact">
            <Line1>55 Main St</Line1>
            <City>Anytown</City>
            <State>MD</State>
            <PostalCode>78470</PostalCode>
            <Country>USA</Country>
            <Zone>TR89</Zone>
         </Address>
      </Addresses>
      <Phones>
         <Phone Type="Daytime">555-221-2525</Phone>
         <Phone Type="Evening">555-355-1010</Phone>
      </Phones>
      <Selects>
         <Select Name="Current">0</Select>
      </Selects>
   </Patient>
</Input> 
```

我需要将 XML（使用 XPath/XQuery）“分解”到下表中：

```
 Account    Nam_Pr   Nam_Fst  Nam_Lst  Adrs1Main  Adrs2Main  CityMain ... 
     1        Mr.      John     Smith  123 Main St  Unit #1    Anytown 
```

问题是，我需要使用来自 Address Type="Billing 元素的数据填充 AdrsMain 字段，前提是它存在于文件中。否则，AdrsMain 字段是从 Address Type="Contact" 元素填充的。如何我做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T16:23:16.027

事实证明这比我想象的要难一些，所以我会继续回答这个消息。我不记得 xquery 需要我对 null 进行任何转换的属性，因为（我认为）返回的值已经为 null。因此，您可能需要将一些空字符串转换回 null。幸运的是，我发现了一个很酷的小操作符，叫做`nullif`.

但这里的想法。

```
create table docs ( id int primary key, xmlbit xml); 
```

假设您的文档文件已添加，然后您可以执行

```
with things (BillingLine1,ContactLine1)  as
(
SELECT 
nullif(cast(xmlbit.query('data(/Input/Patient/Addresses/Address[@Type="Billing"]/Line1)') as varchar(100)),'') as BillingLine1,
nullif(cast(xmlbit.query('data(/Input/Patient/Addresses/Address[@Type="Contact"]/Line1)') as varchar(100)),'') as ContactLine1
from docs  
 )
select BillingLine1, ContactLine1, Coalesce(BillingLine1,  ContactLine1) as needed from things; 
```

演示：[http ://sqlfiddle.com/#!3/b3fbd/15](http://sqlfiddle.com/#!3/b3fbd/15)

可能还有其他方法可以做到这一点。我有一种感觉，如果你真的想要，你可以在 xquery/xpath 语句中做所有事情，它甚至可能更有利，但我不确定。

编辑：请注意我将它们投射到的 varchars 的大小；您可能需要调整以适应。

# java - 在主活动中按下后退按钮时如何使应用程序退出？

> ID：10836284
> 
> 赞同：0
> 
> 时间：2012-05-31T15:09:26.510
> 
> 标签：java, android

在我的应用程序中，当我单击后退按钮时，它会通过我之前打开它们的所有活动，我使用公共 void`onBackPressed()`方法将后退按钮返回到我想要的活动，如下所示

```
public void onBackPressed()
  {
    startActivity(new Intent("com.MyDiet.Main"));
    Tracker.this.finish();
  } 
```

那是编码后退按钮的真实和安全的方法吗？当按下后退按钮时，如何防止应用程序通过所有以前打开的活动？当我单击主活动中的后退按钮时，如何使应用程序退出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:13:23.203

在您的应用程序和所有 android 应用程序中，除非不通过不必要的步骤（例如登录，如果您已经登录）至关重要，否则不要覆盖 Android 标准行为非常重要。用户通常会抱怨 Android 应用程序没有共同的行为或风格指南。

无论如何，是的，您可以在所有活动上覆盖 onBackPressed 并做任何您想做的事情。但是不要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:30:15.893

这种方法不好，因为您正在污染应用程序的活动堆栈

例子：

当前堆栈：MainAct -> Act2 -> Act3（我们在活动 3 中）

使用上面的代码，当您按下返回时，堆栈现在如下所示：

MainAct -> Act2 -> MainAct

因为你结束了 Act3 并启动了一个 NEW 主要活动，这可能不是你想要的。

为了实现你想要的（当前活动结束时返回主），你需要处理中间活动：在上面的例子中，当你从 Act2 调用 startActivity("Act3") 时，你应该调用 "this.finish ()”。因此，您不必重写活动 3 的“onBackPressed()”：只需默认值将终止 Act3，堆栈中的下一个活动将是 MainAct

MainAct -> A2 (A2 启动 A3 然后调用 this.finish())

MainAct -> A3（用户现在按回）

MainAct（主要活动现在位于顶部）

总而言之，您不必重写 onBackPressed，您只需正确管理主要活动和当前活动之间的活动生命周期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:40:01.573

一般来说，不建议让事情像用户不期望的那样工作，这被认为是非常糟糕的做法。这就是为什么从 overriden 开始活动是不好的`onBackPressed()`。

默认情况下，当用户按下返回时，活动将完成，并将显示一个来自[**后台堆栈**](http://developer.android.com/guide/topics/fundamentals/tasks-and-back-stack.html)的活动。作为开发人员，您将（通过编写代码）决定是哪一个。您可以这样做，但稍后（或为其他人）会有点混乱，很难找到这个不寻常的地方用于开始其他活动的代码。

所以..阅读[**活动生命周期**](http://developer.android.com/guide/topics/fundamentals/activities.html#Lifecycle)和[**后台堆栈**](http://developer.android.com/guide/topics/fundamentals/tasks-and-back-stack.html)以了解它是如何工作的并更好地理解术语会很有用。

如果您希望您的一项活动不留在后台堆栈中，您可以为该活动添加[`manifest file`](http://developer.android.com/guide/topics/manifest/manifest-intro.html)文件`android:noHistory="true"`。

通过在开始活动时向意图添加适当的标志，您可以从代码中实现相同的目标： `Intent.FLAG_ACTIVITY_NO_HISTORY`

*当用户从ActivityOne*（开始使用意图或定义的[`manifest`](http://developer.android.com/guide/topics/manifest/manifest-intro.html)类似描述）“离开”到新的*ActivityTwo*然后按回时，它不会转到 ActivityOne，因为它不会在后堆栈上。使用它，您可以精确控制活动的导航。

[**有更多的标志**](http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_NO_HISTORY)可供使用，但我想这就是你想要实现的。

希望你会发现我的回答很有用。干杯..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-10T16:16:33.553

你可以使用很多技巧来退出你的完整应用程序，我使用这个启动一个意图，然后从 androidmanifest 我选择归类到主页，然后关闭当前活动，比如你的主要活动！

```
public void onBackPressed() {
    Intent intent = new Intent(Intent.ACTION_MAIN);
    intent.addCategory(Intent.CATEGORY_HOME);
    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    startActivity(intent);
    finish();
} 
```

# jquery - 需要帮助突出显示我们在 html/dreamweaver/css 中的下划线活动页面

> ID：10836289
> 
> 赞同：1
> 
> 时间：2012-05-31T15:09:40.100
> 
> 标签：jquery, html, css, dreamweaver

我有一个网站，我想在其中突出显示或下划线活动页面，以便查看者一眼就知道他们在哪个页面上。这是html和CSS。我的代码如下所示：

```
<div class="mainNav" id="nav1">
<span class="navBar">
<a href="index.html" id="homelink">HOME</a> | 
<a href="team.html" id="teamlink">OUR TEAM</a> | 
<a href="partners.html" id="partnerlink">PARTNERS</a> | 
<a href="contact.html" id="contactlink">CONTACT US</a>
</span>
</div> 
```

我对此有点陌生，并且对 Dreamweaver、html 和 CSS 有相当的了解，所以我需要找到一种方法来轻松识别网站访问者的页面。任何帮助表示赞赏....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:14:33.187

如果您手动制作每个 HTML 页面，那么您需要做的就是为突出显示的`<a></a>`标签提供一个 CSS 类，然后在您的 CSS 表中，使用该类指定突出显示锚点的规则。这是一个简单的例子：

HTML

```
<a href="www.example.com/page1.html" class="highlighted">About me</a>
<a href="www.example.com/page2.html">Contact me</a> 
```

CSS

```
a.highlighted {
  font-weight: bold;
} 
```

另一种方法是使用 JavaScript，这可能会有点混乱，或者使用服务器端解决方案，例如内容管理系统。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T00:06:48.270

也许这个 JavaScript 很有帮助。它将页面上的链接与当前页面进行比较，并使链接文本变为粗体以进行匹配。

您可以将其放置在正文中加载的函数中，也可以将其放置在 HTML 文档的末尾。

```
var links=document.getElementsByTagName("A");
for(var i=0;i<links.length;i++)
{
    if(location==links[i].href)
    {
        links[i].style.fontWeight="bold";
    }   
} 
```

# url - 在 IE9 中运行 canvas.toDataURL('image/png') 时出现问题 --> SCRIPT122: La zone de données passée à un appel système est insuffisante

> ID：10836290
> 
> 赞同：1
> 
> 时间：2012-05-31T15:09:42.487
> 
> 标签：url, canvas, internet-explorer-9, fabricjs, rasterize

我对 IE9 中的以下行有疑问：

```
canvas.toDataURL('image/png') 
```

当我运行这一行时，IE9 不显示我的 PNG 并给我这个错误：

> SCRIPT122: La zone de données passée à un appel système est insuffisante

这是否意味着 URL 太长而无法正确解释？我该如何解决？

任何帮助表示赞赏。提前谢谢你……</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T12:39:32.087

感谢这个链接（ danielmclaren.com/node/90 ），我终于找到了在 IE9 中显示 PNG 的解决方案。

问题是我必须使用 $_POST 来检索图像的数据，而不是使用 URL 和 $_GET。IE9 不支持很长的 URL 并截断数据。

FabricJS的GitHub上描述了所有过程：
github.com/kangax/fabric.js/issues/172#issuecomment-6058563

# scala - 在 ObservableMap 上调用 update() 时未调用事件订阅者

> ID：10836293
> 
> 赞同：2
> 
> 时间：2012-05-31T15:09:51.213
> 
> 标签：scala

我创建了一个 ObservableMap，以及一个只打印它接收到的任何事件的订阅者（取自[此处](https://stackoverflow.com/a/6632485/348612)）：

```
class MyMap extends HashMap[Int,Int] with ObservableMap[Int,Int]

class MySub extends Subscriber[Message[(Int,Int)] with Undoable, ObservableMap[Int, Int]] {
  def notify(pub: ObservableMap[Int, Int], evt: Message[(Int, Int)] with Undoable) { 
    println(evt)
  }
}

val map = new MyMap
map.subscribe(new MySub) 
```

使用*+=*、*++=*和*-=*按预期工作：

```
scala> map += 1 -> 1
Include(NoLo,(1,1))
res5: map.type = Map(1 -> 1)

scala> map ++= Map(2 -> 4, 3 -> 9)
Include(NoLo,(3,9))
Include(NoLo,(2,4))
res6: map.type = Map(3 -> 9, 1 -> 1, 2 -> 4)

scala> map -= 1
Remove(NoLo,(1,1))
res7: map.type = Map(3 -> 9, 2 -> 4) 
```

但*更新*不起作用：

```
scala> map(4) = 16

scala> map
res9: MyMap = Map(3 -> 9, 4 -> 16, 2 -> 4) 
```

为什么？看起来 ObservableMap 覆盖了*+=*、*-=*和*clear*。*++=*和*update*似乎都是根据 += 实现的（*分别*由 Growable 和 MapLike 实现），那么为什么它适用于一个而不适用于另一个呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T21:26:56.350

HashMap 的可变版本调用 update ，而 update 又调用 put ，它不调用 += 所以 observable += 方法不会被调用。我正在使用 scala 2.9.1，但这应该与 2.8 相同。

从哈希映射：

```
 override def put(key: A, value: B): Option[B] = {
    val e = findEntry(key)
    if (e == null) { addEntry(new Entry(key, value)); None }
    else { val v = e.value; e.value = value; Some(v) }
  }

  override def update(key: A, value: B): Unit = put(key, value)

  def += (kv: (A, B)): this.type = { 
    val e = findEntry(kv._1)
    if (e == null) addEntry(new Entry(kv._1, kv._2))
    else e.value = kv._2
    this
  } 
```

# php - Tomcat 6 & PHP with enctype - 没有返回输入数据

> ID：10836302
> 
> 赞同：0
> 
> 时间：2012-05-31T15:10:20.740
> 
> 标签：php, file, tomcat, upload, enctype

我在 Apache-Tomcat6 上使用 PHP5/HTML 时遇到了这个问题。这是我在我的网站中使用的一种形式的示例：

```
<form enctype="multipart/form-data" method="post" action="hello.php" >

    <label>Title* :</label> 
    <input type="text" name="title" /> 

    <label>Image:</label>
    <input type="file" name="image" /><br />

<input type="submit" value="Add"/>
</form> 
```

每当我将“enctype”属性添加到任何表单时；既不返回 $_FILES['image'] 也不返回 $_POST 变量。只要“enctype”不存在，一切（当然除了文件输入）都按预期工作。有人可以指导我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:17:52.267

您将无法使用表单上`post`的方法获取数据。`get`

在`test.html`：

```
<form enctype="multipart/form-data" method="post" action="hello.php" >
    <label>Title* :</label> 
    <input type="text" name="title" /> 

    <label>Image:</label>
    <input type="file" name="image" /><br />
    <input type="submit" value="Add"/>
</form> 
```

在`hello.php`：

```
<?php
print_r($_POST);
print_r($_FILES); 
```

根据您的服务器配置，这将组合`$_GET`、`$_POST`和`$_COOKIE`，但您仍需要`post`使用文件输入。

```
print_r($_REQUEST); 
```

# python - Selenium 测试：使用 BasicAuth 重新进行身份验证会出错

> ID：10836304
> 
> 赞同：2
> 
> 时间：2012-05-31T15:10:21.520
> 
> 标签：python, selenium, selenium-rc

我正在用 Python 为 SeleniumRC 编写测试。测试针对 Ubuntu 中的 Firefox 实例运行。我有一个使用 BasicAuth 的网络应用程序。

在我的测试类的设置中，我在我的 web 应用程序中设置了一个页面（foo.html）。

我在此类中进行了很多测试，这些测试转到此页面并使用如下 URL 进行身份验证：

```
self.selenium.open('http://user:pass@%s:%s/foo.html' % (host, port)) 
```

我有一个测试（我们称之为 BAR），它创建另一个页面（bar.html），然后打开该页面：

```
self.selenium.open('http://user:pass@%s:%s/bar.html' % (host, port)) 
```

这是我的问题的中心：

*   如果我只运行这一项测试（BAR），登录就可以了。
*   如果我在执行 BasicAuth 的测试之前运行另一个测试并转到另一个 URL（如 foo.html，这在我的情况下很常见），我会得到一个 BasicAuth 屏幕。

如果我更改打开 bar.html 的调用并具有：

```
self.selenium.open('bar.html') 
```

*   如果我只运行这一项测试（BAR）登录失败（我得到一个 BasicAuth 屏幕）
*   如果我在执行 BasicAuth 的测试之前运行另一个测试并转到另一个 URL，我可以成功转到该 URL。

所以问题基本上是：我不能*总是*做一个 BasicAuth 因为那样 BAR 测试大部分时间都会失败。从不做 BasicAuth 也不是一种选择，因为我不能指望 BAR 测试会在另一个测试做 BasicAuth 之后出现。

这个问题看起来像[SeleniumRC docs 中](http://seleniumhq.org/docs/05_selenium_rc.html#permission-denied-error)描述的问题，但我不明白为什么在这种情况下这种重新身份验证会出错......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T04:56:33.083

对于火狐。尝试通过输入 url 更改以下标志`about:config`并搜索以下过滤器：

```
browser.safebrowsing.malware.enabled 
```

![在此处输入图像描述](../Images/46a135f9755ab5c39d79366227d60c5c.png)

您可以使用 about:config 服务页面在默认的 Firefox 配置文件中更改此标志的状态（双击该标志以更改其状态） 从现在开始，Firefox 应该允许您使用 url 中的名称和密码进行 http 身份验证。（请注意，如果您使用 Selenium WebDriver 2.6 或更高版本，则默认情况下应禁用此标志）

# asp.net - 如何在 Web.config 中加密连接字符串 - 已停用的内容？

> ID：10836305
> 
> 赞同：3
> 
> 时间：2012-05-31T15:10:25.110
> 
> 标签：asp.net, encryption, web-config, deprecated, aspnet-regiis.exe

我目前有一个 ASP.NET 网站，它的 web.config 文件中有一个加密的连接字符串。这些设置位于常规 AppSettings 部分，而不是 ConnectionString 部分。在应用程序代码中，我们根据需要在运行时手动解密连接字符串。

在重构站点时，我遇到了 Microsoft 曾经建议的一种方法，该方法涉及运行`aspnet_regiis`命令，以便将加密数据直接插入 web.config 文件的 ConnectionString 部分。这个建议的方法现在被认为是退休内容，尽管它没有说明原因（除了一些链接可能不再有效的小参考）。

这是我所指的站点：
[如何：使用 DPAPI 加密 ASP.NET 2.0 中的配置部分](http://msdn.microsoft.com/en-us/library/ff647398.aspx)

我的问题基本上是——我是否应该费心重构现有功能以使用微软曾经推荐的方式？我相信它会比目前的流程更有效率。另外，为什么这种方法会被视为已停用的内容？有没有更好的方法来做到这一点，而不是我的网站支持加密/解密方法？

我已经在 Google 和 StackOverflow 上搜索了其他方法，但它们似乎都指的是微软的方式——或者我目前实现它的方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T07:28:49.600

Maybe the site/doc you're referring to is marked as obsolete, but the technology behind is not. Here are the official links, not marked as obsolete:

*   [DpapiProtectedConfigurationProvider Class](http://msdn.microsoft.com/en-us/library/system.configuration.dpapiprotectedconfigurationprovider%28v=vs.110%29.aspx) (with an example), there is also the RsaProtectedConfigurationProvider that is capable of encrypting sections
*   [Encrypting Configuration Information Using Protected Configuration](http://msdn.microsoft.com/en-us/library/53tyfkaw%28v=vs.110%29.aspx)
*   [Encrypting and Decrypting Configuration Sections](http://msdn.microsoft.com/en-us/library/zhhddkxy.aspx)
*   [ASP.NET IIS Registration Tool (Aspnet_regiis.exe)](http://msdn.microsoft.com/library/k6h9cz8h.aspx) with the -pe option

I would definitely use this technology.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T16:45:46.907

我猜他们说该文档被视为已停用的内容，因为它是为 .NET 2.0 框架编写的。话虽如此，正如西蒙所说，它背后的技术仍然很好用。

用于加密 web.config 文件的`aspnet_regiis`好处是它对应用程序是透明的。您可以编写逻辑，假设 appSettings 或 connectionStrings 部分未加密，如果使用此方法对它们进行加密，.NET 框架将在为您提供值之前对它们进行解密。

使用此方法要记住的一件事是它将加密整个 appSettings 部分。如果您在加密后打开 web.config，您将看不到任何密钥，而只会看到一大块加密的数据。

# jsf - ui:repeat 或 p:dataTable 不适用于 list<>

> ID：10836306
> 
> 赞同：0
> 
> 时间：2012-05-31T15:10:28.023
> 
> 标签：jsf

我有这个方法：

```
public List<RequestItemVO> getRequestItem() {
        //compiled code
        throw new RuntimeException("Compiled Code");
} 
```

当我尝试这个时：

```
<ui:repeat value=#{requestController.backing.requestVO.requestItem} var="item">
    <h:outputText value="#{item.id}" />
<ui:repeat> 
```

我没有任何结果，我的 HTML 上没有生成任何内容（检查了源代码）。

但如果我这样做：

```
<h:outputText value="#{requestController.backing.requestVO.requestItem.get(0).getMaterial().getDescription()}"/> 
```

我有材料说明。

为什么它不适用于`<ui:repeat>`or `<p:dataTable>`？我需要它在那里工作以列出所有请求项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T20:37:22.770

根据您尝试`<ui:repeat>`在`<p:panelGrid>`. 仅当您将其包装在`<p:row><p:column>`. 在 a`<p:dataTable>`中，只有将其包裹在`<p:column>`.

# hibernate - Hibernate/JPA @OneToOne 返回空指针异常

> ID：10836310
> 
> 赞同：1
> 
> 时间：2012-05-31T15:10:53.033
> 
> 标签：hibernate, jpa, spring-security, hibernate-mapping

基本堆栈：Spring/Spring Security/Hibernate with Glassfish

尝试连接两个表中的两列，但未返回数据。代码编译和部署没有问题。执行时`CustomUserDetailsService`尝试检索`role`，我得到以下信息：

```
Caused by: java.lang.RuntimeException: java.lang.NullPointerException
    at com.bossmop.service.user.CustomUserDetailsService.loadUserByUsername(CustomUserDetailsService.java:68) ~[CustomUserDetailsService.class:na] 
```

**错误**引用的行在块的`Return`语句中。`try`特别**是 getAuthorities(accountUser.getRole().getRole()))**

客户详情服务

```
@Service("userDetailsService")
@Transactional(readOnly=true)
public class CustomUserDetailsService implements UserDetailsService {

protected static Logger logger = LoggerFactory.getLogger(CustomUserDetailsService.class);

@Autowired
private IAccountDAO accountDAO;

@Override
public UserDetails loadUserByUsername(String username)
        throws UsernameNotFoundException {

    logger.info("CustomUserDetailService.loadUserByUsername");
    logger.debug("username: ", username);

    try {
        Account accountUser = accountDAO.findUserByUsername(username);

        logger.debug("returnfrom AccountDAO.findUserByUsername");
        logger.debug("accountUser.email: " + accountUser.getEmail());
        logger.debug("accountUser.role: " + accountUser.getRole().getRole());
        boolean enabled=true;
        boolean accountNonExpired = true;
        boolean credentialsNonExpired = true;
        boolean accountNonLocked = true;

        // TODO Generate variable columns in database
        return new User(
                accountUser.getUsername(),
                accountUser.getPassword(),
                enabled,
                accountNonExpired,
                credentialsNonExpired,
                accountNonLocked,
                getAuthorities(accountUser.getRole().getRole()));

    } catch (Exception e) {
        // TODO  handle exception
        logger.debug("exception in CustomUserDetailService");
        logger.debug("EXCEPTION: " + e);
        throw new RuntimeException(e);
    }
} 
```

表关系为：`USERS primary_key(user_id) = ROLE(fk_user_id)`

模型 1：用户

```
// Import statements...

@Entity
@Table(name="users")
public class Account {

private int id;
private String forename;
private String surname;
private String username;
private String password;
private String email;
private Date birthdate;

private Role role;

@Id
@GeneratedValue(strategy=GenerationType.AUTO)
@Column(name="user_id", unique=true, nullable=false)
public int getId() {
    return id;
}
public void setId(int id) {
    this.id = id;
}

@Column(name="forename")
public String getForename() {
    return forename;
}
public void setForename(String forename) {
    this.forename = forename;
}

@Column(name="surname")
public String getSurname() {
    return surname;
}
public void setSurname(String surname) {
    this.surname = surname;
}

@Column(name="username",unique=true,nullable=false)
public String getUsername() {
    return username;
}
public void setUsername(String username) {
    this.username = username;
}

@Column(name="password",nullable=false)
public String getPassword() {
    return password;
}
public void setPassword(String password) {
    this.password = password;
}

@Column(name="email",unique=true,nullable=false)
public String getEmail() {
    return email;
}
public void setEmail(String email) {
    this.email = email;
}

@Column(name="birthdate")
public Date getBirthdate() {
    return birthdate;
}
public void setBirthdate(Date birthdate) {
    this.birthdate = birthdate;
}

@OneToOne(mappedBy="account", fetch=FetchType.LAZY, cascade={CascadeType.ALL})
public Role getRole() {
    return role;
}
public void setRole(Role role) {
    this.role = role;
}

@Override
public String toString() {
    StringBuffer strBuff = new StringBuffer();
    strBuff.append("id: ").append(getId());
    strBuff.append("username: ").append(getUsername());
    strBuff.append("email: ").append(getEmail());
    return strBuff.toString();
}
} 
```

模型 2：角色

```
@Entity
@Table(name="role")
public class Role {

    private int id;
    private int role;

    private Account account;

    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    @Column(name="role_id", unique=true, nullable=false)
    public int getId() {
        return id;
    }
    public void setId(int id) {
        this.id = id;
    }

    @Column(name="role", nullable=false)
    public int getRole() {
        return role;
    }
    public void setRole(int role) {
        this.role = role;
    }

    @OneToOne
    @JoinColumn(name="user_id", referencedColumnName="user_id", nullable=false)
    public Account getAccount() {
        return account;
    }

    public void setAccount(Account account) {
        this.account = account;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T14:57:31.850

上述配置有效。该代码不起作用，因为没有与我正在测试的用户关联的角色。

# zend-framework - Zend 框架包含路径

> ID：10836311
> 
> 赞同：0
> 
> 时间：2012-05-31T15:10:57.980
> 
> 标签：zend-framework, include-path

我试图让 zend 框架运行，但包含路径不喜欢我；）
zend 目录在这里[http://mydomain.com/zend/](http://mydomain.com/zend/)

```
<?php
set_include_path('/var/www/www.mydomain.com/htdocs/zend/library/');

require_once 'Zend/Gdata/Youtube.php';
require_once 'Zend/Loader.php'; // the Zend dir must be in your include_path

Zend_Loader::loadClass('Zend_Gdata_YouTube');
Zend_Loader::loadClass('Zend_Gdata_ClientLogin');

?> 
```

我得到这个错误：

> 警告：require_once(Zend/Gdata/Youtube.php) [function.require-once]：无法打开流：/var/www/www.mydomain.com/htdocs/zend/index.php 中没有这样的文件或目录第 4 行
> 
> 致命错误：require_once() [function.require]：无法在 /var 中打开所需的 'Zend/Gdata/Youtube.php' (include_path='/var/www/www.mydomain.com/htdocs/zend/library/') /www/www.mydomain.com/htdocs/zend/index.php 第 4 行

我在另一台可以运行的服务器上进行了类似的设置，但是这里一定有问题..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:16:20.950

我想你想要：

```
require_once 'Zend/Gdata/YouTube.php'; 
```

（注意大写 T）。它工作的其他服务器可能正在使用不区分大小写的文件系统。

# iphone - prime31 游戏中心插件教程

> ID：10836312
> 
> 赞同：0
> 
> 时间：2012-05-31T15:11:10.670
> 
> 标签：iphone, ios, unity3d, game-center, prime31

我昨天买了游戏中心插件，我是 Unity 的新手，我很困惑.. 我在 Objective-C 方面做得很好，我已经做了很多游戏中心.. 但是有了这个插件，现在有（如何to）没有关于如何实现它的简洁文档..我使用他们在 unity 3.5 上提供的测试场景将应用程序构建到 xcode，它给了我错误消息

> > EntryPointNotFoundException: _gameCenterRetrieveFriends
> 
> ```
>  at (wrapper managed-to-native) GameCenterBinding:_gameCenterRetrieveFriends (bool)
> 
>   at GameCenterBinding.retrieveFriends (Boolean loadProfileImages) [0x00000] in <filename unknown>:0 
> 
>   at GameCenterGUIManager.OnGUI () [0x00000] in <filename unknown>:0 
> 
> (Filename:  Line: -1) 
> ```

它无法检查游戏中心是否可用并且无法进行身份验证..我花了很多时间试图找出问题所在..我已经统一了应用程序标识符，一切都和我一样在普通的iphone应用程序上做了..但总是出错，没有任何反应..有什么问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T12:14:23.397

在他们的网站上有一个关于[GameCenter 插件](http://prime31.com/unity/docs/#gameCenterDoc)的简短文档和 Unity3D 手册中的一些内容：

[插件（Pro/Mobile-Only 功能）](http://unity3d.com/support/documentation/Manual/Plugins.html)

[为 iOS 构建插件](http://unity3d.com/support/documentation/Manual/PluginsForIOS.html)

我推荐[Unity3D 论坛](http://forum.unity3d.com/forums/10-Unity-Support)，因为 Prime31 在那里非常活跃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-26T11:53:16.900

你在 iPhone 模拟器上运行了 xcode 项目吗？prime31 插件正在使用与 iOS 的本机绑定，这在 iPhone 模拟器上不起作用。尝试在真正的 iOS 设备上运行它。

# ilmerge - 使用 ILMerge 将 DLL 与 EXE 结合起来？

> ID：10836315
> 
> 赞同：3
> 
> 时间：2012-05-31T15:11:19.743
> 
> 标签：ilmerge

我正在使用 ILMerge 来组合 dll 和 exe。省略 dll 的 .xml 文件是否安全（ILMerge 不喜欢它们）？app.config 呢？

# visual-studio-2010 - 切换 Visual Studio 2010 许可证密钥

> ID：10836319
> 
> 赞同：8
> 
> 时间：2012-05-31T15:11:30.437
> 
> 标签：visual-studio-2010

我使用了一个许可证密钥，并希望将我的配置切换为使用另一个密钥。

我尝试从 Windows 控制面板中的“添加/删除程序”启动卸载向导。当我重新安装时，许可证仍然有效。

如何修改我的 Visual Studio 2010 安装以使用另一个密钥，并且可能无需卸载和重新安装？

**很抱歉一开始没有澄清。实际上，我目前无法使用有效的密钥。有没有办法完全删除原始许可证并使用 VS 作为试用版数天。**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-31T15:15:10.310

安装 Visual Studio 2010 后更改序列号

1.  转到控制面板 -> 程序和功能，找到并突出显示 Microsoft Visual Studio 2010 Ultimate/Premium/Professional 安装，然后单击卸载/更改按钮。

2.  升级 Visual Studio 2010 产品密钥以进行激活

3.  应显示 Visual Studio 设置维护屏幕。单击下一步按钮后，可以选择输入有效序列号以升级产品许可证。

4.  相应地输入升级密钥，然后单击激活按钮。无需重新安装。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-17T14:47:31.560

有一种方法可以在名为`Setup.SDB`. 它应该位于

`\Program Files (x86)\Microsoft Visual Studio 10.0\Microsoft Visual Studio 2010 Professional - ENU\Setup.SDB`

在记事本中编辑此文件并搜索`Product key`. 然后，您可以更新产品密钥。

在此更改之后，我实际上修复了安装，以确保一切正常。这是在`VS2008`和`VS2010`

# python - 关于 Diffie-Hellman 密钥交换

> ID：10836320
> 
> 赞同：4
> 
> 时间：2012-05-31T15:11:32.223
> 
> 标签：python, encryption

我正在阅读的书对算法的解释如下：

*   2 人想到 2 个公开的“n 和 g”数字都知道。
*   2 个人想到了他们保密的 2 个私人“x”和“y”数字。

交换发生如图所示

![在此处输入图像描述](../Images/eaf0abd01296f30e07a6e9a8d6acf26b.png)

我将以下 python 代码放在一起，看看它是如何工作的，而......它没有。请帮助我了解我缺少什么：

```
 #!/usr/bin/python

 n=22 # publicly known 
 g=42 # publicly known

 x=13 # only Alice knows this 
 y=53 # only Bob knows this

 aliceSends = (g**x)%n 
 bobComputes = aliceSends**y 
 bobSends = (g**y)%n
 aliceComputes = bobSends**x

 print "Alice sends    ", aliceSends 
 print "Bob computes   ", bobComputes 
 print "Bob sends      ", bobSends 
 print "Alice computes ", aliceComputes

 print "In theory both should have ", (g**(x*y))%n

 ---

 Alice sends     14  
 Bob computes    5556302616191343498765890791686005349041729624255239232159744 
 Bob sends       14 
 Alice computes  793714773254144 

 In theory both should have  16 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-31T15:13:50.163

您忘记了另外两个模数：

```
>>> 5556302616191343498765890791686005349041729624255239232159744 % 22
16L
>>> 793714773254144 % 22
16 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-31T15:29:11.603

罗曼是对的。但是，您最好看一下 pow() 三参数函数。更快，第三个参数是模数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-16T12:45:53.100

两个人

```
#!/usr/bin/python
p=141301# publicly known 
g=5728435 # publicly known
x=76435 # only Alice knows this 
y=37846 # only Bob knows this
aliceSends = (g**x)%p 
aliceComputes = (bobSends**x)%p
bobSends = (g**y)%p
bobComputes = (aliceSends**y) %p
bobSends = (g**y)%p
bobComputes = (aliceSends**y) %p
print ("Alice sends    ", aliceSends )
print ("Bob computes   ", bobComputes )
print ("Bob sends      ", bobSends)
print ("Alice computes ", aliceComputes) 
```

三人以上

```
#!/usr/bin/python
p=141301# publicly known 
g=5728435 # publicly known
x=76435 # only Alice knows this 
y=37846 # only Bob knows this
z=23# only carol knows this
aliceSends = (g**x)%p 
bobSends = (aliceSends**y)%p
carolComputes=(bobSends**z)%p
bobSends2=(g**y)%p
carolSends=(bobSends2**z)%p
aliceComputes=(carolSends**x)%p
carolSends2=(g**z)%p
aliceSends2=(carolSends2**x)%p
bobComputes=(aliceSends2**y)%p
print ("Alice computes ga and sends it to Bob.",aliceSends)
print ("Bob computes (ga)b = gab and sends it to Carol.",bobSends)
print ("Carol computes (gab)c = gabc and uses it as her secret.",carolComputes)
print ("Bob computes gb and sends it to Carol.",bobSends2)
print ("Carol computes (gb)c = gbc and sends it to Alice.",carolSends)
print ("Alice computes (gbc)a = gbca = gabc and uses it as her  secret.",aliceComputes)
print ("Carol computes gc and sends it to Alice.",carolSends2)
print ("Alice computes (gc)a = gca and sends it to Bob.",aliceSends2)
print ("Bob computes (gca)b = gcab = gabc and uses it as his 
secret.",bobComputes) 
```

# java - 如何将 onClick 事件分配给 jQuery/JSP/Java 中的多个图像？

> ID：10836321
> 
> 赞同：0
> 
> 时间：2012-05-31T15:11:32.847
> 
> 标签：java, jquery, jsp

我正在尝试将 jQuery 与 JSP 一起使用来显示一个表格，其中每一行都有三个可能的操作：向上、向下、刷新。我想为每个甚至彼此相邻显示一个图像，并且能够单击每行中的按钮以执行我的 Java 代码中定义的请求操作（向上/向下/刷新）。因此，每个按钮和每一行都会执行不同的操作/功能。例如：第 1 行操作将是：modelUp、modelDown、modelRefresh；第 2 行的操作是：productionUp、productionDown、productionRefresh；... ETC。

问题是我不了解 jQuery，并且几乎没有使用 JSP 的经验。我一直在谷歌，但它并没有让我走得很远。

有人可以帮我吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:19:04.973

基本上，您通过使用将一个动作附加到 jQuery 中的 CSS 选择器

```
$('.classname').bind('click', function() {
  // do something
}); 
```

每当单击具有类的内容时，这将执行代码`.classname`。

在您的情况下，您将有 3 个类，每种按钮一个。如何指定自定义行为是您的选择。您可以将一些自定义属性附加到每一行的每个 DOM 元素，以便在 click 函数中您能够区分它们并相应地执行不同的操作。

请注意，这是一个很好的设计，前提是您可以使用此属性而不会因为长长的 if/else 链而使您的点击功能变得混乱，否则您最好将许多不同的操作绑定到每个按钮。由于您使用的是 JSP，因此您可以在为客户端生成结果 HTML 时动态生成 JS 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T13:14:04.553

好的，我几乎通过这种方式解决了大部分问题。

这是我的 JSP（这只是表格的一行，但其余的遵循相同的方案）：'code

```
<form id="checkStatusForm" action="<%= model.getUri() %>" method="post" >
<input type="hidden" name="<%=FrameworkConstants.FRAMEWORK_COMMAND%>" value="checkstatus" />
<input type="hidden" name="<%=FrameworkConstants.FRAMEWORK_GUID%>" value="<%=model.getPageId()%>" />
<input type="hidden" name="regionID" id="regionID" value="" />
<input type="hidden" name="regionAction" id="regionAction" value="" />

<img src="<%=request.getContextPath() %>/images/up.jpg" alt="" name="modelUp" width="20" height="20" id="modelUp" onclick="CheckStatus.performRegionAction('model', 'up')" />
<img src="<%=request.getContextPath() %>/images/down.jpg" alt="" name="modelDown" width="20" height="20" id="modelDown" onclick="CheckStatus.performRegionAction('model', 'down')" />
<img src="<%=request.getContextPath() %>/images/refresh.png" alt="" name="modelRefresh" width="20" height="20" id="modelRefresh" onclick="CheckStatus.performRegionAction('model', 'refresh')" />

<button type="submit" style="margin-left: 2px; margin-top: 5px; margin-bottom: 0px;" >Commit Changes</button>
</form> 
```

'

这是我的 jQuery/Javascript：'代码

```
 performRegionAction : function(regionID, regionAction){
        document.getElementById('regionID').value = regionID;
        document.getElementById('regionAction').value = regionAction;
    },' 
```

最后是我的 Java：'

```
public void setRegionID(Field<String> regionID){
        this.regionID = regionID;
    }

    public Field<String> getRegionID(){
        return this.regionID;
    }

    public void setRegionAction(Field<String> regionAction){
        this.regionAction = regionAction;
    }

    public Field<String> getRegionAction(){
        return this.regionAction;
    } 
```

'

# c# - 坚持基本的 Linq to XML 查询

> ID：10836330
> 
> 赞同：2
> 
> 时间：2012-05-31T15:12:06.667
> 
> 标签：c#, linq, linq-to-xml

我正在尝试从 namecheap 沙箱 api 中提取信息，但无法弄清楚为什么我的 linq 查询不起作用。

这是一个示例响应。

**XML**

```
<ApiResponse Status="OK" xmlns="http://api.namecheap.com/xml.response">
  <Errors />
  <Warnings />
  <RequestedCommand>namecheap.domains.check</RequestedCommand>
  <CommandResponse>
    <DomainCheckResult Domain="google.com" Available="false" />
  </CommandResponse>
  <Server>WEB1-SANDBOX1</Server>
  <GMTTimeDifference>--4:00</GMTTimeDifference>
  <ExecutionTime>0.875</ExecutionTime>
</ApiResponse> 
```

**C＃**

```
var doc = XDocument.Load(url);
var response = (
    from  r in doc.Root.Descendants("ApiResponse") 
    where 1==1
    select new  { 
        Errors = r.Element("Errors").Value,
        Warnings = r.Element("Warnings").Value,
        RequestedCommand = r.Element("RequestedCommand").Value,
        CommandResponse = r.Element("CommandResponse").Value,
        Server = r.Element("Server").Value
    }
); 
```

我也用同一个文档尝试了这个查询，只是为了看看一个简单的例子是否有效。

```
var test = doc.Descendants("RequestedCommand").First().Value; 
```

但两者都返回 null。那么我哪里错了？我最终需要了解 CommandResponse 中的顶级元素和更深层次的元素。对此的任何帮助也将不胜感激。

**更新**

正如乔恩的回答所提到的，这主要是在引用各种元素时不使用命名空间的问题。还使用了 doc.Elements() 而不是 doc.Root。后人（）。

这是一个更新的工作版本。

```
XNamespace ns = "http://api.namecheap.com/xml.response";
var response = (
    from r in doc.Elements()
    select new
    {
        Errors = r.Element(ns + "Errors").Value,
        Warnings = r.Element(ns + "Warnings").Value,
        RequestedCommand = r.Element(ns + "RequestedCommand").Value,
        CommandResponse = r.Element(ns + "CommandResponse").Value,
        Server = r.Element(ns + "Server").Value
    }
); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T15:14:22.233

问题是您在查找元素、后代等时没有使用命名空间：

```
XNamespace ns = "http://api.namecheap.com/xml.response";
var doc = XDocument.Load(url);
var response = doc.Root
                  .Descendants(ns + "ApiResponse")
                  .Select(r => new {
                              Errors = r.Element(ns + "Errors").Value,
                              ...
                          }); 
```

（请注意，您`where 1 == 1`在 LINQ 中永远不需要......我已经从查询表达式语法中更改了它，因为它没有给您任何东西。）

命名空间继承自`<ApiResponse>`元素作为所有其他元素的默认命名空间，因为它只是`xmlns=...`而不是指定别名。

另请注意，如果您向我们展示了*整个*XML 文档，那么上面将找不到任何元素，因为您要求的是根`ApiReponse`元素*下方*的元素，而它*是*根元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T16:14:05.727

我刚刚得到了Skeeted ;)

这是我在 linqpad 中为您获取 XML 中的元素之一所做的事情

```
var myxml = @"<ApiResponse Status=""OK"" xmlns=""http://api.namecheap.com/xml.response"">
<Server>WEB1-SANDBOX1</Server>
<Errors />
<Warnings />
<RequestedCommand>namecheap.domains.check</RequestedCommand>
<CommandResponse>
    <DomainCheckResult Domain=""google.com"" Available=""false"" />
</CommandResponse>

<GMTTimeDifference>--4:00</GMTTimeDifference>
<ExecutionTime>0.875</ExecutionTime>
</ApiResponse>";

//myxml.Dump();

XNamespace p = "http://api.namecheap.com/xml.response";
var doc1 = XElement.Parse(myxml);
var x = from n in doc1.Elements(p + "Server")  select n;
x.First().Value.Dump(); 
```

# python - PayPal IPN POST 请求编码

> ID：10836337
> 
> 赞同：10
> 
> 时间：2012-05-31T15:12:31.940
> 
> 标签：python, utf-8, paypal, paypal-ipn

尝试在 Pyramid（可能还有其他人）中使用 PayPal IPN POST 有效负载时，出现解码错误：

```
[...]
 File "./project/views.py", line 716, in paypal_ipn
    message = request.POST
  File "build/bdist.linux-x86_64/egg/webob/request.py", line 745, in POST
  File "build/bdist.linux-x86_64/egg/webob/multidict.py", line 74, in from_fieldstorage
  File "build/bdist.linux-x86_64/egg/webob/multidict.py", line 67, in <lambda>
  File "/sites/ts/lib64/python2.6/encodings/utf_8.py", line 16, in decode
    return codecs.utf_8_decode(input, errors, True)
UnicodeDecodeError: 'utf8' codec can't decode byte 0xf3 in position 5: invalid continuation byte 
```

如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-07T14:23:54.607

将您的“问题”编辑为一个真正的问题，我们会很高兴！

* * *

由于某些不虔诚的原因，PayPal 仍然不在 21 世纪，并且默认情况下仍使用 Windows-1252 编码。这可能会产生一些问题，因为现在期望 unicode 成为一种编码选择是很合理的。

在使用 Pyramid 时，这可能会导致类似以下回溯：

```
[...]
 File "./project/views.py", line 716, in paypal_ipn
    message = request.POST
  File "build/bdist.linux-x86_64/egg/webob/request.py", line 745, in POST
  File "build/bdist.linux-x86_64/egg/webob/multidict.py", line 74, in from_fieldstorage
  File "build/bdist.linux-x86_64/egg/webob/multidict.py", line 67, in <lambda>
  File "/sites/ts/lib64/python2.6/encodings/utf_8.py", line 16, in decode
    return codecs.utf_8_decode(input, errors, True)
UnicodeDecodeError: 'utf8' codec can't decode byte 0xf3 in position 5: invalid continuation byte 
```

要解决此问题，您必须：

1.  单击“我的帐户”下的“个人资料”链接
2.  在 «Selling Preferences» 列中找到 «Language Encoding»
3.  点击«更多选项»
4.  选择«UTF-8»并保存

或者

1.  单击“我的帐户”下的“个人资料”链接
2.  点击右侧的«我的销售工具»
3.  找到«PayPal按钮语言编码»链接（应该在底部）
4.  点击«更多选项»
5.  选择«UTF-8»并保存

取决于您的 PayPal 账户类型。希望这能拯救一个人和一个小时的生命。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-14T19:49:00.367

由于某些不虔诚的原因，PayPal 仍然不在 21 世纪，并且默认情况下仍使用 Windows-1252 编码。这可能会产生一些问题，因为现在期望 unicode 成为一种编码选择是很合理的。

要解决此问题，您必须：

1.  单击“我的帐户”下的“个人资料”链接
2.  在 «Selling Preferences» 列中找到 «Language Encoding»
3.  点击«更多选项»
4.  选择«UTF-8»并保存

或者

1.  单击“我的帐户”下的“个人资料”链接
2.  点击右侧的«我的销售工具»
3.  找到«PayPal按钮语言编码»链接（应该在底部）
4.  点击«更多选项»
5.  选择«UTF-8»并保存

取决于您的 PayPal 账户类型。希望这可以节省一个小时的生命。

# javascript - 一个打开的模式对话框阻止了操作（Cucumber、Watir-WebDriver、Chrome）

> ID：10836339
> 
> 赞同：0
> 
> 时间：2012-05-31T15:12:44.573
> 
> 标签：javascript, google-chrome, cucumber, watir-webdriver

我有一个问题：我在我的网络网站上创建了一个新组，然后我会删除它。当我成功时 - 我看到一个新窗口（JavaScript），我无能为力。如果我看到这个窗口，我该如何编写我的代码？

我在 Cucumber 中使用 Watir-WebDriver，并使用 Google Chrome。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T07:46:10.450

Not sure if this helps 100% but in my Ruby code I `require "dialogs.rb"` and then call `killjspopup(browser)` right after loading a new page into Watir::Browser. This file contains:

```
def killjspopup(browser)

# don't return anything for alert
browser.execute_script("window.alert = function() {}")

# return some string for prompt to simulate user entering it
#browser.execute_script("window.prompt = function() {return 'my name'}")

# return null for prompt to simulate clicking Cancel
browser.execute_script("window.prompt = function() {return null}")

# return true for confirm to simulate clicking OK
browser.execute_script("window.confirm = function() {return true}")

# return false for confirm to simulate clicking Cancel
#browser.execute_script("window.confirm = function() {return false}")
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:22:25.190

[您是否尝试过 Watir-Webdriver 页面 - http://watirwebdriver.com/javascript-dialogs/](http://watirwebdriver.com/javascript-dialogs/)上列出的解决方案？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-06T17:39:01.810

`browser.alert.ok`

更多详情请访问：[http://watirwebdriver.com/javascript-dialogs/](http://watirwebdriver.com/javascript-dialogs/)

# c# - 使用水晶报告在预印纸上打印账单

> ID：10836345
> 
> 赞同：0
> 
> 时间：2012-05-31T15:13:15.497
> 
> 标签：c#, crystal-reports, sql-server-express

我正在开发需要打印账单的桌面应用程序。我目前正在使用 Visual Studio 10 和 sql express 作为数据库。我需要在包含大部分内容的预印纸上打印账单。我只需要添加客户姓名，一些客户详细信息和保存在数据库中的账单内容。预印的账单有徽标以及公司的一些基本信息......所以我需要用名称填写账单并使用存储过程搜索数据。

如果有人以任何可能的方式帮助我，我将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:27:44.613

尝试将硬拷贝纸扫描成图像文件，并将该图像文件设置为报告的背景。

从那里，只需将几个字段放在报告中看起来应该去的地方。删除/隐藏背景并打印测试页以查找偏移量。如果页面上的字段通常比应有的高度高一厘米，这应该很明显。然后只需相应地调整字段。

我知道起初这似乎是一项艰巨的任务，但在第一次或两次报告之后，您就会掌握它的窍门。

***[编辑]***

在报表本身中，隐藏页眉和页脚并将详细信息高度设置为 7.5（或任何整页高度，考虑边距）。将包含需要打印的值的记录准确传递给报表。

您也可以考虑使用 SQL Server Reporting Services (SSRS) 而不是 Crystal Reports。Crystal 与桌面应用程序一起部署可能会很棘手。SSRS Express 是免费的。您只需要安装带有高级服务的 SQL Server Express。

# php - 如何将特定图像设置为不保存在缓存中

> ID：10836346
> 
> 赞同：1
> 
> 时间：2012-05-31T15:13:20.083
> 
> 标签：php, javascript, html

我正在构建一个使用 PHP GD 根据用户输入数据创建图像的网站。
所以例如我会有这样的事情：

```
$image = imagecreate(125, 125);
$blue = imagecolorallocate($image, 0, 0, 255);
imagepng($image, "1.png");
imagedestroy($image);
header("Location: ../index.php"); 
```

生成图像 1.png 并返回站点的索引。

在索引上，如果文件存在，我只是用一些更简单的 php 显示代码

```
<?php if(!file_exists("php/1.png"))
        echo ("<center><h2> No panels added!</h2></center>");
        else
        echo('<img class="p_image" src="php/1.png">');
    ?> 
```

我遇到的问题是浏览器会缓存最后生成的 1.png，即使用户删除了它并创建了一个新的，并显示它。有什么办法可以阻止这种情况发生，而不必每次都重命名文件？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:15:11.387

只需将时间戳附加到文件名即可。这将从本质上使其独一无二并防止缓存：

```
echo('<img class="p_image" src="php/1.png?'.time().'">'); 
```

# javascript - 如何在这些按钮上方添加字符串

> ID：10836352
> 
> 赞同：0
> 
> 时间：2012-05-31T15:13:33.563
> 
> 标签：javascript, jquery, html

我有来自 AZ 的按钮。我有下面的 jQuery 代码，如果有 7 个按钮，则显示一个新行。所以它看起来像下面这样：

```
A B C D E F G
H I J K L M N
O P Q R S T U
V W X Y Z 
```

但是我无法解决的问题是我只想`<p>Answer:</p>`在按钮顶部添加一个简单的单词，以便它显示如下：

回答：

```
A B C D E F G
H I J K L M N
O P Q R S T U
V W X Y Z 
```

我只是无法理解它，如何使用我当前的 jQuery 代码来实现这一点：

```
var $this, i=0, $row, $cell;
$('#optionAndAnswer .answers').each(function() {
    $this = $(this);
    if(i%7 == 0) {
        $row = $("<tr/>").appendTo($answer);
        $cell = $("<td/>").appendTo($row);
    }

    var $newBtn = $("<input class='answerBtnsRow answers' type='button' style='display:%s;' onclick='btnclick(this);' />".replace('%s',$this.is(':visible')?'inline-block':'none')).attr('name', $this.attr('name')).attr('value', $this.val()).attr('class', $this.attr('class'));

    $newBtn.appendTo($cell);

    i++;
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:19:49.837

改变你的第二行......

`$('#optionAndAnswer .answers').each(function() {`

... 到 ...

`$('#optionAndAnswer .answers').prepend('<p>Answer:</p>').each(function() {`

# jquery - Safari上的JQuery滚动条抖动

> ID：10836354
> 
> 赞同：0
> 
> 时间：2012-05-31T15:13:42.160
> 
> 标签：jquery, safari, scrollbars

我最近从 malihu (http://manos.malihu.gr/tuts/jquery_custom_scrollbar.html) 添加了一个很棒的自定义滚动条解决方案到我的网站。但是我注意到在我的 Mac 上，当我向下滚动时，滚动会变得非常紧张。几乎就好像它没有拾取慢速滚动，只有快速滚动。

我设置了一个小提琴，您可以在其中看到问题：http: [//jsfiddle.net/qyrrm/6/](http://jsfiddle.net/qyrrm/6/)

该问题似乎特定于 Mac 上的 Safari，因为我已经在 Firefox、Chrome 和 IE7（在仿真下运行）上对其进行了测试，它们似乎都很好。

如果有人知道可能导致问题的原因，那么我很想听听您的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T08:39:01.153

事实证明，这是一个已知问题，开发人员已经通过发布一个降低 Mac Safari 增量的补丁版本解决了这个问题。其他有问题的人可以在以下位置下载补丁版本：

[http://manos.malihu.gr/tuts/jquery_custom_scroller_js_osxsafari.zip](http://manos.malihu.gr/tuts/jquery_custom_scroller_js_osxsafari.zip)

# wpf - 在 ListView 中截断 GridViewColumn 而不是滚动

> ID：10836357
> 
> 赞同：0
> 
> 时间：2012-05-31T15:13:53.360
> 
> 标签：wpf, listview

我有一个 ListView，它偶尔会在一列中包含内容，使其比可用空间更宽，从而导致出现水平滚动条。

我想做的是截断列的内容，以便所有列都可见并且不出现水平滚动条。

我知道我可以禁用滚动条，但这只会使屏幕外的列无法访问。

# wordpress - 为什么我无法将 .htaccess 文件的内容移动到我的虚拟主机中？

> ID：10836359
> 
> 赞同：2
> 
> 时间：2012-05-31T15:13:54.250
> 
> 标签：wordpress, apache2

我有一个包含此内容的 Wordpress 网站的 .htaccess 文件。

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress 
```

我将此内容移动到我的站点的 Apache 虚拟主机中（如下）并删除了 htaccess 文件。

```
<VirtualHost *:80>
ServerName 68.183.153.223
DocumentRoot /home/david/wordpressWebSite

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress

</VirtualHost> 
```

但是，当我尝试重新启动 Apache 时，Apache 输出错误。

```
RewriteBase: only valid in per-directory config files
Action 'restart' failed. 
```

我认为可以将 htaccess 文件内容移动到虚拟主机。什么是错？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T15:17:45.973

根据[文档](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritebase)，`RewriteBase`“为每个目录重写设置基本 URL”。

由于您没有设置每个目录的重写，因此该指令在特定目录的 .htaccess 文件之外毫无意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-20T20:43:15.640

RewriteBase 在虚拟主机文件中不起作用。

你可能想问的问题是：

> 如何在 VHost RewriteRules 中包含相对路径？

特别是，在 vhosts 中，*_FILENAME 返回一个斜杠，后跟 REQUEST_URI，而不是相对或映射到文件系统！
例如，%{SCRIPT_FILENAME}

*   在 .htaccess 中：“assets/style.css”
*   在虚拟主机文件中：“/assets/style.css”
*   你需要：“/var/www/assets/style.css”

有几种解决方案：

*   [解决方案 #1](https://wiki.apache.org/httpd/RewriteContext)：%{DOCUMENT_ROOT}

    ```
    RewriteRule ^/foo/bar$ %{DOCUMENT_ROOT}/foo/baz

    RewriteCond %{DOCUMENT_ROOT}/%{SCRIPT_FILENAME} !-f
    RewriteRule (.*) /script.cgi 
    ```

*   [解决方案#2](http://marc-abramowitz.com/archives/2005/12/18/whats-up-with-request_filename-in-mod_rewrite/)：`<Directory> tags`

    ```
    RewriteEngine On
    <Directory "/var/www/">
        ...
        RewriteCond %{SCRIPT_FILENAME} !-f
        RewriteRule (.*) /script.cgi
    </Directory> 
    ```

    > 在目录标签中，*_FILENAME 与 htaccess 文件中的处理方式相同。
    > 当服务器有多个别名时，使用它可能会出现问题。

*   [解决方案#3](https://stackoverflow.com/questions/10836359/how-come-i-cant-move-the-contents-of-my-htaccess-file-into-my-virtual-host#comment14109940_10836419)：%{REQUEST_URI}

    > 尽可能使用 %{ *_URI} 而不是 %{* _FILENAME}
    > 不是真正的答案。只是指出 *_URI 不必重写，因为它们不应该映射到文件系统，因此 vhost/htaccess 路径是相同的。但是，并不总是可以使用 REQUEST_URI，David Faux 在上面评论说它比较慢。此外，这

# iphone - 从 NSMutableDictionary 中的 NSMutableDictionary 获取值

> ID：10836362
> 
> 赞同：0
> 
> 时间：2012-05-31T15:14:02.813
> 
> 标签：iphone, ios5

我创建了两个`NSMutableDictionary`：dictionary1 和 dictionary2。在第一个字典中，我存储了一些具有键的数组对象。在第二个字典中，我用这样的键存储第一个字典的对象：

```
int page = 1;
[dictionary2 setObject:dictionary1 forKey:[NSString stringWithFormat:@"%d",page]];
[dictionary1 removeAllObjects]; 
```

但是在检索对象时，我确实喜欢这样

```
dictionary1 = [dictionary2 valueForKey:[NSString stringWithFormat:@"%d",page]];
NSLog(@"dictionary1 %@", dictionary1);` 
```

然后它给出空值。我不知道我犯了什么错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T15:18:01.563

添加`dictionary1`到后`dictionary2`，您将删除所有对象。

这与 dictionary2 中的字典相同（它不会创建副本），因此您也将从中删除对象。

您需要删除该行`[dictionary1 removeAllObjects];`。

然后，既然你已经完成了`dictionary1`这一点，你可以删除对它的引用或设置一个很好的新闪亮字典，它可以使用：

```
// Remove the reference
dictionary1 = nil;

// Or, create a new, empty dictionary
dictionary1 = [[NSDictionary alloc] init]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:16:22.767

您是否正确分配/初始化`dictionary1`和`dictionary2`？确保字典本身不是`nil`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:17:21.477

试试这个

```
 dictionary1 = [dictionary2 objectForKey:[NSString stringWithFormat:@"%d",page]]; 
```

# r - 需要包树分类结果的其他输出

> ID：10836363
> 
> 赞同：2
> 
> 时间：2012-05-31T15:14:04.357
> 
> 标签：r, function, tree, classification

具有多个类值的类目标字段的包的树分类输出`tree`如下所示：

```
 30-39     40-49     50-59     60plus       to29
1 0.1723497 0.2145071 0.5151891 0.02588345 0.07207068
2 0.1451786 0.1370050 0.2740099 0.32061886 0.12318770
4 0.1723497 0.2145071 0.5151891 0.02588345 0.07207068 
```

但我希望结果是这样的：

```
1  50-59
2  60plus
4  50-59 
```

是否有任何已实现的函数（我还没有找到）可以自动提供此输出，还是我必须编写一个 R 函数？

该函数必须获取每行的最大值，获取该行中匹配值的索引，然后提供该索引的年龄类别，如`60plus`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:36:39.640

在`predict`函数中有一个名为 的参数`type`。它定义了预测所需的输出类型。

做就是了

```
predict(treeobject, type="class") 
```

你会得到更高概率的类别。

有关详细信息，请参阅[参考手册](http://cran.r-project.org/web/packages/tree/tree.pdf)。(predict.tree 函数)

# php - 如果自用户上次访问以来的新记录显示图像

> ID：10836366
> 
> 赞同：0
> 
> 时间：2012-05-31T15:14:23.580
> 
> 标签：php, mysql

如果自该注册用户上次访问以来创建了一条 sql 记录，是否有可能有一个图像会改变，如果不满足条件，是否有另一个图像。

记录表`matningar`带有日期字段`datum`。也许下面的代码接近实现这一目标？！

```
 <?php

    $stmt = "SELECT * FROM matningar WHERE `datum` > date("F j, Y, g:i a", $database-    >getLastUserRegisteredDate()";
    $result=mysql_query($stmt);
    foreach($result as $rec){
    echo "<img src=\"images/somepicture.png\" />";
    } 
    ?> 
```

非常感谢您对如何进行的一些意见！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:29:26.627

我相信最好的方法是在创建表时使用此方法存储更新的记录时间。

```
updated TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP 
```

这样，当您从数据库中选择记录并将它们显示在页面上时，您可以执行类似的操作以根据当前用户上次访问显示单独的图像：

```
foreach($results as $record) {
  if($record['updated'] > $currentUser->getLastVisited()) {
    echo "<img .... />"; // Has been modified since last visit
  } else {
    echo "<img .... />"; // Not been modified since last visit
  }
  // Display rest of this record
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:30:05.300

您可以计算返回的记录并使用条件语句来确定要显示的图像。例如使用您的代码：

```
/* Using a mysql query which is discouraged and will be depreceated in future */

      // declare variables
      $i = 0;
      $lastRegisteredDate = date("F j, Y, g:i a", $database->getLastUserRegisteredDate());

      // declare statement string
      $stmt = "SELECT * FROM matningar WHERE `datum` > $lastRegisteredDate";

      // execute query
      $result=mysql_query($stmt);

      // make sure query executed properly
      if (!$result) {
        die('Invalid query: ' . mysql_error());
      }

      // manually count the number of results
      while ($row = mysql_fetch_assoc($result)) {
        $i++;
      }

      // display image based on conditions
      if($i == 0) {
        // display one image
      }
      else {
        // display another image
      } 
```

正如旁注 mysql 函数将在即将发布的 PHP 版本中被弃用，所以我将开始考虑使用 PDO 或 mysqli 库进行 mysql 查询。

```
/* Using the PDO library */

  // declare variables
  $i = 0;
  $lastRegisteredDate = date("F j, Y, g:i a", $database->getLastUserRegisteredDate());

  // declare database handler
  $DBH = new PDO( "mysql:host=$host;dbname=$dbname", $user, $pass );

  // prepare query
  $STH = $DBH->prepare( "SELECT * FROM matningar WHERE `datum` > ?" );

  // execute query
  $STH->execute( array( $lastRegisteredDate ) );

  // set fetch mode  
  $STH->setFetchMode( PDO::FETCH_OBJ );

  // manually count the number of results
  while ( $row = $STH->fetch() ) {
    $i++;
  }

  // display image based on conditions
  if($i == 0) {
    // display one image
  }
  else {
    // display another image
  } 
```

# c# - 在 Metro 风格应用中将图像下载到本地存储

> ID：10836367
> 
> 赞同：5
> 
> 时间：2012-05-31T15:14:32.333
> 
> 标签：c#, xaml, windows-8, windows-runtime

在 WinRT / C# 中，如何将图像下载到本地文件夹以支持缓存在线目录以供离线使用？有没有办法直接下载图像并链接控件以从缓存中获取它们作为后备？

```
 var downloadedimage = await HttpWebRequest.Create(url).GetResponseAsync();
    StorageFile imgfile = await ApplicationData.Current.LocalFolder.CreateFileAsync(
                        "localfile.png", CreationCollisionOption.FailIfExists); 
```

下一步我该怎么做才能将下载的图像存储为 localfile.jpg？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-03T10:35:32.753

看起来 Windows 8 的 HttpClient 示例中的以下代码解决了该问题

```
 HttpRequestMessage request = new HttpRequestMessage(
        HttpMethod.Get, resourceAddress);
    HttpResponseMessage response = await rootPage.httpClient.SendAsync(request,
        HttpCompletionOption.ResponseHeadersRead); 
```

httpClient 是一个 HttpClient，它的 BaseAddress 需要设置为你的资源的服务器文件夹。然后我们可以这样做以将其转换为图像源（如果这是我们正在下载的）

```
 InMemoryRandomAccessStream randomAccessStream = 
        new InMemoryRandomAccessStream();
    DataWriter writer = new DataWriter(randomAccessStream.GetOutputStreamAt(0));
    writer.WriteBytes(await response.Content.ReadAsByteArrayAsync());
    await writer.StoreAsync();
    BitmapImage image = new BitmapImage();
    imagecontrol.SetSource(randomAccessStream); 
```

或者这个把它写到文件中

```
 var imageFile = await ApplicationData.Current.LocalFolder.CreateFileAsync(
         filename, CreationCollisionOption.ReplaceExisting);
    var fs = await imageFile.OpenAsync(FileAccessMode.ReadWrite);
    DataWriter writer = new DataWriter(fs.GetOutputStreamAt(0));
    writer.WriteBytes(await response.Content.ReadAsByteArrayAsync());
    await writer.StoreAsync();
    writer.DetachStream();
    await fs.FlushAsync(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T00:47:41.677

尝试这个：

```
 var response = await HttpWebRequest.Create(url).GetResponseAsync();
        List<Byte> allBytes = new List<byte>();
        using (Stream imageStream = response.GetResponseStream())
        {
            byte[] buffer = new byte[4000];
            int bytesRead = 0;
            while ((bytesRead = await imageStream.ReadAsync(buffer, 0, 4000)) > 0)
            {
                allBytes.AddRange(buffer.Take(bytesRead));
            }
        }
        var file = await ApplicationData.Current.LocalFolder.CreateFileAsync(
                    "localfile.png", CreationCollisionOption.FailIfExists);
        await FileIO.WriteBytesAsync(file, allBytes.ToArray()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T05:46:10.917

如果要下载由 URL 表示的文件，最简单的方法是使用 BackgroundDownloader 类。有关如何使用后台下载器的更多信息，请参阅[此页面。](http://msdn.microsoft.com/en-us/library/windows/apps/hh452979.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T15:59:16.900

GetResponseAsync 会给你一个 WebResponse 文件而不是图像：

```
Stream imageStream = downloadedimage.GetResponseStream(); 
```

然后您可以写入图像文件：

```
byte[] imageData = new byte[imageStream.Length];
using(StreamReader reader = new Streamreader(imageStream))
{
    reader.ReadBytes(imageData, 0, imageData.Length);
}
await FileIO.WriteBytesAsync(imgfile, imageData); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T21:49:49.023

默认情况下，位图图像由 WinRT 缓存，无需开发人员干预。

# r - R Bioconductor 安装错误 - 行开始 '< DOCTYPE html PUBLI ...' 格式错误

> ID：10836371
> 
> 赞同：1
> 
> 时间：2012-05-31T15:14:53.457
> 
> 标签：r, installation, bioinformatics, bioconductor

我在 R 中安装 bioconductor 包时遇到问题。这是在 MacOSX 上，全新安装的 R 2.15，并使用 bioconductor 1.4.4。成绩单如下：

```
> source("http://bioconductor.org/biocLite.R")
BiocInstaller version 1.4.4, ?biocLite for help
> biocLite("Biobase")
BioC_mirror: http://bioconductor.org
Using R version 2.15, BiocInstaller version 1.4.4.
Warning: unable to access index for repository http://brainarray.mbni.med.umich.edu/bioc/bin/macosx/leopard/contrib/2.15
Installing package(s) 'Biobase'
Error: Line starting '<!DOCTYPE html PUBLI ...' is malformed!
> traceback()
6: read.dcf(file = tmpf)
5: available.packages(contriburl = contriburl, method = method)
4: .install.macbinary(pkgs = pkgs, lib = lib, contriburl = contriburl, 
       method = method, available = available, destdir = destdir, 
       dependencies = dependencies, ...)
3: install.packages(pkgs = pkgs, lib = lib, repos = repos, ...)
2: biocLiteInstall(pkgs, ask = ask, siteRepos = siteRepos, suppressUpdates = suppressUpdates, 
       ...)
1: biocLite("Biobase") 
```

我通过谷歌找到的相关问题表明存在互联网连接错误（代理等），但这里似乎并非如此。我可以很好地从 CRAN 安装软件包：（即 install.packages("foreach")）

欢迎提出建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:33:20.650

我相信这是一个错误，当我们的构建在西雅图时间今天早上 10 点完成时将得到纠正——CRANextras 存储库不再可用于 Mac，您会看到重定向页面的顶部。查找 BiocInstaller 版本 > 1.4.5 之后`source("http://bioconductor.org/biocLite.R")`。Bioconductor 邮件列表上有一个[电子邮件线程。](https://stat.ethz.ch/pipermail/bioconductor/2012-May/045868.html)

# java - Subclipse 中带有红色 x 图标的蓝色箭头是什么意思？

> ID：10836372
> 
> 赞同：2
> 
> 时间：2012-05-31T15:14:57.823
> 
> 标签：java, eclipse, subclipse

对于我的问题的更一般版本，有一个很好的答案，但我看到一个蓝色箭头（文件的内容更改已提交到将应用于本地副本的存储库。）上面有一个 RED [X。](https://stackoverflow.com/questions/3917925/what-do-the-arrow-icons-in-subclipse-mean)这意味着什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:18:07.680

红色 X 表示该文件已标记为删除。请注意，红色 x 有时会出现（有点令人困惑）在已简单重命名的文件或已被替换的文件上。但通常，当您同步和提交时，源代码控制系统（在我的情况下为 perforce）会正确处理所有内容。

# java - RSA 使用 SHA-256 散列算法和我自己的私钥

> ID：10836373
> 
> 赞同：0
> 
> 时间：2012-05-31T15:15:03.763
> 
> 标签：java, key

我正在尝试将 Google 的 OAuth 2.0 用于服务器到服务器应用程序，但遇到了障碍。

它指出：

“使用从 API 控制台获得的私钥，使用 SHA256withRSA（也称为带有 SHA-256 哈希函数的 RSASSA-PKCS1-V1_5-SIGN）对输入的 UTF-8 表示进行签名。输出将是一个字节数组。”

所以我大部分时间都在使用 Java 库，但是如何使用字符串作为私钥呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T16:08:44.727

我猜你需要一个固定大小的密钥。因此，您可以获得字符串，对字符串进行哈希处理，结果就是您的 RSA 密钥。也许这也有帮助：

```
bytes[] values = myString.getBytes();  //get byte[] from String 
```

# php - 将缓存页面检查集成到索引文件中

> ID：10836378
> 
> 赞同：0
> 
> 时间：2012-05-31T15:15:19.563
> 
> 标签：php, javascript

我正在尝试将主页设置为使用查询字符串重新加载，这样它就不会来自缓存文件。该页面是index.php，但我想在页面加载时附加一个唯一的字符串（就像Rocket对[我以前的问题](https://stackoverflow.com/q/10823672/1252748)的评论中的答案所暗示的那样）。

我想将它集成到验证登录的 php 中。

这样的事情是个好主意吗

```
<?php

require_once('login-config.php');

//use javascript cookie to detect if the page is coming from hash
//and if so, redirect to a new url with a ?<?=time()?> query sting

if ( !isset$($_COOKIE['login_cookie'] ) 
{

//render login-form page

} 
else 
{

//redirect to the content page

} 
```

[此页面](https://stackoverflow.com/a/4433812/1252748)的 javascript 缓存/cookie 检查（如下）

```
var uniqueKey = '<%= SomeUniqueValueGenerator() %>';
var currentCookie = getCookie(uniqueKey);
var isCached = currentCookie !== null;
setCookie(uniqueKey); //cookies should be set to expire 
                      //in some reasonable timeframe 
```

我想我应该做这样的事情，

```
//best guess is that I update this uniqueKey every time I update the page
//and want it not to load from cache
var uniqueKey = 'v1.1';
var currentCookie = getCookie(uniqueKey);
var isCached = currentCookie !== null;

if (!isCashed){      
    setCookie(uniqueKey);  
    window.location'?".time().";'
} else {
    window.location'?".time().";'
} 
```

但我有点不确定如何将它们组合在一起。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:27:32.510

这不一定会阻止浏览器缓存页面，最好不要发送缓存头......

```
header("Cache-Control: no-cache, must-revalidate"); // HTTP/1.1
header("Expires: Sat, 26 Jul 1997 05:00:00 GMT"); // Date in the past 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:37:48.713

我相信这个 PHP 代码会做你想做的事：

```
if ( !isset$($_COOKIE['login_cookie'] ) 
{
    //render login-form page
}
else 
{
    //redirect to the content page
    header("Location: index.php?t=" . time());
    exit();
} 
```

# c# - SocketAsyncEventArgs 缓冲区已满零

> ID：10836380
> 
> 赞同：6
> 
> 时间：2012-05-31T15:15:30.000
> 
> 标签：c#, .net, sockets, asyncsocket, io-completion-ports

我正在为我的分布式系统编写消息层。我正在使用 IOCP，即 Socket.XXXAsync 方法。

这与我正在做的事情非常接近（事实上，我的接收功能是基于他的）：http: [//vadmyst.blogspot.com/2008/05/sample-code-for-tcp-server-using.html](http://vadmyst.blogspot.com/2008/05/sample-code-for-tcp-server-using.html)

**我现在发现的是，在程序开始时（两个测试服务器相互通信）我每次都会得到一些 SAEA 对象，其中 .Buffer 完全用零填充，但 .BytesTransferred 的大小是缓冲区（在我的情况下为 1024）。**

这是什么意思？我需要检查什么特殊情况吗？我的系统将此解释为一条不完整的消息并继续前进，但我想知道我是否真的遗漏了一些数据。我的印象是，如果没有收到任何内容，您将不会收到回电。无论如何，我可以在 WireShark 中看到没有任何零长度数据包进入。

我在谷歌上找到了以下内容，但我不确定我的问题是否相同： [http ://social.msdn.microsoft.com/Forums/en-US/ncl/thread/40fe397c-b1da-428e -a355-ee5a6b0b4d2c](http://social.msdn.microsoft.com/Forums/en-US/ncl/thread/40fe397c-b1da-428e-a355-ee5a6b0b4d2c)

[http://go4answers.webhost4life.com/Example/socketasynceventargs-buffer-not-ready-121918.aspx](http://go4answers.webhost4life.com/Example/socketasynceventargs-buffer-not-ready-121918.aspx)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T05:31:33.787

我确定不是链接示例中发生了什么。它似乎以同步方式使用异步套接字。我在代码中看不到任何回调或类似内容。您可能需要重新考虑是否需要同步或异步套接字:)。

手头的问题源于您的函数在网络传输/接收完成之前尝试读取/写入缓冲区的可能性。尝试使用异步 Socket 中包含的回调功能。例如

```
// This goes into your accept function, to begin receiving the data
    socketName.BeginReceive(yourbuffer, 0, yourbuffer.Length,
        SocketFlags.None, new AsyncCallback(OnRecieveData), socketName);

// In your callback function you know that the socket has finished receiving data
// This callback will fire when the receive is complete.
private void OnRecieveData(IAsyncResult input) {
    Socket inSocket = (Socket)input.AsyncState; // This is just a typecast
    inSocket.EndReceive(input);

    // Pull the data out of the socket as you already have before.
    // state.Data.Write ......
} 
```

# android - 如何使 Android 文本视图看起来像已禁用？

> ID：10836381
> 
> 赞同：11
> 
> 时间：2012-05-31T15:15:31.833
> 
> 标签：android, styles

我希望能够为任何文本视图提供与禁用它相同的方面。目前我正在使用一种继承`TextAppearance`并添加灰色文本颜色的样式，但我更喜欢使用内置的东西，它可以完美地与任何主题一起工作。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-07-21T05:00:43.727

定义一个带有类似颜色的禁用选择器并在这样的布局中使用它

在颜色文件中（例如 res/color/example.xml）：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_enabled="false" android:color="@color/disabled_color" />
    <item android:color="@color/normal_color"/>
</selector> 
```

然后在您的布局中：

```
<TextView
    android:text="whatever text you want"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:textColor="@color/example" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:33:11.167

```
<TextView
        android:id="@+id/textView1"
        android:background="#666"
        android:textColor="#333"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:text="Medium Text"
        android:textAppearance="?android:attr/textAppearanceMedium" /> 
```

![在此处输入图像描述](../Images/ccaca7df03772d921af15e313bf1b851.png)

你可以设置**android:background="#666"**

和文本**android:textColor="#333"**看起来像禁用 textview。

或任何其他颜色组合

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T14:18:47.230

这可能是您正在寻找的：

[Android 选择器和文本颜色](https://stackoverflow.com/questions/1219312/android-selector-text-color)

基本上，您必须使用选择器作为颜色，然后定义应用该文本颜色的样式。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-05-31T15:26:38.623

试试这个

```
<TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:text="Large Text"
        android:enabled="false"    <--- Put this
        android:textAppearance="?android:attr/textAppearanceLarge" /> 
```

# android - 通知司机 eos 已到达

> ID：10836384
> 
> 赞同：0
> 
> 时间：2012-05-31T15:15:40.550
> 
> 标签：android, android-videoview, android-mediaplayer

为什么会出现这个错误？

我正在播放来自 url.1 的视频，后来说：视频无法播放。并且发生此错误。

```
 String urll=path;

vd = (VideoView) findViewById(R.id.videoView1);
    vd.setVideoPath(urll); 
```

![在此处输入图像描述](../Images/6fce45ae4042aa12d5ba38258b2d5e83.png)

```
 vd.requestFocus();
    vd.start(); 
```

# json - 如何为 HTTP JSON API 提供应用程序范围的授权以在浏览器中使用它？

> ID：10836385
> 
> 赞同：2
> 
> 时间：2012-05-31T15:15:42.707
> 
> 标签：json, web-services, api, rest, authorization

我目前正在为旅游 web 应用程序使用 HTTP JSON API。webapp 将由第三方公司开发，它将在浏览器中使用 API。

所以我需要对 API 进行某种身份验证，第三方 webapp 才能使用它。我一直在研究一点关于 OAuth 的信息，但是有了这个，我有一个针对用户范围但不是针对应用程序范围授权的解决方案。

因为 web 应用程序将在浏览器中使用 API（使用 Ajax），所以我担心他们必须将凭据放入用户浏览器中使用 API。

另一种解决方案是将 API 的凭据放在服务器端，但这不取决于我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:17:27.007

您总是可以使用类似于 google 的方法，使用客户端 ID，然后使用用于生成签名的私钥。

[https://developers.google.com/maps/documentation/business/webservices#generating_valid_signatures](https://developers.google.com/maps/documentation/business/webservices#generating_valid_signatures)

该页面也有一些代码示例。

# user-interface - 创建通用 UI 文件

> ID：10836388
> 
> 赞同：0
> 
> 时间：2012-05-31T15:16:04.943
> 
> 标签：user-interface, ios-universal-app, marmalade

是否有任何教程可用于创建可以在 iPad 和 iPhone 上以不同分辨率运行的通用 UI。我尝试查看官方文档，但找不到有关 UI 文件的任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T21:09:42.960

我注意到你已经用 Marmalade 标记了这个问题，所以我假设你在谈论如何在 Marmalade 中编写通用应用程序？如果是这样，那么创建通用 UI 几乎取决于您以您认为合适的最佳方式实现。

默认情况下，所有 Marmalade 应用程序都是通用应用程序，但您可以通过 MKB 设置 iphone-ipad-only 将其限制为仅 iPad。

Marmalade 确实带有 iwui 模块，它允许您使用按钮和文本框等来布置用户界面。但最终，除非您有一个非常简单的 UI，否则您需要为您希望的每个屏幕分辨率/方向提供不同的 UI 布局支持，或者在代码中做一些花哨的布局。

Apple 明智地选择说服开发人员为 iPhone 和 iPad 创建单独的 UI，因为“一刀切”的方法通常在任何屏幕尺寸下看起来都很糟糕。

# r - R ggplot2将颜色分配给一个因素

> ID：10836389
> 
> 赞同：3
> 
> 时间：2012-05-31T15:16:08.973
> 
> 标签：r, ggplot2

我正在尝试绘制一个散点图 x，y，由一个因子 z（五个值）着色，颜色值由我尝试过的调色板分配：

```
library(ggplot2)

Palette1 <- c('red','green','blue','violet','black')

p <- ggplot(df1, aes(x,y)) 

p + geom_point(aes(colour = factor(z)))
p + scale_colour_manual(values=Palette1 ) 
```

但我收到一条错误消息：

```
Error: No layers in plot 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-31T15:23:35.290

出现错误是因为您绘制了：

```
p + geom_point(aes(colour = factor(z))) 
```

然后尝试制作一个新的情节：

```
p + scale_colour_manual(values=Palette1) 
```

其中没有任何层。相反，我通常在绘图时完成所有任务：

```
ggpot(df1, aes(x, y, colour=factor(z))) + 
    geom_point() +
    scale_colour_manual(values=Palette1) 
```

或者您可以将您的第一个分配`p + geom_point(...)`给`p`：

```
p <- p + geom_point(...) 
```

然后照常进行。

# c++ - 指向继承类实例的指针作为函数参数

> ID：10836395
> 
> 赞同：2
> 
> 时间：2012-05-31T15:16:27.667
> 
> 标签：c++, function, inheritance, pointers

这就是问题所在——我有两个这样的类：

```
class A
{
  //some fields and methods 
   void niceMethod();
};

class B : public A
{
   void niceMethod();
};

class C : public A
{
   void niceMethod();
}; 
```

和功能

```
void myFunc(A** arrayOfABC); 
```

//双*是注意我要修改参数。

我想做：

```
(*arrayOfABC)[i].niceMethod(); 
```

在我的函数中，当我将 Bs 或 Cs 数组传递给函数时，会完成不同的事情。

但后来我试着这样称呼它

```
 B* bees = NULL;
    myFunc(&bees); 
```

我有“B** 的参数类型与 A** 类型的参数不兼容”。

我知道我可以将 B 或 C 作为 A 传递给 f(A) 之类的函数，但是指针有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:25:27.683

编译器是对的，确实不兼容。考虑一下：

```
B* bees = new B[2];
myFunc(&bees); // Imagine that it's allowed 
```

现在在`myFunc`你里面这样做：

```
void myFunc(A** arrayOfABC) {
    // This is OK:
    arrayOfABC[0] = new C();
} 
```

这应该是允许的，因为`C`extends `A`。`myFunc`但是，从您返回时`bees`将包含 a `C`，这是不好的。

要解决此问题，请创建一个 数组`A*`，并用指向 的指针填充它`B`。

PS不要忘记制作`niceMethod`虚拟，否则它不会按您期望的方式工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T15:43:56.373

You can convert `B*` to `A*`, but not `B**` to `A**`.

Suppose `A` is fruit and `B` is apple, then `A*` is a little arrow that can point to a fruit (any fruit) and `B*` is a little arrow that can point to an apple (and only an apple). You can take an apple arrow, relabel it as a fruit arrow, and give it to somebody that expects fruit arrows. It indeed points to a fruit because an apple is a kind of a fruit. So far so good, no surprises here.

Now `A**` is a little arrow that can point to a little arrow that can point to a fruit (any fruit), and `B**` is a little arrow that can point to a little arrow that can point to an apple (and only an apple). What will happen if you take the latter, and give it to somebody who expects the former? That person can go along the arrow that can point to an arrow that can point to a fruit (any fruit!), take that second arrow, and turn it around and make it point to a banana.

Now the unfortunate apple guy guy who used to have a double-apple-arrow goes along the first arrow, then goes along the second arrow that ought to point to an apple, and finds a banana there, a fruit he sees the first time in his miserable life. That's a pretty unfortunate situation if you ask me. We shouldn't be surprised if things go bananas from this point on!

# java - ArrayList 从 Java 类输出到 JSP 文件

> ID：10836397
> 
> 赞同：-1
> 
> 时间：2012-05-31T15:16:39.070
> 
> 标签：java, jsp, arraylist, javabeans

我有一个 JSP 文件向 Java 类输入一个字符串，并且应该从它返回一个 ArrayList。我是否需要一个公共类（即**void main(String[] args)**）才能返回调用 JSP，还是**public Sc​​opus()**足以返回值？

Scopus.java（接受 scopusID，返回 scopusList）

```
package newpackage1;
import org.w3c.dom.Document;
import org.w3c.dom.CharacterData;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;
import org.xml.sax.SAXException;
import java.util.ArrayList;
import java.net.URL;
import java.net.MalformedURLException;
import java.io.IOException;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;

public class Scopus {

    String scopusID;
    URL url;
    ArrayList<String> scopusList = new ArrayList<String>();
    NodeList nodes;
    DocumentBuilder builder;
    Document doc;

    public void setScopusList(ArrayList scopusList) {
        this.scopusList = scopusList;
    }

    public ArrayList getScopusList() {
        return scopusList;
    }

    public void setScopusID(String url) {
        this.scopusID = url;
    }

    public String getScopusID() {
        return scopusID;
    }

    public Scopus(String scopusID) {

        String fTitle, fLink;

        try {
            URL url = new URL( "http://syndic8.scopus.com/getMessage?registrationId=" + scopusID );
        } catch (MalformedURLException e) {
            throw new RuntimeException(e);
    }

        try {
            builder = DocumentBuilderFactory.newInstance().newDocumentBuilder();
            doc = builder.parse(url.openStream());
            nodes = doc.getElementsByTagName("item");
        } catch (ParserConfigurationException e) {
            throw new RuntimeException(e);
        } catch (IOException e) {
            throw new RuntimeException(e);
        } catch (SAXException e) {
            throw new RuntimeException(e);
        }

        //Only output if at least one is found
        int counter = 0;
        if ( nodes.getLength() > 0 ) {
            //Place all results into an array list first
            for(int i=0;i<nodes.getLength();i++) {
                Element element = (Element)nodes.item(i);
                fTitle = getElementValue(element, "title");
                fLink = getElementValue(element, "link");

                scopusList.add("<a href=\"" + fLink + "\" target=\"_blank\">" + fTitle + "</a>");

                counter++;
            }
         }

    }

    public static void main(String[] args) {

    }

    private String getElementValue(Element parent,String label) {
        return getCharacterDataFromElement((Element)parent.getElementsByTagName(label).item(0));
    }
    private String getCharacterDataFromElement(Element e) {
        try {
            Node child = e.getFirstChild();
            if(child instanceof CharacterData) {
                CharacterData cd = (CharacterData) child;
                return cd.getData();
            } //if
        } //try
        catch(Exception ex) {

        }
        return " ";
    } //private String getCharacterDataFromElement
} 
```

output.jsp（调用上面的类）

```
<%@page import="java.util.ArrayList,org.w3c.dom.Node,org.w3c.dom.NodeList" %>

<%
   String feedID = "HEDCIHLCIGDKPFHHJEEEHJDEIEGJIKJHKWFQWLHFJH";
%>

<jsp:useBean id="scopus" scope="page" class="newpackage1.Scopus">
    <jsp:setProperty name="scopus" property="scopusID" value="<%= feedID %>" />
</jsp:useBean>
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>JSP Page</title>
    </head>
    <body>
        <jsp:getProperty name="scopus" property="scopusList" />

        <%

        ArrayList sl = scopus.getScopusList();
//Will do output later
%>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:45:32.067

**您在 class 中指定的类不能是抽象的，并且必须具有**您没有的公共、无参数构造函数。

**更新：：**您**不需要**main() 方法，公共 Scopus() 非参数构造函数就可以了。JSP 容器将使用零参数构造函数使用反射创建此类的实例。如果您不创建任何构造函数，Java 编译器将向已编译的类添加一个。您只需使用参数重命名原始构造函数，使其成为执行所有这些业务逻辑事情的方法，并在设置 scopusID 属性之后和调用该`getScopusList()`方法之前（当您尝试访问 scopusList 属性时）在某处调用它。

至于列表数据的呈现方式，使用：

```
<jsp:getProperty name="scopus" property="scopusList" />

<%
    ArrayList sl = scopus.getScopusList();
//Will do output later
%> 
```

您最好使用 JSP EL 和 JSTL 核心 taglib 并执行以下操作：

```
<c:forEach items="${scopus.scopusList}" var="item">
    ${item}<br/>
</c:forEach> 
```

# python - 执行 SQL IN 函数

> ID：10836398
> 
> 赞同：0
> 
> 时间：2012-05-31T15:16:39.937
> 
> 标签：python, django

我有一个管理命令

```
from django.db import connection
from django.core.management.base import BaseCommand   

class Command(BaseCommand):
    args = "[id]"

    def handle(self, id, **options):
    ids = []
    if '-' in id:
        splitted = id.split('-')
        for n in range(int(splitted[0]), int(splitted[1])+1):
            ids.append(n)
    else:
        ids.append(id)
    c = connection.cursor()
    c.execute('SELECT content FROM log WHERE id IN %s', [ids]) 
```

我可以通过输入命令名称并指定参数（id）来运行它

当我运行`command 200-205`时，for循环返回一个列表：

```
ids =[200, 201, 202, 203, 204, 205] 
```

并将其放入查询中：

```
SELECT content FROM log WHERE id IN (200, 201, 202, 203, 204, 205) 
```

辉煌！

当我运行`command 200`ids 将是：

```
ids = [200] 
```

执行查询返回错误：

```
(1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '))' at line 1") 
```

似乎`SELECT content FROM log WHERE id IN (200)`它应该不工作。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T17:17:44.083

你的代码对我来说看起来不错，但我不熟悉那些 Django 库。几个（可能很明显）解决方法的想法：（1）构造两个不同的 SQL 语句来执行；在单 ID 的情况下，对于单 ID 的情况，`SELECT content FROM log WHERE id =`再次简单 (2)，使用所需 ID 的两个实例创建一个数组，以便 Django 构造此 SQL: `SELECT content FROM log WHERE id IN (200, 200)`。换句话说，

```
else:
    ids.append(id)
    ids.append(id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:21:11.043

你没有遗漏一些括号吗？

```
SELECT content FROM log WHERE id IN 200 
```

对比

```
SELECT content FROM log WHERE id IN (200) 
```

# c++ - 使用带有常量侵入列表的 BOOST_FOREACH

> ID：10836399
> 
> 赞同：2
> 
> 时间：2012-05-31T15:16:40.067
> 
> 标签：c++, boost, boost-foreach, intrusive-containers

考虑以下代码，使用 BOOST_FOREACH 宏迭代侵入性列表：

```
#include <boost/foreach.hpp>
#include <boost/intrusive/list.hpp>

typedef boost::intrusive::list<
    boost::intrusive::list_base_hook<> > MyList;

void iterate (const MyList& xs) {
    BOOST_FOREACH (MyList::const_reference node, xs);
}

int main () {
    MyList xs;
    iterate (xs);
    return 0;
} 
```

鉴于 boost 版本 1.48，代码在 clang 3.2 (SVN) 和 gcc 4.6.3 中失败，但适用于 gcc 4.5.3。`xs`对代码使用非 const 限定参数`iterate`。启用 C++11 后，所有编译器都接受该代码。使用 boost-1.46 时，两个 gcc 版本都接受代码，但 clang 仍然不接受。

手头的代码是对宏的滥用`BOOST_FOREACH`，还是提升方面的错误？是否有比使用常规 for 循环进行迭代更好的解决方法？

[编辑：我将错误消息粘贴到GCC](http://pastebin.com/Cn4uw4pB)和[clang](http://pastebin.com/vddBw0c8)的 pastebin （两者都非常冗长）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T16:34:58.093

以下是我可以从日志中收集到的信息以及我对失败原因的推断。

短版：由于某种原因`BOOST_FOREACH`，试图复制不可能的数据。

[可扩展性](http://www.boost.org/doc/libs/1_35_0/doc/html/foreach/extensibility.html)页面上有一条注释：

> **使用不可`BOOST_FOREACH`复制的序列类型**
> 
> 对于不可复制的序列类型，我们需要告诉`BOOST_FOREACH`不要尝试进行复制。如果我们的类型继承自`boost::noncopyable`，则不需要进一步的操作。如果没有，我们必须专门化`boost::foreach::is_noncopyable<>`模板 [...] 实现相同效果的另一种方法是覆盖全局`boost_foreach_is_noncopyable()`函数。这样做的好处是可以移植到旧的编译器。

从诊断来看，还不清楚类型是否配置正确，因此您可能想试一试。

* * *

修剪诊断和分析。

```
/usr/include/boost/foreach.hpp:571:37: error: no matching constructor for initialization of 'boost::intrusive::list< >'
        ::new(this->data.address()) T(t);
                                    ^ ~
/usr/include/boost/foreach.hpp:648:51: note: in instantiation of member function 'boost::foreach_detail_::simple_variant<boost::intrusive::list< > >::simple_variant' requested here
    return auto_any<simple_variant<T> >(*rvalue ? simple_variant<T>(t) : simple_variant<T>(&t));
                                                  ^

/usr/include/boost/intrusive/list.hpp:1490:35: note: candidate constructor not viable: 1st argument ('const boost::intrusive::list< >') would lose const qualifier
   BOOST_MOVABLE_BUT_NOT_COPYABLE(list)
                                  ^
/usr/include/boost/move/move.hpp:371:7: note: expanded from macro 'BOOST_MOVABLE_BUT_NOT_COPYABLE'
      TYPE(TYPE &);\

/usr/include/boost/intrusive/list.hpp:1497:4: note: candidate constructor not viable: no known conversion from 'const boost::intrusive::list< >' to 'const value_traits' (aka 'const boost::intrusive::detail::base_hook_traits<boost::intrusive::list_base_hook< >, boost::intrusive::list_node_traits<void *>, 1, boost::intrusive::default_tag, 1>') for 1st argument; 
   list(const value_traits &v_traits = value_traits())
   ^
/usr/include/boost/intrusive/list.hpp:1506:4: note: candidate constructor not viable: no known conversion from 'const boost::intrusive::list< >' to '::boost::rv<list< >> &' for 1st argument; 
   list(BOOST_RV_REF(list) x)
   ^
/usr/include/boost/intrusive/list.hpp:1502:4: note: candidate constructor template not viable: requires at least 2 arguments, but 1 was provided
   list(Iterator b, Iterator e, const value_traits &v_traits = value_traits())
   ^ 
```

我试图尽可能多地隔离错误（删除回溯等）。显然问题源于`boost::intrusive::list`，更准确地说，无法`boost::intrusive::list<>`从`boost::intrusive::list<> const`.

最有希望的构造函数由宏定义：

```
BOOST_MOVABLE_BUT_NOT_COPYABLE(list) 
```

扩展到

```
list(list&); 
```

这是 boost 模拟 C++03 中不可复制类型的移动语义的方式。但是它不能从一个`const`项目中移动，因为`const`限定符会丢失。

这看起来是用于`BOOST_FOREACH`避免对容器参数进行多次评估（如果它是函数调用）所使用的技巧的一部分，尽管我有点惊讶它试图在此处复制参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:35:30.987

由于您使用的是 gcc > 4.6 和 clang 3.2，因此您可以使用 C++11 的基于范围的循环：

```
#include <boost/foreach.hpp>
#include <boost/intrusive/list.hpp>

typedef boost::intrusive::list<
    boost::intrusive::list_base_hook<> > MyList;

void iterate (const MyList& xs) {
    for(const auto &node : xs) {
        // do something with node
    }
}

int main () {
    MyList xs;
    iterate (xs);
    return 0;
} 
```

你也可以使用`std::for_each`：

```
void iterate (const MyList& xs) {
    std::for_each(xs.begin(), xs.end(), 
      [](MyList::const_reference node) {
         // do something with node
      }
    );
} 
```

# mysql - 本地主机上的 Mangento 指向在线站点

> ID：10836400
> 
> 赞同：0
> 
> 时间：2012-05-31T15:16:43.433
> 
> 标签：mysql, magento

我有一个使用从网上商店复制的 sql 的新 magento 1.7。该商店使用 Mag 1.4，因此想法是将 DB 更新到 1.7。将 1.7 商店链接到本地​​主机上的数据库后，它没有错误，但是 127.0.0.1/shop 重定向到在线商店。

更改 base_url 没有帮助。

数据库仍然有对在线站点的引用，但我没有看到任何会产生影响的引用。

这似乎是一个没有任何解决方案的常见问题？ [http://www.magentocommerce.com/boards/viewthread/280257/#t387542](http://www.magentocommerce.com/boards/viewthread/280257/#t387542) http://www.magentocommerce.com/boards/viewthread/224658/#t313216

更新 -

[http://www.magentocommerce.com/boards/viewthread/280257/#t387542](http://www.magentocommerce.com/boards/viewthread/280257/#t387542)上的问题 已更新为由 Chiefair 提供的全面答案，如下面 Fiasco Labs 给出的答案 - 如果您需要更多信息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:38:18.163

请尝试以下步骤：

1.  清除浏览器的 cookie
2.  `core_config_data`在表中的行中查看 DB`web/unsecure/base_url`和`web/secure/base_url`
3.  手动清除`var/session`和`var/cache`文件夹

有关完整的教程，请参见[此处](http://www.magentocommerce.com/wiki/groups/227/moving_magento_to_another_server)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T16:08:02.800

更改了 Magento 数据库中的基本 URL 设置，它仍将使用旧的基本 URL。您在更改之前启动了一次 Magento，它缓存了旧配置，现在您被锁定在旧站点上。

对于 Linux，将您的 var/ 目录结构更改为 chmod -R 777。您在那里没有写入权限，并且 Magento 在 /tmp 中建立了缓存，因为它需要在某个地方写入缓存文件。它缓存了配置设置，并且在缓存位于正确的目录位置之前不会重新读取它们。如果 var/cache 中有子目录，请全部删除。您可能必须去寻找 /tmp/*/var/cache 并删除它们。

编辑：对于 Mac 和 Windows 也是如此，如果您更改了数据库并且可以看到 phpMyAdmin 中发生的更改，那么您已经手动清理了 var/cache 子目录，给 Apache 重新启动，并且系统仍在重定向，您早期，有一个错误配置，将 Magento 的缓存写入其他地方。这就是为什么它是持久的。通常，机器重新启动会在 Mac 和 Linux 上清除它，因为它们会在操作系统重新启动时对其临时文件夹进行管理。

以下是系统**/tmp** Magento 缓存存储在具有错误文件权限的 Linux 服务器上运行的屏幕截图。

**注意两张图片中的顶部地址栏...**

![注意图片中的顶部地址栏...](../Images/13ca9d07574ade3e722c47ee1c0967dd.png)

**这是给您带来困难的隐藏缓存。**

![这是给您带来困难的隐藏缓存。](../Images/2fb8daef1295d9201a3ea96853e6468e.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:48:39.007

通过删除 app/etc/local.xml 并将新安装指向该数据库，从同一个数据库重新安装。但我无法弄清楚为什么本地文件将站点发送到其他地方。也许在加密密钥中？

# jquery - 使用 JQuery 将 CSS 类 ( !important ) 应用于 TextBox

> ID：10836402
> 
> 赞同：0
> 
> 时间：2012-05-31T15:16:50.307
> 
> 标签：jquery

HTML看起来像

```
<td>
    <input type="text" onkeydown="" style="" value="" id="v65-onepage-billlastname" name="BillingLastName" maxlength="50" size="25" class="co-text">
</td> 
```

我的 CSS 类（请注意，我无法更改 .CSS 文件，因为它是从其他服务器远程调用的）

```
#v65-onepage-billfirstname, #v65-onepage-billlastname, #v65-onepage-billcompanyname, #v65-onepage-billaddr1, #v65-onepage-billaddr2, #v65-onepage-billcity, #v65-cart-billemail, #v65-onepage-shipfirstname, #v65-onepage-shiplastname, #v65-onepage-shipcompanyname, #v65-onepage-shipaddr1, #v65-onepage-shipaddr2, #v65-onepage-shipcity {
    width: 280px !important;
} 
```

使用 Jquery 覆盖 CSS 并将 v65-onepage-billlastname 的宽度更改为 150px 使用的方法是什么

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T15:18:40.910

不混用javascript和css，只定义两条CSS规则

```
#v65-onepage-billfirstname { width: 280px !important }
#v65-onepage-billfirstname.afterJSExecution { width: 150px !important } 
```

并像这样添加一个类

```
$('#v65-onepage-billfirstname').addClass('afterJSExecution'); 
```

小提琴示例：http: [//jsfiddle.net/JQtmt/](http://jsfiddle.net/JQtmt/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:21:02.910

jQuery 本身无法理解优先级。但是，您可以更改样式属性：

```
var id = '#v65-onepage-billlastname';
var curStyle = $(id).attr('style');
if (curStyle)
    $(id).attr('style', curStyle + 'width: 150px !important');
else
    $(id).attr('style', 'width: 150px !important'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:26:06.377

您可以通过在 HTML 中或通过 JQuery 向输入添加一个附加类来实现这一点，以便提供一种 CSS 样式，该样式将通过更具体的方式覆盖原始宽度。例如

```
<style type="text/css">

    /* existing style */
    #namedElement {
        width: 280px !important;
    }

    /* new style */
    #namedElement.co-text.namedElementOverride {
        width: 100px !important;
    }

</style> 
```

然后只需使用附加标记更新您的 HTML（原始示例中已经存在共同文本）

```
<input type="text" onkeydown="" style="" value="" id="namedElement" maxlength="50" size="25" class="co-text namedElementOverride" /> 
```

或者用 JQuery 分配新类；

```
 $('#namedElement.co-text')
        .addClass('namedElementOverride'); 
```

# asp.net - 在中继器中不使用 Eval 并提高性能的正确方法？

> ID：10836404
> 
> 赞同：1
> 
> 时间：2012-05-31T15:17:01.097
> 
> 标签：asp.net, vb.net, repeater, eval

我有一个转发器，它需要 270 秒才能呈现，实际上最终导致所有浏览器崩溃。检索数据的 SQL 大约需要 10 秒。我想删除 Eval，看看这是否会加快速度，但我在使用正确的语法时遇到了麻烦。我怀疑这实际上会提高性能，因为我正在处理 150,000 条记录。GridView 或其他控件会更快吗？使用 LINQ to SQL 会提高性能吗？这是评估的代码：

```
<%#Eval("Name")%> 
```

我在尝试：

```
<%# ((DataRowView)Container.DataItem)["Name"]%> 
```

但以上不起作用。它说 DataRowView 不能用作表达式

我还要指出，不涉及分页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T07:14:55.753

使用其中一个`Eval`或`Container.DataItem`不会有所作为，因为它们是同一件事。请看一下这个[SO](https://stackoverflow.com/questions/270230/evalstate-or-databinder-evalcontainer-dataitem-state)。

如果您的浏览器在显示数据时崩溃，那是因为在浏览器中呈现了太多生成的 html 或 javascript。请注意，这`Eval`是在服务器端执行的，因此它不是浏览器崩溃的根本原因。

我建议使用分页来提高性能并避免崩溃。如果你真的不能使用分页，让用户下载 csv 文件以在 excel 甚至 PDF 文件中打开怎么样？

至于使用 Linq to SQL 来提高性能，我假设您将它与存储过程或动态 sql 进行比较？存储过程将始终为您提供最佳性能，但是一旦您的动态 sql 或 linq 表达式（或编译的 linq）被缓存在 sql server 中，它们与 sproc 相比并没有那么慢。

# python - 为自定义格式实现解析树的pythonic方法是什么？

> ID：10836407
> 
> 赞同：2
> 
> 时间：2012-05-31T15:17:09.087
> 
> 标签：python, parsing, beautifulsoup

我有一个具有非标准文件格式的项目，例如：

```
var foo = 5
load 'filename.txt'
var bar = 6
list baz = [1, 2, 3, 4] 
```

我想把它解析成一个数据结构，就像 BeautifulSoup 所做的那样。但是 BeautifulSoup 不支持这种格式。构建解析树的pythonic方法是什么，以便我可以修改值并重新写出来？最后，我想做类似的事情：

```
data = parse_file('file.txt')
data.foo = data.foo * 2
data.write_file('file_new.txt') 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T18:33:41.970

这是一个使用 pyparsing 的解决方案......它适用于您的情况。请注意，我不是专家，因此根据您的标准，代码可能很难看...干杯

```
class ConfigFile (dict):
    """
    Configuration file data
    """

    def __init__ (self, filename):
        """
        Parses config file.
        """

        from pyparsing import Suppress, Word, alphas, alphanums, nums, \
            delimitedList, restOfLine, printables, ZeroOrMore, Group, \
            Combine

        equal = Suppress ("=")
        lbrack = Suppress ("[")
        rbrack = Suppress ("]")
        delim = Suppress ("'")

        string = Word (printables, excludeChars = "'")
        identifier = Word (alphas, alphanums + '_')

        integer = Word (nums).setParseAction (lambda t: int (t[0]))
        real = Combine( Word(nums) + '.' + Word(nums) ).setParseAction (lambda t: float(t[0]))
        value = real | integer

        var_kwd = Suppress ("var")        
        load_kwd = Suppress ("load")
        list_kwd = Suppress ("list")            

        var_stm = Group (var_kwd + identifier + equal + value +
                         restOfLine.suppress ()).setParseAction (
                             lambda tok: tok[0].insert(len(tok[0]), 0))

        load_stm = Group (load_kwd + delim + string + delim +
                          restOfLine.suppress ()).setParseAction (
                              lambda tok: tok[0].insert(len(tok[0]), 1))

        list_stm = Group (list_kwd + identifier + equal + lbrack +
                          Group ( delimitedList (value, ",") ) +
                          rbrack + restOfLine.suppress ()).setParseAction (
                              lambda tok: tok[0].insert(len(tok[0]), 2))

        cnf_file = ZeroOrMore (var_stm | load_stm | list_stm)

        lines = cnf_file.parseFile (filename)
        self._lines = []
        for line in lines:
            self._lines.append ((line[-1], line[0]))
            if line[-1] != 1: dict.__setitem__(self, line[0], line[1])            
        self.__initialized = True
        # after initialisation, setting attributes is the same as setting an item

    def __getattr__ (self, key):
        try:
            return dict.__getitem__ (self, key)
        except KeyError:
            return None

    def __setattr__ (self, key, value):
        """Maps attributes to values. Only if we are initialised"""

        # this test allows attributes to be set in the __init__ method
        if not self.__dict__.has_key ('_ConfigFile__initialized'):
            return dict.__setattr__(self, key, value)

        # any normal attributes are handled normally
        elif self.__dict__.has_key (key): 
            dict.__setattr__(self, key, value)

        # takes care of including new 'load' statements
        elif key == 'load':
            if not isinstance (value, str):
                raise ValueError, "Invalid data type"
            self._lines.append ((1, value))

        # this is called when setting new attributes after __init__
        else:
            if not isinstance (value, int) and \
                not isinstance (value, float) and \
                not isinstance (value, list):
                raise ValueError, "Invalid data type"

            if dict.has_key (self, key):
                if type(dict.__getitem__(self, key)) != type (value):
                    raise ValueError, "Cannot modify data type."
            elif not isinstance (value, list): self._lines.append ((0, key))
            else: self._lines.append ((2, key))            
            dict.__setitem__(self, key, value)

    def Write (self, filename):
        """
        Write config file.
        """
        fid = open (filename, 'w')
        for d in self._lines:
            if d[0] == 0: fid.write ("var %s = %s\n" % (d[1], str(dict.__getitem__(self, d[1]))))
            elif d[0] == 1: fid.write ("file '%s'\n" % (d[1]))
            else: fid.write ("list %s = %s\n" % (d[1], str(dict.__getitem__(self, d[1]))))

if __name__ == "__main__":

    input="""var foo = 5
load 'filename.txt'
var bar = 6
list baz = [1, 2, 3, 4]"""

    file ("test.txt", 'w').write (input)
    config = ConfigFile ("test.txt")
    # Modify existent items
    config.foo = config.foo * 2
    # Add new items
    config.foo2 = [4,5,6,7]
    config.foo3 = 12.3456
    config.load = 'filenameX.txt'
    config.load = 'filenameXX.txt'
    config.Write ("test_new.txt") 
```

# 编辑

我已经修改了要使用的类

```
__getitem__, __setitem__ 
```

根据我们的海报要求，模仿“访问成员”语法来解析项目的方法。享受！

# 附言

超载的

```
__setitem__ 
```

方法应该小心避免设置“正常”属性（类成员）和解析的项目（类似于属性的访问）之间的干扰。现在修复了代码以避免这些问题。有关详细信息，请参阅以下参考 [http://code.activestate.com/recipes/389916/](http://code.activestate.com/recipes/389916/)。发现这一点很有趣！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:52:44.200

您拥有的是需要解析的自定义语言。

使用 Python 的众多现有解析库之一。我个人推荐[PLY](http://www.dabeaz.com/ply/)。或者，[Pyparsing](http://pyparsing.wikispaces.com/)也很好并且被广泛使用和支持。

如果你的语言比较简单，你也可以实现一个手写的解析器。[这是一个例子](http://eli.thegreenplace.net/2009/03/20/a-recursive-descent-parser-with-an-infix-expression-evaluator/)

# javascript - Chrome 扩展不支持代码？

> ID：10836408
> 
> 赞同：0
> 
> 时间：2012-05-31T15:17:10.627
> 
> 标签：javascript, html, google-chrome-extension

在这里问了 2 个问题后，我终于完善了我的 Chrome 扩展程序。我将其用于个人使用，基于来自教程站点的示例，我的版本的目的是从用户那里获取查询输入，转到 Flickr 的 API 并通过搜索该查询返回 24 张图像。我打开这个页面，嗯，一个页面，它工作得很好。但是当我尝试将它作为扩展打开时，无论用户输入什么，查询词都不会改变。因此，我得出的结论是，chrome 扩展程序不支持某些代码，或者我做错了什么。如果前者是正确的，您能否指定我可以在扩展中使用和不能使用的内容（或将我链接到有答案的地方）？注意：是的，我知道服务器端语言不能完全工作。然而，如果，是我在做一些愚蠢的事情，请告诉我，如果可能的话，帮我解决这个问题。提前感谢您提供的任何帮助。代码如下：

JS（弹出.js）：

```
var q = "cake"; //Default search term
var req;
function querySubmit() {
oForm = document.forms["queryForm"];
oText = oForm.elements["query"];
q = oText.value
document.getElementById("images").innerHTML = "";
req.open(
"GET",
"http://api.flickr.com/services/rest/?" +
    "method=flickr.photos.search&" +
    "api_key=90485e931f687a9b9c2a66bf58a3861a&" +
    "text=" + q + "&" +
    "safe_search=1&" +  
    "content_type=1&" +  
    "sort=relevance&" +  
    "per_page=24",
true);
req.onload = showPhotos;
req.send(null);}

var req = new XMLHttpRequest();
req.open(
"GET",
"http://api.flickr.com/services/rest/?" +
    "method=flickr.photos.search&" +
    "api_key=90485e931f687a9b9c2a66bf58a3861a&" +
    "text=" + q + "&" +
    "safe_search=1&" +  
    "content_type=1&" +  
    "sort=relevance&" +  
    "per_page=24",
true);
req.onload = showPhotos;
req.send(null);

function showPhotos() {
  var photos = req.responseXML.getElementsByTagName("photo");

  for (var i = 0, photo; photo = photos[i]; i++) {
    var a = document.createElement("a");
    a.setAttribute("href",constructImageURL(photo));
    a.setAttribute("target","_blank");

    var img = document.createElement("img");
    img.setAttribute("src",constructImageURL(photo));

    a.appendChild(img);
    document.getElementById("images").appendChild(a);
  }
}

function constructImageURL(photo) {
  return "http://farm" + photo.getAttribute("farm") +
  ".static.flickr.com/" + photo.getAttribute("server") +
  "/" + photo.getAttribute("id") +
  "_" + photo.getAttribute("secret") +
  "_s.jpg";
} 
```

HTML (popup.html):

```
<!DOCTYPE html>
<html>
<head>
<title>Teh popup</title>
<style>
body {
    min-width:357px;
    overflow-x:hidden;
    }
img {
    margin:5px;
    border:2px solid black;
    vertical-align:middle;
    width:75px;
    height:75px;
    }
</style>
<!-- JavaScript and HTML must be in separate files for security. -->
<script src="popup.js"></script>
</head>
<body>
<div id="images">
</div>
<form name="queryForm" onsubmit="querySubmit();return false" action="#">
Search: <input type='text' name='query'>
<input type="submit" />
</form>
</body>
</html> 
```

清单.json：

```
{
  "name": "Flickr image searcher",
  "version": "1.0",
  "manifest_version": 2,
  "description": "Searches images on Flickr wirtout opening another page.",
  "browser_action": {
    "default_icon": "icon.png",
    "default_popup": "results.html"
  },
  "permissions": [
    "http://api.flickr.com/"
  ]
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:25:32.360

您`onsubmit`的 HTML 中的处理程序是内联 JavaScript，这在`manifest_version: 2`.

相反，`addEventListener`在您的 JS 文件中使用将`submit`事件处理函数绑定到您的表单：

```
theForm.addEventListener("submit", function() {
    //...
    return false; // stop submission
}); 
```

# c# - 除了在运行时之外，在其泛型类型未知的对象上调用方法？我应该只使用动态吗？

> ID：10836409
> 
> 赞同：0
> 
> 时间：2012-05-31T15:17:10.820
> 
> 标签：c#, generics, dynamic, generic-type-argument

说我有课

```
public abstract class A<T>
{
     public T GetT{get;}

     public ISomeInterface AMethod{get;}
} 
```

然后我在另一个类中有一些其他方法，我在其中获取一个对象，我想检查它的类型，`A<>` 然后如果它是获取类型`T`并调用方法`AMethod`。所以我这样做：

```
if (theObject.GetType().GetGenericTypeDefinition() == typeof (A<>))
{
    Type TType = theObject.GetType().GetGenericArguments()[0];            
    dynamic dynamicObject= theObject;
    ISomeInterface filter = dynamicObject.AMethod;
    //...some other stuff using TType
} 
```

有没有办法在不使用动态对象的情况下做到这一点，因为我不能在运行时使用`TType`或使用泛型类型定义来声明变量的类型`A<>`......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T15:22:08.013

如果可以的话，将所有非泛型的东西放在一个抽象的非泛型基类中：

```
public abstract class A
{
     public ISomeInterface AMethod{get;}
}

public abstract class A<T> : A
{
     public T GetT{get;}
} 
```

然后你可以使用：

```
A foo = theObject as A;
if (foo != null)
{
    ISomeInterface filter = foo.AMethod;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T16:30:25.000

正如 Skeet 先生所提到的，将不依赖于类类型的项目拉入非泛型类或接口通常是实际可行的方法。否则，我建议使用类型参数编写一个泛型方法，`T`该方法将返回一个泛型单例（通过反射生成），该方法可以将对象传递给具有参数类型的泛型方法，`U`例如`T:A<U>`. 这样的方法只需要对任何特定类型使用反射一次`T`，无论它用于处理该类型的实例多少次。

因为委托只能与封闭的泛型一起使用，所以可能必须定义一些泛型接口：

```
// 用户代码将为调度提供这些接口之一的实现
// 对象，它将以适当的类型调用其“Act”方法
接口 IActUponGenericA
{
  void Act<T>(A<T> 参数);
}
接口 IActUponGenericA<PT1>
{
  void Act<T>(A<T> 参数, PT1 extraParam1);
}
接口 IActUponGenericA<PT1,PT2>
{
  void Act<T>(A<T> 参数, PT1 extraParam1, PT2 extraParam2);
}
// 调度对象本身会实现这个接口：
接口 IWrapActUponGenericA<T>
{
  void CallAction(IActUponGenericA act, T param);
  void CallAction<PT1>(IActUponGenericA<PT1> act, T param, PT1 extraParam1);
  void CallAction<PT1,PT2>(IActUponGenericA<PT1,PT2> act, T param,
                             PT1 extraParam1, PT2 extraParam2);
}

```

然后给定一个参数类型`T`（`A<Q>`为 some实现`Q`），基于反射的方法代码将生成一个实现 interface 的单例`IWrapActUponGenericA<T>`。该实现可以采用 类型的对象`T`和 的实现`IActUponGenericA`，并调用该实现的`Act<Q>`方法。

这种方法将比使用更复杂`dynamic`，并且可能会或可能不会表现更好；但是，它将能够处理一些不能处理的情况`dynamic`。

# jquery - 使用 jQuery 检索表 id

> ID：10836416
> 
> 赞同：-2
> 
> 时间：2012-05-31T15:17:31.043
> 
> 标签：jquery

我有一些使用自动 id 生成的表，所以我之前不知道表 id 来做一些事情。

为了检索我的 id，我使用了这个 jQuery light 代码

```
 $('table').each(function(){
                alert(this.id);
            }); 
```

生成的html代码的想法：

```
<table id="table1">...</table><table id="table2">...</table> 
```

这个 jQuery 代码给了我所有的表 ID。
我的表格有一些按钮来添加行，所以如果我点击第二个表格的添加按钮，那只会为第二个表格添加行（代码向上给我网页上的所有表格 ID）

如何检索当前表 ID？（我曾尝试使用 prev() 但我认为我没有像我必须做的那样玩）

注意：我不需要代码来追加一行，我可以这样做；）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:18:18.987

您是否要求：

```
$('#button').on('click', function(){
    alert($(this).parents('table').attr('id'));
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:22:10.093

> 所以如果我点击第二张表的添加按钮，那只会为第二张表添加行

你应该做：

```
$('.btnClass').click(function(){
   var table_id = $(this).closest('table')[0].id;
}); 
```

# 更新

请注意，您`id`的表格也使用了无效的数值，请尝试使用字母或字母数字字符，例如`table_1`,`table_2`等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:29:07.633

你可以这样做：

```
$('table').each(function(){
   $(this).parent().find('#buttonId').click(function() {
      // Code to append a row
   });
}); 
```

顺便说一句，最好将有关 DOM 架构的详细信息提供给按钮和表格（`$(x).find(..)`这不是性能最快的方式）。

# sql - 更新表，但制作一个新的更新表？

> ID：10836417
> 
> 赞同：1
> 
> 时间：2012-05-31T15:17:41.213
> 
> 标签：sql

我正在比较两个表 A 和 B。A 和 B 是月份（我们将使用 JAN 和 FEB）。FEB 更新了属于 JAN 的数据。

我需要像这样更新数据

```
UPDATE A
SET A.x = B.x, A.y = B.y, A.z = B.z
FROM JAN A, FEB B
WHERE (A.x <> B.x OR A.y <> B.y OR A.z <> B.z) AND A.PK = B.PK 
```

现在我希望上述内容不会发生在原始 JAN 表上。我应该这样做吗？或者，还有更好的方法？

```
SELECT *
INTO JAN_UPDATED
FROM JAN

UPDATE A
SET A.x = B.x, A.y = B.y, A.z = B.z
FROM JAN_UPDATED A, FEB B
WHERE (A.x <> B.x OR A.y <> B.y OR A.z <> B.z) AND A.PK = B.PK 
```

编辑：我想要所有原始值+新表中的更新

编辑：添加PK

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T20:11:07.353

使用外连接，您可以将数据选择到新表中*并*在此过程中更新它们。就是这样：

```
SELECT    A.PK,
          COALESCE(B.x, A.x) AS x,
          COALESCE(B.y, A.y) AS x,
          COALESCE(B.z, A.z) AS x,
          *other columns as necessary*
INTO      JAN_UPDATED
FROM      JAN A
LEFT JOIN FEB B ON A.PK = B.PK AND (A.x <> B.x OR A.y <> B.y OR A.z <> B.z) 
```

连接的左侧部分，即`JAN`表，将返回所有`JAN`行，而连接的右侧部分`FEB`，将只返回匹配的行，即那些与 中的对应项不同的行`JAN`。当没有匹配时，右边部分的列将用`NULL`s 填充。现在，在拉取值时，该`COALESCE()`函数用于`x`, `y`, 和`z`：`FEB`首先尝试版本，如果是`NULL`（意味着这是一个不匹配的`JAN`行，在 中没有更新的行`FEB`），那么`JAN`当事方（未更改的行）值）来代替。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:19:28.357

如果您需要原始记录和更新的记录，那么您遵循的方法是正确的。

我们不能遵循任何其他方法，因为表上没有定义主键。

您的解决方案还具有模糊逻辑，因为它可以更新错误的记录。

# javascript - How to maintain page scroll position after a jquery event is carried out?

> ID：10836428
> 
> 赞同：41
> 
> 时间：2012-05-31T15:18:15.527
> 
> 标签：javascript, jquery, html

I have searched high and low for an answer and have found similar examples of the problem but the answers do not apply to my scenario. The reality is I am new to this and therefore I don't have the skills to adapt the answers I have found to my problem.

The problem:

I have a Div in which when a thumbnail is clicked the Div image replaces with another image via a JavaScript/jQuery script (I am not sure exactly maybe someone could clarify). This works fine however the problem is the page scrolls back to the top and the user then has to scroll back down to see the image after it has replaced itself.

I have looked online and have found that a return false: in the JavaScript may help however I have looked and return false is already present.

The other option I have looked at using is a JavaScript cookie based solution in which a cookie is sent, and the browser scroll position is maintain by reading the cookie however I cant seem to get that solution to work, I think the issue may be caused because I am hosting locally but I may be wrong...

The third is using a PHP script but I have not found a definitive answer on this method and it also means I am going to have to learn about PHP (something I'm sure I will have to learn in time anyway).

Here is the JavaScript:

```
<script type="text/javascript">

 $(document).ready(function() {
  $('.galleryicon').live("click", function() {

    $('#mainImage').hide();
    $('#cakebox').css('background-image', "url('ajax-loader.gif')");
    var i = $('<img />').attr('src',this.href).load(function() {
        $('#mainImage').attr('src', i.attr('src'));
        $('#cakebox').css('background-image', 'none');
        $('#mainImage').fadeIn();
    });
    return false; 
   });
 });

</script> 
```

Here is the html:

```
<div class="cakecont">

  <div id="cakebox">

 <img src="../images/cakes/babycake1.png" alt="Main Image" id="mainImage"/>

     <div class="pageinfo2">
     <h3>Cake Type 1</h3>
     <h6>£2.00</h6>
     </div>
     <div class="infobox">
     <h6> Description </h6>
     </div> 

      <div class="gallerybox">
      <a href="../images/cakes/babycaketop.png" class="galleryicon">
      <img src="../images/thumbs/babycaketopsml.png" alt="Thumbnail 2"/></a>

      <a href="../images/cakes/babycake1.png" class="galleryicon">
      <img src="../images/thumbs/babycakesml.png" alt="Image 1"/></a>
   </div>
  </div>
</div> 
```

And here is a link to the working demo [http://micahcarrick.com/code/jquery-image-swap/index.html](http://micahcarrick.com/code/jquery-image-swap/index.html)

I have tried to resolve this on my own. This is the first question I have had to ask so far regarding the building of my website, all my learning and remedies to past problems have been served by Google, this one has eluded my search engine skills.

Below I have added all the html for the page in case there may be other script overriding the "new" modified JavaScript -

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org     /TR/xhtml1/DTD/xhtml1-transitional.dtd">
 <html xmlns="http://www.w3.org/1999/xhtml"><head>
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Cupcakes &amp; Cakes for Birthday/Wedding Gift in Bournemouth Dorset - SweetVision</title>
   <meta name="keywords" content="cupcakes, cake, gift, wedding, birthday, Bournemouth, Dorset" />
 <meta name="description" content="For the finest Cupcakes and Cakes in Bournemouth Dorset look no further, Sweetvision specialise in baked goods for Weddings, Birthdays, Baby Showers, Easter, Halloween, Christmas" />
 <meta name="robots" content="ALL" />
 <meta http-equiv= "Content-Language" content="en" />
 <meta name="Publisher" content="Sweet Vision" />
 <meta name="Copyright" content="Copyright 2012, Sweet Vision, All rights reserved." />
 <meta name="Author" content="Mark Webb for Sweet Vision - www.sweetvision.co.uk" />

  <link href="../images/homepage/favicon.ico" type="image/vnd.microsoft.icon" rel="shortcut icon" />

  <link href="../root/css/sweetvision.css" rel="stylesheet" type="text/css" />

  <script src="../js/jquery-1.4.2.min.js" type="text/javascript"></script>

  <script type="text/javascript">

 $(document).ready(function() {   
$('.galleryicon').live("click", function(e) {  // the (e) represent the event
$('#mainImage').hide();     
$('#cakebox').css('background-image', "url('ajax-loader.gif')");     
var i = $('<img />').attr('src',this.href).load(function() {         
  $('#mainImage').attr('src', i.attr('src'));         
  $('#cakebox').css('background-image', 'none');         
  $('#mainImage').fadeIn();     
 });
 e.preventDefault(); //Prevent default click action which is causing the 
 return false;       //page to scroll back to the top
 });  
});

</script>

<script src="../js/s3Slider.js" type="text/javascript"></script> 

 <script type="text/javascript">

 $(document).ready(function() {
 $('#s3slider').s3Slider({
  timeOut: 4000
  });
}); 
  </script>

  <script src="../js/SpryMenuBar.js" type="text/javascript"></script>
  <link href="../root/css/SpryMenuBarHorizontal.css" rel="stylesheet" type="text/css" />

  </head> 

 <body>

  <div class="container">

 <div class="sprybox">
   <ul id="check_menu" class="MenuBarHorizontal">
    <li><a href="../root/index.html">Home</a></li>
    <li><a href="../root/aboutus.html" class="MenuBarItemSubmenu">About Us</a>
      <ul>
        <li><a href="../root/contactus.html">Contact</a></li>
        <li><a href="../root/news.html">News</a></li>
        <li><a href="../root/events.html">Events</a></li>
      </ul>
    </li>
       <li><a href="../root/ourmenu.html">Our Menu</a></li>
         <li><a href="gallery.html">Gallery</a></li>
          </ul>
        <div class="mainmenu">
           <a href="../root/mainmenu.html">
           <img src="../images/buttons/mainmenu.png" />
           </a>
       </div>
        <div class="backbutton">
        <a href="javascript:history.go(-1)"> 
        <img src="../images/buttons/Backbutton.png" /></a>
      </div>

    </div>  <!-- end.header --><!--end of sprybox -->

  <!--end div element -->

 <!-- thumbnails are links to the full size image -->

  <div class="cakecont">

 <div id="cakebox">

  <img src="../images/cakes/babycake1.png" alt="Main Image" id="mainImage"/>

     <div class="pageinfo2">
     <h3>Cake Type 1</h3>
     <h6>£2.00</h6>
     </div>
     <div class="infobox">
     <h6> Description </h6>
     </div> 

 <div class="gallerybox">
      <a href="../images/cakes/babycaketop.png" class="galleryicon">
      <img src="../images/thumbs/babycaketopsml.png" alt="Thumbnail 2"/></a>

      <a href="../images/cakes/babycake1.png" class="galleryicon">
      <img src="../images/thumbs/babycakesml.png" alt="Image 1"/></a>
  </div>
  </div>
</div>

 <div class="footer">
  <p>Copyright &copy; 2012 by Mark Webb. All rights reserved.</p>
 </div> <!-- end .footer -->

</div> <!-- end .container -->

 <script type="text/javascript">
 var MenuBar1 = new Spry.Widget.MenuBar("check_menu",{imgDown:"SpryAssets/SpryMenuBarDownHover.gif",   imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
  </script>

 <script type="text/javascript">

  var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-29457683-1']);
  _gaq.push(['_trackPageview']);

   (function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') +    '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

 </script>

 </body>
</html> 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-05-31T15:35:40.840

You can save the current scroll amount and then set it later:

```
var tempScrollTop = $(window).scrollTop();

..//Your code

$(window).scrollTop(tempScrollTop); 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-09-01T06:07:50.680

For all who came here from google and are using an anchor element for firing the event, please make sure to void the click likewise:

```
<a  
href='javascript:void(0)'  
onclick='javascript:whatever causing the page to scroll to the top'  
></a> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-31T15:29:54.370

Try the code below to prevent the default behaviour scrolling back to the top of the page

```
$(document).ready(function() {   
  $('.galleryicon').live("click", function(e) {  // the (e) represent the event
    $('#mainImage').hide();     
    $('#cakebox').css('background-image', "url('ajax-loader.gif')");     
    var i = $('<img />').attr('src',this.href).load(function() {         
      $('#mainImage').attr('src', i.attr('src'));         
      $('#cakebox').css('background-image', 'none');         
      $('#mainImage').fadeIn();     
    });
  e.preventDefault(); //Prevent default click action which is causing the 
  return false;       //page to scroll back to the top
  });  
}); 
```

For more information on event.preventDefault() have a look [here](http://api.jquery.com/event.preventDefault/) at the official documentation.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-31T15:29:28.083

What you want to do is prevent the default action of the click event. To do this, you will need to modify your script like this:

```
$(document).ready(function() {
  $('.galleryicon').live("click", function(e) {

    $('#mainImage').hide();
    $('#cakebox').css('background-image', "url('ajax-loader.gif')");
    var i = $('<img />').attr('src',this.href).load(function() {
        $('#mainImage').attr('src', i.attr('src'));
        $('#cakebox').css('background-image', 'none');
        $('#mainImage').fadeIn();
    });
    return false; 
    e.preventDefault();
   });
 }); 
```

So, you're adding an "e" that represents the event in the line `$('.galleryicon').live("click", function(e) {` and you're adding the line `e.preventDefault();`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-12T19:51:05.743

I had a similar problem getting scrollTop to work after reload of div content. The content scrolled to top each time the procedure below was run. I found that a little delay before setting the new scrolltop solved the issue.

This is cut from wdCalendar where I modified this procedure:

```
 function BuildDaysAndWeekView(startday, l, events, config)
   ....
        var scrollpos = $("#dvtec").scrollTop();
        gridcontainer.html(html.join(""));
        setTimeout(function() {
            $("#dvtec").scrollTop(scrollpos);
        }, 25);
   .... 
```

Without the delay, it simply did not work.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-26T16:55:40.530

Something to note, when setting the scroll position, make sure you do it in the correct scope. For example, if you're using the scroll position in multiple functions, you would want to set it outside of these functions.

```
$(document).ready(function() {
    var tempScrollTop = $(window).scrollTop();
    function example() {
        console.log(tempScrollTop);
    };

}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-11-08T09:23:05.650

```
$('html,body').animate({
  scrollTop: $('#answer-<%= @answer.id %>').offset().top - 50
}, 700); 
```

# c# - 不同窗口中两个文本框之间的数据绑定

> ID：10836431
> 
> 赞同：3
> 
> 时间：2012-05-31T15:18:28.500
> 
> 标签：c#, wpf, xaml

我创建了一个程序，在选中或取消选中复选框时更改 TextBox 中的名称。我想在不同的窗口中复制这个文本框。我认为在 xaml 中使用数据挖掘是可能的，但名称只出现在一个窗口中。第二个窗口窗口不接收数据。我给你看两个窗口的代码。你能帮助我吗？谢谢

窗口 1.cs---

```
namespace WpfApplication1
{

public partial class Window1 : Window
{
    Texto prueba = new Texto("Carlos");

    public static string s;
    public Window1()
    {
       InitializeComponent( );
      // Fill initial person fields
       this.textBox1.Text = prueba.Name;          

    }

    private void checkBox1_Checked(object sender, RoutedEventArgs e)
    {

        prueba.Name="Carlos";
        textBox1.DataContext = prueba;
        textBox1.Text = prueba.Name;
    }

    private void checkBox1_UnChecked(object sender, RoutedEventArgs e)
    {
        prueba.Name = "Luis";
        textBox1.DataContext = prueba;
        textBox1.Text = prueba.Name;
    }
}

 public class Texto
{
    string name;
    public string Name
    {
        get { return this.name; }
        set { this.name = value; }
    }

     public Texto( ) {}
     public Texto(string name) 
     {
       this.name = name;
     }

}

} 
```

window1 xaml------

```
 <Grid>
    <CheckBox Content="CheckBox" Height="16" HorizontalAlignment="Left" Margin="62,118,0,0" Name="checkBox1" VerticalAlignment="Top" Checked="checkBox1_Checked" Unchecked="checkBox1_UnChecked" />
    <TextBox Height="23" HorizontalAlignment="Left" Margin="44,140,0,0" Name="textBox1" VerticalAlignment="Top" Width="120" />
</Grid> 
```

窗口2 cs-----

```
 namespace WpfApplication1
 {

   public partial class MainWindow : Window
  {
    public MainWindow()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        Window1 nueva = new Window1();
        nueva.Show();
    }
 }

} 
```

window2 xaml--------

```
<Grid>
    <Button Content="Button" Height="23" HorizontalAlignment="Left" Margin="82,121,0,0" Name="button1"  VerticalAlignment="Top" Width="75" Click="button1_Click" />
    <TextBox DataContext="prueba" Text="{Binding Path=Name}" Height="23" HorizontalAlignment="Left" Margin="57,84,0,0" Name="textBox2" VerticalAlignment="Top" Width="120" />
  </Grid> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T15:35:13.413

您必须将对第一个窗口或您正在更新文本属性的对象的引用传递到第二个窗口，它的 DataContext 属性将为此执行，然后您可以将第二个窗口控件绑定到它。

在这个演示应用程序中，我创建了一个主窗口和第二个窗口 (Window1)，应用程序在主窗口中启动，如下所示。

**主窗口.xaml.cs**

```
public partial class MainWindow : Window
{
    public string TestString
    {
        get { return (string)GetValue(TestStringProperty); }
        set { SetValue(TestStringProperty, value); }
    }

    public static readonly DependencyProperty TestStringProperty =  DependencyProperty.Register("TestString", typeof(string), typeof(MainWindow), new UIPropertyMetadata(null));

    public MainWindow()
    {
        InitializeComponent();

        // setup the test string.
        TestString = "this is a test.";

        // Create the second window and pass this window as it's data context.
        Window1 newWindow = new Window1()
        {
            DataContext = this
        };
        newWindow.Show();
    }
} 
```

**MainWindow.xaml** - 记下 Window 声明中的 DataContext 行。

```
<Window x:Class="WpfApplication5.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525"
        DataContext="{Binding RelativeSource={RelativeSource Self}}"
        >
    <Grid>
        <TextBox Text="{Binding TestString, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="91,84,185,189" />
    </Grid>
</Window> 
```

现在对于 Window1，后面的代码只是一个空的默认窗口类，所以我不会发布它，但 xaml 是。

**Window1.xaml**

```
<Window x:Class="WpfApplication5.Window1"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Window1" Height="300" Width="300">
    <Grid>
        <TextBlock Text="{Binding TestString, UpdateSourceTrigger=PropertyChanged}"/>
    </Grid>
</Window> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:36:09.483

不要显式设置 DataContext，或者仅通过另一个绑定。您的

```
<TextBox DataContext="prueba" 
```

没有任何帮助。只要不被覆盖，DataContext 就会被继承。不要明确设置它。在两个窗口上设置一次就足够了。

在 MainWindow 中创建数据对象

```
Texto prueba = new Texto("Carlos");
Window1 nueva = new Window1();
nueva.DataContext = prueba;
nueva.Show(); 
```

并删除所有其他 DataContext 分配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:35:00.623

这里有一些问题，但我可能会给你一个快速的解决方案来解决你的问题。首先，窗口 2 上的 DataContext 无法正常工作，您可以在显示 window1 之前在代码中专门设置它...

```
private void button1_Click(object sender, RoutedEventArgs e)
{
    Window1 nueva = new Window1();
    this.DataContext = nueva.prueba;
    nueva.Show();
} 
```

接下来，您必须在 Texto 类中触发 INotifyPropertyChanged ...

```
public class Texto : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;
    string name;
    public string Name
    {
        get { return this.name; }
        set 
        { 
            this.name = value; 
            if (PropertyChanged != null)
                PropertyChanged(this, new PropertyChangedEventArgs("Name"));
        }
    }

     public Texto( ) {}
     public Texto(string name) 
     {
        this.name = name;
     }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T15:35:20.650

如果两个文本框共享一个共同的数据上下文，它将“正常工作”而无需任何代码......

# android - 为什么无法识别我的 res 文件中的颜色？

> ID：10836432
> 
> 赞同：1
> 
> 时间：2012-05-31T15:18:36.150
> 
> 标签：android, colors

我的代码中出现此错误：

错误：没有找到与给定名称匹配的资源（在“背景”，值为@color/red'）。

这是我的文本视图：

```
<TextView 
    android:id="@+id/tv01"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="@string/prizeFund"
    android:background="@color/red">
</TextView> 
```

以及颜色定义，在 res/values 中的 colors.xml 中：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
<color name="red">#ff0000</color>
<color name="green">#00ff00</color>
<color name="blue">#0000ff</color>
</resources> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:28:42.783

尝试清理您的项目该`R.java`文件将为您重新生成

在 Eclipse 上转到 Project---->Clean..

资源也必须在 strings.xml 而不是 colors.xml

下面是 strings.xml 文件的示例

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
       <!-- Strings Resources -->
    <string name="animations">Animations: </string>
    <string name="compass">Compass: </string>

     <!-- Colors Resources -->
    <color name="opaque_white">#FFFFFFFF</color>
    <color name="gray">#FF888888</color>
</resources> 
```

# android - 如何限制应用程序安装在 SD 卡上？

> ID：10836438
> 
> 赞同：0
> 
> 时间：2012-05-31T15:18:56.067
> 
> 标签：android

我正在开发一个应用程序，我想强制用户将此应用程序安装在内部存储中。应用程序无法安装在 SD 卡上

任何建议和想法将不胜感激
谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:23:19.510

你没有阅读文档

> 但是，如果您确定您的应用程序永远不应该安装在外部存储上，那么您应该通过声明 android:installLocation 的值为“internalOnly”来明确这一点

来自[http://developer.android.com/guide/appendix/install-location.html](http://developer.android.com/guide/appendix/install-location.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:23:33.673

检查[http://developer.android.com/guide/topics/manifest/manifest-element.html](http://developer.android.com/guide/topics/manifest/manifest-element.html)`android:installLocation` _

编辑：因为从标题中的问题我认为你想强制用户安装在 SD 卡上

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-09T10:07:08.667

在您的 Mainfest 文件中为 SD 卡执行此操作

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.emx.jamalert"
    android:installLocation="preferExternal"> 
```

对于内部存储器

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.emx.jamalert"
    android:installLocation="Internal"> 
```

# .net - .NET 授权。命令或允许和拒绝元素是否重要？

> ID：10836444
> 
> 赞同：7
> 
> 时间：2012-05-31T15:19:24.817
> 
> 标签：.net, authorization, asp.net-authorization

`<allow>`我很好奇你在元素中提供and`<deny>`元素的顺序是否重要？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-31T15:37:47.380

是的，顺序很重要。本页介绍了基本原则：http: [//msdn.microsoft.com/en-us/library/wce3kxhd.aspx](http://msdn.microsoft.com/en-us/library/wce3kxhd.aspx)。根据页面，授权规则列表是从配置文件的层次结构中建立的，然后第一个匹配项获胜。

这个 SO 问题有一个很好的例子：[ASP.NET Forms Auth Allowing access to specific file in subdirectory when all others should be denied](https://stackoverflow.com/questions/3938891/asp-net-forms-auth-allowing-access-to-specific-file-in-subdirectory-when-all-oth)

# c# - 如何在 SQL Server 中编写 C# 日期时间差异的逻辑？

> ID：10836446
> 
> 赞同：1
> 
> 时间：2012-05-31T15:19:27.400
> 
> 标签：c#, .net, sql-server, sql-server-2008

我的 C# 代码中有这个逻辑，它给了我两次之间的时间差

**示例输入是：** '12:00 AM' - '11:15 AM' 给出 45 分钟。

```
DateTime startTime = Convert.ToDateTime(startTimeHH + ":" + startTimeMM + " " + startTimeAMPM);
DateTime endTime = Convert.ToDateTime(endTimeHH + ":" + endTimeMM + " " + endTimeAMPM);
DateTime breakTime = Convert.ToDateTime(breakTimeHH + ":" + breakTimeMM);

TimeSpan hours = endTime.Subtract(startTime);
hours = hours.Subtract(breakTime.TimeOfDay); 
```

我在 SQL Server 中引用了一些 MSDN 文档日期时间函数，但找不到这些函数可以让我从输入中获得时间`12:00 PM`

但是现在我需要把这块移到 SQL Server 中。我该怎么写？

**示例输入是：** '12:00 AM' - '11:15 AM'**不会**返回 45 它将**返回**75（它包含 15 作为 25）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T17:02:05.637

这是获得看起来像 .NET TimeSpan 的一种方法：

```
declare @startTimeHH char(2) = '10',
        @startTimeMM char(2) = '30',
        @startTimeAMPM char(2) = 'AM',
        @endTimeHH char(2) = '12',
        @endTimeMM char(2) = '00',
        @endTimeAMPM char(2) = 'PM',
        @breakTimeHH char(2) = '01',
        @breakTimeMM char(2) = '15',
        @startTime DateTime, 
        @endTime DateTime, 
        @breakTime DateTime, 
        @result Time

set @startTime = cast ((@startTimeHH + ':' + @startTimeMM + ' ' + @startTimeAMPM) as Time);
set @endTime = cast ((@endTimeHH + ':' + @endTimeMM + ' ' + @endTimeAMPM) as Time);
set @breakTime = cast ((@breakTimeHH + ':' + @breakTimeMM) as Time);

set @result = @endTime - @startTime - @breakTime
select cast(@result as CHAR(8)) 
```

结果是`00:15:00`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T16:27:12.417

```
CREATE TABLE [dbo].#events (            
    [StartTime] time NULL,            
    [EndTime] time NULL )            

INSERT INTO #events            
VALUES            
('08:00', '08:30'),            
('08:30', '08:00'),            
('09:00', '10:00'),            
('15:00', '16:30')  

select  convert(time, dateadd(minute, datediff(minute, StartTime, EndTime), 0))  
From #events

drop table #events 
```

## 结果集

> 00:30:00.0000000
> 23:30:00.0000000
> 01:00:00.0000000
> 01:30:00.0000000

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:20:51.760

使用[**DateDiff**](http://msdn.microsoft.com/en-us/library/ms189794.aspx)函数

[**DatePart**](http://msdn.microsoft.com/en-us/library/ms174420)也会很方便

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T16:31:50.960

这是一些返回“45”（分钟）的 SQL

```
DECLARE @Start DATETIME, @END DATETIME
SET @Start = '2009-05-02 10:00:50'
set @End = '2009-05-02 10:45:50'

    -- FYI
SELECT @start, @end

    -- returns 45
SELECT DateDiff(mi, @start, @end) 
```

# php - php序列化Mysql中的数据

> ID：10836450
> 
> 赞同：7
> 
> 时间：2012-05-31T15:19:40.153
> 
> 标签：php, mysql, arrays, serialization

我用“”将数据保存在我的数据库（mysql）中`serialize($array);`。此数据来自带有输入字段的表单。我想知道如果我`a:4:{i:1;s:7:"fdsfdsf";i`在表单字段中插入类似“”的内容会发生什么。会破坏我存储在数据库中的数据吗？谢谢！！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-31T15:30:50.390

我在我的系统上测试了您的示例，序列化后，返回以下值：

```
string(42) "a:1:{i:0;s:24:"a:4:{i:1;s:7:"fdsfdsf";i";}" 
```

这就是将添加到数据库中的内容。但是，非常不鼓励在数据库中存储用户输入。您应该首先格式化普通用户输入，`mysql_real_escape_string()`因为它会转义关键字符。

除此之外，如果*`unserialize()`*在从数据库读回的序列化文本上调用，则正确返回数组。它应该是安全的，但会产生意想不到的结果。

**在数据库中存储序列化数组时**要格外小心。**序列化返回一个字符串，所以你存储数据的字段通常是`VARCHAR`​​or `TEXT`。如果你只是用一个新的数组*覆盖*存储的数组，旧的数据将完全丢失。要*更新*数据库，请确保首先将数据库中的数据读入数组，然后更新它，然后再将其写回数据库。**

 **虽然不被禁止，但使用和存储在数据库中序列化的东西通常会产生很多问题。数据库有很多默认已知的数据类型，大的序列化数组会产生开销并使执行复杂化，如果以后需要修改系统，这简直就是一个麻烦。而且您不能对序列化字段使用关系查询。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-31T15:34:17.853

**老办法**

当您仍在使用时`mysql_`，您可以编写如下查询：

```
$sql = sprintf("INSERT INTO mytable (a) VALUES ('%s')",
    mysql_real_escape_string(serialize($myvar))
);
mysql_query($sql) or die("oh no!"); 
```

**推荐的方式**

[`PDO`](http://php.net/pdo)并且您[`mysqli`](http://php.net/mysqli)可以选择使用准备好的语句，强烈建议您这样做，以防止 SQL 注入攻击向量。PDO 中的一个例子：

```
$stmt = $db->prepare('INSERT INTO mytable (a) VALUES (:myvar)');
$stmt->execute(array(
    ':myvar' => serialize($myvar),
)); 
```

**字段长度**

另外，确保序列化数据的长度不超过表字段的列大小；截断的序列化变量几乎没有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T15:22:17.603

阻止这种情况的一种方法是在将数据插入数据库之前转义引号。

[你可以用http://www.php.net/manual/en/mysqli.real-escape-string.php](http://www.php.net/manual/en/mysqli.real-escape-string.php)做到这一点`mysqli_real_escape_string()`**

# ruby-on-rails - 在 Rails 模型中设置“published_on”日期字段

> ID：10836451
> 
> 赞同：2
> 
> 时间：2012-05-31T15:19:40.913
> 
> 标签：ruby-on-rails, ruby

这是我在 Rails 上玩 Ruby 的第二天，所以请保持温柔 :)

我有一个非常（希望）简单的问题：我想在我的模型上设置一个发布日期，当它确实被创建时。我正在使用 Mongoid，它看起来像这样：

```
class Page
  include Mongoid::Document

  field :content, type: String
  field :title, type: String
  field :published_on, type: DateTime
end 
```

这是一个问题：我应该在调用之前`published_on`从操作中设置字段吗？还是有更好、更惯用的方法？ `create``@page.save`

如果我这样做，也就是说，`@page.published_on = Date.now`从控制器的操作中调用，我会收到警告：

> 找不到“页面”类型的“published_on=”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:25:32.993

如果你把

```
class Page
  include Mongoid::Document
  include Mongoid::Timestamps 
```

你得到了rails自动魔法场`created_at`和`updated_at`

# sql - 使用 except 命令后如何查找不同的列值

> ID：10836452
> 
> 赞同：0
> 
> 时间：2012-05-31T15:19:42.093
> 
> 标签：sql, sql-server, sql-server-2005

我有两张桌子。使用“except”命令我可以找到两个表之间的不匹配值。

前任：

```
(select * from test_table3) except (select * from test_table1) 
```

现在我需要找出哪一列值的差异？我怎样才能找到那个专栏？我正在使用 SQL 2005。

# ruby-on-rails - 如何安全地使用 Web 应用程序的密钥实现访问？

> ID：10836458
> 
> 赞同：1
> 
> 时间：2012-05-31T15:20:08.743
> 
> 标签：ruby-on-rails, security

我正在开发一个 Rails 应用程序，用户无需注册即可添加帖子。我想生成一个随机的唯一密钥并提供一个链接来编辑他们的帖子，例如： http: [//mygreatapp.com/post/edit/f7smSDf34Sad](http://mygreatapp.com/post/edit/f7smSDf34Sad)。Craigslist 使用了类似的方法。

我的想法是在帖子创建时生成一个随机的、唯一的字符串，并将其与其他帖子数据一起保存在数据库中。然后检查数据库中的字符串是否与请求中的字符串匹配。解决方案安全吗？

你将如何实施它？

编辑：感谢您的回复。但是，生成随机字符串不是问题。数据库中的安全性和实施是我关心的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:29:43.110

如果我要实现这个，我会使用[friendly_id](https://github.com/norman/friendly_id) gem，因为你基本上在做的是为你的数据库中的每条记录创建一个独特的slug。friendly_id 默认使用列来创建 slug。您可以告诉friendly_id 使用该`id`列，然后覆盖他们的`normalize_friendly_id`方法。

在该方法中，您将生成一个唯一的字符串，然后将其返回。此方法返回的文本是friendly_id 将用于生成您的 slug 的文本。

要生成 slug，您可以简单地使用 MD5 哈希，或者您可以执行[以下](https://stackoverflow.com/questions/88311/how-best-to-generate-a-random-string-in-ruby)操作：

```
(0...50).map{ ('a'..'z').to_a[rand(26)] }.join 
```

使用这种方法而不是简单地自己创建/存储 slug 的好处是您不必这样做`Post::find_by_slug(slug)`，您仍然可以使用`Post::find(slug)`，因为 friendly_id 处理通过 slug 查找记录。

有一[集 Railscasts](http://railscasts.com/episodes/314-pretty-urls-with-friendlyid)涵盖了friendly_id gem

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:34:21.170

我在我的应用程序中使用了类似的东西（to_param 由您的控制器/视图调用以生成路由）

```
class Post < AR::Base
  def to_param
    Digest::SHA1.hexdigest("--#{self.if}--#{self.created_at}--")
  end
end 
```

唯一的问题是 SHA1 生成长字符串。您可以使用 MD5 代替...

# xcode - 如何在 Xcode 4 和 Cordova 中使用符号链接

> ID：10836460
> 
> 赞同：2
> 
> 时间：2012-05-31T15:20:11.927
> 
> 标签：xcode, cordova

我无法让 Xcode 将 www 资源复制到基于 PhoneGap 的 iPhone 应用程序中。我考虑过使用 Git 子模块，但由于应用程序必须在不同的平台（iPhone、Android 等）上运行，并且必须以不同的方式命名（图像、css 和对某些文件的小改动），它并不能解决完整的问题。

我以一个解决方案结束，在该解决方案中，我创建了一个外部核心 www 文件夹，并为来自不同项目的每个文件创建了符号链接。如果某个文件需要在平台上或品牌要求上得到特别关注，那么我可以简单地将符号链接的该实例替换为实际文件。

这一切都会像魅力一样工作，但由于某种原因，Xcode 不会将符号链接资源复制到手机上。有谁知道如何使这项工作？或者一个可靠的选择。即使这需要我一天的时间来解决。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T15:28:10.423

[该解决方案](https://stackoverflow.com/q/540661/828757)非常适合在构建时引入符号链接。使用这种方法，您可以为所有平台构建 Phonegap 解决方案，并以绝对最少的代码重复使它们具有不同的品牌。

简而言之，创建一个包含所有 phonegap www 内容的通用目录，然后将其从不同的项目（平台差异或品牌差异）中符号链接。要在 Xcode 上构建，请将以下内容添加到项目的运行脚本中：

```
rsync -pvtrlL --cvs-exclude \
    $PROJECT_DIR/../Resources* \
    $BUILT_PRODUCTS_DIR/$CONTENTS_FOLDER_PATH 
```

注意：如果您为 BlackBerry 构建，您还需要取消引用符号链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T01:34:30.070

我只想说不需要使用符号链接。您可以简单地将文件夹拖放到 xcode 中，并且不要复制文件。

就我而言，我的共享文件夹被称为“移动”，所以我必须创建这个运行脚本：

```
mv $BUILT_PRODUCTS_DIR/$CONTENTS_FOLDER_PATH/mobile $BUILT_PRODUCTS_DIR/$CONTENTS_FOLDER_PATH/www 
```

这只是重命名目录，以便 Cordova 可以找到它正在寻找的内容。

# xml - 如何将 RSS 提要生成的 XML 文件转换为 Atom 格式的文件？

> ID：10836462
> 
> 赞同：2
> 
> 时间：2012-05-31T15:20:17.383
> 
> 标签：xml, rss, file-conversion, atom-feed

我有一个 XML 文件（显然），它是 RSS 提要的输出。我想将该文件转换为 Atom 格式。

[StackOverflow 上有很多关于转换*提要*](https://stackoverflow.com/search?q=rss+atom+xml+convert)的问答，但我想转换一个*文件*。

我预计这将涉及 XSLT，但这超出了我的范围，而且这样的转换器可能已经存在。谁能指出我正确的方向？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T16:13:30.290

从 2003 年开始，再看一个 XSLT 文件似乎可以解决问题。

原件位于[iBLOGthere4iM](http://www.ibt4im.com/?guid=20031218172501)或方便保存的[要点](https://gist.github.com/2844457)，如果有人感兴趣的话。

# objective-c - 何时使用 NSNotificationCenter

> ID：10836463
> 
> 赞同：13
> 
> 时间：2012-05-31T15:20:28.483
> 
> 标签：objective-c, ios, architecture, observer-pattern, nsnotificationcenter

我希望对单个对象的多个事件（一对 N 关系）有多个观察者。

实现此任务的机制由[`NSNotificationCenter`](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/nsnotificationcenter_Class/Reference/Reference.html). 当用于我的问题时，该机制看起来有点矫枉过正。

我将如何在不使用的情况下手动完成`NSNotificationCenter`：

```
- (void)addDelegate:(id<DelegateProtocol>)delegate;
- (void)removeDelegate:(id<DelegateProtocol>)delegate; 
```

从我的对象中添加和删除观察者。

```
- (void)someEventFired:(NSObject<NSCopying> *)eventData
{
    for (id delegate in delegates) {
        NSObject *data = [eventData copy];
        [delegate someEventFired:data];
    }
} 
```

这种机制直接且易于实现，无需对象共享额外的字符串。

*   除了`NSNotificationCenter`?
*   什么时候应该`NSNotificationCenter`使用，什么时候不应该使用？
*   什么时候应该使用像我在这里建议的那样的实现，什么时候不应该使用？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-31T15:28:20.203

按照惯例，委托可能应该只用于 1:1 的关系。如果您确实需要此类功能的 1:N 关系，您有两种选择：

1.  正如你所提到的，[`NSNotificationCenter`](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/nsnotificationcenter_Class/Reference/Reference.html).
2.  [键值观察](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html)（也称为 KVO）。

如果您只关心对象的特定属性何时更改，则 KVO 是合适的。否则，你真的应该考虑使用`NSNotificationCenter`. 您甚至可以通过将该对象传递给方法，仅在特定对象发布该通知时才收到通知`addObserver:selector:name:object:`。

Apple`NSNotification`在类似的场景中使用（例如为 定义的通知`UITextField`，包括`UITextFieldTextDidBeginEditingNotification`、`UITextFieldTextDidChangeNotification`和`UITextFieldTextDidEndEditingNotification`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T15:32:21.417

使用通知就是广播：1 个发送者只是发送一个信息，而谁曾经收听过，就会收到它。很像一个广播电台，没有频道回来（让我们暂时忘记电话）

代表团是不同的东西。要求委托人做某事的对象通常需要该请求的结果，因此委托是一对一的通信，始终由对象而不是委托发起（而对象可以具有可以调用来通知对象发起通信，即`[tableView reloadData]`）。

因此，如果发送方需要取回数据，那就是委托。如果发件人在广播后不关心任何事情，请使用通知。

如果您遇到这种情况，您需要委托，但有几个对象应该实现该协议。你应该有 1 个委托，它持有对其他对象的引用并代表发送者调用方法——或者你可以使用块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T15:27:10.270

NSNotificationCenter 对于您的建议并不过分，它完全是正确的解决方案。它可以防止被观察对象必须知道或关心它的观察者，从而使您的代码更加松散耦合和清洁。

通知名称的共享字符串是微不足道的，如果您的观察者需要导入此标头来完成他们的工作，它们可以在共享常量文件或被观察对象的标头中定义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T15:46:08.947

您提出的解决方案既不比使用 NSNotificationCenter 简单，也不是线程安全的。

为了使您的解决方案线程安全，您需要提供一种机制来防止在事件调度 for 循环运行时委托数组发生变化。

您的解决方案还要求您维护班级中的代表数组。使用 NotificationCenter，您可以简单地使用默认中心，而无需在您的类中实现添加/删除方法。相反，实例可以注册自己以接收它们认为最合适的通知（选择器/块、队列、源）。您的源类不必担心这些细节。它只需要将自己注册为指定类型的通知源。使用块来处理通知真的很方便。

通知中心的替代方法是使用 Key-Value-Observing（如果满足您的用例需求）。

最终，您决定使用的机制取决于它如何最好地应用于您的特定用例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-31T15:30:01.573

1 对 N 的委托关系没有意义。看一下

```
- (NSView *)tableView:(NSTableView *)tableView viewForTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row 
```

例如。如果这个对象真的有 n 个委托怎么办？它应该如何决定应该使用从所有代表那里获得的 n 个视图中的哪一个？代表正是这种一对一的原则。

NSNotificationCenter 是正确的方法。只需使用

```
addObserver:selector:name:object: 
```

分别

```
postNotification: 
```

这绝对不是太多的代码。由于中心处理所有呼叫，这对您来说非常容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-24T08:20:36.470

您不想将 NSNotificationCenter 用于系统范围事件以外的任何事情（例如键盘的外观或一些类似事件）。原因是它完全不是类型安全的，可以使所有内容都依赖于所有内容，并且您不再获得编译时检查或使用搜索结果。

在我看来，KVO 不应该用于观察您正在收听的对象之外的变化，因为它有类似的缺点（没有编译时间检查，如果您没有正确删除侦听器或注册两次，则会崩溃）。

在我看来，您提出的 addDelegate/removeDelegate 模式完全是正确的路径，因为它具有维护类型安全和编译器检查并使依赖关系明确的优势。唯一的问题是 Apple 没有为这种模式提供开箱即用的解决方案，因为您需要一个弱保留其元素的集合类型以避免保留循环。

但是，请参阅我的[BMCommons 框架中的代码，它使用](https://github.com/werner77/BMCommons)[BMNullableArray](https://github.com/werner77/BMCommons/blob/master/BMCommons/Modules/BMCore/Sources/Classes/BMNullableArray.h)和宏巧妙地解决了这个问题。有关这些宏的定义，请参见[BMCore.h标头：](https://github.com/werner77/BMCommons/blob/master/BMCommons/Modules/BMCore/Sources/Classes/BMCore.h "BMCore.h")

```
BM_LISTENER_METHOD_DECLARATION(protocol)
BM_LISTENER_METHOD_IMPLEMENTATION(protocol) 
```

该实现确保同一个侦听器永远不会被添加两次，并且侦听器被弱保留，即使他们忘记在释放时注销自己也不会导致任何崩溃（尽管我更喜欢用断言来捕获这个条件，因为这是一个编程错误）。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2012-05-31T15:27:03.177

我说 NSNotificationCenter 应该始终在委托模型上使用，除非在您查询委托的信息（例如`-webView:shouldLoadRequest:`）的情况下。与尝试使用委托相比，它更稳定，更易于实现，并且代码更简洁。另一种选择是块，这可能很好，但在内存管理方面可能会很痛苦。

最后，这取决于你，但我认为 NSNotificationCenter 是几乎在任何情况下的最佳方式，即使只是用于多个观察者功能。

# asterisk - Asterisk AMI - 接听电话

> ID：10836466
> 
> 赞同：4
> 
> 时间：2012-05-31T15:20:33.950
> 
> 标签：asterisk, pbx, asteriskami, trixbox

我想使用 AMI 在 Asterisk 中代答电话。我可以发起呼叫，但完全不知道如何接听电话......呼叫脚本：

```
#login
sock = socket.socket(af, socktype, proto)
sock.connect(sockaddr)
sock.send('Action: login\r\n')
sock.send('Events: off\r\n')
sock.send('Username: '+str(ast_server.login)+'\r\n')
sock.send('Secret: '+str(ast_server.password)+'\r\n\r\n')

#originate call
sock.send('Action: originate\r\n')
sock.send('Channel: ' + str(user.asterisk_chan_type) + '/' + str(user.internal_number)+'\r\n')
sock.send('Timeout: '+str(ast_server.wait_time*1000)+'\r\n')
sock.send('CallerId: '+str(user.callerid)+'\r\n')
sock.send('Exten: '+str(ast_number)+'\r\n')
sock.send('Context: '+str(ast_server.context)+'\r\n')
if ast_server.alert_info and user.asterisk_chan_type == 'SIP':
    sock.send('Variable: SIPAddHeader=Alert-Info: '+str(ast_server.alert_info)+'\r\n')
sock.send('Priority: '+str(ast_server.extension_priority)+'\r\n\r\n')

#logout
sock.send('Action: Logoff\r\n\r\n')
time.sleep(1)
sock.close() 
```

我需要类似的东西，但用于接听电话。在 *CLI> manager show 命令中找不到任何有用的命令

抱住我，普洛克斯

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-31T17:22:24.120

您无法通过 AMI 直接接听电话。这是因为新呼叫将“到达”在拨号方案中配置的给定上下文/优先级/分机（或者如果找不到适用的呼叫将被拒绝）。因此，无论该调用发生什么，都将从拨号计划中给定的上下文/优先级/扩展开始。

如果您想通过 AMI 处理调用，请尝试使用异步 AGI，如下所示：

```
exten => _X.,1,AGI(agi:async) 
```

这将通过发出您可以使用 AMI 客户端处理的事件 (AsyncAGI) 来处理对任何至少有 1 位数字的分机的所有调用。

然后，从您的 AMI 客户端，您可以发送 AGIAction，例如：

```
Action: AGI
Channel: SIP/adevice
Command: ANSWER
CommandID: MyCommandID 
```

这将有效地允许您从 AMI 客户端运行 AGI 命令（并像通常在任何 AGI 脚本中那样处理调用）。

希望能帮助到你！

# php - 我有一个联系表格，在适合移动设备的 css 样式上它不会让我输入数据

> ID：10836470
> 
> 赞同：2
> 
> 时间：2012-05-31T15:20:50.260
> 
> 标签：php, html, css, forms

所以我可以在桌面尺寸上填写表格，但是当我必须在移动尺寸（640、480 和 320）上填写表格时，我就不行了。我通过尝试发现了一些东西，只是碰巧我的光标在我的`contactform`div 外面，里面有表格。然后它让我输入除消息框以外的所有内容，除非我使用制表符并且仍在 div 之外。我觉得奇怪？

[benlevywebdesign.com](http://benlevywebdesign.com/) 页面底部是用于测试 640、480 和 320 的移动布局的表单。

这是联系表格

```
<form id="form1" action="<?php echo $_SERVER['PHP_SELF']; ?>" method="POST">    

        <fieldset>
            <p class="form">
                <label for="name">Name</label>
                <input type="text" name="name" id="name" size="30" />
            </p>
            <p class="form">
                <label for="email">Email</label>
                <input type="text" name="email" id="email" size="30" />
            </p>
            <p class="form">
                <label for="web">Website</label>
                <input type="text" name="web" id="web" size="30" />
            </p>            
        </fieldset>
        <fieldset>                                                                          
            <p class="form">
                <label for="message">Message</label>
                <textarea name="message" id="message" cols="30" rows="10"></textarea>
            </p>                                
        </fieldset>                 

        <p class="submit"><button name="submit" type="submit">Send</button></p>

    </form> 
```

这是我的 480 和 320 的 CSS 样式

```
@media screen and (max-width:480px){

@media screen and (max-width:320px){

#form1{
    padding-top:5px;
    }

#form1 fieldset{
    margin:0;
    padding:0;
    border:none;    
    float:left;
    display:inline;
    width:190px;
    margin-left:15px;
    }

#form1 legend{display:none;}    
#form1 p{margin:.5em 0;}    
#form1 label{display:block;}    
#form1 input, #form1 textarea{      
    width:175px;
    border:1px solid #B7B7B7;
    background:#fff;
    padding:3px;
    background: -webkit-gradient(linear, left top, left 25, from(#FFFFFF), color-stop(4%, #EEEEEE), to(#FFFFFF));
background: -moz-linear-gradient(top, #FFFFFF, #EEEEEE 1px, #FFFFFF 25px);
    }   

#form1 textarea{
    height:120px;
    width:175px;
    overflow:auto;
    }   

#form1 p.submit{
    clear:both;
    padding:0 25px 5px 25px;
    margin:0;
    text-align:right;
    }   

#form1 button{
    font-family:Trebuchet MS;
    font-size:14px;
    width:105px;
    height:35px;        
    border:none;
    background-color:#484749;
    color:#fff;
    border-radius:4px;
    cursor:pointer;
    text-align:center;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:26:41.993

您是否尝试过调整浏览器的大小并在 PC 上查看您的网站（我使用的是 FF），它会变得很麻烦。Firebug 还说您有 15 个错误和 10 个警告 - 在返回移动设备之前可能值得先尝试修复这些问题。

这是有关问题的简短视频：http: [//screencast-o-matic.com/watch/clhwo4GGI](http://screencast-o-matic.com/watch/clhwo4GGI)

# php - PHP 文件上传无法正常工作

> ID：10836474
> 
> 赞同：0
> 
> 时间：2012-05-31T15:21:12.180
> 
> 标签：php, mysql, file, upload

我正在尝试更新数据库中的记录。该代码旨在允许用户更新网站上的条目，同时还可以选择编辑图像。当我最初测试这段代码时，它没有任何问题。当他们选择图像时，它会更新图像，当他们没有选择图像时，它不会在更新中包含图像。当我将此代码移动到它需要的页面时，它不再工作。它总是在读取它，就好像用户没有选择要上传的图像一样。测试代码和这段代码之间唯一不同的是数据库中的名称，以及为变量 $title 和 $description 添加了 mysql_real_escape_string()。

这是对我不起作用的 PHP 代码：

```
<?php
require_once ("connect.php");
if (isset($_POST['description'])) {
    $id = $_GET['id'];
    $title = $_POST['title'];
    $description = $_POST['description'];
    $title = mysql_real_escape_string($title);
    $description = mysql_real_escape_string($description);
    $target = "../images/contests/";
    $target = $target.basename( $_FILES['image']['name']);
    $ok=1;

    if($_FILES['image']['name'] == "") {
        $query = "UPDATE tbl_contests SET contests_title='$title', contests_description='$description' WHERE contests_id='$id'";
        $result = mysql_query ($query);
            if ($result) {
            header ("Location: contests.php?=noimage");
            exit ();
        } else {
            header ("Location: contests.php?=error");
            exit ();
        }
    } else {
        if ($ok==0){
            header("Location: contests.php?=error");
        } else {
            if(move_uploaded_file($_FILES['image']['tmp_name'], $target)){
                echo "<p>Your upload was sucessful.</p>";
                $query = "UPDATE tbl_contests SET contests_title='$title', contests_description='$description', contests_image='$target' WHERE contests_id='$id'";
                $result = mysql_query ($query);
                if ($result) {
                    header ("Location: contests.php?=image");
                    exit ();
                } else {
                    header ("Location: contests.php?=error");
                    exit ();
                }
            }
        }
    } 
}
?> 
```

这是与上述代码有关的表格：

```
<?php
    $postnum = $_GET['id'];
    $query = "SELECT * FROM tbl_contests WHERE contests_id=".$postnum;
    $result= mysql_query($query);
    $row = mysql_fetch_array($result);
    $path = "../images/contests/";
    ?>

    <form action="update-past.php?id=<?php print $row[contests_id]; ?>" method="post" id="updatepast">
    <br /><label>Title:</label> <p><input type="text" name="title" id="title" class="input" value="<?php print $row[contests_title]; ?>" /></p>
    <?php if ($row['contests_image'] == !null) { ?>
    <p><img src="<?php print $path.$row['contests_image']; ?>" width="425" height="500" /></p>
    <br /><label>Edit Image: (Optional)</label> <p><input name="image" type="file" id="image" class="file" size="50" /></p>
    <?php } else { ?>
    <br /><br /><br /><br /><label>Add Image: (Optional)</label> <p><input name="image" type="file" id="image" class="file" size="50" /></p>
    <?php } ?>
    <br /><br /><br /><br /><br /><label>Description:</label><p><textarea name="description" cols="85" id="description" class="contentinput" rows="10"><?php print $row[contests_description]; ?></textarea></p>
    <p><input type="submit" name="submit" id="button" value="Edit" /></p>
    </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:23:22.733

尝试将此添加到表单中：`enctype="multipart/form-data"`

这里有一些关于表单内容类型的阅读：http: [//www.w3.org/TR/html4/interact/forms.html#h-17.13.4.2](http://www.w3.org/TR/html4/interact/forms.html#h-17.13.4.2)

# php - MYSQL 连接查询语法

> ID：10836490
> 
> 赞同：0
> 
> 时间：2012-05-31T15:22:14.733
> 
> 标签：php, mysql, join, syntax

我正在尝试加入三个表。第一个是组表，第二个是加入者，第三个是用户。逻辑是我从组的 id 开始，然后通过 groupid 加入加入者的组。最后，因为我想要名称和 id，所以我通过在 userid 上加入用户来从用户表中提取它们。但可惜没有工作。MYSQL 抛出一个错误，说“'groups'g 附近的错误通常意味着在那之前。我错过了什么？

组 ID | 名称 |用户名

加入者ID | 组ID | 用户身份

用户ID | 名

```
$sql = "SELECT g.*,j.userid,u.firstname,u.id
FROM 'groups' g
LEFT JOIN 'joiners' j
ON g.id = j.groupid
LEFT JOIN 'users' u
ON j.userid = u.id
WHERE g.id = 22"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:24:47.677

应使用反引号转义诸如表和列之类的模棱两可的术语：

```
$sql = "SELECT g.*,j.userid,u.firstname,u.id
FROM `groups` g
LEFT JOIN `joiners` j ON g.id = j.groupid
LEFT JOIN `users` u ON j.userid = u.id
WHERE g.id = 22 
```

这是假设您的查询的其余部分是正确的，因为我没有看到您的字符串的结尾;-)

# java - 如何在不伤害现有用户的情况下在生产中部署战争文件

> ID：10836495
> 
> 赞同：2
> 
> 时间：2012-05-31T15:22:42.583
> 
> 标签：java, apache, iis, jboss, tomcat7

我正在生成一个战争文件，并想用生产中的当前战争文件替换。在 Apache 或任何其他标准服务器中执行此操作的标准是什么？人们如何在网站上查看当前登录用户，选择一个好的时间来替换，是否可以在不关闭服务器的情况下做到这一点？IIS 足够智能，可以将当前用户保留在旧文件上，并将新登录的用户重定向到新的生产代码。我们可以在 JBoss 或 Apache 中做一些类似的事情吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:29:33.763

JBOSS 有一个 hotdeploy 目录，可以让你快速部署一个新版本的 WAR。在底层，它将旧的 WAR 以及旧的元数据保存在 permgen 空间中，因此当前正在执行的请求不会被此操作中断。唯一的问题是，这会增加您需要的 Permgen 数量，并且在某些条件下会随着时间的推移而增长，直到出现 permgen 空间不足错误。

# spring - 使用 JTA TransactionManager 未找到当前线程的会话

> ID：10836498
> 
> 赞同：1
> 
> 时间：2012-05-31T15:22:49.643
> 
> 标签：spring, hibernate, websphere, jta, spring-transactions

在使用 JTA 事务管理器时，我在迁移到休眠 4 时遇到了一些麻烦。
也许你可以帮忙，因为我完全没有想法。

**软件：**

Spring：*3.1.1.RELEASE*
Hibernate：*4.1.3.Final*
数据库：*Oracle 11g*
应用程序：部署在*Websphere Application Server 7.0中的 Ejb* *3.0*（用于初始化 spring 上下文）*`@Interceptors(SpringBeanAutowiringInterceptor.class)`*

 ***弹簧配置：**

```
<context:annotation-config />
<context:component-scan base-package="myServicePackage,myDaoPackage" />

<jee:jndi-lookup id="dataSource" jndi-name="java:comp/env/jdbc/MyDataSource" />

<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="packagesToScan" value="myModelPackage" />
    <property name="mappingResources" value="queries.xml" />
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">org.hibernate.dialect.Oracle10gDialect</prop>
        </props>
    </property>
</bean>

<tx:jta-transaction-manager />
<!-- <bean id="transactionManager" class="org.springframework.transaction.jta.WebSphereUowTransactionManager" /> -->
<tx:annotation-driven /> 
```

**服务：**

```
@Service
public class TradeService {
    @Autowired
    private TradeDao tradeDao;
} 
```

**道：**

```
@Repository
@Transactional
public class TradeDao {
    @Autowired
    private SessionFactory sessionFactory;

    public Trade getTrade(){
        return (Trade) sessionFactory.getCurrentSession().getNamedQuery("get_trade").uniqueResult();
    } 
```

**抛出：**

```
org.hibernate.HibernateException: No Session found for current thread
at org.springframework.orm.hibernate4.SpringSessionContext.currentSession(SpringSessionContext.java:97)
at org.hibernate.internal.SessionFactoryImpl.getCurrentSession(SessionFactoryImpl.java:1041)
at myDaoPackage.TradeDao.getTrade(TradeDao.java:26) 
```

***笔记：***

1.  我也尝试过使用`@Transactional`服务而不是 dao。结果相同。
2.  类似的配置，但使用*Spring 3.0.5.RELEASE*、*Hibernate 3.6.5.Final*和 TradeDao 扩展`HibernateDaoSupport`工作。

那么，有人有什么想法吗？
我今天一整天都在尝试很多事情。
我的头在旋转，我很生气，所以我一定错过了一些非常简单的东西，但在这一点上我真的不能说:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T17:30:20.110

我终于得到了这个工作。

正如我所期望的那样，我只是缺少一些小配置:)

```
<property name="hibernateProperties">
    <props>
        <prop key="hibernate.dialect">org.hibernate.dialect.Oracle10gDialect</prop>
        <prop key="hibernate.transaction.factory_class">org.hibernate.transaction.CMTTransactionFactory</prop>
        <prop key="hibernate.transaction.manager_lookup_class">org.hibernate.transaction.WebSphereExtendedJTATransactionLookup</prop>
    </props>
</property> 
```

我之前在浏览时发现了这些配置选项，但由于某种原因，当我尝试它们时它们不起作用。可能当时我还有什么问题……（见[交易策略配置](http://www.ibm.com/developerworks/websphere/techjournal/0609_alcott/0609_alcott.html)章节）

感谢大家的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T16:43:25.400

这可能很像这个人遇到的问题：http: [//forum.springsource.org/showthread.php?121109-Transaction-Propagations-and-Hibernate-4](http://forum.springsource.org/showthread.php?121109-Transaction-Propagations-and-Hibernate-4)

也就是说，如果在线程上找不到会话，HibernateDaoSupport（可能还有 HibernateTemplate）正在创建一个会话，而听起来新方法却没有。

编辑：我刚刚意识到包含的链接正在使用 HibernateTransactionManager。我相信，如果您使用 JtaTransactionManager 并且*不*使用 HibernateTemplate，则必须围绕创建会话的目标手动应用建议。

这也可能是他们在春天错过的东西：[https ://jira.springsource.org/browse/SPR-9404](https://jira.springsource.org/browse/SPR-9404)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:53:33.987

默认情况下，@Transactional 注释适用于接口。由于您要使用无接口，因此您应该将 proxy-target-class="true" 属性添加到配置中的 <tx:annotation-driven /> 标记中。*

# wpf - 有什么方法可以从 WPF 访问鼠标原始输入？

> ID：10836499
> 
> 赞同：2
> 
> 时间：2012-05-31T15:22:51.950
> 
> 标签：wpf, mouse, slimdx, raw-input

如果鼠标光标到达屏幕一角，我目前正在使用全局鼠标钩子使应用程序出现。我刚刚阅读了原始输入的存在，据我了解，这是一种更强大的方法，因为我的钩子减速不会影响整个系统。

**问题是我在任何地方都找不到关于在 WPF 中使用原始输入的任何示例。**

我得到的最接近的是 SlimDX，代码如下：

```
 Device.RegisterDevice(UsagePage.Generic, UsageId.Mouse, 
                        DeviceFlags.None);

  Device.MouseInput += new EventHandler<MouseInputEventArgs>(mouse_MouseInput); 
```

但这似乎不适用于WPF，只有winforms。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-12-22T14:12:11.807

那些`DeviceFlags.None`需要`InputSink`在后台捕获输入。SharpDX 标志实际上有一个[RAWINPUTDEVICEFLAGS](http://pinvoke.net/default.aspx/Enums/RawInputDeviceFlags.html) ( `InputSink = 0x00000100`) 的包装器。

在 WPF 中，您希望 1) 覆盖`OnSourceInitialized`和 2) 挂钩`WndProc`。当窗口指针可用时，您需要定义要观看的 RAWINPUTDEVICE，标记`InputSink`。

它看起来像

```
protected override void OnSourceInitialized(EventArgs e)
{
    base.OnSourceInitialized(e);
    HwndSource source = PresentationSource.FromVisual(this) as HwndSource;
    source.AddHook(WndProc);

    var win = source.Handle;

    RAWINPUTDEVICE[] rid = new RAWINPUTDEVICE[2];

    rid[0].UsagePage = (HIDUsagePage)0x01;
    rid[0].Usage = (HIDUsage)0x05;                 // adds game pad
    rid[0].Flags = RawInputDeviceFlags.InputSink;  // accept input in background
    rid[0].WindowHandle = win;

    rid[1].UsagePage = (HIDUsagePage)0x01;
    rid[1].Usage = (HIDUsage)0x04;                 // adds joystick
    rid[1].Flags = RawInputDeviceFlags.InputSink;  // accept input in background
    rid[1].WindowHandle = win;

    if (RegisterRawInputDevices(rid, (uint)rid.Length, (uint)Marshal.SizeOf(rid[0])) == false)
    {
        var err = Marshal.GetLastWin32Error();
        if (err > 0)
        {
            throw new Win32Exception($"GetLastWin32Error: {err}");
        }
        else
        {
            throw new Win32Exception("RegisterRawInputDevices failed with error code 0\. Parameter count mis-match?");
        }
    }
}

private IntPtr WndProc(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled)
{
    switch (msg)
    {
        case WM_INPUT:
            {
                System.Diagnostics.Debug.WriteLine("Received WndProc.WM_INPUT");
                DoTheThing(lParam);
            }
            break;
    }
    return hwnd;
} 
```

# r - 将 difftime 时间转换为年、月和日

> ID：10836503
> 
> 赞同：11
> 
> 时间：2012-05-31T15:23:14.550
> 
> 标签：r

如何将以下产品（单位为天）准确转换`difftime`为年，月和日？

```
difftime(Sys.time(),"1931-04-10")
difftime(Sys.time(),"2012-04-10") 
```

这有几年和几天，但我怎么能包括几个月？

```
yd.conv<-function(days, print=TRUE){
    x<-days*0.00273790700698851
    x2<-floor(x)
    x3<-x-x2
    x4<-floor(x3*365.25)
    if (print) cat(x2,"years &",x4,"days\n")
    invisible(c(x2, x4))
}

yd.conv(difftime(Sys.time(),"1931-04-10"))
yd.conv(difftime(Sys.time(),"2012-04-10")) 
```

我也不知道如何定义月份。将 4 周视为一个月或同一个月的一天。因此，如果初始日期是 2012-01-10 和当前的 2012-05-31，那么对于一个月的后期定义，那么我们将有 0 年 5 个月和 21 天。这很好用，但是如果原始日期是当月 31 日，而结束日期是 2 月 28 日，这会被视为一个月吗？

**当我写这个问题时，问题本身已经演变，所以我最好澄清一下：**

***定义月份的最佳（最合乎逻辑的方法）是什么，然后如何找到年、月和日的差异时间？***

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T18:12:08.187

如果你正在做类似的事情

```
difftime(Sys.time(), someDate) 
```

它暗示您必须知道*someDate*是什么。在这种情况下，您可以将其转换为 POSIXct 类对象，使您能够直接提取时间信息（包*chron 也*提供了更多方法）。例如

```
as.POSIXct(c(difftime(Sys.time(), someDate, units = "sec")), origin = someDate) 
```

这将返回您想要的日期对象。如果你有一个时区 tz 来输入 difftime，你也可以将它直接传递给 as.POSIXct 中的 tz 参数。

现在你有了日期对象，你可以运行类似的东西`months(.)`，如果你有 chron 你可以做`years(.)`和`days(.)`（返回有序因子）。

从这里，您可以分别对年、月和日的差异进行更简单的数学计算（转换为适当的数字表示）。当然，需要将*someDate*转换为 POSIXct。

编辑：再三考虑，`months(.)`返回月份的字符表示，因此可能效率不高。至少，它需要一些处理（不太难）来给出数字表示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:29:18.097

您不能简单地将 difftime 转换为月份，因为月份的定义取决于 difftime 开始的绝对时间。

您需要知道开始日期或结束日期才能准确判断月数。

然后，您可以计算时间跨度第一年的月数、时间跨度的最后一年的月数，并在 12 次之间加上年数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:32:10.953

唔。我认为最明智的做法是查看各个单位本身。所以先比较月份的日期，然后比较年份的月份，然后比较年份。在每一点，您都可以引入进位以避免负值。

换句话说，不要使用 difftime 的乘积，而是重新编码你自己的 difftime。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-24T17:29:43.453

R has not implemented these features out of ignorance. `difftime` objects are transitive. A 700 day difference on any arbitrary start-date can yield a differing number of years depending on whether there was a leap year or not. Similarly for months, they take between 28-31 days. For research purposes, we use these units a lot (months and years) and pragmatically, we define a month as 30.5 days and a year as 365.25 days. You must convert this value to numeric so R stops spouting off the units.

# c - 通过更改 makefile 来组合 FORTRAN 和 C

> ID：10836510
> 
> 赞同：1
> 
> 时间：2012-05-31T15:23:34.900
> 
> 标签：c, makefile, fortran, fortran-iso-c-binding

我有一个 FORTRAN 代码，它调用 C 例程来计算度量。FORTRAN 代码是：

```
program fortran
implicit none
interface
double precision function fpli_hv(A, d, n)
real :: A(5,3)
integer :: d, n
end function fpli_hv
end interface
real :: A(5,3)
double precision :: HV
integer :: i, j
A(1,:) = (/1.1,3.2,2.0/)
A(2,:) = (/6.3,5.2,7.2/)
A(3,:) = (/3.3,4.4,9.1/)
A(4,:) = (/3.3,5.2,2.1/)
A(5,:) = (/7.6,1.7,4.3/)
HV = fpli_hv(A, 3, 5)
end program fortran 
```

c 函数如下所示：

```
double fpli_hv(double *front, int d, int n, double *ref); 
```

为了加入 c 和 fortran，我需要在我的 makefile 中包含一个 Makefil.lib。我这样做了，并准备了我的makefile，如下所示：

```
# The makefile should contain a set of suffix rules. All suffixes must
# be defined. In this case we will have .o for object files, .c for
# C files, and .f for Fortran files.
.SUFFIXES: .o .c .f90

# LIBRARY:
LIBHV = /gpfs0/home/shafiiha/programs/hv-2.0rc1-src/fpli_hv.a
#include Makefile.lib

# Define the C and Fortran compilers to be used in this makefile:
CC=
FC=gfortran -ffree-form -c

# Define flags to be used by the C and Fortran compilers:
CFLAGS =    
FFLAGS =

# Define include to be used by the C and Fortran compilers:
C_INCLUDES =     
F_INCLUDES = fortran.f90

# The linker executable in this case must be the MPI Fortran compiler
# to build a mixed C and Fortran MPI code:
LINK = gfortran

# Define values of parameters that appear in the source codes:
DEFINES =

# Define the list of object files for the linker. The linker will use
# those files to build the executable.
OBJECTS = fortran.o

# The rule that makes the drv executable (note that libraries have
# been specified by the mpif90 linker):
fortran: $(OBJECTS) 
    $(LINK) -o fortran $(OBJECTS) $(LIBHV)

# The rule that makes all object files from C sources:
.c.o:
    $(CC) $(CFLAGS) $(C_INCLUDES) $(DEFINES) $<

# The rule that makes all object files from Fortran sources:
.f90.o:
    $(FC)  $(FFLAGS)  $(F_INCLUDES) $^ $(LIBHV)

# The rule for deleting object files no longer needed after using
# make for drv:
clean:
    rm  *.o 
```

但是当我成功时，我收到了这条消息：

```
gfortran -o fortran fortran.o /gpfs0/home/shafiiha/programs/hv-2.0rc1-src/fpli_hv.a  
fortran.o: In function `MAIN__':  
fortran.f90:(.text+0x548): undefined reference to `fpli_hv_'  
collect2: ld returned 1 exit status  
make: *** [fortran] Error 1 
```

你能帮我解释一下为什么会出现这个错误吗？非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T15:52:00.360

在这个时代，从 Fortran 调用 C 的最佳方式是使用 ISO C 绑定。您的问题是 Fortran 默认情况下为避免与 C 或标准库的例程发生冲突而进行的名称修改，通常添加下划线。使用 ISO C 绑定，您既可以指定被调用例程的确切名称，覆盖名称修饰，又可以轻松实现参数的 Fortran-C 一致性。在 Fortran 端，您编写一个描述 C 例程的接口。这里有以前的答案，gfortran 手册中有示例。这些示例并不是 gfortran 独有的，因为 ISO C 绑定是 Fortran 2003 语言标准的一部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-31T15:53:29.973

如果你已经在做接口（这很棒！）那么你也可以使用大多数 fortran 编译器的最新版本已经必须避免担心下划线和字母大小写的 iso_c_binding 模块以及你有什么：

```
interface
  function fpli_hv(A, d, n) bind(C)
   use iso_c_binding
   implicit none

   real(kind=c_double) :: fpli_hv
   integer(kind=c_int), value :: d, n
   real(kind=c_float) :: A(5,3)

  end function fpli_hv
end interface 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:25:33.510

裹

```
double fpli_hv(double *front, int d, int n, double *ref); 
```

和

```
void FPLI_HV_(double *front, int* d, int* n, double *ref, double* returnvalue); 
```

Fortran 对象只理解以 _ 结尾的东西，所有函数传递都是指针。

（编辑以下评论）。

# c# - 在 Dynamics 2011 SDK 中，当 LookupAttributeMetadata.Targets 为空时如何确定目标实体？

> ID：10836514
> 
> 赞同：10
> 
> 时间：2012-05-31T15:23:47.690
> 
> 标签：c#, dynamics-crm, dynamics-crm-2011

使用 CRM 2011 SDK (v5.0.10) 我遇到了一些查找字段的问题，其中没有填充目标，我希望有人可以帮助我确定在这些情况下确定引用实体的最佳方法。

具体来说，我正在使用此调用检索实体、属性和关系元数据：

```
var entityRequest = new RetrieveAllEntitiesRequest
                        {
                           RetrieveAsIfPublished = true,
                           EntityFilters = EntityFilters.Entity | EntityFilters.Attributes | EntityFilters.Relationships
                           };

var entityResponse = (RetrieveAllEntitiesResponse)_organizationService.Execute(entityRequest);
return entityResponse.EntityMetadata.ToList(); 
```

稍后，在处理从该调用返回的 EntityMetadata 对象时，我检查了 Attributes 集合，对于 LookupAttributeMetadata 对象，我尝试使用 LookupAttributeMetadata 对象的 Targets 属性来确定查找所引用的实体。

但是，在某些情况下 LookupAttributeMetadata 对象有一个空的 Targets 集合。例如，Campaign Activity（逻辑名称：campaignactivity）实体将 Service 字段（逻辑名称：serviced）定义为 Lookup 字段，但 LookupAttributeMetadata 对象的 Targets 属性为空。

![VS 快速观看](../Images/cb81921c26efd537f560d714e0e4fdd0.png)

当我查看实体的 Web UI 自定义屏幕并打开服务字段时，在类型部分下显示类型：查找，目标记录类型：帐户，关系名称：campaignactivity_account。

![Web UI 字段视图](../Images/e5e7174488c1b6e47588bad4d6f24e18.png)

这些信息来自哪里？

另请注意：活动活动或帐户实体上没有名为“campaignactivity_account”的关系。

更新：我正在运行 Dynamics CRM 2011 Rollup 8 的库存安装（尽管我在 Rolloup 7 上也看到了这一点）。虽然活动活动是我在示例中使用的字段，但此问题共有 14 个，如下所列。我正在寻找一个通用解决方案（每个解决方案都是一次性解决方案）来避免`if (entityName=="rollupfield" && fieldName=="organizationid")...`在我的代码中包含一堆逻辑，因为我正在使用的实体和字段是由用户在运行时选择的，而我没有不一定提前知道我会得到什么。

*   实体：汇总字段（rollupfield） 字段：组织ID（organizationid）
*   实体：汇总查询（goalrollupquery） 字段：拥有用户（owninguser）
*   实体：流程日志（workflowlog） 字段：关于（关于objectid）
*   实体：已保存视图 (userquery) 字段：父查询 (parentqueryid)
*   实体：活动活动（campaignactivity） 字段：服务（serviceid）
*   实体：电子邮件搜索 (emailsearch) 字段：父 (parentobjectid)
*   实体：时区定义（timezonedefinition） 字段：组织（organizationid）
*   实体：活动响应（campaignresponse） 字段：服务（serviceid）
*   实体：快速活动（批量操作） 字段：服务（serviceid）
*   实体：字段权限（fieldpermission） 字段：组织ID（organizationid）
*   实体：时区本地化名称（timezonelocalizedname） 字段：组织（organizationid）
*   实体：时区规则（timezonerule） 字段：组织（organizationid）
*   实体：审计（audit） 字段：记录（objectid）
*   实体：帖子（post） 字段：关于ObjectId（关于objectid）

更新：以下控制台应用程序可用于重现该问题。

```
//Requires the following Referenses:
// Microsoft.CSharp
// Microsoft.IdentityModel
// Microsoft.xrm.sdk
// System
// System.Core
// System.Data
// System.Runtime.Serialization
// System.ServiceModel

using System;
using System.Linq;
using System.Net;
using Microsoft.Xrm.Sdk;
using Microsoft.Xrm.Sdk.Client;
using Microsoft.Xrm.Sdk.Messages;
using Microsoft.Xrm.Sdk.Metadata;

namespace TargetlessLookupsPOC
{
    internal static class Program
    {
        private const string OrganizationServiceURL =
            "http://dynamicscrm1/DynamicsCRM1/XRMServices/2011/Organization.svc";

        private static void Main(string[] args)
        {
            Console.WriteLine("====== Authenticating ");

            var organizationServiceMngt =
                ServiceConfigurationFactory.CreateManagement<IOrganizationService>(new Uri(OrganizationServiceURL));
            var authCred = new AuthenticationCredentials();
            authCred.ClientCredentials.Windows.ClientCredential = new NetworkCredential();
            IOrganizationService orgProxy = new OrganizationServiceProxy(organizationServiceMngt,
                                                                         authCred.ClientCredentials);

            Console.WriteLine("====== Fetching All Entity Metadata ");
            var entityRequest = new RetrieveAllEntitiesRequest
                {
                    RetrieveAsIfPublished = true,
                    EntityFilters = EntityFilters.Entity | EntityFilters.Attributes | EntityFilters.Relationships
                };

            var entityResponse = (RetrieveAllEntitiesResponse) orgProxy.Execute(entityRequest);

            Console.WriteLine("====== Searching For Targetless Lookups ");
            foreach (var ent in entityResponse.EntityMetadata)
            {
                foreach (var field in ent.Attributes
                    .OfType<LookupAttributeMetadata>()
                    .Where(lookup => !lookup.Targets.Any()))
                {
                    Console.WriteLine("Entity: {0} ({1}), Field: {2} ({3}) (type: {4}) is targetless",
                                      ent.DisplayName.LabelText(), ent.LogicalName,
                                      field.DisplayName.LabelText(), field.LogicalName,
                                      field.AttributeType);
                }
            }

            Console.WriteLine("=========================== Done");
            Console.WriteLine("** Press any key to continue **");
            Console.ReadKey();
        }

        public static string LabelText(this Label label)
        {
            return (label != null && label.UserLocalizedLabel != null)
                       ? label.UserLocalizedLabel.Label
                       : "<no label>";
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-15T22:03:14.843

您是否尝试过使用[RetrieveRelationshipRequest](http://msdn.microsoft.com/en-us/library/microsoft.xrm.sdk.messages.retrieverelationshiprequest(v=crm.6).aspx)消息？

这将返回一个 RetrieveRelationshipResponse 类，该类具有一个 RelationshipMetadata 属性，而根据关系，它将是 [OneToManyRelationshipMetadata](http://msdn.microsoft.com/en-us/library/microsoft.xrm.sdk.metadata.onetomanyrelationshipmetadata_members.aspx)或 ManyToManyRelationshipMetadata。在 OneToManyRelationshipMetadata 类的属性中，您会发现 ReferencedAttribute 和 ReferencedAttribute 属性，这正是您想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T04:20:44.377

我无法理解这里的问题。具有查找字段的实体可能有也可能没有目标实体。当然，我抽查了其中一些，但不需要任何引用的查找。对于 timezonerule 实体，organizationid 始终为 NULL。不过，根据您的更新，我认为您可能得出了相同的结论。

当然，我主要使用 Fetch，但我倾向于只遍历属性并基于属性类型并将每个属性添加到 Dictionary 对象中。字典对象被包装在一个列表中（即 `List<Dictionary<string, object>>` ）

这样我可以只传递一个通用的 Fetch 语句并取回一个干净的填充属性的 iList。对于查找，您还可以附加“_name”属性以获取显示值。

# c# - 设置授权已禁用登录表单上的超链接

> ID：10836515
> 
> 赞同：0
> 
> 时间：2012-05-31T15:23:55.587
> 
> 标签：c#, asp.net

我的 web.config 中有以下设置：

```
 <!-- The <authentication> section enables configuration of the security authentication mode used by ASP.NET to identify an incoming user. -->
  <authentication mode="Forms">
    <forms loginUrl="/login.aspx"
           protection="All"
           timeout="30"
           name=".ASPXAUTH"
           path="/"
           requireSSL="false"
           slidingExpiration="true"
           defaultUrl="UserConfigSettings.aspx"
           cookieless="UseCookies"
           enableCrossAppRedirects="false" />
  </authentication>

  <!-- This section denies access to all files in this application except for those that you have not explicitly specified by using another setting. -->
  <authorization>
    <deny users ="?" />
    <allow users = "*" />
  </authorization>
</system.web>

<location path="Images">
  <system.web>
    <authorization>
      <allow users="?,*" />
    </authorization>
  </system.web>
</location>

<location path="Styles">
  <system.web>
    <authorization>
      <allow users="?,*" />
    </authorization>
  </system.web>
</location> 
```

在我的登录表单上，我有一个将用户重定向到注册页面的超链接，但是由于应用了上述授权设置，该链接不起作用，直到我登录后，我才会被重定向到注册页面。我可以专门设置这个链接来重定向用户，不管他们有什么授权？这是我的表单代码

```
<form id="form1" runat="server">
<div>
    <asp:Panel ID="panelHeaderImage" BorderWidth="1" runat="server" width="660" >
        <table class="Table">
            <tr align="center">
            <td colspan="3"><img src="images/header.jpg" alt="some_text" /><br /><br /></td>
            </tr>
            <tr valign="top">
                <td colspan="3"><asp:Panel ID="panelNavigation" CssClass="Panel" runat="server" HorizontalAlign="Center" Width="650px"></asp:Panel> </td>
            </tr>
            <tr valign="top">
                <td align="right">
                    <asp:Label ID="lblUserName" CssClass="Label_Med_Bold" runat="server" Text="User Name:"></asp:Label>
                </td>
                <td align="left">
                    <asp:textbox id="txtUserName" runat="server" width="180px"></asp:textbox>
                    <asp:requiredfieldvalidator id="rvUserValidator" runat="server" controltovalidate="txtUserName"  CssClass="Label_Small_Red" errormessage="Please enter a Username" display="Dynamic"></asp:requiredfieldvalidator>
                </td>
            </tr>
            <tr valign="top">
                <td align="right">
                    <asp:Label ID="lblPassword" CssClass="Label_Med_Bold" runat="server" Text="Password:"></asp:Label>
                </td>
                <td align="left">
                    <asp:textbox id="txtPassword" runat="server" width="180px" textmode="Password"></asp:textbox>
                    <asp:requiredfieldvalidator id="rvPasswordValidator" runat="server" controltovalidate="txtPassword" CssClass="Label_Small_Red" errormessage="Please enter a Password" display="Dynamic"></asp:requiredfieldvalidator>
                </td>
            </tr>
        </table>
        <table width="650" class="Table">
            <tr valign="top">
                <td align="right" class="special_column1">
                    <asp:Label ID="lblSaveResult" runat="server" CssClass="Label_Red_Bold" Text=""></asp:Label>
                </td>
                <td align="left">
                    <asp:button id="btnLogin" CssClass="Button_Main" runat="server" text="Login" borderstyle="Solid" onclick="btnLogin_Click"></asp:button>
                </td>
            </tr>
            <tr>
                <td>
                    <asp:hyperlink id="hl_Register" CssClass="hyperlink" runat="server" Enabled="true" navigateurl="Administration.aspx">New User?...Register Here</asp:hyperlink>
                </td>
            </tr>
        </table>                       
    </asp:Panel>
</div>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:27:22.793

是的，您只需要`Location`在 web.config 中添加一个仅允许访问注册页面的部分：

```
<location path="Administration.aspx"> 
  <system.web> 
    <authorization> 
      <allow users="?,*" /> 
    </authorization> 
  </system.web> 
</location> 
```

# python - pylint 从 TextMate 运行时会忽略 .pylintrc

> ID：10836517
> 
> 赞同：2
> 
> 时间：2012-05-31T15:24:07.177
> 
> 标签：python, textmate, pylint

当我在 TextMate 中的 python 文件上运行验证语法时，我试图让 pylint 提供 html 输出。我安装了 pycheckmate、pylint，并在 $HOME 中创建了一个 .pylintrc 文件，将输出格式设置为 html。

在 TextMate 的高级控制面板中，在 Shell 变量选项卡中，我`TM_PYCHECKER`设置为`/usr/local/share/python/pylint`. 如果我触发 Validate Syntax，它会使用所有默认选项运行 pylint，并给我输出。如果我再次更改`TM_PYCHECKER`并`/usr/local/share/python/pylint --rcfile "$HOME/.pylintrc"`验证语法，我会得到：

> 请安装 PyChecker、PyFlakes 或 Pylint 以进行更广泛的代码检查。

如果我从命令行运行 /usr/local/share/python/pylint ，没有任何参数，输出是 html，所以我知道在这种情况下它正在读取 rcfile。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T23:34:42.080

好的，我想我发现了问题：pycheckmate 设置`--output-format=parseable'`为 pylint 的强制参数。我通过用打印出其参数的包装脚本替换 /usr/local/share/python/pylint 发现了这一点：

```
#!/usr/bin/env python

import sys
from pylint import lint

print sys.argv[1:]
lint.Run(sys.argv[1:]) 
```

当我在 TextMate 中运行它时，我看到了这个：

```
['--output-format=parseable', '/Users/smithm5/test.py']
test.py:26 [C] Line too long (90/80)
… 
```

所以我挖掘了 /Applications/TextMate.app/Contents/SharedSupport/Bundles/Python.tmbundle/Support/bin/pycheckmate.py 本身。果然，它添加了这个论点，以及*一大堆*硬编码的 html。所以为了修复它，我删除了所有的`escape()`包装，设置`opts = ()`在第 287 行，这样我就可以设置自己的选项，并将第 332 行更改为`print line`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T17:25:10.817

一个有根据的猜测：尝试用`$HOME`你的主目录的绝对路径替换。像这样的 Shell 变量`$HOME`可能无法在 TextMate 的控制面板中使用。

更新：查看`pycheckmate.py`包含在我拥有的 TextMate 版本中的脚本`Python.tmbundle`，似乎无法包含参数，例如`--rcfile /path/to/rcfile`. 的值`TM_PYCHECKER`应该只是不带参数的检查器二进制文件的路径。但是，如果您制作自己的 Python.tmbundle 副本，您应该能够`pycheckmate.py`按照自己的意愿进行编辑。

# javascript - 我悬停的位置的工具提示

> ID：10836521
> 
> 赞同：2
> 
> 时间：2012-05-31T15:24:35.237
> 
> 标签：javascript, jquery, tooltip

我在我的项目中使用[了这个](http://net.tutsplus.com/tutorials/javascript-ajax/build-a-better-tooltip-with-jquery-awesomeness/)工具提示，它工作得很好，但问题是我需要工具提示出现在我悬停的地方而不是固定的位置。目前它出现在固定的位置。我需要在我悬停的地方出现工具提示。

我该如何修饰此代码

```
 /* Position the tooltip relative to the class 
       associated with the tooltip                */  
    setTip = function(top, left){  
        var topOffset = tip.height();  
        var xTip = (left-30)+"px";  
        var yTip = (top-topOffset-60)+"px";  
        tip.css({'top' : yTip, 'left' : xTip});  
    } 
```

完整的代码在这里

```
 $.fn.betterTooltip = function(options){

/* Setup the options for the tooltip that can be 
   accessed from outside the plugin              */
var defaults = {
    speed: 200,
    delay: 300
};

var options = $.extend(defaults, options);

/* Create a function that builds the tooltip 
   markup. Then, prepend the tooltip to the body */
getTip = function() {
    var tTip = 
        "<div class='tip'>" +
            "<div class='tipMid'>"  +
            "</div>" +
            "<div class='tipBtm'></div>" +
        "</div>";
    return tTip;
}
$("body").prepend(getTip());

/* Give each item with the class associated with 
   the plugin the ability to call the tooltip    */
$(this).each(function(){

    var $this = $(this);
    var tip = $('.tip');
    var tipInner = $('.tip .tipMid');

    var tTitle = (this.title);
    this.title = "";

    var offset = $(this).offset();
    var tLeft = offset.left;
    var tTop = offset.top;
    var tWidth = $this.width();
    var tHeight = $this.height();

    /* Mouse over and out functions*/
    $this.hover(
        function() {
            tipInner.html(tTitle);
            setTip(tTop, tLeft);
            setTimer();
        }, 
        function() {
            stopTimer();
            tip.hide();
        }
    );         

    /* Delay the fade-in animation of the tooltip */
    setTimer = function() {
        $this.showTipTimer = setInterval("showTip()", defaults.delay);
    }

    stopTimer = function() {
        clearInterval($this.showTipTimer);
    }

    /* Position the tooltip relative to the class 
       associated with the tooltip                */
    setTip = function(top, left){
        var topOffset = tip.height();
        var xTip = (left-30)+"px";
        var yTip = (top-topOffset-60)+"px";
        tip.css({'top' : yTip, 'left' : xTip});
    }

    /* This function stops the timer and creates the
       fade-in animation                          */
    showTip = function(){
        stopTimer();
        tip.animate({"top": "+=20px", "opacity": "toggle"}, defaults.speed);
    }
});
    }; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T15:44:42.323

**.hover(handlerIn, handlerOut)** is short for **.mouseenter(handlerIn).mouseleave(handlerOut)**. That means you have access to the mouse coords of the mousenter().

Change your .hover binding to use mouse coordinates of hover entry point:

```
/* Mouse over and out functions*/
$this.hover(
    function(e) {
        tipInner.html(tTitle);
        setTip(e.clientY, e.clientX);  //<--- using mouseenter coords here
        setTimer();
    }, 
    function() {
        stopTimer();
        tip.hide();
    }
).mousemove (function(e) {
    setTip(e.pageY, e.pageX);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T15:30:12.570

给它鼠标坐标而不是静态 div 坐标：

```
$(document).mousemove (function(e) {
    mouseX = e.pageX;
    mouseY = e.pageY;
}); 
```

jQuery 文档：[http ://docs.jquery.com/Tutorials:Mouse_Position](http://docs.jquery.com/Tutorials:Mouse_Position)

# android - 将对象传递给片段

> ID：10836525
> 
> 赞同：40
> 
> 时间：2012-05-31T15:24:44.213
> 
> 标签：android, fragment, android-bundle

我最近一直在使用很多方法，`Fragments`并且一直在使用两种不同的方法将对象传递给片段，但我可以看到的唯一区别是，在下面的 FragmentOne 采用的方法中，您传入的对象必须实现`Serializable`接口（[以及与之相关的所有内容](http://www.javapractices.com/topic/TopicAction.do?Id=45)）。

使用其中一个有什么好处吗？

```
public class FragmentOne extends Fragment {
    public static final String FRAGMENT_BUNDLE_KEY = 
        "com.example.FragmentOne.FRAGMENT_BUNDLE_KEY";

    public static FragmentOne newInstance(SomeObject someObject) {
        FragmentOne f = new FragmentOne();
        Bundle args = new Bundle();
        args.putSerializable(FRAGMENT_BUNDLE_KEY, someObject);
        f.setArguments(args);
        return f;
    }

    public SomeObject getSomeObject() {
        return (SomeObject) getArguments().getSerializable(FRAGMENT_BUNDLE_KEY);
    }
} 
```

和

```
public class FragmentTwo extends Fragment {
    SomeObject mSomeObject;  

    public static FragmentTwo newInstance(SomeObject someObject) {
        FragmentTwo fragment = new FragmentTwo();
        fragment.setSomeObject(someObject);
        return fragment;
    }

    public void setSomeObject(SomeObject someObject) {
        mSomeObject = someObject;
    }
} 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-05-31T15:40:06.203

将对象传递给片段有 3 种方法

他们是：

1.  通过 setter 传递对象是最快的方法，但不会自动恢复状态。
2.  `setArguments`使用`Serializable`对象是最慢的方式（但我认为对于小对象来说还可以），并且您可以自动恢复状态。
3.  传递 as`Parcelable`是一种快速的方式（如果您有要传递的元素集合，则更喜欢它而不是第二个），并且您可以自动恢复状态。

[http://developer.android.com/reference/android/os/Parcelable.html](http://developer.android.com/reference/android/os/Parcelable.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-08T09:18:18.180

对于集合，例如 List ：

我想分享我的经验。

你需要实现 Parcelable

只需使用 putParcelableArrayList 方法。

```
ArrayList<LClass> localities = new ArrayList<LClass>;
...
Bundle bundle = new Bundle();
bundle.putParcelableArrayList(KEY_LClass_LIST, localities);
fragmentInstance.setArguments(bundle);

return fragmentInstance; 
```

并使用...检索它

```
localities = savedInstanceState.getParcelableArrayList(KEY_LCLass_LIST); 
```

因此，除非您出于其他原因需要自定义 ArrayList，否则您可以避免做任何额外的工作，而只为您的 Locality 类实现 Parcelable。

# c# - C# SQL Server - 对多个数据库访问或通过数据的多个循环更有效？

> ID：10836527
> 
> 赞同：0
> 
> 时间：2012-05-31T15:24:49.900
> 
> 标签：c#, sql, performance, processing-efficiency

在我的应用程序的一部分中，我必须获取满足条件的表的最后一个 ID 例如：

```
SELECT(MAX) ID FROM TABLE WHERE Num = 2 
```

所以我可以抓取整个表并循环查找 Num = 2，或者我可以从 Num = 2 的表中抓取数据。在后者中，我知道最后一项将是 MAX ID。

无论哪种方式，我都必须这样做大约 50 次......所以抓取所有数据并循环遍历数据列表以寻找特定条件会更有效......

还是根据条件多次获取数据会更好..我知道列表中的最后一项将是最大 id

我有 6 个条件，我必须根据这些条件进行查询

我只是想知道哪个更有效...循环遍历大约 3500 个项目的列表几次，或者多次访问数据库，我已经可以像我需要的那样分解数据

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:33:47.407

我可以代表 SqlServer。如果您创建一个 StoredProcedure，其中 Num 是您传递的参数，由于其对存储过程执行计划的优化引擎，您将获得最佳性能。当然，该字段上的索引是强制性的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:28:07.967

让数据库完成这项工作，这是它的设计目的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:31:53.453

这个表的插入频率高吗？它的更新频率是否很高，特别是在您应用 MAX 函数的列上？如果答案是否定的，您可以考虑添加 IS_MAX BIT 列并使用插入触发器进行设置。这样一来，你想要的行基本上就被缓存了，查找起来很简单。

# internet-explorer-9 - Internet Explorer 9 中无样式文本的 @font-face 闪烁

> ID：10836529
> 
> 赞同：2
> 
> 时间：2012-05-31T15:25:05.943
> 
> 标签：internet-explorer-9, font-face

我目前正在使用@font-face 构建一个 asp 站点，但我在 Internet Explorer 9 中遇到了可怕的 Flash Of Unstyled Text 错误。到目前为止，我已将脚本移动到我的 css 文件下并使用了[防弹语法](http://www.fontspring.com/blog/further-hardening-of-the-bulletproof-syntax)。据我所知，我已经遵守了规则，但似乎没有什么能解决这个问题。我的问题是：这个错误是可以避免的，还是所有这些方法都只是通过让浏览器更快地下载字体来破坏控制？我意识到有类似的问题，但重要的是要知道我是否只是在与 Internet Explorer 在等待@font-face 时加载回退字体的自然倾向作斗争。可悲的是，我不能使用谷歌网络字体，我不想隐藏我的内容几秒钟并用 jQuery 显示它（不是真正的修复！）。

对于那些对我的文件大小感兴趣的人来说，我的文件大小约为 33k。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T15:41:31.323

**为了防止 IE9 中出现 FOUT，您可以通过 base64-encoding 将 TTF-Font-File 嵌入 CSS 中** （此解决方案适用于所有浏览器）

*确保将 EOT 文件传送到 IE <=8*

```
<!--[if (lte IE 8) & (!IEMobile) ]>
    <link rel="stylesheet" media="screen" href="styles/fontface-ielte8.css" />
<![endif]--> 
```

放入你的@font-face-rule（推荐使用[fontsquirrel](http://www.fontsquirrel.com/fontface/generator)）

```
@font-face {
    font-family: 'MaidenDataURITest';
    src: url('MaidenOrange-webfont.eot');
    src: url('MaidenOrange-webfont.eot?#iefix') format('embedded-opentype');
    font-weight: normal;
    font-style: normal;
} 
```

**下一步**，包括所有其他浏览器的@font-face-declaration（IE9+ 支持媒体查询[更多信息](http://msdn.microsoft.com/en-us/library/ie/ms530813(v=vs.85).aspx)：

```
<link rel="stylesheet" media="screen and (min-device-width: 1px)" href="styles/fontface.css" /> 
```

通过 DataURI(base64-encoding) 将 @font-face-rule 与 TTF 文件一起放入：

```
@font-face {
    font-family: 'MaidenDataURITest';
    src: url('data:application/octet-stream;base64, [your-base64-data]') format('truetype');
    font-weight: normal;
    font-style: normal;
} 
```

因此使用[fontsquirrel](http://www.fontsquirrel.com/fontface/generator)生成 DataURI -> 专家模式。
很高兴知道：IE8 支持 dataURI 直到 32KiB。IE9没有这样的限制。

**适用于所有类型文件的**DataURI 生成器：**[单击此处](http://t.larskl.de/dataurl)**

 ****[上面的现场演示 »](http://georgepantazis.com/demos/fontface-datauri/)**

* * *

改善**下载时间**

**通过 unicode-range**提供您需要的字符：http:** [//www.w3.org/TR/css3-fonts/#unicode-range-desc](http://www.w3.org/TR/css3-fonts/#unicode-range-desc) 这将减少必须下载的下载时间和文件大小（适用于 IE9+ 和更新的浏览器，否则将下载整个字体）**

 **```
@font-face {
    font-family: foo;
    src: url('foo.woff');
    unicode-range: U+31-33;
} 
```

**下一步**，您可以通过 .htaccess 在 apache 服务器上**应用它来设置过期日期**，让 Web 浏览器知道，他应该缓存字体文件：这将使无样式内容的闪存肯定会重新访问。

```
<IfModule mod_expires.c>
    ExpiresActive On
    <FilesMatch "\.(eot|woff|ttf|svg)$>
        ExpiresDefault "access plus 10 years"
    </FilesMatch>
</IfModule> 
```

然后**压缩字体文件**以加快下载速度（通过 .htaccess-file）：

```
AddOutputFilterByType DEFLATE  application/vnd.ms-fontobject application/x-font-ttf image/svg+xml 
```

WOFF 文件已经内置了 gzip 压缩。

您可以在您的服务器上创建一个 .htaccess 文件并将此属性写入其中。在 Apache 服务器上运行良好 :)

* * *

更多细节：

现场示例： http: [//georgepantazis.com/demos/fontface-datauri/](http://georgepantazis.com/demos/fontface-datauri/)

Paul Irish 关于 FOUT： http: [//paulirish.com/2009/fighting-the-font-face-fout/](http://paulirish.com/2009/fighting-the-font-face-fout/)

兼容性详细信息和清单：[http ://www.aaronpeters.nl/blog/IE9-performance-checklist](http://www.aaronpeters.nl/blog/IE9-performance-checklist)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T17:46:12.457

您可以通过将字体声明放入单独的 css 文件并将对该文件的导入放在 css 顶部来防止 FOUT。这是有效的，因为 @import 是阻塞的，所以它确实会影响性能。****

# javascript - 如何检索 mousedown 到 mouseup 事件之间的所有鼠标坐标

> ID：10836538
> 
> 赞同：2
> 
> 时间：2012-05-31T15:25:41.497
> 
> 标签：javascript, jquery

根据下面的 jQuery 文档，代码可用于捕获 mouseup 和 mouse down 事件。但我的要求有点不同

```
$("#dic").mouseup(function () {

}).mousedown(function () {

}); 
```

但是如何计算 mousedown 位置到 mouseup 位置之间的鼠标移动坐标。请帮助我。如何在 mousedown 和 mouseup 之间应用 mousemove 事件

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T15:42:53.633

如果您需要在拖动过程中捕获鼠标经过的所有点，请绑定/取消绑定新的`mousemove`处理程序：

```
var allPoints = [];
$("#dic").mouseup(function (e) {
    $(this).unbind("mousemove", trackPoints);
}).mousedown(function (e) {
    $(this).bind("mousemove", trackPoints); 
});

function trackPoints(e) {
    allPoints.push({ x: e.pageX, y: e.pageY });
} 
```

这样，`trackPoints`当鼠标向下时将开始射击，并在鼠标重新向上时停止。

您可能还想在您的和处理程序`if(e.which == 1)`的顶部添加一个，以便它们只执行鼠标左键，而不是中键或右键。`mouseup``mousedown``bind`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-31T15:27:24.180

```
var X = [],
    Y = [],
    i = -1;
$("#dic").mouseup(function(e) {
    ++i;
    X[i] = e.pageX;
    Y[i] = e.pageY;
    // reset everything on mouseup
    X = [];
    Y = [];
    i = -1;
}).mousedown(function(e) {
    ++i;
    X[i] = e.pageX;
    Y[i] = e.pageY;
    console.log(X);
}).mousemove(function(e) {
    ++i;
    X[i] = e.pageX;
    Y[i] = e.pageY;
}); 
```

**[演示](http://jsfiddle.net/thecodeparadox/guSpj/4/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T15:47:51.513

```
var x = [], y = [], i = 0;

$("#dic").mouseup(function (e) {
    $('#status').html(e.pageX +', '+ e.pageY + ' up');
    x[i] = e.pageX;
    y[i++] = e.pageY;

    console.log(x);
    console.log(y);
});

$("#dic").mousedown(function (e) {
    $('#status').html(e.pageX +', '+ e.pageY + ' down');
    i = 0;
    x[i] = e.pageX;
    y[i++] = e.pageY;
});

$("#dic").mousemove(function (e) {
    $('#status').html(e.pageX +', '+ e.pageY + ' move');
    x[i] = e.pageX;
    y[i++] = e.pageY;
}); 
```

这将在 mousedown 时开始记录鼠标位置，您可以在 mouseup 时在控制台上看到输出。然后，您可以按照使用数组的第一项和最后一项或开始和结束之间的任何其他点描述的代码悖论来计算距离。

[JSFiddle 上的代码](http://jsfiddle.net/PJ6P2/2/)

# html - 将按钮固定在 Tumblr 帖子上

> ID：10836540
> 
> 赞同：0
> 
> 时间：2012-05-31T15:25:46.080
> 
> 标签：html, tumblr, pinterest

**目标：**我想在我的 tumblr 上每个帖子的底部添加一个“固定它”按钮（在 facebook 和 twitter 按钮旁边）。

**主要问题：简单地将**[http://pinterest.com/about/goodies/](http://pinterest.com/about/goodies/)提供的代码粘贴到 tumblr 的自定义 HTML 编辑器中添加 pin it 按钮不起作用。我在 {block:Posts} 块的末尾粘贴了以下代码：

```
 <a href="http://pinterest.com/pin/create/button/" class="pin-it-button" 
    count-layout="horizontal">
    <img border="0" src="//assets.pinterest.com/images/PinExt.png" title="Pin It" />
    </a>
    <script type="text/javascript" src="//assets.pinterest.com/js/pinit.js"></script> 
```

这会在每个帖子的正确位置产生一个“固定”按钮，但单击它不会执行任何操作。tumblr 生成的 HTML 发生了变化，如下所示：

```
 <a style="cursor:pointer" title="http://pinterest.com/pin/create/button/" class="pin-it-button" count-layout="horizontal">
    <img border="0" src="//assets.pinterest.com/images/PinExt.png" title="Pin It"></a>
    <script type="text/javascript" src="//assets.pinterest.com/js/pinit.js"></script> 
```

Tumblr 生成的锚标签中没有 href 属性。这似乎是个问题。任何人都知道如何让 Tumblr 正确地做到这一点？

**另一个问题**（可能同样重要）：pinterest 提供的代码没有指定要固定的图像。我希望按钮将图像固定在帖子中。通过在线阅读，我得到了在 href 属性中包含 url 和 media 参数的想法。例如：

```
 <a href="http://pinterest.com/pin/create/button/?url={Permalink}&media={PhotoURL-500}" class="pin-it-button" count-layout="horizontal">
    <img border="0" src="//assets.pinterest.com/images/PinExt.png" title="Pin It" />
    </a> 
```

同样，当我单击生成的 pin it 按钮时没有任何反应——所以我不知道这些参数是否必要——只是它们不能解决我的第一个问题。

任何帮助是极大的赞赏。

干杯， - 大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T13:34:52.610

尝试使用 URLEncodedPermalink 对变量进行编码 - 这对我有用：

```
{block:Posts}

  {block:Photo}
    <a href="http://pinterest.com/pin/create/button/?url={URLEncodedPermalink}&media={URLEncodedPhotoURL-500}" class="pin-it-button" count-layout="horizontal">
    <img border="0" src="//assets.pinterest.com/images/PinExt.png" title="Pin It" />
   </a>
  {/block:Photo}

{/block:Posts} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T19:16:42.630

感谢您的建议。这就是最终为我工作的东西。

[按照http://tumblring.net/how-to-add-a-pinterest-button-to-tumblr/](http://tumblring.net/how-to-add-a-pinterest-button-to-tumblr/)上的说明进行操作， 但有以下区别：

1.  在 {/block:Posts} 结束标记之前使用了以下 HTML 嵌入代码：

    ```
    <a href="http://pinterest.com/pin/create/button/?url={Permalink}&media={PhotoURL-500}"
    class="pin-it-button" count-layout="horizontal">
    <img border="0" src="//assets.pinterest.com/images/PinExt.png" title="Pin It" />
    </a> 
    ```

2.  不包括以下与 html 嵌入一起剪断的 javascript：

    ```
    <script type="text/javascript" src="http://assets.pinterest.com/js/pinit.js"></script> 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T18:06:49.573

您的代码也应该在帖子块和帖子类型块内。例如，如果您将 pinit 按钮添加到照片帖子中，它将如下所示：

```
{block:Posts}

{block:Photo}
<a href="http://pinterest.com/pin/create/button/?url={Permalink}&media={PhotoURL-500}" class="pin-it-button" count-layout="horizontal">
    <img border="0" src="//assets.pinterest.com/images/PinExt.png" title="Pin It" />
    </a>
{/block:Photo}

{/block:Posts} 
```

# c# - 传递带有两个对象集合的元组以查看？

> ID：10836548
> 
> 赞同：0
> 
> 时间：2012-05-31T15:26:15.970
> 
> 标签：c#, asp.net, asp.net-mvc-3, tuples

我想传递两个对象集合。一是`Post`，二是`Gallery`。但是我收到错误，我不知道如何解决这个问题。

我在传递两个单个对象时已经这样做了，它工作正常，但现在我需要传递这些对象的两个集合，它给了我错误。

错误

> 传入字典的模型项的类型为“System.Tuple `2[System.Linq.IQueryable`1[photoBlog.Models.Gallery],System.Linq.IQueryable `1[photoBlog.Models.Post]]', but this dictionary requires a model item of type 'System.Tuple`2[System.Collections.Generic.IEnumerable `1[photoBlog.Models.Gallery],System.Collections.Generic.IEnumerable`1[photoBlog.Models.Post]]”。

控制器

```
public ActionResult Index()
{
    photoBlogModelDataContext _db = new photoBlogModelDataContext();
    var posts = _db.Posts.OrderByDescending(x => x.DateTime).Take(4);
    var galleries = _db.Galleries.OrderByDescending(x => x.ID).Take(4);
    return View(Tuple.Create(galleries, posts));
} 
```

看法

```
@model Tuple<IEnumerable<photoBlog.Models.Gallery>, IEnumerable<photoBlog.Models.Post>>
@foreach (var item in Model.Item1)
{
   @item.Name
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T15:41:27.093

我认为您应该将控制器方法修改为：

```
public ActionResult Index()
{
    photoBlogModelDataContext _db = new photoBlogModelDataContext();
    var posts = _db.Posts.OrderByDescending(x => x.DateTime).Take(4).ToArray();
    var galleries = _db.Galleries.OrderByDescending(x => x.ID).Take(4).ToArray();
    return View(Tuple.Create(galleries, posts));
} 
```

从您的错误消息来看，当您的视图呈现时，查询似乎尚未解决。通过同时执行 ToArray 或 ToList，您将强制查询在从控制器方法返回之前访问数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:28:24.360

您需要在 domain.Model 中创建一个新实体

这是我今天提供的一个示例： [MVC3：发送表单（模型）值和额外参数的按钮](https://stackoverflow.com/questions/10829541/mvc3-button-to-send-both-form-model-values-and-an-extra-parameter/10829908#10829908)
稍后编辑：

```
namespace App.Domain.Model
{
    public class Tuple
    {
        public IEnumerable<photoBlog.Models.Gallery> Gallery{ get; set; }
        public IEnumerable<photoBlog.Models.Post> Post{ get; set; }
    }
} 
```

您将 Tuple 对象发送到您的视图，如下所示：

```
@model: (Domain.Model.)Tuple  <--- (your exact model path )
@foreach (var item in Model.Gallery)
{
   @item.Name
} 
```

另一种可能性是使用 viewbag ...但我强烈建议您以正确的方式进行操作，即 MVC 方式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:42:38.103

试试这个

```
var posts = _db.Posts.OrderByDescending(x => x.DateTime).Take(4).ToList();
var galleries = _db.Galleries.OrderByDescending(x => x.ID).Take(4).ToList(); 
```

# ruby-on-rails - 在哪里使用 `FactoryGirl.build_stubbed` 以及在哪里使用 RSpec 的 `mock`/`double`

> ID：10836549
> 
> 赞同：21
> 
> 时间：2012-05-31T15:26:17.370
> 
> 标签：ruby-on-rails, ruby, unit-testing, rspec, factory-bot

我只是好奇人们在编写 RSpec 规范时倾向于在`FactoryGirl.build_stubbed`哪里使用以及他们在哪里使用。`double`也就是说，是否有诸如“仅在其相应的模型规范中使用 FactoryGirl 方法”之类的最佳实践？

当您发现自己`FactoryGirl.create(:foo)`在 spec/models/bar_spec.rb 中使用时，这是不是代码异味？

如果您`FactoryGirl.build_stubbed(:foo)`在 spec/models/bar_spec.rb 中使用，代码气味是否会减少？

如果您`FactoryGirl.create(:foo)`在 foos_controller_spec.rb 中使用，会不会是代码异味？

如果您`FactoryGirl.build_stubbed(:foo)`在 foos_controller_spec.rb 中使用，代码气味是否会减少？

如果您`FactoryGirl.build_stubbed(:foo)`在 spec/decorators/foo_decorator_spec.rb 中使用，会不会是代码异味？

抱歉问了这么多问题！我只是想知道其他人如何在单元测试隔离和面向对象设计最佳实践中划清界限。

谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-02T18:12:49.740

我相信有一些最佳实践可以指导我们考虑何时使用模拟（在本例中为“双打”）与针对实际依赖项进行集成（在本例中为“工厂”）。有一本关于测试的非常好的书（警告：它使用 Java 示例）描述了测试驱动开发的目的，我认为它对讨论 Rails 应用程序中的测试很有帮助。它描述了测试的意图如下：

> ...我们在测试驱动开发中的意图是使用模拟对象来显示对象之间的关系。
> 
> 弗里曼，史蒂夫；普赖斯，纳特（2009-10-12）。以测试为指导的不断发展的面向对象软件（Kindle Locations 3878-3879）。培生教育（美国）。Kindle版。

如果我们考虑强调使用测试驱动开发不仅是为了防止我们引入回归，而且是为了帮助我们思考我们的代码是如何根据其接口和与其他对象的关系来构造的，我们自然会在许多情况下使用模拟. 我将在下面描述这如何适用于您的具体问题。

首先，关于我们在模型测试中是使用模拟对象还是真正的依赖关系——如果我们正在测试类 Foo 及其对 Bar 的依赖关系，我们可能希望用模拟对象代替 Bar。通过这种方式，我们将清楚地看到与 Bar 的耦合级别，因为我们必须模拟将在其上调用的方法。如果我们发现我们的 Bar 模拟很复杂，这表明我们或许应该重构 Foo 和 Bar 以减少它们之间的耦合。

从某种意义上说，两者都`Factory.create`具有`Factory.build_stubbed`相同的效果，可以防止您显式地依赖相关类，我认为它们都一样臭，Factory.create 是两个选项中较慢的。

在我的测试中，我倾向于不太担心在控制器中模拟外部依赖项。我知道这比完全模拟运行起来要慢，而且你没有使控制器与模型显式耦合的好处，但是编写测试更快，而且我通常不担心明确控制器与其管理的持久记录之间的关系。只要你遵循“瘦控制器”的模式，这里就不应该担心太多的逻辑。如果我们需要在这里指定“测试气味”的级别，我会说它比依赖于其他工厂的模型测试要少一些。

我倾向于最不担心依赖于他们装饰的类的工厂的装饰器。这是因为根据定义，装饰器应该与它们所装饰的类保持相同的接口。装饰通常通过某种形式的继承来实现，无论是使用`method_missing`委托给被装饰者，或者通过被装饰者的显式子类化。正因为如此，如果装饰器与它所装饰的东西的接口偏离太多，你就会打破其他良好的面向对象编程规则，比如 Liskov Substitution。只要你的装饰没有通过打破良好继承的规则来糟糕地实现，与你装饰的类的耦合就已经存在，所以如果你对被装饰者的测试依赖于持久化或存根，这不会让事情变得更糟它装饰的东西的工厂。您可以在装饰器测试中对工厂发疯，这并不重要 IMO。

我认为重要的是要注意，即使您在大多数情况下更喜欢模拟，您仍然应该有一些使用真实依赖项的集成测试。您会发现这些涵盖了特定的高价值案例，其中独立的单元测试提供了对您的类提供的功能的更多覆盖。

无论如何，我有时会违反上述所有规则，它们只是我在编写测试时使用的一些指导方针。我期待听到其他人在他们的测试中如何使用工厂（build_stubbed 和真正持久化）与模拟对象（双打）。

# ruby-on-rails - any_instance should_receive 无法正常工作

> ID：10836551
> 
> 赞同：7
> 
> 时间：2012-05-31T15:26:21.903
> 
> 标签：ruby-on-rails, ruby, rspec, rspec-rails

我有这样的代码：

```
@dns = "#{params[:domain].split('/').reverse.join('.')}.#{params[:zone]}"
w = Whois::Client.new
@r = w.query(@dns) 
```

有一条路线：

```
match "domains/:zone/*domain" => "domains#show" 
```

我正在使用[Whois Gem](http://www.ruby-whois.org/)

我要测试的是，所以我有一个测试：

```
it "should query 'google.com.ua' from /ua/com/google" do
    get :show, :zone => 'ua', :domain => 'com/google'
    dns = "google.com.ua"
    Whois::Client.any_instance.should_receive(:query).with(dns)
end 
```

结果我得到：

```
Exactly one instance should have received the following message(s) but didn't: query 
```

问题可能出在哪里？我100%确定`.query`这叫

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-31T16:25:57.453

看起来您可能在调用查询方法之后设置期望？

# php - 使用 foreach 的双向数组到双向数组

> ID：10836552
> 
> 赞同：0
> 
> 时间：2012-05-31T15:26:22.277
> 
> 标签：php, foreach

嗨我有以下数组

```
array(4) {
  [0]=>
  array(3) {
    ["id_acreditado"]=>
    string(3) "174"
    ["cantidad"]=>
    string(7) "4008.00"
    ["acreditado"]=>
    string(27) "Olga Olivia Lucio Hernandez"
  }
  [1]=>
  array(3) {
    ["id_acreditado"]=>
    string(3) "175"
    ["cantidad"]=>
    string(7) "4008.00"
    ["acreditado"]=>
    string(23) "Enrique Carranco Vences"
  }
  [2]=>
  array(3) {
    ["id_acreditado"]=>
    string(3) "176"
    ["cantidad"]=>
    string(7) "4008.00"
    ["acreditado"]=>
    string(32) "Juana Patricia Contreras Paredes"
  }
  [3]=>
  array(3) {
    ["id_acreditado"]=>
    string(3) "177"
    ["cantidad"]=>
    string(7) "4008.00"
    ["acreditado"]=>
    string(17) "Noemi Cruz Campos"
  }
} 
```

我想用上述数组的一些值和不同的索引创建一个二维数组。我正在使用 foreach 循环来实现这一点。

```
$j=1;
foreach($acreditados as $acreditado){
    $tmp['oneCol'] = $j;
    $tmp['twoCol'] = $acreditado['acreditado'];
    $tmp['threeCol'] = $acreditado['cantidad'];
    $info['fourCol'] =$acreditado['id_acreditado'];
    $info[]=$tmp;
    $j++;
} 
```

$tmp 是一个辅助一维数组，最近添加为双维 $info 数组的一行，但是我没有得到预期的输出。我想要以下内容作为输出：

```
array(4) {
      [0]=>
      array(3) {
        ["oneCol"]=>
        int(1)
["twoCol"]=>
        string(27) "Olga Olivia Lucio Hernandez"
        ["threeCol"]=>
        string(7) "4008.00"
["fourCol"]=>
        string(3) "174" 
      }
      [1]=>
      array(3) {
 ["oneCol"]=>
        int(2)
["twoCol"]=>
        string(23) "Enrique Carranco Vences"
        ["threeCol"]=>
        string(7) "4008.00"
["fourCol"]=>
        string(3) "175"
      }
      [2]=>
      array(3) {
 ["oneCol"]=>
        int(3)
       ["twoCol"]=>
        string(32) "Juana Patricia Contreras Paredes"
        ["threeCol"]=>
        string(7) "4008.00"   
 ["fourCol"]=>
        string(3) "176"
      }
      [3]=>
      array(3) {
 ["oneCol"]=>
        int(4)
       ["twoCol"]=>
        string(17) "Noemi Cruz Campos"
        ["threeCol"]=>
        string(7) "4008.00"
 ["fourcol"]=>
        string(3) "177"
      }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:35:24.040

你有一个代码错误

线

```
$info['fourCol'] =$acreditado['id_acreditado']; 
```

应该

```
$tmp['fourCol'] =$acreditado['id_acreditado']; 
```

所以代码显示为：（添加了 $tmp 数组重置）

```
$j=1;
foreach($acreditados as $acreditado){
    $tmp = array();
    $tmp['oneCol'] = $j;
    $tmp['twoCol'] = $acreditado['acreditado'];
    $tmp['threeCol'] = $acreditado['cantidad'];
    $tmp['fourCol'] =$acreditado['id_acreditado'];
    $info[] = $tmp;
    $j++;
} 
```

# java - 将 Spring MVC 中的路由映射到不同文件夹路径的简单方法

> ID：10836554
> 
> 赞同：0
> 
> 时间：2012-05-31T15:26:28.183
> 
> 标签：java, javascript, spring, spring-mvc, url-routing

在我的文件系统中，我有一个`webapp`目录，它是我的 Web 应用程序的根目录，它有`js`、`css`和`images`、 子目录（以及其他）。

但是（出于我不会讨论的原因）我的组织希望在`/app/`我们的资源前面加上前缀。因此 HTML 中的标签类似于：

```
<script type="text/javascript" src="/app/js/folder/file.js"></script> 
```

请求`localhost:port/js/folder/file.js`有效，`localhost:port/app/js/folder/file.js`但无效（目前预期）。

有没有一种简单的方法让 Spring MVC 知道当它看到 /app/js/* 删除 /app/ 并从中提供文件`webapp/js/`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T02:29:56.920

尝试在 dispatcher-servlet.xml 文件中指定以下配置。

```
<mvc:resources location="/js/" mapping="/app/js/**"/>
<mvc:resources location="/css/" mapping="/app/css/**"/>
<mvc:resources location="/images/" mapping="/app/images/**"/> 
```

希望这对你有帮助。

干杯。

# google-maps - 如何在谷歌地图几何库中使用 containsLocation。

> ID：10836559
> 
> 赞同：5
> 
> 时间：2012-05-31T15:26:44.087
> 
> 标签：google-maps, google-maps-api-3

我正在尝试使用`containsLocation`Google 几何库中的 ，但无法使其正常工作...

```
var point = new google.maps.LatLng(51.331, 3.538);
var poly = [
 new google.maps.LatLng(51.401818509550615, 3.547626782103622),
 new google.maps.LatLng(51.397574277049365, 3.563607598960424),
 new google.maps.LatLng(51.398540111384975, 3.567880788749134),
 ... // it is a lot bigger
];

if(google.maps.geometry.poly.containsLocation(point, poly) == true) {
 alert("yes");
} 
```

Javascript 控制台给出了一个错误，但这指向了 Google 库中的一个函数。所以我认为问题应该出在这个函数的某个地方。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T15:31:40.450

好吧，我傻了

使用所有坐标作为数组是错误的，我必须使用创建的多边形对象。

```
var polyOptions = {
 ...
}

draw = new google.maps.Polygon(polyOptions);
draw.setMap(map);

if(google.maps.geometry.poly.containsLocation(point, draw) == true) {
 alert("yes");
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-26T16:33:58.153

我有同样的问题`([object Object])`，我可以解决这样创建多边形变量的问题： `draw = new google.maps.Polygon({paths:polyOptions});`

然后问题就消失了。

# php - 如何与应用发明者发送文件？

> ID：10836561
> 
> 赞同：0
> 
> 时间：2012-05-31T15:26:48.707
> 
> 标签：php, android, app-inventor

如何与应用发明者发送文件？您知道 PostFile 的示例或教程吗？我试试这个：

```
Button1.clik
Web1.Url to http://mysite.com/test.php
web1.PostFile path Image1.Picture
Web1.PostText text this is my image 
```

但是在我的 test.php 中我写了什么？

![在此处输入图像描述](../Images/c1bd96b91112d8c444fbc65f9cddc968.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T14:29:34.790

此步骤可能会帮助您找到正在寻找的答案[https://groups.google.com/forum/?fromgroups#!topic/app-inventor-php-api-services/6WuJ-azfbSQ](https://groups.google.com/forum/?fromgroups#!topic/app-inventor-php-api-services/6WuJ-azfbSQ)。我希望这会有所帮助

# javascript - 如何为 href 标签编写 onclick 事件

> ID：10836566
> 
> 赞同：-4
> 
> 时间：2012-05-31T15:27:09.720
> 
> 标签：javascript, jquery, asp.net, asp.net-mvc, asp.net-mvc-2

任何人都可以帮我在href标签上的onClick事件上写这个吗？

```
 string x= "<a href=\"JavaScript:callfunction(event,'"+ y.id.tostring() + "');\">click</a>"; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T15:30:51.930

```
string x = string.Format(
    "<a href=\"#\" onclick=\"callfunction(event, '{0}')\">click</a>", 
    y.id
); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-31T15:29:54.343

为什么不这样：

```
string x= "<a href=\"#\" onclick=\"callfunction(event,'"+ y.id.tostring() + "');\">click</a>"; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T15:32:15.833

只是一种使用 DOM 负责方法来完成此类任务的替代方法

```
var x     = document.createElement('a');
x.href    = "#";
x.onclick = function(evt) {
   callfunction(evt, y.id.tostring())
}

<destination-node>.appendChild(x); 
```

# css - 从richfaces 3到richfaces 4的css迁移

> ID：10836569
> 
> 赞同：2
> 
> 时间：2012-05-31T15:27:17.067
> 
> 标签：css, jsf, migration, richfaces

我们正在从 RichFaces 3.3.3 升级到 RichFaces 4.2.0。似乎元素 css 类名称已更改，但我找不到旧名称和新名称之间的任何映射。我们的项目中有很多自定义 css 规则用于丰富的组件，所以如果我们不能将自定义 css 转换为新名称，我们必须推迟迁移 :(

有谁知道这样的映射表？

谢谢！彭蒂克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T07:35:57.670

开发人员指南 [1] 中记录了所有 CSS 类。尽管没有 3.x -> 4.x 映射，但它仍然可能有用。

[1] [http://docs.jboss.org/richfaces/4.2.X/4.2.2.Final/Developer_Guide/en-US/html_single/#appe-Developer_Guide-Style_classes_and_skin_parameters](http://docs.jboss.org/richfaces/4.2.X/4.2.2.Final/Developer_Guide/en-US/html_single/#appe-Developer_Guide-Style_classes_and_skin_parameters)

# google-maps-api-3 - 从 CSV 文件映射数据

> ID：10836578
> 
> 赞同：0
> 
> 时间：2012-05-31T15:27:35.327
> 
> 标签：google-maps-api-3

是否可以从 csv 文件中提取我的地图数据？在这里看到它：http: [//calwestculture.com/sgs/example_map.html](http://calwestcultural.com/sgs/example_map.html)

# linux - Linux：如何在 svn 中设置“全局”用户/密码/组文件

> ID：10836587
> 
> 赞同：4
> 
> 时间：2012-05-31T15:28:08.207
> 
> 标签：linux, svn, configuration, passwd, authz

我正在尝试在 Linux 上设置对我所有 svn 存储库的全局用户/组访问权限。由于我对 svn / linux 东西很陌生，有人可以看看我设置了什么。我仍然收到“无效的身份验证配置”。这是我如何进行的：

* * *

Svn 安装/正常工作。服务路径`home/svn/repos/`。

“my_project”创建，使用简单的身份验证工作。路径是`home/svn/repos/my_project/`。

我的“全局”用户/密码+组文件`/home/svn/passwd`

```
[groups]
team_a = tom, sim
team_b = jake, roy
prod = frank
[users]
tom = j9uems
sim = 90uifs
jake = fd9j8p
roy = 8ujwek
frank = 8jfjel 
```

我的配置文件`home/svn/repos/my_project/conf/svnserve.conf`

```
[general]
anon-access = none
auth-access = write
password-db = /home/svn/passwd
authz-db = authz 
```

我的授权文件`home/svn/repos/my_project/conf/authz`

```
[/]
# this project is a team_a project. But jake can have a read acces to it
@team_a = rw
@team_b =
jake = r
@prod = r 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T19:31:58.120

好的，我找到了一种更好的方法来设置全局身份验证/访问。如果这些信息可以帮助...

要删除或创建新用户，我使用了一个全局“passwd”文件（**没有组！**）`/home/svn/passwd`

```
[users]
tom = j9uems
sim = 90uifs
jake = fd9j8p
roy = 8ujwek
frank = 8jfjel 
```

为了管理组和对服务器上存储库的全局访问，我使用了一个全局“authz”文件`/home/svn/authz`

```
[groups]
team_a = tom, sim
team_b = jake, roy
prod = frank

[my_project:/]
# access denied for everyone
* =
@team_a = rw
jake = r
@prod = r 
```

所有存储库必须具有**相同的 svnserve.conf** `home/svn/repos/my_project/conf/svnserve.conf`

```
[general]
anon-access = none
auth-access = write
password-db = /home/svn/passwd
authz-db = /home/svn/authz 
```

* * *

请注意，可以向任何组/用户授予对任何 repos 的任何路径的访问权限。例如，如果“prod”组需要对该项目的“production”文件夹具有完全访问权限，则可以：

```
[my_project:/production]
@prod = rw 
```

# c++ - 类成员和显式堆栈/堆分配

> ID：10836591
> 
> 赞同：39
> 
> 时间：2012-05-31T15:28:26.753
> 
> 标签：c++, memory, memory-management, heap-memory, stack-memory

假设我们有 4 个类，如下所示：

```
class A
{
    public:           
        A(void) : m_B()
        {
        }
    private:
        B m_B;
}

class B
{
    public:            
        B(void)
        {
           m_i = 1;
        }
    private:
        int m_i;
}

class C
{
    public:           
        C(void) 
        {
            m_D = new D();
        }
        ~C(void) 
        {
            delete m_D;
        }
    private:
        D *m_D;
}

class D
{
    public:           
        D(void)
        {
           m_i = 1;
        }
    private:
        int m_i;
} 
```

假设有4种情况：

情况1：A外部分配在栈上，B内部分配在栈上

```
A myA1; 
```

情况2：A外部分配在堆上，B内部分配在栈上

```
A *myA2 = new A(); 
```

情况 3：C 外部分配在堆栈上，D 内部分配在堆上

```
C myC1; 
```

情况4：C外部分配在堆上，D内部分配在堆上

```
C *myC2 = new C(); 
```

在每种情况下会发生什么？比如情况2，我理解指针myA2是在栈上分配的，A对象存在于堆中，但是m_B属性呢？我假设堆上的空间也为其分配，因为对象存在于堆空间中没有意义，然后它的属性超出范围。如果这是真的，那么这是否意味着外部堆分配会覆盖内部堆栈分配？

情况 3 怎么样，myC1 分配在堆栈上，但是 m_D 分配在堆上。这里会发生什么？这两部分是否在内存中分开？如果我从析构函数中删除了“删除 m_D”并且 myC1 超出范围，那么在堆上为 m_D 分配的空间是否会出现内存泄漏？

如果有任何教程/文章详细介绍了这个，我会喜欢一个链接。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-05-31T16:03:54.873

I think that you are confusing "stack/heap allocation" and "automatic variable".

**脱离上下文时，自动变量**会自动销毁。

**堆栈分配**是在执行堆栈上分配内存的事实。分配在堆栈上的变量是自动变量。

此外，**成员是自动变量**，其析构函数在其所有者被销毁时被调用。在指针的情况下，它们被销毁但不是底层对象，您必须显式调用 delete。为确保底层对象被销毁，您必须使用智能或唯一指针。

换句话说：必须调用 delete 的变量/成员不是自动变量。

最后，类的成员分配在其所有者的同一内存段上。

在你的代码中：

*   `A.m_B`是一个自动变量。如果 A 在堆栈上，那么 B 也是，如果 A 在堆上，那么 B 也是。
*   `B.m_i`和 D.m_i 是自动变量，将分配在其所有者的同一内存段上
*   **指针** 是自动变量，但 D 类型的`C.m_D`指向对象不是，您必须在指针上显式调用 delete 才能删除底层对象。因此，指针 C.m_D 分配在同一内存段上，而不是底层对象。它显然是由 new 分配的，并且将在堆上。

所以：

*   **案例1：**一切都在堆栈上并且是自动的（即：自动销毁）。
*   **案例2：** `myA2`在堆上而不是自动的（你必须`delete myA2`）。它的成员`m_B2`是一个自动变量，当被销毁时将被`myA2`销毁。此外，由于`myA2`在堆上，因此`m_B`与类的任何成员一样，也位于堆的同一内存空间中。
*   **情况3：** `myC1`在栈上，是一个自动变量，指向的指针`m_D`也在栈上，但不是`m_D`堆上new分配的指向的对象。
*   **案例 4：**与案例 3相同，但`myC2`在堆上且不是自动的。所以你必须删除`myC2`（这将删除`m_D`）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-31T15:37:51.787

案例1：“堆栈”上的所有内容（自动存储）。当您退出范围时，资源会被释放。

情况2：`myA2`在“堆”上，它也是`m_B`，你只需要担心释放被占用的资源`myA2`。它`m_B`会在 is 时自动销毁`myA2`。

情况3：`myC1`在堆栈上，它`m_D`指向`D`堆上的a，但`C`析构函数负责删除它，因此`myC1`超出范围，所有动态分配的资源都被清除。

情况4：`myC2`动态分配，必须删除它才能释放它占用的资源。删除它将调用它的构造函数，而后者又会处理它`m_D`，如案例 3。

I am not sure about articles, I am sure there are plenty around. But I suggest reading some [good C++ books](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T15:42:35.627

Your object is a piece of organised memory. Object does not allocate it's members on the stack, it just consists of it's members.

Case 2: the whole object exists in the heap, this means that all it's members lie in the heap.

Case 3: the *whole* object exists on the stack. The trick is that it's not `D` class instance who is member of `myC1`, but *pointer-to-B* is *physically* member of `myC1`. So member of `myC1` lies on stack and points to some `D` instance that lies in the heap.

# select - 根据多个值选择行 SQL

> ID：10836592
> 
> 赞同：1
> 
> 时间：2012-05-31T15:28:30.667
> 
> 标签：select, where, postgresql-9.1

我需要帮助才能用 SQL 编写此代码：

我有一张桌子，我想用字符 A、B 或 C 选择否，但如果我有相同的 A 和 B，否我只想显示 B，否则我需要显示所有。

伪代码：

```
SELECT *
  FROM Table1
  WHERE IF EXISTS (Char = A and Char = B)
    THEN Char IN (B, C)
    ELSE Char IN (A, B, C) 
```

例子：

表格1

```
ID  No     Char
1   10     A
2   10     B
4   10     C
5   11     A
6   11     D
7   12     C 
```

我想要结果：

```
ID  No     Char
2   10     B
4   10     C
5   11     A
7   12     C 
```

我需要什么是否足够清楚？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:49:11.487

```
select t1.Id, t1.No, t1.Ch from Table1 t1
where t1.Ch IN ( 'B', 'C')
UNION
select t1.Id, t1.No, t1.Ch from Table1 t1
where t1.Ch ='A' 
and not exists (select null from Table1 t2 where t2.No = t1.No  and t2.Ch='B') 
```

我在 Ch 中更改了 Char，因为 Char 可能是保留的关键字...

用 Sql Server 测试，但我认为查询是 ANSI SQL

[http://sqlfiddle.com/#!3/f2145/12](http://sqlfiddle.com/#!3/f2145/12)

或者

```
select t1.Id, t1.No, t1.Ch from Table1 t1
where t1.Ch IN ( 'B', 'C')
OR (t1.Ch ='A'
and not exists (select null from Table1 t2 where t2.No = t1.No  and t2.Ch='B')) 
```

# php - 使用 PHP Sessions 保存表单数据

> ID：10836594
> 
> 赞同：0
> 
> 时间：2012-05-31T15:28:36.557
> 
> 标签：php, forms, session

我在 PHP 中创建了一个小测验，它会询问您一系列是/否问题，然后在最后告诉您答案。我正在尝试使用 PHP 会话，这样如果用户只完成了测验的一半，例如，当他们关闭浏览器并重新打开它时，它将与他们离开时的问题相同。下面是我正在使用的一种形式的代码。

```
<div class='questions'>
  <form method ='GET' action='Creatures.php'>
    <input type='submit' name='answer$number' value='Yes' class='buttons' />
    <input type='submit' name='answer$number' value='No' class='buttons' />
  </form>
</div> 
```

如果您想查看测验，请访问[s504518.brunelweb.net/Creatures.php](http://s504518.brunelweb.net/Creatures.php) 。我不知道如何做到这一点，因为我以前没有使用过会话，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T16:24:08.063

您不能使用 PHP 会话来执行此操作，因为关闭浏览器时会话会被​​破坏。

为了实现您提到的内容，您应该将最终用户的答案保存到 cookie 中，并在最初加载页面时检查它是否存在。

看看[http://php.net/manual/en/function.setcookie.php](http://php.net/manual/en/function.setcookie.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T16:06:12.443

如果用户已注册，请将其存储在数据库中。这通常是最好的选择。Cookie 可以工作，但你有可能出现问题。

另外-如果我没看错，答案`$number`不会用单引号连接。要么是：

`echo " name='answer$number' "`（在双引号中回显）或`echo 'name="answer'.$number.' " '`（在单引号中回显）。这是节俭的，但可能会产生误导。我用引号隔开以表示差距，但是应该优先删除这些。

我相信数据库是最安全的方式。您始终可以使用 cookie 将用户链接到他们的答案。另外 - 数据库稍后会为您提供统计信息。这样，即使用户以某种方式丢失了他们的 cookie，他们也可以随时输入他们的电子邮件地址以继续。

是的，当浏览器关闭时会话总是被终止（只是为了确认）。

# django - syncdb 后 Django 模型未显示在数据库中

> ID：10836595
> 
> 赞同：6
> 
> 时间：2012-05-31T15:28:36.953
> 
> 标签：django, model, syncdb

我有一个模型文件夹，其中包含数据库中已经存在的文件中的一些模型。我刚刚添加了另一个文件/模型，但是当我运行 syncdb 时它没有被添加到数据库中。我试过 manage.py validate 并且运行良好。我也运行了代码，只有当它尝试使用“表不存在”保存时才会失败。

原来的结构是这样的：
/models
-- **__ *init* __** .py
-- file1.py
-- file2.py

和**__ *init* __** .py 看起来像：

```
from file1 import File1Model
from file2 import File2Model 
```

我添加了 file3.py
/models
-- **__ *init* __** .py
-- file1.py
-- file2.py
-- file3.py

并修改**了 __ *init* __** .py

```
from file1 import File1Model
from file2 import File2Model
from file3 import File3Model 
```

和 file3 的内容（名称可能已更改以保护无辜者，但除此之外它的确切文件）：
更新：刚刚尝试添加主键，因为 id 字段可能已与自动添加的整数主键 id 混淆。还尝试了一些变化，但没有骰子。

```
from django.db import models
from django.contrib.auth.models import User

class File3Model(models.Model):
    user = models.OneToOneField(User)
    token = models.CharField(max_length=255, blank=False, null=False)
    id = models.CharField(primary_key=True, max_length=255)

    class Admin:
        pass

    class Meta:
        app_label = 'coolabel'

    def __unicode__(self):
        return self.user.username

    @staticmethod
    def getinstance(user, token, id):
        try:
            instance = File3Model.objects.get(pk=id)
            if instance.token != token:
                instance.token = token
                instance.save()
            return instance
        except:
            pass
        instance = File3Model()
        instance.user = user
        instance.token = token
        instance.id = id
        instance.save()
        return instance 
```

所以在这个例子中，File1Model 和 File2Model 已经在 DB 中，并且在 syncdb 之后仍然在 DB 中。但是，即使重新运行 syncdb，也不会添加 File3Model。有什么办法可以弄清楚为什么没有添加新模型？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-31T16:23:09.333

如果您在 models.py 之外定义模型，则必须`app_label`在模型`Meta`类上设置属性。

编辑：必须在您的设置`app_label`中引用应用程序。`INSTALLED_APPS`它可能应该与模型目录所在的应用程序的名称相匹配，除非您有充分的理由不这样做。这似乎是你的问题。

```
class File3Model(models.Model):
    foo = models.CharField(...)
    ...

    class Meta:
        app_label = "my_app" 
```

请注意，`syncdb`永远不会从数据库中删除任何表。其他表可能是在将 models.py 替换为目录结构之前使用 syncdb 创建的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-05T00:36:38.343

将 app_label 设置为我的应用程序可以解决我的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T16:33:47.783

为什么要拆分模型并使用模型文件夹而不是将模型放入其中`models.py`？

在我自己的项目中，大约有 10 个模型`models.py`，我很好。

你也可以试试`manage.py syncdb --all`。

而且我认为最好将所有模型保存在一个文件中并像导入它们一样导入它们，`from my_app.models import model_name`而不是记住将必要的模型导入`models/__init__.py`. 顺便说一句，您可以避免许多问题和冗长的导入，并且不关心文件`some_model`之间的位置`models/*.py`。

谢谢，

苏丹

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T08:13:46.107

繁荣！

我为新模型使用了不同的 app_label，但它在模型组中必须相同。

其他模型标签是“mediocrelabel”，我的新模型有标签“coolabel”。我将新模型的标签更改为“mediocrelabel”，现在它们已正确添加到数据库中。

谢谢你的帮助，伙计们！

# php - 链接方法类中需要更改的内容

> ID：10836603
> 
> 赞同：0
> 
> 时间：2012-05-31T15:29:06.677
> 
> 标签：php

我有以下课程，我想实现链接方法。我有点自学，所以我认为测试链接会很好。然而那没有用。我需要做什么

```
echo $animal->name.'  says'.$animal->speak()->likes()."<br />"; 
```

这是我的完整代码

```
<?php 
class Animal{

    var $name;
    function __construct(){

        $this->name = $name;

    }

}

class Dog extends Animal{

    public function speak(){

        return "Woof Woof";

    }
    public function likes(){

        return "steaks";

    }

}

class Cat extends Animal{

    public function speak(){

        return "Meow Meow";

    }

    public function likes(){

        return "tuna";

    }

}

$animals = array(new Dog('skippy'), new Cat('snowball'));
foreach($animals as  $animal){
    echo $animal->name.'  says'.$animal->speak()->likes()."<br />"; 

}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:35:06.817

```
<?php
class Animal {
  function speak() {
    echo "Random Noise!\n";
    return $this;
  }
}

class Dog extends Animal {
  function bark() {
    echo "bark!\n";
    return $this;
  }
}
$a = new Dog();
$a->speak()->bark(); 
```

您需要返回`$this`以链接您的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:33:13.423

如果你想链接方法，你需要`$this`在链接的方法中返回。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-05-31T15:49:45.423

尝试写而不是

```
echo $animal->name.'  says'.$animal->speak()->likes()."<br />"; 
```

那 ：

```
printf('%s says %s %s',@animal->name,$animal->speak()->likes()); 
```

# jquery - 有没有办法在为 Iphone（移动网站）滚动 jquery 时加载数据

> ID：10836607
> 
> 赞同：2
> 
> 时间：2012-05-31T15:29:12.307
> 
> 标签：jquery, iphone, scroll, loaddata

有没有办法在为 Iphone（移动网站）滚动 jquery 时加载数据。此示例适用于 Safari、Chrome 但不适用于 iPhone： [http ://www.webresourcesdepot.com/dnspinger/](http://www.webresourcesdepot.com/dnspinger/)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T12:00:44.410

是的，有一种方法——最好的方法是向服务器端页面发起 AJAX 请求，以从数据库中检索更多数据。

您提到的网站就是这样做的，但是在设备上您需要考虑 URL 框，我相信这是 60px？

```
$(window).scroll(function () {
    $(window).scrollTop() + 60 == ($(document).height() - $(window).height()) {
        doFunction();
    }
});

doFunction() {
    $.post('getPosts.php?action=loadmore&endId=' + $('.element:last').attr('id'));

    function(data) {
        if (data != '') {
            $(".element:last").after(data);
        }
    }
} 
```

这只是你如何做到这一点的一个例子？

# c++ - 将文件读入内存的最快技术？

> ID：10836609
> 
> 赞同：11
> 
> 时间：2012-05-31T15:29:20.140
> 
> 标签：c++, windows, file, memory

是否有一种普遍接受的最快技术用于在 C++ 中将文件读入内存？

我只会阅读文件。

我已经看到 boost 有一个实现，我在这里看到了其他几个实现，但我想知道什么被认为是最快的？

先感谢您

万一这很重要，我正在考虑最大 1GB 的文件，这适用于 Windows。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T15:37:31.383

使用[内存映射文件](http://msdn.microsoft.com/it-it/library/ms810613.aspx)，也许使用[boost 包装器](http://www.boost.org/doc/libs/1_47_0/doc/html/interprocess/sharedmemorybetweenprocesses.html#interprocess.sharedmemorybetweenprocesses.mapped_file)来实现可移植性。

如果要读取大于虚拟地址空间的空闲连续部分的文件，可以随意移动文件的映射部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-31T15:37:03.483

考虑为您的情况使用[内存映射文件](http://msdn.microsoft.com/en-us/library/ms810613.aspx)，因为这些文件的大小可达 1 GB。

*   [内存映射文件及其工作方式](http://blogs.msdn.com/b/khen1234/archive/2006/01/30/519483.aspx)

在这里你可以从 win32 API 开始：

*   [MapViewOfFile](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366761%28v=vs.85%29.aspx)

MSDN 页面上还有其他几个有用的 API。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T15:43:31.613

如果内存映射文件不足以满足您的应用程序，并且文件 I/O 是您的瓶颈，那么使用[I/O 完成端口](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365198%28v=vs.85%29.aspx)来处理文件上的异步 I/O 将是您在 Windows 上获得的最快速度。

> I/O 完成端口为在多处理器系统上处理多个异步 I/O 请求提供了一个高效的线程模型。当一个进程创建一个 I/O 完成端口时，系统会为请求创建一个关联的队列对象，这些请求的唯一目的是为这些请求提供服务。处理许多并发异步 I/O 请求的进程可以通过将 I/O 完成端口与预先分配的线程池结合使用，而不是通过在接收 I/O 请求时创建线程来更快、更有效地完成此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T15:39:32.693

一般来说，[mmap](http://en.wikipedia.org/wiki/Mmap)就是这样。但是在 Windows 中，他们发明了自己的方法，请参阅[“文件映射”](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366556%28v=vs.85%29.aspx)。Boost 具有[Memory-Mapped Files](http://www.boost.org/doc/libs/release/libs/iostreams/doc/classes/mapped_file.html)库，可将两种方式都包装在可移植的代码堆中。

此外，如果您想要快速，则必须针对您的用例进行优化。仅仅将文件内容映射到内存是不够的。例如，您确实可能不需要内存映射文件，最好使用异步文件 I/O。许多问题有许多解决方案。

# javascript - 使用 javascript 加载部分内容

> ID：10836611
> 
> 赞同：1
> 
> 时间：2012-05-31T15:29:21.277
> 
> 标签：javascript, ajax, html, mootools

所以，现在我想加载一个页面布局，然后使用 AJAX 加载内容。我正在使用 Mootools`Request.HTML`解析 HTML 响应。这里的事情是页面中的 javascript 内容，内联 javascript 总是立即执行，但是，外部 javascript 没有执行（评估）。

为了测试这一点，我创建了一个`<span>`用当前日期更新 a 的内联脚本，然后我创建了一个具有相似内容的外部文件（这个是为了更新 other `<span>`）。第一个（内联）在加载内容时执行，第二个（外部）不执行。

对于那些想知道我打算如何处理的人：我将使用新的 HTML5 `history.pushState`+ AJAX 部分加载页面，以一种更快的方式加载给用户并稍微减轻服务器的负担（因为它会提供更少的请求）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T05:31:53.973

[`Request.HTML`](http://mootools.net/docs/core/Request/Request.HTML)有一个选项：`evalScripts`您可以选择评估或不评估返回的 HTML 中包含的脚本。

所以它可能是：

```
var myHTMLRequest = new Request.HTML({
    url: '/loadMe.html',
    evalScripts: true
}).get(); 
```

# mysql - Mysql Workbench：如何从远程机器查看服务器上的日志？

> ID：10836614
> 
> 赞同：2
> 
> 时间：2012-05-31T15:29:28.077
> 
> 标签：mysql, mysql-management, mysql-workbench

我正在运行 mysql 服务器，并希望使用 Workbench->Server Administration->Server Logs 查看远程机器上的日志。

但我收到如下消息：

```
You have not enabled reroute administration for this server.
Please enable remote administration for this server instance and try again. 
```

如何启用远程管理，它到底是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T09:47:38.123

在 Workbench 的主页中，在 Server Administration 部分下方，有**Manage Server Instances**。通过单击那里，您可以选择您的服务器并在该窗口上启用远程管理。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-10-19T10:26:46.020

1.  ssh 到服务器
2.  编辑 /etc/my.cnf mysql 配置文件
3.  确保 line skip-networking 被注释或删除行
4.  添加行：bind-address=YOUR-SERVER-IP 你的服务器 IP 是 mysql 服务器 ip
5.  重启mysql

# javascript - 通过codeigniter在javascript中设置文件路径

> ID：10836616
> 
> 赞同：0
> 
> 时间：2012-05-31T15:29:32.200
> 
> 标签：javascript, codeigniter-2

我正在使用代码点火器 2.1。我正在使用 js 文件来显示树视图。视图显示正确，但链接的图像未显示。在视图中，我调用了一个名为 dtree.js 的 js 文件，其中图像路径设置为：

```
this.icon = {

        root            : 'images/Crystal_Clear_user.gif',

        folder          : 'img/folder.gif',

        folderOpen      : 'img/folderopen.gif',

        node            : 'img/page.gif',

        empty           : 'img/empty.gif',
}; 
```

当我在浏览器中调试我的代码时，它显示它找不到实际的文件路径。浏览器将代码读取为

```
<img id="jmytree0" src="img/nolines_plus.gif" alt /> 
```

我该如何解决这个问题。我的意思是如何更改js文件

```
'images/Crystal_Clear_user.gif' 
```

这可以在codeigniter中正常工作。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:50:35.750

在路径的开头附加一个“/”

```
this.icon = {

        root            : '/images/Crystal_Clear_user.gif',

        folder          : '/img/folder.gif',

        folderOpen      : '/img/folderopen.gif',

        node            : '/img/page.gif',

        empty           : '/img/empty.gif',
}; 
```

ps您将一些图像列为“图像”，而将一些图像列为“img”-对吗？

# c# - 当前上下文中的 SSIS 脚本组件 FireError DNE

> ID：10836619
> 
> 赞同：2
> 
> 时间：2012-05-31T15:29:37.190
> 
> 标签：c#, ssis, components

我正在尝试向 SSIS C# 脚本组件（在数据流中）添加更多本机错误处理。现在我强迫它用 1/0 使组件崩溃，这可行但很骇人听闻。

我的脚本对输入数据做了一些爵士乐，但我想在几个步骤中验证它，如果任何验证失败，则组件失败。源是一个选择，所以我不需要回滚任何事务等......但我希望组件使数据流失败，因此数据流组件将失败并遵循我在控制流中规定的错误处理。

这是阻碍我的最简单的相关片段：

```
using System;
using System.Data;
using Microsoft.SqlServer.Dts.Pipeline.Wrapper;
using Microsoft.SqlServer.Dts.Runtime.Wrapper;

[Microsoft.SqlServer.Dts.Pipeline.SSISScriptComponentEntryPointAttribute]
public class ScriptMain : UserComponent
{

public override void PreExecute()
{
    base.PreExecute();
    /*
      Add your code here for preprocessing or remove if not needed
    */

    bool pbCancel = false;
    ////check Row Count>0
    if (Variables.WeeklyLRrowCount == 0)
        this.ComponentMetaData.FireError(-1, "", "Fails Validation due to Empty Table.", "", 0, out pbCancel);
}

public override void PostExecute()
{
    base.PostExecute();
    /*
      Add your code here for postprocessing or remove if not needed
      You can set read/write variables here, for example:
      Variables.MyIntVar = 100
    */

}

public override void Input0_ProcessInputRow(Input0Buffer Row)
{
    /*
      Add your code here
    */

}

} 
```

我从 SSIS 得到以下信息：

```
"The name 'FireError' does not exist in the current context." 
```

我在这里缺少什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T16:55:03.857

您应该将代码移至 PostExecute 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T17:14:59.463

“通常，**在组件设计期间**，当组件配置不正确时，会调用 FireError、FireInformation 和 FireWarning 方法来提供用户反馈。”

[http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.dts.runtime.idtscomponentevents(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.dts.runtime.idtscomponentevents(v=sql.105).aspx)

如果我没看错的话，这不是在脚本任务中用于运行时使用，而是在设计时使用自定义组件来指示配置错误。

来自[http://msdn.microsoft.com/en-us/library/ms135912(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms135912(v=sql.105).aspx)的代码 可能是您想要的。

```
public override void RegisterEvents()
{
string [] parameterNames = new string[2]{"RowCount", "StartTime"};
ushort [] parameterTypes = new ushort[2]{ DtsConvert.VarTypeFromTypeCode(TypeCode.Int32),   DtsConvert.VarTypeFromTypeCode(TypeCode.DateTime)};
string [] parameterDescriptions = new string[2]{"The number of rows to sort.", "The start time of the Sort operation."};
EventInfos.Add("StartingSort","Fires when the component begins sorting the rows.",false,ref parameterNames, ref paramterTypes, ref parameterDescriptions);
}
public override void ProcessInput(int inputID, PipelineBuffer buffer)
{
while (buffer.NextRow())
{
   // Process buffer rows.
}

IDTSEventInfo100 eventInfo = EventInfos["StartingSort"];
object []arguments = new object[2]{buffer.RowCount, DateTime.Now };
ComponentMetaData.FireCustomEvent("StartingSort", "Beginning sort operation.", ref arguments, ComponentMetaData.Name, ref FireSortEventAgain);
} 
```

# php - 如何使用 GD 库从上传的文件中自动创建缩略图

> ID：10836631
> 
> 赞同：0
> 
> 时间：2012-05-31T15:30:14.910
> 
> 标签：php, jquery, ajax, gd

我如何创建自动翻滚..我需要在上传原始图像时自动创建拇指并在文件夹中添加拇指（大小 200 x 200）并在数据库 $thumb 中插入拇指路径..我需要帮助..任何人都可以帮助我?

```
 <?php
error_reporting(0);
if ($_POST['submit'])
{
  $name=basename($_FILES['file_upload']['name']);   
  $t_name=$_FILES['file_upload']['tmp_name'];
  $dir='upload';
  $image_title=$_POST['image_title'];
  $image_details=$_POST['image_details'];
  $image_text=$_POST['image_text'];
  $cat=$_POST['cat'];
  $thumb=$_POST['thumb'];

if(move_uploaded_file($t_name,$dir."/".$name))
   {
mysql_select_db ($db_name,$conn);
$qur="insert into images (mid, cid, name, path, image_title, image_details, image_text, thumb, addGby, addGon) 
values('','$cat','$name','upload/$name','$image_title','$image_details','$image_text','$thumb','$session_name',now())";
$res=mysql_query($qur,$conn);
echo 'File Upload sussfully';
}
else
{
echo 'upload filed!';
}
}
?>

<form method="post" action="Addgallery.php" enctype="multipart/form-data">

<div class="field">
<label>image : </label>
<input type="file" class="custom-file-input" name="file_upload" id="file_upload"  />
</div>

<div class="field fullwidth last">
<input type="submit" name="submit" value="upload" class="bt blue large"  />
</div>
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:56:49.393

如果您不想编写自己的代码，请尝试这些

[http://phpthumb.sourceforge.net/](http://phpthumb.sourceforge.net/)

[http://davidwalsh.name/create-image-thumbnail-php](http://davidwalsh.name/create-image-thumbnail-php)

[http://webcheatsheet.com/php/create_thumbnail_images.php](http://webcheatsheet.com/php/create_thumbnail_images.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:56:01.333

你应该试试 imgBrowz0r [http://freecode.com/projects/imgbrowz0r](http://freecode.com/projects/imgbrowz0r) 这是一个 php 编写的插件

Css-tricks 也有关于它的教程。

# java - GWT Windows 小工具显示不正确

> ID：10836633
> 
> 赞同：0
> 
> 时间：2012-05-31T15:30:17.803
> 
> 标签：java, gwt, windows-desktop-gadgets

我使用 GWT 创建了一个 Windows 小工具（Windows 侧边栏小工具），但它显示不正确。在 IE 中它看起来不错，但小工具显示为一个小白框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:30:19.880

您应该在 gwt.xml 中使用 ie6 用户代理和单脚本链接器：

```
<set-property name="user.agent" value="ie6" />
<add-linker name="sso"/> 
```

# android - 如何在按下的 ListItem 上指定 android:textColor？

> ID：10836636
> 
> 赞同：1
> 
> 时间：2012-05-31T15:30:34.083
> 
> 标签：android, android-layout

我的 listitem.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android" style="@style/f_w" android:layout_height="60sp" android:padding="0sp">
<TextView android:id="@+id/con_name"
    android:textSize="16sp"
    style="@style/w_w" />
<TextView android:id="@+id/con_time"
    android:textSize="13sp" 
    android:textColor="#565"
    style="@style/w_w" />
</RelativeLayout> 
```

所以，我想在按下的项目上指定我的文本视图的文本颜色。我正在通过 baseadapter 使用自定义列表视图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:50:42.983

为您的 TextView 文本颜色创建一个选择器。

res/color/list_item_text_color_selector.xml

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">  
    <item android:state_enabled="false" android:color="@color/disabled_color"/>
    <item android:state_focused="true" android:state_pressed="false" android:color="@color/focused_color" />
    <item android:state_pressed="true" android:color="@color/pressed_color" />
    <item android:color="@color/normal_color" />
</selector> 
```

资源/布局/listitem.xml

```
<TextView android:id="@+id/con_name"
    android:textSize="16sp"
    android:textColor="@color/list_item_text_color_selector"
    style="@style/w_w" /> 
```

如果您希望这适用于两个 TextView，您可以将其添加到 @style/w_w 并从 TextView 中删除 android:textColor 部分。

```
<style name="w_w">
    ...
    <item name="android:textColor">@color/list_item_text_color_selector</item>
    ...
</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:33:31.910

您可以检查列表视图 onItemClickListner 并在其中为项目设置此项`myTextView.setTextColor(getResources().getColor(R.color.blue));`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:56:58.410

如果您的 Activity 扩展 ListActivity 您可以更改 listitem.xml 的任何元素的颜色，只是覆盖：

```
@Override  
protected void onListItemClick(ListView l, View v, int position, long id) {
    super.onListItemClick(l, v, position, id);

    TextView tv = (TextView)  v.findViewById(R.id.con_name);
    tv.setTextColor(R.color.red);
} 
```

# php - 在 php 中将 HTML 转换为 CSV？

> ID：10836637
> 
> 赞同：5
> 
> 时间：2012-05-31T15:30:34.890
> 
> 标签：php, export-to-csv

我有一个这样的html表结构；

```
 <tr style="font-weight: bold">
                <td>ID</td>
                <td>Navn</td>

                <td>Adresse</td>
                <td>By</td>
                <td>Post nr</td>
                <td>E-mail</td>
                <td>Telefon</td>
                <td>Status og dato</td>
                <td>Dropdown info</td>
                <td>Produkt info</td>
                <td>Buydate</td>
                <td>Ref nr. (3 første cifre)</td>
            </tr>
                    <tr>
                <td>40563</td>
                <td>Firstname Lastname</td>

                <td>Address</td>
                <td>Copen</td>
                <td>2100</td>
                <td>ff@hotmail.com</td>
                <td>123123</td>
                <td>Ikke indløst</td>
                <td>EEE-BBB</td>
</tr> 
```

我想通过 php 将其转换为 csv/excel 文件。

所以每个都是excel中的一行，每个都是行中的一个单元格，

请问这怎么做？

我研究并发现[使用 PHP 自动将 HTML 表转换为 CSV？](https://stackoverflow.com/questions/10498632/converting-html-table-to-a-csv-automatically-using-php)但答案对我来说不起作用，我将所有单元格结果都放在一个“单元格”中，所以每一行只有一个单元格。

这是我尝试过的；

```
 $html = str_get_html($table);

        header('Content-type: application/ms-excel');
        header('Content-Disposition: attachment; filename=sample.csv');

        $fp = fopen("php://output", "w");

        foreach($html->find('tr') as $element)
        {
            $td = array();
            foreach( $element->find('td') as $row)  
            {
                $td [] = $row->plaintext;
            }
            fputcsv($fp, $td);
        }

        fclose($fp);
        exit; 
```

其中 $table 是上面的 html。使用简单的 html dom 插件

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T15:59:38.480

[您可以使用PHP DOM 类](http://www.php.net/manual/en/book.dom.php)将它们加载到数组中

```
$data = array();
$doc = new DOMDocument();
$doc->loadHTML($html);
$rows = $doc->getElementsByTagName('tr');
foreach($rows as $row) {
    $values = array();
    foreach($row->childNodes as $cell) {
        $values[] = $cell->textContent;
    }
    $data[] = $values;
} 
```

然后，您可以像在您的示例中那样将该数组转换为 CSV 数据，或者直接在循环中构建 CSV 字符串。

**[活生生的例子](http://codepad.viper-7.com/WJYu9C)**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-31T16:11:42.893

似乎生产的 CVS 在某些 MS excel 版本上存在问题。根据[此](http://php.net/manual/en/function.fputcsv.php)页面：

```
However, certain Microsoft programs (I'm looking at you, Access 97), 
will fail to recognize the CSV properly unless each line ends with \r\n. 
```

所以我将代码修改为：

```
$td = array();
foreach( $element->find('td') as $row) {
   $td[] = $row->plaintext;
}
fwrite($fp,implode(";",$td)."\r\n"); 
```

但也这样说：

```
Secondly, if the first column heading / value of the CSV file begins with 
`uppercase `ID, certain Microsoft programs (ahem, Excel 2007) will interpret 
the file `as` being in the` SYLK format rather than CSV` 
```

所以我将 ID,... 更改为 id,... 总而言之，使用小写的 'id' 和 ';' 作为在 MS excel 2003 中按预期加载的分隔符。

**更新：**

[我找到了一种通过在文件中添加BOM](http://en.wikipedia.org/wiki/Byte_order_mark)签名将 UTF8 .csv 正确加载到 excel 中的方法。在 PHP 中可以这样做：

```
fwrite($fp,"\xEF\xBB\xBF");
...start writing 
```

这 3 个字符（实际上是 1 个 unicode）`forces excel and the likes`来理解 .csv 文件 AS utf8 并因此在内部对其进行解码。

还有另一种不使用 BOM 的解决方案，但它是一种 hack，没有经过很好的测试；只需将您的文件创建为**file.txt**（注意 .txt，而不是 .csv）， **迫使 excel**询问您想要的编码；您选择 utf8 并完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T15:58:05.710

我不想说它对我有用，但是……它对我有用。这是我使用的脚本。

```
<?php
    include('simple_html_dom.php');

    $table = '<tr style="font-weight: bold">
                <td>ID</td>
                <td>Navn</td>
                <td>Adresse</td>
                <td>By</td>
                <td>Post nr</td>
                <td>E-mail</td>
                <td>Telefon</td>
                <td>Status og dato</td>
                <td>Dropdown info</td>
                <td>Produkt info</td>
                <td>Buydate</td>
                <td>Ref nr. (3 første cifre)</td>
            </tr>
                    <tr>
                <td>40563</td>
                <td>Firstname Lastname</td>

                <td>Address</td>
                <td>Copen</td>
                <td>2100</td>
                <td>ff@hotmail.com</td>
                <td>123123</td>
                <td>Ikke indløst</td>
                <td>EEE-BBB</td>
</tr>
';
        $html = str_get_html($table);

        header('Content-type: application/ms-excel');
        header('Content-Disposition: attachment; filename=sample.csv');

        $fp = fopen("php://output", "w");

        foreach($html->find('tr') as $element)
        {
            $td = array();
            foreach( $element->find('td') as $row)  
            {
                $td [] = $row->plaintext;
            }
            fputcsv($fp, $td);
        }

        fclose($fp);
?> 
```

我确实收到了关于该文件是 SYLK 文件并且无法在 Excel 中加载它的说明。单击此消息的“确定”会正常打开文件。如果这是您的错误，则由以下行引起：`<td>ID</td>` SYLK 文件类型由`ID`文本 (CSV) 文件的第一个单元格中的大写字母标识。您可以通过将其更改为小写或一起更改标签来阻止此消息。

这是我完全打开文件后得到的输出： ![Excel 输出](../Images/f0e4ea9798b5472715320f817d1e92ca.png)

# emacs - 无法在 emacs 23 中使用字符集 cp1256

> ID：10836640
> 
> 赞同：1
> 
> 时间：2012-05-31T15:30:39.843
> 
> 标签：emacs, encoding, arabic

我正在尝试在 Emacs 23.1 中打开一个文件，我认为该文件是用 cp1256（又名 windows-1256，阿拉伯语）编码的。但是，当在打开文件之前使用“Cx RET c”（通用编码系统参数）选择编码时，我被告知其中任何一个都不匹配，并且在*Completions*缓冲区中，我可以看到cp125[0-578] 都有代表，但没有cp1256。我找到了文件 $emacs/etc/charsets/CP1256.map，当我调用 'Mx list-character-sets' 时，cp1256 存在。我相信问题是骡子不知道这个charmap。如何让它使用该文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T07:04:00.900

你看到了，`windows-1256`而不是`cp1256`？

此外，您还可以尝试使用默认/自动检测编码打开文件，然后使用以下命令重新加载文件`C-x``RET``r`：您是否有这些编码`windows-1256`/ `cp1256`？

# iphone - 在 iOS 中关闭 UIPickerView

> ID：10836641
> 
> 赞同：2
> 
> 时间：2012-05-31T15:30:40.370
> 
> 标签：iphone, objective-c

我试图通过点击 UIBarButtonItem 来关闭 UIPickerView。所以，我做了一个动作，在这个动作中我称之为 [PickerView removeFromSuperview]。但是，它不起作用。

视图控制器.h

```
#import <UIKit/UIKit.h>
@interface ViewController : UIViewController< UIPickerViewDelegate,UIPickerViewDataSource>
- (IBAction)dissmissPicker:(id)sender;
@property (nonatomic,strong) NSArray *ColorName;

@end 
```

视图控制器.m：

```
#import "ViewController.h"

@implementation ViewController
@synthesize ColorName;

// returns the number of 'columns' to display.
- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView{
    return 1;
}

// returns the # of rows in each component..
- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component{

    return [ColorName count];
}
-(NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component{

    return [ColorName objectAtIndex:row];

    }
- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{

    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    ColorName = [[NSArray alloc]initWithObjects:@"Red",@"White",@"Yellow",@"Green",@"Blue",@"Black",@"Brown",@"Cyan",nil];
   // [pickerview removeFromSuperview];

}
- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component{

    UIColor *newColor;

    switch (row) {
        case 0:
            newColor = [UIColor redColor];
            break;
        case 1:
            newColor = [UIColor whiteColor];
            break;       
        case 2:
            newColor = [UIColor yellowColor];
            break;        
        case 3:
            newColor = [UIColor greenColor];
            break;            
        case 4:
            newColor = [UIColor blueColor];
            break;        
        case 5:
            newColor = [UIColor blackColor];
            break;     
        case 6:
            newColor = [UIColor brownColor];
            break;
        case 7:
            newColor =[UIColor cyanColor];
            break;
        default:
            newColor = [UIColor redColor];
            break;
    }
 self.view.backgroundColor = newColor;

}
- (void)viewDidUnload
{
   // [self setShowColor:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated
{
    [super viewDidDisappear:animated];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (IBAction)dissmissPicker:(id)sender {

    [pickerView removeFromSuperview];

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T17:21:44.220

我假设您正在使用界面生成器的评论？

如果是这种情况，您需要制作一个插座并将其连接到 IB 中。

- 在您的 .h 文件中创建插座

```
IBOutlet UIPickerView *picker; 
```

- 在界面生成器中连接插座

- 关闭视图

```
[picker removeFromSuperview]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:37:56.740

您的 PickerView 是如何添加到视图中的？它是否以模态方式呈现，添加为子视图等？

在前者的情况下，您将调用`-[dismissModalViewControllerAnimated:]`调用该选择器的类或从选择器自身中调用。

在后者的情况下，您的`-[removeFromSuperview]`方法应该可以正常工作。

如果它是使用navigationController 推送的，您应该可以只调用该`[popViewControllerAnimated:]`navigationController 的- 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:42:09.437

制作一个新的 iVar，合成它并在

```
- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView{
    self.yourPickerViewiVar = pickerView;
    return 1;
} 
```

例如。然后你可以在你的 IBAction 中使用它，Xcode 不会继续说“未知”之类的东西。

```
- (IBAction)dissmissPicker:(id)sender {
    [self.yourPickerViewiVar removeFromSuperview];
} 
```

# openoffice-calc - 如何在openoffice calc公式中保持前导零并添加逗号？

> ID：10836643
> 
> 赞同：6
> 
> 时间：2012-05-31T15:30:49.777
> 
> 标签：openoffice-calc, openoffice-basic

我在 open office 中连续有 6 个字段，第一个是单词，第二个、第三个和第四个是一个前导零的数字，第 5 个和第 6 个是常规数字。如何将它们全部连接在一起，并在它们之间加逗号，以便保持前导零？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-31T17:32:59.010

根据您对由于自定义数字格式而具有前导 0 的数字的评论，您需要将`TEXT()`函数合并到公式中以保留（即添加）前导 0。

```
=CONCATENATE(A1,",",TEXT(B1,"0#####"),",",TEXT(C1,"0#####"),",",TEXT(D1,"0#####"),",",E1,",",F1) 
```

只要确保在该字段中包含与数字的最大长度一样多的#。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-08T14:01:56.127

请试试：

```
=A1&",0"&B1&",0"&C1&",0"&D1&","&E1&","&F1 
```

# javascript - 链接的 jQuery ":contains" 替代方案

> ID：10836645
> 
> 赞同：2
> 
> 时间：2012-05-31T15:30:50.463
> 
> 标签：javascript, jquery

jQuery 中有一个选择器 - :contains

例子：

```
str = 'test';
blocked_div = $(".mydiv:contains("+str+")");
blocked_div.find('img').hide();
...
<a href="http://example.com">test</a>
... 
```

据我了解，它是在“.mydiv”元素中搜索“测试”文本。但是现在我需要在“.mydiv”元素中找到一个链接“http://example.com”，并且 :contains 在这种情况下不起作用。你能推荐一个解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:33:38.607

你的意思是：

```
$(".mydiv a[href='example.com']"); 
```

您还可以使用`*=`或`^=`过滤器分别在任何位置或字符串开头查找包含指定文本的链接。

```
// find links containing "example" in href at any place
$(".mydiv a[href*='example']"); 
```

对于您的`str`变量，您可以像这样修改它：

```
$('.mydiv a[href=' + str + ']'); // exact match
$('.mydiv a[href*=' + str + ']'); // contains str anywhere in href 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T15:33:55.707

您想测试字符串是否包含在 HREF 中？这应该这样做：

```
$('.mydiv a[href~='+str+']'); 
```

这`~=`意味着左侧的属性包含右侧的字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T15:31:44.943

更改选择器，如下所示：

```
var str = 'test';
$(".mydiv a:contains("+str+")").attr('href'); // return `href` attribute of that `a`
                                              // contains string test 
```

获取特定链接`href`

```
var str = 'http://example.com';
$(".mydiv a[href="'+ str+ '"]"); 
```

# nhibernate - Fluent NHibernate 一对一 -> 一对多关系

> ID：10836651
> 
> 赞同：1
> 
> 时间：2012-05-31T15:31:11.837
> 
> 标签：nhibernate, fluent-nhibernate

我想知道是否有人可以提供帮助。我有一个父母/孩子关系，父母与孩子是一对一的关系，但孩子可以有很多父母。

父映射：

```
public sealed class DatumMap : ClassMap<Datum>
{
    public DatumMap()
    {
        Id(x => x.Id);
        Map(x => x.DataValue);
        References(x => x.MergeField).Cascade.All();
    }
} 
```

子映射：

```
public sealed class MergeFieldMap : ClassMap<MergeField>
{
    public MergeFieldMap()
    {
        ReadOnly();
        Id(x => x.Id);
        Map(x => x.Name);
        Map(x => x.MergeTag);
        HasMany(x => x.Data);
    }
} 
```

如果我创建两个具有新相同孩子的新分离父母，然后一个接一个地保存它们，我将保留孩子的两个“副本”，而不是重用现有的孩子实体。

如果子类存在，我可以通过查找它并将其附加到第二个父类来强制重用它。

我想知道是否有更优雅的方法来实现这一点，这样如果我尝试坚持本质上相同的子实体，它会使用现有实体，否则会创建一个新子实体。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T09:40:10.063

如果孩子已经存在，则必须以某种方式执行查找。然而，哪两个孩子相同是业务逻辑不同，因此它不会开箱即用。

```
// code to save new Parent

Child child = ...

var parent = new Parent { Child = child };

session.Save(parent); 
```

如果相同意味着 Id（假设 GeneratedBy 已分配），则

```
Child child = session.Get<Child>(childId);
if (child == null)
    child = new Child(childId); 
```

如果你知道孩子已经存在

```
// will generate a proxy instead of querying
Child child = session.Get<Child>(childId); 
```

如果相同意味着自然 id/key

```
Child child = session.Query<Child>().FirstOrDefault(c => c.UniqueProperty == uniqueProperty);
if (child == null)
    child = new Child(childId); 
```

# c - 管道允许多个进程读取相同的数据

> ID：10836652
> 
> 赞同：0
> 
> 时间：2012-05-31T15:31:14.870
> 
> 标签：c, macos, pipe

我写了这段代码：

```
#include <stdio.h>
#include <unistd.h>
#include <sys/wait.h>

#define N 10

int fd[2];

void son ()
{
int data=0;
if(read(fd[0], &data, sizeof(int))==sizeof(int))
    fprintf(stderr,"%d\n",data);
else
    fprintf(stderr,"Read failed\n");
}

int main(int argc, char** argv)
{
pid_t sons[N];
pipe(fd);
int data=5;
for(unsigned int i=0; i<N;i++)
{
    sons[i]=fork();
    if(!sons[i])
    {
        son();
        break;
    }
}
write(fd[1], &data, sizeof(int));
data=6;
} 
```

如果我尝试执行它，我会打印 10 次“5”。
发生了什么？为什么所有进程都读取了相同的数据？数据不能只读取一次吗？我认为阅读器进程正在消耗读取的数据。
我这样修改了代码：

```
#include <stdio.h>
#include <unistd.h>
#include <sys/wait.h>

#define N 10

int fd[2];

void son ()
{
int data=0;
if(read(fd[0], &data, sizeof(int))==sizeof(int))
    fprintf(stderr,"%d\n",data);
else
    fprintf(stderr,"Read failed\n");
if(read(fd[0], &data, sizeof(int))==sizeof(int))
    fprintf(stderr,"%d\n",data);
else
    fprintf(stderr,"Read failed\n");
}

int main(int argc, char** argv)
{
pid_t sons[N];
pipe(fd);
int data=5;
for(unsigned int i=0; i<N;i++)
{
    sons[i]=fork();
    if(!sons[i])
    {
        son();
        break;
    }
}
write(fd[1], &data, sizeof(int));
data=6;
write(fd[1], &data, sizeof(int));
return 0;
} 
```

所以我写/读了两次，我得到的输出是“5”和“6”，只有一次，不会发生所有10个进程都可以读取管道的情况。为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:37:47.503

当你 fork() 时，你执行了 son()，然后跳出循环——但这不是子进程的结束！然后子进程继续并写入 fd[1]。

# wcf - 如何使 WCF 客户端符合特定的 WS-Security

> ID：10836653
> 
> 赞同：3
> 
> 时间：2012-05-31T15:31:16.320
> 
> 标签：wcf, soap, wcf-client, x509certificate, ws-security

我必须让我的 WCF 客户端使用 Web 服务 (IBM DataPower) 并使用[Web Services Security X.509 Certificate Token Profile 1.1 OASIS Standard Specification, 1 February 2006](http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CF0QFjAA&url=http://docs.oasis-open.org/wss/v1.1/wss-v1.1-spec-os-x509TokenProfile.pdf&ei=MovHT52BFKmb1AX_iv2mDw&usg=AFQjCNHWlNOyaK1zZC6zjNrwIbx63tbKUw&sig2=6PdyBqN2MAF6y3DjSR_rug)对请求进行签名/加密。

到目前为止，我已经创建了一个自定义绑定，并且“认为”我正在沿着正确的路线工作：

**更新以反映最新尝试**

```
Private Function CreateCustomBinding() As Channels.Binding

    Dim asbe As New Channels.AsymmetricSecurityBindingElement

    asbe.MessageSecurityVersion = MessageSecurityVersion.WSSecurity10WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10

    asbe.InitiatorTokenParameters = New ServiceModel.Security.Tokens.X509SecurityTokenParameters
    asbe.RecipientTokenParameters = New ServiceModel.Security.Tokens.X509SecurityTokenParameters

    asbe.MessageProtectionOrder = Security.MessageProtectionOrder.EncryptBeforeSign

    asbe.SecurityHeaderLayout = SecurityHeaderLayout.Strict

    asbe.IncludeTimestamp = True
    asbe.SetKeyDerivation(False)

    asbe.DefaultAlgorithmSuite = Security.SecurityAlgorithmSuite.Basic128Rsa15  'By default, AES-128 is used as the encryption algorithm.

    'Add the elements to the custom binding
    Dim myBinding As New CustomBinding

    'element order is important - see http://msdn.microsoft.com/en-us/library/ms733893(v=vs.90).aspx

    'Protocol Binding Elements (security)
    myBinding.Elements.Add(asbe)

    'Encoding Binding Element  
    myBinding.Elements.Add(New TextMessageEncodingBindingElement(MessageVersion.Soap11WSAddressing10, System.Text.Encoding.UTF8))

    'Transport Binding Element
    Dim httpsBindingElement As New HttpsTransportBindingElement()
    httpsBindingElement.RequireClientCertificate = True
    myBinding.Elements.Add(httpsBindingElement)

    Return myBinding

End Function 
```

然后像这样使用这个绑定：

```
Dim epi As EndpointIdentity = EndpointIdentity.CreateDnsIdentity("xgtwsqa.theirdomain.com")

Dim epuri As Uri = New Uri("https://xgtwqa.theirdomain.com/5067/ProcessRepairOrder")
Dim ea As New EndpointAddress(epuri, epi, New AddressHeaderCollection)

Dim myBinding As Binding = GetCustomBinding2()

' Create the client. 
Dim starClientProxy As New wcfStarServiceProxy.starTransportPortTypesClient(myBinding, ea)

' Specify a certificate to use for authenticating the client.
starClientProxy.ClientCredentials.ClientCertificate.SetCertificate(StoreLocation.CurrentUser, StoreName.My, X509FindType.FindBySubjectName, "*.mydomain.org.uk")

starClientProxy.ClientCredentials.ServiceCertificate.SetDefaultCertificate(StoreLocation.CurrentUser, StoreName.AddressBook, X509FindType.FindBySubjectName, "xgtwsqa.theirdomain.com")

'starClientProxy.ClientCredentials.ServiceCertificate.SetScopedCertificate(StoreLocation.CurrentUser, StoreName.AddressBook, X509FindType.FindBySubjectName, "xgtwsqa.theirdomain.com", New Uri("https://xgtwqa.thedomain.com/5067/ProcessRepairOrder"))

' Begin using the client.
Dim response As wcfStarServiceProxy.AcknowledgeRepairOrderPayload = starClientProxy.ProcessMessage(payload) 
```

**有人会告诉我我还需要在绑定中配置什么（我很确定绑定方法不太正确）还是提供我需要的代码？**

以上生成以下 SOAP：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:a="http://www.w3.org/2005/08/addressing"
xmlns:u="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">

  <s:Header>
    <a:Action s:mustUnderstand="1" u:Id="_3">
    http://www.starstandards.org/webservices/2009/transport/operations/ProcessMessage</a:Action>
    <a:MessageID u:Id="_4">
    urn:uuid:c2acbb72-49c2-465b-b177-e806494cdef7</a:MessageID>
    <a:ReplyTo u:Id="_5">
      <a:Address>
      http://www.w3.org/2005/08/addressing/anonymous</a:Address>
    </a:ReplyTo>
    <a:To s:mustUnderstand="1" u:Id="_6">
    https://xgtwqa.theirdomain.com/5067/ProcessRepairOrder</a:To>
    <o:Security s:mustUnderstand="1"
    xmlns:o="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">

      <u:Timestamp u:Id="uuid-b8d302ff-a098-42bb-afc6-694e647c23b0-1">

        <u:Created>2012-06-01T14:35:18.781Z</u:Created>
        <u:Expires>2012-06-01T14:40:18.781Z</u:Expires>
      </u:Timestamp>
      <o:BinarySecurityToken u:Id="uuid-7f9c9673-ae43-4fb5-8510-03cc4b98fa93-2"
      ValueType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3"
      EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">
      removed</o:BinarySecurityToken>
      <o:BinarySecurityToken u:Id="uuid-7f9c9673-ae43-4fb5-8510-03cc4b98fa93-1"
      ValueType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3"
      EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">
      removed</o:BinarySecurityToken>
      <e:EncryptedKey Id="_0"
      xmlns:e="http://www.w3.org/2001/04/xmlenc#">
        <e:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5" />
        <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
          <o:SecurityTokenReference>
            <o:Reference ValueType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3"
            URI="#uuid-7f9c9673-ae43-4fb5-8510-03cc4b98fa93-1" />
          </o:SecurityTokenReference>
        </KeyInfo>
        <e:CipherData>
          <e:CipherValue>
          removed</e:CipherValue>
        </e:CipherData>
      </e:EncryptedKey>
      <Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
        <SignedInfo>
          <CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />
          <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1" />
          <Reference URI="#_2">
            <Transforms>
              <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />
            </Transforms>
            <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
            <DigestValue>removed</DigestValue>
          </Reference>
          <Reference URI="#_3">
            <Transforms>
              <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />
            </Transforms>
            <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
            <DigestValue>removed</DigestValue>
          </Reference>
          <Reference URI="#_4">
            <Transforms>
              <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />
            </Transforms>
            <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
            <DigestValue>removed</DigestValue>
          </Reference>
          <Reference URI="#_5">
            <Transforms>
              <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />
            </Transforms>
            <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
            <DigestValue>removed</DigestValue>
          </Reference>
          <Reference URI="#_6">
            <Transforms>
              <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />
            </Transforms>
            <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
            <DigestValue>removed</DigestValue>
          </Reference>
          <Reference URI="#uuid-b8d302ff-a098-42bb-afc6-694e647c23b0-1">

            <Transforms>
              <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />
            </Transforms>
            <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
            <DigestValue>removed</DigestValue>
          </Reference>
        </SignedInfo>
        <SignatureValue>
        removed</SignatureValue>
        <KeyInfo>
          <o:SecurityTokenReference>
            <o:Reference ValueType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3"
            URI="#uuid-7f9c9673-ae43-4fb5-8510-03cc4b98fa93-2" />
          </o:SecurityTokenReference>
        </KeyInfo>
      </Signature>
      <e:ReferenceList xmlns:e="http://www.w3.org/2001/04/xmlenc#">
        <e:DataReference URI="#_1" />
      </e:ReferenceList>
    </o:Security>
  </s:Header>
  <s:Body u:Id="_2"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <e:EncryptedData Id="_1"
    Type="http://www.w3.org/2001/04/xmlenc#Content"
    xmlns:e="http://www.w3.org/2001/04/xmlenc#">
      <e:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc">
      </e:EncryptionMethod>
      <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
        <o:SecurityTokenReference xmlns:o="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
          <o:Reference URI="#_0"></o:Reference>
        </o:SecurityTokenReference>
      </KeyInfo>
      <e:CipherData>
        <e:CipherValue>removed</e:CipherValue>
      </e:CipherData>
    </e:EncryptedData>
  </s:Body>
</s:Envelope> 
```

这是我希望发送的 SOAP 示例：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:wsa="http://www.w3.org/2005/08/addressing"
xmlns:star="http://www.starstandard.org/STAR/5"
xmlns:tran="http://www.starstandards.org/webservices/2005/10/transport">

  <soap:Header>
    <wsa:To>urn:removed/star/services/v1/GetConditionCodes</wsa:To>
    <wsa:Action>
    http://www.starstandards.org/webservices/2005/10/transport/operations/ProcessMessage</wsa:Action>
    <wsa:MessageID>
    ef67ec85-d5c7-4669-b1a6-440ec2fe938b</wsa:MessageID>

    <tns:RespondTo xmlns:tns="urn:removed/soa/routing/v1.0">
      <tns:Endpoint>
      https://b2b-test.mydomain.com/Async/removed/StarWebService.ashx</tns:Endpoint>
    </tns:RespondTo>
    <tran:payloadManifest>
      <tran:manifest contentID="A0"
      namespaceURI="http://www.starstandard.org/STAR/5"
      element="GetStandardCodes" version="5.2.4" />
    </tran:payloadManifest>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"
    mustUnderstand="1">
      <u:Timestamp xmlns:u="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"
      Id="timestamp" u:Id="timestamp">
        <u:Created>2012-05-30T16:39:39Z</u:Created>
        <u:Expires>2012-05-30T16:44:39Z</u:Expires>
      </u:Timestamp>
      <wsse:BinarySecurityToken xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"
      ValueType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3"
      EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary"
      wsu:Id="binary_security_token">
      removed</wsse:BinarySecurityToken>
      <EncryptedKey xmlns="http://www.w3.org/2001/04/xmlenc#">
        <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5" />
        <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
          <wsse:SecurityTokenReference>
            <wsse:KeyIdentifier ValueType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier"
            EncodingType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary">
            4qEuhS3IWjReFLSSCOcVoN6Ywzo=</wsse:KeyIdentifier>
          </wsse:SecurityTokenReference>
        </KeyInfo>
        <CipherData>
          <CipherValue>
          removed</CipherValue>
        </CipherData>
        <ReferenceList>
          <DataReference URI="#encrypt" />
        </ReferenceList>
      </EncryptedKey>
      <Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
        <SignedInfo>
          <CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />
          <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1" />
          <Reference URI="#body">
            <Transforms>
              <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />
            </Transforms>
            <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
            <DigestValue>removeddigestvalue</DigestValue>
          </Reference>
          <Reference URI="#timestamp">
            <Transforms>
              <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#" />
            </Transforms>
            <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
            <DigestValue>removeddigestvalue</DigestValue>
          </Reference>
        </SignedInfo>
        <SignatureValue>
        removed</SignatureValue>
        <KeyInfo>
          <wsse:SecurityTokenReference>
            <wsse:Reference URI="#binary_security_token"
            ValueType="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3" />
          </wsse:SecurityTokenReference>
        </KeyInfo>
      </Signature>
    </wsse:Security>
  </soap:Header>
  <soap:Body xmlns:u="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"
  id="body" u:Id="body">
    <EncryptedData xmlns="http://www.w3.org/2001/04/xmlenc#"
    Id="encrypt" Type="http://www.w3.org/2001/04/xmlenc#Content">
      <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc" />
      <CipherData>
        <CipherValue>
        removed</CipherValue>
      </CipherData>
    </EncryptedData>
  </soap:Body>
</soap:Envelope> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T17:59:22.917

尝试使用此配置：

```
 <customBinding>
            <binding name="NewBinding0">
                <textMessageEncoding messageVersion="Soap11WSAddressing10" />
                <security authenticationMode="MutualCertificate" messageProtectionOrder="SignBeforeEncrypt"
                    messageSecurityVersion="WSSecurity10WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10">
                    <secureConversationBootstrap />
                </security>
                <httpTransport />
            </binding>
        </customBinding>
    </bindings> 
```

如果您想使用代码，主要区别是在版本中使用 WSSEcurity10（即使您需要 11，这是兼容的）和 messageProtectionOrder（这就是为什么您只看到加密而不看到签名的原因）。

这可能需要进一步微调，让我知道进度。

由于您使用代码还设置：

```
asbe.RecipientTokenParameters.X509ReferenceStyle=X509KeyIdentifierClauseType .SubjectKeyIdentifier 
```

和：

```
asbe.RecipientTokenParameters.InclusionMode = SecurityTokenInclusionMode.Never 
```

# asp.net-mvc-3 - MVC3 不显眼的验证扩展；条款和条件复选框

> ID：10836656
> 
> 赞同：2
> 
> 时间：2012-05-31T15:31:35.963
> 
> 标签：asp.net-mvc-3, unobtrusive-validation

我还看过其他一些关于此的帖子：

[复选框上的 MVC 不显眼验证不起作用](https://stackoverflow.com/questions/6923430/mvc-unobtrusive-validation-on-checkbox-not-working)

[MVC3：通过 jQuery 验证使复选框需要？](https://stackoverflow.com/questions/4934032/mvc3-make-checkbox-required-via-jquery-validate)

但是我已经实现了它们并且不能完全弄清楚为什么我的验证不能正常工作：

属性：

```
[AttributeUsage(AttributeTargets.Field | AttributeTargets.Property, AllowMultiple = false, Inherited = true)]
    public sealed class MustBeTrueAttribute : ValidationAttribute, IClientValidatable {
        public override bool IsValid(object value) {
            return value != null && (bool)value;
        }

        public override string FormatErrorMessage(string name) {
            return string.Format("The {0} field must be true.", name);
        }

        #region Implementation of IClientValidatable

        public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context) {
            yield return new ModelClientValidationRule {
                ErrorMessage = string.IsNullOrEmpty(ErrorMessage) ? FormatErrorMessage(metadata.DisplayName) : ErrorMessage,
                ValidationType = "mustbetrue"
            };
        }

        #endregion
    } 
```

适配器扩展：

```
// Unobtrusive validation extras
$.validator.unobtrusive.adapters.addBool("mustbetrue", function (options) {
    //b-required for checkboxes
    if (options.element.tagName.toUpperCase() == "INPUT" && options.element.type.toUpperCase() == "CHECKBOX") {
        options.rules["required"] = true;
        if (options.message) {
            options.messages["required"] = options.message;
        }
    }
}); 
```

模型属性：

```
 [Display(Name = "I agree to RustyShark's Terms of Use")]
    [MustBeTrueAttribute(ErrorMessage = "You must agree to the Terms of Use")]
    public bool AgreeToTerms { get; set; } 
```

看法：

```
<div class="formField">
    <div class="label">
        @Html.LabelFor(m => m.AgreeToTerms); @Html.ActionLink("view here", "TermsOfUse", "Home", null, new { target = "_blank" }).
    </div>
    <div class="input">
        @Html.CheckBoxFor(m => m.AgreeToTerms)
    </div>
    @Html.ValidationMessageFor(m => m.AgreeToTerms)
</div> 
```

呈现以下 HTML：

```
<div class="formField">
    <div class="label">
        <label for="AgreeToTerms">I agree to RustyShark's Terms of Use</label>; <a href="/Home/TermsOfUse" target="_blank">view here</a>.
    </div>
    <div class="input">
        <input data-val="true" data-val-mustbetrue="You must agree to the Terms of Use" data-val-required="The I agree to RustyShark&amp;#39;s Terms of Use field is required." id="AgreeToTerms" name="AgreeToTerms" type="checkbox" value="true" class="valid"><input name="AgreeToTerms" type="hidden" value="false">
    </div>
    <span class="field-validation-valid" data-valmsg-for="AgreeToTerms" data-valmsg-replace="true"></span>
</div> 
```

服务器端验证正在工作（虽然它返回的是默认错误消息，而不是被覆盖的错误消息），但客户端没有 - 我只是没有收到任何消息，但一切都在正确执行？谁能看到我的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T18:46:19.290

终于想通了！

主要问题是我在 $(document).ready() 函数中执行 $.validator 方法。它需要作为内联函数执行！我只是将它们移到了 ready() 之外，事情就开始发生了！

此外，JS 应如下所示：

```
$.validator.addMethod("mustbetrue", function (value, element, params) {
    return value == true;
});
$.validator.unobtrusive.adapters.add("mustbetrue", function (options) {
    if (options.element.tagName.toUpperCase() == "INPUT" && options.element.type.toUpperCase() == "CHECKBOX") {
        options.rules["required"] = true;
        if (options.message) {
            options.messages["required"] = options.message;
        }
    }
}); 
```

# php - 在 MVC 架构中，密码加密应该在哪里进行

> ID：10836660
> 
> 赞同：6
> 
> 时间：2012-05-31T15:31:43.897
> 
> 标签：php, model-view-controller, codeigniter, encryption

我正在一个中等规模的 PHP CodeIgniter 网站上创建基本的密码安全性。我需要开始加密保存到数据库中的密码。可以使用不同的方法插入用户密码，包括 CSV 导入或个人注册方法。

因此，我只想知道在 MVC 系统中应该加密密码的正确级别是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:37:28.267

唯一需要执行此功能的时候是添加新用户或更新现有用户的密码。这两个功能都应该由 User 模型执行。例如，类似：

```
$user = new User();
$user->setName('...');
$user->setPassword('...');
$user->save(); 
```

或者：

```
$user = User::find('...');
$user->setPassword('...');
$user->save(); 
```

在此示例中， setPassword() 方法将执行实际加密。

另外，这样想——应该不可能将未加密的密码输入系统。因此，您使 User 模型成为与用户交互的唯一方式，并让它透明地加密所有提供给它的密码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:47:32.640

这完全取决于您如何存储密码。

我通常这样做：

1.  创建一个密码字段设置为空（非空）的用户。
2.  将用户插入数据库，从而生成新的 UserID。
3.  使用新插入的用户 ID，加上一些额外的盐来生成密码并存储。

如果您没有使用 UserID 或运行时生成（即插入时）salt，那么您可以同时插入和加密密码。

编辑...

抱歉，我继承了您对 Encrypt 的使用，但是对于密码，您“应该”只对密码进行 HASH。

一个简单的例子是：

```
md5(md5(UserID).md5('Password')) 
```

然后，当用户输入他们的电子邮件/用户名和密码时，您只需要：

```
select * from User where Username = 'myusername' and Password = md5(concat(md5(UserID), md5('Password'))) 
```

而不是解密密码。

# java - 如何将对象集合转换为自定义类型集合？

> ID：10836665
> 
> 赞同：1
> 
> 时间：2012-05-31T15:31:54.170
> 
> 标签：java, object, collections

我有 ：

```
List<Object[]> 
```

想转换为：

```
List<MyClass> 
```

显然它可以迭代所有列表，但可能存在为它准备好的类？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:36:18.423

不，没有简单的方法可以做到这一点。您必须通过迭代输入集合来“以正常方式”执行此操作。

# android - 在android中设置像素后图像中的边缘不平滑

> ID：10836666
> 
> 赞同：5
> 
> 时间：2012-05-31T15:31:56.197
> 
> 标签：android, image, bitmap

我正在使用 getpixels() 和 setpixels() api。从 Bitmap 使用 getpixel api 逐个获取像素并进行一些修改和设置像素，对循环中的所有像素执行此操作。对于无法找到原因的所有像素，我可以看到相同的 alpha 值。请提出解决方案。 ![请找到所附图片以查看问题](../Images/cb9c237e91bf40b6d62e80a0ddea1c4d.png)

```
 int width, height;
           height = bmpOriginal.getHeight();
           width = bmpOriginal.getWidth(); 

            int[] pix = new int[width * height];
            bmpOriginal.getPixels(pix, 0, width, 0, 0, width, height);

            int R, G, B, A; 

            float[] hsv = new float[3];
            float[] hsv2 = new float[3];
            float[] hsv3 = new float[3];

            for (int y = 0; y < height; y++){
            for (int x = 0; x < width; x++)
            {
                int index = y * width + x;
                R = (pix[index] >> 16) & 0xff;     //bitwise shifting
                G = (pix[index] >> 8) & 0xff;
                B = pix[index] & 0xff;            

                Color.RGBToHSV(R, G, B, hsv);                   

                int value = tempBitmap.getPixel(x, y);

               Color.colorToHSV(value, hsv2);                           

                int x = Color.HSVToColor(hsv3);
                pix[index] = x;

                }

            }  

            bmpOriginal.setPixels(pix, 0, width, 0, 0, width, height); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:39:13.280

在您的绘画对象上使用`setAntiAlias(true)`api 来打开抗锯齿。也试试`setFilterBitmap(true)`油漆。

`BitmapDrawable`用你的位图制作一个。然后，`mBmpdrawable.setAntiAlias(true);`在使用它之前调用它。也尝试打电话`mBmpdrawable.setFilterBitmap(true)`

# extjs-mvc - 文本字段上的焦点事件 - extjs 4.1 mvc

> ID：10836667
> 
> 赞同：1
> 
> 时间：2012-05-31T15:31:56.410
> 
> 标签：extjs-mvc, extjs4.1

当用户完成输入文本字段时，我想调用一个事件。

目前我有

```
'#ClientId': { change: this.onProjectItemSelect }, 
```

事件 'change' 被调用，但它在用户开始输入时被调用。

我很欣赏这是文档的标准问题。事件信息记录在哪里。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T15:33:58.333

您可以使用**模糊**事件：

> 当此组件失去焦点时触发。

[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.AbstractComponent-event-blur](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.AbstractComponent-event-blur)

（文本字段组件的文档：[http](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.field.Text) ://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.field.Text ）

# c# - 我在 silverlight 应用程序中丢失了变量值

> ID：10836671
> 
> 赞同：0
> 
> 时间：2012-05-31T15:32:11.433
> 
> 标签：c#, asp.net, silverlight, silverlight-4.0

我对 silverlight 很陌生，我正在使用 silverlight 创建一个网格并通过 WCF 服务填充它，控件托管在 ASP.net 页面中有一些过滤控件在 asp 页面中，我阅读它们，传递它们Silverlight 控制并将它们存储在要传递给 wcf 服务的变量中，问题是在某些时候该变量失去了它的值。我调试了应用程序，发现调用了事件处理程序“Application_Exit”我猜这是因为重新加载控件或其他原因。有谁知道如何绕过这个特殊的障碍

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T10:49:29.183

将 Silverlight 与 ASP.Net 回发控件集成（假设您有回发控件）是一个糟糕的组合。

您的过滤器需要在 Silverlight 应用程序中，或者您需要使用仅限客户端的 Javascript 来通知 Silverlight 更改。确保他们没有回发页面（正如许多 ASP.Net 控件所做的那样）。

我倾向于将更多（全部？）迁移到 Silverlight，因为您没有控制状态问题。然后，如果未安装 Silverlight，您将拥有一个正常的 ASP.net 页面作为后备。

# qtp - 从 HTML 页面触发 QTP 脚本

> ID：10836673
> 
> 赞同：1
> 
> 时间：2012-05-31T15:32:15.933
> 
> 标签：qtp

是否可以让 HTML 页面上的提交按钮运行 QTP 脚本并以漂亮、可读的格式输出结果？

感谢您的任何提示！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T12:44:10.900

QTP 可以作为 COM 对象（也称为 ActiveX 组件）运行。您可以从 QTP 本身用 VBScript 语言创建这样的脚本，但由于它是一个 COM 对象，您也可以使用 Javascript、C# 或其他语言来启动 QTP 并运行脚本。要使其在 HTML 中工作，您有多种可能性：

如果您从本地计算机上的某个位置或从 Intranet（因为这被视为“受信任”位置）打开 HTML 页面，您可以使用 QTP 的 ActiveX/COM 接口来执行此操作，它不会被视为恶意。最简单的方法。

如果在您的桌面上没有正确设置权限（本地计算机和/或 Intranet 被视为与不受信任的 Internet 相同），您可以使用 HTA（HTML 应用程序）来执行此操作。与 HTML 相同，但允许使用 VBScript 和 ActiveX。这是我最喜欢的，因为它是独立的，您可以连接到文件系统、数据库等。

您还可以从服务器提供 HTML 页面。服务器必须与 QTP 在同一个域中，并且您必须使用网络服务器语言（ASP/ASP.NET、php、java 等）制作启动脚本。如果您将站点暴露在 Internet 上，您也可以从家里启动脚本。（如果你没有密码保护它，每个人都可以......）。

也可以进行报告。您可以将 QTP 报告提取到 XML，然后从那里创建 HTML 并将其显示在浏览器中将非常简单。我认为您甚至可以在互联网上从相同的人那里找到代码和应用程​​序。

如果您的 QTP 框架更复杂一点，您可以为每个测试操作创建一行 HTML，并将其附加到 report_html 文件中。甚至更好：为每个测试操作创建一个 JSON 行并将其附加到文件中。JSON 文件可以由人类读取，通过您可以创建解析器的 HTML 页面，或者如果您想要将结果存储在数据库中、将其导入 Quality Center 或在 Excel 中进行摘要，则可以由机器读取。

# python - suds.client 产生 503 错误 -> 如何捕捉它

> ID：10836674
> 
> 赞同：1
> 
> 时间：2012-05-31T15:32:17.173
> 
> 标签：python, soap, suds

嘿嘿，

我正在编写一个访问soap资源（http://chemspell.nlm.nih.gov/axis/SpellAid.jws?wsdl）的脚本，该资源有时会给出503 http状态（经过几次1000次查询......）

然后 suds.client 模块因一个非特定异常而崩溃，我可以通过 try except 语句捕获该异常，但我无法针对实际的 503 http 状态测试此异常。

所以捕捉这个问题的代码现在看起来像这样：

```
for i in range(9):
    try:
        result = client.service.getSugList(query, 'All databases')
        success = True
        break
    except urllib2.URLError, e:
        pass
    except Exception, e:
        if e[0] == 503:
            print "e[0] == 503"
        if 503 in e:
            print "503 in e"
        if e is (503, u'Service Temporarily Unavailable'):
            print "e is (503, u'Service Temporarily Unavailable')"                
        if e == (503, u'Service Temporarily Unavailable'):
            print "e == (503, u'Service Temporarily Unavailable')"                                
        raise ChemSpellException, \
              "Uncaught exception raised by suds.client: %s" % e
if success is False:
    raise ChemSpellException, \
          "Got too many timeouts or 503 errors from ChemSpell web service." 
```

这导致以下输出：

```
No handlers could be found for logger "suds.client"
Traceback (most recent call last):
  File "./scripts/chembl_chemspell_synonyms.py", line 49, in <module>
    synonyms_unique = chemspell.get_synonyms_list(value)
  File "/net/netfile2/ag-russell/bq_ppucholt/hd-analytics/PyHDA/sources/chemspell.py", line 82, in get_synonyms_list
    chemspell_syns = get_synonyms(syn)
  File "/net/netfile2/ag-russell/bq_ppucholt/hd-analytics/PyHDA/sources/chemspell.py", line 45, in get_synonyms
    "Uncaught exception raised by suds.client: %s" % e
PyHDA.sources.chemspell.ChemSpellException: Uncaught exception raised by suds.client: (503, u'Service Temporarily Unavailable') 
```

所以我的 if 子句都无法检测到异常，我不知道接下来要尝试什么来专门捕获它。很难提供一个经常失败的最小示例，因为它依赖于服务器端，并且当脚本继续运行时，这个异常每天都会弹出一次。我可以提供任何进一步的信息吗？您知道要测试哪些 if 子句吗？

干杯，帕斯卡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:55:31.113

```
 if e[0] == 503: 
```

我刚刚发现可以下标的异常，谢谢。

```
 if e is (503, u'Service Temporarily Unavailable'): 
```

看起来你混淆了相等运算符（“==”）的身份运算符（“is”）

```
 if e == (503, u'Service Temporarily Unavailable'): 
```

异常是异常，不是元组

```
 raise ChemSpellException, \
          "Uncaught exception raised by suds.client: %s" % e 
```

如果没有这一行，您将收到带有异常类型和完整回溯的很好的错误消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-21T15:34:09.557

从源代码`suds/client.py`

> ```
> def failed(self, binding, error):
>     """
>     Request failed, process reply based on reason
>     @param binding: The binding to be used to process the reply.
>     @type binding: L{suds.bindings.binding.Binding}
>     @param error: The http error message
>     @type error: L{transport.TransportError}
>     """
>     status, reason = (error.httpcode, tostr(error))
>     reply = error.fp.read()
>     log.debug('http failed:\n%s', reply)
>     if status == 500:
>         if len(reply) > 0:
>             r, p = binding.get_fault(reply)
>             self.last_received(r)
>             return (status, p)
>         else:
>             return (status, None)
>     if self.options.faults:
>         raise Exception((status, reason))
>     else:
>         return (status, None) 
> ```

他们只是`Exception`在下面的行中使用参数元组（状态代码和原因）提出，

> 引发异常（（状态，原因））

您可以将 503 捕获为，

```
try:
    # some code
except Exception as err:
    if (503, u'Service Temporarily Unavailable') in err:
        # here is your 503 
```

# c# - 正则表达式 - 在字符串中查找 4 位数字

> ID：10836676
> 
> 赞同：4
> 
> 时间：2012-05-31T15:32:26.197
> 
> 标签：c#, regex, string

我想知道是否有人可以帮助我找到一个简单的正则表达式来搜索字符串并找到并提取 4 位数字之间没有空格。

例如，我试图在 1965 等字符串中查找年份。如果字符串显示**"30 Jan 1965"**并且我想取出**"1965"**，我该怎么做？

我在互联网上找到了其他人，但我只得到了一个空集。谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-31T15:34:56.427

正则表达式`\b\d{4}\b`可以解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T15:42:39.477

An example. Just add it to a main method.

```
string pattern = @"\d{4}";
System.Text.RegularExpressions.Regex r = new System.Text.RegularExpressions.Regex(pattern);
Console.WriteLine(r.Match("30 Jan 1965"));
Console.WriteLine(r.Matches("30 Jan 1965 2001 2010 test ").Count);
// will output 
// 1965
// 3 
```

# java - java中最好的swing布局解决方案

> ID：10836677
> 
> 赞同：2
> 
> 时间：2012-05-31T15:32:33.833
> 
> 标签：java, swing, layout

我正在尝试重现像 osx lion 的客户端这样的邮件客户端。所以我必须做类似的事情：

![osx lion 的客户端邮件](../Images/dea20c78c1fe1f79bc2ce372d221661f.png)

我不知道这样做的最佳布局解决方案是什么..有人可以给我一些建议吗？谢谢！！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T15:43:10.453

The solution would be to use a **number of different layouts and components**, nested within each other until you have built up the overall layout you are looking for. Typically you would use JPanels for each of the nested areas, and perhaps a JSplitPane for the resizable window areas.

You'll may find you need to write (or find in a 3rd party library library) a number of **custom components** for specific features.

At a guess, you could do most of the mail client layout with a combination of [BorderLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/border.html) and [GridBagLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html). But you might also want to consider [MigLayout](http://www.miglayout.com/), which is a great general purpose layout manager that is very flexible.

If you haven't done so alredy, you should do the [excellent Java Swing Tutorials](http://docs.oracle.com/javase/tutorial/uiswing/index.html)

P.S. [WindowBuilder](http://www.eclipse.org/windowbuilder/) is a great tool for quickly prototyping, but for more complex GUI designs like this I think you are ultimately better hand coding them.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:50:20.637

这是您使用 JSplitPane 的目的。如果您不希望用户能够调整左右之间的划分大小，您可以使用 BorderLayout 左侧的工作方式如下：

```
panel = new JPanel( new BorderLayout() );
panel.add( new LeftPanel(), BorderLayout.WEST );
panel.add( new CentralPanel(), BorderLayout.CENTER ); 
```

这样，LeftPanel 将根据其首选宽度调整大小，并且中心将被赋予剩余的宽度和高度，因此它会随着用户增大和缩小窗口而自行调整大小，但左面板将是固定宽度并在高度。

如果您只是想知道通用布局 TableLayout 是迄今为止最简单还是最灵活的布局。使用它可以解决的布局问题并不多，而且它易于理解（相对于 SpringLayout、GroupedLayout 等）并且比 GridBagLayout 更少的代码和更强大的功能。

[http://java.sun.com/products/jfc/tsc/articles/tablelayout/](http://java.sun.com/products/jfc/tsc/articles/tablelayout/)

但是对于您描述的问题，我认为您不必使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T15:40:08.060

总体而言，对于该屏幕截图，水平框布局可能是您所追求的（从左到右布置组件以填充空间。）

不过，您可能需要在其中嵌套其他布局，就像使用大多数合理大小的 UI 一样。

# ajax - 单击活动选项卡时，ajax 加载手风琴

> ID：10836678
> 
> 赞同：0
> 
> 时间：2012-05-31T15:32:34.293
> 
> 标签：ajax, jquery-ui, jquery, jquery-ui-accordion

我有一个手风琴来创建、重命名和删除文件夹。在重命名和删除中，我有一个包含已创建文件夹列表的下拉列表。因此，当我创建一个文件夹时，它会执行 ajax 调用来创建一个文件夹，但是当我返回重命名或删除时，我想查看更新的文件夹。我有一个 ajax 方法来检索列表，但我不知道如何调用加载函数。

我试过了

```
$('#accordion').accordion({ 
        change: function(event, ui){
                var clicked = $(this).find('.ui-state-active').attr('id');
                $('#'+clicked).load("serveresource method");
        }
}); 
```

来自[jQuery Accordion 中的一篇文章并通过 AJAX 加载内容](https://stackoverflow.com/questions/646415/jquery-accordion-and-loading-content-through-ajax) 当我尝试提醒单击的值未定义时，不确定其中应该包含什么。任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T04:52:56.837

**你可以做这样的事情..**

```
 $('#accordion').find('.ui-state-default').click(function(){
        var clicked =$('#accordion').find('.ui-state-active').attr('id');
        alert(clicked);
        $('#'+clicked).load("serveresource method");

}); 
```

# android - api级别11之前的Android datepicker min max date

> ID：10836679
> 
> 赞同：22
> 
> 时间：2012-05-31T15:32:35.973
> 
> 标签：android, android-datepicker

我正在尝试将 Android 中日期选择器的最小和最大日期设置为 API 级别 11 之前。我使用了以下代码：

```
mDatePickerField = startDatePickerDialog.getClass().getDeclaredField("mDatePicker");
mDatePickerField.setAccessible(true);

DatePicker startDatePickerInstance =(DatePicker)mDatePickerField.get(startDatePickerDialog);
startDatePickerInstance.init(mYearMin, mMonthMin, mDayMin, new DatePicker.OnDateChangedListener() {
    @Override
    public void onDateChanged(DatePicker datePicker, int i, int i1, int i2) {
        Date maxDate = new Date(mYearMax, mMonthMax, mDayMax, 0, 0, 0);
        Date selectedDate = new Date(i, i1, i2, 0, 0, 0);
        if (selectedDate.after(maxDate)) {
            datePicker.updateDate(mYearMax, mMonthMax, mDayMax);                                        
        }
    }
} 
```

但是，该`updateDate`方法再次触发`onDateChanged`并且日期选择器没有更新。
任何人都可以帮助解决问题吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-14T14:43:07.843

您可以使用 init datePicker 方法设置范围。最小值示例：

```
// Calendar
this.calendar = new GregorianCalendar();
this.datePicker = (DatePicker) findViewById(R.id.xxxxx);

if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
    // (picker is a DatePicker)
    this.datePicker.setMinDate(this.calendar.getTimeInMillis());
} else {
    final int minYear = this.calendar.get(Calendar.YEAR);
    final int minMonth = this.calendar.get(Calendar.MONTH);
    final int minDay = this.calendar.get(Calendar.DAY_OF_MONTH);

    this.datePicker.init(minYear, minMonth, minDay,
            new OnDateChangedListener() {

                public void onDateChanged(DatePicker view, int year,
                        int month, int day) {
                    Calendar newDate = Calendar.getInstance();
                    newDate.set(year, month, day);

                    if (calendar.after(newDate)) {
                        view.init(minYear, minMonth, minDay, this);
                    }
                }
            });
    Log.w(TAG, "API Level < 11 so not restricting date range...");
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-26T13:52:57.513

> 这个 DatePicker 自定义类允许我们指定最大和最小日期

```
public class DatePickerDialogWithMaxMinRange extends DatePickerDialog {

 static int maxYear=2005; 
 static int maxMonth=11;
 static int maxDay=31;

 int minYear=1955;
 int minMonth=0;
 int minDay=1;

public DatePickerDialogWithMaxMinRange(Context context,  OnDateSetListener callBack,int minYear,int minMonth,int minDay,int maxYear,int maxMonth,int maxDay) {
    super(context,callBack, maxYear, maxMonth, maxDay);
    this.minDay = minDay;
    this.minMonth = minMonth;
    this.minYear = minYear;
    DatePickerDialogWithMaxMinRange.maxDay = maxDay;
    DatePickerDialogWithMaxMinRange.maxMonth = maxMonth;
    DatePickerDialogWithMaxMinRange.maxYear = maxYear;
}

@Override
public void onDateChanged(DatePicker view, int year, int monthOfYear, int dayOfMonth) {
    super.onDateChanged(view, year, monthOfYear, dayOfMonth);

        if (year > maxYear ||monthOfYear > maxMonth && year == maxYear||
                 dayOfMonth > maxDay && year == maxYear && monthOfYear == maxMonth){
            view.updateDate(maxYear, maxMonth, maxDay);
            }else if(year < minYear ||monthOfYear < minMonth && year == minYear||
                 dayOfMonth < minDay && year == minYear && monthOfYear == minMonth){
             view.updateDate(minYear, minMonth, minDay );
            }
} 
```

}

> // 在您的 Activity 类或 Fragment 中使用此代码指定成员为

```
private int intCurrentYear;
private int intCurrentMonth;
private int intCurrentDay;
private int intMaxYear;
private int intMaxMonth;
private int intMaxDay;
private int intMinYear;
private int intMinDay;
private int intMinMonth;

    DatePickerDialogWithMaxMinRange datePickerDialog= null;
DatePickerDialog.OnDateSetListener datePickerOnDateSetListener;
Calendar myCalendar; 
```

> // 在 onCreate 或任何你想调用的地方调用这个方法..

注意：您需要通过侦听器自定义 datepickerdialog 在 datepicker 对话框中选择后更新日期

```
public void setDate() {
    /*
     * Initialise Listener for date set
     */

    datePickerOnDateSetListener = new DatePickerDialog.OnDateSetListener() {
        public void onDateSet(DatePicker view, int year, int monthOfYear,
                int dayOfMonth) {
            edtTxtPlayerBirthDay.setText(new StringBuilder().append(year)
                    .append("-").append(monthOfYear + 1).append("-")
                    .append(dayOfMonth));
        }
    };

    // initialise DatePicker 

    myCalendar = Calendar.getInstance();

    intCurrentYear = myCalendar.get(Calendar.YEAR);
    intCurrentMonth = myCalendar.get(Calendar.MONTH);
    intCurrentDay = myCalendar.get(Calendar.DAY_OF_MONTH);

    intMaxYear =  intCurrentYear - 2000;
    intMaxMonth = intCurrentMonth;
    intMaxDay =  intCurrentDay;

    intMinYear =  intCurrentYear - 1950;
    intMinMonth = intCurrentMonth;
    intMinDay =  intCurrentDay; 

    datePickerDialog = new DatePickerDialogWithMaxMinRange(
            context, datePickerOnDateSetListener,intMinYear,intMinMonth,intMinDay,intMaxYear,intMaxMonth,intMaxDay);
} 
```

> 创建日期选择器时，根据您的要求传递mindate和maxdate，以便在单击按钮时显示日期选择器或任何其他控件将此代码放入该onclicklistener ...

```
datePickerDialog.show(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-08-30T19:52:52.110

找到了一种很酷的方法来`min`设置. 适用于所有 Android 版本。只需返回基于Android的版本`max``DatePickerDialog``DatePickerDialog`

```
protected Dialog onCreateDialog(int id)
{
    switch ( id )
    {
        case DATE_DIALOG_ID:
            DatePickerDialog dialog = null;
            if ( Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB )
            {
                dialog = new DatePickerDialog(this, new DatePickerDialog.OnDateSetListener()
                {
                    @Override
                    public void onDateSet(DatePicker view, int selectedYear, int selectedMonth, int selectedDate)
                    {
                        mTextView.setText(selectedDate + "/" + selectedMonth + 1 + "/" + selectedYear);
                    }
                }, year, month - 1, date);
                Calendar currentDate = Calendar.getInstance();
                dialog.getDatePicker().setMaxDate(currentDate.getTimeInMillis());
                //If you need you can set min date too
            }
            else
            {
                dialog = new DatePickerDialog(this, new DatePickerDialog.OnDateSetListener()
                {
                    @Override
                    public void onDateSet(DatePicker view, int selectedYear, int selectedMonth, int selectedDate)
                    {
                        mTextView.setText(selectedDate + "/" + selectedMonth + 1 + "/" + selectedYear);
                    }
                }, year, month - 1, date)
                {
                    @Override
                    public void onDateChanged(DatePicker view, int year, int month, int day)
                    {
                        if ( year <= maxYear && month + 1 <= maxMonth && date <= maxDate ) //meets your criteria
                        {
                            view.updateDate(year, month, date); //update the date picker to selected date
                        }
                        else
                        {
                            view.updateDate(maxYear, maxMonth - 1, maxDate); // or you update the date picker to previously selected date
                        }
                    }
                };
            }
            return dialog;
    }
    return null;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-09-04T20:06:25.767

编辑您的 DatePicker.java，添加以下 3 个代码摘录。

声明用于限制最小和最大日期的变量。

```
// Variables for defining minimum date 
private int minimumDay;
private int minimumMonth;
private int minimumYear;

// Variables for defining maximum date 
private int maximumDay;
private int maximumMonth;
private int maximumYear; 
```

在构造函数之后，您必须重写 onDateChanged 方法。

```
// Called every time the user changes DatePicker values
public void onDateChanged(DatePicker view, int year, int monthOfYear, 
        int dayOfMonth) {

    // Test if chosen date is before minimum date
    boolean beforeMinDate = false;
    boolean afterMaxDate = false;

    if(year < minimumYear){
        beforeMinDate = true;
    }
    else if(year == minimumYear){
        if(monthOfYear < minimumMonth){
            beforeMinDate = true;
        }
        else if(monthOfYear == minimumMonth){
            if(dayOfMonth < minimumDay){
                beforeMinDate = true;
            }
        }
    }

    // Test if chosen date is after maximum date
    if(!beforeMinDate){
        if(year > maxYear){
            afterMaxDate = true;
        }
        else if(year == maxYear){
            if(monthOfYear > maxMonth){
                afterMaxDate = true;
            }
            else if(monthOfYear == maxMonth){
                if(dayOfMonth > maxDay){
                    afterMaxDate = true;
                }
            }
        }
    }

    // If chosen date is before minimum date, update the date and internal
    // calendar to minimum date, else, check similarly fot the maximum
    // date, else, use the valid chosen date.
    if(beforeMinDate)
    {
        mCalendar.set(minimumYear, minimumMonth, minimumDay, 
                mCalendar.get(Calendar.HOUR_OF_DAY), 
                mCalendar.get(Calendar.MINUTE));
        updateDate(minimumYear, minimumMonth, minimumDay);
    }
    else if (afterMaxDate)
    {
        mCalendar.set(maximumYear, maximumMonth, maximumDay, 
                mCalendar.get(Calendar.HOUR_OF_DAY), 
                mCalendar.get(Calendar.MINUTE));
        updateDate(maximumYear, maximumMonth, maximumDay);
    }
    else
        mCalendar.set(year, monthOfYear, dayOfMonth, 
                mCalendar.get(Calendar.HOUR_OF_DAY), 
                mCalendar.get(Calendar.MINUTE));
} 
```

现在，为最小和最大日期创建 setter 方法。

```
 // Method to define minimum permitted date for the picker.
    public void setMinimumDate(int minimumDay, int minimumMonth, 
            int minimumYear)
    {
        this.minimumDay = minimumDay;
        this.minimumMonth = minimumMonth;
        this.minimumYear = minimumYear;
    }

    //Method to define maximum permitted date for the picker.
    public void setMaximumDate(int maximumDay, int maximumMonth, 
            int maximumYear)
    {
        this.maximumDay = maximumDay;
        this.maximumMonth = maximumMonth;
        this.maximumYear = maximumYear;
    } 
```

第二部分，在您调用 DatePicker 对话框的活动中，您需要设置所需的最小和最大日期。下面的代码将当前日期设置为最小日期，将未来两年设置为最大日期。

```
 // Define current date as the minimum desired date
    Calendar c = Calendar.getInstance(); 
    int currentDay = c.get(Calendar.DAY_OF_MONTH);
    int currentMonth = c.get(Calendar.MONTH);
    int currentYear = c.get(Calendar.YEAR);
    inicioDateTimePicker.setMinimumDate(currentDay, currentMonth, 
            currentYear);

    // Define two years in the future as the maximum desired date
    Calendar c = Calendar.getInstance(); 
    int currentDay = c.get(Calendar.DAY_OF_MONTH);
    int currentMonth = c.get(Calendar.MONTH);
    int currentYear = c.get(Calendar.YEAR);
    inicioDateTimePicker.setMinimumDate(currentDay, currentMonth, 
            currentYear + 2); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-01T10:18:59.360

根据@yostyle 的回答，我制作了一个方法来设置 DatePicker 的最小和最大日期。我的 DatePicker 在 AlertDialog 中使用，因为我需要一些额外的自定义，但是此方法可以直接用于任何 DatePickerDialog 或任何自定义 DatePicker：

```
/**
     * Compat utility method that will set the minimum date and the maximum date for the DatePicker view.
     * <p/>
     * If the current API is greater than 11, than the normal {@link android.widget.DatePicker#setMinDate(long)} and
     * {@link android.widget.DatePicker#setMaxDate(long)} methods will be used.
     * <p/>
     *
     * @param minCalendar
     *         The minimum date for the picker
     * @param maxCalendar
     *         The maximum date for the picker
     */
    private void initDatePickerCompat(final Calendar minCalendar, final Calendar maxCalendar) {
        if (null == mDatePicker) {
            // Exit early if DatePicker view was not initialized
            return;
        }
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
            // (mDatePicker is a DatePicker)
            mDatePicker.setMinDate(minCalendar.getTimeInMillis());
            mDatePicker.setMaxDate(maxCalendar.getTimeInMillis());
        } else {
            final int minYear = minCalendar.get(Calendar.YEAR);
            final int minMonth = minCalendar.get(Calendar.MONTH);
            final int minDay = minCalendar.get(Calendar.DAY_OF_MONTH);

            final int maxYear = maxCalendar.get(Calendar.YEAR);
            final int maxMonth = maxCalendar.get(Calendar.MONTH);
            final int maxDay = maxCalendar.get(Calendar.DAY_OF_MONTH);

            mDatePicker.init(minYear, minMonth, minDay, new DatePicker.OnDateChangedListener() {
                @Override
                public void onDateChanged(DatePicker view, int year, int monthOfYear, int dayOfMonth) {
                    Calendar newCalendar = Calendar.getInstance();
                    newCalendar.set(year, monthOfYear, dayOfMonth);

                    if (newCalendar.after(maxCalendar)) {
                        // MAX
                        view.updateDate(maxYear, maxMonth, maxDay);
                    } else if (newCalendar.before(minCalendar)) {
                        // MIN
                        view.updateDate(minYear, minMonth, minDay);
                    } else {
                        // BETWEEN
                        view.updateDate(year, monthOfYear, dayOfMonth);
                    }
                }
            });
        }
    } 
```

请记住，此方法应在 DatePicker 初始化后调用，如下所示：

```
mDatePicker = (DatePicker) view.findViewById(R.id.datePicker);
mDatePicker.init(year, monthOfYear, dayOfMonth, this);
DateTime minDate = new DateTime();
DateTime maxDate = minDate.plusYears(10);
// Set the minimum and the maximum date for the date picker
initDatePickerCompat(minDate.toCalendar(Locale.getDefault()), maxDate.toCalendar(Locale.getDefault())); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-31T15:45:24.203

你不能。我处理这个问题的方法是对 DatePicker 使用 if 语句：

```
import android.os.Build.*;

if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
    // (picker is a DatePicker)
    picker.setMinDate(...);
} else {
    Log.w(TAG, "API Level < 11 so not restricting date range...");
} 
```

我最终没有为 TimePicker 做任何事情。

有什么好消息？

SimonVT 向后移植了 DatePicker 和 TimePicker，因此您可以在早期 API 级别享受最新功能：

*   [https://github.com/SimonVT/android-datepicker](https://github.com/SimonVT/android-datepicker)
*   [https://github.com/SimonVT/android-timepicker](https://github.com/SimonVT/android-timepicker)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-03-17T15:49:12.760

只需使用来自 Calender 的 Value(Min & Max) 来设置 DatePiker.MaxDate 和 DatePiker.MinDate 尝试以下操作：

```
 DatePickerDialog dialog = new DatePickerDialog();

 Java.Util.TimeZone GMT = new SimpleTimeZone(TimeZoneInfo.Local.BaseUtcOffset.Hours, "GMT"); 
 Calendar maxDate = Calendar.GetInstance(GMT);
 maxDate.Set(DateTime.Now.Year, DateTime.Now.Month - 1, DateTime.Now.Day);

 Calendar minDate = Calendar.GetInstance(GMT);
 minDate.Set(DateTime.Now.Year - 2, DateTime.Now.Month - 1, DateTime.Now.Day);

 dialog.DatePicker.MaxDate = maxDate.TimeInMillis;
 dialog.DatePicker.MinDate = minDate.TimeInMillis; 
```

# sql - 通过根据另一个表中的值替换子字符串来更新表字段

> ID：10836681
> 
> 赞同：3
> 
> 时间：2012-05-31T15:32:40.090
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一个表，我想根据另一个表中的值更新它的一个 varchar 字段。

我有下表：

```
ID  Constraint_Value 
----------------------------
1   (OldVal_1) (OldVal_2) 
2   (OldVal_2) (OldVal_1) 
```

...我想使用下表中的数据进行更新：

```
oldValue  newValue
----------------------------
OldVal_1    NewVal_1
OldVal_2    NewVal_2 
```

更新后，我的目标是：

```
ID    Constraint_Value 
----------------------------
1     (NewVal_1) (NewVal_2) 
2     (NewVal_2) (NewVal_1) 
```

以下 SQL 说明了我的问题（无需任何设置即可在 SQL Management Studio 中运行）：

```
IF OBJECT_ID('tempdb..#tmpConstraint') IS NOT NULL DROP TABLE #tmpConstraint
GO 
CREATE TABLE tempdb..#tmpConstraint ( constraint_id INT PRIMARY KEY, constraint_value varchar(256) )
GO

IF OBJECT_ID('tempdb..#tmpUpdates') IS NOT NULL DROP TABLE #tmpUpdates
GO 
CREATE TABLE tempdb..#tmpUpdates ( oldValue varchar(256), newValue varchar(256))
GO

insert into #tmpConstraint
values (1, '(OldVal_1) (OldVal_2)')

insert into #tmpConstraint
values (2, '(OldVal_2) (OldVal_1)')

insert into #tmpUpdates
values ('OldVal_1', 'NewVal_1')

insert into #tmpUpdates
values ('OldVal_2', 'NewVal_2')

select * from #tmpConstraint

update c
set constraint_value = REPLACE(constraint_value, u.oldValue, u.newValue)
from #tmpConstraint c
cross join #tmpUpdates u

select * from #tmpConstraint 
```

这给出了结果：

```
(Before) 
1   (OldVal_1) (OldVal_2) 
2   (OldVal_2) (OldVal_1) 

(After) 
1   (NewVal_1) (OldVal_2) 
2   (OldVal_2) (NewVal_1) 
```

如您所见，刚刚`OldVal_1`更新。`OldVal_2`一直保持不变。

**如何使用查找表中的所有数据更新字段？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:46:56.710

`UPDATE`只会影响每个源行一次。所以我知道的最简单的解决方法是游标。

```
DECLARE @o VARCHAR(256), @n VARCHAR(256);

DECLARE c CURSOR LOCAL STATIC READ_ONLY FORWARD_ONLY 
FOR SELECT oldValue, newValue FROM #tmpUpdates;

OPEN c;

FETCH c INTO @o, @n;

WHILE @@FETCH_STATUS = 0
BEGIN
    UPDATE #tmpConstraint 
      -- note full match only:
      SET constraint_value = REPLACE(constraint_value, '(' + @o + ')', '(' + @n + ')')
      -- and note we only touch rows where there is a full match:
      WHERE constraint_value LIKE '%(' + @o + ')%';

    FETCH c INTO @o, @n;
END

CLOSE c;
DEALLOCATE c;

SELECT constraint_id, constraint_value FROM #tmpConstraint; 
```

结果：

```
constraint_id  constraint_value
-------------  ---------------------
1              (NewVal_1) (NewVal_2)
2              (NewVal_2) (NewVal_1) 
```

# jquery - jQuery .on() 与将事件绑定到选择器？

> ID：10836682
> 
> 赞同：6
> 
> 时间：2012-05-31T15:32:44.257
> 
> 标签：jquery

我正在查看此[页面](http://api.jquery.com/on/)上的文档。他们有这样的例子......

```
$("p").on("click", function(){
alert( $(this).text() );
});

$("form").on("submit", false)

$("form").on("submit", function(event) {
  event.preventDefault();
}); 
```

为什么这更好或与此有何不同...

```
$("p").click(function(){
alert( $(this).text() );
});

$("form").submit(false);

$("form").submit(function(event) {
  event.preventDefault();
}); 
```

作为最后一个问题，您为什么要这样做...

```
$("form").on("submit", function(event) {
  event.stopPropagation();
}); 
```

代替 ...

```
 $("form").submit(function(event) {
      event.preventDefault();
  }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T15:36:22.803

[jQuery .bind() 与 .live() 与 .delegate() 与 .on() 的区别](http://www.elijahmanor.com/2012/02/differences-between-jquery-bind-vs-live.html)

这篇文章最大的收获是……

使用 .bind() 方法的成本非常高，因为它将相同的事件处理程序附加到选择器中匹配的每个项目。

您应该停止使用 .live() 方法，因为它已被弃用并且存在很多问题。

.delegate() 方法在处理性能和对动态添加的元素做出反应时提供了很多“物有所值”。

新的 .on() 方法主要是可以模仿 .bind()、.live() 或 .delegate() 的语法糖，具体取决于您如何调用它。

新的方向是使用新的 .on 方法。熟悉语法并开始在所有 jQuery 1.7+ 项目中使用它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-31T15:40:35.843

使用`.on`而不是特定的处理程序（例如`.click`等）时几乎没有区别

1.  目的`.on()`方法是提供以一种语法附加事件处理程序所需的所有功能。`.on`您可以使用而不是 mix of bundle`.on`或来编写一致的`.submit`语法`.click`。
2.  `.on`支持事件委托，但特定的处理程序（例如：）`.click`不支持。在[此处](http://api.jquery.com/on/)阅读**直接和委托事件部分下的更多信息**
3.  使用`.on`您可以绑定多个事件处理程序，例如`.on('click dblclick')`
4.  使用 .on 您可以绑定命名空间事件，例如`.on('click.myClick')`. 在[此处](http://api.jquery.com/on/)阅读更多**事件名称和命名空间部分**
5.  内部`.click`触发`.on`，所以基本上你避免了额外的函数调用。- [.click源代码](http://james.padolsey.com/jquery/#v=git&fn=jQuery.fn.click)

而现在的判决，

> $("form").on("submit", function(event) { event.preventDefault(); });
> 
> 为什么这更好或与此有何不同
> 
> $("form").submit(function(event) { event.preventDefault(); });

`$("form").on(`比上面提到的原因1和5更好

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-31T15:37:01.533

, `click`, `submit`etc 方法只是它们各自`on`和`trigger`等价物的便捷方法。

如果我相信它们可以提高代码的可读性，我只会使用它们。但总的来说，我发现`on`and`trigger`方法更清楚地表达了代码的意图。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-31T15:36:43.223

1.  使用`$.on()`, 即使您不使用委托也很好，因为它在您的代码中引入了熟悉且一致的语法。
2.  此外，它在 jQuery 源代码中大量使用，这意味着您可以在调用`$.bind()`.
3.  使用`$.submit()`或`$.click()`分配处理程序令人困惑，因为它也用于触发这些事件。

然后是事件委托的额外好处，当您只需要添加一个元素时，它可以让您免于向数百个元素添加事件。假设您有 100 个`<td>`元素，并且您想在点击时提醒它们的内容。你可以这样做：

```
$("td").click(function(){
    alert( $(this).text() );
}); 
```

但是现在您已经添加了 100 个新的事件处理程序。对性能真的很不利。使用`$.on()`，您可以仅绑定到`<table>`，并检查所有事件以查看引发它们的原因。如果是`<td>`，您可以做出相应的回应：

```
$("table").on("click", "td", function(){
    alert( $(this).text() );
}); 
```

瞧，只绑定了一个事件，应用程序中只引入了一个事件处理程序。性能大幅提升。

`$.on()`这是王牌`$.click()`或`$.submit()`任何一天的最大原因之一。

# oauth - 与 Oauth 2.0 谷歌日历连接

> ID：10836685
> 
> 赞同：1
> 
> 时间：2012-05-31T15:32:59.827
> 
> 标签：oauth, calendar, authorization

```
import com.google.api.client.http.HttpRequestFactory;
import com.google.api.client.http.HttpResponseException;
import com.google.api.client.http.HttpTransport;
import com.google.api.client.http.javanet.NetHttpTransport;
import com.google.api.client.json.JsonFactory;
import com.google.api.client.json.jackson.JacksonFactory;
import com.google.api.client.util.DateTime;
//import com.google.api.services.calendar.Calendar;
import com.google.api.services.calendar.model.Calendar;
import com.google.api.services.calendar.model.Event;
import com.google.api.services.calendar.model.EventAttendee;
import com.google.api.services.calendar.model.EventDateTime;
import com.google.api.client.googleapis.services.GoogleClient.Builder;
//import com.google.api.services.calendar.Calendar.Calendars;
//import com.google.api.services.calendar.Calendar.Calendars.Insert;
import com.google.api.client.auth.oauth2.AuthorizationCodeFlow;
import com.google.api.client.auth.oauth2.draft10.AccessProtectedResource.Method;
import com.google.api.client.auth.oauth2.draft10.AccessTokenErrorResponse;
import com.google.api.client.auth.oauth2.draft10.AccessTokenResponse;
import com.google.api.client.googleapis.auth.oauth2.GoogleCredential;
import com.google.api.client.googleapis.auth.oauth2.draft10.GoogleAccessTokenRequest.GoogleAuthorizationCodeGrant;
import com.google.api.client.googleapis.auth.oauth2.draft10.GoogleAccessProtectedResource;
import com.google.api.client.googleapis.auth.oauth2.draft10.GoogleAuthorizationRequestUrl;

import java.io.BufferedReader;
import java.io.File;
import java.io.IOException;
import java.io.InputStreamReader;
import java.security.GeneralSecurityException;
import java.util.ArrayList;
import java.util.Arrays;

@SuppressWarnings({ "deprecation", "unused" })
public class connect{

    public void setUp() throws IOException {

        HttpTransport httpTransport = new NetHttpTransport();
        JacksonFactory jsonFactory = new JacksonFactory();

        // The clientId and clientSecret are copied from the API Access tab on
        // the Google APIs Console
        String clientId = "MYCLIENTID";
        String clientSecret = "CLIENTSECRET";

        // Or your redirect URL for web based applications.
        String redirectUrl = "urn:ietf:wg:oauth:2.0:oob";
        String scope = "https://www.googleapis.com/auth/calendar";

        // Step 1: Autorizzazione -->
        String authorizationUrl = new GoogleAuthorizationRequestUrl(clientId, redirectUrl, scope)
            .build();

        // Point or redirect your user to the authorizationUrl.
        System.out.println("Vai al seguente indirizzo nel browser:");
        System.out.println(authorizationUrl);

        // Read the authorization code from the standard input stream.
        System.out.println("Qual e' il tuo codice di autorizzazione?");
        BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
        String code = in.readLine();

        // Fine Step 1 <--
        // Step 2: Scambio -->
        AccessTokenResponse authResponse = new GoogleAuthorizationCodeGrant(httpTransport, jsonFactory,
                clientId, clientSecret, code, redirectUrl).execute();
        System.out.println("Scrivi: "+authResponse);
        System.out.println("Token d'accesso: "+authResponse.accessToken);
        if(scope == "https://www.googleapis.com/auth/calendar")
        System.out.println("Scope di lettura e scrittura usato :"+scope);
        else
            System.out.println("Scope di sola lettura usato :"+scope);
        // Fine Step 2 <--

        GoogleAccessProtectedResource accessProtectedResource = new GoogleAccessProtectedResource(
                authResponse.accessToken, httpTransport, jsonFactory, clientId, clientSecret,
                authResponse.refreshToken);
        System.out.println("Il Client ID utilizzato e': "+accessProtectedResource.getClientId());
        System.out.println("Il Secret ID utilizzato e': "+accessProtectedResource.getClientSecret());
        System.out.println("L'url di autenticazione e': "+accessProtectedResource.getAuthorizationServerUrl());

        com.google.api.services.calendar.Calendar service = new com.google.api.services.calendar.Calendar(httpTransport, jsonFactory);
        Calendar cale = new Calendar();

        System.out.println("Menu'");
        System.out.println("Cosa desideri fare?");
        System.out.println("1) Creare un calendario");
        System.out.println("2) Creare un evento");
        System.out.println("3) Eliminare un calendario");
        System.out.println("0) Uscita");

        int scelta = Integer.parseInt(in.readLine());
        System.out.println(scelta);
        switch(scelta){
        case 1:
            //insert calendar
            Calendar ClaudioCal = new Calendar();
            ClaudioCal.setSummary("Esempio di calendario di Claudio");
            ClaudioCal.setTimeZone("America/Los_Angeles");

            cale = service.calendars().insert(ClaudioCal).execute();
            break;

            //other case.......

        System.out.println("Fatto"); 
    }
    } 
```

大家好，这是我连接 Google 帐户以修改日历的代码，但每次系统响应我“未经授权”。就像未验证 accessToken 一样，我不明白问题出在哪里

请帮助我提前非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T18:39:25.930

在最新版本的 Java API 库中，处理 OAuth 的机制发生了显着变化。

您需要遵循此处示例代码中引用的构建器模式： [http ://code.google.com/p/google-api-java-client/source/browse/calendar-cmdline-sample/src/main/ java/com/google/api/services/samples/calendar/cmdline/CalendarSample.java?repo=samples#57](http://code.google.com/p/google-api-java-client/source/browse/calendar-cmdline-sample/src/main/java/com/google/api/services/samples/calendar/cmdline/CalendarSample.java?repo=samples#57)

```
Credential credential = OAuth2Native.authorize(
    HTTP_TRANSPORT, JSON_FACTORY, new LocalServerReceiver(),
    Arrays.asList(CalendarScopes.CALENDAR));

// set up global Calendar instance
client = com.google.api.services.calendar.Calendar.builder(HTTP_TRANSPORT, JSON_FACTORY)
    .setApplicationName("Google-CalendarSample/1.0").setHttpRequestInitializer(credential)
    .build(); 
```

这会自动为您处理提示（甚至在桌面上做一些很棒的魔法来打开浏览器）。或者，如果您正在寻找如何在幕后做到这一点，更多信息在这里： [http ://code.google.com/p/google-api-java-client/source/browse/shared/shared-sample -cmdline/src/main/java/com/google/api/services/samples/shared/cmdline/oauth2/OAuth2Native.java?repo=samples#102](http://code.google.com/p/google-api-java-client/source/browse/shared/shared-sample-cmdline/src/main/java/com/google/api/services/samples/shared/cmdline/oauth2/OAuth2Native.java?repo=samples#102)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T01:24:47.000

设置`GoogleAccessProtectedResource`对象后，您没有将其正确传递到日历服务类。

改变这个：

```
com.google.api.services.calendar.Calendar service = 
    new com.google.api.services.calendar.Calendar(httpTransport,
                                                  jsonFactory); 
```

对此：

```
com.google.api.services.calendar.Calendar service = 
    new com.google.api.services.calendar.Calendar(httpTransport, 
                                                  accessProtectedResource, 
                                                  jsonFactory); 
```

那应该这样做。

# c# - 通过 ASP.NET 以 JSON 格式保存来自 MS SQL 2008 的字符串

> ID：10836692
> 
> 赞同：0
> 
> 时间：2012-05-31T15:33:30.863
> 
> 标签：c#, asp.net, sql, ios, json

我用 Visual Studio 2010 构建了一个 Web 服务。语言是 C# 和 ASP.NET 3.5。

网络服务器将数据从我的 ms sql server 2008 发送到 JSON 格式的 iPhone。

但我收到一个字符串值，其中包含来自 SQL Server 的所有数据。我希望网络服务将数据单独发送给我，以便我可以在 iPhone 上更好地使用它。

这是我的 C# 类：

```
 namespace WebService1
{
    public class RaumklassenHelper
    {

        internal static string Raumklasse()
        {
            string raumKlassenObject = "";

            using (SqlConnection con = new SqlConnection(@"Data Source=Localhost\SQLEXPRESS;Initial Catalog=BOOK-IT-V2;Integrated Security=true;"))
            using (SqlCommand cmd = new SqlCommand(@"SELECT BEZEICHNUNG FROM RAUMKLASSE", con))
            {

                con.Open();
                using (SqlDataReader rdr = cmd.ExecuteReader())
                {

                    while (rdr.Read())
                    {
                        if (rdr["BEZEICHNUNG"]  != DBNull.Value)
                         {

                              raumKlassenObject += rdr["BEZEICHNUNG"].ToString();
                         }

                    }

                }
            }

            return raumKlassenObject;
        }
    }
} 
```

这是我的网络方法：

```
[ScriptMethod(ResponseFormat = ResponseFormat.Json)]
        [WebMethod]
        public string Raumklasse()
        {
            return RaumklassenHelper.Raumklasse();
        } 
```

如何发送字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:35:29.963

你可以返回一个数组：

```
[ScriptMethod(ResponseFormat = ResponseFormat.Json)]
[WebMethod]
public string[] Raumklasse()
{
    return RaumklassenHelper.Raumklasse();
} 
```

然后显然适应了数据检索方法：

```
public class RaumklassenHelper
{
    internal static string[] Raumklasse()
    {
        List<string> raumKlassenObject = new List<string>();

        using (SqlConnection con = new SqlConnection(@"Data Source=Localhost\SQLEXPRESS;Initial Catalog=BOOK-IT-V2;Integrated Security=true;"))
        using (SqlCommand cmd = new SqlCommand(@"SELECT BEZEICHNUNG FROM RAUMKLASSE", con))
        {
            con.Open();
            using (SqlDataReader rdr = cmd.ExecuteReader())
            {
                while (rdr.Read())
                {
                    if (rdr["BEZEICHNUNG"] != DBNull.Value)
                    {
                        raumKlassenObject.Add(rdr["BEZEICHNUNG"].ToString());
                    }
                }
            }
        }
        return raumKlassenObject.ToArray();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T18:34:29.817

我发现使用将结果读入 DataTable 然后使用 linq 查询结果集可以很容易地返回 json 格式的响应。

```
namespace WebService1
{
 public class RaumklassenHelper
 {
    internal static string Raumklasse()
    {
        DataTable tbl = new DataTable();
        JavaScriptSerializer js = new JavaScriptSerializer();
        StringBuilder sb = new StringBuilder();

        using (SqlConnection con = new SqlConnection(@"Data Source=Localhost\SQLEXPRESS;Initial Catalog=BOOK-IT-V2;Integrated Security=true;"))
        using (SqlCommand cmd = new SqlCommand(@"SELECT BEZEICHNUNG FROM RAUMKLASSE", con))
        {

            con.Open();
            SqlDataReader rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection);
            tbl.Load(rdr);
            rdr.Close();
            var linqResults = from DataRow row in tbl.AsEnumerable()
                              select new { raumKlassenObject = row.Field<string>("BEZEICHNUNG") };
            js.Serialize(linqResults, sb);
            string returnJSON = sb.ToString();
            return returnJSON;
        }
    }
}
} 
```

# csv - 存储在 SQL 2012 FileTable 中的 150MB csv 文件 - 我如何查询要插入到表中的数据

> ID：10836694
> 
> 赞同：3
> 
> 时间：2012-05-31T15:33:33.497
> 
> 标签：csv, filestream, bulk, sql-server-2012, filetable

我有一个带有 Persons 表的简单数据库

```
UserId, Name,DOB 
```

该表包含 750,000 行（人）。

我收到一个可能包含 1000 万行的 CSV 文件

```
UserId, Address1, Address2, Address3, TownCity, Region, Country, 
Telephone1, Telephone2, Telephone3 
```

用户当前和之前的联系方式

该文件包含`usersId`在其中，因此我可以将联系人详细信息与用户匹配。

人员和联系方式之间存在一对多关系

我的最终目标是查询选择`UserId, Name, DOB, Address1, Address2......`等

目前我使用 .net 打开 csv 文件并逐行读取并将每条记录单独写入 SQL 服务器（可能有 1000 万条 sql 插入） - 这很慢，所以我正在寻找其他方法。

我正在试验 SQL 2012 FileTable/Stream - 所以我将 csv 文件存储在 FileTable 中并且可以这样查询

```
SELECT [file_stream], [name], [path_locator], [parent_path_locator],
       [file_type], [cached_file_size], [creation_time]  
FROM [MYDB_FileTable].[dbo].[AddressFileTable] 
```

有谁知道我是否可以查询 FileStream 和批量插入或任何其他处理核心 csv 数据的方式？

我看过

```
DECLARE @csv varchar(max)
SELECT @csv = convert(varchar(max), [file_stream])  FROM PKIFileTable 
```

但由于文件大小，这不起作用

欢迎任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T17:55:55.117

您可以将 SSIS 用于该任务。完成您需要的事情应该相当简单。

什么是慢？

为什么我之前的回答被删了？这里发生了什么？

我的回答基于最后一个条款：“任何其他处理核心 csv 数据的方式？”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T11:04:59.927

谢谢 Janus007 - 似乎有人指出了明显的问题 - 使用 SSIS。通常是最简单的答案。我正在使用 SSIS 成功地做到这一点

但我仍然想知道如何最好地查询存储在 Filestream 中的 CSV 文件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T16:06:33.637

Another solution could be to develop a CLR in C# and handle the FileStream with that, utilizing this method you can still use the nice language of TSQL and easily debug in C#.

# javascript - 通过ajax加载页面后初始化atk4 js

> ID：10836696
> 
> 赞同：2
> 
> 时间：2012-05-31T15:33:36.757
> 
> 标签：javascript, atk4

我正在尝试在几个月前开始的项目中使用 atk4。这个项目是一个应用程序，它有一个菜单并通过 ajax 在 div 中加载页面。菜单是固定的，永远不会重新加载。我想使用 atk4 生成新页面并完成数据库工作，而暂时保留已完成的工作。页面生成并加载正常，但通过 ajax 加载的组件没有增强，因为没有触发文档就绪事件。每次在相应的 div 中加载 ajax 页面时，我们都会触发一个事件。我们可以从该事件中调用一个或多个函数来初始化 atk4 js 系统并增强新组件吗？

我们的功能：

```
$(document).bind('afterajaxload', function(){
    //here we need to call atk4 js initialization to enhace the ajax loaded page.
}) 
```

谢谢（对不起我的英语不好）！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T23:32:42.877

如果您将 JavaScript 函数直接写入模板，则不应使用标准 jQuery 构造 $(function(){ .. })。此函数每页仅触发一次。

Agile Toolkit 通过引入替代函数 $.atk4(function(){ ... }) 来实现适当的功能，该函数在加载 AJAX 代码后正确触发。任何碰巧通过 AJAX 加载的东西都会被自动触发，所以你甚至不需要包装它。

为了让开发人员感到舒适，如果您使用 JavaScript 编写代码，这非常容易：

```
$object->js(true, 'your js here'); 
```

这是重要的注意事项。"$object" 必须直接或间接重新加载，否则它的 JS 代码将不会自动重新执行。您始终可以通过浏览器中的检查器/控制台查看脚本序列。

始终建议为您的 JavaScript 例程创建一个库，而不是将函数转储到全局命名空间中，但您可以在 JavaScript 文档中阅读。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-06T20:27:31.707

我正在使用 $object->js(true, 'your js here');，但有一个问题：

如果满足某些条件，我会将页面重定向到其他内容，js 函数如下：

```
top.location = "http://some-url.com?param1=AAA&param2=BBBB" 
```

但是 & 字符转换为：`&amp;`

```
I know i can use $this->api->redirect('some-url', array('param1'=>AAA, 'param2'=>BBB)); 
```

但由于某些原因，我必须使用 js 函数，但只能正确读取 html 字符。如何完成这个？

# c - 在 C 中注册回调函数

> ID：10836702
> 
> 赞同：1
> 
> 时间：2012-05-31T15:33:48.350
> 
> 标签：c, callback, kernel, space

我是一些 Linux 内核空间代码。我希望用户空间中的应用程序能够通过调用内核空间代码中的函数并传递该回调函数的地址来在内核空间代码中注册回调函数。然后，内核空间代码将在稍后运行时执行回调函数。我相信内核空间代码应该是这样的：

```
typedef void (*callback_func) (void);
callback_func callback;

static void registerCallBack(callback_func funct){callback = funct;}

//another kernel space method
funct(); 
```

但是，我对正确的 typedef 以及它是否能正常工作有点不确定。任何人都可以确认此功能或在这方面提供任何建议吗？我现在无法测试这个，因为我正在等待内核空间代码的其余部分完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T16:05:07.663

你`typedef`看起来不错，虽然我建议重命名`callback_func`为类似的东西`callback_func_t`，否则它看起来像一个变量而不是一个类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T17:04:07.327

您不能直接从内核调用用户空间函数。一种可能的解决方案是使用[信号](http://linux.die.net/man/7/signal)。您可以从内核代码向给定进程发送信号。信号处理程序将作为一种回调函数工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T18:02:13.287

如果您只是想从内核运行用户空间应用程序，那么[这](http://www.ibm.com/developerworks/linux/library/l-user-space-apps/index.html "这个")将详细描述如何执行此操作。

# ios - 同一设备的多个 CBPeripheral

> ID：10836703
> 
> 赞同：3
> 
> 时间：2012-05-31T15:33:51.797
> 
> 标签：ios, events, core-bluetooth, bluetooth-lowenergy

使用 CoreBluetooth 框架访问低功耗蓝牙设备时，为外围设备[`CBCentralManager`](http://developer.apple.com/library/ios/#documentation/CoreBluetooth/Reference/CBCentralManager_Class/translated_content/CBCentralManager.html)返回 a [`CBPeripheral`](http://developer.apple.com/library/ios/#documentation/CoreBluetooth/Reference/CBPeripheral_Class/translated_content/CBPeripheral.html)。

外围设备上有多种服务可用，我想将处理不同服务的特征值更新的代码拆分为多个类。因此，我需要将多个`id<CBPeripheralDelegate>`代表附加到外围设备。但是，这是不可能的，因为只支持一个委托。

*   有没有办法`CBPeripheral`为同一个外围设备获取多个实例？

    *如果多个应用程序有可能访问同一个外围设备，它们会接收不同的`CBPeripheral`实例吗？如果是，他们是否看到来自其他应用程序的更新？（比如说，应用程序 A 向一个特征写入一个值，应用程序 B 的代理是否也收到了 [– peripheral:didWriteValueForCharacteristic:error:] 消息？）*

*   是否有任何优雅的方法来支持将事件处理代码拆分为多个类？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-24T01:22:08.377

[CoreBluetooth](https://stackoverflow.com/questions/18897304/corebluetooth-how-to-design-code-for-many-characteristics-30-40)的[答案](https://stackoverflow.com/a/18906146/774)：How to design code for many features (30 - 40)? 有一些设计技巧在这里可能会有所帮助。简而言之，创建一个中介类，它可以是一个并支持多个特征类注册他们想要的任何特征。`CBPeripheralDelegate`

# ruby-on-rails - 我可以为我的整个 Rails 应用程序关闭protect_from_forgery 吗？

> ID：10836709
> 
> 赞同：3
> 
> 时间：2012-05-31T15:34:13.383
> 
> 标签：ruby-on-rails, ios, devise, csrf

我正在创建一个 Rails 应用程序来与 iOS 应用程序交互。我所有的请求都在传递/期待 JSON，所以我在发布时遇到了 CSRF 问题。我可以关闭protect_from_forgery（不理想），但我不想在每个控制器的基础上这样做，因为我正在使用设计，我必须对每个控制器进行子类化。有没有办法为整个应用程序关闭它，或者有什么更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:50:08.613

我不知道它是否有效，但我会尝试这个

```
class ApplicationController < ActionController::Base
  skip_before_filter :verify_authenticity_token
end 
```

# entity-framework-4 - 如何将 EF 4.3 显式迁移与多个数据库（dev、staging、prod）一起使用

> ID：10836714
> 
> 赞同：1
> 
> 时间：2012-05-31T15:34:21.500
> 
> 标签：entity-framework-4, ef-code-first, database-migration, entity-framework-migrations

我使用带有显式迁移的 EF 4.3。在我的本地开发数据库上定义新迁移并调用 Update-Database 时，一切正常，只有未应用的迁移应用于数据库。

但是当我尝试迁移另一个数据库（在迁移之前与我的开发数据库处于相同状态）时

`Update-Database -ConnectionStringName=MyProdConnectionStringName`

似乎数据库状态和现有的 __MigrationHistory 表被忽略，并且 ef 将所有迁移应用到我的 prod db，这导致失败，因为那里已经有一些表。

也许它与知道相关，我为我的表使用了自定义模式`[Table("TabName", Schema = "stepid")]`。__MigrationHistory 表具有数据库的默认架构（我的开发机器上的 dbo 和我的 prod 环境上的项目）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T10:46:06.173

好的，似乎 __MigrationHistory 表必须在 schema 中`dbo`。EF 迁移将在创建它时使用数据库的默认架构（在我的情况下，它称为“项目”），然后在调用`Update-Database`它时不会查询该表，但假定从未有任何迁移应用于数据库。

当我手动将架构更改为 dbo 时，它会正常工作。

# linux-kernel - 在运行时调整 MTD 分区大小

> ID：10836715
> 
> 赞同：5
> 
> 时间：2012-05-31T15:34:27.207
> 
> 标签：linux-kernel, embedded-linux, partitioning

我正在使用嵌入式设备，并希望使他们能够通过 Linux 调整其 MTD 分区的大小而无需重新启动。

问题是我的 Linux 映像大小增加了，并且它所在的当前 MTD 分区 (mtd0) 现在太小了。但是，紧随其后的分区 (mtd1) 是用于存储配置信息的 JFFS2 部分，因此不能通过重新启动来调整大小，因为配置可能会丢失。

我的目标是这样的：

```
1\. Copy contents of JFFS2 into /tmp/
2\. Unmount JFFS2 from mtd1
3\. Increase the starting offset + reduce size of mtd1 by X bytes (or delete mtd1 and create new mtd of proper size and offset)
4\. Mount JFFS2 on new mtd1 and restore contents from /tmp/
5\. Increase the size of mtd0 by X bytes
6\. Burn new (larger) Linux image into mtd0 (the new image will contain a device tree with an updated partition structure)
7\. Reboot 
```

几年前，我发现了“mtd-utils”的提议补丁：

```
http://article.gmane.org/gmane.linux.drivers.mtd/30949
http://article.gmane.org/gmane.linux.drivers.mtd/30950
http://article.gmane.org/gmane.linux.drivers.mtd/30951 
```

以此为指导，我能够编写内核和用户空间代码来创建一个新的 MTD 分区，我可以在该分区上挂载 JFFS2。但是，此代码无法正确删除分区。即使从 mtd1 卸载 JFFS2 并调用`put_mtd_device`，何时`del_mtd_device`调用内核也会抱怨：

```
user.notice kernel: Removing MTD device #1 (jffs2) with use count 1 
```

我想知道的是：

```
1\. How to fix the patch to allow deleting my old mtd1
2\. How to change the starting offset of mtd1 instead of creating/deleting partitions 
```

我尝试联系补丁的作者，但他们的电子邮件不再有效，所以我将不胜感激任何建议！

* * *

**更新：**

似乎`mtd_open()`in`mtdchar.c`触发了 a `get_mtd_device()`，这可能是额外`usecount`增量的原因。但是我的用户空间应用程序需要调用`open()`分区来发送它`ioctl()`来删除分区：/ catch 22? 有没有更正确的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-15T20:19:50.630

我最终解决了这个问题，让我修补的 mtd 实用程序增加“mtd0”大小，然后创建一个正确减小大小的全新分区来安装 JFFS，这让我有机会将配置信息复制到新的闪存位置。

为了降低复杂性，我也做了它，所以我不能多次运行这个应用程序。它最终成为“运行一次，做你的事，重新启动”类型的程序。

* * *

**更新：**

这是我的代码，认为它可以使一些人受益：

[https://github.com/mikzat/mtd_runtime_partition](https://github.com/mikzat/mtd_runtime_partition)

# python - Python 中的 ID3 标记 - Python 是否是此任务的错误语言？

> ID：10836716
> 
> 赞同：1
> 
> 时间：2012-05-31T15:34:29.513
> 
> 标签：python, perl, id3

我正在尝试编写一个 Python 脚本来读取我的 MP3 的文件名，当它发现缺少的 Artist 标签时，它将从文件名的第一部分获取它。我的大多数 MP3 的标题都是“艺术家 - Title.mp3”。

但是没有一个 ID3 标签阅读器在 Python 中工作得很好。ID3 不会读取 1.1 之后的任何标签，并且自 2002 年以来就没有开发过。当文件缺少标签时，Mutagen 会引发异常。Eye3D 需要安装二进制文件才能使库正常工作，pylibid3 也是如此。

我是否使用了错误的语言？我听说 Perl 有一些很棒的 ID3 标签库。我是一个新手，所以切换语言（我已经有一段时间没有读过关于 Perl 的书了）意味着从头开始。但如果 Python 是错误的语言，我愿意这样做。

有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T16:38:38.587

使用诱变剂处理异常很容易：

```
from mutagen.id3 import ID3, TPE1, ID3NoHeaderError
try:
    audio = ID3(filename)
except ID3NoHeaderError:
    audio = ID3()

audio.add(TPE1(encoding=3, text=u'Artist'))
audio.save(filename) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T16:46:24.790

这是一个执行您想要的 Perl 脚本。我经常用这个。它甚至可以在进行更改之前预览更改。

您确实需要安装几个 Perl 模块（MP3::Info 和 MP4::Info），尽管您可以从代码中删除 MP4 行并跳过该模块。

```
#!/usr/bin/perl

use strict;
use warnings;
use Cwd;
use File::Copy;
use File::Basename;

# Load MP3/MP4 modules and set them up to use UTF-8 characters
# (Unicode-like support, to see accents, etc.).
use MP3::Info qw(:all);
use_mp3_utf8(1);
use MP4::Info qw(:all);
use_mp4_utf8(1);

my @ARGS;
################################################################################
# Subroutine: RemoveIllegalFilenameCharacters
# Inputs:     $filename
# Outputs:    $filename
################################################################################
sub RemoveIllegalFilenameCharacters {
    my $filename = shift;

    if ($filename =~ m/\\/) { $filename =~ s/\\//g }
    if ($filename =~ m/\//) { $filename =~ s/ \/ / - /g }
    if ($filename =~ m/\//) { $filename =~ s/\///g }
    if ($filename =~ m/:/) { $filename =~ s/://g }
    if ($filename =~ m/\*/) { $filename =~ s/\*//g }
    if ($filename =~ m/\?/) { $filename =~ s/\?//g }
    if ($filename =~ m/"/) { $filename =~ s/"//g }
    if ($filename =~ m/</) { $filename =~ s/<//g }
    if ($filename =~ m/>/) { $filename =~ s/>//g }
    if ($filename =~ m/\|/) { $filename =~ s/\|//g }

    return $filename;
}

################################################################################
# Subroutine: Rename
# Inputs:     $test (indicates test mode)
# Outputs:    number of files to be changed (in test mode)
################################################################################
sub Rename {
  my $test = shift;
  my $destDir = ""; # hard-coded permanent destination, if desired

  my @tests;
  foreach my $file (@ARGS) {
    # Get rid of the Mac OS resource fork files.
    if ($file =~ m/^\._/) {
      unlink "$file";
      next;
    }

    if (! -f $file) {
      warn "'$file' does not exist!\n";
    }
    else {
      # If $destDir wasn't set above, then that means it should be
      # set to the original dir of each file.
      if (!($destDir)) {
    $destDir = dirname($file);
      }

      my $extension = $file;
      $extension =~ s/.*\.//;

      my $tag;
      if ($extension =~ m/^mp3$/i) {
    ($tag = get_mp3tag($file)) || warn "'$file' does not contain ID3 tags (it may not even be an MP3 file!)\n";
      }
      else {
    # If it's not MP3, try MP4
    ($tag = get_mp4tag($file)) || warn "'$file' does not contain ID3 tags (it may not even be an AAC/M4A/M4P file!)\n";
      }
      if (!($tag)) {
    # No $tag was returned.  Go to the next $file.
    next;
      }

      # DEBUG!  Show all the tag names.  Could be modifed to show all the tag values too.
      if (0) {
    print join("\n", keys %{$tag}) . "\n";
      }

      # Set the rename format depending on if we're under the $DOWNLOAD_DIR or not.
      my $newFile = $$tag{"ARTIST"} . " - " . $$tag{"TITLE"} . ".$extension";

      if (($$tag{"ARTIST"} eq "") || ($$tag{"TITLE"} eq "")) { warn "\n*** WARNING! This track is missing some info:\n\tOriginal Name: $file\n\tNew Name: $newFile\n\n" }
      $newFile = RemoveIllegalFilenameCharacters($newFile);

      # If current filename ($file) already matches the new filename ($newFile),
      # don't bother continuing (filename is already in the correct format).
      if ($file eq $newFile) {
    # If we're not choosing to move all files,
    # and if the filename is already in the correct format,
    # go to the next $file.
    next;
      }
      if ($destDir ne ".") { $newFile = $destDir . "/" . $newFile }
      if (!($test) && -f $newFile) {
    die "Unable to move '$file' to '$newFile',\nsince there's already a file named '$newFile'!\nStopped";
      }
      if ($test) {
    push @tests, $newFile;
      } else {
    print "Moving '$file' to '$newFile'\n";
    move($file, $newFile) || die "Unable to move file!\n";
      }
    } # End of if-then-else checking if file exists
  } # End of FOR loop looping through files in @ARGS.

  if ($test && scalar(@tests)) {
    print "Test run - new filenames: \n  ";
    print join("\n  ", sort(@tests));
  }

  return scalar(@tests);
}

################################################################################
# MAIN ROUTINE

if (scalar(@ARGV) == 0) {
    # If no args, use every music file in current directory.
    opendir(DIR, ".");
    @ARGS = sort(grep(/\.mp3$|\.aac$|\.m4a$|\.m4p$/i, readdir(DIR)));
    closedir(DIR);

    if (scalar(@ARGS) == 0) {
      print "USAGE: " . basename($0) . " <music-files>\n\n";
      print "If no filenames are specified, any music files (MP3/AAC/M4A/M4P) in the current directory will be used.\n";
      exit 1;
    }
}
else { @ARGS = @ARGV }

if (Rename(1)) {
    print "\n\nDo the test results look good?\n";
    print " n  - No they don't.  Do not rename the files!\n";
    print "[y] - Yes they do.  Rename the files and leave them in their original folder(s).\n";
    print " ";
    my $choice = <STDIN>;
    chomp $choice;
    # Only do the move if we're in the $DOWNLOAD_DIR area.
    # This allows us to use the default (null) response to process renames in a non-download dir.
    if (("$choice" eq "") || ("$choice" eq "y")) {
    Rename(0);
    }
}
else {
    print "No actions needed.\n";
} 
```

# javascript - 如何在 Chrome 浏览器的 JS Fiddle 输出窗口中引入 firebug 检查器

> ID：10836718
> 
> 赞同：15
> 
> 时间：2012-05-31T15:34:33.137
> 
> 标签：javascript, firebug, jsfiddle

我遇到有人在堆栈溢出中发布的 JSfiddle 仅在 JSFiddle 的输出窗口中自动打开了 firebug 控制台。有人知道如何实现吗？我猜他们在托管资源中使用了以下链接。

它可以在 Firefox 中使用，只需将其添加到托管资源中即可。

我希望这可以在 Chrome 中工作。我正在使用带有 Firebug 扩展的 Chrome 19.0

谢谢

[https://getfirebug.com/firebug-lite.js](https://getfirebug.com/firebug-lite.js)

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-31T15:41:00.797

只需将该 URL 粘贴到托管资源下的“JavaScript/CSS URL”框中，单击加号按钮，然后单击“运行”。您应该会在结果窗口中看到 firebug lite。

编辑：这个版本似乎在 Chrome 中工作：[https ://getfirebug.com/firebug-lite-debug.js](https://getfirebug.com/firebug-lite-debug.js)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-06-23T09:56:44.913

在 Frameworks & Extensions 中选择 jQuery 1.x (edge) 然后在下面，选择 firebug lite，就是这样

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-01T08:40:57.543

即使它已经过时，您也可以尝试下面的 jsFiddle：

# [jsFiddle 与 Firebug](http://jsfiddle.net/soundar24/nhdvqbsx/)

在您的应用程序本身中，您可以在 head 部分添加以下脚本，以嵌入 firebug：

```
<script src="https://getfirebug.com/firebug-lite-debug.js"></script> 
```

# objective-c - 加载活动指示器时如何禁用iphone中的所有控件？

> ID：10836719
> 
> 赞同：1
> 
> 时间：2012-05-31T15:34:33.303
> 
> 标签：objective-c

我在从 Web 服务获取数据时显示活动指示器，并且我想在活动指示器加载甚至导航栏时禁用所有控件。我也设置了

```
 [self.view setUserInteractionEnabled:NO];
     [self.navigationController.navigationBar setUserInteractionEnabled:NO];
     [searchingBar setUserInteractionEnabled:NO]; 
```

但它不能正常工作。任何人都知道如何在加载活动指示器时禁用所有控件；

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T18:21:00.800

如果您不想使用任何 API，请在活动指示器后面插入一个透明的全屏 UIView。它会“吃”东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:39:46.397

只需使用可在 Cocoa Controls 或 GitHub 上找到的 SVProgressHud。

# authentication - 您将如何实现“以不同用户身份查看网站”功能？

> ID：10836722
> 
> 赞同：1
> 
> 时间：2012-05-31T15:34:38.957
> 
> 标签：authentication, web-applications

我们正在为网站设计一项功能，该功能应允许一些工作人员以其他注册用户的身份查看我们的网站。我真的很想听听那些已经考虑过这种功能或实现了类似功能的人。

这应该是一个社区维基。如果可能，我会将其标记为一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T21:33:37.787

我见过两种方法：

1.  url 参数'changeToUser=login'。过滤器验证您是否有足够的权限来更改您的身份，然后在春天切换，比如说，您的委托人。如果需要，您可以在会话中添加标志，表明您的真实身份，并且您有权一次又一次地切换。没有标志，您将无法在不注销的情况下再次切换。这种方法在测试流应用程序时非常有用（第一个用户做某事，然后第二个用户响应等）。在 dev/uat 服务器上，您的应用程序可能会呈现正确的链接，让您一键切换到您需要的用户

2.  您在登录期间更改了您的 ID。您使用了伪造的登录名，例如 my-login#login-of-user-i--pretend 和您的真实密码。您只需在 ldap 身份验证器（或您使用的任何东西）之前添加另一个身份验证器

第二个适用于没有流/jbpm 进程的小型应用程序，并且当您宁愿使用此功能做某事时，因为真正的用户生病/不在办公室并且目前无法登录。但是当您想测试需要大量开关的流应用程序时，第一个解决方案会更好，尤其是渲染链接

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:40:29.250

我过去做过这两种方法。

最简单的方法是只允许具有足够权限的人以任意用户身份登录而无需密码。这只是一个会话中的登录，完全用你假装成为的人代替你曾经的身份。通过注销并再次登录，您可以回到自己。

另一种是在会话中保留一个标志，说“我真的是用户 ABC”，并在适当的管理页面上检查该标志（该机制无关紧要，但通常可以巧妙地完成并且在大多数框架中基本上是不可见的）但切换会话用户到用户 XYZ。将使用与第一个相同的“跳过密码”机制。

后者更复杂，但消除了注销/登录的需要，并允许使用一些不错的技巧，例如在 iframe 中运行站点并保持管理菜单可见以“退出”特殊模式等。

# sql - 在唯一约束之前清理 SQL 数据

> ID：10836723
> 
> 赞同：4
> 
> 时间：2012-05-31T15:34:43.707
> 
> 标签：sql, performance, postgresql, unique, duplicate-removal

我想在对两列施加唯一约束之前清理表中的一些数据。

```
CREATE TABLE test (
 a integer NOT NULL,
 b integer NOT NULL,
 c integer NOT NULL,
 CONSTRAINT a_pk PRIMARY KEY (a)
);

INSERT INTO test (a,b,c) VALUES
 (1,2,3)
,(2,2,3)
,(3,4,3)
,(4,4,4)
,(5,4,5)
,(6,4,4)
,(7,4,4);

-- SELECT a FROM test WHERE ???? 
```

**输出应该是`2,6,7`**

我正在寻找重复*的第一行之后的所有行*`b,c`

前任：

*   第 1,2 行有 (2,3) 作为 b,c 第 1 行是可以的，因为它是第一行，第 2 行不是。

*   第 4,6,7 行有 (4,4) 作为 b,c 第 4 行是可以的，因为它是第一行，6,7 不是。

然后我会：

```
DELETE FROM test WHERE a = those IDs; 
```

..并添加唯一约束。

我正在考虑与自身进行测试相交，但不确定从那里去哪里。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T22:47:29.303

我进行了几次测试。事实证明，该`EXISTS`变体要快得多——正如我所预料的那样，与[@Tometzky 发布](https://stackoverflow.com/a/10837954/939860)的相反。

在 PostgreSQL 9.1.2 上进行 10.000 行的测试床，设置不错：

```
CREATE TEMP TABLE test (
  a serial
 ,b int NOT NULL
 ,c int NOT NULL
);

INSERT INTO test (b,c)
SELECT (random()* 100)::int AS b, (random()* 100)::int AS c
FROM   generate_series(1, 10000);

ALTER TABLE test ADD CONSTRAINT a_pk PRIMARY KEY (a); 
```

在第一轮和第二轮测试之间，我跑了：

```
ANALYZE test; 
```

当我最终应用 DELETE 时，删除了 3368 个重复项。如果您有更多或更少的重复项，性能可能会有所不同。

我对每个查询运行了几次`EXPLAIN ANALYZE`并获得了最好的结果。一般来说，最好的与第一个或最差的几乎没有区别。
裸露`SELECT`的（没有`DELETE`）显示类似的结果。

### 1\. CTE 与`rank()`

总运行时间：150.411 ms
总运行时间：149.853 ms -- ANALYZE 之后

```
WITH x AS (
    SELECT a
          ,rank() OVER (PARTITION BY b, c ORDER BY a) AS rk
    FROM   test
    )
DELETE FROM test
USING  x
WHERE  x.a = test.a
AND    rk > 1; 
```

### 2\. CTE 与`row_number()`

总运行时间：148.240 ms
总运行时间：147.711 ms -- ANALYZE 之后

```
WITH x AS (
    SELECT a
          ,row_number() OVER (PARTITION BY b, c ORDER BY a) AS rn
    FROM   test
    )
DELETE FROM test
USING  x
WHERE  x.a = test.a
AND    rn > 1; 
```

### 3.`row_number()`在子查询中

总运行时间：134.753 ms
总运行时间：134.298 ms -- ANALYZE 之后

```
DELETE FROM test
USING (
    SELECT a
          ,row_number() OVER (PARTITION BY b, c ORDER BY a) AS rn
    FROM   test
    )  x
WHERE  x.a = test.a
AND    rn > 1; 
```

### 4.`EXISTS`半连接

总运行时间：143.777 毫秒
总运行时间：**69.072 毫秒** ——在 ANALYZE 之后

```
DELETE FROM test t
WHERE EXISTS (
    SELECT 1
    FROM   test t1
    WHERE  t1.a < t.a
    AND   (t1.b, t1.c) = (t.b, t.c)
    ); 
```

第二次运行的不同之处在于切换到*Hash Semi Join* 而不是额外的*Sort + Merge Semi Join*。

### 结果

*   `EXISTS`显然以最新的表统计信息获胜。
*   在子查询中使用过时的统计信息`row_number()`是最快的。
*   `rank()`是最慢的变体。
*   CTE 比子查询慢。
*   `ANALYZE`（更新的统计数据）有助于提高性能并且*可以*提供很多帮助。[Autovacuum](http://www.postgresql.org/docs/current/interactive/routine-vacuuming.html)（默认）应该或多或少地自动处理这个问题 - 除了临时表或对表进行重大更改之后。[在此处](https://dba.stackexchange.com/questions/18664/are-regular-vacuum-analyze-stil-recommended-under-9-1)或[此处](https://dba.stackexchange.com/questions/35327/should-i-manually-vacuum-my-postgresql-database-if-autovacuum-is-turned-on)阅读更多信息。

### 测试 100.000 行

我用 100.000 行和 63045 个重复重复了测试。类似的结果，只是`EXISTS`速度较慢，即使在`ANALYZE`.

1.  总运行时间：1648.601 毫秒
2.  总运行时间：1623.759 毫秒
3.  总运行时间：1568.893 毫秒
4.  总运行时间：1692.249 毫秒

将统计目标提高到 1000，然后提高到最大值 10000（在现实生活中过大），另一个`ANALYZE`将所有查询加快了约 1%，但查询规划器仍然使用*Sort + Merge Semi Join* for `EXISTS`。

```
ALTER TABLE test ALTER COLUMN b SET STATISTICS 10000;
ALTER TABLE test ALTER COLUMN c SET STATISTICS 10000;
ANALYZE test; 
```

只有在我强迫规划器避免合并连接之后，规划器才使用*哈希半连接*再次占用一半时间：

```
SET enable_mergejoin = off 
```

4.  总运行时间：850.615 毫秒

### 更新

从那时起，查询计划器得到了*改进。*在 PostgreSQL 9.1.7 的重新测试中直接使用*Hash Semi Join*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T16:56:40.277

使用[窗口函数](http://www.postgresql.org/docs/current/static/tutorial-window.html)应该比[这个答案](https://stackoverflow.com/a/10836872/15862)快得多：

```
select a
from (
  select a, rank() over (partition by b, c order by a) as rank
  from test ) as _
where rank>1; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T15:42:26.590

```
select o.a from test o
where exists ( select 'x' 
                 from test i
                where i.c = o.c
                  and i.b = o.b
                  and i.a < o.a
            ); 
```

Thanks to a coworker!

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T18:51:03.310

我会试试这个：

```
delete from
  test
where
  a not in (
    select   min(a)
    from     test
    group by b,c) 
```

我的机器上的 20 到 60 毫秒，对于它的价值，分析不会影响计划。

```
 Delete on test  (cost=237.50..412.50 rows=5000 width=6)
   ->  Seq Scan on test  (cost=237.50..412.50 rows=5000 width=6)
         Filter: (NOT (hashed SubPlan 1))
         SubPlan 1
           ->  HashAggregate  (cost=225.00..235.00 rows=1000 width=12)
                 ->  Seq Scan on test  (cost=0.00..150.00 rows=10000 width=12) 
```

# forms - 将四个独立表单的内容统一起来的水晶报表

> ID：10836728
> 
> 赞同：0
> 
> 时间：2012-05-31T15:35:03.600
> 
> 标签：forms, crystal-reports, report

我在大约 72 小时内完成了四份单独的表格。我需要运行一个报告，将这四个单独的表格（带有不同的表格）的内容合并到一个主报告中。现在，可能我们可以简单地按剧集编号进行拉取。但这可能不是真的。四个系列中的第一个形式通常在入院前完成，并且可能存在于单独的情节中。假设它在不同的情节中，我如何最好地将这四种形式整合到一个报告中。在你回答之前，还有一个复杂的问题：这些表格每年都会重复一次，而且这些表格与最初的录取情况相同（至少四分之三）。因此，我需要注意不要将相隔一年的多条记录包含在同一个主报告输出中。

以下是几年后记录的样子：

```
Record #    Episode #   Date    Form
1   1   5/01/2012   Form     A
2   2   5/01/2012   Form     B
3   2   5/01/2012   Form     C
4   2   5/02/2012   Form     D
5   2   4/25/2013   Form     B
6   2   4/27/2013   Form     C
7   2   4/29/2013   Form     D
8   2   4/12/2014   Form     B
9   2   4/16/2014   Form     D 
```

因此，记录 1-4 应合并为一份主报告。但假设我在 2013 年 6 月 1 日运行报告。我想说明我是想要原始录取报告（记录 1-4）还是年度更新（记录 5-7） 注意，表格 A 只在录取时完成。当然，到 2014 年 5 月 1 日，我可能想要录取或随后的两个年度审查中的任何一个，注意到第二次年度审查缺少表格。

我知道这很乱。处理这个问题的最佳方法是什么？

我能想到的最安全但最需要手动操作的方法是向运行报表的用户提供四个下拉字段，这些字段返回现有表单并让用户手动选择他们想要组合的表单。不过，我有点担心用户错误…… 有没有更好的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T19:38:04.580

我最初的想法是一份主要报告，其中包含四个子报告 (AD)，通过患者 ID 链接在一起。您可以根据需要隐藏/显示每个子报告。

如果主报告包含患者的入院信息，那么您可以使用它来驱动一些逻辑。

如果您需要更多帮助，则需要更简洁地阐明规则。

# ios - 延迟后调用的地图视图 viewForAnnotation

> ID：10836730
> 
> 赞同：0
> 
> 时间：2012-05-31T15:35:09.073
> 
> 标签：ios, mkmapview

我正在我的 iPad 应用程序中实现一个功能，以显示一个带有自定义注释的地图视图。出于某种原因， - (MKAnnotationView *) mapView:(MKMapView *)mapView viewForAnnotation:(id ) 注释方法在地图加载后 1-2 秒被调用，我认为这是很多时间。

问题是，如果您在图钉加载之前从地图视图导航到另一个视图，则应用程序会因访问错误而崩溃。因此，我认为这 1-2 秒的延迟不应该存在。

没有什么特别的事情发生，只有几 (3) 个引脚可以显示，所以这不应该是性能问题。

如果您对此有解决方案，请告诉我。

编码：

**MAPVIEW控制器**

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
    [self setTitle:self.pageTitle];

    [self.navigationController.navigationBar setTintColor:[UIColor lloydsNavBarTintColour]];
    [self.mapView setDelegate:self];

    MKCoordinateRegion region = { {0.0, 0.0 }, { 0.0, 0.0 } };
    region.center.latitude = 53.566414;
    region.center.longitude = -0.922852;
    region.span.longitudeDelta = 10.0f;
    region.span.latitudeDelta = 10.0f;
    [self.mapView setRegion:region animated:YES];

    ACNEfficiencyAnnotation *annotation = [[ACNEfficiencyAnnotation alloc]init];

    [annotation setCoordinate:CLLocationCoordinate2DMake(55.5783462524414,-4.39453077316284)];

    [self.mapView addAnnotation:annotation];
}

- (MKAnnotationView *) mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>) annotation
{
    self.annotationView = [[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:@"pin"];

    return self.annotationView;
} 
```

**注释实现：**

```
@interface ACNEfficiencyAnnotation : NSObject <MKAnnotation>
{

}

@property (nonatomic, assign) CLLocationCoordinate2D coordinate;
@property (nonatomic, copy) NSString *title;
@property (nonatomic, copy) NSString *subtitle;
@property (nonatomic, strong) ACNEfficiencyLocation *location;

@end

@implementation ACNEfficiencyAnnotation

@synthesize coordinate;
@synthesize title;
@synthesize subtitle;
@synthesize location;

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:51:14.153

您应该使用`dequeueReusableAnnotationViewWithIdentifier`在委托方法上准备注释，而不是使用要重用的 viewController 的属性。

viewController 的内存管理一定有问题，当视图控制器被释放并且它的视图被卸载时，检查你是否正在释放并将地图视图设置为 nil。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-07T23:37:19.560

您正在设置属性，并在每次调用委托时`self.annotationView`创建一个新的。`MKAnnotationView`实例化属性并在委托方法中`viewDidLoad`返回。`self.annotationView`

# javascript - 点对点 - 什么时候可用？

> ID：10836732
> 
> 赞同：1
> 
> 时间：2012-05-31T15:35:14.650
> 
> 标签：javascript

这可能吗？这会很快实现吗？

这是[高级 Google 搜索](https://www.google.com/search?hl=en&lr=&safe=off&tbs=qdr%3Ay&q=javascript%20advanced%20search&oq=javascript%20advanced%20search&aq=f&aqi=g1g-K1&aql=&gs_l=serp.3..0j0i30.84129.95890.0.96145.31.17.3.11.13.0.87.1072.17.17.0...0.0.F1_eRMT-UYA&pbx=1&biw=1214&bih=885&cad=cbv&sei=cY7HT7SZCunb0QHxjfGwDw#hl=en&lr=&safe=off&tbs=qdr:y&sclient=psy-ab&q=javascript+websockets+peer+to+peer&oq=javascript+websockets+peer+to+peer&aq=f&aqi=q-A1&aql=&gs_l=serp.3..33i29.2993.7674.0.7836.23.18.5.0.0.0.79.1238.18.18.0...0.0.AsTdCCD1ssM&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.,cf.osb&fp=368c51b11e74cdf8&biw=1214&bih=885)，在 JavaScript websockets 点对点

仅过滤去年。

**按年份相关的 SO**

[2009 后点对点网络套接字计划](https://stackoverflow.com/questions/1032006/will-html5-allow-web-apps-to-make-peer-to-peer-http-connections)

[2011 年发布 - 我认为不可能](https://stackoverflow.com/questions/8018544/can-you-connect-client-to-client-via-web-sockets-without-touching-the-server)

[2011 年发布 - 不可能 + 大量链接](https://stackoverflow.com/questions/7022383/how-to-make-a-browser-to-browser-peer-to-peer-connection)

[2011 年发布 - Horizo​​n 上的 WebRTC - 迄今为止的最佳答案](https://stackoverflow.com/questions/6993042/is-webrtc-implemented-in-any-browsers-yet)

对于当前状态，请检查由 Google 维护[的 webrtc 站点](http://www.webrtc.org/)……这可能会帮助您了解何时可以从对等切换到代理到对等……到对等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T16:07:32.300

这个问题得到了[回答](https://stackoverflow.com/a/7933140/1002469)——在底部附近寻找“WebRTC”。

您所说的不是 Websockets 规范的一部分，而是称为 WebRTC 的东西，特别是对等数据 API。

目前还没有浏览器实现它，但 Chrome 和 Firefox 已经开始实现 WebRTC 的一部分，并且可能也会实现它。

# visual-studio-2010 - MSBuild - 转换 web.config

> ID：10836736
> 
> 赞同：0
> 
> 时间：2012-05-31T15:35:19.580
> 
> 标签：visual-studio-2010, msbuild, continuous-integration, tfsbuild

我已经使用 CIBuildWithCopyDirectoryTemplate.xaml 中定义的默认工作流在 TFS2010 上设置了 CI 构建。

它似乎正在改变 web.config，但我一生都无法弄清楚它是在哪里定义的。我的 csproj 文件中有一个`AfterBuild`任务，但我认为 MSBuild 没有使用它？

在仔细研究了 XAML 作为文本文件及其工作流形式之后，我完全被难住了，我还没有时间阅读上周购买的 Hashimi 书。如果有人能指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T18:57:55.583

`.csproj`文件是 MSBuild 文件。只要满足条件，您在 中自定义的任何内容都`.csproj`将被 MSBuild 拾取。

您可以增加[MSBuild 日志记录](http://msdn.microsoft.com/en-us/library/ms171470)的详细程度来分析构建内部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T19:22:59.833

web.config 的转换由 VS 的 web 发布任务完成，特别是 Package 目标。您的 .csproj 应该在其中导入 Microsoft.Web.Publishing.targets 来定义 TransformXml 任务和一些目标，例如 msbuild 会调用的 [Pre|Post]TransformWebConfig。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T14:59:14.993

AfterBuild 通常在项目打包完成后调用。web.config 转换将在打包阶段之前为您的项目进行。

# regex - 使用 Netbeans 的正则表达式：

> ID：10836739
> 
> 赞同：1
> 
> 时间：2012-05-31T15:35:23.693
> 
> 标签：regex, netbeans, replace

我想做以下查找和替换：

```
// input
'key1': 1 
'key2': 2 

// output
key1: 1 
key2: 2 
```

查找应该是这样`'\w{1,}':`
的模式替换为模式呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:47:14.060

这应该从键中删除引号：

寻找：`'(.+)':`

代替：`$1`

# ios - 如何将 Apple KMLViewer 示例迁移到我的项目中？

> ID：10836743
> 
> 赞同：1
> 
> 时间：2012-05-31T15:35:30.213
> 
> 标签：ios, mapkit

我的第一个项目涉及映射和 KML 文件。

我已成功将地图视图添加到视图控制器。当我运行这个项目时，我得到了美国的标准地图。

接下来，我下载并成功运行了 Apple KMLViewer 示例。

我将示例迁移到我的项目的第一次尝试是将 KMLParser {h/m}、KMLViewerViewController {h/m} 和 KML_Sample.kml 复制到我的项目并编辑我的 AppDelegate {h/m} 以便它包含 KMLViewerAppDelegate 中的项目{h/m}。

当我运行我的项目时，我仍然得到标准的启动图。

我错过了什么？

# jquery - jQuery ValidationEngine 函数验证问题

> ID：10836747
> 
> 赞同：0
> 
> 时间：2012-05-31T15:35:52.010
> 
> 标签：jquery, jquery-validation-engine

这是我的表格（它只包含本练习所需的字段，实际上有 20 个输入字段）：

```
<form id="reg_form" action="/register_submit" method="post">
  <fieldset>
      <ul class="form-list">
        <li>
          <div style="width:500">
            <label for="Username" class="required">Username (5 characters minimum,<br />Only Letters, Numbers, '~', '%', '.', ':', '-' and '_' allowed)<em>*</em></label><br />
            <div class="input-box">
              <input type="text" name="Username" id="Username" value="{embed:Username}" title="Username" class="validate[required,minSize[5],custom[onlyLetNumSpec]] register_input" />
            </div>
          </div>
        </li>
        <li id="register-customer-password">
          <div style="width:500">
            <label for="Password" class="required">Password (5 characters minimum,<br />Only Letters, Numbers, '~', '%', '.', ':', '-' and '_' allowed)<em>*</em></label><br />
            <div class="input-box">
              <input type="Password" name="Password" id="Password" title="Password" class="validate[required,minSize[5],custom[onlyLetNumSpec]] register_input" />
            </div>
          </div>
          <br />
          <div style="width:500">
            <label for="confirm_password" class="required">Confirm Password<em>*</em></label>
            <div class="input-box">
              <input type="password" name="confirm_password" title="Confirm Password" id="confirm_password" class="validate[required,custom[onlyLetNumSpec],equals[Password],funcCall[checkUserPass]] register_input" />
            </div>
          </div>
          <div class="clear"></div>
         </li>
      </ul>
      <div class="button-set">
        <button class="button button-login" title="Create Account" type="submit">
          <span>
            <span>Create Account</span>
          </span>
        </button>
      </div>
  </fieldset>
</form> 
```

现在，这是在 confirm_password 表单字段填写并退出后在验证中调用的函数 checkUserPass：

```
function checkUserPass(field, rules, i, options){
  $.ajax({type:'POST',
          url: '/json_api/ParticipantSelectByUser/', 
          data: {"Username":$("#Username").val(), "Password":$("#Password").val()},
          dataType: 'json', 
          success: checkUserPassResult,
          error:function (xhr, ajaxOptions, thrownError){
              alert(xhr.status);
              alert(thrownError);
          } // error
  });
}

function checkUserPassResult(data) {
  if(data.result.ParticipantID > 0) {
    /*--- There is already a user with this combination ---*/
    return options.allrules.checkUserPass.alertText;
  } // if(data.result)
} 
```

我*知道*返回了一个 data.result ，因此，已经有一个具有该用户/密码组合的用户。

但是，从未显示验证消息。我相信我已经按照正确的方法使用函数调用进行验证。我不能使用 ajax 验证规则，因为需要将用户名和密码都传递给 ajax 调用。这里似乎有什么问题？我在此表单上的所有其他验证都可以正常工作。

以下是上述验证所需的自定义规则：

```
"onlyLetNumSpec": {
    // Good for database fields
    "regex": /^[0-9a-zA-Z_-~%.:]+$/,
    "alertText": "* Only Letters, Numbers, tilde(~), pct(%), period(.), colon(:), hyphen(-) and underscore(_) allowed"
},
"checkUserPass": {
  "alertText": "* A User with the same Username and/or Password has been detected. Please change one of the entries."
} 
```

编辑注释；我已经更新了 checkUserPass 函数以成功调用另一个函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T19:15:41.763

行。我找到了解决方案！您所要做的就是从主函数返回而不是回调。

```
function checkUserPass(field, rules, i, options){
var ret = "";
$.ajax({type:'POST',
  url: '/json_api/ParticipantSelectByUser/', 
  data: {"Username":$("#Username").val(), "Password":$("#Password").val()},
  dataType: 'json',
  async: false, 
  success: function(response)
  {
     if(data.result.ParticipantID > 0) 
      {
          ret = "There is already a user with this combination";
      } 

  },
  error:function (xhr, ajaxOptions, thrownError){
      alert(xhr.status);
      alert(thrownError);
  } // error
});

 **return ret;**
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:41:27.550

您正在使用异步 ajax，因此您的返回值无处返回。您将不得不使用您的数据调用一个函数。而且您必须在 ajax 函数之外使用 e.preventDefault() (!!!) 阻止提交。

```
if(data.result) {
    function_to_validate_the_data(data.result);
} // if(data.result) 
```

# iphone - iphone 应用程序在哪里存储数据？

> ID：10836748
> 
> 赞同：1
> 
> 时间：2012-05-31T15:35:53.223
> 
> 标签：iphone, ios, ios5, ios4

我的意思是像 Draw Something 这样的游戏，它们是两个玩家游戏，需要来回传输数据。这些数据存储在哪里？它是在 iCloud、外部网络服务器还是其他地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:39:21.310

这取决于很多，不同的应用程序使用不同的解决方案。您可以使用 iCloud 在不同设备之间共享数据，但不能在不同用户之间共享。也就是说，如果我的 iPhone 和 iPad 上都安装了一个应用程序，那么应用程序开发人员可以使用 iCloud 在设备之间共享数据。但是 iCloud 不适合在你我之间共享数据。许多人会使用他们自己的服务，或者像 parse.com 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T13:24:29.217

您可以使用[Parse](https://parse.com/)。他们基本上为你做你的整个后端，你只需要使用他们的 API 与它交互。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:39:12.433

如果你想在手机本地存储一些数据，你可以将它们存储为 plist 或使用类似 sqlite 的东西

但通常这些游戏和其他网络服务将用户数据存储在他们的远程服务器中，无论是他们自己的机器，还是亚马逊，或者像 heroku 这样的其他后端服务提供商

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T15:38:20.447

您可以为此使用[游戏中心](https://developer.apple.com/devcenter/ios/gamecenter/)。

# wix - Wix - 在安装之前运行批处理脚本（用于删除以前的安装）？

> ID：10836750
> 
> 赞同：1
> 
> 时间：2012-05-31T15:35:55.397
> 
> 标签：wix, wix3.5

*我有的：*

1.  通过 msi-package 推出服务的目的（在 services.msc 中列出）
2.  该服务正在使用自定义 dll
3.  带有自定义操作的 InstallExecuteSequence
    *   `<... After="InstallFinalize">NOT Installed</Custom>`用于安装
    *   `<... Before="InstallInitialize">Installed</Custom>`用于卸载
4.  到目前为止，该服务是在工作站上手动安装的，没有 msi 包，也没有注册为应用程序（所以它没有显示在 appwiz.cpl 中）

*有什么问题：*

*   如果服务（来自以前的安装）正在运行，我不知道在复制文件之前如何停止它（当然，更新 dll 的基本要求是没有任务正在使用它们）
*   即使服务（来自以前的安装）没有运行，也没有文件被更新

*所以我想要什么：*

*   我只是想用我的全新 msi 包和更新的 dll 和所有这些东西覆盖 4) 中的现有安装

*有什么解决办法：*

是的，希望它尽快出现在我的文字下方：）也许标题不是很好，那是因为我不知道如何走得更远......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T17:42:04.117

让您摆脱困境的最简单方法是编写一个安装程序，该安装程序使用 ServiceInstall 和 ServiceControl 元素（使用 Both 值删除属性）来定义服务。将文件定位到以前未使用过的新目录，这样您的引用计数就不会全部混乱。使用 RemoveFile 元素删除旧安装的文件是一个很好的措施。目标是能够升级删除折叠文件并卸载所有内容。

如果旧文件没有一致地部署到同一目录，您要么必须提供已知目录列表并编写重复的 RemoveFile 语句，要么编写搜索文件并删除它们的自定义操作。（次优）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T13:34:28.113

ServiceControl 元素：很酷，但我遇到了类似的问题：如果在运行 msi-package 时之前（手动）安装的服务仍在运行，则会弹出一个窗口询问要做什么（停止服务、取消、..）。

我最终将卸载旧版本的担忧与新的安装例程分开。我简单地写了一个批处理脚本，它在 msi 包运行之前运行。

# excel - 一种将 Excel 程序集注册到 GAC 中的方法

> ID：10836753
> 
> 赞同：0
> 
> 时间：2012-05-31T15:36:15.867
> 
> 标签：excel, ms-office, gac

我使用 ASP .NET MVC 3 框架开发了一个 Web 应用程序。
我以编程方式使用 Excel 程序集来创建 Excel 工作簿。

我的 Web 应用程序在我的开发机器上运行良好，但在生产机器上却不行。
我的开发机器上安装了 Microsoft Office 2007，包括 MS Excel 2007。
因此，Excel 程序集在 GAC 中注册。
但是生产机器上没有安装任何版本的 MS Office。

我想知道除了安装 MS Excel 之外，是否有办法将 Excel 程序集注册到生产机器的 GAC 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T19:32:09.450

这里有2个问题-

1.  单独安装互操作程序集对您没有帮助。互操作只是一个优秀的中介。您必须安装 excel 才能使用 excel 功能。

2.  [Microsoft 不推荐也不支持在服务器上使用 excel。](http://support.microsoft.com/kb/257757)

所以 - 我建议您使用[Office Open XML SDK](http://www.microsoft.com/en-us/download/details.aspx?id=5124)来生成您需要的 excel 表格。

# c# - Unity，来自替代文件和 sectionExtension 的 LoadConfiguration

> ID：10836756
> 
> 赞同：0
> 
> 时间：2012-05-31T15:36:22.090
> 
> 标签：c#, unity-container

祝大家心情愉快！请帮助我使用 Unity。

我的 App.config 文件包含：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <section name="unity" type="Microsoft.Practices.Unity.Configuration.UnityConfigurationSection, Microsoft.Practices.Unity.Configuration"/>
  </configSections>
  <system.diagnostics>
    <sources>
      <source name="TraceTest" switchName="SourceSwitch"
        switchType="System.Diagnostics.SourceSwitch" >
        <listeners>
          <add name="console" />
          <remove name ="Default" />
        </listeners>
      </source>
    </sources>
    <switches>
      <add name="SourceSwitch" value="All" />
    </switches>
    <sharedListeners>
      <add name="console"
        type="System.Diagnostics.ConsoleTraceListener"
        initializeData="false"/>
    </sharedListeners>
    <trace autoflush="true" indentsize="4">
      <listeners>
        <add name="console" />
      </listeners>
    </trace>
  </system.diagnostics>
  <unity xmlns="http://schemas.microsoft.com/practices/2010/unity">
    <assembly name="ContextDownloader"/>
    <namespace name="ContextDownloader.Log"/>
    <namespace name="System.Diagnostics"/>
    <sectionExtension type="Microsoft.Practices.Unity.InterceptionExtension.Configuration.InterceptionConfigurationExtension, 
Microsoft.Practices.Unity.Interception.Configuration"/>
    <container>
      <extension type="Interception"/>
      <register type="ILogWorker" mapTo="FileLogWorker">
        <interceptor type="InterfaceInterceptor"/>
        <interceptionBehavior type="TraceBehavior"/>
      </register>
      <register type="TraceSource" name="interception">
        <constructor>
          <param name="name" type="System.String" value="TraceTest" />
        </constructor>
      </register>
      <register type="TraceBehavior">
        <constructor>
          <param name="source" dependencyName="interception" />
        </constructor>
      </register>
    </container>
  </unity>
</configuration> 
```

我在代码中从 App.config 加载配置：

```
var fileMap = new ExeConfigurationFileMap { ExeConfigFilename = "App.config" };
Configuration configuration = ConfigurationManager.OpenMappedExeConfiguration(fileMap, ConfigurationUserLevel.None);
var unitySection = (UnityConfigurationSection)configuration.GetSection("unity");
var container = new UnityContainer(); 
```

所以它抛出异常

> 未处理的异常：System.Configuration.ConfigurationErrorsException：为统一创建配置节处理程序时出错：类型名称或别名 Microsoft.Practices.Unity.InterceptionExtension.Configuration.InterceptionConfigurationExtension，Microsoft.Practices.Unity.Interception.Configuration 不能解决。请检查您的配置文件并验证此类型名称。

排队`var unitySection = (UnityConfigurationSection)configuration.GetSection("unity");`。如何加载 Microsoft.Practices.Unity.Interception.Configuration 程序集？

有关应用程序的更多详细信息。我有控制台应用程序和库。我刚刚在我的控制台应用程序中调用了一种方法，然后所有逻辑都在库中。

感谢您对此 Microsoft.Practices.Unity.InterceptionExtension.Configuration.dll 复制到输出库的回答。你能帮我加载 system.diagnostic 部分吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T07:43:04.023

您是否确认`Microsoft.Practices.Unity.Interception.dll`和`Microsoft.Practices.Unity.Interception.Configuration.dll`位于您的应用程序基础文件夹中，或者它们已在 GAC 中注册？

您是否检查过您的`App.config`文件仍然`App.config`在编译后命名，而不是重命名为类似的名称`MyApp.Foo.dll.config`？

能否请您发布完整的配置文件。上面的代码片段在我的机器上完美运行，所以我想还有一些东西丢失了。

顺便说一句：如果你想使用默认值`App.config`或者`Web.config`无论如何你可以放弃`ExeConfigurationFileMap`并直接调用`ConfigurationManager.GetSection("unity")`

* * *

**更新**

所以你有一个不是控制台应用程序的应用程序（例如 WinForms 或 WPF）并且想要将跟踪输出写入控制台？那么也许[这篇文章](http://www.codeproject.com/Articles/9197/Console-and-WinForm-together-for-easy-debugging)可以提供帮助。它展示了如何使用来自托管代码的本机 Win32 调用来分配控制台窗口。

如果您想使用与库捆绑在一起且独立于应用程序配置文件的配置文件，则可能会对 StackOverflow 上的[这篇文章感兴趣。](https://stackoverflow.com/questions/594298/c-sharp-dll-config-file)

# maven - 如何在获取最新的工件版本之前使版本-maven-plugin 更新 maven-metadata-*.xml 更新？

> ID：10836759
> 
> 赞同：1
> 
> 时间：2012-05-31T15:36:26.187
> 
> 标签：maven, nexus, maven-release-plugin, versions-maven-plugin

我正在使用**versions-maven-plugin**自动查找在许多不同的nexus 存储库中找到的最新发布/快照版本的maven 工件。

似乎该插件正在我的本地存储库中使用**maven-metadata-$REPO.xml**（其中 $REPO 是存储库的 id）文件来查找工件的最新版本。

我经常需要**mvn:release**一个工件，紧接着，我需要根据刚刚发布的工件更新另一个工件，但是**versions-maven-plugin**找不到它，因为它的最新版本列在那些 xml 文件中，甚至尽管它实际上存在于关系中。

我希望你们中的一些人能提出我如何解决问题的想法。谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:51:16.757

Maven 将工件的状态缓存一段时间（如果您曾经遇到工件下载失败并看到它说它不会再试一次，直到经过一定的时间，这是该功能的一部分） . 因此，如果它检查存储库中的工件，它不会在您每次尝试使用它时再次检查新版本，它会记住一段时间，然后在一段时间后再次检查。

但是，如果您重命名/删除（首先重命名以确保安全/因此您不会丢失它）元数据文件，它将别无选择，只能重新下载新的元数据文件（因为它需要它并且 repo 是唯一的地方让它找到它）然后当它查看新文件时，它会看到你的工件的新版本并下载它们。

# java - 强制 GWT 编译器停止修剪无效的 CompilationUnits

> ID：10836760
> 
> 赞同：3
> 
> 时间：2012-05-31T15:36:26.307
> 
> 标签：java, gwt, maven, code-generation, playn

我在 PlayN 中有一个项目，它允许我将单个 Java 代码库编译到阳光下的每个平台；我正在构建 gwt trunk，它目前允许在纯 java 实现中调用 GWT.create()。有一些需要跳过的环节，即调用 ServerGwtBridge.getInstance().register(String.class, new ClassInstantiator() {...}); GWT.create() 使用的每个类。

因此，我没有手动编写每个绑定的代码，而是在我的类上设置了一些注释，并制作了一个生成器，它可以输出注册 ClassInstatiators 所需的初始化代码。生成器在 gwt 模块上运行良好，我制作了一个 maven mojo 来在我的纯 java 类上运行生成器。所以，现在我所有的模块，gwt、java 和 android 都可以使用 GWT.create()，并且我可以支持来自 gwt.xml 模块文件的替换语法。

问题在于，任何引用任何 gwt 不支持的类或​​方法的类都会被 gwt 预编译器修剪掉。它们仍然存在于单元缓存中，但生成器的 TypeOracle 不再看到它们。我不想复制粘贴大量代码来阻止编译器删除无效单元；我看到一些代码参考 NameEnvironmentAnswer 似乎允许编译中的无效单元，但无法弄清楚如何使其工作。

我无意链接此代码，我只想要一个填充的 TypeOracle 让我的生成器运行，这意味着我需要编译器停止修剪无效单元。

# python - 从python中的字典列表中选择单个字段

> ID：10836763
> 
> 赞同：3
> 
> 时间：2012-05-31T15:36:31.507
> 
> 标签：python, list, dictionary, for-loop

可以说我有一个像这样的字典列表：

```
dictionList = {1: {'Type': 'Cat', 'Legs': 4},
               2: {'Type': 'Dog', 'Legs': 4},
               3: {'Type': 'Bird', 'Legs': 2}} 
```

使用 for 循环我想遍历列表，直到我捕获一个`Type`字段等于的字典`"Dog"`。我最好的尝试是：

```
 for i in dictionList:
     if dictionList(i['Type']) == "Dog":
         print "Found dog!" 
```

但这让我得到以下错误：

```
TypeError: 'int' object has no attribute '__getitem__' 
```

关于如何正确执行此操作的任何想法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-31T15:40:18.953

`values`对字典使用迭代器：

```
for v in dictionList.values():
    if v['Type']=='Dog':
         print "Found a dog!" 
```

编辑：尽管我会说，在您最初的问题中，您要求检查`Type`字典中的值，这有点误导。您要求的是一个名为“类型”的*值的内容。*这对于理解你想要什么可能是一个微妙的差异，但在编程方面却是一个相当大的差异。

在 Python 中，您应该很少需要对任何内容进行类型检查。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T15:41:35.597

使用[itervalues()](http://docs.python.org/library/stdtypes.html?highlight=itervalues#dict.itervalues)检查您的字典。

```
for val in dictionList.itervalues():
   if val['Type'] == 'Dog':
      print 'Dog Found'
      print val 
```

给出：

```
Dog Found
{'Legs': 4, 'Type': 'Dog'} 
```

无需使用`iter`/ `iteritems`，只需检查值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T15:39:54.580

```
>>> diction_list = {1: {'Type': 'Cat', 'Legs': 4},
            2: {'Type': 'Dog', 'Legs': 4},
            3: {'Type': 'Bird', 'Legs': 2}}
>>> any(d['Type'] == 'Dog' for d in diction_list.values())
True 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T15:41:34.220

尝试

```
for i in dictionList.itervalues():
    if i['Type'] == "Dog":
        print "Found dog!" 
```

问题在于，在您的示例中，`i`是整数键。使用 itervalues，您可以在键处获取值（也就是您要解析的字典）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-31T15:46:52.393

我认为您只是使用了错误的语法...试试这个：

```
>>> a = {1: {"Type": "Cat", "Legs": 4}, 2: {"Type": "Dog", "Legs": 4}, 3: {"Type": "Bird", "Legs": 2}}
>>> for item in a:
...     if a[item].get("Type") == "Dog":
...             print "Got it" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-31T15:42:07.780

尝试打印出`i`. 他们不是你认为的那样。这样做的方法是：

```
for key,  val in dictionList.items():
    #do stuff to val 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-31T16:22:49.083

在字典中通过键访问会更好。在您的情况下，这两个字典对象都是如此。

```
for i in dictionList.keys():
    if dictionList[i]['Type'] == 'Dog':
        print i 
```

# jquery - 使用 jquery 使文本更改颜色（不停闪烁）

> ID：10836766
> 
> 赞同：1
> 
> 时间：2012-05-31T15:36:40.393
> 
> 标签：jquery

使用 jquery在两种颜色/类之间**连续**切换文本的最简单方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-31T15:39:07.887

一个简单的例子：

CSS

```
div { color: red; }
div.blinking { color: blue; } 
```

jQuery（在`DOMready`事件中）

```
var el = $('div');
setInterval(function() {
   el.toggleClass('blinking');
}, 1000); 
```

小提琴示例：http: [//jsfiddle.net/gLEuP/](http://jsfiddle.net/gLEuP/)

* * *

否则，您可以在现代浏览器上完全避免使用 JS，而只使用 CSS3 动画，例如

```
@keyframes blink {
    0% { color  : red; }
    49% { color : red; }
    50% { color : blue }
    100% { color: blue; }
}

div {
    animation: blink 2s linear infinite;
} 
```

示例 codepen（带有供应商前缀）：[http ://codepen.io/anon/pen/NPJBbe](http://codepen.io/anon/pen/NPJBbe)

注意，避免设置太小的延迟，它可能会伤害受[光敏性癫痫](http://juicystudio.com/article/photosensitive-epilepsy.php)影响的人（并且让其他人烦恼）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:39:31.943

对 jquery 旋转颜色的简单谷歌搜索带来了这个

[http://buildinternet.com/2009/09/its-a-rainbow-color-changeing-text-and-backgrounds/](http://buildinternet.com/2009/09/its-a-rainbow-color-changing-text-and-backgrounds/)

对于闪烁效果，您始终可以使用 setInterval 每隔一秒或半秒运行一个函数，这将使用 jquery 切换一个类

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:40:09.703

尝试

```
function switch() {

   $("p").toggleClass("comic-sans");

}

setInterval("switch()", 1000); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T15:41:47.163

创建一个接受颜色作为变量的函数。在函数中，根据传递的颜色，确定接下来使用哪种颜色。更改文本颜色`element.style.color = '#FF0000';`。仍然在函数中，`setTimeout()`使用“新”颜色调用并传递函数。然后，`$(document).ready`调用变色功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-13T23:39:18.163

我想出了这个：

```
//Click the Fade out button
$("#fadeOut").click(function(){
    fadeItOut();
});

var fadeItOut = function() {
  $("p").fadeOut("slow", function(){
      fadeItIn();
  });
};

var fadeItIn = function() {
    $("p").fadeIn("fast", fadeItOut());
}; 
```

# ruby-on-rails - 跨模型使用 ActiveRecord::Relations

> ID：10836767
> 
> 赞同：1
> 
> 时间：2012-05-31T15:36:42.183
> 
> 标签：ruby-on-rails

我有一个具有三个模型的 Rails 应用程序：帐户、包裹和交付。我在 Delivery 上使用 AR::Relation 范围来查找最近的交付和退货。Account 模型还需要查找最近交付的帐户。 **我可以在 Account via 中使用相同的交付范围`joins`吗？** 现在我正在使用这样的代码（注意和中的重复`Account.with_recent_returns`）`Delivery.recent_returns`：

```
# Package(id: integer, ident: string)

class Package < ActiveRecord::Base
  has_many :deliveries, :dependent => :destroy
end

# Delivery(id: integer, account_id: integer, delivered_on: date, package_id: integer, returned_on: date)`

class Delivery < ActiveRecord::Base

  belongs_to :account
  belongs_to :package

  scope :current, where(:returned_on => nil)

  scope :recent_deliveries, where('delivered_on >= ?', 2.weeks.ago)

  scope :recent_returns, where('returned_on >= ?', 2.weeks.ago)

  scope :returns, where('returned_on IS NOT NULL')
end

#  => Account(id: integer, name: string)

class Account < ActiveRecord::Base

  has_many :deliveries, :dependent => :destroy

  def self.with_current_deliveries
    joins(:deliveries).where(:deliveries => { :returned_on => nil } ).includes(:deliveries)
  end

  def self.with_recent_returns
    joins(:deliveries).where('deliveries.returned_on >= ?', 2.weeks.ago).includes(:deliveries)
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:49:12.213

我相信这样的事情会奏效

`scope :recent_deliveries, joins(:deliveries).merge(Delivery.recent)`

或者你可能需要使用 scoped

`scope :recent_deliveries, scoped.joins(:deliveries).merge(Delivery.recent)`

应该让你开始。

# asp.net-mvc-4 - 从 MVC3 中的视图调用 Web api 控制器

> ID：10836772
> 
> 赞同：0
> 
> 时间：2012-05-31T15:37:06.723
> 
> 标签：asp.net-mvc-4, asp.net-web-api

我想通过传递不同的参数从视图中调用 web api 控制器。

这是控制器的代码。

```
public samplecontroller:webapicontroller

{

} 
```

如果我使用以下 URL 调用控制器`http://localhost/api/samplecontroller/1/2/3`

1,2,3是参数。我想知道如何在控制器内部编写一个方法来接受这些参数并进行进一步处理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T22:08:27.437

如果您想自动将 URL 路径段映射到您的操作中的参数，您可以使用路由来定义该映射是如何发生的。这里有一个教程：[http ://www.asp.net/web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api](http://www.asp.net/web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api)

在你的情况下，你可以有这样的路线：

```
routes.MapHttpRoute(
  name: "My custom route",
  routeTemplate: "api/sample/{part1}/{part2}/{part3}"
); 
```

然后你可以有这个动作方法：

```
public HttpResponseMessage Get(string part1, string part2, string part3) {
   ...
} 
```

# java - java.lang.VerifyError - 将开发移动到另一台机器后，android 应用程序未启动

> ID：10836778
> 
> 赞同：0
> 
> 时间：2012-05-31T15:37:29.297
> 
> 标签：java, android, adb, forceclose

我已经在台式计算机上开发了几周的应用程序。我已经开始在另一台机器上开发，所以，我检查了代码 = 构建它，一切都很好 - 通过在 eclipse 中按 play 安装它，它会因强制关闭而失败。

不是很好。

所以 - 这是堆栈跟踪： http: [//pastebin.com/tUBAK1Zq](http://pastebin.com/tUBAK1Zq)

我认为这可能与 android sdk 的版本有关——但我正在运行的版本与桌面上的版本相同。

应用程序最终抛出堆栈跟踪的行是：

```
// Initialize a TabSpec for each tab and add it to the TabHost
spec = tabHost.newTabSpec("replaylist").setIndicator("Replay List",
    res.getDrawable(R.drawable.tabview_changeicon))
    .setContent(intent);

tabHost.addTab(spec); 
```

有人可以帮我解决这个问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T16:00:45.773

我自己在 Android 中多次看到“验证”问题。通常，当您使用标准 Java 6 api 但 Android 中不存在该 API 时，就会发生这种情况。因为您的 Eclipse 正在“验证”基于您的 JRE 的代码，所以如果您使用原生 Android JRE (dalvik) 中不存在的 API，它不会抱怨。结果是强制关闭和神秘的验证消息。当您使用标准 java jdk 编译库然后在 Android 项目中使用该库时，您会看到很多。

您最好的办法是使用 Java 5 兼容性编译您的库项目，并查看 eclipse 抱怨哪些 API。通常你会发现你正在使用一个尚未在 Android 中实现的 String 或 StringBuffer（或其他一些核心类）中的方法。我也被使用未在 Android 中实现的构造函数所困扰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-17T23:29:43.460

最后的问题是由于我相信一个过时的android sdk管理器

# java - 大括号内的正则表达式值

> ID：10836781
> 
> 赞同：1
> 
> 时间：2012-05-31T15:37:37.343
> 
> 标签：java, regex

我有一个随机变量，让我们在大括号内将其称为 R，如下所示：

```
{R} 
```

我试图用这个正则表达式：

```
{(.*?)//} 
```

然后我有这个错误

```
"Caused by: java.util.regex.PatternSyntaxException: 
Syntax error U_REGEX_RULE_SYNTAX near index 1:" 
```

指标定位`{(.*?)} "("`

我尝试在没有括号相同的错误的情况下这样做。本次指标目标`"."`

有人可以帮我找到大括号内正则表达式项目的替代解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T15:41:12.210

尝试转义花括号：

```
String regex = "\\{(.*?)\\}"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T15:41:16.063

正则表达式中使用大括号来定义特定的序列重复。

你必须在正则表达式中转义它们。

```
\{(.*?)\} 
```

应该工作得更好

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T15:42:00.010

转义 {}：

```
String regStr = "\\{.\\}"; 
```

我发现[这个交互式正则表达式测试页面](http://www.regexplanet.com/advanced/java/index.html)对改进 Java 正则表达式很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T15:41:40.590

不完全清楚你想要做什么

```
\{.*\} 
```

应该管用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-31T15:42:25.907

您可以使用反斜杠转义特殊字符`\`。请参阅[在正则表达式中必须转义哪些特殊字符？](https://stackoverflow.com/questions/399078/what-special-characters-must-be-escaped-in-regular-expressions)了解更多信息（尽管没有一般规则）。尝试转义花括号`{}`和斜线`//`。

# c# - 如何在c#中将页面的特定部分放入窗口窗体中？

> ID：10836793
> 
> 赞同：1
> 
> 时间：2012-05-31T15:38:20.717
> 
> 标签：c#, css, winforms, webbrowser-control, edit

我正在尝试获取用 aspx 编写的 Web 应用程序的特定部分并将其放在我的 Windows 窗体程序中。特别是这里有一个应用程序[http://gis.ktimanet.gr/wms/ktbasemap/default.aspx](http://gis.ktimanet.gr/wms/ktbasemap/default.aspx)和我想创建一个可执行的 Windows 窗体应用程序，没有正确的框架和上面的图像...我无法下载 aspx 因为它不起作用，唯一的事情是通过编辑 css..但是我可以编辑网站的 css动态地通过 c# 代码？？制作该程序的任何想法？

# regex - 什么是 cppcheck 规则文件 句法？

> ID：10836794
> 
> 赞同：1
> 
> 时间：2012-05-31T15:38:21.117
> 
> 标签：regex, customization, pcre, cppcheck

我找了一段时间，到处都找不到这个。我找到了一个很好的 cppcheck 规则文件示例，它显示了一个简单的模式；

```
<?xml version="1.0"?>
<rule version="1">
  <pattern>if \( p \) { free \( p \) ; }</pattern>
  <message>
    <id>redundantCondition</id>
    <severity>style</severity>
    <summary>Redundant condition. It is valid to free a NULL pointer.</summary>
  </message>
</rule> 
```

只要所有指针都命名为“p”并且调用是“免费的”，它就可以很好地工作。如何更改“p”以匹配任何标识符？如何检查“'免费'或'删除'”？该模式是 grep/awk/sed 模式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T19:43:53.083

我是一名 Cppcheck 开发人员。

Cppcheck 使用[PCRE](http://www.pcre.org/)。因此，请使用遵循 Perl 规则的正则表达式。

我不太擅长 Perl 正则表达式，所以我无法回答如何/是否可以匹配任何标识符（因为它应该匹配两次）。

..希望至少有一点帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-05T11:35:30.133

根据我的正则表达式经验，我会试试这个

```
<?xml version="1.0"?>
<rule version="1">
  <pattern>if \( (\w+) \) { free \( \1 \) ; }</pattern>
  <message>
    <id>redundantCondition</id>
    <severity>style</severity>
    <summary>Redundant condition. It is valid to free a NULL pointer.</summary>
  </message>
</rule> 
```

这些 PCRE 功能取代了`p`您的原始示例：

*   `(\w)`是一个单词模式（由字母数字字符和`'_'`组成），在组 #1 中捕获
*   `\1`是对匹配模式的文本的反向引用

* * *

可以在 Martin Moene 的博客中找到详细描述：使用**CppCheck**[查找代码模式](http://martin-moene.blogspot.de/2014/04/search-with-cppcheck.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-20T02:32:44.190

将 p 更改为 dot(.) 使其表示任何字符

# c# - Jquery ajax Post + 跨域

> ID：10836796
> 
> 赞同：-3
> 
> 时间：2012-05-31T15:38:24.253
> 
> 标签：c#, javascript, jquery, post, cross-browser

> **可能重复：**
> [访问控制允许来源不允许](https://stackoverflow.com/questions/9327218/access-control-allow-origin-not-allowed-by)

当我尝试使用 jquery 发帖时遇到问题：

```
 function SetUserAnswer(reponse) {
    $.ajax({
        type: "POST",
        url: "@SettingManager.GetValue("WS_Sondage_Adress").Value" + "SetUserAnswer",
        data: JSON.stringify({ deviceId: $("#Guid").attr("value"),
            pollId:  $("#PollId").attr("value"),
            answerId: reponse,
            parameters: ""
        }),
       dataType: "json",
       crossDomain: true,
      contentType: "application/json; charset=utf-8"
    }).done(function () {
        alert("OK !");
    }).fail(function () {
        alert("KO :(");
    });

} 
```

但 Firefox 发送“选项”而不是“发布”

```
OPTIONS SetUserAnswer

405 Method Not Allowed

22.1.68.146:8080

1.7 KB

10.70.134.7:8080

80ms
En-têtesRéponseHTML
Réponsevoir le code source
Access-Control-Allow-Orig...    *
Age 0
Allow   POST
Cache-Control   private
Connection  Keep-Alive
Content-Length  1732
Content-Type    text/html; charset=UTF-8
Date    Thu, 31 May 2012 15:28:21 GMT
Proxy-Connection    Keep-Alive
Server  Microsoft-IIS/7.0
X-AspNet-Version    4.0.30319
X-Powered-By    ASP.NET
Requêtevoir le code source
Accept  text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding gzip, deflate
Accept-Language fr,en-us;q=0.8,fr-fr;q=0.5,en;q=0.3
Access-Control-Request-He...    content-type
Access-Control-Request-Me...    POST
Cache-Control   no-cache
Host    22.1.68.146:8080
Origin  nom_machine
Pragma  no-cache
Proxy-Connection    keep-alive
User-Agent  Mozilla/5.0 (Windows NT 6.0; WOW64; rv:12.0) Gecko/20100101 Firefox/12.0 
```

我在做跨域发帖时只有这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:50:16.900

将数据类型从更改`json`为`jsonp`也，我在您的回复中看不到后续标题

```
Access-Control-Allow-Origin * 
```

# regex - 如何使用带有 Awk 的正则表达式来提取括号之间的子字符串？

> ID：10836798
> 
> 赞同：5
> 
> 时间：2012-05-31T15:38:40.700
> 
> 标签：regex, indexing, awk, substring

在以下 Bash 命令行中，当子字符串在双引号之间时，我可以获得子字符串的索引。

```
text='123ABCabc((XYZabc((((((abc123(((123'

echo $text | awk '{ print index($0, "((((a" )}'  # 20 is the result. 
```

但是，在我的应用程序中，我不知道这个示例中“a”所在的位置是什么字符。因此，我认为我可以用接受除“（”之外的任何字符的正则表达式替换“a”。我认为 /[^(}/ 将是我需要的。但是，我无法获得 Awk 索引命令使用任何形式的正则表达式代替示例中的“（（（（a”）。

**更新：** William Pursell 指出索引操作不接受正则表达式作为第二个操作数。

最终，我试图完成的是提取位于四个或更多“（”之后的子字符串，然后是一个或多个“）”。Dennis Williamson 使用以下代码提供了解决方案：

```
echo 'dksjfkdj(((((((I-WANT-THIS-SUBSTRING)askdjflsdjf' | 
mawk '{match($0,/\(\(\(\([^()]*\)/); s = substr($0,RSTART, RLENGTH); gsub(/[()]/, "", s); print s}' 
```

感谢大家的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T16:14:56.343

要在它们的序列之后获得第一个非开括号的位置：

```
$ echo "$text" | awk '{ print match($0, /\(\(\(\(([^(])/, arr); print arr[1, "start"]}'
20
24 
```

这显示了子字符串“((([^(]”) (20) 的位置和括号后字符的位置 (24)。

执行此操作的能力`match()`是 GNU ( `gawk`) 扩展。

**编辑：**

```
echo 'dksjfkdj(((((((I-WANT-THIS-SUBSTRING)askdjflsdjf' | 
    mawk '{match($0,/\(\(\(\([^()]*\)/); s = substr($0,RSTART, RLENGTH); gsub(/[()]/, "", s); print s}' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T16:09:14.190

如果你想匹配四个或更多的左括号以在匹配中找到另一个子字符串的开始，你实际上必须计算该值。

```
# Use GNU AWK to index the character after the end of a substring.
echo "$text" |
awk --re-interval 'match( $0, /\({4,}/ ) { print RSTART + RLENGTH }' 
```

这应该为您提供括号序列后字符的正确起始索引，在本例中为 24。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T15:45:12.137

你想要`match`而不是索引。你需要逃避`(`s。例如：

```
echo $text | awk '{ print match($0, /\(\(\(\([^(]/) }' 
```

请注意，这不会给出字符串后面字符`((((`的索引，而是给出第一个字符的索引`(`。

# save - 为什么 CGlayerRef 或 CGcontextRef 不能保存在 NSdata 中？

> ID：10836801
> 
> 赞同：0
> 
> 时间：2012-05-31T15:38:44.407
> 
> 标签：save, nsdata, cgcontext, cglayer

我将 CGlayerRef 和 CGcontextRef 保存在 NSdata 中，当我让它们覆盖当前的时，我发现只有指针被保存，而数据没有被保存。出于这个原因，我不能将这些 CGlayerRef 或 CGcontextRef 作为副本。（我在 drawRect 中完成了这一切）

为什么？有人说 NSdata 可以存储这些东西，但是 NSvalue 不能，但是，它根本不起作用，即使我使用“复制”，我也没有得到这些数据的副本。

这是我的代码：

-(void)drawRect:(CGRect)rect{

如果（drawCount==3）{

```
 dataLayer1=[NSData dataWithBytes:& _layerView 
```

长度：sizeof（CGLayerRef）]；

```
 [dataLayer1 retain]; 

               } 

  if (undodo==YES) { 

        _layerView=*(CGLayerRef*)[dataLayer1 bytes]; 

  } 

   currentContext = UIGraphicsGetCurrentContext( .... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T17:06:02.410

从位图上下文创建 CGLayerRef 并确保为位图上下文提供缓冲区。然后，当您绘制到图层中时，您的位图上下文后备缓冲区应该包含新数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-18T07:52:55.973

CGLayer 可以保存为 NSValue。

如果你在 CGLayer 中有连续的绘图并且想要其中的一部分，你应该

1.复制CGLayer

```
- (CGLayerRef)copyLayer:(CGLayerRef)layer
{
    CGSize size = CGLayerGetSize(layer);
    UIGraphicsBeginImageContext(size);
    CGContextRef context = UIGraphicsGetCurrentContext();

    CGLayerRef copyLayer = CGLayerCreateWithContext(context, size, NULL);
    CGContextRef copyContext = CGLayerGetContext(copyLayer);
    CGContextDrawLayerInRect(copyContext, CGRectMake(0, 0, size.width, size.height), layer);
    UIGraphicsEndImageContext();

    return copyLayer;
} 
```

2.CGLayer 到 NSValue && NSValue 到 CGLayer

```
//CGLayer to NSValue
CGLayerRef copyLayer = [self copyLayer:theLayerYouWantToSave];
NSValue *layerValue = [NSValue valueWithLayer:copyLayer];

//NSValue to CGLayer
theLayerYouWantToRestore = [layerValue layerValue]; 
```

3.添加类别到NSValue

```
//NSValue category
+ (NSValue *)valueWithLayer:(CGLayerRef)layer
{
    NSValue *value = [NSValue value:&layer withObjCType:@encode(CGLayerRef)];
    return value;
}

- (CGLayerRef)layerValue
{
    CGLayerRef layer;
    [self getValue:&layer];
    return layer;
} 
```

# ruby-on-rails - 如何在 CanCan 中使用子域加载资源

> ID：10836802
> 
> 赞同：0
> 
> 时间：2012-05-31T15:38:48.767
> 
> 标签：ruby-on-rails, cancan

是否可以使用 CanCan 中的子域加载资源？

`load_resource`和`load_and_authorize_resource`方法是这个的别名：

```
def load
    @foo = Resource.find(params[:id])
end 
```

就我而言，我需要基于子域加载资源。知道如何实现这一目标吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T17:57:54.783

您可以覆盖 load_resource 以使用子域，而不仅仅是在其上调用 authorize_resource

不确定你的代码是如何结构的，但沿着这条线的东西应该可以工作

```
class YourController < ApplicationController
  before_filter :find_by_subdomain
  load_and_authorize_resource

  private

  def find_by_subdomain
    @book = Model.find_by_subdomain(request.subdomain)
  end
end 
```

# mysql - 如何遍历 MySQL 结果集？

> ID：10836805
> 
> 赞同：17
> 
> 时间：2012-05-31T15:39:01.937
> 
> 标签：mysql, ruby, activerecord, ruby-on-rails-3.2

这是我正在使用的代码：

```
# Run the query against the database defined in .yml file.
# This is a Mysql::result object - http://www.tmtm.org/en/mysql/ruby/
@results = ActiveRecord::Base.connection.execute(@sql_query) 
```

在我看来，这是我查看这些值的方法：

```
<pre><%= debug @results %></pre>
Outputs: #<Mysql2::Result:0x007f31849a1fc0>

<% @results.each do |val| %>
   <%= val %>
<% end %>
Outputs: ["asdfasdf", 23, "qwefqwef"] ["sdfgdsf", 23, "asdfasdfasdf"] 
```

所以想象我查询类似的东西`select * from Person`，并返回一个结果集，例如：

```
ID      Name      Age
1       Sergio    22
2       Lazlow    28
3       Zeus      47 
```

如何遍历每个值并输出它？

这里的文档没有用，因为我已经尝试过应该存在的方法，但是解释器给了我一个错误，说这些方法不存在。我是否使用了错误的文档？

[http://www.tmtm.org/en/mysql/ruby/](http://www.tmtm.org/en/mysql/ruby/)

谢谢！

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-05-31T15:47:56.447

如果您使用的是 mysql2 gem，那么您应该得到 mysql2 结果对象，根据文档，您应该能够执行以下操作

```
results.each do |row|
  # conveniently, row is a hash
  # the keys are the fields, as you'd expect
  # the values are pre-built ruby primitives mapped from their corresponding field types in MySQL
  # Here's an otter: http://farm1.static.flickr.com/130/398077070_b8795d0ef3_b.jpg
end 
```

[在此处](http://rubydoc.info/gems/mysql2/0.3.11/frames)查看文档

因此，在您的情况下，您可以执行以下操作

```
<% @results.each do |val| %>
   <%= "#{val['id']}, #{val['name']}, #{val['age']}" %>
<% end %> 
```

**编辑**：您似乎指的是错误的文档检查 Mysql2 gems 文档。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2016-05-24T02:06:44.520

您可以尝试使用`ActiveRecord::Base.connection.exec_query`而不是`ActiveRecord::Base.connection.execute`返回 a [`ActiveRecord::Result`](http://api.rubyonrails.org/classes/ActiveRecord/Result.html)（在 rails 3.1+ 中可用）

然后您可以通过各种方式访问​​它，例如`.rows`, `.each`, 或`.to_hash`

从[文档](http://api.rubyonrails.org/classes/ActiveRecord/Result.html)：

```
result = ActiveRecord::Base.connection.exec_query('SELECT id, title, body FROM posts')
result # => #<ActiveRecord::Result:0xdeadbeef>

# Get the column names of the result:
result.columns
# => ["id", "title", "body"]

# Get the record values of the result:
result.rows
# => [[1, "title_1", "body_1"],
      [2, "title_2", "body_2"],
      ...
     ]

# Get an array of hashes representing the result (column => value):
result.to_hash
# => [{"id" => 1, "title" => "title_1", "body" => "body_1"},
      {"id" => 2, "title" => "title_2", "body" => "body_2"},
      ...
     ]

# ActiveRecord::Result also includes Enumerable.
result.each do |row|
  puts row['title'] + " " + row['body']
end 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-01-07T08:32:31.337

使用`:as => :hash`：

```
raw = ActiveRecord::Base.connection.execute(sql)
raw.each(:as => :hash) do |row|
  puts row.inspect # row is hash
end 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-08-30T12:04:12.427

查找列标题的@results.fields。

示例：@results = [[1, "Sergio", 22],[2, "Lazlow", 28],[3, "Zeus", 47]]

```
@results.fields do |f|
  puts "#{f}\t"  # Column names
end

puts "\n"

@results.each do |rows| # Iterate through each row
  rows.each do |col| # Iterate through each column of the row
    puts "#{col}\t"
  end
  puts "\n"
end 
```

希望它是有帮助的。

# html - 表格单元格上的虚线边框变为实线

> ID：10836826
> 
> 赞同：4
> 
> 时间：2012-05-31T15:40:07.287
> 
> 标签：html, css, border, css-tables

我用我的测试用例设置了一个 [jsfiddle][1]。

基本上，我有一个表格，在某些单元格的底部有一个虚线边框，而在其他单元格的底部有一个实线边框。出于某种原因，某些单元格上的虚线边框变成了实线，我不知道为什么。任何人都可以解释这种行为和/或提供修复吗？

我正在使用 Chrome。

[1]：http: [//jsfiddle.net/eZcSR/1/](http://jsfiddle.net/eZcSR/1/)

 `* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-31T16:40:59.067

添加

`border-collapse: separate;`

或添加`border-spacing: 0`

`<tr></tr>`或者在上面的行中添加一个空（？？！）

修复了这个问题中的问题：[Double dotted border while using colspan](https://stackoverflow.com/questions/7725110/double-dotted-border-while-using-colspan)`

# hibernate - 如何根据休眠中的属性比较关联两个实体？

> ID：10836828
> 
> 赞同：0
> 
> 时间：2012-05-31T15:40:09.483
> 
> 标签：hibernate, hibernate-mapping

我想根据是否在两个实体之间创建一个可选的 ManyToOne 关联`entity1.name equals entity2.nameOf1`，但我不想通过添加、删除、获取对象来维护我的服务层中的这种关系，我只希望当我得到一个 entity2 时， hibernate 将 a 添加`left join entity1 e1 on e1.name = e2.nameOf1`到选择查询中，或者等待调用 entity2.getEntity1() 以`where e1.name == ?`使用 nameOf1 作为参数来查询 entity1。到目前为止，我已经尝试过使用 @JoinFormula 注释，但关于它的文档很少。我正在使用带有注释的休眠版本 3.5.6。

```
@Entity
public class Entity1 {
   @Id
   @GeneratedValue
   private Long id;
   @Column(unique = true)
   private String name;

   ...getter&setters...
}
@Entity
public class Entity2 {
   @Id
   @GeneratedValue
   private Long id;

   private String someProp;
   private String nameOf1;

   @ManyToOne(optional = true)
   // How to join them? this doesn't work
   // @JoinColumnsOrFormulas({ @JoinColumnOrFormula(formula = 
   //      @JoinFormula(value = "nameOf1", referencedColumnName = "name")) })
   // neither does
   // @JoinColumnsOrFormulas({ @JoinColumnOrFormula(column =
   //      @JoinColumn(name = "nameOf1", referencedColumnName = "name", 
   //          insertable = false, updatable = false, nullable = true)) })
   //@Fetch(FetchMode.JOIN)
   private Entity1 entity1;

   ...getter and setters...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T17:02:31.733

我认为您应该只使用查询来做到这一点：

```
select e1 from Entity1 e1 where e1.name = :name 
```

如果你真的想走这条路，一个带有 JoinColumn 的简单 ManyToOne 就足够了。但是，您需要使其不可插入和不可更新：

```
@ManyToOne(optional = true)
@JoinColumn(name = "nameOf1", referencedColumnName = "name", 
            insertable = false, updatable = false)
private Entity1 entity1; 
```

# javascript - iOS Web-App：页面转换之间的闪烁

> ID：10836831
> 
> 赞同：4
> 
> 时间：2012-05-31T15:40:14.697
> 
> 标签：javascript, css, ios, twitter-bootstrap, flicker

我为 iOS 设备制作了一个 Web 应用程序，并使用了 Twitter 的 Bootstrap，因为它支持响应式设计。页眉和页脚的行为类似于原生应用程序：固定在顶部或底部。我使用 CSS 类`.navbar-fixed-top`和`.navbar-fixed-bottom`.

不幸的是，在两页之间的过渡期间，页眉和页脚闪烁，看起来并不“自然”。酒吧应该是静态的。

我准备了一个示例网站。我正是使用这种结构。 [http://goo.gl/lmvzJ](http://goo.gl/lmvzJ)

你知道一个技巧或更好的解决方案吗？谢谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-04T01:37:49.683

如果您正在尝试做类似的事情，我会继续使用 Sencha touch 来构建应用程序。它要花钱，但对于构​​建 Web UI 来说非常棒。你也可以试试jquery mobile。

# java - 在 Swing 中显示动画 BG

> ID：10836832
> 
> 赞同：10
> 
> 时间：2012-05-31T15:40:15.380
> 
> 标签：java, image, swing, background, animated-gif

动画（循环）GIF 可以以`JLabel`HTML 格式或 HTML 格式显示（在格式文本组件中，如`JEditorPane`），并且可以看到循环。

但是要加载图像以绘制为容器的背景，我通常会使用`ImageIO.read()`或`Toolkit.getImage()`（当我怀念上个千年时，后者）。这两种加载图像的方法都不会导致循环图像，它通常只是第一帧。

如何为背景加载*动画*图像？

例如

![](../Images/56124fc70dd7c653d290b4366cf27d30.png)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-31T15:40:15.553

要获得用于自定义绘画的循环（动画）GIF，一个技巧是使用**`ImageIcon`**. 虽然从问题中列出的两种方法中的任何一种返回的图像都是静态的，但从 an 获得的图像`ImageIcon`是动画的。

下面的代码将添加 50 个按钮，然后在“缩放星星”动画 GIF ¹的帧之后作为背景添加到它们。`ImagePanel`会将图像拉伸到面板的大小。

1.  它基于此图像。

![缩放星星 GIF](../Images/56124fc70dd7c653d290b4366cf27d30.png)

```
import java.awt.*;
import javax.swing.*;
import javax.swing.border.EmptyBorder;
import java.net.URL;

class ImagePanel extends JPanel {

    private Image image;

    ImagePanel(Image image) {
        this.image = image;
    }

    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.drawImage(image,0,0,getWidth(),getHeight(),this);
    }

    public static void main(String[] args) throws Exception {
        URL url = new URL("http://i.stack.imgur.com/iQFxo.gif");
        final Image image = new ImageIcon(url).getImage();
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                JFrame f = new JFrame("Image");
                f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                f.setLocationByPlatform(true);

                ImagePanel imagePanel = new ImagePanel(image);
                imagePanel.setLayout(new GridLayout(5,10,10,10));
                imagePanel.setBorder(new EmptyBorder(20,20,20,20));
                for (int ii=1; ii<51; ii++) {
                    imagePanel.add(new JButton("" + ii));
                }

                f.setContentPane(imagePanel);
                f.pack();
                f.setVisible(true);
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-05-31T18:57:08.667

使用`ImageIcon`可能是最直接的事情。要记住几件事：

*   `ImageIcon(URL)`本身利用`Toolkit.getImage(URL)`. 您可能更喜欢使用`Toolkit.createImage(URL)`-`getImage()`可以使用缓存或共享的图像数据。

*   `ImageIcon`使用 a`MediaTracker`有效地等待图像完全加载。

因此，您的问题可能不是使用`Toolkit`( `ImageIO`is a different beast)，而是您没有渲染完全加载的图像这一事实。一件有趣的事情是：

```
Image image = f.getToolkit().createImage(url);
//...
ImagePanel imagePanel = new ImagePanel(image);
imagePanel.prepareImage(image, imagePanel);
//... 
```

我的 Swing/AWT/J2D 可能有点模糊，但想法是，既然你`ImagePanel`是一个`ImageObserver`，它可以异步通知图像信息。该方法应根据需要`Component.imageUpdate()`调用。`repaint`

编辑：

如评论中所述，`prepareImage`不需要调用 - 下面包含一个工作示例。关键是被覆盖的`paintComponent`方法调用`Graphics.drawImage`，它提供了`ImageObserver`钩子。该`imageUpdate`方法（在 中实现）将在设置标志`java.awt.Component`的情况下不断被调用。`ImageObserver.FRAMEBITS`

```
import java.awt.EventQueue;
import java.awt.Graphics;
import java.awt.GridLayout;
import java.awt.Image;
import java.awt.image.ImageObserver;
import java.net.MalformedURLException;
import java.net.URL;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.border.EmptyBorder;

public class ImagePanel extends JPanel {

    private final Image image;

    public ImagePanel(Image image) {
        super();
        this.image = image;
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.drawImage(this.image, 0, 0, getWidth(), getHeight(), this);
    }

    public static void main(String[] args) throws MalformedURLException {
        final URL url = new URL("http://i.stack.imgur.com/iQFxo.gif");
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                JFrame f = new JFrame("Image");
                f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                f.setLocationByPlatform(true);

                Image image = f.getToolkit().createImage(url);
                ImagePanel imagePanel = new ImagePanel(image);
                imagePanel.setLayout(new GridLayout(5, 10, 10, 10));
                imagePanel.setBorder(new EmptyBorder(20, 20, 20, 20));
                for (int ii = 1; ii < 51; ii++) {
                    imagePanel.add(new JButton("" + ii));
                }

                f.setContentPane(imagePanel);
                f.pack();
                f.setVisible(true);
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T20:38:37.223

我设法通过这种方式在我的 JPanel 中获取了动画 gif：

```
private JPanel loadingPanel() {
    JPanel panel = new JPanel();
    BoxLayout layoutMgr = new BoxLayout(panel, BoxLayout.PAGE_AXIS);
    panel.setLayout(layoutMgr);

    ClassLoader cldr = this.getClass().getClassLoader();
    java.net.URL imageURL   = cldr.getResource("img/spinner.gif");
    ImageIcon imageIcon = new ImageIcon(imageURL);
    JLabel iconLabel = new JLabel();
    iconLabel.setIcon(imageIcon);
    imageIcon.setImageObserver(iconLabel);

    JLabel label = new JLabel("Loading...");
    panel.add(iconLabel);
    panel.add(label);
    return panel;
} 
```

这种方法的一些要点：
1\. 图像文件在 jar 内；
2、ImageIO.read()返回一个BufferedImage，不更新ImageObserver；
3\. 另一种查找捆绑在 jar 文件中的图像的方法是询问 Java 类加载器（加载程序的代码）来获取文件。它知道东西在哪里。

所以通过这样做，我能够在我的 JPanel 中获得我的动画 gif，它就像一个魅力。

# exception - WatiN - 无法将 ReturnDialogHandler 添加到现有的 WebBrowser

> ID：10836835
> 
> 赞同：2
> 
> 时间：2012-05-31T15:40:21.863
> 
> 标签：exception, dialog, handler, watin

我正在尝试单击 javascript 警报窗口的“确定”按钮。但是，该方法`AddDialogHandler`会抛出***未设置为对象实例的对象引用。***我究竟做错了什么？

```
// Class
IE browser;

button_click()
{
     var thread = new Thread(() =>
     {
        WatiN.Core.Settings.AutoStartDialogWatcher = false;
        browser = new IE(webBrowser1.ActiveXInstance);

        ReturnDialogHandler myHandler = new ReturnDialogHandler();

        browser.AddDialogHandler(myHandler); // This line throws exception

        browser.Button(Find.ById("alertButton")).ClickNoWait();
        myHandler.WaitUntilExists();

        myHandler.OKButton.Click();

        browser.WaitForComplete();

     });
     thread.Name = "KillAlertWindowAsync";
     thread.IsBackground = true;
     thread.SetApartmentState(ApartmentState.STA);
     thread.Start();
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T18:05:58.157

使用 Emerica 的代码，他使用的是一个新实例“Browser.DialogWatcher”。只有当您的浏览器是静态的时，这才应该有效。由于您已将浏览器对象定义为

```
browser = new IE(webBrowser1.ActiveXInstance); 
```

您可以改为使用“browser.DialogWatcher”来调用该特定实例。但是要注意的一件事是 IE9 和对话框存在一个已知问题。我建议确保您拥有最新的 2.1 WatiN 版本。假设您已经拥有该版本，请尝试将 IE 设置为使用 IE 8 以确认它不是 IE 9 - WatiN 兼容性问题。为此，只需在浏览器中按 F12 并将浏览器和文档模式切换到 IE8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T15:47:56.100

你可以试试这个：

```
var approveConfirmDialog = new ConfirmDialogHandler();

using (new UseDialogOnce(Browser.DialogWatcher, approveConfirmDialog))
{
       //Your code to invoke popup.

       approveConfirmDialog.WaitUntilExists(); 
       approveConfirmDialog.OKButton.Click();
} 
```

这是假设它是一个通用的 ok 弹出窗口。

# php - Zeus 服务器 URL 重写

> ID：10836836
> 
> 赞同：0
> 
> 时间：2012-05-31T15:40:27.003
> 
> 标签：php, zeus

我是第一次使用 zeus 服务器，我不知道如何重写 url

1.  我应该在 zeus 的根文件夹中上传哪个文件（带有扩展名）
2.  现在我正在使用 Apache，然后 .htaccess 文件正在工作，但我必须将我的站点转移到 zeus 服务器上，然后它现在不工作我在 htaccess 文件中的代码是

    ```
    <IfModule mod_rewrite.c>
    RewriteEngine on
    RewriteCond $1 !^(index\.php|js|robots\.txt)
    RewriteCond %{REQUEST_FILENAME} !\.(js|css|gif|jpg|jpeg|png|ico|swf|pdf)$
    RewriteRule ^(.*)$ /$1 [L] 
    ```

我想在 zeus 服务器上使用相同的重定向，任何人都可以请知道我应该使用哪个文件扩展名以及我应该将文件放在哪个位置（目录），还请为我提供与 zeus 服务器相同的重写代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T16:04:37.073

自然，如评论中所述，`.htaccess`带有特定于 apache 的指令的 -file 在 zeus 上不起作用，因此您必须做一些不同的事情。

很容易找到一些教程，这些教程展示了 apache 的特定命令如何转换为 zeus-commands。我想在这里强调的是[names.co.uk 上的这篇文章](http://www.names.co.uk/support/support_centre_home/528-zeus_rewrite_rules_user_guide.html)和[drupal.org](http://drupal.org/node/46508)上的这篇文章，其中第二个显示了您的问题的一个重要问题：

> 有几点需要注意。**Zeus 不支持**[QSA] 或**REQUEST_FILENAME**或允许读取服务器环境变量（尽管您可以写入它们..）。

您必须自己[分解 url](http://www.codem.com.au/streams/2010/web-development/zeus-and-crazy-url-rewriting.html)以获取不同的部分，因此重写脚本将比 apache 的脚本大得多。

# java - 您如何配置 Spring Security 以使用基本身份验证对数据库进行身份验证？

> ID：10836839
> 
> 赞同：9
> 
> 时间：2012-05-31T15:40:30.993
> 
> 标签：java, spring-security, basic-authentication

我已经 13 周开始使用 Java 进行编码，并且正在开发一个 RESTful Web 服务。后端已经完成，现在我正在创建一个 UI。其中一项要求是用户使用 http basic 登录。我已将其配置为当用户导航到页面时弹出对话框出现并且您可以输入我拥有的一个硬编码用户并登录。但我真正需要它做的是验证用户一个数据库。我进行了广泛的搜索以尝试找到一种方法来配置它以针对数据库进行验证，但无济于事。这是我的虚拟用户的 spring-security.xml 文件。

```
<beans:beans xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/security
    http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    <!-- <http auto-config="true"> <intercept-url pattern="/welcome*" access="ROLE_USER" 
        /> <form-login login-page="/login" default-target-url="/welcome" authentication-failure-url="/loginfailed" 
        /> <logout logout-success-url="/logout" /> </http> -->

    <http>
        <intercept-url pattern="/*" access="ROLE_USER" />
        <http-basic />
    </http>

    <authentication-manager>
        <authentication-provider>
            <user-service>
                <user name="tmain" password="123456" authorities="ROLE_USER" />
            </user-service>
        </authentication-provider>
    </authentication-manager>

</beans:beans> 
```

这是（我相信）我的 web.xml 文件中设置的唯一相关信息。

```
<filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping> 
```

谁能给我一些关于配置弹簧安全性以针对数据库而不是我拥有的虚拟用户进行身份验证的指导？我在数据库中有一个用户实体，其中包含名字、姓氏、电子邮件、密码、activeStatus 和时区。电子邮件是用户的用户名。任何和所有的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T16:11:04.847

您的身份验证提供程序应如下所示：

```
<authentication-manager>
    <authentication-provider>
        <jdbc-user-service data-source-ref="dataSource" />
    </authentication-provider>
</authentication-manager> 
```

默认实现需要这些表：

```
create table users(
    username varchar_ignorecase(50) not null primary key,
    password varchar_ignorecase(50) not null,
    enabled boolean not null);

create table authorities (
    username varchar_ignorecase(50) not null,
    authority varchar_ignorecase(50) not null,
    constraint fk_authorities_users foreign key(username) references users(username));
    create unique index ix_auth_username on authorities (username,authority); 
```

您可以拥有不同的数据库结构并使用如下内容：

```
<jdbc-user-service data-source-ref="dataSource" authorities-by-username-query="select username,authority from users where username=?"/> 
```

不要忘记创建`dataSource`bean...

是的..所有这些都可以在[文档](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity.html)中找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:56:32.420

您需要使用 a`jdbc-user-service`代替`user-service`。您可以从阅读[文档](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/ns-config.html#ns-auth-providers)开始。

# .net - Windows启动时.net服务启动超时

> ID：10836842
> 
> 赞同：2
> 
> 时间：2012-05-31T15:41:01.373
> 
> 标签：.net, windows-services, windows-7-x64

我有一个在 Windows 启动时启动的 .net 服务，有时（完全随机）该服务无法启动。

事件查看器显示：**`A timeout was reached (30000 milliseconds) while waiting for the MYSERVICE service to connect.`**

即使在服务无法启动的机器上，如果我手动启动它（在 Windows 登录后）它也能正常启动。

我的启动方法非常基本，它只是用实际的启动逻辑启动一个新线程（通常非常快）。

我的服务需要 .net 3.5 sp1 并且有这些问题的机器是 win7 x64。我怀疑它与.net 框架有关，但我不知道如何。这发生在客户端机器上，他安装了 .net 4 客户端配置文件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:45:23.933

我遇到过这样的问题。通常是由于启动时的机器负载。例如，由于许多其他服务也启动了，我在 SQL Server 上遇到了这个错误。

解决此问题的一种简单方法是将服务设置为以延迟模式启动，因为这样您的服务将在较少的 CPU 和 HD 负载下启动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T16:30:48.457

如果它依赖于另一个服务，则 make 设置依赖关系。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-04T19:05:45.980

我们在 Windows 10 上遇到了类似的问题，大多数基于 .Net 的服务在启动时会失败，但以后可以手动启动就好了。出于某种原因，使用 .NET 编写的服务在 Windows 10 中启动需要更长的时间，但此修复适用于任何版本的 Windows，包括 Windows 7。默认情况下，如果服务启动时间超过 30 秒而没有响应，则服务被 Windows 终止。

我能够在注册表中将该行为更改为 60 秒。去：

HKLM\SYSTEM\CurrentControlSet\Control\

如果它不存在，请创建一个名为“ServicesPipeTimeout”（减去引号）的 DWORD（32 位）键。将其值设置为 60000（十进制）。这与以毫秒为单位的 60 秒相关。

我什至创建了一个 regfile 来自动执行此操作：

> Windows 注册表编辑器版本 5.00
> 
> [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control] "ServicesPipeTimeout"=dword:0000ea60

只需粘贴到记事本中并保存为 .reg 文件。

这**不是**延迟启动，而是增加了启动后服务响应的时间。这解决了我们在多台机器上的问题。不幸的是，我仍然不知道为什么 .NET 服务需要这么长时间才能启动，以至于它们会被终止。但是，我觉得这是微软的错误，不一定是我们用户做错了什么......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-02T18:06:15.483

对于任何在这个问题上苦苦挣扎的人，我们在一些较慢的 Windows 10 机器上遇到了同样的问题。我们可以通过在配置文件中将 generatePublisherEvidence 设置为 false 来解决这个问题。

您可以在此处阅读更多相关信息-> [https://blogs.msdn.microsoft.com/winsdk/2010/01/29/you-may-get-a-service-timeout-from-a-signed-net-managed -service-application-while-the-system-is-doing-a-revocation-check-of-the-certificate-over-the-internet/](https://blogs.msdn.microsoft.com/winsdk/2010/01/29/you-may-get-a-service-timeout-from-a-signed-net-managed-service-application-while-the-system-is-doing-a-revocation-check-of-the-certificate-over-the-internet/)

# r - ggplot2绘图区域边距？

> ID：10836843
> 
> 赞同：103
> 
> 时间：2012-05-31T15:35:38.740
> 
> 标签：r, ggplot2, data-visualization

有没有一种简单的方法可以增加绘图标题与其下方绘图区域之间的空间（即带有数据的框）。同样，我希望在轴标题和轴标签之间留一些空间。

换句话说，有没有办法“将标题向上移动一点，y 轴标题向左一点，x 轴标题向下一点”？

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2012-05-31T19:57:03.723

`plot.margin`您可以使用in调整绘图边距，`theme()`然后使用`vjust`参数移动轴标签和标题`element_text()`。例如 ：

```
library(ggplot2)
library(grid)
qplot(rnorm(100)) +
    ggtitle("Title") +
    theme(axis.title.x=element_text(vjust=-2)) +
    theme(axis.title.y=element_text(angle=90, vjust=-0.5)) +
    theme(plot.title=element_text(size=15, vjust=3)) +
    theme(plot.margin = unit(c(1,1,1,1), "cm")) 
```

会给你这样的东西：

![在此处输入图像描述](../Images/e6d3e6b65eee170903210e12423b56b1.png)

如果您想了解有关不同`theme()`参数及其参数的更多信息，您可以`?theme`在 R 提示符下输入。

# uiview - 获取没有标签栏的 UIView 高度

> ID：10836844
> 
> 赞同：0
> 
> 时间：2012-05-31T15:41:04.683
> 
> 标签：uiview, height, frame, uitabbar

嗨，如果我打印以下内容，我在标签栏中嵌入了一个简单的 uiview：

```
NSLog(@"%f",self.view.frame.size.height); 
```

我得到“460.0”，看起来像没有状态栏的视图的高度。

如果我想在没有标签栏的情况下获得视图的高度怎么办？有什么比减法更干净的吗？

谢谢卢卡

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:46:23.203

我遇到了同样的问题。我的解决方案是子视图 UIView 其大小恰好不包括标签栏。不是那么优雅，但我不必处理减法等等。

# java - 使用 Spring 3.1 的 JSP 页面中不显示表单验证错误

> ID：10836848
> 
> 赞同：1
> 
> 时间：2012-05-31T15:41:23.107
> 
> 标签：java, spring-mvc, validation

我无法在 JSP 页面中显示验证错误消息。这是我的控制器：

```
@Controller
@RequestMapping("/secure")
@SuppressWarnings({"All"})
public class OperationController {

    @ModelAttribute("crawler/operation")
    public OperationForm operationForm() {
        return new OperationForm();
    }

    @RequestMapping(value = "crawler/operation/create", method = RequestMethod.POST)
    public String processCrawlerOperationForm(@Valid OperationForm operationForm, BindingResult result, Map model) {
        if (result.hasErrors()) {
            HashMap<String, String> errors = new HashMap<String, String>();
            for (FieldError error : result.getFieldErrors()) {
                errors.put(error.getField(), error.getDefaultMessage());
            }
            model.put("errors", errors);
            return "crawler/operation";
        }
        //Some logic
        return "crawler/operation";
    }

} 
```

我 100% 确定错误存在。我一直在调试这段代码以确保有错误。

我的表单类：

```
public class OperationForm {

    @NotEmpty
    private String operationName;

    @NotEmpty
    private String author;

    @NotEmpty
    private String configurationId;

    public String getOperationName() {
        return operationName;
    }
    //Getters and setters
} 
```

我的 JSP 弹簧形式：

```
<form:form action="${pageContext.servletContext.contextPath}/secure/crawler/operation/create.htm" commandName="crawler/operation">
    <table border="0" cellspacing="12">
        <tr>
             <td>
                 <spring:message code="application.operationForm.operationName"/>
             </td>
             <td>
                <form:input path="operationName"/>
             </td>
             <td class="error">
                <form:errors path="operationName"/>
             </td>
        </tr>
        <tr>
             <td>
                 <spring:message code="application.operationForm.author"/>
             </td>
             <td>
                <form:input path="author"/>
             </td>
             <td class="error">
                <form:errors path="author"/>
             </td>
        </tr>
        <tr>
             <td>
                 <spring:message code="application.operationForm.configuration"/>
             </td>
             <td>
                <form:input path="configurationId"/>
             </td>
             <td class="error">
                <form:errors path="configurationId"/>
             </td>
        </tr>
        <tr>
             <td>
                 <input class="button" type="submit" value="Vykdyti"/>
             </td>
        </tr>
    </table>
</form:form> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T17:31:11.933

而不是遍历错误列表并将它们插入模型对象，只需检查验证并返回视图，即

```
if(result.hasErrors())
  return "crawler/operation";
... 
```

此外，在您的控制器方法中，添加 @ModelAttribute 注释，即

```
public String processCrawlerOperationForm(@ModelAttribute("form") @Valid OperationForm operationForm, BindingResult result, Map model) 
```

确保 ModelAttribute 注释的值与您在最初显示表单时放入模型对象的值相匹配。如果您使用上面的方法 operationForm 生成模型，请将其设置为该值。我会将其更改为更有用的值，Spring 可能会被 / 弄糊涂，将其更改为像“form”这样简单的东西。

# java - 如何从 Windows 小工具进行 GWT RPC 调用？

> ID：10836855
> 
> 赞同：0
> 
> 时间：2012-05-31T15:41:35.533
> 
> 标签：java, gwt, windows-desktop-gadgets

我使用 GWT RPC 创建了一个 Windows 桌面小工具，但如何进行远程调用？小工具只能运行客户端部分代码 (javascript)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:41:36.220

首先，您应该将应用程序部署到某个服务器。

考虑您的远程服务 url 是：[http](http://server.com/myapp/myrpcservice) ://server.com/myapp/myrpcservice 您应该将您的服务定位到该 URL，而不是使用 @RemoteServiceRelativePath：

```
ServiceDefTarget target = (ServiceDefTarget) myRPCService;
target.setServiceEntryPoint("http://server.com/myapp/myrpcservice");
myRPCService.call(...); 
```

现在您可以将此客户端用作 Windows 小工具。

请注意，此代码在浏览器或 GWT 开发模式下不起作用。那是因为同源政策。

此代码仅适用于 Windows 小工具，因为小工具的同源策略已禁用。

# php - ffmpeg 没有给出正确的 mp4 持续时间

> ID：10836859
> 
> 赞同：1
> 
> 时间：2012-05-31T15:41:46.410
> 
> 标签：php, ffmpeg

我正在使用 ffmpeg 通过 php 将视频转换为 flv 文件。我所做的测试不适用于 mp4 转换。我有一个 13 秒的视频（视频将限制为 15 秒），当它上传时，我检查了视频的“持续时间”，它超过了 300 秒。我尝试改变处理视频的方式：

```
// original
exec('ffmpeg -i <path>/<filename> 2>&1', $output);

// current
exec('ffmpeg -i <path>/<filename> 2>&1 | grep "Duration" | cut -d \' \' -f 4 | sed s/,//', $output); 
```

原始方法不适用于 mpg 文件，但第二种方法可以，但都没有给我 mp4 视频的“正确”持续时间。是否有一种“特殊”的方式来处理 mp4 文件？

感谢您的时间和帮助。

**更新：**

命令行

```
ffmpeg -i ./custom_scraping.mp4 2>&1 | grep "Duration" | cut -d ' ' -f 4 | sed s/,//
00:05:15.84 
```

完整输出（尽我所能格式化）

```
ffmpeg -i ./custom_scraping.mp4 2>&1
FFmpeg version 0.6.5, Copyright (c) 2000-2010 the FFmpeg developers
built on Jan 29 2012 23:55:02 with gcc 4.1.2 20080704 (Red Hat 4.1.2-51)
configuration: --prefix=/usr --libdir=/usr/lib64 --shlibdir=/usr/lib64 --mandir=/usr/share/man --incdir=/usr/include --disable-avisynth --extra-cflags='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m64 -mtune=generic -fPIC' --enable-avfilter --enable-avfilter-lavf --enable-libdirac --enable-libfaac --enable-libfaad --enable-libfaadbin --enable-libgsm --enable-libmp3lame --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libx264 --enable-gpl --enable-nonfree --enable-postproc --enable-pthreads --enable-shared --enable-swscale --enable-vdpau --enable-version3 --enable-x11grab
libavutil     50.15\. 1 / 50.15\. 1
libavcodec    52.72\. 2 / 52.72\. 2
libavformat   52.64\. 2 / 52.64\. 2
libavdevice   52\. 2\. 0 / 52\. 2\. 0
libavfilter    1.19\. 0 /  1.19\. 0
libswscale     0.11\. 0 /  0.11\. 0
libpostproc   51\. 2\. 0 / 51\. 2\. 0

Seems stream 1 codec frame rate differs from container frame rate: 5994.00 (5994/1) -> 29.97 (2997/100)
Input #0, mov,mp4,m4a,3gp,3g2,mj2, from './custom_scraping.mp4':
Metadata:
major_brand     : mp42
minor_version   : 1
compatible_brands: mp42avc1
Duration: 00:05:15.84, start: 0.000000, bitrate: 36 kb/s
Stream #0.0(eng): Audio: aac, 44100 Hz, stereo, s16, 2 kb/s
Stream #0.1(eng): Video: h264, yuv420p, 480x360, 36 kb/s, 1.04 fps, 29.97 tbr, 2997 tbn, 5994 tbc 
```

必须至少指定一个输出文件

不知道它是否有帮助，但来自 Linux 中的文件列表：1432471 May 31 13:33 custom_scraping.mp4

让我知道是否需要其他任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T18:12:09.017

使用最近的 ffmpeg 将提供正确的持续时间：

```
$ ffmpeg -i custom_scraping.mp4
ffmpeg version N-41105-g7a2ae76 Copyright (c) 2000-2012 the FFmpeg developers
  built on May 29 2012 21:41:27 with gcc 4.7.0 20120505 (prerelease)
  configuration: --prefix=/usr --enable-gpl --enable-libfaac --enable-libmp3lame --enable-libtheora --enable-libutvideo --enable-libvorbis --enable-libx264 --enable-nonfree --enable-x11grab
  libavutil      51\. 55.100 / 51\. 55.100
  libavcodec     54\. 23.100 / 54\. 23.100
  libavformat    54\.  6.101 / 54\.  6.101
  libavdevice    54\.  0.100 / 54\.  0.100
  libavfilter     2\. 77.100 /  2\. 77.100
  libswscale      2\.  1.100 /  2\.  1.100
  libswresample   0\. 15.100 /  0\. 15.100
  libpostproc    52\.  0.100 / 52\.  0.100
Input #0, mov,mp4,m4a,3gp,3g2,mj2, from 'custom_scraping.mp4':
  Metadata:
    major_brand     : mp42
    minor_version   : 1
    compatible_brands: mp42avc1
    creation_time   : 2011-08-17 21:14:16
  Duration: 00:00:11.11, start: 0.000000, bitrate: 1031 kb/s
    Stream #0:0(eng): Audio: aac (mp4a / 0x6134706D), 44100 Hz, stereo, s16, 2 kb/s
    Metadata:
      creation_time   : 2011-08-17 21:14:16
      handler_name    : Apple Sound Media Handler
    Stream #0:1(eng): Video: h264 (Main) (avc1 / 0x31637661), yuv420p, 480x360, 36 kb/s, 1.04 fps, 29.97 tbr, 2997 tbn, 5994 tbc
    Metadata:
      creation_time   : 2011-08-17 21:14:16
      handler_name    : Apple Video Media Handler
At least one output file must be specified 
```

当您遇到意外行为时，首先要做的是尝试最新的 FFmpeg。否则，您可能会浪费时间与已经解决的错误作斗争。FFmpeg 开发非常活跃。如果最近的 FFmpeg 中仍然存在错误，请在[错误跟踪器](https://ffmpeg.org/trac/ffmpeg)上报告。

从 Git 获取 FFmpeg 通常是一般用户的首选。这些发行版更多地针对那些“需要”所谓发行版的发行版。

[FFmpeg Wiki 包含CentOS](https://ffmpeg.org/trac/ffmpeg/wiki/CentosCompilationGuide)（以及 Red Hat）和[Ubuntu](https://ffmpeg.org/trac/ffmpeg/wiki/UbuntuCompilationGuide)的编译指南。

# c# - how to start 123.exe after pushed save button?

> ID：10836861
> 
> 赞同：1
> 
> 时间：2012-05-31T15:41:49.187
> 
> 标签：c#, add

I have some code in C# it is for saving some data in alterIWnet.ini file so after saved data in alterIWnet.ini file the form gets closed.

But after I push the save button I wan the data saved in alterIWnet.ini file and then open the `123.exe` file after that.

What code must I add to this job?

My C# code:

```
namespace configure_alteriwnet
{
using configure_alteriwnet.Properties;
using System;
using System.ComponentModel;
using System.Drawing;
using System.Windows.Forms;

public class frmConfig : Form
{
    private Button button1;
    private IContainer components;
    private Label label1;
    private PictureBox pictureBox1;
    private TextBox textBox1;

    public frmConfig()
    {
        this.InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        if ((this.textBox1.Text == "") || (this.textBox1.Text.Length > 80))
        {
            MessageBox.Show("The entered nickname is invalid.", "alterIWnet", MessageBoxButtons.OK, MessageBoxIcon.Hand);
        }
        else
        {
            new IniReader(@".\\alterIWnet.ini").Write("Configuration", "Nickname", this.textBox1.Text);
            base.Close();
        }
    }

    protected override void Dispose(bool disposing)
    {
        if (disposing && (this.components != null))
        {
            this.components.Dispose();
        }
        base.Dispose(disposing);
    }

    private void frmConfig_Load(object sender, EventArgs e)
    {
        this.textBox1.Text = new IniReader(@".\\alterIWnet.ini").ReadString("Configuration", "Nickname", "UnknownPlayer");
    }

    private void InitializeComponent()
    {
        this.pictureBox1 = new System.Windows.Forms.PictureBox();
        this.textBox1 = new System.Windows.Forms.TextBox();
        this.label1 = new System.Windows.Forms.Label();
        this.button1 = new System.Windows.Forms.Button();
        ((System.ComponentModel.ISupportInitialize)(this.pictureBox1)).BeginInit();
        this.SuspendLayout();
        // 
        // pictureBox1
        // 
        this.pictureBox1.Location = new System.Drawing.Point(13, 13);
        this.pictureBox1.Name = "pictureBox1";
        this.pictureBox1.Size = new System.Drawing.Size(650, 120);
        this.pictureBox1.TabIndex = 0;
        this.pictureBox1.TabStop = false;
        // 
        // textBox1
        // 
        this.textBox1.Location = new System.Drawing.Point(245, 156);
        this.textBox1.Name = "textBox1";
        this.textBox1.Size = new System.Drawing.Size(200, 20);
        this.textBox1.TabIndex = 1;
        this.textBox1.Text = "UnknownPlayer";
        // 
        // label1
        // 
        this.label1.AutoSize = true;
        this.label1.ForeColor = System.Drawing.Color.White;
        this.label1.Location = new System.Drawing.Point(316, 140);
        this.label1.Name = "label1";
        this.label1.Size = new System.Drawing.Size(58, 13);
        this.label1.TabIndex = 2;
        this.label1.Text = "Nickname:";
        // 
        // button1
        // 
        this.button1.Location = new System.Drawing.Point(299, 182);
        this.button1.Name = "button1";
        this.button1.Size = new System.Drawing.Size(75, 23);
        this.button1.TabIndex = 3;
        this.button1.Text = "Save";
        this.button1.UseVisualStyleBackColor = true;
        this.button1.Click += new System.EventHandler(this.button1_Click);
        // 
        // frmConfig
        // 
        this.BackColor = System.Drawing.Color.Black;
        this.ClientSize = new System.Drawing.Size(674, 215);
        this.Controls.Add(this.button1);
        this.Controls.Add(this.label1);
        this.Controls.Add(this.textBox1);
        this.Controls.Add(this.pictureBox1);
        this.Name = "frmConfig";
        this.Text = "alterIWnet MW2 configuration";
        this.Load += new System.EventHandler(this.frmConfig_Load);
        ((System.ComponentModel.ISupportInitialize)(this.pictureBox1)).EndInit();
        this.ResumeLayout(false);
        this.PerformLayout();

    }
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T15:43:58.047

Use `System.Diagnostics.[Process](https://msdn.microsoft.com/en-us/library/system.diagnostics.process(v=vs.110).aspx).[Start()](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx)` like so:

```
Process.Start("123.exe"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:45:31.037

在命名空间中添加以下行

导入 System.Diagnostics.Process；

在按钮的单击事件中添加以下行。

Process.Start("123.exe");

# perl - 草莓 perl，找不到 App/Cpan.pm

> ID：10836862
> 
> 赞同：5
> 
> 时间：2012-05-31T15:41:51.870
> 
> 标签：perl, strawberry-perl

我安装了 32 位版本的草莓 perl(5.14.2.1)。我能够运行 perl 命令。每当我运行`cpan`命令时，都会出现以下错误：

```
Can't locate App/Cpan.pm in @INC (@INC contains: /usr/lib/perl5/5.8.8/msys /usr/
lib/perl5/5.8.8 /usr/lib/perl5/site_perl/5.8.8/msys /usr/lib/perl5/site_perl/5.8
.8 /usr/lib/perl5/site_perl .) at /c/strawberry/perl/bin/cpan line 5.
BEGIN failed--compilation aborted at /c/strawberry/perl/bin/cpan line 5. 
```

我从 64 位版本迁移到 32 位版本。`cpan`当我使用 64 位版本时，该命令曾经有效。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-31T15:50:49.177

“/usr/lib/perl5/5.8.8/msys”？你没有运行 Strawberry Perl！您正在运行的`cpan`文件是由另一个 Perl 安装的。尝试

```
C:\>c:\strawberry\perl\bin\perl -MCPAN -e shell 
```

# java - Cassandra 和二进制文件

> ID：10836867
> 
> 赞同：2
> 
> 时间：2012-05-31T15:42:18.940
> 
> 标签：java, upload, binary, cassandra, kundera

我正在使用 Cassandra DB 在 Java 中的软件文件管理器中工作。我的数据库正在运行，并且我使用 Kundera 进行了成功的查询。

但是现在，我在 Cassandra 中搜索上传二进制文件（blob，或者只是文件？）。我试过这个方法：

*   在我的实体中创建一个变量类型：文件，但它不起作用。
*   将 File 转换为 Byte[] 并将 Byte[] 放入我的实体中但仍然无法正常工作，我的 Byte[] 返回为 null ！

您对 Cassandra 数据库中的小文件有什么想法吗？

我希望我的英语是可以理解的......
问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T16:20:05.223

请查看[http://www.datastax.com/dev/blog/bulk-loading](http://www.datastax.com/dev/blog/bulk-loading)。

不确定，但是将文件转换为 byte[] 可能不起作用，因为您可能需要打开字节流才能成功处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T19:18:04.380

Kundera 2.0.7 后版本支持 byte[] 作为数据类型。您可以将文件转换为 byte[] 并设置为实体属性，就像 premitives 和 wrappers 一样。一个示例测试用例在这里： [https ://github.com/impetus-opensource/Kundera/blob/trunk/kundera-tests/src/test/java/com/impetus/kundera/tests/file/dao/ProfilePictureDaoTest.java](https://github.com/impetus-opensource/Kundera/blob/trunk/kundera-tests/src/test/java/com/impetus/kundera/tests/file/dao/ProfilePictureDaoTest.java)

# java - Load testing Tapestry app mainly using javascript with JMeter

> ID：10836869
> 
> 赞同：1
> 
> 时间：2012-05-31T15:42:21.630
> 
> 标签：java, javascript, jmeter, load-testing, tapestry

I have a Tapestry application, which I want to load test using JMeter.

The problem is Tapestry app gives a response which is mainly javascript, no html to parse.

To be able to verify the response, I need to evaluate javascrpt.

Does anybody has any experience or pointers on how to do this ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-09T12:50:27.417

如果您只需要在响应中搜索特定的预期值，您可以使用正则表达式匹配器等后处理器。

请参阅此处的示例：http: [//blazemeter.com/blog/using-regular-expressions-jmeter](http://blazemeter.com/blog/using-regular-expressions-jmeter)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-05T10:01:36.100

正如 Howard M. Lewis Ship 所提到的，您可能最好使用[Geb。](http://www.gebish.org)[Geb 是位于selenium](http://www.seleniumhq.org)之上的 jQuery 层，类似于 groovy 语法。

正常使用是让 Geb/Selenium 启动一个真正的浏览器（chrome/firefox/IE）来运行测试。还有一个 java only / headless 选项可以使用[HtmlUnitDriver](https://code.google.com/p/selenium/wiki/HtmlUnitDriver)，这比启动浏览器要快得多。请注意，HtmlUnit 提供的 DOM / javascript 在[rhino](https://developer.mozilla.org/en-US/docs/Rhino)上运行，并且可能有自己的怪癖，使其与真实的浏览器不同。

# jquery - blueimp jquery file upload issues on ie9

> ID：10836870
> 
> 赞同：0
> 
> 时间：2012-05-31T15:42:23.490
> 
> 标签：jquery, jquery-plugins, file-upload, blueimp

having "issues" with the blueimp jquery file uploader, uploads fine, but no progress is reported back to the calling page, only in ie8/ie9.

"done" seems to work properly, its only the "progress" part that isnt working, anyone any ideas?

```
<script>
    $(function () {

        $('#video').fileupload({
             forceIframeTransport: true,
            dataType: 'json',
            done: function (e, data) {
                $.each(data.result, function (index, file) {
                    $('button').removeAttr('disabled');
                    alert(file);
                    $('input#upload_video').val(file.name);
                    $('p#filename').text(file.name+ ' Uploaded');
                    $('input#video').remove();

                    alert( $('input#upload_video').val());

                });
            },

            progress: function (e, data) {

                var progress = parseInt(data.loaded / data.total * 100, 10);
                $('p#filename').text('Please wait...' +progress + '%');
            },

            start: function (e) {
                // alert('Uploads started');
            },

            stop: function (e) {
                // alert('Uploads finished');
            },

            fail: function (e, data) {
                alert('Your video could not be uploaded');
                $('p#filename').text('');
            }

        });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-03T15:14:08.147

我不认为你做错了什么。目前 IE 不支持它。见[https://github.com/blueimp/jQuery-File-Upload/issues/1369](https://github.com/blueimp/jQuery-File-Upload/issues/1369)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T13:46:31.123

IE9 不支持 XMLHttpRequest 级别 2，因此您将无法使用 IE < 10 进行工作。它没有与插件相关的任何内容。

[http://caniuse.com/xhr2](http://caniuse.com/xhr2)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-10-11T06:14:56.283

```
 $("#txt1").fileupload({
        replaceFileInput: false,
        dataType: "json",        
        datatype:"json",
        url: "<%=Page.ResolveUrl("~/WebService/AddAttachment.ashx")%>",
        done: function (e, data) {
            $.each(data.result, function (index, value) {
         //You get the response data in here from your web service
            })
            $("#txt1").val("");
        }`enter code here`
    }); 
```

这在 IE8 和 IE9 + 以上都经过测试并且工作正常。请确保使用正确的dataType：“json”（或datatype：“json”），并确保在调试和检查时您的Web服务方法响应正确更新为data.result。谢谢

# sql - Creating Muliple counts using different where clauses

> ID：10836873
> 
> 赞同：0
> 
> 时间：2012-05-31T15:42:34.157
> 
> 标签：sql, sql-server, count

The Below Statement works perfectly. It counts all the values from region 37000 and has a computed column no. What I want to do is add several more counts where I can change the where clause for instance to 38000 or 39000\. Can anyone help me out... Thanks

```
SELECT a.region, COUNT(*) AS [computedCol1]    
(
SELECT  DISTINCT table1.serial1, table1.serial2,
    CASE WHEN table2.serial1 IS NULL THEN 'No' ELSE 'Yes' END AS [computedCol1],
    CASE WHEN table3.serial2 IS NULL THEN 'No' ELSE 'Yes' END AS [computedCol2],
    CASE WHEN table3.serial2 IS NULL AND table2.serial1 IS NULL THEN 'No' ELSE 'Yes' END AS [computedCol3]

FROM    table1
        LEFT JOIN table2
            ON table2.serial1 = table1.serial1
        LEFT JOIN dbo.EPG
            table3.serial2 = table1.serial2
)a where region = '37000' and [computedCol1]= 'No'
    group by a.region 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:48:07.150

`WHERE region in ('37000','38000','39000')`

当您按区域分组时，您将获得每个区域的三个不同行及其计数。

# sql - JOIN 2 从一张表中选择查询

> ID：10836874
> 
> 赞同：1
> 
> 时间：2012-05-31T15:42:35.187
> 
> 标签：sql, sql-server

我有一个叫做日志的表。日记有 4 列：

1.  日期（日期）
2.  帐户（整数）
3.  Type(varchar(1) (可以接受字符 D 或 C)
4.  金额（十进制（18,2））

**杂志**

```
Date         Account    Amount    Type
2012-05-31   20001      300       D
2012-05-31   20002      700       C
2012-05-31   20003      600       D
2012-05-31   20004      900       C 
```

类型列只能采用 2 种类型的字符值：D 或 C。所以我需要一个查询，它会给我 4 列，这样结果列是：

```
Date        Account       D       C
2012-05-31  200101        300     0
2012-05-31  200102        0       700
2012-05-31  200103        600     0
2012-05-31  200104        0       900 
```

D 和 C 列填充了来自 Amount 的值，无论它们是否为空。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:47:51.087

您可以使用[PIVOT](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)完成此操作：

```
create table journal
(
    date datetime,
    account int,
    amount money,
    type varchar(1)
)

insert into journal values ('05/31/12', 20001, 300, 'D')
insert into journal values ('05/31/12', 20002, 700, 'C')
insert into journal values ('05/31/12', 20003, 600, 'D')
insert into journal values ('05/31/12', 20004, 900, 'C')

select date
    , account
    , isnull([D], 0) as D
    , isnull([C], 0) as C
from 
(
    select *
    from journal
) x
pivot
(
    sum(amount)
    for type in ([D], [C])
) p

drop table journal 
```

查看带有演示的[SQL Fiddle](http://sqlfiddle.com/#!3/66f7d8/1)

如果您想加入帐户名称，那么您将需要在该表上执行 JOIN。请参阅使用演示更新[SQL Fiddle ：](http://sqlfiddle.com/#!3/35e54/2)

```
select date
    , account
    , name
    , isnull([D], 0) as D
    , isnull([C], 0) as C
from 
(
    select *
    from journal j
    inner join account a
      on j.account = a.id
) x
pivot
(
    sum(amount)
    for type in ([D], [C])
) p 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:58:28.750

```
SELECT DATE,
       account,
       CASE
         WHEN TYPE = 'D' THEN
          amount
         ELSE
          0
       END D,
       CASE
         WHEN TYPE = 'C' THEN
          amount
         ELSE
          0
       END C TYPE
  FROM JOURNAL 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:47:26.777

你想做这样的事情吗？

```
SELECT
    SUM(CASE [Type] WHEN 'C' THEN [Amount] ELSE 0 END) AS C
    ,SUM(CASE [Type] WHEN 'D' THEN [Amount] ELSE 0 END) AS D
    ,[Date]
    ,[Account]
FROM
    Journal
GROUP BY
    [Date]
    ,[Account] 
```

这将汇总日期/帐户组合的每个值的金额。您可以用`SUM`您选择的任何聚合替换聚合（`MIN`等`MAX`）

# php - Fusion Charts: How to hide values of Pie Chart

> ID：10836883
> 
> 赞同：0
> 
> 时间：2012-05-31T15:43:00.833
> 
> 标签：php, fusioncharts

Referring the [URL](http://docs.fusioncharts.com/free/Contents/ChartSS/Images/XML_3DPie1.gif), how can I hide values around Pie chart? I need to do it to consume the space. I am unable to find the way to do it.

I am using Free version of Fusion Charts

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T04:58:12.340

尝试`showNames='0' showValues='0'`在`<chart>`元素中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:46:58.357

尝试

```
<chart [..........] showLabels='0' showValues='0' [...........]  > 
```

# ruby-on-rails - 无法使指南针+守卫+ sass工作

> ID：10836884
> 
> 赞同：2
> 
> 时间：2012-05-31T15:43:01.277
> 
> 标签：ruby-on-rails, ruby-on-rails-3, sass, compass-sass, guard

导轨 3.0.9。

在 Gemfile 中：

```
gem 'compass-rails' (1.0.1)
gem 'sass' (3.0.19)
...

group :development, :test do
  gem 'guard' (1.0.3)
  gem 'guard-sass' (0.6.0)
  ...
end 
```

在此配置中，错误是：

```
ERROR: Sass > Syntax error: File to import not found or unreadable: compass.
              Load paths:
                /var/www/inbox/public
                /var/www/inbox/public/images
                /var/www/inbox/public/images/intro
                ... 
```

（通常我可以看到指南针的路径丢失（即`...ruby-1.9.3-p194-perf/gems/compass-0.12.1/frameworks/compass/stylesheets`不**存在**），所以不知何故指南针没有被加载，我不知道该怎么做才能让它加载。

当我交易`guard-sass`错误`guard-compass`是：

```
ERROR: Rails.root is nil! (RuntimeError)
/home/jkl/.rvm/gems/ruby-1.9.3-p194-perf/gems/sass-3.1.19/lib/sass/util.rb:370:in `rails_root'
/home/jkl/.rvm/gems/ruby-1.9.3-p194-perf/gems/sass-3.1.19/lib/sass/plugin/rails.rb:11:in `default_options'
/home/jkl/.rvm/gems/ruby-1.9.3-p194-perf/gems/sass-3.1.19/lib/sass/plugin/configuration.rb:33:in `options'
/home/jkl/.rvm/gems/ruby-1.9.3-p194-perf/gems/sass-3.1.19/lib/sass/plugin/compiler.rb:38:in `initialize'
/home/jkl/.rvm/gems/ruby-1.9.3-p194-perf/gems/sass-3.1.19/lib/sass/plugin.rb:63:in `new'
/home/jkl/.rvm/gems/ruby-1.9.3-p194-perf/gems/sass-3.1.19/lib/sass/plugin.rb:63:in `compiler'
/home/jkl/.rvm/gems/ruby-1.9.3-p194-perf/gems/sass-3.1.19/lib/sass/plugin.rb:120:in `options'
... 
```

`guard-livereload`每当我更新`.sass`文件时，我都希望它能够正常工作。

请注意，通常指南针可以正常工作。在页面刷新时，将从 SASS 文件生成新的 CSS。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T08:45:23.363

This happens because `guard-sass` hardcodes SASS import paths only to subdirectories of the current directory (see [https://github.com/hawx/guard-sass/blob/ac65c06fb0ea237713197730196d30ac47840bbf/lib/guard/sass.rb#L20](https://github.com/hawx/guard-sass/blob/ac65c06fb0ea237713197730196d30ac47840bbf/lib/guard/sass.rb#L20) in the latest version 0.6.0) thus importing SASS from Compass is impossible (compass paths are not in the load paths of SASS).

The workaround for that is to override the `:load_paths` setting. Here's how I do it:

```
 guard 'sass', 
    :input => 'app/assets/stylesheets', 
    :output => 'public/stylesheets', 
    :load_paths => Dir.glob(File.join(Gem.dir, "gems", "compass*", "frameworks/blueprint/stylesheets")) + Dir.glob(File.join(Gem.dir, "gems", "compass*", "frameworks/compass/stylesheets")) 
```

Or just upgrade to version 0.7+, where the above should be no longer necessary.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-07T16:30:42.450

I recently installed guard-sass on my Rails 3.0.9 project and encountered the same issue. The answer Pawel provided did not help me. Then, I realized that I don't need to use guard on my development server, I just need to make sure that it is installed on my local machine when I am working on styles and scripts so my Sass will become CSS and then compressed CSS (Jammit).

What I've done is isolate my guard gems in a group in my Gemfile like:

```
group :guard do
  gem 'rb-fsevent',   :require => false if RUBY_PLATFORM =~ /darwin/i # Installs fsevent if on a Mac
  gem "sass",         "~> 3.2.1"
  gem 'guard-sass',   "~> 1.0.0"
  gem 'guard-jammit'
end 
```

Then I can start up my rails application in a terminal window, and guard in another terminal.

# linux - FFmpeg cannot recognize a preset even though it does exist Ubuntu 12.04

> ID：10836888
> 
> 赞同：3
> 
> 时间：2012-05-31T15:43:31.180
> 
> 标签：linux, ubuntu, ffmpeg, x264

I have installed ffmpeg and x264 folloowing the steps in this documentation :[http://ffmpeg.org/trac/ffmpeg/wiki/UbuntuCompilationGuide](http://ffmpeg.org/trac/ffmpeg/wiki/UbuntuCompilationGuide)

Now I have this line to execute :

```
sudo /usr/bin/ffmpeg -i input_file.flv -f flv -vcodec libx264 -vpre normal -r 25 -s 0x0 -aspect 1.7777777777778 -padcolor 000000 -padtop 0 -padbottom 0 -padleft 0 -padright 0 -acodec libfaac -ab 128000 -ar 22050 output_file.flv

Input #0, flv, from 'WIN! Jwow.flv':
  Metadata:
    starttime       : 0
    totalduration   : 101
    totaldatarate   : 865
    bytelength      : 10897460
    canseekontime   : true
    sourcedata      : BD58B2E43HH1338284027987695
    purl            : 
    pmsg            : 
  Duration: 00:01:40.66, start: 0.000000, bitrate: 877 kb/s
    Stream #0.0: Video: h264 (Main), yuv420p, 640x360, 745 kb/s, 29.97 tbr, 1k tbn, 59.94 tbc
    Stream #0.1: Audio: aac, 44100 Hz, stereo, s16, 131 kb/s
**File for preset 'normal' not found** 
```

I have the presets in the the following directories:

```
/usr/share/ffmpeg
/usr/local/share/ffmpeg
/home/user/.ffmpeg
/usr/local/src/ffmpeg/presets 
```

And still getting the same error: **File for preset 'normal' not found**

What is the problem here?

Extra info - this is what i get when i do ffmpeg -version

```
ffmpeg version git-2012-05-31-60de761
built on May 31 2012 15:54:11 with gcc 4.6.3
configuration: --enable-gpl --enable-libfaac --enable-libmp3lame --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libtheora --enable-libvorbis --enable-libx264 --enable-nonfree --enable-version3 --enable-x11grab 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-31T17:46:13.373

好消息是您使用的是最新的 ffmpeg 和 x264。坏消息是您使用的是过时的语法。FFmpeg 开发非常活跃，并且确实会发生语法更改，当前与您的命令等效的语法是：

```
ffmpeg -i input_file.flv -vcodec libx264 -preset medium -crf 23 -acodec libfaac -aq 100 -ar 22050 output_file.flv 
```

我删除了所有多余的东西。为什么填充值为0？什么将输出大小调整为 0x0？在大多数情况下，您不需要更改帧速率，所以我也删除`-r`了。

我建议在将`-aq`libx264`-q:a`与. 它类似于默认设置。`-b:a``-crf``faac -q 100`

至于预设，ffmpeg 不再使用文本文件来模拟标准的 x264 预设，而是现在直接通过 libx264 访问它们。查看`x264 --fullhelp`预设列表，但忽略`placebo`预设，因为这完全是浪费时间。基本用法是使用您有耐心的最慢预设。

我添加了`-crf`控制视频质量的选项。默认值为 23。较低的值是较高的质量，合理的范围是 18-24。基本用法是使用仍然可以为您提供可接受质量的最高值。有关更详细的说明，请参阅[FFmpeg：终极视频和音频操作工具。](http://blog.superuser.com/2012/02/24/ffmpeg-the-ultimate-video-and-audio-manipulation-tool)

# android - Saving a photo in portrait

> ID：10836890
> 
> 赞同：3
> 
> 时间：2012-05-31T15:43:34.430
> 
> 标签：android

I am running an app, which will always run in portrait on the phone. When taking a photo, I can see the image in portrait on the phone, however, when its saved to the SD card the image is always in landscape. Here is what I have done, I use this is the manifest

```
 <uses-feature android:name="android.hardware.screen.portrait" /> 
```

When I start the camera, I use the following to change the orientation

```
 camera = Camera.open(); // <8>
    Camera.Parameters parameters = camera.getParameters();
    camera.setDisplayOrientation(90);
    parameters.setZoom(16);
    parameters.setPictureFormat(PixelFormat.JPEG);
    camera.setParameters(parameters); 
```

Then when saving the photo, I use this code

```
 PictureCallback jpegCallback = new PictureCallback() {
        public void onPictureTaken(byte[] data, Camera camera) { 
            FileOutputStream outStream = null;
            boolean mExternalStorageAvailable = false;
            boolean mExternalStorageWriteable = false;
            String state = Environment.getExternalStorageState();
            if (Environment.MEDIA_MOUNTED.equals(state)) {
                // We can read and write the media
                mExternalStorageAvailable = mExternalStorageWriteable = true;
                Log.d(TAG, "Can Write ");
                try {
                    String baseDir = Environment.getExternalStorageDirectory().getAbsolutePath();
                    String fileName = "/" + System.currentTimeMillis() + ".jpg";
                    Log.d(TAG, "File: " + baseDir + fileName);
                    outStream = new FileOutputStream(baseDir + fileName); 
                    outStream.write(data);
                    outStream.close();

                    Log.d(TAG, "onPictureTaken - wrote bytes: " + data.length);
                } catch (FileNotFoundException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                } finally {
                }

            } else if (Environment.MEDIA_MOUNTED_READ_ONLY.equals(state)) {
                // We can only read the media
                mExternalStorageAvailable = true;
                mExternalStorageWriteable = false;
                Log.d(TAG, "Cant Write ");
            } else {
                // Something else is wrong. It may be one of many other states, but all we need
                //  to know is we can neither read nor write
                mExternalStorageAvailable = mExternalStorageWriteable = false;
                Log.d(TAG, "Other Error ");
            }
                }
    }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-05T20:53:39.597

我已经使用以下代码完成了上述操作

```
 PictureCallback jpegCallback = new PictureCallback() {
    @Override
        public void onPictureTaken(byte[] data, Camera camera) { 
        BitmapFactory.Options options = new BitmapFactory.Options();
        options.inSampleSize = 1;
        options.inDither = false; // Disable Dithering mode
        options.inPurgeable = true; // Tell to gc that whether it needs free
                                    // memory, the Bitmap can be cleared
        options.inInputShareable = true; // Which kind of reference will be
                                            // used to recover the Bitmap
                                            // data after being clear, when
                                            // it will be used in the future
        options.inTempStorage = new byte[32 * 1024];
        options.inPreferredConfig = Bitmap.Config.RGB_565;
        Bitmap bMap = BitmapFactory.decodeByteArray(data, 0, data.length, options);

        int orientation;
        // others devices
        if(bMap.getHeight() < bMap.getWidth()){
            orientation = 90;
        } else {
            orientation = 0;
        }

        Bitmap bMapRotate;
        if (orientation != 0) {
            Matrix matrix = new Matrix();
            matrix.postRotate(orientation);
            bMapRotate = Bitmap.createBitmap(bMap, 0, 0, bMap.getWidth(),
                    bMap.getHeight(), matrix, true);
        } else
            bMapRotate = Bitmap.createScaledBitmap(bMap, bMap.getWidth(),
                    bMap.getHeight(), true);

        FileOutputStream out;
    boolean mExternalStorageAvailable = false;
    boolean mExternalStorageWriteable = false;
        try {
        String baseDir = Environment.getExternalStorageDirectory().getAbsolutePath();
        String fileName = "/" + System.currentTimeMillis() + ".jpg";

            out = new FileOutputStream(baseDir + fileName);
            bMapRotate.compress(Bitmap.CompressFormat.JPEG, 50, out);
            if (bMapRotate != null) {
                bMapRotate.recycle();
                bMapRotate = null;
            }

        } catch (FileNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }
}; 
```

# php - Check variables through a loop

> ID：10836891
> 
> 赞同：0
> 
> 时间：2012-05-31T15:43:37.473
> 
> 标签：php, variables, foreach

I can't seem to figure out how to loop a variable check. What I am trying to do is something like checking those two variables but in a loop

```
if(isset($_GET['action'])){
    $action = $_GET['action'];
}
else{
    $action = NULL;
}

if(isset($check)){
    $check = $check;
}
else{
    $check = NULL;
} 
```

I want to do something like this or more effiecient if possible

```
$variables = array($_GET['action'], $check);
$define = array($action, $check);

foreach($variables as $variable){
 if(isset($variable){
   $variable = $define;
 }
} 
```

I want it to show no errors while I have error_reporting(E_ALL) open Could someone help me with this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:47:40.473

如果未设置变量，您的第一行将导致警告：

```
$variables = array($_GET['action'], $check);    // here you are possibly using unset variables 
```

如果你想写得更短一点，你可以使用三元运算符，但仅此而已：

```
$action = isset($_GET['action']) ? $_GET['action'] : NULL;
$check = isset($check) ? $check : NULL; 
```

我认为没有更有效的方法可以一次检查普通变量和超级全局变量的组合。

# propel - 由于以下原因，目标“convert-conf”的执行失败 - 未指定有效的 xmlConfFile。

> ID：10836895
> 
> 赞同：0
> 
> 时间：2012-05-31T15:43:58.410
> 
> 标签：propel

按照propel网站上的教程并执行以下2个命令没有错误：

```
./propel-gen om
./propel-gen sql 
```

我试过：

```
./propel-gen convert-conf 
```

发生以下错误。

```
django@ubuntu{~/www/propel/addons/schema} (propel *+)$ ./propel-gen convert-conf
Buildfile: /home/django/www/propel/addons/schema/Propel/generator/build.xml

propel-project-builder > check-project-or-dir-set:
propel-project-builder > check-project-set:
propel-project-builder > set-project-dir:
propel-project-builder > check-buildprops-exists:
propel-project-builder > check-buildprops-for-propel-gen:
propel-project-builder > check-buildprops:
propel-project-builder > configure:
     [echo] Loading project-specific props from /home/django/www/propel/addons/schema/build.properties
 [property] Loading /home/django/www/propel/addons/schema/build.properties

propel-project-builder > convert-conf:

    [phing] Calling Buildfile '/home/django/www/propel/addons/schema/Propel/generator/build-propel.xml' with target 'convert-conf'
 [property] Loading /media/SuperFast/www/propel/addons/schema/Propel/generator/./default.properties

propel > convert-conf:

     [echo] +------------------------------------------+
     [echo] |                                          |
     [echo] | Converting runtime config file to an     |
     [echo] | array dump for improved performance.     |
     [echo] |                                          |
     [echo] +------------------------------------------+
**Execution of target "convert-conf" failed for the following reason: /home/django/www/propel/addons/schema/Propel/generator/build-propel.xml:569:20: No valid xmlConfFile specified.
    [phing] /home/django/www/propel/addons/schema/Propel/generator/build-propel.xml:569:20: No valid xmlConfFile specified.**

BUILD FINISHED

Total time: 0.2250 seconds 
```

这是我的 build.properties：http://pastebin.com/seeE7d65[这里](http://pastebin.com/seeE7d65) 还有我不同尝试的更多输出：

[http://pastebin.com/6Np5QYTW](http://pastebin.com/6Np5QYTW)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T14:33:02.167

只需将您的文件重命名`runtime.conf.xml`为`runtime-conf.xml`预期的文件名；）

# android - iframe in android browser does not respect css height?

> ID：10836897
> 
> 赞同：1
> 
> 时间：2012-05-31T15:44:05.580
> 
> 标签：android, css, iframe

I have an iframe on a page in the android browser. I iframe code is liek this:

```
<iframe src="somepage.html" style="height: 100px"></iframe> 
```

No matter what I set the height to, the iframe always expands it's height to cover all the contents of somepage.html. This does not happen on other browser on my computer, iphone or blackberry devices.

Does anyone know what's going on?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T09:00:30.433

试试这个`<iframe width="320" height="194" src="http://example.com"></iframe>`。该链接以定义的高度很好地打开并滚动到页面底部。您正在链接的 html 页面中可能存在导致 iframe 高度扩展的内容。检查您的代码或在此处发布。

# java - 在 app2 中接收时，response.sendRedirect 用加密 URL 中的空格替换 +？

> ID：10836902
> 
> 赞同：1
> 
> 时间：2012-05-31T15:44:40.820
> 
> 标签：java, servlets, encryption, urlencode

在tomcat 上，我有两个web 应用程序，即app1 和app2。我从 app1 以加密形式（使用下面的程序）将 URL 发送到 app2 。我通过发送 URL `response.sendRedirect(encryptedURL)`。然后在 app2 我得到这个加密的 URL。我看到 app2 的这个加密 URL 中有一些额外的字符，例如 +,space()。我想要在 app2 上完全相同的 URL。我不明白为什么要插入这些额外的字符？

这是加密后app1的URL

```
 Rc9mgB+18chPk6nk1+gzpws6dO5/TSkcOYy8rbuVVTmjE9YjLt5w0EMpuhh+QBKzReYO34pAquf9
 kmYOiwl99jo2kDCCkYHMh/+nxEgs1yrLYagsc/0p5KdYeMy1eWeUQB8KqmNlhtYysrHhOYVuunUi
 dTaEKUTSWd8lPg9/wZfHdBoJgaF40aUW3FeRODVL 
```

当我使用 req.getParameter("encryptedURL");

```
 Rc9mgB 18chPk6nk1 gzpws6dO5/TSkcOYy8rbuVVTmjE9YjLt5w0EMpuhh QBKzReYO34pAquf9  kmYOiwl99jo2kDCCkYHMh/ nxEgs1yrLYagsc/0p5KdYeMy1eWeUQB8KqmNlhtYysrHhOYVuunUi  dTaEKUTSWd8lPg9/wZfHdBoJgaF40aUW3FeRODVL 
```

**这是加密程序**

```
 import java.security.Key;
 import javax.crypto.Cipher;
 import javax.crypto.spec.SecretKeySpec;
 import sun.misc.BASE64Decoder;
 import sun.misc.BASE64Encoder;

 public class AESEncryptionDecryptionTest {

   private static final String ALGORITHM       = "AES";
   private static final String myEncryptionKey = "ThisIsFoundation";
   private static final String UNICODE_FORMAT  = "UTF8";

   public static String encrypt(String valueToEnc) throws Exception {
 Key key = generateKey();
 Cipher c = Cipher.getInstance(ALGORITHM);
 c.init(Cipher.ENCRYPT_MODE, key);  
 byte[] encValue = c.doFinal(valueToEnc.getBytes());
 String encryptedValue = new BASE64Encoder().encode(encValue);
 return encryptedValue;
   }

private static Key generateKey() throws Exception {
byte[] keyAsBytes;
keyAsBytes = myEncryptionKey.getBytes(UNICODE_FORMAT);
Key key = new SecretKeySpec(keyAsBytes, ALGORITHM);
return key;
}

} 
```

**编辑：-看起来非常接近它。这是我的新代码和发现**

这是我在 app1 加密的参数

```
 mySession=84088586B45317C3600978DF9F52A699&securityTok=44a2e4dd89ed1aad438d5e3c16ff528&myurl=https://10.205.112.83:8443 
```

// 按照您在 app1 中的建议进行加密，并将 encryptedParam 作为请求参数发送

//现在从请求中获取 app2 处的 encryptedParam 并根据您的建议进行解密。正如您在下面看到 的那样**，除了我的 URL 部分（即`=https://10.205`替换为 ½‡è～�Àg¸l½.µbO'）之外，app2 中的所有内容都可以正常解密**

```
mySession=84088586B45317C3600978DF9F52A699&securityTok=44a2e4dd89ed1aad438d5e3c16ff528&myurl½‡è˜�Àg¸l½.µbO’112.83:8443 
```

**代码是**

```
 public static String encrypt(String valueToEnc) throws Exception {
    Key key = generateKey();
    // Key key = buildKey();
    Cipher c = Cipher.getInstance(ALGORITHM);
    c.init(Cipher.ENCRYPT_MODE, key);
    byte[] encValue = c.doFinal(valueToEnc.getBytes(UNICODE_FORMAT));
    String encryptedValue1 = new BASE64Encoder().encode(encValue);
    String encryptedValue = URLEncoder.encode(encryptedValue1);
    return encryptedValue;
  }

  public static String decrypt(String encryptedValue) throws Exception {
    Key key = generateKey();
    // Key key = buildKey();
    Cipher c = Cipher.getInstance(ALGORITHM);
    c.init(Cipher.DECRYPT_MODE, key);
    String decordedValueStr = URLDecoder.decode(encryptedValue);
    byte[] decordedValue = new BASE64Decoder().decodeBuffer(decordedValueStr);
    byte[] decValue = c.doFinal(decordedValue);
    // String try1=new BASE64Encoder().encode(decValue);
    String decryptedValue = new String(decValue);
    return decryptedValue;
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T15:52:49.270

您必须使用 URLEncoding。

*   使用[URLEncoder](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/URLEncoder.html)对 app1 中的 url 进行编码。
*   使用[URLDecoder](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/URLDecoder.html)对 app2 中的 url 进行解码。

当服务器收到重定向请求时，无论如何它都会进行 URL 解码。所以你不必这样做。只是 app1 中的 URLEncode 应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T17:50:46.707

在您的`encrypt`方法中，而不是：

```
return encryptedValue; 
```

使用此代码：

```
return URLEncoder.encode(encryptedValue); 
```

然后在接收端调用 URLDecoder#decode：

```
String tmpUrl = URLDecoder.decode(encryptedURL);
// call BASE64Decoder on tmpUrl
// call decrypt on return value of BASE64Decoder 
```

# scala - Scala this aliasing and self type

> ID：10836905
> 
> 赞同：4
> 
> 时间：2012-05-31T15:44:54.203
> 
> 标签：scala, playframework

`this aliasing`和之间有什么关系`self type`吗？是`this aliasing`特例`self type`吗？在scala 2nd P776编程中，作者说：

> 抽象类 Parser[+T] 扩展 ... { p =>
> 
> 你在第 29.4 节看到了这样的语法，它被用来给一个 trait 赋予一个 self 类型。

但是，自我类型的语法看起来不像这样，它就像：

> 这：SomeAssumedType =>

另一个问题是为什么`this aliasing`有用？我看不出给`this`引用一个别名有什么意义，因为它已经是当前对象引用的常规别名，但是在 Play 框架源代码中，我看到了很多代码（尤其是异常部分），例如：

> 特征 RowParser[+A] 扩展 (Row => SqlResult[A]) {
> 
> 父母 =>

为什么这有意义？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T15:52:13.513

您可以同时拥有自类型和`this`别名：

```
abstract class Parser[+T] { p: SomeAssumedType => … } 
```

如果你不包含类型归属，Scala 将假定变量的类型是周围类的类型，从而给你一个简单的`this`.

如果您保留名称`this`和归属，那么 Scala 期望您以可以满足归属的方式初始化这个类。

至于`this`混叠。这是需要这样做的情况：

```
object OuterObject { outer =>
  val member = "outer"
  object InnerObject {
    val member = "inner"
    val ref1 = member
    val ref2 = this.member
    val ref3 = outer.member

    def method1 = {
      val member = "method"
      member
    }
    def method2 = {
      val member = "method"
      this.member
    }
    def method3 = {
      val member = "method"
      outer.member
    }
  }
}

scala> OuterObject.InnerObject.ref1
res1: java.lang.String = inner

scala> OuterObject.InnerObject.ref2
res2: java.lang.String = inner

scala> OuterObject.InnerObject.ref3
res3: java.lang.String = outer

scala> OuterObject.InnerObject.method1
res4: java.lang.String = method

scala> OuterObject.InnerObject.method2
res5: java.lang.String = inner

scala> OuterObject.InnerObject.method3
res6: java.lang.String = outer 
```

# sql - 我在基本选择语句中找不到错误

> ID：10836906
> 
> 赞同：0
> 
> 时间：2012-05-31T15:45:05.087
> 
> 标签：sql

看看我的 where 子句，其中一个被注释掉了。

如果我按原样运行，我得到的结果为 0

但是如果我改变了我使用的 WHERE 子句，它就会起作用。我不明白，@Username 等于“Kleg”，但显然不是。有人能告诉我我在哪里犯错了吗

```
declare @UserName as varchar
set @UserName='Kleg'

declare @return as int
 set @return=(SELECT  userId
        FROM    users
        WHERE   UserName='Kleg')
--        WHERE   UserName=@Username)

SELECT  COALESCE(@return,0) 
```

我的查询更加基本，这个真的难倒我，其他人可以试试这个，看看他们是否可以复制我的问题，也许问题出在服务器上

```
declare @UserName as varchar
set @UserName='Kleg'

if (@UserName = 'Kleg')
select 1
else select 0 
```

这返回 0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:52:21.923

由于您只有 @UserName 声明为 varchar，如果您选择 @UserName，您将看到它只返回第一个字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:46:57.870

尝试替换它，注意我分配变量的方式发生了变化：

```
declare @UserName as varchar
set @UserName='Kleg'

declare @return as int
SELECT @return = userId
 FROM    users
 WHERE   UserName='Kleg')
--        WHERE   UserName=@Username)

SELECT  COALESCE(@return,0) 
```

请注意，如果与 where 子句有多个匹配项，它将不起作用！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:54:41.220

我做了一些测试，它不是 100% 确定的，但是看起来很像你说的

```
declare @UserName as varchar 
```

SQL 将变量设置为 a `varchar(1)`，这意味着您的 where 子句正在搜索值“K”。试试这个：

```
declare @UserName as varchar(50) 
```

或者，更好的是 UserName 列的长度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T15:55:14.883

您需要说明 varchar 中有多少个字符。将您的代码更改为以下内容，它应该可以工作：

```
declare @UserName as varchar(50)
set @UserName='Kleg'

if (@UserName = 'Kleg')
select 1
else select 0 
```

# android - 无法在 Android 4.0 设备上启动 Netty 服务器

> ID：10836907
> 
> 赞同：0
> 
> 时间：2012-05-31T15:45:09.553
> 
> 标签：android, netty

在无根的 Android 4.0.1 Galaxy Nexus 上使用 Netty 3.5.6。尝试在设备上运行 Netty 服务器。我的清单中有。

服务器绑定代码：

```
rtspSA= new InetSocketAddress(InetAddress.getLocalHost(),544);
Channel rtspChannel = bootstrap.bind(rtspSA);
allChannels.add(rtspChannel); 
```

我收到两个错误：

```
E/dalvikvm( 8884): Could not find class 'java.util.concurrent.LinkedTransferQueue', referenced from method org.jboss.netty.util.intenal.QueueFactory.createQueue 
```

和

```
E/NettyServer( 8884): org.jboss.netty.channel.ChannelException: Failed to bind to: localhost/127.0.0.1:544
E/NettyServer( 8884): Caused by: java.net.BindException: bind failed: EACCES (Permission denied) 
```

通过 Stackoverflow 阅读，听起来第一个是固定的：[Netty 3.4.1.Final 在 Android 上不起作用](https://stackoverflow.com/questions/10311885/netty-3-4-1-final-does-not-work-on-android)

第二个问题可能是权限问题，但我无法推断出我缺少哪个权限。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T08:09:49.133

我和你有同样的问题，在这里找到了部分解决方案： [https ://github.com/netty/netty/issues/272](https://github.com/netty/netty/issues/272)

这部分的一些东西：

```
You can now disable it via a system property.
3.x:
-Dorg.jboss.netty.tryUnsafe=false    
4.x
-Dio.netty.tryUnsafe=false
By default it will try to use Unsafe. 
```

我被包括在内

```
 System.setproperty(new property(" _ but I'm not sure what goes in here _")) 
```

在我的代码上，但我仍然不确定它是否正常工作，可能是错误的字符串或与：

```
It also can help if you have a custom ClassLoader in place or try to run in a non oracle/sun jdk. 
```

这是让它发挥作用的一个方向，但我不知道如何继续，如果有人有下一块拼图，将不胜感激。

# c# - Mono 中的全局热键

> ID：10836908
> 
> 赞同：2
> 
> 时间：2012-05-31T15:45:10.583
> 
> 标签：c#, linux, mono, x11

我正在尝试在 Mono 和 X11 中实现全局热键。不幸的是应用程序使用`System.Windows.Forms`，所以我不能使用[这个问题](https://stackoverflow.com/questions/2349958/global-hotkey-in-mono-and-gtk)中提出的 GDK# 事件过滤器。

使用`XGrabKey`作品，但我遇到了事件循环的问题。关闭应用程序时，处理 X11 事件循环的线程仍然挂起`XNextEvent`。有办法解决吗？我宁愿不使用`XPending`. 我可以以某种方式取消`XNextEvent`或发送虚拟事件吗？

我正在调用`XGrabKey`根窗口，所以不幸的是我没有收到任何类似`DestroyNotify`or的事件`UnmapNotify`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T19:41:36.413

用于`XSendEvent`发送`XClientMessageEvent`. 创建您自己的 atom 并设置`Atom`事件的成员，以便其他可能`XClientMessageEvent`在根窗口上监视的应用程序不受影响。

在你的事件循环中，检查这个原子，如果你得到它就退出。

# java - PreparedStatement 的空结果集

> ID：10836916
> 
> 赞同：0
> 
> 时间：2012-05-31T15:45:24.493
> 
> 标签：java, mysql, sql, jdbc

我运行以下 Java 代码：

```
String qry = "SELECT QUOTE(?) AS cleaned";
PreparedStatement getQuote = MySQLSingleton.getInstance().conn.prepareStatement(qry);
getQuote.setString(1, clean_string);
ResultSet resultSet = getQuote.executeQuery();
System.out.println("FIRST: " + resultSet.first());
System.out.println("GET STRING: " + resultSet.getString(1)); 
```

这个的输出是：

```
FIRST: true
GET STRING: null 
```

既不`resultSet.getString(1);`也不`resultSet.getString("cleaned");`返回任何东西，但`null`.

**编辑：** 直接在 MySQL 中运行语句没有问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T16:21:55.853

你的代码对我来说非常好。

```
String qry = "SELECT QUOTE(?) AS cleaned";
PreparedStatement getQuote = con.prepareStatement(qry);
getQuote.setString(1, "sdafsdaf");
ResultSet resultSet = getQuote.executeQuery();
System.out.println("FIRST: " + resultSet.first());
System.out.println("GET STRING: " + resultSet.getString(1)); 
```

输出：

> 第一个：真的
> 
> 获取字符串：'sdafsdaf'

我的版本中唯一的变化是变量**clean_string**。您能否确保**clean_string**的值有效（非空）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T15:47:54.843

```
String qry = "SELECT QUOTE(?) AS cleaned";
PreparedStatement getQuote = MySQLSingleton.getInstance().conn.prepareStatement(qry);
getQuote.setString(1, clean_string);
ResultSet resultSet = getQuote.executeQuery();
resultSet.first();
System.out.println(resultSet.getFetchSize()); 
```

在你的java代码中，我认为它是正确的。

**编辑：**

你应该知道`GetFetchSize()`不会返回`ResultSet`. `GetFetchSize()`返回数据库一次获取到您的应用程序的记录数。默认情况下，提取大小为 10。因此 fetch 返回 0，因为您不使用数据库表。

# c# - 如何横向打印订单簿？

> ID：10836917
> 
> 赞同：0
> 
> 时间：2012-05-31T15:45:25.943
> 
> 标签：c#

我不知道更好的地方问，如果这不是纯 C# 问题，我很抱歉。

我需要分析证券交易所订单簿的分时数据。每次订单簿中的更新发生（添加或删除或移动或执行订单）我需要“检查点”新状态并将其与之前的状态进行比较。到目前为止，我只是将数据打印到文本文件，它看起来像这样：

```
5/31/2012 6:06:58 AM:313

3466 1
3464 40
3460 10
3456.9 1
3456 1
3454 1
3448 760
3446 6
3445 3
3444.8 7
3444.5 4
3430.4 6
3420 400
3400 400
3399.9 5
3399.8 2
3396 12
3393.9 1
3390 99
3389.9 14

3387.2 17
3383.7 2
3383.6 2
3376.3 2
3361.1 9
3361 25
3360.8 3
3360.7 3
3360 2
3358 1
3357 3
3356.3 2
3351.1 60
3351 10
3350.6 20
3342.2 3
3342 15
3331.2 180
3331.1 63
3318 3

5/31/2012 6:06:58 AM:359

3466 1
3464 40
3460 10
3456.9 1
3456 1
3454 1
3448 760
3446 6
3445 3
3444.8 7
3444.5 4
3430.4 6
3420 400
3400 400
3399.9 5
3399.8 2
3396 12
3393.9 1
3390 99
3389.9 14

3387.2 17
3383.7 2
3383.6 2
3376.3 2
3361.5 9
3361.4 15
3361.2 9
3361.1 3
3360.8 3
3360.7 3
3360 2
3358 1
3356.3 2
3351.2 11
3351.1 60
3350.6 20
3342.2 3
3342 15
3331.2 180
3331.1 63 
```

但我想看起来像这样：

```
6:06:58 AM:313          6:06:58 AM:359

3466    1               3466    1
3464    40              3464    40
3460    10              3460    10
3456.9  1               3456.9  1
3456    1               3456    1
3454    1               3454    1
3448    760             3448    760
3446    6               3446    6
3445    3               3445    3
3444.8  7               3444.8  7
3444.5  4               3444.5  4
3430.4  6               3430.4  6
3420    400             3420    400
3400    400             3400    400
3399.9  5               3399.9  5
3399.8  2               3399.8  2
3396    12              3396    12
3393.9  1               3393.9  1
3390    99              3390    99
3389.9  14              3389.9  14

3387.2  17              3387.2  17
3383.7  2               3383.7  2
3383.6  2               3383.6  2
3376.3  2               3376.3  2
                 added  3361.5  9
                 added  3361.4  15
3361.1  9               3361.2  9       
                 added  3361.1  3
3361    25     deleted
3360.8  3               3360.8  3
3360.7  3               3360.7  3
3360    2               3360    2
3358    1               3358    1
3357    3      deleted
3356.3  2               3356.3  2
                 added  3351.2  11
3351.1  60              3351.1  60
3351    10     deleted
3350.6  20              3350.6  20
3342.2  3               3342.2  3
3342    15              3342    15
3331.2  180             3331.2  180
3331.1  63              3331.1  63 
```

*   我有多达 1000 个检查点
*   我需要将它们全部打印在一行中，以便轻松比较
*   文本文件包含长度不超过 100 000 的行会不会有问题？
*   如何实现我想要实现的？
*   如果您有更好的建议，我可以比较很多“快照”，欢迎他们！也许我可以使用不同的东西，而不是文本文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T16:42:20.103

这里有一些说明将为您概念化它：

1.  循环遍历文件的每一行
2.  检查每个条目以查看它是否是日期，如果是，则创建某个数据对象的新实例
3.  继续解析，直到到达另一个日期，
4.  将数据对象保存在数据对象列表中
5.  重复步骤 1 到 5，直到完成文件
6.  当您准备好打印时，一次从每个数据对象中写入一个，因此您首先写入所有日期，然后是数据对象字典中的所有第一个项目，依此类推，直到您完成

# iphone - iPhone SDK - 在 UIWebView 中添加“添加到主屏幕”按钮

> ID：10836925
> 
> 赞同：6
> 
> 时间：2012-05-31T15:45:40.157
> 
> 标签：iphone, objective-c, uiwebview

我有一个原生 iPhone 应用程序，它有一个`UIWebView`组件。我正在尝试查看是否可以复制Safari 的标签栏选项中存在的“**添加到主屏幕”按钮。**

这可能在`UIWebView`本机应用程序内吗？

谢谢！布雷特

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T17:52:39.993

[我想你的问题是关于复制与添加到主屏幕相关的操作，而不是复制按钮本身的外观（这是你实际写的迂腐的）。]

正如其他人所说，这是不可能的。

您可以做的是从您的应用程序中以编程方式启动 Safari，并为其提供要加载的页面的 URL，该页面是您的页面。

当您的页面加载时，它会显示某种动画并向用户显示添加到主屏幕按钮的位置，并告诉他们在单击网页中显示的链接后按下它。当用户点击链接时，它会将他们带到您希望保存到桌面的任何页面，并且您希望他们遵循您的指示。

如果您注册您的应用程序以处理专有 url 方案，则用户可以通过单击使用您应用程序的 url 方案的链接从 Safari 中返回您的应用程序。

但是，您为 Safari 提供种子的网页必须是远程页面，您不能在您的应用程序包中为 Safari 提供一个页面，或者您的应用程序已下载，因为 Safari 无法从您的应用程序的沙箱中读取页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T16:38:44.307

简短的回答是不，你不能。苹果不让你。

这是一个类似的问题，它可能会帮助您提出其他可能性： [Javascript for "Add to Home Screen" on iPhone?](https://stackoverflow.com/questions/1141979/javascript-for-add-to-home-screen-on-iphone)

如果我不得不想出一个解决办法，你可以创建一个 javascript 弹出窗口来指导他们如何去做。它可以说是点击此按钮进入移动 Safari，然后点击操作 -> 添加到主屏幕。

使用 UIWebView 的方法执行 Javascript：

```
- (NSString *)stringByEvaluatingJavaScriptFromString:(NSString *)script 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-08T08:20:56.437

您可以将 UIActivityViewController 与您的 url 一起用作活动项

```
NSArray *activityItems = @[title, url]; 
```

然后您可以排除您不想要的活动。我认为这是目前唯一的方法。

# php - 由于 & 在记录中的 w3c 错误

> ID：10836926
> 
> 赞同：-3
> 
> 时间：2012-05-31T15:46:03.840
> 
> 标签：php, html

> **可能重复：**
> [w3c 标记验证器与符号 (&) 错误](https://stackoverflow.com/questions/4441594/w3c-markup-validator-ampersand-error)

我正在从数据库中提取记录以显示，但是当我回显它时，W3C 验证器抱怨记录中有 &。

我在页面上显示良好。我可以做些什么来清理字符串吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T15:47:13.593

大概您看到的错误后面跟着这个解释：

> 在文档中找到实体引用，但没有定义该名称的引用。这通常是由拼写错误的参考名称、未编码的 & 号或遗漏尾随分号 ( `;`) 引起的。此错误的最常见原因是 URL 中未编码的 & 符号，如 WDG 在“URL 中的符号”中所述。
> 
> 实体引用以和号 ( ) 开头，`&`以分号 ( ) 结尾`;`。如果您想在文档中使用文字 & 符号，则必须将其编码为“ `&amp;`”（即使在 URL 中！）。请注意以分号结束实体引用，否则您的实体引用可能会被解释为与以下文本相关。还要记住，命名实体引用是区分大小写的；&Aelig; 和 æ 是不同的字符。

注意该解释并将`&`（意思是“开始一个字符引用”）替换为 `&amp;`（意思是“一个＆符号”）。

PHP 具有将 HTML 中具有特殊含义的所有字符转换为字符引用的功能，只要您想将一些纯文本放入 HTML 文档中，就应该使用这些字符引用。使用它：`htmlspecialchars()`首先。

# android - 滑动删除列表项

> ID：10836927
> 
> 赞同：9
> 
> 时间：2012-05-31T15:46:06.683
> 
> 标签：android, android-layout, android-listview, android-gesture

我想实现一个滑动手势来删除`ListView`类似于 android 通知的行。

现在我所拥有的只是`ListView`一个`onTouchListener`- 也就是说，我已经有了滑动检测工作。

```
gestureDetector = new GestureDetector(this, new GestureListener());
onTouchListener = new TouchListener();  
listview.setOnTouchListener(onTouchListener); 
```

我的`GestureListener`班级：

```
protected class GestureListener extends SimpleOnGestureListener
{
    private static final int SWIPE_MIN_DISTANCE = 150;
    private static final int SWIPE_MAX_OFF_PATH = 100;
    private static final int SWIPE_THRESHOLD_VELOCITY = 100;

    private MotionEvent mLastOnDownEvent = null;

    @Override
    public boolean onDown(MotionEvent e)
    {
        mLastOnDownEvent = e;
        return super.onDown(e);
    }

    @Override
    public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY)
    {
        if(e1 == null){
            e1 = mLastOnDownEvent;
        }
        if(e1==null || e2==null){
            return false;
        }

        float dX = e2.getX() - e1.getX();
        float dY = e1.getY() - e2.getY();

        if (Math.abs(dY) < SWIPE_MAX_OFF_PATH && Math.abs(velocityX) >= SWIPE_THRESHOLD_VELOCITY && Math.abs(dX) >= SWIPE_MIN_DISTANCE ) {
            if (dX > 0) {
                Toast.makeText(getApplicationContext(), "Right Swipe", Toast.LENGTH_SHORT).show();
            } else {
                Toast.makeText(getApplicationContext(), "Left Swipe", Toast.LENGTH_SHORT).show();
            }
            return true;
        }
        else if (Math.abs(dX) < SWIPE_MAX_OFF_PATH && Math.abs(velocityY)>=SWIPE_THRESHOLD_VELOCITY && Math.abs(dY)>=SWIPE_MIN_DISTANCE ) {
            if (dY>0) {
                Toast.makeText(getApplicationContext(), "Up Swipe", Toast.LENGTH_SHORT).show();
            } else {
                Toast.makeText(getApplicationContext(), "Down Swipe", Toast.LENGTH_SHORT).show();
            }
            return true;
        }
        return false;
    }
} 
```

我的`TouchListener`班级：

```
protected class TouchListener implements View.OnTouchListener
{
    @Override
    public boolean onTouch(View v, MotionEvent e)
    {
        if (gestureDetector.onTouchEvent(e)){
            return true;
        }else{
            return false;
        }
    }
} 
```

是否有一些教程/示例？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T16:28:57.367

如果您的滑动检测正常工作，剩下的就是删除该项目。为此，以下代码将删除屏幕外的项目。

```
yourListViewAdapter.yourListItems.remove(position);
yourListViewAdapter.notifyDataSetChanged(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-29T19:17:45.343

您可以通过将其添加到滑动检测来获得很好的效果：

```
 //if swipe to left detected
            Display display = getWindowManager().getDefaultDisplay();
            v.clearAnimation();
            TranslateAnimation translateAnim = new TranslateAnimation(0, -display.getWidth(), 0, 0);
            translateAnim.setDuration(250);
            translateAnim.setAnimationListener(new Animation.AnimationListener() {

                @Override
                public void onAnimationStart(Animation animation) {
                }

                @Override
                public void onAnimationRepeat(Animation animation) {
                }

                @Override
                public void onAnimationEnd(Animation animation) {   
                    yourListViewAdapter.yourListItems.remove(position);
                    yourListViewAdapter.notifyDataSetChanged();
                }
            });
            v.startAnimation(translateAnim); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T08:21:01.547

我想我真的必须在列表中的每一行上实现一个触摸监听器。-> 寻找自定义的 ArrayAdapter

至于投掷物品，我找到了一个很好的教程，可以回答我的大部分问题：http: [//mobile.tutsplus.com/tutorials/android/android-gesture/](http://mobile.tutsplus.com/tutorials/android/android-gesture/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-04T16:50:11.840

在我寻找某种滑动监听器时，我遇到了 Roman Nurik 的 Swipe 代码。[1]：[https ://github.com/romanurik/android-swipetodismiss](https://github.com/romannurik/android-swipetodismiss)

我一直在我的应用程序中使用它，它就像一个魅力！

它的编写方式与实现的侦听器相同，因此我发现它很容易使用。

# android - android - .apk 文件未修改

> ID：10836930
> 
> 赞同：0
> 
> 时间：2012-05-31T15:46:13.963
> 
> 标签：android, android-install-apk

我在未修改此 .apk 文件时使用 eclipse 运行应用程序。假设我在安装时使用了设备中的 .apk 文件，我得到“解析错误：解析包时出现问题”。如何解决这个问题？有谁能够帮我。

为此，我从 bin 文件夹中删除了 .apk 文件，然后使用 eclipse 运行应用程序。通常在这种情况下会生成 .apk 文件。但这里没有生成。但是会生成 .class 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:49:42.460

我在 2 种情况下遇到了这个错误-

1.  当我更改应用程序的包名称时（在这种情况下，卸载旧的并再次运行它）

2.  当您在 < Android 2.2 手机中从 Gmail 安装此 APK 时。

既然您在 Eclipse 中得到了这个，您是否更改了包名称或在 Manifest 中进行了编辑？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:54:07.040

尝试：项目 -> 清理。
或者，尝试：右键单击项目 -> Android 工具 -> 修复项目属性。在同一菜单中，您可以更改包项目。

# c - 键入数组中的变量时实现计数器

> ID：10836934
> 
> 赞同：0
> 
> 时间：2012-05-31T15:46:38.287
> 
> 标签：c, arrays, counter

我修改了我的代码以包含一个计数器，它似乎正在工作，但我不喜欢它的实现方式。它似乎在单词完成之前计算每个字母并输出计数。

```
#include <stdio.h>
#include <ctype.h>
#include <string.h>
int main (int argc, char** argv)
{
char C;
char vowels[]={'a','e','i','o','u'};
int counter=0;
    do
    {
    C = getchar();
    if(memchr(vowels,C, sizeof(vowels)))
        {printf("*\n");
        counter++;
        printf("%i", counter);
        }
    else
        {
        printf("%c",C);
        }

    }while (C!='Q');
} 
```

我希望游戏输入的输出类似于以下内容

```
g*m*
2 
```

我现在得到的只是

```
g*
1m*
2 
```

另外我如何修改代码，以便将大写字母也读为小写？C中有类似isupper或islower的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:51:55.243

如果您希望计数器只打印一次，请将其移到 do-while 循环之外。

```
#include <stdio.h>
#include <ctype.h>
#include <string.h>
int main (int argc, char** argv)
{
    char C;
    char vowels[]={'a','e','i','o','u'};
    int counter=0;
    while(1) {
        C = getchar();
        if(C == 'Q') { break; }
        C = tolower(C);
        if(memchr(vowels,C, sizeof(vowels))) {
            printf("*");
            counter++;
        }
        else
        {
            if(C == '\n') {
               printf("\n%i\n", counter);
               // reset the vowel counter here (dunno what the actual task is)
               counter = 0;
            } else {
               printf("%c",C);
            }
        }
    }

    return 0;
} 
```

# actionscript-3 - 与对象中的项目进行比较

> ID：10836935
> 
> 赞同：0
> 
> 时间：2012-05-31T15:46:46.300
> 
> 标签：actionscript-3

我有以下对象：

```
 var users:Object= new Object();
 users[0]["user_id"] = "1124";
 users[0]["name"] = "ikke";
 users[0]["age"] = "24";
 users[0]["gender"] = "male";

 users[1]["user_id"] = "1318";
 users[1]["name"] = "test";
 users[1]["age"] = "20";
 users[1]["gender"] = "male";

 var selectors:Object = new Object();
 selectors["user_id"] = 1318;
 selectors["gender"] = "male"; 
```

我想要的是`selectors`在 if 语句中使用该对象。在人类语言中，它应该是这样的：

```
for (var index:String in users) {
    If users[index]["gender"] == selectors[gender] && users[index]["user_id"] == "male" -> then trace "success".
} 
```

棘手的部分是选择器对象是动态的。有时它只能包含 1 项，有时 3 项。或者它也可以为空。在这种情况下，它应该总是追踪成功。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:53:42.133

```
for(var i:int = 0; i < users.length; i++) {
    var success:Boolean = true;

    for(var key:String in selectors) {
        if(users[i][key] != selectors[key]) {
             success = false;
             break;
        }
    }

    if(success) {
        trace('success for user ' + i);
    }
} 
```

# visual-studio - 在工作流设计器中从 VB 切换到 C#

> ID：10836936
> 
> 赞同：5
> 
> 时间：2012-05-31T15:46:50.927
> 
> 标签：visual-studio, xaml, workflow-foundation-4, workflow-activity

我正在 Visual Studio 11 Beta 中创建一个活动库（尽管我在 VS2010 中重复了所有步骤，结果相同），目标是 .NET 4.0 框架。

当我开始通过工作流设计器输入参数时，我注意到默认值框中的“*输入 VB 表达式*”消息。我不确定如何将语言上下文从 VB 更改为 C#。

要创建项目，我按照以下步骤操作：

1.  转到**文件**>**新建**并选择**项目...**

2.  在 New Project 对话框窗口的**Installed** > **Templates**部分中，选择**Visual C#** > **Workflow** > **Activity Library**

3.  像往常一样为项目命名，然后单击**确定**

基本上就是这样。然后我注意到默认`Activity1.xaml`文件在默认值字段中需要 VB。我删除了它，然后按照以下步骤创建了一个新活动：

1.  右键单击项目并选择**添加**>**新项目...**

2.  在 Add New Item 对话框窗口中，导航到**Installed** > **Visual C# Items** > **Workflow** > **Activity**

3.  命名活动并单击确定

结果相同，默认值字段需要 VB 表达式。

当我查看 XAML 代码时，我可以清楚地看到`Microsoft.VisualBasic.Activities`列出的命名空间和一个`VisualBasic.Settings`元素，但我不确定如何更改它；每次我尝试，我都会把事情搞砸。这是正在生成的 XAML 代码：

```
<Activity mc:Ignorable="sads sap" x:Class="THINKImport.CustomerAddOrderAdd"
 xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities"
 xmlns:local="clr-namespace:THINKImport.THINKWebReference"
 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
 xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities"
 xmlns:s="clr-namespace:System;assembly=System.Core"
 xmlns:s1="clr-namespace:System;assembly=System"
 xmlns:s2="clr-namespace:System;assembly=System.ServiceModel"
 xmlns:s3="clr-namespace:System;assembly=mscorlib"
 xmlns:sads="http://schemas.microsoft.com/netfx/2010/xaml/activities/debugger"
 xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation"
 xmlns:t="clr-namespace:THINKImport"
 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
<x:Members>
    <x:Property Name="user_login_data" Type="InArgument(local:user_login_data)" />
    <!--Removed the other properties for brevity-->
  </x:Members>
  <sap:VirtualizedContainerService.HintSize>440,440</sap:VirtualizedContainerService.HintSize>
  <mva:VisualBasic.Settings>Assembly references and imported namespaces for internal implementation</mva:VisualBasic.Settings>
</Activity> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T19:47:50.233

我能够弄清楚这个问题。

不过，首先，我能够在[这里](http://msdn.microsoft.com/query/dev11.query?appId=Dev11IDEF1&l=EN-US&k=k%28System.Activities.Presentation.View.ExpressionTextBox.UI%29;k%28TargetFrameworkMoniker-.NETFramework,Version%3Dv4.0%29&rd=true)找到根本原因。简而言之，它说即使程序是 C# 中的，也必须在表达式编辑器中使用 VB.NET。

所以，我对此有点不高兴，但我决定再次破解 XAML 代码，因为在完成 WF 教程时，我在设计器中肯定有一个活动可以接受 C# 中的表达式。我打开了那个项目并浏览了 XAML 代码。

就在那时，我注意到了这一行：

```
<sap2010:ExpressionActivityEditor.ExpressionActivityEditor>C#</sap2010:ExpressionActivityEditor.ExpressionActivityEditor> 
```

我搜索了 MSDN 库并找到[了 ExpressionActivityEditor 类的文档](http://msdn.microsoft.com/en-us/library/hh135717%28v=vs.110%29)。据我所知，这是 .NET 4.5 的新功能。在我的特殊情况下，我没有任何理由不能在我的项目中定位 .NET 4.5，所以我改变了它。解决方案重新打开后，所有表达式编辑器文本字段和框都将立即接受 C#。为了“重新开始”，我删除了我一直在处理的活动文件并创建了一个新文件。如果有人感兴趣，这里是生成的 XAML 代码：

```
<Activity mc:Ignorable="sap sap2010 sads" x:Class="THINKImport.CustomerAddOrderAdd"
      xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:sads="http://schemas.microsoft.com/netfx/2010/xaml/activities/debugger"
      xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation"
      xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation"
      xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:THINKWebReference="clr-namespace:THINKImport.THINKWebReference">
  <x:Members>
  <x:Property Name="user_login_data" Type="InArgument(THINKWebReference:user_login_data)">
    <x:Property.Attributes>
      <RequiredArgumentAttribute />
        </x:Property.Attributes>
    </x:Property>
    <x:Property Name="customer_data" Type="InArgument(THINKWebReference:customer_data)" />
    <!--Remainder of Properties removed for brevity-->
  </x:Members>
  <sap2010:ExpressionActivityEditor.ExpressionActivityEditor>C#</sap2010:ExpressionActivityEditor.ExpressionActivityEditor>
  <TextExpression.NamespacesForImplementation>
    <sco:Collection x:TypeArguments="x:String">
      <x:String>System</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Text</x:String>
    </sco:Collection>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <sap2010:WorkflowViewState.IdRef>
    THINKImport.CustomerAddOrderAdd_1
  </sap2010:WorkflowViewState.IdRef>
  <sap2010:WorkflowViewState.ViewStateManager>
    <sap2010:ViewStateManager>
      <sap2010:ViewStateData Id="THINKImport.CustomerAddOrderAdd_1" sap:VirtualizedContainerService.HintSize="440,440" />
    </sap2010:ViewStateManager>
  </sap2010:WorkflowViewState.ViewStateManager>
</Activity> 
```

所以，有点不同（对我来说，无论如何），但我现在可以使用 C#，所以我很高兴。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-01T01:43:58.270

> ***C# 表达式***
> 
> 以前，工作流中的所有表达式只能用 Visual Basic 编写。在**.NET Framework 4.5** RC 中，Visual Basic 表达式仅用于使用 Visual Basic 创建的项目。Visual C# 项目现在将 C# 用于表达式。提供了一个功能齐全的 C# 表达式编辑器，具有语法突出显示和智能感知等功能。在以前版本中创建的使用 Visual Basic 表达式的 C# 工作流项目将继续工作。
> 
> 从 Beta 1 开始，C# 表达式在设计时进行验证。C# 表达式中的错误将用红色波浪下划线标记。

更多：[.NET 4.5 中 Windows Workflow Foundation 的新增功能](http://msdn.microsoft.com/en-us/library/hh305677%28v=vs.110%29.aspx)

# sql - 在 NOT NULL 字段上设置 name = NULL

> ID：10836944
> 
> 赞同：1
> 
> 时间：2012-05-31T15:47:05.507
> 
> 标签：sql, null

我只是无法弄清楚这是怎么回事，也许你们可以帮助我！

我有一个带有“name NOT NULL”的用户表。

这给了我一个错误。

```
INSERT INTO `user` (name) values (NULL);` 
```

这有效，并将名称设置为`''`.

```
UPDATE `user` SET name=NULL WHERE id = '1' 
```

为什么我可以更新它？为什么当我尝试插入时它没有向我显示相同的错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T16:08:52.140

如果您使用的是 MySQL，这是一个不是错误的错误。 [http://bugs.mysql.com/bug.php?id=33699](http://bugs.mysql.com/bug.php?id=33699) 已修复，然后修复被恢复。

> 此更改已恢复，因为原始报告已确定不是错误：将 NULL 分配给 UPDATE 语句中的 NOT NULL 列应仅在严格 SQL 模式下产生错误，并将该列设置为隐式默认值，否则会发出警告，这是最初的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T15:57:25.077

你不能更新它。如果无法通过 WHERE 语句找到任何匹配项，则只能执行查询。在这种情况下，您没有收到错误，因为查询不会尝试更新任何行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:56:06.833

假设您从一个空表开始，当您尝试插入一个具有空名称的用户并且它给您一个错误时，该表仍然是空的。update 命令不会给你报错，但是因为没有id为1的行，所以没有行被改变。如果您执行以下操作，它应该会给您一个错误：

```
INSERT INTO user (id, name) VALUES (1, "blah")
UPDATE user SET name=NULL WHERE id=1 
```

编辑：啊......在我写答案时你更新了你的问题。在这种情况下，您是否有一个空字符串作为名称列的默认值？它可能正在使用它。

# asp.net - 在自定义事件中丢失 HttpContext

> ID：10836951
> 
> 赞同：0
> 
> 时间：2012-05-31T15:47:26.307
> 
> 标签：asp.net

我在调用以下函数时收到“在此上下文错误中不可用的响应”：

```
Private Sub ReloadPage(ByVal inNumber As Integer) Handles tempaux.Advertise
    'Response.Redirect("tope.aspx?dep=" & CStr(inNumber))
    Response.Write("<script>window.open('tope.aspx?dep= & CStr(inNumber)','topFrame');</script>")
End Sub 
```

我已经更改了在 Response.Write 之前添加 System.Web.HttpContext.Current 的行，我得到“对象引用未设置为对象的实例”。

提供一些背景知识：如您所见，tope.aspx 是在 topframe 中打开的。一旦加载它就会启动我定义的 CustomTimer 对象：

```
Public Class tope
    Inherits System.Web.UI.Page
    Public funciones As funciones = New funciones
    Dim WithEvents tempaux As CustomTimer = Global.objCustomTimer

    Private Sub Page_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Dim inUserProfile As Int64
        Try
            tempaux.StartTimer()
        Catch ex As Exception
            'bla bla
        End Try 
```

如您所见，我已经在 Global.asax 中声明了 CustomTimer。CustomTimer 对象每 5 秒引发一次 Advertise 事件，并将“inNumber”作为参数传递给 tope.aspx 页面以刷新一些标签，这是一件简单的事情。CustomTimer 是我为管理计时器而创建的一个类，它不继承任何其他类（对于我在搜索中学到的内容，它必须继承一些 httpthing 但我不确定）。我猜想在某些时候 httpcontext 正在丢失（我在谷歌中搜索过，我无法弄清楚它的生命周期或任何告诉我为什么它“死掉”的信息）。谁能帮我找出问题所在？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T16:41:18.207

您的计时器存在于顶部页面类之外，因此可能在页面响应完成并且不再存在 HttpContext.Current 实例后触发计时器事件。

听起来您正在尝试做的是在页面加载后每 5 秒更改一次页面上的广告横幅。您需要使用 javascript 计时器来执行此操作，该计时器每 5 秒触发一次，并向您的 Web 服务器发出请求以获取新广告。

# c# - 如何删除数组中的重复值？

> ID：10836956
> 
> 赞同：2
> 
> 时间：2012-05-31T15:47:38.287
> 
> 标签：c#

> **可能重复：**
> [从数组中删除重复项](https://stackoverflow.com/questions/9673/remove-duplicates-from-array)

我有一个 int 数组，其中包含定义数量的元素，都是正数。我想从这个数组中得到一个所有元素只出现一次的数组。例如，如果第一个数组是这样的`{2000,2011,2011,2012,2009,2009,2000}`，我想得到这个`{2000,2011,2012,2009}`。我怎样才能做到这一点？我用 for 循环尝试了很多东西，但我无法做一些好事。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-31T15:50:38.583

使用 LINQ 很容易：

```
var intArray = new[] { 2000, 2011, 2011, 2012, 2009, 2009, 2000 };
var uniqueArray = intArray.Distinct().ToArray(); 
```

[http://msdn.microsoft.com/en-us/library/system.linq.enumerable.distinct.aspx](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.distinct.aspx)

另一种方法是使用[Enumerable.GroupBy](http://msdn.microsoft.com/en-us/library/bb534304.aspx)：

```
uniqueArray = intArray.GroupBy(i => i).Select(grp => grp.Key).ToArray(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-31T15:49:23.437

您可以执行以下操作

```
var yourArray = yourArray.Distinct().ToArray(); 
```

[http://msdn.microsoft.com/en-us/library/system.linq.enumerable.distinct.aspx](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.distinct.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T16:01:54.877

替代方式：

```
 int[] _array = new int[] {1, 2, 1,2}
    var myArray = new System.Collections.ArrayList();

    foreach(var item in _array){
        if (!myArray.Contains(item))
            myArray.Add(item);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T15:53:04.547

除了其他答案之外，您可能还想查看 a [`HashSet`](http://msdn.microsoft.com/en-us/library/bb359438.aspx)，特别是如果您提前知道您将有重复的值。

# java - 在计算中使用 Spinner 值

> ID：10836960
> 
> 赞同：0
> 
> 时间：2012-05-31T15:47:48.460
> 
> 标签：java, android

想知道我是否可以得到一些帮助来解决我遇到的问题？我已经在这里搜索了答案，虽然我找到了一些相关的主题，但我仍然非常挣扎......

您可以在下面看到我正在使用 Spinner，要求用户选择大、中或小。

然后将选择发送给 TextView。

我现在要做的是为 3 个选项分配一个值，大 = 6，中 = 4，小 = 2。接下来会有一个 EditText 框供用户添加自己的值。然后我想把这两个值放到一个计算中（在这个例子中说*它们）把答案放到一个TextView中。

这里的任何帮助都会很棒。

非常感谢会

```
String[] items = { "Large", "Med", "Small" };

@Override
public void onCreate(Bundle icicle) {
    super.onCreate(icicle);
    setContentView(R.layout.plugfan);
    Factor = (TextView) findViewById(R.id.Factor);

    Spinner spin = (Spinner) findViewById(R.id.spinner);
    spin.setOnItemSelectedListener(this);

    ArrayAdapter aa = new ArrayAdapter(
            this,
            android.R.layout.simple_spinner_item, 
            items);

    aa.setDropDownViewResource(
       android.R.layout.simple_spinner_dropdown_item);
    spin.setAdapter(aa);
}

public void onItemSelected(AdapterView<?> parent, View v, int position,
        long id) {
    Factor.setText(items[position]);
}

public void onNothingSelected(AdapterView<?> parent) {
    Factor.setText("");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T15:52:44.590

解决此问题的一种快速方法（不是最聪明的方法）是使用并行数组：

```
int[] itemValues = { 6, 4, 2 }; 
```

在 onItmeSelected 方法中，您可以使用 itemValue 而不是项目来设置文本。

如果您想要更多 OO 解决方案，则返回字符串列表以用作微调器模型的新类可能是更好的解决方案（枚举也可以解决它）。

# ios - 通过 GraphAPI 仅在页面上获取 Facebook 朋友发布的帖子

> ID：10836965
> 
> 赞同：0
> 
> 时间：2012-05-31T15:47:54.540
> 
> 标签：ios, facebook-graph-api

**tl; dr：是否有某种方法可以检索页面上的帖子，但仅限于经过身份验证的用户的朋友发布的帖子？**

我正在开发一个 iOS 应用程序，我可以使用 GraphAPI 方法检索在页面上发布的所有帖子，`[facebook requestWithGraphPath:@"pageID/feed" andDelegate:self];`还可以使用以下方法检索当前经过身份验证的用户的朋友列表`[facebook requestWithGraphPath:@"me/friends" andDelegate:self];`

有没有办法过滤第​​一个数据集以获取仅由第二个数据集服务器端（即：通过 GraphAPI）中的 ids 提交的数据，还是我最好的选择客户端（我的代码）过滤结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T16:27:49.250

您可以使用[FQL](https://developers.facebook.com/docs/reference/fql/)通过一个非常简单的查询来完成此操作：

`SELECT post_id FROM stream WHERE source_id = PAGEID AND actor_id IN (SELECT uid2 FROM friend WHERE uid1 = me())`

括号中的查询的第二部分是选择当前用户朋友的用户 ID 列表（由用于查询的访问令牌确定），然后此 UID 列表用于过滤选择列表的查询的第一部分发布到特定页面 ID 的 post_ids（确保将占位符替换为您自己的页面 ID）。

这将为您提供一个帖子 ID 列表，但是[流表文档](https://developers.facebook.com/docs/reference/fql/stream/)将向您显示更多您可以选择的字段。

请注意，FQL 可能被视为与 Graph API 分开的 API，但实际上它可以非常简单地通过 Graph API 运行，如[本博](https://developers.facebook.com/blog/post/579/)文所示。

# xna - ScissorRectange 和 ScaleMatrix

> ID：10836968
> 
> 赞同：0
> 
> 时间：2012-05-31T15:48:00.130
> 
> 标签：xna

我已经完成了打开 ScissorTestEnable 和 ScissorRectangle 的示例。它工作正常。但是，当我应用 ScaleMatrix 时，剪辑似乎不再起作用。这些应该一起工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T16:15:36.220

您可能正在使用 SpriteBatch，对吗？在我看来，Shawn Hargreaves[在此页面上的评论](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.graphics.graphicsdevice.scissorrectangle.aspx)可能就是您正在寻找的答案。您是否尝试过移动设置剪刀矩形的调用以查看它是否开始工作？我尝试查看 Microsoft.Xna.Framework.Graphics 的反编译源 - 但我找不到 GraphicsDevice.set_ScissorRectangle 和 SpriteBatch 的刷新方法之间的任何关系。:S

如果它不起作用，您还可以尝试用修改后的投影和视口调用替换比例和剪刀，然后在每个玩家的屏幕上渲染对象。

# c# - 将 vb6 类型转换为 VB.net 或 C# Struct

> ID：10836973
> 
> 赞同：4
> 
> 时间：2012-05-31T15:48:12.667
> 
> 标签：c#, .net, vb.net, vb6

我正在将最初用 vb6 编写的应用程序转换为 vb.net。该应用程序所做的其中一件事是将“类型”对象发送到 dll。我尝试将类型转换为结构并 p/调用 dll，但它似乎不起作用。我被困了一个星期，任何帮助将不胜感激

这是该类型的 vb6 代码

```
'Define WICS Communications Control Block (CCB).
Type WicsCCBType ' Create user-defined type.
    CCBNum As String * 1
    CCBVer As String * 1
    Resp1  As String * 4
    Resp2  As String * 4
    PLUA   As String * 8
    LLUA   As String * 8
    Mode   As String * 8
    ReqMax As String * 5
    ResMax As String * 5
End Type 
```

这是调用 dll 的方式

```
Private Declare Sub WICSRASP Lib "wicsrasp.dll" (MyWicsCCB As WicsCCBType)
WICSRASP MyWicsCCB 
```

这是我用 vb.net 尝试过的，但它不起作用

```
'Define WICS Communications Control Block (CCB).
    <System.Runtime.InteropServices.StructLayoutAttribute( _
            System.Runtime.InteropServices.LayoutKind.Sequential, _
            CharSet:=System.Runtime.InteropServices.CharSet.[Unicode])> _
    Structure WicsCCBType ' Create user-defined type.
        <MarshalAs(UnmanagedType.ByValTStr, sizeconst:=1)> Dim CCBNum As String
        <MarshalAs(UnmanagedType.ByValTStr, sizeconst:=1)> Dim CCBVer As String
        <MarshalAs(UnmanagedType.ByValTStr, sizeconst:=4)> Dim Resp1 As String
        <MarshalAs(UnmanagedType.ByValTStr, sizeconst:=4)> Dim Resp2 As String
        <MarshalAs(UnmanagedType.ByValTStr, sizeconst:=8)> Dim PLUA As String
        <MarshalAs(UnmanagedType.ByValTStr, sizeconst:=8)> Dim LLUA As String
        <MarshalAs(UnmanagedType.ByValTStr, sizeconst:=8)> Dim Mode As String
        <MarshalAs(UnmanagedType.ByValTStr, sizeconst:=5)> Dim ReqMax As String
        <MarshalAs(UnmanagedType.ByValTStr, sizeconst:=5)> Dim ResMax As String
    End Structure 
```

这是我试图称呼它的地方

```
<System.Runtime.InteropServices.DllImportAttribute("C:\windows\system32\wicsrasp.dll")> _
    Public Shared Sub WICSRASP(
                    ByRef CCB As WicsCCBType,
                    ByRef Request As DAWicsRequestType,
                    ByRef Response As DAWicsResponseType)
    End Sub

 Dim CCB As New modWICSDiary.WicsCCBType()
 CCB.CCBNum = "B"
            CCB.CCBVer = "2"
            CCB.LLUA = "        "
            CCB.Mode = "CICSMO2 "
            CCB.ReqMax = "2100 "
            CCB.ResMax = "2100 "
            CCB.Resp1 = "0   "
            CCB.Resp2 = "0   "
            CCB.PLUA = "WICSPLU "

  NativeMethods.WICSRASP(CCB) 
```

至于值，相同的值适用于 vb6 类型

再次提前谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T17:04:57.950

VB6 会将所有这些字符串元素“编组”为 ANSI 字符串。相应地更改 Vb.Net 编组代码。

*   试试`UnmanagedType.LPStr`那些`MarshalAs`属性？
*   尝试将 CharSet 从 Unicode 更改为 Ansi？
*   在? `Pack=4`_`StructLayoutAttribute`

有用的链接，解释了 VB6 所做的假设[`Declare`](http://vb.mvps.org/tips/vb5dll.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T12:57:43.643

我不知道OP是否已经解决了这个问题，但这是我的看法。

VB6 中 UDT 内的固定长度字符串不作为指针编组，而是内联到结构中。此外，VB6 在编组之前将 Unicode 转换为 Ansi。而VB6使用4字节对齐。

该类型将在内存中使用填充看起来这个，每个连续的字段在插图中被命名为 A 到 I，并且由于对齐，_ 是一个填充字节。

```
CCBNum As String * 1     
|
|+-CCBVer As String * 1     
||
||  Resp1  As String * 4
||  |
||  |   Resp2  As String * 4     
||  |   |
||  |   |   PLUA   As String * 8     
||  |   |   |
||  |   |   |       LLUA   As String * 8     
||  |   |   |       |
||  |   |   |       |       Mode   As String * 8     
||  |   |   |       |       |
||  |   |   |       |       |       ReqMax As String * 5     
||  |   |   |       |       |       |
||  |   |   |       |       |       |       ResMax As String * 5 
||  |   |   |       |       |       |       |
||  |   |   |       |       |       |       |
VV  V   V   V       V       V       V       V

AB__CCCCDDDDEEEEEEEEFFFFFFFFGGGGGGGGHHHHH___IIIII___ 
```

因此 CharSet 应该是 Ansi，StructAlignment 应该是 4。使用 ByValTString 很好，使用 SizeConst 也是如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T07:27:21.897

VB6 使用了 BSTR，不是吗？你不应该编组为 BSTR 吗？

# iphone - 视图控制器的dealloc没有被调用？

> ID：10836975
> 
> 赞同：-1
> 
> 时间：2012-05-31T15:48:16.290
> 
> 标签：iphone, viewcontroller, dealloc

我不知道为什么 viewcontroller 的 dealloc 没有调用

请查看代码片段。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [tableView deselectRowAtIndexPath:indexPath animated:YES];

    SaleItemsVC *itemsObj = [[SaleItemsVC alloc] initWithNibName:@"SaleItemsVC" bundle:nil];
    [self.navigationController pushViewController:itemsObj animated:YES];

    EventSingleEntity *entityobj=(EventSingleEntity*)[arrSales objectAtIndex:indexPath.row];

    itemsObj.eveintEntityRef=entityobj;
    [itemsObj loadProductsOfEventId:entityobj.event_id];
    itemsObj.EventTitle.text=entityobj.name;
    itemsObj.EventEndDate.text=entityobj.end;
    SalesCell *cell=(SalesCell*)[tableView cellForRowAtIndexPath:indexPath];
    itemsObj.eventImage=cell.imgCenter.image;
    [itemsObj release];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T15:52:20.627

你创建了 itemsObj，控制器，所以 ref count == 1

您将 itemsObj 推送到 self.navigationController, refcount == 2

你释放 itemsObj ref count == 1

在 self.navigationController 释放它之前，它不应该被释放。

# c# - 如何使用泛型按类型创建类的实例

> ID：10836977
> 
> 赞同：0
> 
> 时间：2012-05-31T15:48:18.447
> 
> 标签：c#, generics, tdd, datacontext

我在使用泛型按类型创建类的新实例时遇到问题。我想要做的是拥有一个可以使用 DBSet<> 或 FakeDBSet<> 创建的数据库上下文。FakeDBSet 将用于测试代码。我目前有一个完整的假数据上下文，但这是一种浪费，因为唯一真正的区别是使用的 DBSet。我已经研究过使用 Activator.CreateInstance() 没有太多运气。

例子：

```
public class Album {}
public class Artist {}

public class MusicStoreContext
{
    public IDbSet<Album> Albums { get; set; }
    public IDbSet<Artist> Artists { get; set; }

    public MusicStoreContext(Type dbSetType)
    {
        Albums = new (dbSetType)<Album>;
        Artists = new (dbSetType)<Artist>;
    }

}

public class Startup
{
    public Startup()
    {
        // Production code would do something like this:
        MusicStoreContext context = new MusicStoreContext(typeof(DbSet<>));

        // Test code would do something like this:
        MusicStoreContext testContext = new MusicStoreContext(typeof(FakeDbSet<>));
    }
} 
```

我也尝试过这样的事情：

```
public class MusicStoreContext<T> where T : IDBSet
{
    public IDbSet<Album> Albums { get; set; }
    public IDbSet<Artist> Artists { get; set; }
    ... 
```

由于乔恩的建议，这是我想出的有效方法：

```
public class MusicStoreContext
{
    private IDbSet<Album> _Albums;
    private IDbSet<Artist> _Artists;

    public IDbSet<Album> Albums { get {return _Albums;} }
    public IDbSet<Artist> Artists { get {return _Artists; }

    public MusicStoreContext(Type dbSetType)
    {
        Albums = new (dbSetType)<Album>;
        Artists = new (dbSetType)<Artist>;
    }

    public TaxDocumentsContext() : base() 
    {
        CreateDbSets(new ProductionDbSetProvider());
    }

    public TaxDocumentsContext(IDbSetProvider provider)
    {
        CreateDbSets(provider);
    }

    private void CreateDbSets(IDbSetProvider provider)
    {
        provider.CreateDbSet<Album>(this, ref _Albums);
        provider.CreateDbSet<Artist>(this, ref _Artists);
    }

} 
```

对于 DbSetProvider：

```
public interface IDbSetProvider
{
    void CreateDbSet<T>(DbContext context, ref IDbSet<T> dbSet) where T : class;
}

public class FakeDbSetProvider : IDbSetProvider
{
    public void CreateDbSet<T>(DbContext context, ref IDbSet<T> dbSet) where T : class
    {
        dbSet = new FakeDbSet<T>();
    }

}

public class ProductionDbSetProvider : IDbSetProvider
{
    public void CreateDbSet<T>(DbContext context, ref IDbSet<T> dbSet) where T : class
    {
        dbSet = context.Set<T>();
    }
} 
```

现在我可以轻松地测试，而无需使用 FakeDbSet 从此处访问数据库： [http ://refactorthis.wordpress.com/2011/05/31/mock-faking-dbcontext-in-entity-framework-4-1-with -a-通用存储库/](http://refactorthis.wordpress.com/2011/05/31/mock-faking-dbcontext-in-entity-framework-4-1-with-a-generic-repository/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T15:52:47.067

编辑：如果有问题的集合有适当的构造函数，您可以使用[`Type.MakeGenericType`](http://msdn.microsoft.com/en-us/library/system.type.makegenerictype.aspx)创建相关的构造类型并使用以下方法调用构造函数`Activator.CreateInstance`：

```
Type albumType = dbSetType.MakeGenericType(typeof(Album));
Albums = (IDbSet<Album>) Activator.CreateInstance(albumType); 
```

或者，您可以传入`DbSetProvider`具有通用方法的（或其他）：

```
public IDbSet<T> CreateDbSet<T>() 
```

那么你会有 a`ProductionDbSetProvider`和 a `FakeDbSetProvider`：

```
public MusicStoreContext(DbSetProvider provider)
{
    Albums = provider.CreateDbSet<Album>();
    Artists = provider.CreateDbSet<Artist>();
} 
```

就我个人而言，这对我来说感觉更干净，但是 YMMV。

# android - 即使在获得位置后，GPS 也一直在工作

> ID：10836978
> 
> 赞同：2
> 
> 时间：2012-05-31T15:48:18.843
> 
> 标签：android, geolocation, gps, locationlistener

我正在开发一个使用 gps 的应用程序，该应用程序在应用程序投入使用之前一直运行。我的 GPS 会在 5 分钟后唤醒并获取位置，然后其符号停止闪烁并在几乎所有设备（Sony xperia、Samsung tab、Htc WildFire、Motorola photon）中不可见，但在 Motorola Defy 和 Samsung Ace 中不可见，它们会消耗大量电池电量. GPS得到修复并始终保持稳定和可见。这些设备（Moto Defy 和三星 Ace）的 GPS 工作方式不同。看我的代码：

```
long _listenerWakeUpTimeInterval=1000*60*5;**  //5 minutes
_locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, _listenerWakeUpTimeInterval, 300, locationListener); 
```

所有设备的 GPS 都会在 5 分钟后唤醒，但这两款设备（Moto Defy 和三星 Ace）的 GPS`onLocationChanged(Location loc)`每 300 米调用一次该方法。对于这两种设备来说，时间并不重要。当我快速旅行（在汽车中）时，这个距离在几分钟（1 或 2 分钟）内即可完成。所以我接到了一个关于`onLocationChanged(Location loc)`方法的电话。在这些设备中，GPS 始终是固定的、静态的和可见的。我不想`locationManager.removesupdates`每次 GPS 得到修复时都调用方法。我只在`onDestroy()`服务中调用此方法。那么请告诉为什么这两个设备的 GPS 与其他设备的行为不同，以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T16:03:09.250

如果您阅读[文档](http://developer.android.com/reference/android/location/LocationManager.html#requestLocationUpdates%28java.lang.String,%20long,%20float,%20android.location.LocationListener%29)，它会说：

> *minTime：通知的最小时间间隔，以毫秒为单位。此字段仅用作节省电量的提示，位置更新之间的实际时间可能大于或小于此值。*

所以这只是一个建议，实现可以忽略它。

我的建议是使用`AlertManager`每 5 分钟安排一次服务，然后在服务有效负载中，请求单个修复调用`requestSingleUpdate`。这将节省电池。缺点是 GPS 芯片需要一些时间才能接收到卫星信号，在良好条件下大约需要 30 秒到 1 分钟（首次定位时间，或 TTFF）。在处理完所有待处理的请求后，它又变冷了。所以在下一次服务执行中，我猜 TTFF 可能会和上一次迭代一样高。（除非你使用 NETWORK_PROVIDER，但那样精度会更低）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T05:18:37.787

我得到了这个问题的解决方案。我使用`AlarmManager`（每 5 分钟后重复警报）注册 gps，然后我运行我的 Gps 30 秒并取消注册 Gps。如果我接到电话，`onLocationChanged(Location loc)`那么我在这个方法中取消注册 Gps。否则（如果我没有得到新的位置）我在 30 秒后通过处理程序取消注册 Gps。当我再次需要 Gps 时，我遵循相同的过程。通过这种方式，我的 Gps 最多工作 30 秒，而不是整个时间，直到服务运行。

# java - 分词特征值 Java (JAMA)

> ID：10836981
> 
> 赞同：0
> 
> 时间：2012-05-31T15:48:55.573
> 
> 标签：java, matlab, linear-algebra, jama

我刚刚将我的代码从 MATLAB 移植到 Java，我需要矩阵的特征分解，特别是我只需要第一个`k`值而不是完整分解。

然而在[JAMA](http://math.nist.gov/javanumerics/jama/doc/)中，特征分解类计算完整的特征分解。我试图修改它，但它会引发一些错误。还有其他类似的库吗？

在 MATLAB 中，有问题的函数是`eigs(k,A)`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T16:03:14.787

所以它只是返回所有特征值的数组。您想返回一个仅包含数组的前 k 个值的数组。在 Java 中有很多方法可以做到这一点。一种是将数组转换为 ArrayList，获取该列表的子列表，然后再转换回数组。

```
double[] mySubArray = new double[k];
for (int i=0; i < k; i++) {
        subArray[i] = myFullArray[i];
    } 
```

顺便说一句，这是他所指的图书馆：http: [//math.nist.gov/javanumerics/jama/doc/](http://math.nist.gov/javanumerics/jama/doc/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T19:35:13.033

如果你找不到任何现有的代码，我想你应该参考这篇[论文](http://www.ecse.rpi.edu/~rjradke/papers/radkemathesis.pdf)或者这篇[论文](http://www.mathworks.com/help/pdf_doc/otherdocs/sorensen.pdf)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-01T10:24:26.347

[也许您可以在http://commons.apache.org/proper/commons-math/javadocs/api-3.6/org/apache/commons/math3/linear/EigenDecomposition.html](http://commons.apache.org/proper/commons-math/javadocs/api-3.6/org/apache/commons/math3/linear/EigenDecomposition.html)中尝试另一个名为 EigenDecomposition 的包，有一些方法如`getImagEigenvalue(int i)`，你可以`i`通过这个得到 -th 特征值。

# asp.net-mvc - 为什么 PartialView 接受动态类型参数

> ID：10836987
> 
> 赞同：0
> 
> 时间：2012-05-31T15:49:27.930
> 
> 标签：asp.net-mvc, asp.net-mvc-partialview

我正在学习 MVC，我想了解为什么 PartialViews 是这样定义的：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<dynamic>" %> 
```

它接受动态作为类型参数。这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T16:11:20.977

不仅局部视图可以将动态作为模型，视图也可以这样做。为什么？因为动态表示一种类型。但是只有在运行时才能知道究竟是什么类型。将其用作视图模型允许拥有非强类型视图。另一种使视图非强类型化的方法是通过 ViewBag 对象将数据传递给它。

# java - 先进先出代码说明

> ID：10836993
> 
> 赞同：0
> 
> 时间：2012-05-31T15:50:00.597
> 
> 标签：java

以下代码是 FIFO 排序的示例吗？

问题在于实现一个 FIFO 队列。

简而言之：随机数量的汽车（向北或向南行驶）沿着两条车道行驶。他们必须穿过一座桥，这是一种方式。

桥梁访问取决于到达时间。先到先得。

我可以通过这个声明说

```
semaphore = new Semaphore(capacita,true); 
```

汽车按照到达顺序过桥？

在这里我无法弄清楚它是如何工作的，以及它如何与前面的语句相关联

```
lock = new ReentrantLock(true); 
```

有人能帮我吗？

谢谢

```
public Ponte(int capacita){
        nNordTraversing = 0;    
        nSudTraversing = 0;     
        nNordWaiting = 0;   
        nSudWaiting = 0;    

        semaphore = new Semaphore(capacita,true); 

        lock = new ReentrantLock(true);           

        waitingCond = lock.newCondition();
        bridgeCond = lock.newCondition();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T16:03:12.457

你的代码很奇怪，我不理解这部分。你可以很容易地在互联网上找到一个正确的算法来解决这个问题。

例如：[http](http://cboard.cprogramming.com/c-programming/119766-semaphore-algorithm.html) ://cboard.cprogramming.com/c-programming/119766-semaphore-algorithm.html 这个问题看起来像你的！祝您搜索顺利！

# python - 在 Python JSON 中编码 Javascript 变量名

> ID：10836994
> 
> 赞同：1
> 
> 时间：2012-05-31T15:50:03.043
> 
> 标签：python, json

我正在编写一个生成 JSON 并将其输出到文件的程序。我输出到文件的第一个内容是以下 JSON 字符串：

```
var jsonStyle = {'color': '#004070',
    'weight': 2,
    'opacity': 0.9} 
```

然后我使用 Python JSON 库生成 JSON 输出。这是我传入的 Python 对象`json.dumps`：

```
js = {'type': 'Feature',
      'properties':
          {'style': 'jsonStyle'},
      'geometry': geomJSON} 
```

我想要的文本输出是：

```
js = {'type': 'Feature',
      'properties':
          {'style': jsonStyle},
      'geometry': geomJSON} 
```

这样，我可以`jsonStyle`在输出文件的顶部进行编辑，以更改所有后续 JSON 元素的样式。问题是，我构建 JSON 对象输出的当前方式`'jsonStyle'`，它是一个字符串，而不是 Javascript 变量名。如果我将样式键设置为我输出的样式字符串的字典版本，它将包含每个后续 JSON 元素的 JSON 对象。当我在 Python 中编码时，我不知道如何让`style`引用 Javascript 变量名。

我宁愿不必为此进行字符串操作，但我可以依靠它。

## 编辑：

我想我实际上并没有使用 JSON。我将它们作为变量输出到 Javascript 文件，以便我可以将它们作为 JSON 对象包含在另一个 Javascript 文件中。看起来我要么需要使用 YAML，要么只进行某种字符串编辑并放弃严格的 JSON 编码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T16:13:42.600

如何使用发送第一个 jsonStyle JSON `json.dumps`？更改变量`jsonStylePyObject`，它会反映在所有进一步的 JSON 中。如下所示：

```
jsonStylePyObject = {'color': '#004070',
    'weight': 2,
    'opacity': 0.9}
myFile.write(json.dumps(jsonStyle))

#then use it normally
js = {'type': 'Feature',
      'properties':
          {'style': jsonStylePyObj},
      'geometry': geomJSON}
myFile.write(json.dumps(jsonStr)) 
```

或者您可以使用字符串替换。这实际上很**糟糕**，并不是真正建议的。您可以在字段中有一个唯一的字符串，`style`例如 `"MY_UNIQUE_STRING$#!@#" 并对其进行字符串替换。就像是：

```
jsonStr = json.dumps({'type': 'Feature',
          'properties':
              {'style': "MY_UNIQUE_STRING$#!@#"},
          'geometry': geomJSON})
quotes_char = "\'"
jsonStr = jsonStr.replace("%sMY_UNIQUE_STRING$#!@#%s"%(quotes_char, quotes_char), "jsonStyle")
myFile.write(jsonStr) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T16:13:47.723

您要编写的格式[不是 JSON](http://www.json.org/)。该格式非常具体地说明什么可以是 json 对象中的值，并且它没有 javascript 变量的概念。您要编写的是 javascript，而不是 JSON - 这不一样。

因此，您可以简单地尝试删除特殊变量周围的引号，或者编写自己的序列化程序。

# matlab - 如何在matlab中创建一个空数组？

> ID：10836998
> 
> 赞同：2
> 
> 时间：2012-05-31T15:50:10.923
> 
> 标签：matlab

我正在尝试初始化一个空数组，它本身包含 5 个空数组。但是 matlab 似乎只是创建了一个简单的空数组变量。以下是我尝试过的两种语法。如果在matlab中可能有什么想法吗？

```
bins = [ []; []; []; []; []  ];

bins = repmat([], 5, 1) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T16:06:59.990

`deal`对于这样的分配是一个很好的功能：

```
[bins{1:5}] = deal([]); 
```

这将创建一个元胞数组`bins`，其中每个元素都`bins{i}`包含一个空数组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T15:54:22.167

MATLAB 只有矩阵，即（可能是多维的）数值类型（或字符或逻辑值）数组。要将其他结构分组到一个变量中，请尝试使用[元胞数组](http://www.mathworks.de/help/techdoc/ref/cell.html)，例如

```
bins = { []; []; []; []; []  }; 
```

然后，您必须使用大括号访问外部数组的元素，例如，`bins{2}`而不是`bins(2)`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T00:48:47.540

初始化它的另一个技巧：

```
>> bins = {}      %# just to make sure `bins` wasn't used before
>> bins{5} = []
bins = 
    []    []    []    []    [] 
```

# playframework - 调用 notFound() 时不呈现 404 和 500 错误视图（404.html 和 505.html）

> ID：10836999
> 
> 赞同：1
> 
> 时间：2012-05-31T15:50:12.740
> 
> 标签：playframework, playframework-1.x

我已将其范围缩小到添加路线时：

/{userid} 应用程序.blah

在函数（Application.blah）中，我认为我使用 notFoundIfNull(user) 处理了它

我的问题是，每当我在网站中输入随机 URL 时，我只会在生产环境中返回“未找到”文本，而不是呈现的 404.html 页面

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T00:42:01.313

嗯，在 controllers.Application.java 中使用这个：

```
public static void blah (String userid)
{
    User test=null;
    try{
        test = User.findById(userid);
    } catch(Exception e)
    {
        //lookup exception!
    }
    notFoundIfNull(test);
} 
```

我的 route.conf 包含以下内容：

```
GET     /{userid}           Application.blah 
```

我能够查看包含以下内容的 /apps/views/errors/404.html ：

```
#{if !play.mode.name() == 'DEV'}
  ...insert production 404 here...
#{/if} 
```

如果您的格式与此匹配，那么问题可能与您在生产 404 中调用的内容有关。在我的 403 页面中，我发现如果我调用 ${response.reason}，它会将整个页面呈现为我的 403 响应为这里提到：[如何获得禁止（）的“原因”？](https://stackoverflow.com/questions/12630672/how-do-i-obtain-the-reason-for-a-forbidden). 祝你好运！