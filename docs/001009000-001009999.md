# StackOverflow 问答 1009000-1009999

# java - 包装类的 Junit 测试用例

> ID：1009001
> 
> 赞同：3
> 
> 时间：2009-06-17T19:12:50.977
> 
> 标签：java, junit, spring

我有一个 Java 类，它只是扩展了一个库类并使用默认参数调用其父类的方法。我该如何为此编写Junit测试？MockObjectTestCase 也很好。这是我正在谈论的一个例子：

```
public class ResourceBundleMessageSource {
   public String getMessage(String key, Object[] objects, Locale locale) {
      //Spring library method
   } 
}

public class MessageResource extends ResourceBundleMessageSource {
   public String getMessage(String key) {
      return (getMessage(key, null, Locale.getDefault());
   }
} 
```

我知道包装器方法甚至不是必需的，但可以更轻松地频繁调用它。请注意，该类工作正常，我只对单元测试的编写方式感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T03:22:22.253

如果您愿意稍微重构您的类，我建议您`MessageResource`委托`MessageSource`实例，而不是扩展`ResourceBundleMessageSource`。然后我会在我的单元测试中使用模拟。像这样的东西：

```
public class MessageResource implements MessageSource {

  private final MessageSource delegate;

  public MessageResource(MessageSource delegate) {
    this.delegate = delegate;
  }

  public String getMessage(String key) {
    return delegate.getMessage(key, null, Locale.getDefault());
  }

  // need to implement three other MessageSource methods, 
  // simple pass-throughs to delegate

} 
```

和单元测试

```
public class MessageResourceTest {

  private MessageSource mockDelegate;
  private MessageResource messageResource;

  @Before
  public void setUp() throws Exception {
    mockDelegate = //mock with your favorite framework, or by hand
    messageResource = new MessageResource(mockDelegate);
  }

  @Test
  public void testGetMessage() {
    String key = "foo";

    String actualMessage = messageResource.getMessage(key);

    assertEquals(key, /* get key passed to mock delegate */ );
    assertSame(Locale.getDefault(), /* get Locale passed to mock delegate */);
    assertEquals(/*expected message from mock*/, actualMessage);
  }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T21:24:51.430

对于这个特殊的例子，我可能不会费心去测试它。

如果您确实需要对其进行测试，请尝试以下操作：

```
@Test
public void getDefaultMessage() {
  ResourceBundleMessageSource origSource = <create source>
  MessageResource subSource = <create with same criteria as origSource>
  String key = <some key that is locale-specific>
  assertEquals(origSource.getMessage(key, null, Locale.getDefault()),
               subSource.getMessage(key));
} 
```

如果前两行很难写，那么不测试它就更有意义了。如果您有多个这样的测试，请将前两行移动到设置夹具中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T19:29:50.383

我认为甚至不值得为此编写单元测试。如果已经对 ResourceBundleMessageSource.getMessage() 进行了测试，那应该就足够了。

# sharepoint - 在没有 GUI 的情况下将文件添加到 WSS 3.0 文档库

> ID：1009004
> 
> 赞同：1
> 
> 时间：2009-06-17T19:13:30.213
> 
> 标签：sharepoint

好的，我是使用 SHarePoint Services 的新手，并且遇到了一个我正在努力克服的问题。在我工作的地方，我实现了一个 Crystal 报表调度程序，它将报表输出到一个共享文件夹。我现在想要完成的是找到一种方法，可以将调度程序的输出指向文档库。我希望我能像任何其他共享文件夹一样找到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T19:16:45.527

1.  在您的主机共享点上，打开 WebClient 服务。

2.  转到您要上传到的库，下拉操作-> 在 Windows 资源管理器中打开

3.  您看到的路径可以转换为 UNC 路径，您可以像使用任何其他共享文件夹一样使用它。

    *   要进行转换，它应该看起来像 \\servername\Shared Documents

    *   这个 unc 可以像任何其他物理联网文件夹一样映射为共享文件夹。
4.  上传快乐！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T07:21:48.500

如果您想在代码中上传文件（而不是手动）而不安装 WebDAV 共享，您还可以将其 HTTP-PUT 到所需的 URL，例如[http://myserver/sites/mysite/mysubsite/mylist/myfolder/ foo.doc](http://myserver/sites/mysite/mysubsite/mylist/myfolder/foo.doc)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-01T12:46:43.437

试试这个问题中的代码：[Uploading files to Sharepoint (WSS 3.0) document library using HTTP PUT](https://stackoverflow.com/questions/596315/uploading-files-to-sharepoint-wss-3-0-document-library-using-http-put)

使用此答案中的提示：[使用 HTTP PUT 将文件上传到 Sharepoint (WSS 3.0) 文档库](https://stackoverflow.com/questions/596315/uploading-files-to-sharepoint-wss-3-0-document-library-using-http-put/2663918#2663918)。

# php - Zend 组织问题

> ID：1009007
> 
> 赞同：2
> 
> 时间：2009-06-17T19:13:48.090
> 
> 标签：php, zend-framework, layout, organization

所以我有一个关于 Zend 框架在布局方面的一般代码组织的问题。

我的布局基本上是这样的：

```
(LAYOUT.PHTML)

<div id='header'>
<?= $this->Layout()->header ?>
</div>

<div id='main'>
<?= $this->Layout()->main ?>
</div>

<div id='footer'>
<?= $this->Layout()->footer ?>
</div> 
```

等等等等。现在，为了使页眉中的代码与主代码和页脚代码分开，我为视图创建了一个文件夹，其中包含 header.phtml、main.phtml、footer.phtml。然后我使用此代码将 header.phtml 的内容分配给 $this->layout()->header：

```
(INDEX.PHTML)

$this->Layout()->header = file_get_contents('index/header.phtml');
$this->Layout()->main = file_get_contents('index/main.phtml');
$this->Layout()->footer = file_get_contents('index/footer.phtml'); 
```

那工作得很好，但我已经到了不想让 main 成为静态 HTML 的地步。我希望能够用 PHP 插入一些值。因此，在 indexAction 的控制器中，我希望能够从我的数据库中加载并将值放入 index/main.phtml。有没有办法在不重组我的网站的情况下做到这一点？

如果没有，有没有办法做到这一点，以便我可以拥有：

1.  将代码放入布局的不同部分的能力，例如 Layout()->header、Layout->footer。

2.  将这些部分分成不同的文件，以便于查找和组织它们，例如我的 index/footer.phtml、index/main.phtml 等。

3.  不必将该代码不必要地放入引号中以将其转换为字符串以将其传递给 Layout()->header 等。

非常感谢你们的帮助。

-伊森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T19:23:02.173

这是一个想法：

*   分配 layout()->header 文件名而不是内容。
*   把你的代码放在这个文件中
*   在你的布局文件中，include() 或 require() 布局->header()。

由于您的布局页眉/页脚现在已解析，您可以像使用视图一样使用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T11:55:12.380

`->header`in`$this->layout()->header`是**响应**段。`$this->_helper->viewRenderer->setResponseSegment('header');`您可以在操作中使用渲染部分响应。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-12T18:10:49.023

如果你使用

```
$this->layout()->header = $this->render('index/header.phtml'); 
```

它甚至会使用视图，因此在呈现标题时保留定义的所有变量。

我建议使用类似的东西

```
<?php echo ($header = $this->layout()->header)? 
      $header : $this->render('headerDefault.phtml'); ?> 
```

在您的布局文件中 - 如果视图脚本没有覆盖它，它将呈现布局文件夹中的默认标题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T20:12:36.597

您是否尝试过查看[视图助手](http://framework.zend.com/manual/en/zend.view.helpers.html)。它们是将视图逻辑结构化为可重用和模块化代码的一种方式。在这种情况下，您将使用视图助手来生成每个所需的段。所以你的示例视图脚本看起来像

```
$this->Layout()->header = $this->header();
$this->Layout()->main = $this->main();
$this->Layout()->footer = $this->footer(); 
```

使用视图助手而不是 include 和 require 语句的好处是所有文件处理和名称解析都由框架处理。该[手册](http://framework.zend.com/manual/en/zend.view.helpers.html)包含有关如何设置路径和使用示例等的更多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T22:35:28.433

帮手很好。另一个选项与上面类似，将文件名放在页眉/页脚中 - 将模板名称和 use`$this->render($this->layout()->header))`等放在一起。这就像上面的 include/require 一样，但更加一致。

# linq - Linq 中的临时表——有人看到这个问题吗？

> ID：1009008
> 
> 赞同：7
> 
> 时间：2009-06-17T19:13:59.320
> 
> 标签：linq, tsql, temp-tables

在试图解决：

[Linq .Contains with large set 导致 TDS 错误](http://stackoverflow.com/questions/1007893)

我想我偶然发现了一个解决方案，我想看看它是否是解决问题的一种犹太方式。

（简短摘要）我想针对不是（完全或至少很容易）在 SQL 中生成的记录 ID 列表进行 linq-join。这是一个很大的列表，并且经常超过 TDS RPC 调用的 2100 项限制。所以我在 SQL 中所做的就是把它们扔到一个临时表中，然后在我需要它们的时候加入它。

所以我在 Linq 中做了同样的事情。

在我的 MyDB.dbml 文件中，我添加了：

```
<Table Name="#temptab" Member="TempTabs">
  <Type Name="TempTab">
    <Column Name="recno" Type="System.Int32" DbType="Int NOT NULL" 
          IsPrimaryKey="true" CanBeNull="false" />
  </Type>
</Table> 
```

打开设计器并关闭它，在那里添加了必要的条目，但为了完整起见，我将引用 MyDB.desginer.cs 文件：

```
 [Table(Name="#temptab")]
   public partial class TempTab : INotifyPropertyChanging, INotifyPropertyChanged
   {

           private static PropertyChangingEventArgs emptyChangingEventArgs = new PropertyChangingEventArgs(String.Empty);

           private int _recno;

#region Extensibility Method Definitions
partial void OnLoaded();
partial void OnValidate(System.Data.Linq.ChangeAction action);
partial void OnCreated();
partial void OnrecnoChanging(int value);
partial void OnrecnoChanged();
#endregion

           public TempTab()
           {
                   OnCreated();
           }

           [Column(Storage="_recno", DbType="Int NOT NULL", IsPrimaryKey=true)]
           public int recno
           {
                   get
                   {
                           return this._recno;
                   }
                   set
                   {
                           if ((this._recno != value))
                           {
                                   this.OnrecnoChanging(value);
                                   this.SendPropertyChanging();
                                   this._recno = value;
                                   this.SendPropertyChanged("recno");
                                   this.OnrecnoChanged();
                           }
                   }
           }

           public event PropertyChangingEventHandler PropertyChanging;

           public event PropertyChangedEventHandler PropertyChanged;

           protected virtual void SendPropertyChanging()
           {
                   if ((this.PropertyChanging != null))
                   {
                           this.PropertyChanging(this, emptyChangingEventArgs);
                   }
           }

           protected virtual void SendPropertyChanged(String propertyName)
           {
                   if ((this.PropertyChanged != null))
                   {
                           this.PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
                   }
            }
    } 
```

然后它就变成了在代码中处理一些事情的问题。我通常有的地方：

```
MyDBDataContext mydb = new MyDBDataContext(); 
```

我必须让它与普通的 SqlConnection 共享它的连接，以便我可以使用该连接来创建临时表。在那之后，它似乎非常有用。

```
string connstring = "Data Source.... etc..";
SqlConnection conn = new SqlConnection(connstring);
conn.Open();

SqlCommand cmd = new SqlCommand("create table #temptab " +
                                "(recno int primary key not null)", conn);
cmd.ExecuteNonQuery();

MyDBDataContext mydb = new MyDBDataContext(conn);
// Now insert some records (1 shown for example)
TempTab tt = new TempTab();
tt.recno = 1;
mydb.TempTabs.InsertOnSubmit(tt);
mydb.SubmitChanges(); 
```

并使用它：

```
// Through normal SqlCommands, etc...
cmd = new SqlCommand("select top 1 * from #temptab", conn);
Object o = cmd.ExecuteScalar();

// Or through Linq
var t = from tx in mydb.TempTabs
        from v in  mydb.v_BigTables
        where tx.recno == v.recno
        select tx; 
```

有没有人认为这种方法存在问题，作为在 Linq 的连接中使用临时表的通用解决方案？

它很好地解决了我的问题，因为现在我可以在 Linq 中直接加入，而不必使用 .Contains()。

**后记**：我遇到的一个问题是在桌子上混合 Linq 和常规 SqlCommands（其中一个是读/写，另一个也是）可能是危险的。总是使用 SqlCommands 在表上插入，然后 Linq 命令读取它工作正常。显然，Linq 缓存了结果——可能有办法绕过它，但并不明显。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-09-16T21:30:11.500

我认为使用临时表解决您的问题没有问题。就混合 SqlCommands 和 LINQ 而言，您对危险因素是绝对正确的。使用 DataContext 执行 SQL 语句非常容易，我什至不用担心 SqlCommand：

```
private string _ConnectionString = "<your connection string>";

public void CreateTempTable()
{
    using (MyDBDataContext dc = new MyDBDataContext(_ConnectionString))
    {
        dc.ExecuteCommand("create table #temptab (recno int primary key not null)");
    }
}

public void DropTempTable()
{
    using (MyDBDataContext dc = new MyDBDataContext(_ConnectionString))
    {
        dc.ExecuteCommand("DROP TABLE #TEMPTAB");
    }
}

public void YourMethod()
{
    CreateTempTable();

    using (MyDBDataContext dc = new MyDBDataContext(_ConnectionString))
    {
        ...
        ... do whatever you want (within reason)
        ...
    }

    DropTempTable();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-05T17:20:21.750

我们有类似的情况，虽然这可行，但问题在于您并没有真正处理 Queryables，因此您不能轻松地使用这个“with”LINQ。这不是一个适用于方法链的解决方案。

我们的最终解决方案只是将我们想要的内容放入存储过程中，并在我们需要这些值时在该过程中针对临时表写入选择。这是一种妥协，但两者都是解决方法。至少使用存储过程，设计者会为您生成调用代码，并且您有一个黑盒实现，因此如果您需要进一步调整，您可以在过程中严格执行此操作，而无需重新编译。

在一个完美的世界中，将来会有一些对编写 Linq2Sql 语句的支持，这些语句允许您在查询中指示临时表的使用，避免在像这样的复杂场景中使用讨厌的 sql IN 语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-16T21:58:20.510

作为“通用解决方案”，如果您的代码在多个线程/应用程序中运行怎么办？我认为大列表解决方案总是与问题域相关。对于您正在处理的问题，最好使用常规表。

我曾经在数据库中创建了一个“通用”列表。该表由三列创建：int、uniqueidentifier 和 varchar，以及用于管理每个列表的其他列。我在想：“它应该足以处理许多案件”。但很快我收到了一个任务，需要使用三个整数的列表执行连接。之后，我再也没有尝试创建“通用”列表。

此外，最好创建一个 SP 以在每个数据库调用中将多个项目插入到列表中。您可以在不到 2 db 的往返行程中轻松插入约 2000 个项目。当然，取决于你在做什么，性能可能并不重要。

编辑：忘了它是一个临时表，临时表是每个连接的，所以我之前关于多线程的论点是不正确的。但是，对于强制执行固定模式，它仍然不是一个通用的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-19T22:33:42.737

Neil 提供的解决方案真的有效吗？如果它是一个临时表，并且每个方法都在创建和处理自己的数据上下文，我认为在连接断开后临时表不会仍然存在。

即使它在那里，我认为这将是一个你假设查询和连接最终如何呈现的一些功能的领域，这就是 linq to sql 的一些大问题 - 你只是不知道他可能会发生什么跟踪工程师想出更好的做事方式。

我会在存储过程中进行。如果您愿意，您始终可以将结果集返回到预定义的表中。

# translation - 自动源代码翻译是否有益和/或必要？

> ID：1009011
> 
> 赞同：8
> 
> 时间：2009-06-17T19:14:13.813
> 
> 标签：translation

我最近花了几年时间将遗留的 FORTRAN 翻译成 Java。在此之前，我发现自己将 FORTRAN 翻译成 C（为此我编写了一个简单的翻译工具）。在完成所有这些工作之后，我发现自己想知道有多少其他人在做类似的语言到语言的翻译，以及这样做的自动化方式是否有益。

我知道 F2C、For_C、F2J 等，以及一些翻译网站，但似乎没有一个是那么成功。看到 For_C 的输出后，我明白为什么它还没有起飞。虽然它在技术上是正确的，但很难维护。

所以，我想我想知道是否有工具可以生成比我见过的代码更易于维护、更易理解的代码，开发人员会使用它吗？或者开发人员是否像许多帖子似乎表明的那样厌倦并且不愿意使用生成的代码，因为它永远不会像他们手动翻译的代码那样好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T19:28:18.467

[这在从 Fortran 77 代码到 C++](https://stackoverflow.com/questions/275458/conversion-of-fortran-77-code-to-c)的转换中已经在一定程度上有所涉及，但我将在这里尝试一下。

我认为将遗留代码翻译成新语言浪费了很多时间。这样做需要花费大量的时间和精力，并且在执行时会引入新的错误。

[Joel 在Things you Should Never Do Part I](http://www.joelonsoftware.com/articles/fog0000000069.html)中提到了为什么从头开始重写是一个可怕的想法，尽管我意识到将某些东西翻译成新语言与从头开始重写并不完全相同，但我声称它已经足够接近了：

1.  自动翻译工具并不出色，因为您无法从中获得任何可维护的东西。你几乎必须知道*旧*代码才能理解*新*代码，然后你得到了什么？

2.  要手动移植某些东西，您必须知道代码是如何工作的。重写代码很少由原始开发人员完成，因此很少有了解所有内容的人来进行重写。我在一家公司工作，该公司聘请了一个外包团队将整个网站后端从 ColdFusion 翻译为 JSP。由于港口团队根本不知道代码，该项目不断拖延。我们的人从来都不太喜欢他们的设计，也从来没有把它做对，所以当每个人都解决了在原始代码中解决的所有问题时，他们不断地迭代。然后，移植本身就花了很长时间。

3.  您还需要熟悉语言之间真正的技术不一致。非常熟悉两种语言的人很少。

特别是对于 Fortran，我现在在一个有数百万行遗留 Fortran 代码的地方工作，这里没有人打算重写它。风险太大了。旧的错误必须重新修复，并且有数百人年的时间来计算数学。没有人愿意引入这些类型的错误，这样做可能是完全不安全的。

我们没有移植，而是使用混合代码。毕竟，您可以链接 Fortran 和 C/C++，如果您围绕 Fortran 代码创建 C 接口，您可以从 Java 调用它。这里的现代代码具有 C/C++ 组件，可以调用旧的 Fortran 例程，如果您这样做，您将获得 Fortran 编译器快速尖叫的额外好处，因此旧代码继续像以往一样快速运行。

我认为处理这个问题的最好方法是做任何你需要增量做的移植。围绕您的旧 fortran 代码创建一个轻量级接口并调用您需要的部分，但只在新部分中移植您需要的东西。还有用于集成多语言应用程序的组件框架可以使这更容易，但您可以查看[将 Fortran 77 代码转换为 C++](https://stackoverflow.com/questions/275458/conversion-of-fortran-77-code-to-c)以了解更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T19:17:46.957

简而言之，没有。显然时间限制有时需要它，但是......

用一种语言编写的代码很少能很好地翻译成另一种语言——每种语言都有特定的做事方式，这些方式更适合可用的结构/公共库等。

例如，考虑一个用 C 编写的程序与用 Python 编写的程序相比 - 当然，您可以编写 for 循环并在 Python 中像在 C 中一样容易地遍历事物，但是使用列表推导并利用它要简单得多语言提供的功能。

我会惊讶地看到一个用任何语言编写的合理大小的程序示例，它可以被翻译成任何其他语言的“正确”、可维护性良好的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T19:27:32.150

我使用过 f2c，我同意任何想将其命名为 cc2fc 的人。这不是将 Fortran 转换为可用作 C 的任何东西的方法。它是一种使用 C 编译器并从中制作 Fortran 编译器的方法。

它在获取 Fortran 代码并将其（通过 C）转换为我可以从 Macintosh Common Lisp 调用的 Macintosh 库方面确实工作得很好。那是那些日子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T19:23:01.097

由于编程很难，因此没有这样的工具真的存在。

如果将一种语言更改为另一种语言是微不足道的，那么“编译器”的想法将毫无意义。您只需将您喜欢的语言映射到硬件语言，按下按钮即可完成。

然而，事情从来没有那么简单。每个虚拟机、每种语言、每个 API 库都增加了无法自动化的细微差别。

“我明白为什么它还没有起飞。虽然它在技术上是正确的，但很难维护。”

更正 F2C 以及 Fortran 到机器语言。大多数编译器生成的目标代码不容易被人们阅读。它要么是粗鲁的，要么是高度优化的。无论哪种方式，它看起来都不像专家用汇编语言为该硬件编写的那样。

如果只有编译可以简化为一些类似 XSLT 的转换，在新语言中保留旧语言的清晰度。如果只有某种通用的计算*语言*，那将是编程的罗塞塔石碑。

除非有人发明了*通用语言*计算，否则每项语言翻译工作都会很困难，并且会导致新语言中的代码“难以维护”。

# ruby-on-rails - Rails 迁移管理 - 最佳实践？

> ID：1009014
> 
> 赞同：10
> 
> 时间：2009-06-17T19:14:38.493
> 
> 标签：ruby-on-rails, ruby, migration

迁移管理的最佳实践是什么？

例如，在调试迁移时，您是编辑原始迁移还是在提交到存储库之前添加编辑迁移？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T19:36:06.483

我倾向于编辑原始迁移，只要它是 a) 最后一次迁移并且 b) 不在源代码管理中。这为代码的所有其他使用者提供了一条干净的迁移路径。重要的是，您的迁移应该能够从您可以预期遇到的最早的任何数据库状态无错误地运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-28T21:19:11.070

开始测试您的迁移。

[http://blog.carbonfive.com/2011/01/27/start-testing-your-migrations-right-now/](http://blog.carbonfive.com/2011/01/27/start-testing-your-migrations-right-now/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T20:50:17.440

如果您与多个开发人员合作，编辑现有迁移可能很危险。

如果您的同事已经迁移了原始迁移，那么当他更新时，他将不会选择新代码，并且会随之而来。这是一个非常难以追踪的问题。做一个好居民的错误，只是创建一个更新的迁移。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-21T10:21:44.453

Even after reading this and the answers below, I just learned the hard way. Not to edit the original. You end up losing track your development process and it's hard to get back under control.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T10:20:43.530

仅当您可以验证其他开发人员尚未运行现有迁移或某些自动构建设置时，才编辑现有迁移。为了安全起见，您不应该编辑已提交的迁移文件，除非错误非常严重以至于迁移不会首先运行（在这种情况下，您为什么要提交它？）

此外，必须特别注意从应用程序中的其他位置调用代码的迁移，以便在运行它们时使用正确版本的代码运行它们。否则，模型中的细微变化真的会搞砸你之前的迁移。

# c# - 使用 LINQ 从多维数组中选择未知项

> ID：1009019
> 
> 赞同：3
> 
> 时间：2009-06-17T19:16:25.463
> 
> 标签：c#, linq, multidimensional-array

为了我个人的娱乐，我正在写我希望将成为以后游戏的基础的东西。目前，我正在开发游戏“棋盘”。请考虑以下几点：

```
class Board
{
    private Cube[,,] gameBoard;
    public Cube[, ,] GameBoard { get; }
    private Random rnd;
    private Person person;
    public Person _Person { get; }

    //default constructor
    public Board()
    {
        person = new Person(this);
        rnd = new Random();
        gameBoard = new Cube[10, 10, 10];
        gameBoard.Initialize();
        int xAxis = rnd.Next(11);
        int yAxis = rnd.Next(11);
        int zAxis = rnd.Next(11);

        gameBoard[xAxis, yAxis, zAxis].AddContents(person);
    }
} 
```

还有这个：

```
class Person : IObject
{
    public Board GameBoard {get; set;}
    public int Size { get; set; }
    public void Move()
    {
        throw new NotImplementedException();
    }

    public void Move(Cube startLocation, Cube endLocation)
    {
        startLocation.RemoveContents(this);
        endLocation.AddContents(this);
    }

    public Person(Board gameBoard)
    {
        Size = 1;
        GameBoard = gameBoard;
    }

    public int[] GetLocation()
    {
        int[] currentLocation;
        var location =
            from cubes in GameBoard.GameBoard
            where cubes.GetContents.Contains(this)
            select cubes;
    }
} 
```

我知道这是非常错误的，它可能甚至都不好笑，但这是最粗略的粗剪。

我正在尝试`GetLocation`返回 所在位置的特定`Cube`索引`Person`。这样，如果该人在，`Board.GameBoard[1, 2, 10]`我将能够检索该位置（可能`int[]`如上所述）。但是，目前，由于以下错误，我无法编译：

```
Could not find an implementation of the query pattern for source type 'Cubes.Cube[*,*,*]'. 'Where' not found.' 
```

我很确定 LINQ 应该能够查询多维数组，但我还没有找到任何关于如何做到这一点的文档。

有什么建议，还是我在这里完全错误？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T19:40:44.323

LINQ 没有看到您想要的多维数组，因为它们没有实现`IEnumerable<T>`（尽管单索引数组可以，这让人们感到惊讶）。有几种解决方法：您可以避免使用 LINQ 搜索多维数据集，或者您可以编写自己的扩展方法来执行更传统的遍历。

在这种情况下，我不会使用 LINQ 进行搜索，但更重要的是，我可能会将一些对各种播放片段的引用保留在更易于更新和管理的简单结构（可能是字典）中。作为一个想法，您的片段对象将知道*它*在棋盘上的位置，并且可以在立方体移动时通过将自身从一个单元格中移除并将其自身添加到另一个单元格来更新立方体。

重要的是要知道一个单元格是否可以包含多个片段：如果是这样，每个单元格也需要是某种类型的列表（它在您的代码中以这种方式出现）。一旦你到了这一点，如果玩的棋子比单元格少得多，我可能永远不会真正将“立方体”本身创建为数据结构。它将通过一些 Z 顺序绘图算法绘制并显示，该算法直接从片段列表中提取，而不是数组。不过，这将取决于游戏的风格：如果棋子具有属性并且数量很少，这将起作用。如果游戏更像 3D Go 或类似游戏，那么您的原始立方体将是有意义的……这实际上取决于您的棋子有多少“个性”（以及数据）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T19:36:31.773

将 int[] currentLocation 声明移动到 Person 类的顶层并提供 getter/setter 方法对我来说更有意义。然后每个人存储自己的位置。

对于 3 个整数的内存成本，您不必在每次想要检索该人的位置时查询 1000 个数据库条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T19:48:18.923

我认为这个人应该告诉董事会他在哪里，而不是问董事会。换句话说，我将创建一个 Location3D 类 (x,y,z)，在棋盘上所有其他东西都继承自的 GamePiece 类中使用它。那存储位置，然后每个peice都知道它的位置。

```
public class Location3D
{
  public Location3D(int x, int y, int z) { X = x; Y = y; Z = z; }
  public int X { get; set; }
  public int Y { get; set; }
  public int Z { get; set; }
}

public abstract GamePiece
{
  public Location3d { get; set; }

public class Person: GamePiece // inherit GamePiece
{
  // everything else about Person
}

public class Board
{
  public Board()
  {
    person = new Person(this);
    rnd = new Random();
    gameBoard = new Cube[10, 10, 10];
    gameBoard.Initialize();
    int xAxis = rnd.Next(11);
    int yAxis = rnd.Next(11);
    int zAxis = rnd.Next(11);

    var location = new Location3D(xAxis, yAxis, zAxis);
    person.Location = location;

    GetCubeAt(location).AddContents(person);
  }

  public Cube GetCubeAt(Location3D location)
  {
    return gameBoard[location.X, location.Y, location.Z];
  }

  public Cube GetCubeAt(int x, int y, int z)
  {
    return GetCubeAt(new Location3D(x,y,z));
  }
} 
```

# linq-to-sql - 为什么 ForeignKey_Edit 加载主键作为值，而不是关联中使用的实际值？

> ID：1009022
> 
> 赞同：0
> 
> 时间：2009-06-17T19:17:21.017
> 
> 标签：linq-to-sql, asp.net-dynamic-data

我正在使用 ASP.NET 动态数据来创建票证编辑表单。工单与问题代码相关联，但不使用问题代码的主键。（数据库是第 3 方，所以我无法控制...）

所以问题代码看起来基本上像：

```
ProblemCode
(
    ID int,
    Code varchar(8),
    Description varchar(250)
) 
```

关联在 Ticket.ProblemCode 和 ProblemCode.Code 之间

现在的问题是 ForeignKey_Edit （实际上是 PopulateListControl）用主键填充下拉列表，即 ID ......但票证实际上是使用代码将两者联系在一起。我错过了什么吗？有没有一种简单的方法可以让它使用 Code 作为值呢？

如果不是，我可能会从视图中消除 ID，因为我认为它不必在任何地方使用......我只是喜欢有一个 ID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-08-26T21:26:00.360

在您的元数据中试试这个：

```
[DisplayColumn("Code")] 
public partial class ProblemCode{ } 
```

# css - 一个伪类有多少权重？

> ID：1009024
> 
> 赞同：0
> 
> 时间：2009-06-17T19:17:33.293
> 
> 标签：css, dotnetnuke

我在 DNN 环境中工作，其中每个站点加载的默认样式表设置伪类的样式。我可以编辑默认样式表，但由于这是库存并且带有所有升级，我宁愿不理会它并在皮肤级别覆盖它们的样式。

有谁知道让所有这些伪类再次开始收听独立元素的解决方案？

```
A:link
{
    text-decoration: none;
    color: #003366;
}

A:visited
{
    text-decoration: none;
    color: #003366;
}

A:hover
{
    text-decoration: underline;
    color: #ff0000;
}

A:active
{
    text-decoration: none;
    color: #003366;
} 
```

还有，再强也`a:hover {}`总能打不过？`selector a {}``selector`

* * *

编辑：我不想使用 !important 因为我必须在任何地方使用重要，并且我不想在文档中嵌入任何样式。

我的假设是 a:link{text-decoration:none;} 只会被相同的伪类覆盖，我希望有一种方法可以解决必须始终为每个 a 标签定义伪类的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T19:23:32.330

如果您`<style>`在 HTML 本身的标签中包含声明，它将覆盖外部样式表中设置的任何样式。

另一种解决方案是创建第二个 CSS 文档来覆盖现有的 CSS。确保在包含现有 CSS 文件（适用于 IE 6 兼容）*之后包含此 CSS 文件。*然后`!important`在要覆盖的所有样式上使用标签。

有关更多信息，请参阅 W3 规范中有关[CSS 级联](http://www.w3.org/TR/CSS21/cascade.html#cascade)的部分。

**编辑：**回答你的第二个问题。 `a:hover{}`会打败`selector a{}`，但`selector a:hover{}`会打败`a:hover{}`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T19:31:14.013

> 另外，无论选择器有多强大，`a:hover {}`总是会击败选择器？`a {}`

这取决于：在设置冲突属性的情况下，更具体的选择器将获胜；否则，它们将是累加的。（除非，当然，你正在做的事情`!important`......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T02:30:57.740

我刚刚在使用 :first-child 和 :last-child 时测试了加载时间。每个（在我的本地机器上）的差异似乎在 8 毫秒左右，尽管我不肯定它是否会随着您使用的越多而增长。

# sql - Facebook 数据库设计？

> ID：1009025
> 
> 赞同：141
> 
> 时间：2009-06-17T19:17:39.377
> 
> 标签：sql, facebook, database-design, database-normalization, database-table

我一直想知道 Facebook 是如何设计朋友 <-> 用户关系的。

我认为用户表是这样的：

```
user_email PK
user_id PK
password 
```

我用用户数据（我假设通过用户电子邮件连接的性别、年龄等）计算表格。

它如何将所有朋友与该用户联系起来？

像这样的东西？

```
user_id
friend_id_1
friend_id_2
friend_id_3
friend_id_N 
```

可能不是。因为用户数量是未知的，并且会扩大。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-06-17T19:21:32.223

保留一个朋友表，其中包含用户 ID，然后是朋友的用户 ID（我们将其称为 FriendID）。这两列都是返回用户表的外键。

一些有用的例子：

```
Table Name: User
Columns:
    UserID PK
    EmailAddress
    Password
    Gender
    DOB
    Location

TableName: Friends
Columns:
    UserID PK FK
    FriendID PK FK
    (This table features a composite primary key made up of the two foreign 
     keys, both pointing back to the user table. One ID will point to the
     logged in user, the other ID will point to the individual friend
     of that user) 
```

示例用法：

```
Table User
--------------
UserID EmailAddress Password Gender DOB      Location
------------------------------------------------------
1      bob@bob.com  bobbie   M      1/1/2009 New York City
2      jon@jon.com  jonathan M      2/2/2008 Los Angeles
3      joe@joe.com  joseph   M      1/2/2007 Pittsburgh

Table Friends
---------------
UserID FriendID
----------------
1      2
1      3
2      3 
```

这将表明 Bob 是 Jon 和 Joe 的朋友，并且 Jon 也是 Joe 的朋友。在这个例子中，我们将假设友谊总是有两种方式，所以你不需要在表中的一行，例如 (2,1) 或 (3,2)，因为它们已经在另一个方向上表示了。对于友谊或其他关系不是明确的双向关系的示例，您还需要有这些行来指示双向关系。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2015-02-26T00:34:40.130

## TL;博士：

他们使用带有缓存图的堆栈体系结构来存储堆栈底部 MySQL 之上的所有内容。

## 长答案：

我自己对此进行了一些研究，因为我很好奇他们如何处理大量数据并快速搜索。我看到人们抱怨当用户群增长时定制的社交网络脚本变得很慢。在我用**只有 10k**用户和**250 万朋友**连接对自己进行了一些基准测试之后——甚至没有试图打扰组权限、喜欢和墙帖——很快发现这种方法是有缺陷的。所以我花了一些时间在网上搜索如何做得更好，并看到了这篇官方 Facebook 文章：

*   [TAO：Facebook 的社交图分布式数据存储](https://www.usenix.org/conference/atc13/technical-sessions/presentation/bronson)
*   [陶：图表的力量](https://www.facebook.com/notes/facebook-engineering/tao-the-power-of-the-graph/10151525983993920)。

我*真的*建议您在继续阅读之前观看上面第一个链接的演示。这可能是您能找到的关于 FB 如何在幕后工作的最佳解释。

视频和文章告诉你一些事情：

*   他们在堆栈的最*底层使用 MySQL*
*   *在 SQL DB之上*是 TAO 层，它包含至少两级缓存，并使用图形来描述连接。
*   我找不到关于他们实际用于缓存图表的软件/数据库的任何信息

让我们看看这个，朋友关系在左上角：

![在此处输入图像描述](../Images/3d0cfe1c039d7d5729f5c6af6fc8469d.png)

嗯，这是一个图表。:) 它没有告诉你*如何*在 SQL 中构建它，有几种方法可以做到这一点，但是[这个站点](http://www.artfulsoftware.com/mysqlbook/sampler/mysqled1ch20.html)有很多不同的方法。**注意：**考虑一下关系数据库就是这样：它被认为是存储规范化数据，而不是图形结构。因此它的性能不如专门的图形数据库。

还要考虑到您必须执行比朋友的朋友更复杂的查询，例如，当您想要过滤您和朋友的朋友喜欢的给定坐标周围的所有位置时。图表是这里的完美解决方案。

我不能告诉你如何构建它以使其表现良好，但它显然需要一些试验和错误以及基准测试。

这是我对朋友的朋友的结果的*令人***失望**的测试：

 *数据库架构：

```
CREATE TABLE IF NOT EXISTS `friends` (
`id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `friend_id` int(11) NOT NULL
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8; 
```

好友好友查询：

```
(
        select friend_id
        from friends
        where user_id = 1
    ) union (
        select distinct ff.friend_id
        from
            friends f
            join friends ff on ff.user_id = f.friend_id
        where f.user_id = 1
    ) 
```

我真的建议您创建一些包含至少 10k 个用户记录并且每个记录至少有 250 个朋友连接的示例数据，然后运行此查询。在我的机器（i7 4770k、SSD、16gb RAM）上，该查询的结果**约为 0.18 秒**。也许可以优化，我不是数据库天才（欢迎提出建议）。但是，**如果**这是线性扩展，那么对于 10 万用户来说，你已经是 1.8 秒，对于 100 万用户来说是 18 秒。

对于大约 10 万用户来说，这可能听起来还不错，但考虑到您只是获取了朋友的朋友并且没有执行任何更复杂的查询，例如“*只显示朋友朋友的帖子 + 进行权限检查是否允许或不允许看他们中的一些+做一个子查询来检查我是否喜欢他们中的任何一个*“。您想让数据库检查您是否已经喜欢某个帖子，或者您必须在代码中进行。还要考虑这不是您运行的唯一查询，并且您在或多或少受欢迎的网站上同时拥有多个活跃用户。

我认为我的回答回答了 Facebook 如何很好地设计他们的朋友关系的问题，但很抱歉我不能告诉你如何以一种可以快速运行的方式实现它。实施社交网络很容易，但确保其表现良好显然不是 - 恕我直言。

我已经开始尝试使用 OrientDB 来进行图形查询并将我的边缘映射到底层 SQL DB。如果我完成它，我会写一篇关于它的文章。

## 如何创建一个性能良好的社交网站？

**2021 年 4 月 10 日更新**：我可能永远不会写这篇文章；）但这里有一些要点，你可以如何尝试扩展它：

*   使用不同的读写存储库
*   基于为此目的制造的更快的非关系数据库系统构建特定的读取存储库，不要害怕非规范化数据。写入规范化数据库但从专用视图读取。
*   使用最终一致性
*   看看 CQRS
*   对于基于社交网络图的读取存储库可能也是一个好主意。
*   将 Redis 用作存储整个序列化数据集的读取存储库

如果您以巧妙的方式结合上述列表中的要点，您可以构建一个性能*非常*好的系统。该列表不是“待办事项”列表，您仍然需要理解、思考和熟练使用它！[https://microservices.io/](https://microservices.io/)是一个不错的网站，涵盖了我之前提到的一些主题。

我所做的是存储由聚合生成的事件，并使用项目和处理程序写入如上所述的不同数据库。很酷的一点是，我可以随时根据需要重新构建我的数据。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2009-07-13T16:18:01.610

[查看由 Anatoly Lubarsky 进行反向工程](http://web.archive.org/web/20121031052327/http://blogs.x2line.com/al/archive/2007/06/02/3124.aspx)的以下数据库模式：

![Facebook 架构](../Images/832d19ccd618310a45a5c900551a7f3c.png)

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2009-06-17T19:21:38.120

我最好的选择是他们创建了一个[图形结构](http://en.wikipedia.org/wiki/Graph_(data_structure))。节点是用户，“友谊”是边。

保留一张用户表，保留另一张边表。然后您可以保留有关边缘的数据，例如“他们成为朋友的日子”和“批准状态”等。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2009-06-17T19:20:46.110

这很可能是多对多关系：

好友列表（表格）

```
user_id -> users.user_id
friend_id -> users.user_id
friendVisibilityLevel 
```

**编辑**

用户表可能没有 user_email 作为 PK，但*可能*作为唯一键。

用户（表）

```
user_id PK
user_email
password 
```

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2009-06-17T21:38:22.680

看看这些描述 LinkedIn 和 Digg 是如何构建的文章：

*   [http://hurvitz.org/blog/2008/06/linkedin-architecture](http://hurvitz.org/blog/2008/06/linkedin-architecture)
*   [http://highscalability.com/scaling-digg-and-other-web-applications](http://highscalability.com/scaling-digg-and-other-web-applications)

还有“大数据：Facebook 数据团队的观点”可能会有所帮助：

[http://developer.yahoo.net/blogs/theater/archives/2008/01/nextyahoonet_big_data_viewpoints_from_the_fac.html](http://developer.yahoo.net/blogs/theater/archives/2008/01/nextyahoonet_big_data_viewpoints_from_the_fac.html)

此外，还有这篇文章讨论了非关系数据库以及一些公司如何使用它们：

[http://www.readwriteweb.com/archives/is_the_relational_database_doomed.php](http://www.readwriteweb.com/archives/is_the_relational_database_doomed.php)

您会看到这些公司正在处理数据仓库、分区数据库、数据缓存和其他更高级别的概念，而我们大多数人每天都不会处理这些概念。或者至少，也许我们不知道我们知道。

前两篇文章有很多链接，可以让您更深入地了解。

**2014 年 10 月 20 日更新**

[Murat Demirbas](https://twitter.com/muratdemirbas)写了一篇关于

*   TAO：Facebook 用于社交图谱的分布式数据存储 (ATC'13)
*   F4：Facebook 的暖 BLOB 存储系统（OSDI'14）

[http://muratbuffalo.blogspot.com/2014/10/facebooks-software-architecture.html](http://muratbuffalo.blogspot.com/2014/10/facebooks-software-architecture.html)

高温高压

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2010-08-20T05:51:40.500

不可能从 RDBMS 中检索用户朋友数据的数据，以获取在恒定时间内超过 50 亿的数据，因此 Facebook 使用哈希数据库（无 SQL）实现了这一点，并且他们开源了名为 Cassandra 的数据库。

所以每个用户都有自己的密钥和队列中的朋友详细信息；要了解 cassandra 的工作原理，请查看以下内容：

[http://prasath.posterous.com/cassandra-55](http://prasath.posterous.com/cassandra-55)

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2013-06-28T18:07:40.250

最近 2013 年 6 月的这篇文章详细解释了从关系数据库到具有某些数据类型关联的对象的转换。

[https://www.facebook.com/notes/facebook-engineering/tao-the-power-of-the-graph/10151525983993920](https://www.facebook.com/notes/facebook-engineering/tao-the-power-of-the-graph/10151525983993920)

在 https://www.usenix.org/conference/atc13/tao-facebook's-distributed-data-store-social-graph 可以找到更长的论文

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2011-04-12T12:06:36.310

它是一种图形数据库： [http ://components.neo4j.org/neo4j-examples/1.2-SNAPSHOT/social-network.html](http://components.neo4j.org/neo4j-examples/1.2-SNAPSHOT/social-network.html)

它与关系数据库无关。

谷歌图数据库。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-06-17T19:22:22.830

您正在寻找外键。基本上你不能在数据库中拥有一个数组，除非它有自己的表。

* * *

### 示例架构：

```
    用户表
        用户名 PK
        其他数据
    朋友桌
        userID -- 代表有朋友的用户的用户表的 FK。
        friendID -- FK 到代表朋友的用户 ID 的用户表
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-17T19:40:46.723

请记住，数据库表设计为垂直增长（更多行），而不是水平增长（更多列）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-06-18T00:17:02.597

关于多对多表的性能，如果您有 2 个 32 位整数链接用户 ID，那么您的 200,000,000 个用户（平均每个 200 个朋友）的基本数据存储空间不到 300GB。

显然，您需要一些分区和索引，并且您不会将其保存在所有用户的内存中。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-10-29T16:59:57.817

可能有一个表，它存储朋友 <-> 用户关系，例如“frnd_list”，具有字段“user_id”、“frnd_id”。

每当用户将另一个用户添加为朋友时，都会创建两个新行。

例如，假设我的 id 是 'deep9c' 并且我添加了一个 id 为 'akash3b' 的用户作为我的朋友，然后在表 "frnd_list" 中创建两个新行，其值为 ('deep9c','akash3b') 和 ('akash3b '，'deep9c'）。

现在，当向特定用户显示好友列表时，一个简单的 sql 会执行此操作：“从 frnd_list 中选择 frnd_id 其中 user_id=" 其中是登录用户的 id（存储为会话属性）。*

# c# - 关于分组可以改变的东西的Linq问题？

> ID：1009033
> 
> 赞同：0
> 
> 时间：2009-06-17T19:19:13.337
> 
> 标签：c#, .net, linq

我有一个多个字符串的列表，我需要通过它们拥有的后缀对它们进行操作。唯一不变的是字符串的开头（它们将始终是 ManifestXXX.txt、FileNameItems1XXX...）。带后缀的字符串结尾每次都不同。这是我到目前为止所拥有的（Linq Pad）：

```
var filesName = new[] { "ManifestSUFFIX.txt",
"FileNameItems1SUFFIX.txt",
"FileNameItems2SUFFIX.txt",
"FileNameItems3SUFFIX.txt",
"FileNameItems4SUFFIX.txt",

"ManifestWOOT.txt",
"FileNameItems1WOOT.txt",
"FileNameItems2WOOT.txt",
"FileNameItems3WOOT.txt",
"FileNameItems4WOOT.txt",
}.AsQueryable();

var query =
    from      n in filesName
    group n by n.EndsWith("SUFFIX.txt") into ere
    select   new{ere} ;     

query.Dump(); 
```

GROUP里面的条件不好。我正在考虑尝试在组中使用嵌套的 SELECT 获取所有可能的后缀，但我找不到这样做的方法。

我怎样才能有 3 个不同的组，按它们的后缀与 Linq 分组？是否可以？

*吉米的回答很棒，但仍然无法按预期方式工作。有什么修复吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T19:32:59.597

按后缀分组，而不是它是否匹配任何特定的后缀。

```
...
group by GetSuffix(n) into ere 
...

string GetSuffix(string n) {
   return Regex.Replace(n,"^Manifest|^FileNameItems[0-9]+", "");
} 
```

# delphi - 有什么方法可以找出哪个 TField 使用消息“需要字段值”来提升 EDBClient。？

> ID：1009034
> 
> 赞同：3
> 
> 时间：2009-06-17T19:19:14.833
> 
> 标签：delphi, exception, tclientdataset

我有一个带有多个字段的 TClientDataSet 并且我遇到了这个异常，我确定我忘记设置一个字段值，但问题是，哪个字段？

有什么方法可以快速找出哪个字段引发了这个异常？

**编辑**

我解决了这个问题，我将 TClientDataSet 连接到了错误的提供者，该提供者在服务器上有一个必填字段，但在客户端没有这个字段。

但这仍然不能使我的问题无效，我浪费了很多时间来弄清楚，如果我有办法知道哪个服务器端必填字段引发了这个错误，那么很快就会意识到我的错误是什么。

**编辑 2**

相关质检：

[#5557](http://qc.embarcadero.com/wc/qcmain.aspx?d=5557) - 解决为“按设计”。

[#54380](http://qc.embarcadero.com/wc/qcmain.aspx?d=54380) - 打开

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T19:50:50.450

当调试器通知您异常时，请查看调用堆栈。导航到遍历字段列表的例程，并检查此时的循环控制变量，以了解您的程序在引发异常之前通过字段列表的距离。

如果循环控制变量不准确，则在该例程中设置断点并重新运行程序。单步执行，直到您再次遇到异常。

另一种选择是查看所有字段并亲自查看哪个字段缺少值。

# c# - 如何以编程方式滚动 WPF 列表视图？

> ID：1009036
> 
> 赞同：19
> 
> 时间：2009-06-17T19:20:09.200
> 
> 标签：c#, .net, wpf, listview

是否可以以编程方式滚动 WPF 列表视图？我知道winforms不会这样做，对吧？

我说的是向上或向下滚动 50 个单位等。不是一次滚动整个项目高度。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-06-17T20:13:00.060

是的，您必须从 ListView 中获取 ScrollViwer，或者一旦您可以访问它，您就可以使用它公开的方法或覆盖滚动。您还可以通过获取主要内容区域并使用它的[IScrollInfo](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.iscrollinfo.aspx)接口实现来滚动。

这是获取诸如 ListBox、ListView 等之类的 ScrollViwer 组件的小帮手。

```
public static DependencyObject GetScrollViewer(DependencyObject o)
{
    // Return the DependencyObject if it is a ScrollViewer
    if (o is ScrollViewer)
    { return o; }

    for (int i = 0; i < VisualTreeHelper.GetChildrenCount(o); i++)
    {
        var child = VisualTreeHelper.GetChild(o, i);

        var result = GetScrollViewer(child);
        if (result == null)
        {
            continue;
        }
        else
        {
            return result;
        }
    }
    return null;
} 
```

然后你可以像这样使用 .LineUp() 和 .LineDown() ：

```
private void OnScrollUp(object sender, RoutedEventArgs e)
{
    var scrollViwer = GetScrollViewer(uiListView) as ScrollViewer;

    if (scrollViwer != null)
    {
       // Logical Scrolling by Item
       // scrollViwer.LineUp();
       // Physical Scrolling by Offset
       scrollViwer.ScrollToVerticalOffset(scrollViwer.VerticalOffset + 3);
    }
}

private void OnScrollDown(object sender, RoutedEventArgs e)
{
    var scrollViwer = GetScrollViewer(uiListView) as ScrollViewer;

    if (scrollViwer != null)
    {
        // Logical Scrolling by Item
        // scrollViwer.LineDown();
        // Physical Scrolling by Offset
        scrollViwer.ScrollToVerticalOffset(scrollViwer.VerticalOffset + 3);
    }
}

<DockPanel>
    <Button DockPanel.Dock="Top"
            Content="Scroll Up"
            Click="OnScrollUp" />
    <Button DockPanel.Dock="Bottom"
            Content="Scroll Down"
            Click="OnScrollDown" />
    <ListView x:Name="uiListView">
        <!-- Content -->
    </ListView>
</DockPanel> 
```

LineUp 和 LineDown 公开的逻辑滚动仍然按项目滚动，如果您想滚动一定量，您应该使用我在上面使用的 ScrollToHorizo​​ntal/VerticalOffset。如果您也想要一些更复杂的滚动，请查看我在[另一个问题](https://stackoverflow.com/questions/876994/in-wpf-how-do-i-adjust-the-scroll-increment-for-a-flowdocumentreader-with-viewin/973500#973500)中提供的答案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T19:24:58.067

你试过[ScrollIntoView](http://msdn.microsoft.com/en-us/library/system.windows.controls.listbox.scrollintoview.aspx)吗？或者，如果它不是您带入视图的特定项目，而是与当前位置的偏移量，您可以使用[BringIntoView](http://msdn.microsoft.com/en-us/library/ms598115.aspx)。

# python - 在 Clojure 中处理来自两个序列的值对

> ID：1009037
> 
> 赞同：8
> 
> 时间：2009-06-17T19:20:23.427
> 
> 标签：python, clojure, zip

我正在尝试进入 Clojure 社区。我一直在使用 Python，我广泛使用的功能之一是 zip() 方法，用于迭代成对的值。在 Clojure 中是否有一种（聪明而简短的）方法可以实现相同的目标？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-17T19:34:06.973

另一种方法是简单地将 map 与一些按顺序收集其参数的函数一起使用，如下所示：

```
user=> (map vector '(1 2 3) "abc")
([1 \a] [2 \b] [3 \c]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T19:30:16.107

```
(zipmap [:a :b :c] (range 3))
-> {:c 2, :b 1, :a 0} 
```

对地图的迭代是成对发生的，例如：

```
(doseq [[k v] (zipmap [:a :b :c] (range 3))]
  (printf "key: %s, value: %s\n" k v)) 
```

印刷：

```
key: :c, value: 2
key: :b, value: 1
key: :a, value: 0 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-19T08:16:43.297

问题已得到解答，但仍有`interleave`，它也处理任意数量的序列，但不会将结果序列分组为元组（但您可以使用`partition`它）。

# java - 哪种免费的 JVM 实现具有最好的 PermGen 处理能力？

> ID：1009042
> 
> 赞同：7
> 
> 时间：2009-06-17T19:21:36.327
> 
> 标签：java, jvm, permgen

我在 Sun 的 JRE6 中运行 Tomcat6 并且每对部署我都会得到 OutOfMemoryException: PermGen。我已经完成了 PermGen 解决方案的谷歌搜索并尝试了许多修复。没有工作。我读了很多关于 Oracle 的 JRockit 的好东西，以及它的 PermGen 分配的大小如何（与 Sun 的 128M 相比），虽然它不能解决问题，但它允许我在 PermGen 异常之间重新部署 100 次，而不是 2现在几次。

JRockit 的问题是在生产中使用它需要花费数千美元购买 WebLogic。存在哪些其他（免费）选项对 PermGen 扩展更宽容？以下 JVM 在这方面的表现如何？

*   IBM JVM
*   打开 JDK
*   停电
*   咖啡

...其他？

**更新：**有人问我为什么认为 PermGen max 是 128M。原因是每当我尝试将其提高到 128M 以上时，我的 JVM 都无法初始化：

`[2009-06-18 01:39:44] [info] Error occurred during initialization of VM [2009-06-18 01:39:44] [info] Could not reserve enough space for object heap [2009-06-18 01:39:44] [395 javajni.c] [error] CreateJavaVM Failed`

奇怪的是，它未能为对象**heap**保留空间，尽管我不确定它是“the” heap 而不是“a” heap。

我以 1024MB 初始和 1536MB 最大堆启动 JVM。

我将关闭这个问题，因为它已被回答，即。“切换是无用的”，而是问[为什么我的 Sun JVM 会因较大的 PermGen 设置而失败？](https://stackoverflow.com/questions/1010986/why-does-my-sun-jvm-fail-to-initialize-when-i-set-permgen-above-128m)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T19:56:32.857

我同意 Michael Borgwardt 的观点，即您可以增加 PermGen 的大小，但我不同意这主要是由于内存泄漏。PermGen 空间被大量使用反射的应用程序占用。所以基本上，如果你有一个在 Tomcat 中运行的 Spring/Hibernate 应用程序，请准备好大幅增加 PermGen 空间。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T19:35:14.130

是什么让您认为 Sun 的 JVM 仅限于 128M PermGen？您可以使用 -XX:MaxPermSize 命令行选项自由设置；默认为 64M。

但是，问题的真正原因可能是应用程序中的内存泄漏，它阻止了类被垃圾收集；这些可能非常微妙，尤其是在涉及 ClassLoader 时，因为它所需要的只是对任何地方的任何类的单个引用。[本文](http://blogs.oracle.com/fkieviet/entry/classloader_leaks_the_dreaded_java)详细描述了该问题，并提出了解决[该问题的方法。](http://blogs.oracle.com/fkieviet/entry/how_to_fix_the_dreaded)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T19:44:33.533

从技术上讲，“PermGen”内存池是 Sun JVM 的东西。其他 JVM 不这么称呼它，但它们都有一个或多个非堆内存池的想法。

但是，如果您的 Sun JVM 中的 permgen 存在问题，那么迁移到另一个 JVM 不太可能解决任何问题，它只会以不同的名称表现出来。

如果多次重新部署导致您的问题，只需将 VM 的 PermGen 提高到较大的值。由于这个问题，我们不久前尝试了 JRockit，它遭受了同样的重新部署耗尽。我们回到了 SUn JVM。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-17T20:25:27.540

改变 JVM 不是灵丹妙药。您可能会遇到新的意外问题（例如，请参阅有关在 4 个不同 JVM 下启动应用程序[的文章）。](http://java.dzone.com/articles/tale-four-jvms-and-one-app)

*   您可能会在重新部署时经常发生类泄漏（例如通过类加载器）。坦率地说，我从未见过在 Tomcat 上进行热重新部署（希望有一天能看到）。
*   您可能有不正确的 JVM 参数（例如，对于 Sun JDK 6 64 位 -XX:+UseParNewGC 开关会导致 PermGen 内存段泄漏。如果添加其他开关：-XX:+UseConcMarkSweepGC -XX:+CMSClassUnloadingEnabled-XX:+CMSPermGenSweepingEnabled情况将得到解决。有趣，但我从未遇到过上面提到的 Sun JDK 6 32 位泄漏）。[链接](http://edocs.bea.com/wlcp/wlss30/configwlss/jvmgc.html)到文章“为生产部署调整 JVM 垃圾收集”。
*   您的 PermGen 块可能不足以加载类和相关信息（实际上最常发生在 Tomcat 下重新部署后，旧类留在内存中，新类正在加载）

根据我过去的经验，调试这种泄漏是我经历过的最棘手的调试之一。

**[更新]**

[有用的文章](http://java.dzone.com/articles/classloaderlocal-how-avoid)如何在应用程序重新部署时消除类加载器链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-10T15:37:47.037

[IBM JVM](http://www-01.ibm.com/support/docview.wss?uid=swg21516002)没有（在 2009 年也没有）有 permgen 。您可以阅读有关它的[Generational Concurrent Garbage Collector](http://publib.boulder.ibm.com/infocenter/javasdk/v5r0/index.jsp?topic=%2Fcom.ibm.java.doc.diagnostics.50%2Fdiag%2Funderstanding%2Fmm_gc_generational.html)的更多信息，它是 Java 7 的默认 GC。

我有时专门在 IBM JVM 上运行 Eclipse IDE，因为使用我最喜欢的插件时，它经常会填满 HotSpot JVM 的 permgen。当然，可能存在应该有人修复的内存泄漏，但同时我的 IDE 没有崩溃，我也没有忙于尝试不同的设置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T05:33:36.713

Perm gen 可能是最容易处理的内存，我怀疑各种 vm 实现之间会有很大差异。

确保所有在生产中标记为关闭的 Tomcat 配置在生产中都已关闭。

是的，一些框架确实会生成大量类，但它们应该自己清理，而且，无论如何，您可以在 128Mb 中容纳多个类。

说真的，如果 perm gen 继续上升，那么这就是一个应该修复的泄漏，尽管它可能不是你要修复的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T19:56:18.037

我使用 JRockit，如果我不增加（通过 -XX:MaxPermSize）内存，我仍然会收到 PermGen 错误。我也无法避免得到这个（除了增加它）。

# jquery - ASP.NET (MVC) jQuery Intellisense -> ReSharper 中的错误

> ID：1009044
> 
> 赞同：3
> 
> 时间：2009-06-17T19:21:38.340
> 
> 标签：jquery, asp.net-mvc, resharper, resharper-4.5

我正在使用 jQuery 开发一个 ASP.NET MVC 项目。

我正在引用 jQuery VSDoc 文件 ( `jquery-1.3.2-vsdoc.js`) 以便在 Visual Studio 中为 jQuery 获取 Intellisense：

```
<% /* %><script src="~/Scripts/jquery-1.3.2-vsdoc.js"></script><% */ %> 
```

然后 Resharpers 实时解决方案分析（右下方状态栏中的红色/绿色符号）抱怨结束注释（ */ ）。

是否有另一种方法可以在没有 Reshaper (v4.5) 抱怨的情况下包含 VSDoc 文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T19:29:19.900

有一个适用于 Visual Studio 2008 和 Visual Web Developer 的修补程序，如果您包含 jquery-1.3.2.js（或任何其他具有类似名称的 -vsdoc 文件的 js 文件，它将自动包含 -vsdoc.js 文件。 )

您可以阅读有关修补程序的更多信息[http://blogs.msdn.com/webdevtools/archive/2008/11/07/hotfix-to-enable-vsdoc-js-intellisense-doc-files-is-now-available.aspx](http://blogs.msdn.com/webdevtools/archive/2008/11/07/hotfix-to-enable-vsdoc-js-intellisense-doc-files-is-now-available.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T19:26:19.327

只需将脚本包含在 if 语句中。这样，智能感知仍然可以在 VS 中工作，但 vsdoc 文件不会包含在 Web 输出中。

```
<% if(false) { %>
  <script src="../../Scripts/jquery-1.3.2-vsdoc.js"></script>
<% } %> 
```

# asp.net-mvc - 用于视图的 ASP.NET MVC 自定义 T4 模板

> ID：1009067
> 
> 赞同：13
> 
> 时间：2009-06-17T19:27:37.593
> 
> 标签：asp.net-mvc, visual-studio, t4

当我向 ASP.NET MVC 项目添加新的强类型视图时，我可以在不同的视图内容模板（创建详细信息、编辑、列表）之间进行选择。我已阅读这些是基于 Visual Studio T4 代码生成引擎的模板。

添加新视图时，如何创作和配置自己的模板并让它们出现在可用模板中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T19:30:23.237

[ASP.Net MVC - T4 乐趣](http://mvct4.codeplex.com/)

[T4 模板：面向 ASP.NET MVC 开发人员的快速入门指南](https://devblogs.microsoft.com/aspnet/t4-templates-a-quick-start-guide-for-asp-net-mvc-developers/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-09-17T12:04:41.613

创建以下文件夹结构：

{YourMVCProject}\CodeTemplates\AddView

将您的自定义 T4 模板 (*.tt) 放在此文件夹中。你会看到魔法！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-10T13:55:12.503

您可能想看看 David Hayden 的网站：[http](http://www.pnpguidance.net/Tag/T4.aspx) : //www.pnpguidance.net/Tag/T4.aspx——他提供了几个关于 T4 和 MVC 的截屏视频，让我开始学习。另请查看 T4 工具箱：(www.codeplex.com/t4toolbox)。这为 T4 模板提供了额外的帮助程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-29T18:02:46.547

您可以使用 NuGet 将包添加到您的项目，这会将现有代码模板添加到您的项目中。从那时起，您可以编辑它们或只是在同一位置创建新的，您应该在工具中看到它们。

[http://nuget.org/List/Packages/Mvc3CodeTemplatesCSharp](http://nuget.org/List/Packages/Mvc3CodeTemplatesCSharp)

# windows - 如何了解跨平台游戏开发？

> ID：1009076
> 
> 赞同：6
> 
> 时间：2009-06-17T19:29:36.670
> 
> 标签：windows, xbox360, ps3

Valve 等公司如何设法将游戏发布到所有三大游戏平台？我对特别是在 Windows、Xbox360 和 PS3 之间共享代码的最佳实践感兴趣，因为理想的解决方案是尽可能多地重用代码，而不是为每个平台重写整个代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T19:39:41.827

这与在其他上下文中编写独立于平台的代码没有任何不同。将特定于平台的细节（输入、窗口交互、主事件循环、线程等）隐藏在通用接口后面，并在您打算支持的所有平台上定期测试。

请注意，Cell 的线程模型非常不寻常，因此“一般”地进行线程处理需要一些小心。我不是 Valve 的员工，我也不知道他们的秘密，但据我了解，大多数想要以 PS3 为目标的游戏开发者都使用工作队列，各个单元处理器根据需要从其中获取任务。这不一定是使用 Cell 的最佳方式，但它可以很好地推广到更传统的线程模型（例如，frex，PC 和 360 都使用的模型）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T20:00:45.937

有很多关于这个主题的游戏开发者杂志文章和 GDC 演讲。事实上，既然你提到了 Valve，[他们](http://www.valvesoftware.com/publications/2008/GDC2008_CrossPlatformDevelopment.pdf)在 GDC08 上发表了一次演讲，描述了他们的方法。

这确实是一个巨大的话题，我可以（并且已经）谈论了几个小时，但电梯摘要是：

*   确定引擎的哪些部分是完全特定于平台的，并将它们放在抽象后面。例如，文件和资产加载需要为每个控制台重写；但是您可以将其隐藏在 IFileSystem 接口后面，该接口提供了游戏代码与之对话的统一 API。
*   PS3 很难做到这一点，因为它的抽象点必须与其他平台完全不同。即使是碰撞和导航等游戏功能也必须为 Cell 编写不同的内容。
*   尽量保持叶子游戏代码（实体、AI、sim）与平台无关......
*   但是请接受即使是最复杂的游戏代码有时也需要一些特定于平台的#ifdefs，以用于性能、内存或 TCR 的原因。由于制造商的认证要求相互冲突，因此必须重写许多 UI。
*   任何说“我不担心表现”或“记忆不是问题”的人都不应该在工资单上。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-21T17:28:08.047

This question can be divided up into two separate questions. "How can I write portable code?" and "What are the divergent requirements of mainstream gaming platforms?".

The first question is relatively easy to answer. Best practices for abstracting your non-portable code are covered in Write Portable Code: [http://books.google.ca/books?id=4VOKcEAPPO0C&printsec=frontcover](http://books.google.ca/books?id=4VOKcEAPPO0C&printsec=frontcover)

Turning theory into practice, the Quake 3 source code does a pretty good job of dividing out different platforms into separate areas for a C codebase, available at [http://www.idsoftware.com/business/techdownloads/](http://www.idsoftware.com/business/techdownloads/) However, it does not demonstrate C++ patterns such as abstract interfaces, implemented once per platform.

The second part of your question, "What are the divergent requirements of mainstream gaming platforms?" is tougher. However, it is notable that your largest areas of change are still your renderer, your audio subsystem and your networking.

Each console platform has a series of certification requirements, available under an agreement with the respective console owners. The requirements drive consistency in user experience and are not focused on gameplay or qualitative, high level issues. For instance, your game may need to display a reasonably interesting animating loading screen, and black screens are unacceptable.

Getting your hands on this documentation as soon as possible is key to making the right choices in developing for a specific console platform.

Finally, if you can't get your hands on a console devkit, I suggest you port your code to the Mac from Windows. The Mac gets you an OS port ensuring you are not tied to Windows as well as a processor port if you support universal binaries. This ensures your code is endian agnostic.

If you support both PC and Mac, you will be well positioned to support a third platform, should you gain access to it in the future.

**Addendum** You wrote:

> the ideal solution is to reuse as much code as possible instead of rewriting the whole thing for every platform

In many game porting scenarios, the ideal solution is *not* to reuse as much code as possible, but to write the optimal code for each platform. Code can be reused between projects and is relatively inexpensive as compared to the content that the engine takes in. A more reasonable goal is to aim for lowest common denominator content that runs on all platforms without modification (a build phase that packs the content for media is okay).

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-21T17:39:06.567

同步开发很棒。您会发现仅在一个平台上找不到的各种错误。

我记得 DOS 中的程序员一直都有空指针，因为写入低内存并不会立即使它们崩溃。当您移植到 Amiga、Atari ST 或 Macintosh 时，砰！我记得告诉一个 DOS 程序员，他在一个已发布的游戏上有几个空指针。他想了几秒，咧嘴一笑，“这说明了一些事情。”

既然游戏的预算如此之大，那么同时发布它们很重要，这样您就不会浪费营销和广告预算。

我对同步开发的建议是选择一个领先平台，但永远不要让其他平台落后一周以上。当您编写代码的哪些部分对所有平台通用以及哪些部分不同时，这一点会变得很明显。将差异提取到一个或多个特定于平台的区域。

我的经验是 C/C++。如果您必须移植不同的语言（例如，Java 和 Objective-c），这是一个更大的问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T19:46:11.347

几年前，Opera CEO 在一次采访中表示，为独立平台开发的关键是摆脱任何单一的操作系统/平台库。他接着说，他们开发了自己的库来提高操作系统的性能。

我的假设是，大公司会有一个共同的、Xbox、PS、windows、FooOS、独立的团队。每个平台都需要进行不同的调整，需要不同的实现方法。我不认为他们为所有平台提供一个来源。相反，他们为每个操作系统构建一个，从而提高效率。我记得 EA 曾经发布过一些比 PC 版本更早的主机游戏，反之亦然。

另一个问题是不同的控制台具有不同的硬件，因此需要不同的编程技术。

有两个极端，构建一个适合所有人的源代码（例如 java），但您冒着效率低下或编写 40 个版本的风险；一个针对每个平台进行了优化

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T19:51:38.200

当我有一个朋友从事教育电脑游戏时（在 The Learning Company 淘汰该领域之前），他非常喜欢创建跨平台库来做所有事情。

这对于游戏来说比其他应用程序更容易。例如，如果您有一个要在 Mac 和 Windows 上运行的文字处理应用程序，它的外观和行为确实需要像 Mac 上的 Mac 应用程序和 Windows 上的 Windows 应用程序。编写一个游戏，它不必符合原生的行为、外观和感觉。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T20:12:13.417

如果您想要开源示例，您可以查看 Quake 1、2 和 3 引擎的源代码。它们的结构非常便携。（当然，不支持 ps3 或 xbox360，但同样的原则适用）

[http://www.idsoftware.com/business/techdownloads/](http://www.idsoftware.com/business/techdownloads/)

# php - IIS6 上的 PHP5 - 指定的 CGI 应用程序行为不端

> ID：1009084
> 
> 赞同：0
> 
> 时间：2009-06-17T19:32:21.017
> 
> 标签：php, iis

PHP v5.2.8

Windows Server 2003 SP2（我相信 IIS 6，虽然我在 IIS 管理器的任何地方都找不到版本#）

完整的错误是：

```
"CGI Error
The specified CGI application misbehaved by not returning a complete set of HTTP headers." 
```

我从 bitnami.org 安装了 WAMP 堆栈，当通过 Apache 访问时，PHP 页面工作完全正常，我在端口 8888 上运行。但是，由于网络配置和防火墙的原因，我必须在 IIS 服务器上运行它在 80 端口上。还有其他网站在 80 端口上运行，包括无法更改的默认网站。不幸的是，我还必须将其作为虚拟目录运行，例如 www.myserver.com/phpapp，而不是作为它自己的网站，例如 phpapp.myserver.com。原因是我无法控制的防火墙需要新的直通规则才能允许访问新的子域。

当 php 应用程序在 IIS 中作为它自己的“网站”运行时，来自 Bitnami 的相同 WAMP 堆栈在另一台服务器上运行良好，因为我可以添加一个新的 PHP ISAPI 过滤器 - 但该选项卡/选项在虚拟目录上不可用。

我已经在 IIS 管理器中安装了 php“Web 服务扩展”。我已经尝试了 web-service-extensions 中的 php-cgi 和 php5isapi.dll。此外，我已经将这两种方法都作为网站“配置”映射下的“应用程序扩展”进行了尝试。

我还尝试将 php5isapi.dll 和 php-cgi.exe 混合/匹配组合用于“Web 服务扩展”和网站“配置”扩展映射。

我尝试在 php.ini 中调整一些东西（包括确保 doc_root 为空白）。但是，正如我之前提到的，通过 Apache 端口访问该网站时可以正常工作。IIS 指向完全相同的目录。

到底是什么导致了这个错误？我花了很多时间在网上搜索，似乎由于几个不同的原因弹出了这个错误。如果一个 PHP 应用程序在没有先写入标头的情况下对响应进行原始写入，则会导致此错误。当 PHP 错误导致某些格式错误的重定向时，某些 PHP 应用程序可能会导致此错误。

我的 php 错误日志在操作中丢失。在我的 php.ini 中，我有

```
error_reporting  =  E_ALL
display_errors = On
log_errors = On
display_startup_errors = On
error_log = "c:\temp\php.error.log" 
```

但是 c:\temp 中从来没有日志文件。我还尝试转义斜杠，并尝试在路径中使用正斜杠，但日志文件永远不会出现。

再次，我不得不提到这一切都可以通过 apache 正常工作，所以 PHP 本身似乎并没有因为一些奇怪的配置而放弃（即使我找不到日志文件）更不用说这是一样的我在通过 IIS 工作正常的另一台计算机上使用的 php.ini（php 应用程序是它自己的“网站”而不是虚拟目录）。

我不知道要提供什么其他信息-但是在与此作斗争几天后，我已经束手无策了。如果我放入一个 HTML 页面，我可以通过这个虚拟目录下的 IIS 访问它。这可能是什么原因造成的？

我要运行的应用程序是 vBulletin。除了在应用程序中相信 PHP 的正确性之外，不确定它是否重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-07-25T04:37:29.887

这应该已经解决了所有问题，解决了这些问题。

IIS 援助 PHP 安装程序 [http://www.iis-aid.com/iis_aid_php_installer](http://www.iis-aid.com/iis_aid_php_installer)

# asp.net - 如何让 ASP.NET TextBox 触发它在 AJAX UpdatePanel 中触发 onTextChanged 事件？

> ID：1009086
> 
> 赞同：10
> 
> 时间：2009-06-17T19:32:36.960
> 
> 标签：asp.net, ajax, textbox

我试图让文本框在每次击键时触发它的 onTextChanged 事件，而不是仅在失去焦点时触发。我认为添加 AsyncPostBackTrigger 可以做到这一点，但它仍然无法正常工作。我想要做的甚至可能吗？代码如下：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Items.aspx.cs" MasterPageFile="~/MMPAdmin.Master" Inherits="MMPAdmin.Items" %>
<asp:Content ID="content1" runat="server" ContentPlaceHolderID="ContentPlaceHolder1">
<asp:ScriptManager ID="sm_Main" runat="server" />
    <div style="left:10px;position:relative;width:100%;overflow:hidden">
        <asp:UpdatePanel ID="up_SearchText" runat="server">
            <Triggers>
                 <asp:AsyncPostBackTrigger ControlID="tb_Search" EventName="TextChanged" />
            </Triggers>
            <ContentTemplate>
                <div style="position:relative;float:left">
                    <b style="font-size:xx-large">Items</b>(<a href="Item.aspx">Add New</a>)
                </div>
                <div style="right:25px;position:absolute; top:30px">
                    Search: <asp:TextBox ID="tb_Search" runat="server" Width="200" OnTextChanged="UpdateGrid" AutoPostBack="true" />
                </div>
                <br />
                <div>
                    <asp:GridView runat="server" AutoGenerateColumns="true" ID="gv_Items" AutoGenerateEditButton="true" AutoGenerateDeleteButton="true" />
                </div>
            </ContentTemplate>
        </asp:UpdatePanel>
    </div>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-17T19:40:18.020

*   当使用 javascript 引发时，您需要`_postback()`为您的文本框控件调用该函数。`onkeyup`
*   但是，由于您的文本框位于更新面板内，因此每次用户按下某个键时都会重新渲染文本框，从而导致光标失去焦点。
*   除非您将文本框从更新面板中取出，否则这将无法使用。这可能对您有用，因为更新面板往往有点慢，您可能仍然存在可用性问题。- 我建议使用自动完成组件。

**PS**：在 asp.net 控制工具包中有一个，或者您可以使用我发现更好一点的 jquery 自动完成插件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-01-08T08:32:12.220

`AutoPostBack="true" OnTextChanged="TextBox1_TextChanged"`

这两个事件都需要触发文本更改事件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-10T07:37:27.117

不需要使用 AJAX 控件来检查可用性.. 它不是强制使用它 AJAX 控件.. 我们可以使用以下代码..

```
<iframe>
<asp:TextBox ID="TextBox1" runat="server" AutoPostBack="true" ontextchanged="TextBox1_TextChanged"></asp:TextBox>

 protected void TextBox1_TextChanged(object sender, EventArgs e)
    {
        RequiredFieldValidator1.ErrorMessage = "";
        Label1.Text = "";
        string name = TextBox1.Text.ToString();
        string constr = "data Source=MURALY-PC\\SQLEXPRESS; database=Online; Integrated Security=SSPI";
        SqlConnection con = new SqlConnection(constr);
        con.Open();
        string query = "select UserName from User_tab where UserName='" + name + "'";
        SqlCommand cmd = new SqlCommand(query, con);
        SqlDataReader dr = cmd.ExecuteReader();
        if (dr.Read())
        {

            Label1.Text = "UserName Already Exists";
        }
        else
        {
            Label1.Text = "";
            Label1.Text = "UserName Available";
        }
        con.Close();

    }
</iframe> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T19:35:42.850

AsyncPostBackTrigger 所做的只是确保在触发事件时仅刷新页面的该部分，而在触发事件时它不会更改。

我认为可以做你想做的事，但你需要编写一些javascript代码来手动触发事件......我什至不想考虑让它工作。

# java - 在 Java 中的数字类上使用 new 和构造函数是否有任何正当理由？

> ID：1009087
> 
> 赞同：2
> 
> 时间：2009-06-17T19:32:55.460
> 
> 标签：java, numbers, constructor

在Java中是否有任何正当理由

```
Long l = new Long(SOME_CONSTANT) 
```

这会创建一个额外的对象并由 FindBugs 标记，这显然是一种不好的做法。我的问题是是否有充分的理由这样做？

我之前[问过这个关于 String 构造函数的问题并得到了一个很好的答案](https://stackoverflow.com/questions/390703/what-is-the-purpose-of-the-expression-new-string-in-java)，但这个答案似乎不适用于数字。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T19:39:57.193

只有当你想确保你得到一个唯一的实例时，所以[实际上]永远不会。

自动装箱时可以缓存某些数字（尽管[`Longs`不保证是](http://java.sun.com/docs/books/jls/third_edition/html/conversions.html#190730)），这可能会导致问题。但是任何会因为缓存而中断的代码都可能存在更深层次的问题。现在，我想不出一个有效的案例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T20:26:26.150

> 我的问题是是否有充分的理由这样做？

如果您想编写与旧 JRE 兼容的代码，您可能仍会使用它。[valueOf(long)](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Long.html#valueOf(long))仅在 Java 1.5 中引入，因此在[Java 1.4](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Long.html#Long(long))和之前的构造函数中是直接从*long*到*Long*的唯一方法。我希望它不会被弃用，因为构造函数仍在内部使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T19:50:26.440

我唯一能想到的是使装箱显式，尽管等效的自动装箱代码实际上被编译成 Long.valueOf(SOME_CONSTANT) 可以缓存小值:(来自 jvm src)

```
 public static Long valueOf(long l) {
    final int offset = 128;
    if (l >= -128 && l <= 127) { // will cache
        return LongCache.cache[(int)l + offset];
    }
        return new Long(l);
  } 
```

. 没什么大不了的，但我不喜欢看到代码不断地装箱和拆箱而不考虑类型，这可能会变得草率。

但是，从功能上讲，我看不出有什么不同。新的 long 仍将计算为等于，并且哈希码等于自动装箱的，所以我看不出如果你愿意的话你怎么能做出功能区分。

# crash - Multi Band Infragistics UltraGrid 行选择问题

> ID：1009090
> 
> 赞同：2
> 
> 时间：2009-06-17T19:33:03.697
> 
> 标签：crash, infragistics, ultrawingrid

我从 SQL 中引入要在多波段超网格中显示的数据。这很好用。它在这方面做了它应该做的事情；但是，如果我尝试在任何波段中选择第一行以外的行，它会冻结程序。

加载网格后，第一行似乎处于活动状态（文本为粗体），因此我尝试对活动行进行更新。这摆脱了活动行，但没有解决问题。

预先感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-19T20:39:54.940

您是否将`BindingList<>`其用作数据源？尝试转换为`List<>`。如果必须使用 BindingList<>，则将 ultragrid 上的 SyncWithCurrencyManager 属性设置为 false。这告诉网格不要将当前行与 CurrencyManager 的当前位置同步

# c++ - 解码JPEG以获得未压缩的数据

> ID：1009091
> 
> 赞同：3
> 
> 时间：2009-06-17T19:33:22.247
> 
> 标签：c++, c, linux, jpeg, decode

我想解码 JPEG 文件并获得 BMP/RGB 格式的未压缩解码输出。我使用的是 GNU/Linux 和 C/C++。

我查看了 libjpeg，但似乎没有任何好的文档可用。所以我的问题是：

1.  关于 libjpeg 的文档在哪里？
2.  你能推荐其他基于 C 的 jpeg 解压缩库吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T19:54:40.707

libjpeg 的文档随源代码一起提供。由于您还没有找到它：

下载源代码存档并打开文件**libjpeg.doc**。这是一个纯 ASCII 文件，而不是 word 文档，所以最好在记事本或其他 ASCII 编辑器中打开它。

还有一些其他的 .doc 文件。不过，它们中的大多数并不那么有趣。

不幸的是，我不能推荐除 libjpeg 之外的任何其他库。我尝试了几个替代方案，但 Libjpeg 总是获胜。一旦你完成了基础知识，就很容易使用。它也是目前最完整和最稳定的 jpeg 库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T19:37:50.053

MagickWand 是 ImageMagick 的 C API：

[http://imagemagick.org/script/magick-wand.php](http://imagemagick.org/script/magick-wand.php)

我没有使用它，但文档看起来相当广泛。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T19:46:28.227

您应该查看 Qt 的 QImage。它有一个非常简单的界面，使这项任务非常容易。每个平台的设置都非常简单。

如果 Qt 太过分了，你可以试试 Magick++ [http://www.imagemagick.org/Magick++/](http://www.imagemagick.org/Magick++/)。它支持类似的操作，也非常适合此类任务。上次使用它时，我在 Windows 上对它的依赖关系有些挣扎，但在 Linux 上不记得有太多麻烦。

对于 Magick++ 的 Image 类，您可能想要的函数是 getConstPixels。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T20:34:44.743

我有您可以复制（或仅用作参考）的代码，用于使用 libjpeg 库加载 jpeg 图像。

您可以在此处浏览代码：[http](http://code.google.com/p/kgui/source/browse/trunk/kguiimage.cpp)

://code.google.com/p/kgui/source/browse/trunk/kguiimage.cpp 只需查找函数**LoadJPGImage**。

该代码设置为处理我的**DataHandle**类与其的 c++ 绑定以加载图像，这样图像就可以是已经在内存中的文件或数据或其他任何东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T20:38:40.180

一个稍微开箱即用的解决方案是获取[netpbm](http://netpbm.sourceforge.net/)工具的副本，该工具通过几种非常简单的中间格式之一将图像从几乎任何格式转换为任何其他格式。它们在 shell 中运行良好，并且最常用于管道中以读取任意图像，对其执行操作，并将其写入其他格式。

pbm 格式可以是简单的 ASCII 标头，后跟 ASCII 或二进制的 RGB 数据。它们旨在足够简单易用，无需库来实现。

netpbm 通过在 libjpeg 之上实现的读写过滤器支持 JPEG。

# php - 基于 2 种类型变量（在 php 中）实现加权随机选择的最佳方法是什么？

> ID：1009092
> 
> 赞同：3
> 
> 时间：2009-06-17T19:33:22.793
> 
> 标签：php, weighting

基本上我的困境是这样的。我有一个托管文件的 x 服务器列表。还有另一台服务器，托管该站点的 mysql 数据库和应用程序。当文件被上传（到前端服务器）时，应用程序会检查哪个服务器上的可用空间最多，并将文件移动到那里。如果您从 2 台以上具有相同可用空间的空服务器开始，这将正常工作。如果您稍后将另一台服务器引入混合中......它将比当前服务器拥有更多的可用空间，这种方法不是那么有效，因为所有新文件都将难以捉摸地上传到新服务器，这会超载因为它将处理大部分新流量，直到它在可用空间方面赶上其余的盒子。

所以我也想引入一个加权系统，这将有助于规范文件的分布。因此，如果 3 台服务器分别设置为 33%，并且其中 1 台服务器的可用空间显着增加，它仍然会比其他服务器获得更多的上传（即使它具有相同的权重），但负载会分散到所有服务器上服务器。

任何人都可以建议一个好的 php-only 实现吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T19:42:28.703

一种方法是将所有有空间保存文件的服务器上的所有可用空间相加（因此显然会排除具有可用空间但不足以保存文件的服务器）。然后确定每个服务器占该空间的百分比（因此新服务器将占比例更大的百分比）。使用随机数并将其与百分比对齐以确定选择哪个服务器。

例如，考虑拥有五个具有以下可用空间级别的服务器：

```
Server 1:   2048MB
Server 2:  51400MB
Server 3:   1134MB
Server 4: 140555MB 
```

您需要存储一个 1500MB 的文件。这使服务器 3 停止运行，给我们留下了 194003MB 的总可用空间。

```
Server 1:  1.0%
Server 2: 26.5%
Server 4: 72.5% 
```

然后选择 0 到 100 之间的随机数：40

```
Numbers between 0 and 1 (inclusive) would go to Server 1
Numbers > 1 and <= 26.5 would go to Server 2
Numbers > 26.5 and <= 100 would go to Server 4 
```

所以在这种情况下，40 表示它存储在服务器 4 上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T19:44:36.343

流量平衡通常非常关键。您可以添加某种加权系统来平衡它（尽管正如您所说，新服务器仍然会比其他服务器过载更多），或者其他一些交替方法，其中一台服务器永远不会连续两次被击中，就像一个例子。

但我想我可能会人为地平衡服务器数据，以便通过将内容从一个移动到另一个来使它们几乎相等，然后让原始或加权/交替算法正常工作。

这不是一个仅 php 的实现，而只是一些需要考虑的想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T19:48:40.983

一种实现方式如下：

1.  在您的情况下，创建一个包含所有空白空间的数组，作为分数 { 0.5, 0.5, 1.0 }
2.  创建第二个权重数组 - 服务器中的空间量除以空间总量，如第一个数组中所示 - { 0.25, 0.25, 0.5 }
3.  通过调用 1.0*mt_rand()/mt_getmaxrand() 获取一个随机数，归一化为 (0.0,1.0)
4.  运行以下循环：

    ```
    $total_weight = 0.0;
    for ( $i = 10; $i <= sizeof($weights); $i++) {
      $total_weight += #weights[$i];
      if($rand <= $total_weight) {
    return $i;
      }
    } 
    ```

返回值是服务器的索引

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T22:40:40.730

您已经进入了[分布式文件系统](http://en.wikipedia.org/wiki/List_of_file_systems#Distributed_file_systems)的世界——一个比您预期的更大的问题空间。

在这个领域已经做了很多工作/研究。您应该考虑使用像[MogileFS](http://www.danga.com/mogilefs/)这样的可用解决方案，或者至少对他们如何解决您遇到的问题（以及您尚未遇到的问题）进行一些研究

举一个我所说的“你还没有遇到的问题”的例子：你不应该实际上存储每个文件的至少 2 个副本，这样如果你失去了一台服务器，你就不会丢失所有文件它？当然，一旦您开始这样做，您是否应该能够同时从多个服务器读取单个文件的部分内容以提高性能？当然，现在你必须弄清楚文件是如何分布的，当服务器出现故障时它们是如何*重新*分布的，当新服务器上线时等等......

做到这一点很复杂。如果可以避免，就不要重新发明轮子。如果你必须重新发明轮子，至少花一些时间看看其他人是如何建造他们的。

# css - CSS：我可以选择不在特定类中的每种类型的元素吗？

> ID：1009094
> 
> 赞同：2
> 
> 时间：2009-06-17T19:33:50.937
> 
> 标签：css, css-selectors

假设我得到了这个页面：

```
<body>
    <h1>Hello!</h1>
    <div class="wrapper">
        <div class="anotherclass">
            <h1>Another heading 1</h1>
        </div>
        <div class="yetanotherclass">
            <h1>Yet another heading 1</h1>
        </div>
    </div>
    <h1>Good bye!</h1>
    <div class="class">
        <h1>Good bye. And this time I mean it.</h1>
    </div>
</body> 
```

我想选择所有`H1`不在`wrapper`-class 中的元素。我怎么能用 CSS 做到这一点？我不想要像这样的“解决方案”

```
body h1, body .class h1 {style definitions} 
```

我更喜欢这种：

```
h1:not(.wrapper > h1) {style definitions} 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T19:35:40.650

如果你做了这样的事情怎么办：

```
h1 { /* rules for everything without the class */ }
h1.class { /* rules for everything with the class */ } 
```

在`h1.class`您将覆盖您在 `h1`规则中定义的所有内容。

这是一个例子：

```
<html>
    <head>
        <style type="text/css">
                div { color:#00f; }
                div.foo { color:#f00; }
        </style>
    </head>
    <body>
        <div class="foo">foo</div>
        <div>bar</div>
        <div>baz</div>
    </body>
</html> 
```

在这个例子中，我有效地定位了所有`divs`没有`foo`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T20:20:12.730

你不能用css做你要求的事情。围绕 css 的整个想法是级联，而您想要做的是反对级联的流程。

随波逐流做常规css：

```
h1 {style definitions}
.wrapper h1 {style definitions} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-17T19:39:30.080

您可以使用通用选择器 * 应用全局样式，然后应用嵌套的通用选择器： .wrapper * 撤消您最初应用的样式

```
* {font-weight:bold; border:thin solid red;}

.wrapper * {font-weight:normal; border: 0px solid white;} 
```

# c++ - 与 MSVC 中的静态库和动态库链接

> ID：1009098
> 
> 赞同：2
> 
> 时间：2009-06-17T19:35:06.410
> 
> 标签：c++, linker, visual-c++

我正在开发一个链接到静态库的 c++ 项目。但是，我想使用英特尔的 TBB，它只能作为动态库使用。我试图在视觉工作室中设置它，但我无法让它工作。如果可能的话，有人有详细的指导吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T20:11:06.740

通常，当一个库作为动态库 (.dll) 提供时，它还附带一个 .lib 文件来链接（如本[问题](https://stackoverflow.com/questions/552248/dll-question-load-time-dynamic-linking-and-run-time-dynamic-linking/552281)中所述）。这可以像静态库一样添加到项目的输入列表中

> 项目属性->配置属性->链接器->输入->附加依赖（在VS2008中）

如果 .lib 不可用，则必须在运行时使用 Win32 API 函数[LoadLibraryEx](http://msdn.microsoft.com/en-us/library/ms684179(VS.85).aspx)加载 .dll，然后随后调用[GetProcAddress](http://msdn.microsoft.com/en-us/library/ms683212(VS.85).aspx)以获取所需函数的地址。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T20:59:55.380

您是在谈论链接到 RUNTIME 库吗？不，您只能链接到一个。您必须更改您的项目，或者您必须重新编译 TBB 以链接到静态运行时。

# c# - 什么 .NET 集合提供最快的搜索

> ID：1009107
> 
> 赞同：154
> 
> 时间：2009-06-17T19:37:20.727
> 
> 标签：c#, .net, search, collections

我有 60k 项需要对照 20k 查找列表进行检查。是否有提供异常快速方法的集合对象（如`List`, ） ？还是我必须自己写？换句话说，默认方法是只扫描每个项目还是使用更好的搜索算法。`HashTable``Contains()``Contains()`

```
foreach (Record item in LargeCollection)
{
    if (LookupCollection.Contains(item.Key))
    {
       // Do something
    }
} 
```

**注意**。查找列表已排序。

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2009-06-17T19:38:51.800

在最一般的情况下，考虑[`System.Collections.Generic.HashSet`](http://msdn.microsoft.com/en-us/library/bb359438.aspx)作为默认的“包含”主力数据结构，因为它需要恒定的时间来评估`Contains`.

“什么是最快的可搜索集合”的实际答案取决于您的特定数据大小、有序性、散列成本和搜索频率。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2009-06-17T19:40:04.370

如果您不需要订购，请尝试`HashSet<Record>`（.Net 3.5 的新手）

如果这样做，请使用 a`List<Record>`并调用`BinarySearch`。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-06-17T19:44:08.357

你考虑过`List.BinarySearch(item)`吗？

您说您的大量收藏品已经分类，所以这似乎是一个绝佳的机会？哈希肯定是最快的，但这会带来自己的问题，并且需要更多的存储开销。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-11-27T07:23:35.770

您应该阅读[这篇博客](http://cc.davelozinski.com/c-sharp/fastest-collection-for-string-lookups)，该博客使用单线程和多线程技术对几种不同类型的集合和方法进行了速度测试。

根据结果​​，List 和 SortedList 上的 BinarySearch 是表现最好的，在将某物作为“价值”查找时不断地并驾齐驱。

当使用允许“键”的集合时，Dictionary、ConcurrentDictionary、Hashset 和 HashTables 的整体表现最好。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-17T20:10:50.283

保持列表 x 和 y 的排序。

如果 x = y，做你的动作，如果 x < y，推进 x，如果 y < x，推进 y，直到任一列表为空。

这个交叉点的运行时间与 min (size (x), size (y)) 成正比

*不要*运行 .Contains () 循环，这与 x * y 成正比，这要糟糕得多。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2021-11-03T20:24:26.210

我一起做了一个测试：

*   第一个 - 3 个字符，包含 A-Z0-9 的所有可能组合
*   用这些字符串填充这里提到的每个集合
*   最后 - 搜索每个集合并为每个集合计时一个随机字符串（每个集合的相同字符串）。

此测试在保证有结果时模拟查找。

[![全系列](../Images/091832f869e1a5045053d2f13382f3b1.png)](https://i.stack.imgur.com/QBXGQ.png)

然后我将初始集合从所有可能的组合更改为仅 10,000 个随机 3 字符组合，这应该会导致随机 3 字符查找的 4.6 命中率中的 1，因此这是一个不能保证结果的测试，并再次运行测试：

[![部分集合](../Images/b9dfd1d6b61891072fdcfc708559e437.png)](https://i.stack.imgur.com/Kiyfu.png)

恕我直言，HashTable 虽然最快，但并不总是最方便的；处理对象。但是 HashSet 离它如此之近，可能是值得推荐的。

只是为了好玩（你知道有趣）我跑了 168 万行（4 个字符）： [![更大的收藏](../Images/1f8f5057b2e6f26c0b35dd2b61c246ed.png)](https://i.stack.imgur.com/1IuC4.png)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-17T19:51:28.357

如果可以对您的项目进行排序，那么有一种更快的方法可以做到这一点，然后对哈希表或 b 树进行键查找。尽管如果您的项目不可排序，则无论如何您都不能真正将它们放入 b-tree 中。

无论如何，如果可对两个列表进行排序，那么只需按顺序遍历查找列表即可。

```
Walk lookup list
   While items in check list <= lookup list item
     if check list item = lookup list item do something
   Move to next lookup list item 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-17T19:57:38.843

如果您使用的是 .Net 3.5，则可以使用以下方法制作更简洁的代码：

```
foreach (Record item in LookupCollection.Intersect(LargeCollection))
{
  //dostuff
} 
```

我这里没有.Net 3.5，所以这是未经测试的。它依赖于扩展方法。不是那`LookupCollection.Intersect(LargeCollection)`可能不一样`LargeCollection.Intersect(LookupCollection)`......后者可能要慢得多。

这假设 LookupCollection 是`HashSet`

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-17T19:48:22.060

如果您不担心每一个性能的最后一点都吱吱作响，那么使用 HashSet 或二进制搜索的建议是可靠的。您的数据集不够大，以至于 99% 的情况下都会出现问题。

但是，如果这只是您要执行此操作的数千次之一并且性能至关重要（并且使用 HashSet/二进制搜索证明是不可接受的），您当然可以编写自己的算法，在排序列表中进行比较。每个列表最多会被遍历一次，并且在病理情况下不会很糟糕（一旦你走这条路，你可能会发现比较，假设它是一个字符串或其他非整数值，将是真正的费用和优化将是下一步）。

# ruby-on-rails - 从相关模型中提取 5 个字段值

> ID：1009112
> 
> 赞同：0
> 
> 时间：2009-06-17T19:37:42.580
> 
> 标签：ruby-on-rails

我有很多网站评论的评论请求。我可以通过以下方式计算给定reviewrequest 在视图中的站点评论数：<%=h request.sitereviews.count.to_s %>

每个站点评论都有一个文本字段 - 建议。有没有办法将最后 5 个 sitereview.suggestions 值作为单个值来表示？类似于：<%=h request.sitereviews.suggestions.last.5.to_s %>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T19:59:28.357

您可以将其添加到 request.rb

```
def latest_suggestions
  suggestions = []
  sitereviews.find(:all, :order => 'created_at desc', :limit => 5).each do |sr|
    suggestions << sr.suggestions
  end
  suggestions.join(',')
end 
```

我猜你的意思是每个网站评论都有建议，你想获得最后 5 条网站评论的建议。

老实说，这一切都很奇怪，不知道你为什么想要这个。

# plone - 如何更新 Plone 插件中的版本号？

> ID：1009115
> 
> 赞同：1
> 
> 时间：2009-06-17T19:37:56.467
> 
> 标签：plone, plone-3.x

Plone 附加组件的版本和安装配置文件编号一直在变化，这非常令人困惑。在一个版本的 Plone 中有效的东西在其他地方不一定有效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T19:38:49.863

Gaer Baekholt 将我指向此页面：[http ://plone.org/documentation/how-to/version-numbers-in-cmfquickinstaller](http://plone.org/documentation/how-to/version-numbers-in-cmfquickinstaller)

# c++ - 是否可以从 COFF 库文件 (.lib) 中去除调试信息？

> ID：1009124
> 
> 赞同：0
> 
> 时间：2009-06-17T19:39:37.773
> 
> 标签：c++, visual-studio, linker

我正在链接许多第 3 方 .lib 文件，并且在链接时收到大量 LNK4099 警告。似乎无法抑制此警告消息，因此我相信如果我从 .lib 文件中删除所有调试信息，则不会显示警告。有没有办法删除调试信息？这些是我没有源代码的库。

我正在使用 VS2005 C++（当然是在 Windows 上）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T21:48:04.410

COFF 格式——在 Unix 上发现，无论如何，组织得相当好。里面有很多部分。还有一个工具，`mcs`用于“操纵评论部分”，可用于删除材料。该工具在 Solaris for ELF（它是 COFF 的扩展）上可用，并且可能在其他地方可用。

这可能意味着您可以找到该程序并将其用于 MS 目标文件。

另一方面，似乎不太可能通过删除调试信息来解决投诉；调试信息不​​应影响程序的运行（或链接）。也就是说，通过谷歌“microsoft lnk4009”找到的信息是非决定性的；出现两个条目，但最终都显示“LNK4099”而不是“LNK4009”消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T20:19:22.530

我认为这是不可能的，至少在没有传统工具的情况下是不可能的。我建议您联系供应商并要求他们在没有调试信息的情况下重建 .lib 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T05:41:03.347

我猜你已经从 MSDN 阅读了这个页面：

[MSDN：链接器工具警告 LNK4099](http://msdn.microsoft.com/en-us/library/b7whw3f3(VS.80).aspx)

链接说“...如果您没有链接对象的 .pdb 文件，请删除 /DEBUG 链接器选项。”

# .net - 获取面板覆盖的 PictureBox 的区域

> ID：1009130
> 
> 赞同：0
> 
> 时间：2009-06-17T19:40:12.280
> 
> 标签：.net, winforms, user-interface

我有两个控件，它们都包含在用户控件中。

*   面板位置：49、400
*   面板尺寸：787、70

*   图片框位置：25, 0
*   图片框尺寸：737、700

图片框位于面板下方。

我可以使用一些关于确定面板覆盖的 PictureBox 图像区域的最佳方法的建议，这样我就可以在 DrawImage 调用中正确地将图像复制到面板上。

我的回答是：我将从该区域复制屏幕：左上角 24,400，宽 714，高 70 但是我如何自动使用面板和图片框的任意组合来实现可重复使用的控件？

如果您需要更多信息，请提供背景：PictureBox 包含地图图像。面板包含用于操作地图的工具，面板位于 PictureBox 顶部。面板需要是半透明的，这样地图图像仍然可以通过它看到。

由于 winforms 绘制透明度的方式，（通过控件树调用以让父级绘制其自身） - 当我绘制面板时，它采用用户控件背景的颜色，而不是它下面的地图图像.

我对此的想法是：如果我可以将面板下方的地图图像复制到面板的背景，然后绘制我的半透明背景，我将能够模拟设计师要求的效果。

面板中的原始代码是我从图片框中获取图像的地方。

```
 Dim x As Integer = GetXOffset()
            Dim y As Integer = GetYOffset()

            Dim sizeOfImage As Size = New Size(ClientRectangle.Width _
                                  , ClientRectangle.Height)
            bmpScreenshot = New Bitmap(sizeOfImage.Width, sizeOfImage.Height, _
                     PixelFormat.Format32bppArgb)

            gfxScreenshot = Graphics.FromImage(bmpScreenshot)
            Dim destrect As New Rectangle(ClientRectangle.X, ClientRectangle.Y, _
                        ClientRectangle.Width, ClientRectangle.Height)

            gfxScreenshot.DrawImage(mPictureBox1.Image, destrect, New Rectangle(x, y, _
               sizeOfImage.Width, sizeOfImage.Height), GraphicsUnit.Pixel) 
```

我将此图像复制到 OnPaint 事件中的背景。

```
If bmpScreenshot Is Nothing Then
            PushScreen()
        End If
        If Not bmpScreenshot Is Nothing Then
            pevent.Graphics.DrawImage(bmpScreenshot, GetPaintOffset())
        End If 
```

最后，在从接受的答案中添加更改之后，这里是抓取图像的修改后的代码。

```
 Dim sizeOfImage As Size = New Size(ClientRectangle.Width _
                                  , ClientRectangle.Height)
            bmpScreenshot = New Bitmap(sizeOfImage.Width, sizeOfImage.Height, PixelFormat.Format32bppArgb)

            gfxScreenshot = Graphics.FromImage(bmpScreenshot)

            Dim rect As Rectangle = Rectangle.Intersect(mPictureBox1.Bounds, Bounds)
            Dim destrect As Rectangle = New Rectangle(rect.Left - Left, _
             rect.Top - Top, rect.Width, rect.Height)
            Dim imgrect As Rectangle = _
              New Rectangle(rect.Left - mPictureBox1.Bounds.Left, _
              rect.Top - mPictureBox1.Bounds.Top, rect.Width, rect.Height)

            gfxScreenshot.DrawImage(mPictureBox1.Image, destrect, _
               imgrect, GraphicsUnit.Pixel) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T19:52:46.967

您可以使用 Rectangle.Intersect 方法（连同一点点计算）来获得您想要的结果。C# 示例：

```
Rectangle rect = Rectangle.Intersect(_pictureBox.Bounds, _panel.Bounds);
rect = new Rectangle(rect.Top - _panel.Top, rect.Left - _panel.Left, rect.Width, rect.Height);
e.Graphics.FillRectangle(Brushes.Red, rect); 
```

**更新**

我对此进行了更多尝试，并提出了以下解决方案，我发现它更简单，也更健壮（这次是 VB.NET 代码）：

```
Private Sub DrawPanelBackground(ByVal pictureBox As PictureBox, ByVal panel As Panel)
    If pictureBox.Image Is Nothing Then
        Exit Sub
    End If

    Dim rect As Rectangle = New Rectangle(pictureBox.Left - panel.Left, pictureBox.Top - panel.Top, pictureBox.Image.Width, pictureBox.Image.Height)
    Using g As Graphics = Panel.CreateGraphics()
        g.DrawImage(pictureBox.Image, rect)
    End Using
End Sub 
```

# mysql - 缺少数据库表 Cakephp

> ID：1009131
> 
> 赞同：3
> 
> 时间：2009-06-17T19:40:12.717
> 
> 标签：mysql, cakephp, permissions

**错误：未找到模型用户的数据库表用户。**

我遇到了上面的错误显示，我不确定为什么会这样。我已经搜索了这个问题的可能解决方案，最流行的解决方案是......转到 app/tmp/cache 目录并删除模型和持久文件夹中的文件。我已经这样做了，但我仍然看到此错误消息。我认为数据库已正确连接，因为我没有看到任何连接错误，并且当我使用错误的登录凭据时，我会看到连接错误消息。我还有一个用户表，所以该表确实存在于数据库中。会不会是我的权限？如果是这样，当我使用 Bluehost 进行托管时如何更改它们。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T19:59:38.513

单击Bluehost 中的**MySql 数据库向导**授予用户权限 duh！

# c++ - stl 向量内存管理

> ID：1009137
> 
> 赞同：1
> 
> 时间：2009-06-17T19:40:55.790
> 
> 标签：c++

我正在使用 borland 2006 c++，并有以下代码。我正在使用向量，并且无法理解为什么不调用析构函数。

基本上我有一个A类

```
class A
{
private:
    TObjectList* list;
    int myid;
public:
 __fastcall A(int);
 __fastcall ~A();
};

__fastcall A::A(int num)
{
    myid = num;
    list = new TObjectList();

}

__fastcall A::~A()
{
    delete list;
}

int main(int argc, char* argv[])
{
    myfunc();
    return 0;
}

void myfunc()
{
    vector<A*> vec;
    vec.push_back(new A(1));
    vec.push_back(new A(2));
} 
```

根据我的阅读，当变量 vec 超出 myfunc() 的范围时，它应该破坏其包含的元素，因此应该调用 A 的析构函数。我在〜A（）处有一个断点，但从未被调用，我尝试过resize（），也有擦除方法

TIA

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-17T19:42:47.220

vec 超出范围时会破坏其元素。这里的问题是 vec 的元素是*指向*A 对象的指针，而不是 A 对象本身。如果你改为

```
vector<A> vec;
vec.push_back(A(1));
vec.push_back(A(2)); 
```

...那么事情就会如你所愿。

ETA：但请注意，如果您这样做，则必须为 A 定义一个复制构造函数。这应该涉及对 TObjectList 成员进行深层复制。否则，当你复制一个 A 对象时，你会得到两个都指向同一个 TObjectList 的对象，并且当第二个对象被销毁时你的程序会崩溃。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T19:43:58.620

没有调用析构函数 for`A`因为你没有`A`. 您有一个指向 的指针向量`A`，并且调用了指针的析构函数。指针没有析构函数，所以什么也没有发生。

删除所有内容的一种方法是手动执行类似的操作

```
while (!vec.empty())
{
    delete vec.back();
    vec.pop_back();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T20:06:56.047

已经有很多好的答案了，但我会再添加一个：

使用来自[Boost Pointer Container Library的](http://www.boost.org/doc/libs/1_39_0/libs/ptr_container/doc/ptr_container.html)**boost::ptr_vector**，而不是 std::vector。当向量超出范围时，它将删除对象，从而调用析构函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T19:55:47.007

抓住 Boost 库，在上面任何有原始指针的地方都可以使用 boost::shared_ptr<> 。（嗯，不在 main() 的签名中。）

# excel - 格式为“YYYY MMM DD 00:00:00.000”的 Excel 日期需要日期为 DD-MMM-YYYY

> ID：1009141
> 
> 赞同：0
> 
> 时间：2009-06-17T19:42:33.617
> 
> 标签：excel, vba

有没有办法编写一个宏来将工作表中的所有日期从“2009 APR 01 00:00:00.000”转换为日期格式“dd-mmm-yyyy”？我有一个定期提取的数据集，40 多列中的所有日期在 2009 年 APR 01 00:00:00.000 中基本上没用，关于如何创建这种类型的宏并能够与其他人共享的任何想法相同数据？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T20:00:27.137

看起来您的日期始终是相同长度的字符串。这是一种可能的解决方案：

```
orgDate = "2009 APR 01 00:00:00.000"

newDate = mid(orgDate,10,2) & "-" & mid(orgDate,6,3) & "-" & left(orgDate,4) 
```

循环遍历每个单元格并执行上述字符串操作，然后将 newDate 放回单元格中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T20:07:49.167

```
 Function GetDateInMyFormat(exampleDate As String) As Date
On Error GoTo e
Dim year As String
Dim month As String
Dim day As String

Dim wantedDate As String

year = Mid(exampleDate, 1, 4)
month = Mid(exampleDate, 6, 3)
day = Mid(exampleDate, 10, 2)

wantedDate = year & "/" & month & "/" & day
GetDateInMyFormat = CDate(wantedDate)
Exit Function

e:

End Function 

```

您可以创建一个 XLA（XL 插件）并将此函数添加为 XL VBA 的一部分。
使用 excel 的插件对话框加载插件。这样，该功能将可用于工作簿。

而且，您可以在您的单元格上使用此功能，就像任何其他功能一样。
让我知道，如果您遇到任何问题。

用法：GetDateInMyFormat("2009 apr 01 00:00:00.000")
返回2009 年 4 月 1 日

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T19:48:22.247

假设 Excel 将它们识别为日期，您只需将单元格格式更改为正确的日期格式。突出显示列，右键单击-> 格式化单元格...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T19:51:35.580

我没有给你完整的答案，但这是我大致要做的：

1.  获取整个电子表格的范围，以便您了解必须迭代的内容。
2.  遍历每个单元格。
3.  在每个单元格上时，检查它是否已经是日期格式。
4.  如果单元格格式已经是日期格式，则使用以下代码：Selection.NumberFormat = "dd-mmm-yyyy"。
5.  如果没有，则继续下一个单元格。

祝你好运！

# c++ - C++/OpenGL - 旋转一个矩形

> ID：1009150
> 
> 赞同：6
> 
> 时间：2009-06-17T19:44:19.917
> 
> 标签：c++, opengl, rotation

对于我的项目，我需要旋转一个矩形。我想，这很容易，但是运行它时我会遇到不可预测的行为..

这是代码：

```
 glPushMatrix();
    glRotatef(30.0f, 0.0f, 0.0f, 1.0f);
    glTranslatef(vec_vehicle_position_.x, vec_vehicle_position_.y, 0);
    glEnable(GL_TEXTURE_2D);
    glEnable(GL_BLEND);
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
    glBegin(GL_QUADS);

        glTexCoord2f(0.0f, 0.0f);
        glVertex2f(0, 0);
        glTexCoord2f(1.0f, 0.0f);
        glVertex2f(width_sprite_, 0);
        glTexCoord2f(1.0f, 1.0f);
        glVertex2f(width_sprite_, height_sprite_);
        glTexCoord2f(0.0f, 1.0f);
        glVertex2f(0, height_sprite_);

    glEnd();
    glDisable(GL_BLEND);
    glDisable(GL_TEXTURE_2D);
    glPopMatrix(); 
```

问题在于，我的矩形在旋转时正在窗口中的某处进行平移。换句话说，矩形不保持位置 :`vec_vehicle_position_.x`和`vec_vehicle_position_.y`.

有什么问题 ？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T19:51:39.917

您需要翻转转换的顺序：

```
glRotatef(30.0f, 0.0f, 0.0f, 1.0f);
glTranslatef(vec_vehicle_position_.x, vec_vehicle_position_.y, 0); 
```

变成

```
glTranslatef(vec_vehicle_position_.x, vec_vehicle_position_.y, 0);
glRotatef(30.0f, 0.0f, 0.0f, 1.0f); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-18T01:39:12.507

详细说明以前的答案。

OpenGL 中的转换是通过矩阵乘法执行的。在您的示例中，您有：

M_r_ - 旋转变换

M_t_ - 平移变换

v - 一个顶点

并且您已按顺序应用它们：

M_r_ * M_t_ * v

使用括号来说明：

(M_r_ * (M_t_ * v))

我们看到顶点首先被更接近的矩阵转换，在这种情况下是平移。这可能有点违反直觉，因为这要求您按照与您希望它们应用的顺序相反的顺序指定转换。但是如果您考虑如何将转换放置在矩阵堆栈上，它应该希望更有意义（堆栈预乘在一起）。

因此，为什么为了获得您想要的结果，您需要以相反的顺序指定转换。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-18T01:46:20.810

Inertiatic 提供了非常好的响应。从代码的角度来看，您的转换将以它们出现的相反顺序发生。换句话说，将首先应用更接近实际绘图代码的变换。

例如：
`glRotate();`
`glTranslate();`
`glScale();`
`drawMyThing();`

Will first scale your thing, then translate it, then rotate it. You effectively need to "read your code backwards" to figure out which transforms are being applied in which order. Also keep in mind what the state of these transforms is when you push and pop the model-view stack.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T19:47:43.810

确保在平移之前应用旋转。

# c# - 如何从 XML 架构创建 SQL Server 表架构？（使用 .NET 和 Visual Studio 2008）

> ID：1009154
> 
> 赞同：3
> 
> 时间：2009-06-17T19:44:54.393
> 
> 标签：c#, .net, sql-server, xml, sql-server-2005

我有一个 XML 模式，并且我知道“xsd.exe”可以为其生成 C# 代码。但我想知道是否可以借助此工具或其他工具从 XSD 自动创建 MS SQL Server 2005+ 表。

顺便说一句~~，我没有得到“xsd.exe”生成的 C# 代码的价值。~~ CodeXS 和 xsd.exe 生成的代码有什么区别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-10-14T10:11:37.623

您可以使用 XSD2DB 实用程序

这是示例 xsd2db.exe -f true -l [服务器名称] -n [数据库名称] -s D:\po.xsd -t sql

帮助链接 [http://xsd2db.sourceforge.net/](http://xsd2db.sourceforge.net/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T09:23:45.663

免责声明：我自己没有这样做，但不久前当我考虑这样做时，我将这些链接加入了书签。这家伙的 T-SQL 通常很出色，所以我强烈推荐它：

[http://weblogs.sqlteam.com/peterl/archive/2009/03/05/Extract-XML-structure-automatically.aspx](http://weblogs.sqlteam.com/peterl/archive/2009/03/05/Extract-XML-structure-automatically.aspx)

[http://weblogs.sqlteam.com/peterl/archive/2009/06/04/Extract-XML-structure-automatically-part-2.aspx](http://weblogs.sqlteam.com/peterl/archive/2009/06/04/Extract-XML-structure-automatically-part-2.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T12:12:06.260

> 顺便说一句，我没有得到“xsd.exe”生成的 C# 代码的价值。

我假设您的意思是“我不明白生成的代码有什么用”

它生成的代码的目的是使用 .NET 中的 Microsoft 序列化子系统进行序列化。如果你创建了一个新的 XmlSerializer(typeof(GeneratedType))，那么你可以在它上面调用 Serialize() 和 Deserialze() 来去往/来自 Xml 和对象。

在更复杂的代码生成器（例如 CodeXS）中，它变得更加容易，因为它们会为您生成帮助器：GeneratedType.FromXML(Stream/String) 用于反序列化和 myGeneratedType.Xml 用于序列化。

这些生成的类允许您处理已发布的模式，并且完全相信生成的符合该模式的任何 XML 都将使用这些类型进行解析和生成。您不需要做任何工作来从 XML 中获取数据（即没有 XML DOM 访问），并且您不需要三思而后行地生成与您的模式兼容的 XML。它只是工作:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T19:46:08.710

只要您能够成功解析 XML 模式，您就应该能够创建适当的数据库脚本并执行它们，从而创建您的表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-15T14:30:43.367

我知道这是一个老话题，但是知道如何做到这一点对我很有帮助。也许这对其他人会有所帮助。

[更多高级示例可以在 Microsoft 页面上看到。](https://docs.microsoft.com/en-us/sql/relational-databases/sqlxml-annotated-xsd-schemas-xpath-queries/sqlxml-4-0-net-framework-support-using-bulk-load?view=sql-server-ver15)

因此，可以从 XSD 手动创建 SQL 表。例如，我们有以下 xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<foo>
   <row>
      <CAR_NUM>624</CAR_NUM>
      <CAR_ORDER>1</CAR_ORDER>      
   </row>
   <row>
      <CAR_NUM>623</CAR_NUM>
      <CAR_ORDER>2</CAR_ORDER>      
   </row>
   <row>
      <CAR_NUM>681</CAR_NUM>
      <CAR_ORDER>3</CAR_ORDER>      
   </row>
   <row>
      <CAR_NUM>625</CAR_NUM>
      <CAR_ORDER>4</CAR_ORDER>      
   </row>
   <row>
      <CAR_NUM>680</CAR_NUM>
      <CAR_ORDER>5</CAR_ORDER>      
   </row>
</foo> 
```

所以 XSD 看起来像这样：

```
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"  
            xmlns:sql="urn:schemas-microsoft-com:mapping-schema">  
    <xsd:element name="row" sql:relation="CAR"   
                            sql:key-fields="CAR_NUM">  
        <xsd:complexType> 
            <xsd:sequence>
                <xsd:element name="CAR_NUM"   type="xsd:integer" />   
                <xsd:element name="CAR_ORDER"   type="xsd:integer" />  
            </xsd:sequence>
        </xsd:complexType>
    </xsd:element>

</xsd:schema> 
```

SQL 表将如下所示：

```
CREATE TABLE CAR (  
    CAR_NUM   INT ,  
    CAR_ORDER INT 
GO 
```

然后您可以使用`Interop.SQLXMLBULKLOADLib`库将数据加载到 SQLServer 中：

```
try
{       
    var xmlFileName = @".your address here..\GetInformReplyEdited.xml";
    var xsdScheme = @".your address here..\scheme.xsd";

    var connString = "Provider=sqloledb;server=yourServer;database=Test;integrated security=SSPI";
    SQLXMLBULKLOADLib.SQLXMLBulkLoad4Class objBL = new SQLXMLBULKLOADLib.SQLXMLBulkLoad4Class
    {
        ConnectionString = connString,
        ErrorLogFile = "error.xml",
        KeepIdentity = false
    };
    objBL.Execute(xsdScheme, xmlFileName);
}
catch (Exception e)
{
    Console.WriteLine(e.ToString());
} 
```

# algorithm - 反转字符串中单词的顺序

> ID：1009160
> 
> 赞同：68
> 
> 时间：2009-06-17T19:45:57.743
> 
> 标签：algorithm, data-structures, string

我有这个`string s1 = "My name is X Y Z"`，我想颠倒单词的顺序，这样`s1 = "Z Y X is name My"`.

我可以使用一个额外的数组来做到这一点。我想了想，但是否可以就地完成（不使用额外的数据结构）并且时间复杂度为 O(n)？

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2009-06-17T19:48:23.713

反转整个字符串，然后反转每个单词的字母。

第一次通过后，字符串将是

```
s1 = "Z Y X si eman yM" 
```

在第二遍之后它将是

```
s1 = "Z Y X is name My" 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-06-17T20:21:55.550

**反转字符串，然后在第二遍中反转每个单词...**

在 c# 中，完全就地，无需额外的数组：

```
static char[] ReverseAllWords(char[] in_text)
{
    int lindex = 0;
    int rindex = in_text.Length - 1;
    if (rindex > 1)
    {
        //reverse complete phrase
        in_text = ReverseString(in_text, 0, rindex);

        //reverse each word in resultant reversed phrase
        for (rindex = 0; rindex <= in_text.Length; rindex++)
        {
            if (rindex == in_text.Length || in_text[rindex] == ' ')
            {
                in_text = ReverseString(in_text, lindex, rindex - 1);
                lindex = rindex + 1;
            }
        }
    }
    return in_text;
}

static char[] ReverseString(char[] intext, int lindex, int rindex)
{
    char tempc;
    while (lindex < rindex)
    {
        tempc = intext[lindex];
        intext[lindex++] = intext[rindex];
        intext[rindex--] = tempc;
    }
    return intext;
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-06-17T19:57:42.870

```
Not exactly in place, but anyway: Python:

>>> a = "These pretzels are making me thirsty"
>>> " ".join(a.split()[::-1])
'thirsty me making are pretzels These' 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2011-04-17T18:06:03.483

在 Smalltalk 中：

```
'These pretzels are making me thirsty' subStrings reduce: [:a :b| b, ' ', a] 
```

我知道没有人关心 Smalltalk，但它对我来说太美了。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-17T20:26:17.053

如果没有至少一些额外的数据结构，您就无法进行反转。我认为在交换字母时，最小的结构将是单个字符作为缓冲区。它仍然可以被认为是“就地”，但它并不是完全“没有额外的数据结构”。

下面是实现 Bill the Lizard 描述的代码：

```
string words = "this is a test";

// Reverse the entire string
for(int i = 0; i < strlen(words) / 2; ++i) {
  char temp = words[i];
  words[i] = words[strlen(words) - i];
  words[strlen(words) - i] = temp;
}

// Reverse each word
for(int i = 0; i < strlen(words); ++i) {
  int wordstart = -1;
  int wordend = -1;
  if(words[i] != ' ') {
    wordstart = i;
    for(int j = wordstart; j < strlen(words); ++j) {
      if(words[j] == ' ') {
        wordend = j - 1;
        break;
      }
    }
    if(wordend == -1)
      wordend = strlen(words);
    for(int j = wordstart ; j <= (wordend + wordstart) / 2 ; ++j) {
      char temp = words[j];
      words[j] = words[wordend - (j - wordstart)];
      words[wordend - (j - wordstart)] = temp;
    }
    i = wordend;
  }
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-17T19:51:31.697

什么语言？如果是 PHP，您可以在空间上爆炸，然后将结果传递给 array_reverse。

如果它不是 PHP，你将不得不做一些稍微复杂的事情，比如：

```
words = aString.split(" ");
for (i = 0; i < words.length; i++) {
    words[i] = words[words.length-i];
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-17T20:27:37.597

```
public static String ReverseString(String str)
{
    int word_length = 0;
    String result = "";
    for (int i=0; i<str.Length; i++)
    {
        if (str[i] == ' ')
        {
            result = " " + result;
            word_length = 0;
        } else 
        {
            result = result.Insert(word_length, str[i].ToString());
            word_length++;
        }
    }
    return result;
} 
```

这是 C# 代码。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-05-05T10:04:18.463

```
In Python...

ip = "My name is X Y Z"
words = ip.split()
words.reverse()
print ' '.join(words) 
```

无论如何，cookamunga 使用 python 提供了很好的内联解决方案！

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-02-08T16:41:47.903

```
class Program
{
    static void Main(string[] args)
    {
        string s1 =" My Name varma:;
        string[] arr = s1.Split(' ');
        Array.Reverse(arr);
        string str = string.Join(" ", arr);
        Console.WriteLine(str);
        Console.ReadLine();

    }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-01-08T14:04:28.103

这是假设所有单词都用空格分隔：

```
#include <stdio.h>
#include <string.h>

int main()
{
    char string[] = "What are you looking at";
    int i, n = strlen(string);

    int tail = n-1;
    for(i=n-1;i>=0;i--)
    {
        if(string[i] == ' ' || i == 0)
        {
            int cursor = (i==0? i: i+1);
            while(cursor <= tail)
                printf("%c", string[cursor++]);
            printf(" ");
            tail = i-1;
        }
    }
    return 0;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-11-10T13:24:07.650

这并不完美，但它现在对我有用。我不知道它是否有 O(n) 运行时间顺便说一句（仍在研究它^^），但它使用一个额外的数组来完成任务。

这可能不是您问题的最佳答案，因为我使用 dest 字符串来保存反转版本，而不是替换源字符串中的每个单词。问题是我使用了一个名为 buf 的本地堆栈变量来复制所有单词，我不能复制而是复制到源字符串中，因为如果源字符串是 const char * 类型，这将导致崩溃。

但这是我第一次尝试写 s.th。像这样 :) 好的 blablub。这是代码：

```
#include <iostream>
using namespace std;

void reverse(char *des, char * const s);
int main (int argc, const char * argv[])
{    
    char* s = (char*)"reservered. rights All Saints. The 2011 (c) Copyright 11/10/11 on Pfundstein Markus by Created";
    char *x = (char*)"Dogfish! White-spotted Shark, Bullhead";

    printf("Before: |%s|\n", x);
    printf("Before: |%s|\n", s);

    char *d = (char*)malloc((strlen(s)+1)*sizeof(char));  
    char *i = (char*)malloc((strlen(x)+1)*sizeof(char));

    reverse(d,s);
    reverse(i,x);

    printf("After: |%s|\n", i);
    printf("After: |%s|\n", d);

    free (i);
    free (d);

    return 0;
}

void reverse(char *dest, char *const s) {
    // create a temporary pointer
    if (strlen(s)==0) return;
    unsigned long offset = strlen(s)+1;

    char *buf = (char*)malloc((offset)*sizeof(char));
    memset(buf, 0, offset);

    char *p;
    // iterate from end to begin and count how much words we have
    for (unsigned long i = offset; i != 0; i--) {
        p = s+i;
        // if we discover a whitespace we know that we have a whole word
        if (*p == ' ' || *p == '\0') {
            // we increment the counter
            if (*p != '\0') {
                // we write the word into the buffer
                ++p;
                int d = (int)(strlen(p)-strlen(buf));
                strncat(buf, p, d);
                strcat(buf, " ");
            }
        }
    }

    // copy the last word
    p -= 1;
    int d = (int)(strlen(p)-strlen(buf));
    strncat(buf, p, d);
    strcat(buf, "\0");

    // copy stuff to destination string
    for (int i = 0; i < offset; ++i) {
        *(dest+i)=*(buf+i);
    }

    free(buf);
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-01-27T17:06:04.480

我们可以将字符串插入堆栈中，当我们提取单词时，它们将以相反的顺序排列。

```
void ReverseWords(char Arr[])
{
    std::stack<std::string> s;
    char *str;
    int length = strlen(Arr);
    str = new char[length+1];
    std::string ReversedArr;
    str = strtok(Arr," ");
    while(str!= NULL)
    {
        s.push(str);
        str = strtok(NULL," ");
    }
    while(!s.empty())
    {
        ReversedArr = s.top();
        cout << " " << ReversedArr;
        s.pop();
    }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2012-08-13T14:35:43.847

这个快速程序有效..虽然不检查极端情况。

```
#include <stdio.h>
#include <stdlib.h>
struct node
{
    char word[50];
    struct node *next;
};
struct stack
{
    struct node *top;
};
void print (struct stack *stk);
void func (struct stack **stk, char *str);
main()
{
    struct stack *stk = NULL;
    char string[500] = "the sun is yellow and the sky is blue";
    printf("\n%s\n", string);
    func (&stk, string);
    print (stk);
}
void func (struct stack **stk, char *str)
{
    char *p1 = str;
    struct node *new = NULL, *list = NULL;
    int i, j;
    if (*stk == NULL)
    {
        *stk = (struct stack*)malloc(sizeof(struct stack));
        if (*stk == NULL)
            printf("\n####### stack is not allocated #####\n");
        (*stk)->top = NULL;
    }
    i = 0;
    while (*(p1+i) != '\0')
    {
        if (*(p1+i) != ' ')
        {
            new = (struct node*)malloc(sizeof(struct node));
            if (new == NULL)
                printf("\n####### new is not allocated #####\n");
            j = 0;
            while (*(p1+i) != ' ' && *(p1+i) != '\0')
            {
                new->word[j] = *(p1 + i);
                i++;
                j++;
            }
            new->word[j++] = ' ';
            new->word[j] = '\0';
            new->next = (*stk)->top;
            (*stk)->top = new;
        }
        i++;
   }
}
void print (struct stack *stk)
{
    struct node *tmp = stk->top;
    int i;
    while (tmp != NULL)
    {
        i = 0;
        while (tmp->word[i] != '\0')
        {
            printf ("%c" , tmp->word[i]);
            i++;
        }
        tmp = tmp->next;
    }
    printf("\n");
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-11-06T03:21:32.583

这些答案中的大多数都没有考虑到输入字符串中的前导和/或尾随空格。考虑以下情况`str=" Hello world"`......反转整个字符串和反转单个单词的简单算法最终会翻转定界符，从而导致`f(str) == "world Hello "`.

OP说“我想颠倒单词的顺序”并没有提到前导和尾随空格也应该翻转！所以，虽然已经有很多答案，但我会在 C++ 中提供一个 [希望] 更正确的答案：

```
#include <string>
#include <algorithm>

void strReverseWords_inPlace(std::string &str)
{
  const char delim = ' ';
  std::string::iterator w_begin, w_end;
  if (str.size() == 0)
    return;

  w_begin = str.begin();
  w_end   = str.begin();

  while (w_begin != str.end()) {
    if (w_end == str.end() || *w_end == delim) {
      if (w_begin != w_end)
        std::reverse(w_begin, w_end);
      if (w_end == str.end())
        break;
      else
        w_begin = ++w_end;
    } else {
      ++w_end;
    }
  }

  // instead of reversing str.begin() to str.end(), use two iterators that
  // ...represent the *logical* begin and end, ignoring leading/traling delims
  std::string::iterator str_begin = str.begin(), str_end = str.end();
  while (str_begin != str_end && *str_begin == delim)
    ++str_begin;
  --str_end;
  while (str_end != str_begin && *str_end == delim)
    --str_end;
  ++str_end;
  std::reverse(str_begin, str_end);
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-03-07T08:21:26.570

我使用堆栈的版本：

```
public class Solution {
    public String reverseWords(String s) {
        StringBuilder sb = new StringBuilder();
        String ns= s.trim();
        Stack<Character> reverse = new Stack<Character>();
        boolean hadspace=false;

        //first pass
        for (int i=0; i< ns.length();i++){
            char c = ns.charAt(i);
            if (c==' '){
                if (!hadspace){
                    reverse.push(c);
                    hadspace=true;
                }
            }else{
                hadspace=false;
                reverse.push(c);
            }
        }
        Stack<Character> t = new Stack<Character>();
        while (!reverse.empty()){
            char temp =reverse.pop();
            if(temp==' '){
                //get the stack content out append to StringBuilder
                while (!t.empty()){
                    char c =t.pop();
                    sb.append(c);
                }
                sb.append(' ');
            }else{
                //push to stack
                t.push(temp);
            }
        }
        while (!t.empty()){
            char c =t.pop();
            sb.append(c);
        }
        return sb.toString();
    }
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-12-17T19:23:09.503

将每个单词作为字符串存储在数组中，然后从末尾打印

```
public void rev2() {
    String str = "my name is ABCD";
    String A[] = str.split(" ");

    for (int i = A.length - 1; i >= 0; i--) {
        if (i != 0) {
            System.out.print(A[i] + " ");
        } else {
            System.out.print(A[i]);
        }
    }

} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-09-26T00:24:37.390

在 Python 中，如果不能使用 [::-1] 或 reversed()，下面是简单的方法：

```
def reverse(text):

  r_text = text.split(" ")
  res = []
  for word in range(len(r_text) - 1, -1, -1): 
    res.append(r_text[word])

  return " ".join(res)

print (reverse("Hello World"))

>> World Hello
[Finished in 0.1s] 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-01-28T09:08:28.293

使用 C# 以给定语句的相反顺序打印单词：

```
 void ReverseWords(string str)
    {
        int j = 0;
        for (int i = (str.Length - 1); i >= 0; i--)
        {
            if (str[i] == ' ' || i == 0)
            {
                j = i == 0 ? i : i + 1;

                while (j < str.Length && str[j] != ' ')
                    Console.Write(str[j++]);
                Console.Write(' ');
            }
        }
    } 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2018-11-08T15:19:48.840

**这是Java实现：**

```
public static String reverseAllWords(String given_string)
{
    if(given_string == null || given_string.isBlank())
        return given_string;

    char[] str = given_string.toCharArray();
    int start = 0;

    // Reverse the entire string
    reverseString(str, start, given_string.length() - 1);

    // Reverse the letters of each individual word
    for(int end = 0; end <= given_string.length(); end++)
    {
        if(end == given_string.length() || str[end] == ' ')
        {
            reverseString(str, start, end-1);
            start = end + 1;
        }
    }
    return new String(str);
}

// In-place reverse string method
public static void reverseString(char[] str, int start, int end)
{
    while(start < end)
    {
        char temp = str[start];
        str[start++] = str[end];
        str[end--] = temp;
    }
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-06-17T20:06:46.267

其实第一个答案：

```
words = aString.split(" ");
for (i = 0; i < words.length; i++) {
    words[i] = words[words.length-i];
} 
```

不起作用，因为它在循环的后半部分撤消了它在前半部分所做的工作。所以， i < words.length/2 会起作用，但更清楚的例子是：

```
words = aString.split(" "); // make up a list
i = 0; j = words.length - 1; // find the first and last elements
while (i < j) {
    temp = words[i]; words[i] = words[j]; words[j] = temp; //i.e. swap the elements
    i++; 
    j--;
} 
```

注意：我不熟悉 PHP 语法，我猜到了增量器和减量器的语法，因为它似乎类似于 Perl。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-06-17T20:29:26.503

怎么样 ...

```
var words = "My name is X Y Z";
var wr = String.Join( " ", words.Split(' ').Reverse().ToArray() ); 
```

我想这不是在线的。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-06-17T21:46:50.807

在 c 中，您可能会这样做，O(N) 并且仅使用 O(1) 数据结构（即 char）。

```
#include<stdio.h>
#include<stdlib.h>
main(){
  char* a = malloc(1000);
  fscanf(stdin, "%[^\0\n]", a);
  int x = 0, y;
  while(a[x]!='\0')
  {
    if (a[x]==' ' || a[x]=='\n')
    {
      x++;
    }
    else
    {
      y=x;
      while(a[y]!='\0' && a[y]!=' ' && a[y]!='\n')
      { 
        y++;
      }
      int z=y;
      while(x<y)
      {
        y--;
        char c=a[x];a[x]=a[y];a[y]=c; 
        x++;
      }
      x=z;
    }
  }

  fprintf(stdout,a);
  return 0;
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2010-11-27T17:40:26.377

```
import java.util.Scanner;

public class revString {
   static char[] str;

   public static void main(String[] args) {
    //Initialize string
    //str = new char[] { 'h', 'e', 'l', 'l', 'o', ' ', 'a', ' ', 'w', 'o',
    //'r', 'l', 'd' };
    getInput();

    // reverse entire string
    reverse(0, str.length - 1);

    // reverse the words (delimeted by space) back to normal
    int i = 0, j = 0;
    while (j < str.length) {

        if (str[j] == ' ' || j == str.length - 1) {

            int m = i;
            int n;

            //dont include space in the swap. 
            //(special case is end of line)
            if (j == str.length - 1)
                n = j;
            else
                n = j -1;

            //reuse reverse
            reverse(m, n);

            i = j + 1;

        }
        j++;
    }

    displayArray();
}

private static void reverse(int i, int j) {

    while (i < j) {

        char temp;
        temp = str[i];
        str[i] = str[j];
        str[j] = temp;

        i++;
        j--;
    }
}
private static void getInput() {
    System.out.print("Enter string to reverse: ");
    Scanner scan = new Scanner(System.in);
    str = scan.nextLine().trim().toCharArray(); 
}

private static void displayArray() {
    //Print the array
    for (int i = 0; i < str.length; i++) {
        System.out.print(str[i]);
    }
} 
```

}

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2011-03-07T23:19:44.713

使用 sscanf 可以更简单地完成：

```
void revertWords(char *s);
void revertString(char *s, int start, int n);
void revertWordsInString(char *s);

void revertString(char *s, int start, int end)
{
     while(start<end)
     {
         char temp = s[start];
         s[start] = s[end];
         s[end]=temp;
         start++;
         end --;
     }
}

void revertWords(char *s)
{
  int start = 0;

  char *temp = (char *)malloc(strlen(s) + 1);
  int numCharacters = 0;
  while(sscanf(&s[start], "%s", temp) !=EOF)
  {
      numCharacters = strlen(temp);

      revertString(s, start, start+numCharacters -1);
      start = start+numCharacters + 1;
      if(s[start-1] == 0)
      return;

  }
  free (temp);

}

void revertWordsInString(char *s)
{
   revertString(s,0, strlen(s)-1);
   revertWords(s);
}

int main()
{
   char *s= new char [strlen("abc deff gh1 jkl")+1];
   strcpy(s,"abc deff gh1 jkl");
   revertWordsInString(s);
   printf("%s",s);
   return 0;
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2012-01-04T20:09:33.840

在 Java 中使用附加字符串（使用 StringBuilder）：

```
public static final String reverseWordsWithAdditionalStorage(String string) {
    StringBuilder builder = new StringBuilder();

    char c = 0;
    int index = 0;
    int last = string.length();
    int length = string.length()-1;
    StringBuilder temp = new StringBuilder();
    for (int i=length; i>=0; i--) {
        c = string.charAt(i);
        if (c == SPACE || i==0) {
            index = (i==0)?0:i+1;
            temp.append(string.substring(index, last));
            if (index!=0) temp.append(c);
            builder.append(temp);
            temp.delete(0, temp.length());
            last = i;
        }
    }

    return builder.toString();
} 
```

在 Java 中就地：

```
public static final String reverseWordsInPlace(String string) {
    char[] chars = string.toCharArray();

    int lengthI = 0;
    int lastI = 0;
    int lengthJ = 0;
    int lastJ = chars.length-1;

    int i = 0;
    char iChar = 0;
    char jChar = 0;
    while (i<chars.length && i<=lastJ) {
        iChar = chars[i];
        if (iChar == SPACE) {
            lengthI = i-lastI;
            for (int j=lastJ; j>=i; j--) {
                jChar = chars[j];
                if (jChar == SPACE) {
                    lengthJ = lastJ-j;
                    swapWords(lastI, i-1, j+1, lastJ, chars);
                    lastJ = lastJ-lengthI-1;
                    break;
                }
            }
            lastI = lastI+lengthJ+1;
            i = lastI;
        } else {
            i++;
        }
    }

    return String.valueOf(chars);
}

private static final void swapWords(int startA, int endA, int startB, int endB, char[] array) {
    int lengthA = endA-startA+1;
    int lengthB = endB-startB+1;

    int length = lengthA;
    if (lengthA>lengthB) length = lengthB;

    int indexA = 0;
    int indexB = 0;
    char c = 0;
    for (int i=0; i<length; i++) {
        indexA = startA+i;
        indexB = startB+i;

        c = array[indexB];
        array[indexB] = array[indexA];
        array[indexA] = c;
    }

    if (lengthB>lengthA) {
        length = lengthB-lengthA;
        int end = 0;
        for (int i=0; i<length; i++) {
            end = endB-((length-1)-i);
            c = array[end];
            shiftRight(endA+i,end,array);
            array[endA+1+i] = c;
        }
    } else if (lengthA>lengthB) {
        length = lengthA-lengthB;
        for (int i=0; i<length; i++) {
            c = array[endA];
            shiftLeft(endA,endB,array);
            array[endB+i] = c;
        }
    }
}

private static final void shiftRight(int start, int end, char[] array) {
    for (int i=end; i>start; i--) {
        array[i] = array[i-1];
    }
}

private static final void shiftLeft(int start, int end, char[] array) {
    for (int i=start; i<end; i++) {
        array[i] = array[i+1];
    }
} 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2012-01-12T18:35:57.073

c#在句子中反转单词的解决方案

```
using System;
class helloworld {
    public void ReverseString(String[] words) {
        int end = words.Length-1;
        for (int start = 0; start < end; start++) {
            String tempc;
            if (start < end ) {
                tempc = words[start];
                words[start] = words[end];
                words[end--] = tempc;
            }
        }
        foreach (String s1 in words) {
            Console.Write("{0} ",s1);
        }
    }
}
class reverse {
    static void Main() {
        string s= "beauty lies in the heart of the peaople";
        String[] sent_char=s.Split(' ');
        helloworld h1 = new helloworld();
        h1.ReverseString(sent_char);
    }
} 
```

输出：人民心中的美丽 按任意键继续。. .

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2012-01-30T14:43:39.137

这是一个 C 实现，它正在执行单词 reversing inlace，它具有`O(n)`复杂性。

```
char* reverse(char *str, char wordend=0)
{
    char c;
    size_t len = 0;
    if (wordend==0) {
        len = strlen(str);
    }
    else {
        for(size_t i=0;str[i]!=wordend && str[i]!=0;i++)
            len = i+1;
    }
            for(size_t i=0;i<len/2;i++) {
                c = str[i];
                str[i] = str[len-i-1];
                str[len-i-1] = c;
            }
    return str;
}

char* inplace_reverse_words(char *w)
{
    reverse(w); // reverse all letters first
    bool is_word_start = (w[0]!=0x20);

    for(size_t i=0;i<strlen(w);i++){
        if(w[i]!=0x20 && is_word_start) {
            reverse(&w[i], 0x20); // reverse one word only
            is_word_start = false;
        }
        if (!is_word_start && w[i]==0x20) // found new word
            is_word_start = true;
    }
    return w;
} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2012-04-15T20:41:35.243

更好的版本
检查我的博客[http://bamaraculibaly.blogspot.co.uk/2012/04/19-reverse-order-of-words-in-text.html](http://bamaracoulibaly.blogspot.co.uk/2012/04/19-reverse-order-of-words-in-text.html)

```
public string reverseTheWords(string description)
{
    if(!(string.IsNullOrEmpty(description)) && (description.IndexOf(" ") > 1))
    {
        string[] words= description.Split(' ');
        Array.Reverse(words);
        foreach (string word in words)
        {
            string phrase = string.Join(" ", words);
            Console.WriteLine(phrase);
        }
        return phrase;
    }
    return description;
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2012-08-16T10:08:37.177

```
public class manip{

public static char[] rev(char[] a,int left,int right) {
    char temp;
    for (int i=0;i<(right - left)/2;i++)    {
        temp = a[i + left];
        a[i + left] = a[right -i -1];
        a[right -i -1] = temp;
    }

    return a;
}
public static void main(String[] args) throws IOException {

    String s= "i think this works";
    char[] str = s.toCharArray();       
    int i=0;
    rev(str,i,s.length());
    int j=0;
    while(j < str.length) {
        if (str[j] != ' ' && j != str.length -1) {
            j++;
        } else
        {
            if (j == (str.length -1))   {
                j++;
            }
            rev(str,i,j);
            i=j+1;
            j=i;
        }
    }
    System.out.println(str);
} 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2012-08-22T06:29:04.150

我知道有几个正确的答案。这是我想出的C语言。这是例外答案的实现。时间复杂度是 O(n) 并且没有使用额外的字符串。

```
#include<stdio.h>

char * strRev(char *str, char tok)
{
   int len = 0, i;
   char *temp = str;
   char swap;

   while(*temp != tok && *temp != '\0') {
      len++; temp++;
   }   
   len--;

   for(i = 0; i < len/2; i++) {
      swap = str[i];
      str[i] = str[len - i]; 
      str[len - i] = swap;
   }   

   // Return pointer to the next token.
   return str + len + 1;
}

int main(void)
{
   char a[] = "Reverse this string.";
   char *temp = a;

   if (a == NULL)
      return -1; 

   // Reverse whole string character by character.
   strRev(a, '\0');

   // Reverse every word in the string again.
   while(1) {
      temp = strRev(temp, ' ');
      if (*temp == '\0')
         break;

      temp++;
   }   
   printf("Reversed string: %s\n", a); 
   return 0;
} 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2012-10-19T15:46:40.553

**用法**

```
char str[50] = {0};
strcpy(str, (char*)"My name is Khan");
reverseWords(str); 
```

**方法**

```
void reverseWords(char* pString){
    if(NULL ==pString){
        return;
    }
    int nLen     = strlen(pString);
    reverseString(pString,nLen);
    char* start  = pString;
    char* end    = pString;
    nLen         = 0;
    while (*end) {
        if(*end == ' ' ){
            reverseString(start,nLen);
            end++;
            start = end;
            nLen  = 0;
            continue;
        }
        nLen++;
        end++;
    }
    reverseString(start,nLen);
    printf("\n Reversed: %s",pString);

}

void reverseString(char* start,int nLen){
    char* end = start+ nLen-1;
    while(nLen > 0){
        char temp = *start;
        *start    = *end;
        *end      = temp;
        end--;
        start++;
        nLen-=2;
    }
} 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2013-07-05T11:39:15.470

无论您的字符串中有多少空格、制表符或换行符 (\n)，这都是您在 TCL 中解决它的方法。这是现实生活中的解决方案和人类的思维方式。它不认为只有一个空格是一个新词的标记。

我认为在 C/C++ 和 Java 中你可以用同样的方式翻译它。

我在发帖前花了两天时间研究它，因为我不接受存在由语言库提供的功能，这些功能也是为我们制作的，我们不使用它们。

```
<!-- language: lang-php -->
# 1- Reverse the orignial text
set reversed [ string reverse  $all_original_text] 

# 2- split the reversed string $reversed into a list of words then loop over them
set list_of_reversed_words [split $reversed  ]

foreach reversed_words $list_of_reversed_words {

# 3- find the indices of the extremes of each reversed word in the $reversed

set word_start [ string first $reversed_words $reversed $word_start]
set word_end [ expr $word_start -1 + [string length $letter] ]

# 4- reverse the current-in-the-loop reversed word back to its normal state, e.g: 
# if i have a word "loohcs" then convert it by reversing it to "school"

set original_word [string reverse [ string range $reversed $word_start $word_end] ]

# 5- replace  the reversed word (loohcs) with the correcte one (school)

set reversed [ string replace $reversed $word_start $word_end $original_word]

# 6- set the start-of-search index to the index 
# directly after the ending of the current word

set word_start [expr $word_end +1]

# 7-continue to the next loop  
}

#print the result
puts "finally: $reversed" 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2013-07-09T20:49:13.490

```
public class StringReverse {

  public static void main(String[] args) {

    StringReverse sr =new StringReverse();
    String output=sr.reverse("reverse this string");

    String substring="";
    for(int i=0;i<=output.length();i++)
        {
        if(i==output.length()){
            System.out.print(sr.reverse(substring));
            substring="";
        }else if(output.charAt(i)==' ' ){
            System.out.print(sr.reverse(substring+" "));
            substring="";

        }
        if(i<output.length())
        {
        substring+=output.charAt(i);}
        }

}

public String reverse(String str){
    char[] value=str.toCharArray();
    int count=str.length();
    int n = count - 1;
    for (int j = (n-1) >> 1; j >= 0; --j) {
        char temp = value[j];
        value[j] = value[n - j];
        value[n - j] = temp;
    }
    return new String(value);
  }
} 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2013-07-15T03:53:22.793

```
#include <stdio.h>
#include <stdlib.h>
#include <strings.h>

void reverse(char *data, int len) {
    int counter = 0;
    int end = len - 1;
    char temp;

    for (counter = 0; counter < len / 2; counter++, end--) {
        temp = data[counter];
        data[counter] = data[end];
        data[end] = temp;
    }
}

int main(void) {
    char data[] = "This is a line and needs to be reverse by words!";
    int c = 0;
    int len = strlen(data);
    int wl = 0;
    int start = 0;
    printf("\n    data =  %s", data);
    reverse(data, len);

    for (c = 0; c < len; c++) {
        if (!wl) {
            start = c;
        }
        if (data[c] != ' ') {
            wl++;
        } else {
            reverse(data + start, wl);
            wl = 0;
        }

    }

    printf("\nnow data =  %s", data);
    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2013-07-25T21:27:31.830

使用 Java：

```
String newString = "";
String a = "My name is X Y Z";
    int n = a.length();
    int k = n-1;
    int j=0;

    for (int i=n-1; i>=0; i--)
    {
        if (a.charAt(i) == ' ' || i==0)
        {

            j= (i!=0)?i+1:i;

            while(j<=k)
            {
                newString = newString + a.charAt(j);
                j=j+1;
            }
            newString = newString + " ";
            k=i-1;
        }

    }
    System.out.println(newString); 
```

复杂度为 O(n) [遍历整个数组] + O(n) [再次遍历每个单词] = O(n)

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2013-10-17T08:39:21.343

对于那些喜欢这个问题的人来说，这是一个很好的调整......如果包含交换单词的字母小于 16 个字符（16 个包括“空格”）怎么办？这样的字母有很多例子：数字字符 [01234567890.-+]、基因组字母 [GATC]、夏威夷字母 [aeiouhklmnpv?]、莫尔斯电码 [-.]、音符 [ABCDEFG#m] 等。这允许将字符编码为半字节（4 位）并将两个编码的字符存储在一个 8 位字符中。

在一个循环中进行单词交换仍然不是一件容易的事，一个光标从左到右移动，另一个从右到左移动。实际上有 4 种类型的单词复制：从左侧字符串的一侧复制一个单词到右侧，从右侧字符串的一侧到左侧复制以及涉及读/写重叠的两个等效副本：位置 X->X+y 和X->Xy，其中 y 小于 X 的长度。

很好的优化是，在循环的前半部分，右侧的单词被编码到左侧（保留原始左侧值），但在后半部分，左侧的单词可以直接复制到右侧，然后再复制到左侧字符用它们的最终值重写......

这是 C 代码，它采用任何字母作为参数：

```
#define WORDS_DELIMITER  ' '
#define UNMAPPED         0xFF

#define BITS_IN_NIBBLE   4
#define BITS_IN_BYTE     8
#define CHARS_IN_NIBBLE  (1 << BITS_IN_NIBBLE)
#define CHARS_IN_BYTE    (1 << BITS_IN_BYTE)

typedef union flip_char_ {
    unsigned char clear;
    struct {
        unsigned char org:4;
        unsigned char new:4;
    } encoded;
} flip_char_t;

typedef struct codec_ {
    unsigned char nibble2ascii[CHARS_IN_NIBBLE];
    unsigned char ascii2nibble[CHARS_IN_BYTE];
} codec_t;

static int 
codec_init (const unsigned char *alphabet, codec_t *codec)
{
size_t len = strlen(alphabet), i;

if (len > CHARS_IN_NIBBLE) {
    fprintf(stderr, "alphabet is too long!\n");
    return -1;
}
if (strchr(alphabet, WORDS_DELIMITER) == NULL) {
    fprintf(stderr, "missing space in the alphabet\n");
    return -1;
}
strcpy(codec->nibble2ascii, alphabet);
memset(codec->ascii2nibble , UNMAPPED, CHARS_IN_BYTE);
for (i=0; i<len; i++) {
    codec->ascii2nibble[ alphabet[i] ] = i;
}
return 0;
}

static inline int
is_legal_char (const codec_t *codec, const unsigned char ch)
{
return codec->ascii2nibble[ch] != UNMAPPED;
}

static inline unsigned char 
encode_char (const codec_t *codec, unsigned char org, unsigned char new)
{
flip_char_t flip;
flip.encoded.org = codec->ascii2nibble[org];
flip.encoded.new = codec->ascii2nibble[new];
return flip.clear;
} 

static inline unsigned char 
decode_org (const codec_t *codec, unsigned char ch)
{
flip_char_t flip = { .clear = ch };
return codec->nibble2ascii[flip.encoded.org];
}

static inline unsigned char 
decode_new (const codec_t *codec, unsigned char ch)
{
flip_char_t flip = { .clear = ch };
return codec->nibble2ascii[flip.encoded.new];
}

// static void inline
// encode_char (const char *alphabet, const char *
static int 
flip_words (const unsigned char *alphabet, unsigned char *a, size_t len)
{
codec_t codec;     /* mappings of the 16char-alphabet to a nibble */
int r=len-1;       /* right/reader cursor: moves from right to left scanning for words */
int l=0;           /* left/writer cursor: moves from left to right */
int i=0;                      /* word iterator */
int start_word=-1,end_word=-1; /* word boundaries */
unsigned char org_r=0;        /* original value pointed by the right cursor */
int encode=0, rewrite=0;      /* writing states */

if (codec_init(alphabet, &codec) < 0) return -1;

/* parse the buffer from its end backward */
while (r>=0) {
    if (r>=l && !is_legal_char(&codec, a[r])) {
        fprintf(stderr, "illegal char %c in string\n", a[r]);
        return -1;
    }
    /* read the next charachter looking for word boundaries */
    org_r = (r<l) ? decode_org(&codec, a[r]) : a[r];
    /* handle word boundaries */
    if (org_r == WORDS_DELIMITER) {
        /* mark start of word: next char after space after non-space  */ 
        if (end_word>0 && start_word<0) start_word = r/*skip this space*/+1;
        /* rewrite this space if necessary (2nd half) */
        if (r<l) a[r] = decode_new(&codec,a[r]);
    } else {
        /* mark end of word: 1st non-space char after spaces */ 
        if (end_word<0) end_word = r;
        /* left boundary is a word boundary as well */
        if (!r) start_word = r;
    }
    /* Do we have a complete word to process? */
    if (start_word<0 || end_word<0) {
        r--;
        continue;
    }
    /* copy the word into its new location */
    for(i=start_word; i<=end_word; i++, l++) {
        if (i>=l && !is_legal_char(&codec, a[l])) {
            fprintf(stderr, "illegal char %c in string\n", a[l]);
            return -1;
        }
        /* reading phase: value could be encoded or not according to writer's position */
        org_r= (i<l) ? decode_org(&codec, a[i]) : a[i];
        /* overlapping words in shift right: encode and rewrite */
        encode=rewrite=(l>=start_word && l<=end_word && i<l);
        /* 1st half - encode both org and new vals */
        encode|=(start_word-1>l);
        /* 2nd half - decode and rewrite final values */
        rewrite|=(i<l);
        /* writing phase */
        a[l]= encode ? encode_char(&codec, a[l], org_r) : org_r;
        if (rewrite) {
            a[i]=decode_new(&codec, a[i]);
        }
    }
    /* done with this word! */
    start_word=end_word=-1;
    /* write a space delimiter, unless we're at the end */
    if (r) {
        a[l] = l<r ? encode_char(&codec, a[l], WORDS_DELIMITER) : WORDS_DELIMITER;
        l++;
    }
    r--;
}
a[l]=0;
return 0; /* All Done! */
} 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2014-02-27T05:14:14.593

最简单的方法来做到这一点..

```
 string inputStr = "My name is X Y Z";
          string outputStr = string.Empty;
          List<string> templist1 = new List<string>();
          templist1 = inputStr.Split(' ').ToList();
           for (int i = templist1.Count- 1 ; i >= 0; i--)
          {
              if (outputStr != string.Empty)
              {
                  outputStr = outputStr + " " + templist1[i];
              }
              else
              {
                  outputStr = templist1[i];
              }
          }

           Console.WriteLine("Reverse of a String is", outputStr);

        Output:
        Z Y X is name My 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2014-10-13T02:01:22.693

```
public class reversewords {

public static void main(String args[])

{

String s="my name is nimit goyal";

    char a[]=s.toCharArray();
    int x=s.length();
    int count=0;
    for(int i=s.length()-1 ;i>-1;i--)
    { 
        if(a[i]==' ' ||i==0)
        { //System.out.print("hello");
            if(i==0)
            {System.out.print(" ");}
            for(int k=i;k<x;k++)
            {
                System.out.print(a[k]);
                count++;
            }
            x=i;

        }count++;

    }
    System.out.println("");
    System.out.println("total run =="+count);
}

} 
```

输出：goyal nimit 是我的名字

总运行 ==46

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2015-03-11T21:09:39.173

这是算法：

1.  用空格分解字符串并创建一个单词数组。
2.  反转数组。
3.  按空间内爆数组。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2015-03-28T16:16:17.687

一种方法是解析输入字符串的每个单词并将其推送到 LIFO 堆栈中。

处理完整个字符串后，我们将每个单词从堆栈中逐一弹出，并将其附加到 StringBuffer 类对象中，该对象最终包含反转的输入字符串。

这是 Java 中使用 StringTokenizer 和 Stack 类的一种可能解决方案。我们需要导入 java.util.Stack。

```
public String revString(String input)
{
   StringTokenizer words=new StringTokenizer(input); //Split the string into words
   Stack<String> stack= new Stack<String>();
   while(words.hasMoreTokens())
   {
      stack.push(words.nextElement().toString()); // Push each word of the string onto stack. 
   }
   StringBuilder revString=new StringBuilder();
   while(!stack.empty())
   {
       revString.append(stack.pop()+" ");// pop the top item and append it to revString 
   }
   return revString.toString();
} 
```

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2015-09-16T07:46:35.443

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ReverseString
{
    class Program
    {
        static void Main(string[] args)
        {
            string StringReverse = "";
            int StringLength;
            do
            {
                Console.WriteLine("Enter the String : ");
                string InputString = Console.ReadLine();

                Console.WriteLine("Enter the length : ");
                int InputLength = Convert.ToInt32(Console.ReadLine());

                int NewLength = InputLength;
                InputLength = InputLength - 1;
                int LengthString = InputString.Length;
                int l = LengthString - NewLength;
                StringReverse = "";

                while (InputLength >= 0)
                {
                    StringReverse = StringReverse + InputString[InputLength];
                    InputLength--;
                }

                String substr = InputString.Substring(NewLength, l);

                Console.WriteLine("Reverse  String  Is  {0}", StringReverse + substr);

                Console.WriteLine("\tDo you Want to CONTINUE?\n\t1.YES\n\t2.NO");
                StringLength = Convert.ToInt32(Console.ReadLine());
            } 
            while (StringLength == 1);
        }
    }
} 
```

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2015-10-27T18:15:45.910

```
string = "hello world";
strrev = ""
list = [];
def splitstring(string):
    j = 0;
    for i in range(0,len(string)):
        if(string[i] == " "):
           list.append(string[j:i]);
           j = i+1;
        elif (i+1 == len(string)):
            list.append(string[j:i+1]);

splitstring(string);
for i in list:
    for j in range(len(i)-1,-1,-1):
        strrev += i[j];
    if (i != list[-1]):
        strrev+= " ";
print(list);

print(":%s:" %(strrev)); 
```

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2016-10-21T03:17:36.400

在 JAVA

```
package Test;

public class test2 {

    public static void main(String[] args){

        String str = "my name is fawad X Y Z";

        String strf = "";
        String strfinal="";

        if (str != ""){

        for (int i=0 ; i<=str.length()-1; i++){

            strf += str.charAt(str.length() - (i+1));

        }
        System.out.println(strf);
        }
        else System.out.println("String is Null");

            if (strf != ""){
                String[] temp = strf.split(" ");    

                String temp1 = "";

                System.out.println(temp.length);

                for (int j=0; j<=temp.length-1; j++){

                    temp1 = temp[j];

                    if(temp1.length()>1){

                    for (int k=0; k<=temp1.length()-1; k++){

                        strfinal += temp1.charAt(temp1.length()-(1+k));

                    }
                    strfinal += " ";
                    }
                    else strfinal += temp1 + " ";

                }
                System.out.println(strfinal);

            }
            else System.out.println("String Final is Null");
        }
    } 
```

输出：

```
Z Y X dawaf si eman ym

Z Y X fawad is name my 
```

* * *

## 回答 #44

> 赞同：0
> 
> 时间：2017-03-12T17:38:31.953

```
public static void main(String args[]) {
    String str = "My name is X Y Z"; // out put "Z Y X is name My"

    // split
    String[] arr = str.split(" ");
    // reverse word
    String reverse = "";
    for (int i = arr.length - 1; i >= 0; i--) {
        if(i!=0){
            reverse += arr[i]+" ";
        }else{
            reverse += arr[i];
        }
    }

    System.out.println(reverse);

} 
```

* * *

## 回答 #45

> 赞同：0
> 
> 时间：2017-03-14T11:13:17.930

**我确实在不使用额外空间的情况下解决了这个问题，只使用了原始字符串本身，**但我无法在 O(n) 中解决问题，我能得到的最少是 O(n square)，这是最坏的情况。

我的实施方式-

1.  将整个句子反转，逐个字符。
2.  稍后迭代整个句子，但这次反转每个单词。

**这就是为什么我得到了 O(n sqaure) 最差的时间复杂性**

请在java中找到下面的代码，希望它对某人有所帮助。

```
class MainClass {
    public static void main(String args[]) {

        String str = "reverse me! also lets check";
        System.out.println("The initial string is  --->> " + str);

        for (int i = 0; i < str.length(); i++) {
            //Keep iterating each letter from one end to another.
            str = str.substring(1, str.length() - i)
                + str.substring(0, 1)
                + str.substring(str.length() - i, str.length());
        }
        System.out.println("The reversed string is ---->> " + str);

        for (int i = 0, j = 0; i < str.length(); i++) {
            if(str.charAt(i) == ' ' || i == (str.length() - 1)) {
                //Just to know the start of each word
                int k = j;

                //the below if condition is for considering the last word.
                if(i == (str.length() - 1)) i++;

                while(j < i) {
                    j++;
                    str = str.substring(0, k)
                        //(i-j) is the length of each word
                        + str.substring(k + 1, (k + 1) + i - j)
                        + str.substring(k, k + 1)
                        + str.substring((k + 1) + i - j, i)
                        + str.substring(i);
                    if(j == i) {
                        //Extra j++ for considering the empty white space
                        j++;
                    }
                }
            }
        }
        System.out.println("The reversed string but not the reversed words is ---->> " + str);

    }
} 
```

* * *

## 回答 #46

> 赞同：0
> 
> 时间：2017-11-30T11:37:10.333

这是如何在 Excel 中作为 UDF 和 VBA 执行此操作：

```
Public Function ReverseMe(textToReverse As String, _
          Optional delim As String = " ") As String

    Dim test    As String
    Dim arr     As Variant
    Dim arr2    As Variant
    Dim arrPart As Variant
    Dim cnt     As Long

    arr = Split(textToReverse, ".")
    ReDim arr2(UBound(arr))

    For Each arrPart In arr
        arr2(cnt) = StrReverse(arrPart)
        cnt = cnt + 1
    Next arrPart

    ReverseMe = StrReverse(Join(arr2, "."))

End Function

Public Sub TestMe()

    Debug.Print ReverseMe("veso.dosev.diri.rid", ".")
    Debug.Print ReverseMe("VBA is the best language")

End Sub 
```

* * *

## 回答 #47

> 赞同：0
> 
> 时间：2019-01-04T20:02:53.583

这个问题是在 Paytm 面试 Java 职位时提出的。我想出了以下解决方案。

```
class ReverseStringWord{
public static void main(String[] args) {
    String s="My name is X Y Z";
    StringBuilder result=new StringBuilder();
    StringBuilder str=new StringBuilder();
    for(int i=0;i<s.length();i++){
        if(s.charAt(i)==' '){
            result.insert(0,str+" ");
            str.setLength(0);
        }
        else{
            str.append(s.charAt(i));
            if(i==s.length()-1){
                result.insert(0,str+" ");
            }
        }
    }
    System.out.println(result);
}} 
```

* * *

## 回答 #48

> 赞同：0
> 
> 时间：2021-01-31T08:49:50.590

通过旋转字符串，您可以颠倒单词的顺序而不颠倒字母的顺序。

当每个单词旋转到字符串的末尾时，我们会根据单词的长度减少要旋转的字符串的数量。然后，我们将任何空格旋转到我们刚刚放在末尾的单词的前面，并为每个空格将字符串的旋转部分缩短 1。如果整个字符串在没有看到空格的情况下旋转，我们就完成了。

这是我在 C+ 中的实现。该`l`变量包含`buf`要旋转的长度，并`n`计算旋转的次数。

```
 #include <stdio.h>
    #include <string.h>

    int main(char *argv[], int argc)
    {
      char buf[20] = "My name is X Y Z";
      int l = strlen(buf);
      int n = 1;

      while (l >= n) {
        unsigned char c = buf[0];
        for (int i = 1; i < l; i++) {
          buf[i-1] = buf[i];
        }
        buf[l - 1] = c;
        if (buf[0] == ' ' || c == ' ') {
          l -= n;
          n = 1;
        } else {
          n++;
        }
      }

      printf("%s\n", buf);
    } 
```

旋转代码故意留得很简单。

# c++ - VS2008内部编译错误

> ID：1009165
> 
> 赞同：2
> 
> 时间：2009-06-17T19:47:00.270
> 
> 标签：c++, visual-studio, compiler-construction, visual-c++, c1001

在尝试从 MSVC6 切换到 MSVC 2008 时，我一直遇到内部编译器错误。经过大量工作注释掉程序的不同部分后，我将错误追溯到两个不同 CPP 文件中的两行代码。这两个 CPP 文件都成功编译，但不知何故会影响错误是否出现在其他文件中。

这两行都涉及实例化几个复杂的嵌套模板。它们似乎也是应用程序中唯一使用抽象类作为模板参数之一的地方。也就是说，我还不确定这个问题是涉及抽象类还是模板，这只是我注意到的最明显的事情。我什至不能确定这些线是否重要。不过，它们是这样的：

```
m_phDSAttributes = new SObjDict<RWCString, SIDataSource>(&RWCString::hash); 
```

所以我们有了SObjDict，一个模板化的字典类，SIDataSource，一个抽象接口，参数是一个指向RWCString的静态成员函数的指针。

我一直在玩一些代码，偶尔会出现从一个 CPP 文件移动到另一个文件的错误（例如，我将一堆模板声明从 using`class`更改为`typename`），但我找不到任何押韵或理由。

我不知道如何进一步调试这个问题。编译器的确切错误输出（更改了我的源文件的名称）如下。互联网上的任何地方都没有提到它。我非常渴望任何关于如何进行的建议。我不希望有人说“哦，你只需要做 XYZ”，但是关于如何调试这类问题的指针将不胜感激。

```
1>d:\Dev\webapi.cpp : fatal error C1001: An internal error has occurred in the compiler.
1>(compiler file 'f:\dd\vctools\compiler\utc\src\p2\p2symtab.c', line 5905) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-24T15:28:45.840

我对自己的问题给出答案并接受它感觉有点不好，但我想这是正确的做法......我解决了我的问题，至少是暂时的。诀窍似乎是禁用预编译的标头。我不知道*为什么*这样可以解决问题，而且很不幸，因为受影响项目的构建时间从不到 30 秒缩短到近 5 分钟，但至少我可以继续前进……如果有人想出一个更永久的解决方案，我很乐意将他们的答案标记为已接受。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T11:12:15.443

假设这`p2symtab.c`是符号表代码的（部分）是一个合理的选择。这将立即解释升级是如何导致它的；此代码已被重写。（还记得 VC6 的 255 个字符长度警告吗？）

在这种情况下，符号表中没有新条目，因此很可能是在符号表中的查找失败了。看看名称查找发生的上下文是否会影响结果会很有趣。例如，如果您将代码更改为

```
typedef SObjDict<RWCString, SIDataSource> SObjDict_RWCString_SIDataSource;
m_phDSAttributes = new SObjDict_RWCString_SIDataSource(&RWCString::hash); 
```

这将强制创建另一个符号表条目，对于`SObjDict_RWCString_SIDataSource`. 这个条目有点像模板*实例化*的符号链接。新名称可以（并且必须）自行查找。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T19:54:22.860

开始把它分解成更小的部分。我的第一个猜测是指向静态函数的指针将成为问题。你能在构造函数中创建一个具有相同参数的虚拟非模板类吗？如果您不在模板中使用抽象类，它会编译吗？

看起来我把你送错了方向，以下在 2008 年编译得很好：

```
class thing {
public:
    static void hash( short sht ) {
    }

    void hash( long lng ) {
    }
};

class thing2 {
public:
    thing2( void (short ) ){}
};

int _tmain(int argc, _TCHAR* argv[])
{
    thing2* t = new thing2( &thing::hash );
    delete t;
    return 0;
} 
```

但是，原则仍然存在，删除/替换复杂元素，直到您拥有可编译的代码并且您会知道导致问题的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-21T03:23:22.017

致命错误 C1001：编译器发生内部错误。1>(编译文件'f:\dd\vctools\compiler\utc\src\p2\p2symtab.c

当我尝试将我的 vs 2005 代码构建到 vs 2008 时，我也观察到了同样的错误。但是直到我没有安装 VS 2008 的 Service Pack 时才会发生这种情况......

你安装了Service Pack吗……我想这会解决你的问题……

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-06-17T19:51:09.823

这通常发生在模板实例化中。不幸的是，这可能是由许多原因引起的，但 99% 的时间你的代码都在巧妙地调用未定义的行为。

# vba - 如何使用 VBA 通过 ODBC 连接到 Lotus？

> ID：1009168
> 
> 赞同：0
> 
> 时间：2009-06-17T19:47:29.113
> 
> 标签：vba, odbc, lotus-notes

我有兴趣设置一个 Access 数据库来自动运行报告。为了省去访问每台客户端计算机并设置适当的 DSN 的麻烦，如果可能的话，我想在 VB 脚本本身中设置 ODBC 连接。

我用谷歌搜索并检查了这个网站，发现了一些很好的入门代码，但不足以让所有的错误消息消失。有人可以完成下面的代码吗？

```
Sub SetupODBC(Str_Server as string, Str_Db as string)  
 'Str_Server=Name of Server
 'Str_db=Name of Database
 Dim C as ADODB.Connection  
 Set C = new ADODB.Connection  
 C.ConnectionString = ??  
 C.Open  
 Debug.print C.State  
Exit Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T20:57:55.570

这个网站是你的朋友： http: [//www.connectionstrings.com/access](http://www.connectionstrings.com/access)

一开始我没有正确回答你的问题。我看到您想创建一个从 Access 到 Lotus 的链接以报告 Lotus Notes 数据。那么有几种方法可以做到这一点。

我经常使用一种方法将 Lotus Notes 数据公开为 XML，然后从远程系统访问该 XML。您可以使用 XML 开始标记、根元素轻松创建 Notes Page，然后在根元素之间插入嵌入视图。然后，该嵌入式视图需要显示为 HTML 并包含解析为 xml 标记的列。例如，视图的每一行看起来都类似于：

```
<Person><FirstName>Ken</FirstName><LastName>Pespisa</LastName></Person> 
```

你的列公式将是：

```
"<Person><FirstName>" + FirstName + "</FirstName>" 
```

对于名字列，对于姓氏列，它将是这样的：

```
"<LastName> + LastName + </LastName></Person>" 
```

请注意，这假定您的 Notes 服务器已打开 HTTP 服务，并且您可以通过浏览器访问数据库。

但是，正如其他答案所提到的，您可以使用其他方法，例如 NotesSQL 和 COM。不过，听起来您正在将此解决方案放在许多工作站上，而 NotesSQL 将要求您在每个工作站上安装驱动程序。COM 方法不需要在用户的办公桌上进行任何额外的工作就可以工作，所以在这种情况下我会赞成这种解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T03:16:21.097

欢迎来到董事会。ConnectionStrings 确实是您的朋友，但您遇到的问题是您没有驱动程序：) Lotus Notes 不是关系数据库，它是[面向文档的数据库](http://en.wikipedia.org/wiki/Document-oriented_database)。出于这个原因，从历史上看，还没有一种方法可以像访问关系数据库一样访问它。[然而，IBM 最终开始以NotesSQL](http://www.ibm.com/developerworks/lotus/products/notesdomino/notessql/)的形式编写一种翻译器。如果您点击链接并获取驱动程序，您应该能够使用 ODBC。值得注意的是，Notes 将自己暴露给 COM。因此，如果迫在眉睫，您可以自动化客户端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T21:34:01.427

看起来很适合我的需求，即使它已经一年没有更新了。但仍然没有雪茄。现在，我收到“未找到数据源名称且未指定默认驱动程序”

（显然，ServerNameGoesHere 和 DatabaseNameGoesHere 是替代品）

```
Sub dbX()  
     Dim C As adodb.Connection  
     Set C = New adodb.Connection  
     C.Open _  
        "Driver={Lotus NotesSQL 3.01 (32-bit) ODBC DRIVER (*.nsf)};" & _  
        " Server=ServerNameGoesHere;" & _  
        " Database=DatabaseNameGoesHere.nsf;"  
     C.Close
End Sub 
```

# .net - .Net 使用 XSL 转换大型 XML 文档

> ID：1009179
> 
> 赞同：2
> 
> 时间：2009-06-17T19:49:39.717
> 
> 标签：.net, xml, xslt, large-files

问题：在 .Net 中使用 XSL 转换大型 XML 文档 (>200MB) 的最佳方法是什么？

背景：我有一个为我提供大型数据文件的应用程序，我无法更改格式。在过去，我能够毫无问题地翻译较小的数据文件。

最初我将 XML 作为字符串使用，并且很快就耗尽了内存。我切换了我的代码，现在我处理 MemoryStream 的读取，使用样式表进行转换，然后使用文件流将输出的副本保存到单独的位置。

应用样式表会导致应用程序消耗超过 1gb 的内存并最终崩溃。

我知道我可以使用 DOM 以编程方式处理 XML，但我真的很想坚持应用 XSL 样式表的通用方法。

有没有人对我在处理 XSL 转换时如何更好地管理内存有任何指示？下面是我正在应用转换的代码片段：

```
'xmlData is a memory stream passed into a function 
        '...
    Dim strfilepath As String = appConfigSettings.FilePaths.XslFilePath & "\" & odtrow.formatterXsl

 Dim xslt As New System.Xml.Xsl.XslCompiledTransform()
 xslt.Load(strfilepath)

 Dim xmlRead As XmlReader = XmlReader.Create(xmlData)

 newStream = New MemoryStream()
 xslt.Transform(xmlRead, Nothing, newStream) 'here is where it fails
 newStream.Position = 0
        '... 
```

C# 或 VB 示例都很好，我可以使用任何一个...这个应用程序是我的手，所以请不要批评 vb :) -J

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T20:08:29.820

您正在使用 MemoryStream，并且内存不足。嗯……

也许改用 FileStream ？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-02T04:43:15.320

尝试使用 XPathDocument 而不是 XMLReader。它经过优化并且速度更快。

D

# delphi - 从 Delphi (Win32) 设置环境变量

> ID：1009180
> 
> 赞同：3
> 
> 时间：2009-06-17T19:49:45.427
> 
> 标签：delphi, environment-variables

我正在尝试从我的 delphi 应用程序中设置系统范围的环境变量。文档说要向 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment 添加一个注册表项，然后广播 WM_SETTINGCHANGE 消息。有人知道如何广播此消息吗？

PS。我正在尝试在控制台应用程序中执行此操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T19:53:10.333

打电话[`SendMessage`](http://msdn.microsoft.com/en-us/library/ms644950.aspx)。用作`HWnd_Broadcast`目标窗口。

更好的选择可能是[`SendNotifyMessage`](http://msdn.microsoft.com/en-us/library/ms644953.aspx)，它不等待所有收件人返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T16:53:10.343

Embarcadero 开发者网络中还有一个主题涵盖了这个问题并提供了发送消息的示例代码。作者按照[**WM_SETTINGCHANGE**](http://msdn.microsoft.com/en-us/library/ms725497.aspx "WM_SETTINGCHANGE")的 MSDN 文档中的建议使用[**SendMessageTimeout**](http://msdn.microsoft.com/en-us/library/ms644952.aspx "发送消息超时")：[](http://msdn.microsoft.com/en-us/library/ms725497.aspx "WM_SETTINGCHANGE")

 ****[http://edn.embarcadero.com/article/28254](http://edn.embarcadero.com/article/28254)****

# url - 电话 URL 方案

> ID：1009181
> 
> 赞同：79
> 
> 时间：2009-06-17T19:49:46.347
> 
> 标签：url, url-scheme, phone-call, tel

就像“mailto” URL 前缀启动用户的默认邮件程序并启动具有指定地址的新电子邮件一样，是否有类似的 URL 方案可以发起电话呼叫？也许是“电话”、“打电话”或“喝”？

顺便说一句，我的目标是使用 Cisco CUPS 的平台，因此我可能有一种特定于平台的方式来发起 Cisco 特有的呼叫，但我想我会先问更一般的问题。但是，如果有人具体知道如何通过 CUPS 以编程方式发起呼叫，那也太好了。

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2010-10-05T13:34:39.930

提供电话号码作为 URI 的官方标准在这里：[http ://www.ietf.org/rfc/rfc3966.txt](http://www.ietf.org/rfc/rfc3966.txt)

它基本上说`tel:`用作前缀，并`+[international dialling code]`在数字本身之前开始数字。您可以将非数字字符作为分隔符（例如 -），但必须忽略它们。因此，伦敦（英国）号码可能是：

```
tel:+44-20-8123-4567 
```

纽约（美国）号码：

```
tel:+1-212-555-1234 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-02-01T22:37:55.643

有这样一个URI方案：`tel`. 它有一个复杂的语法，但这里有一个简单的用法示例：

```
tel:123-4567 
```

有关完整规范，请参阅[http://www.ietf.org/rfc/rfc3966.txt](http://www.ietf.org/rfc/rfc3966.txt)。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-17T21:20:04.763

我追求 Microsoft Office Communicator 的相同功能。经过一番调查，我发现以下 URI 语法将通过通信器发起 (VoIP) 电话呼叫：

```
tel:+number 
```

例如：让通讯器呼叫我的分机：

```
tel:+7780 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-17T19:57:12.107

`sip:`（或`sips:`）是 SIP 的[官方 URI 方案](http://en.wikipedia.org/wiki/URI_scheme#Official_IANA-registered_schemes)，我认为`callto:`Skype 使用过，但已弃用。

# .net - 用于 Web 服务的 ASP.Net 应用程序缓存

> ID：1009184
> 
> 赞同：1
> 
> 时间：2009-06-17T19:50:18.173
> 
> 标签：.net, asp.net, web-services, caching

我有一个 Web 服务，其中包含一些我需要跨会话传递的数据。我正在考虑使用应用程序对象。

> 1）这是个好主意吗？
> 
> 2）一些数据会变老，我想把它清除掉，这样应用程序对象就不会不断增长。做这个的最好方式是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T19:57:08.907

如果您的 appdomain 被回收，这些数据将会丢失 - 这会是一个问题吗？如果是这样，您可能应该考虑将这些数据保存在其他地方，可能是数据库......

然后，您可以缓存此数据并在缓存数据丢失时从数据库中检索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T20:03:45.040

这取决于数据大小......但缓存对我来说听起来不错。如果您真的需要良好的性能，您还可以实现分布式缓存，如 memcached 或 NCache。

# jquery - 如何使用 jQuery 获取相对值中的填充或边距值

> ID：1009186
> 
> 赞同：6
> 
> 时间：2009-06-17T19:50:28.500
> 
> 标签：jquery

如果我有一个类似代码的 CSS 样式的元素

```
td class="bogus" style="padding-left: 1em;" 
```

如何使用 jQuery 获取`padding-left`1em 而不是像素的值？

```
$(".bogus").css("padding-left"); 
```

这仅返回像素，但我希望它返回代码中的真正内容，在这种情况下，是相对值 1em。如何 ？

感谢您的任何指导。

*   曲

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T19:58:35.020

您可以做的是将基本字体大小（`<body>`元素上的 font-size 属性）设置为 62.8% 左右（有人说是 62.5%）：

```
<body style="font-size:62.5%;"> 
```

这使得基本字体或 1.0em 大约等于 10px。它并不精确，并且会因字体而异，但总的来说它已经足够准确了。完成后，您可以使用 EM 及其像素等价物：

1.0em = 10px，1.1em = 11px，1.2em = 12px 等等。

因此，您可以通过除以 10 轻松地将像素转换为 EM：

```
var ems = parseInt($(".bogus").css("padding-left")) / 10; 
```

# c# - 在开发 LINQ Lambda 表达式以按计划进行过滤时需要帮助

> ID：1009203
> 
> 赞同：1
> 
> 时间：2009-06-17T19:54:04.530
> 
> 标签：c#, linq, lambda, filtering

我很难找到 lambda 表达式来调用列表以正确过滤对象结构。我希望这里有人可以帮忙。我使用的是 .NET 3.5，LINQ 和对象域是从 Linq 到 SQL DBML 设置的。我特别想使用**lambda 表达式**。

对象结构是一个人有设置的结构，一个设置是一个时间表名称，它对应于另一个具有开始日期和结束日期的时间表类。

```
public class MyPerson
{
    public int ID { get; set; }
    public List<MySetting> Settings { get; set; }
}

public class MySetting
{
    public int ID { get; set; }
    public string Name { get; set; }
    public string Value { get; set; }
}

public class MySchedule
{
    public string ID { get; set; }
    public DateTime StartDate { get; set; }
    public DateTime EndDate { get; set; }

} 
```

时间表有开始和结束日期，一个人的状态可以是活动的或计划的。

```
 List<MySchedule> schedules = new List<MySchedule>();
    MySchedule scheduleA = new MySchedule { ID = "ScheduleA", StartDate = Convert.ToDateTime("1/1/2008"), EndDate = Convert.ToDateTime("12/31/2008") };
    MySchedule scheduleB = new MySchedule { ID = "ScheduleB", StartDate = Convert.ToDateTime("1/1/2009"), EndDate = Convert.ToDateTime("12/31/2009") };
    schedules.Add(scheduleA);
    schedules.Add(scheduleB);

    List<MySetting> settingsJill = new List<MySetting>();
    MySetting settingFirstName = new MySetting { ID = 1, Name = "FirstName", Value = "Jill" };
    MySetting settingScheduleName = new MySetting { ID = 2, Name = "ScheduleName", Value = "ScheduleB" };
    MySetting settingState = new MySetting { ID = 3, Name = "State", Value = "Scheduled" };  // Jill uses ScheduleB
    settingsJill.Add(settingFirstName);
    settingsJill.Add(settingScheduleName);
    settingsJill.Add(settingState);

    List<MySetting> settingsBill = new List<MySetting>();
    settingFirstName = new MySetting { ID = 1, Name = "FirstName", Value = "Bill" };
    settingScheduleName = new MySetting { ID = 2, Name = "ScheduleName", Value = "ScheduleA" };
    settingState = new MySetting { ID = 3, Name = "State", Value = "Scheduled" };              // Bill is Scheduled last year
    settingsBill.Add(settingFirstName);
    settingsBill.Add(settingScheduleName);
    settingsBill.Add(settingState);

    List<MySetting> settingsJane = new List<MySetting>();
    settingFirstName = new MySetting { ID = 1, Name = "FirstName", Value = "Jane" };
    settingScheduleName = new MySetting { ID = 2, Name = "ScheduleName", Value = "ScheduleA" };
    settingState = new MySetting { ID = 3, Name = "State", Value = "Active" };              // Jane is Active
    settingsJane.Add(settingFirstName);
    settingsJane.Add(settingScheduleName);
    settingsJane.Add(settingState);

    List<MyPerson> persons = new List<MyPerson>();
    MyPerson Jane = new MyPerson { ID = 1, Settings = settingsJane };
    MyPerson Jill = new MyPerson { ID = 2, Settings = settingsJill };
    persons.Add(Jane);
    persons.Add(Jill);
    persons.Add(Bill); 
```

我想通过创建一个 lambda 表达式来过滤人员列表，该表达式将返回 State = "Active" 或具有包含开始日期和结束日期之间的当前日期的 ScheduleName 的人员。换句话说，Jill 应该出现在过滤列表中，因为她是 Scheduled，并且她使用的是 ScheduleB，而 ScheduleB 是 2009 年的，今天是 2009 年 6 月 17 日。

我从

```
List<MyPerson> filter = persons.Select (  // and this is where I get stuck. 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T20:11:56.973

您需要重新考虑如何存储信息。.NET Collectionns 不是 SQL 表，您不应该这样使用它们。话虽如此，这是您想要的查询：

```
Persons.Where(person => 
  person.Settings.Any(setting=>
      (setting.Name == "State" && setting.Value=="Active")) ||
  person.Settings
      .Where(setting=> setting.Name == "ScheduleName")
      .Any(setting => { var sch = schedules
           .First(schedule=>schedule.ID == setting.Value);
           return sch.StartDate < DateTime.Now && sch.EndDate > DateTime.Now; 
      })   
) 
```

想象一下，如果你有一个像这样的数据结构：

```
class Person { 
    Dictionary<string, string> Settings;
    List<MySchedule> Schedules;
}

then your query would be

Persons.Where(person =>
   Person.Settings["State"] == "Active" ||
   Person.Schedules.Any(schedule => 
       Datetime.Now > schedule.StartTime &&
       DateTime.Now < schedule.EndTime
   )
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T20:04:38.847

一个问题是您从`Select`. 那是为了投影 - 你只是想过滤，所以你只需要`Where`.

另一个问题是您的`MyPerson`类型不包含`ScheduleName` *or* `State`属性。目前还不清楚这一切是如何结合在一起的。如果您可以纠正您的示例，我相信我们可以提出过滤器。

# .net - 何时使用异步模式处理 wcf 对象

> ID：1009208
> 
> 赞同：5
> 
> 时间：2009-06-17T19:55:02.233
> 
> 标签：.net, wcf, idisposable

假设我从同步版本开始：

```
 using(var svc = new ServiceObject()) {
     var result = svc.DoSomething();
     // do stuff with result
 } 
```

我结束了

```
var svc = new ServiceObject();
svc.BeginDoSomething(async => {
    var result = svc.EndDoSomething(async);
    svc.Dispose();
    // do stuff with result
},null); 
```

1) 这是调用 Dispose() 的正确位置吗？

2）有没有办法使用 using() ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T09:13:36.120

来自 Rotem Bloom 的博客： [http ://caught-in-a-web.blogspot.com/2008/05/best-practices-how-to-dispose-wcf.html](http://caught-in-a-web.blogspot.com/2008/05/best-practices-how-to-dispose-wcf.html)[](http://caught-in-a-web.blogspot.com/2008/05/best-practices-how-to-dispose-wcf.html)

**最佳实践：如何处置 WCF 客户端**

不建议对 Dispose WCF 客户端使用 using 语句（在 Visual Basic 中使用）。这是因为 using 语句的结尾可能会导致可能掩盖您可能需要了解的其他异常的异常。

```
 using (CalculatorClient client = new CalculatorClient())
{
...
} // this line might throw

Console.WriteLine("Hope this code wasn't important, because it might not happen.");

The correct way to do it is:
try
{
    client.Close();
}
catch (CommunicationException)
{
    client.Abort();
}
catch (TimeoutException)
{
    client.Abort();
}
catch
{
     client.Abort();
     throw;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T20:01:39.913

既然您的服务不会访问任何非托管资源，为什么不让它超出范围并让 GC 做它的事情呢？

# asp.net-mvc - TempData[] 被擦除

> ID：1009209
> 
> 赞同：0
> 
> 时间：2009-06-17T19:55:05.010
> 
> 标签：asp.net-mvc, tempdata

我在 TempData 中存储了一个整数，在浏览我的网站 30-60 秒后，由于未知原因，它会定期被擦除。

我在设置值的地方有一个断点，它永远不会被设置为空，但不知何故，TempData 中的值被清空了。

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T19:59:07.360

来自[ASP.NET MVC：在没有 Web 窗体的情况下构建 Web 应用程序](http://msdn.microsoft.com/en-us/magazine/cc337884.aspx)：

> TempData 是一个字典，很像无类型的 ViewData。但是，TempData 的内容仅适用于单个请求，然后会被删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T20:01:35.637

我相信 TempData 只会在后续请求中持续存在。你可能想看看[这个](http://www.persistall.com/archive/2007/12/22/asp.net-mvc-a-ha-moment-tempdata--flash.aspx)。

# ruby-on-rails - 是否可以从 STI 基类创建 STI 子模型对象？

> ID：1009216
> 
> 赞同：0
> 
> 时间：2009-06-17T19:57:00.670
> 
> 标签：ruby-on-rails

给定以下层次结构

```
class Content < ActiveRecord::Base end
class Page < Content end
class Post < Content end 
```

是否可以使用以下样式创建例如页面内容（间接）：

c = Content.new c.type = 页面 c.title = 'test' c.save！

看起来 type 也是对象上的 ruby​​ 方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T03:05:37.077

我建议做这样的事情......

```
klass = "Page"
klass.constantize.create(:title=>'title') 
```

如果你只是用'type'属性到处乱搞，你就不会在你的对象的子类中覆盖任何方法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-17T20:00:25.750

当然，但你必须使用 write_attribute

```
c.write_attribute(:type, "Page")
c.save 
```

# iphone-sdk-3.0 - 如何测试 iphone p2p 应用程序？

> ID：1009220
> 
> 赞同：5
> 
> 时间：2009-06-17T19:57:34.803
> 
> 标签：iphone-sdk-3.0, bluetooth, ios-simulator, p2p

有没有办法测试 iphone OS 3.0 p2p 应用程序？我可以运行多个 iphone 模拟器实例吗？显然没有。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-05T21:34:05.617

几周前我发表了一篇关于如何做到这一点的详细帖子，所以我只是将它推荐给你：[http ://ramin.firoozye.com/2009/06/18/debugging-peer-to-peer-和-wifi-apps-on-the-iphone/](http://ramin.firoozye.com/2009/06/18/debugging-peer-to-peer-and-wifi-apps-on-the-iphone/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T20:01:19.273

尝试从工作场所或 LAN 上多台计算机的某个地方获得运行多个实例的许​​可。这也可以让你测试网络的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T10:25:08.387

您必须使用 2 个硬件设备来测试 gamekit p2p 连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T10:45:50.640

根据[这个论坛帖子](http://forums.macrumors.com/showthread.php?t=670173)，您需要在两个真实设备上对其进行测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-05T22:05:54.193

未经测试，但您应该能够通过复制它来运行 iPhone 模拟器的两个实例。

为电话 1 正常运行模拟器。

第二，去`/Developer/Platforms/iPhoneSimulator.platform/Developer/Applications/`某个地方（你的桌面？）复制（而不是移动）应用程序。当您运行副本时，它会询问开发人员工具的安装位置以及要运行的应用程序。提供这个，它*应该*运行第二个副本。

另外，也许你可以在你的真手机和模拟器上测试它？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-09T22:20:20.897

我找到了一个解决方案：

在 iPhone 上激活网络共享 将带有模拟器的 Mac 连接到手机

现在您可以在您的 sim 卡和 iPhone 上测试 gamekit

（我还在我的 macbook 上激活了互联网共享 - 但我认为网络共享部分很重要......哦，这意味着蓝牙正在 iPhone 和 mac 上运行，当然）......

我很高兴我找到了这个解决方案 - 这是一个主要缺点......

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-12-30T11:11:45.783

I try to the same test on my macbook OS5.0 and iPhone 3gs , the iPhone simulator app can see the iPhone device via the app , but can not connected ... does this problem cause the bluetooth device is unauthorized ?

install VMware seem great but too trouble...

# mfc - 0xE0434F4D 错误

> ID：1009223
> 
> 赞同：5
> 
> 时间：2009-06-17T19:57:46.567
> 
> 标签：mfc, c++-cli

所有，我有一个相当令人沮丧的问题。有问题的应用程序有一个 MFC GUI，它使用 MFC Featurepack 中可用的类。此 GUI 使用在 C++\CLI 中开发的 DLL。我们公司使用巡航控制。NET (1.4.4 SP1) 在 Windows Server 2008 SP2 上进行持续集成。Cruise Control 设置为使用框架上 3.5 版本附带的 MSBuild 版本。

有问题的问题是，如果我使用 Cruise Controls 创建的构建，我会收到以下错误：“FormView.exe 中 0x7642fbae (kernel32.dll) 处未处理的异常：0xE0434F4D:0xe0434f4d。” 经过一番挖掘，问题似乎是 GUI 不喜欢 C++\CLI 程序集。

“陷阱”是，如果我登录到服务器，并使用 PowerShell，执行相同的 MSBuild 命令，构建工作。有人有想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T21:55:48.077

问题是我如何构建安装程序。它是与项目的主要解决方案分开的解决方案，因此是与主要构建分开的任务。因此，输出程序集被签名了两次，加载程序抱怨，因为应用程序想要的程序集不再有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T21:03:43.967

您可以尝试将该过程附加到 Visual Studio 调试器。

# c++ - 免费的 C++ lib (Win32) 来录制麦克风

> ID：1009225
> 
> 赞同：1
> 
> 时间：2009-06-17T19:58:24.833
> 
> 标签：c++, winapi, open-source, microphone

有没有关于从麦克风获取声音的库（c++、Win32、开源）的建议？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T20:10:50.080

[PortAudio - 可移植的跨平台音频 API](http://www.portaudio.com/)

> PortAudio 提供了一个非常简单的 API，用于使用简单的回调函数录制和/或播放声音。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T20:09:39.427

尝试查看 OpenAL[1] 可能有点过头了，但应该能够根据需要从麦克风录制。Gamedev.net[2] 上有一些非常好的文章，但恐怕没有一篇告诉你如何用麦克风录音。但是，您应该能够在文档中找到答案。：） 祝你好运，

* * *

[1] [http://connect.creativelabs.com/openal/default.aspx](http://connect.creativelabs.com/openal/default.aspx)

[2] [http://www.gamedev.net/reference/articles/article2008.asp](http://www.gamedev.net/reference/articles/article2008.asp)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T20:06:25.410

我在[CodeProject](http://www.codeproject.com/KB/audio-video/RecordingAndMP3Encoding.aspx)找到了一些代码（标准警告：请仔细检查您从 CodeProject 获取的每一段代码！它很有用，但我经常在我得到的示例中发现可怕的错误！）。这应该为您提供有关 API 以及如何开始使用它们的良好线索。从那里你可以谷歌参考和相关主题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-03-11T12:10:40.740

*   WaveInOpen - 这是一个打开波形输入设备的函数。
*   WaveInPrepareHeader - 使用此函数准备一个记录缓冲区。
*   WaveInAddBuffer - 添加要记录的缓冲区。
*   WaveInStart - 用于开始录制。
*   WaveInClose - 关闭波形输入设备。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T20:23:23.393

如果您不需要跨平台，[DirectShow](http://msdn.microsoft.com/en-us/library/dd375454%28VS.85%29.aspx)效果很好。虽然它不是开源的，但我相信您可以分发需要 DirectShow 库的开源项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T05:33:24.403

你没有说你需要跨平台支持，如果不需要跨平台支持，我会使用 Wave API 或 DirectSound - 两者都相当简单易用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-19T00:19:45.240

我过去曾使用 mci 功能进行记录。抱歉，这并没有显示确保选择麦克风作为录音输入，但是一旦手动选择它，它将保持不变，除非有人更改它。这是在一个对话框中，所以这就是 Windows 句柄的来源。

```
#define ALIAS "mci_alias"

char mci_command[100];
char ReturnString[300];
int mci_error;

// open the device
sprintf(mci_command, "open new type waveaudio alias %s", ALIAS);
mci_err = mciSendString(mci_command, ReturnString, sizeof(ReturnString), m_hWnd);

// set the time format  
sprintf(mci_command,"set %s time format ms", ALIAS);    // just set time format
mci_err = mciSendString(mci_command, ReturnString, sizeof(ReturnString), m_hWnd);

// start the record. specify notifications with a MM_MCINOTIFY message)
sprintf(mci_command, "record %s notify", ALIAS);
mci_err = mciSendString(mci_command, ReturnString, sizeof(ReturnString), m_hWnd);

// wait for a stop button, or an error to occur

sprintf(mci_command,"stop %s", ALIAS);
mci_err = mciSendString(mci_command, ReturnString, sizeof(ReturnString), m_hWnd);

// save the file
sprintf(mci_command, "save %s %s", ALIAS, m_filename);
mci_err = mciSendString(mci_command, ReturnString, sizeof(ReturnString), m_hWnd);

sprintf(mci_command,"stop %s", ALIAS);
mci_err = mciSendString(mci_command, ReturnString, sizeof(ReturnString), m_hWnd);

// close the device
sprintf(mci_command,"close %s", ALIAS);
mci_err = mciSendString(mci_command, ReturnString, sizeof(ReturnString), m_hWnd); 
```

# asp.net - 带有基本 html 文本的 ASP.NET 网页

> ID：1009229
> 
> 赞同：1
> 
> 时间：2009-06-17T19:59:27.903
> 
> 标签：asp.net, html

我有一个特定的内容页面（带有现有的母版页），其中几乎只是包含一些`<p>, <ul>/<li>, <h3>, <h4>, <blockquote>`标签的基本文本......就像一篇博客文章。
可以将所有这些 html 硬编码到我的内容页面中吗？是否有更好的方法（设计方面）将文本放入 ASP.NET 网页？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T20:01:25.560

是的，没关系。只要确保如果您实际使用的是内容页面（因为它是母版页的子页面），您将所有 HTML 保存在 ContentPlaceHolders 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T20:04:12.323

查看 MasterPages，它允许您定义一个基本模板，然后您的每个页面将仅包含一个您可以填写的内容部分，从而无需每次都拥有所有额外的模板代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T20:05:13.150

传统的 HTML 非常适合 aspx 页面。

您可以创建一个母版页（右键单击项目 -> 添加新项目 -> 选择母版页）。配置此页面后，每次创建新的 aspx 页面时，选择您刚刚创建的母版页作为母版页模板。Visual Studio 将创建一个包含`<asp:content>`标签的基本布局。只需将您的 HTML 标记放在那里。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T20:09:31.223

这取决于项目的目标......如果您认为这将发展成为一个大项目，您应该考虑使用[模板](http://csharp-source.net/open-source/template-engines):)

# qt - Qt 构建错误

> ID：1009240
> 
> 赞同：1
> 
> 时间：2009-06-17T20:02:16.573
> 
> 标签：qt, embedded, makefile, arm

配置后

```
$./configure -embedded arm -xplatform qws/linux-arm-g++ -opensource 
```

我在制作时得到这个输出，但不知道为什么：

../../src/corelib/arch/qatomic_arm.h: 在函数`char q_atomic_swp(volatile char*, char)': ../../src/corelib/arch/qatomic_arm.h:125: warning: address requested for`ret' 中，声明为`register' global/qlibraryinfo.cpp: In function`void qt_core_init_boilerplate()': global/qlibraryinfo.cpp:581: `__builtin_exit' undeclared (first use this function) global/qlibraryinfo.cpp:581: (Each undeclared identifier is reported only once for each function it appears in.) global/qlibraryinfo.cpp:573: warning: statement with no effect global/qlibraryinfo.cpp:573: warning: statement with no effect global/qlibraryinfo.cpp:574: warning: statement with no effect global/qlibraryinfo.cpp:574: warning: statement with no effect global/qlibraryinfo.cpp:575: warning: statement with no effect global/qlibraryinfo.cpp:576: warning: statement with no effect global/qlibraryinfo.cpp:576: warning: statement with no effect global/qlibraryinfo.cpp:577: warning: statement with no effect global/qlibraryinfo.cpp:578: warning: statement with no effect global/qlibraryinfo.cpp:578: warning: statement with no effect global/qlibraryinfo.cpp:579: warning: statement with no effect global/qlibraryinfo.cpp:580: warning: statement with no effect global/qlibraryinfo.cpp:580: warning: statement with no effect make[1]: *** [.obj/release-shared-emb-arm/qlibraryinfo.o] Error 1 make[1]: Leaving directory`/home/bsalmi/Desktop/qt-embedded-linux -opensource-src-4.5.1/src/corelib' make: *** [sub-corelib-make_default-ordered] 错误 2

谁能告诉我可能是什么问题或要调查什么？

谢谢你布莱斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T20:12:11.340

从 QT 邮件列表中查看此帖子：

[http://lists.trolltech.com/pipermail/qt-embedded-interest/2009-March/000224.html](http://lists.trolltech.com/pipermail/qt-embedded-interest/2009-March/000224.html)

# java - 仅从文件中读取一个整数的最有效习惯用法？

> ID：1009250
> 
> 赞同：3
> 
> 时间：2009-06-17T20:04:52.200
> 
> 标签：java, file, performance, io

在尝试解决 Facebook 的拼图“Hoppity Hop” [http://www.facebook.com/careers/puzzles.php?puzzle_id=7](http://www.facebook.com/careers/puzzles.php?puzzle_id=7)时，我只从文件中读取一个整数。我想知道这是否是最有效的机制？

```
private static int readSoleInteger(String path) throws IOException {
    BufferedReader buffer = null;
    int integer = 0;

    try {
        String integerAsString = null;

        buffer = new BufferedReader(new FileReader(path));

        // Read the first line only.
        integerAsString = buffer.readLine();

        // Remove any surplus whitespace.
        integerAsString = integerAsString.trim();

        integer = Integer.parseInt(integerAsString);
    } finally {
        buffer.close();
    }

    return integer;
} 
```

我已经看到[如何从文件的内容创建 Java 字符串？](https://stackoverflow.com/questions/326390/how-to-create-a-java-string-from-the-contents-of-a-file)，但我不知道回答这个问题的成语的效率。

查看我的代码，似乎有很多代码行和对象用于一个微不足道的问题......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T20:08:11.880

*最短*的方法是使用[`Scanner`](http://java.sun.com/javase/6/docs/api/java/util/Scanner.html)：

```
private static int readSoleInteger(String path) {
    Scanner s = new Scanner(new File(path));
    int ret = s.nextInt();
    s.close();
    return ret;
} 
```

请注意，`Scanner`燕子 any `IOExceptions`，这样可以简化很多事情。

至于“最有效”......好吧，从磁盘打开文件的简单行为可能是您为此编写的任何方法中最慢的部分。在这种情况下不要太担心效率。

**编辑：**我没有意识到整数的两边都可以有空格。我的代码目前没有考虑到这一点，但很容易让`Scanner` [skip things](http://java.sun.com/javase/6/docs/api/java/util/Scanner.html#skip(java.lang.String))。我已经添加了行

```
s.skip("\\s+"); 
```

纠正这一点。

**编辑2：**没关系，`Scanner`在尝试解析数字时忽略空格：

> 可以由此类的实例解析为数字的字符串根据以下正则表达式语法指定：
> 
> > （正则表达式被剪断）
> 
> 空格在上述正则表达式中并不重要。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T20:08:09.570

我会使用[Scanner](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Scanner.html)类：

```
Scanner sc = new Scanner(new File("my_file"));
int some_int = sc.nextInt(); 
```

# c++ - 以编程方式从 Unix 中的用户名获取 UID 和 GID？

> ID：1009254
> 
> 赞同：18
> 
> 时间：2009-06-17T20:06:10.853
> 
> 标签：c++, c, unix, privileges, system-calls

我正在尝试使用 setuid() 和 setgid() 来设置程序的相应 id 以从 root 中删除权限，但是要使用它们，我需要知道要更改为的用户的 uid 和 gid。

是否有系统调用来执行此操作？我不想对其进行硬编码或从 /etc/passwd 解析。

我也想以编程方式而不是使用：

id -u 用户名

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-17T20:09:55.557

看看[getpwnam()](http://linux.die.net/man/3/getpwnam)和[getgrnam()](http://linux.die.net/man/3/getgrnam)函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T20:36:49.467

```
#include <sys/types.h>
#include <pwd.h>
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>

int main()
{
    char *username = ...

    struct passwd *pwd = calloc(1, sizeof(struct passwd));
    if(pwd == NULL)
    {
        fprintf(stderr, "Failed to allocate struct passwd for getpwnam_r.\n");
        exit(1);
    }
    size_t buffer_len = sysconf(_SC_GETPW_R_SIZE_MAX) * sizeof(char);
    char *buffer = malloc(buffer_len);
    if(buffer == NULL)
    {
        fprintf(stderr, "Failed to allocate buffer for getpwnam_r.\n");
        exit(2);
    }
    getpwnam_r(username, pwd, buffer, buffer_len, &pwd);
    if(pwd == NULL)
    {
        fprintf(stderr, "getpwnam_r failed to find requested entry.\n");
        exit(3);
    }
    printf("uid: %d\n", pwd->pw_uid);
    printf("gid: %d\n", pwd->pw_gid);

    free(pwd);
    free(buffer);

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T20:10:11.330

您想使用 getpw* 系列系统调用，通常在[pwd.h](http://www.opengroup.org/onlinepubs/000095399/basedefs/pwd.h.html)中。它本质上是 /etc/passwd 中信息的 C 级接口。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-10-19T07:47:36.177

您可以使用以下代码片段：

```
#include <pwd.h>
#include <grp.h>

gid_t Sandbox::getGroupIdByName(const char *name)
{
    struct group *grp = getgrnam(name); /* don't free, see getgrnam() for details */
    if(grp == NULL) {
        throw runtime_error(string("Failed to get groupId from groupname : ") + name);
    } 
    return grp->gr_gid;
}

uid_t Sandbox::getUserIdByName(const char *name)
{
    struct passwd *pwd = getpwnam(name); /* don't free, see getpwnam() for details */
    if(pwd == NULL) {
        throw runtime_error(string("Failed to get userId from username : ") + name);
    } 
    return pwd->pw_uid;
} 
```

参考：[getpwnam()](http://linux.die.net/man/3/getpwnam) [getgrnam()](http://linux.die.net/man/3/getgrnam)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T20:11:29.737

查看 getpwnam 和 struct passwd。

# visual-studio-2005 - VS2005 从 GAC 加载项目引用

> ID：1009257
> 
> 赞同：0
> 
> 时间：2009-06-17T20:06:31.587
> 
> 标签：visual-studio-2005, reference

我正在使用 VS2005（还没有移到 2008 年，因为我仍在使用一些遗留工具）并且对项目引用的工作方式有疑问。

如果我对已部署到 GAC 的项目进行项目引用，VS 将使用 GAC 中的程序集。当我在 GACed 程序集中有旧代码并且我正在更改代码并对它们进行快速测试时，这很烦人 - 我必须每次 GAC 新代码，或者从 GAC 中删除程序集，这样 VS 就无法得到它从那里。

有没有办法打败这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T20:12:43.993

你不能只是改变引用，直接指向DLL吗？更好的是，如果您更改 DLL，使用项目作为参考而不是 GAC DLL？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T20:11:12.950

将引用复制到本地。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T20:25:29.847

解决此问题的最佳方法是两步过程。

1.) 在您的 GAC 的 DLL 中升级次要版本号。(1.0 到 1.1) 2.) 更新项目引用复制到本地，并使用新的版本号。

这个“应该”让它工作，但对于 GAC，它并不总是 100%。

您可以使用策略文件的路径来阻止 GAC 加载……但这会变得更加复杂。

# javascript - 如果用户当前在页面上处于活动状态，如何使用 JavaScript/jQuery 检测？

> ID：1009260
> 
> 赞同：44
> 
> 时间：2009-06-17T20:07:00.010
> 
> 标签：javascript, jquery

我需要检测用户何时在当前页面上处于非活动状态（未单击或键入）超过 30 分钟。

我认为最好使用附加到身体标签的事件冒泡，然后继续重置计时器 30 分钟，但我不完全确定如何创建它。

我有可用的 jQuery，尽管我不确定其中有多少会实际使用 jQuery。

**编辑：**我更需要知道他们是否正在积极使用该网站，因此单击（更改字段或字段内的位置或选择复选框/单选）或键入（在输入、文本区域等中）。如果他们在另一个选项卡中或使用另一个程序，那么我的假设是他们没有使用该站点，因此应该注销（出于安全原因）。

**编辑#2：**所以每个人都很清楚，这根本不是用来确定用户是否已登录、已通过身份验证或其他任何东西。现在，如果用户在 30 分钟内未发出页面请求，服务器将注销用户。此功能可防止有人花费超过 30 分钟填写表单然后提交表单却发现他们尚未注销的时间。因此，这将与服务器站点结合使用，以确定用户是否处于非活动状态（未单击或键入）。基本上，交易是在闲置 25 分钟后，他们将看到一个输入密码的对话框。如果它们在 5 分钟内没有，系统会自动将它们注销，并且服务器的会话也会注销（下次访问页面时，与大多数站点一样）。

Javascript 仅用作对用户的警告。如果 JavaScript 被禁用，那么他们将不会收到警告，并且（以及大多数网站无法正常工作）他们将在下次请求新页面时注销。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-06-17T20:40:17.807

这就是我想出的。它似乎在大多数浏览器中都可以使用，但我想确保它始终可以在任何地方工作：

```
var timeoutTime = 1800000;
var timeoutTimer = setTimeout(ShowTimeOutWarning, timeoutTime);
$(document).ready(function() {
    $('body').bind('mousedown keydown', function(event) {
        clearTimeout(timeoutTimer);
        timeoutTimer = setTimeout(ShowTimeOutWarning, timeoutTime);
    });
}); 
```

有人看到任何问题吗？

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-17T20:08:28.447

您可以观看[鼠标移动](http://docs.jquery.com/Events/mousemove#fn)，但这大约是您在不听点击事件的情况下指示用户仍然在那里的最好情况。但是 javascript 无法判断它是否是活动选项卡，或者浏览器是否已打开。（嗯，你可以得到浏览器的宽度和高度，这会告诉你它是否被最小化）

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2014-03-03T12:09:38.300

[Ifvisible.js](https://github.com/serkanyersen/ifvisible.js)是一个跨浏览器的轻量级解决方案，可以做到这一点。它可以检测用户何时切换到另一个选项卡并返回到当前选项卡。它还可以检测用户何时空闲并再次变为活动状态。它非常灵活。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-06-17T20:40:06.590

我最近才做了这样的事情，尽管使用的是 Prototype 而不是 JQuery，但我想只要 JQuery 支持自定义事件，实现就会大致相同。

简而言之，IdleMonitor 是一个观察鼠标和键盘事件的类（根据您的需要进行相应调整）。每 30 秒它会重置计时器并广播一个 state:idle 事件，除非它收到一个鼠标/键事件，在这种情况下它会广播一个 state:active 事件。

```
var IdleMonitor = Class.create({

    debug: false,
    idleInterval: 30000, // idle interval, in milliseconds
    active: null,
    initialize: function() {
        document.observe("mousemove", this.sendActiveSignal.bind(this));
        document.observe("keypress", this.sendActiveSignal.bind(this));
        this.timer = setTimeout(this.sendIdleSignal.bind(this), this.idleInterval);
    },

    // use this to override the default idleInterval
    useInterval: function(ii) {
        this.idleInterval = ii;
        clearTimeout(this.timer);
        this.timer = setTimeout(this.sendIdleSignal.bind(this), ii);
    },

    sendIdleSignal: function(args) {
        // console.log("state:idle");
        document.fire('state:idle');
        this.active = false;
        clearTimeout(this.timer);
    },

    sendActiveSignal: function() {
        if(!this.active){
            // console.log("state:active");
            document.fire('state:active');
            this.active = true;
            this.timer = setTimeout(this.sendIdleSignal.bind(this), this.idleInterval);
        }
    }
}); 
```

然后我刚刚创建了另一个类，其中包含以下内容：

```
Event.observe(document, 'state:idle', your-on-idle-functionality);
Event.observe(document, 'state:active', your-on-active-functionality) 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-09-22T04:59:17.897

[Ifvisible](http://serkanyersen.github.io/ifvisible.js/)是一个很好的 JS 库，用于检查用户的不活动状态。

```
ifvisible.setIdleDuration(120); // Page will become idle after 120 seconds

ifvisible.on("idle", function(){
   // do something
}); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-17T20:13:19.310

使用 jQuery，您可以轻松地观察鼠标移动，并使用它将指示活动的变量设置为 true，然后使用 vanilla javascript，您可以每 30 分钟（或任何其他时间间隔）检查此变量以查看其是否为 true。如果它是错误的，请运行您的函数或其他任何东西。查找 setTimeout 和 setInterval 进行计时。您可能还必须每分钟左右运行一次函数才能将变量重置为 false。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-18T03:45:41.037

如果这是一个安全问题，那么使用 javascript 执行此客户端绝对是执行此检查的错误管道的一端。用户可以很容易地禁用 javascript：那么您的应用程序会做什么？如果用户在超时之前关闭浏览器会怎样。他们有没有被注销？

大多数服务器端框架都有某种用于登录的会话超时设置。只需使用它并为自己节省工程工作。

您不能依赖人们在没有 javascript 的情况下无法登录的假设，因此用户拥有 javascript。这样的假设对任何坚定的，甚至受过适度教育的攻击者都没有威慑力。

为此使用 javascript 就像是一名保安将银行金库的钥匙交给客户。它起作用的唯一方法是信仰。

当我说以这种方式使用 javascript（并且需要 javascript 进行登录！！）是设计任何类型的 Web 应用程序时，请相信我。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-17T20:23:38.230

这是我的镜头：

```
var lastActivityDateTime = null;

function checkActivity( )
{
    var currentTime = new Date();
    var diff = (lastActivityDateTime.getTime( ) - currentTime.getTime( ));
    if ( diff >= 30*60*1000)
    {
        //user wasn't active;
        ...
    }
    setTimeout( 30*60*1000-diff, checkActivity);
}

setTimeout( 30*60*1000, checkActivity); // for first time we setup for 30 min.

// for each event define handler and inside update global timer
$( "body").live( "event_you_want_to_track", handler);

function handler()
{
   lastActivityDateTime = new Date();
   // rest of your code if needed.
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-18T04:18:06.887

如果不使用 JS，一种更简单（更安全）的方法就是将 lastActivity 时间戳与用户会话一起存储并在页面加载时检查它。假设您使用的是 PHP（您可以轻松地为另一个平台重做此代码）：

```
if(($_SESSION['lastAct'] + 1800) < time()) {
    unset($_SESSION);
    session_destroy();
    header('Location: session_timeout_message.php');
    exit;
}

$_SESSION['lastAct'] = time(); 
```

并将其添加到您的页面中（可选，无论页面是否刷新，用户都将被注销（因为他在下一页日志中注销））。

```
<meta http-equiv="refresh" content="1801;" /> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-09-23T18:18:36.397

您可以根据用户的活动状态向文档添加和删除类。

```
// If the window is focused, a mouse wheel or touchmove event is detected
$(window).on('focus wheel touchmove', function() {
  $( 'html' ).addClass('active').removeClass('inactive');
});

// If the window losses focus
$(window).on('blur', function() {
  $( 'html' ).addClass('inactive').removeClass('active');
});
```

之后，您可以每隔一段时间检查 html 是否具有“活动”类并发送 AJAX 请求以检查会话状态并执行您需要的操作：

```
setInterval( function() {
  if ( $( 'html' ).hasClass('active') ) {
  //Send ajax request to check the session
    $.ajax({
      //your parameters here
    });
  }
}, 60000 ); /* loops every minute */
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-06-19T16:31:47.447

If your concern is the lost of information for the user after a login timeout; another option would be to simply store all the posted information upon the opening of a new session (a new session will always be started when the older session has been closed/scrapped by the server) when the request to a page is made before re-routing to the logging page. If the user successfully login, then you can use this saved information to return the user back to where he was. This way, even if the user walk away a few hours, he can always return back to where he was after a successful login; without losing any information.

This require more work by the programmer but it's a great feature totally appreciated by the users. They especially appreciate the fact that they can fully concentrate about what they have to do without stressing out about potentially losing their information every 30 minutes or so.

# asp.net-mvc - 什么时候可以在 ASP.NET MVC 中使用 ViewData 字典？

> ID：1009262
> 
> 赞同：1
> 
> 时间：2009-06-17T20:07:36.483
> 
> 标签：asp.net-mvc

似乎大多数人倾向于为每个视图创建单个 ModelView（[Thunderdome 原则](http://codebetter.com/blogs/jeremy.miller/archive/2008/10/23/our-opinions-on-the-asp-net-mvc-introducing-the-thunderdome-principle.aspx)），而不是将弱类型项填充到 ViewData 字典中。

那么，考虑到这一点，ViewDictionary 应该用于哪些任务呢？真的很小的一次性意见？完全不使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T20:25:29.303

永远不要，保持所有的强类型。有助于重构，仅凭理由就足够了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T20:43:38.877

MasterPages 让我觉得很难绕过它们。假设您在所有页面上都有一个标准位置，将显示错误消息。从理论上讲，您*可以*对 MasterPage 进行强类型化，并确保所有视图模型都从某个基类继承，该基类使您可以对变量进行强类型访问，以在母版页中设置错误消息，但这似乎有点矫枉过正。这样做更合理：

```
ViewData["ErrorMessage"] = "This is an error message"; 
```

并让您的母版页有一个显示它的部分：

```
<div class="error_message"><%= ViewData["ErrorMessage"] %></div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T20:21:28.967

我认为问题是：*在不和何时使用强类型视图？*. 如果您的视图不是强类型的，那么您将使用 ViewDataDictionary（主要用于简单/小型应用程序）。如果您正在使用单元测试，最好使用可以简单测试的视图模型。

# c# - 用 C# 学习 Windows 窗体编程的好项目是什么？

> ID：1009269
> 
> 赞同：3
> 
> 时间：2009-06-17T20:08:28.790
> 
> 标签：c#

我想学习 c#，这样我就可以做一些桌面开发。我开发了命令行 C# 应用程序并希望扩展到桌面应用程序。

我正在考虑创建一个像 Jing 这样的屏幕截图工具，或者可能是一个 Outlook 插件，以将联系人信息与 Google 等服务同步。

你觉得呢？你有没有什么想法？我过去的经验是使用 PHP 构建的 Web 应用程序。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T20:11:50.860

我会尝试从一些相当包含的东西开始，它只涉及一些新技术。例如，如果您想学习 Windows 窗体，请编写一些使用它但*不需要*与 Outlook、Google 或 Win32 API 对话的东西。一旦您掌握了 Windows 窗体的窍门，就可以尝试*一种*额外的技术——例如，尝试显示您的 Google 联系人并进行离线编辑。然后添加另一种技术......等等。

以我的经验，一次学习一项新技术已经够难的了——但这比一次学习两项或多项技术要快得多。您不可避免地会进入不知道问题出在哪里的阶段，并且您对任何代码都没有信心，因为它是*全新*的。如果您还是该*语言*的新手，这一点尤其重要 - 尽管我很高兴听到您开始使用一些控制台应用程序 :)

对不起，如果这听起来像我是一个湿毯子，我意识到听起来你需要更长的时间才能获得有用的东西，但我认为从长远来看你更有可能成功。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T20:13:11.527

找到最重要的让你感兴趣和兴奋的东西。如果你选择了一些你不关心的太无聊的东西，你只会在你到达任何地方之前就放弃，并且根本不会受益。不要为了学习语言而做垃圾项目。做一个好的项目，并用一种​​新的语言做它作为副作用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T20:35:52.293

制作记事本克隆。虽然相当简单，但它将为您提供一些基本的 Windows 窗体机制的入门知识，例如使用菜单和对其事件做出反应、从控件获取输入以存储在磁盘上、从磁盘读取和更新控件、使用对接和锚定等等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T20:22:52.990

做一些你以前做过的事情，但是用另一种语言。这样您就不必再次考虑特定任务的大部分架构，但您将能够比较语言、框架及其方法。

*我敢打赌，在做这个练习的同时，你也会学到很多关于你以前的语言的知识。*

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T20:10:09.350

Twitter 客户端是新的`hello world`.

前几天我在某个地方读到了。我不能个人评论它是否适合你的目标。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T20:10:59.830

一个好的项目将是一个简单的 Windows 窗体。你只是有机会将所有东西放在一起。或者至少看到一个更大的图景。您可以根据需要将其复杂化，而不必拘泥于一个领域。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T21:38:45.940

建议一个特定的项目是没有意义的。想想你感兴趣的东西，或者你想要/需要的应用程序，然后开始制作 - 每当你无法猜测如何执行特定任务时搜索 Stackoverflow/Google/MSDN/等。

例如，我必须制作允许客户注册公司邮件列表的信息亭应用程序。我尝试使用 Ruby 框架 Shoes，但它在运行应用程序的笔记本电脑上无法正常工作。Visual C# 似乎更合适，并且几乎可以肯定会正确运行..

所以我安装了 Visual C# Express，添加了一些标签和一个按钮。我双击按钮，意识到我不知道创建新 WinForm 窗口的代码。所以我在 Google 上搜索“visual C# open new dialog”之类的东西，我发现我必须添加一个新表单，然后打电话`NewForm newwindow = new NewForm(); newwindow.show();`或类似。

然后，我添加了用户名/电子邮件字段，然后搜索“如何显示警报框”并检查我是否可以显示表单值。

这一切都奏效了，所以现在我必须决定如何存储电子邮件。我听说过关于 LINQ to SQL 的好消息，所以研究了一下，决定我想使用 SQL Server CE（所以我不必在笔记本电脑上安装/运行 SQL Server）。这导致更多地搜索如何使 LINQ to SQL 与 SQL Server CE 一起工作。

最后，我想要一个配置面板来更改标题/按钮字符串等（可通过某个键盘快捷键访问）。谷歌搜索揭示了如何捕捉击键，我问了一个关于表示设置的 Stackoverflow 问题（使用 PanelView或者其他的东西）

..无论如何，这个略长、漫无边际且不是很有趣的故事的重点是.. 只要您有一个特定的应用程序，您就可以一次学习许多新技术（并且您决心完成它！）

我在一天之内学习了 C#、WinForms、SQL Server CE、LINQ to SQL 和简单的应用程序发布内容——在此过程中创建了一个功能强大、有用的应用程序——只需结合推动、谷歌搜索和 Stackoverflow..

# entity-framework - 在实体框架中，如何使用主键的子集创建引用约束？

> ID：1009272
> 
> 赞同：4
> 
> 时间：2009-06-17T20:09:29.443
> 
> 标签：entity-framework

我的数据模型包含两个具有复合主键的表和一个关联表。部分复合主键在表之间是通用的。

```
SitePrivilege
-------------
SiteId
PrivilegeId

UserSite
--------
SiteId
UserId

UserSitePrivilege
-----------------
UserId
SiteId
PrivilegeId 
```

我创建了一个 SitePrivilege 实体和一个 UserSite 实体。我已将它们之间的多对多关联映射到 UserSitePrivilege。

```
<Association Name="UserSiteSitePrivilege">
  <End Type="PrivilegeModel.UserSite" Multiplicity="*" Role="UserSite" />
  <End Type="PrivilegeModel.SitePrivilege" Multiplicity="*" Role="SitePrivilege" />
</Association>
...
<AssociationSetMapping Name="UserSiteSitePrivilege" TypeName="PrivilegeModel.UserSiteSitePrivilege" StoreEntitySet="UserSitePrivilege">
  <EndProperty Name="SitePrivilege">
    <ScalarProperty Name="PrivilegeId" ColumnName="PrivilegeId" />
    <ScalarProperty Name="SiteId" ColumnName="SiteId" />
  </EndProperty>
  <EndProperty Name="UserSite">
    <ScalarProperty Name="SiteId" ColumnName="SiteId" />
    <ScalarProperty Name="UserId" ColumnName="UserId" />
  </EndProperty>
</AssociationSetMapping> 
```

上面的代码会产生这个错误：

> 表 UserSitePrivilege 中的以下列每一列都映射到多个概念性侧属性： UserSitePrivilege.SiteId 映射到 UserSiteSitePrivilegeSitePrivilege.SiteId、UserSiteSitePrivilege.UserSite.SiteId

所以我添加了一个引用约束。

```
<Association Name="UserSiteSitePrivilege">
  <End Type="PrivilegeModel.UserSite" Multiplicity="*" Role="UserSite" />
  <End Type="PrivilegeModel.SitePrivilege" Multiplicity="*" Role="SitePrivilege" />
  <ReferentialConstraint>
    <Principal Role="UserSite">
      <PropertyRef Name="SiteId"/>
    </Principal>
    <Dependent Role="SitePrivilege">
      <PropertyRef Name="SiteId"/>
    </Dependent>
  </ReferentialConstraint>
</Association>
...
<AssociationSetMapping Name="UserSiteSitePrivilege" TypeName="PrivilegeModel.UserSiteSitePrivilege" StoreEntitySet="UserSitePrivilege">
  <EndProperty Name="SitePrivilege">
    <ScalarProperty Name="PrivilegeId" ColumnName="PrivilegeId" />
    <ScalarProperty Name="SiteId" ColumnName="SiteId" />
  </EndProperty>
  <EndProperty Name="UserSite">
    <ScalarProperty Name="SiteId" ColumnName="SiteId" />
    <ScalarProperty Name="UserId" ColumnName="UserId" />
  </EndProperty>
</AssociationSetMapping> 
```

现在它产生了这个错误：

> 主体角色 UserSite 引用的属性必须与关系 PrivilegeModel.UserSiteSitePrivilege 的关系约束中的主体角色引用的 EntityType PrivilegeModel.UserSite 的键完全相同。确保在 Principal Role 中指定了所有关键属性。

如何正确建模这种关系？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T22:45:01.237

3.5 SP1 不支持像这样的重叠 FK。

IE

```
UserSitePrivilege
----------
UserId 
SiteId
PrivilegeId

PK => UserId, SitedId, PrivilegeId
FK1 => UserId, SiteId
FK2 => SiteId, PrivilegeId 
```

FK1 与 FK2 重叠。这将在 EF 4 的 Beta2 中得到支持。这是因为 FK 关联（在 Beta2 中可用）比独立关联（在 3.5 SP1 和 4.0 Beta 1 中拥有的）灵活得多。

[有关FK 协会](http://blogs.msdn.com/efdesign/archive/2009/03/16/foreign-keys-in-the-entity-framework.aspx)的更多信息，请参阅此帖子

与此同时，您唯一的选择可能是将所有这些隐藏在 DefiningQueries 和 CUD 程序等后面。

*   亚历克斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T21:11:29.227

如果您的主键是复合键，那么您的所有外键关系也必须使用整个复合键（所有键列）作为参考 - 我看不出有任何方法可以解决这个问题，这是关系数据库的基本原则设计，真的。

这绝对是我可能会选择在主表上使用替代列作为主键的主要原因之一，而不是由实际数据列组成的复合键。

**更新：**是的，根据您的评论，您是绝对正确的 - 数据库设计是可靠的。不太清楚为什么 EF 不能处理这个....

马克

# asp.net - 使用实体框架 (.NET 3.5) 的项目经验

> ID：1009279
> 
> 赞同：2
> 
> 时间：2009-06-17T20:10:32.983
> 
> 标签：asp.net, entity-framework

我们正在考虑/评估新的 ASP.NET 项目的 EF。

请告知您是否在项目中使用或曾经使用过 EF v1？还请说明您在 Web 或桌面应用程序中使用 EF 的体验如何？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T20:24:10.583

我们将 EF 用于中型内部项目。它是一个 n 层应用程序，其中包含一个包含业务逻辑的服务器和一个自包含的 EF 层。客户端是一个 WPF 应用程序（通过 WCF 连接到服务器）。

EF 有很多值得喜欢的地方，它可以让你的 DA 层的某些方面非常快速地编写，但我要说的一件事是它目前对断开连接的应用程序没有很好的支持。如果您的应用程序非常自包含，直接连接到数据库并始终使用 1 个数据上下文，那么它的工作效果非常好，数据上下文管理您的数据对象，从数据库中提取数据并适当地更新数据库。

一旦您尝试以任何形式的 n 层结构断开您的客户端，尽管事情变得更加困难。您要么必须管理从数据上下文断开和重新连接实体，要么必须以某种方式将数据上下文序列化到客户端。您必须使用多个数据上下文（部分原因是我们无论如何都是无状态服务器，但也因为您试图为多个客户端使用单个数据上下文会陷入混乱），这一切都变得有点难以管理。我们解决方案的一部分是拥有从较低级别的“ef 数据对象”创建的单独的“业务对象”。然后 EF 将管理这些数据对象（将它们持久化并从数据库中加载它们等），但我们自己的 BLL 层将管理业务对象。

总而言之，一切正常，但事后看来，我认为 EF 还没有完全准备好进行严肃的企业级开发。我听说 .net 4.0 中的下一个版本的 EF 对断开连接和 n 层应用程序有更好的支持，但我个人并没有对此感到厌烦。

# ruby - 如何在 Ruby 中执行向量加法？

> ID：1009280
> 
> 赞同：13
> 
> 时间：2009-06-17T20:10:37.053
> 
> 标签：ruby

如何在 Ruby 中执行矢量加法，以便

```
[100, 100] + [2, 3] 
```

产量

```
[102, 103] 
```

（而不是加入两个数组）？

或者它也可以是另一个运算符，例如

```
[100, 100] @ [2, 3] 
```

或者

```
[100, 100] & [2, 3] 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-06-18T04:57:05.530

参见[向量](http://ruby-doc.org/stdlib/libdoc/matrix/rdoc/Vector.html)类：

```
require "matrix"

x = Vector[100, 100]
y = Vector[2, 3]
print x + y

E:\Home> ruby t.rb
Vector[102, 103] 
```

有关向量的其他操作，请参见[vectorops ：](https://github.com/psorowka/vectorops)

> …以下操作按预期工作

```
 v1 = Vector[1,1,1,0,0,0]
  v2 = Vector[1,1,1,1,1,1]

  v1[0..3]
  # -> Vector[1,1,1]

  v1 += v2
  # -> v1 == Vector[2,2,2,1,1,1]

  v1[0..3] += v2[0..3]
  # -> v1 == Vector[2,2,2,0,0,0]

  v1 + 2
  # -> Vector[3,3,3,1,1,1] 
```

另请参见[向量操作](https://github.com/psorowka/vectorops)。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-17T21:18:01.897

数组#zip：

```
$ irb
irb(main):001:0> [100,100].zip([2,3]).map { |e| e.first + e.last }
=> [102, 103] 
```

更短：

```
irb(main):002:0> [100,100].zip([2,3]).map { |x,y| x + y }
=> [102, 103] 
```

用#inject 推广到 >2 维：

```
irb(main):003:0> [100,100,100].zip([2,3,4]).map { |z| z.inject(&:+) }
=> [102, 103, 104] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T20:22:25.360

或者，如果您想要该种类的任意维度行为（例如数学向量加法）

```
 class Vector < Array
   def +(other)
     case other
     when Array
       raise "Incorrect Dimensions" unless self.size == other.size
       other = other.dup
       self.class.new(map{|i| i + other.shift})
     else
       super
     end
   end
 end

class Array
  def to_vector
    Vector.new(self)
  end
end 

[100,100].to_vector + [2,3] #=> [102,103] 
```

缺少 lisp 风格的地图是非常令人讨厌的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-18T05:09:26.207

在罗马时..monkeypatch。

```
module Enumerable
  def sum
    inject &:+
  end

  def vector_add(*others)
    zip(*others).collect &:sum
  end
end 
```

然后你可以做 a.vector_add(b) 并且它可以工作。我相信这需要 Ruby 1.8.7，或添加 Symbol.to_proc 的扩展。您也可以通过这种方式添加任意数量的向量。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-05-23T11:50:34.053

顺便说一句，如果您（像我一样）对 ruby​​ 的默认 Vector 类提供的操作不满意，请考虑给我的 gem [https://github.com/psorowka/vectorops](https://github.com/psorowka/vectorops)看看，它增加了一些我的功能期望从适当的 Vector 实现。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T21:42:42.173

```
module PixelAddition
  def +(other)
    zip(other).map {|num| num[0]+num[1]}
  end
end 
```

然后，您可以创建一个混合在模块中的 Array 子类，或者将行为添加到特定数组，例如：

```
class <<an_array
  include PixelAddition
end 
```

# javascript - 为什么我的自定义标记没有显示在 Google 地图中？

> ID：1009299
> 
> 赞同：1
> 
> 时间：2009-06-17T20:13:13.663
> 
> 标签：javascript, google-maps

想知道是否有人可以帮助我，地图显示正常，但标记可以。

```
 <script type="text/javascript" src="http://maps.google.com/maps?file=api&amp;v=2&amp;sensor=false&amp;key=ABQIAAAAIoLIQYVphLGoM1pKOrQx0RSlCk5zF9psbOtT7Cn7bdX8qwZsZBTDgtPCGxlAzv6RxAThsHj0CmmZVg"></script>
    <script type="text/javascript">
  var myIcon = new GIcon();
myIcon.image = 'markers/image.png';
myIcon.printImage = 'markers/printImage.gif';
myIcon.mozPrintImage = 'markers/mozPrintImage.gif';
myIcon.iconSize = new GSize(45,46);
myIcon.shadow = 'markers/shadow.png';
myIcon.transparent = 'markers/transparent.png';
myIcon.shadowSize = new GSize(68,46);
myIcon.printShadow = 'markers/printShadow.gif';
myIcon.iconAnchor = new GPoint(23,46);
myIcon.infoWindowAnchor = new GPoint(23,0);
myIcon.imageMap = [39,1,40,2,41,3,41,4,41,5,41,6,41,7,41,
                   8,41,9,41,10,41,11,41,12,41,13,41,14,
                   41,15,41,16,41,17,41,18,41,19,41,20,41,
                   21,41,22,41,23,41,24,41,25,41,26,41,27,
                   41,28,41,29,41,30,41,31,41,32,40,33,39,
                   34,27,35,26,36,26,37,25,38,25,39,24,40,
                   24,41,23,42,23,43,22,44,22,45,22,45,22,
                   44,21,43,21,42,20,41,20,40,19,39,19,38,
                   18,37,18,36,17,35,5,34,4,33,3,32,3,31,3,
                   30,3,29,3,28,3,27,3,26,3,25,3,24,3,23,3,
                   22,3,21,3,20,3,19,3,18,3,17,3,16,3,15,3,
                   14,3,13,3,12,3,11,3,10,3,9,3,8,3,7,3,6,3,
                   5,3,4,4,3,4,2,6,1];
  myIcon.iconSize = new GSize(10, 10);
  myIcon.iconAnchor = new GPoint(5, 34);
  Imycon.infoWindowAnchor = new GPoint(5, 2);
  var markers = [{'latitude': 169.132892, 'longitude': -44.698667, 'name': 'dsfsdfljsldk' }]; var map;
  var centerLatitude = 18.17;
  var centerLongitude = 127.57;
  var startZoom = 2;
</script>
<script language="javascript">
    function initialize() {
      if (GBrowserIsCompatible()) {
        var map = new GMap2(document.getElementById("map_canvas"));
        map.setCenter(new GLatLng(51.83130, -0.21360), 15);
        map.setUIToDefault();
      }
    }
    </script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T20:26:35.493

您没有在地图上添加任何标记 - 除非您没有在此处发布所有代码。你需要做这样的事情：

```
var latlng = new GLatLng(169.132892,-44.698667);
var marker = new GMarker(latlng, {icon:myIcon, title:"dsfsdfljsldk"});
map.addOverlay(marker); 
```

# php - 在 Drupal 上实现组和组管理员

> ID：1009303
> 
> 赞同：0
> 
> 时间：2009-06-17T20:13:52.307
> 
> 标签：php, drupal, organic-groups

我是 Drupal 的新手，我想快速实现它，或者至少知道它是否可能以及如何进行。

这是这样的情况： 3 种类型的用户（角色）：SuperAdmin、GroupAdmin 和用户。

用户只是可以使用整个站点的用户。GroupAdmin 能够创建与其组关联的用户。他们只能管理他组中的用户。SuperAdmin 可以管理所有类型的帐户。

任何有关如何开始的信息将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T10:30:19.227

我很惊讶还没有人提到有[机组](http://drupal.org/project/og)模块。如果您将其与 Organic Groups 访问控制一起实施，它应该会为您提供所需的内容。

这是设置它的教程：[Organic Groups：使用户能够创建协作组](http://drupal.org/handbook/modules/og)

# browser - 基于 Web 的浏览器的问题

> ID：1009305
> 
> 赞同：1
> 
> 时间：2009-06-17T20:14:09.170
> 
> 标签：browser, proxy

我想开发一个 asp.net 网站，它获取一个地址作为输入并获取网站的所有内容并更改链接和 js 路径和 css 路径，从而使内容正确显示，然后 Response.Write 所有这些内容到我的网站。

我的问题是这项工作有什么问题，我的意思是安全性。当我将直接内容写入我的页面时会不会很危险？

同时，我想更改任何 CSS 链接，例如：

```
http://www.targetdomain.com/style.css 
```

到

```
http://www.mydomain.com/GetContent.aspx?url=http://www.targetdomain.com/style.css 
```

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T20:24:22.767

您想要的称为“代理”服务器。

不幸的是，没有简单的方法可以获取整个网页 - 以及所有相关内容 - 并将其作为单个 blob 反馈给请求者。您必须将每个单独的部分反馈给请求者，根据需要修改代码中的链接以使它们指向正确的内容。这不是一件容易的事。

鉴于您的位置，我猜您希望快速进行此设置。您最好下载许多代理软件包中的任何一个并安装它，而不是尝试自己编写它。

祝你好运。

# javascript - 通过 Eval 将多个参数传递给 Javascript 函数

> ID：1009307
> 
> 赞同：2
> 
> 时间：2009-06-17T20:14:25.080
> 
> 标签：javascript, asp.net, data-binding, gridview

我正在努力将三个参数从gridview的itemtemplate中传递给javascript函数：

对于一个参数，它工作正常：

```
<asp:HyperLink ID="hypComment" runat="server" Font-Bold="True"
NavigateUrl='<%# Eval("CCN", "javascript:ShowCommentPopUp({0});") %>'>Add
</asp:HyperLink> 
```

其中 CCN 是我在 gridview 中的列。这实际上将传递单击该行的 ccn：

我想再传递两个参数：“名称”和“状态”是对应的列，作为 ShowCommentPopUp 函数的第二个和第三个参数。我尝试了很多方法，但最终出现了所有语法错误。投入了大量的时间。

例如：

```
NavigateUrl='<%# Eval(["CCN", "NAME", "javascript:ShowCommentPopUp({0}, {1});") 
```

等等等等

如果有人可以帮助我，将不胜感激。

谢谢，阿帕纳

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T04:16:53.177

使用此代码，您可以解决您的问题：

```
<asp:HyperLink ID="hypComment" runat="server" Font-Bold="True" NavigateUrl="#" OnClick="<%# String.Format("javascript:return ShowCommentPopup(""{0}"",""{1}"")",Eval("CCN"),Eval("parametername"))  %>">
    Add
</asp:HyperLink> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T20:25:24.747

你的意思是`NavigateUrl='<%# Eval(["CCN", "NAME"], "javascript:ShowCommentPopUp({0}, {1});")`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-05T08:49:59.007

我有同样的问题和很多问题让它工作。

最终这对我有用：您必须将 eval 函数的结果值放在引号之间。而且这些引号一定是html保存的，所以把'字符换成'

至少对我来说，只有我的对话框才显示，其中包含三个参数。

```
<ItemTemplate>
   <asp:Button ID="btnEdit" CssClass="btnmaatwerksmall" runat="server" Text="Wijzig"
       OnClientClick='<%# String.Format("OpenChildNietInEnterprise(&apos;{0}&apos;,&apos;{1}&apos;,&apos;{2}&apos;);", Eval("CursusNaam"), Eval("VerwachteOmzetJaar"), Eval("VerwachteOmzetKomendeJaren")) %>' />
 </ItemTemplate> 
```

# bash - 定义变量以在 bash 中保存非当前日期

> ID：1009308
> 
> 赞同：0
> 
> 时间：2009-06-17T20:14:30.900
> 
> 标签：bash

从终端发出的以下命令让我得到昨天的日期：

```
date --date='1 day ago' +%Y/%m/%d 
```

我正在尝试编写一个 bash 脚本，其中天数是命令行参数。我希望能够将生成的日期存储在另一个变量中，并稍后在我的脚本中使用它。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T20:23:08.263

```
 x=$(date --date "$1 days ago" +%Y/%m/%d) 
```

`$1`第一个命令行参数在哪里。确保使用双引号而不是单引号，否则不会扩展参数。

# javascript - 我可以确定页面加载时复选框的默认状态是什么（或者 reset() 将其重置为什么值。）

> ID：1009311
> 
> 赞同：2
> 
> 时间：2009-06-17T20:15:58.540
> 
> 标签：javascript, html, dom

当一个 html 页面被加载时，不同的输入元素可以被初始化，因为它们在 HTML 中被声明。如果用户更改了一些输入值，然后在表单上执行 reset()，则表单将重置为其初始加载状态。

我的问题是，我可以使用 javascript 确定“初始元素状态是”吗（理想情况下是跨浏览器的方式？）

理想情况下是这样的（在哪里？？？？？？是我不知道该怎么做。）

```
<input type='checkbox' id='chkbox' checked />

<script>
alert('The initial state was ' ???? );
$('chkbox').checked = true
alert('The initial state was ' ???? );
</script> 
```

该脚本会说初始状态两次为“假”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T20:22:10.353

`radio`- 和`checkbox`-type`input`具有[`defaultChecked`](http://www.w3.org/TR/2000/WD-DOM-Level-1-20000929/level-one-html.html#ID-20509171)由 W3C 1 级和 2 级 HTML DOM 定义的属性。遗憾的是，[IE 仅在 IE8 中支持](http://msdn.microsoft.com/en-us/library/ms533715(VS.85).aspx)；我个人不知道 IE7 及之前的干净解决方案（尽管可能有一个！）。您可能必须执行以下操作：

```
// on page load:
$(':radio,:checkbox').each(function() {
    this.myDefaultChecked = this.checked;
}) 
```

您可能还想试验是否`el.getAttribute('checked')`返回初始值或当前值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T20:24:38.977

为什么不直接将状态保存在 document.ready 上？伪代码，暂时没时间测试

```
$(document).ready(function) ({
    var checked = $('chkbox').attr("checked");
    // any other actions on the checkbox
    alert("The initial state was" + checked);
}); 
```

这样，在复选框上执行的任何操作都不会影响变量，因为它是在事件之前保存的。

# svn - 将部分 SVN 存储库复制到新存储库？

> ID：1009314
> 
> 赞同：8
> 
> 时间：2009-06-17T20:16:41.630
> 
> 标签：svn, version-control

目前，我有一个大型 SVN 存储库，其中包含许多不同的项目，如下所示：

```
/
 Project1/
          trunk/
          tags/
          branches/
 Project2/
          trunk/
          tags/
          branches/
 Project3/ 
          (etc...) 
```

但是，我现在正尝试将其分解为单独的存储库（出于各种原因），并且我希望每个项目都具有以下内容：

```
/
 trunk/
 tags/
 branches/ 
```

如果可能，所有历史和外部因素都应该保持不变。但是，我不确定这是否真的可以做到。我在 SO 上看到了几个与此类似的问题，但没有一个能完全解决我在这里遇到的问题。基本上，我试图从旧存储库中“拉出”一个子目录及其全部内容，并将其全部放入它自己的（新）存储库中。

我在问不可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T20:38:34.190

采用

```
svnadmin dump path/to/repository > repo.dmp 
```

然后使用[svndumpfilter](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.maint.html#svn.reposadmin.maint.tk.svndumpfilter)仅将子树加载到新存储库中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-02T14:22:38.130

从 SVN 1.7 开始，您可以使用

```
svnrdump dump path/to/repository > dump 
```

得到转储。虽然 Stefans 解决方案有效，但它确实需要访问服务器托管 repo。svnrdump 可以在网络上使用您可以读取的任何 repo 工作。

# jquery - 我可以让 Jquery slideViewer 自动播放吗？

> ID：1009315
> 
> 赞同：0
> 
> 时间：2009-06-17T20:16:53.110
> 
> 标签：jquery

关于从（2007-2009 Gian Carlo Mingati | 交互式媒体的设计和开发）自动播放制作 slideViewr 插件的任何想法？

我尝试升级到 slideViewerPro，但不喜欢缩略图和其他东西。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-12-13T16:02:12.903

以上在 Internet Explorer 中不起作用。相反，我建议将其调整为：

```
<script type="text/javascript">
var theLinks;
var nCount = 0;
var theTimerID;

function init(){
    $("div#mygalone").slideView();
    theLinks = jQuery('#stripTransmitter0 a');

        //for kill interval purposes
        theTimerID = setInterval("autoSlide()", 5000);
}
function autoSlide(){
    jQuery.each(theLinks, function(i){
        if(jQuery(this).hasClass('current')){
            jQuery(theLinks[((i+1 < theLinks.length) ? (i+1) : 0)] ).trigger("click");
            return false;
        }
    });
}

$(window).bind("load", init );
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T19:49:38.530

在我看来，您基本上有 3 个选项：

**(1)** - 使用 slideViewPro，但使用`thumbsVis:false`如下所示的选项禁用缩略图

```
$("div#noui").slideViewerPro({ 
    galBorderWidth: 0, 
    autoslide: true,  
    thumbsVis: false, 
    shuffle: true 
 }); 
```

**(2)** - 改用jQuery**[循环插件](http://malsup.com/jquery/cycle/)**

**(3)** - 编辑原始源代码并通过使用计时器和触发导航上的点击事件`slideViewer`添加您自己的实现。`autoslide`

如果我站在你的立场上，我会坚持选择 1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-19T03:52:20.813

```
这是我的实现：

var theLinks;
var nCount = 0;
var theTimerID;

函数初始化（）{
    $("div#mygalone").slideView();
    theLinks = jQuery('#stripTransmitter0 a');

        //用于终止间隔目的
        theTimerID = setInterval("autoSlide()", 8000);
}
函数自动滑动（）{
    n计数++；
    如果（nCount == theLinks.length）nCount = 0;
    console.log(theLinks);
    jQuery(theLinks[nCount]).trigger("click");
}

$(window).bind("加载", init );

```

# c++ - 是否可以使用 C++ 中的函数指针获得早期/静态绑定？如果是，那怎么办？

> ID：1009326
> 
> 赞同：0
> 
> 时间：2009-06-17T20:20:19.640
> 
> 标签：c++

在 C++ 中，获得后期/动态绑定的一种方法是使用函数指针，我们也可以使用虚函数。

**但不知道早期/静态绑定。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T20:24:15.030

您无法使用指针获得静态绑定。从技术上讲，它甚至不是“绑定”的——它只是您需要在运行时调用的某个函数的地址。对于静态绑定，编译器需要提前知道函数的地址才能将其直接放入输出机器代码中，但指针的值（通常）直到运行时才知道。

如果编译器可以保证指针值是不变的，或者如果它可以在执行的特定点缩小指针的值，那么它可能会优化事物并静态绑定调用：

```
void foo() {
    cerr << "foo!" << endl;
}

int main(int argc, char **argv) {
    void (*f)() = &foo;
    f();   // can statically bind here... but why use a pointer?
} 
```

但这是一个玩具示例。如果编译器可以确定您的指针总是指向同一个函数，那么人们就会想知道您为什么要使用指针。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T21:15:01.167

这是一个玩具...

```
extern void verbose() ;
extern void terse() ;

const bool debug1 = false;
extern bool debug2;

void toy() {
  void (*f)() = debug1 ? verbose : terse ;
  (*f)();
  f = debug2 ? verbose : terse ;
  (*f)();
  return;
} 
```

... 以下是适用于 Linux 的 Intel 11 C++ 的实现者如何解释它（已删除评论）：

```
# mark_begin;
    .globl _Z3toyv
_Z3toyv:
..B1.1:                         # Preds ..B1.0
        call      _Z5tersev                                     #7.3
..B1.2:                         # Preds ..B1.1
        movzbl    debug2, %eax                                  #8.7
        movl      $_Z7verbosev, %edx                            #8.3
        movl      $_Z5tersev, %ecx                              #8.3
        cmpl      $0, %eax                                      #8.3
        cmovne    %edx, %ecx                                    #8.3
        call      *%ecx                                         #9.3
..B1.3:                         # Preds ..B1.2
        ret                                                     #10.3
        .align    16,0x90
# mark_end; 
```

第一次调用取决于`debug1`，它是编译时已知的常量。英特尔轻而易举地通过三元运算符并将其简化为 #7.3 中的“调用简洁”。

第二个调用依赖`debug2`于某个其他编译单元中的 extern。英特尔认为，鉴于人类状况的不幸状态，任何布尔值都更有可能是假而不是真，将地址移动`terse`到 ecx 和`verbose`edx，将运行时值`debug2`与零进行比较，如果*不*为零，移动 edx到 ecx，然后调用 ecx 中的任何内容。请注意，如果您先验地知道 debug2 实际上会偏向于事实，并且此代码处于关键循环中，则可能存在依赖于编译器的优化可能性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T21:22:31.060

[http://www.oopweb.com/CPP/Documents/FunctionPointers/Volume/CCPP/callback/callback.html#chapter3](http://www.oopweb.com/CPP/Documents/FunctionPointers/Volume/CCPP/callback/callback.html#chapter3)

查一下

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T20:23:17.607

大多数编译器会静态绑定如下内容：

```
int foo()
{
   return 1;
}

typdef int (*intFunc)();

int main()
{
   intFunc f = &foo;
   cout << f();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T20:23:36.920

我会这么认为。如果你有静态定义的函数，你获取它的地址，并将它分配给你的类中的一个字段。当程序编译时，链接器确定函数应该在哪里，你也已经设置了你的引用吗？

我错过了问题的实际意义吗？

# django - Ubuntu 上 Lighttpd + FCGI 中的 Django - 当我启用第二个站点时重写停止工作

> ID：1009327
> 
> 赞同：2
> 
> 时间：2009-06-17T20:20:59.110
> 
> 标签：django, ubuntu, lighttpd, fastcgi

我已经将 lighttp 配置为通过 ubuntu 上的 fastcgi 启动和服务 django。当我只启用了一个站点时（通过 ubuntu 的类似 apache 的 conf-available、conf-enabled 机制），一切运行良好。当我启用第二个站点时，我的 url 重写似乎停止正常工作，尽管 fcgi 进程已启动并提供数据。这是我的配置：

`conf-available/10-example.conf`

```
$HTTP["host"] == "example.com" {
    var.virt_name = "example"
    include "includes/incl-fastcgi.conf"
} 
```

`includes/incl-fastcgi.conf`

```
global {
    server.modules += ("mod_rewrite",
                   "mod_fastcgi")
}

var.site_folder = "/" + virt_name
var.site_root = server_root + site_folder
var.socket = server_root + "/.handles/" + virt_name + ".socket"
server.document-root = site_root

fastcgi.server = (
    "/django.fcgi" => (
        "main" => (
            "socket" => socket,
            "bin-path" => "/etc/lighttpd/scripts/fcgi.sh",
            "bin-environment" => ( "VIRT" => virt_name, ),
            "check-local" => "disable",
            "min-procs" => 1,
            "max-procs" => 1,
            "allow-x-send-file" => "enable",
        ),
    ),
)

alias.url = (
    "/media/admin" => "/usr/share/python-support/python-django/django/contrib/admin/media", #why the hell does it live here?
)

url.rewrite-once = (
    "^(/media.*)$" => "$1",
    "^/favicon\.ico$" => "/media/favicon.ico",
    "^/robots\.txt$" => "/robots.txt",
    "^(/.*)$" => "/django.fcgi$1",
) 
```

当我启用第二个站点时，一切都是相同的，除了现在有第二个链接指向`10-example.conf`启用 conf 的（稍作修改的）副本。发生这种情况时，我的网站会因 django-served 错误而失败：

```
Page not found (404)
Request Method:     GET
Request URL:    http://example.com/django.fcgi/[the url I requested] 
```

我不确定为什么启用另一个站点会破坏现有设置。我相信基于主机的语法应该隔离对该特定主机的任何更改，但似乎并非如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-20T01:08:42.247

如果将来有人看到这个问题，我相信答案是它已在 1.4.20 或更高版本中修复，并且服务器正在运行 v1.4.19，因为这就是 Ubuntu 的存储库所拥有的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-10T04:02:32.713

您是否在 settings.py 中将[FORCE_SCRIPT_NAME](http://docs.djangoproject.com/en/dev/ref/settings/#force-script-name)设置为“”？

```
FORCE_SCRIPT_NAME="" 
```

# c++ - stl 向量添加序列

> ID：1009335
> 
> 赞同：1
> 
> 时间：2009-06-17T20:22:48.043
> 
> 标签：c++

我正在使用 borland 2006 c++

```
class A
{
private:
    TObjectList* list;
    int myid;
public:
 __fastcall A(int);
 __fastcall ~A();
};

__fastcall A::A(int num)
{
    myid = num;
   list = new TObjectList();
}

__fastcall A::~A()
{
}

int main(int argc, char* argv[])
{
  myfunc();
  return 0;
}

void myfunc()
{
    vector<A> vec;
    vec.push_back(A(1));
} 
```

当我向向量添加一个新对象 A 时，它会调用它的析构函数两次，然后在 vec 超出范围时调用一次，因此总共调用了 3 次。

我在想它应该在添加对象时调用一次，然后在 vec 超出范围时调用一次。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T20:45:11.523

该表达式`A(1)`是一个 r 值并构造一个新`A`值，然后编译器可以将其复制到一个临时对象中，以便绑定到`const`push_back 采用的引用。然后将引用绑定到的这个临时复制到由 管理的存储中`vector`。

在许多情况下，编译器可以省略临时对象，但不是必须这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T23:04:37.360

试试这个：

```
#include <iostream>
#include <vector>

class A
{
    private:
        public:
            A(int num)
            {
                std::cout << "Constructor(" << num << ")\n";
            }
            A(A const& copy)
            {
                std::cout << "Copy()\n";
            }
            A& operator=(A const& copy)
            {
                std::cout << "Assignment\n";
                return *this;
            }
            A::~A()
            {
                std::cout << "Destroyed\n";
            }
};

int main(int argc, char* argv[])
{
    std::vector<A> vec;
    vec.push_back(A(1));
} 
```

我机器上的输出是：

```
> ./a.exe
Constructor(1)
Copy()
Destroyed
Destroyed
> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T20:37:49.980

当您命中断点时，单击调试器底部的调用堆栈选项卡。这样，您可以找到每个调用的上下文。

# iphone - 将图像上传到 iPhone 而不调整大小

> ID：1009344
> 
> 赞同：0
> 
> 时间：2009-06-17T20:24:09.040
> 
> 标签：iphone

我想创建一个应用程序来处理他可以从他的计算机导入的用户图像。问题是我需要那些原始尺寸的图像。当我尝试通过 iTunes 同步复制它们时，它们被调整为 640x480 或其他东西，这对我来说是不可接受的:( iTunes 或 iPhone 中是否有一些我错过的设置允许我在不调整大小的情况下同步图像？

有没有其他方法可以让用户在没有 iTunes 的情况下将图像从 PC 或 mac 复制到 iPhone？我希望这对用户来说尽可能方便，最好不要强迫他下载和安装任何新软件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T20:51:36.957

好吧，取决于你的资源是什么。您可以让他们将它们上传到您的服务器，然后您可以将它们下载到 iPhone。

# c# - 使用 linq 表达式从对象集合中获取单个数组或字符串列表，而无需使用 foreach 和 addrange

> ID：1009349
> 
> 赞同：1
> 
> 时间：2009-06-17T20:24:46.637
> 
> 标签：c#, linq-to-objects

```
public class Buddy
    {
        public string[] Sayings;
    }

Buddy one = new Buddy();
        one.Sayings = new[] {"cool", "wicked", "awesome"};

        Buddy two = new Buddy();
        two.Sayings = new[] {"bad", "lame", "boring"};

        Buddy[] buddies = new[] {one, two};

        IEnumerable<string[]> something =
            from b in buddies
            select b.Sayings; 
```

所以基本上我想得到一个数组或列表，其中包含 {"cool, wicked, awesome, "bad", "lame", "boring"} 每个使用 linq 的好友的说法。

我尝试了我能想到的一切，并开始怀疑它是否可以只用一个 linq 表达式来完成。我可以通过 buddies 中的每个 buddy 并将 Sayings 上的 addrange 添加到一个列表中，但我想，因为我正在学习 linq，所以我会尝试这种方式。有可能吗？如果可以，怎么办？如果我想在 Buddy 中获取一些其他对象，这也可能适用，在这种情况下，它只是字符串列表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T20:29:34.053

这个怎么样：

```
var result2 = buddies.SelectMany(b => b.Sayings); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T20:37:19.217

Jakers 是对的——这正是*它*[`SelectMany`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.selectmany.aspx)最简单的形式。替代重载允许您获得不同的结果，例如在投影中也包括“源”项目。

请注意，此查询表达式语法是有多个`from`子句 - 第一个子句之后的每个子句都添加另一个对`SelectMany`. Jakers 代码*类似于*：

```
var result2 = from buddy in buddies
              from saying in buddy.Sayings
              select saying; 
```

除了点符号版本更有效 - 它只投影一次。上面的代码编译为：

```
var result2 = buddies.SelectMany(buddy => buddy.Sayings, 
                                 (buddy, saying) => saying); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T20:36:12.167

这应该工作...

```
var buds = new [] { new Buddy { Sayings = new[] {"1","2","3"} },
                    new Buddy { Sayings = new[] {"4","5","6"} },
                    new Buddy { Sayings = new[] {"7","8","9"} } };

var res = buds.SelectMany( b => b.Sayings ).ToArray(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T20:37:05.580

```
 string[] a = new string[] {"a", "b", "c", "d"};
            string[] b = new string[] {"1", "2", "3"};

        var unioned = a.Union(b);
        foreach(string s in unioned)
            Console.WriteLine(s); 
```

# asp.net-mvc - 如何在不使用 Helpers 的情况下指定操作

> ID：1009355
> 
> 赞同：0
> 
> 时间：2009-06-17T20:25:38.070
> 
> 标签：asp.net-mvc

我将从我们的数据库中即时生成一些超链接。因此，例如，我去获取有关项目的一些信息，然后基于该 DB 表中的配置信息（其中包含要生成的 HTML 字段类型等信息），我将从我在 MVC 中创建的自定义控件动态创建 Html 控件.

这让我想到了超链接。如果我必须在此处或此处为某些产品动态生成超链接，以便我们的视图上的产品下方的表单现在使用我的自定义控件动态生成，那该怎么办？当您不打算使用 Helper 方法并且不能（因为您正在为视图动态创建这些字段）使用类似或不会看到类似 Html 的东西时，如何在这些实例上指定控制器/操作。 Actionlink 因为字段是在运行时动态生成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T21:17:16.997

我使用的一种解决方案是创建一个包装类，其中包含所有这些信息，然后您可以将这些信息传递给辅助方法：

```
public class RouteWrapper
{
    public string RouteName { get; set; }
    public object RouteValues { get; set; }
    public string LinkText { get; set; }
    /* Other Properties pertaining to your data */
} 
```

在包装器中，您将拥有定义 RouteName 和 RouteValues 属性的方法。或者，如果您只需要在控制器和操作之间变化，您可以这样设置。尽管您可以只在 RouteValues 中传递控制器和操作，并将“默认”指定为 RouteName。

然后，您将真正能够在视图中直接执行您需要的操作（假设 RouteWrapper 类是模型，语法可能略有偏差，但您会明白的）：

```
<%= Html.RouteLink(Model.LinkText, Model.RouteName, Model.RouteValues) %> 
```

希望这可以帮助。

编辑：

只是重新阅读并看到您没有使用助手。

无论您在何处生成锚标记，都可以将 LinkText 属性用于内部 HTML，并且 Routing 类中有一个方法可以帮助您根据路由名称和路由值生成 URL。一旦我弄清楚它会如何发展，我会稍微发布一些代码。

再次编辑：

好的，所以这将是生成锚标记的一般方法：

```
public string GenerateAnchorTag(ViewContext context, RouteWrapper model)
{
    string url = RouteTable.Routes.GetVirtualPath(context, model.RouteName, new RouteValueDictionary(model.RouteValues));
    return String.Format("<a href=\"{0}\">{1}</a>", url, model.LinkText);
} 
```

这就是我会尝试的（你需要包括 System.Web.Routing 和 System.Web.Mvc）。对于上下文，您需要以某种方式获取请求上下文。我通常在辅助扩展中执行此操作，因此辅助变量已经具有我可以传递的上下文。如果您不使用帮助程序，则必须找出将 RequestContext 传递给方法的最佳方法。

# c++ - 如何使文件自我更新（本机 C++）

> ID：1009356
> 
> 赞同：8
> 
> 时间：2009-06-17T20:25:54.230
> 
> 标签：c++, windows, native

我正在使用带有 Windows 目标部署的 Microsoft Visual Studio 2008。我将如何使文件“更新自身”？我已经完成了“通过网络传输”部分，但是如何让可执行文件自行改写呢？

基本上，我想为一个包含自动更新程序的目录编写一个自动更新程序，并且更新程序需要更新目录中的所有内容。

也许在文件锁被释放之前挂起对文件的更改的方法会起作用。如果我要这样做，我可能会用热补丁跟进它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T20:30:45.203

编写一个新的可执行文件并删除或保存旧可执行文件的副本——您可以通过网络发送一个差异，并使用第三个程序、更新监视器或其他程序来应用它。它只是一个小脚本，当它意识到有更新可用时，可以从远程应用程序启动。更新程序可以将自身重命名为 $UPDATER_OLD_VERSION 或其他名称，使用适当的名称写入自身的更新副本，然后在运行新更新程序时检查应用目录中是否存在名为 $UPDATER_OLD_VERSION 的文件并将其删除。所有其他文件都可以被更新/覆盖。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-07-21T05:05:50.923

这就是我最近的做法。旧程序运行和新程序运行有短暂的重叠。它利用了您可以重命名当前可执行文件并在关闭旧文件之前将新文件放置到位的技巧。这不是 100% 的故障安全，但是如果 CopyFile 失败，这可能会“破坏”您的应用程序的唯一方法。

```
#include <windows.h>
#include <iostream>
#include <fstream>

void UpgradeService::UpgradeSelf() {

  std::string temp = root         + "\\myprogram_tmp.exe";
  remove(temp.c_str()); // ignore return code

  std::string src = upgradeFolder + "\\myprogram.exe";
  std::string dst = root          + "\\myprogram.exe";

  rename(dst.c_str(),temp.c_str());
  CopyFile(src.c_str(),dst.c_str(),false);
  static char buffer[512];
  strcpy(buffer,dst.c_str());

  /* CreateProcess API initialization */
  STARTUPINFO siStartupInfo;
  PROCESS_INFORMATION piProcessInfo;
  memset(&siStartupInfo, 0, sizeof(siStartupInfo));
  memset(&piProcessInfo, 0, sizeof(piProcessInfo));
  siStartupInfo.cb = sizeof(siStartupInfo);

  ::CreateProcess(buffer, // application name/path
    NULL, // command line (optional)
    NULL, // no process attributes (default)
    NULL, // default security attributes
    false,
    CREATE_DEFAULT_ERROR_MODE | CREATE_NEW_CONSOLE,
    NULL, // default env
    NULL, // default working dir
    &siStartupInfo,
    &piProcessInfo);

  ::TerminateProcess( GetCurrentProcess(),0);
  ::ExitProcess(0); // exit this process

  // this does not return.
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T20:47:40.037

您通常不能在应用程序运行时对其进行修改。您*将*需要关闭原始程序并从另一个位置对其进行修改。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T20:34:56.053

我使用 InnoSetup setup.exe 执行此操作，该程序以静默方式启动并在开始安装新文件之前关闭我的应用程序。我必须添加自定义 Pascal [代码] 部分以确保一切都关闭，但它可以完成工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T21:04:01.597

你不能在文件执行时覆盖它，但你可以重命名它。在我的更新程序中，我将现有的 exe 重命名为有意义的名称（oldname_dateandtime），然后将新副本写入其中。然后自动关闭我们的系统并从服务重新启动它。当应用程序启动时，它是正在运行的新版本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T23:09:42.997

当我制作更新程序时，我应该将程序分开几个。主要原因和你想做的一样。简单地说，B 更新目标应用程序**加上**A 和 A 更新 B。我试图找到另一种方法，但我所做的只是制作了更小更简单的更新程序。:(

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T00:05:10.887

我认为您在谈论文件版本和更新程序。正如您所说，您需要自动更新程序。因此，您需要创建一个服务来监视您的安装目录并将磁盘上的文件版本与服务器进行比较。

一旦发生不匹配，您可以从服务器询问最新数据。如果要替换的文件正在使用中，您必须在下次重新启动时将它们标记为删除/注销，您可以使用注册表提及这些。

您可以复制缓存中的所有文件，然后在重新启动期间将它们复制到安装目录。

# spring - Spring 上下文测试找不到配置位置

> ID：1009357
> 
> 赞同：8
> 
> 时间：2009-06-17T20:26:05.230
> 
> 标签：spring, junit, spring-test

我有一个分布在多个 Spring bean 定义 xml 文件中的大型应用程序。在我的测试套件中，我使用 FileSystemXmlApplicationContext 手动加载我需要的 XML 文件来执行我想要运行的测试。这减少了测试设置时间，并允许我使用与生产中使用的完全相同的配置文件。

现在我正在尝试使用 Spring 的事务测试基类，它获取配置位置并为我加载上下文。由于某种原因，当创建应用程序上下文时，Spring 找不到任何配置文件。这很令人困惑，因为我从与使用 FileSystemXmlApplicationContext 自己加载配置时相同的工作目录运行测试。如果我在所有配置位置前加上“文件：”，则会找到我在测试中指定的路径，但找不到任何由配置中定义的 bean 导入或引用的文件（例如属性文件）。这是怎么回事？我可以获得扩展弹簧上下文测试类的测试，使其与我自己创建上下文的测试相同吗？

例如，像这样创建上下文可以正常工作：

```
ApplicationContext ctx = new FileSystemXmlApplicationContext(new String[] { "WEB-INF/services-context.xml"}) 
```

如果我扩展 AbstractTransactionalDataSourceSpringContextTests 以下找不到 services-context.xml：

```
@Override
protected String[] getConfigLocations() {
   return new String[] { "WEB-INF/services-context.xml"};
} 
```

这会找到服务上下文，但其中定义的 PropertyPlaceholderConfigurer 无法找到它的属性文件。

```
 @Override
 protected String[] getConfigLocations() {
    return new String[] { "file:WEB-INF/services-context.xml"};
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T17:54:04.897

我们将所有 Spring 配置和属性文件放在类路径中，这使事情变得简单——我们可以从一个基类扩展我们的测试类，例如：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations={
        "/spring/*.xml", 
        "/testSpring/*.xml" })
public abstract class AbstractIntegrationTest  { 
```

在这里，路径是类路径中的所有路径。

如果您不想这样做，您是否检查过如何引用 services-context.xml 中的属性文件？我怀疑如果您将 file: 添加到您的上下文配置中，那么您还需要将其添加到您的属性文件引用中。您也许可以只使用单独的测试 Spring 配置文件来更改属性占位符的定义，并将其放在上下文文件列表的末尾 - 然后其定义将覆盖早期文件中定义的定义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T21:31:27.017

除了覆盖 getConfigLocations 之外，我还覆盖了 loadContext 并在其中使用了一个可靠的 fileSystemXmlApplicationContext。

```
 @Override
 protected String[] getConfigLocations() {
     return new String[] { "WEB-INF/services-config.xml" };
 }

 @Override
 protected ConfigurableApplicationContext loadContext(String[] locations) throws Exception {
     return new FileSystemXmlApplicationContext(locations);
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T21:01:24.567

您的配置位置是相对 URI，并且将由基本测试类解释为相对 URI，URI 相对于测试类本身的位置进行解析。尝试使用完全限定的 URI，或者使用相对 URI，同时考虑到测试类的位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T18:06:33.237

你不能使用[ClassPathXmlApplicationContext](http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/context/support/ClassPathXmlApplicationContext.html)这样的类路径 XML 工厂吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-17T16:08:23.880

另一种可能的解决方案是复制`services-config.xml`并重命名为`services-config-test.xml`，然后放在类路径下。属性文件也是如此。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-25T08:50:18.960

```
ApplicationContext ctx = new FileSystemXmlApplicationContext(new String[] { "WebRoot/WEB-INF/services-context.xml"}) 
```

# dynamics-crm - 使用 Dynamics CRM 4.0 执行复杂查询

> ID：1009359
> 
> 赞同：1
> 
> 时间：2009-06-17T20:26:18.443
> 
> 标签：dynamics-crm, dynamics-crm-4

我有两个自定义实体 Product 和 ProductType，它们以多对一的关系链接在一起。Product 有一个 ProductType 的查找字段。

我正在尝试编写一个查询来获取价格超过 100 的 Type1 产品和价格低于 100 的 Type2 产品。

这是我在 SQL 中的做法：

```
select *
  from Product P
 inner join ProductType T on T.Id = P.TypeId
 where (T.Code = 'Type1' and P.Price >= 100)
    or (T.Code = 'Type2' and P.Price < 100) 
```

我想不出一种方法来构建一个 QueryExpression 来做到这一点。我知道我可以用两个查询来做到这一点，但我想尽量减少到服务器的往返。

有没有办法只在一个操作中执行该查询？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T22:02:49.403

在`QueryExpression`对象上，有一个名为 的属性`LinkEntities`。您可以创建`LinkEntity`指定“加入”信息的对象，然后将其添加到您的链接实体。例如：

```
QueryExpression q = new QueryExpression();
LinkEntity l = new LinkEntity();
l.LinkFromAttributeName = "fromatt";
l.LinkToAttributeName = "toatt";
l.LinkFromEntityName = "product";
l.LinkToEntityName = "producttype";

FilterExpression f = new FilterExpression();
f.AddCondition(new ConditionExpression("code", ConditionOperator.Equal, "type1"));
l.LinkCriteria = f;
q.LinkEntities.Add(l); 
```

请注意，您实际上无法从正在检索产品的 QueryExpression 获取 ProductType 实体上的任何属性。为此，您必须使用 Fetch XML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T07:15:46.467

你也可以看看[LinqtoCRM](http://codeplex.com/linqtocrm)。它将查询转换为 FetchXML，以便您可以获取连接实体的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-03T14:37:10.573

不幸的是，不，不可能使用 QueryExpression 或 FetchXML 来做到这一点。至少，Dynamics CRM 4 没有。希望他们在版本 5 中包含此功能（2010 年第二半）

# firefox - jQuery UI + Gmaps = 问题（至少对我来说）帮助！

> ID：1009365
> 
> 赞同：2
> 
> 时间：2009-06-17T20:27:45.897
> 
> 标签：firefox, jquery-ui, google-maps

我一发现它就开始使用 jQuery，它非常强大，但是当我尝试将 Gmaps api 加载到 jQuery UI 带来的选项卡中时，我开始挣扎。奇怪的是，在 IE 6、7、8 中它运行良好，但在 Firefox、Safari 中（我使用的是 mac，但在 windows 中对其进行了测试，它们都给出了同样的问题）地图并没有完全加载。当我单击加载地图的选项卡时，只有部分地图完全可操作，其余部分为灰色且不可点击。请查看下面的链接，然后单击 firefox/safari 和 IE 中的第三个选项卡，您将看到问题。

[http://movewithusoverseas.com/index-new.php?z=product-info.html&pid=1](http://movewithusoverseas.com/index-new.php?z=product-info.html&pid=1)

我不知道这是 jQuery UI 代码中的错误还是我做错了什么。如果我从选项卡中加载地图，则地图显示正常。

我与这个问题斗争了一个半星期......任何帮助将不胜感激。

提前致谢。路易斯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T20:40:46.870

当用户打开第三个选项卡时，您需要调用[map.checkResize()](http://code.google.com/apis/maps/documentation/reference.html#GMap2.checkResize)。

问题是这样的：当您初始化地图时，第三个选项卡不可见，并且地图的大小不正确。尝试调整浏览器窗口的大小（这称为 checkResize），您会注意到地图会自行更正。

[jQuery UI 文档](http://jqueryui.com/demos/tabs/#...my_slider.2C_Google_Map.2C_sIFR_etc._not_work_when_placed_in_a_hidden_.28inactive.29_tab.3F)展示了如何将事件绑定到选项卡的打开。这应该适用于您的页面：

```
$('#tabs').bind('tabsshow', function(event, ui) {
    if (ui.panel.id == "tabs-3") {
        map.checkResize();
    }
}); 
```

**更新：** Luis 指出您也可以使用偏左技术解决此问题：

```
.ui-tabs .ui-tabs-hide {
    position: absolute;
    left: -10000px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-04T21:20:02.543

我对 jquery 选项卡有同样的问题。但我决定不使用 css 修复，因为它通过将所有选项卡移到屏幕外来替换所有选项卡的原始隐藏显示属性。我相信这可以被谷歌或其他搜索引擎视为作弊。

无论如何，我创建了与上面 Chris B 提交的代码非常相似的代码，但添加了一个，即 map.setCenter()。因为我的地图在 checkResize() 方法之后没有正确居中。

```
$('#tabs').bind('tabsshow', function(event, ui) {
    if( $('#map').is(':visible') ) {
        map.checkResize();
        map.setCenter(centerPoint, 14);
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T21:16:28.610

请注意，`checkResize()`API v3 中不再存在该函数。中的等价物是：

`google.maps.event.trigger(map, 'resize');`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T20:32:27.837

我以前也遇到过这种情况。我还没有检查你的代码，所以我无法诊断你的问题，但对我来说，问题是 map_canvas div（谷歌地图用来渲染地图的一个）的 HTML/CSS 大小错误。大多数情况下，您在 div 中有一个 div，您需要将内部 div 设置为 width=100% 和 height=100%。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-04T13:43:24.140

这里提供的解决方案都不适用于 gmap js。我发现这个可以：

```
jQuery('a[href="#tabID"]').on('shown.bs.tab', function(e)
{
    var map = new GMaps({
        div: '#gmap-marker',
        lat: -12.043333,
        lng: -77.028333
    });
}); 
```

# c# - 使用 C# 创建 COM 扩展 - 值得吗？

> ID：1009367
> 
> 赞同：2
> 
> 时间：2009-06-17T20:28:27.627
> 
> 标签：c#, com, interop

我正在处理以下问题：我们广泛使用的（第三方）软件（[Software A](http://www.neurobs.com/) ）允许使用组件对象模型（COM）接口（实际上是几个接口）对它所谓的“扩展”进行编程。它为这些接口提供 MIDL 文件以及作为 SDK 一部分的 Visual C++ 的“项目模板”（IDL 文件、头文件和接口已经存在，只是缺少接口函数的实现）。为了兼容，所有扩展都必须符合（即必须实现）给定的 COM 接口结构。

然而，由于我对 C++ 的熟悉程度相当有限，我希望在 C# 和 .NET 中实现 COM - 另一方面，预定义的接口大量使用指针和自定义数据结构，所以我想知道我是否与其尝试在 C# 中重新创建所有内容，不如在其本机 C++ 中实现接口并不会更好。

更多背景知识：最终目标是从软件 A 内部控制一个自定义硬件（通过 USB）。我已经编写了一个使用 DLLimport 包装驱动程序（另一个第三方软件）的小型 .NET 应用程序，这令人惊讶无痛。换句话说，我正在尝试构建的 COM 对象本质上是（第三方）软件 A 和（第三方）设备驱动程序 B 之间的桥梁，它必须符合 A 给出的接口规范。

* * *

示例 MIDL 代码：

> [ id(0x00000004)]
> HRESULT GetWaveData([in] BSTR name, [out] IWaveData ** data );
> [ id(0x00000005)]
> HRESULT GetImageData([in] BSTR name, [out] IImageData ** data, [out] Palette * Palette );
> [ id(0x00000006)]
> HRESULT SetVariable([in] BSTR 名称，[in] IVariableData * 变量);

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T20:36:17.283

如果不完全了解问题，实际上不可能回答这个问题。但一般来说，我会选择 C++ 路线。通过向世界添加 CLR，您将不得不处理 C# 中的互操作问题并可能处理令人讨厌的指针问题（因为它的本质是处理与硬件相关的低级问题）。因此，您真正的选择可能是不干净的 C# 源代码或使用 C++。我想我会选择后者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T20:53:53.083

从技术上讲，您不是在 C++ 中实现接口，而是在 MIDL 中实现。它是一种单独的界面语言，如果您要进行 COM 工作，值得了解。

无论如何，使用 .NET 互操作来实现 COM 对象并不少见，但这两者并不是真正兼容的技术。除非您正在编写非常简单的对象，否则您将遇到问题。

为了帮助您入门，这里有一些随机分类的指针以及我过去使用过的几篇文章。

*   COM 是一种接口驱动的技术。一遍又一遍地对自己重复。
*   使用 MIDL 单独开发接口定义。
*   COM 垃圾收集是确定性的（引用计数），但是当与 .NET 一起使用时，这开始崩溃，其中垃圾收集会自动发生且不可预测。
*   处理事件接收器/事件处理程序是丑陋的。

您将遇到的头痛类型的小尝试：http: [//www.codeproject.com/KB/cs/LingeringCOMObjects.aspx](http://www.codeproject.com/KB/cs/LingeringCOMObjects.aspx)

更多关于为什么你不应该让 Visual Studio 为你自动生成 COM 接口：http: [//blogs.msdn.com/mbend/archive/2007/04/17/classinterfacetype-none-is-my-recommended-option-过度自动调度-autodual.aspx](http://blogs.msdn.com/mbend/archive/2007/04/17/classinterfacetype-none-is-my-recommended-option-over-autodispatch-autodual.aspx)

桥接事件： [http ://www.west-wind.com/presentations/dotnetfromVfp/DotNetFromVfp_EventHandling.asp](http://www.west-wind.com/presentations/dotnetfromVfp/DotNetFromVfp_EventHandling.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T04:09:01.950

如果 .NET 能给您带来优势，您应该只将其用于此目的。例如，我们曾经需要 web 服务调用，并且在 .NET 中对它的支持要好得多，所以我们就这样做了。在您的情况下，优势是您更熟悉 .NET，这可能值得选择。

但是，如果您在 .NET 中实现 COM 对象，则必须在必须使用该对象的每台机器上都需要 .NET 运行时。另外，您可能在实现具有难以编组的自定义类型的接口时遇到问题。

您需要将优势（在您的情况下更熟悉）与您遇到的技术负担（可能的部署和编组问题）进行比较。

我个人的观点是，只有在需要那里随时可用的功能（如 web 服务调用）时才选择 .NET 路径。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T06:03:33.873

听起来您正在做出的决定是选择原生应用程序还是基于 .NET 的应用程序。

你需要考虑以下几点：

1.  **部署问题**：你打算在哪里部署这个应用程序？它会在数百个工作站上运行，还是只在几个工作站上运行？您将对安装它的机器拥有多少控制权？请记住，您必须确保安装了正确版本的 .NET 平台；

2.  **维护问题**：您显然更熟悉 .NET，但谁来长期维护应用程序？他们会被期望熟悉 C++ 吗？原生开发确实与托管开发不同，因为“管家”是其中非常重要的一部分；

3.  **第三方依赖项**：在我看来，您正在尝试使用第三方 COM 库通过 USB 与您的设备进行通信。但是，您提到您已经为硬件驱动程序编写了一个 .NET 包装器——您能否详细说明一下，因为这有点令人困惑。如果可能，如果不是太麻烦，不要引入依赖；

4.  **资源限制**：如果您的应用程序要“在野外”安装，硬件限制是什么？使用非托管环境进行编程可以让您对应用程序将使用的内存量以及 CPU 密集程度进行细粒度控制——当然，这是与让托管层负责资源管理的权衡.

一般来说，如果您正在开发一个不需要部署到具有不同硬件配置的数千名用户的应用程序，我会选择 .NET 平台。.NET 上的 COM 互操作相对轻松，在托管平台上编程意味着您可以专注于重要的事情。如果您以前从未在非托管环境中编程过 (C/C++)，那么您会感到震惊。

# perl - 按字典顺序排序

> ID：1009369
> 
> 赞同：3
> 
> 时间：2009-06-17T20:29:10.137
> 
> 标签：perl, sorting, cmp, lexicographic

我从以下代码中看到了结果，但我不完全理解在以下示例 中如何`or`知道该做什么：`sort`

```
use Data::Dumper;

$animals{'man'}{'name'} = 'paul';
$animals{'man'}{'legs'} = 2;
$animals{'cheeta'}{'name'} = 'mike';
$animals{'cheeta'}{'legs'} = 3;
$animals{'zebra'}{'name'} = 'steve';
$animals{'zebra'}{'legs'} = 4;
$animals{'cat'}{'name'} = '';
$animals{'cat'}{'legs'} = 3;
$animals{'dog'}{'name'} = '';
$animals{'dog'}{'legs'} = 4;
$animals{'rat'}{'name'} = '';
$animals{'rat'}{'legs'} = 5;

@animals = sort {
      $animals{$a}{'name'} cmp $animals{$b}{'name'}
   or $animals{$a}{'legs'} <=> $animals{$b}{'legs'}
} keys %animals;

print Dumper(\@animals); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-17T20:41:25.947

sortsub（`{}`后面的东西`sort`）定义了一个两层排序：首先按名称，然后按腿数。实现了两个标准之间的`or`交叉。更容易看出您是否以不同的方式格式化代码：

```
@animals = sort {
    $animals{$a}{'name'} cmp $animals{$b}{'name'} or
    $animals{$a}{'legs'} <=> $animals{$b}{'legs'}
} keys %animals; 
```

`cmp`and运算符返回三个值之一（`<=>`-1、0 或 1），具体取决于左侧参数是小于、等于还是大于右侧参数。（`cmp`进行字符串比较，`<=>`进行数字比较。）在 Perl 中，0 为假，而 -1 和 1 为真。如果`cmp`返回真值，则`or`立即返回该值，并`sort`适当地重新排序元素。如果`cmp`返回 false，`<=>`则计算 并返回其结果。

在进行多层排序时，通常使用“map-sort-map”技术（又名[Schwartzian Transform](http://en.wikipedia.org/wiki/Schwartzian_transform)）：

```
@animals =
  map  { $_->[0] }
  sort {
    $a->[1] cmp $b->[1] ||
    $a->[2] <=> $b->[2]
  }
  map { [$_, $animal{$_}{name}, $animal{$_}{legs}] }
  keys %animal; 
```

这不是很清楚，但因为它通常具有更好的性能，所以它是一个常见的习语。当比较的操作数是函数时，这一点尤其重要——这种技术可以防止对每次比较进行不必要的（并且可能是昂贵的）重新计算。例如，如果您按长度对字符串进行排序，则只需计算每个字符串的长度一次。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-17T20:33:55.947

`or`是一个短路求值器，因此如果它为真（即任何非零值），它将返回左侧的值，否则将评估右侧的值。

所以在这种情况下，如果动物的名字比较相等，（0 - 假），腿的数量将被计算用于排序目的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T21:11:07.947

我可以建议[`Sort::Key`](http://search.cpan.org/dist/Sort-Key/lib/Sort/Key.pm)作为当前代码的替代方案吗？

```
use Sort::Key::Multi qw(sikeysort);  # sort keyed on (string, integer)
@animals = sikeysort { $animals{$_}{name}, $animals{$_}{legs} } keys %animals;

# alternately,
use Sort::Key::Maker sort_by_name_then_legs =>
    sub { $animals{$_}{name}, $animals{$_}{legs} }, qw(string integer);
@animals = sort_by_name_then_legs keys %animals; 
```

# c# - FileInfo 对象属性问题 - C#？

> ID：1009380
> 
> 赞同：1
> 
> 时间：2009-06-17T20:31:25.360
> 
> 标签：c#, windows-explorer, system.io.fileinfo

以下`System.IO.FileInfo`属性是否映射到 Windows 资源管理器应用程序中的以下属性：

*   CreationTime = 创建日期
*   LastWriteTime = 修改日期
*   LastAccessTime = 访问日期

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T20:32:38.337

是的，简而言之。

（我不确定我可以在这里添加*任何*其他有用的东西......）

# ruby-on-rails - 字符串“Test '<3'”在我的 Rails 应用程序中显示为“Test '<3>”

> ID：1009381
> 
> 赞同：3
> 
> 时间：2009-06-17T20:31:46.123
> 
> 标签：ruby-on-rails, ruby, string, escaping

我有一个奇怪的问题，用户可以输入以下文本

> 测试'<3'

它输出为

> 测试'<3>

在我使用 white_list 的输出中，存储在数据库中的值为：

> '测试''<3'''

什么可能导致输出认为它是某种标签并试图关闭它（这对我来说是这样的）。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T20:44:11.807

Ruby 中的特殊字符（例如 &、< 和 @）有时会被误解。尝试在 .rhtml 页面中使用“h”方法。

```
<strong><%= h("This is a quick Test'<3'.") %></strong> 
```

将输出：

```
<strong>This is a quick Test'&lt;3'.</strong> 
```

因此您的浏览器会将其解释为：

**这是一个快速测试'<3'。**

（我对 Ruby 还比较陌生，所以我愿意更正！）

# iphone - AVAudioPlayer - 帧率下降

> ID：1009385
> 
> 赞同：3
> 
> 时间：2009-06-17T20:33:12.267
> 
> 标签：iphone, opengl-es, performance, avaudioplayer, frame-rate

我有一个简单的问题：我正在将一个 mp3 文件加载到一个 NSData 对象中，然后在我的游戏中使用 AVAudioPlayer 播放它。每隔一秒左右，帧速率就会下降，您会在屏幕上看到卡顿。这不是一个重大的放缓，但明显明显并破坏了游戏玩法。不使用 AVAudioPlayer 播放音乐曲目完全没有减速。

我怎样才能防止这种情况发生？

谢谢你。

弗洛里安

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T06:58:54.047

为了将来参考，这里是解决方案：

将音频会话类别设置为 kAudioSessionCategory_AmbientSound（以允许 iPod 音乐同时播放）会以某种方式禁用 MP3 硬件加速。将音频类别设置为 kAudioSessionCategory_SoloAmbientSound 可以解决此问题，但不允许 iPod 播放。我现在确实根据背景音乐是​​启用还是禁用来设置音频会话类别，以允许同时播放 iPod。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T22:59:07.933

mp3 是一种编码/压缩的音频格式。您可以尝试降低采样率（例如，尝试 64 kb/s 而不是 128 kb/s）或切换到非编码格式，例如线性 pcm。缺点是：前者的音频质量较低，后者的文件大小较大。但这有助于提高应用的整体性能。

# javascript - 如何使用 javascript 停止所有 DOM 事件？

> ID：1009389
> 
> 赞同：2
> 
> 时间：2009-06-17T20:34:37.053
> 
> 标签：javascript, html, dom

我正在编写一个 DOM 检查器，类似于 firebug 正在做的事情，但肯定非常简单“只检查元素”。

我想要做的是，当用户单击一个元素时，它会执行我编写的一些功能，同时我不希望该元素执行任何其他预附加事件。

方法：

如果用户检查了锚元素，然后单击它，它将执行我的功能并且会转到锚点 href 位置。

对于所有元素（例如输入、选择、...）也是相同的情况。

我需要禁用鼠标按下事件的接缝，但我不知道正确的方法。

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T20:37:04.833

在您的 onClick 处理程序中，返回 false？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T20:41:06.430

您可以将单个 onClick 事件附加到 body 元素，然后从那里找到 event.originalTarget 元素以查看用户实际单击的内容。然后您可以停止传播以防止触发原始元素的事件。

# sql - SQL noob 需要帮助编写一个涉及连接和可能相交的 Rails 查询

> ID：1009392
> 
> 赞同：2
> 
> 时间：2009-06-17T20:35:07.643
> 
> 标签：sql, ruby-on-rails

我有 3 个模型：书籍、通知和通知类型。书籍具有通知，因为 Notification 模型具有 book_id。Notifications 有一个 notification_type，因为 Notification 模型有一个 notification_type_id

我想要在 date1 和 date2 之间创建的所有书籍

```
books_set1 = Book.find :all, :conditions => ["created_at <= ? AND show_time >= ?", max_date, min_date] 
```

但我不想要有 notification.notification_type_id = 1 通知的书，理想情况下我想通过引用 notification_type.name 来说明这一点，所以我不想要有 notification.notification_type.name = 'type1' 通知的书

如果已经为一本书创建了 type1 的通知，我不希望它在集合中返回（因为我将使用返回的集合创建该类型的通知）。

我不确定是否有办法在一个查询中执行此操作，我想我需要 2 个查询和 INTERSECT - 第一个我已经包含在这篇文章中，第二个我不确定。但在伪代码中，我认为这是它需要做的：

```
notification_type_id = Notification.find_by_name('type1')
get all notifications where notification_id = notification_type_id
set2 = get the associated book set from the notification set (since each notification has one book) 
```

然后我做 set1 - set2

**更新**

多亏了一些帮助，我编写了两个查询来获得所需的结果。如果有人知道怎么做，我很乐意在 1 个查询中使用它：

```
books_in_range = Book.find :all, :conditions => ["created_at <= ? AND created_at >= ?", max_date, min_date]
books_without_these_notifications = Book.find(:all, :joins => { :notifications => :notification_type }, :conditions => ["notification_types.name = ?","type1"] )
books_to_consider = books_in_range - books_without_these_reminders 
```

同样，这个想法是让所有没有创建 type1 通知并且属于特定日期范围的书籍。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T20:51:13.337

以下应该有效：

```
Book.scoped(:conditions => ["created_at <= ? AND show_time >= ?", max_date,
  min_date]).find(:all, :joins => { :notifications => :notification_types },
  :conditions => ["notification_type.name <> ?", "type1"]) 
```

`named_scope`为了更加清晰，将一些参数提取到s 或局部变量中。

*更新以反映否定。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T21:24:55.487

你可以用 NOT EXISTS 做到这一点，但我不确定它的效率如何：

```
Book.find(
  :all, 
  :conditions => 
    ['created_at <= ? AND show_time >= ? AND 
      NOT EXISTS 
        (SELECT * FROM notifications 
         INNER JOIN notification_types ON notifications.notification_type_id = notification_types.id 
         WHERE notification_types.name = ? AND notifications.book_id = books.id)',
     max_date, min_date, 'type1'
    ]) 
```

您可能可以从不同的方向进入它，并通过向书籍或其他直接连接到书籍的对象添加布尔值来跟踪*已*发送 type1 通知的那些人。那么您的查询可能是：

```
Book.find(:all, 
  :conditions => 
    ['created_at <= ? AND show_time >= ? AND 
      type1_notification_sent = ?', 
     max_date, min_date, false
    ]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T20:43:34.647

```
SELECT books.* FROM books WHERE books.created_at <= ? AND books.show_time >= ? AND 
  notifications.name <> 'type1'
LEFT OUTER JOIN notifications ON notifications.book_id = books.id AND 
  notification.name = 'type1' 
```

我想，那会奏效。

# c# - C# - 值类型等于方法 - 为什么编译器使用反射？

> ID：1009394
> 
> 赞同：17
> 
> 时间：2009-06-17T20:35:52.400
> 
> 标签：c#, compiler-construction, struct

我刚刚遇到了一些对我来说很奇怪的事情：当你在一个值类型上使用 Equals() 方法时（当然，如果这个方法没有被覆盖）你会得到一些*非常非常*慢的东西——字段是使用一对一比较的反射 ！如：

```
public struct MyStruct{
   int i;
}

   (...)

   MyStruct s, t;
   s.i = 0;
   t.i = 1;
   if ( s.Equals( t ))   /*  s.i will be compared to t.i via reflection here. */
      (...) 
```

我的问题：为什么 C# 编译器不生成一个简单的方法来比较值类型？类似于（在 MyStruct 的定义中）：

```
 public override bool Equals( Object o ){
      if ( this.i == o.i )
         return true;
      else
         return false;
   } 
```

编译器在编译时就知道 MyStruct 的字段是什么，为什么要等到运行时才枚举 MyStruct 字段？

对我来说很奇怪。

谢谢 ：）

**补充**：对不起，我只是意识到，当然，`Equals`不是语言关键字而是运行时方法......编译器完全不知道这个方法。所以在这里使用反射是有意义的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-17T20:41:25.870

*它在不需要时*不使用反射。它只是逐位比较值，以防`struct`万一。但是，如果有任何`struct`成员（或成员的成员，任何后代）覆盖`object.Equals`并提供自己的实现，显然它不能依靠逐位比较来计算返回值。

它慢的原因是参数 to`Equals`是 type`object`和 value 类型必须被装箱才能被视为`object`. 装箱涉及在堆上分配内存以及将值类型复制到该位置的内存。

`Equals`您可以手动为将您自己作为参数的方法提供重载`struct`以防止装箱：

```
public bool Equals(MyStruct obj) {
     return obj.i == i;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-17T20:50:37.613

以下是来自 mscorlib 的反编译的 ValueType.Equals 方法：

```
public override bool Equals(object obj)
{
    if (obj == null)
    {
        return false;
    }
    RuntimeType type = (RuntimeType) base.GetType();
    RuntimeType type2 = (RuntimeType) obj.GetType();
    if (type2 != type)
    {
        return false;
    }
    object a = this;
    if (CanCompareBits(this))
    {
        return FastEqualsCheck(a, obj);
    }
    FieldInfo[] fields = type.GetFields(BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Instance);
    for (int i = 0; i < fields.Length; i++)
    {
        object obj3 = ((RtFieldInfo) fields[i]).InternalGetValue(a, false);
        object obj4 = ((RtFieldInfo) fields[i]).InternalGetValue(obj, false);
        if (obj3 == null)
        {
            if (obj4 != null)
            {
                return false;
            }
        }
        else if (!obj3.Equals(obj4))
        {
            return false;
        }
    }
    return true;
} 
```

如果可能，将进行逐位比较（注意 CanCompareBits 和 FastEqualsCheck，两者都定义为 InternalCall。JIT 可能会在此处注入适当的代码。至于为什么这么慢，我无法告诉你.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-20T22:41:43.027

编译器生成函数的想法是合理的。

考虑到效果，但我认为语言设计团队做得对。C++ 中已知的编译器生成的方法对于初学者来说很难理解。让我们看看使用自动生成的 struct.Equals 在 C# 中会发生什么：

现在，.Equals() 的概念很简单：

*   每个结构都从 ValueType 继承 Equals。
*   如果被覆盖，则应用自定义 Equals 方法。

如果编译器总是创建 Equals 方法，我们可以：

*   每个结构都从 Object 继承 Equals。（ValueType 将不再实现自己的版本）
*   Object.Equals 现在总是（！）被编译器生成的 Equals 方法或用户实现覆盖

现在我们的结构有一个代码阅读器看不到的自动生成的覆盖方法！那么你怎么知道基础方法 Object.Equals 不适用于你的结构呢？通过学习自动编译器生成方法的所有案例。而这正是学习 C++ 的负担之一。

认为将有效的 struct Equals 留给用户并保持概念简单的好决定，需要标准的默认 Equals 方法。

也就是说，性能关键结构应该覆盖 Equals。下面的代码显示

**在 .Net 4.5.1 上测量的**3606**与**53 毫秒****

 **这种性能提升肯定是由于避免了虚拟 Equals，但无论如何，如果调用虚拟 Object.Equals，则增益会低得多。但是，性能关键情况不会调用 Object.Equals，因此此处的收益将适用。

```
using System;
using System.Diagnostics;

struct A
{
    public int X;
    public int Y;
}

struct B : IEquatable<B>
{
    public bool Equals(B other)
    {
        return this.X == other.X && this.Y == other.Y;
    }

    public override bool Equals(object obj)
    {
        return obj is B && Equals((B)obj);
    }

    public int X;
    public int Y;
}

class Program
{
    static void Main(string[] args)
    {
        var N = 100000000;

        A a = new A();
        a.X = 73;
        a.Y = 42;
        A aa = new A();
        a.X = 173;
        a.Y = 142;

        var sw = Stopwatch.StartNew();
        for (int i = 0; i < N; i++)
        {
            if (a.Equals(aa))
            {
                Console.WriteLine("never ever");
            }
        }
        sw.Stop();
        Console.WriteLine(sw.ElapsedMilliseconds);

        B b = new B();
        b.X = 73;
        b.Y = 42;
        B bb = new B();
        b.X = 173;
        b.Y = 142;

        sw = Stopwatch.StartNew();
        for (int i = 0; i < N; i++)
        {
            if (b.Equals(bb))
            {
                Console.WriteLine("never ever");
            }
        }
        sw.Stop();
        Console.WriteLine(sw.ElapsedMilliseconds);
    }
} 
```

另见[http://blog.martindoms.com/2011/01/03/c-tip-override-equals-on-value-types-for-better-performance/](http://blog.martindoms.com/2011/01/03/c-tip-override-equals-on-value-types-for-better-performance/)**

# .net - Visual Studio 中的项目布局（在磁盘上）

> ID：1009403
> 
> 赞同：1
> 
> 时间：2009-06-17T20:37:16.737
> 
> 标签：.net, visual-studio, organization

管理磁盘上 Visual Studio 项目物理布局的最佳方法是什么？我已经到了我有几个文件夹的地步，但我真的不能像现在这样继续分类。例如，我有几个自定义控件，但有时这些控件与应用程序设置有关，那么它们是进入 Controls 文件夹还是 Application Settings 文件夹？我有许多成熟的表单驻留在主源文件夹中，因此寻找正确的源文件有点令人生畏。

任何人都可以提供有关如何将中型项目组织到文件夹层次结构中的任何提示，这样他们就不会因为试图在项目中找到某些东西而发疯？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T20:49:15.073

我通常根据我的命名空间来组织我的文件夹。例如，在命名空间“Company.Project.DataAccess”中的分类将存储在 company/project/dataAccess 目录中。

我承认管理打开的文件仍然有点痛苦。但是，[Resharper](http://www.jetbrains.com/resharper/)的“转到类型”功能已经消除了我在解决方案资源管理器中的所有搜索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T20:52:17.097

这是我通常在中型项目中使用的层次结构。

由 3 个项目组成的解决方案文件：

1.  ASP.NET Web 应用程序项目
2.  一个业务逻辑项目（包含我的大部分 buslogic 类）
3.  一个数据库项目（用于存放我的创建脚本、存储过程等）

如果我使用自定义 WebControls，我将有第四个项目。在 Web 应用程序项目中，我将拥有常用的文件夹，例如*css*、*images*、*includes*、*scripts*等，以及用于用户控件的文件夹（如果我正在使用它们）。我几乎总是将我的应用程序设置存储在 Web.config 中。

# asp.net - 如何从 DNN 中的 .ascx Web 用户控件更新 ScriptManager？

> ID：1009421
> 
> 赞同：2
> 
> 时间：2009-06-17T20:41:48.363
> 
> 标签：asp.net, web-services, scriptmanager, dotnetnuke, service-reference

我创建了一个需要在我的 .ascx 页面中使用的 Web 服务。我不能只添加这个：

```
<asp:ScriptManager ID="OWUScripts" runat="server">
    <Services>
        <asp:ServiceReference Path="~/OWUDashboard.asmx" />
    </Services>
</asp:ScriptManager> 
```

因为那时我在页面上有多个 ScriptManager。所以我做了一些研究，发现我需要将它添加到 Page_Load 事件中......

```
Dim myScriptManager As ScriptManager = ScriptManager.GetCurrent(Me.Page)

Dim objServiceReference As ServiceReference = New ServiceReference()
objServiceReference.Path = "~/MyService.asmx"
myScriptManager .Services.Add(objServiceReference) 
```

但我无法访问 Page_Load 事件，因为已经有一个预设（它是一个皮肤和所有）所以我把代码扔在了`<script runat="server"></script>`

然而，它给了我一个错误，说“预期声明”......我拿出了几行，它似乎在说它找不到 Me.Page（或者它即将出现空）

关于我做错了什么的任何见解？

我可以像我一样访问 Me.Page`<script runat="server">`还是应该以不同的方式访问？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T20:47:45.530

在这种情况下，您可以使用 ScriptManagerProxy 类以声明方式添加引用。只要在“父”页面中已经定义了 ScriptManger，就会使用代理类。您使用 ScriptManagerProxy 的方式与使用常规 ScriptManager 的方式相同。可以在[此处找到有关代理类的更多信息。](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanagerproxy.aspx)

示例标记：

```
<asp:ScriptManagerProxy runat="server" ID="Manager">
<Scripts>
    <asp:ScriptReference Path="~/JScript.js" />
</Scripts>
</asp:ScriptManagerProxy> 
```

# javascript - Javascript键盘输入过滤

> ID：1009426
> 
> 赞同：8
> 
> 时间：2009-06-17T20:43:37.003
> 
> 标签：javascript

有没有人有一个有效的动态 javascript 输入过滤器来限制跨多个浏览器的文本输入？

我在网上看到了多个示例，但其中大多数似乎都有缺陷或缺乏多浏览器支持。

我目前的尝试发布在下面，但是在 Firefox 下移动数字失败了，我还没有尝试过其他浏览器。

正如[http://www.quirksmode.org/js/keys.html](http://www.quirksmode.org/js/keys.html)所示，这不是一个简单的问题。

有没有人有更好的解决方案？

```
var numb = /[0-9]/;
var lwr = /[a-z]/;
var upr = /[A-Z]/;
var alpha = /a-zA-Z]/; //not checked
var alphaNum = /a-zA-Z0-9/; //not checked

function onKeyPressAcceptValues(e, reg){
    var key = window.event ? e.keyCode : e.which;
    //permit backspace, tab, delete, arrow buttons, (key == 0 for arrow keys)

    alert(key);
    if(key == 8 || key == 9 || key == 46 ||(key>32 && key <41 ||key == 0)){
        return true;
    }
    var keychar = String.fromCharCode(key);
    return reg.test(keychar);
}

function isNumberKey(parm) {return onKeyPressAcceptValues(parm,numb);}
function isLowerKey(parm) {return onKeyPressAcceptValues(parm,lwr);}
function isUpperKey(parm) {return onKeyPressAcceptValues(parm,upr);}
function isAlphaKey(parm) {return onKeyPressAcceptValues(parm,alpha);}
function isAlphanumKey(parm) {return onKeyPressAcceptValues(parm,alphaNum);} 
```

它将通过

`<input type="text" name="pw[first_name]" size="15" maxlength="15" onkeypress="return isAlphaKey(event)">`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-30T14:42:23.330

输入后会检查和删除无效值吗？

在浏览器中检查 charCode 和 keyCode 可能会变得非常困难，为什么不检查实际添加到文本字段的值呢？

反转您的正则表达式，它们会匹配您**不**想要的所有内容。一旦你有了它，只需使用你的反向正则表达式来替换插入到你不想要的输入框中的数据。

我在[http://jsbin.com/ulibu](http://jsbin.com/ulibu "一个简单的例子")创建的一个简单示例有一个只接受整数的文本框。它有一个小的 javascript 块，可以从字段中删除非数字：

```
function checktext( e ) {
  //Remove digits
  //Yes, the global search/replace is important. If we don't use a global
  //replace ctrl+v will remove only the first invalid character instead of
  //them.
  e.value = e.value.replace( /[^\d]/g , '' );
} 
```

并且输入框使用 keyup 事件声明以捕获任何类型的内容：

```
<input type="text" id="text" onkeyup="checktext(this);"/> 
```

这肯定不完美。您仍然需要做的事情：

1.  验证服务器端。客户端验证永远不会捕捉到所有用户的错误。始终验证服务器端。
2.  完善检查。这是一个简单的正则表达式，有些可能最终会更复杂
3.  捕获粘贴事件，以便以相同的方式转换鼠标粘贴事件。
4.  如果您必须删除文本，则向用户显示“仅允许 X”的一些警告。否则他们可能会认为“浏览器的行为很有趣”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T21:11:57.803

捕获键盘事件无论如何都不会起作用，因为用户总是可以使用 Edit | 粘贴。即使你确实想出了一个跨浏览器的解决方案来处理这个问题，用户也可以通过禁用 Javascript 来绕过一切。

换句话说，不要浪费你的时间。当用户尝试提交无效数据时，只需给他们一个错误。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-17T21:30:52.477

这是一种方法：

*   创建一个“伪字段”——这是输入将出现在用户面前的地方
*   单击时，将焦点设置为隐藏字段
*   让用户输入隐藏字段
*   查看正在输入的内容并将有效字符复制到伪字段

用户认为他们正在输入该字段，但事实并非如此。

# asp.net - 可以在 mod_aspdotnet 下运行多个应用程序吗？

> ID：1009433
> 
> 赞同：0
> 
> 时间：2009-06-17T20:44:40.170
> 
> 标签：asp.net, apache

我有一个在 win 2003 上运行的 apache 服务器。

[我像本指南链接文本](http://weblogs.asp.net/israelio/archive/2005/09/11/424852.aspx)一样配置 mod_aspdotnet

启用 asp.net web 应用程序，一切正常。**仅适用于一个网络应用程序...！**

有没有办法配置更多的一个应用程序？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T20:53:54.113

看起来应该是可以的。您只需将另一个添加到 Apache 配置并将其指向您的第二个应用程序驻留在文件系统上的位置。

# ssis - SSIS SQL char 转换为 MS Access 是/否字段

> ID：1009444
> 
> 赞同：1
> 
> 时间：2009-06-17T20:48:01.940
> 
> 标签：ssis, char, ms-access-2007

我有一个正在开发的 SSIS 包。我正在尝试将数据从 SQL Server 2005 写入 MS Access 2007。

我很困惑如何将 SQL char(1) 字段转换为 Access Yes/No 字段。

根据我收集的信息，Access Yes/No 字段的 SQL 等效项将是一个位字段，其值为 0 或 1。

我的 SQL char(1) 字段（这是我的源字段）包含“N”或“Y”。我没有使用位字段的选项，因此我进退两难。我曾尝试转换为布尔值和整数，但没有任何成功。

在我的数据流任务中，我尝试创建正则表达式无济于事，派生列、数据转换等也无济于事。我被困住了。

我已经看到了一些关于构建循环遍历 .Row 集合的条件语句的示例。这似乎有点过分，必须为 NULL 检查或字符串值编写条件。

在 MSDN 链接[SSIS Equivalent to DTS Transform Data Task Properties](http://social.msdn.microsoft.com/Forums/en-US/sqlintegrationservices/thread/bf1b703e-dc7c-4e6a-9b8d-c4ed667fd4c8/) ...它有一些类似于此的代码：

```
If DTSSource("Col010") = "Y" Then
  DTSDestination("X") =  -1
 Else
  DTSDestination("X") =  0
End If 
```

我应该能够通过代码直接操作行值吗？由于源字段是 Yes/No 类型，它是否接受整数值？负值？是的实际上是 MS 访问中的“-1”，我想这让我感到困惑。

似乎正则表达式可以解决这个问题，但我也不确定如何使用它。

有什么我忽略的吗？必须有一种方法可以将“CHAR”转换为“YES/NO”。

** 我知道在这里很容易指出，好的 ol' 2000 SQL DTS 可以毫无问题地处理这个问题，默认情况下，开箱即用，由猴子安装。我发现自己在 SSIS 的非常小的怪癖上花费了太多时间，例如这个是/否字段问题。

我找不到关于 SSIS 和 MS Access Yes/No 字段的任何文档。MSDN 也不允许我发布问题。我知道，可怜的我:(

有没有人遇到过 SSIS 和 MS Access 的这个怪癖？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T00:00:26.513

有关派生列转换的信息，请参阅MSDN 上的**[此主题](http://msdn.microsoft.com/en-us/library/ms141069.aspx)**。

它没有具体说明您要做什么，但一些示例暗示您应该能够实现您的目标。将派生输出列的类型设置为 DT_BOOL 并使用上面代码的单行版本作为表达式（可能使用三元运算符？）。

是的，~~Access~~ Jet 将 True 表示为 -1。假 = 0，真不假。如果将按位 Not 应用于 0，则会得到 -1 的二进制补码版本。

**更新：**布尔值的 Jet 内部存储**是**一个整数（看图——但这就是他们选择的......）。因此，Jet Yes/No 字段接受零 (0) 表示 False，非零（不仅仅是 -1）表示 True。*看评论*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T18:52:31.360

为了解决这个问题，我创建了一个派生列。

该列的正则表达式为：

```
[column] == "Y" ? -1 : 0 
```

数据类型是：

```
single-byte signed integer [DT_I1] 
```

和中提琴！Jet（又名 MS Access，感谢 David W. Fenton！），现在显示我的 Yes/No 字段。

在注意到表中只出现一条记录后，我注意到我的测试数据无效并纠正了根本问题。

这是关于如何将 SQL char(1) 字段（带有“N”或“Y”值）转换为 MS Access（oooops，我的意思是 Jet）Yes/No 字段的很好的文档。

谢谢大家的帮助。Stackoverflow 是无价的。

# java - NullPointerException 与 Quartz 和 Spring

> ID：1009445
> 
> 赞同：2
> 
> 时间：2009-06-17T20:48:02.843
> 
> 标签：java, spring, tomcat, quartz-scheduler, apache-commons-logging

我正在使用 Spring Quartz 集成，每次尝试关闭 Tomcat 时，Quartz 进程都无法关闭。这是堆栈跟踪：

```
Exception in thread "org.springframework.scheduling.quartz.SchedulerFactoryBean#0_QuartzSchedulerThread" 
        java.lang.NullPointerException
    at org.apache.commons.logging.LogFactory.getCachedFactory(LogFactory.java:979)
    at org.apache.commons.logging.LogFactory.getFactory(LogFactory.java:435)
    at org.apache.commons.logging.LogFactory.getLog(LogFactory.java:685)
    at org.quartz.core.QuartzSchedulerThread.getLog(QuartzSchedulerThread.java:475)
    at org.quartz.core.QuartzSchedulerThread.run(QuartzSchedulerThread.java:404) 
```

以前有人这样看吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T20:58:35.007

如果您查看 SchedulerFactoryBean，它有一个名为`waitForJobsToCompleteOnShutdown`. 当 Spring ApplicationContext 收到关闭请求时，它告诉 Quartz Scheduler 关闭，有条件地告诉它等待所有作业完成后再关闭。

但是，Spring 只能处理关闭请求（并告诉 Quartz）关闭，如果它被通知 Tomcat 上下文被释放。您如何在 Tomcat 中使用 Spring？你有`ServletContextListener`注册电话`applicationContext.destroy()`吗？

实际的 NPE 可能是由于 Tomcat 将`static`应用程序`null`在关闭时运行的类加载器中的所有引用设置为造成的。它这样做是为了防止在 Tomcat 的回收/重新启动期间发生任何内存泄漏。但是，如果您的 Tomcat 容器中存在仍在运行的线程（因为它们没有正确关闭，例如您的 Quartz 线程），那么当该线程中的代码（例如您的试图访问它的记录器的 Quartz 线程 - 可能保留为`static`) 尝试访问已被清空的任何静态引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T20:56:17.883

您的 WAR 中是否有一份公共日志记录的副本？如果是这样，则作为 Tomcat 一部分的副本与您的 WAR 中的副本之间可能存在奇怪的交互。尝试删除 WAR 副本，看看是否有帮助。

# c# - 如何为从基类继承的所有类进行通用单元测试？

> ID：1009446
> 
> 赞同：1
> 
> 时间：2009-06-17T20:48:04.513
> 
> 标签：c#, unit-testing, generics, nunit

我正在创建一个基类（或基实体），因为我的所有数据库表都将有一个`companyID`字段。

在我的单元测试中，我必须确保`companyID`值是正确的。

如果我要返回一个对象列表，那么所有的`companyID`s 应该是相同的。

是否有一种通用的方法可以让我编写一个循环遍历所有值的测试，我可以在所有对象中使用它？（它们都将继承自具有`companyID`属性的基类）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T20:54:16.357

是的; 编写一个函数，循环遍历列表中的所有对象，将对象转换为基类，验证转换是否成功，并测试 CompanyID 是否有效。您可能必须为每种检索对象列表的方式编写不同的单元测试类，但是一旦收到列表，您就可以从这些测试中的每一个中调用一个通用函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T20:59:28.687

一种方法是实现一个具有 companyId 字段的接口，然后返回该接口的列表，这样您就不必担心实际类型是什么

# java - 您如何有效地将组件添加到带有背景图像的摇摆面板？

> ID：1009447
> 
> 赞同：1
> 
> 时间：2009-06-17T20:48:34.997
> 
> 标签：java, swing

我有一个 JPanel，我正在尝试在其上添加一些按钮。我有一个位图背景图像，我应该在其上绘制按钮。我有所有按钮的图像。我需要背景与按钮和间距正确缩放。有没有一种干净的方法可以做到这一点，或者这会很痛苦？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T23:07:58.537

首先，带有背景图像的 JPanel 很简单。从 JPanel 派生您自己的面板，添加一个 Image 字段。覆盖paintComponent() 方法以使用存储在该字段中的图像执行drawImage()。

其次是按钮。派生您自己的按钮，在构造函数中添加图像，然后使用 setIcon() 将其放在按钮上。使用 setPressedIcon(), ... 等为各种按钮状态添加附加图像。

最后是缩放，我不清楚你想要什么。drawImage() 可以缩放图像，所以没问题。当 JPanel 调整大小时，您可以通过添加侦听器来定位按钮。然后您可以重新定位按钮，x、y 值应计算为面板宽度和高度的百分比。您甚至可以重新调整按钮的比例，使宽/高比与面板比相同。

所以是的，有一种干净的方法可以做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-14T20:16:40.737

首先，带有背景图像的 JPanel 很简单。从 JPanel 派生您自己的面板，添加一个 Image 字段。这我理解，但是当尝试进行这 2 步时，它的显示问题

其次，重写paintComponent() 方法以使用存储在该字段中的图像执行drawImage()。

你能给我看一些例子吗

# c# - 选择 Linq 中的所有子对象

> ID：1009455
> 
> 赞同：11
> 
> 时间：2009-06-17T20:50:08.177
> 
> 标签：c#, linq, linq-to-sql

这真的应该很容易，但我自己无法解决，界面不够直观...... :(

假设我有一张`State`桌子，我想`Counties`从多个`States`. 在 SQL 中，这将是：

```
select c.*
  from State s join County c on c.StateCode = s.StateCode
 where s.TimeZone = -5 -- or some other criteria 
```

上面的例子很简单，可以在静态上下文中转换为 Linq：

```
var q = MyDataContext.GetTable<County>().Where(c => c.State.TimeZone = -5); 
```

但是它开始变得复杂的地方是如果我想要一个更上下文敏感的查询，例如：

```
public static List<County> GetCountiesForStates(List<State> states) {
  // gotta do something to return all the counties for all these states
} 
```

现在我可以在那个方法中做这样的事情：

```
var q = MyDataContext.GetTable<County>().Where(c => states.Contains(c.State)); 
```

但是 IMO 真的很不优雅，因为（a）我必须获得一个静态`MyDataContext`而不是使用 State 对象的隐式数据上下文，并且（b）你正在向后工作，如果你开始进一步复杂化查询，它会变得更加丑陋.

有没有办法开始查询：

```
var q = states... // or "from s in states..." 
```

本能地，我想相信你能做到这一点，但我还没有找到方法……

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-06-17T20:54:06.483

你可以这样做：

```
var q = from c in countries
        from s in c.States
        where c.Property == Something
        select s; 
```

这将为您提供所有国家/地区内所有州的枚举。这转化为以下内容：

```
var q = countries.Where(x => c.Property == Something).SelectMany(c => c.States); 
```

# c# - 如何在 .NET 中将字符串转换为日期时间？

> ID：1009457
> 
> 赞同：2
> 
> 时间：2009-06-17T20:50:39.203
> 
> 标签：c#, .net, datetime

如何`DateTime`使用 C# 将“2009 年 6 月 17 日，美国东部时间下午 3:37”之类的日期转换为变量？

我已经尝试过`DateTime.ParseExact`，但我还没有弄清楚要使用的正确格式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T20:53:04.270

```
 // String to DateTime
 String MyString;
 MyString = "1999-09-01 21:34 PM";
 //MyString = "1999-09-01 21:34 p.m.";  //Depends on your regional settings

 DateTime MyDateTime;
 MyDateTime = new DateTime();
 MyDateTime = DateTime.ParseExact(MyString, "yyyy-MM-dd HH:mm tt", null); 
```

来源： http: [//www.codeproject.com/KB/cs/String2DateTime.aspx](http://www.codeproject.com/KB/cs/String2DateTime.aspx)

修改以适合您的日期格式：

```
 // String to DateTime
 String MyString;
 MyString = "Jun 17 2009, 03:37 pm";

 DateTime MyDateTime;
 MyDateTime = new DateTime();
 MyDateTime = DateTime.ParseExact(MyString, "MMM dd YYYY, HH:mm tt", null); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-17T14:46:05.060

你试过`DateTime.Parse()`吗？我通常发现没有必要指定格式，除非月份数字和日期数字之间存在一些歧义。

# .net - 如何确定哪个控件正在吃我的键盘事件

> ID：1009460
> 
> 赞同：3
> 
> 时间：2009-06-17T20:51:52.243
> 
> 标签：.net, winforms, keyboard

在我的 .Net 应用程序中，我一直遇到一个特定表单/控件的问题，我希望收到一个键盘事件，但实际上并没有收到它。我对此的调试并没有取得太大进展，例如在我的所有控件中设置断点，并查看谁吃了不应该有的键盘事件。必须有更好的方法 - 是否有工具可以帮助我跟踪键盘事件处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-08-24T23:09:03.247

假设您使用的是完整版的 Visual Studio（不是 Express 版或其他任何版本），请使用 Spy++。当您启动 Spy++ 时，找到您的应用程序根窗口（Spy++ 有一个方便的搜索 > 查找窗口菜单项可以帮助您）然后右键单击 Windows 树视图中的根窗口并选择消息。这应该会将您带到消息窗格，该窗格将开始监视窗口的所有消息。开始键入并检查 WM_KEYDOWN 等。如果您仍然看不到按键，请转到消息选项并检查“相同进程的 Windows”。此时您应该能够监控该过程中的所有按键事件。右键单击 WM_KEYDOWN（或类似的）消息并转到属性。在属性中，应显示处理消息的窗口句柄，单击它将在 Windows 树视图中突出显示。现在您所要做的就是右键单击突出显示的窗口并选择突出显示以查看它在表单上的哪个控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T21:09:45.407

通常表单会处理按键事件。没有工具，因为它只是监视您的堆栈跟踪。最好的办法是在表单的 KeyPress 事件中创建一个跟踪语句（添加断点并右键单击，转到“当命中”），然后查看 form.KeyEventArgs 和发送者对象中的信息。

其他需要注意的重要事项：非字符键（包括向下翻页、向上翻页等）不会引发按键事件，它们只会引发 keydown 和 keyup，如果您设置按键事件会被表单“吞下”

`e.Handled = true;`

或者

`e.SuppressKeyPress = true;`

我也不建议使用设计器/属性窗口来连接您的事件，使用 Addhandler (VB) 或 += (C#)，因为在更复杂的表单中，您将有许多控件共享事件处理程序的场景，并在以下位置动态指定处理程序运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T20:58:08.673

我要做的第一件事是检查“属性”窗口（或设计器文件）以确保事件处理程序确实与事件相关联。

# objective-c - 程序终止后Objective-c和内存泄漏？

> ID：1009474
> 
> 赞同：4
> 
> 时间：2009-06-17T20:55:03.440
> 
> 标签：objective-c, memory-management, memory-leaks

我是来自 C#、VB.NET 等的新 Objective-C 程序员。这些都是垃圾收集语言，在大多数情况下，你能做的最糟糕的事情就是滥用内存使用，因为当你的程序关闭内存时由运行时回收。

但是，我不清楚Objective-C。我明白这在很大程度上取决于我们作为开发人员来管理对象的分配、初始化、保留和释放。我正在尽我最大的努力做到这一点，慢慢地想我已经掌握了它。

我担心的是：我不确定我是否正确理解了内存泄漏这个术语。这是否指没有正确释放内存，然后当我的应用程序关闭时有未使用的悬空内存？换句话说，当我的程序关闭时，Mac OS 并不能确保程序使用的所有东西都被清理干净了？

我希望这是有道理的，它真正理解程序关闭后的差异，而不是程序运行时的内存。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T21:01:05.690

**我不确定我是否正确理解了“内存泄漏”一词。这是否指没有正确释放内存，然后当我的应用程序关闭时有未使用的悬空内存？**

不; 内存泄漏是应用程序仍在运行*时发生的内存泄漏，因为 OS X 会在应用程序终止时回收所有内存。*如果不是这样，可能会因为糟糕的编码和内存管理而导致巨大的问题，并会影响整个系统。

它基本上是关于保留一个对象太多，或者没有释放足够的内存。例如，将对象添加到数组时，这是一种常见的方法：

```
NSMutableArray *array; //Pointer to some already allocated array

[array addObject:someObject];
[someObject release]; 
```

假设`someObject`分配正确，它将从保留计数 1 开始。当您将对象添加到数组时，数组会调用`retain`相关对象，在本例中将其增加到 2。

当一个数组被释放时，它会发送`release`给它的所有对象；在这种情况下，保留计数将降低到 1（假设没有其他人保留了该对象）。这不是 0，所以`someObject`仍然存在。如果`someObject`是在方法内部创建的本地指针，并且您不再拥有指向该对象的指针，那么内存将挂在那里。这是一个内存泄漏的例子，它会导致你的应用程序使用比它*需要*的更多的内存，并且会受到影响，直到它被终止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T21:00:54.440

操作系统确实会释放内存，但您可以在此之前泄漏。因此，如果您在关机时收到泄漏报告，那只是尚未释放的对象（但现在已回收内存）。

我写了一篇关于理解 iPhone 的 Objective-C 内存管理的博客文章。

[http://loufranco.com/blog/files/managing-memory-iphone.html](http://loufranco.com/blog/files/managing-memory-iphone.html)

这个是关于 CLang 静态分析工具的，我发现它对于通过检查源来发现泄漏非常有用

[http://loufranco.com/blog/files/scan-build-iphone.html](http://loufranco.com/blog/files/scan-build-iphone.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T20:59:52.697

不，当您的应用退出时，操作系统应该释放所有内存。如果不处理，内存泄漏将使您的应用程序崩溃。为了简单起见，假设设备有 10mb 的内存，并且每次调用函数时都会不断泄漏内存。迟早你会用完内存，你的应用程序会崩溃。

Apple 提供了一个很棒的工具“Instruments”，可以让您跟踪和修复内存泄漏。我建议你时不时地运行你的应用程序来检查泄漏。我已经到了这样的地步，当我调用 alloc 时，我总能找到要释放对象的位置。如果我调用 alloc 并且它不是自动释放，那么我必须找到放置释放的地方。

# php - 视觉工作室 PHP

> ID：1009476
> 
> 赞同：13
> 
> 时间：2009-06-17T20:55:44.560
> 
> 标签：php, visual-studio-2005

我多年来一直使用 VS.PHP ( [http://www.jcxsoftware.com/vs.php](http://www.jcxsoftware.com/vs.php) ) 并取得了巨大的成功，但是我的所有机器上的许可都用完了，我希望有一个统一的开发环境我的 PHP 编程。

诚然，它只有 99 美元，而且我喜欢为可以帮助我的代码付费，但我有太多家用机器，宁愿把 99 美元花在船或酒上。

我很想留在 Visual Studio(2005)，想知道是否有任何人都知道的用于 Visual Studio 中 PHP 开发的优秀开源替代插件。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-20T15:26:25.323

我会推荐用于 Visual Studio的独立[PHP 工具（免费软件和试用版）；](http://visualstudiogallery.msdn.microsoft.com/6eb51f05-ef01-4513-ac83-4c5f50c95fb5)简单、快速、智能的 IntelliSense，可选择完全免费使用

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T21:02:15.623

有[长矛](http://visualstudiogallery.msdn.microsoft.com/en-us/BE3906D3-2C6E-4C45-B1F4-AB8DA01B339C)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-29T14:17:02.753

您可以考虑使用[Visual Studio Code](https://code.visualstudio.com/)，它可能不如 VS 和第三方插件那么强大，但它确实支持开箱即用的 PHP！

[Visual Studio Code](https://code.visualstudio.com/)是免费的，可在 Linux、Mac OSX 和 Windows 上使用”

您还可以使用[vscode-php-debug](https://github.com/felixfbecker/vscode-php-debug)扩展添加 PHP 调试。

# vim - 如何在 vimrc 中轻松测试 guifont？

> ID：1009478
> 
> 赞同：13
> 
> 时间：2009-06-17T20:56:06.637
> 
> 标签：vim

我有许多不同的机器要登录，但它们都没有像样的字体。所以，我希望能够拥有我对字体的第一个偏好，但如果它在机器上不存在，请使用另一个字体，依此类推。有没有人这样做过？

...

因此，在重新阅读有关 guifont 的帮助之后，似乎我应该能够定义多种用逗号分隔的字体。有趣的是，虽然我的 .vimrc 中有以下行：

```
set guifont=-dt-interface\ user-medium-r-normal-*-*-100-*-*-m-*-iso8859-1,Liberation\ Mono\ 8 
```

在一台机器上（gvim 7.1）我做了一个

```
:set gfn?
guifont=-dt-interface user-medium-r-normal-*-*-100-*-*-m-*-iso8859-1 
```

在另一台机器（gvim 7.2）上，我得到：

```
:set gfn?
guifont=-dt-interface user-medium-r-normal-*-*-100-*-*-m-*-iso8859-1,Liberation Mono 8 
```

我将尝试在不正确的机器上运行 7.1 并查看它是否解决了问题，如果可以，它看起来不是 7.2 中的错误吗？

* * *

## 解决方案

这是我想出的解决问题的代码。它看起来很脆弱，但它至少让我现在在我的实际工作中取得了一些进展：

```
" SETTINGS FOR GUI ONLY MODE
: Trying to emulate how it should work but on some machines it will not select the available font
" set guifont=-dt-interface\ user-medium-r-normal-*-*-100-*-*-m-*-iso8859-1,Liberation\ Mono\ 8
let g:MyFontPre = ''
let g:MyFontPost = ''
let g:MyFontSize = '8'
if has("gui_running")
    if ( match(hostname(), 'server5-1..') >= 0 )
      let g:MyFontSize = '10'
      let g:MyFontPre = '-dt-interface\ user-medium-r-normal-*-*-'
      let g:MyFontPost = '0-*-*-m-*-iso8859-1'
    elseif ( match(hostname(), 'server5-3..') >= 0 )
      let g:MyFontPre = 'Liberation\ Mono\ '
      let g:MyFontPost = ''
    else
      " Leave it the default for now
    endif
    execute "set guifont=".g:MyFontPre."".g:MyFontSize."".g:MyFontPost
endif

" FONT SIZE SHORTCUTS
function! ToggleMyFontSize()
  if ( g:MyFontSize == 12 )
    let g:MyFontSize = 8
    execute "set guifont=".g:MyFontPre."".g:MyFontSize."".g:MyFontPost
  elseif ( g:MyFontSize == 8 )
    let g:MyFontSize = 10
    execute "set guifont=".g:MyFontPre."".g:MyFontSize."".g:MyFontPost
  elseif ( g:MyFontSize == 10 )
    let g:MyFontSize = 12
    execute "set guifont=".g:MyFontPre."".g:MyFontSize."".g:MyFontPost
  endif
endfunction
nnoremap  <silent>  <F12> :call ToggleMyFontSize()<CR> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-12T09:27:18.953

如果使用逗号对您不起作用，那么如何允许优雅的字体降级？此技巧也可用于其他“设置”选项。

```
silent! set guifont=Font\ One:h8
if &guifont != 'Font One:h8'
    set guifont=Font\ Two:h8
endif 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-18T02:54:41.200

不是直接解决您的问题，但您可以使用`hostname()`条件语句来选择您想要的字体：

```
 if hostname() == 'home-pc'
      set guifont=...
  elseif hostname() == 'work-pc'
      set guifont=...
  else
      set guifont=...
  endif 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-29T19:32:32.567

您还可以将所有常用设置放入`.vimrc`特定机器并选择字体`.gvimrc`（如果您是 Windows 用户，请使用`_vimrc`and`_gvimrc`代替）。

我知道这不是您问题的直接答案，但我发现值得指出这一点。:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-28T17:31:50.380

仅 Unix 解决方案，在 linux 上测试。我猜这将适用于 OSX，但我从未使用过 OSX，抱歉。

```
let font = {"name" : "fontNameHere", "size" : "12"}
call system("fc-list -q " . font.name)
if has("unix") && !v:shell_error
    let &guifont=join(values(font))
end 
```

只需将字典中的字体名称和大小替换为您想要的字体 - 即，

```
let font = {"name" : "DejaVuSansMono", "size" : "12"} 
```

# jquery - 基于 .data() 键/值的过滤器元素

> ID：1009485
> 
> 赞同：128
> 
> 时间：2009-06-17T20:57:57.397
> 
> 标签：jquery, filter

假设我有 4 个带有 class 的 div 元素`.navlink`，单击它们时，用于`.data()`将名为 的键设置`'selected'`为 的值`true`：

```
$('.navlink')click(function() { $(this).data('selected', true); }) 
```

每次`.navlink`点击一个新的，我想存储以前选择`navlink`的供以后操作。是否有一种快速简便的方法可以根据使用存储的内容来选择元素`.data()`？

似乎没有任何 jQuery **:filters**符合要求，我尝试了以下（在同一个点击事件中），但由于某种原因它不起作用：

```
var $previous = $('.navlink').filter( 
    function() { $(this).data("selected") == true }
); 
```

我知道还有其他方法可以做到这一点，但现在我主要只是好奇它是否可以通过`.data()`.

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2009-06-17T21:06:27.910

您的过滤器可以工作，但是您需要在传递给过滤器的函数中的匹配对象上返回 true 才能获取它们。

```
var $previous = $('.navlink').filter(function() { 
  return $(this).data("selected") == true 
}); 
```

* * *

## 回答 #2

> 赞同：156
> 
> 时间：2012-11-29T10:05:54.203

只是为了记录，您**可以**使用 jquery 过滤数据（这个问题已经很老了，并且 jQuery 从那时起就发展了，所以写这个解决方案也是正确的）：

```
$('.navlink[data-selected="true"]'); 
```

或者，更好（为了性能）：

```
$('.navlink').filter('[data-selected="true"]'); 
```

或者，如果您想使用`data-selected`set 获取所有元素：

```
$('[data-selected]') 
```

**请注意**，此方法仅适用于通过 html-attributes 设置的数据。如果您通过`.data()`调用设置或更改数据，此方法将不再有效。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-10-03T15:52:58.333

我们可以很容易地制作一个插件：

```
$.fn.filterData = function(key, value) {
    return this.filter(function() {
        return $(this).data(key) == value;
    });
}; 
```

用法（检查单选按钮）：

```
$('input[name=location_id]').filterData('my-data','data-val').prop('checked',true); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-06-17T21:03:22.533

我注意到了两件事（尽管它们可能是您写下来时的错误）。

1.  您在第一个示例中遗漏了一个点 ( `$('.navlink').click`)
2.  要使过滤器起作用，您必须返回一个值 ( `return $(this).data("selected")==true`)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-06-17T21:01:44.690

听起来比它的价值更多的工作。

1) 为什么不只使用一个 JavaScript 变量来存储对当前选定元素\jQuery 对象的引用。

2) 为什么不向当前选定的元素添加一个类。然后你可以在 DOM 中查询“.active”类之类的东西。

# command-line - 如何在没有根目录的情况下将文件和目录添加到 zip 文件？

> ID：1009501
> 
> 赞同：5
> 
> 时间：2009-06-17T21:02:02.537
> 
> 标签：command-line, zip

zip 实用程序，当`zip -r out.zip base/*`在此目录结构上调用时

```
.
./base
./base/b
./base/b/c
./base/d 
```

创建以下结果

```
 adding: base/b/ (stored 0%)
  adding: base/b/c (stored 0%)
  adding: base/d (stored 0%) 
```

我想从以下输出中获取包含数据的文件

```
 adding: b/ (stored 0%)
  adding: b/c (stored 0%)
  adding: d (stored 0%) 
```

我希望 -j 选项对我有帮助，但它没有：它完全扁平化了目录结构。目前，我找到的唯一解决方案是 cd 进入 base 并从这里调用 zip ，但我想知道是否有一个电源开关我无法在文档中识别出来。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T21:46:48.017

我知道您不想这样做`cd`，但是...

如果所有其他方法都失败了，并且您希望将 zip 调用保持在一行，则可以链接调用并使用相对路径在根目录中输出 zip：

对于 Windows：

`cd base & zip -r ..\out.zip * & cd ..`

对于 Linux/Unix：

`cd base ; zip -r ../out.zip * ; cd ..`

# sql - 让 Hibernate 进行简单的更新，而不是大量的选择然后更新

> ID：1009504
> 
> 赞同：0
> 
> 时间：2009-06-17T21:02:18.930
> 
> 标签：sql, hibernate, query-optimization, sql-update

让我们先设置问题。

我拥有的是 >4 表：客户、地址、订单、订单项。每个都使用 Hibernate Annotations 进行映射，并通过 Spring DAO/Services 层访问。

我想要做的是将重复的客户合并在一起。因此，真正需要发生的只是与客户 B 关联的所有订单和地址，需要更新其 customer_id 外键以指向客户 A。然后客户 B 必须设置其禁用位。

hibernate 没有将这些简单的查询发送到我们的数据库，而是发疯了，发出了大量的选择然后更新查询。特别是它选择附加到订单的所有订单项目（因为这是定义`EAGER`的，并且这一点是不可更改的。）。为了在更新之前获得选择以停止发生，我尝试在常规顶部添加休眠实体注释，`javax.persistence.Entity`例如：

```
@org.hibernate.annotations.Entity(dynamicUpdate = true, selectBeforeUpdate = false, dynamicInsert = true) 
```

这似乎没有影响，除了简单的查询，它只更新表中的单个项目。

我使用以下休眠条件获取对象：

```
 Criteria c1 = null;
            Criteria c2 = null;
            Criteria c = session.createCriteria(Customer.class);
            c.setResultTransformer(CriteriaSpecification.DISTINCT_ROOT_ENTITY);

            if(resultLimit>0) c.setMaxResults(resultLimit);
            if(timeout>0) c.setTimeout(timeout);
            for(String filter: sqlFilters) {
                if(filter.indexOf("{alias}.customer_")!=-1) c.add(Restrictions.sqlRestriction(filter));
                else if(filter.indexOf("{alias}.address_")!=-1 && addrsAttached) {
                    if(c1==null)
                        c1 = c.createCriteria("addresses").setFetchMode("type", FetchMode.JOIN);
                    c1.add(Restrictions.sqlRestriction(filter));
                } else if(filter.indexOf("{alias}.order_")!=-1 && ordersAttached) {
                    if(c2==null)
                        c2 = c.createCriteria("orders").setFetchMode("orderItems", FetchMode.SELECT);
                    c2.add(Restrictions.sqlRestriction(filter));
                }
            }
            return (List<Customer>) c.list(); 
```

然后我将所有地址和订单对象从客户 B 移动到客户 A 并运行

```
return (Customer) this.getHibernateTemplate().merge(customer); 
```

在两个客户对象上。这最终会创建大量获取所有关联对象（即 OrderItems、Products、ProductType、ProductPricingTmpl 等）的 select 语句。

我需要删除这些选择！如果他们不在那里，查询看起来很正常并且很有效率！更新输出的查询是完美且动态的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T21:12:39.113

线索可能在于您选择的 merge() 操作。从休眠 javadoc：

> 将给定对象的状态复制到具有相同标识符的持久对象上。如果当前没有与会话关联的持久实例，它将被加载。

所以你强迫 Hibernate 在修改它之前加载所有数据。

尝试不同的操作，例如 update() ：

> 使用给定分离实例的标识符更新持久实例。

但是，没有任何承诺，Hibernate 可能会决定无论如何都需要加载它。dynamicUpdates=true 配置实际上可能会使情况变得更糟，因为它需要知道要开始什么才能发布动态更新。

# iis - IIS6 (FTP) 中的 PassivePortRange 问题

> ID：1009506
> 
> 赞同：1
> 
> 时间：2009-06-17T21:02:54.827
> 
> 标签：iis, iis-6, ftp, passive-mode

我正在尝试为在 Windows Server 2003 中的 IIS6 上运行的 ftp 服务器指定被动端口范围。

我用过：adsutil.vbs set /MSFTPSVC/PassivePortRange "5500-5600"

我已签入 metabas 文件并将更改应用到它。我还可以使用：

adsutil.vbs 获取 /MSFTPSVC/PassivePortRange

它返回我设置的范围。

在重新启动 ftp 服务、重新启动 IIS 甚至重新启动后，ftp 服务器仍然使用它的默认范围（5000-65535 AFAIK）。

还有什么我需要做的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-23T09:31:44.707

我已经解决了。这是windows防火墙的一个bug。如果禁用防火墙，则正确使用端口 raneg。

我在防火墙中启用了“FTP 服务”以及我想要的端口范围。我禁用了 FTP 服务，而是手动添加了端口 21。现在工作正常！

# c# - C#：在运行时生成的列表上调用 ForEach

> ID：1009507
> 
> 赞同：3
> 
> 时间：2009-06-17T21:03:03.970
> 
> 标签：c#, generics

我正在使用运行时确定的类型参数生成 List<T>。我想调用 ForEach 方法来遍历列表中的项目：

```
//Get the type of the list elements
Type elementType = GetListElementType(finfo);

Type listType = Type.GetType("System.Collections.Generic.List`1[" 
                              + elementType.FullName + "], mscorlib", true);

//Get the list
var list = getList.Invoke(null, new Object[] { finfo.GetValue(myObject) });

MethodInfo listForEach = listType.GetMethod("ForEach");

//How do I do this?  Specifically, what takes the place of 'x'?
listForEach.Invoke(list, new object[] { delegate ( x element )
                            {
                                //operate on x using reflection
                            }
                        }); 
```

给定一个 MethodInfo 对应于我的运行时生成的列表类型中包含的 ForEach 方法，使用匿名方法调用它的正确方法是什么？以上是我的第一次stab，但是不知道如何声明匿名方法的参数的类型。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T21:14:34.447

你可以这样做：

```
var someGenericListYouCreated = ...;
var enumerable = someGenericListYouCreated as IEnumerable;

foreach(var foo in enumerable){
    ...
} 
```

但是，我正在努力做你真正想要的。

编辑：

对，我希望这是有道理的

```
private class Adapter<T>
{
    private readonly Action<object> act;

    public Adapter(Action<object> act){
        this.act = act;
    }

    public void Do(T o)
    {
        act(o);
    }
}

public static void Main(string[] args)
{
    Type elementType = typeof(string);

    var genericType = typeof(List<>).MakeGenericType(elementType);
    var list = Activator.CreateInstance(genericType);

    var addMethod = list.GetType().GetMethod("Add");
    addMethod.Invoke(list, new object[] { "foo" });
    addMethod.Invoke(list, new object[] { "bar" });
    addMethod.Invoke(list, new object[] { "what" });

    Action<object> printDelegate = o => Console.WriteLine(o);

    var adapter = Activator.CreateInstance(typeof(Adapter<>).MakeGenericType(elementType), printDelegate);
    var adapterDo = adapter.GetType().GetMethod("Do");

    var adapterDelegate = Delegate.CreateDelegate(typeof(Action<string>), adapter, adapterDo);

    var foreachMethod = list.GetType().GetMethod("ForEach");

    foreachMethod.Invoke(list, new object[] { adapterDelegate });
} 
```

这是做什么的：

1.  创建一个通用列表（注意它使用 typeof(List<>)
2.  向此列表添加一些字符串
3.  创建一个新的委托，在这种情况下是一个动作
4.  创建适配器类的实例
5.  在适配器类上创建我们需要的类型的委托（Action）
6.  呼叫 ForEach

请注意，如果您知道要处理的类型，则不一定非要使用 Action。你可以很容易地使用一个动作，它会工作......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T21:27:26.230

这里有很多问题。

首先，通过使用字符串连接构造类型的名称来获取具有泛型参数的类型的类型对象有点狡猾。你应该这样做：

```
Type genericType = typeof(List<>).MakeGenericType(new Type[] { listType }); 
```

这干净多了。现在，要调用此类型实例的 ForEach 方法，您将需要一个`Action<T>`对象。如果您想使用 lambda 表达式或函数指针，这对我来说并不完全明显，但关键是您传递的实例`Action<T>`就像普通参数一样：

```
methodInfo.Invoke(list, new object[] { x }); 
```

如果您能澄清 x 的来源（即`Action<T>`参数），也许我们可以提供更多帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T21:33:45.203

我不能让匿名方法起作用，但是，如果你有一个定义的方法要在调用 ForEach 时执行，并且它被重载到可能的数据类型，它就会起作用

```
class Program
{
    static void Main(string[] args)
    {
        var sampleElement = "Foo";

        Type listType = typeof(List<>).MakeGenericType(sampleElement.GetType());
        Type actionType = typeof(Action<>).MakeGenericType(sampleElement.GetType());

        var list = Activator.CreateInstance(listType);
        var action = Delegate.CreateDelegate(actionType, null, typeof(Program).GetMethod ("ForEach"));

        (list as List<string>).AddRange (new []{ "1", "2" });

        listType.GetMethod ("ForEach").Invoke (list, new object []{ action });
    }

    public static void ForEach(string item)
    {
        Console.WriteLine(item);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T21:40:35.360

使用泛型很酷，因为它可以为您节省大量编码，并且理论上可以提高性能，因为它避免了装箱和拆箱等，但我认为不需要使用动态创建的泛型，使用反射和非常慢的方法.

为什么不使用一个简单的 IList 接口和一个 foreach 循环？

# internet-explorer - IE 书签文件的一个奇怪问题

> ID：1009509
> 
> 赞同：5
> 
> 时间：2009-06-17T21:03:24.997
> 
> 标签：internet-explorer, bookmarks

除了存储 URL 之外，IE 书签还会在您添加书签的页面上存储任何加载的 iframe 或框架的名称和位置。当您加载该书签时，IE 会尝试使用书签文件中的 url 加载页面上的框架。

也许这在 90 年代是个好主意，（或者今天它仍然是个好主意，我只是想不出原因），但是对于任何使用 iframe 的足够复杂的 Web 应用程序来说，它很容易导致问题。这就是我现在所处的情况。

当我在我的应用程序中处理这个问题时，我真正想要的是一种关闭这种行为的方法。除此之外，如果有人能告诉我为什么书签会存储和使用这些信息，我会是一个快乐的露营者，因为我非常好奇。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-20T17:24:44.210

我怀疑你几天前把这个问题寄给了 IEBlog。:-)

IE 没有提供抑制这一点的选项，它存在的原因在今天基本上仍然有效：用户希望加载书签会重建他们最初看到的页面。虽然某些基于框架的 Web 应用程序确实不能以这种方式重构，但允许子框架导航的站点通常*只有*在子框架导航到与保存书签时相同的 URL 时才能正确重构，这仍然是完全正确的。 .

# c# - Label.Text 更改被阻止？

> ID：1009510
> 
> 赞同：1
> 
> 时间：2009-06-17T21:03:35.357
> 
> 标签：c#, .net, sql-server-2000, label, database-restore

我正在尝试使用 Microsoft.SqlServer.Management.Smo.Restore 对象来恢复 SQL Server 2000 数据库。就在我开始恢复操作之前，我更改了标签的文本，以便用户知道发生了什么。但是，更改的文本在 GUI 上不可见（即，文本保持原样），直到在 fullRestore.Wait() 行之后。

```
lblStatus.Text = "Restoring Database";
Restore fullRestore = new Restore(); 

// Configure fullRestore

fullRestore.SqlRestore(_server);
fullRestore.Wait(); 
```

奇怪的是，lblStatus 最终确实显示“正在恢复数据库”，但直到恢复完成*后才*显示。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T21:06:18.953

您正在阻止 GUI 线程，这会阻止它更新。您可以调用 lblStatus.Refresh()，或将您的 Wait 移至后台线程（这最终是正确的做法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T21:06:07.193

这是一个线程问题。您可以在单独的线程或后台线程上执行此操作。我见过人们使用的一种方法是做一个 Application.DoEvents() 虽然我通常远离那个电话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T21:14:31.293

在您完成对前台线程的处理并释放它之前，无法对 GUI 进行更新。您需要在后台线程上进行恢复以允许前台线程继续更新 GUI。考虑将恢复代码放在单独的方法中并使用 [ThreadPool.QueueUserWorkItem( )](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.queueuserworkitem.aspx)，并传递恢复方法。这将在线程池线程上触发您的恢复方法。

如果您需要在线程完成时对线程和通知进行更多控制，您可以使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)

# macos - 非 Qt 应用程序中的 Mac 事件循环 Qt 插件

> ID：1009511
> 
> 赞同：2
> 
> 时间：2009-06-17T21:03:37.183
> 
> 标签：macos, qt, events, qtplugin

我正在尝试编写一个 Trolltech Qt 库，该库将从用MacApp 编写的*非 Qt CFM / 应用程序中使用。*

我遇到麻烦，当我创建`QApplication`它时，它会在我的非 Qt MacApp mac 应用程序中接管我的事件循环。我已经覆盖`QApplication::macEventFilter`调用`CallNextEventHandler`，但这会在 MacApp 应用程序中调用我的*Carbon 事件处理*程序，但是选择菜单项之类的事件不起作用，但同一项目的热键工作正常。

我迫切需要弄清楚这一点。QMFCApp 有 Mac 版吗？
我需要让它工作并让它以正确的方式工作。按钮单击和菜单项似乎不起作用，但其他事件（例如键入）似乎起作用。我想我有些需要处理旧`EventRecord`事件并重新发布事件，但我不确定。

如何让 Qt 在我的旧应用程序中作为插件工作？请帮助我绝望。

格兰特·希基

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-03T04:01:25.630

您尝试为 Mac OS 9 开发应用程序是否正确？MacApp 已停产近十年，您似乎正在尝试将真正不应该混合的技术混合在一起。

也许您可以描述您在更高级别上尝试做的事情，以及您的限制是什么？我希望使用更现代的位必须有一种更简单的方法。

# linq - 将 2 个 Linq 序列合并为一个，具有优先级

> ID：1009516
> 
> 赞同：1
> 
> 时间：2009-06-17T21:04:42.843
> 
> 标签：linq

我有 2 个序列，每个序列都返回一个带有 2 个字段的匿名类型（称为 x 和 y）。从语义上讲，x 在这两个序列中都用作键和 ya 值。

如果相同的 x 出现在两个序列中，我如何指定第一个序列优先于第二个序列，从而将它们合并为一个序列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T21:19:21.643

你可能会发现没有 Linq 会更容易，但我在想这样的事情：

```
var distinctWithPrecedence = seq1
  .Concat(seq2)
  .GroupBy(i => i.x)
  .Select(g => g.First()); 
```

如果 Linq 在幕后做的不多。基本思想是按键分组。然后通过分组从每个分组中提取第一个元素。如果 Linq 的行为我认为它应该是第一个元素将是连接列表中的第一个元素，这意味着第一个序列有先例。

可能还有其他方法可以做到这一点，但这是第一个想到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T21:22:23.477

我会从

```
var res = seq1.Union(seq2, Comparer); 
```

但是文档`Enumerable.Union`没有指定从哪个序列中获取匹配元素，并且需要`Comparer`是一个实现，`IEqualityComparer<TSource>`如果`TSource`是匿名类型，您将不会拥有该实现（但可能值得具体化以允许这样做）。

否则，您将需要实现自己的助手，例如：

```
IEnumerable<KeyValuePair<TKey, TValue>> Union(
                     this IEnumerable<KeyValuePair<TKey, TValue>> first,
                     IEnumerable<KeyValuePair<TKey, TValue>> second) {
   var allFirst = first.ToDictionary(v => v.Key, v => v.Value);
   foreach (var kv in allFirst) { yield return kv; }

   foreach (var s in second) {
     if (!allFirst.ContainsKey(s.Key)) {
       yield return s;
     }
 } 
```

（如果您想坚持自己的类型（属性 x 和 y），您可以在单个类型参数上使其泛型，但您需要添加类型约束以访问单独的属性。）

# sql-server - 使用 SQL Server 2005 的 SQL 数据透视

> ID：1009518
> 
> 赞同：0
> 
> 时间：2009-06-17T21:06:05.600
> 
> 标签：sql-server, sql-server-2005, pivot

我正在寻找在两个表上使用数据透视的解决方案。不过，我的问题是，列和行标题的数量/名称作为第三个表中的行存在。我的第三张表如下所示：

```
ID      Name
1       Row1
1       Row2
1       Row3
2       Col1
2       Col2
2       Col3 
```

我的最终解决方案应如下所示：

```
 Col1   Col2   Col3  Col4 .........    Total
Row1      4       2     4      2                 12

Row2      2    ...................              ...

Row3      7  ....................                ...

....

Total     12      14    6      3                 80 
```

提前致谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-07-01T16:43:20.277

您可以使用 new[`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410.aspx)运算符。

# qt - 有什么方法可以“批量加载”Qt 数据模型以避免过多的信号调用？

> ID：1009520
> 
> 赞同：2
> 
> 时间：2009-06-17T21:06:11.013
> 
> 标签：qt

我有`QStandardItemModel`一些手动实现的“全选”功能。这会循环并更新所有项目（或某些项目 - 涉及过滤器）的数据。问题是我有一些插槽连接到模型的`dataChanged`信号，当用户执行“全选”并且模型包含数千个条目时，我不希望它们在每一步都被调用。

有没有办法在模型中一次设置多个项目，并且`dataChanged`整个更改只发出一次？

感谢您的任何想法！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T11:22:29.997

尝试在发出信号的对象上使用[QObject::blockSignals](http://doc.trolltech.com/4.5/qobject.html#blockSignals)方法。这将允许您抑制然后恢复信号生成。对于这种类型的操作非常有用。

# python - 从 Google Finance 获取超出 API 范围的财务数据

> ID：1009524
> 
> 赞同：5
> 
> 时间：2009-06-17T21:07:00.763
> 
> 标签：python, api, data-mining, google-finance

谷歌的金融 API 是不完整的——页面上的许多数字，例如：

[http://www.google.com/finance?fstype=ii&q=NYSE:GE](http://www.google.com/finance?fstype=ii&q=NYSE:GE)

无法通过 API 获得。

我需要这些数据来根据 Greenblatt 公式对加拿大证券交易所的公司进行排名，该公式可通过谷歌搜索“greenblatt index scans”获得。

我的问题：访问和处理这些网页上的数据的最智能/干净/有效的方式是什么。在这种情况下，这种繁琐的方法真的有必要吗？如果是，最好的方法是什么？我目前正在为与此相关的项目学习 Python。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T23:55:59.923

您可以尝试要求 Google 提供缺少的 API。否则，你会被[屏幕抓取](http://en.wikipedia.org/wiki/Screen_scraping)卡住，这永远不会有趣，容易在没有通知的情况下中断，并且**可能违反 Google 的服务条款**。

但是，如果你仍然想写一个屏幕抓取工具，那么[mechanize](http://wwwsearch.sourceforge.net/mechanize/)和[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)的组合是很难被击败的。BeautifulSoup 是一个 HTML 解析器，mechanize 是一个基于 Python 的 Web 浏览器，它可以让您登录、存储 cookie，并且通常可以像任何其他 Web 浏览器一样导航。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T21:42:24.607

[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)将是使用 Python 解析 HTML 的首选方法

您是否考虑过 Google 以外的选项（例如 Yahoo Finance API）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T21:20:17.990

抓取网页总是很糟糕，但我建议将它们转换为 xml（通过 tidy 或其他一些 HTML -> XML 程序），然后使用 xpath 遍历您感兴趣的节点。

# data-modeling - 实体关系建模：如何实现实体“角色”？

> ID：1009528
> 
> 赞同：2
> 
> 时间：2009-06-17T21:07:54.163
> 
> 标签：data-modeling, entity-relationship, oop

我最近阅读了一些关于数据建模的文章，并且对实体可能扮演的角色有疑问。

考虑一个简单的案例，您有一家公司，一家公司可以是供应商、客户、分销商等，也可以是这些角色的组合。因此，X 公司可能既是供应商又是客户。

在数据级别下，您可能有一个 CompanyS 表，然后是 SupplierS、CustomerS 等引用 Company 表的表。至少我认为这就是它的表现方式。

好的，所以在应用程序领域的某个地方，您有 CustomerS 和 SupplierS 等的类。每个都由一个公司组成，然后是该特定类别的其他任何特殊之处。

只要我们一次只使用一个实体类，这一切都很好，对我来说很有意义。如果我们想从一家公司开始，看看它扮演什么角色怎么办？所以在一个应用程序中，我可能会拉出一个公司，然后看到它是供应商和分销商。

现在我可以想到几种不同的方法来做到这一点，但我觉得因为这个问题域太老了，所以必须有一些经过验证的真实模式来对这些概念进行建模。

因此，我在这里寻找的是在应用程序级别对实体角色进行建模的常用策略或模式。关于这个特定主题的具体参考资料将不胜感激（无论是博客、书籍还是其他）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-09T04:11:25.013

我建议仅将继承作为最后的手段。像这样的关系并不简单，而且很容易通过早期优化的形式破坏设计。当公司既可以是供应商和/或分销商时，您不希望创建具有供应商或分销商属性的公司。相反，请像规范化数据库一样考虑它。你有一组概念如下

*   **公司**（CompanyID、名称、attrib1、attrib2）
*   **作为公司的供应**商（SupplierID、CompanyID[外键]、attrib1、attrib2）
*   **也是公司的分销商**（DistributorID、CompanyID、attrib1、attrib2）
*   **VendorRelationship**（RelationshipID、SupplierID、DistributorID、attrib1、attrib2）如果您需要跟踪有关供应商和分销商之间连接的详细信息

这使公司、供应商和分销商之间的耦合保持在较低水平。

另一个例子是当一个类有一个状态时。很多时候，概念模型使用继承来显示类如何是具有多态子类的类的实例，以便处理不同的可能状态。当您必须更改实例的状态并且您意识到您的指针将失效和/或受影响的实例可能被克隆或以其他方式位于难以或保持更新的集合中时，这会导致问题。因为您必须创建另一个类的新实例，然后替换指向目标公司的指针，如果有很多副本或实例包含在容器或列表中，这可能会很困难。更简单、更简洁的解决方案是让类包含一个 BaseClass 类型的元素，该元素具有作为子 lasses 的可能状态。这边走，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-09T04:20:02.093

您可能想使用[对象角色建模](http://www.agilemodeling.com/artifacts/ormDiagram.htm)检查数据库设计。它从根本上使用您在问题陈述中使用的类型的表达式，断言对象（实体）彼此之间所扮演的角色。除其他功能外，它还可以生成完整的关系数据库设计。

这是[另一个参考](http://www.tdan.com/view-articles/5033)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-07T09:13:06.350

大多数[DBMS](http://en.wikipedia.org/wiki/Database_management_system)并不适合解决这个问题，因为它们缺乏所需的灵活性。我想这就是为什么[Charles Bachman早在 1977 年就通过添加角色概念提出了](http://en.wikipedia.org/wiki/Charles_Bachman)[CODASYL](http://en.wikipedia.org/wiki/CODASYL) [网络数据模型](http://en.wikipedia.org/wiki/Network_model)的扩展（另请参阅[重新审视的角色数据模型](http://portal.acm.org/citation.cfm?id=1412402)( [PDF](http://www.fernuni-hagen.de/ps/pubs/Roles05.pdf) )）。然而，恕我直言，巴赫曼仍然过多地受到[分层数据模型](http://en.wikipedia.org/wiki/Hierarchical_model)的影响，从所有者/成员关系集的角度进行思考。

从概念上讲，手头的问题对应于图/网络。如果将实体建模为节点，则边（关系）将带有标签以指示角色。例如，Order 实体将具有连接到某个其他实体的“ordered by”关系，该实体可以是 Person、Company 或其他实体。当您遵循“ordered by”关系时，您知道目标节点表示实现 Orderer 接口的实体。

用数学术语来说，这里需要的是一个有标签的、有向的多重图。您会在[Neo4j](http://neo4j.org/)（我参与的开源项目）等原生图形数据库或[RDF](http://en.wikipedia.org/wiki/Resource_Description_Framework)中发现这一点。[在RDBMS](http://en.wikipedia.org/wiki/RDBMS)之上还有 RDF 实现。也许图形概念也可以给你一些关于如何从头开始实现它的提示。我还在我的博文[Flexibility in data modeling 中](http://blog.nawroth.com/2009/03/flexibility-in-data-modeling.html)简要讨论了角色概念。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T22:10:06.550

我担心，我无法给出“通用模式”如何处理这个问题。但我也认为，根本不存在“唯一”的模式。

原因是，建模在某种程度上是“模糊的”。我记得在一本德国电脑杂志上有一个相当相似的建模问题。这是一种竞赛，他们展示了他们收到的不同解决方案。这些解决方案完全不同，但所有这些解决方案都以某种方式有效。我认为这也取决于手头问题的细节。有时“精益”解决方案很漂亮……在其他情况下，必须完成“大、肥、大”解决方案以满足项目需求……

例如，建模仍然是一项具有许多自由参数的创造性任务。

当然，有一些达成一致的“元模式”。例如在 著名的“四人帮”的[“设计模式”一书中，还有许多其他可用的。](http://en.wikipedia.org/wiki/Design_Patterns_(book))但是仍然存在许多问题，其中不存在公认的“最佳”解决方案。

在您的情况下，可以使用子分类（这相当于专业化）。也可以使“供应商”等只是一个公司可能/可能不支持的接口（这可以看作是抽象实体的可选专业化）。但也可以使用组合来解决相同的问题。角色可以是由公司链接的对象（实体）（例如，通过关系“具有角色”）。

# pdf - 在 PDF 页面上确定“感兴趣的框”

> ID：1009529
> 
> 赞同：0
> 
> 时间：2009-06-17T21:07:58.017
> 
> 标签：pdf, layout, bounding-box

我希望能够确定 PDF 页面上文本、图像和路径区域的边界框，类似于此处显示的内容：

[http://www.windjack.com/products/screenshot/pdfcanscreenshot2.html](http://www.windjack.com/products/screenshot/pdfcanscreenshot2.html)

查看 PDF 规范，我可以看到如何确定路径和图像的边界框，但我看不到如何到达它们的文本。我是否必须手动计算它，从字体大小等确定字形的高度和宽度，还是有更直接的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T02:07:56.583

您可以从[“如何从 pdf 文档中获取字符偏移信息？”的解决方案开始。](https://stackoverflow.com/questions/196788/how-do-i-get-character-offset-information-from-a-pdf-document/203553#203553) 这将为您提供文档中字符和/或子字符串的 x、y、宽度和高度。从那里开始，更难的部分是将字符组绑定到空间上不同的区域。不能保证页面上的空间分组文本在文件格式的语法中会彼此接近......

# c - 如何在 C 中播放 Flash 动画？

> ID：1009542
> 
> 赞同：1
> 
> 时间：2009-06-17T21:11:08.447
> 
> 标签：c, flash

我想用纯 C (win32) 播放 Flash 动画 (SWF)。我目前正在使用“AtlAxWin”窗口类来播放它，但它不是很适合。

如果安装了 Flash 播放器，我将不胜感激任何直接使用 Flash 播放器甚至检测（在 C 中）的线索。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T21:14:33.727

如果您使用的是 Visual Studio，您可以将 Web 浏览器嵌入到您的项目中，并将文档文本设置为一些 Flash 嵌入代码。当然，请确保您的 SWF 与您的 EXE 位于同一文件夹中。

那将是快速而肮脏的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T21:26:17.183

我会推荐一些帮助程序库来执行此操作，例如[wxwidgets](http://www.wxwidgets.org/)或[qt](http://www.qtsoftware.com/products/)。

# iphone - AnalysisTool / Clang 结果：ivar 命名约定违规

> ID：1009546
> 
> 赞同：2
> 
> 时间：2009-06-17T21:12:16.773
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, clang

AnalysisTool（一个 Clang GUI 前端）指出我的一些 ivars 命名不正确：

具体来说：

> 实例变量“groupName”的名称不以“m”前缀开头

**'m' 前缀在 Cocoa 中代表什么？**

我应该使用它吗？或者这是一个误报。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T21:57:58.553

[AnalysisTool](http://www.karppinen.fi/analysistool/)是一个前端 GUI，但也使用了一些不属于 Clang 的自定义规则。据我所知，Clang 不会强制/建议任何实例变量的命名约定，因此您所看到的可能是您可以放心忽略的内部编码风格（由 AT 开发人员使用）。有关更多详细信息，请参阅[此 SO 答案](https://stackoverflow.com/questions/577702/debugging-with-clang/578138#578138)。

[Clang 静态分析器](http://clang-analyzer.llvm.org/)本身现在可以作为 Leopard的二进制下载，而以前您必须自己构建它，这既复杂又耗时。它在没有 GUI 的情况下相当容易使用，并且报告总体上非常好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T22:23:00.827

开发人员将其对象名称的实例变量以`m_`（“member”的缩写）开头是很常见的，您看到的规则表明您的代码不符合该约定。如果您不想在代码中遵循此约定，只需在分析器中关闭该规则即可。

# reporting-services - 如何在 SSRS 中跳转到 URL？

> ID：1009548
> 
> 赞同：0
> 
> 时间：2009-06-17T21:12:53.480
> 
> 标签：reporting-services

我有两个报告，在报告服务器中的同一个文件夹中。我想来回链接两个报告传递参数。

我尝试使用跳转到报告传递参数，它可以工作但在同一窗口中打开报告。我正在寻找在新窗口中打开报告，因此尝试使用此表达式使用跳转到 URL。

> ="javascript:void(window.open(' [http://servername/reportserver?%2fStaffing%2fTest%2fStaffing](http://servername/reportserver?%2fStaffing%2fTest%2fStaffing) 预测摘要&rs:Command=Render&PI_REGION_LIST="+Parameters!PI_REGION_LIST.Value+"&PI_CENTER_CODE="+Parameters!PI_CENTER_CODE.Value+" &PI_PROBABILITY="+Parameters!PI_PROBABILITY.Value+"&PI_X="+Parameters!PI_X.Value+"'))"

任何人都可以在这里帮助我。我将如何动态地执行此操作，以便在生产移动时不必更改服务器名称？前3个参数是多值参数，这样给好吗？我的报告是从报告管理器本身访问的。我应该为报告服务器提供什么？

我对 `?`, `&`和 `/`在这整个 epxression 中感到困惑。那是什么`%2f`。我对此进行了一些谷歌搜索，但没有什么能给我一个正确的想法。

您的帮助将不胜感激。

谢谢，桑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-20T16:56:38.603

我只是使用“跳转到 URL”并转储了 javascript 的东西。我使用表达式构建器基于我的服务器和我正在调用的需要参数 prmCUID 和 prmEnabled 的报告构建以下输出：

```
="http://sk24-cbnks002/reportserver?/Autosweep/Operations/Sweeps+By+Credit+Union&prmCUID=" + Fields!CU_ID.Value.ToString + "&prmEnabled=true&rs%3aParameterLanguage=en-CA" 
```

我希望这有帮助。一开始我很难让它去。

-戴夫

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-05T19:10:28.263

要使用跳转到 URL（不带 javascript），您需要指定以下内容：

```
=Globals!ReportServerUrl & "/Pages/ReportViewer.aspx?"
& "/Staffing/Test/Staffing Forecast Summary"
& "&rs:Command=Render"
& "&PI_REGION_LIST=" & JOIN(Parameters!PI_REGION_LIST.Value, ",")
& "&PI_CENTER_CODE=" & JOIN(Parameters!PI_CENTER_CODE.Value, ",")
& "&PI_PROBABILITY=" & JOIN(Parameters!PI_PROBABILITY.Value, ",")
& "&PI_X=" & Parameters!PI_X.Value 
```

*我把东西放在多行上，并把它隔开，这样更容易阅读。*

第一行指定了运行原始报表的报表服务器 URL，因此无需对生产服务器 URL 进行硬编码。

第二行指定要在报表服务器上运行的目录和报表

第三行告诉报告服务器如何处理报告：您可以使用以下命令导出为 CSV

```
& "&rs:Format=csv&rc:NoHeader=True&rc:Encoding=Ascii&rs:Command=Render" 
```

最后几行指定要使用的参数。（由于前三个参数是多值的，我们将它们全部连接在一起，但用逗号分隔它们）。

在更改为使用 javascript 功能（来自报表设计器中的表达式编辑器的 VBScript）时，我们将 & 更改为 + 以执行连接。并解释“？”、“&”、“/”、“=”和“”由于 URL 编码（您可以找到更多[在这里](http://www.w3schools.com/tags/ref_urlencode.asp)）。

不幸的是，我的 Javascript 还不够好，无法确定从 VBScript 到 Javascript 的变化，但我的猜测是它会像这样：

```
Globals!ReportServerUrl & "/Pages/ReportViewer.aspx?/Staffing/Test/Staffing Forecast Summary&rs:Command=Render&PI_REGION_LIST=" & JOIN(Parameters!PI_REGION_LIST.Value,",") & "&PI_CENTER_CODE=" & JOIN(Parameters!PI_CENTER_CODE.Value,",") & "&PI_PROBABILITY=" & JOIN(Parameters!PI_PROBABILITY.Value,",") & "&PI_X=" & Parameters!PI_X.Value 
```

对此：

```
="javascript:void(window.open('" & Globals!ReportServerUrl & "%2fPages%2fReportViewer.aspx%3f%2fStaffing%2fTest%2fStaffing%20Forecast%20Summary%26rs:Command%3dRender%26PI_REGION_LIST%3d" & JOIN(Parameters!PI_REGION_LIST.Value,",") & "%26PI_CENTER_CODE%3d" & JOIN(Parameters!PI_CENTER_CODE.Value,",") & "%26PI_PROBABILITY%3d" & JOIN(Parameters!PI_PROBABILITY.Value,",") & "%26PI_X%3d"+Parameters!PI_X.Value & "'))" 
```

我不能确定这个最终结果在 Javascript 中的有效性，但在表达式编辑器中似乎没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-05T11:47:38.223

SSRS MS SQL Server 2008 R2

在 TEXTBOX 内转到文本框属性（F4 或右键单击-> 属性）转到操作集转到 URL 在表达式中设置以下代码（右侧的小 Fx）：

```
="http://MYSERVER/ReportServer?/MY REPORT FOLDER/MY REPORT NAME&rc:Parameters=True&rs:Command=Render&TODAY="& CStr(Fields!DT_0.Value)& "&ENG=" &Str(Fields!Employee_id.Value) & "&DT_TO=" & CStr(Fields!DT_6.Value) 
```

上面的代码在我的环境中工作。

请注意 3 个参数：

参数 1 称为 TODAY 参数 2 称为 ENG 参数 3 称为 DT_TO

我也在努力传递参数。

它们的值来自不同的数据集。

希望这有助于节省很多时间。因为对我来说很难让它发挥作用

马塞洛·米奥雷利

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-24T14:37:26.290

对上述答案的修改对我有用 -**请注意**多值参数中的分隔符值。我正在使用RS2008，发现**所有**参数都需要在表达式生成器中位于**同一**行

```
=Globals!ReportServerUrl & "/Pages/ReportViewer.aspx?"

& "/Staffing/Test/Staffing Forecast Summary"

& "&rs:Command=Render"

& "&PI_REGION_LIST=" & JOIN(Parameters!PI_REGION_LIST.Value, "&PI_REGION_LIST=")

& "&PI_CENTER_CODE=" & JOIN(Parameters!PI_CENTER_CODE.Value, "&PI_CENTER_CODE=")

& "&PI_PROBABILITY=" & JOIN(Parameters!PI_PROBABILITY.Value, "&PI_PROBABILITY=")
& "&PI_X=" & Parameters!PI_X.Value 
```

# asp.net - 将母版页导入 ASP.NET 中的另一个母版页

> ID：1009551
> 
> 赞同：1
> 
> 时间：2009-06-17T21:13:41.310
> 
> 标签：asp.net, master-pages

是否可以让一个母版页简单地包含另一个母版页？

我有三个母版页，内容已经收敛，我想让其中两个指向第三个，这样就不会复制内容，而是将它们留在里面，以便将来需要时可以轻松更改.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T21:20:44.293

是的，您需要的是**嵌套母版页**。只需将子母版页`MasterPageFile`的指令中的设置为父页即可。`<%@ Master %>`

Main.Master：

```
<%@ Master Language="C#" %>

.... shared content ....
<asp:ContentPlaceHolder ID="C" runat="server" /> 
```

一、大师：

```
<% Master Language="C#" MasterPageFile="Main.Master" %>

<asp:Content runat="server" ContentPlaceHolderID="C">
   .... Some content ....
   <asp:ContentPlaceHolder ID="AnotherPlaceholder" runat="server" />
</asp:Content> 
```

二、大师：

```
<% Master Language="C#" MasterPageFile="Main.Master" %>

<asp:Content runat="server" ContentPlaceHolderID="C">
   .... Some other content ....
   <asp:ContentPlaceHolder ID="AnotherPlaceholder" runat="server" />
</asp:Content> 
```

# c - 如何找到所有子进程？

> ID：1009552
> 
> 赞同：21
> 
> 时间：2009-06-17T21:13:58.113
> 
> 标签：c, linux, process

在我正在处理的基于 Linux 的项目中，我需要能够找到我的所有子进程。每次启动都记录下来是不可行的——需要事后才能找到。这需要是纯 C 语言，我想在不阅读的情况下做到这一点`/proc`。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T21:41:52.970

每次启动子进程时记录子进程通常是完全可行的。方便的是，父进程将子进程的 pid 值作为创建它的 fork 调用的返回值传递。

正如手册页所说：

```
pid_t fork(void); 
```

如果您能告诉我们您认为它不可行的原因，将会有所帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T21:27:16.290

你可以使用 popen

就像是。（希望语法足够接近）

```
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>

int main(int argc, char *argv[])
{
    FILE *fp = popen("ps -C *您的程序名称在这里* --format '%P %p'" , "r");
    如果（fp == NULL）
    {
        printf("错误！\n");
    }

    字符父ID[256]；
    字符进程ID[256]；
    while (fscanf(fp, "%s %s", parentID, processID) != EOF)
    {
         printf("PID: %s Parent: %s\n", processID, parentID);

         // 检查 parentID 以查看它是否属于您的进程
    }

    关闭（fp）；

    返回 1；
}

```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-18T11:07:03.600

我发现您的评论认为记录进程的创建是不可行的，但如果您真的不能（可能是因为您不知道将创建多少并且不想保留`realloc`记忆） )，然后我可能会打开与 glob 匹配的所有文件`/proc/[1-9]*/status`并查找说明我的进程 ID`PPid: <num>`在哪里的行。`<num>`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-08-27T22:17:46.880

你可以试试这个

```
#include<string.h>
#include <sys/types.h>
#include <unistd.h>

char str[50] = "ps -o pid --ppid ";
char ppid [7];
sprintf(ppid,"%d",getpid());
strcat(str,ppid);
system(str); 
```

注意：这段代码需要在父进程中

基本上`ps -o pid --ppid <parent_id>`给出其父进程具有 PID 的所有子进程的 pid `<parent_id>`。现在，我们可以通过 using 获取父进程的 PID `getpid()`，它返回`pid_t`并隐式转换为整数。`sprintf()`将其转换为字符串，我们将结果与 连接`str`以获得完整的命令，该命令由`system()`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T21:22:50.530

您可以解析包含父进程 ID 的进程列表（ps -ax？）。这可以通过一个简单的 shell 脚本来完成。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-06-01T17:01:06.280

如果您试图让所有子进程用于等待它们退出的特定目的，则可以使用 waitpid(-1, ...)：

```
while (true) {
  // Wait for any child exiting
  int child_status;
  const int child_pid = waitpid(-1, &child_status, 0);
  // check child_status
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T22:42:08.123

如果您想跟踪 fork 事件并提取子 pid 以进行调试，有多种方法可以做到这一点，包括：

*   使用 GDB
*   使用 strace
*   使用 systemtap
*   使用内核事件连接器（不确定这些到底是什么）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-06-02T19:47:41.663

需要调整此存储库中的代码以用纯 C 编写以满足您的要求，如果您可以这样做，如果您从项目中的存储库中删除所有未使用的功能，那么应该不难翻译成普通的C。

但这对于希望支持多个平台和/或喜欢 C++ 的人更有用。

请参阅函数 pids_from_ppid(ppid) [https://github.com/time-killer-games/enigma-dev/blob/548dc16e96a2a32f8ad9045a4ee18b0206516e62/ENIGMAsystem/SHELL/Universal_System/Extensions/ProcInfo/procinfo.h#L101](https://github.com/time-killer-games/enigma-dev/blob/548dc16e96a2a32f8ad9045a4ee18b0206516e62/ENIGMAsystem/SHELL/Universal_System/Extensions/ProcInfo/procinfo.h#L101)

返回一个字符串，其中每个子进程 ID 由管道“|”分隔 字符作为分隔符。

Ubuntu 和 debian 用户需要为缺少标头安装 libprocps-dev。

sudo apt-get install libprocps-dev libx11-dev

libx11-dev 依赖项是可选的，因为可以省略源代码中的所有 X11 代码，并且此处的问题仍将得到解答，因此如果您需要 Wayland 并且没有 X11 支持，您应该删除 X11 相关代码，因为它与此问题无关。

对于那些真正喜欢/需要 X11 和/或 C++ 的人来说，这将在 Windows、Mac、Linux 和 FreeBSD 上开箱即用。由于依赖于 libutil 依赖项，对其他 BSD 的支持并不那么容易实现。但它只是在内部使用 sysctl() ，所以理论上你应该能够在 FreeBSD 的 github 存储库中提供的其他 BSD 上编译 libutil 的源代码，然后在构建它之后链接到它。

# java - Eclipse Stacktrace System.err 问题

> ID：1009567
> 
> 赞同：0
> 
> 时间：2009-06-17T21:18:03.347
> 
> 标签：java, eclipse, error-handling, printstacktrace

突然之间，我的 printStackTrace 停止打印任何东西。当我给它一个不同的输出流来打印它时（如 e.printStackTrace(System.out)），但显然我想弄清楚它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T21:31:55.550

检查您正在使用的某个库是否没有使用 System.setErr(PrintStream) 方法重定向标准错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T22:02:35.207

这可能不是问题，但 Eclipse 中的控制台视图有一些切换按钮，用于在 stdout 或 stderr 的输出更改时显示/隐藏控制台。

您是否可能不小心单击了 stderr 按钮？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T21:23:25.737

在您的启动配置文件中，在公共选项卡上，检查以确保在“标准输入和输出”部分中选中“分配控制台”。

# wpf - 将 ContextMenu 的来源传递给 WPF 命令

> ID：1009571
> 
> 赞同：6
> 
> 时间：2009-06-17T21:19:56.680
> 
> 标签：wpf, xaml, mvvm

与从上下文菜单项触发命令有关的有趣问题...

我想触发一个命令以在我的控件 InsertRowCmd 中插入一行。该命令需要知道在哪里插入行。

我可以使用 Mouse.GetPosition()，但这会让我获得当前鼠标的位置，这将在菜单项上方。我想获取上下文菜单的来源。

有人对如何将上下文菜单的来源作为参数传递给命令有任何建议吗？

示例代码：

```
<UserControl x:Name="MyControl">
<!--...-->
        <ContextMenu x:Name="menu">
            <MenuItem Header="Insert Row" Command="{x:Static customCommands:MyCommands.InsertRowCmd}" CommandParameter="?"/>
        </ContextMenu>
</UserControl> 
```

我目前的想法如下：

- 改用点击处理程序，以便我可以在代码中找到原点。问题是我将不得不处理启用/禁用。

- 处理点击事件并保存上下文菜单的来源。将此保存的信息传递到命令中。我已经验证在命令执行之前点击事件会触发。

有任何想法吗？

**编辑：**

我正在使用 Josh Smith 的[CommandSinkBinding](http://www.codeproject.com/KB/WPF/VMCommanding.aspx?fid=1521948&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2696866)将命令处理路由到我的 ViewModel 类中。所以处理命令执行的代码对视图一无所知。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T21:46:53.647

您需要使用[`TranslatePoint`](http://msdn.microsoft.com/en-us/library/system.windows.uielement.translatepoint.aspx)将左上角 (0, 0)`ContextMenu`转换为包含网格中的坐标。您可以通过将 绑定`CommandParameter`到`ContextMenu`并使用转换器来做到这一点：

```
CommandParameter="{Binding IsOpen, ElementName=_menu, Converter={StaticResource PointConverter}}" 
```

另一种方法是附加行为，它会在打开`Point`时自动更新类型的附加只读属性。`ContextMenu`用法看起来像这样：

```
<ContextMenu x:Name="_menu" local:TrackBehavior.TrackOpenLocation="True">
    <MenuItem Command="..." CommandParameter="{Binding Path=(local:TrackBehavior.OpenLocation), ElementName=_menu}"/>
</ContextMenu> 
```

因此，`TrackOpenLocation`附加属性执行附加到 的工作，`ContextMenu`并在打开时更新第二个附加属性 ( `OpenLocation`) `ContextMenu`。然后`MenuItem`可以绑定到最后一次打开`OpenLocation`的位置。`ContextMenu`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-12-23T11:01:33.760

继肯特的回答之后，我使用了他的附加属性建议并最终得到了这个（使用 Josh Smith 的[附加行为示例](http://joshsmithonwpf.wordpress.com/2008/08/30/introduction-to-attached-behaviors/)）：

```
public static class TrackBehavior
{
 public static readonly DependencyProperty TrackOpenLocationProperty = DependencyProperty.RegisterAttached("TrackOpenLocation", typeof(bool), typeof(TrackBehavior), new UIPropertyMetadata(false, OnTrackOpenLocationChanged));

 public static bool GetTrackOpenLocation(ContextMenu item)
 {
  return (bool)item.GetValue(TrackOpenLocationProperty);
 }

 public static void SetTrackOpenLocation(ContextMenu item, bool value)
 {
  item.SetValue(TrackOpenLocationProperty, value);
 }

 public static readonly DependencyProperty OpenLocationProperty = DependencyProperty.RegisterAttached("OpenLocation", typeof(Point), typeof(TrackBehavior), new UIPropertyMetadata(new Point()));

 public static Point GetOpenLocation(ContextMenu item)
 {
  return (Point)item.GetValue(OpenLocationProperty);
 }

 public static void SetOpenLocation(ContextMenu item, Point value)
 {
  item.SetValue(OpenLocationProperty, value);
 }

 static void OnTrackOpenLocationChanged(DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e)
 {
  var menu = dependencyObject as ContextMenu;
  if (menu == null)
  {
   return;
  }

  if (!(e.NewValue is bool))
  {
   return;
  }

  if ((bool)e.NewValue)
  {
   menu.Opened += menu_Opened;

  }
  else
  {
   menu.Opened -= menu_Opened;
  }
 }

 static void menu_Opened(object sender, RoutedEventArgs e)
 {
  if (!ReferenceEquals(sender, e.OriginalSource))
  {
   return;
  }

  var menu = e.OriginalSource as ContextMenu;
  if (menu != null)
  {
   SetOpenLocation(menu, Mouse.GetPosition(menu.PlacementTarget));
  }
 }
} 
```

然后在 Xaml 中使用，您只需要：

```
<ContextMenu x:Name="menu" Common:TrackBehavior.TrackOpenLocation="True">
 <MenuItem Command="{Binding SomeCommand}" CommandParameter="{Binding Path=(Common:TrackBehavior.OpenLocation), ElementName=menu}" Header="Menu Text"/>
</ContextMenu> 
```

但是，我还需要添加：

```
NameScope.SetNameScope(menu, NameScope.GetNameScope(this)); 
```

到我的视图的构造函数，否则`CommandParameter`无法查找的绑定`ElementName=menu`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T22:07:53.853

除了肯特的回答，想想“标准方式”。Fe当一个ListBox有一个ContextMenu时，你不需要菜单的位置，因为被选中的项目是在菜单弹出之前设置的。因此，如果您的控件在右键单击时会“选中”某些内容...

# linux - 选择 Linux I/O 调度程序

> ID：1009577
> 
> 赞同：84
> 
> 时间：2009-06-17T21:22:11.637
> 
> 标签：linux, linux-kernel, scheduling

我读到可以通过写入 /sys/block/[disk]/queue/scheduler 来更改正在运行的内核上特定设备的 I/O 调度程序。例如，我可以在我的系统上看到：

```
anon@anon:~$ cat /sys/block/sda/queue/scheduler 
noop anticipatory deadline [cfq] 
```

默认是完全公平的排队调度程序。我想知道在我的自定义内核中包含所有四个调度程序是否有任何用处。除非内核足够聪明，可以为正确的硬件选择正确的调度程序，特别是用于基于闪存的驱动器的“noop”调度程序以及用于传统驱动器的其他调度程序，否则编译多个调度程序似乎没有多大意义硬盘。

是这样吗？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-06-18T02:59:19.227

如 中[`/usr/src/linux/Documentation/block/switching-sched.txt`](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/block/switching-sched.rst)所述，任何特定块设备上的 I/O 调度程序都可以在运行时更改。可能会有一些延迟，因为在使用新的调度器之前，之前的调度器的请求都被刷新了，但是即使设备被大量使用，也可以毫无问题地更改它。

```
# cat /sys/block/hda/queue/scheduler
noop deadline [cfq]
# echo anticipatory > /sys/block/hda/queue/scheduler
# cat /sys/block/hda/queue/scheduler
noop [deadline] cfq 
```

理想情况下，将有一个调度程序来满足所有需求。它似乎还不存在。内核通常没有足够的知识来为您的工作负载选择最佳调度程序：

*   `noop`通常是内存支持的块设备（例如 ramdisk）和其他非旋转介质（闪存）的最佳选择，因为尝试重新调度 I/O 会浪费资源
*   `deadline`是一个轻量级调度器，它试图对延迟施加硬性限制
*   `cfq`试图维护系统范围内 I/O 带宽的公平性

默认值很`anticipatory`长一段时间，它接受了很多调整，但在**2.6.33**（2010 年初）中被删除。 `cfq`不久前成为默认值，因为它的性能合理且公平是多用户系统（甚至单用户桌面）的一个很好的目标。对于某些场景——数据库经常被用作示例，因为它们往往已经有自己独特的调度和访问模式，并且通常是*最*重要的服务（那么谁在乎公平呢？）——`anticipatory`具有可调节性的悠久历史为了在这些工作负载上获得最佳性能，并`deadline`非常快速地将所有请求传递到底层设备。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2016-02-03T10:20:50.040

可以使用 udev 规则让系统根据硬件的某些特性来决定调度程序。
SSD 和其他非旋转驱动器的示例 udev 规则可能如下所示

```
# set noop scheduler for non-rotating disks
ACTION=="add|change", KERNEL=="sd[a-z]", ATTR{queue/rotational}=="0", ATTR{queue/scheduler}="noop" 
```

在新的 udev 规则文件中（例如，`/etc/udev/rules.d/60-ssd-scheduler.rules`）。这个答案基于[debian wiki](https://wiki.debian.org/SSDOptimization#Low-Latency_IO-Scheduler)

要检查 ssd 磁盘是否会使用该规则，可以提前检查 trigger 属性：

```
for f in /sys/block/sd?/queue/rotational; do printf "$f "; cat $f; done 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-17T21:24:42.007

让内核支持不同的内核的目的是您可以在不重新启动的情况下试用它们；然后，您可以通过系统运行测试工作负载，测量性能，然后将其作为您的应用程序的标准工作负载。

在现代服务器级硬件上，只有 noop 似乎完全有用。在我的测试中，其他人似乎更慢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-11T21:27:38.440

您可以在启动时通过将“elevator”参数添加到内核 cmdline（例如在 grub.cfg 中）来设置它

例子：

```
elevator=deadline 
```

这将使“deadline”成为所有块设备的默认 I/O 调度程序。

如果您想在系统启动后查询或更改调度程序，或者想为特定的块设备使用不同的调度程序，我建议安装并使用工具**ioschedset**来简化此操作。

[https://github.com/kata198/ioschedset](https://github.com/kata198/ioschedset)

如果你在 Archlinux 上，它在 aur 中可用：

[https://aur.archlinux.org/packages/ioschedset](https://aur.archlinux.org/packages/ioschedset)

**一些示例用法：**

```
# Get i/o scheduler for all block devices
[username@hostname ~]$ io-get-sched
sda:    bfq
sr0:    bfq

# Query available I/O schedulers
[username@hostname ~]$ io-set-sched --list
mq-deadline kyber bfq none

# Set sda to use "kyber"
[username@hostname ~]$ io-set-sched kyber /dev/sda
Must be root to set IO Scheduler. Rerunning under sudo...

[sudo] password for username:
+ Successfully set sda to 'kyber'!

# Get i/o scheduler for all block devices to assert change
[username@hostname ~]$ io-get-sched
sda:    kyber
sr0:    bfq

# Set all block devices to use 'deadline' i/o scheduler
[username@hostname ~]$ io-set-sched deadline
Must be root to set IO Scheduler. Rerunning under sudo...

+ Successfully set sda to 'deadline'!
+ Successfully set sr0 to 'deadline'!

# Get the current block scheduler just for sda
[username@hostname ~]$ io-get-sched sda
sda:    mq-deadline 
```

用法应该是不言自明的。这些工具是独立的，只需要 bash。

希望这可以帮助！

编辑：免责声明，这些是我写的脚本。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-11-13T21:44:17.430

Linux 内核不会在运行时自动更改 IO 调度程序。我的意思是，截至今天，Linux 内核无法根据辅助存储设备的类型自动选择“最佳”调度程序。在启动期间或运行期间，可以**手动**更改 IO 调度程序。

默认调度程序是在启动时根据位于 /linux-2.6 **/block/Kconfig.iosched**的文件中的内容选择的。`echo`但是，可以通过在位于 /sys/block/[DEV]/queue/scheduler 的文件中输入有效的调度程序名称来在运行时更改 IO 调度程序。例如，`echo deadline > /sys/block/hda/queue/scheduler`

# c# - 在 Windows 7 上使用 .NET 进行开发之前，我应该考虑什么？

> ID：1009583
> 
> 赞同：0
> 
> 时间：2009-06-17T21:23:37.563
> 
> 标签：c#, visual-studio, windows-7

有人使用 Windows 7 预览版进行 .NET 开发吗？

SQL Server Express 2005/2008、VS.NET 2005/2008 之类的东西可以正常工作吗？
IIS怎么样？

还有什么我应该考虑的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T21:25:53.953

自测试版以来，我一直使用 Windows 7 作为我的主要操作系统。它适用于 Visual Studio 2008 SP1、IIS 7.5、SQL Server 2008 SP1。到目前为止，我还没有遇到任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T21:55:10.370

自测试版以来，我一直在大量使用 Win 7 64bit 进行开发。

VS 2008 + SP1、SQL Server Express 2008、TSVN 64Bit 以及一些用于 Office 2007 插件、Azure 和 Silverlight 的开发工具

在测试版下有一些问题，但在升级到 Windows 7 RC 后它们就消失了。像一个快照一样工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T21:27:38.833

我从 beta 版本（7000）开始使用它，现在是 RC 版本（7100）。没有问题，也许有一些小故障，但我不记得有什么特别的，所以没有什么会造成真正的问题。哦，忘了提 - 我在我相当旧的笔记本电脑和最近制造的台式机上同时使用 32 位和 64 位。两者都工作正常。

VS2008 工作正常，我认为 2005 必须以管理员身份运行调试器才能工作，或者它是一些小故障，但不再是 100% 肯定它是什么..

SQL2005/2008 Express 工作正常。

没试过IIS，VS内置的web服务器工作正常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T21:29:20.780

我也一直在使用带有 Visual Studio 2008、MySql、IIS 7.5（和大量插件）、Eclipse 3.4 和 VMWare 的 Windows 7（Beta，RC1）来运行 Linux——一切都运行得非常顺利。

这是一个梦想成真。真的。

# postgresql - 如何用postgresql模拟“插入忽略”和“重复键更新”（sql合并）？

> ID：1009584
> 
> 赞同：179
> 
> 时间：2009-06-17T21:23:47.843
> 
> 标签：postgresql

一些 SQL 服务器有一个功能，`INSERT`如果它违反主键/唯一键约束，则会被跳过。例如，MySQL 有`INSERT IGNORE`.

`INSERT IGNORE`模拟和`ON DUPLICATE KEY UPDATE`使用 PostgreSQL的最佳方法是什么？

* * *

## 回答 #1

> 赞同：225
> 
> 时间：2016-01-06T17:58:34.800

使用 PostgreSQL 9.5，这现在是[本机功能](https://wiki.postgresql.org/wiki/What%27s_new_in_PostgreSQL_9.5#INSERT_..._ON_CONFLICT_DO_NOTHING.2FUPDATE_.28.22UPSERT.22.29)（就像[MySQL 已经](https://stackoverflow.com/q/1361340/4418)使用了几年一样）：

> **插入 ... 在冲突中什么都不做/更新（“UPSERT”）**
> 
> 9.5 支持“UPSERT”操作。INSERT 扩展为接受 ON CONFLICT DO UPDATE/IGNORE 子句。本条款规定了在可能重复违规的情况下要采取的替代措施。

...

> 新语法的进一步示例：

```
INSERT INTO user_logins (username, logins)
VALUES ('Naomi',1),('James',1) 
ON CONFLICT (username)
DO UPDATE SET logins = user_logins.logins + EXCLUDED.logins; 
```

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2011-05-30T12:03:54.190

编辑：如果你错过了[沃伦的回答](https://stackoverflow.com/a/34639631/6691)，PG9.5 现在有这个本机；是时候升级了！

* * *

基于 Bill Karwin 的回答，阐明基于规则的方法的外观（从同一数据库中的另一个模式传输，并使用多列主键）：

```
CREATE RULE "my_table_on_duplicate_ignore" AS ON INSERT TO "my_table"
  WHERE EXISTS(SELECT 1 FROM my_table 
                WHERE (pk_col_1, pk_col_2)=(NEW.pk_col_1, NEW.pk_col_2))
  DO INSTEAD NOTHING;
INSERT INTO my_table SELECT * FROM another_schema.my_table WHERE some_cond;
DROP RULE "my_table_on_duplicate_ignore" ON "my_table"; 
```

注意：该规则适用于所有`INSERT`操作，直到该规则被删除，所以不是临时的。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2016-10-28T22:07:09.597

对于那些拥有 Postgres 9.5 或更高版本的人，新的**ON CONFLICT DO NOTHING**语法应该可以工作：

```
INSERT INTO target_table (field_one, field_two, field_three ) 
SELECT field_one, field_two, field_three
FROM source_table
ON CONFLICT (field_one) DO NOTHING; 
```

对于我们这些拥有早期版本的人来说，这个正确的连接将起作用：

```
INSERT INTO target_table (field_one, field_two, field_three )
SELECT source_table.field_one, source_table.field_two, source_table.field_three
FROM source_table 
LEFT JOIN target_table ON source_table.field_one = target_table.field_one
WHERE target_table.field_one IS NULL; 
```

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2009-06-18T07:00:44.620

尝试进行更新。如果它没有修改任何表示它不存在的行，那么插入。显然，您在事务中执行此操作。

如果您不想将额外的代码放在客户端，您当然可以将其包装在一个函数中。你还需要一个循环来处理这种想法中非常罕见的竞争条件。

文档中有一个示例：[http](http://www.postgresql.org/docs/9.3/static/plpgsql-control-structures.html) ://www.postgresql.org/docs/9.3/static/plpgsql-control-structures.html ，示例 40-2 位于底部。

这通常是最简单的方法。你可以用规则做一些魔术，但它可能会变得更加混乱。我会建议任何一天都使用 wrap-in-function 方法。

这适用于单行或几行值。如果您正在处理大量行，例如来自子查询，您最好将其拆分为两个查询，一个用于 INSERT，一个用于 UPDATE（当然，作为适当的连接/子选择 - 无需编写主过滤两次）

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2012-02-22T02:18:23.743

要获得**插入忽略**逻辑，您可以执行以下操作。我发现简单地从文本值的选择语句中插入效果最好，然后您可以使用 NOT EXISTS 子句屏蔽重复的键。为了获得重复逻辑的更新，我怀疑 pl/pgsql 循环是必要的。

```
INSERT INTO manager.vin_manufacturer
(SELECT * FROM( VALUES
  ('935',' Citroën Brazil','Citroën'),
  ('ABC', 'Toyota', 'Toyota'),
  ('ZOM',' OM','OM')
  ) as tmp (vin_manufacturer_id, manufacturer_desc, make_desc)
  WHERE NOT EXISTS (
    --ignore anything that has already been inserted
    SELECT 1 FROM manager.vin_manufacturer m where m.vin_manufacturer_id = tmp.vin_manufacturer_id)
) 
```

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2013-05-07T20:44:29.447

```
INSERT INTO mytable(col1,col2) 
    SELECT 'val1','val2' 
    WHERE NOT EXISTS (SELECT 1 FROM mytable WHERE col1='val1') 
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2018-01-07T00:49:57.847

正如@hanmari 在他的评论中提到的那样。插入 postgres 表时，冲突 (..) 什么都不做是用于不插入重复数据的最佳代码。：

```
query = "INSERT INTO db_table_name(column_name)
         VALUES(%s) ON CONFLICT (column_name) DO NOTHING;" 
```

ON CONFLICT 代码行将允许插入语句仍然插入数据行。查询和值代码是将 Excel 中的日期插入 postgres 数据库表的示例。我在 postgres 表中添加了约束，以确保 ID 字段是唯一的。我没有对相同的数据行运行删除，而是添加了一行 sql 代码，从 1 开始重新编号 ID 列。示例：

```
q = 'ALTER id_column serial RESTART WITH 1' 
```

如果我的数据有一个 ID 字段，我不会将其用作主 ID/序列 ID，我会创建一个 ID 列并将其设置为序列。我希望这些信息对每个人都有帮助。*我没有软件开发/编码方面的大学学位。我在编码方面所知道的一切，都是我自己学习的。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2009-06-17T21:36:53.993

看起来 PostgreSQL 支持一个名为*rule*的模式对象。

[http://www.postgresql.org/docs/current/static/rules-update.html](http://www.postgresql.org/docs/current/static/rules-update.html)

您可以为给定的表创建一个规则`ON INSERT`，使其在`NOTHING`具有给定主键值的行存在时执行，或者使其执行`UPDATE`而不是在`INSERT`具有给定主键值的行存在时执行。

我自己没有尝试过，所以我不能从经验中说出来，也不能举个例子。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2014-06-16T15:46:21.340

此解决方案避免使用规则：

```
BEGIN
   INSERT INTO tableA (unique_column,c2,c3) VALUES (1,2,3);
EXCEPTION 
   WHEN unique_violation THEN
     UPDATE tableA SET c2 = 2, c3 = 3 WHERE unique_column = 1;
END; 
```

但它有一个性能缺陷（参见[PostgreSQL.org](http://www.postgresql.org/docs/9.1/static/plpgsql-control-structures.html)）：

> 包含 EXCEPTION 子句的块的进入和退出比没有的块要昂贵得多。因此，不要在没有必要的情况下使用 EXCEPTION。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-01-12T06:06:22.580

在批量上，您始终可以删除插入之前的行。删除不存在的行不会导致错误，因此可以安全地跳过。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2013-08-09T12:14:12.250

对于数据导入脚本，要替换“如果不存在”，在某种程度上，有一个稍微尴尬的公式，但仍然有效：

```
DO
$do$
BEGIN
PERFORM id
FROM whatever_table;

IF NOT FOUND THEN
-- INSERT stuff
END IF;
END
$do$; 
```

# iphone - textViewDidBeginEditing 由于缩放而未触发

> ID：1009593
> 
> 赞同：0
> 
> 时间：2009-06-17T21:26:49.693
> 
> 标签：iphone, objective-c, uitextview

我有一个 UIViewController 子类，它充当 UITextView 的委托。我实现了 textViewDidBeginEditing 以显示一个“完成”按钮来关闭文本视图......一切都很好......除了当文本视图有文本并且不处于编辑模式时，如果用户在文本视图中握住手指导致要使用放大镜缩放的文本，出现键盘但 textViewDidBeginEditing 不触发。

我试图通过实现 UIScrollView 委托方法 viewForZoomingInScrollView 和 scrollViewDidEndZooming 来解决这个问题，但我根本无法让它们为我触发。

我尝试使用 minimumZoomScale 和 maximumZoomScale 属性来禁用缩放...无济于事。

在这一点上，我不知道接下来要尝试什么，或者我捕获 UIScrollView 委托方法的失败是否与我的主要问题有关。我不确定我可以发布哪些有价值的代码...... textViewDidBeginEditing 方法非常小，在正常情况下可以正常工作。UITextView 委托分配是通过在 Interface Builder 中与控制器（文件所有者）的连接进行的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T00:07:24.347

一种解决方法可能是注册键盘通知。一旦你这样做了，你就会知道键盘何时显示。

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardNotificationShow:) name:UIKeyboardWillShowNotification object:nil];  

[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardNotificationHide:) name:UIKeyboardWillHideNotification object:nil]; 
```

# asp.net - 为什么更新 Linq 对象时子属性会被覆盖？

> ID：1009594
> 
> 赞同：0
> 
> 时间：2009-06-17T21:26:50.833
> 
> 标签：asp.net, linq-to-sql, linqdatasource

我正在更新一个对象，并尝试更新任何子对象。

基本上我正在处理 LinqDataSource 的 OnUpdating 事件。

在 DataContext 类中，我有 ObjectUpdate 函数（现在我刚刚有一个断点，所以我可以看到值......）

在 LinqDataSource.OnUpdating 事件中，e.NewObject.Child 为空，这没有任何意义。我将它设置为一个新值，但是当我到达 DataContext.ObjectUpdate NewObject.Child 时，它已被旧值覆盖......

所以在 LinqDataSource.Updating 和 DataContext.UpdateObject 之间的某个地方，它用旧值填充对象......但我需要新值。

有没有办法解决这个问题，还是我会精神崩溃？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T23:07:47.727

我想我找到了问题所在。通过 .NET Reflector 运行 LinqDataSource 后，我注意到：

1) 实际上附加到数据上下文的是 LinkDataSourceUpdateEventArguments.OriginalObject 2) 在 OriginalObject 附加到数据上下文后，值从 NewObject 复制到 OriginalObject

我不明白为什么不复制关联属性。也许出于同样的原因你不能序列化它们？

解决方法是/是自己处理更新事件并执行实际提交，而不是让 LinqDataSource 处理该部分。

```
void FormDataSource_Updating(object sender, LinqDataSourceUpdateEventArgs e)
    {

        var newObj = e.NewObject;

        var table = FormContext.GetTable(e.NewObject.GetType());

        if (BuildingObject != null)
            BuildingObject(sender, new HeirarchicalBuildObjectEventArgs(newObj));

        table.Attach(newObj, e.OriginalObject);

        FormContext.SubmitChanges();

        e.Cancel = true;
    } 
```

# html - 相对于（也是绝对定位的）父 DIV 定位绝对定位的 DIV？

> ID：1009596
> 
> 赞同：1
> 
> 时间：2009-06-17T21:26:58.990
> 
> 标签：html, css

这是我在修复布局时经常遇到的一个问题。我有一个绝对定位的 DIV，我在其中放置了一个子 DIV，它也需要绝对定位。但我真的希望这个子 DIV 相对于父级表现......这甚至可能吗？还是我需要创建一个 wrap-DIV？

```
<div class="container" style="position:relative;">
    <div class="parent" style="position:absolute;">

        <!-- this child div will behave relative to .container -->
        <div class="child" style="position:absolute;"></div>
    </div>
</div> 
```

这是我宁愿避免的“包装”解决方案：

```
<div class="container" style="position:relative;">
    <div class="parent" style="position:absolute;">
        <div class="wrapper" style="position:relative;">

            <!-- this child div will behave relative to .wrapper-->
            <div class="child" style="position:absolute;"></div>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T21:40:40.697

如果您已经绝对定位了一个 div，您不能为孩子将两个偏移量相加吗？例如，相对于#one，#one 位于 10,10，#two 位于 10,10，

```
#one {
    position: absolute;
    left: 10px;
    top: 10px;
}

#two {
    position: absolute;
    left: 20px;
    top: 20px;
} 
```

或者它是更高级的东西，比如#one 锁定到左上角，#two 锁定到#one 的右下角，在这种情况下，基本数学不能这样工作？在这种情况下，可能需要一个额外的 div。

还是我只是累了，错过了什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T14:57:53.710

绝对定位元素相对于其最近的未定位祖先的边缘进行定位（即非定位：静态）。

由于父元素**是**position: absolute，因此子元素将相对于其边缘进行定位。

所以你似乎在问如何获得你已经拥有的行为。您的第一个示例中的评论似乎不正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T21:32:32.177

您可能想问自己是否真的需要使用多个嵌套的绝对定位元素。

否则，最好选择包装解决方案。

# asp.net - 按 Enter 更新 Gridview 行时出现问题

> ID：1009597
> 
> 赞同：1
> 
> 时间：2009-06-17T21:27:04.343
> 
> 标签：asp.net, gridview

我有一个使用 imagebutton 作为更新按钮的 gridview。当用户编辑一行时，我希望用户能够通过按 Enter 来更新该行。我遇到的问题是，尽管触发了 RowCommand 事件，但 CommandName 仍然是“编辑”而不是“更新，因此我的更新代码永远不会被执行。我所做的是将一些 javascript 连接到 RowDataBound 中的文本框处理程序：

```
 Protected Sub uxShoppingCart_RowDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs)
        If e.Row.RowType = DataControlRowType.DataRow Then
            Dim gvr As GridViewRow = DirectCast(e.Row, GridViewRow)
            If (e.Row.RowState And DataControlRowState.Edit) = DataControlRowState.Edit Then
                Dim edit_Qty As TextBox = DirectCast(gvr.FindControl("edit_Qty"), TextBox)
                Dim uxUpdateButton As ImageButton = DirectCast(gvr.FindControl("uxUpdateButton"), ImageButton)
                uxQty.Attributes.Add("onkeypress", "return clickButton(event,'" & uxUpdateButton.ClientID & "')")
                edit_Qty.Focus()
            End If
        End If
    End Sub 
```

javascript函数如下：

```
function clickButton(e, buttonid) {
    var bt = document.getElementById(buttonid);
    if (typeof bt == 'object') {
        if (navigator.appName.indexOf("Netscape") > (-1)) {
            if (e.keyCode == 13) {
                bt.click();
                return false;
            }
        }
        if (navigator.appName.indexOf("Microsoft Internet Explorer") > (-1)) {
            if (event.keyCode == 13) {
                bt.click();
                return false;
            }
        }
    }
} 
```

这是按钮声明

```
<EditItemTemplate>
    <span style="display: inline; white-space: nowrap;">
        <asp:ImageButton ID="uxUpdateButton" runat="server" CausesValidation="True" CommandName="Update" ImageUrl="~/images/icons/accept.png" AlternateText="Update" ToolTip="Update"></asp:ImageButton>
        <asp:ImageButton ID="uxCancelButton" runat="server" CausesValidation="False" CommandName="Cancel" ImageUrl="~/images/icons/cancel.png" AlternateText="Cancel" ToolTip="Cancel"></asp:ImageButton>
    </span>
</EditItemTemplate> 
```

如果我使用鼠标单击更新按钮，CommandName“更新”会按预期传递，而不是当我通过javascript“单击”它时。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-23T19:36:15.850

我终于能够以全新的眼光回到这一点。事实证明，问题是我在该字段中使用的 ajaxcontroltoolkit 中的 maskededitextender。我猜扩展器正在拦截 onkeypress 事件。

这是我的解决方案。我摆脱了 maskededitextender 并使用直接的 javascript 并将我的 javascript 函数分配给文本框的 onkeypress 事件：

```
AddQty.Attributes.Add("onkeypress", "return NumericInput(event,'" & uxAddButton.ClientID & "')") 
```

这是javascript：

```
<script type="text/javascript">
    function NumericInput(e, id) {
        if (!e) e = window.event;
        if (e.keyCode > 31 && (e.keyCode < 48 || e.keyCode > 57)) {
            return false;
        } else {
            if (e.keyCode == 13) {
                var bt = document.getElementById(id);
                if (bt != null) {
                    bt.click();
                    return false;
                }
            }
        }
    } 
 </script> 
```

# java - 如何通过 Java 编辑 jpg 图像？

> ID：1009607
> 
> 赞同：15
> 
> 时间：2009-06-17T21:29:38.737
> 
> 标签：java, image, netbeans

我已经加载了一个 jpg 图像，我想在其中绘制字母和圆圈，给定 ax,y 坐标。

我一直在试图找出[ImageIcon](http://java.sun.com/j2se/1.4.2/docs/api/javax/swing/ImageIcon.html)类的paintIcon

```
public void paintIcon(Component c,
                      Graphics g,
                      int x,
                      int y) 
```

这种方法是否允许我以我想要的方式编辑 jpg 图像？Component c 和 Graphics g 参数应该是什么？我会在它的身体上添加什么来画圆圈或字母？

我正在使用 Netbeans 6.5，我有什么内置的东西（而不是 ImageIcon）吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-17T21:43:46.307

纯 Java 方式是使用[`ImageIO`](http://java.sun.com/javase/6/docs/api/javax/imageio/ImageIO.html)将图像[加载](http://java.sun.com/javase/6/docs/api/javax/imageio/ImageIO.html#read(java.io.File))为[`BufferedImage`](http://java.sun.com/javase/6/docs/api/java/awt/image/BufferedImage.html). 然后可以调用[`createGraphics()`](http://java.sun.com/javase/6/docs/api/java/awt/image/BufferedImage.html#createGraphics())获取`Graphics2D`对象；然后你可以在图像上绘制任何你想要的东西。

您可以使用`ImageIcon`嵌入的 a来进行显示，如果您试图允许用户编辑图像`JLabel`，您可以添加 a`MouseListener`和/或 a 。`MouseMotionListener``JLabel`

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-18T01:26:20.567

在 Java 中操作图像可以通过使用[`Graphics`](http://java.sun.com/javase/6/docs/api/java/awt/Graphics.html)or[`Graphics2D`](http://java.sun.com/javase/6/docs/api/java/awt/Graphics2D.html)上下文来实现。

可以使用[`ImageIO`](http://java.sun.com/javase/6/docs/api/javax/imageio/ImageIO.html)该类来加载 JPEG 和 PNG 等图像。该`ImageIO.read`方法接受 a`File`来读入并返回 a [`BufferedImage`](http://java.sun.com/javase/6/docs/api/java/awt/image/BufferedImage.html)，它可用于通过其[`Graphics2D`](http://java.sun.com/javase/6/docs/api/java/awt/Graphics2D.html)（或[`Graphics`](http://java.sun.com/javase/6/docs/api/java/awt/Graphics.html)，其超类）上下文来操作图像。

上下文可`Graphics2D`用于执行许多图像绘制和操作任务。有关信息和示例，[Trail: 2D Graphics](http://java.sun.com/docs/books/tutorial/2d/index.html) of [The Java Tutorials](http://java.sun.com/docs/books/tutorial/index.html)将是一个很好的开始。

以下是一个简化的示例（未经测试），它将打开一个 JPEG 文件，并绘制一些圆圈和线条（忽略例外）：

```
// Open a JPEG file, load into a BufferedImage.
BufferedImage img = ImageIO.read(new File("image.jpg"));

// Obtain the Graphics2D context associated with the BufferedImage.
Graphics2D g = img.createGraphics();

// Draw on the BufferedImage via the graphics context.
int x = 10;
int y = 10;
int width = 10;
int height = 10;
g.drawOval(x, y, width, height);

g.drawLine(0, 0, 50, 50);

// Clean up -- dispose the graphics context that was created.
g.dispose(); 
```

上面的代码将打开一个 JPEG 图像，并绘制一个椭圆和一条线。一旦执行了这些操作来操作图像，`BufferedImage`就可以像处理任何其他操作一样处理`Image`，因为它是 的子类`Image`。

例如，通过[`ImageIcon`](http://java.sun.com/javase/6/docs/api/javax/swing/ImageIcon.html)使用创建一个`BufferedImage`，可以将图像嵌入到一个[`JButton`](http://java.sun.com/javase/6/docs/api/javax/swing/JButton.html)或[`JLabel`](http://java.sun.com/javase/6/docs/api/javax/swing/JLabel.html)：

```
JLabel l = new JLabel("Label with image", new ImageIcon(img));
JButton b = new JButton("Button with image", new ImageIcon(img)); 
```

`JLabel`和`JButton`都有接受 的构造函数，`ImageIcon`因此这是将图像添加到 Swing 组件的一种简单方法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-17T21:35:49.240

使用图书馆来做到这一点。您可能会尝试的一个是[JMagick](http://www.jmagick.org/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T21:42:48.880

我使用过 Java Advanced Imaging 库 ( [http://java.sun.com/products/java-media/jai/forDevelopers/jaifaq.html](http://www.oracle.com/technetwork/java/javase/tech/jai-142803.html) )，但您也可以查看 ImageJ ( [http://rsbweb.nih.gov /ij/index.html](http://rsbweb.nih.gov/ij/index.html) )

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T21:50:12.313

我想象你可以使用这种方法来覆盖每次在 UI 中绘制图像时所需的元素（这会发生很多次，因为你没有在图像数据上绘制它本身）但可能适合你的目的（并且有利如果覆盖随时间变化）。

就像是：

```
new ImageIcon("someUrl.png"){
    public void paintIcon(Component c, Graphics g, int x, int y) {
        super(c, g, x, y);
        g.translate(x, y);

        g.drawOval(0, 0, 10, 10);
        ...

        g.translate(-x, -y);
    }
}; 
```

话虽如此，如果您想修改图像数据，mmyers 的回答要好得多。

# winforms - Syncfusion WinForms功能区表单的中心标题栏标题？

> ID：1009609
> 
> 赞同：1
> 
> 时间：2009-06-17T21:30:15.553
> 
> 标签：winforms, titlebar

有没有办法让 WinForms 表单中的文本居中对齐？也称为标题栏标题或标题栏文字？到目前为止，我能看到的唯一方法是用空格填充字符串。我正在使用 Form.Text 属性设置标题栏标题。

我应该补充一点，我使用的是第 3 方功能区表单，因此该应用程序看起来像 Microsoft Office 2007 应用程序。这些应用程序将文本居中对齐，大概是因为当文本左对齐时，它会添加到左上角的混乱按钮中，看起来很糟糕。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T21:32:43.830

老实说 - 不要。Windows 用户希望某些事情以某种方式工作，这不符合标准做法。更不用说任务栏中的按钮将不再显示标题栏文本，因为它将被推到右侧。

您可以完全接管表单的非客户区，在这种情况下，您可以做自己喜欢的事情。但是，即使您这样做了，我对您的设计的建议是在左上角设置标题，在右上角设置关闭按钮等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T17:54:31.820

对于任何感兴趣的人，我正在使用 Syncfusion Essential Tools。解决方案是这样的：

```
this.ribbonToolbar.TitleAlignment = Syncfusion.Windows.Forms.Tools.TextAlignment.Center; 
```

标题对齐是功能区工具栏的属性，而不是 RibbonForm 的属性，这就解释了为什么我之前没有找到它。感谢所有回复的人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T21:32:59.183

标题栏由系统呈现，没有使文本居中的选项。

为了有效地居中，您需要自己绘制标题栏 - 这可以通过处理 WM_NCPAINT 消息等在本机代码中完成，但不确定如何在 .NET 中轻松完成。

但是你为什么要改变？Windows UX 标准使文本左对齐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T21:34:37.183

我不相信你可以。

您可以隐藏标题栏，并将其替换为用户控件并实现与标题栏相同的功能，但我认为这不是一个好主意。

用户的一致性可能比您想要使文本居中的任何原因更重要。

# jquery - 为什么这只适用于 Firefox？

> ID：1009610
> 
> 赞同：3
> 
> 时间：2009-06-17T21:30:42.913
> 
> 标签：jquery, firefox, webkit

我创建了一个独立的示例来找出为什么这只在 Firefox 中有效：

```
var ul = jQuery('<ul></ul>');

jQuery(selector).children().each(function() {
   var li = jQuery('<li></li>');
   var label = '<label for="' + this.id + '">' + this.name + '</label>';
   li.append(label);
   li.append(this);
   ul.append(li);
}); 
```

任何 webkit 浏览器甚至 IE 在此行都失败：

```
li.append(this); 
```

这是一个 HTMLInputElement。有任何想法吗？

谢谢，皮特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T08:44:20.813

问题是，“this”是一个已经位于某个地方的 DOM 节点。您不能移动 DOM 节点，这些节点已经位于某个地方，而无需先删除或复制它们。

如果你想：

*   移动它，你必须做

    li.append ($(this).remove())

*   复制它，你会做

    li.append ($(this).clone (true))

实际上，我很困惑，它应该在 FF 中工作。如果是这样，那就是FF错误。

干杯，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T21:40:24.813

这可能是您尝试从中选择子元素的元素的问题，或者您正在使用的 jQuery 版本的问题。

我正在使用 1.3.2 并使用您的代码（复制和粘贴）我可以在 FF 3、IE 8 和 Chrome 中成功运行它。

# c# - 如何检测何时拖动表单？

> ID：1009615
> 
> 赞同：2
> 
> 时间：2009-06-17T21:31:52.087
> 
> 标签：c#, winforms, events, drag-and-drop

我有一个显示标题栏的 Form 对象。

我需要一种纯托管方式（P/Invoke-free，Mono 和 .NET 兼容，最好是 .NET 2.0 API）来检测**FORM**本身何时开始被拖动、更改位置以及何时被丢弃（不是任何内容）。

我过去在 Mono 中做过这个，但我不记得怎么做了，我不知道我的解决方案是否与 MS.NET 兼容......

如果有人可以提供一个示例，三个事件名称供我使用谷歌搜索更多详细信息或将我指向相关的 StackOverflow 问题，我将不胜感激。到目前为止，我的搜索没有返回任何相关结果......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T21:34:01.863

您是在说实际的拖放操作，还是在用户移动表单时？如果是移动本身，您也许可以使用[`ResizeBegin`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.resizebegin.aspx)在用户开始移动表单时引发的事件。这与[`LocationChanged`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.locationchanged.aspx)并且[`ResizeEnd`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.resizeend.aspx)应该满足您的需求。但是，`ResizeBegin`and`ResizeEnd`事件（当然）也会在您开始和结束调整表单大小时引发，而不仅仅是在您移动它时。

# xml - Linq to XML（Base64 编码）

> ID：1009620
> 
> 赞同：1
> 
> 时间：2009-06-17T21:32:38.653
> 
> 标签：xml, linq, linq-to-xml

我必须将 PDF 转换为 Base64 编码并将其写入 XML 文件中的元素。
我有 Base64 编码的字符串（很长/很大），但是我正在使用的规范说明如下：

选择此选项是为了确保可以显示和验证 XML 文件，而不会因处理原始 JPEG 文件的原始二进制组合而导致任何潜在问题。文件数据应在符合 XML 的浏览器（例如 Internet Explorer）中正确显示。数据必须以固定的 76 个字符行显示，每行用换行符分隔。
第一个问题是关于 JPEG 的一点，如果我使用 pdf 是否有效？

其次不知道如何实现：数据必须以固定的 76 个字符行显示，每行用换行符分隔。
我如何使用 Linq to XML 实现这一点

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-18T00:38:02.037

```
Convert.ToBase64String(pdfBytes, Base64FormattingOptions.InsertLineBreaks); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T22:04:58.663

由于插入，这不是一个非常有效的解决方案（最好通过从编码文件内容中添加 76 个字符来构建字符串，然后是一个新行，然后是 76 个字符，然后是一个新行，......）但它很短，展示了总体思路。如果内存使用和性能是一个问题，人们也可以考虑用`Convert.ToBase64String()`直接将字节编码到`StringBuilder`.

```
public static XElement BuildNode(Byte[] data, XName tagName, Int32 lineLength)
{
    StringBuilder sb = new StringBuilder(Convert.ToBase64String(data));

    Int32 position = 0;

    while (position < sb.Length)
    {
        sb.Insert(position, Environment.NewLine);
        position += lineLength + Environment.NewLine.Length;
    }

    sb.AppendLine();

    return new XElement(tagName, sb.ToString());
} 
```

例如

```
String text = "I have got to convert a PDF to a Base64 Encoded " +
              "and write it to a element in a XML file.";

Byte[] data = Encoding.UTF8.GetBytes(text);

StringBuilder sb = new StringBuilder();
TextWriter tw = new StringWriter(sb);

using (var writer = new XmlTextWriter(tw) { Formatting = Formatting.Indented })
{
    XDocument document = new XDocument(BuildNode(data, "Content", 40));

    document.Save(writer);
}

Console.WriteLine(sb.ToString()); 
```

打印以下内容。

```
<?xml version="1.0" encoding="utf-16"?>
<Content>
SSBoYXZlIGdvdCB0byBjb252ZXJ0IGEgUERGIHRv
IGEgQmFzZTY0IEVuY29kZWQgYW5kIHdyaXRlIGl0
IHRvIGEgZWxlbWVudCBpbiBhIFhNTCBmaWxlLg==
</Content> 
```

# c# - 正则表达式将方括号内括号内的数字与可选文本匹配

> ID：1009633
> 
> 赞同：5
> 
> 时间：2009-06-17T21:35:12.907
> 
> 标签：c#, regex

首先，我在这里使用 C#，所以这就是我正在处理的 RegEx 的风格。以下是我需要能够匹配的东西：

```
[(1)] 
```

或者

```
[(34) Some Text - Some Other Text] 
```

所以基本上我需要知道括号之间的内容是否是数字，并忽略右括号和右方括号之间的所有内容。有任何 RegEx 大师愿意提供帮助吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-17T21:38:50.417

这应该有效：

```
\[\(\d+\).*?\] 
```

如果您需要获取数字，只需`\d+`用括号括起来：

```
\[\((\d+)\).*?\] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T21:46:11.013

你必须匹配[]吗？你能不能只...

```
\((\d+)\) 
```

（数字本身将在组中）。

例如 ...

```
var mg = Regex.Match( "[(34) Some Text - Some Other Text]", @"\((\d+)\)");

if (mg.Success)
{
  var num = mg.Groups[1].Value; // num == 34
}
  else
{
  // No match
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-21T21:34:38.637

在这种情况下，正则表达式似乎有点矫枉过正。这是我最终使用的解决方案。

```
var src = test.IndexOf('(') + 1;
var dst = test.IndexOf(')') - 1;
var result = test.SubString(src, dst-src); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T21:39:35.783

就像是：

```
\[\(\d+\)[^\]]*\] 
```

可能需要更多的转义？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T21:55:10.417

"^\[\((d+)\)" 怎么样（perl 风格，不熟悉 C#）。我认为，您可以放心地忽略该行的其余部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T00:47:42.300

取决于您要完成的工作...

```
List<Boolean> rslt;
String searchIn;
Regex regxObj;
MatchCollection mtchObj;
Int32 mtchGrp;

searchIn = @"[(34) Some Text - Some Other Text] [(1)]";

regxObj = new Regex(@"\[\(([^\)]+)\)[^\]]*\]");

mtchObj = regxObj.Matches(searchIn);

if (mtchObj.Count > 0)
    rslt = new List<bool>(mtchObj.Count);
else
    rslt = new List<bool>();

foreach (Match crntMtch in mtchObj)
{
    if (Int32.TryParse(crntMtch.Value, out mtchGrp))
    {
        rslt.Add(true);
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T15:08:08.107

这个怎么样？假设您只需要确定字符串是否匹配，而无需提取数值...

```
 string test = "[(34) Some Text - Some Other Text]";

        Regex regex = new Regex( "\\[\\(\\d+\\).*\\]" );

        Match match = regex.Match( test );

        Console.WriteLine( "{0}\t{1}", test, match.Success ); 
```

# zend-framework - Zend DB 框架检查更新查询

> ID：1009639
> 
> 赞同：19
> 
> 时间：2009-06-17T21:36:44.540
> 
> 标签：zend-framework, zend-db

所以你可以使用这样的东西：

```
$query = $db->select();
$query->from('pages', array('url'));
echo $query->__toString(); 
```

检查 Zend Db 框架将用于该 SELECT 查询的 sql。是否有一种等效的方式来查看 SQL 以进行更新？

```
$data = array(
   'content'      => stripslashes(htmlspecialchars_decode($content))
);      
$n = $db->update('pages', $data, "url = '".$content."'");
?? 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-17T21:40:59.790

使用[Zend_Db_Profiler](https://framework.zend.com/manual/1.12/en/zend.db.profiler.html)捕获和报告 SQL 语句：

```
$db->getProfiler()->setEnabled(true);
$db->update( ... );
print $db->getProfiler()->getLastQueryProfile()->getQuery();
print_r($db->getProfiler()->getLastQueryProfile()->getQueryParams());
$db->getProfiler()->setEnabled(false); 
```

如果不需要，请记住关闭分析器！我与一位认为他有内存泄漏的人交谈过，但分析器为他正在运行的数百万个 SQL 查询中的每一个实例化了几个 PHP 对象。

PS：您应该[`quoteInto()`](http://framework.zend.com/manual/en/zend.db.html#zend.db.adapter.quoting.quote-into)在该查询中使用：

```
$n = $db->update('pages', $data, $db->quoteInto("url = ?", $content)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T21:43:46.650

不，不是直接的，因为 Zend Framework 在适配器方法 Zend_Db_Adapter_Abstract::update 中构建并执行 SQL：

```
/**
 * Updates table rows with specified data based on a WHERE clause.
 *
 * @param  mixed        $table The table to update.
 * @param  array        $bind  Column-value pairs.
 * @param  mixed        $where UPDATE WHERE clause(s).
 * @return int          The number of affected rows.
 */
public function update($table, array $bind, $where = '')
{
    /**
     * Build "col = ?" pairs for the statement,
     * except for Zend_Db_Expr which is treated literally.
     */
    $set = array();
    foreach ($bind as $col => $val) {
        if ($val instanceof Zend_Db_Expr) {
            $val = $val->__toString();
            unset($bind[$col]);
        } else {
            $val = '?';
        }
        $set[] = $this->quoteIdentifier($col, true) . ' = ' . $val;
    }

    $where = $this->_whereExpr($where);

    /**
     * Build the UPDATE statement
     */
    $sql = "UPDATE "
         . $this->quoteIdentifier($table, true)
         . ' SET ' . implode(', ', $set)
         . (($where) ? " WHERE $where" : '');

    /**
     * Execute the statement and return the number of affected rows
     */
    $stmt = $this->query($sql, array_values($bind));
    $result = $stmt->rowCount();
    return $result;
} 
```

您可以暂时在此方法中插入一个 var_dump 并退出以检查 sql 以确保其正确：

```
/**
 * Build the UPDATE statement
 */
 $sql = "UPDATE "
         . $this->quoteIdentifier($table, true)
         . ' SET ' . implode(', ', $set)
         . (($where) ? " WHERE $where" : '');
 var_dump($sql); exit; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-29T10:23:55.863

我想另一种方法是通过组合探查器数据来记录实际的 SQL 查询，而不是更改 ZF 库代码。

```
$db->getProfiler()->setEnabled(true);

$db->update( ... );

$query = $db->getProfiler()->getLastQueryProfile()->getQuery();

$queryParams = $db->getProfiler()->getLastQueryProfile()->getQueryParams();

$logger->log('SQL: ' . $db->quoteInto($query, $queryParams), Zend_Log::DEBUG);

$db->getProfiler()->setEnabled(false); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T11:52:19.667

最近在寻找一种调试 zend_db_statement 的方法时遇到了这个问题。如果其他人通过相同的搜索遇到此问题，您可以使用以下功能。

只需将“self::getDefaultAdapter()”替换为您获取数据库连接或适配器的方法。

> ```
> /**
>  * replace any named parameters with placeholders
>  * @param string $sql sql string with placeholders, e.g. :theKey
>  * @param array $bind array keyed on placeholders, e.g. array('theKey', 'THEVALUE')
>  * 
>  * @return String sql statement with the placeholders replaced
>  */
> public static function debugNamedParamsSql($sql, array $bind) {
>     $sqlDebug = $sql;
>     foreach($bind as $needle => $replace) {
>         $sqlDebug = str_replace( 
>                                 ':' . $needle, 
>                                 self::getDefaultAdapter()->quote($replace), 
>                                 $sqlDebug
>         );
>     }        
>     return $sqlDebug;        
> } 
> ```

# .net - 重塑 Windows Vista 中的“玻璃”

> ID：1009641
> 
> 赞同：4
> 
> 时间：2009-06-17T21:36:52.980
> 
> 标签：.net, winforms, api, windows-vista, transparency

在 Windows Vista 中，所有标准窗口边框都是半透明的，并且在它们下面的任何东西上都会产生某种玻璃扭曲效果。这种玻璃效果可以渗透到窗口的其他区域，例如 Windows 资源管理器中的地址和搜索栏或 Windows Media Player 中的播放控件。如果我也想在我的 .NET Windows 窗体应用程序中执行此操作怎么办？有没有人知道可以用来控制这种效果区域的某种 API 调用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T21:39:52.710

您必须从 dwmapi.dll 进行 P/Invoke

[http://www.danielmoth.com/Blog/2006/06/vista-glass-in-c_17.html](http://www.danielmoth.com/Blog/2006/06/vista-glass-in-c_17.html)

**但是**，Winforms 并未正式支持这一点，而且普遍的共识似乎是，在 .NET 应用程序中获取 glass 的最佳方法是改用 WPF。

# javascript - 处理多个 JavaScript 替换匹配

> ID：1009653
> 
> 赞同：4
> 
> 时间：2009-06-17T21:39:21.947
> 
> 标签：javascript, regex, replace

我有以下字符串：

```
This *is* a *test*! 
```

我想将 * 字符包围的单词加粗（例如示例中的“is”和“test”）。

我有以下 JavaScript 代码：

```
var data = "This *is* a *test*!";
return data.replace(/\*(.*)\*/g, <b>$1</b>); 
```

返回字符串时，我得到以下信息：

```
This <b>is* a *test</b>! 
```

如何更改模式或基本代码以便按照我想要的方式进行替换？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T21:43:34.590

所以弄乱了我的 HTML ......

```
var result = "This *is* a *test*!".replace(/\*(.*?)\*/gi, "<b>$1</b>"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T21:48:31.053

您需要通过在 * 之后添加 ? 运算符来使模式不贪婪：

```
var data = "This *is* a *test*!";
return data.replace(/\*(.*?)\*/g, "<b>$1</b>"); 
```

这是来自[Mozilla Developer Center](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/RegExp)的 JavaScript RegExp 参考。

# .net - Rails v1.2.3，ActionWebService 和 .NET 平台作为客户端

> ID：1009654
> 
> 赞同：0
> 
> 时间：2009-06-17T21:39:26.750
> 
> 标签：.net, ruby-on-rails, web-services

我在一个项目中使用 Rails 1.2.3。（升级导轨不是一种选择）。我使用 Rails 创建了一个简单的测试 Web 服务。我已经使用 Rails 调用脚手架进行了测试。它似乎可以毫无问题地生成响应。

我正在尝试通过 .NET 设置客户端。我在 C# 中创建了一个 ASP.NET Web App 项目。我正在添加“Web 参考”，将参考 URL 添加到向导的 URL 字段中，

```
http://mydomain.com:3000/backend/api 
```

然后我收到来自向导的错误：

> 下载“ [http://mydomain.com:3000/backend/api](http://mydomain.com:3000/backend/api) ”时出错，请求失败并显示错误消息：
> 
> 不支持 GET
> 
> 下载“ [http://mydomain.com:3000/backend/api/$metadata](http://mydomain.com:3000/backend/api/) ”时出错请求失败并显示错误消息：
> 
> 不支持 GET

我的代码是：

```
# in app/apis/address_api.rb
class AddressApi < ActionWebService::API::Base
   api_method   :gettest, :returns => [:string]
end

# in app/controllers/backend_controller
class BackendController < ApplicationController
  wsdl_service_name 'Backend'
  web_service_api AddressApi
  web_service_scaffold :invoke

  def gettest
    return "hello"
  end

end 
```

ActionWebService 和 .NET 之间是否存在任何已知问题，或者我做错了什么？我的 URL 对于 Rails 网络服务是否正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-11-17T19:28:35.520

这可能已经在其他地方得到了回答，但是由于在谷歌搜索 actionwebservice 并获取请求时会弹出这个问题，所以我想我会在这里回答。

默认情况下，AWS 拒绝非 POST 请求。具体来说，它在 action_controller_dispatcher.rb 中有代码，内容如下：

```
def dispatch_web_service_request
  if request.get?
    render_text('GET not supported', '500 GET not supported')
    return
  end
  .. 
```

基本上，您必须将请求设置为 POST 请求而不是 GET 请求。或者您必须覆盖 AWS 对 GET 请求的处理。（您可以尝试在 gem 中编辑代码，但是（1）当您更新 gem 时它会被覆盖；（2）我不确定一般来说这个想法有多好；（3）我从未尝试过它。

如果您可以控制生成请求的代码，则前者可能更合适。如果你不这样做，Zack Chandler 有一个解决方法（用于 QuickBooks 与 Web 服务的连接，但无论如何它都应该工作），[here](http://www.depixelate.com/2006/12/13/rails-and-quickbooks-integration-part-3/)。

我在下面引用它以防 url 发生变化。

> 在 lib/action_web_service_ext.rb 中创建补丁文件
> 
> ```
> module ActionController
>   class Base
> 
>     alias_method :old_dispatch_web_service_request, :dispatch_web_service_request
> 
>     # --- [ QBWC requests the api url with a GET request upon loading the QWC file for the first time ] ---
>     def dispatch_web_service_request
>       render :nothing => true and return if request.get?
>       old_dispatch_web_service_request
>     end
>   end
> end 
> ```
> 
> 在 config/environment.rb 中启用补丁
> 
> ```
> require 'action_web_service_ext.rb' 
> ```

显然 dispatch_web_service_request 方法中的代码是 QuickBooks 特有的，但你应该明白这一点。

希望这会有所帮助，我希望 Zack 不介意我转发。

# c# - MSDN 在提及事件及其事件处理程序时是否使用了错误的术语？

> ID：1009669
> 
> 赞同：2
> 
> 时间：2009-06-17T21:41:43.953
> 
> 标签：c#, asp.net, events

我注意到 MSDN 多次在提及事件及其事件处理程序时使用了“错误”的术语。例如：

> 如果 ProfileManager.AutomaticSaveEnabled 属性为 true，则在页面执行结束时引发 ProfileAutoSaving 事件。您可以使用 Profile_ProfileAutoSaving 全局事件访问 ASP.NET 应用程序的 Global.asax 文件中 ProfileModule 类的 ProfileAutoSaving 事件

为什么上面的引用将 Profile_ProfileAutoSaving 描述为*全局事件*，而据我所知，它实际上是订阅 ProfileAutoSaving 事件的事件处理程序？！

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T22:17:20.340

它是一个全局事件，因为它位于 Global.asax 文件中吗？那有什么问题呢？

**编辑：**我不确定“全局事件”和“事件处理程序”之间的区别是什么。这些不是相互排斥的描述。本质上，这是一个全局事件处理程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T17:24:25.893

The use of this terminology is specific to Global.asax, which has backwards compatibility features to make it similar to Global.asa from Classic ASP. `Profile_ProfileAutoSaving` is a global event in exactly the same way that `Application_Error` is a global event.

# database - 用于存储移动设备数据的数据库系统？

> ID：1009670
> 
> 赞同：0
> 
> 时间：2009-06-17T21:41:48.273
> 
> 标签：database

我开始构建一个应用程序，一个移动设备。性能非常重要（就像其他任何事情一样），我想最大化它。

该数据库将经常使用。我希望通过 C++ Qt 库的 QtSQL 库来访问它。

我在 MySQL 方面有经验，但不认为这是正确的选择。

所以我在看：

*   PostgreSQL
*   sqlite？
*   沙发数据库？

该操作系统是 Ubuntu 的精简版本。需要定期的 CRUD 以及优化的机会。

谢谢，马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-20T22:28:31.033

由于 Apple 在 iPhone 和 iPod Touch 上使用 sqlite，我会好好看看。我假设他们当时会评估所有可用的东西来得出这个结论。

由于 sqlite 是 FOSS 并且得到了知名移动设备供应商的“认可”，因此请尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-19T08:20:31.093

您考虑过 Sybase [Ultralite](http://www.sybase.com/developer/mobile/sqlanywhere/ultralite)吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-26T16:51:12.437

我是一名新的学生开发人员，但似乎 SQLite 可能是最好的选择。除了似乎是首选的 iOS 在线数据库之外……它似乎对[Android](http://developer.android.com/reference/android/database/sqlite/package-summary.html)和即将推出的 [Windows Phone 7 平台][2] 有很多支持（通过 C-sharp-sqllite）。对于大多数 Web 开发来说，这似乎是最占主导地位的（或者在 Windows Phone 7 的情况下——即将推出的）平台。黑莓和 webOS 似乎也没有问题。

# java - 如何在 Flex/BlazeDS 中同时支持 HTTP 和 HTTPS 通道？

> ID：1009675
> 
> 赞同：4
> 
> 时间：2009-06-17T21:42:44.060
> 
> 标签：java, apache-flex, flex3, remoting, blazeds

我一直在尝试找到正确的配置来支持 Flex 应用程序中的两个 http/s 请求。我已经阅读了所有的文档，他们提到做如下的事情：

```
<default-channels>
  <channel ref="my-secure-amf">
    <serialization>
      <log-property-errors>true</log-property-errors>
    </serialization>
  </channel>
  <channel ref="my-amf">
    <serialization>
      <log-property-errors>true</log-property-errors>
    </serialization>
  </channel> 
```

这在通过 https 访问应用程序时效果很好，但在通过 http 访问同一应用程序时会出现间歇性通信失败。这是一个缩写的 services-config.xml：

```
<channel-definition id="my-amf" class="mx.messaging.channels.AMFChannel">
      <endpoint url="http://{server.name}:{server.port}/{context.root}/messagebroker/amf"
                class="flex.messaging.endpoints.AMFEndpoint"/>
      <properties>
        <!-- HTTPS requests don't work on IE when pragma "no-cache" headers are set so you need to set the add-no-cache-headers property to false -->
        <add-no-cache-headers>false</add-no-cache-headers>
        <!-- Use to limit the client channel's connect attempt to the specified time interval. -->
        <connect-timeout-seconds>10</connect-timeout-seconds>
      </properties>
    </channel-definition>

    <channel-definition id="my-secure-amf" class="mx.messaging.channels.SecureAMFChannel">
      <!--<endpoint url="https://{server.name}:{server.port}/{context.root}/messagebroker/amfsecure" class="flex.messaging.endpoints.SecureAMFEndpoint"/>-->
      <endpoint url="https://{server.name}:{server.port}/{context.root}/messagebroker/amfsecure"
                class="flex.messaging.endpoints.AMFEndpoint"/>
      <properties>
        <add-no-cache-headers>false</add-no-cache-headers>
        <connect-timeout-seconds>10</connect-timeout-seconds>
      </properties>
    </channel-definition> 
```

我正在使用 Tomcat 5.5.17 和 Java 5 运行。

1.  BlazeDS 文档说这是最佳实践。有没有更好的办法？
2.  使用此配置，默认通道元素中定义的每个通道似乎有 2-3 次重试，因此在 my-amf 通道通过 http 请求连接之前总是需要大约 20 秒。有没有办法覆盖 2-3 次重试，比如每个频道重试 1 次？

提前感谢您的回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T08:55:04.380

我有 http 和 https 工作，虽然我只在 Firefox 和 IE7 上测试过。到目前为止，我只使用 BlazeDS 进行远程处理。这是我的设置：

```
 <channel-definition id="my-amf"
        class="mx.messaging.channels.AMFChannel">
        <endpoint
            url="http://{server.name}:{server.port}/{context.root}/messagebroker/amf"
            class="flex.messaging.endpoints.AMFEndpoint" />
        <properties>
            <polling-enabled>false</polling-enabled>
        </properties>
    </channel-definition>

    <channel-definition id="my-secure-amf"
        class="mx.messaging.channels.SecureAMFChannel">
        <endpoint
            url="https://{server.name}:{server.port}/{context.root}/messagebroker/amfsecure"
            class="flex.messaging.endpoints.SecureAMFEndpoint" />
        <properties>
            <add-no-cache-headers>false</add-no-cache-headers>
        </properties>
    </channel-definition> 
```

您没有指定您正在使用的应用服务器；这可能是个问题。在 Tomcat 下从 HTTPS 切换到 HTTP（安全登录）时遇到了一些问题。我为排除故障所做的一件事是安装 Jetty 并在那里尝试。我以前从未使用过它，但它的设置和部署速度非常快，即使通过 Eclipse 也是如此。然后我知道我有一个 Tomcat 特定问题，这使得找到解决方案变得更容易（我的意思是可能的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-15T15:39:44.520

这也让我们发疯了。为了解决这个问题，首先在 default-channels 标签中创建 http (my-amf)，然后是 https (my-secure-amf)

```
<default-channels>
  <channel ref="my-amf">
<serialization>
  <log-property-errors>true</log-property-errors>
</serialization>
 </channel>
<channel ref="my-secure-amf">
  <serialization>
  <log-property-errors>true</log-property-errors>
</serialization>
</channel> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-13T09:13:39.347

如果使用 http 和 https 的目的地是不同的目的地，您可以使用顺序定义用于该目的地的通道。例如 mySecureDestination 和 myDestination 是两个不同的目的地。对于 mySecureDestination ：

```
<destination id="mySecureDestination" channels="httpsChannel"></destination> 
```

对于非安全的 http 通道

```
<destination id="myDestination" channels="httpChannel"></destination> 
```

# powershell - 如何在 PowerShell 中将两个集合与具有 2 部分键的表相交？

> ID：1009677
> 
> 赞同：0
> 
> 时间：2009-06-17T21:43:05.230
> 
> 标签：powershell

我有这样的输入数据：

```
FOO.A
FO.B
FOO.C酒吧
巴里

```

和一个规则表，如：

```
   (FOO = A, BAR = X) => 1 # 匹配
   (FOO = A, BAR = Z) => 2 # 不匹配
   (FOO = B, BAR = X) => 3 # 匹配

```

我想获取输入数据，并询问表“哪些条目与此输入数据匹配？”，然后取回第 1 行和第 3 行。

我考虑过使用哈希表，其中 FOO 是键，值是一个以 BAR 为键，1 为值的哈希表。问题是，有重复的键。

在 PowerShell 中编写此代码的惯用方式是什么？

性能并不重要：数据集很小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-11-11T08:41:35.037

只是一个想法。您是否检查了 Compare-Object cmdlet？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T22:34:02.833

这是我正在尝试使用的，我认为它会起作用

```
$table = @(
    @{ 
        Foo = "A"
        Bar = "X
        Value = 1
    },
    @{ 
        Foo = "A"
        Bar = "Y"
        Value = 2
    },
    @{ 
        Foo = "B"
        Bar = "Z"
        Value = 3
    }
)

$table | foreach {
    $row = $_

    $foo = $input.Foos | where {
        $_.Name -eq $row.Foo
    }

    $bar = $input.Bars | where {
        $_.Name -eq $row.Bar
    }

    if ($foo -and $bar) {        
        # processing
    }        
} 
```

# user-interface - MATLAB：从外部调用 GUI/GUIDE 函数

> ID：1009678
> 
> 赞同：0
> 
> 时间：2009-06-17T21:43:07.773
> 
> 标签：user-interface, matlab, function-handle

当我尝试调用 GUI/GUIDE 文件中的子函数（使用已公开为全局变量的函数句柄）时，即使我将轴设置为 GUIDE 图中的特定轴，也始终会创建一个新轴。有谁知道为什么会这样？指导代码是：

```
###############################################################
function varargout = demo(varargin)
  % Begin initialization code - DO NOT EDIT
  gui_Singleton = 1;
  gui_State = struct('gui_Name',       mfilename, ...
                     'gui_Singleton',  gui_Singleton, ...
                     'gui_OpeningFcn', @demo_OpeningFcn, ...
                     'gui_OutputFcn',  @demo_OutputFcn, ...
                     'gui_LayoutFcn',  [] , ...
                     'gui_Callback',   []);
  if nargin && ischar(varargin{1})
      gui_State.gui_Callback = str2func(varargin{1});
  end

  if nargout
      [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
  else
      gui_mainfcn(gui_State, varargin{:});
  end
  % End initialization code - DO NOT EDIT

function demo_OpeningFcn(hObject, eventdata, handles, varargin)
  handles.output = hObject;

  % Update handles structure
  guidata(hObject, handles);

  global myhandles updateFunction;
  myhandles = handles;
  updateFunction = @update;

function varargout = demo_OutputFcn(hObject, eventdata, handles) 
  varargout{1} = handles.output;

function pushbutton1_Callback(hObject, eventdata, handles)
  update();

function update()
  global myhandles;

  axes(myhandles.axes1);
  plot(1:2,1:2);

########################################################################### 
```

当我这样做时（上面的外部文件）：

```
global updateFunction;
feval(updateFunction) 
```

我总是在新创建的图形窗口中看到绘图，而不是在 GUI 图形中。为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T02:27:30.960

我会尝试的第一件事是将函数**更新**替换为以下内容：

```
function update
  global myhandles;
  plot(myhandles.axes1,1:2,1:2); 
```

这将明确告诉[PLOT](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/plot.html)函数绘制到给定的轴上。如果这不起作用，请尝试将轴“NextPlot”属性设置为“add”（可能在**demo_OpeningFcn**中）：

```
set(myhandles.axes1,'NextPlot','add'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T22:55:35.350

默认情况下，当您使用 GUIDE 创建 GUI 时，Matlab 将与 GUI 关联的所有对象的“HandleVisibility”属性设置为“回调”。这意味着您不能从回调例程之外的任何地方（即从命令行或外部函数）将这些句柄设置为当前图形或当前轴。

要解决此问题，您可以在所有绘图函数中明确指定适当的句柄，也可以将轴的“HandleVisibility”属性设置为“on”。这可以通过属性检查器逐个对象完成，或者通过转到“工具 - > GUI选项...”并将“命令行可访问性：”更改为“打开”来完成整个 GUI。

# c# - 如何从文本文件中读取字符串文字和注释？

> ID：1009679
> 
> 赞同：0
> 
> 时间：2009-06-17T21:43:16.727
> 
> 标签：c#, .net, file, file-handling

我们正在从文本文件中获取输入。

每行都在空格处分割成字符串，因此我们可以进一步对元素进行分类。使字符串成为问题的是，我还想读取字符串文字（例如“谢谢”），因为它们也没有拆分和注释（// 和 /* ....*/）。有什么办法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-11T15:53:14.557

执行此操作的标准方法是使用状态机 - 按顺序读取每个字符，当您看到“”时切换到“字符串”状态，并在看到//时切换到“评论”状态和从“评论”状态切换， /* 或 */。在每种状态下，您都可以将读取的字符附加到字符串生成器，这样就可以在输入中找到每种类型的字符串

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T19:09:11.013

我的示例文本是：

```
using system.text.RegularExpressions;
namespace check_regex               //Using regex.
{
    class Program
    {
        static void Main(string[] args)
        {
            //This is a program.

            Console.WriteLine("this is a string");
            /* okay okay
              blah blah blah
              sumthng blah 908657580@#%$ */

    }
} 
```

文本输入将是这样的。

# .net - 为什么人们使用 .net 进行 Web 开发

> ID：1009680
> 
> 赞同：2
> 
> 时间：2009-06-17T21:43:32.407
> 
> 标签：.net

我只是想知道为什么人们在 web 开发中使用 dot net 而不是 php 之类的东西。有什么优势？.net 生成您的 javascript 和 html 是真的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T21:47:02.727

WebForms 提供了一种模仿经典 Windows 开发的 Web 开发抽象。此外，C# 和 VB.NET 可用于开发桌面程序，以及可在 ASP.NET 和桌面应用程序之间轻松共享的业务对象库。

我知道开发 ASP.NET 应用程序的开发人员只具备 CSS/HTML/Javascript 的基本知识，但您不能完全放弃这些知识—— ASP，如 PHP 页面，主要是 HTML。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T21:54:44.303

我使用它是因为它非常强大，而且 IDE（Visual Studio、Intellisense）非常棒。你可以做任何事情，从创建一个快速应用程序到一个相对容易的成熟企业应用程序，将很多无聊的东西抽象出来。当然，如果你喜欢无聊的东西，你也可以修改它。

但我会说 Intellisense 是我使用它的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T21:47:29.340

我会使用 .NET 进行 Web 编程，因为它是强大的框架。（即所有 System.* 的东西。）

您可以使用 WebForms 和 WebForms 设计器生成 JS 和 HTML，但如果您是重视[POSH](http://microformats.org/wiki/posh)设计技术的人，那么这不是一个真正的选择。

基本上，这只是一个见仁见智的问题，您是否想在 .NET 中使用内置的 WebForms 和 ASP.NET MVC 框架，或者您是否渴望 CGI 风格的 PHP 或 mod_perl 脚本。

# python - 无法找到被 robots.txt 阻止的互联网页面

> ID：1009686
> 
> 赞同：-1
> 
> 时间：2009-06-17T21:44:50.593
> 
> 标签：python, web-crawler, data-mining

**问题：**寻找大学数学讲座的答案和练习。赫尔辛基

**实际问题**

1.  用 .com 列出`Disallow`robots.txt中的网站列表
2.  在 (1) 处列出包含 *.pdf 文件的站点列表
3.  在 (2) 处列出在 pdf 文件中包含单词“analyysi”的站点

**实际问题的建议**

7.  **问题 3：**制作一个从 pdf 文件中抓取数据的编译器

**问题**

1.  您如何搜索已注册的 .com 网站？
2.  **你将如何通过 Python 的 defaultdict 和 BeautifulSoap 解决实际问题 1 和 2？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-26T12:27:16.380

> 我试图在互联网上找到每个网站都有一个 pdf 文件，其中包含“Analyysi”这个词

不是您的问题的答案，但是：请尊重网站所有者不被索引的愿望。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-26T12:47:27.463

你的问题有问题。

关于 (2)，您错误地假设您可以在网络服务器上找到所有 PDF 文件。由于多种原因，这是不可能的。第一个原因是并非所有文件都可以参考。第二个原因是即使它们被引用，引用本身也可能对您是不可见的。最后，还有动态生成的 PDF 资源。这意味着在您要求它们之前它们不存在。而且由于它们取决于您的输入，因此它们的数量是无限的。

由于几乎相同的原因，问题 3 是错误的。特别是，仅当您在查询中使用“analyysi”时，生成的 PDF 才可能包含“analyysi”一词。例如[http://example.com/makePDF.cgi?analyysi](http://example.com/makePDF.cgi?analyysi)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T22:04:02.723

如果我了解您的要求，您基本上必须搜索所有可能的站点，以查看哪些站点符合您的条件。无论您使用什么工具，我都没有看到任何更快或更有效的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T09:21:55.450

如果我理解正确，那么如果不扫描整个互联网，我看不出这是怎么可能的。您正在寻找不在 Google 上的互联网页面？网络上没有每个站点的数据库，如果它们被搜索引擎索引...

您实际上需要索引整个网络，然后浏览每个站点并检查它们是否在谷歌上。

如果这与一个站点或网络有关，我也很困惑，因为您的问题似乎在两者之间切换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T09:37:17.930

您的意思是您的讲座在您大学的内部网的网页上，并且您希望能够从您的大学的内部网外部访问该页面？

我假设为了访问您的 Uni 的 Intranet，您必须输入密码，并且 Google 不会索引 Uni 的任何 Intranet 页面——这是 Intranet 的本质。

如果上述所有假设都是正确的，那么您只需将您的 pdf 文件托管在您大学内部网之外的网站上。最简单的方法是创建一个博客（不涉及任何成本，而且非常简单快捷），然后在那里发布您的 pdf 文件。

然后，Google 将为您的页面编制索引，并在您输入时从您的 pdf 中“抓取数据”，这意味着您的 pdf 文件中的文本将是可搜索的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-14T21:32:04.717

我概述：

**1\. 法律**

“问题在于执行该法律！原则上很容易，实际上很昂贵！” [来源](http://www.webmasterworld.com/forum93/807.htm)

“*没有法律规定必须遵守 /robots.txt*，也不构成网站所有者和用户之间具有约束力的合同，**但**拥有/robots.txt*在法律案件中可能具有相关性。* ”[来源](http://www.robotstxt.org/faq/legal.html)

**2\. 练习**

```
disallow filetype:txt 
```

**3.理论上可能？**

# c# - ReverseString，一个 C# 面试问题

> ID：1009689
> 
> 赞同：10
> 
> 时间：2009-06-17T21:45:32.730
> 
> 标签：c#

我有一个面试问题，询问我对初级程序员编写的一段代码的“反馈”。他们暗示可能存在问题，并表示它将大量用于大型字符串。

```
public string ReverseString(string sz)
{
    string result = string.Empty;
    for(int i = sz.Length-1; i>=0; i--)
    {
      result += sz[i]
    }
    return result;
} 
```

我无法发现它。我没有看到任何问题。事后看来，我本可以说用户应该调整大小，但看起来 C# 没有调整大小（我是 C++ 人）。

我最终写了一些东西，比如尽可能使用迭代器，容器中的 [x] 不能随机访问，所以它可能很慢。和杂项。但我肯定说过我从来不需要优化 C# 代码，所以我的想法可能没有让我在面试中失败。

我想知道，这段代码有什么问题，你们看到了吗？

-编辑-

我把它改成了一个wiki，因为可能有几个正确的答案。我也很高兴我明确地说我从来不需要优化 C# 程序并提到了其他的杂项。哎呀。我一直认为 C# 在这类事情上没有任何性能问题。哎呀。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-06-17T21:49:54.123

最重要的是？这会降低性能 - 它必须创建**大量**字符串（每个字符一个）。最简单的方法是：

```
public static string Reverse(string sz) // ideal for an extension method
{
    if (string.IsNullOrEmpty(sz) || sz.Length == 1) return sz;
    char[] chars = sz.ToCharArray();
    Array.Reverse(chars);
    return new string(chars);
} 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-06-17T21:49:58.103

问题是字符串连接的成本很高，因为字符串在 C# 中是不可变的。给出的示例将在每次迭代中创建一个长一个字符的新字符串，这是非常低效的。为避免这种情况，您应该使用[StringBuilder](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder(VS.71).aspx)类，如下所示：

```
public string ReverseString(string sz)
{
    var builder = new StringBuilder(sz.Length);
    for(int i = sz.Length-1; i>=0; i--)
    {
      builder.Append(sz[i]);
    }
    return builder.ToString();
} 
```

StringBuilder 是专门为这样的场景编写的，因为它使您能够连接字符串，而不会出现内存分配过多的缺点。

您会注意到我为 StringBuilder 提供了您不经常看到的初始容量。正如您一开始就知道结果的长度一样，这消除了不必要的内存分配。

通常情况下，它会为 StringBuilder 分配一定数量的内存（默认为 16 个字符）。一旦内容试图超过该容量，它就会（我认为）自己的容量加倍并继续。这比每次都分配内存要好得多，因为普通字符串会发生这种情况，但如果你也能避免这种情况，那就更好了。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-06-17T22:12:39.383

对迄今为止给出的答案的一些评论：

*   它们中的每一个（到目前为止！）都会在代理对和组合字符上失败。哦，Unicode 的乐趣。反转字符串与反转字符序列不同。
*   我喜欢[Marc](https://stackoverflow.com/questions/1009689/reversestring-a-c-interview-question/1009713#1009713)对 null、空和单字符输入的优化。特别是，这不仅可以快速得到正确的答案，而且还可以处理 null （其他答案都没有）
*   我最初认为`ToCharArray`其次`Array.Reverse`是最快的，但它确实创建了一个“垃圾”副本。
*   该`StringBuilder`解决方案创建一个字符串（不是 char 数组）并对其进行操作，直到您调用`ToString`. 没有涉及额外的复制......但是维护长度等还有很多工作。

哪个是更有效的解决方案？好吧，我必须对其进行基准测试才能有任何想法——但即便如此，这也不能说明全部情况。您是否在内存压力高的情况下使用它，额外的垃圾真的很痛苦？您的内存与 CPU 相比有多快？

与以往一样，可读性*通常是*王道——在这方面并没有比 Marc 的回答好多少。特别是，*没有一个错误的余地*，而我实际上必须花一些心思来验证其他答案。我不喜欢思考。它伤害了我的大脑，所以我尽量不要经常这样做。使用内置的`Array.Reverse`声音对我来说要好得多。（好吧，所以它仍然在代理等方面失败，但是嘿......）

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-06-17T21:48:30.617

由于字符串是不可变的，因此每个`+=`语句将通过复制最后一步中的字符串以及单个字符来创建一个新字符串以形成一个新字符串。实际上，这将是一个 O(n ² ) 算法而不是 O(n)。

更快的方法是（O（n））：

```
// pseudocode:
static string ReverseString(string input) {
    char[] buf = new char[input.Length];
    for(int i = 0; i < buf.Length; ++i)
       buf[i] = input[input.Length - i - 1];
    return new string(buf);
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-17T22:18:49.370

您可以改为在 .NET 3.5 中执行此操作：

```
 public static string Reverse(this string s)
    {
        return new String((s.ToCharArray().Reverse()).ToArray());
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T21:50:26.493

解决它的更好方法是使用 StringBuilder，因为它不是不可变的，你不会得到上面那种可怕的对象生成行为。在 .net 中，所有字符串都是不可变的，这意味着 += 运算符在每次被命中时都会创建一个新对象。StringBuilder 使用内部缓冲区，因此可以在缓冲区中完成反转，而无需额外的对象分配。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T21:50:56.540

您应该使用 StringBuilder 类来创建结果字符串。字符串是不可变的，因此当您在循环的每个交互中附加一个字符串时，必须创建一个新字符串，这不是很有效。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-11-22T23:17:20.773

我更喜欢这样的东西：

```
using System;
using System.Text;
namespace SpringTest3
{
    static class Extentions
    {
        static private StringBuilder ReverseStringImpl(string s, int pos, StringBuilder sb)
        {
            return (s.Length <= --pos || pos < 0) ? sb : ReverseStringImpl(s, pos, sb.Append(s[pos]));
        }

        static public string Reverse(this string s)
        {
            return ReverseStringImpl(s, s.Length, new StringBuilder()).ToString();
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("abc".Reverse());
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-03-06T15:23:59.070

x 是要反转的字符串。

```
 Stack<char> stack = new Stack<char>(x);

        string s = new string(stack.ToArray()); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-03-04T21:33:10.993

这种方法将迭代次数减少了一半。它不是从头开始，而是从头开始并交换字符直到它到达中心。必须将字符串转换为 char 数组，因为字符串上的索引器没有设置器。

```
 public string Reverse(String value)
    {
        if (String.IsNullOrEmpty(value)) throw new ArgumentNullException("value");

        char[] array = value.ToCharArray();

        for (int i = 0; i < value.Length / 2; i++)
        {
            char temp = array[i];
            array[i] = array[(array.Length - 1) - i];
            array[(array.Length - 1) - i] = temp;
        }

        return new string(array);
    } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-03-30T14:43:10.993

死灵术。
作为一项公共服务，这就是您实际正确反转**字符串**
的方式（反转字符串**不**等于反转**字符序列**）

```
public static class Test
{

    private static System.Collections.Generic.List<string> GraphemeClusters(string s)
    {
        System.Collections.Generic.List<string> ls = new System.Collections.Generic.List<string>();

        System.Globalization.TextElementEnumerator enumerator = System.Globalization.StringInfo.GetTextElementEnumerator(s);
        while (enumerator.MoveNext())
        {
            ls.Add((string)enumerator.Current);
        }

        return ls;
    }

    // this 
    private static string ReverseGraphemeClusters(string s)
    {
        if(string.IsNullOrEmpty(s) || s.Length == 1)
             return s;

        System.Collections.Generic.List<string> ls = GraphemeClusters(s);
        ls.Reverse();

        return string.Join("", ls.ToArray());
    }

    public static void TestMe()
    {
        string s = "Les Mise\u0301rables";
        // s = "noël";
        string r = ReverseGraphemeClusters(s);

        // This would be wrong:
        // char[] a = s.ToCharArray();
        // System.Array.Reverse(a);
        // string r = new string(a);

        System.Console.WriteLine(r);
    }
} 
```

见： [https ://vimeo.com/7403673](https://vimeo.com/7403673)

顺便说一句，在 Golang 中，正确的方法是这样的：

```
package main

import (
  "unicode"
  "regexp"
)

func main() {
    str := "\u0308" + "a\u0308" + "o\u0308" + "u\u0308"
    println("u\u0308" + "o\u0308" + "a\u0308" + "\u0308" == ReverseGrapheme(str))
    println("u\u0308" + "o\u0308" + "a\u0308" + "\u0308" == ReverseGrapheme2(str))
}

func ReverseGrapheme(str string) string {

  buf := []rune("")
  checked := false
  index := 0
  ret := "" 

    for _, c := range str {

        if !unicode.Is(unicode.M, c) {

            if len(buf) > 0 {
                ret = string(buf) + ret
            }

            buf = buf[:0]
            buf = append(buf, c)

            if checked == false {
                checked = true
            }

        } else if checked == false {
            ret = string(append([]rune(""), c)) + ret
        } else {
            buf = append(buf, c)
        }

        index += 1
    }

    return string(buf) + ret
}

func ReverseGrapheme2(str string) string {
    re := regexp.MustCompile("\\PM\\pM*|.")
    slice := re.FindAllString(str, -1)
    length := len(slice)
    ret := ""

    for i := 0; i < length; i += 1 {
        ret += slice[length-1-i]
    }

    return ret
} 
```

不正确的方法是（ToCharArray.Reverse）：

```
func Reverse(s string) string {
    runes := []rune(s)
    for i, j := 0, len(runes)-1; i < j; i, j = i+1, j-1 {
        runes[i], runes[j] = runes[j], runes[i]
    }
    return string(runes)
} 
```

请注意，您需要知道
- 字符和字形
- 字节（8 位）和代码点/符文（32 位）
- 代码点和 GraphemeCluster [32+ 位]（又名 Grapheme/Glyph）之间的区别

[参考：](https://stackoverflow.com/questions/27331819/whats-the-difference-between-a-character-a-code-point-a-glyph-and-a-grapheme)

> 字符是一个超载的术语，它可以表示很多东西。
> 
> 代码点是信息的原子单位。文本是一系列代码点。每个代码点都是一个由 Unicode 标准赋予含义的数字。
> 
> 字素是一个或多个代码点的序列，它们显示为单个图形单元，读者将其识别为书写系统的单个元素。例如，a 和 ä 都是字素，但它们可能由多个代码点组成（例如 ä 可能是两个代码点，一个用于基本字符 a，然后一个用于分叉；但也有另一种遗留的单一代码表示这个字素的点）。某些代码点绝不是任何字形的一部分（例如，零宽度非连接符或方向覆盖）。
> 
> 字形是图像，通常存储在字体（字形的集合）中，用于表示字素或其部分。字体可以将多个字形组合成单个表示，例如，如果上面的 ä 是单个代码点，则字体可以选择将其呈现为两个独立的、空间重叠的字形。对于 OTF，字体的 GSUB 和 GPOS 表包含替换和定位信息以使其工作。一个字体也可能包含同一个字素的多个替代字形。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-09-18T10:50:25.620

```
 static string reverseString(string text)
    {
        Char[] a = text.ToCharArray();
        string b = "";
        for (int q = a.Count() - 1; q >= 0; q--)
        {
            b = b + a[q].ToString();
        }
        return b;
    } 
```

# c++ - 可以在调用构造函数之前完成赋值吗？

> ID：1009691
> 
> 赞同：2
> 
> 时间：2009-06-17T21:46:09.920
> 
> 标签：c++, multithreading, constructor, multicore, sequence-points

[对双重检查锁定的修复有什么问题的](https://stackoverflow.com/questions/945232/whats-wrong-with-this-fix-for-double-checked-locking)评论？说：

> 问题是变量可能在构造函数运行（或完成）之前分配，而不是在分配对象之前。

让我们考虑代码：

```
A *a;

void Test()
{
    a = new A;
} 
```

为了进行更正式的分析，让我们将 a = new A 拆分为几个操作：

```
void *mem = malloc(sizeof(A)); // Allocation
new(mem) A; // Constructor
a = reinterpret_cast<A *>(mem); // Assignment 
```

上面引用的评论是否属实，如果属实，在什么意义上？构造函数可以在赋值之后执行吗？如果可以，当因为 MT 安全而需要保证订单时，可以采取什么措施？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T21:55:45.547

`a`是一个具有静态存储持续时间的全局对象，因此它将在 main 主体执行之前的某个时间在一些预分配的存储中初始化。假设对 Test 的调用不是某些静态对象构造怪异的结果，`a`将在调用 Test 时完全构造。

```
a = new A; 
```

这种稍微不寻常的分配不会（仅）是标准的复制分配操作，因为您将指针分配`A`给 a，而不是对象或引用。它是否真正编译以及它到底调用了什么取决于是否`A`有一个赋值运算符，它接受一个指向的指针`A`，或者从一个指针隐式转换的东西，`A`或者是否`A`有一个非显式的构造函数，它接受一个指向的指针`A`（或一个指向基的指针类`A`）。

编辑后，您的代码做了一些不同的事情！

从概念上讲，它更像这样：

```
A *tmpa;
void *mem = ::operator new( sizeof(A) ); // ( or possibly A::operator new )

try
{
    tmpa = new (mem) A; // placement new = default constructor call
}
catch (...)
{
    ::operator delete( mem );
    throw;
}

a = tmpa; // pointer assignment won't throw. 
```

写出这样的东西的危险在于，您隐式添加了许多原始序列中不存在的序列点，此外，编译器允许生成看起来不像这样的代码，只要它的行为就执行程序可以确定的情况而言，“好像”它是由 this 编写的。这个“好像”规则仅适用于正在执行的线程，因为（当前）语言没有说明与其他线程的交互是否有效。

为此，您需要使用您的实现提供的特定行为保证（如果有）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T22:06:28.350

问题不在于代码执行时，而更多地与写顺序有关。

让我们假设：

```
A()
{
   member = 7;
} 
```

然后后来：

```
singleton = new A() 
```

这导致代码执行分配，写入内存（成员），然后写入另一个内存位置（单例）。一些 CPU 可以重新排序写入，以便在写入单例之后才能看到对成员的写入 - 本质上，在系统中其他 CPU 上运行的代码可以查看写入单例的内存，但成员是不是。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T22:07:06.163

我认为以下应该工作：

```
void Test()
{
    A *temp = new A;
    MemoryWriteBarrier(); // use whatever memory barrier your platform offers
    a = temp;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-17T22:04:50.053

是的，可以在赋值后调用构造函数，尽管您给出的示例在内部不一致（如评论所述）。

您可以添加一些锁以让您安心，但也很容易弄错。

看

“C++ 和双重检查锁定的危险”

斯科特迈耶斯和安德烈亚历山德雷斯库

[http://www.aristeia.com/Papers/DDJ_Jul_Aug_2004_revised.pdf](http://www.aristeia.com/Papers/DDJ_Jul_Aug_2004_revised.pdf)

# c# - 生成 Word 文档的缩略图

> ID：1009693
> 
> 赞同：7
> 
> 时间：2009-06-17T21:46:20.420
> 
> 标签：c#, ms-word, thumbnails

我有一个用户上传 Word 文档的网站，我想显示这些 Word 文档的缩略图。如果你们中的任何人知道如何使用 C# 将 Word 文件的第一页显示为图像，请告诉我。

此外，如果您知道一个受信任的 .NET 库，可以将 word 文件转换为不需要办公室互操作的图像，那就太好了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T22:06:08.553

看看这篇[文章](http://msdn.microsoft.com/en-us/library/aa289172.aspx)。它在 VB 中，但它允许您提取 Windows 资源管理器用于 Office 文档和常规图像的缩略图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-25T06:44:28.637

[http://blogs.msdn.com/windowssdk/archive/2009/06/12/windows-api-code-pack-for-microsoft-net-framework.aspx](http://blogs.msdn.com/windowssdk/archive/2009/06/12/windows-api-code-pack-for-microsoft-net-framework.aspx)

```
ShellFile shellFile = ShellFile.FromFilePath(pathToYourFile);
Bitmap shellThumb = shellFile.Thumbnail.ExtraLargeBitmap; 
```

这是微软的 API 代码包

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-05T16:40:05.730

我在寻找类似解决方案时发现了这个问题（7 年后）。我正在评估[2JPEG](http://www.2jpeg.com/)，它似乎支持[275 种格式](http://www.2jpeg.com/overview/list-of-supported-file-formats)，包括 Word、Excel、Publisher 和 Powerpoint 文件。fCoder 建议将 2JPEG 作为计划的后台任务运行。命令行[语法](http://www.2jpeg.com/overview/2jpeg-command-line-syntax)非常全面。

这是为特定文件生成缩略图的示例片段：

```
2jpeg.exe -src "c:\files\myfile.docx" -dst "c:\files" -oper Resize size:"100 200" fmode:fit_width -options pages:"1" scansf:no overwrite:yes template:"{Title}_thumb.jpg" silent:yes 
```

# map - Wifi三角测量

> ID：1009703
> 
> 赞同：31
> 
> 时间：2009-06-17T21:47:53.537
> 
> 标签：map, mapping, wireless, wifi, triangulation

什么是被动三角测量无线网络的最佳方法。有可用的工具吗？算法？图书馆？

我的目标是创建使用信号强度 (DB)、信噪比、信号相位等从几个位置点发送或接收信号的各种对象的相对地图。有了足够的采样，我猜有可能创建一个好的 2d/3d 地图。

我正在寻找任何语言/平台的东西。

部分关键词：wi-fi现场调查、可视化、覆盖范围、位置、定位

考虑使用 kismet 来收集数据然后进行处理。也许 2.4Ghz 范围内的 RF 的自由空间路径损耗来计算相对距离。并且可选地尝试使用[射频障碍物衰减估计值](http://www.moonblinkwifi.com/attenuation_at_24ghz_.cfm)（基于一些用户输入）来给出更好的估计。然后使用三边测量生成可能的相对坐标。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-18T00:15:24.830

您不能使用 GPS 技术，因为时间不够准确。您可以做的最好的事情是根据每个基站的信号强度进行[三边测量，并假设范围与信号成正比。](http://en.wikipedia.org/wiki/Trilateration)
您可能需要依次强制连接到每个基站以测量信号强度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-16T01:23:25.477

您可以使用双线性插值代替三边测量。据说这对于非线性距离和城市环境中的 wifi 等信号强度数据更好。[http://courses.cit.cornell.edu/ee476/FinalProjects/s2007/ayl26_ym82/ayl26_ym82/index.htm](http://courses.cit.cornell.edu/ee476/FinalProjects/s2007/ayl26_ym82/ayl26_ym82/index.htm)有背景数学，我假设是 AVR C 用于磁场传感器。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-18T02:34:33.940

有趣的问题。最初的想法是使用[WiSpy](http://www.metageek.net/products/wi-spy_24x)频谱分析仪之类的输出。我喜欢使用定向天线的想法。看起来一些[研究](http://danwells.org/blog/honours-research/wispy-ssm-tool/)（可能）正在进行中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-18T02:22:22.530

使用信号强度来判断距离很容易被阻挡每个采样点视线的材料的差异所抛弃。使用定向天线进行采样可能会更好，并从每个采样点找到使您想要定位的每个设备的信号强度最大化的方位。使用这种技术，您只能使用两个或三个采样位置，具体取决于您可以估计轴承的精度。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-14T03:45:59.070

[Ars Technica 有一篇关于此的文章](http://arstechnica.com/old/content/2008/01/where-gps-wont-do-wifi-triangulation-might.ars)，引用了弗劳恩霍夫研究所和 Skyhooks Wireless。每部 iPhone 和 iPad 都内置了这项技术。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T23:58:30.823

实际上，我认为您应该尝试使用像 GPS 算法（[维基百科](http://en.wikipedia.org/wiki/Global_Positioning_System#Navigation_signals "关联")）这样的算法。当然，您可以根据需要对其进行简化，例如：

*   您需要在应该广播其位置（导航信号）的每个项目上安装一个实际执行它的应用程序
*   您应该为每个项目使用不同的频道，以确保不会产生冲突（这也取决于您广播信号的数量）

因此，如果您放置至少 4 个广播器，您可以对每个客户端进行三角测量，以允许其计算其位置。自然地，广播者应该尽可能地相似作为回应。

顺便说一下，这些只是想法..

# html - 用于将 type=image 的输入与 type=text 的输入垂直对齐的便携式 HTML/CSS？

> ID：1009704
> 
> 赞同：4
> 
> 时间：2009-06-17T21:48:00.010
> 
> 标签：html, css

我正在尝试使用水平布局制作这样的表格：

```
<form id="foo" name="foo" method="post" action="fooaction">
    <p>Enter a foo:
        <input type="text" id="fooText" name="fooText"value=""/>
        <input type="image" name="yes" id="fooSubmitYes" value="1" src="yes.png" title="Yes" width="24" height="24"/>
    <input type="image" name="no" id="fooSubmitNo" value="0" src="no.png" title="No" width="24" height="24"/>
    </p>
</form> 
```

我遇到的问题是第一个输入文本框与文本“Enter a foo:”很好地对齐，但其他两个输入与文本框的对齐很差；它们太高了大约 7 个像素。所有这些元素的边距和填充设置为 0。

如果我在图像输入中添加 align="middle" ，那么它们会向下移动 12 个像素，因此它们太低了 5 个像素，这让我大吃一惊。更令人困惑的是，CSS 的垂直对齐属性不会影响输入元素（他们会忽略它），所以我很难想象如何在 CSS 中解决这个问题。

有谁知道一种浏览器可移植的方式来制作带有标题、输入文本框和两个提交具有水平布局和一致垂直对齐的图像的表单？如果没有，我会选择在 Firefox 中运行的东西 :)（我的 95% 的用户）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T21:51:19.987

添加这个：

```
style='vertical-align: bottom' 
```

元素在 Firefox 和 IE 中对`<input type="image">`我来说看起来不错。

这使得图像的底部边缘与输入框的底部边缘对齐。

（默认情况下它们“太高”的原因是内联图像的底部边缘与文本的基线对齐 - 下方的间隙是为了容纳文本减速器：q、p、g 等）

我不确定是什么让你说“CSS 垂直对齐属性不会影响输入元素”，但它对我有用——也许还有其他问题阻止了它为你工作。

# postgresql - PostgreSQL - “IN”子句中的最大参数数？

> ID：1009706
> 
> 赞同：176
> 
> 时间：2009-06-17T21:48:13.410
> 
> 标签：postgresql

在 Postgres 中，您可以指定一个 IN 子句，如下所示：

```
SELECT * FROM user WHERE id IN (1000, 1001, 1002) 
```

有谁知道您可以传递给 IN 的最大参数数量是多少？

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2009-06-18T00:19:58.767

根据位于[此处的源代码，从第 850 行开始，](http://anoncvs.postgresql.org/cvsweb.cgi/pgsql/src/backend/parser/parse_expr.c?rev=1.226.2.3;only_with_tag=REL8_3_7;ln=1) PostgreSQL 没有明确限制参数的数量。

以下是第 870 行的代码注释：

```
/*
 * We try to generate a ScalarArrayOpExpr from IN/NOT IN, but this is only
 * possible if the inputs are all scalars (no RowExprs) and there is a
 * suitable array type available.  If not, we fall back to a boolean
 * condition tree with multiple copies of the lefthand expression.
 * Also, any IN-list items that contain Vars are handled as separate
 * boolean conditions, because that gives the planner more scope for
 * optimization on such clauses.
 *
 * First step: transform all the inputs, and detect whether any are
 * RowExprs or contain Vars.
 */ 
```

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2017-02-15T13:54:14.140

这并不是当前问题的真正答案，但它也可能对其他人有所帮助。

至少我可以看出，使用 Posgresql 的 JDBC 驱动程序 9.1，PostgreSQL 后端可以传递 32767 个值 (=Short.MAX_VALUE) 的技术限制。

这是使用 postgresql jdbc 驱动程序对“从 x where id in (... 100k values...) 中删除”的测试：

```
Caused by: java.io.IOException: Tried to send an out-of-range integer as a 2-byte value: 100000
    at org.postgresql.core.PGStream.SendInteger2(PGStream.java:201) 
```

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2015-03-11T19:21:31.133

```
explain select * from test where id in (values (1), (2)); 
```

## 查询计划

```
 Seq Scan on test  (cost=0.00..1.38 rows=2 width=208)
   Filter: (id = ANY ('{1,2}'::bigint[])) 
```

但如果尝试第二个查询：

```
explain select * from test where id = any (values (1), (2)); 
```

## 查询计划

```
Hash Semi Join  (cost=0.05..1.45 rows=2 width=208)
       Hash Cond: (test.id = "*VALUES*".column1)
       ->  Seq Scan on test  (cost=0.00..1.30 rows=30 width=208)
       ->  Hash  (cost=0.03..0.03 rows=2 width=4)
             ->  Values Scan on "*VALUES*"  (cost=0.00..0.03 rows=2 width=4) 
```

我们可以看到 postgres 建立临时表并加入它

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2017-12-09T14:50:30.380

作为对 Oracle DB 更有经验的人，我也担心这个限制。我对 -list 中具有 ~10'000 个参数的查询进行了性能测试，*通过实际将所有素数列为查询参数，*`IN`从具有前 100'000 个整数的表中获取最多 100'000 个素数。

 *我的结果表明，**您不必担心查询计划优化器过载或在没有使用索引的情况下获取计划**，因为它将转换查询以使用`= ANY({...}::integer[])`它可以按预期利用索引的地方：

```
-- prepare statement, runs instantaneous:
PREPARE hugeplan (integer, integer, integer, ...) AS
SELECT *
FROM primes
WHERE n IN ($1, $2, $3, ..., $9592);

-- fetch the prime numbers:
EXECUTE hugeplan(2, 3, 5, ..., 99991);

-- EXPLAIN ANALYZE output for the EXECUTE:
"Index Scan using n_idx on primes  (cost=0.42..9750.77 rows=9592 width=5) (actual time=0.024..15.268 rows=9592 loops=1)"
"  Index Cond: (n = ANY ('{2,3,5,7, (...)"
"Execution time: 16.063 ms"

-- setup, should you care:
CREATE TABLE public.primes
(
  n integer NOT NULL,
  prime boolean,
  CONSTRAINT n_idx PRIMARY KEY (n)
)
WITH (
  OIDS=FALSE
);
ALTER TABLE public.primes
  OWNER TO postgres;

INSERT INTO public.primes
SELECT generate_series(1,100000); 
```

[但是， pgsql-hackers 邮件列表上的](https://www.postgresql.org/message-id/1178821226.6034.63.camel@goldbach)这个（相当老的）线程表明，在规划此类查询时仍然存在不可忽略的成本，所以请相信我的话。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2012-10-26T06:55:55.997

传递给 IN 子句的元素数量没有限制。如果有更多元素，它会将其视为数组，然后对于数据库中的每次扫描，它将检查它是否包含在数组中。这种方法不是那么可扩展的。而不是使用 IN 子句尝试将 INNER JOIN 与临时表一起使用。有关更多信息，请参阅[http://www.xaprb.com/blog/2006/06/28/why-large-in-clauses-are-problematic/](http://www.xaprb.com/blog/2006/06/28/why-large-in-clauses-are-problematic/)。使用 INNER JOIN 规模和查询优化器可以利用散列连接和其他优化。而对于 IN 子句，优化器无法优化查询。我注意到这种变化至少加速了 2 倍。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2020-02-03T22:38:41.130

刚试了一下。答案是 -> 超出范围的整数作为 2 字节值：32768

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-10-27T13:29:02.627

如果您有如下查询：

```
SELECT * FROM user WHERE id IN (1, 2, 3, 4 -- and thousands of another keys) 
```

如果重写您的查询，您可能会提高性能：

```
SELECT * FROM user WHERE id = ANY(VALUES (1), (2), (3), (4) -- and thousands of another keys) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-17T21:57:57.790

您可能需要考虑重构该查询，而不是添加任意长的 id 列表...如果 id 确实遵循示例中的模式，则可以使用范围：

```
SELECT * FROM user WHERE id >= minValue AND id <= maxValue; 
```

另一种选择是添加内部选择：

```
SELECT * 
FROM user 
WHERE id IN (
    SELECT userId
    FROM ForumThreads ft
    WHERE ft.id = X
); 
```*

# objective-c - 如何在 Objective C 中删除数组的第一个元素？

> ID：1009709
> 
> 赞同：13
> 
> 时间：2009-06-17T21:48:35.063
> 
> 标签：objective-c, arrays

在Objective C中，是否有一个单行或一些小的东西可以删除（缩短一个）并返回数组的第一个元素，而不考虑它的索引？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-17T21:53:46.363

我不知道返回已删除项目的方法，但您可以使用[`NSArray#objectAtIndex:0`](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSArray_Class/Reference/Reference.html#//apple_ref/occ/instm/NSArray/objectAtIndex:)和的组合来执行此操作[`NSMutableArray#removeObjectAtIndex:0`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/nsmutablearray_Class/Reference/Reference.html#//apple_ref/occ/instm/NSMutableArray/removeObjectAtIndex:)。我想你可以引入一个新的方法类别`NSMutableArray`来实现一个`shift`方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T22:25:09.297

那将是一件糟糕的事情。

iPhone 上的 Objective-C 实际上可以使用 C 的大部分性能优势。

如果您查看我的其他一些帖子，您会发现我坚决反对过早优化，但是当您在 C 级别进行编码时，您不必做一些不必要的事情。

*   移动内存
*   重复结构
*   分配稀疏填充的内存块
*   内循环
*   ...（还有很多，但我的 C-life 生锈了，正如我所说，我反对优化）

您可能想要的是一个实施良好的队列。预先分配足够大的循环内存结构，然后有两个指针跟踪第一个和最后一个字节的东西。

听到 Objective-C 没有队列数据结构，我会感到非常惊讶。

另外，不要为单行而努力。所有关于简洁代码的东西都被高估了。如果调用方法更有意义，那就这样吧。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-03T08:01:50.567

帮助原始海报肯定为时已晚，但如果你有一个普通的 NSArray 而不是 NSMutableArray，这很好用：

```
id myData = myArray.firstObject;
myArray = [myArray subarrayWithRange:NSMakeRange(1, myArray.count - 1)]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T22:15:11.920

Cocoa 数组对象（NSArray/NSMutableArray）不提供单行等效项——您必须先读取对象，然后将其删除。这些类提供了方法[`-lastObject`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/Reference/Reference.html#//apple_ref/occ/instm/NSArray/lastObject)，[`-removeLastObject`](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html#//apple_ref/occ/instm/NSMutableArray/removeLastObject)但不提供，`-firstObject`而且`-removeFirstObject`应该提醒人们，从数组的前面删除通常是一种低效的操作，因为内容必须向前移动（复制）一个位置。对于 C 中的数组尤其如此，它们本质上与指针相关联。

如果您使用的不是原始数据类型和/或非常小的数组，您可能需要考虑“移出”第一个元素的行为表示[队列数据结构](http://en.wikipedia.org/wiki/Queue_(data_structure))。有关如何为对象创建队列的详细信息，请参阅[此 SO question](https://stackoverflow.com/questions/817469/how-do-i-make-and-use-a-queue-in-objective-c)。就个人而言，[我对这个问题的看法](https://stackoverflow.com/questions/817469/how-do-i-make-and-use-a-queue-in-objective-c/973747#973747)是，真正的队列类提供了最简洁的编程习惯。您甚至可以定义自己的方法（可能是 NSMutableArray 或其他类上的一个类别），该方法**确实**提供了一条线来做您想做的事情：

```
@interface NSMutableArray (QueueOneLiner)
  - (id) removeAndReturnFirstObject; // Verbose, but clearer than "shift"
@end

@implementation NSMutableArray (QueueOneLiner)
  - (id) removeAndReturnFirstObject {
    id object = [[self objectAtIndex:0] retain];
    [self removeObjectAtIndex:0];
    return [object autorelease];
  }
@end 
```

但是，到那时，该解决方案可能会导致比其价值更多的开销，具体取决于您对简单性与使用它的代码性能的重视程度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-27T20:02:35.883

如果你有一个数组`obj *arr`，其中`obj`是类/类型名并且`arr`是数组，你可以说`arr+1`获取没有第一个元素的数组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-19T11:10:34.353

使用此代码，

```
 [arrayName removeObjectAtIndex:0]; 
```

这可能会帮助你

# iphone - 分发配置文件是否与 iPhone 设备相关联？

> ID：1009710
> 
> 赞同：0
> 
> 时间：2009-06-17T21:48:59.977
> 
> 标签：iphone

我在 Xcode 中安装了分发（用于 Appstore）配置文件，但它没有显示在设备下，只有开发人员配置文件显示。我也不能在 Xcode 中使用分发配置文件“构建并运行”，但是，“构建”确实有效。

这是正确的行为吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T00:05:09.297

这是正确的。您只能使用此配置文件来构建 App Store 版本。对于您的测试，您需要一个开发配置文件。分发配置文件与您在 iPhone 开发站点上注册的设备无关。

# python - 将 2 暗淡数组“列表列表”输出到 python 中的文本文件

> ID：1009712
> 
> 赞同：3
> 
> 时间：2009-06-17T21:49:26.077
> 
> 标签：python, list, text

简单的问题 - 我正在`ddist = [[0]*d for _ in [0]*d]`使用下面代码中的列表创建一个两个暗淡的数组 ()。它使用 gis 数据输出距离。我只想要一种简单的方法来获取我的数组/列表的结果并输出到一个保持相同 N*N 结构的文本文件。我过去曾使用过 print 语句的输出，但在这种情况下不是一个好的解决方案。

我是通过 SAS 接触 python 的新手。

```
def match_bg():
    #as the name suggests this function will match the variations of blockgroups with grid travel time. Then output into two arras time and distance. 
    count = -1
    countwo = -1
    ctime = -1
    ddist = [[0]*d for _ in [0]*d] #cratesan N*N array list
    dtime = -1

    while count < 10:
        count = count +1
        #j[count][7] = float(j[count][7])
        #j[count][6] = float(j[count][6])
        while countwo < d:
            countwo = countwo+1
            if count < 1:
                #change values in bg file 
                j[countwo][7] = float(j[countwo][7])
                j[countwo][6] = float(j[countwo][6])

            #print j[count], j[countwo]
            while ctime < RowsT:

                #print ctime,  lenth,  t[ctime][0],  count,  countwo
                ctime = ctime + 1

                #takes both verations of big zone which should be end of the file and matches to travetime file - note 0 and 1 for t[] should be same for different files
                if ((j[count][lenth-1] == t[ctime][0]) and (j[countwo][lenth-1] == t[ctime][1])) or ((j[countwo][lenth-1] == t[ctime][0]) and (j[count][lenth-1] == t[ctime][1])):
                    if t[ctime][0] != t[ctime][1]:
                        #jkdljf
                        x1=3963*j[count][7]*(math.pi/180)
                        x2=3963*j[countwo][7]*(math.pi/180)

                        y1=math.cos(j[count][6]*math.pi/180)*3963*j[count][7]*(math.pi/180)
                        y2=math.cos(j[countwo][6]*math.pi/180)*3963*j[countwo][7]*(math.pi/180)

                        dist=math.sqrt(pow(( x1-x2), 2) +  pow((y1-y2), 2))

                        dtime = dist/t[ctime][11]
                        print countwo,  count
                        ddist[count-1][countwo-1] = dist/t[ctime][lenth]
                        print dtime,  "ajusted time",  "not same grid"

                        print 
                    elif j[count][5] != j[countwo][5]:
                        #ljdkjfs
                        x1=3963*j[count][7]*(math.pi/180)
                        x2=3963*j[countwo][7]*(math.pi/180)

                        y1=math.cos(j[count][6]*math.pi/180)*3963*j[count][7]*(math.pi/180)
                        y2=math.cos(j[countwo][6]*math.pi/180)*3963*j[countwo][7]*(math.pi/180)

                        dist=math.sqrt(pow(( x1-x2), 2) +  pow((y1-y2), 2)) # could change to calculation

                        dtime = (dist/.65)/(t[ctime][10]/60.0)

                        print dtime,  dist, "not in the same bg", j[count], j[countwo],  t[ctime]

                    elif j[count][5] == j[countwo][5]:
                        if t[count][7] < 3000000:
                            dtime = 3
                        elif t[count][7] < 20000000:
                            dtime = 8
                        else:
                            dtime = 12
                        print dtime,  "same bg"
                        print t[ctime][0],   t[ctime],  1,  j[count], j[countwo] 
                    else: 
                        print "error is skip logic",   j[count], j[countwo],  t[ctime]
                    break
                #elif (j[countwo][lenth-1] == t[ctime][0]) and (j[count][lenth-1] == t[ctime][1]):
                    #print t[ctime][0],  t[ctime],  2,   j[count], j[countwo]
                    #break

            ctime = -1

        countwo = -1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T22:05:40.240

这就是您可以输出二维列表（或任何二维列表）的方法：

```
with open(outfile, 'w') as file:
    file.writelines('\t'.join(str(j) for j in i) + '\n' for i in top_list) 
```

# iphone - iphone wifi/3G 连接掉线问题

> ID：1009732
> 
> 赞同：3
> 
> 时间：2009-06-17T21:55:36.280
> 
> 标签：iphone

我知道 iPhone 会在 30 分钟后关闭其 WiFi 连接。有什么办法让它活着吗？3G连接怎么样？它会在 30 分钟后关闭其 3G 连接吗？有什么办法可以保持 3G 连接有效吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T22:01:02.730

有时，即使您经常轮询某些东西，也只是保持连接处于活动状态，iPhone 或 iPod 会觉得现在太热而无法使用 WiFi 连接。这可能是正确的，您无法阻止操作系统断开和关闭 WiFi，除非您确实需要当前操作的连接，否则会弹出“重试”对话框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-16T17:09:54.763

由于在搜索 WIFI/WLAN iPhone 问题时此发布率相当高 - 这是答案的链接：[iPhone SDK Internet 连接检测](https://stackoverflow.com/questions/596589/iphone-sdk-internet-connection-detection)

# jquery - 使用 jQuery 按文本内容选择选项

> ID：1009740
> 
> 赞同：76
> 
> 时间：2009-06-17T21:59:02.903
> 
> 标签：jquery

我想为使用 jquery 通过查询字符串传递的任何内容设置一个下拉框。

如何将所选属性添加到选项中，以使“TEXT”值等于查询字符串中的某个参数？

```
 $(document).ready(function() {
        var cat = $.jqURL.get('category');
        if (cat != null) {
            cat = $.URLDecode(cat);
            var $dd = $('#cbCategory');
            var $options = $('option', $dd);
            $options.each(function() {
                if ($(this).text() == cat)
                    $(this).select(); // This is where my problem is
            });
        };
    }); 
```

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2009-06-17T22:01:48.500

替换这个：

```
var cat = $.jqURL.get('category');
var $dd = $('#cbCategory');
var $options = $('option', $dd);
$options.each(function() {
if ($(this).text() == cat)
    $(this).select(); // This is where my problem is
}); 
```

有了这个：

```
$('#cbCategory').val(cat); 
```

调用[`val()`](http://docs.jquery.com/Attributes/val#val)选择列表将自动选择具有该值的选项（如果有）。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-11-30T11:43:22.027

我知道这个问题太老了，但我仍然认为这种方法会更干净：

```
cat = $.URLDecode(cat);
$('#cbCategory option:contains("' + cat + '")').prop('selected', true); 
```

在这种情况下，您不需要使用`each()`. 虽然到那时`prop()`还不存在所以旧版本的 jQuery 使用`attr()`.

* * *

更新

使用时必须确定，`contains`因为您可以找到多个选项，以防里面的字符串`cat`匹配与您打算匹配的选项不同的选项的子字符串。

然后你应该使用：

```
cat = $.URLDecode(cat);
$('#cbCategory option')
    .filter(function(index) { return $(this).text() === cat; })
    .prop('selected', true); 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-06-02T21:01:06.860

如果您的`<option>`元素没有`value`属性，那么您可以使用[`.val`](http://api.jquery.com/val/#val2)：

```
$selectElement.val("text_you're_looking_for") 
```

但是，如果您的`<option>`元素具有值属性，或者将来可能会这样做，那么这将不起作用，因为只要有可能，将通过其属性而不是其文本内容来`.val`选择一个选项。`value`如果选项具有属性，则没有内置的 jQuery 方法可以通过其文本内容选择选项`value`，因此我们必须自己添加一个简单的插件：

```
/*
  Source: https://stackoverflow.com/a/16887276/1709587

  Usage instructions:

  Call

      jQuery('#mySelectElement').selectOptionWithText('target_text');

  to select the <option> element from within #mySelectElement whose text content
  is 'target_text' (or do nothing if no such <option> element exists).
*/
jQuery.fn.selectOptionWithText = function selectOptionWithText(targetText) {
    return this.each(function () {
        var $selectElement, $options, $targetOption;

        $selectElement = jQuery(this);
        $options = $selectElement.find('option');
        $targetOption = $options.filter(
            function () {return jQuery(this).text() == targetText}
        );

        // We use `.prop` if it's available (which it should be for any jQuery
        // versions above and including 1.6), and fall back on `.attr` (which
        // was used for changing DOM properties in pre-1.6) otherwise.
        if ($targetOption.prop) {
            $targetOption.prop('selected', true);
        } 
        else {
            $targetOption.attr('selected', 'true');
        }
    });
} 
```

将 jQuery 添加到页面后，只需在某处包含此插件，然后执行

```
jQuery('#someSelectElement').selectOptionWithText('Some Target Text'); 
```

选择选项。

插件方法用于[`filter`](http://api.jquery.com/filter/)仅挑选`option`匹配的目标文本，并使用`.attr`或选择它`.prop`，具体取决于 jQuery 版本（参见[.prop() 与 .attr()](https://stackoverflow.com/questions/5874652/prop-vs-attr)的解释）。

这是一个 JSFiddle，您可以用它来解决这个问题的所有三个答案，这表明这是唯一一个可靠工作的答案：http: [//jsfiddle.net/3cLm5/1/](http://jsfiddle.net/3cLm5/1/)

# c# - C# - 当表单失去焦点时如何触发不透明度事件？

> ID：1009745
> 
> 赞同：3
> 
> 时间：2009-06-17T22:00:15.740
> 
> 标签：c#, event-handling

目的是在表单失去焦点时触发 opacity 事件。该表单具有 STAY ON TOP 的设置。视觉效果将是单击可能重叠的窗口，但未聚焦时表单将保持在顶部，但在角落中略微透明，使其易于访问，但提供对下方内容的可见性。

我用谷歌搜索和搜索，无法弄清楚如何在表单失去焦点时正确触发此事件，然后当表单重新获得焦点以将不透明度恢复到 100% 或在其他地方确定的级别。

尖端？

```
// under designer.cs

// 
// CollectionToolForm
// 
//other code....
this.LostFocus += new System.EventHandler(goTransparent);

//method
          private void goTransparent(object sender, EventArgs e)
          {
               if (transparentCheck.Checked == true)
               {
                    this.Opacity = 0.50;
               }
               else
               {
                    this.Opacity = 1;
               }

          } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T22:05:44.373

听起来好像您正在寻找[`Activated`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.activated.aspx)and[`Deactivate`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.deactivate.aspx)事件。

**更新**

为了回应关于`LostFocus`事件的评论，澄清它是如何工作的可能会很有趣。的`LostFocus`事件`Form`继承自`Control`。当控件失去焦点时引发；要么是因为表单本身被停用（例如焦点移动到另一个应用程序），要么是因为焦点移动到同一表单中的另一个控件。

如果你为`LostFocus`一个只包含至少一个可以接收焦点的控件的窗体的事件连接一个事件处理程序，你会发现窗体的事件是*在窗体显示后立即*`LostFocus`引发的。这是因为焦点从窗体（即 a ）移动到窗体上的第一个可聚焦控件。*`Control`*

 *因此，处于活动状态的表单和被聚焦的表单是两种不同的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T22:11:30.867

你试过用鼠标进入/离开事件吗？

```
public Form1()
{   
    this.MouseEnter += new System.EventHandler(this.Form1_MouseEnter);
    this.MouseLeave += new System.EventHandler(this.Form1_MouseLeave);
}

private void Form1_MouseLeave(object sender, EventArgs e)
{
    this.Opacity = 0.5;
}

private void Form1_MouseEnter(object sender, EventArgs e)
{
    this.Opacity = 1;
} 
```*

# web-services - 为什么我的 XML ASP.NET Web 服务返回重复的结果？

> ID：1009746
> 
> 赞同：0
> 
> 时间：2009-06-17T22:00:44.430
> 
> 标签：web-services

我编写了一个 ASP.NET Web 服务。

它看起来像这样：

```
 WebServices.logic pLogic = new WebServices.logic();

        WebServices.manager[] pManager = new PowerManager[1];

        pManager[0] = new PowerManager();

        pManager[0].CustomerId = "sjsjshd";
      pManager[0].state = pLogic.getState("sasj");

        return pManager[0]; 
```

pManager 类如下所示：

```
public string _CustomerId;

    public int PowerStatus;

    public List<ArrayList> _Power;

    public string CustomerId
    {
        get
        {
            return _CustomerId;
        }

        set
        {

      _CustomerId = value;
        }
    }

    public List<ArrayList> Power
    {
        get
        {
            return _Power;
        }

        set
        {
            _Power = value;
        }
    } 
```

当我运行它时，我会得到重复的结果，如下所示：

```
<p>
<_CustomerId>sjsjshd</_CustomerId>
<pStatus>0</PowerStatus>
−
<_p>
−
<ArrayOfAnyType>
<anyType xsi:type="xsd:int">1</anyType>
</ArrayOfAnyType>
<ArrayOfAnyType/>
</_p>
<CustomerId>sjsjshd</CustomerId>
−
<p>
−
<ArrayOfAnyType>
<anyType xsi:type="xsd:int">1</anyType>
</ArrayOfAnyType>
<ArrayOfAnyType/>
</p>
</pManager> 
```

但是，没有存储重复的值（例如，我将客户端名称存储在一个集合中，但只存储一次 - 计数为 1）。当我调用 getState() 时没有存储重复项。此方法返回一个集合，它包含一个值，但 XML 中的结果有一个重复。

结果怎么会重复出现？运行系统时，我只收到一个错误。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T22:41:18.170

好的，看起来您的 XML 序列化为您提供了 PowerManager 类的所有公共成员。根据以下划线开头的命名约定，这些成员应该是**private**，如下所示：

```
private string _CustomerId;

private List<ArrayList> _Power; 
```

您还声明“运行系统时，我只收到一个错误。” 你遇到了什么错误？

# javascript - 通过绝对定位元素传递鼠标事件

> ID：1009753
> 
> 赞同：359
> 
> 时间：2009-06-17T22:02:57.653
> 
> 标签：javascript, html, dom, events, dom-events

我正在尝试在一个元素上捕获鼠标事件，该元素上还有另一个绝对定位的元素。

现在，绝对定位元素上的事件击中它并冒泡到它的父级，但我希望它对这些鼠标事件是“透明的”并将它们转发到它后面的任何东西。我应该如何实现这个？

* * *

## 回答 #1

> 赞同：574
> 
> 时间：2011-06-22T14:49:26.090

```
pointer-events: none; 
```

是一个 CSS 属性，它使事件“通过”应用该属性的 HTML 元素。它使事件发生在“下面”的元素上。

详见：[https ://developer.mozilla.org/en-US/docs/Web/CSS/pointer-events](https://developer.mozilla.org/en-US/docs/Web/CSS/pointer-events)

几乎所有浏览器都支持，包括IE11；21 年 5 月全球支持率约为 98.2%）：[http](http://caniuse.com/#feat=pointer-events) : //caniuse.com/#feat=pointer-events（感谢@s4y 在评论中提供链接）。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-06-18T06:08:23.163

如果您只需要鼠标按下，您可以通过以下方式使用该[`document.elementFromPoint`](http://www.quirksmode.org/dom/w3c_cssom.html#documentview)方法：

1.  在 mousedown 上删除顶层，
2.  `x`将事件中的和`y`坐标传递给方法`document.elementFromPoint`以获取下面的元素，然后
3.  恢复顶层。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2014-11-07T11:08:03.390

也很高兴知道...
可以为父元素（可能是透明的 div）禁用指针事件，但为子元素启用。如果您使用多个重叠的 div 层，这将很有帮助，您希望能够单击任何层的子元素。为此，所有育儿 div 获取`pointer-events: none`和点击子获取指针事件重新启用`pointer-events: all`

```
.parent {
    pointer-events:none;        
}
.child {
    pointer-events:all;
}

<div class="some-container">
   <ul class="layer-0 parent">
     <li class="click-me child"></li>
     <li class="click-me child"></li>
   </ul>

   <ul class="layer-1 parent">
     <li class="click-me-also child"></li>
     <li class="click-me-also child"></li>
   </ul>
</div> 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-06-17T22:20:42.627

您没有收到事件的原因是因为绝对定位的元素不是您想要“单击”的元素的子元素（蓝色 div）。我能想到的最干净的方法是将绝对元素作为您想要单击的元素的子元素，但我假设您不能这样做，否则您不会在这里发布这个问题:)

另一种选择是为绝对元素注册一个单击事件处理程序并为蓝色 div 调用单击处理程序，使它们都闪烁。

由于事件通过 DOM 冒泡的方式，我不确定您是否有更简单的答案，但我很好奇是否有人有任何我不知道的技巧！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-03-27T16:51:45.913

有一个可用的 javascript 版本可以手动将事件从一个 div 重定向到另一个。

我把它清理干净并做成了一个 jQuery 插件。

这是 Github 存储库： [https ://github.com/BaronVonSmeaton/jquery.forwardevents](https://github.com/BaronVonSmeaton/jquery.forwardevents)

不幸的是，我使用它的目的 - 在谷歌地图上覆盖蒙版并没有捕获点击和拖动事件，并且鼠标光标没有改变，这会降低用户体验，我只是决定在 IE 和 Opera 下隐藏蒙版 -不支持指针事件的两个浏览器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-02-25T18:02:33.050

如果您知道需要鼠标事件的元素，并且您的叠加层是透明的，您可以将它们的 z-index 设置为高于叠加层的值。在这种情况下，所有事件当然应该在所有浏览器上都有效。

# c++ - 如何在 C++ 中将“string*”转换为“const string&”？

> ID：1009755
> 
> 赞同：1
> 
> 时间：2009-06-17T22:04:07.823
> 
> 标签：c++, pointers, reference, constants

例如，如果我有以下内容：

```
void foo(string* s)
{
    bar(s); // this line fails to compile, invalid init. error
}

void bar(const string& cs)
{
    // stuff happens here
} 
```

我需要进行哪些转换才能使呼叫栏成功？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-17T22:06:10.533

将其更改为：

```
bar(*s); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T22:06:39.067

```
void foo(string* s)
{
    bar(*s);
} 
```

`s`指向一个字符串，并且`bar`需要一个（对 a 的引用）字符串，因此您需要给出指向的`bar`内容。`s`你拼写“what `s`points to”的方式是`*s`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T14:06:24.393

将指针转换为引用时，确保您没有尝试转换 NULL 指针很重要。编译器必须允许您进行转换（因为通常它无法判断它是否是有效的参考）。

```
void foo(string* s)
{
    if(0 != s){
      bar(*s);
    }
} 
```

* 运算符与 & 运算符相反。要将引用转换为指针，请使用 &（地址）。要将指针转换为引用，请使用 *（的内容）。

# wcf - WCF 客户端配置：如何检查端点是否在配置文件中，如果没有则回退到代码？

> ID：1009757
> 
> 赞同：11
> 
> 时间：2009-06-17T22:04:30.460
> 
> 标签：wcf, wcf-client, wcf-configuration

希望制作一个通过 WCF 将序列化消息对象发送回服务器的客户端。

为了让最终开发人员（不同部门）更容易，最好他们不需要知道如何编辑他们的配置文件来设置客户端数据。

也就是说，端点也没有嵌入/硬编码到客户端中也很棒。

在我看来，混合场景是最容易推出的解决方案：

IF（在配置中描述）使用配置文件 ELSE 回退到硬编码端点。

我发现的是：

1.  `new Client();`如果未找到配置文件定义，则失败。
2.  `new Client(binding,endpoint);`作品

所以：

```
Client client;
try {
  client = new Client();
}catch {
  //Guess not defined in config file...
  //fall back to hard coded solution:
  client(binding, endpoint)
} 
```

但是有没有办法*检查*（除了try/catch）来查看配置文件是否声明了一个端点？

如果在配置文件中定义但配置不正确，上述内容是否也会失败？区分这两种情况会很好吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-04-14T16:16:19.837

我想提出[AlexDrenea](https://stackoverflow.com/users/39624/alexdrenea)解决方案的改进版本，它只对配置部分使用特殊类型。

```
Configuration configuration = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
        ServiceModelSectionGroup serviceModelGroup = ServiceModelSectionGroup.GetSectionGroup(configuration);
        if (serviceModelGroup != null)
        {
            ClientSection clientSection = serviceModelGroup.Client;
            //make all your tests about the correcteness of the endpoints here

        } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-18T06:41:40.767

这是读取配置文件并将数据加载到易于管理的对象中的方法：

```
Configuration c = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
ConfigurationSectionGroup csg = c.GetSectionGroup("system.serviceModel");
if (csg != null)
{
    ConfigurationSection css = csg.Sections["client"];
    if (css != null && css is ClientSection)
    {
        ClientSection cs = (ClientSection)csg.Sections["client"];
        //make all your tests about the correcteness of the endpoints here
    }
} 
```

“cs”对象将公开一个名为“endpoints”的集合，允许您访问在配置文件中找到的所有属性。

确保您还将“if”的“else”分支视为失败案例（配置无效）。

# asp.net - 当 ASP.NET Repeater 呈现 Binder.Eval 表 TD 时，如何处理 null 或 string.Empty？

> ID：1009758
> 
> 赞同：0
> 
> 时间：2009-06-17T22:04:47.603
> 
> 标签：asp.net

这是我的情况。我有一个绑定到列表的中继器，它正在呈现表格行。我正在使用 <%# DataBinder.Eval(Container.DataItem, "SomeStringProperty")%> 来显示我的数据。问题是当 SomeStringProperty 为 null、string.Empty 或“”（一些空格）时，我的 TD 的边框不会被渲染。好像它是空的，很丑陋。我不知道如何处理这个。谷歌搜索没有产生答案。也许这里有人可以告诉我。谢谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T22:26:35.643

我会用 Literal 控件替换对 DataBinder.Eval 的调用，并处理 Repeater 的 ItemDataBound 事件 (OnItemDataBound)。在处理程序中，检查项目是否为空，如果是则返回不间断空格`&nbsp;`。

您还可以将 Eval 包装在方法调用中以获得相同的效果：

```
<%# CheckNull(Eval("SomeStringProperty")) %> 
```

在后面的代码中：

```
protected string CheckNull(object value)
{
    return string.IsNullOrEmpty(value) ? "SEE BELOW" : value.ToString();
} 
```

我无法让它正确显示——请参阅下面的内容应替换为`&nbsp;`

如果它来自数据库，您可能需要将值与 System.DBNull.Value 和 string.IsNullOrEmpty 进行比较。

# silverlight - 从网页/应用程序访问本地设备

> ID：1009761
> 
> 赞同：2
> 
> 时间：2009-06-17T22:05:00.943
> 
> 标签：silverlight

我正在设计一个需要我访问连接到机器的设备的应用程序。我们将控制机器，即控制安装的软件和操作系统。

我知道过去可能会建议使用 active-x 控件，我想知道是否有更好的解决方案？我已经研究过 Silverlight 作为替代方案，但没有找到太多支持该设计方法的信息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T23:19:59.357

好吧，理论上，Silverlight 中有 tcp 支持，因此您可以使用它与本地软件对话。实际上，除非您处于调试模式，否则 tcp 不会连接到本地计算机。所以，这是个问题。

人们一直在[做](http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2008/03/27/10291.aspx)的是创建本地 WCF 服务并与之通信。如果您采用这种方法，请不要忘记托管一个跨域文件。

我只想补充一点，如果您可以控制客户端计算机上的内容，WPF 可能是一个更直接的答案:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T23:17:49.017

如果您说的是客户端的机器，Silverlight 不会有太大帮助，因为它是沙盒的。事实上，浏览器和插件被如此锁定，我认为你应该改变你的方法（也许部署你自己的客户端应用程序，而不是使用浏览器/网络应用程序？）

# c# - 如何在保持到目前为止生成的堆栈跟踪的同时重新引发内部异常？

> ID：1009762
> 
> 赞同：19
> 
> 时间：2009-06-17T22:05:13.983
> 
> 标签：c#, .net, exception, exception-handling, stack-trace

重复：[在 C# 中，如何在不丢失堆栈跟踪的情况下重新抛出 InnerException？](https://stackoverflow.com/questions/57383/in-c-how-can-i-rethrow-innerexception-without-losing-stack-trace)

我有一些在后台线程上异步调用的操作。有时，事情会变糟。发生这种情况时，我往往会得到一个 TargetInvocationException，虽然合适，但它却毫无用处。我真正需要的是 TargetInvocationException 的 InnerException，如下所示：

```
 try
    {
        ReturnValue = myFunctionCall.Invoke(Target, Parameters);
    }
    catch (TargetInvocationException err)
    {
        throw err.InnerException;
    } 
```

这样，我的调用者就会收到发生的 REAL 异常。问题是，throw 语句似乎重置了堆栈跟踪。我想基本上重新抛出内部异常，但保留它原来的堆栈跟踪。我怎么做？

**澄清：** 我只想要内部异常的原因是这个类试图“抽象掉”这些函数（由调用者提供的委托）在其他线程上运行的整个事实等等。如果有异常，那么很可能它与在后台线程上运行无关，调用者真的希望堆栈跟踪进入他们的委托并找到真正的问题，而不是我的调用调用。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2010-01-18T10:39:59.790

可以**在**重新抛出之前保留堆栈跟踪而不进行反射：

```
static void PreserveStackTrace (Exception e)
{
    var ctx = new StreamingContext  (StreamingContextStates.CrossAppDomain) ;
    var mgr = new ObjectManager     (null, ctx) ;
    var si  = new SerializationInfo (e.GetType (), new FormatterConverter ()) ;

    e.GetObjectData    (si, ctx)  ;
    mgr.RegisterObject (e, 1, si) ; // prepare for SetObjectData
    mgr.DoFixups       ()         ; // ObjectManager calls SetObjectData

    // voila, e is unmodified save for _remoteStackTraceString
} 
```

与 InternalPreserveStackTrace 相比，这浪费了很多周期，但具有仅依赖公共功能的优势。以下是堆栈跟踪保留函数的一些常见使用模式：

```
// usage (A): cross-thread invoke, messaging, custom task schedulers etc.
catch (Exception e)
{
    PreserveStackTrace (e) ;

    // store exception to be re-thrown later,
    // possibly in a different thread
    operationResult.Exception = e ;
}

// usage (B): after calling MethodInfo.Invoke() and the like
catch (TargetInvocationException tiex)
{
    PreserveStackTrace (tiex.InnerException) ;

    // unwrap TargetInvocationException, so that typed catch clauses 
    // in library/3rd-party code can work correctly;
    // new stack trace is appended to existing one
    throw tiex.InnerException ;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T22:08:32.293

不，那是不可能的。您唯一真正的机会是遵循推荐的模式并使用适当的`InnerException`.

**编辑**

如果您担心的是存在`TargetInvocationException`并且您想忽略它（不是我建议这样做，因为它*很*可能与它在另一个线程上运行的事实有关）那么没有什么能阻止您抛出自己的此处例外，并将`InnerException`from附加`TargetInvocationException`为您自己的`InnerException`. 它有点臭，但它可能会完成你想要的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-17T22:44:12.207

有一种方法可以通过使用用于在使用远程处理时保留服务器端堆栈跟踪的内部机制来“重置”异常堆栈跟踪，但这很可怕：

```
try
{
    // some code that throws an exception...
}
catch (Exception exception)
{
    FieldInfo remoteStackTraceString = typeof(Exception).GetField("_remoteStackTraceString", BindingFlags.Instance | BindingFlags.NonPublic);
    remoteStackTraceString.SetValue(exception, exception.StackTrace);
    throw exception;
} 
```

这会将原始堆栈跟踪放在`_remoteStackTraceString`异常字段中，当重新抛出异常时，它将连接到新重置的堆栈跟踪。

**这确实是一个可怕的 hack**，但它确实实现了你想要的。不过，您正在类内部进行修补，`System.Exception`因此此方法可能因此在框架的后续版本中中断。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T22:11:26.140

尽管您可能会觉得 TargetInvocationException 是“无用的”，但这就是现实。不要试图假装 .NET 没有接受原始异常并用 TargetInvocationException 包装它并抛出它。那真的发生了。有一天，您甚至可能想要来自该包装的一些信息——比如可能引发 TargetInvocationException 的代码的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T22:10:33.460

你不能那样做。`throw`除非不带参数使用，否则总是重置堆栈跟踪。恐怕您的来电者将不得不使用 InnerException ...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-17T22:10:58.123

使用带有异常的“throw”关键字将始终重置堆栈跟踪。

最好的办法是捕捉你想要的实际异常，并使用“throw;” 而不是“扔前;”。或者使用您想要传递的 InnerException 抛出您自己的异常。

我不相信你想做的事情是可能的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T13:33:01.807

正如其他人所说，使用“throw”关键字而不添加它以保持异常链完整。如果您需要原始异常（假设这就是您的意思），那么您可以在链的末尾调用 Exception.GetBaseException() 来获取启动它的异常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-07T07:29:22.313

.net 4.5 可以：

```
catch(Exception e)
{
   ExceptionDispatchInfo.Capture(e.InnerException).Throw();
} 
```

# java - 对于 JCA 和 AES，我应该注意哪些安全地雷？

> ID：1009766
> 
> 赞同：1
> 
> 时间：2009-06-17T22:06:05.213
> 
> 标签：java, encryption, aes

我正在使用带有 AES 的 Java Cryptography API 来加密用于用户识别 cookie 的短文本字符串。

据我了解，与密钥的大小相比，某些加密算法在与少量文本一起使用时并不安全。为了确保我不会让我的数据不安全，我需要知道什么？我是否需要确保要加密的字符串比密钥长？还有其他地雷吗？

要生成密钥，我使用`encryptionType = "AES"`and执行以下操作`keySize = 128`：

```
public SecretKey createKey() throws NoSuchAlgorithmException {
    KeyGenerator keyGen = KeyGenerator.getInstance(encryptionType);
    keyGen.init(keySize); // 192 and 256 bits may not be available
    return keyGen.generateKey();
}

public String encrypt(Key key, String str) throws NoSuchAlgorithmException, NoSuchPaddingException, InvalidKeyException, UnsupportedEncodingException, IllegalBlockSizeException, BadPaddingException {
    Cipher ecipher = Cipher.getInstance(encryptionType);
    ecipher.init(Cipher.ENCRYPT_MODE, key);
    byte[] utf8 = str.getBytes("UTF8");
    byte[] enc = ecipher.doFinal(utf8);
    return new BASE64Encoder().encode(enc);
}

public String decrypt(Key key, String str) throws NoSuchAlgorithmException, NoSuchPaddingException, InvalidKeyException, IOException, IllegalBlockSizeException, BadPaddingException {
    Cipher dcipher = Cipher.getInstance(encryptionType);
    dcipher.init(Cipher.DECRYPT_MODE, key);
    byte[] dec = new BASE64Decoder().decodeBuffer(str);
    byte[] utf8 = dcipher.doFinal(dec);
    return new String(utf8, "UTF8");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T22:22:16.353

您需要熟悉设计安全系统的原则，而不仅仅是选择特定的加密算法。

原则上，AES 设计用于以最小尺寸（16 字节）对数据包进行安全加密。但是你需要注意它在整体安全方案中的使用。注意您的整体协议设计。

例如，我过去听说过一些网络游戏（抱歉找不到参考资料），它加密了所有数据。问题是，它不包括任何“种子”。因此，执行特定操作的命令，例如给玩家额外的生命，每次都是相同的（加密）字节序列。因此，玩家可以复制该数据包，并将其多次重新发送到服务器，而不必知道数据包中包含哪些未加密的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T22:33:24.443

虽然短消息需要填充，但问题没有说明要使用的填充。填充的选择可能会影响某些密码的安全性。

此外，问题中没有指定密码模式。简而言之，随机“消息”，例如随机选择的用户标识符，ECB 模式是安全的，并且具有密码不需要初始化向量的优点。然而，对于大于 16 字节的消息，使用 ECB 模式可以揭示明文中的模式，并且容易受到重放攻击。

使用其他模式（CBC 很常见）将需要为每条消息使用不同的初始化向量。显然，解密需要 IV，这通常会导致它与密文一起传递。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-17T22:24:46.690

您可以从这个[25 个最危险的软件错误](http://www.sans.org/top25errors/)列表开始，它专门指安全错误。

# iphone-sdk-3.0 - 文件中缺少所需的架构臂

> ID：1009772
> 
> 赞同：0
> 
> 时间：2009-06-17T22:06:52.843
> 
> 标签：iphone-sdk-3.0, cfnetwork

当我编译我的应用程序时，我收到一条错误消息，指出

```
/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/CFNetwork.framework/CFNetwork, missing required architecture arm in file. 
```

我检查了所有框架，它们都指向 iPhone 3.0 SDK 框架...

我在这里想念什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-24T11:55:57.097

好的，所以我终于解决了这个问题。解决方案是将“框架搜索路径”和“库搜索路径”设置为“/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS3.0.sdk/System/Frameworks/CFNetwork.framework”

我删除了那里的其他值，它似乎有效。我正在使用更多框架，但似乎只有 CFNetwork 有问题（直到现在:)）。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T22:25:35.673

该路径是您的 Mac 框架之一，它不应该在您的 iPhone 应用程序附近。

转到项目侧栏中的 Targets 并检查“Link Binary with Libraries”下列出的内容。除了 SDK 框架之外，它们都不应该指向其他任何地方。如果您在那里没有发现任何问题，请查看“构建结果”面板，最好是在执行“清理”之后。这应该会给你一些关于正在发生的事情的线索。

# sms - 想要构建相当于 Web 服务器的 SMS

> ID：1009775
> 
> 赞同：1
> 
> 时间：2009-06-17T22:08:18.503
> 
> 标签：sms

我想要一个 SMS 服务，它将传入的 SMS-es 映射到我的服务器的 http 请求，并将我的 HTTP 响应映射到 SMS 回复。有人可以推荐一个向北美提供合理服务的短信网关吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T00:58:03.870

有很多供应商可以提供这个（见谷歌[这里](http://www.google.com/search?q=sms+gateway)或[这里](http://www.google.com/search?q=sms+gateway+developer+api)）。网上也有一些指南，例如“[如何选择 SMS 网关提供商](http://www.developershome.com/sms/howToChooseSMSGateway2.asp)”。

几个看起来很专业的例子（但我没有用过）：

*   [Clickatell](http://www.clickatell.com/)
*   [细胞信托](http://www.celltrust.com/products/sms-gateway/celltrust-2waysms-gateway.html)

# javascript - 确定哪个元素具有焦点

> ID：1009777
> 
> 赞同：2
> 
> 时间：2009-06-17T22:09:01.060
> 
> 标签：javascript, javascript-events

> **可能的重复：**
> [如何确定哪个 html 页面元素具有焦点？](https://stackoverflow.com/questions/483741/how-to-determine-which-html-page-element-has-focus)
> [如何找出哪个 Javascript 元素具有焦点？](https://stackoverflow.com/questions/497094/how-do-i-find-out-which-javascript-element-has-focus)

有没有办法确定文档中的哪个元素当前具有焦点？理想情况下，无需遍历任何元素。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T22:12:08.090

复制：

*   [如何确定哪个html页面元素有焦点？](https://stackoverflow.com/questions/483741/how-to-determine-which-html-page-element-has-focus)
*   [如何找出哪个 Javascript 元素具有焦点？](https://stackoverflow.com/questions/497094/how-do-i-find-out-which-javascript-element-has-focus)

长话短说：

一些浏览器（最初只有 IE，但 Firefox 3 和 Safari 跃跃欲试）支持该`document.activeElement`属性，从而实现您想要的。

对于较旧的浏览器，您需要此 hack 来模拟该属性：

```
function _dom_trackActiveElement(evt) {
    if (evt && evt.target) { 
        document.activeElement = evt.target == document ? null : evt.target;
    }
}

function _dom_trackActiveElementLost(evt) { 
    document.activeElement = null;
}

if (!document.activeElement) {
    document.addEventListener("focus",_dom_trackActiveElement,true);
    document.addEventListener("blur",_dom_trackActiveElementLost,true);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T22:13:05.513

您可以将 onfocus 附加到您的 body 元素，并让焦点更改事件冒泡

# c# - C#、C/C++ 或 Objective-C 中的眼动追踪库

> ID：1009778
> 
> 赞同：11
> 
> 时间：2009-06-17T22:09:45.317
> 
> 标签：c#, c++, c, open-source, eye-tracking

有人知道 C#、C/C++ 或 Objective-C 的眼动追踪库吗？开源更可取。谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T22:22:07.413

[OpenCV](http://opencv.willowgarage.com/wiki/)可能可以做到。它具有执行面部识别的能力，因此眼动追踪可能是其中的一个子集。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T22:26:43.287

[这是一个充满眼球追踪资源的页面](http://www.cogain.org/eyetrackers/low-cost-eye-trackers)，其中许多是开源的。

# c# - 是否仅为当前用户自动检索配置文件数据

> ID：1009788
> 
> 赞同：0
> 
> 时间：2009-06-17T22:12:18.540
> 
> 标签：c#, asp.net, asp.net-profiles

1）我假设配置文件数据只为当前用户自动检索，而其他用户的配置文件数据必须手动检索？

2）我不确定以下引用试图传达什么：

> 如果您在 web.config 文件中定义了序列化配置文件信息中不存在的配置文件，则 ProfileModule 将仅使用默认值

*   我假设“序列化配置文件信息”是指存储在数据库中的配置文件数据？如果是这样，那么我假设引用是指代码第一次访问 Profile 对象并且 Asp.Net 尝试检索完整的配置文件数据的情况？如果该特定配置文件的数据库中没有存储任何配置文件数据，ProfileModule 将返回配置文件属性的默认值？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T22:13:58.820

1.  是的。类的`Profile`属性`Page`返回当前用户的配置文件数据。
2.  是的。

# apache-flex - 使用 NetConnection 和 URLStream 高频发送/接收数据

> ID：1009792
> 
> 赞同：1
> 
> 时间：2009-06-17T22:13:34.483
> 
> 标签：apache-flex, flash, browser

我正在客户端和我自己的手写服务器上使用 Flex 编写一个类似 Comet 的应用程序。

我需要能够以相当高的频率（例如，发送之间的 10 毫秒量级）从客户端发送短脉冲数据。

我还需要服务器以同样高的频率推送短脉冲数据。

我正在使用 NetConnection.call() 将数据发送到服务器，并使用 URLStream（使用分块编码）将数据从服务器推送到客户端。

我发现数据一旦可用就不会被发送/接收。例如，在 IE 中，数据似乎每 200 毫秒发送一次，而不是在调用 NetConnection.call() 后立即发送。同样，URLStream 不会在服务器发送数据后立即提供数据。

从浏览器之间的行为差​​异来看，似乎 Flash Player（第 10 版）依赖于主机浏览器来完成所有通信。谁能证实这一点？**更新**：这很可能是因为只有主机浏览器才会知道可能设置的代理设置。

我尝试过使用 Socket 类，那里的速度没有问题：它工作得很好。但是，我希望能够使用基于 HTTP（端口 80）的连接，以便我的应用程序可以在防火墙严重的环境中运行（我尝试在端口 80 上使用套接字，但这有其问题）。

顺便说一句，所有开发/测试都是在内部 LAN 上完成的，因此带宽/延迟不是问题。

**更新**：发送/接收的数据是小数据包，不需要采用任何特定格式。例如，我可能需要发送一个简短的数字数组，这可以在 AMF 中编码（例如通过 NetConnection.call()），也可以放入 GET 参数中（例如使用 sendToURL()）。我这个问题的重点真的是看看有没有人在频繁调用NetConnection/URLStream时遇到过同样的问题，是否有解决方法（当然也有可能是我的服务器代码的问题，而不是Flash） .

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-21T03:43:48.837

原来这个问题与 Flash/Flex 或任何主机浏览器无关。问题出在我的服务器代码中（在 Linux 上用 C++ 编写），如果无法访问我的源代码，就很难找到原因（所以我不希望从这个论坛得到答案）。

仍然-感谢所有参与的人。

只有在仔细查看[Wireshark](http://www.wireshark.org/)中显示的输出后，我才注意到问题，这是双重的：

### [纳格尔算法](http://en.wikipedia.org/wiki/Nagle%27s_algorithm)

我通过多次调用[write()](http://linux.die.net/man/2/write)来发送多个数据包的回复（例如，一次用于 HTTP 响应标头，再次用于 HTTP 响应正文）。服务器的 TCP/IP 堆栈在发送第二个数据包之前等待第一个数据包的 ACK，但由于 Nagle 算法，客户端在将 ACK 发送回第一个数据包之前等待了 200 毫秒，因此服务器至少需要 200 毫秒才能发送完整的 HTTP 响应。

解决方案是使用带有标志 MSG_MORE 的[send()](http://linux.die.net/man/2/sendto)，直到所有逻辑连接的块都被写入。我也可以将[writev()](http://linux.die.net/man/2/writev)或[setsockopt()](http://linux.die.net/man/2/setsockopt)与 TCP_CORK 一起使用，但它更适合我现有的代码使用[send()](http://linux.die.net/man/2/sendto)。

### 块编码的流

我正在使用带有块编码的永无止境的 HTTP 响应将数据推送回客户端。这里需要关闭 Naggle 的算法，因为即使将每个块写为一个数据包（使用 MSG_MORE），客户端 OS TCP/IP 堆栈仍然会等待长达 200 毫秒，然后再发回 ACK，并且服务器无法推送后续块，直到它获得该 ACK。

这里的解决方案是要求服务器在发送下一个数据包之前不要等待每个发送数据包的 ACK，这是通过调用带有 TCP_NODELAY 标志的[setsockopt()来完成的。](http://linux.die.net/man/2/setsockopt)

上述解决方案仅适用于 Linux，不符合 POSIX（我认为），但这对我来说不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T06:56:42.070

我几乎 100% 确定玩家依赖浏览器进行此类通信。找不到说明如此 atm 的官方页面，但请查看[以下](http://livedocs.adobe.com/livecycle/es/sdkHelp/programmer/lcds/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=security2_03.html)示例：

> 托管 Flash Player ActiveX 控件或 Flash Player 插件的应用程序可以使用 EnforceLocalSecurity 和 DisableLocalSecurity API 调用来控制安全设置。

我认为这在某种程度上暗示了这个想法。此外，我在 FF/IE 上遇到了一些与网络相关的错误，这再次指出玩家使用每个浏览器进行网络连接（否则不会有这样的差异）。

关于你的延迟问题，我认为如果速度很关键，你最好的选择是套接字。您有一些工作要做，但似乎有可能，请再次查看[文档](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/net/Socket.html#Socket())：

> 此错误发生在 SWF 内容中。
> 如果对 Socket.connect() 的调用尝试连接到调用者的安全沙箱之外的服务器或连接到低于 1024 的端口，则调度。您可以通过使用服务器上的跨域策略文件来解决任一问题。

高温下，

胡安

# internet-explorer-8 - 为什么ie8的用户代理返回'opera'？

> ID：1009800
> 
> 赞同：1
> 
> 时间：2009-06-17T22:17:32.837
> 
> 标签：internet-explorer-8, opera, user-agent

我的代码位于：[http](http://www.mgxvideo.com/mgxcopy-dev/get_browser.php) ://www.mgxvideo.com/mgxcopy-dev/get_browser.php ，当我运行 IE8 时返回 Opera。我的来源是：

```
<?php
$browser = get_browser(null, true);
echo $browser['browser'];
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T22:21:41.703

它没有。该`get_browser()`功能正在对用户代理正在运行的浏览器进行有根据的（但消息不灵通）猜测。您的浏览器功能文件可能已过时，可能是因为它是在 IE8 发布之前制作的。[**在这里**](http://browsers.garykeith.com/downloads.asp)更新它。

真正的 IE8 用户代理字符串如下所示：

```
Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-20T14:46:48.573

您应该使用较低级别的工具，例如数据包跟踪或服务器日志记录或标头转储来查看正在发送的内容。

# asp.net-mvc - Linq to Sql中的信号？

> ID：1009801
> 
> 赞同：9
> 
> 时间：2009-06-17T22:17:58.013
> 
> 标签：asp.net-mvc, linq-to-sql, django-signals

有谁知道使用 LINQ to SQL做类似于[Django 的事情的方法？`signals`](http://docs.djangoproject.com/en/dev/topics/signals/)

我正在尝试记录何时插入新行以及何时更新某些列，所以我真的只想`pre_save`发出`post_save`信号。

我可以通过使用像`OnFooIDChanging()`和`OnFooIDChanged()`（其中`FooID`是主键）定义的部分来处理某些模型，但这不适用于主键不是标识或由代码设置的模型。

对于那些，我可能会使用`OnValidate()`，但那只是`pre_save`，并且它使处理数据库变得困难，因为`OnValidate()`被调用 from `DBContext.SubmitChanges()`，这当然不允许`SubmitChanges()`从内部调用第二个，`post_save`就我而言基本上是不可能的可以看到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T02:56:47.060

好的，我已经完全放弃了这个，但我认为我有一个非常酷的解决方案：

首先，将事件处理程序添加到您的数据上下文中，该处理程序将收集所有保存后信号并隐藏该`Dispose`方法，以便我们可以在处理之前立即调用事件。（请注意，我使用`new`关键字而不是`override`。这使得调用事件成为可能。）

```
partial class MyDataContext
{
    internal delegate void PostSaveHandler();
    internal event PostSaveHandler PostSave;

    // This method hides the underlying Dispose because we need to call PostSave.
    public new void Dispose(bool disposing)
    {
        // Obviously necessary error handling omitted for brevity's sake
        PostSave();
        base.Dispose(disposing);
    }
} 
```

接下来，编写一个[T4 模板](http://msdn.microsoft.com/en-us/library/bb126445.aspx)来检查`dbml`Linq to Sql 为您生成的文件。

```
<#
var dbml = XDocument.Load(@"MyDataContext.dbml");
var name = XName.Get("Type", "http://schemas.microsoft.com/linqtosql/dbml/2007");
var tables = from t in dbml.Descendants(name) select t.Attribute("Name").Value;
foreach(var table in tables)
{
#>
    ... 
```

对于数据库中的每个表（以及每个部分类），使用以下方法添加到部分。

```
public partial class Foo
{
    internal void OnInsert(MyDataContext db) {
        PreInsert();
        db.PostSave += delegate { PostInsert(); };
    }
    internal void OnUpdate(MyDataContext db) {
        PreUpdate();
        db.PostSave += delegate { PostUpdate(); };
    }
    internal void OnDelete(MyDataContext db) {
        PreDelete();
        db.PostSave += delegate { PostDelete(); };
    }
    partial void PreInsert();
    partial void PostInsert();
    partial void PreUpdate();
    partial void PostUpdate();
    partial void PreDelete();
    partial void PostDelete();
}

// repeat for all tables 
```

`partial MyDataContext`还通过 T4添加另一个。这将为 Linq to SQL 为您提供的部分方法添加定义（如 Merritt 所述）。

```
public partial class MyDataContext
{
    // Add these three partial methods for each table
    partial void InsertFoo(Foo foo)
    {
        foo.OnInsert(this);
        ExecuteDynamicInsert(foo);
    }
    partial void UpdateFoo(Foo foo)
    {
        foo.OnUpdate(this);
        ExecuteDynamicUpdate(foo);
    }
    partial void DeleteFoo(Foo foo)
    {
        foo.OnDelete(this);
        ExecuteDynamicDelete(foo);
    }

    // ...
} 
```

将这些文件隐藏在安全的地方，这样就没有人试图弄乱它们。

您的信号框架已设置完毕。现在您可以编写信号了。将它们放入`Foo.cs`或全部放在一个`Signals.cs`文件中：

```
partial class Foo
{
    partial void PostInsert()
    {
        EventLog.AddEvent(EventType.FooInserted, this);
    }
} 
```

这有点复杂，所以如果有什么不明白的地方，请发表评论，我会尽力解决它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T14:58:42.580

我有一个比我已经发布的解决方案更简单但无论如何都不起作用的解决方案：覆盖 SubmitChanges(ConflictMode failureMode)：

```
partial class MyDataContext
{
     // SubmitChanges() calls this method after inserting default value for param
     public override void SubmitChanges(ConflictMode failureMode)
     {

          // Pre-Submit Changes

          //Updates            
          for (int changeCounter = 0; changeCounter < this.GetChangeSet().Updates.Count; changeCounter++)
          {                
               var modifiedEntity = this.GetChangeSet().Updates[changeCounter];                
               // Do something, for example:
               // var tableXEntry = new TableX() { Prop1 = "foo" };
               // this.tableXEntries.InsertOnSubmit(tableXEntry );
          }            

          //Inserts            
          for (int changeCounter = 0; changeCounter < this.GetChangeSet().Inserts.Count; changeCounter++)            
          {                
               object modifiedEntity = this.GetChangeSet().Inserts[changeCounter];                
               // Do Something
          }

          // Submit Changes
          base.SubmitChanges(failureMode);

          // Post Submit Changes

          //Updates            
          for (int changeCounter = 0; changeCounter < this.GetChangeSet().Updates.Count; changeCounter++)
          {                
               var modifiedEntity = this.GetChangeSet().Updates[changeCounter];                
               // Do something, for example:
               // var tableXEntry = new TableX() { Prop1 = "foo" };
               // this.tableXEntries.InsertOnSubmit(tableXEntry );
          }            

          //Inserts            
          for (int changeCounter = 0; changeCounter < this.GetChangeSet().Inserts.Count; changeCounter++)            
          {                
               object modifiedEntity = this.GetChangeSet().Inserts[changeCounter];                
               // Do Something
          }
} 
```

使用实体框架，我做的事情与您尝试做的事情类似：保存实体后，我将一个新条目插入到另一个表中以进行审计（它是更改之前实体的副本）。EF 实体容器（如数据上下文）上有一个 SaveChanges() 事件，允许您在保存更改之前添加到当前上下文。

# java - DeadlineExceededException 在 Google App Engine for Java 中是如何实现的？

> ID：1009807
> 
> 赞同：8
> 
> 时间：2009-06-17T22:21:04.437
> 
> 标签：java, http, google-app-engine, servlets

[Google App Engine](http://appengine.google.com/)上的应用程序必须具有在 30 秒内返回响应数据的 Web 请求。当超过这个时间时，`DeadlineExceededException`会抛出异常：

```
/time.jsp
java.lang.ClassCastException: com.google.apphosting.api.DeadlineExceededException cannot be cast to javax.servlet.ServletException
    at org.apache.jasper.runtime.PageContextImpl.handlePageException(PageContextImpl.java:754)
    at org.apache.jsp.time_jsp._jspService(time_jsp.java:66)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:94)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:806)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1093)
    at com.google.apphosting.runtime.jetty.SaveSessionFilter.doFilter(SaveSessionFilter.java:35)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)
    at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:360)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:712)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)
    at com.google.apphosting.runtime.jetty.AppVersionHandlerMap.handle(AppVersionHandlerMap.java:237)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:139)
    at org.mortbay.jetty.Server.handle(Server.java:313)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:506)
    at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:830)
    at com.google.apphosting.runtime.jetty.RpcRequestParser.parseAvailable(RpcRequestParser.java:76)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:381)
    at com.google.apphosting.runtime.jetty.JettyServletEngineAdapter.serviceRequest(JettyServletEngineAdapter.java:125)
    at com.google.apphosting.runtime.JavaRuntime.handleRequest(JavaRuntime.java:235)
    at com.google.apphosting.base.RuntimePb$EvaluationRuntime$6.handleBlockingRequest(RuntimePb.java:4755)
    at com.google.apphosting.base.RuntimePb$EvaluationRuntime$6.handleBlockingRequest(RuntimePb.java:4753)
    at com.google.net.rpc.impl.BlockingApplicationHandler.handleRequest(BlockingApplicationHandler.java:24)
    at com.google.net.rpc.impl.RpcUtil.runRpcInApplication(RpcUtil.java:359)
    at com.google.net.rpc.impl.Server$2.run(Server.java:800)
    at com.google.tracing.LocalTraceSpanRunnable.run(LocalTraceSpanRunnable.java:56)
    at com.google.tracing.LocalTraceSpanBuilder.internalContinueSpan(LocalTraceSpanBuilder.java:510)
    at com.google.net.rpc.impl.Server.startRpc(Server.java:756)
    at com.google.net.rpc.impl.Server.processRequest(Server.java:348)
    at com.google.net.rpc.impl.ServerConnection.messageReceived(ServerConnection.java:459)
    at com.google.net.rpc.impl.RpcConnection.parseMessages(RpcConnection.java:319)
    at com.google.net.rpc.impl.RpcConnection.dataReceived(RpcConnection.java:290)
    at com.google.net.async.Connection.handleReadEvent(Connection.java:419)
    at com.google.net.async.EventDispatcher.processNetworkEvents(EventDispatcher.java:762)
    at com.google.net.async.EventDispatcher.internalLoop(EventDispatcher.java:207)
    at com.google.net.async.EventDispatcher.loop(EventDispatcher.java:101)
    at com.google.net.rpc.RpcService.runUntilServerShutdown(RpcService.java:251)
    at com.google.apphosting.runtime.JavaRuntime$RpcRunnable.run(JavaRuntime.java:373)
    at java.lang.Thread.run(Unknown Source) 
```

它是如何完成的？你有任何开源代码吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-05T21:50:34.057

> [请求计时器](http://code.google.com/appengine/docs/java/runtime.html#The_Request_Timer)
> 
> 请求处理程序生成并返回对请求的响应的时间有限，通常约为 30 秒。一旦达到最后期限，请求处理程序就会被中断。
> 
> **Java 运行时环境**通过 抛出 com.google.apphosting.api.DeadlineExceededException 来中断 servlet。如果请求处理程序没有捕获此异常，就像所有未捕获的异常一样，运行时环境将向客户端返回 HTTP 500 服务器错误。
> 
> 请求处理程序可以捕获此错误以自定义响应。在引发异常以准备自定义响应后，运行时环境为请求处理程序提供了更多时间（不到一秒）。
> 
> 虽然请求可能需要长达 30 秒才能响应，但 App Engine 已针对具有短暂请求（通常需要几百毫秒）的应用程序进行了优化。高效的应用程序可以快速响应大多数请求。一个不能很好地与 App Engine 的基础架构一起扩展的应用程序。

运行时的一部分 == 不使用线程。这个功能肯定是对 VM 的修改，我不会屏住呼吸等待源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T10:53:08.680

我想这个异常背后的机制是在应用引擎基础设施中实现的，而不是开源的。

但是，您可以将此功能用于网络或更一般地使用[java.nio](http://java.sun.com/javase/6/docs/api/java/nio/package-summary.html)的任何 I/O 有界代码（例如[Selector](http://java.sun.com/javase/6/docs/api/java/nio/channels/Selector.html)）。对于 CPU 受限代码，您可以使用[java.util.concurrent](http://java.sun.com/javase/6/docs/api/java/util/concurrent/package-summary.html)（例如[Future](http://java.sun.com/javase/6/docs/api/java/util/concurrent/Future.html)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-16T09:36:52.607

这可以按如下方式完成，使用[非阻塞 IO](http://java.sun.com/j2se/1.5.0/docs/guide/nio/)并创建一个看门狗线程，该线程记录启动时间并在经过的时间过去时抛出异常。非阻塞 IO 教程展示了如何使用[Ping.java](http://java.sun.com/j2se/1.5.0/docs/guide/nio/example/Ping.java)示例完成此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-02T18:42:46.763

可能是一个很晚的回复，但对新学习者很有用。

```
@Override
protected final void doGet(final HttpServletRequest req, final HttpServletResponse res) throws IOException {

    res.setContentType("text/html");
    final PrintWriter out = res.getWriter();
    final String a = req.getParameter("a");
    try {

        for (int i = 0; 1 < 5; i++) {
            out.print("Mode " + a + " Running " + i + " " + MainServlon.doubleIt(i));
            Thread.sleep(90000);
        }

    } catch (final InterruptedException e) {
        e.printStackTrace();
    } catch (final DeadlineExceededException e) {
        out.print("Train is going to stop. Let me close this story for now!");
    }

} 
```

# javascript - Enter 按键的行为类似于 Javascript 中的 Tab

> ID：1009808
> 
> 赞同：81
> 
> 时间：2009-06-17T22:21:39.303
> 
> 标签：javascript, html, cross-browser, dom-events

我正在寻找创建一个表单，其中按 Enter 键会导致焦点转到页面上的“下一个”表单元素。我一直在网上找到的解决方案是......

```
 <body onkeydown="if(event.keyCode==13){event.keyCode=9; return event.keyCode}"> 
```

不幸的是，这似乎只适用于 IE。所以这个问题的真正实质是是否有人知道适用于 FF 和 Chrome 的解决方案？此外，我宁愿不必将*onkeydown*事件添加到表单元素本身，但如果这是唯一的方法，它就必须这样做。

这个问题与[问题 905222](https://stackoverflow.com/questions/905222/javascriptenter-key-press-event)类似，但在我看来，值得提出自己的问题。

编辑：另外，我看到人们提出这不是好的风格，因为它与用户习惯的表单行为不同。我同意！这是一个客户请求:(

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-08-26T13:24:36.330

我使用了 Andrew 建议的逻辑，非常有效。这是我的版本：

```
$('body').on('keydown', 'input, select', function(e) {
    if (e.key === "Enter") {
        var self = $(this), form = self.parents('form:eq(0)'), focusable, next;
        focusable = form.find('input,a,select,button,textarea').filter(':visible');
        next = focusable.eq(focusable.index(this)+1);
        if (next.length) {
            next.focus();
        } else {
            form.submit();
        }
        return false;
    }
}); 
```

KeyboardEvent 的 keycode（即：）`e.keycode`折旧通知：- [https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/keyCode](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/keyCode)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2016-12-30T08:20:01.490

我想出的最简单的香草 JS 片段：

```
document.addEventListener('keydown', function (event) {
  if (event.keyCode === 13 && event.target.nodeName === 'INPUT') {
    var form = event.target.form;
    var index = Array.prototype.indexOf.call(form, event.target);
    form.elements[index + 1].focus();
    event.preventDefault();
  }
}); 
```

适用于 IE 9+ 和现代浏览器。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-12-18T11:21:33.293

## 映射 [Enter] 键以像 [Tab] 键一样工作

我用 jQuery 重写[了 Andre Van Zuydam](https://stackoverflow.com/users/714905/andre-van-zuydam)的答案，这对我不起作用。这会同时捕获`Enter`和`Shift`+ `Enter`。 `Enter`向前制表符，`Shift`+`Enter`向后制表符。

我还重写了`self`当前焦点项初始化的方式。表格也是这样选择的。这是代码：

```
// Map [Enter] key to work like the [Tab] key
// Daniel P. Clark 2014

// Catch the keydown for the entire document
$(document).keydown(function(e) {

  // Set self as the current item in focus
  var self = $(':focus'),
      // Set the form by the current item in focus
      form = self.parents('form:eq(0)'),
      focusable;

  // Array of Indexable/Tab-able items
  focusable = form.find('input,a,select,button,textarea,div[contenteditable=true]').filter(':visible');

  function enterKey(){
    if (e.which === 13 && !self.is('textarea,div[contenteditable=true]')) { // [Enter] key

      // If not a regular hyperlink/button/textarea
      if ($.inArray(self, focusable) && (!self.is('a,button'))){
        // Then prevent the default [Enter] key behaviour from submitting the form
        e.preventDefault();
      } // Otherwise follow the link/button as by design, or put new line in textarea

      // Focus on the next item (either previous or next depending on shift)
      focusable.eq(focusable.index(self) + (e.shiftKey ? -1 : 1)).focus();

      return false;
    }
  }
  // We need to capture the [Shift] key and check the [Enter] key either way.
  if (e.shiftKey) { enterKey() } else { enterKey() }
}); 
```

## 原因**`textarea`**

包含在内是因为我们“**确实**”想要加入它。此外，一旦进入，我们不想阻止默认行为`Enter`插入新行。

## 原因**`a`**和**`button`**

允许默认操作，“**和**”仍然专注于下一项，是因为它们并不总是加载另一个页面。可以对诸如手风琴或选项卡式内容之类的内容产生触发/影响。因此，一旦您触发了默认行为，并且页面产生了特殊效果，您仍然希望转到下一项，因为您的触发器可能已经很好地介绍了它。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-11-20T14:50:18.733

谢谢你的好剧本。

我刚刚在上述函数上添加了 shift 事件以在元素之间返回，我想有人可能需要这个。

```
$('body').on('keydown', 'input, select, textarea', function(e) {
var self = $(this)
  , form = self.parents('form:eq(0)')
  , focusable
  , next
  , prev
  ;

if (e.shiftKey) {
 if (e.keyCode == 13) {
     focusable =   form.find('input,a,select,button,textarea').filter(':visible');
     prev = focusable.eq(focusable.index(this)-1); 

     if (prev.length) {
        prev.focus();
     } else {
        form.submit();
    }
  }
}
  else
if (e.keyCode == 13) {
    focusable = form.find('input,a,select,button,textarea').filter(':visible');
    next = focusable.eq(focusable.index(this)+1);
    if (next.length) {
        next.focus();
    } else {
        form.submit();
    }
    return false;
}
}); 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2016-10-20T05:59:27.987

这对我有用：

```
$(document).on('keydown', ':tabbable', function(e) {

    if (e.key === "Enter") {
        e.preventDefault();

        var $canfocus = $(':tabbable:visible');
        var index = $canfocus.index(document.activeElement) + 1;

        if (index >= $canfocus.length) index = 0;
        $canfocus.eq(index).focus();
    }

}); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-11-12T19:48:18.760

这里给出的所有实现都存在问题。有些不能正常使用 textareas 和提交按钮，大多数不允许您使用 shift 向后退，如果您有它们，它们都不会使用 tabindexes，并且它们都不会从最后一个到第一个或第一个环绕到最后。

要使 [enter] 键的作用类似于 [tab] 键，但仍可与文本区域和提交按钮正常工作，请使用以下代码。此外，此代码允许您使用 shift 键向后移动，并且制表符从前到后和从后到前环绕。

源代码：[https ://github.com/mikbe/SaneEnterKey](https://github.com/mikbe/SaneEnterKey)

### 咖啡脚本

```
mbsd_sane_enter_key = ->
  input_types = "input, select, button, textarea"
  $("body").on "keydown", input_types, (e) ->
    enter_key = 13
    tab_key = 9

    if e.keyCode in [tab_key, enter_key]
      self = $(this)

      # some controls should just press enter when pressing enter
      if e.keyCode == enter_key and (self.prop('type') in ["submit", "textarea"])
        return true

      form = self.parents('form:eq(0)')

      # Sort by tab indexes if they exist
      tab_index = parseInt(self.attr('tabindex'))
      if tab_index
        input_array = form.find("[tabindex]").filter(':visible').sort((a,b) -> 
          parseInt($(a).attr('tabindex')) - parseInt($(b).attr('tabindex'))
        )
      else
        input_array = form.find(input_types).filter(':visible')

      # reverse the direction if using shift
      move_direction = if e.shiftKey then -1 else 1
      new_index = input_array.index(this) + move_direction

      # wrap around the controls
      if new_index == input_array.length
        new_index = 0
      else if new_index == -1
        new_index = input_array.length - 1

      move_to = input_array.eq(new_index)
      move_to.focus()
      move_to.select()

      false

$(window).on 'ready page:load', ->
  mbsd_sane_enter_key() 
```

### JavaScript

```
var mbsd_sane_enter_key = function() {
  var input_types;
  input_types = "input, select, button, textarea";

  return $("body").on("keydown", input_types, function(e) {
    var enter_key, form, input_array, move_direction, move_to, new_index, self, tab_index, tab_key;
    enter_key = 13;
    tab_key = 9;

    if (e.keyCode === tab_key || e.keyCode === enter_key) {
      self = $(this);

      // some controls should react as designed when pressing enter
      if (e.keyCode === enter_key && (self.prop('type') === "submit" || self.prop('type') === "textarea")) {
        return true;
      }

      form = self.parents('form:eq(0)');

      // Sort by tab indexes if they exist
      tab_index = parseInt(self.attr('tabindex'));
      if (tab_index) {
        input_array = form.find("[tabindex]").filter(':visible').sort(function(a, b) {
          return parseInt($(a).attr('tabindex')) - parseInt($(b).attr('tabindex'));
        });
      } else {
        input_array = form.find(input_types).filter(':visible');
      }

      // reverse the direction if using shift
      move_direction = e.shiftKey ? -1 : 1;
      new_index = input_array.index(this) + move_direction;

      // wrap around the controls
      if (new_index === input_array.length) {
        new_index = 0;
      } else if (new_index === -1) {
        new_index = input_array.length - 1;
      }

      move_to = input_array.eq(new_index);
      move_to.focus();
      move_to.select();
      return false;
    }
  });
};

$(window).on('ready page:load', function() {
  mbsd_sane_enter_key();
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-10-04T16:17:56.333

更改此行为实际上会创建比本机实现的默认行为更好的用户体验。考虑回车键的行为从用户的角度来看已经不一致，因为在单行输入中，回车倾向于提交表单，而在多行文本区域中，它只是在内容中添加换行符场地。

我最近这样做（使用 jQuery）：

```
$('input.enterastab, select.enterastab, textarea.enterastab').live('keydown', function(e) {
 if (e.keyCode==13) {
  var focusable = $('input,a,select,button,textarea').filter(':visible');
  focusable.eq(focusable.index(this)+1).focus();
  return false;
 }
}); 
```

这不是非常有效，但运行良好且可靠 - 只需将“enterastab”类添加到应该以这种方式运行的任何输入元素。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-04-11T22:56:04.617

我将 OPs 解决方案重新设计为 Knockout 绑定，并认为我会分享它。非常感谢 ：-）

[这是](http://jsfiddle.net/damiensawyer/AWNxq/)一个小提琴

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-2.2.1.js" type="text/javascript"></script>

</head>
<body>

    <div data-bind="nextFieldOnEnter:true">
        <input type="text" />
        <input type="text" />
        <select>
          <option value="volvo">Volvo</option>
          <option value="saab">Saab</option>
          <option value="mercedes">Mercedes</option>
          <option value="audi">Audi</option>
        </select>
        <input type="text" />
        <input type="text" />
    </div>

    <script type="text/javascript">
    ko.bindingHandlers.nextFieldOnEnter = {
        init: function(element, valueAccessor, allBindingsAccessor) {
            $(element).on('keydown', 'input, select', function (e) {
                var self = $(this)
                , form = $(element)
                  , focusable
                  , next
                ;
                if (e.keyCode == 13) {
                    focusable = form.find('input,a,select,button,textarea').filter(':visible');
                    var nextIndex = focusable.index(this) == focusable.length -1 ? 0 : focusable.index(this) + 1;
                    next = focusable.eq(nextIndex);
                    next.focus();
                    return false;
                }
            });
        }
    };

    ko.applyBindings({});
    </script>
</body>
</html> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-01-21T21:05:07.447

这是一个 angular.js 指令，使用其他答案作为灵感，使输入进入下一个字段。这里可能有一些看起来很奇怪的代码，因为我只使用 angular 打包的 jQlite。我相信这里的大部分功能都适用于所有浏览器> IE8。

```
angular.module('myapp', [])
.directive('pdkNextInputOnEnter', function() {
    var includeTags = ['INPUT', 'SELECT'];

    function link(scope, element, attrs) {
        element.on('keydown', function (e) {
            // Go to next form element on enter and only for included tags
            if (e.keyCode == 13 && includeTags.indexOf(e.target.tagName) != -1) {
                // Find all form elements that can receive focus
                var focusable = element[0].querySelectorAll('input,select,button,textarea');

                // Get the index of the currently focused element
                var currentIndex = Array.prototype.indexOf.call(focusable, e.target)

                // Find the next items in the list
                var nextIndex = currentIndex == focusable.length - 1 ? 0 : currentIndex + 1;

                // Focus the next element
                if(nextIndex >= 0 && nextIndex < focusable.length)
                    focusable[nextIndex].focus();

                return false;
            }
        });
    }

    return {
        restrict: 'A',
        link: link
    };
}); 
```

这是我在正在开发的应用程序中使用它的方法，只需`pdk-next-input-on-enter`在元素上添加指令即可。我正在使用条形码扫描仪将数据输入字段，扫描仪的默认功能是模拟键盘，在输入扫描的条形码数据后注入一个回车键。

此代码有一个副作用（对我的用例来说是一个积极的影响），如果它将焦点移到按钮上，则 enter keyup 事件将导致按钮的操作被激活。这对我的流程非常有效，因为我的标记中的最后一个表单元素是一个按钮，一旦通过扫描条形码“标记”了所有字段，我希望激活该按钮。

```
<!DOCTYPE html>
<html ng-app=myapp>
  <head>
      <script src="angular.min.js"></script>
      <script src="controller.js"></script>
  </head>
  <body ng-controller="LabelPrintingController">
      <div class='.container' pdk-next-input-on-enter>
          <select ng-options="p for p in partNumbers" ng-model="selectedPart" ng-change="selectedPartChanged()"></select>
          <h2>{{labelDocument.SerialNumber}}</h2>
          <div ng-show="labelDocument.ComponentSerials">
              <b>Component Serials</b>
              <ul>
                  <li ng-repeat="serial in labelDocument.ComponentSerials">
                      {{serial.name}}<br/>
                      <input type="text" ng-model="serial.value" />
                  </li>
              </ul>
          </div>
          <button ng-click="printLabel()">Print</button>
      </div>
  </body>
</html> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-02-17T12:15:23.473

我遇到了类似的问题，我想按`+`小键盘以跳到下一个字段。现在我发布了一个我认为会对你有所帮助的库。

> [PlusAsTab](https://joelpurra.com/projects/plusastab/) : 一个 jQuery 插件，使用小键盘加键作为 Tab 键等效项。

由于您想要`enter`/`↵`而不是，您可以设置选项。找出你想在[jQuery event.which 演示](https://api.jquery.com/event.which/)中使用哪个键。

```
JoelPurra.PlusAsTab.setOptions({
  // Use enter instead of plus
  // Number 13 found through demo at
  // https://api.jquery.com/event.which/
  key: 13
});

// Matches all inputs with name "a[]" (needs some character escaping)
$('input[name=a\\[\\]]').plusAsTab(); 
```

您可以在[PlusAsTab 中自己尝试一下 enter as tab demo](https://joelpurra.com/projects/plusastab/docs/example/enter-as-tab.html)。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-04-26T20:32:17.793

试试这个...

```
$(document).ready(function () {
    $.fn.enterkeytab = function () {
        $(this).on('keydown', 'input,select,text,button', function (e) {
            var self = $(this)
              , form = self.parents('form:eq(0)')
              , focusable
              , next
            ;
            if (e.keyCode == 13) {
                focusable = form.find('input,a,select').filter(':visible');
                next = focusable.eq(focusable.index(this) + 1);
                if (next.length) {
                    //if disable try get next 10 fields
                    if (next.is(":disabled")){
                        for(i=2;i<10;i++){
                            next = focusable.eq(focusable.index(this) + i);
                            if (!next.is(":disabled"))
                                break;
                        }
                    }
                    next.focus();
                }
                return false;
            }
        });
    }
    $("form").enterkeytab();
}); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-01-11T13:18:52.503

```
function return2tab (div)
{
    document.addEventListener('keydown', function (ev) {
        if (ev.key === "Enter" && ev.target.nodeName === 'INPUT') {

            var focusableElementsString = 'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex="0"], [contenteditable]';

            let ol= div.querySelectorAll(focusableElementsString);

            for (let i=0; i<ol.length; i++) {
                if (ol[i] === ev.target) {
                    let o= i<ol.length-1? ol[i+1]: o[0];
                    o.focus(); break;
                }
            }
            ev.preventDefault();
        }
    });
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-18T09:26:24.893

如果可以的话，我会重新考虑这样做：`<Enter>`在表单中按下时的默认操作会提交表单，并且您为更改此默认操作/预期行为所做的任何事情都可能导致网站出现一些可用性问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-03-17T12:57:54.307

我让它只在 JavaScript 中工作。Firefox 不会让您更新 keyCode，因此您所能做的就是捕获 keyCode 13 并强制它通过 tabIndex 将注意力集中在下一个元素上，就像按下 keyCode 9 一样。棘手的部分是找到下一个 tabIndex。我仅在 IE8-IE10 和 Firefox 上对此进行了测试，并且可以正常工作：

```
function ModifyEnterKeyPressAsTab(event)
{
    var caller;
    var key;
    if (window.event)
    {
        caller = window.event.srcElement; //Get the event caller in IE.
        key = window.event.keyCode; //Get the keycode in IE.
    }
    else
    {
        caller = event.target; //Get the event caller in Firefox.
        key = event.which; //Get the keycode in Firefox.
    }
    if (key == 13) //Enter key was pressed.
    {
        cTab = caller.tabIndex; //caller tabIndex.
        maxTab = 0; //highest tabIndex (start at 0 to change)
        minTab = cTab; //lowest tabIndex (this may change, but start at caller)
        allById = document.getElementsByTagName("input"); //Get input elements.
        allByIndex = []; //Storage for elements by index.
        c = 0; //index of the caller in allByIndex (start at 0 to change)
        i = 0; //generic indexer for allByIndex;
        for (id in allById) //Loop through all the input elements by id.
        {
            allByIndex[i] = allById[id]; //Set allByIndex.
            tab = allByIndex[i].tabIndex;
            if (caller == allByIndex[i])
                c = i; //Get the index of the caller.
            if (tab > maxTab)
                maxTab = tab; //Get the highest tabIndex on the page.
            if (tab < minTab && tab >= 0)
                minTab = tab; //Get the lowest positive tabIndex on the page.
            i++;
        }
        //Loop through tab indexes from caller to highest.
        for (tab = cTab; tab <= maxTab; tab++)
        {
            //Look for this tabIndex from the caller to the end of page.
            for (i = c + 1; i < allByIndex.length; i++)
            {
                if (allByIndex[i].tabIndex == tab)
                {
                    allByIndex[i].focus(); //Move to that element and stop.
                    return;
                }
            }
            //Look for the next tabIndex from the start of page to the caller.
            for (i = 0; i < c; i++)
            {
                if (allByIndex[i].tabIndex == tab + 1)
                {
                    allByIndex[i].focus(); //Move to that element and stop.
                    return;
                }
            }
            //Continue searching from the caller for the next tabIndex.
        }

        //The caller was the last element with the highest tabIndex,
        //so find the first element with the lowest tabIndex.
        for (i = 0; i < allByIndex.length; i++)
        {
            if (allByIndex[i].tabIndex == minTab)
            {
                allByIndex[i].focus(); //Move to that element and stop.
                return;
            }
        }
    }
} 
```

要使用此代码，请将其添加到您的 html 输入标记中：

```
<input id="SomeID" onkeydown="ModifyEnterKeyPressAsTab(event);" ... > 
```

或者将其添加到 javascript 中的元素中：

```
document.getElementById("SomeID").onKeyDown = ModifyEnterKeyPressAsTab; 
```

**其他几点注意事项：**

我只需要它来处理我的输入元素，但如果需要，您可以将它扩展到其他文档元素。为此，getElementsByClassName 非常有帮助，但那是另一个话题了。

一个限制是它仅在您添加到 allById 数组的元素之间使用制表符。它不会围绕您的浏览器可能的其他内容进行选项卡，例如 html 文档之外的工具栏和菜单。也许这是一个功能而不是限制。如果您愿意，请捕获 keyCode 9，此行为也适用于 tab 键。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-07-31T15:34:56.037

> 你可以使用下面我的代码，在 Mozilla、IE 和 Chrome 中测试过

```
 // Use to act like tab using enter key
    $.fn.enterkeytab=function(){
         $(this).on('keydown', 'input, select,', function(e) {
        var self = $(this)
          , form = self.parents('form:eq(0)')
          , focusable
          , next
          ;
            if (e.keyCode == 13) {
                focusable = form.find('input,a,select,button').filter(':visible');
                next = focusable.eq(focusable.index(this)+1);
                if (next.length) {
                    next.focus();
                } else {
                    alert("wd");
                    //form.submit();
                }
                return false;
            }
        });

    } 
```

如何使用？

> $("#form").enterkeytab(); // 进入键选项卡

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-02-16T08:21:51.580

Vanilla js 支持 Shift + Enter 并能够选择哪些 HTML 标记是可聚焦的。应该工作IE9 +。

```
 onKeyUp(e) {
    switch (e.keyCode) {
      case 13: //Enter
        var focusableElements = document.querySelectorAll('input, button')
        var index = Array.prototype.indexOf.call(focusableElements, document.activeElement)
        if(e.shiftKey)
          focus(focusableElements, index - 1)
        else
          focus(focusableElements, index + 1)

        e.preventDefault()
        break;
    }
    function focus(elements, index) {
      if(elements[index])
        elements[index].focus()
    }
  } 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-05-06T09:33:34.653

`e.keyCode`此处使用的许多答案`e.which`已被弃用。

相反，您应该使用`e.key === 'Enter'`.

文档：[https ://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/keyCode](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/keyCode)

*   很抱歉，我现在无法测试这些片段。测试后会回来。

使用 HTML：

```
<body onkeypress="if(event.key==='Enter' && event.target.form){focusNextElement(event); return false;}"> 
```

使用 jQuery：

```
$(window).on('keypress', function (ev)
{
    if (ev.key === "Enter" && ev.currentTarget.form) focusNextElement(ev)
} 
```

使用香草 JS：

```
document.addEventListener('keypress', function (ev) {
    if (ev.key === "Enter" && ev.currentTarget.form) focusNextElement(ev);
}); 
```

您可以`focusNextElement()`从这里获取功能： [https ://stackoverflow.com/a/35173443/3356679](https://stackoverflow.com/a/35173443/3356679)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-05-10T22:25:24.847

这就是我想出的。

```
form.addEventListener("submit", (e) => { //On Submit
 let key = e.charCode || e.keyCode || 0 //get the key code
 if (key = 13) { //If enter key
    e.preventDefault()
    const inputs = Array.from(document.querySelectorAll("form input")) //Get array of inputs
    let nextInput = inputs[inputs.indexOf(document.activeElement) + 1] //get index of input after the current input
    nextInput.focus() //focus new input
}
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-09-20T11:23:02.237

用 JavaScript 的焦点函数解决这个问题的最简单方法如下：

*你可以复制并尝试@home！*

```
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>

    <input id="input1" type="text" onkeypress="pressEnter()" />
    <input id="input2" type="text" onkeypress="pressEnter2()" />
    <input id="input3" type="text"/>

    <script type="text/javascript">
    function pressEnter() {
      // Key Code for ENTER = 13
      if ((event.keyCode == 13)) {
        document.getElementById("input2").focus({preventScroll:false});
      }
    }
    function pressEnter2() {
      if ((event.keyCode == 13)) {
        document.getElementById("input3").focus({preventScroll:false});
      }
    }
    </script>

  </body>
</html> 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2009-12-09T16:52:17.590

我有一个类似的需求。这是我所做的：

```
 <script type="text/javascript" language="javascript">
    function convertEnterToTab() {
      if(event.keyCode==13) {
        event.keyCode = 9;
      }
    }
    document.onkeydown = convertEnterToTab;    
  </script> 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2016-09-09T15:23:20.193

在所有这些情况下，仅适用于 Chrome 和 IE，我添加了以下代码来解决该问题：

var key = (window.event) ? e.keyCode : e.which;

我测试了键值是否等于 13

```
 $('body').on('keydown', 'input, select, textarea', function (e) {
    var self = $(this)
      , form = self.parents('form:eq(0)')
      , focusable
      , next
    ;

    var key = (window.event) ? e.keyCode : e.which;

    if (key == 13) {
        focusable = form.find('input,a,select,button,textarea').filter(':visible');
        next = focusable.eq(focusable.index(this) + 1);
        if (next.length) {
            next.focus();
        } else {
            focusable.click();
        }
        return false;
    }
}); 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2019-06-27T06:44:24.860

```
$("#form input , select , textarea").keypress(function(e){
    if(e.keyCode == 13){
        var enter_position = $(this).index();
        $("#form input , select , textarea").eq(enter_position+1).focus();
    }
}); 
```

* * *

## 回答 #23

> 赞同：-2
> 
> 时间：2009-06-17T22:23:57.783

您可以在进行时以编程方式迭代添加 onkeydown 处理程序的表单元素。这样您就可以重用代码。

# python - 时间戳转换关闭了一个小时

> ID：1009812
> 
> 赞同：2
> 
> 时间：2009-06-17T22:22:35.867
> 
> 标签：python, django, datetime, time

我正在尝试在 django 中解析 twitter 提要，但在转换发布时间时遇到了一个奇怪的问题：

我已经正确地将提要的时间变成了完整的 9 元组：

```
>> print tweet_time
time.struct_time(tm_year=2009, tm_mon=6, tm_mday=17, tm_hour=14, tm_min=35, tm_sec=28, tm_wday=2, tm_yday=168, tm_isdst=0) 
```

但是当我这样称呼时：

```
tweet_time = datetime.fromtimestamp(time.mktime(tweet_time)) 
```

我最终得到了提前 1 小时的时间：

```
>> print tweet_time
2009-06-17 15:35:28 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T22:26:28.560

尝试将 isdst（是夏令时标志）翻转为 -1 并查看是否可以修复它。-1 告诉它使用（猜测）本地夏令时设置并随之滚动。

# python - 如何使用任何 Python GUI 框架在我的应用程序中嵌入一些应用程序窗口

> ID：1009813
> 
> 赞同：5
> 
> 时间：2009-06-17T22:22:44.870
> 
> 标签：python, user-interface

我希望某些应用程序看起来像我的 Python 应用程序中的小部件。

就这样。我不需要他们之间的任何互动。我对适用于 windows 和 x windows的**任何GUI 工具包中的解决方案感兴趣。**

使用 Tkinter 有一个解决方案会很好，但这并不重要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T23:01:29.177

在 X 窗口（即 Linux、FreeBSD、Solaris）上使用 GTK，您可以使用 XEMBED 协议使用[`gtk.Socket`](http://www.pygtk.org/docs/pygtk/class-gtksocket.html). 不幸的是，您要启动的应用程序必须明确支持它，以便您可以告诉它嵌入自己。某些应用程序不支持此功能。值得注意的是，我找不到使用 Firefox 的方法。

尽管如此，这里有一个示例程序，它将在 GTK 窗口中运行 X 终端或 Emacs 会话：

```
import os
import gtk
from gtk import Socket, Button, Window, VBox, HBox

w = Window()
e = Button("Emacs")
x = Button("XTerm")
s = Socket()
v = VBox()
h = HBox()
w.add(v)
v.add(s)
h.add(e)
h.add(x)
v.pack_start(h, expand=False)

def runemacs(btn):
    x.set_sensitive(False); e.set_sensitive(False)
    os.spawnlp(os.P_NOWAIT, "emacs", 
        "emacs", "--parent-id", str(s.get_id()))

def runxterm(btn):
    x.set_sensitive(False); e.set_sensitive(False)
    os.spawnlp(os.P_NOWAIT, "xterm",
        "xterm", "-into", str(s.get_id()))

e.connect('clicked', runemacs)
x.connect('clicked', runxterm)
w.show_all()
gtk.main() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-27T17:55:10.180

没有足够的声誉来评论 Glyphs 的答案。要使 xterm 工作，除了上面的注释之外，还需要添加

```
XTerm*allowSendEvents: True 
```

到`~/.Xresources`. （也许用 重新加载那些`xrdb -load ~/.Xresources`）

# iframe - iFrames 和法律

> ID：1009815
> 
> 赞同：7
> 
> 时间：2009-06-17T22:23:37.003
> 
> 标签：iframe

假设演员 A 在 iF​​rame 中有演员 B 的站点。除了网址之外，网站没有任何区别。网址完全不同。演员 A 是否应征得演员 B 的许可才能使用 B 的网站？是否有任何法律禁止将其他网站放置在 iFrame 中的网站上？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-02T02:51:25.870

不是编程问题，但至少让我帮助您提供一个网站链接。plagiarismtoday.com 的所有者有你的一些担忧，虽然不是律师，但收集了相当多的信息。

[http://www.plagiarismtoday.com/2009/04/07/is-the-diggbar-content-theft/](http://www.plagiarismtoday.com/2009/04/07/is-the-diggbar-content-theft/)

阅读**框架法**并点击华盛顿邮报诉 TotalNews 案的链接

您还应该检查您所在国家和当地的州法律，没有标准的法律解决方案，因为它从一个地方到另一个地方会发生变化，而且许多国家没有关于您所要求的法律。但是，让我告诉你，网络似乎被两种心态或法律哲学所支配：

*   lex mercatoria：这些人倾向于认为网络是商业，应该适用商业法律，这主要是由民法和民法衍生而来的
*   lex retis：这些人说网络是无政府状态，任何法律都不应该管它

PS：我是律师。即使这有点复杂，我希望你能得到一个想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-02T03:05:01.457

据我所知，如果 iframe 被用于进行欺诈、欺骗性营销或诸如此类的事情，它只会成为一个法律问题。除此之外，它只是令人讨厌。如果它足够困扰你，你总是可以使用 framebusters/framekillers。

# jquery - 如何为多个动态生成的 DOM 元素设置动画？

> ID：1009816
> 
> 赞同：-1
> 
> 时间：2009-06-17T22:23:45.647
> 
> 标签：jquery, dynamic, animation, hover

这可能有助于了解我来自哪里。 [jQuery嵌套每个问题](https://stackoverflow.com/questions/1005006/jquery-nested-each-problem)

我正在`divs`使用以下代码添加到页面：

```
jQuery("#list").append(
    jQuery("<div>")
        .attr("id", "Entry")
        .html(html)
); 
```

`html`只是一个包含一些文本和锚点的字符串。

我正在尝试为新的 div 设置动画 - 有多个 div 的 id `#Entry`。

这是我的代码：

```
jQuery("#Entry").hover(function(){  
    jQuery(this)
    .animate({
        width:"50%",
        fontSize: "30px",
        opacity: 0.3,
        borderwidth: "15px"
    }, 500);  
}); 
```

以上是我的`jQuery(document).ready(function(){ }`职能，如果这很重要的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T22:28:01.350

首先，如果您使用该 id 添加超过 1 个`<div>`，那么您做错了。`id`属性应该（必须）在文档中是唯一的。拥有超过 1 个相同的元素`id`会使 Javascript 变得混乱，因为它不应该发生。这相当于两个拥有相同社会安全号码的人。:) 对于元素组，常见的最佳实践是给它们一个类并以这种方式选择它们。

除此之外，您应该查看[`live`](http://docs.jquery.com/Events/live)功能，它可以满足您的需求。本质上，当您在准备好的文档上运行一段代码时，它是针对文档的*当前*状态执行的。换句话说，只有在那个时间点存在的元素（与提供的选择器匹配）才会绑定到您提供的事件。创建该`live`函数是为了解决这个问题。另一种解决方案是在添加新的 之后再次运行绑定代码`<div>`，但这不像使用 那样干净`live`，它支持您需要执行的`mouseover`和事件。`mouseout``hover`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-06T15:44:40.153

live() 支持所有事件，包括最新 jQuery 中的自定义事件...

# asp.net - 文本框获得焦点，但您无法输入任何内容

> ID：1009823
> 
> 赞同：1
> 
> 时间：2009-06-17T22:24:53.150
> 
> 标签：asp.net, gridview, textbox, focus

我有一个 ASP.NET gridview 在页脚行中有数据输入文本框。用户添加一行后，我使用 gridview 更新处理程序中的 Textbox1.focus() 将焦点重置到代码隐藏中的第一个文本框。问题是，虽然看起来文本框获得了焦点（光标在文本框中闪烁），但在单击表单上的另一个文本框然后单击返回之前，您无法输入任何内容。这似乎只发生在 IE8 中。当我在 Firefox 中对此进行测试时，文本框获得了焦点，我能够以正确的方式输入新文本。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T20:45:27.580

仍然没有找到解决方案，但我只是注意到当 IE8 处于兼容模式时，文本框按预期运行。这是我遇到的第三个与 IE8 兼容模式有关的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-29T18:26:27.643

I had a similar issue, where a textbox in an update panel would not allow the user to interact despite appearing to have focus until it lost focus and got it back. Like the original poster, it only happened in IE8 in non-compatibility mode.

I implemented the following workaround which seems to do the trick:

```
ScriptManager.GetCurrent(Me.Page).SetFocus(txtAnotherTextBox)
ScriptManager.RegisterStartupScript(Me, Me.GetType, "Focus", _
"setTimeout(function() { document.getElementById('" _
& txtTextBox.ClientID & "').focus(); }, 200);", True) 
```

Basically, I initially focus on a *different* control, then register a script to focus on the control that I wanted with a 200ms delay.

# python - 使用字符串作为变量名

> ID：1009831
> 
> 赞同：6
> 
> 时间：2009-06-17T22:27:22.520
> 
> 标签：python

我有什么办法可以使用字符串来调用类的方法吗？这是一个有望更好地解释的示例（使用我认为应该的方式）：

```
class helloworld():
    def world(self):
        print "Hello World!"

str = "world"
hello = helloworld()

hello.`str`() 
```

哪个会输出`Hello World!`.

提前致谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-17T22:31:03.153

您可以使用[`getattr`](http://docs.python.org/3.0/library/functions.html#getattr)：

```
>>> class helloworld:
...     def world(self):
...         print("Hello World!")
... 
>>> m = "world"
>>> hello = helloworld()
>>> getattr(hello, m)()
Hello World! 
```

*   请注意`class helloworld()`，在这种情况下，您的示例中的括号是不必要的。
*   而且，正如[SilentGhost](https://stackoverflow.com/users/12855/silentghost)指出的那样，[`str`](http://docs.python.org/3.0/library/functions.html#str)这是一个不幸的变量名称。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T22:38:55.070

*警告： exec 是一个危险的函数，使用前请研究它*

您还可以使用内置函数“exec”：

```
>>> def foo(): print('foo was called');
...
>>> some_string = 'foo';
>>> exec(some_string + '()');
foo was called
>>> 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-06-17T22:33:33.473

一种方法是您可以将变量设置为等于函数，就像数据一样

```
def thing1():
    print "stuff"

def thing2():
    print "other stuff"

avariable = thing1
avariable ()
avariable = thing2
avariable () 
```

你会得到的输出是

```
stuff
other stuff 
```

然后你可以变得更复杂并且有

```
somedictionary["world"] = world
somedictionary["anotherfunction"] = anotherfunction 
```

等等。如果要自动将模块方法编译到字典中，请使用 dir()

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-06-17T22:45:19.253

你要找的是[exec](http://www.python.org/doc/2.5.2/ref/exec.html)

```
class helloworld():
    def world(self):
        print "Hello World!"

str = "world"
hello = helloworld()

completeString = "hello.%s()" % str

exec(completString) 
```

# google-analytics - 谷歌分析、隐私和延迟

> ID：1009834
> 
> 赞同：1
> 
> 时间：2009-06-17T22:30:15.477
> 
> 标签：google-analytics, latency, privacy

我正在考虑将 Google Analytics 跟踪器放在我的博客上以获得更好的统计数据（现在我使用 Summary.net，它速度很快，但有时准确性有问题，尽管*比*awstats 好得多）。无论如何，我有两个大问题，尽管我应该在这里向社区征求意见：

1.  隐私。在过去，我甚至阻止了 Google 的广告 IP 和跟踪器。基本上，此时您在网上所做的一切似乎都以某种方式对 Google 可见，但同时我想知道这是否真的很重要。我应该耸耸肩并嵌入代码吗？

2.  潜伏。我不是很有技术倾向，所以我对此了解不多，但我听说如果谷歌有问题，你的网站也会有问题，只需包含他们的代码。那可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T22:41:08.093

1) 无法回答。如果您正在为非法贩毒网络运营网站，那么我可能不会使用 Analytics。否则，我个人不在乎。如果您担心它们跟踪的不仅仅是简单的 IP / 浏览器数据，您可以监控您的 HTTP 流量并准确查看有效负载是什么。如果您担心他们知道“谁”访问了您的网站，并且有正当理由，请不要使用它。

2）是的。您是否注意到某个页面需要一段时间才能加载，并且在状态栏中显示它正在等待 google-analytics.com？我在小型和大型网站上都经常看到它。尽管 IMO 问题不大。

我认为将分析脚本放置在尽可能靠近页面代码的底部是推荐的最佳做法（对于任何外部脚本也是如此）。

我还要补充一点，在我开始使用 Google Analytics 之前，我并不是很喜欢它。好处似乎真的超过了缺点。它的报道简直太棒了。然而，我仍然在同一个站点上使用 AwStats，只是因为数据是可访问的……而且比较数字很不错。

# pdf - SSRS 2005 PDF 导出问题

> ID：1009836
> 
> 赞同：0
> 
> 时间：2009-06-17T22:30:35.913
> 
> 标签：pdf, reporting-services, export

下午好，

我的报告的页面大小为 8.5" x 11"，周围有 0.5 英寸的边距。当我在 BIDS 中预览报告时，它以纵向呈现。页面设置中的横向更改可以解决此问题。

但是，当我导出为 PDF 并在 Acrobat 中查看它时，我的报告的最后一列滚动到第 2 页。我有一个 4 页的报告，而不是 2 页的报告，最后一列位于第 2 页和第 4 页。

我已经搜索了这个站点和其他站点，但找不到任何修复程序。有人可以指出我正确的方向吗？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T22:32:42.570

在布局模式下，报表的宽度是多少？如果您的页面大小为 8.5"，边距为 0.5"，则报告的最大宽度为 7.5"。

我之前遇到过同样类型的问题，结果我的报告的宽度只有 7.5 英寸多一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-08T18:24:18.130

为报表正确设置交互式大小和页面大小

# c# - 按长度拆分字符串

> ID：1009839
> 
> 赞同：2
> 
> 时间：2009-06-17T22:31:28.470
> 
> 标签：c#, .net, regex, split

我有一个长度为 5000 + 个字符的字符串值，我想将其拆分为 76 个字符长，并在每 76 个字符的末尾添加一个新行。我将如何在 C# 中做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-18T00:27:11.920

如果您正在编写 Base64 数据，请尝试编写

```
Convert.ToBase64String(bytes, Base64FormattingOptions.InsertLineBreaks); 
```

这将每 76 个字符插入一个换行符

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-17T23:05:52.613

有点丑……但要快得多；）（这个版本用了 161 滴答声... Aric 用了 413 滴答声）

我在我的博客上发布了我的测试代码。[http://hackersbasement.com/?p=134](http://hackersbasement.com/?p=134) （我还发现 StringBuilder 比 string.Join 慢得多）

[http://hackersbasement.com/?p=139](http://hackersbasement.com/?p=139) <= 更新结果

```
 string chopMe = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

    Stopwatch sw = new Stopwatch();

    sw.Start();
    char[] chopMeArray = chopMe.ToCharArray();
    int totalLength = chopMe.Length;
    int partLength = 12;
    int partCount = (totalLength / partLength) + ((totalLength % partLength == 0) ? 0 : 1);
    int posIndex = 0;
    char[] part = new char[partLength];
    string[] parts = new string[partCount];
    int get = partLength;
    for (int i = 0; i < partCount; i++)
    {
        get = Math.Min(partLength, totalLength - posIndex);
        Array.Copy(chopMeArray, posIndex, part, 0, get);
        parts[i] = new string(part, 0, get);
        posIndex += partLength;
    }

    var output = string.Join("\r\n", parts) + "\r\n";
    sw.Stop();
    Console.WriteLine(sw.ElapsedTicks); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-17T23:28:32.257

一方面，如果您想要 StringBuilder 与字符串性能的对比，最好的文章是 codeproject one found [here](http://www.codeproject.com/KB/cs/StringBuilder_vs_String.aspx)。

![替代文字](../Images/152a3277ee61a2c9887beb62f0267324.png)

*（但这不显示字符串大小）*

简而言之，在字符串长度（或重复接触）达到阈值之前，StringBuilder 不会更快，因此您完全低于此阈值，因此请坚持使用常规字符串连接和 String 方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-17T23:40:13.713

试试这个：

```
s = Regex.Replace(s, @"(?<=\G.{76})", "\r\n"); 
```

编辑：显然，这是迄今为止发布的所有方法中最慢的方法。我想知道如果您预编译正则表达式会如何：

```
Regex rx0 = new Regex(@"(?<=\G.{76})");

s = rx0.Replace(s, "\r\n"); // only time this portion 
```

此外，它与直接匹配方法相比如何？

```
Regex rx1 = new Regex(".{76}");

s = rx1.Replace(s, "$0\r\n"); // only time this portion 
```

我一直想知道那些无界的lookbehinds是多么昂贵。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T23:10:09.547

```
public static string InsertNewLine(string s, int len)
{
    StringBuilder sb = new StringBuilder(s.Length + (int)(s.Length/len) + 1);
    int start = 0;
    for (start=0; start<s.Length-len; start+=len)
    {
        sb.Append(s.Substring(start, len));
        sb.Append(Environment.NewLine);
    }
    sb.Append(s.Substring(start));
    return sb.ToString();
} 
```

其中**s**将是您的输入字符串，**len**是所需的行长 (76)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T22:38:29.987

```
string[] FixedSplit(string s, int len)
{
   List<string> output;
   while (s.Length > len)
   {
      output.Add(s.Substring(0, len) + "\n");
      s.Remove(0, len);
   }
   output.Add(s + "\n");
   return output.ToArray();
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T23:27:18.997

```
public static IEnumerable<string> SplitString(string s, int length)
{
    var buf = new char[length];
    using (var rdr = new StringReader(s))
    {
        int l;
        l = rdr.ReadBlock(buf, 0, length);
        while (l > 0)
        {
            yield return (new string(buf, 0, l)) + Environment.NewLine;
            l = rdr.ReadBlock(buf, 0, length);
        }
    }
} 
```

然后将它们重新组合在一起：

```
string theString = GetLongString();
StringBuilder buf = new StringBuilder(theString.Length + theString.Length/76);
foreach (string s in SplitString(theString, 76) { buf.Append(s); }
string result = buf.ToString(); 
```

或者你可以这样做：

```
string InsertNewLines(string s, int interval)
{
    char[] buf = new char[s.Length + (int)Math.Ceiling(s.Length / (double)interval)];

    using (var rdr = new StringReader(s))
    {
        for (int i=0; i<buf.Length-interval; i++)
        {
            rdr.ReadBlock(buf, i, interval);
            i+=interval;
            buf[i] = '\n';
        }
        if (i < s.Length)
        {
            rdr.ReadBlock(buf, i, s.Length - i);
            buf[buf.Length - 1] = '\n';
        }
    }
    return new string(buf);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-17T23:59:50.290

最后，这将是我会使用的，我想

```
 static string fredou()
    {
        string s = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
        int partLength = 12;

        int stringLength = s.Length;
        StringBuilder n = new StringBuilder(stringLength + (int)(stringLength / partLength) + 1);
        int chopSize = 0;
        int pos = 0;

        while (pos < stringLength)
        {
            chopSize = (pos + partLength) < stringLength ? partLength : stringLength - pos;
            n.Append(s , pos, chopSize);
            n.Append("\r\n");
            pos += chopSize;
        }

        return n.ToString();         
    } 
```

通过查看反射器下的 AppendLine：

```
 <ComVisible(False)> _
    Public Function AppendLine(ByVal value As String) As StringBuilder
        Me.Append(value)
        Return Me.Append(Environment.NewLine)
    End Function

    Public Shared ReadOnly Property NewLine As String
        Get
            Return ChrW(13) & ChrW(10)
        End Get
    End Property 
```

对我来说，速度明智，手动执行 > AppendLine

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-18T00:23:41.990

还有一个......（第一次通过缓慢的后续运行，类似于上面发布的更快的时间）

```
private void button1_Click(object sender, EventArgs e)
{
  string chopMe = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
  Stopwatch sw = new Stopwatch();
  sw.Start();
  string result = string.Join("\r\n", ChopString(chopMe).ToArray());
  sw.Stop();
  MessageBox.Show(result + " " + sw.ToString());
}

public IEnumerable<string> ChopString(string s)
{
  int i = 0;
  while (i < s.Length)
  {
    yield return i + PARTLENGTH <= s.Length ? s.Substring(i,PARTLENGTH) :s.Substring(i) ;
    i += PARTLENGTH;
  }
} 
```

编辑：我很想知道子字符串有多快......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-18T03:29:13.910

字符串是 5000 个字符......我认为速度并不是真正的本质，除非你这样做数千甚至数百万次，尤其是当 OP 甚至没有提到速度很重要时。过早优化？

我可能会使用递归，因为在我看来，它会导致最简单的代码。

这可能在语法上不正确，因为我知道 .NET 但不是 C#。

```
String ChunkString(String s, Integer chunkLength) {
    if (s.Length <= chunkLength) return s;
    return String.Concat(s.Substring(0, chunkLength), 
                         ChunkString(s.Substring(chunkLength)));
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-18T11:19:20.733

主要是为了好玩，这里有一个不同的解决方案作为字符串的扩展方法实现：（\r\n 明确使用，因此只支持换行符的格式）；

```
public static string Split(this string str, int len)
        {
            char org = str.ToCharArray();
            int parts = str.Length / len + (str.Length % len == 0 ? 0 : 1);
            int stepSize = len + newline.Length;
            char[] result = new char[parts * stepSize];
            int resLen = result.Length;

            for (int i =0;i<resLen ;i+stepSize)
            {
                Array.Copy(org,i*len,result,i*stepSize);
                resLen[i++] = '\r';
                resLen[i++] = '\n';
            }
            return new string(result);
        } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-10-15T13:57:27.960

我将字符串拆分为 35

```
var tempstore ="12345678901234567890123456789012345";
for (int k = 0; k < tempstore.Length; k += 35)
{
   PMSIMTRequest.Append(tempstore.Substring(k, tempstore.Length - k > 35 ? 35 : tempstore.Length - k));
   PMSIMTRequest.Append(System.Environment.NewLine);
}
messagebox.Show(PMSIMTRequest.tostring()); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-08-16T07:02:50.700

@M4N 的回答很好，但我觉得`while statement`比`for statement`.

```
public static string InsertNewLine(string source, int len = 76)
{
    var sb = new StringBuilder(source.Length + (int)(source.Length / len) + 1);
    var start = 0;
    while ((start + len) < source.Length)
    {
        sb.Append(source.Substring(start, len));
        sb.Append(Environment.NewLine);
        start += len;
    }
    sb.Append(source.Substring(start));
    return sb.ToString();
} 
```

# language-agnostic - HTTP 状态标头的语法

> ID：1009840
> 
> 赞同：6
> 
> 时间：2009-06-17T22:31:43.277
> 
> 标签：language-agnostic, http, http-headers, specifications

有很多方法可以编写 HTTP 状态标头：

```
HTTP/1.1 404 Not Found
Status: 404
Status: 404 Not Found 
```

但哪种方式在语义上正确且符合规范？

编辑：通过状态标题我的意思是[，](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)使用诸如 PHP 之类的函数`header()`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-27T15:41:39.240

一段时间后添加一些信息，因为我在研究相关内容时遇到了这个问题。

我相信 Status 标头字段最初是作为 CGI 规范 RFC 3875 的一部分发明的：

[https://www.rfc-editor.org/rfc/rfc3875#section-6.3.3](https://www.rfc-editor.org/rfc/rfc3875#section-6.3.3)

去引用：

```
The Status header field contains a 3-digit integer result code that
indicates the level of success of the script's attempt to handle the
request.

   Status         = "Status:" status-code SP reason-phrase NL
   status-code    = "200" | "302" | "400" | "501" | extension-code
   extension-code = 3digit
   reason-phrase  = *TEXT 
```

它允许 CGI 脚本向 Web 服务器返回一个状态代码，该代码覆盖 HTTP 状态行中的默认值。通常，服务器会缓冲脚本的结果并为客户端发出一个新的标头。这是一个有效的 HTTP 标头，它以修改后的 HTTP 状态行开头并省略脚本“​​Status:”标头字段（以及 RFC 规定的一些其他转换）。

因此，您的所有示例在*CGI 脚本*中都是有效的，但只有第一个在 HTTP 标头中真正有效。后两者仅对来自 CGI 脚本（或者可能是 FastCGI 应用程序）有效。

当 CGI 脚本生成完整且有效的 HTTP 标头时，CGI 脚本也可以在“非解析标头”（NPH）模式下运行，Web 服务器将其逐字传递给客户端。因此，这不应包含 Status: 标头字段。

请注意，我感兴趣的是，如果 NPH 脚本有点错误并发出 Status: 标头字段，可能是 HTTP 状态行之外的哪个状态应该获胜。我找不到任何明确的指示，所以我怀疑它留给解析输出的任何东西的实现，无论是客户端还是服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-17T00:29:35.403

由于[https://www.rfc-editor.org/rfc/rfc2616#section-6](https://www.rfc-editor.org/rfc/rfc2616#section-6)更具体地说[https://www.rfc-editor.org/rfc/rfc2616#section-6.1](https://www.rfc-editor.org/rfc/rfc2616#section-6.1)没有提到使用“状态： " 当指示状态代码时，由于[http://www.iana.org/assignments/message-headers/message-headers.xml](http://www.iana.org/assignments/message-headers/message-headers.xml)的官方标题列表没有提到“状态”，我倾向于相信它不应该作为标题提供。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-26T12:24:49.053

我找到的最接近答案的是[Fast CGI spec](http://www.fastcgi.com/devkit/doc/fcgi-spec.html#S6.1)，它规定通过 Status 和 Location 标头设置状态代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T22:36:08.040

其中很多都是任意字符串，但这里有 w3c 对常用字符串的规范

[http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)

# asp.net - 自动提供更新面板的用户控件的基类？

> ID：1009841
> 
> 赞同：0
> 
> 时间：2009-06-17T22:32:35.613
> 
> 标签：asp.net, asp.net-ajax

假设我正在一个 ASP.Net Web 应用程序中构建一堆 UserControl，并且所有这些用户控件都继承自我创建的自定义基类，而该基类又继承自 System.Web.UI.UserControl。

现在假设我（通过我的自定义基类）希望每个用户控件的内容自动包装在 UpdatePanel 控件中。

我该怎么做？我怀疑它涉及在我的自定义基类中覆盖 CreateControlCollection 和/或 CreateChildControls 方法，但我不确定如何。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T18:05:38.427

最简单的事情就是从 UpdatePanel 继承您的基本控件。然后，您添加到其中的每个子控件都会自动在其中一个，您无需担心它们被放置在哪个容器中。

如果由于某种原因这是不可能的，您可以覆盖任意数量的方法（OnLoad、OnPreRender、CreateChildControls 等）以添加一些逻辑，将添加到基本控件的控件集合中的任何子控件移动到 UpdatePanel 控件您的控件包含的。

# sharepoint - WSS 3.0 和 MOSS 的所有隐藏列表 URL 是什么？

> ID：1009843
> 
> 赞同：1
> 
> 时间：2009-06-17T22:32:51.510
> 
> 标签：sharepoint, moss, web-parts

例如，我有一个 MOSS 发布页面，其中用户添加了一个 Web 部件，但由于布局的呈现方式，我无法删除该 Web 部件。我无法访问小下拉菜单来“删除”Web 部件。

我知道存在大量未发布的列表视图，并且想知道我们是否可以在这里获得它们的完整列表，也许可以找到也可以解决我的问题的列表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-18T07:17:40.520

嘿，要删除 Web 部件，您只需将查询字符串 Contents=1 附加到 Web 部件页面 url。

即“ [http://localhost/sites/SiteCollection/default.aspx?Contents=1](http://localhost/sites/SiteCollection/default.aspx?Contents=1) ”将向您显示 Web 部件页面“ [http://localhost/sites/SiteCollection/default.aspx](http://localhost/sites/SiteCollection/default.aspx) ”的 Web 部件维护页面。您可以在此处删除 Web 部件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T15:57:02.347

来自 Heather Solomon 的博客： [http ://www.heathersolomon.com/blog/articles/sp07urls.aspx](http://www.heathersolomon.com/blog/articles/sp07urls.aspx)

有什么方法可以在这里制作维基吗？

# java - 如何确定参数是从 Java 中“发布”还是“获取”？

> ID：1009844
> 
> 赞同：13
> 
> 时间：2009-06-17T22:33:01.900
> 
> 标签：java, http, post, get

在 ASP 中，有`request.form`和`request.queryString`属性，但在 Java 中。似乎我们只有一个集合，可以通过`request.getParamaterMap`、`getParametersNames`等访问`getParameterValues`。

有什么方法可以知道哪些值已发布，哪些值已在 URL 中指定？

* * *

PS：

我想要实现的是制作一个可以处理以下情况的页面

*   读取来自查询字符串的变量（get）
*   阅读具有特定名称（例如“xml”）的单个帖子。
*   如果该帖子丢失，请阅读整个正文（带有 `request.getReader()`）。

我正在使用tomcat 6。

根据我到目前为止所看到的，如果我发出 a `request.getReader()`，发布的值不再出现在`getParamater`集合中，但查询字符串参数仍然存在。

另一方面，如果我发出任何`getParameters`方法，则`getReader`返回空字符串。

好像我不能吃蛋糕也不能吃。

所以，我想解决方案如下：

*   用 阅读正文`getReader`。
*   查看 xml 帖子是否存在（缺点，我必须手动解析正文。
*   如果是，则获取 http 消息正文并去掉“xml=”部分。
*   如果不是，那么，就拿尸体吧。
*   通过读取查询字符串参数`request.getParameter`

有更好的主意吗？

*   PS：有人知道如何使用与使用的相同方法解析正文`HttpServlet`吗？
*   PS：[这里](http://www.aspnut.com/reference/encoding.asp)是一个解码ASP函数。我应该用Java重写它吗？
*   PS：也[找到](http://java.sun.com/j2se/1.5.0/docs/api/java/net/URLDecoder.html)了（暂时没有机器测试）

只是为了澄清事情。问题似乎在于`getParameter`您获得了发布的值以及通过 URL 传递的值，请考虑以下示例：

```
<%@page import="java.util.*"%>
<%
  Integer i;
  String name;
  String [] values;

  for (Enumeration e = request.getParameterNames(); e.hasMoreElements();) {

    name = (String) e.nextElement();
    values = request.getParameterValues( name );

    for ( i=0; i < values.length; i ++ ) {
      out.println( name + ":" + values[i] + "<br/>" );
    }
  }
%>

<html>
<head><title>param test</title>
</head>
<body>
  <form method="post" action="http://localhost:8080/jsp_debug/param_test.jsp?data=from_get">
    <input type="text" name="data" value="from_post">
    <input type="submit" value="ok">
  </form>
</body>
</html> 
```

此代码的输出是

```
data:from_get
data:from_post

... 
```

似乎为了找到哪个参数来自哪里，我必须检查`request.getQueryString`.

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-06-18T02:08:43.947

[HttpServletRequest.getMethod()](http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpServletRequest.html#getMethod())：

> 返回发出此请求的 HTTP 方法的名称，例如 GET、POST 或 PUT。与 CGI 变量 REQUEST_METHOD 的值相同。

您需要做的就是：

```
boolean isPost = "POST".equals(request.getMethod()); 
```

此外，我真的很困惑为什么您不简单地使用`request.getParameter("somename")`来检索作为请求参数发送的值。[无论请求是通过 GET 还是 POST 发送的，](http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletRequest.html#getParameter(java.lang.String))此方法都会返回参数：

> 请求参数是随请求发送的额外信息。对于 HTTP servlet，参数包含在查询字符串或发布的表单数据中。

这比尝试解析`getQueryString()`自己要简单得多。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-17T22:37:16.353

没有直接的方法。非直接检查 .getQueryString()

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T00:53:23.503

**如果您正在编写一个 servlet，您可以通过调用doGet**或**doPost**方法来区分。

```
public void doGet(HttpServletRequest request,
                    HttpServletResponse response)
      throws ServletException{

 //Set a variable or invoke the GET specific logic
   handleRequest(request, response);

}

public void doPost(HttpServletRequest request,
                    HttpServletResponse response)
      throws ServletException{

 //Set a variable or invoke the POST specific logic
 handleRequest(request, response);

}

public void handleRequest(HttpServletRequest request,
                    HttpServletResponse response)
      throws ServletException{

 //Do stuff with the request

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T22:37:58.473

你为什么不从检查查询字符串参数开始，如果你没有看到，假设一个帖子然后挖出表单变量？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-07-12T10:27:24.540

我在我的过滤器中做了这个，所以也许有一天有人可以使用它。

```
public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse,FilterChain filterChain) throws IOException, ServletException {
    HttpServletRequest sreq = (HttpServletRequest)servletRequest;
    System.out.println(sreq.getMethod());
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T04:34:40.533

我知道它不能解决您的问题，但如果我没记错的话，在使用 Struts 时，如果您的变量是在查询字符串或帖子正文中发送的，则会填充 ActionForm。

我找到了 RequestUtils 类的源代码，也许“populate”方法是你需要的：

[http://svn.apache.org/repos/asf/struts/struts1/trunk/core/src/main/java/org/apache/struts/util/RequestUtils.java](http://svn.apache.org/repos/asf/struts/struts1/trunk/core/src/main/java/org/apache/struts/util/RequestUtils.java)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-10-25T19:51:48.373

您可以使用 request.getMethod() 来获取任何方法。我为此使用 HandlerInterceptor。

检查此代码：

```
public class LoggingMethodInterceptor implements HandlerInterceptor {

Logger log = LoggerFactory.getLogger(LoggingMethodInterceptor.class);

@Override
public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler)
        throws Exception {
    log.info("[START]  [" + request.getMethod() + "] [" + request.getRequestURL() + "] StartTime: {} milliseconds",
            System.currentTimeMillis());
    return true;
} 
```

# c# - c#帮助加入文本框值、LIKE和字符串变量

> ID：1009857
> 
> 赞同：0
> 
> 时间：2009-06-17T22:38:03.933
> 
> 标签：c#, sql-like

我下面的行有什么问题？

```
table.DefaultView.RowFilter = cmbBox.Text + 'LIKE' + strName"; 
```

下面的行工作正常，但显然没有用。

```
table.DefaultView.RowFilter = 'FirstName LIKE James'; 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T22:42:50.057

好像您缺少通配符？

```
table.DefaultView.RowFilter = cmbBox.Text + " LIKE '%" + strName + "%'"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T22:40:14.147

可能是间距问题

```
table.DefaultView.RowFilter = cmbBox.Text + " LIKE " + strName; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T22:42:10.993

一方面，当你这样做时，你不会添加空格。

另外，如果您是，请不要对 SQL 查询执行此操作。这使您容易受到 sql 注入攻击（在网络世界中）。至少学习参数化 SQL。如果您已经知道这一点，请忽略。

# math - 不使用位运算的随机数生成

> ID：1009858
> 
> 赞同：6
> 
> 时间：2009-06-17T22:38:04.697
> 
> 标签：math, graphics, random

我现在正在写一个顶点着色器，我需要一些随机数。顶点着色器硬件没有逻辑/位操作，因此我无法实现任何标准随机数生成器。是否可以仅使用标准算术来制作随机数生成器？随机性不必特别好！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T22:40:24.460

如果你不介意糟糕的随机性，一个经典的方法是

```
x[n+1] = (x[n] * x[n] + C) mod N 
```

其中 C 和 N 是常数，C != 0 和 C != -2，N 是素数。这是用于 Pollard Rho 因子分解的典型伪随机生成器。尝试 C = 1 和 N = 8051，这些都可以。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T22:46:44.010

顶点着色器有时有内置的噪声生成器供你使用，例如 cg 的`noise()`函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T22:47:24.180

使用[线性同余生成器](http://en.wikipedia.org/wiki/Linear_congruential_generator)：

```
X_(n+1) = (a * X_n + c) mod m 
```

那些不是那么强大，但至少它们是众所周知的并且可以有很长的时间。维基百科页面也有很好的建议：

> 一般LCG的周期最多为m，而对于a的一些选择则要小得多。当且仅在以下情况下，LCG 将有一个完整的周期：
> 
> ```
> 1\. c and m are relatively prime,
> 2\. a - 1 is divisible by all prime factors of m,
> 3\. a - 1 is a multiple of 4 if m is a multiple of 4 
> ```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T23:00:12.827

信不信由你，我在几个电子游戏中使用了 newx = oldx * 5 + 1（或它的轻微变化）。随机性是可怕的——它更像是一个加扰的序列，而不是一个随机生成器。但有时这就是你所需要的。如果我没记错的话，它会在重复之前遍历所有数字。

它有一些可怕的特征。它不会连续两次给你相同的数字。我们中的一些人对它的变体进行了一系列测试，我们在其他游戏中使用了一些变体。

我们在没有可用的模数时使用它。这只是移位二加二（或乘以 5 加一）。我现在永远不会将它用于随机数——我会使用 LCG——但对于速度至关重要且指令集可能有限的着色器来说，它可能会工作得很好。

# python - 如何读取/处理命令行参数？

> ID：1009860
> 
> 赞同：706
> 
> 时间：2009-06-17T22:38:30.157
> 
> 标签：python, command-line, command-line-arguments

我原本是一名 C 程序员。我已经看到了许多技巧和“黑客”来阅读许多不同的论点。

Python 程序员有哪些方法可以做到这一点？

### 有关的

*   [获取/解析传递给 Python 脚本的命令行参数的最佳方法是什么？](https://stackoverflow.com/questions/20063/whats-the-best-way-to-grab-parse-command-line-arguments-passed-to-a-python-scrip)
*   [实现“[command] [action] [parameter]”风格的命令行界面？](https://stackoverflow.com/questions/362426/implementing-a-command-action-parameter-style-command-line-interfaces)
*   [如何在 Python 中处理命令行参数？](https://stackoverflow.com/questions/567879/how-can-i-process-command-line-arguments-in-python)
*   [如何使用 Python 的 optparse 格式化位置参数帮助？](https://stackoverflow.com/questions/642648/how-do-i-format-positional-argument-help-using-pythons-optparse)

* * *

## 回答 #1

> 赞同：629
> 
> 时间：2009-06-17T22:42:25.593

```
import sys

print("\n".join(sys.argv)) 
```

[`sys.argv`](https://docs.python.org/3/library/sys.html#sys.argv)是一个列表，其中包含在命令行上传递给脚本的所有参数。`sys.argv[0]`是脚本名称。

基本上，

```
import sys
print(sys.argv[1:]) 
```

* * *

## 回答 #2

> 赞同：532
> 
> 时间：2009-06-17T22:39:49.937

标准库中的规范解决方案是`argparse`（[docs](https://docs.python.org/3/library/argparse.html)）：

这是一个例子：

```
from argparse import ArgumentParser

parser = ArgumentParser()
parser.add_argument("-f", "--file", dest="filename",
                    help="write report to FILE", metavar="FILE")
parser.add_argument("-q", "--quiet",
                    action="store_false", dest="verbose", default=True,
                    help="don't print status messages to stdout")

args = parser.parse_args() 
```

`argparse`支持（除其他外）：

*   任何顺序的多个选项。
*   短期和长期的选择。
*   默认值。
*   生成使用帮助消息。

* * *

## 回答 #3

> 赞同：131
> 
> 时间：2009-06-26T18:15:02.380

只是四处宣传[argparse出于](http://code.google.com/p/argparse/)[这些](http://argparse.googlecode.com/svn/trunk/doc/argparse-vs-optparse.html)原因更好..本质上：

*（从链接复制）*

*   argparse 模块可以处理位置参数和可选参数，而 optparse 只能处理可选参数

*   argparse 对你的命令行界面应该是什么样子不是教条主义的 - 支持 -file 或 /file 之类的选项，以及必需的选项。Optparse 拒绝支持这些功能，更喜欢纯粹而不是实用性

*   argparse 生成更多信息性使用消息，包括根据您的参数确定的命令行用法，以及位置和可选参数的帮助消息。optparse 模块要求您编写自己的用法字符串，并且无法显示位置参数的帮助。

*   argparse 支持使用可变数量的命令行参数的操作，而 optparse 要求提前知道参数的确切数量（例如 1、2 或 3）

*   argparse 支持分派到子命令的解析器，而 optparse 需要 `allow_interspersed_args`手动设置和执行解析器分派

还有我个人最喜欢的：

*   argparse 允许`add_argument()` 使用简单的可调用对象指定类型和操作参数，而 optparse 需要破解类属性，例如 `STORE_ACTIONS`or`CHECK_METHODS`以获得正确的参数检查

* * *

## 回答 #4

> 赞同：72
> 
> 时间：2009-06-18T03:12:25.283

还有[`argparse`stdlib模块](https://docs.python.org/library/argparse.html)（stdlib模块的“改进” `optparse`）。[argparse 简介中的](https://docs.python.org/howto/argparse.html)示例：

```
# script.py
import argparse

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument(
        'integers', metavar='int', type=int, choices=range(10),
         nargs='+', help='an integer in the range 0..9')
    parser.add_argument(
        '--sum', dest='accumulate', action='store_const', const=sum,
        default=max, help='sum the integers (default: find the max)')

    args = parser.parse_args()
    print(args.accumulate(args.integers)) 
```

用法：

```
$ script.py 1 2 3 4
4

$ script.py --sum 1 2 3 4
10 
```

* * *

## 回答 #5

> 赞同：63
> 
> 时间：2015-10-25T11:40:25.450

如果您需要快速且不太灵活的东西

**主要.py：**

```
import sys

first_name = sys.argv[1]
last_name = sys.argv[2]
print("Hello " + first_name + " " + last_name) 
```

然后运行`python main.py James Smith`

产生以下输出：

> 你好詹姆斯史密斯

* * *

## 回答 #6

> 赞同：51
> 
> 时间：2009-06-17T22:43:08.573

一种方法是使用`sys.argv`. 这将打印脚本名称作为第一个参数以及您传递给它的所有其他参数。

```
import sys

for arg in sys.argv:
    print arg 
```

* * *

## 回答 #7

> 赞同：50
> 
> 时间：2013-02-09T16:52:31.510

docopt库非常漂亮[。](https://github.com/docopt/docopt)它从您的应用程序的使用字符串构建一个参数字典。

例如来自 docopt 自述文件：

```
"""Naval Fate.

Usage:
  naval_fate.py ship new <name>...
  naval_fate.py ship <name> move <x> <y> [--speed=<kn>]
  naval_fate.py ship shoot <x> <y>
  naval_fate.py mine (set|remove) <x> <y> [--moored | --drifting]
  naval_fate.py (-h | --help)
  naval_fate.py --version

Options:
  -h --help     Show this screen.
  --version     Show version.
  --speed=<kn>  Speed in knots [default: 10].
  --moored      Moored (anchored) mine.
  --drifting    Drifting mine.

"""
from docopt import docopt

if __name__ == '__main__':
    arguments = docopt(__doc__, version='Naval Fate 2.0')
    print(arguments) 
```

* * *

## 回答 #8

> 赞同：26
> 
> 时间：2012-05-11T03:53:30.243

```
#set default args as -h , if no args:
if len(sys.argv) == 1: sys.argv[1:] = ["-h"] 
```

* * *

## 回答 #9

> 赞同：20
> 
> 时间：2009-06-18T04:07:57.923

我自己使用 optparse，但非常喜欢 Simon Willison 最近推出的[optfunc](http://github.com/simonw/optfunc/tree/master)库所采用的方向。它的工作原理是：

> “内省函数定义（包括其参数及其默认值）并使用它来构造命令行参数解析器。”

因此，例如，这个函数定义：

```
def geocode(s, api_key='', geocoder='google', list_geocoders=False): 
```

变成了这个 optparse 帮助文本：

```
 Options:
      -h, --help            show this help message and exit
      -l, --list-geocoders
      -a API_KEY, --api-key=API_KEY
      -g GEOCODER, --geocoder=GEOCODER 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2009-06-18T01:30:28.080

我喜欢 stdlib 中的 getopt，例如：

```
try:
    opts, args = getopt.getopt(sys.argv[1:], 'h', ['help'])
except getopt.GetoptError, err: 
    usage(err)

for opt, arg in opts:
    if opt in ('-h', '--help'): 
        usage()

if len(args) != 1:
    usage("specify thing...") 
```

最近我一直在包装与此类似的东西以使事情不那么冗长（例如；使“-h”隐含）。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2014-08-12T19:38:40.957

Pocoo 的[点击](http://click.pocoo.org/)更直观，需要的样板更少，并且至少和 argparse 一样强大。

到目前为止，我遇到的唯一弱点是您无法对帮助页面进行太多自定义，但这通常不是必需的，并且当它需要时，[docopt](http://docopt.org/)似乎是明确的选择。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2011-08-23T12:57:14.650

如您所见， [optparse](http://docs.python.org/library/optparse.html#module-optparse) “Optparse 模块已弃用，不会进一步开发；开发将继续使用[argparse](http://docs.python.org/library/argparse.html#module-argparse)模块。”

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2017-10-07T03:25:07.257

```
import argparse

parser = argparse.ArgumentParser(description='Process some integers.')
parser.add_argument('integers', metavar='N', type=int, nargs='+',
                   help='an integer for the accumulator')
parser.add_argument('--sum', dest='accumulate', action='store_const',
                   const=sum, default=max,
                   help='sum the integers (default: find the max)')

args = parser.parse_args()
print(args.accumulate(args.integers))

Assuming the Python code above is saved into a file called prog.py
$ python prog.py -h

Ref-link: https://docs.python.org/3.3/library/argparse.html 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2011-02-06T19:28:43.630

您可能对我编写的一个 Python 小模块感兴趣，它使命令行参数的处理更加容易（开源且免费使用）[-Commando](http://freshmeat.net/projects/commando)

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2015-11-11T22:10:35.503

另一种选择是[argh](https://pypi.python.org/pypi/argh)。它建立在 argparse 之上，并允许您编写如下内容：

```
import argh

# declaring:

def echo(text):
    "Returns given word as is."
    return text

def greet(name, greeting='Hello'):
    "Greets the user with given name. The greeting is customizable."
    return greeting + ', ' + name

# assembling:

parser = argh.ArghParser()
parser.add_commands([echo, greet])

# dispatching:

if __name__ == '__main__':
    parser.dispatch() 
```

它会自动生成帮助等等，你可以使用装饰器来提供关于 arg-parsing 应该如何工作的额外指导。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2013-08-18T06:21:51.340

我建议将[docopt](http://docopt.org/)视为其他这些的简单替代方案。

docopt 是一个新项目，它通过解析您的 --help 使用消息而不是要求您自己实现所有内容来工作。您只需要将您的使用信息以 POSIX 格式输入。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2020-12-04T13:20:55.913

同样使用 python3，您可能会发现使用 Extended Iterable Unpacking 来处理可选的位置参数很方便，而无需额外的依赖：

```
try:
   _, arg1, arg2, arg3, *_ = sys.argv + [None] * 2
except ValueError:
   print("Not enough arguments", file=sys.stderr) # unhandled exception traceback is meaningful enough also
   exit(-1) 
```

上面的`argv`unpack make`arg2`和`arg3`"optional" - 如果它们没有在 中指定`argv`，它们将是 None，而如果第一个没有指定，ValueError 将是你的：

```
Traceback (most recent call last):
  File "test.py", line 3, in <module>
    _, arg1, arg2, arg3, *_ = sys.argv + [None] * 2
ValueError: not enough values to unpack (expected at least 4, got 3) 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-10-24T12:48:37.020

我的解决方案是[entrypoint2](https://github.com/ponty/entrypoint2)。例子：

```
from entrypoint2 import entrypoint
@entrypoint
def add(file, quiet=True): 
    ''' This function writes report.

    :param file: write report to FILE
    :param quiet: don't print status messages to stdout
    '''
    print file,quiet 
```

帮助文本：

```
usage: report.py [-h] [-q] [--debug] file

This function writes report.

positional arguments:
  file         write report to FILE

optional arguments:
  -h, --help   show this help message and exit
  -q, --quiet  don't print status messages to stdout
  --debug      set logging level to DEBUG 
```

# jquery - jQuery replaceWith，追加，前置不起作用

> ID：1009861
> 
> 赞同：0
> 
> 时间：2009-06-17T22:38:45.977
> 
> 标签：jquery, css, xhtml, append

我正在尝试在 li 中添加一些东西，托管在 a 中，`#container #boxes #third li a`但它并不能正常工作。

我正在使用以下代码：

```
$('#container #boxes #third li a').append(kevintext); 
```

但每当我这样做时，什么都没有发生。您可以在我的[测试页面上](http://nth.brandonwang.org/stuhf2/)查看实际代码。

因为这不起作用，我尝试了其他方法：用其他文本替换页脚中的 span（因此禁用 JavaScript 的人不会看到“悬停在我身上”并尝试悬停）。

我使用了以下代码：

```
$('#footer span').replaceWith('<i>For design info, mouse over me.</i>'); 
```

那也不起作用，所以我认为这可能与我的代码有关，并且可能一个修复程序可以解决这两个问题？

请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T23:01:44.057

你所拥有的应该工作。它可能不是的主要原因是因为（至少通过我对 assets/script.js 的快速浏览）你试图在 $(document).ready() 之外运行它 - 没有将你的代码包装在这个函数中（您为另一部分所做的）元素尚未创建，因此此时不会发生任何事情。

# web-services - 有状态的 Web 服务有多好和/或有多必要？

> ID：1009863
> 
> 赞同：19
> 
> 时间：2009-06-17T22:39:11.543
> 
> 标签：web-services, session, stateful

你们在实际项目中看到什么样的服务器？

1) Web 服务必须是无状态的：基本上你必须在每个请求中发送用户名/密码，每个请求都必须使用 HTTPS，如果需要，我将每次都验证并加载用户对象。

2) Web 服务的会话：就像在 Web 容器中一样，因此我至少可以保存经过身份验证的用户对象并具有类似于会话 ID 的内容，因此我不需要在每个请求上都进行身份验证、加载和检查用户。

3）Sticky Service（跨请求的持久服务）：[https ://jax-ws.dev.java.net/nonav/2.1/docs/statefulWebservice.html](https://jax-ws.dev.java.net/nonav/2.1/docs/statefulWebservice.html)

我了解有状态服务（以及 Web 应用程序会话）的可伸缩性问题，但有时您必须拥有某种状态，例如购物车。但是您也可以将此状态放入数据库（将后端用作一种会话*argh*）或将整个状态传递给客户端（客户端负责重新发送整个购物车）。

事实是，至少对于 Web 应用程序，会话在许多情况下都有很大帮助。如果您的系统接受“如果他的 Web 服务器发生故障，用户必须重新开始他正在做的任何事情”，则可以忽略可伸缩性问题，或者如果这是不可接受的，您可以尝试使用会话集群。

Web 服务的情况如何？我倾向于得出结论，Web 服务与 Web 应用程序非常不同，并且接受选项 1)（总是无状态的），但很高兴听到基于实际项目经验的其他意见。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2010-02-09T23:39:07.757

虽然这只是一个很小的区别，但仍应提及：

杀死可扩展性的不是**Web 服务**中的状态，而是托管 Web 服务**的应用服务器上的状态会杀死可扩展性。**当你说这个用户需要访问这个服务器时（就像在粘性会话中所做的那样），你实际上是在限制你的可伸缩性选项。您想要达到的一点是“您的任何免费负载平衡应用服务器”都可以处理此 Web 服务请求，如果我**再添加 1 个应用服务器，我应该能够处理 % more users**。

如果您想维护状态以传递身份验证令牌并在每个请求中获取服务以从数据存储中检索您的“状态”（最好是冗余和分区的，例如分布式+复制密钥），这完全可以（并且个人推荐） /值数据存储）。这就是 Amazon 使用 SimpleDb 和 Google 使用 BigTable 的方式。

Ebay 采用了一种稍微不同的方法，并将大多数客户端状态存储在一个 cookie 中，这样它就可以随每个请求一起传递。尽管它产生了更多的流量，但它仍然具有可扩展性，因为它们的任何服务器仍然可以处理请求。

如果您想要一个可扩展的数据存储，我建议您查看[redis](http://code.google.com/p/redis/)，它具有键/值数据存储无法比拟的速度和功能。

如果您想获得有关如何构建快速和可扩展服务的好资料，还应该查看[highscalability.com 。](http://highscalability.com)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-17T22:46:03.667

理想情况下，网络服务（和网站）应该是无状态的。

不幸的是，这需要经过深思熟虑的问题域和清晰的关注点分离。

我发现在实践中，**大多数**真实世界*的网站*都依赖于状态，即使这限制了它们的可扩展性。

我还发现**许多**现实世界的*Web 服务*也依赖于状态。

最终，“正确”的决定是针对特定问题的决定，因此编写一个依赖于状态的 Web 服务并在以后在可伸缩性成为问题时对其进行重构可能是可以的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T22:45:14.153

高度依赖于服务是否面向单一事务（例如获取股票报价），或者服务的输出是否依赖于跨多个事务的特定客户端提供的数据（在这种情况下，必须保持状态。）

就可伸缩性问题而言，将状态存储在数据库中实际上并不是一个糟糕的方法（事实上，如果您在服务器场中对服务进行负载平衡，这可能是唯一的方法。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T23:20:41.867

我认为对于 Flex 客户端，状态会从服务中移出并进入客户端层。保持服务无状态，让客户端维护所需的状态。服务保持简单，客户可以随意将它们混合在一起。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T23:28:04.143

您似乎将状态和身份验证等同起来。也许您习惯于在会话状态中存储用户名和密码？

这不是必需的，即使使用旧的 ASMX Web 服务也是如此。只需将您需要的任何信息传递给“登录”操作即可。该操作将被定义为返回一个“Authentication Ticket”标头。

所有其他需要身份验证的操作都需要此“身份验证票证”标头。他们每个人都将检查标头以查看它是否代表一个有效的、经过身份验证的用户。如果是这样，那么他们将执行他们的任务。如果不是，那么它们将返回一个 SOAP 错误，指示需要进行身份验证。

不需要状态。只需确保可以在您的服务运行的任何服务器上验证身份验证票证（例如，在网络场中），您就可以了。

# java - 全文索引器（或缓存）如何工作？

> ID：1009868
> 
> 赞同：3
> 
> 时间：2009-06-17T22:40:14.757
> 
> 标签：java, caching, indexing, full-text-search

我想知道，全文搜索系统是如何实现的，能够非常快速地查询数百万个条目？请注意：我**不是**在谈论通过在空格处分隔内容来标记内容的系统，而是关于能够**从标记中间查询甚至部分的**系统（这是一个真正的挑战）。

**背景信息**
我尝试了一个自制的字符串缓存器（使用 Java），它能够搜索字符串，给定一个子字符串作为查询。子字符串**不需要**位于潜在检索字符串的开头。

它适用于大量字符串。缓存是使用
`TreeMap<Character,TreeSet<String>>`.

**添加条目**
对于要添加的字符串中的每个唯一字符：
获取该字符的集合，并将字符串添加到其中。

*示例：“test”首先拆分为“t”、“e”、“s”。
然后，我们检索这三个键的集合，并将“测试”添加到每个集合中。*

**Quereng**
查询是通过将查询拆分为唯一字符，检索每个字符 a `Set<String>`，构建所有集合的交集，最后搜索交集`contains()`以确保查询字符的正确顺序。

**基准测试**
在**3GHz**机器上，我添加了**2'000'000 个**字符串，**平均长度为 10**，随机内容。
完成了**100 个**查询。耗时：**最小值：0.4 秒，平均值：0.5 秒，最大值：0.6 秒**。浪费了
**1.5GB的内存。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T00:01:40.257

一种方法是存储文本所有尾部的排序排列（从某个点到结尾的文本）。

然后要找到一个子字符串，您可以在这些循环移位中对其进行二进制搜索。使用 32 位整数使用的内存将是每个原始字符 4 个字节。

ps：我听说有一种方法可以通过存储文本的[Burrows-Wheeler 变换](http://en.wikipedia.org/wiki/Burrows-Wheeler_transform)（每个原始字符 1 个字符）来完成类似的事情，但我似乎找不到任何对它的引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T00:10:44.403

我实现了这样一个系统，其中一个建议使用 n-gram 索引，特别是 3-gram 在网站上进行下拉。您将一个单词拆分为它的组成 n-gram，例如对于单词“hello”，您将得到“hel”、“lo”。然后你建立一个索引，以 n-gram 作为键，它们来自的词作为值。（为了速度，我使用了 trie，内存是一个较小的问题）。接下来，对于给定的查询，您通过与索引期间相同的过程将其分解为 n-gram，并对每个 n-gram 执行查找以获得可能匹配的列表。从该列表中，您选择匹配 n-gram 数量最多的单词。您还可以使用各种启发式方法。一个是单词开头的匹配通常更重要，因此您可以用 $ 填充所有单词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T23:00:49.067

你可能想看看 Lucene。但我认为总的来说，它们确实对输入文本进行了标记。也许不仅是空格，还可以使用较短的字内序列。我认为单字符标记是不可行的。

对于东方语言（没有空格），通常使用二元组，即两个字符序列。与英语的主要区别在于，两个字符通常已经是一个单词，并且要从中提取的基本字符集要大得多，因此二元组中已经有很多信息，并且独特的二元组要多得多。克。

# date - 对于定期或重复日期，什么是好的数据结构？

> ID：1009874
> 
> 赞同：12
> 
> 时间：2009-06-17T22:41:23.537
> 
> 标签：date, data-structures, recurring

是否有用于存储定期或重复日期的已发布数据结构？可以处理的东西：

1.  泵需要每五天回收一次。
2.  发薪日是每个第二个星期五。
3.  感恩节是十月的第二个星期一（美国：十一月的第四个星期四）。
4.  情人节是每年的 2 月 14 日。
5.  冬至（通常）是每年的 6 月 21 日和 12 月 21 日。
6.  复活节是在春分当天或之后的第一个满月之后的星期天（好吧，这有点牵强）。

我认为`cron`的内部数据结构可以处理#1、#4、#5（两条规则），也许还有#2，但我还没有看。MS Outlook 和其他日历似乎能够处理前五个，但我没有那个源代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T23:02:18.907

使用[iCalendar](http://www.ietf.org/rfc/rfc2445.txt)实现库，例如：[ruby](http://icalendar.rubyforge.org/)​​ 、[java](http://www.ohloh.net/p/qcal)、[php](http://www.ohloh.net/p/qcal)、[python](http://codespeak.net/icalendar/)、[.net](http://sourceforge.net/projects/dday-ical)和[java](http://ical4j.sourceforge.net/introduction.html)，然后添加对计算特殊日期的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T22:57:32.083

由于您指定重复的方式的所有这些变化，我会回避一个单一的数据结构实现来适应所有 5 个场景。

相反，我会（并且在以前的项目中）构建简单的结构来解决每种类型的重复。您可以将它们全部包装起来，使其感觉像一个单一的数据结构，但在引擎盖下它们可以做任何他们喜欢的事情。通过实现一个接口，我能够以类似的方式处理每种类型的重复，因此它感觉就像一个万能的数据结构。我可以向任何实例询问特定时间范围内的所有重复日期，这就是诀窍。

在确定具体实施之前，我还想更多地了解如何使用这些日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T23:10:36.100

如果您想亲自创建数据结构，我建议您使用哈希表（其中假期或事件是键，以新日期出现作为值），如果每次出现重复次数，您可以对值进行哈希处理在链表中找到一个部分，然后该部分包含所有出现的列表（这将使查找和插入在 O(1) 中运行）。

# c# - 在 ASP.NET MVC 中使用 HTML 单选按钮数组

> ID：1009875
> 
> 赞同：0
> 
> 时间：2009-06-17T22:41:30.010
> 
> 标签：c#, asp.net-mvc, model-view-controller

我试图遵循[这一点](https://stackoverflow.com/questions/811087/how-to-process-many-form-input-fields-using-asp-net-mvc)，但默认的模型绑定器让我的数组在服务器端为空。

HTML：

```
Question 1:
<input name="list[0]" type="radio" value="1000" />No
<input name="list[0]" type="radio" value="1001" />Yes
Question 2:
<input name="list[1]" type="radio" value="1002" />No
... 
```

控制器动作：

```
 public ActionResult Anamnesis(string[] list)
 { 
```

如果我只选择第二个“否”（缺少列表 [0]），则 DefaultModelBinder 无法将其转换为数组。

提前谢谢！

**更新#1**

根据评论重新格式化，谢谢！

**更新#2**

只是一个难题：在所有列表项*之后*创建了一个隐藏的输入，并且以这种方式工作。但它是丑陋的，毫无疑问。

```
Question 1:
<input name="list[0]" type="radio" value="1000" />No
<input name="list[0]" type="radio" value="1001" />Yes   
<input type="hidden" name="list[0]"/>
Question 2:
<input name="list[1]" type="radio" value="1002" />No
<input type="hidden" name="list[1]"/>
... 
```

订单**非常**重要：隐藏值仅在未选中单选时提交。它来自 ASP.NET MVC 助手的想法。（顺便说一句，我不能使用 Html.RadioButton 来存档此行为。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-26T00:33:34.030

您的更新 #2 似乎解决了您的问题。您的更新 #2 也很有趣，因为您还可以使用这种方法来提供默认值（例如 999），以便在未检查任何内容时使用。

也许还有另一种类似的方法来做你所要求的，它基于[这篇文章](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)并且也使用隐藏输入。这个想法是，您可以为每个单选机创建索引，以避免表单前面缺少选择导致所有后续选择被丢弃的情况：

```
Question 1:
<input name="list.Index" type="hidden" value="0" />
<input name="list[0]" type="radio" value="1000" />No
<input name="list[0]" type="radio" value="1001" />Yes
Question 2:
<input name="list.Index" type="hidden" value="1" />
<input name="list[1]" type="radio" value="1000" />No
<input name="list[1]" type="radio" value="1001" />Yes 
```

我建议这样做的原因是，您可能希望通过唯一 ID 将您的答案与特定问题相关联，而不是仅使用 0、1、2 等。我链接的文章将展示如何做的示例这。

祝你好运！
-麦克风

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-17T23:36:12.413

单选按钮的名称属性应该是 list，而不是 list[n]。

# iphone - 如何以不同的方式刷新 UIImagesViews？

> ID：1009881
> 
> 赞同：0
> 
> 时间：2009-06-17T22:42:59.290
> 
> 标签：iphone, graphics, uiimageview

我希望有人能引导我朝着正确的方向前进。

按下按钮后，我需要能够一次更新屏幕上的图像。似乎它们仅在周期结束时才更新，这不是我需要它的工作方式。

我创建了一个小例子来展示我在做什么。基本上我在屏幕上有 3 张图像。按下按钮时，我想更新第一张图像，播放声音，稍等片刻，然后更新下一张等。

但是，我只听到 1 个声音，最后所有图像都会更新。

似乎是一件简单的事情。我应该怎么做？

```
#import "testappViewController.h"

@implementation testappViewController

@synthesize p1,p2,p3;   //UIImageViews
@synthesize button1;
@synthesize volleyFileID;

- (IBAction)buttonpressed:(id)sender
{
    NSString *TLS = @"RQP.png";

    NSString *volleyPath = [[NSBundle mainBundle] pathForResource:@"click" ofType:@"caf"];
    CFURLRef volleyURL = (CFURLRef ) [NSURL fileURLWithPath:volleyPath];
    AudioServicesCreateSystemSoundID (volleyURL, &volleyFileID);

    TLS = @"RQP.png"; 
    UIImage *sampleimage=   [[UIImage imageNamed:TLS] retain];
    p1.image = sampleimage; 
    AudioServicesPlaySystemSound(volleyFileID);

    [NSThread sleepForTimeInterval:0.5];

    p2.image = sampleimage; 
    AudioServicesPlaySystemSound(volleyFileID);

    [NSThread sleepForTimeInterval:0.5];

    p2.image = sampleimage; 
    AudioServicesPlaySystemSound(volleyFileID);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T23:14:27.137

你不应该在这里使用 -[NSThread sleepForTimeInterval:] 。尝试使用-[NSObject performSelector:withObject:afterDelay:]，你的后两个图像变成一个单独的方法。然后您的事件循环将正常运行，您的声音将播放，并且您的整个应用程序将在运行时保持响应。

# macos - Qt（或任何mac API）中的大写锁定状态

> ID：1009883
> 
> 赞同：1
> 
> 时间：2009-06-17T22:43:22.283
> 
> 标签：macos, qt4, keyboard

我试图弄清楚如何在 Qt (4.5) 中获得大写锁定状态，但我设法从 qt 获得的唯一东西是大写锁定是否被按下或释放，然后无法获得实际状态.

为了解决这个问题，我尝试了依赖于平台的方法，并且在 xp 上进行了一些工作。但现在我正在寻找mac上的解决方案。我用谷歌搜索了很多但没有成功（或者可能是一些客观的 C API 或 HID Api）。

因此，如果有人知道如何使用 qt 或在 mac 上执行此操作，那就太好了。提前致谢，

鲍里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T01:25:05.313

如果查看 GPL 代码不会污染您，请参阅[VirtualBox/src/VBox/Frontends/VirtualBox/src/darwin/DarwinKeyboard.cpp](http://vbox.innotek.de/browser/trunk/src/VBox/Frontends/VirtualBox/src/darwin/DarwinKeyboard.cpp)。

特别是，它会`darwinHIDKeyboardCacheDoUpdate`查找所有键盘，并`darwinQueryHIDModifiers`遍历键盘以查找保留的修饰键。

正如评论所说：出于某种原因，这一切似乎都没有很好的记录......

我自己没有正在运行的 Mac，但是 VirtualBox 使用 Qt 4 作为它的 GUI，并且*仍然*需要深入研究 IOKit 本身才能在 Mac 上使用键盘修饰键，所以我猜这对于普通来说是不可能的Qt。

# .net - svcutil.exe - 生成的代理不允许为空字段

> ID：1009895
> 
> 赞同：7
> 
> 时间：2009-06-17T22:45:41.687
> 
> 标签：.net, wcf, wsdl, nullable, svcutil.exe

我正在尝试通过使用 svcutil.exe 创建 WCF 代理来使用使用 WSDL 指定的 Web 服务，但 WSDL 指定某些操作具有可选参数 (minOccurs="0")，例如：

```
<xs:element minOccurs="0" maxOccurs="1" name="meetingId" type="xs:int" /> 
```

不幸的是，生成的代理不允许我不指定值（参数不可为空），并且没有“指定”字段作为调用的一部分来指示代理不应发送任何值。

有什么方法可以使用 svcutil 生成允许我这样做的代理？

（附带说明一下，通过我的研究，我注意到其他人能够使用“添加服务引用”功能正确生成这些额外的“指定”字段，但无论出于何种原因，Visual Studio 似乎都不想在之后生成代理我添加了参考（之后什么都没有发生））

[WSDL 文件](http://sas-int.elluminate.com/site/external/adapter/default/v1/webservice.wsdl) [生成的代理](http://pastebin.com/m20688d39)

使用的命令：svcutil [http://sas-int.elluminate.com/site/external/adapter/default/v1/webservice.wsdl](http://sas-int.elluminate.com/site/external/adapter/default/v1/webservice.wsdl) /internal /n:*,Elluminate.WebService.WebServiceProxy /o:WebServiceProxy.cs /config:应用程序.config /nologo

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-19T16:47:19.883

我猜想生成的客户端代理类`svcutil`有一个名为`meetingId`type的字段/属性`int`- 对吧？是的，这是不可为空的——但我敢打赌，你也有一个布尔字段/属性被调用`meetingIdSpecified`——只有当它被设置`true`为时，服务才会真正查看它；如果你不设置它，那么服务将不会看值，所以它几乎就像它在哪里一样`NULL`。

此外 - 您也没有在 XSD 中指定该字段可为空 - 您将其指定为可选的。要使其可以为空，请在此处使用以下语法：

```
<xs:element minOccurs="0" maxOccurs="1" name="meetingId" type="xs:int" 
            nillable="true" /> 
```

看到“可为空”属性了吗？那是用于使字段真正可以为空的那个 - 您现在可以在您的 XML 中拥有这样的条目：

```
<root xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <meetingId xsi:nil="true" />
</root> 
```

马克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T14:15:32.580

如果它不适合您，请不要使用 SVCUtil。如果服务不是很复杂，您可以尝试手动编写服务接口，并使用 ChannelFactory<> 来创建您的代理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-05T10:41:18.560

这是一个问题，因为 minOccurs="0" 应该允许您不发出 'meetingId' 值，而生成的代理不允许它。

您只使用该服务，因此您无法控制 wsdl，并且您不能在 wsdl 中添加 nillable="true" 以便在您的代理中使用 'meetingId' 可选。

如果您使用 wsdl.exe 而不是 svcutil.exe 生成代理，您将拥有额外的字段“meetingIdSpecified”，允许您选择是否发出字段 meetingId。

```
wsdl.exe http:///myservice?wsdl 
```

但是使用 wsdl.exe，您将使用 asp.net Web 服务而不是 WCF 来使用您的服务。

我认为缺少的字段是 svcutil.exe 中的一个错误（对我来说是 4.0.30319.17929），因为如果您使用选项 /wrapped 生成：

```
svcutil.exe /wrapped http:///myservice?wsdl 
```

..那么您还将生成“meetingIdSpecified”字段！

# vb.net - 选择大小写检查十进制数的范围

> ID：1009902
> 
> 赞同：10
> 
> 时间：2009-06-17T22:48:27.580
> 
> 标签：vb.net

我需要检查一个 demical 是 0 到 49.99 还是 50 到 99.99 或 100 到 199.99 或大于 200。我正在尝试使用选择案例来执行此操作，但我不确定语法。请帮忙！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-06-17T22:50:53.173

```
 Select Case aa
        Case 1 To 1.49
            MsgBox(1)
        Case 1.5 To 2
            MsgBox(2)
        Case Else
            MsgBox("was lower than 1 or higher than 2 or between 1.49 and 1.5")
    End Select 
```

这（下）将进入其他情况

```
 Dim aa As Double = 1.499 
```

这（下）将进入案例 1 到 1.49

```
 Dim aa As Double = 1.4 
```

这（下）将进入案例 1.5 到 2

```
 Dim aa As Double = 1.78 
```

其他方式：[从这里](https://stackoverflow.com/questions/1009902/select-case-to-check-range-of-a-decimal-number/1009930#1009930)

```
 Select Case value
        Case Is <= 49.99
            Debug.WriteLine("first group")
        Case Is <= 99.99
            Debug.WriteLine("second group")
        Case Is <= 199.99
            Debug.WriteLine("third group")
        Case Else
            Debug.WriteLine("fourth group")
    End Select 
```

也许这也是：

```
 Select Case true
        Case (value >= 0 andalso value <= 49.99)
            Debug.WriteLine("first group")
        Case (value >= 50 andalso value <= 99.99)
            Debug.WriteLine("second group")
        Case (value >= 100 andalso value <= 199.99)
            Debug.WriteLine("third group")
        Case Else
            Debug.WriteLine("fourth group")
    End Select 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-17T22:58:26.247

```
 Dim value As Double = 133.5
        Select Case value
            Case Is <= 49.99
                Debug.WriteLine("first group")
            Case Is <= 99.99
                Debug.WriteLine("second group")
            Case Is <= 199.99
                Debug.WriteLine("third group")
            Case Else
                Debug.WriteLine("fourth group")
        End Select 
```

在您的问题中，49.992 的值在哪里？既然你说的是 0-49.99，然后是 50-99.99，那么 49.99 到 50 之间的任何东西都去哪儿了？在我上面的示例中，它将包含在选项之一中，因此它的值介于 0 和 49.99 之间，值介于 49.99 和 99.99 之间，等等。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-18T18:34:53.300

我怀疑你提出这个问题是为了准确地说出你的意思。您真的希望第一组**仅**包含0 到 49.99 吗？或者你真的是指 0 到但不包括 50，并且你只是希望你的输入有 2 个小数位或更少？如果你想按 50 对数字进行分组，那么写起来很奇怪：

```
Select Case value
    Case Is <= 49.99
        Debug.WriteLine("49.99 or less")
    Case Is <= 99.99
        Debug.WriteLine("greater than 49.99, 99.99 or less")
    ' ... and so on '
End Select 
```

这里的数字**49.995**属于第二组，这似乎违反直觉。选择两位小数作为截止点是任意的。

'<=' 运算符不是这里的方法；使用“<”运算符；这更有意义：

```
Select Case value
    Case Is < 50
        Debug.WriteLine("less than fifty")
    Case Is < 100
        Debug.WriteLine("fifty or greater, less than 100")
    ' ... and so on '
End Select 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-17T23:02:27.130

AlbertEin 在做一些事情，但是要在 VB.Net 中进行整数除法，你必须这样写：

```
Dim range as Integer
range = someInteger \ 50 
```

注意向后除法符号。从那里你可以`Select Case range`。

但实际上，jvanderh 的回答最能表达你想要做什么，因为它允许在未来轻松添加不会打破 50 的倍数并且不需要未来的维护者遵循数学或了解 \操作员。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-17T22:51:23.407

```
Dim range as Integer
range = someInteger / 50
'So, if range = 0 is 0-49.99, if it's 1 it's 50 to 99.99, etc 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T22:50:35.327

你为什么不试试 if/then/else？它们是等价的，我不确定 VBasic 中的 case 语句是否可以处理非整数值。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-17T23:04:16.347

这就是我的做法，我使用 # 明确声明值的类型为“double”。

```
 Dim input As Double = 2.99

    Select Case input
        Case 0.0# To 49.99#
            Response.Write("Between 0 to 49.99")
        Case 50.0# To 99.99#
            Response.Write("Between 50 and 99.99")
        Case Else
            Response.Write("The value did not fall into a range.")
    End Select 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-12-29T06:48:13.387

```
Structure employee
    Dim percent As Decimal
    Dim dayname As DayOfWeek
End Structure

Dim emp As employee

 emp.percent = CDec(45.5)
 emp.dayname = DayOfWeek.Friday

Select Case True

    Case (emp.percent >= 0 And emp.percent <= 49.99 
                   And emp.dayname = Now.DayOfWeek)

        MsgBox("Employee percentage   " & emp.percent 
                & "Name of the day  " & Now.DayOfWeek.ToString)

End Select 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-09-22T02:08:53.823

我遇到了这个问题，但这些回答仍然让太多的事情落入空白。

```
'In this example, a value of 49.991 - 49.999* will fall in the 99.99 category, where I expect it is intended for the 49.99 category
Select Case value
    Case Is <= 49.99
        Debug.WriteLine("first group")
    Case Is <= 99.99
        Debug.WriteLine("second group")
    Case Is <= 199.99
        Debug.WriteLine("third group")
    Case Else
        Debug.WriteLine("fourth group")
End Select 
```

相反，最好颠倒顺序，以避免为了缩小差距而必须指定多余的小数位。

```
Select Case value
    Case Is >= 200
        Debug.WriteLine("fourth group")
    Case Is >= 100
        Debug.WriteLine("third group")
    Case Is >= 50
        '49.9999* will always fall in this group irrespective of number of decimal places
        Debug.WriteLine("second group")
    Case Else
        Debug.WriteLine("first group")
End Select 
```

该`Select Case`语句仅遵循第一个真实案例，因此即使后续案例也可能为真，但如果被更早的案例捕获，它们将被绕过。

# scope - 有限的问题

> ID：1009905
> 
> 赞同：1
> 
> 时间：2009-06-17T22:50:10.477
> 
> 标签：scope

对于特定语言（和或主题），是否可以提出有限数量的问题，例如 - 对于 T-SQL，鉴于只有这么多命令，是否可以有有限数量的非重复性问题？如果是这样，您是否可以使用它来确定像 stackoverflow 这样的网站的大小，并确定一个新问题重复前一个问题的概率？如果有一个有限的数字，您将如何确定/计算它：例如，T-SQL 有 x 个命令，每个命令都可以有一组相关问题（语法、使用示例等） - 也可以# 问题 = x 乘以潜在问题乘以一些相关变化？或类似的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-17T22:55:09.110

不，因为从理论上讲，程序可以是无限长的，而且这个网站不仅仅是关于语言命令，而是用这些语言开发的程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T22:56:00.963

我很确定图灵会说不，如果你不相信他，他们哥德尔可能会有话要说。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T23:17:26.740

堆栈溢出问题表示为有限长度的字节序列。原则上，可以用整数来考虑问题主体，首先表示最低位，以 256 为基数（或更大，如果您希望将其视为 unicode）。这是问题和整数之间的双射。因此，所有堆栈溢出问题的集合具有可数无限的基数（我如何在 SO 中排版 \aleph_0？）。

# blackberry - Blackberry Development - 关于参考资料和工具的任何建议？

> ID：1009910
> 
> 赞同：6
> 
> 时间：2009-06-17T22:51:40.083
> 
> 标签：blackberry

我正在寻找好的参考资料，并愿意接受有关可用于为 Blackberry 开发的好的 IDE 工具的建议。我去过 RIM 的网站并试用了他们的 IDE，但是在我上次使用时，它在 Vista 和用户访问控制方面存在问题。对此的任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T23:16:16.837

您可以使用 Eclipse 为 Blackberry 平台开发，使用[Blackberry JDE 插件](http://na.blackberry.com/eng/developers/javaappdev/javaeclipseplug.jsp)。

我只是亲自玩过它，但没有任何问题（当时运行 Vista SP1）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-18T07:18:17.057

我使用了一些奇怪的配置：用于开发代码的 IntelliJ Idea（只是因为我已经使用它多年并且我熟悉它并且我将它用于系统的其他部分）和用于运行模拟器的 BlackBerry JDE ，调试，附加到设备等。对于部署或上传到设备的编译和签名，我使用[ant tasks](http://bb-ant-tools.sourceforge.net/)。我知道 - 奇怪 - 但它有效。这些天我可能会尝试 Eclipse 插件，因为我看到它在 WES 2009 上进行了演示，它看起来相当不错。

至于关于 Vista 问题的评论 - 我在 Vista 64 位上使用上述开发工具很好。只有几个问题可以解决：

1.  不要将 JDE 或模拟器安装在默认的 C:\Program Files 文件夹中，因为它们需要在运行时写入自己的目录，而 Vista 不喜欢用户帐户写入 C:\Program Files 下的任何子目录。我在 C:\rim 中安装了我的 JDE 和模拟器
2.  如果您使用的是 64 位操作系统，请确保安装 32 位 Java SDK 以运行和编译。模拟器和可能的 JDE 中包含无法使用 64 位 Java SDK 运行的本机 32 位代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T23:19:16.330

我建议使用 NetBeans 或 Eclipse 进行开发。其中任何一个都是比 RIM JDE 优越得多的 IDE。在过去的 9 个月里，我一直使用 NetBeans 进行 Blackberry 开发并取得了很好的成功。在参考资料方面，我建议您使用 Blackberry Java 论坛作为您的知识库；几乎我提出的每一个问题都在那里得到了解答。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T22:55:59.623

我在 vista 上使用他们的模拟器时也遇到了问题。我会考虑在 vm 上安装 xp/server 2003/（在此处插入您最喜欢的非 vista os），并将其用作您的开发环境（我强烈推荐 VMWare。）

# javascript - JavaScript：获取传递变量的参数值和名称

> ID：1009911
> 
> 赞同：53
> 
> 时间：2009-06-17T22:51:49.413
> 
> 标签：javascript, arguments

我想要做的是获取传递给函数的变量的名称和该变量*的*值，并且只需将一个变量传递给函数。所以：

```
var x = "anything";

function showName() {

}

showName(x); 
```

或者

```
showName("x"); 
```

这将返回：“x = 任何东西”。

现在，我必须指定变量两次：

```
showName("x", x); 
```

为了获取我传入的变量的名称和值。

请注意，我对 showName 原型中的参数名称不感兴趣，而是调用函数中的变量名称。另外，传递的变量可能是本地的，所以我不能使用窗口对象来查找变量。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-06-17T23:15:23.110

简短的回答是你不能。

更长的，邪恶的答案是，你可以有一些真正的肮脏。它仅在从另一个函数调用时才有效。

有两个有趣的属性可供您使用

arguments.callee 调用者

让 fn 做这样的事情：

```
(function(){
  var showMe = function(s){
    alert(arguments.callee.caller.toString().match(/showMe\((\S)\)/)[1] + 
    ' = '+ s)
  }
  x = 1
  showMe(x)
})() 
```

arguments.callee.caller.toString().match(..)[1] 所做的是在调用它的函数中查找被调用的 showMe 并打印它及其值。

但这仍然非常有限，因为它只会触发 showMe(x) 的第一次调用。因此，如果有两次调用它，它将不起作用。

但是，玩这些神秘的东西很有趣。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-18T17:43:36.723

**策略一：**

如果您可以在函数调用期间控制数据结构，那么您可以传递一个字典，它将名称编码为键，并​​与它的值配对，注意隐形花括号：

```
var foo = "bar";
yourfunction({foo}); 
```

它传递了一个看起来像这样的 javascript 字典：

```
{foo : "bar"} 
```

执行时`yourfunction(`，解压缩名称和值：

```
yourfunction = function(dict) { 
    var name = Object.keys(dict)[0];
    var value = dict[name];
    console.log(name);        //prints foo
    console.log(value);       //prints bar
} 
```

**策略二：**

如果您可以在全局范围内维护一个随用随用的名称-值对列表，那么反射和自省始终可用于设置和获取，例如：

```
var my_global_stack = [];

yourfunction = function() { 

    //Chomp the stack
    var dict = my_global_stack.pop();

    //The name is the key at index 0
    var name = Object.keys(dict)[0];

    //Fetch the value by keyname:
    var value = dict[name];

    console.log(name);       //prints foo
    console.log(value);      //prints bar
}

foo = "bar";
my_global_stack.push({foo});
yourfunction(); 
```

**策略三：**

如果用户恶意输入不是问题，您可以使用`eval(`重新发现给定变量名的值，例如：

```
yourfunction = function(somevariable) { 
    console.log(somevariable);          //prints foo
    console.log(eval(somevariable));    //prints bar
}

foo = "bar";
yourfunction("foo"); 
```

人们在这里说`eval(`是邪恶的，因为如果敌对用户能够`foo`在任何时候覆盖内存中的值，那么他们就可以进行操作系统命令注入并运行他们想要的任何命令。
[http://cwe.mitre.org/top25/#Guidance](http://cwe.mitre.org/top25/#Guidance)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-17T23:01:37.973

```
var x = "anything";

function showName(s) {
    alert(s + " = " + eval(s));
}

showName("x"); 
```

不推荐，但有。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T23:19:27.983

您可以创建一个哈希并将其传递给：

```
var x = {a: 1,b:2}
function showVars(y) {
    for (var z in y) { alert(z + " is " + y[z]); }
}
showVars(x); 
```

这不一定显示变量的名称，但它确实允许键值对，这可能更符合您的需要。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-15T20:21:00.270

这是我用来调试的。没有全局变量，没有 eval，没有 arguments.callee 或 arguments.caller：

```
var Helpers = (function () {
    // ECMAScript 5 strict mode
    'use strict';

    var Module = {};

    Module.debug = function () {
        var i;

        for (i = 0; i < arguments.length; i++) {
            console.log(arguments[i] + ':', this[arguments[i]]);
        }
    };

    Module.SomeObject = function SomeObject() {
        this.someMember = 1;
        this.anotherMember = 'Whatever';

        Module.debug.call(this, 'someMember', 'anotherMember');

        var privateMember = {
            name: 'Rip Steakface',
            battleCry: 'Raaaaaaaaahhhhhhhhhrrrrrrrrrg!'
        };

        Module.debug.call(privateMember, 'name', 'battleCry');
    };

    return Module;
}()); 
```

对于那些想知道为什么要这样做的人，这只是一种有效地记录多个变量及其名称的方法。

如果您希望能够记录嵌套成员，如 中`Module.debug.call(obj, 'hair.fluffiness')`，您可以像这样修改函数：

```
Module.debug = function () {
    var i, j, props, tmp;

    for (i = 0; i < arguments.length; i++) {
        tmp = this;
        props = arguments[i].split('.');

        for (j = 0; j < props.length; j++) {
            tmp = tmp[props[j]];
        }

        console.log(arguments[i] + ':', tmp);
    }
}; 
```

不幸的是，我找不到任何方法来有效地记录多个不是对象成员的私有变量，例如`var roll = 3, value = 4; Module.debug.call(???);`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T23:16:50.657

不确定您是否可以*直接*从 JavaScript 中获取您想要的内容，因为变量名不与它引用的值一起携带（将变量名视为只有编译器知道的标识符；但在运行时会被丢弃）。

但是，您*可以做一些稍微**不同*的事情，允许传递命名参数。创建一个匿名对象并将其传递给您的函数：

```
function showNames(o)
{
    for( var ix in o )
    {
       alert( ix + ":" + o[ix] );
    }
}

var z = { x : "Anything" }
showNames( z );
// or
showNames( { a : "ay", b : "bee", c: "see" } ) 
```

对于迭代对象属性，我倾向于使用函数式样式，例如：

```
Array.iteri = function(o, f)
{
    for(var i in o) { f(i, o[i]) }
}

function showNames(o)
{
    Array.iteri( o, function(i,v)
    {
        alert( i + ": " + v )
    });
}
showNames( { a : "ay", b : "bee", c: "see" } ) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-07-12T00:01:34.323

下面的代码是你能做的最好的。不幸的是，函数中的局部变量是隐藏调用对象的属性，因此不能从像 window[a] 这样的 Javascript 访问它们，其中 a 是窗口对象的属性。

```
x = "this is x";
var say = function(a) {
    document.write(a + " = " + window[a]);
}
say("x");

var wrapper = function () {
    var x = "this is x";
    document.write(x + " = " + eval("x"))
}
wrapper() 
```

# c# - 从外部线程关闭模式对话框 - C#

> ID：1009913
> 
> 赞同：9
> 
> 时间：2009-06-17T22:52:10.223
> 
> 标签：c#, winforms, user-interface

我正在努力寻找一种方法来创建我想要使用 C# 的表单功能。

基本上，我想要一个具有指定超时期限的模式对话框。看起来这应该很容易做到，但我似乎无法让它发挥作用。

一旦我调用`this.ShowDialog(parent)`，程序流程就会停止，如果没有用户首先单击按钮，我将无法关闭对话框。

我尝试使用 BackgroundWorker 类创建一个新线程，但我无法让它关闭另一个线程上的对话框。

我在这里遗漏了一些明显的东西吗？

感谢您提供的任何见解。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-17T22:55:27.347

您将需要在创建表单的线程上调用 Close 方法：

```
theDialogForm.BeginInvoke(new MethodInvoker(Close)); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-17T23:12:25.160

使用[System.Windows.Forms.Timer](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.aspx)。将其[Interval](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.interval.aspx)属性设置为您的超时，并将其[Tick](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.tick.aspx)事件处理程序设置为关闭对话框。

```
partial class TimedModalForm : Form
{
    private Timer timer;

    public TimedModalForm()
    {
        InitializeComponent();

        timer = new Timer();
        timer.Interval = 3000;
        timer.Tick += CloseForm;
        timer.Start();
    }

    private void CloseForm(object sender, EventArgs e)
    {
        timer.Stop();
        timer.Dispose();
        this.DialogResult = DialogResult.OK;
    }
} 
```

计时器在 UI 线程上运行，因此从滴答事件处理程序中关闭表单是安全的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-09-22T15:03:37.893

如果您真的只是想要一个模态对话框，那么我发现这是迄今为止最好的解决方案：http: [//www.codeproject.com/KB/miscctrl/CsMsgBoxTimeOut.aspx](http://www.codeproject.com/KB/miscctrl/CsMsgBoxTimeOut.aspx)（阅读评论部分进行小的修改）。

如果您想以模态方式显示自己的表单，那么 adrianbanks 的解决方案是最好的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T22:54:42.573

您可以从后台线程[调用关闭](http://weblogs.asp.net/justin_rogers/pages/126345.aspx)

# c# - 单例代码摘录，一个面试问题

> ID：1009914
> 
> 赞同：6
> 
> 时间：2009-06-17T22:53:04.323
> 
> 标签：c#, design-patterns

我还有一个面试问题。我认为这很愚蠢，但也许我缺少一些东西。问题询问这是哪种 GoF 模式（答案：单例），以及，如果有任何问题，我如何解决它们。

我没有看到任何问题。我提到这永远不会被释放，我希望从这种模式中得到释放。这就是我所说的。我错过了什么吗？

```
public class Class1
{
    private static Class1 oInstance = null;
    private Class1() { }
    public static Class1 GetInstance()
    {
        if (oInstance == null)
        {
            oInstance  = new Class1();
        }
        return oInstance ;
    }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-17T22:56:02.447

线程安全 - 如果从竞争线程中调用 GetInstance()，则可以创建多个实例。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-17T22:57:31.930

请参阅：[.NET 的明显单例实现？](https://stackoverflow.com/questions/953259/an-obvious-singleton-implementation-for-net)

在实现单例模式时，您需要考虑多个问题。

*   当**多个调用者从****多个线程**请求单例时会发生什么。它应该可以工作。
*   何时调用Singleton 实例**构造函数。**您可能希望推迟它，以便它在第一次调用请求单例时发生，您可能希望它在其他时间首先实例化。
*   人们应该能够**继承**你的单例类吗？行为应该是什么？
*   单例实例化后是否可以将您的单例实例切换到不同的实例。对此回答是违反了单例模式，因此通常保存单例的字段应该是**只读**的。
*   API 设计中，应该使用**属性**还是**方法**来返回 Singleton 实例。
*   **有人**说**单身是邪恶的**。您是否应该首先考虑它。这已经经常讨论一个很好的起点是[http://blogs.msdn.com/scottdensmore/archive/2004/05/25/140827.aspx](http://blogs.msdn.com/scottdensmore/archive/2004/05/25/140827.aspx)

以下是您可以遵循的一个很好的通用模式。它的线程安全、密封、使用属性和延迟实例化单例。

```
public sealed class Singleton
{
    static class SingletonCreator
    {
        // This may seem odd: read about this at: http://www.yoda.arachsys.com/csharp/beforefieldinit.html
        static SingletonCreator() {}
        internal static readonly Singleton Instance = new Singleton();
    }

    public static Singleton Instance
    {
        get { return SingletonCreator.Instance; }
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-17T23:05:36.110

其他人提到线程安全。还有一个事实是他们忘记将其标记为`sealed`，因此您可以从它继承并以这种方式创建多个实例。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-17T22:56:29.967

您在多线程代码中有潜在的竞争条件。在另一个线程上的构造函数完成之前，两个线程都可以通过 null 检查，因此两个线程都可以最终构建类。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-17T22:59:59.553

代码不是线程安全的。要做到这一点，您需要这样做：

```
public class Class1
{
    private static Class1 oInstance = null;
    private Class1() { }
    public static Class1 GetInstance()
    {
        if (oInstance == null)
        {
            lock(typeof(Class1))
            {
                if (oInstance == null)
                {
                    oInstance = new Class1();
                }
            }
        }
        return oInstance ;
    }
} 
```

这是延迟加载实例的最有效方式，因为它只会在怀疑不会为下一次调用实例化实例时才需要锁定（可能很昂贵）。在锁中再次检查确保它只会被实例化一次。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T22:57:10.540

如果您有一个多线程应用程序，则存在潜在问题。如果两个线程同时请求，这可能会导致构造多个实例。

我会看看这个关于[Singletons in C#](http://www.yoda.arachsys.com/csharp/singleton.html)的页面。它详细显示了问题以及更好的选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-17T23:33:18.423

不要在那家公司工作。单例模式不是一种常用的模式，它在纯 OO 系统中的适用性值得怀疑。如果您需要将单例模式恢复为正常构造的对象，那么撤消单例模式是一个大问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-18T00:37:21.323

它缺少线程安全，[这个页面](http://www.yoda.arachsys.com/csharp/singleton.html)解释得很好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-17T23:03:12.883

那么解决方案如下吗？

```
public class Class1
{
    private static Class1 oInstance = new Class1();
    private Class1() { }
    public static Class1 GetInstance()
    {
        return oInstance ;
    }
} 
```

# iphone - iPhone 仅在导航控制器下的特定屏幕上自动旋转

> ID：1009915
> 
> 赞同：1
> 
> 时间：2009-06-17T22:53:05.620
> 
> 标签：iphone, uinavigationcontroller, rotation

这只是我遇到的基本问题的一个例子，所以如果这种情况听起来有点毫无意义，请不要担心；）

假设我有一个主要是 UINavigationController 的应用程序，只有两层深。顶层是一个包含图像文件名列表的表格，第二层只有一个 UIImageView 显示您点击的文件名的图像。

对于这样的应用程序，有没有人知道一种让顶层表格自动旋转同时保持第二层图像固定在纵向模式的好方法？

到目前为止，我几乎可以到达那里......但是当我在横向模式下点击文件名时，即使二级视图控制器的 shouldAutorotateToInterfaceOrientation 仅针对纵向模式返回 yes，图像也会以错误的方向滑入视图。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-19T01:04:18.410

在 iPhone OS 2.x 中没有很好的方法来做到这一点，但在 3.0 中，他们已经大大改进了它。

在 2.x 中，仅在**更改**`shouldAutorotateToInterfaceOrientation:`方向时才遵循委托方法，因此您会得到您所描述的行为：如果它在另一个视图控制器中旋转，即使新视图控制器也将通过推送和弹出保持旋转不支持旋转到那个方向。

 **在 3.0 中，UINavigationController`shouldAutorotateToInterfaceOrientation:`会在每次推送或弹出时进行轮询，并遵循它返回您期望的方式，例如：如果您当前以横向左方向旋转，并且您推送仅支持纵向方向的视图控制器实例`shouldAutorotateToInterfaceOrientation:`，它会自动并立即翻转逻辑方向，并以纵​​向方向以正确的方式在新视图中滑动。

请注意，这仅适用于链接到（因此需要）3.0 的应用程序。对于链接到 2.x 的应用程序，它将模拟旧行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-18T05:57:13.460

问题是，如果您使用自动旋转，整个 UI（包括我相信的 UIWindow 实例）都会被旋转。

此时推送到导航控制器上的任何内容都将在横向中完成。

因此，当您推送 imageview 时，这正是您所得到的。

要使其正常工作，您必须：

1.  手动处理根视图的旋转（使用变换）
2.  使用变换通过 -PI/2 取消旋转图像视图。

无论哪种方式，您都必须手动执行转换才能使其正常工作。

作为旁注，这可能是糟糕的 UI 设计。作为用户，我希望当我向下钻取图像时，图像会正面朝上。但这是在不知道您的应用程序的确切上下文的情况下进行的。**

# iphone - 有什么方法可以在 iPhone 上创建日志文件

> ID：1009919
> 
> 赞同：1
> 
> 时间：2009-06-17T22:54:54.650
> 
> 标签：iphone

我想在设备上的日志文件中记录我的 iPhone 应用程序活动。你能告诉我我该怎么做吗？如何访问该文件？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T23:06:25.873

是的，你可以这样做。看

[如何使用 NSLog(@"Inside of the iPhone Simulator") 进行调试？](https://stackoverflow.com/questions/558568/how-do-i-debug-with-nsloginside-of-the-iphone-simulator)

它回顾了在使用开发环境时从模拟器或从 iphone（系留）获取日志信息的多种方法。

# c# - 如何重置 table.DefaultView.RowFilter？

> ID：1009932
> 
> 赞同：20
> 
> 时间：2009-06-17T22:59:03.720
> 
> 标签：c#, datatable, reset, rowfilter, defaultview

下面的代码可以正常工作并正确过滤行，但是如何将表恢复到原始状态？

```
DataTable table = this.dataGridView1.DataSource as DataTable;
table.DefaultView.RowFilter = comboBox.Text + " LIKE '%" + strName + "%'"; 
```

谢谢

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-06-17T23:02:25.117

试试这个：

```
table.DefaultView.RowFilter = string.Empty 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-14T07:04:28.183

这也很有效：

```
table.DefaultView.RowFilter = null /Nothing 
```

# jquery - JS 不接受 <> 大于或小于符号

> ID：1009937
> 
> 赞同：1
> 
> 时间：2009-06-17T23:00:29.583
> 
> 标签：jquery, regex, parsing, drupal

在过去的几个小时里，我一直被困在一个有趣的（即：头脑麻木）问题上。

我一直在尝试用正则表达式解析运算符：

```
([<>]=?|[!=]=) 
```

我想要的是：`<= >= < > == !=`

`==`和`!=`比赛很棒。但是所有与我的 Drupal 站点有关`<`或`>`无关的内容，即使理论上它们应该可以工作。

我最终做的是：`.replace(/more than/ig, ">")`

并在文本中写“ `more than`”我会写的地方`>`，它的工作原理！完美匹配，一切都...

这真的很愚蠢，但我想不出这个问题存在的原因。我关闭了 Drupal 中的所有过滤器，而在 Firebug 中只是`>`正常编写看起来像`>`，没有转义或任何东西。

我真的很困惑，希望得到启发。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T23:05:23.100

有什么东西可以将你的源材料变成实体吗？

```
&gt; vs > 

&lt; vs < 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T23:09:02.950

您是否尝试实际匹配转义版本？

Firebug 不会显示转义的内容，即它不会显示`>`为实体 ( `&gt;`)，即使它们是（查看此页面的源代码以检查）。这似乎很可能是问题所在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T14:08:39.863

```
((&lt;|&gt;)=?|[!=]=) 
```

# asp.net-mvc - MVC 更新模型

> ID：1009939
> 
> 赞同：2
> 
> 时间：2009-06-17T23:00:54.277
> 
> 标签：asp.net-mvc, model-view-controller, updatemodel

我不确定以前是否有人问过这个问题，但这里是。

我有一个 HTML 看起来像这样的 MVC 应用程序；

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<EnvironmentalVandals.Controllers.MonthlyItemsFormViewModel>" %> 
```

我在控制器中有以下内容；

```
 [Authorize]
    public ActionResult Edit(int? id)
    { snip } 
```

然后在提交按钮事件上；

```
 [AcceptVerbs(HttpVerbs.Post)]
    [Authorize]
    public ActionResult Edit(FormCollection collection)
    {
        CalendarItem fvm = new CalendarItem();

        UpdateModel(fvm);
    } 
```

如果我正在更新现有事件，我没有问题。如果我要添加新事件，则会收到 UpdateModel 无法更新模型的错误消息。

如果我从第一个 ActionResult 中删除“int?id”参数，则模型会根据新事件和现有事件进行更新。

当我编辑一个事件时，我使用以下 HTML；`<%=Html.ActionLink("Edit", "Edit", new {id=Model.Event.id}) %>`当我创建一个新事件时，我使用`<%=Html.ActionLink("Add event","Edit", "Calendar") %>`.

现在可以承认，我可能不应该对更新和创建使用相同的视图，并且可能应该重构为两个视图和一个 PartialView。

那么，这是解决方案还是我做错了什么？

提前致谢。

`</griegs>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T23:54:04.747

好的，事实证明你真的应该分离关注点。

我创建了添加和编辑操作，将编辑屏幕转换为部分视图并添加了添加视图。

一切都完美无缺。

我想关于 mvc，以下是正确的。“当它变得困难时，你可能做错了”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T23:10:31.403

我看不到您的其余代码，但我假设在编辑时您正在将现有记录传递到视图中。当您尝试发布具有相同 ID 的新记录时，控制器会认为您正在尝试修改现有记录而不是创建新记录。

我认为您可以对编辑和添加使用相同的视图，但是在添加时，您必须将新创建的记录对象传递给您的视图。为了我的钱，发布到两种不同的控制器方法（一种用于添加，一种用于编辑）并在那里进行繁重的工作会更容易。

# iphone - 在另一个类的 UIView 上调用 setNeedsDisplay

> ID：1009940
> 
> 赞同：0
> 
> 时间：2009-06-17T23:00:55.807
> 
> 标签：iphone, uiview, quartz-graphics, drawrect

我有一个 UIView 子类，我根据触摸操作很多图形。所有 [self setNeedsDisplay] 调用似乎都很好。

但是，我使用了一个实例变量指针指向我的同一个 UIView 子类实例，然后尝试对其进行操作，然后从另一个 UIView 类调用 [UIViewSubClass setNeedsDisplay]，而 DrawRect 永远不会被调用。您可以从哪里调用 setNeedsDisplay 是否有限制？

（当在另一个 UIView 子类上单击按钮时调用此方法。正在调用该方法，但不是 DrawRect）

```
-(IBAction)loadGrid2;
{
    tempSoundArray = musicGridView1.soundArray;
    [musicGridView1.soundArray setButtonArrayToNull];
    [musicGridView1 setNeedsDisplay];
    musicGridView1.soundArray = tempSoundArray;
    NSLog(@"loadGrid2 was called");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T23:07:20.833

drawRect: 只有在有意义的时候才会被调用；即，视图必须是可见的、在屏幕上的和脏的。你的 drawRect:*曾经*被调用过吗？当视图第一次出现在屏幕上时也应该调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T06:03:48.083

补充本：这很可能意味着您在其他地方遇到了问题。您的指针可能不是 nil 或其他无效，或者视图可能未正确添加到层次结构中。

您可能需要考虑不在视图中处理这种类型的行为，而是在视图控制器中处理。在视图控制器中控制行为并保存表示状态，不要子类化视图类。它将通过更少的“指针传递”来简化您的代码。这也将使调试此类问题变得更加容易。

如果您觉得您的视图控制器变得臃肿，请考虑在多个视图控制器之间拆分职责。

# java - JSF 1.2 + 弹簧 2.5。如何？

> ID：1009941
> 
> 赞同：1
> 
> 时间：2009-06-17T23:01:06.477
> 
> 标签：java, spring, jsf

我正在使用 Spring 来管理我的 DAO 和服务。和用于 UI 的 JSF。我想在我的 JSF backing-bean 中使用依赖注入。有一篇文章解释了我如何做到这一点。

但我有两个独立的项目：一个用于服务，一个用于 UI。Spring 配置文件位于 Service 项目中。

如何将两个项目与 Spring 连接起来？我想为 DI 注释我的 JSF 页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T12:37:44.970

您可以通过使用 Spring Web Flow 来实现这一点。

Spring有一些例子显示：

1.  一种以 JSF 为中心的方法，其中您的 Spring 和 JSF bean 以 JSF 方式（faces-config）和
2.  以 Spring 为中心的方法，您的 bean（包括 ManagedBeans）在 Spring 上下文中进行管理。

请参阅[Spring Flow Web 主页](http://www.springsource.org/webflow)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T23:18:55.707

如果您的意思是您有一个定义了 Web 服务的 WAR，而另一个带有 JSF 内容的单独 WAR，我认为这实际上是两个独立的项目，每个项目都有自己的 Spring 配置。

Web 服务 WAR 将使用 Spring Web 服务或 HTTP 远程处理通过 HTTP 向客户端公开您的服务接口。这将具有一组应用程序上下文配置，XML 或注释。

JSF WAR 将具有 JSP 和控制器。控制器将被注入客户端，这些客户端将与远程服务交互以完成您想要的。这就是他们需要了解的有关服务 WAR 的全部信息。根本不需要任何重复的配置。

这实际上是一个不错的设计，因为它将视图与问题的其余部分完全分离。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-18T22:15:04.697

我找到了一些解决方案： [使用 JSF、Spring 2.5 和 Java Persistence API 和 Glassfish v2 的示例应用程序](http://blogs.oracle.com/carolmcdonald/entry/sample_application_using_jsf_spring) 。但我有问题。

我可以发布这个问题听到还是必须创建新主题？对不起，愚蠢的问题，我是她的新手。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T15:59:13.460

感谢我所做的每一个人。我的错误是 bean 初始化。我试图在构造函数中访问我注入的 bean，但必须在 @PostConstruct 方法中进行。一直以来，我都试图在我的配置文件中找到错误。但它就在这么简单的地方:)

# xml - 如何让通配符在 XPath 属性值匹配中起作用？

> ID：1009943
> 
> 赞同：5
> 
> 时间：2009-06-17T23:01:35.947
> 
> 标签：xml, xpath

我有以下 XML：

```
<root>
  <foo>
    <bar type="a whole bunch of stuff, then a magic string: MUPPET" />
    <value>my Muppet value</value>
  </foo>
  <foo>
    <bar type="some other stuff, then a different magic string: GREMLIN" />
    <value>my Gremlin value</value>
  </foo>
</root> 
```

我想构建一个 XPath 查询，在给定魔术字符串“MUPPET”的情况下返回“我的 Muppet 值”（字符串）。我的猜测是：

```
/root/foo[contains(bar/@type,'MUPPET')]/value/text() 
```

但这似乎不起作用。我真的不确定该`contains(x,y)`运算符是否允许将查询作为第一个参数。作为一个附带问题，我不确定我是否需要`text()`最后。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-17T23:10:34.727

我刚刚检查了这个 Online XPATH Evaluators，它工作正常：

[http://www.mizar.dk/XPath/Default.aspx](http://www.mizar.dk/XPath/Default.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T23:16:33.060

您确定您的 XPath 没有命名空间问题吗？

# vb.net - 转换为双精度（错误）

> ID：1009953
> 
> 赞同：1
> 
> 时间：2009-06-17T23:03:25.770
> 
> 标签：vb.net

我正在将字符串转换为双精度

我想提前知道将字符串转换为双精度是否会出错。例如，如果我尝试将“hello”转换为双精度，它会给我一个错误。

有没有办法让我提前知道转换某些东西是否会导致错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-17T23:05:36.297

你想要[Double.TryParse](http://msdn.microsoft.com/en-us/library/994c0zb1.aspx)：

```
Dim PossibleDouble as Double
If Double.TryParse("hello", PossibleDouble) Then
  ''//Success!
Else
  ''//Not a double
End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-17T23:06:59.710

啊，我明白你的意思了。正确答案是 Michael 指出的 TryParse。

```
String string_val = 1.0;
double val;

val = System.Convert.ToDouble(string_val); 
```

# mysql - MySQL：@variable 与变量。有什么不同？

> ID：1009954
> 
> 赞同：531
> 
> 时间：2009-06-17T23:04:00.137
> 
> 标签：mysql, sql, variables

在我发布的另一个问题中，有人告诉我，两者之间存在差异：

```
@variable 
```

和：

```
variable 
```

在 MySQL 中。他还提到了 MSSQL 如何具有批处理范围而 MySQL 具有会话范围。有人可以为我详细说明一下吗？

* * *

## 回答 #1

> 赞同：650
> 
> 时间：2009-06-17T23:39:15.573

MySQL 有一个*[用户定义变量](http://dev.mysql.com/doc/refman/5.0/en/user-variables.html)*的概念。

它们是松散类型的变量，可以在会话中的某处初始化并保持其值直到会话结束。

它们前面带有一个`@`标志，如下所示：`@var`

`SET`您可以使用语句或在查询中初始化此变量：

```
SET @var = 1

SELECT @var2 := 2 
```

在 MySQL 中开发存储过程时，可以传递输入参数并声明局部变量：

```
DELIMITER //

CREATE PROCEDURE prc_test (var INT)
BEGIN
    DECLARE  var2 INT;
    SET var2 = 1;
    SELECT  var2;
END;
//

DELIMITER ; 
```

这些变量前面没有任何前缀。

The difference between a procedure variable and a session-specific user-defined variable is that a procedure variable is reinitialized to `NULL` each time the procedure is called, while the session-specific variable is not:

```
CREATE PROCEDURE prc_test ()
BEGIN
    DECLARE var2 INT DEFAULT 1;
    SET var2 = var2 + 1;
    SET @var2 = @var2 + 1;
    SELECT  var2, @var2;
END;

SET @var2 = 1;

CALL prc_test();

var2  @var2
---   ---
2     2

CALL prc_test();

var2  @var2
---   ---
2     3

CALL prc_test();

var2  @var2
---   ---
2     4 
```

As you can see, `var2` (procedure variable) is reinitialized each time the procedure is called, while `@var2` (session-specific variable) is not.

(In addition to user-defined variables, MySQL *also* has some predefined "system variables", which may be "global variables" such as `@@global.port` or "session variables" such as `@@session.sql_mode`; these "session variables" are unrelated to session-specific user-defined variables.)

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2009-06-17T23:18:37.597

在 MySQL 中，`@variable`表示[用户定义的变量](http://dev.mysql.com/doc/refman/5.0/en/user-variables.html)。你可以定义你自己的。

```
SET @a = 'test';
SELECT @a; 
```

在存储程序之外`variable`，没有`@`的 a 是[系统变量](http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html)，您无法自行定义。

此变量的范围是整个会话。这意味着当您与数据库的连接存在时，仍然可以使用该变量。

这与 MSSQL 形成对比，其中变量仅在当前批次的查询（存储过程、脚本或其他）中可用。它不会在同一会话中的不同批次中提供。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-03-24T03:38:51.497

MSSQL requires that variables within procedures be DECLAREd and folks use the `@Variable` syntax (`DECLARE @TEXT VARCHAR(25) = 'text'`). Also, MS allows for declares within any block in the procedure, unlike MySQL which requires all the DECLAREs at the top.

While good on the command line, I feel using the `set = @variable` within stored procedures in MySQL is risky. There is no scope and variables live across scope boundaries. This is similar to variables in JavaScript being declared without the `var` prefix, which are then the global namespace and create unexpected collisions and overwrites.

I am hoping that the good folks at MySQL will allow `DECLARE @Variable` at various block levels within a stored procedure. Notice the `@` (at sign). The `@` sign prefix helps to separate variable names from table column names - as they are often the same. Of course, one can always add an "v" or "l_" prefix, but the `@` sign is a handy and succinct way to have the variable name match the column you might be extracting the data from without clobbering it.

MySQL is new to stored procedures and they have done a good job for their first version. It will be a pleasure to see where they take it form here and to watch the server side aspects of the language mature.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-04-27T21:52:59.037

In principle, I use UserDefinedVariables (prepended with @) within Stored Procedures. This makes life easier, especially when I need these variables in two or more Stored Procedures. Just when I need a variable only within ONE Stored Procedure, than I use a System Variable (without prepended @).

@Xybo: I don't understand why using @variables in StoredProcedures should be risky. Could you please explain "scope" and "boundaries" a little bit easier (for me as a newbe)?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-26T17:11:23.800

`@variable` is very useful if calling *stored procedures* from an application written in Java , Python etc. There are ocassions where variable values are created in the first call and needed in functions of subsequent calls.

### Side-note on PL/SQL (Oracle)

The advantage can be seen in *Oracle PL/SQL* where these variables have 3 different scopes:

*   **Function variable** for which the scope ends when function exits.
*   **Package body variables** defined at the top of package and outside all functions whose scope is the session and visibility is package.
*   **Package variable** whose variable is session and visibility is global.

### My Experience in PL/SQL

I have developed an architecture in which the complete code is written in PL/SQL. These are called from a middle-ware written in Java. There are two types of middle-ware. One to cater calls from a client which is also written in Java. The other other one to cater for calls from a browser. The client facility is implemented 100 percent in JavaScript. A command set is used instead of HTML and JavaScript for writing application in PL/SQL.

I have been looking for the same facility to port the codes written in PL/SQL to another database. The nearest one I have found is **Postgres**. But all the variables have function scope.

### Opinion towards `@` in MySQL

I am happy to see that at least this `@` facility is there in MySQL. I don't think Oracle will build same facility available in PL/SQL to MySQL stored procedures since it may affect the sales of Oracle database.

# c# - 嵌套分组策略/算法c#

> ID：1009963
> 
> 赞同：2
> 
> 时间：2009-06-17T23:06:56.107
> 
> 标签：c#, algorithm, data-structures, hierarchical-grouping

不确定我是否必须针对此类问题更正标签，但是您对以下通用解决方案有什么想法吗？

给定一组发票：

```
var invoices = new List<Invoice>()
{
new Invoice() { Id = 1, Customer = "a", Date = DateTime.Parse("1/1/2009") },
new Invoice() { Id = 2, Customer = "a", Date = DateTime.Parse("1/2/2009") },
new Invoice() { Id = 3, Customer = "a", Date = DateTime.Parse("1/2/2009") },
new Invoice() { Id = 4, Customer = "b", Date = DateTime.Parse("1/1/2009") },
new Invoice() { Id = 5, Customer = "b", Date = DateTime.Parse("1/1/2009") },
new Invoice() { Id = 6, Customer = "b", Date = DateTime.Parse("1/2/2009") }
} 
```

在指定以下内容时我可以使用什么技术：

```
var tree = invoices.ToHeirarchy(t => {
    t.GroupBy(x => x.Date);
    t.GroupBy(x => x.Customer);
}) 
```

结果如下图：

```
Date "1/1/2009"
  Customer a
    Invoice 1
  Customer b
    Invoice 4
    Invoice 5
Date "1/2/2009"
  Customer a
    Invoice 2
    Invoice 3
  Customer b
    Invoice 6 
```

并且还允许以下内容通过（允许对任何级别的发票进行计算）？

```
Assert.AreEqual(3, tree.Node[0].Items.Count)
Assert.AreEqual(DateTime.Parse("1/1/2009"), tree.Node[0].Key)

Assert.AreEqual(3, tree.Node[1].Items.Count)
Assert.AreEqual(DateTime.Parse("1/2/2009"), tree.Node[1].Key)

Assert.AreEqual("a", tree.Node[0].Node[0].Key)
Assert.AreEqual(1, tree.Node[0].Node[0].Items.Count)

Assert.AreEqual("b", tree.Node[0].Node[1].Key)
Assert.AreEqual(2, tree.Node[0].Node[1].Items.Count) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T23:30:17.777

您正在寻找的术语是“嵌套 groupby”。

[http://msdn.microsoft.com/en-us/vcsharp/aa336754.aspx#nested](http://msdn.microsoft.com/en-us/vcsharp/aa336754.aspx#nested)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T23:29:53.330

远非可重用，但应该这样做：

```
 var tree = invoices.GroupBy(x => x.Date).Select(x => new
            {
                Key = x.Key,
                Items = x.GroupBy(y => y.Customer).Select(y => new
                    {
                        Key = y.Key,
                        Items = y.Select(z => z.Id).ToList()
                    })
            }).ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T01:02:20.850

您需要一种能够表示树结构的类型。框架中有一些类型可以使用——例如`KeyValuePair<TKey, TValue>`，树视图节点`TreeNode`、XML 元素`XmlElement`和`XElement`，可能还有更多。以下示例包含两个`XElement`用于表示树的解决方案。一种使用 lambdas 访问成员，另一种使用字符串，两者各有利弊。我认为可以从具有更复杂代码的解决方案中获得最佳效果。

```
static void Main()
{
    IEnumerable<Invoice> invoices = new List<Invoice>()
    { 
        new Invoice() { Id = 1, Customer = "a", Date = DateTime.Parse("1/1/2009") },
        new Invoice() { Id = 2, Customer = "a", Date = DateTime.Parse("1/2/2009") }, 
        new Invoice() { Id = 3, Customer = "a", Date = DateTime.Parse("1/2/2009") }, 
        new Invoice() { Id = 4, Customer = "b", Date = DateTime.Parse("1/1/2009") }, 
        new Invoice() { Id = 5, Customer = "b", Date = DateTime.Parse("1/1/2009") }, 
        new Invoice() { Id = 6, Customer = "b", Date = DateTime.Parse("1/2/2009") } 
    };

    StringBuilder sb = new StringBuilder();
    TextWriter tw = new StringWriter(sb);

    using (XmlWriter xmlWriter = new XmlTextWriter(tw) { Formatting = Formatting.Indented })
    {

        XElement t1 = new XElement("Root", BuildTree(invoices, i => i.Customer, i => i.Date, i => i.Id));
        XElement t2 = new XElement("Root", BuildTree(invoices, "Customer", "Date", "Id"));

        var xyz = t2.Elements("Customer").ElementAt(1).Descendants("Item").Count();

        t1.WriteTo(xmlWriter);
        t2.WriteTo(xmlWriter);
    }

    Console.WriteLine(sb.ToString());

    Console.ReadLine();
}

public static IEnumerable<XElement> BuildTree<T>(IEnumerable<T> collection, params Func<T, Object>[] groups)
{
    if ((groups != null) && (groups.Length > 0))
    {
        return collection
            .GroupBy(groups[0])
            .Select(grp => new XElement(
                "Group",
                new XAttribute("Value", grp.Key),
                BuildTree(grp, groups.Skip(1).ToArray())));
    }
    else
    {
        return collection.Select(i => new XElement("Item"));
    }
}

public static IEnumerable<XElement> BuildTree<T>(IEnumerable<T> collection, params String[] groups)
{
    if ((groups != null) && (groups.Length > 0))
    {
        return collection
            .GroupBy(i => typeof(T).GetProperty(groups[0]).GetValue(i, null))
            .Select(grp => new XElement(
                groups[0],
                new XAttribute("Value", grp.Key),
                BuildTree(grp, groups.Skip(1).ToArray())));
    }
    else
    {
        return collection.Select(i => new XElement("Item"));
    }
} 
```

第一个解决方案的输出如下。

```
<Root>
  <Group Value="a">
    <Group Value="2009-01-01T00:00:00">
      <Group Value="1">
        <Item />
      </Group>
    </Group>
    <Group Value="2009-02-01T00:00:00">
      <Group Value="2">
        <Item />
      </Group>
      <Group Value="3">
        <Item />
      </Group>
    </Group>
  </Group>
  <Group Value="b">
    <Group Value="2009-01-01T00:00:00">
      <Group Value="4">
        <Item />
      </Group>
      <Group Value="5">
        <Item />
      </Group>
    </Group>
    <Group Value="2009-02-01T00:00:00">
      <Group Value="6">
        <Item />
      </Group>
    </Group>
  </Group>
</Root> 
```

第二种解决方案产生以下结果。

```
<Root>
  <Customer Value="a">
    <Date Value="2009-01-01T00:00:00">
      <Id Value="1">
        <Item />
      </Id>
    </Date>
    <Date Value="2009-02-01T00:00:00">
      <Id Value="2">
        <Item />
      </Id>
      <Id Value="3">
        <Item />
      </Id>
    </Date>
  </Customer>
  <Customer Value="b">
    <Date Value="2009-01-01T00:00:00">
      <Id Value="4">
        <Item />
      </Id>
      <Id Value="5">
        <Item />
      </Id>
    </Date>
    <Date Value="2009-02-01T00:00:00">
      <Id Value="6">
        <Item />
      </Id>
    </Date>
  </Customer>
</Root> 
```

这种解决方案远非完美，但可能会提供一些开始，它们提供了 LINQ to XML 的全部功能来查询树。如果您打算大量使用这种树，我建议为树构建一个更适合需求的自定义节点类型。但是设计它可能会非常困难 - 特别是如果你想要强类型。

最后我想提一下，我并不能真正看到这种结构的使用——使用 LINQ 对象直接从列表中获取结果不是更容易吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-17T12:27:31.587

我还没有测试过，但我认为 eulerfx 提出的答案是正确的方向。下面我用 LINQ 理解语法为这类事情编写了自己的解决方案。

```
var tree =
    (from i in invoices
    group i by i.Date into g1
    select new
    {
        Key = g1.Key,
        Items =
            (from d in g1
            group d by d.Customer into g2
            select new
            {
                Key = g2.Key,
                Items =
                    from d in g2
                    select new
                    {
                        Key = d.Id,
                    }
            }).ToList()
    }).ToList(); 
```

ToList() 调用实际上是可选的，具体取决于您在投影中尝试实现的目标。

最近我问了一个[类似的问题](https://stackoverflow.com/questions/1744837/how-do-i-write-a-linq-query-that-inverts-the-grouping-of-a-hierarchical-data-sour)，看来我可能会自己回答。如果您认为它可能有助于理解与 linq 分组以创建层次结构有关的其他选项，请看一下。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T23:12:02.087

您可以按日期和客户对结果进行排序，而不是树。

# android - Android Eclipse 插件：未指定 Instrumentation Test Runner

> ID：1009970
> 
> 赞同：65
> 
> 时间：2009-06-17T23:09:04.387
> 
> 标签：android, eclipse, unit-testing, junit

尝试使用 Android 项目从 Eclipse 运行单元测试时出现此错误。Android 首选项中的 Instrumentation Test Runners 列表为空。

> [2009-06-17 23:57:51 - MyApp] 错误：应用程序未指定 android.test.InstrumentationTestRunner 工具或未声明使用库 android.test.runner

这也是令人讨厌的决定，因为我试图运行一次单元测试，这就是我一直想做的事情。

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-06-18T12:39:14.083

您可能缺少`uses-library`和`instrumentation`中的节点`AndroidManifest.xml`：

```
<manifest ...>
    <application ...>
        <!-- ... -->
        <uses-library android:name="android.test.runner" />
    </application>
    <instrumentation android:name="android.test.InstrumentationTestRunner"
        android:targetPackage="your.package"
        android:label="your tests label" />
</manifest> 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-11-09T07:09:16.210

在`Run Configuration`您可能拥有的文件中`Android JUnit Test`，如果其中有任何新的启动配置条目，请将其删除，然后运行您将运行的应用程序。

注意 - 如果您在向清单添加正确的行之前尝试运行测试用例，这可能是解决方案，如 Josef 的回答中所述。如果您已经这样做了，请删除配置（这将抱怨在其标头中未指定任何仪器测试运行程序），然后再次将其作为 Android Junit 测试运行，它将创建一个有效的配置来获取您正确的东西已添加到清单中（请参阅约瑟夫的答案）。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2010-01-17T16:18:25.023

我在这个讨论中注意到的一件事可能会让一些人感到困惑，那就是你需要确保清单中的“instrumentation”元素是“manifest”而不是“application”的子元素。（这里的例子是正确的，但这很容易混淆。）

[http://developer.android.com/guide/topics/manifest/instrumentation-element.html](http://developer.android.com/guide/topics/manifest/instrumentation-element.html)

如果你把你的仪器东西放在应用程序中，它不会被拾取，你在仪器运行器的 Eclipse ADT 插件中的选择可能是空白的。（但没有抛出或显示错误等）

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-10-15T06:50:33.297

只需从 Eclipse IDE 中右键单击您的测试类，然后单击“运行方式”。在此之后选择“运行配置”，它将在 Eclipse 中启动一个配置窗口，您需要单击“Instrumentation Runner”旁边的单选按钮，然后从下拉列表中选择配置的 Instrumentation Runner。现在单击应用，然后单击运行。我认为这将解决您的问题。

谢谢，斯姆鲁蒂

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-12-14T05:19:27.340

它不在你的代码中，它只是 eclipse 有点错误。在您的运行配置中，它可能会尝试运行 jUnit 测试，但选择运行应用程序，该错误将消失。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-03-28T22:08:30.837

除了确保在测试应用程序的清单中声明以下项目外，请检查运行配置中的“仪器运行器”字段是否设置为

```
"com.google.android.apps.common.testing.testrunner.GoogleInstrumentationTestRunner". 
```

这是我在弄清楚为什么我的测试无法运行时遇到的。

显现：

```
<instrumentation android:name="android.test.InstrumentationTestRunner"
 android:targetPackage="your.package"
 android:label="your tests label" />

 and...

<uses-library android:name="android.test.runner" /> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-14T03:40:36.713

问题是当你创建项目时，你会有一个 AVD，所以这些配置会丢失。我建议的方法是首先创建 AVD，然后创建 android 项目:)。

如果您已经创建了该项目，并且您编写的代码不多，我建议您删除它并创建一个新的。

# wpf - 帮助 ”？” 按钮

> ID：1009983
> 
> 赞同：19
> 
> 时间：2009-06-17T23:12:35.643
> 
> 标签：wpf

如何将此按钮添加到 WPF 中的标题栏，因为它在很多应用程序中如此使用，我认为它会被内置或其他东西，但看起来它不是。无论如何，如果您对此有所了解，请告诉我。

谢谢。

编辑：

没有什么与[此](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.helpbutton.aspx)等价的吗？

基本上，拥有 ? win表格中的图标，您需要做的就是：

```
public Form1()
{
    InitializeComponent();

    this.HelpButton = true;
    this.MaximizeBox = false;
    this.MinimizeBox = false;
} 
```

WPF没有类似的东西吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-06-18T21:16:17.450

很简单，只需将此代码插入到您的 Window 类中。

此代码使用 interop 删除 WS_MINIMIZEBOX 和 WS_MAXIMIZEBOX 样式并添加 WS_EX_CONTEXTHELP 扩展样式（只有在删除最小化和最大化按钮时才会显示问号）。

编辑：在帮助按钮上添加了点击检测，这是通过使用 HwndSource.AddHook 连接到 WndProc 并使用 SC_CONTEXTHELP 的 wParam 侦听 WM_SYSCOMMAND 消息来完成的。

当检测到点击时，此代码将显示一个消息框，将其更改为事件、路由事件甚至命令（对于 MVVM 应用程序）留给读者作为练习。

```
private const uint WS_EX_CONTEXTHELP = 0x00000400;
private const uint WS_MINIMIZEBOX = 0x00020000;
private const uint WS_MAXIMIZEBOX = 0x00010000;
private const int GWL_STYLE = -16;
private const int GWL_EXSTYLE = -20;
private const int SWP_NOSIZE = 0x0001;
private const int SWP_NOMOVE = 0x0002;
private const int SWP_NOZORDER = 0x0004;
private const int SWP_FRAMECHANGED = 0x0020;
private const int WM_SYSCOMMAND = 0x0112;
private const int SC_CONTEXTHELP  = 0xF180;

[DllImport("user32.dll")]
private static extern uint GetWindowLong(IntPtr hwnd, int index);

[DllImport("user32.dll")]
private static extern int SetWindowLong(IntPtr hwnd, int index, uint newStyle);

[DllImport("user32.dll")]
private static extern bool SetWindowPos(IntPtr hwnd, IntPtr hwndInsertAfter, int x, int y, int width, int height, uint flags);

protected override void OnSourceInitialized(EventArgs e)
{
    base.OnSourceInitialized(e);
    IntPtr hwnd = new System.Windows.Interop.WindowInteropHelper(this).Handle;
    uint styles = GetWindowLong(hwnd, GWL_STYLE);
    styles &= 0xFFFFFFFF ^ (WS_MINIMIZEBOX | WS_MAXIMIZEBOX);
    SetWindowLong(hwnd, GWL_STYLE, styles);
    styles = GetWindowLong(hwnd, GWL_EXSTYLE);
    styles |= WS_EX_CONTEXTHELP;
    SetWindowLong(hwnd, GWL_EXSTYLE, styles);
    SetWindowPos(hwnd, IntPtr.Zero, 0, 0, 0, 0, SWP_NOMOVE | SWP_NOSIZE | SWP_NOZORDER | SWP_FRAMECHANGED);   
    ((HwndSource)PresentationSource.FromVisual(this)).AddHook(HelpHook);
}

private IntPtr HelpHook(IntPtr hwnd,
        int msg,
        IntPtr wParam,
        IntPtr lParam,
        ref bool handled)
{
    if (msg == WM_SYSCOMMAND &&
            ((int)wParam & 0xFFF0) == SC_CONTEXTHELP)
    {
        MessageBox.Show("help");
        handled = true;
    }
    return IntPtr.Zero;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T23:14:27.107

WPF 没有开箱即用的帮助按钮。但是，不应该推动自己推出自己的产品。

# xcode - 在 xcode 3.1.2 中使用 GDB - “运行 hook_stop 时出错：”是什么意思？

> ID：1009984
> 
> 赞同：1
> 
> 时间：2009-06-17T23:13:44.937
> 
> 标签：xcode, macos, opengl, gdb

这里几乎是一个新手，使用 xcode 编写 c++ 程序。我还不知道如何使用 gdb，我不确定如何将其关闭..（如果可以的话？）刚刚添加了一些 openGL 纹理加载代码，当我调用它时，我在控制台中收到此错误消息程序冻结了……发生了什么？

这是引发错误的代码：

```
tex_2d = LoadTextureRAW("texture.raw", 0 );

GLuint LoadTextureRAW( const char * filename, int wrap )
{
GLuint texture;
int width, height;

FILE * file;

// open texture data
file = fopen( filename, "rb" );
if ( file == NULL ) return 0;

// allocate buffer
width = 256;
height = 256;
unsigned char *data = new unsigned char[256*256*3];

// read texture data
fread( data, width * height * 3, 1, file );
fclose( file );

// allocate a texture name
glGenTextures( 1, &texture );

// select our current texture
glBindTexture( GL_TEXTURE_2D, texture );

// select modulate to mix texture with color for shading
glTexEnvf( GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_MODULATE );

// when texture area is small, bilinear filter the closest mipmap
glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER,
                GL_LINEAR_MIPMAP_NEAREST );
// when texture area is large, bilinear filter the first mipmap
glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );

// if wrap is true, the texture wraps over at the edges (repeat)
//       ... false, the texture ends at the edges (clamp)
glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S,
                wrap ? GL_REPEAT : GL_CLAMP );
glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T,
                wrap ? GL_REPEAT : GL_CLAMP );

// build our texture mipmaps
gluBuild2DMipmaps( GL_TEXTURE_2D, 3, width, height,
                  GL_RGB, GL_UNSIGNED_BYTE, data );

// free buffer
free( data );

return texture; 
```

}

这是控制台输出：

```
Loading program into debugger…
GNU gdb 6.3.50-20050815 (Apple version gdb-962) (Sat Jul 26 08:14:40 UTC 2008)
Copyright 2004 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i386-apple-darwin".Program loaded.
sharedlibrary apply-load-rules all
Attaching to program: `/Users/development/Desktop/devshit/smallermarkers/build/Debug copy/SimpleAR.app/Contents/MacOS/SimpleAR', process 1674.
Error while running hook_stop:
Error while running hook_stop:

Unable to disassemble glgConvertTo_32<GLGConverter_BGR8_ARGB8, (GLGMemory)2>.
(gdb) 
```

我在使用预编译库加载纹理之前遇到了这个错误，所以现在我正在尝试最简单的路线。任何人都可以告诉我这个吗？谷歌搜索 hook_stop 似乎没有提供很多信息:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-02T00:31:50.983

查看您的 .gdbinit 文件，如果您有一个名为 hook_stop 的定义，它将在任何名为 stop 的定义之前被调用。我也遇到过这个问题，gdb 手册中有详细说明：

20.2 用户自定义命令钩子 你可以定义钩子，这是一种特殊的用户自定义命令。每当您运行命令 'foo' 时，如果用户定义的命令 'hook-foo' 存在，它会在该命令之前执行（不带参数）。

# java - 有没有办法重新排列java源文件中的导入

> ID：1009994
> 
> 赞同：6
> 
> 时间：2009-06-17T23:17:37.537
> 
> 标签：java

是否有一种简单的方法可以重新排列项目中所有 *.java 文件中的导入？

例如：

```
import java.util.Calendar;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat; 
```

会成为

```
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar; 
```

我们有大约 200 个源文件，它们需要按顺序导入。

解决这个问题的最佳方法是什么？我对可以执行此操作的 perl/python/groovy 脚本持开放态度...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-17T23:39:46.837

在 Eclipse 的 Package Explorer 中，右键单击项目的顶级包。为项目中的所有文件选择 Source > Organize Imports，就完成了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T23:26:48.280

eclipse 可以帮助您组织项目的导入。

去源/清理..然后使用配置按钮。这将打开一个过滤的首选项对话框。单击`enable project specific settings`，然后单击`edit`按钮。将顶部的配置文件名称更改为“组织导入”之类的描述性名称，然后转到`code organizing`选项卡。选择`organize imports`复选框。您可以浏览其余选项卡并取消选择其他选项。保存所有内容后，返回`clean up...`对话框并单击`finish`。

* * *

**编辑：**

如果您使用的是 eclipse 路线，请不要忘记您可以根据需要订购导入（com before org 等），以及设置“需要 .* 之前的导入数量”属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T00:42:48.237

Netbeans 6.5.1：Crtl+Shift+I

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T23:22:21.583

Eclipse 有这样一个开箱即用的选项（Ctrl+Shift+O）。但它可能不容易在大量文件上实现自动化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-17T23:25:44.557

*   [清洁进口](http://cleanimports.tombrus.nl/)
*   [进口洗涤器](http://importscrubber.sourceforge.net/)
*   [进口商](http://javadude.com/tools/importifier/)
*   [进口清洁工](http://horstmann.com/articles/BetterCleaner.html)

我认为它们中的任何一个都不能完美地工作，因此请务必查看限制。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-17T23:51:38.683

在 Intellij IDEA 中，您可以在 Settings->Code Style->Imports 上设置首选项，然后通过指向项目视图中的目录并选择 Code->Optimize Imports 来优化项目的导入。

对于询问您为什么要这样做的 cletus，查看导入可以为您提供给定类的依赖项的初步近似值，尤其是关于第三方 jars（您可以了解它们已被使用，然后遵循他们记录的依赖项）。有时这很有用，因此您可能希望使它们井井有条。但总的来说，我同意，通常不需要关心。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-18T02:17:38.390

鉴于您实际上提出了这个问题，我假设您没有使用 IDE 进行编码。如果您使用 vi，您还可以使用内置的行排序功能按字母顺序对导入进行排序。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-03-05T11:16:27.830

遇到问题时，我使用了 gawk 脚本：

```
#!/usr/bin/gawk -f
BEGIN {
    importing=0;
}
/^import/ {
    importing=1;
    switch ($2) {
    case /^static/:
        static_imports[++static_lines]=$0;
        break;
    case /^java[.].*/:
        java_imports[++java_lines]=$0;
        break;
    case /^javax[.].*/:
        javax_imports[++javax_lines]=$0;
        break;
    case /^org[.].*/:
        org_imports[++org_lines]=$0;
        break;
    case /^com[.].*/:
        com_imports[++com_lines]=$0;
        break;
    case /^partner[.]company[.].*/:
        partner_imports[++partner_lines]=$0;
        break;
    case /^my[.]company[.].*/:
        my_imports[++my_lines]=$0;
        break;
    default:
        other_imports[++lines]=$0;
    }
    next;
}
/^[[:space:]]*$/ {
    if (importing) {
    next;
    }
}
function printArray(array) {
    asort(array);
    i=0;
    for (i in array) {
    print array[i];
    }
    if (i > 0) {
    print "";
    }
}
    {
        if (importing) {
            importing=0;
            printArray(java_imports);
            printArray(javax_imports);
            printArray(org_imports);
            printArray(com_imports);
            printArray(other_imports);
            printArray(partner_imports);
            printArray(my_imports);
            printArray(static_imports);
        }
        print
    } 
```

我们希望从 partner.company.* 和 my.company.* 的进口与其他进口分开，因此需要额外的类别。

将它与一个小 shell 脚本结合起来在多个文件上运行：

```
#!/bin/sh
for file in "$@" ; do
    `dirname $0`/organize-imports.awk $file > $file.ordered
    mv $file.ordered $file
done 
```

这为我完成了大部分工作，我不得不手动处理一些特殊情况。

然后我们使用 checkstyle 来确保没有人再次使用无序导入提交任何内容：

```
[...]
<module name="ImportOrder">
  <property name="groups" value="/^java\./,javax,org,com,*,partner.company,my.company"/>
  <property name="ordered" value="true"/>
  <property name="separated" value="true"/>
  <property name="option" value="bottom"/>
  <property name="sortStaticImportsAlphabetically" value="true"/>
  <property name="separatedStaticGroups" value="true"/>
</module>
[...] 
```

# java - 使用 Java 加密会导致 NoSuchAlgorithmException

> ID：1009996
> 
> 赞同：2
> 
> 时间：2009-06-17T23:18:23.040
> 
> 标签：java, cryptography

这是我的代码的加密部分。它编译得很好，但在运行时因该异常而失败：

```
import java.util.Random;
import javax.crypto.Cipher;
import javax.crypto.SecretKey;
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.PBEKeySpec;
import javax.crypto.spec.PBEParameterSpec;

...

byte[] salt = new byte[8];
Random rand = new Random();
rand.nextBytes(salt);

PBEKeySpec keySpec = new PBEKeySpec(password.toCharArray());
SecretKeyFactory keyFactory = SecretKeyFactory.getInstance("PBEWithSHAAndTwofish-CBC");
SecretKey key = keyFactory.generateSecret(keySpec);
PBEParameterSpec paramSpec = new PBEParameterSpec(salt, 1000);

Cipher cipher = Cipher.getInstance("PBEWithSHAAndTwofish-CBC");
cipher.init(Cipher.ENCRYPT_MODE, key, paramSpec);
byte[] ciphertext = cipher.doFinal(plaintext); 
```

这个算法不是 Java 1.5 自带的吗？我不介意使用另一种算法，我只是不知道有什么可用的。我希望我不必使用像 bouncycastle 这样的外部库，因为我已经努力了好几天试图让它工作无济于事（通过将它包含在我的 .jar 应用程序中，它会触发“无效的签名文件摘要”错误） .

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T23:26:52.197

如果您不想依赖像 BouncyCastle 这样的外部库，看起来您可能不得不使用其他密码。

有关直接开箱即用的支持的更多详细信息，请参阅[有关 Sun 加密提供程序的文档。](http://java.sun.com/javase/6/docs/technotes/guides/security/SunProviders.html)