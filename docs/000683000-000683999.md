# StackOverflow 问答 000683000-000683999

# xml - 将旧的 XML 数据加载到新版本的 InfoPath 表单中

> ID：683000
> 
> 赞同：2
> 
> 时间：2009-03-25T19:04:21.947
> 
> 标签：xml, sql-server-2005, xslt, infopath

我们有一个带有 InfoPath 表单组件的 ASP.NET 应用程序，它使用 InfoPath Forms Server 将 InfoPath 表单传送到浏览器。我们没有将表单保存在 SharePoint 中，而是将 XML 表单数据提交到 ASP.NET Web 服务，该服务将数据保存为 SQL Server 2005 中的 XML 数据类型。这工作正常，加载 XML 数据没有问题返回 InfoPath 表单。

当我们尝试将旧数据（来自表单的版本 1）加载到新版本的表单（版本 2）中时，我们的问题就出现了。例如，这个新版本的表单 (V2) 有一个新的文本框字段。因为 V2 字段在 V1 XML 中不存在，所以它们在 V2 表单上可见，但被禁用且无法填写。

我们的问题是我们如何将 V1 XML 数据加载到 V2 表单中，并让用户能够完成现在出现在 V2 表单中的那些字段。

使用 InfoPath Forms Server 和存储在表单库中的表单可以实现此行为。如果更新表单模板，您可以在新模板中打开旧表单，查看新字段，并可以在新字段中保存数据。当表单 XML 数据存储在 SQL Server 中而不是表单库中时，我们需要知道如何以编程方式执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T19:32:05.297

自从我做任何 InfoPath 以来已经有一段时间了，所以对此有点含糊深表歉意：

InfoPath 模板的一部分（几乎只是一个具有不同扩展名的 ZIP 存档）是一个名为“upgrade.xsl”的文件。此文件包含一个或多个 XSL 转换，用于“升级”针对早期模式版本的文档。

问题是：为什么在一个场景（SharePoint/Form Library）而不是在另一个场景（Web 服务）中应用了正确的转换？第二个过程是否可能丢失 InfoPath 用于了解源文档所针对的架构版本的标记？我相信我所指的标签是“？mso-infoPathSolution”标签（“solutionVersion”属性）。

如果确实从文档中删除了这个标签（并且您不能轻易阻止它），您可能需要“手动”应用适当的 XSL 转换。当然，如果您要处理多个版本，则可能很难确定在任何情况下都需要应用什么转换。

# ruby-on-rails - HABTM 2 表 2 种不同的关系

> ID：683009
> 
> 赞同：3
> 
> 时间：2009-03-25T19:08:17.163
> 
> 标签：ruby-on-rails, has-and-belongs-to-many

我有一个服务类型表，其中包含几十个服务的 ID 和名称。

我有一个 Projects 表，其中必须有一个 Proposed Services 列表和一个 Accepted Services 列表。

我知道我会在两边都使用 HABTM，中间有一个 project_service_types 表。

当我在同一张表之间有 2 个不同的关系时，我不知道该怎么做。我怀疑它使用 :join_table 和 :associated_forign_key，但我无法让它在我的应用程序中工作。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T19:38:07.857

我用HABTM解决了它......

```
class ServiceType < ActiveRecord::Base
  has_and_belongs_to_many :accepted_projects, :class_name => "Project", :join_table => :projects_accepted_types
  has_and_belongs_to_many :proposed_projects, :class_name => "Project", :join_table => :projects_proposed_types
end

class Project < ActiveRecord::Base
  has_and_belongs_to_many :accepted_types, :class_name => "ServiceType", :join_table => :projects_accepted_types
  has_and_belongs_to_many :proposed_types, :class_name => "ServiceType", :join_table => :projects_proposed_types
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T19:55:49.780

虽然您可以使用 habtm 解决这个问题，但您所说的是 has_many :through 的用例。您想在关系中附加一些信息。为此，您需要创建一个表示关系的连接模型。

最后，这使您可以将您的服务提案视为您领域中的一流“事物”。接受服务后，您只需更改状态即可。这也节省了一个连接。

**移民**

```
create_table :project_services do |t|
  t.references :project
  t.references :service_type
  t.string :status
end 
```

**楷模**

```
class ProjectService < ActiveRecord::Base
  belongs_to :project
  belongs_to :service
end

class Project < ActiveRecord::Base
  has_many :project_services
  has_many :accepted_services, :through => :project_services,
    :conditions => { :status => 'accepted' }
  has_many :proposed_services, :through => :proposed_services,
    :conditions => { :status => 'proposed' }
end

class Service < ActiveRecord::Base
  has_many :project_services
  has_many :accepted_projects, :through => :project_services,
    :conditions => { :status => 'accepted' }
  has_many :proposed_projects, :through => :proposed_services,
    :conditions => { :status => 'proposed' }
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T19:13:40.990

为此，您可能希望使用 has_many :through 如下：

```
class ProposedService < ActiveRecord::Base
    belongs_to :project
    belongs_to :service_type

class AcceptedService < ActiveRecord::Base
    belongs_to :project
    belongs_to :service_type

class Projects < ActiveRecord::Base
    has_many :proposed_services
    has_many :accepted_services
    has_many :service_types, :through => :proposed_services
    has_many :service_types, :through => :accepted_services

class ServiceTypes < ActiveRecord::Base
    has_many :proposed_services
    has_many :accepted_services
    has_many :projects, :through => :proposed_services
    has_many :projects, :through => :accepted_services 
```

这里的多对多部分：

[http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)

更详细地解释了这一点。希望这可以帮助！

# opengl - 如何在 OpenGL 中可视化深度纹理？

> ID：683011
> 
> 赞同：3
> 
> 时间：2009-03-25T19:09:45.897
> 
> 标签：opengl, textures

我正在研究阴影映射算法，我想调试它在第一次通过时生成的深度图。但是，深度纹理似乎无法正确渲染到视口。是否有任何简单的方法可以将深度纹理显示为灰度图像，最好不使用着色器？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-05-20T17:16:01.627

您可能需要更改深度纹理参数以将其显示为灰度级别：

```
glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_COMPARE_MODE, GL_NONE )
glTexParameteri( GL_TEXTURE_2D, GL_DEPTH_TEXTURE_MODE, GL_LUMINANCE ) 
```

然后，您通常可以通过固定函数或“sampler2d”着色器制服将纹理用作“普通”灰度 2d 纹理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T08:54:51.997

深度纹理 (2D) 可以像任何常规灰度纹理一样使用。唯一的问题可能是它里面的值太高了，你只能看到一个白色的纹理。如果是这种情况，请使用创建深度纹理时使用的 z-near 和 -far 平面（或使用着色器或 glTexEnv 缩放值）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-20T16:43:05.573

当然，只需将您的深度纹理绑定到您最喜欢的纹理单元，启用纹理，然后绘制一个 2D 四边形！您还可以调整四边形的大小以仅填充屏幕的一部分，以便您可以实时查看阴影贴图。

OpenGL 还具有可以为您将纹理复制到数组中的功能。您可以将其保存为图像并使用图像查看器查看它。

# c# - 互操作将字符串从 C# 发送到 C++

> ID：683013
> 
> 赞同：3
> 
> 时间：2009-03-25T19:10:26.380
> 
> 标签：c#, c++, string, interop

我想将 C# 中的字符串发送到本机 C++ DLL 中的函数。

这是我的代码： C# 方面：

```
[DllImport(@"Native3DHandler.dll", EntryPoint = "#22", 
    CharSet = CharSet.Unicode)]
private static extern void func1(byte[] path);

public void func2(string path)
{
   ASCIIEncoding encoding = new ASCIIEncoding();
   byte[] arr = encoding.GetBytes(path);
   func1(this.something, arr);
} 
```

C++ 方面：

```
void func1(char *path)
{
    //...
} 
```

我在 C++ 端得到的是一个空字符串，每次，无论我发送什么。帮助？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-16T09:27:41.673

对我来说很好，在 VS2008 中没有额外的编组指令：

C# 方面：

```
[DllImport("Test.dll")]
public static extern void getString(StringBuilder theString, int bufferSize);

func()
{
  StringBuilder tstStr = new StringBuilder(BufSize);
  getString(tstStr, BufSize);
} 
```

C++ 方面：

```
extern "C" __declspec(dllexport) void getString(char* str, int bufferSize)
{
  strcpy_s(str, bufferSize, "FOOBAR");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T19:19:27.123

看起来你有2个问题。首先是您的本机 C++ 使用 ANSI 字符串，但您指定的是 unicode。其次，将字符串编组为字符串是最简单的。

尝试将 DllImport 更改为以下

```
[DllImport(
  @"Native3DHandler.dll", 
  EntryPoint = "#22",  
  CharSet = CharSet.Ansi)]
private static extern void func1(void* something, [In] string path); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T18:48:46.587

字符串的默认封送处理 [http://msdn.microsoft.com/en-us/library/s9ts558h.aspx](http://msdn.microsoft.com/en-us/library/s9ts558h.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T19:19:47.603

你的声明是错误的。该参数应该是字符串类型，并且您应该将字符集编码设置为 Ansi，如下所示：

```
[DllImport(@"Native3DHandler.dll", EntryPoint = "#22", 
    CharSet = CharSet.Ansi)]
private static extern void func1(string path); 
```

这假设您没有在 C++ 代码中修改路径变量的内容。然后，您直接传递字符串参数（不需要包装器）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T19:20:06.917

如果你只是想发送一个字符串，只需将func1的参数声明为一个字符串。如果要接收字符串，请将其声明为 StringBuilder 并为要接收的内容分配足够的缓冲区空间。

# performance - 对 Web 服务的速度进行故障排除

> ID：683016
> 
> 赞同：2
> 
> 时间：2009-03-25T19:11:40.480
> 
> 标签：performance, web-services

C# .NET 2.0 如果证明适用的话。

我将开始深入了解为什么我们拥有的 Web 服务运行缓慢 - 该 Web 服务跳过代理，进入另一个域，查询存储过程以获取一些数据，然后返回一个 int/string/数据集，取决于我的要求。我刚刚编写了一个控制台应用程序，它以相同的方式重复查询它，以便我可以收集一些统计数据以开始使用。

Keep-alive对每个请求都**关闭了，由于某些遗留原因，没有人记录在案，所以有一种立即的气味。**

当多次循环同一个请求时，我注意到一些奇怪的行为。这是我的输出，它反映了每次迭代进行查询和返回数据所需的时间。

```
Beginning run #1...completed in 4859.3128 ms
Beginning run #2...completed in 3812.4512 ms
Beginning run #3...completed in 3828.076 ms
Beginning run #4...completed in 3828.076 ms
Beginning run #5...completed in 546.868 ms
Beginning run #6...completed in 3828.076 ms
Beginning run #7...completed in 546.868 ms
Beginning run #8...completed in 3828.076 ms
Beginning run #9...completed in 3828.076 ms
Beginning run #10...completed in 578.1176 ms
Beginning run #11...completed in 3796.8264 ms
Beginning run #12...completed in 3828.076 ms
Beginning run #13...completed in 3828.076 ms
Beginning run #14...completed in 3828.076 ms
Beginning run #15...completed in 3828.076 ms
Beginning run #16...completed in 3828.076 ms
Beginning run #17...completed in 546.868 ms
Beginning run #18...completed in 3828.076 ms
Beginning run #19...completed in 3828.076 ms
Beginning run #20...completed in 546.868 ms
Total time: 61165 ms
Average time per request: 3058 ms 
```

我觉得奇怪的是有多个重复值，直到一个非常小的水平。**是否有一些瓶颈会导致它在相同的时间内重复返回？**

...希望我用于计算和显示毫秒持续时间的代码没有关闭，但是跟踪它的 TimeSpan 对象是每个循环的本地对象，所以我不认为是这样。

**编辑：**乔恩要求提供时序代码，所以你去吧（变量名称更改以保护专有，所以可能有一些粗心的东西会使它无法编译）......

```
int totalRunTime = 0;
for (int i = 0; i < numberOfIterations; i++)
{
    Console.Write("Beginning run #" + (i + 1).ToString() + "...");
    DateTime start = DateTime.Now;
    SimpleService ws = new SimpleService();
    DataSet ds = ws.CallSomeMethod();
    DateTime end = DateTime.Now;
    TimeSpan runTime = end - start;
    totalRunTime += (int)runTime.TotalMilliseconds;
    Console.Write("completed in " + runTime.TotalMilliseconds.ToString() + " ms\n");
}
Console.WriteLine("Total time: " + totalRunTime.ToString() + " ms");
Console.WriteLine("Average time per request: " + (totalRunTime / numberOfIterations).ToString() + " ms\n"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T19:17:46.237

最简单的方法是在不运行分析器等的情况下让 Web 应用程序记录开始操作的确切时间（显然，尽可能接近）、调用中的不同时间以及结束的时间。然后你可以看到它在哪里花费时间。（使用 a`Stopwatch`可以提高准确性，但会稍微难一些。）

我同意你有重复的次数很奇怪。你能发布测量它的代码吗？看到某种捕获的变量问题会混淆您的时间安排，我不会感到*非常惊讶。*

编辑：您的计时码看起来不错。这很奇怪。我建议你也记录下网络服务的时间，看看它是否看起来一样。就好像有什么东西在故意限制它。

当你运行它时，它看起来是否像它所说的那样花费时间 - 即当它说它花费了 3 秒时，是在最后一行写完之后大约 3 秒吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T11:16:11.050

SimpleService 的创建（和创建时间）会扭曲您的数字吗？如果你把它拉出循环会发生什么？

```
int totalRunTime = 0;
SimpleService ws = new SimpleService();
for (int i = 0; i < numberOfIterations; i++)
{
    Console.Write("Beginning run #" + (i + 1).ToString() + "...");
    DateTime start = DateTime.Now;
    DataSet ds = ws.CallSomeMethod();
    DateTime end = DateTime.Now;
    TimeSpan runTime = end - start;
    totalRunTime += (int)runTime.TotalMilliseconds;
    Console.Write("completed in " + runTime.TotalMilliseconds.ToString() + " ms\n");
}
Console.WriteLine("Total time: " + totalRunTime.ToString() + " ms");
Console.WriteLine("Average time per request: " + (totalRunTime / numberOfIterations).ToString() + " ms\n"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T19:20:08.243

现在您需要为链中的其他步骤获取一些基准值。查看服务器日志以获取您的请求到达网络服务器的时间，并将一些日志记录添加到网络服务代码中以查看网络服务器何时移交给实际的“工作”代码。

一旦你完成了，你就可以开始缩小最慢部分的性能，尽可能多地重复。

# php - 有谁知道免费工具或如何将 rtf 转换为 jpg

> ID：683021
> 
> 赞同：2
> 
> 时间：2009-03-25T19:12:51.693
> 
> 标签：php, rtf, jpeg

我有一个需要向用户显示的 RTF 文件。我知道如果我想在浏览器中显示它，我需要转换它。我希望能够将其转换为 JPG，以便我可以利用我正在使用的其他代码，这些代码使用 ImageMagick 将 JPG 转换为 PDF。ImageMagick 会将 PDF 转换为 JPG，但不是 RTF :( 我在 windows 框中使用 PHP。

****更新****

我已经弄清楚如何将 RTF 转换为 PDF，然后我使用 ImageMagick 将其转换为 JPG 进行显示。我不喜欢我必须先转到 PDF 的事实，但它有效，所以我会坚持下去。感谢所有回复的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T19:34:17.150

也许您可以将 RTF 转换为 PDF，然后再转换为 JPG。当然，这比直接从 RTF 转换为 JPG 需要更多的工作，但它可能是当今可接受的短期解决方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T07:37:23.930

这可能需要不止一种工具......

对于 rtf 到 pdf

[http://www.linuxquestions.org/questions/linux-software-2/convert-rtf-to-pdf-263247/](http://www.linuxquestions.org/questions/linux-software-2/convert-rtf-to-pdf-263247/) [http://www.linuxforums.org/forum/linux-applications/141953-looking-convert- rtf-pdf-utility.html](http://www.linuxforums.org/forum/linux-applications/141953-looking-convert-rtf-pdf-utility.html)

至于PDF转JPG，你可以试试convert(linux)...ImageMagick

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T08:10:41.357

您可能需要考虑将 RTF 转换为 HTML，而不是将它们转换为图像。

[这](http://www.docfrac.net/)看起来很有希望。

# memory - 判断内存位置是否在 CPU 缓存中

> ID：683023
> 
> 赞同：9
> 
> 时间：2009-03-25T19:13:32.410
> 
> 标签：memory, assembly, caching, cpu, fault

操作系统可以确定内存页是在 DRAM 中还是在交换中；例如，只需尝试访问它，如果发生页面错误，则不是。

但是，CPU 缓存是否可以实现相同的功能？

是否有任何有效的方法来判断给定的内存位置是否已加载到缓存行中，或者知道它何时加载？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T19:24:36.937

一般来说，我认为这是不可能的。它适用于 DRAM 和页面文件，因为这是操作系统管理的资源，缓存由 CPU 本身管理。

操作系统可以对内存读取进行严格的计时循环，并尝试查看它是否以足够快的速度完成以进入缓存，或者它是否必须进入主内存——这很容易出错。

在多核/多进程系统上，处理器之间使用[缓存一致性协议](http://en.wikipedia.org/wiki/Cache_coherency)来确定它们何时需要使彼此的缓存无效，我想你可以有一个自定义设备来监听操作系统会查询的这个协议.

你想做什么？如果您想将某些内容强制到内存中，当前的 x86 处理器支持以非阻塞方式将内存预取到缓存中，例如，您可以使用 Visual C++ 将[`_mm_prefetch`](http://msdn.microsoft.com/en-us/library/84szxsww(VS.80).aspx)行提取到缓存中。

编辑：我自己没有这样做，所以使用风险自负。要确定用于分析的缓存未命中，您可以使用一些特定于体系结构的寄存器。 [http://download.intel.com/design/processor/manuals/253669.pdf](http://download.intel.com/design/processor/manuals/253669.pdf)，附录 A 给出了“性能调整事件”。这不能用于确定单个地址是否在缓存中或何时加载到缓存中，但可用于总体统计信息。我相信这就是 vTune（这个级别的非凡分析器）使用的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T19:43:20.777

如果您尝试自己确定这一点，那么运行程序的行为可能会使相关的缓存行无效，从而使您的测量无用。

这是反映科学原理的情况之一，即您无法在不影响您正在测量的东西的情况下测量某物。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-26T01:19:47.920

X86 不知道如何判断地址是否在缓存中，但这里是如何判断地址是否在缓存中

```
rdtsc
save timestamp
mov eax,address
rdtsc read timestamp counter
calculate timestamp difference
if < threshold then was in cache 
```

阈值必须从文档或经验中确定

一些机器有缓存命中/未命中计数器，它们同样适用

# iphone - 在 UITableViewCell 中切换图像的显示

> ID：683029
> 
> 赞同：3
> 
> 时间：2009-03-25T19:14:40.473
> 
> 标签：iphone, uitableview, uiimageview

根据条件的结果，我想在表格单元格中显示 UIImageView。否则显示 UITableViewCellAccessoryCheckmark。我想在 IB 中构建单元格。当我不想显示 UIImageView 时，我不确定如何处理它。如果我以编程方式构建它，我会根据需要添加 UIImageView。但由于它将在 IB 中完成，因此 UIImageView 始终存在。默认是否应该单独保留单元格（图像显示），否则删除 UIImageView 并显示 UITableViewCellAccessoryCheckmark？如果这样做了，我是否需要在 UIImageView 上添加一个标签，以便可以访问和删除它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T19:19:34.953

您可以轻松控制任何控件的可见性，包括 UIImageView。如果您想在 IB 中构建东西，那么一种解决方案是添加您需要的控件，将它们公开为属性，然后隐藏给定单元格不需要的控件。

例如

```
cell.image.hidden = YES; 
```

隐藏时，它们没有绘制开销，尽管您的单元格可能有数千行，但实际单元格将很少，因此这是一个相当有效的解决方案。请记住，如果您调用 [tableView dequeueReusableCellWithIdentifier] （您应该这样做），单元格将被重用，因此您必须显式显示/隐藏其可见性可能已更改的控件。

另一种方法是让单元格带有和不带图像，并在向表格添加数据时选择正确的单元格。但是，对于管理两个相似但略有不同的资产的相似单元来说，可能会很痛苦。

# ruby-on-rails - Using Thread.new to send email on rails

> ID：683034
> 
> 赞同：3
> 
> 时间：2009-03-25T19:16:38.267
> 
> 标签：ruby-on-rails, green-threads

I've been sending emails on my application (ruby 1.8.7, rails 2.3.2) like this `Thread.new{UserMailer.deliver_signup_notification(user)}`

Since ruby use green threads, there's any performance advantage doing this, or I can just use `UserMailer.deliver_signup_notification(user)` ?

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T19:28:22.497

In general, using green threads to run background tasks asynchronously will mean that your application can respond to the user *before* the mail is sent. You're not concerned about exploiting multiple CPUs; you're only concerned on off-loading the work onto a background process and returning a web page as soon as possible.

And from examining the Rails documentation, it looks like deliver_signup_notification will block long enough to get the mail queued (although I may be wrong). So using a thread here might make your application seem more responsive, depending on how your mailer is configured.

Unfortunately, it's not clear to me that deliver_signup_notification is necessarily thread-safe. I'd want to read the documentation carefully before relying on that.

Note also that you're making assumptions about the lifetime of a Rails process once a request has been served. Many Rails applications using DRb (or a similar tool) to offload these background tasks onto an entirely separate worker process. The easiest way to do this changes fairly often--see Google for [a number of popular libraries](http://www.google.com/search?q=rails+background+worker).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T02:22:32.457

Global VM lock will still almost certainly apply while sending that email, meaning no difference.

You should not start threads in a request/response cycle. You should not start threads at all unless you can watch them from create to join, and even then, it is rarely worth the trouble it creates.

Rails is not thread-safe, and is not meant to be from within your controller actions. Only since Rails 2.3 has **just dispatching** been thread-safe, and only if you turn it on in environment.rb with config.threadsafe!.

[This article](http://m.onkey.org/archives/2008/10) explains in more detail. If you want to send your message asynchronously use [BackgroundRb](http://backgroundrb.rubyforge.org/) or its analog.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-27T07:20:13.420

I have used your exact strategy and our applications are currently running in production (but rails 2.2.2). I've kept a close eye on it and our load has been relatively low (Less than 20 emails sent per day average, with peaks of around 150/day).

So far we have noticed no problems, and this appears to have resolved several performance issues we were having when using Google's mailserver.

If you need something in a hurry then give it a shot, it has been working for us.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T19:19:26.873

They'll be the same as far as I know.

# c# - 如何使用实体框架在 Linq to SQL 中的 DateTime 类型中仅比较没有时间的日期？

> ID：683037
> 
> 赞同：374
> 
> 时间：2009-03-25T19:17:43.163
> 
> 标签：c#, .net, database, entity-framework, linq-to-sql

有没有办法比较两个`DateTime`变量`Linq2Sql`但忽略时间部分。

该应用程序将项目存储在数据库中并添加发布日期。我想保持准确的时间，但仍然可以按日期本身来拉。

我想比较`12/3/89 12:43:34`并`12/3/89 11:22:12`让它忽略一天中的实际时间，所以这两个都被认为是相同的。

我想我可以`00:00:00`在比较之前设置一天中的所有时间，但实际上我确实想知道一天中的时间，我也希望能够仅按日期进行比较。

我发现了一些具有相同问题的代码，它们分别比较了年、月和日。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：631
> 
> 时间：2009-03-25T19:19:21.490

尝试使用对象`Date`上的属性`DateTime`...

```
if(dtOne.Date == dtTwo.Date)
    .... 
```

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2009-03-25T19:20:51.673

为了进行真正的比较，您可以使用：

```
dateTime1.Date.CompareTo(dateTime2.Date); 
```

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2014-02-17T09:30:37.740

这就是我使用 LINQ 的方式。

```
DateTime date_time_to_compare = DateTime.Now;
//Compare only date parts
context.YourObject.FirstOrDefault(r =>
                EntityFunctions.TruncateTime(r.date) == EntityFunctions.TruncateTime(date_to_compare)); 
```

如果您只使用`dtOne.Date == dtTwo.Date`它不会与 LINQ 一起使用（错误：LINQ to Entities 中不支持指定的类型成员“日期”）

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2016-04-04T23:02:38.170

如果您使用的是 Entity Framework < v6.0，则使用`EntityFunctions.TruncateTime` 如果您使用的是 Entity Framework >= v6.0，则使用`DbFunctions.TruncateTime`

`DateTime`在您想要在 Linq 查询中使用的任何类属性周围使用任何一个（基于您的 EF 版本）

例子

```
var list = db.Cars.Where(c=> DbFunctions.TruncateTime(c.CreatedDate) 
                                       >= DbFunctions.TruncateTime(DateTime.UtcNow)); 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-05-26T11:06:43.923

```
DateTime dt1 = DateTime.Now.Date;
DateTime dt2 = Convert.ToDateTime(TextBox4.Text.Trim()).Date;
if (dt1 >= dt2)
{
    MessageBox.Show("Valid Date");
}
else
{
    MessageBox.Show("Invalid Date... Please Give Correct Date....");
} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2016-03-10T13:53:12.480

```
DateTime? NextChoiceDate = new DateTime();
DateTIme? NextSwitchDate = new DateTime();
if(NextChoiceDate.Value.Date == NextSwitchDate.Value.Date)
{
Console.WriteLine("Equal");
} 
```

如果您使用可为空的 DateFields，则可以使用它。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-06-30T12:27:22.677

```
DateTime dt1=DateTime.ParseExact(date1,"dd-MM-yyyy",null);
DateTime dt2=DateTime.ParseExact(date2,"dd-MM-yyyy",null);

int cmp=dt1.CompareTo(dt2);

   if(cmp>0) {
       // date1 is greater means date1 is comes after date2
   } else if(cmp<0) {
       // date2 is greater means date1 is comes after date1
   } else {
       // date1 is same as date2
   } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-08-23T14:50:21.503

```
DateTime econvertedDate = Convert.ToDateTime(end_date);
DateTime sconvertedDate = Convert.ToDateTime(start_date);

TimeSpan age = econvertedDate.Subtract(sconvertedDate);
Int32 diff = Convert.ToInt32(age.TotalDays); 
```

diff 值表示年龄的天数。如果该值为负数，则开始日期在结束日期之后。这是一个很好的检查。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2020-02-09T12:22:37.703

您可以使用**Equals**或**CompareTo**。

**Equals**：返回一个值，指示两个**DateTime**实例是否具有相同的日期和时间值。

**比较返回值**：

1.  **小于零**：如果此实例早于值。
2.  **零**：如果此实例与值相同。
3.  **大于零**：如果此实例晚于值。

**DateTime 可以为空：**

```
DateTime? first = new DateTime(1992,02,02,20,50,1);
DateTime? second = new DateTime(1992, 02, 02, 20, 50, 2);

if (first.Value.Date.Equals(second.Value.Date))
{
    Console.WriteLine("Equal");
} 
```

或者

```
DateTime? first = new DateTime(1992,02,02,20,50,1);
DateTime? second = new DateTime(1992, 02, 02, 20, 50, 2);

var compare = first.Value.Date.CompareTo(second.Value.Date);

switch (compare)
{
    case 1:
        Console.WriteLine("this instance is later than value.");
        break;
    case 0:
        Console.WriteLine("this instance is the same as value.");
        break;
    default:
        Console.WriteLine("this instance is earlier than value.");
        break;
} 
```

**DateTime 不可为空：**

```
DateTime first = new DateTime(1992,02,02,20,50,1);
DateTime second = new DateTime(1992, 02, 02, 20, 50, 2);

if (first.Date.Equals(second.Date))
{
    Console.WriteLine("Equal");
} 
```

或者

```
DateTime first = new DateTime(1992,02,02,20,50,1);
DateTime second = new DateTime(1992, 02, 02, 20, 50, 2);

var compare = first.Date.CompareTo(second.Date);

switch (compare)
{
    case 1:
        Console.WriteLine("this instance is later than value.");
        break;
    case 0:
        Console.WriteLine("this instance is the same as value.");
        break;
    default:
        Console.WriteLine("this instance is earlier than value.");
        break;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-02-13T15:20:09.837

你可以试试

```
if(dtOne.Year == dtTwo.Year && dtOne.Month == dtTwo.Month && dtOne.Day == dtTwo.Day)
  .... 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-25T19:23:46.097

在您的 join 或 where 子句中，使用`Date`列的属性。在幕后，这执行了一个`CONVERT(DATE, <expression>)`操作。这应该允许您在没有时间的情况下比较日期。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-04-07T00:37:25.383

在**.NET 5**中：

要比较没有时间的日期，您必须使用`EF.Functions.DateDiffDay()`，否则您将在代码中进行比较，这意味着您可能从数据库中提取的数据比您需要的要多。

```
.Where(x => EF.Functions.DateDiffDay(x.ReceiptDate, value) == 0); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-10-29T16:15:31.903

对于那些在 EF 6 使用查询综合语法和 2019 方法的人：

```
 from obj in _context.Object
                        where DbFunctions.TruncateTime(obj.datetimeField) == DbFunctions.TruncateTime(dateTimeVar)
                        select obj
                    ).ToList(); 
```

* * *

## 回答 #14

> 赞同：-17
> 
> 时间：2011-10-19T14:51:07.357

```
 int o1 = date1.IndexOf("-");
        int o2 = date1.IndexOf("-",o1 + 1);
        string str11 = date1.Substring(0,o1);
        string str12 = date1.Substring(o1 + 1, o2 - o1 - 1);
        string str13 = date1.Substring(o2 + 1);

        int o21 = date2.IndexOf("-");
        int o22 = date2.IndexOf("-", o1 + 1);
        string str21 = date2.Substring(0, o1);
        string str22 = date2.Substring(o1 + 1, o2 - o1 - 1);
        string str23 = date2.Substring(o2 + 1);

        if (Convert.ToInt32(str11) > Convert.ToInt32(str21))
        {
        }
        else if (Convert.ToInt32(str12) > Convert.ToInt32(str22))
        {
        }
        else if (Convert.ToInt32(str12) == Convert.ToInt32(str22) && Convert.ToInt32(str13) > Convert.ToInt32(str23))
        {
        } 
```

# java - 如何使用优先队列？

> ID：683041
> 
> 赞同：406
> 
> 时间：2009-03-25T19:18:38.077
> 
> 标签：java, priority-queue

如何对[`PriorityQueue`](https://docs.oracle.com/javase/8/docs/api/java/util/PriorityQueue.html)我想要排序的内容进行排序？

[`offer`](https://docs.oracle.com/javase/8/docs/api/java/util/PriorityQueue.html#offer-E-)另外，和[`add`](https://docs.oracle.com/javase/8/docs/api/java/util/PriorityQueue.html#add-E-)方法之间有区别吗？

* * *

## 回答 #1

> 赞同：479
> 
> 时间：2009-03-25T19:20:48.570

使用构造函数重载，它接受 a`Comparator<? super E> comparator`并传入一个比较器，该比较器以适合您的排序顺序的方式进行比较。如果你举一个你想如何排序的例子，如果你不确定，我们可以提供一些示例代码来实现比较器。（虽然这很简单。）

正如其他地方所说：`offer`并且`add`只是不同的接口方法实现。在我拥有的 JDK 源代码中，`add`调用`offer`. 尽管`add`和由于能够指示由于大小限制而无法添加值，因此通常`offer`具有*潜在*的不同行为，但这种差异与无界无关。`offer``PriorityQueue`

这是一个按字符串长度排序的优先级队列示例：

```
// Test.java
import java.util.Comparator;
import java.util.PriorityQueue;

public class Test {
    public static void main(String[] args) {
        Comparator<String> comparator = new StringLengthComparator();
        PriorityQueue<String> queue = new PriorityQueue<String>(10, comparator);
        queue.add("short");
        queue.add("very long indeed");
        queue.add("medium");
        while (queue.size() != 0) {
            System.out.println(queue.remove());
        }
    }
}

// StringLengthComparator.java
import java.util.Comparator;

public class StringLengthComparator implements Comparator<String> {
    @Override
    public int compare(String x, String y) {
        // Assume neither string is null. Real code should
        // probably be more robust
        // You could also just return x.length() - y.length(),
        // which would be more efficient.
        if (x.length() < y.length()) {
            return -1;
        }
        if (x.length() > y.length()) {
            return 1;
        }
        return 0;
    }
} 
```

这是输出：

> 短的
> 
> 中等的
> 
> 确实很长

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2016-11-16T02:49:28.410

## Java 8 解决方案

我们可以在 Java 8 中使用`lambda expression`或`method reference`引入。如果我们有一些字符串值存储在优先级队列中（容量为 5），我们可以提供内联比较器（基于字符串的长度）：

**使用 lambda 表达式**

```
PriorityQueue<String> pq=
                    new PriorityQueue<String>(5,(a,b) -> a.length() - b.length()); 
```

**使用方法参考**

```
PriorityQueue<String> pq=
                new PriorityQueue<String>(5, Comparator.comparing(String::length)); 
```

然后我们可以将它们中的任何一个用作：

```
public static void main(String[] args) {
        PriorityQueue<String> pq=
                new PriorityQueue<String>(5, (a,b) -> a.length() - b.length());
       // or pq = new PriorityQueue<String>(5, Comparator.comparing(String::length));
        pq.add("Apple");
        pq.add("PineApple");
        pq.add("Custard Apple");
        while (pq.size() != 0)
        {
            System.out.println(pq.remove());
        }
    } 
```

这将打印：

```
Apple
PineApple
Custard Apple 
```

要反转顺序（将其更改为最大优先级队列）只需更改内联比较器中的顺序或`reversed`用作：

```
PriorityQueue<String> pq = new PriorityQueue<String>(5, 
                             Comparator.comparing(String::length).reversed()); 
```

我们还可以使用`Collections.reverseOrder`：

```
PriorityQueue<Integer> pqInt = new PriorityQueue<>(10, Collections.reverseOrder());
PriorityQueue<String> pq = new PriorityQueue<String>(5, 
                Collections.reverseOrder(Comparator.comparing(String::length)) 
```

所以我们可以看到它`Collections.reverseOrder`被重载以获取对自定义对象有用的比较器。`reversed`实际使用`Collections.reverseOrder`：

```
default Comparator<T> reversed() {
    return Collections.reverseOrder(this);
} 
```

## 报价（）与添加（）

根据[文档](https://docs.oracle.com/javase/7/docs/api/java/util/Queue.html)

> 如果可能，offer 方法插入一个元素，否则返回 false。这与 Collection.add 方法不同，后者只能通过抛出未经检查的异常才能添加元素。offer 方法设计用于当故障是正常而不是异常发生时使用，例如，在固定容量（或“有界”）队列中。

当使用容量受限的队列时，offer() 通常比 add() 更可取，后者只能通过抛出异常来插入元素失败。而[PriorityQueue](https://docs.oracle.com/javase/7/docs/api/java/util/PriorityQueue.html)是一个基于优先级堆的无界优先级队列。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-03-25T19:43:36.767

只需将适当的传递[`Comparator`](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Comparator.html)给[构造函数](http://java.sun.com/j2se/1.5.0/docs/api/java/util/PriorityQueue.html#PriorityQueue(int,%20java.util.Comparator))：

```
PriorityQueue(int initialCapacity, Comparator<? super E> comparator) 
```

[`offer`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/PriorityQueue.html#offer(E))和之间的唯一区别[`add`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/PriorityQueue.html#add(E))是它们所属的接口。`offer`属于[`Queue<E>`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Queue.html)，而`add`最初是在[`Collection<E>`](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Collection.html)界面中看到的。除此之外，这两种方法的作用完全相同——将指定元素插入优先级队列。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2011-01-03T08:56:52.313

来自[队列 API](http://download.oracle.com/javase/6/docs/api/java/util/Queue.html)：

> 如果可能，offer 方法插入一个元素，否则返回 false。这与 Collection.add 方法不同，后者只能通过抛出未经检查的异常才能添加元素。offer 方法设计用于当故障是正常而不是异常发生时使用，例如，在固定容量（或“有界”）队列中。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2010-11-30T13:51:51.143

没有什么不同，正如在 javadoc 中声明的那样：

```
public boolean add(E e) {
    return offer(e);
} 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2017-11-21T18:05:55.683

传一个`Comparator`. 填写您想要的类型代替`T`

使用 lambdas (Java 8+)：

```
int initialCapacity = 10;
PriorityQueue<T> pq = new PriorityQueue<>(initialCapacity, (e1, e2) -> { return e1.compareTo(e2); }); 
```

经典方式，使用匿名类：

```
int initialCapacity = 10;
PriorityQueue<T> pq = new PriorityQueue<>(initialCapacity, new Comparator<T> () {

    @Override
    public int compare(T e1, T e2) {
        return e1.compareTo(e2);
    }

}); 
```

要按相反顺序排序，只需交换 e1、e2。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-04-14T10:42:19.167

只是为了回答`add()`vs`offer()`问题（因为另一个问题在 imo 中得到了完美的回答，而这可能不是）：

根据[接口 Queue 上的 JavaDoc](http://docs.oracle.com/javase/7/docs/api/java/util/Queue.html)，“offer 方法在可能的情况下插入一个元素，否则返回 false。这与 Collection.add 方法不同，后者只能通过抛出未经检查的异常而无法添加元素。offer 方法设计用于当失败是正常而不是异常发生时使用，例如，在固定容量（或“有界”）队列中。”

这意味着如果您可以添加元素（在 PriorityQueue 中应该始终如此），它们的工作方式完全相同。但是如果你不能添加元素，`offer()`会给你一个不错的`false`回报，同时`add()`抛出一个你不希望在代码中出现的讨厌的未经检查的异常。如果未能添加意味着代码正在按预期工作和/或您将正常检查，请使用`offer()`. 如果添加失败意味着某些东西被破坏了，`add()`请根据[Collection 接口的规范](http://docs.oracle.com/javase/7/docs/api/java/util/Collection.html#add%28E%29)使用并处理引发的异常。

`offer()`它们都以这种方式实现，以通过返回一个`false`（[容量受限队列中的首选方法](http://docs.oracle.com/javase/7/docs/api/java/util/Queue.html#offer%28E%29)）来完成指定失败的 Queue 接口上的合约，并维护 Collection 接口上的合约，该合约[指定`add()`总是通过抛出异常而失败](http://docs.oracle.com/javase/7/docs/api/java/util/Queue.html#add%28E%29)。

无论如何，希望至少能澄清问题的那一部分。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2017-03-23T17:36:38.557

**在这里，我们可以定义用户定义的比较器：**

> 下面的代码：

```
 import java.util.*;
 import java.util.Collections;
 import java.util.Comparator; 

 class Checker implements Comparator<String>
 {
    public int compare(String str1, String str2)
    {
        if (str1.length() < str2.length()) return -1;
        else                               return 1;
    }
 }

class Main
{  
   public static void main(String args[])
    {  
      PriorityQueue<String> queue=new PriorityQueue<String>(5, new Checker());  
      queue.add("india");  
      queue.add("bangladesh");  
      queue.add("pakistan");  

      while (queue.size() != 0)
      {
         System.out.printf("%s\n",queue.remove());
      }
   }  
} 
```

> **输出 ：**
> 
> ```
>  india                                               
>    pakistan                                         
>    bangladesh 
> ```

报价和添加方法之间的区别：[链接](http://www.interviewsansar.com/2015/05/22/which-method-will-you-prefer-between-add-and-offer-methods-to-add-elements-in-a-queue-and-why/)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-08-23T19:47:43.790

作为 using 的替代方法[`Comparator`](https://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html)，您还可以在您的`PriorityQueue` **实现[`Comparable`](https://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html)**中使用您正在使用的类（并相应地覆盖该`compareTo`方法）。

请注意，如果该排序是对象的直观排序，通常最好只使用`Comparable`而不是`Comparator`- 例如，如果您有一个`Person`按年龄对对象进行排序的用例，那么最好只使用它`Comparator`。

```
import java.lang.Comparable;
import java.util.PriorityQueue;

class Test
{
    public static void main(String[] args)
    {
        PriorityQueue<MyClass> queue = new PriorityQueue<MyClass>();
        queue.add(new MyClass(2, "short"));
        queue.add(new MyClass(2, "very long indeed"));
        queue.add(new MyClass(1, "medium"));
        queue.add(new MyClass(1, "very long indeed"));
        queue.add(new MyClass(2, "medium"));
        queue.add(new MyClass(1, "short"));
        while (queue.size() != 0)
            System.out.println(queue.remove());
    }
} 
```

```
class MyClass implements Comparable<MyClass>
{
    int sortFirst;
    String sortByLength;

    public MyClass(int sortFirst, String sortByLength)
    {
        this.sortFirst = sortFirst;
        this.sortByLength = sortByLength;
    }

    @Override
    public int compareTo(MyClass other)
    {
        if (sortFirst != other.sortFirst)
            return Integer.compare(sortFirst, other.sortFirst);
        else
            return Integer.compare(sortByLength.length(), other.sortByLength.length());
    }

    public String toString()
    {
        return sortFirst + ", " + sortByLength;
    }
} 
```

输出：

```
1, short
1, medium
1, very long indeed
2, short
2, medium
2, very long indeed 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-01-14T01:02:47.913

我也想知道打印顺序。考虑这种情况，例如：

对于优先级队列：

```
PriorityQueue<String> pq3 = new PriorityQueue<String>(); 
```

这段代码：

```
pq3.offer("a");
pq3.offer("A"); 
```

打印方式可能不同于：

```
String[] sa = {"a", "A"}; 
for(String s : sa)   
   pq3.offer(s); 
```

[我从另一个论坛](http://www.coderanch.com/t/514612/java-programmer-SCJP/certification/add-offer-method-PriorityQueue)的讨论中找到了答案，用户说：“offer()/add() 方法只将元素插入队列。如果你想要一个可预测的顺序，你应该使用 peek/poll 返回头部队列中的。”

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-03-07T23:37:08.240

*优先级队列为每个元素分配了一些优先级，具有最高优先级的元素出现在队列顶部。现在，这取决于您希望如何为每个元素分配优先级。如果您不这样做，Java 将按照默认方式执行此操作。具有最小值的元素被分配最高优先级，因此首先从队列中删除。如果有几个元素具有相同的最高优先级，则任意打破平局。您还可以在构造函数中使用 Comparator 指定排序* `PriorityQueue(initialCapacity, comparator)`

**示例代码：**

```
PriorityQueue<String> queue1 = new PriorityQueue<>();
queue1.offer("Oklahoma");
queue1.offer("Indiana");
queue1.offer("Georgia");
queue1.offer("Texas");
System.out.println("Priority queue using Comparable:");
while (queue1.size() > 0) {
    System.out.print(queue1.remove() + " ");
}
PriorityQueue<String> queue2 = new PriorityQueue(4, Collections.reverseOrder());
queue2.offer("Oklahoma");
queue2.offer("Indiana");
queue2.offer("Georgia");
queue2.offer("Texas");
System.out.println("\nPriority queue using Comparator:");
while (queue2.size() > 0) {
    System.out.print(queue2.remove() + " ");
} 
```

**输出：**

```
Priority queue using Comparable:
Georgia Indiana Oklahoma Texas 
Priority queue using Comparator:
Texas Oklahoma Indiana Georgia 
```

否则，您还可以定义自定义比较器：

```
import java.util.Comparator;

public class StringLengthComparator implements Comparator<String>
{
    @Override
    public int compare(String x, String y)
    {
        //Your Own Logic
    }
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-07-17T12:34:21.223

这是您可以用于初始学习的简单示例：

```
import java.util.Comparator;
import java.util.PriorityQueue;
import java.util.Queue;
import java.util.Random;

public class PQExample {

    public static void main(String[] args) {
        //PriorityQueue with Comparator
        Queue<Customer> cpq = new PriorityQueue<>(7, idComp);
        addToQueue(cpq);
        pollFromQueue(cpq);
    }

    public static Comparator<Customer> idComp = new Comparator<Customer>(){

        @Override
        public int compare(Customer o1, Customer o2) {
            return (int) (o1.getId() - o2.getId());
        }

    };

    //utility method to add random data to Queue
    private static void addToQueue(Queue<Customer> cq){
        Random rand = new Random();
        for(int i=0;i<7;i++){
            int id = rand.nextInt(100);
            cq.add(new Customer(id, "KV"+id));
        }
    }

    private static void pollFromQueue(Queue<Customer> cq){
        while(true){
            Customer c = cq.poll();
            if(c == null) break;
            System.out.println("Customer Polled : "+c.getId() + " "+ c.getName());
        }
    }

} 
```

# apache - 为什么我收到 Apache 代理 503 错误？

> ID：683052
> 
> 赞同：52
> 
> 时间：2009-03-25T19:20:57.430
> 
> 标签：apache

直到昨天，我的服务器都运行良好。它正在运行[Redmine](http://www.redmine.org/)，它是最快乐的小服务器**，直到**我的“朋友”导入了我的小家伙无法接受的 SQL 表。不幸的是，经过一个小时试图让小家伙做出回应后，我们不得不重新启动他。

现在重新启动后，我们在尝试访问连接到 Redmine 的域时收到 503 错误。它连接到一个[Mongrel](https://rubygems.org/gems/mongrel)守护进程，我们使用 Apache 代理将所有连接定向到运行 Redmine 的端口。

在服务器 ( ) 上使用 Lynx，`http://localhost:8000`您可以看到 Ruby 应用程序运行良好。但是这个位在我的 Apache 配置文件中不起作用：

```
<VirtualHost *:80>
    ServerName sub.example.com
    ProxyPass / http://localhost:8000
    ProxyPassReverse / http://localhost:8000
    ProxyPreserveHost on
    LogLevel debug
</VirtualHost> 
```

这是 Apache 的错误日志输出：

```
[调试] mod_proxy_http.c(54): 代理: HTTP: 规范化 URL //localhost:8000
[debug] proxy_util.c(1335): [client 216.27.137.51] proxy: http: found worker http://localhost:8000 for http://localhost:8000/
[调试] mod_proxy.c(756)：运行方案 http 处理程序（尝试 0）
[调试] mod_proxy_http.c(1687)：代理：HTTP：服务 URL http://localhost:8000/
[调试] proxy_util.c(1755)：代理：HTTP：已获得（本地主机）的连接
[debug] proxy_util.c(1815): proxy: 连接 http://localhost:8000/ 到 localhost:8000
[调试] proxy_util.c(1908)：代理：连接/到 localhost:8000
[debug] proxy_util.c(2002): proxy: HTTP: fam 2 socket created to connect to localhost

[错误] (13)权限被拒绝：代理：HTTP：尝试连接到 127.0.0.1:8000 (localhost) 失败
[错误] ap_proxy_connect_backend 禁用（本地主机）的工作人员

[调试] proxy_util.c（1773）：代理：HTTP：已释放（本地主机）的连接

```

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2012-02-08T14:56:16.797

只要 Apache 检测到后端服务器已关闭，它就会以 503 响应至少 60 秒。这是默认行为。在您的示例中，如果您重新启动后端服务器（在此示例中为 Rails）并且有人尝试在 Rails 准备好之前通过 Apache 代理访问它，那么无论您的后端现在是否“启动”，Apache 将在接下来的 60 秒内返回 503 . 请参阅 ProxyPass 上的 apache 文档，其中指出：

> 重试 60
> 
> > 连接池工作程序重试超时（以秒为单位）。如果后端服务器的连接池工作程序处于错误状态，则 Apache 不会将任何请求转发到该服务器，直到超时到期。这可以关闭后端服务器进行维护，并在稍后将其重新联机。值 0 意味着总是在没有超时的情况下重试处于错误状态的工作人员。

因此，如果您将代理通行证设置为包含 retry=0，则在重新启动后端服务时将看不到 503。这在开发期间使用 Apache 作为反向代理时也很有用！例如：

> ProxyPass / [http://localhost:8000](http://localhost:8000)重试=0

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2011-11-18T16:03:22.743

运行以下命令

```
# /usr/sbin/setsebool httpd_can_network_connect 1 
```

或者

```
# /usr/sbin/setsebool httpd_can_network_connect true 
```

然后重新启动httpd

```
# service httpd restart 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T19:25:04.160

您确定它们以正确的顺序重新启动吗？我在 Apache 启动时遇到了奇怪的问题，然后 Mongrel 启动，虽然 Mongrel 正在运行，但 Apache 仍然抛出代理错误。

我过去通过各种咒语和重新启动 Apache 解决了这个问题，最终众神很高兴。似乎有时 Mongrel 进程没有正确关闭，因此您必须手动杀死它们。这是一些[可能]帮助的[链接。](http://www.imarichardson.com/2008/05/30/apache-and-mongrel-frustrations-502-503-operation-not-permitted-proxy-error-connection-refused-errors/)

我最终在我的`/etc/init.d/`mongrel 脚本中添加了一个“kill”选项，因为它发生了很多。它停止 Mongrel，终止所有 Mongrel 会话，启动 Mongrel 并重新启动 Apache。

```
<snip>
    kill)
      echo "Stopping, killing, starting, and restarting Apache..."
      mongrel_cluster_ctl stop -c $CONF_DIR --clean
      killall -u mongrel
      mongrel_cluster_ctl start -c $CONF_DIR --clean
      /etc/init.d/httpd restart
      RETVAL=$?
  ;;
</snip> 
```

可能不是一个很好的解决方案，但邪恶消失了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T01:06:35.710

尝试运行 monit 来监控你在 Apache 后面的 mongrel，这样它就可以在 mongrel 死掉或内存不足时为你重新启动。如果出于任何原因 Apache 仍然感到困惑，您可能只需要优雅地重新启动 apache，它应该会自行解决，但是对于 99% 的情况，监控您的杂种应该避免再次发生这种情况。另一种选择是调查 Phusion Passenger。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-21T08:06:07.813

首先通过以下命令检查8080端口是否在监听

```
netstat -tlpn 
```

如果不是通过以下命令重新启动 jenkins 服务器

```
sudo /etc/init.d/jenkins start 
```

它现在应该可以工作了。希望能帮助到你。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-14T08:45:34.190

拳头，你必须安装`selinux`：（SELinux代表Security-Enhanced Linux。）

```
apt-get install selinux 
```

之后，您可以通过以下命令启用 SElinux 的安全策略：

```
sed -i 's/SELINUX=.*/SELINUX=permissive/' /etc/selinux/config 
```

注意：

```
#     enforcing - SELinux security policy is enforced.
#     permissive - SELinux prints warnings instead of enforcing.
#     disabled - No SELinux policy is loaded. 
```

最后，重启apache！

# c# - 使用 div 显示错误

> ID：683053
> 
> 赞同：1
> 
> 时间：2009-03-25T19:20:59.083
> 
> 标签：c#, asp.net, html, error-handling

我有一个 ASP.NET(2.0, C#) Web 应用程序，我想知道如何使用 div 显示母版页上可能出现的所有一般错误。

例如，如果有一个“添加新用户”页面，所有有问题的字段都将显示如下：
发生以下错误：

1.  ...
2.  ...

我正在使用母版页，所以我想知道如何在其中使用带有标签的 div 来显示来自任何内容页面的错误。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T19:24:41.447

我建议使用面板。

```
<asp:Panel runat="server" id="pnlErrors" Visible="false">
The following Errors(s) Occurred: 
<asp:BulletedList id="lstErrors" runat="server">
</asp:BulletedList>
</asp:Panel> 
```

然后只需以`lstErrors`编程方式添加错误，如果它们发生并将可见性设置为 true。

编辑：我最初没有阅读关于母版页的部分。您可能会遇到的一个问题是从您的内容页面中找到该控件。这是您可以这样做的一种方法：

```
BulletedList lstReference = (BulletedList) this.Master.FindControl("lstErrors");
lstReference.Items.Add("Error occured contacting database.");
lstReference.Items.Add("Error occured processing payment.");

Panel panReference = (Panel) this.Master.FindControl("pnlErrors");
panReference.Visible = true; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T19:51:57.123

如果你在内置`ValidationSummary`控件中使用，除了放在母版页上，你不需要做任何事情：

```
<div class="error">
  <asp:ValidationSummary ID="vldSummaryMaster" runat="server" />
</div> 
```

这当然假设您正在使用内置的验证控件来捕获错误。

# sql - 按参数过滤查询的最佳方法？

> ID：683055
> 
> 赞同：0
> 
> 时间：2009-03-25T19:21:49.283
> 
> 标签：sql, tsql

我一直在使用这种方法来过滤我的查询：

```
Create PROCEDURE [dbo].[pGetTask]
    @showCompletedTasks bit = 1
    ,@showInProgressTasks bit = 1
    ,@taskID int = null
    ,@projectID int = null
    ,@applicationID int = null
    ,@clientID int = null

... Snip ...

where       
    a.clientID = isnull(@clientID, a.clientID)
    and a.applicationID = isnull(@applicationID, a.applicationID)
    and p.projectID = isnull(@projectID, p.projectID)
    and t.taskID = isnull(@taskID, t.taskID)
    and curr.complete = case @showCompletedTasks when 0 then 0 else curr.complete end
    and curr.complete = case @showInProgressTasks when 0 then 1 else curr.complete end 
```

这实际上将我对 664 行结果集的查询减慢了 2 秒。SQL 调优顾问没有多大帮助，所以我认为这不是正确的方法。除了大量的 if 语句之外，还有正确的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T19:27:28.867

假设您已经正确索引了 select 所在的表，并且这些字段是索引的一部分，我猜这将是对 isnull 的调用。我会将它们更改为：

```
(@clientID is null or a.clientID = @clientId) and ... 
```

至于case语句，位域上的索引是没有意义的，所以没什么可做的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T19:27:30.863

检查您的索引和统计信息。这似乎有点慢。另一种选择是进行动态查询，本质上构建一个表示您的 sql 的字符串并使用 sp_ExecuteSql （或 Exec 语句）执行它

# 编辑

您可以尝试结合您的两种情况，但我怀疑它会对查询的性能产生影响。不过会更好看……

尽管我不确定您的查询是否正确（如果没有更多信息很难说），但是在您尝试提供两种状态以返回的情况之间不应该有 or 子句，并且通过使用单独的参数我想我可以问仅完成，仅未完成或两者兼而有之...在这种情况下，您需要一个或

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T19:27:15.997

最好的办法是使用这个存储过程来调用一系列更具体的过程。你有两个问题：

1.  使用 case 语句会导致表扫描，这（显然）会忽略您可能拥有的任何索引
2.  即使您将语句分成几个有条件调用的语句，您仍然会得到一个编译的执行计划，该执行计划特定于对该过程的第一次调用。

如果您创建特定过程，例如 pGetTask_Completed 和 pGetTask_InProgress 并在此过程中有条件地调用它们，您应该没有任何问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T12:49:49.700

您可能是“参数嗅探”问题的受害者。MS-SQL 会将您第一次运行 SP 的参数作为制定查询计划的最佳样本。因此，您的查询可能会很慢。

为了证明，尝试通过将填充的参数模拟为变量来直接运行查询的内容。如果它快得多，那么您确实遇到了“参数嗅探”问题。

解决方案是诱使 MS-SQL 认为您的参数仅用于分配给另一个变量。例子：

```
 create proc ManyParams
(
    @pcol1 int,
    @pcol2 int,
    @pcol3 int
)
as
declare
    @col1 int,
    @col2 int,
    @col3 int

select
    @col1 = @pcol1,
    @col2 = @pcol2,
    @col3 = @pcol3

select 
    col1,
    col2,
    col3
from 
    tbl 
where 
    1 = case when @col1 is null then 1 else case when col1 = @col1 then 1 else 0 end end
and 1 = case when @col2 is null then 1 else case when col2 = @col2 then 1 else 0 end end
and 1 = case when @col3 is null then 1 else case when col3 = @col3 then 1 else 0 end end 

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T19:53:47.867

这是一篇关于这个主题的精彩文章：

[http://www.sommarskog.se/dyn-search-2005.html](http://www.sommarskog.se/dyn-search-2005.html)

它会给你很多想法去尝试。

我倾向于混合使用这些东西来使这些“搜索”类型的查询运行得更快。以下是我似乎一直在使用的一些：

*   我尝试使某些搜索参数成为必需的，这样您就可以在这些参数上找到索引。

*   如果可能（取决于行数）使用临时表拆分查询。如果您只有几百个 ClientID 值，请创建一个 #ClientID 临时表。放入用户想要的一个，或者全部。然后，您可以将其设为 FROM 表和/或将其他表内部连接到该表以使其更快。

*   如果您有可选的日期，请不要使用类似（@startDate 为 null 或 a.date >= @startDate）之类的日期。只需执行 SET @startDate=COALESCE(@startDate,'01/01/1970') 之类的操作。这将为您提供一个值并使用“OR”消除并使用索引。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T20:02:18.360

casperOne 的建议是我要开始的。

另一种可能性是：

```
WHERE
     (1 =
     CASE
         WHEN @client_id IS NULL THEN 1
         WHEN a.clientID = @clientID THEN 1
         ELSE 0
     END) AND
... 
```

我发现使用这样的 CASE 语句的 SQL Server（至少 2005 年）会导致查询计划短路其余逻辑。在简单比较的情况下，这并不是什么大问题，但是如果您的逻辑包含子查询或其他一些昂贵的操作，那么短路它可能会有很大帮助。在你的例子中，我会接受 casperOne 的建议。

此外，如果您使用上面的 CASE 方法，您需要将 RECOMPILE 选项添加到您的 SELECT 和存储过程中。

# c++ - 如何验证 LPVOID

> ID：683059
> 
> 赞同：4
> 
> 时间：2009-03-25T19:24:07.593
> 
> 标签：c++

我正在使用非托管的 C++，当我调用返回 LPVOID 的方法时发生的问题。

```
LPVOID MyMethod(...); 
```

问题是这个方法有时会返回一个 Bad Ptr，我想知道是否有办法检测到这个，如果返回的值是一个 Bad Ptr。

我试过问它是否为NULL，但没有运气。

我意识到结果是否是 Bad Ptr 的唯一方法是在调试时，我尝试了一些不同的方法，但仍然无法做到。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T19:30:30.793

不，没有简单的方法来确定指针是否坏。

Windows 确实有 IsBadReadPtr、IsBadWritePtr。这些函数本质上是有缺陷的——它们只在调用时确定函数在您的地址空间中是否可读或可写。它们也可能是[安全](http://blogs.msdn.com/LarryOsterman/archive/2004/05/18/134471.aspx) [问题](http://blogs.msdn.com/oldnewthing/archive/2006/09/27/773741.aspx)的原因，永远不应使用。

主要问题是无法区分进程仍可访问的“坏”指针和好指针。

例如，

```
int g[5];
int somethingElse;

void* GetPointer()
{
   return &g[5]; // Whoops, off by one.
} 
```

&g[5] 可能是您进程中的有效指针，并且可能指向其他内容，您将能够访问它而不会崩溃，但写入它会破坏您的状态。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-25T19:36:18.360

您真正的问题是您正在调用一个返回错误指针的函数。你可以访问它的源代码吗？90% 的时间我都遇到过这样的问题，这是因为：

1) 函数返回一个指向栈的指针；例如，

```
char a[10];
...
return a; 
```

2）该函数返回一个从未分配过有效内存的指针：

```
char* foo; // Invalid pointer
 ...
return foo; 
```

3) 该函数返回一个已被删除（或释放）的指针：

```
char* foo = new char[10];
...
delete[] foo;
return foo; 
```

你真的需要找到真正的问题，而不是解决它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T19:38:37.543

`LPVOID`是`typedef`指向 的指针`void`，Visual Studio 通常`NULL`在监视窗格中将值显示为“错误指针”，您确定该指针不是`NULL`吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-11T02:01:44.577

不，你不能。

但是，如果您可以创建一个辅助数据结构来存储位置并确保在它们被删除时将它们从该辅助数据结构中删除（可能将其添加到析构函数中），您可以在取消引用它们之前检查指针是否在该结构中.

# c# - 如何在c#中动态设置数组长度

> ID：683073
> 
> 赞同：28
> 
> 时间：2009-03-25T19:27:45.480
> 
> 标签：c#, arrays, object, array-initialize

我还是 C# 的新手，我一直在努力解决数组上的各种问题。我有一组元数据对象（名称值对），我想知道如何只创建我真正需要的“InputProperty”对象的数量。在这个循环中，我将元素的数量任意设置为 20，并尝试在条目变为 null 时退出，但接收端的 Web 服务不喜欢传递给它的任何 null 元素：

```
private Update BuildMetaData(MetaData[] nvPairs)
{
    Update update = new Update();
    InputProperty[] ip = new InputProperty[20];  // how to make this "dynamic"
    int i;
    for (i = 0; i < nvPairs.Length; i++)
    {
        if (nvPairs[i] == null) break;
        ip[i] = new InputProperty();
        ip[i].Name = "udf:" + nvPairs[i].Name;
        ip[i].Val = nvPairs[i].Value;
    }
    update.Items = ip;
    return update;
} 
```

总之，假设我在上面的输入数组中只有 3 个名称值对？与其为名为 ip 的数组分配 20 个元素，不如对其进行编码，以使 ip 仅与需要的一样大。更新对象通过另一个 web 服务传递，因此序列化很重要（即我不能使用 namevaluecollection 等）。

ps 是通过“添加评论”工具跟进已发布问题的唯一方法吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-25T19:30:08.313

```
InputProperty[] ip = new InputProperty[nvPairs.Length]; 
```

或者，您可以使用如下列表：

```
List<InputProperty> list = new List<InputProperty>();
InputProperty ip = new (..);
list.Add(ip);
update.items = list.ToArray(); 
```

我想指出的另一件事是，在 C# 中，您可以在循环内部的 for 循环中删除 int 变量的使用：

```
for(int i = 0; i<nvPairs.Length;i++
{
.
.
} 
```

只是因为我有心情，这是一种更清洁的方法来执行此方法 IMO：

```
private Update BuildMetaData(MetaData[] nvPairs)
{
        Update update = new Update();
        var ip = new List<InputProperty>();

        foreach(var nvPair in nvPairs)
        {
            if (nvPair == null) break;
            var inputProp = new InputProperty
            {
               Name = "udf:" + nvPair.Name,
               Val = nvPair.Value
            };
            ip.Add(inputProp);
        }
        update.Items = ip.ToArray();
        return update;
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-25T19:53:55.260

如果您不想使用`List`,`ArrayList`或其他动态大小的集合然后转换为数组（顺便说一下，这是我推荐的方法），那么您必须将数组分配到可能的最大值大小，跟踪您放入其中的项目数量，然后创建一个仅包含这些项目的新数组：

```
private Update BuildMetaData(MetaData[] nvPairs)
{
    Update update = new Update();
    InputProperty[] ip = new InputProperty[20];  // how to make this "dynamic"
    int i;
    for (i = 0; i < nvPairs.Length; i++)
    {
        if (nvPairs[i] == null) break;
        ip[i] = new InputProperty(); 
        ip[i].Name = "udf:" + nvPairs[i].Name;
        ip[i].Val = nvPairs[i].Value;
    }
    if (i < nvPairs.Length)
    {
        // Create new, smaller, array to hold the items we processed.
        update.Items = new InputProperty[i];
        Array.Copy(ip, update.Items, i);
    }
    else
    {
        update.Items = ip;
    }
    return update;
} 
```

另一种方法是始终分配`update.Items = ip;`，然后在必要时调整大小：

```
update.Items = ip;
if (i < nvPairs.Length)
{
    Array.Resize(update.Items, i);
} 
```

它的代码更少，但最终可能会完成相同数量的工作（即创建一个新数组并复制旧项目）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-08T12:41:13.850

用这个：

```
 Array.Resize(ref myArr, myArr.Length + 5); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-25T19:31:22.117

是否需要是一个数组？如果您使用 ArrayList 或 C# 中可用的其他对象之一，则内容不会受到此限制。Hashtable、IDictionnary、IList 等都允许动态数量的元素。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-25T19:34:23.933

您可以在方法中使用 List 并在最后将其转换为数组。但我认为如果我们谈论 20 的最大值，您的代码会更快。

```
 private Update BuildMetaData(MetaData[] nvPairs)
    {
        Update update = new Update();
        List<InputProperty> ip = new List<InputProperty>();
        for (int i = 0; i < nvPairs.Length; i++)
        {
            if (nvPairs[i] == null) break;
            ip[i] = new InputProperty();
            ip[i].Name = "udf:" + nvPairs[i].Name;
            ip[i].Val = nvPairs[i].Value;
        }
        update.Items = ip.ToArray();
        return update;
    } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-25T19:40:10.847

或者在 C# 3.0 中使用`System.Linq`你可以跳过中间列表：

```
private Update BuildMetaData(MetaData[] nvPairs)
{
        Update update = new Update();
        var ip = from nv in nvPairs
                 select new InputProperty()
                 {
                     Name = "udf:" + nv.Name,
                     Val = nv.Value
                 };
        update.Items = ip.ToArray();
        return update;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-08-23T20:39:59.227

用于`Array.CreateInstance`动态创建数组。

```
 private Update BuildMetaData(MetaData[] nvPairs)
    {
        Update update = new Update();
        InputProperty[] ip = Array.CreateInstance(typeof(InputProperty), nvPairs.Count()) as InputProperty[];
        int i;
        for (i = 0; i < nvPairs.Length; i++)
        {
            if (nvPairs[i] == null) break;
            ip[i] = new InputProperty();
            ip[i].Name = "udf:" + nvPairs[i].Name;
            ip[i].Val = nvPairs[i].Value;
        }
        update.Items = ip;
        return update;
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-25T20:06:07.557

通常，数组需要常量来初始化它们的大小。您可以扫描一次 nvPairs 以获得长度，然后“动态地”使用这样的长度变量创建一个数组。

```
InputProperty[] ip = (InputProperty[])Array.CreateInstance(typeof(InputProperty), length); 
```

不过，我不会推荐它。只要坚持

```
List<InputProperty> ip = ...
...
update.Items = ip.ToArray(); 
```

解决方案。它的性能并没有那么低，而且看起来更好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-12-20T20:25:34.220

您可以通过这种方式动态创建数组：

```
 static void Main()
    {
        // Create a string array 2 elements in length:
        int arrayLength = 2;
        Array dynamicArray = Array.CreateInstance(typeof(int), arrayLength);
        dynamicArray.SetValue(234, 0);                              //  → a[0] = 234;
        dynamicArray.SetValue(444, 1);                              //  → a[1] = 444;
        int number = (int)dynamicArray.GetValue(0);                      //  → number = a[0];

        int[] cSharpArray = (int[])dynamicArray;
        int s2 = cSharpArray[0];

    } 
```

# lucene - 推荐的标题提升？

> ID：683078
> 
> 赞同：3
> 
> 时间：2009-03-25T19:29:15.007
> 
> 标签：lucene, solr

我有一个相对简单的 Lucene 索引，由 Solr 提供服务。该索引包含两个主要字段，标题和正文，以及一些不太重要的字段。

大多数搜索引擎在标题中与正文中的匹配项提供更多相关性。我将开始为标题字段提供索引时间提升。

我的问题是，人们通常将什么值用于他们的标题字段？2？4？10？100？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T19:49:15.287

我建议您将中间体长除以中间标题长度。这大致为您提供了一个因子 M - 对于正文中出现 M 次单词，它将在标题中出现一次。现在，使用 M*3 之类的东西。当然，这是一种合理化的启发式方法，最好对这些值进行迭代。请参阅[Grant Ingersoll 的“Debugging Relevance Issues in Search”](http://www.lucidimagination.com/Community/Hear-from-the-Experts/Articles/Debugging-Relevance-Issues-Search)以获得更结构化的讨论。

# dll - 如何在 DLL 中使用 WTL？

> ID：683079
> 
> 赞同：1
> 
> 时间：2009-03-25T19:29:46.753
> 
> 标签：dll, atl, bho, wtl

我正在尝试在进程内 COM 服务器 DLL（IE BHO）中使用 WTL，但我正在努力使用 _Module。

我的 DLL 需求`CMyModule`来自`CAtlDllModuleT<>`：

```
class CMyModule : public CAtlDllModuleT< CMyModule >
{
public:
    DECLARE_LIBID(LIBID_MyLib)
    DECLARE_REGISTRY_APPID_RESOURCEID(IDR_MYPROJ, "{...}")
};

CMyModule _Module;

extern "C" BOOL WINAPI DllMain(...)
{
    hInstance;
    return _Module.DllMain(dwReason, lpReserved); 
}

...

STDAPI DllUnregisterServer(void)
{
    return _Module.DllUnregisterServer();
} 
```

但这与大多数 WTL 示例相冲突，后者需要以下内容`stdafx.h`：

```
extern CAppModule _Module; // WTL version of CComModule 
```

无论我采用哪种方式，我（不出所料）都会遇到编译错误。`CMyModule`源自`CAppModule`borks on`_Module.DllUnregisterServer()`等。`CMyModule`源自`CAtlDllModuleT<>`borks on 代码，例如`_Module.GetMessageLoop()`.

关于 WTL 应该如何在 DLL 中工作的任何好的参考资料？谷歌发现很多问题，但答案很少。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T22:13:01.920

我有一个在 DLL 中使用 WTL 的项目。我查看了我的标题是如何设置的，看起来我解决了同样的问题......

我的模块设置类似于从 CAtlDllModuleT<> 继承的示例代码，但全局模块变量的名称是 _AtlModule 而不是 _Module。例如：

```
class CMyModule : public CAtlDllModuleT< CMyModule >
{
public:
    DECLARE_LIBID(LIBID_MyLib)
    DECLARE_REGISTRY_APPID_RESOURCEID(IDR_MYPROJ, "{...}")
};

CMyModule _AtlModule; 
```

因此，所有 DllMain.cpp 入口点都使用 _AtlModule。然后在 stdafx.h 文件中看起来像这样：

```
// WTL includes
#define _Module (*_pModule)
#include <atlapp.h>
#include <atlctrls.h>
#include <atldlgs.h>
#undef _Module 
```

_pModule 的东西在 atlbase.h 中定义，例如：

```
__declspec(selectany) CComModule* _pModule = NULL; 
```

必须有更好的方法，但这确实有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T19:36:23.417

您是否考虑过多重继承的选择？尝试从 CAtlDllModule 和 CAppModule 继承，因为你需要两者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-28T14:46:50.133

我在 Office 加载项中使用 WTL；以下对我有用。（在 stdafx.h 的底部）

```
class DECLSPEC_UUID("XXXX-...") MyLib;

using namespace ATL;

/*
 * Application module
 */
class CAddInModule : public CAtlDllModuleT< CAddInModule >
{
public:
    CAddInModule() : m_hInstance(NULL)
    {
    }

    DECLARE_LIBID(__uuidof(MyLib))

    HINSTANCE GetResourceInstance()
    {
        return m_hInstance;
    }
    void SetResourceInstance(HINSTANCE hInstance)
    {
        m_hInstance = hInstance;
    }

private:

    HINSTANCE m_hInstance;
};

extern CAddInModule _AtlModule; 
```

然后是 DLL 主要用途`_AtlModule`：

```
// DLL Entry Point
extern "C" BOOL WINAPI DllMain(HINSTANCE hInstance, DWORD dwReason, LPVOID lpReserved)
{
    _AtlModule.SetResourceInstance(hInstance);
    return _AtlModule.DllMain(dwReason, lpReserved); 
}

// Used to determine whether the DLL can be unloaded by OLE
STDAPI DllCanUnloadNow(void)
{
    return _AtlModule.DllCanUnloadNow();
}

// Returns a class factory to create an object of the requested type
STDAPI DllGetClassObject(REFCLSID rclsid, REFIID riid, LPVOID* ppv)
{
    return _AtlModule.DllGetClassObject(rclsid, riid, ppv);
}

// DllRegisterServer - Adds entries to the system registry
STDAPI DllRegisterServer(void)
{
    // registers object, typelib and all interfaces in typelib
    HRESULT hr = _AtlModule.DllRegisterServer();
    return hr;
}

// DllUnregisterServer - Removes entries from the system registry
STDAPI DllUnregisterServer(void)
{
    HRESULT hr = _AtlModule.DllUnregisterServer();
    return hr;
} 
```

# git - 如何调试 git-cvsimport？（看不到复杂的提交）

> ID：683091
> 
> 赞同：2
> 
> 时间：2009-03-25T19:31:32.490
> 
> 标签：git, git-cvs

大约 40 分钟前，我使用 git-cvsexportcommit 提交了一个特别复杂的更改，涉及从 git 到 cvs 的多个文件重命名、合并和删除。这很顺利，从 CVS 结帐时可以看到更改。但是，当我运行 git-cvsimport 来更新我的 CVS 存储库的 git 镜像时，这些更改没有出现。

我知道 git-cvsimport 会延迟导入非常新的更改，以避免从尚未完成的多文件 CVS 提交中进行 git 提交，但我很确定延迟只有十分钟。

有什么想法有什么问题吗？我该如何调试呢？我是否需要手动运行 cvsps，如果需要，我会寻找什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T21:47:01.387

您应该尝试删除相关的 cvsps 缓存文件（应该在 ~/.cvsps/ 中）。我过去也遇到过类似的问题，我就是这样解决的。

您也可以尝试将 -x 选项传递给 cvsps，告诉它忽略缓存文件。您可以使用 git-cvsimport 的“-p”选项来执行此操作。

如果一切都失败了，我猜一个新的 git-cvsimport -C 会接受改变。

祝你好运！

# c# - 从 Gmail 下载电子邮件并保存到 SQL 服务器的脚本？

> ID：683092
> 
> 赞同：4
> 
> 时间：2009-03-25T19:31:39.340
> 
> 标签：c#, .net, email, gmail

有谁知道从 Gmail 下载电子邮件并将其存储到 SQL 服务器的脚本？（用于备份目的）

我正在寻找 .NET 解决方案 (C#)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T19:33:59.333

自己写一个很容易。只需通过 Pop3 的 IMAP 连接（已经有 .NET 库），然后下载电子邮件，并将它们粘贴到您的数据库中。顶，除非您需要更多功能，否则像这样的程序将需要一个小时来编写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T19:34:34.947

Gmail 支持 POP3，您可以使用此 .NET 客户端并以这种方式获取电子邮件，此时将它们放入数据库中是微不足道的：

[http://www.codeproject.com/KB/IP/despop3client.aspx](http://www.codeproject.com/KB/IP/despop3client.aspx)

# oop - 改变其类的对象的方法叫什么？

> ID：683093
> 
> 赞同：0
> 
> 时间：2009-03-25T19:31:43.550
> 
> 标签：oop

假设你有一个`Person`对象，它上面有一个方法，它将`promote()`它转换为一个`Captain`对象。你怎么称呼这种类型的方法/交互？

它也感觉像是一个倒置：

```
myCaptain = new Captain(myPerson); 
```

**编辑：**感谢所有回复。我遇到这种模式的原因（在 Perl 中，但在任何地方都相关）纯粹是为了方便。在不知道任何实现交易的情况下，您可以说`Captain`该类“有一个” `Person`（我意识到这可能不是最好的例子，但请确保它不是子类）。

我假设的实现：

```
// this definition only matches example A
Person.promote() {
  return new Captain(this)
}

personable = new Person;

// A. this is what i'm actually coding
myCaptain = personable.promote();

// B. this is what my original post was implying
personable.promote(); // is magically now a captain? 
```

所以，从字面上看，它只是构造 a 的一种方便方法`Captain`。我只是想知道这种模式是否已经在野外看到过，是否有名字。我想是的，它并没有真正改变类，因为它返回了一个不同的类。但理论上可以，因为我并不真正关心原版。

Ken++，我喜欢你指出用例的方式。有时，在适当的位置改变一些东西真的很棒，比如对内存敏感的环境。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T19:37:33.240

对象的方法不应更改其类。您应该有一个返回新实例的成员：

```
myCaptain = myPerson->ToCaptain(); 
```

或使用构造函数，如您的示例中所示：

```
myCaptain = new Captain(myPerson); 
```

根据您使用对象的方式，我将其称为转换，甚至是演员表。如果你有一个值对象：

```
Person person; 
```

您可以使用构造函数方法进行隐式转换：

```
Captain captain = person; 
```

（这是假设 C++。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T19:44:53.113

一个更简单的解决方案可能是使排名成为人的属性。我不知道您的数据结构或要求，但如果您需要一些试图打破语言基础的东西，那么可能有更好的方法来做到这一点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T19:47:22.547

您可能需要考虑“状态模式”，有时也称为“状态对象”模式。它在《设计模式》一书中定义，但您可以在 Google 上轻松找到很多相关信息。

该模式的一个特点是“对象似乎会改变其类别”。

以下是一些链接：

[状态对象](http://accu.org/index.php/journals/1403)

[模式：状态](http://www.vico.org/pages/PatronsDisseny/Pattern%20State/index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T20:14:09.363

每个人似乎都在假设一个类似 C++/Java 的对象系统，可能是因为问题中使用的语法，但是很有可能在运行时用其他语言更改实例的类。

Lisp 的 CLOS 允许随时更改实例的类，这是一种定义明确且高效的转换。（术语和结构略有不同：方法不“属于” CLOS 中的类。）

不过，我从未听说过这种特定类型的转换的名称。执行此操作的函数被简单地调用`change-class`。

[在 Kiczales 的AMOP](http://www.cliki.net/AMOP)之后， Richard Gabriel[似乎将其](http://www.dreamsongs.com/Files/clos-cacm.pdf)称为“变更类协议”，该协议将 CLOS 的许多内部用于元编程的“协议”形式化。

人们想知道您为什么要这样做；与简单地创建一个新实例相比，我看到了两大优势：

*   更快：更改类可以像更新指针和更新任何不同的插槽一样简单；如果类非常相似，这可以在没有新的内存分配的情况下完成
*   更简单：如果十几个地方已经引用了旧对象，则创建一个新实例不会改变它们指向的对象；如果您需要自己更新每一个，这可能会为应该是一个简单的操作增加很多复杂性（2 个词，在 Lisp 中）

这并不是说它总是正确的答案，但是当你想要它时能够做到这一点真是太好了。“更改实例的类”和“创建一个与该实例相似的新实例”是非常不同的操作，我喜欢能够准确地说出我的意思。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T20:26:46.103

第一个有趣的部分是要知道：为什么你想要/需要一个对象在运行时改变它的类？

有多种选择：

*   您希望它对给定应用程序状态的某些方法做出不同的响应。

*   您可能希望它具有原始类没有的新功能。

*   其他...

Java 和 C# 等静态类型语言不允许这种情况发生，因为在编译时应该知道对象的类型。

其他编程语言，如 Python 和 Ruby 可能允许这样做（我不确定，但我知道它们可以在运行时添加方法）

对于第一个选项，Charlie Flowers 给出的答案是正确的，使用状态模式将允许类的行为不同，但对象将具有相同的接口。

对于第二个选项，您无论如何都需要更改对象类型并将其分配给具有额外功能的新引用。所以你需要创建另一个不同的对象，你最终会得到两个不同的对象。

# telerik - Telerik RadGrid 在弹出表单中按“enter”键时打开一个额外的弹出编辑表单以进行插入

> ID：683098
> 
> 赞同：3
> 
> 时间：2009-03-25T19:32:59.727
> 
> 标签：telerik, radgrid

我有一个 radgrid，它使用带有自定义编辑模板的弹出编辑模式。按下回车键后的编辑表单将在网格中插入一个新项目。我进去添加一个项目。这样就成功插入了。然后我去添加第二个项目：弹出表单出现。我输入我的数据并按“输入”键插入项目。这一次，我的编辑表单不是插入项目，而是清除我输入的数据并打开另一个弹出编辑表单以允许编辑我之前插入的项目（从第一次开始）。我现在有 2 个弹出窗口（1 个用于插入，1 个用于更新）。

如果我单击插入按钮而不是按“输入”，那么一切正常。据我猜测，它认为我在网格上的选定行上按下回车键。在我尝试插入时，如何防止它触发“编辑”事件？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T13:04:14.990

尝试将面板添加到编辑模板并将 DefaultButton 设置为插入按钮。

```
<asp:Panel ID="pnlEditor" runat="server" DefaultButton="btnUpdateItem"> 
```

# c# - 加载程序集并更改源，是否可能以及如何？

> ID：683109
> 
> 赞同：3
> 
> 时间：2009-03-25T19:36:04.243
> 
> 标签：c#, .net, reflection, assemblies, on-the-fly

我正在为 CLR 脚本编写[.NET On-the-Fly](http://fly.sf.net)编译器，并希望实现下一个想法：有一个带有 C# 代码的模板文件，我想阅读它，创建一个程序集，加载它并即时放大源代码飞。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T19:43:52.413

您可以使用[CompileAssemblyFromSource](http://msdn.microsoft.com/en-us/library/system.codedom.compiler.codedomprovider.compileassemblyfromsource.aspx)执行此操作。我过去做过类似的事情，我用静态类包装器扩充了一些脚本，以便可以轻松调用它们。你可以[在这里看到它（或从中窃取）。](http://trac.assembla.com/plugintoolkit/browser/trunk/Pluto.Scripting/Implementation/ScriptEngine.cs)

为此，只需加载您的模板，将您的额外放大添加到代码中，然后一次性编译它。

* * *

如果要修改现有程序集，则需要使用[Mono.Cecil 之](http://www.mono-project.com/Cecil)类的东西。它允许您在运行时作为程序集加载和修改。有一篇[CodeProject](http://www.codeproject.com/KB/msil/reflexil.aspx?display=Print)文章使用 Reflexil，一个基于 Cecil 的 GPL 产品，它可能会帮助你获得一些想法......

# formatting - 如何将程序打印到 MS Word？

> ID：683117
> 
> 赞同：4
> 
> 时间：2009-03-25T19:38:02.693
> 
> 标签：formatting, ms-word

我们有一个项目，教授让我们用microsoft word打印程序代码。但是，当我将所有代码粘贴到 ms word 中时，结果发现它没有着色，那些漂亮的编程字体.. 它在 microsoft word 中看起来非常难看..

我希望它能够非常华丽地印在纸上。就像我们在记事本++中看到的一样

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T19:47:14.653

如果您使用的是 Windows，您可以在 Visual Studio 中打开源代码（假设它是 C++、C# 或 VB），复制代码并将其粘贴到 Word。

“Visual Studio”到“Word”确实保留了格式（颜色和字体）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T22:08:24.767

当我可以避免它时，我不会使用 Word。它根本不擅长保持格式，并且不能提供非常好看的打印。

*   换行不是程序感知的。
*   段落中断不是程序感知的。
*   保留 VS 的格式不会做基于结构的标记，是吗？
*   Word的排版引擎比TeX或者Quark/Indesign差很多

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T21:08:32.727

Microsoft Word 对于代码审查非常方便。特别是如果您不想花钱购买专门为同行代码审查设计的工具之一。每个审阅者都可以在文档中插入他们的评论和/或自己修改代码。如果您跟踪更改，那么您可以查看更改的内容并接受或拒绝更改。在审查期间，您只需循环浏览评论和更改。完成后，您只需将最终产品复制并粘贴回源文件即可。它比必须获取评论列表、破译它们然后自己合并请求要好得多。

编辑：我们使用 Visual Studio。因此，源代码和 Microsoft Word 之间的剪切/粘贴工作正常，除非行长度超过页面大小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T13:01:12.970

如果您有 NppExport 插件，请转到

> Plugins -> NppExport -> （然后您可以选择“导出到 RTF”、“将 RTF 复制到剪贴板”或“将所有格式复制到剪贴板”）

如果选择导出为 rtf，则在 Microsoft Word 中打开它，如果选择复制到剪贴板，则将其粘贴到 Word

希望这可以帮助

我为我的 SQL 分配尝试过它并且它有效

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T19:48:50.857

我不确定我是否理解这个问题，但如果你问“我如何将我的源代码放入 Word 并让它看起来很像 Notepad++”，你会想要对 Microsoft Word 自动化进行一些研究。

[Word 自动化使用 C#](http://www.c-sharpcorner.com/UploadFile/amrish_deep/WordAutomation05102007223934PM/WordAutomation.aspx)
[OLE 自动化使用 Word（文章）](http://www.freevbcode.com/ShowCode.asp?ID=3700)
[Microsoft Word 自动化类](http://www.codeguru.com/cpp/com-tech/atl/tutorials/article.php/c14519)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T19:59:45.077

这可能看起来很明显，但是您如何从记事本++ 打印它？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T21:33:24.257

Eclipse 的作用与 decasteljau 所说的相同。

当您从 Eclipse 复制代码，然后粘贴到 Outlook 上时，代码会保持其颜色。

# json - 与 GWT 一起使用的 Json <-> Java 序列化

> ID：683123
> 
> 赞同：59
> 
> 时间：2009-03-25T19:40:40.503
> 
> 标签：json, serialization, gwt, marshalling, javabeans

我正在寻找一个可以与 GWT 一起使用的 Java的*简单Json (de)serializer。*我搜索了一下，发现一些解决方案要么需要注释每个成员，要么定义无用的接口。挺无聊的。为什么我们没有一些非常简单的东西

```
class MyBean {
    ...
}

new GoodSerializer().makeString(new MyBean());
new GoodSerializer().makeObject("{ ... }", MyBean.class) 
```

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-04-10T07:03:13.610

看看 GWT 的[Overlay Types](http://code.google.com/p/google-web-toolkit/wiki/OverlayTypes)。我认为这是迄今为止在 GWT 中使用 JSON 最简单的方法。这是链接文章中修改后的代码示例：

```
public class Customer extends JavaScriptObject {
    public final native String getFirstName() /*-{ 
        return this.first_name;
    }-*/;
    public final native void setFirstName(String value) /*-{
        this.first_name = value;
    }-*/;
    public final native String getLastName() /*-{
        return this.last_name;
    }-*/;
    public final native void setLastName(String value) /*-{
        this.last_name = value;
    }-*/;
} 
```

一旦定义了覆盖类型，就很容易从 JSON 创建一个 JavaScript 对象并在 Java 中访问它的属性：

```
public static final native Customer buildCustomer(String json) /*-{
    return eval('(' + json + ')');
}-*/; 
```

如果您想再次使用 JSON 表示对象，可以将覆盖类型包装在 JSONObject 中：

```
Customer customer = buildCustomer("{'Bart', 'Simpson'}");
customer.setFirstName("Lisa");
// Displays {"first_name":"Lisa","last_name":"Simpson"}
Window.alert(new JSONObject(customer).toString()); 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2011-02-17T21:44:53.730

要尝试的另一件事是 GWT 2.1 引入的新[AutoBean](http://code.google.com/p/google-web-toolkit/wiki/AutoBean)框架。

您为您的 bean 和一个出售它们的工厂定义接口，然后 GWT 为您生成实现。

```
interface MyBean {
  String getFoo();
  void setFoo(String foo);
}

interface MyBiggerBean {
  List<MyBean> getBeans();
  void setBeans(List<MyBean> beans>;
}

interface Beanery extends AutoBeanFactory{
  AutoBean<MyBean> makeBean();
  AutoBean<MyBiggerBean> makeBigBean();
}

Beanery beanFactory = GWT.create(Beanery.class);

void go() {
  MyBean bean = beanFactory.makeBean().as();
  bean.setFoo("Hello, beans");
} 
```

AutoBeanCodex可用于将它们与 json 进行序列化[。](http://code.google.com/p/google-web-toolkit/wiki/AutoBean#AutoBeanCodex)

```
AutoBean<MyBean> autoBean = AutoBeanUtils.getAutoBean(bean);
String asJson = AutoBeanCodex.encode(autoBean).getPayload();

AutoBean<MyBean> autoBeanCloneAB = 
  AutoBeanCodex.decode(beanFactory, MyBean.class, asJson );

MyBean autoBeanClone = autoBeanCloneAB.as(); 
assertTrue(AutoBeanUtils.deepEquals(autoBean, autoBeanClone)); 
```

它们也在服务器端工作——使用`AutoBeanFactoryMagic.create(Beanery.class)`而不是`GWT.create(Beanery.class)`.

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-07-17T05:04:08.573

最简单的方法是使用 GWT 的内置 JSON API。这是[文档](http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/json/client/)。这是一个关于如何使用它的[很棒的教程。](http://gwttutorials.com/2009/07/27/parsing-json-with-gwt/)

就这么简单：

```
String json = //json string
JSONValue value = JSONParser.parse(json); 
```

JSONValue API 非常酷。它允许您在从 JSON 对象中提取值时链接验证，以便在格式有任何问题时抛出异常。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-26T08:05:45.720

看来我找到了问题的正确答案

我发现 GWT 中的 bean 到 json 和 json 到 bean 的转换并不是一项简单的任务。已知库将无法工作，因为 GWT 需要它们的完整源代码，并且该源代码必须仅使用 GWT 模拟的 Java 类。此外，您不能在 GWT 中使用反射。非常苛刻的要求！

我找到了唯一一个名为[gwt-jsonizer](http://code.google.com/p/gwt-jsonizer/)的现有解决方案。它使用一个自定义[生成器](http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/com/google/gwt/core/ext/Generator.html)类，并且每个“jsonable”bean 都需要一个附属接口。不幸的是，不打最新版的GWT就不行，而且很久没有更新了。

因此，我个人认为让我的 bean 知道如何将自己转换为 json 和从 json 转换更便宜、更快捷。像这样：

```
public class SmartBean {
    private String name;

    public String getName() { return name; }
    public void setName(String value) { name = value;  }

    public JSONObject toJson() {
        JSONObject result = new JSONObject();
        result.put("name", new JSONString(this.name));
        return result;
    }
    public void fromJson(JSONObject value) {
        this.name = value.get("name").isString().stringValue();
    }

} 
```

`JSONxxxx`是提供低级 json 支持的 GWT 内置类。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-12-15T11:57:28.680

[RestyGWT](http://restygwt.fusesource.org/index.html)是一个强大的库，用于在 GWT 中将 Java 对象编码或解码为 JSON：

```
import javax.ws.rs.POST;
...
public interface PizzaOrderCodec extends JsonEncoderDecoder<PizzaOrder> {
} 
```

然后：

```
// GWT will implement the interface for you
PizzaOrderCodec codec = GWT.create(PizzaOrderCodec.class);

// Encoding an object to json
PizzaOrder order = ... 
JSONValue json = codec.encode(order);

// decoding an object to from json
PizzaOrder other = codec.decode(json); 
```

它还有几个易于使用的 API 用于使用 Restful Web 服务。

玩得开心。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-04-01T07:13:57.993

检查这个：

GWT 专业 JSON 序列化器： [http ://code.google.com/p/gwtprojsonserializer/](http://code.google.com/p/gwtprojsonserializer/)

!适用于 GWT 2.0+！

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-12-16T17:11:45.210

json.org/java 这些天似乎包含在 GWT 中：

gwt-servlet-deps.jar\org\json\

或者，这个项目似乎很全面： [http ://code.google.com/p/piriti/](http://code.google.com/p/piriti/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-11-17T17:58:27.910

在 Google Web Toolkit Applications 第 510 至 522 页中，作者 Ryan Dewsbury 展示了如何使用 GWT 代码生成来对 XML 和 JSON 文档进行序列化。

你可以[在这里下载代码](http://groups.google.com/group/gwtapps/files)；您想要第 10 章的代码包，然后您想要查看 src/com/gwtapps/serialization 包。我没有看到此代码的许可证，但已通过电子邮件发送给作者以查看他所说的内容。如果他回复我会更新这个。

此解决方案的问题：

*   你必须在你想要序列化的所有对象上添加一个标记接口（他使用 java.io.Serializable 但我想你可以使用其他对象——如果你使用 hibernate 作为后端，你的 pojos 可能已经被标记为这样） .
*   代码只支持字符串属性；它可以延长。
*   该代码仅针对 1.4 和 1.5 编写。

因此，这不是一个开箱即用的解决方案，而是构建适合 GWT 的 JSON 序列化程序的一个很好的起点。将它与服务器端的 JSON 序列化程序结合起来，比如[json-lib](http://json-lib.sourceforge.net/)，你就可以开始了。

我还找到[了这个项目](http://code.google.com/p/rocket-gwt/wiki/JsonSerialization)（同样，需要一些标记接口）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-10-21T21:07:25.110

从谷歌代码尝试这个序列化程序：[http ://code.google.com/p/json-io/](http://code.google.com/p/json-io/)

如果您需要在 Java 中编写或读取 JSON 格式，这是可以使用的工具。无需创建额外的类等。一次调用即可将 Java 对象图转换为 JSON 格式。做相反的事情 - 创建一个 JSON 字符串或流到 Java 对象。这是我见过的最快的库。在大多数情况下，它比使用二进制格式的 ObjectOutputStream 和 ObjectInputStream 快。

非常方便的实用程序。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-04-06T14:31:43.443

您可能想查看此项目[https://gerrit.googlesource.com/gwtjsonrpc/](https://gerrit.googlesource.com/gwtjsonrpc/)

它是一个为支持 Android 代码审查系统 Gerrit 而创建的库，但它是一个独立模块，旨在嵌入到任何 GWT 项目中，而不仅仅是 Gerrit。

一个合理的教程可能是目录顶层的[README 。](https://gerrit.googlesource.com/gwtjsonrpc/+/master/README)它与标准 GWT RPC 非常相似，但它使用 JSON 编码。它还具有内置的 XSRF 保护。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-25T21:04:59.897

我好像经常回答这个问题...

code.google.com 上有一个名为[Using GWT for JSON Mashups](https://developers.google.com/web-toolkit/articles/using_gwt_for_json_mashups)的页面。（不幸的是）这超出了我的想象，因为我对 GWT 不太熟悉，所以它可能没有帮助。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-03-25T20:11:14.253

好的，我删除了我之前的答案，因为事实证明这正是您不想要的。

我不知道它与 GWT 的工作情况如何，但我们使用[json-lib](http://json-lib.sourceforge.net/)库来序列化我工作的普通 Java 项目中的对象。

它可以[直接从 JavaBean 创建 JSONObject](http://json-lib.sourceforge.net/snippets.html#Creating_a_JSONObject_from_a_JavaBean)，然后使用生成的 JSONObject 的 toString() 方法来获取实际的 JSON 字符串。

同样，它也可以将[JSON 转换回 JavaBean](http://json-lib.sourceforge.net/snippets.html#JSONObject_to_JavaBean)。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-03-26T02:45:44.583

不确定[杰克逊](http://jackson.codehaus.org/Tutorial)是否适合你。我不知道您是否正在寻找特定于 GWT 的产品；如果不是，它应该工作。

但是它的序列化/反序列化效果很好，比如：

```
// read json, create object
ObjectMapper mapper = new ObjectMapper();
MyBean bean = mapper.readValue(jsonAsString, MyBean.class);

// and write out
StringWriter sw = new StringWriter();
mapper.writeValue(sw, user);
String jsonOut = sw.toString(); 
```

您确实需要访问器（`getX()`序列化、`setX()`反序列化；可以用其他名称注释方法），仅此而已。

# x86 - 处理器如何处理条件？

> ID：683126
> 
> 赞同：5
> 
> 时间：2009-03-25T19:42:41.123
> 
> 标签：x86, conditional-statements

那么，超低级的 IF() 是什么样的，x86 处理器如何处理它？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-25T19:45:28.993

处理器具有“Branch if”指令，当满足某个条件时它会分支，否则它会继续执行下一条指令。

所以

```
if(A)
{
    dosomething;
} 
```

会成为

```
load A into register 0
if the zero flag is set (ie, register 0 contains 0x00) then jump to endcondition)
dosomething
endcondition: 
```

更复杂的条件 ( `if(A || B && C)`) 成为使寄存器处于 0 或非零状态的指令序列，因此 branchif 指令可以根据条件标志跳转或不跳转。

有许多条件标志（零、进位、负数、溢出等），并且一些 branchif 指令也在更复杂的条件下运行（即，它实际上可能会检查一个寄存器是否等于另一个寄存器，而不是简单地查看标志）。每种架构都是不同的，并且需要权衡取舍，因此指令集是完整的，而且速度快且紧凑。

正如 moocha 在评论中指出的那样，某些架构允许您对一些、许多甚至所有指令应用条件，因此您可能不仅有“分支 if”指令，还有“and if”、“add if”、 '移动如果'等

一旦您进入流水线、乱序执行、缓存、微代码和所有其他高级主题，x86 就非常、非常、非常复杂，超出了这个简单的解释。对于大多数目的，上述解释就足够了。但是，如果您正在编写一个手工制作的非常非常紧密的算法，那么您必须考虑这些因素以获得最大的性能和吞吐量。

这是另一个问题的主题......

-亚当

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T20:03:01.463

使用 C 编译器的输出（使用`-S`gcc 上的开关）来查看给定的 C 代码片段在编译时会生成什么输出是相当容易的。不过，在玩具程序上使用优化时要小心。如果您不小心，优化器通常会优化掉总是以一种或另一种方式运行的条件（有关更详细的解释，请参阅[这篇关于微基准的文章）。](http://www.ibm.com/developerworks/java/library/j-jtp02225.html)

例如，一个简单的 C 程序：

```
#include <stdio.h>

int main (int argc, char **argv) {
    int ii = 10;
    int jj = 20;
    if (jj > ii) {
        puts ("jj > ii \n");
    }
    return 0;
} 
```

编译为以下汇编语言：

```
 .file   "foo.c"
    .section    .rodata
.LC0:
    .string "jj > ii \n"
    .text
.globl main
    .type   main, @function
main:
    leal    4(%esp), %ecx
    andl    $-16, %esp
    pushl   -4(%ecx)
    pushl   %ebp
    movl    %esp, %ebp
    pushl   %ecx
    subl    $20, %esp
    movl    $10, -8(%ebp)
    movl    $20, -12(%ebp)
    movl    -12(%ebp), %eax
    cmpl    -8(%ebp), %eax
    jle .L2
    movl    $.LC0, (%esp)
    call    puts
.L2:
    movl    $0, %eax
    addl    $20, %esp
    popl    %ecx
    popl    %ebp
    leal    -4(%ecx), %esp
    ret
    .size   main, .-main
    .ident  "GCC: (Ubuntu 4.3.2-1ubuntu12) 4.3.2"
    .section    .note.GNU-stack,"",@progbits 
```

简要剖析正在发生的事情：

*   第一部分 ( ) 用字符串 ' '`.rodata`声明一个常量`jj > ii \n`

*   第二部分是初始化堆栈上的`ii`和`jj`变量的内容。

*   来自的位`cmpl -8(%ebp), %eax`正在做实际的比较；该`jle`指令跳过了对“ `puts`”的调用，这实际上是“ `if`”语句的逻辑颠倒了。

*   在标签 ' `.L2`' 之后，系统正在整理堆栈顶部并从调用中返回。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T19:49:36.770

这是一个分支指令，取决于特定的机器架构。它计算出如何设置内存位置或寄存器来测试特定的低级条件 - 例如分支如果不等于或分支如果不为零，...... - 然后该测试是否会跳转（或者如果条件失败则不这样做）到内存的另一部分。显然，如果您有一个复杂的条件，它可能需要评估许多不同的条件，并且可能涉及多个分支指令。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T19:50:46.890

通常，CPU 具有所谓的指令寄存器，它保存当前机器语言操作码的内存地址，以便接下来执行......以及许多其他寄存器来保存数据。

通常，cpu 执行指令寄存器中的每个操作码后，它只需将其加一以移动到内存中的下一个位置，该位置应该在已编译的程序应用程序中具有下一个操作码。

一个操作码（实际上可能有几个），但是通过“比较”其他两个 cpu 寄存器中的值，它允许 cpu “分支”，如果一个大于另一个，它将一个内存地址复制到指令寄存器中，而如果另一个是最大的，它会将第二个不同的内存地址复制到指令寄存器中。

这大约是“低”水平，因为它可以说是没有谈论继电器和晶体管......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T20:18:47.243

以下是关于如何在 x86 架构上编译此类结构的一个很好的概述：[http ://en.wikibooks.org/wiki/X86_Disassembly/Branches#If-Then](http://en.wikibooks.org/wiki/X86_Disassembly/Branches#If-Then)

有时有一些方法可以避免分支（由于管道中断，这通常会对性能产生强烈的负面影响）。例如，从 i686 开始的指令集（从 Pentium Pro 到今天的所有指令）都有一个条件移动指令，它可能会编译这个：

```
if (a==0) {
    b= 1;
} 
```

像这样：

```
cmp    0, eax
cmovzl ebx, 1 
```

没有分支，只要您的编译器设置为针对 i686+（感觉就像这样；编译器复杂且难以理解）。SET[condition] 是另一个类似的条件指令。

幸运的老 ARM 程序员可以有条件地指定任何指令，这大大减少了分支。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T20:47:46.240

尽管大多数 if 语句最终会成为条件分支，但对于两个分支都没有任何副作用的非常简单的情况，优化编译器可能会生成执行这两个分支并计算结果的代码，而不是只执行一个。这在流水线架构中具有优势，其中计算两个分支的平均成本低于由于分支预测未命中而导致的平均成本。

例如，代码：

```
int x;

if ( y < 5 )
  x = 5;
else
  x = y; 
```

可以像这样编译：

```
y -= 5
int r = y < 0; // r is 1 if y < 5, 0 otherwise
r -= 1         // r is 0x00000000 if y < 5, 0xffffffff otherwise
x = y & r      // x is 0 if y < 5, (y-5) otherwise 
x += 5;        // x is 5 if y < 5, y otherwise 
```

可以在没有任何分支的情况下转换为机器码

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-25T19:46:42.860

基本上，您有一堆电子在 CPU 内部的各种原子之间传递。由于 CPU 中硅原子的结构，电子遵循某些路径，这决定了计算机将遵循的执行分支。

编辑：**看来我应该解释得不那么含糊了**。忍耐一下，我学的是计算机科学，不是电气工程，所以我对这些东西没有很深的了解：

您的 CPU 由一种材料制成，通常是硅，称为“半导体”。半导体的一大优点是它们的电气特性可以通过“掺杂”轻松改变，或者应用杂质在材料上形成负或正“电荷载流子”区域。这些区域汇合在一起的线路被称为“交汇点”，电流通过这些交汇点的一种方式比另一种更容易。这一特性被用来制造二极管，它允许电流仅在一个方向上流动，以及晶体管，它可以被认为是允许一个电流控制另一个电流的微型开关。这些晶体管和二极管以多种方式组合在一起，以创建 CPU 的逻辑门。

CPU 内部的许多逻辑门都专门用作“控制单元”，它负责检索和解码指令，告诉 CPU 的其余部分做什么，最后得到下一条指令。在 x86 上，控制单元实际上正在运行“微代码”，它告诉它如何处理分支、流水线等。您确实需要非常具体地了解特定的处理器系列，才能了解 x86 ISA 如何在特定的微架构上实现。

# c - 您如何处理 WTL/Win32 应用程序中的树形视图的右键单击？

> ID：683132
> 
> 赞同：1
> 
> 时间：2009-03-25T19:43:52.943
> 
> 标签：c, windows, winapi, mfc, wtl

我有一个用 ATL 编写的基本应用程序，使用 VS2008 的向导。我在应用程序的左侧有一个树视图。我看到了如何（痛苦地）添加树项。问题是如何在鼠标右键单击时显示菜单？如何捕获每个可以选择的项目上的任何点击事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T18:07:02.313

您应该通过[在消息映射中指定处理程序来](http://msdn.microsoft.com/en-us/library/2e1ew1ek.aspx)[`WM_CONTEXTMENU`](http://msdn.microsoft.com/en-us/library/ms647592.aspx)检测Windows 消息。然后，您可以在处理程序中显示上下文菜单。然后，您需要确保在从上下文菜单中选择命令时还处理消息映射中的菜单命令。在这部分使用消息映射中的宏。[`COMMAND_HANDLER`](http://msdn.microsoft.com/en-us/library/xsxbs7hc.aspx)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-11-10T12:01:19.853

杰夫耶茨的回答给了我方向。因为我使用的是 C，所以解决方案有点不同（而且像往常一样，有点复杂）：

这个想法是计算树视图中执行右键单击的点，然后获取项目。现在您可以检查项目的类型并显示相应的上下文菜单。为了防止用户混淆，下面还选择了树形视图中被右键单击的节点。

该示例假定您的对话框中有一个树视图。您可能需要循环浏览对话框中的树视图。

```
 case WM_CONTEXTMENU:
    {
        RECT rcTree;
        HWND hwndTV;
        HTREEITEM htvItem;
        TVHITTESTINFO htInfo = {0};

        long xPos = GET_X_LPARAM(lParam);   // x position from message, in screen coordinates
        long yPos = GET_Y_LPARAM(lParam);   // y position from message, in screen coordinates 

        hwndTV=GetDlgItem(hDlg, IDC_TREE1);         // get the tree view 
        GetWindowRect(hwndTV,&rcTree);              // get its window coordinates
        htInfo.pt.x= xPos-rcTree.left;              // convert to client coordinates
        htInfo.pt.y= yPos-rcTree.top;

        if (htvItem=TreeView_HitTest(hwndTV, &htInfo)) {    // hit test
            TreeView_SelectItem(hwndTV, htvItem);           // success; select the item
            /* display your context menu */
        }
        break;
    } 
```

下面显示一个上下文菜单：

```
 RECT winPos, itemPos;

        HMENU hCtxtMenuBar= LoadMenu(ghInst,MAKEINTRESOURCE(ID_CTXTMENUS_RESOURCE));
        HMENU hCtxtMenu= GetSubMenu(hCtxtMenuBar, MY_CTXMENU);

        TreeView_GetItemRect(hwndTV, htvItem, &itemPos, TRUE);
        GetWindowRect(hwndTV, &winPos);

        SendMessage (hDlg, WM_COMMAND, 
            TrackPopupMenuEx(hCtxtMenu,TPM_LEFTALIGN|TPM_TOPALIGN|TPM_NONOTIFY|TPM_RETURNCMD,
                winPos.left+itemPos.left, winPos.top+itemPos.bottom, hDlg,0),
            (LPARAM)hwndTV); 
```

# xml - XSD 可视化？

> ID：683133
> 
> 赞同：13
> 
> 时间：2009-03-25T19:44:02.197
> 
> 标签：xml, xsd

我最近一直在使用很多半复杂的 XSD，我想知道：有哪些更好的工具可以用于处理 XML 模式？有没有图形工具？

独立或基于 Eclipse 是理想的，因为我们不是 .net 商店。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-26T09:24:45.607

我发现[Eclipse 标准 XSD 编辑器](http://www.eclipse.org/xsd)没问题。[在此处](http://wiki.eclipse.org/index.php/Introduction_to_the_XSD_Editor)查看一些屏幕截图。您可以从标准更新站点安装它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-19T11:13:36.193

很长一段时间以来，我一直在寻找可视化 XSD 文件的工具。如前所述。我的前两个是

*   [Altova XML 间谍](http://www.altova.com/xml-editor/)
    *   最佳功能和出色的外观和感觉。对于小用户来说太贵了。
*   [液体 XML 工作室](http://www.liquid-technologies.com/)
    *   Altova 的真正好替代品，做的事情有点不同，但值得找出 LiquidXML 中的方法

除了这两个之外，我个人很难找到可以直观地呈现所有信息的工具（尤其是长 XSD 文件）。这包括列出元素的枚举值。

如果您只需要一种快速的方法来直观地查看 XSD 文件，我非常喜欢这两个查看工具。

*   [XSD图](http://regis.cosnier.free.fr/?page=XSDDiagram)-EXE文件下载
*   [XML Grid](http://xmlgrid.net/) - 在线 XSD 查看器

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T19:46:42.843

尝试：

*   [氧气 XML 模式编辑器](http://www.oxygenxml.com/xml_schema_editor.html)
*   [Liquid Technologies 的 XML / XSD 编辑器](http://www.liquid-technologies.com/)

还有很多其他的 - 但我更喜欢这两个中的一个。

马克

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T20:37:41.270

我认为这是值得的：[Altova XMLSPY](http://www.altova.com/xml-editor/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T07:53:01.333

我们使用[Liquid Xml Studio](http://www.liquid-technologies.com/XmlStudio/Free-Xsd-Editor.aspx)，它让生活变得如此轻松，您可以直接理解和编辑图表。我们使用免费版很久了，现在已经设法让老板为完整版付费。

[![替代文字](https://i.stack.imgur.com/49iyo.jpg)](https://i.stack.imgur.com/49iyo.jpg)
[（来源：[liquid-technologies.com](http://www.liquid-technologies.com/Images/ScreenShots/XmlStudio/InlineEdit_322x202.jpg)）]

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-14T21:56:14.610

如果您不想使用 Eclipse，或者您已经使用 Netbeans，那么 Geertjan 在他的博客上描述了如何安装的 XSD 编辑插件：[https ://blogs.oracle.com/geertjan/entry/xml_schema_editor_in_netbeans](https://blogs.oracle.com/geertjan/entry/xml_schema_editor_in_netbeans)

我可能弄错了，但我认为这个 XSD 编辑器曾经与 ​​IDE 捆绑在一起，我觉得它仍然应该如此。无论哪种方式，它都运行良好，尤其是在 Netbeans 平台之上。

# java - LunarLander 中的 Android IllegalThreadStateException

> ID：683136
> 
> 赞同：1
> 
> 时间：2009-03-25T19:45:17.637
> 
> 标签：java, android, surfaceview, illegalstateexception

只是来完善我的应用程序并在用户离开后使其恢复。当应用程序恢复时，我得到一个 IllegalThreadStateException，这很烦人。这个问题出现在谷歌给出的[Lunar Lander](http://developer.android.com/guide/samples/LunarLander/index.html)示例中。有没有人在使用 SurfaceView 时找到恢复工作的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T17:10:36.987

我相信这是由于 Surface 和 Activity 的处理方式不同造成的。当您离开 LunarLander 应用程序时，表面被销毁（调用 surfaceDestroyed），但 Activity 仅暂停（调用 onPause）。当活动恢复时，表面被创建（调用surfaceCreated）并尝试再次启动绘图线程。

这意味着创建线程发生在 Activity 的生命周期中，而销毁线程发生在 SurfaceView 的生命周期中，它们并不总是对应，因此会出现 IllegalThreadStateException。解决方案是将线程绑定到一个生命周期或另一个生命周期，而不是两者。

我认为[这个线程](https://stackoverflow.com/questions/672325/android-regaining-focus-using-surfaceview)提出了一个可能的解决方案，虽然我不知道它是否有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-20T18:15:32.097

在我自己的测试中，我在surfaceCreated()方法中创建了绘图线程，这样就彻底解决了这个问题。这是我的方法实现：

```
@Override
public void surfaceCreated(SurfaceHolder arg0) {
    _thread = new DrawThread(getHolder());
    _thread.setRunning(true);
    _thread.start();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-05T02:07:57.443

所以在代码中，当`surfaceDestroyed()`被调用时，它设置`mRun`为 false 并调用`thread.join()`. 这会导致线程完成并终止。当应用程序再次启动并被`surfaceCreated()`调用时，它会调用`thread.start()`. 这是无效的，因为线程死后无法启动。

修复的两个选项：

a) 在 - 中启动一个新线程，`surfaceCreated()`如上。

b）或者添加一个检查`surfaceDestroyed()`以`Activity.isFinishing()`仅在为真时结束线程。为此，我用另一个 while 循环包围了线程，如果返回 true `while(mRun)`，则该循环仅设置为 false 。`isFinishing()`

# xslt - XSL 101 - 如何为给定的 XML 文档生成基本的 XSL 样式表？

> ID：683138
> 
> 赞同：2
> 
> 时间：2009-03-25T19:45:41.927
> 
> 标签：xslt

以下是将 IIS 6/Windows Server 2003 网站的配置保存到文件时得到的片段：

```
<?xml version ="1.0"?>
<configuration xmlns="urn:microsoft-catalog:XML_Metabase_V64_0">
<MBProperty>
<IIsWebServer   Location ="/LM/W3SVC/1"
        AppPoolId="DefaultAppPool"
        DefaultDoc="Default.htm,Default.asp,index.htm,iisstart.htm,Default.aspx"
    ServerAutoStart="FALSE"
    ServerBindings=":80:"
    ServerComment="Default Web Site"
    ServerSize="1"
>
</IIsWebServer>
<IIsWebServer   Location ="/LM/W3SVC/1020944513"
    AuthFlags="0"
    LogPluginClsid="{FF160663-DE82-11CF-BC0A-00AA006111E0}"
    ServerAutoStart="TRUE"
    ServerBindings="161.230.8.183:80:"
    ServerComment="staging.magazinefundraising.com"
>
</IIsWebServer>
<IIsWebServer   Location ="/LM/W3SVC/103632312"
    AuthFlags="0"
    LogPluginClsid="{FF160663-DE82-11CF-BC0A-00AA006111E0}"
    ServerAutoStart="TRUE"
    ServerBindings="161.230.9.48:80:"
    ServerComment="QSP2.Downtime"
>
</IIsWebServer>
</MBProperty>
</configuration> 
```

如您所见，and元素`<IIsWebServer>`之间有多个部分。`<MBProperty>``</MBProperty>`

我想创建一个简单的 xsl 样式表，它输出一个多列（表格）结果，其中包含每个 IIsWebServer 实例的以下属性：

```
ServerComment
ServerBindings
AuthFlags 
```

所以结果可能类似于：

```
ServerComment     ServerBindings     AuthFlags  
-------------     --------------     ---------  
QSP2.Downtime     161.230.9.48:80:   0 
```

等等...

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T20:08:27.440

XSL 可能是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt"
    xmlns:mb="urn:microsoft-catalog:XML_Metabase_V64_0"
    exclude-result-prefixes="msxsl">
    <xsl:output method="text" indent="yes"/>

    <xsl:template match="/">
      ServerComment&#160;&#160;&#160;ServerBindings&#160;&#160;&#160;AuthFlags

      <xsl:apply-templates />
    </xsl:template>

  <xsl:template match="mb:IIsWebServer">

    <xsl:value-of select="./@ServerComment" />
    <xsl:text>&#160;</xsl:text>
    <xsl:value-of select="./@ServerBindings" />
    <xsl:text>&#160;</xsl:text>
    <xsl:value-of select="./@AuthFlags" />

  </xsl:template>
</xsl:stylesheet> 
```

当然，你会想要美化它:-) 但它基本上可以工作。

这是否是正确的选择和最好的技术，完全取决于你:-) 但它可以做到 - 没问题。

马克

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-25T20:15:24.460

正如 Emil 所说，XSL 并不完全是为*文本*格式而设计的。但是，如果您输出 HTML，您应该能够实现您的目标。类似于以下内容：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="/">
<table>
    <tr>
        <th>ServerComment</th>
        <th>ServerBindings</th>
        <th>AuthFlags</th>
    </tr>
        <xsl:for-each select="/configuration/MBProperty/IIsWebServer">
    <tr>
        <td><xsl:value-of select="@ServerComment" /></td>
        <td><xsl:value-of select="@ServerBindings" /></td>
        <td><xsl:value-of select="@AuthFlags" /></td>
    </tr>
        </xsl:for-each>
</table>
    </xsl:template>
</xsl:stylesheet> 
```

如果您打算开发仅用于查看目的的表格显示，这可能是您最好的选择。但是，如果您打算以其他方式使用数据，则最好采用 Marc 或 Emil 的方法。

# sql-server - MSSQL 2000 和 2005 之间的 SQL 语言差异

> ID：683140
> 
> 赞同：2
> 
> 时间：2009-03-25T19:46:36.370
> 
> 标签：sql-server, sql-server-2005, sql-server-2000, backwards-compatibility

我的公司有一个为 SQL Server 2005（以及其他）开发的应用程序，一个潜在的客户正试图在 SQL Server 2000 上安装它。自然，安装失败了。具体来说，它在我们的 CREATE TABLE 语句中出现语法错误而失败。

有没有总结一下这两个数据库的语言差异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T20:13:18.227

您可以在 technet上[查看重大更改列表。](http://technet.microsoft.com/en-us/library/ms143532(SQL.90).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T20:07:51.873

我不知道从 2000 年到 2005 年 Transact SQL 更改的摘要。有几[本书](https://rads.stackoverflow.com/amzn/click/com/0735623139)详细介绍了这些更改，但我不会称它们为摘要。

为了更直接地回答客户的问题，您可以尝试比较[2000](http://msdn.microsoft.com/en-us/library/aa258255(SQL.80).aspx)和[2005](http://msdn.microsoft.com/en-us/library/ms174979(SQL.90).aspx) 版本的 CREATE TABLE 函数的规范。

# linux - Apache + SSL 错误 336027900

> ID：683149
> 
> 赞同：4
> 
> 时间：2009-03-25T19:47:36.697
> 
> 标签：linux, apache, ssl

我今天正在查看我公司服务器的日志，发现似乎每 5 分钟记录一次错误 336027900。这是日志显示的内容：

```
[Wed Mar 25 15:10:19 2009] [info] [client 127.0.0.1] Connection to child 3 established (server localhost:443)
[Wed Mar 25 15:10:19 2009] [info] Seeding PRNG with 656 bytes of entropy
[Wed Mar 25 15:10:19 2009] [info] [client 127.0.0.1] SSL library error 1 in handshake (server localhost:443)
[Wed Mar 25 15:10:19 2009] [info] SSL Library Error: 336027900 error:140760FC:SSL routines:SSL23_GET_CLIENT_HELLO:unknown protocol speaking not SSL to HTTPS port!?
[Wed Mar 25 15:10:19 2009] [info] [client 127.0.0.1] Connection closed to child 3 with abortive shutdown (server localhost:443)
[Wed Mar 25 15:10:20 2009] [info] [client 127.0.0.1] Connection to child 12 established (server localhost:443)
[Wed Mar 25 15:10:20 2009] [info] Seeding PRNG with 656 bytes of entropy
[Wed Mar 25 15:10:20 2009] [info] [client 127.0.0.1] SSL library error 1 in handshake (server localhost:443)
[Wed Mar 25 15:10:20 2009] [info] SSL Library Error: 336027900 error:140760FC:SSL routines:SSL23_GET_CLIENT_HELLO:unknown protocol speaking not SSL to HTTPS port!?
[Wed Mar 25 15:10:20 2009] [info] [client 127.0.0.1] Connection closed to child 12 with abortive shutdown (server localhost:443) 
```

我们的主机都在一个单独的代理后面，该代理已正确设置以处理 SSL 请求。我验证了我们所有的虚拟主机文件都正确设置了端口。我在谷歌上搜索了这个错误信息，没有发现任何用处。任何帮助将不胜感激。

谢谢，

詹姆斯·阿姆斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T19:52:39.397

您是否有每隔 5 分钟连接到服务器的监控应用程序？

这个错误看起来很熟悉；我相信它发生在客户端连接但尝试使用 HTTP 而不是 HTTPS 时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T02:06:07.230

顺便说一句，如果你正在做一个反向代理，你应该考虑让反向代理做 SSL 而不是 Apache。客户端在 443 上使用 SSL 访问反向代理，反向代理解密整个内容并将其转发到您的 apache 服务器，后者对 SSL 一无所知。

squid 和 nginx 都支持它。这样你就不必在 apache 上使用 SSL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-02T21:05:37.070

这看起来像一个“内部虚拟连接”
，这里有更多信息：
[http ://wiki.apache.org/httpd/InternalDummyConnection](http://wiki.apache.org/httpd/InternalDummyConnection)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T10:34:59.323

我认为杰夫是对的...

有些软件在不使用 ssl 的情况下连接到您的服务器，也许代理正在发送一些包或一些控制消息，或者您有任何监控软件，每 5 分钟连接一次，但没有考虑 SSL 的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T21:56:01.130

我在尝试连接仅启用了 SSLv2 的浏览器时看到了此错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-29T08:54:51.167

每五分钟的事情听起来像是 Pingability.com（或类似网站）正在打击你。

# asp.net - 如何使我的站点全局化一个字段？

> ID：683150
> 
> 赞同：0
> 
> 时间：2009-03-25T19:47:48.113
> 
> 标签：asp.net, inheritance

好的，这有点抽象，但这里有：

我正在创建一个网站，我想要一个字段“foo”，我可以从网站上的任何页面访问它。我认为最好的方法是创建一个名为“bar”的 Page 子类，将受保护的字段“foo”添加到其中，然后让我的所有网页都从“bar”继承。达达。现在每个页面都有 foo。

但是现在我向我的页面添加了控件，并且我希望它们能够访问“foo”。

好吧，现在 foo 不能被保护，所以它是公开的。美好的。但是控件是如何知道“foo”的呢？我可以通过在我的控件中执行以下操作来访问 foo：

```
Foo foo = ((Bar)Page).foo; 
```

这行得通，但让我觉得有点难看。我真的很想能够使用 foo. 我想，嘿，也许我可以用我为页面所做的控件做同样的把戏。我创建了一个继承自 UserControl 的新类“blargh”，并以丑陋的方式抓住 foo。然后我让我的控件继承自 blargh。耶！

除非它不起作用。当我启动项目时，它抱怨试图访问 ((Bar)Page).foo 的行，因为 Page 为空。为什么？Page 怎么可能是空的？当我查看调用堆栈时，我没有得到任何帮助。

有没有一种简单易懂的方法来做到这一点？我在吠叫错误的树吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T19:51:48.650

如果您需要每个用户都有自己的实例，您可以将其存储在会话中。

```
 Session["foo"]=data; 
```

然后在您的其他页面上，您可以使用：

```
 Control ctl = (Control) Session["foo"]; 
```

请记住，您必须将 Session["foo"] 转换为您想要使用的任何类型。如果您只需要为网站的每个用户提供一个实例，也可以使用类似的 Application[] 空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T19:52:23.970

在决定哪些对象需要访问哪些不需要访问之前，另一种简单的开始方法是简单地创建一个公共静态类来保存这个和其他全局对象。就像是：

```
public static class Globals
{
    public static Foo foo = new Foo();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T19:53:24.857

您需要访问什么？如果是它的数据，为什么不把 foo 的值放在 Session 中呢？然后可以从任何地方访问它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T19:54:34.853

foo 是全局共享的相同值，还是每个页面都不同？

我看到您可能会喜欢的两种可能性：

1.  将其放入 ASP.Net 的 Application 对象中（我不记得它在 asp.net 中的确切位置，但使用该名称您可以在其上找到 doc）。这将是一个不变的全局值。

2.  使其成为 Control 上的扩展方法。Page 最终继承自 Control，因此它将可用。像这样：

    ```
    public static class ControlExtensions
    {
        public static Foo foo(this Control self)
        {
            return foo;
        }
    } 
    ```

现在 UserControls 和 Pages 应该可以访问它了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T20:28:25.007

一种选择是使用 [扩展方法扩展页面类](http://msdn.microsoft.com/en-us/library/bb383977.aspx)

然后，只要有 Page 的实例，Page 就会有 Foo 可用。根据 Foo 正在做什么，您可能仍需要将数据存储在会话中。

As for why Page is not available in your control. The Page property is only populated once the control has been added to the page. If your control does not sit directly on the page, then it is when it's anscetor that does sit on the page is added to the page.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T20:57:14.407

You have to determine if this [foo] is going to be the same for all users or if it is specific to a single user. If it is the same for all, a Static class with static variables will solve this for you.

```
public static class FooClass {
   public FooClass() {
   }
   public static string FooName = "TheFoo";
} 
```

If you are looking at something that is going to be specific per user, I would recommend using the Session to store this. You could put your FooClass into the session as well, its really up to you as to what you're putting there.

```
FooClass myFoo = Session["CurrentFoo"] as FooClass; 
```

# asp.net - 远程连接到 WebDev.WebServer.exe

> ID：683151
> 
> 赞同：14
> 
> 时间：2009-03-25T19:47:49.580
> 
> 标签：asp.net, visual-studio, internet-explorer, webdev.webserver

1.  开发一个 ASP.Net 网站。
2.  运行 IE8。
3.  需要在IE6下测试网站。
4.  IE8 安装破坏了 MultipleIE6 安装（无法输入文本框，是的，我删除了缓存，是的，我重新注册了 dll）。
5.  创建运行 IE6 的 VPC。
6.  无法连接到主机 WebDev.WebServer.exe。

有没有办法配置 WebDev.WebServer.exe 以便它接受远程连接？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-20T17:08:48.853

webdev.webserver 无法拒绝远程请求的解决方法是使用与 webdev.webserver 在同一主机上运行的轻量级代理服务器。然后，远程浏览器使用代理，它的请求在 webdev.webserver 上看起来就像来自 localhost 的请求一样。我已经成功使用了[Privoxy](http://www.privoxy.org)。

示例配置：

*   将 Privoxy 配置为侦听可从您的 VM 路由的 IP 地址（例如 192.168.1.1:8118）。您可以将 IP 地址放在主机操作系统的回送上，并将 NAT 与客户端操作系统一起使用。
*   将 VM 中的浏览器配置为使用 192.168.1.1:8118 作为**所有**连接的代理，包括 localhost。
*   在 webdev.webserver 中启动您的应用程序
*   使用您的 VM 浏览器访问与使用主机操作系统上的浏览器相同的 URL（例如`http://localhost:3254`）

从 webdev.webserver 的角度来看，请求将来自 127.0.0.1 上的 Privoxy，它会很乐意为它们提供服务。

**更新** 这些天，我为此使用 Fiddler2。Fiddler 在工具 > 选项 > 连接中有一个“允许远程计算机连接”选项。但还要注意，可以将 IISExpress 配置为接受远程连接。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T19:50:39.543

AFAIK，WebDev 被编码为专门拒绝所有外部连接......所以简短的回答是“不”。

最好的办法是简单地将网站发布到运行 IIS 的 VPC 并以这种方式进行测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-16T13:49:52.060

我遇到了同样的问题，经过一些研究，发现这个网站上详述的方法对我有用： [http ://www.funkymule.com/post/2009/04/17/Making-ASPNET-Development-Server-监听远程连接.aspx](http://www.funkymule.com/post/2009/04/17/Making-ASPNET-Development-Server-Listen-for-Remote-Connections.aspx)

它涉及修改和重新组装 Webdev 服务器和 DLL，但是一旦全部启动并运行，我就可以使用在 VPC/XP 模式下运行的旧版本 Internet Explorer 通过连接到主机上运行的 WebDev 服务器内部网络 IP (192.168.xx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T21:03:32.097

我使用 Microsoft 的 VPC 映像之一使用调试网络服务器测试 IE6，所以我不知道是什么导致了您的问题。听起来这可能是虚拟机的网络问题。

IEtester 也适用于快速检查渲染和功能。我还没有看到 IEtester 中的行为与 XP 下的真实 IE6 之间的行为有任何重大差异，但这种可能性存在，所以我仍然在发布到生产之前检查虚拟机。

[http://www.my-debugbar.com/wiki/IETester/HomePage](http://www.my-debugbar.com/wiki/IETester/HomePage)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T19:50:43.757

嗯，我不知道这可行，但尝试添加 WebDev.WebServer.exe 以从 Windows 防火墙中解除阻止。

如果这不起作用，您必须安装 IIS 并直接在您的开发文件夹上设置一个虚拟目录。

# asp.net-mvc - 对一个 MVC 视图使用两个强类型模型

> ID：683153
> 
> 赞同：5
> 
> 时间：2009-03-25T19:48:22.823
> 
> 标签：asp.net-mvc, duplicates

我错过了 MVC 原则的基本内容还是我要疯了？

如果我有一个显示书籍列表和作者列表的视图，我必须创建将书籍列表和作者列表作为属性的类。对？

然后我会强烈键入视图以使用此类。

现在我想创建一个包含相同列表但也有促销列表的新页面。我是否需要使用 Books 属性列表、authors 属性列表和 Promotions 属性列表创建另一个类？

如果我为所有视图创建类，我会创建大量额外的工作。我应该为每一个创建强类型的部分吗？如果每次布局都不一样怎么办？

目前我有一个所有视图都使用的 BaseViewData 类，因为它包含一些公共属性。但是，我现在正在努力在不完全膨胀 BaseViewData 类的情况下获取其他项目。

请有人可以帮助我理解所有简单示例都没有涵盖的理论。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T21:21:05.893

我使用来自[MvcContrib的](http://mvccontrib.codeplex.com/)[ViewData 扩展方法](http://mvccontrib.codeplex.com/SourceControl/changeset/view/1129ee553134#src%2fMVCContrib%2fViewDataExtensions.cs)，它添加了对多个强类型模型的支持（只要它们是不同的类型）。将它们添加到 ViewData 的代码如下所示：

```
User currentUser = GetCurrentUser();
List<Project> projectList = projectRepository.GetRecentProjects(currentUser);
ViewData.Add(user);
ViewData.Add(projectList); 
```

视图中将它们拉出的代码如下所示：

```
User user = ViewData.Get<User>();
List<Project> projectList = ViewData.Get<List<Project>>(); 
```

这将删除“魔术字符串”和类型转换。请注意，这对视图的 Model 属性没有任何作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T20:09:20.340

为系统中的任何对象创建一个容器类，并用于所有视图 - 简单

具有空值的对象没有实际开销

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T20:03:13.820

我遇到了同样的问题。我认为大多数人的通用解决方案是创建一个包含您真正想要的 Books 和 Authors 模型的容器类，并将该容器传递给您的 View。

次优，是的，但它有效。希望这将在框架的未来版本中得到解决。

# sql - 如何“重构”SQL 查询？

> ID：683168
> 
> 赞同：0
> 
> 时间：2009-03-25T19:52:18.680
> 
> 标签：sql, sql-server, tsql, database-design, refactoring

我有几个要转换为 SQL Server 2000 (T-SQL) 的 MS Access 查询（在视图和存储过程中）。由于 Access 对子查询的限制，或者原始开发人员的限制，已创建了许多视图，这些视图仅用作其他视图的子查询。

我没有明确的业务需求规范，除了“做 Access 应用程序所做的事情”，以及半页关于报告/CSV 提取的注释，但 Access 应用程序甚至没有做我怀疑正确需要的事情。

因此，我必须采用自下而上的方法，并将 Access DB“复制”到 T-SQL，我通常会更好地理解需求并采用自上而下的方法，创建新的查询以满足明确定义的需求。

有没有我可以遵循的方法？我是否将其全部展开并花几天时间“摸索”它，还是继续复制 Access 视图并采用进化方法来优化查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T20:00:06.587

我可能会从 Access 数据库开始，就地执行查询并查看结果集是什么。通常，您可以了解查询完成了什么，然后返回您自己的设计来完成它。（要彻底，无论如何你都需要完全理解意图。）这听起来像是你将得到的最好的需求陈述——“就像它现在已经实现一样。”

除此之外，你的方法是我能想到的最好的方法。一旦他们在 SQL Server 中，就开始测试和探索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T20:05:24.203

当您处理这样的问题时，在进行增量更改的同时保持工作正常通常很有帮助。从风险管理的角度来看，这更好。

我会专注于让它工作，然后检查数据库性能和优化性能问题。然后，当您添加功能和修复错误时，清理难以维护的代码。正如您所说，子查询与视图非常相似。因此，如果它没有损坏，您可能不需要更改它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T20:18:29.197

找出访问对查询的作用，然后使用这些知识检查您是否已正确传输它。只有完成了这些，你才能考虑重构。我会从慢查询开始，然后从那里开始：找出你需要的索引，然后逐步重写。这样一来，您就可以在证明您成功移动所有内容后立即交付（即使它可能会慢一点）。这比因为问题 X 出现而根本无法交付要好得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T03:49:43.417

这取决于您的时间线。如果您必须让项目尽快运行（我知道这对每个项目都是如此，但如果对您来说确实如此），那么是的，从 Access 复制功能和基础架构，然后在以后或作为你去。

如果你有一些时间可以专注于它，那么现在重构它会给你两件事：

1.  您会对代码更满意，并且它（可能）会表现得更好，因为已经完成了实际分析，而不是复制粘贴的转码等价物
2.  您可能会对真正的业务规则有更深入的了解，因为您几乎肯定会遇到规范中没有的东西（尤其是考虑到您如何描述它们）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T19:58:07.153

我建议立即将视图复制到 SQL Server，然后使用其复杂的工具来帮助您了解它们。

例如，SQL Server 可以告诉您哪些视图、存储过程等依赖于特定视图，因此您可以从那里查看该视图是否是其中之一，或者它是否实际用于多个地方。它将帮助您确定哪些视图比哪些视图更重要。

# .net - PictureBoxes 和 Zorder [.NET]

> ID：683171
> 
> 赞同：2
> 
> 时间：2009-03-25T19:53:07.570
> 
> 标签：.net, picturebox

我很难在彼此顶部显示多个（最多 5 个）图片框，但能够看到所有图片框。只有第一个和最后一个会出现。我从下到上展示它们，正确设置它们的位置并使用 BringToFront() 函数。有人有解决方案（如果有的话）吗？感谢帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T20:12:21.533

不确定实际问题是什么；以下代码将 5 个堆叠`PictureBox`的 es 添加到表单中，并将它们配置为全部可见。

```
private void AddStackedPictureBoxes()
{
    for (int i = 0; i < 5; i++)
    {
        PictureBox pb = new PictureBox();

        pb.BackColor = Color.FromArgb(i * 50, i * 50, i * 50);
        pb.BorderStyle = BorderStyle.FixedSingle;

        pb.Location = new Point(i * 10, i * 10);
        pb.Size = new Size((5 - i) * 20, (5 - i) * 20);

        Controls.Add(pb);

        pb.BringToFront();
    }
} 
```

也许这会让你对你遇到问题的原因有所了解。

例如，如果您`BringToFront()`在控件添加到窗体之前调用，它不会有任何效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T20:14:45.710

确保将每个背景颜色设置为透明。

正如丹尼尔所说，BringToFront() 仅在控件已经在表单上时才有效。

# javafx - 在 Windows Mobile 上运行 JavaFX

> ID：683173
> 
> 赞同：2
> 
> 时间：2009-03-25T19:53:15.370
> 
> 标签：javafx, windows-mobile

我有一台运行 Windows Mobile 操作系统的三星 Omnia i900。信不信由你，但我在 Internet 上找不到关于在其上运行 JavaFX 应用程序的信息。是否可以？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-31T14:57:53.017

JavaFX Mobile 现在可用于 Windows Mobile 设备的早期访问。您可以从[javafx.com](http://javafx.com/downloads/all.jsp)下载二进制文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T20:08:18.657

据我所知，JavaFX Mobile 尚未发布。一些预发布工具可以在 Windows Mobile 上运行（从一些博客文章来看），但从 1.0 版本中删除了该支持。

JavaFX 1.1 旨在支持 Windows Mobile，但它看起来是在开发方面而不是在真实设备上 - 事实上，作为 JavaFX 1.1 的关键特性之一的移动*仿真器*是很能说明问题的。

根据[常见问题解答](http://www.javafx.com/faq/#2.4)：

> 2.4 消费者如何在他们的手机上安装 JavaFX？
> 
> Sun 正在与移动设备制造商和移动运营商合作，通过在他们的设备上预加载 JavaFX Mobile 运行时来启用对 JavaFX 内容的开箱即用支持

对于现在能够在手机上使用它，这听起来并不令人鼓舞。我可能遗漏了一些东西，但我肯定找不到要下载的东西......

# sql - SQL 查询以查找列是否存在不同的值

> ID：683175
> 
> 赞同：2
> 
> 时间：2009-03-25T19:53:33.700
> 
> 标签：sql

我有一个包含三列 pay_id、id_client_grp、id_user 的临时表

基本上我想确保这个表应该有所有具有相同客户端组和相同 id_user 的行，如果不是我想知道哪个 pay_id 是罪魁祸首并向用户抛出错误。

有人可以帮我查询。

谢谢，

理士

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T20:05:06.373

当您说“罪魁祸首”时，我假设您的意思是与其他人不同的 pay_id(s)，假设有多数。

问题是，一旦您的 SELECT COUNT(DISTINCT id_client_grp, id_user) 返回 > 1 条记录，如果分布相对均匀，所有 pay_id 都可能成为罪魁祸首。很难针对这种情况进行编程，因为您需要确定到底什么是多数。

您最好的选择是返回这 3 个字段的所有不同组合，然后根据您的业务逻辑决定从那里去哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T20:26:05.793

那么这个问题可以这样问吗：

> 如果我想在我的表上添加一个跨三列的唯一索引：客户组、id 用户、支付 id，识别那些打破我们对客户组和 id 用户具有非唯一支付 id 的唯一条件的那些？

```
select a.id_client_grp, a.id_user, a.pay_id , a.count from ( 
/* this should return 1 row per client group and user, */ 
/* if the pay id is the same for all */
 select id_client_grp, id_user, pay_id, count(1) as count
from table t
group by id_client_grp, id_user ) a
group by a.id_client_grp, a.id_user
/* if we have more than one row per client group and user, then we have a dupe, so report them all */
having count (1)  > 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T20:00:33.873

如果您希望所有行对某些列具有相同的值（您的问题对我来说并不完全清楚，因为 t9o 您想要相同的内容）

你知道所有的行都应该在 WHICH pay_id, id_client_grp 中吗？或者你不在乎，只要它们都是一样的？
如果您知道要查找的值，只需测试未设置为所需值的行

```
Select distinct id_user
From tempTable
Where pay_id <> @PayIdValue 
  Or id_client_grp <> @ClientGroupIDValue 
```

如果您不在乎，只是希望它们都相同，而它们不是，那么您需要指定一组以上的值中的哪一个是您所说的“罪魁祸首”......

如果您想回答其他问题。请解释得更清楚...

那么根据你的评论，判断id_client_grp、pay_id是否不止一个

```
Select Count(Distinct id_client_grp, pay_id)
From tempTable 
```

如果 this = 1，那么每条记录对于这 2 个字段都具有相同的值....任何其他值都表示表中的三个值不只一组不同的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T20:35:39.340

```
 SELECT DISTINCT p.pay_id,
        t.[count]
FROM rishi_table p
INNER JOIN ( SELECT id_client_grp, id_user, COUNT(*) As 'count'
                FROM rishi_table
                GROUP BY id_client_grp, id_user
                HAVING COUNT(*) > 1 ) t
    ON p.id_client_grp = t.id_client_grp AND p.id_user = t.id_user 
```

基本上用骗子创建一个集合，然后将其反弹到主表以获得您的违规列表。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-25T19:58:01.507

选择不同的 id_client_grp，id_user

应该让你做类似的事情

如果@@ROWCOUNT > 1 那么

...

或者可能 SELECT COUNT(DISTINCT id_client_grp, id_user) ...

但这更多地取决于供应商的可用性和正确的语法。

# c++ - 这个外部无害吗？

> ID：683180
> 
> 赞同：5
> 
> 时间：2009-03-25T19:54:12.453
> 
> 标签：c++, c, extern

主文件

```
extern int array[100]; 
```

主程序

```
#include "main.h"

int array[100] = {0};

int main(void)
{
    /* do_stuff_with_array */ 
} 
```

在 main.c 模块中，定义并声明了数组。将 extern 语句也包含在模块中的行为是否会导致任何问题？

我一直将 extern 语句可视化为链接器的命令，以“在其他地方查找实际的命名实体。它不在这里。

我错过了什么？

谢谢。

邪恶的。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-25T19:58:52.800

正确的解释`extern`是你告诉**编译器**一些事情。您告诉编译器，尽管声明的变量现在不存在，但链接器会以某种方式找到声明的变量（通常在另一个对象（文件）中）。链接器将是找到所有内容并将其组合在一起的幸运者，无论您是否有一些外部声明。

为了避免在特定对象（文件）之外暴露名称（变量、函数、..），您必须使用`static`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-25T19:54:56.523

是的，它是无害的。事实上，我会说这是一种非常标准的方式来做你想做的事。

如您所知，这只是意味着任何包含 main.h 的 .c 文件也将能够查看`array`和访问它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-25T22:46:46.763

*编辑*

在 C 和 C++ 中，存在`extern`表示第一个声明不是定义。因此，它只是使名称在当前翻译单元（包括标题的任何人）中可用，并表明所引用的对象具有外部链接 - 即在构成程序的所有翻译单元中都可用。这并不是说该对象必然位于另一个翻译单元中——只是说“这条线不是定义”。

*结束编辑*

在 C 中，`extern`是可选的。没有它，第一个声明就是一个“暂定定义”。如果不是为了后面的定义（因为它有一个初始化器，这是一个明确的定义），这将被视为一个定义（C99 6.9.2）。事实上，它只是一个声明，并不冲突。

在 C++ 中，`extern`不是可选的 - 没有它，第一个声明是与第二个冲突的定义 (C++03 3.1)。

在 C++ 的附件 C 中明确指出了这种差异：

“更改：C++ 没有 C 中的“暂定定义”

例如，在文件范围内，

```
int i;
int i; 
```

在 C 中有效，在 C++ 中无效。”

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-25T20:46:46.617

外部是无害且正确的。如果没有 extern，您将无法在标头中声明它。

另外，通常最好的做法是创建一个宏或一个常量来保存数组的大小；在您的代码中，实际大小（100）在源代码库中出现两次。这样做会更干净：

```
#define ARRAY_SIZE 100

extern int array[ARRAY_SIZE];

...

int array[ARRAY_SIZE] = { 0 }; 
```

但也许你不想为了简洁起见将它包含在代码片段中，所以请不要冒犯:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T15:59:00.527

从编译或执行的角度来看，它没有区别。

但是，它具有*潜在*的危险，因为它使 #includes main.h 的任何其他文件都可以使用 array[]，这可能导致 array[] 的内容在另一个文件中被更改。

因此，如果 array[] 只在 main.c 中使用，请从 main.h 中删除该行，并在 main.c 中将 array[] 声明为静态。

如果 array[] 仅用于 main() 函数，则在其中声明它。

换句话说，array[] 应该将其范围限制在尽可能小的范围内。

# php - php中的常量类

> ID：683187
> 
> 赞同：3
> 
> 时间：2009-03-25T19:55:44.930
> 
> 标签：php, oop, namespaces, constants

我曾经听说最好有一个包含所有应用程序常量的类，这样您的所有常量就只有一个位置。

我试着这样做：

```
class constants{
    define("EH_MAILER",1);
} 
```

和

```
 class constants{
         const EH_MAILER =1;
 } 
```

但两种方式都行不通。有什么建议么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-25T20:01:32.717

在当前版本的 PHP 中，这样做的方法是：

```
class constants
{
   const EH_MAILER = 1;
}

$mailer = constants::EH_MAILER 
```

[http://www.php.net/manual/en/language.oop5.constants.php](http://www.php.net/manual/en/language.oop5.constants.php)

* * *

从 PHP 5.3 开始，有更好的方法来做到这一点。[命名空间。](http://es.php.net/manual/en/language.namespaces.rationale.php)

常量.php

```
<?php
namespace constants
const EH_MAILER = 1

... 
```

其他.php

```
<?php
include_once(consts.php)

$mailer = \constants\EH_MAILER 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T20:01:33.307

你用的是什么php版本？

有关类常量，请参见 php[页面](http://php.mirrors.ilisys.com.au/manual/en/language.oop5.constants.php)

# c# - 可以使用 XmlWriter 将 XML 写入内存吗？

> ID：683189
> 
> 赞同：21
> 
> 时间：2009-03-25T19:56:33.397
> 
> 标签：c#, asp.net, xml, xmlwriter

我正在创建一个返回 XML 的 ASHX，但是当我这样做时它需要一个路径

```
XmlWriter writer = XmlWriter.Create(returnXML, settings) 
```

但是returnXML 现在只是一个空字符串（我猜这行不通），但是我需要将 XML 写入可以作为响应文本发送的内容。我尝试了 XmlDocument，但它给了我一个期望字符串的错误。我在这里想念什么？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-03-25T20:00:18.723

如果您真的想写入内存，请像这样传入 a`StringWriter`或 a `StringBuilder`：

```
using System;
using System.Text;
using System.Xml;

public class Test
{
    static void Main()
    {
        XmlWriterSettings settings = new XmlWriterSettings();
        settings.Indent = true;        
        StringBuilder builder = new StringBuilder();

        using (XmlWriter writer = XmlWriter.Create(builder, settings))
        {
            writer.WriteStartDocument();
            writer.WriteStartElement("root");
            writer.WriteStartElement("element");
            writer.WriteString("content");
            writer.WriteEndElement();
            writer.WriteEndElement();
            writer.WriteEndDocument();
        }
        Console.WriteLine(builder);
    }
} 
```

但是，如果您想直接将其写入响应，则可以传入`HttpResponse.Output`which is a`TextWriter`代替：

```
using (XmlWriter writer = XmlWriter.Create(Response.Output, settings))
{
    // Write into it here
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-03-09T16:33:02.677

我这边缺少一些东西：刷新 XmlWriter 的缓冲区：

```
static void Main()
{
    XmlWriterSettings settings = new XmlWriterSettings();
    settings.Indent = true;        
    StringBuilder builder = new StringBuilder();

    using (XmlWriter writer = XmlWriter.Create(builder, settings))
    {
        writer.WriteStartDocument();
        writer.WriteStartElement("root");
        writer.WriteStartElement("element");
        writer.WriteString("content");
        writer.WriteEndElement();
        writer.WriteEndElement();
        writer.WriteEndDocument();

        writer.Flush();

    }
    Console.WriteLine(builder);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T20:01:27.693

```
 StringBuilder xml = new StringBuilder();
    TextWriter textWriter = new StringWriter(xml);
    XmlWriter xmlWriter = new XmlTextWriter(textWriter); 
```

然后，使用 xmlWriter 完成所有的 xml 写入，并将其直接写入 StringBuilder。

编辑：感谢 Jon Skeet 的评论：

```
 StringBuilder xml = new StringBuilder();
    XmlWriter xmlWriter = XmlWriter.Create(xml); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T20:00:51.173

最好的方法是直接写入响应输出流。它是 ASP.NET 内置的流，允许您将任何输出写入流，在这种情况下，您可以将 XML 写入它。

# ruby-on-rails - 向 ActiveRecord 序列化添加更多属性？

> ID：683191
> 
> 赞同：5
> 
> 时间：2009-03-25T19:56:40.090
> 
> 标签：ruby-on-rails, ruby, json, serialization, activerecord

我的 json 序列化工作正常

```
render :json => "#{current_object.serialize(:json, :attributes => [:id, :name])} 
```

但我还想在它被设置回客户端之前向 json 添加更多数据。主要是auth_token。

疯狂地用谷歌搜索，但我找不到序列化允许我将其他数据附加/合并到 JSON 中的选项。

希望能找到这样的东西...

```
current_object.serialize(:json, :attriubtes => [:id, name], :magic_option => {:form_authenticity_token => "#{form_authenticity_token}"}) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T20:36:06.393

您需要 :methods 键，它的作用类似于 :attributes，但会包含给定方法的结果。在你的情况下：

```
current_object.to_json(
  :attributes => [:id, :name],
  :methods => [:form_authenticity_token]
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-19T20:39:59.263

对于它的价值，在最近的 Rails 中，我将你想要的东西拼凑在一起：

```
sr = ActiveRecord::Serialization::Serializer.new(your_object, some_serialization_options).serializable_record
sr['extra'] = my_extra_calculation(some_parameters)
format.json { render :json => sr } 
```

其中 your_object 是您要序列化的内容， some_serialization_options 是您的标准 :include、:only 等参数，而 my_extra_calculation 是您想要设置值的任何操作。

吉米

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T20:08:55.583

破解它并继续前进......

```
current_object.serialize(:json, :attributes => [:id, :name]).gsub(/\}$/, ", \"form_authenticity_token\": \"#{form_authenticity_token}\"}") 
```

# objective-c - Objective-C 中的方法语法

> ID：683211
> 
> 赞同：177
> 
> 时间：2009-03-25T20:01:24.057
> 
> 标签：objective-c, syntax, methods

有人可以为我解释一下这个方法声明语法吗？在此函数中，将返回 UIPickerView（iPhone 上的老虎机 UI）的行数。据我了解，该方法称为“ `pickerView`”，并返回一个 NSInteger。

它传入了一个指向 UIPickerview 的指针，名为 ' `pickerView`' ... 首先，为什么方法调用与参数同名？

接下来是名为 component 的 NSInteger 参数，它告诉我们要为哪个组件计算行数。决定哪个在方法体中的逻辑。

什么是' `numberOfRowsInComponent`？它似乎描述了我们返回的值，但它在参数的中间。

```
- (NSInteger) pickerView:(UIPickerView *)pickerView 
 numberOfRowsInComponent:(NSInteger)component
{
    if (component == kStateComponent)
        return [self.states count];

    return[self.zips count];
} 
```

* * *

## 回答 #1

> 赞同：360
> 
> 时间：2009-03-25T20:22:07.347

Objective-C 方法被设计为自我记录，它们借鉴了 Smalltalk 的丰富传统。

我会试着解释你在这里有什么，`-(NSInteger) pickerView:(UIPickerView*)pickerView numberOfRowsInComponent:(NSInteger)component`。

*   `- (NSInteger)`
    第一部分表明这是一个返回 NSInteger 对象的 Objective C**实例方法。**（`-`破折号）表示这是一个**实例**方法，其中 a`+`表示这是一个**类**方法。括号中的第一个值是方法的返回类型。

*   `pickerView:`
    这部分是**消息名称**的一部分。在这种情况下，**完整的消息名称**`pickerView:numberOfRowsInComponent:`是。Objective-C 运行时获取此方法信息并将其发送到指定的接收器。在纯 C 中，这看起来像
    `NSInteger pickerView(UIPickerView* pickerView, NSInteger component)`. 但是，由于这是 Objective-C，附加信息被打包到消息名称中。

*   `(UIPickerView*)pickerView`
    这部分是**输入**的一部分。这里的输入是类型`UIPickerView*`，并且有一个局部变量名称为pickerView。

*   `numberOfRowsInComponent:`
    这部分是**消息名称**的第二部分。正如您在此处看到的，消息名称被拆分以帮助指示您传递给接收者的信息。因此，如果我要使用变量 foo 和 bar 向对象 myObject 发送消息，我会键入：
    `[myObject pickerView:foo numberOfRowsInComponent:bar];`
    而不是 C++ 样式：
    `myObject.pickerView(foo, bar);`。

*   `(NSInteger)component`
    这是**输入**的最后一部分。这里的输入是类型的`NSInteger`，并且具有组件的局部变量名称。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2009-03-25T20:09:28.593

在 Objective-C 中，方法的名称由声明中不是参数和类型的所有部分组成。因此，此方法的名称将是：

```
pickerView:numberOfRowsInComponent: 
```

该方法相当于一个 C 风格的函数，如下所示：

**编辑：（**感谢[Jarret Hardie](https://stackoverflow.com/users/72247/jarret-hardie)）：

```
NSInteger pickerViewNumberOfRowsInComponent(UIPickerView * pickerView, NSInteger component) 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-04-02T17:26:33.500

添加到前面的答案中，我只想说 Objective-C 方法（或消息，如果您愿意）具有**外部**和**内部**参数名称。

所以在这种情况下：

```
- (NSInteger) pickerView:(UIPickerView *)pickerView 
 numberOfRowsInComponent:(NSInteger)component 
```

`numberOfRowsInComponent`是**外部**名称，您在从外部调用此方法时将使用的名称。

并且`component`是参数的**内部**名称，用于从方法内部引用参数的名称。

希望这能澄清一点。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2010-11-11T19:42:13.100

在我看来，Objective-C 方法签名更像是句子。每个参数都应包含在方法名称中。例如，在 C 语言中，我们可以有一个方法（**setPersonData**）来设置有关人员的一些信息：

```
void setPersonData( char* name, int age, float height ) { 
```

在 Objective-C 中，该方法将更具描述性（**setPersonName:andAge:andHeight:**），例如

```
- (void) setPersonName: (char *)name andAge:(int)age andHeight:(float)height { 
```

# php - RedHat Enterprise Linux 5 上的 PHP 5

> ID：683215
> 
> 赞同：1
> 
> 时间：2009-03-25T20:02:16.427
> 
> 标签：php, redhat, rhel5

默认情况下，RHEL5.x64 附带 5.1.6 - 相当旧。我正在寻找更新的版本，5.2.8，甚至是最新的 5.2.9（截至 2009 年 3 月）。理想情况下，基于 Yum/RPM 的解决方案，用于透明升级（当我计划时）。

如何升级默认版本以获得最新版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T21:08:19.217

[Oracle 有一些最新的 PHP RPM](http://oss.oracle.com/projects/php/)，但不在我可以看到的存储库中。您可以尝试询问[Christopher Jones](http://blogs.oracle.com/opal/2009/03/php_529_rpms_for_rhel_are_avai.html)是否有兴趣为他们构建存储库元数据？

[CentOS 测试存储库](http://wiki.centos.org/AdditionalResources/Repositories)中也有版本，Remi Collet 在他的[存储库](http://blog.famillecollet.com/pages/Config-en)中有 PHP 5.2.9 （阅读他的[公告](http://blog.famillecollet.com/post/2009/03/01/php-5.2.9-1)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-29T16:25:59.567

您还可以在 redhat 企业版中安装用于 PHP 的 fedora RPM 包。RHEL5 rpm 包类似于 fedora core 6 包。像[这样](http://rpm.pbone.net/index.php3/stat/4/idpl/12277149/com/php-5.2.8-1.fc6.remi.i386.rpm.html)的东西。我在 RHEL 5 上安装了许多 Fedora Core 6 RPM 软件包，没有任何问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T23:05:53.647

我建议获取 Red Hat PHP rpm 的规范文件，然后使用它在您自己的本地存储库中创建您自己的 RPM，并使用它。通过这种方式，您可以获得最新 PHP 的好处，配置为尽可能与您的系统兼容，并且在将 YUM 用于需要 PHP 的其他事情时，他们会对您的安装感到满意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-04T16:40:36.123

我选择了使用 YUM 安装的 Zend-CE 解决方案（默认在 rhel5 上）。它并不完美，admin-dashboard 安全性还有一些不足之处，并且使其能够用于 php-cli 至少需要手动删除旧的 php-cli 包 + 指向新包的符号链接，但除此之外，它不是复杂。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-09T14:50:07.403

请看： [http ://bluhaloit.wordpress.com/2008/03/13/installing-php-52x-on-redhat-es5-centos-5-etc/](http://bluhaloit.wordpress.com/2008/03/13/installing-php-52x-on-redhat-es5-centos-5-etc/)

它会为 5.3 更新你的 php

[]'

# css - CSS sprites 如何加快网站速度？

> ID：683221
> 
> 赞同：13
> 
> 时间：2009-03-25T20:03:44.427
> 
> 标签：css, performance, http, css-sprites

我试图了解 CSS 精灵如何提高网站的性能？

如果单个图像的总大小是较小图像的总和，为什么下载几个小图像比下载包含较小图像的单个图像慢？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-25T20:43:18.857

重要的是要了解为什么 HTTP 请求的开销会产生如此大的影响。

在最简单的形式中，HTTP 请求包括打开一个套接字、在打开的套接字上发送请求并读取响应。

为了打开一个套接字，客户端的 TCP/IP 堆栈向服务器发送一个 TCP SYN 数据包。服务器以 SYN-ACK 响应，客户端以 ACK 响应。

因此，在您发送一个字节的应用程序数据之前，您必须至少等待整个一个半往返到服务器。

然后客户端需要发送请求，等待服务器解析请求，找到请求的数据，将其发回——这是另一个往返加上一些服务器端开销（希望是一个小开销，虽然我见过一些慢速服务器) 加上传输实际数据的时间，这是最好的情况，假设没有网络拥塞会导致数据包被丢弃和重新传输。

你必须避免这种情况的每一个机会，你都应该这样做。

现代浏览器将并行发出多个请求，以试图减少所涉及的一些开销。HTTP 请求理论上可以在同一个套接字上完成，使事情变得更好一些。但总的来说，网络往返对性能不利，应该避免。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-25T20:05:11.053

更少的往返服务器。不是针对 6 个不同图像的 6 个（比如说）请求，而是一个请求和 6 个对同一图像的使用。如果服务器大部分时间都将响应“自您上次询问以来它没有改变”，那么这可能会显着减少网络流量。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-25T20:05:24.767

因为多张图片需要多次http请求。请参阅 Yahoo 的性能规则 #1：[最小化 HTTP 请求](http://developer.yahoo.com/performance/rules.html#num_http)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-25T20:24:45.357

除了最小化请求的数量之外，根据图像，您还可能会发现文件大小组合起来比它们分开时的大小要小（我认为是由于元数据数量减少等原因） . 使用精灵的另一个额外好处是，当您第一次将鼠标悬停在具有悬停状态的元素上时，您没有闪烁效果，这可以提高用户对页面性能的感知。您可能想阅读的有关图像优化的有趣资源是 Yahoo 用户界面博客上的这一[系列](http://yuiblog.com/blog/2008/10/29/imageopt-1/)博客文章。在重新阅读雅虎推荐的性能实践时，我惊讶地发现他们还[建议](http://developer.yahoo.com/performance/rules.html#opt_sprites)水平而不是垂直排列图像也可以减小文件大小。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T22:00:02.587

除了上述原因，我发现它们更容易使用。如果您更新图像，您只有一个需要修改和上传的文件，以及一个需要更改代码的 URL。

# sql - 使用命名管道停止 Linq2SQL？

> ID：683228
> 
> 赞同：2
> 
> 时间：2009-03-25T20:05:38.103
> 
> 标签：sql, linq, linq-to-sql

我有一个不错的 Linq2SQL 小项目，但是当部署数据库时，它位于另一台服务器上。我不断收到远程服务器不存在的命名管道错误 - 但它确实存在，它启用了命名管道（协议 + 表面）SQL 2005。TCP 连接工作正常。

我已经尝试将连接字符串中的库设置为 TCP 库，我尝试在服务器名称中强制使用 TCP，但是 Linq 始终并且仅使用命名管道并且无法正常工作。

如果可能的话，知道如何强制 Linq2SQL 仅使用 TCP/IP 吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T20:21:08.767

我的猜测是您没有在为您创建类型化数据上下文的 DBML 设计器文件上将连接字符串设置为 None。将连接字符串设置为无（确保没有选择设计器上的任何内容），然后手动传递连接字符串，以确保您可以完全控制它。

如评论中所述，您不能将连接字符串设置为无。

在这种情况下，仍然存在`DataContext`将连接字符串作为参数的类型的重载。我建议先使用硬编码的，看看它是否有效。如果是这样，那么您就知道这是配置文件中项目的分辨率。否则，您知道查看连接字符串本身。

此外，如果配置文件中的分辨率有问题，我通常将其放在我的连接字符串部分**FIRST**中以清除 machine.config 文件中的条目：

```
<clear /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T18:35:30.997

如何在 SQLConfiguration 管理器中更改协议顺序或使用命令工具，客户端上的**cliconfig**并在那里更改它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T17:53:13.037

我已经看到这种情况发生在（其中任何一个）：

*   SQL 客户端版本不是您期望的版本
*   正在使用 Windows 身份验证，通常是无意的
*   您提供的连接信息与服务器自己的名称不匹配。（也就是说，select`@@server_name`不会返回与 NETBIOS 名称相同的名称。修复使用 sp_dropserver 和 sp_addserver）

有时在客户端计算机上重新安装 MDAC 会有所帮助，显然是因为驱动程序看起来就在那里，但没有完全工作。

希望这可以帮助...

# web-services - 决定 XML 或 HTML 响应的最佳方式？

> ID：683235
> 
> 赞同：0
> 
> 时间：2009-03-25T20:08:11.607
> 
> 标签：web-services, api, rest

我在一个 URL 上有一个资源，人类和机器都应该能够阅读：

[http://example.com/foo-collection/foo001](http://example.com/foo-collection/foo001)

区分人类浏览器和机器并返回 HTML 或特定于域的 XML 响应的最佳方法是什么？

(1) 请求中的Accept type字段？

(2) 额外的 URL？例如：

[http://example.com/foo-collection/foo001](http://example.com/foo-collection/foo001) -> 返回 HTML
[http://example.com/foo-collection/foo001?xml](http://example.com/foo-collection/foo001?xml) -> 返回，呃，XML

我不希望机器读取资源来解析 HTML（或 XHTML）。像 googlebot 这样的机器应该会收到 HTML 响应。

假设我控制机器阅读器是合理的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T20:14:54.353

如果这在您的控制之下，那么为什么不添加文件扩展名而不是添加查询参数：

```
http://example.com/foo-collection/foo001.html - return HTML
http://example.com/foo-collection/foo001.xml - return XML 
```

除此之外，这意味着如果有人使用 wget 获取它或从浏览器中保存它，它将有一个适当的文件名，而不会大惊小怪。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T20:16:18.950

我的偏好是使其成为 URI 的一流部分。这是值得商榷的，因为在某种意义上，同一个资源有多个 URI。“格式”真的是 URI 的一部分吗？

```
http://example.com/foo-collection/html/foo001
http://example.com/foo-collection/xml/foo001 
```

这些在具有 URI 解析以将请求定向到正确应用程序的 Web 框架中非常容易处理。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T20:20:45.697

如果这确实是具有两种不同表示的同一资源，则 HTTP 会邀请您按照您[的建议使用 Accept-header](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1)。这可能是区分两种不同场景的一种非常可靠的方法。您可以确定用户代理（包括搜索引擎蜘蛛）正确发送 Accept-header。

关于您要提供 XML 的机器代理；他们在你的控制之下吗？在这种情况下，您可以更加确信 Accept 会起作用。如果他们没有正确设置此标头，您可以将 XML 作为默认值。用户代理确实正确设置了标题。

我会尝试为此使用 Accept heder，因为这正是 Accept 标头的用途。

* * *

拥有两个不同 URL 的问题在于，这两个 URL 代表相同的底层资源并不自动明显。如果用户在一个呈现 HTML 的程序中找到一个 URL，然后将其粘贴到另一个需要 XML 的程序中，这可能会很糟糕。此时，聪明的用户可能会适当地更改 URL，但这只是您不需要的错误来源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T20:12:20.193

我会说添加一个查询字符串参数是你最好的选择。自动检测您的客户端是浏览器（人类）还是应用程序的唯一方法是从 HTTP 请求中读取用户代理字符串。但这很容易被任何应用程序设置为模仿浏览器，你不能保证这会起作用。

# tfs - 您如何使用 Team Foundation Build 为多个环境进行构建？

> ID：683243
> 
> 赞同：3
> 
> 时间：2009-03-25T20:10:04.100
> 
> 标签：tfs, build-process, environment

当您使用 Team Foundation Build 为多个环境构建项目时，您是为所有环境执行一个构建，还是为每个环境保留一个单独的构建脚本？

考虑一下我可能希望构建服务器上的工作区版本以 DEBUG 模式构建 QA 和 RELEASE 模式构建 UAT 的情况。一个构建请求应该同时执行这两个构建，还是应该在需要 QA 构建时为 QA 构建，而在需要 UAT 构建时为 UAT（使用标签）构建？

一个警告可能是我们可能希望构建自动复制到一个环境而不是另一个环境的服务器。也许我们希望将这些位发送给 QA 而不是 UAT，或者我们希望将这些位发送给 UAT 而不是 QA。

如果您需要进一步说明，请告诉我。
标记

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T20:56:22.427

您是否总是或几乎总是希望同时构建 QA 和 UAT 版本？如果是这样，在同一个项目中构建它们是有意义的。如果没有，我会把它们分开。

您可能还需要考虑其他一些事情（目标中可能特定于一个构建或另一个构建的附加任务），但如果您选择同时构建它们，那么在构建项目中进行设置非常容易。只需添加第二个 ConfigurationToBuild 部分。

```
<ConfigurationToBuild Include="Debug|Any CPU">
    <FlavorToBuild>Debug</FlavorToBuild>
    <PlatformToBuild>Any CPU</PlatformToBuild>
</ConfigurationToBuild>
<ConfigurationToBuild Include="Release|Any CPU">
    <FlavorToBuild>Release</FlavorToBuild>
    <PlatformToBuild>Any CPU</PlatformToBuild>
</ConfigurationToBuild> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T18:19:12.800

我为发布和培训构建做了这个，但只为 _PublishedWebsites 创建和填充了发布文件夹。解决方案和项目文件支持 5 种不同环境的 5 种不同构建。TFS 构建成功完成，仅填充了 Release 文件夹。

# sql - 如何使用选择子查询在主键中插入序号？

> ID：683254
> 
> 赞同：1
> 
> 时间：2009-03-25T20:13:29.160
> 
> 标签：sql, sql-server

我正在读取表 A 并在表 B 中插入日期（两个表的结构相同，但主键数据类型除外）。在表 B 中，主键是 int，而在表 A 中，它是 UniqueIdentifier。

INSERT INTO TableB (ID, Names, Address) (选择 ID, Names, Address from TableA)

现在我如何使用上述脚本在 TableB 中插入 int 类型增量值（1、2、3 等），而不是从 TableA 中插入 uniqueidentifier。

帮助？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T20:17:20.320

为什么不更改表 B 以便主键是自动递增的标识？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T20:20:46.367

转到表属性，选择 ID 字段，在“身份规范”下，设置“身份增量”= 1，“身份种子”= 1。通过这样做，ID 变为自动增量...

那么您的插入语句将类似于：

`INSERT INTO TableB (Names, Address) (select Names, Address from TableA)`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T20:28:41.637

如果更改 TableB 的架构不是一个选项，则为您的 select 语句添加一个排名，如下所示：

```
insert into tableB select rank() over(order by id), name, address from tableA 
```

这将始终从 1 开始。如果你想从 1 以外的数字开始编号，我可以添加 + 10。我相信你从那里得到了这个想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T20:25:28.087

```
CREATE TABLE TableB
(
  ID int PRIMARY KEY IDENTITY(1,1),
  Name nvarchar(200),
  Address nvarchar(200)
) 
```

然后，在查询中，不要指定标识列的值。

```
INSERT INTO TableB(Name, Address)
SELECT Name, Address FROM TableA 
```

# visual-studio-2005 - 合并模块项目帮助 - Visual Studio 2005

> ID：683255
> 
> 赞同：1
> 
> 时间：2009-03-25T20:13:47.833
> 
> 标签：visual-studio-2005, deployment-project

我目前正在对我公司的企业库进行更改，并且正在考虑创建一个部署项目，该项目将允许开发人员通过 MSI 安装程序或某种类型的设置可执行文件来设置库。

我正在研究使用合并模块项目来完成这项任务。一个基本的谷歌搜索没有产生任何有用的资源来使用合并模块产品。

有谁知道有关创建合并模块项目的有用资源/教程，或者他们对完成此任务有更好的建议吗？

**更新**

我能够使用对所有需要的程序集的适当引用来构建我的合并模块项目。它生成了一个 .MSM 文件。实际运行和测试它的下一步是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T09:45:20.410

*MSM本身*不能运行或测试。但是，您可以将其嵌入 MSI，然后简单地尝试使用标准工具安装 MSI（即手动右键单击 MSI 并选择**Install**或**Uninstall**，使用 Visual Studio 或执行相应的`msiexec.exe`命令） .

要将 MSM 嵌入 MSI，最简单的方法是在 Visual Studio 中创建一个安装项目，然后从您刚刚在解决方案中创建的合并模块项目中添加**合并模块。**这将自动引用 MSM 文件并将其包含在 MSI 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T21:19:32.013

当我使用 Visual Studio 2005 构建我唯一的合并模块时，我面临同样缺乏文档的问题。我对 MSI 设置项目有一些经验，我只是将我为 MSI 设置项目获得的信息应用到了 MSM。

在 Visual Studio 2005（或 2008）中，MSI 和 MSM 项目的处理方式非常相似。将文件添加到项目中（显式地或通过在同一解决方案中找到的另一个项目的引用），然后使用右键单击项目来：

1.  查看文件系统。
2.  查看注册表设置。
3.  查看文件类型关联。
4.  查看自定义操作。

自定义操作可以在 .NET 程序集中实现，例如，通过继承`Installer`类。这是一个示例，例如，在安装或卸载 MSM/MSI 时安装或卸载打印机：

```
using System.ComponentModel;
using System.Configuration.Install;
using System.Diagnostics;

namespace Epsitec.PostScriptPrinterInstaller
{
    [RunInstaller (true)]
    public partial class PrinterInstaller : Installer
    {
        public PrinterInstaller()
        {
            this.InitializeComponent ();
        }
        public override void Install(System.Collections.IDictionary stateSaver)
        {
            base.Install (stateSaver);
            string sysroot = System.Environment.GetEnvironmentVariable ("SystemRoot");
            string infpath = @"""" + System.IO.Path.Combine (sysroot, @"inf\ntprint.inf") + @"""";
            ProcessStartInfo info;
            Process process;

            info = new ProcessStartInfo ("rundll32.exe",
                       @"printui.dll,PrintUIEntry /if /b ""PostScript"" /m ""MS Publisher Color Printer"" /f "+infpath+@" /r ""FILE:""");

            process = Process.Start (info);
            process.WaitForExit ();
        }

        public override void Uninstall(System.Collections.IDictionary savedState)
        {
            base.Uninstall (savedState);
            ProcessStartInfo info;
            info = new ProcessStartInfo ("rundll32.exe",
                       @"printui.dll,PrintUIEntry /dl /n ""PostScript""");
            Process process = Process.Start (info);
            process.WaitForExit ();

            info = new ProcessStartInfo ("rundll32.exe",
                       @"printui.dll,PrintUIEntry /dd /m ""MS Publisher Color Printer""");
            process = Process.Start (info);
            process.WaitForExit ();
        }
    }
} 
```

我希望有了这些信息，您将能够取得一些进展。

# .net - XML 和 DataContractSerializer

> ID：683263
> 
> 赞同：1
> 
> 时间：2009-03-25T20:15:32.947
> 
> 标签：.net, xml, datacontractserializer

我有这样的课

```
[DataContract(Namespace = "")]
public class Foo
{
    [DataMember(Order = 0)]
    Bar bar;
}

[DataContract(Namespace = "")]
public class Bar
{
    Baz baz;

    [DataMember(Order = 0)]
    string TheBaz
    {
        get { baz.ToString(); }
        set { SomeOtherCode(value); }
    }
} 
```

我希望它像这样生成 XML

```
<Foo>
    <Bar>String from baz.ToString()</Bar>
</Foo> 
```

但我得到的东西更像：

```
<Foo>
    <Bar><TheBaz>String from baz.ToString()</TheBaz></Bar>
</Foo> 
```

有可能解决这个问题吗？[这篇文章](http://www.danrigsby.com/blog/index.php/2008/03/07/xmlserializer-vs-datacontractserializer-serialization-in-wcf/)说 DataContractSerializer 的缺点之一是：

> 1.  除了设置名称和顺序之外，无法控制对象的序列化方式

让我想知道这不是一个可以解决的问题。

* * *

我知道这可以用`IXmlSerializable`and `ReadXml`/来完成，`WriteXml`因为我应该删除这样做的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T08:03:54.007

我意识到我的第一个答案完全是假的——但你可以用属性作弊：

```
[DataContract(Namespace = "")]
public class Foo
{
    [DataMember(Order = 0, Name="Bar")]
    private string BazString {
        get {
            return bar == null ? null : bar.TheBaz.ToString();
        }
        set {
            if(value == null) {
                bar = null;
            }
            else {
                if(bar == null) bar = new Bar();
                bar.TheBaz = value;
            }
        }
    }

    Bar bar;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T20:19:21.847

[`IXmlSerializable`](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)在类上实现`Bar`，然后`<Bar>String from baz.ToString()</Bar>`在序列化时将其输出。

你可以让 Foo 类保持原样，剩下的就交给它[`DataContractSerializer`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer.aspx)了。

# c# - 给 C# 程序员编写 Python 的建议

> ID：683273
> 
> 赞同：74
> 
> 时间：2009-03-25T20:18:35.513
> 
> 标签：c#, python

过去几年我主要从事 C# 开发，但最近开始做一些 Python（不是 Iron Python）。但我不确定我是否已经对 Python 做出了精神上的飞跃……我觉得我正在尝试像在 C# 中那样做事情。

关于如何充分利用 Python 的任何建议？

或者任何提示\技巧，要了解更多的事情，要注意的事情？

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2009-03-25T21:52:29.687

首先，查看[tgray](https://stackoverflow.com/a/683357/541208)和[Lundström 的](https://stackoverflow.com/a/683362/541208)建议。

## 然后，您可能想知道一些事情：

*   Python 是动态类型的，因此与 C# 不同，您不会检查类型，而是检查行为。你可能想在谷歌上搜索鸭子打字。这意味着您不必处理装箱和拆箱。

*   Python 是完全面向对象的，但语法并没有强制执行这种范式。您可以在不使用“类”一词的情况下编写 Python。

*   Python 的 GUI 库无法与 C# 相比。检查[PyQt](http://en.wikipedia.org/wiki/PyQt)、 GTK 或[wxPython](http://en.wikipedia.org/wiki/WxPython)库。

*   Python 有很多你可能不熟悉的概念：列表推导式、生成器（“yield”在 C# 中确实存在，但用得不多）、装饰器、元类等。不要害怕；你可以在没有它们的情况下用 Python 编程。它们只是智能工具，不是强制性的。

*   与 C# 一样，Python 标准库非常庞大。当您遇到任何问题时，请始终查看它。很可能有人已经解决了它。

*   Python 使用 LATE 绑定和变量标签。对于开始使用该语言的人来说担心它还为时过早，但请记住，有一天您会遇到一种带有看起来不合逻辑的变量的行为，您必须检查一下。目前：

请记住永远不要执行以下操作：

```
def myfunc(my_list=[]) :
   # bla 
```

反而：

```
def myfunc(my_list=()) :
   my_list = list(my_list) 
```

你会很好的。这是有充分理由的，但这不是重点:-)

*   Python 是跨平台的，喜欢在 Mac 上编写，如果你愿意，可以在 Linux 上运行。

*   Python 没有提供复杂的 IDE（你得到了[IDLE](http://en.wikipedia.org/wiki/IDLE_(Python)) :-)）。如果您是 Visual Studio 上瘾者，请查看[Glade](http://en.wikipedia.org/wiki/Glade_Interface_Designer)。这不如 Visual Studio 先进，但它仍然是一个很好的[RAD](http://en.wikipedia.org/wiki/Rapid_application_development)。

*   如果您想用 Python 开发一些 Web 应用程序，请记住 Python 不是 .NET。如果要进行比较，则必须为其添加 Web 框架。我喜欢[姜戈](http://en.wikipedia.org/wiki/Django_(web_framework))。

*   Python 不需要庞大的 IDE 即可使用。[SciTE](http://en.wikipedia.org/wiki/SciTE)、 [Notepad++](http://en.wikipedia.org/wiki/Notepad%2B%2B)、[IDLE](http://en.wikipedia.org/wiki/IDLE_(Python))、[Kate](http://en.wikipedia.org/wiki/Kate_(text_editor))、[gedit](http://en.wikipedia.org/wiki/Gedit) ……轻量级的编辑器真的足够了。

*   Python 使用空格和换行符强制缩进，你不能改变它。您应该避免使用制表符进行缩进，而是选择空格。空手镯 {} 的等价物是关键字“pass”。

*   Python 不强制使用私有变量。您可以在变量名的开头使用“__”（两个下划线）定义一个私有变量，但它仍然可以通过一些棘手的方式绕过。Python 通常假设程序员是成年人，知道他们做什么和交流。

*   Python 使用迭代。很多。很多很多。所以 itertools 模块是你最好的朋友。

*   Python 没有内置的委托。委托模块不是你想的那样。对于事件驱动编程，使用 GUI 库（或自己编写模式，这并不难）。

*   Python 有一个解释器：你几乎可以实时测试任何东西。它应该始终在您的文本编辑器旁边运行。Python基本解释器不多，试试[IPython](http://en.wikipedia.org/wiki/IPython)吧 。

*   Python 是自动记录的：在您自己的代码中使用文档字符串，并在 python 解释器中使用“help()”咨询其他人

## 模块基础：

*   sys：操纵系统功能
*   os：设置凭证、操作文件路径、重命名、递归文件遍历等
*   shutil：批处理文件（如递归删除）
*   回复：正则表达式
*   urllib 和 urllib2：HTTP 脚本，如下载、发布/获取请求等。
*   datetime：操作日期、时间和持续时间
*   线程：你猜对了
*   zlib：压缩
*   泡菜：序列化
*   xml：使用 SAX 或 DOM 解析/编写 XML

有数百个模块。享受。

## 在 Python 中做事的一些典型方法：

### 循环：

Python 编码人员大量使用 C# 循环的等价物`foreach`，并且比其他任何人更喜欢它：

*基本迭代：*

```
for item in collection:
    print str(item) 
```

“集合”可以是字符串、列表、元组……任何可迭代对象：任何定义 .next() 方法的对象。Python中有很多可迭代对象。例如：读取文件的典型 Python 习惯用法：

```
for line in open("/path/to/file") :
    print line 
```

for 循环的快捷方式称为“列表理解”。这是一种在一行中创建新迭代的方法：

*使用列表理解创建过滤列表：*

```
my_list = [item for item in collection if condition] 
```

*使用列表推导创建一个新列表：*

```
my_list = [int(item) * 3 for item in collection] 
```

*创建一个具有列表理解的新生成器：*

```
my_list = (int(item) * 3 for item in collection) 
```

与上面相同，但值将在第一次迭代时即时生成，然后丢失。更多关于它的信息在[这里](https://stackoverflow.com/questions/231767/can-somebody-explain-me-the-python-yield-statement)。

*普通for循环*

如果你想表达一个通常的 for 循环，你可以使用 xrange() 函数。`for (int i = 0; i < 5; i++)`变成：

```
for i in xrange(0,5) : 
```

*等效时做*

Python 中没有“Do While”。我从来没有错过它，但是如果您必须使用此逻辑，请执行以下操作：

```
while True : # Yes, this is an infinite loop. Crazy, hu?

  # Do your stuff

  if condition :
      break 
```

### 开箱

*交换变量：*

```
a, b = b, a 
```

*多重赋值：*

以上只是我们所说的“解包”（这里应用于元组）的结果。一种简单的解释方法是，您可以将任何序列的每个值直接分配给相同数量的变量，在一行中：

```
animal1, animal2, animal3, animal4 = ["cow", "dog", "bird", "fish"] 
```

这有很多含义。在对多维数组进行迭代时，通常会一个一个地获取每个子序列然后使用它，例如：

```
agenda = [("steve", "jobs"), ("linus", "torvald"), ("bill", "gates"),("jon", "skeet")]
for person in agenda:
    print person[0], person[1] 
```

但是通过解包，您也可以将值直接分配给变量：

```
agenda = [("steve", "jobs"), ("linus", "torvald"), ("bill", "gates"),("jon", "skeet")]
for name, lastname in agenda:
    print name, lastname 
```

这就是为什么如果您想在迭代时获取索引，Python 编码人员使用以下习惯用法（enumerate() 是一个标准函数）：

```
for index, value in enumerate(sequence) :
    print index, value 
```

*在函数调用中解包*

这是高级用法，如果它打扰您，您可以跳过它。

您可以使用符号“*”解压缩值以直接在函数调用中使用序列。例如：

```
>>> foo(var1, var1, var3) :
    print var1, var2
    print var3
>>> seq = (3.14, 42, "yeah")
>>> foo(*seq)
3.14 42
yeah 
```

还有更多。您可以将字典解压缩为命名变量，并使用 , 编写函数原型`*`， `**`编写函数原型以接受任意数量的参数。但它还不足以让这篇文章变得更长:-)。

### 字符串格式：

```
print "This is a %s on %s about %s" % ("post", "stackoverflow", "python")
print "This is a %(subject)s on %(place)s about %(about)s" % {"subject" : "post", "place" : "stackoverflow", "about" : "python"} 
```

### 切片一个可迭代对象：

您可以使用非常简洁的语法获取可迭代的任何部分：

```
print "blebla"[2:4] # Print "eb"
last = string[:-1] # Getting last element
even = (0,1,2,3,4,5,6,7,8,9)[::2] # Getting evens only (third argument is a step)
reversed = string[::-1] # Reversing a string 
```

### 逻辑检查：

您可以检查您在 C# 中的操作方式，但也有“Pythonic”方式（更短、更清晰 :-)）：

```
if 1 in (1, 2, 3, 4) : # Check en element is in a sequence

if var : # check is var is true. Var == false if it's False, 0, (), [], {} or None

if not var : # Contrary of above

if thing is var: # Check if "thing" and "var" label the same content.

if thing is None : # We use that one because None means nothing in Python (almost null) 
```

### 组合（在一行上打印所有包含大写“o”的单词）：

```
sentence = "It's a good day to write some code"
print " ".join([word.upper() for word in sentence.split() if "o" in word]) 
```

输出：“适合某些代码”

### 请求宽恕比请求许可更容易

Python 编码人员通常不会检查是否有可能。他们有点像查克·诺里斯。他们这样做。然后捕获异常。通常，您不检查文件是否存在，而是尝试打开它，如果失败则回滚：

```
try :
    f = open(file)
except IOerror :
    print "no file here !" 
```

当然 Chuck Norris 从不使用异常，因为他从不失败。

### else 子句

“Else”是 Python 中许多用途的世界。你会在“if”之后找到“else”，但也在“except”和“for”之后。

```
for stuff in bunch :
    # Do things
else :
    # This always happens unless you hit "break" in the loop 
```

这也适用于“while”循环，即使我们不经常使用这个循环。

```
 try :
      # A crazy stuff
   except ToCrazyError :
      # This happens if the crazy stuff raises a ToCrazyError Exception
   else :
      # This will happen if there is no error so you can put only one line after the "try" clause
   finally :
      # The same as in C# 
```

* * *

如果你很好奇，这里有一堆高级的快速而肮脏（但很好）的[Python 片段](http://sebsauvage.net/python/snyppets/index.html)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-25T20:41:06.160

*   避免使用类。使用字典、集合、列表和元组。
*   禁止设置器和获取器。
*   除非你真的需要，否则不要有异常处理程序 - 让它以风格崩溃。
*   Pylint 可以成为您使用更多 Python 编码风格的朋友。
*   准备好后 - 查看列表推导、生成器和 lambda 函数。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-25T20:38:09.680

如果你不是编程新手，我会推荐 Mark Pilgrim 的书[“Dive into Python”](http://www.diveintopython.net)。它以一种易于理解如何应用 Python 技术和习语来构建实际应用程序的方式解释了 Python。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-25T20:38:41.783

**从阅读[Python 之禅开始](http://www.python.org/dev/peps/pep-0020/)**

您可以在上面的链接中阅读它，或者`import this`在 Python 提示符下键入。=)

**利用 C# 未提供的 Python 功能***

例如鸭子类型、元类、列表理解等*

编写简单的程序来测试这些特性。你很快就会习惯（如果不上瘾的话）。

**查看[Python 标准库](http://docs.python.org/library/)**

所以你不要重新发明轮子。不要试图通读全文，即使快速浏览一下 TOC 也可以为您节省大量时间。

* * *

* 我知道 C# 已经具备其中的一些特性，但据我所知，它们要么是相当新的，要么是 C# 开发人员不常用的。如果我错了，请纠正我。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-25T20:39:29.363

如果您还没有听说过，[Dive Into Python](http://www.diveintopython.net/toc/index.html)是任何学习 Python 的人开始的好地方。它也有一堆[提示和技巧](http://www.diveintopython.net/appendix/tips.html)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-25T20:23:26.063

如果你是一个通过小步骤来更好地学习一门新语言的人，那么我建议你使用[IronPython](http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython)。否则，请使用常规的[CPython](http://python.org)，并且在您觉得自己掌握了 Python 之前不要再进行 C# 编码。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-25T20:26:47.163

我建议你找一个好的编辑器，这样你就不会被空白所困扰。为简单起见，我只使用 ActivePython 的包[Link](http://www.activestate.com/activepython/)，其中包括一个编辑器和所有 win32api 库。如果您一直在使用 C#，那么进入它们非常有趣。Python 中的 win32api 可以简单一点。你不需要做整个 DDLImport 的事情。下载 ActivePython（CPython 附带），打开它，然后开始在控制台输入一些内容。使用 C# 后，您会很容易掌握它。对于一些更有趣的 Python 花絮，试试[ActiveState code](http://code.activestate.com/)，它有各种各样的食谱，可以让你非常简单地看到你可以用 Python 做的不同事情。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-26T18:53:46.070

我也很喜欢你，在我的大部分工作中仍然使用 C#，但在其他项目中越来越多地使用 Python。

@e-satis 可能对 Python 了如指掌，他的所有建议都是一流的。从我的角度来看，对我来说最大的不同是以下几点：

恢复功能。不一定是意大利面条代码，但要知道并非所有内容都必须在对象中，也不应该在对象中。

口译员。它就像即时窗口，除了 10^10 更好。由于 Python 的工作方式，你不需要所有的包袱和废话 C# 让你在运行之前放入；你可以敲几行代码，看看事情是如何运作的。

我通常有一个 IDLE 实例，我只是抛出片段，因为我正在研究语言中的各个位是如何在我编辑文件时工作的……例如，忙于研究如何在地图上调用一个列表，但我不是 100% 使用我应该使用的 lambda... 在 IDLE 中输入几行代码，看看它是如何工作的以及它做了什么。

最后，喜欢 Python 的冗长，我并不是说冗长的冗长含义，而是正如 e-satis 指出的那样，使用诸如“in”、“is”、“for”等动词。

如果你在 C# 中做了很多反射工作，当你看到同样的东西在 Python 中是多么简单时，你会想哭。

祝你好运。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-25T21:02:04.630

如果你有编程经验并且不想花钱，我会推荐[How to Think Like a Computer Scientist in Python](http://www.openbookproject.net/thinkcs/python/english3e/)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-26T14:31:35.887

然后您可以从中受益：

[IPython](http://en.wikipedia.org/wiki/IPython) shell：在 shell 中自动完成。它执行批处理操作，添加大量功能，日志记录等。>>> 玩壳 - 永远！

easy_install / [pip](http://pypi.python.org/pypi/pip)：安装 3rd 方 Python 应用程序的好方法。

# html - 如何将网页定位在屏幕中间？

> ID：683275
> 
> 赞同：9
> 
> 时间：2009-03-25T20:18:53.953
> 
> 标签：html, css

如何将网页定位在屏幕中间？喜欢stackoverflow网站上的页面吗？我正在编写我的网站的母版页，我想使用 HTML 和 css 将母版页定位在屏幕中间，然后使用 css 构建内部定位块。但我无法让我的页面在中间可视化！

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-25T20:22:09.140

您可以使用边距将其水平放置在中心。

鉴于此html：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head></head>
  <body>
    <div id="page"> ... content ... </div>
  </body>
</html> 
```

CSS 可以很简单：

```
#page {
  margin-left:auto;
  margin-right:auto;
  width:960px;
} 
```

你还需要确保你有一个有效的文档类型才能工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T20:22:22.820

`<div>`像这样创建一个`<body>`：

```
<body>
<div id="main">

<!-- ... -->

</div>
</body> 
```

并添加以下 CSS：

```
body {
    text-align: center; /* IE */
}

#main {
    margin-left: auto;
    margin-right: auto;
    text-align: left;   /* IE */
    width: XXX;         /* Fill this out. */
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T20:21:33.027

将所有内容放在一个容器中并给它一个边距：0 auto

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T20:22:19.903

```
<div style="width: 800px; margin: 0px auto;">
  your content here
</div> 
```

如果您想要水平*和*垂直对齐，请检查此页面：http: [//www.wpdfd.com/editorial/thebox/deadcentre2.html](http://www.wpdfd.com/editorial/thebox/deadcentre2.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T20:22:24.897

将其全部包装在一个带有 margin: auto 的 div 中，并使正文具有 text-align: center。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-15T06:31:53.783

让HTML代码如下：

```
<body>
  <div class="box">.....</div>
</body> 
```

以下是 CSS 代码：

```
.box{
    width: 200px;
    margin: 10px auto;
} 
```

上面的 CSS 代码会将 div 的宽度设置为 200 像素，并将设置从底部到最大 10 像素，从左到右的边距`auto`意味着它会自动将其位置调整到中心。`auto`保证左右边距将设置为相同大小。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-22T19:27:47.600

很简单：**display: inline-block** ;

```
<div style="text-align: center; display: inline-block; width: specifyYourWidthHere">
    <div>
          //Your TextBox here
    </div>
</div> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-25T20:20:45.790

你可以试试：

```
<center> 
```

* * *

这是满足最少 30 个字符的更多文本。

# python - 可以使 pysvn 1.6.3 在 linux 下与 Subversion 1.6 一起使用吗？

> ID：683278
> 
> 赞同：0
> 
> 时间：2009-03-25T20:19:33.263
> 
> 标签：python, linux, svn, pysvn

我在他们的网站上没有看到任何参考。我得到 pysvn 来配置和构建，但是它没有通过所有的测试。有没有人有运气让它在linux下工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T00:15:24.217

不，它不能。

最好的选择是使用 Subversion 1.5.5。有关更多详细信息，请参阅[网站](http://pysvn.tigris.org/project_status.html)。

# mysql - 如何告诉 selenium 使用测试数据库？

> ID：683279
> 
> 赞同：4
> 
> 时间：2009-03-25T20:19:44.683
> 
> 标签：mysql, ruby-on-rails, database, testing, selenium

我正在使用 selenium-client 运行一些测试，但 Selenium 似乎正在使用我的开发数据库。如何指向它使用我的测试数据库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T20:33:25.697

您需要将 Selenium 指向使用测试数据库的站点。Selenium 与您的 Rails 对话，而不是与数据库对话。因此，您需要将 Selenium 指向一个 Web 应用程序，其配置指向您的测试数据库，而不是开发数据库。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T20:36:10.620

您需要将 Selenium 测试指向使用测试数据库的应用程序实例。

我在 capistrano deploy.rb 中编写了一个单独的部署任务，将应用程序部署到测试服务器，将其指向测试数据库，并加载特定于 selenium 的装置。Selenium 将已部署的应用程序视为一个黑匣子，因此您可以自行决定将所有内容融入您现有的部署设置中。

# eclipse - Netbeans 6.5 中的源代码编辑器 Tab 顺序

> ID：683301
> 
> 赞同：2
> 
> 时间：2009-03-25T20:25:32.923
> 
> 标签：eclipse, netbeans, tabs

我最近从 Eclipse 切换到 Netbeans，我喜欢 Eclipse 的一件事是我想在 Netbeans 中获得：

Eclipse 源代码编辑器顶部的选项卡顺序似乎与最近使用的有关，因此如果我有一组 5 个文件，我一次正在处理，它们都可能在标签列表，无论我打开了多少标签。

在 Netbeans 中，情况并非如此 - 我不知道顺序是什么，但它对于在我的活动文件之间快速切换没有用 - 通常重新打开文件以切换到正确的选项卡比实际使用标签系统。

是否有选项设置或插件可以将此行为更改为更像 Eclipse 的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T06:58:44.890

默认情况下，NetBeans 中的选项卡按照打开时间排序。我认为没有办法在 NetBeans 中正确更改它，也不知道任何插件。我认为这种行为只是个人喜好问题——我已经习惯了 NetBeans 的行为，当我使用 Eclipse 时，我总是对打乱的选项卡感到困惑。但正如凯文所说，您可以拖动标签来更改它们的顺序。

当您按下**CTRL + TAB**时，弹出窗口中的文档将根据上次使用的顺序排列。这可能对你有用。

另一个（部分）解决方案可能是停靠一个*文档窗口*（Window -> Documents），其中包含打开的文档并且文档按字母顺序排列。这比重新打开文件（如您所写）要好，特别是如果您的文件分布在不同的包中并且您无法在一个屏幕上的项目/文件视图中看到它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T20:30:01.523

我认为不会。但是，您可以将选项卡拖到您想要的位置。我建议您按照自己的喜好手动订购。

# php - 在 Zend Framework 页面中嵌入登录表单的最佳方式

> ID：683309
> 
> 赞同：1
> 
> 时间：2009-03-25T20:27:34.510
> 
> 标签：php, zend-framework, composition

在 Zend Framework 中将登录表单嵌入到多个页面中的最佳方法是什么？

目前我有两个控制器，用于单独登录表单的 LoginController 和用于索引页面上的操作的 IndexController。

我需要将登录表单包含在索引页面中，以让用户从首页和登录页面登录。

我目前的解决方案是让 IndexController 扩展 LoginController，但我必须对两个控制器的代码进行一些调整（例如，从子 indexAction 内部调用 parent::IndexAction 以呈现登录表单，并且也应该更新各种重定向）。

可以用这样的控制器实现“多页”登录吗？

最佳做法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T07:45:17.017

动作助手可以帮助你[http://devzone.zend.com/article/3350-Action-Helpers-in-Zend-Framework](http://devzone.zend.com/article/3350-Action-Helpers-in-Zend-Framework)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T01:27:53.617

在您的索引页面上创建自己的表单可能更容易（小心命名您在登录页面上的输入）并将操作设置为您的登录脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T21:20:41.377

我还建议您将大部分代码移动到用户模型而不是控制器中。我认为“瘦控制器，胖模型”模式比扩展控制器更具消耗性和可维护性。我还为我的应用程序使用扩展通用登录控制器，但通用控制器只有一个函数，它获取输入并将它们发送到模型并将错误重定向或发送到视图。

# c# - 在 C# 中获取两个数组之间的“差异”？

> ID：683310
> 
> 赞同：67
> 
> 时间：2009-03-25T20:28:19.810
> 
> 标签：c#, arrays

假设我有这两个数组：

```
var array1 = new[] {"A", "B", "C"};
var array2 = new[] {"A", "C", "D"}; 
```

我想了解两者之间的差异。我知道我可以只用几行代码来编写它，但我想确保我没有遗漏内置语言功能或 LINQ 扩展方法。

理想情况下，我最终会得到以下三个结果：

*   项目不在 array1 中，但在 array2 ("D")
*   项目不在 array2 中，但在 array1 ("B")
*   两者中的项目

提前致谢！

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-03-25T20:30:53.423

如果您有可用的 LINQ，则可以使用[`Except`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.except.aspx)和[`Distinct`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.distinct.aspx). 您在问题中要求的集合分别是：

```
- array2.Except(array1)
- array1.Except(array2)
- array1.Intersect(array2) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-25T20:32:11.003

来自[MSDN 101 LINQ 示例](http://msdn.microsoft.com/en-us/vcsharp/aa336761.aspx#except1)....

```
public void Linq52() {
    int[] numbersA = { 0, 2, 4, 5, 6, 8, 9 };
    int[] numbersB = { 1, 3, 5, 7, 8 };

    IEnumerable<int> aOnlyNumbers = numbersA.Except(numbersB);

    Console.WriteLine("Numbers in first array but not second array:");
    foreach (var n in aOnlyNumbers) {
        Console.WriteLine(n);
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T23:42:49.673

我不得不用非常大的数据集做类似的事情。如果您要处理几千左右，请使用 Linq 的东西，因为它更清晰。但是，如果您知道您的数组是预先排序的，那么运行这样的合并可以显着加快速度，因为它只需要一次通过数据，并且不需要分配与 Linq 版本一样多的内存。

```
int iA = 0;
int iB = 0;
List<int> inA = new List<int>();
List<int> inB = new List<int>();
List<int> inBoth = new List<int>();
while (iA < numbersA.Length && iB < numbersB.Length)
{
    if (numbersA[iA] < numbersB[iB])
    {
        inA.Add(numbersA[iA++]);
    }
    else if (numbersA[iA] == numbersB[iB])
    {
        inBoth.Add(numbersA[iA++]);
        ++iB;
    }
    else
    {
        inB.Add(numbersB[iB++]);
    }
}
while (iA < numbersA.Length)
{
    inA.Add(numbersA[iA++]);
}
while (iB < numbersB.Length)
{
    inB.Add(numbersB[iB++]);
} 
```

同样，只有在处理数十万个值时才需要这样做。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-10-25T22:03:07.187

以下是 LINQ 扩展方法的基准。结果是在实际程序的开发过程中获得的。

测试： 2 个列表（lst1 和 lst2），每个列表大约 250000 个对象。每个对象（Key 类）都包含一个字符串和一个整数。第二个列表主要包含与第一个相同的条目，但添加了一些新条目并删除了一些新条目。

我测试了例外扩展方法。

var except = lst2.Except(lst1);

列表 lst = except.ToList();

这 2 行产生了 600 项“新增”项目列表。我使用 StopWatch 对象对其进行计时。速度惊人：**220 毫秒**。我使用的计算机绝不是“快速冈萨雷斯”。酷睿 2 双核 T7700 – 2.4GHz。

笔记：

这是实现 IEquatable i-face 的类 Key。

```
public class Key : IEquatable<Key>
{
    public int Index { get; private set; }
    public string Name { get; private set; }

    public Key(string keyName, int sdIndex)
    {
        this.Name = keyName;
        this.Index = sdIndex;
    }

 // IEquatable implementation
    public bool Equals(Key other)
    {
        //Check whether the compared object is null.
        if (Object.ReferenceEquals(other, null)) return false;
        //Check whether the compared object references the same data.
        if (Object.ReferenceEquals(this, other)) return true;
        //Check whether the products' properties are equal.
        return Index.Equals(other.Index) && Name.Equals(other.Name);
    }

    // If Equals() returns true for a pair of objects 
    // then GetHashCode() must return the same value for these objects.
    public override int GetHashCode()
    {
        //Get hash code for the name field if it is not null.
        int hashKeyName = Name == null ? 0 : Name.GetHashCode();
        //Get hash code for the index field.
        int hashKeyIndex = Index.GetHashCode();
        //Calculate the hash code for the Key.
        return hashKeyName ^ hashKeyIndex;
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-07-10T19:11:02.873

另一个解决方案也如下所示

```
int[] arr1 = new int[] { 45, 26, 99, 55, 36 };
int[] arr2 = new int[] { 45, 26, 99, 20, 36 };

var res = arr1.Union(arr2).Except(arr1.Intersect(arr2)); 
```

# asp.net - ASP.Net动态设置TreeView的宽度

> ID：683313
> 
> 赞同：0
> 
> 时间：2009-03-25T20:29:28.793
> 
> 标签：asp.net, treeview, width

我有一个树视图，它的深度可以从 1 级到接近 6 级不等。每个节点可以只是几个字母或几个单词，总共最多 20-30 个字符。

如何找到节点文本之一的最大宽度并添加其深度偏移以设置树视图的宽度，使其不会穿过我的边界？

如果我需要添加更多信息，请告诉我。

* * *

编辑：

这是我目前所拥有的。我需要在页面加载时设置 panelLocations 的宽度，以便树视图可以在其中正确加载。

```
<asp:Panel ID="panelLocations" runat="server" style="position:absolute;border:solid 1px #E0E0E0;padding:10px 5px 5px 10px;background-color:#F7F7F7;width:350px;display:none;" >
    Search: <asp:TextBox ID="textboxLocationSearch" runat="server" AutoCompleteType="disabled" ToolTip="To find a store, type the 4 digit store number (e.g. 0001)" />

    <asp:Button ID="buttonFindLocation" runat="server" Text="Find" OnClick="buttonFindLocation_Click" OnClientClick="LocationSelected();" style="width:60px;"/>

    <input type="button" value="Cancel" onclick="HideLocations();" style="width:60px;"/>

    <hr />

    <asp:TreeView ID="TreeViewLocations" runat="server" OnSelectedNodeChanged="TreeViewLocations_SelectedNodeChanged" NodeIndent="10"></asp:TreeView>
</asp:Panel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-01T15:07:29.037

由于网络浏览器会以不同的方式呈现内容，因此找出内容**真实**宽度的唯一选择是使用 javascript 遍历 DOM 元素并测量宽度。

最干净和最简单的解决方案是为容器元素指定一个适当大的宽度，然后指定一个值`overflow:scroll`以允许滚动超宽内容。在页面中的元素周围看到滚动条非常难看，但是当您使用树视图结构时，您会遇到难看的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-28T14:08:15.417

您可以利用 Graphics 命名空间中的 MeasureText 方法。基本上，它会返回应该以某种字体和大小呈现的字符串的大小。给定每个意图级别的恒定宽度（您知道，树线，按钮/图标：您可以静态测量它），您可以假设所需的宽度将是最大的：

```
measuredText + (level * indentationWidth) 
```

！

# c# - 如何使窗口始终保持在.Net 的顶部？

> ID：683330
> 
> 赞同：107
> 
> 时间：2009-03-25T20:33:05.713
> 
> 标签：c#, .net, winforms

我有一个在另一个程序中运行宏的 C# winforms 应用程序。另一个程序会不断地弹出窗口，并且通常会让事情看起来很疯狂，因为没有更好的词。我想实现一个取消按钮来停止进程运行，但我似乎无法让窗口保持在顶部。我如何在 C# 中做到这一点？

编辑：我试过`TopMost = true;`了，但另一个程序不断在顶部弹出自己的窗口。有没有办法每 n 毫秒将我的窗口发送到顶部？

编辑：我解决这个问题的方法是添加一个系统托盘图标，通过双击它来取消该过程。系统托盘图标不会被掩盖。感谢所有回复的人。我阅读了关于为什么没有“超级顶部”窗口的文章......它在逻辑上不起作用。

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2009-03-25T20:38:05.780

`Form.TopMost`除非其他程序正在创建最顶层的窗口，否则它将起作用。

无法创建未被另一个进程的新顶层窗口覆盖的窗口。Raymond Chen[解释](https://devblogs.microsoft.com/oldnewthing/20050607-00/?p=35413)了原因。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2016-01-10T08:51:32.507

我正在寻找使我的 WinForms 应用程序“始终位于顶部”，但设置“TopMost”对我没有任何作用。我知道这是可能的，因为 WinAmp 可以做到这一点（以及许多其他应用程序）。

我所做的是调用“user32.dll”。我对此毫不犹豫，而且效果很好。无论如何，这是一个选择。

首先，导入以下命名空间：

```
using System.Runtime.InteropServices; 
```

在类声明中添加一些变量：

```
private static readonly IntPtr HWND_TOPMOST = new IntPtr(-1);
private const UInt32 SWP_NOSIZE = 0x0001;
private const UInt32 SWP_NOMOVE = 0x0002;
private const UInt32 TOPMOST_FLAGS = SWP_NOMOVE | SWP_NOSIZE; 
```

为 user32.dll 函数添加原型：

```
[DllImport("user32.dll")] 
[return: MarshalAs(UnmanagedType.Bool)]
public static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int X, int Y, int cx, int cy, uint uFlags); 
```

然后在您的代码中（我在 Form_Load() 中添加了调用），添加调用：

```
SetWindowPos(this.Handle, HWND_TOPMOST, 0, 0, 0, 0, TOPMOST_FLAGS); 
```

希望有帮助。[参考](http://www.c-sharpcorner.com/uploadfile/kirtan007/make-form-stay-always-on-top-of-every-window/)

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-08-21T21:10:01.997

如果“发疯”是指每个窗口不断从另一个窗口窃取焦点，TopMost 将无法解决问题。

相反，请尝试：

```
CalledForm.Owner = CallerForm;
CalledForm.Show(); 
```

这将显示“孩子”形式而不会窃取焦点。即使父窗体被激活或聚焦，子窗体也将保持在其父窗体之上。仅当您从所有者表单中创建了子表单的实例时，此代码才能轻松运行。否则，您可能必须使用 API 设置所有者。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-03-25T20:36:52.303

设置[Form.TopMost](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.topmost.aspx)

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2015-07-15T15:31:19.980

我有一个短暂的 5 分钟流逝，我忘了完整地指定表格，如下所示：

```
 myformName.ActiveForm.TopMost = true; 
```

但我真正想要的是这个！

```
 this.TopMost = true; 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-03-25T20:36:58.667

将表单的`.TopMost`属性设置为 true。

您可能不想一直这样：在您的外部进程启动时设置它，并在它完成时将其放回原处。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-03-25T22:44:55.630

我解决这个问题的方法是制作一个带有取消选项的系统托盘图标。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-04-18T18:20:09.020

以下代码使窗口始终保持在顶部并使其无框。

```
using System;
using System.Drawing;
using System.Runtime.InteropServices;
using System.Windows.Forms;

namespace StayOnTop
{
    public partial class Form1 : Form
    {
        private static readonly IntPtr HWND_TOPMOST = new IntPtr(-1);
        private const UInt32 SWP_NOSIZE = 0x0001;
        private const UInt32 SWP_NOMOVE = 0x0002;
        private const UInt32 TOPMOST_FLAGS = SWP_NOMOVE | SWP_NOSIZE;

        [DllImport("user32.dll")]
        [return: MarshalAs(UnmanagedType.Bool)]
        public static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int X, int Y, int cx, int cy, uint uFlags);

        public Form1()
        {
            InitializeComponent();
            FormBorderStyle = FormBorderStyle.None;
            TopMost = true;
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            SetWindowPos(this.Handle, HWND_TOPMOST, 100, 100, 300, 300, TOPMOST_FLAGS);
        }

        protected override void WndProc(ref Message m)
        {
            const int RESIZE_HANDLE_SIZE = 10;

            switch (m.Msg)
            {
                case 0x0084/*NCHITTEST*/ :
                    base.WndProc(ref m);

                    if ((int)m.Result == 0x01/*HTCLIENT*/)
                    {
                        Point screenPoint = new Point(m.LParam.ToInt32());
                        Point clientPoint = this.PointToClient(screenPoint);
                        if (clientPoint.Y <= RESIZE_HANDLE_SIZE)
                        {
                            if (clientPoint.X <= RESIZE_HANDLE_SIZE)
                                m.Result = (IntPtr)13/*HTTOPLEFT*/ ;
                            else if (clientPoint.X < (Size.Width - RESIZE_HANDLE_SIZE))
                                m.Result = (IntPtr)12/*HTTOP*/ ;
                            else
                                m.Result = (IntPtr)14/*HTTOPRIGHT*/ ;
                        }
                        else if (clientPoint.Y <= (Size.Height - RESIZE_HANDLE_SIZE))
                        {
                            if (clientPoint.X <= RESIZE_HANDLE_SIZE)
                                m.Result = (IntPtr)10/*HTLEFT*/ ;
                            else if (clientPoint.X < (Size.Width - RESIZE_HANDLE_SIZE))
                                m.Result = (IntPtr)2/*HTCAPTION*/ ;
                            else
                                m.Result = (IntPtr)11/*HTRIGHT*/ ;
                        }
                        else
                        {
                            if (clientPoint.X <= RESIZE_HANDLE_SIZE)
                                m.Result = (IntPtr)16/*HTBOTTOMLEFT*/ ;
                            else if (clientPoint.X < (Size.Width - RESIZE_HANDLE_SIZE))
                                m.Result = (IntPtr)15/*HTBOTTOM*/ ;
                            else
                                m.Result = (IntPtr)17/*HTBOTTOMRIGHT*/ ;
                        }
                    }
                    return;
            }
            base.WndProc(ref m);
        }

        protected override CreateParams CreateParams
        {
            get
            {
                CreateParams cp = base.CreateParams;
                cp.Style |= 0x20000; // <--- use 0x20000
                return cp;
            }
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-03-25T21:25:23.667

您试图抑制其可见性的其他应用程序是什么？你有没有研究过其他达到你想要的效果的方法？请在使您的用户遭受您所描述的这种流氓行为之前这样做：您尝试做的事情听起来很像某些顽皮的网站对浏览器窗口所做的事情......

至少尝试遵守[Least Surprise](http://www.catb.org/~esr/writings/taouu/html/ch01s03.html)规则。用户希望能够自己确定大多数应用程序的 z 顺序。你不知道什么对他们来说最重要，所以如果你改变任何东西，你应该专注于推动其他应用程序背后的一切，而不是推广你自己的。

这当然更棘手，因为 Windows 没有特别复杂的窗口管理器。有两种方法建议自己：

1.  [枚举顶层窗口](http://www.catb.org/~esr/writings/taouu/html/ch01s03.html) 并检查[它们属于哪个进程](http://msdn.microsoft.com/en-us/library/ms633522(VS.85).aspx)，[如果是则删除它们的 z 顺序](http://msdn.microsoft.com/en-us/library/ms633545(VS.85).aspx)。（我不确定这些 WinAPI 函数是否有框架方法。）
2.  摆弄子进程权限以防止它访问桌面......但在其他方法失败之前我不会尝试这个，因为子进程可能最终处于僵尸状态，同时需要用户交互。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-05-18T05:14:32.307

为什么不让你的表单成为一个对话框：

```
myForm.ShowDialog(); 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2016-07-29T20:05:22.027

这是 SetForegroundWindow 等效项：

```
form.Activate(); 
```

我见过人们做一些奇怪的事情，比如：

```
this.TopMost = true;
this.Focus();
this.BringToFront();
this.TopMost = false; 
```

[http://blog.jorgearimany.com/2010/10/win32-setforegroundwindow-equivalent-in.html](http://blog.jorgearimany.com/2010/10/win32-setforegroundwindow-equivalent-in.html)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-05-31T18:29:06.550

我知道这是旧的，但我没有看到这个回复。

在窗口（xaml）中添加：

```
Deactivated="Window_Deactivated" 
```

在 Window_Deactivated 后面的代码中：

```
private void Window_Deactivated(object sender, EventArgs e)
    {
        Window window = (Window)sender;
        window.Activate();
    } 
```

这将使您的窗口保持在顶部。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-08-14T09:49:34.667

根据[clamum 的](https://stackoverflow.com/users/1396613/clamum)回答，以及[Kevin Vuilleumier 对](https://stackoverflow.com/users/2416369/kevin-vuilleumier)负责该行为的另一个标志的评论，我做了这个切换，通过按下按钮*在顶部*和*非顶部之间切换。*

```
private void button1_Click(object sender, EventArgs e)
    {
        if (on)
        {
            button1.Text = "yes on top";
            IntPtr HwndTopmost = new IntPtr(-1);
            SetWindowPos(this.Handle, HwndTopmost, 0, 0, 0, 0, TopmostFlags);
            on = false;
        }
        else
        {
            button1.Text = "not on top";
            IntPtr HwndTopmost = new IntPtr(-2);
            SetWindowPos(this.Handle, HwndTopmost, 0, 0, 0, 0, TopmostFlags);
            on = true;
        }
    } 
```

# php - 简单的 Paypal IPN 示例？

> ID：683332
> 
> 赞同：19
> 
> 时间：2009-03-25T20:33:42.030
> 
> 标签：php, paypal, paypal-ipn

我想要一个带有提交按钮的文本输入表单，该表单可以发送到贝宝，付款后表单的内容应该进入 mysql 数据库。

这听起来微不足道，但我在使用贝宝的 IPN 时遇到了这样的困难。

谁能指出我正确的方向？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-25T20:42:24.787

PayPal 在他们的网站上有一些示例代码。然而，您将面临的更大问题是用户可能需要实时响应。这通常是通过处理当用户单击链接返回到您的站点时提交到您的站点的 PDT 数据来完成的。稍后，PayPal 会在您的 IPN url 上发布类似的数据。您需要避免两次处理数据。

此外，有问题的数据只是 PayPal 关于交易的数据。它不包含任意数据。您可能应该在将客户的订单发送到贝宝之前记录他们的订单，或者寻找传递变量。例如，在创建计费协议时，有一个名为的变量`custom`会在您创建时传回给您。您可以在该变量中存储订单 ID 或您想要的任何内容。请小心验证其内容，以确保它对于交易详细信息仍然正确。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T20:39:10.987

您不会也不能从 Paypal 取回表单的全部内容。你会得到一个回传到你在“return”字段中发送的地址。将任意信息从表单传递到回发的最佳方式是在“item_number”字段中（最好将其用作数据库中的 ID，链接到您想要跟踪的任何信息）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-10-15T08:43:31.460

我知道这个问题几年前就已经回答过了，但是对于那些将来偶然发现它的人......

我发现这个类+示例特别有用，以至于我将它重新用于无数项目： http: [//www.micahcarrick.com/php-paypal-ipn-integration-class.html](http://www.micahcarrick.com/php-paypal-ipn-integration-class.html)

**更新：**该页面现在处于离线状态，但这里有一个存档版本，它仍然有一个有效的下载链接：[https ://web.archive.org/web/20140210202247/http://www.micahcarrick.com/php-paypal- ipn-integration-class.html](https://web.archive.org/web/20140210202247/http://www.micahcarrick.com/php-paypal-ipn-integration-class.html)

这是存档下载的直接链接：[https ://web.archive.org/web/20140210202247/http://www.micahcarrick.com/files/paypal-1.3.0.zip](https://web.archive.org/web/20140210202247/http://www.micahcarrick.com/files/paypal-1.3.0.zip)

从存档页面，作者还链接到他的库的新版本，这可能是现在更好的选择：[https ://github.com/Quixotix/PHP-PayPal-IPN](https://github.com/Quixotix/PHP-PayPal-IPN)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-26T10:51:38.820

[这个 PHP 示例](http://www.opendb.net/element/369.php)应该可以帮助您开始使用 IPN。

在这里您可以找到适用于 PayPal 的 PHP [API](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/library_download_sdks "贝宝 API 下载")，即使它不包含处理 IPN 的示例，它也可能很有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-09T11:09:16.287

如果您点击此链接，您将找到一些 IPN 脚本示例

[https://paypaltech.com/SG2/](https://paypaltech.com/SG2/)

只需选择您的编程语言和您正在寻找的脚本类型。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-31T19:55:12.310

我猜你想要的是制作一个表单，当用户点击提交按钮时，它会被带到贝宝，然后回到你的网站，在那里你可以获得表单的内容？

我没有看到人们这样做，我看到人们所做的是，当用户提交表单时，他们会被带到一个脚本来处理表单，并在该脚本中他们被重定向到他们支付的贝宝，你然后可以使用 IPN 来处理 paypal 的响应。

# javascript - 如何使用 jQuery 找到元素的绝对位置？

> ID：683339
> 
> 赞同：422
> 
> 时间：2009-03-25T20:36:52.210
> 
> 标签：javascript, jquery

有没有办法使用jQuery找到元素的绝对位置，即相对于窗口的开始位置？

* * *

## 回答 #1

> 赞同：688
> 
> 时间：2009-03-25T21:33:03.213

[`.offset()`](http://docs.jquery.com/CSS/offset)将元素的偏移位置作为简单对象返回，例如：

```
var position = $(element).offset(); // position = { left: 42, top: 567 } 
```

您可以使用此返回值将其他元素定位在同一位置：

```
$(anotherElement).css(position) 
```

* * *

## 回答 #2

> 赞同：215
> 
> 时间：2012-04-26T20:11:57.777

请注意，它`$(element).offset()`告诉您元素*相对于文档*的位置。这在大多数情况下都很好用，但在这种情况下**`position:fixed`**你会得到意想不到的结果。

如果您的文档*比视口长*并且您已经垂直滚动到文档底部，那么您的`position:fixed`元素`offset()`值**将比**预期值大您滚动的量。

如果您正在寻找*相对于视口*（窗口）的值，而不是位置：固定元素上的文档，您可以`scrollTop()`从固定元素的值中减去文档的`offset().top`值。例子：`$("#el").offset().top - $(document).scrollTop()`

如果`position:fixed`元素的偏移父级是*document*，则您想改为阅读`parseInt($.css('top'))`。

# html - 在 CSS 和 HTML 中实现多列布局的最佳方法是什么？

> ID：683345
> 
> 赞同：1
> 
> 时间：2009-03-25T20:37:50.817
> 
> 标签：html, css

我在 HTML 中遇到问题。我将 HTML 页面分为两列：

### 我的代码：

```
<div id="outer">      
  <div id="inner1">
    <div id="data1">
    </div>
    <div id="response">
    </div>
  </div>

  <div id="inner2">
    <div id="data2">
    </div>
  </div>
</div> 
```

### 我的 CSS：

```
#outer {
     background-color:#FFFF99;           
}
#inner1 {
     float: left;
     width: 62%;
}
#inner2 {
     float: right; 
     width: 38%;
} 
```

我需要`#inner1_2`在中间插入另一列`inner1`，`inner2`这是可选的。

还有第三列：

```
<div id="#inner1_2">
</div> 
```

这里的问题是变量除法。根据数据，我有三列或两列：

*   `inner2`是固定的
*   如果有三列数据，`.inner1`需要分成两半，否则`.inner1`保持原样。

这是比我在 CSS 中所熟悉的更复杂的逻辑。

处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T21:03:42.067

向外部 div 添加一个类，用于控制内部 div 的显示方式。将类设置为“twoColumn”会隐藏中间列，将类设置为“threeColumn”会显示中间列：

```
<div id="outer" class="twoColumn">
   <div id="inner1">
      <div id="data1">
      </div>
      <div id="response">
      </div>
   </div>
   <div id="inner1_2">
   </div>
   <div id="inner2">
      <div id="data2">
      </div>
   </div>
</div> 
```

CSS：

```
#outer { background-color: #FF9; }
#inner1 { float: left; }
#inner1_2 { float: left; }
#inner2 { float: left; width: 38%; }
.twoColumn #inner1 { width: 62% }
.twoColumn #inner1_2 { display: none; }
.threeColumn #inner1 { width: 31%; }
.threeColumn #inner1_2 { width: 31%; } 
```

# java - 在javabean getter中设置cookie

> ID：683356
> 
> 赞同：0
> 
> 时间：2009-03-25T20:39:15.743
> 
> 标签：java, cookies, stripes

我正在使用 Stripes，但我不确定这个问题是否是因为这个。我有一个带有 setter 方法 setSearchView 的 actionBean。在这个设置器中，我设置了一个 cookie。我看到的问题是，如果我从我的 jsp 调用该方法，cookie 不会被设置（我已经调试了代码并且它确实通过了代码）。如果我从动作处理程序调用相同的 setSearchView，则设置 cookie。

有什么我想念的吗？这是 Stripes 的事情还是 jsp/javabean 的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-09T03:16:29.987

我认为您误解了编程模型，我猜您来自 CGI/Php 背景。

Stripes 动作 bean 上的 Setter/getter 用于允许 ActionBean 从浏览器接收请求参数（GET 请求中的 URL 参数，POST 请求中的表单参数）。

您不会从 JSP 手动设置它们，因为您不会将控制器逻辑放在 JSP 中，而是放在 ActionBean 中。

JSP 将仅用于显示（“查看”）控制器从模型/视图模型提供的任何数据，并显示输入元素以允许用户提供输入。（参见维基百科上的[MVC](http://en.wikipedia.org/wiki/Model-view-controller)）

# excel - SSIS 列名自动更改为 F2,F3 .....F13

> ID：683361
> 
> 赞同：0
> 
> 时间：2009-03-25T20:40:49.953
> 
> 标签：excel, ssis, columnname

我有一个 XL 源文件，第一列包含名称，199001,19902.....,199012,

在使用 XL 源的 SSIS 包中，如果单击第一列包含标题，它会自动将我的标题转换为名称、F2、F3 .....F13。

但我需要像 Name,199001,19902,.....,199012 作为标题，而不是使用 unpivot 转换并将列转换为行到我的临时表。

请解决我的问题，我需要上面提到的 XL 列（名称，199001，19902，.....，199012）

提前致谢

谢谢，

平库

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T08:49:19.633

这是因为 SSIS 将列名检测为数字。在 Excel 工作表中，通过在字段数据的开头添加单引号来强制它们为字符。（即`'199001`）。然后应该正确导入列名。

我已经在 SSIS 2005 上对此进行了测试。

# jquery - 5秒后jQuery自动隐藏元素

> ID：683363
> 
> 赞同：98
> 
> 时间：2009-03-25T20:41:21.917
> 
> 标签：jquery, jquery-ui

是否可以在使用 jQuery 加载表单后 5 秒自动隐藏网页中的元素？

基本上，我有

```
<div id="successMessage">Project saved successfully!</div> 
```

我想在 5 秒后消失。我查看了 jQuery UI 和隐藏效果，但我在让它按我想要的方式工作时遇到了一些麻烦。

```
<script type="text/javascript">
        $(function() {
            function runEffect() {

                var selectedEffect = 'blind';

                var options = {};

                $("#successMessage").hide(selectedEffect, options, 500);
            };

            $("#successMessage").click(function() {
                runEffect();
                return false;
            });
        });
    </script> 
```

我希望删除 click 函数并添加一个超时方法，该方法在 5 秒后调用 runEffect() 。

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2010-11-05T19:39:16.037

```
$('#selector').delay(5000).fadeOut('slow'); 
```

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2009-03-25T20:45:34.403

```
$(function() {
    // setTimeout() function will be fired after page is loaded
    // it will wait for 5 sec. and then will fire
    // $("#successMessage").hide() function
    setTimeout(function() {
        $("#successMessage").hide('blind', {}, 500)
    }, 5000);
}); 
```

**注意**：为了让你的 jQuery 函数在 setTimeout 中工作，你应该把它包装在里面

```
function() { ... } 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-07-02T06:09:23.447

你可以试试 ：

```
setTimeout(function() {
  $('#successMessage').fadeOut('fast');
}, 30000); // <-- time in milliseconds 
```

如果你使用这个，那么你的 div 将在 30 秒后隐藏。我也试过这个，它对我有用。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-11-07T21:04:42.443

请注意，您可能需要在 div 文本消失后再次显示它。因此，您还需要清空该元素，然后在某个时候重新显示该元素。

您可以使用 1 行代码执行此操作：

```
$('#element_id').empty().show().html(message).delay(3000).fadeOut(300); 
```

如果您使用 jQuery，则不需要 setTimeout，至少不需要自动隐藏元素。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-25T20:59:34.213

您在 runEffect 函数上使用 setTimeout ：

```
function runEffect() {
    setTimeout(function(){
        var selectedEffect = 'blind';
        var options = {};
        $("#successMessage").hide(selectedEffect, options, 500)
     }, 5000);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-01-29T09:04:36.433

我想，你也可以做类似的事情......

```
setTimeout(function(){
    $(".message-class").trigger("click");
}, 5000); 
```

并在事件点击上做你的动画效果......

```
$(".message-class").click(function() {
    //your event-code
}); 
```

问候，

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-03-26T03:40:41.963

jQuery(".success_mgs").show(); setTimeout(function(){ jQuery(".success_mgs").hide();},5000);

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-07-05T11:41:15.690

这是单击后设置超时的方法。

```
$(".selectorOnWhichEventCapture").on('click', function() {
    setTimeout(function(){
        $(".selector").doWhateverYouWantToDo();
    }, 5000);
}); 
```

//5000 = 5sec = 5000 毫秒

# javascript - 删除 div 中的所有子 DOM 元素

> ID：683366
> 
> 赞同：132
> 
> 时间：2009-03-25T20:42:02.073
> 
> 标签：javascript, dojox.gfx

我有以下 dojo 代码来在 div 下创建表面图形元素：

```
....
<script type=text/javascript>
....
   function drawRec(){
      var node = dojo.byId("surface");
      //   remove all the children graphics
      var surface = dojox.gfx.createSurface(node, 600, 600);

      surface.createLine({
         x1 : 0,
         y1 : 0,
         x2 : 600,
         y2 : 600
      }).setStroke("black");
   }
....
</script>
....
<body>
<div id="surface"></div>
.... 
```

`drawRec()`将第一次绘制一个矩形图形。如果我在这样的锚点 href 中再次调用此函数：

```
 <a href="javascript:drawRec();">...</a> 
```

它将再次绘制另一个图形。我需要清理 div 下的所有图形，然后重新创建。我怎样才能添加一些 dojo 代码来做到这一点？

* * *

## 回答 #1

> 赞同：292
> 
> 时间：2009-03-25T21:01:33.727

```
while (node.hasChildNodes()) {
    node.removeChild(node.lastChild);
} 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-03-25T23:58:51.287

```
node.innerHTML = ""; 
```

非标准，但快速且支持良好。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-03-26T00:38:33.157

首先，您需要创建一次表面并将其保存在方便的地方。例子：

```
var surface = dojox.gfx.createSurface(domNode, widthInPx, heightInPx); 
```

`domNode`通常是一个朴素的`<div>`，用作表面的占位符。

您可以一次清除表面上的所有内容（所有现有的形状对象都将失效，之后不要使用它们）：

```
surface.clear(); 
```

所有表面相关的函数和方法都可以在[dojox.gfx.Surface](http://dojotoolkit.org/reference-guide/1.9/dojox/gfx.html#surface)上的官方文档中找到。可以在 中找到使用示例`dojox/gfx/tests/`。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-03-25T21:08:05.677

```
while(node.firstChild) {
    node.removeChild(node.firstChild);
} 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2010-03-02T17:32:04.113

在 Dojo 1.7 或更新版本中，使用[`domConstruct.empty(String|DomNode)`](http://dojotoolkit.org/reference-guide/1.10/dojo/dom-construct.html#dojo-dom-construct-empty)：

```
require(["dojo/dom-construct"], function(domConstruct){
  // Empty node's children byId:
  domConstruct.empty("someId");
}); 
```

在较旧的 Dojo 中，使用[`dojo.empty(String|DomNode)`](http://dojotoolkit.org/reference-guide/1.7/dojo/empty.html)（Dojo 1.8 已弃用）：

```
dojo.empty( id or DOM node ); 
```

这些`empty`方法中的每一个都安全地删除节点的所有子节点。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-25T21:07:10.687

从 dojo API[文档](http://api.dojotoolkit.org/jsdoc/dojo/1.2/dojo.html._emptyNode)：

```
dojo.html._emptyNode(node); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-02-17T21:46:17.307

如果您正在寻找一种现代的 >1.7 Dojo 方法来销毁所有节点的子节点，则方法如下：

```
// Destroys all domNode's children nodes
// domNode can be a node or its id:
domConstruct.empty(domNode); 
```

> 安全地清空 DOM 元素的内容。empty() 删除所有子节点，但将节点保留在那里。

[查看“dom-construct”文档以获取更多详细信息。](http://dojotoolkit.org/reference-guide/1.8/dojo/dom-construct.html#empty)

```
// Destroys domNode and all it's children
domConstruct.destroy(domNode); 
```

> 销毁一个 DOM 元素。destroy() 删除所有子节点和节点本身。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-03T04:32:59.493

```
const wipeOut = elm => [...elm.childNodes].forEach(child => child.remove());

wipeOut(elm); 
```

# c# - 如何在单个原子操作中移动 C# .NET 中的目录

> ID：683369
> 
> 赞同：4
> 
> 时间：2009-03-25T20:43:38.277
> 
> 标签：c#, .net, file, filesystems

我需要能够在单个原子操作中移动整个目录，以确保系统上没有其他任何东西能够通过在我开始后创建新文件、锁定文件等来破坏操作。

据推测，如果目录位于同一卷上（如果 Directory.GetDirectoryRoot() 相同），我将使用 System.IO.Directory.Move()，否则我必须在另一个卷上创建一个新的目标目录并递归复制/移动下面的所有目录和文件。

我读过的任何内容都没有显示如何在 .NET 中获得对整个目录叶的独占锁定，因此可以安全地完成此操作。有推荐/支持的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T22:35:20.553

Vista*确实*支持 NTFS 卷中的事务：

[http://msdn.microsoft.com/en-us/magazine/cc163388.aspx](http://msdn.microsoft.com/en-us/magazine/cc163388.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T21:12:43.310

您能否通过临时重命名“根”目录来解决此问题（之后立即创建一个具有相同名称的目录，以便访问该目录的任何人都不会遇到错误），然后处理重命名目录中的文件？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T20:51:03.657

我想说你真正需要的是一个事务性文件系统...... NTFS 不是，虽然有这样的 MS 计划，但它在成为 Vista 之前从 Longhorn 中删除（以及在那之前从开罗）。

您可以尝试在移动之前获得目录中每个文件的排他锁，并通过显式文件读/写来进行移动，但是递归？我不太确定这是个好主意……而且，这不能防止添加新文件。

你真正想做什么？你为什么担心并发活动？

# wix - MSI 安装顺序 - 在服务启动之前运行 DB 脚本

> ID：683371
> 
> 赞同：3
> 
> 时间：2009-03-25T20:45:02.970
> 
> 标签：wix, windows-installer, install-sequence

伙计们，

我们在安装 MSI 时遇到了一些排序问题。作为我们应用程序的一部分，我们安装了一系列服务，并允许用户选择是立即启动它们还是稍后启动它们。

当它们立即启动时，它们似乎在安装序列中启动得太早 - 在我们的数据库管理器有机会更新数据库之前。

现在，我们运行数据库更新程序的自定义操作看起来像这样——它在“InstallFinalize”之后运行——在这个过程中很晚。

```
 <InstallExecuteSequence>
      <RemoveExistingProducts After='InstallInitialize' />
      <Custom Action='RunDbUpdateManagerAction' After='InstallFinalize'>
           DbUpdateManager=3</Custom>
   </InstallExecuteSequence> 
```

为了确保在任何已安装的服务启动*之前执行数据库脚本，在之后或之前运行更合适的步骤是什么？*是否有“BeforeServiceStart”步骤？

**编辑：**

仅仅在标签上定义“Before='StartServices'”属性并不能解决我的问题。

我假设问题是这样的：自定义操作有一个“内部文本”，它代表一个条件，这个条件是：“&DbUpdateManager=3”。从我可以从试验和错误中推断出来，这可能意味着“必须发布 DbUpdateManager 功能”。

现在，问题是：“PublishFeature”出现在安装序列的最后，就在“InstallFinalize”之前，而且肯定在 InstallServices / StartServices 之后。因此，当我指定“Before=StartServices”要求时，“必须发布 DbUpdateManager 功能”条件还不成立，因此 DbUpdateManager 不会被执行:-(

我尝试删除条件 - 在这种情况下，我的 DbUpdateManager 有时根本不执行，有时不止一次 - 没有真正明确的模式来说明什么时候会发生......

还有什么想法吗？？有没有一种方法可以检查“安装了 DbUpdateManager 功能”的条件，这在“InstallFiles”步骤之后是否正确？

马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T20:47:42.543

没有`BeforeServiceStart`，但你可以试试`Before='StartServices'`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-22T18:38:53.680

好吧，看来 marc_s 在另一个[问题](https://stackoverflow.com/questions/778210/wix-trying-to-figure-out-install-sequences)中得到了答案。但是，由于我的解决方案略有不同，并且另一个问题需要进行一些重构才能获得解决方案，因此这正是对我有用的方法：

```
...
<InstallExecuteSequence>
  <Custom Action="CopyConfigs" 
          After="InstallFiles"><![CDATA[&ProductFeature = 3]]></Custom>
</InstallExecuteSequence>
<CustomAction Id="CopyConfigs"
              FileKey="copySamples"
              ExeCommand=""
              Execute="deferred"
              Impersonate="no"/>

<Directory Id="TARGETDIR" Name="SourceDir">
...
  <Directory Id="Config" Name="Config">
    <Component Id="ShippedConfigs" Guid="{8E6344C8-2B3F-4654-8B42-C09E76200052}">
      <File Id="copySamples"
            Source="$(var.ProjectDir)config\Copy.Configs.Sample.cmd"
            KeyPath="no"
            DiskId="1" />
    </Component>
  </Directory>
</Directory>

<Feature Id="ProductFeature" Title="MyService" Level="1">
  <ComponentRef Id="ShippedConfigs" />
  ...
</Feature> 
```

# c# - ASP.NET MVC (C#) 中的经典 ASP

> ID：683374
> 
> 赞同：9
> 
> 时间：2009-03-25T20:46:52.187
> 
> 标签：c#, asp.net-mvc, vb6, asp-classic

我有一个我想（最终）转换为 ASP.NET MVC 的应用程序。我想做一个全面的服务升级（到 ASP.NET），但想使用当前的 asp 东西来运行当前的功能，这样我就可以在对新框架进行增量升级的同时升级小块。该站点严重依赖于一个不太成熟的 VB6 DLL，因此我们最终也希望对其进行升级，可能会用 Web 服务替换当前的功能。是否有快速修复或此任务是 3 个月 + 任务？另外，我确信之前已经考虑过，MVC 的美妙之处在于我认为有一种方法可以解决这个问题，尽管我不确定从哪里开始。转换此应用程序（大约 40 小时）的最快方法是什么，我可以在其中进行小的配置更改并使其在 ASP.NET MVC 中工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T20:50:38.790

简短的回答是……你不能。经典的 asp 和 asp.net 之间的差异相当大，不仅在语法上，而且在整体设计上。MVC 不仅仅是与经典 asp 类似的实现，尽管它看起来可能是这样的。任何转换都需要时间、思想和努力才能使其完全发挥作用。

不过好消息是，您可以运行它们 SxS，因此您实际上可以在设置为 ASP.NET 或 ASP.NET MVC 站点的站点下运行经典的 asp 代码。因此，使用一些胶带，您可以将升级后的解决方案部分拼凑在一起。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T20:57:48.070

将您的 VB6 DLL 重写为 COM 可调用 .NET 程序集。然后，您可以从 ASP 和 ASP.NET 中引用它。

希望大部分繁重的工作都在 VB6 DLL 中。如果是这样，您可以根据需要开始将页面迁移到 ASP.NET MVC。你必须注意页面到页面的通信——比如会话和 Cookie。Cookie 几乎可以按原样工作，但您需要将 Session 移动到 MVC 和 ASP 之间可共享的东西，例如 Sql Server。不幸的是，这需要将 ASP 中的 Session 调用重写为其他东西（可能又是一个围绕 .NET 组件的 COM 包装器）。不过，搜索和替换应该可以解决问题。

至于时间线和工作量，这取决于现有应用程序中意大利面条的数量、DLL 与 ASP 中的逻辑量以及要迁移的页面数量。

我不认为 40 小时是加快 .NET、MVC 和重写速度的合理时间——尽管我认为 2-3 个月可能是这样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T20:58:21.907

我从事类似项目已经有一段时间了；我们有一个经典的 ASP 应用程序，并希望将其移至 ASP.Net（使用 WebForms）。我们一次做一个，如果我们要添加一个新页面，我们会在 .Net 中进行，并且只是在 .asp 文件和 .aspx 文件之间重定向用户。使用 MVC 应该没有什么不同。

我们遇到的最大问题是安全性。该站点需要登录，并且会话当然不会在两者之间共享。我们通过将我们关心的会话位持久化到数据库中的表并通过查询字符串传递 GUID 来处理这个问题（我们只在登录时这样做一次，然后从数据库中删除记录以降低安全风险）。

# iphone - 如何在 Xcode 中创建一个 iPhone 项目，在项目创建时指定我想要使用的 SDK 版本？

> ID：683375
> 
> 赞同：5
> 
> 时间：2009-03-25T20:47:03.947
> 
> 标签：iphone, xcode

当您创建一个新的 iPhone 项目时，使用最新的 Xcode 和 SDK 3.0 测试版，Xcode 会创建一个 SDK 3.0 项目。如果我想在项目创建后恢复到 SDK 2.2.1，我需要更改生成的源代码文件中的某些内容，因为某些 API 已更改。有没有一种简单的方法可以在项目创建时指定我要明确使用的 SDK？

先感谢您

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T05:19:33.397

我不能具体评论 iPhone SDK 3.0，因为它包含在 NDA 中；在 devforums.apple.com 上有一个公开的开发者论坛。但罗杰·诺兰一半对一半错。他说对了一半，当任何 SDK 更新时，该 SDK 中的示例和模板都会更新以利用它。也就是说，模板可能专门使用该 SDK 中的新 API，而代码可能无法与早期的 SDK 一起使用。

也就是说，您可以保存早期 SDK 中的项目模板并将它们安装在本地目录中（如 ~/Library/Application Support/Developer/Shared/Xcode/Project Templates），以便与更高版本的 Xcode 一起使用。项目模板格式本身没有改变；模板应该是向前和向后兼容的，但是模板的*内容*通常被锁定到它附带的 SDK 版本和更高版本。

Nolan 先生在使用较新的 SDK 构建较早的操作系统版本时有一半是错误的。这就是为什么较早的 SDK 包随较晚的发行版一起提供（它们不存在只是为了使下载花费更长的时间）。通过设置部署目标构建设置，您可以使用较新的 SDK 针对较旧的操作系统版本进行部署。

有一个小细节是您可能不应该部署由预生产工具链生成的生产应用程序。但是一旦版本 N 正式发布，你应该可以使用它的工具链来构建 N-1、N-2 等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T22:49:55.103

如果您没有使用 3.0 API 中的任何新功能，您应该能够从 Xcode 项目窗口左上角的下拉菜单中选择 Active SDK。只需选择“设备 - 2.2.1”或“模拟器 - 2.2.1”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T22:53:26.750

Xcode 默认安装最新的 SDK，我不知道有什么方法可以改变这种行为。

我养成了在创建项目后立即在项目属性中将基本 SDK 设置为 2.0 的习惯。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T15:50:32.787

使用 Beta 工具链时，您应该将它*与*最新发布的工具链一起安装，而不是代替它。在生产工具链中创建您的项目，然后使用 beta 工具链打开它们以进行兼容性测试。

无论如何，您都需要发布的工具链才能进行分发构建。您不应该使用 beta 工具链构建分发。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T07:25:56.453

根据苹果没有。Can Berk Güder 对我的帖子的评论另有说法。我不建议效仿他的例子——希望 Apple 看不到你在做什么，或者你不会犯 3.0 的缺陷，这是一个乐透。

您可以使用 Xcode 为早期版本的操作系统构建，但如果您需要使用多个 SDK 构建，您应该安装它们。Xcode 支持在一台机器上进行多次安装，安装说明记录了如何进行。

如果您想使用不能为 OS 2.2.1 构建的 3.0 SDK 并将该应用程序提交到应用商店 - 根据 Apple 的指南。他们说您还必须安装 2.2.1 SDK 并使用它进行构建。您可以构建 2.2 兼容的应用程序，但您使用的 beta 工具可能会引入错误。

这是您可以作为智力练习来做的事情之一，但是对于真正的应用程序来说，这不值得冒险。

# asp.net - Mono 上的 Ajax

> ID：683383
> 
> 赞同：1
> 
> 时间：2009-03-25T20:49:54.457
> 
> 标签：asp.net, mono, ajax.net

你们知道单声道的 ajax 工具包（或类似于 m$-ajaxtoolkit 的东西）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T17:40:06.353

Microsoft 的 ASP.NET AJAX 控制工具包在 Mono 上工作，并且是开源的 (Ms-PL)。不过，这并不排除使用 jQuery。实际上有几个支持 Mono 的第三方 AJAX 库和控制工具包，其中许多与 ASP.NET AJAX 兼容或一起工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T20:56:29.760

我建议使用 jQuery 滚动你自己的。无论如何，这就是 m$ 现在正在做的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-06T13:24:23.930

我同意 Brian 的观点，但要补充一点，您应该阅读 Dave Ward 的关于 jQuery 和 ASP.net 的系列文章。他真正提炼了您可以在没有 MS Ajax 的情况下使用 jQuery、PageMethods 和 WebForms 所做的事情的精髓。这些思想直接适用于 Mono/Linux 环境。

以下是重要帖子的列表：

[使用jQuery直接调用ASP.Net Ajax PageMethods](http://encosia.com/2008/05/29/using-jquery-to-directly-call-aspnet-ajax-page-methods/)

[使用 FireBug 学习 jQuery](http://encosia.com/2009/09/21/updated-see-how-i-used-firebug-to-learn-jquery/)

[使用 jQuery 简化调用 ASP.NET 服务](http://encosia.com/2009/07/21/simplify-calling-asp-net-ajax-services-from-jquery/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-26T08:06:48.513

调试 Mono 网站

你还记得，你在这台机器上没有开发环境吗？你可以安装它，或者用 openSuse 下载 Mono liveCD。但在这样做之前，请注意，GTK#（它是 devenv）对用户不是很友好。它甚至更糟，然后是 Eclipse。所以让我们先试着了解一下，不输入代码是否可以修复小的兼容性问题。

在 Mono 上调试网站最方便的方法是使用 XSP 和 XSP2 迷你 Web 服务器。只需进入该站点的目录并运行它。默认情况下，您可以使用 ... 访问该站点（它也是为您编写的）。输入并注意控制台中是否有任何错误。不？继续

最常见的问题是带有废话堆栈的“错误 500”。如果它包含 ScriptManager 错误 Type not found，则问题出在 Web.config 文件中。尝试重新生成它以与 Mono 兼容（例如，Mono 有不同版本的 System.Web.Extensions 程序集。在 ASP.NET 3.5 中它有 3.5 版，Mono 只有 1.0.61025.0（旧的 AJAX.NET）。重新创建您的 web.config 您所要做的就是执行“mconfig af AJAX Web.config”，它将创建默认的 web.config 文件，支持 System.Web.Extensions（AJAX 功能）。

没有帮助？继续。让我们再看看堆栈——如果它在“EnablePageMethods”或“ShouldGenerateScript”或“EncryptString”中包含错误——问题在于序列化。Mono 对 JSON、XML 和 SOAP 序列化的支持非常有限。尝试查看您的代码并注意您是否有标有 [Serializable] 的类，或者您正在使用 PageMethods 传输您自己的类。如果是这样，请将其替换为常规字符串（我的奶奶序列化）。

# javascript - 在较大的正则表达式中使用一组括号进行多次捕获

> ID：683384
> 
> 赞同：1
> 
> 时间：2009-03-25T20:49:58.497
> 
> 标签：javascript, regex

我有一个正则表达式（javascript），类似于...

/(x)(y)+(z)/gi

问题是，即使 (y)+ 匹配多次，我总是会从这些括号中准确地获得 3 个捕获。如果它匹配多次，它只返回最后一个匹配。我无法提前知道 y 在任何给定的运行中匹配多少次，但我想捕获所有这些。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T20:57:53.377

我会用

```
/(x)(y+)(z)/gi 
```

然后获取与第二组匹配的文本并进一步解析。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T20:53:22.123

我认为你不能使用

```
/(x)((?:y)+)(z)/gi 
```

因为这是“更大的正则表达式”的一部分？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T20:57:17.573

移动括号内的 +，然后将 y 拆分为各个部分。以下是 Perl，但它应该给你一个想法：

```
#!/usr/bin/perl

use strict;
use warnings;

my $s = "abcbcbcd";

my ($x, $y, $z) = $s =~ /(a)((?:bc)+)(d)/;

my @y = $y =~ /(bc)/g;

print "x is $x\n",
    "y is ", join(", ", @y), "\n",
    "z is $z\n"; 
```

这是我一起破解的一些糟糕的Javascript（我真的不知道Javascript）：

```
<html>
<body>

<script type="text/javascript">
var str = "abcbcbcd"; 
var matches = str.match(/(a)((?:bc)+)(d)/);
var x = matches[1];
var y = matches[2].match(/(bc)/g);
var z = matches[3];

document.write(
    "x is ", x, "<br />",
    "y is ", y.join(", "), "<br />",
    "z is ", z
);
</script>

</body>
</html> 
```

# actionscript-3 - 在 debug 和 release 中编译 swf 文件时，性能差异是什么？

> ID：683391
> 
> 赞同：0
> 
> 时间：2009-03-25T20:52:12.920
> 
> 标签：actionscript-3, performance, flash, compilation

我在哪里可以找到有关在发行版或调试中编译 swf 之间差异的信息？我想了解文件大小、内存消耗和整体方面的差异。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T01:44:47.290

按照评论...

可能没有人对此进行过统计的原因是调试模式仅用于测试目的。换句话说：它是否更慢和更大并不重要，因为我们真正寻找的是拥有可靠的最终产品（即发布版本）。

请注意，播放器之间的性能也会有所不同（activeX 与否/播放器版本/操作系统），因此几乎不可能确定任何精确的数字。

也许你可以解释为什么你坚持拥有这些信息，否则我建议你在感兴趣的情况下自己做。

**为此，请在性能消耗项目上插入[FPS 计](http://code.google.com/p/mrdoob/wiki/stats)并比较结果。**

如果您发现相关信息，请告诉我们！

谢谢

吨

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T20:55:17.313

> 不同的文件大小不同的内存消耗和整体？

这是可以预料的。调试版本通常包括：

*   调试符号和杂项信息

*   特别检查

所以他们很可能是：

*   慢点

*   使用更多内存

阅读有关[构建阶段](http://livedocs.adobe.com/flex/3/html/introbd_4.html)的更多信息！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T21:32:53.150

我发现在调试时编译 RSL 库的加载速度明显较慢。另一个值得注意的“调试”减速是从另一个 swf 加载字体。

# memory - 没有 Db 的 DbConnection 使用内存中的 DataSet（或类似的）作为源

> ID：683395
> 
> 赞同：7
> 
> 时间：2009-03-25T20:52:59.347
> 
> 标签：memory, dbconnection

我正在尝试对一些 .NET 类进行单元测试（出于良好的设计原因），这些类需要 DbConnections 来完成它们的工作。对于这些测试，我在内存中有某些数据可以作为这些类的输入。

内存中的数据可以很容易地表示为 DataTable（或包含该 DataTable 的 DataSet），但如果另一个类更合适，我可以使用它。

如果我能够以某种方式神奇地获得一个表示与内存中数据的连接的 DbConnection，那么我可以构造我的对象，让它们对内存中的数据执行查询，并确保它们的输出符合预期。 **有什么方法可以让 DbConnection 连接到内存数据？** 我没有安装任何额外的第三方软件来实现这一点的自由，理想情况下，我不想在测试期间触摸磁盘。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-26T11:58:58.733

您可以使用 IDbConnection 并模拟它，而不是使用 DbConnection 吗？我们做类似的事情，给 mock 传递一个 DataSet。DataSet.CreateDataReader 返回一个继承自 DbDataReader 的 DataTableReader。

我们已经将 DbConnection 包装在我们自己的类似 IDbConnection 的接口中，我们向其中添加了一个 ExecuteReader() 方法，该方法返回一个实现与 DbDataReader 相同接口的类。在我们的模拟中，ExecuteReader 只返回 DataSet.CreateDataReader 提供的内容。

听起来有点迂回，但构建一个可能包含许多结果集的 DataSet 非常方便。我们以它们代表结果的存储过程命名 DataTables，并且我们的 IDbConnection 模拟根据客户端调用的过程获取正确的数据表。DataTable 还实现了 CreateDataReader，所以我们可以开始了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-07-28T07:52:22.243

An approach that I've used is to create an in-memory Sqlite database. This may be done simply by pulling in the System.Data.SQLite.Core NuGet package to your unit test project, you don't need to install any software anywhere else.

Although it sounds like a really obvious idea, it wasn't until I was looking at the Dapper unit tests that I thought to use the technique myself! See the "GetSqliteConnection" method in

[https://github.com/StackExchange/dapper-dot-net/blob/bffb0972a076734145d92959dabbe48422d12922/Dapper.Tests/Tests.cs](https://github.com/StackExchange/dapper-dot-net/blob/bffb0972a076734145d92959dabbe48422d12922/Dapper.Tests/Tests.cs)

One thing to be aware of is that if you create an in-memory sqlite db and create and populate tables, you need to be careful not to close the connection before performing your test queries because opening a new in-memory connection will get you a connection to a *new* in-memory database, *not* the database that you just carefully prepared for your tests! For some of my tests, I use a custom IDbConnection implementation that keeps the connection open to avoid this pitfall - eg.

[https://github.com/ProductiveRage/SqlProxyAndReplay/blob/master/Tests/StaysOpenSqliteConnection.cs](https://github.com/ProductiveRage/SqlProxyAndReplay/blob/master/Tests/StaysOpenSqliteConnection.cs)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T11:44:01.000

类型模拟？（不过，您需要“安装”它）。

假设 Data* 可以为您提供适当的测试钩子，请小心——这通常是最坏的情况。但是你说好的设计原因，所以我确信这一切都包括在内：D

# asp.net - 在 ASP.Net 页面上使用用户控件时 ICallbackEventHandler 的 RaiseCallbackEvents 冲突

> ID：683396
> 
> 赞同：1
> 
> 时间：2009-03-25T20:53:01.763
> 
> 标签：asp.net, user-controls, icallbackeventhandler

您好，感谢您的阅读。

我正在使用 ICallbackEventHandler 接口在 ASP.Net 页面（VS 2005）中进行一些客户端处理。除以下情况外，一切都按预期工作。我创建了一个也使用 ICallbackEventHandler 的用户控件 (.ascx) 并将其放置在上述 ASP.Net 页面上。 **现在，RaiseCallbackEvent 会在用户控件上触发，但不会在 ASP.Net 页面上触发。换句话说，它不会在两个地方都触发。** 有没有其他人遇到过这个并有解决方案？

要重现，只需创建一个使用 ICallbackEventHandler 的 ASP.Net 页面，一个使用 ICallbackEventHandler 的用户控件并将其放在 ASP.Net 页面上，您将看到 RaiseCallbackEvent 在用户控件中触发，但在 ASP.Net 页面中没有.

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T13:41:58.973

在 asp 标记页面的顶部，您必须打开：-`EnableEventValidation="false"`

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Form.aspx.cs" Inherits="Form" DynamicMasterPageFile="~masterurl/default.master" EnableEventValidation="false" %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T16:36:45.437

当 ICallback 事件触发时，您需要在控件上引发自己的事件，以便通知页面。另一个选项是在您的页面上实现一个接口，并要求用户控件托管在实现该接口的页面上。一旦你完成了后者，你就可以将你的页面转换为接口并获得对接口属性和方法的访问权限。

# objective-c - 在 Objective C 中为实例变量赋值

> ID：683400
> 
> 赞同：2
> 
> 时间：2009-03-25T20:54:02.887
> 
> 标签：objective-c, instance-variables

我正在查看的功能：

```
-(void)viewDidLoad {
    NSBundle *bundle = [NSBundle mainBundle];
    NSString *plistPath = [bundle pathForResource:@"statedictionary" ofType:@"plist"];

    NSDictionary *dictionary = [[NSDictionary alloc] initWithContentsOfFile:plistPath];
    self.statesZips = dictionary;
    [dictionary release];

    NSArray *components = [self.stateZips allKeys];
    NSArray *sorted = [components sortedArrayUsingSelector:@selector(compare:)];
    self.States = sorted;

    NSString *selectedState = [self.states objectAtIndex:0];
    NSArray *array = [stateZips objectForKey: selectedState];
    self.zips = array;  
} 
```

为什么先分配一个NSDictionary，然后分配给一个叫*dictionary的指针，再分配给实例变量stateZips？为什么不分配它并将其直接分配给实例变量并节省创建和释放另一个 NSDictionary 的内存？始终遵循相同的方法，包括稍后在此函数中使用 NSArray...

```
NSDictionary *dictionary = [[NSDictionary alloc] initWithContentsOfFile:plistPath];
self.statesZips = dictionary;
[dictionary release]; 
```

此外，这种排序将哈希表（字典）中的键按字母顺序排列。我不确定我是否理解这一行：

```
NSArray *sorted = [components sortedArrayUsingSelector:@selector(compare:)]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T21:47:10.183

似乎没有人解决这一事实，即这条线

```
self.statesZips = dictionary; 
```

不是直接的实例变量赋值。`stateZips`是一个属性，因此该行代码调用该`setStateZips:`方法。该方法保留或复制字典，因此除非该`viewDidLoad`方法打算出于某种目的再次使用它，否则不再需要它。这样就可以`release`了。

上一行：

```
[[NSDictionary alloc] initWithContentsOfFile:plistPath]; 
```

分配一个对象。`release`一旦您不再需要它，这就是您对它的责任。将其分配给`statesZips`属性后，不再需要它，因此已释放，您不应再使用`dictionary`。你会注意到后面的代码只引用了`self.stateZips`，而不是`dictionary`.

`NSArray`在方法后面的情况下，`viewDidLoad`不分配对象，所以该方法不负责调用`release`它。经验法则是，如果你`alloc`这样做，你有责任确保它被释放。否则，这不是你的问题。

使用该`sortedArrayUsingSelector:`方法对数组进行排序。选择器标识了 Objective-C 中的方法。这`@selector`是选择器的文字语法（有点像对象`@""`的文字语法`NSString`）。因此，该代码所说的是“给我一个数组，其中的对象`components`已排序，并在您进行排序时使用该`compare:`方法比较每个对象。当它对数组进行排序时，它将调用`compare:`数组中的对象以确定如何将它们按顺序排列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T21:03:04.877

该`statesZips`属性可能被保留，这就是推理。

第一次分配 NSDictionary 时，它的保留计数为 1。当它分配给 statesZips 时，保留计数变为 2。当它被释放时，保留计数下降到 1，这通常是期望的结果。

请注意，下面的代码会产生（几乎）相同的结果：

```
self.statesZips = [NSDictionary dictionaryWithContentsOfFile:plistPath]; 
```

因为`dictionaryWithContentsOfFile`返回一个自动释放的对象。

按照惯例，类方法如`[NSDictionary dictionary]`返回 autoreleased 对象（一段时间后会自动释放），而通常的 alloc-init 方法（如`[[NSDictionary alloc] init]`）返回保留对象。

我建议您阅读[Cocoa 的内存管理编程指南以](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)获取更多信息。

**编辑：**当我第一次阅读它时，我一定错过了你问题的最后一部分，但巴里已经回答了那部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T21:03:22.100

此代码使用引用计数内存管理（不是 OS X 上的 Objective-C 2.0 中可用的自动垃圾回收内存管理）。当任何对象（在本例中为 NSDictionary 和 NSArray）被分配时，调用者负责调用`-release`该实例。调用 release 失败会导致内存泄漏。代码可以写成

```
self.statesZips = [[[NSDictionary alloc] initWithContentsOfFile:plistPath] autorelease]; 
```

但是以较少显式的内存管理为代价（依赖于`NSAutoreleasePool`在事件循环迭代结束时释放分配的实例。

通话

```
[components sortedArrayUsingSelector:@selector(compare:)]; 
```

返回一个数组，其元素来自，`components`但根据调用 [elem1 compare:elem2] 的返回值比较两个数组元素。

# c# - C# - 在我没有编写的类中使用多态性

> ID：683401
> 
> 赞同：2
> 
> 时间：2009-03-25T20:54:24.523
> 
> 标签：c#, architecture, inheritance, polymorphism

在我无法修改的类中实现多态行为的最佳方法是什么？我目前有一些代码，例如：

```
if(obj is ClassA) {
    // ...
} else if(obj is ClassB) {
    // ...
} else if ... 
```

显而易见的答案是在基类中添加一个虚拟方法，但不幸的是代码在不同的程序集中，我无法修改它。有没有比上面丑陋而缓慢的代码更好的方法来处理这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-25T20:59:06.010

嗯...似乎更适合[Adapter](http://en.wikipedia.org/wiki/Adapter_pattern)。

```
public interface ITheInterfaceYouNeed
{
    void DoWhatYouWant();
}

public class MyA : ITheInterfaceYouNeed
{
    protected ClassA _actualA;

    public MyA( ClassA actualA )
    {
        _actualA = actualA;
    }

    public void DoWhatYouWant()
    {
        _actualA.DoWhatADoes();
    }
}

public class MyB : ITheInterfaceYouNeed
{
    protected ClassB _actualB;

    public MyB( ClassB actualB )
    {
        _actualB = actualB;
    }

    public void DoWhatYouWant()
    {
        _actualB.DoWhatBDoes();
    }
} 
```

看起来像很多代码，但它会使客户端代码更接近你想要的。另外，它会让您有机会思考您实际使用的界面。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T20:56:02.147

查看[访客](https://stackoverflow.com/questions/42587/double-dispatch-in-c)模式。这使您可以在不更改类的情况下向类添加虚拟方法。如果您使用的基类没有 Visit 方法，则需要使用带有动态转换的扩展方法。这是一些示例代码：

```
public class Main
{
    public static void Example()
    {
        Base a = new GirlChild();
        var v = new Visitor();
        a.Visit(v);
    }
}

static class Ext
{
    public static void Visit(this object b, Visitor v)
    {
        ((dynamic)v).Visit((dynamic)b);
    }
}

public class Visitor
{
    public void Visit(Base b)
    {
        throw new NotImplementedException();
    }

    public void Visit(BoyChild b)
    {
        Console.WriteLine("It's a boy!");
    }

    public void Visit(GirlChild g)
    {
        Console.WriteLine("It's a girl!");            
    }
}
//Below this line are the classes you don't have to change.
public class Base
{
}

public class BoyChild : Base
{
}

public class GirlChild : Base
{
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T21:04:11.207

我想说这里的标准方法是将要“继承”的类包装为受保护的实例变量，然后在容器中模拟包装类的所有非私有成员（方法/属性/事件/等）班级。然后，您可以将此类及其相应成员标记为虚拟，以便您可以使用标准的多态特性。

这是我的意思的一个例子。`ClosedClass`是程序集中包含的类，您无权访问其代码。

```
public virtual class WrapperClass : IClosedClassInterface1, IClosedClassInterface2
{
    protected ClosedClass object;

    public ClosedClass()
    {
        object = new ClosedClass();
    }

    public void Method1()
    {
        object.Method1();
    }

    public void Method2()
    {
        object.Method2();
    }
} 
```

如果您引用的任何程序集设计得很好，那么您可能想要访问的所有类型/成员都将被适当标记（抽象、虚拟、密封），但不幸的是事实并非如此（有时您甚至可以体验到这一点基类库的问题）。在我看来，包装类是要走的路。它确实有它的好处（即使您想要派生的类*是*可继承的），即删除/更改您不希望类的用户访问的方法的修饰符。BCL 中的`ReadOnlyCollection<T>`是一个很好的例子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T22:25:48.717

看一下[装饰器](http://en.wikipedia.org/wiki/Decorator_pattern)模式。诺多林实际上在没有给出模式名称的情况下解释了它。

装饰器是不继承而扩展行为的方式。我在诺多林的代码中唯一要改变的是构造函数应该接收你正在装饰的对象的一个​​实例。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-25T21:32:31.060

[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)提供了一种向现有类添加附加方法签名的简单方法。这需要3.5框架。

创建一个静态实用程序类并添加如下内容：

```
public static void DoSomething(this ClassA obj, int param1, string param2)
{
    //do something
} 
```

在页面上添加对实用程序类的引用，该方法将作为 ClassA 的成员出现。您可以通过这种方式重载现有方法或创建新方法。

# javascript - 子导航不指向页面（jquery）

> ID：683404
> 
> 赞同：0
> 
> 时间：2009-03-25T20:55:53.600
> 
> 标签：javascript, jquery, navigation, hyperlink

我有下拉导航、嵌套列表的基本标记。

用户将单击顶部导航项，这将打开子导航，但我的子导航链接不起作用。

它在 CMS 中，所以我必须在那里有占位符页面的链接。

标记：

```
<ul class="navtop">
<li><a href="">Who</a>
  <ul>
     <li><a href="">Sub Item 1</a></li>
     <li><a href="">Sub Item 2</a></li>
     <li><a href="">Long Sub Item 3</a></li>
     <li><a href="">Sub Item 4</a></li>
  </ul>
</li>
<li><a href="">What</a>
  <ul>
     <li><a href="">Sub Item 1</a></li>
     <li><a href="">Sub Item 2</a></li>
     <li><a href="">Long Sub Item 3</a></li>
     <li><a href="">Sub Item 4</a></li>
  </ul>
</li>
</ul> 
```

Javascript：

```
$(".navtop li").click(function(){
    $(this).toggleClass("show");        
    $(this).siblings(".show").toggleClass("show");
    return false;
}); 
```

CSS：

```
#headernav .navtop li.show ul
{
display: block;
} 
```

我尝试为 $(".navtop li ul li a") 添加“return true”，但没有成功。建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T21:15:05.283

为什么你对 LI 点击返回 false？我相信这就是问题所在。

如果你把它拿出来，一切都应该正常。

如果这不起作用，请记住您将单击事件附加到每个 LI 而不仅仅是顶级 LI。试试这个：

```
$(".navtop > li").click(function(){
        $(this).toggleClass("show");            
        $(this).siblings(".show").toggleClass("show");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T21:21:38.793

原来这行得通：

```
$(".navtop > li > a").click(function(){
    $(this).parent('li').toggleClass("show");       
    $(this).parent('li').siblings(".show").toggleClass("show");
    return false;
}); 
```

# linq-to-sql - 具有公共列的表的 DRY LINQ 语句

> ID：683410
> 
> 赞同：2
> 
> 时间：2009-03-25T20:56:51.990
> 
> 标签：linq-to-sql, dry

这是一个有趣的问题。有没有办法使用 LINQ to SQL 编写一些代码，它能够执行表更新，只知道给定的表包含列 x、y、z，但在编译时不知道它正在处理哪个表？

我的数据库模式中有几个表共享一些列，我需要应用一个基于集合的 UPDATE 操作，无论我们正在处理哪一个表，它的逻辑过程都是相同的。

这是一个简单的例子：假设您有 3 个实现邻接模型层次结构的表（即每行包含一个主键 ID 和一个自引用父 ID 列）。每个表还有一个“禁用”布尔标志。当我禁用任何这些实体的实例时，它应该通过子项级联，即

UPDATE MyTable SET Disabled = 1 WHERE ID = @ID 或 Parent_ID = @ID

我不想为每个实体编写这种 LINQ 语句，它违反了 DRY。这个例子可能看起来微不足道，但随着例子变得越来越复杂，你复制的代码数量也越来越多。我确信使用接口和泛型必须是可能的，但我正在努力想出一个优雅的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T13:51:33.633

只需为您的实体创建一个基类并将通用属性作为虚拟属性移至它。在您的实体中覆盖这些属性并在它们上指定 Column 属性。这是一个详细的[例子](http://blogs.msdn.com/dinesh.kulkarni/archive/2007/11/09/linq-to-sql-how-to-2-base-class-for-all-entities.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T14:04:04.447

LINQ to SQL 类只是支持 IQuery 接口的常规 .NET 类，它们将其转换为 SQL。（不完全是挥手）

您可以创建自己的 IQuery 实现并将其指向为相应表生成的 LINQ to SQL IQuery 实现。您添加一个名为“TableName”的属性并覆盖“Where”以支持它。

这个答案可能不是一个完整的解决方案，但我希望它可以为您指明正确的方向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-07T22:19:21.400

Ali 的解决方案会起作用（感谢您的输入），但在进行了更多研究后，我更喜欢的解决方案是使用接口和扩展方法的“混合”。

[http://msdn.microsoft.com/en-us/vcsharp/bb625996.aspx](http://msdn.microsoft.com/en-us/vcsharp/bb625996.aspx)

[http://mikehadlow.blogspot.com/2008/05/interface-extension-methods-mixin.html](http://mikehadlow.blogspot.com/2008/05/interface-extension-methods-mixin.html)

这有几个优点 1）我不必摆弄 VS2008 中 LINQ 类的自动生成机制来支持新的基类

2）它没有在我的 LINQ 类上强制继承层次结构，我只是在部分类声明中添加了一个接口，突然间所有这些新的共享功能都来了！

3) 如果需要，我可以将扩展方法放在他们自己的命名空间中，客户可以将它们换成其他实现。

对此方法的评论表示赞赏

# javascript - 如何将tr附加到表格顶部

> ID：683420
> 
> 赞同：4
> 
> 时间：2009-03-25T20:58:34.403
> 
> 标签：javascript, jquery

我怎样才能将新的 tr 附加到表格的顶部，而不是在其他 tr 下。

例子：

```
<table width='100%'>
<tr><td>something</td><td>else here</td></tr>
<tr><td>something2</td><td>else here2</td></tr>
</table> 
```

在 jQuery 中的单击事件之后，我如何放置 `<tr><td>something3</td><td>else here3</td></tr>` 在表格的顶部，所以它现在看起来像

```
<table width='100%'>
<tr><td>something3</td><td>else here3</td></tr>
<tr><td>something</td><td>else here</td></tr>
<tr><td>something2</td><td>else here2</td></tr>
</table> 
```

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T21:01:08.250

```
$('table').prepend('<tr><td>something3</td><td>else here3</td></tr>'); 
```

或者...

```
$('<tr><td>something3</td><td>else here3</td></tr>').prependTo('table'); 
```

* * *

有关“前置”的更多信息：http: **[//docs.jquery.com/Manipulation/prepend](http://docs.jquery.com/Manipulation/prepend)**

有关“prependTo”的更多信息：http: **[//docs.jquery.com/Manipulation/prependTo](http://docs.jquery.com/Manipulation/prependTo)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T21:12:59.890

这个 JS 目前是特定于 IE 的，但是让它与多浏览器兼容应该不会太难。

```
<html>
<body>
<script language="JavaScript">
function function1() {
   var myRow = document.all.myTable.insertRow(0);
   var myCell = myRow.insertCell();
   myCell.innerText = "The added cell"; 
} 
</script>
<table id="myTable" border="1" cellspacing="5" cellpadding="5">
   <tr>
       <td width="100">3</td>
       <td width="100">4</td>
   </tr>
   <tr>
       <td>1</td>
       <td>2</td>
   </tr>
</table>
<button onclick="function1();">Add a cell</button>
</body>
</html> 
```

# emacs - 在 Emacs 中全局覆盖键绑定

> ID：683425
> 
> 赞同：105
> 
> 时间：2009-03-25T20:59:41.420
> 
> 标签：emacs, keyboard-shortcuts

如何设置全局覆盖并优先于该键的所有其他绑定的键绑定？我想覆盖所有主要/次要模式映射并确保我的绑定始终有效。

这当然行不通：

```
(global-set-key "\C-i" 'some-function) 
```

它工作在`text-mode`，但当我使用时`lisp-mode`，`C-i`是反弹到`lisp-indent-line`。

我可以`lisp-mode`在每个其他模式中单独遍历并覆盖此绑定，但必须有一种更简单的方法。每次我为新文件类型安装新模式时，我都必须返回并检查以确保我的所有键绑定都没有被新模式覆盖。

我想这样做是因为我想模仿我已经从其他编辑器那里学到并根深蒂固的绑定。

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2009-03-25T21:36:11.147

我对所有“覆盖”键绑定使用次要模式：

```
(defvar my-keys-minor-mode-map
  (let ((map (make-sparse-keymap)))
    (define-key map (kbd "C-i") 'some-function)
    map)
  "my-keys-minor-mode keymap.")

(define-minor-mode my-keys-minor-mode
  "A minor mode so that my key settings override annoying major modes."
  :init-value t
  :lighter " my-keys")

(my-keys-minor-mode 1) 
```

这还有一个额外的好处，就是能够一举关闭我的所有修改（只需禁用次要模式），以防其他人正在驱动键盘，或者如果我需要查看默认键绑定的作用。

请注意，您可能需要在 minibuffer 中将其关闭：

```
(defun my-minibuffer-setup-hook ()
  (my-keys-minor-mode 0))

(add-hook 'minibuffer-setup-hook 'my-minibuffer-setup-hook) 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2011-03-17T14:56:11.847

作为对[scottfrazer 的回答](https://stackoverflow.com/a/683575)的补充，我编写了以下内容，以便我的键绑定保持优先级，即使随后加载的库引入了自己的新键映射。

因为键映射可以在编译时生成，`load`似乎是最好的地方。

```
(add-hook 'after-load-functions 'my-keys-have-priority)

(defun my-keys-have-priority (_file)
  "Try to ensure that my keybindings retain priority over other minor modes.

Called via the `after-load-functions' special hook."
  (unless (eq (caar minor-mode-map-alist) 'my-keys-minor-mode)
    (let ((mykeys (assq 'my-keys-minor-mode minor-mode-map-alist)))
      (assq-delete-all 'my-keys-minor-mode minor-mode-map-alist)
      (add-to-list 'minor-mode-map-alist mykeys)))) 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2014-12-12T10:39:42.410

安装[`use-package`](https://github.com/jwiegley/use-package)，评估，你就完成了：

```
(require 'bind-key)
(bind-key* "C-i" 'some-function) 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2014-05-06T16:51:24.920

我在搜索“emacs undefine org mode keybindings”时发现了这个问题，因为我想取消绑定现有的 Cc Cb 行为以允许我的全局映射埋入缓冲区以在 org 缓冲区中工作。

这最终成为我最简单的解决方案：

```
(add-hook 'org-mode-hook
      (lambda ()
        (local-unset-key (kbd "C-c C-b")))) 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-11-18T19:57:48.743

尽管 scottfrazer 的答案正是您所要求的，但我会为后代提及另一种解决方案。

来自[Emacs 手册](http://www.gnu.org/software/emacs/manual/html_node/elisp/Key-Binding-Conventions.html)：

> “不要将 Cc 字母定义为 Lisp 程序中的键。由 Cc 和字母（大写或小写）组成的序列是为用户保留的；它们是为用户保留的唯一序列，所以不要阻止它们。”

如果您将您的个人全局绑定绑定到 Cc 加一个字母，那么您“应该”是安全的。但是，这只是一个约定，任何模式仍然可以覆盖您的绑定。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-04-18T18:16:16.770

如果您想“始终使用映射中的键绑定，除非我为特定模式映射明确覆盖它们”，并假设您使用的是[scottfrazier 的方法](https://stackoverflow.com/a/683575)，您想要：

```
(defun locally-override (key cmd)
  (unless (local-variable-p 'my-keys-minor-mode-map)
    (set (make-variable-buffer-local 'my-keys-minor-mode-map)
         (make-sparse-keymap))
    (set-keymap-parent my-keys-minor-mode-map 
                       (default-value 'my-keys-minor-mode-map)))
  (define-key my-keys-minor-mode-map key cmd)) 
```

所以

```
(locally-override "\C-i" nil) 
```

应该只从当前缓冲区的次要模式中删除“\Ci”绑定。警告：这完全未经测试，但似乎是正确的方法。设置父级而不是仅仅处理 my-keys-minor-mode-map 的全局值的重点是，以后对全局值的任何更改都会自动反映在本地值中。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-25T21:06:26.053

我不认为你可以。这大致相当于说要定义一个不能被函数中的局部变量声明隐藏的全局变量。范围只是不那样工作。

但是，可能有一种方法可以编写一个 elisp 函数来遍历模式列表，并为您在每个模式列表中重新分配它。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-25T21:37:46.430

除非你真的想自己做，否则你应该检查一下，看看其他人是否已经做过。

有一个适用于 Emacs 的包，它为您提供类似 Windows 的键绑定。你应该可以通过谷歌找到它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-10-29T19:48:54.817

> 在 Emacs 27 中，有`override-global-map`. 然后，您可以执行以下操作：
> 
> ```
> (define-key override-global-map (kbd "M-h") 'backward-kill-word) 
> ```

这个答案不对，不好意思。

# .net - 奇怪的 .NET 正则表达式问题

> ID：683426
> 
> 赞同：0
> 
> 时间：2009-03-25T21:00:12.107
> 
> 标签：.net, regex, validation

给定以下 RegEx 表达式，在 regexlib.com 上使用字符串“2rocks”对其进行测试会产生“匹配”。但是，在我的 .NET 应用程序中，它会导致正则表达式验证器引发验证错误。

```
^(?=.*[A-Za-z])[a-zA-Z0-9@\-_\+\.]{6,32}$ 
```

如果我在我的应用程序和 regexlib.com 中将字符串更改为“rocks2”，我会在两个地方都得到匹配。

目标是有一个正则表达式，要求字符串长度在 6-32 个字符之间，并允许 AZ、az、数字和其他特殊字符包含在正则表达式中，强制至少一个字母。

这是 ASP 标记，我完全糊涂了。

```
<asp:regularexpressionvalidator 
    id=vldRegEx_LoginID 
    runat="server" 
    ErrorMessage="Regex Error Message" 
    Display="Dynamic" 
    ControlToValidate="txtLoginID" 
    ValidationExpression="^(?=.*[A-Za-z])[a-zA-Z0-9@\-_\+\.]{6,32}$">
        <img src="images/error.gif" border="0">
 </asp:regularexpressionvalidator> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T21:03:58.417

您传递的 ValidationExpression 实际上是用作客户端 javascript 正则表达式的表达式。Javascript 正则表达式不支持 .NET 正则表达式的所有功能，这就是您遇到问题的原因。你有两个选择：

*   关闭客户端验证并仅使用服务器端验证（在验证器上设置 EnableClientScript=false）
*   将正则表达式重写为有效的 javascript 正则表达式（javascript 正则表达式测试器：[http](http://regexpal.com/) ://regexpal.com/ ）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T00:25:47.900

你可能被[这个虫子](http://regexadvice.com/blogs/mash/archive/2009/02/21/Looking-again-at-the-Lookahead-bug.aspx)咬了。JavaScript RegExp 中应避免前瞻断言。

# java - 从 Java 以最小化状态启动应用程序

> ID：683427
> 
> 赞同：5
> 
> 时间：2009-03-25T21:00:59.390
> 
> 标签：java, windows

这是我之前提出的问题的后续问题：

[启动程序如果尚未在 java 中运行](https://stackoverflow.com/questions/660205/start-program-if-not-already-running-in-java "启动程序如果尚未在 java 中运行")

我在那里没有得到很好的解决方案（因为似乎没有），但我有一个相关的问题：

有没有用 Java 代码启动应用程序（Windows 中的 .exe，而不是 Java 应用程序）并开始最小化？或者也许在开始后立即将其最小化？这将解决另一个问题的焦点问题，并且已经运行的问题或多或少会自行解决。

再次澄清问题：Java 客户端和 .exe 在 Windows 中运行，我真的没有能力编写任何包装器或使用 JNI mojo 或类似的东西。我或多或少需要一个纯 Java 解决方案。

再次感谢您的帮助，我非常愿意接受一个简单的答案：“这是不可能的。”

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-25T21:26:37.427

仅限 Windows：

```
public class StartWindowMinimized {

  public static void main(String[] args) throws IOException {
    if (args.length != 1) {
      System.err
          .println("Expected: one argument; the command to launch minimized");
    }
    String cmd = "cmd.exe /C START /MIN ";
    Runtime.getRuntime().exec(cmd + args[0]);
  }

} 
```

示例用法：

```
java -cp . StartWindowMinimized notepad.exe
java -cp . StartWindowMinimized cmd.exe 
```

要理解所涉及的论点：

```
cmd /?
START /? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T21:08:48.187

我对 Java 的细节不是很熟悉，但是根据我刚刚查看的一个网站，如果您使用的是 java.awt.Frame（包括 Swing 中的 JFrame），您应该使用该框架之外的函数称为 setState，它接受 Frame.ICONIFIED 和 Frame.NORMAL 作为参数（图标化将是最小化状态）。

[如何最小化 Java 应用程序窗口？](http://www.jguru.com/faq/view.jsp?EID=53754)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T21:16:38.807

如果这些应用程序具有使它们开始最小化的命令行开关，那么您可以轻松使用它们。否则，我不能 100% 确定，但我非常怀疑这是可能的。您必须有某种方式与 Windows 窗口管理器交互，它本质上是非常特定于平台的，因此 Java 不太可能包含它。总是有可能有人编写了第三方库来处理该任务，但对我来说似乎不太可能。

# ado.net - 补充 ADO.net 实体数据模型中的实体

> ID：683433
> 
> 赞同：0
> 
> 时间：2009-03-25T21:02:09.607
> 
> 标签：ado.net, ado.net-entity-data-model, partial-classes

（玩弄 MVC 框架）我创建了一个 ADO.net 实体数据模型。现在我想用一些业务逻辑来扩展它，比如创建返回上下文子集的函数。部分类与数据模型一起创建，因此我创建了一个新文件来声明部分类，如下所示：

我在其中放置了一个名为 GetMovieById(int id) 的函数，结果如下所示：

```
namespace RecordStore.Models
{
    public partial class MovieDBEntities
    {
        public Movie GetMovieById(int id)
        {
            Movie movie = MovieSet.First(m => m.id == id);
            return movie;
        }

    }
} 
```

在启动项目之前，我没有收到任何错误，然后错误是：

> 编译器错误消息：CS1061：“RecordStore.Models.MovieDBEntities”不包含“MovieSet”的定义，并且找不到接受“RecordStore.Models.MovieDBEntities”类型的第一个参数的扩展方法“MovieSet”（您是否缺少使用指令还是程序集引用？）

我不明白这个错误，因为部分类的另一部分包含 MovieSet。我的问题基本上是，如果这不是扩展数据模型的方式，那将是什么方式，如果是这样，我为什么会收到这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T21:10:21.207

我将把这是否是一项好技术的问题留给其他人。但是，考虑到编译错误，您确定上面的部分类和模型生成的类在同一个确切的命名空间中吗？

# c# - 如何在 C# 中深度克隆互连对象？

> ID：683435
> 
> 赞同：5
> 
> 时间：2009-03-25T21:02:43.253
> 
> 标签：c#, clone

**深度**克隆一组相互关联的对象的最佳方法是什么？例子：

```
class A {
    B theB; // optional
    // ...
}

class B {
    A theA; // optional
    // ...
}

class Container {
    A[] a;
    B[] b;
} 
```

显而易见的事情是遍历对象并深入克隆所有内容。然而，这会产生一个问题——如果我克隆一个`A`包含 a`B`并且`B`也在 中的`Container`，那么`B`在我克隆`Container`.

下一个合乎逻辑的步骤是在克隆它之前创建`Dictionary`并查找每个对象。然而，这似乎是一个缓慢且不优雅的解决方案。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T21:09:58.027

您建议的字典解决方案是我所知道的最好的。为了进一步优化，您可以使用`object.GetHashCode()`获取对象的哈希值，并将其用作字典键。除非您谈论的是巨大的对象树（数千个对象的 10 到 100 多个），否则应该很快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T21:10:54.733

并不是说我熟悉 C#，但通常任何类型的图形爬行以进行某种处理都需要查找表来停止处理由于循环引用而导致的对象。所以我认为你需要在这里做同样的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T21:11:08.773

它肯定不是一个优雅的解决方案，但使用字典（或哈希图）并不少见。好处之一是哈希图具有恒定的查找时间，因此速度在这里并没有真正受到影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T21:11:59.347

可能会创建一个位标志来指示此对象之前是否已被克隆。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T21:30:37.603

您可以研究的另一种可能的解决方案是将对象序列化为流，然后将它们从同一流重构为新实例。当其他一切看起来非常复杂和混乱时，这通常会产生奇迹。

马克

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-08T04:44:47.643

进行深度克隆的一种实用方法是序列化然后反序列化源图。.NET 中的一些序列化程序[`DataContractSerializer`](https://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer(v=vs.110).aspx)甚至[能够处理图中的循环](https://msdn.microsoft.com/en-us/library/vstudio/hh241056(v=vs.100).aspx)。您可以通过查看[功能比较表](http://manski.net/2014/10/net-serializers-comparison-chart/)来选择最适合您的场景的序列化程序。

# c++-cli - 使用 C++/CLI 的 Offsetof 宏

> ID：683437
> 
> 赞同：2
> 
> 时间：2009-03-25T21:03:13.550
> 
> 标签：c++-cli

offsetof 宏似乎在 C++/CLI 下不起作用。

这在非托管 C++ 中运行良好，但在 CLI 中引发“错误 C2275: 'Entity' :illegal use of this type as an expression”错误。

```
struct Property{
     char* label;
     PropertyTypes type;
     unsigned int member_offset;
     unsigned int position;
     unsigned char bit_offset;
};

struct Entity{
     ...
     bool transparent;
     ...
};

Property property = {"Transparent",     
       TYPE_BOOL,       
       offsetof(Entity, transparent), 
       0, 
       0}; // C2275 HERE 
```

CLI 有替代品吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T10:48:13.503

我的猜测是编译器消息归结为：“offsetof”不是一个已知的宏，如果它是一个函数，它的参数不能包含类型名。

**编辑**：正如评论中有人指出的那样，*offsetof*实际上是标准库的一部分。所以缺少的可能只是

```
#include <cstddef> 
```

或者，您可以使用此宏实现（取自 Win32/MFC 标头）：

```
#ifdef _WIN64
    #define OFFSET_OF( s, m )\
      (size_t)((ptrdiff_t)&reinterpret_cast<const volatile char&>((((s*)0)->m)) )
#else
    #define OFFSET_OF( s, m )\
      (size_t)&reinterpret_cast<const volatile char&>((((s*)0)->m))
#endif 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T10:46:48.640

标准 C++ 已经有了替代方案；`&Entity::transparent`. 在重新设计 Propery 类时，您可能希望使用模板。指向成员的指针的类型很重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T21:17:44.840

您需要提供要分配的对象的类型。看起来有问题的成员存在一些类型不匹配。

有关示例用法，请参阅[此](http://www.google.co.in/codesearch/p?hl=en#hYTbqUs1GvU/psycopg-1.1.21/typemod.c&q=offsetof)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T10:29:15.313

只是在黑暗中拍摄，没有机会仔细检查 - 应该

```
offsetof(Entity, transparent), 
```

也许宁愿读

```
 offsetof( struct Entity, transparent ), 
```

？？？

# php - 正在接收通过 php5+htmlMimeMail 发送的电子邮件，其中随机字符替换为 =

> ID：683445
> 
> 赞同：2
> 
> 时间：2009-03-25T21:04:46.930
> 
> 标签：php, email, unicode, outlook, mime

目前使用 PHP5 和 htmlMimeMail 5 ( [http://www.phpguru.org/static/mime.mail.html](http://www.phpguru.org/static/mime.mail.html) ) 来发送 HTML 电子邮件通信。许多收件人看到随机字符替换为等号时遇到问题，例如：

“早上好=ing。我们学校正在通过一家名为...的公司发送我们的时事通讯=和信息。”

已将电子邮件文本、HTML 和标头编码设置为 UTF-8。PHP 为电子邮件加载的模板文件（仅包含（）的文本/HTML，其中包含一些 php 标签）都以 UTF-8 编码。

有趣的是，我无法在我的任何电子邮件客户端上复制该问题，并且无法通过搜索 yahoo/googlies 找到任何指向我问题的信息！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T21:21:50.633

尝试使用 8 位编码发送：

```
$message->setTextEncoding(new EightBitEncoding());
$message->setHTMLEncoding(new EightBitEncoding()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-11T03:34:53.477

我有一个类似的问题，但我的有点不同。由于我偶然发现了这个线程来寻找答案并且它帮助我找到了它，我想我不妨在这里发布这个相关的答案。

在我的情况下，即使发送的文本字符串的实际 mb_detect_encoding 是“UTF-8”，电子邮件中的特殊字符也会变得混乱，如果我回显它们，它们看起来还不错。

所以我不得不给我们这个功能

```
$message->setTextCharset('UTF-8') 
```

和

```
$message->setHTMLCharset('UTF-8') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T21:29:45.343

我怀疑您的问题与旧版本的 Exchange 有关。[等号在行尾](http://www.expita.com/nomime.html#equalsign)：

它可能不是带有高/低顺序字符或编码的引用可打印内容。此外，在该页面的其他地方它说：

> **注意：**在禁用富文本邮件时，Exchange 中的一个错误（“功能”？）可能会导致换行被等号替换。

# linq - 如何扩展 ADO.NET 实体设计器？

> ID：683446
> 
> 赞同：1
> 
> 时间：2009-03-25T21:04:47.027
> 
> 标签：linq, linq-to-entities, ado.net-entity-data-model

有谁知道如何扩展，即向 Visual Studio 中的实体设计器添加功能？

例如，我想在设计器上右键单击实体的属性，并在上下文菜单上有一个新选项，允许我做任何我想做的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-30T03:50:07.530

VS 2008 SP1 中的实体设计器没有很多可扩展性挂钩。您可以做的是利用 Visual Studio 可扩展性（VSIP，现在称为 VSX）：

1.  添加[您自己的上下文菜单](http://www.codeproject.com/KB/macros/addingmenuitems.aspx)
2.  使用[IVsMonitorSelection 获取当前选择](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.shell.interop.ivsmonitorselection.getcurrentselection.aspx)，从中可以获取 ISelectionContainer。
3.  如果用户选择了图表表面，则可以将 ISelectionContainer 转换为[DiagramDocView](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.modeling.shell.diagramdocview(VS.100).aspx)。这是“DSL”的一部分，它是实体设计器用于其设计器表面的框架。
4.  从这里您可以在 DiagramDocView 中做很多事情。DiagramDocView.CurrentDiagram 将为您提供[图表](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.modeling.diagrams.diagram.aspx)对象。您可以调用 Diagram.NestedChildShapes 来获取图表中的所有形状。要更改图表，您必须创建 DSL 事务并对事务中的形状进行编辑。这只是实体设计器之上的另一个层次，一切都将得到正确处理：

    ```
    using (Transaction tx = store.TransactionManager.BeginTransaction(txText))
    {
       // do something, such as creating an EntityTypeShape;
       tx.Commit();
    } 
    ```

VS 2010 中的实体设计器将有更多的可扩展性挂钩，允许您通过属性窗口或向导来影响模型。新的“模型优先”功能中的新可扩展性工作基本上允许您以可组合的方式从 Visual Studio 中的模型生成任何内容。

# css - CSS 图像缓存

> ID：683450
> 
> 赞同：1
> 
> 时间：2009-03-25T21:05:28.117
> 
> 标签：css, image-caching

在客户端图像缓存方面，以下之间是否存在差异：

```
**Option #1**
<div style="background:url('myimage.jpg');display:none;"></div> 
```

和

```
**Option #2**
<div id="myimage"></div>

style.css
#myimage {
     background:url('myimage.jpg');
     display:none;
} 
```

编辑：我不确定它是否重要，但上面的 DIV 首先加载到另一个页面上， style="display:none;"

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T21:07:04.273

不，客户端缓存由图像请求中从服务器返回的标头控制，而不是 css。

顺便说一句，如果您正在寻找图像缓存，我强烈建议您使用 CDN。[亚马逊的 CloudFront](http://aws.amazon.com/cloudfront/)使这变得简单且便宜。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T21:11:32.860

不。另外请注意，某些浏览器不会缓存隐藏元素中的图形（无论您是直接隐藏它们还是隐藏它们的父元素之一）。

# wcf - 从 WCF 服务中的请求流中读取 Http Cookie

> ID：683455
> 
> 赞同：2
> 
> 时间：2009-03-25T21:06:49.533
> 
> 标签：wcf

必须配置哪些设置以允许从 WCF 服务中的 Http 请求对象检索 Http cookie。我正在使用基本的 Http 绑定。我设置了 aspNetCompatibilityEnabled = true 和 allowCookies="true"。请指教。我确定 cookie 存在正确的域。我创建了一个 .aspx 测试页面，它直接调用我的实用程序并返回 cookie 值，但调用包装在服务中的相同代码不会返回值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-03-18T05:04:08.107

你正在用吗 ：

`HttpContext.Current.Request.Cookies["CookieName"]`?

如果您正在使用它，那么没有问题。并确保没有拼写错误。

如果您使用表单身份验证，则必须传递令牌进行身份验证。

# javascript - 集成 Python 和 JavaScript 的最佳方式？

> ID：683462
> 
> 赞同：71
> 
> 时间：2009-03-25T21:08:11.837
> 
> 标签：javascript, python, brython, transcrypt, rapydscript

是否可以集成 Python 和 JavaScript？例如，假设您希望能够在 JavaScript 中定义类并在 Python 中使用它们（反之亦然）。如果是这样，最好的方法是什么？我不仅对这是否可能感兴趣，而且对是否**有人在“严肃”项目或产品中完成它**感兴趣。

我猜想使用[Jython](http://www.jython.org/Project/)和[Rhino](http://www.mozilla.org/rhino/)是可能的，例如，但我很好奇是否有人真的这样做过，以及是否有其他平台的解决方案（尤其是[CPython](http://en.wikipedia.org/wiki/CPython)）。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-25T22:00:23.007

[pyjs](http://pyjs.org/)怎么样？

从上面的网站：

> pyjs 是一个适用于 Web 和桌面的富 Internet 应用程序 (RIA) 开发平台。使用 pyjs，您可以完全用 Python 编写基于 JavaScript 的 Web 应用程序。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-25T21:13:09.393

这里有一些东西，一个围绕 SeaMonkey Javascript 解释器的 Python 包装器...... [http://pypi.python.org/pypi/python-spidermonkey](http://pypi.python.org/pypi/python-spidermonkey)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2016-08-23T08:25:03.707

这个问题并不年轻，但已经提出了一些替代方案：

*   “ [Skulpt](http://www.skulpt.org)是一个*完全在浏览器中*实现的 Python。”
*   [Brython](https://www.brython.info) -“用于客户端 Web 编程的 Python 3 实现”
*   [RapydScript](http://www.rapydscript.com) - “没有额外开销或怪癖的类似 Python 的 JavaScript”
*   [Transcrypt](http://www.transcrypt.org) - “精益求精的 Python 3.6 到具有多重继承、源映射、静态类型检查和选择性运算符重载的 JavaScript 编译器。” （也在[Github 上](https://github.com/JdeH/Transcrypt)）

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-04-08T18:18:28.083

有两个项目允许在 python 对象和 javascript 对象之间进行“明显”转换，从 int 或 float 到 Number 和 str 或 unicode 到 String 的“明显”转换：[PyV8](http://code.google.com/p/pyv8)，正如一位作者已经提到的：[python-spidermonkey](http://pypi.python.org/pypi/python-spidermonkey)。

pyv8 实际上有两种实现——最初的实验是由 sebastien louisel 完成的，第二个（正在积极开发中）是由 flier liu 完成的。

我对这些项目的兴趣是将它们链接到[pajamas](http://pyjs.org)，一个 python-to-javascript 编译器，以创建一个 JIT python 加速器。

所以那里有很多 - 这只是取决于你想做什么。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-25T23:26:03.800

如果您只是对在 javascript 和 python 之间共享复杂的数据类型感兴趣，请查看[jsonpickle](http://jsonpickle.googlecode.com/svn/docs/index.html)。它包装了标准的 Python JSON 库，但在序列化和反序列化 Python 类和其他数据类型方面具有一些智能。

相当多的 Google App Engine 项目使用了这个库。 [Joose](http://code.google.com/p/joose-js/)和[FirePython](http://github.com/darwin/firepython/tree/master)都包含 jsonpickle。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-08-01T17:24:22.937

[PyExecJS](https://pypi.python.org/pypi/PyExecJS)能够使用 PyV8、Node、JavaScriptCore、SpiderMonkey、JScript 中的每一个。

```
>>> import execjs
>>> execjs.eval("'red yellow blue'.split(' ')")
['red', 'yellow', 'blue']
>>> execjs.get().name
'Node.js (V8)' 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-25T21:47:03.523

有一个基于 JavaScriptCore（来自 WebKit）的桥，但它非常不完整： [http ://code.google.com/p/pyjscore/](http://code.google.com/p/pyjscore/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-26T03:01:25.513

您可能还想查看 PyPy 项目 - 他们有一个 Python 到（任何）编译器，包括 Python 到 Javascript、C 和 llvm。这使您可以用 Python 编写代码，然后根据需要将其编译为 Javascript。

[http://codespeak.net/pypy](http://codespeak.net/pypy)

另外，查看内容丰富的博客：

[http://morepypy.blogspot.com/](http://morepypy.blogspot.com/)

不幸的是，您不能以这种方式将 Javascript 转换为 Python。总的来说，它似乎工作得很好，他们曾经有一个 Javascript（由编译的 Python 制成）版本的 Bub'n'Bros 在线游戏（尽管服务器已经关闭了一段时间）。

[http://bub-n-bros.sourceforge.net](http://bub-n-bros.sourceforge.net)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-12-13T15:08:56.953

使用[Js2Py](https://github.com/PiotrDabkowski/Js2Py)将 JavaScript 转换为 Python，这是唯一可用的工具 :)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2021-07-23T10:15:05.010

许多示例已经过时多年，并且涉及复杂的设置。你可以试试[JSPyBridge](https://github.com/extremeheat/JSPyBridge/)（完全披露：我是作者）。

它是一个双向桥梁，可让您使用 Python 中的 JavaScript 代码，反之亦然。也就是说 Python 代码可以调用 JS 回调，而 JS 代码可以调用 Python 回调。

使用 ES6 导入系统从 JS、numpy + matplotlib 示例访问 Python：

```
import { py, python } from 'pythonia'
const np = await python('numpy')
const plot = await python('matplotlib.pyplot')

// Fixing random state for reproducibility
await np.random.seed(19680801)
const [mu, sigma] = [100, 15]
// Inline expression evaluation for operator overloading
const x = await py`${mu} + ${sigma} * ${np.random.randn(10000)}`

// the histogram of the data
const [n, bins, patches] = await plot.hist$(x, 50, { density: true, facecolor: 'g', alpha: 0.75 })
console.log('Distribution', await n) // Always await for all Python access
await plot.show()
python.exit() 
```

通过 CommonJS（没有顶级等待）：

```
const { py, python } = require('pythonia')
async function main() {
  const np = await python('numpy')
  const plot = await python('matplotlib.pyplot')
  ...
  // the rest of the code
}
main().then(() => python.exit()) // If you don't call this, the process won't quit by itself. 
```

从 python 访问 JS：

```
from javascript import require, globalThis

chalk, fs = require("chalk"), require("fs")

print("Hello", chalk.red("world!"), "it's", globalThis.Date().toLocaleString())
fs.writeFileSync("HelloWorld.txt", "hi!") 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-01-25T00:27:57.870

你也可以`XPCOM`在`XUL`Firefox、Thunderbird 或 Komodo 等基于应用程序中使用 .

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-11-18T11:27:41.653

前段时间我在玩 Pyjon，似乎设法直接在 Python 中编写 Javascript 的 eval 并运行简单的程序......虽然它不是 JS 的完整实现，而是一个实验。在这里获取：

[http://code.google.com/p/pyjon/](http://code.google.com/p/pyjon/)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-03-15T12:01:03.223

上面提到的这些项目中有许多已经死亡或濒临死亡，缺乏作者方面的活动和兴趣。有趣的是关注这个领域的发展。

作为记录，在基于插件的实现时代，KDE 阵营试图用插件和非语言特定的方式解决这个问题，并创建了 Kross [https://en.wikipedia.org/wiki/Kross_(software)](https://en.wikipedia.org/wiki/Kross_(software)) - 在我的理解它甚至在社区内部也从未起飞。

在这个先有鸡还是先有蛋的问题时期，基于 javascript 的实现肯定是要走的路。也许将来我们会在浏览器中看到纯粹、干净、完整的 Python 支持。

# java - FopFactory.newInstance() 命令上的 Apache fop-0.95 错误

> ID：683465
> 
> 赞同：0
> 
> 时间：2009-03-25T21:08:38.093
> 
> 标签：java, apache, apache-fop

```
I am using Apache fop-0.95 to build pdf files from a JSP web application on IBM iSeries V5R4 using Websphere 6.0\.  Everything works perfect in my development using Websphere Development Studio client.  When I put the application on the server, I get an error at this line.

    FopFactory fopFactory = FopFactory.newInstance();

The error is:

    java.lang.UnsatisfiedLinkError: javax/imageio/ImageIO

Does anyone know how I can fix this error?

All of the fop class files are part of the EAR file.  The files were installed to the projects \WEB-INF\lib directory.  I have added the fop jar files to the classpath, using the admin console. 

I am running IBM WebSphere Application Server - Express, 6.0.2.9 
```

内部版本号：IBM iSeries V5R4 上的 cf90614.22

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T07:06:27.127

这是一个低于 Java 类路径的问题。一些库可能会丢失。由于您提到了 iSeries，因此可能缺少 PASE（[http://www-03.ibm.com/servers/enable/site/porting/iseries/pase/overview.html ）。](http://www-03.ibm.com/servers/enable/site/porting/iseries/pase/overview.html)另见： [http ://ecommunity.groupintelligence.com/websphere/forums/archive/index.php/t-1932.html](http://ecommunity.groupintelligence.com/websphere/forums/archive/index.php/t-1932.html)

# java - 使用 NetBeans 检查实时 Java 对象？

> ID：683467
> 
> 赞同：0
> 
> 时间：2009-03-25T21:08:57.187
> 
> 标签：java, debugging, netbeans

在 Python 中，我习惯于能够在代码中的任何位置启动调试器，然后查看活动对象（调用方法，诸如此类）。有没有办法使用 NetBeans 来做到这一点？

例如，我希望能够在线路上休息并`foo = bar().baz().blamo()`运行`bar()`，看看他们做了什么。`bar().baz()``bar().baz().blamo()`

在 Python 中，我会这样做：

```
...
import pdb; pdb.set_trace()
foo = bar().baz().blamo() 
```

然后它会给我一个提示，我可以在其中输入内容：

```
(pdb) bar()
... some objet ...
(pdb) bar() + 42
... 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T21:13:58.470

首先，在该代码行设置断点（通过单击左边距）。然后单击“调试主项目”（或“调试”菜单中的“调试单个文件”）。

命中断点后，您可以使用“调试”菜单中的工具。特别是，“评估表达式”似乎是您正在寻找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T01:17:08.480

在调试器中使用“Watches”视图。在那里你可以添加一些东西来“观察”，比如变量或表达式。

因此，如果您有一个“foo”对象，您可以执行诸如监视“foo.bar()”之类的操作并让它调用该方法。

我不知道任何具有真正“便签本”之类的 Java 调试器，但可能有一个。“手表”与我发现的 Netbeans 中的“手表”差不多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-31T12:02:19.423

如果您在调试模式下运行并设置了调试指针，则

**（左上角）调试 --> 评估表达式**[放置你的表达式并运行]

# java - 将 XOM 与 NetBeans 一起使用

> ID：683476
> 
> 赞同：0
> 
> 时间：2009-03-25T21:11:33.577
> 
> 标签：java, netbeans, netbeans6.5, xml-parsing, xom

我正在尝试安装 XOM，以便可以在我的 Java 应用程序中使用它。唯一的问题是，我不知道我可以将它放在哪里以便 NetBeans 可以找到它。将它放在其他 .classes 文件所在的位置是有意义的，但我似乎也找不到它们。

XOM 的 README 文件说要将它安装到 Classpath 变量，但我不知道那是什么。

那么，如何安装 XOM，什么是“Classpath”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T20:38:37.767

您可以使用 NetBeans 库管理器（工具|库）创建一个新库，将 Xom jar 文件（和所有依赖项）添加到其中并在新的 Java 项目中使用该库。为此，请使用项目的“属性”对话框，导航到库页面，然后使用“添加库...”选择新的 Xom 库

# datacontractserializer - 在反序列化期间使用 DataContractSerializer 获取父对象

> ID：683485
> 
> 赞同：0
> 
> 时间：2009-03-25T21:14:08.797
> 
> 标签：datacontractserializer

或多或少与[此问题](https://stackoverflow.com/questions/353558/)相同，但针对 DataContractSerializer 而不是 Serializable。

我明确不想序列化父引用。

另外，我真的希望在构造子对象之前绑定对象的父对象。

顺便说一句：如果这有什么不同，我正在使用 XML

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-02-03T19:30:49.727

如果您知道子类型的宇宙，您可以实现一个代理来特殊情况下的非子类型，并在序列化期间基本上“跳过”父（即非子）类型。例如，请参阅[http://msdn.microsoft.com/en-us/library/ms751540.aspx](http://msdn.microsoft.com/en-us/library/ms751540.aspx) [Data Contract Surrogate] 示例。另一种选择——如果你现在使用 WCF 4——是使用 DataContractResolver 进行类型解析和重定向。再次，请参阅[http://msdn.microsoft.com/en-us/library/dd807504.aspx](http://msdn.microsoft.com/en-us/library/dd807504.aspx) [Data Contract Resolve Sample] 以供参考！

干杯。

# javascript - javascript 到 actionscript 按键传递实用程序？

> ID：683486
> 
> 赞同：4
> 
> 时间：2009-03-25T21:14:45.113
> 
> 标签：javascript, flash, actionscript-3, actionscript

是否有现有的 javascript 库用于将浏览器（或某些 div）中的按键事件中继到 flash 中？我希望可能有一个[类似于鼠标滚轮事件](http://hasseg.org/blog/?p=138)的库？

像[这样](http://www.openjs.com/scripts/events/keyboard_shortcuts/)的东西可以很好地处理 javascript 键盘快捷键。我想我可以只听那些事件并将我想要的事件传递给闪存？

* * *

**编辑：**这些都是很好的例子，但是，如果 flash 有焦点，那么 javascript 击键就会丢失。如何确保所有关键事件都通过 javascript？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T01:43:49.973

这是另一个使用 jQuery 的示例。[你可以在这里](http://sorinvasilescu.ro/keycode/)看到某种演示。它跟踪从浏览器到文本框的按键。

您的 JavaScript 将是

```
var altPressed = false;
    var ctrlPressed = false;

    function getFlashMovie(movieName) 
    {
        var isIE = navigator.appName.indexOf("Microsoft") != -1;
        return (isIE) ? window[movieName] : document[movieName];
    }

    function sendCode(code) {
        movie = getFlashMovie('keyboard-listener');
        movie.keyEvent(code);
    }

    function activeKey(e) {
        e.preventDefault();
        if (e.which == 18) altPressed = true;
        if (e.which == 17) ctrlPressed = true;
        if ((e.which != 18)&&(e.which != 17)) sendCode((altPressed?'alt+':'')+(ctrlPressed?'ctrl+':'')+String.fromCharCode(e.which));
    }

    function inactiveKey(e) {
        if (e.which == 18) altPressed = false;
        if (e.which == 17) ctrlPressed = false;
    }

    $(document).ready(function() {
        $(document).keydown(activeKey);
        $(document).keyup(inactiveKey);
    }); 
```

在 Flash 电影中，您将拥有以下代码：

```
ExternalInterface.addCallback('keyEvent',keyEvent);

function keyEvent(code:String):void {
    // do something with the "code" parameter, that looks like "alt+ctrl+D", may use .split('+'), etc
} 
```

您需要在 html 文件中导入[jQuery ，仅此而已。](http://jquery.com/)jQuery 是跨浏览器的，所以不会出现问题。在 Safari、Firefox 和 Opera (OSX) 上测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T01:24:18.493

这是一个使用[SWFObject](http://blog.deconcept.com/swfobject/) / javascript / AS3 + ExternalInterface 的示例它可能会使用一些适应来跨浏览器工作。我只在FF3（OSX）上试过。

首先是一个包含简单日志字段（用于跟踪）的文档类。

它只是定义了一个 ExternalInterface 回调来监听名为***flashLog***的方法调用，该方法调用将由私有方法***setMessage(...params)处理***

```
package  
{
    import flash.display.Sprite;
    import flash.display.StageAlign;
    import flash.display.StageScaleMode;
    import flash.external.ExternalInterface;
    import flash.text.TextField;        

    public class KeyStroke extends Sprite 
    {

        private var tf:TextField;

        public function KeyStroke()
        {
            stage.scaleMode = StageScaleMode.NO_SCALE;
            stage.align = StageAlign.TOP_LEFT;

            tf = addChild(new TextField()) as TextField;    
            tf.autoSize = 'left';

            if(ExternalInterface.available)
            {
                if(ExternalInterface.addCallback("flashLog", setMessage))
                {   
                    tf.text = "addCallback() failed :(";
                }
                else
                {   
                    tf.text = "flash waiting";
                }
            }
            else
            {
                setMessage("ExternalInterface not available!");
            }
        }

        private function setMessage(...params):void
        {
            tf.text = "message : " + params.toString();
        }
    }
} 
```

通过添加**allowScriptAccess属性的**[SWFObject](http://blog.deconcept.com/swfobject/)嵌入导出的 SWF ，您还需要提供一个 id，以便我们可以进一步定位 SWF（在本例中为“ ***myMovie*** ”）：

 ***```
var so = new SWFObject('KeyStroke.swf', 'myMovie', '800', '100', '9', '#f0f0f0');
so.addParam("allowScriptAccess","always");
so.write('content'); 
```

创建一个 javascript 函数来处理按键：

```
<script type="text/javascript">

function keyPressHandler(e)
{
    // Calls the registered callback within the flash movie
    getMovie('myMovie').flashLog("Key Down!"+e.charCode)
}

function getMovie(movieName) {
    return document.getElementById(movieName);
}
</script> 
```

以某种方式注册 keyPressHandler （原型等有更好的方法）：

```
<body onKeyPress="keyPressHandler(event);" > 
```

应该是这样的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-31T16:07:20.480

用 alt/option 键替换了 ctrl，但它不处理 mac 上的选项：

这有效：//仅在浏览器中有效：//在 SAFARI 4.0 Mac 和 Firefox 3.5 Mac 上测试

```
function onKey_Up(e:KeyboardEvent):void {
    tf2.appendText("\n"+e.keyCode)

    //alt+C
    if(e.keyCode==231){
        tf2.appendText("\nALT + C")
    }
    //alt+V
    if(e.keyCode==175){
        tf2.appendText("\nALT + V")
    }
    //alt+X
    if(e.keyCode==188){
        tf2.appendText("\nALT + X")
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-10T22:02:07.180

当 SWF 具有焦点时，您可以在动作脚本中监听按键。如果您愿意，您也可以将它们发送到 Javascript。

```
addEventListener(KeyboardEvent.KEY_DOWN, onKeyDown);

private function onKeyDown(e:KeyboardEvent):void 
{
   // handle key down,
} 
```

# matlab - 在 MATLAB 中从矩阵中删除元素的最有效/最优雅的方法是什么？

> ID：683488
> 
> 赞同：10
> 
> 时间：2009-03-25T21:15:26.767
> 
> 标签：matlab, matrix, delete-record

我想从矩阵中删除几个特定值（如果它们存在）。矩阵中的值很可能存在多个副本。

例如，考虑一个 N×2 矩阵`intersections`。如果成对的值`[a b]`和`[c d]`作为该矩阵中的行存在，我想删除它们。

假设我想删除以下矩阵中的`[-2.0 0.5]`行：`[7 7]`

```
intersections =

   -4.0000    0.5000
   -2.0000    0.5000
    2.0000    3.0000
    4.0000    0.5000
   -2.0000    0.5000 
```

所以删除后我得到：

```
intersections = 

   -4.0000    0.5000
    2.0000    3.0000
    4.0000    0.5000 
```

最有效/最优雅的方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-25T22:28:34.390

试试这个单线（其中**A**是您的交集矩阵，**B**是要删除的值）：

```
A = [-4.0 0.5;
     -2.0 0.5;
      2.0 3.0;
      4.0 0.5;
     -2.0 0.5];
B = [-2.0 0.5];
A = A(~all(A == repmat(B,size(A,1),1),2),:); 
```

然后只需为要删除的每个新**B重复最后一行。**

**编辑：**

...这是另一种选择：

```
A = A((A(:,1) ~= B(1)) | (A(:,2) ~= B(2)),:); 
```

**警告：**此处的答案最适用于不期望出现小浮点错误的情况（即整数值）。如本[后续问题](https://stackoverflow.com/questions/686439/why-is-24-0000-not-equal-to-24-0000-in-matlab)所述，使用“==”和“~=”运算符可能会导致不需要的结果。在这种情况下，应修改上述选项以使用关系运算符而不是相等运算符。例如，我添加的第二个选项将更改为：

```
tolerance = 0.001;   % Or whatever limit you want to set
A = A((abs(A(:,1)-B(1)) > tolerance) | (abs(A(:,2)-B(2)) > tolerance),:); 
```

只是快速抬头！=)

* * *

**一些基本的时间安排：**

如果有人*真的*对效率感兴趣，我只是为三种不同的方法获取矩阵的子索引（我上面列出的两个选项和[Fanfan 的](https://stackoverflow.com/questions/683488/matlab-whats-the-most-elegant-efficient-way-to-delete-known-elements-in-a-mat/684003#684003)STRMATCH 选项）做了一些简单的计时：

```
>> % Timing for option #1 indexing:
>> tic; for i=1:10000, index = ~all(A == repmat(B,size(A,1),1),2); end; toc;
Elapsed time is 0.262648 seconds.
>> % Timing for option #2 indexing:
>> tic; for i=1:10000, index = (A(:,1) ~= B(1)) | (A(:,2) ~= B(2)); end; toc;
Elapsed time is 0.100858 seconds.
>> % Timing for STRMATCH indexing:
>> tic; for i=1:10000, index = strmatch(B,A); end; toc;
Elapsed time is 0.192306 seconds. 
```

如您所见，STRMATCH 选项比我的第一个建议要快，但我的第二个建议是三个建议中最快的。但是请注意，我的选项和 Fanfan 的做法略有不同：我的选项返回要*保留*的行的逻辑索引，而 Fanfan 的返回要*删除*的行的线性索引。这就是 STRMATCH 选项使用以下形式的原因：

```
A(index,:) = []; 
```

而我的使用表格：

```
A = A(index,:); 
```

但是，可以否定我的索引以使用第一种形式（要*删除*的索引行）：

```
A(all(A == repmat(B,size(A,1),1),2),:) = [];    % For option #1
A((A(:,1) == B(1)) & (A(:,2) == B(2)),:) = [];  % For option #2 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-31T14:26:02.707

这里的简单解决方案是查看设置成员函数，即 setdiff、union 和 ismember。

```
A = [-4  0.5;
   -2    0.5;
    2    3;
    4    0.5;
   -2    0.5];

B = [-2 .5;7 7]; 
```

看看 ismember 对这两个数组做了什么。使用“行”选项。

```
ismember(A,B,'rows')

ans =
     0
     1
     0
     0
     1 
```

由于我们希望删除也在 B 中的 A 行，只需执行以下操作：

```
A(ismember(A,B,'rows'),:) = []

A = 
      -4          0.5
       2            3
       4          0.5 
```

请注意，集合成员函数会寻找精确匹配。诸如 A 中的 1/2 的整数或倍数满足该要求。它们在 MATLAB 中以浮点算法精确表示。

如果这些数字是真正的浮点数，我会更加小心。我会在差异上使用公差。在这种情况下，我可能已经计算了两组数字之间的点间距离矩阵，只有当 A 的一行落在 B 的其中一行的某个给定距离内时才删除它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-25T23:56:00.577

您还可以滥用 strmatch 函数来满足您的需要：以下代码删除矩阵 A 中给定行 b 的所有出现

```
A(strmatch(b, A),:) = []; 
```

如果您需要删除多行，例如矩阵 B 中的所有行，请遍历它们：

```
for b = B'
   A(strmatch(b, A),:) = [];
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-31T14:17:04.770

不确定何时引入此功能（使用 2012b），但您可以这样做：

```
setdiff(A, B, 'rows')
ans =

   -4.0000    0.5000
    2.0000    3.0000
    4.0000    0.5000 
```

基于：

```
A = [-4.0 0.5;
     -2.0 0.5;
      2.0 3.0;
      4.0 0.5;
     -2.0 0.5];
B = [-2.0 0.5]; 
```

# c# - 将字符串 XML 片段添加到 XML 文档中的最佳方法是什么？

> ID：683489
> 
> 赞同：0
> 
> 时间：2009-03-25T21:16:37.137
> 
> 标签：c#, xml

以前可能有人问过这个问题，但我找不到。

假设我有一个 XML 元素

```
XMLElement nd = xmlDoc.CreateElement("Node"); 
```

现在，我想用从其他函数获得的完整 XML 片段向 nd 添加一个子项，如下所示：

```
nd.AppendChild("<a1><a2></a2></a1>"); 
```

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T21:18:51.797

```
nb.InnerXML = "<a1><a2></a2></a1>";
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T22:55:02.017

上面的方法不是做到这一点的“最佳”方法。元素是节点，应该以这种方式创建和添加。（不是真正的代码，关闭）。

```
XMLElement nd = xmlDoc.CreateElement("Node");
XMLElement a1 = xmlDoc.CreateElement("Node");
XMLElement a2 = xmlDoc.CreateElement("Node");

//Add the node name etc.

nd.AppendChild(a1);
nd.AppendChild(a2); 
```

使用“<a1>”字符串是不好的。如果命名空间发生变化怎么办？特殊字符呢，不想自己处理吧？

# c# - 如何在 C# 中声明 LARGE_INTEGER

> ID：683491
> 
> 赞同：2
> 
> 时间：2009-03-25T21:16:39.523
> 
> 标签：c#, integer

下面的代码（在 C++ 中）是我正在尝试转换为 C#

```
DWORD Func_X_4(DWORD arg1, DWORD arg2, DWORD arg3)
{
LARGE_INTEGER result = {1, 0};
LARGE_INTEGER temp1 = {0};
LARGE_INTEGER temp2 = {0};
LARGE_INTEGER temp3 = {0};
LARGE_INTEGER temp4 = {0};
for(int x = 0; x < 32; ++x)
{
    if(arg2 & 1)
    {
        temp1.LowPart = arg3;
        temp1.HighPart = 0;
        temp2.QuadPart = temp1.QuadPart * result.QuadPart;
        temp3.LowPart = arg1;
        temp3.HighPart = 0;
        temp4.QuadPart = temp2.QuadPart % temp3.QuadPart;
        result.QuadPart = temp4.QuadPart;
    }
    arg2 >>= 1;
    temp1.LowPart = arg3;
    temp1.HighPart = 0;
    temp1.QuadPart *= temp1.QuadPart;
    temp2.LowPart = arg1;
    temp2.HighPart = 0;
    temp3.QuadPart = temp1.QuadPart % temp2.QuadPart;
    arg3 = temp3.LowPart;
    if(!arg2)
        break;
}
return result.LowPart;
} 
```

在这里我尝试翻译代码，但它太乱了，我以前从未使用过大整数。

结构：

```
public struct LARGE_INTEGER
{
    UInt32 LowPart;
    Int32 HighPart;
    Int32 QuadPart;
} 
```

翻译功能：

```
 public Int32 Func_X_4(Int32 arg1, Int32 arg2, Int32 arg3)
    {
    LARGE_INTEGER result = {1, 0}; //this and the four below,are they correct?
    LARGE_INTEGER temp1 = {0, 0};
    LARGE_INTEGER temp2 = {0, 0};
    LARGE_INTEGER temp3 = {0, 0};
    LARGE_INTEGER temp4 = {0, 0};
    for(int x = 0; x < 32; ++x)
    {
        if(arg2 & 1==0) //correct?
        {
            temp1.LowPart = arg3;
            temp1.HighPart = 0;
            temp2.QuadPart = temp1.QuadPart * result.QuadPart;
            temp3.LowPart = arg1;
            temp3.HighPart = 0;
            temp4.QuadPart = temp2.QuadPart % temp3.QuadPart;
            result.QuadPart = temp4.QuadPart;
        }
        arg2 >>= 1;
        temp1.LowPart = arg3;
        temp1.HighPart = 0;
        temp1.QuadPart *= temp1.QuadPart;
        temp2.LowPart = arg1;
        temp2.HighPart = 0;
        temp3.QuadPart = temp1.QuadPart % temp2.QuadPart;
        arg3 = temp3.LowPart;
        if(arg2 != 0) //correct?
        break;
    }
    return result.LowPart;
} 
```

问题：第一个问题是我在C#中没有找到LARGE_INTEGER类型变量，所以我创建了一个结构，我想知道是否真的存在。至于第二个问题，功能不对，没用。

对于该特定问题的任何帮助将不胜感激！先感谢您。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-25T22:39:07.610

LARGE_INTEGER 结构的直接翻译是：

```
[StructLayout(LayoutKind.Explicit, Size=8)]
struct LARGE_INTEGER
{
    [FieldOffset(0)]public Int64 QuadPart;
    [FieldOffset(0)]public UInt32 LowPart;
    [FieldOffset(4)]public Int32 HighPart;
} 
```

就像C语言中的**union**，`QuadPart`是一个8字节的值，`LowPart`占据前4个字节，`HighPart`占据高4个字节。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T21:18:32.170

它的 Int64。基于[http://msdn.microsoft.com/en-us/library/aa383713.aspx](http://msdn.microsoft.com/en-us/library/aa383713.aspx)，它是一个 64 位有符号整数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-05T07:27:13.137

基于先前的答案，我发现扩展 LARGE_INTEGER 的定义以包括高和低部分的 int 和 uint 版本很有用：

```
[StructLayout(LayoutKind.Explicit, Size=8)]
struct LARGE_INTEGER
    {
    [FieldOffset(0)]public long QuadPart;

    [FieldOffset(0)]public uint LowPart;
    [FieldOffset(4)]public int HighPart;

    [FieldOffset(0)]public int LowPartAsInt;
    [FieldOffset(0)]public uint LowPartAsUInt;

    [FieldOffset(4)]public int HighPartAsInt;
    [FieldOffset(4)]public uint HighPartAsUInt;
    } 
```

# python - python中的HTTP请求超时

> ID：683493
> 
> 赞同：1
> 
> 时间：2009-03-25T21:17:45.713
> 
> 标签：python, httpwebrequest

偶尔发出http请求时，我正在等待一个永远不会得到响应的年龄。在一段合理的时间后取消此请求的推荐方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T21:22:11.337

设置 HTTP 请求超时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T21:28:29.853

[urllib2.urlopen](http://docs.python.org/library/urllib2.html#urllib2.urlopen)或[httplib](http://docs.python.org/library/httplib.html#httplib.HTTPConnection)的超时参数。原来的 urllib 没有这么方便的功能。您还可以使用异步 HTTP 客户端，例如[twisted.web.client](http://twistedmatrix.com/documents/8.1.0/api/twisted.web.client.html)，但这可能不是必需的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T21:35:52.567

如果您发出大量 HTTP 请求，您可以通过调用[socket.setdefaulttimeout来全局更改它](http://docs.python.org/library/socket.html#socket.setdefaulttimeout)

# python - 如何将 xml 文件保存到磁盘？

> ID：683494
> 
> 赞同：2
> 
> 时间：2009-03-25T21:17:56.150
> 
> 标签：python, xml

我做了类似的事情[，](http://www.postneo.com/projects/pyxml/)但找不到将结果写入 xml 文件的方法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T21:19:59.047

您链接到的网页上的代码用于`doc.toprettyxml`从 XML DOM 创建一个字符串，因此您可以将该字符串写入文件：

```
f = open("output.xml", "w")
try:
    f.write(doc.toprettyxml(indent="  "))
finally:
    f.close() 
```

在 Python 2.6（或 2.7，我想，无论何时出现），您都可以使用 " `with`" 语句：

```
with open("output.xml", "w") as f:
    f.write(doc.toprettyxml(indent="  ")) 
```

如果你把这也适用于 Python 2.5

```
from __future__ import with_statement 
```

在文件的开头。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-25T23:43:41.963

coonj 是对的，但 xml.dom.ext.PrettyPrint 是越来越被忽视的 PyXML 扩展包的一部分。如果您想保持在提供的标准 minidom 内，您会说：

```
f= open('yourfile.xml', 'wb')
doc.writexml(f, encoding= 'utf-8')
f.close() 
```

（或者使用 David 提到的 'with' 语句使其略短。使用模式 'wb' 避免 Windows 上不需要的 CRLF 换行符干扰 UTF-16 等编码。因为 XML 有自己的处理换行符解释的机制，所以它应被视为二进制文件而不是文本。）

如果您不包含“encoding”参数（对于 writexml 或 toprettyxml），它会尝试将 Unicode 字符串直接写入文件，因此如果其中有任何非 ASCII 字符，您将得到一个Unicode 编码错误。不要自己尝试 .encode() toprettyxml 的结果；对于非 UTF-8 编码，这可能会生成格式不正确的 XML。

没有 'writeprettyxml()' 函数，但自己做起来非常简单：

```
with open('output.xml', 'wb') as f:
    doc.writexml(f, encoding= 'utf-8', indent= '    ', newl= '\n') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T21:21:14.567

```
f = open('yourfile.xml', 'w')
xml.dom.ext.PrettyPrint(doc, f)
f.close() 
```

# ado.net - GetDate() 使用实体框架

> ID：683496
> 
> 赞同：3
> 
> 时间：2009-03-25T21:18:10.863
> 
> 标签：ado.net

我正在尝试使用实体框架并从 SQL 服务器获取日期。在 LINQ 中执行此操作的旧方法如下，但我需要实体框架的一些东西：

```
Partial Public Class ActivityActionsDataContext
<[Function](Name:="GetDate", IsComposable:=True)> _
Public Function GetSystemDate() As DateTime
    Dim mi As MethodInfo = TryCast(MethodBase.GetCurrentMethod(), MethodInfo)
    Return DirectCast(Me.ExecuteMethodCall(Me, mi, New Object() {}).ReturnValue, DateTime)
End Function 
```

结束类

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T10:19:42.490

返回 UTC 日期时间的 EF 规范函数是：`CurrentUtcDateTime()`

另请参阅：http: [//msdn.microsoft.com/en-us/library/bb738563.aspx](http://msdn.microsoft.com/en-us/library/bb738563.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T21:21:09.683

您是否尝试过使用`DateTime.Now`or `DateTime.UtcNow`？我想*这*会被`GetSystemDate()`查询翻译器转换成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-14T01:37:54.337

在谷歌“efquerysamples”实体框架示例中搜索并下载那些好的示例，然后查看规范函数 CurrentDateTime()，它适用于：

DateTime fecha = ServicioContexto.Contexto.CreateQuery("CurrentDateTime()").Execute(MergeOption.NoTracking).First();

我想更多地了解规范函数。请解释一下。谢谢

# javascript - 从 html 表单调用 Javascript

> ID：683498
> 
> 赞同：59
> 
> 时间：2009-03-25T21:18:47.990
> 
> 标签：javascript, html, forms, dom-events

我的问题和示例基于 Jason 在[这个](https://stackoverflow.com/questions/662630/javascript-form-bypassing-default-behaviour-for-ajax/664938#664938)问题中的回答

当单击提交按钮时，我试图避免使用`eventListener`，而只是调用。`handleClick` `onsubmit`

我拥有的代码绝对没有任何反应。

为什么`handleClick`不被调用？

```
<html>
  <head>
    <script type="text/javascript">
      function getRadioButtonValue(rbutton)
      {
        for (var i = 0; i < rbutton.length; ++i)
        { 
          if (rbutton[i].checked)
            return rbutton[i].value;
        }
        return null;
      }

      function handleClick(event)
      {
        alert("Favorite weird creature: "+getRadioButtonValue(this["whichThing"]));
        event.preventDefault(); // disable normal form submit behavior
        return false; // prevent further bubbling of event
      }
    </script>
  </head>
<body>
    <form name="myform" onSubmit="JavaScript:handleClick()">
      <input name="Submit"  type="submit" value="Update" onClick="JavaScript:handleClick()"/>
      Which of the following do you like best?
      <p><input type="radio" name="whichThing" value="slithy toves" />Slithy toves</p>
      <p><input type="radio" name="whichThing" value="borogoves" />Borogoves</p>
      <p><input type="radio" name="whichThing" value="mome raths" />Mome raths</p>
    </form>
</body>
</html> 
```

编辑：

请不要建议将框架作为解决方案。

以下是我对代码所做的相关更改，这些更改会导致相同的行为。

```
 function handleClick()
      {
        alert("Favorite weird creature: "+getRadioButtonValue(document.myform['whichThing'])));
        event.preventDefault(); // disable normal form submit behavior
        return false; // prevent further bubbling of event
      }
    </script>
  </head>
<body>
<form name="aye">;
      <input name="Submit"  type="submit" value="Update" action="JavaScript:handleClick()"/>
      Which of the following do you like best?
      <p><input type="radio" name="whichThing" value="slithy toves" />Slithy toves</p>
      <p><input type="radio" name="whichThing" value="borogoves" />Borogoves</p>
      <p><input type="radio" name="whichThing" value="mome raths" />Mome raths</p>
    </form> 
```

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-03-25T21:33:48.640

您可以使用 javascript url 表单

```
<form action="javascript:handleClick()"> 
```

或使用 onSubmit 事件处理程序

```
<form onSubmit="return handleClick()"> 
```

在后面的表单中，如果你从handleClick返回false，它会阻止正常的提交过程。如果您希望浏览器遵循正常的提交过程，则返回 true。

`Javascript:`由于部分原因，按钮中的 onSubmit 事件处理程序也失败了

**编辑：** 我刚刚尝试了这段代码，它可以工作：

```
<html>
  <head>
    <script type="text/javascript">

      function handleIt() {
        alert("hello");
      }

    </script>
  </head>

<body>
    <form name="myform" action="javascript:handleIt()">
      <input name="Submit"  type="submit" value="Update"/>
    </form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-03-25T21:25:16.290

在这段代码中：

```
getRadioButtonValue(this["whichThing"])) 
```

你实际上并没有得到任何参考。因此，getradiobuttonvalue 函数中的单选按钮未定义并引发错误。

**编辑** 要从单选按钮中获取值，请获取[JQuery](http://jquery.com/)库，然后使用它：

```
 $('input[name=whichThing]:checked').val() 
```

**编辑 2** 由于希望重新发明轮子，这里是非 Jquery 代码：

```
var t = '';
for (i=0; i<document.myform.whichThing.length; i++) {
     if (document.myform.whichThing[i].checked==true) {
         t = t + document.myform.whichThing[i].value;
     }
} 
```

或者，基本上，修改原始代码行以这样阅读：

```
getRadioButtonValue(document.myform.whichThing)) 
```

**编辑 3** 这是你的作业：

```
 function handleClick() {
        alert("Favorite weird creature: " + getRadioButtonValue(document.aye.whichThing));
        //event.preventDefault(); // disable normal form submit behavior
        return false; // prevent further bubbling of event
      }
    </script>
  </head>
<body>
<form name="aye" onSubmit="return handleClick()">
     <input name="Submit"  type="submit" value="Update" />
     Which of the following do you like best?
     <p><input type="radio" name="whichThing" value="slithy toves" />Slithy toves</p>
     <p><input type="radio" name="whichThing" value="borogoves" />Borogoves</p>
     <p><input type="radio" name="whichThing" value="mome raths" />Mome raths</p>
</form> 
```

请注意以下内容，我已将函数调用移至表单的“onSubmit”事件。另一种方法是将您的提交按钮更改为标准按钮，并将其放入按钮的 OnClick 事件中。我还删除了函数名前面不需要的“JavaScript”，并在函数输出的值上添加了一个显式的 RETURN。

在函数本身中，我修改了表单的访问方式。结构是： **document.[THE FORM NAME].[THE CONTROL NAME]**来处理事情。由于您重命名了 from aye，因此您必须更改 document.myform。记录。是的。此外，*document.aye["whichThing"]*在这种情况下是错误的，因为它需要是*document.aye.whichThing*。

最后一点，是我注释掉了**event.preventDefault();** . 此示例不需要该行。

**编辑 4**只是为了清楚。**document.aye["whichThing"]**将为您提供对选定值的直接访问，但**document.aye.whichThing**使您可以访问您需要检查的单选按钮集合。由于您使用“getRadioButtonValue(object)”函数来遍历集合，因此您需要使用**document.aye.whichThing**。

查看此方法的区别：

```
function handleClick() {
   alert("Direct Access: " + document.aye["whichThing"]);
   alert("Favorite weird creature: " + getRadioButtonValue(document.aye.whichThing));
   return false; // prevent further bubbling of event
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-11-17T12:41:48.707

应该补充 Miquel (#32) 的漂亮例子：

```
<html>
 <head>
  <script type="text/javascript">
   function handleIt(txt) {   // txt == content of form input
    alert("Entered value: " + txt);
   }
  </script>
 </head>
 <body>
 <!-- javascript function in form action must have a parameter. This 
    parameter contains a value of named input -->
  <form name="myform" action="javascript:handleIt(lastname.value)">  
   <input type="text" name="lastname" id="lastname" maxlength="40"> 
   <input name="Submit"  type="submit" value="Update"/>
  </form>
 </body>
</html> 
```

表格应该有：

```
<form name="myform" action="javascript:handleIt(lastname.value)"> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-26T17:51:19.650

在您的编辑版本中有几处需要更改：

1.  你已经接受了使用`document.myform['whichThing']`有点过于字面意思的建议。您的表单名为“aye”，因此访问 whichThing 单选按钮的代码应使用该名称：`document.aye['whichThing']。

2.  没有标签的`action`属性之类的东西。`<input>`改用`onclick`：`<input name="Submit" type="submit" value="Update" onclick="handleClick();return false"/>`

3.  在浏览器中获取和取消 Event 对象是一个非常复杂的过程。它因浏览器类型和版本而异。IE 和 Firefox 处理这些事情的方式非常不同，所以简单的`event.preventDefault()`行不通……事实上，甚至可能不会定义事件变量，因为这是来自标签的 onclick 处理程序。这就是为什么上面的斯蒂芬如此努力地提出一个框架的原因。我知道你想知道机制，我推荐谷歌。在这种情况下，作为一种简单的解决方法，`return false`在 onclick 标记中使用上面的数字 2（或按照 stephen 的建议从函数中返回 false）。

4.  由于＃3，请摆脱处理程序中的所有内容而不是警报语句。

代码现在应该如下所示：

```
function handleClick()
      {
        alert("Favorite weird creature: "+getRadioButtonValue(document.aye['whichThing']));
      }
    </script>
  </head>
<body>
    <form name="aye">
      <input name="Submit"  type="submit" value="Update" onclick="handleClick();return false"/>
      Which of the following do you like best?
      <p><input type="radio" name="whichThing" value="slithy toves" />Slithy toves</p>
      <p><input type="radio" name="whichThing" value="borogoves" />Borogoves</p>
      <p><input type="radio" name="whichThing" value="mome raths" />Mome raths</p>
    </form> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-01T21:22:54.493

您的代码中的所有内容似乎都很完美，除了 handleClick() 无法正常工作，因为该函数在其函数调用调用中缺少参数（但其中的函数定义有一个导致函数不匹配发生的参数）。

以下是计算所有学期总分和相应成绩的示例工作代码。它演示了在 html 文件中使用 JavaScript 函数（调用），并解决了您面临的问题。

```
<!DOCTYPE html>
<html>
<head>
    <title> Semester Results </title>
</head>
<body>
    <h1> Semester Marks </h1> <br> 
    <script type = "text/javascript">
        function checkMarks(total)
        {
            document.write("<h1> Final Result !!! </h1><br>");
            document.write("Total Marks = " + total + "<br><br>");
            var avg = total / 6.0;
            document.write("CGPA = " + (avg / 10.0).toFixed(2) + "<br><br>");
            if(avg >= 90)
                document.write("Grade = A");
            else if(avg >= 80)
                document.write("Grade = B");
            else if(avg >= 70)
                document.write("Grade = C");
            else if(avg >= 60)
                document.write("Grade = D");
            else if(avg >= 50)
                document.write("Grade = Pass");
            else
                document.write("Grade = Fail");
       }
    </script>
    <form name = "myform" action = "javascript:checkMarks(Number(s1.value) + Number(s2.value) + Number(s3.value) + Number(s4.value) + Number(s5.value) + Number(s6.value))"/>
        Semester 1:  <input type = "text" id = "s1"/> <br><br>
        Semester 2:  <input type = "text" id = "s2"/> <br><br>
        Semester 3:  <input type = "text" id = "s3"/> <br><br>
        Semester 4:  <input type = "text" id = "s4"/> <br><br>
        Semester 5:  <input type = "text" id = "s5"/> <br><br>
        Semester 6:  <input type = "text" id = "s6"/> <br><br><br>
        <input type = "submit" value = "Submit"/>
    </form>
</body>
</html> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-25T21:25:10.737

`javascript:`从`onclick="..`,`onsubmit="..`声明中删除

`javascript:`前缀仅用于`href=""`或类似的属性（与事件无关）

# c# - 版本化序列化文件

> ID：683501
> 
> 赞同：3
> 
> 时间：2009-03-25T21:19:28.377
> 
> 标签：c#, design-patterns, serialization

我有一个可以将文档（IDocument 类型）序列化到磁盘的工作应用程序。从那里我制作的另一个应用程序可以打开该文档（IDocument 实现 IPrintDocument）进行查看。

假设我已将 IDocument 写入磁盘，然后一周后将一个字段添加到 IDocument 对象。写入文件的程序和打开文件的程序都使用 IDocument 的这个新“版本”进行了更新。然后它会在尝试打开以前的 IDocument 版本时中断（我假设 - 没有机会检查，我在这里期待）。是否有一种已知的模式可以缓解这种问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T21:25:56.723

是的 - 使用一种可[容忍版本控制](http://code.google.com/apis/protocolbuffers/docs/proto.html#updating)的序列化机制。

可以预见的是，我将建议使用[Google 的 Protocol Buffers](http://code.google.com/apis/protocolbuffers/)，至少有[两个](http://code.google.com/p/protobuf-csharp-port/) [可行](http://code.google.com/p/protobuf-net/)的.NET 实现。只要你小心，Protocol Buffers 是向后和向前兼容的——你可以用旧代码读取新消息，反之亦然，旧代码仍然能够保留它不理解的信息。

另一种选择是 XML，无论是否使用 .NET 的内置 XML 序列化。据我所知，内置序列化在版本控制方面并不是特别灵活。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T23:18:22.087

.net 内置序列化是一个选项，但它确实需要您在将来要扩展的特定部分上添加占位符。

您为额外的元素/属性添加占位符，如下面的代码：

```
[XmlAnyElement()]
public XmlElement[] ExtendedElements { get; set; }
[XmlAnyAttribute()]
public XmlAttribute[] ExtendedAttributes { get; set; } 
```

通过在涉及的类中添加上述内容，您可以有效地读取保存的具有额外元素/属性的信息，修改软件知道如何处理和保存的正常属性。这允许向后和向前兼容。添加新字段时，只需添加所需的属性。

请注意，上述内容仅限于在指定的挂钩中扩展。

**更新：**正如 Jon 在评论中提到的，以上内容仅适用于 xml 序列化。据我所知，二进制序列化不支持类似的东西。在二进制序列化中，您可以获得应用程序的旧/新版本，以便能够相互读取序列化信息（.net 2.0+），但如果将其保存回来，您将丢失版本无法处理的额外信息。

从 .net 2.0 开始，反序列化过程会忽略额外数据，如果将其与可选字段结合使用，您可以有效地让两个应用程序读取其他版本的格式。问题是数据不像 xml 字段那样由类保存。

一些相关链接： http: [//msdn.microsoft.com/en-us/library/system.runtime.serialization.serializationbinder.aspx，http](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.serializationbinder.aspx) : [//msdn.microsoft.com/en-us/library/ms229752.aspx](http://msdn.microsoft.com/en-us/library/ms229752(VS.85).aspx)

如果您不想要 xml 序列化，我会采用 Jon 的方法。

附言。我不知道是否有一些好的第三方实现，我们可以访问，扩展二进制序列化以保存和保存额外的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T21:30:18.117

使用 [OptionalField] 属性，内置序列化应该为您提供对版本更新的最小容忍度。但是事情[很快就会变得棘手](http://code.google.com/p/alsing/source/browse/trunk/CaramelStudio/CaramelSerialization/VersionSupportingBinaryFormatter.cs)，所以你最好看看使用解决这些问题的框架，比如 Jons protobuffers 等......

另一个选择是为您的文档存储使用像[Sqlite这样的嵌入式数据库。](http://sqlite.phxsoftware.com/)并手动（或使用 ORM）将对象中的属性/字段映射到表中的列。

或者

使用[Lucene](http://incubator.apache.org/lucene.net/)，它还可以让您在文档中进行全文搜索。

# coding-style - 过时的编码实践

> ID：683504
> 
> 赞同：17
> 
> 时间：2009-03-25T21:19:56.660
> 
> 标签：coding-style

当我进行编码时，我有时想知道我是否以最好的方式做事，或者只是按照它一直以来的方式做事。我现在做的还有意义吗？

例如，在函数顶部声明所有变量。如果我尝试将它声明两次或低于我开始使用它的位置，我的 IDE 将在设计时向我咆哮——那有什么大不了的？在使用它们的块的正上方声明变量似乎更有意义。

另一种是匈牙利符号。我讨厌我所有与特定对象相关的变量都分散在我的智能感知中。

随着框架和 IDE 的现代进步，是否有一些编码实践不再真正适用，而另一些现在可能完全是错误的？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-25T21:22:50.633

不要在将要使用它们的块*上方*声明变量- 在首次使用时在可用的最窄范围内声明它们，假设这在您的语言中是可行的。

匈牙利符号将取决于您的语言/平台的约定。它还取决于您使用的是哪种匈牙利语 - 明智的（我仍然不喜欢）或仅重申已经可用的类型信息的版本。

需要注意的一件事：当你学习一门新语言时，请确保同时学习它的习语，尤其是命名约定。这将帮助您的代码适应新语言，而不是旧的（可能不相关的）代码。我发现它也有助于我*与*新语言保持一致，而不是与之抗争。

但是，是的，定期重新审视编码实践当然值得。如果你无法确定为什么某件事是个好主意，请尝试暂时不使用它...

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-25T21:30:48.303

**意外分配保护：**

在某些较新的语言（如 C#）中，不需要将左值放在右侧。

在 C# 中，以下内容不会编译：

```
if (variable = 0) 
```

所以在 C# 中不需要这样做：

```
if (0 == variable) 
```

这种做法在 C/C++ 程序中很常见，以避免意外的分配，这意味着比较。

* * *

**多个返回点：**

禁止使用多个返回点主要是因为您不想忘记删除变量。

相反，如果您只使用 RAII，则无需担心。

免责声明：仍然有充分的理由尽量减少多个返回点，有时只有一个是有用的。

* * *

**头文件**

在大多数现代语言中，您不会将代码分成声明和定义。

* * *

**C++ 定义多个头文件包括**

在 C++ 中，你经常这样做：

```
#ifdef _MYFILE_H_
#define _MYFILE_H_

//code here

#endif 
```

这有时会导致类似以下的情况：

```
#ifdef _MYFILE_H_
#define _WRONGNAME_H_

//code here

#endif 
```

如果您的编译器支持它，那么执行此操作的更好方法是：

```
#pragma once 
```

* * *

**C 变量声明**

使用 C，您必须在代码块的顶部声明所有变量。甚至更高版本的 C 也不需要这样做，但人们仍然这样做。

* * *

**匈牙利符号：（阅读，包含一些独特的信息）**

[匈牙利符号仍然可以很好](http://www.joelonsoftware.com/articles/Wrong.html)。但我不是指那种匈牙利符号。

在 C 中非常重要之前，拥有以下内容：

```
int iX = 5;
char szX[1024];
strcpy(szX, "5"); 
```

因为您可以完全键入不安全的函数，例如：

```
printf("%i", iX); 
```

现在，如果我调用字符串 x，我的程序就会崩溃。

当然，解决此问题的方法是仅使用类型安全函数。因此，只要您这样做，从这个意义上说，您就不需要匈牙利符号。

但从 Joel 的角度来看，这仍然是一个好主意。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-25T21:24:47.057

我曾经将所有行号分隔 10，以 100 或 1000 的间隔开始每个逻辑上独立的代码段，即

```
10 Print "Hello"
20 Gosub 100
30 'Peeks and Pokes 
```

由于显而易见的原因，我不再这样编码。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-25T21:23:21.350

短标识符：许多老式编码器使用短而隐秘的标识符。简洁是一种有用的美德，但考虑到好的 IDE 具有自动完成功能，描述性名称远比易于键入的名称好得多。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-25T21:24:45.823

短行：有些人坚持使用 80 列文本。我们其他人有真正的监视器，不介意一行超过 80 个字符。有更长的行可以提高可读性。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-26T07:39:33.847

在列中对齐（例如，声明中的变量或赋值中的 =）。

手动维护很痛苦，自动重命名无论如何都会把它搞砸，有些行会变得很长，因为属于一起的东西相距甚远，所以你很难看到关系。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-26T17:39:37.497

就像之前所说的那样，不要试图使一种语言的习语适应另一种语言。在完全不同的语言中尤其如此，例如从 C++ 到 Python。另外（这可能只是个人风格的问题），我曾经声明一个变量，然后为它赋值。我发现同时声明和定义它更快，更节省空间。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-25T21:25:17.897

就变量声明而言，声明它们的最佳位置是在它们被使用之前。如果您的函数/过程太大以至于在顶部声明了大量变量，请考虑将函数重构为多个更小的函数。

就匈牙利符号而言，同样的答案也适用。如果函数太大以至于您无法快速找到变量的定义（即使它应该在使用之前声明），那么请考虑重构。

在大多数情况下，一个编写良好、重构良好的函数应该使变量声明和数据类型一目了然，只需快速浏览一下代码页即可。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-25T21:22:27.217

虽然它是用 Java 编写的，但这是我推荐给想要优化/现代化其编码风格的人的书：http: [//www.amazon.com/Implementation-Patterns-Addison-Wesley-Signature-Kent/dp/0321413091](https://rads.stackoverflow.com/amzn/click/com/0321413091)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-25T21:23:53.813

顶部的变量在像 javascript 这样的语言中是有意义的。它没有块范围，因此它确实简化了阅读。

考虑一个包含以下内容的函数体：

```
//some code
if(something)
{
   var c = 123;
}

alert(c); // gives 123 when the if is executed and undefined when it doesn't. 
```

这是每种语言不同的剩余部分，这肯定会影响什么是合适的和不合适的。还要考虑到你在相关框架中使用的代码通常使用某种编码风格，如果你使用完全不同的东西，你将不可避免地以混合风格结束。

**更新：** javascript 中的上述内容正在发生变化（如评论中所述）。它似乎没有得到广泛的支持（没有找到一个好的链接认为:()，这也提醒我们，如果不考虑我们使用它们的上下文，我们不能急于进入新功能。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-25T21:24:45.823

> 随着框架和 IDE 的现代进步，是否有一些编码实践不再真正适用，而其他一些现在可能完全是错误的

很大程度上取决于语言。

> 写 C：

*   使用`register`关键字

> 写 C++：

*   滥用`static`; 现在你应该使用`namespace`s 即使是匿名的

或者，我误解了你的问题吗？

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-25T21:47:01.777

指针的手动引用计数是一种古老的做法，让我非常抓狂。我每月修复大约 1-2 个错误，因为有人试图变得聪明并手动引用计数指针。只需使用智能指针。这**将**节省您的时间。

# xcode - 如何删除编码窗口中的错误消息？

> ID：683506
> 
> 赞同：25
> 
> 时间：2009-03-25T21:19:59.220
> 
> 标签：xcode

我在完成课程编码之前按下了 Build，Xcode 向我显示了一堆红色错误，这显然是因为我还没有完成。

如何摆脱错误，使它们不会出现在我的编码窗口中？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-25T21:22:59.400

**XCode 4:**
`^` +`⌘</kbd>+`M` or Editor → Issues → (uncheck) Show All Issues`

**旧版本：**
`⌥</kbd>+`⇧</kbd>+`⌘</kbd>+`H` or View → Message Bubbles → Hide All```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-06-17T00:42:18.703

**XCode 7**：首选项（⌘，）>常规。

在问题下取消选中“显示实时问题”

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T21:26:25.383

双击气泡也可以

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-19T15:40:36.737

在 Xcode Preferences (⌘,) > Building 上，将“Never”设置为在构建期间显示消息气泡

# recursion - 动态编程递归和一些记忆化

> ID：683511
> 
> 赞同：1
> 
> 时间：2009-03-25T21:21:15.800
> 
> 标签：recursion, dynamic-programming, memoization

我在这个三角形中有大量从 0 到 4 的整数数组。我正在尝试使用 Ruby 学习动态编程，并希望在计算三角形中满足三个标准的路径数方面得到一些帮助：

1.  您必须从包含 70 个元素的行中的零点之一开始。
2.  您的路径可以在您正上方的一排（如果正上方有数字）或向左对角线的一排。这些选项之一始终可用
3.  在第一行达到零的路径总和必须为 140。

例如，从底行的第二个零开始。您可以直接向上移动到 4 的左侧或对角线。在任何一种情况下，您到达的数字都必须添加到您访问过的所有数字的运行计数中。您可以从 1 移动到正上方的 2（运行总和 = 3）或左侧对角线的 0（运行总和 = 1）。

```
0  
41  
302  
2413  
13024  
024130  
4130241  
30241302  
241302413  
1302413024  
02413024130  
413024130241  
3024130241302  
24130241302413  
130241302413024  
0241302413024130  
41302413024130241  
302413024130241302  
2413024130241302413  
13024130241302413024  
024130241302413024130  
4130241302413024130241  
30241302413024130241302  
241302413024130241302413  
1302413024130241302413024  
02413024130241302413024130  
413024130241302413024130241  
3024130241302413024130241302  
24130241302413024130241302413  
130241302413024130241302413024  
0241302413024130241302413024130  
41302413024130241302413024130241  
302413024130241302413024130241302  
2413024130241302413024130241302413  
13024130241302413024130241302413024  
024130241302413024130241302413024130  
4130241302413024130241302413024130241  
30241302413024130241302413024130241302  
241302413024130241302413024130241302413  
1302413024130241302413024130241302413024  
02413024130241302413024130241302413024130  
413024130241302413024130241302413024130241  
3024130241302413024130241302413024130241302  
24130241302413024130241302413024130241302413  
130241302413024130241302413024130241302413024  
0241302413024130241302413024130241302413024130  
41302413024130241302413024130241302413024130241  
302413024130241302413024130241302413024130241302  
2413024130241302413024130241302413024130241302413  
13024130241302413024130241302413024130241302413024  
024130241302413024130241302413024130241302413024130  
4130241302413024130241302413024130241302413024130241  
30241302413024130241302413024130241302413024130241302  
241302413024130241302413024130241302413024130241302413  
1302413024130241302413024130241302413024130241302413024  
02413024130241302413024130241302413024130241302413024130  
413024130241302413024130241302413024130241302413024130241  
3024130241302413024130241302413024130241302413024130241302  
24130241302413024130241302413024130241302413024130241302413  
130241302413024130241302413024130241302413024130241302413024  
0241302413024130241302413024130241302413024130241302413024130  
41302413024130241302413024130241302413024130241302413024130241  
302413024130241302413024130241302413024130241302413024130241302  
2413024130241302413024130241302413024130241302413024130241302413  
13024130241302413024130241302413024130241302413024130241302413024  
024130241302413024130241302413024130241302413024130241302413024130  
4130241302413024130241302413024130241302413024130241302413024130241  
30241302413024130241302413024130241302413024130241302413024130241302  
241302413024130241302413024130241302413024130241302413024130241302413  
1302413024130241302413024130241302413024130241302413024130241302413024  
02413024130241302413024130241302413024130241302413024130241302413024130 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T21:44:18.443

但我*喜欢*家庭作业:)

我发现从顶部开始时更容易推理“路径”问题，反之则遵循规则。

这表示：

*   部分路径可以是前零，也可以是扩展的部分路径
*   部分路径 Pr,c 的扩展是，除非 r 是最后一行，它们是完整的，它们的并集
    *   Pr,c + P(r+1),c 的扩展
    *   Pr,c + P(r+1),c+1 的扩展

“总和”规则只选择所有完整路径中的某些。

# java - 实现 Map 并保持插入顺序的 Java 类？

> ID：683518
> 
> 赞同：545
> 
> 时间：2009-03-25T21:22:04.457
> 
> 标签：java, dictionary, key-value

我正在寻找一个具有键值关联但不使用散列的java类。这是我目前正在做的事情：

1.  将值添加到`Hashtable`.
2.  获取`Hashtable.entrySet()`.
3.  遍历所有值并：
    1.  `Map.Entry`为迭代器获取一个。
    2.  `Module`根据该值创建一个类型的对象（自定义类）。
    3.  将类添加到 JPanel。
4.  显示面板。

这样做的问题是我无法控制取回值的顺序，因此我无法以给定的顺序显示值（没有对顺序进行硬编码）。

我会为此使用`ArrayList`or `Vector`，但稍后在代码中我需要获取`Module`给定 Key 的对象，而我无法使用`ArrayList`or来做到这一点`Vector`。

有谁知道可以做到这一点的免费/开源 Java 类，或者`Hashtable`根据添加时间从 a 中获取值的方法？

谢谢！

* * *

## 回答 #1

> 赞同：834
> 
> 时间：2009-03-25T21:23:12.067

我建议一个[`LinkedHashMap`](http://docs.oracle.com/javase/7/docs/api/java/util/LinkedHashMap.html)或一个[`TreeMap`](http://docs.oracle.com/javase/7/docs/api/java/util/TreeMap.html)。A`LinkedHashMap`保持键的插入顺序，而 a`TreeMap`保持通过 a`Comparator`或元素的自然`Comparable`顺序排序。

由于它不必保持元素排序，`LinkedHashMap`因此在大多数情况下应该更快；根据 Javadocs，`TreeMap`具有、、 和的`O(log n)`性能`containsKey`，而对于每个。`get``put``remove``LinkedHashMap``O(1)`

如果您的 API 只需要可预测的排序顺序，而不是特定的排序顺序，请考虑使用这两个类实现的接口，[`NavigableMap`](http://docs.oracle.com/javase/7/docs/api/java/util/NavigableMap.html)或者[`SortedMap`](http://docs.oracle.com/javase/7/docs/api/java/util/SortedMap.html). 这将允许您不会将特定实现泄漏到您的 API 中，并在之后随意切换到这些特定类或完全不同的实现。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2017-05-08T21:26:41.113

当您遍历地图的 keySet()、entrySet() 或 values() 时，LinkedHashMap 将按照元素插入地图的顺序返回元素。

```
Map<String, String> map = new LinkedHashMap<String, String>();

map.put("id", "1");
map.put("name", "rohan");
map.put("age", "26");

for (Map.Entry<String, String> entry : map.entrySet()) {
    System.out.println(entry.getKey() + " = " + entry.getValue());
} 
```

这将按照元素放入地图的顺序打印元素：

```
id = 1
name = rohan 
age = 26 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2010-08-27T15:50:04.070

**如果不可变地图满足您的需求**，那么谷歌提供了一个名为[guava](https://github.com/google/guava)的库（另请参阅[guava questions](https://stackoverflow.com/questions/tagged/guava)）

[Guava](https://github.com/google/guava)提供了一个具有可靠的用户指定迭代顺序的[ImmutableMap 。](http://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/ImmutableMap.html)这个[ImmutableMap](http://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/ImmutableMap.html)对于 containsKey, get 有 O(1) 的性能。显然不支持放置和删除。

[ImmutableMap](http://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/ImmutableMap.html)对象是通过使用优雅的静态便捷方法[of()](http://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/ImmutableMap.html#of--)和[copyOf()](http://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/ImmutableMap.html#copyOf-java.util.Map-)或[Builder](http://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/ImmutableMap.html#builder--)对象来构造的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-26T21:04:45.507

您可以维护 a `Map`(用于快速查找) 和`List`(for order) 但 a`LinkedHashMap`可能是最简单的。你也可以试试`SortedMap`eg `TreeMap`，它有你指定的任何顺序。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-05-02T05:29:00.990

您可以将**LinkedHashMap**用于 Map 中的主要插入顺序

Java LinkedHashMap 类的要点是：

1.  它只包含独特的元素。
2.  LinkedHashMap 包含基于键 3 的值。它可能有一个空键和多个空值。4.与HashMap相同，而是维护插入顺序

    ```
    public class LinkedHashMap<K,V> extends HashMap<K,V> implements Map<K,V> 
    ```

但是，如果您想使用用户定义的对象或任何原始数据类型键对地图中的值进行排序，那么您应该使用**TreeMap**有关更多信息，请参阅[此链接](https://theweblearn.blogspot.in/2018/05/sort-values-by-user-defined-object-in.html)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-10-30T10:52:25.063

您可以使用**`LinkedHashMap<K, V>`**也可以实现自己的**CustomMap**来维护插入顺序。

您可以**`CustomHashMap`**将以下功能与以下功能一起使用：

*   通过在内部使用 LinkedHashMap 来维护插入顺序。
*   `null`不允许使用带有或空字符串的键。
*   一旦创建了带值的键，我们就不会覆盖它的值。

[`HashMap`](https://stackoverflow.com/a/48094803)对比`LinkedHashMap`对比`CustomHashMap`

```
interface CustomMap<K, V> extends Map<K, V> {
    public boolean insertionRule(K key, V value);
}

@SuppressWarnings({ "rawtypes", "unchecked" })
public class CustomHashMap<K, V> implements CustomMap<K, V> {
    private Map<K, V> entryMap;
    // SET: Adds the specified element to this set if it is not already present.
    private Set<K> entrySet;

    public CustomHashMap() {
        super();
        entryMap = new LinkedHashMap<K, V>();
        entrySet = new HashSet();
    }

    @Override
    public boolean insertionRule(K key, V value) {
        // KEY as null and EMPTY String is not allowed.
        if (key == null || (key instanceof String && ((String) key).trim().equals("") ) ) {
            return false;
        }

        // If key already available then, we are not overriding its value.
        if (entrySet.contains(key)) { // Then override its value, but we are not allowing
            return false;
        } else { // Add the entry
            entrySet.add(key);
            entryMap.put(key, value);
            return true;
        }
    }
    public V put(K key, V value) {
        V oldValue = entryMap.get(key);
        insertionRule(key, value);
        return oldValue;
    }
    public void putAll(Map<? extends K, ? extends V> t) {
        for (Iterator i = t.keySet().iterator(); i.hasNext();) {
            K key = (K) i.next();
            insertionRule(key, t.get(key));
        }
    }

    public void clear() {
        entryMap.clear();
        entrySet.clear();
    }
    public boolean containsKey(Object key) {
        return entryMap.containsKey(key);
    }
    public boolean containsValue(Object value) {
        return entryMap.containsValue(value);
    }
    public Set entrySet() {
        return entryMap.entrySet();
    }
    public boolean equals(Object o) {
        return entryMap.equals(o);
    }
    public V get(Object key) {
        return entryMap.get(key);
    }
    public int hashCode() {
        return entryMap.hashCode();
    }
    public boolean isEmpty() {
        return entryMap.isEmpty();
    }
    public Set keySet() {
        return entrySet;
    }
    public V remove(Object key) {
        entrySet.remove(key);
        return entryMap.remove(key);
    }
    public int size() {
        return entryMap.size();
    }
    public Collection values() {
        return entryMap.values();
    }
} 
```

用法`CustomHashMap`：

```
public static void main(String[] args) {
    System.out.println("== LinkedHashMap ==");
    Map<Object, String> map2 = new LinkedHashMap<Object, String>();
    addData(map2);

    System.out.println("== CustomHashMap ==");
    Map<Object, String> map = new CustomHashMap<Object, String>();
    addData(map);
}
public static void addData(Map<Object, String> map) {
    map.put(null, "1");
    map.put("name", "Yash");
    map.put("1", "1 - Str");
    map.put("1", "2 - Str"); // Overriding value
    map.put("", "1"); // Empty String
    map.put(" ", "1"); // Empty String
    map.put(1, "Int");
    map.put(null, "2"); // Null

    for (Map.Entry<Object, String> entry : map.entrySet()) {
        System.out.println(entry.getKey() + " = " + entry.getValue());
    }
} 
```

输出/输出：

```
== LinkedHashMap == | == CustomHashMap ==
null = 2            | name = Yash
name = Yash         | 1 = 1 - Str
1 = 2 - Str         | 1 = Int
 = 1                |
  = 1               |
1 = Int             | 
```

* * *

如果您知道 KEY 是固定的，那么您可以使用 EnumMap。从属性/XML 文件中获取值

前任：

```
enum ORACLE {
    IP, URL, USER_NAME, PASSWORD, DB_Name;
}

EnumMap<ORACLE, String> props = new EnumMap<ORACLE, String>(ORACLE.class);
props.put(ORACLE.IP, "127.0.0.1");
props.put(ORACLE.URL, "...");
props.put(ORACLE.USER_NAME, "Scott");
props.put(ORACLE.PASSWORD, "Tiget");
props.put(ORACLE.DB_Name, "MyDB"); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-25T21:29:45.357

我不知道它是否是开源的，但经过一番谷歌搜索后，我找到[了 Map using ArrayList 的这个实现](http://www.java2s.com/Code/Java/Collections-Data-Structure/ArrayMapextendsAbstractMap.htm)。它似乎是 1.5 之前的 Java，因此您可能希望对其进行泛化，这应该很容易。请注意，此实现具有 O(N) 访问权限，但如果您不向 JPanel 添加数百个小部件，这应该不是问题，无论如何您都不应该这样做。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-11-09T08:36:32.570

每当我需要维护提前知道的事物的自然顺序时，我都会使用[EnumMap](https://docs.oracle.com/javase/7/docs/api/java/util/EnumMap.html)

键将是枚举，您可以按您想要的任何顺序插入，但是当您迭代时，它将按枚举顺序（自然顺序）进行迭代。

此外，当使用 EnumMap 时，不应该有更有效的冲突。

我真的发现使用 enumMap 可以生成清晰可读的代码。这是一个[例子](http://javarevisited.blogspot.com/2012/09/what-is-enummap-in-java-example-tutorial.html)

# sql - 从按日期排序的列表中选择下一条记录

> ID：683528
> 
> 赞同：2
> 
> 时间：2009-03-25T21:24:38.553
> 
> 标签：sql, mysql

我正在使用此 SQL 查询在 php 页面中按日期对记录列表进行排序。

```
SELECT ARTICLE_NO, USERNAME, ACCESSSTARTS, ARTICLE_NAME FROM table WHERE upper(ARTICLE_NAME) LIKE % x % ORDER BY str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s'); 
```

这工作正常。

在另一个 php 页面中，我希望能够删除这条记录，并在列表中显示下一条。我用来做的查询是：

```
SELECT ARTICLE_NO FROM auctions1 WHERE str_to_date( ACCESSSTARTS, '%d/%m/%Y %k:%i:%s' ) > (SELECT str_to_date( ACCESSSTARTS, '%d/%m/%Y %k:%i:%s' ) FROM table WHERE ARTICLE_NO =".$pk.") ORDER BY str_to_date( ACCESSSTARTS, '%d/%m/%Y %k:%i:%s' ) LIMIT 1"; 
```

我似乎遇到的问题是，因为有许多具有相同日期的记录，所以将选择具有相同日期的记录组中的任何记录，而不是列表中的相同记录。

如何选择从与第一个查询相同的结果集中返回的下一条记录？第一个查询总是返回相同的顺序，所以我不确定为什么第二个查询似乎有不同的顺序。

编辑：

我一直在尝试使用 Quassnoi 的建议。我现在使用的第一个查询是：

```
SELECT  ARTICLE_NO, USERNAME, ACCESSSTARTS, ARTICLE_NAME,
        date_format(str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s'), '%d %m %Y' ) AS shortDate
FROM    AUCTIONS1
WHERE   upper(ARTICLE_NAME) LIKE % x %
ORDER BY
        str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s'), article_no limit 0, 10 
```

Quassnoi 建议的第二个查询是：

```
SELECT  ARTICLE_NO
FROM    auctions1
WHERE   (str_to_date( ACCESSSTARTS, '%d/%m/%Y %k:%i:%s' ), article_no) >
        (
        SELECT  str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s'), article_no
        FROM    auctions1
        WHERE   ARTICLE_NO = xxx
        )
ORDER BY
        str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s'), article_no
LIMIT 1 
```

我通过在我的 php 页面中回显这个查询来复制这个查询，并简单地将 xxx 放在现有的 article_no 的位置。这与第一个代码示例完美匹配，但是结果与我在原始问题中使用的代码相同。

编辑2：

这是用于获取原始结果集的查询：

```
SELECT ARTICLE_NO, USERNAME, ACCESSSTARTS, ARTICLE_NAME, date_format(str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s'), '%d %m %Y' ) AS shortDate FROM auctions1 WHERE upper(ARTICLE_NAME) LIKE '%o%' ORDER BY str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s'), article_no limit 0, 10; 
```

这导致了这个数据，这很好：

```
ARTICLE_NO  USERNAME    ACCESSSTARTS        ARTICLE_NAME                        shortDate
160288212077    5864_australen  30/09/2008 05:22:30     DON ED HARDY TIGER JACKE WEISS   XL             30 09 2008
220288566257    fashionticker1  01/10/2008 16:39:12     Ed Hardy Tank Top Lila Neu & OVP Gr. L          01 10 2008
280273115680    mulle15     01/10/2008 16:42:38     Ed Hardy, T-Shirt,Destroy, schwarz, Gr.L        01 10 2008
280273115991    mulle15     01/10/2008 16:43:54     Ed Hardy, T-Shirt,Destroy, schwarz, Gr.XL       01 10 2008
280273116224    mulle15     01/10/2008 16:44:59     Ed Hardy, T-Shirt,Destroy, schwarz, Gr.XXL      01 10 2008
280273118653    mulle15     01/10/2008 16:54:50     Ed Hardy, T-Shirt,King Snoopy,chocolate, Gr.M       01 10 2008
120312402767    lieschenjuli    01/10/2008 16:56:12     Badehose Shorts Ed Hardy L              01 10 2008
280273119206    mulle15     01/10/2008 16:56:47     Ed Hardy, T-Shirt,King Snoopy,chocolate, Gr.XL      01 10 2008
280273119489    mulle15     01/10/2008 16:57:49     Ed Hardy, T-Shirt,King Snoopy,chocolate, Gr.XXL     01 10 2008
160288777155    bonifatzius1    01/10/2008 16:58:33     Ed Hardy Bomberjacke Gr. L Jacke fÃ¼r Damen oder H...   01 10 2008 
```

问题是，如果我执行此查询：

```
SELECT  ARTICLE_NO
FROM    auctions1
WHERE   (str_to_date( ACCESSSTARTS, '%d/%m/%Y %k:%i:%s' ), article_no) >
        (
        SELECT  str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s'), article_no
        FROM    auctions1
        WHERE ARTICLE_NO =160288212077
        )
ORDER BY
        str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s'), article_no
LIMIT 1; 
```

this 返回 280273112610，当 220288566257 是应该返回的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T01:11:41.503

您也可以尝试按 ARTICLE_NO 对结果进行排序。做就是了：

```
... ORDER BY str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s'), ARTICLE_NO ... 
```

这样，两个结果集的顺序应该完全相同。在这两种情况下，下一个记录将是ARTICLE_NO 最低且日期较晚的记录。

问候

萨赫

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T15:57:54.247

```
SELECT  ARTICLE_NO
FROM    auctions1
WHERE   upper(ARTICLE_NAME) LIKE '% x %'
        AND (str_to_date( ACCESSSTARTS, '%d/%m/%Y %k:%i:%s' ), article_no) >
        (
        SELECT  str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s'), article_no
        FROM    auctions1
        WHERE   ARTICLE_NO = @pk
        )
ORDER BY
        str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s'), article_no
LIMIT 1 
```

请注意，您的原始结果集：

```
SELECT  ARTICLE_NO, USERNAME, ACCESSSTARTS, ARTICLE_NAME
FROM    auctions1
WHERE   upper(ARTICLE_NAME) LIKE % x %
ORDER BY
        str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s'); 
```

不保证一个内稳定的行顺序`ACCESSSTARTS`。您需要添加`PRIMARY KEY`到`ORDER BY`子句中，如下所示：

```
SELECT  ARTICLE_NO, USERNAME, ACCESSSTARTS, ARTICLE_NAME
FROM    auctions1
WHERE   upper(ARTICLE_NAME) LIKE % x %
ORDER BY
        str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s'), article_no. 
```

（我假设`ARTICLE_NO`是`PRIMARY KEY`你的桌子）

您的原始行集（取决于它使用的访问方法）以表顺序或索引顺序返回行。

**你真的，真的，真的需要改变你原来的行集来使用稳定的顺序。**

但是，如果由于某种原因您不能这样做，您可以执行以下操作：

```
SELECT  ARTICLE_NO, USERNAME, ACCESSSTARTS, ARTICLE_NAME,
FROM    (
        SELECT  @c := NULL
        ) vars,
        auctions1
WHERE   upper(ARTICLE_NAME) LIKE % x %
        AND CASE WHEN ARTICLE_NO = $PK THEN @с := 0 ELSE 0 END IS NOT NULL
        AND (@c := @c + 1) = 2
ORDER BY
        str_to_date(ACCESSSTARTS, '%d/%m/%Y %k:%i:%s');
LIMIT 1 
```

此查询效率较低，并且严重依赖于该查询将使用与原始查询完全相同的访问方法这一事实。

您通常不依赖这个事实，因为访问方法可以随时更改。

如果您想要清晰和理智的代码，只需添加`ARTICLE_NO`并`ORDER BY`享受我首先发布的查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T15:44:58.737

这是完全合乎逻辑的。您在第二个查询中缺少第一个查询中的 ARTICLE_NAME 条件 - 第二个查询返回比第一个查询更多的行。删除 LIMIT，你会看到。第二个排序条件也是一个好主意，即使数字是任意的。

# java - Java 泛型的类型别名

> ID：683533
> 
> 赞同：37
> 
> 时间：2009-03-25T21:25:13.823
> 
> 标签：java, generics, casting

我在 Java 中有一组相当复杂的泛型类。例如，我有一个接口

```
interface Doable<X,Y> {
  X doIt(Y y);
} 
```

和实施

```
class DoableImpl implements Doable<Foo<Bar<Baz,Qux>>,Foo<Bar<Zot,Qux>>> {
  Foo<Bar<Baz,Qux>> doIt(Foo<Bar<Zot,Qux>> fooBZQ) { ... }
} 
```

在实际的实现中，`Doable`有不少方法`Foo<Bar<Baz,Qux>>`等等，一遍又一遍地出现。（信不信由你，泛型类型比这更痛苦。我已经为示例简化了它们。）

我想简化这些，以节省自己的打字时间并减轻眼睛的压力。我想要的是有一个简单的“类型别名” `Foo<Bar<Baz,Qux>>`，等等，比如`FooBBQ`和`FooBZQ`。

我目前的想法是定义包装类：

```
class FooBBQ { 
  public static FooBBQ valueOf(Foo<Bar<Baz,Qux>> fooBBQ) { 
    return new FooBBQ(fooBBQ); 
  }
  private Foo<Bar<Baz,Qux>> fooBBQ;
  private FooBBQ(Foo<Bar<Baz,Qux>> fooBBQ) { 
    this.fooBBQ = fooBBQ; 
  }
  public Foo<Bar<Baz,Qux>> toGeneric() {
    return fooBBQ;
  }
}

class FooBZQ { /* pretty much the same... */ }

class DoableImpl implements Doable<FooBBQ,FooBZQ> { 
  FooBBQ doIt(FooBZQ fooBZQ) { ... }
} 
```

这很好用，但它有一些缺点：

1.  我们需要为每个通用实例定义单独的包装器。包装类很短且风格化，但我想不出一种宏化它们的方法。
2.  我们有调用`valueOf`and在and`toGeneric`之间转换的转换开销（从概念上讲，如果不是操作上的话） 。例如，如果调用一些需要 a 的库例程（实际实现会这样做），我们最终会得到类似`FooBBQ``Foo<Bar<Baz,Qux>>``doIt``Foo<Bar<Zot,Qux>>`

    ```
    return FooBBQ.valueOf( libraryCall( fooBZQ.toGeneric() ) ) 
    ```

    我们原本应该拥有的地方

    ```
    return libraryCall(fooBZQ); 
    ```

有没有其他方法可以在这里获得我想要的“类型别名”行为？也许使用一些第三方宏工具集？或者我是否需要接受我将不得不进行大量输入，一种方式（在实现中使用泛型类型）或另一种方式（为它们编写包装器）？也许让这么多通用参数到处乱跑只是一个坏主意，我需要重新考虑这个问题？

[更新]好的，我禁止任何进一步的“不要那样做”的答案。将其视为在我的问题域中具有真正价值的给定`Foo<Bar<Baz,Qux>>`（Pete Kirkham 可能是对的，它具有*足够的*价值来获得具有描述性名称的适当包装类）。但这是一个编程问题；不要试图定义问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T22:40:58.540

如果您想要完全类型安全，我认为如果没有某种包装类，您将无法做得更好。但是，为什么不让这些类继承/实现原始的通用版本，如下所示：

```
public class FooBBQ extends Foo<Bar<Baz,Qux>> {
...
} 
```

这消除了对`toGeneric()`方法的需求，而且在我看来更清楚的是，它只是一个类型别名。`FooBBQ`此外，可以在没有编译器警告的情况下转换泛型类型。如果可能的话，我个人倾向于制作`Foo, Bar, Baz...`接口，即使在实现中会出现一些代码重复。

现在，在不知道具体问题域的情况下，很难说您是否需要，`FooBBQ`比如在您的示例中，或者可能是：

```
public class FooBar<X, Y> extends Foo<Bar<X, Y>> {
...
} 
```

另一方面，您是否考虑过简单地将 Java 编译器配置为不显示一些泛型警告，而简单地省略泛型定义的部分？或者，战略性地使用`@SuppressWarnings("unchecked")`？换句话说，你能不能`DoableImpl`只做“部分通用化”：

```
class DoableImpl implements Doable<Foo<Bar>>,Foo<Bar>> {
    Foo<Bar> doIt(Foo<Bar> foobar) { ... } 
} 
```

为了减少代码混乱而忽略警告？同样，如果没有具体示例，很难做出决定，但这是您可以尝试的另一件事。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-10-11T22:34:47.343

Scala 对类型别名有很好的支持。例如：

```
type FooBBQ = Foo[Bar[Baz,Qux]] 
```

我意识到如果您没有切换到 Scala 的选项，这个答案将无济于事。但是，如果您确实可以选择切换，则可能会更轻松。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T21:40:33.180

> 也许让这么多通用参数到处乱跑只是一个坏主意，我需要重新考虑这个问题？

很可能。是否需要在 8 个维度上专门化“Doit”？

在很多情况下，这些类型并不存在于真空中，您应该考虑您的“包装器”代表什么域对象，而不是将它们用作编码方便。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-30T15:43:25.170

好吧，Java 没有类型别名，所以你不走运。但是，类型别名有时可以用类型变量代替！所以我们用更多的泛型来解决泛型太多的问题！

由于您已经从示例中删除了所有内容，我无法猜测在何处引入其他类型变量或是否有意义，但这是一种可能的分解：

```
class DoableImplFoo<A,B> implements Doable<Foo<A>,Foo<B>> {
  public DoableImplFoo(SomePropertyOf<A,B> aAndBAreGoodEnough) { ... }
  Foo<A> doIt(Foo<B> fooB) { ... }
} 
```

当您实例化`A`to`Bar<Baz,Qux>`和`B`to`Bar<Zot,Qux>`之后，您可能会发现又有一些样板，但它可能比您最初拥有的要少。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T21:41:34.567

我会说，是的，你需要重新考虑这个问题。宣言

```
 class DoableImpl implements Doable<Foo<Bar<Baz,Qux>>,Foo<Bar<Zot,Qux>>> {
    Foo<Bar<Baz,Qux>> doIt(Foo<Bar<Zot,Qux>> fooBZQ) { ... } 
 } 
```

是过度使用泛型的一个非常明显的例子。

# python - 如何将函数和参数放入python队列？

> ID：683542
> 
> 赞同：13
> 
> 时间：2009-03-25T21:27:52.493
> 
> 标签：python, multithreading

我有一个带有 2 个线程的 python 程序（让我们将它们命名为“源”和“目标”）。源线程有时会向目标线程发布带有一些参数的消息。目标线程选择一条消息后，它必须调用相应的函数，并将参数保存在消息中。

此任务可以通过多种方式解决。最简单的方法是在目标线程的消息选择周期中放置一个大的“if...if..if”，并根据接收到的消息类型和保存的参数调用函数。但这将导致大量代码（或大查找表），并且添加新消息/处理程序函数将演变为在消息选择周期中编写代码的附加步骤。

由于python将函数视为一等对象并具有元组，因此我想将函数和参数放在消息中，因此目标线程选择消息时它只是调用保存在消息中的函数而不知道它是什么函数。

我可以为具有指定数量参数的函数编写代码：

```
from Queue import *
from thread import *
from time import *

q = Queue()

def HandleMsg( arg1, arg2 ) :
  print arg1, arg2

def HandleAnotherMsg( arg1, arg2, arg3 ) :
  print arg1, arg2, arg3

def DestinationThread( a ) :
  while True :
    (f, a, b) = q.get()
    f( a, b )

start_new_thread( DestinationThread, ( 0, ) )
print "start"
sleep( 1 )
q.put( (HandleMsg, 1, 2) )
sleep( 1 )
print "stop" 
```

问题是：如何修改代码以便我可以将具有任意数量参数的函数放入队列中？例如 HandleAnotherMsg() ？使用 q.put( (HandleAnotherMsg, 1, 2, 3) ) 会产生编译错误:(

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-03-25T21:46:41.543

很简单：

```
def DestinationThread( a ) :
  while True :
    items = q.get()
    func = items[0]
    args = items[1:]
    func(*args) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-25T23:41:43.637

另一个有趣的选择是简单地传入一个 lambda。

```
q.put(lambda: HandleMsg(1,2))
q.put(lambda: HandleAnother(8, "hello", extra="foo"))

def DestinationThread() :
   while True :
      f = q.get()
      f() 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-25T21:46:45.020

```
from Queue import *
from thread import *
from time import *

q = Queue()

def HandleMsg( arg1, arg2 ) :
  print arg1, arg2

def HandleAnotherMsg( arg1, arg2, arg3 ) :
  print arg1, arg2, arg3

def DestinationThread() :
  while True :
    f, args = q.get()
    f(*args)

start_new_thread( DestinationThread, tuple() )
print "start"
sleep( 1 )
q.put( (HandleMsg, [1, 2]) )
sleep( 1 )
q.put( (HandleAnotherMsg, [1, 2, 3]) )
sleep( 1 )
print "stop" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T22:23:30.847

我之前使用过类似的构造：

```
class Call:
    def __init__(self, fn, *args, **kwargs):
        self.fn = fn
        self.args = args
        self.kwargs = kwargs

    def __call__(self):
        return self.fn(*self.args, **self.kwargs)

x = Call(zip, [0,1], [2,3], [4,5]) 
```

然后，您应该能够将 x 传递给您的另一个线程并从那里调用它：

```
x() # returns the same as zip([0,1], [2,3], [4,5]) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T21:54:18.340

听起来您想使用`apply()`内在函数或其继任者：

```
def f(x. y):
   print x+y

args = ( 1, 2 )

apply(f, args)   # old way

f(*args)        # new way 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T23:33:57.790

您可以使用 run 方法创建抽象消息类。然后对于每个需要通过队列传输的函数，子类化并实现该函数作为run方法。发送线程将创建适当子类的实例并将其放入队列中。接收线程会从队列中获取一个对象，盲目的执行run方法。

这通常称为命令模式（Gamma 等人）

例子：

```
class Message (object):
    """abstract message class"""
    def __init__(self, **kwargs):
        self.kwargs = kwargs

    def run(self):
        pass

class MessageOne (Message):
    """one message class"""
    def run(self):
         # perform this emssage's action using the kwargs 
```

发送方将实例化并发送一条消息：

```
queue.put(MessageOne(one='Eins', two='Deux')) 
```

接收者只需获取一个消息对象并执行它的 run 方法（无需通过可用的消息类型执行它..else..）：

```
msg = queue.get()
msg.run() 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-03-25T21:35:34.737

你为什么不继承队列？

```
 class MyQueue(Queue):
  # by using *args, you can have a variable number of arguments
  def put(self,*args):
    for arg in args:
       Queue.put(self,arg) 
```

或者，你为什么不列一个清单？

```
 list = [function_obj]
for arg in function_args:
   list.append(arg)
queue.put(list) 
```

# c# - 实现操作临时存储的优雅方式 - ASP.NET

> ID：683543
> 
> 赞同：0
> 
> 时间：2009-03-25T21:27:54.113
> 
> 标签：c#, asp.net, json

我有一个用户控件，在加载时我有一些来自数据库的数据。用户可以以不同的方式（CRUD）操作数据。操作数据的过程可能会导致服务器端事件或客户端事件。然后页面上有一个保存按钮，最终处理临时数据并将其写入数据库。

我正在寻找一种优雅的方法来解决这个问题。我的想法是：

*   加载时，使用隐藏变量并将数据（此时以自定义数据结构的形式）序列化为 JSON
*   在任何操作数据的事件（服务器端/客户端）上，反序列化，执行操作并序列化回隐藏变量
*   在最终保存时，反序列化为它首次加载的数据结构并命中数据库

由于所有这些都发生在 ASCX.CS 中，我不能真正使用很酷的 OOP 东西（如果将来他们决定这些操作不应该在临时存储中完成，而是在数据库中完成，那么对于多态性）

我几乎被一种具有一堆静态方法的类的方法所困扰，这些方法对每个操作都有一个方法。在后面的代码中，当有需要处理的事件时，我将不得不序列化/反序列化数据。

**编辑-有什么帮助吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T04:35:27.847

ADO.Net。在内存数据结构中，您只需在进程结束时提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T18:44:17.683

最简单的方法可能是在页面第一次加载时将对象存储在视图状态中，让用户对其进行操作，然后在用户想要保存它时将其保存回数据库。

但是，这种方法的一个问题是，如果多个用户同时编辑同一个项目，您最终可能会遇到数据被覆盖的情况。

例如。

1) 用户 A 加载页面并开始进行更改 2) 用户 B 加载页面并开始进行更改 3) 用户 A 按保存。更改保存到数据库 4) 用户 B 按保存。更改保存到数据库，覆盖用户 A 的更改。

您可以通过使用时间戳来保存上次更新的日期和时间，并在提交 udpate 之前将其与视图状态中的日期和时间进行比较来解决此问题。或者，您可以在有人开始编辑项目时锁定项目，阻止两个人同时进行更改，尽管这种解决方案可能不太可靠（例如，如果用户在编辑时离开页面会发生什么情况）。

# c++ - ObjectiveC 中的 AMF0 解析器

> ID：683544
> 
> 赞同：0
> 
> 时间：2009-03-25T21:27:54.287
> 
> 标签：c++, objective-c

我正在编写一个连接到 FLV 流并解析数据以提取 SCRIPTDATAOBJECT 的应用程序。

我成功获取了 DATASCRIPTOBJECT 的内容并尝试解析 AMF0 数据以获取一些元数据，您知道 AMF0 解析的示例代码吗？

非常感谢。

蒂埃里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T08:15:34.730

以 MIT 风格获得许可：[用于服务器和客户端的 Flash Remoting 格式 (AMF0/AMF3) 的 Objective-C 实现](http://github.com/nesium/cocoa-amf/tree/master)

# security - 如何保护新 API 中的数据访问？

> ID：683549
> 
> 赞同：3
> 
> 时间：2009-03-25T21:29:47.307
> 
> 标签：security, api, rest

我正在设计一个 API，我想问一些关于如何最好地保护数据访问的问题。

假设 API 允许访问艺术家。艺术家有专辑，有歌曲。

API 的用户可以访问所有艺术家的子集。如果用户调用 API 请求某个艺术家，很容易检查用户是否被允许这样做。

接下来，如果用户请求专辑，API 必须检查专辑是否属于允许用户访问的艺术家。访问歌曲意味着 API 必须先检查专辑，然后再检查艺术家，然后才能授予访问权限。

在数据库方面，我正在查看每个添加的附加层的表之间的连接数量越来越多。我不想进行所有这些连接，我也不想在任何地方存储用户 ID 以限制连接的数量。

为了解决这个问题，我想出了以下方法。

API 为用户提供对象的引用，例如艺术家对象。然后，用户可以向该艺术家对象询问专辑，这将返回一个列表对象。可以遍历列表对象，从中获取专辑对象。同样，可以从专辑对象获得歌曲列表对象，并从中获得单独的歌曲对象。

由于 API 信任艺术家对象，因此它也信任用户从中获取的任何对象（在本例中为专辑），无需进一步检查。对于所有其他对象，依此类推。所以我将安全/信任委托给链下的对象。

我想问你你怎么看它，它有什么好处或坏处，当然还有你将如何解决这个“问题”。

其次，如果 API 应该是 RESTful 的，你将如何处理这个问题？在这种情况下，我的方法似乎不太适用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-11T21:21:12.663

这是一个真实的程序还是一个说明问题的示例？因为不清楚为什么您会限制对艺术家和专辑的访问，而不仅仅是单个媒体项目甚至曲目。

我不认为连接应该花费你那么多，当你在多个表上进行相当简单的标准匹配时，任何半智能的数据库系统都会足够便宜地完成它们。

恕我直言，将这么多安全逻辑放入查询中的问题在于它限制了您处理肯定会绑定的更复杂 DRM 问题的能力。例如，如果专辑是多位艺术家的合集怎么办？如果专辑包含一首二重唱曲目而我只能访问一位艺术家怎么办？等等等等

我的观点是，在这些情况下，具有合理异常的便捷编程模型比单个查询的性能重要得多，您将来可以随时对其进行缓存或优化。您尝试对查询执行的操作听起来像是过早的优化。

尽可能灵活地设计您的编程模型。定义合理的扩展意义，然后在分析真实系统后着手实现数据库和优化查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T21:00:45.587

执行连接可能比您的对象方法快得多（尽管它更优雅）。对于连接，您只有一个数据库请求，而您有很多对象。（或者您必须在第一个请求中检索所有“可能的”数据，这也可能会减慢速度）

我建议做连接。如果有关于 sql 的问题，您可以在 stackoverflow 上询问：D

另一个想法：

如果你制作像“/beatles/whitealbum/happinesisawarmgun”这样的网址

那么您会在请求开始时就知道艺术家，并且无需遍历即可立即获得许可 - 因为 url 包含遍历信息。只是一个想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T18:20:11.350

为每个资源包括一个安全描述符是一个好主意，而不仅仅是顶级资源。在您的示例中，安全描述符只是艺术家 ID 或艺术家 ID 列表，如果您支持二重奏等。所以我会考虑将 ID 列表添加到艺术家和歌曲表中。您可以添加一个字符串字段，其中资源的艺术家 ID 将以逗号分隔的方式写入。

这样的解决方案扩展性很好，您可以添加更多层而不增加安全检查所需的时间。添加新资源也不需要任何额外的惩罚，除了要插入一个更多字段（基于资源的父字段）。当然，此解决方案支持上述特殊情况（如多个艺术家等）。

这种解决方案也不违反 RESTful 架构。

并且每个资源都包含自己的安全描述符这一事实概括了资源的访问权限，使得将来可以实现一些完全不同的安全策略（例如，使访问权限更加精细，基于专辑，而不仅仅是艺术家）。

# search - 部分研究框架/库的有效策略

> ID：683550
> 
> 赞同：6
> 
> 时间：2009-03-25T21:30:00.240
> 
> 标签：search, frameworks

我记得研究新框架的旧有效方法。MFC 说，这始终是阅读一本关于该主题的好书的最佳方式。当我试图跳过大量材料以加快编码速度时，后来发现先阅读整本书会更快。没有好的方法来研究一个小部分的框架。或者至少我当时没有看到他们。

过去几年发生了很多新事物：谷歌搜索结果的改进、博客编程、更多人参与互联网讨论、大量开源框架。

现在，当我们编写软件时，我们经常依赖第三方（通常是开源）框架/库。很多时候，我们只需要知道它们的一小部分功能就可以使用它们。它只是找到使用库的一小部分的最简单方法，而无需不必要的悲观。

**您如何尽可能少地研究框架并仍然有效地使用它？**

例如，假设您需要使用[Lucene](http://en.wikipedia.org/wiki/Lucene)索引一组文档。而且您需要突出显示搜索片段。如果您深入研究 Lucene，您不会关心词干分析器、将索引存储在一个文件中而不是多个文件、模糊查询和许多其他会占据您大脑的东西。

**那么你有什么策略、方法和技巧来节省你的时间呢？**

我会列举我会做什么，虽然我觉得我的过程可以改进。

*   搜索“lucene教程”、“lucene高亮示例”等。尝试根据发布日期、评论数量和评论语气来估计非官方文章（博客文章）的信任度。如果没有明确的答案 - 收集目标上的新搜索关键字和链接。
*   在官方网站上搜索真正的快速教程/新手指南
*   估计 javadocs 对新手的价值。（阅读[Lucene 高亮包摘要](http://lucene.apache.org/java/2_4_1/api/org/apache/lucene/search/highlight/package-summary.html)）
*   搜索库附带的与您需要的相关的简单示例。（学习“src/demo/org/apache/lucene/demo”）
*   在 Lucene 邮件列表中询问“简单的 Lucene 搜索突出显示示例”。如果你问了一个愚蠢的问题，你可能得不到答案，甚至会受到坏名声。而且往往你不知道你的提问是不是很傻，因为你没有深入研究过框架。
*   在 Stackoverflow 或其他 QA 服务上询问它“你能给我一个在 Lucene 中突出显示搜索关键字的工作示例”。然而，这个问题非常具体，可能得不到答案或得分不好。
*   估计如果框架代码是开源的，那么从框架代码中获得答案的难易程度。

**你的学习/搜索路线是什么？如果可能，请按优先顺序编写它们。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-17T20:51:05.990

我使用三阶段技术来评估 API。

1) 发现 - 在这个阶段，我使用尽可能多的不同搜索短语组合搜索 StackOverflow、CodeProject、Google 和新闻组，并将可能适合我需要的所有内容添加到一个巨大的列表中。

2) 过滤/排序——对于我在收集阶段找到的每个项目，我都会尝试找出它是否适合我的需要。为此，我直接进入 API 文档并确保它具有我需要的所有功能。其结果进入加权列表，最佳解决方案位于顶部，所有杂项都被过滤掉。

3) 原型——我选择了前几个竞争者，并尝试做一个小的实现来触及所有重要的特性。最适合这里的项目的就是赢。如果由于某种原因，在实施过程中出现了最佳选择，则可以求助于其他实施。

当然，为项目选择最佳 API 有很多因素。一些重要的：

1.  这将增加我的分布规模多少？
2.  API 与我现有代码风格的契合度如何？
3.  它是否有高质量/任何文档？
4.  是不是很多人都在用？
5.  社区有多活跃？
6.  开发团队有多活跃？
7.  开发团队对错误补丁请求的响应速度如何？
8.  开发团队会接受我的补丁吗？
9.  我可以扩展它以满足我的需要吗？
10.  整体实施的成本有多高？

...当然还有更多。这一切都非常依赖于项目。

至于节省时间，我想说在这里节省太多只会回来咬你。选择一个好的库所花费的时间至少与实施它所花费的时间一样重要。另外，考虑一下，在六个月后，您是愿意愉快地编码还是宁愿与仇外的开发团队争论 :)。现在多花几天时间对你的选择进行全面评估，以后可以省去很多痛苦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-17T19:32:55.820

您的问题的答案取决于您在一般性/特殊性连续统一体中的位置。您想解决眼前的问题吗？您是否希望深入了解图书馆？你很有可能在这两个极端之间。[Jeff Atwood 有一篇](http://www.codinghorror.com/blog/archives/001004.html)关于程序员如何根据需要在这些级别之间移动的帖子。

刚开始时，最好阅读其中一位设计师的框架或库（或语言，或任何技术）的高级设计。试着确定他们试图解决什么问题，设计背后的组织原则是什么，以及核心特征是什么。这将形成未来的理解所依据的概念框架。

现在跳进去。创造一些东西。**不要**复制和粘贴某人的代码。相反，当事情不起作用时，请详细阅读错误消息以及这些错误消息的帮助，并找出错误发生的原因。当事情不起作用时，它可能会令人沮丧，但它会迫使你思考，那就是你学习的时候。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-17T10:22:37.930

1) 在 Google 上搜索我的任务

2）看**几个不同库**的例子，如果我不知道我还有什么其他选择，就不需要把自己束缚在 Lucene 上。

3) 查看主页最后一次更新的日期，**如果在 6 个月内没有更新**（有一些例外）

4) 使用库搜索示例任务（尚未阅读教程）

5)**如果没有教程，我能理解发生了什么吗？**如果是，则继续，如果没有，则从 1 开始

6）**尝试执行任务**

7）看着自己失败

8) 阅读教程

9）尝试执行任务

10）看着自己失败并在 StackOverflow 上提问，或者给作者发邮件，在用户组上发帖（如果看起来很友好）

11）**如果我能完成任务，我会考虑值得研究的框架**并阅读主要教程 2 小时（如果它不适合 2 小时，我会忽略剩下的，直到我需要它）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-17T10:59:05.420

我没有秘诀，就我一直遵循的一系列步骤而言，这主要是因为我学到的一切都是不同的。有些东西对我来说是全新的（例如 Dojo，我不流利地使用 Java 脚本，所以这是一项艰巨的任务），有些只是对以前知识的增强（我非常了解 EJB 2，所以表面上学习 EJB 3 对所有人来说都是新的它的注释，它建立在概念之上。）

不过，我的总体策略是我将其描述为“螺旋和公园”。我试着先把景观圈起来，了解大致的形状，我还没有*得到的***公园**概念，不要让它让我担心。然后我会更深入地研究一些领域，但再次尽量不要沉迷于某个领域，逐渐**深入**主题。希望我开始解禁和理解，但也需要停放更多的东西。

 ***最初我想回答以下问题：

*   这是为了什么？
*   为什么我要使用这个而不是我已经知道的其他东西
*   有什么可能？任何有趣的甜蜜点。“例如。哦，看看那个漂亮的 AJAX 驱动更新”

我做了大量的略读。

然后我想对如何做更多的探索。我开始寻找陷阱和好的建议。（例如在 java 中：为什么**"wibble".equals(var)**是一个有用的构造？）

具体技术和信息来源：

*   最重要的：做！我想尽早完成一两个教程。我可能必须完成螺旋的第一个循环，但随后我想触摸和实验。
*   概述文件
*   产品文件
*   论坛和讨论组，通过回答问题来学习是我最喜欢的技术。
*   如果可能的话，我会尝试寻找大师。我很幸运，我的直属同事拥有丰富的知识和经验。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-17T14:34:08.373

1.  快速入门指南。
2.  快速查看 API 文档（如果有）。
3.  阅读示例代码。
4.  **乱搞**你必须乱搞（对不起帽子）。

如果它是一个小型库/API，社区很小或没有社区，您可以随时联系开发人员本人并寻求帮助，因为他可能会非常乐意为您提供帮助；他很高兴又有一个人在使用他的 API。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-17T21:00:24.880

只要您在提问之前先做好功课，邮件列表就是一个很好的资源。

对于我在 CoreAudio 相关内容上遇到的大多数问题，邮件列表**存档非常宝贵。**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-17T14:43:36.453

我永远不会阅读javadoc。因为经常没有。如果有，很可能它不是最新的。所以一个人最多会感到困惑。

从几分钟内找到的最简单的教程开始。通常，本教程最后会引导您找到更多资源，因此大多数时候，您会走上一条不断前进的道路，越来越深。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-17T21:22:02.260

这实际上取决于主题是什么以及其中包含多少信息。通过示例学习是开始一个全新主题的好方法，特别是如果您熟悉其他类似的库或语言。你可以选择一个你熟悉的话题，然后说“我了解如何使用 X 来实现，让我们看看它是如何使用 Y 来实现的”。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-08-17T10:16:38.127

**那么你有什么策略、方法和技巧来节省你的时间呢？**

嗯，我搜索。我一般从不提问，更喜欢自己研究。如果情况变得更糟，我会阅读文档。在某些情况下（例如，当我使用 SharpSVN 进行一些工作时）我必须查看源代码，特别是测试用例，以获取有关 API 工作原理的一些信息。

一般来说，我必须说实话，我的大部分“学习”和“学习”都是偶然的。

例如，就在几秒钟前，我发现了如何在 C# 中获取“Recent”文件夹。在看到问题之前，我不知道该怎么做，认为它很有趣，然后搜索。

所以对我来说，真正的“诀窍”是我在论坛上闲逛，回答问题，并意外地获取知识。然后当我需要研究一些东西的时候；有可能我对此有所了解，搜索更容易，我可以专注于实现[通常首先实现一个测试程序]并从那里取得进展。

# c++ - 在运行时区分指针和引用 ANSI C++

> ID：683551
> 
> 赞同：1
> 
> 时间：2009-03-25T21:30:02.987
> 
> 标签：c++, pointers, reference, stack, malloc

在运行时如何区分指针和引用？例如，如果我想在不知道它是否是指针的情况下释放数据类型的指针，我该怎么做？有什么方法可以判断变量是在堆栈上还是通过 malloc() 分配的？

```
void destInt(int* var)
{
   free(var);
}

int num = 3;
int &numRef = num;
int* numPtr = (int*)malloc(sizeof(int));
*numPtr = num;

destInt(&numRef); //Syntactically correct but generates invalid pointer()
destInt(numPtr); //Fine syntactically and logically 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T21:32:53.387

不，不是在一般情况下，也不是便携方式。如果您知道堆在内存中的位置，您可以做出有根据的猜测，但不是以任何可靠的方式。

编辑：还要注意 C 没有引用。C 中的 & 运算符用于获取变量的地址。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T21:34:15.643

如果它是 ANSI C，那么就没有引用之类的东西，所以你可能想改写你的问题来谈论堆分配的指针或堆栈分配的对象的指针。

通常堆的地址是“小”并且会增长，而堆栈是“大”并且会下降，但这只是一种启发式和不可移植的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T06:28:58.247

在 C++ 中，区分它是引用还是指针*的信息是编译时类型信息的一部分*。在 C 中，这是语义上的不相关区别。

如果您需要使用 & 来获取某物的地址，*那么您不能`delete`或释放它。*否则，如果您要传递指针，则需要记录哪些函数有权访问`delete`或释放它。在 C++ 中执行此操作的最简单方法是使用智能指针类，例如 a`shared_ptr`或`scoped_ptr`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T07:43:45.680

无论你想要完成什么......不要这样做。

您通常可以获得堆栈的边界，但这通常是一个漂亮的编译器/平台特定过程。与堆相同。如果您使用自己的版本挂钩 new 和 delete，您可能知道堆的开始和结束位置。否则你不会。

但是，您正在吠叫的树并不是一棵好树。如果您确信确实需要这样做，请使用指针传递信息。将它包装在一个结构中，该结构也有一个名为 needsFree 或其他东西的布尔值。但除此之外，您遇到此问题的事实通常表明您尝试解决的问题可以以更简洁的方式解决。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T00:27:06.307

使用 malloc 时，内存不是在堆栈中分配，而是在堆中。

# sql - SQL 查询到 VBA 并在表单中显示结果

> ID：683559
> 
> 赞同：0
> 
> 时间：2009-03-25T21:32:35.943
> 
> 标签：sql, ms-access, vba

所以我已经编写了一些查询，我的目标是让用户输入某些字段，这些字段会改变查询的返回方式，基本上是让用户更改原始查询的 2 或 3 个参数。
首先，我在获取要在 VBA 中执行的查询时遇到问题：

```
Private Sub QResultButton_Click()
DoCmd.OpenQuery (Readings2009, acViewPreview,acReadOnly)
End Sub 
```

[Readings2009 是我在 Access 中创建的查询] 这会返回语法错误。
我也看到这样做了：

```
strSQL = "SELECT Readings2009.id, Readings2009.othercolumn, Readings2009.another 
          WHERE Readings2009.something > today() ..."
DoCmd.RunSQL (strSQL) 
```

我也不能上班。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T21:38:57.583

在此示例中，查询的名称必须是字符串，即必须用引号引起来：

```
DoCmd.OpenQuery "Readings2009" 
```

请参阅：http: [//msdn.microsoft.com/en-us/library/aa220295 (office.11​​).aspx](http://msdn.microsoft.com/en-us/library/aa220295(office.11).aspx)

另一个示例是用于运行操作查询，而不是用于打开查询以查看它们。

最好创建一个表单并使用它来显示您的查询。

# objective-c - NSTableView 排序没有得到正确的 ID

> ID：683563
> 
> 赞同：0
> 
> 时间：2009-03-25T21:32:53.620
> 
> 标签：objective-c, cocoa, double-click

我在 Cocoa 应用程序中使用表视图。我已将双击操作设置为在发生时执行以下方法：

```
- (void)doubleClickInTable:(id)sender {
      int rowIndex = [sender selectedRow];
      if (rowIndex != -1) {
        [userEditController setData:[[self users] objectAtIndex:rowIndex]];
        [self showUserEditPanel];
    }
} 
```

如您所见，EditController 接收正在编辑的对象。此对象是位于源数组的 rowIndex 处的对象。这在大多数情况下都非常有效，但是一旦我开始测试排序，它就会设置错误的对象。这是因为由于排序移动行，表中单击行的索引与源数组不同。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T23:48:06.180

您可以使用相同的排序描述符创建一个排序数组，并`rowIndex`在其中检索对象。另一种方法是，如果您使用的是数组控制器，则可以检索控制器`arrangedObjects`数组中该索引处的对象，该数组已经排序（因此得名）。

# java - 用 Java 编写简单高效的数据库自定义 ORM 代码

> ID：683565
> 
> 赞同：0
> 
> 时间：2009-03-25T21:33:22.743
> 
> 标签：java, sql, orm, jakarta-ee

我有一个想要存储在本地内存数据库中的 Java 对象。Object 具有 One-Many FK 关系，否则它有 20 个左右的 Integer/String/Enumerated 字段。

我想避免使用框架。

即使对象本身不是很大，也会有大量这些对象以高频率插入/更新（每 5 秒更新 20,000 次）。

解决这个问题的最简单方法是什么？我想要的是 Java 对象进入这个 ORM 层，Java 对象离开这个 ORM 层（当被查询时）。我也希望能够查询对象。

有小费吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T21:37:55.667

你不需要 ORM 解决方案：你需要一个缓存解决方案。以下是[更流行的 Java 网格、缓存和集群解决方案的概述](https://stackoverflow.com/questions/383920/what-is-the-best-library-for-java-to-grid-cluster-enable-your-application/383929#383929)。

我可能会先看看[兵马俑](http://www.terracotta.org/)。

你说你不想要一个框架。好吧，我不敢苟同：ORM 很复杂。缓存很复杂。更重要的是，当你自己做时，你一定会弄错（这不是对你的反思，它几乎普遍适用）。除了接口之外，这里还有一些问题需要考虑，例如容错、一致性、持久性、恢复等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T21:41:17.017

[Prevayler](http://www.prevayler.org)将是最好的，批量写入。

在查看复杂的缓存和分发解决方案之前，您想先尝试一下。

# asp.net - 为什么 System.Web.Security.Membership.GetAllUsers 不显示我为在线用户？

> ID：683568
> 
> 赞同：0
> 
> 时间：2009-03-25T21:33:58.717
> 
> 标签：asp.net, security

我正在使用 SqlMembershipProvider 并尝试使用 System.Web.Security 命名空间的 GetAllUsers 方法获取有关用户的信息，但它不检索任何在线用户。

我已登录应用程序，但我的用户也显示为离线。

为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-23T17:58:35.290

查看[这篇](https://connect.microsoft.com/VisualStudio/feedback/Workaround.aspx?FeedbackID=306297)Microsoft Connect 文章，asp.net 2.0 附带的存储过程中有一个错误，LastActivityDate 没有得到更新。isOnline 属性基于上次活动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-18T22:44:49.763

检查 aspnet_Users 表中的 LastActivityDate 是否已更新。

如果不是，则尝试获取用户的详细信息，并将 online 标志设置为 true（当他们登录时。

例如

```
Membership.GetUser(username, true); 
```

还值得看看你的 UserIsOnlineTimeWindow 也设置了什么。

# asp.net - JQuery BlockUI - 文件下载后如何解锁 UI？

> ID：683571
> 
> 赞同：4
> 
> 时间：2009-03-25T21:35:39.243
> 
> 标签：asp.net, javascript, jquery, blockui

使用 ASP.Net、JQuery 和 BlockUI，我试图在显示下载文件对话框后解除对 UI 的阻止。

单击导出按钮时，我会阻止 UI：

```
 <script type="text/javascript">     
    $(document).ready(function(){        
        $('#<%= BtnExport.ClientID%>').click(function(){
            $.blockUI(); 
        });
    });    
    </script> 
```

在此之后，我使用以下命令生成文件服务器端：

```
 private void SendFileToUser(byte[] file, string contentType, string filename)
        {
            Response.Clear();
            Response.ContentType = contentType;
            Response.AppendHeader("Content-Disposition", "attachment; filename="+filename);
            Response.OutputStream.Write(file,0,file.Length);
            Response.OutputStream.Flush();   
            Response.End();
        } 
```

执行此代码后，我想解除对 UI 的阻止。

我考虑了不同的选择：

1.  使用 Ajax 调用轮询以查看文件是否已生成。
2.  将文件存储在 Session 中并重定向到同一页面并生成下载。

但是这两个选项似乎都不合适，我认为必须有一种聪明的 JavaScript 方法来处理或等待文件对话框。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T07:49:49.573

没有办法检查这一点；没有像 ondownloadready 这样的事件。但是有一些解决方法 [http://gruffcode.com/2010/10/28/detecting-the-file-download-dialog-in-the-browser](http://gruffcode.com/2010/10/28/detecting-the-file-download-dialog-in-the-browser)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T21:45:13.667

不要将文件存储在会话中，这是对资源的巨大浪费。为什么不将您的表单数据发布到带有“您的文件应立即下载...”消息的“下载”页面。这就是流行的下载网站（如[www.download.com](http://www.download.com)）在到达其[下载页面](http://download.cnet.com/3001-2351_4-10516749.html?spi=1a0e98bcec994b50be46bb44353e595a)时的做法。

这使用户有机会通过刷新来重试，并且您无需担心会话超时，因为您的所有数据在到达页面时都在 POST 标头中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-17T12:36:57.423

我使用的方法是除了发送文件附件之外的 cookie，您可以使用 JavaScript 通过超时检测，然后解除阻止 ui

详细信息在这里[http://geekswithblogs.net/GruffCode/archive/2010/10/28/detecting-the-file-download-dialog-in-the-browser.aspx](http://geekswithblogs.net/GruffCode/archive/2010/10/28/detecting-the-file-download-dialog-in-the-browser.aspx)

# ruby-on-rails - Rails ActiveResource HABTM 返回值

> ID：683576
> 
> 赞同：1
> 
> 时间：2009-03-25T21:36:30.630
> 
> 标签：ruby-on-rails, activeresource

我有两个模型： Company 和 User 他们有 has_and_belongs_to_many 关系。

我正在使用活动资源来获取公司的所有用户：

```
def users
  @company = Company.find( params[:id], :include => [:users] )
  render :xml => @company.users.to_xml(:include =>[:companies])   
end 
```

唯一的问题是，另一方面，当我调用我的 lookup_users 方法时，返回的 val 是一个数组 Company 对象，每个对象都有一个公司属性，而不是一组 User 对象，每个对象都有一个公司属性见下面的输出：

有谁知道我如何显式设置要通过 activeresource 返回的对象类型？

这很奇怪，因为在我的服务中调用 @company.users.to_xml 会呈现看起来很正常的 xml：注意“ `<users type='array'>`”，但是当它返回时，它是一个公司对象。

```
"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<users type=\"array\">\n  <user>\n    < 
```

上述服务调用的返回值：(rdb:1) pp users

```
[#<AsClient::Company:0x1959628   @attributes=    {"work_phone"=>nil,
    "city"=>nil,
    "fax_number"=>nil,
    "company"=>nil,
    "updated_at"=>Wed Mar 25 21:05:43 UTC 2009,
    "postal_code"=>nil,
    "title"=>nil,
    "the_parent_record_id"=>"650",
    "hashed_password"=>"d80052727e9719113277bcc712d647aedefaff4b",
    "last_logged_into"=>nil,
    "last_seen_at"=>nil,
    "customers"=>
     [#<AsClient::Company:0x19568c4
       @attributes=
        {"name"=>"hmvc0joq",
         "updated_at"=>Wed Mar 25 21:05:43 UTC 2009,
         "main_contact"=>nil,
         "id"=>650,
         "customer_id"=>"650",
         "deleted"=>nil,
         "deleted_by"=>nil,
         "user_id"=>"3263",
         "created_at"=>Wed Mar 25 21:05:43 UTC 2009,
         "active"=>nil},
       @prefix_options={}>],
    "created_by"=>"AsTesting",
    "password_salt"=>"m8j35JAnpd0IlllSHDCfd0BE5R1UHoT1",
    "country"=>nil,
    "activation_code"=>"8xB2J7LL3tQuK2Z9I1AKhAcotaSp8zgz",
    "id"=>3263,
    "updated_by"=>nil,
    "password_reset_code"=>nil,
    "address_1"=>nil,
    "home_phone"=>nil,
    "deleted"=>false,
    "address_2"=>nil,
    "deleted_by"=>nil,
    "first_name"=>"Joe",
    "last_name"=>"Test",
    "province"=>nil,
    "mobile_phone"=>nil,
    "suffix"=>nil,
    "alt_email"=>nil,
    "created_at"=>Wed Mar 25 21:05:43 UTC 2009,
    "email"=>"auf@b.c",
    "active"=>false,
    "middle_name"=>nil},   @prefix_options={}>] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T22:17:34.027

我真的不明白你的问题是什么。在您的示例中，@company 是对象，但 @company.users 是用户对象数组。

你打电话时：

```
@company.users.to_xml(:include =>[:companies]) 
```

这可能会呈现一系列用户，并且对于每个用户，它将包括一系列公司。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T13:36:26.050

糟糕，我确实发现了我的问题。我的客户正在打电话

```
users = Company.find(:all, :params => {:id => company_id}, :from => :users) 
```

这显然会返回一个 Company 对象......

我需要更多的睡眠

# javascript - 如何将焦点放在jquery中的窗口上？

> ID：683577
> 
> 赞同：9
> 
> 时间：2009-03-25T21:37:28.523
> 
> 标签：javascript, jquery

我正在尝试使用 jquery 将焦点放在窗口上。该窗口是通过单击父页面上的按钮启动的。我在子窗口中进行了一些 ajax 调用，因此正在更新数据。我的问题是，如果用户单击父窗口并将子窗口隐藏在其后面，如果有数据更新，我想将该子窗口带回到最前面。

在 $(document).ready 中，我连接了这些事件：

```
 $(window).blur(function(){
    WindowHasFocus =false;
}).focus(function(){
    WindowHasFocus =true;
}); 
```

然后，如果数据更新，我调用这个函数：

```
function FocusInput(){

 if(!WindowHasFocus){
    $(window).focus();
 }
} 
```

这在 IE8 中按预期工作，但在 FireFox（和所有其他浏览器）中，如果我单击父窗口，Blur 事件似乎永远不会触发。关于如何实现这一目标的任何建议/想法？

更新：

总表情： 在 FireFox 中： * 工具 * 选项... * 内容选项卡 * “启用 JavaScript”旁边的高级按钮 * 选中名为“升高或降低 Windows”的框

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T12:26:13.747

总的掌心时刻：在 FireFox 中：

*   工具
*   选项…
*   内容选项卡
*   “启用 JavaScript”旁边的高级按钮
*   选中名为“升高或降低窗户”的框

这是默认关闭的，必须启用。而且，我认为由于它在 Chrome 中不起作用，因此 Safari 将是相同的，但你知道他们所说的“假设”（它适用于 Safari，但不适用于 Chrome）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T21:58:47.160

如果没有充分的理由拥有两个单独的窗口，那么最好使用“模态框”，那里有很多示例和 jquery 插件来实现这一点。这种插件的一个例子： [http ://www.84bytes.com/2008/06/02/jquery-modal-dialog-boxes/](http://www.84bytes.com/2008/06/02/jquery-modal-dialog-boxes/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T22:38:45.397

你完全正确。在 FF 中，似乎它确实触发了事件，但与此同时，它似乎没有将元素注册为焦点。因此，模糊事件永远不会被触发。不确定我是否正确地解释了这一点......下面的代码说明了一切。

在此示例中，该框默认隐藏，但通过焦点事件侦听器显示。在 IE 8 中，如果您单击主窗口，它仍然会触发模糊，但在 FF 中不会：

```
<html>
<head>

</head>
<body>
    <div id="hiddenWin" style="width: 100px; height: 100px; background-color: Black; display: none;"></div>

    <script type="text/javascript" src="http://jqueryjs.googlecode.com/files/jquery-1.3.2.min.js"></script>
    <script type="text/javascript">
        var something = 12;
        something += 4; 

        $(document).ready(function()        
            {

                $("#hiddenWin").focus(function()
                    {
                        $(this).show();
                    }
                ).blur(function()
                    {
                        $(this).hide();
                    }               
                )               

                $("#hiddenWin").focus();
            }
        );
    </script>

</body>
</html> 
```

根据您的需要，设置叠加背景是否可行？固定位置 @ top:0 和 left:0 的东西占据了整个屏幕，并且 z-index 小于您的弹出窗口。这样，当他们单击覆盖时，它将窃取焦点，然后您可以隐藏所有内容...？IDK，只是一个建议。我会继续胡闹，看看我能不能弄明白。好问题。+1

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T21:54:24.957

似乎您不应该关心您的窗户何时变得模糊。当你的数据更新时，你的窗口要么不在焦点上，在这种情况下你想聚焦它，要么它已经在焦点上，再次聚焦它不会对你造成任何伤害。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-26T14:18:00.300

是的，模态的东西可能是要走的路，但有时你只需要按照你想要的方式去做。

我会使用普通的旧 JavaScript。命名窗口并使其成为焦点。

```
 function showImageWindow(imageURL)
    {
        var imageWindow = window.open(imageURL,"My_Window","width=1000px,height=1000px,menubar=0,titlebar=0,toolbar=0,location=0,scrollbars=0,status=0"); 
        imageWindow.focus();
    } 
```

# windows - 为什么我只能在 Windows 上使用 Tie::File 打开 2045 个文件？

> ID：683579
> 
> 赞同：3
> 
> 时间：2009-03-25T21:37:50.970
> 
> 标签：windows, perl, file

我有以下代码试图将数组绑定到文件。除了，当我运行这段代码时，它只创建 2045 个文件。这里有什么问题？

```
#!/usr/bin/perl
use Tie::File;

for (my $i = 0; $i < 10000; $i++) {
    @files{$i} = ();
    tie @{$files{$i}}, 'Tie::File', "files//tiefile$i";
} 
```

编辑：我在窗户上

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-25T21:38:52.030

您正在累积打开的文件句柄（参见[`ulimit -n`](http://www.ss64.com/bash/ulimit.html), [/](http://linux.about.com/library/cmd/blcmdl2_setrlimit.htm)），并且最终达到了 2048 个打开文件描述符的限制（2045 + + + 。）[`setrlimit`](http://www.perlmonks.org/?node_id=254756) [`RLIMIT_NOFILE``RLIMIT_OFILE`](http://linux.about.com/library/cmd/blcmdl2_setrlimit.htm)`stdin``stdout``stderr`

在 Windows 下，您必须重写您的应用程序，以便它在任何时候最多有 2048 个打开文件句柄，因为 2048 限制是 MSVC 中的硬限制（无法修改）`stdio`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T21:46:34.087

在 Linux 机器上，转到`/etc/security/limits.conf`并添加或修改这些行

```
* soft nofile 10003
* hard nofile 10003 
```

这会将每个进程可以打开的文件数量增加到 10003（请记住，您总是从三个打开开始：stdin、stdout 和 stderr）。

根据您的评论，听起来您正在使用 Win32 机器。我找不到增加每个进程打开文件数量的方法，但你可能，而且我强调，可能能够通过[`fork`](http://perldoc.perl.org/functions/fork.html)'ing 处理这个问题（这实际上是 Win32 上的线程）。

# visual-studio-2005 - 在 VS2005/Biztalk 2006 中自动将引用的程序集部署为“资源”

> ID：683581
> 
> 赞同：0
> 
> 时间：2009-03-25T21:38:32.060
> 
> 标签：visual-studio-2005, biztalk, biztalk-deployment

我有一个包含两个项目的解决方案 - 一个项目包含我的架构和 BizTalk 编排，另一个项目包含一个从我的编排中引用并执行实际工作的 DLL（它是共享代码，所以我不可能将它合并到BizTalk 程序集）。第二个程序集是作为 BizTalk 的引用添加的，我可以毫无问题地从编排中引用 #2 中的方法。

但是，当我从 VS -> BizTalk 部署时，它不会带上我的资源程序集 - 它只是部署 BizTalk 程序集。如果我尝试触发我的编排，我会收到无法加载引用的程序集的错误，但是一旦我将它添加到 GAC 和我的 BizTalk 应用程序的“资源”列表中，事情就会完美运行。

如何将此程序集标记为必须与我的 BizTalk 程序集一起部署的东西？我只是在某处缺少参考设置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T23:00:39.277

将以下语句放在批处理文件中并从 VS 命令提示符运行它

```
BTSTask AddResource -Source:.\Assemblies\Schemas.DLL 
  -ApplicationName:MyApp -Type:System.BizTalk:BizTalkAssembly 
  -Options:GacOnImport,GacOnInstall -Overwrite
BTSTask AddResource -Source:.\Assemblies\Orchestrations.DLL 
  -ApplicationName:MyApp -Type:System.BizTalk:BizTalkAssembly 
  -Options:GacOnImport,GacOnInstall -Overwrite
BTSTask AddResource -Source:.\Assemblies\SharedLib.DLL 
  -ApplicationName:MyApp -Type:System.BizTalk:Assembly 
  -Options:GacOnImport,GacOnInstall -Overwrite
BTSTask ExportApp -ApplicationName:MyApp -Package:MyApp.msi 
```

最后你会得到一个 MSI，你需要导入它！这解决了你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T14:13:36.677

我不相信自动将资源添加到 BizTalk 应用程序的解决方案。

我通常使用脚本部署到 BizTalk，因此我添加了资源作为其中的一部分（但是，公平地说，我通常有超过 2 个程序集）；BTSTask 是 BizTalk 命令行实用程序，您可以使用它来执行此操作（或者，如果您使用的是 MSBuild，您可以使用“ [SDC 任务](http://www.codeplex.com/sdctasks)”

# vb.net - 在我的打印机中测试纸张已完成

> ID：683603
> 
> 赞同：0
> 
> 时间：2009-03-25T21:43:53.203
> 
> 标签：vb.net, printing

当打印机中的纸张用完时，有人知道如何在我的 VB 程序中收到警告。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T21:52:37.020

CodeProject 文章“[在 VB.NET 中监控打印机队列](http://www.codeproject.com/KB/printing/printwatchvbnet.aspx)”或 .NET 3.0[`PrinterQueue`](http://msdn.microsoft.com/en-us/library/system.printing.printqueue.aspx)类可能是您正在寻找的。

如果你走这`PrinterQueue`条路，[`PrintSystemJobInfo.IsCompleted`](http://msdn.microsoft.com/en-us/library/system.printing.printsystemjobinfo.iscompleted.aspx)你可以检查一个属性。

# weblogic - 如何将 JNI 代码集成到 weblogic 中？

> ID：683604
> 
> 赞同：1
> 
> 时间：2009-03-25T21:44:17.850
> 
> 标签：weblogic, java-native-interface

我正在编写一个将部署在 weblogic 中的应用程序。作为这个应用程序的一部分，我们使用了一个使用 JNI 的第三方库。如何使 .so 文件可用于 weblogic？

我尝试设置 LD_LIBRARY_PATH 并重新启动 weblogic，但没有成功

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T02:10:41.377

`LD_LIBRARY_PATH`环境变量应在或`setWLSEnv.sh`脚本`startWLS.sh`中设置。

你能告诉我们你在哪里以及如何做到的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-01T12:18:07.610

您可以`.so`在`LD_LIBRARY_PATH`. `commEnv.sh`根据`<WL_install_dir>/common/bin/commEnv.sh`您的操作系统案例块，您可以使用`.so`如下文件夹进行更新

```
LD_LIBRARY_PATH=/usr/vardhan/SOfiles/:${PATCH_LIBPATH}:${LD_LIBRARY_PATH}
export LD_LIBRARY_PATH 
```

显然更新后您需要重新启动所有服务。

# asp.net - ASP.NET Button vs Linkbutton Enabled="false" 行为

> ID：683614
> 
> 赞同：1
> 
> 时间：2009-03-25T21:46:50.170
> 
> 标签：asp.net, webforms, linkbutton

为什么 ASP.NET`LinkButton`控件具有`OnClientClick`属性并通过在 HTML 中设置`Enabled="false"`仍然呈现`onclick`事件处理程序而禁用，而`Button`控件却没有？

这似乎违反直觉。由于在浏览器中不能真正禁用锚点，因此如果在服务器端已将其设置为禁用，则不附加 onclick 事件（和 href 属性）更有意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T21:50:17.337

好吧，我同意它没有太多用途，但是如果不使用 asp.net 中内置的众多方法之一更改链接按钮的呈现方式，那么您实际上无能为力。除非您想有条件地处理客户端代码中的点击并检查元素属性。这只是它当前实现的方式，因此当您需要可以禁用的按钮功能时，最好完全远离链接按钮或锚点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T21:59:54.227

这与asp.net 真的没什么关系。

即使在禁用时，超链接按钮仍会触发 onclick 事件。底线：融入 HTML。（输入标签在禁用时不会触发。）

```
 <a href="javascript:alert('Hello!');" disabled="disabled">Click Me!</a> 
```

# php - 使用 Jumi 将 $_GET[] 参数传递给脚本？

> ID：683616
> 
> 赞同：1
> 
> 时间：2009-03-25T21:47:01.527
> 
> 标签：php, content-management-system, joomla

我正在使用 Jumi 在 Joomla 上包含一些 PHP 脚本！文章，效果很好。我遇到的问题是将变量（以 $_GET 参数的形式）传递给 PHP 脚本。

假设我有一个脚本“index.php”，我希望传递值为“10”的 $_GET[] 参数“var”。这通常通过指向：index.php?var=10 来完成。如何用 Jumi “模拟”这个功能？我希望它会像这样简单：

```
{jumi [directory/index.php] [var=10]} 
```

然而，上面的语法是不正确的。

任何输入将不胜感激。

——尼古拉斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T16:33:43.940

经过官方 Joomla 的反复试验和指导！论坛我确实解决了我的问题。您可以传递一个 $jumi 数组并引用它，而不是传递一个真正的 $_GET[] 参数。

我想避免重写我的大部分脚本，所以我做了以下事情。

1) 像这样拨打 Jumi 电话：

```
{jumi [directory/index.php] [value]} 
```

2) 在 index.php 中：

```
if(isset($jumi[0]))
{
    $_GET['PARAM_YOU_WANT_SET'] = $jumi[0];
} 
```

这是一个非常简单的示例，它模拟了使用 Jumi 将 $_GET[] 参数传递给脚本的快速简便方法。这种方法为我节省了大量时间，因为我不必重写我的控制器。

——尼古拉斯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-29T16:39:46.010

这是我知道的一个旧线程，但有些人可能想知道一些事情。

如果您想在模块中使用带有额外参数的 Jumi，那么 Nicholas 的提示将不起作用，但有一种方法可以做到。

该模块有一个“编写代码”部分和一个“代码源”部分。

将文件的 url/路径放在“代码源”部分中，然后在“代码编写”部分中定义您的变量......它会在执行之前将变量传递给源文件，因此它将执行所需的操作。

![在此处输入图像描述](https://i.stack.imgur.com/XhiA7.png)

# c# - 深入学习 C# 表达式树的最佳资源是什么？

> ID：683620
> 
> 赞同：57
> 
> 时间：2009-03-25T21:47:11.713
> 
> 标签：c#, c#-3.0, lambda, expression-trees

当我第一次输入这个问题时，我这样做是为了找到重复的问题，我确信肯定有人已经问过这个问题了。我的计划是关注那些欺骗链接而不是发布这个问题。但据我所知，这个问题以前没有被问过……它没有出现在“相关问题”列表中。

**您找到了哪些最好的资源（文章、书籍、博客文章等）来深入了解 C# 中的表达式树？** 我一直对他们的能力感到惊讶，现在我要说，“好吧，足够惊讶。我想现在停下来，获得这些东西的博士学位。” 我正在寻找能够系统地、有条不紊地涵盖这些功能的材料，然后通过详细的示例来说明您可以使用它们做什么。

注意：我不是在谈论 lambda 表达式。我说的是Expression< T > 以及所有与它相关并由此产生的东西。

谢谢。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-25T22:20:33.957

Programming Microsoft Linq（ISBN 13：978-0-7356-2400-9 或 ISBN 10：0-7356-2400-3）的第 11 章（内部表达式树）和第 12 章（扩展 Linq）对我来说非常宝贵。我没有读过 Jons 的书，但他是一个有素质的人，而且解释得很好，所以我认为他的报道也会很好。

另一个很棒的资源是[Bart De Smet 的博客](http://community.bartdesmet.net/blogs/bart/archive/tags/LINQ/default.aspx)

另外，请密切关注 MSDN，构建[Simple Linq to Database](http://code.msdn.microsoft.com/SimpleLingToDatabase/Release/ProjectReleases.aspx?ReleaseId=1471)的示例代码（由 Pedram Rezaei 撰写）即将获得大约 40 页的 Doco 解释它。

Expression Tree 的一个非常非常有用的资源实际上我认为它是*必备的，*那就是[Expression Tree Visualiser](http://msdn.microsoft.com/en-us/library/bb397975.aspx)调试工具。

您还应该尽可能多地了解表达式树访问者，这里有一个非常好的基类[实现](http://msdn.microsoft.com/en-us/library/bb882521.aspx)。

这是从该访问者类派生的一些示例代码，用于进行一些调试（我基于我提到的书中的一些示例代码） prependIndent 方法调用只是字符串上的扩展方法，用于在每个缩进处放置一个“--”等级。

```
 internal class DebugDisplayTree : ExpressionVisitor
  {
    private int indentLevel = 0;

    protected override System.Linq.Expressions.Expression Visit(Expression exp)
    {
      if (exp != null)
      {
        Trace.WriteLine(string.Format("{0} : {1} ", exp.NodeType, exp.GetType().ToString()).PrependIndent(indentLevel));
      }
      indentLevel++;
      Expression result = base.Visit(exp);
      indentLevel--;
      return result;
    }
    ... 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-26T08:28:58.067

我不认为它们是全面的，但我的[博客上](http://marcgravell.blogspot.com/search/label/expression)`Expression`有很多帖子。如果您是英国人，我还将在 5 月（以及[昨晚](http://www.gl-net.org.uk/Events/GLnet_March.aspx)，但为时已晚；-p）在[DDD South West举办一次会议。](http://dddsouthwest.com/)如果您愿意，我可以发布幻灯片和相关文章中的一些链接......不幸的是，一个打算被*说出来*的 pptx很少能做出明智的独立阅读。`Expression`

 *其他一些阅读（不是来自博客）：

*   Jason Bock：[基因编程](http://www.jasonbock.net/JB/Default.aspx?blog=entry.b2ff6b7e47ae41929e38beec4093518e)`Expression`
*   （又是我）：[通用运算](http://www.yoda.arachsys.com/csharp/genericoperators.html)符`Expression`
*   （同样，在 InfoQ 上）[`Expression`作为编译器](http://www.infoq.com/articles/expression-compiler)

（以及这里和 microsoft.public.dotnet.languages.csharp 上的大量帖子 - 尝试搜索：+expression -regex -"regular expression"

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-26T11:32:50.650

学习方案。表达式使用与 lambda 演算相同的原理，因此会给你一些更好的洞察力。

或者，您可以查看 DLR，它与此类似，但不那么优雅。

# linux - 所有接口上的 UDP 广播

> ID：683624
> 
> 赞同：26
> 
> 时间：2009-03-25T21:48:21.040
> 
> 标签：linux, udp, posix, broadcast

在具有有线和无线接口（例如 192.168.1.x 和 192.168.2.x 子网）的 Linux 系统上，我想发送一个通过所有可用接口（即通过有线和无线接口）发出的 UDP 广播）。

目前我 sendto() 到 INADDR_BROADCAST，但似乎广播仅通过其中一个接口发送（并不总是相同，后续广播可能使用另一个接口）。

有没有办法可以发送通过每个接口发出的 UDP 广播？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-25T22:27:31.833

首先，您应该考虑广播已过时，特别是`INADDR_BROADCAST`（255.255.255.255）。您的问题恰好突出了广播不合适的原因之一。它应该与 IPv4 一起消亡（希望如此）。请注意，IPv6 甚至没有广播的概念（而是使用多播）。

`INADDR_BROADCAST`仅限于本地链接。如今，它唯一可见的用途是用于 DHCP 自动配置，因为此时客户端还不知道它连接到哪个网络。

使用 single`sendto()`时，只会生成单个数据包，出接口由操作系统的路由表（`ip route`在 linux 上）确定。您不能让单个`sendto()`生成多个数据包，您必须遍历所有接口，并使用原始套接字或将套接字绑定到设备，`setsockopt(..., SOL_SOCKET, SO_BINDTODEVICE, "ethX")`以绕过操作系统路由表发送每个数据包（这需要 root 权限） . 不是一个好的解决方案。

相反，由于`INADDR_BROADCAST`无论如何都不会路由，因此您可以通过遍历每个接口并将数据包发送到其广播地址来实现几乎相同的目的。例如，假设您的网络有 255.255.255.0 (/24) 掩码，则广播地址为**192.168.1.255**和**192.168.2.255**。为这些地址中的每一个调用`sendto()`一次，您将实现目标。

* * *

**编辑：**关于 的固定信息`INADDR_BROADCAST`，并用关于 的信息补充答案`SO_BINDTODEVICE`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T22:09:49.990

您不能`sendto()`在每个接口上都生成一个数据包 - 通常（尽管有碎片）它是为每个接口传输的一个数据包`sendto()`。

您需要为每个接口传输一次数据包，并且：

1.  使用低级 ( `setsockopt()`?) 调用来选择出站接口

2.  发送到每个已知接口的特定广播地址

但是，如果您尝试执行某种发现机制，则后者不适合，这样您期望响应的设备实际上并未正确配置与它们连接的接口在同一子网中的 IP 地址到。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-25T22:10:12.610

来自[Jeremy](http://developerweb.net/viewtopic.php?pid=21773#p21773)关于 UNIX Socket FAQ 的解决方案：

```
#include <stdio.h>

#ifdef WIN32
# include <windows.h>
# include <winsock.h>
# include <iphlpapi.h>
#else
# include <unistd.h>
# include <stdlib.h>
# include <sys/socket.h>
# include <netdb.h>
# include <netinet/in.h>
# include <net/if.h>
# include <sys/ioctl.h>
#endif

#include <string.h>
#include <sys/stat.h>

typedef unsigned long uint32;

#if defined(__FreeBSD__) || defined(BSD) || defined(__APPLE__) || defined(__linux__)
# define USE_GETIFADDRS 1
# include <ifaddrs.h>
static uint32 SockAddrToUint32(struct sockaddr * a)
{
   return ((a)&&(a->sa_family == AF_INET)) ? ntohl(((struct sockaddr_in *)a)->sin_addr.s_addr) : 0;
}
#endif

// convert a numeric IP address into its string representation
static void Inet_NtoA(uint32 addr, char * ipbuf)
{
   sprintf(ipbuf, "%li.%li.%li.%li", (addr>>24)&0xFF, (addr>>16)&0xFF, (addr>>8)&0xFF, (addr>>0)&0xFF);
}

// convert a string represenation of an IP address into its numeric equivalent
static uint32 Inet_AtoN(const char * buf)
{
   // net_server inexplicably doesn't have this function; so I'll just fake it
   uint32 ret = 0;
   int shift = 24;  // fill out the MSB first
   bool startQuad = true;
   while((shift >= 0)&&(*buf))
   {
      if (startQuad)
      {
         unsigned char quad = (unsigned char) atoi(buf);
         ret |= (((uint32)quad) << shift);
         shift -= 8;
      }
      startQuad = (*buf == '.');
      buf++;
   }
   return ret;
}

static void PrintNetworkInterfaceInfos()
{
#if defined(USE_GETIFADDRS)
   // BSD-style implementation
   struct ifaddrs * ifap;
   if (getifaddrs(&ifap) == 0)
   {
      struct ifaddrs * p = ifap;
      while(p)
      {
         uint32 ifaAddr  = SockAddrToUint32(p->ifa_addr);
         uint32 maskAddr = SockAddrToUint32(p->ifa_netmask);
         uint32 dstAddr  = SockAddrToUint32(p->ifa_dstaddr);
         if (ifaAddr > 0)
         {
            char ifaAddrStr[32];  Inet_NtoA(ifaAddr,  ifaAddrStr);
            char maskAddrStr[32]; Inet_NtoA(maskAddr, maskAddrStr);
            char dstAddrStr[32];  Inet_NtoA(dstAddr,  dstAddrStr);
            printf("  Found interface:  name=[%s] desc=[%s] address=[%s] netmask=[%s] broadcastAddr=[%s]\n", p->ifa_name, "unavailable", ifaAddrStr, maskAddrStr, dstAddrStr);
         }
         p = p->ifa_next;
      }
      freeifaddrs(ifap);
   }
#elif defined(WIN32)
   // Windows XP style implementation

   // Adapted from example code at http://msdn2.microsoft.com/en-us/library/aa365917.aspx
   // Now get Windows' IPv4 addresses table.  Once again, we gotta call GetIpAddrTable()
   // multiple times in order to deal with potential race conditions properly.
   MIB_IPADDRTABLE * ipTable = NULL;
   {
      ULONG bufLen = 0;
      for (int i=0; i<5; i++)
      {
         DWORD ipRet = GetIpAddrTable(ipTable, &bufLen, false);
         if (ipRet == ERROR_INSUFFICIENT_BUFFER)
         {
            free(ipTable);  // in case we had previously allocated it
            ipTable = (MIB_IPADDRTABLE *) malloc(bufLen);
         }
         else if (ipRet == NO_ERROR) break;
         else
         {
            free(ipTable);
            ipTable = NULL;
            break;
         }
     }
   }

   if (ipTable)
   {
      // Try to get the Adapters-info table, so we can given useful names to the IP
      // addresses we are returning.  Gotta call GetAdaptersInfo() up to 5 times to handle
      // the potential race condition between the size-query call and the get-data call.
      // I love a well-designed API :^P
      IP_ADAPTER_INFO * pAdapterInfo = NULL;
      {
         ULONG bufLen = 0;
         for (int i=0; i<5; i++)
         {
            DWORD apRet = GetAdaptersInfo(pAdapterInfo, &bufLen);
            if (apRet == ERROR_BUFFER_OVERFLOW)
            {
               free(pAdapterInfo);  // in case we had previously allocated it
               pAdapterInfo = (IP_ADAPTER_INFO *) malloc(bufLen);
            }
            else if (apRet == ERROR_SUCCESS) break;
            else
            {
               free(pAdapterInfo);
               pAdapterInfo = NULL;
               break;
            }
         }
      }

      for (DWORD i=0; i<ipTable->dwNumEntries; i++)
      {
         const MIB_IPADDRROW & row = ipTable->table[i];

         // Now lookup the appropriate adaptor-name in the pAdaptorInfos, if we can find it
         const char * name = NULL;
         const char * desc = NULL;
         if (pAdapterInfo)
         {
            IP_ADAPTER_INFO * next = pAdapterInfo;
            while((next)&&(name==NULL))
            {
               IP_ADDR_STRING * ipAddr = &next->IpAddressList;
               while(ipAddr)
               {
                  if (Inet_AtoN(ipAddr->IpAddress.String) == ntohl(row.dwAddr))
                  {
                     name = next->AdapterName;
                     desc = next->Description;
                     break;
                  }
                  ipAddr = ipAddr->Next;
               }
               next = next->Next;
            }
         }
         char buf[128];
         if (name == NULL)
         {
            sprintf(buf, "unnamed-%i", i);
            name = buf;
         }

         uint32 ipAddr  = ntohl(row.dwAddr);
         uint32 netmask = ntohl(row.dwMask);
         uint32 baddr   = ipAddr & netmask;
         if (row.dwBCastAddr) baddr |= ~netmask;

         char ifaAddrStr[32];  Inet_NtoA(ipAddr,  ifaAddrStr);
         char maskAddrStr[32]; Inet_NtoA(netmask, maskAddrStr);
         char dstAddrStr[32];  Inet_NtoA(baddr,   dstAddrStr);
         printf("  Found interface:  name=[%s] desc=[%s] address=[%s] netmask=[%s] broadcastAddr=[%s]\n", name, desc?desc:"unavailable", ifaAddrStr, maskAddrStr, dstAddrStr);
      }

      free(pAdapterInfo);
      free(ipTable);
   }
#else
   // Dunno what we're running on here!
#  error "Don't know how to implement PrintNetworkInterfaceInfos() on this OS!"
#endif
}

int main(int, char **)
{
   PrintNetworkInterfaceInfos();
   return 0;
} 
```

# sql - SQL：为什么在这个 where 子句中过滤掉 NULL 值？

> ID：683627
> 
> 赞同：5
> 
> 时间：2009-03-25T21:49:11.583
> 
> 标签：sql, sql-server-2005, tsql

在我的表中，我有一个可为空的位列（旧系统...），另一位开发人员最近对存储过程进行了更改，以仅显示位列不正确的值 (1)。因为这是一个可以为空的列，我们注意到如果该列为 NULL，则记录不会被拾取。为什么是这样？

其他开发人员和我都同意 NULL <> 1... 这是 SQL 中的错误还是这样设计的？似乎是一个设计缺陷。

**当前代码：**

```
(VoidedIndicator <> 1) 
```

**建议修复：**

```
(VoidedIndicator <> 1 OR VoidedIndicator IS NULL) 
```

**澄清（乔恩·埃里克森）**

VoidedIndicator 是一个可为空的位字段，因此它可以具有以下值：NULL、0 或 1

当使用 where 子句（例如 (VoidedIndicator <> 1)）创建 SQL 语句时，我们只会返回具有 VoidedIndicator == 0 的记录，但我们期望 VoidedIndicator == 0 和 VoidedIndicator IS NULL。为什么是这样？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-25T22:41:15.203

很多好的答案，但让我给你一个非常简洁的版本。

对于 SQL，Null 并不意味着“无值”它意味着“未知值”

考虑到这一点，请考虑用简单的英语回答您向 SQL 提出的问题。

```
Q: Is this unknown value not equal to 1? 
A: I don't know, there is no way to tell without knowing the value.

Hence Null<>1 = Null 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-25T21:52:08.113

从[NULL 上的维基百科条目](http://en.wikipedia.org/wiki/Null_(SQL)#Common_mistakes)：

> 例如，WHERE 子句或条件语句可能会将列的值与常量进行比较。如果该字段包含 Null，则通常错误地假设缺失值将“小于”或“不等于”常量，但实际上，此类表达式返回 Unknown。下面是一个例子：
> 
> ```
> -- Rows where num is NULL will not be returned,
> -- contrary to many users' expectations.
> SELECT * FROM sometable WHERE num <> 1; 
> ```

基本上， NULL 和其他东西之间的*任何*比较，无论是用 = 还是 <> 都不会是真的。

作为另一个参考，[MSDN T-SQL 页面上的`<>`](http://msdn.microsoft.com/en-us/library/ms176020(SQL.90).aspx)状态：

> 比较两个表达式（比较运算符）。比较非空表达式时，如果左操作数不等于右操作数，则结果为 TRUE；否则，结果为 FALSE。如果其中一个或两个操作数为 NULL，请参阅 SET ANSI_NULLS (Transact-SQL)。

[SET ANSI_NULLS](http://msdn.microsoft.com/en-us/library/ms188048(SQL.90).aspx)页面然后声明：

> 当 SET ANSI_NULLS 为 ON 时，即使 column_name 中有空值，使用 WHERE column_name = NULL 的 SELECT 语句也会返回零行。即使 column_name 中有非空值，使用 WHERE column_name <> NULL 的 SELECT 语句也会返回零行。
> 
> ...
> 
> 当 SET ANSI_NULLS 为 ON 时，所有针对空值的比较都会评估为 UNKNOWN。当 SET ANSI_NULLS 为 OFF 时，如果数据值为 NULL，则所有数据与空值的比较评估为 TRUE。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T21:50:48.693

这不是一个错误。

NULL 不等于任何东西，甚至不等于 NULL（NULL = NULL 返回 FALSE）。

通常 NULL 值也不会被索引。依赖特定值或 NULL 通常是个坏主意。根据您在列中存储的内容，您最好放入一个虚拟值或哨兵值，而不是使用 NULL 来表示某些含义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T22:33:31.790

其他人是正确的，`NULL <> 1`没有评估为真的，因此它不满足`WHERE`条款。

您描述的建议修复是处理它的最佳方法：

```
(VoidedIndicator <> 1 OR VoidedIndicator IS NULL) 
```

SQL-99 确实有一个在这种情况下有帮助的谓词，称为`IS DISTINCT FROM`：

```
(VoidedIndicator IS DISTINCT FROM 1) 
```

此谓词的行为与您建议的修复完全相同。不幸的是，Microsoft SQL Server 还不支持`IS DISTINCT FROM`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T21:52:41.840

您还可以： isnull(VoidedIndicator,1) <> 1

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T21:56:45.043

因为 WHERE 子句仅在条件评估为真时选择行。

当其中一个操作数为 NULL 时，该条件的计算结果通常为 UNKNOWN（约等于 NULL），因此不成立。它适用于' `column = 1`'和' `column <> 1`'；如果 column 为 NULL，则搜索条件失败。

这就是为什么您被告知尽可能避免使用 NULL 列的原因。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T22:38:35.053

NULL <> 1 评估（理论上）为“可能”，这意味着不会返回记录。

# iis - IIS 的 Mod_rewrite

> ID：683635
> 
> 赞同：1
> 
> 时间：2009-03-25T21:50:41.393
> 
> 标签：iis, mod-rewrite, iis-7, iis-6

IIS 6/7 有什么类似于 mod_rewrite 的东西吗？我希望能够将多个域（我猜是使用 CNAME）指向一个域“abc.com”，然后在浏览器访问该域后重定向到“abc.com/start.html”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T22:01:01.057

更高级的工具是 ISAPI Rewrite（有免费和付费版本）

[http://www.isapirewrite.com/](http://www.isapirewrite.com/)

它允许您设置 mod_rewrite 可以执行的几乎所有类型的规则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T22:07:19.700

我们使用[Ionics ISAPI 重写器](http://www.codeplex.com/IIRF)。它的配置是 Apache 的 mod_rewrite 可用配置的一个子集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T22:03:05.887

如果您使用的是 ASP.NET，那么[URLRewriting.net](http://www.urlrewriting.net)是好的并且是开源的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-09T14:28:04.980

[Helicon Ape](http://www.helicontech.com/ape/)是一款在 IIS7 上模拟 Apache 行为的产品。对于 IIS6，ISAPI_Rewrite 3 是完成 Apache mod-rewrite 工作的工具

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-16T19:44:58.727

[http://www.iis.net/extensions/URLRewrite/](http://www.iis.net/extensions/URLRewrite/)适用于 IIS 7（它不适用于 IIS 6）。它有一个管理 UI，专为 IIS 7 设计。

# svn - Subversion 可以托管在亚马逊的托管云服务上吗？

> ID：683639
> 
> 赞同：15
> 
> 时间：2009-03-25T21:52:02.717
> 
> 标签：svn, amazon-ec2

Subversion 可以托管在亚马逊的托管云服务上吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-25T21:54:26.173

当然。使用 linux 设置一个 ec2 实例并在该服务器上安装 svn。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-25T22:31:53.913

绝对 - 我的公司在 Amazon EC2 实例上托管了一个公共开源 SVN 存储库和我们的私有存储库。您需要注意数据完整性和备份；我们将存储库数据存储在弹性块存储卷上以实现弹性，将存储库 svnsync 到另一个 EC2 实例和 EBS 卷，以便我们可以在主服务器出现故障时快速启动新的 SVN 服务器，并通过 svnadmin 进行异地备份转储到我们的一台物理服务器，以防整个云离线（嘿，我们的源代码毕竟是我们的皇冠上的明珠！）

我唯一能想到的另一件事是，亚马逊提供的 Linux 版本并不是最新的。我们运行 Fedora Core，EC2 上可用的最新版本是 Fedora Core 8。在 FC8 上通过 yum 安装的 SVN 版本只有 1.4.2.2，所以如果你想要像 1.5 这样的更新版本，你可能必须从源代码编译它.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-03-31T23:39:18.797

使用亚马逊的免费套餐并托管您的颠覆......等待它......免费！

[http://aws.amazon.com/free/](http://aws.amazon.com/free/)

注意：这仅限于 12 个月，并且仅适用于 AWS 新用户。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-01-12T18:03:21.267

如果您计划使用它至少一年，请在 ec2 上获取一个预留实例。

在一年期合同中，您为默认实例支付 227.50 美元 + 0.03 美元/小时，在三年期合同中，则为 350 美元 + 0.03 美元/小时。

如果您要让它们全时运行：

*   1 年合约 (0.03*24*365 + 227.50) / 12 = 40.86 / 月
*   (0.03*24*365*3 + 350) / 36 = 31.62 / 3年合约月

有关各种实例选项的完整详细信息，请参阅[http://aws.amazon.com/ec2/#pricing](http://aws.amazon.com/ec2/#pricing)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-12-16T02:28:39.373

借助 Amazon 的新“高利用率预留实例”，微型实例的每小时价格降至 0.005 美元，小型实例的每小时价格降至 0.02 美元。两者都适合 SVN。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T15:32:50.667

EC2 保持服务器正常运行的成本不是大约 0.10 美元/分钟吗？（这是一年前的成本，我最后一次检查时。）还有其他托管颠覆选项的成本要低得多。我曾经以每月 5-10 美元的价格使用 cvsdude。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-07T09:27:44.610

您可以尝试托管的[Indefero](http://www.indefero.net "颠覆托管等")优惠。这将花费您 0.007 美元/小时（49 英镑/年）。所以比EC2便宜。在您想要拥有自己的服务器的那一天，您只需下载所有数据，将其加载到您的服务器中，更改您的 DNS 条目即可。

由于您拥有完整的数据导出，您的锻造在您自己的域下，并且 Indefero 是 GPL 软件，因此您没有供应商锁定效应。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-22T13:12:08.367

当然可以。[此处](https://aws.amazon.com/marketplace/pp/B007I9FYWU/ref=ads_4281933e-b029-1456146651)提供准备就绪/安装映像。

如果你想使用 Git，AWS 有[CodeCommit](https://aws.amazon.com/codecommit/)。

# asp.net - ASP.NET MVC“甜甜圈缓存”和 TempData

> ID：683646
> 
> 赞同：5
> 
> 时间：2009-03-25T21:52:44.243
> 
> 标签：asp.net, asp.net-mvc

在 HttpResponseBase.WriteSubstitution() 方法中访问 TempData 属性是否有任何解决方案

这不起作用：

```
<%= Response.WriteSubstitution(x => Html.Encode(TempData["message"].ToString())) %> 
```

但这有效：

```
<%= Response.WriteSubstitution(x => DateTime.Now.ToString()) %> 
```

问题在于一次缓存页面的请求处理。根据[http://msdn.microsoft.com/en-us/library/system.web.httpresponse.writesubstitution.aspx](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.writesubstitution.aspx)：

> 在对页面的第一个请求中，WriteSubstitution 调用 HttpResponseSubstitutionCallback 委托来生成输出。然后，它向响应中添加一个替换缓冲区，该缓冲区保留委托以调用未来的请求。最后，它将客户端的可缓存性从公共降低到仅服务器，通过不在客户端缓存来确保对页面的未来请求重新调用委托。

换句话说，委托无权访问 Session 属性（SessionStateTempDataProvider 将 TempData 存储在会话中），因为没有“正常”的请求生命周期。据我了解，它是在 HttpApplication.ResolveRequestCache/HttpApplication.PostResolveRequestCache 事件中处理的，但当前状态是在 HttpApplication.AcquireRequestState 事件中获取的（[http://msdn.microsoft.com/en-us/library/ms178473.aspx](http://msdn.microsoft.com/en-us/library/ms178473.aspx)）

也许我需要某种“高级自定义 TempDataProvider”:) 有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-29T16:52:56.303

我找到了解决方案：

主要思想是将 TempData 的副本保存在缓存中，并在每次请求时检索它。解决方案是自定义 TempDataProvider 和简单的 http 模块的组合。另外还有几个助手和静态类。

这是代码：

**自定义临时数据提供者：**

```
using System;
using System.Collections.Generic;
using System.Web;
using System.Web.Caching;
using System.Web.Mvc;

public class CustomTempDataProvider : SessionStateTempDataProvider, IHttpModule
{
    public void Init(HttpApplication application)
    {
        application.BeginRequest += new EventHandler(application_BeginRequest);
    }

    void application_BeginRequest(object sender, EventArgs e)
    {
        var httpContext = HttpContext.Current;
        var tempData = httpContext.Cache[TempDataKey] ?? new Dictionary<string, object>(StringComparer.OrdinalIgnoreCase);
        httpContext.Items.Add("TempData", tempData);
        httpContext.Cache.Remove(TempDataKey);
    }

    public override void SaveTempData(ControllerContext controllerContext,
        IDictionary<string, object> values)
    {
        HttpContext.Current.Cache.Insert(TempDataKey, values, null, DateTime.Now.AddMinutes(5), Cache.NoSlidingExpiration, CacheItemPriority.NotRemovable, null);
        base.SaveTempData(controllerContext, values);
    }

    public static string TempDataKey
    {
        get
        {
            string sessionID = "0";
            var httpContext = HttpContext.Current;
            if(httpContext.Session != null)
            {
                sessionID = httpContext.Session.SessionID;
            }
            else if (httpContext.Request.Cookies["ASP.NET_SessionId"] != null)
            {
                sessionID = httpContext.Request.Cookies["ASP.NET_SessionId"].Value;
            }
            return "TempData-For-Session-" + sessionID;
        }
    }

    public void Dispose()
    {
    }
} 
```

**在 web.config 中注册它：**

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.web>
        <httpModules>
            <add name="CustomTempDataProvider" type="CustomTempDataProvider" />
        </httpModules>
    </system.web>
    <system.webServer>
        <modules>
            <remove name="CustomTempDataProvider" />
            <add name="CustomTempDataProvider" type="CustomTempDataProvider" />
        </modules>
    </system.webServer>
</configuration> 
```

**自定义控制器工厂：**

```
using System.Web.Routing;
using System.Web.Mvc;

public class CustomControllerFactory : DefaultControllerFactory
{
    public override IController CreateController(
        RequestContext requestContext, string controllerName)
    {
        var controller = (Controller)base.CreateController(requestContext, controllerName);
        controller.TempDataProvider = new CustomTempDataProvider();
        return controller;
    }
} 
```

**在 Global.asax 中注册它：**

```
protected void Application_Start()
{
    RegisterRoutes(RouteTable.Routes);

    ControllerBuilder.Current.SetControllerFactory(typeof(CustomControllerFactory));
} 
```

**用于访问 TempData 的静态类：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

public static class CustomTempData
{
    public static object Get(string key)
    {
        var tempData = HttpContext.Current.Items["TempData"] as IDictionary<string, object>;
        var item = tempData.FirstOrDefault(x => x.Key == key).Value ?? String.Empty;
        return item;
    }
} 
```

**缓存后替换助手：**

```
using System;
using System.Web;
using System.Web.Mvc;

public static class Html
{
    public delegate object MvcResponseSubstitutionCallback(HttpContextBase context);

    public static object MvcResponseSubstitute(this HtmlHelper html, MvcResponseSubstitutionCallback callback)
    {
        html.ViewContext.HttpContext.Response.WriteSubstitution(
            context =>
                HttpUtility.HtmlEncode(
                    (callback(new HttpContextWrapper(context)) ?? String.Empty).ToString()
                )
            );

        return null;
    }
} 
```

**现在这成功了：**

```
<h3><%= Html.MvcResponseSubstitute(context => CustomTempData.Get("message")) %></h3> 
```

如果您懂俄语，请阅读[此内容](http://eug.org.ua/asp-net-mvc-donut-caching-and-tempdata)

*希望这可以帮助*

# image - 从未引用程序集中的资源加载图像

> ID：683647
> 
> 赞同：1
> 
> 时间：2009-03-25T21:52:50.840
> 
> 标签：image, resources, silverlight-2.0

我有两个 Silverlight 程序集，CaseManager.Applet 和 CaseManager.Applet.Sample。Sample 程序集具有对基本 Applet 程序集的引用。示例程序集有一个嵌入的资源 png 图像。基本小程序程序集有一个视图 xaml，我希望以编程方式显示该图像。

在示例程序集中，我有一些创建 Uri 的代码，如下所示：

```
var icon = new AppletIcon()
                   {
                     ImageUri = new Uri("CaseManager.Applet.Sample;component/images/guiness_2.png", UriKind.Relative),
                     ModuleType = GetType(),
                     Text = "Sample Module"
                   }; 
```

当我执行此代码时，ImageUri 的所有属性都会抛出 InvalidOperationException。我不确定为什么。有人有建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T22:53:53.067

以下代码完成了这项工作：

```
var icon = new AppletIcon()
                   {
                     ImageUri = new Uri("/CaseManager.Applet.Sample;component/images/guiness_2.png", UriKind.Relative),
                     Module = this,
                     Text = "Sample Icon"
                   }; 
```

这里需要注意的事项：

*   Uri 字符串开头的斜线。
*   包含资源的程序集的简称。
*   ;component/ 部分。

从那里开始，它基本上是项目内部到图像的路径。希望这对其他人有帮助。

对于它的价值，我错过了第一个斜线。

# c# - 如何获得带有空格和大小写混合的随机字符串？

> ID：683658
> 
> 赞同：6
> 
> 时间：2009-03-25T21:55:49.913
> 
> 标签：c#, string, random, mixed-case

我需要生成一个带有空格和混合大小写的随机字符串。

[这](http://www.c-sharpcorner.com/UploadFile/mahesh/RandomNumber11232005010428AM/RandomNumber.aspx)就是我到目前为止所得到的：

```
 /// <summary>
    /// The Typing monkey generates random strings - can't be static 'cause it's a monkey.
    /// </summary>
    /// <remarks>
    /// If you wait long enough it will eventually produce Shakespeare.
    /// </remarks>
    class TypingMonkey
    {
        /// <summary>
        /// The Typing Monkey Generates a random string with the given length.
        /// </summary>
        /// <param name="size">Size of the string</param>
        /// <returns>Random string</returns>
        public string TypeAway(int size)
        {
            StringBuilder builder = new StringBuilder();
            Random random = new Random();
            char ch;

            for (int i = 0; i < size; i++)
            {
                ch = Convert.ToChar(Convert.ToInt32(Math.Floor(26 * random.NextDouble() + 65)));
                builder.Append(ch);
            }

            return builder.ToString();
        }
    } 
```

我只得到没有空格的大写字符串 - 我相信调整应该非常简单，以便在汤中混合大小写和空格。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T22:00:57.623

最简单的方法是简单地创建一个具有以下值的字符串：

```
private readonly string legalCharacters = " abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"; 
```

然后使用 RNG 访问此字符串中的随机元素：

```
public string TypeAway(int size)
{
    StringBuilder builder = new StringBuilder();
    Random random = new Random();
    char ch;

    for (int i = 0; i < size; i++)
    {
        ch = legalCharacters[random.Next(0, legalCharacters.Length)];
        builder.Append(ch);
    }

    return builder.ToString();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T22:01:15.877

您可以从您允许的所有字符的数组开始

```
private static readonly char[] ALLOWED = new [] { 'a', 'b', 'c' ... '9' }; 
```

进而：

```
{
    ...
    for (int i = 0; i < size; i++)
    {
        ch = ALLOWED[random.NextInt(0, ALLOWED.Length)];
        builder.Append(ch);
    }

    ...

    return builder.ToString();
}

return builder.ToString(); 
```

我转述，当然。我不确定 random.NextInt() 的语法，但 intelisense 可以提供帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T22:42:57.587

您也可以使用[Lorem Ipsum](http://en.wikipedia.org/wiki/Lorem_ipsum)。它广泛用于平面设计行业，用于填充随机、逼真的文本，而不会分散用户对设计元素的注意力。

您可以将一大块 Lorem Ipsum 复制并粘贴到代码中的常量字符串中，然后将其子字符串化为您需要的任何大小。

我发现这比完全随机的文本要好，因为它太分散注意力了。

希望有帮助。

# java - EJB 与休眠

> ID：683660
> 
> 赞同：4
> 
> 时间：2009-03-25T21:56:07.387
> 
> 标签：java, hibernate

何时使用 Hibernate 更好，何时使用 EJB 3？Hibernate 或 EJB 3 没有任何障碍吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T22:15:01.350

我在这里直接冬眠。

试想一下，将数据库从 DB2 更改为 oracle 的可能性有多大，这与从 Hibernate 更改为 Toplink 或 Eclipse 的可能性一样，只是不会经常发生。程序员只是喜欢做同样的老事，那就是抽象任何东西，以便他们可以在 10 年后的某个不可预见的时刻选择使用不同的日志记录工具包或不使用什么。

我敢肯定有人真的想要 JPA 的供应商独立性，但我不是其中之一。这并不是说 Toplink 或 eclipse 不好，我只是不认为你可以使用一个复杂的产品并且不以某种方式（甚至是无意地）与它绑定。

话虽如此，我仍然遵循休眠文档建议并使用 JPA 注释，并且仅在需要时才使用休眠特定的注释，不太确定是否有技术原因，但这并没有什么坏处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T22:18:33.820

由于 Hibernate 可以用作 JPA 的实现，因此您可以使用它并且仍然使用 EJB3。因此，我同意 gid 并建议您在 Hibernate 中使用 JPA 的东西，直到您不能，然后才转移到 Hibernate 的特定位。

# wcf - 在 Workflow 中使用自定义主体

> ID：683661
> 
> 赞同：0
> 
> 时间：2009-03-25T21:56:22.813
> 
> 标签：wcf, multithreading, workflow, authorization, servicehost

我有一个托管多个 WCF 服务的应用程序。我创建了一个运行良好的自定义 ServiceAuthorizationManager。我检查 OperationContext.IncomingMessageHeaders 上的一些元素以获取用户名和密码。这是为了克服我们环境中的一些限制，这些限制不允许我们使用平台内置的内容。管理器创建一个自定义 IPrincpal，其中包含一些必要的自定义对象，并将其放置在当前运行的线程上，以供稍后在 WCF 业务逻辑中使用。这很好用。

问题是我有一个 WCF 服务，它是一个工作流，我需要在那里使用相同的机制。管理器被正确调用，但是当执行线程的 currentPrincpal 不是我的自定义主体时，它是一个通用主体。调查显示工作流运行时正在创建一个线程，而不是使用 WCF 调用所在的线程。

有没有人遇到过这个问题，有什么好的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T00:26:02.970

如果运行时与管理器在同一个应用程序域中，那么您应该可以调用

```
AppDomain.CurrentDomain.SetThreadPrincipal 
```

请参阅[此处](http://msdn.microsoft.com/en-us/library/system.appdomain.setthreadprincipal.aspx)了解更多信息

# .net - 从父控件设置 WPF 嵌套控件属性

> ID：683666
> 
> 赞同：5
> 
> 时间：2009-03-25T21:56:46.073
> 
> 标签：.net, wpf, xaml

我有一个 WPF 窗口，上面有多个 ListBox 控件，它们都共享我在这里简化的相同样式：

```
 <Style x:Key="listBox" TargetType="{x:Type ListBox}">
        <Setter Property="ItemTemplate">
            <Setter.Value>
                <DataTemplate>
                    <Border BorderBrush="Black">
                        <StackPanel Orientation="Horizontal" >
                            <TextBlock Text="{Binding Path=name}" />
                            <TextBlock Text="{Binding Path=text}" />
                            <TextBlock Text="id:" />
                            <TextBlock x:Name="_idTextBlock" Text="{Binding Path=id}" />
                            <Button Name="btnGet" CommandParameter="{Binding Path=id}" />
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

下面是一个使用该样式的 ListBox 控件的示例：

```
<ListBox x:Name="lbCampaigns" Button.Click="lbCampaigns_Click" ItemsSource="{Binding}" Style="{StaticResource listBox}" /> 
```

*如何从父 ListBox 中设置 Button 控件 (btnGet) 的内容？*

我知道我希望按钮在设计时为 Window 上的每个 ListBox 显示什么文本。（即我不需要将它绑定到 ListBox ItemsSource）。我看到我可以定义子控件的事件（请参阅 Button.Click 定义），但似乎不能以相同的方式设置子控件的属性。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-25T22:05:35.897

您的设置`Button.Click`没有将事件处理程序分配给按钮。它将它分配给`ListBox`. 它的工作原理是 WPF 的路由事件系统。

如果您希望`Button`采用在 的级别设置的值，则`ListBox`在这种情况下，一种选择是将 a`Binding`与 a 一起使用`RelativeSource`：

```
<Button Content="{Binding Tag, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListBox}}}"/> 
```

在这种情况下，我刚刚劫持了该`Tag`属性，您可以指定如下：

```
<ListBox Tag="This is the button's content" .../> 
```

另一种选择是使用继承的附加属性。例如：

```
<Button Content="{Binding local:MyClass.MyAttachedProperty}"/> 
```

进而：

```
<ListBox local:MyClass.MyAttachedProperty="This is the button's content"/> 
```

最后，如果您正在模板化`ListBox`自身，您可以“伸出手”并使用以下方式绑定到您正在模板化的控件的属性`TemplateBinding`：

```
<Button Content="{TemplateBinding Tag}"/> 
```

当然，这种技术通常与模板化控件上特别声明的属性一起使用。例如，您可以子类化`ListBox`并添加您自己的`ButtonContent`属性。然后，在您的模板中，您可以从`Button`.

# perl - 如何在 Perl 子例程中处理已捕获和未捕获的错误？

> ID：683672
> 
> 赞同：5
> 
> 时间：2009-03-25T21:57:52.653
> 
> 标签：perl, error-handling, die

这是[“如何在无法修改的 Perl 库中绕过 'die' 调用？”的后续内容。](https://stackoverflow.com/questions/451227/how-can-i-get-around-a-die-call-in-a-perl-library-i-cant-modify).

我有一个调用 Library-Which-Crashes-Sometimes 多次的子例程。我没有用 eval{} 来处理这个子例程中的每个调用，而是让它死掉，并在调用我的子例程的级别上使用 eval{}：

```
my $status=eval{function($param);};
unless($status){print $@; next;}; # print error and go to
                                  # next file if function() fails 
```

但是，我可以并且确实在 function() 中捕获了一些错误情况。在子例程和调用例程中设计错误捕获的最合适/优雅的方法是什么，以便我获得捕获和未捕获错误的正确行为？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T22:08:30.180

块 eval 可以嵌套：

```
sub function {
    eval {
        die "error that can be handled\n";
        1;
    } or do {
        #propagate the error if it isn't the one we expect
        die $@ unless $@ eq "error that can be handled\n"; 
        #handle the error
    };
    die "uncaught error";
}

eval { function(); 1 } or do {
    warn "caught error $@";
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T22:17:22.997

我不完全确定你想做什么，但我认为你可以用处理程序来做。

```
$SIG{__DIE__} = sub { print $@ } ;

eval{ function($param); 1 } or next; 
```

# sql-server-2008 - 如何在 SQL Management Studio 2008 中重新排序/清除连接历史记录？

> ID：683690
> 
> 赞同：3
> 
> 时间：2009-03-25T22:04:46.070
> 
> 标签：sql-server-2008, ssms

我在 SQL Management Studio 中连接到许多不同的服务器，但我发现不仅无法删除旧连接（数据库名称、用户名等），它们还开始显示为重复。

有没有办法清除它们/重新排序历史？我似乎找不到任何简单的方法。

谢谢！克里斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-10-14T15:18:13.620

我遇到了同样的问题，发现有问题的文件是 SqlStudio.bin。我不确定你将如何编辑它，但如果你重新/移动它，你的 SQL 连接会得到一个空白。

我们这里仍然使用 XP 工作，所以该文件位于 C:\Documents and Settings\%USERNAME%\Application Data\Microsoft\Microsoft SQL Server\100\Tools\Shell 文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T22:13:53.740

查看目录中的`DialogSettings.xml`和`mru.dat`文件`%AppData%\Microsoft\Microsoft SQL Server\90\Tools\ShellSEM`。我还没有尝试修改我的，但他们看起来他们已经获得了相关信息。

我建议你先备份它们！

# javascript - 在网页上显示大量文本的创意

> ID：683696
> 
> 赞同：2
> 
> 时间：2009-03-25T22:07:38.153
> 
> 标签：javascript, html, c, xml

我在数据库中有一个 2 列表，长度为 1,000 行（所有整数数据）。
显示将允许用户从表中删除一定范围的数据。

我正在寻找一种创造性的方式来显示所有数据，以便用户可以非常快速地访问它的不同部分。也许一次显示不同的块，用条形图表示或放大/缩小范围真的很酷。

任何想法，建议，例子都值得赞赏。请把它们扔在这里进行头脑风暴。

注意：我仅限于 JS、xml、html 和 C

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T22:11:08.987

*   通过鼠标滚动调整文本大小。
*   添加拖放以移动文本块。

示例：用户通过鼠标将其调整为较小的块，然后使用拖放移动它。

可以用 jQuery/JavaScript 实现这样的事情

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T22:14:27.123

使用具有最小和最大显示范围的双滑块。[这](http://developer.expressionz.in/blogs/2008/10/24/mootools-slider-with-two-knobs-double-pinned-slider-with-range-indicator/)是一个基于 MooTools 的示例。移动滑块控件将调整表中显示的值范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T22:11:37.800

可以实现一些功能，如谷歌地图，您可以在其中轻松放大和缩小，并在您需要更改高度时设置点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T22:12:21.573

您可以使用标签格式化 html `<h1>, <h2>, <h3> and <p>`，并使用 jquery 折叠段落，留下主要部分的标题。

我用我正在处理的文档做到了这一点，效果很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T22:16:07.057

我是这个视频中演示的 JavaScript 书签的粉丝：[http ://www.youtube.com/watch?v=GPZ8YNgyl_I](http://www.youtube.com/watch?v=GPZ8YNgyl_I)

小书签本身可在此处获得：http: [//t_trace.wed.macserver.jp/overview.html](http://t_trace.wed.macserver.jp/overview.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T22:25:28.033

如果您使用过[WinMerge](http://winmerge.org)，您可以开发类似于左侧位置窗格的东西，它显示文件更改的完整预览。它可以用来快速导航

这是一个[截图](http://winmerge.org/about/screenshots/screenshot.png)。（图片太大，无法在此处内联）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-25T22:38:58.657

假设整数数据在范围内，一种常见的方法是将每个范围内的数据量显示为水平条。单击范围以放大，直到看到实际数据，或单击 X 删除。

```
 ID Range

[X]    1-1000 xxxxxxxxxxxxxxxxxxxxx

[X] 1001-2000 xxxxxxxxx

[X] 2001-3000 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx 
```

进一步的改进是在水平条上使用颜色来显示数据密度。例如红色 = 大量数据，黄色 = 更少

# java - 是否可以用 Java 编写设备驱动程序？

> ID：683701
> 
> 赞同：24
> 
> 时间：2009-03-25T22:09:13.517
> 
> 标签：java, operating-system, device-driver

## 介绍

我听说过一些关于用 Java 编写设备驱动程序的事情（听到的是“用我的耳朵”，而不是来自互联网）并且想知道......我一直认为设备驱动程序在操作系统级别上运行，因此必须用相同的语言编写作为操作系统（因此主要是 CI 假设）

## 问题

1.  我通常对这个假设有误吗？（好像是这样）

2.  如何在操作系统中使用“外星人”语言的驱动程序？

3.  无论如何，设备驱动程序有什么要求（从编程语言的角度来看）？

谢谢阅读

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-26T00:02:03.027

有几种方法可以做到这一点。

首先，在“操作系统级别”运行的代码不需要用与操作系统相同的语言编写。它只需要能够与操作系统代码链接在一起。几乎所有语言都可以与 C 互操作，而这正是我们所需要的。

所以语言方面，技术上没有问题。Java函数可以调用C函数，C函数可以调用Java函数。如果操作系统不是用 C 编写的（比如说，为了论证它是用 C++ 编写的），那么操作系统 C++ 代码可以调用一些中间 C 代码，这些代码会转发给你的 Java，反之亦然。C 几乎是一种编程*语言*。

一旦程序被编译（到本地代码），它的源语言就不再相关了。无论源代码在编译之前是用哪种语言编写的，汇编程序看起来都差不多。只要您使用与操作系统相同的调用约定，就没有问题。

一个更大的问题是运行时支持。操作系统中没有很多软件服务可用。例如，通常没有 Java 虚拟机。（从技术上讲，没有理由不存在，但通常，但通常，可以安全地假设它不存在）。

不幸的是，在其“默认”表示中，作为 Java 字节码，Java 程序*需要*大量的基础设施。它需要 Java VM 来解释和 JIT 字节码，它需要类库等等。

但是有两种方法可以解决这个问题：

*   在内核中支持 Java。这将是一个不寻常的步骤，但可以做到。
*   或者将您的 Java 源代码编译为本机格式。Java 程序不必编译为 Java 字节码。您可以将其编译为 x86 汇编程序。这同样适用于您使用的任何类库。这些也可以一直编译到汇编程序。当然，Java 类库的某些部分需要某些不可用的操作系统特性，但是可以避免使用这些类。

所以是的，这是可以做到的。但这并不简单，也不清楚你会得到什么。

当然，另一个问题可能是 Java 不允许您访问任意内存位置，这会使很多硬件通信变得非常棘手。但这也可以解决，也许可以通过调用非常简单的 C 函数来简单地将相关的内存区域作为数组返回，供 Java 处理。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-26T04:00:19.617

[用 Java 编写 Solaris 设备驱动程序](http://research.sun.com/techrep/2006/abstract-156.html)涵盖了一个用 Java 编写的 RAM 磁盘设备。

[另一个适用于 Linux 的](http://portal.acm.org/citation.cfm?id=1408654.1408657)。更深入地了解为什么您可能还需要 Java 中的 DD（因为有些人对其他帖子和评论的外观感到疑惑）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-04-01T13:11:11.747

**设备驱动程序可能是很多东西**

我实际上用java编写设备驱动程序为生：**工业设备**的驱动程序，例如秤或称重设备、包装机、条形码扫描仪、称重桥、袋子和盒子打印机…… **Java在这里是一个非常好的选择。**

[![一些例子](https://i.stack.imgur.com/WJ9Jv.png)](https://i.stack.imgur.com/WJ9Jv.png)

工业设备**与您的家庭/办公设备（例如扫描仪、打印机）非常不同**。特别是在制造业（例如食品）中，公司越来越多地选择运行MES应用程序（例如用Java开发）的集中式服务器**。MES服务器需要与生产线的设备接口，但也包含业务逻辑。**Java 是一种可以两者兼得的语言。

您的家庭/办公设备通常内置于您的计算机或通过 USB 电缆连接，这些**工业设备通常使用以太网或 RS232 连接器。**因此，从本质上讲，几乎每种语言都可以完成这项工作。

**这方面还没有太多的标准化。**大多数供应商更喜欢为他们的设备创建自己的协议。毕竟他们是硬件制造商，而不是软件天才。结果是协议的高度多样化。一些供应商更喜欢简单的纯文本协议，但其他供应商更喜欢带有 CRC 码、帧的复杂二进制协议……有时他们喜欢堆叠多个协议（例如，在 OPC 层之上的供应商特定握手算法）。**强大的 OOP 语言在这里有很多优势。**

> 例如，我看到 java 以 100 毫秒/周期的连续速度打印。这包括生成一个独特的标签，将其发送到打印机，接收确认，将其打印在纸上并使用气压将其粘贴到产品上。

**总结一下，java的强大之处：**

*   它对于作为复杂接口的业务逻辑都很有用。
*   它在与套接字的通信中与 C 一样可靠。
*   一些驱动程序可以从 Java 的 OOP 功能中受益。
*   Java 足够快。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-25T22:17:51.297

这并非不可能，但可能很难，而且可能没有多大意义。

有可能，因为Java是一门普通的编程语言，只要你有办法访问数据就没有问题。通常在现代操作系统中，内核有一个层允许以某种方式对硬件进行原始访问。用户空间中也已经存在驱动程序，至少用户空间部分在Java中实现应该没有问题。

这可能没有太大意义，因为内核必须启动一个 JVM 来执行驱动程序。此外，JVM 实现通常会占用大量内存。

您还可以使用编译为在平台上本地执行的 Java 代码（而不是借助 JVM）。这通常效率不高，但它可能适用于设备驱动程序。

问题是，用Java实现驱动有意义吗？或者换一种说法：如果您使用 Java 来实现驱动程序而不是其他替代方案，您希望得到什么好处？如果你能回答这个问题，你应该想办法让它成为可能。

最后是对[JNode](http://www.jnode.org/)的提示，该项目试图实现一个完全基于 Java 的完整操作系统。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-25T22:14:49.790

您可能听说过对 JDK 的引用[吗](http://www.javapos.com/jddk.main.html)？

如果没有本机代码来提供 (1) 特定于操作系统的驱动程序入口点和约定，以及 (2) JVM 实例之间的交互，则 100% 用 Ja​​va 编写设备驱动程序是**不可能的。**JVM 实例可以“进程内”启动（并且“进程内”可能具有不同的含义，具体取决于操作系统以及驱动程序是内核模式还是用户模式驱动程序），也可以作为单独的用户区启动一个瘦的本机驱动适配层可以与之通信的进程，并且所述驱动适配层可以在其上卸载实际的用户空间工作。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-26T07:06:40.010

您对设备驱动程序的看法过于狭隘。

我已经在汽车应用程序的 MOST 之上编写了此类设备驱动程序。如果 Java 有一个像样的 USB 库，那么更广泛的用途可能是 USB 设备的驱动程序。

在这些情况下，有一个在本机代码中处理的通用低级协议，Java 驱动程序处理设备细节（数据格式、状态机等）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-25T22:17:53.870

可以**将**java 代码编译为硬件本机（即不是 JVM 字节码）指令。参见例如[GCJ](http://gcc.gnu.org/java/)。有了这些，您就比以前更接近于编译设备驱动程序了。

不过，我不知道它有多实用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-25T22:20:51.507

**可能的？**

可以，但仅限于特殊情况。因为你可以用 Java 和 C# 编写操作系统，然后，应该能够为它编写设备驱动程序。这些驱动程序和操作系统的内存损失将是巨大的。

**可能？**

不见得。至少不在 Windows 或 MacOS 甚至 Linux 的世界里……至少不会很快。因为像 C# 和 Java 这样的语言依赖于 CLR 和 JVM。这些语言的工作方式意味着它们不能有效地加载到 ring0 中。

此外，如果在设备驱动程序中使用托管语言，性能损失会相当大。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-01-24T22:49:47.973

出于动机，请记住有很多比 C 更好的快速编程语言；它们可能不如 C 快，但它们是安全的语言：如果你犯了错误，你不会得到未定义的行为。“未定义的行为”包括执行某些攻击者提供的任意代码，这些代码会格式化您的 HD。许多函数式语言通常被编译为本机代码。

设备驱动程序包含操作系统内核中最多的错误——我知道对于 Linux（Linus Torvalds 和其他人一直这么说），我听说对于 Windows。对于磁盘或以太网驱动程序，您需要一流的性能，而 Linux 驱动程序是当今*10G*以太网或 SSD 磁盘的瓶颈，大多数驱动程序不需要那么高的速度 - 所有计算机都以相同的速度等待。

这就是为什么有各种项目允许编写在内核之外运行的驱动程序，即使这会导致速度变慢；当你能做到这一点时，你可以使用任何你想要的语言；您将需要为您使用的硬件控制库进行 Java 绑定 - 如果您使用 C 编写驱动程序，您仍然会有一个带有 C 绑定的库。

对于内核模式下的驱动程序，我还没有提到两个问题：

*   垃圾收集，这是一个严格的要求。你需要编写一个内核垃圾收集器；一些 GC 算法依赖于虚拟内存，你不能使用它们。此外，您可能需要扫描整个操作系统内存以找到 GC 的根。最后，我只相信保证（软）实时 GC 的算法，这会使开销更大。阅读了有关 Linux 之上的 Java 设备驱动程序的论文，他们只是放弃了，并要求程序员手动释放内存。他们试图争辩说这不会损害安全性，但我认为他们的论点没有说服力——甚至不清楚他们是否理解垃圾收集是安全语言所必需的。

*   反射和类加载。一个完整的 Java 实现，即使在运行本机代码时，也需要能够加载新代码。这是一个您可以避免使用的库，但如果您在内核中有解释器或 JIT 编译器（并且没有真正的原因使其在技术上不可能）。

*   表现。关于 Linux 上的 JVM 的论文非常糟糕，而且它们的性能数字也没有令人信服——事实上，他们测试了一个 USB 1.1 网络驱动程序，然后证明性能还不错！但是，只要付出足够的努力，肯定可以做得更好。

最后两件事：

*   我想提一下 Singularity，它是一个用 C# 变体编写的完整操作系统，只有一个本地语言的硬件抽象层。
*   关于 picoJava，除非您的系统是真正内存受限的系统，例如智能卡，否则使用它是个坏主意。Cliff Click 已经解释了原因：编写一个好的 JIT 提供了更好的性能，现在甚至智能手机都可以支持它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-25T22:19:04.257

设备驱动程序必须用可以在内核中执行的语言编写，或者编译到内核中，或者在运行时作为模块加载。这通常排除了用 Java 编写设备驱动程序，但我想您理论上可以在设备驱动程序中实现 JVM 并让它执行 Java 代码。并不是任何理智的人都愿意这样做。

在 Linux 上，有几个文件系统的用户级（即非内核）实现，它们使用一个称为 (fuse) 的通用抽象层，它允许用户级程序实现通常在内核中完成的事情。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-12-25T02:53:08.810

Windows Driver Foundation (WDF) 是一个 Microsoft API，它允许编写[用户](http://www.microsoft.com/whdc/driver/wdf/UMDF_intro.mspx)模式和[内核模式设备驱动程序。](http://www.microsoft.com/whdc/driver/wdf/KMDF.mspx)这是今天完成的，它现在与 w2k 及更高版本兼容（过去没有 w2k 作为支持的目标）。没有理由不能进行 JNI 调用以在 JRE 中执行某些工作。. . （假设 JNI 仍然是从 C/C++ 调用 Java 的方式......我的知识在那个领域已经过时了）。这可能是一种有趣的方式，可以让高级算法直接从 USB 管道中获取数据以达到某种效果。. . 酷的东西！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-11-13T20:11:39.940

PCIe 用户空间设备驱动程序可以用纯 Java 编写。有关 OFED 上下文中基于内存的直接硬件访问的详细信息，请参阅[JVerbs](http://www.socc2013.org/home/program/a10-stuedi.pdf "动词")。这是一种可用于创建高性能系统的技术。

您可以检查 PCI 总线以确定给定设备的内存区域、它具有哪些端口等。内存区域可以映射到 JVM 的进程中。

当然，您有责任自己实施**一切**。

我没说容易。我说可能。;)

另请参阅[用户空间中的设备驱动程序](http://www.embedded.com/design/operating-systems/4401769/Device-drivers-in-user-space)，其中讨论了使用 UIO 框架构建用户空间驱动程序。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-03-25T22:25:03.633

首先，请注意，我不是设备驱动程序方面的专家（尽管我以前自己写过一些），更不用说 Java 方面的专家了。

让我们暂时搁置用高级语言编写设备驱动程序不是一个好主意（出于性能和可能的许多其他原因）这一事实，并回答您的问题。

至少在理论上，您几乎*可以用任何语言编写设备驱动程序。*

然而，*大多数*设备驱动程序需要做很多低级的事情，比如处理中断和使用操作系统 API 和系统调用与操作系统通信，我相信你在 Java 中做不到。

但是，如果您的设备使用串行端口或 USB 进行通信，并且操作系统不一定需要知道该设备（只有您的应用程序会访问该设备*），那么您可以在任何提供访问设备的必要手段的语言。

例如，您可能无法用 Java 编写 SCSI 卡驱动程序，但您可以为专有控制设备、USB 熔岩灯、许可证加密狗等编写驱动程序。

* 这里明显的问题是，当然，这算作司机吗？

# php - 你如何在php中执行模式是数组的preg_match？

> ID：683702
> 
> 赞同：10
> 
> 时间：2009-03-25T22:09:31.580
> 
> 标签：php, arrays, preg-match

我有一个充满了我需要匹配的模式的数组。除了 for() 循环之外，还有什么方法可以做到这一点？我试图以 CPU 密集度最低的方式来做这件事，因为我每分钟都会做几十个这样的事情。

现实世界的例子是，我正在构建一个链接状态检查器，它将检查各种在线视频网站的链接，以确保视频仍然是实时的。每个域都有几个“死关键词”，如果在页面的 html 中找到这些，则意味着该文件已被删除。这些存储在数组中。我需要将数组的内容与页面的 html 输出相匹配。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-25T23:56:15.427

首先，如果您实际上每**分钟**只做**几十次**，那么我不会非常担心这种情况下的性能。这些匹配非常快，我认为通过遍历您的模式数组并像这样单独调用 preg_match 不会出现性能问题：

 **```
$matches = false;
foreach ($pattern_array as $pattern)
{
  if (preg_match($pattern, $page))
  {
    $matches = true;
  } 
} 
```

您确实可以`or`像某些人建议的那样使用运算符将​​所有模式组合成一个，但不要只是将它们与`|`. **如果您的任何模式包含**or 运算符，这将严重破坏。

我建议至少使用括号对您的模式进行分组，例如：

```
foreach ($patterns as $pattern)
{
  $grouped_patterns[] = "(" . $pattern . ")";
}
$master_pattern = implode($grouped_patterns, "|"); 
```

但是......我不确定这是否会更快。 **有些东西**必须循环通过它们，无论是 preg_match 还是 PHP。如果我不得不猜测，我会猜测单个匹配会接近相同的速度，并且更容易阅读和维护。

最后，如果性能是您在这里寻找的，我认为最重要的事情是将非正则表达式匹配提取到一个简单的“字符串包含”检查中。我想您的某些检查必须是简单的字符串检查，例如查看“此站点已关闭”是否在页面上。

所以这样做：

```
foreach ($strings_to_match as $string_to_match)
{
  if (strpos($page, $string_to_match) !== false))
  {
    // etc.
    break;
  }
}
foreach ($pattern_array as $pattern)
{
  if (preg_match($pattern, $page))
  {
    // etc.
    break;
  } 
} 
```

尽可能多地避免`preg_match()`可能是你最大的收获。 `strpos()`比快**很多**`preg_match()`。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-25T22:25:43.227

```
// assuming you have something like this
$patterns = array('a','b','\w');

// converts the array into a regex friendly or list
$patterns_flattened = implode('|', $patterns);

if ( preg_match('/'. $patterns_flattened .'/', $string, $matches) )
{
}

// PS: that's off the top of my head, I didn't check it in a code editor 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-10T14:14:45.407

如果您的模式不包含很多空格，另一种选择是避开数组并使用`/x`修饰符。现在您的正则表达式列表将如下所示：

```
$regex = "/
pattern1|   # search for occurences of 'pattern1'
pa..ern2|   # wildcard search for occurences of 'pa..ern2'
pat[ ]tern| # search for 'pat tern', whitespace is escaped
mypat       # Note that the last pattern does NOT have a pipe char
/x"; 
```

使用`/x`修饰符时，空格将被完全忽略，除非在字符类中或前面有反斜杠。像上面这样的评论也是允许的。

这将避免遍历数组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T22:23:32.843

如果您只是在另一个字符串中搜索字符串的存在，请使用 strpos，因为它更快。

否则，您可以迭代模式数组，每次调用 preg_match 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T22:12:36.830

如果你有一堆模式，你可以做的就是将它们连接到一个正则表达式中并匹配它。不需要循环。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T00:17:16.877

对使用数组得到的 HTML进行 a`str_replace()`处理然后检查原始 HTML 是否等于原始 HTML 怎么样？这将非常快：

```
 $sites = array(
      'you_tube' => array('dead', 'moved'),
      ...
 );
 foreach ($sites as $site => $deadArray) {
     // get $html
     if ($html == str_replace($deadArray, '', $html)) { 
         // video is live
     }
 } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-08-09T08:16:53.300

[您可以使用implode()](http://php.net/manual/en/function.implode.php) php 函数将列表中的所有模式组合成单个正则表达式。[然后使用preg_match()](http://php.net/manual/en/function.preg-match.php) php 函数一次测试你的字符串。

```
$patterns = array(
  'abc',
  '\d+h',
  '[abc]{6,8}\-\s*[xyz]{6,8}',
);

$master_pattern = '/(' . implode($patterns, ')|(') . ')/'

if(preg_match($master_pattern, $string_to_check))
{
  //do something
} 
```

当然，在“if()”条件而​​不是`$master_pattern`变量中使用 implode() 内联代码可能会更少。

# javascript - 如何使用 JavaScript 更改样式属性中的一个值？

> ID：683704
> 
> 赞同：11
> 
> 时间：2009-03-25T22:09:51.067
> 
> 标签：javascript, dojo

我`div`定义了一个样式属性：

```
<div id="div1" style="width:600;height:600;border:solid 1px"></div> 
```

如何`div`使用 JavaScript 更改高度？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-25T22:12:54.053

```
<script type="text/javascript">
function changeHeight(height)
{
   document.getElementById("div1").style.height = height + "px";
}
</script> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-25T22:19:12.087

从他的示例代码来看，他正在使用 dojo 框架。改变道场的高度可以通过类似于以下的方式来完成：

```
dojo.style("div1", "height", 300); 
```

[http://api.dojotoolkit.org/jsdoc/dojo/1.2/dojo.style](http://api.dojotoolkit.org/jsdoc/dojo/1.2/dojo.style)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-25T22:13:17.687

```
document.getElementById("div1").style.height = height + "px"; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T22:12:18.157

这是使用 jQuery 时的样子：

```
<div id="div1" style="width:600;height:600;border:solid 1px"></div>
<a href="#">Change height to 300</a>

<script type="text/javascript">
    $(function() {
        $('a').click(function() {
            $('#div1').css('height', '400px');
            return false;
        });
    });
</script> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-25T22:13:21.540

```
var d = document.getElementById("div1");
d.style.height = "300px"; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T22:13:42.833

只需将您的评论替换为：

node.style.height = 高度；

哦，不确定是否只是将 300 传递给您的函数是否可以使其正常工作，也许您必须像其他帖子中建议的那样传递“300px”...

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-17T12:52:35.487

在道场中，你会这样做：

```
dojo.style("div1", "height", "300px"); 
```

[如文档中所述，](http://api.dojotoolkit.org/jsdoc/1.2/dojo.style)将单位放在高度上很重要。

# svn - Subversion 将外部更新到某个日期

> ID：683716
> 
> 赞同：40
> 
> 时间：2009-03-25T22:12:48.267
> 
> 标签：svn

我正在 SVN 控制下从事一个大型的、已建立的项目。代码库的许多部分正在作为外部检查，但正在由其他人积极工作。
我想更新我的整个工作副本、外部和所有内容，以便它在特定时间点反映各种存储库的 HEAD。我最初的尝试是：

```
svn up -r'{20090324}' 
```

这会将当前目录更新到指定日期，但将所有外部目录更新到*当前*日期。一次更新一个外部组件按预期工作。
我知道由于外部因素的性质，单个更新不能与修订号一起使用，但为什么它不能与日期一起使用？
实现我正在寻找的时间点效果的最佳方法是什么，而无需维护对各种外部进行硬编码的脚本？

我正在运行Linux系统。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2010-08-31T11:17:29.850

这是低效的，因为它比（通常）需要的更频繁地调用 svn update。否则，它是短暂的甜蜜：

Unix：

```
find . -name .svn -execdir svn update -r {2010-08-30} \; 
```

视窗：

```
forfiles /m .svn /s /c "cmd /c svn up -r {2010-08-30}" 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-25T23:48:42.387

当使用 svn:externals 时，使用没有修订号的外部通常是个坏主意。这意味着很难将外部版本与包含项目的版本相关联；我知道这一点很难，从试图追踪包含外部项目的一些历史记录，我不得不猜测哪个修订版对应于包含项目中的修订版（有时它更早，因为有人更新了外部项目和然后更新了包含的项目，有时是因为有人直接在外部结帐中编辑了文件然后提交了它）。

[相反，正如提示框所建议的那样，在 subversion book](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.advanced.externals)的 externals 部分中有几段，您应该始终使用修订号提交 externals。这样，每当您签出包含项目的特定修订版时，外部的适当修订版也将被签出。这确实意味着更多的工作，因为您每次都必须更新 svn:externals 属性中的修订号（我们编写了一个脚本来自动完成），但从长远来看，这是一个更好的解决方案。

**编辑**：这是我们使用的脚本框架（一个 rake 任务），用于方便地更新外部并保持一切同步。

```
desc 'Update external for this project (rake update_external r=17789)'
task :update_external do |t|
  rev = ENV['r']
  rev =~ /^\d+$/ or raise "Invalid SVN revision number: r=<#{rev}>"

  # Update the project.
  sh "svn update"

  URL = 'svn+ssh://example.com/external/trunk'
  sh "svn propset svn:externals 'external -r#{rev} #{URL}' containing/directory"

  # Update again -- to put the externals back to the right revision.
  sh "svn update"
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-21T02:44:52.047

[这](http://lists.mplayerhq.hu/pipermail/mplayer-users/2008-August/073965.html)是迄今为止我发现的问题的最佳解决方案（这是一个棘手的问题 - 颠覆开发者应该在核心中修复它）。此示例特别处理 mplayer，但您应该很容易看到逻辑。

```
; fetch the rev I want without including the externals
svn checkout -r "$REV" --ignore-externals \
    svn://svn.mplayerhq.hu/mplayer/trunk

; grab the date of that rev from the svn info output
DATE=`svn info trunk|sed -n '/^Last Changed Date/s/.*: \(.*\) (.*/\1/p'`

; fetch the externals using that date
svn checkout -r "{$DATE}" \
        svn://svn.mplayerhq.hu/ffmpeg/trunk/libavutil \
        svn://svn.mplayerhq.hu/ffmpeg/trunk/libavformat \
        svn://svn.mplayerhq.hu/ffmpeg/trunk/libavcodec \
        svn://svn.mplayerhq.hu/ffmpeg/trunk/libpostproc 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T22:57:00.110

我还没有一个完美的解决方案，但这个很接近：

```
svn propget svn:externals | sed -e 's/ .*$//g' | xargs svn up -r'{20090324}' 
```

这适用于我的情况，因为没有递归外部，并且所有外部都定义为目录中没有空格或修订号，因此正则表达式可以轻松切断尾随存储库路径。

不过，我确信有更好的正则表达式可以通用地解决问题。

编辑：实际上我越想这个，我看到的问题就越多。其中最大的是它使用的是*当前*版本的 svn:externals，而不是指定日期的版本的 svn:externals。这比我最初想象的还要复杂。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-03-04T22:01:38.840

基于戴夫科恩的回答，但要快得多：

```
find . -name '.svn' -execdir svn up --ignore-externals -r '{2014-02-05}' \; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-26T09:01:23.840

这很棘手，恐怕我无法为您目前的情况提供一个好的解决方案 - 但布赖恩已经给出了如何避免它的答案。

避免归结为一点存储库理论 - 基本上，如果没有相应的修订出现在主干中，就不可能修改项目的任何源代码。

通过将所有外部对象指向标签或特定修订，它们的任何更改都不会出现在主项目历史记录中，而无需对外部参考进行更改。但是，如果您将外部指向移动的主干，则对外部的更改根本不会显示在主项目的时间线中 - 让您处于您所处的位置。

就个人而言，我认为应将外部项目视为独立项目并发布，因此所有外部项目都指向标签。在重度并行开发过程中，将外部“切换”到主干，或者有一个不稳定的开发分支暂时指向一个外部主干，但主线项目主干总是指向一个稳定的外部，这是一个有意识的升级决定。对于您的情况，这种观点可能有点矫枉过正，但值得看看其他可能性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-01-31T08:41:47.527

不错的实用程序，可以在给定路径的情况下冻结外部。在我们从主干创建标签后，我们使用这个工具来冻结外部：

[http://svnxf.codeplex.com/](http://svnxf.codeplex.com/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-10-30T20:02:14.553

这里的问题是你和你的同事没有在你的外部使用明确的修订号。[你应该马上开始](http://kera.name/articles/2012/09/externals-should-never-point-to-head-and-this-is-why-i-told-you-so/)！

直觉上，我可能认为从特定日期检查某些内容会递归地将外部查找“挂钩”到该日期，即使外部指向某个`HEAD`修订。但是，好吧，事实并非如此。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-25T22:35:42.737

KSvn 可能有这个功能。[http://subversion.tigris.org/links.html#desktop-integrations](http://subversion.tigris.org/links.html#desktop-integrations)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-25T22:38:27.377

您正在更新主 WC 的修订/日期/等在更新时不会传递给外部。在外部定义中没有指定特定版本的情况下，它们将始终跟踪它们指向的任何内容的头部。如果您在此处指定修订版，那么这是您将获得的唯一修订版。我很确定你想要做的事情是不可能的——正如我在[这个问题](https://stackoverflow.com/questions/562554/mirroring-a-subfolder-between-two-writable-svn-repos)中描述的那样，这是我试图用来解决我遇到的问题的一种方法。（我从来没有解决过这个问题，尽管我认为那里提到的代理想法可以做到。但它可能对你没有帮助）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-08-24T09:42:21.647

由于我最近遇到了类似的问题，所以我编写了一个小脚本来检查特定版本的存储库，同时还检查了该版本日期的外部： [https ://gist.github.com/3413952](https://gist.github.com/3413952)

如果您需要找到错误的来源并希望拥有类似于`git`'s bisect 功能的东西，这很有用。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2013-05-21T20:12:52.257

让 svn 为你做递归。

临时文件和`tee`只是在这里，以便您可以看到完整的输出：

```
SVN_UP_OUTPUT=$(mktemp SVN_UP_OUTPUT.XXXXX)
svn up -r$REVISION | tee $SVN_UP_OUTPUT
cat $SVN_UP_OUTPUT | egrep '^Fetching external' | egrep -o "'.*'" | sed -e "s/'//g" | while read DIR;do
    echo $$ svn up -r$REVISION "$DIR"
    svn up -r$REVISION "$DIR"
done
rm $SVN_UP_OUTPUT 
```

如果您不关心输出，可以将其缩短为：

```
svn up -r$REVISION | egrep '^Fetching external' | egrep -o "'.*'" | sed -e "s/'//g" | while read DIR;do
    svn up -r$REVISION "$DIR"
done 
```

当然，在你的情况下：

```
REVISION='{20090324}' 
```

# html - 生成浏览器端网页缩略图

> ID：683718
> 
> 赞同：3
> 
> 时间：2009-03-25T22:13:02.697
> 
> 标签：html, iframe, thumbnails

我想在浏览器中生成网页的缩略图，因此我可以在单个页面中拥有多个缩小的 iFrame。

IE 可以使用过滤器来做到这一点。如果您有 Chrome 权限（如已安装的插件），Mozilla 可以使用 drawWindow() 在 <canvas> 中执行此操作。

有没有办法在 WebKit 中做到这一点？有没有通用的跨浏览器方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T14:26:45.117

我知道您正在寻找一种客户端方式来执行此操作，但考虑到全面支持的参差不齐的支持，您可能需要考虑在服务器上生成缩略图。

[khtml2png](http://khtml2png.sourceforge.net/)允许您从命令行生成网页图像。这不是最漂亮的解决方案，但只需编写一点脚本，它就可以让您即时生成缩略图，而且您不必担心浏览器的兼容性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T16:56:40.530

WebKit 的夜间版本（2009 年 3 月 24 日的 41944）支持转换元素（包括缩放）以及其他好东西，如 CSS 渐变。

有关 WebKit 博客和[此处](http://www.sitepoint.com/blogs/2008/04/25/css-gradients-transforms-animations-and-masks/)的更多信息。

我猜这个功能在 Safari 4 中也可用，但我没有检查过。

编辑：看起来这也以[-moz-transform](https://developer.mozilla.org/En/CSS/-moz-transform)的形式进入 Mozilla 。

# jquery - jQuery插件结构

> ID：683727
> 
> 赞同：1
> 
> 时间：2009-03-25T22:15:57.057
> 
> 标签：jquery, jquery-plugins

我使用以下内容作为 jquery 插件的基础，但从我的 .find 开始，我似乎遇到了一些语法问题。不会调用 click 函数中的代码，也不会应用该类。有人可以建议我在这里可能出错的地方吗？

```
(function($){

        $.fn.expandCollapse = function(options){

             var opts = $.extend({}, $.fn.expandCollapse.defaults, options);

             function initialize(){

                $(this).each(function(){
                    // code
                }).find("p").click(function(){
                    // code
                }).end().not(:first).addClass(opts.c);
              }
            initialize();

            return $(this);

        };

        $.fn.expandCollapse.defaults = {
            c: "collapsed"
        };

})(jQuery); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T22:21:23.470

你有这个片段：

```
not(:first) 
```

尝试`':first'`用引号括起来。

# process - 系统管理自动化的 Biztalk 替代方案？

> ID：683732
> 
> 赞同：0
> 
> 时间：2009-03-25T22:17:25.213
> 
> 标签：process, automation, biztalk

我正在与一家小型托管服务提供商合作，他们正在寻找一个“电机”作为自动化其 IT 相关流程（以及可能还有其他流程）的中心枢纽。这方面的一个例子可能是客户从他们的网站订购自定义虚拟服务器. 该服务器需要通过审批链（如果是新客户）或直接进入部署，各种服务器将通过脚本进行设置。基本上，我们正在寻找作为“中心”的东西，所有这些脚本捆绑在一起，描述和执行各种过程。

我一直在关注 Biztalk 服务器，但我知道这是一个复杂的产品。有人对我们应该检查的其他产品有什么建议吗？虽然这是一个混合（linuz 和 windows）环境，但进程系统将在 Windows 上运行。

最好的问候， 特隆德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T23:06:36.310

听起来像 Windows Workflow Foundation “东西”可能有用：http: [//msdn.microsoft.com/en-us/library/ms735967.aspx](http://msdn.microsoft.com/en-us/library/ms735967.aspx)

# windows - 面向 Windows 开发人员的 XML RPC GUI？

> ID：683745
> 
> 赞同：13
> 
> 时间：2009-03-25T22:19:54.457
> 
> 标签：windows, xml, rpc

Windows有类似的东西[吗？](http://ditchnet.org/xmlrpc/)

如果不是，那么测试 XML RPC 的最简单/最快的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T10:46:01.437

我正在使用 xmlrpc-test-tool，一个浏览器工具：[http ://code.google.com/p/xmlrpc-test/](http://code.google.com/p/xmlrpc-test/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-11-11T15:48:37.083

浏览器工具：

火狐：[http](http://restclient.net/) ://restclient.net/ 铬：[https ://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm](https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm)

特别是 Chrome 的 Postman 真是太棒了！

# .net - 如何在 asp 按钮上禁用回发 (System.Web.UI.WebControls.Button)

> ID：683746
> 
> 赞同：140
> 
> 时间：2009-03-25T22:19:58.467
> 
> 标签：.net, asp.net, javascript, ajax

我有一个asp按钮。它是服务器端的，所以我只能为登录的用户显示它，但我希望它运行一个 javascript 函数，它似乎在 runat="server" 时总是调用回发事件。

我还有一个常规按钮（`<input...`>）没有在服务器上运行，它工作正常......

我怎样才能让这个按钮只运行javascript而不是回发？

* * *

## 回答 #1

> 赞同：273
> 
> 时间：2009-03-25T22:22:54.840

完成后让您的 javascript 返回 false。

```
<asp:button runat="server".... OnClientClick="myfunction(); return false;" /> 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-03-25T22:23:35.883

```
YourButton.Attributes.Add("onclick", "return false"); 
```

或者

```
<asp:button runat="server" ... OnClientClick="return false" /> 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-07-24T08:12:53.290

您可以使用 jquery 单击操作并使用**preventDefault()**函数来避免回发

```
<asp:button ID="btnMyButton" runat="server" Text="MyButton" />

$("#btnMyButton").click(function (e) {
// some actions here
 e.preventDefault();
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-04-21T14:50:10.453

考虑一下。

```
<script type="text/javascript">
Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(BeginRequest);
function BeginRequest(sender, e) {
    e.get_postBackElement().disabled = true;

}
     </script> 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-25T22:28:46.153

其他人是正确的，您需要回调返回 false；但是我想补充一点，通过设置 onclick 是一种丑陋的旧做事方式。我建议阅读有关[不显眼的 javascript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)的内容。使用像[jQuery](http://jquery.com/)这样的库可以让您的生活更轻松，并且 HTML 与您的 javascript 的耦合更少（并且 jQuery现在[得到 Microsoft 的支持](http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx)！）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-03-27T17:01:35.340

ASP.NET 始终生`asp:Button`成为`input type=submit`.
如果您想要一个不发布帖子的按钮，但需要对服务器端的元素进行一些控制，请创建一个简单的 HTML 输入，其中包含属性`type=button`和`runat=server`.

如果您禁用点击操作`OnClientClick=return false`，它不会在点击时执行任何操作，除非您创建如下函数：

```
function btnClick() {
    // do stuff
    return false;
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-25T22:25:51.543

您没有说您使用的是哪个版本的 .NET 框架。

如果您使用的是 v2.0 或更高版本，则可以在引发按钮的 onclick 事件时使用 OnClientClick 属性执行 Javascript 函数。

为了防止发生服务器回发，您所要做的就是`false`从被调用的 JavaScript 函数返回。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-09-16T08:49:04.690

另外对于接受的答案，您可以使用 UseSubmitBehavior="false" [MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.button.usesubmitbehavior.aspx)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-05-04T17:14:10.397

就我而言，我解决了在 onClientClick 中添加返回：

## 代码背后

```
function verify(){
  if (document.getElementById("idName").checked == "") {
    alert("Fill the field");
    return false;
  }
} 
```

## 设计表面

```
<asp:Button runat="server" ID="send" Text="Send" onClientClick="return verify()" /> 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-11-03T10:59:42.627

有验证

在这个例子中，我使用了两个控件，`ddl`并且`txtbox`，有一个愉快的编码

```
 asp:ScriptManager ID="script1" runat="server" /asp:ScriptManager

    asp:UpdatePanel ID="Panel1" runat="server"
       ContentTemplate

// ASP BUTTON
asp:Button ID="btnSave" runat="server" Text="Save" class="btn btn-success" OnClientClick="return Valid()" OnClick="btnSave_Click"

   /ContentTemplate    
    /asp:UpdatePanel    

  <script type="text/javascript">
        function Valid() {

            if ($("#ctl00_ContentPlaceHolder1_YOUR CONTROL NAME").val() == 0) {
                alert("Please select YOUR TEXT");
                $("#ctl00_ContentPlaceHolder1_YOUR CONTROL NAME").focus();
                return false;
            }

            if ($("#ctl00_ContentPlaceHolder1_YOUR CONTROL NAME").val().length == 0) {
                alert("Please Type YOUR TEXT");
                $("ctl00_ContentPlaceHolder1_YOUR CONTROL NAME").focus();
                return false;
            }
            return true;
        }
</script> 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-11-28T17:08:41.990

您可以使用以下代码：

```
<asp:Button ID="Button2" runat="server"
     Text="Pulsa"
     OnClientClick="this.disabled=true"
     UseSubmitBehavior="False"/>
```

如果需要提交

```
...
<form id="form1" runat="server" onsubmit="deshabilita()">
...
<script type="text/javascript">
    function deshabilita()
    {
        var btn = "<%= Button1.ClientID %>";
        if (confirm("Confirme postback"))
        {
            document.getElementById(btn).disabled = true;
            return true;
        }
        return false;
    }
</script>
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-05-19T11:20:05.717

您可以为此使用 JQuery

```
<asp:Button runat="server" ID="btnID" /> 
```

比在 JQuery 中

```
$("#btnID").click(function(e){e.preventDefault();}) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-09-23T02:42:17.753

你只需要从

```
function jsFunction() {
  try {
    // Logic goes here
    return false; // true for postback and false for not postback
  } catch (e) {
    alert(e.message);
    return false;
  }
}
```

```
<asp:button runat="server" id="btnSubmit" OnClientClick="return jsFunction()" />
```

JavaScript 函数如下所示。

**注意***：始终使用 try-catch 块并从 catch 块返回 false 以防止 javaScript 函数中的错误计算。

# c# - 分布式应用模型，服务器和多个客户端（客户端可以在服务器上运行）

> ID：683750
> 
> 赞同：0
> 
> 时间：2009-03-25T22:21:29.167
> 
> 标签：c#, .net, wcf, remoting, client-server

我有一个我正在设计的系统，我们使用 4 台我们在内部制造的具有 16 个串行端口（db-9 RS232）的专用 PC 我需要同时与 64 个单元（4x16）通信并管理通信。 **这是我想出的模型，我正在征求反馈**

**服务器：** 在一个系统上运行并协调客户端应用程序。维护一个主状态机并确保客户端与该状态机同步。（例如，所有单元都执行任务 A，当最后一个报告完成时，所有单元都执行任务 B）。

**通过.net 远程通信？WCF？**

**客户端：** 可以与服务器在同一系统上运行。管理所有 IO。管理实际任务执行的业务逻辑**（坏主意？）**通过 Remoting/WCF**通过通知事件（例如 INotifyPropertyChanged）**报告状态。

我从未使用过 .net 远程处理或任何类型的分布式应用程序，所以我在这方面完全是新手，但我确实学得很快。 **在这一点上，文学和社区建议将不胜感激。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T22:31:26.333

绝对检查并发和协调运行时（CCR）：

[http://msdn.microsoft.com/en-us/library/bb648752.aspx](http://msdn.microsoft.com/en-us/library/bb648752.aspx)

编辑：

下载链接：

[http://msdn.microsoft.com/en-us/robotics/aa731520.aspx](http://msdn.microsoft.com/en-us/robotics/aa731520.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T06:12:52.357

如果我是你，我会阅读分布式系统设计。通常，在系统中出现单点故障是一个坏主意（一台特殊的 PC 是“服务器”，所有其他 PC 都需要与之通信。）

但在你的情况下，这很可能无关紧要。

阅读分布式系统设计。

我会说，您选择的 API 并不是最重要的。首先，您需要规划架构，以及您希望在各种场景中获得的行为（例如其中一台 PC 擅离职守。）。

只是阅读您的请求后的快速反应，我会研究分布式发布/订阅系统。如何实现发布/订阅取决于您。您可以使用 MSMQ，或 WCF 和 WS-Eventing，或 ....

# sql - 存储过程是什么时候引入 SQL Server 产品的？

> ID：683752
> 
> 赞同：2
> 
> 时间：2009-03-25T22:22:17.183
> 
> 标签：sql, sql-server

对于计算机历史爱好者来说，这是一个不同的问题。帮我解决我和我的一个朋友之间的赌注：

问：存储过程是什么时候引入 SQL Server 产品的？我需要年份和/或版本。

谢谢。

**编辑：** 好的，从 SQL Server 回到 Sybase

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T22:25:52.913

如果您询问的是 MS SQL Server，它们一直都在，就像微软从 Sybase 获得产品许可时一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T22:43:59.860

自从 MS 从 Sybase 获得该产品以来，存储过程就已经存在，但是密切相关的用户定义函数仅在 SQL Server 2000（它取代了 SQL Server 7）之后才出现。恕我直言，他们是这次升级*的*主要胜利。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T22:31:24.447

作为旁注，请阅读本文以了解内部人员[的 SQL Server 历史。](http://blogs.msdn.com/euanga/archive/2006/01/19/514479.aspx)

# visual-studio - Visual Studio：打印解决方案中的所有源文件？

> ID：683759
> 
> 赞同：21
> 
> 时间：2009-03-25T22:24:13.853
> 
> 标签：visual-studio, printing

有没有办法一次打印解决方案中的所有 (*.cs) 文件，也就是说，无需单击每个文件然后点击打印？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-25T22:51:40.187

根据我从[其他地方提出的类似问题](http://www.bokebb.com/dev/english/1959/posts/195953665.shtml)收集到的信息，此“功能”并未内置到 Visual Studio 中。

但是看起来[MSDN 有一个宏可以用来打印所有代码](http://msdn.microsoft.com/en-us/library/ms973240.aspx)；也许您可以使用它或类似的东西：

```
Sub PrintItemsInSelectedProject()
    Dim proj As Project
    Dim objProj As Object()

    objProj = DTE.ActiveSolutionProjects
    If objProj.Length = 0 Then
        Exit Sub
    End If
    proj = DTE.ActiveSolutionProjects(0)
    PrintItemsInSelectedProject(proj.ProjectItems)
End Sub

Private Sub PrintItemsInSelectedProject( _
    ByVal projitems As ProjectItems)
    Dim projitem As ProjectItem

    For Each projitem In projitems
        If (IsPrintableFile(projitem) = True) Then
            If (projitem.IsOpen( _
                    EnvDTE.Constants.vsViewKindTextView)) Then
                projitem.Document.PrintOut()
            Else
                Dim doc As Document
                doc = projitem.Open( _
                    EnvDTE.Constants.vsViewKindTextView).Document
                doc.PrintOut()
                doc.Close(vsSaveChanges.vsSaveChangesNo)
            End If
        End If
        PrintItemsInSelectedProject(projitem.ProjectItems)
    Next
End Sub

Function IsPrintableFile( _
        ByVal projItem As ProjectItem) As Boolean
    Dim fileName As String
    Dim extensions As _
        New System.Collections.Specialized.StringCollection
    ' If you add a file to your project that is of 
    ' a type that can be printed, 
    ' then add the extension of that 
    ' file type to this list.
    Dim exts As String() = {".cs", ".vb", _
        ".aspx", ".xsd", ".xml", ".xslt", _
        ".config", ".htm", ".html", ".css", _
        ".js", ".vbs", ".wsf", ".txt", ".cpp", _
        ".c", ".h", ".idl", ".def", ".rgs", ".rc"}

    extensions.AddRange(exts)
    fileName = projItem.FileNames(1)
    Return extensions.Contains( _
        System.IO.Path.GetExtension(fileName).ToLower())
End Function 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-01-24T22:56:21.053

暂且不提树爱好者的有趣评论，让我们假设您想将 Visual Studio 解决方案打印为 PDF（以后我们不会问您用它做什么）。

对于使用 VisualStudio 的人来说，有一个非常好的程序，它曾经出售，但现在可以免费下载，称为 PrettyCode.Print for .NET 2.0。可在[此处](http://community.submain.com/files/folders/retired/entry1836.aspx)下载（该公司已[停用](http://submain.com/blog/CategoryView,category,PrettyCode.Print.aspx)该产品）。

它读入一个 VisualStudio 项目（与 VS2005、VS2008 和 VS2010 一起使用）并让人们打印具有各种打印选项的文件选择。它做得相当不错。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-10T16:11:57.947

您可以在以下网址下载 PrettyCode.Print for .NET 2.0（VS2008 和 VS2005）：[http](http://pan.baidu.com/wap/shareview?&shareid=3968547697&uk=286220058&dir=%2FSoftz&page=1&num=20&fsid=1117386981714891&third=0) ://pan.baidu.com/wap/shareview?&shareid=3968547697&uk=286220058&dir=%2FSoftz&page=1&num=20&fsid=1117386981714891&third=0 在我的电脑中使用 Visual Studio 2013 工作正常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-08T20:25:06.990

使用 powershell 打印所有 *.cs 文件。首先获取所有文件的列表 $files = Get-Childitem -Path C:\Users\David\source\repos\ConsoleApp -Exclude AssemblyInfo.cs, Program.cs -Include *.cs -Recurse

当您对列表感到满意时

foreach ($file in $files){ Get-Content $file.FullName |Out-printer}

# sql-server-ce - SQLCE - 忽略查询执行

> ID：683760
> 
> 赞同：2
> 
> 时间：2009-03-25T22:24:13.917
> 
> 标签：sql-server-ce

将数据库 (*.sdf) 部署到 Pocket PC WM 5.0。通过 C# 我正在尝试删除记录。DELETE 查询返回 5 行受到影响（有 5 行）。但是，当我在 Pocket PC 的查询工具下查看数据库时，行仍然存在。在我的代码级别没有出现错误或问题。

什么不见​​了？这是正确的数据库，因为如果我重命名或删除我会在打开时出错。怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-27T16:42:48.387

您是否在事务中执行 DELETE，而忘记 .Commit() 它？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-22T02:06:01.970

确保执行查询并调用正确的命令。

# eclipse - 在eclipse中传递JUnit命令行参数

> ID：683764
> 
> 赞同：7
> 
> 时间：2009-03-25T22:25:11.230
> 
> 标签：eclipse, command-line, junit

我最近一直在eclipse中使用junit，我还在学习。我知道如何在 Eclipse 中传递命令行参数，但是如何将它们传递给 Junit 中的测试用例？另外我如何访问它们？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T23:34:58.707

您不能将命令行参数传递给 JUnit 测试，因为没有运行 main 方法。您将需要使用系统属性并在测试用例中访问这些属性。

在 Package Explorer 中选择您的测试类。右键单击并选择`Run As -> Open Run Dialog`在运行对话框中有一个参数选项卡，您可以在其中指定程序和 VM 参数。您应该可以在此处输入您的系统属性参数。

或者，将所需项目作为当前项目，从主菜单中选择`Run -> Run Configurations`访问参数选项卡。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-02-18T14:35:30.413

我会跳过过去，因为有人已经回答过了。要访问您，请使用：

```
System.getProperty("propert.name.here"); 
```

（返回字符串）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-02-19T22:19:14.043

在此示例中，我在运行配置窗口中`webDriver`传递了一个参数：`firefoxDriver`

[![例子](https://i.stack.imgur.com/VGVQn.png)](https://i.stack.imgur.com/VGVQn.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-11-17T09:03:44.080

可能您已经弄清楚了，但是在编译时，如果使用 ANT 或 MVN，您可以从 POM.XML 文件中将参数传递给您的 JUNIT 或 TestNG。

```
 <plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-surefire-plugin</artifactId>
  <version>2.4.3</version>
  <configuration>
    <forkMode>${test.junit.forkMode}</forkMode>
    <skip>${test.junit.skip}</skip>
    <argLine>${test.junit.argLine}</argLine>
    <jvm>${jdk.compiler.path}/binjava</jvm>
  </configuration>
</plugin> 
```

# javascript - 为什么萤火虫告诉我我的 JavaScript 数组未定义？

> ID：683772
> 
> 赞同：1
> 
> 时间：2009-03-25T22:27:14.940
> 
> 标签：javascript

刚开始在 JavaScript 中研究一个基本的网格分析算法，但我遇到了一个令我困惑的错误。

```
var max = 9;
var testArray = new Array(
  ['7', '3', '9', '6', '4', '1', '5', '2', '8'],
  ['1', '8', '2', '7', '5', '3', '4', '6', '9'],
  ['9', '5', '7', '3', '8', '2', '1', '4', '6'],
  ['3', '1', '4', '9', '6', '7', '2', '8', '5'],
  ['6', '2', '8', '5', '1', '4', '9', '3', '7'],
  ['5', '4', '6', '2', '9', '8', '3', '7', '1'],
  ['8', '7', '1', '4', '3', '5', '6', '9', '2'],
  ['2', '9', '3', '1', '7', '6', '8', '5', '4']
);

function checkYoSelf(myGrid) {
  var i; var j;
  var horizLine = new String;
  for( i = 0; i <= (max - 1); i++ ) {
    for( j = 0; j <= (max - 1); j++) {
      document.write(i+"<br />");
      horizLine += myGrid[i][j];
    }
    var test = RegExp(i, "ig");
    var result = new Array(horizLine.match(test));
    if( result.length > 1 ) {
      alert("fail");
    }    
  }
}

html file has <a href='#' onclick="checkYoSelf(testArray);">check</a> 
```

根据萤火虫`myGrid[i]`是未定义的，但我不知道为什么会这样。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T22:37:03.230

好吧，这对我有用......我刚刚将您的“max”变量替换为更动态的东西：

```
<script type="text/javascript">
    var testArray = new Array(
        ['7', '3', '9', '6', '4', '1', '5', '2', '8'],
        ['1', '8', '2', '7', '5', '3', '4', '6', '9'],
        ['9', '5', '7', '3', '8', '2', '1', '4', '6'],
        ['3', '1', '4', '9', '6', '7', '2', '8', '5'],
        ['6', '2', '8', '5', '1', '4', '9', '3', '7'],
        ['5', '4', '6', '2', '9', '8', '3', '7', '1'],
        ['8', '7', '1', '4', '3', '5', '6', '9', '2'],
        ['2', '9', '3', '1', '7', '6', '8', '5', '4']
    );

    function checkYoSelf(myGrid) {
        var i;
        var j;
        var horizLine = new String;

        var maxRows = myGrid.length;
        for( i = 0; i < maxRows; i++ ) {
            var maxColumns = myGrid[i].length;
            for( j = 0; j < maxColumns; j++) {
                document.write(i+"<br />");
                horizLine += myGrid[i][j];
            }

            var test = RegExp(i, "ig");
            var result = new Array(horizLine.match(test));
            if( result.length > 1 ) {
                alert("fail");
            }
        }
    }
</script>

<a href='#' onclick="checkYoSelf(testArray);">check</a> 
```

不知道你想用这个做什么，但至少它没有给出任何错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T22:29:55.010

从哪里来`max`？

> max 是全局定义的（在这种情况下 max = 9）

你只有 8 行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T22:31:56.440

从您的评论到 nickf 的回答：这是因为 max 为 9，但数组中只有 8 行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T22:32:33.320

萤火虫 说

> 最大值未定义

当最后一个索引是 testArray[7] 时，您正在尝试访问 checkYoSelf(testArray) 中的 testArray[8]。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T22:36:57.787

`testArray`包含 8 个元素。您正在访问`testArray[8]`，这是无效的，因为索引必须是 0..7 (0..8-1)。在数组中添加另一行，或将第一行重写为：

```
for( i = 0; i <= (max - 2); i++ ) { 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T23:24:44.210

如果你重写

```
for( i = 0; i <= (max - 1); i++ ) {
   for( j = 0; j <= (max - 1); j++) { 
```

作为

```
for( i = 0; i < (max - 1); i++ ) {
   for( j = 0; j < max; j++) { 
```

它应该工作。网格的第一个维度只有 8。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-26T00:21:27.833

感谢大家的帮助，由于代码为：

```
var testArray = new Array(
  ['7', '3', '9', '6', '4', '1', '5', '2', '8'],
  ['1', '8', '2', '7', '5', '3', '4', '6', '9'],
  ['9', '5', '7', '3', '8', '2', '1', '4', '6'],
  ['3', '1', '4', '9', '6', '7', '2', '8', '5'],
  ['5', '4', '6', '2', '9', '8', '3', '7', '1'],
  ['6', '2', '8', '5', '1', '4', '9', '3', '7'],
  ['8', '7', '1', '4', '3', '5', '6', '9', '2'],
  ['2', '9', '3', '1', '7', '6', '8', '5', '4'],
  ['2', '9', '3', '1', '7', '6', '8', '5', '4']
);

function checkYoSelf(myGrid) {
  var i;
  var j;
  var horizLine = new String;
  var max = myGrid.length;

  for( i = 0; i < max; i++ ) {
    for( j = 0; j < max; j++) {
      horizLine += myGrid[i][j];
    }
    var test = RegExp(i, "ig");
    var result = new Array(horizLine.match(test));
    if( result.length > 1 ) {
      alert("fail");
    }    
  }
} 
```

# linux - 当参数列表太长时如何正确使用“xargs”

> ID：683776
> 
> 赞同：8
> 
> 时间：2009-03-25T22:28:25.780
> 
> 标签：linux, bash, unix

有人可以给我一个在下面的操作中使用 xargs 的例子吗？

```
tar c $dir/temp/*.parse\
    | lzma -9 > $dir/backup/$(date '+%Y-%m-%d')-archive.tar.lzma 
```

我从 bash “ **/bin/tar: Argument list too long** ”中得到错误

特别是我正在尝试对大约 4,500 个文件进行 LZMA 压缩；所以这并不奇怪。我只是不知道如何修改上面的内容以使用 xargs 并摆脱错误！谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T22:38:52.900

扩展 CristopheDs 的答案并假设您使用的是 bash：

```
tar c --files-from <(find $dir/temp -maxdepth 1 -name "*.parse") | lzma -9 > $dir/backup/$(date '+%Y-%m-%d')-archive.tar.lzma 
```

`xargs`在这里对您没有帮助的原因是它会执行多次调用，直到使用了所有参数。这在这里对您没有帮助，因为这会创建*几个*您不想要的 tar 档案。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-25T23:15:36.460

作为旁注：

始终，始终避免使用 xargs(1)。这是一个损坏的工具，只有在使用 -0 选项时才有用。即便如此，使用 find(1) 的 -exec 选项或简单的 for 或 while 循环几乎总是更好。

为什么 xargs 如此糟糕？首先，它将输入拆分为空格，这意味着所有**包含**空格的文件名都会造成破坏。其次，它*试图*成为一个聪明人，并为你*解析报价*。**当您在包含**引号作为文件名一部分的文件名上使用它时，这只会导致更多的头痛，例如歌曲：“*我不想错过任何东西.mp3* ”。这只会让 xargs 呕吐并诅咒你，因为你引用了它的输入很糟糕。不，你没有：它应该只知道**引号不属于输入数据，它们属于 shell 脚本**，并且 xargs 没有尝试解析它们的业务。

请注意，当您将 -0 传递给 xargs(1) 时，它不会进行空格拆分或引号解析。它做了*正确的事情*，即使用 NULL 字节来分隔文件名。但这意味着您需要为其提供使用 NULL 字节分隔文件名的输入（例如“ *find -foo -print0* ”）。这让我们回到：最好只使用 find 的 -exec：“ *find -foo -exec bar {} +* ”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-25T22:34:26.187

使用 find 将“想要的”文件名通过管道传输到临时文件，然后使用带有“--files-from”命令行选项的 tar。

**编辑：**

或将它们直接相互连接以避免临时文件。

所以：使用 find 列出想要的文件名 | tar ... --files-from

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-25T22:42:08.647

也许你想要这样的东西？

```
find $dir/temp/ -name '*.parse' -print0 | tar --null -T - -c | lzma -9 > $dir/backup/$(date '+%Y-%m-%d')-archive.tar.lzma 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T22:55:57.727

由于你在 Linux 上，你有 GNU tar，你可以使用 ' `-F -`' 或 ' `--files-from`' 选项来读取文件名。

但是，您也可以使用：

--use-compress-program="lzma -9"

指定要使用的压缩程序，并简单地将压缩文件名作为“tar”命令的目标文件。

`-j`在添加 ' ' 选项之前，这对于 'bzip2' 压缩是必要的。

# vmware - 如何在 VMWare ESXi 中正确设置资源池？

> ID：683780
> 
> 赞同：-1
> 
> 时间：2009-03-25T22:29:56.960
> 
> 标签：vmware, esxi

如何在 VMWare ESXi 中正确设置资源池？有没有人有任何博客条目等？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T20:19:00.810

注册一个 VMworld 帐户并观看来自[VMworld 2007的视频](http://www.vmworld.com/community/sessions/2007)

特别是 IO20 和 IO21。您必须有一个帐户才能查看，并且直接链接有点不稳定。

# c# - 有没有办法检测 Window Mobile 上的键盘类型？

> ID：683782
> 
> 赞同：1
> 
> 时间：2009-03-25T22:30:39.300
> 
> 标签：c#, windows-mobile, compact-framework

我希望能够检测 WM 手机的键盘类型，无论是 12 键还是 QWERTY，以动态更改我的应用程序的 UI。

有没有办法可靠地检测到这一点？

首选托管代码解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T12:41:18.980

（紧凑）框架中没有任何内容可以执行此操作。

我知道 Symbol 在他们的 SDK 中有一个 API 调用，用于在支持多个键盘选项的设备中检测到这一点。这是我见过的最近的。对不起，没有什么通用的。

# xaml - 谷歌代码搜索 - 错过的语言

> ID：683783
> 
> 赞同：0
> 
> 时间：2009-03-25T22:31:03.120
> 
> 标签：xaml, powershell, code-search

这很奇怪，但在支持的语言 [http://www.google.com/codesearch/advanced_code_search](http://www.google.com/codesearch/advanced_code_search)中我看不到 PowerShell 和 XAML ？！

如何过滤该语言的结果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T22:35:34.577

来自[Codesearch 常见问题解答：](http://www.google.com/intl/en/help/faq_codesearch.html#langs)

> 你们支持哪些编程语言？
> 
> 高级代码搜索页面列出了我们能够检测到的编程语言。但是，即使您选择的语言不在那里，您仍然可以搜索用该语言编写的代码。我们使尽可能多的代码可搜索，包括我们无法检测到语言的代码。当我们能够检测到文件的编程语言时，我们会在搜索结果中指出这一点，并且您可以将搜索限制为以该语言编写的代码。
> 
> 如果我们未检测到您关心的语言，则该`file:`运算符可用于搜索具有特定扩展名的文件。例如，您可以将搜索限制为带有`.x`或`.abc`扩展名的文件，查询如`myquery file:\.(x|abc)$`. 如果我们没有检测到您认为重要的语言，请务必告知我们。

# javascript - 将 iframe 内容置于所有内容之上

> ID：683786
> 
> 赞同：2
> 
> 时间：2009-03-25T22:31:35.273
> 
> 标签：javascript, html, iframe

当用户单击页面标题上的链接时，我需要显示一个 iframe。如何确保 iframe 始终位于所有内容之上？在这种情况下，CSS z-indexs 不能有效地工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T22:50:52.200

`z-index`可能不起作用，因为您`iframe`不是[定位框](http://www.w3.org/TR/CSS2/visuren.html#z-index)：

> 对于定位框，“z-index”属性指定：
> 
> 1.  当前堆栈上下文中盒子的堆栈级别。
> 2.  盒子是否建立本地堆叠上下文。

将其设置`position`为`static`. 例如：

```
iframe#myiframe {
    z-index: 20;
    position: absolute;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T22:53:14.987

z-index 仅适用于定位的内容。要么使用*position:absolute;* 和 top/left/right 来定位元素或使用*position:relative;* 将元素留在原处。

任何一个都应该在元素上启用 z-index。

# c# - Winforms DataGridView 数据绑定到复杂类型/嵌套属性

> ID：683796
> 
> 赞同：14
> 
> 时间：2009-03-25T22:34:56.013
> 
> 标签：c#, .net, data-binding, datagridview, .net-3.5

我正在尝试将 a 数据绑定`DataGridView`到包含具有以下结构的类的列表：

```
MyClass.SubClass.Property 
```

当我单步执行代码时，`SubClass`从未请求过。

我没有收到任何错误，只是没有看到任何数据。

请注意，我可以在具有相同层次结构的编辑表单中进行数据绑定。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-25T23:21:06.307

[得墨忒耳法则](http://en.wikipedia.org/wiki/Principle_of_least_knowledge)。

在 MyClass 上创建一个公开 SubClass.Property 的属性。像这样：

```
public class MyClass
{
   private SubClass _mySubClass;

   public MyClass(SubClass subClass)
   {
      _mySubClass = subClass;
   }

   public PropertyType Property
   {
      get { return _subClass.Property;}
   }   
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-07-12T14:04:03.520

您可以将处理程序添加到 DataBindingComplete 事件并在那里填充嵌套类型。像这样的东西：

在 form_load 中：

```
dataGridView.DataBindingComplete += new DataGridViewBindingCompleteEventHandler(dataGridView_DataBindingComplete); 
```

稍后在代码中：

```
void dataGridView_DataBindingComplete(object sender,
        DataGridViewBindingCompleteEventArgs e)
{
    foreach (DataGridViewRow row in dataGridView.Rows)
    {
        string consumerName = null;
        consumerName = ((Operations.Anomaly)row.DataBoundItem).Consumer.Name;
        row.Cells["Name"].Value = consumerName;
    }
} 
```

这不好，但有效。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T23:06:10.650

您不能将 DataGridView 绑定到嵌套属性。这不被允许。

一种解决方案是将此[ObjectBindingSource](http://www.codeproject.com/KB/cs/ObjectBindingSource.aspx)用作数据源。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-07-08T21:05:38.127

你也可以使用 Linq！

获取您的通用列表并使用 .select 选择以下示例中的字段：

```
 var list = (your generic list).Select(i => new { i.idnfe, i.ide.cnf }).ToArray(); 

 if (list .Length > 0) {
      grid1.AutoGenerateColumns = false;
      grid1.ColumnCount = 2;

      grid1.Columns[0].Name = "Id";
      grid1.Columns[0].DataPropertyName = "idnfe";
      grid1.Columns[1].Name = "NumNfe";
      grid1.Columns[1].DataPropertyName = "cnf";

      grid1.DataSource = lista;
      grid1.Refresh();

} 
```

# oop - PowerShell 是否支持 OOP？

> ID：683811
> 
> 赞同：10
> 
> 时间：2009-03-25T22:40:57.857
> 
> 标签：oop, powershell

PowerShell 中的类、接口、Mixin 等概念是什么？支持面向对象吗？如果是这样，我在哪里可以读到这个？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T22:49:31.657

`Add-Type`您可以使用cmdlet在 PowerShell v2.0 中定义新类型：

> **详细说明**
> 
> Add-Type cmdlet 允许您在 Windows PowerShell 会话中定义 .NET 类。然后，您可以实例化对象（通过使用 New-Object cmdlet）并使用这些对象，就像使用任何 .NET 对象一样。如果将 Add-Type 命令添加到 Windows PowerShell 配置文件，则该类将在所有 Windows PowerShell 会话中可用。
> 
> 您可以通过指定现有程序集或源代码文件来指定类型，也可以在行中指定源代码或保存在变量中。您甚至可以只指定一个方法，Add-Type 将定义并生成该类。您可以使用此功能对 Windows PowerShell 中的非托管函数进行平台调用 (P/Invoke) 调用。如果您指定源代码，Add-Type 将编译指定的源代码并生成包含新 .NET 类型的内存程序集。
> 
> 您可以使用 Add-Type 的参数来指定替代语言和编译器（默认为 CSharp）、编译器选项、程序集依赖项、类命名空间以及类型名称和生成的程序集。

`help Add-Type`了解更多信息。

另见：

*   [如何在 PowerShell 中创建自定义类型以供我的脚本使用？](https://stackoverflow.com/questions/59819/how-do-i-create-a-custom-type-in-powershell-for-my-scripts-to-use)

*   [http://thepowershellguy.com/blogs/posh/archive/2008/06/02/powershell-v2-ctp2-making-custom-enums-using-add-type.aspx](http://thepowershellguy.com/blogs/posh/archive/2008/06/02/powershell-v2-ctp2-making-custom-enums-using-add-type.aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-26T01:16:27.483

PowerShell 更像是一种 OOP 消费者语言。它可以利用大部分 .NET Framework，但它本身不支持创建接口、类，当然也不支持 mixin。PowerShell 的类型系统所基于的 .NET 不支持 mixins。PowerShell 确实支持通过 Add-Member cmdlet 向现有对象动态添加属性和方法。

Add-Type 很有用，但如果您必须转义到 C# 或 VB 来定义实现特定接口的类或类，我不会认为第一个类支持创建类/接口。

如果您正在寻找一些免费的学习材料，请查看[有效的 Windows PowerShell](http://tinyurl.com/efposh)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-01-12T14:15:24.830

Powershell 5 似乎支持一些主流的 OOP。

所有功劳归于这个人：[https ://xainey.github.io/2016/powershell-classes-and-concepts/](https://xainey.github.io/2016/powershell-classes-and-concepts/)

一个类的例子：

```
 class myColor
    {
        [String] $Color
        [String] $Hex

        myColor([String] $Color, [String] $Hex)
        {
            $this.Color = $Color
            $this.Hex = $Hex
        }

        [String] ToString()
        {
            return $this.Color + ":" + $this.Hex
        }
    } 
```

抽象类的示例：

```
class Foo
{
    Foo ()
    {
        $type = $this.GetType()

        if ($type -eq [Foo])
        {
            throw("Class $type must be inherited")
        }
    }

    [string] SayHello()
    {
        throw("Must Override Method")
    }
}

class Bar : Foo
{
    Bar ()
    {

    }

    [string] SayHello()
    {
        return "Hello"
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T22:49:37.583

PowerShell 管道处理对象，而不仅仅是 Unix 管道处理的文本流。所有变量也是对象的实例。顺便说一句，这些都是 .NET 对象。

以下是通过管道传送到 get-member cmdlet 的“ls”命令的部分输出：

```
 PS C:\Documents and Settings\Administrator.DEV-3DPST1-SWK> ls | get-member

   TypeName: System.IO.DirectoryInfo

Name                      MemberType     Definition
----                      ----------     ----------
Create                    Method         System.Void Create(DirectorySecurity directorySecurity), System.Void Create()
CreateObjRef              Method         System.Runtime.Remoting.ObjRef CreateObjRef(Type requestedType)
CreateSubdirectory        Method         System.IO.DirectoryInfo CreateSubdirectory(String path), System.IO.Director...
Delete                    Method         System.Void Delete(), System.Void Delete(Boolean recursive)
Equals                    Method         System.Boolean Equals(Object obj)
GetAccessControl          Method         System.Security.AccessControl.DirectorySecurity GetAccessControl(), System....
GetDirectories            Method         System.IO.DirectoryInfo[] GetDirectories(String searchPattern), System.IO.D...
GetFiles                  Method         System.IO.FileInfo[] GetFiles(String searchPattern), System.IO.FileInfo[] G...
GetFileSystemInfos        Method         System.IO.FileSystemInfo[] GetFileSystemInfos(String searchPattern), System...
GetHashCode               Method         System.Int32 GetHashCode()
GetLifetimeService        Method         System.Object GetLifetimeService()
GetObjectData             Method         System.Void GetObjectData(SerializationInfo info, StreamingContext context)
GetType                   Method         System.Type GetType()
get_Attributes            Method         System.IO.FileAttributes get_Attributes()
get_CreationTime          Method         System.DateTime get_CreationTime() 
```

get-member 显示您通过管道传递给它的对象的成员。您可以看到这些是 System.IO.DirectoryInfo 类的实际成员。

# asp.net-mvc - 您如何在 asp.net webform 和 mvc 应用程序之间进行选择？

> ID：683813
> 
> 赞同：1
> 
> 时间：2009-03-25T22:41:05.607
> 
> 标签：asp.net-mvc, webforms

这是一个很难问的问题，因为它涉及的范围非常广泛。

有谁知道在项目开始时有助于在 WebForms 和 MVC 应用程序之间进行选择的问题评分系统？

例如，TDD 是这个项目的重要组成部分吗？（如果是，则 MVC 得分 1，WebForms 得分 0）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T22:44:24.710

我有一个问题测试（免责声明：它远非完美，但在使您倾向于每种技术方面花费了很多时间）：

您的应用程序是否更面向表单（例如 Intranet 的东西或其他东西）或者您正在构建一个面向 Internet 的网站（例如 StackOverflow）。在第一种情况下，我可能会使用 Web 表单。ASP.NET MVC 可能更好地满足后一种情况。

另一件事：这两个并不是唯一的范例。在 MVC 时代之前，我通过构建 HTTP 处理程序完成了几个项目，这些处理程序执行 MVC 所做的路由和其他事情。您还可以剥离 ASP.NET 的 Web 表单部分，而只使用非服务器形式的 Web 控件（虽然您会在标准的 Web 表单项目中这样做，但我几乎不能将这种样式称为 ASP.NET Web 表单）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T23:08:10.630

我会考虑以下几点：

1.  团队的当前技能组合。如果您有一个大型团队，他们不会很快掌握 MVC，但对 Web 表单很满意，我会坚持使用 Web 表单

2.  您需要什么级别的控制？MVC 为您提供了更多控制权，但这也意味着您将自己做很多额外的事情。WebForms 给你的控制少了很多，但盒子里有很多东西。如果能够控制 HTML 输出对您来说很重要，那么 MVC 可能更适合。

3.  您需要第三方集成吗？对 MVC 的 3rd 方控件支持并不多，但是对 webforms 有大量的支持。在 web 表单中获得漂亮的网格很简单，但是您将在 MVC 中编写大量自己的代码来解决该问题

4.  正如您所提到的，TDD 是否可取？

5.  Web 表单中的状态管理要容易得多

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T23:11:09.263

除非您正在开发一个非常以数据为中心的应用程序并且需要具有数据绑定和视图状态的服务器控件，否则我会选择 MVC。

自从 MVC 预览版 2 以来，我没有在 Web 表单中做任何严肃的事情。MVC 在设计模式和最佳实践方面要好得多。

是的，IMO TDD 非常重要，它给 MVC 的分数超过了 1 分。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T22:54:13.533

通常，使用 WebForms 或 MVC 的决定归结为控件。如果您要使用大量服务器端控件，那么 WebForms 适合您。如果您没有这种负担，那么至少在我看来，MVC 会更干净，更可测试。

在使用它们之后，我现在决定的方式是：我需要使用服务器控件吗？如果我不这样做，那么我默认使用 MVC。

如果你因为某种原因被 WebForms 卡住了，那么你可以实现[MVP（Model-View-Presenter）](http://en.wikipedia.org/wiki/Model_View_Presenter)模式来将视图与逻辑分开，并希望对代码隐藏进行单元测试。

# google-maps - 谷歌地图查找最近的公用事业

> ID：683817
> 
> 赞同：7
> 
> 时间：2009-03-25T22:42:22.703
> 
> 标签：google-maps, geocoding

如何在特定城市/地区找到最近的医院/消防部门或类似的地方？

如果您访问 maps.google.com，然后输入“旧金山”，然后输入“医院”，您将看到旧金山周围的所有医院。

可以使用地理编码器应用相同的东西吗？

非常感谢！

**附加说明**：我正在尝试手动使用地理编码器，而不是使用搜索栏。这样我就可以控制搜索结果的结果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-27T01:55:19.643

使用带有 Viewport Biasing 的 HTTP Geocoder（请参阅：[ReverseGeocoding](http://code.google.com/apis/maps/documentation/geocoding/index.html#ReverseGeocoding)和[Viewport Biasing](http://code.google.com/apis/maps/documentation/geocoding/index.html#Viewports)）并过滤 JSON 结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T01:42:41.287

是的，它可以。

这里解释：[http ://code.google.com/apis/maps/documentation/services.html#LocalSearch](http://code.google.com/apis/maps/documentation/services.html#LocalSearch)

在此处查看示例：[http ://code.google.com/apis/maps/documentation/examples/control-googlebar.html](http://code.google.com/apis/maps/documentation/examples/control-googlebar.html)

# uml - 在 UML 类图中，边界类、控制类和实体类是什么？

> ID：683825
> 
> 赞同：97
> 
> 时间：2009-03-25T22:46:03.817
> 
> 标签：uml, class-diagram, ecb-pattern

我现在使用 NetBeans 作为我的首选 IDE，它有一个用于 UML 建模的插件。在类图中，有称为`Boundary Class`、`Control Class`和的模型元素`Entity Class`。但是，我找不到它们的良好定义，但我确实在 UML Class Diagrams 上找到[了这个站点。](http://www.developer.com/design/article.php/10925_2206791_2)

* * *

## 回答 #1

> 赞同：234
> 
> 时间：2013-06-10T16:41:24.430

健壮性图是在用例之后和类图之前编写的。它们有助于识别用例步骤的角色。您可以使用它们来**确保您的用例足够健壮**，以代表您正在构建的系统的使用要求。

它们涉及：

1.  演员
2.  用例
3.  ***实体***
4.  ***边界***
5.  ***控件***

[模型-视图-控制器](https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)模式用于用户界面，而实体-控制-边界模式 (ECB) 用于系统。如果有帮助，ECB 的以下方面可以比作 MVC 的抽象版本：

![UML 符号](https://i.stack.imgur.com/rQPvd.gif)

**实体** *（模型）*
表示系统数据的对象，通常来自域模型。

**边界** *（视图/服务协作者）*
与系统参与者（例如**用户**或**外部服务**）交互的对象。窗口、屏幕和菜单是与用户交互的边界示例。

**控件** *（controller）*
在边界和实体之间进行调解的对象。它们充当边界元素和实体元素之间的粘合剂，实现管理各种元素及其交互所需的逻辑。重要的是要理解，您可能决定在设计中将控制器实现为对象以外的其他东西——例如，许多控制器足够简单，可以作为实体或边界类的方法来实现。

**四个规则适用于他们的沟通：**

1.  Actor 只能与边界对象对话。
2.  边界对象只能与控制器和参与者对话。
3.  实体对象只能与控制器对话。
4.  控制器可以与边界对象和实体对象以及其他控制器对话，但不能与参与者对话

**允许通讯：**

```
 Entity    Boundary   Control
Entity     X                     X
Boundary                         X
Control    X          X          X 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-03-25T23:04:23.557

通常与 OOAD 和业务建模一起使用/作为其一部分。Neil 的定义是正确的，但它与 MVC 基本相同，只是为了业务抽象而已。“好的总结”做得很好，所以我不会在这里复制它，因为它不是我的工作，更详细但符合尼尔的要点。

**[很好的总结——Conceito：实体-控制-边界模式](http://www.utm.mx/~caff/doc/OpenUPWeb/openup/guidances/guidelines/entity_control_boundary_pattern_C4047897.html)**

[OOAD](http://en.wikipedia.org/wiki/Object-oriented_analysis_and_design)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-03-25T22:56:15.477

这些是分析中使用的类刻板印象。

*   边界类是系统边界的类——您或其他系统与之交互的类

*   实体类类是您的典型业务实体，如“人”和“银行账户”

*   控制类实现一些业务逻辑或其他

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-03-06T15:18:27.837

边界控制实体模式有两个版本：
- 旧结构，在 127 中描述（实体作为数据模型元素，控件作为函数，边界作为应用程序接口）
- 新对象模式

作为对象模式：
- 边界是“另一个世界”
- 任何内部逻辑中的控制（如 DDD 模式中的服务）
- 实体是对象的持久性服务（如 DDD 模式中的存储库）。
所有类都有操作（参见 Fowler 贫血域模型反模式）
它们都是 MVC 模式中的模型组件。规则：
- 只有 Boundary 为“另一个世界”提供服务
- Boundary 只能调用 Controll
- Control 可以调用任何人
- 实体不能呼叫任何人（！），只能被呼叫。

jz

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-29T21:06:18.677

实际上，稳健性图（或有时称为分析图）只是专门的类图。它们是 UML 的一部分，并且从一开始就是（参见 Jacobson 的书，统一软件开发过程 - “三个朋友”系列书籍的一部分）。上述书在第 183-185 页对这三个类有很好的定义。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-08-20T14:15:37.097

作为记录，**[实体-边界-控制模式](https://en.wikipedia.org/wiki/Entity-control-boundary)**来自用例驱动的软件开发，并且比[Scott Ambler](http://agilemodeling.com/artifacts/robustnessDiagram.htm)仅重用该概念的健壮性图要古老得多。

该模式不是 UML 的一部分，但与它密切相关，因为它是由 Ivar Jacobson（他于 1992 年发起）、Grady Booch 和 Jim Rumbaugh 推动的，他们是 UML 的创始人......以及统一过程（UP , RUP)。在 UML 中，它和其他任何东西一样只是刻板印象。

维基**[百科](https://en.wikipedia.org/wiki/Entity-control-boundary)**解释得最好，但控制类对应于用例，边界类对应于用例和参与者之间的关联，实体对应于被识别为涉及用例的域对象。

大多数 UML 工具与预定义的 BCE 构造型一起使用的循环符号也来自 Jacobson。稳健性规则只是上述用例映射的转置。

# c++ - 整数数组长度 C++

> ID：683838
> 
> 赞同：2
> 
> 时间：2009-03-25T22:52:25.690
> 
> 标签：c++, arrays

我必须在我的程序中使用一个动态长度 int 数组，并且希望能够在我的代码中的各个点获取其中的对象数量。我对 C++ 不是很熟悉，但这就是我所拥有的。为什么它没有给我正确的长度？谢谢。

```
<#include <iostream>
Using Namespace std;
int length(int*);

void main()
{
  int temp[0];
  temp[0] = 7;
  temp [1] = 10;
  temp[2] = '\0';

  cout << length(temp) << endl;
}

int length(int* temp)
{
    int i = 0;
    int count = 0;

    while (*temp + i != '\0')
    {
          count++;
          i++;
    }
    return count;
} 
```

目前它只是进入一个无限循环;_;

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-25T22:55:11.283

在 C++ 中，数组不是动态的。您的临时数组的长度为零，并且尝试写入超出其长度的成员是未定义的行为。它很可能不起作用，因为它会覆盖堆栈的某些部分。

要么创建一个具有足够空间的固定大小的数组来放置你想要的所有东西，要么使用`std::vector<int>`一个动态数据结构。

```
#include <iostream>
#include <vector>
using namespace std;
int length(int*);

int main ()  //  error: ‘::main’ must return ‘int’
{
    int temp[3];
    temp[0] = 7;
    temp[1] = 10;
    // don't use char constants for int values without reason
    temp[2] = 0; 

    cout << length(temp) << endl;

    vector<int> vec_temp;

    vec_temp.push_back(7);
    vec_temp.push_back(10);

    cout << vec_temp.size() << endl;

}

int length(int* temp)
{
    int i = 0;
    int count = 0;

    while (*(temp + i) != 0) // *temp + i == (*temp) + i
    {
          count++;
          i++; // don't really need both i and count
    }
    return count;
} 
```

对于向量，不需要在开始时指定大小，并且可以输入零，并且查找长度是一个简单的操作，而不需要循环。

循环中的另一个错误是您正在查看数组的第一个成员并将 i 添加到该值，而不是通过 i 递增指针。您实际上并不需要 i 和 count，因此可以编写其他几种方式，或者直接递增 temp：

```
int length(int* temp)
{
    int count = 0;

    while (*temp != 0)
    {
          ++count;
          ++temp;
    }

    return count;
} 
```

或使用计数来索引温度：

```
int length(int* temp)
{
    int count = 0;

    while (temp[count] != 0)
          ++count;

    return count;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T22:57:44.740

由于几个原因，这种方法是一个坏主意，但首先有一些问题：

```
int temp[0]; 
```

这是一个包含 0 项的数组，我什至认为堆栈元素不允许使用它。在声明这样的数组时，您必须指定将使用的最大值数：例如`int temp[10];`

**这是超级重要的！**- 如果您确实指定了一个更少的数字（例如 [10] 并且您使用 [11]），那么您将导致内存覆盖，这在最好的情况下会崩溃，在最坏的情况下会导致奇怪的错误，这些错误是追踪的噩梦。

下一个问题是这一行：

```
while (*temp + i != '\0') 
```

该行所做的是将值存储在 'temp' 指定的地址中并添加 i。您想要的是在 temp 指定的地址的第 n 个元素处获取值，如下所示：

```
while (*(temp + i) != '\0') 
```

所以这就是问题所在，但你应该花五分钟时间考虑一个更好的方法来做到这一点。

我提到这是一个坏主意的原因是：

*   您需要在需要长度的任何时候迭代整个数组
*   您永远不能将终止元素（在本例中为 0）存储在数组中

相反，我建议您维护一个单独的值来存储数组中的元素数量。一个非常常见的方法是创建一个包装这个概念的类（一个元素块和当前大小）。

C++ 标准库附带一个名为“vector”的模板类，可用于此目的。它与数组不太一样（您必须在索引之前先添加项目），但它非常相似。它还提供了对复制/调整大小的支持，这也很方便。

这是您编写的使用 std::vector 的程序。我添加了一些东西来打印出值，而不是“长度”函数：

```
#include <vector>
#include <iostream>

void print(std::vector<int> const& vec)
{
    using namespace std;

    for (size_t i = 0; i < vec.size(); i++)
    {
        cout << vec[i] << " ";
    }

    cout << endl;
}

int main()
{
    std::vector<int> temp;
    temp.push_back(7);
    temp.push_back(10);

    print(temp);

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T22:55:00.177

你可以试试：

```
while (*(temp + i) != '\0') 
```

您当前的解决方案是计算`temp[0] + i`(equals `7+i`)，这显然不是您想要的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-25T22:57:55.707

正如 Pete 指出的那样，不仅 C++ 数组不是动态的，而且只有字符串 (char *) 以 '\0' 结尾。（这并不是说您不能对其他类型使用类似的约定，但这是相当不寻常的，并且有充分的理由：特别是，依赖终止符需要您循环遍历数组以找到它的大小！）

在像您这样的情况下，最好使用标准库。

```
#include <vector>
#include <iostream>

int main()
{    
    std::vector<int> v;
    v.push_back(7);
    v.push_back(10);
    std::cout << v.size() << std::endl;
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-21T21:12:51.487

如果你不想使用 std::vector，试试这个：

```
#include <iostream>
using namespace std;

int main () {
    int vet[] = {1,2,3,4,5,6};
    cout << (sizeof (vet) / sizeof *(vet)) << endl;
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-16T06:41:20.373

如果要正确使用数组，则必须分配足够的内存来存储值。一旦你指定了它的长度，你就不能改变它。要知道数组大小，您应该将其存储在变量中，例如：

```
int n;
cin>>n;
int array = new int[n];
int array_length=n; 
```

如果要更改数组的长度，最好的方法是使用 std 容器，例如 std::vector。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-25T23:46:43.983

获取固定长度数组大小的最常见方法是这样的：

```
int temp[256];
int len = sizeof (temp) / sizeof (temp[0]);
// len == 256 * 4 / 4 == 256 on many platforms. 
```

这不适用于动态数组，因为它们实际上是指针。

```
int* temp = new int[256];
int len = sizeof (temp) / sizeof (temp[0]);
// len == 4 / 4 == 1 on many platforms. 
```

对于动态长度数组，如果您关心大小，最好在分配数组时将其存储在某个地方。

正如许多人所指出的那样，您的循环的问题是您在这里遇到了运算符优先级问题：

```
 *temp + i 
```

应该：

```
 *(temp + i) 
```

但更大的问题，同样在上面指出，是您似乎不了解指针与固定长度数组的区别，并且正在注销数组的末尾。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-12-22T11:54:43.060

这是您问题的答案

```
int myarr [] = {1, 2, 3, 4, 5};
int length = sizeof(myarr) / sizeof(myarr[0]);
cout << length; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-25T22:57:22.450

要在数组中获得动态行为，请使用 a ，或使用手动内存分配 (和)[*]`std::vector`使用老式 c 样式`int *``new``delete`

[*] C 实现（在字符数组的上下文中讨论为[C 动态字符串长度](https://stackoverflow.com/questions/671593/c-dynamic-string-length)）使用`malloc`、`realloc`和`free`，但在 c++ 代码中应避免使用这些。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-25T22:59:54.517

因为您只为零元素数组分配空间。以下几行

```
 temp [1] = 10;
  temp[2] = '\0'; 
```

不要分配更多内存或调整数组大小。您只是在数组外部写入数据，破坏了应用程序状态的其他部分。不要那样做。;)

如果你想要一个可调整大小的数组，你可以使用 std::vector （并使用 push_back 成员函数插入新值）

向量也有 size() 成员函数，它告诉你当前的大小。

如果要使用原始数组，则必须自己跟踪大小。（并且，当需要调整数组大小时，将旧数组中的所有元素复制到新的更大的数组中）

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2013-11-20T02:50:24.580

试试这个：

```
int length(int* temp)
{
    int count = 0;

    while (*temp != 0 && *temp != -858993460)
    {
        ++count;
        ++temp;
    }

    return count;
} 
```

# sql - 如何在 postgresql 中对未知数量的布尔值执行 AND？

> ID：683842
> 
> 赞同：7
> 
> 时间：2009-03-25T22:53:45.203
> 
> 标签：sql, postgresql, plpgsql

我有一个带有外键和布尔值的表（以及一堆在这里不相关的其他列），例如：

```
CREATE TABLE myTable
(
  someKey integer,
  someBool boolean
);

insert into myTable values (1, 't'),(1, 't'),(2, 'f'),(2, 't'); 
```

每个 someKey 可以有 0 个或多个条目。对于任何给定的 someKey，我需要知道 a) 所有条目是否为真，或者 b) 任何条目是否为假（基本上是 AND）。

我想出了以下功能：

```
CREATE FUNCTION do_and(int4) RETURNS boolean AS
$func$
declare
    rec record;
    retVal boolean = 't'; -- necessary, or true is returned as null (it's weird)
begin
    if not exists (select someKey from myTable where someKey = $1) then
        return null; -- and because we had to initialise retVal, if no rows are     found true would be returned
    end if;

    for rec in select someBool from myTable where someKey = $1 loop
        retVal := rec.someBool AND retVal;
    end loop;

    return retVal;
end;
$func$ LANGUAGE 'plpgsql' VOLATILE; 
```

...这给出了正确的结果：

```
select do_and(1) => t
select do_and(2) => f
select do_and(3) => null 
```

我想知道是否有更好的方法来做到这一点。在这个简单的场景中看起来并不算太糟糕，但是一旦你包含了所有支持代码，它就会变得比我想要的更长。我看了一下将 someBool 列转换为数组并使用 ALL 构造，但我无法让它工作......有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-04T12:02:44.157

无需重新定义 PostgreSQL 已经提供的函数：[bool_and](http://www.postgresql.org/docs/current/interactive/functions-aggregate.html) () 将完成这项工作：

```
select bool_and(someBool)
  from myTable
  where someKey = $1
  group by someKey; 
```

（抱歉，现在无法测试）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T23:15:56.040

与前一个类似，但在一个查询中，这将解决问题，但是，它的代码不干净也不易于理解：

```
SELECT someKey, 
  CASE WHEN sum(CASE WHEN someBool THEN 1 ELSE 0 END) = count(*)
                    THEN true 
                    ELSE false END as boolResult
FROM  table
GROUP BY someKey 
```

这将立即获得所有响应，如果您只想要一个键，只需添加一个 WHERE 子句

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-26T00:04:26.673

我本周第一次安装了 PostgreSQL，所以你需要清理语法，但这里的一般想法应该有效：

```
return_value = NULL

IF EXISTS
(
     SELECT
          *
     FROM
          My_Table
     WHERE
          some_key = $1
)
BEGIN
     IF EXISTS
     (
          SELECT
               *
          FROM
               My_Table
          WHERE
               some_key = $1 AND
               some_bool = 'f'
     )
          SELECT return_value = 'f'
     ELSE
          SELECT return_value = 't'
END 
```

这个想法是，您只需要查看一行以查看是否存在，如果至少存在一行，则只需查看直到找到错误值以确定最终值为 false（或者您到达结束，这是真的）。假设您在 some_key 上有一个索引，我认为性能应该不错。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-04T12:44:30.483

（非常次要的一点：我认为您的函数应该声明为 STABLE 而不是 VOLATILE，因为它只是使用数据库中的数据来确定其结果。）

正如有人提到的，您可以在遇到“假”值时立即停止扫描。如果这是一种常见情况，您可以使用游标来实际引发“快速完成”：

```
CREATE FUNCTION do_and(key int) RETURNS boolean
  STABLE LANGUAGE 'plpgsql' AS $$
DECLARE
  v_selector CURSOR(cv_key int) FOR
    SELECT someBool FROM myTable WHERE someKey = cv_key;
  v_result boolean;
  v_next boolean;
BEGIN
  OPEN v_selector(key);
  LOOP
    FETCH v_selector INTO v_next;
    IF not FOUND THEN
      EXIT;
    END IF;
    IF v_next = false THEN
      v_result := false;
      EXIT;
    END IF;
    v_result := true;
  END LOOP;
  CLOSE v_selector;
  RETURN v_result;
END
$$; 
```

这种方法还意味着您只对 myTable 进行一次扫描。请注意，我怀疑您需要大量的行才能使差异明显。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-23T08:28:38.027

您也可以使用`every`，这只是 的别名`bool_and`：

```
select every(someBool)
from myTable
where someKey = $1
group by someKey; 
```

使用every 使您的查询更具可读性。举个例子，展示所有每天只吃苹果的人：

```
select personId
from personDailyDiet
group by personId
having every(fruit = 'apple'); 
```

`every`在语义上与 bool_and 相同，但显然它`every`比以下更具可读性`bool_and`：

```
select personId
from personDailyDiet
group by personId
having bool_and(fruit = 'apple'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T23:10:44.150

也许用 somekey=somevalue 计算“所有”项目并将其用于与 somekey 的所有“真”出现次数的布尔比较？

一些未经测试的伪sql来说明我的意思......

```
select foo1.count_key_items = foo2.count_key_true_items
from
   (select count(someBool) as count_all_items from myTable where someKey = '1') as foo1,
   (select count(someBool) as count_key_true_items from myTable where someKey = '1' and someBool) as foo2 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-26T13:24:44.253

```
CREATE FUNCTION do_and(int4)
  RETURNS boolean AS
$BODY$
  SELECT
    MAX(bar)::bool
  FROM (
    SELECT
      someKey,
      MIN(someBool::int) AS bar
    FROM
      myTable
    WHERE
      someKey=$1
    GROUP BY
      someKey

    UNION

    SELECT
      $1,
      NULL
  ) AS foo;
$BODY$
  LANGUAGE 'sql' STABLE; 
```

如果您不需要 NULL 值（当没有任何行时），只需使用以下查询：

```
SELECT
  someKey,
  MIN(someBool::int)::bool AS bar
FROM
  myTable
WHERE
  someKey=$1
GROUP BY
  someKey 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-31T14:20:03.850

```
SELECT  DISTINCT ON (someKey) someKey, someBool
FROM    myTable m
ORDER BY
        someKey, someBool NULLS FIRST 
```

这将为每个 选择第一个有序布尔值`someKey`。

如果有 single`FALSE`或 a `NULL`，会先返回，表示`AND`失败。

如果第一个布尔值是 a `TRUE`，那么所有其他布尔值也`TRUE`适用于这个键。

与聚合不同，这将使用 上的索引`(someKey, someBool)`。

要返回`OR`，只需颠倒顺序：

```
SELECT  DISTINCT ON (someKey) someKey, someBool
FROM    myTable m
ORDER BY
        someKey, someBool DESC NULLS FIRST 
```

# asp.net - 为什么 document.getElementById('hyperlink_element_id') 返回超链接的 href 属性的值？

> ID：683844
> 
> 赞同：1
> 
> 时间：2009-03-25T22:54:12.237
> 
> 标签：asp.net, javascript, html, dom

我正在尝试通过 javascript 获取 Web.UI.WebControls.HyperLink 对象本身，以便我可以修改它的 ImageUrl。

在这里，我将超链接的 NavigateUrl 设置为我的 javascript 函数调用：

```
lnkShowHide.NavigateUrl = String.Format(
    "javascript:ShowHideElement('{0}');", lnkShowHide.ClientID
) 
```

这是我的javascript函数：

```
function ShowHideElement(img) {
   var ele = document.getElementById(img);
   if(ele != null) {
      // Not sure if this will change the hyperlink's ImageUrl property???
      img.src = 'smallPlus.gif';
   }
} 
```

但是，如果我在调用 getElementById 后检查 'ele' 的值，它会打印“ `String.Format("javascript:ShowHideElement.....`”并且实际上并没有获取超链接对象本身。

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T23:24:47.437

> 为什么 document.getElementById() 返回超链接的 href 属性的值？

它没有。但是当你“alert(element)”时，alert() 在元素上调用 toString()，HTMLLinkElement.toString() 返回 href 属性的内容，所以“alert(link)” 吐出的结果和“alert”一样（链接.href）”。

（这有点奇怪和令人困惑，但这就是 JavaScript 1.0 的工作方式，所以现在对此无能为力。）

> 我在调用 getElementById 后检查了 'ele' 的值，它打印出 "String.Format("javascript:ShowHideElement ....."

这不应该发生在您给出的确切示例中...除非您不小心将其括在引号中，否则服务器端“String.Format ...”代码无法进入客户端，例如.:

```
lnkShowHide.NavigateUrl = "String.Format(...)"; 
```

想到的其他问题是函数更改了名称（ShowHideElement/ShowHideImage），并且您似乎试图在链接元素（<a>）上设置“.src”。链接没有.src，只有图片有。

无论如何，您可能不想做这样的显示/隐藏小部件。javascript: URL 总是错误的，你的例子涉及很多相互嵌套的字符串，这些字符串总是很脆弱。您可以尝试一种“不显眼的脚本”方法，生成如下标记：

```
<div class="showhide"> blah blah blah </div> 
```

使用 JavaScript 在客户端添加打开/关闭功能（因此非 JavaScript UA 和搜索引擎将看到整个页面而不会隐藏位）。例如。：

```
function ShowHider(element) {
    var img= document.createElement('img');
    element.parentNode.insertBefore(img, element);

    function toggle() {
        var show= element.style.display=='none';
        element.style.display= show? 'block' : 'none';
        img.src= '/images/showhide/'+(show? 'open' : 'closed')+'.gif';
        img.alt= show? '-' : '+';
        img.title= 'Click to '+(show? 'close' : 'open');
    }
    img.onclick= toggle;
    toggle();
}

// Apply ShowHider to all divs with className showhide
//
var divs= document.getElementsByTagName('div');
for (var i= divs.length; i-->0;)
    if (divs[i].className=='showhide')
        ShowHider(divs[i]); 
```

# jquery - 在 jquery ajax load() 时运行后台函数

> ID：683849
> 
> 赞同：0
> 
> 时间：2009-03-25T22:55:25.700
> 
> 标签：jquery, ajax, throbber

我正在使用 jquery 的 load() 将一些内容放入 div，并且我想在“后台”中运行另一个函数，直到 load() 完成。该函数应每 1 秒更新一次自定义 throbber，直到 $("#id").html() == "" 在 load() 完成后 $("#id").html() 设置为 "" 。有什么办法可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T23:04:51.527

您是否*尝试过*按照您的描述进行操作？它应该像这样工作：

```
var interval = setInterval(function() {
    // update whatever you want
}, 1000);
$('#id').load('mypage.php', function() {
   clearInterval(interval);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T23:03:57.910

在执行jQuery加载命令之前执行该函数应该这样做，然后在加载回调函数中，设置`$("#id").html("")`

# arrays - 数组中最大的单词

> ID：683858
> 
> 赞同：0
> 
> 时间：2009-03-25T22:59:07.920
> 
> 标签：arrays

嘿，我在为程序创建一个简单的按钮时遇到问题，该按钮在数组中找到最大的单词并将其放入文本框中。我已经完成了大部分编码（我希望），我想知道是否有人可以帮助我实际使用在数组中找到最大文本的代码，因为我正在为此苦苦挣扎。

```
 Private Sub btnLongName_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnLongName.Click
        Dim LongName As String
        Dim LengthOfLongestName As Integer
        Dim UltimateName As String

        For i As Integer = 0 To 5
            LongName = Members(i).Name
            LengthOfLongestName = Len(LongName)
            If Members(i).Name.Length > LengthOfLongestName Then

            End If
        Next i

        txtResult.Text = "The longest name is " & UltimateName & " ."
    End Sub
End Class 
```

感谢您抽出宝贵的时间 - 它的大学作业，在它上面苦苦挣扎:(

编辑：我已经编辑了代码

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-25T23:03:05.430

由于这是作业，我不会为您编写代码；相反，我会尝试给您一些提示，为您指明正确的方向。

1.  声明一个适当类型的变量来保存`<longest value so far>`，用该类型的“最短”值初始化它。
2.  循环遍历数组中的所有值（可能使用[`For`](http://msdn.microsoft.com/en-us/library/zxkf5z4b.aspx)or[`For Each`](http://msdn.microsoft.com/en-us/library/4x2w6d8f.aspx)循环）

循环内部的伪代码：

```
If the Length of <the value being checked> exceeds _
   the Length of the <longest value so far> Then 

   Assign <the value being checked> to the <longest value so far> 

End If 
```

当循环结束时，`<longest value so far>`将是数组中最长的值。

**笔记**

*   您可以使用 MSDN 作为关于如何使用[循环`For`或](http://msdn.microsoft.com/en-us/library/zxkf5z4b.aspx)循环[`For Each`的](http://msdn.microsoft.com/en-us/library/4x2w6d8f.aspx)参考 （如果您还没有学习过`For`循环，您也可以使用 a [`Do Loop`](http://msdn.microsoft.com/en-us/library/ya7d9b6t(VS.71).aspx)）
*   `<the value being checked>`通过循环的每次迭代都会有所不同；它应该对应于数组中的每个连续值。[您可以通过设置断点](http://msdn.microsoft.com/en-us/library/k80ex6de.aspx)来验证这是否有效。
*   你可以通过说得到一个字符串的长度`myString.Length`
*   如果您了解`Function`s，请考虑编写一个以数组为参数并返回数组中最长值的函数。
*   当然有一些方法可以用 LINQ 做到这一点，但我认为这不是任务的目标；-]

* * *

**回应编辑1：**

*   您的`If`陈述需要在某种循环（`For`, `For Each`,`Do`等） 内**我认为这是您缺少的关键概念。**
*   而不是比较`LongName.Length`to `LengthOfLongestName`，您需要将数组中条目的长度与`LengthOfLongestName`
*   你在正确的轨道上`Members(0).Name.Length`，但你不能只检查 element `0`; 您必须检查数组中的每个元素。
*   鉴于您当前的代码，您可能会分配`<An entry in your array>.Name`给`LongName`
*   一维数组中的最后一个索引是`<array>.Length - 1`or `<array>.GetUpperBound(0)`。

以下内容并没有真正解决您的作业中的任何问题，但我希望它能给您一些关于如何浏览列表中所有项目的想法：

```
' A For loop that does a message box for each of the numbers from 0 to 5 '
For i as Integer = 0 To 5
   MessageBox.Show(i)
Next i

' Code that does a message box with the names of the 2nd, 3rd and last '
' entries in Members '
' (Remember that the first item is at 0, the second item is at 1, etc...) '
MessageBox.Show(Members(1).Name)
MessageBox.Show(Members(2).Name)
MessageBox.Show(Members(Members.GetUpperBound()).Name) 
```

* * *

**作为对编辑 2 的回应：**

你越来越热了...

*   你应该只更新`LongName`，`LengthOfLongName`如果当前值是你迄今为止看到的最长的（即它们应该在`If`语句内部分配）
*   您必须转到数组的最后一个索引，而不是 5。有关如何获取最后一个索引，请参见上文（对您的第一次编辑的响应）。
*   你真的不需要这个`UltimateName`变量；你可以使用`LongName`;-]
*   您可能希望使用`<stringVariable>.Length`而不是`Len(<stringVariable>)`保持一致。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T23:09:49.923

您缺少的是一个检查每个成员的循环，并将 If 语句放入其中并使其将名称的长度与您迄今为止找到的最长名称进行比较。如果名称较长，则将其放入找到的最长的变量中，并更新长度变量。

您可以使用第一个成员的名称初始化变量并从第二个成员循环，或者您可以使用空字符串初始化变量并循环所有成员。我个人更喜欢后一种。

# image - 如何使用 Image 模块将图像远程上传到 Drupal？

> ID：683861
> 
> 赞同：0
> 
> 时间：2009-03-25T23:00:28.730
> 
> 标签：image, drupal, module

图像可以通过 Drupal 的前端接口与 Image 模块上传。但是，我希望能够通过请求 URL 并将图像作为参数传递来远程上传和创建图像节点。我有 REST API 模块，它工作正常，但我不知道我需要在后端调用什么函数来创建图像节点。有谁知道如何做到这一点，或者是否有另一个模块可以做这样的事情？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-28T22:51:45.450

Gallerix 模块允许您打开“存储库模式”，这将使任何上传到 FTP 文件夹的图像都可以包含在其图像库中。从那里使用 Drupal 6 触发器和操作来发布仅包含该图像的节点将是一个简单的步骤。

# windows - 如何在 64 位 Vista SP1 上禁用驱动程序签名

> ID：683862
> 
> 赞同：1
> 
> 时间：2009-03-25T23:00:42.800
> 
> 标签：windows

我正在测试尚未获得 WHQL 认证的驱动程序。所以我需要在安装驱动程序之前禁用驱动程序签名。有谁知道如何通过命令行或其他程序在 Vista XP1 64 位版本上禁用此功能？我不想每次系统启动时都按 F8 来禁用驱动程序签名。

正如一些博客文章中提到的，我尝试了以下方法：

```
bcdedit /set loadoptions DDISABLE_INTEGRITY_CHECKS
bcdedit /set nointegritychecks ON 
```

他们可能正在开发 vanilla vista，但他们似乎对 vista SP1 禁用驱动程序签名没有任何影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T23:03:16.523

我相信 F8 是在 Vista 64 SP1 中禁用驱动程序签名的唯一方法。驱动程序签名旨在增强系统安全性，因此没有办法轻松绕过它。

# .net - “在使用 ItemsSource 之前，项目集合必须为空。”

> ID：683863
> 
> 赞同：182
> 
> 时间：2009-03-25T23:02:11.533
> 
> 标签：.net, wpf, vb.net, entity-framework, binding

我试图让图像显示在 WPF ListView 中，其样式类似于 WrapPanel，如旧 ATC Avalon 团队文章中所述：[如何创建自定义视图](http://blogs.msdn.com/atc_avalon_team/archive/2006/04/28/585844.aspx)。

![](https://i.stack.imgur.com/IFIg5.png)

当我尝试使用 LINQ-to-Entities 查询的 ADO.NET 实体框架对象集合填充 ListView 时，出现以下异常：

**例外**

> 在使用 ItemsSource 之前，项目集合必须为空。

我的代码...

**视觉基础**

```
Private Sub Window1_Loaded(...) Handles MyBase.Loaded
    ListViewImages.ItemsSource = From g In db.Graphic _
                                 Order By g.DateAdded Ascending _
                                 Select g
End Sub 
```

**XAML**

```
<ListView Name="ListViewImages"
          SelectionMode="Single"
          ItemsSource="{Binding}">
    <local:ImageView />
</ListView> 
```

我在那条线上放了一个断点。 `ListViewImages.ItemsSource`就`Nothing`在 LINQ 分配之前。

* * *

## 回答 #1

> 赞同：197
> 
> 时间：2009-08-07T01:26:48.347

在稍微不同的情况下，我有一段时间遇到同样的错误。原因是无效的 XAML，因为缺少某些标记。

我有

```
<wpftoolkit:DataGrid
    AutoGenerateColumns="False"
    ItemsSource="{Binding Path=Accounts}" >
    <wpftoolkit:DataGridTextColumn 
        Header="Account Name" 
        Binding="{Binding Path=AccountName}" />
</wpftoolkit:DataGrid> 
```

我固定为

```
<wpftoolkit:DataGrid
    AutoGenerateColumns="False"
    ItemsSource="{Binding Path=Accounts}" >
    <wpftoolkit:DataGrid.Columns>
        <wpftoolkit:DataGridTextColumn 
            Header="Account Name" 
            Binding="{Binding Path=AccountName}" />
    </wpftoolkit:DataGrid.Columns>
</wpftoolkit:DataGrid> 
```

* * *

## 回答 #2

> 赞同：129
> 
> 时间：2009-03-25T23:33:54.747

引发此特定异常的原因是元素的内容被应用于 ListView 的 Items 集合。`local:ImageView`因此，XAML 使用其`Items`集合中的单个初始化 ListView 。但是在使用 ItemsControl 时，您必须使用`Items`属性或`ItemsSource`属性，不能同时使用两者。因此，在处理 ItemsSource 属性时会引发异常。

您可以通过查找类上的 ContentPropertyAttribute 来找出元素的内容将应用于哪个属性。在这种情况下，它在类层次结构中更高的 ItemsControl 上[定义：](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.aspx)

```
[ContentPropertyAttribute("Items")] 
```

这里的目的是将 ListView 的 View 设置为 local:ImageView，因此解决方法是明确指示要设置的属性。

修复 XAML，异常消失：

```
<ListView Name="ListViewImages"
          SelectionMode="Single"
          ItemsSource="{Binding}">
    <ListView.View>
        <local:ImageView />
    </ListView.View>
</ListView> 
```

它缺少那个`<ListView.View>`标签。

* * *

## 回答 #3

> 赞同：74
> 
> 时间：2011-05-21T19:45:47.217

我刚刚遇到了这个问题的一个非常阴险的例子。我的原始片段要复杂得多，因此很难看到错误。

```
 <ItemsControl           
      Foreground="Black"  Background="White" Grid.IsSharedSizingScope="True"
      x:Name="MyGrid" ItemsSource="{Binding}">
      >
      <ItemsControl.ItemsPanel>
           <!-- All is fine here -->
      </ItemsControl.ItemsPanel>
      <ItemsControl.ItemTemplate>
           <!-- All is fine here -->
      </ItemsControl.ItemTemplate>
      <!-- Have you caught the error yet? -->
    </ItemsControl> 
```

错误？初始开始标签后的额外**> ！**`<ItemsControl>`已`<`应用于内置的 Items 集合。稍后设置 DataContext 时，即时 crashola。因此，在调试此问题时，要注意的不仅仅是围绕您的 ItemsControl 特定数据子项的错误。

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2010-01-19T23:10:18.167

我也在不同的情况下。

```
<ComboBox Cursor="Hand" DataContext="{Binding}"  
              FontSize="16" Height="27" ItemsSource="{Binding}" 
              Name="cbxDamnCombo" SelectedIndex="0" SelectedValuePath="MemberId">

        <DataTemplate>
            <TextBlock DataContext="{Binding}">
                <TextBlock.Text>
                  <MultiBinding StringFormat="{}{0} / {1}">
                    <Binding Path="MemberName"/>
                    <Binding Path="Phone"/>
                  </MultiBinding>
                </TextBlock.Text>
            </TextBlock>
        </DataTemplate>

</ComboBox> 
```

现在，当您完成缺少的标签**Control.ItemTemplate**时，一切都恢复正常：

```
<ComboBox Cursor="Hand" DataContext="{Binding}"  
              FontSize="16" Height="27" ItemsSource="{Binding}" 
              Name="cbxDamnCombo" SelectedIndex="0" SelectedValuePath="MemberId">
    <ComboBox.ItemTemplate>
        <DataTemplate>
            <TextBlock DataContext="{Binding}">
                <TextBlock.Text>
                  <MultiBinding StringFormat="{}{0} / {1}">
                    <Binding Path="MemberName"/>
                    <Binding Path="Phone"/>
                  </MultiBinding>
                </TextBlock.Text>
            </TextBlock>
        </DataTemplate>
    <ComboBox.ItemTemplate>
</ComboBox> 
```

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2010-12-29T11:09:47.703

我在不同的场景中遇到了同样的错误

```
<ItemsControl ItemsSource="{Binding TableList}">
    <ItemsPanelTemplate>
        <WrapPanel Orientation="Horizontal"/>
    </ItemsPanelTemplate>
</ItemsControl> 
```

解决方案是`ItemsControl.ItemsPanel`在`ItemsPanelTemplate`

```
<ItemsControl ItemsSource="{Binding TableList}">
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <WrapPanel Orientation="Horizontal"/>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
</ItemsControl> 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2015-05-12T02:20:35.927

⚠️换个说法*⚠️*

*在 Xaml*中验证定义区域中**没有缺少父节点或不正确的节点**。

例如

## 这是失败的：

下面的子节点没有**合适的** *父*`ItemsPanelTemplate`节点：

```
<ItemsControl ItemsSource="{Binding TimeSpanChoices}">
    <ItemsPanelTemplate>
        <UniformGrid Rows="1" />
    </ItemsPanelTemplate>
    ...
</ItemsControl> 
```

## 这是有效的：

```
<ItemsControl ItemsSource="{Binding TimeSpanChoices}">
    <ItemsControl.ItemsPanel> <!-- I am the missing parent! -->
        <ItemsPanelTemplate>
            <UniformGrid Rows="1" />
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
    ...    
</ItemsControl> 
```

`<ItemsControl.ItemsPanel>`提供的^^^有一个合适的父节点。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2013-11-08T09:12:25.797

> 例外
> 
> 在使用 ItemsSource 之前，项目集合必须为空。

`ItemsSource` **当您通过不同**的来源将项目添加到时会发生此异常。因此，请确保您没有意外**遗漏标签、放错标签、添加额外标签或误写标签。**

```
<!--Right-->

<ItemsControl ItemsSource="{Binding MyItems}">
     <ItemsControl.ItemsPanel.../>
     <ItemsControl.MyAttachedProperty.../>
     <FrameworkElement.ActualWidth.../>
</ItemsControl>

<!--WRONG-->

<ItemsControl ItemsSource="{Binding MyItems}">
     <Grid.../>
     <Button.../>
     <DataTemplate.../>
     <Heigth.../>
</ItemsControl> 
```

* * *

虽然`ItemsControl.ItemsSource`已通过 设置`Binding`，但无法将其他项目（网格、按钮、...）添加到源中。但是，虽然`ItemsSource`未**使用，但****允许**使用以下代码：

```
<!--Right-->
<ItemsControl>
     <Button.../>
     <TextBlock.../>
     <sys:String.../>
</ItemsControl> 
```

注意缺失的`ItemsSource="{Binding MyItems}"`部分。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2012-10-11T04:00:53.300

将模板列保留在 DataGrid.Columns 中。这帮助我解决了这个问题。

参考：[DataGridTemplateColumn：在使用 ItemsSource 之前，Items 集合必须为空。](https://stackoverflow.com/questions/6882306/datagridtemplatecolumn-items-collection-must-be-empty-before-using-itemssource)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2010-03-14T04:24:25.307

在我的例子中，它只是 ListView 中的一个额外的 StackPanel：

```
<ListView Name="_details" Margin="50,0,50,0">
            <StackPanel Orientation="Vertical">
                <StackPanel Orientation="Vertical">
                    <TextBlock Text="{Binding Location.LicenseName, StringFormat='Location: {0}'}"/>
                    <TextBlock Text="{Binding Ticket.Employee.s_name, StringFormat='Served by: {0}'}"/>
                    <TextBlock Text="{Binding Ticket.dt_create_time, StringFormat='Started at: {0}'}"/>
                    <Line StrokeThickness="2" Stroke="Gray" Stretch="Fill" Margin="0,5,0,5" />
                    <ItemsControl ItemsSource="{Binding Items}"/>
                </StackPanel>
            </StackPanel>
        </ListView> 
```

变成：

```
<ListView Name="_details" Margin="50,0,50,0">
                <StackPanel Orientation="Vertical">
                    <TextBlock Text="{Binding Location.LicenseName, StringFormat='Location: {0}'}"/>
                    <TextBlock Text="{Binding Ticket.Employee.s_name, StringFormat='Served by: {0}'}"/>
                    <TextBlock Text="{Binding Ticket.dt_create_time, StringFormat='Started at: {0}'}"/>
                    <Line StrokeThickness="2" Stroke="Gray" Stretch="Fill" Margin="0,5,0,5" />
                    <ItemsControl ItemsSource="{Binding Items}"/>
                </StackPanel>
        </ListView> 
```

一切都很好。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2011-12-16T19:29:41.367

就我而言，它没有为 ItemsControl 使用 DataTemplate。

老的：

```
<ItemsControl Width="243" ItemsSource="{Binding List, Mode=TwoWay}">
    <StackPanel Orientation="Horizontal">
        <TextBox Width="25" Margin="0,0,5,0" Text="{Binding Path=Property1}"/>
        <Label Content="{Binding Path=Property2}"/>
    </StackPanel>
</ItemsControl> 
```

新的：

```
<ItemsControl Width="243" ItemsSource="{Binding List, Mode=TwoWay}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal">
                <TextBox Width="25" Margin="0,0,5,0" Text="{Binding Path=Property1}"/>
                <Label Content="{Binding Path=Property2}"/>
            </StackPanel>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-09-14T18:26:55.463

我的是数据网格样式。如果您忽略 `<DataGrid.RowStyle>`样式周围的标签，您会遇到问题。奇怪的是它像那样工作了一段时间。这是错误的代码。

```
 <DataGrid Name="DicsountScheduleItemsDataGrid"
                  Grid.Column="0"
                  Grid.Row="2"
                  AutoGenerateColumns="false"
                  ItemsSource="{Binding DiscountScheduleItems, Mode=OneWay}">
            <Style TargetType="DataGridRow">
                <Setter Property="IsSelected"
                        Value="{Binding IsSelected, Mode=TwoWay}" />
            </Style> 
```

和好的

```
 <DataGrid Name="DicsountScheduleItemsDataGrid"
                  Grid.Column="0"
                  Grid.Row="2"
                  AutoGenerateColumns="false"
                  ItemsSource="{Binding DiscountScheduleItems, Mode=OneWay}">
            <DataGrid.RowStyle>
            <Style TargetType="DataGridRow">
                <Setter Property="IsSelected"
                        Value="{Binding IsSelected, Mode=TwoWay}" />
            </Style>
            </DataGrid.RowStyle> 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2013-07-17T14:00:24.390

我有同样的错误。问题是在标签 </ComboBox.SelectedValue> 和 </ComboBox> 之间错误地添加了这个额外的符号“>”：

```
<ComboBox 
   ItemsSource="{Binding StatusTypes}"
   DisplayMemberPath="StatusName"
   SelectedValuePath="StatusID">
   <ComboBox.SelectedValue>
      <Binding Path="StatusID"/>
   </ComboBox.SelectedValue>
   >
</ComboBox> 
```

这是正确的代码：

```
<ComboBox 
   ItemsSource="{Binding StatusTypes}"
   DisplayMemberPath="StatusName"
   SelectedValuePath="StatusID">
   <ComboBox.SelectedValue>
      <Binding Path="StatusID"/>
   </ComboBox.SelectedValue>
</ComboBox> 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-08-22T07:34:03.870

当我尝试将上下文菜单应用到我的`TreeView`. 这些尝试最终导致了一个错误的 XAML，它以某种方式编译：

```
<TreeView Height="Auto" MinHeight="100"  ItemsSource="{Binding Path=TreeNodes, Mode=TwoWay}" 
    ContextMenu="{Binding Converter={StaticResource ContextMenuConverter}}">
    ContextMenu="">
    <TreeView.ItemContainerStyle>
    ... 
```

注意有问题的行：`ContextMenu="">`.
我不知道它为什么编译，但我认为值得一提的是这个神秘异常消息的原因。就像 Armentage 所说，仔细查看 XAML，尤其是在您最近编辑过的地方。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-12-11T17:49:22.383

我在另一种情况下遇到了这个错误。我试图直接`<TreeView>`在`<TreeView.ItemContainerStyle>`.

错误的：

```
<TreeView ItemsSource="{Binding ExampleListView}">
    <Style TargetType="{x:Type TreeViewItem}">
        <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}"/>
        <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}"/>
    </Style>
    <TreeView.ItemTemplate>
        <HierarchicalDataTemplate ItemsSource="{Binding SubItemListList}">
        ...
        </HierarchicalDataTemplate>
    </TreeView.ItemTemplate>
</TreeView> 
```

正确的：

```
<TreeView ItemsSource="{Binding ExampleListView}">
    <TreeView.ItemContainerStyle>
        <Style TargetType="TreeViewItem">
            <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}"/>
            <Setter Property="IsSelected" Value="{Binding IsSelected, Mode=TwoWay}"/>
        </Style>
    </TreeView.ItemContainerStyle>
    <TreeView.ItemTemplate>
        <HierarchicalDataTemplate ItemsSource="{Binding SubItemListList}">
        ...
        </HierarchicalDataTemplate>
    </TreeView.ItemTemplate>
</TreeView> 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2020-04-16T14:55:12.777

我遇到了这个问题，因为`<ListView.View>`我的 XAML 中缺少一个特定级别的标记。

此代码产生此错误。

```
<Grid>
    <ListView Margin="10" Name="lvDataBinding" >
        <GridView>
            <GridViewColumn Header="Name" Width="120" DisplayMemberBinding="{Binding Name}" />
            <GridViewColumn Header="Age" Width="50" DisplayMemberBinding="{Binding Age}" />
            <GridViewColumn Header="Mail" Width="150" DisplayMemberBinding="{Binding Mail}" />
        </GridView>
    </ListView>
</Grid> 
```

以下修复了它

```
<Grid>
    <ListView Margin="10" Name="lvDataBinding" >
        <ListView.View> <!-- This was missing in top! -->
            <GridView>
                <GridViewColumn Header="Name" Width="120" DisplayMemberBinding="{Binding Name}" />
                <GridViewColumn Header="Age" Width="50" DisplayMemberBinding="{Binding Age}" />
                <GridViewColumn Header="Mail" Width="150" DisplayMemberBinding="{Binding Mail}" />
            </GridView>
        </ListView.View>
    </ListView>
</Grid> 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-03-31T19:42:53.020

也许不是一个有用的答案，但我在更改列顺序时遇到了同样的问题，并且犯了如下示例中的错误。有很多列，我对它们进行了重新排序，并以某种方式在结束标记后粘贴了一个`/DataGrid.Columns`：

```
 <DataGridTemplateColumn x:Name="addedDateColumn" Header="Added Date" Width="SizeToHeader">
                <DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Path=AddedDate}" />
                    </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
        </DataGrid.Columns>
            <DataGridTemplateColumn x:Name="rowguidColumn" Header="rowguid" Width="SizeToHeader">
                <DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Path=rowguid}" />
                    </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
    </DataGrid> 
```

反正就因为这个，耽误了半个小时。希望这对其他人有帮助。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-02-10T15:54:38.860

当心错别字！我有以下

```
<TreeView ItemsSource="{Binding MyCollection}">
    <TreeView.Resources>
        ...
    </TreeView.Resouces>>
</TreeView> 
```

（注意拖尾**>**，它被解释为内容，所以你设置了两倍的内容......花了我一段时间：）

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-02-28T11:58:42.093

我有同样的错误。
就我而言，我只是删除了一行`<UniformGrid Columns="3" />`

```
<ListBox>
    <UniformGrid Columns="3" /> // remove this line!!!!
    ...
</ListBox> 
```

# php - 我可以使用 PECL 安装 memcached PHP 扩展吗？

> ID：683864
> 
> 赞同：11
> 
> 时间：2009-03-25T23:02:14.327
> 
> 标签：php, macos, memcached, pecl

我在从 PECL安装“ [memcached ”PHP 扩展时遇到问题，尽管我可以成功安装“](http://pecl.php.net/package/memcached) [memcache](http://pecl.php.net/package/memcache) ”扩展。（它们是单独的 PHP 扩展。）

例如，这些命令可以正常工作：

> $ sudo pecl 安装内存缓存
> $ sudo pecl 安装 APC
> $ sudo pecl 安装 oauth

但是，尝试安装 memcached 会导致错误：

> $ sudo pecl install memcached
> ...
> ld: library not found for -lmemcached
> collect2: ld returned 1 exit status
> make: *** [memcached.la] Error 1
> ERROR: `make' failed

我在最近的英特尔 Mac 上使用来自 Mac Ports (macports.org) 的 pecl、memcached 和 libmemcached。libmemcached 库可以在 /opt/local 中找到：

> /opt/local/include/libmemcached
> /opt/local/include/libmemcached/libmemcached_config.h
> /opt/local/lib/libmemcached.2.0.0.dylib
> /opt/local/lib/libmemcached.2.dylib
> /opt/local /lib/libmemcached.a
> /opt/local/lib/libmemcached.dylib
> /opt/local/lib/libmemcached.la

知道我可能做错了什么吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-30T14:52:00.610

Andrei Zmievski（memcached 插件的开发者）回复了我的电子邮件请求，并提供了以下说明：

```
$ pecl download memcached
$ tar zxvf memcached-1.0.0.tgz (or whatever version downloads)
$ cd memcached-1.0.0
$ phpize
$ ./configure --with-libmemcached-dir=/opt/local
$ make
$ sudo make install 
```

这非常有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T12:17:43.540

如您所见，新的 memcached 扩展使用 libmemcached 来完成繁重的工作。如果是 Linux，我会说您可能没有在 ld.so.conf 中列出 /opt/local/lib/（并运行“ldconfig”）。

MaxOSX 不使用它。但是，它显然可以从“端口”安装。[http://lsimons.wordpress.com/2008/05/01/serious-php-part-1/](http://lsimons.wordpress.com/2008/05/01/serious-php-part-1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-17T07:56:02.190

这里的情况相同。我必须执行上述操作，但使用明确的路径名（我在 /opt/local 之外运行我的 php 等）

*   **/opt/local/bin** /pecl 下载 memcached
*   tar zxvf memcached-1.0.0.tgz
*   cd memcached-1.0.0
*   **/opt/local/bin** /phpize
*   ./configure **--prefix=/opt/local --with-php-config=/opt/local/bin/php-config** --with-libmemcached-dir=/opt/local
*   制作
*   进行安装

通常这种东西在带有macports的os x上非常简单，但是还没有php5-memcached包（只有一个用于较旧的memcache（没有“d”）包）。哦，我还必须安装旧版本的 libmemcached，因为最新版本没有在我的 os x 10.5.8 上编译。哦！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-23T14:50:26.107

好吧，经过多次尝试，只有这个解决方案对我有用。

1.  安装 XAMPP
2.  安装 brew ( [https://github.com/Homebrew/homebrew/wiki/Installation](https://github.com/Homebrew/homebrew/wiki/Installation) )
3.  $酿造
4.  安装 libmemcached
5.  cd /Applications/XAMPP/xamppfiles/bin/
6.  $ sudo ./pecl 安装 memcached

> 构建过程成功完成安装“/Applications/XAMPP/xamppfiles/lib/php/extensions/no-debug-non-zts-20121212/memcached.so”安装正常：channel://pecl.php.net/memcached-2.2。 0 配置选项“php_ini”未设置为 php.ini 位置您应该将“extension=memcached.so”添加到 php.ini

瞧！

# wcf - 什么是好的 WCF/Web 服务安全读物？

> ID：683865
> 
> 赞同：5
> 
> 时间：2009-03-25T23:02:23.590
> 
> 标签：wcf, web-services, security

我最近一直在做很多与 WCF、Web 服务和分布式计算相关的研究和工作，但大多数安全概念都让我头疼。传输安全、消息安全、加密、证书等。我了解对称和非对称加密的基础知识，但我并不真正了解它们在 SOAP 对话中的实际应用。

我读过规格，但它们似乎有点密集。谁能指出我从基础开始并从那里开始工作的资源？我很想从我在大学的网络课程中找出教科书，以更好地了解最低级别发生的事情，但我不知道这是否非常低效。我宁愿不必阅读一个装满东西的小型图书馆——我只想深入了解这些概念，并能够向我桌上的橡皮鸭解释它们。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-28T09:34:13.323

**编辑**：

自从我第一次写答案以来已经有好几年了，而且这个列表已经变老了。已经广泛采用了支持 Web 的 API 和基于令牌的信任中继。

我还没有阅读它，但如果您正在寻找 WCF 特定的内容， [Windows Communication Foundation Security将是一个不错的起点。](http://msdn.microsoft.com/en-us/library/ms732362.aspx)

还要留意[Facebook](http://developers.facebook.com/docs/authentication/)、[Google](http://code.google.com/apis/accounts/docs/GettingStarted.html)和[Twitter](http://dev.twitter.com/pages/auth)等主要参与者正在做的事情。他们使用[OpenID](http://openid.net/)和[OAuth](http://oauth.net/)等开放协议。起初，OAuth 看起来很复杂，但您应该了解其中的机制。

在我看来，早期的 OAuth 重新发明了 SSL 已经解决的许多轮子，并留下了一些安全漏洞。一个有趣的读物是[妥协 Twitter 的 OAuth 安全系统](http://arstechnica.com/security/guides/2010/09/twitter-a-case-study-on-how-to-do-oauth-wrong.ars/)。[Facebook 的 OAuth 2.0 实施](http://developers.facebook.com/docs/authentication/)和[Google 的 OAuth 2.0 实施](http://code.google.com/apis/accounts/docs/OAuth2.html)通过在有意义的地方使用 https 来简化许多这些问题。这些是必读。

![在此处输入图像描述](https://i.stack.imgur.com/HKq4Y.png)

OAuth 的基本概念是信任中继。您可能希望第三方开发人员针对您的 API 开发应用程序，但最终用户并不总是信任这些应用程序。给他们密码，就像给了王国的钥匙。因此，用户在您的 UI 中输入密码，您的 UI 将使用访问令牌重定向到第三方。

* * *

[构建安全的 ASP.NET 应用程序：身份验证、授权和安全通信](http://msdn.microsoft.com/en-us/library/aa302415.aspx)是对 ASP.NET 安全模型的一个很好的介绍。你可以跳过细节，因为很多技术现在已经过时了。

Web Service的一个很好的概述是[Web Service Security: Scenarios, Patterns, and Implementation Guidance for Web Services Enhancements (WSE) 3.0](http://msdn.microsoft.com/en-us/library/aa480545.aspx)。它说 WSE，但基本概念仍然保持不变。

要获取有关 WS-Security 的更多详细信息，请阅读[使用 WS-Security 保护 Web 服务：揭秘 WS-Security、WS-Policy、SAML、XML 签名和 XML 加密](https://rads.stackoverflow.com/amzn/click/com/0672326515)。

[![使用 WS-Security 保护 Web 服务](https://i.stack.imgur.com/r1we6.jpg)](https://i.stack.imgur.com/r1we6.jpg)

阅读上述内容后，真正帮助我的是查看现有实现，例如[Amazon S3 的身份验证](http://docs.amazonwebservices.com/AmazonS3/2006-03-01/index.html?S3_Authentication.html)：

[Amazon S3 的身份验证 http://docs.amazonwebservices.com/AmazonS3/2006-03-01/images/HMACAuthProcess_You.gif](http://docs.amazonwebservices.com/AmazonS3/2006-03-01/images/HMACAuthProcess_You.gif)

[Flickr 身份验证 API](http://www.flickr.com/services/api/auth.spec.html)：

> 每个身份验证 frob 都特定于用户和应用程序的 api 密钥，并且只能与该密钥一起使用。
> 
> 身份验证 frobs 从创建之日起 60 分钟内有效，或直到应用程序调用 flickr.auth.getToken，以较早者为准。
> 
> 每个用户的每个应用程序只有一次身份验证在任何时候有效。应用程序必须处理过期和无效的身份验证frobe，并知道如何更新它们。

[推特 REST API](http://apiwiki.twitter.com/REST+API+Documentation)

> 许多 Twitter API 方法需要身份验证。所有响应都与身份验证用户的上下文相关。例如，尝试检索与请求用户不是朋友的受保护用户的信息将失败。
> 
> 目前，HTTP 基本身份验证是唯一受支持的身份验证方案。通过 Basic Auth 进行身份验证时，请使用您注册的用户名或电子邮件地址作为用户名组件。会话 cookie 和基于参数的登录已知可以工作，但不受官方支持。
> 
> 基于 OAuth 令牌的身份验证方案将很快作为实验性 beta 版本提供。

所以很高兴知道复杂的证书和 PKI 的东西，但世界似乎没有它就可以正常运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T05:20:40.647

此外，还有 Microsoft 的 Patterns & Practices 小组的[WCF 安全指南](http://www.codeplex.com/WCFSecurity)。看看这个。

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T04:17:19.933

从在维基百科中搜索公钥基础设施 (PKI) 开始，然后按照链接了解不同的部分。您不需要知道各种密码的加密算法，但如果您想真正了解 WCF 如何使用它，则需要了解这些概念。

# .net - 如何创建屏幕抓取？“我只想知道周期”

> ID：683866
> 
> 赞同：0
> 
> 时间：2009-03-25T23:02:37.023
> 
> 标签：.net, asp.net, javascript, html

我想制作一个屏幕抓取与此完全相同的想法[http://www.vimeo.com/1626505](http://www.vimeo.com/1626505)我想知道的是如何做到这一点？- 当用户单击书签时，它会将 URL 发送到我的服务器，然后我的服务器将返回客户端页面，其中包含将与 iframe 加载一起加载的报废 javascript 文件，java 脚本将报废当前数据页面并放在 iframe 上。

**或者** - Bookmarklet 将只向我的服务器发送 URL，我的服务器将使用 .Net 代码打开 URL 并将其废弃，从中获取所需的数据，然后将填充了正确数据的 iframe 发送给客户端。

哪个是对的？还是有另一种方法？为什么它不是另一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T23:10:09.017

我不知道它是否和 Vimeo 中的一样，但这是一个使用 C# 的简单服务器端实现：

```
 WebRequest wrContent = WebRequest.Create("http://www.site.com/yourtargetpage.html");
 Stream objStream = wrContent.GetResponse().GetResponseStream();
 StreamReader objStreamReader = new StreamReader(objStream);
 Content = objStreamReader.ReadToEnd();
 DataBind(); 
```

“内容”是在页面类的头部声明的字符串变量：

```
 protected string Content; 
```

将其放置在您希望内容出现的 ASPX 页面中：

```
 <%# Content %> 
```

这很容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T23:18:28.297

**客户端**

*优点*

页面已经加载在那里
用JS通过DOM解析相对容易

*缺点*

JS开启了吗？
用户的机器有多快？
如果用户在中途浏览了会发生什么？

**服务器端**

*优点*

比 JS
页面嗅探更多的控制（我假设）应该很快

*缺点*

页面被命中两次（网络流量增加）
您的服务器实际上必须解析/处理页面（它如何扩展？）

真的想不起来了（我敢肯定我错过了很多）。底线是，它是衡量您的客户端/服务器端技能与带宽和服务器负载考虑因素之间的关系。

# java - 如何重新打包 Java Web 存档 (WAR)？

> ID：683885
> 
> 赞同：0
> 
> 时间：2009-03-25T23:08:28.820
> 
> 标签：java, jar, war

我有一个应用程序的 .war 文件。它有效，但我需要更新一些内部 jars *（只有较小的版本更改）*

虽然我可以使用午夜指挥官对 .war 档案进行操作，但这些文件无法再执行： `java.lang.SecurityException: SHA1 digest error`.

我尝试使用 jar 命令重新打包它，但我弄错了：存档包含新的 META-INF，并且没有 WEB-INF（这是必需的）。

感谢您提出的解决方案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T23:15:51.187

名称应该是`META-INF`and `WEB-INF`，没有“O”。

您是否正在修改 jar 文件`WEB-INF/libs`？因为听起来您已经篡改了已签名的存档，而且通常战争本身是未签名的。

如果您更改签名的 jar 文件，则签名将失效。使用您的代码签名密钥重新签署代码，或从 META-INF 中删除无效的签名信息。

# linux - 如何修复此虚拟主机设置？

> ID：683891
> 
> 赞同：1
> 
> 时间：2009-03-25T23:10:40.733
> 
> 标签：linux, apache, http, centos

我在运行 apache 2 的 centos 服务器上设置了 2 个虚拟主机，它们共享相同的 IP。

```
#<VirtualHost *:80>
#    ServerAdmin webmaster@dummy-host.example.com
#    DocumentRoot /www/docs/dummy-host.example.com
#    ServerName dummy-host.example.com
#    ErrorLog logs/dummy-host.example.com-error_log
#    CustomLog logs/dummy-host.example.com-access_log common
#</VirtualHost>

<VirtualHost *:80>
    DocumentRoot /var/www/a
    ServerName www.a.com
    ServerAlias a.com
</VirtualHost>

<VirtualHost *:80>
    DocumentRoot /var/www/b
    ServerName www.b.com
    ServerAlias b.com
</VirtualHost> 
```

无论我指向哪个 URL。站点 A 出现。

我该如何解决？我应该有 a.com 去 a 和 b.com 去 b。

谢谢大家

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T23:16:36.427

您的 httpd.conf 中是否设置了以下内容？

```
NameVirtualHost * 
```

[文档](http://httpd.apache.org/docs/1.3/vhosts/name-based.html)中的一个示例：

```
NameVirtualHost *

<VirtualHost *>
ServerName www.domain.tld
DocumentRoot /www/domain
</VirtualHost>

<VirtualHost *>
ServerName www.otherdomain.tld
DocumentRoot /www/otherdomain
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T23:18:17.750

确保你也有这个指令

名称虚拟主机 *

它可能正在显示站点 A，因为它被设置为默认文档根目录。检查您的全局设置，确保文档根目录未设置为与站点 A 相同的根目录。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T23:36:11.543

我一直将域声明为名称..从来没有问题。

```
NameVirtualHost localhost:80

<VirtualHost localhost:80>
DocumentRoot "/home/eddie/workspace/"
</VirtualHost>

<VirtualHost digbiz.localhost:80>
DocumentRoot "/home/eddie/workspace/Digital_Business/app/webroot"
</VirtualHost>

<VirtualHost wishlist.localhost:80>
DocumentRoot "/home/eddie/workspace/WishList/app/webroot"
</VirtualHost>

<VirtualHost phpmyadmin.localhost:80>
DocumentRoot "/srv/www/phpMyAdmin"
</VirtualHost>

<VirtualHost test.localhost:80>
DocumentRoot "/home/eddie/workspace/CakePHPTesting/app/webroot"
</VirtualHost>

<VirtualHost auth.localhost:80>
DocumentRoot "/home/eddie/workspace/EntMeetCapt/app/webroot"
</VirtualHost> 
```

# c# - 有什么方法可以在 C# 中创建隐藏的主窗口？

> ID：683896
> 
> 赞同：24
> 
> 时间：2009-03-25T23:12:29.777
> 
> 标签：c#, winforms

我只想要一个带有隐藏主窗口的 ac# 应用程序，它将处理和响应窗口消息。

我可以在不显示的情况下创建一个表单，然后可以在不传递表单的情况下调用 Application.Run()，但是如何将创建的表单挂钩到消息循环中？

还有其他方法可以解决这个问题吗？

提前感谢您的任何提示！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-25T23:52:12.583

优秀的！该链接为我指明了正确的方向。这似乎有效：

```
 Form f = new Form1();
        f.FormBorderStyle = FormBorderStyle.FixedToolWindow;
        f.ShowInTaskbar = false;
        f.StartPosition = FormStartPosition.Manual;
        f.Location = new System.Drawing.Point(-2000, -2000);
        f.Size = new System.Drawing.Size(1, 1);
        Application.Run(f); 
```

为了防止它出现在 Alt-Tab 中，您需要将它作为一个工具窗口。不幸的是，这会阻止它开始最小化。但是将起始位置设置为手动并将其定位在屏幕外就可以了！

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-01-16T17:17:52.283

在重写一个VC++ TaskTray App的过程中，在C# .NET中，我发现下面的方法确实可以实现以下目标。

1.  启动时没有显示初始形式
2.  运行可以根据需要与 Invoke/BeginInvoke 一起使用的消息循环，因为**IsWindowHandle**为 true

我遵循的步骤：

1.  在 Application.Run() 中使用了 ApplicationContext 而不是表单。有关我使用的示例，请参见[http://www.codeproject.com/Articles/18683/Creating-a-Tasktray-Application](http://www.codeproject.com/Articles/18683/Creating-a-Tasktray-Application)。
2.  在 GUI 设计器中将表单的**ShowInTaskbar属性设置为 true。**（这似乎适得其反，但它有效）
3.  将 Form Class 设置**Visible**和**ShowInTaskbar中的****OnLoad()**方法覆盖为 false，如下所示。

 ****> ```
> protected override void OnLoad(EventArgs e)
>     {
>         Visible = false; 
>         ShowInTaskbar = false; 
>         base.OnLoad(e);
>     } 
> ```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2011-02-06T13:29:20.037

我知道这是个老问题，但它在谷歌中排名很好，所以无论如何我都会提供我的解决方案。

我做两件事：

```
private void Form_Load(object sender, EventArgs e)
{
    Opacity = 0;
}

private void Form_Shown(object sender, EventArgs e)
{
    Visible = false;
    Opacity = 100;
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-05T15:42:39.247

最好的方法是在构造函数中使用以下 1-2 行：

```
this.WindowState = FormWindowState.Minimized;
this.ShowInTaskbar = false; // This is optional 
```

您甚至可以在 VS 属性窗口中设置最小化属性。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-25T23:58:20.603

您可以创建一个继承自的类`System.Windows.Forms.NativeWindow`（它提供基本的消息循环功能）并`Handle`在其构造函数中引用该属性以创建其句柄并将其挂接到消息循环中。一旦您调用`Application.Run`，您将能够处理来自它的消息。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-04-18T20:22:28.700

我解决了这样的问题：

```
[STAThread]
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    Main main = new Main();
    Application.Run();
    //Application.Run(new Main());
} 
```

此代码位于 Program.cs 文件中，您可以看到原始的 Application.Run 方法调用已被注释掉。我只是创建了一个 Main 类对象（我的主窗体类名为 Main）并启动应用程序消息循环而不带任何参数。这将启动应用程序，初始化任何表单组件但不显示表单。

注意：你必须有一些方法来显示你的窗口（比如系统托盘图标、热键或计时器或任何你可能喜欢的东西）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-15T15:00:09.350

```
public partial class Form1 : Form
{
    private bool _isApplicationRun;

    public Form1(bool applicationRun)
    {
        InitializeComponent();
        _isApplicationRun = applicationRun;
    }

    protected override void SetVisibleCore(bool value)
    {
        if (_isApplicationRun)
        {
            _isApplicationRun = false;

            base.SetVisibleCore(false);
            return;
        }

        base.SetVisibleCore(value);
    }
}

static class Program
{

    [STAThread]
    static void Main()
    {

        Application.Run(new Form1(true));
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-25T23:20:25.513

为什么你打电话时不能直接传递表格`Application.Run`？鉴于这显然是一个阻塞调用，你想在什么事件上显示表单？只需调用`form.Show()`就足够了。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-05T23:19:17.023

以 Kami 的回答为灵感，我创造了一个更完整的概念。如果您使用此解决方案，请不要显示隐藏窗口。如果这样做，用户可能会关闭它，然后您就失去了以有序方式控制应用程序退出的能力。此方法可用于管理 Timer、NotifyIcon 或任何其他乐于生活在不可见表单上的组件。

```
using System;
using System.Windows.Forms;

namespace SimpleHiddenWinform
{
    internal class HiddenForm : Form
    {
        private Timer _timer;
        private ApplicationContext _ctx;

        public HiddenForm(ApplicationContext ctx)
        {
            _ctx = ctx;
            _timer = new Timer()
            {
                Interval = 5000, //5 second delay
                Enabled = true
            };
            _timer.Tick += new EventHandler(_timer_Tick);
        }

        void _timer_Tick(object sender, EventArgs e)
        {
            //tell the main message loop to quit
            _ctx.ExitThread();
        }
    }

    static class Program
    {
        [STAThread]
        static void Main()
        {
            var ctx = new ApplicationContext();
            var frmHidden = new HiddenForm(ctx);
            //pass the application context, not the form
            Application.Run(ctx);
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-03-09T05:14:17.160

```
Form1 f1=new Form1();
f1.WindowState = FormWindowState.Minimized;
f1.ShowInTaskbar = false; 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-03-25T23:18:36.610

在 Form1 代码文件中添加 this.Visible = false; 给构造函数。

这将隐藏窗口，但它会在隐藏之前闪烁几秒钟。或者，您可以编写自己的 Application.Run 命令。

更多信息[http://social.msdn.microsoft.com/forums/en-US/winforms/thread/dece45c8-9076-497e-9414-8cd9b34f572f/](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/dece45c8-9076-497e-9414-8cd9b34f572f/)

您也可能希望将 this.ShowInTaskbar 设置为 false。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-03-25T23:18:41.273

您应该考虑创建一个“服务”，因为这是一个没有表单的应用程序。请参阅[http://support.microsoft.com/kb/816169](http://support.microsoft.com/kb/816169)

# c# - 将页面转换为用户控件

> ID：683899
> 
> 赞同：2
> 
> 时间：2009-03-25T23:14:26.807
> 
> 标签：c#, .net, asp.net, user-controls, user-interface

如果我们想将 Page 转换为用户控件，那么我们还应该执行以下操作：

“如果您不使用代码隐藏模型，请确保您仍然通过提供 ClassName 属性在 Control 指令中包含类名。这样，使用该控件的网页可以是强类型的，这允许它访问您添加到该控件的属性和方法。”</p>

我不确定我是否理解上面的引用：

也就是说，如果我们不使用类后面的代码，那么 ascx 类将直接派生自 UserControl 类！因此，如果我们不使用类后面的代码，那么就不会有任何方法或属性添加到控件中，那么为什么网页会在访问任何用户控件的属性和方法时出现问题呢？那么为什么我们需要在 Control 指令中包含一个类名呢？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T23:24:17.953

我想我应该澄清编译模型是如何工作的。首先，您可以在单个文件中编写所有内容（包括 C# 代码），并通过指定属性（或者您可能想要省略它）而不使用属性`.ascx`从您想要的任何类（最终继承自）继承。如果这样做，您仍然可以从使用此控件的文件中访问属性。问题是，您不能直接使用页面代码隐藏文件中的类（如果有的话）。通过指定，如果您使用的是 Visual Studio 的网站项目模型，您也可以从文件中访问它。请注意，这在 Web 应用程序项目模型中不起作用，因为每个文件都将提前编译（在`UserControl``Inherits``ClassName``.aspx``.aspx``ClassName``.aspx.cs``.cs``.ascx`文件）。在那种情况下，即使是`ClassName`属性也无济于事。

在任何情况下，严格来说没有任何属性是必需的。您始终可以使用在文件中的任何位置`.ascx`或`.ascx.cs`包含在文件中的页面中定义的属性`.aspx`（但*不*总是在`.aspx.cs`文件中）。

**编辑以解决问题的更新：**

A）从您的源代码来看，您似乎在这里使用了网站模型。请注意，我提到您不能直接使用*该类*。我同意这种说法可能有点误导。我想指出的是，如果没有`ClassName`，ASP.NET 将为您的用户控件类选择一个名称，但不能保证该名称。虽然您*可以*使用生成的名称，但根本不建议这样做。您应该将其视为匿名类型，您可以在其中使用实例但不能提及名称。在您的示例中，您基本上是在引用一个实例（它是在`.aspx`标记上构造的），而不是*class*，这没关系。

B) 你说的是对的。无论您在`ascx.cs`Web 应用程序中声明什么，对 和 都是可见`.aspx.cs`的`.aspx`。我所说的是您`.ascx`在`<script runat="server">`标签中声明的属性。这些将不可见，`.aspx.cs`因为它是预先编译的。

C) ASP.NET 将`ClassName`在命名空间中生成由属性定义的类`ASP`。你应该`ASP.Some_Name`改用。我忘了提一件事：在这种情况下，您应该以某种方式`.ascx`在`.aspx`标记中引用 ；使用`Reference`指令 ( `<%@ Reference Control="MyControl.ascx" %>`) 指令或使用`Register`指令 ( `<%@ Register TagPrefix="abc" TagName="xyz" Src="MyControl.ascx" %>`)。这将确保 ASP.NET 构建引擎将生成的`.ascx`类放在与页面相同的程序集中`.aspx`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T23:40:52.580

> 如果我们不使用类后面的代码，那么就不会有任何方法或属性添加到控件中，那么为什么网页会在访问任何用户控件的属性和方法时出现问题呢？那么为什么我们需要在 Control 指令中包含一个类名

1.  您可以在 .ascx/.aspx 文件中嵌入任何代码后面的代码，在新的 asp.net mvc 模型中，默认情况下不会有任何代码后面。我认为后面的代码是可选的，它只是将一个类分成两部分的好方法。部分类用于后面的代码。
2.  即使您不使用类后面的代码，您仍然可以从基本控件继承属性。然后通过声明一个类，您也可以访问这些属性。

# regex - 文本编辑器中的正则表达式提取

> ID：683905
> 
> 赞同：4
> 
> 时间：2009-03-25T23:17:01.013
> 
> 标签：regex, user-interface, editor

我对编程有点陌生，所以如果这非常明显（这将是一个受欢迎的消息），请原谅我。

我在空闲时间使用 pregmatch 进行了大量的 PHP 开发，并使用免费（开源？）Regex Tester 编写了我的大部分表达式。

然而，我经常发现自己想简单地快速提取一些东西，而我知道的唯一方法就是写下我的表达，然后编写脚本，这可能很可笑，但欢迎来到我的现实。:-)

我想要的是一个简单的文本编辑器，我可以将我的表达式输入（给定一个文件或一个充满粘贴文本的缓冲区）并让它解析表达式并返回一个只包含结果的文档。

我发现通常是正则表达式搜索/替换函数，就像在 Notepad++ 中一样，我可以使用表达式轻松找到（并替换）所有实例，但我根本不知道如何只提取它......

这可能非常明显，表达式只能匹配逆吗？然后我可以使用类似的东西（只是我目前正在处理的表达式）：

```
<a href="/browse/0/b/-dbm/a/0-0/1200000([^/]*)/0.html">([^<]*)</a> 
```

并替换所有*不*匹配的内容。但我确信这是一些常见且简单的事情，我真的很感激任何观点。

FWIW我知道grep，我*可以*用它来做，但我希望他们是更好的gui'ified解决方案，我根本不知道。

谢谢。

扎克

* * *

我所希望的是在一套更标准的 gui 工具（即，我可能已经在使用的工具）中工作的东西。我感谢所有的回复，但我希望避免使用 perl 或 vi 或 grep，否则我会自己编写脚本（当然我这样做了），因为它们都是相对强大的低级工具。

也许我不够清楚。作为一名高级系统管理员，我对 cli 工具很熟悉，我非常喜欢它们。在家工作，但是我发现我的大部分时间都花在了 gui 上，比如 Netbeans 或 Notepad++。我只是想有一种简单的方法可以使用这些工具来实现基于正则表达式的数据提取（因为在这些情况下，我已经在使用它们了）。

有点像我所指的内容是[这样](http://www.lfmseek.com/rss/extractor.php)的，它将在第一行使用一个表达式，在第二行使用一个 url，然后提取（返回）数据。

它很难看（今晚之后我会删除它，因为它可能充满了问题）。

无论如何，感谢您的回复。我很感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T23:56:49.157

如果你想要一个具有良好正则表达式支持的文本编辑器，我强烈推荐 Vim。Vim 的正则表达式引擎[非常强大](http://www.vim.org/htmldoc/pattern.html)，并且很好地集成到了编辑器中。例如

```
:g!/regex/d 
```

这表示要删除缓冲区中与 pattern 不匹配的每一行`regex`。

```
:g/regex/s/another_regex/replacement/g 
```

这表示在匹配的每一行上`regex`，进行另一次搜索/替换以替换匹配`another_regex`的文本`replacement`。

如果您想使用命令行`grep`或 Perl/Ruby/Python/PHP 单线任何其他工具，您可以通过该工具过滤当前缓冲区的文本并更新缓冲区以反映结果：

```
:%!grep regex
:%!perl -nle 'print if /regex/' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T23:31:30.433

你试过 nregex.com 吗？

[http://www.nregex.com/nregex/default.aspx](http://www.nregex.com/nregex/default.aspx)

这里有一个 Netbeans 插件，但开发看起来停滞不前：

[http://wiki.netbeans.org/Regex](http://wiki.netbeans.org/Regex)

[http://wiki.netbeans.org/RegularExpressionsModuleProposal](http://wiki.netbeans.org/RegularExpressionsModuleProposal)

你也可以试试监管者：

[http://sourceforge.net/projects/regulator/](http://sourceforge.net/projects/regulator/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T03:35:39.300

一个好的文本编辑器可用于执行您所描述的操作。我使用 EditPadPro 进行搜索和替换功能，它还有一些其他不错的功能，包括大多数主要格式的代码着色。搜索面板功能包括一个正则表达式模式，允许您输入一个正则表达式，然后搜索第一个实例，该实例标识您的表达式是否与适当的信息匹配，然后为您提供迭代替换或所有实例替换的选项。

[http://www.editpadpro.com](http://www.editpadpro.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T23:23:39.280

大多数正则表达式引擎将允许您匹配正则表达式的反面。

通常与！操作员。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T23:42:48.067

我的建议是[grep](http://en.wikipedia.org/wiki/Grep)和[cygwin](http://www.cygwin.com/)如果你被困在 Windows 机器上。

```
echo "text" | grep <a href="/browse/0/b/-dbm/a/0-0/1200000([^/]*)/0.html">([^<]*)</a> 
```

或者

```
cat filename | grep <a href="/browse/0/b/-dbm/a/0-0/1200000([^/]*)/0.html">([^<]*)</a> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T19:29:46.687

我知道 grep 已被提及，而您不需要 cli 工具，但我认为[ack](http://betterthangrep.com/)值得一提。

> ack 是一个类似于 grep 的工具，针对拥有大量异构源代码树的程序员。
> 
> ack 纯粹用 Perl 编写，并利用了 Perl 正则表达式的强大功能。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-25T23:39:52.910

> 我想要的是一个简单的文本编辑器，我可以将我的表达式输入（给定一个文件或一个充满粘贴文本的缓冲区）并让它解析表达式并返回一个只包含结果的文档。

您刚刚描述了 grep。这正是 grep 所做的。它出什么问题了？

# proxy - 如何验证用作反向代理的 Squid 是否正常工作？

> ID：683906
> 
> 赞同：4
> 
> 时间：2009-03-25T23:17:22.930
> 
> 标签：proxy, reverse-proxy, squid

我们希望减少其中一台 Web 服务器的负载，并且正在运行一些将 squid 配置为反向代理的测试。

配置在下面的备注中：

> http_port 80 加速 defaultsite=original.server.com
> 
> cache_peer original.server.com parent 80 0 无查询 originserver name=myAccel
> 
> acl our_sites dstdomain .contentpilot.net
> 
> http_access 允许我们的站点
> 
> cache_peer_access myAccel 允许 our_sites
> 
> cache_peer_access myAccel 全部拒绝

我们遇到的情况是服务器几乎一直在返回 TCP_MISS。

```
1238022316.988     86 69.15.30.186 TCP_MISS/200 797 GET http://original.server.com/templates/site/images/topnav_givingback.gif - FIRST_UP_PARENT/myAccel -
1238022317.016     76 69.15.30.186 TCP_MISS/200 706 GET http://original.server.com/templates/site/images/topnav_diversity.gif - FIRST_UP_PARENT/myAccel -
1238022317.158     75 69.15.30.186 TCP_MISS/200 570 GET http://original.server.com/templates/site/images/topnav_careers.gif - FIRST_UP_PARENT/myAccel -
1238022317.344     75 69.15.30.186 TCP_MISS/200 2981 GET http://original.server.com/templates/site/js/home-search-personalization.js - FIRST_UP_PARENT/myAccel -
1238022317.414     85 69.15.30.186 TCP_MISS/200 400 GET http://original.server.com/templates/site/images/submenu_arrow.gif - FIRST_UP_PARENT/myAccel -
1238022317.807     75 69.15.30.186 TCP_MISS/200 2680 GET http://original.server.com/templates/site/js/homeMakeURL.js - FIRST_UP_PARENT/myAccel -
1238022318.666   1401 69.15.30.186 TCP_MISS/200 103167 GET http://original.server.com/portalresource/lookup/wosid/intelliun-2201-301/image2.jpg - FIRST_UP_PARENT/myAccel image/pjpeg
1238022319.057   1938 69.15.30.186 TCP_MISS/200 108021 GET http://original.server.com/portalresource/lookup/wosid/intelliun-2201-301/image1.jpg - FIRST_UP_PARENT/myAccel image/pjpeg
1238022319.367     83 69.15.30.186 TCP_MISS/200 870 GET http://original.server.com/templates/site/images/home_dots.gif - FIRST_UP_PARENT/myAccel -
1238022319.367     80 69.15.30.186 TCP_MISS/200 5052 GET http://original.server.com/templates/site/images/home_search.jpg - FIRST_UP_PARENT/myAccel -
1238022319.368     88 69.15.30.186 TCP_MISS/200 5144 GET http://original.server.com/templates/site/images/home_continue.jpg - FIRST_UP_PARENT/myAccel -
1238022319.368     76 69.15.30.186 TCP_MISS/200 412 GET http://original.server.com/templates/site/js/showFooterBar.js - FIRST_UP_PARENT/myAccel -
1238022319.377    100 69.15.30.186 TCP_MISS/200 399 GET http://original.server.com/templates/site/images/home_arrow.gif - FIRST_UP_PARENT/myAccel - 
```

我们已经尝试删除所有缓存内存。有任何想法吗。可能是我的网站每次都标记了一些不同的内容，即使它自代理上次请求以来没有改变？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T11:03:53.313

原始服务器（Web 服务器）将哪些标头与您的内容一起发回？为了被 squid 缓存，我相信您通常必须在响应标头中指定 Last-Modified 或 ETag。Web 服务器通常会自动为静态内容执行此操作，但如果您的内容是动态提供的（即使来自静态源），那么您必须确保它们在那里，并处理请求标头，例如 If-Modified-Since 和 If-无匹配。

另外，由于我在您随后关于会话的问题中指出了这个问题——响应中是否出现“Vary”标题？例如，“Vary: Cookie”告诉缓存内容可以根据请求中的 Cookie 标头而变化：因此静态内容希望将其删除。但是，如果存在会话，您的 Web 服务器可能会将其添加到所有请求中，而不管所提供数据的静态/动态性质如何。

根据我的经验，对 HTTP 标头进行一些实验以了解对缓存的影响是非常有益的：我记得发现解决方案并不总是显而易见的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T10:48:27.000

检查在 firefox 中使用 wireshark 或 firebug 返回的标头（后者更容易处理，但如果您最终需要，前者会为您提供更多低级信息）。

在响应标头中查找这些项目（单击“网络”视图中的项目以展开它并查看请求和响应标头）：

*   Last-Modified date -> 如果没有设置为过去的合理时间，则不会被缓存
*   Etags -> 如果每次请求相同的项目时这些更改，那么它将被重新获取
*   Cache-Control -> 来自客户端的请求 max-age=0 将（我相信）每次都请求页面的新副本
*   **(edit)** Expires header -> 如果这是在过去设置的（即总是过期的）那么 squid 将不会缓存它

正如 araqnid 所建议的，HTTP 标头可以对代理认为它可以缓存的内容产生巨大的影响。如果您的后端使用的是 apache，那么测试在不通过任何 PHP 或其他应用程序层的情况下提供的静态文件是否可缓存。

另外，检查 max_object_size 和 minimum_object_size 的 squid 设置是否设置为合理值（默认为 4Mb 和 0kb，应该没问题），并且最大缓存项年龄也设置合理。（有关此设置和其他设置，请参见[http://www.visolve.com/squid/squid30/cachesize.php#maximum_object_size ）](http://www.visolve.com/squid/squid30/cachesize.php#maximum_object_size)

# visual-studio - 在 Visual Studio 中构建项目

> ID：683914
> 
> 赞同：0
> 
> 时间：2009-03-25T23:19:32.567
> 
> 标签：visual-studio, build-process

我是 Windows 和 Visual Studio 的新手。不过，我在 Linux 编程方面有很强的背景。我正在尝试构建（只构建一个用于编译和链接的单词）一个来自教科书的示例代码。我做了一个空项目，将源文件和头文件添加到项目中。代码编译得很好。但是，我在链接时收到所有这些错误。发生的事情是代码调用了一堆VS找不到的函数。具体来说，所有错误都是

ping.obj：错误 LNK2019 未解析的外部符号

示例代码来自 Ch11 或 Windows 网络编程。它是关于创建用于制作 ping 程序的原始套接字。此外，代码附带了一个 Makefile，但我不知道如何将它与 VS 一起使用...

所以，基本上我需要知道如何将一些代码放入 VS 并使其正确构建。如果有人可以帮助我或将我指向一个体面的资源，我将非常感激。

编辑：我正在使用 VS 2008 和 C++

编辑2：我做了一个makefile项目并用cl ping.cpp resolve.cpp -out:ping.exe Ws2_32.lib填写了构建命令

现在它告诉我我的构建成功了，但是任何地方都没有 .exe ...... arg！！Windows 对我来说毫无意义。

这是它告诉我的：

```
1>------ Build started: Project: ping, Configuration: Debug Win32 ------
1>Performing Makefile project actions
1>Microsoft (R) 32-bit C/C++ Optimizing Compiler Version 15.00.21022.08 for 80x86
1>Copyright (C) Microsoft Corporation.  All rights reserved.
1>cl : Command line warning D9035 : option 'o' has been deprecated and will be removed           in a future release
1>ping.cpp
1>resolve.cpp
1>Generating Code...
1>Microsoft (R) Incremental Linker Version 9.00.21022.08
1>Copyright (C) Microsoft Corporation.  All rights reserved.
1>/out:ping.exe 
1>/out:ut:ping.exe 
1>ping.obj 
1>resolve.obj 
1>Ws2_32.lib 
1>Build log was saved at "file://c:\Documents and Settings\Devin.DEVIN-DESK\My     
Documents\Visual Studio 2008\Projects\raw_socks\ping\Debug\BuildLog.htm"
1>ping - 0 error(s), 1 warning(s)
========== Build: 1 succeeded, 0 failed, 0 up-to-date, 0 skipped ========== 
```

edit3：这对我来说很有意义。我有两个头文件和两个源文件，无论我做什么，我似乎都无法编译和链接。在 linux 中非常简单的过程在 Windows 中是复杂的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T23:41:35.120

我的猜测是您没有链接到所需的库，并且由于您正在编写一个 ping 应用程序，我猜它是 Windows Sockets 库。您可能需要将 ws2_32.lib 添加为链接模块。

尝试这样做：转到项目选项->链接器->输入

添加 Ws2_32.lib

如果这不能解决它，请发布整个链接错误。它应该更清楚地说明缺少什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T23:47:23.717

我相信您还需要包含 stdafx.h 标头。它是 IDE 在您创建项目时放入项目的头文件。自从我使用 VS 2008 编写任何 C++ 以来已经有一段时间了，但如果我没记错的话，我遇到了一堆问题。如果我记得，stdafx 头文件添加了一堆 VS 2008 编译器所需的编译器指令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T23:25:42.943

那是在C++中吗？

看看[这篇](http://msdn.microsoft.com/en-us/library/7s88b19e(VS.80).aspx)来自 msdn 的文章，我想这就是你要找的。我不知道你有什么版本的视觉工作室，但我认为不同版本的情况变化不大。无论如何，您会在该站点上找到所有版本。

# java - GUI、java、SWT 和世界地图表示

> ID：683917
> 
> 赞同：2
> 
> 时间：2009-03-25T23:21:50.877
> 
> 标签：java, swt

我正在尝试实现一个小规模的策略，轮流用Java实现游戏，GUI是用JFace和SWT制作的。

我的挑战是编写世界地图的 GUI 实现，其中国家将充当可点击按钮。但是，国家没有固定的边界，没有长方形，我根本想不到用网格布局来描述。

这是我第一次尝试实现这种类型的项目，请指教

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T00:52:25.667

如果它是基于图块的地图（如 Civilization）或显示为像素图，您可以将每个图块/像素的所有权保存在二维数组中。只需在画布中显示地图一个简单的、可点击的像素图并添加一个 MouseListener。如果您在坐标 (X,Y) 处获得点击事件，您可以像这样获得您的国家/地区：

```
Country clickedCountry = myCountriesOnMap[X][Y]; 
```

...在您的侦听器中实现 MouseListener 接口。myCountriesOnMap 将是 Country[][] 类型。

当然，您将需要一种算法来解决启动时每个图块/像素的所有权，或者如果领土被征服（我不知道，如果这可能发生）。可能您必须将您的国家/地区定义为多边形（就像您为 HTML 地图所做的那样）。我无法帮助你，因为我没有做过类似的喷气机，但我相信你会在谷歌上找到一些东西。

问候

萨赫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T08:32:38.423

尝试使用[OpenStreetMap](http://www.openstreetmap.org)数据。它包含确切的国家边界和良好的图像导出可能性。

[Key:border 标签](http://wiki.openstreetmap.org/wiki/Key:boundary)将显示所有边框。您可以提取它并计算您的可点击区域。

# .net - 从 VB6 迁移到 .NET/.NET Core 的最佳策略或工具

> ID：683918
> 
> 赞同：8
> 
> 时间：2009-03-25T23:23:28.127
> 
> 标签：.net, vb6, legacy, vb6-migration

我的公司有大量用 VB6 编写的*遗留*应用程序。

我们正在从将 VB6 应用程序迁移到 .NET（特别是 3.5）。

将 VB6 迁移到 .NET 的最佳策略是什么？

**注意**：以下更新应转到“项目管理”，与主要问题无关。

> **[更新]**：感谢您到目前为止的反馈
> 现在有更多问题弹出
> 
> 1.  您将如何分配开发人员来开发新的应用程序？
> 2.  是否应该有一个特殊的一次性升级部门将旧应用程序转换为新应用程序？还是每个开发人员都应该参与转换过程？
> 3.  只有高级开发人员才能参与转换吗？初级开发者？还是混合的？
> 
> 似乎，我对这个问题思考得越多，就会出现更多的问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T23:34:07.417

显然，这是一项涉及大量工作的重大任务。
所以我的建议是把它当作一个非常长期的项目来对待。

有一个明确的目标，它可以解决诸如安全性、弹性、可维护性和应用程序的未来等主要问题。

一旦利益相关者同意这一点，开发一个原型系统来测试您的假设，您可以在其中尝试 C# 与 VB.net 或 MVC 与 Webforms。我会为此分配您最好的开发人员。

然后从您的小型遗留系统开始，并构建您将在其他领域重用的核心组件。
在这个阶段，从你更资深的开发人员开始，但每个人都必须参与进来并熟悉新的框架。
这将确保每个人都同时接受培训，没有人掉队。
根据您有多少应用程序，我会轮换开发人员，因此所有系统都可以受益。

此外，所有新工作都必须使用您的 .net 语言而不是 VB6 来完成。

逐步转换您的每个旧应用程序。（我只会在它们发生变化或更新它们有明显好处的情况下转换它们。）

这应该为您提供一个可靠的框架以供您继续使用，同时仍确保用户功能不会受到迁移的阻碍。

例如：
我曾在一家拥有大约 40 个左右 VB 应用程序的公司工作。
随着时间的推移，我们已经将所有这些迁移到 C#，现在（5 年后），我们有大约 150 个 c# 应用程序（全部在 .net 2 中）。

这些都共享一个共同的框架，使它们易于维护，并在必要时进行扩展。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-25T23:52:04.893

尝试用支持 COM 的 .NET 库替换核心功能。通过将功能一点一点地迁移到 .NET 来“挖空”现有的 VB6 应用程序。

谨防完全重写。尽管它们很诱人，“因为它是干净利落的”——通常疯狂就在前面！阅读 Michael Feathers 的“有效地使用遗留代码”作为准备。尽管这本书并没有专门讨论“从一种语言迁移到另一种语言”，但它确实展示了你会遇到的许多现实世界的陷阱。

我确实认为所有开发人员都应该定义他们对之前开发的遗留应用程序进行迁移工作的时间段。因为他们已经拥有领域知识并且知道问题空间，所以他们应该是最有生产力的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-26T08:23:47.267

这是我对类似问题的[回答的改编。](https://stackoverflow.com/questions/638152/best-development-tools-for-upgrading-from-vb6-0/638994#638994)

自动转换大型程序是比重写更好的选择。开始乐观地重写一大块软件，在修复旧架构中的一些众所周知的缺陷时取得良好的早期进展，然后陷入你刚刚认为理所当然的功能，这是一个常见的陷阱年。在这一点上，你的管理层开始变得紧张，一切都会变得非常不舒服。

...这是微软[同意我](http://blogs.msdn.com/goto100/archive/2008/11/03/rewrite-vs-migrate-vs-reuse-vs-replace.aspx)的博客文章：

> 我在 .NET 早期工作过的许多公司首先考虑重写，部分原因是在迁移到 .NET 的同时，他们强烈希望改进底层架构和代码结构。不幸的是，其中许多项目遇到了困难，有几个项目从未完成。他们试图解决的问题太大了

这个出色的 Microsoft[页面](http://msdn.microsoft.com/en-gb/dd408373.aspx)推荐了两个第三方迁移工具，它们比功能不足的内置 VB.NET 升级向导[——Artinsoft](http://www.artinsoft.com/visual-basic-upgrade-companion-vs-upgrade-wizard.aspx)和 CodeArchitects [VBMigration 更好](http://www.vbmigration.com/)。Artinsoft 编写了内置的 VB.NET 升级向导，这是他们的改进版本。而 CodeArchitects 是由 Francesco Balena 创立的，他撰写了一些关于 VB6 和 VB.NET的[经典书籍。](http://www.amazon.com/s?ie=UTF8&search-type=ss&index=books&field-author=Francesco%20Balena&page=1)

同一个微软页面还说：

> 对 .NET 进行完全重写要比转换成本高得多，而且很难做好[比转换]……我们只在少数情况下推荐这种方法。

* * *

编辑：Sung 在评论中说：“我不是自动生成代码的忠实粉丝，因为它最初很难调试，并且可能需要与重写整个代码一样长的时间”。我不得不强烈反对。一般来说，我也不喜欢代码生成，但在这种情况下，生成的代码的结构将与您原来的 VB6 相同，并且应该几乎完全可以使用。我自己还没有真正尝试过这些工具，但是从他们的[客户](http://www.artinsoft.com/cs_home.aspx) [推荐](http://www.vbmigration.com/usersfeedback.aspx)中，这个承诺已经兑现。

And I repeat the Microsoft advice just above, based on their experience of assisting many migrations - "a complete rewrite is **far more costly and difficult** than converting [my emphasis]" - a flat contradiction of the supposition that it might take the same time. If you want to improve the structure of the VB6, migration then gradual refactoring is likely to be far more cost effective than a rewrite.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T23:26:20.087

看到这个：
[https ://stackoverflow.com/questions/507291/should-we-select-vb-net-or-c-when-upgrading-our-legacy-apps](https://stackoverflow.com/questions/507291/should-we-select-vb-net-or-c-when-upgrading-our-legacy-apps)

当然，C# vs VB.Net 只是其中的一部分。

例如，要考虑的另一件事是，如果您还没有想利用这个机会将这些应用程序移动到 Intranet，那么您是否还没有。或者你想深入研究微软的堆栈。例如，Winforms 够用还是你想使用 WPF。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T23:25:30.353

我将从微软的工具开始：

[http://msdn.microsoft.com/en-us/library/aa480541.aspx](http://msdn.microsoft.com/en-us/library/aa480541.aspx)

# asp.net-2.0 - 有没有办法以编程方式设置 SiteMapPath 控件的当前节点？

> ID：683927
> 
> 赞同：1
> 
> 时间：2009-03-25T23:26:00.460
> 
> 标签：asp.net-2.0, sitemap, sitemappath, asp.net-controls

我的网站有几个页面指向同一个子页面。我正在使用一个 xml 站点地图，它不允许我使用相同的 Url 复制 SiteMapNode。然后我的想法是给我的 SiteMapPath 控件一个父节点来填充自己，然后在当前页面的 SiteMapNode 上添加。

有没有其他人必须做类似的事情？我看过这篇文章[http://msdn.microsoft.com/en-us/library/ms178425.aspx](http://msdn.microsoft.com/en-us/library/ms178425.aspx)，它描述了如何“以编程方式修改内存中的站点地图节点”，但它们在文件中包含 SiteMapNode 和然后只需通过检查查询字符串来修改该节点。

我的节点永远不存在，或者如果它存在，我需要将它复制到正确的父节点，以便它可以呈现正确的路径。对于视觉：

```
Home
--My Page
----Page A
----Page B
----Page C
--My Other Page
----Page A
----Page D
--YAPage
----Page B
----Page C 
```

我想看到的一些例子：

```
Home > My Page > Page A
Home > My Other Page > Page A
Home > My Page > Page B
Home > YAPage > Page B 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T16:50:40.553

看起来这些将解决问题：

[http://www.codeproject.com/KB/aspnet/ABetterSiteMapResolve.aspx](http://www.codeproject.com/KB/aspnet/ABetterSiteMapResolve.aspx) [http://netpl.blogspot.com/2008/04/sitemapresolve-and-dynamic-site-map.html](http://netpl.blogspot.com/2008/04/sitemapresolve-and-dynamic-site-map.html)

对于动态站点地图： http: [//www.codeproject.com/KB/aspnet/dynamicsitemap.aspx](http://www.codeproject.com/KB/aspnet/dynamicsitemap.aspx)

对于多个提供者，您需要使用它来附加 SiteMapResolve 事件：（如果您的事件没有触发，很可能您没有设置正确的提供者。）

SiteMap.Providers[currentProvider].SiteMapResolve += new SiteMapResolveEventHandler(Provider_SiteMapResolve);

# php - PHP 删除链接中的文本

> ID：683932
> 
> 赞同：0
> 
> 时间：2009-03-25T23:27:24.123
> 
> 标签：php, string, forms

你如何剥离/删除 PHP 中的措辞？

我有一个将完整 URL 链接传递到输出页面的表单。

示例：maps/africa.pdf

在输出页面上，我想提供一个“href 链接”，但在 PHP 中使用相同的发布 URL，但去掉“地图”并让它提供一个仅显示非洲的链接。

示例：非洲

可以这样做吗？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-25T23:31:22.227

使用[`pathinfo`](http://us.php.net/manual/en/function.pathinfo.php)：

```
$filename = 'maps/africa.pdf';
$title = pathinfo($filename, PATHINFO_FILENAME); 
```

如果您只想`.pdf`被剥离，请使用[`basename`](http://us.php.net/basename)：

```
$filename = 'maps/africa.pdf';
$title = basename($filename, '.pdf'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T23:29:06.023

```
$string = 'maps/africa.pdf';

$link_title = str_replace(array('maps/', '.pdf'), '', $string); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T23:31:03.180

所以你只想要文件名？如果是这样，那么这将是最后一个斜线和最后一个点之间的所有内容。

```
if (preg_match("@/([^/]+)\\.[^\\./]+$@", $href, $matches)) {
    $linkText = $matches[1];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T23:36:14.273

这里有一些很好的答案。此外，如果您每次都知道 url，您可以计算字符并使用**substr()**例如[http://uk3.php.net/substr](http://uk3.php.net/substr "http://uk3.php.net/substr")

`$rest = substr("abcdef", 2, -1); // returns "cde"`

# objective-c - 在 Objective C 中引用 AudioToolbox 的错误

> ID：683940
> 
> 赞同：6
> 
> 时间：2009-03-25T23:31:57.857
> 
> 标签：objective-c

我在尝试播放一些 wav 文件的简单 Roulett 应用程序中遇到以下错误。我不确定错误是什么意思，因为代码中没有出现警告标志，我已经导入

这是错误：

> 未定义的符号：
> “_AudioServicesCreateSystemSoundID”，引用自：CustomPickerViewController.o 中的-[CustomPickerViewController playWinSound] -CustomPickerViewController.o 中的[CustomPickerViewController spin:] “_AudioServicesPlaySystemSound”，引用自：CustomPickerViewController.o 中的-[CustomPickerViewController playWinSound] -[CustomPickerViewController spin： ] 在 CustomPickerViewController.o ld：未找到符号 collect2：ld 返回 1 个退出状态
> “_AudioServicesCreateSystemSoundID”，引用自：-[CustomPickerViewController playWinSound] in CustomPickerViewController.o -[CustomPickerViewController spin:] in CustomPickerViewController.o “_AudioServicesPlaySystemSound”，引用自：-[CustomPickerViewController playWinSound] in CustomPickerViewController.o -[CustomPickerViewController spin:] in CustomPickerViewController .o ld：未找到符号 collect2：ld 返回 1 个退出状态

这是代码：

```
#import "CustomPickerViewController.h"
#import <AudioToolbox/AudioToolbox.h>

@implementation CustomPickerViewController
@synthesize picker;
@synthesize winLabel;
@synthesize column1;
@synthesize column2;
@synthesize column3;
@synthesize column4;
@synthesize column5;
@synthesize button;

- (void)showButton
{
    button.hidden = NO;
}

-(void)playWinSound
{
    NSString *path = [[NSBundle mainBundle] pathForResource:@"win" ofType:@"wav"];
    SystemSoundID soundID;
    AudioServicesCreateSystemSoundID((CFURLRef)[NSURL fileURLWithPath:path], &soundID);
    AudioServicesPlaySystemSound (soundID);     
    winLabel.text = @"WIN!";
    [self performSelector:@selector(showButton) withObject:nil afterDelay:1.5];
}

-(IBAction)spin:(id)sender
{
    BOOL win = NO;
    int numInRow = 1;
    int lastVal = -1;
    for (int i = 0; i < 5; i++)
    {
        int newValue =random() % [self.column1 count];

        if (newValue == lastVal)
            numInRow++;
        else
            numInRow = 1;

        lastVal = newValue;
        [picker selectRow:newValue inComponent:i animated: YES];
        [picker reloadComponent:i];
        if (numInRow >= 3)
            win = YES;
    }

    button.hidden = YES;
    NSString *path = [[NSBundle mainBundle] pathForResource:@"crunch"ofType:@"wav"];
    SystemSoundID soundID;
    AudioServicesCreateSystemSoundID((CFURLRef) [NSURL fileURLWithPath:path], &soundID);
    AudioServicesPlaySystemSound(soundID);

    if (win)
        [self performSelector:@selector(playWinSound) withObject: nil afterDelay: .5];
    else 
        [self performSelector:@selector(showButton) withObject: nil afterDelay: .5];

    winLabel.text = @"";
} 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-25T23:51:34.410

找到了。意识到我没有在 XCode 中导入框架 AudioToolbox.Framework。:)

# c++ - 我的文件依赖项有什么问题？

> ID：683942
> 
> 赞同：0
> 
> 时间：2009-03-25T23:33:13.330
> 
> 标签：c++, visual-c++, opengl, dependencies

除了 main.cpp 之外，我还有一个使用 3 个头文件和 3 个 .cpp 文件的程序。我正在使用 VC++ 2008。

这是设置。所有三个标头都由#ifndef HEADERNAME_H 等保护。所有三个标头都有相应的.cpp 文件，其中#include 各自的标头。

```
/* main.cpp */
    #include "mainHeader.h"

/* mainHeader.h */
    #include <windows.h>
    #include <iostream>
    //Others...
    #include "Moo.h"   

/* Moo.h */
    #include "mainHeader.h"
    #include "Foo.h"

    class Moo {
        private:
        int varA;
        Foo myFoo1;
        Foo myFoo2;
        Foo myFoo3; 

        Public:
        void setVarA(int);    // defined in Moo.cpp
        //etc
    };

/* Foo.h */
   #include "mainHeader.h"
   class Foo { ... }; 
```

我在实例化 Moo.h 中的三个 Foo 时遇到编译器错误：

错误 C2079：“Moo::setVarA”使用未定义的类“Foo”

我在那里包含了 Foo.h，那么为什么它是未定义的呢？这是唯一包含 Foo.h 的文件。我什至尝试通过放置'class Foo;'来声明Foo 在我宣布班级 Moo 之前。

我的 Foo.h 文件中也有 #defines，当我在 Moo.h 中使用它们时也会导致编译器错误。（未声明的标识符错误 C2065）。

似乎 Foo.h 没有被包含在内，因为 Moo.h 找不到其中定义/声明的任何内容。这是怎么回事？

我的实际代码很长，但是给你（顺便说一句，这是一个马里奥平台游戏）：

这将是 Foo.h：

```
//**************************
//  Animation.h
//**************************
//  Header to Animation class

#ifndef ANIMATION_H
#define ANIMATION_H

#include "../Headers/MarioGame.h"

#define MAX_ANIMATIONS 58

extern char* fileAnimations[MAX_ANIMATIONS];
extern char marioAnims[MAX_ANIMATIONS][3000];
extern char background [3700000];

class Animation
{
private:
    int imageCount;

public:
    DWORD lastAnimTick;
    int lastAnim;
    int anims[4][2];
    DWORD animsTime[4];

    // Constructor
    Animation();

    // Mutators
    void addImage(int left, int right, DWORD time);
    void defaultAnimation();

    // Accessors
    int getImage(bool facingLeft);
    int getImageCount();
    int getCurLoc();
};

#endif  // ANIMATION_H 
```

这将是“Moo.h”。请注意许多私有 Animation 成员，所有这些都导致错误：

```
//**************************
//  Mario.h
//**************************
//  Header to Mario class

#ifndef MARIO_H
#define MARIO_H

#include "../Headers/MarioGame.h"
#include "../Headers/Animation.h"

enum { MARIO_TYPE_SMALL, 
       MARIO_TYPE_BIG, 
       MARIO_TYPE_LEAF };

class Animation;

class Mario
{
private:
    #pragma region Variable Declarations
        float xPos;
        float yPos;

        float xVel;
        float yVel;

        float lastXVel; //used for determining when walk/run decceleration is complete

        float xAccel;
        float yAccel;

        float xSize;
        float ySize;

        float halfW;
        float halfH;

        bool grounded;
        bool walking;
        bool running;
        bool pRunning;
        bool jumping;
        bool hunching;
        bool gliding;
        bool flying;
        bool decelerating;
        int facing;

        DWORD pRunTimer;
        int pChargeLevel;

        DWORD jumpStart;

        DWORD glideStart;

        int type;

        bool updateXMovement;
        bool updateYMovement;

        bool screenUpLock;

        char marioAnims[MAX_ANIMATIONS][3000];

        Animation smallStand;
        Animation smallWalk;
        Animation smallRun;
        Animation smallPRun;
        Animation smallJump;
        Animation smallSkid;

        Animation bigStand;
        Animation bigWalk;
        Animation bigRun;
        Animation bigPRun;
        Animation bigJump;
        Animation bigSkid;
        Animation bigHunch;

        Animation leafStand;
        Animation leafWalk;
        Animation leafRun;
        Animation leafPRun;
        Animation leafJump;
        Animation leafSkid;
        Animation leafHunch;
        Animation leafTailWhack;
        Animation leafGlide;
        Animation leafFly;
        Animation leafFalling;

        Animation* lastAnim;
    #pragma endregion

public:
    //Constructor
    Mario();

    //Mutators
    void setGlideStart( DWORD g );
    void setHunching( bool h );
    void setGliding( bool g );
    void setFlying( bool f );
    void setType( int t );
    void setPChargeLevel( int c );
    void setPRunTimer( DWORD t );
    void setScreenUpLock( bool s );
    void setUpdateXMovement( bool m );
    void setUpdateYMovement( bool m );
    void setDecelerating( bool d );
    void setPos( float x, float y );
    void setVel( float x, float y );
    void setAccel( float x, float y );
    void setSize( float x, float y );
    void setJumping( bool j );
    void setJumpStart( DWORD s );
    void setGrounded( bool g );
    void setWalking( bool w );
    void setRunning( bool r );
    void setPRunning( bool r );
    void setLastXVel( float l );
    void setFacing( int f );
    void defaultAnimations();

    //Accessors
    DWORD getGlideStart();
    bool getHunching();
    bool getGliding();
    bool getFlying();
    int getType();
    int getPChargeLevel();
    DWORD getPRunTimer();
    bool getScreenUpLock();
    bool getUpdateXMovement();
    bool getUpdateYMovement();
    bool getDecelerating();
    float getXPos();
    float getYPos();
    float getXVel();
    float getYVel();
    float getXAccel();
    float getYAccel();
    bool getJumping();
    DWORD getJumpStart();
    float getXSize();
    float getYSize();
    float getHalfW();
    float getHalfH();
    bool getGrounded();
    bool getWalking();
    bool getRunning();
    bool getPRunning();
    float getLastXVel();
    int getFacing();
    int getAnimation();
};

#endif  // MARIO_H 
```

这将是“mainHeader.h”：

```
//**************************
//  MarioGame.h
//**************************
//  Header to MarioGame functions
//  Contains Includes, Defines, Function Declarations, Namespaces for program

#ifndef MARIOGAME_H
#define MARIOGAME_H

//*=====================
//  Defines
//*=====================
#define WINDOWED        0                   // predefined flags for initialization
#define FULLSCREEN      1

#define WNDCLASSNAME    "MarioGame"         // window class name
#define WNDNAME         "Mario Game"        // string that will appear in the title bar

#define NUM_OF_KEYS     5
#define KEY_SPACE       0
#define KEY_UP          1
#define KEY_DOWN        2
#define KEY_RIGHT       3
#define KEY_LEFT        4
#define KEY_CONTROL     5

#define GRIDW           2.0f
#define GRIDH           2.0f

#define PATHING_SIZE 33

//*=====================
//  Includes
//*=====================
#include <windows.h>

#include <gl/gl.h>
#include <gl/glu.h>

#include <iostream>
#include <fstream>
#include <vector>
#include <math.h>
#include <WAVEMIX.H>

#include "../Console/guicon.h"
#include "../Headers/Mario.h"

//*=====================
//  Function Declarations
//*=====================
LRESULT CALLBACK WinProc(HWND hwnd, UINT msg, WPARAM wparam, LPARAM lparam);
HWND createWindow(HINSTANCE &hinst, int width, int height, int depth);

void renderFrame();
void think();
void loadTextures();
void WMInit(HINSTANCE, HWND);

void resize (int width, int height);
void shutdown();

void keyLeft(bool);
void keyRight(bool);
void keySpace(bool);
void keyDownArrow(bool);

bool checkBoundary(float, float);
void onPlayerDeath();

class Mario;

//*=====================
//  Namespaces
//*=====================

using namespace std;

//*=====================
//  Global Variable Declarations
//*=====================
extern Mario Player;

extern HDC hdc;
extern HGLRC hglrc;
extern HWND hwnd;

extern int SCRW;
extern int SCRH;
extern int SCRD;

extern DWORD oldTick;
extern DWORD oldTick2;
extern DWORD oldPTime;

extern float pixelZoom;

extern float screenPosX;
extern float screenPosY;        

extern float playerScrollMultiplier;    

extern float playerTerminalWalkVel;
extern float playerWalkAccel;       

extern float playerRunAccel;            
extern float playerTerminalRunVel;

extern float playerDecel;   

extern float playerPVel;
extern DWORD playerPRunAchieveTime;     

extern float playerJumpUpVel;   
extern float playerJumpTime;

extern float gravityAccel;  
extern float playerTerminalFallVel; 

extern float playerTerminalGlideFallVel;

extern bool keyDown[NUM_OF_KEYS];
extern bool lastSpace;          

extern bool drawPathingMap;             

extern float pathing [PATHING_SIZE][5][2];      

#endif          // MARIOGAME_H 
```

这是main.cpp：

```
//**************************
//  main.cpp
//**************************
// Primary implementation file; handles Win32 interface 

#include "../Headers/MarioGame.h"
//*=====================
//  WinMain
//*=====================
int WINAPI WinMain(HINSTANCE hinstance, HINSTANCE hprevinstance, LPSTR lpcmdline, int nshowcmd)
{
    ...
}

//And other functions.... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T23:35:51.217

您需要类 Foo 的前向声明。有关详细信息，请参阅“Effective C++，第三版”的第 31 项。注意：如果您转发声明 Foo，则意味着您的类 Moo 将只能具有 Foo 类型的指针。

如果某些内容包含 Foo.h，则会发生这种情况（箭头显示依赖关系）：

Foo.h --includes--> mainHeader.h --includes--> Moo.h --includes--> Foo.h

请注意，当指定 Moo 类时，由于您的警卫，第二个 Foo.h 不包括在内，还没有声明类 Foo 因为这发生在包含 mainheader.h 之后

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-26T00:18:30.443

调试这类情况的最佳工具是编译器的“将预处理后的输出转储到文件”选项。如果启用此功能，您很可能会立即看到问题。检查您的编译器选项以了解如何启用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-07T18:38:26.163

另一个需要注意的问题是“使用命名空间”语句的使用——你根本不应该在头文件中使用这些语句。

这是为了避免包含许多不同头文件的模块产生歧义。

所以，是的，如果没有它，您将需要做很多 std::vector、std::list 等，这可能会很痛苦。

# ruby-on-rails - rails gem nkallen-cache-money (0.2.5) 的配置问题：在 find 方法上获取 RecordNotFound 异常

> ID：683948
> 
> 赞同：0
> 
> 时间：2009-03-25T23:35:11.483
> 
> 标签：ruby-on-rails, caching, memcached

[我根据github 自述](http://github.com/nkallen/cache-money/tree/master)文件安装了 nkallen 的 cache-money gem 。我在测试期间遇到了 RecordNotFound 异常。如果我注释掉 config/initializers/cache-money.rb 的内容，测试运行良好。我的 cache-money.rb 文件与 github 说明中的相同。

这是我的 config/memcached.yml 的内容： development: ttl: 604800 namespace: cache-#{RAILS_ENV} sessions: false debug: true servers: localhost:11211

测试：ttl：604800 命名空间：缓存-#{RAILS_ENV} 会话：错误调试：真实服务器：本地主机：11211

生产：ttl：604800 命名空间：缓存-#{RAILS_ENV} 会话：错误调试：错误服务器：本地主机：11211

我找不到有关如何配置或安装缓存货币的任何其他文档。我很感激任何洞察力或帮助调试这个。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T01:20:16.473

我将缓存货币配置放入 /config/initializers/cache_money.rb：

```
if RAILS_ENV != 'development'
  require 'cache_money'

  config = YAML.load(IO.read(File.join(RAILS_ROOT, "config", "memcached.yml")))[RAILS_ENV]
  $memcache = MemCache.new(config)
  $memcache.servers = config['servers']

  $local = Cash::Local.new($memcache)
  $lock = Cash::Lock.new($memcache)
  $cache = Cash::Transactional.new($local, $lock)

  class ActiveRecord::Base
    is_cached :repository => $cache
  end
else
  # If we're in development mode, we don't want to
  # deal with cacheing oddities, so let's overrite
  # cache-money's #index method to do nothing...
  class ActiveRecord::Base
    def self.index(*args)
    end
  end
end 
```

无需其他设置。这对我很有用。

# asp.net-mvc - HtmlHelper 方法和 RouteValueDictionary

> ID：683952
> 
> 赞同：5
> 
> 时间：2009-03-25T23:36:12.543
> 
> 标签：asp.net-mvc, html-helper

在编写 htmlhelper 扩展时，如果我想为我的 htmlhelper 扩展方法支持类似结构的 ctor，我使用`RouteValueDictionary`如下：

```
public static string ListBoxDict(this HtmlHelper htmlHelper, 
                                 string name, 
                                 object value, 
                                 object htmlAttributes)
{
    return ListBoxDict(htmlHelper, 
                       name, 
                       value, 
                       ((IDictionary<string, object>)
                           new RouteValueDictionary(htmlAttributes)));
} 
```

我的问题真的是为什么需要`RouteValueDictionary`......我知道你不能只是投到`htmlAttributes`......`IDictionary<string, object>`虽然我不确定为什么，这可能是我感到困惑的地方。不应该`RouteValueDictionary`与路由有关，因此与 HtmlHelper 方法无关？就像我说的那样，我可能错过了重点，所以如果有人能告诉我我错过了什么，我会很高兴。

干杯...

编辑：响应丹的回答-->

我只是按照我在输入帮助程序的 mvc 源代码中看到的内容......

*   见“ `src\SystemWebMvc\Mvc\Html\InputExtensions.cs`”

它的作用如下：

```
public static string TextBox(this HtmlHelper htmlHelper, 
                             string name, 
                             object value, 
                             object htmlAttributes)
{
    return TextBox(htmlHelper, 
                   name, 
                   value,
                   new RouteValueDictionary(htmlAttributes))
} 
```

显然是一个捷径，但它是一个混蛋还是可以这样做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T00:15:08.517

我强烈建议您查看 Rob Conery 的有关此类内容的[博客文章](http://blog.wekeroad.com/blog/aspnet-mvc-preview-using-the-mvc-ui-helpers)。

它的肉和蔬菜是这样的：

**编码转储：**

```
public static string ToAttributeList(this object list)
{
  StringBuilder sb = new StringBuilder();
  if (list != null)
  {
    Hashtable attributeHash = GetPropertyHash(list);
    string resultFormat = "{0}=\"{1}\" ";
    foreach (string attribute in attributeHash.Keys)
    {
      sb.AppendFormat(resultFormat, attribute.Replace("_", ""), 
          attributeHash[attribute]);
    }
  }
  return sb.ToString();
}

public static string ToAttributeList(this object list,
                                     params object[] ignoreList)
{
  Hashtable attributeHash = GetPropertyHash(list);

  string resultFormat = "{0}=\"{1}\" ";
  StringBuilder sb = new StringBuilder();
  foreach (string attribute in attributeHash.Keys)
  {
    if (!ignoreList.Contains(attribute))
    {
      sb.AppendFormat(resultFormat, attribute, 
          attributeHash[attribute]);
    }
  }
  return sb.ToString();
}

public static Hashtable GetPropertyHash(object properties)
{
  Hashtable values = null;

  if (properties != null)
  {
    values = new Hashtable();
    PropertyDescriptorCollection props = 
        TypeDescriptor.GetProperties(properties);

    foreach (PropertyDescriptor prop in props)
    {
      values.Add(prop.Name, prop.GetValue(properties));
    }
  }
  return values;
} 
```

**用法：**

```
public static string ListBoxDict(this HtmlHelper htmlHelper, 
                                 string name, 
                                 object value, 
                                 object htmlAttributes)
{
    return htmlHelper.ListBoxDict(name,
                                  value,
                                  htmlAttributes.ToAttributeList()));
} 
```

什么`.ToAttributeList()`是将您的 htmlAttribute 对象转换为

> 名称 = “价值”

希望这是有道理的。

# visual-studio - Visual Studio 项目将目标文件放置在不相关的项目目录中。帮助

> ID：683954
> 
> 赞同：0
> 
> 时间：2009-03-25T23:36:20.093
> 
> 标签：visual-studio, build

我有一个 Visual Studio 解决方案，其中包含一个构建操纵杆处理库的项目。不幸的是，输出的 .lib 文件被放置在驱动器上一个不相关的文件夹中。它被放置在另一个项目中。我注意到 $(TargetDir) 正在扩展到无关项目的路径，而不是当前的解决方案路径。我该如何改变？我在 Visual Studio 项目文件中搜索了任何匹配的路径文本，但什么也没有出现，所以我看不到它是如何指向错误的目录的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T23:42:24.540

好吧，我搞砸了。该项目指向错误的目录（显然）:-)

# c# - PFX ConcurrentQueue - 有没有办法从队列中删除特定项目

> ID：683956
> 
> 赞同：2
> 
> 时间：2009-03-25T23:37:13.023
> 
> 标签：c#, .net, concurrency, pfx

我有一个应用程序，它有一个项目的 ConcurrentQueue，每个项目都有一个 ID 属性和一个任务的 ConcurrentQueue，队列项目如下所示：

```
class QueueItem {
  public int ID { get; set; }
  public ConcurrentQueue<WorkItem> workItemQueue { get; set; }
} 
```

队列本身看起来像：

```
ConcurrentQueue<QueueItem> itemQueue; 
```

我有一个线程在 itemQueue 上执行 foreach，从每个队列中取出一个项目并对其进行处理：

```
foreach(var queueItem in itemQueue) {
  WorkItem workItem;
  if (queueItem.workItemQueue.TryDequeue(out workItem))
    doWork(workItem);
  else
    // no more workItems for this queueItem
} 
```

我正在使用 ConcurrentQueues，因为我有一个单独的线程可能将 queueItems 添加到 itemQueue，并将 workItems 添加到每个 workItemQueue。

当我在 queueItem 中没有更多 workItems 时，我的问题就出现了 - 我想从 itemQueue 中删除该 queueItem - 比如......

```
 if (queueItem.workItemQueue.TryDequeue(out workItem))
    doWork(workItem);
  else
    itemQueue.TryRemove(queueItem); 
```

...但我找不到轻松做到这一点的方法。我想出的方法是将每个 QueueItem 出列，然后如果 workItemQueue 中仍有 WorkItems 则将其入队：

```
for (int i = 0; i < itemQueue.Count; i++) {
  QueueItem item;
  itemQueue.TryDequeue(out queueItem);
  if (queueItem.workItemQueue.TryDequeue(out workItem)) {
    itemQueue.Enqueue(queueItem);
    doWork(workItem);
  }
  else
    break;
} 
```

有没有更好的方法来使用 PFX ConcurrentQueue 完成我想要的，或者这是一种合理的方法，我应该使用自定义并发队列/列表实现还是我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-15T08:27:26.147

通常，没有有效的方法可以从队列中删除特定项目。它们通常有 O(1) 队列和出队，但 O(n) 删除，这是您的实现所做的。

一种替代结构是称为 LinkedHashMap 的结构。如果您有兴趣，请查看[Java 实现。](http://java.sun.com/javase/6/docs/api/java/util/LinkedHashMap.html)

它本质上是一个哈希表*和*一个链表，它允许 O(1) 排队、出队和删除。

这还没有在 .Net 中实现，但是有一些实现漂浮在网络上。

现在，问题是，为什么 itemQueue 是一个队列？从您的代码示例中，您永远不会从其中入队或出队任何内容（除了围绕删除问题导航）。我怀疑如果使用更合适的数据结构，您的问题可能会得到简化。您能否举例说明还有哪些其他代码可以访问 itemQueue？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-23T15:14:26.430

这可能不适用于所有人，但以下是我提出的从并发队列中删除项目的解决方案，因为这是谷歌的第一个结果，我想我会留下我的解决方案。

我所做的是将工作队列暂时替换为空，将原始队列转换为列表并删除项目，然后从修改后的列表中创建一个新队列并将其放回原处。

在代码中（对不起，这是 VB.net 而不是 C#）：

```
Dim found As Boolean = False
//'Steal the queue for a second, wrap the rest in a try-finally block to make sure we give it back
Dim theCommandQueue = Interlocked.Exchange(_commandQueue, New ConcurrentQueue(Of Command))
Try
    Dim cmdList = theCommandQueue.ToList()
    For Each item In cmdList
        If item Is whateverYouAreLookingFor Then
            cmdList.Remove(item)
            found = True
        End If
    Next
    //'If we found the item(s) we were looking for, create a new queue from the modified list.
    If found Then
        theCommandQueue = New ConcurrentQueue(Of Command)(cmdList)
    End If
Finally
    //'always put the queue back where we found it
    Interlocked.Exchange(_commandQueue, theCommandQueue)
End Try 
```

旁白：这是我的第一个答案，所以请随时提出一些编辑建议和/或编辑我的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-06T20:28:40.983

当您想要以 FIFO 样式处理项目时，队列意味着 LIFO 堆栈。还有一个concurrentdictionary和一个concurrentbag。确保队列实际上是您想要的。我认为我永远不会在并发队列上进行 foreach 。

您可能想要的是您的工作项的单个队列（让它们使用公共接口并在接口上创建一个队列，该接口应该公开继承的类型，如果需要，以后可以对其进行重铸）。如果工作项属于父项，则可以使用一个属性来保存父项的键（考虑键的 GUID），并且可以将父项保存在并发字典中并根据需要引用/删除。

如果您必须按照自己的方式进行操作，请考虑添加标志。然后，您可以将 itemqueue 中的项目标记为“已关闭”或其他任何内容，这样当它出队时，它将被忽略。

# c# - 您是否使用（裸）C# 代码块？

> ID：683959
> 
> 赞同：2
> 
> 时间：2009-03-25T23:38:01.430
> 
> 标签：c#, coding-style

我已经用 C# 编程了......一段时间了。我最近编写了一个例程，我突然想到这是我第一次（我记得）故意使用裸代码块（即没有前面的控制流语句）。代码看起来很模糊：

```
//...

var output = source.GetRawOutput();

{
    var fooItems = FooSource.GetItems();

    output = TransformA.TransformOutput(output, p =>
        {
            GetFooContent(p, fooItems.GetNext());
        });
}

{
    var barItems = BarSource.GetItems();

    output = TransformB.TransformOutput(output, p =>
        {
            GetBarContent(p, barItems.GetNext());
        });
}

return output; 
```

我以这种方式构建代码主要是为了确保我不会意外引用错误的变量（即混淆 barItems 和 fooItems）。我还发现代码更具可读性。我当然可以将代码分解为三个单独的方法，但我觉得在这种情况下这有点过分了。

您是否在代码中使用裸代码块？为什么或者为什么不？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T23:42:28.660

如果您查看您的代码，这两个块非常相似。我敢打赌它们可以重构为一个块。

虽然这听起来不像是一个答案，但确实如此。我认为，总的来说，如果您希望使用这样的大括号，那么您正在处理的情况可以通过分解另一种方法或一起重构部分来更好地处理。

总之一般。

具体答案——不，一旦我擅长 OO 并限制我在一个单元中完成的工作量，我从没想过它们可能是一个好主意。

编辑：使用类似的代码，它必须相当容易重构。我会尝试重构。对不起，如果我弄错了语法，我真的不做 c# 并且 Java 没有闭包。

```
output = transform(FooSource, TransformA);
output = transform(BarSource, TransformB);  // I know output is overwritten, but
                // it is in the askers' example as well

transform(var itmSource, var transform) {
    var output=source.GetRawOutput();  // Sorry, you never said where source came from.

    var items = itmSource.GetItems();
    output=transform.TransformOutput(output, p =>
        {
            GetContent(p, items.GetNext()); // GetContent may need to be passed in
                                    // you didn't say where those calls came from.
                                 // See comments below
        });
    }
    return output;
} 
```

像这样的重构并没有节省太多的输入，但是它们显示了一些很好的模式——比如 FooSource 和 TransformA 之间的关系（可能还有 getContent 调用）——它们很有可能应该存储在单个对象中并且该对象应该被传入，或者类似的东西。（从这个片段很难看出，通常重构需要比你给出的更广泛的代码视图）

请注意，它们还迫使您考虑 GetFooContent 和 GetBarContent。我敢打赌你喝一品脱啤酒，它们是如此相似，以至于它们既可以被分解为带有一个或两个传入变量的单个方法调用，也可以被分解为两个兄弟类中的一个方法。

由于这种关系总是出现并且总是改进你的类中的其他代码，我相信这种重构是绝对强制性的，这种重构比任何事情教会我真正的 OO 都要多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T23:42:36.273

就个人而言，我不这样做是为了构建代码。这在 C++ 中用于控制变量的范围并调用析构函数，但由于 C# 是垃圾收集，我看不到块的功能用法。

关于可读性的结构，我相信你的方法要么足够小，不需要这些东西，要么应该分解成更小的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T23:43:47.890

我发现，大多数时候我很想这样做，我最好将它重构为一个单独的方法。以您的示例为例-在这种情况下，您似乎可以使用一种方法来处理具有正确参数的两个裸代码块。

重构将使其更清晰，更易于维护。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T23:47:20.910

我从不使用它们，而是倾向于将代码块放入较小的方法中，并带有描述性名称，这具有使意图更清晰的额外好处。

我想补充一点，尽管在您提供的示例中，这两个块看起来非常相似，但您可能需要将它们都用两个方法调用替换为一个可以为您完成工作的单一方法：

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T23:57:14.770

我用它们来包装临时变量。例如，有时需要创建一个对象，设置它的一些变量，将它传递给一个函数，然后处理它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T23:57:59.947

我几乎从不使用它们，就像其他人所说的那样。您可能会在一种极端情况下使用它们：封闭块决定了编译器将变量捕获到闭包中的具体程度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-23T13:40:00.370

There is a very interesting use for bare code blocks: to manage scope.

When I want a variable that is not disposable to be collected by the GC as early as it is possible, I must remove it from scope as soon as I finish using it, so I create the variable inside a bare block, use it there and, when execution leaves the block, GC will see that the variable is out of scope, collecting it ASAP.

This is useful for large lists that are only used for a few operations in a method. If the execution of the method is long, then it is advisable to get rid of the lists when no longer using them.

PS: Be warned that setting them to null will not work, since the very time you set it to null you will be referencing it, so GC will delay the collection instead of hurrying it up.

# c# - 如何避免实体框架中的硬编码字段名称？

> ID：683960
> 
> 赞同：2
> 
> 时间：2009-03-25T23:38:30.837
> 
> 标签：c#, .net, entity-framework

如何避免在实体框架中使用硬编码的表和字段名称？例如：

```
 Contact contact =
        contactQuery.Include("SalesOrderHeader.SalesOrderDetail")
        .FirstOrDefault(); 
```

有没有办法从上下文或元数据中获取该信息？我很想能够说 SalesOrderHeader.TableName 或 SalesOrderHeaderFields.SalesOrderDetails.FieldName

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T17:24:54.733

如果要使用 Entity Frameworks 元数据，则需要查看`MetadataWorkspace`挂在`ObjectContext`.

起点是为您的基本类型获取 EntityType，在您的情况下为 Contact。

我有一个[EF 技巧系列](http://blogs.msdn.com/alexj/archive/2009/03/26/index-of-tips.aspx)，在[技巧 13](http://blogs.msdn.com/alexj/archive/2009/04/15/tip-13-how-to-attach-an-entity-the-easy-way.aspx)中我展示了一个扩展方法，`MetadataWorkspace`用于获取`EntityType`特定 CLR 类型：

```
public static EntityType GetCSpaceEntityType<T>(
        this MetadataWorkspace workspace); 
```

您可以像这样使用它：

```
var contactEntity = ctx.MetadataWorkspace.GetCSpaceEntityType<Contact>(); 
```

一旦你有了这个，你可以查看它的 NavigationProperties 来找到关系和你感兴趣的名称，包括：

IE

```
foreach(var np in contactEntity.NavigationProperties)
{
    Console.WriteLine("Include: {0}", np.Name);
    Console.WriteLine("... Recursively include ");
    EntityType relatedType = 
       (np.ToEndMember.TypeUsage.EdmType as RefType).ElementType;
    //TODO: go repeat the same process... i.e. look at the relatedTypes 
    // navProps too until you decide to stop.
} 
```

当然，您如何决定要包含的内容取决于您。希望这可以帮助

亚历克斯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-08T05:00:36.127

阅读[告别硬编码的 ObjectQuery(T).Include 调用](http://blogs.microsoft.co.il/blogs/shimmy/archive/2010/08/06/say-goodbye-to-the-hard-coded-objectquery-t-include-calls.aspx)，您将能够使用 lambda 和 linq 表达式树进行如下操作：

```
Dim c = GetObjectContext()
Dim query = c.Vendors.Include(Function(v) v.Contact.Addresses.Single.State) 
```

还有一个 C# 示例。

高温高压

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T13:22:45.193

它只是一个属性名称，因此您可以通过反射获取它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-27T00:58:01.047

示例（希望听到更好的想法，没有找到像 VB GetType 那样接受类型名称作为参考的方法）：

**VB：**

```
<Extension()>
Function GetRelation(Of TEntity As Type)(entity As TEntity,
 ParamArray path() As TEntity) As String
  GetRelation = entity.Name
  For Each type In path
    GetRelation &= "." & type.Name
  Next
End Function

'Here is your line:
Dim x = Context.Employee.Include(
 GetType(Contact).GetRelation(GetType(SalesOrderHeader),
 GetType(SalesOrderDetail))) 
```

**C＃：**

```
static string GetRelation<TEntity>(this TEntity entity, params TEntity[] path)
 where TEntity : Type
{
   string ret = entity.Name;
   foreach (TEntity type in path) ret += "." + type.Name;
   return ret;
}

//Put your line here:
var x = context.Employee.Include(typeof(Contact).GetRelation(
 typeof(SalesOrderHeader),
 typeof salesOrderDetail))); 
```

我希望有一种动态的反思方式......再次，我思想开放，任何建议都会受到祝福谢谢

# vim - 是否可以在 vim 中使用带有符号链接的“gf”？

> ID：683964
> 
> 赞同：1
> 
> 时间：2009-03-25T23:39:53.720
> 
> 标签：vim, path, symlink

是否可以通过配置 vim 来遵循符号链接`gf`？

例如，假设我在同一个目录中有一个文件`foo.txt`和一个符号链接。`bar`我希望能够`bar`通过`gf`在`foo.txt`.

更一般地说，我希望能够使用`find`和其他使用路径的命令，就好像实际文件与我正在编辑的文件位于同一目录中一样。不过我会满足于工作`gf`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T01:48:57.700

为我工作。7.1.

`gf`当您超过符号链接的名称时，您会得到什么输出？`+file_in_path`键入时是否启用`:version`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T08:28:38.223

关于`:find`，你配置了`&path`吗？

# emacs - 在 Emacs 中使用 Mq 而不将我所有的代码变成注释

> ID：683970
> 
> 赞同：4
> 
> 时间：2009-03-25T23:41:48.020
> 
> 标签：emacs

假设您编写了一些这样的代码（使用 ruby​​-mode，但我也看到在其他模式下也会发生这种情况）：

```
# This is a comment.
def foo
    puts "foo!"
end 
```

如果你把这个点放在第一行并点击 Mq，你会得到：

```
# This is a comment. def foo puts "foo!" end 
```

我该如何避免呢？我使用的是 21.3 版。

澄清：当我在注释和代码之间添加一个空行时，不会发生这种情况。作为一种解决方法，当我想补充我的评论时，我经历了一个烦人的三步过程：

1.  我在评论段落之前和之后添加了一个空行
2.  MQ
3.  删除空行

如果 Mq 无需添加和删除空白行就可以处理重新填充评论段落会更好。Emacs 已经知道什么文本是注释文本，所以一定有办法做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T03:48:16.103

[filladapt.el](http://www.emacswiki.org/emacs/FillAdapt)可以解决问题。使用最新版本的[RubyMode](http://www.emacswiki.org/emacs/RubyMode)。

使用这两个包可以解决您看到的 Mq 问题。（使用 GNU Emacs 22.1）

查看 ruby​​-mode 的代码，看起来它已经自定义了变量来控制段落填充，如下所示：

```
(make-local-variable 'paragraph-start)
(setq paragraph-start (concat "$\\|" page-delimiter))
(make-local-variable 'paragraph-separate)
(setq paragraph-separate paragraph-start)
(make-local-variable 'paragraph-ignore-fill-prefix)
(setq paragraph-ignore-fill-prefix t) 
```

可以将其添加到您当前的 ruby​​ 的自定义钩子中，或者您希望填充行为按照您描述的方式运行的任何主要模式 - 只要您使用 filladapt.el。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T23:48:47.770

Mq 绑定了 fill-paragraph，它所做的就是试图智能地将文本变成一个段落。它具有尝试猜测“填充前缀”的功能，这似乎是发生在您身上的事情。

如果您不喜欢它，您可以取消绑定 Mq。

```
(global-unset-key (kbd "M-q")) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T01:18:06.057

填写评论适用于`sh-mode`.

也许您应该向`ruby-mode`维护者提交一个错误？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T23:56:11.607

您需要处于 Ruby 模式，这样 Emacs 才能理解“<code># This is a comment”。是评论。如果您处于基本模式，它只会将所有内容视为文本段落，这使得它认为下一行的文本是同一段落的一部分。

如果您还没有安装 Ruby 模式，[这里有一些说明。](http://blog.modp.com/2007/09/ruby-mode-for-emacs.html)

# perl - 如何捕获对 %ENV 的更改？

> ID：683986
> 
> 赞同：7
> 
> 时间：2009-03-25T23:50:47.673
> 
> 标签：perl, environment-variables

我有一堆运行工具流的脚本。就像 Makefile 一样，但在 Perl 中。

作为这些流程的一部分，Perl 脚本设置了环境变量，而且要知道它们何时发生并不总是那么容易，因此很难重现流程的各个阶段。

有没有办法挂钩 %ENV 以便我可以在环境变化时注册回调？

我可以绑定它吗？%ENV 已经表现得像平局一样。

跟进：是的。你只要把它绑起来。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-26T01:50:17.917

哦。我刚刚被我的屁股吓坏了。无论如何，据说存在一个监视器包，可以让您通过 tie 来监视对现有变量的更改。这听起来像是一个有趣的问题，所以当我开始深入研究 The Blue Camel 中的“领带”文档时，没有定义现有变量会发生什么（即 - 引用是否保存在某处？）。所以，我用谷歌搜索“perl tie”现有变量“”。不幸的是，我发现的链接在社会上是不可接受的（盗版材料），所以我几乎不存在了，声誉明智。

不过，祝你好运。

无论如何，只是为了澄清一下，它在“高级 Perl 编程”的第 9 章，即“Tie”一章中。确保您从信誉良好的网站购买副本 :-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-26T14:00:40.843

这是可行的。我认为执行以下操作可能会降低性能，并且我确定我没有涵盖所有可能的情况，但这绝对可以帮助您入门。

```
use strict;
use warnings;

tie %ENV, 'change_noticer', %ENV or die $!;

$ENV{PATH} .= ":test";
print $ENV{PATH}, "\n";
delete $ENV{PATH};

package change_noticer;

use strict;
use warnings;
use Carp;
use Tie::Hash;
use base 'Tie::StdHash';

sub DELETE {
    my $this = shift;

    carp "deleting \$ENV{$_[0]}";
    $this->SUPER::DELETE(@_);
}

sub STORE {
    my $this = shift;

    carp "altering \$ENV{$_[0]}";
    $this->SUPER::STORE(@_);
}

sub TIEHASH {
    my $class = shift;
    my $this  = bless {}, $class;

    while( my ($k,$v) = splice @_, 0, 2 ) {
        $this->{$k} = $v;
    }

    return $this;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-26T17:00:48.930

[Variable::Magic](http://search.cpan.org/perldoc?Variable::Magic)似乎有效，但与绑定哈希不同，它似乎没有为您提供价值。

```
use 5.010;
use Carp            qw<carp>;
use Variable::Magic qw<cast wizard>;

my $magic_hash = wizard store => sub { 
    carp "Hey! They're trying to set $_[-1]!"; 
};

cast %ENV, $magic_hash;

$ENV{HOME} = '~evilhacker'; 
```

如果我后来掏出，它似乎正确设置了环境变量，所以我不只是 clobber `%ENV`：

```
say `echo HOME=\$HOME`;
say `echo HOME=%HOME%`; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-26T00:00:15.417

我唯一能想到的是创建一个名为的绑定变量`%ENVIRONMENT`，它充当`%ENV`您可以挂钩的接口。然后使用确保您始终使用`%ENVIRONMENT`而不是`%ENV`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-27T18:33:25.017

另一件事要尝试，在字里行间阅读：不是为要运行的任务调用“system(...)”，而是实现一个“my_system(...)”，在调用外部任务之前打印出环境，这样您*可以*使用命令行中的“env ...”命令重新创建其中一项任务

```
# show the environment in which an external command runs:
sub my_system
    {
    print map { $_ . "='" . $ENV{ $_ } . "'\n" } keys( %ENV);
    print "'" . join( "' '", @_) . "'\n";
    return system( @_);
    } 
```

# ruby-on-rails - 你如何处理 ActiveSupport::JSON 和 JSON gem 之间的冲突？

> ID：683989
> 
> 赞同：16
> 
> 时间：2009-03-25T23:51:45.237
> 
> 标签：ruby-on-rails, ruby, json, activesupport

我被这个问题难住了。

`ActiveSupport::JSON`定义`to_json`了各种核心对象，JSON gem 也是如此。但是，实现并不相同——ActiveSupport 版本带有参数，而 JSON gem 版本则没有。

我安装了一个需要 JSON gem 的 gem，但我的应用程序坏了。问题是我`to_json`在返回对象列表的控制器中使用，但我想控制返回哪些属性。

当我系统中任何地方的代码时，`require 'json'`我都会收到此错误消息：

`TypeError: wrong argument type Hash (expected Data)`

我尝试了一些我在网上阅读的东西来修复它，但没有任何效果。我最终重新编写了 gem 来使用`ActiveSupport::JSON.decode`而不是`JSON.parse`.

这可行，但不可持续……每次我想使用需要 JSON gem 的 gem 时，我都不能分叉 gem。

**更新：**这个问题的最佳解决方案是升级到 Rails 2.3 或更高版本，它修复了它。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-07-19T22:23:26.313

**更新**：即使使用 Rails 3.2，同样的问题仍未解决。就是强行加载 json gem 并覆盖它的讨厌的 hack。

最终我得到了下面的代码，完全绕过了 ActiveSupport 的`to_json`。把它放进去`config/initializers/patches.rb`，就可以做`{}.jsonize`或者`[].jsonize`生成JSON字符串了。保证不会与任何事物发生冲突。

```
# Undo the effect of 'active_support/core_ext/object/to_json'
require 'json'
[Object, Array, Hash].each do |klass|
  klass.class_eval <<-RUBY, __FILE__, __LINE__
    def jsonize(options = nil)
      ::JSON.generate self, :quirks_mode => true
    end
  RUBY
end 
```

这 8 行代码使您的应用程序的 JSON 编码速度提高了**50 倍**。可能你也想做同样的事情。:)

* * *

在 Rails 2.3.8 之前，我一直有类似的问题。

问题是这`ActiveSupport::JSON.backend = 'JSONGem'`是一个半途而废的解决方案，您仍然需要自己覆盖一些编码器。（**警告**：对于使用 MultiJson 的 Rails 3.x，它必须`ActiveSupport::JSON.backend = :json_gem`至少是，否则它将默默无操作。）

就我而言，我需要覆盖`String#to_json`，因为 JSON gem 1.4.3 更好，因为它不会以不必要的形式盲目编码非 ascii-but-valid-UTF8 字符`"\uXXXX"`，因此您可以获得更短的字节（好用于序列化）和易于阅读的结果（`"日本語"`在我看来比 看起来更性感`"\u65e5\u672c\u8a9e"`）。

这是我一直在使用的猴子补丁 - 将以下代码放入`config/initializers/patches.rb`

```
module ActiveSupport
  module JSON
    module Encoding
      class << self
        def escape(string)
          ::JSON.generate([string])[1..-2]
        end
      end
    end
  end
end 
```

你可以自由地使用`to_json`任何东西——字符串、数组和哈希。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T19:10:52.553

**更新** *此修复仅适用于 Rails < 2.3。正如 Giles 下面提到的，他们在 2.3 内部使用几乎相同的技术修复了这个问题。但要注意 json gem 早期在 Rails 兼容性方面的尝试*( `json/add/rails`) *，如果需要，它会再次破坏一切。*

您的意思是该`require 'json'`语句本身引发了该异常吗？或者你的意思是当你打电话时`@something.to_json(:something => value)`你得到错误？后者是我所期望的，如果您在需要 JSON gem 时遇到问题，那么我不确定发生了什么。

我刚刚遇到了 oauth gem 的这个问题。就我而言，没有真正的冲突，因为 oauth gem 不依赖于`to_json`实现。因此，问题在于 JSON 正在破坏 ActiveSupport 声明。我通过在加载 ActiveSupport 之前简单地要求 json 解决了这个问题。推杆

```
require 'json' 
```

在里面`Rails::Initializer`做了诀窍（虽然把它放在块之后没有）。

这允许 ActiveSupport 破坏默认的 JSON 实现。

现在，如果您使用的是实际上依赖于 JSON 实现的 gem，`to_json`那么您将陷入困境。这绝对是元编程中最糟糕的，我会提倡 Rails 和 JSON gem 开发人员解决冲突，尽管这会很痛苦，因为其中一个必须破坏向后兼容性。

在短期内，gem 作者可能能够通过支持这两种实现来弥合差距。这或多或少是可行的，具体取决于 gem 如何使用该方法。最坏的情况是官方分叉（即`gem`和`gem-rails`）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-07T20:16:09.053

经过一段时间的斗争......我发现最简单的解决方案是：

```
if defined?(ActiveSupport::JSON)
  [Object, Array, FalseClass, Float, Hash, Integer, NilClass, String, TrueClass].each do |klass|
   klass.class_eval do
    def to_json(*args)
      super(args)
    end
    def as_json(*args)
      super(args)
    end
   end
  end
end 
```

加载activesupport后将其放在任何地方..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-04T19:39:37.707

我很确定他们在 2.3 中修复了这个问题，但我不记得如何了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-20T09:41:08.250

我还没有尝试过，但看起来 Rails 2.3.3 给了你一些控制：

```
ActiveSupport::JSON.backend = 'JSONGem' 
```

[在这里找到](http://weblog.rubyonrails.org/2009/7/20/rails-2-3-3-touching-faster-json-bug-fixes)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-03T23:25:32.637

在我的特殊情况下，我有一个 Ruby（非 Rails）应用程序，它实际上加载了一个 Rails 应用程序（来自 config/environment.rb 加载）以及一些引用 json 的 gem。这让我非常头疼，因为我不能简单地更改 Rails 应用程序的 environment.rb 文件。我最终分叉了许多 gem，以便让 json 工作而不会引发可怕的 TypeError: wrong argument type Hash (expected Data) 消息。

我对这个解决方案很幸运，这与上面社区维基的答案完全相反...... [http://blog.swivel.com/code/2009/03/active-support-and-json-gems-dont- play-nice.html](http://blog.swivel.com/code/2009/03/active-support-and-json-gems-dont-play-nice.html) 基本上主张 在 require 'json'*之前调用 require 'active_support'*

这是我让它发挥作用的唯一方法，相信我，我已经尝试了很多个月。

# asp.net - 使用带有表单身份验证的母版页的安全 asp.net 站点

> ID：683993
> 
> 赞同：1
> 
> 时间：2009-03-25T23:52:54.080
> 
> 标签：asp.net, authentication, forms, master-pages

我在 asp.net 应用程序的根文件夹中有一个母版页，在子文件夹中有内容页面。我正在使用表单身份验证，但不确定在 web.config 中为母版页做什么。表单身份验证是否保护子页面或母版页？

它是如何工作的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T00:09:49.653

不`Web.config`，授权基于请求页面的 URL。它与母版页完全无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T00:34:06.990

web.config 授权会影响页面的 URL。所以 .aspx、.ashx 或其他任何可以由在 IIS 下运行的 ASP.NET “提供”的东西。

未提供的页面（.config、.master 等）不受身份验证保护，但也不会提供。

您应该知道其他静态页面（.css、.js、.gif、.png 等）不受身份验证的影响，除非您将 IIS 配置为让 ASP.NET 处理这些页面。

# bash - 为什么我可以使用 000 权限运行 Bash 函数？

> ID：683994
> 
> 赞同：2
> 
> 时间：2009-03-25T23:52:58.883
> 
> 标签：bash, file-permissions

我可以运行具有 000 权限的 Bash 函数并不完全正确，但差不多。我的代码是：

```
#!/bin/bash
function hello {
echo Hello! } 
```

hello 文件具有以下权限：

```
-r--------  1 UnixBasics hello_file 
```

首先，我使用当前权限键入：

```
$ . ./hello_file;hello 
```

调整是在运行 bash 脚本之前将 400 权限更改为 000：

```
$ chmod 000 hello_file
$ . ./hello_file;hello                                             [1]
-bash: ./hello_file: Permission denied 
Hello! 
```

它给出了一个错误，但它不会停止运行该函数。我无法理解。我现在取消设置你好功能：“取消设置你好”。我收到错误：

```
-bash: ./hello_file: Permission denied
-bash: hello: command not found 
```

为什么我第一次没有得到它们？它与缓存、缓冲区或类似的东西有关吗？为什么我可以使用 000 权限 [1] 运行 Bash 脚本？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T23:59:06.420

您**不是**在运行脚本，而是在**采购**（包括）它。为了获取脚本，您只需要读取权限。

顺便说一句，函数只是存在，它们没有权限。一旦获取了文件并定义了函数，您就可以根据需要运行它。

* * *

更新：

> 为什么我第一次没有得到它们？它与缓存、缓冲区或类似的东西有关吗？

是的，就像 Pax 回答的那样，你好可能是以前从文件的先前来源中定义的。您可能会对 sourcing（“.”内置命令）的作用感到困惑。Sourcing 读取文件并在当前 shell 中运行它的所有命令，然后返回到提示符。因此，如果您运行该文件一次，它的函数会在当前 shell 实例中定义，并且它们会一直保留在那里，直到您完成该 shell 会话（或取消设置它们）。

> 为什么我可以使用 000 权限 [1] 运行 Bash 脚本？

你不能。请注意，它会显示错误。引用您的输出：

```
$ . ./hello_file;hello                                             [1]
-bash: ./hello_file: Permission denied 
Hello! 
```

您在一个命令行中执行了两个命令。采购失败并显示“权限被拒绝”。“你好！” 输出来自文件的先前来源。当您取消设置并再次尝试相同的命令行时，您只是自己证明了这一点。

你不能称之为缓存......这就是shell的工作方式。您获取另一个文件，它的所有定义都包含在当前的 shell 会话中并留在那里。如果您实际**运行**脚本（不是采购），则不应在当前会话中获得任何残留物。

```
$ chmod +x hello_file
$ ./hello_file           # note: executed, not sourced
$ hello
-bash: hello: command not found 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-26T00:02:19.720

最可能的解释是您在 hello_file 受到保护之前运行了它，并且该函数已经创建。然后你保护了你的脚本（你在命令中说 100 但在文本中提到 000）。

因此，脚本将不会运行。但是 hello() 仍然是从您之前的运行中定义的。

尝试打开一个新的 shell 或只执行`unset hello`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-26T00:04:28.730

在将模式更改为 100 之前，您是否获取了脚本（即运行“../hello_file”）？如果是这种情况，那么“hello”函数仍然只是加载到 bash 中。随后尝试获取不可读文件不会改变这一点。要正确测试，请确保启动*新*的shell。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-26T00:12:43.453

为了运行程序（无论是 bash 脚本还是二进制可执行文件），您需要具有执行权限。当您输入命令时，第一个单词（`./foo`如下所示）指定要运行的命令，并且作为单独的进程启动；对于 shell 脚本，它执行`#!`行中列出的 shell 解释器的新副本，并使用该解释器运行程序。

```
$ ls -l foo
-rw-r--r-- 1 lambda lambda 23 Mar 25 20:02 foo
$ chmod 744 foo # 或 chmod u+x foo
$ ls -l foo
-rwxr--r-- 1 lambda lambda 23 Mar 25 20:02 foo
$ ./foo
你好

```

当您使用该`.`命令时，它是一个 shell 内置命令，表示将文件导入当前 shell；这意味着它执行文件中的命令，就好像您从命令行运行它们一样，就在当前文件中。您只需要读取权限即可获取文件。例如，如果您在子进程中设置了一个变量，它不会改变当前 shell 中的值；但是，如果您将 bash 脚本输入到当前 shell 中，那么它确实会更改值：

```
$ foo=bar
$ cat 设置变量
#!/bin/sh

富=你好
$ ./setvariables
$ 回声 $foo
酒吧
$ . ./set变量
$ 回声 $foo
你好

```

shell 函数（如您的示例中）很像一个变量，但它的作用就像当前 shell 中的一个命令。因此，当您获取`hello_file`using时`.`，它会在当前 shell 中定义该函数，并且它可以像您定义的任何其他 shell 函数一样执行。

就权限而言，我敢打赌，在将权限更改为 100 之前（这意味着只能执行，不可读，这对于文件来说是相当无用的，因为您需要能够读取并执行它来做任何事情） ，您已经将文件导入到当前的 shell 中。这意味着该函数已经定义，并且定义后文件的权限无关紧要；一旦在当前shell中定义了函数，你甚至可以删除文件，只要那个shell仍然打开，函数仍然会被定义。

编辑：正如我从您编辑的问题中看到的那样，一旦您取消设置该功能，就会出现错误。这向我强烈表明我的假设是正确的，并且您在更改权限之前已经获取了该文件。正如我所解释的，获取和执行文件是完全不同的操作，一旦你获取了一个文件，它的权限（或存在）就无关紧要了。该函数已加载到当前运行的 shell 中。`unset hello`您可以通过在执行;之后运行您的原始实验来判断。如果你`chmod 000`这样做，你不应该有读取权限，然后函数就不会被定义。

# c# - LINQ 复合选择问题

> ID：683995
> 
> 赞同：5
> 
> 时间：2009-03-25T23:53:06.543
> 
> 标签：c#, linq

我无法编译 LINQ 复合选择。这是代码：

```
int[] numbersA = { 0, 2, 4, 5, 6, 8, 9 };
int[] numbersB = { 1, 3, 5, 7, 8 };

var pairs =
    from a in numbersA,
            b in numbersB
    where a < b
    select new {a, b}; 
```

代码来自此处的教程，标题为“SelectMany - Compound from 1”：

[http://msdn.microsoft.com/en-us/vcsharp/aa336758.aspx#SelectSimple1](http://msdn.microsoft.com/en-us/vcsharp/aa336758.aspx#SelectSimple1)

我得到的编译时错误如下：

查询主体必须以 select 子句或 group 子句结尾

'numbersA' 后面的逗号是发生错误的地方。现在我无法弄清楚我做错了什么，因为这只是 MS 网站上的代码。任何帮助都会非常感谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-25T23:58:21.477

您的代码不是有效的 LINQ 表达式。`from`子句仅支持单个集合。您应该重复整个`from`子句。你可能是想说：

```
var pairs = from a in numbersA
            from b in numbersB
            where a < b
            select new {a, b}; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-26T02:08:41.163

使用[SelectMany](http://www.hookedonlinq.com/SelectManyOperator.ashx)的等效流利语法，仅作记录：

```
var pair = numbersA.SelectMany(a => numbersB, (a, b) => new {a, b})
                   .Where(n => n.a < n.b); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T23:59:11.053

如果我正确理解您的意图，那么您需要另一个。

像这样：

```
var pairs =
    from a in numbersA // Comma removed from end of line here
    from b in numbersB // additional "from" keyword at start of line
    where a < b
    select new {a, b}; 
```

# c# - 测试写作策略建议

> ID：683999
> 
> 赞同：4
> 
> 时间：2009-03-25T23:54:58.020
> 
> 标签：c#, unit-testing, tdd, test-first

所以，这些天我越来越沉迷于测试驱动的开发，我在思考 tdd 时编写的代码越多，似乎我必须做出的关于我应该编写的测试范围的决定就越多。我想为我自己的项目编写多少单元测试设置一个个人策略，并且想知道我是否可以就你们采取什么样的方法获得一些建议。

这是我目前面临的决定的一个例子......

我有三个班...

```
public class User
{
    public string Username { get; set; }
    public List<Favorite> Favorties { get; set; }
}

public class Favorite
{
    public string Username { get; set; }
    public int rank { get; set; }
}

public class UserManager
{
    public List<Favorite> GetTop5(User user)
    {
        var qry = from fav in user.Favorties.OrderBy(f => f.rank)
                  select fav;

        return qry.Take<Favorite>(5).ToList();
    }
} 
```

我有一个用户类的数据访问层，我已经有一个“GetUser”测试设置。如您所见，在我的业务逻辑中，我有一个方法 UserManager.GetTop5()，它返回我刚刚从数据库中拉出的用户的前 5 个收藏夹。此方法非常简单，目前不涉及任何外部资源或依赖项。

所以我的问题是，即使失败的可能性很小，你会继续为这个“GetTop5”功能点编写另一个测试吗？

如果您将来扩展功能，您是否仍然设置了测试？还是您认为这里的测试过度？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T00:03:46.987

你不会相信这一点，但这就是 Kent Beck 不得不说的，就在 StackOverflow 上：

“我为有效的代码而不是测试获得报酬，所以我的理念是尽可能少地测试以达到给定的信心水平（我怀疑这种信心水平与行业标准相比很高，但这可能只是狂妄自大). 如果我通常不会犯某种错误（例如在构造函数中设置错误的变量），我不会对其进行测试。”

链接：[链接：](https://stackoverflow.com/questions/153234/how-deep-are-your-unit-tests/153565#153565)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T23:57:25.440

*在进行 TDD 时，我为每个功能*至少编写一个单元测试。

那么，GetTop5 是一个功能吗？如果是这样，它值得测试。如果它不是一个特性，那么它就不需要存在;-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T23:59:01.787

事后编写测试的好点！如果您首先实现这些功能然后对其进行测试，那会感觉很奇怪。这就是为什么您应该首先编写测试然后实现功能的原因。此外，这将迫使您考虑如何使用您的功能。此外，如果您首先实现您想要实现的任何东西，您会发现自己处于代码难以测试的情况。再次，测试优先的方法对此有所帮助，如果您在实际实现函数之前开始实现测试，则代码将更具可测试性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-26T00:02:46.007

是的，我也会为该方法编写一个测试，通常你应该测试你实现的功能。请记住，TDD 不仅用于测试方法是否有效，您还应该测试它如何处理异常，例如如果它获得 Null 作为用户对象会发生什么。

使用 TDD 进行开发时，您实际上是在设计团队其他成员必须使用的 API，因此 TDD 允许您编写您希望 API 的使用方式，这意味着它的调用方式以及错误的处理方式。对于更复杂的方法，您可能希望返回您自己的自定义异常，以便更清楚地知道出了什么问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-26T09:53:24.353

我测试大多数东西。

每当我编写测试时，我也会认为测试是关于如何使用我的代码的文档或说明，供我和其他人在未来阅读。

虽然我不测试实现。我希望能够在不更改测试的情况下更改实现。

我已经使用 TDD 可能有一两年了，所以也许我会成熟并停止。不过，到目前为止，我仍在学习并认为我没有编写足够的测试。*************