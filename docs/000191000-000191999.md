# StackOverflow 问答 000191000-000191999

# css - 如何自定义浏览器的打印/打印预览输出？

> ID：191004
> 
> 赞同：8
> 
> 时间：2008-10-10T12:15:20.200
> 
> 标签：css, browser, printing

当从浏览器发生打印（或打印预览）时，我试图动态隐藏某些 DIV。

我可以通过两种样式表轻松区分静态，一张用于普通样式表，一张用于打印媒体：

但是我需要更进一步，当打印样式表在打印期间根据某些标准变为活动状态时动态隐藏一些元素

轻松解决它的一种方法是处理 DOM 事件以处理打印/打印视图，然后我可以使用 jQuery 更改显示：需要隐藏的类上的无，但我找不到 DOM 打印事件！！

有谁知道解决方案是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T12:24:59.540

并非所有浏览器都允许您捕获打印事件。我已经看到通过添加“打印此页面”链接然后使用该单击事件来完成您需要的事情来解决这个问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T20:06:08.517

我认为您不需要打印活动。您需要做的就是`@media print`根据您的 Javascript(?) 标准调整样式。当用户尝试打印页面时，`@media print`样式将应用并且您的样式将生效：

```
<html>
<head>
<style id="styles" type="text/css">
@media print { .noprint { display:none; } }
</style>
<script type="text/javascript">
var x = Math.random();

if (x > .5) {
    var style = document.createElement('style');
    style.type = 'text/css';
    style.innerHTML = '@media print { .maybe_noprint { display:none; } }';
    document.getElementsByTagName('head')[0].appendChild(style);
}
</script>
</head>
<body>
<div class="noprint">This will never print.</div>
<span class="maybe_noprint">This may print depending on the value of x.</span>
</body>
</html> 
```

如果您使用服务器端标准来确定打印的内容，那么只需吐出服务器端代码`@media print`来根据需要装饰类。此外，您可能需要考虑修改已经存在的现有类`@media print`，或者使用除 之外的其他内容构建新的 CSS `innerHTML`，我承认这对我来说很糟糕，但似乎在 Opera 9.6、Safari for Windows 3.1.2 中有效, IE 6 和 Firefox 2.0.0.17（我没有测试任何其他浏览器）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-10T13:20:48.337

只需使用隐藏在打印样式表中的类标记这些 DIV：

**HTML**

```
<div id='div19' class='noprint'>
  ...
</div> 
```

**打印.css**

```
.noprint {
  display: none;
} 
```

如果您事先不知道需要隐藏哪些元素，可以使用 javascript 为给定对象设置类：

**Javascript**

```
document.getElementById('div19').className='noprint'; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T12:22:02.260

IE 中有一个[onbeforeprint](http://msdn.microsoft.com/en-us/library/ms536906(VS.85).aspx)事件。其他主流浏览器似乎不支持它。（我测试了 Firefox 3.0.3 和 Safari 3.1.2。）

# python - 如何获取对象的方法和属性的完整列表？

> ID：191010
> 
> 赞同：246
> 
> 时间：2008-10-10T12:18:32.580
> 
> 标签：python

```
dir(re.compile(pattern)) 
```

不返回模式作为列表的元素之一。即它返回：

```
['__copy__', '__deepcopy__', 'findall', 'finditer', 'match', 'scanner', 'search', 'split', 'sub', 'subn'] 
```

根据手册，它应该包含

> 对象的属性名称，其类属性的名称，以及其类的基类属性的递归名称。

它还说

> 该列表不一定是完整的。

有没有办法获得**完整**的清单？我一直认为 dir 返回一个完整的列表，但显然它没有......

另外：有没有办法只列出属性？还是只有方法？

*编辑：这实际上是python中的一个错误->据说它已在 3.0 分支中修复（也可能在 2.6 中）*

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2008-10-10T12:25:22.613

对于**完整**的属性列表，简短的回答是：不。问题是属性实际上被定义为`getattr`内置函数接受的参数。由于用户可以重新实现`__getattr__`，突然允许任何类型的属性，没有可能的通用方法来生成该列表。该`dir`函数返回属性中的键，即如果方法没有重新实现`__dict__`，所有可访问的属性。`__getattr__`

对于第二个问题，它并没有真正的意义。实际上，方法是可调用的属性，仅此而已。您可以过滤可调用属性，并使用`inspect`模块确定类方法、方法或函数。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2008-10-10T14:46:09.210

这就是为什么`__dir__()`在 python 2.6 中添加了新方法

看：

*   [http://docs.python.org/whatsnew/2.6.html#other-language-changes](http://docs.python.org/whatsnew/2.6.html#other-language-changes)（向下滚动一点）
*   [http://bugs.python.org/issue1591665](http://bugs.python.org/issue1591665)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-04-25T10:19:45.810

这是 PierreBdR 和 Moe 答案的实用补充：

*   对于 Python >= 2.6 和*new-style classes*，`dir()`似乎就足够了。
*   对于*老式的 classes*，我们至少可以做一个[标准模块](http://docs.python.org/library/rlcompleter.html)所做的来支持 tab 补全：除了`dir()`，查找`__class__`，然后去查找它的`__bases__`：

    ```
    # code borrowed from the rlcompleter module
    # tested under Python 2.6 ( sys.version = '2.6.5 (r265:79063, Apr 16 2010, 13:09:56) \n[GCC 4.4.3]' )

    # or: from rlcompleter import get_class_members
    def get_class_members(klass):
        ret = dir(klass)
        if hasattr(klass,'__bases__'):
            for base in klass.__bases__:
                ret = ret + get_class_members(base)
        return ret

    def uniq( seq ): 
        """ the 'set()' way ( use dict when there's no set ) """
        return list(set(seq))

    def get_object_attrs( obj ):
        # code borrowed from the rlcompleter module ( see the code for Completer::attr_matches() )
        ret = dir( obj )
        ## if "__builtins__" in ret:
        ##    ret.remove("__builtins__")

        if hasattr( obj, '__class__'):
            ret.append('__class__')
            ret.extend( get_class_members(obj.__class__) )

            ret = uniq( ret )

        return ret 
    ```

（为简洁起见，删除了测试代码和输出，但基本上对于新样式的对象，我们似乎有与 for 相同的结果`get_object_attrs()`，`dir()`而对于旧样式的类，输出的主要补充`dir()`似乎是`__class__`属性。）

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-10-17T03:42:25.593

仅补充：

1.  `dir()`是**最**强大/最基础的工具。（**最推荐**）
2.  解决方案**不仅仅是**`dir()`提供**处理**.**`dir()`**

    是否列出第 2 级属性，重要的是自己进行筛选，因为有时您可能希望筛选出带有前导下划线的内部变量`__`，但有时您可能需要`__doc__`文档字符串。

3.  `__dir__()`并`dir()`返回相同的内容。
4.  `__dict__`并且`dir()`是不同的。`__dict__`返回不完整的内容。
5.  **重要提示**：`__dir__()`作者出于任何目的有时可以用函数、值或类型覆盖。

    这是一个例子：

    ```
    \\...\\torchfun.py in traverse(self, mod, search_attributes)
    445             if prefix in traversed_mod_names:
    446                 continue
    447             names = dir(m)
    448             for name in names:
    449                 obj = getattr(m,name) 
    ```

    **TypeError：对象的描述符`__dir__`需要`'object'`一个参数**

    PyTorch 的作者将该`__dir__()`方法修改为需要参数的方法。此修改`dir()`失败。

6.  如果您想要一个**可靠**的方案来遍历对象的所有属性，请记住每个 pythonic 标准**都可以被覆盖并且可能不成立**，并且每个约定都可能不可靠。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-09-02T07:07:45.923

我就是这样做的，这对于您不断添加属性的简单自定义对象很有用：

`obj = type("Obj",(object,),{})`给定一个用或简单地创建的对象：

```
class Obj: pass
obj = Obj() 
```

添加一些属性：

```
obj.name = 'gary'
obj.age = 32 
```

然后，获取仅包含自定义属性的字典：

```
{key: value for key, value in obj.__dict__.items() if not key.startswith("__")}

# {'name': 'gary', 'age': 32} 
```

# c# - 匿名类可以实现接口吗？

> ID：191013
> 
> 赞同：491
> 
> 时间：2008-10-10T12:20:32.670
> 
> 标签：c#, anonymous-types

是否可以让匿名类型实现接口？

我有一段我想工作的代码，但不知道该怎么做。

我有几个答案要么说不，要么创建一个实现接口的类构造新实例。这不是很理想，但我想知道是否有一种机制可以在接口之上创建一个瘦动态类，这会使这变得简单。

```
public interface DummyInterface
{
    string A { get; }
    string B { get; }
}

public class DummySource
{
    public string A { get; set; }
    public string C { get; set; }
    public string D { get; set; }
}

public class Test
{
    public void WillThisWork()
    {
        var source = new DummySource[0];
        var values = from value in source
                     select new
                     {
                         A = value.A,
                         B = value.C + "_" + value.D
                     };

        DoSomethingWithDummyInterface(values);

    }

    public void DoSomethingWithDummyInterface(IEnumerable<DummyInterface> values)
    {
        foreach (var value in values)
        {
            Console.WriteLine("A = '{0}', B = '{1}'", value.A, value.B);
        }
    }
} 
```

我发现一篇文章[动态接口包装](http://channel8.msdn.com/Posts/Adding-some-dynamic-to-C-interface-wrapping/)描述了一种方法。这是最好的方法吗？

* * *

## 回答 #1

> 赞同：376
> 
> 时间：2008-10-10T12:30:48.547

不，匿名类型不能实现接口。从[C# 编程指南](http://msdn.microsoft.com/en-us/library/bb397696.aspx)：

> 匿名类型是由一个或多个公共只读属性组成的类类型。不允许使用其他类型的类成员，例如方法或事件。匿名类型不能转换为除对象之外的任何接口或类型。

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2010-09-17T11:07:24.567

虽然线程中的答案都是真实的，但我无法抗拒告诉你实际上**可以**让匿名类实现接口的冲动，即使它需要一些创造性的作弊才能到达那里。

早在 2008 年，我正在为我当时的雇主编写一个自定义 LINQ 提供程序，有一次我需要能够将“我的”匿名类与其他匿名类区分开来，这意味着让它们实现一个我可以用来进行类型检查的接口他们。我们解决它的方法是使用方面（我们使用[PostSharp](https://www.postsharp.net/)），直接在 IL 中添加接口实现。所以，事实上，**让匿名类实现接口是可行**的，你只需要稍微改变一下规则就可以了。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2008-11-03T06:32:07.203

将匿名类型转换为接口一直是我想要的一段时间，但不幸的是，当前的实现迫使您拥有该接口的实现。

最好的解决方案是使用某种类型的动态代理来为您创建实现。使用优秀的[LinFu 项目](http://www.codeproject.com/KB/cs/LinFuPart1.aspx)，您可以替换

```
select new
{
  A = value.A,
  B = value.C + "_" + value.D
}; 
```

和

```
 select new DynamicObject(new
 {
   A = value.A,
   B = value.C + "_" + value.D
 }).CreateDuck<DummyInterface>(); 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2014-11-09T05:08:22.123

匿名类型可以通过动态代理实现接口。

[我在GitHub 上](https://github.com/jcbowers/DuckTyping)写了一个扩展方法和一篇博文[http://wblo.gs/feE](http://wblo.gs/feE)来支持这个场景。

该方法可以这样使用：

```
class Program
{
    static void Main(string[] args)
    {
        var developer = new { Name = "Jason Bowers" };

        PrintDeveloperName(developer.DuckCast<IDeveloper>());

        Console.ReadKey();
    }

    private static void PrintDeveloperName(IDeveloper developer)
    {
        Console.WriteLine(developer.Name);
    }
}

public interface IDeveloper
{
    string Name { get; }
} 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-10-10T12:25:22.427

不; 匿名类型除了具有一些属性外，不能做任何事情。您将需要创建自己的类型。我没有深入阅读链接的文章，但看起来它使用 Reflection.Emit 动态创建新类型；但是，如果您将讨论限制*在 C# 本身内*的事情上，您将无法做您想做的事情。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-10-10T12:55:16.110

最好的解决方案就是不使用匿名类。

```
public class Test
{
    class DummyInterfaceImplementor : IDummyInterface
    {
        public string A { get; set; }
        public string B { get; set; }
    }

    public void WillThisWork()
    {
        var source = new DummySource[0];
        var values = from value in source
                     select new DummyInterfaceImplementor()
                     {
                         A = value.A,
                         B = value.C + "_" + value.D
                     };

        DoSomethingWithDummyInterface(values.Cast<IDummyInterface>());

    }

    public void DoSomethingWithDummyInterface(IEnumerable<IDummyInterface> values)
    {
        foreach (var value in values)
        {
            Console.WriteLine("A = '{0}', B = '{1}'", value.A, value.B);
        }
    }
} 
```

请注意，您需要将查询结果转换为接口的类型。可能有更好的方法来做到这一点，但我找不到。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2014-07-18T10:58:36.350

具体提出的问题的答案是否定的。但是您是否一直在研究模拟框架？我使用最小起订量，但那里有数百万个，它们允许您在线实现/存根（部分或全部）接口。例如。

```
public void ThisWillWork()
{
    var source = new DummySource[0];
    var mock = new Mock<DummyInterface>();

    mock.SetupProperty(m => m.A, source.Select(s => s.A));
    mock.SetupProperty(m => m.B, source.Select(s => s.C + "_" + s.D));

    DoSomethingWithDummyInterface(mock.Object);
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-04-10T21:44:20.147

另一种选择是创建一个在构造函数中采用 lambda 的单个具体实现类。

```
public interface DummyInterface
{
    string A { get; }
    string B { get; }
}

// "Generic" implementing class
public class Dummy : DummyInterface
{
    private readonly Func<string> _getA;
    private readonly Func<string> _getB;

    public Dummy(Func<string> getA, Func<string> getB)
    {
        _getA = getA;
        _getB = getB;
    }

    public string A => _getA();

    public string B => _getB();
}

public class DummySource
{
    public string A { get; set; }
    public string C { get; set; }
    public string D { get; set; }
}

public class Test
{
    public void WillThisWork()
    {
        var source = new DummySource[0];
        var values = from value in source
                     select new Dummy // Syntax changes slightly
                     (
                         getA: () => value.A,
                         getB: () => value.C + "_" + value.D
                     );

        DoSomethingWithDummyInterface(values);

    }

    public void DoSomethingWithDummyInterface(IEnumerable<DummyInterface> values)
    {
        foreach (var value in values)
        {
            Console.WriteLine("A = '{0}', B = '{1}'", value.A, value.B);
        }
    }
} 
```

如果您要做的只是转换`DummySource`为`DummyInterface`，那么只有一个`DummySource`在构造函数中采用 a 并实现接口的类会更简单。

但是，如果您需要将许多类型转换为`DummyInterface`，那么样板代码就少得多了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-09-12T13:31:01.943

使用 Roslyn，您可以动态创建从接口（或抽象类）继承的类。

我使用以下内容从抽象类创建具体类。

在这个例子中，AAnimal 是一个抽象类。

```
var personClass = typeof(AAnimal).CreateSubclass("Person"); 
```

然后你可以实例化一些对象：

```
var person1 = Activator.CreateInstance(personClass);
var person2 = Activator.CreateInstance(personClass); 
```

毫无疑问，这并不适用于所有情况，但它应该足以让你开始：

```
using Microsoft.CodeAnalysis;
using Microsoft.CodeAnalysis.CSharp;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Reflection;

namespace Publisher
{
    public static class Extensions
    {
        public static Type CreateSubclass(this Type baseType, string newClassName, string newNamespace = "Magic")
        {
            //todo: handle ref, out etc.
            var concreteMethods = baseType
                                    .GetMethods()
                                    .Where(method => method.IsAbstract)
                                    .Select(method =>
                                    {
                                        var parameters = method
                                                            .GetParameters()
                                                            .Select(param => $"{param.ParameterType.FullName} {param.Name}")
                                                            .ToString(", ");

                                        var returnTypeStr = method.ReturnParameter.ParameterType.Name;
                                        if (returnTypeStr.Equals("Void")) returnTypeStr = "void";

                                        var methodString = @$"
                                        public override {returnTypeStr} {method.Name}({parameters})
                                        {{
                                            Console.WriteLine(""{newNamespace}.{newClassName}.{method.Name}() was called"");
                                        }}";

                                        return methodString.Trim();
                                    })
                                    .ToList();

            var concreteMethodsString = concreteMethods
                                        .ToString(Environment.NewLine + Environment.NewLine);

            var classCode = @$"
            using System;

            namespace {newNamespace}
            {{
                public class {newClassName}: {baseType.FullName}
                {{
                    public {newClassName}()
                    {{
                    }}

                    {concreteMethodsString}
                }}
            }}
            ".Trim();

            classCode = FormatUsingRoslyn(classCode);

            /*
            var assemblies = new[]
            {
                MetadataReference.CreateFromFile(typeof(object).Assembly.Location),
                MetadataReference.CreateFromFile(baseType.Assembly.Location),
            };
            */

            var assemblies = AppDomain
                        .CurrentDomain
                        .GetAssemblies()
                        .Where(a => !string.IsNullOrEmpty(a.Location))
                        .Select(a => MetadataReference.CreateFromFile(a.Location))
                        .ToArray();

            var syntaxTree = CSharpSyntaxTree.ParseText(classCode);

            var compilation = CSharpCompilation
                                .Create(newNamespace)
                                .AddSyntaxTrees(syntaxTree)
                                .AddReferences(assemblies)
                                .WithOptions(new CSharpCompilationOptions(OutputKind.DynamicallyLinkedLibrary));

            using (var ms = new MemoryStream())
            {
                var result = compilation.Emit(ms);
                //compilation.Emit($"C:\\Temp\\{newNamespace}.dll");

                if (result.Success)
                {
                    ms.Seek(0, SeekOrigin.Begin);
                    Assembly assembly = Assembly.Load(ms.ToArray());

                    var newTypeFullName = $"{newNamespace}.{newClassName}";

                    var type = assembly.GetType(newTypeFullName);
                    return type;
                }
                else
                {
                    IEnumerable<Diagnostic> failures = result.Diagnostics.Where(diagnostic =>
                        diagnostic.IsWarningAsError ||
                        diagnostic.Severity == DiagnosticSeverity.Error);

                    foreach (Diagnostic diagnostic in failures)
                    {
                        Console.Error.WriteLine("{0}: {1}", diagnostic.Id, diagnostic.GetMessage());
                    }

                    return null;
                }
            }
        }

        public static string ToString(this IEnumerable<string> list, string separator)
        {
            string result = string.Join(separator, list);
            return result;
        }

        public static string FormatUsingRoslyn(string csCode)
        {
            var tree = CSharpSyntaxTree.ParseText(csCode);
            var root = tree.GetRoot().NormalizeWhitespace();
            var result = root.ToFullString();
            return result;
        }
    }
} 
```

# c++ - QDockWidget 初始宽度

> ID：191020
> 
> 赞同：14
> 
> 时间：2008-10-10T12:22:51.183
> 
> 标签：c++, qt, qdockwidget

如何设置 QDockWidget 的初始宽度？

我已经实现了 sizeHint 函数，但是接下来呢？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-10T12:58:36.260

的文档`QDockWidget`说：

> QDockWidget 充​​当其子部件的包装器，使用 setWidget() 设置。自定义尺寸提示、最小和最大尺寸以及尺寸策略应**在子小部件中实现**。QDockWidget 将尊重它们，调整自己的约束以包括框架和标题。**不应在 QDockWidget 本身上设置大小约束**，因为它们会根据它是否停靠而改变；停靠的 QDockWidget 没有框架和较小的标题栏。

因此，大小提示取自您在停靠小部件中放置的任何内容。您是否尝试过设置`QDockWidget`孩子的大小？

但是，我同意 Marius 的观点，最好的办法可能是`QSettings`在应用程序启动时使用它来保存和恢复所有停靠窗口的宽度。看看`QMainWindow::saveState`除了从单个函数而不是从单个函数获取数据`saveState`之外，我的保存函数看起来与 Marius 给出的函数非常相似。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-10T12:46:16.457

如果您希望它具有与上次程序运行时相同的宽度，您应该查看设置。[Qt 4.4 文档在此处](http://doc.trolltech.com/4.4/mainwindows-application.html)提供了有关如何使用设置的示例。

这就是我的做法：

```
void Applicotion::readSettings() {
  QSettings settings("Company Name", "Application Name");
  settings.beginGroup("LibraryDock");
  libraryDock->setFloating(settings.value("docked").toBool());
  libraryDock->resize(settings.value("size", QSize(1, 1)).toSize());
  libraryDock->move(settings.value("pos", QPoint(200, 200)).toPoint());
  addDockWidget((Qt::DockWidgetArea)settings.value("dockarea", Qt::RightDockWidgetArea).toInt(), libraryDock);
  settings.endGroup();
}

void Applicotion::writeSettings() {
  QSettings settings("Company Name", "Application Name");
  settings.beginGroup("LibraryDock");
  settings.setValue("dockarea", dockWidgetArea(libraryDock));
  settings.setValue("docked", libraryDock->isFloating());
  settings.setValue("size", libraryDock->size());
  settings.setValue("pos", libraryDock->pos());
  settings.endGroup(); 
```

}

# windows - 使用自动配置时，Windows 如何实际检测 LAN（代理）设置

> ID：191023
> 
> 赞同：70
> 
> 时间：2008-10-10T12:24:07.607
> 
> 标签：windows, proxy, lan

当 Windows Internet 属性 -> 连接 -> LAN 设置 -> 自动配置设置为“自动检测设置”时，Windows 如何实际确定/发现设置是什么？它是网络广播还是对在注册表中某处配置的服务器的某种目标查询，还是其他什么？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2008-10-10T12:31:35.033

很简单：浏览器（Firefox 也一样）查询`GET http://wpad/wpad.dat`。

如果名为 wpad 的 web 服务器是可解析的，它应该提供 wpad.dat，一个类似于 netscape PAC 文件的脚本文件。MIME 类型也必须是“application/x-ns-proxy-autoconfig”。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-10T12:57:08.180

这个[关于](http://en.wikipedia.org/wiki/Web_Proxy_Autodiscovery_Protocol)WPAD（Web Proxy Auto Discovery）的信息似乎详细描述了这个过程，尽管我已经确认 Tomalak 所说的实际上也在发生。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-10-30T06:39:22.513

所描述的 IE 配置启用了 WPAD 实现。这是[微软对整个机制的解释](http://technet.microsoft.com/en-us/library/cc713344.aspx)（一篇文章可能细节太多）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-10T12:25:33.940

这是一个网络广播，通常使用[DHCP](http://en.wikipedia.org/wiki/Dhcp)。

那里的维基百科页面应该告诉你所有你需要知道的。

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2014-04-25T10:44:36.410

•转到工具>选项>常规>连接设置> •设置为“手动代理配置”</p>

# agile - 如何将远程办公人员融入敏捷流程？

> ID：191024
> 
> 赞同：12
> 
> 时间：2008-10-10T12:24:16.187
> 
> 标签：agile, scrum

我敢肯定，我们所有人都不得不在某个时间点与远程办公人员打交道，而我现在面临的情况是，我的新项目将有一个“核心”团队，其中包括办公室工作人员和一些异地远程办公人员。不想重复过去的错误，我真的很想知道人们过去尝试过哪些方法来有效地将远程办公人员整合到敏捷流程中，即 Scrum。

我的第一个担心是远程办公人员将是第一个打破“每日 Scrum”例行程序的人。而且，正如人性经常发生的那样，一旦它被打破，就很难恢复并使人们重回正轨。Scrum 建议对错过或迟到每日 Scrum 的人实施小而有趣的“惩罚”，例如向一个罐子捐赠几美元，该罐子以后将用于为最终项目聚会购买一箱啤酒或其他东西。这显然是难以在线执行的事情。

远程办公的另一个大问题是“眼不见心不烦”的问题。除了使用网络摄像头/Skype/电话会议之外，人们还有哪些其他技巧可以让团队尽可能紧密地联系在一起？

另外，如何与来自不同时区的远程办公人员打交道？目前，我们很幸运没有遇到这个问题，但这绝对是未来某个时候的可能性。其他团队是如何处理这个问题的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T12:32:55.267

即时消息确实有助于解决“看不见、心不在焉”的问题，因为所有人都可以看到它们的“状态”（可用、忙碌、处于困境等）。此外，通过回复消息，他们强化了他们普遍可用的想法。

我不会担心 Scrum 会议问题，通过电话会议参加会议通常比亲自参加要容易。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-10T12:42:34.903

预先设定基本规则。不要对他们一厢情愿。

当他们在家（或卫星站点）工作时，您可能已经消除了“我被堵在路上”的借口，因为他们错过了会议或其他任何事情，因此没有理由期望他们减少。

充分利用技术：

*   使用即时消息。我们在这里使用它，它非常适合“伸出手触摸”四个州以外的人。使其成为通过 IM 可用的要求。
*   使用其他工具来帮助打破障碍。这将取决于你的情况。

如果您要进行日常会议，那么每个人都应该清楚您将要问的问题：

*   自从我们上次见面以来，你完成了什么？

*   你今天要做什么？

*   什么是需要移动的方式？

仅仅因为您在他的立方体中看不到马特，并不意味着我有权变得懒惰、效率低下和反应迟钝。这就像与我的孩子打交道——让他们知道规则和期望，然后没有人可以声称无知。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T12:41:56.153

我们使用这些工具取得了成功：

*   用于项目管理的[Assembla （源代码控制、wiki、scrum 工具）](http://www.assembla.com/)
*   用于语音通信的[Skype](http://www.skype.com/)
*   [谷歌聊天](http://www.google.com/talk/)为我

我们是由 3 名开发人员组成的团队，在 6 个时区范围内。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-10T15:27:51.060

我花了一年时间作为敏捷团队中唯一的远程人员。我为每日 Scrum 以及计划/审查会议呼叫了一条会议线路。白天我通过即时消息/电子邮件/电话保持联系。

我认为它总体上工作得很好。最大的缺点是无法看到我们用来跟踪 scrum 的物理白板。我们讨论过使用某种在线工具来做到这一点，但它从未发生过。

我在一个时区之外，我只是认为这是远程办公权衡的一部分，我将在团队其他成员保留的时间工作。

至于对缺少 SCRUM 的处罚——在某种程度上，你应该通过啤酒罐或其他方式松散地执行这一点。但是，如果有人一直缺席/迟到要求的会议，那么他们的经理需要解决这个问题。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-17T20:55:53.410

您可以使用多种技术 - 请记住托管的目的是鼓励协作和沟通。有几件事可以提供帮助。

*   如果您的团队都在附近 - 考虑让每个人都可以进入办公室的核心日子。我目前的团队允许周一和周五在家工作——每个人周二到周四都在办公室
*   对于分布式团队，我在使用 Wiki 而不是墙上的巨大纸张方面取得了很好的成功。wiki 的好处是他们鼓励团队编辑表单以满足团队的需求，而不是适应更正式的工具。
*   拥有 Wiki 的另一个优势是每个人都可以拥有自己的页面来分享有关他们的假期和爱好的图片——这让偏远地区的人更加真实。
*   当您有一个分布式团队时，我想支持即时消息的使用，其中包括状态（有空、离开（拿一杯咖啡）、忙碌（正在开会））——如果人们在工作之间切换，这些可以包括注释家里和办公室。
*   网络摄像头是廉价而有价值的工具
*   为您的群组电话会议投资一个像样的免提电话（我们喜欢 Polycom 电话）
*   使用 LiveMeeting 等工具促进远程结对编程
*   通过电话站起来的一种技巧是让说话的人说出小组中尚未离开的其他人的名字——这让每个人都集中注意力。
*   对于迭代（冲刺）计划会议 - 跟进会议记录或沟通计划，以确保每个人都在同一页面上。不在同一个地方意味着更多的文档和沟通的意图。

祝你好运

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-10T12:36:34.337

SCRUM 和许多其他敏捷方法确实依赖于物理上的接近性——很难将远程办公人员集成到任何频繁发生集成的开发过程中，但这些特定过程对无实体的开发人员尤其不利。

您必须根据当前情况调整流程。使用网络摄像头进行视频会议实际上非常有用，事实上，您可能想尝试在他们的隔间/工作区域中始终打开网络摄像头，这样人们就可以像与任何其他同事一样走上去问问题。

但归根结底，您只需要期望他们的情况会有所不同——如果您是一家敏捷商店，他们将无法完全参与许多流程。

-亚当

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-10T12:39:13.460

确保他们通过网络摄像头参加每日站立会议；正如你所说，这是滑坡的第一个失误。我们也尝试使用圆桌会议来完成所有会议，这确实很有帮助。

我已经这样做了两个月（在加拿大与都柏林的核心团队一起工作），到目前为止一切进展顺利。

请参阅 Scott Hanselman 关于他在 Microsoft 远程工作的第一年的文章——那里肯定有一些很好的提示。[一年之后。](http://www.hanselman.com/blog/WorkingRemotelyFromHomeTelepresenceAndVideoConferencingOneYearLater.aspx)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-10T12:39:48.280

在需要时，远程办公的特权本身可以成为参与交易的一部分，而不是啤酒罐。如果团队没有足够的责任来正确地进行远程办公，那么他们可能不应该这样做。偶尔迟到的更有趣的惩罚可能是使用一个有趣的头像来代表会议中失踪的人。

让人们保持紧密联系的其他方法是使用 Wiki 等协作工具和 Basecamp 或 FogBugz 等项目跟踪工具。

对于不同的时区，需要根据最西的时区进行早期会议，除非是在世界的另一边，这是一个更大的问题。那么它可能将基于谁负责。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-10T12:35:33.780

即使是通过电话分散的团队，我们也能够在我们的环境中管理每日例会。

它有助于使用 Rally 和 Basecamp 等软件来管理流程。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-10T12:49:13.720

我工作的一个地方使用 Asterisk 而不是普通的电话系统。它运作良好，因为当您在家工作时，您只需登录，人们可以直接拨打您的电话号码，外人不需要知道。尽管如今电话费用相对而言微不足道，但“始终在线”的连接会鼓励更多的沟通。音质也更好。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-10T17:10:35.237

对于远程办公人员/分布式团队，我建议您购买一部像样的电话 - 大多数桌面电话失去了让另一端的人们在站立期间听到距离电话几英尺远的人们的能力。

当您在迭代结束时为利益相关者演示工作代码时，使用 webex 或 livemeeting 或其他东西来共享桌面和摄像头以向演讲​​者展示，以便您的分布式参与者可以看到正在发生的事情。（更好的是让您的远程办公人员在迭代边界期间亲自参加）。

我建议在项目开始/启动阶段让人们聚在一起几周，这样人们就可以建立人际关系。令人惊讶的是，预先进行的面对面互动对建立团队合作的基础有多么大的帮助。

使用分布式卡片墙。我喜欢 Mingle ( [http://mingle.thoughtworks.com](http://mingle.thoughtworks.com) )，但我没有使用过其他工具，所以无法评论它们。

对于回顾，在房间里有一个代理人使用 IM 与你的分布式团队成员交流是很有用的……这样分布式人员的任何评论都可以写在一张纸上（或便利贴，或者你怎么做你的）。

至于您对“不在现场，不在意”的恐惧，我更喜欢这样的事情是不要为尚未实现的问题创建解决方案。如果您发现您的团队正在变得脱节（回顾的主要讨论点），那么您可以促进团队讨论如何处理出现的任何问题。再说一遍——团队应该帮助确定问题和解决方案，而不是让经理或 Scrum Master 决定解决方案。从信任的假设开始。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-09-26T09:17:00.823

分发 Scrum 需要做好充分的准备。这不仅仅是关于工具。

我们支持分布式环境中的许多部署，并且有一个基本点——人。

**最有效的方法是从一个地点的所有人开始。**他们必须亲自见面，这样他们才能认识对方，而不仅仅是世界另一端的虚拟人物。正如我常说的——团队成员需要互相闻闻。

如果可能，在一个地点召开**发布计划会议。**更改位置，以便您访问所有这些位置，以了解文化、习惯和人的背景和理解。对于**sprint 计划**，使用视频会议、屏幕共享等。没有必要出差（太频繁了）。

**必须建立**明确的角色和团队组织。**你必须有产品负责人和 Scrum Master。您应该考虑是否不想让 PO 和 SM 尽可能靠近团队。当然，您必须每天让他们参加面对面的 2 次面对面会议（这是关于面子，而不是位置）。**

 ****done 的定义**，如果团队同意，有助于对 Done 的含义有相同的理解。在分布式环境中是必须的。

**您将需要一个良好的日常站立**交流工具。我们发现可以使用 Skype 或 Office 通讯器进行日常工作。我们使用音频和聊天。尤其是在国际环境中聊天可以让你了解人。**每天结束后保持沟通渠道畅通**，以便团队成员可以在每日报告之外讨论什么是必要的。

而且，最重要的是与所有地点的所有团队成员进行定期**回顾。**不要忘记实施来自回顾的想法。其他地方的团队将需要当地的支持来帮助他们实施想法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-04-16T16:52:08.570

我在一个 5 人的团队中工作。我们使用以下方式来促进我们的远程办公工作场所：

*   Asana - 项目和任务管理
*   Google Talk + 你最喜欢的 IM 客户端（我用过 Pidgin）
*   RingCentral - VOIP 电话
*   Gmail - 异步通信（即电子邮件）
*   Dropbox - 文件传输和备份
*   Team Viewer - 屏幕共享、培训和演示

即使使用这些工具，您的流程也很容易出现不足，因此根据您的动态为您的团队建立一些最佳实践非常重要。例如，我们有两个主要做法：

1.  经常沟通——因为我们在沟通时不在同一个地方，很容易忘记你是在一个团队中工作。对于我们的团队，我们会在 Asana 中更新我们的任务，并添加描述想法、障碍和任务完整性的评论。当需要即时帮助或反馈时，不要等待，如果（此人离线）通过 IM 或电子邮件寻求帮助。
2.  倾向于过度沟通——这更多地与 Asana 评论和电子邮件有关。但是，总的来说，我们发现提供比需要更多的信息更好（在范围内）。

# unix - 我什么时候可以或应该在文件或目录上使用 chmod g+s ？

> ID：191039
> 
> 赞同：33
> 
> 时间：2008-10-10T12:30:31.743
> 
> 标签：unix, sysadmin

在最近部署到新的（Solaris 9）环境时，其中一个步骤是将一组文件和目录复制到它们的新位置，然后将组 UID 位（使用“chmod -R g+s”）应用于所有目录树中的文件为所有内容提供 -rwxr-s--- 模式。结果是，除非单独打开并重新保存它们，否则我们的任何 shell 脚本都不会执行。我应该补充一点，我们之前在复制文件之前已经在目标父文件夹上设置了 g+s；这已将所有新目录的初始模式设置为 drwxr-s--- 但文件的模式为 -rwxr-x---

最终发现是哪个步骤导致了问题，我们能够删除该步骤并继续。

但是，我想了解“s”位在应用于目录和文件时的含义，希望这将解释为什么我们首先会遇到问题。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2008-10-10T12:47:32.083

设置目录 g+s 使在所述目录中创建的所有新文件都将其组设置为目录的组。

如果您设置了 umask 以便文件默认具有组写入功能，这实际上对于协作目的非常方便。

注意：这是它在 Linux 中的工作方式，它在 Solaris 中的工作方式可能完全不同。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-10T12:39:11.727

对于可执行文件，这意味着当文件被执行时，它作为拥有该文件的组执行，而不是执行该文件的用户组。

如果您希望用户能够假定特定组的权限仅用于运行一个命令，这将很有用。

然而，这也是一个安全风险，因为它允许用户提升他们的权限。你必须知道设置了这个位的脚本不会做任何让用户滥用这些额外权限的事情。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-03-20T13:18:33.503

这是 SGID (chmod g+s) 的非常方便的解释：[http ://www.linuxnix.com/sgid-set-sgid-linuxunix/](http://www.linuxnix.com/sgid-set-sgid-linuxunix/)

> SGID（在执行时设置组 ID）是赋予文件/文件夹的一种特殊类型的文件权限。通常在 Linux/Unix 中，当程序运行时，它会从登录用户那里继承访问权限。SGID 被定义为授予用户临时权限以运行具有文件组权限的程序/文件的权限，使其成为该组的成员以执行文件。简而言之，用户在执行文件夹/文件/程序/命令时将获得文件组的权限。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-10T15:10:36.087

对于可执行文件，`g+s`覆盖可执行文件将作为其运行的组 ID（它通常是从父级继承的）。

```
$ cp `which id` id-test
$ ./id-test
uid=1001(user1) gid=1001(group1) groups=1001(group1),2001(project1)
$ chgrp project1 id-test
$ chmod g+s 身份测试
$ ./id-test
uid=1001(user1) gid=1001(group1) egid=2001(project1) groups=1001(group1),2001(project1)
```

（egid 是“有效组 id”——通常与 gid、“组 id”相同，但这里不同。）

对于目录，`g+s`覆盖新文件和目录将具有的组 id（通常从创建者继承）。

```
$ mkdir 项目
$ chgrp project1 文件1
$ 掩码
0022
$ 触摸项目/文件1
$ ls -l 项目/文件1
-rw-r--r-- 1 用户 1 组 1 0 文件 1
$ chmod g+s 项目
$ 触摸项目/文件2
$ ls -l 项目/文件2
-rw-r--r-- 1 用户 1 项目 1 0 文件 2
```

您可能仍然需要摆弄以`umask`获得最佳效果；至少与`0007`共享写作所需的许可一样，并且至少与`0027`共享阅读所需的许可一样。

```
$ umask 0077
$ 触摸项目/文件3
$ ls -l 项目/文件3
-rw------- 1 用户 1 项目 1 0 文件 3
$ umask 0027
$ 触摸项目/文件4
$ ls -l 项目/文件4
-rw-r----- 1 用户 1 项目 1 0 文件 4
$ umask 0007
$触摸项目1/文件5
$ ls -l 项目1/文件5
-rw-rw---- 1 用户 1 项目 1 0 文件 5
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-10T13:05:33.327

对于文件，这意味着文件作为拥有文件的组执行，而不是执行文件所属的组用户。当你想允许用户做他没有权限的事情时，它是有用的。例如，对于我使用的一个 DBMS，通常允许每个人备份数据库。虽然只有 'dbms' 组对数据库文件具有读/写权限，但备份程序设置了 g+s 以允许任何人通过它访问数据库，但不能直接访问。

对于目录，这意味着新创建的目录将归拥有该目录的组所有，而不是创建文件所属的组用户。一个很好的例子是 sourceforge.net 项目的网络空间。想象一下 3 个开发人员维护项目网站。现在，如果其中一个人创建了一个文件，则只有他可以写入（默认情况下）。为了解决这个问题，同一个项目上的所有用户也都在同一个组中，并且目录对该组具有 rws 权限，因此无论谁创建文件，它都会被创建为对该组可读和可写。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T12:42:12.173

有关 setuid 和 setgid 的更多信息[在这里](http://en.wikipedia.org/wiki/File_system_permissions#Additional_Permissions)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T18:14:10.227

为了稍微扩展您的具体问题，已经注意到 sgid 可执行文件可能会通过授予用户通常没有的权限而导致问题。虽然这对于任何可执行文件都是一个问题，但它会在脚本（特别是“通过文件开头的 #! 标识的外部解释器执行的文件”）的情况下创建一个潜在可利用的竞争条件，这可以用于执行具有脚本权限的任意代码。

多年来，Unix 衍生产品实施了许多旨在减轻或消除此漏洞的方案，其中大多数包括某种形式的完全禁止执行 suid 或 sgid 脚本或要求您跳过一些障碍来启用它（通常在逐个脚本的基础上）。一种这样的方案将导致您在打开脚本的 sgid 标志后无法运行脚本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T18:16:46.383

需要使用时：修复使用 svn+ssh 时的 SVN 文件所有权问题。有人告诉我它只发生在 BDB 上，但我在 FSFS 存储中也遇到了这样的问题。基本上，当您希望在有其他用户在其上写入内容时保持目录内子文件的所有权一致时，您将不得不使用 u+s/g+s。

# html - 如何开始为给定的（动态生成的）HTML 创建 CSS？

> ID：191043
> 
> 赞同：2
> 
> 时间：2008-10-10T12:32:30.773
> 
> 标签：html, css, styling

布局和*内容*的分离是 CSS 和 HTML 的领域 - 到目前为止很好理解。现在关于分离*...*

我正在寻找提示和最佳实践来开始为内容管理系统提供“皮肤”或“主题”的任务。

## 背景：

我们开始采用 Portal Server/Content Management System 并开始改变外观以符合我们的需求。

到目前为止，我们的设计师主要使用对 HTML 和 CSS 的完全控制，调整其中任何一个以获得像素完美的布局。随着 cms 的采用，有很多预先创建的 HTML（非常语义化，几乎没有表格 :) 需要使用 CSS 和图像进行蒙皮。尽管可以更改 HTML 片段，但我宁愿仅在不得已的情况下才这样做。

由于这提供了“如何开始”的挑战，我的问题是关于如何进行的任何提示或可以帮助管理或组织此任务的文章 - 例如设计中的最佳实践，如何分割此任务或使用什么工具。

将动态生成的页面保存到磁盘并在本地进行更改似乎是一种不好的做法。这对于 CSS 文件来说是可以的，但是对 HTML 元素的更改必须修改为生成它们的片段。如果可能的话，我想把它排除在设计师的范围之外。此外，Dreamweaver（或任何类似工具）对 HTML 结构进行隐式调整的想法让我感到恐惧。

*对于好奇的人：提到的 CMS/Portalserver 是[Liferay](http://www.liferay.com)，但问题实际上与语言和工具无关。*

编辑：FireBug（正如 Josh 建议的那样）非常适合尝试对 css 进行即时更改。还有更多——无论是在工具领域还是在流程和自组织领域？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-12T20:04:03.980

如果您正在寻找分离样式和内容的实际示例，那么我建议您使用[CSS Zen Garden](http://www.csszengarden.com/)。浏览 HTML 和 CSS 具有启发性和启发性，应该对您正在尝试做的事情有所帮助。

我的 #1 提示是让一切尽可能语义化，并使用大量的类和 id 来挂钩你的样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T12:51:10.533

通常，每当我遇到这样的情况时，我都会在 FireFox 中打开页面，使用 FireBug 检查不同的元素，并准确查看它们应用了哪些 css。然后我只是修改现有的 css，直到我得到我喜欢的。您甚至可以在 firebug 中玩耍并修改 CSS，而无需“保存”这些更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-12T20:11:19.863

看看[CSS Tidy](http://csstidy.sourceforge.net/)，我们通常使用它来清理 CSS 并重新组织用于开发和生产。但是，我个人更喜欢在使用它之前手动编写 HTML/CSS。我猜这只是个人喜好的问题。

# .net - 您推荐的最基本的代码分析规则集是什么？

> ID：191054
> 
> 赞同：1
> 
> 时间：2008-10-10T12:36:39.330
> 
> 标签：.net, tfs, code-analysis

对于 200K LOC 解决方案，您会推荐哪些基本的代码分析规则集？我们正在使用单元测试，但代码分析已关闭。

理想情况下，所有规则都将默认打开，但我想轻轻地这样做并分批打开规则，这样我们就不必一次处理所有事情。那么，我应该从什么规则开始呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T15:09:28.540

我找到了Microsoft 截至 2007 年启用[的规则列表。](http://blogs.msdn.com/fxcop/archive/2007/08/09/what-rules-do-microsoft-have-turned-on-internally.aspx)

可以在 Phil Haack对相关[问题的](https://stackoverflow.com/questions/27009/how-does-one-implement-fxcop-static-analysis-on-an-existing-code-base)[回答](https://stackoverflow.com/questions/27009/how-does-one-implement-fxcop-static-analysis-on-an-existing-code-base#29545)中找到并非真正的规则集，而是在现有代码库上打开代码分析的好建议。

# javascript - 单击时禁止更改复选框

> ID：191056
> 
> 赞同：0
> 
> 时间：2008-10-10T12:38:51.883
> 
> 标签：javascript, checkbox

我想要网页上的复选框。当我单击它时，它会向服务器发送一个 ajax 请求。当服务器回复时，我希望复选框更改。除了复选框在单击时立即更改状态之外，我可以修复所有问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T12:43:41.623

你确定你真的想要这个吗？Ajax 请求可能需要一些时间。当用户没有得到反馈时，他们可能会倾向于一次又一次地点击，直到发生某些事情。当这停用按钮（一段时间后再次）时，用户会更加困惑。

而是考虑提供即时反馈（例如选中该框）并在其旁边显示一个指示符，该指示符表示与服务器的通信（例如著名的纺车）。当结果返回时，隐藏指示器并在需要时取消激活复选框。您可能还希望在 ajax 请求期间禁止发布表单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T19:16:44.983

您可能可以执行以下操作：单击复选框时，将复选框设置为“禁用”（这会使复选框变灰并使其不可编辑），进行 ajax 调用，一旦获得 ajax 返回，请删除“禁用”从复选框。像这样的东西（使用jQuery，未经测试）：

```
$('#mycheckbox').click( function() {
  var checkbox = this;
  $(checkbox).attr('disabled','1');
  $.post( url, data, function() {
    // if successful
    $(checkbox).removeAttr('disabled');
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T20:51:55.260

```
<input id="theChkbox" type="checkbox" onclick="this.checked=!this.checked;sendAjaxRequest(this);"> 
```

`this.checked=!this.checked`将复选框的状态重置为单击之前的状态。这应该适用于所有浏览器，而不会出现状态闪烁（太多）。

`sendAjaxRequest()`将做您的魔术，当请求返回时，请设置复选框的适当检查状态。传递`this`给`sendAjaxRequest()`应该为您提供对复选框的引用，以便您可以调整其状态。如果做不到这一点，只需使用`document.getElementById("theChkbox")`检索对它的引用来设置它的状态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T12:42:19.193

添加到您的 onclick "return false;" 它不应该改变。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T12:50:36.760

你可以开始你的 onchange 方法`checkbox.checked=NOT checkbox.checked`（你可能必须根据你选择的语言修改它），你可能会得到一个闪烁，但它应该足够快地把它放回去。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T12:55:37.887

我认为您确实应该使用其他方法。也许是一个按钮/图像按钮，因为您想为单击触发一些动作以表示来自用户的特定命令（愿望）。我会尝试更好地解释：我认为您在页面中有一些信息和一些用户可以单击并执行某些操作的小工具（将项目添加到购物车），我认为如果小工具具有更多的视觉吸引力，它会更有用用户比一个复选框（例如“添加它”）。

希望这有帮助。

# c# - 架构提示：业务逻辑/数据访问

> ID：191057
> 
> 赞同：1
> 
> 时间：2008-10-10T12:39:09.917
> 
> 标签：c#, architecture, business-logic

我们计划重新设计、改进我们的 (C#) 应用程序架构。有人有一些框架、主页或书籍推荐吗？主要是业务逻辑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T12:48:33.860

也许看看[CSLA.NET](http://www.lhotka.net/cslanet/)？

它是一个真正围绕业务对象构建的框架。买书读一读。也许它不是适合你的框架，但我相信它会给你一些关于如何去做的好主意。

# python - Python 网络框架混乱

> ID：191062
> 
> 赞同：10
> 
> 时间：2008-10-10T12:40:08.277
> 
> 标签：python, pylons, cherrypy, web-frameworks, turbogears

有人可以向我解释一下当前的 python webframworks 是如何组合在一起的吗？

我听说过的三个是 CherryPy、TurboGears 和 Pylons。但是我很困惑，因为 TurboGears 似乎使用 CherryPy 作为“控制器”（尽管 CherryPy 本身不是一个框架吗？），并且 TurbGears 2 将构建在 Pylons 之上（我认为这样做一样？）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-10T12:43:02.063

当然还有更多。

这是一个全面的列表和详细信息！

[**Python 的 Web 框架**](http://wiki.python.org/moin/WebFrameworks)

从上面的链接中提取：

> ## 流行的全栈框架
> 
> Web 应用程序可以使用基本 HTTP 应用程序服务器、数据库等存储机制、模板引擎、请求调度程序、身份验证模块和 AJAX 工具包的组合。这些可以是单独的组件，也可以在高级框架中一起提供。
> 
> 这些是最流行的高级框架。其中许多包含 WebComponents 页面上列出的组件。
> 
> [**Django**](http://wiki.python.org/moin/Django) (1.0 Released 2008-09-03) 一个高级 Python Web 框架，鼓励快速开发和干净、实用的设计
> 
> [**Pylons**](http://pylonshq.com/)（0.9.6.2 发布于 2008-05-28）一个轻量级的 Web 框架，强调灵活性和快速开发。它结合了 Ruby、Python 和 Perl 领域的最佳理念，提供了一个结构化但极其灵活的 Python Web 框架。它也是利用新兴 WSGI 标准的首批项目之一，该标准允许广泛的重用和灵活性，但前提是您需要它。开箱即用的 Pylons 旨在使 Web 开发快速、灵活和简单。Pylons 建立在 Paste 之上（见下文）。
> 
> [**TurboGears**](http://www.turbogears.org/) (1.0.4.4 发布于 2008-03-07) 您一直在寻找的快速 Web 开发巨型框架。结合[**了 CherryPy**](http://wiki.python.org/moin/CherryPy)、Kid、SQLObject 和 [**MochiKit**](http://wiki.python.org/moin/MochiKit)。查看网站后查看：[**快速入门手册**](http://lucasmanual.com/mywiki/TurboGears)
> 
> [**web2py**](http://mdp.cti.depaul.edu/)（当前版本 1.43） 一个包中的所有内容，没有依赖关系。可以通过提供的 Web 界面完成应用程序的开发、部署、调试、测试、数据库管理和维护。web2py 没有配置文件，不需要安装，可以在 U 盘上运行。web2py 将 Python 用于模型、视图和控制器，具有用于管理错误的内置票证系统、国际化引擎，通过 ORM 抽象层与 MySQL、PostgreSQL、SQLite、Oracle、MSSQL 和 Google App Engine 一起使用。web2py 包括处理 HTML/XML、RSS、ATOM、CSV、RTF、JSON、AJAX、XMLRPC、WIKI 标记的库。生产就绪，能够上传/下载非常大的文件，并且始终向后兼容。
> 
> [**Grok**](http://grok.zope.org/)（0.13 于 2008-06-23 发布）基于现有的 Zope 3 库构建，但旨在提供更轻松的学习曲线和更敏捷的开发体验。它通过强调约定而不是配置和 DRY（不要重复自己）来做到这一点。
> 
> [**Zope**](http://www.zope.org/)（2.10.4 2007-07-04 发布，3.3.1 2007-01-14 发布，Zope 3.4.0c1 2008-01-31 发布） 作为 Python Web 框架的鼻祖，Zope 已经成长为一个框架家族这些年。Zope 1 于 1999 年发布。Zope 2 既是 Web 框架又是通用应用程序服务器，如今它主要由 ContentManagementSystems 使用。Zope 3 既是一个独立的框架，也是相关库的集合，这些库也包含在 Zope 2 的较新版本中。所有的 Zope 框架都包括 ZODB，一个 Python 的对象数据库。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-10T15:15:33.033

试试 web2py。它是点击式的（你甚至不需要安装 Python，它自带）。您使用 Web 界面进行开发，几乎可以在任何地方进行部署，包括 iPhone、Oracle 和 Google App Engine。在尝试 web2py 之前，请尝试安装一些其他 Python 框架，您会更加欣赏它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-10T13:44:16.400

CherryPy 不是一个全栈 Web 框架（例如 Django），实际上它不是一个 Web 框架，而是一个 HTTP 框架。使用 CherryPy 编写 Web 应用程序很像用 Python 编写常规的面向对象应用程序。此外，CherryPy 有它自己的生产就绪的 WSGI Web 服务器，它也可以用于使用其他框架编写的应用程序，因此围绕 CherryPy 作为一个框架感到困惑。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T12:43:54.150

如果您正在寻找一个从头到尾的解决方案，那么值得一提的是，该领域的领导者是[Django](http://www.djangoproject.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-11T07:17:32.857

您是否尝试过 FastAPI。它是一个现代、快速（高性能）的 Web 框架，用于基于标准 Python 类型提示使用 Python 3.6+ 构建 API。

非常容易学习，非常强大和轻量级。 [https://fastapi.tiangolo.com/](https://fastapi.tiangolo.com/)

我一直在为我的应用程序使用它，它似乎与 Flask 相似，但非常健壮。

```
from fastapi import FastAPI

app = FastAPI()

@app.get("/")
def read_root():
    return {"Hello": "World"} 
```

[一些视频教程可以在这里找到](https://www.youtube.com/watch?v=vrTBIAfmN_8&list=PL5gdMNl42qynpY-o43Jk3evfxEKSts3HS)

[您还可以从这里](https://fastapi.tiangolo.com/tutorial/intro/)找到很多帮助材料

# internationalization - 您如何管理字符串翻译流程？

> ID：191066
> 
> 赞同：23
> 
> 时间：2008-10-10T12:42:17.697
> 
> 标签：internationalization

我正在开发一个需要翻译成 30 种语言的软件项目。这意味着更改任何字符串都会产生相对较高的成本。此外，翻译不会一蹴而就，因为翻译包需要由不同的翻译人员完成，所以这可能需要一段时间。

不知何故，添加新功能很麻烦。在实际编写 UI 代码之前，我们可以想出所有需要的字符串，但有时由于错误修复或疏忽，我们仍需要添加新字符串。

所以问题是，你如何管理所有这些过程？关于如何减轻翻译对软件项目的影响的任何提示？如何统治弦乐，而不是让弦乐统治你？

编辑：我们正在使用 Java，所有字符串都使用资源包进行国际化，所以问题不在于国际化本身，而在于字符串的管理。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-30T21:18:59.170

我不确定您正在国际化的平台。我之前已经写过关于 il8n 应用程序的最佳方式的答案。请参阅[全球化 asp.net 应用程序需要了解什么？](https://stackoverflow.com/questions/59130/what-do-i-need-to-know-to-globalize-an-asp-net-application/59184#59184)

也就是说 - 自己管理翻译很困难。问题是您将在多个页面中使用相同的文本。但是，您的框架可能不支持仅在一个文件中包含那段文本（例如，asp.net 中的资源文件鼓励您为每种语言拥有一个资源文件）。

我们发现处理事物的方式是拥有一个翻译的中央数据库存储库。我们创建了一个小型 .net 应用程序来将翻译从资源文件导入到该数据库，并将翻译从该数据库导出到资源文件。因此，在构建过程中有一个额外的步骤来构建资源文件。

您将遇到的另一个问题是将翻译传递给您的翻译供应商并返回。有几种方法 - 看看您的翻译供应商是否愿意接受 XML 文件并返回格式正确的 XML 文件。这确实是最好的方法之一，因为它允许您自动导入和导出翻译文件。如果您的供应商允许，另一种选择是创建一个网站以允许他们编辑翻译。

In the end, your answer for translations will be the same for any other process that requires repetition and manual work. Automate, automate, automate. Automate every single thing that you can. Copy and paste is *not* your friend in this scenario.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-30T21:12:38.573

[Pootle](http://pootle.translatehouse.org/)是一个允许通过网络管理翻译过程的网络应用程序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-10T10:13:34.710

在国际化应用程序时需要考虑许多主要问题。

*   **并非所有字符串都是平等创建的**。根据语言的不同，句子的长度可能会发生显着变化。在某些语言中，它可以是一半的长度，而在另一些语言中，它可以是三倍的长度。确保为您的 GUI 小部件设计有足够的空间来处理大于英文字符串的字符串。
*   **翻译人员通常不是程序员**。不要期望翻译人员能够阅读和维护资源文件的正确文件格式。您应该设置一种机制，您可以将翻译后的数据往返从电子表格之类的东西转换到资源文件。一种可能性是将 XSL 过滤器与 Open Office 一起使用，以便您可以直接在电子表格应用程序中保存到资源文件。此外，翻译人员或翻译服务公司可能已经拥有自己的数据库，因此最好询问他们使用什么并编写一些工具来自动化。
*   **您将需要将数据附加到字符串**- 不要假装您永远不需要，否则您将始终能够将字符串放在末尾。确保您有一个字符串格式化程序设置来替换字符串中的占位符。此外，请确保记录将为翻译人员替换的典型值。请记住，占位符的顺序在不同的语言中可能会发生变化。
*   **将您的 i8n 字符串变量命名为反映其含义的名称**。您是否真的想在资源文件中查找数字以找出给定字符串的内容。开发人员依赖于能够读取代码中的字符串输出来提高效率，这比他们通常意识到的要高得多。
*   **不要害怕代码生成**。在我当前的项目中，我编写了一个由 ant 调用的小型 Java 程序，它解析默认语言（主）资源文件的所有键，然后将键映射到本地化类中定义的常量。见下文。//---- 注释之间的行是自动生成的。每次添加字符串时，我都会运行生成器。

```
 public final class l7d {
...normal junk

/**
 * Reference to the localized strings resource bundle.
 */
public static final ResourceBundle l7dBundle =
        ResourceBundle.getBundle(BUNDLE_PATH);

//---- start l7d fields ----\
public static final String ERROR_AuthenticationException;
public static final String ERROR_cannot_find_algorithm;
public static final String ERROR_invalid_context;
...many more
//---- end l7d fields ----\
static {

    //---- start setting l7d fields ----\
    ERROR_AuthenticationException = l7dBundle.getString("ERROR_AuthenticationException");
    ERROR_cannot_find_algorithm = l7dBundle.getString("ERROR_cannot_find_algorithm");
    ERROR_invalid_context = l7dBundle.getString("ERROR_invalid_context");
    ...many more
    //---- end setting l7d fields ----\
} 
```

上述方法提供了一些好处。

1.  由于您的字符串键现在被定义为一个字段，您的 IDE 应该支持它的代码完成。这将为您节省大量类型。每次要打印字符串时，查找每个键名并修复拼写错误真的很令人沮丧。
2.  如果我错了，请有人纠正我。通过在静态实例化时将所有字符串加载到内存中（如示例中所示），将导致更快的加载时间，但会增加内存使用量。我发现使用的额外内存量可以忽略不计，值得权衡。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T12:49:18.400

我从事的本地化项目有“字符串冻结”日期。在此之后，允许更改字符串的唯一方法是获得项目管理团队非常高级成员的许可。

这并不是一个完美的解决方案，但它确实使我们能够以正当的理由将有关字符串的缺陷搁置到下一个版本。一旦发生字符串冻结，您也有正当理由拒绝在“一时冲动”的决定中向项目添加全新功能。并且获得来自高层的许可意味着中层管理人员将无权更改您的规格:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-10T12:51:44.900

如果可用，请为此使用数据库。每个字符串都有一个 id，每种语言都有一个表，或者在一个列中包含所有语言的一个表（取决于访问站点的方式，性能决定了哪个更好）。这允许翻译人员进行更新，而无需尝试管理代码文件和版本控制细节。此外，运行关于未翻译内容的报告并跟踪自动翻译（引擎）与真正的人工翻译几乎是微不足道的。

如果没有数据库，那么我将每种语言都放在一个单独的文件中，以减少版本控制问题。但结构基本相同——每个字符串都有一个id。

-亚当

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-10T12:58:10.817

我们不仅使用了数据库而不是自吹自擂的资源文件（当我们拥有如此出色的数据库处理工具时，我一直不明白为什么人们会使用这样难以管理的东西），而且我们还避免了需要通过使用反射来识别要翻译的控件，在应用程序中标记事物（忘记在 VB6 Forms 中用数字标记控件总是一个问题）。然后我们使用一个 XML 文件将控件转换为字典数据库中的短语 ID。

尽管必须管理映射文件，但它仍然可以独立于构建过程进行管理，并且实际上可以由拥有数据库权限的最终用户进行应用程序的翻译。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-10T12:54:30.887

到目前为止，我们提出的解决方案是在 Excel 中使用一个小型应用程序来读取所有属性文件，然后显示一个包含所有翻译的矩阵（语言作为标题，键作为行）。那时缺少什么是很明显的。这是发送给译者的。当它返回时，可以处理工作表以再次生成相同的属性包。到目前为止，它已经在一定程度上缓解了疼痛，但我想知道周围还有什么。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-10T12:56:54.173

我放入了一个 makefile 目标，它可以找到所有 .properties 文件并将它们放入一个 zip 文件中以发送给翻译人员。我提出只给他们发送差异，但出于某种原因，他们每次都想要整个文件包。我认为他们有自己的系统来跟踪差异，因为他们根据从一次到下一次更改了多少字符串向我们收费。当我收到他们的交付时，我手动将他们的所有文件与之前交付的文件进行比较，以查看是否有任何意外发生变化 - 有一次所有 PT_BR（巴西葡萄牙语）字符串都发生了变化，结果他们使用了 PT_PT（葡萄牙语) 该批次的翻译器，不管 PT_BR 的顺序如何。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-07T15:15:32.787

这本 google book -[资源文件管理](http://books.google.com/books?id=JwGUS1Bt36YC&pg=PA126&lpg=PA126&dq=resource+file+translation+management&source=web&ots=1kpDY38pzK&sig=z-TQGSqXoKd_x0IdwXTur4WfRY8&hl=en&ei=e6KNSaLaD-LBjAe30sTFCg&sa=X&oi=book_result&resnum=10&ct=result#PPA127,M1)提供了一些很好的提示

您可以使用资源文件管理软件来跟踪已更改的字符串并控制工作流程以将它们翻译 - 否则您最终会陷入一团糟的冻结和专横的版本控制

一些做这种事情的工具 - 没有联系，我实际上没有使用它们，只是研究

[http://www.sisulizer.com/](http://www.sisulizer.com/)

[http://www.translationzone.com/en/products/](http://www.translationzone.com/en/products/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-10T12:46:39.310

在 Java 中，国际化是通过将字符串移动到资源包中来实现的……翻译过程仍然漫长而艰巨，但至少它与生产软件、发布服务包等的过程分开了。有一点很有帮助的是一个 CI 系统，可以在任何更改时重新打包所有内容。我们可以在几分钟内测试并发布一个新版本，无论是代码更改、新语言包还是两者兼而有之。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-28T14:54:35.150

对于初学者，我会使用默认字符串以防缺少翻译。例如，英语或西班牙语值。其次，您可能需要考虑使用 Web 应用程序或类似的东西供您的翻译人员使用。这需要一些预先的资源，但至少您不需要到处发送文件，而且对于翻译人员来说，哪些字符串是新的等会很明显。

# .net - 在 vs.net 2008 中内置代码生成？还是通过 MS 免费？

> ID：191070
> 
> 赞同：0
> 
> 时间：2008-10-10T12:43:22.717
> 
> 标签：.net, visual-studio-2008, code-generation

vs.net 2008 中内置了哪些代码生成工具或通过 Microsoft 正式提供？

我知道：

*   实体框架
*   sqlmetal

那里还有什么？

理想情况下，我正在寻找将从现有数据库模式生成的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-12T06:58:34.923

如果正在专门寻找数据库/ORM 生成器，您可能有兴趣查看[llblgen](http://www.llblgen.com/defaultgeneric.aspx)或[subsonic](http://subsonicproject.com/)。这两种产品都不是直接来自 Microsoft。祝您搜索顺利。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T11:01:23.700

我最近发现了内置于 VS2008 的 T4

假设 VB.Net（虽然也适用于 c#）

创建一个名为 template.tt 的文件并将以下内容放入其中......

```
<#@ template language="VB" debug="True" hostspecific="True" #>
<#@ output extension=".vb" debug="True" hostspecific="True" #>
Imports System
<# For Each Table as String in GetMyTables() #>
    Public Class <#=TableName#>
        Public Sub New
        End Sub 
    End Class
<#Next#>
<#+
Public Function GetMyTables() as String()
    Return new String(){"Table1", "Table2"}
End Function
#> 
```

确保（如果使用 vb）显示所有文件是真的......并保存文件。

您应该看到已创建一个新文件“Template.vb”，其中每个“Table1”和“Table2”都有 1 个类

您应该能够看到如何为几乎任何类型的代码生成自定义它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T12:49:20.210

[http://www.mygenerationsoftware.com](http://www.mygenerationsoftware.com)怎么样？

# c# - 使用 C# 的正则表达式匹配（简单？？）正则表达式

> ID：191082
> 
> 赞同：2
> 
> 时间：2008-10-10T12:47:27.653
> 
> 标签：c#, regex

好的，抱歉，这似乎是一个愚蠢的问题，但我无法弄清楚这件事：

我正在尝试解析一个字符串，只是想检查它是否只包含以下字符：'0123456789dD+'

我已经尝试了很多东西，但就是无法找出正确的正则表达式来使用！

```
 Regex oReg = new Regex(@"[\d dD+]+");
  oReg.IsMatch("e4"); 
```

即使不允许使用 e 也会返回 true...我尝试了很多字符串，包括 Regex("[1234567890 dD+]+")...

它始终适用于[Regex Pal](http://regexpal.com/)，但不适用于 C#...

请告知，我再次道歉，这似乎是一个非常愚蠢的问题

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-10T12:51:29.283

试试这个：

```
@"^[0-9dD+ ]+$" 
```

开头和结尾的 and 分别表示输入字符串的开头和结尾`^`。`$`因此，在开头和结尾之间，只允许指定的字符。在您的示例中，如果字符串包含其中一个字符，即使它还包含其他字符，正则表达式也会匹配。

@comments：谢谢，我修复了缺失`+`和空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T12:52:45.040

糟糕，您忘记了界限，请尝试：

```
Regex oReg = new Regex(@"^[0-9dD +]+$");
oReg.IsMatch("e4"); 
```

^ 匹配文本流的开头， $ 匹配结尾。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T12:54:03.617

它与 4 匹配；如果您想要对整个字符串进行完全匹配，则需要 ^ 和 $ 来终止正则表达式 - 即

```
 Regex re = new Regex(@"^[\d dD+]+$");
    Console.WriteLine(re.IsMatch("e4"));
    Console.WriteLine(re.IsMatch("4")); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T12:57:25.857

这是因为正则表达式也可以匹配输入的一部分，在这种情况下它只匹配“e4”的“4”。如果你想匹配整行，你必须用“^”（匹配行开始）和“$”（匹配行结束）包围正则表达式。

因此，要使您的示例正常工作，您必须编写如下：

```
Regex oReg = new Regex(@"^[\d dD+]+$");
oReg.IsMatch("e4"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T12:52:49.610

我相信它会返回 True，因为它找到了 4。正则表达式中的任何内容都不会从结果中排除字母 e。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-10T12:55:38.933

另一种选择是反转所有内容，因此它匹配您不想允许的字符：

```
Regex oReg = new Regex(@"[^0-9dD+]");
!oReg.IsMatch("e4"); 
```

# linq - LINQ 练习题还是谜题？

> ID：191084
> 
> 赞同：22
> 
> 时间：2008-10-10T12:47:44.410
> 
> 标签：linq

我仍在努力学习 LINQ，虽然现在我已经开始在工作中每天使用它，但它变得更加顺利。不过，我还是觉得不太*好*。有没有人有任何具有挑战性的练习或谜题，我可以用它作为密码来提高我的技能？

我将把它作为社区 wiki 保留，所以也许它可以成长为一个社区列表。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-10T12:57:25.967

如果您还没有发现[http://www.linqpad.net/](http://www.linqpad.net/)，它可以让您以轻量级的方式练习 linq，以及从 C# 5.0 简而言之和 C# in Depth 书籍中的一些内置示例。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-10T12:49:39.040

[101 Linq Samples](https://docs.microsoft.com/en-us/samples/dotnet/try-samples/101-linq-samples/)是一个很好的参考。虽然不是谜题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T14:20:11.977

谜：

在 LINQ 中进行完全外部联接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T12:52:11.297

我知道 Project Euler 的第 2 个问题对“LINQ”很友好，我再也没有做过了，但无论哪种方式都应该很有趣 :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T13:00:19.470

我一直在现有代码中找到“foreach”并尝试对它们进行 linq'ify。很多时候，事情已经不同，足以让我学习新概念，或者至少如果它们相似，我会更有信心相信我的 Linq 技能正在变得更好。

# build-process - 您推荐哪些工具来自动构建您的应用程序？

> ID：191093
> 
> 赞同：8
> 
> 时间：2008-10-10T12:49:26.263
> 
> 标签：build-process, build-automation

就在几年前，开发人员实际上制作了交付给客户的版本。这显然是一场灾难，原因不胜枚举。

然后，当我们开始了解我们方法的错误时，我们寻找一种在专用构建机器上自动构建整个应用程序的方法。当时的文化非常反对引入外部工具，因此我们通过编写 VB 应用程序构建了自己的自动构建系统。

这工作了一段时间，直到项目的结构开始改变，添加了新项目，我们需要以不同的方式构建应用程序。然后，我们的手动汽车制造商的弱点变得明显，并且随着时间的推移，变得越来越繁重。这种疾病现在已经发展到 QA（拥有我们的构建过程）甚至无法维护自动构建器的地步，因为它需要越来越多的编程技能。每次我们添加项目或更改现有项目中的某些内容时，它都会消耗更多的开发人员时间来使其正常工作。曾经有几天我们因为系统损坏而无法生成构建。

我现在处于可以改变这个过程的位置，我希望废弃整个系统并在它的位置放置其他东西。我的目标是：

*   拥有一个可以在每天特定时间以零人工交互运行的自动构建系统。它应该能够收集所有源代码、编译所有应用程序、创建设置、将成品放在网络共享上，并可能触发自动化测试系统启动（我们使用 QTP）。
*   自动构建系统应该足够灵活，可以轻松适应项目的变化，而无需进行大修。
*   它应该足够简单，以便 QA 可以拥有系统，而不需要开发人员资源来更改构建的方式。

你有什么经验？你能推荐一个自动构建系统吗？我应该有不同的目标吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T12:52:29.673

我目前正在使用与 Ant 集成的 CruiseControl 来控制项目构建。这允许构建计划的灵活性，并意味着您可以使用 Ant 脚本相当容易地自动化整个构建过程。此外，在缺陷修复期间，您可以将 CruiseControl 设置为监视源代码控制提交而不是时间段，并在这些发生时进行构建。这允许开发人员非常快速地反馈缺陷修复。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T14:15:53.700

我使用 FinalBuilder 和 FinalBuilder Server 进行夜间构建。有时它有点错误，但如果您认为它很容易创建可以构建 X 项目类型的可扩展项目，从更改脚本构建它的数据库并将其部署到测试服务器。

它还可以处理各种奇怪而奇妙的事情，例如压缩夜间构建并将其上传到 FTP 或自动创建 ISO 映像。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-10T12:59:39.503

如果您在 Microsoft 堆栈中，请务必查看 MSBuild。

Joel 一直在不断地谈论[FinalBuilder](http://www.finalbuilder.com/)有多棒，所以这也值得一看。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-10T13:22:00.440

我们刚刚从一组手动 Perl 脚本迁移到[Buildbot](http://buildbot.net/trac)设置。我找到它是因为这是[Google 用于 Chrome 的](http://build.chromium.org/buildbot/waterfall/waterfall)。

你可以做夜间工作，或者它可以与源代码控制集成，以便在任何人进行签入或其他各种事情时进行隔离测试构建。它也是并行的；您可以在构建农场中拥有多台机器，用于特殊任务或仅用于处理更多负载。

整个系统是用 Python 编写的，因此它与平台无关，如果您需要在多个平台上进行构建，这一点很重要。它可以做任何你可以从命令行做的事情；我们让它为用户模式组件调用 MSBuild，`build`为内核模式部件调用 DDK，并为单元测试构建运行产品。

开箱即用它支持[大多数 OSS 源代码控制工具](http://buildbot.net/repos/release/docs/buildbot.html#toc_Build-Process)，但是如果您使用 TFS 或其他东西，您可能需要修改安装在从机上的包。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-10T14:04:01.010

我认为你在这里是正确的。

负责您的自动化构建过程的任何人都需要对您的解决方案如何组合有一个基本的了解。这并不一定意味着知道如何编写代码或架构解决方案，但他们需要对解决方案如何编译、打包等有深入的了解。

您可能需要在人员或团队之间分担构建责任才能完成此任务。我会说每日构建是“团队责任”。

我会考虑建立一个基线构建配置，它可以扩展为“特殊用途”构建（除了构建发布版本），例如国际化发布、fxCop/质量工具配置、构建+运行单元测试、持续集成构建、构建配置以在开发人员工作站等上运行。

相反，我的目标是实现以下目标：

*   自动版本控制、签名等*   能够生成详细输出（日志记录）以帮助调试构建中断*   在这一点上 - 它应该正确处理错误，捕获尽可能多的信息并正确记录它*   一致性 - 每次都应该以相同的方式工作以产生可重复的结果*   在干净、访问受限的环境中运行*   很好的评论/记录，以便新员工等可以理解。*   生成发行说明、编译指标、生成报告的选项（如果此选项可用）*   能够部署到多个环境*   支持从源代码管理中获取源代码的不同方式，例如通过变更集、标签、日期等

至于工具推荐，我使用了 FinalBuilder、Visual Build Pro、MSBuild/Team Build、nAnt、CruiseControl 和 CIFactory plus 以及老式的批处理文件。

每个都有其优点和缺点，我不打算提出建议，只是说具有良好 UI 支持的产品更易于使用，但有时功能远没有那么强大。如果您使用 VIsual Studio，MSBuild 非常强大，但学习曲线有些陡峭。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T12:54:51.680

对于随 MS Visual Studio 提供的工具，您可能希望使用 MSBuild。MSBuild 的其他[社区](http://msbuildtasks.tigris.org/)工具集甚至可以让您从 Subversion 和 zip 输出中签出代码。

我们正在公司成功地使用它。项目由多个解决方案组成，包含 100 多个子项目。奇迹般有效。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-10T12:58:43.683

[如果您的构建机器是 Windows， Visual Build Pro](http://www.kinook.com/VisBuildPro/features.html)很好。我认为这将满足您对***拥有该系统的 QA***的要求。但是不要误会我的意思，它非常强大。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-16T18:57:45.747

我们使用 CruiseControl.NET 和 UppercuT（使用 NAnt）来做到这一点。UppercuT 使用约定进行构建，因此通过回答三个问题（解决方案的名称是什么？源代码控制的路径是什么？贵公司的名称是什么？），您就可以很容易地开始构建。

[http://code.google.com/p/uppercut/](http://code.google.com/p/uppercut/)

这里有一些很好的解释：[Uppercut](http://ferventcoder.com/category/10094.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-04T21:35:48.997

我们使用 Hudson buildbot 从 ant 构建脚本构建大型 Java Web 应用程序。哈德逊对我们来说非常甜蜜。它具有主/从设置，因此可以同时进行构建（在计时器上或按需）。从节点可以是任何操作系统/硬件组合，只要它已经具有所需的构建工具并且在网络上（并且不会每 10 分钟崩溃一次）。

完整的基于 Web 的界面，包括实时控制台输出、更改日志、构建中的工件可在整个网络中使用，包括以前的构建（如果成功）。很棒的酱！

# asp.net - 为什么我应该在 CompositeControl 上的 CreateChildControls() 中创建我的子控件？

> ID：191125
> 
> 赞同：2
> 
> 时间：2008-10-10T12:55:35.283
> 
> 标签：asp.net, composite-controls

好的，显而易见的答案是，因为复合控件的流程要求在某个时间点创建我的子控件。我遇到了一个问题，我认为其他人一定也遇到过。

我的控件是一个复合“容器/集合”控件。它将被提供一个对象，并基于该对象数据创建许多子控件。所以我的控件将呈现一个标题（总是）和 x 数，比如 TextBox 控件（基于它所提供的对象）。

我显然在 CreateChildControls() 中创建了我的标题，但我也无法在那里创建我的 TextBoxes，因为我不知道对象（作为 TextBoxes 的基础）是否已经被输入？我想过公开一个属性/方法来设置/提供对象，但我不确定它什么时候会被调用。

那我该怎么办？我的意思是我不可能在 CreateChildControls() 中创建文本框，或者我可以吗？我的意思是 - 什么时候调用 CreateChildControls() - 我知道我可以调用 EnsureChildControls() （我已经在一个属性中设置了标题的 innerText - 因为我需要在设置它的 innerText 之前创建标题）。

这个怎么样

```
var c = new MyContainerControl();
c.Header = "fun";
c.TextBoxObject = myTextBoxes; 
```

如果我将文本框的构建放在 CreateChildControls() 中，那将引发错误（或充其量不会创建任何文本框）。

将 Header 存储在成员变量中会不会更明智，因此不必在设置 Header 内部文本的公开方法/属性中调用 EnsureChildControls()。我只是不太喜欢这种方法，因为它会通过添加额外的逻辑来临时存储并且稍后必须弄清楚何时设置它（可能在 PreRender 中）会使事情复杂化。

另外我想我可以制作某种数据绑定控件，确保在调用 .DataBind() 时数据存在。我真的不喜欢这个，因为上次我研究了创建数据绑定控件，它变得非常复杂。

这真的应该是一个容易解决的任务 - 我知道我在某处遗漏了一些东西......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T13:02:32.570

你所描述的是一个数据绑定控件。是的，它有点复杂，但它是这种类型实例的正确设计范式。

也就是说，您是否考虑过使用中继器控件，而不是尝试推出您自己的以完全相同的方式运行的复合材料？与其传递一个随机对象，不如传递一个集合或一个 iList 以及您想要的文本区域数量。

# windows-mobile - Windows Mobile 应用程序的 UI 组件 (.NET Compact Framework)

> ID：191136
> 
> 赞同：13
> 
> 时间：2008-10-10T12:57:41.940
> 
> 标签：windows-mobile, compact-framework, controls, user-interface

在移动设备上运行的应用程序具有特殊的用户界面要求。我认为 Apple 在 iPhone/iPod touch 平台上引入创新控件做得很好。

现在，我必须使用 .NET Compact Framework (Visual Studio 2008) 为 Windows Mobile 平台设计一个应用程序。我想知道是否有一些类似于 iPhone / iPod touch UI 元素的商业或开源 UI 控件集可用：

*   基于手势的滚动面板
*   而不是下拉列表：一个包含大量项目列表的新面板
*   滑动面板
*   *等等*

我找不到任何有用的产品/代码。也许那里有更多经验的人可以提供帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T17:07:51.997

我知道[Resco](http://resco.net)有一些用于 Windows Mobile .net 的基于“触摸”的列表和网格控件。我们使用了他们的一些东西（但不使用“触摸”功能），到目前为止，它们对我们来说效果很好。例如，这里是他们的[SmartGrid.NET](http://www.resco.net/developer/mobileformstoolkit/details.aspx?p=WindowsMobile&comp=SmartGrid)控件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T13:57:45.437

几个月前，我搜索了一下，一无所获（满意）。我必须实现自己的控件库。缺乏良好的现有“触摸感知”库使我认为我应该将我的商业化，但它非常不完整。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-05T18:40:26.667

我在周末拿起了 Mirabyte 的 Touch Controls v1.0 产品。
*[现已发布1.5版]*

**积极的：**

*   当你让它工作时，它看起来非常漂亮，而且动态滚动也很好。
*   你可以左右滑动来回走动。
*   在论坛上提出的问题似乎很快就得到了回答。
*   您可以使用基于资源的图像来制作 alpha 透明图像
*   他们似乎做了很多工作来改进论坛上要求的东西。

**消极的**

*   演示中使用的架构不是我认为的最佳实践。（有一个 PageHandler 类可以处理从旋转按钮、页面、菜单等使用部分类跨 5 个文件拆分的所有内容）。
*   没有文档或评论。
*   使用透明图像的机制严重依赖字符串，缺乏使用自己图像的动态方式。
*   这是一个非常基于列表的 UI，您最终可能会得到它可能符合您的口味，也可能不符合您的口味。
*   继承控件的入口点很少，没有来源。

总而言之，我会推荐它们，它们为您提供了一种创建类似 UI 的 iPhone 的好方法。请注意，仍然存在初期问题和缺乏文档。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-08-05T18:47:42.533

还有一个名为 Fluid Controls 的开源项目。他们住[在这里](http://fluid.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=23310)。[这里](http://www.codeproject.com/KB/mobile/MobilePasswordSafe.aspx)有一个实现。

看起来你可以用它创建一些不错的接口，但是它确实需要大量的代码来做。

例如，要创建一个列表，需要一个继承的 ListBox 类和一个显式创建和定位所有控件的模板。

不过，如果您不想花 50 欧元购买 Mirabyte 或花 600 美元购买 Roscos 工具，这仍然是一个不错的选择。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-08T10:29:11.413

[mirabyte](http://www.mirabyte.com)最近发布了[Touch Controls](http://www.mirabyte.com/en/products/windows-mobile.html)，它为列表和菜单提供了非常灵活的控制。In 还具有动态滚动等功能。好消息是它是一个 100% 的 .NETCF 组件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T23:09:27.133

我们通过在 Adob​​e After Effects 中创建 .png 序列然后在图片框中旋转图像来伪造很多静态动画。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-10T05:15:08.387

pocketwit 是开源的，界面很酷

[http://code.google.com/p/pocketwit/](http://code.google.com/p/pocketwit/)

**Kinetic List** - 主列表实现“动态滚动”。 **侧边菜单**- 操作菜单位于主菜单的两侧。因此，如果您将列表向左或向右拖动，您将在列表旁边看到一个操作菜单。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-04-22T09:24:41.930

您也可以考虑查看我们公司用于 Win Mobile 开发的**SlideUI [.NET CF UI 控件。](http://www.devslide.com/products/slideui)**它包含针对手指优化的设计时可用控件的丰富列表（按钮、编辑、绘画框、动态滚动列表等）。请访问 SlideUI 的网站**www.devslide.com/products/slideui**

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-07-15T15:14:48.507

我试过 Mirabyte 和 SlideUI。我下载并玩了他们两个。SlideUI 控件（1.6）非常好，我不得不说我印象深刻。我现在正在从他们那里设置学生许可证。我会向任何寻求更简单的方法来制作漂亮的应用程序而无需创建自己的设计和控件的人推荐这个。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-08-08T04:01:25.983

搜索[Sense SDK](http://forum.xda-developers.com/showthread.php?t=648906)，用于手指友好 UI 开发的优秀免费软件 API。我必须尝试 Touch Controls（好，但不是免费）、Fluid（过时）和 Silvermoon（兼容性差），而 Sense SDK 是最好的！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-07-27T12:26:38.713

mirabyte，看起来不错，但你不能在一些测试应用程序中尝试他们的触摸控件组件，只提供一个示例应用程序。否则，您将看不到如何查看应用程序的内部。

在我看来，你应该选择 resco，他们在 PocketPC 平台上工作了很多年，他们知道什么是性能和应用程序的可扩展性、可用性、用户友好性等。

最后，我喜欢 resco 最新版的 mobile studio 2009。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-05-06T11:17:57.540

如果您正在 Windows Mobile 上寻找类似 iPhone 的 GUI，请查看 Bee Mobile，网址为[http://beemobile4.net](http://beemobile4.net)

他们提供了他们的 iPack——一组 .NET CF 控件，提供类似 iPhone 的 GUI。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-05-30T20:55:19.223

我个人会推荐[mirabyte 的 Touch Controls Suite 2](http://www.mirabyte.com/en/products/windows-mobile/touch-controls-suite-for-netcf/information.html)。新版本 2 比第一个版本好得多（出色的性能，低内存消耗），它们可能是物有所值的。我在一些客户项目中使用了它们，我对它们非常满意，也因为他们支持论坛中非常活跃的社区对我帮助很大！

# database - 数据库开发组织

> ID：191137
> 
> 赞同：3
> 
> 时间：2008-10-10T12:58:01.253
> 
> 标签：database, version-control, obfuscation

关于数据库开发项目的问题。数据库已经存在并且相当大（几个 TB）。

1.  您在数据库开发中使用什么进行版本控制？
2.  您如何控制不同团队对数据模型的并发更改
3.  您在数据库开发中进行单元测试的方法是什么
4.  如果数据库所有者不知道什么是敏感数据，您如何处理敏感数据？你对数据混淆的方法是什么？你的混淆技术是什么？
5.  您如何从多个位置处理大型数据库？

请按您认为合适的方式回答一项或多项。每个答案将单独审查。非常感谢你！

**编辑：** 这里有一个对 p.1 有很好答案的相关问题：[你如何对数据库模式进行版本控制？](https://stackoverflow.com/questions/175451/how-do-you-version-your-database-schema)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T13:03:24.457

对于4，“如果数据库所有者不知道什么是敏感数据，您如何处理敏感数据？您对数据混淆的方法是什么？”

“敏感直到被证明是无害的”是我的口头禅。除非有人提出不能充分保护任何数据免受可见性（内部或外部）的理由，否则我的默认模式是保护它。

稍后会出现案例，我们将出于性能、报告等原因开放数据，但需要具有适当签名的书面业务案例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T13:08:20.577

对于其中大多数，虽然这些工具不应用代码开发的一般流程，但可以：

*   使用足够的数据维护与生产分开的开发系统，以便在测试新模型时获得有用的性能指标
*   该系统在每个版本之前编写并运行单元测试（SQL 查询、提交、中止的原子提交等）。
*   有官方“发布”
*   开发数据库是源代码控制系统本身 - 换句话说，数据库是通过登录和回滚等建模并保存在数据库中的。它不平凡，并不能解决所有问题，但鉴于缺乏良好的VCS 适用于它的数据库。
*   推出（在测试、集成等之后）仅包含进入生产站点的新数据库结构 - 建模表不会在那里复制。

# c# - 实体框架验证

> ID：191143
> 
> 赞同：17
> 
> 时间：2008-10-10T12:58:57.833
> 
> 标签：c#, .net, entity-framework, validation

我正准备开始一个新项目，我一直在研究实体框架。我的问题是验证实体的最佳策略是什么？我从事的其他项目在大多数验证中都使用了属性，但显然这在实体框架中是不可能的。是通过处理属性设置器中的部分方法来做到这一点的唯一方法吗？非常感谢所有建议。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-19T03:30:26.460

我以前没有真正使用过实体框架，但快速搜索表明您有几个选择。

1) 在应用程序的另一层进行验证

总是一个选择，我只是想我会明确地把它扔掉。

2) 挂钩实体的 OnChanged 事件，然后执行验证

如果您有许多不同的属性可以为每个实体更改，则可能会很脆弱并且会变得混乱/缓慢。

3) 实现部分方法来验证属性更改

根据[这篇](http://www.simple-talk.com/dotnet/.net-framework/entity-framework-the-cribsheet/)文章和[这篇](http://msdn.microsoft.com/en-us/library/bb629301.aspx)演练，有部分方法可用于验证。这似乎是您的最佳选择，因为它不是很侵入性，您可以有选择地实施您想要的验证。

我希望这会有所帮助。祝你好运。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-01-15T01:39:20.240

在 .NET 4 中，Entity-Framework 将提供开箱即用的验证支持。

查看：http: [//blogs.msdn.com/adonet/archive/2010/01/13/introducing-the-portable-extensible-metadata.aspx](http://blogs.msdn.com/adonet/archive/2010/01/13/introducing-the-portable-extensible-metadata.aspx)

所以不要努力实现过于复杂的验证逻辑......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-19T11:33:18.093

如果您使用 ASP.NET MVC，那么您可以使用验证应用程序块或 System.ComponentModel.DataAnnotations。[Using Data Annotations](http://bradwilson.typepad.com/blog/2009/04/dataannotations-and-aspnet-mvc.html)和[Using Application Block](http://msdn.microsoft.com/en-us/library/cc309320.aspx)两篇文章展示了如何使用 Linq 进行操作，但与 entity-framework 的用法应该类似。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-14T08:47:32.650

我们已经覆盖了对象上下文并拦截了 SaveChanges() 方法

```
public abstract class ValidationObjectContext : ObjectContext{
    ...

    public override int SaveChanges(SaveOptions options){
        ValidateEntities();
        return base.SaveChanges(options);
    }

} 
```

That way the validation is left until the last minute before the connections are made but after you are (expecting) to be happy with the graph and ready to commit, (as opposed to other options to validation on any change, since some complex rules like those we have are only valid after several properties are set.). We have two levels of validation, Basic Property validation, things like string length, nullability etc. And Business Logic validation, which might require checking rules across multiple objects, possibly hitting the database to confirm.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-28T17:00:47.317

如果您使用的是 WPF 或 Windows 窗体，那么您可能会实现**IDataErrorInfo**接口。

**[WPF 应用程序框架 (WAF)](http://waf.codeplex.com)**项目的**BookLibrary**示例应用程序展示了如何验证由实体框架创建的实体。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-20T16:23:59.700

Consider implementing IValidatableObject in your entities.

# c# - 存储静态单元测试变量的最佳方法是什么？

> ID：191151
> 
> 赞同：1
> 
> 时间：2008-10-10T13:01:38.407
> 
> 标签：c#, .net, unit-testing, nunit

我目前正在使用 NUnit 并测试一个类库。到目前为止，我在测试类的顶部使用了一个常量列表来保存一些静态测试变量。这是最好的方法，还是有更流畅的方法来处理它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T13:11:13.177

您所说的“静态测试变量”实际上是指常量（无论是真正的常量、不可变实例还是您不更改的实例）？我经常使用这些，只是把它们放在测试类的顶部。

如果有多个相关的测试类，则可以很方便地将常用值分离到不同的类中。（它*可以*充当您的基类，但我不太喜欢使用继承来更轻松地访问事物。Java 静态导入在那里很方便......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T13:17:14.660

只要有可能，我就会在外部将数据存储在一个 xml 文件中，然后我们会将该文件检查到源代码控制中。

# c# - 什么时候在 C# 中使用委托？

> ID：191153
> 
> 赞同：102
> 
> 时间：2008-10-10T13:02:06.487
> 
> 标签：c#, .net, delegates

您在 C# 中对委托的使用是什么？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2008-10-10T13:07:45.790

现在我们在 C# 中有 lambda 表达式和匿名方法，我更多地使用委托。在 C# 1 中，您总是必须有一个单独的方法来实现逻辑，使用委托通常没有意义。这些天我使用代表：

*   事件处理程序（用于 GUI 等）
*   启动线程
*   回调（例如异步 API）
*   LINQ 和类似（List.Find 等）
*   我想在其他任何地方有效地应用带有一些专门逻辑的“模板”代码（委托提供专门化的地方）

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-07-31T19:00:18.457

代表对许多用途都非常有用。

一个这样的目的是使用它们来过滤数据序列。在这种情况下，您将使用一个谓词委托，它接受一个参数并根据委托本身的实现返回真或假。

这是一个愚蠢的例子——我相信你可以从中推断出更有用的东西：

```
using System;
using System.Linq;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        List<String> names = new List<String>
        {
            "Nicole Hare",
            "Michael Hare",
            "Joe Hare",
            "Sammy Hare",
            "George Washington",
        };

        // Here I am passing "inMyFamily" to the "Where" extension method
        // on my List<String>.  The C# compiler automatically creates 
        // a delegate instance for me.
        IEnumerable<String> myFamily = names.Where(inMyFamily);

        foreach (String name in myFamily)
            Console.WriteLine(name);
    }

    static Boolean inMyFamily(String name)
    {
        return name.EndsWith("Hare");
    }
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-10-16T18:12:31.910

找到另一个有趣的答案：

> 一位同事刚刚问了我这个问题——.NET 中的代表有什么意义？我的回答很简短，而且他没有在网上找到：延迟执行方法。

资料来源：[LosTechies](http://www.lostechies.com/blogs/derickbailey/archive/2008/10/09/what-s-the-point-of-delegates-in-net.aspx)

就像 LINQ 正在做的那样。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-07-31T19:04:55.967

委托通常可以用一种方法代替接口，一个常见的例子就是观察者模式。在其他语言中，如果您想收到发生某事的通知，您可以定义如下内容：

```
class IObserver{ void Notify(...); } 
```

在 C# 中，这更常使用事件来表达，其中处理程序是委托，例如：

```
myObject.SomeEvent += delegate{ Console.WriteLine("..."); }; 
```

如果您必须将谓词传递给函数，例如从列表中选择一组项目时，另一个使用委托的好地方：

```
myList.Where(i => i > 10); 
```

上面是 lambda 语法的一个例子，它也可以写成如下：

```
myList.Where(delegate(int i){ return i > 10; }); 
```

使用委托的另一个有用的地方是注册工厂函数，例如：

```
myFactory.RegisterFactory(Widgets.Foo, () => new FooWidget());
var widget = myFactory.BuildWidget(Widgets.Foo); 
```

我希望这有帮助！

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-10-10T13:27:07.217

您可以使用委托来声明函数类型的变量和参数。

**例子**

考虑“资源借用”模式。您希望控制资源的创建和清理，同时允许客户端代码在两者之间“借用”资源。

这声明了一个委托类型。

```
public delegate void DataReaderUser( System.Data.IDataReader dataReader ); 
```

任何匹配此签名的方法都可用于实例化此类型的委托。在 C# 2.0 中，这可以隐式地完成，只需使用方法的名称，也可以使用匿名方法。

此方法使用类型作为参数。注意委托的调用。

```
public class DataProvider
{
    protected string _connectionString;

    public DataProvider( string psConnectionString )
    {
        _connectionString = psConnectionString;
    }

    public void UseReader( string psSELECT, DataReaderUser readerUser )
    {
        using ( SqlConnection connection = new SqlConnection( _connectionString ) )
        try
        {
            SqlCommand command = new SqlCommand( psSELECT, connection );
            connection.Open();
            SqlDataReader reader = command.ExecuteReader();

            while ( reader.Read() )
                readerUser( reader );  // the delegate is invoked
        }
        catch ( System.Exception ex )
        {
            // handle exception
            throw ex;
        }
    }
} 
```

可以使用匿名方法调用该函数，如下所示。请注意，匿名方法可以使用在其*外部*声明的变量。这非常方便（尽管这个例子有点做作）。

```
string sTableName = "test";
string sQuery = "SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='" + sTableName + "'";

DataProvider.UseReader( sQuery,
    delegate( System.Data.IDataReader reader )
    {
        Console.WriteLine( sTableName + "." + reader[0] );
    } ); 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2012-10-05T22:01:00.420

我很晚才加入，但我今天很难弄清楚代表的目的，并编写了两个简单的程序，它们给出的输出相同，我认为很好地解释了它们的目的。

NoDelegates.cs

```
using System;

public class Test {
    public const int MAX_VALUE = 255;
    public const int MIN_VALUE = 10;

    public static void checkInt(int a) {
        Console.Write("checkInt result of {0}: ", a);
        if (a < MAX_VALUE && a > MIN_VALUE)
            Console.WriteLine("max and min value is valid");
        else
            Console.WriteLine("max and min value is not valid");
    }

    public static void checkMax(int a) {
        Console.Write("checkMax result of {0}: ", a);
        if (a < MAX_VALUE)
            Console.WriteLine("max value is valid");
        else
            Console.WriteLine("max value is not valid");
    }

    public static void checkMin(int a) {
        Console.Write("checkMin result of {0}: ", a);
        if (a > MIN_VALUE)
            Console.WriteLine("min value is valid");
        else
            Console.WriteLine("min value is not valid");
        Console.WriteLine("");
    }
}

public class Driver {
    public static void Main(string [] args) {
        Test.checkInt(1);
        Test.checkMax(1);
        Test.checkMin(1);

        Test.checkInt(10);
        Test.checkMax(10);
        Test.checkMin(10);

        Test.checkInt(20);
        Test.checkMax(20);
        Test.checkMin(20);

        Test.checkInt(30);
        Test.checkMax(30);
        Test.checkMin(30);

        Test.checkInt(254);
        Test.checkMax(254);
        Test.checkMin(254);

        Test.checkInt(255);
        Test.checkMax(255);
        Test.checkMin(255);

        Test.checkInt(256);
        Test.checkMax(256);
        Test.checkMin(256);
    }
} 
```

代表.cs

```
using System;

public delegate void Valid(int a);

public class Test {
    public const int MAX_VALUE = 255;
    public const int MIN_VALUE = 10;

    public static void checkInt(int a) {
        Console.Write("checkInt result of {0}: ", a);
        if (a < MAX_VALUE && a > MIN_VALUE)
            Console.WriteLine("max and min value is valid");
        else
            Console.WriteLine("max and min value is not valid");
    }

    public static void checkMax(int a) {
        Console.Write("checkMax result of {0}: ", a);
        if (a < MAX_VALUE)
            Console.WriteLine("max value is valid");
        else
            Console.WriteLine("max value is not valid");
    }

    public static void checkMin(int a) {
        Console.Write("checkMin result of {0}: ", a);
        if (a > MIN_VALUE)
            Console.WriteLine("min value is valid");
        else
            Console.WriteLine("min value is not valid");
        Console.WriteLine("");
    }
}

public class Driver {
    public static void Main(string [] args) {
        Valid v1 = new Valid(Test.checkInt);
        v1 += new Valid(Test.checkMax);
        v1 += new Valid(Test.checkMin);
        v1(1);
        v1(10);
        v1(20);
        v1(30);
        v1(254);
        v1(255);
        v1(256);
    }
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-10T13:19:27.730

稍微不同的用途是加速反射；即不是每次都使用反射，您可以使用`Delegate.CreateDelegate`为方法（a）创建一个（类型化的）委托`MethodInfo`，然后调用该委托。由于检查已经完成，因此每次调用都会*更快。*

使用`Expression`，您也可以执行相同的操作来动态创建代码 - 例如，您可以轻松地`Expression`为运行时选择的类型创建一个表示 + 运算符（为泛型提供运算符支持，该语言不提供） ; 你可以编译`Expression`一个类型化的委托 - 工作完成。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-07-31T19:01:07.143

每当您使用事件时都会使用委托 - 这就是它们的工作机制。

此外，委托对于诸如使用 LINQ 查询之类的事情非常有用。例如，许多 LINQ 查询采用`Func<T,TResult>`可用于过滤的委托（通常）。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-10T13:05:11.800

为事件订阅事件处理程序

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-10-10T21:33:06.737

一个例子可能是在[这里](http://msdn.microsoft.com/en-us/library/aa288459%28v=vs.71%29.aspx)看到的。您有一种方法来处理满足某些要求的对象。但是，您希望能够以多种方式处理对象。不必创建单独的方法，您可以简单地将处理对象的匹配方法分配给委托，并将委托传递给选择对象的方法。这样，您可以将不同的方法分配给一个选择器方法。我试图让这很容易理解。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-21T03:41:02.230

我使用委托与线程进行通信。

例如，我可能有一个下载文件的 win forms 应用程序。该应用程序启动一个工作线程来进行下载（这可以防止 GUI 锁定）。工作线程使用委托将状态消息（例如下载进度）发送回主程序，以便 GUI 可以更新状态栏。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-10T13:07:52.247

1.  对于事件处理程序

2.  在方法参数中传递方法

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-10T13:08:03.323

第一行的用法是替换 Observer/Observable（事件）模式。第二个，一个漂亮优雅的策略模式版本。可以收集各种其他用法，尽管比我认为的前两个更深奥。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-10T13:08:13.463

事件，其他anynch操作

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-10T13:09:56.657

任何时候你想封装行为，但以统一的方式调用它。事件处理程序、回调函数等。您可以使用接口和强制转换来完成类似的事情，但有时，行为不一定与*类型*或*对象*相关联。有时你只是有你需要封装的行为。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-10T13:18:12.163

懒惰的参数初始化！除了所有先前的答案（策略模式、观察者模式等）之外，委托还允许您处理参数的延迟初始化。例如，假设您有一个函数 Download()，它需要相当多的时间并返回某个 DownloadedObject。此对象由存储根据特定条件消耗。通常，您会：

```
storage.Store(conditions, Download(item)) 
```

但是，使用委托（更准确地说，lambdas），您可以通过更改 store 的签名来执行以下操作，以便它接收 Condition 和 Func<Item,DownloadedObject> 并像这样使用它：

```
storage.Store(conditions, (item) => Download(item)) 
```

因此，存储只会在必要时评估委托，根据条件执行下载。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-10T13:37:41.673

代表的使用

1.  事件处理
2.  多铸件

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-11T15:12:19.373

In Array.Sort(T[] array,Comparison comparison)、List.Sort(Comparison comparison)等中的比较参数

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-08-25T16:25:02.717

据我所知，委托可以转换为函数指针。当与采用函数指针的本机代码进行互操作时，这使得生活变得更加容易，因为它们可以有效地面向对象，即使最初的程序员没有为此做任何准备。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2012-02-07T04:43:52.853

委托用于通过引用调用方法。例如：

```
 delegate void del_(int no1,int no2);
class Math
{
   public static void add(int x,int y)
   {
     Console.WriteLine(x+y);
   }
   public static void sub(int x,int y)
   {
     Console.WriteLine(x-y);
   }
}

    class Program
    {
        static void Main(string[] args)
        {
            del_ d1 = new del_(Math.add);
            d1(10, 20);
            del_ d2 = new del_(Math.sub);
            d2(20, 10);
            Console.ReadKey();
        }
    } 
```

# javascript - window.onload 对比

> ID：191157
> 
> 赞同：239
> 
> 时间：2008-10-10T13:03:33.003
> 
> 标签：javascript

`window.onload`事件和标签`onload`事件之间究竟有什么区别？`body`我什么时候使用 which 以及应该如何正确完成？

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2008-10-10T13:39:24.133

`window.onload = myOnloadFunc`并且`<body onload="myOnloadFunc();">`是使用**同一事件**的不同方式。但是使用`window.onload`不那么突兀——它将您的 JavaScript 从 HTML 中取出。

所有常见的 JavaScript 库、Prototype、ExtJS、Dojo、JQuery、YUI 等都为加载文档时发生的事件提供了很好的包装器。您可以侦听窗口 onLoad 事件并对此做出反应，但在下载所有资源之前不会触发 onLoad，因此在获取最后一个大图像之前不会执行您的事件处理程序。在某些情况下，这正是您想要的，在其他情况下，您可能会发现侦听 DOM 何时准备好更合适 - 此事件类似于 onLoad，但无需等待图像等下载即可触发。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-10-10T15:02:50.673

没有区别，但你不应该使用任何一个。

在许多浏览器中，`window.onload`直到所有图像都加载后才会触发事件，这不是您想要的。基于标准的浏览器有一个`DOMContentLoaded`更早触发的事件，但 IE 不支持它（在编写此答案时）。我建议使用支持跨浏览器 DOMContentLoaded 功能的 javascript 库，或者找到可以使用的编写良好的函数。jQuery`$(document).ready()`就是一个很好的例子。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2010-04-22T12:39:46.630

`window.onload`可以在没有身体的情况下工作。仅使用脚本标签创建页面并在浏览器中打开它。该页面不包含任何正文，但它仍然有效..

```
<script>
  function testSp()
  {
    alert("hit");
  }
  window.onload=testSp;
</script> 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-10T13:19:47.963

通常，我更喜欢**不**使用`<body onload=""`> 事件。我认为尽可能将行为与内容分开会更干净。

也就是说，在某些情况下（对我来说通常很少见）使用车身负载可以稍微提高速度。

`<head`我喜欢使用 Prototype，所以我通常在页面的 > 中放置类似这样的内容：

```
document.observe("dom:loaded", function(){
  alert('The DOM is loaded!');
}); 
```

或者

```
Event.observe(window, 'load', function(){
  alert('Window onload');
}); 
```

[以上是我在这里](https://stackoverflow.com/questions/49599/binding-custom-functions-to-dom-events-in-prototype)学到的技巧。我非常喜欢在 HTML 之外附加事件处理程序的概念。

（编辑以纠正代码中的拼写错误。）

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-09-11T18:53:18.343

'对一个客观问题有这么多主观答案。“不显眼”的 JavaScript 是一种迷信，就像永远不要使用 goto 的旧规则一样。以帮助您可靠地实现目标的方式编写代码，而不是根据某人的时尚宗教信仰。

任何人发现：

```
 <body onload="body_onload();"> 
```

过度分散注意力是过于自命不凡，并且没有明确他们的优先事项。

我通常将我的 JavaScript 代码放在一个单独的 .js 文件中，但我发现在 HTML 中挂钩事件处理程序并不麻烦，顺便说一句，这是有效的 HTML。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-10-28T10:42:14.980

`window.onload`- 在所有 DOM、JS 文件、图像、Iframe、扩展和其他文件完全加载后调用。这等于`$(window).load(function() {})`;

`<body onload="">`- 加载 DOM 后调用。这等于`$(document).ready(function() {})`;

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-10T13:11:25.813

没有**区别**...

所以原则上你可以同时使用两者（一次一个！-）

但为了可读性和 html 代码的简洁性，我总是更喜欢 window.onload ！o]

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-10T14:32:12.747

`<body onload="">`应该覆盖`window.onload`.

With `<body onload="">`,`document.body.onload`可能是 null、未定义或取决于浏览器的函数（尽管`getAttribute("onload")`对于将匿名函数的主体作为字符串获取应该有些一致）。使用`window.onload`，当您为其分配一个函数时，`window.onload`它将是一个跨浏览器一致的函数。如果这对您很重要，请使用`window.onload`.

无论如何，window.onload 更适合将 JS 与您的内容分开。没有太多理由使用`<body onload="">`; 无论如何，当你可以使用`window.onload`.

`window.onload`在 Opera 中， and的事件目标`<body onload="">`（甚至`window.addEventListener("load", func, false))`是窗口，而不是像 Safari 和 Firefox 中的文档。但是，“this”将是跨浏览器的窗口。

这意味着，当重要时，您应该包装杂物并使事情保持一致，或者使用为您完成它的库。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-10T13:18:36.297

如果你正在尝试编写不显眼的 JS 代码（你应该这样做），那么你不应该使用`<body onload="">`.

据我了解，不同的浏览器对这两者的处理方式略有不同，但它们的操作方式相似。在大多数浏览器中，如果您同时定义两者，其中一个将被忽略。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-10T14:11:16.860

像任何其他属性一样考虑 onload。例如，在输入框上，您可以输入：

```
<input id="test1" value="something"/> 
```

或者您可以致电：

```
document.getElementById('test1').value = "somethingelse"; 
```

onload 属性的工作方式相同，只是它使用函数作为其值，而不是像 value 属性那样使用字符串。这也解释了为什么您可以“只使用其中一个” - 调用 window.onload 为 body 标签重新分配 onload 属性的值。

另外，就像这里的其他人所说，通常将样式和 javascript 与页面内容分开会更干净，这就是为什么大多数人建议使用 window.onload 或类似 jQuery 的 ready 函数的原因。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-10T13:20:59.227

它们的工作方式相同。但是，请注意，如果两者都被定义，则只会调用其中之一。我通常避免直接使用它们中的任何一个。相反，您可以将事件处理程序附加到加载事件。通过这种方式，您可以更轻松地合并其他可能还需要将回调附加到 onload 事件的 JS 包。

任何 JS 框架都会有用于事件处理程序的跨浏览器方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-10T13:44:48.973

将内容、布局和行为分开是公认的标准。所以 window.onload() 将比`<body onload="">`两者都做同样的工作更适合使用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-06-15T12:47:26.133

很抱歉这个线程又沉睡了3年，再次轮回，但也许我终于找到了`window.onload=fn1;`over的无可争辩的好处`<body onload="fn1()">`。它涉及**JS 模块**或**ES 模块**：当您的`onload`处理程序驻留在“经典”JS 文件中时（即不使用 引用`<script type="module" … >`，任何一种方式都是可能的；当您的`onload`处理程序驻留在“模块”JS 文件中时（即使用 引用`<script type="module" … >`，`<body onload="fn1()">`将失败并显示“fn1 () 未定义”错误。原因可能是在解析 HTML 之前未加载 ES 模块……但这只是我的猜测。无论如何，`window.onload=fn1;`与模块完美配合……

# sql-server - 如何在 MSSQL 中将 VARCHAR 转换为 TIMESTAMP？

> ID：191159
> 
> 赞同：7
> 
> 时间：2008-10-10T13:04:21.240
> 
> 标签：sql-server, tsql, timestamp, varchar

您想调用 MS SQL 上的存储过程，该过程在 T-SQL 中具有 TIMESTAMP 参数类型，而不是使用 VARCHAR 值（例如“0x0000000002C490C8”）的 ADO.NET。

你做什么工作？

更新：这是您收到“时间戳”值但仅作为 VARCHAR 存在的地方。（想想另一个存储过程上的 OUTPUT 变量，但它已经固定为 VARCHAR，它只有一个 TIMESTAMP 的值）。因此，除非您决定构建动态 SQL，否则如何以编程方式将存储在 VARCHAR 中的值更改为有效的 TIMESTAMP？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-11-29T19:53:13.703

由于时间戳与 varbinary 兼容，SQL Server 2008 中的解决方案将是：

```
declare @hexstring varchar(max);
set @hexstring = '0xabcedf012439';
select CONVERT(varbinary(max), @hexstring, 1);

set @hexstring = 'abcedf012439';
select CONVERT(varbinary(max), @hexstring, 2); 
```

参考。[MSN 博客](http://blogs.msdn.com/b/sqltips/archive/2008/07/02/converting-from-hex-string-to-varbinary-and-vice-versa.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T13:07:40.313

TIMESTAMP 在语义上等同于 VARBINARY(8)（可为空）或 BINARY(8)（不可为空）。因此，您应该能够使用不带引号的参数调用该过程，如下所示：

```
EXEC usp_MyProc @myParam=0x0000000002C490C8 
```

另请参阅[SQL 联机丛书](http://msdn.microsoft.com/en-us/library/aa260631(SQL.80).aspx)

编辑更新的问题...

我只是尝试了一些实验。坦率地说，我很好奇你是如何把它表示为 varchar 的，因为当我做类似的事情时：

```
select top 10 convert(varchar, ts) from foo 
```

其中 ts 是时间戳，我得到 10 个空白行。（如果我不转换，我会看到我的时间戳。）

但是，我尝试从正确的方向努力……我这样做了：

```
select convert(timestamp, '0x0000000000170B2E') 
```

并且转换导致`0x3078303030303030`. 所以也不会玩。也不会转换为二进制。

我不想这么说，但您可能会陷入动态 SQL 世界。不过，我**真的**很想弄错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T22:53:48.457

时间戳数据类型由 SQL Server 管理。除了作为表格列类型之外，我从未见过它在任何地方使用过。在这种情况下，时间戳类型的列将为您提供与数据库中所有其他更新相关的行上最后一次插入/更新的严格序号。要查看整个数据库中最近的序号，您可以检索 @@DBTS 或 rowversion() 的值。

根据[http://msdn.microsoft.com/en-us/library/ms182776(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms182776(SQL.90).aspx)

> 时间戳 (Transact-SQL)
> 
> 是一种数据类型，可在数据库中公开自动生成的唯一二进制数。时间戳通常用作对表行进行版本标记的机制。存储大小为 8 个字节。时间戳数据类型只是一个递增的数字，不保留日期或时间。要记录日期或时间，请使用 datetime 数据类型。

因此，时间戳列的 volatile 值无法设置，并且会在对该行进行任何修改时发生变化。但是，您可以将时间戳值冻结为 varbinary(8) 值。

例如，假设您有一个源表和一个目标表。

```
CREATE TABLE tblSource (
Id int not null
colData int not null
colTimestamp timestamp null)

CREATE TABLE tblTarget (
Id int not null
colData int not null
colTimestampVarBinary varbinary(8) null) 
```

然后，在提取过程中，您可能希望捕获自上次运行提取过程以来已更新的所有内容。

```
DECLARE @maxFrozenTargetTimestamp varchar(8)
SELECT @maxFrozenTargetTimestamp = max(colStamp) FROM tblTarget

INSERT tblTarget(Id, colData, colTimestampVarBinary)
SELECT 
Id
,colData
colTimestampVarBinary = convert(varbinary(8) colTimestamp)
FROM 
tblSource 
WHERE
tblSource.colTimestamp > @maxFrozenTargetTimestamp 
```

如果您遇到问题，我的第一个猜测是您的问题的症结在于将 varchar 转换为 varbinary(8)，而不是时间戳类型。

有关更多信息（可能太多），请参阅我留下的博客文章[http://vadivel.blogspot.com/2004/10/about-timestamp-datatype-of-sql-server.html的评论（倒数第四） ?showComment=1213612020000](http://vadivel.blogspot.com/2004/10/about-timestamp-datatype-of-sql-server.html?showComment=1213612020000)

# svn - 如何将 SVN 工作副本中的版本和路径提取到 nant 变量中？

> ID：191160
> 
> 赞同：3
> 
> 时间：2008-10-10T13:04:29.197
> 
> 标签：svn, nant, svn-repository

我正在为要在 Subversion 中举行的 DotNet 项目创建一个新的构建过程。

对于我编译的每个 dll/exe（通过 Nant），我想在构建的 dll 中包含 2 个额外的属性。

我已经了解'asminfo' nant 任务的工作原理。但是我需要帮助来检索我希望嵌入到我的二进制文件中的信息。

构建将始终从完整的工作副本（由构建过程本身检出）进行，因此将始终具有可用的 .svn 目录。

我要添加的属性是 RepositoryVersion 和 RepositoryPath。（我知道这些不是这个信息在 svn 中的名称）

为此，我需要提取由 BuildFile 所在的工作副本文件夹表示的 RepositoryVersion 和 RepositoryPath。

**如何从任何给定的 .svn 文件夹中提取这些信息到 2 个 nant 变量中？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T13:14:37.210

首先，您可以使用“svn info --xml >out.xml”将 svn 信息保存到文本文件中。然后，您可以使用 Nant xml-peek 将文件中的值放入变量中。

```
<xmlpeek file="out.xml" xpath="/info/entry/url" property="svn.url" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-20T17:26:00.427

这就是我对修订号的做法：

```
<exec
    program="svn"
    commandline='log "${solution.dir}" --xml --limit 1'
    output="${solution.dir}\_revision.xml"
    failonerror="false"/>
<xmlpeek
    file="${solution.dir}\_revision.xml"
    xpath="/log/logentry/@revision"
    property="version.revision"
    failonerror="false"/>
<delete file="${solution.dir}\_revision.xml" failonerror="false"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T13:21:11.160

我建议您将[svn 关键字](http://svnbook.red-bean.com/en/1.4/svn.advanced.props.special.keywords.html)作为属性嵌入到您的构建文件中。例如：
`<property name="RepositoryPath" value="$HeadURL$" />`
`<property name="RepositoryVersion" value="$Revision$" />`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-10T13:10:04.643

.svn 目录中的条目实际上并不意味着可以直接访问。我不太了解您在做什么，但我建议您使用用于签出项目的机制来查找 HEAD 版本和路径。（我实际上假设因为您正在检查您已经知道路径的项目，但也许事实并非如此）。

抱歉，我不能提供比这更多的信息。

# .net - 如何在我的 .NET 应用程序中找到用户的字体？

> ID：191179
> 
> 赞同：2
> 
> 时间：2008-10-10T13:08:58.673
> 
> 标签：.net, windows, fonts

如何在 .NET 中使用 C# 找到用户在其 Windows 显示属性中设置的字体？

我想使用用户选择的字体显示表单。我想要的字体是在 Windows 显示属性表单中为 3D 对象、菜单和窗口标题栏选择的字体。但我找不到访问它们的方法。有一个`System.Windows.Forms.Control.DefaultFont`属性，但它返回的是 Windows 默认字体（我认为是 XP 上的 MS Sans Serif）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T13:20:24.967

查看 System.Drawing.Text.InstalledFontCollection 对象的 Families 属性。您应该能够遍历 Families 集合以获取所有用户的字体。不幸的是，这并不能识别您正在寻找的特定字体。

[http://msdn.microsoft.com/en-us/library/system.drawing.text.fontcollection.families.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.text.fontcollection.families.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T14:19:08.623

使用[SystemFonts](http://msdn.microsoft.com/en-us/library/system.drawing.systemfonts_members.aspx)类，您可以从用户选择的主题中获取字体。还返回用户自己进行的自定义。

顺便说一句：我（使用 XP）无法为 3D 对象选择字体，其他字体可用。

# sql-server - 从 SQL Server Express 生成的数据库可以与 SQL 的主要版本一起使用吗？

> ID：191184
> 
> 赞同：2
> 
> 时间：2008-10-10T13:09:22.400
> 
> 标签：sql-server, sql-server-express

我想在我的本地计算机上创建一个 SQL Server Express 数据库，然后将其上传到将使用完整 SQL Server 软件的网站 - 我可以这样做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T13:11:47.340

MS SQL Express 数据库与完整版的 MS SQL Server 完全兼容。所以只需备份和恢复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T13:13:16.760

是的，它们旨在兼容。您可以从数据库编写脚本，也可以使用 SQL Server Management Studio 中内置的备份/恢复功能。可以在[此处](http://www.microsoft.com/technet/prodtechnol/sql/2005/MgSQLExpwSSMSE.mspx)找到有关后者的更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T13:15:16.630

您可以非常轻松地从 SQL Express 迁移到完整的 SQL Server。有几种方法可以做到这一点，但最简单的方法是在 SQL Express 上备份有问题的数据库，安装完整版本的 SQL Server，然后在那里恢复数据库。两个程序都使用相同的数据库备份格式。但是，两个 SQL Server 实例都应该使用相同的排序规则进行配置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T11:32:39.173

更好的方法可能是购买[SQL Server Developer 版本。](https://rads.stackoverflow.com/amzn/click/com/B001B8EZR4) 它非常便宜，可以安装在 Windows XP 等桌面操作系统上。与 SQL Server Express 相比的主要优势在于它具有企业版的所有功能（CLR 存储过程、SSIS 等），并且您可以使用此功能进行开发。YMMV，您可能需要也可能不需要这些功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T11:42:21.307

你当然可以。你有几个选择：

1.  备份还原
2.  手动编写所有内容
3.  数据库发布向导

Microsoft SQL Server 数据库发布向导可以在这里找到：

[http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en)

# vim - 缩进注释以匹配 vim 中的代码

> ID：191201
> 
> 赞同：46
> 
> 时间：2008-10-10T13:15:09.470
> 
> 标签：vim

我在 vim 中完成所有编码并且对此非常满意（所以，请不要“使用不同的编辑器”响应），但一直有一个烦恼，因为 smartindent 功能根本不想缩进以 # 开头的注释。例如，我想要

```
 # Do something
  $x = $x + 1;
  if ($y) {
    # Do something else
    $y = $y + $z;
  } 
```

而不是 vim 的首选

```
# Do something
  $x = $x + 1;
  if ($y) {
# Do something else
    $y = $y + $z;
  } 
```

我能够防止将注释发送到行首的唯一方法是在点击 # 之前在行上插入和删除一个字符（每次都必须记住这样做的麻烦）或完全关闭 smartindent （在我打开/关闭大括号时丢失自动缩进增加/减少）。

如何设置 vim 以保持注释的缩进，而不是将它们发送到行首？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-10-10T13:27:40.180

看起来您正在使用 Perl 进行编码。确保在 .vimrc 中设置了以下内容：

```
filetype plugin indent on
syntax enable 
```

这些将告诉 Vim 在打开缓冲区时设置文件类型并配置缩进和语法高亮。无需显式设置 smartindent，因为 Vim 包含的 Perl 语法文件会自动设置它（以及任何其他 Perl 特定的自定义）。

* * *

*注意：有一个`set smartindent`和/或可能`set autoindent`会`~/.vimrc`阻止解决方案工作。如果您遇到问题，请寻找它们。*

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-02-24T04:44:34.987

如果你使用了 "smartindent" 缩进选项，你的问题的解决方法在 ":help smartindent" VIM 文档中有解释：

> ```
>  When typing '#' as the first character in a new line, the indent for
>     that line is removed, the '#' is put in the first column.  The indent
>     is restored for the next line.  If you don't want this, use this
>     mapping: ":inoremap # X^H#", where ^H is entered with CTRL-V CTRL-H.
>     When using the ">>" command, lines starting with '#' are not shifted
>     right. 
> ```

我使用“smartindent”并且可以确认所描述的修复对我有用。它通过输入“X”替换“#”的击键，然后按退格键，然后再次输入“#”来欺骗 VIM。您可以自己手动尝试，看看它不会触发自动凸凹。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-10T13:20:15.950

这个问题可以通过将以下内容放入您的 _vimrc 文件中来解决。

```
set cindent
set cinkeys=0{,0},!^F,o,O,e " default is: 0{,0},0),:,0#,!^F,o,O,e 
```

[更多信息](http://thenobot.org/stories/?i=117)...

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-10T13:20:09.257

我认为“smartindent”是为 C 设计的，所以它认为“#”是预处理器指令的开始而不是注释。我不知道它的解决方案，除非你输入一个空格，然后是退格键，然后是“#”，它不会那样做。

# powershell - 如何使用 PowerShell 或 VBScript 获取正在运行的应用程序列表

> ID：191206
> 
> 赞同：17
> 
> 时间：2008-10-10T13:16:01.823
> 
> 标签：powershell, scripting, vbscript

我需要使用 PowerShell 或 VBScript 以编程方式获取正在运行的应用程序列表，如 Windows 任务管理器内的“应用程序”选项卡中所示。

到目前为止，我只能找到如何使用 VBScript 和 WMI 列出进程。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-10T14:22:14.297

这让您在 PowerShell 中接近：

```
get-process | where-object {$_.mainwindowhandle -ne 0} | select-object name, mainwindowtitle 
```

或更短的版本：

```
gps | ? {$_.mainwindowhandle -ne 0} | select name, mainwindowtitle 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-13T22:15:01.097

@Steven Murawski：我注意到，如果我使用 mainwindowhandle，我当然会得到一些正在运行的进程，但不在“应用程序”选项卡中。像 explorer 和 UltraMon 等。你可以改为使用 mainwindowtitle，因为我遇到的那些进程没有窗口标题——就像这样

```
gps | ? {$_.mainwindowtitle.length -ne 0} | select name, mainwindowtitle 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-21T18:22:12.380

从您正在寻找的命令行：

`tasklist /v`这`/v`意味着详细，并将包括“应用程序运行每个进程的列表

`tasklist /v /fi "imagenaem eq POWERPNT.EXE"` 例如可用于过滤仅在 POWERPNT.EXE 进程下运行的应用程序。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-10T13:46:01.577

这应该可以解决问题：

```
Set Word = CreateObject("Word.Application")
Set Tasks = Word.Tasks
For Each Task in Tasks
   If Task.Visible Then Wscript.Echo Task.Name
Next
Word.Quit 
```

[http://msdn.microsoft.com/en-us/library/bb212832.aspx](http://msdn.microsoft.com/en-us/library/bb212832.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-11T20:31:31.273

stahler 的答案转换为 PowerShell：

$word = new-object -com 'word.application'

$word.tasks | ? {$_. 可见} | 选择名称

$word.quit()

# sql-server - SQL Server 中的递归好吗？

> ID：191208
> 
> 赞同：9
> 
> 时间：2008-10-10T13:16:19.657
> 
> 标签：sql-server, recursion

我在 SQL 服务器中有一个表，它具有 Item_ID、Item_ParentID 的正常树结构。假设我想迭代并获取特定 Item_ID 的所有 CHILDREN（在任何级别）。

递归似乎是解决这个问题的一个直观的候选者，我可以编写一个 SQL Server 函数来做到这一点。

如果我的表有很多记录，这会影响性能吗？如何避免递归并简单地查询表？请问有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T13:24:01.030

使用新的 MS SQL 2005，您可以使用`WITH`关键字

看看[这个问题](https://stackoverflow.com/questions/91360/how-to-calculate-the-sum-of-values-in-a-tree-using-sql)，特别是[这个答案](https://stackoverflow.com/questions/91360/how-to-calculate-the-sum-of-values-in-a-tree-using-sql#93202)。

使用 Oracle，您可以使用`CONNECT BY`关键字来生成分层查询（[语法](http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/queries003.htm)）。

AFAIK 与 MySQL 你将不得不使用递归。

或者，您始终可以为您的记录父->子关系构建一个缓存表

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T14:04:00.590

作为一般答案，只需使用迭代算法，就可以在 SQL Server 中做一些通常需要递归的非常复杂的东西。我设法在 Transact SQL 中做了一个 XHTML 解析器，效果出奇的好。我编写的代码美化器是在存储过程中完成的。它不是优雅的，它就像看水牛做芭蕾一样。但它有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T13:30:13.277

您使用的是 SQL 2005 吗？

如果是这样，您可以为此使用公用表表达式。这些方面的东西：

```
;
with CTE (Some, Columns, ItemId, ParentId) as 
(
    select Some, Columns, ItemId, ParentId
    from myTable 
    where ItemId = @itemID
    union all
    select a.Some, a.Columns, a.ItemId, a.ParentId
    from myTable as a
    inner join CTE as b on a.ParentId = b.ItemId
    where a.ItemId <> b.ItemId
)
select * from CTE 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T13:51:56.620

递归和性能将面临的问题是它必须递归多少次才能返回结果。每个递归调用都是另一个单独的调用，必须加入到总结果中。

在 SQL 2k5 中，您可以使用公共表表达式来处理此递归：

```
WITH Managers AS 
( 
--initialization 
SELECT EmployeeID, LastName, ReportsTo  
FROM Employees 
WHERE ReportsTo IS NULL 
UNION ALL 
--recursive execution 
SELECT e.employeeID,e.LastName, e.ReportsTo 
FROM Employees e INNER JOIN Managers m  
ON e.ReportsTo = m.employeeID 
) 
SELECT * FROM Managers 
```

或另一种解决方案是将层次结构展平到另一个表中

**Employee_Managers**
ManagerId（PK，FK 到 Employee 表）
EmployeeId（PK，FK 到 Employee 表）

所有父子关系都将存储在此表中，因此如果经理 1 管理经理 2 管理员工 3，则该表如下所示：

```
ManagerId EmployeeId
1         2
1         3
2         1 
```

这允许轻松查询层次结构：

```
select * from employee_managers em 
inner join employee e on e.employeeid = em.employeeid and em.managerid = 42 
```

这将返回所有拥有经理 42 的员工。好处将是更好的表现，但坏处将是维持层次结构

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T14:37:16.107

Joe Celko 有一[本书](https://rads.stackoverflow.com/amzn/click/com/1558609202)（<- 链接到亚马逊）专门介绍 SQL 数据库中的树结构。虽然您的模型需要递归，并且肯定存在性能问题的可能性，但根据您的具体问题涉及的具体问题，有其他方法可以对树结构进行建模，这可以避免递归并提供更好的性能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T13:18:19.590

也许一些更多的细节是有序的。

如果您有描述的主从关系，那么简单的 JOIN 不会得到您所需要的吗？

如：

```
SELECT
  SOME_FIELDS
FROM
  MASTER_TABLE MT
 ,CHILD_TABLE CT
WHERE CT.PARENT_ID = MT.ITEM_ID 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T13:34:57.230

您不应该需要对*孩子*进行递归-您只需要查看正下方的级别（即`select * from T where ParentId = @parent`）-您只需要对所有*后代*进行递归。

在 SQL2005 中，您可以通过以下方式获取后代：

```
with AllDescendants (ItemId, ItemText) as (
    select t.ItemId, t.ItemText 
        from [TableName] t
    where t.ItemId = @ancestorId
    union
    select sub.ItemId, sub.ItemText 
        from [TableName] sub
            inner join [TableName] tree
            on tree.ItemId = sub.ParentItemId
) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T15:37:57.327

您根本不需要递归......请注意，我将列更改为 ItemID 和 ItemParentID 以便于输入......

```
声明 @intLevel INT
设置@intLevel = 1插入到 TempTable（ItemID，ItemParentID，级别）
选择 ItemID、ItemParentID、@intLevel
ItemParentID 为空

而@intLevel < @TargetLevel
开始
     设置@intLevel = @intLevel + 1
     插入到 TempTable（ItemID，ItemParentID，级别）
          选择 ItemID、ItemParentID、@intLevel
          WHERE ItemParentID IN（从 TempTable WHERE Level = @intLevel-1 中选择 ItemID）
     -- 如果没有插入行，则没有子代
     如果@@ROWCOUNT = 0
       休息
结尾

从 TempTable WHERE Level = @TargetLevel 中选择 ItemID

```

# batch-file - 如何对批处理文件副本中的所有“您要覆盖”提示说不？

> ID：191209
> 
> 赞同：60
> 
> 时间：2008-10-10T13:16:36.223
> 
> 标签：batch-file, copy

默认情况下，从命令提示符复制将提示您覆盖目标位置中已存在的文件。

您可以添加“/Y”来表示“全部同意”替换。

但是你怎么能对所有人说“不”呢？

换句话说，我想从一个目录中复制目标中**尚不**存在的所有内容。

我看到的最接近的是 XCOPY 参数，它只在特定的 mod-datetime 之后复制东西。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-10-10T13:33:00.840

除非存在您不想复制自上次复制以来已更改的源中的现有文件的情况，否则*为什么*不使用带有 /D 的 XCOPY 而不指定日期呢？

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2011-12-16T07:47:14.467

```
echo "No" | copy/-Y c:\source c:\Dest\ 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2010-01-08T19:24:00.547

您可以使用单行“n”创建一个文本文件，然后运行您的命令并在其后放置 < nc.txt。我这样做是为了复制超过 145,000 个实例，其中“不覆盖”是我想要的，并且以这种方式运行良好。

或者你可以用一些东西按住 n 键，但这比使用 < 管道输入要花更长的时间。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-10T13:23:09.720

这是一种解决方法。如果要从 A 复制 B 中尚不存在的所有内容：

将 A 复制到新目录 C。将 B 复制到 C，覆盖与 A 重叠的所有内容。将 C 复制到 B。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-10T13:54:05.647

我使用`XCOPY`以下参数来复制 .NET 程序集：

```
/D /Y /R /H 

/D:m-d-y - Copies files changed on or after the specified date. If no date is given, copies only those files whose source time is newer than the destination time.

/Y - Suppresses prompting to confirm you want to overwrite an existing destination file.

/R - Overwrites read-only files.

/H - Copies hidden and system files also. 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-04-07T15:39:17.047

我知道你们都认为 /D: date 会使用 date 的东西，但只是 /D 没有: 完全符合我们的要求，所以......

```
xcopy {Source} {Destination} /E /D 
```

将复制而不覆盖以拾取那些新文件或由于某种原因之前可能失败的文件。

试试吧，它有效。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-10T13:21:27.320

我希望[xxcopy](http://www.xxcopy.com/index.htm)有一个[选择](http://www.xxcopy.com/xxcopy01.htm)。

答对了：

[http://www.xxcopy.com/xxcopy27.htm#tag_231](http://www.xxcopy.com/xxcopy27.htm#tag_231)

```
2.3   By comparison with the file in destination

    The switches in this group select files based on the
    comparison between the files in the source and those in
    the destination.  They are often used for periodic backup
    and directory synchronization purposes. These switches
    were originally created as variations of directory backup.
    They are also convenient for selecting files for deletion.

2.3.1  by Presence/Absence

    The /BB and /U switches are the two switches which select
    files by the pure presence or absence as the criteria.
    Other switches in the this group (Group 2.3) are also
    affected by the file in the destination, but for a
    particular characteristics for comparison's sake.

    /BB  Selects files that are present in source but not in destination.
    /U   Selects files that are present in both source and destination. 
```

-亚当

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2012-05-03T09:44:20.573

这很好用

```
no | cp -rf c:\source c:\Dest\ 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-07-18T10:32:35.210

回声 N | 复制 /-y $(SolutionDir)SomeDir $(OutDir)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-08-27T13:58:40.683

试试这个：

```
robocopy "source" "destination" /e /b /copyall /xo /it 
```

将该行复制到记事本中并保存为 .bat 文件。运行该文件，它会将所有内容从源复制到目标。当您再次运行它时，它不会替换相同的文件。当您更改或文件更改时，它将替换目的地的文件。

测试一下。我用一些作品创建了一个 .txt 文件，运行脚本，更改 .txt 文件上的措辞并再次运行脚本，它仅替换源中的更改文件。

```
/e=Copies subdirectories. Note that this option includes empty directories
/b=Copies files in Backup mode
/copyall=Copies all file information
/xo=Excludes older files. (this is what prevents it from copy the same file over and over)
/it=Includes "tweaked" files. (this will allow the copy and replace of modified files) 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-05-01T12:36:58.603

谢谢你。我正在使用命令行实用程序 AzCopy (v 3.1.0.93) 将大约 100 万个文件从我的本地 PC 移动到我的 Azure blob 存储。我有一些重复，无法照看副本来回答每个提示，并且不想重新上传相同的文件。

AzCopy 实用程序提供 /Y 命令来禁止确认提示，但最终会告诉它覆盖目标文件。走这条路，我能够让它不重新上传文件。但是，它看起来确实有点 hack，因为它实际上并没有用“否”来回答提示，而是我收到错误“当用户需要在几个给定选项中做出选择时没有收到输入”。但不上传文件。

这是我使用的命令：echo n | AzCopy /Source:"{file path}" /Dest:"{blob 存储 URL}" /DestKey:{key}

希望这对下一个人有所帮助。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-10T13:23:00.593

根据要复制的文件的大小和数量，您可以先将目标目录复制到源目录上，“全部同意”，然后执行您正在执行的原始副本，同时设置“全部同意”。那应该给你同样的结果。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-03-29T08:28:46.860

我们通过“invoke-command”使用“robocopy”来复制我们环境中的大量虚拟机。我们发现“robocopy”有时会意外退出，整个过程会停止。所以我们决定使用“xcopy”。现在我们正在检查它的工作，并使用该功能（powershell）“创建”“并非所有人”选项：

函数 gen_long_no([string]$path) { $result = ""; Get-ChildItem $path -Recurse | ? { if ($_.PSIsContainer -eq $false) { $result += "n" } }; 返回$结果}

也许可以帮助某人。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-11-16T03:47:17.230

Adding the switches for subdirectories and verification work just fine. echo n | xcopy/-Y/s/e/v c:\source*.* c:\Dest\

# java - 如何优雅地停止java进程？

> ID：191215
> 
> 赞同：90
> 
> 时间：2008-10-10T13:17:36.127
> 
> 标签：java, linux, windows, shell, process

如何在 Linux 和 Windows 中优雅地停止 Java 进程？

什么时候`Runtime.getRuntime().addShutdownHook`被调用，什么时候不被调用？

终结者呢，他们在这里有帮助吗？

我可以从 shell 向 Java 进程发送某种信号吗？

我正在寻找最好的便携式解决方案。

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-10-10T15:47:22.923

关闭挂钩在 VM 未被强制终止的所有情况下执行。因此，如果您要发出“标准”kill（`SIGTERM`来自 kill 命令），那么它们将执行。同样，它们将在调用后执行`System.exit(int)`。

但是硬杀（`kill -9`或`kill -SIGKILL`）然后他们不会执行。同样（显然），如果您从计算机上拔下电源，将其放入沸腾的熔岩桶中，或用大锤将 CPU 打成碎片，它们将不会执行。不过，您可能已经知道了。

终结器确实也应该运行，但最好不要依赖它来进行关机清理，而是依靠你的关机钩子来干净地停止事情。而且，一如既往，要小心死锁（我见过太多的关闭挂钩挂起整个过程）！

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-10-16T14:36:01.690

好的，毕竟我已经选择了使用“Java 监控和管理”
[概述的](http://java.sun.com/j2se/1.5.0/docs/guide/management/overview.html)
所有可能性， 它允许您以相对简单的方式从另一个应用程序控制一个应用程序。您可以从脚本调用控制应用程序以在终止受控应用程序之前优雅地停止它。

这是简化的代码：

**受控应用程序：**
使用以下 VM 参数运行它：
-Dcom.sun.management.jmxremote
-Dcom.sun.management.jmxremote.port=9999
-Dcom.sun.management.jmxremote.authenticate=false
-Dcom.sun.management。 jmxremote.ssl=false

```
//ThreadMonitorMBean.java
public interface ThreadMonitorMBean
{
String getName();
void start();
void stop();
boolean isRunning();
}

// ThreadMonitor.java
public class ThreadMonitor implements ThreadMonitorMBean
{
private Thread m_thrd = null;

public ThreadMonitor(Thread thrd)
{
    m_thrd = thrd;
}

@Override
public String getName()
{
    return "JMX Controlled App";
}

@Override
public void start()
{
    // TODO: start application here
    System.out.println("remote start called");
}

@Override
public void stop()
{
    // TODO: stop application here
    System.out.println("remote stop called");

    m_thrd.interrupt();
}

public boolean isRunning()
{
    return Thread.currentThread().isAlive();
}

public static void main(String[] args)
{
    try
    {
        System.out.println("JMX started");

        ThreadMonitorMBean monitor = new ThreadMonitor(Thread.currentThread());

        MBeanServer server = ManagementFactory.getPlatformMBeanServer();

        ObjectName name = new ObjectName("com.example:type=ThreadMonitor");

        server.registerMBean(monitor, name);

        while(!Thread.interrupted())
        {
            // loop until interrupted
            System.out.println(".");
            try 
            {
                Thread.sleep(1000);
            } 
            catch(InterruptedException ex) 
            {
                Thread.currentThread().interrupt();
            }
        }
    }
    catch(Exception e)
    {
        e.printStackTrace();
    }
    finally
    {
        // TODO: some final clean up could be here also
        System.out.println("JMX stopped");
    }
}
} 
```

**控制应用程序：使用***stop*或*start*作为命令行参数
运行它

 **```
public class ThreadMonitorConsole
{

public static void main(String[] args)
{
    try
    {   
        // connecting to JMX
        System.out.println("Connect to JMX service.");
        JMXServiceURL url = new JMXServiceURL("service:jmx:rmi:///jndi/rmi://:9999/jmxrmi");
        JMXConnector jmxc = JMXConnectorFactory.connect(url, null);
        MBeanServerConnection mbsc = jmxc.getMBeanServerConnection();

        // Construct proxy for the the MBean object
        ObjectName mbeanName = new ObjectName("com.example:type=ThreadMonitor");
        ThreadMonitorMBean mbeanProxy = JMX.newMBeanProxy(mbsc, mbeanName, ThreadMonitorMBean.class, true);

        System.out.println("Connected to: "+mbeanProxy.getName()+", the app is "+(mbeanProxy.isRunning() ? "" : "not ")+"running");

        // parse command line arguments
        if(args[0].equalsIgnoreCase("start"))
        {
            System.out.println("Invoke \"start\" method");
            mbeanProxy.start();
        }
        else if(args[0].equalsIgnoreCase("stop"))
        {
            System.out.println("Invoke \"stop\" method");
            mbeanProxy.stop();
        }

        // clean up and exit
        jmxc.close();
        System.out.println("Done.");    
    }
    catch(Exception e)
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}
} 
```

就是这样。:-)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-17T15:19:03.667

另一种方式：您的应用程序可以打开一个服务器套接字并等待信息到达。例如一个带有“魔术”字的字符串:)，然后做出反应以关闭：System.exit()。您可以使用 telnet 等外部应用程序将此类信息发送到 socke。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-06-16T08:33:10.707

这是一个有点棘手但可移植的解决方案：

*   在您的应用程序中实现关闭挂钩
*   当您想要优雅地关闭 JVM 时，请安装使用[Attach API](http://docs.oracle.com/javase/7/docs/technotes/guides/attach/)调用*System.exit()的*[Java 代理](https://docs.oracle.com/javase/7/docs/api/java/lang/instrument/package-summary.html)。

 *我实现了 Java 代理。它在 Github 上可用：[https ://github.com/everit-org/javaagent-shutdown](https://github.com/everit-org/javaagent-shutdown)

有关该解决方案的详细说明，请参见此处：[https ://everitorg.wordpress.com/2016/06/15/shutting-down-a-jvm-process/](https://everitorg.wordpress.com/2016/06/15/shutting-down-a-jvm-process/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-10T13:23:57.393

类似的问题[在这里](https://stackoverflow.com/questions/61692/how-do-i-get-my-java-application-to-shutdown-nicely-in-windows#72078)

Java 中的终结器很糟糕。它们为垃圾收集增加了很多开销。尽可能避免使用它们。

shutdownHook 只会在 VM 关闭时被调用。我认为它可以做你想要的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T14:37:42.707

Linux 中的信号可以通过“kill”（可用信号的 man kill）来完成，您需要进程 ID 来执行此操作。(ps ax | grep java) 或类似的东西，或者在创建进程时存储进程 ID（这在大多数 linux 启动文件中使用，请参阅 /etc/init.d）

可移植信号可以通过在您的 java 应用程序中集成一个 SocketServer 来完成。这并不难，让您可以自由发送您想要的任何命令。

如果您的意思是 finally 子句而不是终结器；当 System.exit() 被调用时，它们不会被执行。终结器应该可以工作，但实际上不应该做任何更重要的事情，而是打印一个调试语句。他们很危险。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T17:11:23.910

谢谢你的回答。关机钩接缝就像我的情况一样。但我也碰到了一个叫做监控和管理 bean 的东西：http:
[//java.sun.com/j2se/1.5.0/docs/guide/management/overview.html](http://java.sun.com/j2se/1.5.0/docs/guide/management/overview.html)
这为远程监控和操作提供了一些很好的可能性的java进程。（在 Java 5 中引入）

# open-source - 开源：协同设计

> ID：191224
> 
> 赞同：6
> 
> 时间：2008-10-10T13:18:51.617
> 
> 标签：open-source, collaboration

*在深入研究开源世界之后，我发现实现比设计更重要。版本控制允许项目在多个方向上分支，项目可能会这样做；这表明参与者之间缺乏共识或方向。*

### 哪些软件或网站对协作设计有用？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-28T08:04:56.517

实际上还有数百个协作应用程序，并且每天都会出现更多，但是这些应该可以帮助您入门：

**源代码管理（在线）：**

*   [Assembla](http://www.assembla.com/) - 公共资源是免费的，私人存储库是付费的
*   [Source Forge](http://sourceforge.net/) - 仅开源
*   [Google 代码](http://code.google.com/hosting/)- 仅开源
*   [Git Hub](http://github.com/) - 公共源是免费的，私人存储库是付费的

**错误跟踪/项目管理**

*   [LightHouse](http://lighthouseapp.com/) - 无限开源，付费私人项目
*   [FogBugz](http://www.fogcreek.com/FogBUGZ/) - 完整版最多可供两个开发人员免费使用
*   [BaseCamp](http://www.basecamphq.com/) - 仅付费
*   [Trac](http://trac.edgewall.org/) - 未托管（尽管 Assembla 托管它），开源 - Python
*   [Bugzilla](http://www.bugzilla.org/) - 未托管，开源 - Python
*   [Mantis](http://www.mantisbt.org/) - 非托管，开源 - PHP

**思维导图**

*   [MindMeister](http://www.mindmeister.com/) - 小型计划免费，可选择升级

**文件**

*   [谷歌文档](http://docs.google.com/?pli=1)- 免费
*   [流行语](http://www.adobe.com/acom/buzzword/)- Adob​​e 提供 - 免费
*   [Scribd](http://www.scribd.com/) - 免费

**图形**

*   [Aviary](http://aviary.com) - 我不太确定他们的协作程度，但我认为你可以这样使用他们的工具
*   [Photoshop Express](https://www.photoshop.com/express/landing.html) - 另一个 Adob​​e 产品
*   [Picnik](http://www.picnik.com/) - 免费

**白板**

*   [Scriblink](http://www.scriblink.com/) - 免费提供付费选项
*   [skrbl](http://www.skrbl.com/) - 公共免费，私人付费
*   [Dabbleboard](http://www.dabbleboard.com/) - 免费和付费计划

**托管 Wiki**

*   [pbwiki](http://pbwiki.com/) - 付费计划
*   [Wikidot](http://www.wikidot.com/) - 付费计划免费

**各种各样的**

*   [Acrobat](http://www.adobe.com/acom/) - Adob​​e 在线套件的一部分
*   [Zoho](http://www.zoho.com/) - 适合很多类别

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-28T17:42:54.163

我在攻读博士学位的早期就一直在研究协作设计。（如果你想要一份我在 2003 年写的关于它的文献调查草稿，请联系我）。

无论如何，协作设计应用程序（如在 UML 建模器中）在时间方面分为三类：

*   同步 - 两个或更多人同时编辑
*   异步 - 签入签出模型，如果多人同时编辑会一团糟。
*   混合（可以实时共享某些东西）。

此外，就隐喻而言，它们分为三类： - 基于桌面 - 基本上类似于具有多用户支持的基本原理 - 基于白板 - 免费画布，不一定是结构化的，有时支持 UML 识别。通常管理多个模型会很混乱。- 混合动力车

因此，这为您提供了 3x3 的工具“设计空间”，每个工具中都有研究工具。

问题在于，在切换到协作工作时，存在许多难以解决的可用性问题。例如，访问控制、同步、感知、共享视口等。在这些方面有一些学术进展，但它们还不一定是工具。

如果这是您感兴趣的主题，请发表评论，我会发布一些我熟悉的工具。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T14:06:01.257

我建议使用 Wiki 来记录/探索设计。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-01T01:27:55.440

一个邮寄名单。开源项目争论不休。我怀疑缺乏协作工具是缺乏设计重点的原因。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-28T07:55:03.000

没有特别的顺序：

*   一个好的电子邮件客户端（我使用 gmail）
*   好的维基软件（我使用[媒体维基](http://www.mediawiki.org/wiki/MediaWiki)）
*   [Github](http://github.com/)或进化的源存储库，允许在签入时轻松进行分支和评论
*   聊天室，普通的旧版 irc 或内置信使
*   新闻组或邮件列表（我使用免费的谷歌）
*   Skype

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-28T09:00:56.133

我对协作设计有些怀疑。来自[Scobleizer：为什么 Facebook 从来没有听过，为什么现在肯定不会开始](http://scobleizer.com/2009/03/21/why-facebook-has-never-listened-and-why-it-definitely-wont-start-now/)：

> 我的前任老板吉姆·福塞特（Jim Fawcette）曾经说过，如果你问一群保时捷车主他们想要什么，他们会告诉你“更顺畅的驾驶、更多的行李箱空间、更多的腿部空间等”。然后他会说“好吧，他们只是设计了一辆沃尔沃。”</p>

也来自评论：

> 苹果从不听客户的。事实上，它以不听而自豪。如果您听取客户的意见，您将永远不会创新，也永远不会领先于潮流。您将始终在当天、一周或一个月内对客户最关心的问题进行微调和修复。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-11-22T18:43:10.570

我同意维基的答案。我建议看看[MindTouch](http://www.mindtouch.com)。我们公司将它们用于我们的 Intranet 以及其他内部和外部项目协作/管理。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-28T08:00:12.643

wiki（例如[ScrewTurn](http://www.screwturn.eu/)或[MediaWiki](http://www.mediawiki.org/wiki/MediaWiki)）是记录项目的好工具。

[BaseCamp](http://www.basecamphq.com/) by 37 Signals

[Microsoft Office 实时会议](http://office.microsoft.com/en-au/livemeeting/default.aspx)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-28T12:57:48.420

对我们来说，我们只使用[Adob​​e Version](http://www.adobe.com/products/creativesuite/versioncue/) Cue、[Google Docs](http://docs.google.com)、[Google Calendar](https://www.google.com/calendar)和[Gmail](https://mail.google.com)。

在设计方面，Version Cue 在文件管理方面做得非常好。

至于谷歌，它对组织我所有的活动非常有帮助。我发现大多数协作工具，比如 Basecamp，有点过于严格或不完全正确。谷歌让我按照我想要的方式整理我的东西。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-28T18:05:21.147

对于协作设计......毫无疑问，它是

[http://conceptshare.com](http://conceptshare.com)

# delphi - 来自 Delphi ActiveX 控件的错误：异常 EOSError - 调用 OS 函数失败

> ID：191225
> 
> 赞同：1
> 
> 时间：2008-10-10T13:19:11.350
> 
> 标签：delphi, activex

我在使用 Delphi 创建的 C# 程序中使用了一个 activex 组件。它在很多时候都可以正常工作，但偶尔（有时经常！）组件会因以下异常而崩溃：

> 异常 EOSError（调用 OS 函数失败）(0)

在程序重新启动之前，这会使控件处于某种无法使用的状态。似乎没有任何押韵或理由能够重现该错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T22:55:49.347

如果您可以在受控环境中重现问题，则使用[MadExcept 之](http://www.madshi.net/madExceptDescription.htm)类的工具从错误情况中获取调用堆栈信息可能有助于追踪问题的确切原因。

在过去（< Windows NT），当您的机器资源不足时，有时会发生上述错误。您的 ActiveX 控件是否有可能泄漏窗口句柄？像 MemProof 这样的工具可能会帮助你追踪这些。

# windows - 如何中止 WinDbg 中的长时间操作？

> ID：191233
> 
> 赞同：73
> 
> 时间：2008-10-10T13:20:31.613
> 
> 标签：windows, debugging, windbg

通常 WinDbg 会进入 ***Busy***执行操作的状态。

这通常是由于我在尝试*dt some_variable_itll_never_find*时犯的一些错误，或者在没有符号的地方设置断点，或者我在这个工具上犯的 1000 个其他错误。

**有没有办法取消当前操作？**

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2008-10-10T13:51:40.020

我现在没有这个工具，但据我记得应该是 Ctrl+Break。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-04-01T17:23:30.643

Sometimes Ctrl+Break doesnt work. At that point you may use Debug menu -> Break.

Thanks

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-03-06T00:25:59.920

```
Ctrl+Break 
```

将强制调试全部中断，但例如，如果您输入了一些需要很长时间的 windbg 命令并且您想杀死它，那么您应该输入

```
Ctrl+c 
```

这将杀死当前正在运行的命令。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-12T12:51:26.367

您可能在符号路径中有“ [http://msdl.microsoft.com/download/symbols ”。](http://msdl.microsoft.com/download/symbols)Windbg 将尝试在 Microsoft 站点上找到您所有的 PDB :-(。
按 Ctrl+Break 不够快。我通常做的是拔掉网线，直到 Windbg 唤醒。如果 Windbg 真的在下载一个，请放心如果它的操作系统 DLL，则 DLL 会被更改。您将需要 .reload /o 来修复该 DLL。我只有在知道所有操作系统 DLL 都已下载时才拔下插头。

为了避免这种延迟，请取消选中“调试”菜单下的“解决不合格符号”。

# sql-server - 浏览 SQL Server

> ID：191242
> 
> 赞同：4
> 
> 时间：2008-10-10T13:21:47.430
> 
> 标签：sql-server

是否有任何工具仅用于浏览 SQL Server？我问是因为有时 SSMS 有点重，当我只想查看数据库并找到一条记录时，SQLCMD 在浏览很多不同的记录或很多大记录时似乎不是一个好的选择。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-10T13:23:49.827

是的，[QueryExpress](http://www.albahari.com/queryexpress.aspx)是一个很棒的轻量级工具（也可以通过 USB 记忆棒使用），用于浏览和查询 SQL Server 数据库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T15:14:19.777

我正在使用，我真的很喜欢[LINQPad](http://www.linqpad.net/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-28T15:27:26.480

您可以尝试关注异构 sql 客户端

## 海蒂

它重量轻，可以同时管理**MySql**和**Sql server**

点击[这里](http://www.heidisql.com/)了解更多。

## SqlDbx

SqlDbx 是一个快速且易于使用的数据库 SQL 开发 IDE，适用于在**异构**数据库环境中工作的数据库管理员、应用程序和数据库开发人员。

它可以管理**MySql、SqlServer、Oracle、Sybase、Microsoft azure 和 IBM DB2**。

点击[这里](http://www.sqldbx.com/)了解更多。

# silverlight - 在silverlight 2中获取当前屏幕的XAML

> ID：191247
> 
> 赞同：1
> 
> 时间：2008-10-10T13:23:04.853
> 
> 标签：silverlight, xaml, image

我正在尝试将动态创建的 silverlight 2 页面/图像发送到 ASP.net Web 服务，以将其呈现为位图图像。

我可以看到许多示例如何在 silverlight 版本 1 中使用 javascript（[请参阅此处](http://www.thedatafarm.com/blog/2008/01/31/ConvertingSilverlightInkPresenterImagesToAPNGFile.aspx)）获取 XAML，但我有一些不同之处。

a) 我正在使用 silverlight 2 RC1
b) 我已经在 c# 中向页面动态添加控件
c) 我更喜欢使用 c# 来获取新的 XAML 以将所有 coed 保存在一个地方。

有谁知道如何从 C# 中的控件或页面中提取 XAML？

谢谢

* * *

更新：现在可以在 Silverlight 3 下使用可写位图将 XAML 保存为 JPEG，请参阅我的博客文章：http: [//blog.blueboxes.co.uk/2009/07/21/rendering-xaml-to- a-jpeg-using-silverlight-3/](http://blog.blueboxes.co.uk/2009/07/21/rendering-xaml-to-a-jpeg-using-silverlight-3/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-10T16:50:56.413

不幸的是，不幸的是，元素树上没有 .ToXaml() 的方法。您可以使用 VisualTreeHelper 构建这样的方法并通过我想的特定元素进行递归。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T07:19:24.647

SilverlightContrib 有一个 XamlWriter 类，可以从实时控件中提取 XAML。

免费。

链接是：[http://silverlightcontrib.org](http://silverlightcontrib.org)

代码将类似于：

```
 // using SilverlightContrib.Xaml;

            var cb = new GroupBox();
            StringBuilder sb = new StringBuilder();
            XamlWriterSettings settings = new XamlWriterSettings();

            using (XamlWriter writer = XamlWriter.CreateWriter(sb, false, settings))
            {
                writer.WriteElement(cb);
            }

            string result = sb.ToString(); 

```

# algorithm - 潜在狄利克雷分配、陷阱、技巧和程序

> ID：191248
> 
> 赞同：21
> 
> 时间：2008-10-10T13:23:07.240
> 
> 标签：algorithm, statistics, nlp

我正在尝试使用[潜在狄利克雷分配](http://en.wikipedia.org/wiki/Latent_Dirichlet_allocation)来进行主题消歧和分配，我正在寻求建议。

1.  哪个程序是“最好的”，其中最好的是最容易使用、最好的先验估计、快速的组合
2.  我如何结合我对话题性的直觉。假设我认为我知道语料库中的某些项目确实属于同一类别，就像同一作者的所有文章一样。我可以将其添加到分析中吗？
3.  在开始之前我应该​​知道任何意想不到的陷阱或提示吗？

我更喜欢任何程序都有 R 或 Python 前端，但我希望（并接受）我将处理 C。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-04-15T22:01:58.793

1.  [http://mallet.cs.umass.edu/](http://mallet.cs.umass.edu/)恕我直言，是目前最棒的即插即用 LDA 包。它使用 Gibbs 采样来估计主题，并且具有非常简单的命令行界面和许多额外的铃声-n-whistle（一些更复杂的模型，超参数优化等）

2.  最好让算法完成它的工作。可能有 LDA（和 pLSI 等）的变体，可以让你做一些半监督的事情。我目前不知道。

3.  我发现删除停用词和其他非常高频的词似乎大大提高了我的主题的质量（通过查看每个主题的热门词来评估，而不是任何严格的指标）。我猜词干/词形还原会有所帮助出色地。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-11-10T21:07:54.973

1.  您提到了对 R 的偏好，您可以使用两个包[topicmodels](http://cran.r-project.org/web/packages/topicmodels/index.html)（慢）或[lda](http://cran.r-project.org/web/packages/lda/)（快）。Python 有[deltaLDA](http://pages.cs.wisc.edu/~andrzeje/research/delta_lda.html)、[pyLDA](https://github.com/nrolland/pyLDA)、[Gensim](http://radimrehurek.com/gensim/)等。

2.  具有指定主题或单词的主题建模是开箱即用的，[David Andrzejewski](http://pages.cs.wisc.edu/~andrzeje/)有一些 Python 代码似乎可以做到这一点。[这里](http://www.cs.princeton.edu/~chongw/slda/)有监督 LDA 的 C++ 实现。还有大量关于相关方法的论文（[DiscLDA](http://www.cs.berkeley.edu/~jordan/papers/lacoste-sha-jordan-nips08.pdf)，[Labeled LDA](http://www.stanford.edu/~dramage/papers/llda-emnlp09.pdf)但不是易于使用的形式，无论如何对我来说......

3.  正如@adi92 所说，删除停用词、空格、数字、标点符号和词干都会大大改善情况。一个可能的陷阱是主题数量错误（或不适当）。目前，对于给定大小的语料库有多少主题是最佳的等，没有直接的诊断方法。在 MALLET 中有一些[主题质量度量](http://article.gmane.org/gmane.comp.ai.mallet.devel/1483/)（最快），非常方便。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T21:10:28.077

除了[通常的](http://www.google.com/search?q=latent+dirichlet+allocation) [来源](http://en.wikipedia.org/wiki/Latent_Dirichlet_allocation)之外，似乎最活跃的讨论领域是在[主题模型列表](https://lists.cs.princeton.edu/pipermail/topic-models/)服务器上。根据我最初的调查，最容易理解的包是[LDA Matlab 包](http://chasen.org/~daiti-m/dist/lda/)。

这根本不是轻量级的东西，所以很难在上面找到好的资源我并不感到惊讶。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T21:17:22.273

对于这种分析，我使用了 LingPipe：[http](http://alias-i.com/lingpipe/index.html) ://alias-i.com/lingpipe/index.html 。它是一个开源的 Java 库，我直接使用或移植了其中的一部分。要合并您自己的数据，您可以结合使用分类器，例如朴素贝叶斯。我在统计 nlp 方面的经验是有限的，但它通常遵循设置分类器、训练、查看结果、调整的循环。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-21T08:02:19.503

i second that. Mallet's lda uses a sparselda data structure and distributed learning, so its v fast. switching on hyperparameter optimization will give a better result, imo.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-23T17:46:44.097

```
def plot_top_words(model, feature_names, n_top_words, title):
fig, axes = plt.subplots(2, 5, figsize=(30, 15), sharex=True)
axes = axes.flatten()
for topic_idx, topic in enumerate(model.components_):
    top_features_ind = topic.argsort()[:-n_top_words - 1:-1]
    top_features = [feature_names[i] for i in top_features_ind]
    weights = topic[top_features_ind]

    ax = axes[topic_idx]
    ax.barh(top_features, weights, height=0.7)
    ax.set_title(f'Topic {topic_idx +1}',
                 fontdict={'fontsize': 30})
    ax.invert_yaxis()
    ax.tick_params(axis='both', which='major', labelsize=20)
    for i in 'top right left'.split():
        ax.spines[i].set_visible(False)
    fig.suptitle(title, fontsize=40)

plt.subplots_adjust(top=0.90, bottom=0.05, wspace=0.90, hspace=0.3)
plt.show() 
```

# c# - 如何使用C#找到第三方应用程序的安装目录，例如Google Earth？

> ID：191250
> 
> 赞同：2
> 
> 时间：2008-10-10T13:23:29.860
> 
> 标签：c#, google-earth

我有以下代码片段，它使用硬编码路径启动[Google 地球进程：](http://en.wikipedia.org/wiki/Google_Earth)

```
var process =
    new Process
        {
            StartInfo =
                {
                    //TODO: Get location of google earth executable from registry
                    FileName = @"C:\Program Files\Google\Google Earth\googleearth.exe",
                    Arguments = "\"" + kmlPath + "\""
                }
        };
process.Start(); 
```

我想以编程方式从某处（很可能是注册表）获取*googleearth.exe的安装位置。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T13:30:58.377

从给出的示例中，您可以判断出我实际上是在尝试将 KML 文件传递​​给 Google 地球。因此，解决此问题的最简单方法是依靠 KML 与 Google 地球的文件关联，并使用以下内容替换整个示例：

```
Process.Start(kmlPath); 
```

这是通过查看[此](https://stackoverflow.com/questions/181719/how-to-start-a-process-from-c-winforms)问题的答案而发现的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-11T15:57:00.407

显然，如果您要打开与该程序关联的特定文件，则最好通过该文件启动它（例如，用户可能有一个与他们喜欢使用的文件类型关联的程序）。

这是我过去用来启动与特定文件类型关联的应用程序的一种方法，但实际上并未打开文件。可能有更好的方法来做到这一点。

```
static Regex pathArgumentsRegex = new Regex(@"(%\d+)|(""%\d+"")", RegexOptions.ExplicitCapture);
static string GetPathAssociatedWithFileExtension(string extension)
{
    RegistryKey extensionKey = Registry.ClassesRoot.OpenSubKey(extension);
    if (extensionKey != null)
    {
        object applicationName = extensionKey.GetValue(string.Empty);
        if (applicationName != null)
        {
            RegistryKey commandKey = Registry.ClassesRoot.OpenSubKey(applicationName.ToString() + @"\shell\open\command");
            if (commandKey != null)
            {
                object command = commandKey.GetValue(string.Empty);
                if (command != null)
                {
                    return pathArgumentsRegex.Replace(command.ToString(), "");
                }
            }
        }
    }
    return null;
} 
```

有时虽然有些情况下您想在不打开文件的情况下启动特定程序。通常（希望）该程序有一个带有安装位置的注册表项。以下是如何以这种方式启动 Google 地球的示例。

```
private static string GetGoogleEarthExePath()
{
    RegistryKey googleEarthRK = Registry.CurrentUser.OpenSubKey(@"Software\Google\Google Earth Plus\");
    if (googleEarthRK != null)
    {
        object rootDir = googleEarthRK.GetValue("InstallLocation");
        if (rootDir != null)
        {
            return Path.Combine(rootDir.ToString(), "googleearth.exe");
        }
    }

    return null;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-20T22:33:48.780

这也可以：（C# 代码）

```
 Type type = Type.GetTypeFromProgID("WindowsInstaller.Installer");
        Installer msi = (Installer)Activator.CreateInstance(type);
        foreach (string productcode in msi.Products)
        {
            string productname = msi.get_ProductInfo(productcode, "InstalledProductName");
            if (productname.Contains("Google Earth"))
            {
                string installdir = msi.get_ProductInfo(productcode, "InstallLocation");
                Console.WriteLine("{0}: {1} @({2})", productcode, productname, installdir);
            }
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T02:31:21.143

这是我刚刚编写的 C++ 版本。直接取自 ICR 的 C# 版本。

```
void PrintString(CString string)
{
    std::wcout << static_cast<LPCTSTR>(string) << endl;
}

CString GetClassesRootKeyValue(const wchar_t * keyName)
{
    HKEY hkey;
    TCHAR keyNameCopy[256] = {0};
    _tcscpy_s(keyNameCopy, 256, keyName);
    BOOL bResult = SUCCEEDED(::RegOpenKey(HKEY_CLASSES_ROOT, keyNameCopy, &hkey));
    CString hkeyValue = CString("");
    if (bResult) {
        TCHAR temporaryValueBuffer[256];
        DWORD bufferSize = sizeof (temporaryValueBuffer);
        DWORD type;
        bResult = SUCCEEDED(RegQueryValueEx(hkey, _T(""), NULL, &type, (BYTE*)temporaryValueBuffer, &bufferSize)) && (bufferSize > 1);
        if (bResult) {
            hkeyValue = CString(temporaryValueBuffer);
        }
        RegCloseKey(hkey);
        return hkeyValue;
    }
    return hkeyValue;
}

int _tmain(int argc, TCHAR* argv[], TCHAR* envp[])
{
    int nRetCode = 0;

    // initialize MFC and print and error on failure
    if (!AfxWinInit(::GetModuleHandle(NULL), NULL, ::GetCommandLine(), 0))
    {
        // TODO: change error code to suit your needs
        _tprintf(_T("Fatal Error: MFC initialization failed\n"));
        nRetCode = 1;
    }
    else
    {

        CString dwgAppName = GetClassesRootKeyValue(_T(".dwg"));
        PrintString(dwgAppName);

        dwgAppName.Append(_T("\\shell\\open\\command"));
        PrintString(dwgAppName);

        CString trueViewOpenCommand = GetClassesRootKeyValue(static_cast<LPCTSTR>(dwgAppName));
        PrintString(trueViewOpenCommand);

        //  Shell open command usually ends with a "%1" for commandline params.  We don't want that,
        //  so strip it off.
        int firstParameterIndex = trueViewOpenCommand.Find(_T("%"));
        PrintString(trueViewOpenCommand.Left(firstParameterIndex).TrimRight('"').TrimRight(' '));

        cout << "\n\nPress <enter> to exit...";
        getchar();
    }
} 
```

# wpf - 如何在没有 Framework 3.5 的情况下将 WPF 应用程序安装到 PC

> ID：191251
> 
> 赞同：2
> 
> 时间：2008-10-10T13:23:34.867
> 
> 标签：wpf, frameworks, installation

我有一个关于如何在没有 Framework 3.5 的情况下将 WPF 应用程序部署到 PC 中的问题。如果一台PC只安装了Windows XP和sp3，是否可以设计一个安装包，可以直接在这台PC上安装WPF应用程序？

情况是这样的：

我设计了一个简单的 WPF 应用程序。我想得到它的安装包。海关拿到包后，可以直接安装应用程序，即使他们的PC没有安装Framework3.5。

是否可以？如果可能，我该怎么做？

//------------------------------------------------ ------------

我发现马特给了一个 http://forums.microsoft.com/EmbeddedWindows/ShowPost.aspx?PostID=3967493&SiteID=47>solution 它是唯一的解决方案吗？

您可以从 GAC 中删除您不使用的 .NET 程序集，只要您测试您的应用程序以确保您不会削减太多。大多数 .NET 程序集是 Win32 API 之上的包装器，因此可以在不影响操作系统的情况下删除它们。

*   您可以通过查看开发计算机上 Visual Studio 解决方案资源管理器中的引用节点来获取正在使用的程序集的列表。所有依赖项都在那里（如果程序集 A 依赖于程序集 B，则 A 和 B 都在列表中）但是有一些程序集属于运行时本身，例如 Accessibility.dll，请参见下面的列表。
*   确保使用 gacutil.exe（可以从 Visual Studio 命令提示符调用）来删除程序集。启动嵌入式映像并安装 .NET 后，您必须运行 gacutil。只需从 Visual Studio 复制 SDK\v2.0\bin 文件夹
*   gacutil.exe /l 可用于列出所有已安装的程序集。我曾经尝试在没有安装 .NET 的情况下在 WinPE 上运行 WPF 应用程序。我只是从 .NET 手动安装 CLR + 大约 30 个 dll。这是所需的所有文件的列表 10/19/2006 05:13 PM 10,752 Accessibility.dll 09/18/2006 01:32 PM 66,728 big5.nlp 09/18/2006 01:32 PM 82,172 bopomofo.nlp 11/01 /2006 10:34 PM 17,920 Culture.dll 11/01/2006 10:34 PM 9,728 fusion.dll 09/18/2006 01:32 PM 116,756 ksc.nlp 11/01/2006 10:34 PM 326,656 mscorjit.dll 10 /19/2006 05:14 PM 4,366,336 mscorlib.dll 11/01/2006 10:34 PM 330,752 mscorrc.dll 11/01/2006 10:34 PM 5,632,512 mscorwks.dll 09/18/2006 01:32 PM 59,342 normidna。 nlp 09/18/2006 01:32 PM 45,794 normnfc.nlp 09/18/2006 01:

希望有帮助

马特

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-12T22:24:54.663

Visual Studio 2008 SP1 添加了对 .NET Framework 的“客户端配置文件”子集的支持。如果您的目标 Windows XP SP3 计算机尚未安装任何版本的 .NET Framework，这将安装一个精简版的 Framework，其中包含 WPF 应用程序所需的程序集。Microsoft 提供了一个引导程序安装程序，它将在客户端计算机上安装/更新 .NET Framework，然后链接到您的安装程序以安装您的应用程序。以下是一些入门链接：

*   [.NET 客户端配置文件](http://msdn.microsoft.com/en-us/library/cc656912.aspx)概述
*   [演练：使用 Windows Installer 部署 .NET Framework 客户端配置文件应用程序](http://msdn.microsoft.com/en-us/library/cc656819.aspx)
*   [演练：使用 ClickOnce 部署 .NET Framework 客户端配置文件应用程序](http://msdn.microsoft.com/en-us/library/cc656916.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T21:12:12.567

当您使用 ClickOnce 时，在项目属性的部署选项中，将所需的程序集设置为包含，然后如果您确实需要一些程序集，请使用 gacutil.exe 或拖放到您的客户端本地 GAC

# c++ - 从 Visual Studio 6 升级有哪些令人信服的论据？

> ID：191253
> 
> 赞同：12
> 
> 时间：2008-10-10T13:23:48.407
> 
> 标签：c++, visual-studio, visual-c++, stl, visual-c++-6

我有一个客户仍在使用 Visual Studio 6 来构建生产系统。他们编写使用 STL 并在多处理器机器上运行的多线程系统。

有时，当他们更改其中一台服务器机器的规格或增加其负载时，他们会变得“奇怪”，难以重现错误......

我知道 Visual Studio 6 开发存在几个问题，我想说服他们迁移到 Visual Stuio 2005 或 2008（他们拥有 Visual Studio 2005 并将其用于某些项目）。

此问题的目的是汇总已知问题或升级原因的列表，以及讨论或报告这些问题的链接。拥有这些问题如何折磨你的真实“恐怖故事”也会很有用。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-10T13:28:16.450

在 64 位系统上不受支持，与 Vista 存在兼容性问题，并且它已于 2008 年 4 月 8 日被 Microsoft 移出扩展支持

[http://msdn.microsoft.com/en-us/vbrun/ms788708.aspx](http://msdn.microsoft.com/en-us/vbrun/ms788708.aspx)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-10T13:32:32.837

未修补的 VC6 STL 不是线程安全的。看这里[http://www.amanjit-gill.de/articles/vc6_stl.html](http://www.amanjit-gill.de/articles/vc6_stl.html)，补丁不包含在服务包中，您必须直接从 Dinkumware 获取它们（从这里[http://www.dinkumware.com/vc_fixes.html](http://www.dinkumware.com/vc_fixes.html)），然后将它们应用于每个安装...

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-10T13:35:28.057

我们在工作场所看到的最大问题是它无法处理即使是稍微复杂的模板类或函数。仅这一事实就迫使公司中一些最忠实的 VS6 粉丝升级并开始使用 VS2005。除了模板问题之外，intellisense 好很多，调试更容易也更准确，很多人发现 IDE 更容易导航。到目前为止，我们看到的唯一缺点是 2005 年的构建时间比 6 年的要长一些（但这可能是编译器更健壮的副作用）

您还可以查看这些站点以获取 VS6 中已知问题的示例：

*   [http://louisville.edu/~ecrouc01/CECS302/VisualCPP.htm](http://web.archive.org/web/20080922112758/http://louisville.edu/~ecrouc01/CECS302/VisualCPP.htm)
*   [http://www.acceleratedcpp.com/details/msbugs.html](http://www.acceleratedcpp.com/details/msbugs.html)

我敢肯定，如果您仔细研究一下，您会发现更多。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-10T16:16:31.867

VS6 不根据当前的 C/C++ 标准编译代码。例如，

*   它有不正确（过时的）循环范围规则。现在，至少有一个 MSFT SDK 已经更新了代码，该代码需要正确的语义，因此 SDK 甚至不再使用 VS6 进行编译。
*   除了最简单的模板结构之外，它无法编译所有的模板结构。
*   它将编译一些在最近的标准更新中被宣布为非法的模板结构（因为这些结构实际上并没有像普通用户所期望的那样）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-10T13:29:39.067

operator new 不符合 C++ 规范，并且不会在分配失败时抛出异常，解决这个问题并非易事。

请参阅：http: [//msdn.microsoft.com/en-us/magazine/cc164087.aspx](http://msdn.microsoft.com/en-us/magazine/cc164087.aspx)[](http://msdn.microsoft.com/en-us/magazine/cc164087.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T13:31:08.860

我升级的最大原因之一是符合标准的 C++ 编译器（尽管仍然不是 100%），所以我可以在我的项目中利用更多的 C++ 功能，而不必担心可能导致难以找到错误的奇怪的黑客和变通方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-10T13:32:20.700

与 Vista 不兼容。哎呀，VS 2005 与Vista 存在一长串问题。

话虽如此，VS 中的大多数改进似乎都适用于 C++ 本机代码以外的所有内容。我看到的是更多的标准合规性，这很重要，但几乎没有戏剧性。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-10T13:34:37.247

Visual Studio 6 与最新的 Windows SDK 不兼容，因此它不能（至少很容易地）利用最新的操作系统功能。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-09-17T21:35:23.367

虽然我不再有具体的细节，但我只是在工作中升级时，新的编译器发现了很多 VC 6 悄悄溜走的错误。仅通过升级提高了产品的稳健性。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-10T13:34:18.293

[如果他们使用 STL，他们可能会对最近发布的功能包](http://www.microsoft.com/downloads/details.aspx?FamilyId=D466226B-8DAB-445F-A7B4-448B326C48E7&displaylang=en)感兴趣，其中包括[TR1](http://en.wikipedia.org/wiki/Technical_Report_1)的实现。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-10T13:34:31.600

我已经升级了我的东西，但它相对简单。升级的一个缺点是[VS 2005 DLL Hell](http://www.itwriting.com/blog/?postid=261)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-10T13:35:29.587

STL 的 VS 2008 版本使用 编译`/clr`，因此如果他们有兴趣过渡到托管世界，他们不必丢失所有旧代码。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-10T13:50:08.947

默认情况下，较新的版本具有更好的编译器和更好的库。但是将现有项目移植到较新的工作室并不总是那么容易，您可以手动升级编译器和库。

一年前我还在使用 VS 6.0 和 Intel 编译器。那时我们只有一堆旧代码，它们威胁迭代器作为指针，反之亦然，这一切都非常混乱和可怕，所以这让我们无法升级。

但毕竟我不得不升级，因为我目前使用的框架根本无法在 VS 6.0 上运行。认为这是最终的原因:-)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-10T14:09:22.700

第三方库也只支持有限数量的编译器。因此，您的客户可能无法接受错误修复或功能升级。

例如，即使是作为 Boost 广泛使用的库也仅支持 VS 7.1 及更高版本（[来源](http://www.siao2.com/2008/09/26/8965526.aspx)）

您可能还会遇到一些数据执行保护 (DEP) 问题，因为 VC6 附带了旧的 ATL 版本。像往常一样，请参阅[Raymond Chen](http://blogs.msdn.com/oldnewthing/archive/2007/11/16/6281925.aspx)了解详情。

# msbuild - 使用 MSBuild 过滤掉不需要的扩展名和文件夹

> ID：191259
> 
> 赞同：0
> 
> 时间：2008-10-10T13:25:22.897
> 
> 标签：msbuild

使用 MSBuild，我如何过滤掉我的项目（和潜在的文件夹）中不需要的扩展？

.cs、.resx 文件等扩展名。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T13:34:05.737

```
<ItemGroup>
<MyGroup Include="Directory\**" Exclude="**\*.cs;**\*.resx" />
</ItemGroup> 
```

[http://blogs.msdn.com/msbuild/archive/2006/03/08/546583.aspx](http://blogs.msdn.com/msbuild/archive/2006/03/08/546583.aspx)

# c# - ASP.Net：使用 Javascript 和 AJAX 处理多语言网站的方法

> ID：191260
> 
> 赞同：1
> 
> 时间：2008-10-10T13:25:29.480
> 
> 标签：c#, asp.net, javascript, ajax, internationalization

我们最近完成了英文和法文 ASP.Net 网站的第一阶段。我们使用资源文件来存储特定于语言的字符串，但由于该站点大量使用 ASP.Net AJAX 和 javascript，我们设计了一个解决方案，通过 ASP.Net 管道传递正确的文件，我们可以在其中捕获“令牌”并替换它们从资源文件中提取适当的文本。

这是我参与的第二个遇到此类挑战的项目，第一个项目将文本字符串存储在数据库中，而不是 ASP.Net AJAX，它使用 Prototype 库附带的 AJAX 工具并将将所有 Javascript 转换为 aspx 文件，以便可以在退出时替换标记。

我想知道的是，有没有其他人遇到过类似的情况？你采取了什么方法？吸取了哪些教训？您是如何处理国际化日期格式等问题的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T15:04:31.043

在我的主要项目（一个使用 PHP 和 gettext 进行翻译的 RAD 框架）中，我们已经对 javascript 文件进行了很多准备操作，例如合并和缩小它们。在此准备工作中，我们解析 gettext-markers 并将它们替换为特定于语言的文本。

结果保存为 javascript 文件并正常包含在 html 中。

```
<script scr="var/scripts/en_GB-76909c49e9222ec2bb2f45e0a3c8baef80deb665.js"></script> 
```

文件名包含区域设置和用于缓存的哈希值。

日期和货币值总是在输出时从系统格式转换为区域设置格式，反之亦然。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-20T23:33:54.180

为了在我们的应用程序中处理 il8n，我们动态创建一个 JavaScript 文件（基于我们感兴趣的语言环境），其中包含键和翻译，例如

```
LOCALISATIONS = {
    'util.date.day.long': ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
    'util.date.day.short': ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
    ...
}; 
```

和其他 JavaScript 代码将使用此对象来获取翻译文本。

# tfs - 手动触发 TFS 团队构建

> ID：191291
> 
> 赞同：5
> 
> 时间：2008-10-10T13:33:52.133
> 
> 标签：tfs, build-automation, tfsbuild, build

您将如何从团队构建中手动触发其他团队构建？例如，当我们在 CC.Net 中时，如果某些构建成功，则会触发其他构建。第二个构建可以是使用此组件的项目，也可以是用于同一组件的其他长时间运行的测试库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T15:33:09.973

一种方法是您可以为 TFSBuild.proj 文件添加一个 AfterEndToEndIteration 目标，该文件将运行 TfsBuild.exe 命令行以启动其他构建。我在想这样的事情（虽然我没有测试过）

```
 <Target Name="AfterEndToEndIteration">

    <GetBuildProperties TeamFoundationServerUrl="$(TeamFoundationServerUrl)"
                        BuildUri="$(BuildUri)"
                        Condition=" '$(IsDesktopBuild)' != 'true' ">
      <Output TaskParameter="Status" PropertyName="Status" />
    </GetBuildProperties>

    <Exec Condition=" '$(Status)'=='Succeeded' "
          Command="TfsBuild.exe start /server:$(TeamFoundationServerUrl) /buildDefinition:&quot;Your Build Definition To Run&quot;" />

  </Target> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-14T17:53:55.770

我在很多场合都做了马丁建议的同样的事情（他的博客非常有用，顺便说一句）。然而，我最终需要触发这样的级联构建（基于一些其他复杂的规则），以至于我创建了一个自定义任务来完成它。保持您的构建脚本简洁明了，并为您提供更多的灵活性和封装可能性。

```
 public override bool Execute()
    {       
        IBuildDefinition[] buildDefinitions = BuildServer.QueryBuildDefinitions(ProjectName);

        foreach (IBuildDefinition build in buildDefinitions)
        {
            if(build.Enabled) //I did a bunch of custom rules here
            {
                Log.LogMessage(String.Concat("Queuing build: ", build.Name));
                BuildServer.QueueBuild(build);
            }
        }

        return true;
    } 
```

Aaron Hallberg 的博客上还有更多好东西：

[http://blogs.msdn.com/aaronhallberg/archive/2007/04/24/team-build-object-model-queueing-a-build.aspx](http://blogs.msdn.com/aaronhallberg/archive/2007/04/24/team-build-object-model-queueing-a-build.aspx)

# eclipse - 如何在 eclipse java 调试器中设置当前执行行？

> ID：191306
> 
> 赞同：33
> 
> 时间：2008-10-10T13:37:25.667
> 
> 标签：eclipse, debugging, execution

我想将当前执行行强制到同一函数中的特定行，可能会跳过中间行。我所有的老式调试器都有这个功能，但我在 Eclipse 中找不到它。有没有办法在不更改代码的情况下做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-10T15:18:03.560

前两个答案似乎错过了这个话题，除非是我不理解这个问题。

我的理解是，我自己搜索的一个功能是，您想*跳过*多行（在单步执行代码时）并将程序计数器（以获取汇编词汇表）设置为给定的行。跳过一些代价高昂的对象创建、查看一些错误情况等可能会很有趣。我曾经在 Visual Studio（C 或 C++ 代码）中这样做。

我在 Eclipse 和 NetBean 中都没有找到。这可能是 JVM 的限制，或者是某些策略的执行......

*Run to line*命令当然会执行当前执行位置和指定位置之间的所有行。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-14T00:55:20.197

我也一直在寻找这个功能，和“跑到线”不是一回事。

这很可能是 JVM 的限制。Java 没有实现 goto，尽管它有*跳转*语句，比如 break 和 continue。然而，这些是在块级别。如果这是 JVM 限制，我的猜测是更有可能是由于安全架构。*对程序计数器*的严格控制使入侵者（如病毒）变得虚弱，而且可悲的是调试器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T11:04:39.670

我认为这在 Java 中是不可能的。唯一允许您“后退”的功能是使用“drop to frame”，它会将您带回到当前帧的第一条指令。至少我还没有看到任何具有此特定功能的调试器，但我无法在网上找到为什么会这样......

我知道 Visual C 中的调试器允许更改为指针。我会继续寻找，也许至少我们会知道为什么会这样，但这似乎是某种设计限制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-09T07:44:50.227

**功能请求说这是不可能的**

在[https://bugs.eclipse.org/bugs/show_bug.cgi?id=287795](https://bugs.eclipse.org/bugs/show_bug.cgi?id=287795)（**[感谢 Amitd](https://stackoverflow.com/questions/191306/how-can-i-set-the-current-line-of-execution-in-the-eclipse-java-debugger#comment17790642_191306)****）**中， [Darin Wright](https://wiki.eclipse.org/Darin_Wright)说这是底层 Java 调试器的限制：

> 目前，Java 调试器无法做到这一点，因为本机调试接口不提供任意移动/设置程序计数器的能力。

**C / C++**

然而，CDT 支持它（在 Neon、Ubuntu 14.04 上测试）。右键单击要转到的行，然后选择：

*   “移动到行”：跳到行并在那里中断
*   "Resume at line"：跳转到该行并从那里继续执行

这也进一步证明了 Java 存在潜在的限制，因为 Java 往往在 Eclipse 中功能更丰富，并且这些菜单条目在 Java 中不存在于“Run to line”旁边（它不会跳过行的执行） .

如果您跳行，此测试程序将打印 0 `i = 1`：

```
#include <stdio.h>

int main(void) {
    int i;
    i = 0; /* Break here. */
    i = 1;
    printf("%d\n", i); /* Jump to here. */
} 
```

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2008-10-10T13:50:48.633

“运行到行”似乎需要程序正在运行并处于暂停状态才能使用。另一个选项是在调试模式下运行时为该行设置断点。

1.  在同一行的源窗格中双击最左侧的垂直条以添加断点；或者，
2.  选择该行并转到 Run > Toggle Breakpoint。

至少，这是在 Eclipse 3.3.2 中。

# emacs - 如何在控制台模式下进入 Emacs 中的菜单？

> ID：191312
> 
> 赞同：91
> 
> 时间：2008-10-10T13:38:18.690
> 
> 标签：emacs

如果您使用该`-nw`标志启动 Emacs 以强制进行控制台会话（而不是 X 会话，如果您正在运行 X 窗口），您如何进入菜单？

菜单中有些项目我不经常使用，我不记得使用转义或控制序列来执行它们。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2008-10-10T13:53:08.037

`M-x menu-bar-open`，通常绑定到`F10`。这在有和没有的情况下`menu-bar-mode`都有效（它只在屏幕顶部显示菜单的名称）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-14T09:07:48.780

在我的计算机上（使用[openSUSE](https://en.wikipedia.org/wiki/OpenSUSE)），不是`F10`M-` 允许访问菜单项。更多信息请点击这里：

[http://linux.about.com/od/emacs_doc/a/emacsdoc317.htm](http://linux.about.com/od/emacs_doc/a/emacsdoc317.htm)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-10T13:49:19.463

该`F10`密钥将为我访问 Windows 版本和[Red Hat Linux](https://en.wikipedia.org/wiki/Red_Hat_Linux) (RHEL) 4 中的控制台版本中的菜单。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-21T20:08:42.700

`F10`无法通过 Mac 终端通过 ssh 访问远程主机。

如何进入菜单：

`C-h b to get all the key bindings.`

用于`C-s`在键绑定帮助中逐步搜索“菜单”。点击`C-s`查找下一个和下一个事件。

看到了`ESC` ```吗？

在 Mac 上输入`ESC`` 即可。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-09-05T07:08:01.747

[***点菜***](http://www.emacswiki.org/emacs/LaCarte)（图书馆[lacarte.el](http://www.emacswiki.org/emacs/download/lacarte.el)）--------

它允许您使用完成从键盘执行菜单命令：

```
ESC M-x
Menu command:
Menu command: t [TAB]
Menu command: Tools > 
Menu command: Tools > Compa [TAB]
Menu command: Tools > Compare (Ediff) > Two F [TAB]
Menu command: Tools > Compare (Ediff) > Two Files... [RET] 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-10-26T15:43:06.407

对于我的 Emacs 和 Mac 设置，我发现`Command`+ `Fn`+`F10`创建了一个缓冲区，显示 Emacs 菜单内容可通过进一步的按键选择。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-10T13:46:07.287

```
M-x menu-bar-mode 
```

# ruby - 在 Ruby 中使用 Range 填充数组的正确方法

> ID：191329
> 
> 赞同：219
> 
> 时间：2008-10-10T13:41:47.203
> 
> 标签：ruby, syntax

我正在阅读一本书，其中给出了使用“to_a”方法将范围转换为等效数组的示例

当我在 irb 中运行代码时，我收到以下警告

```
 warning: default `to_a' will be obsolete 
```

使用 to_a 的正确替代方法是什么？

是否有其他方法可以使用 Range 填充数组？

* * *

## 回答 #1

> 赞同：390
> 
> 时间：2011-07-05T18:22:15.647

您可以使用 splat 创建具有范围的数组，

```
>> a=*(1..10)
=> [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] 
```

使用`Kernel` `Array`方法，

```
Array (1..10)
=> [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] 
```

或使用 to_a

```
(1..10).to_a
=> [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] 
```

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2008-10-10T13:49:55.297

这在 irb 中对我有用：

```
irb> (1..4).to_a
=> [1, 2, 3, 4] 
```

我注意到：

```
irb> 1..4.to_a
(irb):1: warning: default `to_a' will be obsolete
ArgumentError: bad value for range
        from (irb):1 
```

所以也许你错过了括号？

（我正在运行 Ruby 1.8.6 补丁级别 114）

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2008-10-10T13:52:40.847

听起来你正在这样做：

```
0..10.to_a 
```

警告来自 Fixnum#to_a，而不是来自 Range#to_a。试试这个：

```
(0..10).to_a 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-06-12T04:25:55.383

检查这个：

```
a = [*(1..10), :top, *10.downto( 1 )] 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-02-27T13:19:52.870

这是另一种方式：

```
irb> [*1..10]

=> [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-04-16T13:35:32.727

我只是尝试使用从大到小的范围，得到了我没想到的结果：

```
irb(main):007:0> Array(1..5)
=> [1, 2, 3, 4, 5]
irb(main):008:0> Array(5..1)
=> [] 
```

那是因为范围实现。
所以我不得不使用以下选项：

```
(1..5).to_a.reverse 
```

# windows - Windows 等效于 /dev/random

> ID：191335
> 
> 赞同：53
> 
> 时间：2008-10-10T13:43:51.550
> 
> 标签：windows, random

是否有相当于 Linux 的[/dev/random](http://en.wikipedia.org/wiki/Urandom#Linux)的 Windows 版本？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-10T13:45:35.650

是的，它被称为[Microsoft CryptoAPI](http://en.wikipedia.org/wiki/Entropy_(computing)#Windows)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-29T12:13:05.180

来自 StingyJack 答案的链接很好：[http ://en.wikipedia.org/wiki/CryptGenRandom](http://en.wikipedia.org/wiki/CryptGenRandom)

Microsoft C++ Visual Studio 自 2005 年以来提供[`rand_s()`](http://msdn.microsoft.com/en-us/library/sxtz2fa8.aspx)可在 Windows XP 及更高版本上运行的功能。它基于[`RtlGenRandom`](http://msdn.microsoft.com/en-us/library/aa387694.aspx)（就像 CryptoAPI 的 PRNG 函数一样），其内部工作并未公开。似乎在 XP 中存在一些已被修复的弱点。

就个人而言，我使用`rand_s()`随机性的额外来源来播种我选择的 PRNG。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T13:52:06.027

如果您正在进行 .NET 开发，您可以使用[RandomNumberGenerator](http://msdn.microsoft.com/en-us/library/system.security.cryptography.randomnumbergenerator.aspx)类。

# .net - 当网格绑定到排序的DataView时，如何将DataGridView的选定行设置为新添加的行？

> ID：191339
> 
> 赞同：3
> 
> 时间：2008-10-10T13:45:20.237
> 
> 标签：.net, winforms, data-binding, datagridview, dataview

我有`DataGridView`一个`DataView`. 用户可以在任何列上对网格进行排序。

`DataView`我通过在' 的基础上调用 NewRow 向网格中添加一行`DataTable`，然后将其添加到`DataTable`' 的 Rows 集合中。如何在网格中选择新添加的行？

我尝试通过创建一个`BindingManagerBase`绑定到 的对象`BindingContext`，`DataView`然后设置`BindingManagerBase.Position = BindingManagerBase.Count`. 如果网格未排序，则此方法有效，因为新行被添加到网格的底部。但是，如果排序顺序是该行未添加到底部，则此方法不起作用。

如何可靠地将网格的选定行设置为新行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-26T01:43:01.503

更新绑定的 DataTable 后，DataGridView 控件将触发“RowsAdded”事件，其中 DataGridViewRowsAddedEventArgs.RowIndex 属性包含已添加行的索引。

```
//local member
private int addedRowIndex;

private void AddMyRow()
{
    //add the DataRow           
    MyDataSet.MyDataTable.Rows.Add(...);

    //RowsAdded event is fired here....

    //select the row
    MyDataGrid.Rows[addedRowIndex].Selected = true;
}

private void MyDataGrid_RowsAdded(object sender, DataGridViewRowsAddedEventArgs e)
{
    addedRowIndex = e.RowIndex;
} 
```

也许不是最优雅的解决方案，但它对我有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-03T02:11:43.197

不知道它是最好的解决方案，但例如看起来比迭代更好。

```
 DataRowView drv = (DataRowView)source.AddNew();
            grupoTableAdapter.Update(drv.Row);
            grupoBindingSource.Position = grupoBindingSource.Find("ID", drv.Row.ItemArray[0]); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T19:05:52.160

假设您的数据源中有某种唯一标识符，您可以遍历行集合并进行比较，如下所示：

```
Dim myRecentItemID As Integer = 3

For Each row As GridViewRow In gvIndividuals.Rows
    Dim drv As DataRowView = DirectCast(row.DataItem, DataRowView)
    If CInt(drv("ItemID")) = myRecentItemID Then
        gvIndividuals.EditIndex = row.RowIndex
    End If
Next 
```

希望这可以帮助！

# sql-server - 数据库表中的随机记录 (T-SQL)

> ID：191342
> 
> 赞同：93
> 
> 时间：2008-10-10T13:45:45.463
> 
> 标签：sql-server, tsql, random

是否有一种简洁的方法可以从 sql server 表中检索随机记录？

我想随机化我的单元测试数据，所以我正在寻找一种从表中选择随机 id 的简单方法。在英语中，选择将是“从表中选择一个 id，其中 id 是表中最低 id 和表中最高 id 之间的随机数。”

如果不必运行查询，测试空值，然后如果为空，则重新运行，我无法找到一种方法。

想法？

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2008-10-10T13:46:58.703

> 是否有一种简洁的方法可以从 sql server 表中检索随机记录？

是的

```
SELECT TOP 1 * FROM table ORDER BY NEWID() 
```

## 解释

为每一行生成A `NEWID()`，然后按它对表进行排序。返回第一条记录（即具有“最低”GUID 的记录）。

### 笔记

1.  GUID 从第四版开始生成为伪随机数：

    > 第 4 版 UUID 用于从真正随机或伪随机数生成 UUID。
    > 
    > 算法如下：
    > 
    > *   将clock_seq_hi_and_reserved 的两个最高有效位（位6 和7）分别设置为零和一。
    > *   将 time_hi_and_version 字段的四个最高有效位（位 12 到 15）设置为 4.1.3 节中的 4 位版本号。
    > *   将所有其他位设置为随机（或伪随机）选择的值。

    —[通用唯一标识符 (UUID) URN 命名空间 - RFC 4122](http://www.ietf.org/rfc/rfc4122.txt)

2.  替代方案`SELECT TOP 1 * FROM table ORDER BY RAND()`不会像人们想象的那样起作用。`RAND()`每个查询返回一个值，因此所有行将共享相同的值。

3.  虽然 GUID 值是伪随机的，但对于要求更高的应用程序，您将需要更好的 PRNG。

4.  大约 1,000,000 行的典型性能不到 10 秒——当然取决于系统。请注意，不可能命中索引，因此性能将相对有限。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-08-26T10:24:27.650

在较大的表上，您也可以使用`TABLESAMPLE`它来避免扫描整个表。

```
SELECT  TOP 1 *
FROM YourTable
TABLESAMPLE (1000 ROWS)
ORDER BY NEWID() 
```

`ORDER BY NEWID`仍然需要避免只返回首先出现在数据页上的行。

需要根据表的大小和定义仔细选择要使用的数字，如果没有返回行，您可能会考虑重试逻辑。[这里讨论了](http://toponewithties.blogspot.co.uk/2005/08/sampling-using-tablesample.html)这背后的数学以及为什么该技术不适合小表

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-10T14:13:06.030

也尝试你的方法来获得 MIN(Id) 和 MAX(Id) 之间的随机 Id，然后

```
SELECT TOP 1 * FROM table WHERE Id >= @yourrandomid 
```

它总是会让你排一排。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-12-16T08:33:56.417

如果您想选择大数据，我知道的最好方法是：

```
SELECT * FROM Table1
WHERE (ABS(CAST(
    (BINARY_CHECKSUM
    (keycol1, NEWID())) as int))
    % 100) < 10 
```

资料来源：[MSDN](http://msdn.microsoft.com/en-us/library/cc441928.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-17T18:58:50.230

我正在寻求改进我尝试过的方法并遇到了这篇文章。我意识到它很旧，但没有列出这种方法。我正在创建和应用测试数据；这显示了用@st（两个字符状态）调用的SP中“地址”的方法

```
Create Table ##TmpAddress (id Int Identity(1,1), street VarChar(50), city VarChar(50), st VarChar(2), zip VarChar(5))
Insert Into ##TmpAddress(street, city, st, zip)
Select street, city, st, zip 
From tbl_Address (NOLOCK)
Where st = @st

-- unseeded RAND() will return the same number when called in rapid succession so
-- here, I seed it with a guaranteed different number each time. @@ROWCOUNT is the count from the most recent table operation.

Set @csr = Ceiling(RAND(convert(varbinary, newid())) * @@ROWCOUNT)

Select street, city, st, Right(('00000' + ltrim(zip)),5) As zip
From ##tmpAddress (NOLOCK)
Where id = @csr 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-21T14:03:04.597

> *如果您真的想要单个行的随机样本，请修改您的查询以随机过滤掉行，而不是使用 TABLESAMPLE。例如，以下查询使用 NEWID 函数返回 Sales.SalesOrderDetail 表中大约百分之一的行：*

```
SELECT * FROM Sales.SalesOrderDetail
WHERE 0.01 >= CAST(CHECKSUM(NEWID(), SalesOrderID) & 0x7fffffff AS float)
/ CAST (0x7fffffff AS int) 
```

> *SalesOrderID 列包含在 CHECKSUM 表达式中，以便 NEWID() 每行计算一次，以实现逐行抽样。表达式 CAST(CHECKSUM(NEWID(), SalesOrderID) & 0x7fffffff AS float / CAST (0x7fffffff AS int) 计算为 0 到 1 之间的随机浮点值。”*
> 
> 来源：[http ://technet.microsoft.com/en-us/library/ms189108(v=sql.105).aspx](http://technet.microsoft.com/en-us/library/ms189108(v=sql.105).aspx)

这在下面进一步解释：

> 这是如何运作的？让我们拆分 WHERE 子句并解释一下。
> 
> CHECKSUM 函数正在计算列表中项目的校验和。是否需要 SalesOrderID 是有争议的，因为 NEWID() 是一个返回新随机 GUID 的函数，因此将随机数字乘以常数在任何情况下都应该是随机的。事实上，排除 SalesOrderID 似乎没有什么区别。如果您是一位敏锐的统计学家并且可以证明将其包含在内，请使用下面的评论部分，让我知道为什么我错了！
> 
> CHECKSUM 函数返回一个 VARBINARY。对 0x7fffffff（相当于二进制的 (111111111...)）执行按位与运算，会产生一个十进制值，它实际上是 0 和 1 的随机字符串的表示。除以系数 0x7fffffff 有效地将这个十进制数字归一化为 0 和 1 之间的数字。然后为了决定每一行是否值得包含在最终结果集中，使用阈值 1/x（在本例中为 0.01），其中x 是作为样本检索的数据的百分比。
> 
> 来源：[https ://www.mssqltips.com/sqlservertip/3157/different-ways-to-get-random-data-for-sql-server-data-sampling](https://www.mssqltips.com/sqlservertip/3157/different-ways-to-get-random-data-for-sql-server-data-sampling)

# windows - Windows 脚本 FOR 命令重命名目录中的所有文件

> ID：191351
> 
> 赞同：1
> 
> 时间：2008-10-10T13:47:54.053
> 
> 标签：windows, cmd

我正在尝试在命令提示符下使用**FOR**命令重命名 Windows 目录中存在的所有文件，如下所示：

```
for %1 in (*.*) do ren %1 test%1 
```

例如，这会将文件**enc1.ctl**重命名为**testenc1.ctl** **enc2.ctl** 到**testenc2.ctl**

那不是我想要的。我想要的是 **enc1.ctl**重命名为**test1.ctl** **enc2.ctl**重命名为**test2.ctl**

我怎么做？

* * *

@Akelunuk：谢谢，这很有效，但我的文件名是

**h263_enc_random_pixels_1.ctl , h263_enc_random_pixels_2.ctl**我想重命名为

**test1.ctl 和 test2.ctl**分别

那怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T14:06:40.490

我懂了！

```
for %1 in (.) do ren %1 t%1 
```

进而：

```
ren tenc*.* test*.* 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T14:03:27.393

如果您知道文件的数量（例如 10 个），您可以使用

```
for /L %1 in (1,1,10) do ren enc%1.ctl test%1.ctl 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T14:35:04.067

我不确定是否可以批量进行，但是我又一次没有掌握这种原始语言... :-P

如果 CMD 不是强制性的，但您不能使用良好的文件重命名器，则可以使用 WSH 执行此操作：

```
var path= "E:/tmp";

var fso = WScript.CreateObject("Scripting.FileSystemObject");
var folder = fso.GetFolder(path);
var files = new Enumerator(folder.files);
for (; !files.atEnd(); files.moveNext())
{
  var file = files.item();
  var fileName = file.Name;
  var p = /^enc(\d+)\.ctl$/.exec(fileName);
  if (p != null)
  {
    var newFileName = "test" + p[1] + ".ctl";
    // Optional feedback
    WScript.echo(fileName + " -----> " + newFileName);
    file.Move(newFileName);
  }
} 
```

当然，把它放在
我实际测试过的 file.js 中，`file.Copy(file.ParentFolder + "/SO/" + newFileName);`以避免丢失文件......

HTH。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-29T00:30:07.367

这将使用 PREFIX 和今天的日期和时间重命名过滤器文件类型目录中的所有文件

```
@echo ON
cls
for %%a in (*.pdf) do (set myfiledate=%%~ta echo !myfiledate!)

echo Date format = %myfiledate%
echo dd = %myfiledate:~0,2%
echo mm = %myfiledate:~3,2%
echo yyyy = %myfiledate:~6,4%
echo.
echo Time format = %myfiledate%
echo hh = %myfiledate:~11,2%
echo mm = %myfiledate:~14,2%
echo AM = %myfiledate:~17,2%
echo.
echo Timestamp = %myfiledate:~0,2%_%myfiledate:~3,2%_%myfiledate:~6,4%-%myfiledate:~11,2%_%myfiledate:~14,2%_%myfiledate:~17,2%
ECHO "TEST..." > "test-%myfiledate:~0,2%_%myfiledate:~3,2%_%myfiledate:~6,4%-TIME-%myfiledate:~11,2%_%myfiledate:~14,2%_%myfiledate:~17,2%.txt"
PAUSE 
```

这成功地将修改日期和时间作为后缀回显，但不会将信息解析为重命名。我不知道为什么，但它非常接近。也许有人无法调整以适应您的目的。

```
@echo ON
setlocal
cls
for %%a in (*.pdf) do (set myfiledate=%%~ta echo !myfiledate!)

:DATETIME
echo Date format = %myfiledate%
echo dd = %myfiledate:~0,2%
echo mm = %myfiledate:~3,2%
echo yyyy = %myfiledate:~6,4%

echo Time format = %myfiledate%
echo hh = %myfiledate:~11,2%
echo mm = %myfiledate:~14,2%
echo AM = %myfiledate:~17,2%
 = %myfiledate:~17,2%
echo.

echo Timestamp = %myfiledate:~0,2%_%myfiledate:~3,2%_%myfiledate:~6,4%-%myfiledate:~11,2%_%myfiledate:~14,2%_%myfiledate:~17,2%
ECHO "TEST..." > "test-%myfiledate:~0,2%_%myfiledate:~3,2%_%myfiledate:~6,4%-TIME-%myfiledate:~11,2%_%myfiledate:~14,2%_%myfiledate:~17,2%.txt"

for /f "delims=" %%a in ('dir *.pdf /t:a /a:-d /b /s') do call :RENAME "%%a"

:RENAME
REM for /f "tokens=1-6 delims=/ " %%a in ('dir %%a /t:w^|find "/"') do (
ren %%a "3DC-test-OFF-ELE-%myfiledate:~0,2%_%myfiledate:~3,2%_%myfiledate:~6,4%-TIME-%myfiledate:~11,2%_%myfiledate:~14,2%_%myfiledate:~17,2%~x1")
PAUSE
GOTO :EOF 
```

# visual-c++ - 为什么 WD Velociraptor 不能显着加快我的 VC++ 编译速度？

> ID：191354
> 
> 赞同：6
> 
> 时间：2008-10-10T13:48:53.163
> 
> 标签：visual-c++, hardware, performance, compilation

这里有几个人建议切换到新的**WD Velociraptor 10000rpm**硬盘。杂志文章也赞扬了表现。我买了一个并将我的旧系统镜像到它。编译速度的提高有点令人失望：

*   在我的旧三星驱动器（SATA，7200）上，编译时间是**16:02**。
*   在 Velociraptor 上，构建需要**15:23**。

我有一个1.5G 内存的**E6600 。**这是一个包含 1200 个文件的 C++ 项目。构建是在 Visual Studio 2005 中完成的。声学管理已关闭（反正没有大的区别）。

是不是出了什么问题，或者这种适度的加速真的是全部，我可以期待吗？

**编辑：** 有些人建议增加 RAM。我现在这样做了，通过将我的 RAM 翻倍至 3GB，获得了最小的收益 (3-5%)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T14:09:35.507

您是否使用 /MP 选项（未记录，您必须手动将其输入到您的处理器选项）来启用源级并行构建？这将大大加快您的编译速度，而不仅仅是更快的硬盘。从中获得的收益是微不足道的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T13:57:48.013

Visual Studio 2005 可以并行构建多个项目，并且默认情况下会在多核计算机上这样做，但取决于您的项目如何相互依赖，它可能无法并行构建它们。

如果您的 1200 个 cpp 文件位于单个项目中，则您可能没有使用所有 CPU。如果我没记错的话，C6600 是四核 CPU。

戴夫

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T13:50:58.087

我想硬盘读取不是你编译的瓶颈。实际上，很少有东西需要从硬盘读取/写入硬盘。您可能会看到更多内存或更快的处理器带来更多的性能提升。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T13:51:41.410

我从结果中建议您的硬盘延迟速度不是您正在寻找的瓶颈，或者您的项目已经接近于尽可能快地构建。其他需要考虑的项目是：

1.  硬盘访问时间（尽管由于总线速度限制，您可能无法对此做很多事情）
2.  RAM访问速度和大小
3.  处理器速度
4.  减少后台进程

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T13:52:10.783

**仅**通过改进硬盘驱动器即可提高约 6% 的速度。就像豪勒所说的那样。抓住一些**更快**的内存和 PCU。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T13:55:28.797

正如许多人已经指出的那样，您可能没有攻击真正的瓶颈。随机改变部分（或代码）就像人们所说的“低音确认”。您首先确定性能瓶颈，然后进行更改。

如果您受 CPU 或 I/O 限制，Perfmon 可以帮助您获得一个很好的概览，您想查看 CPU 利用率、磁盘队列长度和 IO 字节以初步了解正在发生的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-10T14:08:22.453

对于更换硬盘而言，这实际上是一个相当大的速度提升。此时您可能会受到内存或 CPU 的限制。现在 1.5GB 很轻，而且 RAM 很便宜。您可能会看到更多内存带来的一些相当大的改进。

作为建议，如果您安装了多个驱动器，则可以尝试将构建目录设置为与源文件不同的磁盘上的某个位置。

至于这条评论：

> 如果您的 1200 个 cpp 文件位于单个项目中，则您可能没有使用所有 CPU。如果我没记错的话，C6600 是四核 CPU。

实际上，C6600 什么都不是。有 E6600 和 Q6600。E6600 是双核，Q6600 是四核。在我的开发机器上，我使用四核 CPU，虽然我们的项目有 1200 多个文件，但它在编译期间仍然受到处理器的限制（尽管更快的硬盘驱动器仍然有助于加快速度！）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T14:01:34.230

1200 个源文件很多，但它们都不可能超过几百 K，因此虽然它们都需要读入内存，但不会花费很长时间。

将您的系统内存提高到 4G（是的，是的，我知道 32 位操作系统的 3.something 或other 限制），并且也许查看您的 CPU 会比仅使用更快的磁盘驱动器提供更多的性能改进。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-10T14:32:20.297

VC 2005 每个项目一次编译的文件不超过一个，因此要么迁移到 VC 2008 以使用你的两个 CPU 内核，要么将你的解决方案分解为多个库子项目以进行多个编译。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-15T21:03:16.470

通过将所有源代码放在内存驱动器上，我将编译时间减半。

我尝试了这些家伙[http://www.superspeed.com/desktop/ramdisk.php](http://www.superspeed.com/desktop/ramdisk.php)，安装了一个 1GB ramdrive，然后将我所有的源代码复制到它上面。如果直接从 RAM 构建，IO 开销会大大减少。

让您了解我正在编译的内容以及内容；

*   WinXP 64 位
*   4GB 内存
*   2.? GHz 双核处理器
*   62 个 C# 项目
*   约250kloc。

我的构建从大约 135 秒到 65 秒。

缺点是您的源文件位于 RAM 中，因此您需要对源代码控制更加警惕。如果您的机器断电，您将丢失所有未版本化的更改。当您关闭机器时，某些 RAMdrives 会将自己保存到磁盘中，这一事实稍微减轻了一些影响，但您仍然会丢失上次结帐或上次关闭时的所有内容。

此外，您必须为软件付费。但是，既然您正在为硬盘买单，也许这没什么大不了的。

好处是增加了编译时间，而且 exe 已经存在于内存中，因此启动时间和调试时间要好一些。不过，真正的好处是编译时间。

# python - 如何在 Python 中将文件转换为 utf-8？

> ID：191359
> 
> 赞同：70
> 
> 时间：2008-10-10T13:50:26.467
> 
> 标签：python, encoding, file, utf-8

我需要在 Python 中将一堆文件转换为 utf-8，并且在“转换文件”部分遇到问题。

我想做相当于：

```
iconv -t utf-8 $file > converted/$file # this is shell code 
```

谢谢！

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-10-10T13:59:07.760

您可以使用[编解码器模块](https://docs.python.org/2/library/codecs.html)，如下所示：

```
import codecs
BLOCKSIZE = 1048576 # or some other, desired size in bytes
with codecs.open(sourceFileName, "r", "your-source-encoding") as sourceFile:
    with codecs.open(targetFileName, "w", "utf-8") as targetFile:
        while True:
            contents = sourceFile.read(BLOCKSIZE)
            if not contents:
                break
            targetFile.write(contents) 
```

**编辑**：添加`BLOCKSIZE`参数来控制文件块大小。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-10-10T14:07:07.820

这在一个小测试中对我有用：

```
sourceEncoding = "iso-8859-1"
targetEncoding = "utf-8"
source = open("source")
target = open("target", "w")

target.write(unicode(source.read(), sourceEncoding).encode(targetEncoding)) 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-10T16:14:45.990

感谢您的回复，它的工作原理！

由于源文件是混合格式，我添加了一个要按顺序尝试的源格式列表（`sourceFormats`），然后`UnicodeDecodeError`我尝试下一种格式：

```
from __future__ import with_statement

import os
import sys
import codecs
from chardet.universaldetector import UniversalDetector

targetFormat = 'utf-8'
outputDir = 'converted'
detector = UniversalDetector()

def get_encoding_type(current_file):
    detector.reset()
    for line in file(current_file):
        detector.feed(line)
        if detector.done: break
    detector.close()
    return detector.result['encoding']

def convertFileBestGuess(filename):
   sourceFormats = ['ascii', 'iso-8859-1']
   for format in sourceFormats:
     try:
        with codecs.open(fileName, 'rU', format) as sourceFile:
            writeConversion(sourceFile)
            print('Done.')
            return
      except UnicodeDecodeError:
        pass

def convertFileWithDetection(fileName):
    print("Converting '" + fileName + "'...")
    format=get_encoding_type(fileName)
    try:
        with codecs.open(fileName, 'rU', format) as sourceFile:
            writeConversion(sourceFile)
            print('Done.')
            return
    except UnicodeDecodeError:
        pass

    print("Error: failed to convert '" + fileName + "'.")

def writeConversion(file):
    with codecs.open(outputDir + '/' + fileName, 'w', targetFormat) as targetFile:
        for line in file:
            targetFile.write(line)

# Off topic: get the file list and call convertFile on each file
# ... 
```

（Rudro Badhon 编辑：这包含了原始的尝试多种格式，直到您没有遇到异常以及使用 chardet.universaldetector 的替代方法）

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2018-12-19T12:59:16.057

**未知来源编码类型**的答案

 **基于[@Sébastien RoccaSerra](https://stackoverflow.com/a/192086/9026554)

**python3.6**

```
import os    
from chardet import detect

# get file encoding type
def get_encoding_type(file):
    with open(file, 'rb') as f:
        rawdata = f.read()
    return detect(rawdata)['encoding']

from_codec = get_encoding_type(srcfile)

# add try: except block for reliability
try: 
    with open(srcfile, 'r', encoding=from_codec) as f, open(trgfile, 'w', encoding='utf-8') as e:
        text = f.read() # for small files, for big use chunks
        e.write(text)

    os.remove(srcfile) # remove old encoding file
    os.rename(trgfile, srcfile) # rename new encoding
except UnicodeDecodeError:
    print('Decode Error')
except UnicodeEncodeError:
    print('Encode Error') 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-01-08T17:58:58.437

这是一个**Python3**函数，用于将任何文本文件转换为 UTF-8 编码的文件。（不使用不必要的包）

```
def correctSubtitleEncoding(filename, newFilename, encoding_from, encoding_to='UTF-8'):
    with open(filename, 'r', encoding=encoding_from) as fr:
        with open(newFilename, 'w', encoding=encoding_to) as fw:
            for line in fr:
                fw.write(line[:-1]+'\r\n') 
```

您可以在循环中轻松使用它来转换文件列表。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-02-08T19:44:05.990

要猜测源编码是什么，您可以使用`file`*nix 命令。

例子：

```
$ file --mime jumper.xml

jumper.xml: application/xml; charset=utf-8 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-04-26T14:43:59.053

您可以使用这一行（假设您想从*utf16**转换*为*utf8*）

```
 python -c "from pathlib import Path; path = Path('yourfile.txt') ; path.write_text(path.read_text(encoding='utf16'), encoding='utf8')" 
```

*$file*`yourfile.txt`的路径在哪里。

 *为此，您需要*python 3.4*或更高版本（现在可能需要）。

下面是上面代码的更易读版本

```
from pathlib import Path
path = Path("yourfile.txt")
path.write_text(path.read_text(encoding="utf16"), encoding="utf8") 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-11-30T07:35:07.427

这是我的蛮力方法。它还处理输入中混合的 \n 和 \r\n 。

```
 # open the CSV file
    inputfile = open(filelocation, 'rb')
    outputfile = open(outputfilelocation, 'w', encoding='utf-8')
    for line in inputfile:
        if line[-2:] == b'\r\n' or line[-2:] == b'\n\r':
            output = line[:-2].decode('utf-8', 'replace') + '\n'
        elif line[-1:] == b'\r' or line[-1:] == b'\n':
            output = line[:-1].decode('utf-8', 'replace') + '\n'
        else:
            output = line.decode('utf-8', 'replace') + '\n'
        outputfile.write(output)
    outputfile.close()
except BaseException as error:
    cfg.log(self.outf, "Error(18): opening CSV-file " + filelocation + " failed: " + str(error))
    self.loadedwitherrors = 1
    return ([])
try:
    # open the CSV-file of this source table
    csvreader = csv.reader(open(outputfilelocation, "rU"), delimiter=delimitervalue, quoting=quotevalue, dialect=csv.excel_tab)
except BaseException as error:
    cfg.log(self.outf, "Error(19): reading CSV-file " + filelocation + " failed: " + str(error)) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-18T15:07:39.500

将目录中的所有文件转换为 utf-8 编码。它是递归的，可以按后缀过滤文件。谢谢@Sole 老师

```
# pip install -i https://pypi.tuna.tsinghua.edu.cn/simple chardet
import os
import re
from chardet import detect

def get_file_list(d):
    result = []
    for root, dirs, files in os.walk(d):
        dirs[:] = [d for d in dirs if d not in ['venv', 'cmake-build-debug']]
        for filename in files:
            # your filter
            if re.search(r'(\.c|\.cpp|\.h|\.txt)$', filename):
                result.append(os.path.join(root, filename))
    return result

# get file encoding type
def get_encoding_type(file):
    with open(file, 'rb') as f:
        raw_data = f.read()
    return detect(raw_data)['encoding']

if __name__ == "__main__":
    file_list = get_file_list('.')
    for src_file in file_list:
        print(src_file)
        trg_file = src_file + '.swp'
        from_codec = get_encoding_type(src_file)
        try:
            with open(src_file, 'r', encoding=from_codec) as f, open(trg_file, 'w', encoding='utf-8') as e:
                text = f.read()
                e.write(text)
            os.remove(src_file)
            os.rename(trg_file, src_file)
        except UnicodeDecodeError:
            print('Decode Error')
        except UnicodeEncodeError:
            print('Encode Error') 
```

# linux - 快速 unix 命令在文件中间显示特定行？

> ID：191364
> 
> 赞同：232
> 
> 时间：2008-10-10T13:51:18.320
> 
> 标签：linux, bash, unix, text

尝试调试服务器的问题，而我唯一的日志文件是 20GB 的日志文件（甚至没有时间戳！为什么人们将`System.out.println()`其用作日志记录？在生产中？！）

使用 grep，我找到了我想查看的文件区域，第 347340107 行。

除了做类似的事情

```
head -<$LINENUM + 10> filename | tail -20 
```

...这需要`head`通读日志文件的前 3.47 亿行，是否有一个快速简便的命令可以将行 347340100 - 347340200（例如）转储到控制台？

**更新**我完全忘记了 grep 可以打印匹配的上下文......这很好用。谢谢！

* * *

## 回答 #1

> 赞同：433
> 
> 时间：2008-10-10T14:06:32.503

如果你知道行号，我发现了另外两个[解决方案](http://www.unix.com/unix-dummies-questions-answers/21027-how-do-you-specific-lines-file.html)，但没有别的（没有 grep 可能）：

假设您需要第 20 到 40 行，

```
sed -n '20,40p;41q' file_name 
```

或者

```
awk 'FNR>=20 && FNR<=40' file_name 
```

使用`sed`时，在打印最后一行后退出处理比继续处理直到文件末尾更有效。这在开始时大文件和打印行的情况下尤其重要。为了做到这一点，`sed`上面的命令引入了指令`41q`，以便在第 41 行之后停止处理，因为在示例中我们只对第 20-40 行感兴趣。您需要将 41 更改为您感兴趣的最后一行，加一。

* * *

## 回答 #2

> 赞同：132
> 
> 时间：2013-06-28T14:35:24.587

```
# print line number 52
sed -n '52p' # method 1
sed '52!d' # method 2
sed '52q;d' # method 3,  efficient on large files 
```

***方法 3 对大文件有效***

显示特定行的最快方法

* * *

## 回答 #3

> 赞同：67
> 
> 时间：2008-10-10T13:55:48.453

使用 GNU-grep 你可以说

```
grep --context=10 ...
```

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2008-10-15T13:55:17.187

不，没有，文件不是行可寻址的。

没有固定时间的方法来查找文本文件中第*n行的开头。*您必须通过文件流式传输并计算换行符。

使用完成工作所需的最简单/最快的工具。对我来说， using*比*更有意义`head`，因为后者要复杂得多。我不是说“很慢”，实际上不是，但如果它比这种情况下更快，我会感到惊讶。基本上，那将是一个错误。*`grep``grep``head``head`*

 ** * *

## 回答 #5

> 赞同：22
> 
> 时间：2008-10-10T13:58:23.067

关于什么：

```
tail -n +347340107 filename | head -n 100 
```

我没有测试它，但我认为这会奏效。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2013-08-07T01:16:37.240

我更喜欢进入`less`和

*   键入`5``0``%`转到文件的一半，
*   `43210``G`去43210行
*   `:43210`做同样的事情

和类似的东西。

更好的是：`v`在那个位置点击开始编辑（当然是在 vim 中！）。现在，请注意`vim`具有相同的键绑定！

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2016-07-07T15:51:57.433

您可以使用该[`ex`](https://en.wikipedia.org/wiki/Ex_(text_editor))命令，一个标准的 Unix 编辑器（现在是 Vim 的一部分），例如

*   显示单行（例如第二行）：

    ```
    ex +2p -scq file.txt 
    ```

    对应的 sed 语法：`sed -n '2p' file.txt`

*   行数范围（例如 2-5 行）：

    ```
    ex +2,5p -scq file.txt 
    ```

    sed 语法：`sed -n '2,5p' file.txt`

*   从给定行到结尾（例如第 5 行到文件末尾）：

    ```
    ex +5,p -scq file.txt 
    ```

    sed 语法：`sed -n '2,$p' file.txt`

*   多行范围（例如 2-4 和 6-8 行）：

    ```
    ex +2,4p +6,8p -scq file.txt 
    ```

    sed 语法：`sed -n '2,4p;6,8p' file.txt`

Above commands can be tested with the following test file:

```
seq 1 20 > file.txt 
```

* * *

Explanation:

*   `+` or `-c` followed by the command - execute the (vi/vim) command after file has been read,
*   `-s` - silent mode, also uses current terminal as a default output,
*   `q` followed by `-c` is the command to quit editor (add `!` to do force quit, e.g. `-scq!`).

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2008-10-10T15:13:25.003

我首先将文件分成几个像这样的较小的文件

```
$ split --lines=50000 /path/to/large/file /path/to/output/file/prefix 
```

然后对生成的文件进行 grep。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2018-06-20T05:12:37.560

If your line number is 100 to read

```
head -100 filename | tail -1 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2018-03-13T00:05:23.193

Get [`ack`](https://beyondgrep.com/install/)

Ubuntu/Debian install:

```
$ sudo apt-get install ack-grep 
```

Then run:

```
$ ack --lines=$START-$END filename 
```

Example:

```
$ ack --lines=10-20 filename 
```

From `$ man ack`:

```
--lines=NUM
    Only print line NUM of each file. Multiple lines can be given with multiple --lines options or as a comma separated list (--lines=3,5,7). --lines=4-7 also works. 
    The lines are always output in ascending order, no matter the order given on the command line. 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2013-08-07T01:01:40.890

sed 也需要读取数据来计算行数。可以使用快捷方式的唯一方法是在文件中存在上下文/顺序以进行操作。例如，如果日志行前面带有固定宽度的时间/日期等，您可以使用**look** unix 实用程序对特定日期/时间的文件进行二进制搜索

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2015-07-30T11:58:08.647

采用

```
x=`cat -n <file> | grep <match> | awk '{print $1}'` 
```

在这里，您将获得匹配发生的行号。

现在您可以使用以下命令打印 100 行

```
awk -v var="$x" 'NR>=var && NR<=var+100{print}' <file> 
```

或者你也可以使用“sed”

```
sed -n "${x},${x+100}p" <file> 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-10T14:05:10.993

您将`sed -e '1,N d; M q'`打印 N+1 到 M 行。这可能会好一些，`grep -C`因为它不会尝试将行与模式匹配。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2015-02-03T15:34:55.693

基于 Sklivvz 的回答，这是一个可以放入`.bash_aliases`文件的不错的函数。从文件的前面打印内容时，它对大文件很有效。

```
function middle()
{
    startidx=$1
    len=$2
    endidx=$(($startidx+$len))
    filename=$3

    awk "FNR>=${startidx} && FNR<=${endidx} { print NR\" \"\$0 }; FNR>${endidx} { print \"END HERE\"; exit }" $filename
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-02-07T14:26:58.700

要显示 a 中的一行`<textfile>`，`<line#>`只需执行以下操作：

```
perl -wne 'print if $. == <line#>' <textfile> 
```

如果您想要一种更强大的方法来使用正则表达式显示一系列行——我不会说为什么 grep 这样做是一个坏主意，它应该是相当明显的——这个简单的表达式将显示你的范围处理 ~20GB 文本文件时需要的单通道：

```
perl -wne 'print if m/<regex1>/ .. m/<regex2>/' <filename> 
```

（提示：如果您的正则表达式`/`在其中，请改用类似的东西`m!<regex>!`）

`<filename>`这将从匹配的行开始打印，`<regex1>`直到（包括）匹配的行`<regex2>`。

无需向导即可了解一些调整如何使其更加强大。

最后一件事：perl，因为它是一门成熟的语言，有许多隐藏的增强功能以​​提高速度和性能。考虑到这一点，它使其成为此类操作的明显选择，因为它最初是为处理大型日志文件、文本、数据库等而开发的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-10-22T03:26:29.623

你可以试试这个命令：

```
egrep -n "*" <filename> | egrep "<line number>" 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-03-23T13:37:41.983

用 perl 很容易！如果您想从文件中获取第 1、3 和 5 行，例如 /etc/passwd：

```
perl -e 'while(<>){if(++$l~~[1,3,5]){print}}' < /etc/passwd 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-02-09T15:50:53.243

I am surprised only one other answer (by Ramana Reddy) suggested to add line numbers to the output. The following searches for the required line number and colours the output.

```
file=FILE
lineno=LINENO
wb="107"; bf="30;1"; rb="101"; yb="103"
cat -n ${file} | { GREP_COLORS="se=${wb};${bf}:cx=${wb};${bf}:ms=${rb};${bf}:sl=${yb};${bf}" grep --color -C 10 "^[[:space:]]\\+${lineno}[[:space:]]"; } 
```

# .net - 如何设置和恢复 FPU CTRL 寄存器？

> ID：191368
> 
> 赞同：5
> 
> 时间：2008-10-10T13:51:51.050
> 
> 标签：.net, delphi, fpu, ctrl

我可以用这个重置 FPU 的 CTRL 寄存器：

[http://support.microsoft.com/kb/326219](http://support.microsoft.com/kb/326219)

但是我怎样才能保存当前的寄存器，然后再恢复它们呢？

它来自.net代码..

我正在做的是从 Delphi 调用 .net dll 作为 COM 模块。检查`Ctrl`delphi 中的寄存器会产生一个值，使用 .net 代码中的 controlfp 检查会产生另一个值。我需要的，本质上是这样做：

```
_controlfp(_CW_DEFAULT, 0xfffff); 
```

所以我在.net代码中的浮点计算不会崩溃，但我想`Ctrl`在返回时恢复寄存器。

也许我没有？也许德尔福在需要时重置它们？[我在这里](http://blog.neslekkim.net/2008/10/fpu-issues-when-interoping-delphi-and.html)写了关于这个问题的博客。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T19:01:00.987

```
uses
   SysUtils;

var
   SavedCW: Word;
begin
   SavedCW := Get8087CW;
   try
     Set8087CW($027f);
     // Call .NET code here
   finally
     Set8087CW(SavedCW);
   end;
end; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T14:07:07.197

您用来更改它们的相同功能：`_controlfp()`. 如果您传入掩码 0，则当前值不会更改，但*会*返回 - 保存它，然后使用第二次调用`_controlfp()`来恢复它。

# design-patterns - 多态与继承（示例问题案例）

> ID：191376
> 
> 赞同：0
> 
> 时间：2008-10-10T13:53:03.030
> 
> 标签：design-patterns, inheritance, polymorphism, factory

我仍在尝试围绕设计模式进行思考，并且第二次遇到同样的问题，似乎急需一种模式解决方案。

我有一个具有多种帐户类型的帐户系统。我们有餐厅、酒店、service_provider 和消费者帐户类型。相信未来还会有更多的企业账户类型，当然还有全局管理员账户。

所以我想知道的是如何实现账户类型的切换。例如。每个帐户将有一个或多个配置文件，但配置文件将根据帐户类型而有所不同。我应该在这里使用什么样的类关系来处理多种类型的帐户 - 多态性或继承？

似乎应该有一个其他配置文件应该扩展的抽象基本配置文件类，但我不确定如何实现它（例如配置文件类型和帐户类型之间的连接表？）。

这也感觉像是一个实现工厂模式的机会，我只是不确定如何去做。

请问有什么想法吗？

```
*

* 
```

*编辑以提供一些建议的示例：*

```
Account -> hasMany   -> Users

Account -> belongsTo -> AccountType

Account -> hasOne    -> Profile 
```

配置文件因帐户类型而异，例如，餐厅类型的帐户将有菜单、酒单等，酒店类型的帐户将具有房间类型、设施，消费者类型的帐户将具有个人品味, 本国等

问题是哪种设计模式最能实现这些关系。

希望那更清楚，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T13:56:26.470

对于帐户和配置文件之间的关系，我建议在这里聚合而不是继承，但是有一个 Account 基类可以继承到多个帐户类型中。

账户包含一个配置文件对象，可以在每个多态账户类型的构造函数中设置。

您也可以将帐户创建包装在工厂或虚拟构造函数模式中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T19:02:35.900

谢谢你的例子；您可能正试图让这变得比现在更难。下面的工作吗？

```
User <<--> Account
Account <<--> AccountType
Account <--> Profile
Profile <<--> ProfileType 
```

我质疑帐户-个人资料 1:1 的关系，似乎一个帐户最终可能有多个个人资料，或者个人资料可能属于用户而不是帐户，但我真的不知道什么是个人资料在这种情况下是/做

# php - 如何进行正则表达式替换，在日期字符串中添加字符？

> ID：191383
> 
> 赞同：0
> 
> 时间：2008-10-10T13:55:15.850
> 
> 标签：php, regex

对于 PHP

我有一个我想要换行的日期。

我有 $date = '2008-09-28 9:19 pm'; 我需要将第一个空格替换为 br 成为

```
2008-09-28<br>9:19 pm 
```

如果不是在 PM 之前的第二个空格，我只会 str_replace() 它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-10T13:57:40.883

`s/ /<br\/>/`应该这样做。尽管 PHP 正则表达式可能很贪心并替换​​所有空格。

## 编辑

我支持 Ben Hoffstein 的 PHP 解决方案。在可能的情况下，请避免使用正则表达式，因为它几乎*总是*会产生意想不到的副作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T14:00:26.133

```
$date = '2008-09-28 9:19 pm';
$result = preg_replace('/(\d{4}-\d{2}-\d{2}) (.*)/', '$1<br>$2', $date); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T14:00:26.477

```
$date = preg_replace('/ /', '<br>', $date, 1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T14:04:01.167

如果您希望正则表达式匹配模式并返回两个部分，您可以使用以下内容。但是，考虑到您所做的只是替换 1 个空格，请尝试[`str_replace_once`](http://us.php.net/manual/en/function.str-replace.php#86177)我在正则表达式之后建议的方法。正则表达式用于复杂的解析，而不是像替换一个空格这样的浪费使用（无意冒犯）。

请注意，以下是浏览器代码，所以不要尝试逐字使用它。以防万一有错别字。

```
$regex = '/([\d]{4}-[\d]{2}-[\d]{2}) ([\d]{1,2}:[\d]{2} (am|pm))/';
$match = preg_match($regex, '2008-09-28 9:19 pm');
print $match[1];  // Returns 2008-09-28
print $match[2];  // Returns 9:19 pm

// Or replace:
preg_replace($regex, '$1<br>$2', $date); 
```

我建议以下更快的机制。有关功能，请参阅[此帖子](http://us.php.net/manual/en/function.str-replace.php#86177)[`str_replace_once()`](http://us.php.net/manual/en/function.str-replace.php#86177)。

```
str_replace_once(' ', '<br>', $date); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T14:10:26.753

另一种更快但代码更多的方法是

```
$date = substr($date, 0, 10) . '<br>' . substr($date, 11); 
```

# java - 您如何对项目进行版本控制和管理发布？

> ID：191387
> 
> 赞同：7
> 
> 时间：2008-10-10T13:56:29.310
> 
> 标签：java, language-agnostic, maven-2, versioning

我们的情况如下，但我对这个问题在任何情况下都很好奇。

我们有一个由 4 个项目组成的框架：

*   豆子
*   实用程序
*   框架
*   网络

我们也有需要版本的模块，并且依赖于 bean 和 util 的版本。

最后，我们有一个客户项目，它由特定版本的核心项目和一个或多个模块组成。

是否有标准方法来对这些项目进行版本控制？

对我来说似乎很简单的事情变得非常复杂，因为我们尝试将发布交付给 QA，然后通过维护发布（发布 = 标签和可能的分支）来管理我们正在进行的开发。

我更喜欢以下内容：

1.2.0 - 主要和次要版本 + 发布。

1.2.1 - 下一个版本

1.2.0_01 - 1.2.0 版本（分支）中的错误修复

等等

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-10T17:09:58.717

我们使用major.minor.bugfix。一个主要版本只发生在巨大的变化上。当 API 发生更改时，将调用次要版本。所有其他版本都是错误修复版本。那里有一个内部版本号或修订号对于故障排除肯定是有用的，尽管如果你有非常严格的 CM，你可能不需要包含它。

在 Apache Ivy 或 Maven 等工具的帮助下，可以很好地协调所有这些项目的版本。一个项目的构建，具有自己的版本号，可能涉及到其他项目（产品）的特定版本的聚合，因此您的构建文件提供了自下而上的严格版本映射。将其全部保存在 [在此处插入最喜欢的版本控制工具] 中，您将拥有一段美好的历史记录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T14:36:47.043

我使用 {major}.{minor}.{buildday}.{sequential}。对于 Windows，我们将实用程序[stampver.exe](http://blog.dixo.net/downloads/stampver-win32-version-resource-stamping/)和[UpdateVersion.exe](http://code.mattgriffith.net/UpdateVersion/)用于大部分自动处理的 .NET 项目。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T14:05:10.650

没有标准的版本号系统。常见的主题是有一个主要、次要和内部版本号，偶尔还有一个点号（例如，1.2.2.1，对于版本 1.2 点版本 2 版本 1）。版本号的含义非常灵活。一个常见的选择是在次要版本或点版本之间具有向后兼容性。

只要您的源代码控制允许，最好通过标记一组源代码控制文件来完成发布。重新创建一个版本就像同步到标签和构建一样简单，这非常有用:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T14:11:39.623

在自动化构建系统中，我目前使用的是带有 Major.Minor.Build.X 的 I 版本，其中 Build 是每次我们进行系统测试时，X 是来自 repo 的最后一个 Subversion 修订号。似乎对 Subversion 工作得很好，因为如果需要，我们可以很容易地回到特定构建的代码库。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-10T17:50:17.433

我在 linux 内核版本编号系统上使用了一个变体：

major.minor.bugfix

其中偶数次要数字表示可以分发至少用于测试的稍微稳定的版本，而奇数次要数字表示不应该分发给开发人员之外的不稳定/未经测试的版本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T14:15:11.097

在可能的情况下，我更喜欢使用相同的构建编号对项目进行版本控制，除非它们是共享的。它允许移动部件之间的一致性更高，并且更容易识别哪些组件构成产品发布。

正如 workmad3 所说，内部版本号确实没有通用规则。我的建议是使用对您的团队/公司有意义的东西。

我工作过的一些地方将构建编号与项目里程碑和迭代保持一致，
例如：Major = Release 或 Milestone，Minor = Iteration，Build = Build number（从项目开始或从迭代开始），Revision = 如果build 必须重建（或分支）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-16T03:21:51.473

最常见的约定之一是major.minor.bugfix，附加后缀表示内部版本号或预发布名称（例如alpha、beta 等）。

我的团队编号根据项目里程碑构建 - 在开发迭代结束时（每几周）将构建移交给我们的 QA 组。临时 CI 构建没有编号；因为我们使用 Maven，所以这些构建以 SNAPSHOT 后缀编号。

无论您做出什么决定，请务必记录下来并确保每个人都理解它。我还建议您记录并一致地应用发布分支策略，否则它很快就会让每个人都感到困惑。虽然只有 4 个项目，但应该很容易跟踪正在发生的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T17:39:01.530

您没有提到是否有任何项目访问数据库，但如果有的话，这可能是另一个需要考虑的因素。我们使用了一个major.minor.bugfix.buildnumber 方案，类似于此问题的答案中描述的其他方案，具有大致相同的逻辑，但增加了任何数据库模式更改至少需要小幅增量的要求。这也为您的数据库模式提供了一个命名方案。例如，1.2.3 和 1.2.4 版本都可以针对“1.2”数据库架构运行，但 1.3.0 版本需要“1.3”数据库架构。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-10T17:47:12.247

目前我们没有真正的版本控制。我们使用 svn 内部版本号和发布日期。（标签名称类似于 release_081010_microsoft 例如）

旧产品使用 major.minor.sub 版本编号

主要从未改变 每 6 个月对每个版本/功能发布进行次要更改。Sub 是不影响功能集的所有内容 - 主要是错误修复。

# java - 如何清除大型项目中的依赖项？

> ID：191390
> 
> 赞同：0
> 
> 时间：2008-10-10T13:56:48.107
> 
> 标签：java, dependencies, project

我即将继承一个具有大量第三方依赖项的相当大的 Java 企业项目。至少包含 70 个 JAR，其中一些似乎未使用，例如我知道未使用的 spring.jar。

多年来，随着各种开发人员接触到代码库，他们似乎都尝试了新的每月项目类型库。

**如何摆脱这些？**当然，在合理范围内，显然某些依赖项有助于不必重新发明轮子。

我显然对基于 Java 的项目很感兴趣，但我欢迎跨语言回答人们认为会有帮助的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T14:04:48.857

就个人而言，我认为您必须从评估问题的规模开始。这将是相当痛苦的，但我会列出一个依赖项列表，并准确计算出项目的哪些部分使用哪些依赖项。

然后我会准确计算出您实际使用的每个功能的哪些功能（在许多情况下，您最终会拥有一个庞大的第三方库，而您只使用了其中的一小部分）。

一旦你有了这些信息，你至少会知道你在处理什么。

我的下一步是查看您仅在很小范围内使用的所有依赖项。检查可能会发现您可以从其他库中使用的东西，这些库将消除较少使用的库。

我还会四处看看，看看是否有什么小东西可以重写并包含在自己的代码库中。

最后，我会看看您的依赖项的供应商和他们的竞争对手，看看最新版本是否包含更多功能，可以让您消除一些其他的。

然后你就想知道是高度依赖少数供应商更好，还是更少依赖很多供应商！;o)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T15:47:30.957

structure101 [http://www.headwaysoftware.com/products/structure101/index.php](http://www.headwaysoftware.com/products/structure101/index.php) 这是显示依赖关系的好工具。我已经用了几年了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T14:44:22.020

如果您有一套很好的自动化测试，并且您希望删除根本不使用的库，您可以使用试错法。一次一个，删除一个库，然后运行您的测试，看看一切是否仍然有效。如果没有，请将其放回原处。当然，如果您甚至无法在没有库的情况下进行构建，那么您可能需要它。

基本上，不管你怎么做，我的想法是一次删除一个，看看有什么问题。如果没有任何问题，很有可能你可以扔掉图书馆。如果问题非常小（例如，您需要大型库中某个类的一种方法），您也许可以围绕它编写代码。

如果您正在处理一个独立的应用程序，您可以为 JVM 提供 -verbose:class 选项以查看正在加载哪些类。这应该给你这样的消息：

```
[Opened C:\Program Files\Java\jre1.6.0_04\lib\rt.jar]
[Loaded java.util.regex.Pattern$Single from C:\Program Files\Java\jre1.6.0_04\lib\rt.jar] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T14:53:31.207

[我在这里](http://weblogs.java.net/blog/emcmanus/archive/2008/02/do_i_really_nee.html)读到了一种使用仪器的方法，从未尝试过，但听起来很合理。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T14:56:21.123

我们在 delphi 代码库上进行了这样的练习。我们极大地简化了我们的外部依赖。基本上，我们是这样处理的：

*   对所有外部库和组件进行了编目
*   编目（使用文件搜索工具）它们的使用地点和用途。
*   删除了我们不使用或不需要的所有内容（一些库在不再需要的代码中使用）。
*   根据该库是否积极开发、我们使用了多少功能、将使用它的代码移植到我们已经使用的另一个库的难度等等，对我们喜欢哪些库进行了排名。
*   最后，我们通过将该功能移植到另一个库来迭代地删除对列表低位库的依赖。

然而，这是相当多的工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T16:07:54.800

如果您采用“删除东西直到它无法编译”的方法，您需要非常小心传递运行时依赖项。如果有一个高质量的测试套件，它会有所帮助，但你肯定需要运行像 Cobertura 这样的测试覆盖工具，以确保有足够的代码得到测试，以运行你的完整依赖图。

你在说多少代码？坦率地说，Joeri 建议的基于审查的方法对我来说似乎是最好的。它还有一个额外的好处，就是让您至少对系统的所有部分都熟悉。如果您只是继承一个大项目，那么无论如何您都应该花时间去做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T16:45:19.280

if you have a full regression test suite for this project, all you have to do is run the regression suite while running with 1 less JAR each time in a loop. it is NOT fast BUT it is easy to do.

# sql-server - 为 SQL Server OLTP 数据库推荐的 tempdb 和日志位置

> ID：191396
> 
> 赞同：1
> 
> 时间：2008-10-10T13:58:07.513
> 
> 标签：sql-server, performance, optimization, configuration

假设以下配置：驱动器 D ... 数据，驱动器 E .... TempDB，驱动器 F ... 日志。并假设所有驱动器都位于具有各自驱动器控制器的单独主轴上。

关于性能；上述配置是最优的、体面的还是不可取的？

考虑到预算限制，这些数据库中的任何一个都可以在不显着降低性能的情况下共享保存驱动器吗？

这些驱动器中的哪一个需要最快？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T14:23:56.400

如果不对您的系统进行全面分析，这很难回答。例如，要正确执行此操作，我们应该知道您的系统将生成什么样的 IOPS，以便规划比峰值负载略多的容量。

我一直很喜欢 RAID10，所有东西都使用单独的阵列，并且在许多情况下，根据性能需求将其拆分为不同的文件组。

但是，在预算有限的环境中，对于想要接近理想的人来说，这是一个不错的基本配置：

4个独立的数组：

*   系统数据库：RAID 5（也不是操作系统阵列！）
*   数据：RAID 5
*   日志：RAID 10
*   Tempdb：RAID 1 或 10，后者用于高 IOPS 场景
*   （可选）- RAID 5 将备份转储到（从此处复制到磁带）

这种设置提供了不错的性能和更高的可恢复性机会。例如，在这种情况下，如果您的 Data 阵列发生故障，您仍然可以运行服务器和 BACKUP LOG 对故障数据库进行时间点恢复，因为您仍然可以在面对数据时访问系统数据库和事务日志阵列故障。

# c# - 如何使用 c# 更改文件夹中每个文件的只读文件属性？

> ID：191399
> 
> 赞同：9
> 
> 时间：2008-10-10T13:58:38.243
> 
> 标签：c#

如何使用 c# 更改文件夹中每个文件的只读文件属性？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-10T14:03:58.843

```
foreach (string fileName in System.IO.Directory.GetFiles(path))
{
    System.IO.FileInfo fileInfo = new System.IO.FileInfo(fileName);

    fileInfo.Attributes |= System.IO.FileAttributes.ReadOnly;
    // or
    fileInfo.IsReadOnly = true;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-10T14:07:26.667

你可以试试这个：迭代每个文件和子目录：

```
public void Recurse(DirectoryInfo directory)
{
    foreach (FileInfo fi in directory.GetFiles())
    {
        fi.IsReadOnly = false; // or true
    }

    foreach (DirectoryInfo subdir in directory.GetDirectories())
    {
        Recurse(subdir);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T14:04:36.343

在遍历[Directory.GetFiles](http://msdn.microsoft.com/en-us/library/07wt70x2.aspx)的循环中使用[File.SetAttributes](http://msdn.microsoft.com/en-us/library/system.io.file.setattributes.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-16T10:23:14.100

如果您想使用模式匹配删除只读属性（例如，文件夹中所有带有 .txt 扩展名的文件），您可以尝试如下操作：

```
Directory.EnumerateFiles(path, "*.txt").ToList().ForEach(file => new FileInfo(file).Attributes = FileAttributes.Normal); 
```

# excel - 如何通过单击保护 Excel 工作簿中的所有工作表？

> ID：191400
> 
> 赞同：7
> 
> 时间：2008-10-10T13:58:39.447
> 
> 标签：excel, vba

我的工作簿（Excel 电子表格）中有大约 25 个工作表。有没有一种方法可以保护所有 25 个工作表？或者此功能不可用，我将不得不编写 VBA 代码来完成此操作。我经常需要保护所有工作表并取消保护所有工作表，并且单独进行非常耗时

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-10T14:02:41.887

我不相信不使用 VBA 有办法做到这一点。如果您对 VBA 解决方案感兴趣，这里是代码：

```
Dim ws as Worksheet
Dim pwd as String

pwd = "" ' Put your password here
For Each ws In Worksheets
    ws.Protect Password:=pwd
Next ws 
```

取消保护几乎是一样的：

```
Dim ws as Worksheet
Dim pwd as String

pwd = "" ' Put your password here
For Each ws In Worksheets
    ws.Unprotect Password:=pwd
Next ws 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T14:05:07.013

不要认为有一个按钮可以做到这一点，但它的代码足够简单：

对于工作表中的每个 protSheet protSheet.Protect Password := "boo" Next protSheet

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-12-10T16:50:41.353

您可以保护所有工作表免受用户更改，但仍允许 VBA 脚本使用“UserInterfaceOnly”选项进行更改。此解决方法允许您在工作表上运行任何 VBA 脚本，而无需每次都进行保护和取消保护：

```
Dim ws as Worksheet
Dim pwd as String

pwd = "" ' Put your password here
or Each ws In Worksheets
   ws.Protect Password:=pwd, UserInterfaceOnly:=True
Next ws 
```

取消保护与 Ben Hoffstein 提供的解决方案相同：

```
Dim ws as Worksheet
Dim pwd as String

pwd = "" ' Put your password here
For Each ws In Worksheets
    ws.Unprotect Password:=pwd
Next ws 
```

您可以使用按钮/快捷方式访问此宏。在 Excel 2010 中，右键单击快速访问工具栏并选择“自定义快速访问工具栏”。在下拉菜单中选择命令，选择“宏”。然后单击您创建的 VBA 脚本以保护（或取消保护）。最后单击“添加>>”按钮，然后单击“确定”保存。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-30T12:24:20.467

您可以保护工作簿而不是每张工作表，这将阻止对整个工作簿进行更改

# c# - C# 中的单一继承 - 对象类？

> ID：191404
> 
> 赞同：8
> 
> 时间：2008-10-10T13:59:21.440
> 
> 标签：c#

我已经问自己这个问题很长时间了。想发一下。C# 不支持多重继承（这是事实）。在 C# 中创建的所有类都派生自“对象”类（又是一个事实）。

因此，如果 C# 不支持多重继承，那么即使它已经扩展了 Object 类，我们又如何能够扩展一个类呢？

举例说明：

1.  A 类：对象 - 创建的 A 类。
2.  B 类：对象 - 创建的 B 类。
3.  A 类：B - 再次支持。早期与对象的关联会发生什么。

在第 3 步之后，我们可以在 A 中使用对象类方法。转向多级继承也是如此。如果是这样的话，那么

1.  A类：B
2.  C类：B
3.  A 类：C - 我必须能够在 A 中访问 B 类的方法。不是这样吗？

谁能解释一下？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T14:03:05.897

您将多重继承与继承树混淆了。您可以从 Object 以外的其他东西继承。只是 Object 就在你树的顶端。并且有人可以继承你的类，但是因为 Object 仍然在顶部，所以该类也将从 object 继承。您的“多级”继承不是多重继承。

多重继承是当您从两个不同的树继承时，.Net 实际上确实通过接口支持这一点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-10T14:17:38.347

乔尔的回答是正确的。多重继承和继承树（或派生链）之间存在差异。在您的示例中，您实际上显示了一个继承树：一个对象从树中更高的另一个对象继承（派生）。多重继承允许一个对象从多个基类继承。

以下面的树为例：

```
public class BaseClass { }

public class SpecialBaseClass : BaseClass {}

public class SpecialtyDerivedClass : SpecialBaseClass {} 
```

这是完全有效的，并且说 SpecialtyDerivedClass 继承自 SpecialBaseClass（SpecialtyDerivedClass 的父级），而后者又派生自 BaseClass（SpecialtyDerivedClass 的祖父级）。

在多重继承的思想下，示例如下所示：

```
public class BaseClass { }

public class SpecialBaseClass {}

public class SpecialtyDerivedClass : BaseClass, SpecialBaseClass {} 
```

这在 .NET 中是不允许的，但它表示 SpecialityDerivedClass 继承自 BaseClass 和 SpecialBaseClass（它们都是父类）。

.NET 通过允许您从多个接口继承，确实允许一种形式的多重继承。稍微改变上面的例子：

```
public class BaseClass { }

public interface ISpecialBase {}

public interface ISpecialDerived {}

public class SpecialtyDerivedClass : BaseClass, ISpecialBase, ISpecialDerived {} 
```

这表示 SpecialtyDerivedClass 继承自 BaseClass（它是父级）以及 ISpecialBase 和 ISpecialDerived（也是父级，但更像继父级，因为接口无法指定功能）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-10T14:08:30.127

所有类*最终*都派生自 Object。

```
public class A 
```

隐式等价于

```
public class A : System.Object 
```

当您从另一个类派生时

```
public class A : B 
```

在哪里

```
public class B : System.Object 
```

B 成为父类，Object 成为祖父类。

等等。

所以它是所有其他类的父母、祖父母、曾祖父母（等）类。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T14:30:00.520

One way to look at it is this: C# has an inheritance *tree*, while C++ (or other muliple-inheritance languages) has an inheritance *lattice*.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T14:06:34.453

下面给出。

```
public class A : B
{

}

public class B : C
{
    public int BProperty { get; set; }
}

public class C
{
    public int CProperty { get; set; }
}

public class Test
{
    public void TestStuff()
    {
        A a = new A();

        // These are valid.
        a.CProperty = 1;
        a.BProperty = 2;
    }

} 
```

这是有效的。在这种情况下，对象是 C 的基础。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T14:09:39.407

在示例中，B 可以扩展 A 的原因是因为 A 扩展了 Object。一个类只能指定一个父类，但该类必须是对象或将对象作为其祖先之一。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T14:15:43.670

**如果您不指定基类**，则类继承自对象。因此：

```
class C {} 
```

是相同的

```
class C : Object {} 
```

但是，**如果您指定一个基类，它将从该类而不是 Object 继承**。因此，

```
class B : C {} 
```

B 直接继承自 C 而不是 Object。另一个例子，

```
class A : B {} 
```

在这种情况下，A 继承自 B 而不是 Object。总而言之，在这个层次结构中：

```
class C {}
class B : C {}
class A : B {} 
```

A类派生自B，B派生自C。因此A类间接派生自C，因为B派生自C。C也派生自未明确指定但默认情况下存在的Object。所以 A 也是间接派生自 Object 的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T14:22:36.933

C# 中的类只能有一个父类，但它可以有多个祖先。您可以实现多个接口，但这仅意味着您的类同意实现这些接口定义的签名。您实际上并没有从这些接口继承任何功能。

# windows - 在 Ruby 中使用 Windows 窗体

> ID：191409
> 
> 赞同：5
> 
> 时间：2008-10-10T14:00:27.647
> 
> 标签：windows, ruby, user-interface, dialog

是否可以使用 Ruby 在 Windows 上创建表单？我有一个 Ruby 脚本，我想要一个输入表单来询问用户的密码，然后在我的脚本的其余部分使用它。

更新：我已经用 wxRuby 成功地做到了这一点，虽然它看起来很丑。鞋子看起来很有希望，如果我需要再做一次，我可能会考虑一下。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T14:02:26.223

我记得前段时间为此使用[过 wxRuby 。](http://wxruby.rubyforge.org/wiki/wiki.pl)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-11T19:29:15.080

如果你只想要简单、轻巧和有趣的编程，我绝对推荐[Shoes](http://shoooes.net/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-12T19:37:39.917

如果你想要一些*非常*简单的东西，看看[**wxCocoaDialog**](http://code.google.com/p/wxcocoadialog/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-30T18:35:35.907

你也可以使用 IronRuby：

场景 1：直接 WinForms：

*   见[马克麦克法登的帖子](http://www.msquaredweb.com/musings/2007/07/test-drive-with-ironruby-and.html)
*   查看 Jimmy Schementi 的 GitHub[演示应用程序](http://github.com/jschementi/railsconf09/blob/469ec652826cf14844b28cc30921b76c57261e56/8-ardb/app.rb)

场景二：使用 WPF

*   请参阅 Ivan Porto Carrero 的[IronNails](http://flanders.co.nz/category/wpf/)框架
*   请参阅 DevX[文章](http://www.devx.com/dotnet/Article/36895/1954)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T14:04:03.303

[IronRuby](http://www.ironruby.net/)在 .NET 运行时上运行，因此可以访问所有 .NET winforms API。它正在开发中，因此它可能会也可能不会满足您的需求。

# javascript - 为什么我的微调器 GIF 在运行 jQuery ajax 调用时停止？

> ID：191413
> 
> 赞同：49
> 
> 时间：2008-10-10T14:01:21.390
> 
> 标签：javascript, jquery

我刚刚开始摆脱 ASP.NET UpdatePanels。我正在使用 jQuery 和 jTemplates 将 Web 服务的结果绑定到网格，并且一切正常。

事情是这样的：我试图在刷新表格时显示一个微调器 GIF（在 ASP.NET 中的更新进度）我已经完成了所有工作，除了微调器被冻结。为了查看发生了什么，我尝试将微调器从更新进度 div 中移出，并移到我可以一直看到的页面上。它不停地旋转直到刷新开始，并保持冻结状态直到刷新完成，然后再次开始旋转。“请稍候”微调器并不是您真正想要的！

这是在 IE7 中 - 还没有机会在其他浏览器中进行测试。有什么想法吗？ajax 调用或客户端数据绑定是否会占用大量资源，以至于浏览器无法处理其动画 GIF？

### 更新

这是刷新网格的代码。不确定这是同步的还是异步的。

```
updateConcessions = function(e) {
    $.ajax({
        type: "POST",
        url: "Concessions.aspx/GetConcessions",
        data: "{'Countries':'ga'}",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function(msg) {
            applyTemplate(msg);
        },
        error: function(XMLHttpRequest, textStatus, errorThrown) {
        }
    });
}

applyTemplate = function(msg) {
    $('div#TemplateTarget').setTemplate($('div#TemplateSource').html());
    $('div#TemplateTarget').processTemplate(msg);
} 
```

### 更新 2

我刚刚检查了[jQuery 文档](http://docs.jquery.com/Ajax/jQuery.ajax#options)，默认情况下该`$.ajax()`方法是异步的。只是为了踢我添加了这个

```
$.ajax({
    async: true,
    ... 
```

它没有任何区别。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-10T15:30:58.637

冻结浏览器的不是 Ajax 调用。它是成功处理程序（applyTemplate）。将 HTML 插入这样的文档会冻结 IE，具体取决于 HTML 的数量。这是因为 IE UI 是单线程的；如果您注意到，实际的 IE 菜单在发生这种情况时也会被冻结。

作为测试，请尝试：

```
applyTemplate = function(msg) {
   return;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-10T14:45:52.627

我不记得究竟是什么原因造成的，但我们在繁忙的盒子中遇到了类似的 IE6 问题，我们用 Javascript 中的这个令人难以置信的 hack 修复了它：

```
setTimeout("document.images['BusyImage'].src=document.images['BusyImage'].src",10); 
```

这只是将图像源设置为以前的样子，但显然足以让 IE 摆脱昏迷状态。

编辑：我想我记得是什么原因造成的：我们正在将动画加载到一个带有 display: none 的 div 中。IE 加载它并且不启动动画，因为它是隐藏的。不幸的是，当您将包含块设置为 display: 块时，它不会启动动画，因此我们使用上面的代码行来欺骗 IE 重新加载图像。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-30T18:04:51.570

图像冻结，因为当它被隐藏时，IE 禁用了动画。

要解决此问题，请附加加载图像而不是取消隐藏它：

```
function showLoader(callback){
    $('#wherever').append(
        '<img class="waiting" src="/path/to/gif.gif" />'
    );

    callback();
}

function finishForm(){
    var passed = formValidate(document.forms.clientSupportReq);

    if(passed)
    {
        $('input#subm')
            .val('Uploading...')
            .attr('disabled','disabled');
        $('input#res').hide();
    }

    return passed;
}
$(function(){
    // on submit
    $('form#formid').submit(function(){
        var l = showLoader( function(){
                         finishForm() 
                    });

        if(!l){
            $('.waiting').remove();
        }

        return l;
    });
}); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-10T15:06:09.950

您确定在 AJAX 调用期间 GIF 没有旋转吗？

在您的让步.aspx 中将此行放在处理 GetConcessions 的某个位置：-

```
System.Threading.Thread.Sleep(5000); 
```

我怀疑 gif 会旋转 5 秒，然后在 IE 渲染和绘制结果时冻结。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-17T23:17:10.423

我知道问题是关于异步 ajax 调用。但是我想补充一点，我在关于同步 ajax 调用的测试中发现了以下内容：

用于同步 ajax 调用。在呼叫进行时（即等待服务器响应）。对于测试，我在服务器上延迟了服务器响应。

Firefox 17.0.1 - 动画 gif 继续正确动画。

Chrome v23 - 动画 gif 在请求进行时停止动画。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-02-07T12:02:01.857

嗯，这是有很多原因的。首先，当服务器的ajax回调时，你会感觉到你的gif冻结了几毫秒，但相关的并不多。在您开始处理信息之后，根据您操作的对象和操作方式，您将有更多或更少的时间冻结您的 gif。这是因为线程正忙于处理信息。例如，如果您有 1000 个对象并且您执行订单和移动信息，并且您使用 jquery 和 append、insert、$.each 命令，您会感觉到 gif 冻结。有时不可能避免所有冻结的 gif，但你可以将时间限制在几毫秒这样做：制作响应 ajax 列表，并每 2 秒处理一次（这样您将在一个单独的数组中获得结果，并且您将使用一个 setInterval 调用它，并且当之前的响应仍在处理时，您可以避免尝试处理一个响应的瓶颈）。如果您使用 JQuery，请不要使用 $.each，请使用 for。不要使用 dom 操作（追加、插入等），使用 html()。在简历中做更少的代码，重构和处理所有响应（如果你做了更多的1），就像只有1一样。对不起我的英语。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-06-28T18:58:46.433

我在浏览器冻结时遇到了类似的问题。如果您在本地开发和测试，由于某种原因它会冻结 Web 浏览器。将我的代码上传到 Web 服务器后，它开始工作。我希望这会有所帮助，因为我花了好几个小时才自己弄清楚。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T14:04:45.533

你是同步调用还是异步调用？同步调用确实会导致浏览器在调用期间看似锁定。另一种可能性是系统正忙于做它正在做的任何工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-10T14:07:26.073

我过去在进行 AJAX 调用时看到过这种行为。我相信这与浏览器只是单线程的事实有关，因此当返回 AJAX 调用时，线程正在处理调用，因此动画 GIF 需要暂时停止。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-08-08T09:59:38.383

dennismonsewicz 的回答很好。使用 spin.js，网站[http://fgnass.github.com/spin.js/](http://fgnass.github.com/spin.js/)显示了非常简单的步骤。在繁重的过程中，我们应该使用 CSS 动画。由于单线程限制，不应使用 JS 驱动的动画和 GIF，否则动画将冻结。CSS 动画与 UI 线程分离。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-10-15T07:09:56.877

**在setTimeout**函数中包装 ajax 调用帮助我防止了 gif 动画的冻结：

```
setTimeout(function() {
    $.get('/some_link', function (response) {
        // some actions
    });
}, 0); 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2015-06-18T13:45:30.710

浏览器是单线程和多线程的。

对于任何浏览器：当您调用包含嵌套 ajax 函数的函数时

java/servlet/jsp/Controller > 保持 Thread.sleep(5000); 在 servlet 中了解 ajax 中的异步是真还是假。

```
 function ajaxFn(){
    $('#status').html('WAIT... <img id="theImg" src="page-loader.gif" alt="preload" width="30" height="30"/>');
    $('#status').css("color","red");
    $.ajax({
        url:"MyServlet",
        method: "POST",
        data: { name: $("textarea").val(),
                id : $("input[type=text]").val() },
        //async: false,
        success:function(response){
            //alert(response);  //response is "welcome to.."
            $("#status").text(response);
            $('#status').css("color","green");
        },
        complete:function(x,y){
            //alert(y)
        },
        error:function(){
            $("#status").text("?");
        }
    });
} 
```

# sql - 如何在 NULL 列上创建唯一索引？

> ID：191421
> 
> 赞同：104
> 
> 时间：2008-10-10T14:03:34.287
> 
> 标签：sql, sql-server, indexing, constraints, unique

我正在使用 SQL Server 2005。我想将列中的值限制为唯一，同时允许 NULL。

我当前的解决方案涉及一个视图上的唯一索引，如下所示：

```
CREATE VIEW vw_unq WITH SCHEMABINDING AS
    SELECT Column1
      FROM MyTable
     WHERE Column1 IS NOT NULL

CREATE UNIQUE CLUSTERED INDEX unq_idx ON vw_unq (Column1) 
```

有更好的想法吗？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2010-07-07T02:50:14.447

使用 SQL Server 2008，您可以创建过滤索引：http: [//msdn.microsoft.com/en-us/library/cc280372.aspx](http://msdn.microsoft.com/en-us/library/cc280372.aspx)。（我看到西蒙将此作为评论添加，但认为它应该得到自己的答案，因为评论很容易被遗漏。）

另一个选项是检查唯一性的触发器，但这可能会影响性能。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2008-10-10T14:56:44.757

计算列技巧被广泛称为“nullbuster”；我的笔记归功于史蒂夫·卡斯：

```
CREATE TABLE dupNulls (
pk int identity(1,1) primary key,
X  int NULL,
nullbuster as (case when X is null then pk else 0 end),
CONSTRAINT dupNulls_uqX UNIQUE (X,nullbuster)
) 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-10-10T14:17:17.193

很确定你不能这样做，因为它违反了唯一性的目的。

然而，这个人似乎有一个体面的工作： [http ://sqlservercodebook.blogspot.com/2008/04/multiple-null-values-in-unique-index-in.html](http://sqlservercodebook.blogspot.com/2008/04/multiple-null-values-in-unique-index-in.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-22T17:43:20.710

可以使用**过滤谓词**来指定要包含在索引中的行。

从[文档](https://docs.microsoft.com/en-us/sql/t-sql/statements/create-index-transact-sql?view=sql-server-ver15)中：

> WHERE <filter_predicate> 通过指定要包含在索引中的行来创建过滤索引。过滤索引必须是表上的非聚集索引。为过滤索引中的数据行创建过滤统计信息。

例子：

```
CREATE TABLE Table1 (
  NullableCol int NULL
)

CREATE UNIQUE INDEX IX_Table1 ON Table1 (NullableCol) WHERE NullableCol IS NOT NULL; 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2015-02-24T05:33:08.527

严格来说，一个唯一的可空列（或一组列）只能为 NULL（或 NULL 的记录）一次，因为多次具有相同的值（包括 NULL）显然违反了唯一约束。

但是，这并不意味着“唯一可为空的列”的概念是有效的；要在任何关系数据库中实际实现它，我们只需要记住，这种数据库旨在规范化以正常工作，规范化通常涉及添加几个（非实体）额外表来建立实体之间的关系.

让我们做一个只考虑一个“唯一可为空的列”的基本示例，很容易将其扩展到更多这样的列。

假设我们用这样的表格表示的信息：

```
create table the_entity_incorrect
(
  id integer,
  uniqnull integer null, /* we want this to be "unique and nullable" */
  primary key (id)
); 
```

我们可以通过将 uniqnull 分开并添加第二个表来建立 uniqnull 值和 the_entity 之间的关系（而不是让 uniqnull “内部” the_entity）来做到这一点：

```
create table the_entity
(
  id integer,
  primary key(id)
);

create table the_relation
(
  the_entity_id integer not null,
  uniqnull integer not null,

  unique(the_entity_id),
  unique(uniqnull),
  /* primary key can be both or either of the_entity_id or uniqnull */
  primary key (the_entity_id, uniqnull), 
  foreign key (the_entity_id) references the_entity(id)
); 
```

要将 uniqnull 的值关联到 the_entity 中的一行，我们还需要在 the_relation 中添加一行。

对于 the_entity 中的行没有关联 uniqnull 值（即，对于那些我们将在 the_entity_incorrect 中放入 NULL 的行），我们只是不在 the_relation 中添加一行。

请注意，uniqnull 的值对于所有 the_relation 都是唯一的，并且还请注意，对于 the_entity 中的每个值，the_relation 中最多可以有一个值，因为其上的主键和外键强制执行此操作。

然后，如果 uniqnull 的值 5 与 3 的 the_entity id 相关联，我们需要：

```
start transaction;
insert into the_entity (id) values (3); 
insert into the_relation (the_entity_id, uniqnull) values (3, 5);
commit; 
```

而且，如果 the_entity 的 id 值为 10 没有 uniqnull 对应项，我们只做：

```
start transaction;
insert into the_entity (id) values (10); 
commit; 
```

为了非规范化这些信息并获得像 the_entity_incorrect 这样的表可以保存的数据，我们需要：

```
select
  id, uniqnull
from
  the_entity left outer join the_relation
on
  the_entity.id = the_relation.the_entity_id
; 
```

“左外连接”运算符确保 the_entity 中的所有行都出现在结果中，当 the_relation 中不存在匹配列时，将 NULL 放在 uniqnull 列中。

请记住，花几天（或几周或几个月）设计一个良好规范化的数据库（以及相应的非规范化视图和过程）的任何努力都将为您节省数年（或数十年）的痛苦和浪费的资源。

# postgresql - 在 PostgreSQL 中更改系统语言和错误消息

> ID：191428
> 
> 赞同：48
> 
> 时间：2008-10-10T14:04:04.130
> 
> 标签：postgresql

是否可以从 PostgreSQL 更改系统消息的语言？

例如，在 MSSQL 中，这可以通过 SQL 语句[SET LANGUAGE](http://msdn.microsoft.com/en-us/library/ms174398.aspx)来实现。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-10-10T15:46:49.260

```
SET lc_messages TO 'en_US.UTF-8'; 
```

有关要求和限制的更多信息，请[点击此处](http://www.postgresql.org/docs/current/static/runtime-config-client.html#GUC-LC-MESSAGES)。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2016-05-03T08:01:05.993

米伦的回答对我不起作用。

我通过修改文件让它工作`postgresql.conf`。如果您使用的是 Linux，请编写：

```
sudo find / -iname postgresql.conf 
```

我有我的`/var/lib/pgsql/data`。然后编辑文件并搜索变量`lc_messages`并将其更改为您的首选语言，例如`'en_US.UTF-8'`.

如果 PostgreSQL 停止工作并且您在其日志中检查您有如下错误：

```
invalid value for parameter "lc_messages": "en_US.UTF-8" 
```

您必须使用错误消息中的编码（例如）来编辑`/etc/locale.gen`和取消注释行。`en_US.UTF-8`然后您必须运行`locale-gen`（以 root 身份）来更新语言环境。最后，要检查是否设置了语言环境，您可以运行`locale -a`.

或者，如果您希望语言为英语，则只需设置`lc_messages = 'C'`.

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2019-06-28T18:25:58.780

对我来说，Milen A. Radev 和 user1 的回答都不起作用——编辑`PostgreSQL\11\data\postgresql.conf`完全没有效果。即使在设置`lc_messages = 'random value'`PostgreSQL 之后仍然会启动。

有帮助的是删除`PostgreSQL\11\share\locale\*\LC_MESSAGES`，之后我终于收到了英文消息。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-12-11T15:19:04.073

就我而言（在 Windows Server 2019 上），我设法通过创建一个值为“English”的系统环境变量“LC_MESSAGES”来更改语言：

```
setx LC_MESSAGES English /m 
```

（从[这里](https://stackoverflow.com/a/31605952/1961209)采取的解决方案）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-10-31T13:24:35.773

我已经重现了与错误消息命名相同的问题，这些`PostgreSQL`错误消息专门显示`Intellij IDEA`为：

[![在此处输入图像描述](https://i.stack.imgur.com/U5JbJ.png)](https://i.stack.imgur.com/U5JbJ.png)

对我来说唯一的解决方案是将文件夹[重命名](https://stackoverflow.com/questions/191428/change-language-of-system-and-error-messages-in-postgresql#comment121662022_56811670) `C:\Program Files\PostgreSQL\13\share\locale`为另一个默认名称。

然后结果更改为：

[![在此处输入图像描述](https://i.stack.imgur.com/0qi6f.png)](https://i.stack.imgur.com/0qi6f.png)

**需要注意的是：**它根本与`Intellij Idea`配置无关，因为我测试了不同的答案（以及其他与答案无关的`IDE`答案），例如：

1.  [帮助 | 编辑自定义 VM 选项](https://intellij-support.jetbrains.com/hc/en-us/community/posts/360007648019-Hot-to-change-error-messages-to-English-Intellij-)
2.  [环境变量的设置](https://stackoverflow.com/a/59288926/8370915)
3.  [使用特定命令](https://stackoverflow.com/a/191958/8370915)

# internet-explorer - CSS：两个 50% 的流体列不考虑最小宽度

> ID：191429
> 
> 赞同：8
> 
> 时间：2008-10-10T14:04:16.610
> 
> 标签：internet-explorer, layout, css

我正在尝试[将此](http://www.glish.com/css/9.asp)布局与两个 50% 的列宽一起使用。但似乎当右列达到其“最小宽度”时，它会位于左列下方。有什么方法可以使用“垫片”技术为包装器设置最小宽度，以便两列都停止调整大小。因此，消除了右栏在左栏下发现自己的问题。

我的页面如下。

```
<style type="text/css">

#left {
    float: left;
    width: 50%;
}

.minwidth {
    width: 500px;
    height: 0;
    line-height: 0;
}

</style>

<div id="wrapper">
    <div id="left">
        left
    </div>
    <div id="right">
        right
    </div>
    <div class="minwidth">&nbsp;</div>
</div> 
```

问题是左列将停止调整大小，但右列将位于左列下方并继续调整大小。基本上，我想要的效果是一旦包装器宽度变低，左右列也停止调整大小。将垫片放在左右两列中也不起作用。

是否有另一种方法可以获得两个 50% 宽度的列并使用 shim 正确设置最小宽度？

谢谢你。

编辑： minwidth 类中的空格实际上是   但它被转换了。;)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-23T15:21:12.377

我能够根据 Stu Nicholls 在 CSS Play 的技术提出一个“不需要 HTML 表格”的解决方案，我个人喜欢它，因为它不仅适用于 IE6+ 和 FF2+，它也是有效的 CSS需要任何黑客。关于为什么基于 CSS 的布局比 HTML 表格更可取的论点，请参见下文。

首先，我建议在使用 CSS 设计新页面时使用**符合标准**的浏览器模式。有关 quirksmode 和标准兼容模式的说明，请从我最喜欢的 CSS 资源站点之一查看[这篇文章](http://www.quirksmode.org/css/quirksmode.html)。您所要做的就是在页面顶部添加一个特定的 DOCTYPE 元素。然后，CSS 将被迫以符合标准的模式呈现，从而减少错误和浏览器特性。如果您无法切换到标准兼容模式，则可以在 quirksmode 下为浏览器提供最小宽度解决方案，也可以在 CSS Play 上找到。

其次，您必须在现有标记周围添加一个额外的包装器。这个包装器用于为理解 min-width（不是 IE）的浏览器设置 min-width。然后，您可以使用 * html 技巧专门针对 IE 6 并将 Stu Nicholl 的技术应用于内部包装器。此处详细介绍了该技术，使用的具体示例是“#2 For standards compliant mode IE”：

[http://www.cssplay.co.uk/boxes/minwidth.html](http://www.cssplay.co.uk/boxes/minwidth.html)

最终结果相当简单。[它使用原始问题中提到的2 列 ALA 样式](http://www.glish.com/css/9.asp)技术创建 2 个 50% 列，这些列具有总最小宽度（在本示例中为 500 像素），其中列停止调整大小并且右列不低于左列。我希望这有帮助！

**编辑：**同样的技术可用于将跨浏览器兼容的最小宽度应用于任何东西。例如，列不需要每个为 50%，可以使用任意数量的列。[http://www.glish.com/css/](http://www.glish.com/css/)是基于 CSS 的页面布局的绝佳资源，当与这种最小宽度技术结合使用时，可以使用最少的有效 CSS 创建许多不错的布局。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <style type="text/css">

        /* For browsers that understand min-width */
        .width {
            width: 100%;
            min-width: 500px;
        }

        /* IE6 Only */
        * html .minwidth {
            border-left: 500px solid white;
            position: relative;
            float: left;
        }

        /* IE6 Only */
        * html .wrapper {
            margin-left: -500px;
            position: relative;
            float: left;
        }

        .left {
            float: left;
            width: 50%;
        }

        .right {
            float: left;
        }

    </style>
</head>
<body>

<div class="width">
    <div class="minwidth">
        <div class="wrapper">
            <div class="left">
                Left
            </div>
            <div class="right">
                Right
            </div>
        </div>
    </div>
</div>

</body>
</html> 
```

现在，我建立 Stack Overflow 帐户的动机是能够响应下面的建议“如果你想要两列，使用一个表格，而不是试图强迫 Div 表现得像一个表格”。由于我太新，无法发表评论或投反对票，因此我正在扩大这个讨论。

真的吗？

有人问了一个关于基于 CSS 的布局的问题，你的回答是告诉他们使用 HTML 表格？

首先让我说我不认为 HTML 表格是完全没有必要的。事实上，任何时候我需要显示表格数据，*即关系数据*，我都会使用 HTML 表格。尚不完全支持 CSS 表格显示属性（即将在 IE8 中推出！），使用*单级*HTML 表格是一种有效的解决方案。查看任何 Google 网页的标记，您会发现他们会同意。

作为一个花费大量时间编写跨浏览器兼容的基于 CSS 的布局的人，而他们本可以使用表格在 10 分钟内完成，我同意这个问题有一个更简单的解决方案。然而，仅仅因为你可以使用炸药来翻新你的厨房，并不意味着你应该这样做。下面的文章详细解释了为什么基于 CSS 的布局更受欢迎。

[http://www.chromaticsites.com/web-design-blog/2008-04-03/13-reasons-why-css-is-superior-to-tables-in-website-design/](http://www.chromaticsites.com/web-design-blog/2008-04-03/13-reasons-why-css-is-superior-to-tables-in-website-design/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T14:20:38.480

试试这个风格：

```
.left, .right { width:50%; float: left; }
.right { float: right; }
.minwidth { min-width: 500px; display: block; height: 0; clear: both; } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T14:21:46.577

只需为包装器设置一个最小宽度，然后将左右列更改为百分比。这将防止您的两列被推入/上方/下方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T14:22:57.040

这是一个快速的尝试，但它有效（仅在 Firefox 中测试）：

```
<head>
<style type="text/css">

#left {
    float: left;
    width: 50%;
}

.minwidth {
    min-width: 500px;
    background:#eee;
    height: 0;
    overflow:visible;
}
.col{
    min-width:250px;
    background:#eaa;
}

</style>
</head>
<body>
<div id="wrapper" class="minwidth">
    <div id="left" class="col">
        left
    </div>
    <div id="right" class="col">
        right
    </div>
    <div><!-- Not needed --></div>
</div>
</body> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T14:27:17.937

试试这个：

```
<html>
<head>
<title>Testing some CSS</title>
<style type="text/css">

.floatme {
    float: left;
    width: 50%;
}

.minwidth {
    width: 500px;
    height: 0;
    line-height: 0;
    clear: both;
}

</style>

<body>
<div id="wrapper">
    <div class="floatme">
        left
    </div>
    <div id="floatme">
        right
    </div>
    <div class="minwidth"> </div>
</div>
</body>
</html> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-25T22:41:55.740

这是你想要的一个很好的例子。

[http://matthewjamestaylor.com/blog/equal-height-columns-2-column.htm](http://matthewjamestaylor.com/blog/equal-height-columns-2-column.htm)

简而言之，这里是 CSS：

```
/* Start of Column CSS */
#container2 {
    clear:left;
    float:left;
    width:100%;
    overflow:hidden;
    background:#ffa7a7; /* column 2 background colour */
}
#container1 {
    float:left;
    width:100%;
    position:relative;
    right:50%;
    background:#fff689; /* column 1 background colour */
}
#col1 {
    float:left;
    width:46%;
    position:relative;
    left:52%;
    overflow:hidden;
}
#col2 {
    float:left;
    width:46%;
    position:relative;
    left:56%;
    overflow:hidden;
} 
```

这是html：

```
<div id="container2">
    <div id="container1">
        <div id="col1">
            <!-- Column one start -->
            <h2>Equal height columns</h2>
            <p>It does not matter how much content is in each column, the background colours will always stretch down to the height of the tallest column.</p>

            <h2>Valid XHTML strict markup</h2>
            <p>The HTML in this layout validates as XHTML 1.0 strict.</p>
            <!-- Column one end -->
        </div>
        <div id="col2">
            <!-- Column two start -->
            <h3>Windows</h3>
            <ul>
                <li>Firefox 1.5, 2 &amp; 3</li>
                <li>Safari</li>
                <li>Opera 8 &amp; 9</li>

                <li>Explorer 5.5, 6 &amp; 7</li>
                <li>Google Chrome</li>
                <li>Netscape 8</li>
            </ul>

            <!-- Column two end -->
        </div>
    </div>
</div> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-14T14:10:19.983

好吧，我不想卷入政治争论，但是 Agoudzward 引用的文章中关于“为什么 CSS 比表格更好”的推理与表格无关。它表明，当许多页面元素需要相同的样式时，CSS 比一遍又一遍地使用单独的字体标签和颜色设置等要好。是的，我完全同意，如果页面上有一百个元素都应该是绿色、14pt、Arial 文本，那么为此创建 CSS 样式而不是一遍又一遍地复制和粘贴字体标签是非常有意义的，出于他们给出的所有原因。如果您想在多个页面上使用相同的样式，那会加倍。

但这与表格有什么关系？

推理似乎是“CSS 很好，因为它允许您指定一次而不是重复指定字体和颜色，因此可以使用 CSS 完成的任何事情都比任何可能的替代方案都要好”。好吧，这根本不遵循！仅仅因为一个工具适用于一种类型的问题并不意味着它适用于所有可能的问题。锤子非常适合钉钉子。这并不意味着我用它们来拧螺丝。如果我可以使用表格比使用 div 和 CSS 标签更简单、更合乎逻辑地进行布局，那么坚持我仍然应该使用 CSS，因为“CSS 很好”让我说，那又如何？

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2008-10-10T14:16:46.867

使用 2 列表。它会做你想要的。Div 应该用于简单地划分逻辑上不同的块，并且表格用于布置列式数据。如果您想要两列，请使用表格，而不是试图强制 Div 表现得像表格。

# c# - 您将如何引用查找/元数据？

> ID：191443
> 
> 赞同：3
> 
> 时间：2008-10-10T14:06:07.137
> 
> 标签：c#, .net, asp.net

我已经多次遇到这个问题并且从不喜欢选择的解决方案。假设您在数据库中有一个状态列表（仅作为一个简单示例）。在您的代码隐藏中，您希望能够通过 ID 引用 State 并通过 Intellisense 获得它们的列表。

例如：

```
States.Arizona.Id  //returns a GUID 
```

但问题是我不想对 GUIDS 进行硬编码。现在过去我已经完成了以下所有操作：

*   创建类常量（最糟糕的硬编码......呃！）

*   创建具有 ID 属性（以及其他属性）的查找类（仍然是硬编码的，如果更新则需要重建项目）

*   将所有 GUIDS 放入 .config 文件中，创建一个枚举，然后在静态构造函数中将 .config 中的 GUIDS 加载到以枚举项为键的 Hashtable 中。那么我可以这样做 `StateHash[StatEnum.Arizona]`：很好，因为如果 GUID 发生更改，则无需重建。但是，如果添加新记录或删除旧记录，则无济于事，因为需要更新枚举。

所以我要问的是是否有人有更好的解决方案？理想情况下，我希望能够通过 Intellisense 进行查找，而不必在有更新时重新构建代码。甚至不确定这是否可能。

编辑：使用状态只是一个例子（可能是一个糟糕的例子）。如果有帮助，它可能是小部件、汽车类型等的列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T14:11:22.213

就个人而言，我会将查找数据存储在数据库中，并尝试避免将规则绑定到单个状态之类的硬编码类型。也许这些州*的*一些关键属性（如 .ApplyDoubleTax 或其他东西）。并且非逻辑代码不需要使用智能感知——它通常只需要列出它们或按名称查找，这可以很容易地完成，但是你已经存储了它。

同样，我会加载一次数据并缓存它。

可以说，根据州对逻辑进行编码*是*硬编码——尤其是如果你想很快走向国际——当一个网站问我我住在哪个州时，我*讨厌它……*

数据正在变化……美国是否希望很快吞并？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T14:18:00.530

这需要自定义 MSBuild 任务。在这种情况下，你真的想要一个自动生成的枚举或类；如果 ID 来自数据库并且可以/将会更改，并且不容易预测。然后，您可以将任务放入您的项目中，并根据需要在每次构建更新之前运行。

或者开始查看 ORM :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T14:19:18.093

我相信，如果它出现在 Intellisense 中，那么根据定义，它会被硬编码到您的程序中。

也就是说，如果您的目标是尽可能轻松地进行硬编码，那么您可能会尝试根据数据库中的内容自动生成枚举。也就是说，您可以编写一个程序来读取数据库并创建一个包含您的枚举的 FOO.cs 文件。然后在每次数据更改时运行该程序。

# visual-studio - 如何在 Visual Studio 中使用 HTML 标记包装选择？

> ID：191463
> 
> 赞同：113
> 
> 时间：2008-10-10T14:08:13.310
> 
> 标签：visual-studio

这似乎是世界上最基本的问题，但如果我能找到答案，那该死的。

是否有键盘快捷键（无论是 Visual Studio 原生的还是通过 Code Rush 或其他第三方插件）来用 HTML 标记包装当前选择？我厌倦了输入开始标签，将放错位置的结束标签剪切到剪贴板，移动光标并将其粘贴到它所属的末尾。

**更新：** [这是 TextMate 处理带有标签的选择的方式](http://screencast.com/t/pesxOgON)。坦率地说，我很惊讶 Visual Studio 似乎没有类似的功能。为我可能想要使用的每个可能的标签创建一个宏或片段似乎很荒谬。

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2016-04-22T21:22:15.433

Visual Studio 2015 带有一个新的快捷方式，Shift+Alt+W，它用 div 包裹当前选择。此快捷方式使文本“div”处于选中状态，使其可以无缝更改为任何所需的标签。这与自动结束标签更换相结合，可提供快速解决方案。

### 更新

此快捷方式在 Visual Studio 2017 中也可用，但您必须安装“ASP.NET 和 Web 开发”工作负载。

# 例子

```
Shift+Alt+W > p > Enter 
```

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2010-05-21T02:20:42.060

我知道这已经过时了，您现在可能已经找到了答案，但我想补充一下，为了那些可能不知道的人，这在 VS 2010 中是可能的：

1.  选择要包围的代码。
2.  执行`ctrl-k` `ctrl-s`（或右键单击并选择`Surround with...`.
3.  有多种 HTML 片段可供选择。

如果找不到您要查找的内容，您可以创建自己的 SurroundsWith 片段：

1.  单击`File`，然后单击`New`，然后选择文件类型`XML`。
2.  在`File`菜单上，单击`Save`。
3.  在`Save as`框中，选择`All Files (*.*)`。
4.  在`File name`框中，输入带有`.snippet`文件扩展名的文件名。
5.  单击`Save`。

在 XML 文件中输入类似于以下示例的内容：

```
<CodeSnippet Format="1.1.0" xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet">
  <Header>
    <Title>ul-div</Title>
    <Author>Microsoft Corporation</Author>
    <Shortcut>ul>li</Shortcut>
    <Description>Wrap in a ul and then an li</Description>
    <SnippetTypes>
      <SnippetType>Expansion</SnippetType>
      <SnippetType>SurroundsWith</SnippetType>
    </SnippetTypes>
  </Header>
  <Snippet>
    <Declarations>
      <Literal>
        <ID>selected</ID>
        <ToolTip>content</ToolTip>
        <Default>content</Default>
      </Literal>
    </Declarations>
    <Code Language="html"><![CDATA[<ul><li>$selected$</li></ul>$end$]]></Code>
  </Snippet>
</CodeSnippet> 
```

1.  打开`Tools`> `Code Snippets Manager`。
2.  单击`Import`并浏览到您刚刚创建的代码段。
3.  检查`My HTML Snippets`并单击`Finish`然后`OK`。

然后，您将拥有可用于包装内容的闪亮的新 HTML 片段！

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2014-08-19T11:23:17.950

Ctrl-X -> Type tags -> Ctrl-V 仍然是我在这个答案中提到的最快的解决方案：[https](https://stackoverflow.com/a/5109994/486325) ://stackoverflow.com/a/5109994/486325 。

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2014-09-11T20:21:51.627

如果您安装了[Web Essentials](http://vswebessentials.com)，则可以[使用 Shift+Alt+W](http://vswebessentials.com/features/html#surround-with)用标签包围选择。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-05-09T07:38:38.310

对于使用 Visual Studio 2017 的用户：右键单击`html`/`cshtml`区域，或者选择一些元素进行换行，`Wrap With <div>`列表上有一个按钮。 [![在此处输入图像描述](https://i.stack.imgur.com/CSFSa.png)](https://i.stack.imgur.com/CSFSa.png)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2011-04-01T11:18:22.413

我知道这是一个古老的话题，但是遇到了这个问题，我终于开始自己做，因为这是谷歌的第一个结果，我想人们可能会觉得这很有用。

实际上这很容易，我只是从现有的 HTML 片段中复制并移动文字。以下代码段将围绕一个通用 HTML 标记，它会提示输入该标记并将其放在开始和结束标记中。

```
<CodeSnippet Format="1.1.0" xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet">
  <!-- Generic HTML Snippet -->
  <Header>
    <Title>Html</Title>
    <Author>Liam Slater</Author>
    <Shortcut>h</Shortcut>
    <Description>Markup snippet for HTML</Description>
    <SnippetTypes>
      <SnippetType>SurroundsWith</SnippetType>
    </SnippetTypes>
  </Header>
  <Snippet>
    <Declarations>
      <Literal>
        <ID>tag</ID>
        <ToolTip>tag</ToolTip>
        <Default></Default>
      </Literal>
      <Literal>
        <ID>selected</ID>
        <ToolTip>content</ToolTip>
        <Default>content</Default>
      </Literal>
    </Declarations>
    <Code Language="html"><![CDATA[<$tag$>$selected$</$tag$>$end$]]></Code>
  </Snippet>
</CodeSnippet> 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-10-10T14:33:06.693

面对这种情况，我经常先输入结束标签，然后输入开始标签。这可以防止 IDE 通过在我不想要的地方插入结束标签来“提供帮助”。不过，我也对更好的解决方案感兴趣。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-10T14:36:45.233

我什么都不知道，但是编写一个宏将其包装在您想要的任何标签中应该不难。我有一个类似的，它将我的选择包装在一个区域块中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-12-18T08:00:06.140

我知道这是一个老问题，但我只是在为同样的事情而苦苦挣扎。您可以安装 Andrés Gutiérrez 的 Emmet Keybindings 扩展。安装后，您可以突出显示文本，然后使用 control + MW 以您想要的任何标签包装。为了给每一行一个开始和结束标签，在标签后面加上一个*。

# visual-studio-2008 - VS.NET 2008 中的实体框架入门

> ID：191472
> 
> 赞同：4
> 
> 时间：2008-10-10T14:09:13.637
> 
> 标签：visual-studio-2008, entity-framework

在 VS.net 2008 中开始使用实体框架到底需要什么？

我在输入此内容时正在下载 vs.net 2008 的 SP1，还有什么我遗漏的吗？

据我了解，我将不得不创建一些 XML，然后使用 .exe 工具吐出代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T19:48:10.287

这个问题之前在[这里](https://stackoverflow.com/questions/182497/what-is-the-best-starting-point-on-the-entity-framework-from-ms#182539)被问过......

但是，我将重申我对这个问题的回答：[此问题](https://stackoverflow.com/questions/62110/adonet-entity-framework-tutorials)中提供了一些教程的列表。

[这](http://forums.microsoft.com/msdn/ShowForum.aspx?ForumID=533&SiteID=1)是一个有用的实体框架论坛。

对我来说，当我开始使用实体框架时，最有用的参考资料是[Daniel Simmons 的 FAQ](http://blogs.msdn.com/dsimmons/pages/entity-framework-faq.aspx)。一探究竟！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T14:11:33.040

VS2008 SP1 带有实体框架和 EF 项目项的设计器（ADO.NET 实体数据模型），但如果您需要细粒度的控制，您也可以使用命令行工具。

因此，一旦您安装了 SP，您就可以开始使用了。

# jquery - 带有内部块元素的 JQuery 滑块

> ID：191482
> 
> 赞同：1
> 
> 时间：2008-10-10T14:10:36.067
> 
> 标签：jquery, slider

我正在尝试构建一个类似于此处演示的“滑块” [http://ui.jquery.com/repository/real-world/product-slider/](http://ui.jquery.com/repository/real-world/product-slider/)`<li>`但我正在尝试在列表项（ ）中使用内部 div . `<p>`如果您不使用图像或块元素（ ，`<div>`等），似乎此演示会中断

有人对此有任何快速解决方案吗？我基本上想在 a 中使用文本和可能的图像，`<div>`而不是使用图像。

我确实找到了 jCarousel，它看起来好像可以工作，但我正在寻找更轻量级的东西？有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T06:41:18.063

我想我*有*一个你正在尝试做的工作示例，但有几个问题。

使用您发布的示例作为基础，您可以将 UL 中 LI 的 HTML 标记替换为容器 DIV 中的 DIV。例如：

```
 <div class="sliderGallery">
          <div class="div-that-gets-cropped">
            <div class="text-and-images-chunk">Some text!<br /><img class="pb-airportexpress" src="slider-gallery_files/pb_airport_express.jpg" /></div>
            <div class="text-and-images-chunk">Some text!<br /><img src="slider-gallery_files/pb_airport_extreme.jpg" /></div>
            <div class="text-and-images-chunk">Some text!<br /><img src="slider-gallery_files/pb_timecapsule_20080115.jpg" /></div>
            ...
          </div> 
```

然后修改页面中的 jQuery 代码以针对该容器 DIV 而不是 UL：

```
 window.onload = function () {
        var container = $('div.sliderGallery');
        var divThatGetsCropped = $('div.div-that-gets-cropped', container);
        var itemsWidth = divThatGetsCropped.innerWidth() - container.outerWidth();
        $('.slider', container).slider({
            minValue: 0,
            maxValue: itemsWidth,
            handle: '.handle',
            stop: function (event, ui) {
                divThatGetsCropped.animate({'left' : ui.value * -1}, 500);
            },
            slide: function (event, ui) {
                divThatGetsCropped.css('left', ui.value * -1);
            }
        });
    }; 
```

然后，您需要进行一些重要的 CSS 更改...最初的示例依赖于 LI 的样式以显示：内联，在隐藏溢出的容器内部。如果您只是将这些“text-and-images-chunk” DIV 设置为内联显示，那么尝试让所有内容正确显示将是一件令人头疼的事情。您可能希望将它们全部浮动。

**但是**，浮动元素不会很好地与容器“div-that-gets-cropped”DIV 配合使用，因为它被“sliderGallery”DIV“显示”的方式（至少这是我在 Firefox 3.03 中所经历的） ）。我通过为“div-that-gets-cropped”DIV（10000 px）设置一个非常大的宽度来解决这个问题：

```
 .sliderGallery div.div-that-gets-cropped {
          position: absolute;
          list-style: none;
          overflow: none;
      white-space: nowrap;
      padding: 0;
          margin: 0;
          width: 10000px;
        }

        .sliderGallery div.div-that-gets-cropped div.text-and-images-chunk {
      float: left;
      margin-right: 24px;
        } 
```

而且您必须调整 .slider-lbl1, .slider-lbl2 的“左”值以匹配最终的宽度（如果文本的大小最终改变了“文本和图像块”元素）。

我注意到的一个问题是，当您将图像放在块级元素中时，没有一种好方法可以让它们“拥抱”底部，就像在使用内联的示例中所做的那样。您可能可以通过调整元素的位置来完成这项工作（我不能），但希望这在您的具体使用中不会有什么大不了的。

综上所述，jCarousel 似乎*完全适合您正在做的事情*，即使它确实增加了一些代码量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-20T13:33:39.487

查看 jCarousel Lite 插件。我发现它非常有用且易于配置。

[http://www.gmarwaha.com/jquery/jcarousellite/index.php?#demo](http://www.gmarwaha.com/jquery/jcarousellite/index.php?#demo)

# javascript - 如何在页面加载之前提交 ajax 请求

> ID：191483
> 
> 赞同：3
> 
> 时间：2008-10-10T14:10:43.913
> 
> 标签：javascript, ajax

我想通过 ajax 请求检查用户的登录状态。根据用户是否登录，我想显示用户名/密码输入或用户名。目前，请求在 body.onload 上发送，并显示一个进度指示器，直到响应到达。有没有更好的办法？

* * *

让我们假设需求声明不应该有直接的服务器端处理。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T14:13:50.350

这听起来像是在呈现页面之前应该首先在服务器上完成的操作。如果有人禁用了javascript，会发生什么？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T17:31:48.983

如果您不想依赖工具包，您可以创建自己的 DOMReady 函数，看起来像这样：

```
/* 用法：DOMReady(ajaxFunc); */
函数 DOMReady(f) {
    如果（！document.all）{
        document.addEventListener("DOMContentLoaded", f, false);
    } 别的 {
        if (document.readystate == '完成') {
            window.setTimeout(f, 0);
        }
        别的 {
            //添加事件到onload，如果一切都失败了
            附加事件（窗口，“加载”，f）；
        }
    }
}

```

或者对于更复杂的解决方案：[http ://snipplr.com/view/6029/domreadyjs/](http://snipplr.com/view/6029/domreadyjs/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T14:13:10.167

为什么不在给用户 html 之前检查呢？

如果您只是运行带有 Javascript 的静态 HTML，我建议您使用[JQuery](http://www.jquery.com)并使用 $(document).ready()：

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T14:16:05.790

我认为这应该是可能的，但不建议这样做。正确的做法是让服务器在页面发送之前完全确定页面的内容。

如果您被缓慢的图像下载或其他非 HTML 内容所困扰，请查看各种 JavaScript 库之一。我总是推荐[jQuery](http://jquery.com/)，它具有以下语法：

```
$(document).ready(function() {
  // The DOM is fully loaded now, but images might still be loading.
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T14:32:52.357

我相信如果你使用内联javascript，它应该在遇到它时立即执行：

```
<HTML><HEAD>...</HEAD>
<BODY>
<script>
document.write("This is written before anything else");
</script>
This come later.
</BODY>
</HTML> 
```

# php - 在字符串中查找句子的开头

> ID：191490
> 
> 赞同：1
> 
> 时间：2008-10-10T14:11:31.917
> 
> 标签：php, regex

我想在带有标题和简短描述的网站中显示搜索查询的结果。简短描述应该是包含搜索词的页面的一小部分。我想要做的是：第 2 页中的 1 条标签从该位置找到 seachterm 3 的第一个位置，然后返回找到该句子的开头（如果有的话）。4 从第 3 步中找到的位置开始并显示 ie 从那里开始的 200 个字符

我在第 3 步需要一些帮助。我想我需要一个找到第一个大写字母或点的正则表达式......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T14:18:14.553

即便如此，最终也会失败。给定句子“我们去了史密斯博士的办公室”，如果您的搜索词是“办公室”，那么几乎您使用的任何标准都会给您“史密斯的办公室”作为您的句子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T14:15:35.450

我会这样做的方式是，我会解析页面......

1.  跳过所有以“<”开头的内容

2.  当你遇到一个“。” 或 [AZ]，开始将其放入缓冲区，直到找到另一个“。”

3.  如果缓冲的字符串有搜索关键字，那就是你的字符串！别的。在“。”处开始缓冲 你遇到并重复。

编辑：正如 James Curran 指出的那样，这种策略在某些情况下会失败......所以解决方案如下：

您可以做的是从页面开头开始 X 个字符（在标签之后）

然后搜索您的关键字，缓冲之前的 2 个单词。当你找到它时，做这样的事情：*{X} ... {prev-2} {next-2}*

示例：*这个星球有——或者更确切地说是——有一个问题，那就是：生活在上面的大多数人在大部分时间里都不快乐。针对这个问题提出了许多解决方案，但其中大多数主要关注绿色小纸片的运动，这很奇怪，因为总的来说并不是绿色小纸片不开心。*

搜索关键字：“建议”

结果：*这个星球有 - 或者更确切地说 - 有问题......* *针对这个问题***提出了许多解决方案......**

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T14:20:49.103

对于第 3 步：如果您反转结束要向后搜索的子字符串，则获取第一个 '.' 的位置。并从搜索字符串的位置子跟踪该值。

```
$offset = stripos( strrev(substr($string, $searchlocation)), '.');
$startloc = $searchlocation - $offset;
$finalstring = substr($string, $startloc, 200); 
```

这可能会偏离 1，但我认为它会完成工作。似乎应该有更短的方法来做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T14:53:34.263

我认为与其尝试查找句子，不如考虑我需要的搜索词周围的上下文量。然后倒退这个单词数量的一部分（或回到开头）并转发剩余的单词数量以选择上下文的其余部分。这样，您只需在空白处拆分整个语料库，找到第一次出现的术语（可能使用模糊匹配来查找子术语并解释标点符号），然后应用上述算法。如果第一个未选择的术语没有以标点符号等结尾，您甚至可以创造性地引入省略号。

# c++ - 在 Delphi 和/或 C++ 中避免对话框样板

> ID：191493
> 
> 赞同：4
> 
> 时间：2008-10-10T14:11:42.897
> 
> 标签：c++, delphi, modal-dialog, boilerplate

我经常需要在 Delphi/C++Builder 中设计一个对话框，允许修改对象的各种属性，使用它的代码通常如下所示。

```
Dialog.Edit1.Text := MyObject.Username;
Dialog.Edit2.Text := MyObject.Password;
// ... many more of the same

if (Dialog.ShowModal = mrOk) 
begin
  MyObject.Username := Dialog.Edit1.Text;
  MyObject.Password := Dialog.Edit2.Text;
  // ... again, many more of the same
end; 
```

我也经常需要类似的代码来将对象编组到/从 xml/ini-files/whatever。

是否有任何常见的习惯用法或技术来避免这种简单但重复的代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T15:16:08.133

这是我对此的变化。我已经厌倦了相同的重复代码，我所做的是根据我想要的 XML 节点名称命名所有编辑框，然后遍历组件并输出它们的值。XML 代码应该很明显，我只有一个编辑和复选框，但您应该能够看到这个想法。

```
procedure TfrmFTPSetup.LoadFromXML(szFileName : string);
var
xComponent : TComponent;
nLoop : Integer;
xMainNode : TXmlNode;
xDocument : TNativeXml;
begin
inherited;

xDocument := TNativeXml.Create;
try
    xDocument.LoadFromFile(szFileName);
    xMainNode := xml_ChildNodeByName(xDocument.Root, 'options');
    for nLoop := 0 to ComponentCount - 1 do
    begin
        xComponent := Components[nLoop];
        if xComponent is TRzCustomEdit then
        begin
            (xComponent as TRzCustomEdit).Text := xMainNode.AttributeByName[xComponent.Name];
        end;
        if xComponent is TRzCheckBox then
        begin
            (xComponent as TRzCheckBox).Checked := xml_X2Boolean(xMainNode.AttributeByName[xComponent.Name], false);
        end;
    end;
finally
    FreeAndNil(xDocument);
end;
 end;

   procedure TfrmFTPSetup.SaveToXML(szFileName : string);
var
xComponent : TComponent;
nLoop : Integer;
xMainNode : TXmlNode;
xDocument : TNativeXml;
begin
inherited;

xDocument := TNativeXml.CreateName('ftpcontrol');
try
    xMainNode := xml_ChildNodeByNameCreate(xDocument.Root, 'options');
    for nLoop := 0 to ComponentCount - 1 do
    begin
        xComponent := Components[nLoop];
        if xComponent is TRzCustomEdit then
        begin
            xMainNode.AttributeByName[xComponent.Name] := (xComponent as TRzCustomEdit).Text;
        end;
        if xComponent is TRzCheckBox then
        begin
            xMainNode.AttributeByName[xComponent.Name] := xml_Boolean2X((xComponent as TRzCheckBox).Checked);
        end;
    end;

    xDocument.XmlFormat := xfReadable;
    xDocument.SaveToFile(szFileName);
finally
    FreeAndNil(xDocument);
end;
 end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T15:54:58.180

好吧，我觉得完全无价的东西是[GExperts](http://www.gexperts.org)插件向导“反向语句”，它在安装 GExperts 后按 Shift + ALT + R 调用

它所做的是自动为突出显示的块切换分配。例如：

```
edit1.text := dbfield.asString; 
```

变成

```
dbField.asString := edit1.text; 
```

不完全是您想要的，但是当您有大量任务时可以节省大量时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T10:12:45.717

访问表单上可视组件的属性并不是一种好的做法。具有单独的属性被认为更好。在上面的示例中，您将拥有带有 get 和 set 方法的用户名和密码属性。

例如：

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls;

type
  TForm1 = class(TForm)
    Edit1: TEdit;
    Edit2: TEdit;
  private
    function GetPassword: string;
    function GetUsername: string;
    procedure SetPassword(const Value: string);
    procedure SetUsername(const Value: string);
  public
    property Password: string read GetPassword write SetPassword;
    property Username: string read GetUsername write SetUsername;
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

function TForm1.GetPassword: string;
begin
 Result := Edit2.Text;
end;

function TForm1.GetUsername: string;
begin
 Result := Edit1.Text;
end;

procedure TForm1.SetPassword(const Value: string);
begin
  Edit2.Text := Value;
end;

procedure TForm1.SetUsername(const Value: string);
begin
  Edit1.Text := Value;
end;

end. 
```

这意味着您可以在不影响调用代码的情况下更改表单上的可视组件。

另一种选择是将对象作为属性传递给对话框；

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls;

type
  TUserObject = class(TObject)
  private
   FPassword: string;
   FUsername: string;
  public
   property Password: string read FPassword write FPassword;
   property Username: string read FUsername write FUsername;
  end;

  TForm1 = class(TForm)
    Edit1: TEdit;
    Edit2: TEdit;
    btnOK: TButton;
    procedure btnOKClick(Sender: TObject);
  private
    FUserObject: TUserObject;
    procedure SetUserObject(const Value: Integer);
  public
    property UserObject: Integer read FUserObject write SetUserObject;
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.btnOKClick(Sender: TObject);
begin
 FUserObject.Username := Edit1.Text;
 FUserObject.Password := Edit2.Text;
 ModalResult := mrOK;
end;

procedure TForm1.SetUserObject(const Value: Integer);
begin
 FUserObject := Value;
 Edit1.Text := FUserObject.Username;
 Edit2.Text := FUserObject.Password;
end;

end. 
```

希望有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T14:33:33.773

Delphi 至少有'With'，虽然它并没有完全解决问题。

```
if (Dialog.ShowModal = mrOk) 
begin
  with MyObject do
  begin
    Username := Dialog.Edit1.Text;
    Password := Dialog.Edit2.Text;
    // ... again, many more of the same
  end;
end; 
```

和建设者 AFAIK 没有任何相似之处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T17:03:32.707

将控件绑定到数据在 Delphi 中运行良好，但不幸的是，只有当数据驻留在 TDataSet 后代中时。您可以编写一个使用对象进行数据存储的 TDataSet 后代，事实证明这样的东西已经存在。请参阅下面的链接...此实现似乎仅适用于对象集合（TCollection 或 TObjectList），而不适用于单个对象。

[http://www.torry.net/pages.php?id=563](http://www.torry.net/pages.php?id=563) - 在页面中搜索“Snap Object DataSet”

我对此没有个人经验，但如果它有效，特别是如果它也适用于单个对象实例，例如数据模块上的属性，它将非常有用......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-11T15:47:24.373

查“[中介模式](http://en.wikipedia.org/wiki/Mediator_pattern)”。这是一种 GoF 设计模式，在他们的书中，GoF 实际上激发了这种设计模式，情况与您在此处描述的情况有些相似。它旨在解决一个不同的问题——耦合——但我认为无论如何你也有这个问题。

简而言之，这个想法是创建一个对话中介，一个位于所有对话小部件之间的额外对象。没有小部件知道任何其他小部件，但每个小部件都知道中介。中介知道所有小部件。当一个小部件发生变化时，它会通知中介；调解器然后通知相关的小部件。例如，当您单击确定时，调解器可能会通知其他小部件有关此事件。

这样，每个小部件只处理与自身相关的事件和操作。中介负责所有小部件之间的交互，因此所有这些“样板”代码都拆分到所有小部件上，对所有小部件全局的“剩余”是交互，它是中介的责任。

# .net - 在 .Net 中通过 Web 服务调用维护 SQL 事务

> ID：191494
> 
> 赞同：2
> 
> 时间：2008-10-10T14:12:07.640
> 
> 标签：.net, service, distributed, transactions

如何执行数据库事务，在其中创建新记录，然后使用从数据库返回的新记录 ID 调用 Web 服务，该 ID 也将操作同一个数据库？我显然可以直接从同一个 SQLConnection 对象更新所有表，但是 Web 服务调用中的逻辑可能会发生变化，我确实需要确保我的代码所做的更改与被调用的 Web 服务引入的那些更改一起提交。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T14:18:46.940

如果 Web 服务负责操作数据库，我会扩展 Web 服务以执行您的代码正在执行的操作。使用 Web 服务的目的是（应该）将您的代码与直接处理数据库分开。在你的代码中引入直接的数据库操作只会让事情变得更加复杂和难以维护。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T14:29:38.587

这不是您在实际交易中想要的东西。事务应该尽可能短，这意味着中间没有用户交互，或者在这种情况下等待 Web 服务响应。

至于您的问题，如果您可以控制 Web 服务，则更改 Web 服务以进行执行整个事务的存储过程调用。如果每次调用服务时都必须完成某些操作，那么它们应该是服务的一部分。

我的猜测是您无法控制 Web 服务，否则这不是问题。Web 服务如何访问数据库？如果它已经在使用存储过程，那么您应该能够在其中添加必要的逻辑。再说一次，我猜情况并非如此，否则不会有问题。我的建议是，如果可能的话，您尝试更改 Web 服务以适应该架构。

假设 web 服务直接访问表 (yuck)，您需要将代码放入执行插入的调用代码中，调用 web 服务，然后检查 web 服务是否完成了它应该做的事情，如果然后您的代码没有采取必要的措施来撤消所有操作。它基本上就像一个本土的交易引擎。它也非常混乱，并且容易出错且难以维护。更不用说，它不是 100% 完整的证明。

# c# - 清除 Winform Combobox 类型的默认空值：DropDownList

> ID：191496
> 
> 赞同：8
> 
> 时间：2008-10-10T14:12:23.007
> 
> 标签：c#, winforms, combobox

如何将组合框的默认值作为数组中的第一项。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-10T14:18:28.673

在填充组合框后放置此代码：

```
comboBox1.SelectedIndex = 0; 
```

# php - PHP readdir 没有读取某些文件

> ID：191503
> 
> 赞同：2
> 
> 时间：2008-10-10T14:14:07.340
> 
> 标签：php

我正在使用以下代码循环遍历目录以打印出文件的名称。但是，并非所有文件都显示出来。我试过使用**clearstatcache**没有效果。

```
 $str = '';
    $ignore = array('.', '..');

    $dh = @opendir( $path );
    if ($dh === FALSE)
    {
        // error
    }

    $file = readdir( $dh );
    while( $file !== FALSE )
    {
        if (in_array($file, $ignore, TRUE)) { break; }
        $str .= $file."\n";
        $file = readdir( $dh );
    } 
```

这是现在目录的内容：

```
root.auth  test1.auth  test2.auth  test3.auth  test5.auth 
```

但是，test5.auth 没有出现。如果我将其重命名为 test4.auth 它不会出现。如果我将它重命名为 test6.auth 它**会**出现。这是可靠的行为——我可以多次重命名它，但除非我将它重命名为 test6.auth，否则它仍然不会显示。

到底会发生什么？

我正在运行带有 PHP 版本 5.2.6 的 Arch Linux（内核 2.6.26-ARCH）和带有 Suhosin-Patch 的 Apache/2.2.9。我的文件系统是 ext3，我正在运行 fam 2.6.10。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T15:54:54.967

继续也不起作用，因为您将跳过读取下一个文件的行。

你可以摆脱第一个`$file = readdir( $dh );`然后做

```
while (false !== ($file = readdir($dh))) {
    if (in_array($file, $ignore, TRUE)) { continue; }
    $str .= $file."\n";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T14:19:42.803

您的`break`关键字弄乱了您的代码：
您的循环很可能首先遇到“。” 目录，然后打破你的 while 循环。

尝试用 a 替换它，`continue`你应该没问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T14:21:26.887

```
if (in_array($file, $ignore, TRUE)) { break; } 
```

应该`continue`不是`break`吧？

# php - PHP 是否具有从一个数据库服务器故障转移到另一个数据库服务器的内置机制？

> ID：191528
> 
> 赞同：5
> 
> 时间：2008-10-10T14:18:53.663
> 
> 标签：php, mysql, database, failover

我找到了这个：

[http://www.evolt.org/failover-database-connection-with-php-mysql](http://www.evolt.org/failover-database-connection-with-php-mysql)

和类似的例子。但是有更好的方法吗？

我正在考虑MS SQL Native Client 中的[自动故障转移客户端。](http://www.microsoft.com/technet/prodtechnol/sql/bestpractice/implappfailover.mspx#EMD)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-10T14:29:39.647

在系统级别处理故障转移策略是传统的；这样所有应用程序都可以享受一个强大的环境。

我想参考[MySQL 故障转移策略](http://dev.mysql.com/tech-resources/articles/failover-strategy-part1.html)和[MySQL 代理](http://forge.mysql.com/wiki/MySQL_Proxy)。后者描述了一个 MySQL 实用程序，它可以进行负载平衡和故障转移，并且似乎很容易设置。

不是问题的答案，但它是处理故障转移的更常见的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T15:21:13.537

在 PHP 中没有内置任何东西来处理它。您必须自己编写代码。

最好的方法是抽象您的数据库访问并创建一个可以封装故障转移逻辑的类。

这是一些代码，即插即用：

```
interface MySQL_Interface {
    public function query($sql);
}

class MySQL_Concrete implements MySQL_Interface {
    public function __construct($host, $user, $pass, $dbname) {
        $this->_mysql = mysql_connect($host, $user, $pass) or throw Exception("Could not connect to server");
        mysql_select_db($db, $this->_mysql) or throw Exception("Could not connect to database");
    }
    public function query($sql) {
        return mysql_query($sql) or throw new Exception("Query failed");
    }
}

class MySQL_Failover implements MySQL_Interface {
    public function __construct(MySQL_Interface $one, MySQL_Interface $two) {
        $this->_one = $one;
        $this->_two = $two;
    }
    public function query($sql) {
        try {
            return $this->_one->query($sql);
        } catch (Exception $e) {
            return $this->_two->query($sql);
        }
    }
}

$db = new MySQL_Failover(
    new MySQL_Concrete('host1', 'user', 'pass', 'db'),
    new MySQL_Concrete('host2', 'user', 'pass', 'db')
);

$db->query('SELECT * FROM Users'); 
```

*PS：我已经离开了很多，它不是逐字使用的。*

*PPS：我可能会更好地使用现有的数据库抽象库（Zend_Db、MDB2 等）并实现它们的接口，而不是创建自己的临时解决方案*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T14:28:37.013

不，它没有内置。我认为一个简单的方法是使用[MySQL Proxy](http://forge.mysql.com/wiki/MySQL_Proxy)。否则，您的应用程序中的*逻辑*( `if (fails) { connect to another }`) 就性能而言不是那么漂亮和出色。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T14:31:53.747

php 没有内置的故障转移机制 - 可能是有充分理由的。这种故障转移系统应该在操作系统或硬件层面实现。

无论如何，您的示例提供了一种廉价且简单的故障转移机制。

# browser - 您如何更改明显的原产国来测试网站？

> ID：191530
> 
> 赞同：7
> 
> 时间：2008-10-10T14:19:03.833
> 
> 标签：browser, regional, web-testing

我希望能够设置我的原籍国 - 这是否涉及通过代理进行测试，或者是否可以在其他地方设置一些东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T14:24:46.897

为此，我会使用[TOR 。](http://www.torproject.org/)这样，您就可以确定您是从不同的国家/地区访问该网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T14:24:51.373

取决于你想测试什么。如果它是 GeoIP 系统，您需要在另一个位置为自己设置一个代理，或者使用不同的网络。如果是 HTTP 内容协商标头，您可以在浏览器配置中更改它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T14:26:37.970

你如何做取决于操作系统和浏览器以及你正在测试什么。

如果您正在测试在浏览器中运行的非 HTML 内容（例如 flash），那么使用 IE，您必须更改计算机的位置，因为 IE 从那里拾取它。使用 Firefox，浏览至 about:config，接受“Here be dragons”警告并编辑 general.useragent.locale 值。

如果您正在测试基于本地返回的页面版本，那么您需要指定语言（在 Firefox 中，工具 -> 选项菜单 -> 内容选项卡 -> 在语言部分选择按钮并添加正确的国家代码）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T14:36:35.033

我假设您正在使用 IP 来检查国家/地区。如果您在内部进行测试，那么可能会获得一个设置，其中测试机器和要测试的服务器都位于同一个 NAT 后面。在这种情况下，只需手动将您的 IP 设置为您要测试的任何国家/地区的 IP，然后连接到服务器。只要你们俩都在同一个 NAT 后面，它就应该将您视为您设置的任何 IP。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-09T23:57:07.470

也许这很明显，但您也可以使用 VPN（来自像[purevpn.com](https://purevpn.com)这样的公司）或使用[来自 AWS 的 EC2](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.RegionsAndAvailabilityZones.html)等虚拟机从另一个国家/地区进行测试。黄金标准是像 EC2 虚拟机这样的远程桌面，因为 VPN 或代理可能会有延迟。

# svn - SVN 和二进制文件

> ID：191533
> 
> 赞同：30
> 
> 时间：2008-10-10T14:19:18.780
> 
> 标签：svn

在问[了这个问题](https://stackoverflow.com/questions/186196/what-project-files-shouldnt-be-checked-into-svn)之后，我被建议不要将二进制文件签入颠覆。我的问题是我该如何处理需要在 bin 文件夹中的第 3 方 dll？我需要能够签出工作副本并将其作为网站运行，所有 dll 等都完好无损。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-10-10T14:23:19.800

您的其他问题的答案建议您不要将任何**生成的**文件提交给颠覆。bin 文件夹中的 DLL 通常是作为应用程序的一部分构建的，因此，它们应该重新生成而不是存储在 subversion 中。

如果 DLL 是您没有源代码的第 3 方 DLL，那么我会将它们存储在 subversion 中。您应该将重新创建应用程序所需的所有内容都放入 subversion 中。这意味着您的源代码和第 3 方库或程序。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-10T14:22:38.883

我总是签入第三方 DLL（进入“lib”文件夹），以便应用程序可以从新签出中构建和运行。我认为“不签入二进制文件”规则适用于您签入的源代码生成的二进制文件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-10T14:24:49.800

正如本所说。我不会将经常更改的二进制文件放入源代码控制中。但是第三部分的 dll，是的，它们最终也出现在我的 svn 上的 lib 文件夹中。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-10T14:27:03.773

仅仅因为文件是二进制文件，您就不应该检查它。警告应该是反对将派生对象签入存储库。您应该始终能够从源代码再次构建所有派生对象。这可能意味着您需要在存储库中有第三方二进制文件。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-10T15:47:56.980

指导方针很简单：

*   重建解决方案所需的一切都应签入 *
*   在构建过程中生成的任何东西 - 都必须远离

--
* 程序、工具、服务包是这条规则的明显例外。但它们必须列在一个版本化的文件中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T14:23:57.210

我在项目的 DLL 目录中包含任何必需的 DLL，并从那里引用它们（复制到本地）。然后它们可以包含在同一个存储库/文件夹中，或者使用 svn-external 从远程位置引入（如果它们在多个项目中共享）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-10T15:46:38.900

理想情况下，SVN 存储库应该需要构建目标所需的每个文件。因此，如果您购买了一台全新的计算机，安装了编译器和 SVN，然后检查了存储库 - 您可以构建而无需查找任何其他依赖项。因此，第 3 方库将被放入存储库中，但目标不是。

如果您正在对安装映像进行 SVN 处理，则例外情况。我们在这里这样做，但是在我们的生产人员使用的一组不同的存储库中（程序员不使用）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-13T19:06:49.667

如果二进制文件是指可执行文件，则最佳做法是从源代码重新生成它们 - 如果源代码可用。如果二进制文件是指非文本文件，我可以告诉你，我一直使用 SVN 来存储非文本文件（jpg 图像、Visio 文件、bmp 文件、带有图像和图表的 MS Word 2003 文档、MS Project 文件和类似的文件。我从来没有遇到过任何损坏或类似的问题。而且在 SVN 中存储和管理所有内容非常方便。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-11-13T14:31:38.633

在干净设计和维护的环境中，您应该拥有自己的 NuGet 服务器，您可以在其中推送 DLL 甚至 3rd 方 DLL/二进制文件，您的代码应该从本地 NuGet 服务器下载所有必需的 DLL，因此不要将二进制文件提交到 SVN仍然成立。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-10T14:34:55.223

事实上，SVN 确实比 CVS 更有效地存储二进制文件，有关更多信息，请参阅[SVN-FAQ](http://subversion.tigris.org/faq.html#binary-files)

# python - 使用 Python 将 XML 转换为 JSON？

> ID：191536
> 
> 赞同：202
> 
> 时间：2008-10-10T14:19:44.207
> 
> 标签：python, json, xml, converter

我在网络上看到了相当多的笨拙的 XML->JSON 代码，并且与 Stack 的用户进行了一段时间的互动，我相信这群人比谷歌结果的前几页可以提供更多帮助。

因此，我们正在解析天气提要，我们需要在众多网站上填充天气小部件。我们现在正在研究基于 Python 的解决方案。

这个公共的[weather.com RSS 提要](http://rss.weather.com/weather/rss/local/14607?cm_ven=LWO&cm_cat=rss&par=LWO_rss)是我们将要解析的一个很好的例子（*我们实际的weather.com 提要包含额外的信息，因为与他们建立了合作关系*）。

简而言之，我们应该如何使用 Python 将 XML 转换为 JSON？

* * *

## 回答 #1

> 赞同：334
> 
> 时间：2012-04-18T01:06:05.353

[xmltodict](https://github.com/martinblech/xmltodict)（完全公开：我写的）可以帮助您将 XML 转换为 dict+list+string 结构，遵循这个[“标准”](http://www.xml.com/pub/a/2006/05/31/converting-between-xml-and-json.html)。它是基于[Expat](http://docs.python.org/library/pyexpat.html)的，因此速度非常快，并且不需要将整个 XML 树加载到内存中。

拥有该数据结构后，您可以将其序列化为 JSON：

```
import xmltodict, json

o = xmltodict.parse('<e> <a>text</a> <a>text</a> </e>')
json.dumps(o) # '{"e": {"a": ["text", "text"]}}' 
```

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2008-10-10T14:34:55.580

XML 和 JSON 之间没有“一对一”的映射关系，因此将一个映射到另一个必然需要了解您想要对结果*做*什么。

话虽如此，Python 的标准库有[几个用于解析 XML 的模块](http://docs.python.org/2/library/xml.html)（包括 DOM、SAX 和 ElementTree）。[`json`从 Python 2.6 开始，模块](http://docs.python.org/2/library/json.html)中包含对将 Python 数据结构与 JSON 相互转换的支持。

所以基础设施就在那里。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2015-09-20T07:37:54.507

您可以使用[xmljson](https://pypi.python.org/pypi/xmljson)库来使用不同的[XML JSON 约定](http://wiki.open311.org/JSON_and_XML_Conversion/)进行转换。

例如，这个 XML：

```
<p id="1">text</p> 
```

通过[BadgerFish 约定](http://www.sklar.com/badgerfish/)转换为：

```
{
  'p': {
    '@id': 1,
    '$': 'text'
  }
} 
```

并通过[GData 约定](http://wiki.open311.org/JSON_and_XML_Conversion/#the-gdata-convention)进入此（不支持属性）：

```
{
  'p': {
    '$t': 'text'
  }
} 
```

...并通过[Parker 约定](https://developer.mozilla.org/en-US/docs/JXON#The_Parker_Convention)进入此（不支持属性）：

```
{
  'p': 'text'
} 
```

可以使用相同的约定从 XML 转换为 JSON 以及从 JSON 转换为 XML：

```
>>> import json, xmljson
>>> from lxml.etree import fromstring, tostring
>>> xml = fromstring('<p id="1">text</p>')
>>> json.dumps(xmljson.badgerfish.data(xml))
'{"p": {"@id": 1, "$": "text"}}'
>>> xmljson.parker.etree({'ul': {'li': [1, 2]}})
# Creates [<ul><li>1</li><li>2</li></ul>] 
```

披露：我写了这个库。希望它对未来的搜索者有所帮助。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2018-05-12T08:17:18.023

如果有时您只得到**响应代码**而不是所有数据，那么会**出现像 json parse 这样的错误**，因此您需要将其转换为**文本**

```
import xmltodict

data = requests.get(url)
xpars = xmltodict.parse(data.text)
json = json.dumps(xpars)
print json 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2017-11-02T17:25:44.287

对于可能仍然需要这个的任何人。这是一个更新的、简单的代码来进行这种转换。

```
from xml.etree import ElementTree as ET

xml    = ET.parse('FILE_NAME.xml')
parsed = parseXmlToJson(xml)

def parseXmlToJson(xml):
  response = {}

  for child in list(xml):
    if len(list(child)) > 0:
      response[child.tag] = parseXmlToJson(child)
    else:
      response[child.tag] = child.text or ''

    # one-liner equivalent
    # response[child.tag] = parseXmlToJson(child) if len(list(child)) > 0 else child.text or ''

  return response 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-04-19T15:35:21.540

这是我为此构建的代码。没有内容解析，只是简单的转换。

```
from xml.dom import minidom
import simplejson as json
def parse_element(element):
    dict_data = dict()
    if element.nodeType == element.TEXT_NODE:
        dict_data['data'] = element.data
    if element.nodeType not in [element.TEXT_NODE, element.DOCUMENT_NODE, 
                                element.DOCUMENT_TYPE_NODE]:
        for item in element.attributes.items():
            dict_data[item[0]] = item[1]
    if element.nodeType not in [element.TEXT_NODE, element.DOCUMENT_TYPE_NODE]:
        for child in element.childNodes:
            child_name, child_dict = parse_element(child)
            if child_name in dict_data:
                try:
                    dict_data[child_name].append(child_dict)
                except AttributeError:
                    dict_data[child_name] = [dict_data[child_name], child_dict]
            else:
                dict_data[child_name] = child_dict 
    return element.nodeName, dict_data

if __name__ == '__main__':
    dom = minidom.parse('data.xml')
    f = open('data.json', 'w')
    f.write(json.dumps(parse_element(dom), sort_keys=True, indent=4))
    f.close() 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2011-06-10T02:48:15.637

有一种方法可以将基于 XML 的标记传输为 JSON，从而可以无损地将其转换回其原始形式。请参阅[http://jsonml.org/](http://jsonml.org/)。

它是一种 JSON 的 XSLT。我希望你觉得这对你有帮助

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2010-10-07T18:50:24.333

您可能想看看[http://designtheory.org/library/extrep/designdb-1.0.pdf](http://designtheory.org/library/extrep/designdb-1.0.pdf)。这个项目从一个大型 XML 文件库的 XML 到 JSON 转换开始。在转换过程中进行了大量研究，产生了最简单直观的 XML -> JSON 映射（在文档的前面有描述）。总之，将所有内容转换为 JSON 对象，并将重复块作为对象列表。

对象表示键/值对（Python 中的字典，Java 中的 hashmap，JavaScript 中的对象）

没有映射回 XML 以获取相同的文档，原因是，不知道键/值对是属性还是`<key>value</key>`，因此该信息丢失。

如果你问我，属性是一个技巧。然后他们再次为 HTML 工作得很好。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2012-04-18T01:24:21.060

我建议不要直接转换。将 XML 转换为对象，然后从对象转换为 JSON。

在我看来，这为 XML 和 JSON 如何对应提供了一个更清晰的定义。

正确处理需要时间，您甚至可以编写工具来帮助您生成其中的一些，但大致如下所示：

```
class Channel:
  def __init__(self)
    self.items = []
    self.title = ""

  def from_xml( self, xml_node ):
    self.title = xml_node.xpath("title/text()")[0]
    for x in xml_node.xpath("item"):
      item = Item()
      item.from_xml( x )
      self.items.append( item )

  def to_json( self ):
    retval = {}
    retval['title'] = title
    retval['items'] = []
    for x in items:
      retval.append( x.to_json() )
    return retval

class Item:
  def __init__(self):
    ...

  def from_xml( self, xml_node ):
    ...

  def to_json( self ):
    ... 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-10T14:30:59.193

好吧，可能最简单的方法就是将 XML 解析为字典，然后使用 simplejson 将其序列化。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2017-05-09T16:30:31.230

当我在 python 中使用 XML 做任何事情时，我几乎总是使用 lxml 包。我怀疑大多数人使用lxml。您可以使用 xmltodict 但您将不得不支付再次解析 XML 的代价。

要使用 lxml 将 XML 转换为 json，请执行以下操作：

1.  使用 lxml 解析 XML 文档
2.  将 lxml 转换为字典
3.  将列表转换为 json

我在我的项目中使用以下类。使用 toJson 方法。

```
from lxml import etree 
import json

class Element:
    '''
    Wrapper on the etree.Element class.  Extends functionality to output element
    as a dictionary.
    '''

    def __init__(self, element):
        '''
        :param: element a normal etree.Element instance
        '''
        self.element = element

    def toDict(self):
        '''
        Returns the element as a dictionary.  This includes all child elements.
        '''
        rval = {
            self.element.tag: {
                'attributes': dict(self.element.items()),
            },
        }
        for child in self.element:
            rval[self.element.tag].update(Element(child).toDict())
        return rval

class XmlDocument:
    '''
    Wraps lxml to provide:
        - cleaner access to some common lxml.etree functions
        - converter from XML to dict
        - converter from XML to json
    '''
    def __init__(self, xml = '<empty/>', filename=None):
        '''
        There are two ways to initialize the XmlDocument contents:
            - String
            - File

        You don't have to initialize the XmlDocument during instantiation
        though.  You can do it later with the 'set' method.  If you choose to
        initialize later XmlDocument will be initialized with "<empty/>".

        :param: xml Set this argument if you want to parse from a string.
        :param: filename Set this argument if you want to parse from a file.
        '''
        self.set(xml, filename) 

    def set(self, xml=None, filename=None):
        '''
        Use this to set or reset the contents of the XmlDocument.

        :param: xml Set this argument if you want to parse from a string.
        :param: filename Set this argument if you want to parse from a file.
        '''
        if filename is not None:
            self.tree = etree.parse(filename)
            self.root = self.tree.getroot()
        else:
            self.root = etree.fromstring(xml)
            self.tree = etree.ElementTree(self.root)

    def dump(self):
        etree.dump(self.root)

    def getXml(self):
        '''
        return document as a string
        '''
        return etree.tostring(self.root)

    def xpath(self, xpath):
        '''
        Return elements that match the given xpath.

        :param: xpath
        '''
        return self.tree.xpath(xpath);

    def nodes(self):
        '''
        Return all elements
        '''
        return self.root.iter('*')

    def toDict(self):
        '''
        Convert to a python dictionary
        '''
        return Element(self.root).toDict()

    def toJson(self, indent=None):
        '''
        Convert to JSON
        '''
        return json.dumps(self.toDict(), indent=indent)

if __name__ == "__main__":
    xml='''<system>
    <product>
        <demod>
            <frequency value='2.215' units='MHz'>
                <blah value='1'/>
            </frequency>
        </demod>
    </product>
</system>
'''
    doc = XmlDocument(xml)
    print doc.toJson(indent=4) 
```

内置**main**的输出是：

```
{
    "system": {
        "attributes": {}, 
        "product": {
            "attributes": {}, 
            "demod": {
                "attributes": {}, 
                "frequency": {
                    "attributes": {
                        "units": "MHz", 
                        "value": "2.215"
                    }, 
                    "blah": {
                        "attributes": {
                            "value": "1"
                        }
                    }
                }
            }
        }
    }
} 
```

这是此xml的转换：

```
<system>
    <product>
        <demod>
            <frequency value='2.215' units='MHz'>
                <blah value='1'/>
            </frequency>
        </demod>
    </product>
</system> 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-10T18:51:42.380

虽然用于 XML 解析的内置库非常好，但我偏爱[lxml](http://lxml.de/)。

但是对于解析 RSS 提要，我推荐[Universal Feed Parser](https://pypi.python.org/pypi/feedparser)，它也可以解析 Atom。它的主要优点是它甚至可以消化大多数畸形的饲料。

Python 2.6 已经包含一个 JSON 解析器，但是一个[具有更高速度的新版本](http://bob.pythonmac.org/archives/2008/09/29/simplejson-201/)作为[simplejson](http://simplejson.github.io/simplejson/)提供。

使用这些工具构建您的应用程序应该不会那么困难。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-04-04T13:06:42.230

我发现对于简单的 XML 剪辑，使用正则表达式会省事。例如：

```
# <user><name>Happy Man</name>...</user>
import re
names = re.findall(r'<name>(\w+)<\/name>', xml_string)
# do some thing to names 
```

正如@Dan 所说，通过 XML 解析来做到这一点，没有万能的解决方案，因为数据不同。我的建议是使用 lxml。虽然没有完成到 json，[lxml.objectify](http://lxml.de/objectify.html)给出了安静的好结果：

```
>>> from lxml import objectify
>>> root = objectify.fromstring("""
... <root xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
...   <a attr1="foo" attr2="bar">1</a>
...   <a>1.2</a>
...   <b>1</b>
...   <b>true</b>
...   <c>what?</c>
...   <d xsi:nil="true"/>
... </root>
... """)

>>> print(str(root))
root = None [ObjectifiedElement]
    a = 1 [IntElement]
      * attr1 = 'foo'
      * attr2 = 'bar'
    a = 1.2 [FloatElement]
    b = 1 [IntElement]
    b = True [BoolElement]
    c = 'what?' [StringElement]
    d = None [NoneElement]
      * xsi:nil = 'true' 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-10-20T10:38:21.313

**我的回答解决了您实际上并不需要将整个 xml 转换**为 json的特定（并且有些常见）情况，但您需要的是遍历/访问 xml 的特定部分，并且您需要它**快速**，并且**简单**（使用类似 json/dict 的操作）。

## 方法

为此，重要的是要注意将 xml 解析为 etree 使用`lxml`速度非常快。大多数其他答案的缓慢部分是第二遍：遍历 etree 结构（通常在 python-land 中），将其转换为 json。

这使我找到了最适合这种情况的方法：使用 解析 xml `lxml`，然后（懒惰地）包装 etree 节点，为它们提供类似 dict 的接口。

## 代码

这是代码：

```
from collections import Mapping
import lxml.etree

class ETreeDictWrapper(Mapping):

    def __init__(self, elem, attr_prefix = '@', list_tags = ()):
        self.elem = elem
        self.attr_prefix = attr_prefix
        self.list_tags = list_tags

    def _wrap(self, e):
        if isinstance(e, basestring):
            return e
        if len(e) == 0 and len(e.attrib) == 0:
            return e.text
        return type(self)(
            e,
            attr_prefix = self.attr_prefix,
            list_tags = self.list_tags,
        )

    def __getitem__(self, key):
        if key.startswith(self.attr_prefix):
            return self.elem.attrib[key[len(self.attr_prefix):]]
        else:
            subelems = [ e for e in self.elem.iterchildren() if e.tag == key ]
            if len(subelems) > 1 or key in self.list_tags:
                return [ self._wrap(x) for x in subelems ]
            elif len(subelems) == 1:
                return self._wrap(subelems[0])
            else:
                raise KeyError(key)

    def __iter__(self):
        return iter(set( k.tag for k in self.elem) |
                    set( self.attr_prefix + k for k in self.elem.attrib ))

    def __len__(self):
        return len(self.elem) + len(self.elem.attrib)

    # defining __contains__ is not necessary, but improves speed
    def __contains__(self, key):
        if key.startswith(self.attr_prefix):
            return key[len(self.attr_prefix):] in self.elem.attrib
        else:
            return any( e.tag == key for e in self.elem.iterchildren() )

def xml_to_dictlike(xmlstr, attr_prefix = '@', list_tags = ()):
    t = lxml.etree.fromstring(xmlstr)
    return ETreeDictWrapper(
        t,
        attr_prefix = '@',
        list_tags = set(list_tags),
    ) 
```

这个实现并不完整，例如，它不完全支持元素同时具有文本和属性或文本和子元素的情况（只是因为我在编写它时不需要它......）应该很容易不过，要改进它。

## 速度

在我的特定用例中，我只需要处理 xml 的特定元素，与使用 @Martin Blech 的[xmltodict](https://github.com/martinblech/xmltodict)然后直接遍历 dict相比，这种方法提供了**惊人的 70 倍（！）的加速。**

## 奖金

作为奖励，由于我们的结构已经类似于 dict，我们可以`xml2json`免费获得另一种替代实现。我们只需要将类似 dict 的结构传递给`json.dumps`. 就像是：

```
def xml_to_json(xmlstr, **kwargs):
    x = xml_to_dictlike(xmlstr, **kwargs)
    return json.dumps(x) 
```

如果您的 xml 包含属性，则需要使用一些字母数字`attr_prefix`（例如“ATTR_”），以确保键是有效的 json 键。

我没有对这部分进行基准测试。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2018-09-12T01:21:51.377

查看 lxml2json （披露：我写的）

[https://github.com/rparelius/lxml2json](https://github.com/rparelius/lxml2json)

它非常快速、轻量级（只需要 lxml），并且一个优点是您可以控制是否将某些元素转换为列表或 dicts

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2010-12-09T06:27:59.050

[jsonpickle](http://jsonpickle.github.com/)或者如果你使用 feedparser，你可以试试[feed_pa​​rser_to_json.py](http://www.silassewell.com/blog/2008/05/05/universal-feed-parser-json/)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-11-30T04:52:07.953

您可以使用 declxml。它具有多属性和复杂的嵌套支持等高级功能。你只需要为它写一个简单的处理器。同样使用相同的代码，您也可以转换回 JSON。它相当简单，文档很棒。

链接：[https ://declxml.readthedocs.io/en/latest/index.html](https://declxml.readthedocs.io/en/latest/index.html)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-08-24T07:09:54.300

如果您不想使用任何外部库和 3rd 方工具，请尝试以下代码。

**代码**

```
import re
import json

def getdict(content):
    res=re.findall("<(?P<var>\S*)(?P<attr>[^/>]*)(?:(?:>(?P<val>.*?)</(?P=var)>)|(?:/>))",content)
    if len(res)>=1:
        attreg="(?P<avr>\S+?)(?:(?:=(?P<quote>['\"])(?P<avl>.*?)(?P=quote))|(?:=(?P<avl1>.*?)(?:\s|$))|(?P<avl2>[\s]+)|$)"
        if len(res)>1:
            return [{i[0]:[{"@attributes":[{j[0]:(j[2] or j[3] or j[4])} for j in re.findall(attreg,i[1].strip())]},{"$values":getdict(i[2])}]} for i in res]
        else:
            return {res[0]:[{"@attributes":[{j[0]:(j[2] or j[3] or j[4])} for j in re.findall(attreg,res[1].strip())]},{"$values":getdict(res[2])}]}
    else:
        return content

with open("test.xml","r") as f:
    print(json.dumps(getdict(f.read().replace('\n','')))) 
```

**样本输入**

```
<details class="4b" count=1 boy>
    <name type="firstname">John</name>
    <age>13</age>
    <hobby>Coin collection</hobby>
    <hobby>Stamp collection</hobby>
    <address>
        <country>USA</country>
        <state>CA</state>
    </address>
</details>
<details empty="True"/>
<details/>
<details class="4a" count=2 girl>
    <name type="firstname">Samantha</name>
    <age>13</age>
    <hobby>Fishing</hobby>
    <hobby>Chess</hobby>
    <address current="no">
        <country>Australia</country>
        <state>NSW</state>
    </address>
</details> 
```

**输出**

```
[
  {
    "details": [
      {
        "@attributes": [
          {
            "class": "4b"
          },
          {
            "count": "1"
          },
          {
            "boy": ""
          }
        ]
      },
      {
        "$values": [
          {
            "name": [
              {
                "@attributes": [
                  {
                    "type": "firstname"
                  }
                ]
              },
              {
                "$values": "John"
              }
            ]
          },
          {
            "age": [
              {
                "@attributes": []
              },
              {
                "$values": "13"
              }
            ]
          },
          {
            "hobby": [
              {
                "@attributes": []
              },
              {
                "$values": "Coin collection"
              }
            ]
          },
          {
            "hobby": [
              {
                "@attributes": []
              },
              {
                "$values": "Stamp collection"
              }
            ]
          },
          {
            "address": [
              {
                "@attributes": []
              },
              {
                "$values": [
                  {
                    "country": [
                      {
                        "@attributes": []
                      },
                      {
                        "$values": "USA"
                      }
                    ]
                  },
                  {
                    "state": [
                      {
                        "@attributes": []
                      },
                      {
                        "$values": "CA"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  {
    "details": [
      {
        "@attributes": [
          {
            "empty": "True"
          }
        ]
      },
      {
        "$values": ""
      }
    ]
  },
  {
    "details": [
      {
        "@attributes": []
      },
      {
        "$values": ""
      }
    ]
  },
  {
    "details": [
      {
        "@attributes": [
          {
            "class": "4a"
          },
          {
            "count": "2"
          },
          {
            "girl": ""
          }
        ]
      },
      {
        "$values": [
          {
            "name": [
              {
                "@attributes": [
                  {
                    "type": "firstname"
                  }
                ]
              },
              {
                "$values": "Samantha"
              }
            ]
          },
          {
            "age": [
              {
                "@attributes": []
              },
              {
                "$values": "13"
              }
            ]
          },
          {
            "hobby": [
              {
                "@attributes": []
              },
              {
                "$values": "Fishing"
              }
            ]
          },
          {
            "hobby": [
              {
                "@attributes": []
              },
              {
                "$values": "Chess"
              }
            ]
          },
          {
            "address": [
              {
                "@attributes": [
                  {
                    "current": "no"
                  }
                ]
              },
              {
                "$values": [
                  {
                    "country": [
                      {
                        "@attributes": []
                      },
                      {
                        "$values": "Australia"
                      }
                    ]
                  },
                  {
                    "state": [
                      {
                        "@attributes": []
                      },
                      {
                        "$values": "NSW"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
] 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2021-02-23T20:45:22.713

不久前我在github上发表了一篇..

[https://github.com/davlee1972/xml_to_json](https://github.com/davlee1972/xml_to_json)

此转换器是用 Python 编写的，会将一个或多个 XML 文件转换为 JSON / JSONL 文件

它需要一个 XSD 模式文件来确定嵌套的 json 结构（字典与列表）和 json 等效数据类型。

```
python xml_to_json.py -x PurchaseOrder.xsd PurchaseOrder.xml

INFO - 2018-03-20 11:10:24 - Parsing XML Files..
INFO - 2018-03-20 11:10:24 - Processing 1 files
INFO - 2018-03-20 11:10:24 - Parsing files in the following order:
INFO - 2018-03-20 11:10:24 - ['PurchaseOrder.xml']
DEBUG - 2018-03-20 11:10:24 - Generating schema from PurchaseOrder.xsd
DEBUG - 2018-03-20 11:10:24 - Parsing PurchaseOrder.xml
DEBUG - 2018-03-20 11:10:24 - Writing to file PurchaseOrder.json
DEBUG - 2018-03-20 11:10:24 - Completed PurchaseOrder.xml 
```

我还有一个后续的 xml 到镶木地板转换器，它以类似的方式工作

[https://github.com/blackrock/xml_to_parquet](https://github.com/blackrock/xml_to_parquet)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-02-09T16:43:09.527

这里的这些东西是积极维护的，到目前为止是我最喜欢的：[python中的xml2json](https://github.com/hay/xml2json)

# c# - VS2005 C# Currency Manager 问题，头寸不变

> ID：191549
> 
> 赞同：1
> 
> 时间：2008-10-10T14:22:22.253
> 
> 标签：c#, .net, winforms

我们有一个绑定到列表框控件的自定义对象集合。当一个项目被添加到列表中时，该项目出现在列表框中，但是当一个人选择该项目时，货币经理职位将不会转到该职位。相反，货币经理职位保持在现有职位。只要按下鼠标，列表框项目就会高亮显示，但是 cm 永远不会改变位置。

如果我复制其中一个集合对象，则列表框可以正常运行。

另一个注意事项该集合中也有集合，不确定这是否会成为问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T14:42:51.133

在花了太多时间之后，我发现了这个问题......

此问题与绑定到日期选择器控件的集合中的项目（自定义类）的属性之一有关。类的构造函数从不将值设置为默认值。

这导致货币经理不允许更改头寸，因为特定属性（绑定到日期选择器）无效。

我坏！我更懂！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T14:38:57.070

您可能需要发布一些代码；以下（仅由 CM 将两个列表捆绑在一起）表明它工作正常......所以要找到错误，我们可能需要一些代码。

```
using System;
using System.ComponentModel;
using System.Windows.Forms;
static class Program
{
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        BindingList<Foo> foos = new BindingList<Foo>();
        foos.Add(new Foo("abc"));
        foos.Add(new Foo("def"));

        ListBox lb1 = new ListBox(), lb2 = new ListBox();
        lb1.DataSource = lb2.DataSource = foos;
        lb1.DisplayMember = lb2.DisplayMember = "Bar";
        lb1.Dock = DockStyle.Left;
        lb2.Dock = DockStyle.Right;

        Button b = new Button();
        b.Text = "Add";
        b.Dock = DockStyle.Top;
        b.Click += delegate
        {
            foos.Add(new Foo("new item"));
        };
        Form form = new Form();
        form.Controls.Add(lb1);
        form.Controls.Add(lb2);
        form.Controls.Add(b);
        Application.Run(form);
    }

}
class Foo
{
    public Foo(string bar) {this.Bar = bar;}
    private string bar;
    public string Bar {
        get {return bar;}
        set {bar = value;}
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T14:37:46.153

集合没有“当前项目”的感觉。也许您的自定义集合可以，但`ListBox`没有使用它。它在集合中有自己的“当前项目”索引。您需要处理`SelectedIndexChanged`事件以使它们保持同步。

# mysql - 向 MBA 教授 Microsoft SQL Server 的复杂性（以及它与 MySQL 有何不同？）

> ID：191565
> 
> 赞同：0
> 
> 时间：2008-10-10T14:24:58.393
> 
> 标签：mysql, sql-server

在我的开发生涯中，我不必与 MSSQL 进行太多交互，尽管我已经花了很多小时使用 MySQL。

我的一个 MBA 朋友正在开始一份工作，她需要获得 MSSQL Server 的功能知识，我真的很想帮忙。

**MSSQL 和 MySQL 有什么区别？**

**你会如何推荐一个非技术人员去学习 MSSQL Server 的起起落落？**

* * *

[更新] 以前的数据库设计技巧一无是处。我已经让她从高层次上对数据库的作用进行了简短和详细的介绍。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T14:33:20.217

我很想说，“你不能”。但那将是不真实的（或至少意味着）。

如果她有任何数据库设计背景，那么这只是一个新的 RDBMS。

如果她从未做过数据库设计，那么在我看来，开始的地方与其说是 MS SQL，不如说是数据库的工作原理。

*Database Design for Mere Mortals*是一个很好的起点。从那里我会转向 MS SQL 特定的书，例如*Microsoft SQL Server Unleashed*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T14:46:58.613

[下载免费的 SQL Express](http://www.microsoft.com/express/sql/default.aspx)并开始使用它。Microsoft 还提供[了一些有用的视频教程](http://www.asp.net/learn/sql-videos/)。他们几乎从“什么是数据库”开始，然后转向更高级的主题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T15:51:13.213

从数据库用户的角度来看，如果他们了解一些基本概念，后端通常是无关紧要的。

对于非技术用户来说，第一个也是最重要的概念是 GIGO（Garbage in Garbage out）。坏数据是无用的数据。检查您输入数据库的所有内容是否正确。您真的不希望将客户的产品邮寄到弗吉尼亚州的圣地亚哥而不是加利福尼亚州。

然后下一个最重要的事情是真正了解您的用户界面及其工作原理。我花了很多时间来修复垃圾邮件，因为用户不知道他们应该在数据库中的字段中输入什么（如果开发人员不允许在电子邮件字段中输入非电子邮件类型的数据，那将会有所帮助，但您不能向 757-111-6789 发送电子邮件）。将错误类型的数据放入字段绝不是一个好主意，因为您没有其他地方可以放置它。作为用户，您可能不知道数据库会将这些数据用于什么目的，错误的数据可能会完全停止进程或破坏某些非常重要的东西。如果您不知道在字段中放置什么，请询问。不要仅仅因为它是必需的就将垃圾放入字段中。（提示，这是有原因的，

现在，如果这个人在做报告，那么关键概念就变成了理解布尔代数和对连接有很强的理解。如果您掌握了这两个概念，那么您就拥有了查询数据库所需的 80-90%。

支持的数据库的细节也变得很重要。您需要了解存储在哪些表（或要使用的视图）中的内容以及它们之间的关系。进入一份新工作后，如果可能的话，我会与开发人员坐下来，了解设计的概况以及获取数据需要了解的内容。我会查看现有的报告查询以了解当前如何检索数据，并在我不了解此人所做的事情时使用它来提问。即使是数据库专家在面对新数据库时也需要花一些时间来做这件事，所以当你是新手时，没有理由羞于问这些问题。

最后一件事是学习如何向开发人员报告问题。未报告的问题不会得到解决！由于用户没有提供屏幕截图和错误发生时她正在做什么的上下文而无法重现的问题，也不会得到修复。随着业务需求变化而需要的新数据字段，在开发人员了解它们之前不要添加到数据库中（如果您需要，请询问备注字段，而不是将垃圾数据输入到您个人的电子邮件等字段中例如不使用）。新的业务需求通常需要在后端进行大量工作来改变工作方式，这并不像在表单上添加字段那么简​​单。当您提出请求时，请也注意这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T18:13:17.950

I learned from Robert Vieira's **Professional SQL Server 2000 Programming** -- well written and comprehensive. I am pretty sure the 2005 version is very similar, just updated. Despite the 'professional' label, I found it a great intro (I had practically no database experience at the time).

Also I second Erikk's comment. Download SQL Express and PLAY!

# ruby - Ruby 元编程问题

> ID：191567
> 
> 赞同：5
> 
> 时间：2008-10-10T14:25:13.200
> 
> 标签：ruby, metaprogramming

我正在查看 Ruby 日志记录库 Logging.logger 方法，并且[在 github 的源代码中](http://github.com/TwP/logging/tree/master/lib/logging.rb)有一个与这段代码相关的问题：

```
 logger = ::Logging::Logger.new(name)
  logger.add_appenders appender
  logger.additive = false

  class << logger
    def close
      @appenders.each {|a| a.close}
      h = ::Logging::Repository.instance.instance_variable_get :@h
      h.delete(@name)
      class << self; undef :close; end
    end
  end 
```

我知道类 << logger 向 logger 对象打开了 eigen/meta/singleton 类以添加实例特定的关闭方法。但是，我不确定“class << self; undef :close; end” 的作用和目的。谁能告诉我这是什么意思？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-10T14:39:31.313

这实际上删除了方法（当它实际执行时）。这是确保 close 不会被调用两次的保障措施。看起来有嵌套的 'class << ' 构造，但没有。调用方法时执行内部类<<，定义方法时调用外部类<<。

# java - 如何在全屏独占模式下摆脱鼠标光标？

> ID：191592
> 
> 赞同：5
> 
> 时间：2008-10-10T14:31:02.500
> 
> 标签：java, mouse, fullscreen, mouse-cursor

我正在使用 Java 开发一个简单的 2D 游戏引擎，并且在 FSEM、缓冲策略等方面没有遇到任何问题；我的问题是鼠标光标。在窗口模式下，我可以隐藏鼠标光标，没问题，通过使用我的 JFrame 中的 setCursor() 来设置一个完全透明的光标。但是，在调用 device.setFullScreenWindow(this) 进入 FSEM 后，鼠标光标又回来了，随后调用 setCursor() 将其设置回我的空白光标没有任何效果。调用 device.setFullScreenWindow(null) 可以让我再次摆脱光标 - 只有当我在 FSEM 中时，我才能摆脱它。

我在 JDK 6 下工作，目标平台是 JDK 5+。

**更新：**我做了一些更多的测试，看起来这个问题发生在 MacOS X 10.5 w/Java 6u7 下，而不是在 Windows XP SP3 和 Java 6u7 下。因此，它可能是 Mac 版本的 JVM 中的错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-11-10T04:21:07.530

尝试创建一个自定义的不可见光标：

```
 Toolkit toolkit = Toolkit.getDefaultToolkit();
    Point hotSpot = new Point(0,0);
    BufferedImage cursorImage = new BufferedImage(1, 1, BufferedImage.TRANSLUCENT); 
    Cursor invisibleCursor = toolkit.createCustomCursor(cursorImage, hotSpot, "InvisibleCursor");        
    setCursor(invisibleCursor); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T16:12:37.677

一位开发人员通过从透明 GIF 中创建一个像素光标找到了解决方法。

[http://sevensoft.livejournal.com/23460.html](http://sevensoft.livejournal.com/23460.html)

我知道您尝试过，但正如您所说，他专门解决了全屏模式的问题，所以也许他做了一些您没有做过的事情。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-15T17:42:13.547

我想我终于找到了解决方案：

```
System.setProperty("apple.awt.fullscreenhidecursor","true"); 
```

这是 Apple 专有的系统属性，当应用程序处于全屏模式时隐藏鼠标光标。这是我找到修复它的唯一方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-22T16:21:16.883

这是对我有用的：

```
Toolkit toolkit = Toolkit.getDefaultToolkit();

// get the smallest valid cursor size
Dimension dim = toolkit.getBestCursorSize(1, 1);

// create a new image of that size with an alpha channel
BufferedImage cursorImg = new BufferedImage(dim.width, dim.height, BufferedImage.TYPE_INT_ARGB);

// get a Graphics2D object to draw to the image
Graphics2D g2d = cursorImg.createGraphics();

// set the background 'color' with 0 alpha and clear the image
g2d.setBackground(new Color(0.0f, 0.0f, 0.0f, 0.0f));
g2d.clearRect(0, 0, dim.width, dim.height);

// dispose the Graphics2D object
g2d.dispose();

// now create your cursor using that transparent image
hiddenCursor = toolkit.createCustomCursor(cursorImg, new Point(0,0), "hiddenCursor"); 
```

当然，我还没有在 Mac 上测试过它，只有 Windows。但是当我使用常用​​方法时，我将光标设置为黑框，所以我使用上面的代码创建一个透明框并将其设置为光标。当然，您必须在 AWT 对象（例如您的应用程序的 Frame）上使用 setCursor 方法来设置此 hiddenCursor。这是我的 hideMouse 方法（'fr' 是我的框架）：

```
public void hideMouse(boolean hide) {
    if(hide) {
        fr.setCursor(hiddenCursor);
    } else {
        fr.setCursor(Cursor.getDefaultCursor());
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T14:37:04.907

我不知道这些知识是否适用，但在一个旧的 VB6 应用程序中我遇到了同样的问题，我摆脱了它，将光标移出屏幕，给它一些非常大的值。
希望能帮助到你。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T19:55:52.203

如果您仅在 Windows 上运行，您似乎需要通过 JNI 调用 ShowCursor(FALSE)。至少，要使光标隐藏完整。

这是一些创建 1x1 光标的代码。它对我有用，虽然我仍然得到一个 1x1 光标。

```
 Toolkit toolkit = Toolkit.getDefaultToolkit();
 Dimension dim = toolkit.getBestCursorSize(1,1);
 transCursor = toolkit.createCustomCursor(gc.createCompatibleImage(dim.width, dim.height),
     new Point(0, 0), "transCursor");
 ((Component)mainFrame).setCursor(transCursor); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T20:43:51.733

专门针对您的 Mac 问题，通过 JNI，您可以使用以下内容：

[石英显示服务参考 - CGDisplayHideCursor](http://developer.apple.com/documentation/GraphicsImaging/Reference/Quartz_Services_Ref/Reference/reference.html#//apple_ref/c/func/CGDisplayHideCursor)

# entity-framework - db schema 完整，Entity Framework 可以生成 Storage Schema 吗？

> ID：191597
> 
> 赞同：0
> 
> 时间：2008-10-10T14:32:08.753
> 
> 标签：entity-framework

如果我已经完成了数据库架构，实体框架能否以某种方式为我生成存储架构？

或者，如果我开发了类，它是否可以生成其他描述类及其关系的 xml？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T14:36:08.497

大多数可以是的......我相信你会寻找的是休眠工具（tools.hibernate.com）。Toplink 和其他框架应该具有等效的功能。您本质上提供登录/数据库提供程序信息，它会查询目录并生成 xml 和类

# permissions - 在 Windows 中编写错误日志的最佳位置在哪里？

> ID：191609
> 
> 赞同：12
> 
> 时间：2008-10-10T14:33:21.093
> 
> 标签：permissions, error-logging

你会在哪里写一个错误日志文件，比如说`ErrorLog.txt`，在 Windows 中？请记住，路径需要对基本用户开放以获得文件写入权限。

我知道事件日志可能是写入错误的位置，但它是否适用于“用户”级别的权限？

编辑：我的目标是 Windows 2003，但我提出问题的方式是有一个“一般指南”​​来说明在哪里写入错误日志。
至于事件日志，我以前在一个 ASP.NET 应用程序中遇到过问题，我想在其中记录到 Windows 事件日志，但我遇到了让我心痛的安全问题。（我不记得我遇到的问题，但记得有这些问题。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-10T14:36:04.423

您是否考虑过记录事件查看器？如果你想写自己的日志，我建议用户本地应用设置目录。在下面创建一个产品目录。它在不同版本的 Windows 上有所不同。

在 Vista 上，您不能将这样的文件放在 c:\program 文件下。你会遇到很多问题。

在 .NET 中，您可以使用以下命令找到此文件夹：

```
Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) 
```

并且事件日志使用起来也相当简单：

[http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-11T11:49:16.977

文本文件非常适合服务器应用程序（您确实说过 Windows 2003）。您应该为每个服务器应用程序有一个单独的日志文件，该位置实际上是与管理员达成一致的约定问题。例如，对于 ASP.NET 应用程序，我经常看到它们被放置在与应用程序不同的磁盘上，位于模拟虚拟目录结构的文件夹结构下。

对于客户端应用程序，文本文件的一个缺点是用户可能会启动应用程序的多个副本（除非您已采取特定步骤来防止这种情况发生）。因此，如果多个实例尝试写入同一个日志文件，就会出现争用问题。出于这个原因，我总是更喜欢客户端应用程序的 Windows 事件日志。需要注意的是，您需要成为管理员才能创建事件日志——这可以通过安装程序包来完成。

如果您确实使用文件，我建议使用文件夹 Environment.SpecialFolder。**本地**ApplicationData 而不是其他人建议的 SpecialFolder.ApplicationData 。LocalApplicationData 在本地磁盘上：当用户有漫游配置文件时，您不希望网络问题阻止您登录。对于 WinForms 应用程序，请使用 Application.LocalUserAppDataPath。

无论哪种情况，我都会使用配置文件来决定在哪里记录，以便您可以轻松更改它。例如，如果您使用 Log4Net 或类似的框架，您可以轻松配置是否记录到文本文件、事件日志、两者或其他地方（例如数据库），而无需更改您的应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T14:36:31.507

就个人而言，我建议使用 Windows 事件日志，这很棒。如果不能，则将文件写入 ApplicationData 目录或 ProgramData（Windows XP 上所有用户的应用程序数据）目录。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-10T14:43:42.460

标准位置是：

```
C:\Documents and Settings\All Users\Application Data\MyApp 
```

或者

```
C:\Documents and Settings\%Username%\Application Data\MyApp 
```

(aka `%UserProfile%\Application Data\MyApp`) 这将符合您的*用户级别*权限要求。它还分隔不同用户创建的日志。

使用*.NET*运行时，这些可以构建为：

```
AppDir=
  System.Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData) 
```

或者

```
AppDir=
  System.Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) 
```

其次是：

```
MyAppDir = IO.Path.Combine(AppDir,'MyApp') 
```

（希望也能映射*Vista*配置文件）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-10T14:44:10.460

Windows 事件日志绝对是记录错误的方法。您不限于“应用程序”日志，因为可以创建新的日志目标（例如“我的应用程序”）。这可能需要作为设置的一部分来完成，因为我不确定它是否需要管理权限。在[http://support.microsoft.com/kb/307024](http://support.microsoft.com/kb/307024)有一个 C# 中的 Microsoft 示例。

Windows 2008 还具有[事件日志转发](http://technet.microsoft.com/en-us/library/cc771823.aspx)功能，这对于服务器应用程序来说非常方便。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-19T00:10:28.703

我同意 Lou 的观点，但我更喜欢像 Joe 所说的那样在配置文件中进行设置。您可以使用

文件值="${APPDATA}/Test/log-file.txt"

（“测试”可以是您想要的任何内容，也可以完全删除），这会导致日志文件写入 Windows XP 上的“/Documents and Settings/LoginUser/Application Data/Test”和“/Users/ Windows Vista 上的登录用户/应用程序数据/漫游/测试。

我只是添加了这个，因为我花了太多时间来弄清楚如何在 Windows Vista 上进行这项工作......

这适用于 Windows 应用程序。要在 Web 应用程序中使用日志记录，我发现 Phil Haack 的博客条目是一个很好的资源： [http ://haacked.com/archive/2005/03/07/ConfiguringLog4NetForWebApplications.aspx](http://haacked.com/archive/2005/03/07/ConfiguringLog4NetForWebApplications.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T14:34:58.733

%TEMP% 始终是我找到的日志的好位置。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-11T11:24:43.313

在这里违背粮食 - 这取决于你需要做什么。有时您需要操纵结果，所以 log.txt 是要走的路。它简单、可变且易于搜索。

以乔尔为例。Fogbugz 将通过 http 向他们的服务器发送错误消息的日志/转储。您也可以这样做，而不必担心用户对其驱动器的访问权限。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-12-22T15:48:34.797

我个人不喜欢在我现在所在的位置使用 Windows 事件日志，因为我们无权访问生产服务器，这意味着我们每次想要查看错误时都需要请求访问权限。不幸的是，这不是一个快速的过程，因此您的故障排除完全由等待其他人完成。我也不喜欢他们在其他应用程序中迷失方向。当然你可以排序，但这只是向下滚动的一个细微差别。您使用的最终将是个人偏好以及您工作环境的限制的组合。（日志文件、事件日志或数据库）

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2008-10-10T14:35:47.030

把它放在应用程序的目录中。用户需要访问该文件夹才能运行和执行应用程序，您可以在应用程序启动时检查写入权限。

事件日志很难用于故障排除，但您仍然应该在那里发布重大错误。

编辑 - 如果您使用.NET，您应该查看 MS 应用程序块以进行日志记录。他们真的让生活变得轻松。

Jeez 业力杀手。下次当发帖人发布不完整的帖子时，我什至不会提供建议。

# c++ - 如何在开发过程中检测代码重复？

> ID：191614
> 
> 赞同：85
> 
> 时间：2008-10-10T14:34:27.190
> 
> 标签：c++, code-duplication

我们有一个相当大的代码库，400K LOC 的 C++，代码重复是个问题。是否有任何工具可以有效地检测重复的代码块？

理想情况下，这将是开发人员可以在开发过程中使用的东西，而不是偶尔运行以查看问题所在。如果我们可以将这样的工具与 CruiseControl 集成，以便在每次签到后提供报告，那也很好。

前段时间我看过[Duploc](http://www.iam.unibe.ch/~scg/Research/Duploc/index.html)，它显示了一个很好的图表，但需要一个 smalltalk 环境才能使用它，这使得自动运行它相当困难。

免费工具会很好，但如果有一些好的商业工具我也会感兴趣。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-10T14:40:56.007

[Simian](http://www.harukizaemon.com/simian/)检测 C++ 项目中的重复代码。

更新：也适用于 Java、C#、C、COBOL、Ruby、JSP、ASP、HTML、XML、Visual Basic、Groovy 源代码甚至纯文本文件

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-11-24T17:12:54.837

我使用[了 PMD 的 Copy-and-Paste-Detector](http://pmd.sourceforge.net/pmd-4.2.5/cpd.html)并通过使用以下包装脚本将其集成到 CruiseControl 中（确保在类路径中有 pmd jar）。

我们的支票每晚运行一次。如果您希望将输出限制为仅列出当前更改集中的文件，则可能需要一些自定义编程（想法：检查全部并仅列出涉及已更改文件之一的重复项。您必须检查所有文件，因为更改可以使用来自未更改文件的一些代码）。应该可以通过使用 XML 输出并解析结果来实现。完成后不要忘记发布该脚本；）

对于初学者，“文本”输出应该没问题，但您会希望以用户友好的方式显示结果，为此我使用 perl 脚本从 CPD 的“xml”输出生成 HTML 文件。这些可以通过将它们发布到 Cruise 的报告 jsp 所在的 tomcat 来访问。开发人员可以从那里查看它们并查看其肮脏的黑客攻击的结果:)

它运行得非常快，在 150 KLoc 代码上不到 2 秒（空行和注释不计入该数字）。

**重复检查.xml**：

```
<project name="duplicatecheck" default="cpd">

<property name="files.dir" value="dir containing your sources"/>
<property name="output.dir" value="dir containing results for publishing"/>

<target name="cpd">
    <taskdef name="cpd" classname="net.sourceforge.pmd.cpd.CPDTask"/>
    <cpd minimumTokenCount="100" 
         language="cpp" 
         outputFile="${output.dir}/duplicates.txt"
         ignoreLiterals="false"
         ignoreIdentifiers="false"
         format="text">
        <fileset dir="${files.dir}/">
            <include name="**/*.h"/>
            <include name="**/*.cpp"/>
                <!-- exclude third-party stuff -->
            <exclude name="boost/"/>
            <exclude name="cppunit/"/>
        </fileset>
    </cpd>
</target> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-17T04:54:12.637

[duplo](http://duplo.giants.ch/)似乎是 Duploc 中使用的算法的 C 实现。编译和安装很简单，虽然选项有限，但它似乎或多或少是开箱即用的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-03-13T22:04:33.160

这些 Debian 软件包似乎做了以下*事情*：

*   [相似度测试器](http://packages.debian.org/sid/similarity-tester)（也称为[软件和文本相似度测试器 SIM](http://dickgrune.com/Programs/similarity_tester/)）

*   [simhash](http://packages.debian.org/sid/simhash)

PS 对于所有与查找 [near] 重复相关的工具，都应该有一个[debtags](http://debtags.debian.net)标签。（但它会叫什么？）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-10T14:43:34.957

查看[PMD 项目](http://pmd.sourceforge.net/)。

我从来没有用过，但一直想用。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-28T19:27:51.353

好吧，你可以每晚在你的源代码库上运行一个克隆检测器。

*许多克隆检测器通过比较源代码行来工作，并且只能找到完全相同的重复代码。*

上面的 CCFinder 通过比较语言标记来工作，因此它对空白更改不敏感。如果只有单个标记更改（例如，将克隆中的变量 X 更改为 Y），它可以检测作为原始代码变体的克隆。

*理想情况下，您想要的是上述内容，但能够找到允许变化相对任意的克隆，例如，用表达式替换变量，用块替换语句等。*

我们的 CloneDR 克隆检测器针对 Java、C#、C++、COBOL、VB.net、VB6、Fortran 和各种其他语言执行此操作。可见： [http ://www.semdesigns.com/Products/Clone/index.html](http://www.semdesigns.com/Products/Clone/index.html)

除了能够处理多种语言之外，CloneDR 引擎还能够处理各种输入编码样式，包括 ASCII、ISO-8859-1、UTF8、UTF16、EBCDIC、许多 Microsoft 编码和（日语）Shift-日标。

该站点有多个克隆检测运行示例报告，包括一份针对 C++ 的报告。

编辑 2014 年 2 月：现在处理所有 C++14。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-11T04:55:41.257

[CCFinderX](http://www.ccfinder.net/ccfinderx.html)是一个免费的（供内部使用）克隆代码检测器，支持多种编程语言（Java、C、C++、COBOL、VB、C#）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-08-03T14:48:37.667

[ConQAT](https://www.conqat.org/)是一个很棒的工具，它支持 C++ 代码分析。可以找到忽略空格的重复项。具有非常方便的 gui 和控制台界面。由于它的灵活性，它不容易设置。我发现[这篇博文对于设置 c++ 项目非常有用](http://amr-noaman.blogspot.com/2013/04/detect-exact-and-similar-code.html)。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-08-25T16:10:39.957

Same ( [http://sourceforge.net/projects/same/](http://sourceforge.net/projects/same/) ) 非常简单，但它适用于文本行而不是标记，如果您使用的语言不受更高级的克隆之一支持，这很有用发现者。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-07-31T16:12:31.923

您可以使用我们的[SourceMeter](https://www.sourcemeter.com/)工具来检测代码重复。它是一个命令行工具（与编译器非常相似），因此您可以轻松地将其集成到持续集成工具中，例如您提到的[CruiseControl或](http://cruisecontrol.sourceforge.net/)[Jenkins](https://jenkins-ci.org/)。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-24T17:25:06.700

查找“相同”的代码片段相对容易，现有的工具已经可以做到这一点（参见其他答案）。

有时这是一件好事，有时不是；如果在“级别”太精细，它可能会拖慢开发时间；即试图重构这么多代码，你会失去你的目标（并且可能破坏你的里程碑和时间表）。

更难的是在没有适当文档的情况下找到多个功能/方法，它们做同样的事情但具有不同（但相似）的输入和/或算法。

如果您必须使用两种或不同的方法来做同样的事情，而程序员尝试修复一个实例但忘记（或不知道它们存在）修复其他实例，您将增加软件的风险。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-07-15T22:18:53.353

还有支持 Java、C#、C++、C、Objective-C、JavaScript 的[Simian](http://www.redhillconsulting.com.au/products/simian/) ...

*Hudson*支持它（如 CPD）。

除非你是一个开源项目，否则你必须为 Simian*付费*。

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2008-11-17T16:20:28.750

[TeamCity](http://www.jetbrains.com/teamcity/)有一个强大的 .NET 和 java 代码复制引擎，可以毫不费力地作为构建系统的一部分运行。

# c# - C# - Java 互操作

> ID：191622
> 
> 赞同：3
> 
> 时间：2008-10-10T14:35:27.593
> 
> 标签：c#, java, interop

你能给我一些关于使 C# 代码和 Java 代码互操作的建议吗？让我们将互操作定义为简单的事情：允许（从 Java 代码）对 C# 中定义的类进行实例化和方法调用，也可能反过来。

这甚至可以在*本地*实现吗？（即没有一些代理/骨架接口机制）

最后，可以使用哪些代理机制？（即两种语言领域都支持）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T14:37:17.107

我已经使用[IKVM](http://www.ikvm.net/)成功完成了这项工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T14:43:01.073

我在[这里](http://www.codeproject.com/KB/dotnet/Espresso.aspx)找到了一篇关于 CodeProject 的非常有前途的文章。

摘自文章介绍：

> 建议的解决方案将展示这两个框架如何在同一进程中共同存在并相互无缝通信。
> 
> 本文介绍了 Java 平台和 .NET Framework 之间的高性能互操作性解决方案。建议的解决方案不会替换 Java 虚拟机或 .NET Framework 运行时，而是将您的 JVM 或 .NET 分别托管在相反的运行时环境中，从而确保保留特定于供应商的 VM 优化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T18:40:38.237

不知道在 .NET 方面需要做什么（我不是 .NET 人），但 Java 提供了 JNI 框架来与本机库进行互操作。

[从Wikipedia](http://en.wikipedia.org/wiki/Java_Native_Interface)开始，然后点击链接...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-31T18:47:54.570

我是[jni4net](http://jni4net.sf.net/)的作者，它是 JVM 和 CLR 之间的开源进程间桥梁。它建立在 JNI 和 PInvoke 之上。无需 C/C++ 代码。我希望它会帮助你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T14:43:42.083

有一些第三方产品可以本地进行 .NET-Java 互操作。[J-Integra](http://j-integra.intrinsyc.com/)是我最熟悉的（我不为他们工作，也对他们没有任何经济利益）。

如果您对代理之类的东西没问题，那么您有一些选择，例如 SOAP/Web 服务或 CORBA。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T18:46:40.410

一个快速的[谷歌搜索](http://www.google.com/search?q=java+.net)在“Java + .NET 集成场景”上找到[这个页面](http://www.infoq.com/j+n/)

# sql - 确定Oracle null == null

> ID：191640
> 
> 赞同：46
> 
> 时间：2008-10-10T14:37:54.843
> 
> 标签：sql, oracle, null, nullable

我希望在可为空的列上搜索数据库表。有时我要搜索的值本身就是 NULL。由于 Null 等于无，甚至 NULL，说

```
where MYCOLUMN=SEARCHVALUE 
```

将失败。现在我不得不求助于

```
where ((MYCOLUMN=SEARCHVALUE) OR (MYCOLUMN is NULL and SEARCHVALUE is NULL)) 
```

有没有更简单的说法？

（如果这很重要，我正在使用 Oracle）

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-10-10T14:42:06.330

你可以做 IsNull 或 NVL 的东西，但这只会让引擎做更多的工作。您将调用函数来进行列转换，然后必须比较结果。

使用你所拥有的

```
where ((MYCOLUMN=SEARCHVALUE) OR (MYCOLUMN is NULL and SEARCHVALUE is NULL)) 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-10-10T16:12:03.653

@Andy Lester 断言查询的原始形式比使用 NVL 更有效。我决定测试这个断言：

```
 SQL> DECLARE
      2    CURSOR B IS
      3       SELECT batch_id, equipment_id
      4         FROM batch;
      5    v_t1  NUMBER;
      6    v_t2  NUMBER;
      7    v_c1  NUMBER;
      8    v_c2  NUMBER;
      9    v_b   INTEGER;
     10  BEGIN
     11  -- Form 1 of the where clause
     12    v_t1 := dbms_utility.get_time;
     13    v_c1 := dbms_utility.get_cpu_time;
     14    FOR R IN B LOOP
     15       SELECT COUNT(*)
     16         INTO v_b
     17         FROM batch
     18        WHERE equipment_id = R.equipment_id OR (equipment_id IS NULL AND R.equipment_id IS NULL);
     19    END LOOP;
     20    v_t2 := dbms_utility.get_time;
     21    v_c2 := dbms_utility.get_cpu_time;
     22    dbms_output.put_line('For clause: WHERE equipment_id = R.equipment_id OR (equipment_id IS NULL AND R.equipment_id IS NULL)');
     23    dbms_output.put_line('CPU seconds used: '||(v_c2 - v_c1)/100);
     24    dbms_output.put_line('Elapsed time: '||(v_t2 - v_t1)/100);
     25  
     26  -- Form 2 of the where clause
     27    v_t1 := dbms_utility.get_time;
     28    v_c1 := dbms_utility.get_cpu_time;
     29    FOR R IN B LOOP
     30       SELECT COUNT(*)
     31         INTO v_b
     32         FROM batch
     33        WHERE NVL(equipment_id,'xxxx') = NVL(R.equipment_id,'xxxx');
     34    END LOOP;
     35    v_t2 := dbms_utility.get_time;
     36    v_c2 := dbms_utility.get_cpu_time;
     37    dbms_output.put_line('For clause: WHERE NVL(equipment_id,''xxxx'') = NVL(R.equipment_id,''xxxx'')');
     38    dbms_output.put_line('CPU seconds used: '||(v_c2 - v_c1)/100);
     39    dbms_output.put_line('Elapsed time: '||(v_t2 - v_t1)/100);
     40  END;
     41  /

    For clause: WHERE equipment_id = R.equipment_id OR (equipment_id IS NULL AND R.equipment_id IS NULL)
    CPU seconds used: 84.69
    Elapsed time: 84.8
    For clause: WHERE NVL(equipment_id,'xxxx') = NVL(R.equipment_id,'xxxx')
    CPU seconds used: 124
    Elapsed time: 124.01

    PL/SQL procedure successfully completed

    SQL> select count(*) from batch;

  COUNT(*)
----------
     20903

SQL> 
```

我有点惊讶地发现安迪是多么正确。做 NVL 解决方案的成本要高出近 50%。因此，即使一段代码可能看起来不像另一段代码那样整洁或优雅，但它的效率可能会显着提高。我多次运行此程序，每次结果几乎相同。向安迪致敬...

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-03-14T20:17:55.947

在[Expert Oracle Database Architecture](https://rads.stackoverflow.com/amzn/click/com/1590595300)中，我看到：

```
WHERE DECODE(MYCOLUMN, SEARCHVALUE, 1) = 1 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-10-10T14:40:11.500

不知道是不是更简单，但我偶尔用过

```
WHERE ISNULL(MyColumn, -1) = ISNULL(SearchValue, -1) 
```

将“-1”替换为对列类型有效但也不太可能在数据中实际找到的值。

注意：我使用 MS SQL，而不是 Oracle，所以不确定“ISNULL”是否有效。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-10T14:40:10.063

使用 NVL 在两边用一些虚拟值替换 null，如下所示：

```
WHERE NVL(MYCOLUMN,0) = NVL(SEARCHVALUE,0) 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-10T14:46:10.427

另一种选择，从执行查询的角度来看可能是最佳的，并且*仅在您进行某种查询生成时才有用，*即根据搜索值生成您需要的确切查询。

伪代码如下。

```
if (SEARCHVALUE IS NULL) {
    condition = 'MYCOLUMN IS NULL'
} else {
    condition = 'MYCOLUMN=SEARCHVALUE'
}
runQuery(query,condition) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-10T14:39:52.967

尝试

```
WHERE NVL(mycolumn,'NULL') = NVL(searchvalue,'NULL') 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-09T10:07:29.980

如果带外值是可能的：

```
where coalesce(mycolumn, 'out-of-band') 
    = coalesce(searchvalue, 'out-of-band') 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-09T02:30:07.890

这也可以在 Oracle 中完成。

```
WHERE MYCOLUMN || 'X'  = SEARCHVALUE || 'X' 
```

在某些情况下，它通过 OR 击败了 IS NULL 测试。

我也很惊讶 DECODE 可以让你检查 NULL 和 NULL。

```
WITH 
TEST AS
(
    SELECT NULL A FROM DUAL
)
SELECT DECODE (A, NULL, 'NULL IS EQUAL', 'NULL IS NOT EQUAL')
FROM TEST 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-10T14:42:25.863

我认为你所拥有的还可以。你也许可以使用：

```
where NVL(MYCOLUMN, '') = NVL(SEARCHVALUE, '') 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-06-06T12:08:19.047

使用驱动报告的 Oracle 功能，我们经常遇到这种情况。我们希望允许用户输入一个值来限制结果或将其留空以返回所有记录。这是我用过的，对我们来说效果很好。

```
WHERE rte_pending.ltr_rte_id = prte_id
  OR ((rte_pending.ltr_rte_id IS NULL OR rte_pending.ltr_rte_id IS NOT NULL)
      AND prte_id IS NULL) 
```

# c# - 报告处理程序架构问题

> ID：191641
> 
> 赞同：3
> 
> 时间：2008-10-10T14:38:35.013
> 
> 标签：c#, asp.net, report, activereports

我正在尝试使用 ReportHandler 服务来处理报告创建。报告可以设置多个不同数量的参数。在系统中，目前有几种不同的创建报告的方法（MS 报告服务、html 报告等），并且为每个报告生成数据的方式是不同的。我正在尝试将所有内容整合到 ActiveReports 中。我无法更改系统和更改参数，因此在某些情况下，我将获得一个 where 子句来生成结果，而在另一种情况下，我将获得必须用于生成结果的键/值对。我考虑过使用工厂模式，但是由于查询过滤器的数量不同，这不起作用。

我希望有一个 ReportHandler 可以接受我的各种输入并吐出报告。在这一点上，除了使用大的 switch 语句来处理基于 reportName 的每个报告之外，我没有看到任何其他方法。有什么建议我可以更好地解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T18:40:00.843

根据您的描述，如果您正在寻找比 Factory 匹配更好的模式，请尝试 Strategy：

[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)

1.  您的**上下文**可以是一个自定义类，它封装和抽象不同的报告输入（您可以在这部分使用 AbstractFactory 模式）
2.  您的**策略**可以实现任意数量的不同查询过滤器或所需的额外逻辑。如果您将来需要更改系统，只需创建新策略即可在报告工具之间切换。

希望有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-11T13:16:30.870

除了策略模式之外，您还可以为每个底层解决方案创建一个适配器。然后使用策略来改变它们。我构建了类似的每个报告解决方案都由我称为引擎的支持，除了可变报告解决方案之外，我们还有可变存储解决方案 - 输出可以存储在 SQL 服务器或文件系统中。我建议使用容器，然后使用正确的引擎对其进行初始化，例如：

```
public class ReportContainer{
          public ReportContainer ( IReportEngine reportEngine, IStorageEngine storage, IDeliveryEngine delivery...)
}
}

/// In your service layer you resolve which engines to use
// Either with a bunch of if statements / Factory / config ... 

IReportEngine rptEngine = EngineFactory.GetEngine<IReportEngine>( pass in some values)

IStorageEngine stgEngine = EngineFactory.GetEngine<IStorageEngien>(pass in some values)

IDeliverEngine delEngine = EngineFactory.GetEngine<IDeliverEngine>(pass in some values)

ReportContainer currentContext = new ReportContainer (rptEngine, stgEngine,delEngine); 
```

然后 ReportContainer 将工作委托给依赖引擎...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-14T00:15:20.063

我们遇到了类似的问题，并采用了“连接器”的概念，它是主报表生成器应用程序和不同报表引擎之间的接口。通过这样做，我们能够创建一个“通用报表服务器”应用程序。您应该在 www.versareports.com 上查看。

# sql - 将规范化表与非规范化索引视图一起使用是个好主意吗？

> ID：191642
> 
> 赞同：3
> 
> 时间：2008-10-10T14:38:54.950
> 
> 标签：sql, database, normalization, denormalization

我目前正在构建一个新的应用程序，具有很高的读写比率。在我现在的雇主中，出于性能原因，我们的表格上有很多非规范化数据。拥有完全 3NF 表然后使用索引视图进行所有非规范化是更好的做法吗？我应该对表或视图运行查询吗？

我感兴趣的一些事情的一个例子是列子表的聚合（例如，将用户帖子计数存储在某处）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T14:59:21.397

一般来说，如果您需要非常频繁地访问多个规范化表，那么拥有非规范化视图是一个好主意。在大多数情况下，与使用连接和直接查询表相比，它会显着提高性能，并且通常不会降低可维护性，因为您的视图或连接都可以编写为不知道对表的某些部分所做的更改它不使用。

**你的所有**表格是否都应该是第三范式是另一个问题。在我使用过的大多数应用程序中，答案是**大多数**表都应该以这种方式进行标准化，但也有例外。是否破例与数据的使用方式有关，以及您是否可以非常有信心将来不会改变这种使用方式。

由于您以错误的方式做某事而不得不返回并稍后重新规范化可能会付出高昂的代价，但是过度规范化应该易于使用和理解的数据可能会使事情变得比实际需要的更复杂和难以维护。你的旅费可能会改变。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T15:00:53.283

如果您打算使用视图向用户呈现非规范化数据（并且您正在使用 SQL Server），您应该查看 SCHEMABINDING 子句。如果视图是模式绑定的，您可以对其进行索引，并且索引将在基础表更新时更新。这样，如果索引设置好，查找数据的人实际上可以从索引中进行选择，这样就不需要为每个查询都重新构建复杂的视图，但用户仍然会看到最新的基础表更改的日期。

# python - 如何从 Python 中的存储过程中获取输出参数？

> ID：191644
> 
> 赞同：11
> 
> 时间：2008-10-10T14:39:01.157
> 
> 标签：python, sql-server, stored-procedures, parameters, pymssql

我用谷歌搜索了一下，但也许我没有在搜索框中输入正确的魔法咒语。

有谁知道如何从 Python 中的存储过程中获取输出参数？我正在使用 pymssql 调用存储过程，但我不确定获取输出参数的正确语法。我认为我不能使用任何其他 db 模块，因为我是从 Linux 机器运行它以连接到 MS 服务器上的 mssql 数据库。

```
import pymssql

con = pymssql.connect(host='xxxxx',user='xxxx',password='xxxxx',database='xxxxx')

cur = con.cursor()

query = "EXECUTE blah blah blah"

cur.execute(query)
con.commit()
con.close() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T15:59:36.020

我不是 python 专家，但在简要阅读了[DB-API 2.0](http://www.python.org/dev/peps/pep-0249/)之后，我相信你应该像这样使用游标的“callproc”方法：

```
cur.callproc('my_stored_proc', (first_param, second_param, an_out_param)) 
```

然后，您将在“an_out_param”变量的返回值（输出参数）中得到结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-20T22:22:29.393

如果您不能或不想修改原始过程并有权访问数据库，则可以编写一个可从 python 调用的简单包装过程。

例如，如果您有一个存储过程，例如：

```
CREATE PROC GetNextNumber
   @NextNumber int OUTPUT
AS
... 
```

你可以编写一个这样的包装器，它可以很容易地从 python 调用：

```
CREATE PROC GetNextNumberWrap
AS
    DECLARE @RNextNumber int
    EXEC GetNextNumber @RNextNumber
    SELECT @RNextNumber
GO 
```

然后你可以像这样从 python 调用它：

```
import pymssql
con = pymssql.connect(...)
cur = con.cursor()
cur.execute("EXEC GetNextNumberWrap")
next_num = cur.fetchone()[0] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-20T17:58:40.350

我能够使用 Python 从 SQL 存储过程中获取输出值。我找不到在 Python 中获取输出值的好帮助。我自己弄清楚了 Python 语法，所以我怀疑这值得在这里发布：

```
import sys, string, os, shutil, arcgisscripting
from win32com.client import Dispatch
from adoconstants import *

#skip ahead to the important stuff

conn = Dispatch('ADODB.Connection')
conn.ConnectionString = "Provider=sqloledb.1; Data Source=NT38; Integrated Security = SSPI;database=UtilityTicket"
conn.Open()

#Target Procedure Example: EXEC TicketNumExists @ticketNum = 8386998, @exists output

Cmd = Dispatch('ADODB.Command')
Cmd.ActiveConnection = conn

Cmd.CommandType = adCmdStoredProc
Cmd.CommandText = "TicketNumExists"

Param1 = Cmd.CreateParameter('@ticketNum', adInteger, adParamInput)
Param1.Value = str(TicketNumber)
Param2 = Cmd.CreateParameter('@exists', adInteger, adParamOutput)

Cmd.Parameters.Append(Param1)
Cmd.Parameters.Append(Param2)

Cmd.Execute()

Answer = Cmd.Parameters('@exists').Value 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-20T21:32:53.347

看起来在 freetds（pymssql、pyodbc 等）上实现的每个 python dbapi 库在连接到 Microsoft SQL Server 7 SP3 及更高版本时都无法访问输出参数。

[http://www.freetds.org/faq.html#ms.output.parameters](http://www.freetds.org/faq.html#ms.output.parameters)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T17:34:14.470

如果您让您的程序生成一个表格，您可以使用该结果代替 out 参数。

所以而不是：

```
CREATE PROCEDURE Foo (@Bar INT OUT, @Baz INT OUT) AS
BEGIN
   /* Stuff happens here */
   RETURN 0
END 
```

做

```
CREATE PROCEDURE Foo (@Bar INT, @Baz INT) AS
BEGIN
   /* Stuff happens here */
   SELECT @Bar Bar, @Baz Baz
   RETURN 0
END 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-10-10T23:42:58.560

## 2016 更新（pymssql 2.x 中的 callproc 支持）

pymssql v2.x 对`callproc`. `pymssql.output()`它支持使用参数语法的 OUTPUT 参数。`callproc`但是请注意，只有在存储过程不**返回**结果集时才能检索 OUTPUT 参数。[此处](https://github.com/pymssql/pymssql/issues/466)在 GitHub 上讨论了该问题。

### 对于不返回结果集的存储过程

给定 T-SQL 存储过程

```
CREATE PROCEDURE [dbo].[myDoubler] 
    @in int = 0, 
    @out int OUTPUT
AS
BEGIN
    SET NOCOUNT ON;
    SELECT @out = @in * 2;
END 
```

Python代码

```
import pymssql
conn = pymssql.connect(
    host=r'localhost:49242',
    database='myDb',
    autocommit=True
    )
crsr = conn.cursor()

sql = "dbo.myDoubler"
params = (3, pymssql.output(int, 0))
foo = crsr.callproc(sql, params)
print(foo)
conn.close() 
```

产生以下输出

```
(3, 6) 
```

请注意，它`callproc`返回参数元组，其中包含存储过程分配的 OUTPUT 参数值（`foo[1]`在本例中）。

### 对于返回结果集的存储过程

如果存储过程返回一个或多个结果集*并且*还返回输出参数，我们需要使用匿名代码块来检索输出参数值：

存储过程：

```
ALTER PROCEDURE [dbo].[myDoubler] 
    @in int = 0, 
    @out int OUTPUT
AS
BEGIN
    SET NOCOUNT ON;
    SELECT @out = @in * 2;
    -- now let's return a result set, too
    SELECT 'foo' AS thing UNION ALL SELECT 'bar' AS thing;
END 
```

Python代码：

```
sql = """\
DECLARE @out_value INT;
EXEC dbo.myDoubler @in = %s, @out = @out_value OUTPUT;
SELECT @out_value AS out_value;
"""
params = (3,)
crsr.execute(sql, params)
rows = crsr.fetchall()
while rows:
    print(rows)
    if crsr.nextset():
        rows = crsr.fetchall()
    else:
        rows = None 
```

结果：

```
[('foo',), ('bar',)]
[(6,)] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T17:26:58.650

您可能还会考虑使用 SELECT 而不是 EXECUTE。EXECUTE 是（iirc）基本上是一个 SELECT，它实际上并不获取任何东西（只会产生副作用）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-02-28T17:00:49.993

我使用 pyodbc 然后将 pyodbc 行对象转换为列表。大多数答案都显示了一个查询，将变量声明为查询的一部分。但我认为您将变量声明为 sp 的一部分，从而消除了 python 中不必要的步骤。然后，在 python 中，您所要做的就是传递参数来填充这些变量。

这是我用来将 pyodbc 行对象转换为可用列表（列表）的函数（请注意，我注意到 pyodbc 有时会添加尾随空格，所以我解释了对我来说效果很好的那个）：

```
def convert_pyodbc(pyodbc_lst):
'''Converts pyodbc rows into usable list of lists (each sql row is a list),
   then examines each list for list elements that are strings,
   removes trailing spaces, and returns a usable list.'''
usable_lst = []
for row in pyodbc_lst:
    e = [elem for elem in row]
    usable_lst.append(e)
for i in range(0,len(usable_lst[0])):
    for lst_elem in usable_lst:
        if isinstance(lst_elem[i],str):
            lst_elem[i] = lst_elem[i].rstrip()
return usable_lst 
```

现在，如果我需要从 python 运行一个返回结果集的存储过程，我只需使用：

```
strtdate = '2022-02-21'
stpdate = '2022-02-22'

conn = mssql_conn('MYDB')
cursor = conn.cursor()

qry = cursor.execute(f"EXEC mystoredprocedure_using_dates 
'{strtdate}','{stpdate}' ")
results = convert_pyodbc(qry.fetchall())

cursor.close()
conn.close() 
```

然后我将样本结果写入电子表格或 w/e：

```
[[datetime.date(2022, 2, 21), '723521', 'A Team Line 1', 40, 9], 
[datetime.date(2022, 2, 21), '723522', 'A Team Line 2', 15, 10], 
[datetime.date(2022, 2, 21), '723523', 'A Team Line 3', 1, 5], 
[datetime.date(2022, 2, 21), '723686', 'B Team Line 1', 39, 27], 
[datetime.date(2022, 2, 21), '723687', 'B Team Line 2', 12, 14]] 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-30T02:17:48.790

我是这样做的，关键是先声明输出参数：

```
import cx_Oracle as Oracle

conn = Oracle.connect('xxxxxxxx')
cur = conn.cursor()

idd = cur.var(Oracle.NUMBER)
cur.execute('begin :idd := seq_inv_turnover_id.nextval; end;', (idd,))
print(idd.getvalue()) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-11-16T11:49:51.507

您可以尝试重新格式化`query`：

```
import pypyodc

connstring = "DRIVER=SQL Server;"\
             "SERVER=servername;"\
             "PORT=1043;"\
             "DATABASE=dbname;"\
             "UID=user;"\
             "PWD=pwd"

conn = pypyodbc.connect(connString)
cursor = conn.cursor()

query="DECLARE @ivar INT \r\n" \
      "DECLARE @svar VARCHAR(MAX) \r\n" \
      "EXEC [procedure]" \
      "@par1=?," \
      "@par2=?," \
      "@param1=@ivar OUTPUT," \
      "@param2=@svar OUTPUT \r\n" \
      "SELECT @ivar, @svar \r\n"
par1=0
par2=0
params=[par1, par2]
result = cursor.execute(query, params)
print result.fetchall() 
```

[1] [https://amybughunter.wordpress.com/tag/pypyodbc/](https://amybughunter.wordpress.com/tag/pypyodbc/)

# hex - 任何用于将十六进制转储转换为人类可读形式的通用实用程序或库？

> ID：191652
> 
> 赞同：5
> 
> 时间：2008-10-10T14:40:53.213
> 
> 标签：hex, protocols, binaryfiles, hexdump

我经常与各种设备进行串行通信，因此我经常需要分析日志文件中的十六进制转储。目前，我通过查看转储、查看协议规范并写下结果来手动执行此操作。然而，这是乏味且容易出错的，尤其是当消息包含数百个字节并且包含大端和小端数据、ASCII、Unicode、压缩、CRC、. . . .

我编写了一些 Python 脚本来帮助处理更常见的情况。但是有很多协议要处理，花时间编写自定义脚本是没有意义的，除非我知道我会有很多转储要分析。

我想要的是某种可以自动执行此活动的实用程序。因此，例如，如果我有这样的文本十六进制转储：

```
7e ff 00 7b  00 13 86 04
00 41 42 43  44 56 ef 7e 
```

以及消息格式的某种描述，如下所示：

```
# Field         Size        Byte Order  Output Format
Flag            1                       hex
Address         1                       hex
Control         1                       hex
DataType        1                       decimal
LineIndex       1                       decimal
PollAddress     2           msb         hex
DataSize        2           lsb         decimal
Data            (DataSize)              ascii
CRC             2           lsb         hex
Flag            1                       hex 
```

我会得到这样的输出：

```
Flag            0x7e
Address         0xff
Control         0x00
DataType        123
LineIndex       0
PollAddress     0x1386
DataSize        4
Data            "ABCD"
CRC             0xef56
Flag            0x7e 
```

基于硬件的协议分析器通常具有执行此类操作的精美功能，但我需要使用文本日志文件。

是否存在任何此类实用程序或库？

* * *

自从我设置赏金以来，已经出现了一些好的答案。我猜赏金工作！

Wireshark 和 HexEdit 看起来都很有前途；我会看看那些，并且可能会将赏金奖励给适合我需要的人。但我仍然对其他想法持开放态度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T17:54:41.140

[Wireshark](http://www.wireshark.org/)非常擅长开放网络协议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T20:57:24.343

我想你需要一个好的十六进制编辑器。看看[hexedit](http://expertcomsoft.com/)。我过去使用过免费版本，它很好，但我不知道它是否能提供您正在寻找的东西。基本上，您希望能够定义一个结构，然后能够针对它解码十六进制数据。我想一个好的十六进制编辑器会支持这一点。检查 HexEdit 的付费版本或谷歌其他编辑器；有很多可用的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T17:57:20.433

通常，我使用 emacs hexl-mode 将二进制文件视为“文本转储”。当我需要更具体的输出时，我就像你一样，用 C++ 编写一个解析器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T18:31:12.033

在我的工作中，我们设计网络和串行协议来控制嵌入式硬件。我也厌倦了错误地读取转储，并为每个协议编写脚本，因此我编写了一个库来完全按照您的描述进行操作。你可以给它一个协议的文本文件描述，它有一个 gui 支持用于设置单个位的复选框、用于在有效位组合之间进行选择的单选按钮以及有很多选择时的下拉列表。您可以编辑数据的十六进制视图、每个字段的二进制视图，甚至指向并单击字段，所有其他视图都会更新。它为我们节省了大量时间。它有点快速和肮脏，但如果它不是我的雇主拥有的，我会发布它。关键是，写起来并不难，一旦我放弃了每个协议的脚本，转而使用一个可以理解协议描述的程序，事情就变得很棒了。我们停止了与误读转储相关的错误，并且添加新协议变得微不足道。加上协议的文字描述直接进入了开发规范，所以软件人员会知道如何处理硬件。我鼓励你尝试一下。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T07:32:15.530

一个可能的起点是[libPDL](http://nmedit.sourceforge.net/subprojects/libpdl.html)，一个 C++ 库。

另一种选择可能是[NetPDL](http://www.nbee.org/doku.php?id=netpdl:index)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-06T09:02:42.993

你应该使用[Tcl 二进制](http://www.tcl.tk/man/tcl8.5/TclCmd/binary.htm)命令来处理这样的事情。以下是您上面示例的起点。Tcl 真的很容易学习和编写脚本。如果你正在做串行通信的东西，你应该自己学习至少基础知识。

```
bash$ tclsh
% binary scan [binary format H* 7eff007b00138604004142434456ef7e] \
  H2H2H2ccH4sa4h4H2 \
  flag1 addr ctl datatype lineidx polladdr datasize data crc flag2
10
% puts "$flag1 $addr $ctl $datatype $lineidx \
  $polladdr $datasize $data $crc $flag2"
7e ff 00 123 0 1386 4 ABCD 65fe 7e 
```

当你做你的字节顺序的东西时，你切换了字节​​而不是位，所以我不太确定你在那里寻找什么。无论如何，这会让你开始。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-07T05:57:52.863

看看[hexworkshop](http://www.hexworkshop.com)

我多年来一直使用它来分析十六进制转储。它有一个结构查看器，可让您以 C/C++ 样式定义数据结构，然后以该格式显示数据。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-07T06:08:20.550

[WinHex](http://www.x-ways.net/winhex/)支持显示/编辑用户定义的记录格式。有一些例子在[http://www.x-ways.net/winhex/templates/index.html](http://www.x-ways.net/winhex/templates/index.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-10T14:42:47.937

我很确定我在 CPAN 上看到过类似的东西。如果你愿意，我可以更模糊。:-)

**更新：**这不是你想要的，但看看[Parse::Binary::FixedFormat](http://cpan.uwinnipeg.ca/htdocs/Parse-Binary/Parse/Binary/FixedFormat.html)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-04-29T19:03:02.247

有一个名为的 BSD 命令行实用程序`hexdump`通过使用格式字符串（可以在外部文件中）来执行此操作。有关介绍，请参见[https://www.suse.com/communities/blog/making-sense-hexdump/](https://www.suse.com/communities/blog/making-sense-hexdump/)，例如[https://www.freebsd.org/cgi/man.cgi?query=hexdump&sektion=1](https://www.freebsd.org/cgi/man.cgi?query=hexdump&sektion=1)手册页（特别注意`-e`and`-f`选项和标题为**Formats**的部分）。

# javascript - 我应该将哪个效果库与 GWT 集成？

> ID：191657
> 
> 赞同：4
> 
> 时间：2008-10-10T14:42:19.343
> 
> 标签：javascript, css, gwt, comparison, effects

我很好奇是否有人对那里的不同选项进行了比较。到目前为止，我倾向于使用 Moo.fx，因为加载prototype.js 只是为了使用scriptaculous 似乎有点多。那有意义吗？还有其他值得尝试的效果库吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:54:11.103

“Smart GWT”具有有趣的效果，尤其是模仿桌面项目。我通过了 ShowCase： [Smart GWT Showcase](http://www.smartclient.com/smartgwt/showcase/#main)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T19:38:51.363

[分机 GWT](http://extjs.com/products/gxt/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-11T22:20:35.910

我使用[gwt-query](http://code.google.com/p/gwtquery/)，它是 gwt 的 jquery 克隆。

如果您已经知道 jquery 它是自然选择。如果没有，一些简单效果的学习曲线非常快（项目网站上有很多示例）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-06T20:04:09.097

我参与了我现在使用的库[VisualFox-FX](http://code.google.com/p/visualfox-fx/)的测试，而不是以前在我的项目中使用的 gwt-fx。VisualFox-FX 支持基于 javascript 和 CSS3 的动画，并且有很多预建的效果。它还允许组合许多效果来构建您需要的“复杂”效果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T10:17:28.453

moo.fx 或 Rico 应该做的工作......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-05T06:11:38.563

我找到了推荐的 JS 库的可行替代方案——由 Adam Tacy 开发的 GWT-native Java 库，称为[GWT-FX 。](http://code.google.com/p/gwt-fx/)它的一些功能包括内置效果（淡入淡出、滑动、突出显示）、物理过渡类型（线性、缓入/缓出、弹性），以及通过指定 CSS 规则或“属性”（声明）来构建自己的效果的能力.

查看[google 代码 wiki](http://code.google.com/p/gwt-fx/wiki/StartPage)和/或[演示](http://gwtfx.adamtacy.com/EffectsExample.html#intro)页面了解更多信息。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-09T19:40:58.037

我会推荐[jquery](http://jquery.com/)。它很小，可以从 Google 作为[ajax 库 API](http://code.google.com/apis/ajaxlibs/)访问，而且速度很快。

# visual-studio-2005 - 可能不存在的卷上的 Visual Studio 2005 安装项目应用程序文件夹默认位置

> ID：191669
> 
> 赞同：0
> 
> 时间：2008-10-10T14:43:57.683
> 
> 标签：visual-studio-2005, installation, defaultlocation

我有一个包含安装项目的 Visual Studio 2005 解决方案。安装项目将“d:\somefolder”指定为应用程序文件夹 DefaultLocation 属性。在没有任何分区映射到“d:”的机器上安装时，生成的安装程序会显示消息

> “d:\ 卷当前不可用。请选择另一个。”

麻烦的是，您实际上没有机会选择不同的安装位置（在现有卷上）。我应该使用哪些设置来使安装程序的用户能够更改安装路径，同时保持默认设置为 d:\some_folder？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-09-09T07:25:32.807

VS 的设置和部署项目还有很多不足之处。我知道的每个解决方案都需要一些阅读和学习，因为为您进行设置的 GUI 工具通常会限制在更改其实际外观之外的自定义。我建议查看用于安装的[WiX (Windows Installer XML)](http://wix.sourceforge.net/)工具集。学习曲线是我在市场上见过的最用户友好的曲线之一，而且它是一个免费工具。只要您对 XML 有相当的了解，您就拥有了开始制作 MSI 所需的一切。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T14:48:05.087

我想应该有可以让你改变目的地的设置。

或者，您可以使用 orca 在指定的对话框中添加。

或者，如果用户在命令行界面上，您可以将其作为命令行参数传递。

# c++ - 如何在 Windows 上使用 Eclipse 构建 wxWidgets

> ID：191687
> 
> 赞同：0
> 
> 时间：2008-10-10T14:48:21.483
> 
> 标签：c++, eclipse, cygwin, wxwidgets

我在 Windows XP SP2 机器上安装了 wxWidgets 2.8.9 并根据说明构建了库，现在我正在尝试获取[Hello World！从 Eclipse 中构建的教程](http://www.wxwidgets.org/docs/tutorials/hello.htm)应用程序，我显然只是遗漏了一些东西。知道如何让 Cygwin、Eclipse 和 wxWidgets 一起玩吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T14:54:38.227

此[答案](http://groups.google.com/group/comp.soft-sys.wxwindows/browse_thread/thread/2771869bdadbf576/28e8011930924b64?lnk=st&q=eclipse+wxWidgets#28e8011930924b64)由 Lars Uffmann 发布到 comp.soft-sys.wxwindows 新闻组。简而言之：

1.  Eclipse项目配置中的路径添加c:/cygwin/usr/local/bin

2.  将 ``wx-config --cxxflags`' 添加到 GCC C++ 编译器命令

3.  将 ${FLAGS} 变量移动到 GCC C++ 链接器命令行模式的末尾

4.  将 ``wx-config --libs`' 添加到 GCC C++ 链接器标志。

感谢乌夫曼先生分享这些信息；这个问题让我头疼了好几天。

* * *

编辑：请注意，wx-config 字符串的每一端都有一个文字反引号。转义反引号的方法似乎无法正常工作。有关确切语法的更多详细信息，请参阅链接的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T12:42:32.650

我自己在 Windows 上使用 MinGW 构建了 wxWidgets，并让 CMake 2.6 在 Windows 上为 Eclipse 创建 Makefile 和项目文件。这对我来说效果很好。

# c# - 奇怪的 LINQ 异常（索引超出范围）

> ID：191690
> 
> 赞同：10
> 
> 时间：2008-10-10T14:49:20.780
> 
> 标签：c#, linq, linq-to-sql

我有一张桌子，我们会打电话`Users`。该表在 SQL Server 中定义了一个主键 - 一个自动增量`int ID`。

有时，我对该表的 LINQ 查询会因`"Index was outside the range"`错误而失败 - 即使是最简单的查询。查询本身不使用任何索引器。

例如：

```
User = Users.Take(1); 
```

或者

```
IEnumerable<Users> = Users.ToList(); 
```

这两个查询都引发了相同的错误。使用调试器 Visualizer 查看生成的查询 - 我将查询复制并粘贴到 SQL 中，它工作正常。我还在可视化器上单击“执行”，它工作正常。但是单独执行代码会引发此错误。我没有在类上实现任何部分方法，所以那里什么都没有发生。如果我重新启动调试器，问题就会消失，只是在几个小时后再次随机重新启动。更关键的是，我在生产中运行的应用程序的错误日志中看到了这个错误。

我在我的应用程序中针对数据库中的十几个不同实体执行了大量 LINQ，但我只在与表中特定实体相关的查询中看到这个问题。一些谷歌搜索表明这个问题可能与我的模型和另一个实体之间指定的不正确关系有关，但我与这个对象没有*任何*关系。它似乎 95% 的时间都在工作，只有另外 5% 的时间失败了。

我已经从设计器中完全删除了该对象，并从“刷新”的服务器浏览器中重新添加了它，但这并没有解决问题。

有什么想法吗？

这是完整的错误消息和堆栈跟踪：

> 指数超出范围。必须是非负数且小于集合的大小。参数名称：System.Data.Linq 中 System.Data.Linq.SqlClient.SqlProvider.Execute 处的索引（Expression query, QueryInfo queryInfo, IObjectReaderFactory factory, Object[] parentArgs, Object[] userArgs, ICompiledSubQuery[] subQueries, Object lastResult） System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute 处的 .SqlClient.SqlProvider.ExecuteAll（表达式查询，QueryInfo[] queryInfos，IObjectReaderFactory 工厂，Object[] userArguments，ICompiledSubQuery[] subQueries） （表达式查询）在 System.Data.Linq.Table `1.System.Linq.IQueryProvider.Execute[TResult](Expression expression) at System.Linq.Queryable.FirstOrDefault[TSource](IQueryable`1 源，Expression`1 谓词）在 MyProject.FindUserByType(String typeId)

编辑：根据要求，下面是表模式的副本。

```
CREATE TABLE [dbo].[Container](
[ID] [int] IDENTITY(1,1) NOT NULL,
[MarketCode] [varchar](max) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
[Description] [varchar](max) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
[Capacity] [int] NOT NULL,
[Volume] [float] NOT NULL
 CONSTRAINT [PK_Container] PRIMARY KEY CLUSTERED 
(
[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

编辑：堆栈跟踪显示，但我同时使用和`FirstOrDefault`复制了错误。所有这些之间的堆栈跟踪都是相同的，只是 interchangnig 。向下移动堆栈实际上是相同的。 `Take()``ToList()``FirstOrDefault/Take/ToList``SqlProvider.Execute`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-04T18:00:39.980

这几乎肯定不会是每个人的根本原​​因，但我在我的项目中遇到了完全相同的异常 - 并发现根本原因是在构建实体类期间引发了异常。奇怪的是，真正的异常是“丢失”，而是表现为 ArgumentOutOfRange 异常，该异常源自检索对象的 Linq 语句的迭代器。

如果您收到此错误并且您在 POCO 上引入了 OnCreated 或 OnLoaded 方法，请尝试逐步执行这些方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T23:20:14.443

我会说你在某个地方有一个模型-> 数据库不匹配。当我在这种情况下像你一样绝望时，我通常会启动 VS.NET，创建一个新的控制台应用程序，然后重建引用此查询中感兴趣的实体的 DBML 部分，然后重新运行。您可能会发现，在这种隔离中，查询是有效的。您是否通过填写部分方法来自定义任何实体定义，尤其是那些在创建时触发的方法？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-24T08:26:42.767

This Problem Occurs due to linq object and Database fields of that Table are not identical.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T19:21:32.197

异常发生在系统库中，您的故事让我认为问题不在您的代码中。架构最近是否发生了变化？你的映射正确吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-16T15:52:12.590

我也遇到了这个问题并解决了。

现在我明白错误是 Linq 数据上下文的错误使用，但也许我的经验仍然可以帮助其他人理解他们为什么会得到这个错误。

Linq 数据上下文并不意味着同时运行。因此创建多个运行异步的任务并不理想。检查以下示例代码以了解问题：

```
using(var ctx = new LinqDataContext())
{
    List<Task> tasks = new List<Task>();
    for(int i=0;i<1000;i++)
    {
        var task = Task.Run(() => {
            var customer = ctx.Customers.SingleOrDefault(o => o.Id == i);
            customer.DoSomething();
        }
        tasks.Add(task);
    }
    Task.WaitAll(tasks);
} 
```

在我的场景中，我将数据上下文作为参数传递到更长的调用堆栈中，并在此过程中调用异步方法。所以它不像上面的例子那么明显。但也许这无论如何都可以帮助其他人:-)

# c# - C# 应该有多重继承吗？

> ID：191691
> 
> 赞同：54
> 
> 时间：2008-10-10T14:49:58.187
> 
> 标签：c#, inheritance, multiple-inheritance

我遇到了许多反对在 C# 中包含多重继承的论点，其中一些包括（撇开哲学论点）：

*   多重继承太复杂而且经常模棱两可
*   这是不必要的，因为接口提供了类似的东西
*   在接口不合适的情况下，组合是一个很好的替代品

我来自 C++ 背景，怀念多重继承的力量和优雅。尽管它并不适合所有软件设计，但在某些情况下，很难否认它对接口、组合和类似的 OO 技术的实用性。

排除多重继承是否意味着开发人员不够聪明，无法明智地使用它们，并且无法在出现复杂性时解决它们？

我个人会欢迎在 C#（可能是 C##）中引入多重继承。

* * *

**附录**：我很想知道来自单一（或程序背景）与多重继承背景的回复。我经常发现没有多重继承经验的开发人员通常会默认使用多重继承是不必要的论点，因为他们没有任何范式经验。

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2008-10-10T14:50:51.977

我从来没有错过过一次，从来没有。是的，它 [MI] 变得复杂了，是的，接口在很多方面都做着类似的工作——但这​​不是最重要的一点：在一般意义上，大多数时候根本不需要它。在许多情况下，甚至单继承也被过度使用。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-10-10T15:00:16.730

更喜欢聚合而不是继承！

```
class foo : bar, baz 
```

通常更好地处理

```
class foo : Ibarrable, Ibazzable
{
  ... 
  public Bar TheBar{ set }
  public Baz TheBaz{ set }

  public void BarFunction()
  {
     TheBar.doSomething();
  }
  public Thing BazFunction( object param )
  {
    return TheBaz.doSomethingComplex(param);
  }
} 
```

通过这种方式，您可以交换 IBarrable 和 IBazzable 的不同实现以创建应用程序的多个版本，而无需编写另一个类。

依赖注入可以帮助解决这个问题。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-10-10T17:36:27.133

处理多重继承的问题之一是接口继承和实现继承之间的区别。

通过使用纯接口，C# 已经有了一个干净的接口继承实现（包括隐式或显式实现的选择）。

如果您查看 C++，对于您在`class`声明中冒号后指定的每个类，您获得的继承类型由访问修饰符（`private`、、`protected`或`public`）确定。使用`public`继承，你会得到多重继承的全部混乱——多个接口与多个实现混合在一起。通过`private`继承，您只需获得实现。"" 的对象`class Foo : private Bar`永远不能传递给期望 a 的函数，`Bar`因为就好像`Foo`该类真的只有一个私有`Bar`字段和一个自动实现的[*委托*模式](http://en.wikipedia.org/wiki/Delegation_pattern "维基百科：委托模式")。

纯多重实现继承（实际上只是自动委托）不会出现任何问题，并且在 C# 中会很棒。

至于类的多接口继承，实现该特性有许多不同的可能设计。每种具有多重继承的语言都有自己的规则，即在多个基类中以相同名称调用方法时会发生什么。一些语言，如 Common Lisp（尤其是 CLOS 对象系统）和 Python，有一个元对象协议，您可以在其中指定基类优先级。

这是一种可能性：

```
abstract class Gun
{ 
    public void Shoot(object target) {} 
    public void Shoot() {}

    public abstract void Reload();

    public void Cock() { Console.Write("Gun cocked."); }
}

class Camera
{ 
    public void Shoot(object subject) {}

    public virtual void Reload() {}

    public virtual void Focus() {}
}

//this is great for taking pictures of targets!
class PhotoPistol : Gun, Camera
{ 
    public override void Reload() { Console.Write("Gun reloaded."); }

    public override void Camera.Reload() { Console.Write("Camera reloaded."); }

    public override void Focus() {}
}

var    pp      = new PhotoPistol();
Gun    gun     = pp;
Camera camera  = pp;

pp.Shoot();                    //Gun.Shoot()
pp.Reload();                   //writes "Gun reloaded"
camera.Reload();               //writes "Camera reloaded"
pp.Cock();                     //writes "Gun cocked."
camera.Cock();                 //error: Camera.Cock() not found
((PhotoPistol) camera).Cock(); //writes "Gun cocked."
camera.Shoot();                //error:  Camera.Shoot() not found
((PhotoPistol) camera).Shoot();//Gun.Shoot()
pp.Shoot(target);              //Gun.Shoot(target)
camera.Shoot(target);          //Camera.Shoot(target) 
```

在这种情况下，只有第一个列出的类的实现在发生冲突时被隐式继承。必须明确指定其他基类型的类才能获得它们的实现。为了使它更防白痴，编译器可以在冲突的情况下禁止隐式继承（冲突的方法总是需要强制转换）。

此外，您现在可以使用隐式转换运算符在 C# 中实现多重继承：

```
public class PhotoPistol : Gun /* ,Camera */
{
    PhotoPistolCamera camera;

    public PhotoPistol() {
        camera = new PhotoPistolCamera();
    }

    public void Focus() { camera.Focus(); }

    class PhotoPistolCamera : Camera 
    { 
        public override Focus() { }
    }

    public static Camera implicit operator(PhotoPistol p) 
    { 
        return p.camera; 
    }
} 
```

但是，它并不完美，因为**`is`**and**`as`**运算符和`System.Type.IsSubClassOf()`.

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-10-10T15:34:48.753

这是我一直遇到的多重继承的一个非常有用的案例。

作为工具包供应商，我不能更改已发布的 API，否则我将破坏向后兼容性。由此产生的一件事是，一旦我发布了接口，我就永远无法添加它，因为它会破坏任何实现它的人的编译——唯一的选择是扩展接口。

这对现有客户来说很好，但新客户会认为这种层次结构不必要地复杂，如果我从一开始就设计它，我不会选择以这种方式实现它——我必须这样做，否则我将失去向后兼容性. 如果接口是内部的，那么我只需添加它并修复实现者。

在许多情况下，接口的新方法有一个明显而小的默认实现，但我无法提供它。

我更喜欢使用抽象类，然后当我必须添加一个方法时，添加一个具有默认实现的虚拟方法，有时我们会这样做。

当然，问题是如果这个类可能会混入已经在扩展某些东西的东西中——那么我们别无选择，只能使用接口并处理扩展接口。

如果我们认为我们在很大程度上遇到了这个问题，我们会选择一个丰富的事件模型——我认为这可能是 C# 中的正确答案，但并不是每个问题都以这种方式解决——有时你想要一个简单的公共接口，以及更丰富的扩展程序。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-10-10T14:55:11.187

C# 支持单一继承、接口和扩展方法。在它们之间，它们几乎提供了多重继承所提供的一切，而没有多重继承带来的麻烦。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-10T16:35:50.207

CLR 不以我所知道的任何方式支持多重继承，所以我怀疑它是否可以像在 C++（或 Eiffel）中那样以有效的方式得到支持，因为该语言是专门设计的为 MI）。

多重继承的一个很好的替代方法称为特征。它允许您将各种行为单元混合到一个类中。编译器可以支持特征作为对单继承类型系统的编译时扩展。您只需声明类 X 包括特征 A、B 和 C，编译器就会将您要求的特征放在一起以形成 X 的实现。

例如，假设您正在尝试实现 IList(of T)。如果您查看 IList(of T) 的不同实现，它们通常共享一些完全相同的代码。这就是特征。您只需声明一个带有公共代码的特征，您就可以在 IList(of T) 的任何实现中使用该公共代码——即使该实现已经有一些其他基类。语法可能如下所示：

```
/// This trait declares default methods of IList<T>
public trait DefaultListMethods<T> : IList<T>
{
    // Methods without bodies must be implemented by another 
    // trait or by the class
    public void Insert(int index, T item);
    public void RemoveAt(int index);
    public T this[int index] { get; set; }
    public int Count { get; }

    public int IndexOf(T item)
    {
        EqualityComparer<T> comparer = EqualityComparer<T>.Default;
        for (int i = 0; i < Count; i++)
            if (comparer.Equals(this[i], item))
                return i;
        return -1;
    }
    public void Add(T item)
    {
        Insert(Count, item);
    }
    public void Clear()
    {   // Note: the class would be allowed to override the trait 
        // with a better implementation, or select an 
        // implementation from a different trait.
        for (int i = Count - 1; i >= 0; i--)
            RemoveAt(i);
    }
    public bool Contains(T item)
    {
        return IndexOf(item) != -1;
    }
    public void CopyTo(T[] array, int arrayIndex)
    {
        foreach (T item in this)
            array[arrayIndex++] = item;
    }
    public bool IsReadOnly
    {
        get { return false; }
    }
    public bool Remove(T item)
    {
        int i = IndexOf(item);
        if (i == -1)
            return false;
        RemoveAt(i);
        return true;
    }
    System.Collections.IEnumerator 
        System.Collections.IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }
    IEnumerator<T> GetEnumerator()
    {
        for (int i = 0; i < Count; i++)
            yield return this[i];
    }
} 
```

你使用这样的特征：

```
class MyList<T> : MyBaseClass, DefaultListMethods<T>
{
    public void Insert(int index, T item) { ... }
    public void RemoveAt(int index)       { ... }
    public T this[int index] {
        get { ... }
        set { ... }
    }
    public int Count {
        get { ... }
    }
} 
```

当然，我在这里只是触及表面。有关更完整的描述，请参阅论文[Traits：Composable Units of Behavior](http://www.iam.unibe.ch/~scg/Archive/Papers/Scha03aTraits.pdf) (PDF)。

Rust 语言（来自 Mozilla）以一种有趣的方式实现了 Traits：他们注意到 Traits 类似于默认接口实现，因此他们将接口和 Traits 统一为一个特性（他们称之为 Trait）。trait 和默认接口实现（Java 现在拥有）之间的主要区别在于，trait 可以包含私有或受保护的方法，这与必须是公共的传统接口方法不同。如果traits和interface**没有**统一为一个特性，那么另一个区别是你可以引用一个接口，但是你不能引用一个trait；特征本身不是类型。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-24T23:45:55.743

实际上，由于一个特定原因，我错过了多重继承……处置模式。

每次我需要实现 dispose 模式时，我都会对自己说：“我希望我可以从一个通过一些虚拟覆盖实现 dispose 模式的类派生。” 我将相同的样板代码复制并粘贴到每个实现 IDispose 的类中，我讨厌它。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-11-25T00:38:35.887

YES! YES! and YES!

Seriously, I've been developing GUI libraries my entire career, and MI (Multiple Inheritance) makes this FAR easier than SI (Single Inheritance)

First I did [SmartWin++](http://smartwinlib.org) in C++ (MI heavily used) then I did Gaia Ajax and finally now [Ra-Ajax](http://ra-ajax.org) and I can with extreme confident state that MI rules for some places. One of those places being GUI libraries...

And the arguments claiming that MI "is too complex" and such are mostly put there by people trying to construct language wars and happens to belong to the camp which "currently doesn't have MI"...

Just like functional programming languages (like Lisp) have been taught (by the "non-Lispers") as "too complex" by non-functional programming language advocates...

People are afraid of the unknown...

MI RULES!

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-10T14:55:29.300

仅仅出于您所说的原因，我会反对多重继承。开发人员会滥用它。我已经看到每个类从实用程序类继承的问题已经足够多，因此您可以从每个类调用一个函数而无需输入太多内容，以了解多重继承在许多情况下会导致错误的代码。关于 GoTo 也可以这样说，这是它的使用如此不受欢迎的原因之一。我认为多重继承确实有一些很好的用途，就像 GoTo 一样，在理想的世界中，它们都只在适当的时候使用，不会有问题。然而，世界并不理想，所以我们必须保护糟糕的程序员免受自己的伤害。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-11-07T06:59:37.190

我很高兴 C# 没有多重继承，尽管它有时很方便。相反，我希望看到的是能够提供接口方法的默认实现。那是：

```
interface I
{
    void F();
    void G();
}

class DefaultI : I
{
    void F() { ... }
    void G() { ... }
}

class C : I = DefaultI
{
    public void F() { ... } // implements I.F
} 
```

在这种情况下，`((I)new C()).F()`将调用`C`的实现`I.F()`，而`((I)new C()).G()`将调用`DefaultI`的实现`I.G()`。

在将其添加到语言中之前，语言设计者必须解决许多问题，但没有一个是非常困难的，结果将涵盖使多重继承可取的许多需求。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-10T15:25:48.380

**不。**

（用于投票）

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-11-14T16:00:36.593

*关于 DataFlex 4GL v3+（我知道，我知道，Data什么*？）真正好的和（当时）新颖的事情之一是它对**mixin**继承的支持——来自任何其他类的方法可以在你的类中重用；只要您的类提供这些方法使用的属性，它就可以正常工作，并且没有“钻石问题”或其他多重继承“陷阱”需要担心。

我希望在 C# 中看到类似的东西，因为它可以简化某些类型的抽象和构造问题

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-12-12T14:17:00.180

[您可以使用mixins](https://stackoverflow.com/questions/255553/is-it-possible-to-implement-mixins-in-c)代替多重继承，这是一个更好的解决方案。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-10T14:58:53.380

自从它首次作为 alpha/beta 版本发布以来，我一直在使用 C#，并且从未错过多重继承。MI 在某些方面很好，但几乎总是有其他方法可以实现相同的结果（其中一些实际上最终变得更简单或创建更易于理解的实现）。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-10T15:01:20.847

多重继承通常很有用，许多 OO 语言以一种或另一种方式实现它（C++、Eiffel、CLOS、Python ......）。是必不可少的吗？不，它很好吗？是的。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-10-10T15:06:29.950

**更新**
我挑战所有投票给我的人，向我展示任何我无法轻松移植到单继承语言的多继承示例。除非有人可以展示任何此类样本，否则我声称它不存在。我已经将大量的 C++ 代码 (MH) 移植到了 Java (no-MH)，这从来都不是问题，无论 C++ 代码使用了多少 MH。

* * *

到目前为止，没有人能证明多重继承比您在帖子中提到的其他技术有[任何优势](http://en.wikipedia.org/wiki/Multiple_inheritance#Criticisms)（使用接口和委托，我可以在没有太多代码或开销的情况下获得完全相同的结果），但它有几个众所周知的缺点（[菱形问题](http://en.wikipedia.org/wiki/Diamond_problem)是最烦人的）。

实际上，多重继承通常被滥用。如果您使用 OO 设计以某种方式将现实世界建模为类，那么您将永远无法达到多重继承真正有意义的地步。您能否提供一个有用的多重继承示例？到目前为止，我看到的大多数示例实际上都是“错误的”。他们使某些东西成为子类，这实际上只是一个额外的属性，因此实际上是一个接口。

看看[萨瑟](http://www.icsi.berkeley.edu/~sather/)。它是一种编程语言，其中接口确实具有多重继承，为什么不（它不会产生菱形问题），但是没有接口的类没有任何继承。它们只能实现接口，并且可以“包含”其他对象，这使得这些其他对象成为它们的固定部分，但这与继承不同，它是一种委托形式（通过包含对象“继承”的方法调用是实际上只是转发到封装在您的对象中的这些对象的实例）。我认为这个概念非常有趣，它表明您可以拥有一个完全干净的 OO 语言，而无需任何实现继承。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-10T23:08:36.123

我更喜欢 C++。我使用过 Java、C# 等。随着我的程序在这样的 OO 环境中变得更加复杂，我发现自己缺少多重继承。这是我的主观体验。

它可以制作出令人惊叹的意大利面条代码……它可以制作出令人惊叹的优雅代码。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-11-25T00:26:14.603

I believe languages like C# should give the programmer the option. Just because it *maybe* too complicated does not mean it *will be* too complicated. Programming languages should provide the developer with tools to build anything the programmer wants to.

You choose to use those API's a developer already wrote, you dont have too.

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-10-10T15:32:02.953

我认为它真的很简单。就像任何其他复杂的编程范例一样，您可能会滥用它并伤害自己。你可以滥用对象吗（哦，是的！），但这并不意味着 OO 本身就是不好的。

与 MI 类似。如果您没有继承类的大型“树”，或者没有许多提供相同命名方法的类，那么您将完全可以使用 MI。事实上，由于 MI 提供了实现，您通常会比 SI 实现更好，因为您必须重新编码或将方法剪切和粘贴到委托对象。在这些情况下，代码越少越好。您可以尝试通过接口继承重用对象，从而将共享代码弄得一团糟。而且这样的变通办法并不正确。

我认为.NET 的单继承模型是有缺陷的：它们应该只使用接口，或者只使用 MI。拥有“对半”（即单个实现继承加上多个接口继承）比它应该的更令人困惑，而且一点也不优雅。

我来自 MI 背景，我并不害怕或被它灼伤。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-10-10T15:32:13.297

我已经在这里发布了几次，但我只是觉得它真的很酷。[你可以在这里](http://www.codeproject.com/KB/architecture/smip.aspx)学习如何伪造 MI 。我还认为这篇文章强调了为什么 MI 会如此痛苦，即使这不是故意的。

我既不想错过也不需要它，我更喜欢用对象的组合来达到我的目的。这也是这篇文章的真正意义所在。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-10-10T15:48:06.200

我自己也在 C++ 中使用了多重继承，但你真的必须知道你在做什么才能不给自己带来麻烦，特别是如果你有两个共享一个祖父母的基类。然后你可能会遇到虚拟继承的问题，必须声明你要调用的每个构造函数（这使得二进制重用变得更加困难）......这*可能*是一团糟。

更重要的是，当前 CLI 的构建方式使 MI 无法*轻松*实现。我敢肯定，如果他们愿意，他们可以做到，但我有其他的东西我宁愿在 CLI 中看到，而不是多重继承。

我希望看到的东西包括[Spec#](http://research.microsoft.com/SpecSharp/)的一些特性，比如不可为空的引用类型。我还希望通过能够将参数声明为 const 以及声明函数 const 来看到更多的对象安全性（这意味着您要保证对象的内部状态不会被方法和编译器会仔细检查你）。

我认为在单继承、多接口继承、泛型和扩展方法之间，您几乎可以做任何您需要做的事情。如果有什么东西可以为渴望 MI 的人带来改善，我认为需要某种语言结构来简化聚合和组合。这样，您可以拥有一个共享接口，然后将您的实现委托给您通常继承的类的私有实例。现在，这需要大量的样板代码来完成。拥有更自动化的语言功能将有很大帮助。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-10-10T15:22:21.320

一位同事写了这篇博客，讲述如何在 C# 中使用动态编译获得多重继承之类的东西：

[http://www.atalasoft.com/cs/blogs/stevehawley/archive/2008/09/29/late-binding-in-c-using-dynamic-compilation.aspx](http://www.atalasoft.com/cs/blogs/stevehawley/archive/2008/09/29/late-binding-in-c-using-dynamic-compilation.aspx)

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-10-10T14:55:05.930

我认为如果没有提供足够的投资回报率，它会使事情变得过于复杂。我们已经看到人们使用过深的继承树来屠杀 .NET 代码。如果人们有权进行多重继承，我可以想象会发生怎样的暴行。

我不会否认它有潜力，但我只是没有看到足够的好处。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-10-10T14:56:59.110

虽然在某些情况下它确实有用，但我发现大多数时候我认为我需要它，但我真的不需要。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2008-12-12T14:07:42.680

给 C#[隐式](http://blog.tmorris.net/implicits-for-the-fearless/)，你不会错过多重继承，或任何继承。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2008-12-12T14:09:44.783

不，我不。我使用所有其他 OO 功能来开发我想要的东西。我使用接口和对象封装，我从不限制我想做的事情。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2008-12-12T14:10:28.463

我尽量不使用继承。每次我能做的越少。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2008-10-10T22:35:34.520

不，我们远离它。你现在确实需要它。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2010-02-18T06:57:00.737

除非钻石问题得到解决，否则不会。你可以使用组合，直到这个问题没有解决。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-10-09T22:35:51.263

我说不，直到钻石问题（类的多重继承不好的一个重要原因）得到充分解决并且解决方案与使用接口一样好。简而言之，钻石问题基本上与由于类的多重继承而导致类中的数据、方法和事件的潜在歧义有关。

P/S 你“很少”避免一个你急需的编程解决方案，因为它很难。“困难”不是没有多重继承的借口。多线程很难，但它在 C# 中可用。没有多重继承的一大原因是钻石问题（[http://en.wikipedia.org/wiki/Diamond_problem](http://en.wikipedia.org/wiki/Diamond_problem)）。一个类似的推理适用于您对更好的替代方案的评论（人们以不同的方式解决和思考，所以有时一个解决方案是一个坏主意）和合适的选项已经存在（为什么在 ADO.NET 成功并且成熟时创建 LINQ...由于以一个比另一个强。）

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-05-29T11:42:28.717

如果我们引入多重继承，那么我们将再次面临 C++ 的老钻石问题......

但是对于那些认为不可避免的人，我们仍然可以通过组合来引入多重继承效应（在一个对象中组合多个对象并公开将职责委托给组合对象并返回的公共方法）......

那么，为什么还要费心进行多重继承并使您的代码容易受到不可避免的异常的影响......

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2011-02-02T17:05:34.243

如果接口可以实现，它将使事情变得更容易，更少的代码。但是它们会被误用而不是正确使用吗？我认为，在您看到如何正确完成之前，您不会错过它。我对多重继承不安全的论点感到恼火。它不是。但几乎所有的语言实现都是。但我们需要它吗？，我不知道。

我更喜欢返回类型协方差，这可以很容易地添加（只需放松规则，在覆盖方法的返回类型上），并且总是安全的。

例子：

```
class shape {}

class circle : shape {}

interface part {
    shape Form();
}

interface wheel : part {
    circle Form();
} 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2009-09-11T08:56:43.343

我几乎不会错过 C# 中的多重继承。

如果您使用多重继承来定义实际的域模型，那么根据我的经验，您通常可以使用单一继承和一些好的设计模式来创建同样好的设计。

我发现多重继承具有真正价值的大多数地方不是域本身，而是一些需要您使用 MI 的技术/框架约束。使用 ATL 实现 COM 对象是一个很好的例子，说明您使用多重继承来实现 COM 对象所需的所有必要接口，并且是对丑陋（与 .NET 相比）技术的优雅解决方案。从它是一个 C++ 框架的角度来看是优雅的！

不过，我现在有一种情况，我可以使用多重继承。我有一个类需要从其他域对象派生功能，但它也需要可用于跨 AppDomain 调用。这意味着它必须从 MarshalByRefObject 继承。所以在这种特殊情况下，我真的很想从 MarshalByRefObject 和我的特定域对象中派生。然而这是不可能的，所以我的类必须实现与我的域对象相同的接口，并将调用转发到聚合实例。

但正如我所说，这是技术/框架施加约束的情况，而不是域模型本身。

* * *

## 回答 #34

> 赞同：-2
> 
> 时间：2008-10-10T23:16:52.673

接口是多重继承。事实上，我认为 Java/C# 类型接口是多重继承的“正确”实现。通过使用接口来强制进行多重继承，而不是允许从多个具体或抽象类进行继承，这会迫使开发人员使用组合/委托来进行代码重用。继承永远不应该用于代码重用，并且 C++ 类型多重继承的缺失迫使开发人员想出更好的设计类。

# asp.net - 在网站中获取 *.aspx 的代码

> ID：191692
> 
> 赞同：3
> 
> 时间：2008-10-10T14:50:21.603
> 
> 标签：asp.net, directory-traversal

有没有一种方法可以获取我网站中的所有 .aspx 文件？也许遍历站点的文件结构并添加到数组中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T14:52:43.253

```
Directory.GetFiles(HttpContext.Current.Server.MapPath(@"/"), "*.aspx", SearchOption.AllDirectories); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T14:51:43.753

使用 Directory.GetFiles("*.aspx")，可以获取目录下的所有文件。您可以递归地抓取任何子目录及其文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T14:55:24.057

请记住，您可以在 web.config 中没有实际文件的情况下定义 .aspx 页面。

# .net - 针对自定义数据源对象 + 数据网格的 DataTable + DataGrid 数据绑定性能

> ID：191697
> 
> 赞同：0
> 
> 时间：2008-10-10T14:51:48.700
> 
> 标签：.net, performance, data-binding, datatable

在我们的工业自动化应用程序中，我们需要在几毫秒内捕获和显示数据。

我们在数据网格控件和 DataTable 对象之间进行了数据绑定。我们有大约三百条记录需要在网格中显示。因此，我们每次获取记录时都会更新 300 条记录。

例子

```
 TabularViewTable tvt = _presenter.WorkItem.Items.Get<TabularViewTable> ("TabularViewTable");

        foreach (DataRow row in tvt.Rows)
        {
            row["Value"] = GetDataFast(row["Name"]);                
        } 
```

连接 10 台设备后，CPU 使用率下降 15%。如何使用 DataTable 或使用一些自定义数据源来提高性能

问候，

克里希吉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T15:05:29.920

您应该认真重新考虑您的用户界面：

*   真的有必要显示 300 个值吗？普通人不能同时专注于七件事以上，
*   即使您减少参数数量，刷新频率似乎也很高。

您可能应该执行以下操作：

*   创建一个仪表板，其中包含最重要数据的图形表示（图表、仪表等）
*   创建向下钻取表单和报告，以便用户可以查看系统在任何给定时间段内发生的情况

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T17:27:27.893

对于初学者，您需要从 DataTable 切换到 DataReader，因为它要快得多。其次，我会看一下延迟加载架构。绑定 50 个条目，当它们滚动到底部时，再绑定/加载 50 个。

# python - 配置python

> ID：191700
> 
> 赞同：2
> 
> 时间：2008-10-10T14:52:04.360
> 
> 标签：python, memory

我是 python 新手，正在努力寻找如何控制 python 进程可以占用的内存量？我在主内存大小超过 2 GB 的 Cento OS 机器上运行 python。Python 只占用了其中的 128mb，我想分配更多。在过去的半个小时里，我试图在整个互联网上搜索，但一无所获！为什么很难找到有关 python 相关内容的信息:(

如果有人能对如何为允许的内存大小、线程数等各种事情配置 python 有所了解，我会很高兴。

一个链接到一个描述 python 的大多数可控参数的站点将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-10T15:02:11.843

忘记这一切，python 只是根据需要分配更多的内存，没有像 java 中那样为 VM 提供无数的命令行参数，让它运行。对于所有命令行开关，您只需运行 python -h 或阅读 man python。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T15:12:27.270

你确定机器没有128M的进程限制吗？如果您在 Web 服务器中将 python 脚本作为 CGI 运行，则很可能设置了进程限制 - 您需要查看 Web 服务器配置。

# regex - 使用正则表达式如何找到一个被其他两个模式包围的模式而不包括周围的字符串？

> ID：191704
> 
> 赞同：4
> 
> 时间：2008-10-10T14:53:21.083
> 
> 标签：regex

我想使用正则表达式（Perl 兼容）能够找到被其他两个模式包围的模式，但不包括匹配中匹配周围模式的字符串。

例如，我希望能够找到以下字符串的出现：

> 富吧巴兹

但只有匹配包括中间部分：

> 酒吧

我知道这是可能的，但我不记得该怎么做。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T14:56:05.400

括号定义分组。

```
"Foo (Bar) Baz" 
```

例子

```
~> cat test.pl
$a = "The Foo Bar Baz was lass";

$a =~ m/Foo (Bar) Baz/;

print $1,"\n";
~> perl test.pl
Bar 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T14:56:28.300

使用[环视](http://www.regular-expressions.info/lookaround.html)：

```
(?<=Foo\s)Bar(?=\sBaz) 
```

这将匹配前面为“Foo”并后面为“Baz”的任何“Bar”，通过单个空格分隔。“Foo”和“Baz”不会出现在决赛中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-10T20:17:02.240

在一般情况下，您可能不能。最简单的方法是匹配所有内容并使用反向引用来捕获感兴趣的部分：

```
Foo\s+(Bar)\s+Baz 
```

这与不包括匹配中的周围文本不同。如果您只想提取“Bar”，这可能并不重要，但如果您多次匹配同一个字符串并且需要从上一次匹配停止的地方继续，这可能并不重要。

在某些情况下，环顾会起作用。托马拉克的建议：

```
(?<=Foo\s)Bar(?=\sBaz) 
```

仅适用于固定宽度的后视（至少在 Perl 中）。从 Perl 5.10 开始，`\K`断言可用于有效地提供可变宽度的后视：

```
Foo\s+\KBar(?=\s+Baz) 
```

它应该能够在所有情况下执行您要求的操作，但需要您在 Perl 5.10 中实现它。

虽然这很方便，但没有等价`\K`于结束匹配的文本，因此您必须使用前瞻。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T14:57:16.533

$string =~ m/Foo (Bar) Baz/

1美元

这可能不是您想要的，因为匹配仍然是“Foo Bar Baz”。但它向您展示了如何获取您感兴趣的部分。否则，您可以使用前瞻和后视来获得匹配而不消耗字符......

# c# - 沮丧地尝试从 C# 中的参数读取路径

> ID：191732
> 
> 赞同：1
> 
> 时间：2008-10-10T14:58:06.003
> 
> 标签：c#

我正在传递 /file:c:\myfile.doc 并且我正在返回“/file:c:\myfile.doc”而不是“C:\myfile.doc”，有人可以告诉我哪里出错了?

```
 if (entry.ToUpper().IndexOf("FILE") != -1)
            {
                //override default log location
                MyFileLocation = entry.Split(new char[] {'='})[1];
            } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T15:01:59.753

您正在拆分“=”而不是“：”

尝试

```
 if (entry.ToUpper().IndexOf("FILE:") == 0)
    {
         //override default log location
         MyFileLocation location = entry.Split(new char[] {':'},2)[1];
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T15:07:34.643

最简单的方法是只取一个子字符串。由于您是从命令行读取的，因此“/file:”部分将始终保持一致。

```
entry.Substring(6); 
```

这将返回“/file:”之后的所有内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T15:21:55.907

不是一个答案，因为我认为它已经得到了很好的回答，但是正如你所说你是一个初学者，我想我会指出：

```
entry.split(new char[]{':'}); 
```

可：

```
entry.split(':'); 
```

这使用：

```
split(params char[] separator); 
```

这对于新的 C# 程序员来说可能具有欺骗性，因为 params 关键字意味着您实际上可以将 1 传递给许多字符，例如：

```
entry.split(':','.',' '); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T15:03:44.790

你也可以去掉'file:'部分。它是明确定义的，并且会保持不变，所以它不是那么糟糕。不是很好，但也不可怕。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T15:07:00.417

[这是命令行参数解析器](http://www.codeproject.com/KB/recipes/yaclap.aspx)的一个很好的例子。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T15:08:56.573

您发布的代码需要参数`/file=c:\myfile.doc`。

要么使用它作为参数，要么在冒号 ( **:** ) 而不是等号 ( **=** ) 上拆分。

# php - 基于 PHP 的表单验证

> ID：191734
> 
> 赞同：1
> 
> 时间：2008-10-10T14:58:31.867
> 
> 标签：php, validation, smarty

我正在寻找一个易于使用、相当完整的 php 表单验证解决方案。我记得一年前在 HMTL 端使用了一些标签，然后捕获了 OB 以用一些非常严肃的代码替换它们。这感觉有点像杀了我，但我现在并不是真的想对自己发疯。我正在使用 SMARTY，所以我使用的任何东西都不应该扔太多曲线球。

我将验证基本信息、姓名、地址、电子邮件、信用卡号（格式验证 OK）...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T15:09:13.530

由于您已经在使用 Smarty，您可能需要考虑 PEAR 包[HTML_QuickForm](http://pear.php.net/package/HTML_QuickForm)（此页面说它已被 v2 取代，但仍处于 alpha 阶段。V1 非常可靠）。

该包允许您在一个简单、直接的 API 中构建和处理您的表单，然后有一个与 Smarty 一起使用的渲染器类。基本上，您可以将整个表单作为一组对象吐出，然后 Smarty 可以为您渲染。您可以使用 CSS 控制外观。HTML_QuickForm 可以配置为具有客户端或服务器端验证，或两者兼而有之。您只需设置验证规则，它就可以正常工作。希望有帮助。

# sql-server - 给 DROP PROCEDURE 一个参数

> ID：191740
> 
> 赞同：6
> 
> 时间：2008-10-10T15:01:15.980
> 
> 标签：sql-server, tsql

我是第一次使用 SqlServer，在我们的每一个创建过程脚本中，都有如下代码块来删除该过程（如果它已经存在）：

```
IF EXISTS (SELECT *
           FROM information_schema.routines
           WHERE routine_name = 'SomeProcedureName'
           AND routine_type = 'PROCEDURE'

BEGIN
    DROP PROCEDURE SomeProcedureName
END
//then the procedure definition 
```

为了停止在每个文件中剪切和粘贴此样板代码，我想将此代码放在它自己的存储过程中，以便脚本看起来像这样：

```
DropIfRequired('SomeProcedureName')
//then the procedure definition 
```

我对解决方案的尝试是：

```
CREATE PROCEDURE DropIfRequired
(
    @procedureName varchar
)
AS
IF EXISTS (SELECT * FROM information_schema.routines 
           WHERE routine_name = @procedureName 
           AND routine_type = 'PROCEDURE') 
BEGIN
    DROP PROCEDURE @procedureName
END 
```

但是我收到以下错误：

消息 102，级别 15，状态 1，过程 DeleteProcedure，第 10 行“@procedureName”附近的语法不正确。

任何想法如何做我想做的事？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T15:09:02.017

完整的答案是：

```
声明 @SQL VARCHAR(8000)
选择 @SQL = 'USE' + DB_NAME() + CHAR(10)
SET @SQL = @SQL + '删除程序' + @procName
--打印@SQL
执行（@SQL）

```

仅当您登录的默认数据库设置为您想要的数据库时，安德鲁给出的那个才有效。使用动态 sql 时，您将获得一个新的数据库上下文。因此，如果您没有设置默认数据库，您将从 master 执行命令。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T15:12:45.147

需要注意的一点是，在 DropIfRequired 过程中，您已将过程名称定义如下：

```
CREATE PROCEDURE DropIfRequired
(    
   @procedureName varchar
) 
```

您需要定义 varchar 参数的长度，否则 SQL 将假定长度为一个字符。相反，请执行以下操作（对于大多数过程名称来说，1000 应该绰绰有余）

```
CREATE PROCEDURE DropIfRequired
(    
   @procedureName varchar(1000)
) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T15:04:28.767

它缺少引号，请尝试使用 exec 语句添加它们。

```
EXEC( 'DROP PROCEDURE ''' + @procName + '''') ( all single quotes) 
```

# javascript - 如何从 DOM 访问选择框选项的“显示”文本？

> ID：191746
> 
> 赞同：3
> 
> 时间：2008-10-10T15:02:32.920
> 
> 标签：javascript, dom

给定以下 HTML：

```
<select name="my_dropdown" id="my_dropdown">
<option value="1">displayed text 1</option>
</select> 
```

如何使用 Javascript/DOM 获取字符串“显示的文本 1”？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-10T15:07:31.460

```
var sel = document.getElementById("my_dropdown");

//get the selected option
var selectedText = sel.options[sel.selectedIndex].text;

//or get the first option
var optionText = sel.options[0].text;

//or get the option with value="1"
for(var i=0; i<sel.options.length; i++){
    if(sel.options[i].value == "1"){
        var valueIsOneText = sel.options[i].text;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T15:09:22.610

```
var mySelect = document.forms["my_form"].my_dropdown;
// or if you select has a id
var mySelect = document.getElementById("my_dropdown");
var text = mySelect.options[mySelect.selectedIndex].text; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T16:34:44.497

假设您想要**所选**选项的文本：

```
var select = document.getElementById('my_dropdown');
for(var i = 0; i < select.options.length; i++) {
    if(select.options[i].selected) {
        break;
    }
}
var selectText = select.options[i].text; 
```

在原型中：

```
var selectText = $$('#my_dropdown option[selected]')[0].text; 
```

Edit: And jQuery for completeness' sake (assuming jQuery's CSS selector support is roughly equivalent to that of Prototype's):

```
var selectText = $('#my_dropdown option[selected]').get(0).text; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T15:04:40.887

显示的文本是选项节点的子节点。您可以使用：

```
myOptionNode.childNodes[0]; 
```

访问它，假设文本节点是选项内唯一的东西（而不是其他标签）。

**编辑：** 哦，是的，正如其他人提到的，我完全忘记了：

```
myOptionNode.text; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T15:17:49.100

假设您稍微修改了代码以在 id/class 上添加一个 id / class 并使用 jQuery，您可能会得到以下内容。它将为每个选项弹出一个带有选项文本的警报。您可能不想提醒所有文本，但它首先说明了如何获取文本：

```
$('select#id option').each(function() {
  警报($(this).text());
});

```

如果您使用类而不是 id，那么您只需将“select#id”更改为“select.class”。如果您不想添加类/ID，还有其他方法可以选择。

如果您想将这条路线作为读者的活动，我会留下这些方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T15:15:31.053

如果您使用的是[Prototype](http://www.prototypejs.org)，则可以这样处理：

```
$$('#my_dropdown option[value=1]').each( function(elem){
                alert(elem.text);
            }); 
```

上面使用了一个 CSS 选择器，该选择器表示找到所有带有**id="my_dropdown"**的元素内的**value="1"****选项**标签。

 ****# php - 通过引用使用数组

> ID：191748
> 
> 赞同：0
> 
> 时间：2008-10-10T15:02:38.287
> 
> 标签：php, arrays, reference

为什么以下代码在 PHP 中“崩溃”？

```
$normal_array       = array();
$array_of_arrayrefs = array( &$normal_array );

end( $array_of_arrayrefs )["one"] = 1; // choking on this one 
```

预期的结果是最后的代码行附加了具有值`$normal_array`的键，但没有任何输出，甚至没有打印此代码之前的内容。在此场景的实际上下文中，我使用 end() 函数始终附加到最后一个数组引用。`one``1`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T15:08:05.890

这不会崩溃，它只是包含一个语法错误：

```
end( $array_of_arrayrefs )["one"] = 1; 
```

不幸的是，您不能将函数返回值视为 PHP 中的数组。您必须明确分配值。不幸的是，这在这里不起作用，因为`end`会复制返回值。

# c++ - 如何连接 std::string 和 int

> ID：191757
> 
> 赞同：734
> 
> 时间：2008-10-10T15:05:05.473
> 
> 标签：c++, integer, concatenation, stdstring

我认为这将非常简单，但它提出了一些困难。如果我有

```
std::string name = "John";
int age = 21; 
```

我如何将它们组合成一个字符串`"John21"`？

* * *

## 回答 #1

> 赞同：1271
> 
> 时间：2009-05-22T21:16:32.090

按字母顺序：

```
std::string name = "John";
int age = 21;
std::string result;

// 1\. with Boost
result = name + boost::lexical_cast<std::string>(age);

// 2\. with C++11
result = name + std::to_string(age);

// 3\. with FastFormat.Format
fastformat::fmt(result, "{0}{1}", name, age);

// 4\. with FastFormat.Write
fastformat::write(result, name, age);

// 5\. with the {fmt} library
result = fmt::format("{}{}", name, age);

// 6\. with IOStreams
std::stringstream sstm;
sstm << name << age;
result = sstm.str();

// 7\. with itoa
char numstr[21]; // enough to hold all numbers up to 64-bits
result = name + itoa(age, numstr, 10);

// 8\. with sprintf
char numstr[21]; // enough to hold all numbers up to 64-bits
sprintf(numstr, "%d", age);
result = name + numstr;

// 9\. with STLSoft's integer_to_string
char numstr[21]; // enough to hold all numbers up to 64-bits
result = name + stlsoft::integer_to_string(numstr, 21, age);

// 10\. with STLSoft's winstl::int_to_string()
result = name + winstl::int_to_string(age);

// 11\. With Poco NumberFormatter
result = name + Poco::NumberFormatter().format(age); 
```

1.  是安全的，但很慢；需要[Boost](http://www.boost.org/)（仅标题）；大多数/所有平台
2.  是安全的，需要 C++11（[to_string()](http://www.cplusplus.com/reference/string/to_string/)已经包含在`#include <string>`）
3.  安全、快捷；需要[FastFormat](http://fastformat.sourceforge.net/)，必须编译；大多数/所有平台
4.  （*同上*）
5.  安全、快捷；需要[{fmt} 库](https://github.com/fmtlib/fmt)，可以编译或以仅头文件模式使用；大多数/所有平台
6.  安全、缓慢、冗长；需要`#include <sstream>`（来自标准 C++）
7.  脆弱（必须提供足够大的缓冲区）、快速且冗长；itoa() 是一个非标准扩展，不保证适用于所有平台
8.  脆弱（必须提供足够大的缓冲区）、快速且冗长；什么都不需要（是标准的 C++）；所有平台
9.  很脆弱（你必须提供足够大的缓冲区），[可能是最快的转换](http://www.ddj.com/cpp/184401596)，冗长；需要[STLSoft](http://www.stlsoft.org/)（仅标题）；大多数/所有平台
10.  安全（你不会在单个语句中使用多个[int_to_string()调用），快速；](http://www.stlsoft.org/doc-1.9/int%5F%5Fto%5F%5Fstring%5F8hpp.html)需要[STLSoft](http://www.stlsoft.org/)（仅标题）；仅限 Windows
11.  是安全的，但很慢；需要[Poco C++](https://pocoproject.org/)；大多数/所有平台

* * *

## 回答 #2

> 赞同：304
> 
> 时间：2012-08-08T08:17:27.660

在 C++11 中，您可以使用`std::to_string`，例如：

```
auto result = name + std::to_string( age ); 
```

* * *

## 回答 #3

> 赞同：91
> 
> 时间：2008-10-10T15:11:04.697

如果你有 Boost，你可以使用`boost::lexical_cast<std::string>(age)`.

另一种方法是使用字符串流：

```
std::stringstream ss;
ss << age;
std::cout << name << ss.str() << std::endl; 
```

第三种方法是使用`sprintf`或`snprintf`来自 C 库。

```
char buffer[128];
snprintf(buffer, sizeof(buffer), "%s%d", name.c_str(), age);
std::cout << buffer << std::endl; 
```

其他海报建议使用`itoa`. 这不是标准功能，因此如果您使用它，您的代码将无法移植。有些编译器不支持它。

* * *

## 回答 #4

> 赞同：84
> 
> 时间：2008-10-10T15:09:47.540

```
#include <iostream>
#include <sstream>

std::ostringstream o;
o << name << age;
std::cout << o.str(); 
```

* * *

## 回答 #5

> 赞同：58
> 
> 时间：2008-10-10T15:09:08.040

```
#include <iostream>
#include <string>
#include <sstream>
using namespace std;
string itos(int i) // convert int to string
{
    stringstream s;
    s << i;
    return s.str();
} 
```

无耻地从[http://www.research.att.com/~bs/bs_faq2.html](http://www.research.att.com/~bs/bs_faq2.html)窃取。

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2014-12-21T21:50:56.137

这是最简单的方法：

```
string s = name + std::to_string(age); 
```

* * *

## 回答 #7

> 赞同：28
> 
> 时间：2013-05-27T21:56:51.723

如果你有 C++11，你可以使用`std::to_string`.

例子：

```
std::string name = "John";
int age = 21;

name += std::to_string(age);

std::cout << name; 
```

输出：

```
John21 
```

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2008-10-10T15:56:48.520

在我看来，最简单的答案是使用该`sprintf`功能：

```
sprintf(outString,"%s%d",name,age); 
```

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2008-10-10T15:12:52.400

```
#include <string>
#include <sstream>
using namespace std;
string concatenate(std::string const& name, int i)
{
    stringstream s;
    s << name << i;
    return s.str();
} 
```

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2008-10-10T19:53:37.153

```
#include <sstream>

template <class T>
inline std::string to_string (const T& t)
{
   std::stringstream ss;
   ss << t;
   return ss.str();
} 
```

然后你的用法看起来像这样

```
 std::string szName = "John";
   int numAge = 23;
   szName += to_string<int>(numAge);
   cout << szName << endl; 
```

[谷歌搜索](http://notfaq.wordpress.com/2006/08/30/c-convert-int-to-string/)[并测试：p]

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2018-06-29T03:39:17.260

这个问题可以通过多种方式解决。我将以两种方式展示它：

1.  使用 将数字转换为字符串`to_string(i)`。

2.  使用字符串流。

    代码：

    ```
    #include <string>
    #include <sstream>
    #include <bits/stdc++.h>
    #include <iostream>
    using namespace std;

    int main() {
        string name = "John";
        int age = 21;

        string answer1 = "";
        // Method 1). string s1 = to_string(age).

        string s1=to_string(age); // Know the integer get converted into string
        // where as we know that concatenation can easily be done using '+' in C++

        answer1 = name + s1;

        cout << answer1 << endl;

        // Method 2). Using string streams

        ostringstream s2;

        s2 << age;

        string s3 = s2.str(); // The str() function will convert a number into a string

        string answer2 = "";  // For concatenation of strings.

        answer2 = name + s3;

        cout << answer2 << endl;

        return 0;
    } 
    ```

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2018-04-29T17:12:55.867

在 C++20 中，您将能够：

```
auto result = std::format("{}{}", name, age); 
```

同时您可以使用[{fmt} 库](https://github.com/fmtlib/fmt)，`std::format`它基于：

```
auto result = fmt::format("{}{}", name, age); 
```

**免责声明**：我是 {fmt} 库和 C++20 的作者`std::format`。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2011-11-03T13:26:07.690

如果您想`+`用于连接任何具有输出运算符的内容，您可以提供以下模板版本`operator+`：

```
template <typename L, typename R> std::string operator+(L left, R right) {
  std::ostringstream os;
  os << left << right;
  return os.str();
} 
```

然后你可以用简单的方式编写你的连接：

```
std::string foo("the answer is ");
int i = 42;
std::string bar(foo + i);    
std::cout << bar << std::endl; 
```

输出：

```
the answer is 42 
```

这不是最有效的方法，但除非您在循环中进行大量连接，否则您不需要最有效的方法。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2008-10-10T17:13:53.780

如果您使用的是 MFC，则可以使用 CString

```
CString nameAge = "";
nameAge.Format("%s%d", "John", 21); 
```

托管 C++ 也有一个 [字符串格式化程序](http://msdn.microsoft.com/en-us/library/fht0f5be.aspx)。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-10-10T22:08:27.583

std::ostringstream 是一个很好的方法，但有时这个额外的技巧可能会很方便地将格式转换为单行：

```
#include <sstream>
#define MAKE_STRING(tokens) /****************/ \
    static_cast<std::ostringstream&>(          \
        std::ostringstream().flush() << tokens \
    ).str()                                    \
    /**/ 
```

现在您可以像这样格式化字符串：

```
int main() {
    int i = 123;
    std::string message = MAKE_STRING("i = " << i);
    std::cout << message << std::endl; // prints: "i = 123"
} 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2011-08-10T13:29:46.240

由于一个与 Qt 相关的问题已被关闭，有利于这个问题，这里是如何使用 Qt 来做到这一点：

```
QString string = QString("Some string %1 with an int somewhere").arg(someIntVariable);
string.append(someOtherIntVariable); 
```

字符串变量现在有 someIntVariable 的值代替 %1，最后有 someOtherIntVariable 的值。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2010-10-04T10:00:46.697

有更多选项可用于将整数（或其他数字对象）与字符串连接起来。它是[Boost.Format](http://www.boost.org/doc/libs/release/libs/format/index.html)

```
#include <boost/format.hpp>
#include <string>
int main()
{
    using boost::format;

    int age = 22;
    std::string str_age = str(format("age is %1%") % age);
} 
```

和来自[Boost.Spirit](http://boost-spirit.com) (v2)的 Karma

```
#include <boost/spirit/include/karma.hpp>
#include <iterator>
#include <string>
int main()
{
    using namespace boost::spirit;

    int age = 22;
    std::string str_age("age is ");
    std::back_insert_iterator<std::string> sink(str_age);
    karma::generate(sink, int_, age);

    return 0;
} 
```

Boost.Spirit Karma 声称是[整数到字符串](http://boost-spirit.com/home/2010/03/09/integer-to-string-conversion-karma-fastest-again/)转换的最快选项之一。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2018-08-03T07:09:47.527

*   std::ostringstream

> ```
> #include <sstream>
> 
> std::ostringstream s;
> s << "John " << age;
> std::string query(s.str()); 
> ```

*   std::to_string (C++11)

> ```
> std::string query("John " + std::to_string(age)); 
> ```

*   boost::lexical_cast

> ```
> #include <boost/lexical_cast.hpp>
> 
> std::string query("John " + boost::lexical_cast<std::string>(age)); 
> ```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2020-03-30T11:55:53.987

作为一个班轮：`name += std::to_string(age);`

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2008-10-10T15:09:04.873

常见答案：[itoa()](http://www.cplusplus.com/reference/clibrary/cstdlib/itoa.html)

这是不好的。 `itoa`是非标准的，正如[这里](https://stackoverflow.com/questions/190229/where-is-the-itoa-function-in-linux)所指出的。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2013-11-25T13:57:01.117

下面是如何使用 IOStreams 库中的解析和格式化方面将 int 附加到字符串的实现。

```
#include <iostream>
#include <locale>
#include <string>

template <class Facet>
struct erasable_facet : Facet
{
    erasable_facet() : Facet(1) { }
    ~erasable_facet() { }
};

void append_int(std::string& s, int n)
{
    erasable_facet<std::num_put<char,
                                std::back_insert_iterator<std::string>>> facet;
    std::ios str(nullptr);

    facet.put(std::back_inserter(s), str,
                                     str.fill(), static_cast<unsigned long>(n));
}

int main()
{
    std::string str = "ID: ";
    int id = 123;

    append_int(str, id);

    std::cout << str; // ID: 123
} 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2016-09-28T18:15:44.393

您可以使用下面给出的简单技巧将 int 连接到字符串，但请注意，这只适用于整数为单个数字的情况。否则，将整数逐位添加到该字符串。

```
string name = "John";
int age = 5;
char temp = 5 + '0';
name = name + temp;
cout << name << endl;

Output:  John5 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2013-08-28T13:23:43.720

我写了一个函数，它以 int 数字为参数，并将其转换为字符串文字。此函数依赖于将单个数字转换为其等效字符的另一个函数：

```
char intToChar(int num)
{
    if (num < 10 && num >= 0)
    {
        return num + 48;
        //48 is the number that we add to an integer number to have its character equivalent (see the unsigned ASCII table)
    }
    else
    {
        return '*';
    }
}

string intToString(int num)
{
    int digits = 0, process, single;
    string numString;
    process = num;

    // The following process the number of digits in num
    while (process != 0)
    {
        single  = process % 10; // 'single' now holds the rightmost portion of the int
        process = (process - single)/10;
        // Take out the rightmost number of the int (it's a zero in this portion of the int), then divide it by 10
        // The above combination eliminates the rightmost portion of the int
        digits ++;
    }

    process = num;

    // Fill the numString with '*' times digits
    for (int i = 0; i < digits; i++)
    {
        numString += '*';
    }

    for (int i = digits-1; i >= 0; i--)
    {
        single = process % 10;
        numString[i] = intToChar ( single);
        process = (process - single) / 10;
    }

    return numString;
} 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2021-05-12T15:26:47.617

在 C++ 20 中，您可以拥有一个可变参数 lambda，它可以在几行中将任意可流式类型连接到一个字符串：

```
auto make_string=[os=std::ostringstream{}](auto&& ...p) mutable 
{ 
  (os << ... << std::forward<decltype(p)>(p) ); 
  return std::move(os).str();
};

int main() {
std::cout << make_string("Hello world: ",4,2, " is ", 42.0);
} 
```

见[https://godbolt.org/z/dEe9h75eb](https://godbolt.org/z/dEe9h75eb)

使用 move(os).str() 保证 ostringstream 对象的字符串缓冲区在下次调用 lambda 时为空。

# java - 查找哪个 jar 中的哪个类具有给定的 serialVersionUID

> ID：191766
> 
> 赞同：1
> 
> 时间：2008-10-10T15:07:28.557
> 
> 标签：java, serialversionuid

当我得到一个 java.io.InvalidClassException 时，它给了我它想要的 serialVersionUID，以及它得到的 serialVersionUID。有没有一种简单的方法可以判断我的几十个 jar 中的哪一个使用了错误的 serialVersionUID？

**更新**：我应该提到我们的意图是同时更新所有内容，但我正在尝试调试我们构建和部署过程中的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T18:51:56.327

对 jar 中的每个类使用来自 sun jdk 的 serialver 工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T15:17:58.037

处理这种麻烦的最好方法是同时更新服务器端和客户端的 jars。这将保证双方的类版本相同，并且在序列化/反序列化时不会遇到麻烦。每次遇到此问题时跟踪串行 UID 并不能解决任何问题，只会浪费大量时间和资源。花一些时间并实施适当的部署/打包策略要好得多。

如果你真的没有其他选择，你可以编写一个工具，从每个 jar 中加载一个类（使用 URLClassLoader），然后使用它`java.io.ObjectStreamClass.getSerialVersionUID()`来获取你需要的信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-09T19:47:08.483

请记住，各种 JVM/容器/类加载器组合对于应该从引导类路径和应用程序/webapp 类路径加载哪些类有不同的看法。

由于 serialver 总是首先从 bootclasspath 加载，这很复杂，因此您可能需要使用 -J-Xbootclasspath 来模拟不同的行为：

```
f=/System/Library/Frameworks/JavaVM.framework/Versions/1.5/Classes/
serialver -J-Xbootclasspath:.:$f/dt.jar:$f/classes.jar:$f/ui.jar javax.xml.namespace.QName 
```

另一种方法是使用javap，例如：

```
javap -verbose -bootclasspath . javax.xml.namespace.QName | sed -n -e '/static.*serialVersionUID/{N;p;}' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-09-24T18:02:43.200

根据 SO 中的一些答案，我想出了一个实用程序来执行此操作。这是我的课。

```
package jar;

import java.io.File;
import java.io.IOException;
import java.io.ObjectStreamClass;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLClassLoader;
import java.util.ArrayList;
import java.util.Enumeration;
import java.util.HashSet;
import java.util.jar.JarEntry;
import java.util.jar.JarFile;

/**
 * Searches all the jars in a given directory for a class with the given UID.
 * Additional directories can be specified to support with loading the jars.  
 * For example, you might want to load the lib dir from your app server to get
 * the Servlet API, etc.  
 */
public class JarUidSearch
{
    public static void main(String args[])
            throws IOException, ClassNotFoundException
    {
        if( args.length < 2)
        {
            System.err.println("Usage: <UID to search for> <directory with jars to search> [additional directories with jars]");
            System.exit(-1);
        }

        long targetUID = Long.parseLong(args[0]);

        ArrayList<URL> urls = new ArrayList<URL>();

        File libDir = new File(args[1]);

        for (int i = 1; i < args.length; i++)
        {
            gatherJars(urls, new File(args[i]));
        }

        File[] files = libDir.listFiles();

        for (File file : files)
        {
            try
            {
                checkJar(targetUID, urls, file);
            }
            catch(Throwable t)
            {
                System.err.println("checkJar for " + file + " threw: " + t);
                t.printStackTrace();
            }   
        }
    }

    /**
     * 
     * @param urls
     * @param libDir
     * @throws MalformedURLException
     */
    public static void gatherJars(ArrayList<URL> urls, File libDir)
            throws MalformedURLException
    {
        File[] files = libDir.listFiles();

        for (File file : files)
        {
            urls.add(file.toURL());
        }
    }

    /**
     * 
     * @param urls
     * @param file
     * @throws IOException
     * @throws ClassNotFoundException
     */
    public static void checkJar(long targetUID, ArrayList<URL> urls, File file)
            throws IOException, ClassNotFoundException
    {
        System.out.println("Checking: " + file);
        JarFile jarFile = new JarFile(file);
        Enumeration allEntries = jarFile.entries();
        while (allEntries.hasMoreElements())
        {
            JarEntry entry = (JarEntry) allEntries.nextElement();
            String name = entry.getName();

            if (!name.endsWith(".class"))
            {
                // System.out.println("Skipping: " + name);
                continue;
            }

            try
            {
                URLClassLoader loader = URLClassLoader.newInstance((URL[]) urls.toArray(new URL[0]));
                String className = name.substring(0,
                    name.length() - ".class".length()).replaceAll("/", ".");
                Class<?> clazz = loader.loadClass(className);
                ObjectStreamClass lookup = ObjectStreamClass.lookup(clazz);

                if (lookup != null)
                {
                    long uid = lookup.getSerialVersionUID();

                    if (targetUID == uid)
                    {
                        System.out.println(file + " has class: " + clazz);
                    }
                }
            }
            catch (Throwable e)
            {
                System.err.println("entry " + name + " caused Exception: " + e);
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T16:41:12.520

笨拙但有效

我会使用逆向工程工具
1）解压缩 jar
2）在类文件树上运行 jad
3）在这个新的源树上运行 grep 或任何其他查找工具来查找串行版本的 uid。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-20T06:20:25.413

我在 Linux 上使用这个命令来检查当前目录中的所有 Jar：

```
find . -type f -name "*.jar" -exec sh -c 'javap -verbose -p -constants -cp {} com.myCompany.myClass | grep serialVersionUID' \; 
```

请记住，serialVersionUID 可能未在您的类中明确声明。在这种情况下，serialVersionUID 将在运行时计算，并且无法使用上面的 find 命令进行搜索。

# sql - 重命名表 SQL Server，通过 PK 和 FK 级联更改

> ID：191787
> 
> 赞同：5
> 
> 时间：2008-10-10T15:11:13.807
> 
> 标签：sql, sql-server, tsql, rename

我想找到一个 sql 命令或可以做到这一点的东西，我有一个名为 tblFoo 的表，我想将它命名为 tblFooBar。但是，我希望主键也可以更改，例如，目前是：

```
CONSTRAINT [PK_tblFoo] PRIMARY KEY CLUSTERED 
```

我想要更改名称以将其更改为：

```
CONSTRAINT [PK_tblFooBar] PRIMARY KEY CLUSTERED 
```

然后，递归地遍历并在所有具有外键关系的表上级联此更改，例如。由此：

```
CHECK ADD  CONSTRAINT [FK_tblContent_tblFoo] FOREIGN KEY([fooID]) 
```

对此：

```
 CHECK ADD  CONSTRAINT [FK_tblContent_tblFooBar] FOREIGN KEY([fooID]) 
```

自然地，我尽量不去手动完成这一切，因为a）这是一个容易出错的过程，b）它不能扩展。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T15:31:06.437

这只是我的想法，并不完整（您需要为索引添加类似的代码）。此外，您需要添加代码以避免重命名具有相同基本名称但附加字符的表中的对象 - 例如，此代码还将列出 tblFoo2 及其所有关联对象。希望这对你来说是一个开始。

```
DECLARE
    @old_name   VARCHAR(100),
    @new_name   VARCHAR(100)

SET @old_name = 'tblFoo'
SET @new_name = 'tblFooBar'

SELECT
    'EXEC sp_rename ''' + name + ''', ''' + REPLACE(name, @old_name, @new_name) + ''''
FROM dbo.sysobjects
WHERE name LIKE '%' + @old_name + '%' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-12-18T12:15:48.650

汤姆的好回答
我刚刚在这里扩展了他的查询以包括索引

```
declare
 @old nvarchar(100),
 @new nvarchar(100)

set @old = 'OldName'
set @new = 'NewName'

select 'EXEC sp_rename ''' + name + ''', ''' + 
  REPLACE(name, @old, @new) + ''''
 from sys.objects 
 where name like '%' + @old + '%'
union -- index renames
select 'EXEC sp_rename ''' + (sys.objects.name + '.' + sys.indexes.name)  +  ''', ''' +
  REPLACE(sys.indexes.name, @old, @new) + ''', ''INDEX'''
  from sys.objects 
   left join sys.indexes on sys.objects.object_id = sys.indexes.object_id
  where sys.indexes.name like '%' + @old + '%' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T16:51:30.500

[Red Gate SQL Refactor](http://www.red-gate.com/products/SQL_Refactor/index.htm)是一个可以减轻重命名表痛苦的好工具， 它会自动找到您的依赖项并为您解决所有这些问题。

粉丝 ：-）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T15:16:57.773

据我所知，SQL Server 不会直接执行此操作。您必须手动构建脚本才能进行更改。这可以通过为表定义生成 SQL（SSMS 将执行此操作）并对名称进行搜索和替换来实现。

# .net - .NET 中的两个有向列表枚举器

> ID：191788
> 
> 赞同：3
> 
> 时间：2008-10-10T15:12:03.837
> 
> 标签：.net

在我的 c# 应用程序中，我有一个使用枚举器导航的列表。它非常适合在列表中向前移动，但 Enumerator 类没有 MoveBack 方法。

是否有不同的类具有 MoveBack 方法，还是我需要自己编写？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T15:23:17.933

根据定义，使用 IEnumerator 接口的任何枚举器都必须在第一个元素之前开始，并在集合中向前迭代。简而言之：它们不支持向后遍历。

如果你想向后遍历，你需要编写自己的枚举函数，让你可以从任何你想要的地方开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T15:25:28.507

您可以反转列表并对其进行交互。或者，对于某些类，您可以从头到尾执行一个 for 循环并使用 ElementAt()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-21T14:22:16.383

有时我不得不使用仅提供前向迭代器的某些 C++ STL 容器来处理这种情况。如果您事先知道需要向后退多少个元素，则可以执行以下操作：

```
IEnumerator<int> e1 = yourListOfInt.GetEnumerator();
IEnumerator<int> e2 = e1;
for (int i = 0; i < 3; ++i) e2.MoveNext(); 
```

现在 e1 比 e2 领先三个元素。这是几年前我在 C++ 中的唯一解决方案。

但是，如果您使用的是列表，我假设您可以通过索引访问它？

# vb.net - 枚举参数

> ID：191791
> 
> 赞同：1
> 
> 时间：2008-10-10T15:12:28.050
> 
> 标签：vb.net, functional-programming, function

我希望在 vb.net 中找到一种方法来做到这一点：

假设您有函数调用 getPaint(Color)。您希望将调用限制为 (red,green,yellow) 的参数值。当他们输入该参数时，会为用户提供可用选项，例如布尔参数的功能。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T15:20:29.873

要将具有大量值的枚举限制为少数几个，您可以执行以下操作

## C＃

```
List<Color> allow = new List<Color> { Color.Red, Color.Green, Color.Yellow };
if (!allow.Contains(color))
{
    throw new ArguementException("Invalid Color");
} 
```

## VB

```
Dim allow As New List(Of Color)()
allow.Add(Color.Red)
allow.Add(Color.Green)
allow.Add(Color.Yellow)
If Not allow.Contains(color) Then
Throw New ArguementException("Invalid Color")
End If 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T15:16:24.657

希望我没有从你的问题中遗漏任何东西。使用这样的枚举：

```
Enum Color
    Red = 1
    Green = 2
    Yellow = 3
End Enum 
```

当你写`getPaint(Color`后跟一个 . （句号） Intellisense 系统会自动提示枚举中声明的三个选项（Red、Green、Yellow）。

# mouse - 如何让我的鼠标在 VMWare Server 虚拟机中正常工作？

> ID：191792
> 
> 赞同：3
> 
> 时间：2008-10-10T15:12:34.960
> 
> 标签：mouse, vmware

我的鼠标，在我的虚拟服务器虚拟机中都是抖动的，并且工作不顺畅。
在虚拟机之外它很好。

我的鼠标设置为使用 VMWare 指针设备，它说它工作正常。我已经尝试了每秒 100 和 200 次报告的采样率，但没有区别。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T15:25:07.167

安装 VMware Tools 并在 VMware 机器上的显示属性 -> 高级 -> 故障排除选项卡中启用完全加速。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-03T12:59:46.453

此外，请确保鼠标使用 VMware 驱动程序。有时它会恢复到一般的 PS/2 驱动程序，这可能会导致非常恼人的延迟。

# web-applications - 从一开始就为外联网设计？

> ID：191796
> 
> 赞同：2
> 
> 时间：2008-10-10T15:13:16.440
> 
> 标签：web-applications, extranet

我的任务是开发一个 Web 应用程序来涵盖我们的一项业务功能。它需要从我们的网络外部进行外部访问。同时，它需要相当快地完成。我在外联网应用程序方面没有任何经验，所以我不完全确定所涉及的内容。了解它需要时间。我想让应用程序先运行。

如果我决定不从一开始就包含外部访问并在以后添加它，我应该考虑什么样的事情？这从一开始就注定了？

谢谢，基思

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T15:26:23.323

当你为本地网络开发时，你可以认为很多事情是理所当然的：

1.  高速网络

2.  值得信赖的用户群

3.  所有用户的时区相同（这使得维护工作更容易安排）

4.  控制用户应该使用哪些浏览器和版本

5.  由于用户群的受信任性质，针对 LAN 身份验证系统进行身份验证或根本不进行身份验证

6.  网络服务器上的自定义端口号，因为用户和网络服务器之间没有防火墙（尽管这更多是部署问题）

在设计额外网络时，您将需要挑战所有这些假设。例如，您应该估计需要支持的最慢客户端连接。您的用户可能使用的最奇怪或最受限制的浏览器。

如果您决定使用 SSL，请从一开始就在最慢的连接上检查您的网站的性能。我已经看到许多 SSL 站点在慢速连接上的表现非常糟糕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T15:17:03.390

考虑：
您将如何进行身份验证？
不被闯入有多重要？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T15:29:25.207

我会考虑的几点。

1.  验证。谁将在外部使用它，谁将在内部使用它？他们应该能够访问网站的哪些部分？因此，尽早设计一种身份验证机制，以允许基于用户 ID 和组的访问。

2.  加载。内部用户可能很少，但外部会有多少用户？该解决方案应可扩展到预期用户的数量。

3.  外部用户是访客用户还是必须注册？构建用户注册组件。

无论是 Intranet 还是 Extranet，在将用户输入数据用于后端 SQL 等之前，您都应该采取明智的预防措施来验证用户输入数据。

# windows-vista - 在为 Windows XP 开发时，是否值得考虑使用 Windows Vista？

> ID：191806
> 
> 赞同：2
> 
> 时间：2008-10-10T15:15:49.617
> 
> 标签：windows-vista, windows-xp

在不同的帖子中对答案有相当多的评论，*[在 Windows 中编写错误日志的最佳位置在哪里？](https://stackoverflow.com/questions/191609/where-are-the-best-locations-to-write-an-error-log-in-windows)*，给我的印象是，Windows Vista 中有关标准文件夹 ( `%APPDATA%`; `%TEMP%`) 的很多事情都与 Windows XP 不同，在开发某些时候必须在 Windows 下运行的软件时，当然应该考虑到这一点。

但在我的公司，我认为这十年不会发生这种情况，也许未来也不会发生。我的意思是，中央 IT 仅在八个月前部署了 SP2，任何关于 SP3 的问题都会被忽视（好吧，如果你幸运的话......）

那么你的建议是什么？我应该重写我当前项目中的两个模块以使它们为 Windows Vista 做好准备，还是应该在真正需要它之前完全不理会它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-10T15:19:09.063

让它们为 Vista 做好准备，如果只是因为 Windows 7 将具有相同的更改。当你有机会的时候，最好现在就面向未来，而不是在时间很关键的时候。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-10T15:21:59.950

就个人而言，我会快速了解在您的应用程序中启用“Vista 支持”所需的工作量。

如果根据分配的项目更改时间可以接受工作量水平，那么最好在任何设计中考虑未来。

您比任何人都更了解您的实施！

我们在内部遇到了一些快捷方式问题，例如它们是在较旧的安装套件中生成的。这是我们目前正在解决的小问题，以使我们的 Vista 支持完全启动并运行。我相信你也会遇到一些“无法预料的”障碍。

祝你好运！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-10T15:41:28.927

在大多数桌面应用程序中支持 Windows Vista 的最重要的事情是使用像 %APPDATA% 这样的引用而不是硬编码路径。这应该解决任何更改的文件夹位置。并且不要在程序的安装文件夹中做任何需要写权限的事情。

有趣的是，这些规则也适用于 Windows XP。只是在过去，打破它们要容易得多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T15:21:11.963

没必要着急。到目前为止，这并不重要，谁知道 Windows 的下一个版本会是什么样子。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T15:26:37.647

如果您计划为 Windows Vista 升级您的软件，请查看*[Windows 徽标计划，软件的 Windows Vista 徽标计划要求](http://download.microsoft.com/download/8/e/4/8e4c929d-679a-4238-8c21-2dcc8ed1f35c/Windows%20Vista%20Software%20Logo%20Spec%201.1.doc)*（Microsoft Word 文档，183 KB，文件名*Windows Vista 软件徽标规范 1.1.doc*）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T15:34:15.540

由于您无法预见在不久的将来会升级操作系统，因此不必太担心。但是，无论何时更改代码，您都应该牢记操作系统升级的可能性。如果在您进行更改时，代码部分中有任何特定于操作系统的内容，请对其进行调整，使其独立于操作系统或以后易于定位和修改以使其独立于操作系统（取决于更新它需要多长时间）。

如果您遇到的情况只是解决较小的问题，请考虑将您的修复专门针对您知道（或怀疑可能）如果您的公司升级到 Vista 或 Windows 7 时需要调整代码的区域。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-10T15:36:03.837

不用担心，Windows 7 即将推出，您最好等着看他们为支持它做了哪些更改！你最不想做的就是花时间为 Vista 修复一些东西……然后为 Windows 7 重新修复它们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T15:18:07.273

贵公司是否打算升级到 Windows Vista？许多公司都忽略了 Windows Vista，并计划在下一个 Windows 版本问世时升级到它，希望它比 Windows Vista 更糟糕。如果是这样，那将完全是浪费时间。谁知道下一版本的 Windows 会发生什么变化。最好为新的 Windows 重写一次，而不是为 Windows Vista 重写一次，然后再为下一个 Windows 版本重写。

# asp.net - 使用 flashplayer 对话框批量上传文件

> ID：191808
> 
> 赞同：2
> 
> 时间：2008-10-10T15:16:00.477
> 
> 标签：asp.net, dojo, yui, flajaxian

我目前正在寻找允许人们一次选择多个文件以批量上传图像的方法。我正在为我的 ASP.NET Web 应用程序评估这些选项：

*   [YUI 上传器](http://developer.yahoo.com/yui/uploader/)
*   [弗拉贾先](http://www.codeplex.com/FlajaxianFileUpload)
*   [SWF上传](http://swfupload.org/)
*   [Dojo Toolkit 多文件上传器](http://www.sitepen.com/blog/2008/09/02/the-dojo-toolkit-multi-file-uploader/)

我倾向于 YUI，因为文档很清晰，而且我基本上已经编写了 Flajaxian 提供的文件上传器和缩略图，javascript 看起来也更紧凑。我什至无法开始评估 Dojo，因为我不清楚如何从 PHP 示例中获取与 .NET 集成的部分。

有没有人在这些方面有过非常好的或非常糟糕的经历？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T15:43:18.360

SWFUploader 似乎是这里的最佳选择。紧凑，可使用 CSS 设计样式，在 code.google.com 上开源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-02T16:58:22.753

感谢大家的意见，但我最终使用了[YUI Uploader](http://developer.yahoo.com/yui/uploader/)，因为这就是`flickr`用途，项目规范基本上是对`flickr`功能的分析。

使用它的体验基本上非常好，并且能够将它与`flickr`所做的进行比较也很有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T17:47:16.223

也看看这个。免费。

[http://www.codeproject.com/KB/aspnet/FlashUpload.aspx](http://www.codeproject.com/KB/aspnet/FlashUpload.aspx)

我正在为上传多个音乐文件而开发的应用程序中使用它。作者提供源代码为 VS 2008 项目和源 Flash/Flex 文件。奇迹般有效。

# .net - 如何为我的程序集创建自定义属性？

> ID：191812
> 
> 赞同：9
> 
> 时间：2008-10-10T15:16:30.130
> 
> 标签：.net, assemblies, attributes

如何为我的 .Net 程序集创建自定义属性，然后在 Windows 资源管理器的“详细信息”选项卡下可见？

与“文件描述”、“类型”、“产品版本”......等平行的东西

更新：引用我对 Lars 的评论……“虽然我希望在 Visual Studio 中执行此操作，但这当然不是我的首要任务。实际上，我希望将任何解决方案集成到现有的 nant 构建过程中。因此会影响程序集“post compile 完全可以接受。你听说过这样的工具吗？”

进一步更新：我不确定我所说的是否是一个属性，以澄清一下我想在以下属性页面的条目中创建什么......

![替代文字](https://i.stack.imgur.com/GgG90.png "Nunit 属性")

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T21:46:00.377

您的编译器不支持它。AssemblyFileVersionAttribute 和所有工作，因为编译器在您的程序集中生成一个名为[VERSIONINFO](http://msdn.microsoft.com/en-us/library/aa381058.aspx)的 win32 资源，其中包含该信息。这就是windows正在阅读的内容。其他属性只是与您的代码一起保存为元数据。

您可以在编译后制作一个工具来更改 VERSIONINFO 资源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T15:52:38.310

它还不是答案，但一种 1/2 的方法是使用：

```
[assembly: AssemblyDescription("One Line of Content Here")] 
```

这显示在“评论”下。

*（仍在研究，这是我一直想要的东西。）*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-25T16:02:31.130

唯一可以从命令行控制 VERSIONINFO 结构的任何字段并因此能够在构建过程中添加附加属性的工具是资源调谐器控制台：
[http ://www.reseditor.com/rtc-solution-version-info .htm](http://www.reseditor.com/rtc-solution-version-info.htm)

199 美元的价格似乎有点高……但如果你不想花几天时间在 C/C++ 上闲逛，那就太划算了。

# c++ - 可以跨局域网计算机使用管道吗？

> ID：191814
> 
> 赞同：2
> 
> 时间：2008-10-10T15:16:40.600
> 
> 标签：c++, c, ipc, pipe

可以跨局域网计算机使用管道吗？

特别是我正在寻找 Windows，但如果您有其他平台上的更多信息，那也将有助于以后找到此线程的其他人。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T15:21:20.527

是的他们可以。

> 命名管道可用于在同一台计算机上的进程之间或跨网络的不同计算机上的进程之间提供通信。如果服务器服务正在运行，所有命名管道都可以远程访问

[http://msdn.microsoft.com/en-us/library/aa365590.aspx](http://msdn.microsoft.com/en-us/library/aa365590.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T23:28:56.690

还应该注意的是，TCP/IP 连接实际上是一个管道，因为您将字节推入一端，它们从另一端出来。TCP/IP 连接几乎可以在您可能关心的任何平台上使用。

# css - 带有表单元素的 CSS 浮动 div 在 Mac 上的 Safari 3 中消失

> ID：191817
> 
> 赞同：2
> 
> 时间：2008-10-10T15:17:19.350
> 
> 标签：css, google-chrome, safari, webkit, css-float

我正在一起粗略布局并进行一些浏览器测试。以前从未遇到过此问题，请查看本页页脚中的联系表

[http://staging.terrilynn.com/fundraising/](http://staging.terrilynn.com/fundraising/)

有一个宽度为 298px 的 div 向右浮动，在源顺序中排在第一位。紧随其后的是其他几个 div，每个 div 的子表单元素都向左浮动。

应该出现在右侧浮动消息 div 左侧的 div 正在消失。

页面在 Firefox 中正确显示。任何帮助，将不胜感激。

```
<div id='footer-contact-form'>
  <h1>Request Information <span class='note'>(all fields required)</span></h1>
  <form class="monkForm" method="post" action="http://my.ekklesia360.com/FormBuilder/handleSubmit.php" id="footer-info-request">
    <fieldset>
      <legend>Footer Info Request</legend>
      <div class="textarea required" id="w2376">
        <p class="data">
          <label for="area_2376">Message</label>
          <textarea id="area_2376" name="e_2376" rows="5" cols="20"></textarea>
        </p>
      </div>
      <div class="text required" id="w2377">
        <p class="data">
          <label for="text_2377">Name</label>
          <input id="text_2377" type="text" name="e_2377" value="" />
        </p>
      </div>
      <div class="text required" id="w2378">
        <p class="data">
          <label for="text_2378">Phone</label>
          <input id="text_2378" type="text" name="e_2378" value="" />
        </p></div>
      <div class="text" id="w2379">
        <p class="data">
          <label for="text_2379">Email</label>
          <input id="text_2379" type="text" name="e_2379" value="" />
        </p>
      </div>
      <p id="formsubmit"><input type="submit" name="submit" value="Send" /></p>

      <input type="hidden" name="token" value="8143f99c1d01b4d1207dbe7860e5586d" />
      <input type="hidden" name="SITEID" value="2185" />
      <input type="hidden" name="cpBID" value="367780" />
      <input type="hidden" name="formslug" value="footer-info-request" />
      <input type="hidden" name="CMSCODE" value="EKK" />
      <input type="hidden" name="fkey" value="" />
    </fieldset>
  </form>
</div><!-- #footer-contact-form --> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T16:12:39.613

我想我发现了问题：

screen.css（第 382 行）

```
#footer-contact-form div {
margin:0 300px 10px 0;
overflow:hidden;
} 
```

“溢出：隐藏”导致问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T15:29:29.497

您是否尝试过不将`<p>`元素浮动到左侧？你为什么要这样做？当前布局中不需要它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T16:24:30.727

哇，这工作！

我正在使用溢出：隐藏来强制 div 包含浮动标签和输入元素。

但实际上输入元素上的浮点数并不是必需的。

非常感谢大家。

# c# - WCF - 返回大图像 - 你的经验和这样做的提示

> ID：191819
> 
> 赞同：4
> 
> 时间：2008-10-10T15:17:47.523
> 
> 标签：c#, .net, wcf

我们使用 WCF 服务层从存储库返回图像。一些图像是彩色的，多页的，几乎都是 TIFF 格式。我们遇到缓慢 - 许多问题之一。

1.) 你有什么通过 WCF 返回图片的经验 2.) 你有什么关于返回大图片的建议技巧吗？3.) 所有消息都通过 SOAP 进行序列化，对吗？
4.) wcf 在压缩大的 tiff 文件方面做得很差吗？

谢谢大家！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-11T04:36:30.173

好的 只是为了支持 ZombieSheep 和 Seba Gomez 的响应，您绝对应该考虑流式传输您的数据。通过这样做，您可以将 GZipStream 无缝集成到流程中。在客户端，您可以反转压缩过程并将流转换回您想要的图像。

通过使用流式传输，可以将选择数量的类用作参数/返回类型，并且您确实需要在整个过程中修改绑定。

这是有关启用流式传输的[MSDN 站点。](http://msdn.microsoft.com/en-us/library/ms789010.aspx)[这](http://msdn.microsoft.com/en-us/library/ms731913.aspx)是描述流合同限制的 MSDN 页面。

我假设你也在控制客户端代码，如果你不是，这可能真的很难。当我同时控制服务器和客户端时，我才使用流式传输。

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T15:41:17.210

如果您使用另一个 .Net 程序集作为您的客户端，您可以使用两种方法来返回大块数据，流式传输或 MTOM。

流式传输将允许您传递 TIFF 图像，就好像它是本地文件系统上的普通文件流一样。有关选择及其优缺点的更多详细信息，请参见[此处。](http://msdn.microsoft.com/en-us/library/aa751889.aspx)

不幸的是，您仍然需要传输大量数据，考虑到已经提出的观点，我看不出有任何解决办法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T15:48:59.253

我只是想补充一点，确保您的数据被流式传输而不是缓冲是非常重要的。

我在某处读到，即使您将 transferMode 设置为“Streamed”，如果您不使用 Stream 本身、消息或 IXmlSerializable 的实现，消息也不会流式传输。

确保你牢记这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T15:40:26.447

你用的是什么绑定？WCF 会有一些开销，但如果您将 basic-http 与 MTOM 一起使用，则会丢失大部分 base-64 开销。你仍然会有标题等。

另一种选择是（等待它......）在这里不使用 WCF - 也许只是一个返回二进制文件的处理程序（ashx 等）。

重新压缩 - WCF 本身不会参与压缩；传输可能，尤其是通过启用 gzip 的 IIS 等 - 但是，图像因难以压缩而臭名昭著。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T15:27:54.163

在我之前工作的一个项目中，我们遇到了类似的问题。我们在 C# 中有一个接收媒体请求的 Web 服务。媒体的范围可以从文件到图像，并使用 BLOB 列存储在数据库中。最初，处理媒体检索请求的 Web 方法从 BLOB 中读取块并返回给调用者。这是到服务器的一次往返。这种方法的问题是客户端没有关于操作进度的反馈。

> 计算机科学中没有任何问题不能通过额外的间接级别来解决。

我们首先在三种方法中重构该方法。

**方法 1**设置调用者和 Web 服务之间的对话。这包括有关请求的信息（如媒体 ID）和功能交换。Web 服务以一个勾选的 ID 进行响应，该 ID 用于调用者未来的请求。此初始调用用于资源分配。

**Method2**被连续调用，直到有更多的媒体要检索。该调用包括有关当前偏移量的信息和调用**Method1**时提供的勾选 Id 。返回更新当前位置。

**当Method2**报告请求媒体的读取已完成时，调用**Method3**以完成请求。这释放了分配的资源。

这种方法很实用，因为您可以立即向用户提供有关操作进度的反馈。您有一个好处，就是在不同的线程中拆分对**Method2的请求。**可以像某些 BitTorrent 客户端那样按块报告进度。

* * *

根据 BLOB 的大小，您可以选择一次性从数据库中加载它，或者[也可以按块读取它](http://www.akadia.com/services/dotnet_read_write_blob.html)。这意味着您可以使用一种平衡机制，该机制基于给定的水印（BLOB 大小）选择一次性或按块加载它。

* * *

如果仍然存在性能问题，请考虑使用[GZipStream](http://msdn.microsoft.com/en-us/library/system.io.compression.gzipstream.aspx)打包结果或阅读有关[消息编码器](http://msdn.microsoft.com/en-us/library/aa751889.aspx)的信息，并特别注意二进制和消息传输优化机制 (MTOM)。

# java - 使用 Axis2 Java 的 Web 服务抛出异常

> ID：191826
> 
> 赞同：2
> 
> 时间：2008-10-10T15:18:20.940
> 
> 标签：java, web-services, exception, axis

我实际上正在使用 Axis 2 在 Java 中开发 Web 服务。我将服务设计为 POJO（普通旧 Java 对象），并带有公共方法抛出异常：

```
public class MyService {
   public Object myMethod() throws MyException {
        [...]
   }
} 
```

然后我使用 Axis2 ant 任务生成了 WSDL。使用 WSDL，我生成了一个客户端存根来测试我的服务。生成的代码在存根声明中包含“MyExceptionException”和“myMethod”以抛出：

```
public class MyServiceStub extends org.apache.axis2.client.Stub {
    [...]
    public MyServiceStub.MyMethodResponse myMethod(MyServiceStub.MyMethod myMethod)
    throws java.rmi.RemoteException, MyExceptionException0 {
        [...]
    }
    [...]
} 
```

但是，当调用被 catch 包围的方法时，“MyExceptionException”永远不会被传输 AxisFault 的服务器传输（RemoteException 的子类）。

我认为问题出在服务器端，但找不到在哪里。该服务作为 aar 文件部署在 Tomcat 5.5 服务器上的axis2 webapp 中。services.xml 看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<service name="MyService" scope="application">
    <description></description>
    <messageReceivers>
        <messageReceiver mep="http://www.w3.org/2004/08/wsdl/in-only" 
            class="org.apache.axis2.rpc.receivers.RPCInOnlyMessageReceiver"/>
        <messageReceiver mep="http://www.w3.org/2004/08/wsdl/in-out"
           class="org.apache.axis2.rpc.receivers.RPCMessageReceiver"/>
    </messageReceivers>
    <parameter name="ServiceClass">MyService</parameter>
    <parameter name="ServiceTCCL">composite</parameter>
</service> 
```

如果行为正常，那么我将放弃使用异常（这对我的项目并不重要），但我很谨慎为什么 Java2WSDL 在操作输入和输出声明中生成自定义 <wsdl:fault> 并且 WSDL2Java 生成一个异常类（并声明将其放入存根方法中）如果这不可用...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T17:26:46.157

我真的不认为有问题。您的客户端调用服务器上的方法。该方法导致异常。Axis 将此异常转换为可以发送给客户端以指示错误的内容。

据我所知，所有异常都被包装到一个 AxisFault 中，然后我相信它会作为带有异常消息描述的 SoapFault 消息传输给客户端。

换句话说，客户端应该只看到AxisFaults，因为异常（异常类）没有被序列化和发送。服务器异常应成为客户端的 AxisFaults。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-19T09:46:25.717

您是否尝试过将 Axis2 与 Lady4j 一起使用，它为我们解决了这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-27T09:35:13.213

如果您的 WSDL 指定您的服务抛出一个自定义错误，您的客户端应该期望处理这些错误以及由 Axis2 的操作抛出的一般远程异常。

当您的存根从服务器接收到 AxisFault 时，如果在您的 WSDL 中指定，它会尝试构建自定义异常。如果失败，它将简单地传递 AxisFault。

存根将尝试调用 f.getDetail()。如果为 null，则不会尝试构造自定义异常，并将传递 AxisFault。在 Axis2 1.5 中，服务器端自动生成的 MessageInOutReciver 默认不设置此值。

您可以像这样在服务器端手动设置它（假设您有自动生成的 MyFaultException 和 MyFault 类）：

```
 MyFaultException ex = new MyFaultException("My Exception Message");
        MyFault fault = new MyFault();
        fault.setMyFault("My Fault Message");
        ex.setFaultMessage(fault);
        throw ex; 
```

# ajax - 我需要什么来重建我的网络服务器？

> ID：191831
> 
> 赞同：1
> 
> 时间：2008-10-10T15:20:29.170
> 
> 标签：ajax, webserver, visual-web-developer, rebuild

我正准备彻底检修我的网络服务器。我将它用于开发和向客户展示产品。它还托管我的公司网站。我将加载 MS Server 2008 和 MS SQL 2008。我希望它具有最新的 .NET Framework 以及最新的 MVC 模板。我希望它使用 SubSonic。我也想开始使用某种 SourceSafe（或任何好的）。我计划使用 VS 2008 作为我的开发工具。

我想有很多人最近经历过这个并且会有很好的建议。

这是一台具有大量内存和存储空间的好机器，所以，请告诉我任何可以帮助我成为更好的开发人员的事情。

斯科特和开发团队

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T15:25:27.913

好吧，听起来你已经有了一个很好的清单。虽然我建议反对 SourceSafe。[详情请看这里](http://www.highprogrammer.com/alan/windev/sourcesafe.html)。SubVersion 是一个免费的替代方案。或者如果你准备迎接挑战，也许是 git 或类似的东西。

[编辑添加] 如果您负担得起，TFS 是一款不错的产品，它为您提供错误跟踪、版本控制和构建环境。所有这些都将帮助您成为更好的开发人员。

要拉皮条该网站的创始人之一，请查看[Joel 测试](http://www.joelonsoftware.com/articles/fog0000000043.html)，看看您应该实施什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T15:38:24.457

我建议不要使用同一台机器来托管应用程序和开发。您至少应该制作一个用于开发的 VM，这样开发和实时内容之间就不会发生意外干扰。

确保你已经修补了所有已知的漏洞 (sp)，所有这些软件都会有几个可利用的端点。

# c++ - 如何使用 Windows 程序在 C++ 中获取控制台输出？

> ID：191842
> 
> 赞同：45
> 
> 时间：2008-10-10T15:22:14.473
> 
> 标签：c++, windows, console

如果我有一个本地 C++ windows 程序（即入口点是 WinMain），我如何查看 std::cout 等控制台函数的输出？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-10T15:29:50.243

查看[将控制台 I/O 添加到 Win32 GUI 应用程序](http://dslweb.nwnexus.com/~ast/dload/guicon.htm)。这可以帮助你做你想做的事。

如果您没有或无法修改代码，请尝试[此处](http://support.microsoft.com/kb/110930/en-us)找到的建议将控制台输出重定向到文件。

* * *

**编辑：**这里有一点线程死灵法。我第一次回答这个问题是在 9 年前，在 SO 的早期，在非仅链接答案的（好）政策生效之前。我将重新发布原始文章中的代码，以弥补我过去的罪过。

**guicon.cpp -- 控制台重定向功能**

```
#include <windows.h>
#include <stdio.h>
#include <fcntl.h>
#include <io.h>
#include <iostream>
#include <fstream>
#ifndef _USE_OLD_IOSTREAMS
using namespace std;
#endif
// maximum mumber of lines the output console should have
static const WORD MAX_CONSOLE_LINES = 500;
#ifdef _DEBUG
void RedirectIOToConsole()
{
    int hConHandle;
    long lStdHandle;
    CONSOLE_SCREEN_BUFFER_INFO coninfo;
    FILE *fp;

    // allocate a console for this app
    AllocConsole();

    // set the screen buffer to be big enough to let us scroll text
    GetConsoleScreenBufferInfo(GetStdHandle(STD_OUTPUT_HANDLE), &coninfo);
    coninfo.dwSize.Y = MAX_CONSOLE_LINES;
    SetConsoleScreenBufferSize(GetStdHandle(STD_OUTPUT_HANDLE), coninfo.dwSize);

    // redirect unbuffered STDOUT to the console
    lStdHandle = (long)GetStdHandle(STD_OUTPUT_HANDLE);
    hConHandle = _open_osfhandle(lStdHandle, _O_TEXT);
    fp = _fdopen( hConHandle, "w" );
    *stdout = *fp;
    setvbuf( stdout, NULL, _IONBF, 0 );

    // redirect unbuffered STDIN to the console
    lStdHandle = (long)GetStdHandle(STD_INPUT_HANDLE);
    hConHandle = _open_osfhandle(lStdHandle, _O_TEXT);
    fp = _fdopen( hConHandle, "r" );
    *stdin = *fp;
    setvbuf( stdin, NULL, _IONBF, 0 );

    // redirect unbuffered STDERR to the console
    lStdHandle = (long)GetStdHandle(STD_ERROR_HANDLE);
    hConHandle = _open_osfhandle(lStdHandle, _O_TEXT);
    fp = _fdopen( hConHandle, "w" );
    *stderr = *fp;
    setvbuf( stderr, NULL, _IONBF, 0 );

    // make cout, wcout, cin, wcin, wcerr, cerr, wclog and clog
    // point to console as well
    ios::sync_with_stdio();
}

#endif
//End of File 
```

**guicon.h -- 控制台重定向功能的接口**

```
#ifndef __GUICON_H__
#define __GUICON_H__
#ifdef _DEBUG

void RedirectIOToConsole();

#endif
#endif

// End of File 
```

**test.cpp -- 演示控制台重定向**

```
#include <windows.h>
#include <iostream>
#include <fstream>
#include <conio.h>
#include <stdio.h>
#ifndef _USE_OLD_OSTREAMS
using namespace std;
#endif
#include "guicon.h"

#include <crtdbg.h>

int APIENTRY WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPTSTR lpCmdLine, int nCmdShow)
{
    #ifdef _DEBUG
    RedirectIOToConsole();
    #endif
    int iVar;

    // test stdio
    fprintf(stdout, "Test output to stdout\n");
    fprintf(stderr, "Test output to stderr\n");
    fprintf(stdout, "Enter an integer to test stdin: ");
    scanf("%d", &iVar);
    printf("You entered %d\n", iVar);

    //test iostreams
    cout << "Test output to cout" << endl;
    cerr << "Test output to cerr" << endl;
    clog << "Test output to clog" << endl;
    cout << "Enter an integer to test cin: ";
    cin >> iVar;
    cout << "You entered " << iVar << endl;
    #ifndef _USE_OLD_IOSTREAMS

    // test wide iostreams
    wcout << L"Test output to wcout" << endl;
    wcerr << L"Test output to wcerr" << endl;
    wclog << L"Test output to wclog" << endl;
    wcout << L"Enter an integer to test wcin: ";
    wcin >> iVar;
    wcout << L"You entered " << iVar << endl;
    #endif

    // test CrtDbg output
    _CrtSetReportMode( _CRT_ASSERT, _CRTDBG_MODE_FILE );
    _CrtSetReportFile( _CRT_ASSERT, _CRTDBG_FILE_STDERR );
    _CrtSetReportMode( _CRT_ERROR, _CRTDBG_MODE_FILE );
    _CrtSetReportFile( _CRT_ERROR, _CRTDBG_FILE_STDERR);
    _CrtSetReportMode( _CRT_WARN, _CRTDBG_MODE_FILE );
    _CrtSetReportFile( _CRT_WARN, _CRTDBG_FILE_STDERR);
    _RPT0(_CRT_WARN, "This is testing _CRT_WARN output\n");
    _RPT0(_CRT_ERROR, "This is testing _CRT_ERROR output\n");
    _ASSERT( 0 && "testing _ASSERT" );
    _ASSERTE( 0 && "testing _ASSERTE" );
    Sleep(2000);
    return 0;
}

//End of File 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2019-04-26T22:27:43.810

其他一些答案的问题是它们不必要地创建了新`FILE`实例，这些实例随后被泄露，并可能导致 CRT 清理代码中的调试断言。

[freopen_s](https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/freopen-s-wfreopen-s?view=vs-2019)就是真正需要的：

```
FILE* fp = nullptr;
freopen_s(&fp, "CONIN$", "r", stdin);
freopen_s(&fp, "CONOUT$", "w", stdout);
freopen_s(&fp, "CONOUT$", "w", stderr); 
```

您可能还想进行一些错误检查和清理。以下是我目前使用的完整解决方案。

**重定向控制台标准 IO：**

```
bool RedirectConsoleIO()
{
    bool result = true;
    FILE* fp;

    // Redirect STDIN if the console has an input handle
    if (GetStdHandle(STD_INPUT_HANDLE) != INVALID_HANDLE_VALUE)
        if (freopen_s(&fp, "CONIN$", "r", stdin) != 0)
            result = false;
        else
            setvbuf(stdin, NULL, _IONBF, 0);

    // Redirect STDOUT if the console has an output handle
    if (GetStdHandle(STD_OUTPUT_HANDLE) != INVALID_HANDLE_VALUE)
        if (freopen_s(&fp, "CONOUT$", "w", stdout) != 0)
            result = false;
        else
            setvbuf(stdout, NULL, _IONBF, 0);

    // Redirect STDERR if the console has an error handle
    if (GetStdHandle(STD_ERROR_HANDLE) != INVALID_HANDLE_VALUE)
        if (freopen_s(&fp, "CONOUT$", "w", stderr) != 0)
            result = false;
        else
            setvbuf(stderr, NULL, _IONBF, 0);

    // Make C++ standard streams point to console as well.
    ios::sync_with_stdio(true);

    // Clear the error state for each of the C++ standard streams.
    std::wcout.clear();
    std::cout.clear();
    std::wcerr.clear();
    std::cerr.clear();
    std::wcin.clear();
    std::cin.clear();

    return result;
} 
```

**发布控制台：**

```
bool ReleaseConsole()
{
    bool result = true;
    FILE* fp;

    // Just to be safe, redirect standard IO to NUL before releasing.

    // Redirect STDIN to NUL
    if (freopen_s(&fp, "NUL:", "r", stdin) != 0)
        result = false;
    else
        setvbuf(stdin, NULL, _IONBF, 0);

    // Redirect STDOUT to NUL
    if (freopen_s(&fp, "NUL:", "w", stdout) != 0)
        result = false;
    else
        setvbuf(stdout, NULL, _IONBF, 0);

    // Redirect STDERR to NUL
    if (freopen_s(&fp, "NUL:", "w", stderr) != 0)
        result = false;
    else
        setvbuf(stderr, NULL, _IONBF, 0);

    // Detach from console
    if (!FreeConsole())
        result = false;

    return result;
} 
```

**调整控制台缓冲区的大小：**

```
void AdjustConsoleBuffer(int16_t minLength)
{
    // Set the screen buffer to be big enough to scroll some text
    CONSOLE_SCREEN_BUFFER_INFO conInfo;
    GetConsoleScreenBufferInfo(GetStdHandle(STD_OUTPUT_HANDLE), &conInfo);
    if (conInfo.dwSize.Y < minLength)
        conInfo.dwSize.Y = minLength;
    SetConsoleScreenBufferSize(GetStdHandle(STD_OUTPUT_HANDLE), conInfo.dwSize);
} 
```

**分配新控制台：**

```
bool CreateNewConsole(int16_t minLength)
{
    bool result = false;

    // Release any current console and redirect IO to NUL
    ReleaseConsole();

    // Attempt to create new console
    if (AllocConsole())
    {
        AdjustConsoleBuffer(minLength);
        result = RedirectConsoleIO();
    }

    return result;
} 
```

**附加到家长控制台：**

```
bool AttachParentConsole(int16_t minLength)
{
    bool result = false;

    // Release any current console and redirect IO to NUL
    ReleaseConsole();

    // Attempt to attach to parent process's console
    if (AttachConsole(ATTACH_PARENT_PROCESS))
    {
        AdjustConsoleBuffer(minLength);
        result = RedirectConsoleIO();
    }

    return result;
} 
```

**从 WinMain 调用：**

链接到`/SUBSYSTEM:Windows`

```
int APIENTRY WinMain(
    HINSTANCE /*hInstance*/,
    HINSTANCE /*hPrevInstance*/,
    LPTSTR    /*lpCmdLine*/,
    int       /*cmdShow*/)
{
    if (CreateNewConsole(1024))
    {
        int i;

        // test stdio
        fprintf(stdout, "Test output to stdout\n");
        fprintf(stderr, "Test output to stderr\n");
        fprintf(stdout, "Enter an integer to test stdin: ");
        scanf("%d", &i);
        printf("You entered %d\n", i);

        // test iostreams
        std::cout << "Test output to std::cout" << std::endl;
        std::cerr << "Test output to std::cerr" << std::endl;
        std::clog << "Test output to std::clog" << std::endl;
        std::cout << "Enter an integer to test std::cin: ";
        std::cin >> i;
        std::cout << "You entered " << i << std::endl;

        std::cout << endl << "Press any key to continue..." << endl;
        _getch();

        ReleaseConsole();
    }

    return 0;
}; 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-10-10T15:35:59.983

您也可以重新打开 cout 和 cerr 流以输出到文件。以下应该适用于此：

```
#include <iostream>
#include <fstream>

int main ()
{
    std::ofstream file;
    file.open ("cout.txt");
    std::streambuf* sbuf = std::cout.rdbuf();
    std::cout.rdbuf(file.rdbuf());
    //cout is now pointing to a file
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-10-09T09:11:13.330

实际上，有一个比迄今为止提出的任何解决方案都简单得多的解决方案。您的 Windows 程序将具有 WinMain 函数，因此只需添加此“虚拟”主函数即可

```
int main()
{
   return WinMain(GetModuleHandle(NULL), NULL, GetCommandLineA(), SW_SHOWNORMAL);
} 
```

您现在可以像这样使用 MSVC 进行编译

```
cl /nologo /c /EHsc myprog.c
link /nologo /out:myprog.exe /subsystem:console myprog.obj user32.lib gdi32.lib 
```

（您可能需要添加更多库链接）

当您运行程序时，任何`printf`将被写入命令提示符。

如果您使用 gcc (mingw) 为 Windows 编译，则不需要虚拟主函数，只需执行

```
gcc -o myprog.exe myprog.c -luser32 -lgdi32 
```

（即避免使用`-mwindows`会阻止写入控制台的标志。当您创建最终的 GUI 版本时，该标志将很有用）同样，如果使用更多 Windows 功能，您可能需要指定更多库）

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2017-08-01T13:25:52.900

如果您将程序的输出发送到文件或管道，例如

```
myprogram.exe > file.txt
myprogram.exe | anotherprogram.exe 
```

或者您正在从另一个程序调用您的程序并通过管道捕获其输出，那么您不需要更改任何内容。它会正常工作，即使入口点是`WinMain`.

但是，如果您在控制台或 Visual Studio 中运行程序，则输出不会出现在控制台或 Visual Studio 的“输出”窗口中。如果您想查看“实时”输出，请尝试其他答案之一。

基本上，这意味着标准输出与控制台应用程序一样工作，但它没有连接到您正在运行应用程序的控制台，而且似乎没有简单的方法可以做到这一点（此处提供的所有其他解决方案都连接输出到一个新的控制台窗口，当你运行你的应用程序时会弹出这个窗口，即使是从另一个控制台）。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-09-05T08:49:19.247

在我的 Windows 桌面应用程序项目中，结合使用[卢克的答案](https://stackoverflow.com/a/191880)和[罗杰的答案对我有用。](https://stackoverflow.com/a/25927081/1513612)

```
void RedirectIOToConsole() {

    //Create a console for this application
    AllocConsole();

    // Get STDOUT handle
    HANDLE ConsoleOutput = GetStdHandle(STD_OUTPUT_HANDLE);
    int SystemOutput = _open_osfhandle(intptr_t(ConsoleOutput), _O_TEXT);
    FILE *COutputHandle = _fdopen(SystemOutput, "w");

    // Get STDERR handle
    HANDLE ConsoleError = GetStdHandle(STD_ERROR_HANDLE);
    int SystemError = _open_osfhandle(intptr_t(ConsoleError), _O_TEXT);
    FILE *CErrorHandle = _fdopen(SystemError, "w");

    // Get STDIN handle
    HANDLE ConsoleInput = GetStdHandle(STD_INPUT_HANDLE);
    int SystemInput = _open_osfhandle(intptr_t(ConsoleInput), _O_TEXT);
    FILE *CInputHandle = _fdopen(SystemInput, "r");

    //make cout, wcout, cin, wcin, wcerr, cerr, wclog and clog point to console as well
    ios::sync_with_stdio(true);

    // Redirect the CRT standard input, output, and error handles to the console
    freopen_s(&CInputHandle, "CONIN$", "r", stdin);
    freopen_s(&COutputHandle, "CONOUT$", "w", stdout);
    freopen_s(&CErrorHandle, "CONOUT$", "w", stderr);

    //Clear the error state for each of the C++ standard stream objects. We need to do this, as
    //attempts to access the standard streams before they refer to a valid target will cause the
    //iostream objects to enter an error state. In versions of Visual Studio after 2005, this seems
    //to always occur during startup regardless of whether anything has been read from or written to
    //the console or not.
    std::wcout.clear();
    std::cout.clear();
    std::wcerr.clear();
    std::cerr.clear();
    std::wcin.clear();
    std::cin.clear();

} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-11T18:06:10.520

creating a pipe, execute the program console CreateProcess() and read with ReadFile() or writes in console WriteFile()

```
 HANDLE hRead ; // ConsoleStdInput
    HANDLE hWrite; // ConsoleStdOutput and ConsoleStdError

    STARTUPINFO           stiConsole;
    SECURITY_ATTRIBUTES   segConsole;
    PROCESS_INFORMATION   priConsole;

    segConsole.nLength = sizeof(segConsole);
    segConsole.lpSecurityDescriptor = NULL;
    segConsole.bInheritHandle = TRUE;

if(CreatePipe(&hRead,&hWrite,&segConsole,0) )
{

    FillMemory(&stiConsole,sizeof(stiConsole),0);
    stiConsole.cb = sizeof(stiConsole);
GetStartupInfo(&stiConsole);
stiConsole.hStdOutput = hWrite;
stiConsole.hStdError  = hWrite;
stiConsole.dwFlags    = STARTF_USESHOWWINDOW | STARTF_USESTDHANDLES;
stiConsole.wShowWindow = SW_HIDE; // execute hide 

    if(CreateProcess(NULL, "c:\\teste.exe",NULL,NULL,TRUE,NULL,
      NULL,NULL,&stiConsole,&priConsole) == TRUE)
    {
        //readfile and/or writefile
} 
```

}

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-02-23T17:58:29.303

转到项目>项目属性>链接器>系统并在右侧窗格中，将**子系统**选项设置为**控制台（/SUBSYSTEM：CONSOLE）**

然后编译你的程序并从控制台运行它，看看你的命令提示符是否显示你的输出。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-10T15:28:05.833

不要引用我的话，但 Win32[控制台 API](http://msdn.microsoft.com/en-us/library/ms682087(VS.85).aspx)可能是您正在寻找的。但是，如果您只是出于调试目的这样做，您可能对运行[DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)和调用[DbgPrint](http://msdn.microsoft.com/en-us/library/ms792790.aspx)函数更感兴趣。

这当然假设您想要发送控制台输出的应用程序，而不是从另一个应用程序读取它。在这种情况下，管道可能是你的朋友。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-07-01T11:14:52.703

[正如那里](https://stackoverflow.com/a/42422951/3969362)提到的那样，最简单的解决方案是使用您的项目属性页在和子系统之间来回切换[，](https://stackoverflow.com/a/52717331/3969362)以随意启用或禁用控制台输出。`CONSOLE``WINDOWS`

[![项目属性](https://i.stack.imgur.com/Cg1SH.png)](https://i.stack.imgur.com/Cg1SH.png)

您的程序只需要`main`和`WinMain`入口点来确保两个配置都在编译。该`main`函数简单地调用`WinMain`如下所示：

```
int main()
{
cout << "Output standard\n";
cerr << "Output error\n";

return WinMain(GetModuleHandle(NULL), NULL, GetCommandLineA(), SW_SHOWNORMAL);
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-10T15:24:13.517

由于没有控制台窗口，这~~不可能是~~困难的。（每天学习新东西——我从来不知道控制台功能！）

您可以替换输出调用吗？我会经常使用 TRACE 或 OutputDebugString 将信息发送到 Visual Studio 输出窗口。

# velocity - 在 Velocity 中访问数组的最佳方式是什么？

> ID：191844
> 
> 赞同：25
> 
> 时间：2008-10-10T15:22:55.063
> 
> 标签：velocity

我有一个 Java 数组，例如：

```
String[] arr = new String[] {"123","doc","projectReport.doc"}; 
```

在我看来，自然的访问方式是：

```
 #set($att_id = $arr[0])
 #set($att_type = $arr[1])
 #set($att_name = $arr[2]) 
```

但它不起作用。我有这个解决方法。但是对于这样一个简单的任务来说，它的代码太多了。

```
#set($counter = 0)
#foreach($el in $arr)
    #if($counter==0)
        #set($att_id = $el)
    #elseif($counter==1)
        #set($att_type = $el)
    #elseif($counter==2)
         #set($att_name = $el)
    #end
    #set($counter = $counter + 1)
#end 
```

还有其他方法吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-02T22:58:32.357

您可以使用 use Velocity 1.6: 对于名为 one 的数组`$array`，只需执行`$array.get($index)`.

在即将到来的 Velocity 1.7 中，人们将能够做到`$array[$index]`（以及`$list[$index]`和`$map[$key]`）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-10T15:56:52.513

您可以将数组包装在[`List`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/List.html)using 中[`Arrays.asList(T... a)`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Arrays.html#asList%28T...%29)。新的 List 对象由原始数组支持，因此它不会浪费地分配副本。即使对新列表所做的更改也会传播回数组。

然后，您可以使用`$list.get(int index)`Velocity 中的对象取出对象。

如果您只需要从一个数组中获取一个或两个对象，您还可以使用[`Array.get(Object array, int index)`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/reflect/Array.html#get%28java.lang.Object%2C%20int%29) 从数组中获取一个项目。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-22T06:22:06.100

```
String[] arr = new String[] {"123", "doc", "projectReport.doc"}; 
```

在我看来，自然的访问方式是：

```
 #set($att_id = $arr[0]) 
 #set($att_type = $arr[1]) 
 #set($att_name = $arr[2]) 
```

这个值可以通过使用来获得，`$array.get("arr", 1)`因为没有像`$att_id = $arr[0]`速度这样从数组中获取值的直接方法。
希望它有效:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-01-26T00:15:13.993

**速度 1.6**

```
$myarray.isEmpty()
$myarray.size()
$myarray.get(2)
$myarray.set(1, 'test') 
```

[http://velocity.apache.org/engine/1.7/user-guide.html](http://velocity.apache.org/engine/1.7/user-guide.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-21T00:33:12.333

有一个隐式计数器 $velocityCount 以值 1 开头，因此您不必创建自己的计数器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T19:34:38.300

[Brian 的回答](https://stackoverflow.com/questions/191844/what-is-the-best-way-to-access-an-array-inside-velocity#192018)确实是正确的，尽管您可能想知道即将推出的 Velocity 1.6 直接支持数组；有关详细信息，请参阅[Velocity 文档](http://velocity.apache.org/engine/devel/developer-guide.html#support-for-iterative-objects-for-foreach)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T06:01:06.407

我最终使用了velocity-tools.jar中的[ListTool 。](http://velocity.apache.org/tools/releases/1.4/javadoc/org/apache/velocity/tools/generic/ListTool.html)它具有访问数组元素并获取其大小的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-12-10T13:19:02.953

我有同样的问题，它在另一个线程上得到了回答

```
#set ( $Page = $additionalParams.get('Page') )
#set ( $Pages = [] )
#if ( $Page != $null && $Page != "" )
    #foreach($i in $Page.split(";"))
        $Pages.add($i)
    #end
#end 
```

[Confluence / Velocity 模板中的数组索引](https://stackoverflow.com/questions/17035177/array-indexing-in-confluence-velocity-templates/17100999#17100999?newreg=4b7840e98b0a44b3b8112a26bcd3689c)

# database - 如何在文件系统中存储图像

> ID：191845
> 
> 赞同：31
> 
> 时间：2008-10-10T15:23:17.200
> 
> 标签：database, data-structures, blob, file-organization

目前，我将图像（最大 6MB）作为 BLOB 存储在 InnoDB 表中。随着数据量的增长，每晚备份的速度越来越慢，阻碍了正常的性能。

因此，二进制数据需要进入文件系统。（指向文件的指针将保存在数据库中。）

数据具有树状关系：

```
- main site
  - user_0
    - album_0
    - album_1
    - album_n
  - user_1
  - user_n
etc... 
```

现在我希望数据通过目录结构均匀分布。我应该如何做到这一点？

我想我可以尝试`MD5('userId, albumId, imageId');`对结果字符串进行切片以获取我的目录路径：

```
  /var/imageStorage/f/347e/013b/c042/51cf/985f7ad0daa987d.jpeg

```

这将允许我将第一个字符映射到服务器并将目录结构均匀地分布在多个服务器上。

然而，这*不会*保持每个用户的图像组织，可能会将 1 个相册的图像分布在多个服务器上。

我的问题是：
将图像数据以平衡的方式存储在文件系统中，同时将用户/相册数据保存在一起的最佳方法是什么？

我在思考正确的方向吗？或者这完全是错误的做事方式？

**更新：**
我将`md5(user_id)`在最高级别进行字符串切片。然后将所有用户数据放在同一个桶中。这将确保数据的均匀分布，同时将用户数据存储在一起。

```
  /var
   - 图像存储
     - f/347e/013b
       - f347e013bc04251cf985f7ad0daa987d
         - 0
           - 专辑 1_10
             - 图片_1.jpeg
         - 1
           - 专辑 1_1
             - 图片_2.jpeg
             - 图片_3.jpeg
           - 专辑 1_11
             - 图片_n.jpeg
         -n
           - 专辑 1_n

```

我想我会使用从后面拆分的 albumId（我喜欢这个主意！）以保持每个目录的专辑数量更小（尽管对于大多数用户来说这不是必需的）。

谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-10T15:26:29.690

只需从后面拆分您的用户标识。例如

```
UserID = 6435624 
Path = /images/24/56/6435624 
```

至于备份，您可以使用 MySQL Replication 并备份从数据库以避免备份时出现问题（例如锁定）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-11T15:31:23.627

关于将文件名分配到不同目录的一件事，如果您考虑将 md5 文件名拆分为不同的子目录（这通常是一个好主意），我建议将完整的哈希保留为文件名并将前几个字符复制为目录名称。这样，您将更容易识别文件，例如当您必须移动目录时。

例如

abcdefgh.jpg -> a/ab/abc/abcdefgh.jpg

如果您的文件名不是均匀分布的（不是哈希），请尝试选择一种获得均匀分布的拆分方法，例如，如果它是递增的用户 ID，则为最后一个字符

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-17T13:10:23.300

我正在使用这个策略给定一个唯一的图片 ID

*   反转字符串
*   如果有奇数位数，则用前导零填充它
*   将字符串分块为两位数的子字符串
*   构建路径如下

    ```
    17 >> 71 >> /71.jpg
    163 >> 0361 >> /03/61.jpg
    6978 >> 8796 >> /87/96.jpg    
    1687941 >> 01497861 >> /01/49/78/61.jpg 
    ```

此方法可确保每个文件夹最多包含 100 张图片和 100 个子文件夹，并且负载均匀分布在最左侧的文件夹之间。

而且，您只需要图片的ID即可到达文件，无需读取包含其他元数据的图片表。用户数据确实不会紧密存储在一起，并且 ID-Path 关系是可预测的，这取决于您的需求。

# version-control - 如何确定我的 ClearCase 本地视图中的哪些文件尚未添加到源代码管理？

> ID：191855
> 
> 赞同：14
> 
> 时间：2008-10-10T15:25:21.330
> 
> 标签：version-control, clearcase

如果我在本地 ClearCase 视图中添加/删除/修改了大量文件，我如何确定所有文件都已添加到源代码管理中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-10T15:47:34.297

您的答案是正确的，对于***快照***视图（您称之为“本地视图”？）
在动态视图中，一个简单的

```
cleartool lsprivate 
```

就足够了。

但这会遗漏*被劫持*的文件（这些文件已经添加到源代码控制中，但可能在 ClearCase 不知情的情况下被修改）

因此，我建议使用（对于 Windows）完成您的命令：

```
for /F "usebackq delims= " %i in (`cleartool ls -r -nxn ^| find "hijacked"`) do @echo %i 
```

对于 Unix：

```
cleartool ls -r -nxn | grep hijacked 
```

这也会将文件留在签出中（当然，它们也被添加到源代码控制中，但也应该列出，因为它们最终必须被提交或取消）。
在快照视图中：

```
cleartool lscheckout -recur 
```

在动态视图中：

```
cleartool lsprivate –co 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-03-22T17:17:04.303

我对 Windows 使用了类似的 dos 命令，但我还将 clear 工具命令的结果通过管道传递给 findstr 以“**忽略**”特定模式（使用正则表达式），例如 .keep 文件、dll 以及编译的文件和我不使用的文件夹位置不想添加到源。

从视图的根文件夹中运行以下命令。如果您有多个顶级文件夹，那么您需要为每个文件夹运行一次。另外，我相信这仅适用于**SnapShot**视图。

```
cleartool ls -recurse -view_only | findstr /vi ".dll$ .pdb$ .suo$ .keep$ .unloaded$ \\bin$ \\bin\\ \\debug$ \\debug\\ \\release$ \\release\\ \\obj$ \\obj\\ ^cleartool$" > c:\ItemsNotInSource.txt 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-10T15:25:28.490

`cleartool ls -view_only -r`从您的本地视图 VO​​B 目录中使用。

要递归地将任何文件添加到仅在本地视图中的源代码管理，请参阅[如何使用 ClearCase 递归地“添加到源代码管理......”？](https://stackoverflow.com/questions/138321/how-can-i-use-clearcase-to-add-to-source-control-recursively).

# sharepoint - “类未注册”恢复 Sharepoint (WSS) 2003 backup.dat 文件

> ID：191861
> 
> 赞同：0
> 
> 时间：2008-10-10T15:26:21.750
> 
> 标签：sharepoint, backup, wss, restore

我需要对备份的 WSS .dat 文件做一些工作，但我很难让它做任何事情。

我已经通过 stsadm 安装了它，并且看起来进展顺利，但该站点现在将我重定向到一个错误页面 - 只是经典的“找不到文件”页面，但在 URL 中它建议错误文本为“Class not已注册”，如果有更多信息错误消息。

当我运行“stsadm -0 enumsites -url= [http://my-restored-site/](http://my-restored-site/) ”时，我得到了这个：

```
C:\>"C:\Program Files\Common Files\Microsoft Shared\web server extensions\60\BIN
\stsadm" -o enumsites -url http://my-restored-site

<Sites Count="1">
  <Site Url="http://my-restored-site" Error="Class not registered" />
</Sites> 
```

有什么方法可以告诉我哪些课程没有注册，或者这里还有其他事情吗？我启用了 Sharepoint 日志记录，但它似乎完全没有效果，当然我要求它使用的路径上不存在任何文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-10T15:33:31.097

这是我在这种情况下所做的：

使用[procmon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)跟踪注册表使用情况。关注其中的`HKCR\CLSID`结果`NAME NOT FOUND`。

记下它没有找到的 CLSID，谷歌它们以获取线索，如果它们可能与您的问题有关。找出哪个 .dll 提供了它们，并使用 regsvr32 注册该 .dll （或者如果缺少一大堆东西，则使用相应的安装程序来安装缺少的组件）。

# windows - 确定 64 位与 32 位 Windows

> ID：191873
> 
> 赞同：12
> 
> 时间：2008-10-10T15:28:12.230
> 
> 标签：windows, visual-studio-2005, 64-bit, 32-bit

我想将 Visual Studio 2005 配置为在构建期间根据操作系统是 64 位还是 32 位来复制 .dll。

我不想指定平台目标是什么。

我的第一次尝试是使用批处理文件来查找 Windows 版本，但一些 32 位和 64 位版本的 Windows 共享相同的版本号。

有人知道有什么方法可以检查吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T15:34:42.373

您应该能够读取环境变量 %PROCESSOR_ARCHITECTURE%。这是有关它的一些重要信息。

[http://blogs.msdn.com/david.wang/archive/2006/03/26/HOWTO-Detect-Process-Bitness.aspx](http://blogs.msdn.com/david.wang/archive/2006/03/26/HOWTO-Detect-Process-Bitness.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T15:30:40.960

看看[isWow64](http://msdn.microsoft.com/en-us/library/ms684139(VS.85).aspx)，我认为 shopuld 会给你你所追求的。

> 确定指定的进程是否在 WOW64 下运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-01T18:01:13.677

Jon 的链接完全是 hack，因为它不依赖于添加新的处理器架构。

有关“官方”批处理文件方法，请参见： http: [//support.microsoft.com/kb/556009](http://support.microsoft.com/kb/556009)。

# .net - 是否有任何类（或方法）可以创建格式化的连接字符串，给定提供者名称和用户 ID、密码等？

> ID：191879
> 
> 赞同：1
> 
> 时间：2008-10-10T15:29:41.883
> 
> 标签：.net, ado.net, connection-string

例如。

```
ConnectionDetails cd = new ConnectionDetails ();
cd.ProviderName = "System.Data.OleDb";
cd.DataSource = "serverAddress";
cd.Catalog = "database";
cd.UserId = "userId";
cd.Password = "password";

string connectionString = cs.CreateConnectionString();
// Should return:
// "Provider=SQLOLEDB;Data Source=serverAddress;Initial Catalog=database;User Id=userId;Password=password;" 
```

我会编写自己的类，但我不确定如何以编程方式从不变的数据库提供程序名称 (System.Data.OleDb) 检索连接字符串提供程序属性（本示例中为 SQLOLEDB）。

编辑：

你可以做一个

```
DbProviderFactories.GetFactory("System.Data.OleDB").CreateConnectionStringBuilder() 
```

但是返回的 DBConnectionStringBuilder 仍然不知道它的连接字符串提供程序属性，即使在这种情况下它的派生类具有“提供程序”属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T15:40:31.813

我所知道的最接近的是[DbConnectionStringBuilder](http://msdn.microsoft.com/en-us/library/system.data.common.dbconnectionstringbuilder.aspx)。

因为不同的提供者需要的属性不同，所以它使用关联数组（名称值集合）而不是固定属性。

所以你的例子看起来像

```
DbConnectionStringBuilder csb = new DbConnectionStringBuilder();
csb["ProviderName"] = "System.Data.OleDb";
csb["DataSource"] = "serverAddress";
csb["Catalog"] = "database";
csb["UserId"] = "userId";
csb["Password"] = "password";

string connectionString = csb.ConnectionString; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T21:17:22.803

有一个 OleDbConnectionStringBuilder 类将为您创建连接字符串。

但听起来你正试图让它为你生成提供者名称，我认为它并不是真的那样工作。由于提供者名称可能会有所不同，因此您必须提供这些名称来告诉连接该做什么。无论您使用哪种机制来选择您的数据库连接（或者如果您要使用该方法来驱动您的数据库连接工厂方法），它还必须提供提供程序名称。

# javascript - 在 jQuery 中序列化为 JSON

> ID：191881
> 
> 赞同：1229
> 
> 时间：2008-10-10T15:29:56.750
> 
> 标签：javascript, jquery, ajax, json, serialization

我需要将一个对象[序列化为](https://en.wikipedia.org/wiki/Serialization)[JSON](https://www.json.org/)。我正在使用[jQuery](https://api.jquery.com/)。有没有“标准”的方式来做到这一点？

我的具体情况：我定义了一个数组，如下所示：

```
var countries = new Array();
countries[0] = 'ga';
countries[1] = 'cd';
... 
```

我需要把它变成一个字符串传递给[`$.ajax()`](https://www.w3schools.com/jquery/ajax_ajax.asp)这样的：

```
$.ajax({
    type: "POST",
    url: "Concessions.aspx/GetConcessions",
    data: "{'countries':['ga','cd']}",
... 
```

* * *

## 回答 #1

> 赞同：1155
> 
> 时间：2009-05-26T19:22:40.907

[JSON-js](https://github.com/douglascrockford/JSON-js) - JavaScript 中的 JSON。

要将对象转换为字符串，请使用`JSON.stringify`：

```
var json_text = JSON.stringify(your_object, null, 2); 
```

要将 JSON 字符串转换为对象，请使用`JSON.parse`：

```
var your_object = JSON.parse(json_text); 
```

它最近被[John Resig](http://ejohn.org/blog/ecmascript-5-strict-mode-json-and-more/)推荐：

> ...请开始将您使用 JSON 的应用程序迁移到 Crockford 的 json2.js。它与 ECMAScript 5 规范完全兼容，如果存在本机（更快！）实现，它会优雅地降级。
> 
> 事实上，我昨天刚刚在 jQuery 中进行了更改，它利用 JSON.parse 方法（如果存在），现在它已被完全指定。

我倾向于相信他在 JavaScript 问题上所说的话 :)

[所有现代浏览器](http://caniuse.com/json)（以及许多不古老的旧浏览器）都原生支持[JSON 对象](http://ecma262-5.com/ELS5_Section_15.htm#Section_15.12)。Crockford 的 JSON 库的当前版本将仅定义`JSON.stringify`，`JSON.parse`如果尚未定义，则保留任何浏览器本机实现不变。

* * *

## 回答 #2

> 赞同：186
> 
> 时间：2011-06-01T21:40:58.990

我已经使用[jquery-json](https://code.google.com/p/jquery-json/) 6 个月了，效果很好。使用非常简单：

```
var myObj = {foo: "bar", "baz": "wockaflockafliz"};
$.toJSON(myObj);

// Result: {"foo":"bar","baz":"wockaflockafliz"} 
```

* * *

## 回答 #3

> 赞同：101
> 
> 时间：2011-08-29T06:57:32.720

[**适用于 IE8+**](http://caniuse.com/#search=JSON.stringify)

不需要 jQuery，使用：

```
JSON.stringify(countries); 
```

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2008-10-10T15:35:52.573

我没用过，但你可能想试试**[Mark Gibson 写的 jQuery 插件](http://jollytoad.googlepages.com/json.js)**

它增加了两个功能：`$.toJSON(value)`, `$.parseJSON(json_str, [safe])`。

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2008-10-10T15:47:13.173

不，序列化为 JSON 的标准方法是使用现有的 JSON 序列化库。如果您不想这样做，那么您将不得不编写自己的序列化方法。

如果您需要有关如何执行此操作的指导，我建议您检查一些可用库的来源。

**编辑：**我不会出来说编写自己的序列化方法不好，但是您必须考虑，如果使用格式良好的 JSON 对您的应用程序很重要，那么您必须权衡“再一个依赖”以防止您的自定义方法有一天可能会遇到您没有预料到的失败案例。这种风险是否可以接受是你的决定。

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2011-01-02T07:57:40.227

我确实在某个地方找到了这个。不记得在哪里……可能在 StackOverflow 上 :)

```
$.fn.serializeObject = function(){
    var o = {};
    var a = this.serializeArray();
    $.each(a, function() {
        if (o[this.name]) {
            if (!o[this.name].push) {
                o[this.name] = [o[this.name]];
            }
            o[this.name].push(this.value || '');
        } else {
            o[this.name] = this.value || '';
        }
    });
    return o;
}; 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-12-01T21:44:16.797

如果您不想使用外部库，则可以使用`.toSource()`本机 JavaScript 方法，但它不是完美的跨浏览器。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2016-03-24T03:50:13.320

是的，你应该 `JSON.stringify`和`JSON.parse`你的`Json_PostData`电话之前`$.ajax`：

```
$.ajax({
        url:    post_http_site,  
        type: "POST",         
        data:   JSON.parse(JSON.stringify(Json_PostData)),       
        cache: false,
        error: function (xhr, ajaxOptions, thrownError) {
            alert(" write json item, Ajax error! " + xhr.status + " error =" + thrownError + " xhr.responseText = " + xhr.responseText );    
        },
        success: function (data) {
            alert("write json item, Ajax  OK");

        } 
}); 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2015-04-11T05:50:05.573

最好的方法是包含[JSON](https://github.com/douglascrockford/JSON-js)对象的 polyfill。

但是，如果您坚持在 jQuery 命名空间内创建一个将对象序列化为 JSON 表示法（JSON的[有效值](http://json.org/)）的方法，您可以执行以下操作：

## 执行

```
// This is a reference to JSON.stringify and provides a polyfill for old browsers.
// stringify serializes an object, array or primitive value and return it as JSON.
jQuery.stringify = (function ($) {
  var _PRIMITIVE, _OPEN, _CLOSE;
  if (window.JSON && typeof JSON.stringify === "function")
    return JSON.stringify;

  _PRIMITIVE = /string|number|boolean|null/;

  _OPEN = {
    object: "{",
    array: "["
  };

  _CLOSE = {
    object: "}",
    array: "]"
  };

  //actions to execute in each iteration
  function action(key, value) {
    var type = $.type(value),
      prop = "";

    //key is not an array index
    if (typeof key !== "number") {
      prop = '"' + key + '":';
    }
    if (type === "string") {
      prop += '"' + value + '"';
    } else if (_PRIMITIVE.test(type)) {
      prop += value;
    } else if (type === "array" || type === "object") {
      prop += toJson(value, type);
    } else return;
    this.push(prop);
  }

  //iterates over an object or array
  function each(obj, callback, thisArg) {
    for (var key in obj) {
      if (obj instanceof Array) key = +key;
      callback.call(thisArg, key, obj[key]);
    }
  }

  //generates the json
  function toJson(obj, type) {
    var items = [];
    each(obj, action, items);
    return _OPEN[type] + items.join(",") + _CLOSE[type];
  }

  //exported function that generates the json
  return function stringify(obj) {
    if (!arguments.length) return "";
    var type = $.type(obj);
    if (_PRIMITIVE.test(type))
      return (obj === null ? type : obj.toString());
    //obj is array or object
    return toJson(obj, type);
  }
}(jQuery)); 
```

## 用法

```
var myObject = {
    "0": null,
    "total-items": 10,
    "undefined-prop": void(0),
    sorted: true,
    images: ["bg-menu.png", "bg-body.jpg", [1, 2]],
    position: { //nested object literal
        "x": 40,
        "y": 300,
        offset: [{ top: 23 }]
    },
    onChange: function() { return !0 },
    pattern: /^bg-.+\.(?:png|jpe?g)$/i
};

var json = jQuery.stringify(myObject);
console.log(json); 
```

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2015-06-29T13:21:03.170

它基本上是两步过程：

首先，您需要像这样进行字符串化：

```
var JSON_VAR = JSON.stringify(OBJECT_NAME, null, 2); 
```

之后，您需要将其转换`string`为`Object`：

```
var obj = JSON.parse(JSON_VAR); 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2014-06-18T15:49:43.043

上述解决方案没有考虑的一件事是，如果您有一组输入但只提供了一个值。

例如，如果后端需要一个 People 数组，但在这种特殊情况下，您只与一个人打交道。然后做：

```
<input type="hidden" name="People" value="Joe" /> 
```

然后使用以前的解决方案，它只会映射到以下内容：

```
{
    "People" : "Joe"
} 
```

但它真的应该映射到

```
{
    "People" : [ "Joe" ]
} 
```

要解决此问题，输入应如下所示：

```
<input type="hidden" name="People[]" value="Joe" /> 
```

您将使用以下功能（基于其他解决方案，但扩展了一点）

```
$.fn.serializeObject = function() {
var o = {};
var a = this.serializeArray();
$.each(a, function() {
    if (this.name.substr(-2) == "[]"){
        this.name = this.name.substr(0, this.name.length - 2);
        o[this.name] = [];
    }

    if (o[this.name]) {
        if (!o[this.name].push) {
            o[this.name] = [o[this.name]];
        }
        o[this.name].push(this.value || '');
    } else {
        o[this.name] = this.value || '';
    }
});
return o;
}; 
```

# php - 如何在 PHP 中的数组中使用数组引用？

> ID：191883
> 
> 赞同：3
> 
> 时间：2008-10-10T15:30:36.203
> 
> 标签：php, arrays, reference, pass-by-reference

我希望能够做到以下几点：

```
$normal_array       = array();
$array_of_arrayrefs = array( &$normal_array );

// Here I want to access the $normal_array reference **as a reference**,
// but that doesn't work obviously. How to do it?
end( $array_of_arrayrefs )["one"] = 1; // choking on this one

print $normal_array["one"]; // should output 1 
```

问候

/R

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T15:44:00.980

`end()`不返回最后一个值的引用，而是返回最后一个值本身。这是一种解决方法：

```
$normal_array       = array();
$array_of_arrayrefs = array( &$normal_array );

$refArray = &end_byref( $array_of_arrayrefs );
$refArray["one"] = 1;

print $normal_array["one"]; // should output 1

function &end_byref( &$array ) {
    $lastKey = end(array_keys($array));
    end($array);
    return $array[$lastKey];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T15:54:49.320

这里有几种方法，我觉得这两种方法都不是特别令人满意。我敢肯定有更好的方法..

```
<?php
$normal_array       = array();
$array_of_arrayrefs = array( "blah", &$normal_array );

foreach ($array_of_arrayrefs as &$v);
$v["one"] = 1;

echo $normal_array["one"];  //prints 1
?>

<?php
$normal_array       = array();
$array_of_arrayrefs = array( "blah", &$normal_array );

$lastIndex = @end(array_keys($array_of_arrayrefs)); //raises E_STRICT because end() expects referable.
$array_of_arrayrefs[$lastIndex]["one"] = 1;

echo $normal_array["one"];  //prints 1
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-11T11:30:35.500

您可能首先不应该通过引用传递。这样做通常被认为是不好的做法，因为它很难看到状态在哪里被修改。

引用速度更快是一个非常普遍的误解。事实并非如此——事实上，它们的速度有点慢，但速度太慢了，这并不重要。PHP 有一个称为 copy-on-write 的系统，这意味着在您写入变量之前实际上并未复制变量。

您真正需要引用的唯一地方是在 PHP4 中，否则对象将被克隆。这在 PHP5 中是不需要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-10T00:46:55.233

函数 end() 不只是返回一个值。它还移动数组的内部指针。然后我们可以使用 key() 来获取索引，之后我们可以使用常规的数组访问来进行赋值。

```
$normal_array       = array();
$array_of_arrayrefs = array( &$normal_array );

end($array_of_arrayrefs);
$array_of_arrayrefs[ key($array_of_arrayrefs) ]["one"] = 1;

print $normal_array["one"]; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-10T15:42:13.840

该行：

> 结束（$array_of_arrayrefs）[“一个”] = 1；// 窒息这个

引发解析错误：

> 解析错误：语法错误，第 65 行 /file.php 中的意外“[”

确保您拥有`error_reporting`并`display_error`激活。

我不确定你想做什么，但这有效：

```
$normal_array       = array();
$array_of_arrayrefs = array( &$normal_array );
// Here I want to access the $normal_array reference **as a reference**,
// but that doesn't work obviously. How to do it?
$array_of_arrayrefs[0]["one"] = 1;
//end($array_of_arrayrefs )["one"] = 1; // choking on this one
print $normal_array["one"]; // should output 1 
```

# .net - 如何分析 SQL CLR 应用程序？

> ID：191892
> 
> 赞同：2
> 
> 时间：2008-10-10T15:31:55.670
> 
> 标签：.net, sql-server, sqlclr

我在 SQL Server 2005 中有一个 SQL CLR 函数。我想分析这个函数以确保没有内存泄漏。关于如何确定我的功能是否正常运行的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T21:04:01.583

内存泄漏对于 CLR 应用程序来说是非典型的，因此应该很少关注。但是，如果我要分析 SQL CLR 函数，我想我会创建一个独立的测试应用程序，在 SQL Server 之外调用相同的 DLL/方法并对其进行分析。在我看来，当在该环境中运行时，SQL 自己的资源使用会淹没您自己的方法对性能的大部分影响。但我自己从未尝试过这样的事情。

# .net - Castle Windsor：如何将组件连接到工厂属性而不是方法

> ID：191894
> 
> 赞同：2
> 
> 时间：2008-10-10T15:32:04.607
> 
> 标签：.net, xml, inversion-of-control, castle-windsor

我有以下组件

```
public class MyTimer : IMyTimer {
  public MyTimer(TimeSpan timespan){...}
} 
```

其中时间跨度应由属性 ISettings.MyTimerFrequency 提供。

如何在 Windsor 容器 xml 中连接它？我以为我可以做这样的事情：

```
 <component id="settings"
                service="MySample.ISettings, MySample"
                type="MySample.Settings, MySample"
                factoryId="settings_dao" factoryCreate="GetSettingsForInstance">
        <parameters><instance_id>1</instance_id></parameters>
    </component>

    <component id="my_timer_frequency"
                type="System.TimeSpan"
                factoryId="settings" factoryCreate="MyTimerFrequency" />

    <component id="my_timer" 
                service="MySample.IMyTimer, MySample"
                type="MySample.MyTimer, MySample">
        <parameters><timespan>${my_timer_frequency}</timespan></parameters> 
```

但我收到一个错误，因为当工厂设施需要一个方法时，MyTimerFrequency 是一个属性。

这里有一个简单的解决方案吗？我是以错误的方式处理整个事情吗？

**编辑：**肯定有解决方案，请参阅下面的答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T12:56:39.927

解决方案实际上是在梦中想到的。请记住，属性不是 CLR 构造，而是 C# 语法糖。如果您不相信我，请尝试编译

```
public class MyClass {
  public object Item {
    get;
  }
  public object get_Item() {return null;}
} 
```

导致错误： **类型“TestApp.MyClass”已经保留了一个名为“get_Item”的成员，具有相同的参数类型**

由于 Xml 配置在编译后在运行时被保存，我们可以通过绑定到它编译到的方法来简单地绑定到 factoryCreate 属性，因此上面的示例变为：

```
<component id="my_timer_frequency"
                        type="System.TimeSpan"
                        factoryId="settings" factoryCreate="get_MyTimerFrequency" /> 
```

瞧！

有人投票赞成，因为我无法将其标记为答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T22:07:02.237

最简单的解决方案不是添加一个包装属性的方法吗？

# rdbms - 存储/访问有向图的最佳方式

> ID：191897
> 
> 赞同：12
> 
> 时间：2008-10-10T15:33:05.807
> 
> 标签：rdbms, common-table-expression, directed-graph

我有大约 3500 个防洪设施，我想将它们表示为一个网络来确定流动路径（本质上是一个有向图）。我目前正在使用 SqlServer 和 CTE 递归地检查所有节点及其上游组件，只要上游路径不分叉很多，它就可以工作。但是，由于增加了上游复杂性，一些查询比其他查询花费的时间呈指数增长，即使它们在物理路径上并不远（即两个或三个“下游”段）。在某些情况下，我已经让它在终止查询之前超过十分钟。我使用的是一个简单的两列表格，一列是设施本身，另一列是第一列中列出的设施的上游。

我尝试使用当前工具添加索引以帮助加快速度，但这没有任何区别。而且，对于图中可能的连接，任何节点都可以有多个上游连接，并且可以从多个“下游”节点连接。

数据中肯定有可能存在循环，但我还没有找到验证这一点的好方法（除了 CTE 查询报告最大递归计数命中；这些很容易修复）。

所以，我的问题是，我存储这些信息是否错误？除了 CTE 之外，还有更好的方法来查询上游点吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-07T10:14:31.133

存储图形的最佳方式当然是使用原生图形数据库 :-)

看看[neo4j](http://neo4j.org/)。它是用 Java 实现的，并且还具有 Python 和 Ruby 绑定。

我编写了两个 wiki 页面，其中包含使用 neo4j 以图形表示的域模型的简单示例：[程序集](http://wiki.neo4j.org/content/Assembly)和[角色](http://wiki.neo4j.org/content/Roles)。更多示例可在[域建模库](http://wiki.neo4j.org/content/Domain_Modeling_Gallery)页面上找到。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T15:57:30.547

我对防洪设施一无所知。但我会选择第一个设施。并使用临时表和 while 循环来生成路径。

```
-- 伪代码
临时表（LastNode、CurrentNode、N）声明@intN INT
设置@intN = 1

INSERT INTO TempTable(LastNode, CurrentNode, N)
  -- 在列表中插入第一个项目，没有上游项目...调用这个初始条件
  选择最后一个节点，当前节点，@intN
  从你的桌子上
  WHERE 节点上游没有任何内容

而@intN <= 3500
开始
     SEt @intN = @intN + 1
    INSERT INTO TempTable(LastNode, CurrentNode, N)
      选择最后一个节点，当前节点，@intN
      从你的桌子上
      WHERE LastNode IN（从 TempTable 中选择 CurrentNode，其中 N = @intN-1）

```
IF @@ROWCOUNT = 0
     BREAK 
```

结尾

```

如果我们假设每个节点都指向一个孩子。那么这应该不超过 3500 次迭代。如果多个节点具有相同的上游提供者，那么它将花费更少。但更重要的是，这可以让你做到这一点......

从 TempTable ORDER BY N 中选择 LastNode、CurrentNode、N

这将让您查看您的提供商是否存在任何循环或任何其他问题。顺便说一句，3500 行并没有那么多，所以即使在每个提供者指向不同的上游提供者的最坏情况下，这也不应该花那么长时间。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T15:44:19.293

传统上，图要么用矩阵表示，要么用向量表示。矩阵占用更多空间，但更容易处理（在您的情况下为 3500x3500 个条目）；向量占用更少的空间（3500 个条目，每个条目都有一个他们连接到谁的列表）。

这对你有帮助吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T15:49:42.607

我认为您的数据结构很好（对于 SQL Server），但 CTE 可能不是您查询的最有效解决方案。您可以尝试使用临时表作为队列来创建一个遍历图形的存储过程，这应该更有效。

临时表也可以用来消除图中的循环，尽管不应该有任何

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T15:51:22.120

也许吧）。您的数据集听起来相对较小，您可以将图形作为邻接矩阵或邻接列表加载到内存并直接查询图形 - 假设您进行编程。

就磁盘格式而言，[DOT](http://en.wikipedia.org/wiki/DOT_language)是相当可移植/流行的。以平面文件格式存储边列表似乎也很常见，例如：

```
vertex1 vertex2 {edge_label1}+ 
```

文件的第一行包含图中顶点的数量，之后的每一行都描述了边。边缘是有向还是无向取决于实现者。如果您想要明确的有向边，请使用有向边来描述它们，例如：

```
vertex1 vertex2
vertex2 vertex1 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-07T10:58:29.953

我在 SQL Server 数据库中存储您所描述的内容的经验：

我正在存储一个距离矩阵，告诉从 A 点到 B 点需要多长时间。我已经完成了简单的表示，并将它们直接存储到一个名为距离的表中，列有 A、B、距离、时间。

这在简单的检索中非常缓慢。我发现将整个矩阵存储为文本要好得多。然后在计算之前将其检索到内存中，在内存中创建一个矩阵结构并在那里使用它。

我可以提供一些代码，但它会是 C#。

# vb.net - 使用哪个 .Net Timer()

> ID：191903
> 
> 赞同：6
> 
> 时间：2008-10-10T15:33:50.563
> 
> 标签：vb.net, winforms, multithreading, timer

我在 VB.Net 2.0 中有一个旧版 WinForms Mdi 应用程序，我正在向其中添加功能。其中一项新增功能是在当前时间接近指定值（截止日期）时需要发出警告。我的意图是每小时检查一次时间，直到距离截止日期不到一小时，然后以指定的时间间隔显示警告，直到时间结束。

用户需要能够在截止日期之前甚至之后继续使用应用程序，但他们需要定期了解截止日期的临近。

该应用程序尚未使用 System.Threading，目前我对它的了解有限。我知道有 3 种不同的 Timer() 方法可用：

*   System.Threading.Timer(),
*   Windows.Forms.Timer() 和
*   System.Timers.Timer()

我的问题是，这是最好的方法吗？我尝试使用线程计时器，但由于 WinForms 不是线程安全的，我在尝试访问另一个类时遇到了运行时错误。使类/表单线程安全是否值得？我完全偏离轨道了吗？

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-10T16:03:35.857

这篇文章解释得很好：

[比较 .NET Framework 类库中的计时器类](http://msdn.microsoft.com/en-us/magazine/cc164015.aspx)

听起来 System.Windows.Forms.Timer 适合您。

我的指导方针：如果您希望计时器在您的主 GUI 线程上运行，请坚持使用 Windows.Forms.Timer。如果可以在线程池线程上异步调用您的计时器，或者如果您不想体验 System.Windows.Forms.Timer 容易遭受的小延迟，请使用 System.Timers.Timer。System.Threading.Timer 具有与其他两个不同的接口，并且不是线程安全的；就个人而言，我不是粉丝。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-10T15:36:40.153

我只会使用表单计时器。我想我读到它并不准确，但听起来你不需要它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-11T20:54:07.173

我同意 Windows.Forms.Timer() 最适合这种情况，因为它可以处理跨线程编组问题。

一些有用的相关链接：

*   [Windows Presentation Foundation 线程模型](http://msdn.microsoft.com/en-us/library/ms741870.aspx)
*   [WinForms UI 线程调用：Invoke/BeginInvoke/InvokeRequred 的深入回顾](http://weblogs.asp.net/justin_rogers/articles/126345.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T16:04:52.780

好吧，首先，首先...

如果您想向用户显示表单并在后台执行某些操作，我会使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)类，它以前对我有用。此外，您需要前面提到的调用方法，正如 Chris 所说，这听起来比实际上更难。

这是我认为可以帮助您的链接。
[http://msdn.microsoft.com/en-us/library/ms171728(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms171728(VS.80).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T16:09:35.937

System.Forms.Timer 实际上使用 Windows 消息队列在主线程上工作。这使它有些不准确，但是由于您实际上并不需要 ms 精度，因此已经足够了。您可以使用在单独线程上工作的其他计时器之一，但由于您需要激活在主线程中工作的 winforms 组件，您需要使用 Form.Invoke 或其他方式将事件传递给主线程 -这也会导致一些延迟。总之，当您需要激活基于 winforms 的组件时，请使用 System.Forms.Timer。

# php - 如何在 PHP 中遍历 DOM 元素？

> ID：191923
> 
> 赞同：32
> 
> 时间：2008-10-10T15:38:35.330
> 
> 标签：php, xml, dom

我有一个加载到 DOM 文档中的 XML 文件，我希望遍历所有“foo”标签，从它下面的每个标签中获取值。我知道我可以通过

```
$element = $dom->getElementsByTagName('foo')->item(0);
foreach($element->childNodes as $node){
    $data[$node->nodeName] = $node->nodeValue;
} 
```

但是，我正在尝试做的是来自 XML 之类的，

```
<stuff>
  <foo>
    <bar></bar>
      <value/>
    <pub></pub>
  </foo>
  <foo>
    <bar></bar>
    <pub></pub>
  </foo>
  <foo>
    <bar></bar>
    <pub></pub>
  </foo>
  </stuff> 
```

遍历每个*foo*标签，并获取特定的*bar*或*pub*，并从那里获取值。现在，我如何迭代*foo*以便我仍然可以按名称访问特定的子节点？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-10-10T15:56:45.183

没有测试，但是怎么样：

```
$elements = $dom->getElementsByTagName('foo');
$data = array();
foreach($elements as $node){
    foreach($node->childNodes as $child) {
        $data[] = array($child->nodeName => $child->nodeValue);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T20:23:36.923

使用 XPath 查询文档通常比编写依赖于文档结构知识的代码要好得多。有两个原因。首先，要测试和调试的代码要少得多。其次，如果文档的结构发生变化，那么更改 XPath 查询要比更改一堆代码容易得多。

当然，您必须学习 XPath，但（大部分）XPath 不是火箭科学。

PHP 的 DOM 使用该`xpath_eval`方法来执行 XPath 查询。它被记录[在这里](http://us3.php.net/manual/en/function.xpath-eval.php)，并且用户注释包括一些非常好的示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-09T16:29:40.690

这是另一种（懒惰的）方法。

```
$data[][$node->nodeName] = $node->nodeValue; 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2016-01-24T01:15:07.603

使用[**FluidXML**](https://github.com/servo-php/fluidxml)，您可以非常轻松地查询和迭代 XML。

```
$data = [];

$store_child = function($i, $fooChild) use (&$data) {
    $data[] = [ $fooChild->nodeName => $fooChild->nodeValue ];
};

fluidxml($dom)->query('//foo/*')->each($store_child); 
```

[https://github.com/servo-php/fluidxml](https://github.com/servo-php/fluidxml)

# sql - MS SQL 并发，多余的锁

> ID：191926
> 
> 赞同：0
> 
> 时间：2008-10-10T15:39:49.820
> 
> 标签：sql, sql-server, concurrency, timeout

我在 ms sql 2000 上有一个数据库，一次被数百名用户访问。有大量使用 Reporting Services 2005 访问同一数据库的报告。

当有大量报告正在运行并且人们同时使用数据库时，我们会看到阻塞进程到系统开始为在这种情况下一段时间后进行的任何事务提供超时的级别。

是否有一种将阻塞最小化的全局方法，以便事务可以继续流动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T15:42:24.213

如果更新不经常发生并且数据库主要用于报告，请使用乐观锁定。

SQL Server 有一个相当悲观的锁定默认值。

查看[SQL Server 表提示](http://msdn.microsoft.com/en-us/library/ms187373.aspx)可能会让您入门。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T15:54:58.103

报告可以使用`WITH(NOLOCK)`.

其他可能性是让报告运行数据库的只读副本或运行针对报告需求优化的数据库的数据仓库版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T16:20:05.837

由于您已经在为您的报告使用 NOLOCK 提示和 READ UNCOMMITTED 隔离级别，因此调查需要转向传入的事务查询。这可能会变得很深。也许应用程序将事务保持打开的时间过长。也可能是您在其他一些查询卷中进行了大量表扫描或范围扫描，并且这些可能为长时间运行的事务持有共享锁。那些共享锁会阻止你的作家。

您需要开始查看 sp_lock，查看哪些类型的锁未完成，查看被阻塞的查询试图获取哪些锁，然后检查阻塞请求者的查询。

如果您不熟悉 SQL Server 锁定，这将对您有所帮助： [了解 SQL Server 2000 锁定](http://www.mssqlcity.com/Articles/General/sql2000_locking.htm)

此外，也许您可​​以描述您的磁盘子系统。它可能尺寸过小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T19:35:25.740

感谢大家的支持。我们为缓解这个问题所做的工作是创建一个新的数据库，每小时执行一次日志传送过程，以保持与真实数据库的同步。不需要实时数据的报告指向该数据库，而需要实时数据的报告则受到限制，因此只有少数人可以访问它们。该方法的缺点是数据将长达一小时不同步，我们只需要为此目的创建一个新服务器。此外，当日志传送过程运行时，每个连接都会在很短的时间内下降，但对于非常长的过程或报告来说可能是一个问题。在此之后，我将验证报告中的查询，以便了解可以优化的内容。谢谢，我会向整个 IT 部门推荐该网站。

# c# - C# 中修饰符的顺序是否有约定？

> ID：191929
> 
> 赞同：30
> 
> 时间：2008-10-10T15:40:00.067
> 
> 标签：c#

如果我要使用多个，我应该按什么顺序使用修饰符关键字，例如：

`public`, `private`, `protected`, `virtual`, `abstract`, `override`, `new`, `static`, `internal`, `sealed`, 以及其他我忘记的东西。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2015-10-20T12:55:39.183

我查看了 Microsoft 的[框架设计指南](https://msdn.microsoft.com/en-us/library/ms229042%28v=vs.100%29)，找不到任何关于应该在成员上放置哪些顺序修饰符的参考。同样，查看[C# 5.0 语言规范](https://www.microsoft.com/en-gb/download/details.aspx?id=7029)也被证明是徒劳的。不过，还有另外两种途径可供使用：[EditorConfig 文件](https://docs.microsoft.com/en-us/visualstudio/ide/create-portable-custom-editor-options?view=vs-2017)和[ReSharper](https://www.jetbrains.com/resharper)。

* * *

# .editorconfig

MSDN 页面，[EditorConfig 的 .NET 编码约定设置](https://docs.microsoft.com/en-us/visualstudio/ide/editorconfig-code-style-settings-reference?view=vs-2017)说：

> 在 Visual Studio 2017 中，您可以使用[EditorConfig](https://docs.microsoft.com/en-us/visualstudio/ide/create-portable-custom-editor-options?view=vs-2017)文件在代码库中定义和维护一致的代码样式。
> 
> # 示例编辑器配置文件
> 
> 为了帮助您入门，下面是一个带有默认选项的示例 .editorconfig 文件：
> 
> ```
> ###############################
> # C# Code Style Rules         #
> ###############################
> 
> # Modifier preferences
> csharp_preferred_modifier_order = public,private,protected,internal,static,extern,new,virtual,abstract,sealed,override,readonly,unsafe,volatile,async:suggestion 
> ```

换句话说：修饰符的默认顺序，遵循默认的 editorconfig 设置是：

```
{ public / private / protected / internal / protected internal / private protected } // access modifiers
static
extern
new
{ virtual / abstract / override / sealed override } // inheritance modifiers
readonly
unsafe
volatile
async 
```

* * *

## 锐化器

然而，[ReSharper更即将推出。](https://www.jetbrains.com/resharper/)ReSharper 2018.1 ¹的默认值，包括访问修饰符（排他性）和继承修饰符（排他性），组合在一起是：

```
{ public / protected / internal / private / protected internal / private protected } // access modifiers
new
{ abstract / virtual / override / sealed override } // inheritance modifiers
static
readonly
extern
unsafe
volatile
async 
```

这存储在`{solution}.dotsettings`文件中

```
"/Default/CodeStyle/CodeFormatting/CSharpFormat/MODIFIERS_ORDER/@EntryValue" 
```

节点 - ReSharper 默认²是：

```
<s:String x:Key="/Default/CodeStyle/CodeFormatting/CSharpFormat/MODIFIERS_ORDER/@EntryValue">
    public protected internal private new abstract virtual sealed override static readonly extern unsafe volatile async
</s:String> 
```

¹ [ReSharper 2018.1](https://www.jetbrains.com/resharper/whatsnew/#v2018-1)表示它“*完全理解 C# 7.2* ”并明确提到了`private protected`访问修饰符。

² ReSharper 仅保存与默认设置不同的设置，因此通常不会在`dotsettings`文件中看到此节点。

* * *

## `new static`对比`static new`

[Compiler Warning CS0108](https://msdn.microsoft.com/en-us/library/3s8070fc.aspx)的 MSDN 页面给出`i`了基类上的公共字段被派生类上的公共静态字段隐藏的示例`i`：他们的建议是更改`static`为`static new`：

> ```
> public class clx
> {
>     public int i = 1;
> }
> 
> public class cly : clx
> {
>     public static int i = 2; // CS0108, use the new keyword
>     // Use the following line instead:
>     // public static new int i = 2;
> } 
> ```

同样，Visual Studio 2015 中的 IntelliSense 也建议更改`static`为`static new`

[![CS0108 Visual Studio 推荐更改](https://i.stack.imgur.com/7vWEY.png)](https://i.stack.imgur.com/7vWEY.png)

如果`i`基类中的字段也是`static`.

也就是说，在 GitHub 上粗略搜索发现，一些项目会覆盖此默认设置，将继承修饰符放在`static` *before*而不是*after* 和，例如 [StyleCop GitHub 项目的 ReSharper 设置](https://github.com/StyleCop/StyleCop/blob/master/Project/Src/AddIns/ReSharper/StyleCop.dotSettings#L75)：`new``sealed`

```
<s:String x:Key="/Default/CodeStyle/CodeFormatting/CSharpFormat/MODIFIERS_ORDER/@EntryValue">
    public protected internal private static new abstract virtual override sealed readonly extern unsafe volatile async
</s:String> 
```

然而，由于`static`不能与继承修饰符 or 一起使用`sealed`，这只是`new static`（默认的，并且由默认的 editorconfig 文件建议）和`static new`（由 ReSharper 建议）之间的区别。

我个人更喜欢后者，但谷歌在[referencesource.microsoft.com](http://referencesource.microsoft.com/)中搜索2015 年和 2018 年的[`new static`](https://www.google.co.uk/?gws_rd=ssl#q=inurl:referencesource.microsoft.com%2F+%22new+static%22)vs给出了：[`static new`](https://www.google.co.uk/?gws_rd=ssl#q=inurl:referencesource.microsoft.com%2F+%22static+new%22)

```
 (in 2015)  (in 2018)
new static   203        427
static new   10         990 
```

这意味着微软的偏好是`static new`.

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-10T15:43:24.867

[StyleCop](https://stylecop.codeplex.com)可作为[Visual Studio 扩展](https://marketplace.visualstudio.com/items?itemName=ChrisDahlberg.StyleCop)或[NuGet 包](https://www.nuget.org/packages/StyleCop.MSBuild)使用，并且可以根据 Microsoft 中的某些团队使用的规则验证您的源代码。StyleCop 喜欢把访问修饰符放在第一位。

编辑：微软本身并不完全一致。不同的团队使用不同的风格。例如 StyleCop 建议在命名空间中放置 using 指令，但在 Roslyn 源代码中没有遵循这一点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T15:42:30.733

我通常先从访问修饰符开始，然后是 virtual/abstract/sealed，然后是 override/new/etc。尽管其他人可能会采取不同的做法。然而，几乎总是访问修饰符是第一位的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-16T09:52:28.477

在某些情况下，有很多可能性。例如下面`C`带有基类的类`B`，

```
public class B
{
  public void X()
  {
  }
}
public class C : B
{
  protected internal new static readonly DateTime X;
} 
```

type `DateTime`in的字段`C`有不少于五个不同的修饰符，所以`5! == 5*4*3*2*1 == 120`同一个字段有不同的写法！没有和相邻会*很混乱，但它仍然是合法的。*`protected``internal`

不确定是否每个人都同意该订单的约定。例如，我看到有些人将`new`修饰符*放在*访问级别（保护级别）修饰符之前，尽管很多人喜欢总是将保护级别修饰符放在第一位。

# database - 有人对 GUI 销售点系统有数据库、编程语言/框架建议吗？

> ID：191934
> 
> 赞同：8
> 
> 时间：2008-10-10T15:40:57.553
> 
> 标签：database, frameworks, client-server, point-of-sale

我们公司有一个带有许多附加功能的销售点系统，例如订购和接收功能、销售和订单历史记录等。我们的主要问题是该系统从一开始就没有正确设计，因此修复和修复需要很长时间处理来自我们客户的请求。此外，由于数据库连接的多用户许可费用等，我们正在使用的当前技术（Progress 数据库，Progress 4GL 语言）给我们的客户带来了相当多的许可费用。

经过大量讨论后，看起来我们可能会从头开始（同时至少暂时保持当前产品）。我们正在寻找几件事：

1.  使用漂亮的 GUI 前端创建系统（目前是 CHUI，并且应用程序的构建方式不支持我们重新设计前端...没有分层或分离业务逻辑和 GUI...不寒而栗）。

2.  创建具有模块化不同功能的能力的系统，因此产品不必包含所有功能。这将降低我们当前需要基本功能和较低价格标签的客户的成本。这些花里胡哨的东西可供那些想要它们的人使用。

3.  使用适当的设计模式使产品易于随时添加或更改任何部分（即更改数据库或更改前端，而无需重写应用程序或大部分应用程序）。这是今天的一个问题，因为 Progress 4GL 代码是直接针对数据库编译的。数据库中的小改动需要大量的代码重新编译。

我们的新系统将基于 Linux，客户端应用程序可能会从一个或多个 Windows 框提供功能。

所以我正在寻找的是关于有人可能会为这类产品推荐哪种数据库和/或框架或编程语言的任何建议。任何在该领域有经验的人都可以为我们指明正确的方向，甚至对要避免的事情有一些想法。我们已经考虑过 .NET 和 SQL Express（我们不需要企业级数据库），但这会将我们限制在 Windows 上（据我所知）。我听说过用于在 Linux 环境中编写 .NET 代码的 Mono，但我对它还不太了解。我们还考虑了基于 Java 和 MySql 的实现。

总而言之，我们希望做到以下几点：

1.  降低我们将用于开发产品的技术的许可成本（甲骨文，哎呀！MySQL，很好。）

2.  提供易于维护和支持的解决方案。

3.  具有能够通过 CHUI 前端在“旧”硬件上运行的组件的解决方案。（我们的一些客户拥有 40 多个终端，这将是大量现金才能转换为 PC）。

建议将不胜感激。

谢谢

[更新] 我应该指出，我们目前正在执行总成本分析。这个问题旨在为我们提供几个“受过教育”的选项，以供研究以纳入或分析。任何可以分享有关客户端/服务器设置的经验/建议的人都将不胜感激（不仅仅是那些有销售点系统经验的人......这只是一个奖励）。

**[更新]**

对于任何感兴趣的人，我们最终选择了 Microsoft Dynamics NAV、LS Retail（一个用于销售点和其他各种东西的插件），然后在此基础上做了一些（目前正在研究）定制工作。这种设置为我们提供了一个额外的好处，即拥有一个我们当前系统所缺乏的完全集成的 g/l 系统。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T15:51:49.403

用于语言的 Java（或者 Scala，如果您想成为“前沿”，取决于您计划如何支持它以及您的开发人员喜欢它可能会更好，但也可能更糟）

H2 用于数据库

用于 GUI 的 Swing

原因：免费、便携且非常标准。

更新：错过了系统应该是客户端-服务器设置的部分。我的假设是数据库和客户端应该在同一台机器上运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T15:52:21.197

我建议您使用浏览器的 UI。

将您的应用程序组织为 Web 应用程序。

后端有很多选项。您可以使用 Java + MySQL。Java 后端将使您免于 windows/linux 争论，因为它可以在两个平台上运行。您不会为 Java 和 MySQL 支付任何许可费用。（编辑：当然还有很多其他语言都有运行时用于 linux 和 windows，包括 PHP、Ruby、Python 等）

如果您走这条路，您可能还需要考虑使用 Google Web Toolkit (GWT) 以模块化方式创建基于浏览器的前端。

不过要注意一点。在内存管理方面，浏览器可能会让人讨厌。根据我们的经验，这是进行基于浏览器的 POS 时最重大的挑战。您可能想查看在浏览器中运行的 Adob​​e Flex，但它的内存管理可能更加文明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T16:04:48.707

我建议您首先研究一下您的限制条件——您使用特定类型的终端对客户进行了传递引用——这可能会限制您的选择，除非客户同意升级。

你需要在这方面做更多的工作。从网络论坛获得意见固然好，但我们不可能像您一样了解您的环境。

我的粗略建议是瞄准广泛使用的技术。这样一来，平台上的专业知识比“利基”技术便宜，而且如果碰壁了也更容易获得帮助。当然，如果您已经在客户那里采用了不可协商的技术，则可能无法遵循此建议。

我的第二个建议是在使用“从头开始重写”选项之前完成一个完整的项目计划，包括详细的规格和适当的成本估算。现在，你说重写系统比维护它更便宜，你真的不知道重写要花多少钱。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T17:14:09.037

什么是崔？Character-UI，就像在 VT 终端中一样？甚至是3270风格？

听起来您需要一个 3 层系统 - 数据库后端、运行大部分后端业务流程的中间层，以及 CHUI / GUI / 数据网关的前端层。

所有三层都可以驻留在一台机器上；或者您可以将这些层分发到不同的服务器。前端层将控制实际的终端，无论它们是 VT 终端、网络浏览器还是自定义编写的“客户端”应用程序。

确保您已经考虑了这里的硬件需求——您是否将拥有条形码扫描仪、现金抽屉、POS 借记/贷记终端等？如果您使用的是标准浏览器，则可能很难可靠地集成这些项目。（至少，您可能不得不编写特殊的小程序来处理它们。）

最后，考虑在 Windows 上使用瘦客户端技术的可能性。它极大地简化了系统管理，因为您只需集中升级软件。瘦客户端 PC 很便宜——不到 200 美元。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-26T18:04:11.000

Golden Code Development（参见 www.goldencode.com）拥有一项技术，可以将 Progress 4GL（模式和代码……整个应用程序）自动转换为具有关系数据库后端（例如 PostgreSQL）的 Java 应用程序。他们目前支持非常完整的 CHUI 环境，并且他们确实重构了代码。例如，转换将 UI、数据模型和业务逻辑分离为单独的 Java 类。整个结果是与原始兼容的直接替换（用户不需要重新培训，流程不需要修改，数据也可以迁移）。这是可能的，因为它们提供了一个应用程序服务器和一组提供这种兼容性的运行时类。自动转换的结果在编译和运行之前不需要进一步编辑。包括真正的终端支持，因此硬件终端仍然可以工作（它需要一个小型 JNI 库才能从 Java 访问 NCURSES）。运行时中的所有其余代码都是纯 Java。生成的系统中使用了 No Progress Software Corp 技术，它在 Linux 上运行。

At least one converted system is already in production, running a 24 by 7 mission critical environment. It is a converted ERP system that their mid-sized pilot customer uses to run their entire business.

# c# - C# 泛型不允许委托类型约束

> ID：191940
> 
> 赞同：80
> 
> 时间：2008-10-10T15:42:23.433
> 
> 标签：c#, generics, events, delegates, constraints

是否可以在 C# 中定义一个类

```
class GenericCollection<T> : SomeBaseCollection<T> where T : Delegate 
```

昨晚在 .NET 3.5 中，我终生无法做到这一点。我尝试使用

`delegate, Delegate, Action<T> and Func<T, T>`

在我看来，这在某种程度上应该是允许的。我正在尝试实现我自己的 EventQueue。

我最终只是这样做了[请注意原始近似]。

```
internal delegate void DWork();

class EventQueue {
    private Queue<DWork> eventq;
} 
```

但是后来我失去了为不同类型的函数重用相同定义的能力。

想法？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-10-10T15:44:28.827

许多类不能作为通用约束 - Enum 是另一个。

对于委托，您可以获得的最接近的是“：类”，可能使用反射来检查（例如，在静态构造函数中）T*是*委托：

```
static GenericCollection()
{
    if (!typeof(T).IsSubclassOf(typeof(Delegate)))
    {
        throw new InvalidOperationException(typeof(T).Name + " is not a delegate type");
    }
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2018-05-11T11:28:15.260

是的，在 C# 7.3 中是可能的，约束系列增加到包括`Enum`,`Delegate`和`unmanaged`类型。您可以毫无问题地编写此代码：

```
void M<D, E, T>(D d, E e, T* t) where D : Delegate where E : Enum where T : unmanaged
    {

    } 
```

[从文档](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/generics/constraints-on-type-parameters#unmanaged-constraint)：

> 从 C# 7.3 开始，您可以使用非托管约束来指定类型参数必须是不可为空的非托管类型。非托管约束使您能够编写可重用的例程来处理可作为内存块操作的类型

有用的链接：

[C# 的未来](https://www.youtube.com/watch?v=QZ0rWLaMZeI&t=650s)，来自 Microsoft Build 2018

[C# 7.3 中有哪些新功能？](https://dev.to/borrrden/whats-new-in-c-73-26fk)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-10T15:52:24.210

**编辑：**这些文章中提出了一些建议的解决方法：

[http://jacobcarpenters.blogspot.com/2006/06/c-30-and-delegate-conversion.html](http://jacobcarpenters.blogspot.com/2006/06/c-30-and-delegate-conversion.html)

[http://jacobcarpenters.blogspot.com/2006_11_01_archive.html](http://jacobcarpenters.blogspot.com/2006_11_01_archive.html)

* * *

从[C# 2.0 规范](http://download.microsoft.com/download/9/8/f/98fdf0c7-2bbd-40d3-9fd1-5a4159fa8044/CSharp%202.0%20Specification_Sept_2005.doc)我们可以读到（20.7，约束）：

类类型约束必须满足以下规则：

*   类型必须是类类型。
*   该类型不得密封。
*   **该类型不能是以下类型之一：System.Array、System.Delegate、System.Enum 或 System.ValueType**。
*   类型不能是对象。因为所有类型都派生自对象，所以如果允许，这样的约束将不起作用。
*   给定类型参数的最多一个约束可以是类类型。

果然 VS2008 吐出一个错误：

```
error CS0702: Constraint cannot be special class 'System.Delegate' 
```

有关此问题的信息和调查，请阅读[此处](http://www.pluralsight.com/community/blogs/mike/archive/2005/12/06/17307.aspx)。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-06-01T07:46:02.087

如果你愿意在编译时依赖于 IL Weaver，你可以使用[Fody](https://github.com/Fody/Fody)来做到这一点。

使用这个插件到 Fody [https://github.com/Fody/ExtraConstraints](https://github.com/Fody/ExtraConstraints)

**您的代码可能如下所示**

```
public class Sample
{
    public void MethodWithDelegateConstraint<[DelegateConstraint] T> ()
    {        
    }
    public void MethodWithEnumConstraint<[EnumConstraint] T>()
    {
    }
} 
```

**并编译成这个**

```
public class Sample
{
    public void MethodWithDelegateConstraint<T>() where T: Delegate
    {
    }

    public void MethodWithEnumConstraint<T>() where T: struct, Enum
    {
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-10T18:20:27.827

委托已经支持链接。这不符合您的需求吗？

```
public class EventQueueTests
{
    public void Test1()
    {
        Action myAction = () => Console.WriteLine("foo");
        myAction += () => Console.WriteLine("bar");

        myAction();
        //foo
        //bar
    }

    public void Test2()
    {
        Action<int> myAction = x => Console.WriteLine("foo {0}", x);
        myAction += x => Console.WriteLine("bar {0}", x);
        myAction(3);
        //foo 3
        //bar 3
    }

    public void Test3()
    {
        Func<int, int> myFunc = x => { Console.WriteLine("foo {0}", x); return x + 2; };
        myFunc += x => { Console.WriteLine("bar {0}", x); return x + 1; };
        int y = myFunc(3);
        Console.WriteLine(y);

        //foo 3
        //bar 3
        //4
    }

    public void Test4()
    {
        Func<int, int> myFunc = x => { Console.WriteLine("foo {0}", x); return x + 2; };
        Func<int, int> myNextFunc = x => { x = myFunc(x);  Console.WriteLine("bar {0}", x); return x + 1; };
        int y = myNextFunc(3);
        Console.WriteLine(y);

        //foo 3
        //bar 5
        //6
    }

} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-01-18T18:30:38.463

我遇到了一种情况，我需要在`Delegate`内部处理一个但我想要一个通用约束。具体来说，我想使用反射添加一个事件处理程序，但我想为委托使用一个通用参数。下面的代码不起作用，因为“处理程序”是一个类型变量，编译器不会`Handler`转换为`Delegate`：

```
public void AddHandler<Handler>(Control c, string eventName, Handler d) {
  c.GetType().GetEvent(eventName).AddEventHandler(c, (Delegate) d);
} 
```

但是，您可以传递一个为您进行转换的函数。`convert`接受一个`Handler`参数并返回一个`Delegate`：

```
public void AddHandler<Handler>(Control c, string eventName, 
                  Func<Delegate, Handler> convert, Handler d) {
      c.GetType().GetEvent(eventName).AddEventHandler(c, convert(d));
} 
```

现在编译器很高兴。调用该方法很容易。例如，附加到`KeyPress`Windows 窗体控件上的事件：

```
AddHandler<KeyEventHandler>(someControl, 
           "KeyPress", 
           (h) => (KeyEventHandler) h,
           SomeControl_KeyPress); 
```

`SomeControl_KeyPress`事件目标在哪里。关键是转换器 lambda - 它不起作用，但它让编译器相信你给了它一个有效的委托。

（从 280Z28 开始）@Justin：为什么不使用这个？

```
public void AddHandler<Handler>(Control c, string eventName, Handler d) { 
  c.GetType().GetEvent(eventName).AddEventHandler(c, d as Delegate); 
} 
```

(完 280Z28)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-05-19T02:22:29.813

如上所述，您不能将 Delegates 和 Enum 作为通用约束。`System.Object`也`System.ValueType`不能用作通用约束。

如果您在 IL 中构建适当的调用，则可以解决此问题。它会正常工作。

这是 Jon Skeet 的一个很好的例子。

[http://code.google.com/p/unconstrained-melody/](http://code.google.com/p/unconstrained-melody/)

我参考了 Jon Skeet 的书*C# in Depth*，第 3 版。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-04-30T08:21:17.573

根据[MSDN](https://msdn.microsoft.com/en-us/library/56b2hk61.aspx)

**编译器错误 CS0702**

约束不能是特殊类“标识符”以下类型不能用作约束：

*   系统对象
*   系统数组
*   系统委托
*   系统枚举
*   系统值类型。

# cil - CIL 堆栈交换指令

> ID：191946
> 
> 赞同：11
> 
> 时间：2008-10-10T15:43:47.020
> 
> 标签：cil

是否有 CIL 指令来交换堆栈中的前两个元素？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-10T15:49:26.117

没有单一的指令交换。但是，使用[stloc](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.stloc.aspx)、[pop](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.pop.aspx)和[ldloc](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.ldloc.aspx)，您应该能够完成您的交换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T21:28:53.187

不可以。交换元素的唯一方法是将前两个元素弹出到本地，然后以相反的顺序推送它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T15:50:07.770

查看[CIL 指令列表，](http://en.csharp-online.net/CIL_Instruction_Set)似乎没有一条指令可以交换堆栈顶部的两个元素。您必须使用旧的弹出/推送方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T16:50:08.383

为了将来参考，您可以创建一个程序集来执行您想要学习 IL 的任务，然后在 Reflector 中查看该程序集。您可以选择您希望代码使用的语言，IL 是选项之一。我在试图弄清楚如何编写动态方法时这样做了......

# resharper - 如何解决 ReSharper 关于类继承的不正确“歧义引用”？

> ID：191950
> 
> 赞同：29
> 
> 时间：2008-10-10T15:44:58.140
> 
> 标签：resharper

在我的项目中，我有一个由许多其他类继承的类。我们称它为 ClassBase。

```
public class ClassInheritFromBase : ClassBase 
```

当 ClassBase 被继承时，[ReSharper](http://en.wikipedia.org/wiki/ReSharper)会在 ClassBase 上引发“不明确的引用”警告，并且从 ClassBase 继承的新类中的任何内容都没有 IntelliSense 并收到无法找到它的警告。

该项目编译并运行良好。

如果我更改命名空间 ClassBase 所在的位置，然后更改继承类，他们会发现它很好并且 ReSharper 没有问题，IntelliSense 可以工作......直到它被编译。编译后，它又回到了模棱两可的参考警告和其他一切。

以前见过这种情况吗？如何解决？我在 JetBrains 错误跟踪中看到了一个类似这样的问题的条目，但他们将其关闭为无法重现。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2011-01-20T08:33:01.257

对于那些对此仍有疑问的人，（我仍然不时得到它）这是我为摆脱 ReSharper 中模棱两可的参考警告所做的步骤。

1.  首先，我访问了我所有的类库，并确保对我的其他类库的所有引用都将*Copy Local*属性设置为 false。
2.  在我实际收到不明确引用警告的项目中，我去了我的 bin 目录并删除了所有拥有自己项目的库的所有 .dll 和 .pdb 文件。
3.  在新构建之后，或者在我的情况下，在 VS 中对 .dll 文件进行“更新参考”之后，来自 Resharper 的错误就消失了。

我在 Visual Studio 2008 中使用 Resharper 5.1，只引用了我正在使用的 dll，这就是我必须“更新引用”的原因

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-02-24T14:53:15.543

我正在使用 VS 2012 和 ReSharper 7，有时我发现了相同的行为。这些是对我有用的步骤：

1.  清洁解决方案
2.  关闭 Visual Studio
3.  转到解决方案的根文件夹并找到一个名为 _ReSharper.[Name of your solution] 的文件夹并将其删除。
4.  返回 Visual Studio，打开您的解决方案，重新创建文件夹，之后不再出现“模糊引用”错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T22:43:49.020

我在 ReSharper 4.1 中看到了这个错误。当基类位于 App_Code 目录中时会发生这种情况。我不知道如何解决它；这很烦人，但代码仍然可以编译。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-07-06T19:57:27.077

你可能真的有一个模棱两可的参考。在出现歧义引用错误的项目中，请务必签入您的项目引用。您可能有两次相同的引用，但范围通过不同的命名空间。就我而言，有两个，但路径不同（示例）：

```
XXX.YYY.ZZZ.myassembly
ZZZ.myassembly 
```

确保你的参考文献中没有这种东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-15T21:29:03.923

这是 ReSharper 4.1 中的一个错误，并在后来的夜间版本之一中得到修复。

[在http://www.jetbrains.net/confluence/display/ReSharper/ReSharper+4.0+Nightly+Builds](http://www.jetbrains.net/confluence/display/ReSharper/ReSharper+4.0+Nightly+Builds)下载最后一个夜间构建 。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-11T13:32:39.030

ReSharper -> 选项 -> 常规：单击 #Clear Caches # 按钮。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-02-26T11:35:36.927

对我来说，这是我不使用缓存的解决方案文件夹的问题。将其从 TEMP 位置更改为解决方案解决了我的问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-08-26T08:19:57.340

我删除了解决方案根目录中的 _ReSharper.SolutionName 文件夹并重新启动。

我正在使用带有 ReSharper 5.1 的 Visual Studio 2010... 清除缓存**没有**帮助（ReSharper -> 菜单*选项*->*常规*-> #Clear Cache#）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-03T12:00:02.557

我遇到了同样的问题。[我遇到的问题是由自定义构建提供程序（来自我正在使用的名为PageMethods](http://www.codeplex.com/PageMethods)的开源库）以及我的所有 .aspx 页面都继承自 App_Code 文件夹中的 BasePage 类这一事实引起的。

我无法使用任何 ReSharper 构建来处理我的项目（4.1.933、4.1.943（最新）或 4.5）。最新 ReSharper 构建中的修复修复了“不明确的参考”问题，但破坏了自定义构建提供程序。

我可以让构建提供程序和基类都与 ReSharper 一起使用的唯一方法是将基类放入单独的类库中。

以下是似乎与此问题相关的已记录 Jira 错误：

*   [来自 App_Code 的符号的错误“不明确的参考”](http://www.jetbrains.net/jira/browse/RSRP-92804)
*   [自定义构建提供程序可能会生成部分类，第二部分位于 app_code](http://www.jetbrains.net/jira/browse/RSRP-68028)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-28T11:51:27.670

我在引用 AppCode 文件夹中的 C# 类时遇到了同样的问题。

我通过将 ReSharper 升级到 4.5 版（从 4.1 版）解决了这个问题。

这是一个非常简单的升级，我只需要从 JetBrains 网站 ( [http://www.jetbrains.com/resharper/download/](http://www.jetbrains.com/resharper/download/) ) 获取最新版本并运行它。

我不必卸载以前的版本（v4.1）。我不必重新输入我现有的许可证密钥。

现在可以正确识别所有引用，并且我可以按预期导航到这些类。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-03-09T07:18:30.710

我在 ReSharper 5.1 上遇到了同样的问题，并通过重新启动 Visual Studio 2010 解决了这个问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-03-14T16:56:49.303

使用 VS 2013 Premium & Resharper 8.1，并且在 ASP.Net 项目中遇到了这个问题。

对我有用的解决方案：

1.  做一个干净的解决方案。
2.  打开有问题项目的引用
3.  在每个引用解决方案中另一个项目的引用上，设置`Copy Local = false`.
4.  尝试重建解决方案。您可能会得到未解决的参考错误——这很正常。
5.  将每个引用设置回`Copy Local = true`（在适当的情况下）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-11-14T19:29:58.373

使用 R# 2019.2.3 并使用新的 SDK .csproj 格式（在 .NET 引用、NUGET 包和项目依赖项之间拆分引用），R# 仍倾向于在程序集下添加项目引用，即使存在已经是依赖项下的项目参考。这会导致歧义错误，但可能很难注意到，因为引用位于两个不同的位置。查找出现在“程序集”下的任何项目引用并将其删除。

# c# - Linq 错误索引

> ID：191952
> 
> 赞同：1
> 
> 时间：2008-10-10T15:45:28.777
> 
> 标签：c#, .net, sql, linq, linq-to-sql

如果我有以下 Linq 代码：

```
context.Table1s.InsertOnSubmit(t);
context.Table1s.InsertOnSubmit(t2);
context.Table1s.InsertOnSubmit(t3);

context.SubmitChanges(); 
```

由于第二次插入，我得到一个数据库错误，Linq 抛出一个异常，指出有错误。但是，有没有办法找出问题是第二个插入而不是第一个或第三个？

澄清一下，我预计第二次失败是有商业原因的（我正在使用存储过程进行插入，并且还在进行一些验证并在失败时引发错误）。我希望能够告诉用户哪一个失败了以及为什么。我知道在 C# 代码中而不是在数据库中进行此验证会更好，但目前这不是一个选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T19:39:29.883

注释掉第一个和第三个插入以将它们排除为嫌疑人。

我的第一个想法是第二个插入与第一个具有相同的 ID，但是如果没有有关错误的更多详细信息，很难诊断您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T21:27:01.757

您可以明确指定这样的冲突模式：

```
context.SubmitChanges(ConflictMode.ContinueOnConflict); 
```

如果要插入有效的内容并且不会在第一次冲突中失败，请使用

```
context.ChangeConflicts 
```

集合以找出在插入过程中哪些对象发生冲突。

# sql - 在存储过程中使用三态参数

> ID：191955
> 
> 赞同：1
> 
> 时间：2008-10-10T15:46:22.270
> 
> 标签：sql, stored-procedures

这样做的正确方法是什么？例如，我将如何使用此签名更改存储过程：

```
CREATE PROCEDURE dbo.MyProcedure
  @Param BIT = NULL
AS
  SELECT *
  FROM dbo.SomeTable T
  WHERE T.SomeColumn = @Param 
```

所以给@Param 赋值1 或0 执行过滤，但不指定它或传递NULL 不执行过滤？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T15:48:32.953

假设 NULL 表示“不在乎”，然后使用

```
CREATE PROCEDURE dbo.MyProcedure 
   @Param BIT = NULL
AS
   SELECT *
   FROM dbo.SomeTable T
   WHERE T.SomeColumn = @Param OR @Param IS NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T16:30:16.910

方法不止一种。这是一个：

```
SELECT *
  FROM dbo.SomeTable T
  WHERE T.SomeColumn = COALESCE(@Param, T.SomeColumn) 
```

但这不包括 T.SomeColumn 为 NULL 的行。

以下替代方案将包括这些行：

```
SELECT *
  FROM dbo.SomeTable T
  WHERE T.SomeColumn = @Param OR @Param IS NULL 
```

但它有重复参数的缺点，如果您使用另一种方式来传递参数，例如使用占位符，这并不好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T16:29:39.437

我碰巧认为最干净的方法是（在 T-SQL 中）是：

```
SELECT * FROM TABLE WHERE column = ISNULL(@param, column) 
```

其他 RDBMS 更喜欢 COALESCE 而不是 ISNULL。

我认为这里的意图更明显，特别是当您开始添加其他 OR 子句时，它还使您在与 AND 子句组合时不需要括号。

在我（非常）有限的测试中，使用 ISNULL 与 OR @p IS NULL 相比，性能增加也可以忽略不计。并不是说我提倡使用 ISNULL*是因为*性能提高（这充其量是非常微不足道的，并且在最坏的情况下会受到非常具体的情况的影响），但很高兴知道它没有显着的成本。坦率地说，我不确定为什么它会有所不同，但执行计划显示过滤器成本大约有 1% 的差异。

# uml - 你会在用例图上展示演员不能做的事情吗？

> ID：191967
> 
> 赞同：8
> 
> 时间：2008-10-10T15:48:04.780
> 
> 标签：uml, use-case

在用例图上，您能否展示参与者**不能**做的事情，例如因为他们没有权限去做？

还是因为它们没有将它们与特定用例连接起来的事实而只是暗示？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T15:56:03.593

如果您正在绘制的用例是演员试图做一些不允许的事情然后被拒绝的情况，那么是的，我会展示它。

否则，我会坚持只包括实际上是用例一部分的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T15:55:32.160

不会。Actor 会与他能做的所有事情相关联。如果 Actor 做不到，则不会显示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-12T22:51:46.140

这就是替代路径的用途。基本路径（又名快乐路径）将显示正确的 Actor 启动用例时会发生什么。在备用路径中，您可以显示如果错误的 Actor 尝试启动它会发生什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T15:59:50.123

您可以为可以完成任务的角色角色建模。然后，您可能会有另一个用例，其中原始参与者尝试获取给定角色。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-24T12:24:34.467

恕我直言，这个问题和大多数答案对用例的使用方式产生了错误的印象。

用例旨在作为一种使用自然语言的需求技术。这种方式是最有效的。

当它与过多的 UML/建模相结合时，它可能是一种彻底的破坏性技术。用例文本的结构化建模（例如，通过使用 UML 活动图对主要流和替代流进行建模）是一种久经考验的方法，例如创建[大规模破坏用例](http://www.drdobbs.com/use-cases-of-mass-destruction/184415814)。

用例图可能很有用，但我们应该记住用例的目的是一种技术，它首先是识别系统应该支持的用户目标。随后，我们可以使用自然语言在使用主流、替代流等的用例文本中捕获更多细节。

使用图表工具，我们可以可视化一些简单的信息： - 对于每个用户目标，我们可以创建模型元素类型用例。- 使用带有用例元素的系统框显示系统边界。- 在参与者和用例之间建立关系，以表明参与者对系统有特定的目标。

然而，保持映射到目标的最新参与者列表是次要的。进行利益相关者分析，制定参与者列表是确定用户目标的一种方法。在确定了用户目标之后，严格来说不再需要保留参与者列表。

如果我们询问有关如何将用户权限放入用例模型的问题，我们很可能试图捕获太多信息。我们应该将模型元素抽象出来，这样模型就不会试图回答/捕获这些类型的详细设计问题。

# sql-server - 在远程服务器 SQL 2005 上部署时出现 NT AUTHORITY\NETWORK SERVICE 问题

> ID：191970
> 
> 赞同：1
> 
> 时间：2008-10-10T15:48:21.160
> 
> 标签：sql-server, remoting

尝试连接到远程服务器上的 SQL 服务器时，我收到一个非常非特定的错误。我觉得我已经进行了所有正确的设置，允许 TCP/IP，重新启动服务，为数据库添加 NT AUTHORITY\NETWORK SERVICE 和其他相关用户的权限。我可以进入 aspx 页面，但只要我在登录时点击提交，我就会得到：

异常信息：异常类型：SqlException 异常消息：建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：命名管道提供者，错误：40 - 无法打开与 SQL Server 的连接）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T15:58:58.970

在远程服务器上，为强制 TCP/IP 和端口的服务器实例创建一个别名，并在连接字符串中使用该别名。这样它甚至不会尝试使用 DBNMP。

您也可以尝试强制连接字符串中的问题： [http ://connectionstrings.com/article.aspx?article=howtodefinewichnetworkprotocoltouse](http://connectionstrings.com/article.aspx?article=howtodefinewichnetworkprotocoltouse)

# sql - 过去 10 年有哪些关系数据库创新

> ID：191974
> 
> 赞同：8
> 
> 时间：2008-10-10T15:49:24.213
> 
> 标签：sql, database, relational, innovation

关系数据库的 SQL 实现以目前的形式已经存在了大约 25 年（自 System R 和 Ingres 以来）。甚至主要（松散地遵守）标准是 ANSI-92（尽管后来有更新）也有 15 年的历史。

在过去十年左右的时间里，您能想到基于 SQL 的数据库有哪些创新。我特别排除了 OLAP、列式和其他非关系（或至少非 SQL）创新。我还想排除“应用程序服务器”类型的功能和捆绑（如报告工具）

尽管基本方法仍然相当静态，但我可以想到：

*   可用性
*   能够处理更大的数据集
*   易于维护和配置
*   支持更高级的数据类型（blob、xml、unicode 等）

还有其他你能想到的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-12T12:21:33.133

*   哈希连接
*   基于成本的优化器（几乎完全颠覆了查询编写）
*   分区（实现更好的 VLDB 管理）
*   并行（多线程）查询处理
*   集群（不仅是可用性，还有可扩展性）
*   SQL 更灵活，SQL 与 3GL 语言更容易集成
*   更好的诊断能力

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-10T15:57:03.763

RANK 等分析函数

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T15:51:41.277

我不确定您是否要包括特定于供应商的创新（我也不完全确定其他数据库引擎还不能这样做），但 SQL Server 2005 将递归 transact-sql 查询添加到他们的语言中。我发现它们对于迭代分层数据非常有用。我相信 2008 年增加了一些与分层数据相关的新功能，但我没有仔细研究过。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T16:14:56.083

```
SELECT (invoiceprice * detailweight) / SUM(weight) OVER(PARITTION BY invoice) as weighted, * 
FROM tblInvoiceDetails 
```

加窗函数非常适合做加权平均等以前需要 CURSORS 的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T16:17:49.260

好吧，有人可能会说，15 年来缺乏运动不仅仅是缺乏创新的标志，而是数据库几乎完美的标志！许多人试图在代码中做一些事情，这些代码在自 1960 年代以来已经改进的数据库中做得更好，以尽可能快和高效地运行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-10T16:50:25.650

我想说过去十年（1998-2008）已经看到开源 RDBMS 产品在主流部署中变得可行。大多数财富 500 强公司现在在其组织中的某个地方使用 MySQL 或 PostgreSQL 或其他开源 RDBMS，即使他们也使用商业、闭源 RDBMS 品牌之一。

这不是技术进步，但值得注意的是，稳定的开源 RDBMS 引擎的可用性支持许多其他创新项目。

我意识到 MySQL 和 PostgreSQL 早在 1995 年就可以使用，但我认为它们在那之后的几年内都不是主流。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-03-13T22:36:25.960

除了更高级的数据类型（blob、xml、unicode 等）列表之外，您还应该包括空间类型。

PostgreSQL 的 PostGIS 扩展于 2001 年问世，但现在所有主要供应商都实现了空间对象和空间 SQL。

随着谷歌地图、必应地图和 OpenLayers 的兴起，无需中间件即可显示地理空间数据和运行空间查询的能力对 Web 和数据分析产生了巨大影响。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T16:17:29.463

我认为大部分进展都在性能领域——查询分析器和集群。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-10T21:30:54.337

我认为最大的创新领域可能是数据复制——可用性和可靠性。大多数其他领域都更具增量性。通过指定十年，您省略了 ORDBMS 的东西 - 可扩展性；出现在 1997 年。

# c++ - 在 MFC 应用程序中，将文件从一个目录复制到另一个目录的最简单方法是什么？

> ID：191980
> 
> 赞同：10
> 
> 时间：2008-10-10T15:50:00.767
> 
> 标签：c++, windows, mfc, file

我应该创建两个`CFile`对象并将一个对象逐个字符复制到另一个对象中吗？或者图书馆里有什么可以为我做这件事的吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-10T15:52:21.057

我只会使用[`CopyFile`](https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-copyfile)Win32 API 函数，但[`CFile::Open`](https://docs.microsoft.com/en-us/cpp/mfc/reference/cfile-class?view=msvc-160#open)文档中的示例代码显示了如何使用`CFile`（几乎使用您建议的方法）复制文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T05:07:11.013

这取决于你想做什么。复制文件有多种方法：

*   `CopyFile()`
*   `CopyFileEx()`
*   `SHFileOperation()`
*   `IFileOperation``SHFileOperation()`（在 Vista 中替换）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-13T16:10:45.350

虽然我很欣赏前面的答案，但我发现这`FileOperations`是一个很好的包装器，它模仿了在 Windows 资源管理器中执行复制操作的方式，其中还包括复制、移动和删除文件以及重命名目录：

[http://www.ucancode.net/Visual_C_Source_Code/Copy-Move-Delete-files-rename-directories-SHFileOperation-CFileFind-FindFirstFile-FindNextFile-mfc-example.htm](http://www.ucancode.net/Visual_C_Source_Code/Copy-Move-Delete-files-rename-directories-SHFileOperation-CFileFind-FindFirstFile-FindNextFile-mfc-example.htm)

```
#include "stdafx.h"
#include "FileOperations.h"
//
// this code copy 'c:\source' directory and 
// all it's subdirectories and files
// to the 'c:\dest' directory. 
//
CFileOperation fo;      // create object
fo.SetOverwriteMode(false); // reset OverwriteMode flag (optional)
if (!fo.Copy("c:\\source", "c:\\dest")) // do Copy
{
    fo.ShowError(); // if copy fails show error message
}
//
// this code delete 'c:\source' directory and 
// all it's subdirectories and files.
//
fo.Setucancode.netIfReadOnly();   // set ucancode.netIfReadonly flag (optional)
if (!fo.Delete("c:\\source")) // do Copy
{
    fo.ShowError(); // if copy fails show error message
} 
```

这是完整性的源代码：

```
#include "resource.h"

#define PATH_ERROR          -1
#define PATH_NOT_FOUND      0
#define PATH_IS_FILE        1
#define PATH_IS_FOLDER      2

class CFExeption
{
public:
    CFExeption(DWORD dwErrCode);
    CFExeption(CString sErrText);
    CString GetErrorText() {return m_sError;}
    DWORD GetErrorCode() {return m_dwError;}

private:
    CString m_sError;
    DWORD m_dwError;
};

//*****************************************************************************************************

class CFileOperation
{
public:
    CFileOperation(); // constructor
    bool Delete(CString sPathName); // delete file or folder
    bool Copy(CString sSource, CString sDest); // copy file or folder
    bool Replace(CString sSource, CString sDest); // move file or folder
    bool Rename(CString sSource, CString sDest); // rename file or folder
    CString GetErrorString() {return m_sError;} // return error description
    DWORD GetErrorCode() {return m_dwError;} // return error code
    void ShowError() // show error message
        {MessageBox(NULL, m_sError, _T("Error"), MB_OK | MB_ICONERROR);}
    void SetAskIfReadOnly(bool bAsk = true) // sets behavior with readonly files(folders)
        {m_bAskIfReadOnly = bAsk;}
    bool IsAskIfReadOnly() // return current behavior with readonly files(folders)
        {return m_bAskIfReadOnly;}
    bool CanDelete(CString sPathName); // check attributes
    void SetOverwriteMode(bool bOverwrite = false) // sets overwrite mode on/off
        {m_bOverwriteMode = bOverwrite;}
    bool IsOverwriteMode() {return m_bOverwriteMode;} // return current overwrite mode
    int CheckPath(CString sPath);
    bool IsAborted() {return m_bAborted;}

protected:
    void DoDelete(CString sPathName);
    void DoCopy(CString sSource, CString sDest, bool bDelteAfterCopy = false);
    void DoFileCopy(CString sSourceFile, CString sDestFile, bool bDelteAfterCopy = false);
    void DoFolderCopy(CString sSourceFolder, CString sDestFolder, bool bDelteAfterCopy = false);
    void DoRename(CString sSource, CString sDest);
    bool IsFileExist(CString sPathName);
    void PreparePath(CString &sPath);
    void Initialize();
    void CheckSelfRecursion(CString sSource, CString sDest);
    bool CheckSelfCopy(CString sSource, CString sDest);
    CString ChangeFileName(CString sFileName);
    CString ParseFolderName(CString sPathName);

private:
    CString m_sError;
    DWORD m_dwError;
    bool m_bAskIfReadOnly;
    bool m_bOverwriteMode;
    bool m_bAborted;
    int m_iRecursionLimit;
};

//***************************************************************************************************** 
```

C++ 文件：

```
#include "stdafx.h" 
#include "resource.h" 
#include "FileOperations.h" 

//************************************************************************************************************
CFExeption::CFExeption(DWORD dwErrCode)
{
    LPVOID lpMsgBuf;
    FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,
                  NULL, dwErrCode, MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), (LPTSTR)&lpMsgBuf, 0, NULL);
    m_sError = (LPTSTR)lpMsgBuf;
    LocalFree(lpMsgBuf);
    m_dwError = dwErrCode;
}

CFExeption::CFExeption(CString sErrText)
{
    m_sError = sErrText;
    m_dwError = 0;
}

//************************************************************************************************************

CFileOperation::CFileOperation()
{
    Initialize();
}

void CFileOperation::Initialize()
{
    m_sError = _T("No error");
    m_dwError = 0;
    m_bAskIfReadOnly = true;
    m_bOverwriteMode = false;
    m_bAborted = false;
    m_iRecursionLimit = -1;
}

void CFileOperation::DoDelete(CString sPathName)
{
    CFileFind ff;
    CString sPath = sPathName;

    if (CheckPath(sPath) == PATH_IS_FILE)
    {
        if (!CanDelete(sPath)) 
        {
            m_bAborted = true;
            return;
        }
        if (!DeleteFile(sPath)) throw new CFExeption(GetLastError());
        return;
    }

    PreparePath(sPath);
    sPath += "*.*";

    BOOL bRes = ff.FindFile(sPath);
    while(bRes)
    {
        bRes = ff.FindNextFile();
        if (ff.IsDots()) continue;
        if (ff.IsDirectory())
        {
            sPath = ff.GetFilePath();
            DoDelete(sPath);
        }
        else DoDelete(ff.GetFilePath());
    }
    ff.Close();
    if (!RemoveDirectory(sPathName) && !m_bAborted) throw new CFExeption(GetLastError());
}

void CFileOperation::DoFolderCopy(CString sSourceFolder, CString sDestFolder, bool bDelteAfterCopy)
{
    CFileFind ff;
    CString sPathSource = sSourceFolder;
    BOOL bRes = ff.FindFile(sPathSource);
    while (bRes)
    {
        bRes = ff.FindNextFile();
        if (ff.IsDots()) continue;
        if (ff.IsDirectory()) // source is a folder
        {
            if (m_iRecursionLimit == 0) continue;
            sPathSource = ff.GetFilePath() + CString("\\") + CString("*.*");
            CString sPathDest = sDestFolder + ff.GetFileName() + CString("\\");
            if (CheckPath(sPathDest) == PATH_NOT_FOUND) 
            {
                if (!CreateDirectory(sPathDest, NULL))
                {
                    ff.Close();
                    throw new CFExeption(GetLastError());
                }
            }
            if (m_iRecursionLimit > 0) m_iRecursionLimit --;
            DoFolderCopy(sPathSource, sPathDest, bDelteAfterCopy);
        }
        else // source is a file
        {
            CString sNewFileName = sDestFolder + ff.GetFileName();
            DoFileCopy(ff.GetFilePath(), sNewFileName, bDelteAfterCopy);
        }
    }
    ff.Close();
}

bool CFileOperation::Delete(CString sPathName)
{
    try
    {
        DoDelete(sPathName);
    }
    catch(CFExeption* e)
    {
        m_sError = e->GetErrorText();
        m_dwError = e->GetErrorCode();
        delete e;
        if (m_dwError == 0) return true;
        return false;
    }
    return true;
}

bool CFileOperation::Rename(CString sSource, CString sDest)
{
    try
    {
        DoRename(sSource, sDest);
    }
    catch(CFExeption* e)
    {
        m_sError = e->GetErrorText();
        m_dwError = e->GetErrorCode();
        delete e;
        return false;
    }
    return true;
}

void CFileOperation::DoRename(CString sSource, CString sDest)
{
    if (!MoveFile(sSource, sDest)) throw new CFExeption(GetLastError());
}

void CFileOperation::DoCopy(CString sSource, CString sDest, bool bDelteAfterCopy)
{
    CheckSelfRecursion(sSource, sDest);
    // source not found
    if (CheckPath(sSource) == PATH_NOT_FOUND)
    {
        CString sError = sSource + CString(" not found");
        throw new CFExeption(sError);
    }
    // dest not found
    if (CheckPath(sDest) == PATH_NOT_FOUND)
    {
        CString sError = sDest + CString(" not found");
        throw new CFExeption(sError);
    }
    // folder to file
    if (CheckPath(sSource) == PATH_IS_FOLDER && CheckPath(sDest) == PATH_IS_FILE) 
    {
        throw new CFExeption("Wrong operation");
    }
    // folder to folder
    if (CheckPath(sSource) == PATH_IS_FOLDER && CheckPath(sDest) == PATH_IS_FOLDER) 
    {
        CFileFind ff;
        CString sError = sSource + CString(" not found");
        PreparePath(sSource);
        PreparePath(sDest);
        sSource += "*.*";
        if (!ff.FindFile(sSource)) 
        {
            ff.Close();
            throw new CFExeption(sError);
        }
        if (!ff.FindNextFile()) 
        {
            ff.Close();
            throw new CFExeption(sError);
        }
        CString sFolderName = ParseFolderName(sSource);
        if (!sFolderName.IsEmpty()) // the source is not drive
        {
            sDest += sFolderName;
            PreparePath(sDest);
            if (!CreateDirectory(sDest, NULL))
            {
                DWORD dwErr = GetLastError();
                if (dwErr != 183)
                {
                    ff.Close();
                    throw new CFExeption(dwErr);
                }
            }
        }
        ff.Close();
        DoFolderCopy(sSource, sDest, bDelteAfterCopy);
    }
    // file to file
    if (CheckPath(sSource) == PATH_IS_FILE && CheckPath(sDest) == PATH_IS_FILE) 
    {
        DoFileCopy(sSource, sDest);
    }
    // file to folder
    if (CheckPath(sSource) == PATH_IS_FILE && CheckPath(sDest) == PATH_IS_FOLDER) 
    {
        PreparePath(sDest);
        char drive[MAX_PATH], dir[MAX_PATH], name[MAX_PATH], ext[MAX_PATH];
        _splitpath(sSource, drive, dir, name, ext);
        sDest = sDest + CString(name) + CString(ext);
        DoFileCopy(sSource, sDest);
    }
}

void CFileOperation::DoFileCopy(CString sSourceFile, CString sDestFile, bool bDelteAfterCopy)
{
    BOOL bOvrwriteFails = FALSE;
    if (!m_bOverwriteMode)
    {
        while (IsFileExist(sDestFile)) 
        {
            sDestFile = ChangeFileName(sDestFile);
        }
        bOvrwriteFails = TRUE;
    }
    if (!CopyFile(sSourceFile, sDestFile, bOvrwriteFails)) throw new CFExeption(GetLastError());
    if (bDelteAfterCopy)
    {
        DoDelete(sSourceFile);
    }
}

bool CFileOperation::Copy(CString sSource, CString sDest)
{
    if (CheckSelfCopy(sSource, sDest)) return true;
    bool bRes;
    try
    {
        DoCopy(sSource, sDest);
        bRes = true;
    }
    catch(CFExeption* e)
    {
        m_sError = e->GetErrorText();
        m_dwError = e->GetErrorCode();
        delete e;
        if (m_dwError == 0) bRes = true;
        bRes = false;
    }
    m_iRecursionLimit = -1;
    return bRes;
}

bool CFileOperation::Replace(CString sSource, CString sDest)
{
    if (CheckSelfCopy(sSource, sDest)) return true;
    bool bRes;
    try
    {
        bool b = m_bAskIfReadOnly;
        m_bAskIfReadOnly = false;
        DoCopy(sSource, sDest, true);
        DoDelete(sSource);
        m_bAskIfReadOnly = b;
        bRes = true;
    }
    catch(CFExeption* e)
    {
        m_sError = e->GetErrorText();
        m_dwError = e->GetErrorCode();
        delete e;
        if (m_dwError == 0) bRes = true;
        bRes = false;
    }
    m_iRecursionLimit = -1;
    return bRes;
}

CString CFileOperation::ChangeFileName(CString sFileName)
{
    CString sName, sNewName, sResult;
    char drive[MAX_PATH];
    char dir  [MAX_PATH];
    char name [MAX_PATH];
    char ext  [MAX_PATH];
    _splitpath((LPCTSTR)sFileName, drive, dir, name, ext);
    sName = name;

    int pos = sName.Find("Copy ");
    if (pos == -1)
    {
        sNewName = CString("Copy of ") + sName + CString(ext);
    }
    else
    {
        int pos1 = sName.Find('(');
        if (pos1 == -1)
        {
            sNewName = sName;
            sNewName.Delete(0, 8);
            sNewName = CString("Copy (1) of ") + sNewName + CString(ext);
        }
        else
        {
            CString sCount;
            int pos2 = sName.Find(')');
            if (pos2 == -1)
            {
                sNewName = CString("Copy of ") + sNewName + CString(ext);
            }
            else
            {
                sCount = sName.Mid(pos1 + 1, pos2 - pos1 - 1);
                sName.Delete(0, pos2 + 5);
                int iCount = atoi((LPCTSTR)sCount);
                iCount ++;
                sNewName.Format("%s%d%s%s%s", "Copy (", iCount, ") of ", (LPCTSTR)sName, ext);
            }
        }
    }

    sResult = CString(drive) + CString(dir) + sNewName;

    return sResult;
}

bool CFileOperation::IsFileExist(CString sPathName)
{
    HANDLE hFile;
    hFile = CreateFile(sPathName, GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, NULL, NULL);
    if (hFile == INVALID_HANDLE_VALUE) return false;
    CloseHandle(hFile);
    return true;
}

int CFileOperation::CheckPath(CString sPath)
{
    DWORD dwAttr = GetFileAttributes(sPath);
    if (dwAttr == 0xffffffff) 
    {
        if (GetLastError() == ERROR_FILE_NOT_FOUND || GetLastError() == ERROR_PATH_NOT_FOUND) 
            return PATH_NOT_FOUND;
        return PATH_ERROR;
    }
    if (dwAttr & FILE_ATTRIBUTE_DIRECTORY) return PATH_IS_FOLDER;
    return PATH_IS_FILE;
}

void CFileOperation::PreparePath(CString &sPath)
{
    if(sPath.Right(1) != "\\") sPath += "\\";
}

bool CFileOperation::CanDelete(CString sPathName)
{
    DWORD dwAttr = GetFileAttributes(sPathName);
    if (dwAttr == -1) return false;
    if (dwAttr & FILE_ATTRIBUTE_READONLY)
    {
        if (m_bAskIfReadOnly)
        {
            CString sTmp = sPathName;
            int pos = sTmp.ReverseFind('\\');
            if (pos != -1) sTmp.Delete(0, pos + 1);
            CString sText = sTmp + CString(" is read olny. Do you want delete it?");
            int iRes = MessageBox(NULL, sText, _T("Warning"), MB_YESNOCANCEL | MB_ICONQUESTION);
            switch (iRes)
            {
                case IDYES:
                {
                    if (!SetFileAttributes(sPathName, FILE_ATTRIBUTE_NORMAL)) return false;
                    return true;
                }
                case IDNO:
                {
                    return false;
                }
                case IDCANCEL:
                {
                    m_bAborted = true;
                    throw new CFExeption(0);
                    return false;
                }
            }
        }
        else
        {
            if (!SetFileAttributes(sPathName, FILE_ATTRIBUTE_NORMAL)) return false;
            return true;
        }
    }
    return true;
}

CString CFileOperation::ParseFolderName(CString sPathName)
{
    CString sFolderName = sPathName;
    int pos = sFolderName.ReverseFind('\\');
    if (pos != -1) sFolderName.Delete(pos, sFolderName.GetLength() - pos);
    pos = sFolderName.ReverseFind('\\');
    if (pos != -1) sFolderName = sFolderName.Right(sFolderName.GetLength() - pos - 1);
    else sFolderName.Empty();
    return sFolderName;
}

void CFileOperation::CheckSelfRecursion(CString sSource, CString sDest)
{
    if (sDest.Find(sSource) != -1)
    {
        int i = 0, count1 = 0, count2 = 0;
        for(i = 0; i < sSource.GetLength(); i ++)   if (sSource[i] == '\\') count1 ++;
        for(i = 0; i < sDest.GetLength(); i ++) if (sDest[i] == '\\') count2 ++;
        if (count2 >= count1) m_iRecursionLimit = count2 - count1;
    }
}

bool CFileOperation::CheckSelfCopy(CString sSource, CString sDest)
{
    bool bRes = false;
    if (CheckPath(sSource) == PATH_IS_FOLDER)
    {
        CString sTmp = sSource;
        int pos = sTmp.ReverseFind('\\');
        if (pos != -1)
        {
            sTmp.Delete(pos, sTmp.GetLength() - pos);
            if (sTmp.CompareNoCase(sDest) == 0) bRes = true;
        }
    }
    return bRes;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-14T13:43:20.710

代码中的 Copy 选项要求首先存在 dest 文件或文件夹，否则 if (CheckPath(sDest) == PATH_NOT_FOUND) 将始终导致错误。

# winforms - Winforms 导航栏控件 - 类似资源管理器地址栏

> ID：191982
> 
> 赞同：2
> 
> 时间：2008-10-10T15:50:17.147
> 
> 标签：winforms, controls, autocomplete

谁能推荐一个 .NET winforms 控件，它提供与 Windows 资源管理器中的地址栏类似的功能，自动完成文件路径？

我对 Vista 风格的面包屑不太在意——对简单的 XP 风格的纯文本框外观非常满意，但我希望它能够提供基于文件系统的自动完成建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T15:51:45.613

内置的 ComboBox 有一个 AutoCompleteSource 属性，可以设置为 FileSystem。

# linux - SD卡写入性能

> ID：191984
> 
> 赞同：5
> 
> 时间：2008-10-10T15:51:10.047
> 
> 标签：linux, real-time, ext3, sd-card, fsync

我正在编写一个小应用程序，它以恒定速率在 SD 卡上写入 jpeg 图像。我选择了 EXT3 文件系统，但使用 EXT2 文件系统观察到了相同的行为。

我的写作循环如下所示：

```
get_image()
fwrite()
fsync() 
```

或者像这样：

```
get_image()
fopen() 
fwrite()
fsync()
fclose() 
```

我还显示了一些计时统计信息，我可以看到我的程序有时被阻塞了几秒钟。平均速率还是不错的，因为如果我将传入的图像保持在一个 fifo 中，那么我会在这样的停顿后的短时间内写入很多图像。你知道这是操作系统的问题还是与SD卡本身有关？我怎样才能更接近实时？我不需要强大的实时性，但是停滞几秒钟是不可接受的。

一些精度：是的，有必要在每个文件之后进行 fsync，因为我希望图像在磁盘上，而不是在某些用户或内核缓冲区中。没有 fsyncing，我的直通输出要好得多，但仍然是不可接受的停顿。我认为这不是缓冲区问题，因为第一次停顿发生在写入 50 MB 之后。根据手册页， fsync 正是为了确保没有缓冲数据。

关于平均写入速率的精度：我正在以我正在使用的卡可持续的速率写入。如果我在等待 fsync 完成时堆积传入的图像，那么在这个停顿之后，写入传输速率会增加，我会很快回到平均速率。平均传输速率约为 1.4 MBytes / s。

systeme 是运行 ubuntu 8.04 和 stock kee (2.6.24.19) 的现代笔记本电脑

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-01-20T02:09:38.760

尝试打开文件`O_DIRECT`并在应用程序级别进行缓存。

当我们在 STB Box 中实现 PVR（个人视频录制）功能时，我们遇到了类似的问题。这个`O_DIRECT`技巧最终满足了我们的需求。(*)

没有`O_DIRECT`. 的数据`write()`将首先缓存在内核缓冲区中，然后在您调用`fsync`或内核缓存缓冲区已满时刷新到媒体。（**）。

使用`O_DIRECT`.Th 内核将直接对作为参数传递给系统调用的用户空间缓冲区指向的物理内存进行 DMA `write`。因此在用户空间内存和内核缓存之间的副本中不会花费 CPU 和内存带宽，并且不会在内核中花费 CPU 时间来管理缓存（如缓存查找、每页锁定等）。 （从[这里](http://www.ukuug.org/events/linux2001/papers/html/AArcangeli-o_direct.html)复制）

不确定它是否也能解决您的问题，但您可能想尝试一下。

*尽管 Linus[批评](http://kerneltrap.org/node/7563)了`O_DIRECT`，但它确实解决了我们的问题。

** 假设您没有使用`O_DSYNC`or打开文件`O_SYNC`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T16:18:14.623

是否有必要`fsync()`在每个文件之后？让操作系统决定何时将所有排队的图像写入 SD 卡可能会有更好的运气（分摊在许多图像上操作 SD 卡文件系统的启动成本，而不是为每个图像产生它）。

您能否提供有关您的平台的更多详细信息？缓慢的 I/O 时间可能与系统上的其他进程、缓慢的 I/O 控制器等有关。

您也可以考虑使用更适合闪存工作方式的文件系统。FAT32 比 FAT32 更常见`extN`，但专门为 SD 构建的文件系统也可能需要。 [JFFS](http://en.wikipedia.org/wiki/JFFS)就是一个很好的例子。使用专为闪存设计的文件系统（而不是旋转磁介质），您可能会获得更好的性能，并且还可以获得更好的磨损均衡（以及设备寿命/可靠性）属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T20:34:05.603

AFAIK 一些闪存盘的写入性能非常差（尤其是廉价品牌）。因此，如果您测量应用程序的写入速度（包括 fsync 所需的时间），您会得到什么？它可能很容易达到每秒几兆字节的数量级 - 只是因为硬件没有做得更好。

此外，如果您写入许多小块而不是一个大块，显然写入可能会慢得多（闪存盘每秒可能只能完成大约 10 次写入，在糟糕的情况下）。这可能是内核缓冲区可以缓解的问题，因此频繁使用 fsync 可能会减慢写入速度……

顺便提一句。你测量过 FAT32 的写入性能吗？我猜它差不多，但如果不是，也许还有一些优化可用？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T16:17:23.533

我在这方面不是很了解，但是您描述的症状听起来很像填充缓冲区。您可能正在文件写入器或与 SD 卡本身通信的 I/O 设备中填充缓冲区。然后，您必须等到它实际将数据写入卡（从而清空缓冲区）才能写入更多数据。SD 卡的写入速度不是特别快。如果你能找到一种方法来检查在这些暂停期间数据是否真的被写入卡，那将验证我的理论。一些读卡器有一个 LED 灯，当数据被访问时会闪烁——这可能是一个很好的指标。

只是一种预感……加点盐吧:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-12T02:16:55.643

可能这会有所帮助 -[基准文件系统](http://linuxgazette.net/102/piszcz.html)：

> ...我很惊讶 ext3 的整体速度有多慢，因为许多发行版都使用这个文件系统作为他们的默认文件系统...

和[“ext3 fsync 批处理”](http://lkml.indiana.edu/hypermail/linux/kernel/0808.2/1195.html)：

> ...此补丁测量将事务提交到磁盘所需的时间，并根据底层磁盘的速度休眠。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-13T22:26:44.373

对于阅读本文并使用 2.6.28 以上内核的任何人，建议使用 ext4 而不是 ext3，这是一个可以调整以获得更好性能的文件系统。在不记录数据的 data=writeback 模式下获得最佳性能。[从https://www.kernel.org/doc/Documentation/filesystems/ext4.txt](https://www.kernel.org/doc/Documentation/filesystems/ext4.txt)阅读**数据模式**部分。

如果您已经创建了一个分区，例如`/dev/sdb1`，那么这些步骤可用于使用 ext4 对其进行格式化而无需记录日志：

```
mkfs.ext4 /dev/sdb1 -L jp  # Creates the ext4 filesystem
tune2fs -o journal_data_writeback /dev/sdb1 # Set to writeback mode
tune2fs -O ^has_journal /dev/sdb1 # Disable journaling
sudo e2fsck -f /dev/sdb1 # Filesystem check is required 
```

然后，您可以使用相应的标志挂载此分区（或设置一个条目`/etc/fstab`，如果您知道自己在做什么）：

```
mount -t ext4 -O noatime,nodirame,data=writeback /dev/mmcblk0p1 /mnt/sd 
```

从 ext3 迁移到优化的 ext4 文件系统应该是一个巨大的区别。而且，当然，如果您的 SD 卡更快，那应该会有所帮助（即 10 级）。

另请参阅[https://developer.ridgerun.com/wiki/index.php/High_performance_SD_card_tuning_using_the_EXT4_file_system](https://developer.ridgerun.com/wiki/index.php/High_performance_SD_card_tuning_using_the_EXT4_file_system "使用 EXT4 文件系统的高性能 SD 卡调整")

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-12T20:30:41.330

也可以考虑 SD 卡，是 NOR 还是 NAND？此页面显示了 SD 卡之间的数量级（2M/s 与 20M/s）。
[http://www.robgalbraith.com/bins/camera_multi_page.asp?cid=6007-9597](http://www.robgalbraith.com/bins/camera_multi_page.asp?cid=6007-9597)
我认为 ZFS 针对闪存进行了优化。

# visual-studio-2005 - Visual Studio 2005 快速文件搜索

> ID：191995
> 
> 赞同：0
> 
> 时间：2008-10-10T15:52:31.930
> 
> 标签：visual-studio-2005

在 Eclispe 中，您可以执行 Ctrl+Shift+R 和一个窗口弹出窗口，您可以在其中写入文件的名称（或只是文件的开头），然后按 Enter 直接转到文件。

Visual Studio 2005 中的等价物是什么？（Ctrl+Shift+F 不是我想要的）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T15:59:54.833

来自[Top 11 VS 2005 IDE 提示和技巧：](http://www.chinhdo.com/20070920/top-11-visual-studio-2005-ide-tips-and-tricks-to-make-you-a-more-productive-developer/)

> 这是标准工具栏上的查找下拉菜单，而不是查找对话框。使用快捷键 CTRL+D 在正常模式下激活“查找”下拉菜单。使用 CTRL+/ 在命令模式下激活查找下拉菜单
> 
> 要快速转到文件，请键入 CTRL+D，>open <文件名开头>。Intellisense 在此处的工作方式与在命令行窗口中一样。可以使用“of”（“open file”的缩写）代替 open。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-10T16:03:41.923

我不确定是否有内置命令，但有一些插件，如[VS File Finder](http://weblogs.asp.net/rweigelt/archive/2006/08/07/465056.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T15:59:22.820

点击`Ctrl`+ `D`（查找组合 - 工具栏中的那个），写下“>of”和文件名。我正在使用 ReSharper，所以我不确定在您的情况下该快捷方式是否正是这个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T15:57:39.003

我不知道是否有等价，但你可以用宏编辑器来做。它非常强大，你可以用它做几乎任何你想做的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T16:07:37.517

在普通的 VS.NET 2005 中，转到命令窗口 (Ctrl-D)，键入“openfile”（或只是“of”）和文件名。

如果你有 Resharper（你应该有），你可以输入 Ctrl-N 并输入类名，或者 Ctrl-Shift-N 并输入文件名。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T19:49:27.320

Gulzar 提出了[VS File Finder](http://www.zero-one-zero.com/vs/)，这是这里最好的解决方案。

但我安装了[SonicFilFinder](http://jens-schaller.de/sonictools/sonicfilefinder/overview/index.htm)，因为 GUI 更好。它就像一个魅力，你可以使用你想要的热键。真的很快，不需要鼠标。免费。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-28T18:53:39.850

在 VS 2010 中，您可以使用 Edit > Navigate To... (Ctrl+comma)。

临：

*   还搜索对象/方法

缺点：

*   不支持 * 通配符
*   窗口不可停靠

请参阅：[MSDN 博客](http://blogs.msdn.com/b/vbteam/archive/2008/12/19/walkthrough-quick-search-for-files-and-symbols-in-visual-studio-2010-lisa-feigenbaum.aspx)

# linux - 您会为 linux 推荐哪种甘特图/项目管理工具？

> ID：191997
> 
> 赞同：28
> 
> 时间：2008-10-10T15:52:59.980
> 
> 标签：linux, project-management, charts, gantt-chart

我需要一个可以在 Linux 中运行并具有甘特图的项目管理工具。

1.  它不一定是免费的，只要不贵。
2.  我不在乎它如何存储我给它的信息，只要我可以访问它。
3.  我必须能够**打印**甘特图。
4.  必须在 Linux 中工作。

有了这些要求，你能推荐什么？

[TheObserver在此处](https://stackoverflow.com/questions/151787/recommended-chartingreportingdashboard-tool)询问了此问题的特定 Windows 版本。

感谢大家的帮助。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-10T16:43:07.443

[Planner](http://live.gnome.org/Planner)和[OpenSched](http://opensched.sourceforge.net/)，按此顺序。在线也有一些不错的在线甘特图（这是正确的拼写）图表工具，通常集成在项目管理或错误跟踪 Web 应用程序或软件包中。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-11T00:27:41.500

我使用[TaskJuggler](http://www.taskjuggler.org/) - 它比我尝试过的其他 OSS 软件更强大，但它非常复杂。这是我发现的唯一一款可以满足我需求的软件，但我仍然认为它是“最好的”。我也不介意付钱，如果我能确定软件会做我需要的一切。

规划器的最大缺陷似乎在于资源平衡/分配，但我承认我没有深入研究它。规划师将是我的第二选择。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-14T08:55:42.673

[Ganttproject](http://ganttproject.biz/)是用 java 编写的，适用于每个平台。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-10T15:56:02.437

您可以尝试[http://live.gnome.org/Planner](http://live.gnome.org/Planner)也许它满足您的需求。:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-10T15:54:23.470

的答案[是否有任何用于绘制甘特图的 LaTeX 包？](https://stackoverflow.com/questions/171809/is-there-any-latex-package-for-drawing-gantt-diagrams). 可能是可行的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-11T23:34:22.373

您还可以尝试一些基于 Web 的项目管理工具。这些天来，它们对桌面替代品的表现相当不错。我可以推荐[dotProject](http://dotproject.net/)。这是一个不错的，易于使用的工具，它有可打印的甘特图。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-12T09:36:36.993

还要检查[Redmine](http://www.redmine.org/)。

# java - 在 Eclipse 中附加源问题

> ID：191998
> 
> 赞同：5
> 
> 时间：2008-10-10T15:53:53.643
> 
> 标签：java, eclipse, eclipse-3.4, ganymede

在 Eclipse (Ganymede) 中，我正在调试一些使用 Apache Commons HttpClient 的代码，并希望进入 HttpClient 代码。我已经下载了源代码并尝试以正常方式附加它（CTRL-单击方法名称并使用附加源按钮）。我尝试将两者都附加为外部文件和外部文件夹，但均未成功。我之前已经附加了源代码，没有任何问题，目前可以成功进入 Hibernate 源代码。

我什至尝试直接编辑 .classpath 文件以手动添加源路径。仍然没有运气。刷新项目、进行干净的构建、关闭并重新打开 Eclipse 并不能解决问题。令人沮丧的是，Eclipse 没有提供错误消息。它只是不附加源。

以下是 .claspath 中的条目：

```
<!-- Hibernate. Works -->
<classpathentry kind="lib" path="/myEAP/EarContent/APP-INF/lib/hibernate.jar" sourcepath="D:/Data/Download/hibernate-3.2.2.ga/hibernate-3.2/src"/>

<!-- Commons HttpClient. Will not attach -->
<classpathentry kind="lib" path="/myEAP/EarContent/APP-INF/lib/commons-httpclient.jar" sourcepath="D:/Data/Download/commons-httpclient-3.1/src/java"/> 
```

我尝试将路径更改为 D:/Data/Download/commons-httpclient-3.1/src ，但这也不起作用。

目录结构为：

```
D
  Data
    Download
      commons-httpclient-3.1
        src
          java
            org
              apache
                commons
                  httpclient
                    AutoCloseInputStream.java
                    ... (and so forth) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T23:47:10.273

尝试将其直接指向包含顶级包的目录，“D:/Data/Download/commons-httpclient-3.1/src/java”。对我有用的是创建一个新的 src zip 文件，其中包含“org”文件夹及其下的所有内容。

这是我的 .classpath 条目，（对我有用）以防万一：

```
<classpathentry kind="lib" path="/blib/java/commons-httpclient-3.1/commons-httpclient-3.1.jar" sourcepath="/blib/java/commons-httpclient-3.1/commons-httpclient-3.1-src.zip"/> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-07-20T11:47:52.127

我发现有时，您指向您认为是正确的目录，然后它仍然指出它无法在附加的源代码中找到该文件等等。

这些时候，我意识到最后一个路径元素是“src”。只需删除此路径元素（因此确实指向“org”或“com”文件夹所在的实际路径上方的一层）就可以神奇地使其工作。

不知何故，Eclipse 似乎暗示了这个“src”路径元素（如果存在），如果你将它包含在源路径中，Eclipse 就会窒息。或类似的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T16:04:59.783

尝试附加 src.zip 而不是解压缩的 src？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-10T16:53:47.470

尝试将其添加到启动配置的源路径中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T22:42:17.627

附加源并不是进入类路径上的库所需要的全部；该库还必须使用调试符号进行编译。这通常不是问题，因为大多数 Java 库都是以这种方式编译和分发的，但正如您所发现的，其中一些不是。

有趣的是，即使没有附加源代码，您实际上也可以进入外部库，只是看不到逐行源代码（所有调试信息仍然有效）。

您可以通过编译 Commons HttpClient 的自定义版本（不太难）来“解决”这个问题，或者只是跳过整个“步入库”的想法。作为一般的开发实践，进入第三方库很少会产生有用的信息。在过去的十年里，我可能做过一次或两次，但这两次都没有真正让我更接近解决手头的困境。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-06T11:56:44.090

我认为，源存档路径中的空间（或本地化）符号问题。尝试用简单的路径将其移动到另一个地方。**************