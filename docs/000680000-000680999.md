# StackOverflow 问答 000680000-000680999

# java - 找出以二进制表示正整数所需的位数？

> ID：680002
> 
> 赞同：33
> 
> 时间：2009-03-25T02:20:49.347
> 
> 标签：java, bit-manipulation, bits

这可能是非常基本的，但是为了节省我一个小时左右的悲伤，谁能告诉我如何计算出在 Java 中表示给定正整数所需的位数？

例如，我得到一个小数点 11，(1011)。我需要得到答案，4。

我想如果我能弄清楚如何将除最高有效位之外的所有位设置为 0，然后 >>> 它，我就会得到答案。但是……我不能。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-25T02:40:42.017

嗯，答案很简单。如果你有一个 int 值：

```
int log2(int value) {
    return Integer.SIZE-Integer.numberOfLeadingZeros(value);
} 
```

龙也一样……

[编辑] 如果剃须毫秒是这里的问题， Integer.numberOfLeadingZeros(int) 相当有效，但仍然执行 15 次操作...扩展合理的内存量（300 字节，静态），您可以将其减少到 1 到 8操作，具体取决于整数的范围。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-03-25T02:26:43.907

好吧，你可以计算在你只剩下零之前你向右移动了多少次：

```
int value = 11;
int count = 0;
while (value > 0) {
    count++;
    value = value >> 1;
} 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-03-25T02:31:29.697

我的 Java 有点生疏，但与语言无关的答案（如果有可用的“log2”函数和“floor”函数）将是：

```
numberOfBits = floor(log2(decimalNumber))+1 
```

假设“decimalNumber”大于0。如果为0，则只需要1位。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-03-25T02:33:07.807

Integer.toBinaryString(number).length();

好悲伤...为什么反对票？

```
public class Main
{
    public static void main(final String[] argv)
    {
        System.out.println(Integer.toBinaryString(0).length());
        System.out.println(Integer.toBinaryString(1).length());
        System.out.println(Integer.toBinaryString(2).length());
        System.out.println(Integer.toBinaryString(3).length());
        System.out.println(Integer.toBinaryString(4).length());
        System.out.println(Integer.toBinaryString(5).length());
        System.out.println(Integer.toBinaryString(6).length());
        System.out.println(Integer.toBinaryString(7).length());
        System.out.println(Integer.toBinaryString(8).length());
        System.out.println(Integer.toBinaryString(9).length());
    }
} 
```

输出：

```
1
1
2
2
3
3
3
3
4
4 
```

以下是对各种解决方案速度的简单测试：

```
public class Tester 
{
    public static void main(final String[] argv) 
    {
        final int size;
        final long totalA;
        final long totalB;
        final long totalC;
        final long totalD;

        size = 100000000;

        totalA = test(new A(), size);
        totalB = test(new B(), size);
        totalC = test(new C(), size);
        totalD = test(new D(), size);

        System.out.println();
        System.out.println("Total D = " + totalD + " ms");
        System.out.println("Total B = " + totalB + " ms");
        System.out.println("Total C = " + totalC + " ms");
        System.out.println("Total A = " + totalA + " ms");

        System.out.println();
        System.out.println("Total B = " + (totalB / totalD) + " times slower");
        System.out.println("Total C = " + (totalC / totalD) + " times slower");
        System.out.println("Total A = " + (totalA / totalD) + " times slower");
    }

    private static long test(final Testable tester, 
                             final int      size)
    {
        final long start;
        final long end;
        final long total;

        start = System.nanoTime();
        tester.test(size);
        end   = System.nanoTime();
        total = end - start;

        return (total / 1000000);
    }

    private static interface Testable
    {
        void test(int size);
    }

    private static class A
        implements Testable
    {
        @Override
        public void test(final int size)
        {
            int value;

            value = 0;

            for(int i = 1; i < size; i++)
            {
                value += Integer.toBinaryString(i).length();
            }

            System.out.println("value = " + value);
        }    
    }

    private static class B
        implements Testable
    {
        @Override
        public void test(final int size)
        {
            int total;

            total = 0;

            for(int i = 1; i < size; i++)
            {
                int value = i;
                int count = 0;

                while (value > 0) 
                {
                    count++;
                    value >>= 1;
                }

                total += count;
            }

            System.out.println("total = " + total);
        }    
    }

    private static class C
        implements Testable
    {
        @Override
        public void test(final int size)
        {
            int total;
            final double log2;

            total = 0;
            log2  = Math.log(2);

            for(int i = 1; i < size; i++)
            {
                final double logX;
                final double temp;

                logX   = Math.log(i);
                temp   = logX / log2;                
                total += (int)Math.floor(temp) + 1;
            }

            System.out.println("total = " + total);
        }    
    }

    private static class D
        implements Testable
    {
        @Override
        public void test(final int size)
        {
            int total;

            total = 0;

            for(int i = 1; i < size; i++)
            {
                total += 32-Integer.numberOfLeadingZeros(i);
            }

            System.out.println("total = " + total);
        }    
    }
} 
```

我机器上的输出是：

```
value = -1729185023
total = -1729185023
total = -1729185023
total = -1729185023

Total D = 118 ms
Total B = 1722 ms
Total C = 4462 ms
Total A = 5704 ms

Total B = 14 times slower
Total C = 37 times slower
Total A = 48 times slower 
```

对于那些抱怨速度的人...... [https://en.wikipedia.org/wiki/Program_optimization#Quotes](https://en.wikipedia.org/wiki/Program_optimization#Quotes)。

先把程序写成可读的，然后找出慢的地方，然后让它变快。优化前后测试变化。如果更改不足以降低代码的可读性，请不要为更改而烦恼。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-03-25T02:33:23.577

取两个基于数字的日志将报告存储它所需的位数。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-25T05:44:23.120

如果你想避免循环并且你关心速度，你可以使用这样的方法：

```
int value = ...;
int count = 0;
if( value < 0 ) { value = 0; count = 32; }
if( value >= 0x7FFF ) { value >>= 16; count += 16; }
if( value >= 0x7F ) { value >>= 8; count += 8; }
if( value >= 0x7 ) { value >>= 4; count += 4; }
if( value >= 0x3 ) { value >>= 2; count += 2; }
if( value >= 0x1 ) { value >>= 1; count += 1; } 
```

Java 没有无符号整数，所以首先 if( value < 0 ) 有点可疑。负数总是设置最高有效位，因此可以说需要完整的单词来表示它们。如果您在乎，请调整该行为。

顺便说一句，要处理 64 位整数，请将 if( value < 0 ) 行替换为以下两个：

```
if( value < 0 ) { value = 0; count = 64; }
if( value >= 0x7FFFFFFF ) { value >>= 32; count += 32; } 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-25T11:21:31.607

对于非负值，可能最直接的答案是：

```
java.math.BigDecimal.valueOf(value).bitLength() 
```

（对于负数，它会给出比绝对值小一的位长度，而不是你从二进制补码符号中期望的无穷大。）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-01T02:11:59.943

为了完整起见，我想添加一些其他替代方案：

**1** `BigInteger.valueOf(i).bitLength()`

不是很快。此外，`BigInteger.bitLength()`它存在错误且不可靠（在 Java7 中已修复），因为当需要更多`Integer.MAX_VALUE`位时（需要非常高的输入数！！[例如 1 次左移`Integer.MAX_VALUE`时间，又名`2^Integer.MAX_VALUE`]），结果会溢出并且下一个数字会出现`2^(2*Integer.MAX_VALUE)-2^Integer.MAX_VALUE`负数，这个数字太高了，你的脑袋可能会爆炸。请注意，据估计宇宙包含大约 10^80 个原子；该数字是`2^4G`（`G`如在 Giga 中`1024*1024*1024`）。

**2**

```
static int neededBits(int i)
{
    assert i > 0;
    int res;
    int sh;
    res = ((i > 0xFFFF) ? 1 : 0) << 4;
    i >>= res;
    sh = ((i > 0xFF) ? 1 : 0) << 3;
    i >>= sh;
    res |= sh;
    sh = ((i > 0xF) ? 1 : 0) << 2;
    i >>= sh;
    res |= sh;
    sh = ((i > 0x3) ? 1 : 0) << 1;
    i >>= sh;
    res |= sh;
    res |= (i >> 1);
    return res + 1;
} 
```

一个非常快速的解决方案，但仍然是 ye olde 的一半`32 - Integer.numberOfLeadingZeros(i);`。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-08-22T01:56:21.530

对 2 的指数进行二进制搜索比位移（[投票最多的答案](https://stackoverflow.com/a/680012/5983976)）解决方案更快，如果数字很大（数千个十进制数字），您知道最大可用位并且您不想生成，这可能很有价值表格：

```
 int  minExpVal   = 0;
    int  maxExpVal   = 62;
    int  medExpVal   = maxExpVal >> 1;
    long medianValue = 0l;

    while (maxExpVal - minExpVal > 1) {
        medianValue = 1l << medExpVal;
        if (value > medianValue) {
            minExpVal = medExpVal;
        } else {
            maxExpVal = medExpVal;
        }
        medExpVal = (minExpVal + maxExpVal) >> 1;
    }

    return value == 1l << maxExpVal ?  maxExpVal  + 1 : maxExpVal; 
```

但是，使用前导零的解决方案仍然要快得多：

```
return Long.SIZE - Long.numberOfLeadingZeros(value); 
```

基准：

```
Leading zeros time is: 2 ms
BinarySearch time is: 95 ms
BitShift time is: 135 ms 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-10-13T11:56:14.457

这个对我有用！

```
int numberOfBitsRequired(int n)
{
    return (int)Math.floor(Math.log(n)/Math.log(2)) + 1;
} 
```

要同时包含负数，您可以添加一个额外的位并使用它来指定符号。

```
public static int numberOfBitsRequiredSigned(int n)
{
    return (int)Math.floor(Math.log(Math.abs(n))/Math.log(2)) + 2;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-02-11T18:05:59.573

如果您不想修改原始值，也可以这样做。

```
unsigned int value = 11;
unsigned int count = 0;
if(value > 0)
{
    for(int i=1;i<value;i*=2) // multiply by two => shift one to left
    {
        ++count;
    }
} 
```

注意：让编译器担心`i*=2`变成移位操作来提高性能。

对于我们中间的视觉思想家：

```
64 32 16  8  4  2  1
 0  0  0  1  0  1  1  -> binary representation of decimal number 'value' = 11 (=1+2+8) 
```

我们从`i=1`右边开始。然后我们继续乘以 2，只要`i < value`。同时，我们跟踪我们向左移动了多少位。

所以在这个例子中，一旦`i`达到 16，值就大于 11，因此我们停止。然后我们将计算 4 位：`1 *2 *2 *2 *2 = 16 (=2^4)`.

**小心签名号码。**在处理可能是正数或负数的有符号数时，您首先必须将负数乘以 -1。此外，您还必须考虑如何考虑符号位。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-25T04:12:52.590

这是在 C 中，但我怀疑您可以相当容易地转换为 Java：

[在 O(lg(N)) 操作中找到 N 位整数的对数底数 2](http://www-graphics.stanford.edu/~seander/bithacks.html#IntegerLog)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-11-20T18:13:46.247

像这样的东西怎么样：

```
public static int getNumberOfBits(int N) {
    int bits = 0;
        while(Math.pow(2, bits) <= N){
           bits++;
       }
       return bits;
} 
```

我知道您正在寻找一种不使用循环的方法，但我觉得这是非常困难的，否则因为位只是数字的 2 次方。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-03-25T09:46:36.920

```
(int) Math.ceil((Math.log(n) / Math.log(2)) 
```

当然，这只适用于正整数。

# xml - 如何将 RSS 提要视为格式化的 XML？

> ID：680003
> 
> 赞同：10
> 
> 时间：2009-03-25T02:21:15.650
> 
> 标签：xml, rss

有没有办法以格式化的 xml 格式查看 rss 提要，而不涉及弄乱我的浏览器安装或编写我自己的工具？

编辑：

最好是在 Windows 以外的操作系统上工作的方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-23T05:06:30.480

Code Beautify 的 RSS 查看器是一种以 XML 和 HTML 格式查看 RSS 提要的工具：http: [//codebeautify.org/rssviewer/](http://codebeautify.org/rssviewer/)

点击Load，输入RSS feed URL，左侧输出XML数据，右侧输出HTML数据。该工具还支持将 RSS XML 转换为 JSON。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T02:22:57.237

[XML Notepad](http://www.microsoft.com/downloads/details.aspx?familyid=72D6AA49-787D-4118-BA5F-4F30FE913628&displaylang=en)以合适的价格（免费）做得不错。

您也可以将文件拖放到 Chrome 中，然后按 CTRL+U。

您也可以在 Mac 上使用 CMD + Opt + U。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T03:40:04.523

如果您在 Firefox 中查看提要，它会像 RSS 阅读器一样阅读，但如果您查看源代码，您将获得 XML 格式的源代码。而且您可以在 MAC 上同时获得两者（如果那是您所指的操作系统）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-01T21:55:15.923

Just put Feed URL into Google Chrome, and it shows the results as XML

# c++ - 通过最多 2 个不同的位置查找字符串邻居

> ID：680011
> 
> 赞同：3
> 
> 时间：2009-03-25T02:25:34.143
> 
> 标签：c++, algorithm, string, enumeration, combinatorics

给定一个种子字符串，我想找到它的邻居最多在 2 个位置上不同。生成字符串所涉及的所有数字只有四个（即0、1、2、3）。这是我的意思的例子：

```
# In this example, 'first' column
# are neighbors with only 1 position differ.
# The rest of the columns are 2 positions differ

Seed = 000
100 110 120 130 101 102 103
200 210 220 230 201 202 203
300 310 320 330 301 302 303
010 011 012  013
020 021 022  023
030 031 032  033
001  
002  
003

Seed = 001
101 111 121 131 100 102 103   
201 211 221 231 200 202 203      
301 311 321 331 300 302 303      
011 010 012 013
021 020 022 023
031 030 032 033               
000
003
002     

Hence given a tag of length L
we will have 3*L + 9L(L-1)/2   neighbors 
```

但是为什么我的这段代码无法正确生成呢？特别是当种子字符串**不是**“000”时。

其他方法也受到欢迎，尤其是速度改进。因为我们将处理数百万个长度为 34 到 36 的种子标签。

```
#include <iostream>
#include <vector>
#include <fstream>
#include <sstream>
using namespace std;

string ConvertInt2String(int IntVal) {
    std::string S;
    std::stringstream out;
    out << IntVal;
    S = out.str();

    return S;
}

string Vec2Str (vector <int> NTg) {

    string StTg = "";
    for (unsigned i = 0; i < NTg.size(); i++) {
         StTg += ConvertInt2String(NTg[i]);
    }
    return StTg;
}

template <typename T> void  prn_vec(const std::vector < T >&arg, string sep="")
{
    for (unsigned n = 0; n < arg.size(); n++) {
        cout << arg[n] << sep;
    }
    return;
}

vector <int> neighbors(vector<int>& arg, int posNo, int baseNo) {
    // pass base position and return neighbors

    vector <int> transfVec;
    transfVec = arg;

    //modified according to strager's first post
    transfVec[posNo % arg.size()] = baseNo;

    return transfVec;

}

int main () {

    vector <int> numTag;
    numTag.push_back(0);
    numTag.push_back(0);
    numTag.push_back(1); // If "000" this code works, but not 001 or others

    // Note that in actual practice numTag can be greater than 3

     int TagLen = static_cast<int>(numTag.size());

     for ( int p=0; p< TagLen  ; p++ ) {

         // First loop is to generate tags 1 position differ
         for ( int b=1; b<=3 ; b++ ) {

             int bval = b;
             if (numTag[p] == b) {
                 bval = 0;
             }

             vector <int> nbnumTag = neighbors(numTag, p, bval);
             string SnbnumTag = Vec2Str(nbnumTag);

             cout << SnbnumTag;
             cout << "\n";

             // Second loop for tags in 2 position differ 

             for (int l=p+1; l < TagLen; l++) {

                 for (int  c=1; c<=3; c++) {

                     int cval = c;

                     if (nbnumTag[l] == c) {
                         cval = c;
                     }
                     vector <int> nbnumTag2 = neighbors(nbnumTag, l, cval);
                     string SnbnumTag2 = Vec2Str(nbnumTag2);

                     cout << "\t" << SnbnumTag2;
                     cout << "\n";

                 }
             }

         }
     }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T02:20:56.890

这会做吗？它枚举可能的字符串树，修剪所有与原始字符串>2 的差异。

```
void walk(char* s, int i, int ndiff){
  char c = s[i];
  if (ndiff > 2) return;
  if (c == '\0'){
    if (ndiff > 0) print(s);
  }
  else {
    s[i] = '0'; walk(s, i+1, (s[i]==c ? ndiff : ndiff+1);
    s[i] = '1'; walk(s, i+1, (s[i]==c ? ndiff : ndiff+1);
    s[i] = '2'; walk(s, i+1, (s[i]==c ? ndiff : ndiff+1);
    s[i] = '3'; walk(s, i+1, (s[i]==c ? ndiff : ndiff+1);
    s[i] = c;
  }
}

char seed[] = "000";
main(){
  walk(seed, 0, 0);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T03:07:59.000

这是一种适用于任意数量的字符和长度的字符串的方法：

```
string base = "000";
char values[] = {'0', '1', '2', '3' };

for (int i = 0; i < base.length(); ++i)
{
   for (int j = 0; j < countof(values); ++j)
   {
      if (base[i] != values[j])
      {
          string copy = base;
          copy[i] = values[j];
          cout << copy << endl;

          for (int k = i+1; k < base.length(); ++k)
          {
              for (int l = 0; l < countof(values); ++l)
              {
                   if (copy[k] != values[l])
                   {
                       string copy2 = copy;
                       copy[k] = values[l];
                       cout << copy2 << endl;
                   }
              }
          }
      }
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T02:59:17.650

这应该等效于在 4 个符号字母表上生成汉明距离为 2 内的所有字符串。我已经看到了它的算法，但我现在找不到它们。也许这可以作为正确方向的指针。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T03:08:49.373

您的问题 [**编辑：原始问题（参见问题的先前版本）** ] 是在您的内部循环中，您只分配了“下一个”元素。一个快速的解决方法是将写入包装在`neighbors`：

```
vector <int> neighbors(const vector<int>& arg, int posNo, int baseNo) {
    // pass base position and return neighbors

    vector <int> transfVec = arg

    transfVec[posNo % arg.size()] = baseNo;

    return transfVec;

} 
```

此修复仅在您的数组中有两个或三个项目时有效。如果你想要更多，你需要重写你的算法，因为它根本不处理长度大于三的情况。（它不应该，甚至。你使用的算法太严格了。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-28T02:05:13.420

这两个如果是：

```
 if (numTag[p] == b) {
     bval = 0;
 }

 if (nbnumTag[l] == c) {
     cval = c;
 } 
```

应该有`continue`.

* * *

这两个循环应该从 0 开始：

```
for ( int b=1; b<=3 ; b++ ) {
for (int  c=1; c<=3; c++) {

// i.e.

for ( int b=0; b<=3 ; b++ ) {
for (int  c=0; c<=3; c++) { 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-28T06:08:53.037

看起来 strager 已经确定了主要问题：循环条件。你的字母表是 0,1,2,3，所以你应该遍历整个范围。0 不是特殊情况，因为您的代码会尝试处理它。特殊情况是当字母值等于键中的值时跳过迭代，这是 strager 建议的 continue 完成的。

以下是我的算法版本。它对循环结构有一些替代想法，并且通过就地修改密钥来避免复制密钥。请注意，您还可以通过更改`MIN_VALUE`和`MAX_VALUE`常量来更改字母表的大小。

这是“001”案例的输出：

```
101 111 121 131 102 103 100
201 211 221 231 202 203 200
301 311 321 331 302 303 300
011 012 013 010
021 022 023 020
031 032 033 030
002
003
000 
```

这是代码：

```
#include <iostream>
#include <vector>
#include <string>
#include <sstream>

using namespace std;

const int MIN_VALUE = 0;
const int MAX_VALUE = 3;

int increment(int& ch)
{
    if (ch == MAX_VALUE)
        ch = MIN_VALUE;
    else
        ++ch;
    return ch;
}

string stringKey(const vector<int>& key)
{
    ostringstream sout;
    for (int i = 0; i < key.size(); ++i) 
        sout << key[i];
    return sout.str();
}

int main()
{
    vector<int> key;
    key.push_back(0);
    key.push_back(0);
    key.push_back(1);

    for (int outerKeyPos = 0;  outerKeyPos < key.size(); ++outerKeyPos)
    {
        int outerOriginal = key[outerKeyPos];
        while (increment(key[outerKeyPos]) != outerOriginal)
        {
            cout << stringKey(key);
            for (int innerKeyPos = outerKeyPos + 1; innerKeyPos < key.size(); ++innerKeyPos)
            {
                int innerOriginal = key[innerKeyPos];
                while (increment(key[innerKeyPos]) != innerOriginal)
                {
                    cout << " " << stringKey(key);
                }
            }
            cout << endl;
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-02T08:59:14.990

我试图纠正你的算法，尽可能接近原来的算法：

```
 int TagLen = static_cast<int>(numTag.size());

 for ( int p=0; p< TagLen  ; p++ ) {
     // First loop is to generate tags 1 position differ
     for ( int b=0; b<=3 ; b++ ) { // Loop over all 4 elements

         int bval = b;
         if (numTag[p] == b) {
             continue; // This is the seed vector, ignore it
         }

         vector <int> nbnumTag = neighbors(numTag, p, bval);
         string SnbnumTag = Vec2Str(nbnumTag);

         cout << SnbnumTag;
         cout << "\n";

         // Second loop for tags in 2 position differ 
         for (int l=p+1; l < TagLen; l++) {

             for (int  c=0; c<=3; c++) {

                 int cval = c;

                 if (nbnumTag[l] == c) { // Loop over all 4 elements
                     continue; // This is nbnumTag, ignore it
                 }
                 vector <int> nbnumTag2 = neighbors(nbnumTag, l, cval);
                 string SnbnumTag2 = Vec2Str(nbnumTag2);

                 cout << "\t" << SnbnumTag2;
                 cout << "\n";
             }
         }
     }
 } 
```

The problem is that you don't iterate over all 4 possible values (0,1,2,3), but you skip 0 for some reason. The way I am doing it is to iterate over all of them and ignore (by using a continue) the vector that is the same with the seed or the 1-point different tag computed at phase 1.

Having said that, I believe that better algorithms than yours are proposed and it would be better to consider one of them.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-25T02:49:10.607

这是我丑陋的，hacky的解决方案：

```
#include <iostream>
#include <vector>

using std::cout;
using std::endl;
using std::vector;

struct tri
{
    tri(int a, int b, int c)
    {
        switch (a)
        {
            case 0:
                m[0] = 0;
                m[1] = b;
                m[2] = c;
                break;
            case 1:
                m[0] = b;
                m[1] = 0;
                m[2] = c;
                break;
            case 2:
                m[0] = b;
                m[1] = c;
                m[2] = 0;
                break;
        }
    }
    int m[3];
};

int main()
{
    vector<tri> v;
    for (int i = 0; i < 3; i++)
        for (int j = 0; j < 4; j++)
            for (int k = 0; k < 4; k++)
            {
                v.push_back(tri(i,j,k));
            }

    vector<tri>::iterator it;
    for (it = v.begin(); it != v.end(); ++it)
    {
        cout << (*it).m[0];
        cout << (*it).m[1];
        cout << (*it).m[2];
        cout << endl;
    }
} 
```

# actionscript-3 - 将参数传递给 AS3 自动创建的资产类的构造函数

> ID：680019
> 
> 赞同：1
> 
> 时间：2009-03-25T02:29:49.030
> 
> 标签：actionscript-3, constructor, parameters, auto-generate, assets

`MyClip`我正在创建一个想要用于多个库资产的 MovieClip 子类（我们称之为）。我将从 ActionScript 代码中实例化这些影片剪辑。`MyClip`有一个构造函数参数，允许它设置某些属性的初始值。

由于我想将它用于多个库资产，因此执行它的逻辑方法似乎是在“符号属性”对话框的“基类”文本框中指定它。问题是自动生成的子类没有带参数的构造函数。相反，Flash 尝试仅使用默认构造函数生成它们，这也失败了，因为`MyClip`没有默认构造函数。

除了将属性初始化推迟到普通方法之外，有什么办法可以解决这个问题？

**编辑：**我还不够清楚，我会在这里澄清一下。如果这是`MyClip`类：

```
public class MyClip extends MovieClip
{
    private var someValue : Number;

    public function MyClip(someValue : Number)
    {
        this.someValue = someValue;
    }
} 
```

我在库中指定`MyClip`为符号 MyClipA 的基类，理想情况下，我希望能够不必自己`clip = new MyClipA(17);`编写`MyClipA`类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T18:47:55.873

我不认为它真的可以做到。但是，如果可以做到，它将与原型一起使用。也许您可以更改每个默认类的构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T15:53:34.630

我假设您需要创建 MyClipA 和 MYClipB 等类的原因是将不同的艺术附加到仅具有 MyClip 对象行为的对象上？

也许您可以以不同的方式处理它，将您的基类 - MyClip 作为您的示例，接受 2 个参数，其中一个是对艺术的引用：

```
public class MyClip extends MovieClip
{
    public var art:ArtBaseClass
    private var someValue : Number;

    public function MyClip(someValue : Number, artClass:ArtBaseClass)
    {
        this.someValue = someValue;
        this.art = new artClass();
        this.addChild(art);
    }
} 
```

您可以在应用于每个艺术库对象的 ArtBaseClass 中定义您需要的任何其他内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T02:36:30.183

尝试为构造函数指定默认参数（`null`也许是特殊值？）。然后在为您的 MovieClip 设置合理默认值的构造函数的开头添加一些错误检查。这真的很 hacky，但据我所知，没有更好的方法可以使用拖放动画 UI 来实现（你只能通过代码来实现）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T06:15:44.883

如果也遇到这种情况。解决这个问题的正确方法是为从 MyClip 继承的 MyClipA 和 MyClipB 创建类。如果有很多基于 MyClip 的类，这可能会很麻烦。再说一次，如果是这种情况，您可能想开始考虑使用组合而不是继承。

# javascript - 是否可以在 javascript/jquery 中停止执行？

> ID：680021
> 
> 赞同：9
> 
> 时间：2009-03-25T02:30:29.480
> 
> 标签：javascript, jquery, jquery-animate

基本上，我希望能够将任何命令包装在 $.holdTillFinished() 方法中，该方法在指定的方法/jquery 动画执行完成之前不允许继续执行。

我怀疑这在javascript中可能很困难甚至不可能，但我希望有人会知道。

我不想听到我如何将回调传递给动画以使其在完成时运行，或者其他类似的东西。

我真的很想知道这样的事情是否可能以及如何去做。

如果有人知道一个很好的队列插件能够对用户定义的方法和动画进行排队，那么这不会发生，那也很酷。我真正想要的是一种延迟执行的方法。（同时仍然允许动画运行）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-25T04:51:09.753

> 我怀疑这在javascript中可能很困难甚至不可能

你的怀疑是正确的。动画、用户输入循环和 'async=true' XMLHttpRequests 等方法*必须*将控制权返回给浏览器才能继续进行，并且浏览器在每个嵌套级别的函数调用都返回之前无法收回控制权。这意味着您的所有代码，包括调用 'holdTillFinished()' 的函数都必须展开：因此 'holdTillFinished()' 是不可能的。

其他语言具有流控制功能，允许您有效地执行异步过程，因为在调用者看来是同步的，反之亦然。最著名的是[线程](http://en.wikipedia.org/wiki/Thread_(computer_science))和[延续](http://en.wikipedia.org/wiki/Continuation)。JavaScript 不具备这些功能，因此您能做的最好的事情就是超时和回调。

（将回调定义为内联函数以访问闭包中的封闭函数的变量至少可以减轻一些痛苦；一些其他语言必须开始将每一位封闭状态包装在对象的属性中以实现这一点.)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T02:46:08.493

您可能正在寻找[http://docs.jquery.com/Effects/queue](http://docs.jquery.com/Effects/queue)

但是，如果您正在寻找一种更通用的延迟方式，我之前使用过这个片段（我没有写它，所以所有功劳归原作者所有）：

```
//Simple wrapper enabling setTimout within chained functions.
$.fn.wait = function(time, type) {
  time = time || 1000;
  type = type || "fx";
  return this.queue(type, function() {
    var self = this;
    setTimeout(function() {
      $(self).dequeue();
    }, time);
  });
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T08:07:26.863

您可以使用发布/订阅架构来实现您想要的。在不知道你到底想要达到什么的情况下，我猜这对你有用。

它的工作方式是您将函数的完成视为一个事件，您可以收听并将处理程序附加到该事件。[Dojo 有一个 pubsub 机制](http://dojotoolkit.org/book/dojo-book-0-9/part-3-programmatic-dijit-and-dojo/event-system/publish-and-subscribe-events)，尽管我确信还有其他机制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-04T10:31:58.547

它根据情况进行防御，但通常需要在调用 AJAX 或在 javascript 中执行任何循环时显示处理图像。我有一种情况，我在循环中调用 AJAX，以便用户显示处理图像。为了终止我做了一个技巧。我已经放置了一个按钮来在调用此函数时取消作业我将一个全局变量说'cancelJob'设置为true，并且在我正在检查这个全局的循环中，如果这是真的，则运行返回false并且脚本将停止。

```
var cancelJob = false;
foreach(){
   if(cancelJob == true)
       return false;
}

function cancelButtonPress(){
   cancelJob = true;
} 
```

# regex - 有没有像样的 Vim 正则表达式 OR 命令？找到不匹配的最佳方法是什么？

> ID：680022
> 
> 赞同：42
> 
> 时间：2009-03-25T02:30:31.727
> 
> 标签：regex, vim

我在脚本中有一些不匹配的 if 和 fi 语句。我想去掉除了 if 的 else 和 fi 之外的所有东西。就这样我可以看到结构。为什么要与如此强大的编辑器一起努力工作？我需要一个用于正则表达式的**BIGFATOR**运算符或一些让我无法理解的顿悟......我不关心正则表达式的夸张，只是在 VIM7.2 中实际工作的东西。

> :g/[ ^\t]如果 [/打印

将打印出 ifs

> :g/[ ^\t]fi/打印

将打印出 fi

我想做的是或条件

:g/[ ^\t]fi **BIGFATOROPERATOR** [ ^\t]fi/print

我在以下方面取得了成功......但我觉得我工作太努力了！

> :call TripMatch('[ ^\t]*if [', 'else', 'fi[ \t$]')
> 
> 功能！TripMatch(str1, str2, str3)
> 
> 让 var1 = a:str1
> 
> 让 var2 = a:str2
> 
> 让 var3 = a:str3
> 
> 让 max = line("$")
> 
> 让 n = 1
> 
> 对于范围内的 n (1, max)
> 
> 让当前行 = getline(n)
> 
> ```
> if currentline =~? var1
> 
>    echo n "1:" currentline
> 
> else
> 
>    if currentline =~? var2
> 
>       echo n "2:" currentline
> 
>    else
> 
>       if currentline =~? var3
> 
>          echo n "3:" currentline
> 
>       else
> 
>          let foo = "do nothing"
> 
>       endif
> 
>    endif
> 
> endif 
> ```
> 
> 结束
> 
> 结束功能

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-03-25T02:34:49.580

```
:g/[ ^\t]if\|[ ^\t]fi/print 
```

**BIGFATOROPERATOR**是`\|`。它被称为[交替运算符](http://devmanual.gentoo.org/tools-reference/sed/index.html)。在 PCRE 中，这很简单`|`。它在 Vim/ex 中被转义，因为`|`在其他地方用于一般命令（或其他东西——FIXME）。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-25T02:48:48.080

如果您想删除除 if、else 或 fi 之外的所有其他行，您可以使用它

```
%v/\(if\|else\|fi\)/d 
```

'v' 是 'g' 的反义词，它将删除任何与正则表达式不匹配的行。

为了补充 strager 所说的，管道字符“|” 在 Vim 中被转义，我想是因为 Vim 假设你会更频繁地寻找文字字符，而不是你需要大量的 RegExps。

在 ex 模式下，您可以通过将 'magic' 级别设置为 'very' 来使 Vim 使用较少转义的 RegExp：

> 使用 "\v" 意味着在它之后的模式中，除了 '0'-'9'、'a'-'z'、'A'-'Z' 和 '_' 之外的所有 ASCII 字符都有特殊含义。“很神奇”

*更多信息请参见：he /magic*

不过，不建议您在 vimrc 中将默认魔法级别设置为 'very'（如帮助文件所述）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-25T07:56:36.903

```
:h /\| 
```

如果您错过了 \|，您可能已经错过了许多其他[模式](http://vimdoc.sourceforge.net/cgi-bin/help?tag=pattern)“标记”。

# c# - WPF：通过应用程序应用样式

> ID：680027
> 
> 赞同：1
> 
> 时间：2009-03-25T02:33:16.213
> 
> 标签：c#, wpf, styles

在 WPF 中，**我可以在哪里放置应该在整个应用程序中应用的样式？**

这是因为目前，每当我使用一种样式时，我都会将它放在`<Window.Resources>`每个窗口的部分中，这在很多方面当然是错误的。

那么我可以把这些样式应用到哪里呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T02:38:30.337

`<Application.Resources>`在你的 App.xaml

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T08:34:41.603

如果您有许多样式，如果将它们全部放在 application.resources 中，Xaml 可能会变得臃肿。另一种可能性是使用资源字典。[这](http://blogs.msdn.com/wpfsdk/archive/2007/06/08/defining-and-using-shared-resources-in-a-custom-control-library.aspx)是有关资源字典和共享多个资源字典的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T02:58:12.847

通常我会创建一个名为“LookAndFeel”的单独项目。此类包含 App.xaml，它定义了您希望应用程序使用的所有样式。如果您正在进行任何类型的基于模块的设计，那么将其放在一个单独的项目中会很有帮助，这样您就可以在一个地方管理“外观和感觉”。为了利用这个项目，您当然需要创建对它的引用。

# python - Python：如何提取字典条目的变量名？

> ID：680032
> 
> 赞同：2
> 
> 时间：2009-03-25T02:36:07.643
> 
> 标签：python, dictionary, variables, lookup

我想知道如何查找字典元素的变量名称：

例如：

```
 >>>dict1={}
    >>>dict2={}

    >>>dict1['0001']='0002'
    >>>dict2['nth_dict_item']=dict1
    >>>print dict2
    {'nth_dict_item': {'0001': '0002'}}
    >>>print dict2['nth_dict_item']
    {'001': '002'} 
```

我怎样才能让它告诉我 dict2['nth_dict_item'] 是或正在引用 "dict1" ？我想要它引用的数据结构的名称，而不是数据本身。

如果我将 id(dict1) 的输出与 id(dict2['nth_dict_item']) 进行比较，我会发现它们是相同的。

但是我怎样才能把那个 id 变成一个变量名呢？是否有更直接/更清洁的方法来获取我想知道的信息？

我确定我只是忽略了一个可以让我的生活变得轻松的函数，但我对 Python 还是很陌生 :)

任何帮助表示赞赏，谢谢！

### 有关的

*   [python，我可以打印原始变量名称吗？](https://stackoverflow.com/questions/544919/python-can-i-print-original-var-name)
*   [如何在 python 中打印变量名？](https://stackoverflow.com/questions/592746/how-can-you-print-a-variable-name-in-python)

* * *

更新：这就是我希望它起作用的原因：

我正在尝试制作一个使用字典的应用程序，有点像数据库。我希望这个伪代码的功能能够发挥作用：

```
dict_1={}
dict_2={}
dict_3={}

dict_1["FooBar1.avi"]=[movie_duration,movie_type,comments]
dict_2["FooBar2.avi"]=[movie_duration,movie_type,comments]
dict_3["FooBar3.avi"]=[movie_duration,movie_type,comments]

dict_database[SomeUniqueIdentifier1]=dict_1
dict_database[SomeUniqueIdentifier2]=dict_2
dict_database[SomeUniqueIdentifier3]=dict_3 
```

SomeUniqueIdentifier# 将是我用作数据库键/unqiueID 来查找条目的唯一值。

我希望能够通过以下方式更新 FooBar1.avi 的“评论”字段：

```
WhichDict= dict_database[SomeUniqueIdentifier1]
WhichDict[WhichDict.keys()[0]][2]='newcomment' 
```

而不必这样做：

```
dict_database['SomeUniqueIdentifier1'][dict_database['SomeUniqueIdentifier1'].keys()[0]][2]='newcomment' 
```

* * *

感谢大家。我现在明白我误解了很多基础知识（全脑放屁）。将返回并修复设计。谢谢大家！。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-25T02:47:39.550

变量名只是一个名称——就程序而言，它没有真正的意义，只是为了方便程序员（这在 Python 中并不完全正确，但请耐心等待）。就 Python 解释器而言，这个名字`dict1`只是程序员告诉 Python 查看内存地址的一种方式`0x1234`。

此外，将内存地址 ( `0x1234`) 转换回变量名 ( `dict1`) 的想法本身是没有意义的，尤其是考虑到多个变量名可以引用同一个对象：

```
dict1 = {...}
dictCopy = dict1 
```

现在`dictCopy`和字典的名称一样多`dict1`——它们都引用了同一个东西。如果您要查找的函数存在，Python 应该选择哪个名称？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-25T03:11:28.447

添加zenazn所说的：

> 但是我怎样才能把那个 id 变成一个变量名呢？

简短的回答是你不想真的想要。如果您认为需要这样做，则说明您的程序设计有问题。如果您更具体地告诉我们您要解决什么问题，我们可以帮助您找到更好的方法来完成它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T04:49:49.427

简单的答案：而不是

```
WhichDict[WhichDict.keys()[0]][2]='newcomment' 
```

利用：

```
WhichDict.values()[0][2]='newcomment' 
```

但是用字典来表示一部电影是非常不合适的。为什么不使用类呢？

```
class Movie(object):
    def __init__(self, filename, movie_duration, movie_type, comments):
        self.filename = filename
        self.movie_duration = movie_duration
        self.movie_type = movie_type
        self.comments = comments

database = dict()
database['unique_id_1'] = Movie("FooBar1.avi", duration, type, comments)
# ...

some_movie = database[some_id]
some_movie.comment = 'newcomment' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T04:56:36.650

现在，对于每部电影，你正在做：

```
dict_n = {}
dict_n["000n"] = [movie_duration,movie_type,comments] 
```

每个字典只有一个条目。然后你将多个电影字典存储在一个中心：

```
dict_database = {}
dict_database["0001"] = dict_1
dict_database["0002"] = dict_2
dict_database["0003"] = dict_3
dict_database["000n"] = dict_n 
```

**编辑：**这可能是你的想法。

对于每部电影，都有一个从属性名称到值的字典。

```
movie_n = {}
movie_n["movie_duration"] = 333
movie_n["movie_type"] = "Fantasy"
movie_n["comments"] = "" 
```

然后`movies["any_file.avi"]`给你那个字典。要将电影添加到目录然后添加评论，请输入：

```
movies["any_file.avi"] = movie_n
movies["any_file.avi"]["comments"] = "new comment" 
```

如果您必须在该电影的编号和文件名之间进行选择，我会选择文件名，因为当您实际尝试访问电影时它更相关。`movies.keys()`另外，如有必要，您可以通过或类似的方式枚举您的电影（尽管顺序不正确） 。如果要同时使用数字和文件名，请将文件名添加为每部电影的另一个键。

```
movie_n["filename"] = "any_file.avi" 
```

或者

```
movies["000n"]["filename"] = "any_file.avi" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T04:31:30.610

你需要重新考虑你的设计。

一个快速的技巧是将变量名实际放入...

```
dict2['item_n'] = 'dict1' 
```

或者也许使用一个元组..

```
dict2['item_n'] = ('dict1', dict1) 
```

有一个名为的函数`locals()`提供了一个局部变量名称的字典，也许你可以在重新考虑你的设计时考虑它。

在这里，看看如何`locals()`工作：

```
>>> x = 10
>>> y = 20
>>> c = "kmf"
>>> olk = 12
>>> km = (1,6,"r",x)
>>> from pprint import pprint
>>> pprint( locals() )
{'__builtins__': <module '__builtin__' (built-in)>,
 '__doc__': None,
 '__name__': '__main__',
 'c': 'kmf',
 'km': (1, 6, 'r', 10),
 'olk': 12,
 'pprint': <function pprint at 0x016A0EB0>,
 'x': 10,
 'y': 20} 
```

* * *

**更新**

> 我希望能够通过以下方式更新 FooBar1.avi 的“评论”字段：
> 
> `WhichDict= dict_database[SomeUniqueIdentifier1]`
> `WhichDict[WhichDict.keys()[0]][2]='newcomment'`

嗯，这是微不足道的

dict_databse[标识符][2] = the_new_comment

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T11:12:35.247

使用[孔雀鱼](http://guppy-pe.sourceforge.net/)。

```
from guppy import hpy
h=hpy()
h.iso(dict2['nth_dict_item']).sp

0: h.Root.i0_modules['__main__'].__dict__['dict1'] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T04:21:11.913

> 我怎样才能让它告诉我 dict2['nth_dict_item'] 是或正在引用 "dict1" ？

```
>>> print dict2['nth_dict_item'] is dict1
True 
```

# data-structures - 一棵树的度数是多少？（如在树 ADT 中）

> ID：680041
> 
> 赞同：11
> 
> 时间：2009-03-25T02:43:18.420
> 
> 标签：data-structures, tree, binary-tree

我知道一个节点的程度是它拥有的孩子的数量。

但是，我们如何定义树的度数？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-28T16:54:56.717

基本上，树的度数是它的子节点的总数，即源自它的节点总数。树的叶子没有任何子节点，因此它的度数为零。

***节点的度是子树中以该节点为根的分区数。degree=0 的节点称为叶子。***

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-25T03:10:00.620

通常，图具有最小度数和最大度数，即图中所有节点的最小度数和最大度数。

如果一个图是 k 正则的，即所有节点恰好有 k 个邻居，最小和最大度数等于 k，并且该图被称为 k 度数。

因为一棵树不是 k 正则的，所以你不能说它有 grad k，但你可以找到它的最小或最大 grad。

很常见的是 k-ary 树，即每个节点最多有 k 个子节点的有根树。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-03-21T20:16:23.753

节点的度数是其子节点的数量。树的度数是其任何节点的最大度数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T03:07:42.200

对于有根树，您可以将其定义为根的度数。在某些情况下，说它是树中任何节点的最大度数可能是有道理的。但如果没有上下文，很难说出*正确*的定义是什么。这取决于您要如何使用它以及树的“程度”有什么意义。如果您有一个具体的例子，或者您觉得有一段文字令人费解，请更新问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-10T03:51:16.287

### 有两种不同的定义：

*   **树的度是树的节点度的最大值。**（摘自《软件工程、算法设计与分析》，第 2 卷，I. Pu，2006）
*   **树的度数是根的度数。**（来自[维基百科](https://en.wikipedia.org/wiki/Tree_(data_structure))）

所以我们必须从上下文中得出含义☠️☠️。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-03-18T16:48:07.113

图的度数为 2n

要计算树的度数，请使用树边的公式：Edges = (Vertices - 1)

现在将我们所知道的关于图的度数应用于树中的边数：树度数 = 2(n-1) = 2n-2

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2020-12-16T09:33:10.393

树的度数是任何节点可以拥有的最大子节点数。树的度数是预定义的，因此通过查看一棵树，我们无法判断一棵树的度数。

假设我们有一棵 3 度的树，但树的每个节点只有 0,1 或 2 个子节点。但这并不意味着树的度数是 2，因为我们可以在任何节点上再添加 1 个元素。

# log4net - LogManager.GetLogger 的 log4net 参数

> ID：680044
> 
> 赞同：99
> 
> 时间：2009-03-25T02:44:54.283
> 
> 标签：log4net

为什么大多数 log4net 示例通过这样做来获取类的记录器：

```
private static ILog logger = 
    LogManager.GetLogger(
    System.Reflection.MethodBase.GetCurrentMethod().DeclaringType); 
```

而不仅仅是传递 typeof(MyClass)：

```
private static ILog logger = LogManager.GetLogger(typeof(MyClass)); 
```

除了第一个选项不需要您输入特定的类名之外，还有其他原因吗？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-03-25T02:54:05.447

我想你有理由。我这样做是为了不必担心类名，只需将样板代码复制并粘贴到新类中即可。

有关官方答案，请参阅：如何在静态块中获取类的完全限定名称？在[log4net 常见问题解答](http://logging.apache.org/log4net/release/faq.html#static-class-name)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-09-19T02:05:37.697

我是 NLog 用户，通常这归结为：

```
var _logger = LogManager.GetCurrentClassLogger(); 
```

你需要在 Log4Net 中进行反射似乎有点奇怪，所以我查看了 NLog 源代码，你瞧，这就是他们为你做的：

```
[MethodImpl(MethodImplOptions.NoInlining)]
public static Logger GetCurrentClassLogger()
{
    string loggerName;
    Type declaringType;
    int framesToSkip = 1;
    do
    {
#if SILVERLIGHT
        StackFrame frame = new StackTrace().GetFrame(framesToSkip);
#else
        StackFrame frame = new StackFrame(framesToSkip, false);
#endif
        var method = frame.GetMethod();
        declaringType = method.DeclaringType;
        if (declaringType == null)
        {
            loggerName = method.Name;
            break;
        }
        framesToSkip++;
        loggerName = declaringType.FullName;
    } while (declaringType.Module.Name.Equals("mscorlib.dll", StringComparison.OrdinalIgnoreCase));
    return globalFactory.GetLogger(loggerName);
} 
```

我想我会为 Log4Net 编写类似的东西作为扩展或静态方法，而不是将反射粘贴为我的锅炉代码的一部分:)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-25T02:53:30.220

正如您所说 - 它很方便，因为您可以在不知道类名的情况下在方法中创建记录器（我知道这很简单），但允许您在类之间剪切和粘贴方法而无需重命名调用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-08-24T09:03:46.790

`.DeclaringType()`我认为原因是，您使用该方法获取运行时类型的类型。您可以在基类中使用记录器，并且仍然可以在记录器输出中看到对象的实际类型。这使得调查更加方便。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-01T22:05:09.033

它还使得为代码生成目的创建 Codesmith 模板变得更加容易。

# c# - 从 C# 调用 C++ dll 函数：结构、字符串和 wchar_t 数组

> ID：680066
> 
> 赞同：1
> 
> 时间：2009-03-25T02:55:16.643
> 
> 标签：c#, c++, struct, marshalling, dllimport

这是我需要解决的一个简单问题，但它让我觉得我的头发变白了，因为我所有的尝试都返回了同样的错误：

“试图读取或写入受保护的内存。这通常表明其他内存已损坏。”

我有一个用 C++ 编写的示例应用程序，它调用 dll。以下是相关代码：

```
 //function I need to call
bool convertHKID_Name(char *code,RECO_DATA *o_data);    //hkid 

//struct definition
struct RECO_DATA{
    wchar_t FirstName[200];
    wchar_t Surname[200];
};

//how it is used in C++ code
CString code;
RECO_DATA data;
GetDlgItemText(IDC_CODE,code);
char _code[200];
WideCharToMultiByte(CP_UTF8, 0, code, -1, (char *)_code, 200, NULL, NULL);
ocr->convertHKID_Name(_code,&data) 
```

现在，当我调试 C++ 代码时，它会做正确的事情——将一些 Unicode 数据写入数据结构。

这是我尝试在 C# 中做同样的事情

```
 //my C# wrapper class
public class cnOCRsdk
{
    [StructLayout(LayoutKind.Sequential, Size=400, CharSet=CharSet.Unicode), Serializable]
    public struct RECO_DATA
    {
        [MarshalAsAttribute(UnmanagedType.ByValTStr, SizeConst = 200)]
        public string FirstName;
        [MarshalAsAttribute(UnmanagedType.ByValTStr, SizeConst = 200)]
        public string Surname;
    };

    [DllImport(@"cnOCRsdk.dll", CharSet=CharSet.Auto, EntryPoint = "?convertHKID_Name@CcnOCRsdk@@QAE_NPADPAURECO_DATA@@@Z")]
    public static extern bool convertHKID_Name(ref string num, ref RECO_DATA o_data);

    [DllImport("Kernel32.dll")]
    public static extern int WideCharToMultiByte(uint CodePage, uint dwFlags,
        [In, MarshalAs(UnmanagedType.LPWStr)]string lpWideCharStr,
        int cchWideChar,
        [Out, MarshalAs(UnmanagedType.LPStr)]StringBuilder lpMultiByteStr,
        int cbMultiByte,
        IntPtr lpDefaultChar, // Defined as IntPtr because in most cases is better to pass
        IntPtr lpUsedDefaultChar // NULL
        );
}

//my attempt to call the function from the dll
cnOCRsdk.RECO_DATA recoData = new cnOCRsdk.RECO_DATA();
string num = "262125355174";
StringBuilder sb = new StringBuilder(200, 200);
cnOCRsdk.WideCharToMultiByte(65001, 0, num, -1, sb, 200, IntPtr.Zero, IntPtr.Zero);
string sbTostring = sb.ToString();
//the next line generates the 'Attempted to read or write protected memory' error
bool res = cnOCRsdk.convertHKID_Name(ref sbTostring, out recoData); 
```

我的猜测是我没有正确编组 RECO_DATA 结构，因为 convertHKID_Name 函数写入的正是这个结构。但是我应该如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T03:19:49.487

我相信它应该工作，如果你

1.  将声明更改 `convertHKID_Name`为`CharSet.Ansi`
2.  Remove the "ref" from the string parameter
3.  Pass the `string num` directly to `convertHKID_Name` instead of calling `WideCharToMultiByte`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T01:07:48.877

I wrote a managed wrapper in C++ for my unmanaged dll, but got stuck a bit again.

Continued here

[Passing C# data type parameters to dll written in C++?](https://stackoverflow.com/questions/684133/passing-c-data-type-parameters-to-dll-written-in-c)

# iphone - 具有动态单元格高度的 UITableView - 我需要做什么来修复向下滚动？

> ID：680067
> 
> 赞同：19
> 
> 时间：2009-03-25T02:56:56.313
> 
> 标签：iphone, objective-c, uitableview

我正在 iPhone 上构建一个很小的 ​​Twitter 客户端。自然地，我在 UITableView 中显示推文，它们当然有不同的长度。我正在根据文本很好地动态更改单元格的高度：

```
- (CGFloat)heightForTweetCellWithString:(NSString *)text {
  CGFloat height = Buffer + [text sizeWithFont:Font constrainedToSize:Size lineBreakMode:LineBreakMode].height;
  return MAX(height, MinHeight);
}

- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
  NSString *text = // get tweet text for this indexpath
    return [self heightForTweetCellWithString:text];
  }
} 
```

我正在使用 PragProg 书中的算法显示实际的推文单元格：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
  static NSString *CellIdentifier = @"TweetCell";
  TweetCell *cell = (TweetCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];
  if (cell == nil) {
    cell = [self createNewTweetCellFromNib];
  }
  cell.tweet.text = // tweet text
  // set other labels, etc
  return cell;
} 
```

当我启动时，所有可见的推文都显示得很好。然而，当我向下滚动时，下面的推文非常混乱——似乎一旦一个单元格从屏幕上滚动出来，它上面的单元格的高度就会被调整为大于应有的大小，并掩盖了部分它下面的单元格。当单元格到达视图顶部时，它会自行重置并正确渲染。向上滚动没有任何困难。

这是一个视频，展示了这一点：http: [//screencast.com/t/rqwD9tpdltd](http://screencast.com/t/rqwD9tpdltd)

我已经尝试了很多：在创建时调整单元格的框架大小，对具有不同高度的单元格使用不同的标识符（即`[NSString stringWithFormat:@"Identifier%d", rowHeight]`），更改界面生成器中的属性......

如果我可以发布其他代码片段，请告诉我。在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T03:30:12.863

叹。事实证明，我并没有很好地调整所有属性。但至少我摆脱了那个错误。:)

通过确保[检查](http://screencast.com/t/dK5FiXpO0I).`UITableViewCell`

该行为是由于将我的推文文本标签声明为必要的最大高度而引起的——当表格单元格的子视图未被裁剪时，上方单元格中的标签将呈现在下方单元格的上方。由于 SDK 呈现单元格的顺序（向下）以及它如何将每个单元格堆叠在另一个之上，这在屏幕的第一次渲染时不可见。

# php - CakePHP 如何处理带/不带 'id' 字段的 HABTM 表？

> ID：680078
> 
> 赞同：3
> 
> 时间：2009-03-25T03:02:18.827
> 
> 标签：php, sql, cakephp

CakePHP 如何处理没有`id`列的表？

*HABTM 是一个“has and belongs to many”表，表示多对多的数据库关系*

我正在尝试保存一些关系数据，但 Cake 想要“SELECT LAST_INSERT_ID()”，但是它尝试保存的表没有 id 列，因此 id 用于不同的表。

具体来说，我有“游戏”和“玩家”表，以及一个名为“game_players”的关系表。game_players 有字段 game_id 和 player_id，我无法保存关系数据在这张表上。

澄清一下：这是导致问题的 game_player 表。该表没有也不应该有 id 字段。只存储玩家和游戏的关系，主键是(game_id, player_id)

CakePHP 如何处理这种情况/关系？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-08-10T08:03:57.183

`var $primaryKey = 'example_id';` $primaryKey 是您要查找的内容。

只需将其放在您的模型类上。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T08:37:20.877

Game HABTM 播放器，反之亦然？如果是这样，您的连接表 games_players 上不应有 ID 字段。你应该可以通过调用 Game 上的 save 来保存数据，比如

```
$this->Game->save(array(
  'Player'=>array(
    'Player'=>array(
      1,4,5,9 // Player IDs
    )
  )
)); 
```

在这种情况下，Cake 不会尝试获取最后一个插入 ID。

但是，如果 Game 没有 HABTM Player，并且您直接在模型 GamePlayer 上调用 save，它应该有一个 ID 字段以符合 Cake 约定。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T03:50:04.157

CakePHP 不支持复合主键。将一个名为“id”的主键添加到您的 game_players 表中。[模型和数据库约定](http://book.cakephp.org/view/24/Model-and-Database-Conventions)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T08:48:14.813

在正常情况下，您的连接表实际上应该称为**games_players**而不是**game_players** - 如果该表称为 game_players 那么您需要在各自的模型文件中告诉 Cake。

如果它只是一个连接表，那么它通常不需要 id 字段。在某些情况下，您可能希望将 id（或其他字段）添加到连接表中，但您不必这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T03:36:20.587

根据您的时间和精力，继续添加 id 字段会更好吗？您最终可能会以意想不到的方式扩展此表的需求。

只是一个建议。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T15:26:07.137

正如其他人所提到的，你的桌子应该被称为**games_players**并且你永远不应该直接使用它（蛋糕会自动处理它）。您必须设置 Game 和 Player 模型之间的关系，并让蛋糕负责其余的工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-01-21T13:07:14.467

“Cake 应用程序数据库中的所有表都必须以 id 作为表的主键。” （CakePHP 应用程序开发的第 3 章，作者 Anupom Syam 和 Ahsanul Bari，由 Packt Publishing 出版）。请参阅[http://jaimemontoya.com/cakephp-application-development/#20191203155934](http://jaimemontoya.com/cakephp-application-development/#20191203155934)。

# asp.net - 我可以欺骗 HttpRequest.Current.Request.IsLocal 吗？

> ID：680079
> 
> 赞同：11
> 
> 时间：2009-03-25T03:02:22.180
> 
> 标签：asp.net, httpcontext

我正在运行一个 Web 应用程序，如果它在本地运行，它会显示一些调试行为 - 引用资源字符串等 - 我想在我无法访问互联网的会议上在我的笔记本电脑上演示该应用程序，所以它必须是本地的。

该应用程序使用 HttpContext.Current.Request.IsLocal 来确定它是否在本地运行 - 有什么办法可以欺骗它吗？即使我确实在本地运行，我也想欺骗它返回“False”。

我确实可以访问源代码（并意识到我可以演示一个“IsLocal”检查被注释掉的构建），但不想为这个演示制作一个特殊的构建。如果需要，我会这样做，但我宁愿使用现有的代码库。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-03-14T17:21:06.833

Request.IsLocal 属性实现以下代码：

```
public bool IsLocal { 
            get {
                String remoteAddress = UserHostAddress; 

                // if unknown, assume not local
                if (String.IsNullOrEmpty(remoteAddress))
                    return false; 

                // check if localhost 
                if (remoteAddress == "127.0.0.1" || remoteAddress == "::1") 
                    return true;

                // compare with local address
                if (remoteAddress == LocalAddress)
                    return true;

                return false;
            } 
```

来源：反编译的源代码（微软：[referencesource.microsoft.com](http://referencesource.microsoft.com/#System.Web/WorkerRequest.cs,ab8517882440da8b)）

希望这可以帮助 ！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T03:20:42.357

这将需要在对本地 IIS 实例的请求中欺骗非本地 IP 地址。我认为你可能会花费更少的时间来制作演示版本而不是尝试制作它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T03:52:09.160

*我相信这是真的，但现在无法验证。*

当站点绑定到环回地址 127.0.0.1 时，IsLocal 返回 True。

如果您确保在 IIS 中您的网站绑定到您机器的一个非环回地址（即 192.168.1.100），那么 IsLocal 应该返回 False。

根据定义，Cassini 始终是本地的，因为它只能绑定到环回地址。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-17T04:42:45.637

如果您的服务器有多个 IP 地址，您将需要一些额外的代码。以下处理多个 ip 地址，并处理像 cloudflare 这样的 CDN，它将在 Request.UserHostAddress 属性中具有错误的 ip 地址。

代码：

```
private bool IsLocal()
{
    if (Request.IsLocal)
    {
        return true;
    }
    string forwardIP = Request.ServerVariables["HTTP_X_FORWARDED_FOR"];
    foreach (NetworkInterface netInterface in NetworkInterface.GetAllNetworkInterfaces())
    {
        IPInterfaceProperties ipProps = netInterface.GetIPProperties();
        foreach (UnicastIPAddressInformation addr in ipProps.UnicastAddresses)
        {
            string ipString = addr.Address.ToString();
            if (Request.UserHostAddress == ipString || forwardIP == ipString)
            {
                return true;
            }
        }
    }
    return false;
} 
```

# sql - 保存来自另一个表的行数的表字段

> ID：680083
> 
> 赞同：2
> 
> 时间：2009-03-25T03:04:15.203
> 
> 标签：sql, database

我有一个字段，我想在其中存储另一个表中某些行的数量。创建行时我一直在增加这个值，但觉得这可能不是最好的方法。那么我也不认为每次都在有问题的桌子上做“计数”是有意义的。什么是最好的方法？

编辑：计数被过滤

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T04:45:27.597

创建一个*INSERT* **触发器**以增加产品计数。

![替代文字](https://farm4.static.flickr.com/3642/3383602189_ce1503d511_o.png)

这是代码

```
create table Products ( ID int identity primary key )
GO
create table ProductCounter ( ProductCount int not null default 0 )
GO
insert ProductCounter default values
GO
create trigger trgIncrementProductCount
on Products
after insert
as
begin
    update  ProductCounter
    set ProductCount = ProductCount + 1
end
GO

insert Products default values
insert Products default values
select * from ProductCounter

insert Products default values
insert Products default values
select * from ProductCounter 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T03:07:55.677

如果它的 sql 服务器，您可以触发插入和删除以增加/减少值。

或者你可以为它做一个视图。

或者，就像我会做的那样，每次都简单地做 count(*) ，除非它是一张巨大的桌子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T03:08:11.060

如果您要查找的值是第一个表中的行数，那么与插入/更新第二个表然后从中查询值的开销相比，这将是一个便宜得多的操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T03:18:46.667

请注意，这是一个特定的 Sql Server 答案，首先我不确定是否

```
select count(*) from table 
```

确实进行了全表扫描，执行计划说确实如此。如果是这样，那么您可以使用系统表查找表中的行数，这会更快，尤其是在大表上。

```
select rowcnt from sysindexes
inner join sysobjects on sysobjects.id = sysindexes.id
where xtype='U'
and sysobjects.name = 'YourTableName'
and indid = 0 
```

我知道这依赖于可能会改变的系统表，但这些在过去十年中没有，它还依赖于你的表有一个主键。因此，与其存储行数，不如进行快速但令人讨厌的查找。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T03:25:01.330

虽然在理想世界中您永远不会希望将计算值存储在数据库中，但在现实世界的泥泞中，这通常是必要的。

所以克里斯的触发器建议是你最好的选择。您可能必须在每次触发器调用后重新查询计数，因为可能并不总是可以知道插入或删除了多少行（取决于 RDBMS），并且如果有可能不止一个您的计数可能会受到单个 INSERT 或 DELETE 语句的影响。

而且，由于您还计算特定行，因此您还需要一个 UPDATE 触发器，以防您的计数过滤器的值之一发生更改。

因此，一个或多个触发器（您可以将其全部打包到单个 INSERT/UPDATE/DELETE 触发器中）可能会变得相当复杂。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T03:31:44.747

这个行数需要多久？是否可以运行类似 cron 的东西每隔几个小时更新一次？简单的 SELECT COUNT(ID) FROM Table WHERE...yada yada。它不会依赖于每次查询后的额外更新。

只是重...

# postgresql - string.Format("{0:s}", DateTime.Now) 的 Postgresql 等价物是什么？

> ID：680086
> 
> 赞同：1
> 
> 时间：2009-03-25T03:06:28.303
> 
> 标签：postgresql, date, varchar

PostgreSQL 中可排序的日期时间/时间戳 varchar 的等价物是什么？

```
Console.WriteLine("{0:s}", DateTime.Now); 
```

样本格式输出：

```
2000-05-04T15:30:59 
```

这有效，SELECT now::varchar，输出为“2009-03-25”，但仅适用于日期类型，想知道时间戳的等价物是什么。

请注意，我知道日期本身是可排序的，我只是遇到了.NET 和 Mono 之间的 DateTime 不兼容，所以我将传输（远程处理）日期/时间戳类型作为 varchar，底层数据库类型仍然是正确的日期/时间戳字段类型。对于那些遇到同样问题的人，解决方法是在检索数据时将日期转换为 varchar，并在保存时将 varchar 转换回日期。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T04:36:15.077

基本上你只使用 to_char 函数。

你的例子的问题是，虽然理论上这应该有效：

```
select to_char( now(), 'YYYY-MM-DDTHH24:MI:SS' ); 
```

实际上 - PostgreSQL 无法“理解” T 是分隔符而 HH24 是下一个“标签”，并将其打印为：

```
2009-03-24THH24:32:45 
```

但是您可以相对简单地将其更改为：

```
select translate( to_char( now(), 'YYYY-MM-DD HH24:MI:SS' ), ' ', 'T' ); 
```

输出请求的格式：

```
2009-03-24T21:33:21 
```

当然，记住总是使用 translate 很快就会过时，因此您可以创建自己的函数并使用它来代替：

```
create function custom_ts(timestamptz) returns text as $$
  select translate( to_char( $1, 'YYYY-MM-DD HH24:MI:SS' ), ' ', 'T' );
$$ language sql;
# select custom_ts(now());
      custom_ts
---------------------
 2009-03-24T21:35:47
(1 row) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T10:29:06.927

或者简单地说：

```
SELECT TO_CHAR(CURRENT_TIMESTAMP, 'YYYY-MM-DD"T"HH24:MI:SS'); 
```

# asp.net - 数据网格分页

> ID：680087
> 
> 赞同：0
> 
> 时间：2009-03-25T03:06:32.843
> 
> 标签：asp.net, datagrid

我正在使用带有 IE7 的 VB.Net 2005。我有一个数据网格，其中设置了分页“AllowPaging”= True 但是，当我单击下一页的链接时，记录仍然相同。

我的代码是：

```
ds = SQLHelper.ExecuteDataset(strConn, 
      CommandType.StoredProcedure, "GetInventory")
dv = ds.Tables(0).DefaultView
dgInvestoryList.DataSource = dv
dgInvestoryList.DataBind() 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T10:39:48.790

If you are using the Wizard with the SqlDataSource, then paying will be there all ready.

But if you go and place your code in the code behind you will have to do something like this - sorry i dont have the code for VB.NET - Must place code in the PageIndexChanging event. Use this [This link to change my C# code to VB.NET, i use it ALOT](http://www.carlosag.net/Tools/CodeTranslator/)

```
protected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)
    {
        try
        {
            DataSet ds = new DataSet();
            GridView1.DataSource = ds;
            GridView1.PageIndex = e.NewPageIndex;
            this.GridView1.DataBind();
        }
        catch (Exception)
        {
            Response.Redirect("Login.aspx");
        }

    } 
```

# c++ - 我听说 i++ 不是线程安全的，++i 是线程安全的吗？

> ID：680097
> 
> 赞同：94
> 
> 时间：2009-03-25T03:09:18.123
> 
> 标签：c++, c, multithreading

我听说 i++ 不是线程安全语句，因为在汇编中它简化为将原始值存储为某个地方的临时值，递增它，然后替换它，这可能会被上下文切换中断。

但是，我想知道 ++i。据我所知，这将简化为一条汇编指令，例如“add r1, r1, 1”，并且由于它只是一条指令，因此不会被上下文切换中断。

谁能澄清一下？我假设正在使用 x86 平台。

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2009-03-25T03:19:40.407

你听错了。对于特定的编译器和特定的处理器体系结构，这很可能`"i++"`是线程安全的，但在标准中根本没有强制要求。实际上，由于多线程不是 ISO C 或 C++ 标准^((a))的一部分，因此您不能根据您认为它将编译成的内容来认为任何东西都是线程安全的。

可以编译成任意序列是非常可行的，`++i`例如：

```
load r0,[i]  ; load memory into reg 0
incr r0      ; increment reg 0
stor [i],r0  ; store reg 0 back to memory 
```

这在我的（想象的）没有内存增量指令的 CPU 上不是线程安全的。或者它可能很聪明并将其编译为：

```
lock         ; disable task switching (interrupts)
load r0,[i]  ; load memory into reg 0
incr r0      ; increment reg 0
stor [i],r0  ; store reg 0 back to memory
unlock       ; enable task switching (interrupts) 
```

其中`lock`禁用和`unlock`启用中断。但是，即便如此，在具有多个这些 CPU 共享内存的架构中，这可能不是线程安全的（`lock`可能只禁用一个 CPU 的中断）。

语言本身（或它的库，如果它没有内置在语言中）将提供线程安全的构造，您应该使用这些构造，而不是依赖于您对将生成的机器代码的理解（或可能是误解）。

Java`synchronized`和`pthread_mutex_lock()`（在某些操作系统下可用于 C/C++）之类的东西是您需要研究的^((a))。

* * *

^((a))这个问题是在 C11 和 C++11 标准完成之前提出的。这些迭代现在已经在语言规范中引入了线程支持，包括原子数据类型（尽管它们和一般的线程都是*可选的，*至少在 C 中是这样）。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-03-25T03:32:57.023

您不能对 ++i 或 i++ 做出笼统的陈述。为什么？考虑在 32 位系统上增加一个 64 位整数。除非底层机器有四字“加载、递增、存储”指令，否则递增该值将需要多条指令，其中任何一条都可以被线程上下文切换中断。

此外，`++i`并不总是“将值加一”。在像 C 这样的语言中，增加指针实际上会增加所指向事物的大小。也就是说，如果`i`是一个指向 32 字节结构的指针，则`++i`添加 32 字节。尽管几乎所有平台都有一个原子的“在内存地址增加值”指令，但并非所有平台都有一个原子的“将任意值添加到内存地址的值”指令。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-03-25T18:29:13.077

它们都是线程不安全的。

CPU 不能直接对内存进行数学运算。它通过从内存中加载值并使用 CPU 寄存器进行数学运算来间接地做到这一点。

我++

```
register int a1, a2;

a1 = *(&i) ; // One cpu instruction: LOAD from memory location identified by i;
a2 = a1;
a1 += 1; 
*(&i) = a1; 
return a2; // 4 cpu instructions 
```

++i

```
register int a1;

a1 = *(&i) ; 
a1 += 1; 
*(&i) = a1; 
return a1; // 3 cpu instructions 
```

对于这两种情况，都存在导致不可预测的 i 值的竞争条件。

例如，假设有两个并发 ++i 线程，每个线程分别使用寄存器 a1、b1。并且，上下文切换执行如下：

```
register int a1, b1;

a1 = *(&i);
a1 += 1;
b1 = *(&i);
b1 += 1;
*(&i) = a1;
*(&i) = b1; 
```

结果，i 没有变成 i+2，而是变成了 i+1，这是不正确的。

为了解决这个问题，现代 CPU 在禁用上下文切换期间提供了某种 LOCK、UNLO​​CK cpu 指令。

在 Win32 上，使用 InterlockedIncrement() 来执行 i++ 以确保线程安全。它比依赖互斥锁要快得多。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-25T03:29:31.990

如果您在多核环境中跨线程共享一个 int，则需要适当的内存屏障。这可能意味着使用互锁指令（例如，请参见 win32 中的 InterlockedIncrement），或使用可确保某些线程安全的语言（或编译器）。对于 CPU 级指令重新排序和缓存以及其他问题，除非您有这些保证，否则不要假设跨线程共享的任何内容都是安全的。

编辑：对于大多数架构，您可以假设的一件事是，如果您正在处理正确对齐的单个单词，您最终不会得到一个包含两个混合在一起的值组合的单词。如果两次写入相互重叠，则一个将获胜，另一个将被丢弃。如果你很小心，你可以利用这一点，并看到 ++i 或 i++ 在单写/多读情况下是线程安全的。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-25T05:14:11.817

如果你想要 C++ 中的原子增量，你可以使用 C++0x 库（`std::atomic`数据类型）或类似 TBB 的东西。

曾几何时，GNU 编码指南说更新适合一个词的数据类型“通常是安全的”，但该建议对于 SMP 机器是错误的，~~对于某些体系结构是错误的，~~并且在使用优化编译器时是错误的。

* * *

澄清“更新单字数据类型”评论：

SMP 机器上的两个 CPU 可以在同一周期内写入同一内​​存位置，然后尝试将更改传播到其他 CPU 和缓存。即使只写入一个字的数据，因此写入只需一个周期即可完成，它们也会同时发生，因此您无法保证哪个写入成功。您不会得到部分更新的数据，但是一次写入会消失，因为没有其他方法可以处理这种情况。

比较和交换在多个 CPU 之间正确协调，但是没有理由相信单字数据类型的每个变量分配都会使用比较和交换。

虽然优化编译器不会影响*加载*/存储的编译方式，但它可能会*在*加载/存储发生时发生变化，如果您希望读取和写入按照它们在源代码中出现的顺序发生，则会造成严重的麻烦（最著名的是双重检查锁定在 vanilla C++ 中不起作用）。

**注意** 我最初的回答还说英特尔 64 位架构在处理 64 位数据时被破坏了。这不是真的，所以我编辑了答案，但我的编辑声称 PowerPC 芯片坏了。 [在将立即数（即常量）读入寄存器时确实如此](http://www.ibm.com/developerworks/library/l-ppc/)（参见清单 2 和清单 4 下名为“加载指针”的两个部分）。但是有一条指令可以在一个周期内从内存中加载数据（`lmw`），所以我删除了我答案的那一部分。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-08-04T17:43:54.983

即使简化为一条汇编指令，直接在内存中递增值，它仍然不是线程安全的。

当在内存中增加一个值时，硬件会执行“读-修改-写”操作：它从内存中读取该值，将其增加，然后将其写回内存。x86 硬件无法直接在内存上递增；RAM（和缓存）只能读取和存储值，不能修改它们。

现在假设您有两个独立的内核，或者在不同的套接字上，或者共享一个套接字（有或没有共享缓存）。第一个处理器读取该值，在它可以写回更新的值之前，第二个处理器读取它。在两个处理器写回该值之后，它只会增加一次，而不是两次。

有一种方法可以避免这个问题；x86 处理器（以及您会发现的大多数多核处理器）能够检测到硬件中的这种冲突并对其进行排序，从而使整个读-修改-写序列看起来是原子的。但是，由于这非常昂贵，因此仅在代码请求时才完成，在 x86 上通常通过`LOCK`前缀进行。其他架构可以通过其他方式做到这一点，结果相似；例如，加载链接/存储条件和原子比较和交换（最近的 x86 处理器也有最后一个）。

请注意，使用`volatile`在这里没有帮助；它只告诉编译器该变量可能已在外部进行了修改，并且对该变量的读取不得缓存在寄存器中或优化出来。它不会使编译器使用原子原语。

最好的方法是使用原子原语（如果你的编译器或库有它们），或者直接在汇编中进行增量（使用正确的原子指令）。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-25T05:14:56.700

在 C/C++ 中的 x86/Windows 上，您不应该假设它是线程安全的。如果需要原子操作，则应使用[InterlockedIncrement()](http://msdn.microsoft.com/en-us/library/ms683614(VS.85).aspx)和[InterlockedDecrement() 。](http://msdn.microsoft.com/en-us/library/ms683580(VS.85).aspx)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-25T19:14:42.967

如果您的编程语言对线程一无所知，但在多线程平台上运行，那么*任何*语言构造如何是线程安全的？

正如其他人指出的那样：您需要通过特定于平台的调用来保护对变量的任何多线程访问。

那里有一些库可以抽象出平台的特殊性，而即将到来的 C++ 标准已经调整了它的内存模型来处理线程（因此可以保证线程安全）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-25T04:55:43.907

永远不要假设增量会编译为原子操作。使用 InterlockedIncrement 或目标平台上存在的任何类似函数。

编辑：我刚刚查看了这个特定的问题，X86 上的增量在单处理器系统上是原子的，但在多处理器系统上不是。使用锁定前缀可以使其原子化，但仅使用 InterlockedIncrement 就更便携。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-02-08T09:42:01.463

根据x86 上的这个[汇编课程，您可以](http://cs.smith.edu/~thiebaut/ArtOfAssembly/CH06/CH06-2.html#HEADING2-48)**将寄存器自动添加到内存位置**，因此您的代码可能会自动执行“++i”或“i++”。但正如在另一篇文章中所说，C ansi 不会将原子性应用于“++”操作，因此您无法确定编译器会生成什么。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-25T20:13:21.640

1998 年的 C++ 标准对线程没有任何规定，尽管下一个标准（今年或明年到期）确实如此。因此，如果不参考实现，您就不能说任何关于操作线程安全的智能。这不仅仅是使用的处理器，而是编译器、操作系统和线程模型的组合。

在没有相反的文档的情况下，我不会假设任何操作都是线程安全的，尤其是对于多核处理器（或多处理器系统）。我也不相信测试，因为线程同步问题很可能只是偶然出现。

除非您有文档说明它适用于您正在使用的特定系统，否则没有什么是线程安全的。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-09-02T04:03:26.300

将 i 放入线程本地存储；它不是原子的，但没关系。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-05-31T04:42:40.473

AFAIK，根据 C++ 标准，对 an 的读/写`int`是原子的。

然而，这所做的只是摆脱与数据竞争相关的未定义行为。

但是如果两个线程都尝试递增，仍然会有数据竞争`i`。

想象以下场景：

让`i = 0`最初：

线程 A 从内存中读取值并存储在自己的缓存中。线程 A 将值增加 1。

线程 B 从内存中读取值并存储在自己的缓存中。线程 B 将值增加 1。

如果这都是一个单一的线程，你会得到`i = 2`内存。

但是对于两个线程，每个线程都会写入其更改，因此线程 A 写`i = 1`回内存，线程 B 写入`i = 1`内存。

它定义明确，没有部分破坏或构造或任何形式的对象撕裂，但它仍然是数据竞赛。

为了以原子方式递增`i`，您可以使用：

`std::atomic<int>::fetch_add(1, std::memory_order_relaxed)`

Relaxed ordering can be used because we don't care where this operation takes place all we care about is that the increment operation is atomic.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-25T03:15:21.837

你说“这只是一条指令，它不会被上下文切换中断。” - 这对于单个 CPU 来说很好，但是双核 CPU 呢？然后你真的可以让两个线程同时访问同一个变量，而无需任何上下文切换。

在不懂语言的情况下，答案是测试它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-22T13:31:44.313

我认为如果表达式“i++”是语句中唯一的，它相当于“++i”，编译器足够聪明，不会保留时间值等等。所以如果你可以互换使用它们（否则你赢了'不要问使用哪一个），无论你使用哪个都没有关系，因为它们几乎相同（美学除外）。

无论如何，即使增量运算符是原子的，如果您不使用正确的锁，也不能保证其余的计算将是一致的。

如果您想自己进行实验，请编写一个程序，其中 N 个线程同时递增一个共享变量，每个共享变量 M 次...如果该值小于 N*M，则某些增量被覆盖。尝试使用前增量和后增量并告诉我们 ;-)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-10T15:54:45.650

对于计数器，我建议使用既非锁定又是线程安全的比较和交换习惯用法。

这是Java：

```
public class IntCompareAndSwap {
    private int value = 0;

    public synchronized int get(){return value;}

    public synchronized int compareAndSwap(int p_expectedValue, int p_newValue){
        int oldValue = value;

        if (oldValue == p_expectedValue)
            value = p_newValue;

        return oldValue;
    }
}

public class IntCASCounter {

    public IntCASCounter(){
        m_value = new IntCompareAndSwap();
    }

    private IntCompareAndSwap m_value;

    public int getValue(){return m_value.get();}

    public void increment(){
        int temp;
        do {
            temp = m_value.get();
        } while (temp != m_value.compareAndSwap(temp, temp + 1));

    }

    public void decrement(){
        int temp;
        do {
            temp = m_value.get();
        } while (temp > 0 && temp != m_value.compareAndSwap(temp, temp - 1));

    }
} 
```

# delphi - Delphi：在wmp activex中播放内存流

> ID：680098
> 
> 赞同：1
> 
> 时间：2009-03-25T03:09:46.360
> 
> 标签：delphi, memorystream, wmp

我是这个网站的新手，我希望有人可以帮助我解决我的问题。我正在使用德尔福语言。我想向 windowsmediaplayer ActiveX 播放内存流。这可能吗？如果是的话，有人可以给我一个提示或什么.. 示例代码也许。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-29T18:51:54.397

几年前，Nils Haeck 发布了一个关于如何在[NLDelphi](http://www.nldelphi.com/forum/showthread.php?t=10516)上从**TMemoryStream播放****avi**的示例。他无法让它播放**mp3**的。为此，您应该寻找其他解决方案，例如[Un4Seen Bass](http://www.un4seen.com/bass.html)

 ****代码： [playfrommemory.zip](http://www.nldelphi.com/forum/attachment.php?attachmentid=1191&d=1066436669)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-29T18:36:23.700

不是免费的解决方案，但有一个商业 SDK，BoxedAppSDK，它允许您访问内存中的文件，就像它们在磁盘上一样。他们的一个示例包括一个媒体播放器，它从内存中访问一个文件。

[http://www.boxedapp.com/boxedappsdk/](http://www.boxedapp.com/boxedappsdk/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T20:48:27.430

我不能代表 Delphi 2009，但早期版本的 Delphi 不支持 TMediaPlayer 组件。您可以做的是将 MemoryStream 写入临时文件，然后让 TMediaPlayer 加载该文件。这将是最简单的解决方案，尽管不可否认。

# asp.net - 中继器中的常规单选按钮

> ID：680099
> 
> 赞同：0
> 
> 时间：2009-03-25T03:09:49.590
> 
> 标签：asp.net

尝试在中继器中设置常规单选按钮

```
<asp:Repeater ID="Repeater1" runat="server">
                    <ItemTemplate>
                        <input type="radio" name="OptGroup" id="rbEmail" value="<%=ID %>"/><label for="rbEmail"><%=Action %></label>
                    </ItemTemplate>
                </asp:Repeater> 
```

如果我在这里遗漏任何东西，我正在努力思考。我将有一组单选按钮，我相信我不能只对 id 进行硬编码。我需要每个权利的唯一 ID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T03:30:02.537

如果我没看错，你错过了转发器的数据源，而“ID”和“Action”是该数据源的一部分？在这种情况下，您需要更像这样的东西：

```
<asp:Repeater ID="Repeater1" runat="server">
                    <ItemTemplate>
                        <input type="radio" name="OptGroup" id='<%#"rbEmail"+Eval("ID")%>' value='<%# Eval("ID") %>'/><label for="rbEmail"><%# Eval("Action") %></label>
                    </ItemTemplate>
                </asp:Repeater> 
```

# asp.net - ASP.Net 媒体套件 - 评论

> ID：680104
> 
> 赞同：1
> 
> 时间：2009-03-25T03:13:12.500
> 
> 标签：asp.net, media, suite

有没有人评论过 ASP.Net Media Suite 位于

[http://www.aspnetmedia.com/](http://www.aspnetmedia.com/)

该工具看起来不错，但我从未听说过该公司。我对购买和安装来源不明的东西犹豫不决。

任何人都可以为产品担保吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-16T06:22:58.537

好吧，我已经发送了很多电子邮件，但从未得到答复，如果您问我，您可以使用许多其他替代方案更好，例如我使用了一个很棒的闪光灯控制 [http://www.flash-control.net/](http://www.flash-control.net/)

它尽一切努力实现 Flash，如 XHTML 有效包含、如果不可用则安装 Flash 的选项、Flash Vars 等...

然后您可以选择数以百万计的 Flash mp3 播放器、网络上使用 XML 的视频播放器，然后您只需在代码中创建 XML 并使用此控件连接任何特殊的 Flashvar，您就拥有了一个很棒的媒体播放器。这是一个不错的网站，我总是去这些东西

www.flashden.net。

希望这可以帮助。

# iphone - UIImage 和 UIImageView 问题

> ID：680109
> 
> 赞同：0
> 
> 时间：2009-03-25T03:15:21.527
> 
> 标签：iphone, uiimageview, uiimage

将 UIImageView.image 属性设置为 UIImage 无法将图像添加到视图中，但是如果我设置 imageview 框架属性，它可以工作。谁能告诉我这是怎么发生的？当我应用 UIImage 实例方法 [drawInRect:] 重绘比视图框架大的图像框架时会发生什么？我尝试过但没有任何反应，这个函数实际上在做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T16:33:17.327

通常，它的工作原理是，将 Image 添加到 UIImageView，然后将 UIImageView 添加到 UIView 以将其显示在屏幕上。您可以通过编程方式或使用 Interface Builder 来执行此操作。或者，您可以创建一个 CGRect（如果您愿意，可以基于一个框架），将其用作 UIImageView 的边界（或者您可以为 UIView 设置框架）。有几种方法可以做你想做的事。

没有看到你的代码很难说。这可能是很多事情。您可以在 currentView 后面插入带有图像的视图吗？您可能没有保留 UIImageView。我们不一定能在这里读心，（有时我们会）。但是，如果您想要一个可靠的答案，则需要提供更多帮助。

或者看看这个：

[UIImageView 文档](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIImageView_Class/Reference/Reference.html)

# c++ - 我可以使用带有 OpenGL glTexImage2D 函数的灰度图像吗？

> ID：680125
> 
> 赞同：19
> 
> 时间：2009-03-25T03:29:40.290
> 
> 标签：c++, opengl, textures

我有一个只有 1 个通道的纹理，因为它是灰度图像。当我将像素传递给 glTexImage2D 时，它显示为红色（显然是因为通道 1 是红色；RGB）。

```
glTexImage2D(
    GL_TEXTURE_2D, 0, GL_RGBA,
    dicomImage->GetColumns(), dicomImage->GetRows(),
    0, GL_RGBA, GL_UNSIGNED_BYTE, pixelArrayPtr); 
```

我要更改 GL_RGBA 吗？如果是这样，该怎么办？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-25T03:32:06.167

将其更改为 GL_LUMINANCE。见[https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glTexImage2D.xhtml](https://www.khronos.org/registry/OpenGL-Refpages/gl4/html/glTexImage2D.xhtml)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-01-08T09:33:20.833

在 FragmentShader 中，您可以编写：

```
uniform sampler2D A;
vec3 result = vec3(texture(A, TexCoord).r); 
```

在cpp文件中，你可以写：

```
glTexImage2D(
    GL_TEXTURE_2D, 0, GL_RED,
    dicomImage->GetColumns(), dicomImage->GetRows(),
    0, GL_RED, GL_UNSIGNED_BYTE, pixelArrayPtr); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T03:32:03.077

看来我应该使用`GL_LUMINANCE`而不是`GL_RGBA`第三个参数。

### 编辑（回复评论）：

当我将第 7 个参数设置为`GL_LUMINANCE`（以及第 3 个）时，图片完全扭曲了。对于 DICOM 像素格式，第 7 个参数似乎`GL_RGBA`出于某种原因。

奇怪的行为是因为我使用的是[DICOM](http://en.wikipedia.org/wiki/Digital_Imaging_and_Communications_in_Medicine)标准。我使用的特定 DICOM 阅读器输出整数像素值（因为像素值可能超过 255 的正常最大值）。出于某种奇怪的原因，告诉 OpenGL 我使用的是 RGBA 格式，但传入整数值的组合呈现了完美的图像。

因为无论如何我都在截断 DICOM > 255 像素值，所以将这些值复制到 GLbyte 数组中似乎是合乎逻辑的。但是，这样做之后，调用`glTexImage2D`. 将第 7 个参数更改为`GL_LUMINANCE`（通常需要）使功能恢复正常。

奇怪吧？

因此，给所有使用 DICOM 图像格式的开发人员的注意事项：您需要将整数数组转换为 char 数组，然后再将其传递给`glTexImage2D`，或者只需将第 7 个参数设置为`GL_RGBA`（可能不推荐使用后者）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-09-09T06:22:21.507

您将`GL_LUMINANCE`在旧版本的 openGL 中使用格式，但现在在现代 3.0+ OpenGL 版本`GL_LUMINANCE`中已弃用，因此新的做法是使用`GL_RED`格式，但这会导致红色纹理，所以要解决这个问题，您应该创建一个costum shader 如上面的答案所示，在该着色器中，您抓取纹理的红色分量，因为它是唯一具有您提供的数据并将绿色/蓝色通道设置为红色通道值的着色器，它将转换为灰度，因为灰度纹理使所有 3 个 RGB 通道相同，并将 Alpha/透明度通道设置为 1。

# com - 从 ActiveX 控件检测 IE 容器

> ID：680138
> 
> 赞同：1
> 
> 时间：2009-03-25T03:36:30.493
> 
> 标签：com, activex

ActiveX 控件检测其容器（或容器的容器）是否为 Internet Explorer 的好方法是什么？

目前，我通过调用控件的 IOleClientSite::GetContainer 方法并检查容器是否实现了 IHtmlDocument2 接口来执行此操作，但是现在，我想检查所有控件的祖先，看看它们是否实现了 IHtmlDocument。

问题是该控件现在包含在 CComCompositeControl 中并使用 CreateActiveXControls(resourceID) 方法创建，该方法将内部控件创建为 CAxHostWindow 实例的子项。在这种情况下，CAxHostWindow 实例将自己报告为自己的容器，所以我还没有找到一种方法来向上走（如果这个模型中有这样的树）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T03:58:42.890

您可能会通过以下陈述获得一些想法，

ActiveX 控件通常可以访问以下容器窗口：

• 框架窗口：容器主菜单所在的最外层容器窗口。ActiveX 控件通过调用 IOleInPlaceFrame::GetWindow 或 IOleInPlaceSite::GetWindowContext 检索此窗口句柄。

• 站点窗口：包含 ActiveX 控件视图的容器窗口。ActiveX 控件通过调用 IOleInPlaceSite::GetWindow 检索此容器窗口。

之后，您可以检查父窗口或同一窗口以找出其文本或其他属性。

在某些情况下，尤其是从 MFC 中，ActiveX 控件成为反射器窗口的子级，其父级是从 IOleInPlaceSite::GetWindow 返回的窗口。在这种情况下，很难得到父母..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T23:53:56.297

所以，我可以想到两种方法。一种方法是获取站点的 IServiceProvider 实现和 QueryService() 以获取仅 IE 实现的某些服务。您可以通过 IE 头文件寻找 SID_S* 直到找到适合您需要的文件。

但是最好的方法（事实上，IE 在内部的方式）是检查进程名称。

```
bool GetProcessName(LPWSTR pszProcessName, DWORD cchProcessName)
{
    bool success = false;
    // GetCurrentProcess() can't fail.
    DWORD cch = GetProcessImageFileName(GetCurrentProcess(), pszProcessName, cchProcessName);
    if (cch > 0)
    {
        LPWSTR pszFileName = PathFindFileName(pszProcessName);
        if (pszFileName)
        {
            wmemmove(pszProcessName, pszFileName, lstrlen(pszFileName) + 1);
        }
        success = true;
    }
    return success;    
} 
```

并查看进程名称是否为“iexplore.exe”。

# linux - 多线程信号量

> ID：680139
> 
> 赞同：1
> 
> 时间：2009-03-25T03:37:07.980
> 
> 标签：linux, multithreading, operating-system, posix

```
#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <string.h>
#include <pthread.h>
#include <semaphore.h>
void *thread_function(void *arg);
sem_t bin_sem;
#define WORK_SIZE 1024
char work_area[WORK_SIZE];
int main() {
    int res;
    pthread_t a_thread;
    void *thread_result;
    res = sem_init(&bin_sem, 0, 0);
    if (res != 0) {
        perror(“Semaphore initialization failed”);
        exit(EXIT_FAILURE);
    }
    res = pthread_create(&a_thread, NULL, thread_function, NULL);
    if (res != 0) {
        perror(“Thread creation failed”);
        exit(EXIT_FAILURE);
    }
    printf(“Input some text. Enter ‘end’ to finish\n”);
    while(strncmp(“end”, work_area, 3) != 0) {
        fgets(work_area, WORK_SIZE, stdin);
        sem_post(&bin_sem);
    }
    printf(“\nWaiting for thread to finish...\n”);
    res = pthread_join(a_thread, &thread_result);
    if (res != 0) {
        perror(“Thread join failed”);
        exit(EXIT_FAILURE);
    }
    printf(“Thread joined\n”);
    sem_destroy(&bin_sem);
    exit(EXIT_SUCCESS);
}
void *thread_function(void *arg) {
    sem_wait(&bin_sem);
    while(strncmp(“end”, work_area, 3) != 0) {
         printf(“You input %d characters\n”, strlen(work_area) -1);
         sem_wait(&bin_sem);}
    pthread_exit(NULL);
} 
```

在上面的程序中，当使用 sem_post() 释放信号量时，线程函数中的 fgets 和计数函数是否有可能同时执行。而且我认为该程序未能允许第二个线程在主线程读取之前对字符进行计数再次敲击键盘。那正确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T03:51:15.590

第二个线程只会在 sem_wait 返回后读取字符，这表明 sem_post 已在某处被调用，所以我认为这很好。

至于 fgets 和 count 函数，这两者可以同时运行。

在这种情况下，我建议对 work_area 变量使用互斥锁，因为如果用户在一个线程中编辑变量而在另一个线程中读取该变量，则会出现问题。

您可以使用互斥锁，也可以使用信号量并将其初始计数设置为 1。

但是，如果您实现互斥锁或使用类似的信号量，请确保将 mutex_lock 放在 sema_wait 之后，否则可能会发生死锁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T04:00:44.723

在此示例中，您希望在共享内存的读写周围有一个互斥锁。

我知道这是一个例子，但下面的代码：

```
fgets(work_area, WORK_SIZE, stdin); 
```

真的应该是：

```
fgets(work_area, sizeof(work_area), stdin); 
```

如果您将来更改 work_area 的大小（更改为其他常数等），很可能会错过更改第二个 WORK_SIZE 的情况。

# asp.net - 如何在 Asp.net 中找到主题文件夹？

> ID：680140
> 
> 赞同：2
> 
> 时间：2009-03-25T03:37:45.093
> 
> 标签：asp.net

我正在动态绑定一些图像控件，但不设置图像 URL。当我使用皮肤文件然后设置 SkinId 时，我收到以下错误：

```
The 'SkinId' property can only be set in or before the Page_PreInit event for static controls. For dynamic controls, set the property before adding it to the Controls collection. 
```

如何获取虚拟主题的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T03:46:27.333

在标记上设置 SkinId

```
<asp:Image runat="server" id="LogoImage" SkinId="LogoImage" /> 
```

要以编程方式设置它，您需要在 PreInit 事件上进行设置

```
public void Page_PreInit(object sender, EventArgs e)
{
  LogoImage.SkinID = "LogoImage";
} 
```

这是一篇关于以编程方式设置 SkinId 的博客文章 [http://blogs.conchango.com/simonevans/archive/2005/06/09/How-to-programmatically-assign-a-SkinID-to-a-control-while -使用-a-master-page-in-ASP.net-2.0.aspx](http://blogs.conchango.com/simonevans/archive/2005/06/09/How-to-programmatically-assign-a-SkinID-to-a-control-while-using-a-master-page-in-ASP.net-2.0.aspx)

最后，如果您只是在寻找文件夹，这取决于您使用的是[Theme](http://msdn.microsoft.com/en-us/library/system.web.ui.page.theme.aspx)还是[StylesheetTheme](http://msdn.microsoft.com/en-us/library/system.web.ui.page.stylesheettheme.aspx)。

```
var path = "~/App_Themes/" + Page.Theme + "/images";
var path = "~/App_Themes/" + Page.StylesheetTheme + "/images"; 
```

## 更新

如果您在 Grid 中执行此操作，请使用自定义绑定方法

```
<asp:Image runat="server" id="myImage" ImageUrl='<%# GetThemedImage(((Product)Container.DataItem).Image)%>' /> 
```

然后在代码隐藏中

```
public string GetThemedImage(string image)
{
     return "~/App_Themes/" + Page.Theme + "/images/" + image;
} 
```

# ruby-on-rails - ActiveRecord - 查询多态关联

> ID：680141
> 
> 赞同：51
> 
> 时间：2009-03-25T03:37:45.560
> 
> 标签：ruby-on-rails, ruby, activerecord, polymorphic-associations

我正在使用多态关联来跟踪我的项目中的评论。所有非常直接的东西。

我遇到的问题是基于多态关联进行查询并从评论模型加入到它的所有者。

所以 ...

我有一个评论模型

```
class Comment < ActiveRecord::Base
  belongs_to :commentable, :polymorphic => true
end 
```

还有一个 ForumTopics 模式：

```
class ForumTopic < ActiveRecord::Base
  has_many :comments, :as => :commentable
end 
```

我还有其他几个现在不重要的“可评论”模型。所有这些都有效。

我要做的是找到属于具有指定条件的 ForumTopic 的所有评论（在这种情况下，'featured' == true）。

当我尝试使用查找器加入模型时：

```
@comments = Comment.find(:all 
            :joins => :commentable
            :conditions => ["forum_topics.featured = ? ", true] 
            ) 
```

我收到以下错误：

> *不能急切地加载多态关联：commentable*

使用 AR“包含语法”：

```
@comments = Comment.find(:all 
            :include => :forum_topics
            :conditions => ["forum_topics.featured = ? ", true] 
            ) 
```

返回：

> *未找到名为“forum_topics”的关联；也许你拼错了？*

如果我尝试使用表名而不是关联名称（字符串而不是符号）加入：

```
@comments = Comment.find(:all,
            :joins => "forum_topics",
            :conditions => ["forum_topics.featured = ? ", true] 
            ) 
```

我懂了：

> *Mysql::Error: Unknown table 'comments': SELECT comments。*来自评论 forum_topics WHERE (forum_topics.featured = 1)*

（您可以在此处看到底层查询的语法完全关闭，并且完全缺少连接）。

不确定我正在做的事情是否可行，还有其他方法可以达到所需的结果，但似乎*应该*是可行的。

有任何想法吗？有什么我想念的吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-25T03:59:40.343

啊！

我想我找到了问题所在。

通过以下方式加入时：

```
@comments = Comment.find(:all,
        :joins => "forum_topics",
        :conditions => ["forum_topics.featured = ? ", true] 
        ) 
```

你需要整个加入！

```
:joins => "INNER JOIN forum_topics ON forum_topics.id = comments.commentable_id", 
```

看到令人敬畏的：http: [//guides.rubyonrails.org/active_record_querying.html#joining-tables](http://guides.rubyonrails.org/active_record_querying.html#joining-tables)

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2015-08-10T07:31:02.040

一个老问题，但有一种更简洁的方法可以通过为特定类型与多态建立直接关联来实现这一点：

```
#comment.rb
class Comment < ActiveRecord::Base

  belongs_to :commentable, polymorphic: true
  belongs_to :forum_topics, -> { where( comments: { commentable_type: 'ForumTopic' } ).includes( :comments ) }, foreign_key: 'commentable_id'

  ...

end 
```

然后，您可以摆脱对混乱连接的需要`:forum_topics`：`includes`

```
@comments = Comment
  .includes( :forum_topics )
  .where( :forum_topics => { featured: true } ) 
```

然后，您可以通过将查询移动到范围来进一步清理它：

```
#comment.rb
class Comment < ActiveRecord::Base

  ...

  scope :featured_topics, -> { 
    includes( :forum_topics )
    .where( :forum_topics => { featured: true } ) 
  }

  ...

end 
```

让你能够简单地做

```
@comments = Comment.featured_topics 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2014-04-10T17:38:03.770

## 你需要一个有条件的 Plus Rails 3+

很多人在答案和评论中都提到了这一点，但我觉得包括我自己在内的人，如果他们来到这里并且没有仔细阅读，就会被绊倒。

所以，这是正确的答案，包括**绝对**必要的条件。

```
@comments = Comment.joins( "INNER JOIN forum_topics ON comments.commentable_id = forum_topics.id" )
                   .where( comments:     { commentable_type: 'ForumTopic' } )
                   .where( forum_topics: { featured:         true         } ) 
```

*感谢所有人，尤其是 @Jits、@Peter 和 @prograils 的评论。*

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2017-07-20T13:26:31.000

检查在**Rails 5**下工作：

**解决方案1：**

```
@comments = Comment
              .where(commentable_type: "ForumTopic")
              .joins("INNER JOIN forum_topics ON comments.commentable_id = forum_topics.id")
              .where(forum_topics: {featured: true})
              .all 
```

或者

**解决方案2：**

```
@comments = Comment
              .joins("INNER JOIN forum_topics ON comments.commentable_id = forum_topics.id AND comments.commentable_type = 'ForumTopic'")
              .where(forum_topics: {featured: true}).all 
```

注意原始 SQL 语法：不允许使用反引号。请参阅[http://guides.rubyonrails.org/active_record_querying.html#joining-tables](http://guides.rubyonrails.org/active_record_querying.html#joining-tables)。

我个人更喜欢解决方案 1，因为它包含更少的原始 SQL 语法。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-08-11T14:32:47.520

一旦您使用“可评论”引入另一个具有关联的模型，接受的解决方案就不起作用。commentable_id 不是唯一的，因此您将开始检索错误的评论。

例如：

您决定添加一个接受评论的新闻模型...

```
class News < ActiveRecord::Base
   has_many :comments, :as => :commentable
end 
```

现在，如果您使用查询对 id 为 1 的 forum_topic 和 id 为 1 的新闻文章发表评论，您可能会得到两条记录：

```
:joins => "INNER JOIN forum_topics ON forum_topics.id = comments.commentable_id" 
```

您可能可以通过提供 commentable_type 作为您的条件之一来解决问题，但我认为这不是解决此问题的最佳方法。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2012-02-23T19:07:45.383

我遇到了这篇文章，它引导我找到了我的解决方案。使用 commentable_type 作为我的条件之一，但使用 LEFT OUTER JOIN 代替。这样，没有评论的论坛主题将被包括在内。

```
LEFT OUTER JOIN `comments` ON `comments`.`commentable_id` = `forum_topics`.`id` AND `comments`.`commentable_type` = 'ForumTopic' 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-09-23T08:37:12.943

这是一个适应您的目的的示例。

```
class AdwordsCampaign < ApplicationRecord
  has_many :daily_campaign_reports, as: :ga_campaign
end

class DailyCampaignReport < ApplicationRecord

  belongs_to :ga_campaign, polymorphic: true

  # scope
  def self.joins_ga_campaign(model)
    models = model.to_s.pluralize
    sql = <<~SQL
      INNER JOIN #{models}
      ON #{models}.id = daily_campaign_reports.ga_campaign_id
    SQL
    joins(sql).where(ga_campaign_type: model.to_s.camelize)
  end
end 
```

然后我可以在任何需要的地方使用它，如下所示：

```
DailyCampaignReport.joins_ga_campaign(:adwords_campaign) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-04-10T07:35:28.137

默认情况下，Rails 不包含多态连接，但这个 gem 可以帮助您轻松地连接多态关系。[https://github.com/jameshuynh/polymorphic_join](https://github.com/jameshuynh/polymorphic_join)

# c# - 为什么 DataBinding 第二次不起作用？

> ID：680142
> 
> 赞同：6
> 
> 时间：2009-03-25T03:37:55.107
> 
> 标签：c#, winforms, data-binding, datasource, bindingsource

更改 BindingSource 的数据源时出现的错误

“数据绑定找不到适合所有绑定的行 适合所有绑定的行”

```
 this.RemoveAllBindings(); // My work-around for the meantime

        bdsOrder.DataSource = _ds.Tables["orders"]; // errors here on second time around(first time is blank datatable, second time is when i open existing record, then it errors), dataset comes from Remoting
        bdsOrderDetail.DataSource = _ds.Tables["order_detail"];

        bdsPhoto.DataSource = _ds.Tables["order_photo"];
        bdnPhoto.BindingSource = bdsPhoto; 
```

我的 Helper 扩展方法解决了令人困惑的“数据绑定找不到行...”错误。

```
namespace MycComponentExtension
{
    public static class Helper
    {
        public static void RemoveAllBindings(this Form form)
        {
            RemoveAllBindings((Control)form);
        }

        private static void RemoveAllBindings(this Control root)
        {
            foreach (Control c in root.Controls)
            {
                if (c.Controls.Count > 0) RemoveAllBindings(c);

                root.DataBindings.Clear();
            }
        } 
```

“DataBinding 找不到行...”错误是什么意思，如果可能的话，我可以消除我的解决方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T04:53:28.140

当不涉及 DataGridView 时，我看到了这个错误，但是我的数据源正在从另一个线程更新（淘气！）并且我的绑定有 FormattingEnabled=false。改变这两个似乎可以解决问题。

# nhibernate - NHibernate Fluent 与属性

> ID：680147
> 
> 赞同：14
> 
> 时间：2009-03-25T03:40:34.320
> 
> 标签：nhibernate, fluent-nhibernate, attributes, nhibernate-mapping

我有兴趣将一些 NHibernate 配置/映射移动到代码中以帮助解决一些维护问题。谁能提供 Fluent NHibernate 与 NHibernate.Mapping.Attributes 的任何建议/优点/缺点/比较？

我对 Java Hibernate 注释有一些经验，我很喜欢，但我很好奇 NHibernate 属性是否具有可比性，以及 Fluent 是否提供了任何应该考虑的主要优点/缺点。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-25T08:54:02.257

我认为没有人做过任何直接的比较。它归结为您对使用属性装饰实体的舒适程度。Fluent NHibernate 旨在让您将 NHibernate 与完全无污染的模型一起使用，而属性则要求您更改实体；这是泄漏到您的域中的持久性问题。这对您来说是否是个问题是您是否应该选择属性。

除了映射之外，Fluent NHibernate 还提供了更多的东西。还有[自动映射](http://wiki.fluentnhibernate.org/show/AutoMapping)允许您自动映射您的域。[约定支持](http://wiki.fluentnhibernate.org/show/Conventions)可以让您大大减少设计中的重复。我不会重复所有内容，但您可以在[Fluent NHibernate wiki](http://wiki.fluentnhibernate.org)上阅读更多内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-05T12:08:02.157

NHibernate 现在支持 JPA（在 .NET 平台上称为 NPersistence 或 NPA），包括 JPA 注释。这是映射您的实体并使您的代码也可移植给其他供应商的最佳方式。看看这个：

[www.npersistence.com](http://www.npersistence.org/)

# java - 在 Mac OS X 中运行 .exe 文件

> ID：680155
> 
> 赞同：2
> 
> 时间：2009-03-25T03:48:21.743
> 
> 标签：java, macos, exe

我是一名**Mac 用户**，想要使用 Process 和 Runtime 类从我的 Java 进程中运行一些**.exe 文件。**

我知道在**Mac OS X中通常****无法**执行 .exe 文件。

 **是否有可以包装这些 .exe 文件以便执行它们的 Mac 应用程序？苹果自己提供什么吗？

我现在使用的替代方法是在 Windows 中运行 Java 进程。然而，它一般来说很麻烦。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T03:56:40.240

[达尔文](http://darwine.sourceforge.net/)

编辑：我可能应该指出这不是 100% 的解决方案。通过 Parallels 或一些类似的虚拟化软件，虚拟化的 Windows 几乎总能更好地工作。但 Darwine 是免费的，并且可以正常运行大多数 Windows 软件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T04:05:55.633

除了 wine，您还可以获得[VirtualBox](http://www.virtualbox.org/)（免费）、[Parallels](http://www.parallels.com/products/desktop/)（$$$）或[VMWare](https://www.vmware.com/products/fusion/)（$$$）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T04:18:53.900

好吧，如果它是一个 .NET 应用程序，那么您可以使用 Mono 运行它，但我敢打赌它是本机二进制文件，您必须使用上述 Wine 之类的东西。我第一次在 OSX 上使用 Mono 运行 .exe 时觉得这真的很酷，只是感觉不对，所以我不得不分享。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T03:49:55.343

我不知道它是否存在，但你需要像用于 OSX 的 wine 之类的东西。原因是 .exe 几乎肯定会使用操作系统特定的系统调用和库函数。

**编辑：**看起来它[确实存在](http://wiki.winehq.org/MacOSX)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-02-05T12:47:13.447

java -jar file.exe 和 monofile.exe 都在 MACOS 上本地工作，带有本地 MACOS java 和 mono

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-19T12:27:00.103

[1) 从http://winebottler.kronenberg.org/](http://winebottler.kronenberg.org/)安装 Wine 和 Winebottler

2）您可能需要更改系统偏好设置>安全和隐私>允许从>任何地方下载的应用程序

2)点击xyz.exe并选择winebottler运行应用程序

# version-control - 是否可以在 ClearCase 配置规范中使用变量？

> ID：680162
> 
> 赞同：3
> 
> 时间：2009-03-25T03:51:21.267
> 
> 标签：version-control, clearcase, wildcard, config-spec

例如，而不是编写以下内容：

```
element * .../my_branch_01/LATEST
element * .../base_branch/LATEST -mkbranch my_branch_01 
```

我想写这样的东西：

```
MY_BRANCH=my_branch_01
element * .../%MY_BRANCH%/LATEST
element * .../base_branch/LATEST -mkbranch %MY_BRANCH% 
```

这甚至可能吗？什么是正确的语法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T05:01:42.427

在 ClearCase 中执行此操作的唯一本地方法是在**[config-spec](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/config_spec.htm)****中使用属性**。

根据[版本选择器](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/version_selector.htm)规则，您可以制定“通过查询选择”规则，例如基于属性：

```
element * ...{MY_ATTRIBUTE_NAME=="aValue"} 
```

`LATEST`将在任何具有属性“ `MY_ATTRIBUTE_NAME`”的分支上选择版本，其中包含“ `aValue`”。

这意味着您需要更改旧分支上的属性值，将其放在新分支上，`cleartool setcs`再次''您的视图，并且您应该具有基于新版本选择的新内容。

不是很直接，但它可以工作，***除了 mkbranch 部分***（需要固定名称）。

* * *

关于[GeekCyclist 的回答](https://stackoverflow.com/questions/680162/wildcards-or-placeholders-in-clearcase-config-specs-possible/680219#680219)，有几点评论：

包含通用配置规范的解决方案适用于 Base ClearCase 解决方案，但是：

*   需要由所有相关开发人员共享
*   setcs确实需要 Ccuses view_server 刷新其缓存并重新评估当前配置规范，该配置规范存储在视图存储目录中的文件 config_spec 中**[。](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/ct_setcs.htm)**这包括：
    *   使用非绝对规范评估时间规则（例如，现在、星期二）
    *   重新评估 –config 规则，可能选择与以前不同的派生对象
    *   **重新读取包含规则中命名的文件**
*   当通用包含的配置规范文件更改时，需要通知所有其他开发人员（ClearCase 中不包含本机通知）

* * *

如果您需要一个“环境”（即一个“视图”或工作区）和一个可变内容（取决于不同的分支），您需要定义一个指向不同视图的符号链接（或 windows subst）（每个视图都有他们自己的配置规范）

这样，您只需更改链接（或替换的路径）即可更改与给定*固定*路径关联的配置规范。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T04:31:08.553

自从我在 ClearCase 工作（我们切换到 Subversion）已经有一段时间了，但如果我没记错的话，没有办法在 ClearCase 本地执行此操作。

您可以使用或编写一个脚本生成器来创建您的规范文件，然后将其包含在实际规范中：

```
element * CHECKEDOUT
include scripted_file_output 
```

然后运行

```
cleartool setcs -current 
```

这种方法的问题在于，我认为无论何时更改 MY_BRANCH 的值，都需要重新生成包含规范，并且 cleartool setcs 会运行。

# java - 为什么 IcedTea6 不编译 Java 1.5 特定代码？

> ID：680169
> 
> 赞同：1
> 
> 时间：2009-03-25T03:58:23.233
> 
> 标签：java, icedtea

我跑了：

```
javac Perf.java

```

并得到：

```
ERROR in Prefs.java (at line 36)

HashMap<String, String> map = new HashMap<String, String>();
        ^^^^^^^^^^^^^^
Syntax error, parameterized types are only available if source level is 1.5 
```

当我输入：`java -version` 我得到：

```
java版本“1.6.0_0”
IcedTea6 1.4 (fedora-11.b14.fc10-i386) 运行时环境 (build 1.6.0_0-b14)
OpenJDK 客户端 VM（内部版本 14.0-b08，混合模式）

```

`javac -version`得到我：

```
Eclipse Java 编译器 0.883_R34x，3.4.1 版，版权所有 IBM Corp 2000, 2008。保留所有权利。

```

这是 Fedora 10 的全新安装。这个 icedtea 业务是什么？为什么 Java 编译器默认使用 Eclipse 编译器？有人解释这种疯狂...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T04:02:08.823

检查您的 $PATH 变量。听起来您的“java”可执行文件在一个地方，而“javac”在其他地方。

在命令行上尝试“where”或“which”命令 - 这将告诉您 shell/OS 将每个可执行文件定位在哪里：

```
which java
which javac 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T21:09:24.473

Fedora 默认使用开源软件。Icedtea 是对 OpenJDK 的 redhat 改编，完全开源。Eclipse 编译器是目前最好的开源命令行 java 编译器，但默认情况下它似乎不是为 Java 6 编译的。

试试“javac -help”看看你有什么选择。它可能只是一个需要调整的简单环境变量。

# c# - 对 LinkLabel 控件使用键盘快捷键

> ID：680174
> 
> 赞同：7
> 
> 时间：2009-03-25T04:00:50.950
> 
> 标签：c#, winforms, keyboard-shortcuts, linklabel

我注意到在标准 .NET WinForms 表单中分配给链接标签控件的键盘快捷键不起作用。

我创建了一个 LinkLabel 控件实例并将 Text 属性指定为“Select &All”。对于大多数控件（标签、按钮、单选按钮等），这将导致`Alt`+`A`成为触发默认事件（单击）的指定键盘快捷键。LinkLabel 不会发生这种情况（尽管其他控件可以正常工作）

*   我已验证键盘快捷键不是重复的。
*   我检查了快捷方式是否设置焦点而不是触发 Clicked。重点保持不变。
*   我已验证 UseMnemonic 属性设置为 true。

有任何想法吗？

* * *

## 解决方案

谢谢查理的正确答案。正是我需要的。我做了一些修改，因为这个代码片段不会按原样编译。`LinkLabelLinkClickedEventArgs`需要 a`LinkLabel.Link`作为构造参数而不是感谢 a `LinkLabel`。

```
class LinkLabelEx : LinkLabel
{
    protected override bool ProcessMnemonic(char charCode)
    {
        if (base.ProcessMnemonic(charCode))
        {
            if (this.Links.Count == 0)
                return false;
            OnLinkClicked(new LinkLabelLinkClickedEventArgs(this.Links[0]));
            return true;
        }
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-25T04:14:21.727

我相信这只是 LinkLabel 的一个缺点；当您使用它的助记符时，它不会生成点击事件。但是，我使用以下代码作为解决方法并取得了很好的效果：

```
class BetterLinkLabel : LinkLabel
{
  protected override bool ProcessMnemonic( char charCode )
  {
    if( base.ProcessMnemonic( charCode ) )
    {
      // TODO: pass a valid LinkLabel.Link to the event arg ctor
      OnLinkClicked( new LinkLabelLinkClickedEventArgs( null ) );
      return true;
    }
    return false;
  }
} 
```

# java - MacOSX 上的 Netbeans IDE 问题

> ID：680175
> 
> 赞同：3
> 
> 时间：2009-03-25T04:01:09.827
> 
> 标签：java, netbeans

几周前，我在 Mac OS X 上安装了 Netbeans IDE。在编写 Java 代码时的代码完成窗口中，我总是得到可能的代码完成的正确完整列表，但是在弹出的窗口中，它应该显示每个可能完成的 JDK 文档条目（所有详细信息），它总是说找不到那个JDK文档！当我在 Windows 上工作时，这从未发生在我身上。

我什至下载了 JDK 文档库并将其显式添加到 Netbeans 库，但没有用。有人遇到过这样的问题吗？请帮忙！提前非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T01:05:59.287

好吧，因为没有其他人回答，我也遇到了同样的问题，但没有足够的动力去解决它，所以我找到了解决方法......看[这里](http://weblogs.java.net/blog/joshy/archive/2006/04/how_to_get_code.html)。

我所做的唯一更改是使用最新的 JavaDoc 而不是 1.5，并在步骤 3 中使用 Java 平台（我使用的是 Netbeans 6.5，我猜菜单结构从他做的时候开始改变了）。

# java - 在哪里停止/销毁 Android Service 类中的线程？

> ID：680180
> 
> 赞同：38
> 
> 时间：2009-03-25T04:04:24.747
> 
> 标签：java, android, multithreading, service

我通过以下方式创建了一个线程服务：

```
public class TCPClientService extends Service{  
...

@Override
public void onCreate() {
    ...
    Measurements = new LinkedList<String>();
    enableDataSending();    
}

@Override
public IBinder onBind(Intent intent) {
    //TODO: Replace with service binding implementation
    return null;
}

@Override
public void onLowMemory() {
    Measurements.clear();
    super.onLowMemory();
}

@Override
public void onDestroy() {
    Measurements.clear();
    super.onDestroy();
    try {
        SendDataThread.stop();
    } catch(Exception e){
        ...     
    }

}

private Runnable backgrounSendData = new Runnable() {

    public void run() {
        doSendData();
    }
};

private void enableDataSending() {
    SendDataThread = new Thread(null, backgrounSendData, "send_data");
    SendDataThread.start();
}

 private void addMeasurementToQueue() {
     if(Measurements.size() <= 100) {
         String measurement = packData();
         Measurements.add(measurement);
     }
 }

 private void doSendData() {
     while(true) {
         try {      
             if(Measurements.isEmpty()) {
                 Thread.sleep(1000);
                 continue;
             }
             //Log.d("TCP", "C: Connecting...");
             Socket socket = new Socket();
             socket.setTcpNoDelay(true);
             socket.connect(new InetSocketAddress(serverAddress, portNumber), 3000);
             //socket.connect(new InetSocketAddress(serverAddress, portNumber));
             if(!socket.isConnected()) {
                 throw new Exception("Server Unavailable!");
             }
             try {
                 //Log.d("TCP", "C: Sending: '" + message + "'");
                 PrintWriter out = new PrintWriter( new BufferedWriter( new OutputStreamWriter(socket.getOutputStream())),true);
                 String message = Measurements.remove();
                 out.println(message);
                 Thread.sleep(200);
                 Log.d("TCP", "C: Sent.");
                 Log.d("TCP", "C: Done.");
                 connectionAvailable = true;              
             } catch(Exception e) {
                 Log.e("TCP", "S: Error", e);
                 connectionAvailable = false;
             } finally {
                 socket.close();
                 announceNetworkAvailability(connectionAvailable);
             }
         } catch (Exception e) {
             Log.e("TCP", "C: Error", e);
             connectionAvailable = false;
             announceNetworkAvailability(connectionAvailable);
         }
    }
}

...
} 
```

关闭应用程序后，手机运行速度非常慢，我猜这是由于线程终止失败。

有谁知道在终止应用程序之前终止所有线程的最佳方法是什么？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-03-26T16:36:59.033

**附录**：Android 框架为一次性工作、后台工作等提供了许多帮助程序，这可能比在许多情况下尝试滚动您自己的线程更可取。如下文所述，AsyncTask 是一个很好的起点。我鼓励读者在开始考虑自己的线程之前先查看框架规定。

您发布的代码示例中存在几个问题，我将按顺序解决：

1) Thread.stop() 已经被弃用了一段时间，因为在某些情况下它会使因变量处于不一致的状态。有关更多详细信息，请参阅[此 Sun 答案页面](http://java.sun.com/j2se/1.4.2/docs/guide/misc/threadPrimitiveDeprecation.html)（编辑：该链接现已失效，请参阅[此页面了解为什么不使用 Thread.stop()](https://www.securecoding.cert.org/confluence/display/java/THI05-J.+Do+not+use+Thread.stop()+to+terminate+threads)）。停止和启动线程的首选方法如下（假设您的线程将无限期地运行）：

```
private volatile Thread runner;

public synchronized void startThread(){
  if(runner == null){
    runner = new Thread(this);
    runner.start();
  }
}

public synchronized void stopThread(){
  if(runner != null){
    Thread moribund = runner;
    runner = null;
    moribund.interrupt();
  }
}

public void run(){
  while(Thread.currentThread() == runner){
    //do stuff which can be interrupted if necessary
  }
} 
```

这只是如何停止线程的一个示例，但要点是您负责退出线程，就像您使用任何其他方法一样。维护一种跨线程通信的方法（在这种情况下是一个 volatile 变量，也可以通过互斥锁等）并在您的线程逻辑中，使用该通信方法来检查您是否应该提前退出、清理等。

2）您的测量列表由多个线程（事件线程和您的用户线程）同时访问，没有任何同步。看起来您不必滚动自己的同步，您可以使用[BlockingQueue](http://developer.android.com/reference/java/util/concurrent/BlockingQueue.html)。

3）您在发送线程的每次迭代中都创建一个新的 Socket。这是一个相当重量级的操作，只有在您期望测量非常罕见（比如一小时或更少）时才真正有意义。要么你想要一个不会在线程的每个循环中重新创建的持久套接字，要么你想要一个一次性可运行的，你可以“触发并忘记”它创建一个套接字、发送所有相关数据并完成。（关于使用持久 Socket 的快速说明，阻塞的套接字方法，例如读取，不能被 Thread.interrupt() 中断，所以当你想停止线程时，你必须关闭套接字以及调用中断）

4）除非您希望在其他地方捕获它，否则从 Thread 中抛出您自己的异常没有什么意义。更好的解决方案是记录错误，如果无法恢复，则停止线程。线程可以使用如下代码停止自身（在与上述相同的上下文中）：

```
public void run(){
    while(Thread.currentThread() == runner){
      //do stuff which can be interrupted if necessary

      if(/*fatal error*/){
        stopThread();
        return; //optional in this case since the loop will exit anyways
      }
    }
  } 
```

最后，如果您想确保线程与应用程序的其余部分一起退出，无论如何，一个好的技术是在创建之后和启动线程之前调用 Thread.setDaemon(true)。这会将线程标记为守护线程，这意味着如果没有非守护线程在运行（例如，如果您的应用程序退出），VM 将确保它自动销毁。

遵循有关线程的最佳实践应确保您的应用程序不会挂起或减慢电话速度，尽管它们可能非常复杂:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-10T12:58:19.157

实际上，您不需要如上所述的“runner”变量，例如：

```
while (!interrupted()) {
    try {
        Thread.sleep(1000);
    } catch (InterruptedException ex) {
        break;
    }
} 
```

但一般来说，坐在 Thread.sleep() 循环中是一个非常糟糕的主意。

查看新的 1.5 API 中的 AsyncTask API。它可能会比使用服务更优雅地解决您的问题。你的手机变慢了，因为服务永远不会关闭 - 没有什么会导致服务自行终止。

# compiler-construction - 构建预测解析器和解析表

> ID：680182
> 
> 赞同：1
> 
> 时间：2009-03-25T04:05:40.033
> 
> 标签：compiler-construction, parsing

我正在尝试为以下语法构建解析器（龙书 ex. 4.4.1 pg. 231）：

```
S -> 0 S 1 | 0 1 
```

所以首先我离开了语法并得到：

```
S  -> 0 S'
S' -> S 1 | 1 
```

并构造解析表产生：

```
 +-----------+---------+--------+
     |     0     |    1    |    $   |
-----+-----------+---------+--------+
  S  | S -> 0 S' |         |        |
-----+-----------+---------+--------+
  S' | S' -> S 1 | S' -> 1 |        |
-----+---------------------+--------+ 
```

$（输入结束）符号没有任何条目可以吗？在这种情况下，预测解析器如何执行解析？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-11-07T02:16:49.047

YES, because S and S'do not accept the empty symbol.

consider:

```
S->0S' 
S'->0S|1
S-> empty 
```

your table will be:

```
---------------------------------
   | 0     | 1      | $         |
---------------------------------
S  | S->0S'|        | S-> empty |
---------------------------------
S' | S'->S1| S'->1  |           |
--------------------------------- 
```

You can watch this video: [http://www.youtube.com/watch?v=E4to0HuZh3Q](http://www.youtube.com/watch?v=E4to0HuZh3Q)

# language-features - 三值变量，最大值、最小值、实际值

> ID：680185
> 
> 赞同：3
> 
> 时间：2009-03-25T04:08:49.650
> 
> 标签：language-features, expert-system

很久以前，我使用专家系统语言 Egeria 开发系统。它有一个非常有用的功能，其中变量具有三个值，最小值、最大值和电流。以这种方式，可以计算部分已知值的概率，结果以一个范围结束。我不记得语法，但它是这样的：-

```
A.Min = 1;
A.Max = 5;
A.Current= 4;
B.Min = 2;
B.Max = 4;
B.Current= 4;

A * B = {2, 20, 16} 
```

我的问题是，这种方法叫什么，当前的语言是否实现了它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T04:41:50.850

听起来，作为一种“方法”，它可能是一种[模糊逻辑](https://stackoverflow.com/questions/399618/what-is-fuzzy-logic)。特别是当您描述它被概率使用时。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T05:56:37.347

像您描述的那样的多值变量可以用于基于约束的编程。对于最近的一篇论文，请参阅 Radul 和 Sussman，[“传播者的艺术”](http://dspace.mit.edu/handle/1721.1/44215 "传播者的艺术")。

Radul 先生上周在 ILC 2009 上发表了演讲。他举了一个（人们可能会考虑的）多值变量的例子，这些变量代表了对“真相”的概率近似。（对于任何不实陈述，我提前道歉，我没有笔记。）

考虑一个必须协调来自两个热传感器的读数的系统。进一步假设每个传感器的读数都带有某种程度的不确定性：传感器 A 表示温度介于 A1 和 A2 之间，传感器 B 表示温度介于 B1 和 B2 之间。系统是否应该在尝试计算温度时失败？也许“真相”可以用读数重叠的范围来表达。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T06:38:31.443

关于 Yacc 的原始论文的附录 C（发表于版本 7 的 UNIX 程序员手册的第 2 卷；该论文的日期为 1978-07-31）描述了一个“进行浮点区间运算的桌面计算器”。它使用带有符号 '( min, max )' 的区间并实现了基于范围的算术。您所描述的也是“当前”值的扩展。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T04:11:39.737

大多数面向对象的语言使用类可以很容易地做到这一点。

例如，在 C++ 中，很容易创建一个模板类来为您处理任何基本类型。

不过，我不知道有任何语言支持它作为核心语言的一部分。

# javascript - Javascript：如何阻止退格字符？

> ID：680186
> 
> 赞同：10
> 
> 时间：2009-03-25T04:09:32.847
> 
> 标签：javascript

我不希望我网站的用户使用退格键转到上一页，
但我仍然希望保留退格键的使用，
就像删除错误的输入一样。
我能怎么做？

非常感谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T05:41:18.790

正如其他人所提到的，您可以通过一些方法监视退格键事件并执行不同的操作。

我建议不要使用退格键，原因如下：

1）这很烦人，被激怒的用户可能不会返回您的页面。

2）退格不是返回上一页的唯一方法。还有其他组合键可以完成同样的事情，还有明显的“后退按钮”。

不要这样做 - 但如果必须，请使用 onbeforeunload() 而不是捕获浏览器特定的击键。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-06-02T17:51:16.533

**解决方案**：将以下代码放在所有包含表单的页面的末尾：

```
<!-- Block the Backspace and Enter keys in forms, outside of input texts and textareas -->
<script type="text/javascript">
    function blockBackspaceAndEnter(e) {
        if (!e) { // IE reports window.event instead of the argument
            e = window.event;
        }
        var keycode;
        if (document.all) {
            // IE
            keycode = e.keyCode;
        } else {
            // Not IE
            keycode = e.which;
        }
        // Enter is only allowed in textareas, and Backspace is only allowed in textarea and input text and password
        if ((keycode == 8
                && e.srcElement.type != "text"
                && e.srcElement.type != "textarea"
                && e.srcElement.type != "password")
                || (keycode == 13 && e.srcElement.type != "textarea")) {
            e.keyCode = 0;
            if (document.all) {
                // IE
                event.returnValue = false;
            } else {
                // Non IE
                Event.stop(e);
            }
        }
    }
    for (var i = 0; i < document.forms.length; i++) {
        document.forms[i].onkeydown = blockBackspaceAndEnter;
    }
</script> 
```

对于其他人之前在这里的回答，我有以下评论：

有人说：

> “请不要。用户喜欢退格返回；返回是最重要的浏览器功能之一，打破它是不可容忍的粗鲁。”

我对他的回答是：

**是的，通常人们确实使用后退按钮返回，但不是在带有表单的页面上。**另一方面，人们很容易*不小心在输入文本或文本区域附近或外部单击*，然后按后退按钮，因此他们将丢失所有编辑，正如其他人也注意到的那样：

> “用户不在文本框中并按退格键，完全丢失了他们刚刚输入的所有表单信息。通常不会有问题，但对我们来说，我们在长状态表单上填写了大量文本。 "

**对于提交表单**的 Enter 键也可以说同样的*不良行为*，这通常只适用于具有少量字段的小型表单（如果有的话），但不适用于具有许多字段和选择框、输入框和文本区域的表单，在大多数情况下，您不希望在按 Enter 时提交表单。

 **所以这就是为什么我建议上面的代码，它适用于 webster 建议的函数的所有 <FORM> 标签，但没有对 ALT 的检查，我认为这没有用，也没有对 CTRL+N 和 CTRL 的检查+R 和 CTRL+F5，我们不想阻止它们，因为它们在使用时并非偶然。

不幸的是，**当您的 FORM 中有 DIV 和 TABLE 时，上面的代码在 Firefox 中不起作用**！那是因为 keydown 事件似乎没有传播到包含表单，而是默认（不希望！）行为应用于 Backspace 和 Enter 键。我还没有找到解决这个问题的方法...

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-25T04:40:27.983

您可以使用 body 标记上的“onbeforeunload”属性来提示用户他正在离开页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-24T06:13:45.570

Filme Noi Cinema 有正确的答案，但示例代码有点过时。我只需要这个解决方案，所以我想我会发布我使用的代码。

```
//I use the standard DOM method for accessing the body tag, because the
//non-standard HTML DOM shortcuts are not stable.  The correct behavior is
//dynamically attached to the entire body using the onkeypress event, which
//is the most stable event to target cross browser.
document.getElementsByTagName("body")[0].onkeypress = function (event) {
    var a = event || window.event, //get event cross browser
        b = a.target || a.srcElement; //get source cross browser

    //the only thing that matters is the backspace key
    if (a.keyCode === 8) {

        //if you are a textarea or input type text or password then fail
        if (b.nodeName === "textarea" || (b.nodeName === "input" && (b.getAttribute("type") === "text" || b.getAttribute("type") === "password"))) {
            return true;
        } else {

            //backspace is disabled for everything else
            return false;
        }
    }
}; 
```

此代码需要在用户开始访问页面之前执行。有很多方法可以做到这一点：

1.  您可以将上述代码放入已附加到 onload 事件的任何函数中。
2.  您可以包装上面绑定到页面的 onload 事件的代码。
3.  您可以将上述代码放入自执行函数中。

例子：

```
//self executing function
(function () {
    the solution code here
}());

//wrapper to onload event
document.getElementsByTagName("body")[0].onload = function () {
    the solution code here
}; 
```

如果您想查看实际示例，我会将此代码添加到[Pretty Diff 。](http://prettydiff.com/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-22T05:06:41.140

当光标位于 texarea、文本和密码控件时，您可以简单地使用以下代码片段来阻止退格。

```
function onKeyDown() 
{    
    if((event.altKey) || ((event.keyCode == 8) &&
        (event.srcElement.type != "text" &&
        event.srcElement.type != "textarea" &&
        event.srcElement.type != "password")) ||
        ((event.ctrlKey) && ((event.keyCode == 78) || (event.keyCode == 82)) ) || (event.keyCode == 116) ) {
    event.keyCode = 0;
    event.returnValue = false;}
 } 
```

从 body 标签 onkeydown 事件调用此函数

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T04:32:59.670

您应该能够将 onKeydown/Up/Press 侦听器附加到您的窗口。在这个函数中，查看被按下的键码和事件目标。如果键码是退格键，并且目标不是输入框或文本区域，则阻止该事件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-06T23:06:02.043

我终于找到了一个适用于所有浏览器的。

这是 Hazem Saleh 他的网站地址是： [http ://www.technicaladvices.com/2012/07/16/preventing-backspace-from-navigating-back-in-all-the-browsers/](http://www.technicaladvices.com/2012/07/16/preventing-backspace-from-navigating-back-in-all-the-browsers/)

```
/*Starts here:*/

  document.onkeydown = function (event) {

    if (!event) { /* This will happen in IE */
        event = window.event;
    }

    var keyCode = event.keyCode;

    if (keyCode == 8 &&
        ((event.target || event.srcElement).tagName != "TEXTAREA") && 
        ((event.target || event.srcElement).tagName != "INPUT")) { 

        if (navigator.userAgent.toLowerCase().indexOf("msie") == -1) {
            event.stopPropagation();
        } else {
            alert("prevented");
            event.returnValue = false;
        }

        return false;
    }
  };  
/*Ends Here*/ 
```

# vb.net - 如何使用 vb.net 将 datagridview 导出到 excel？

> ID：680199
> 
> 赞同：4
> 
> 时间：2009-03-25T04:17:06.213
> 
> 标签：vb.net, excel, datagridview, printing

我在 vb.net 中有一个从数据库填充的 datagridview。我进行了研究，发现没有内置支持直接从 datagridview 打印。我不想使用水晶报表，因为我不熟悉它。

我打算将它导出到 excel 以使我能够从 datagridview 生成报告。

你能给我提供方法吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-12-31T05:52:06.487

Code below creates Excel File and saves it in D: drive It uses Microsoft office 2007

FIRST ADD REFERRANCE (Microsoft office 12.0 object library ) to your project

Then Add code given bellow to the Export button click event-

```
Private Sub Export_Button_Click(ByVal sender As System.Object, ByVal e As 
System.EventArgs) Handles VIEW_Button.Click

    Dim xlApp As Microsoft.Office.Interop.Excel.Application
    Dim xlWorkBook As Microsoft.Office.Interop.Excel.Workbook
    Dim xlWorkSheet As Microsoft.Office.Interop.Excel.Worksheet
    Dim misValue As Object = System.Reflection.Missing.Value
    Dim i As Integer
    Dim j As Integer

    xlApp = New Microsoft.Office.Interop.Excel.ApplicationClass
    xlWorkBook = xlApp.Workbooks.Add(misValue)
    xlWorkSheet = xlWorkBook.Sheets("sheet1")

    For i = 0 To DataGridView1.RowCount - 2
        For j = 0 To DataGridView1.ColumnCount - 1
            For k As Integer = 1 To DataGridView1.Columns.Count
                xlWorkSheet.Cells(1, k) = DataGridView1.Columns(k - 1).HeaderText
                xlWorkSheet.Cells(i + 2, j + 1) = DataGridView1(j, i).Value.ToString()
            Next
        Next
    Next

    xlWorkSheet.SaveAs("D:\vbexcel.xlsx")
    xlWorkBook.Close()
    xlApp.Quit()

    releaseObject(xlApp)
    releaseObject(xlWorkBook)
    releaseObject(xlWorkSheet)

    MsgBox("You can find the file D:\vbexcel.xlsx")
End Sub

Private Sub releaseObject(ByVal obj As Object)
    Try
        System.Runtime.InteropServices.Marshal.ReleaseComObject(obj)
        obj = Nothing
    Catch ex As Exception
        obj = Nothing
    Finally
        GC.Collect()
    End Try
End Sub 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-05-23T02:45:58.210

**Excel方法**

这种方法与您将看到的许多方法不同。其他人使用循环来写入每个单元格并使用文本数据类型写入单元格。

`DataTable`此方法从or创建一个对象数组`DataGridView`，然后将该数组写入 Excel。这意味着我可以在没有循环的情况下写入 Excel 并保留数据类型。

我从我的库中提取了它，我认为我对其进行了足够的更改以仅使用此代码，但可能需要进行更多细微的调整。如果您遇到错误，请告诉我，我会为您更正。通常，我创建我的类的一个实例并调用这些方法。如果您想使用我的库，请使用此链接下载它，如果您需要帮助，请告诉我。
[https://zomp.co/Files.aspx?ID=zExcel](https://zomp.co/Files.aspx?ID=zExcel)

* * *

将代码复制到您的解决方案后，您将像这样使用它。

在您的按钮代码中添加它并将名称更改为您的控件。

`WriteDataGrid("Sheet1", grid)`

要在导出后打开文件，请使用此行

`System.Diagnostics.Process.Start("The location and filename of your file")`

在该`WriteArray`方法中，您需要将保存工作簿的行更改到您要保存的位置。将其添加为参数可能是有意义的。

`wb.SaveAs("C:\MyWorkbook.xlsx")`

* * *

```
Public Function WriteArray(Sheet As String, ByRef ObjectArray As Object(,)) As String
    Try
        Dim xl As Excel.Application = New Excel.Application
        Dim wb As Excel.Workbook = xl.Workbooks.Add()
        Dim ws As Excel.Worksheet = wb.Worksheets.Add()
        ws.Name = Sheet
        Dim range As Excel.Range = ws.Range("A1").Resize(ObjectArray.GetLength(0), ObjectArray.GetLength(1))
        range.Value = ObjectArray

        range = ws.Range("A1").Resize(1, ObjectArray.GetLength(1) - 1)

        range.Interior.Color = RGB(0, 70, 132)  'Con-way Blue
        range.Font.Color = RGB(Drawing.Color.White.R, Drawing.Color.White.G, Drawing.Color.White.B)
        range.Font.Bold = True
        range.WrapText = True

        range.HorizontalAlignment = Excel.XlHAlign.xlHAlignCenter
        range.VerticalAlignment = Excel.XlVAlign.xlVAlignCenter

        range.Application.ActiveWindow.SplitColumn = 0
        range.Application.ActiveWindow.SplitRow = 1
        range.Application.ActiveWindow.FreezePanes = True

        wb.SaveAs("C:\MyWorkbook.xlsx")
        wb.CLose()
        xl.Quit()
        xl = Nothing
        wb = Nothing
        ws  = Nothing
        range = Nothing
        ReleaseComObject(xl)
        ReleaseComObject(wb)
        ReleaseComObject(ws)
        ReleaseComObject(range)

        Return ""
    Catch ex As Exception
        Return "WriteArray()" & Environment.NewLine & Environment.NewLine & ex.Message
    End Try
End Function

Public Function WriteDataGrid(SheetName As String, ByRef dt As DataGridView) As String
        Try
            Dim l(dt.Rows.Count + 1, dt.Columns.Count) As Object
            For c As Integer = 0 To dt.Columns.Count - 1
                l(0, c) = dt.Columns(c).HeaderText
            Next

            For r As Integer = 1 To dt.Rows.Count
                For c As Integer = 0 To dt.Columns.Count - 1
                    l(r, c) = dt.Rows(r - 1).Cells(c)
                Next
            Next

            Dim errors As String = WriteArray(SheetName, l)
            If errors <> "" Then
                Return errors
            End If

            Return ""
        Catch ex As Exception
            Return "WriteDataGrid()" & Environment.NewLine & Environment.NewLine & ex.Message
        End Try
    End Function

 Public Function WriteDataTable(SheetName As String, ByRef dt As DataTable) As String
        Try
            Dim l(dt.Rows.Count + 1, dt.Columns.Count) As Object
            For c As Integer = 0 To dt.Columns.Count - 1
                l(0, c) = dt.Columns(c).ColumnName
            Next

            For r As Integer = 1 To dt.Rows.Count
                For c As Integer = 0 To dt.Columns.Count - 1
                    l(r, c) = dt.Rows(r - 1).Item(c)
                Next
            Next

            Dim errors As String = WriteArray(SheetName, l)
            If errors <> "" Then
                Return errors
            End If

            Return ""
        Catch ex As Exception
            Return "WriteDataTable()" & Environment.NewLine & Environment.NewLine & ex.Message
        End Try
    End Function 
```

* * *

我实际上并没有在我的数据库程序中使用这种方法，因为当你有很多行/列时，它是一种缓慢的方法。我改为从 DataGridView 创建一个 CSV。仅当您需要格式化数据和单元格时，使用 Excel 自动化写入 Excel 才有用，否则您应该使用 CSV。您可以使用图像后的代码进行 CSV 导出。

* * *

**CSV 方法**

```
Private Sub DataGridToCSV(ByRef dt As DataGridView, Qualifier As String)  
        Dim TempDirectory As String = "A temp Directory"  
        System.IO.Directory.CreateDirectory(TempDirectory)
        Dim oWrite As System.IO.StreamWriter
        Dim file As String = System.IO.Path.GetRandomFileName & ".csv"
        oWrite = IO.File.CreateText(TempDirectory & "\" & file)

        Dim CSV As StringBuilder = New StringBuilder()

        Dim i As Integer = 1
        Dim CSVHeader As StringBuilder = New StringBuilder()
        For Each c As DataGridViewColumn In dt.Columns
            If i = 1 Then
                CSVHeader.Append(Qualifier & c.HeaderText.ToString() & Qualifier)
            Else
                CSVHeader.Append("," & Qualifier & c.HeaderText.ToString() & Qualifier)
            End If
            i += 1
        Next

        'CSV.AppendLine(CSVHeader.ToString())
        oWrite.WriteLine(CSVHeader.ToString())
        oWrite.Flush()

        For r As Integer = 0 To dt.Rows.Count - 1

            Dim CSVLine As StringBuilder = New StringBuilder()
            Dim s As String = ""
            For c As Integer = 0 To dt.Columns.Count - 1
                If c = 0 Then
                    'CSVLine.Append(Qualifier & gridResults.Rows(r).Cells(c).Value.ToString() & Qualifier)
                    s = s & Qualifier & gridResults.Rows(r).Cells(c).Value.ToString() & Qualifier
                Else
                    'CSVLine.Append("," & Qualifier & gridResults.Rows(r).Cells(c).Value.ToString() & Qualifier)
                    s = s & "," & Qualifier & gridResults.Rows(r).Cells(c).Value.ToString() & Qualifier
                End If

            Next
            oWrite.WriteLine(s)
            oWrite.Flush()
            'CSV.AppendLine(CSVLine.ToString())
            'CSVLine.Clear()
        Next

        'oWrite.Write(CSV.ToString())

        oWrite.Close()
        oWrite = Nothing    

        System.Diagnostics.Process.Start(TempDirectory & "\" & file)   

        GC.Collect()

    End Sub 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-04T15:10:18.837

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    DATAGRIDVIEW_TO_EXCEL((DataGridView1)) ' PARAMETER: YOUR DATAGRIDVIEW
End Sub

Private Sub DATAGRIDVIEW_TO_EXCEL(ByVal DGV As DataGridView)
    Try
        Dim DTB = New DataTable, RWS As Integer, CLS As Integer

        For CLS = 0 To DGV.ColumnCount - 1 ' COLUMNS OF DTB
            DTB.Columns.Add(DGV.Columns(CLS).Name.ToString)
        Next

        Dim DRW As DataRow

        For RWS = 0 To DGV.Rows.Count - 1 ' FILL DTB WITH DATAGRIDVIEW
            DRW = DTB.NewRow

            For CLS = 0 To DGV.ColumnCount - 1
                Try
                    DRW(DTB.Columns(CLS).ColumnName.ToString) = DGV.Rows(RWS).Cells(CLS).Value.ToString
                Catch ex As Exception

                End Try
            Next

            DTB.Rows.Add(DRW)
        Next

        DTB.AcceptChanges()

        Dim DST As New DataSet
        DST.Tables.Add(DTB)
        Dim FLE As String = "" ' PATH AND FILE NAME WHERE THE XML WIL BE CREATED (EXEMPLE: C:\REPS\XML.xml)
        DTB.WriteXml(FLE)
        Dim EXL As String = "" ' PATH OF/ EXCEL.EXE IN YOUR MICROSOFT OFFICE
        Shell(Chr(34) & EXL & Chr(34) & " " & Chr(34) & FLE & Chr(34), vbNormalFocus) ' OPEN XML WITH EXCEL

    Catch ex As Exception
        MsgBox(ex.ToString)
    End Try

End Sub 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T04:49:14.640

关于您需要“直接从 datagridview 打印”，请查看 CodeProject 上的这篇文章：

[DataGridViewPrinter 类](http://www.codeproject.com/KB/printing/datagridviewprinter.aspx)

有许多类似的文章，但我对我链接的那一篇很幸运。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-04T07:11:13.250

以下代码对我来说很好:)

```
Protected Sub ExportToExcel(sender As Object, e As EventArgs) Handles ExportExcel.Click
        Try
            Response.Clear()
            Response.Buffer = True
            Response.AddHeader("content-disposition", "attachment;filename=ExportEthias.xls")
            Response.Charset = ""
            Response.ContentType = "application/vnd.ms-excel"
            Using sw As New StringWriter()
                Dim hw As New HtmlTextWriter(sw)
                GvActifs.RenderControl(hw)
                'Le format de base est le texte pour éviter les problèmes d'arrondis des nombres
                Dim style As String = "<style> .textmode { } </style>"
                Response.Write(Style)
                Response.Output.Write(sw.ToString())
                Response.Flush()
                Response.End()
            End Using
        Catch ex As Exception
            lblMessage.Text = "Erreur export Excel : " & ex.Message
        End Try
    End Sub
    Public Overrides Sub VerifyRenderingInServerForm(control As Control)
        ' Verifies that the control is rendered
    End Sub 
```

希望这对您有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T12:11:14.813

将 rowNo1 调暗为短 将 numrow 调为短 将 colNo1 调为短 将 colNo2 调为短

```
 rowNo1 = 1
    colNo1 = 1
    colNo2 = 1
    numrow = 1

    ObjEXCEL = CType(CreateObject("Excel.Application"), Microsoft.Office.Interop.Excel.Application)
    objEXCELBook = CType(ObjEXCEL.Workbooks.Add, Microsoft.Office.Interop.Excel.Workbook)
    objEXCELSheet = CType(objEXCELBook.Worksheets(1), Microsoft.Office.Interop.Excel.Worksheet)

    ObjEXCEL.Visible = True

    For numCounter = 0 To grdName.Columns.Count - 1
        ' MsgBox(grdName.Columns(numCounter).HeaderText())
        If grdName.Columns(numCounter).Width > 0 Then
            ObjEXCEL.Cells(1, numCounter + 1) = grdName.Columns(numCounter).HeaderText()
        End If
        ' ObjEXCEL.Cells(1, numCounter + 1) = grdName.Columns.GetFirstColumn(DataGridViewElementStates.Displayed)
    Next numCounter

    ObjEXCEL.Range("A:A").ColumnWidth = 10
    ObjEXCEL.Range("B:B").ColumnWidth = 25
    ObjEXCEL.Range("C:C").ColumnWidth = 20
    ObjEXCEL.Range("D:D").ColumnWidth = 20
    ObjEXCEL.Range("E:E").ColumnWidth = 20
    ObjEXCEL.Range("F:F").ColumnWidth = 25

    For rowNo1 = 0 To grdName.RowCount - 1
        For colNo1 = 0 To grdName.ColumnCount - 1
            If grdName.Columns(colNo1).Width > 0 Then
                If Trim(grdName.Item(colNo1, rowNo1).Value) <> "" Then
                    'If IsDate(grdName.Item(colNo1, rowNo1).Value) = True Then
                    '    ObjEXCEL.Cells(numrow + 1, colNo2) = Format(CDate(grdName.Item(colNo1, rowNo1).Value), "dd/MMM/yyyy")
                    'Else
                    ObjEXCEL.Cells(numrow + 1, colNo2) = grdName.Item(colNo1, rowNo1).Value
                    'End If
                End If
                If colNo2 >= grdName.ColumnCount Then
                    colNo2 = 1
                Else
                    colNo2 = colNo2 + 1
                End If
            End If
        Next colNo1
        numrow = numrow + 1
    Next rowNo1 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-25T13:20:24.210

在设计模式下：将`DataGridView1 ClipboardCopyMode`属性设置为`EnableAlwaysIncludeHeaderText`

*或在程序代码上*

```
DataGridView1.ClipboardCopyMode = DataGridViewClipboardCopyMode.EnableAlwaysIncludeHeaderText 
```

在运行时选择所有单元格内容 (Ctrl+A) 并复制 (Ctrl+C) 并粘贴到 Excel 程序。让 Excel 完成剩下的工作

不便之处，我一直在寻找直接从datagridvew打印数据的方法（从vb.net VB2012创建报告），没有找到满意的结果。上面的代码只是我的，想知道我的应用程序用户是否可以依赖上面的简单步骤，这会很好，我可以继续下一步我的程序进度。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-22T13:04:44.293

从 Datagridview 生成可打印报表的一种简单方法是将 datagridview 放在 Panel 对象上。可以绘制面板的位图。

这是我的做法。

'使用 Panel Dim bmp As New Bitmap(Panel1.Width, Panel1.Height) 的尺寸创建位图

'将面板绘制到位图 "bmp" Panel1.DrawToBitmap(bmp, Panel1.ClientRectangle)

我通过“将我的 datagridview 项目分成页面来创建多页 tiff。这就是我检测新页面开始的方式：

'我一次将行添加到我的数据网格中，然后检查滚动条是否处于活动状态。'如果滚动条处于活动状态，我将行保存到一个变量中，然后我将其从'datagridview'中删除并将我的计数器整数回滚一个（因此下一次运行将包括这个'行。

```
Private Function VScrollBarVisible() As Boolean
    Dim ctrl As New Control
    For Each ctrl In DataGridView_Results.Controls
        If ctrl.GetType() Is GetType(VScrollBar) Then
            If ctrl.Visible = True Then
                Return True
            Else
                Return False
            End If
        End If
    Next
    Return Nothing
End Function 
```

我希望这有帮助

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-08-25T14:21:30.500

在将数据加载到 Datagrid 之后，另一种简单且更灵活的方法

```
Private Sub Button_Export_Click(sender As Object, e As EventArgs) Handles Button_Export.Click
    Dim file As System.IO.StreamWriter
    file = My.Computer.FileSystem.OpenTextFileWriter("c:\1\Myfile.csv", True)
    If DataGridView1.Rows.Count = 0 Then GoTo loopend

    ' collect the header's names 
    Dim Headerline As String
    For k = 0 To DataGridView1.Columns.Count - 1
        If k = DataGridView1.Columns.Count - 1 Then ' last column dont put , separate 
            Headerline = Headerline & DataGridView1.Columns(k).HeaderText
        Else
            Headerline = Headerline & DataGridView1.Columns(k).HeaderText & ","
        End If
    Next
    file.WriteLine(Headerline)  ' this will write header names at the first line 
    ' collect the data 

    For i = 0 To DataGridView1.Rows.Count - 1
        Dim DataRow As String
        For k = 0 To DataGridView1.Columns.Count - 1
            If k = DataGridView1.Columns.Count - 1 Then
                DataRow = DataRow & DataGridView1.Rows(i).Cells(k).Value ' last column dont put , separate 
            End If
            DataRow = DataRow & DataGridView1.Rows(i).Cells(k).Value & ","
        Next

        file.WriteLine(DataRow)
        DataRow = ""
    Next

loopend:
        file.Close()
End Sub 
```

# logging - 应用程序日志聚合、管理和通知

> ID：680200
> 
> 赞同：12
> 
> 时间：2009-03-25T04:17:36.120
> 
> 标签：logging, aggregation

我想知道每个人在他们的系统上使用什么来进行日志记录、日志管理和日志聚合。

我在一家公司工作，该公司的所有应用程序都使用 .NET，并且所有系统都是基于 Windows 的。目前，每个应用程序都负责自己的日志记录和失败通知（例如，如果应用程序 A 失败，它将向管理员发送自己的“求助电话”）。

虽然这种当前的做法有效，但它有点笨拙且难以管理。我一直在尝试找到一些使这项工作更好的选择，并且我提出了以下建议：

*   log4net 和电锯（啊，如果可以的话）。
*   通过 log4net 或其他框架登录到中央数据库并滚动我们自己的管理工具。
*   记录到 Windows 事件日志并使用 MOM 或 System Center Operations Manager 来聚合和管理每个服务器及其应用程序。
*   一种手动解决方案，可将所有日志文件集中到一个点并在它们之间发挥一些作用。

本质上，我们所追求的是可以将日志条目全部拉到一起并允许在它们之间运行一些分析的东西，再加上使用一种基于事件的系统，例如，当有 30 多个警告时发送警告电子邮件应用程序在最后`x`几分钟内的级别日志。

那么有什么我错过的，或者其他人可以建议的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-26T18:05:43.627

如果可以，我建议写入事件日志并在 SCOM 中创建规则以进行监控。我们广泛使用它并且它运行良好，甚至可以将监控我们应用程序的某些元素的代码片段放在一起并将值写入事件日志，SCOM 在其中解析错误，并将这些以及信息错误绘制成图表报告显示给定时间的统计信息。

然而，我非常热衷于将一些内容重写到 WMI 中，并让 SCOM 轮询 WMI 服务以获取相同的计数器，因为每 15 分钟将队列长度写入事件日志似乎有点浪费；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T06:53:47.680

[L4ndash](http://www.l4ndash.com/) : log4net 日志查看器，带有免费的开发者版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-11T04:37:16.707

对于日志聚合，**Snare**有点老，但值得一提。

[**IIS 服务器的 Snare 代理**](http://www.intersectalliance.com/projects/SnareIIS/index.html)

我很久以前就使用过这个旧版本，它通过 syslog 在网络上转发/发送/复制 IIS 日志运行良好。

[**今天，他们有一个名为Snare Epilog**](http://www.intersectalliance.com/projects/EpilogWindows/index.html)的更新版本[](http://www.intersectalliance.com/projects/EpilogWindows/index.html)

 **代码也是开源的；你可能想试一试。

* * *

此外，您可以将[**ELMAH**](http://code.google.com/p/elmah/)之类的东西与 RSS/电子邮件功能结合使用，以帮助通知和提醒您任何关键问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T18:09:17.343

我们使用 MOM 取得了相当大的成功，因为它可以处理数据输入之外的清除、查看和其他问题。对 MOM 的警告是，它没有开箱即用的 *NIX（至少我们拥有的版本）。有连接器之类的。另一种选择是查看 LogLogic。这从网络设备获取日志信息，但有一个开放的 Web 服务 API，您可以绑定到该 API。MOM 也有 API，因此您可以集中到 LogLogic 之类的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T18:51:43.740

我认为我们已经找到了非常接近您正在寻找的东西。 [**logFaces**](http://www.moonlit-software.com "日志脸")是一个日志服务器、聚合器和查看器。它专为大型分布式应用程序和多用户环境而构建。我们汇集了来自 Apache 日志服务的所有好东西，并为使用 log4j、log4net、log4cxx 或 event log4python 的用户提供了开箱即用的解决方案。logFaces 可以与主要数据库品牌合作，让您快速从大型应用程序中非常常见的大量日志数据中找出问题。它还可以让您实时查看系统的切片（日志方式）。还有更多功能，请随意尝试。如果您愿意，我可以直接帮助您进行设置，尽管在观看我们的演示后上手非常简单。

**披露**：我是该产品的作者。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-10-08T17:43:41.350

我们正在使用[ErrorsDigest](https://github.com/gmlexx/ErrorsDigest/) 简单的实时错误聚合。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T23:41:59.080

这取决于您的需求。例如，如果您正在运行一个数据中心并且主要关注实时警报，那么您可能需要查看[Avicode](http://www.avicode.com/)。它非常有能力，但可能很昂贵。

另一方面，如果您支持桌面应用程序或来自远程系统的日志，或者更关心离线日志分析，那么您可以看看[Gibraltar](http://www.GibraltarSoftware.com)。它提供了日志记录、日志管理和日志聚合/分析功能的完美组合。但是，老实说，我有点偏心——我是直布罗陀的开发者之一。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-26T18:41:35.617

log4net 绝对是用于输出到最常见目标的简单日志记录的地方。log4net 可以记录到 Windows 事件日志，也可以将消息输出到数据库、电子邮件或文件。设置起来相当简单，文档也很好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-28T21:02:32.110

我正在使用 log4net 和 log4view (www.log4view.org)。它们有一个 TCP 适配器，您可以将其作为应用程序的一部分进行分发。然后，您使用他们的客户端应用程序连接到您的各种应用程序，并实时显示日志消息。

它可以同时监控多个日志 - 如果您使用商业版本（仅 50 美元），最多可以监控 255 个日志。

它也可以与 RollingFileAppender 一起使用。

他们有一个非常强大的过滤用户界面，因此您可以专注于您想要查看的内容。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-25T09:16:43.857

检查 Microsoft [Log Parser](http://www.microsoft.com/technet/scriptcenter/tools/logparser/default.mspx)和[示例](http://www.microsoft.com/technet/scriptcenter/tools/logparser/lpexamples.mspx)。日志解析器可以处理 xml、csv 以及 Microsoft 事件日志、注册表，并且可以将信息发送到“syslog”服务器。

从示例屏幕截图来看，这似乎是一个非常有用的工具。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-07-24T07:16:52.803

前段时间问过，不过我觉得[Splunk](http://www.splunk.com/)也值得一提[http://www.splunk.com/](http://www.splunk.com/)

我以前用过它，它很方便。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-11-22T11:30:24.320

首先，使用成熟且广泛使用的日志框架，如 log4net 或 NLog。

两个日志框架都可以将日志消息发送到多个目的地，例如日志文件、网络流（TCP 或 UDP）或数据库。

然后使用 Log4View 之类的日志查看器来可视化和过滤日志消息。如果您使用 Log4View，请确保创建 XML 格式的日志文件。虽然 Log4View 也可以解析（人类可读的）模式格式的日志文件，但 XML 格式的日志数据更易于配置且解析速度更快。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2010-04-28T05:29:58.257

就我而言，我正在尝试采用 Facebook 的日志聚合器 scribe。Facebook 和 Twitter 现在正在使用 scribe。

# windows - Windows Media Service 中的节流控制

> ID：680204
> 
> 赞同：0
> 
> 时间：2009-03-25T04:20:01.590
> 
> 标签：windows, flash, service, media, throttling

我想知道在 Windows Server 2003 上，在 Windows Media Service 中，我们是否可以为任何文件类型（甚至是 Windows Media Service 流式传输不支持的文件类型）设置/配置限制设置，例如，设置 .flv 文件下载/流式传输将比特率限制为 100k 或将比特率限制控制设置为与编码比特率相同。

我已经搜索了很长时间的 Windows Media Service 手册，但找不到明确记录此功能。

顺便说一句：我只是好奇如果我们放置不受支持的流文件类型，如 .flv 苍蝇，Windows Media Service 的行为是什么。

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T06:27:46.217

[我认为 Windows Media Services 仅支持文件类型的一个子集](http://en.wikipedia.org/wiki/Windows_Media_Services)（flv 不是其中之一）。
如果您想要对 flv 进行节流控制，则需要带有节流模块的[Flash Streaming Server](http://www.adobe.com/products/flashmediastreaming/)或[Apache](http://www.google.com/search?q=mod_throttle)或[带有节流模块的 IIS 7。](http://weblogs.asp.net/scottgu/archive/2008/03/18/iis-7-0-bit-rate-throttling-module-released.aspx)

# c# - C# RSA 等效于 C++ Crypto API 的代码

> ID：680206
> 
> 赞同：0
> 
> 时间：2009-03-25T04:22:38.103
> 
> 标签：c#, c++, rsa

```
DWORD nSize;
LPBYTE lpData;
HCRYPTKEY hPublicKey;

nSize = ReadFromFile(lpszUserPublicKey, NULL);

if(nSize == -1)
    return FALSE;

lpData = new BYTE[nSize];

ReadFromFile(lpszUserPublicKey, lpData);

if(!CryptImportKey(hProv, lpData, nSize, NULL, 0, &hPublicKey)) {
    delete lpData;
    return FALSE;
}

Erase(lpData, nSize);

// Get the data size(&nSize)
if(!CryptExportKey(hKey, hPublicKey, SIMPLEBLOB, 0, NULL, &nSize))
    return FALSE;

lpData = new BYTE[nSize];

CryptExportKey(hKey, hPublicKey, SIMPLEBLOB, 0, lpData, &nSize);

if(WriteToFile(lpszLicenseFile, lpData, nSize) == -1) {
    delete lpData;
    return FALSE;
}

delete lpData;

return CryptDestroyKey(hPublicKey); 
```

上面的代码如何用 C# 编写。我对 Crypto API 调用特别感兴趣。请注意，使用的加密方法是 RSA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T04:25:10.780

[这篇](http://www.codeproject.com/KB/security/RSACryptoPad.aspx)codeproject 文章似乎符合您的需求。如文章中所示，C# 在 System.Security.Cryptography 中有一个[RSACryptoServiceProvider](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rsacryptoserviceprovider.aspx)类，使事情变得更容易一些，因此您不必滚动整个解决方案并手动翻译所有代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-21T15:55:56.990

如果您有兴趣，我在**C++**和**C#**中 写了一篇关于**RSA的文章。**它包含**代码**以及让 RSA 在两种语言中工作、在它们之间交换密钥和消息所需知道的一切：)。

 ******你可以在这里找到它：
[Crypt in C++ 和 Decrypt in C# (and C++)](http://riccardotramma.com/2011/02/crypt-in-c-and-decrypt-in-c-and-c/)

# python - 如何判断我使用的是哪个 Python 解释器？

> ID：680207
> 
> 赞同：4
> 
> 时间：2009-03-25T04:23:52.267
> 
> 标签：python

我正在使用 Python 2.5.2。我如何判断它是`CPython`or`IronPython`还是`Jython`？

另一个问题：如何在我的项目中使用用 VB.NET 开发**的 DLL ？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2017-06-15T06:11:42.583

```
import platform    
platform.python_implementation() 
```

以上提供了您使用的解释器类型。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-25T04:31:54.853

如果你从 python.org 下载它作为默认的东西，它是 CPython。那是 Python 的“普通”版本，当你使用命令“python”时你会得到一个，除非你专门去寻找针对 Java/CIL 的项目，否则你将拥有一个。

它是 CPython，因为其他项目都没有达到版本号 2.5.2。

> 如何在我的项目中使用在 VB.NET 中开发的 dll？

来自 CPython，使用[Python-for-.NET](http://pythonnet.sourceforge.net/) (*) 和 clr.AddReference。

（*：实际上有点用词不当，因为使用 CPython 控制它更像是 .NET-for-Python。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T04:34:18.543

如果您输入“python”来启动它，它可能是 CPython。IronPython 的可执行文件名为“ipy”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T04:33:09.547

```
import sys
print sys.version 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T04:37:13.467

既然你的问题的第一部分已经回答，我将处理第二部分。可以通过各种方式从 python 访问 .NET dll。如果您使用的是 ironpython，这会变得特别简单，因为所有 .NET 语言都可以相当无缝地相互交互。在这种情况下，您可以从 Ironpython 访问您的 dll，就像您使用 Ironpython 制作的任何其他 .NET dll 一样。如果要调用本机 dll，可以使用[ctypes](http://docs.python.org/library/ctypes.html)。

# vb.net - 第一次机会例外

> ID：680213
> 
> 赞同：3
> 
> 时间：2009-03-25T04:26:48.377
> 
> 标签：vb.net, visual-studio, exception, exception-handling, first-chance-exception

'一直在运行 MSDN 帮助文档来掌握 Visual Basic 的窍门。在尝试使用计时器的示例后 --one 将标签和计时器组件拖到设计器中，并将以下内容添加到组件子例程中

```
Label1.Text = My.Computer.Clock.LocalTime.ToLongTimeString 
```

调试期间即时窗口的输出如下

> Microsoft.VisualBasic.dll 中 出现“System.InvalidCastException”
> 类型的第一次机会异常 Microsoft.VisualBasic.dll 中出现“System.InvalidCastException”类型的第一次机会异常

在使用上下文菜单组件的上一个 MSDN 示例中也会出现相同的错误。我应该`Try...Catch...Finally`这个错误并尝试继续前进吗？或者，我正在处理更严重的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T04:40:47.343

在 Debug 菜单 -> Exceptions 中，您可以使调试器在第一次抛出异常时停止，即使稍后会被捕获；如果你想知道发生了什么，这是最简单的方法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T04:53:41.977

当您看到有关第一次机会异常的信息时，这仅意味着在您调用的代码中捕获了异常，但并不一定意味着代码失败。如果代码运行时不会导致程序崩溃并返回有效值，那么就没有问题。当您实现自己的 try/catch 块时，您还将在调试窗口中看到有关第一次机会异常的输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T04:42:00.680

在第一次机会异常中检查异常的详细信息。您应该看到一个堆栈帧/跟踪属性。在那里你应该看到错误发生在哪一行。这应该可以帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T05:04:14.680

在 IDE 中尝试转到 Tools > Options > Projects and Solutions > VB Defaults 并将 Option Strict 设置为“On” - 这可能有助于在编译项目而不是运行项目时发现转换问题。

“第一次机会执行”并不一定意味着您的代码有问题。这可能意味着 IDE 或编译器或任何其他涉及的组件遇到并处理了错误，并且在此过程中通知调试器并将异常报告到即时窗口。这是关于该主题的出色帖子：

[http://blogs.msdn.com/davidklinems/archive/2005/07/12/438061.aspx](http://blogs.msdn.com/davidklinems/archive/2005/07/12/438061.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-27T08:51:19.290

调试和诊断 First Chance Exception 的快速简便的解决方案是：

```
AppDomain.CurrentDomain.FirstChanceException += CurrentDomainOnFirstChanceException; 
```

进而

```
private void CurrentDomainOnFirstChanceException(object sender, FirstChanceExceptionEventArgs firstChanceExceptionEventArgs)
    {
        if (firstChanceExceptionEventArgs.Exception is NullReferenceException)
        {
            // do your handling and debugging :)
        }
    } 
```

运行时的多次首次机会异常会削弱应用程序的性能，因为异常处理成本很高。特别是在网络应用程序中。您可以添加此处理程序并查看特定的第一次机会异常并尝试避免/纠正它们。

# matlab - 为什么我的 MATLAB (R2008a) 对象的类在保存/加载周期中发生变化？

> ID：680217
> 
> 赞同：3
> 
> 时间：2009-03-25T04:30:05.933
> 
> 标签：matlab, matlab-class

**更新：** 这是一个已知的[错误](http://www.mathworks.com/support/bugreports/details.html?rp=461224)- 链接需要登录到 Mathworks 才能访问它。

*错误报告摘要*

> 如果使用版本 7.6 (R2008a) 保存到 MAT 文件中的 MATLAB 用户定义类的其中一个属性值是不同 MATLAB 类的实例，则该实例可能无法正确加载。

简而言之，Mathworks 报告以前保存的顶级自定义对象可能加载不正确（如下所述），并且错误发生在 SAVE 步骤中。因此，MAT 文件中的数据已损坏。

根据我的经验，这似乎是断断续续的。在一个数据分析应用程序中，我写了 75 个 MAT 文件，其中 37 个保存了这种损坏:(

小心用户定义的对象。我在保存时添加了以下测试以确保数据没有损坏

```
save('MAT_file_name.mat');

tmp=load('MAT_file_name.mat');
if ~isa(tmp.bb,'superClass')
    msgbox({'THE FILE WAS NOT SAVED PROPERLY', ...
            ' ', ...
            ['    MAT_file_name.mat',]})
end 
```

* * *

**原始问题**

这里我使用的是 MATLAB 2008a。这个微妙的错误已在 MATLAB-2009a 中修复。无论如何，我的两个类的定义方式，保存/加载循环导致一个类（superClass）的变量被加载为我的第二个类（propClass）的变量。

**示例 MATLAB (r2008a) 会话**

```
>> bb=superClass;
>> whos
  Name      Size            Bytes  Class         Attributes
  bb        1x1                60  superClass              

>> save
>> clear
>> clear classes
>> load
>> whos
  Name      Size            Bytes  Class        Attributes
  bb        1x1                60  propClass 
```

加载 matlab.mat 后，变量*bb*神秘地从 superClass 变为 propClass

**类：超类**

这个类需要包含一个 propClass 类型的数组，这是它的朴素定义

```
classdef superClass<handle
    properties(SetAccess=private)
        a = propClass.empty  % need to set this property as type propClass 
                             % otherwise the addProp method throws an error
        count=0;
    end
    methods
        function self=superClass
             %empty class definitionS
        end
        function addProp(self)
            p = propClass;
            self.count = self.count+1;
            self.a(self.count)=p;
        end
    end
end 
```

**类：道具类**

PropClass 是超类使用的第二个类。它的定义对于这个错误并不重要。

**问题**

那么，为什么在MATLAB-R2008a中加载操作后superClass被改为propClass呢？其次，如何更改*superClass*的定义以避免这种症状？

**笔记**

我在我写的一个更大的课程中遇到了这个症状，并缩小了问题的根源。我知道它发生在上面描述的 MATLAB 会话中，但似乎如果我将一个对象添加到 superClass 的属性数组中，那么问题就会消失。所以，如果我在保存之前调用 superClass.addProp，那么从*superClass*到*propClass*的奇怪变化就不会发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T05:02:57.260

这是一个奇怪的问题！我没有遇到过这样的事情，但是您可以首先尝试的一件事是将属性的初始化移动到构造函数：

```
classdef superClass < handle
    properties (SetAccess = private)
        a
        count
    end
    methods
        function self = superClass
            self.a = propClass.empty;
            self.count = 0;
        end
        function addProp(self)
            p = propClass;
            self.count = self.count+1;
            self.a(self.count) = p;
        end
    end
end 
```

我不确定它是否会产生任何影响，但这是我能想到的唯一尝试。希望能帮助到你！=)

# asp.net - 如何从 asp.net 代码创建子域

> ID：680230
> 
> 赞同：0
> 
> 时间：2009-03-25T04:35:23.783
> 
> 标签：asp.net, dns

我需要从代码创建子域。例如我的网站注册名为battulga 的新用户。之后自动创建battulga.mydomain.com。这该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T04:49:10.380

这是ASP.net 论坛中关于此的主题[。](http://forums.asp.net/p/1267157/2384859.aspx)

# jquery - 使用 jQuery 重置多阶段表单

> ID：680241
> 
> 赞同：350
> 
> 时间：2009-03-25T04:40:59.027
> 
> 标签：jquery, reset, forms

我有一个带有这样编码的标准重置按钮的表单：

```
<input type="reset" class="button standard" value="Clear" /> 
```

麻烦的是，所述表单是多阶段排序的，因此如果用户填写了一个阶段然后稍后返回，当单击清除按钮时，各个字段的“记住”值不会重置。

我认为附加一个 jQuery 函数来遍历所有字段并“手动”清除它们就可以了。我已经在表单中使用了 jQuery，但我只是在加快速度，所以我不确定如何去做，除了通过 ID 单独引用每个字段，这似乎不是很有效。

TIA 寻求帮助。

* * *

## 回答 #1

> 赞同：506
> 
> 时间：2009-03-25T04:46:47.500

## 2012 年 3 月更新。

所以，在我最初回答这个问题两年后，我回来发现它几乎变成了一团糟。我觉得是时候回到它并让我的答案真正正确，因为它是最受支持和接受的。

作为记录，蒂蒂的回答是错误的，因为这不是原始发帖人所要求的 - 可以使用本机 reset() 方法重置表单是正确的，但这个问题试图清除已记住的表单如果您以这种方式重置它，这些值将保留在表单中。这就是需要“手动”重置的原因。我假设大多数人最终从谷歌搜索中找到了这个问题，并且真正在寻找 reset() 方法，但它不适用于 OP 正在谈论的特定情况。

我**原来**的答案是这样的：

```
// not correct, use answer below
$(':input','#myform')
.not(':button, :submit, :reset, :hidden')
.val('')
.removeAttr('checked')
.removeAttr('selected'); 
```

这可能适用于很多情况，包括 OP，但正如评论和其他答案中所指出的，将从任何值属性中清除单选/复选框元素。

一个更**正确**的答案（但不完美）是：

```
function resetForm($form) {
    $form.find('input:text, input:password, input:file, select, textarea').val('');
    $form.find('input:radio, input:checkbox')
         .removeAttr('checked').removeAttr('selected');
}

// to call, use:
resetForm($('#myform')); // by id, recommended
resetForm($('form[name=myName]')); // by name 
```

jQuery 认为单独使用`:text`,`:radio`等选择器是不好的做法，因为它们最终会评估`*:text`which 使得它花费的时间比预期的要长得多。我确实更喜欢白名单方法，并希望我在原始答案中使用过它。无论如何，通过指定`input`选择器的一部分，加上表单元素的缓存，这应该使它成为这里表现最好的答案。

如果人们对选择元素的默认值不是具有空白值的选项，则此答案可能仍然存在一些缺陷，但它肯定是通用的，这需要根据具体情况进行处理.

* * *

## 回答 #2

> 赞同：392
> 
> 时间：2009-06-10T06:25:56.063

**只需这样做**

```
$('#myform')[0].reset(); 
```

**更多信息**

`myinput.val('')`如果您有这样的输入，设置可能不会模拟“重置”100%：

```
<input name="percent" value="50"/> 
```

例如，调用`myinput.val('')`默认值为 50 的输入会将其设置为空字符串，而调用`myform.reset()`会将其重置为其初始值 50。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2010-09-10T03:44:11.940

保罗接受的答案存在很大问题。考虑：

```
$(':input','#myform')
 .not(':button, :submit, :reset, :hidden')
 .val('')
 .removeAttr('checked')
 .removeAttr('selected'); 
```

该**`.val('')`**行还将清除任何`value`分配给复选框和单选按钮的 '。所以如果（像我一样）你做这样的事情：

```
<input type="checkbox" name="list[]" value="one" />
<input type="checkbox" name="list[]" value="two" checked="checked" />
<input type="checkbox" name="list[]" value="three" /> 
```

使用接受的答案会将您的输入转换为：

```
<input type="checkbox" name="list[]" value="" />
<input type="checkbox" name="list[]" value="" />
<input type="checkbox" name="list[]" value="" /> 
```

哎呀-我正在使用该值！

这是一个修改后的版本，它将保留您的复选框和单选值：

```
// Use a whitelist of fields to minimize unintended side effects.
$('INPUT:text, INPUT:password, INPUT:file, SELECT, TEXTAREA', '#myFormId').val('');  
// De-select any checkboxes, radios and drop-down menus
$('INPUT:checkbox, INPUT:radio', '#myFormId').removeAttr('checked').removeAttr('selected'); 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2011-07-22T06:07:34.910

**jQuery插件**

我创建了一个 jQuery 插件，因此我可以在任何需要的地方轻松使用它：

```
jQuery.fn.clear = function()
{
    var $form = $(this);

    $form.find('input:text, input:password, input:file, textarea').val('');
    $form.find('select option:selected').removeAttr('selected');
    $form.find('input:checkbox, input:radio').removeAttr('checked');

    return this;
}; 
```

所以现在我可以通过调用来使用它：

```
$('#my-form').clear(); 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-03-25T05:03:26.510

清除表格有点棘手，并不像看起来那么简单。

建议您使用[jQuery 表单插件](http://malsup.com/jquery/form/)并使用其[*clearForm*或*resetForm*](http://malsup.com/jquery/form/#code-samples) 功能。它可以处理大多数极端情况。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-05-28T14:11:50.507

document.getElementById('frm').reset()

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2010-04-27T20:08:45.423

我通常这样做：

```
$('#formDiv form').get(0).reset() 
```

或者

```
$('#formId').get(0).reset() 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-03-25T04:48:13.690

这里有一些东西可以让你开始

```
$('form') // match your correct form 
.find('input[type!=submit], input[type!=reset]') // don't reset submit or reset
.val(''); // set their value to blank 
```

当然，如果你有复选框/单选按钮，你需要修改它以包含它们并设置`.attr({'checked': false});`

**编辑** [Paolo 的回答](https://stackoverflow.com/questions/680241/reset-form-with-jquery/680252#680252)更简洁。我的回答比较啰嗦，因为我不知道`:input`选择器，也没有想过简单地删除选中的属性。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2010-07-06T07:29:36.597

考虑使用[验证插件](http://docs.jquery.com/Plugins/Validation/Validator)- 很棒！重置表格很简单：

```
var validator = $("#myform").validate();
validator.resetForm(); 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2010-06-12T22:06:57.883

我觉得这很好用。

```
$(":input").not(":button, :submit, :reset, :hidden").each( function() {
    this.value = this.defaultValue;     
}); 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2011-07-07T21:50:28.547

您可能会发现，如果没有 jQuery，这实际上更容易解决。

在常规 JavaScript 中，这很简单：

```
document.getElementById('frmitem').reset(); 
```

我试图永远记住，虽然我们使用 jQuery 来增强和加速我们的编码，但有时它实际上并没有更快。在这些情况下，通常最好使用另一种方法。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2012-05-14T20:29:24.530

基本上*没有*提供的解决方案让我高兴。正如一些人指出的那样，他们清空表格而不是重置表格。

但是，有一些 javascript 属性可以提供帮助：

*   文本字段的默认值
*   defaultChecked 复选框和单选按钮
*   defaultSelected 用于选择选项

这些存储页面加载时字段的值。

编写一个 jQuery 插件现在很简单：（对于不耐烦的人......这里有一个演示[http://jsfiddle.net/kritzikratzi/N8fEF/1/](http://jsfiddle.net/kritzikratzi/N8fEF/1/)）

## 插件代码

```
(function( $ ){
    $.fn.resetValue = function() {  
        return this.each(function() {
            var $this = $(this); 
            var node = this.nodeName.toLowerCase(); 
            var type = $this.attr( "type" ); 

            if( node == "input" && ( type == "text" || type == "password" ) ){
                this.value = this.defaultValue; 
            }
            else if( node == "input" && ( type == "radio" || type == "checkbox" ) ){
                this.checked = this.defaultChecked; 
            }
            else if( node == "input" && ( type == "button" || type == "submit" || type="reset" ) ){ 
                // we really don't care 
            }
            else if( node == "select" ){
                this.selectedIndex = $this.find( "option" ).filter( function(){
                    return this.defaultSelected == true; 
                } ).index();
            }
            else if( node == "textarea" ){
                this.value = this.defaultValue; 
            }
            // not good... unknown element, guess around
            else if( this.hasOwnProperty( "defaultValue" ) ){
                this.value = this.defaultValue; 
            }
            else{
                // panic! must be some html5 crazyness
            }
        });
    }
} )(jQuery); 
```

## 用法

```
// reset a bunch of fields
$( "#input1, #input2, #select1" ).resetValue(); 

// reset a group of radio buttons
$( "input[name=myRadioGroup]" ).resetValue(); 

// reset all fields in a certain container
$( "#someContainer :input" ).resetValue(); 

// reset all fields
$( ":input" ).resetValue(); 

// note that resetting all fields is better with the javascript-builtin command: 
$( "#myForm" ).get(0).reset(); 
```

## 一些笔记...

*   我还没有研究新的 html5 表单元素，有些可能需要特殊处理，但同样的想法应该可行。
*   元素需要直接引用。即`$( "#container" ).resetValue()`行不通。总是使用`$( "#container :input" )`。
*   如上所述，这是一个演示：http: [//jsfiddle.net/kritzikratzi/N8fEF/1/](http://jsfiddle.net/kritzikratzi/N8fEF/1/)

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2014-06-30T17:51:40.857

[我对弗朗西斯刘易斯的好解决方案](https://stackoverflow.com/a/6786237/1766230)做了一点改动。他的解决方案没有做的是将下拉选择设置为空白。（我认为当大多数人想要“清除”时，他们可能想让所有值都为空。）这个用`.find('select').prop("selectedIndex", -1)`.

```
$.fn.clear = function()
{
    $(this).find('input')
            .filter(':text, :password, :file').val('')
            .end()
            .filter(':checkbox, :radio')
                .removeAttr('checked')
            .end()
        .end()
    .find('textarea').val('')
        .end()
    .find('select').prop("selectedIndex", -1)
        .find('option:selected').removeAttr('selected')
    ;
    return this;
}; 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2015-06-20T04:47:36.090

简单地使用`jQuery Trigger event`这样的：

```
$('form').trigger("reset"); 
```

这将重置复选框、单选按钮、文本框等...本质上它会将您的表单转换为默认状态。只需将选择器放在`#ID, Class, element`里面`jQuery`。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2011-10-10T16:27:43.693

我通常会在表单中添加一个隐藏的重置按钮。仅在需要时： $('#reset').click();

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2012-09-15T00:19:30.287

针对情况修改投票最多的答案`$(document).ready()`：

```
$('button[type="reset"]').click(function(e) {
    $form = $(this.form);
    $form.find('input:text, input:password, input:file, select, textarea').val('');
    $form.find('input:radio, input:checkbox').removeAttr('checked').removeAttr('selected');
    e.preventDefault();
}); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-02-15T22:43:01.143

这对我有用，pyrotex 答案没有重置选择字段，把他的，这里是我的编辑：

```
// Use a whitelist of fields to minimize unintended side effects.
$(':text, :password, :file', '#myFormId').val('');  
// De-select any checkboxes, radios and drop-down menus
$(':input,select option', '#myFormId').removeAttr('checked').removeAttr('selected');
//this is for selecting the first entry of the select
$('select option:first', '#myFormId').attr('selected',true); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2011-10-13T16:06:37.770

我正在使用 Paolo Bergantino 解决方案，该解决方案很棒，但几乎没有调整......特别是使用表单名称而不是 id。

例如：

```
function jqResetForm(form){
   $(':input','form[name='+form+']')
   .not(':button, :submit, :reset, :hidden')
   .val('')
   .removeAttr('checked')
   .removeAttr('selected');
} 
```

现在，当我想使用它时，我可以做到

```
<span class="button" onclick="jqResetForm('formName')">Reset</span> 
```

如您所见，这适用于任何形式，并且因为我使用 css 样式来创建按钮，所以单击时页面不会刷新。再次感谢 Paolo 的意见。唯一的问题是我是否在表单中有默认值。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2011-10-28T18:53:51.010

我使用了下面的解决方案，它对我有用（将传统的 javascript 与 jQuery 混合）

```
$("#myformId").submit(function() {
    comand="window.document."+$(this).attr('name')+".reset()";
    setTimeout("eval(comando)",4000);
}) 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2012-08-29T05:22:00.010

我只是 PHP 的中级，有点懒得去钻研 JQuery 之类的新语言，但是下面这不是一个简单而优雅的解决方案吗？

```
<input name="Submit1" type="submit" value="Get free quote" />
<input name="submitreset" type="submit" value="Reset" /> 
```

看不到为什么没有两个提交按钮的原因，只是用途不同。然后简单地说：

```
if ($_POST['submitreset']=="Reset") {
$_source = "--Choose language from--";
$_target = "--Choose language to--"; } 
```

您只需将您的值重新定义回默认值即可。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-03-25T05:12:05.130

我在一个相当大的表单（50 多个字段）上使用的一种方法是使用 AJAX 重新加载表单，基本上是调用服务器并返回具有默认值的字段。这比尝试使用 JS 抓取每个字段然后将其设置为默认值要容易得多。它还允许我将默认值保存在一个地方——服务器的代码。在这个站点上，根据帐户的设置，还有一些不同的默认值，因此我不必担心将这些发送给 JS。我必须处理的唯一小问题是一些在 AJAX 调用后需要初始化的建议字段，但没什么大不了的。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2011-09-24T17:45:14.603

所有这些答案都很好，但最简单的方法是使用假重置，即使用链接和重置按钮。

只需添加一些 CSS 来隐藏您真正的重置按钮。

```
input[type=reset] { visibility:hidden; height:0; padding:0;} 
```

然后在您的链接上添加如下

```
<a href="javascript:{}" onclick="reset.click()">Reset form</a>

<input type="reset" name="reset" id="reset" /><!--This input button is hidden--> 
```

希望这可以帮助！一种。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2012-04-05T05:46:35.913

```
<script type="text/javascript">
$("#edit_name").val('default value');
$("#edit_url").val('default value');
$("#edit_priority").val('default value');
$("#edit_description").val('default value');
$("#edit_icon_url option:selected").removeAttr("selected");
</script> 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2012-12-19T19:29:53.540

此处刷新复选框并选择：

```
$('#frm').find('input:text, input:password, input:file, textarea').val('');
$('#frm').find('input:radio, input:checkbox').attr("checked",false).checkboxradio("refresh");
$('#frm').find('select').val('').selectmenu('refresh'); 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2013-02-08T09:36:00.877

我遇到了同样的问题，Paolo 的帖子帮助了我，但我需要调整一件事。我的 id 为 advancedindexsearch 的表单仅包含输入字段并从会话中获取值。由于某种原因，以下内容对我不起作用：

```
$("#advancedindexsearch").find("input:text").val(""); 
```

如果我在此之后发出警报，我会看到正确删除的值，但之后它们又被替换了。我仍然不知道如何或为什么，但以下行确实对我有用：

```
$("#advancedindexsearch").find("input:text").attr("value",""); 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2013-12-10T05:12:19.050

Paolo 的回答没有考虑日期选择器，请将其添加到：

```
$form.find('input[type="date"]').val(''); 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2014-06-16T20:28:55.357

我对 Paolo Bergantino 的原始答案做了一点改进

```
function resetFormInputs(context) {
    jQuery(':input', context)
    .removeAttr('checked')
    .removeAttr('selected')
    .not(':button, :submit, :reset, :hidden')
    .each(function(){
         jQuery(this).val(jQuery(this).prop('defautValue'));
    });
} 
```

这样，我可以将任何上下文元素传递给函数。我可以重置整个表单或仅重置一组字段，例如：

```
resetFormInputs('#form-id'); // entire form
resetFormInputs('.personal-info'); // only the personal info field set 
```

另外，保留输入的默认值。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2014-08-26T21:30:08.210

这是我的解决方案，它也适用于新的 html5 输入类型：

```
/**
 * removes all value attributes from input/textarea/select-fields the element with the given css-selector
 * @param {string} ele css-selector of the element | #form_5
 */
function clear_form_elements(ele) {
    $(ele).find(':input').each(function() {
        switch (this.type) {
            case 'checkbox':
            case 'radio':
                this.checked = false;
            default:
                $(this).val('');
                break;
        }
    });
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2018-10-22T00:13:48.453

作为接受的答案的补充，如果您使用 SELECT2 插件，则需要调用 select2 脚本来更改所有 select2 字段：

```
function resetForm(formId){
        $('#'+formId).find('input:text, input:password, input:file, select, select2, textarea').val('');
        $('#'+formId).find('input:radio, input:checkbox').removeAttr('checked').removeAttr('selected');
        $('.select2').select2();
    } 
```

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2013-12-24T12:58:03.073

```
$(this).closest('form').find('input,textarea,select').not(':image').prop('disabled', true); 
```

# windows - 将 FileSystemWatcher 和 Timer 添加到 .Net 2.0 windows 服务

> ID：680242
> 
> 赞同：0
> 
> 时间：2009-03-25T04:41:19.043
> 
> 标签：windows, windows-services

任何人都看到将 FileSystemWatcher 和 Timer 添加到我的派生 ServiceBase 类中的任何潜在问题？

马尔科姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T04:49:00.663

只需确保将每个事件包装在 try-catch 中，因为它们将在线程池中的线程上运行。如果在处理该事件期间出现异常，您的服务可能会意外停止运行。您还应该将 FileSystemWatcher 事件中的处理保持在最低限度，例如，只需将文件路径添加到队列中，然后让您的计时器或后台工作人员处理队列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T04:45:19.487

不会。在 Windows 服务中使用这些类应该没有问题。这两个类（不确定您使用的是哪个“计时器”类）应该在服务环境中正常工作。

如果您遇到问题，指定这些可能会帮助我们弄清楚如何提供帮助...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T04:44:53.213

我们的派生类中有 FileSystemWatchers 和计时器。你期待什么问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T11:25:13.230

我不这么认为。我在 Windows 服务中使用了 System.Threading.Timer，但它不起作用。经过2-3次代码不起作用认为服务处于运行状态。仍在试图找出问题的解决方案。如果有人知道解决方案，请告诉我。这让我疯狂 ：（

# iphone - 我们可以在 iphone 中使用 NSFileManager 吗？

> ID：680245
> 
> 赞同：-1
> 
> 时间：2009-03-25T04:42:28.400
> 
> 标签：iphone

我需要在我自己的 iPhone 应用程序中使用 NSFileManager 类...在此之前我想知道它是否会在 iPhone 中得到支持？？？有人可以帮我吗？

提前致谢，

赛姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T09:17:57.567

支持。它是打开和保存应用程序包之外文件的主要方法之一

# ruby-on-rails - 什么时候应该在 Rails 应用程序中使用 RESTful 控制器，什么时候不应该？

> ID：680246
> 
> 赞同：5
> 
> 时间：2009-03-25T04:42:29.007
> 
> 标签：ruby-on-rails, ruby, rest

我正在寻找有关何时知道模型及其关联的 RESTful 方法何时合适以及何时不合适的指南。也许这是我当前应用程序的本质，但我发现没有关联的简单模型可以很好地与 REST 配合使用，但具有许多 has_many 关联的复杂模型似乎确实使控制器中所需的视图和设置变得复杂。form_for 调用开始变得特别复杂。

或者也许这是我的新手理解。我做 Rails 已经三年多了，但是 REST 和表单助手一起似乎让我感到迷惑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T01:12:18.833

为系统中的每个顶级模型创建一个资源。我所说的顶级模型是指独立的并且在关联模型之外具有意义的模型。一般来说，这是大多数模型。在以下示例中，职位和候选人是顶级的。您可以认为应聘者由 PastEmployment 和她申请的职位组成。可以通过候选人资源访问职位申请和以前的工作历史，因为它们本身并不存在。

**楷模**

```
class Position
  has_many :candidate_positions
  has_many :candidates, :through => :candidate_positions
end

class Candidate
  has_many :candidate_positions
  has_many :positions, :through => :candidate_positions
  has_many :past_employments
  accepts_nested_attributes_for :past_employments
  accepts_nested_attributes_for :candidate_positions
end

class PastEmployment
  belongs_to :candidate
end

class CandidatePosition
  belongs_to :candidate
  belongs_to :position
end 
```

**路线**

```
map.resources :positions
map.resources :candidates 
```

使用非资源控制器与跨模型的用户进行交互。例如，如果您想要一个`HomeController`显示可用职位以及最近的候选人的，那将是一个新的、普通的控制器。如果您想编辑此控制器上的任何信息，很酷！您已经拥有可用于处理表单帖子的控制器，这些控制器将自动与`<% form_for @candidate %>`. 你可以用 来渲染你的位置集合`<%= render @positions %>`，因为你已经把它们变成了资源，Rails 会知道去寻找`views/positions/_position.html.erb`合适的部分。

最终结果应该是您永远不会编写逻辑来处理多个位置的对象的持久性。那是控制器变得复杂并且表单失控的时候。这也意味着 Rails 和外部系统知道在哪里检索和存储对象。相同的 URL，相同的控制器，只是格式不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T20:18:08.667

您可以查看这个 Railscasts 系列，其中讨论了 REST 上下文中的 has-many 关系和表单：

*   [复杂表格第 1 部分](http://railscasts.com/episodes/73-complex-forms-part-1)
*   [复杂形式第 2 部分](http://railscasts.com/episodes/74-complex-forms-part-2)
*   [复杂形式第 3 部分](http://railscasts.com/episodes/75-complex-forms-part-3)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T05:06:51.790

我不知道 RoR，所以我将在 REST 上生成语句。

REST 和 ROI 将 URL 视为一系列名词，并使用 GET、POST、PUT 和 DELETE 等 HTTP 方法作为动词。该模型适用于 CRUD，甚至适用于具有多个关联的模型。由于 URL 表示资源，因此关联对象可以表示为 URL 列表。

但是，如果您的系统需要更细粒度的动词，例如 validate、move、copy、honk、read、write 等，它可能不适合 REST。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T05:10:25.867

免责声明：我知道 Rails，但我还是个新手。简短回答：REST 和表单助手是完全不同的领域。

长答案：据我了解，Representational State Transfer 仅与表单和视图的实际呈现松散相关。

REST 确实与控制器有关，并且在一定程度上与模型有关。这个想法是，您无需考虑与客户的整个对话，而是编写一个 Web 应用程序以特定的、可预测的方式响应单个客户消息。

即，如果客户端获取模型，您只需检索它，为他们格式化，发送给他们，然后忘记它。如果客户端发布某种更新，您更改 webapps 状态以反映这一点，发回任何响应，然后忘记它。任何未来的 GET 或 POST 都将查看新状态，而不是创建它的消息。

所以，真的，一个应用程序是否是 RESTful 并不取决于模型有多复杂，而是取决于用户如何与之交互。一个至少在某种程度上与客户端无关的应用程序，即以数据为中心的应用程序是 REST 的良好候选者。严重依赖会话、与特定用户交互并且以流程为中心的东西可能不是一个很好的选择。

另一方面，您有 Rails 表单助手。这些非常适合搭建脚手架，但当您尝试以更复杂的方式使用它们时，有时会令人沮丧。

那么，您的主要问题是什么？您对 Rails 表单助手有什么具体问题吗？关于导轨控制器？或特定于 REST 的东西？

# .net - 使用选中或未选中对列表框进行排序

> ID：680261
> 
> 赞同：0
> 
> 时间：2009-03-25T04:52:38.657
> 
> 标签：.net

我在我的项目 c#.net windows 应用程序中使用了一个选中的列表框。

我想对列表框进行排序，以使选中的项目首先出现，未选中的项目显示在它之后。

我该怎么做 ？有什么代码可以做到吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T05:03:23.373

最快的方法是只创建两个复选框列表。循环遍历所有复选框，将选中的复选框放入一个列表中，将未选中的复选框放入另一个列表中。然后组合这些列表。现在清除列表框并从新列表中添加项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T08:35:18.090

int checkItemsCount = 0;

for (int i = 0; i < this.checkedListBox1.CheckedItems.Count; i++)
{
object checkedItem = this.checkedListBox1.CheckedItems[i]; this.checkedListBox1.Items.Remove(checkedItem); this.checkedListBox1.Items.Insert(checkedItemsCount, checkItem); this.checkedListBox1.SetItemChecked(checkedItemsCount++,true);
}

这段代码可以正常工作。

乌梅什BT

# asp.net - 广告系统

> ID：680264
> 
> 赞同：1
> 
> 时间：2009-03-25T04:54:55.640
> 
> 标签：asp.net, algorithm

我正在为 ASP.NET 网站创建广告系统。该网站有一个广告客户部分。他们注册并发布广告，他们将首先支付广告的最高预算，有每日预算，因此广告商可以控制他的预算，网站上会有很多来自不同广告商的广告。广告有最大预算和每日预算两个属性，我如何选择广告，广告可以显示多少次，谁能给我一个方法或算法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-10-27T13:02:46.840

嘿 Priyan，这是我们在 AdServerBeans 中处理它的方式（[http://www.adserverbeans.com](http://www.adserverbeans.com) - 它是开源的，您可以查看源代码）：

```
DROP FUNCTION if exists get_speed;
CREATE FUNCTION get_speed(from_date DATETIME, to_date DATETIME, views_limit INT, views_served INT, now_date_time TIMESTAMP)
  RETURNS double
  DETERMINISTIC
  NO SQL
BEGIN
  DECLARE banner_total_serving_time INTEGER;
  DECLARE banner_served_time       INTEGER;
  DECLARE percent_time_served        DOUBLE;
  DECLARE percent_ad_events_served    DOUBLE;
  IF (views_limit IS NULL OR views_limit=0) THEN RETURN -1;END IF;

  IF (views_served IS NULL) THEN SET views_served = 0;END IF;
  IF (banner_total_serving_time = 0) THEN SET banner_total_serving_time = 1;END IF;
  IF (views_limit = 0) THEN SET views_limit = 1;END IF;

  SET banner_total_serving_time = TIMESTAMPDIFF(SECOND, from_date, to_date);
  SET banner_served_time = TIMESTAMPDIFF(SECOND, from_date, now_date_time);
  SET percent_time_served = (100 * banner_served_time) / banner_total_serving_time;
  SET percent_ad_events_served = (100 * views_served) / views_limit;
  RETURN percent_ad_events_served - percent_time_served;
END
;; 
```

此 MySQL 函数返回负数或正数。如果我们表现不佳，则为负面，如果我们表现出色，则为正面。表现不佳 - 发球，表现出色 - 跳到下一个横幅或不发球。

我希望输入参数是不言自明的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T05:02:04.327

我建议查看调度算法。

例如，您可以使用预算来确定次数/周期（天/周/等），并将其用作[加权循环调度中的权重因子。](http://en.wikipedia.org/wiki/Weighted_round_robin) 这将是一种通过时间平均平衡来自不同广告商的请求的简单方法。（注意：上面的链接更适合网络数据包调度，但基本算法可以工作......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-12T00:25:08.683

我认为你应该为你的问题使用不同的算法。通常在那种系统中你有：

1.  **尽快**（活动将尽快显示，没有限制）
2.  **平均分配/超投**重分配（活动的流量将在指定的时间段内平均分配。如果活动因任何修改而超投，将计算新的流量分配，使剩余流量在剩余时间段内平均分配时间）
3.  **两半**均匀分布（两半均匀分布功能类似于均匀分布/再分布选项。但是，它允许用户将一个流量分配给活动的前半部分，另一个分配给后半部分。一半是通过考虑活动的总持续时间、其每周时间表及其多个开始和结束日期（如果适用）来计算的。然后，系统将总流量乘以为每一半设置的相应百分比，并在每一半内统一分配。）
4.  **自适应均匀分布**（流量将根据活动所在站点的流量分布进行分配。将更多的流量分配到高峰时段，减少分配到非高峰时段。当活动接近其计划结束日期时，将分配流量加速以确保实现目标。）

如果您不想处理太多算法，那么请尽快实施，我的意思是如果广告客户可以赢，他仍然会赢，但他的每日预算仍然超过

# .net - .NET MailMessage 和 SMTPClient 被标记为垃圾邮件？

> ID：680268
> 
> 赞同：2
> 
> 时间：2009-03-25T04:56:12.843
> 
> 标签：.net, smtpclient, mailmessage

我正在准备基本的 HTML 电子邮件，并使用了带有适当 HEAD 和 BODY 标签的基本 HTML 模板，但由于某种原因，我的用户在收到我的电子邮件时遇到了麻烦。

我正在使用 ASP.NET MailMessage 和 SMTPClient 对象，并且邮件发送得很好，我可以自己收到测试邮件，大多数用户都在收到它们，但是有些网站将我的邮件标记为垃圾邮件。

我也一次发送一个，而不是多个收件人等。

当我通过同一帐户从 Thunderbird 向同一邮件服务器发送消息时，一切都很好。但是我通过网络准备的那些被一些人标记为垃圾。

我检查了我的主机并将邮件服务器更正为“Localhost”（这就是网络服务器看到邮件服务器的方式）并且清除了一些。

有什么我可以做或应该做的事情来确保信息能够响亮而清晰地传递出去吗？标志，属性等？

蒂亚！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T04:59:15.100

从地址将有所帮助。一旦您被标记为垃圾邮件（即服务器），则取消标记是一项与编程无关的任务。即邮件服务器记住！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T05:02:53.547

我刚刚学到的你可以做的一件事是使用一些域密钥更新你的 DNS，以验证你的发件人地址中的域是否有效。

[http://en.wikipedia.org/wiki/DomainKeys_Identified_Mail](http://en.wikipedia.org/wiki/DomainKeys_Identified_Mail)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T05:10:38.020

您使用的是共享主机吗？如果是这样，您服务器中的某些其他站点可能正在发送大型电子邮件（可能是真实的），因此某些服务器可能已将服务器标记为垃圾邮件。

您无法以编程方式告诉服务器您不是垃圾邮件。您已经在做您能做的，即一次不要发送太多消息。

如果邮件列表不是太长，那么您可以向每个人发送一封个人电子邮件，说有些用户报告说没有收到电子邮件，因此他们最好检查垃圾邮件文件夹并将电子邮件标记为“非垃圾邮件”以接收未来的电子邮件.

# ruby-on-rails - Ruby的vim中的全局“转到定义”？

> ID：680291
> 
> 赞同：7
> 
> 时间：2009-03-25T05:08:41.550
> 
> 标签：ruby-on-rails, ruby, vim

自 97 年以来，我一直在使用 vi/vim 进行各种快速编辑和管理任务，但直到最近才考虑使用它来代替 Netbeans 作为我选择的 ruby​​ 编辑器。我发现在 Netbeans 和 Eclipse 中都非常有用的一件事是 Ctrl+单击“转到定义”功能，您可以在其中按 ctrl+单击类或方法，它将带您进入定义。

现在，我玩过 exuberant ctags 和 rails.vim，它很接近，但没有雪茄。这就是我想要的：默认情况下，在 Netbeans 和 Eclipse 中，您可以 ctrl+单击本地 rails **项目中的本地方法或类，但您也可以 ctrl+单击在 gems 或用 Ruby 编码的系统库中定义的东西**. 例如，Netbeans 会解析默认系统路径中的所有 ruby​​ 文件，并使它们可供您导航。如果有多个文件定义了一个方法，它将为您提供一个列表并允许您在它们之间进行选择。

如何在 vim 中实现这一点？如果可以做到，我也许可以全时跳。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T09:10:16.167

你可以在 Vim 中使用多个标签文件，如下所示：

```
:set tags=./tags,c:/ruby/lib/tags 
```

使用`g]`将为您提供找到的多个条目的选项。

# search - 有哪些网站可以搜索公共源代码？

> ID：680292
> 
> 赞同：1
> 
> 时间：2009-03-25T05:10:09.957
> 
> 标签：search, open-source

我知道[Google Code](http://code.google.com)，我目前用它来搜索公开可用的源代码。

但是，有没有更好的网站可以让我搜索公共源代码？具体来说，如果我可以轻松地在 Sourceforge 和 CodePlex 中找到代码，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T05:18:09.577

几个你可能感兴趣的问题！您也可以查看相关问题。

[https://stackoverflow.com/questions/90300/in-house-full-text-search-engine-for-source-code-and-sql-scripts](https://stackoverflow.com/questions/90300/in-house-full-text-search-engine-for-source-code-and-sql-scripts)

[你知道的开源代码搜索引擎有哪些？](https://stackoverflow.com/questions/156219/what-are-the-open-source-code-search-engines-you-know-about)

[大/流行网站的源代码](https://stackoverflow.com/questions/239705/source-code-of-big-popular-websites)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T22:43:19.097

[koders.com](http://koders.com/)

[谷歌代码搜索](http://www.google.com/codesearch)

# .net - 从一个重要的 IQueryable 编译 Linq 到 SQL 查询

> ID：680295
> 
> 赞同：6
> 
> 时间：2009-03-25T05:10:42.030
> 
> 标签：.net, performance, linq-to-sql, expression-trees

有没有办法使用 CompiledQuery.Compile 方法来编译与 IQueryable 关联的表达式？目前我有一个 IQueryable，后面有一个非常大的表达式树。IQueryable 是使用几种方法构建的，每种方法都提供组件。例如，两种方法可能会返回 IQueryables，然后将它们连接到第三个中。由于这个原因，我不能在 compile() 方法调用中明确定义整个表达式。

我希望将表达式作为 someIQueryable.Expression 传递给 compile 方法，但是这个表达式不是 compile 方法所需的形式。如果我尝试通过将查询直接放入 compile 方法来解决此问题，例如：

```
 var foo = CompiledQuery.Compile<DataContext, IQueryable<User>>(dc => dc.getUsers());
    var bar = foo(this); 
```

在数据上下文中进行调用表单的地方，我收到一条错误消息，指出“getUsers 未映射为存储过程或用户定义的函数”。同样，我不能只将 getUsers 方法的内容复制到我进行编译调用的位置，因为它又会使用其他方法。

有什么方法可以将从“getUsers”返回的 IQueryable 上的表达式传递给 Compile 方法？

**更新** 后我尝试使用以下代码将我的意志强加于系统：

```
 var phony = Expression.Lambda<Func<DataContext, IQueryable<User>>>(
        getUsers().Expression, Expression.Parameter(typeof(DataContext), "dc"));

    Func<DataContext, IQueryable<User>> wishful = CompiledQuery.Compile<DataContext, IQueryable<User>>(phony);
    var foo = wishful(this); 
```

foo 最终成为：

{System.Data.Linq.SqlClient.SqlProvider+OneTimeEnumerable`1[Model.Entities.User]}

我没有在 foo 中查看结果的选项，因为没有提供扩展结果并运行查询，我只看到消息“操作可能会破坏运行时”。

我只需要找到一种方法让 sql 字符串只生成一次并在后续请求中用作参数化命令，我可以在数据上下文中使用 GetCommand 方法手动执行此操作，但随后我必须显式设置所有参数并自己进行对象映射，考虑到这个特定查询的复杂性，这是几百行代码。

**更新**

John Rusk 提供了最有用的信息，所以我授予他在这方面的胜利。但是，需要进行一些额外的调整，并且我在此过程中遇到了其他一些问题，所以我想我会“扩展”答案。首先，“操作可能破坏运行时”错误不是由于表达式的编译，它实际上是由于表达式树中的某些深度转换造成的。在某些地方，我需要调用该`.Cast<T>()`方法来正式转换项目，即使它们是正确的类型。无需过多详细说明，当几个表达式组合成一棵树并且每个分支都可以返回不同的类型时，这基本上是必需的，它们都是公共类的子类型。

解决了不稳定的问题后，我回到了编译问题。约翰的扩展解决方案几乎就在那里。它在树中查找方法调用表达式，并尝试将它们解析为该方法通常返回的底层表达式。我对表达式的引用不是由方法调用提供的，而是由属性提供的。所以我需要修改执行扩展的表达式访问者以包含这些类型：

```
protected override Expression VisitMemberAccess(MemberExpression m) {
    if(m.Method.DeclaringType == typeof(ExpressionExtensions)) {
        return new ExpressionExpander().Visit((Expression)(((System.Reflection.PropertyInfo)m.Member).GetValue(null, null)));
    }
    return base.VisitMemberAccess(m);
} 
```

这种方法可能并不适用于所有情况，但它应该可以帮助任何发现自己处于同样困境的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T02:55:20.627

至少在我的测试中，这样的东西是有效的：

```
Expression<Func<DataContext, IQueryable<User>> queryableExpression = GetUsers();
var expressionWithSomeAddedStuff = (DataContext dc) => from u in queryableExpression.Invoke(dc) where ....;
var expressionThatCanBeCompiled = expressionWithSomeAddedStuff.Expand();
var foo = CompiledQuery.Compile<DataContext, IQueryable<User>>(expressionThatCanBeCompiled); 
```

这看起来有点冗长，您可能可以进行一些改进。

他们的关键点是它使用了来自 LinqKit 的 Invoke 和 Expand 方法。它们基本上让您通过组合构建查询，然后编译完成的结果。

# .net - 与 Visual Studio 集成的最佳点网单元测试框架是什么？

> ID：680298
> 
> 赞同：-3
> 
> 时间：2009-03-25T05:11:13.480
> 
> 标签：.net, visual-studio, unit-testing

与 Visual Studio 集成的最佳点网单元测试框架是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T05:22:43.030

[Testdriven.net](http://www.testdriven.net/)或带有[Resharper的](http://www.jetbrains.com/resharper/)[Nunit](http://www.nunit.org/index.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T05:13:11.087

MSTest 内置于 Visual Studio 2008 中并完全集成，包括文件部署选项和代码覆盖源突出显示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T05:14:21.770

[testdriven.net](http://testdriven.net/)为您提供了 VS 中的单元测试集成，适用于您想要使用的几乎任何框架。

# c++ - 内存分配的运算符重载？

> ID：680300
> 
> 赞同：3
> 
> 时间：2009-03-25T05:12:50.807
> 
> 标签：c++, memory-leaks, operator-overloading

下面的句子来自Bruce Eckel**[的 The Positive Legacy of C++ and Java ，关于 C++ 中的运算符重载：](http://www.artima.com/weblogs/viewpost.jsp?thread=252441)**

> C++ 有栈分配和堆分配，你必须重载你的操作符来处理所有情况并且不会导致内存泄漏。确实很难。

我不明白运算符重载与内存分配有什么关系。谁能解释一下它们是如何相关的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T05:46:28.997

我可以想象几种可能的解释：

首先，在 C++中`new`，`delete`两者实际上都是运算符；如果您选择通过重载这些运算符来为对象提供自定义分配行为，则必须非常小心，以确保不会引入泄漏。

其次，某些类型的对象需要您重载`operator=`以避免内存管理错误。例如，如果您有一个引用计数智能指针对象（如 Boost shared_ptr），则必须实现`operator=`，并且必须确保正确执行。考虑这个破碎的例子：

```
template <class T>
class RefCountedPtr {
public:
    RefCountedPtr(T *data) : mData(data) { mData->incrRefCount(); }
    ~RefCountedPtr() { mData->decrRefCount(); }
    RefCountedPtr<T>& operator=(const RefCountedPtr<T>& other) {
        mData = other.mData;
        return *this;
    }
    ...
protected:
    T *mData;
}; 
```

这里的`operator=`实现被破坏了，因为它不管理 和 的引用计数`mData`：`other.mData`它没有减少 的引用计数`mData`，导致泄漏；并且它不会增加引用计数`other.mData`，从而导致可能的内存故障，因为指向的对象可能在所有实际引用消失之前被删除。

请注意，如果您没有为您的类显式声明自己`operator=`的类，编译器将提供一个默认实现，其行为与此处显示的实现相同——也就是说，对于这种特殊情况完全破坏。

正如文章所说——在某些情况下，您必须重载运算符，并且必须小心正确处理所有情况。

**编辑**：对不起，我没有意识到参考是在线文章，而不是一本书。即使在阅读了整篇文章后，也不清楚其意图是什么，但我认为 Eckel 可能指的是我上面描述的第二种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T06:13:34.233

new 和 delete 实际上是 C++ 中的运算符，您可以覆盖它们以提供您自己的自定义内存管理。看看这里的[例子](http://www.relisoft.com/book/tech/9new.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T05:31:39.170

运算符是函数。仅仅因为它们添加了句法糖并不意味着您不必小心记忆。您必须像使用任何其他成员/全局/朋友功能一样管理内存。

当您在实现包装指针类时重载时，这一点尤其重要。

`operator+`然后通过重载or进行字符串连接`operator+=`。查看`basic_string`模板以获取更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T09:00:56.063

如果你在比较 Java 和 C++ 之间的运算符重载，你就不会谈论`new`和`delete`- Java 没有为 new 公开足够的内存管理细节，也不需要删除。

您不能为指针类型重载其他运算符-至少一个参数必须是类或枚举类型，因此他不能谈论为指针提供不同的运算符。

因此，C++ 中的运算符对值或对值的 const 引用进行操作。

对于值或对值的 const 引用进行操作的运算符返回值以外的任何内容是非常不寻常的。

除了所有 C++ 函数常见的明显错误 - 返回对堆栈分配对象的引用（这与内存泄漏相反），或返回对使用`new`而不是值创建的对象的引用（通常不会超过在被学习之前的职业生涯中一次），很难想出一个普通操作员有记忆问题的场景。

因此，无需根据操作数是基于正常使用模式分配的堆栈还是堆来创建多个版本。

运算符的参数是作为值或引用传递的对象。C++ 中没有可移植的机制来测试对象是分配在堆上还是栈上。如果对象是按值传递的，它将始终在堆栈上。因此，如果需要在这两种情况下更改运算符的行为，那么在 C++ 中就无法进行可移植的操作。（在许多操作系统上，您可以测试指向对象的指针是否位于通常用于堆栈的空间或通常用于堆的空间中，但这既不便携也不完全可靠。）（此外，即使您可以拥有运算符它将两个指针作为参数，没有理由相信这些对象只是因为它们是指针而被堆分配的。这些信息在 C++ 中根本不存在）

您得到的唯一重复是对于诸如 operator[] 之类的情况，其中相同的运算符同时用作访问器和更改器。那么有 const 和 non-const 版本是正常的，所以如果接收者不是 const 可以设置值。这是一件好事 - 无法改变已标记为常量的对象（可公开访问的状态）。

# ruby-on-rails - 如何找出我的应用程序运行缓慢的原因？

> ID：680302
> 
> 赞同：2
> 
> 时间：2009-03-25T05:14:02.223
> 
> 标签：ruby-on-rails, performance, hosting

我在 500 MB Slicehost VPN 上部署了一个简单的 Rails 应用程序。我是唯一一个使用该应用程序的人。当我在笔记本电脑上运行它时，它已经足够快了。但是部署的版本非常慢。加载登录屏幕需要 6 到 10 秒。

我想知道为什么它这么慢。是我的代码吗？（不要这么认为，因为它在本地要快得多，但也许。）是 Slicehost 的服务器过载了吗？是互联网吗？

有人可以建议我可以采取的一种技术或一组步骤来帮助缩小这个问题的原因吗？

* * *

更新：

抱歉忘了提。我正在使用 Phusion Passenger（AKA`mod_rails`或`mod_rack`）在 CentOS 5 下运行它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T12:29:41.117

如果您第一次加载时速度很慢，则可能是因为乘客由于不活动而杀死了该过程。我不记得所有细节，但我确实记得读过一些人使用 cron 作业来保持至少一个进程处于活动状态，以避免在乘客需要重新加载环境时可能发生的这种滞后。

编辑：更多细节[在这里](http://groups.google.com/group/phusion-passenger/browse_thread/thread/c21b8d17cdb073fd)

具体来说 - 池空闲时间默认为 2 分钟，这意味着在空闲两分钟后，乘客将不得不重新加载环境以服务下一个请求。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T06:03:17.537

首先，找出服务器的响应是否特别慢。使用 Firefox 和 Firebug 插件查看每个组件（包括 JavaScript 和图形）下载所需的时间。假设主页本身一直在占用，您可以开始分析应用程序。你需要找到一个好的分析器，因为我实际上并没有在 Ruby on Rails 中工作，所以我不能提出任何建议：google "profile ruby​​ on rails" 以获得一些选项。

正如 YenTheFirst 指出的那样，您使用的服务器软件和配置可能会导致速度变慢，但是 A) slicehost 不会选择这样做，因为 Slicehost 只是提供非常原始的服务器“切片”，您可以将其视为专用机器. B) 您不太可能仅仅因为它作为 CGI 运行而看到一个立即运行的脚本突然需要 6 秒。一定有别的事情发生。检查你使用了多少内存：你进入交换了吗？登录是不是只有在第一次被击中时才会出现启动问题，还是总是那么慢？静态内容服务慢吗？这往往意味着某些网络问题（在 Slicehost 端或您的本地网络上）正在减慢速度，假设您不在交换中。

当您说“足够快”时，您是在含糊其辞：笔记本电脑版本是否需要 1 秒才能到达 Slicehost 6？如果笔记本电脑不错，那也不足为奇：毕竟，切片便宜的原因是因为它们只是完整服务器的一小部分。您在 Slicehost 上使用的可能是 8 核机器的 1/32，而不是现代笔记本电脑的两个内核。Slicehost 内核速度很快，但与 1/4 的内核相比，您的笔记本电脑可能会令人尖叫。:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T22:36:32.733

试着找出缓慢的地方

1/ 应用程序很慢，或者基础设施（网络 + Web 服务器）

*   在您的网络服务器上放置一个静态文件，并通过您的浏览器访问它

2/ 如果速度很快，可能是应用程序+服务器配置有问题。

*   数据库访问很慢
*   尝试一个带有简单循环的页面：它慢吗？

3/ 如果它很慢，可能是你的基础设施。您可以检查：

*   网络连接不良：进行数据包捕获（例如使用 Wireshark）并查找重传、重复数据包等。
*   DNS解析慢？
*   服务器配置错误？
*   等等

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T05:24:41.217

Slicehost 使用什么来提供服务？快速选项如下： Mongrel 或 apache 的 mod_rails（也称为乘客 phusion 或类似的东西） 这些是运行您的 rails 应用程序实例的专用服务器（或服务器插件）。

如果您的主机没有使用它，那么它可能默认为 CGI。Rails 附带了一个简单的 CGI 脚本，它将为页面提供服务，但它会为每个页面重新加载应用程序。

（编辑：我怀疑这是最有可能的情况，即您的应用程序正在运行 /webapp_directory/public/dispatch.cgi 中的 CGI，这可以解释速度缓慢。这往往是许多主机上的默认部署，因为它不需要额外的配置，但它并没有提供良好的性能）

如果你的主机支持“Fast CGI”，rails 也支持。Fast CGI 将打开一个 CGI 会话，并为多个页面保持打开状态，因此您可以获得更好的性能，但它不如 Mongrel 或 mod_rails 好。

其次，它是处于“生产”模式还是“开发”模式？最简单的判断方法是转到您的应用程序中出现错误的页面。如果它向您显示堆栈跟踪，则它处于开发模式，比生产模式慢。Mongrel 和 mod_rails 有启动选项来确定是在生产模式还是开发模式下运行应用程序。

最后，如果您的数据库由于某种原因运行缓慢，这也将是一个很大的瓶颈。如果您在生产模式下确实有良好的部署（Mongrel/mod_rails/etc.），请尝试调查。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T14:04:12.263

您的数据库中是否有大量数据？我会仔细检查您是否为所有适当的列编制了索引——因为这会产生巨大的影响。在您的本地开发系统上，您的内存可能比您的 500 mb 切片上的内存多得多，如果您有大的、未编制索引的表，这将导致数据库运行速度变慢。您还可以在 MySql 中运行慢查询记录器来查明没有索引的列。

除此之外，是的，如果您最近没有使用该网站，乘客将需要为您准备一个流程。如果是这种情况，您应该会看到第二次页面加载速度显着提高，尤其是第三次及以后的页面加载。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T15:38:10.697

您可能希望运行 500 MB 的本地虚拟机。您是否进行了大量的客户端-服务器交互？WAN 上的延迟很严重

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-25T22:52:23.087

您可能想查看[RPM](http://newrelic.com/features.html)（也有免费的“精简版”版本）和/或 New Relic 的[Tune Up](http://www.fiveruns.com/products/tuneup)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-25T05:22:10.083

您的 CPU 时间由使用 Xen 虚拟化系统的 Slicehost 保证，因此并非如此。没有其他答案给你，对不起！当您尝试访问该页面时，可能会在控制台上尝试“顶部”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-06T15:10:28.287

如果您正在使用 FireFox 并进行 localhost 测试（或者甚至在 LAN 上），您可能需要尝试编辑 network.dns.disableIPv6 设置。

在地址栏中键入 about:config 并过滤 network.dns.disableIPv6 并双击以设置为 true。

这个错误主要来自 Vista 操作系统，但也有一些其他的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-19T23:40:13.680

您可以尝试在 SSH 进入时运行“top”以查看哪个进程很重。如果您在登录时也遇到问题，也许您可​​以尝试在 Slicehost 管理器中获取统计信息。

如果您发现这是 MySQL 的错误，请考虑减少它可以生成的服务器数量。

512 对于 Rails 应用程序来说似乎不错，您可能还需要检查您是否也配置错误。

# python - 使用 MultipartPostHandler 通过 Python 发布表单数据

> ID：680305
> 
> 赞同：51
> 
> 时间：2009-03-25T05:14:37.183
> 
> 标签：python, file, upload, urllib2, multipartform-data

问题：当使用 Python 的 urllib2 发布数据时，所有数据都经过 URL 编码并作为 Content-Type: application/x-www-form-urlencoded 发送。上传文件时，Content-Type 应该设置为 multipart/form-data 并且内容是 MIME 编码的。

为了解决这个限制，一些敏锐的编码人员创建了一个名为 MultipartPostHandler 的库，它创建了一个 OpenerDirector，您可以将其与 urllib2 一起使用，以自动使用 multipart/form-data 进行 POST。这个库的副本在这里：[MultipartPostHandler doesn't work for Unicode files](http://peerit.blogspot.com/2007/07/multipartposthandler-doesnt-work-for.html)

我是 Python 新手，无法让这个库正常工作。我基本上写了以下代码。当我在本地 HTTP 代理中捕获它时，我可以看到数据仍然是 URL 编码的，而不是多部分 MIME 编码的。请帮助我找出我做错了什么或更好的方法来完成这项工作。谢谢 ：-）

```
FROM_ADDR = 'my@email.com'

try:
    data = open(file, 'rb').read()
except:
    print "Error: could not open file %s for reading" % file
    print "Check permissions on the file or folder it resides in"
    sys.exit(1)

# Build the POST request
url = "http://somedomain.com/?action=analyze"       
post_data = {}
post_data['analysisType'] = 'file'
post_data['executable'] = data
post_data['notification'] = 'email'
post_data['email'] = FROM_ADDR

# MIME encode the POST payload
opener = urllib2.build_opener(MultipartPostHandler.MultipartPostHandler)
urllib2.install_opener(opener)
request = urllib2.Request(url, post_data)
request.set_proxy('127.0.0.1:8080', 'http') # For testing with Burp Proxy

# Make the request and capture the response
try:
    response = urllib2.urlopen(request)
    print response.geturl()
except urllib2.URLError, e:
    print "File upload failed..." 
```

EDIT1：感谢您的回复。我知道 ActiveState httplib 解决方案（我在上面链接到它）。我宁愿抽象出问题并使用最少的代码来继续使用 urllib2。知道为什么没有安装和使用开瓶器吗？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-03-27T01:31:25.287

似乎解决这个问题的最简单和最兼容的方法是使用“海报”模块。

```
# test_client.py
from poster.encode import multipart_encode
from poster.streaminghttp import register_openers
import urllib2

# Register the streaming http handlers with urllib2
register_openers()

# Start the multipart/form-data encoding of the file "DSC0001.jpg"
# "image1" is the name of the parameter, which is normally set
# via the "name" parameter of the HTML <input> tag.

# headers contains the necessary Content-Type and Content-Length
# datagen is a generator object that yields the encoded parameters
datagen, headers = multipart_encode({"image1": open("DSC0001.jpg")})

# Create the Request object
request = urllib2.Request("http://localhost:5000/upload_image", datagen, headers)
# Actually do the request, and get the response
print urllib2.urlopen(request).read() 
```

这很完美，我不必对 httplib 感到厌烦。该模块可在此处获得： http: [//atlee.ca/software/poster/index.html](http://atlee.ca/software/poster/index.html)

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-03-25T11:29:54.910

找到这个配方`httplib`直接使用（不涉及外部库）发布多部分

```
import httplib
import mimetypes

def post_multipart(host, selector, fields, files):
    content_type, body = encode_multipart_formdata(fields, files)
    h = httplib.HTTP(host)
    h.putrequest('POST', selector)
    h.putheader('content-type', content_type)
    h.putheader('content-length', str(len(body)))
    h.endheaders()
    h.send(body)
    errcode, errmsg, headers = h.getreply()
    return h.file.read()

def encode_multipart_formdata(fields, files):
    LIMIT = '----------lImIt_of_THE_fIle_eW_$'
    CRLF = '\r\n'
    L = []
    for (key, value) in fields:
        L.append('--' + LIMIT)
        L.append('Content-Disposition: form-data; name="%s"' % key)
        L.append('')
        L.append(value)
    for (key, filename, value) in files:
        L.append('--' + LIMIT)
        L.append('Content-Disposition: form-data; name="%s"; filename="%s"' % (key, filename))
        L.append('Content-Type: %s' % get_content_type(filename))
        L.append('')
        L.append(value)
    L.append('--' + LIMIT + '--')
    L.append('')
    body = CRLF.join(L)
    content_type = 'multipart/form-data; boundary=%s' % LIMIT
    return content_type, body

def get_content_type(filename):
    return mimetypes.guess_type(filename)[0] or 'application/octet-stream' 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2013-08-08T08:04:24.097

只需使用[**python-requests**](http://docs.python-requests.org/en/latest/user/quickstart/#post-a-multipart-encoded-file)，它将设置正确的标题并为您上传：

```
import requests 
files = {"form_input_field_name": open("filename", "rb")}
requests.post("http://httpbin.org/post", files=files) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-29T17:49:20.027

我遇到了同样的问题，我需要在不使用外部库的情况下进行多部分表单发布。我写了一篇[关于我遇到的问题](http://blog.thesparktree.com/post/114053773684/the-unfortunately-long-story-dealing-with)的完整博文。

我最终使用了[http://code.activestate.com/recipes/146306/](http://code.activestate.com/recipes/146306/)的修改版本。该 url 中的代码实际上只是将文件的内容附加为字符串，这可能会导致二进制文件出现问题。这是我的工作代码。

```
import mimetools
import mimetypes
import io
import http
import json

form = MultiPartForm()
form.add_field("form_field", "my awesome data")

# Add a fake file     
form.add_file(key, os.path.basename(filepath),
    fileHandle=codecs.open("/path/to/my/file.zip", "rb"))

# Build the request
url = "http://www.example.com/endpoint"
schema, netloc, url, params, query, fragments = urlparse.urlparse(url)

try:
    form_buffer =  form.get_binary().getvalue()
    http = httplib.HTTPConnection(netloc)
    http.connect()
    http.putrequest("POST", url)
    http.putheader('Content-type',form.get_content_type())
    http.putheader('Content-length', str(len(form_buffer)))
    http.endheaders()
    http.send(form_buffer)
except socket.error, e:
    raise SystemExit(1)

r = http.getresponse()
if r.status == 200:
    return json.loads(r.read())
else:
    print('Upload failed (%s): %s' % (r.status, r.reason))

class MultiPartForm(object):
    """Accumulate the data to be used when posting a form."""

    def __init__(self):
        self.form_fields = []
        self.files = []
        self.boundary = mimetools.choose_boundary()
        return

    def get_content_type(self):
        return 'multipart/form-data; boundary=%s' % self.boundary

    def add_field(self, name, value):
        """Add a simple field to the form data."""
        self.form_fields.append((name, value))
        return

    def add_file(self, fieldname, filename, fileHandle, mimetype=None):
        """Add a file to be uploaded."""
        body = fileHandle.read()
        if mimetype is None:
            mimetype = mimetypes.guess_type(filename)[0] or 'application/octet-stream'
        self.files.append((fieldname, filename, mimetype, body))
        return

    def get_binary(self):
        """Return a binary buffer containing the form data, including attached files."""
        part_boundary = '--' + self.boundary

        binary = io.BytesIO()
        needsCLRF = False
        # Add the form fields
        for name, value in self.form_fields:
            if needsCLRF:
                binary.write('\r\n')
            needsCLRF = True

            block = [part_boundary,
              'Content-Disposition: form-data; name="%s"' % name,
              '',
              value
            ]
            binary.write('\r\n'.join(block))

        # Add the files to upload
        for field_name, filename, content_type, body in self.files:
            if needsCLRF:
                binary.write('\r\n')
            needsCLRF = True

            block = [part_boundary,
              str('Content-Disposition: file; name="%s"; filename="%s"' % \
              (field_name, filename)),
              'Content-Type: %s' % content_type,
              ''
              ]
            binary.write('\r\n'.join(block))
            binary.write('\r\n')
            binary.write(body)

        # add closing boundary marker,
        binary.write('\r\n--' + self.boundary + '--\r\n')
        return binary 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-25T01:18:06.140

真是巧合，2 年零 6 个月前我创建了这个项目

[https://pypi.python.org/pypi/MultipartPostHandler2](https://pypi.python.org/pypi/MultipartPostHandler2)，修复了 utf-8 系统的 MultipartPostHandler。我也做了一些小改进，欢迎大家测试：）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-11-27T13:27:48.353

为了回答 OP 关于为什么原始代码不起作用的问题，传入的处理程序不是类的实例。线

```
# MIME encode the POST payload
opener = urllib2.build_opener(MultipartPostHandler.MultipartPostHandler) 
```

应该读

```
opener = urllib2.build_opener(MultipartPostHandler.MultipartPostHandler()) 
```

# c# - 使用 Linq 在 C# 中组合结果集

> ID：680313
> 
> 赞同：0
> 
> 时间：2009-03-25T05:19:32.897
> 
> 标签：c#, .net, linq

我有两个表'toc'和'content'，结构如下：

## 目录

身份证
名称(50)

## 内容

id
text(500)
标题(50)
tocid

我正在搜索 toc.name、content.text 和 content.title 中的一些文本，并且需要一个结果集。

是否可以使用 linq(c#) 组合搜索结果。我希望结果集是这样的：

id MatchedRecord tocid(来自 toc 的记录为空)
--- -------- ------
xx xxxxxxxxxxxxxxxxx xxxx

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T05:35:01.643

```
var tocs = from t in db.toc 
           where t.name.Contains("...")
           select new { id=toc.id
                       ,toc=t
                       ,content=(content) null
                       ,tocid=(int?) null
                      };

var contents = from c in db.content
               where c.text.Contains("...") || c.title.Contains("...")
               select new { id=c.id
                           ,toc=(toc) null
                           ,content=c
                           ,tocid=c.tocid
                          };

 var resultset = tocs.Union(contents); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T05:58:52.257

Bart De Smet 有一篇[很棒的博客文章](http://community.bartdesmet.net/blogs/bart/archive/2008/11/03/c-4-0-feature-focus-part-3-intermezzo-linq-s-new-zip-operator.aspx)，介绍了 C# 4.0 中的新 linq operator，它将完全按照您的意愿进行操作。他还展示了操作员添加到现有的 Linq 是多么容易。

新方法将被称为 Zip。不要与压缩混淆，它更像是拉链的动作。

# .net - 使用 BuildManager.GetType 查看 WPF 中的程序集

> ID：680314
> 
> 赞同：0
> 
> 时间：2009-03-25T05:19:35.223
> 
> 标签：.net, wpf, reflection, gettype

我有一个使用反射加载数据提供者的 ASP .NET 应用程序的现有代码。我想在 WPF 应用程序中重新使用此代码，但如果应用程序不是 ASP .NET，则 BuildManager.GetType 似乎只查看顶级程序集。有谁知道如何绕过这个限制？

以下代码引发异常，指出在 System.Web 程序集中找不到 DotNetNuke.Data.MySqlDataProvider。包含 DotNetNuke.Data.MySqlDataProvider 类的程序集肯定存在于已编译的 WPF 应用程序的 bin 文件夹中。

```
Dim objType Type = BuildManager.GetType("DotNetNuke.Data.MySqlDataProvider", True, True) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-14T13:02:43.027

尝试使用 AppDomain 来查找类型，如下所示：

```
 private Type GlobalGetType(string typeName) 
    {
        Type t = null;

        foreach (Assembly ass in AppDomain.CurrentDomain.GetAssemblies()) 
        {
            Type assType = ass.GetType(typeName);

            if (t != null && assType != null)
                throw new ArgumentException("The specified type was found on different assemblies (\"" + t.Assembly.FullName + "\" and  \"" + ass.FullName + "\")");

            if (assType != null)
                t = assType;
        }

        return t;
    } 
```

它将查看应用程序的每个程序集（包括框架程序集）。我不知道是否有办法知道程序集是否是顶级程序集，女巫会优化搜索，但它仍然很快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-28T08:42:07.190

AppDomain.CurrentDomain.GetAssemblies() 解决方案仅在您对已调用/输入的解决方案感兴趣时才有效。在这个答案中，伊戈尔解释了它并介绍了一些解决方法。 [如何在 AppDomain 中找到尚未加载的类型？](https://stackoverflow.com/questions/35418131/how-to-find-a-type-that-is-not-loaded-yet-in-appdomain?answertab=active#tab-top)

# c# - 如何在 Windows 应用程序中的 Vb.net 或 C#.net 中将水晶报表直接打印到网络打印机

> ID：680315
> 
> 赞同：2
> 
> 时间：2009-03-25T05:19:56.767
> 
> 标签：c#, vb.net

我将以下代码编写为，

```
 Dim report As New ReportDocument
        report.PrintOptions.PrinterName = "\\network\printer"
        report.Load(CrystalReportName.rpt, OpenReportMethod.OpenReportByDefault)
        report.PrintToPrinter(1, False, 0, 0) 
```

当我尝试运行此代码时，它显示错误消息为“指定的打印机无效”。如果我给本地打印机名称，它工作正常。但我无法将水晶报表直接打印到网络打印机上。需要帮助。提前致谢。

西瓦库玛

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-07-07T16:25:58.203

使用此代码了解已安装的打印机

```
Imports System.Drawing
Imports System.Drawing.Printing 
```

以及加载功能上的这段代码......您将正确填写打印机及其名称的组合框，然后使用您的代码

```
For Each Printer In PrinterSettings.InstalledPrinters
    cmbPrinters.Items.Add(Printer)
Next 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-12T15:15:08.513

如果其他人仍然有这个问题：

在您尝试打印的水晶报表文档中，转到：

设计 --> 页面设置

可能选择了未安装在服务器端的默认打印机。删除或替换它并保存文档。然后运行您的 .Net 代码以根据需要动态设置打印机。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T05:52:42.460

可能是打印机名称错误。

请在选择网络打印机时使用以下代码调试即将到来的名称

[http://www.codeproject.com/KB/printing/printtoprinter.aspx](http://www.codeproject.com/KB/printing/printtoprinter.aspx)

然后分配适当的名称。

仍然如果它没有解决，可能存在权限问题，然后查看

[http://forums.asp.net/t/1383129.aspx](http://forums.asp.net/t/1383129.aspx)

祝你好运，。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-04T17:37:09.017

对于任何有类似问题的人，这可能是一个解决方案：

```
report.PrintOptions.PrinterName = "\\\\\\\\network\\\\printer" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-07-20T13:04:10.800

用户 4 个反斜杠，即在网络之前的 \\ 和 2 个反斜杠，即在打印机名称之前的 \

```
 \\\\[Network Address]\\[printer name] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-19T17:42:17.683

在 ASP.Net 中，一个简单而实用的解决方案包括安装相同的打印机驱动程序（如 hp 或 zebraa），包括服务器和客户端机器中的版本，它将与`@\\\ipaddress\printername`.

# sql - 下面的“sys”前缀是什么意思？

> ID：680318
> 
> 赞同：1
> 
> 时间：2009-03-25T05:22:22.580
> 
> 标签：sql, oracle, plsql

```
 select sys.database_name,sys.sysevent,sys.login_user from dual; 
```

## 此查询中的 sys 是什么？

* * *

我可以看到 sys 中的其他功能吗？
这样做的查询是什么？
这个系统在什么情况下有用？
关于 sys 的信息将存储在数据库中的什么位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T06:20:55.463

在许多数据库系统中，包括来自 Oracle、Microsoft 和 Sybase 的主要数据库产品，相关的数据库表组可以被拉到一个*模式*中。

一些大型系统（以及，就此而言，一些不太大的系统）将其用作控制访问的一种方式，或者只是作为一种保持事物井井有条的方式。

例如，支持在线目录的表格（例如 Amazon 或 Barnes & Nobel）可能都是`Marketing.*`围绕订单履行的表格`Sales.*`和围绕库存管理的表格`Stock.*`。

您注意到的`sys`架构是系统表所在的位置 - 您可以查询表以了解有关数据库其余部分的详细信息 - 例如列是否已存在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T05:40:35.967

sys 是系统架构。它包含支持 rdbms 的各种表和视图。

您可以查看有关各种模式及其含义的 oracle wiki 文章。

[http://en.wikipedia.org/wiki/Oracle_database](http://en.wikipedia.org/wiki/Oracle_database)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T17:22:20.227

我同意贝文的观点。以下是针对您的问题的一些具体答案：

（我会假设你在谈论 Oracle）

> 我可以看到 sys 中的其他功能吗？

是的，与任何模式一样，您可以使用 Toad、PLSQL Developer 或 Oracle SQL Developer 等数据库开发工具查看 sys 中的过程、函数和包。然而，我的经验表明，与直接跳到源代码相比，参考 Oracle 文档（可在线免费获得）是了解可用功能的更好方法。

> 这样做的查询是什么？

我建议使用上述开发工具之一。如果做不到这一点，请尝试：

```
select * from user_objects where type in ('PACKAGE', 'PROCEDURE', 'FUNCTION'); 
```

一旦您找到了您正在寻找的功能，请使用 SQLPlus 中的 DESCRIBE 命令来确定方法签名和数据类型。

> 这个系统在什么情况下有用？

SYS 最常被用作管理任务的超级用户，因为它比普通模式拥有更多的权限。SYS 还包含许多 Oracle 所依赖的基础设施——不要乱搞 SYS 拥有的对象。

> 关于 sys 的信息将存储在数据库中的什么位置？

使用我上面建议的方法——但我建议你阅读在线文档，而不是直接进入源代码。

# django - Django ORM：缓存和操作 ForeignKey 对象

> ID：680320
> 
> 赞同：8
> 
> 时间：2009-03-25T05:24:34.930
> 
> 标签：django, django-models, orm, django-orm

考虑以下用于太空征服游戏的 models.py 框架：

```
class Fleet(models.Model):
    game = models.ForeignKey(Game, related_name='planet_set')
    owner = models.ForeignKey(User, related_name='planet_set', null=True, blank=True)
    home = models.ForeignKey(Planet, related_name='departing_fleet_set')
    dest = models.ForeignKey(Planet, related_name='arriving_fleet_set')
    ships = models.IntegerField()

class Planet(models.Model):
    game = models.ForeignKey(Game, related_name='planet_set')
    owner = models.ForeignKey(User, related_name='planet_set', null=True, blank=True)
    name = models.CharField(max_length=250)
    ships = models.IntegerField() 
```

对于我正在处理的项目，我有许多这样的数据模型，并且我根据各种数据对象之间有些复杂的交互来更改游戏的状态。我想避免对数据库进行大量不必要的调用，所以每回合一次，我会做类似的事情

1.  从数据库中查询所有舰队、行星和其他对象，并将它们缓存为 python 对象
2.  处理游戏对象，解析游戏状态
3.  将它们保存回数据库

当使用 ForeignKey 对象时，这个模型似乎完全崩溃了。例如，当一个新舰队离开一个星球时，我有一条看起来像这样的线：

```
fleet.home.ships -= fleet.ships 
```

在这条线运行之后，我有其他代码可以改变每个行星上的船只数量，包括行星fleet.home。不幸的是，上一行所做的更改并没有反映在我之前获得的行星查询集中，因此当我在回合结束时保存所有行星时，对舰队.home 的船只的更改会被覆盖。

有没有更好的方法来处理这种情况？或者这就是所有 ORM 的样子？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-25T15:16:03.853

Django 的 ORM 没有实现[身份映射](http://en.wikipedia.org/wiki/Identity_map)（它在[票证跟踪器](http://code.djangoproject.com/ticket/17)中，但不清楚是否或何时实现；至少有一个核心 Django 提交者[表示反对](http://spreadsheets.google.com/ccc?key=pSqnCvef6OXmGWQ9qbEVMeA)）。这意味着如果您通过两个不同的查询路径到达同一个数据库对象，那么您正在使用内存中的不同 Python 对象。

这意味着您的设计（一次将所有内容加载到内存中，修改很多内容，然后最后将其全部保存）使用 Django ORM 是不可行的。首先，因为它通常会在同一对象的重复副本中浪费大量内存加载，其次是因为“覆盖”问题，例如您遇到的问题。

您要么需要重新设计以避免这些问题（要么小心一次只使用一个 QuerySet，在进行另一个查询之前保存任何修改过的内容；或者如果您加载多个查询，手动查找所有关系，不要使用方便的属性遍历 ForeignKeys），或者使用实现标识映射的替代 Python ORM。 [SQLAlchemy](http://www.sqlalchemy.org/)是一种选择。

请注意，这并不意味着 Django 的 ORM 是“坏的”。它针对 Web 应用程序的情况进行了优化，这类问题很少见（我已经使用 Django 进行了多年的 Web 开发，并且从未在实际项目中遇到过这个问题）。如果您的用例不同，您可能需要选择不同的 ORM。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T14:34:54.950

这也许是您正在寻找的：

[https://web.archive.org/web/20121126091406/http://simonwillison.net/2009/May/7/mmalones/](https://web.archive.org/web/20121126091406/http://simonwillison.net/2009/May/7/mmalones/)

# php - 服务器每个会话只允许一个请求

> ID：680327
> 
> 赞同：3
> 
> 时间：2009-03-25T05:30:54.883
> 
> 标签：php, session

**设想：**

xyz.com 的所有页面都使用会话来检查我是否已登录并显示自定义内容。我在 iMac 上使用 Firefox 登录 xyz.com。现在，当我尝试同时访问 xyz.com/page1.php 和 xyz.com/page2.php 时，直到 page1 加载 page2 才被处理。

**代码示例**

xyz.com/contains（链接）：

```
/* session check code here */
[Page1](http://xyz.com/page1.php)
[Page2](http://xyz.com/page2.php) 
```

xyz.com/page1.php 包含：

```
/* session check code here */
echo "Hello";
flush();
sleep(5);
echo "done";
```

xyz.com/page2.php 包含：

```
/* session check code here */
echo "Second Page";
/* {insert code} to log time() to log.txt */ 
```

**测试**

这就是我所做的。我登录到 shell 并保持这个命令运行：

```
user@xyz.com [~/public_html]# tail -f log.txt
```

从我的浏览器（Firefox）（在 xyz.com 上），我在选项卡中打开了 page1 和 page2 的多个实例。如果你能看到，page1 至少需要 5 秒才能加载。现在，在第 1 页加载之前，对第 2 页的请求处于待处理状态。它根本没有处理。我怎么知道？page2 末尾的代码记录了对我正在监视的文件的访问时间。让我们考虑以下情况：

向（按顺序）发送的请求 1\. page1.php 2\. page2.php 3\. page2.php 4\. page1.php 5\. page1.php 6\. page2.php

**结果（大约）**

1237961919 <-- #2
1237961920 <-- #3
1237961931 <-- #6

**预期的（大约）**

1237961915 <-- #2
1237961915 <-- #3
1237961915 <-- #6

^假设所有呼叫同时触发

**观察**

在处理电话时，我显然也无法访问 xyz.com（这是另一个请求）。但是，如果我在另一个浏览器（Safari）中打开它，它运行良好。那是因为它是另一个会话？

**可能的原因**

1.  服务器有一些安全措施吗？

    > 我更像是一名编码员，但如果有人可以指点，我可以检查服务器（VPS）以查看 apache/php 是否配置错误。

2.  我没有正确处理会话？

    > 有关系吗？第二个请求不应该作为不同的线程处理吗？

3.  外星人正在控制我的 VPS。

    > 好吧，开玩笑的。我只是厌倦了追踪这个问题。如果有人知道这里可能出了什么问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-11-09T13:51:06.550

完成会话检查代码后，尝试调用`session_write_close()`page1.php。

```
/* session check code here */
session_write_close();
echo "Hello";
flush(); 
```

这应该关闭会话文件（解除锁定）并且 page2.php 可以打开它。

[http://php.net/manual/en/function.session-write-close.php](http://php.net/manual/en/function.session-write-close.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-10-09T04:36:51.507

您的服务器正在使用基于文件的会话。当一个请求挂起时，会话文件被锁定，服务器将排队任何以后尝试使用同一会话的请求。

切换到数据库存储的会话，你会没事的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T05:52:25.393

[检查](http://kb.mozillazine.org/About:config)您的[network.http.max-persistent-connections-per-server](http://kb.mozillazine.org/Network.http.max-persistent-connections-per-server)和[network.http.max-connections-per-server](http://kb.mozillazine.org/Network.http.max-connections-per-server)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-06T00:11:15.573

不知道php，但是对于asp.net，会话对象一次不能被多个线程用于读/写。所以它产生了你描述的东西。第二个请求等待会话状态被“解锁”以开始处理。这确实是有道理的，这样会话对象对于请求的所有处理都是一致的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T06:00:09.540

从来没有遇到过这样的事情。你确定你没有使用 CGI 而不是 FastCGI 吗？还要检查您的网络服务器产生了多少个 php 进程，以及每个进程可以处理多少个请求。

为了帮助进行测试，您可能希望将[睡眠功能](http://php.net/sleep)放在测试页面中。

# ruby-on-rails - Rails 处理单数/复数可能性的方法是什么？

> ID：680329
> 
> 赞同：23
> 
> 时间：2009-03-25T05:31:17.923
> 
> 标签：ruby-on-rails, ruby

当您向用户展示一条消息，该消息涉及一个可以是单数或复数的实体时，Rails 有一个快捷方式来处理它。我说的是这种情况：

“删除委员会？它的X次会议也将被删除。”

Rails 有一种方法可以根据 X 将“会议”表示为“会议”或“会议”。

我不记得那是什么方式了。不是`String#pluralize`。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-25T05:44:00.483

[ActionView::Helpers::TextHelper::pluralize（计数，单数，复数 = nil）](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-pluralize)

> 尝试[复数](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-pluralize)`singular` 单词 unless `count`is 1。如果提供，它将在`plural`count > 1 时使用 that，否则将使用 Inflector 确定复数形式

例子：

```
 pluralize(1, 'person')
  # => 1 person

  pluralize(2, 'person')
  # => 2 people

  pluralize(3, 'person', 'users')
  # => 3 users

  pluralize(0, 'person')
  # => 0 people 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-07-06T18:37:51.940

**在 Rails 5 中**

```
'person'.pluralize(2)
# => people 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-19T16:19:04.707

`pluralize` works for English, but not most other locales. To handle multiple locales, see [the documentation for locale-specific pluralizations](https://guides.rubyonrails.org/i18n.html#pluralization)

# iphone - 为什么我的 UITableView 不会旋转？

> ID：680333
> 
> 赞同：1
> 
> 时间：2009-03-25T05:33:11.023
> 
> 标签：iphone, cocoa-touch, uitableview

在 Interface Builder 中，我有以下内容

```
UIViewController
-- View
---- TableView 
```

在我的 UIViewController 我已经设置

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return YES;
} 
```

我还有其他在 IB 中的视图控制器。我在这里想念什么？我可以让它旋转的唯一方法是使用变换方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T14:23:01.820

您是否有机会在基于选项卡的应用程序中使用表格视图？如果你是，你只能获得一个支持横向模式的视图，如果标签栏控制器的所有视图控制器都支持横向模式。

除此之外，我看不出您的视图不支持横向模式的任何原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-18T02:34:00.533

问题在于自动调整大小设置。更具体地说，在 Interface Builder 中，确保单击 autoresizing，然后在 Size Inspector 中，确保 tableview 所有它的表视图的父视图在顶部、左侧、右侧都填充了红色箭头，并选择了这两个内部箭头。

我想知道提问者是否真的在主视图的子视图中有表格视图。对于在视图层次结构中更深一层的表视图，我看到了这种行为：

*   主视图
*   *   子视图
*   *   *   表视图

默认情况下，主视图正确设置了自动调整大小的箭头，但如果您添加其他视图，则不会。

在回答有关多个视图控制器问题的问题时：请注意 UIViewController 不是 UIView 的委托。事实上，事件链看起来是相反的——首先系统看到一个自动旋转并告诉 UIViewControllers。如果 UIViewControllers shouldAutoresize 返回 yes，则 UIViewControllers 会调整其主视图的大小。如果设置正确，主视图的大小调整会自动导致其子视图调整大小。

根据Apple docs，您不应该有多个视图控制器来控制视图的不同部分-例如，用于主视图子视图中的表视图的单独表视图控制器-因为它与事件链混在一起-您可以看到这是怎么回事。不知道这是否有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T18:36:41.453

我刚试过这个，它按预期工作。我想你需要提供更多细节。根据我的经验，当视图“无法”旋转时，那是因为某处的某些视图控制器告诉它不要旋转。检查以确保所有视图控制器都从 shouldAutorotateToInterfaceOrientation 返回正确的值：

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-18T09:26:05.783

如果您使用情节提要，您的 VC 包含 UITableview，请检查您的场景是否未选中 AutoLayout。

# asp.net - 服务器标签格式不正确

> ID：680334
> 
> 赞同：3
> 
> 时间：2009-03-25T05:33:14.907
> 
> 标签：asp.net

这真是太愚蠢了，但让我绝对发疯。

```
<input type="radio" name="OptGroup" id="<%#"rbEmail" + ((Action)Container.DataItem).ID %>" value="<%#((Action)Container.DataItem).ID %>" runat="server" /><label for="<%#"rbEmail" + ((Action)Container.DataItem).ID %>"><%#((Action)Container.DataItem).Action %></label> 
```

我在这里做错了什么！我也试过：

```
<input type="radio" name="OptGroup" id='<%#"rbEmail" + ((Action)Container.DataItem).ID %>' value='<%#((Action)Container.DataItem).ID %>' runat="server" /><label for='<%#"rbEmail" + ((Action)Container.DataItem).ID %>'><%#((Action)Container.DataItem).Action %></label> 
```

和

```
<input type="radio" name="OptGroup" id="<%#'rbEmail' + ((Action)Container.DataItem).ID %>" value="<%#((Action)Container.DataItem).ID %>" runat="server" /><label for="<%#'rbEmail' + ((Action)Container.DataItem).ID %>"><%#((Action)Container.DataItem).Action %></label> 
```

我特别不想使用 asp.net 单选按钮，因为它在中继器内创建的 GroupName 存在问题。我想使用一个单选按钮并将其值绑定到我的数据源。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T05:44:53.897

Do you need to access the control server-side? If not, take off the runat="server", you cannot databind to the ID property for a server control. Not sure if thats the problem, since that should give you a different error

EDIT:

Something like this should suit your purposes..

```
<asp:Repeater runat="server">
    <ItemTemplate>
        <label><input type="radio" name="rbEmail" value='<%# ((Action)Container.DataItem).ID %>' /><%# ((Action)Container.DataItem).Action %></label>
    </ItemTemplate>
</asp:Repeater> 
```

Then in the postback, you can get the value from Request.Form["rbEmail"]

EDIT2:

Fully tested simple page example..

Default.aspx

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Untitled Page</title>
</head>
<body>
    <form id="form1" runat="server">
        <asp:Repeater ID="Repeater1" runat="server">
            <ItemTemplate>
                <label><input type="radio" name="rbEmail" value='<%# Container.DataItem %>' /><%# Container.DataItem %></label>
            </ItemTemplate>
        </asp:Repeater>
        <asp:Button ID="submit" runat="server" OnClick="submit_Click" Text="submit" />
    </form>
</body>
</html> 
```

Default.aspx.cs

```
using System;

public partial class _Default : System.Web.UI.Page 
{
    protected void Page_Load(object sender, EventArgs e)
    {
        Repeater1.DataSource = new string[] { "Hello", "World" };
        Repeater1.DataBind();
    }

    protected void submit_Click(object sender, EventArgs e)
    {
        Response.Write(Request.Form["rbEmail"]);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T05:42:26.430

为您的 html 使用单引号。例如：

```
<input type='radio' name='OptGroup' id='<%#"rbEmail" + ((Action)Container.DataItem).ID %>' value='<%#((Action)Container.DataItem).ID %>' runat='server' /><label for='<%#"rbEmail" + ((Action)Container.DataItem).ID %>'><%#((Action)Container.DataItem).Action %></label> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T05:40:24.687

第一个是错误的，因为正如您所怀疑的那样，属性值的双引号和字符串文字周围的双引号会使解析器感到困惑。

不过，我一生都看不到第二个有什么问题。您是否也遇到与该错误相同的“格式不正确”错误？

# python - Python 2.5.2 续

> ID：680336
> 
> 赞同：0
> 
> 时间：2009-03-25T05:34:45.217
> 
> 标签：python, ironpython

这是我的问题 Python2.5.2 的延续 我开发的代码与 clr.Addreference() 一起工作得很好。现在你的问题是我必须将使用.NET开发的dll的ny脚本加载到另一个应用程序。他们使用QT来实现它。那个应用程序中有一个脚本控制台。当我输入'import clr'时，它说'没有名为 clr' 或 'Cannot import clr' 的模块。我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T05:50:48.393

您将无法在该应用程序中运行您的脚本。该 QT 应用程序中的脚本控制台无疑使用普通的 ol' CPython 而不是 IronPython。如果不对托管 python 控制台的应用程序进行重大手术，就没有真正的好方法来改变它。

# c# - 无法上传大小超过 5000 k 的 zip 文件

> ID：680339
> 
> 赞同：1
> 
> 时间：2009-03-25T05:35:48.507
> 
> 标签：c#, .net, asp.net

我是 C# 的新手，我可以将文件上传到大小较小的服务器，但是当我尝试上传大小超过 5000k 的文件时，它会出现异常。

这是我的 C# 代码

```
private void UploadFile(string filename)
{
  try
  {
    PeopleMatrixService peopleMetrixService = new PeopleMatrixService();

    String strFile = System.IO.Path.GetFileName(filename);
    // TestUploader.Uploader.FileUploader srv = new TestUploader.Uploader.FileUploader();
    FileInfo fInfo = new FileInfo(filename);
    long numBytes = fInfo.Length;
    double dLen = Convert.ToDouble(fInfo.Length / 10000000);
    if (dLen < 8)
    {
      FileStream fStream = new FileStream(filename, FileMode.Open, FileAccess.Read);
      BinaryReader br = new BinaryReader(fStream);
      byte[] data = br.ReadBytes((int)numBytes);
      br.Close();
      string sTmp = peopleMetrixService.UploadFile(data, strFile);
      fStream.Close();
      fStream.Dispose();
      MessageBox.Show("File Upload Status: " + sTmp, "File Upload");
    }
    else
    {
      MessageBox.Show("The file selected exceeds the size limit for uploads.", "File Size");
    }
  }
  catch (Exception ex)
  {
    MessageBox.Show(ex.Message.ToString(), "Upload Error");
  }
} 
```

和我在网络服务中的代码

```
[WebMethod]
public string UploadFile(byte[] f, string fileName)
{
  try
  {
    MemoryStream ms = new MemoryStream(f);
    FileStream fs = new FileStream(System.Web.Hosting.HostingEnvironment.MapPath("~/Response Attachments/") + fileName, FileMode.Create);
              //FileStream fs = new FileStream(Server.MapPath("~/Response Attachments/") + fileName, FileMode.Create);
    ms.WriteTo(fs);
    ms.Close();
    fs.Close();
    fs.Dispose();
    return "OK";
  }
  catch (Exception ex)
  {
    return ex.Message.ToString();
  }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T05:43:57.830

默认情况下，maxRequestLength 设置为 4096 (4mb)，您需要在 web.config 文件中将其更改为更大的大小。

请参阅：http: [//msdn.microsoft.com/en-us/library/e1f13641 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/e1f13641(VS.80).aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T05:42:52.700

它是 web.config 中的“httpruntime”部分，例如：

```
<configuration>
  <system.web>
    <httpRuntime executionTimeout="300" maxRequestLength="20480" />
  </system.web>
</configuration> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T05:42:25.340

您在 web.config 文件中设置的最大大小是多少？检查[这个](http://msdn.microsoft.com/en-us/library/e1f13641(VS.71).aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T05:44:36.690

默认情况下，Web 服务器将接受小于 4MB 的上传；必须更新 web.config 文件才能支持更大的上传。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-21T22:11:10.920

把它放在你的 web.config 中

```
 <system.web>
     <httpRuntime executionTimeout="360" maxRequestLength="100000" /> 
```

这可以实现 360 秒的超时和一次 100,000 Kb 的上传数据。

如果这不起作用，请在您的 IIS 服务器上运行此命令。（替换 [IISWebsitename]）

```
C:\Windows\System32\inetsrv>appcmd set config "[IISWebsitename]" -section:requestFiltering -requestLimits.maxAllowedContentLength:100000000 -commitpath:apphost 
```

这一次可以上传 100,000,000 字节的数据。

# php - 如何在 PHP 函数中设置引用？

> ID：680341
> 
> 赞同：1
> 
> 时间：2009-03-25T05:36:05.243
> 
> 标签：php, reference

我正在尝试在函数中设置引用。但是，我无法让这个工作。

我试过的代码：

```
function set(&$x, &$y)
{
    $x =& $y[2];
}

$y = array(
    0,
    1,
    array('something')
);

$x = array('old_val');
print "1\. inited, x is:\n";
print_r($x);

set($x, $y);

print "\n2\. now, x is: ";
print_r($x); 
```

输出：

```
1\. inited, x is:
Array
(
    [0] => old_val
)

2\. now, x is: Array
(
    [0] => old_val
) 
```

我期望 $x 的值与 $y[2] 相同。此外，对 $x 的任何进一步修改都应更改 $y[2]。（如 C 中的指针赋值`x = &y[2];`：）我做错了什么？任何建议表示赞赏。

编辑：实际上，测试代码中的函数 set() 是为了我的测试目的而简化的。它实际上是 select_node(&$x, &$tree, $selector) ：这将从树中选择一个与 $selector 匹配的节点并将其分配给 $x。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T06:16:59.920

引用不是指针，并且行为略有不同。

发生的事情是 set() 函数内的 $x 变量被绑定到与 $y[2] 相同的位置，但 set() 内的 $x 与 set() 外的 $x 不同。它们都指向同一个位置，但您只更新了 set() 内部的位置，一旦 set() 返回，它就不再相关。无法在调用范围内*绑定*$x，因为它不存在于函数内部。

见：[http ://ca3.php.net/manual/en/language.references.arent.php](http://ca3.php.net/manual/en/language.references.arent.php)

您可能希望声明 set() 以返回引用：

```
function &set(&$x, &$y) {} 
```

并这样称呼它：

```
$x =& set($x,$y); 
```

见[http://ca3.php.net/manual/en/language.references.return.php](http://ca3.php.net/manual/en/language.references.return.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T06:16:32.497

这里没有错。函数**set()**中的**x**是全局变量**x**的**局部**别名。换句话说，函数 set() 中的全局**x**和**x**指向相同的值。执行此操作后：

 ******```
$x =& $y[2]; 
```

局部**x**现在指向**$y[2]**的值，但全局**x**仍然指向旧值。您需要阅读此页面[http://php.net/references](http://php.net/references)

# ruby-on-rails - 如何加快 Scriptaculous 自动补全？

> ID：680343
> 
> 赞同：1
> 
> 时间：2009-03-25T05:39:59.697
> 
> 标签：ruby-on-rails, ajax, scriptaculous

无论如何，脚本自动完成器可以做得更快吗？

在发送建议之前，自动完成器是否有类似时间属性的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T05:56:37.630

您应该查看 AutoCompleter 的 minChars 和频率字段：

[http://wiki.github.com/madrobby/scriptaculous/ajax-autocompleter](http://wiki.github.com/madrobby/scriptaculous/ajax-autocompleter)

# javascript - 识别引用 javascript 文件的表单

> ID：680346
> 
> 赞同：1
> 
> 时间：2009-03-25T05:40:27.997
> 
> 标签：javascript

嗨，我有一个 aspx 表单，其中我指的是一个 JavaScript 文件。我正在使用 window.onload 方法来初始化一个对象。如何在 JavaScript 文件的函数中获取表单对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T05:44:06.240

您的表单将像这样定义：

```
<form name="my_form" id="my_form"></form> 
```

您可以使用以下不同的方法对表单进行操作：

```
var form = document.forms[0]; // Not the best choice due to hard-coding an index.
var form = document.forms["my_form"]; // Retrieves the form by name
var form = document.getElementById("my_form"); // Retrieves by ID. 
```

# database - 在数据库中使用 rowid 有什么缺点吗？

> ID：680364
> 
> 赞同：2
> 
> 时间：2009-03-25T05:48:47.197
> 
> 标签：database

如题所示，在应用程序中访问数据库时，使用 rowid 有什么缺点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T06:03:58.593

尽管 rowid 唯一标识表中的行，但如果基础表是[索引组织表](http://www.csee.umbc.edu/help/oracle8/server.815/a68003/01_07iot.htm)或[分区表](http://www.oracle-base.com/articles/8i/PartitionedTablesAndIndexes.php)，它可能会更改其值。

此外，如果使用 EXP/IMP 导出和导入表，rowids 也会发生变化。

这意味着不应将 rowid 存储起来以供以后重新使用，因为相应的行可能不存在或包含完全不同的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T05:54:14.903

不能保证 RowId 对于特定行保持不变，因此最好使用主键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T06:39:25.607

您可以在应用程序中使用 ROWID 来查找您之前在同一会话中查看的记录。通常这将是获得记录的最快方式。

但是，您永远不应该将此 ROWID 存储在数据库中 - 或其他任何地方 - 因为从备份恢复等可能会更改 ROWID。

如果您使用的是 Oracle，请使用[`UROWID`](http://download-east.oracle.com/docs/cd/B10500_01/server.920/a96524/c13datyp.htm#918)- Universal ROWID - 因为这将停止使用物理 ROWID 并开始在 ROWID 可能在会话期间更改的表上使用逻辑 ROWID，例如在索引组织的表上。

# php - 在 PHP 中模拟命名函数参数，好主意还是坏主意？

> ID：680368
> 
> 赞同：20
> 
> 时间：2009-03-25T05:52:10.137
> 
> 标签：php, function, named-parameters

如果我编写这样的函数，可以在 PHP 中模拟命名函数参数

```
function pythonic(array $kwargs)
{
    extract($kwargs);
    // .. rest of the function body
}

// if params are optional or default values are required
function pythonic(array $kwargs = array('name'=>'Jon skeet'))
{
    extract($kwargs);
    // .. rest of the function body
} 
```

除了在 IDE 中失去智能感知之外，这种方法还有哪些其他可能的缺点？

编辑：

**安全性：**在这种情况下，安全性不应该不是问题吗，因为提取的变量仅限于函数范围？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-25T07:21:12.230

我建议使用关联数组来传递命名参数，但将它们保留在数组中而不提取它们。

```
function myFunc(array $args) {
    echo "Hi, " . $args['name'];
    // etc
} 
```

这有几个原因。查看该函数，您可以非常清楚地看到我指的是传递给函数的参数之一。如果您提取它们，并且没有注意到`extract()`您（或下一个人）会在那里挠头想知道这个“ `$name`”变量来自哪里。即使您*确实*知道您正在提取局部变量的参数，它在一定程度上仍然是一个猜谜游戏。

其次，它确保其他代码不会覆盖 args。您可能已经编写了函数，只希望有名为`$foo`and的参数`$bar`，因此在您的其他代码中，您定义`$baz = 8;`了例如。稍后，您可能希望扩展您的函数以获取一个名为“baz”的新参数，但忘记更改您的其他变量，因此无论在参数中传递什么，`$baz`都将始终设置为 8。

使用数组也有一些好处（这些同样适用于提取或留在数组中的方法）：您可以在每个名为的函数的顶部设置一个变量`$defaults`：

```
function myFunc (array $args) {
    $default = array(
        "name" => "John Doe",
        "age" => "30"
    );
    // overwrite all the defaults with the arguments
    $args = array_merge($defaults, $args);
    // you *could* extract($args) here if you want

    echo "Name: " . $args['name'] . ", Age: " . $args['age'];
}

myFunc(array("age" => 25)); // "Name: John Doe, Age: 25" 
```

您甚至可以删除所有`$args`没有相应`$default`值的项目。这样您就可以确切地知道您拥有哪些变量。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-25T11:29:51.853

这是您可以执行此操作的另一种方法。

```
/**
 * Constructor.
 * 
 * @named string 'algorithm'
 * @named string 'mode'
 * @named string 'key'
 */
public function __construct(array $parameter = array())
{
    $algorithm = 'tripledes';
    $mode = 'ecb';
    $key = null;
    extract($parameter, EXTR_IF_EXISTS);
    //...
} 
```

通过此设置，您将获得默认参数，您不会在 IDE 中丢失智能感知，并且 EXTR_IF_EXISTS 通过提取已经作为变量存在的数组键使其安全。

（顺便说一句，从您提供的示例中创建默认值并不好，因为如果提供的参数数组没有“名称”索引，您的默认值将丢失。）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-25T06:02:17.803

以我的经验，这种方法只有在两件事之一为真时才真正有益

1.  无论出于何种情有可原的原因，您的论点签名都很大。我最多会增加 6 个 - 不是出于任何特定原因，虽然看起来是正确的 - 但我承认这个数字是任意的。
2.  您的所有或许多参数都是可选的，有时您只需要为第 5 个或类似的东西设置一个值。写的很烦`someFunc( null, null, null, null, 1 );`

如果其中任何一个对您来说都是正确的，那么使用关联数组伪造命名参数可能是正确的实现。除了知道何时避免提取（或完全避免提取）之外，我无法立即想到其他缺点。

话虽如此，通常这两个问题也可以通过重构来解决。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-04T16:47:05.207

以我的经验，这种方法的缺点是要编写更多的代码。考虑这样的事情：

```
function someFunc($requiredArg, $arg1 = "default11", $arg2 = "default2") { 
```

要在传递数组中的所有内容时模拟这种行为，您需要编写更多代码，并且“函数签名”将不那么“清晰和明显”。

```
function someFunc($requiredArg, $optionalArgs) {
    // see other answers for good ways to simulate "named parameters" here 
```

我想知道 PHP 在未来的版本中解决这个问题是否是一个好主意，也许有类似 Pascal 或 VB 语法的东西可用于函数参数。

无论如何，我只在真正需要时才在单个数组中传递参数——比如具有在开发过程中可能会发生很大变化的参数集的函数。这些函数通常也有许多参数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-06T07:47:59.337

其他人已经回答了你的其他观点，我只想对安全方面发表评论。

> 安全性：在这种情况下，安全性不应该不是问题吗，因为提取的变量仅限于函数范围？

是和不是。您编写的代码可能（取决于您是否总是在此调用后初始化变量）覆盖您的 vars。例子：

```
function pythonic(array $kwargs = array('name'=>'Jon skeet'))
{
    $is_admin = check_if_is_admin();  // initialize some variable...

    extract($kwargs);

    // Q: what is the value of $is_admin now? 
    // A: Depends on how this function was called... 
    // hint: pythonic([ 'is_admin' => true ])
} 
```

使这段代码“有点安全”的原因是你是调用它的人 - 所以用户不能提供任意参数（当然，除非你在那里重定向 POST vars ;）。

根据经验，你应该避免这种魔法。与`extract()`可能有意想不到的副作用，所以你不应该使用它。实际上，我想不出在任何应用程序中对 extract() 函数的合法使用（我认为我自己从未使用过它）。

# iphone - 如何移动像素？

> ID：680371
> 
> 赞同：0
> 
> 时间：2009-03-25T05:53:36.497
> 
> 标签：iphone

我正在创建一个 iPhone 应用程序，并且我正在使用 OpenGL，这是我的新手。我必须更改像素位置，谁能告诉我处理像素的功能？

一些示例源代码来说明这个想法将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T06:32:39.010

我不是 iPhone 问题方面的专家，而且我是一名中级 OpenGL 程序员，所以请把它当作它的价值——

OpenGL 不鼓励直接进行像素操作，主要是因为在处理任何类型的硬件加速时它没有多大意义。帧缓冲区通常不再直接存储在图形 RAM 中，虽然将位推送到图形内存是快速的，但将信息拉回是一种罕见且未经优化的情况。3-d 卡片针对三角形而非像素的快速纹理进行了优化。

在过去的好日子里，当帧缓冲区位于主内存中时，这没什么大不了的，但情况已经改变了。因此，虽然通常仍然可以窥视和戳单个像素，但通过将您的操作重新表达为原生 OpenGL 方法，您通常会获得显着的速度提升。顺便说一句，您可以使用 GL_POINTS 写入像素，但同样，它很慢。

尽管如此，在某些效果中，就地操作像素是有用的——等离子和火焰效果确实无法以其他任何方式完成。为此，我建议你模拟一个帧缓冲区——分配你自己的，然后直接写入它。然后，当您需要显示它时，立即将整个块blit 到屏幕上。

# .net - 组合框中每个项目的工具提示

> ID：680373
> 
> 赞同：22
> 
> 时间：2009-03-25T05:54:54.530
> 
> 标签：.net, winforms, combobox, tooltip

我只想为组合框中的每个项目添加一个工具提示。我正在使用 c#.net windows 应用程序。

没有像

组合框.items[1].tooltip();

有什么方法可以添加tooltip吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2011-02-19T21:42:25.140

这个问题实际上有几个合理的解决方案。MSDN 论坛有一个[ComboBox 项目突出显示事件](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/e234c4a7-0cf7-4284-a072-8152f7593002/)帖子，其中包含两种可能性，一种来自 nobugz，一种来自 agrobler。它们中的每一个都提供代码来子类化组合框，该组合框应该处理组合框下拉列表中各个项目的工具提示。Agrobler 的解决方案看起来更加精致，因为他/她甚至包括一些漂亮的插图，但不幸的是（至少对我而言）不清楚如何填充控件的关键 ToolTipMember 属性。

这两种解决方案似乎都允许将任意工具提示分配给单个项目。一个更具体但更常见的情况是，当您知道您的项目可能太长而无法适应 ComboBox 的宽度时，您只希望工具提示反映项目的文本。在我自己的情况下，我有一个包含完整文件路径的 ComboBox 实例，因此很容易看到内容可能超出 ComboBox 宽度的位置。

Zhi-Xin Ye 在 MSDN 论坛帖子[Windows Dropdown question](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/e0418c61-a614-4f0d-8cf4-59cf9cc5bba5/)中提供了一种解决方案，可以解决这个更具体的问题，而且要简单得多。我在这里完整地复制了代码。（请注意，此代码假定您已经创建了一个名为 Form1 的表单并连接了所示的负载处理程序，还添加了一个名为 comboBox1 的 ComboBox 和一个工具提示处理程序 toolTip1。）

```
private void Form1_Load(object sender, EventArgs e)
{
    this.comboBox1.DrawMode = DrawMode.OwnerDrawFixed;
    this.comboBox1.DrawItem += new DrawItemEventHandler(comboBox1_DrawItem);
}

void comboBox1_DrawItem(object sender, DrawItemEventArgs e)
{
    string text = this.comboBox1.GetItemText(comboBox1.Items[e.Index]);
    e.DrawBackground();
    using (SolidBrush br = new SolidBrush(e.ForeColor))
    { e.Graphics.DrawString(text, e.Font, br, e.Bounds); }

    if ((e.State & DrawItemState.Selected) == DrawItemState.Selected)
    { this.toolTip1.Show(text, comboBox1, e.Bounds.Right, e.Bounds.Bottom); }
    else { this.toolTip1.Hide(comboBox1); }
    e.DrawFocusRectangle();
} 
```

虽然简单而简洁，但此代码确实存在一个缺陷（正如上述 MSDN 线程的回复中所指出的那样）：当您将​​鼠标（不单击）从一个下拉项移动到下一项时，只有每隔*一个*显示持久的工具提示！该修复仅由该线程上的另一个条目暗示，因此我认为在此处提供完整的更正代码会很有用：

```
private void Form1_Load(object sender, EventArgs e)
{
    comboBox1.DrawMode = DrawMode.OwnerDrawFixed;
    comboBox1.DrawItem += comboBox1_DrawItem;
    comboBox1.DropDownClosed += comboBox1_DropDownClosed;
}

private void comboBox1_DropDownClosed(object sender, EventArgs e)
{
    toolTip1.Hide(comboBox1);
}

private void comboBox1_DrawItem(object sender, DrawItemEventArgs e)
{
    if (e.Index < 0) { return; } // added this line thanks to Andrew's comment
    string text = comboBox1.GetItemText(comboBox1.Items[e.Index]);
    e.DrawBackground();
    using (SolidBrush br = new SolidBrush(e.ForeColor))
    { e.Graphics.DrawString(text, e.Font, br, e.Bounds); }
    if ((e.State & DrawItemState.Selected) == DrawItemState.Selected)
    { toolTip1.Show(text, comboBox1, e.Bounds.Right, e.Bounds.Bottom); }
    e.DrawFocusRectangle();
} 
```

除了删除一些冗余的代码部分（例如“this”限定符）之外，主要区别是将 toolTip1.Hide 调用移到 DropDownClosed 事件处理程序中。把它从 DrawItem 处理程序中取出，就消除了上面提到的缺陷；但是当下拉关闭时您需要关闭它，否则最后显示的工具提示将保留在屏幕上。

**2012.07.31 附录**

只是想提一下，我已经创建了一个包含此工具提示功能的复合 ComboBox，因此如果您使用我的库，则根本不需要编写代码。只需将 ComboBoxWithTooltip 拖到 Visual Studio 设计器上即可。[深入了解我的API 页面](http://cleancode.sourceforge.net/api/csharp/)上的 ComboBoxWithTooltip或[下载](http://cleancode.sourceforge.net/wwwdoc/download.html)我的开源 C# 库以开始使用。（请注意，Andrew 捕获的错误补丁将在 1.1.04 版中发布，即将发布。）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-10-20T05:26:43.093

```
private void comboBox1_SelectedIndexChanged(object sender, System.EventArgs e)
{
    ToolTip toolTip1 = new ToolTip();
    toolTip1.AutoPopDelay = 0;
    toolTip1.InitialDelay = 0;
    toolTip1.ReshowDelay = 0;
    toolTip1.ShowAlways = true;
    toolTip1.SetToolTip(this.comboBox1, comboBox1.Items[comboBox1.SelectedIndex].ToString()) ;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-10-08T09:30:24.890

我的解决方案：

```
ToolTip toolTip = new ToolTip() { AutoPopDelay = 0, InitialDelay = 0, ReshowDelay = 0, ShowAlways = true, };
comboBox.DrawMode = DrawMode.OwnerDrawFixed;
comboBox.DrawItem += (s, e) =>
{
    e.DrawBackground();
    string text = comboBox.GetItemText(comboBox.Items[e.Index]);
    using (SolidBrush br = new SolidBrush(e.ForeColor))
        e.Graphics.DrawString(text, e.Font, br, e.Bounds);
    if ((e.State & DrawItemState.Selected) == DrawItemState.Selected && comboBox.DroppedDown)
        toolTip.Show(text, comboBox, e.Bounds.Right, e.Bounds.Bottom + 4);
    e.DrawFocusRectangle();
};
comboBox.DropDownClosed += (s, e) =>
    toolTip.Hide(comboBox); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-29T17:19:01.933

基于 Michael Sorens 的解决方案（修复了一些错误并添加了功能）。这样做的几件事：

*   它将显示与下拉列表关联的文件的预览（在本例中为 XML 文件中的书名，或者您可以在工具提示中添加更多描述，或显示完全不同的内容）。
*   它不会在下拉列表中显示“0”位置的工具提示（我有一个占位符，但您可以简单地删除`e.index>0`第二个`if`语句中的）。
*   当下拉菜单关闭时，它不会显示工具提示。

    ```
    private void comboBox1_DrawItem(object sender, DrawItemEventArgs e)
    {
        ComboBox comboBox1 = (ComboBox)sender;
        if (e.Index >= 0)
        {//Draws all items in drop down menu
            String text = comboBox1.GetItemText(comboBox1.Items[e.Index]);
            e.DrawBackground();
            using (SolidBrush br = new SolidBrush(e.ForeColor))
            {
                e.Graphics.DrawString(text, e.Font, br, e.Bounds);
            }

            if ((e.State & DrawItemState.Selected) == DrawItemState.Selected && e.Index > 0 && comboBox1.DroppedDown)
            {//Only draws tooltip when item 1+ are highlighted.  I had a "--" placeholder in the 0 position
                try
                {
                    XmlDocument doc;
                    XmlNode testNode;
                    doc = new XmlDocument();
                    String testXMLDoc = String.Format(@"{0}\{1}.xml", filePath, fileName);//global variables
                    String toolTip = "---Preview of File---";
                    doc.Load(testXMLDoc);
                    testNode = doc.SelectSingleNode("/Books");
                    if (testNode.HasChildNodes)
                    {
                        XmlNodeList nodeList = testNode.SelectNodes("Book");
                        foreach (XmlNode xmlNode in nodeList)
                        {
                            toolTip += "\r\n" + xmlNode.SelectSingleNode("Title").InnerXml;
                        }
                    }
                    this.toolTipHelp.Show(toolTip, comboBox1, e.Bounds.Right, e.Bounds.Bottom);
                }
                catch (Exception tp)
                {
                    Debug.WriteLine("Error in comboBox1 tooltip: " + tp);
                }
            }
            else
            {
                this.toolTipHelp.Hide(comboBox1);
            }
        }
        else
        {
            this.toolTipHelp.Hide(comboBox1);
        }
        e.DrawFocusRectangle();
    } 
    ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T05:59:29.277

您将需要创建自己的[UserControl](http://msdn.microsoft.com/en-us/library/system.windows.forms.usercontrol.aspx)。

组合框中的每个项目都有一个工具提示是一个不寻常的要求。也许您可以改用 2 列组合框？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-26T05:37:29.050

如果您从数据源加载，请将数据放入数据表并将其设置为组合框。我的数据表有三列 ID、NAME、DEFINITION。下面是我的代码：

```
InputQuery = "select * from ds_static_frequency";
        TempTable = UseFunc.GetData(InputQuery);

        cmbxUpdateFrequency.DataSource = TempTable;
        cmbxUpdateFrequency.DataTextField = "NAME";
        cmbxUpdateFrequency.DataValueField = "ID";
        cmbxUpdateFrequency.DataBind();

        foreach (DataRow dr in TempTable.Rows)
        {                
            int CurrentRow = Convert.ToInt32(dr["ID"].ToString());
            cmbxUpdateFrequency.Items[CurrentRow - 1].ToolTip = dr["Definition"].ToString();               
        } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-11-30T13:30:10.240

使用 WPF 使用 ComboBox.ItemTemplate

```
<ComboBox               
    ItemsSource="{Binding Path=ComboBoxItemViewModels}"
    SelectedValue="{Binding SelectedComboBoxItem, 
    SelectedValuePath="Name"                
>
  <ComboBox.ItemTemplate>
    <DataTemplate>
      <TextBlock Text="{Binding Path=Name}" ToolTip="{Binding Path=Description}"/>
    </DataTemplate>
  </ComboBox.ItemTemplate>
</ComboBox> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-11T22:16:59.457

我的解决方案：

```
public class ToolTipComboBox: ComboBox
{
    #region Fields

    private ToolTip toolTip;
    private bool _tooltipVisible;
    private bool _dropDownOpen;
    #endregion

    #region Types

    [StructLayout(LayoutKind.Sequential)]
    // ReSharper disable once InconsistentNaming
    public struct COMBOBOXINFO
    {
        public Int32 cbSize;
        public RECT rcItem;
        public RECT rcButton;
        public ComboBoxButtonState buttonState;
        public IntPtr hwndCombo;
        public IntPtr hwndEdit;
        public IntPtr hwndList;
    }

    public enum ComboBoxButtonState
    {
        // ReSharper disable once UnusedMember.Global
        StateSystemNone = 0,
        // ReSharper disable once UnusedMember.Global
        StateSystemInvisible = 0x00008000,
        // ReSharper disable once UnusedMember.Global
        StateSystemPressed = 0x00000008
    }

    [DllImport("user32.dll")]
    public static extern bool GetComboBoxInfo(IntPtr hWnd, ref COMBOBOXINFO pcbi);
    [DllImport("user32.dll", SetLastError = true)]
    public static extern bool GetWindowRect(IntPtr hwnd, out RECT lpRect);

    #endregion

    #region Properties

    private IntPtr HwndCombo
    {
        get
        {
            COMBOBOXINFO pcbi = new COMBOBOXINFO();
            pcbi.cbSize = Marshal.SizeOf(pcbi);
            GetComboBoxInfo(Handle, ref pcbi);
            return pcbi.hwndCombo;
        }
    }

    private IntPtr HwndDropDown
    {
        get
        {
            COMBOBOXINFO pcbi = new COMBOBOXINFO();
            pcbi.cbSize = Marshal.SizeOf(pcbi);
            GetComboBoxInfo(Handle, ref pcbi);
            return pcbi.hwndList;
        }
    }

    [Browsable(false)]
    public new DrawMode DrawMode
    {
        get { return base.DrawMode; }
        set { base.DrawMode = value; }
    }

    #endregion

    #region ctor

    public ToolTipComboBox()
    {
        toolTip = new ToolTip
        {
            UseAnimation = false,
            UseFading = false
        };

        base.DrawMode = DrawMode.OwnerDrawFixed;
        DrawItem += OnDrawItem;
        DropDownClosed += OnDropDownClosed;
        DropDown += OnDropDown;
        MouseLeave += OnMouseLeave;
    }

    #endregion

    #region Methods

    private void OnDropDown(object sender, EventArgs e)
    {
        _dropDownOpen = true;
    }

    private void OnMouseLeave(object sender, EventArgs e)
    {
        ResetToolTip();
    }

    private void ShowToolTip(string text, int x, int y)
    {
        toolTip.Show(text, this, x, y);
        _tooltipVisible = true;
    }

    private void OnDrawItem(object sender, DrawItemEventArgs e)
    {
        ComboBox cbo = sender as ComboBox;
        if (e.Index == -1) return;

        // ReSharper disable once PossibleNullReferenceException
        string text = cbo.GetItemText(cbo.Items[e.Index]);
        e.DrawBackground();

        if ((e.State & DrawItemState.Selected) == DrawItemState.Selected)
        {
            TextRenderer.DrawText(e.Graphics, text, e.Font, e.Bounds.Location, SystemColors.Window);

            if (_dropDownOpen)
            {
                Size szText = TextRenderer.MeasureText(text, cbo.Font);
                if (szText.Width > cbo.Width - SystemInformation.VerticalScrollBarWidth && !_tooltipVisible)
                {
                    RECT rcDropDown;
                    GetWindowRect(HwndDropDown, out rcDropDown);

                    RECT rcCombo;
                    GetWindowRect(HwndCombo, out rcCombo);

                    if (rcCombo.Top > rcDropDown.Top)
                    {
                        ShowToolTip(text, e.Bounds.X, e.Bounds.Y - rcDropDown.Rect.Height - cbo.ItemHeight - 5);
                    }
                    else
                    {
                        ShowToolTip(text, e.Bounds.X, e.Bounds.Y + cbo.ItemHeight - cbo.ItemHeight);
                    }
                }
            }
        }
        else
        {
            ResetToolTip();
            TextRenderer.DrawText(e.Graphics, text, e.Font, e.Bounds.Location, cbo.ForeColor);
        }

        e.DrawFocusRectangle();
    }

    private void OnDropDownClosed(object sender, EventArgs e)
    {
        _dropDownOpen = false;
        ResetToolTip();
    }

    private void ResetToolTip()
    {
        if (_tooltipVisible)
        {
            // ReSharper disable once AssignNullToNotNullAttribute
            toolTip.SetToolTip(this, null);
            _tooltipVisible = false;
        }
    }

    #endregion
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-03-03T04:41:07.937

下面是 C# 代码，用于在宽度大于组合框控件宽度的组合框项目上显示工具提示。一旦用户将鼠标悬停在此类组合框上，将显示工具提示：

```
 this.combo_box1.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
 this.combo_box1.DrawMode = DrawMode.OwnerDrawFixed;
 this.combo_box1.DrawItem += new DrawItemEventHandler(combo_box1_DrawItem);
 this.combo_box1.DropDownClosed += new EventHandler(combo_box1_DropDownClosed);
 this.combo_box1.MouseLeave += new EventHandler(combo_box1_Leave);

 void combo_box1_DrawItem(object sender, DrawItemEventArgs e)
        {
            if (e.Index < 0) { return; }
            string text = combo_box1.GetItemText(combo_box1.Items[e.Index]);
            e.DrawBackground();
            using (SolidBrush br = new SolidBrush(e.ForeColor))
            {
                e.Graphics.DrawString(text, e.Font, br, e.Bounds);
            }

            if ((e.State & DrawItemState.Selected) == DrawItemState.Selected && combo_box1.DroppedDown)
            {
                if (TextRenderer.MeasureText(text, combo_box1.Font).Width > combo_box1.Width)
                {
                    toolTip1.Show(text, combo_box1, e.Bounds.Right, e.Bounds.Bottom);
                }
                else
                {
                    toolTip1.Hide(combo_box1);
                }
            }
            e.DrawFocusRectangle();
        }

        private void combo_box1_DropDownClosed(object sender, EventArgs e)
        {
            toolTip1.Hide(combo_box1);
        }

        private void combo_box1_Leave(object sender, EventArgs e)
        {
            toolTip1.Hide(combo_box1);
        }

        private void combo_box1_MouseHover(object sender, EventArgs e)
        {
            if (!combo_box1.DroppedDown && TextRenderer.MeasureText(combo_box1.SelectedItem.ToString(), combo_box1.Font).Width > combo_box1.Width)
            {
                toolTip1.Show(combo_box1.SelectedItem.ToString(), combo_box1, combo_box1.Location.X, combo_box1.Location.Y);
            }
        } 
```

这是更多详细信息的链接 - [http://newapputil.blogspot.in/2016/12/display-tooltip-for-combo-box-item-cnet.html](http://newapputil.blogspot.in/2016/12/display-tooltip-for-combo-box-item-cnet.html)

# html - 为什么浏览器文本在特定浏览器/机器上会更大？

> ID：680382
> 
> 赞同：1
> 
> 时间：2009-03-25T06:01:41.033
> 
> 标签：html, css

在我做的一个网站上，有人给我发了一张截图，显示我的字幕字体太大。

*   我用 FF、IE6、IE7、IE8、Safari/win、opera/win 在两台机器 (Vista) 上检查了该站点。
*   我可以增加浏览器的字体大小，但字幕保持不变（因为它是 8pt，如下所示），这是我想要的（所以它不会在徽标下延伸）。
*   [它在http://browsershots.org](http://browsershots.org)上的 34 个浏览器屏幕截图上检查得很好。

**什么可能导致这个人的机器上的字体更大**（Windows XP，IE7）。他说“所有其他网站看起来都很好”。Windows XP 是否有一些东西可以让操作系统改变浏览器中的字体大小等？或者可能是 Windows XP 上的 arial/italic 问题？

这是它的CSS：

```
#subtitle {
    position: absolute;
    top: 78px;
    left: 40px;
    width: 738px;
    text-align: right;
    font-size: 8pt;
    font-style: italic;
    font-family: arial;
} 
```

# 回答：

我将“8pt”更改为“10px”，现在对他有效。我假设他已经更改了他机器上的 DPI。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T06:11:34.550

您使用“pt”作为大小单位。不要那样做。CSS“物理单位”（pt、mm、in...）仅对物理输出（即打印样式表）有意义。

在屏幕上，使用系统的“dpi”设置将点映射到像素，该设置可以在机器之间任意变化。Macs/Windows/Linux 默认都不同，可以重新配置。许多 Windows 用户增加 dpi 设置以调整定点大小的系统对话框 (shell) 字体的大小。

如果您*必须*对某些文本使用非相对单位，则您需要的单位是“px”。

字体大小可能会改变还有其他原因（例如，不同的字体可用性、最小字体大小设置、故意字体缩放），这就是为什么你永远不应该完全依赖它们是你所期望的，但这几乎肯定是这种情况下的原因.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T06:10:32.167

这可能是一个愚蠢的问题，但用户是否无意中更改了浏览器的字体大小？在 IE6 及更高版本中，按住 CTRL 并向前/向后滚动鼠标滚轮将增加/减少字体大小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T06:09:54.697

三种可能：

1.  用户已更改其机器的 DPI 设置。在某些版本的 Windows 中，这表现为将字体更改为“大”或“非常大”；
2.  用户在浏览器中更改了默认字体（例如，从 Tahoma/12 更改为 Firefox 中的 Tahoma/16）；或者
3.  用户已在其浏览器中禁用 CSS/HTML 字体大小。这是一个可访问性设置。有些人还使用它，例如，在 15 英寸笔记本电脑上具有 1920x1200 分辨率，并且一些 Web weenie 已将其网站上的字体大小设置为 8 像素高。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T10:05:52.070

对不起，[bobince](https://stackoverflow.com/users/18936/bobince)和[Diogenes](https://stackoverflow.com/users/69528/diogenes)，但我必须以最强烈的方式不同意你关于不使用 pt 大小并始终使用像素的观点：

希望字体大小**相**对于浏览器或操作系统设置中指定的默认大小（应该是标准）的设计人员应该使用**%**或**em**。**想要绝对**大小（在屏幕上）的设计师应该使用**pt**来保持字体大小不变，而不管屏幕的 DPI 设置如何，原因如下：

现代笔记本电脑和移动设备的屏幕具有比台式机高得多的像素，与台式机的 72 相比，自然（默认）分辨率高达约 150dpi。医疗和其他专业屏幕甚至更高。并且用户有能力（如果不总是知道）根据他的喜好和视力来提高或降低逻辑 dpi 以自定义显示。

**任何以像素为单位的图像或文本都太小而无法在高密度 dpi 设备上阅读**，这会使视力良好的用户陷入困境，并使视力不佳的用户无法阅读文本。更重要的是（人们可以争论这是否是正确的行为），一些浏览器即使在用户命令时也不会调整像素大小的文本，这使得这种情况无法修复。

与纸质介质不同，纸质介质的定位精度可以达到 100 分之一英寸，并且每个阅读设计师作品的人看到的都是相同大小的纸，用于访问网络的设备的多样性使像素完美设计的整个概念无效，看起来仅适用于它所针对的一台设备。Web 设计的重点是让目标受众可以访问网站，目标受众通常应该尽可能大，并且会使用一系列设备和设置。

操作系统已经在使用矢量 UI 元素，或者至少是平滑缩放的大型源位图。您也应该忘记称为“像素”的任意度量单位，并使您的设计与最广泛的访问设备阵列兼容。

* * *

附录 -[第欧根尼提出的附加点](https://stackoverflow.com/questions/680382/why-would-browser-text-be-larger-on-a-particular-browser-machine/680470#680470)

不幸的是，在当前流行的操作系统中，具有 DPI 意识（因此对 pt 大小的文本有适当的支持）的实际情况是，由于缺乏更强大的可打印词，集群失败，正如[CSS-Discuss Wiki](http://css-discuss.incutio.com/?page=UsingPoints)所总结的那样：

> 不幸的是，大多数计算机不知道[显示器的 DPI]，所以浏览器也不知道……在缺乏这些知识的情况下，操作系统和浏览器通常只是做出假设，而这些假设通常是错误的。

因此，虽然理论上点是固定文本的最佳单位，但实际上在今天使用它们会在许多操作系统/浏览器/屏幕配置中产生不一致的结果。因此，设计师经常不得不放弃并恢复到像素来实现固定的字体大小。就个人而言，我使用百分比和 em，完全避免固定大小。

CSS-Discuss 存档[对字体大小问题进行了很好的总结](http://css-discuss.incutio.com/?page=FontSize)，并提供了许多指向详细信息和各种方法的链接。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T06:16:47.080

在 IE7 上有一个缩放级别和一个文本大小。最可能的情况是他们无意中更改了这些设置之一。让他们单击“页面”按钮并查看“缩放”和“文本大小”设置。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T06:48:10.720

正如其他 2 个答案所建议的那样，DPI 设置可能会给您带来麻烦。我发现，一旦您考虑 DPI 设置和不同的浏览器默认字体，将 pt、ex、em 与 px 大小混合可能是一个真正的挑战。

所以现在我只使用 px 作为字体大小。大多数问题都会消失。

PS 不要强迫那个单一的用户回到常规的 DPI。我敢打赌他们年纪大了，需要老花镜，而且他们得到的新的高分辨率显示器更难阅读，因为印刷品太小了。有人调整了 DPI，现在字体和旧显示器一样大，所以现在他们真的更喜欢新显示器了。现在的问题是一些网页搞砸了。那就是你进来的地方。

将显示器从 CRT 更改为纯平屏幕时，您可能需要注意的另一件事是数字字体平滑设置。模糊字符变得更清晰。幸运的是，这不会影响您的网页。

* * *

**附录-** [MaxVT](https://stackoverflow.com/users/19530/maxvt)提出的地址点

MaxVT 在他的回答中提出了一些很好的观点。上下文当然很重要。

我的回答有点懒惰和不完整。我使用 px 的原因是因为跨浏览器的不一致。以我的思维方式，指定点大小应该为用户在他使用的设备上指定字符的物理大小，但实际上并没有。

例如，假设你 font-family: cursive; 字体大小：11pt

在 Windows 下的大多数浏览器中，这默认为备受诟病的 MS-Comic 字体。IE7 决定使用其他一些默认值，在相同的磅值下，该字体似乎更小且可读性更低。Arial 与 Verdana 字体也是如此。指定相同的磅值，您的整个布局就会发生变化。在设置时输入 DPI 设置，这很混乱。

每英寸点数 (DPI) 设置有点不合时宜。您的显示器或手机具有固定的 DPI。如果您有新的显示器或电话，您只能更改它。有一个对话框来更改 DPI 只是因为设备不会向操作系统报告 DPI 是什么。这是一个不完美的世界。

所以我给你这个建议 - 现在使用 px 来指定字体大小，但只使用一次。使所有其他尺寸相对于您的基本字体。

然后，当您必须将所有内容移植到性能更好的最新黑莓或 iPod 上时，从 11px 切换到 11pt 会很容易。并测试您的软件，使其在您增大字体大小时看起来确实不错。

# nhibernate - 如何取回使用 Castle 的 ActiveRecord 查询多个实体的强类型集合？

> ID：680386
> 
> 赞同：0
> 
> 时间：2009-03-25T06:03:22.293
> 
> 标签：nhibernate, hql, castle-activerecord

我正在尝试获取一组特定的数据，同时将 4 个不同的实体连接在一起。我所做的是设置一个 DTO 来尝试让它工作：

```
public class LatestThread
{
    private readonly string comment;
    private readonly DateTime posted;
    private readonly string userName;
    private readonly int reputation;
    private readonly int threadId;
    private readonly string topic;
    private readonly int userId;
    private readonly string avatar;

    public LatestThread(string comment, DateTime posted, string userName, int reputation, int threadId, string topic, int userId, string avatar)
    {
        this.comment = comment;
        this.avatar = avatar;
        this.userId = userId;
        this.topic = topic;
        this.threadId = threadId;
        this.reputation = reputation;
        this.userName = userName;
        this.posted = posted;
    }

    public string Comment
    {
        get { return comment; }
    }

    public DateTime Posted
    {
        get { return posted; }
    }

    public string UserName
    {
        get { return userName; }
    }

    public int Reputation
    {
        get { return reputation; }
    }

    public int ThreadId
    {
        get { return threadId; }
    }

    public string Topic
    {
        get { return topic; }
    }

    public int UserId
    {
        get { return userId; }
    }

    public string Avatar
    {
        get { return avatar; }
    }
} 
```

现在我想我可以像这样使用 SimpleQuery：

```
string hql = string.Format("select new LatestThread(m.Comment, m.Posted, u.UserName, u.Reputation, t.Id, t.Topic, u.Id, u.Avatar) from Thread as t inner join Message as m on t.Id = m.ThreadId inner join User as u on u.Id = m.PostedById inner join Activity as a on a.Id = t.ActivityId where a.Lineage like '{0}%' order by t.LastPosted desc", activityLineage); 
```

返回 repository.SimpleQuery(0, 10, hql);

我的存储库方法如下所示：

```
 public virtual IList<T> SimpleQuery<T>(int firstResult, int maxResults, string hql, params object[] parameters)
    {
        var query = new SimpleQuery<T>(hql, parameters);
        query.SetQueryRange(firstResult, maxResults);
        return query.Execute();
    } 
```

现在它要求我将 [ActiveRecord] 放在我的 LatestThread 类的顶部。当我这样做时，它需要一个主键，这似乎是错误的路线。

我还阅读了一些引用赋予非 DTO 类的 Import 属性的位。在所有示例中，虽然它只是加入了两个实体，而不是我拥有的 4 个。我需要将 Import 添加到所有 4 个吗？或者有什么可以告诉 AR 它是一个只读的 DTO 类？或者我做这一切都错了，有一种非常简单的方法可以做我想做的事情。

蒂亚！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T09:11:35.227

将 Import 属性添加到新的 Thread 类

```
[Import(typeof(LatestThread), "LatestThread")]
[ActiveRecord("Thread")]
public class Thread : ActiveRecordBase<Thread> { /* blah blah */ } 
```

然后，查询魔术发生了:)

```
string hql = string.Format("select new LatestThread(m.Comment, m.Posted, u.UserName, u.Reputation, t.Id, t.Topic, u.Id, u.Avatar) from Thread as t inner join Message as m on t.Id = m.ThreadId inner join User as u on u.Id = m.PostedById inner join Activity as a on a.Id = t.ActivityId where a.Lineage like '{0}%' order by t.LastPosted desc", activityLineage);

SimpleQuery<LatestThread> query = new  SimpleQuery<LatestThread>(typeof(Thread), hql );  
LatestThread[] results = query.Execute() 
```

来源：[http ://www.kenegozi.com/Blog/2006/10/08/projection-using-activerecords-importattribute-and-hqls-select-new-clause.aspx](http://www.kenegozi.com/Blog/2006/10/08/projection-using-activerecords-importattribute-and-hqls-select-new-clause.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T08:54:43.677

您无法查询未映射的类型（这是`[ActiveRecord]`属性所做的）。AFAIK 你不能让 NHibernate 通过 HQL 创建一个新的任意对象实例（如果有人知道，我会得到纠正）。

你最好的办法是做一个投影查询，然后有一个方法将返回的元组映射到你的类型的实例中。

[我在这里](https://stackoverflow.com/questions/308203/custom-query-with-castle-activerecord/318100#318100)的回答显示了如何进行投影查询并将其映射到匿名类型；你想做的并没有太大的不同。然后，您可以将执行此操作的方法放在特定类型的存储库中，或者将强类型扩展方法放在通用存储库中。

# extjs - this[a] 在 ext js 中没有属性

> ID：680387
> 
> 赞同：0
> 
> 时间：2009-03-25T06:03:48.673
> 
> 标签：extjs

我是 extjs 的新手。我必须在一页中显示一个表格和一个网格。网格显示正确。并且表单域没有显示。在脚本错误中，它在 ext-all.js 中显示错误。在 firefox 脚本错误中显示“this[a] has no properties”时可能会出现什么问题？请帮我完成这个任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T21:10:12.660

这通常发生在您引用尚未渲染的对象/小部件时（但您认为它是）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-27T22:29:14.693

使用 ext-all-debug.js 版本的 Ext 以获得更好的错误消息。Ext JS 库附带两个包含该库的文件（ext-all.js 和 ext-all-debug.js）

ext-all.js 已经通过 YUI Compressor 工具运行，并删除了所有空格、换行符和注释。YUI 压缩器还将变量名称重命名为短版本，如“a”。

如果您使用 ext-all-debug.js，您将收到更好的错误消息。

# php - SoapFault 异常：[VersionMismatch] PHP Zend

> ID：680393
> 
> 赞同：0
> 
> 时间：2009-03-25T06:08:28.257
> 
> 标签：php, zend-framework, soap, zend-soap

我在使用 Zend Soap 实现和测试 PHP Web 服务时遇到了这个错误。

我在 2 个不同的 Web 服务器中在 2 个不同的协议（http 和 https）下测试相同的代码。http 站点工作得很好，但我在 https 中收到“SoapFault 异常：[VersionMismatch] ...”错误。

两个 Web 服务器几乎具有相同的规格。

有没有人可以帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T06:38:10.713

我找到了答案。错误消息实际上并不代表真正的问题，因为肥皂错误类型仅限于 5 种类型。

1.  版本不匹配

2.  必须了解

3.  数据编码未知

4.  发件人

5.  接收者

    有一个调试代码抛出文本消息，它只是捡起这个错误类型..傻

# c# - 数据访问层

> ID：680394
> 
> 赞同：3
> 
> 时间：2009-03-25T06:08:45.727
> 
> 标签：c#, asp.net

我们如何创建一个通用数据访问层，任何使用不同数据源提供程序或 Web 服务的 asp.net 应用程序都可以使用它？

我们可以为使用 web 服务的应用程序创建数据访问层吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T06:18:54.987

您可能会查看存储库模式。Repository 是一个外观，它呈现持久对象，就好像它们在内存中的集合中一样。您选择获取数据的任何提供者都隐藏在存储库界面后面。

[带有 LINQ to SQL 的 IRepository](http://mikehadlow.blogspot.com/2008/03/using-irepository-pattern-with-linq-to.html)

[代码项目教程](http://www.codeproject.com/KB/architecture/linqrepository.aspx)

[Fredrik Kalseth 的样本](http://iridescence.no/post/DataContext-Repository-Pattern-Example-Code.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T06:20:09.397

你有很多选择！:-)

您提到您想使用来自 asp.net 和 Web 服务的数据访问层 (DAL)。没问题。

基本上，您需要弄清楚的是您想要遵循的基本设计，并将 DAL 封装到自己的程序集中，可以被各种消费者使用/引用。

有很多方法可以做到这一点：

*   如果您使用 SQL Server 作为后端，则为您的表创建一个 Linq-to-SQL 映射，并使用 Linq-to-SQL 实体和方法
*   创建一个存储库模式（对于每个“实体”，您都有一个“EntityRepository”类，可用于检索实体，例如 EntityReposity.GetByID(int id) 或 EntityRepository.GetByForeignKey(string fk) 或其他
*   使用其他方式访问数据（NHibernate，您自己的基于 ADO.NET 的映射器）
*   您实际上也可以使用网络服务调用作为您的数据提供者

你最大的挑战是定义一种标准的做事方式，并坚持下去。

看一些文章——也许他们会给你一个想法：

*   [在 .NET 中创建数据访问层 - 第 1 部分](http://www.15seconds.com/issue/030317.htm)
*   [在 VS 2005 和 ASP.NET 2.0 中使用强类型表适配器和数据表构建 DAL](http://weblogs.asp.net/scottgu/archive/2006/01/15/435498.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T06:12:18.857

试试 www.asp.net 上的教程：

[数据访问](http://www.asp.net/learn/data-videos/video-392.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-10T14:30:50.453

看看使用接口：

IDbConnection IDbCommand IDbDataAdapter IdataReader

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T06:39:30.227

哇，那里有很多资源。开始的最佳建议是找到一个你觉得舒服的模式并在项目中坚持下去，没有什么比 3/4 改变主意更糟糕的了。

我发现并喜欢使用的一种是 Repository 或 Provider 模式。存储库模式只是确保您对存储库具有标准访问权限，例如您的商店目录或 CMS 系统。您创建了一个接口，在我的情况下，它公开 IQueryable 对象集或数据模型只是标准 c# 类，现在有额外的绒毛 POCO（普通旧 CLR 对象）。

```
public interface ICMSRepository {
    IQueryable<ContentSection> GetContentSections();
    void SaveContentSection(ContentSection obj);
} 
```

然后只需为您的不同提供者实现接口，例如 LINQ to SQL 上下文，确保将 POCO 对象作为可查询对象返回。这样做的好处是您可以从 IQueryable 中创建扩展方法来轻松获得所需的内容。喜欢：

```
public static IQueryable<ContentSection> WithID(this IQueryable<ContentSection> qry, int ID) {
    return from c in qry select c;
}

//Allow you to chain repository and filter to delay SQL execution
ICMSRepository _rep = new SqlCMSRepository();
var sec = _rep.GetContentSections().WithID(1).SingleDefault(); 
```

使用接口方法的好处是能够在运行时测试和模拟它或依赖注入您喜欢的存储。

我在 ASP.Net 框架中使用过的另一种方法是 Provider 模型。这是相似的，除了你创建一个单例抽象类而不是一个接口，你在抽象类之上的实现将定义存储访问方式（XML、平面文件、SQL、MySql 等）。基本抽象类也将负责根据配置创建它的单例。查看此内容以获取有关提供程序模型的[更多信息。](http://www.4guysfromrolla.com/articles/101905-1.aspx)

否则你可以看看[这个类似的问题](https://stackoverflow.com/questions/3175/repository-pattern-tutorial-in-c)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T09:43:09.300

T 的 IRepository 是一般的好方法。此接口应公开 GetAll、GetByID、Insert、Delete 和 Submit 方法。
但重要的是让您的业务逻辑远离 Repository 类，并将其放入自定义逻辑/服务类。
此外，如果您在 GetAll 方法中返回 IQueriable，您可以在 IRepository 的各种实现中经常看到，UI 层也可以针对该 IQueriable 接口进行查询。但是对象图的查询应该保留在存储库层。围绕这个问题有很多争论。

# c++ - 如何使用 QT 4.5 和 Linux 发送和接收广播消息？

> ID：680397
> 
> 赞同：0
> 
> 时间：2009-03-25T06:10:41.963
> 
> 标签：c++, qt4

我是 QT 编程的新手。谁能解释我如何在给定网络适配器及其 IP 地址的情况下发送广播消息？我也不知道如何使用 QT 接收数据报。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T08:16:43.720

您可以想象一下与 QT 捆绑在一起的非常简单的 BroadcastSender 和 BroadcastReceiver 示例。您将在`examples/network`QT 源代码树的目录中找到它们，更具体地说，在此 URL`examples/network/broadcastreceiver`中`examples/network/broadcastsender`或直接在线：[examples/network](http://labs.trolltech.com/gitweb?p=qt/snapshot/4.5;a=tree;f=examples/network;h=585775d6860bfeca55ef428bc029001771926882;hb=HEAD)

# c# - Access 数据库引擎的优缺点。SQLite 之后的生活

> ID：680399
> 
> 赞同：6
> 
> 时间：2009-03-25T06:12:02.507
> 
> 标签：c#, vb6, ms-jet-ace

前段时间我问了一个[问题](https://stackoverflow.com/questions/482431/which-local-database-fits-my-situation)，关于哪个本地数据库适合我的情况。我需要从 .NET 代码和 VB6 访问数据库。压倒性的反应是 SQLite。但是，我决定放弃 SQLite，因为它的唯一 OLE DB 提供程序会为我的软件的每个部署副本收取版税。它还需要在每台 PC 上运行激活程序。

在评估其他选项（SQL Server Compact 版本 - 几乎没有功能的 OLE DB 提供程序，Firebird - 不想为另一个驱动程序付费等......）之后，我得出结论，唯一可行的选择是使用 .由 Microsoft Access（或 Jet 引擎）创建的 MDB 文件。

自 90 年代后期以来我就没有使用过它，所以我有以下问题想问那些有经验的人。

1.  他们是否解决了数据库不时损坏的问题。
2.  是通过 ADO.NET OLEDB Provider 从 c# 访问 MDB 还是有本机解决方案（我似乎找不到它）。
3.  Access 中真正糟糕的 SQL 编辑器是否有可行的替代方案？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T06:24:49.620

而不是“返回”到 Access，我会坚持使用 SQLite 并使用 System.Data.SQLite 提供程序在 .NET 代码中访问 SQLite 数据。

然后，我将创建一个简单的 COM 互操作 .NET 类以供 VB6 使用，该类包含任何所需的 SQLite 数据访问功能。最后，只需像 VB6 项目中的标准 COM 对象一样引用和使用它。

我对 Access 的了解可能有点过时并且受到不良经历的影响，但在合理的情况下，我会在诉诸 Access 路线之前尝试大多数其他选择。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T06:19:18.853

您是否考虑过[SQL Server 2008 Express Edition](http://www.microsoft.com/express/sql/)（与 SQL Server CE 相反）？

1) 就我个人而言，我发现大多数情况下，Access DB 损坏是由于代码没有自行清理，或者涉及到有故障的网卡。

2)

```
string connectionString = @“Provider = Microsoft.Jet.OLEDB.4.0; " + 
                          @"Data Source = C:\data\northwind.mdb; " +
                          @"User Id = guest; Password = abc123”

using (OleDbConnection oleDbConnection = New OleDbConnection())
{
    oleDbConnection.ConnectionString = connectionString;

    oleDbConnection.Open();

    ...
} 
```

3) SQL Server 2008 速成版

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T17:40:48.543

MDB 损坏主要是由于数据库打开时客户端计算机、文件服务器和网络中发生的故障。如果您将 MDB 放在文件共享上，这始终存在风险，如果在本地硬盘驱动器上并由一个用户使用，则问题要少得多。

我不希望 SQLite 有任何不同，甚至更糟。

定期运行 JetComp.exe（Microsoft 下载）将修复许多问题并压缩索引表等。无论您使用什么，备份都很重要。

您根本不需要 MS Access 即可使用 Jet MDB。有一些第三方工具用于设计数据库模式和进行交互式查询，包括命令行和 GUI。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T09:00:15.770

由于 MDB 格式或多或少已被弃用，因此您 90 年代后期的知识是最新的。[请参阅此 MSDN 页面](http://msdn.microsoft.com/en-us/library/ms810810.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T06:56:47.517

您还可以尝试[SQL Anywhere](http://www.sybase.com/detail?id=1016644)，它可以在各种操作系统上运行并且占用空间小。为我工作:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-26T04:29:06.350

AngryHacker 问道：

Q1。他们是否解决了数据库不时损坏的问题。

呃，什么？

在正确维护的环境中正确部署的正确设计的应用程序中从来没有任何损坏问题。我已经 3 或 4 年没有看到 MDB 损坏了，而且我有几十个应用程序在许多不同类型的操作环境中被许多客户全职使用。

我认为大多数遭受腐败的人都是那些试图在许多用户之间共享 MDB 文件的人（无论是拆分还是未拆分）。由于您没有考虑使用 Access，因此这不是真正的问题。

Q2。是通过 ADO.NET OLEDB Provider 从 c# 访问 MDB 还是有本机解决方案（我似乎找不到它）。

本机解决方案是 DAO，但那是 COM，所以您可能不想使用它。从 C# 开始，我会说 OLEDB 是你最好的选择，但这不是我的专业领域，所以对它持保留态度。我相信 Michael Kaplan 报告说 Jet ADO/OLEDB 提供程序是线程安全的，而 DAO 不是。不过，这并不意味着他推荐 ADO/OLEDB 而不是 DAO，但他的评论也来自 Access 上下文，而不是 C#。

Q3。Access 中真正糟糕的 SQL 编辑器是否有可行的替代方案？

当您实际上不使用 Access 时，为什么要使用它？您可以使用任何您喜欢的 SQL 编辑器，只要您测试您编写的 SQL 是否与 Jet 的 SQL 方言兼容。

一方面，我不知道 Access 的 SQL 编辑器有什么问题（除了无法设置字体大小），但是，我使用 QBE 编写了很多 SQL，甚至都没有看SQL 视图。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-24T14:25:32.113

要回答您关于 Access 中非常糟糕的 SQL 编辑器的问题 - 我完全同意。字体很臭，MSAccess 总是严重地重新格式化查询，它有时会添加破坏我的 SQL 的元字符，最后但最糟糕的是，如果它无法解析 SQL，它不会让你访问它！

我的解决方案是使用外部代码。我使用 DAO 来实例化 MSAccess，然后可以使用 QueryDefs 集合直接编辑查询。它可以让你做大多数事情——创建、重命名、编辑等。但是有一些事情你不能这样做——例如，你无权访问查询元数据（描述、隐藏等）。

外部代码也很棒，因为您可以构建一套测试用例，指定预期的返回值等。

# c# - 在 ASP.NET MVC 中，如何检索正在运行的脚本的文件名？

> ID：680402
> 
> 赞同：0
> 
> 时间：2009-03-25T06:13:38.290
> 
> 标签：c#, asp.net-mvc, request

我需要获取母版页上正在执行的脚本的名称以更新上次写入时间。

我正在使用这个：

`System.IO.File.GetLastWriteTime(Server.MapPath(Request.FilePath))`

它适用于 default.aspx，但如果它在视图中，我无法确定文件的物理路径是什么来获取 LastWriteTime。

有针对这个的解决方法吗？当然，我在这里错过了一些非常容易的事情。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T13:56:26.150

根据我对 System.Web.Routing 的了解，路由发生在 IIS 中，因此无法获得视图的真实物理路径。您可以随时尝试使用

```
this.Request.PhysicalPath 
```

获取物理路径，但它会返回如下内容：

```
C:\Projects\MySolution\MyProject\ViewFolder\ViewAction 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-29T20:20:17.087

基于[这个答案](https://stackoverflow.com/questions/937779/correct-way-to-reference-javascript-in-asp-net-mvc/938685#938685)和[这个](https://stackoverflow.com/questions/351937/in-asp-net-mvc-how-can-use-i-url-content-from-code)答案，我写了一个像这样的html助手：

```
 public static string ScriptBlock(this HtmlHelper html, string path)
    {
        return string.Format("<script src=\"{0}{1}\" type=\"text/javascript\"></script>\r\n", VirtualPathUtility.ToAbsolute(path), DateLastWriteFile(html.ViewContext.HttpContext.Server.MapPath(path)));
    }

    public static string CSSBlock(this HtmlHelper html, string path)
    {
        return string.Format("<link href=\"{0}{1}\" type=\"text/css\" rel=\"Stylesheet\" ></link>\r\n", VirtualPathUtility.ToAbsolute(path), DateLastWriteFile(html.ViewContext.HttpContext.Server.MapPath(path)));
    }

    public static string DateLastWriteFile(string path)
    {
        return "?Date=" + File.GetLastWriteTime(path).ToString("yyyyMMddhhmmss");
    } 
```

然后，我只是在我的母版或视图页面中调用该方法，显然在视图/母版页的顶部包含正确的命名空间之后：

```
 <%= Html.CSSBlock("~/Content/Site.css") %> 
```

# lisp - SBCL 和 LangUtils

> ID：680404
> 
> 赞同：2
> 
> 时间：2009-03-25T06:13:47.260
> 
> 标签：lisp, common-lisp, asdf

有没有人让 langutils 与 sbcl 一起工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T15:40:29.660

当然，我的电子邮件是 eslick @ the mit media lab。我有一个部署的 Web 应用程序，使用 langutils 将文本插入 Montezuma，以便在 SBCL 上运行全文索引。我一直打算在打包和发布 langutils 方面再试一次；也许在一两个月内。喜欢收到您的反馈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-26T08:09:36.757

为什么不问问 Ian Eslick 本人呢？他可能会对您在使用 langutils 和 SBCL 时遇到的任何问题非常感兴趣。

# c - C 程序中的错误

> ID：680430
> 
> 赞同：-2
> 
> 时间：2009-03-25T06:25:07.653
> 
> 标签：c, gcc, mingw

`while(((long)(1000*ratio*((long)clock()-(long)t0))%100)/1000)<Data_Read_Rate);`

上面的行正在生成以下错误：“< token 之前的语法错误”。

为什么会出现这个错误？

我使用 MINGW32 进行开发（GCC 编译器）。

谢谢...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T06:33:00.163

左侧缺少一个括号。这将解析：

```
while ((((long)(1000*ratio*((long)clock()-(long)t0))%100)/1000)<Data_Read_Rate); 
```

除了解析问题：

*   使用高亮匹配括号的编辑器:)
*   为什么不计算直到数据读取率充分下降的剩余时间，然后调用 sleep()？这在处理器上更好。

此外，考虑到您使用 % 运算符，您可能希望像这样放置额外的括号（我假设*ratio*不是整数），因为 % 运算符需要整数操作数：

```
while (((long)(1000*ratio*(((long)clock()-(long)t0))%100)/1000)<Data_Read_Rate); 
```

（但这在语义层面上有意义吗？砍掉它！）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T06:33:48.600

你有太多的右括号。

另外，你的逻辑太长太深了，我懒得去弄清楚代码应该是什么。只是以红色`vim`突出显示最后一个，这意味着它不匹配。`)`我建议您考虑使用一些中间变量，并通过将其分散到几行而不是一行来简化该语句的逻辑。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T06:33:34.250

括号不匹配。顺便说一句，我实际上会编辑代码并将其分解为多个语句以使其更具可读性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T06:45:10.087

因为编译器和人类读者一样对你的代码感到困惑？[不寒而栗]

空格和换行符是免费的，并且很好地增加了可读性。

```
 while ( ( (long)( 1000 * ratio * ( (long)clock() - (long)t0 ) ) % 100 ) / 1000 ) < Data_Read_Rate ); 
```

您也可以取消 clock() 和 t0 的（长）转换（假设它们都是 int ）。在减法之前铸造它们不会改变结果。要使整个计算变长，将*其中一个*参数变长就足够了——而做到这一点的最短方法是转换文字 1000：

```
while ( ( ( 1000l * ratio * ( clock() - t0 ) ) % 100 ) / 1000 ) < Data_Read_Rate ); 
```

嗯……等等。你取一些东西，模 100（产生 0 到 99 之间的数字），然后除以 1000？你的结果总是0...

哦，你忘了匹配你的括号。;-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T06:45:20.227

如前所述，您的括号不匹配。

对于这样的表达式，使用一些临时变量来简化语句几乎总是更好。但是，以下提示可能会有所帮助。

1.  计算括号，每个“（”加 1，每个“）”减 1，你应该总是得到 0 的答案。一个肯定的答案意味着你有一个额外的“（”一个否定的答案，你有一个额外的“）” .
2.  重新格式化表达式以使其更易于阅读，可能会将其分成几行，每个逻辑语句都在一行。
3.  使用语法高亮代码编辑器。这应该为您显示不匹配

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T06:34:33.077

您在左侧缺少一个括号。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T06:42:52.587

你有太多的左括号和右括号。如果您使用的是 Visual Studio，它将帮助您使用 Ctrl+'[' 和 Ctrl+']' 按键匹配打开和关闭括号/大括号

另一个建议是通过保持表达式的可读性将其分组并分成多行。还尝试在后续括号之间留出空格，以便对表达式进行逻辑分组。

# javascript - 更改 textNode 值

> ID：680431
> 
> 赞同：101
> 
> 时间：2009-03-25T06:25:13.770
> 
> 标签：javascript, dom, dhtml

有什么方法可以更改 Web 浏览器中 DOM textNode 的值？

我特别想看看我是否可以**更改**现有节点，而不是**创建**一个新节点。

为了澄清，我需要用 Javascript 来做这件事。浏览器中的所有文本都存储在 #textNodes 中，它们是其他 HTML 节点的子节点，但不能有自己的子节点。

如下所述，可以通过设置这些对象的**nodeValue**属性来更改内容。

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2009-03-25T06:37:55.080

如果您有一个特定节点（#text 类型）并且想要更改其值，您可以使用[nodeValue](https://developer.mozilla.org/En/DOM/Node.nodeValue)属性：

```
node.nodeValue="new value"; 
```

笔记：

内部文本（和~~可能~~textContent) 将返回/设置当前节点和所有后代节点文本，因此可能不是您想要/期望的行为。

* * *

## 回答 #2

> 赞同：-13
> 
> 时间：2009-03-25T06:32:12.583

我相信 innerHTML 被用于此......再说一次，这不是 W3C 批准的......但它有效......

```
node.innerHTML="new value"; 
```

# graphics - 构建轻量级、跨平台、文本编辑器的方法

> ID：680445
> 
> 赞同：3
> 
> 时间：2009-03-25T06:37:06.610
> 
> 标签：graphics, air, gtk, shoes, xulrunner

我计划构建一个简单、轻量级的文本编辑器，它结合了漂亮的外观和以键盘为中心的输入。

我想对诸如抗锯齿和所有图形之类的东西进行大量控制，但我不关心拥有整个小部件库。几乎整个 UI 都是基于文本的，并且位于应用程序的主画布/窗口中。

*   像 GTK 和 Qt 这样的工具包似乎有点矫枉过正——我不需要大量的小部件和复杂的代码库。
*   Titanium、AIR 和 XULRunner 在某些方面甚至更大——开发会很快，但这并不是轻量级的方法。
*   鞋子看起来几乎是完美的合身，但它有点太小并且不支持足够的事件（例如，没有调整窗口大小）。

你认为，我应该在 Cairo/Pango 或其他图形库上构建它并自己滚动平台特定的东西吗？我宁愿使用某种框架。

基本上我想要的是：

*   良好的事件处理
*   开窗
*   菜单
*   使用非常棒的类型渲染选择进行绘图

我很想从一开始就构建这个跨平台。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T18:17:29.470

即使您只使用 Cairo/Pango，您仍然需要在屏幕上显示窗口。

最简单的组合是 cairo + pango + GDK（GTK+ 的窗口部分），但是即使在这种情况下你也没有菜单，用纯 Cairo 构建菜单将是一项艰难（但并非不可能）的成就。

如果您坚持轻量级和跨平台，请检查以下内容

*   [快速光工具包](http://www.fltk.org/)
*   [福克斯工具包](http://en.wikipedia.org/wiki/FOX_toolkit)
*   [wxWidgets](http://www.wxwidgets.org/)（非常适合 Python）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-16T16:24:58.197

[Scintilla](http://www.scintilla.org/)是一个跨平台的源代码编辑组件（基于 GTK+），对语法高亮、代码折叠、文本缩放，当然还有所有常用的文本编辑功能都有很好的支持；它应该是文本编辑器的良好基础。

# regex - 将多个正则表达式连接成一个正则表达式

> ID：680446
> 
> 赞同：4
> 
> 时间：2009-03-25T06:37:16.987
> 
> 标签：regex

对于文本文件，我想匹配以“BEAM”和“FILE PATH”开头的字符串。我会用

```
^BEAM.*$
^FILE PATH.*$ 
```

如果我要分别匹配它们。但是现在我必须将这两个匹配模式连接成一个模式。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-25T06:39:32.627

竖线/条形字符通常用正则表达式表示“或”。你可以试试：

```
^(BEAM|FILE PATH).*$ 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T08:18:19.160

接受的答案是正确的，但您的正则表达式中可能存在冗余。

*   `^`表示匹配一行的开头
*   `(BEAM|FILE PATH)`- 表示字符串“BEAM”或字符串“FILE PATH”
*   `.*`意味着*任何东西*
*   `$`表示匹配行尾

所以实际上，你所说的只是在行首匹配我的字符串，因为你不在乎最后是什么。你可以这样做：

```
^(BEAM|FILE PATH) 
```

有两种情况下这种减少是无效的：

1.  如果你对匹配的字符串做一些事情，那么你想匹配整行以将数据传递给其他东西。

2.  您正在使用一个正则表达式函数，该函数想要匹配整个字符串而不是其中的一部分。您有时可以通过选择不同的正则表达式函数或方法来解决此问题。例如在 Python 中使用`search`而不是`match`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T06:43:03.913

如果上面的帖子不起作用，请尝试转义 () 和 | 以不同的方式，直到找到一种有效的方式。一些正则表达式引擎以不同的方式处理这些字符（特殊字符与非特殊字符），尤其是当您在 shell 中运行匹配时（shell 也会查找特殊字符）：

*   `^\(BEAM|FILE PATH\).*$`
*   `%\(BEAM\|FILE PATH\).*$`
*   等等

# asp.net-mvc - 如何将代码隐藏页面添加到视图或部分视图

> ID：680448
> 
> 赞同：16
> 
> 时间：2009-03-25T06:37:55.127
> 
> 标签：asp.net-mvc, views, code-behind

我注意到最新版本的 ASP.NET MVC 视图不再默认具有代码隐藏类。

现在如何将代码隐藏类添加到视图或部分视图？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-25T07:05:19.320

**如何将代码隐藏页面添加到部分视图**

似乎这并不是特别棘手，并且非常可行。此答案适用于 Partial但同样`ViewUserControl`适用于 Normal MVC`ViewPage`

1.  添加一个具有`<view filename & extention>.cs` (ie `view.ascx.cs`)约定的新 Class 文件

2.  添加`using System.Web.Mvc;`到班级

3.  将类更改为从 继承`ViewUserControl<>`。
    IE`public class Foo:ViewUserControl`

4.  将以下内容添加到视图的标题中：

    `CodeBehind="View.ascx.cs" Inherits="Project.Views.Shared.View"`

5.  将文件从解决方案中复制出来并拖回以将两者重新关联在一起。这在 VS 2010+ 和 MVC 2+ 中可能不是必需的。

为此，要使用普通的 MVC 视图，您只需要从“ViewPage”继承类

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T09:38:23.337

我不确定您为什么要创建文件隐藏代码，但如果您真的这样做，那么我会考虑使用标准的网络表单方法。

我还将研究 MVC 的基础知识，以了解为什么不需要页面后面。

[另一种解释](http://www.squaredroot.com/post/2008/01/MVC-Strongly-Type-ViewPages-Without-A-Code-Behind.aspx)

[如何在没有代码隐藏的情况下使用 ASP:Chart（选项 B）](http://code-inside.de/blog-in/2008/11/27/howto-use-the-new-aspnet-chart-controls-with-aspnet-mvc/#scid:812469c5-0cb0-4c63-8c15-c81123a09de7:978c0f32-5e2a-4d51-9241-4d3827904d13)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-08T15:12:12.240

好的，我已经验证了解决方案，您需要注意以下几点：

CodeBehind="View.ascx.cs" Inherits="Project.Views.Shared.View"

在您的情况下，您需要根据您的命名空间和类名更改“Project.Views.Shared.View”，并且为了访问代码隐藏中的控件，您必须在代码隐藏中手动添加声明。就我而言，我需要初始化 gigaSoft proEssential 控件：

```
public class gigaTest2 : ViewUserControl
{
    protected global::Gigasoft.ProEssentials.PegoWeb PegoWeb1;
    protected void Page_Load(object sender, EventArgs e)
    {
        // Set Titles 
        PegoWeb1.PeString.MainTitle = "Hello ASP.NET";
        PegoWeb1.PeString.SubTitle = "";

        // One simple way of passing data, data binding also possible. //' 
        PegoWeb1.PeData.Subsets = 1;
        PegoWeb1.PeData.Points = 6;
        PegoWeb1.PeData.Y[0, 0] = 10;
        PegoWeb1.PeData.Y[0, 1] = 30;
        PegoWeb1.PeData.Y[0, 2] = 20;
        PegoWeb1.PeData.Y[0, 3] = 40;
        PegoWeb1.PeData.Y[0, 4] = 30;
        PegoWeb1.PeData.Y[0, 5] = 50;

        // Set style of chart and a few other properties //' 
        PegoWeb1.PePlot.Method = Gigasoft.ProEssentials.Enums.GraphPlottingMethod.Bar;
        PegoWeb1.PePlot.Option.GradientBars = 8;
        PegoWeb1.PeFont.FontSize = Gigasoft.ProEssentials.Enums.FontSize.Large;
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-27T22:29:07.857

要将代码隐藏文件添加到您的 aspx 页面，同时仍允许它成为 MVC 视图的目标，请执行以下操作。

对于名为`Index.aspx`...

替换下面的代码......

```
<%@ Page Inherits="System.Web.Mvc.ViewPage" %> 
```

和

```
<%@ Page CodeFile="Index.aspx.vb" Inherits="Home_Index" %> 
```

然后创建一个名为`Index.aspx.cs`（或`.vb`）的文件。

```
partial class Home_Index : System.Web.Mvc.ViewPage
{...} 
```

或 VB

```
Partial Class Home_Index
    Inherits System.Web.Mvc.ViewPage
    ...
End Class 
```

就是这样。唯一特别的是使用正确的`Mvc.ViewPage`基类。

# project-management - SAS中的功能点分析

> ID：680450
> 
> 赞同：0
> 
> 时间：2009-03-25T06:39:00.617
> 
> 标签：project-management, sas, function-points

有些人可以帮助我提供一些有关如何为 SAS 相关项目完成 FPA 的链接。如果 yuo 的某个人已经做过，我想如果 yuo 可以分享一些关于如何完成的技巧，那将更加有用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T00:52:36.417

我觉得这个问题有点太宽泛了。FPA 是一个很大的主题领域，并且有一些关于如何进行的一般指导方针。（请参阅此处的一篇好文章：[clicky](http://www.qpmg.com/fp-intro.htm)）我不知道任何包含 SAS 的具体示例。然而，这种类型的分析更适用于流程和软件功能，因此与语言无关。

如果我们讨论特定的 SAS 程序、宏或操作，也许我们可以更详细地讨论这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-08T21:43:56.950

这是一篇关于功能点分析的介绍性文章： [功能点估计](http://geekswithblogs.net/Prabhats/archive/2007/03/01/107632.aspx)

我使用 developergeeks.com 的以下在线功能点计算器工具。使用非常友好： [在线功能点计算器](http://developergeeks.com/functionpoint.aspx)

# c# - 对于 ASP.NET MVC Rescues View，我们如何添加 ViewData 字段？

> ID：680451
> 
> 赞同：0
> 
> 时间：2009-03-25T06:39:07.620
> 
> 标签：c#, asp.net-mvc, rescue

我为可能的故障定义了几个 Rescue，但是我无法访问 ViewData 来填充我们需要 masterpage 需要呈现的东西。这是否隐藏在我们可以使用的控制器中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T06:45:28.977

听起来您需要在母版页中提供 ViewData ......我认为这将是一个问题，因为并非所有控制器都放置/确保数据在那里。我很确定您必须拥有某种类型的自定义控制器库，以确保所有控制器中的数据一致。试着调查[一下](http://geekswithblogs.net/scarpenter/archive/2007/12/14/117724.aspx)。

我可能是错的，但我之前已经看到这个问题被提出过几次。

# vim - Vim 在滚动时保持光标位置

> ID：680456
> 
> 赞同：50
> 
> 时间：2009-03-25T06:41:17.880
> 
> 标签：vim

滚动时有没有办法在 Vim / gVim 中保持光标位置不在屏幕上？类似于许多 Windows 编辑器。
我知道标记，并且确实使用它们。我也知道'。标记（最后编辑位置），但正在寻找其他想法。我问这个是因为有时我想将光标保持在某个位置，使用鼠标滚轮滚动到另一个位置，然后只需按箭头键或其他东西就可以让我回到那个位置。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-25T07:40:39.063

不，vim 是一个控制台应用程序，因此将光标移出屏幕并没有任何意义（这是可能的，但只会令人困惑）

另一种解决方案，[从 comp.editors 解释此线程中的帖子](http://groups.google.com/group/comp.editors/browse_thread/thread/2ed904497fe930fa)：

`Ctrl+o`转到上一个光标位置，`Ctrl+i`转到下一个（如撤消/重做动作）

标记似乎是另一种解决方案..

> 另外，使用标记。标记以字母命名。例如，键入 ma 会记住标记 a 下的当前位置。要跳转到包含标记 a 的行，请键入 'a。到确切的位置使用`a。
> 
> 小写字母标记是每个文件的。大写字母标记是全局的；`A 将切换到包含标记 A 的文件，到确切的位置。

基本上`ma`，四处走动，然后`a 跳回来。

保罗建议的另一个选择，

> `gi`命令将 Vim 切换到插入模式，并将光标放在上次插入模式停止的位置。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-25T06:48:17.020

为什么不拆分窗口，看你想看的，然后关闭拆分呢？

```
:split 
```

或者

```
:vsplit (if you want to split vertically) 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-01-08T19:03:24.707

我在 Vim 中发现的唯一类似行为：

`z``t`或`z``ENTER`“在不移动光标的情况下尽可能向下滚动屏幕”

`z``b`“尽可能向上滚动”。

`Ctrl`+ `E`"如果可能，向下滚动一行"

`Ctrl`+ `Y`"如果可能，向上滚动一行"

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-25T10:20:42.517

有时你可以避免在输入文本之前跳转到标记——`gi`命令将 Vim 切换到插入模式并将光标放在上次插入模式停止的位置。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-28T09:30:37.700

''（2x 单引号）和 ``（2x 反引号）也非常有用。前者跳回到您上次跳转之前所在的行（例如，向下一页）。后者跳回到上次跳转之前所在的行*和列。*

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-25T06:45:27.590

谷歌说光标（以及当前行）必须在 Vi 中可见，所以你必须使用标记。

# .net - 大 DLL 的问题？

> ID：680457
> 
> 赞同：1
> 
> 时间：2009-03-25T06:41:22.607
> 
> 标签：.net

使用和部署大型 DLL 是否存在任何问题？我正在使用几个 30Mb 和 17Mb 大小的 DLL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T06:44:58.013

除了加载时间和下载时间，没有。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T06:53:01.580

正如米奇所说，不。

事实上，微软实际上建议创建数量较少的大型程序集而不是许多小型程序集。 [这个较早的问题](https://stackoverflow.com/questions/337144/does-net-assembly-size-affect-performance)提供了非常有用的信息和参考。

在您的情况下，您绝对应该测试加载时间并将大小保持在可接受的范围内，但似乎与创建大量小程序集相关的问题比创建几个大程序集要多。

# asp.net - Quartz.NET 触发器未触发

> ID：680474
> 
> 赞同：3
> 
> 时间：2009-03-25T06:49:16.113
> 
> 标签：asp.net, automation, scheduling, quartz.net

我在我的 ASP.NET Web 应用程序中使用 Quartz.NET。我将以下代码放在按钮单击处理程序中以确保它执行（用于测试目的）：

```
Quartz.ISchedulerFactory factory = new Quartz.Impl.StdSchedulerFactory();
Quartz.IScheduler scheduler = factory.GetScheduler();
Quartz.JobDetail job = new Quartz.JobDetail("job", null, typeof(BackupJob));
Quartz.Trigger trigger = Quartz.TriggerUtils.MakeDailyTrigger(8, 30); // i edit this each time before compilation (for testing purposes)
trigger.StartTimeUtc = Quartz.TriggerUtils.GetEvenSecondDate(DateTime.UtcNow);
trigger.Name = "trigger";
scheduler.ScheduleJob(job, trigger);
scheduler.Start(); 
```

这是“备份作业”：

```
public class BackupJob : IJob
{
    public BackupJob()
    {
    }

    public void Execute(JobExecutionContext context)
    {
        NSG.BackupJobStart();
    }
} 
```

我的问题：为什么“BackupJobStart（）”没有触发？我以前使用过类似的代码，它工作得很好。

编辑：@Andy White，我会在 Global.asax 的 Application_Start 中使用它。这不起作用，这就是为什么我将其移至按钮单击处理程序以缩小问题范围。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T06:54:52.217

你有连接 Quartz.NET 日志吗？我曾经遇到过无法执行作业的问题（我忘记了原因），但是一旦我启动了 Quartz.NET 日志记录，问题就很明显了。

值得一试（如果您还没有这样做）：

*   [https://www.quartz-scheduler.net/documentation/quartz-2.x/quick-start.html](https://www.quartz-scheduler.net/documentation/quartz-2.x/quick-start.html)
*   [http://netcommon.sourceforge.net/](http://netcommon.sourceforge.net/)
*   [http://netcommon.sourceforge.net/documentation.html](http://netcommon.sourceforge.net/documentation.html)

更新：只需将其添加到您的 program.cs 即可启用控制台日志记录：

```
Common.Logging.LogManager.Adapter = new Common.Logging.Simple.ConsoleOutLoggerFactoryAdapter { Level = Common.Logging.LogLevel.Info}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-31T11:52:13.270

也许是时间的问题。

我和你有同样的问题，我住在一个时间是 UTC + 2 的国家。所以，当我将 StartTimeUtc 设置为触发器时，我使用了 DateTime.Now，所以触发器不必触发直到两个小时后，我认为它必须在我的代码开始的那一刻被解雇。

仔细查看触发器的执行时间及其 StartTime

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T07:01:57.817

另一种可能性是您运行调度程序的方式。我不完全确定，但您可能会在尝试在 ASP.NET 应用程序中运行调度线程时遇到问题。将 SchedulerFactory/Scheduler 对象放在按钮单击处理程序中似乎不会为您提供所需的结果。

您可能需要在更“全局”级别创建调度程序，以便它可以在应用程序的“后台”中运行。将任何计划的工作移动到单独的 Windows 服务中也可能有意义，这样您就不必在 Web 应用程序中维护计划程序。

当你过去取得成功时，你是如何调用调度程序的？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-12T10:51:40.237

就我而言，IoC 存在问题——有些接口没有实现。我可以通过添加日志来查看我的问题：

`Common.Logging.LogManager.Adapter = new Common.Logging.Simple.ConsoleOutLoggerFactoryAdapter { Level = Common.Logging.LogLevel.Info};`

按照[安迪·怀特](https://stackoverflow.com/users/60096/andy-white)`Program.cs`的建议

# fortran77 - Fortran77 或更高版本中是否有解压缩文件的命令？

> ID：680478
> 
> 赞同：0
> 
> 时间：2009-03-25T06:54:18.613
> 
> 标签：fortran77, compression

我有一个压缩文件，我想解压缩它。你知道是否有命令或者我需要走另一条路吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T06:56:04.927

FORTRAN 77 中没有内置，但您可以使用 UNIX 命令 gzip、gunzip 来压缩/解压缩文件（假设您在 UNIX 上运行）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T07:02:44.257

[这](http://home.wanadoo.nl/~johndon/index.html)对你有帮助吗？

# sql - 按大小写和别名排序

> ID：680480
> 
> 赞同：1
> 
> 时间：2009-03-25T06:55:52.527
> 
> 标签：sql, sql-server, sql-order-by

我该如何使用

```
ORDER BY 
CASE @AccountOperator
WHEN '>' THEN AccountTrxValue 
END ASC,
CASE @AccountOperator
WHEN '<' THEN AccountTrxValue 
END DESC 
```

当 AccountTrxValue 是别名并且是“选择”中以下内容的结果时？

```
CASE WHEN PAA.RedeemValue>0 THEN
    PAA.RedeemValue * -1 
    ELSE PAA.EarnValue END
    AS AccountTrxValue , 
```

由于这种情况，它不接受别名

（不使用子查询）

## 编辑：

所以有人回答了我，我就是这样做的：

```
ORDER BY 
    CASE 
    WHEN @AccountOperator IS NULL OR @AccountOperator IN ('>','=') THEN
        CASE WHEN PAA.RedeemValue>0 THEN
        PAA.RedeemValue * -1 
        ELSE PAA.EarnValue  END 
    END DESC,  
CASE 
    WHEN @AccountOperator = '<'THEN
        CASE WHEN PAA.RedeemValue>0 THEN
        PAA.RedeemValue * -1 
        ELSE PAA.EarnValue  END 
    END 
```

我怎样才能用更短的方式写它？*我不能在“in”中包含null *我必须做2个案例，因为似乎“desc”应该写在“end”之后

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T07:03:41.493

```
ORDER BY 
    CASE @AccountOperator
        WHEN '>' THEN AccountTrxValue 
        WHEN '<' THEN -AccountTrxValue
    END 
```

您应该被允许在 ORDER BY 子句中使用列别名，假设 SQL Server

否则：

```
ORDER BY 
    CASE @AccountOperator
        WHEN '>' THEN
        CASE WHEN PAA.RedeemValue>0 THEN
        PAA.RedeemValue * -1 
        ELSE PAA.EarnValue END
    WHEN '<' THEN
        -CASE WHEN PAA.RedeemValue>0 THEN
        PAA.RedeemValue * -1 
        ELSE PAA.EarnValue END
END 
```

编辑：

-AccountTrxValue 或 -CASE WHEN PAA.RedeemValue>0... 简单地否定该值。这意味着默认 ASC 像 DESC 一样工作......

Edit2：非数字的一般情况

```
DECLARE @Switch char(1);
SELECT @Switch = '<';

SELECT
    *,
    ROW_NUMBER() OVER (ORDER BY SortCol ASC) AS SortASC,
    ROW_NUMBER() OVER (ORDER BY SortCol DESC) AS SortDESC
FROM
    dbo.tablename
ORDER BY 
    CASE @Switch
        WHEN '<' THEN ROW_NUMBER() OVER (ORDER BY SortCol ASC)
        WHEN '>' THEN ROW_NUMBER() OVER (ORDER BY SortCol DESC)
        ELSE 0
    END; 
```

# c# - 将附加信息与 .NET 枚举关联

> ID：680486
> 
> 赞同：23
> 
> 时间：2009-03-25T06:58:33.237
> 
> 标签：c#, .net, enums

我的问题最好用一个例子来说明。

假设我有枚举：

```
public enum ArrowDirection
{
    North,
    South,
    East,
    West
} 
```

我想将每个方向对应的单位向量与该方向相关联。例如，我想要返回 (0, 1) 代表 North，返回 (-1, 0) 代表 West 等的东西。我知道在 Java 中您可以在枚举中声明一个可以提供该功能的方法。

我当前的解决方案是有一个静态方法——在定义枚举的类中——返回一个与传入的 ArrowDirection 相对应的向量（该方法使用 HashTable 来完成查找，但这并不重要）。这似乎……不干净。

问题：
**在 .NET 中存储与枚举对应的附加信息是否有最佳实践解决方案？**

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-25T07:11:57.417

在 C# 3.0 中有一种奇妙的新方法可以做到这一点。关键是这个美丽的事实：枚举可以有扩展方法！因此，您可以执行以下操作：

```
public enum ArrowDirection
{
    North,
    South,
    East,
    West
}

public static class ArrowDirectionExtensions
{
     public static UnitVector UnitVector(this ArrowDirection self)
     {
         // Replace this with a dictionary or whatever you want ... you get the idea
         switch(self)
         {
             case ArrowDirection.North:
                 return new UnitVector(0, 1);
             case ArrowDirection.South:
                 return new UnitVector(0, -1);
             case ArrowDirection.East:
                 return new UnitVector(1, 0);
             case ArrowDirection.West:
                 return new UnitVector(-1, 0);
             default:
                 return null;
         }
     }
} 
```

现在，您可以这样做：

```
var unitVector = ArrowDirection.North.UnitVector(); 
```

甜的！我在大约一个月前才发现这一点，但这是 C# 3.0 新特性带来的一个非常好的结果。

[这是我博客上的另一个例子。](http://charlieflowers.wordpress.com/2009/04/01/c-delights-you-can-put-extension-methods-onto-enums/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T07:01:35.523

我在[这里](http://www.gigpeppers.com/blog/2008/07/06/enum-attributes/)写过博客。

[用Attributes](http://msdn.microsoft.com/en-us/library/aa288059(VS.71).aspx)试试这样的东西。

```
 public enum Status {

    [Status(Description = "Not Available")]      

    Not_Available = 1,      

    [Status(Description = "Available For Game")] 

    Available_For_Game = 2,      

    [Status(Description = "Available For Discussion")] 

    Available_For_Discussion = 3,

  }

  public class StatusEnumInfo {

    private static StatusAttribute[] edesc; 

    public static String GetDescription(object e)

    {

      System.Reflection.FieldInfo f = e.GetType().GetField(e.ToString()); 

      StatusEnumInfo.edesc = f.GetCustomAttributes(typeof(StatusAttribute), false) as StatusAttribute[]; 

      if (StatusEnumInfo.edesc != null && StatusEnumInfo.edesc.Length == 1)         

        return StatusEnumInfo.edesc[0].Description; 

      else         

        return String.Empty;

    } 

    public static object GetEnumFromDesc(Type t, string desc)

    {

      Array x = Enum.GetValues(t); 

      foreach (object o in x) {

        if (GetDescription(o).Equals(desc)) {

          return o;

        }

      } return String.Empty;

    }

  }

  public class StatusAttribute : Attribute {

    public String Description { get; set; }

  }

  public class Implemenation {

    public void Run()

    {

      Status statusEnum = (Status)StatusEnumInfo.GetEnumFromDesc(typeof(Status), "Not Available"); 

      String statusString = StatusEnumInfo.GetDescription(Status.Available_For_Discussion);

    }

  } 
```

而不是*Description*，使用您的自定义属性

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T07:15:12.247

```
using System.ComponentModel;
using System.Reflection;

public enum ArrowDirection
{

[Description("Northwards")]
North,

[Description("Southwards")]
South,

[Description("Eastwards")]
East,

[Description("Westwards")]
West
} 
```

...

创建一个扩展方法来获取描述列表：

```
public static class Enum<T> where T : struct
{

    /// <summary>
    /// Gets a collection of the enum value descriptions.
    /// </summary>
    /// <returns></returns>
    public static IList<string> GetDescriptions()
    {
        List<string> descriptions = new List<string>();
        foreach (object enumValue in Enum<T>.GetValues())
        {
            descriptions.Add(((Enum)enumValue).ToDescription());
        }
        return descriptions;

    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T07:04:20.273

您可以查看的一件事是“类型安全枚举”模式。这允许您创建一个实际上是一个成熟的静态对象的枚举，它可以具有方法/属性/等。

[http://www.javacamp.org/designPattern/enum.html](http://www.javacamp.org/designPattern/enum.html)

Joshua Bloch 在他的“Effective Java”一书中谈到了这种模式。我在很多不同的情况下都使用过它，实际上我更喜欢它而不是普通的枚举。（它与语言无关——它适用于 Java、C# 或几乎任何 OO 语言）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T07:07:04.200

您的静态方法方法对我来说似乎很干净。您将枚举和静态方法封装在同一个类中。对枚举的更改集中在该单个类中。

向枚举添加一个方法（根据 Java）似乎增加了一些非常简单的概念的复杂性。

基于属性的方法很有趣，但与静态方法相比，这似乎又使事情过于复杂了。

# c++ - 为什么我们使用 'this->' 而不是 'this'。访问成员？

> ID：680489
> 
> 赞同：3
> 
> 时间：2009-03-25T07:01:50.170
> 
> 标签：c++, visual-c++

我正在查看一个人用 C++ 为 FaceBook 制作的库。头文件是这样的：

```
#ifndef __FACEBOOK_H__
#define __FACEBOOK_H__

/**
 * Facebook Class 
 * Joel Seligstein
 * Last mod: Aug 22, 2006
 *
 * This is the beginnings of a facebook class set and REST client.  Its not documented
 * yet nor nearly complete.  But this is a release to demonstrate its usefulness.  
 * Please email joel@seligstein.com with suggestions or additions.
 *
 * TODO: Create classes/parsers for each request type
 * TODO: Linux URL launcher
 */

//uncomment to have verbose output turned on
//#define fb_debug 1

//define which platform you're compiling for
#define fb_windows 1
//#define fb_linux 1

#include <string>
#include <sstream>
#include <list>
using namespace std;

#ifdef fb_windows
#include <windows.h>
#endif

#include "curl/curl.h"
#include "xmlParser/xmlParser.h"
#include "md5.h"

class facebook
{
    public:
        //app/session vars
        string api_key;
        string secret;
        string token;
        string server;
        string session_key;
        string session_secret;
        string uid;
        bool has_session;

        facebook( string my_key, string my_secret, string my_server );
        bool authenticate( );
        bool request( string method, list<string> params, string *res );
        bool load_token( );
        void launch_login( string url );
        bool get_session( );
        void clean_up( );

    private:
        //curl info
        CURL *curl;
        CURLcode res;
        int call_id;

        //internal functions
        string get_signature( list<string> params );
        static string md5( string str );
        static string get_param_string( list<string> params, bool separate );
        static size_t write_callback( void *ptr, size_t size, size_t nmemb, void *userp );
};

#endif //__FACEBOOK_H__ 
```

然后在cpp文件中，我的问题是关于这个，下面是构造函数：

```
facebook::facebook( string my_key, string my_secret, string my_server )
{
    this->api_key = my_key;
    this->secret = my_secret;
    this->server = my_server;
    this->has_session = false;
    this->call_id = 0;
} 
```

为什么他们使用`->`运算符而不是`.`？

我对直接在内存中访问类型的属性和方法的理解有限，`->`但我很困惑，由于无知，我希望看到：

```
facebook::facebook( string my_key, string my_secret, string my_server )
{
    this.api_key = my_key;
    this.secret = my_secret;
    this.server = my_server;
    this.has_session = false;
    this.call_id = 0;
} 
```

我只想知道为什么`->`在点符号上使用背后的理论。

* * *

**更新：对于和我在同一条船上学习 C++ 的任何人。我已经扩展了成员在此问题中发布的示例。我还包含在成员字段的初始化列表中。**

```
#include "stdafx.h"
#include <iostream>
using namespace std;

class A {
private:
    int x;
public:
    A() : x(0){}
    int getX() const {return x;}
    void setX(int xx) {x += xx;}
};

int main()
{
    A a;

    a.setX(13);

    A *pa = &a;

    pa->setX(2);

    A b = a;

    b.setX(5);

    cout << "a" << a.getX() << endl;

    cout << "a*" << pa->getX() << endl;

    cout << "b" << b.getX() << endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-25T07:05:23.877

`this`是*指向*当前对象的指针，即 的内部方法（或构造函数）`class A`的`this`类型为`A *`。

（请注意，如果方法标记为`const`，`this`则为 类型`A const *`。）

因此使用`->`（仅为指针设计）而不是`.`（仅为类对象`A`或对类对象的引用而设计`A&`）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T07:06:31.657

在 C++ 中，`this`是指向 self 对象的指针。它是 C++ 早期版本的遗留物，在它有引用之前。如果`this`现在将其添加到语言中，它可能是一个参考，您将使用该`.`符号。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T07:06:47.397

因为在类或结构成员内部，“this”是一个指向当前实例的特殊指针。

每当您通过指针访问类或结构的成员时，都会使用 -> 运算符。

如果您通过非指针（通常是引用）的任何内容访问它们，则使用点运算符。

值得注意的是 this-> 语法不是必需的，除非在某些形式的模板实例化中。不过，很多人出于风格原因选择使用它。已经有几个与 SO 背后的基本原理相关的问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-25T07:16:32.430

您可以考虑以下示例。

```
class A {
    int x;
public:
    int getX() const {return x;}
    void setx(int xx) {x = xx;}
};

int main()
{
    A a;

    a.setX(13);
    cout << a.getX() << endl;

    A *pa = &a;

    cout << pa->getX() << endl;

    return 0;
} 
```

请注意，点运算符 (.) 在直接使用对象 a 调用 A 的成员函数时使用。当通过类型 A 的指针 (A *pa = &a) 间接调用 A 的成员函数时，使用箭头运算符 (->)。

在 C++ 中，*这*是一个指向调用对象的指针。因此我们也可以如下定义 A::getX() 函数：

```
int getX() const {return this->x;} 
```

或者：

```
int getX() const {return (*this).x;} 
```

this 是对象 A 的指针，因此 *this 取消引用它。所以我们可以使用上面的两个函数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T07:15:09.967

如前所述，这是一个指针，而不是一个引用。因此，您需要大致（但不完全相同）的 -> 运算符：(*this)。

它们的不同之处在于您可以在类中重载 -> 运算符或 * 运算符，并且可以具有不同的语义。事实上，如果一个类覆盖了 operator-> 并且返回的值不是原始指针，编译器将继续将 operator-> 应用于返回的对象，直到它到达本地指针。操作员 。不能超载。

在您指出的构造函数中，使用 this 是完全可选的，因为没有名称冲突，代码可以只命名属性而无需进一步限定。

```
facebook::facebook( string my_key, string my_secret, string my_server )
{
    api_key = my_key;
    secret = my_secret;
    server = my_server;
    has_session = false;
    call_id = 0;
} 
```

更好的解决方案是使用初始化列表。如果你有兴趣学习 C++ 谷歌。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-20T01:19:10.910

因为“this”是一个特殊的指针，指向当前对象，我们使用“->”通过指针和“.”来访问对象的成员。用于直接调用对象的成员。

# iphone - 如何获取位置

> ID：680491
> 
> 赞同：0
> 
> 时间：2009-03-25T07:02:14.243
> 
> 标签：iphone, objective-c

如何以编程方式使用 WiFi 获取当前位置？我在一个房间里，里面有我的 WiFi 机器。

我有两台有 Wifi 的机器，我想在我的 Iphone 上找到我当前的位置。

那么如何使用两台机器获取当前位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T07:26:48.740

您可能想在这里查看[http://www.iphonedevsdk.com/forum/tutorial-requests/2343-tutorial-request-core-location.html](http://www.iphonedevsdk.com/forum/tutorial-requests/2343-tutorial-request-core-location.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T07:32:19.413

您还需要在 Skyhook 注册您的 wifi 路由器才能使用 wifi 定位服务

[关联](http://skyhookwireless.com/howitworks/submit_ap.php)

# encoding - 什么多字节字符集以 0x7F 开头，长度为 4 个字节？

> ID：680495
> 
> 赞同：1
> 
> 时间：2009-03-25T07:04:13.927
> 
> 标签：encoding, mbcs

我正在尝试获取一些旧代码来正确显示中文字符。我尝试使用的一种字符编码以 0x7F 开头，长度为 4 个字节（包括 0x7F 字节）。有谁知道这是哪种编码以及我在哪里可以找到它的信息？谢谢..

更新：我还必须使用一些日语编码，每个字符都以 0xE3 开头，长度为三个字节。如果我在 Windows 中选择日语语言环境，它会正确显示在我的计算机上，但是，它不会在我们的应用程序中正确显示。但是，如果选择了除日语以外的任何其他语言环境，我什至无法正确查看文件名。所以我猜这种编码不是Unicode。有人知道这是什么吗？是ANSI吗？是 Shift JIS 吗？

对于中文，我用 Unicode 和 UTF-8 字符对其进行了测试，我得到了相同的模式；0x7F 后跟三个字节。Unicode 和 UTF-8 是一样的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T15:02:34.820

> 我正在尝试使用的一种字符编码以 0x7F 开头，长度为 4 个字节

其他字节是什么？你有这种编码的拉丁文吗？

如果它是“0x7f 0x...0x00 0x00”，那么您正在查看 UTF-32LE。它也可以是两个 UTF-16（LE 或 BE）字符。

大多数东亚编码使用 0x80-0xFF 作为非 ASCII 字符的前导字节；我知道没有人会使用前导 0x7F 作为 ASCII 删除以外的任何内容。

预计到达时间：

> 应该有字节顺序标记吗？

如果有一种带外方式表明编码是“UTF-32LE”（可能在它到达您之前就丢失了），则不需要 BOM。

> 我还必须使用一些日语编码，每个字符都以 0xE3 开头，长度为三个字节。

那肯定是UTF-8。序列 0xE3 0x... 0x... 将导致 U+3000 和 U+4000 之间的字符，这是平假名/片假名所在的位置。

> 如果我在 Windows 中选择日语语言环境，它会正确显示在我的计算机上，但是，它不会在我们的应用程序中正确显示。

那么您的应用程序很可能是令人遗憾的一大群不符合 Unicode 的应用程序之一，仍然在以“W”为后缀的应用程序中使用“A”（*）版本的 Win32 接口。您是否可以根据其实际编码读取字符串是没有实际意义的：不符合 Unicode 的应用程序将永远无法在西方语言环境中显示东亚表意文字。

（*：以“ANSI”命名，这是 Windows 对“当前系统代码页设置的任何内容”的误导性术语。这就是更改区域设置会影响它的原因。）

预计到达时间（2）：

好的，破解了。这不是我以前遇到过的任何标准化编码，但如果您假设 Unicode 代码点正在被编码，那么它相对容易破译。

```
0x00-0x7E: plain ASCII
0x7F A B C: Unicode character 
```

以 Unicode 转义编码的字符可以通过获取 A、B 和 C 的键字符串中的索引并将其相加来计算：

```
A*0x1000 + B*0x40 + C 
```

也就是说，它是一个 base-64 字符集，但它不是通常的 Base64 标准。一个小实验给出了一个关键字符串：

```
.0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz 
```

这 '。' 和 '_' 字符是猜测，因为您发布的字符都没有使用它们。我们需要更多数据来找出确切的字符串。

因此，例如：

```
0x7F 3 u g
A=4 B=58 C=44
4*0x1000 + 58*0x40 + 44 = 0x4EAC
U+4EAC = 京 
```

预计到达时间（3）：

是的，通过手动提取每个代码点并作为字符加入来创建本机 Unicode 字符串应该很容易。不太确定在您使用的任何平台上都有什么可用的，但任何支持 Unicode 的平台都应该能够简单地从代码点生成字符串（并且希望无需手动重新编码为 UTF-16LE 字节）。

我注意到这三个示例字符在相同的一般范围内具有第一个转义字符，并且与它们的 Unicode 代码点具有相同的数字顺序，因此我认为它一定是 Unicode 代码点。其他两个字符似乎是随机变化的，所以它很可能是代码点的大端编码，并且可能作为 6 的 base-64 编码是您可以从可读 ASCII 中获得的尽可能多的位。

标准 Base64 本身以字母开头，这会使以数字开头的东西在基本多语言平面中太远了。所以我开始猜测 '0123456789ABCDEFG...' 这将是另一个明显的键字符串选择。这样得到的数字接近给定字符的代码点，但有点太低了。在密钥字符串的开头插入一个额外的字符（因此数字“0”不映射到数字 0）使其中一个字符正确，另外两个非常接近；正确的那个没有小写字母，所以为了只更改小写字母，我在大写和小写之间插入了另一个字符。这得出了正确的数字。

不能保证这实际上是正确的，但是（除了插入字符的任意选择）它很可能是正确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T07:29:53.350

您可能想查看维基百科上的[中文字符编码](http://en.wikipedia.org/wiki/Chinese_character_encoding)页面。我可以看到的唯一编码总是 4 个字节是[UTF-32](http://en.wikipedia.org/wiki/UTF-32)。

[GB 18030](http://en.wikipedia.org/wiki/GB_18030)是当前标准的中文字符集，但长度可以为 1 到 4 个字节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T02:24:35.820

试试[chardet](http://chardet.feedparser.org/)。它可以很好地猜测一串字节的字符编码。

> Unicode 和 UTF-8 是一样的吗？

不，UTF-8 只是将 Unicode 字符表示为字节序列的一种方式。Unicode 是完整的标准，为每个字符分配数字和人类可读的标识符，以及有关字符的大量元数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T07:29:34.910

它可能是有效的 unicode 编码，例如 utf-8 或 UTF16 代理对。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T01:47:51.447

是的，中文是UTF-8，是Unicode的一种实现（编码）。UTF-8 的 ASCII 字符长度为 1 个字节，其他字符最多为 4 个字节。

# c# - 如何制作 WPF Expander Stretch？

> ID：680498
> 
> 赞同：32
> 
> 时间：2009-03-25T07:04:37.747
> 
> 标签：c#, wpf, expander, stretch

WPF 中的`Expander`控件不会拉伸以填充所有可用空间。XAML 中有解决方案吗？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-03-25T07:10:37.937

您需要做的就是：

```
<Expander>
  <Expander.Header>
    <TextBlock
      Text="I am header text..."
      Background="Blue"
      Width="{Binding
        RelativeSource={RelativeSource
          Mode=FindAncestor,
          AncestorType={x:Type Expander}},
        Path=ActualWidth}"
      />
  </Expander.Header>
  <TextBlock Background="Red">
    I am some content...
  </TextBlock>
</Expander> 
```

[http://joshsmithonwpf.wordpress.com/2007/02/24/stretching-content-in-an-expander-header/](http://joshsmithonwpf.wordpress.com/2007/02/24/stretching-content-in-an-expander-header/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-25T10:19:51.803

不可拉伸`Expander`的通常是不可拉伸的父控件的问题。也许其中一个父控件定义了一个`HorizontalAlignment`或`VerticalAlignment`属性？

如果您可以发布一些示例代码，我们可以为您提供更好的答案。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-12-15T18:55:56.463

此解决方案要简单得多，并且不会影响您可能在应用程序中使用的其他扩展器控件。

```
 <Expander ExpandDirection="Right" Grid.Column="0" Name="topOfB"> 
    <Expander.Header>
        <Grid HorizontalAlignment="Stretch" Width="{Binding Path=ActualWidth, ElementName=topOfB}">
            <!-- control content goes here --> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-10-28T20:55:42.053

接受的答案在控件之外，因为标题内容在一个列中，而扩展器按钮在第一列。在某些情况下可能已经足够好了。

如果您想要一个干净的解决方案，您必须更改扩展器的模板。

另一种方式是附加属性：

```
using System.Collections.Generic;
using System.Linq;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media;
public static class ParentContentPresenter
{
    public static readonly System.Windows.DependencyProperty HorizontalAlignmentProperty = System.Windows.DependencyProperty.RegisterAttached(
        "HorizontalAlignment",
        typeof(HorizontalAlignment),
        typeof(ParentContentPresenter),
        new PropertyMetadata(default(HorizontalAlignment), OnHorizontalAlignmentChanged));

    public static void SetHorizontalAlignment(this UIElement element, HorizontalAlignment value)
    {
        element.SetValue(HorizontalAlignmentProperty, value);
    }

    [AttachedPropertyBrowsableForChildren(IncludeDescendants = false)]
    [AttachedPropertyBrowsableForType(typeof(UIElement))]
    public static HorizontalAlignment GetHorizontalAlignment(this UIElement element)
    {
        return (HorizontalAlignment)element.GetValue(HorizontalAlignmentProperty);
    }

    private static void OnHorizontalAlignmentChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var presenter = d.Parents().OfType<ContentPresenter>().FirstOrDefault();
        if (presenter != null)
        {
            presenter.HorizontalAlignment = (HorizontalAlignment) e.NewValue;
        }
    }

    private static IEnumerable<DependencyObject> Parents(this DependencyObject child)
    {
        var parent = VisualTreeHelper.GetParent(child);
        while (parent != null)
        {
            yield return parent;
            child = parent;
            parent = VisualTreeHelper.GetParent(child);
        }
    }
} 
```

它让您可以：

```
<Expander Header="{Binding ...}">
    <Expander.HeaderTemplate>
        <DataTemplate>
            <!--Using a border here to show how width changes-->
            <Border BorderBrush="Red" BorderThickness="1"
                    local:ParentContentPresenter.HorizontalAlignment="Stretch">
                ...    
            </Border>
        </DataTemplate>
    </Expander.HeaderTemplate>
</Expander> 
```

请注意，附加属性的使用有些脆弱，因为它假定`ContentPresenter`模板中有 a。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-03-10T12:20:23.403

我很惊讶没有人提到只编辑控件模板，所有其他解决方案都有一些非常严重的缺点，比如不能正确计算宽度，不能重绘，渲染时间等等......

此控件模板将修改标题的 contentpresenter 水平对齐方式以匹配实际的扩展器（意味着它会拉伸）

```
 <ControlTemplate x:Key="ExpanderControlTemplate1" TargetType="{x:Type Expander}">
        <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" CornerRadius="3" SnapsToDevicePixels="True">
            <DockPanel>
                <ToggleButton x:Name="HeaderSite" ContentTemplate="{TemplateBinding HeaderTemplate}" Content="{TemplateBinding Header}" DockPanel.Dock="Top" Foreground="{TemplateBinding Foreground}" FontWeight="{TemplateBinding FontWeight}" FontStyle="{TemplateBinding FontStyle}" FontStretch="{TemplateBinding FontStretch}" FontSize="{TemplateBinding FontSize}" FontFamily="{TemplateBinding FontFamily}" HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}" IsChecked="{Binding IsExpanded, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Margin="1" MinWidth="0" MinHeight="0" Padding="{TemplateBinding Padding}" VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}">
                    <ToggleButton.FocusVisualStyle>
                        <Style>
                            <Setter Property="Control.Template">
                                <Setter.Value>
                                    <ControlTemplate>
                                        <Border>
                                            <Rectangle Margin="0" SnapsToDevicePixels="True" Stroke="Black" StrokeThickness="1" StrokeDashArray="1 2"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </ToggleButton.FocusVisualStyle>
                    <ToggleButton.Style>
                        <Style TargetType="{x:Type ToggleButton}">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                                        <Border Padding="{TemplateBinding Padding}">
                                            <Grid Background="Transparent" SnapsToDevicePixels="False">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="19"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Ellipse x:Name="circle" Fill="White" HorizontalAlignment="Center" Height="19" Stroke="#FF333333" VerticalAlignment="Center" Width="19"/>
                                                <Path x:Name="arrow" Data="M1,1.5L4.5,5 8,1.5" HorizontalAlignment="Center" SnapsToDevicePixels="False" Stroke="#FF333333" StrokeThickness="2" VerticalAlignment="Center"/>
                                                <ContentPresenter ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" Grid.Column="1" ContentStringFormat="{TemplateBinding ContentStringFormat}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="4,0,0,0" RecognizesAccessKey="True" SnapsToDevicePixels="True" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsChecked" Value="True">
                                                <Setter Property="Data" TargetName="arrow" Value="M1,4.5L4.5,1 8,4.5"/>
                                            </Trigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Stroke" TargetName="circle" Value="#FF5593FF"/>
                                                <Setter Property="Fill" TargetName="circle" Value="#FFF3F9FF"/>
                                                <Setter Property="Stroke" TargetName="arrow" Value="Black"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter Property="Stroke" TargetName="circle" Value="#FF3C77DD"/>
                                                <Setter Property="StrokeThickness" TargetName="circle" Value="1.5"/>
                                                <Setter Property="Fill" TargetName="circle" Value="#FFD9ECFF"/>
                                                <Setter Property="Stroke" TargetName="arrow" Value="Black"/>
                                            </Trigger>
                                            <Trigger Property="IsEnabled" Value="False">
                                                <Setter Property="Stroke" TargetName="circle" Value="#FFBCBCBC"/>
                                                <Setter Property="Fill" TargetName="circle" Value="#FFE6E6E6"/>
                                                <Setter Property="Stroke" TargetName="arrow" Value="#FF707070"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </ToggleButton.Style>
                </ToggleButton>
                <ContentPresenter x:Name="ExpandSite" ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" ContentStringFormat="{TemplateBinding ContentStringFormat}" DockPanel.Dock="Bottom" Focusable="False" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" Visibility="Collapsed" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
            </DockPanel>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsExpanded" Value="True">
                <Setter Property="Visibility" TargetName="ExpandSite" Value="Visible"/>
            </Trigger>
            <Trigger Property="ExpandDirection" Value="Right">
                <Setter Property="DockPanel.Dock" TargetName="ExpandSite" Value="Right"/>
                <Setter Property="DockPanel.Dock" TargetName="HeaderSite" Value="Left"/>
                <Setter Property="Style" TargetName="HeaderSite">
                    <Setter.Value>
                        <Style TargetType="{x:Type ToggleButton}">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                                        <Border Padding="{TemplateBinding Padding}">
                                            <Grid Background="Transparent" SnapsToDevicePixels="False">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="19"/>
                                                    <RowDefinition Height="*"/>
                                                </Grid.RowDefinitions>
                                                <Grid>
                                                    <Grid.LayoutTransform>
                                                        <TransformGroup>
                                                            <RotateTransform Angle="-90"/>
                                                        </TransformGroup>
                                                    </Grid.LayoutTransform>
                                                    <Ellipse x:Name="circle" Fill="White" HorizontalAlignment="Center" Height="19" Stroke="#FF333333" VerticalAlignment="Center" Width="19"/>
                                                    <Path x:Name="arrow" Data="M1,1.5L4.5,5 8,1.5" HorizontalAlignment="Center" SnapsToDevicePixels="False" Stroke="#FF333333" StrokeThickness="2" VerticalAlignment="Center"/>
                                                </Grid>
                                                <ContentPresenter ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" ContentStringFormat="{TemplateBinding ContentStringFormat}" HorizontalAlignment="Center" Margin="0,4,0,0" Grid.Row="1" RecognizesAccessKey="True" SnapsToDevicePixels="True" VerticalAlignment="Top"/>
                                            </Grid>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsChecked" Value="True">
                                                <Setter Property="Data" TargetName="arrow" Value="M1,4.5L4.5,1 8,4.5"/>
                                            </Trigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Stroke" TargetName="circle" Value="#FF5593FF"/>
                                                <Setter Property="Fill" TargetName="circle" Value="#FFF3F9FF"/>
                                                <Setter Property="Stroke" TargetName="arrow" Value="Black"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter Property="Stroke" TargetName="circle" Value="#FF3C77DD"/>
                                                <Setter Property="StrokeThickness" TargetName="circle" Value="1.5"/>
                                                <Setter Property="Fill" TargetName="circle" Value="#FFD9ECFF"/>
                                                <Setter Property="Stroke" TargetName="arrow" Value="Black"/>
                                            </Trigger>
                                            <Trigger Property="IsEnabled" Value="False">
                                                <Setter Property="Stroke" TargetName="circle" Value="#FFBCBCBC"/>
                                                <Setter Property="Fill" TargetName="circle" Value="#FFE6E6E6"/>
                                                <Setter Property="Stroke" TargetName="arrow" Value="#FF707070"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Setter.Value>
                </Setter>
            </Trigger>
            <Trigger Property="ExpandDirection" Value="Up">
                <Setter Property="DockPanel.Dock" TargetName="ExpandSite" Value="Top"/>
                <Setter Property="DockPanel.Dock" TargetName="HeaderSite" Value="Bottom"/>
                <Setter Property="Style" TargetName="HeaderSite">
                    <Setter.Value>
                        <Style TargetType="{x:Type ToggleButton}">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                                        <Border Padding="{TemplateBinding Padding}">
                                            <Grid Background="Transparent" SnapsToDevicePixels="False">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="19"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid>
                                                    <Grid.LayoutTransform>
                                                        <TransformGroup>
                                                            <RotateTransform Angle="180"/>
                                                        </TransformGroup>
                                                    </Grid.LayoutTransform>
                                                    <Ellipse x:Name="circle" Fill="White" HorizontalAlignment="Center" Height="19" Stroke="#FF333333" VerticalAlignment="Center" Width="19"/>
                                                    <Path x:Name="arrow" Data="M1,1.5L4.5,5 8,1.5" HorizontalAlignment="Center" SnapsToDevicePixels="False" Stroke="#FF333333" StrokeThickness="2" VerticalAlignment="Center"/>
                                                </Grid>
                                                <ContentPresenter ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" Grid.Column="1" ContentStringFormat="{TemplateBinding ContentStringFormat}" HorizontalAlignment="Left" Margin="4,0,0,0" RecognizesAccessKey="True" SnapsToDevicePixels="True" VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsChecked" Value="True">
                                                <Setter Property="Data" TargetName="arrow" Value="M1,4.5L4.5,1 8,4.5"/>
                                            </Trigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Stroke" TargetName="circle" Value="#FF5593FF"/>
                                                <Setter Property="Fill" TargetName="circle" Value="#FFF3F9FF"/>
                                                <Setter Property="Stroke" TargetName="arrow" Value="Black"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter Property="Stroke" TargetName="circle" Value="#FF3C77DD"/>
                                                <Setter Property="StrokeThickness" TargetName="circle" Value="1.5"/>
                                                <Setter Property="Fill" TargetName="circle" Value="#FFD9ECFF"/>
                                                <Setter Property="Stroke" TargetName="arrow" Value="Black"/>
                                            </Trigger>
                                            <Trigger Property="IsEnabled" Value="False">
                                                <Setter Property="Stroke" TargetName="circle" Value="#FFBCBCBC"/>
                                                <Setter Property="Fill" TargetName="circle" Value="#FFE6E6E6"/>
                                                <Setter Property="Stroke" TargetName="arrow" Value="#FF707070"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Setter.Value>
                </Setter>
            </Trigger>
            <Trigger Property="ExpandDirection" Value="Left">
                <Setter Property="DockPanel.Dock" TargetName="ExpandSite" Value="Left"/>
                <Setter Property="DockPanel.Dock" TargetName="HeaderSite" Value="Right"/>
                <Setter Property="Style" TargetName="HeaderSite">
                    <Setter.Value>
                        <Style TargetType="{x:Type ToggleButton}">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                                        <Border Padding="{TemplateBinding Padding}">
                                            <Grid Background="Transparent" SnapsToDevicePixels="False">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="19"/>
                                                    <RowDefinition Height="*"/>
                                                </Grid.RowDefinitions>
                                                <Grid>
                                                    <Grid.LayoutTransform>
                                                        <TransformGroup>
                                                            <RotateTransform Angle="90"/>
                                                        </TransformGroup>
                                                    </Grid.LayoutTransform>
                                                    <Ellipse x:Name="circle" Fill="White" HorizontalAlignment="Center" Height="19" Stroke="#FF333333" VerticalAlignment="Center" Width="19"/>
                                                    <Path x:Name="arrow" Data="M1,1.5L4.5,5 8,1.5" HorizontalAlignment="Center" SnapsToDevicePixels="False" Stroke="#FF333333" StrokeThickness="2" VerticalAlignment="Center"/>
                                                </Grid>
                                                <ContentPresenter ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" ContentStringFormat="{TemplateBinding ContentStringFormat}" HorizontalAlignment="Center" Margin="0,4,0,0" Grid.Row="1" RecognizesAccessKey="True" SnapsToDevicePixels="True" VerticalAlignment="Top"/>
                                            </Grid>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsChecked" Value="True">
                                                <Setter Property="Data" TargetName="arrow" Value="M1,4.5L4.5,1 8,4.5"/>
                                            </Trigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Stroke" TargetName="circle" Value="#FF5593FF"/>
                                                <Setter Property="Fill" TargetName="circle" Value="#FFF3F9FF"/>
                                                <Setter Property="Stroke" TargetName="arrow" Value="Black"/>
                                            </Trigger>
                                            <Trigger Property="IsPressed" Value="True">
                                                <Setter Property="Stroke" TargetName="circle" Value="#FF3C77DD"/>
                                                <Setter Property="StrokeThickness" TargetName="circle" Value="1.5"/>
                                                <Setter Property="Fill" TargetName="circle" Value="#FFD9ECFF"/>
                                                <Setter Property="Stroke" TargetName="arrow" Value="Black"/>
                                            </Trigger>
                                            <Trigger Property="IsEnabled" Value="False">
                                                <Setter Property="Stroke" TargetName="circle" Value="#FFBCBCBC"/>
                                                <Setter Property="Fill" TargetName="circle" Value="#FFE6E6E6"/>
                                                <Setter Property="Stroke" TargetName="arrow" Value="#FF707070"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Setter.Value>
                </Setter>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
                <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-05T04:53:37.717

```
<Expander Name="EXPANDER_NAME">
    <Expander IsExpanded="True" Margin="0">
        <Expander.Header>
            <Grid Background="Red" Width="{Binding ElementName=EXPANDER_NAME, Path=ActualWidth}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="30"/>
                </Grid.ColumnDefinitions>
                <TextBlock>          HEADER TEXT          <TextBlock>
            </Grid>
        </Expander.Header>
   </Expander> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-25T10:58:00.337

我同意 HTH - 检查您将 Expander 放入哪种容器...... StackPanel 将始终将其子项折叠到他们可以达到的最小尺寸。

我在我的项目中经常使用扩展器，如果将它们放入网格/DockPanel，那么扩展器将填充所有可用空间（假设它的垂直和水平方向设置为拉伸）。

乔纳森关于将扩展器的宽度绑定到容器的宽度的建议可能有点棘手......我几周前尝试了这种技术，发现它在某些情况下会产生不良结果，因为它会抑制布局系统的功能。

PS：作为一般提示（我敢肯定我会因为写这篇文章而被激怒），如果你不确定你的控件是哪种布局容器，那么从 Grid 开始。使用 Column & Row 定义可以很容易地控制子控件是使用最小空间（“Auto”）、最大空间（“*”）还是精确的空间量（“[number]”）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-25T12:38:05.357

Silverlight 工具包包括一个[Accordion](http://silverlight.codeplex.com/Wiki/View.aspx?title=Silverlight%20Toolkit%20Overview%20Part%201&referringTitle=Home)控件，它的作用就像一个始终延伸到可用空间的扩展器。我尚未对其进行测试，但它可能也适用于 WPF，例如 Silverlight Chart 控件。

# iphone - 精灵延迟

> ID：680509
> 
> 赞同：1
> 
> 时间：2009-03-25T07:08:34.243
> 
> 标签：iphone

我有一个精灵和一组坐标...我希望我的精灵跟随那条路径及其跟随，但它太快以至于我只能看到最后一个位置......所以我想在每一个新的位置引入延迟位置..所以我怎么能做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T07:15:17.957

简短的回答：NSTimer。在每个计时器滴答声中更新您的精灵位置。通常，您希望拥有一个每秒触发 X 次的主计时器/时钟，并根据该时钟更新所有动画逻辑。30fps 适合游戏。

如果你在做游戏，你检查过cocos2d-iphone吗？

# java - Java中的对象池

> ID：680514
> 
> 赞同：15
> 
> 时间：2009-03-25T07:11:43.627
> 
> 标签：java, memory-management, garbage-collection

维护一个经常使用的对象池并从池中获取一个而不是创建一个新对象的优点和缺点是什么。类似于字符串实习的东西，除了它对所有类对象都是可能的。

例如，它可以被认为是好的，因为它节省了 gc 时间和对象创建时间。另一方面，如果从多个线程中使用它可能会成为同步瓶颈，需要显式释放并引入内存泄漏的可能性。通过占用可以回收的内存，它给垃圾收集器带来了额外的压力。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-25T07:36:33.880

优化第一定律：不要这样做。第二定律：除非您确实已经测量并知道您需要优化以及在哪里进行优化，否则不要这样做。

只有当对象的创建成本真的很高，并且它们实际上可以被重用（您可以仅通过公共操作将状态重置为可以重用的东西）时，它才会有效。

你提到的两个好处并不是真的：java中的内存分配是*免费*的（成本接近10条cpu指令，这没什么）。所以减少对象的创建只会节省你在构造函数中花费的时间。对于可以重用的重对象（数据库连接、线程）而无需更改，这可能是一个收获：您重用*相同*的连接、相同的线程。

GC 时间没有减少。事实上，情况可能更糟。使用移动的分代 GC（Java 是或曾经达到 1.5），GC 运行的成本取决于活动对象的数量，而不是释放的内存。活动对象将被移动到内存中的另一个空间（这就是内存分配如此快速的原因：空闲内存在每个 GC 块内是连续的），然后被标记为*旧的*并移动到老一代内存空间。

编程语言和支持，如 GC，在设计时考虑了常见用法。如果您在许多情况下避开常见用法，您最终可能会得到更难阅读且效率较低的代码。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-25T07:16:00.823

除非创建该对象的成本很高，否则我不会打扰。

好处：

*   创建的对象更少 - 如果创建对象的成本很高，这可能很重要。（典型的例子可能是数据库连接，其中“创建”包括与服务器建立网络连接、提供身份验证等）

缺点：

*   更复杂的代码
*   共享资源 = 锁定；潜在瓶颈
*   违反 GC 对对象生命周期的期望（大多数对象将是短暂的）

你有一个你想要解决的实际问题，还是这是推测性的？除非您的基准/配置文件运行表明存在问题，否则我不会考虑做这样的事情。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-25T07:38:53.407

池化意味着您通常不能使对象不可变。这会导致防御性复制，因此您最终会制作比仅制作新的不可变对象时更多的副本。

不变性并不总是可取的，但通常你会发现事物可以是不可变的。使它们不是不可变的，以便您可以在池中重用它们可能不是一个好主意。

所以，除非你确定这是一个问题，否则不要打扰。使代码清晰易懂，并且它可能会足够快。如果不是这样，那么代码清晰且易于遵循的事实将使其更容易加速（通常）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-25T07:37:55.373

不。

这是2001年的想法。现在唯一仍然有价值的对象“池”是单例。我仅使用单例来减少出于分析目的而创建的对象（因此我可以更清楚地看到影响代码的因素）。

其他任何事情都只是为了没有好的目的而碎片化内存。

继续运行关于创建 1,000,000 个对象的配置文件。这是微不足道的。

[旧文章在这里。](http://www.ibm.com/developerworks/java/library/j-jtp01274.html)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-25T16:14:43.883

*与创建对象的次数相比，*这完全取决于创建对象的成本……例如，只是美化结构的对象（例如，仅包含几个字段，除了访问器之外没有其他方法）可以成为池化的真实用例。

一个现实生活中的例子：我需要从生成大量整数/等级对的过程中重复提取 n 个最高等级的项目（整数）。我在有界优先级队列中使用了一个“对”对象（一个整数和一个浮点等级值）。重用对，与清空队列、丢弃对并重新创建它们相比，性能提高了 20%……主要是在 GC 费用方面，因为在 JVM 的整个生命周期中不需要重新分配对。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-26T21:12:43.910

对象池通常仅适用于数据库连接等昂贵对象。在 Java 1.4.2 之前，对象池可以提高性能，但从 Java 5.0 开始，对象池更有可能损害性能而不是帮助，并且经常删除对象池以提高性能（和简单性）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-25T07:25:56.243

我同意 Jon Skeet 的观点，如果您没有创建对象池的特定理由，我不会打扰。

不过，在某些情况下，游泳池确实很有帮助/必要。如果您有一个创建成本很高但可以重复使用的资源（例如数据库连接），那么使用池可能是有意义的。此外，在数据库连接的情况下，池对于防止您的应用程序打开太多与数据库的并发连接很有用。

# svn - 有没有办法将存储库用作“模板”来启动新的存储库？

> ID：680518
> 
> 赞同：3
> 
> 时间：2009-03-25T07:13:53.653
> 
> 标签：svn, repository

我有一个 Subversion 存储库，其中包含外部文件和一些文件以开始创建新站点，例如基于库的基本登录设置。

我想知道是否有一种方法可以将此存储库“复制”到另一个保留外部的存储库中，这样我就不必再次设置它们了？我不担心保留历史。这类似于执行导出然后设置外部，但将是一步过程。有办法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-25T07:17:48.993

您需要的命令是：

[`svnadmin dump`](http://svnbook.red-bean.com/en/1.0/re31.html)和[`svnadmin load`](http://svnbook.red-bean.com/en/1.0/re36.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T10:42:24.493

请确保您的新存储库具有新的 UUID。如果你只是复制你的存储库，一些颠覆命令会将存储库视为相同。

（如果您需要更改 uuid，请参阅 svnadmin help setuuid）。

保持相同的 UUID 会破坏某些形式的缓存、存储库内合并，甚至在未来的 Subversion 版本中可能会更多。（UUID 是识别来自不同或相同存储库的主键）

# asp.net - 在 Web.config 中是否可以在指定目录中注册所有用户控件

> ID：680519
> 
> 赞同：5
> 
> 时间：2009-03-25T07:14:33.947
> 
> 标签：asp.net, user-controls, web-config

目前我在 Web.config 中分别注册每个用户控件

```
<pages validateRequest="false">
  <controls>
    <add tagPrefix="cc1" src="~/Controls/MyUserControl1.ascx" tagName="MyUserControl1"/>
    ...    
    <add tagPrefix="cc1" src="~/Controls/MyUserControlN.ascx" tagName="MyUserControlN"/>
  </controls>
</pages> 
```

但有时我会忘记签入 web.config。实际上，我通常忘记它已更改跳过它，因为它经常破坏其他设置为连接到本地数据库副本的设置。

我想知道是否可以只指定整个 Controls 目录并自动注册那里的所有控件

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T00:35:40.830

是和不是。

基本上，您可以在 web.config 中注册所有用户控件。但是如果你想在其他用户控件中使用你的任何用户控件，你会遇到问题。

因此，如果您永远不会嵌套用户控件，那么您就可以开始了。但是如果你想灵活地嵌套用户控件，你有几个选择：

1.  将它们全部注册到 web.config 中，然后，在嵌套的情况下，将您要嵌套的控件直接注册到父用户控件中。
2.  正如 Bryan 上面提到的，将你的用户控件编译成一个程序集，并在 web.config 中引用它们。
3.  这是最糟糕的选择，但基本上您可以通过将控件放在子文件夹中来在 web.config 中注册所有用户控件时解决嵌套问题……这不是一个好选择。
4.  另一种选择是强类型化您的用户控件，可能通过为您的用户控件创建基类。

基本上这不是框架中的错误，而是将所有内容编译到单个程序集中的结果。该应用程序本质上无法区分用户控件。

[这里](http://forums.asp.net/p/1010350/1347796.aspx)和这里还有更多信息[。查看对此的评论](http://weblogs.asp.net/scottgu/archive/2006/11/26/tip-trick-how-to-register-user-controls-and-custom-controls-in-web-config.aspx#1056687)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T07:29:35.050

据我所知，这在 web.config 中是不可能的。有几种解决方法...一种是将您的控件放在一个单独的项目中，然后将它们编译成一个在 web.config 中引用的程序集。

就个人而言，我喜欢跳过 web.config 注册，只需在使用控件的任何页面中注册它们。这将避免破坏其他开发人员的 web.config 的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T15:29:33.710

从 Global.asax 生成您的 Web.Config：

```
protected void Application_Start(object sender, EventArgs e)
{

    Configuration config = WebConfigurationManager.OpenWebConfiguration("~/");
    PagesSection webSection = config.GetSection("system.web/pages") as PagesSection;

    List<TagPrefixInfo> toRemove = new List<TagPrefixInfo>();
    foreach (TagPrefixInfo info in webSection.Controls)
    {
        if (info.TagPrefix != "asp")
            toRemove.Add(info);
    }

    foreach (TagPrefixInfo list in toRemove)
    {
        webSection.Controls.Remove(list);
    }

    DirectoryInfo di = new DirectoryInfo(Server.MapPath("~/Controls"));
    foreach (FileInfo file in di.GetFiles("*.ascx"))
    {
        TagPrefixInfo newtag = new TagPrefixInfo("PREFIX", null, null, file.Name.Replace(".ascx",""), string.Concat("~/Controls/", file.Name));
        webSection.Controls.Add(newtag);

    }

    config.Save(ConfigurationSaveMode.Modified);
    ConfigurationManager.RefreshSection("system.web/pages");

} 
```

...您的所有条目都将出现在 web.config 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-14T20:49:12.263

这是@Jeff Fritz 解决方案的VB.NET 改编版本。它做同样的事情，但包括位于解决方案中任何位置的所有控件。（我们的架构使用可以作为 SVN 外部组件合并的模块，因此这提供了一种非常好的方法来确保主机应用程序了解所有模块的控件。）

```
 Sub RegisterUserControls()
        Dim Config As Configuration = WebConfigurationManager.OpenWebConfiguration("~/")
        Dim WebSection As PagesSection = TryCast(Config.GetSection("system.web/pages"), PagesSection)
        Dim ToRemove As List(Of TagPrefixInfo) = ( _
                From t As TagPrefixInfo In WebSection.Controls _
                Select t Where t.Source IsNot Nothing AndAlso t.Source.EndsWith(".ascx") _
            ).ToList
        For Each t As TagPrefixInfo In ToRemove
            WebSection.Controls.Remove(t)
        Next
        Dim SiteRoot As New DirectoryInfo(Server.MapPath("~"))
        For Each f As FileInfo In SiteRoot.GetFiles("*.ascx", SearchOption.AllDirectories)
            Dim Source As String = Path.Combine("~/", f.FullName.Replace(SiteRoot.FullName, "")).Replace("\", "/")
            Dim TagName As String = Path.GetFileNameWithoutExtension(f.Name)
            Dim NewTag As New TagPrefixInfo( _
                tagPrefix:="YOURPREFIX", _
                nameSpace:=Nothing, _
                assembly:=Nothing, _
                TagName:=TagName, _
                Source:=Source)
            WebSection.Controls.Add(NewTag)
        Next
        Config.Save(ConfigurationSaveMode.Modified)
        ConfigurationManager.RefreshSection("system.web/pages")
    End Sub 
```

（当然你会像 Jeff 那样在 Application_Start 中引用它。）

# algorithm - 寻找最佳组合的算法

> ID：680524
> 
> 赞同：12
> 
> 时间：2009-03-25T07:15:29.890
> 
> 标签：algorithm, math

假设我有一个包含 100 个产品的列表，每个产品都有一个价格。每一个也有一个能量 (kJ) 测量值。

使用编程是否有可能以低于 10 美元的价格找到 15 种产品的最佳组合，其中能量 (kJ) 的总和最大？

我知道 C#，但任何语言都可以。干杯。

**更新：**为背包问题找到一些示例源代码有点麻烦。有没有人有或知道在哪里可以找到一些。已经在谷歌上搜索了几个小时，如果可能的话，需要在明天之前对其进行排序。塔。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-25T07:17:25.237

[http://en.wikipedia.org/wiki/Knapsack_problem](http://en.wikipedia.org/wiki/Knapsack_problem)

> **背包问题**或**背包问题**是[组合优化](https://en.wikipedia.org/wiki/Combinatorial_optimization)中的一个问题：给定一组项目，每个项目都有一个重量和一个值，确定要包含在集合中的每个项目的数量，以便总重量小于或等于给定限制，并且总值尽可能大。它的名字来源于一个被固定大小的[背包](https://en.wikipedia.org/wiki/Knapsack)限制并且必须用最有价值的物品装满它的人所面临的问题......

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T07:23:56.093

这听起来更像是一个[线性规划](http://en.wikipedia.org/wiki/Linear_programming)问题。

> 非正式地，线性规划确定了在给定数学模型中实现最佳结果（例如最大利润或最低成本）的方式，并给定一些表示为线性方程的要求列表。

查看[单纯形法](http://en.wikipedia.org/wiki/Simplex_algorithm)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T12:40:05.600

这在整数线性规划中，优化受线性约束的线性方程，其中所有变量和系数都是整数。

您希望变量 includeItem1, ..., includeItemN 具有约束 0 ≤ includeItem *i* ≤ 1 对于 i 的所有值*，*并且 includeItem1 + ... + includeItemN ≤ 15，并且 includeItem1*priceItem1 + ... ≤ 10，最大化 includeItem1*kilojouleItem1 + ....

将其粘贴在您最喜欢的整数线性程序求解器中并获得解决方案:)

另见[http://en.wikipedia.org/wiki/Linear_programming](http://en.wikipedia.org/wiki/Linear_programming)

说您的特定问题是 NP 完全问题是没有意义的，但它是 NP 完全（某种）问题的一个实例，因此可能没有*理论上*的快速方法。根据您想要获得的最优性以及 ILP 求解器的工作速度，这在实践中可能是可行的。

我不认为你的问题是 ILP 的一个特例，这使得它特别容易解决。将其视为类似背包的问题，​​您可以限制自己查看 1..100 的所有子集，其中最多（或恰好）15 个元素，这是 n 中的多项式——它是 n-choose-15，它小于 (n^15)/(15!)，但是当 n = 100 时，这并不是非常有用。

如果你想要关于求解程序的建议，我尝试了 glpk 并发现它使用起来很愉快。如果您想要一些花钱的东西，我的讲师总是以 CPLEX 为例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T07:18:21.020

这听起来很像背包问题。有多种方法（例如，按能量密度降序排列）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T12:59:31.480

如果您可以选择产品，这就是背包问题。如果您可以选择产品的分数，那么您可以使用单纯形法解决这个问题，但分数背包问题有一个简单的解决方案。

按能源/价格比对物品进行排序，挑选 100% 最高的物品，直到你用完钱，然后从剩余的最高物品中挑选一个分数。

例如，如果价格为 4,3,5,4，能量为 3,5,2,7，则排序为

7/4、5/3、3/4、2/5

所以你会选择项目 4 和 2，这将花费 7 美元，剩下的 3 美元你会以 3 美元的价格和 3*.75 = 2.25 的能量购买第一个项目的 75%

这将给出 14.25 的总能量

请注意，与仅允许 0% 或 100% 相比，允许小数值会为您提供更高的目标值，因此没有整数解决方案会比 14.25（或 14 因为目标值必须是整数）做得更好。

要解决最初的背包问题，您可以使用分支定界，它在实践中应该可以正常工作。假设您有一个目标值为 z* 的当前候选解决方案

1.  解决允许分数权重的松弛问题。如果该值小于 z*，则丢弃该分支。
2.  计算一个新值 z 这是没有最后一个分数权重的解决方案，如果这个值大于 z* ，用你的新值替换 z*
3.  选择一个项目（比如列表中的第一个，最有利可图的一个）并形成两个子问题，一个**必须**将其包含在解决方案中，一个您**不能**将其包含在解决方案中（这是分支步骤）。
4.  只要您还有要解决的子问题，请选择一个并返回到第 1 步。

请注意，当您创建必须选择一个项目的子问题时，只需从预算中减去其价格并将该值添加到利润中，现在您需要解决一个较小的问题。

有关更详细的描述，请查看 Wikipedia 上的[Branch and Bound](http://en.wikipedia.org/wiki/Branch_and_bound)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T13:23:10.067

Stony Brook Algorithm Repository 列出[了背包问题的实现。](http://www.cs.sunysb.edu/~algorith/files/knapsack.shtml)

他们的书[The Algorithm Design Manual](https://rads.stackoverflow.com/amzn/click/com/1848000693)为大量问题提供了此类信息。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-27T18:17:06.850

是的，正如每个人都指出的那样，这是一个复杂的背包问题。这么简单的东西可能就足够了……

```
SELECT TOP 15 *
FROM Product
WHERE Price < 10
ORDER BY Energy DESC 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-25T07:20:10.173

这让我想起了著名的背包算法

> [http://en.wikipedia.org/wiki/Knapsack_problem](http://en.wikipedia.org/wiki/Knapsack_problem)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-27T18:01:26.063

[用Cream for Java](http://bach.istc.kobe-u.ac.jp/cream/)应该可以解决这个问题。还有一个可用的 C# 版本[CSharpCream](http://www2.cs.uregina.ca/~hmer200a/)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-07-16T05:41:20.927

在个人项目中做了类似的事情，但是在 php 代码中。如果你想移植到 c#，请随意。

此代码考虑了多个组合相同的可能性，因此返回值将是`x`最佳结果的数组。

注意：这是考虑到任何项目可以在每个结果中使用 0 或 1 次

```
<?php
$products = [
    ['id' => 1, 'price' => 3.00, 'energy' => 200],
    ['id' => 2, 'price' => 14.10, 'energy' => 3200],
    ['id' => 3, 'price' => 2.66, 'energy' => 300],
    ['id' => 4, 'price' => 5.00, 'energy' => 450],
    ['id' => 5, 'price' => 6.23, 'energy' => 667],
    ['id' => 6, 'price' => 7.00, 'energy' => 1200]
];

function genCombinations($values, $count = 0)
{

    // Figure out how many combinations are possible:

    $comboCount = pow(count($values) , $count);
    $r = [];

    // Iterate and add to array

    for ($i = 0; $i < $comboCount; $i++){
        $r[] = getCombination($values, $count, $i);
    }
    return $r;
}

// State-based way of generating combinations:

function getCombination($values, $count, $index)
{
    $result = [];
    for ($i = 0; $i < $count; $i++) {

        // Figure out where in the array to start from, given the external state and the internal loop state

        $pos = $index % count($values);

        // Append and continue

        $result[] = $values[$pos];
        $index = ($index - $pos) / count($values);
    }
    return $result;
}

//maximize energy for given price

function getBestProductCombinations($products,$price_limit){

    //find all combinations where each product is either selected or not - true or false

    $combos = genCombinations([true,false],count($products));

    $results = [];
    foreach($combos as $combo){

        //loop through each combination and get a result

        $sum_price = 0;$items = [];$sum_energy = 0;
        foreach($combo as $i => $o){

            //loop through the array of true/false values determining if an item is on or off

            if($o){

                //if on, add item to result

                $sum_price += $products[$i]['price'];
                $sum_energy += $products[$i]['energy'];
                $items[] = $products[$i];
            }
        }
        if($sum_price <= $price_limit){

            //if sum of result is within the price limit, add to the results array

            $results[] = [
                'items' => $items,
                'price' => $sum_price,
                'energy' => $sum_energy
            ];
        }
    }

    $best = $results[0];$ra = [$best];
    foreach($results as $k => $result){
        if($k === 0){continue;}//skip first iteration as it was set above

        //check if the energy is higher than the best, or if equal, check if the price is better

        if($result['energy'] > $best['energy'] || ($result['energy'] === $best['energy'] && $result['price'] < $best['price'])){

            //reset best to the current result, reset return array

            $best = $result;
            $ra = [$best];
        }else if($result['energy'] === $best['energy']){

            //current result is the same as best, add it to the return array

            $ra[] = $result;
        }
    }
    return $ra;
}

echo '<pre>'.json_encode(getBestProductCombinations($products,10),JSON_PRETTY_PRINT).'</pre>'; 
```

然后会给你：

```
[
    {
        "items": [
            {
                "id": 3,
                "price": 2.66,
                "energy": 300
            },
            {
                "id": 6,
                "price": 7,
                "energy": 1200
            }
        ],
        "price": 9.66,
        "energy": 1500
    }
] 
```

# iphone - 自定义 URL 处理程序中的变量大小是否有限制？

> ID：680525
> 
> 赞同：0
> 
> 时间：2009-03-25T07:15:53.150
> 
> 标签：iphone

我需要一种将一堆信息（1-10kb）从邮件应用程序中的电子邮件传输到我的 iPhone 应用程序的方法。

我在想我可以在电子邮件正文中制作一个自定义 URL，单击该 URL 时，将通过自定义 URL 处理程序将信息传输到我的应用程序。

但是，数据量很大。我可以在自定义 URL 处理程序中传递这么多数据吗？例如 myapp://load?var1=[lotsofdata]&var2=[lotsofdata]

或者，有没有更好的方法可以将信息从邮件应用程序传输到我的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T07:23:14.753

我不知道最大长度是多少，但我知道您可以在 Safari 中拥有非常长[的数据 url](http://en.wikipedia.org/wiki/Data_URI_scheme)，它可以让您将图像或其他文件数据存储在 url 本身中。如果限制相似，那么你很幸运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T08:36:57.697

为了安全起见，GET 的通常限制不应超过 2083 个字符。但它也应该是一种直接从您自己的应用程序中读取电子邮件的方法，但我对这个解决方案不是很熟悉。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T19:04:38.263

代替电子邮件中的链接，您可能只创建一个发布信息的表单，而不是向您的站点发送获取请求；这会绕过你的长度限制（如果有的话）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T19:10:53.257

最后一个答案假设您有一个可以放置数据的站点。如果您试图将内容纯粹保留在电子邮件中，那么将数据粘贴在邮件消息中会很好。无论如何，您都可以在电子邮件中嵌入图像，为什么不呢？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T19:36:24.833

在进行一些研究时，我发现了两篇博客文章，它们声称创建了有效的大型 URL，尽管一篇使用的是[data: URL 方案](http://blog.clawpaws.net/post/2007/07/16/Storing-iPhone-apps-locally-with-data-URLs)，另一篇使用的是[mailto:](http://www.benzado.com/blog/post/28/iphone-openurl-limit)。

您最好的选择可能只是尝试一下：使用带有大量数据的 myapp:// 创建一个链接，将其粘贴到电子邮件中，然后查看您的应用程序是否会读取整个内容。

# java - 你有像这个 url 网站 http://www.zhoyosoft.com 这样的 Flash 或 flex 或 jQuery 标题动画吗？

> ID：680539
> 
> 赞同：0
> 
> 时间：2009-03-25T07:26:05.697
> 
> 标签：java, jquery, flash, apache-flex

你有像这个 url 网站[http://www.zhoyosoft.com](http://www.zhoyosoft.com)这样的 Flash 或 flex 或 jQuery 标题动画吗？

是否可以在 jQuery 和 flex 中执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T01:51:43.543

这里有两个选项：

使用 jQuery，您可以使用： http: [//plugins.jquery.com/project/carousel3d](http://plugins.jquery.com/project/carousel3d)

在这种情况下，您需要使用“连续旋转”选项，或者您需要创建自己的事件队列并手动更改用于旋转轮播的角度（您必须深入研究代码并做一些数学虽然）：

```
jQuery（函数（$）{
3 $("#carousel").html($("#holder_images").html()).carousel3d({ control: 'continuous', speed: 1, centerX: $('#carousel').offset() .left + $('#carousel').width()/2 });
4});

```

在 flash 中，您可能可以使用[gotoandlearn.com](http://www.gotoandlearn.com/)上的“单击和缩放 3D 轮播”。 该网站上的文件应该会给您一个很好的开端。

# algorithm - 快速排序与合并排序

> ID：680541
> 
> 赞同：117
> 
> 时间：2009-03-25T07:26:23.450
> 
> 标签：algorithm, sorting

为什么快速排序可能比合并排序更好？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2009-03-25T07:32:31.657

请参阅[维基百科上的快速排序](http://en.wikipedia.org/wiki/Quicksort)：

> 通常，快速排序在实践中比其他 Θ(nlogn) 算法快得多，因为它的内部循环可以在大多数架构上有效地实现，并且在大多数实际数据中，可以做出最小化要求二次的概率的设计选择时间。

请注意，非常低的内存要求也是一大优势。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2010-04-08T07:35:47.830

当数据存储在内存中时，快速排序通常比合并排序快。但是，当数据集很大并且存储在硬盘等外部设备上时，就速度而言，归并排序显然是赢家。它最大限度地减少了对外部驱动器的昂贵读取，也非常适合并行计算。

* * *

## 回答 #3

> 赞同：63
> 
> 时间：2009-03-25T07:32:42.860

对于合并排序最坏的情况是`O(n*log(n))`，对于快速排序：`O(n`²`)`。对于其他情况（平均，最佳），两者都有`O(n*log(n))`. 然而，快速排序是空间常数，其中合并排序取决于您要排序的结构。

看到[这个比较](http://www.cprogramming.com/tutorial/computersciencetheory/sortcomp.html)。

您也可以[直观地](http://cg.scs.carleton.ca/~morin/misc/sortalg/)看到它。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-25T07:58:43.623

虽然快速排序通常是比归并排序更好的选择，但在某些情况下，归并排序肯定是一个更好的选择。最明显的时间是当你的算法运行得比 O(n^2) 快时非常重要。快速排序通常比这更快，但考虑到理论上可能的最差输入，它可能会在 O(n^2) 中运行，这比最差可能的合并排序还要糟糕。

快速排序也比归并排序更复杂，特别是如果您想编写一个真正可靠的实现，因此如果您的目标是简单性和可维护性，归并排序成为一种很有前途的替代方案，性能损失很小。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2010-02-14T08:41:39.313

我个人想自己测试快速排序和合并排序之间的区别，并查看了 1,000,000 个元素样本的运行时间。

[快速排序能够在 156 毫秒内完成，](http://tech.bragboy.com/2010/01/quick-sort-in-java.html)而 [合并排序则在 247 毫秒内完成](http://tech.bragboy.com/2010/01/merge-sort-in-java.html)

然而，快速排序数据是随机的，如果数据是随机的，则快速排序表现良好，而归并排序的情况并非如此，即归并排序执行相同的操作，无论数据是否已排序。但是合并排序需要一个完整的额外空间，而快速排序不像它的就地排序那样

我也为他们编写了全面的工作程序，并附有说明性图片。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-02-14T09:21:58.680

除其他外：合并排序对于链表等不可变数据结构非常有效，因此是（纯）函数式编程语言的不错选择。

实施不当的快速排序可能会带来[安全风险](https://stackoverflow.com/questions/1527136/is-quicksort-a-potential-security-risk)。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-07-03T14:11:15.250

快速排序就位。您只需要在分区功能期间交换数据位置。合并排序需要更多的数据复制。Merge 函数需要另一个临时存储空间（通常与原始数据数组大小相同）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-10-27T19:01:46.207

快速排序之所以这样命名是有原因的，

亮点：两者都是稳定的类型，（只是实现麻烦），所以让我们继续讨论复杂性

它与被溢出和“滥用”的大哦符号非常混淆，两者的平均案例复杂度均为 0(nlogn) ，

但是合并排序总是 0(nlogn) ，而对于坏分区的快速排序，即像 1 元素-10 元素这样的倾斜分区（这可能由于排序或反向排序列表而发生）可能导致 0(n^2)..

.. 所以我们有随机快速排序，我们随机选择枢轴并避免这种倾斜分区，从而使整个 n^2 场景无效，即使对于像 3-4 这样的适度倾斜分区，我们有一个 nlog(7/4)n ，理想情况下，我们想要 1-1 部分，因此 O(nlog(2)n) 的整个 2。

所以它是 O(nlogn) ，几乎总是并且与合并排序不同，隐藏在“big-oh”符号下的常量对于快速排序比合并排序更好......并且它不会像合并排序那样占用额外的空间。

但是要完美运行快速排序需要调整，改写，快速排序为您提供调整的机会....

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-04-03T14:33:25.370

答案将稍微倾向于快速排序，以适应 DualPivotQuickSort 为原始值带来的变化。它在**JAVA 7中用于在****java.util.Arrays 中**排序

 **```
It is proved that for the Dual-Pivot Quicksort the average number of
comparisons is 2*n*ln(n), the average number of swaps is 0.8*n*ln(n),
whereas classical Quicksort algorithm has 2*n*ln(n) and 1*n*ln(n)
respectively. Full mathematical proof see in attached proof.txt
and proof_add.txt files. Theoretical results are also confirmed
by experimental counting of the operations. 
```

您可以在此处找到 JAVA7 实现 - [http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/util/Arrays.java](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/util/Arrays.java)

DualPivotQuickSort 的进一步精彩阅读 - [http://permalink.gmane.org/gmane.comp.java.openjdk.core-libs.devel/2628](http://permalink.gmane.org/gmane.comp.java.openjdk.core-libs.devel/2628)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-04-30T06:53:06.943

快速排序更好是不正确的。另外，这取决于您的意思更好，内存消耗或速度。

在内存消耗方面，在最坏的情况下，但是快速排序可以使用 n^2 内存（即每个分区为 1 到 n-1），而归并排序使用 nlogn。

以上是关于速度的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-10-13T02:06:18.427

快速排序就位。您只需要很少的额外内存。这是极其重要的。

中值的良好选择使其效率更高，但中值隔离 Theta(nlogn) 的选择甚至是错误的。

# c# - 静态函数并发 ASP.NET

> ID：680546
> 
> 赞同：6
> 
> 时间：2009-03-25T07:28:31.543
> 
> 标签：c#, asp.net, concurrency, static

如果您有两个线程同时调用静态函数，是否存在并发风险？如果该函数使用类的静态成员，是否还有更大的问题？

*   这两个电话是分开的吗？（该功能就像为两个线程复制的一样？）
*   他们会自动排队吗？

例如在下一个示例中，是否存在风险？

```
private static int a = 5;

public static int Sum()
{
    int b = 4;
    a = 9;
    int c = a + b;
    return c;
} 
```

下一个例子，有风险吗？

```
public static int Sum2()
{
   int a = 5;
   int b = 4;
   int c = a + b;
   return c;
} 
```

**更新：**事实上，如果两个函数都在同一个类中，那么风险是什么？

谢谢，列文卡登

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-25T07:32:20.893

是的，在静态方法中修改静态变量时存在并发风险。

静态函数本身具有不同的局部变量集，但任何静态变量都是共享的。

在您的特定示例中，您没有被公开，但这只是因为您使用了常量（并为它们分配了相同的值）。稍微改变一下代码示例，你就会暴露出来。

**编辑：**

如果您从不同的线程*同时*调用Sum1() 和 Sum2() 就会遇到麻烦，则无法保证此语句中 a 和 b 的值： **int c = a + b;**

```
private static int a = 5;

public static int Sum1()
{
    int b = 4;
    a = 9;
    int c = a + b;
    return c;
}

public static int Sum2()
{
   int b = 4;
   int c = a + b;
   return c;
} 
```

您还可以通过多次调用*单个方法*来解决并发问题，如下所示：

```
public static int Sum3(int currentA)
{
   a = currentA;
   int b = 4;
   int c = a + b;
   int d = a * b; // a may have changed here
   return c + d;
} 
```

这里的问题是 a 的值可能会由于其他调用更改它而更改中间方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T07:38:13.080

是的，有风险。这就是为什么你会在 MSDN 文档中看到，它经常会说“这个类对于静态成员是线程安全的”（或类似的东西）。这意味着当 MS 编写代码时，他们有意使用同步原语来使静态成员线程安全。这在编写库和框架时很常见，因为使静态成员线程安全比实例成员更容易，因为您不知道库用户想要对实例做什么。如果他们使许多库类的实例成员成为线程安全的，他们会给你施加太多的限制......所以他们经常让你处理它。

因此，您同样需要使您的静态成员线程安全（或记录它们不是线程安全的）。

顺便说一句，静态**构造函数**在某种意义上是线程安全的。CLR 将确保它们只被调用一次，并防止 2 个线程进入静态构造函数。

编辑：马克在评论中指出了静态构造函数不是线程安全的边缘情况。如果您使用反射显式调用静态构造函数，显然您可以多次调用它。所以我修改语句如下：只要你依赖 CLR 来决定何时调用你的静态构造函数，那么 CLR 会阻止它被多次调用，它也会阻止静态 ctor 被调用重入。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T07:38:46.480

有关局部变量的讨论，请参见[此处](https://stackoverflow.com/questions/679448/679460#679460)。**在您进行编辑之前**，上述方法*本身*都不会带来并发风险；局部变量每次调用都是独立的；共享状态 ( `static int a`) 对多个线程可见，但您不会对其进行变异，并且您只读取一次。

如果你做了类似的事情：

```
if(a > 5) {
    Console.WriteLine(a + " is greater than 5");
} // could write "1 is greater than 5" 
```

它（理论上）*不安全*，因为 a 的值可以由另一个线程更改 - 您通常会同步访问（通过`lock`等），或者拍摄快照：

```
int tmp = a;
if(tmp > 5) {
   Console.WriteLine(tmp + " is greater than 5");
} 
```

如果您正在编辑该值，则几乎可以肯定需要同步。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T07:32:59.410

在您的两个示例中，没有线程安全问题，因为对函数的每次调用都会在堆栈上拥有自己的局部变量副本，并且在您的第一个示例中，“a”是静态变量，您永远不会更改“a” ，所以没有问题。

如果您在第一个示例中更改“a”中的值，您将遇到潜在的并发问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T07:33:21.827

如果变量的范围包含在静态函数中，则没有风险，但函数范围之外的变量（静态/共享）肯定会带来并发风险

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T07:55:25.050

OO 中的静态方法与过程编程中的“只是”函数没有区别。除非您将某些状态存储在静态变量中，否则根本没有风险。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T07:58:08.397

您将“ASP.NET”放在问题标题中，这篇博文很好地总结了在 ASP.NET 中使用 ThreadStatic 关键字时出现的问题：http: [//piers7.blogspot.com/2005/11/threadstatic-callcontext- and_02.html](http://piers7.blogspot.com/2005/11/threadstatic-callcontext-and_02.html)

# java - 显式归零

> ID：680550
> 
> 赞同：9
> 
> 时间：2009-03-25T07:30:28.120
> 
> 标签：java

在 java 中的什么情况下显式置空很有用。它是否以任何方式通过使对象无法访问或其他方式来帮助垃圾收集器？它被认为是一种好习惯吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-25T07:35:15.787

在 Java中，如果您有一个运行时间很长的方法，它*会有所帮助，并且对对象的唯一引用是通过局部变量。*当您不再需要该局部变量时（但当该方法将继续运行很长时间时）将该局部变量设置为 null*可以*帮助 GC。（在 C# 中，这很少有用，因为 GC 考虑了“最后可能的使用”。这种优化可能会在一段时间内应用到 Java - 我不知道。）

同样，如果您有一个引用对象的成员字段并且您不再需要它，则可以通过将该字段设置为 null 来帮助 GC。

然而，根据我的经验，做这些事情几乎没有什么*实际*用处，而且它使代码更加混乱。很少有方法*真正*运行很长时间，而将变量设置为 null 确实与您希望方法实现的目标无关。当您不需要时这样做不是一个好习惯，如果您*确实*需要，您应该首先查看重构是否可以改善您的设计。（您的方法或类型可能做得太多。）

请注意，将变量设置为 null 完全是被动的——它不会通知垃圾收集器该对象可以被收集，它只是避免垃圾收集器将该引用视为下次保持对象活动的原因（GC）运行。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-25T07:34:53.227

通常不需要它（当然这可能取决于 VM 实现）。但是，如果你有这样的事情：

```
private static final Map<String, String> foo; 
```

然后在地图中有您不再需要的项目，它们将不符合垃圾收集条件，因此您需要明确删除它们。有很多这样的情况（事件侦听器是另一个可能发生这种情况的领域）。

但是做这样的事情：

```
void foo()
{
    Object o;

    // use o

    o = null; // don't bother doing this, it isn't going to help
} 
```

编辑（忘了提这个）：

如果您使用它，您会发现您声明的 90-95% 的变量都可以设为 final。final 变量不能改变它指向的东西（或者它的原始值）。在大多数情况下，如果一个变量是 final 的，那么在方法执行时它接收到不同的值是一个错误（错误）。

如果您希望能够在使用后将变量设置为 null，则它不能是最终的，这意味着您有更大的机会在代码中创建错误。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-25T11:12:41.957

我发现它有用的一个特殊情况是当您有一个非常大的对象并想用另一个大对象替换它时。例如，看下面的代码：

```
BigObject bigObject = new BigObject();
// ...
bigObject = new BigObject(); // line 3 
```

如果 BigObject 的一个实例太大以至于堆中只能有一个这样的实例，第 3 行将失败并出现 OutOfMemoryError，因为第 3 行中的赋值指令完成之前无法释放第一个实例，这显然是在第 2 个实例之后准备好了。

现在，如果您在第 3 行之前将 bigObject 设置为 null：

```
bigObject = null;
bigObject = new BigObject(); // line 3 
```

当 JVM 在第二个实例的构建过程中用完堆时，可以释放第一个实例。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-25T07:48:07.347

来自“Effective Java”：用它来消除过时的对象引用。否则会导致内存泄漏，很难调试。

```
public Object pop(){
    if(size == 0)
        throw new EmptyStatckException();
    Object result = elements[--size];
    elements[size] = null; //Eliminate Object reference
    return result;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-25T07:41:59.780

如果您在方法块关闭时将一个即将超出范围的对象清空，那么在垃圾收集方面没有任何好处。遇到不理解这一点的人，他们非常努力地将很多东西不必要地设置为空，这并不罕见。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T07:43:05.283

另请参阅J2SE 中的[弱引用](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/ref/WeakReference.html)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-29T08:20:41.397

在以下所有情况都成立的极少数情况下，显式置零有助于 GC：

*   变量是对对象的唯一（非弱）引用
*   您可以*保证*不再需要该对象
*   该变量将*在范围内停留*很长一段时间（例如，它是长期对象实例中的一个字段）
*   编译器无法证明该对象不再被使用，但您可以通过您对代码的出色逻辑分析来保证这一点:-)

实际上，这在好的代码中是非常罕见的：*如果不再需要该对象，您通常应该在更窄的范围内声明它*。例如，如果您只在一次方法调用期间需要该对象，则它应该是一个局部变量，而不是封闭对象中的一个字段。

显式归零真正有用的一种情况是：如果使用 null 来指示特定状态，那么设置为 null 值有时是必要且有用的。Null 本身就是一个有用的值，原因如下：

*   空值检查非常快，因此检查空值的条件代码通常比许多替代方法更有效（例如调用 object.equals()）
*   如果您尝试取消引用它，您会立即收到 NullPointerException。这很有用，因为它是一种很好的[Fail Fast](http://en.wikipedia.org/wiki/Fail-fast)编码风格，可以帮助您捕获逻辑错误。

# sql-server - 表级备份

> ID：680552
> 
> 赞同：92
> 
> 时间：2009-03-25T07:31:25.747
> 
> 标签：sql-server, backup, database-table

如何在 MS SQL Server 2005/2008 中进行表级备份（转储）？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-03-25T09:27:08.857

您不能使用该`BACKUP DATABASE`命令来备份单个表，除非有问题的表当然是分配给它自己的`FILEGROUP`。

正如您所建议的，您可以做的是将表数据导出到 CSV 文件。现在，为了获得表的定义，您可以“编写`CREATE TABLE`脚本”。

您可以在 SQL Server Management Studio 中执行此操作，方法是：

> 右键单击数据库 > 任务 > 生成脚本

然后，您可以选择要编写脚本的表，还可以选择包含任何关联的对象，例如约束和索引。

为了`DATA`只使用`schema`，您必须`Advanced`在设置脚本选项选项卡上进行选择，然后在`GENERAL`设置部分中`Types of data to script`选择`Schema and Data`

希望这会有所帮助，但如果您需要进一步的帮助，请随时直接与我联系。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2010-11-16T19:13:33.967

我正在使用[批量复制实用程序](http://msdn.microsoft.com/en-us/library/ms162802.aspx)来实现表级备份

导出：

```
bcp.exe "select * from [MyDatabase].dbo.Customer " queryout "Customer.bcp" -N -S localhost -T -E 
```

导入：

```
bcp.exe [MyDatabase].dbo.Customer in "Customer.bcp" -N -S localhost -T -E -b 10000 
```

如您所见，您可以根据任何查询导出，因此您甚至可以使用它进行增量备份。此外，与此处提到的使用 SSMS 的其他方法不同，它是可编写脚本的。

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2011-09-16T13:19:33.617

以下是您需要的步骤。如果您想要数据，Step5 很重要。第 2 步是您可以选择单个表格的地方。

**EDIT**堆栈的版本不太可读......这是一张全尺寸图片[http://i.imgur.com/y6ZCL.jpg](https://i.imgur.com/y6ZCL.jpg)

![以下是约翰·桑索姆回答的步骤](https://i.stack.imgur.com/zlicl.jpg)

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2012-05-16T04:20:33.343

您可以运行以下查询来备份现有表，这将创建一个具有旧表的现有结构以及数据的新表。

```
select * into newtablename from oldtablename 
```

要仅复制表结构，请使用以下查询。

```
select * into newtablename from oldtablename where 1 = 2 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-05-05T17:58:40.567

这类似于[qntmfred 的解决方案](https://stackoverflow.com/questions/680552/table-level-backup#answer-4198009)，但使用的是直接表转储。此选项稍微快一些（请参阅[BCP 文档](http://technet.microsoft.com/en-us/library/ms162802.aspx)）：

**导出：**

```
bcp "[MyDatabase].dbo.Customer " out "Customer.bcp" -N -S localhost -T -E 
```

**导入：**

```
bcp [MyDatabase].dbo.Customer in "Customer.bcp" -N -S localhost -T -E -b 10000 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-09T21:53:42.697

如果您正在寻找类似 MySQL 的东西`DUMP`，那么好消息：SQL Server 2008 Management Studio 添加了该功能。

在 SSMS 中，只需右键单击相关数据库并选择*Tasks > Generate Scripts*。然后在选项向导的第 2 页中，确保[选择您也想要脚本化的*数据*](http://updates.sqlservervideos.com/2009/01/wheres-that-been-all-my-life.html)，它会为您生成相当于`DUMP`文件的内容。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-26T13:07:10.190

新建文件组，把这个表放在上面，只备份这个文件组。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-10-01T11:39:22.247

我不知道，它是否会匹配这里描述的问题。我不得不进行表的增量备份！（只应复制新插入的数据）。我以前设计了一个DTS包在哪里。

1.  我获取新记录（基于“状态”列）并将数据传输到目的地。（通过“转换数据任务”）

2.  然后我刚刚更新了“状态”列。（通过“执行 SQL 任务”）

我必须正确修复“工作流程”。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-25T09:26:39.527

您可以使用 Microsoft 的免费[数据库发布向导](http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en)生成带有 SQL 脚本（CREATE TABLE 和 INSERT INTO）的文本文件。

您可以为单个表创建这样的文件，并且可以通过简单地运行 SQL 脚本来“恢复”包括数据的完整表。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-02-03T13:18:34.200

使用 SQL Server 导入和导出向导。

1.  短信
2.  打开数据库引擎
3.  替代。单击要导出的包含表的数据库
4.  选择“任务”
5.  选择“导出数据...”
6.  跟随向导

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-25T07:35:01.247

> 每个恢复模型都允许您备份整个或部分 SQL Server 数据库或数据库的单个文件或文件组。**无法创建表级备份**。

来自：[备份概述 (SQL Server)](http://technet.microsoft.com/en-us/library/ms175477.aspx)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-05-02T00:26:00.440

一个名为 SqlTableZip 的免费应用程序将完成这项工作。基本上，您编写*任何*查询（当然也可以是 [select * from table]），然后应用程序会创建一个包含所有数据的压缩文件，以后可以恢复该文件。

链接： http: [//www.doccolabs.com/products_sqltablezip.html](http://www.doccolabs.com/products_sqltablezip.html)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-25T08:10:02.287

您可能有两种选择，因为 SQL Server 不支持表备份。两者都将从编写表创建脚本开始。然后，您可以使用 Script Table - INSERT 选项，该选项将生成大量插入语句，或者您可以使用集成服务（带有 2000 的 DTS）或类似服务将数据导出为 CSV 或类似文件。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-09T22:02:14.237

BMC 恢复管理器（以前称为 SQLBacktrack）允许对数据库中的单个对象（也称为表）进行时间点恢复。它并不便宜，但做得很好： [http ://www.bmc.com/products/proddocview/0,2832,19052_19429_70025639_147752,00.html](http://www.bmc.com/products/proddocview/0,2832,19052_19429_70025639_147752,00.html)

[http://www.bmc.com/products/proddocview/0,2832,19052_19429_67883151_147636,00.html](http://www.bmc.com/products/proddocview/0,2832,19052_19429_67883151_147636,00.html)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-09-12T07:33:21.787

如果您希望能够在有人错误地从中删除行后恢复表，您可以查看数据库快照。您可以很容易地从快照中恢复表（或行的子集）。请参阅[http://msdn.microsoft.com/en-us/library/ms175158.aspx](http://msdn.microsoft.com/en-us/library/ms175158.aspx)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-03-02T09:59:47.213

Handy Backup 自动从 MS SQL Server 生成转储文件，包括 MSSQL 2005/2008。这些转储是表级二进制文件，包含特定数据库内容的精确副本。

要使用 Handy Backup 进行简单转储，请按照以下说明进行操作：

1.  安装 Handy Backup 并创建一个新的备份任务。
2.  在第 2 步中选择“MSSQL”作为数据源。在新窗口中，标记要备份的数据库。
3.  在您将存储备份的不同目的地中进行选择。
4.  在第 4 步中，选择“完整”备份选项。如果需要，请设置时间戳。
5.  除非您需要压缩或加密生成的转储文件，否则请跳过第 5 步。
6.  在第 6 步中，为任务设置计划以定期创建转储（否则手动运行任务）。
7.  同样，跳过第 7 步，并在第 8 步中为您的任务命名。您已完成任务！

现在通过单击其名称前的图标来运行您的新任务，或等待预定时间。Handy Backup 将自动为您的数据库创建转储。然后打开您的备份目的地。您将找到一个文件夹（或几个文件夹），其中包含您的 MS SQL 备份。任何此类文件夹都将包含一个表级转储文件，其中包含一些二进制表和压缩到单个 ZIP 中的设置。

## 其他数据库

Handy Backup 可以为 MySQL、MariaDB、PostgreSQL、Oracle、IBM DB2、Lotus Notes 和任何具有 ODBC 驱动程序的通用 SQL 数据库保存转储。其中一些数据库需要额外的步骤来建立 DBMS 和 Handy Backup 之间的连接。

上述工具通常将 SQL 数据库转储为表级 SQL 命令序列，使这些文件为您需要的任何手动修改做好准备。

# c++ - 关于“构建库”的初学者问题，特别是在 iPhone 上的 Xcode

> ID：680561
> 
> 赞同：4
> 
> 时间：2009-03-25T07:32:34.450
> 
> 标签：c++, iphone, xcode, linker

我从来没有清楚地了解所有这些链接/构建/依赖业务。现在，我正在尝试将 FreeType 库（在 C++ 中）构建到 iPhone 的 *.a 库文件中（因为我尝试使用的另一个库 openFrameworks 将依赖于 FreeType）。

我知道要使用 iPhone 编译 C++，我只需将 *.cpp 重命名为 *.mm。（我在 main() 中尝试过一些简单的程序并且它可以工作）**但是我怎样才能在 Xcode 中构建库**呢？（没有 main() 我想）

另一方面，如果你们能推荐一些关于此类链接/构建主题的书籍或文档，那就太好了，我发现自己最困惑。

PS。我已经获得了 Xcode 的付费版本和一些编译到 iPhone 上的示例应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-28T23:05:54.107

将 .cpp 文件重命名为 .mm 意味着它们将被视为 Objective-C++ 代码而不是 C++ 代码。我认为这不是一个好主意，即使它仍然可以工作。此外，FreeType 是用 C 编写的，而不是 C++。

谷歌搜索“编译器链接器”，你会发现很多关于它们如何工作的文档。这应该有助于文档。

完全可以为 iPhone 编译静态库；你不能做的是编译动态库或框架——你可以，但不鼓励这样做。

1.  打开你的项目
2.  在源/目标浏览器中，选择“目标”节点（带有红色和白色的小目标图标）。
3.  右键单击节点，在弹出菜单中选择“添加”，然后选择“新建目标”。
4.  将打开一个对话框。在左侧，有一个 iPhone OS 和一个 Mac OS X 部分。iPhone OS 部分应该已经被选中；如果不这样做。
5.  您应该有三个目标选择，其中之一是静态库。选择它，单击确定。
6.  在下一页中为库命名。点击完成。
7.  您的“目标”节点现在包含一个用于您的静态库的子节点。您可以通过文件菜单添加源，也可以将其拖到“编译源”子节点上。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T18:45:48.093

首先，您无需重命名任何文件即可为 iPhone 编译 C++ 代码。其次，您需要为库创建一个单独的项目。看起来 iPhone 目标类型不包含“静态库”，因此您可能需要创建一个 Mac OS X 项目并对其进行修改以输出 ARM .a 文件。不是微不足道的，但可能是可行的。

或者，如果您不打算在很多其他不相关的项目中使用此代码，您可以将源文件直接包含到您的 App 项目中。将它们全部收集到自己的组中，您几乎不会知道它们在那里。

# javascript - Javascript 可以读取任何网页的源代码吗？

> ID：680562
> 
> 赞同：82
> 
> 时间：2009-03-25T07:32:35.760
> 
> 标签：javascript, html

我正在进行屏幕抓取，并希望检索特定页面的源代码。

如何用javascript实现这一点？请帮我。

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-03-25T08:09:08.060

简单的开始方式，试试[jQuery](http://jquery.com/)

```
$("#links").load("/Main_Page #jq-p-Getting-Started li"); 
```

更多[jQuery 文档](https://api.jquery.com/load/)

另一种以更加结构化的方式进行屏幕抓取的方法是使用[YQL 或 Yahoo Query Language。](http://developer.yahoo.com/yql/console/)它将返回结构化为 JSON 或 xml 的抓取数据。
*例如*
，让我们刮一下 stackoverflow.com

```
select * from html where url="http://stackoverflow.com" 
```

会给你一个像这样的 JSON 数组（我选择了那个选项）

```
 "results": {
   "body": {
    "noscript": [
     {
      "div": {
       "id": "noscript-padding"
      }
     },
     {
      "div": {
       "id": "noscript-warning",
       "p": "Stack Overflow works best with JavaScript enabled"
      }
     }
    ],
    "div": [
     {
      "id": "notify-container"
     },
     {
      "div": [
       {
        "id": "header",
        "div": [
         {
          "id": "hlogo",
          "a": {
           "href": "/",
           "img": {
            "alt": "logo homepage",
            "height": "70",
            "src": "http://i.stackoverflow.com/Content/Img/stackoverflow-logo-250.png",
            "width": "250"
           }
…….. 
```

这样做的美妙之处在于，您可以进行***预测和 where***子句，最终使您获得结构化的抓取数据，并且*只有*您需要的数据（最终通过网络传输的带宽要少得多），
*例如*

```
select * from html where url="http://stackoverflow.com" and
      xpath='//div/h3/a' 
```

会得到你

```
 "results": {
   "a": [
    {
     "href": "/questions/414690/iphone-simulator-port-for-windows-closed",
     "title": "Duplicate: Is any Windows simulator available to test iPhone application? as a hobbyist who cannot afford a mac, i set up a toolchain kit locally on cygwin to compile objecti … ",
     "content": "iphone\n                simulator port for windows [closed]"
    },
    {
     "href": "/questions/680867/how-to-redirect-the-web-page-in-flex-application",
     "title": "I have a button control ....i need another web page to be redirected while clicking that button .... how to do that ? Thanks ",
     "content": "How\n                to redirect the web page in flex application ?"
    },
….. 
```

现在只得到我们做的问题

```
select title from html where url="http://stackoverflow.com" and
      xpath='//div/h3/a' 
```

注意投影中的*标题*

```
 "results": {
   "a": [
    {
     "title": "I don't want the function to be entered simultaneously by multiple threads, neither do I want it to be entered again when it has not returned yet. Is there any approach to achieve … "
    },
    {
     "title": "I'm certain I'm doing something really obviously stupid, but I've been trying to figure it out for a few hours now and nothing is jumping out at me. I'm using a ModelForm so I can … "
    },
    {
     "title": "when i am going through my project in IE only its showing errors A runtime error has occurred Do you wish to debug? Line 768 Error:Expected')' Is this is regarding any script er … "
    },
    {
     "title": "I have a java batch file consisting of 4 execution steps written for analyzing any Java application. In one of the steps, I'm adding few libs in classpath that are needed for my co … "
    },
    {
…… 
```

编写查询后，它会为您生成一个 url

[http://query.yahooapis.com/v1/public/yql?q=select%20title%20from%20html%20where%20url%3D%22http%3A%2F%2Fstackoverflow.com%22%20and%0A%20% 20%20%20%20%20xpath%3D'%2F%2Fdiv%2Fh3%2Fa'%0A%20%20%20%20&format=json&callback=cbfunc](http://query.yahooapis.com/v1/public/yql?q=select%20title%20from%20html%20where%20url%3D%22http%3A%2F%2Fstackoverflow.com%22%20and%0A%20%20%20%20%20%20xpath%3D'%2F%2Fdiv%2Fh3%2Fa'%0A%20%20%20%20&format=json&callback=cbfunc)

在我们的例子中。

所以最终你最终会做这样的事情

```
var titleList = $.getJSON(theAboveUrl); 
```

和它一起玩。

***漂亮***，不是吗？

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-25T08:06:08.877

可以使用 Javascript，只要您通过域上的代理获取您所追求的任何页面：

```
<html>
<head>
<script src="/js/jquery-1.3.2.js"></script>
</head>
<body>
<script>
$.get("www.mydomain.com/?url=www.google.com", function(response) { 
    alert(response) 
});
</script>
</body> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-25T07:40:46.553

您可以简单地使用(AJAX) 来点击所需的 URL，并且来自 URL 的 HTML 响应将在属性`XmlHttp`中可用。`responseText`如果不是同一个域，您的用户将收到一条浏览器警报，提示“此页面正在尝试访问不同的域。您要允许这样做吗？”

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-11-20T01:40:11.817

您可以使用[fetch](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)：

```
const URL = 'https://www.sap.com/belgique/index.html';
fetch(URL)
.then(res => res.text())
.then(text => {
    console.log(text);
})
.catch(err => console.log(err));
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-25T07:37:25.687

作为一种安全措施，Javascript 无法读取来自不同域的文件。尽管可能有一些奇怪的解决方法，但我会考虑使用不同的语言来完成这项任务。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-25T07:39:20.580

如果您绝对需要使用 javascript，则可以使用 ajax 请求加载页面源。

请注意，使用 javascript，您只能检索与请求页面位于同一域下的页面。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-25T07:49:44.020

使用 jQuery

```
<html>
<head>
<script src="http://jqueryjs.googlecode.com/files/jquery-1.3.2.js" ></script>
</head>
<body>
<script>
$.get("www.google.com", function(response) { alert(response) });
</script>
</body> 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-08-21T00:52:34.373

我使用[了 ImportIO](https://www.import.io/)。如果您在他们那里设置了一个帐户（这是免费的），他们允许您从任何网站请求 HTML。他们让您每年最多可以提出 5 万个请求。我没有花时间去寻找替代方案，但我敢肯定有一些。

在您的 Javascript 中，您基本上只需发出这样的 GET 请求：

```
var request = new XMLHttpRequest();

request.onreadystatechange = function() {
  jsontext = request.responseText;

  alert(jsontext);
}

request.open("GET", "https://extraction.import.io/query/extractor/THE_PUBLIC_LINK_THEY_GIVE_YOU?_apikey=YOUR_KEY&url=YOUR_URL", true);

request.send();
```

旁注：我在研究我觉得是同一个问题时发现了这个问题，所以其他人可能会觉得我的解决方案很有帮助。

更新：我创建了一个新的，他们只允许我使用不到 48 小时，然后他们说我必须为服务付费。如果您不付款，他们现在似乎很快就关闭了您的项目。我使用 NodeJS 和一个名为 NightmareJS 的库创建了自己的类似服务。[您可以在此处](https://hackernoon.com/nightmarishly-good-scraping-with-nightmare-js-and-async-await-b7b20a38438f)查看他们的教程并创建自己的网络抓取工具。这相对容易。我没有尝试将其设置为我可以向其发出请求或任何东西的 API。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-10-26T20:58:22.587

您可以通过创建浏览器扩展甚至在 Windows（HTML 应用程序）中将文件另存为 .hta 来绕过同源策略。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-06-22T16:34:44.747

您可以生成 XmlHttpRequest 并请求页面，然后使用 getResponseText() 获取内容。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-10-26T20:14:00.837

您可以使用[FileReader API](https://developer.mozilla.org/en-US/docs/Web/API/FileReader)获取文件，并在选择文件时，将您网页的 url 放入选择框中。使用此代码：

```
function readFile() {
    var f = document.getElementById("yourfileinput").files[0]; 
    if (f) {
      var r = new FileReader();
      r.onload = function(e) { 
        alert(r.result);
      }
      r.readAsText(f);
    } else { 
      alert("file could not be found")
    }
  }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-03-06T13:29:30.413

尽管有很多相反的评论，但我相信使用简单的 JavaScript 可以克服同源要求。

我并不是说以下内容是原创的，因为我相信我不久前在其他地方看到过类似的东西。

我只在 Mac 上使用 Safari 进行了测试。

下面的演示在 base 标记中获取页面并将其 innerHTML 移动到新窗口。我的脚本添加了 html 标签，但对于大多数现代浏览器，这可以通过使用 outerHTML 来避免。

```
<html>
<head>
<base href='http://apod.nasa.gov/apod/'>
<title>test</title>
<style>
body { margin: 0 }
textarea { outline: none; padding: 2em; width: 100%; height: 100% }
</style>
</head>
<body onload="w=window.open('#'); x=document.getElementById('t'); a='<html>\n'; b='\n</html>'; setTimeout('x.innerHTML=a+w.document.documentElement.innerHTML+b; w.close()',2000)">
<textarea id=t></textarea>
</body>
</html> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-07-31T05:13:27.520

```
<script>
    $.getJSON('http://www.whateverorigin.org/get?url=' + encodeURIComponent('hhttps://example.com/') + '&callback=?', function (data) {
        alert(data.contents);
    });

</script> 
```

包含 jQuery 并使用此代码获取其他网站的 HTML。**将 example.com 替换为您的网站**。

*此方法涉及外部服务器获取站点 HTML 并将其发送给您。:)*

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-11-20T21:27:18.060

```
javascript:alert("Inspect Element On");
javascript:document.body.contentEditable = 'true';
document.designMode='on'; 
void 0;
javascript:alert(document.documentElement.innerHTML); 
```

突出显示它并将其拖到您的书签栏并在您想要编辑和查看当前站点源代码时单击它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-12-21T11:47:55.307

在 Linux 上

1.  下载 slimerjs (slimerjs.org)

2.  下载火狐59版

3.  添加此环境变量：export SLIMERJSLAUNCHER=/home/en/Letöltések/firefox59/firefox/firefox

4.  在 slimerjs 下载页面上使用这个 .js 程序（./slomerjs program.js）：

    ```
     var page = require('webpage').create();
     page.open(
      'http://www.google.com/search?q=görény',
       function() 
       {
         page.render('goo2.pdf');
         phantom.exit();
       }
     ); 
    ```

使用 pdftotext 获取页面上的文本。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-06-11T12:47:15.063

jquery 不是做事的方式。用纯 JavaScript 做

```
var r = new XMLHttpRequest();
    r.open('GET', 'yahoo.comm', false);
    r.send(null); 
if (r.status == 200) { alert(r.responseText); } 
```

# flash - 使用 TweenMax 动画 onRollover onRollout

> ID：680567
> 
> 赞同：1
> 
> 时间：2009-03-25T07:33:41.327
> 
> 标签：flash, actionscript, actionscript-2, rollover

我正在使用 TweenMax 为一些箭头设置动画，以便在我滚动链接时移动，并在我推出时动画返回。但它不起作用，它在翻转时动画，但不是推出。

```
function boxLink(mc_function:MovieClip, mc_target:MovieClip) {
mc_function.onRollOver = function() {
    var myTween:TweenMax = new TweenMax(mc_target,0.5,{_x:"2", _alpha:50, ease:Back.easeOut});
};
mc_function.onRollOut = function() {
    myTween.reverse();
};
}

boxLink(link_a1,arrow_a1); 
```

我究竟做错了什么？

有没有更好的方法来编写这段代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T21:39:08.263

范围界定。当 onRollOut 被触发时，myTween 变量不存在，因为它是在 onRollOver 中声明的，因此只存在于 onRollOver 范围内。在 mc_function 范围内创建 myTween 变量，以便它在 onRollOver 和 onRollOut 中都可用。

```
function boxLink(mc_function:MovieClip, mc_target:MovieClip) {
mc_function.onRollOver = function() {
        this.myTween = new TweenMax(mc_target,0.5,{_x:"2", _alpha:50, ease:Back.easeOut});
};
mc_function.onRollOut = function() {
        this.myTween.reverse();
};
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T22:19:33.413

Luke 是绝对正确的，您使用“var”关键字创建了一个“LOCAL VARIABLE”，它的范围是它在其中创建的函数的范围；一旦该功能运行，它就不再可用。我与 Luke 的不同之处在于我会在顶部创建你的变量（编译器无论如何都会将变量移动到顶部），如果你正在开发 OOP，你在类范围内创建它，否则将它贴在你的动作框架的顶部附近，在任何功能之外。您不必在那里给它一个值，只需声明它并对其进行数据类型化。

```
var myTween:TweenMax; //Can be access from anywhere within "this" scope.
mc_function.onRollOver = function()
{
    myTween = new TweenMax(mc_target,0.5,{_x:"2", _alpha:50,  ease:Back.easeOut});
};
mc_function.onRollOut = function()
{
    myTween.reverse();
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T10:34:29.037

您确定`onRollOut`执行时变量`myTween`仍然存在吗？因为`var`在函数中定义的变量理论上应该只存在于定义它的函数内部。所以我的猜测是你正在调用一个不再存在的变量。

尝试在`trace(myTween);`之前添加一个`myTween.reverse();`. 如果它打印`undefined`，那是你的问题，你应该`myTween.reverse();`用相反的转换替换，但写成`var myTween:TweenMax = new TweenMax(*);`

# mysql - 由于扩展插入导致 MySQL 导入数据库错误

> ID：680571
> 
> 赞同：16
> 
> 时间：2009-03-25T07:35:33.633
> 
> 标签：mysql, mysqldump

我正在导入一个 400MB（未压缩）的 MySQL 数据库。我正在使用 BIGDUMP，我收到此错误：

```
Stopped at the line 387.

At this place the current query includes more than 300 dump lines. That can happen if your dump file was created by some tool which doesn't place a semicolon followed by a linebreak at the end of each query, or if your dump contains extended inserts. Please read the BigDump FAQs for more infos. 
```

我相信该文件确实包含扩展插入，但是我无法重新生成数据库，因为它已从旧服务器中删除。如何导入此数据库或将其转换为导入？

谢谢你的帮助。

最好的尼克

**编辑：** 似乎唯一可行的答案是分离扩展插入，但我仍然需要帮助弄清楚如何拆分文件，如下面的答案所示。请帮忙。谢谢你。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-09T02:22:34.290

您无需对 .sql 文件进行任何更改：只需在任何文本编辑器中打开 bigdump.php，找到该行

```
define ('MAX_QUERY_LINES',300); 
```

并将 300 替换为您想要的任何内容。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-25T07:41:24.803

只需编辑转储文件，以便在 300 次插入后开始一条新语句：

```
INSERT INTO `myTable` (`id`, `field1`, `field2`) VALUES
    (1, 'a', 'b'),
    (2, 'c', 'd'),
    (3, 'e', 'f'),
    -- snip --
    (300, 'w', 'x');
INSERT INTO `myTable` (`id`, `field1`, `field2`) VALUES
    (301, 'y', 'z'),
    (302, ... etc 
```

您可以通过`<backup>.sql`在任何文本编辑器中打开文件来执行此操作，它只是纯文本。有时备份可能是一个`.gz`或`.bz`文件，但它们只是 zip：如果您解压缩这些 gzip 或 bzip 文件，您最终会得到一个`.sql`可以轻松编辑的文件。

编写一个脚本在任意行数之后拆分每个语句可能不会太难。基本的程序逻辑可能如下所示：

1.  找到以“INSERT”开头的行。
2.  复制该行直到单词“VALUES”的末尾
3.  逐步完成以下所有行，边走边数。
4.  如果您的计数器达到 300，则在最后一行的末尾添加一个分号并粘贴之前的“INSERT ... VALUES”语句。将您的计数器重置为 1，然后转到第 3 步。
5.  如果到达以“INSERT”开头的行，请将计数器重置为 1 并转到步骤 2。

不过，您可以手动执行此操作，然后确保所有未来的备份不使用扩展插入。此外，phpMyAdmin 允许您在创建导出时设置最大语句大小，因此它基本上会为您完成上述操作。

不过，您对内存限制所做的可能是一个更简单的解决方案。对于处于类似情况且无法更改这些限制的其他任何人，请尝试上述方法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-12-14T09:15:39.220

对我来说，它的工作原理如下：

搜索

```
$max_query_lines = 300; 
```

然后简单地替换为

```
$max_query_lines = 3000; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-25T09:20:59.400

在增加内存缓冲区并通过 SSH 进行普通 mysql 导入后，我能够成功导入数据库。

我将以下命令与绝对路径一起使用：

```
mysql -u <username> -p < /home/dir/dumpfile.sql 
```

最好的尼克

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-30T07:36:34.563

感谢“max_query_lines”和“INSERT”解决方案！

“两种解决方案都有一些缺点。如果没有扩展插入，输出转储将比使用扩展插入的转储大很多倍。增加 max_query_lines 将增加 bigdump 脚本的内存使用量，并且您的服务器可能会耗尽内存。”

来源：[http ://www.etctips.com/error-at-this-place-the-current-query-includes-more-than-xxx-dump-lines/](http://www.etctips.com/error-at-this-place-the-current-query-includes-more-than-xxx-dump-lines/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-02-15T16:08:46.710

打开`bigdump.php`并更改以下行：

```
$max_query_lines = 300; 
```

对此：

```
$max_query_lines = 300000; 
```

# java - 日志记录复杂性和对 MessageFormat 性能的关注

> ID：680582
> 
> 赞同：2
> 
> 时间：2009-03-25T07:40:14.837
> 
> 标签：java, performance, logging

我的应用程序使用 log4j 进行日志记录，通常我通过检查是否启用了特定级别来进行日志记录，然后像下面这样记录

```
if(Logger.isApplicationDebugEnabled()){
   Logger.logApplicationDebug("something"+values);  
 } 
```

现在这个 if 检查减少了我们在 jUnit 测试期间的分支覆盖率。为了克服这个问题，我的朋友建议去掉“if”检查日志。

1.  我的第一个朋友建议删除 if 检查并直接记录。这种方法的问题在于，它可能会因为形成无论如何都不会出现在日志文件中的字符串而减慢应用程序的速度。
2.  我想到的第二种方法与 SLF4j 非常相似。

    Logger.debug("编号 {0}，日期为 {1,date}",1234, new Date());

这感觉非常有吸引力和简单。（此解决方案内部使用 MessageFormat.format(str, object[]) 方法。但我担心这可能具有的性能。另请注意，'Logger' 是我的内部实用程序类，并且在每个它的日志方法，有一个日志启用检查。你们有什么建议？我浏览了速度模板，但它需要参数映射。是否有任何轻量级的解决方案，它只是根据参数索引位置替换值，或者这个解决方案可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T07:49:50.900

好的，我会问一个显而易见的问题：为什么不只启用调试日志记录——或者真的是所有级别——在运行你的单元测试时？这样做的好处是增加了代码覆盖测试和测试日志中的问题（这远非不可能）。

检查是否启用了日志记录是有原因的：不仅构建最终的日志字符串可能很昂贵（在大循环内），而且构建单个参数本身可能很昂贵。使用 MessageFormat 或 java.util.Formatter 或任何不会摆脱第二个问题的方法。我真的鼓励你保留支票。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T09:24:35.133

我实际上已经按照您对一个项目的建议进行了操作，并且我对这种方法有积极的经验。我在 commons-logging 之上创建了一个附加层，允许在底层进行消息格式化`MessageFormat`。

这些是我在测量与您描述的几乎相同的使用模式后获得的结果，10000 次调用如下：

```
    对于 (int i = 0; i < 10000; i ++) {
        log.debug("示例消息：来自 {1} 的 {0} 在 {2}！", i, "test", new Date());
    }

```

1.  登录：commons-logging=664ms, Slf4j=559ms, MyLog=3134ms
2.  注销：commons-logging=6ms, Slf4j=7ms, MyLog=7ms

显然，“MyLog”在调试输出打开的情况下要慢得多，但在调试输出关闭时与它们相当。为了清楚起见，在“MyLog”中，我`isDebugEnabled()`在实际格式化消息之前明确检查。

但是，生成的日志代码现在更加清晰，我们整个团队最终生成了更有用和更详细的消息。在此之前，使用单独的方法来构造更长的记录器消息并不少见。

鉴于关闭日志记录时几乎没有额外的性能影响，我可以看到自己在未来使用这种技术。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T11:44:48.290

我强烈推荐 log4j 的 slf4j 外观，它允许您使用这种语法

log.info("Hello {} from {}", "World", "me")

仅在确定应该实际记录事件后才进行字符串扩展，因此您不必指定 ifEnabled 包装器。然后使用 log4j 作为 slf4j 的后端。

此外，这比 MessageFormatter 快得多*。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T07:47:50.280

唯一知道的方法是测量。关于性能的猜测几乎总是错误的:)

就我个人而言，我可能会坚持使用你原来的 log4j 代码——不要太在意覆盖范围。防止对始终遵循的代码路径进行过多的日志调用是合理的 - 但我不会为诸如错误条件之类的事情而烦恼，因为您已经处于奇怪且希望很少见的情况。在其中，编写最易读的代码，然后确保您的应用程序按照您的需要执行。*如果*没有，请对其进行分析以找出问题所在。*如果*它在日志记录代码中，请对其进行优化。

# apache-flex - 在flex中提取zip文件

> ID：680593
> 
> 赞同：1
> 
> 时间：2009-03-25T07:48:28.907
> 
> 标签：apache-flex

是否有任何方法可以提取 zip 文件并在输出文件夹中维护相同的文件夹结构。我能够提取 zip 文件及其内部文件，但无法从 zip 文件中提取文件夹，因此也无法维护文件夹结构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T10:19:42.553

是的。

有一个 AS3 组件允许您从 zip 文件中读取和写入数据，并且演示还显示可以查看文件夹结构。

[http://www.nochump.com/blog/?p=15](http://www.nochump.com/blog/?p=15)

我自己没有使用过这个组件，但是如果我假设你正在制作一个 AIR 应用程序是正确的，那么这个组件可能会自动生成文件夹，否则你可以使用文件系统 api 自己创建正确的文件夹。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-07T00:40:46.370

您可能还想查看 fzip：

[http://codeazur.com.br/lab/fzip/](http://codeazur.com.br/lab/fzip/)

# javascript - 如何在 Internet Explorer 7 中获得缩放级别？(javascript)

> ID：680596
> 
> 赞同：13
> 
> 时间：2009-03-25T07:51:11.270
> 
> 标签：javascript, internet-explorer-7

在 Internet Explorer 7 中，某些属性（鼠标坐标）被视为物理属性，而其他属性则是逻辑属性（偏移）。这实质上要求 Web 开发人员了解或计算缩放状态。在 IE8 版本中，所有属性都是合乎逻辑的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-25T08:59:33.710

您可以使用以下方法获取它：

```
var b = document.body.getBoundingClientRect();    
alert((b.right - b.left)/document.body.clientWidth); 
```

非常感谢[@niclasnorgren](http://twitter.com/niclasnorgren)！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-23T21:55:34.963

此外，如果您需要在 IE 8 中进行检查，您可以使用 window.screen.deviceXDPI 和 window.screen.deviceYDPI。默认为 96 dpi，如果您放大，数字会更大（放大 150% 时为 144）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T20:38:02.960

接受的答案有一个小的语法错误（正文而不是 document.body）。这似乎也可以解决问题。

```
var rect = document.body.getBoundingClientRect(); 
var zoomLevel = Math.round((rect.right-rect.left)/document.body.clientWidth * 100); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-20T21:07:49.767

我已经在另一个帖子上发布了解决方案，你可以在这里得到这个。这也适用于 IE7。

[自动检测屏幕分辨率并使用 Javascript 更改浏览器缩放？](https://stackoverflow.com/questions/3185705/auto-detect-a-screen-resolution-and-change-browser-zoom-with-javascript)

```
This will help to detect browser zoom tested on all browser
<script>
window.utility = function(utility){
utility.screen = {
    rtime : new Date(1, 1, 2000, 12,00,00),
    timeout : false,
    delta : 200
};
utility.getBrowser = function(){
    var $b = $.browser;
    $.extend(utility.screen,$.browser);
    utility.screen.isZoomed = false;
    var screen  = utility.screen;
    screen.zoomf  = screen.zoom = 1;
    screen.width = window.screen.width;
    screen.height = window.screen.height;
    if($b.mozilla){ //FOR MOZILLA
        screen.isZoomed  = window.matchMedia('(max--moz-device-pixel-ratio:0.99), (min--moz-device-pixel-ratio:1.01)').matches;
    } else {
        if($b.chrome){ //FOR CHROME
            screen.zoom = (window.outerWidth - 8) / window.innerWidth;
            screen.isZoomed = (screen.zoom < .98 || screen.zoom > 1.02)
        } else if($b.msie){//FOR IE7,IE8,IE9
            var _screen = document.frames.screen;
            screen.zoom = ((((_screen.deviceXDPI / _screen.systemXDPI) * 100 + 0.9).toFixed())/100);
            screen.isZoomed = (screen.zoom < .98 || screen.zoom > 1.02);
            if(screen.isZoomed) screen.zoomf = screen.zoom;
            screen.width = window.screen.width*screen.zoomf;
            screen.height = window.screen.height*screen.zoomf;
        }
    }
    return utility.screen;
};
  window.onresize = function(e){
       utility.screen.rtime = new Date();
        if (utility.screen.timeout === false) {
              utility.screen.timeout = true;
              setTimeout(window.resizeend, utility.screen.delta);
        }
  };
window.resizeend = function() {
    if (new Date() - utility.screen.rtime < utility.screen.delta) {
        setTimeout(window.resizeend, utility.screen.delta);
    } else {
        utility.screen.timeout = false;
        utility.screen = utility.getBrowser();
        if(window.onresizeend) window.onresizeend (utility.screen);
        if(utility.onResize) utility.onResize(utility.screen);
    }               
};
window.onresizeend = function(screen){
    if(screen.isZoomed)
        $('body').text('zoom is not 100%');
    else{
        $('body').text('zoom is 100% & browser resolution is'+[screen.width+'X'+screen.height]);
    }
};
$(document).ready(function(){
    window.onresize();
});
return utility;
}({});
</script> 
```

[演示](http://jqgeeks.com/view/tools/browser/detect-browser-zoom-actual-resolution-demo.html)

# c# - asp.net 中 Convert.ToDateTime 的问题

> ID：680598
> 
> 赞同：1
> 
> 时间：2009-03-25T07:52:43.997
> 
> 标签：c#, asp.net, formatting, web-config, culture

我有一个在西班牙服务器上运行没有任何问题的应用程序。

当我将应用程序上传到在线服务器（英文窗口）时，我使用 Convert.ToDateTime 和 Convert.ToInt32 收到异常（类型为“输入字符串不是有效的 Datetime/Int32”）。有任何 web.config 行可以帮助我解决这个问题吗？我尝试在西班牙文化中添加全球化元素，但没有奏效。

你能帮我一把吗？

提前致谢。何塞马。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T08:02:40.760

你需要：

```
System.Globalization.CultureInfo culture = 
              new System.Globalization.CultureInfo("es-ES");
DateTime myDateTime = Convert.ToDateTime(string, culture); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T07:56:38.120

您是否在调用中指定[CultureInfo](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx)参数？`IFormatProvider`[`String.Format()`](http://msdn.microsoft.com/en-us/library/1ksz8yb7.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T07:57:22.473

您可能在全球化元素中设置了 uiculture 而不是文化，请参阅：http: [//msdn.microsoft.com/en-us/library/bz9tc508.aspx](http://msdn.microsoft.com/en-us/library/bz9tc508.aspx)。

```
...
    <globalization culture="es-MX" />
... 
```

您也可以尝试使用更具体的文化（如上面的 es - mexico）。

附言。我有一个这样工作的网站（实际上是使用culture="en"，因为我的开发计算机当时配置了西班牙语，因此我需要强制使用英语）。

# asp.net - 2 互斥单选按钮“列表”

> ID：680600
> 
> 赞同：0
> 
> 时间：2009-03-25T07:53:43.493
> 
> 标签：asp.net

我认为这一定是我在网络表单中做过的最令人沮丧的事情。然而，人们会认为这将是世界上最容易做到的事情。就是这样：

我的 .aspx 页面上需要 2 个单独的单选按钮列表。一组允许客户选择一个选项。另一组也这样做，但目的不同。但只有一组可以有一个选定的单选按钮。

好的，我已经尝试在同一页面上使用 2 个 asp.net Radiobuttonlists 控件。使用 GroupName 解决了令人讨厌的错误（asp.net 分配控件的唯一 ID，这会阻止组名工作，因为现在，2 个单选按钮列表不能为其所有单选按钮具有相同的组名，因为每个单选按钮列表具有不同的唯一 ID，因此错误分配了渲染按钮时作为名称属性的唯一ID。由于名称集不同，它们不互斥）。无论如何，所以我创建了那个自定义 RadioButtonListcontrol 并修复了那个组名问题。

但是最终发生的时候是当我在我的 .aspx 页面上放置我的新自定义单选按钮列表控件的 2 个实例时，一切都在膨胀，直到我注意到每次我检查 radiobuttonlist1.SelectedValue 或 radiobuttonlist2.SelectedValue （不管我正在检查）该值总是吐回 string.empty 我无法弄清楚原因（请参阅[http://forums.asp.net/t/1401117.aspx](http://forums.asp.net/t/1401117.aspx)）。

好吧，今晚进行第三次尝试，进入黎明破晓（不睡觉）。由于那个 string.empty 问题，我尝试放弃尝试完全使用 2 个自定义单选按钮列表，并尝试通过使用 2 个 asp.net 中继器和内部的标准输入 HTML 标记来吐出 2 组单选按钮列表。得到那个工作。好的，但是这两个列表仍然不是相互排斥的。我可以从repeater1 的第一组单选按钮中选择一个值，repeater2 也是如此。我一辈子都无法让“集合”成为互斥的单选按钮集合。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T08:09:12.427

由于您有两组单选按钮，您希望将其用作一组单选按钮，因此解决方案很简单：将其设为一组单选按钮。

您遇到的唯一问题是您获得的值在两个列表中具有相同的名称，但这可以通过为值添加前缀来解决，以便您轻松识别选项来自哪个列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T08:05:26.227

**更新：**基于作为答案发布的新信息。我在原始答案中提出的选项对应于 3。您确实必须考虑以下几点：

*   Html 单选按钮只有一种内置机制来处理排他性，即名称。
*   您明确请求无 js 解决方案，因此鉴于上述情况，您必须操纵 Id 来实现它。如果您没有阻止此选项，我相信有人会想出一些已经支持它的不错的 jquery 或 js 库。
*   选项 3 显然侵入性较小，因为您不会被迫影响实际数据，也不会受到未来更新的影响。

代码不多，只是 List 索引上的一些额外内容，还有一些简单的东西：

```
int? list1Value = null;
int? list2Value = null;
var value = Request.Form["somegroup"];
if (value.StartsWith("List1"))
    list1Value = int.Parse(value.Substring(5));
else
    list2Value = int.Parse(value.Substring(5));//Assuming List2 as prefix 
```

* * *

原来的：

我看到了你的另一个问题，你只需要使用相同的组名。确保所有项目都有不同的值，无论它们来自哪个列表。实现此目的的一种方法是在值中添加一些内容，例如：<%# "List1-" + Eval("ID") %> 并修改读取 Request.Form["yourgroupname"] 的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T08:47:05.863

我认为您应该只使用 RadioButtons 而不是 RadioButtonLists。

[这是一篇文章](http://www.developer.com/net/asp/article.php/3623096)，介绍了解决单选按钮命名错误的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-31T15:42:16.890

虽然这篇文章已经发布于 1 年前，但我只是读了它，因为我面临同样的问题。

目前我有 1 个使用 jQuery 的解决方案：

客户端脚本（您还必须包含 jQuery）

```
 function SetRadio(rb) {
        $('input:checked').attr('checked', false);
        rb.checked = true;
    } 
```

对于每个单选按钮（这是单选按钮列表中的一个列表项），我在服务器端添加以下内容：

```
li.Attributes.Add("onclick", "javascript:SetRadio(this)"); 
```

对我来说，这适用于 IE 和 Firefox，有 3 个单选按钮列表，不使用组名。您可以检查每个单选按钮列表中的选定项/值，也可以扩展 SetRadio 函数，以便将选定值存储在隐藏字段中。

问候，米

# sql - SQL 积压计算 (MS Access)

> ID：680602
> 
> 赞同：0
> 
> 时间：2009-03-25T07:54:57.080
> 
> 标签：sql, ms-access

我需要从一个表中计算积压： **components(ProductId, ComponentId, Status, StatusDate)** 其中 ComponentId, Status 和 StatusDate 是主键。ProductId 是一个外键。示例： 基本上我要计算的是每周状态低于 03 的组件数。最终用户将引入一个间隔日期，因此即使一周没有积压，我也需要显示间隔中的所有周。最终用户介绍 01/01/2009-22/01/2009 时的预期结果： 第 2 周的说明：comp1 在一周内达到状态 03，但随后又回到状态 01 非常欢迎任何帮助，谢谢

`prod1, comp1, 01, 05/01/2009
prod1, comp1, 02, 05/01/2009
prod1, comp1, 03, 06/01/2009
prod1, comp1, 01, 07/01/2009
prod1, comp1, 02, 20/01/2009
prod2, comp2, 01, 22/01/2009
prod1, comp1, 02, 23/01/2009
prod1, comp1, 03, 31/01/2009` 

`Week, Backlog
1,NULL/0
2,1
3,1
4,2` 

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T12:42:51.927

我猜测你想要做什么，但这是我最好的猜测：

首先，您的数据库中应该有一个日历表：

```
CREATE TABLE Calendar (
     calendar_date DATETIME NOT NULL,
     week_number INT NOT NULL,
     CONSTRAINT PK_Calendar PRIMARY KEY CLUSTERED (calendar_date)
)
GO

INSERT INTO Calendar (calendar_date, week_number) VALUES ('1/1/2009', 1)
INSERT INTO Calendar (calendar_date, week_number) VALUES ('2/1/2009', 2)
etc. 
```

您可以根据业务需要向表中添加其他列。例如，一个“is_holiday”位列来跟踪您的办公室当天是否关闭。该表使许多不同的查询变得微不足道。

现在解决您的问题：

```
SELECT
     CAL.week_number,
     COUNT(DISTINCT C.component_id)
FROM
     Calendar CAL
LEFT OUTER JOIN Components C ON
     C.status_date = CAL.calendar_date AND
     C.status IN ('01', '02')
WHERE
     CAL.calendar_date BETWEEN @start_date AND @end_date
GROUP BY
     CAL.week_number 
```

由于您使用的是字符串，因此我将 IN 用于状态，因此“<'03'”可能并不总是给您想要的。你心目中的“1”小于“03”吗？

此外，如果您的任何日期都有时间组件，则可能需要调整相等性和 BETWEEN 检查。

**编辑**：我刚刚看到对另一个答案的评论。如果您只处理状态更改，那么以下查询应该可以工作，尽管可能有更高效的方法：

```
SELECT
     CAL.week_number,
     COUNT(DISTINCT C.component_id)
FROM
     Calendar CAL
LEFT OUTER JOIN Components C ON
     C.status_date <= CAL.calendar_date AND
     C.status IN ('01', '02')
LEFT OUTER JOIN Components C2 ON
     C2.component_id = C.component_id AND
     C2.status_date > C.status_date AND
     C2.status_date <= CAL.calendar_date
WHERE
     CAL.calendar_date BETWEEN @start_date AND @end_date AND
     C2.component_id IS NULL
GROUP BY
     CAL.week_number 
```

不过，我不确定该产品在哪里适合所有这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T09:43:53.840

这是部分答案，因为在您的示例中，我看不到第 3 周（2009 年 1 月 11 日至 18 日）的来源。它说明了使用计数器表来获取缺失值的行。

```
SELECT Counter,WeekNo, CountofStatus FROM Counter LEFT JOIN
    (SELECT Format([StatusDate],"ww") AS WeekNo, COUNT(c.Status) AS CountOfStatus
    FROM components c
    WHERE c.StatusDate BETWEEN #1/1/2009# AND #1/22/2009#
    AND c.Status<3
    GROUP BY Format([StatusDate],"ww")) Comp
ON Val(Comp.Weekno)=Counter.Counter   
WHERE Counter.Counter>=Val(Format(#1/1/2009#,"ww"))
AND Counter.Counter<=Val(Format( #1/22/2009#,"ww")) 
```

# c# - 如何通过.NET MVC（c＃）中的网页向MSSQL数据库提供SQL命令行界面（如osql）

> ID：680605
> 
> 赞同：1
> 
> 时间：2009-03-25T07:56:24.020
> 
> 标签：c#, sql-server, asp.net-mvc, command-line

我想为我的数据库提供一个命令行界面，允许用户输入多个数据库命令或查询（由 textarea 中的换行符分隔）

对于每一行，如果它的查询必须返回结果，如果它是命令，则无论它是否成功 - 从而允许用户将脚本粘贴到文本区域并单击“开始”以执行批处理。

我一直在使用 DataContext 与应用程序中的数据库进行交互，但没有从哪里开始的线索。任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T08:28:43.473

1.  考虑一下您正在为您的网站带来的安全问题。

2.  再考虑一下安全性。聪明的用户（比你/我更聪明）如何使用此页面侵入数据库。
    也许/可能使用一些格式错误的 SQL，在这个阶段你不会考虑。

3.  当您使用的数据库是 SQL 服务器时，使用直接的 SqlConnection 和[SqlCommand 。](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.aspx)当您需要使用这些时，请使用 oracle 或其他提供程序。一个 SqlCommand 可以返回更多作为 1 个结果，这在一个查询中有多个命令的情况下很方便。有关详细信息，请参阅[NextResult](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.nextresult.aspx)方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T09:07:22.600

正如前面的答案所指出的，如果它是一个可公开访问的网站，请不要这样做！

如果你必须这样做，下面的代码接近你所追求的——稍加修改你就会得到你想要的。

```
public static bool ExecuteSql(string sqlScript)
{
    bool success = true;

    using (SqlConnection cn = new SqlConnection([YourConnectionString]))
    {
        SqlCommand cmd = null;
        try
        {
            cn.Open();

            string[] commands = sqlScript.Split(new string[] { "GO\r\n", "GO ", "GO\t" }, StringSplitOptions.RemoveEmptyEntries);
            foreach (string c in commands)
            {
                cmd = new SqlCommand(c, cn);
                cmd.CommandType = CommandType.Text;
                cmd.ExecuteNonQuery();
            }
        }
        catch (Exception ex)
        {
            success = false;
            throw new Exception("Failed to execute sql.", ex);
        }
        finally
        {
            cn.Close();
        }

        return success;
    }
} 
```

# f# - 如何让两个方法互相调用？

> ID：680606
> 
> 赞同：39
> 
> 时间：2009-03-25T07:56:25.827
> 
> 标签：f#, mutual-recursion

对于如何让两种方法互相调用（即有`A()`call`B()`和`B()`call `A()`），我有点困惑。似乎 F# 仅在代码中遇到该方法后才“看到”该方法，因此如果没有，它只会说*value 或 constructor has not been defined*。

我在这里错过了一些非常基本的东西吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-03-25T08:02:29.027

'let rec... and...' 是您寻求的语法。

```
let rec F() = 
    G()
and G() =
    F() 
```

另请参阅[F# Co-Recursion 中的冒险](http://blogs.msdn.com/jomo_fisher/archive/2007/09/24/adventures-in-f-corecursion.aspx)。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-25T08:14:20.793

由于问题是关于方法的，而 Brian 的答案是关于函数的，所以指出您可以对类型使用类似的语法可能很有用：

```
type A() =
    let b = new B()
    member x.MethodA() = b.MethodB()
and B() =
    member x.MethodB() = () 
```

另请注意，默认情况下成员是'let rec'（实际上我认为他们不能不递归）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-02-23T05:08:39.307

F# 4.1 引入了[相互递归的模块和命名空间](https://docs.microsoft.com/en-us/dotnet/fsharp/language-reference/modules#module-rec-allowing-mutual-recursive-code-at-the-module-level)。

这些是`and`关键字的替代品。

```
module rec PingPong = // <------ rec keyword here.

    let pong() = 
        printfn "pong"
        ping() 

    let ping () = 
        printfn "ping"
        pong() 
```

该`rec`关键字定义了“允许所有包含的代码相互递归”的模块和命名空间。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-11-07T19:39:55.047

## 通过 let 声明的函数

```
let rec a () = b ()
and b () = () 
```

这些是*相互递归的函数*。

## 同一类型内的方法

```
type T () =
    member t.A () = t.B()
    member t.B () = () 
```

这是微不足道的；它只是工作。*请注意亚伯的评论。*

## 不同类型中的方法

```
type TypeA () =
    member t.A (b : TypeB) = b.B()

and TypeB () =
    member b.B () = () 
```

这使用了*相互递归类型*`type ... and`的语法。

 *## 笔记

通常，`and`仅在呼叫发生在两个方向时使用。否则，最好重新排序声明，以便被调用的函数首先出现。避免循环依赖并在不使用它们的地方不暗示它们通常有助于类型推断和可读性。

我建议编辑这个问题，要么要求一般的功能，要么要求不同的类型（在这种情况下，我会从这个答案中删除前两种情况）。方法通常被认为是函数的子集，这是通用的数学术语。但是，从技术上讲，所有 F# 函数都是*CLI 方法*，因为它们是编译成的。照原样，目前尚不清楚问题的要求是什么，但我从接受的答案中假设它不仅要求方法，正如标题所暗示的那样。

# gwt - GWT 客户端中的 XStream

> ID：680614
> 
> 赞同：0
> 
> 时间：2009-03-25T07:59:06.493
> 
> 标签：gwt, xstream, gwt-rpc

我想使用 XStream 在我的 GWT 应用程序上序列化我的 RPC 调用，并且我希望以两种方式完成它，因为我正在来回发送 java 对象。是否可以在客户端运行 XStream？如何？或者，您可以为客户端推荐任何其他 xml-serializer 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T20:58:22.390

我开发了一个以 XStream 为模型的客户端 XML 序列化程序。它使用注释和 GWT 代码生成器在编译时创建序列化程序。这是一个定制的内部项目。我想完善它并开源它，但我现在没有时间。我只是想说这是可能的......也许有人会在那里放一些东西。

但是，您可能最好使用 JSON 或 GWT-RPC（即使这意味着您有一个必须重新路由调用的单独端点）。这一切都是为了易于维护（而不是手写序列化程序）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T10:30:03.790

I'm confused. You have a Java back end? Why not use the built in RPC mechanism? It's second to none if you're running Java on the back end.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T08:13:55.507

我认为不可能在浏览器上运行 XStream。为什么不在客户端使用本机 JSON 进行序列化？XStream 在服务器上具有 JSON 解析功能。见[http://x-stream.github.io/json-tutorial.html](http://x-stream.github.io/json-tutorial.html)

# flash - Box2D：如何检测一个物体不再与另一个物体碰撞？

> ID：680617
> 
> 赞同：1
> 
> 时间：2009-03-25T08:00:36.397
> 
> 标签：flash, box2d

Flash Box2D 问题（但我猜“flash”部分无关紧要）

假设有一个对象 A，它是角色和一个对象 B，它是地面

假设角色只有在接触地面时才能行走。

有一个 box 2d contact listener，当一个物体接触到另一个物体时我可以检测到，所以我可以用它来听角色何时接触地面。但是我怎么知道角色是否离开了地面？

谢谢阅读。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-12T21:47:27.477

> 假设有一个对象 A，它是角色和一个对象 B，它是地面
> 
> 假设角色只有在接触地面时才能行走。

假设您的对象 A 是称为 objectA 的 b2Body，而 objectB 是另一个称为 objectB 的 b2Body，而您的世界称为 m_world。如果 objectB 是地面，我猜它的密度为 0，这使它成为静态的。如果你想检查 objectA 是否高于 objectB 你有两个选择，要么通过身体本身，这意味着使用 box2d 单位测量（1 米 = 30 像素），要么使用对通过 userData 属性设置的自定义剪辑的引用。

我猜，使用第二个的优点是您将使用常规像素单位，请记住您的注册点在中心而不是 0,0。

因此，在您的更新循环（您调用 m_world.Step 的位置）中，您将拥有类似的内容：

```
if((objectA.m_userData.y + objectA.m_userData.height*.5) < (objectB.m_userData.y-objectB.m_userData.height*.5)) trace('objectA is above ground');
else trace('objectB is on the ground'); 
```

刚刚阅读您的评论并再次更新。

我开始为 flash 编写一个 jsfl 命令，它从舞台上的元素中获取 x、y、width、height 并生成 box2d 代码。我用它来制作这个简单的游戏： [http](http://www.disturbmedia.com/games/breakfast) ://www.disturbmedia.com/games/breakfast 似乎我不需要重新发明轮子，因为其他人已经做出了相当一致的东西。刚从 LFPUG 回来，Carlos Ulloa 也谈到了 box2d，他指出了这件事：

[http://www.sideroller.com/wck/](http://www.sideroller.com/wck/)

它似乎为您需要的更复杂的形状定义生成坐标数组。在某种程度上，这不是您特定问题的完整答案，但它是向前迈出的一步。

从你的描述来看，这个游戏听起来很有趣。让我们更新:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-28T14:01:16.673

我想你正在寻找这个：

```
override public function EndContact(contact:b2Contact):void
        {
            if (contact.GetFixtureA().GetBody().GetUserData() != null)
            { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-09T16:58:08.767

自从您提出问题以来，我确定 box2d 版本已经改变。

目前检查地面碰撞的常用方法是检查碰撞“法线”的方向。

如果它是向上的，那么继续并假设英雄已接地，并允许行走。

回答您问题的其他部分

有 BeginContact 和 EndContact。

我经常在我的英雄上存储一个 var grounded:Boolean 变量来跟踪，我什至在跳跃时手动将其设置为 false 以避免在英雄离开地面之前多次发生跳跃。

我希望这会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T11:51:08.953

在联系人监听器中，有一个名为 Remove(b2ContactPoint) 的方法。此方法由物理引擎调用，两个物体不再接触。也就是说，他们已经没有联系点了。您可以在该点检测到作为演员的身体 A 没有漂浮。

另一个很酷的解决方案是从 Actor 到地面进行光线投射，检查它们之间的距离，您可以判断您是在漂浮还是在行走。希望这有效

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-16T17:41:37.767

我不久前解决了这个问题，虽然我的解决方案很傻，但效果很好。我只是将地面的密度、恢复力和摩擦力设置为一些“神奇”的数字，然后在我的接触监听器中，我只是检查其中一个物体是否具有这些数字，而另一个物体是我的精灵。

就像我说的那样，这很愚蠢，但我还没有看到其他简单的方法。

# msbuild - 为什么在 msbuild 中将属性值用作属性值而不是 Item 值时起作用？

> ID：680618
> 
> 赞同：0
> 
> 时间：2009-03-25T08:00:53.430
> 
> 标签：msbuild, sandcastle

我正在尝试使用 Sandcastle Help File Builder 为我的应用程序构建文档。一项要求是我必须指定文档来源，例如：

```
<DocumentationSources>
    <DocumentationSource sourceFile="@(DocumentationSourceFiles)" xmlns="" />
</DocumentationSources> 
```

我在一个单独的文件中定义了@(DocumentationSourceFiles)，如下所示：

```
 <ItemGroup>
     <DocumentationSourceFiles Include="..\src\**\*.exe"></DocumentationSourceFiles>
  </ItemGroup> 
```

然后我将该文件导入到 .shfbproj 文件中，并如上所述使用它。问题是 @(DocumentationSourceFiles) 没有被识别为项目列表，而仅仅是一个字符串。我做错什么了吗？如果我要将 @(DocumentationSourceFiles) 更改为具有单个值的属性，例如：

```
<PropertyGroup>
    <DocumentationSourceFiles>S:\SVN\myApp\src\myAppName\Debug\bin\myApp</DocumentationSourceFiles>
</PropertyGroup> 
```

然后使用：

```
<DocumentationSources>
    <DocumentationSource sourceFile="$(DocumentationSourceFiles)" xmlns="" />
</DocumentationSources> 
```

一切正常。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T08:20:52.930

> 使用符号 @(myType) 可以将 myType 类型的项目集合扩展为分号 (;) 分隔的字符串列表，并传递给参数。如果参数是字符串类型，则参数的值是由分号分隔的元素列表。如果参数是字符串数组 (string[])，则每个元素都根据分号的位置插入到数组中。如果任务参数的类型为 ITaskItem[]，则该值是项目集合的内容以及附加的任何元数据。要使用分号以外的字符分隔每个项目，请使用语法 @(myType, 'separator')。

如果您想分别拥有每个项目，请使用元数据表示法：*%(ItemCollectionName.ItemMetaDataName)*

```
<ItemGroup>
  <DocumentationSourceFiles Include="..\src\**\*.exe"></DocumentationSourceFiles>
</ItemGroup>

<Target Name="TestItem">
  <Message Text="Using @ Notation"/>
  <Message Text="@(DocumentationSourceFiles)"/>
  <Message Text="Using Metadata Notation"/>
  <Message Text="%(DocumentationSourceFiles.RecursiveDir)%(Filename)%(Extension)"/>
</Target>

> Output:
Using @ Notation
..\src\doc1.exe;..\src\doc2.exe;..\src\subdir\doc3.exe
Using Metadata Notation
..\src\doc1.exe
..\src\doc2.exe
..\src\subdir\doc3.exe 
```

# ruby-on-rails - 为用户生成的表单模板构建数据的方式

> ID：680621
> 
> 赞同：0
> 
> 时间：2009-03-25T08:01:43.787
> 
> 标签：ruby-on-rails, xml, database-design

我正在考虑做某事的想法，以及学习 Ruby on Rails（很简单，嗯 :)）。我想要一些东西来允许用户将表单生成为模板，然后将这些模板作为表单分配到树层次结构中的某个位置，然后允许用户填写这些表单的实例并保存数据。

因此，对于如何构建数据，我有两种不同的想法。我目前认为模板将有一个或多个部分，一个部分将有一个或多个字段，然后该字段将具有属性（类型、颜色、位置、验证等）。

那么，这应该被描述为链接表吗？

```
字段belongs_to_a 部分belongs_to_a 模板
```

或者我应该有一个模板表，它有一个名为 body 的字段，可以序列化进出 XML 或要呈现的东西？

```
<template>
    <section>
        <field attrib=foo attrib2=bar><field>
    </section>
<template> 
```

欢迎任何想法或评论，即使我完全走错了路......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-26T13:15:02.230

我会选择第一个设计。如果我是用户（或开发人员），我宁愿在逻辑相关的表中输入数据，也不愿编写 XML 来定义屏幕。事实上，Oracle 在其非常成功的工具[Application Express](http://apex.oracle.com/i/index.html)背后使用了与此类似的数据结构。

# asp.net - 什么是您最喜欢的 ASP.NET 附加组件/工具来提高生产力和代码

> ID：680624
> 
> 赞同：4
> 
> 时间：2009-03-25T08:03:32.987
> 
> 标签：asp.net, visual-studio-2008

我想知道人们在 ASP.NET 中编码时使用哪些其他工具/框架/附加组件来提高他们的生产力/开发速度。

我只是单独使用 VS2008，但想了解其他人使用 VS2008 的内容，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T09:04:26.977

除了[ReSharper](http://www.jetbrains.com/resharper/)之外，如果您在项目中使用 javascript 和 css ，[IE Developer ToolBar](http://www.microsoft.com/downloads/details.aspx?familyid=e59c3964-672d-4511-bb3e-2d5e1db91038&displaylang=en)和[FireBug可以提高您的速度。](https://addons.mozilla.org/en-US/firefox/addon/1843)[Fiddler](http://www.fiddler2.com/fiddler2/)也是调试目的的好工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T08:09:30.023

我用：

[GhostDoc](http://www.roland-weigelt.de/ghostdoc/)：GhostDoc 是 Visual Studio 的免费插件，可自动为 C# 生成 XML 文档注释。通过使用从基类或实现的接口继承的现有文档，或者通过从名称和类型（例如方法、属性或参数）中推断出注释。

[适用于 Visual Studio 的](http://devexpress.com/Products/Visual_Studio_Add-in/CodeRushX/)CodeRush Xpress：CodeRush Xpress 可供所有 Visual Studio 2008 开发人员免费使用，并提供一套全面的工具，使您和您的团队能够简化和塑造复杂的代码——使其更易于阅读且维护成本更低。

[CoolCommands](http://geekswithblogs.net/SoftwareDoneRight/archive/2007/12/12/coolcommands-in-visual-studio-2008.aspx)：它包含很多很酷的东西，但我主要使用字体功能，例如：“Demo Font”或“Wheel Font Sizing”。例如，Demo Font 可以轻松地将字体切换到适合在投影仪上进行演示的大小。如果您再次禁用它，您的字体大小将切换回其原始大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T08:11:25.027

我不确定这是否重要，但我们将[CruiseControl.NET](http://ccnet.thoughtworks.com/)用于构建服务器，从长远来看，这也有助于提高生产力。

我使用[Resharper](http://www.jetbrains.com/resharper/)有一段时间了，虽然它确实提高了工作效率，但我最终还是卸载了它，因为它让我的 Visual Studio 太慢了。虽然我必须管理，那是差不多两年前的事了，所以从那时起它可能已经有所改善。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T08:23:07.963

我的工具是：[CodeRush](http://www.devexpress.com)和[Refactor](http://www.devexpress.com)，以及[VisualSVN](http://www.visualsvn.com/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T08:48:40.320

*[Microsoft Expression Web](http://www.microsoft.com/expression/products/overview.aspx?key=web)*：可以打开 Visual Studio .Sln 文件，但专注于设计。它包含在我的 MSDN 订阅中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T09:13:47.890

*谷歌浏览器*：在上下文菜单上有一个非常好的“检查元素”项目。除其他事项外，屏幕将非常容易地了解 CSS 属性的来源。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-07T19:23:41.040

我是 Firefox、Chrome、GhostDoc 和 Fiddler 中的 ReSharper、Web Developer Toolkit 和 Firebug（对 JSON 请求特别有用）的忠实粉丝。哦，还有 YSlow。

# wcf - WCF 与 net.tcp 的性能

> ID：680625
> 
> 赞同：6
> 
> 时间：2009-03-25T08:03:58.867
> 
> 标签：wcf, performance, tcp

我有一个使用内置 ServiceHost 托管的 WCF net.tcp 服务，在进行一些压力测试时，我得到了一个奇怪的行为。我第一次发送一堆请求时，有 5 到 10 个请求得到了快速响应，其余的则以大约 2 秒的间隔返回。我第二次发送请求时，快速返回 10 - 20，并以 2 秒间隔休息。

以上重复，直到我可以快速返回 100 多个请求，但如果我等待一分钟左右，服务的内存使用量会下降，并且请求会快速返回到 5-10。

我正在测试的服务有一个小的延迟，所以我可以同时获得许多打开的连接，如果这个延迟被消除，请求返回的速度很快，我可能同时打开了 2-5 个连接。这个延迟是为了模拟数据库连接和其他传出的东西。

从行为看来，ServiceHost 正在分配一些东西、线程、类实例，但我无法弄清楚它是什么。

我可以在客户端中有一个计时器来调用服务以使其保持工作，但这似乎是一个糟糕的解决方案。

如果我对服务有很高的持续负载，它会快速处理所有请求，但如果我有一段时间的低活动，然后服务中的连接激增会很慢。

我想我的问题是在 WCF 服务的高负载期间分配的内容是什么，以及如何配置服务以预分配更多分配的内容。

编辑：我做了一些更多的测试，并查看进程的taskmgr，我可以看到当服务主机“休息”时有10个线程打开，但是当我开始发送请求时，线程数增加了。只要线程数很高，服务主机就可以快速处理传入的请求，但是如果我暂停发送请求，打开的线程数会减少，并且后续请求开始需要更长的时间来处理。

现在，我怎样才能告诉服务主机保持一堆线程打开？还是超过默认保留的 10-12？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-26T05:24:40.443

好吧，经过大量谷歌搜索，问题似乎出在线程池上。CLR 线程池分配一些线程，当它们被使用时，它会限制新线程的创建，一段时间后它还会释放未使用的线程。

关于一个错误，这意味着 ThreadPool 不支持 SetMinThreads 调用，存在一些混淆。

[http://www.michaelckennedy.net/blog/PermaLink,guid,708ee9c0-a1fd-46e5-8fa0-b1894ad6ce0f.aspx](http://www.michaelckennedy.net/blog/PermaLink,guid,708ee9c0-a1fd-46e5-8fa0-b1894ad6ce0f.aspx)

我不确定这个错误是否已解决，或者什么，因为当我修改 ThreadPool 设置时，问题仍然存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T09:49:52.950

决定如何同时处理请求的是 ServiceThrottlingBehavior。有许多不同的阈值会限制正在处理的请求数量。这也取决于您使用的绑定，例如 wsHttpBinding 默认开启会话，而 basicHttpBinding 不使用会话，默认会话限制 10 没有问题。

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/ms735114.aspx 。](http://msdn.microsoft.com/en-us/library/ms735114.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T20:33:21.673

您引用的错误已在 .NET 3.5 SP1 中修复。这可能与问题有关，我认为节流更有可能（更有可能）是您的问题，而不是 Maurice 键入的线程。

```
<system.serviceModel>
  <service name="???" >
   <endpoint ... />
  </service>
</system.serviceModel> 
```

这个“空”配置的油门限制是多少？10 个会话，16 个并发呼叫！谨防。

这里有更多关于线程的信息：http: [//www.michaelckennedy.net/blog/2008/08/20/ThreadPoolBugInNET20SP1IsFixed.aspx](http://www.michaelckennedy.net/blog/2008/08/20/ThreadPoolBugInNET20SP1IsFixed.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T17:09:36.973

这感觉就像一个黑客，但它似乎解决了你的问题。问题是线程池需要时间来启动一个新线程，所以你真正需要的是等待待机的线程。为您的服务添加一个构造函数并设置您想要的最小线程数。

```
 public YourService()
    {
        int workerThreads;
        int portThreads;
        ThreadPool.GetMinThreads(out workerThreads, out portThreads);
        ThreadPool.SetMinThreads(200, portThreads);
    } 
```

# linux - 在 Linux 上创建核心转储

> ID：680627
> 
> 赞同：4
> 
> 时间：2009-03-25T08:05:06.290
> 
> 标签：linux, fedora, coredump

### 复制：

> [在linux中生成核心转储](https://stackoverflow.com/questions/17965/generate-a-core-dump-in-linux)

我正在尝试在我的“Fedora Core release 3 (Heidelberg)”中创建一个核心转储。

[root@testserver test_core_dump]# uname -a

Linux 测试服务器 2.6.12-1.1381_FC3 #1 Fri Oct 21 03:46:55 EDT 2005 i686 athlon i386 GNU/Linux

我正在按照[这个](http://www.novell.com/support/viewContent.do?externalId=3054866&sliceId=1)来创建核心转储。

问题是，/proc/sys/kernel/suid_dumpable 在此版本中不存在。我还在这里检查了 /proc/sys/fs/suid_dumpable，但 suid_dumpable 不存在。

1）有什么解决方法吗？2）我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T08:24:59.003

您遵循的说明只是为了覆盖可能会阻止您获得核心转储的 o/s 限制。

核心转储的生成是一个微不足道的过程，您向该过程发送信号如下

```
kill -ABRT pid_of_process 
```

然而，有很多事情可能会阻止这种情况发生，但是您应该先尝试一下，看看它是否会在您的当前目录中产生核心转储。如果程序是交互式的并且没有捕获退出信号，那么您可以通过向进程发送 SIGQUIT 来导致核心转储，这通常绑定到 CTRL-\

您在参考文档中遇到问题的区域是指运行 setuid/setguid 的进程，如果您的进程未在其中任何一种模式下运行，那么您可以放心地忽略该步骤。（您可以通过查看程序的文件权限并检查 setuid 和 setguid 位来判断进程是否正在运行 setuid/setguid，这可以通过发出 ls -l 命令并在第 4 位（setuid）中查找 s 来完成或第 7 位 (setgid)（下面的 setuid 示例）

`-r-sr-xr-x 1 root wheel 57616 28 Oct 03:28 /usr/bin/login`

您是否尝试过在不使用不起作用的步骤的情况下生成核心并且它是否有效？

您将需要能够写入进程正在运行的目录，或者为核心转储定义的目录（如果该目录不是当前目录）。以 root 身份运行可以解决权限问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T09:25:24.290

我不确定我明白你想要什么。您引用的网页谈论启用核心转储，而不是触发它们。不用担心缺少 sysctl——我的 Linux 系统也没有它，我可以愉快地转储核心 :) 你想为特定进程创建核心转储吗？

除了 SIGABRT，您还可以尝试使用`gcore`：

**NAME** gcore - 为正在运行的进程生成核心文件

**概要** gcore [-o 文件名] pid

**描述** gcore 为其进程 ID pid 指定的进程生成一个核心文件。默认情况下，核心文件被写入当前目录中的 core.pid。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T09:54:36.857

这是[这个问题](https://stackoverflow.com/questions/17965/generate-a-core-dump-in-linux)的副本。[接受的答案](https://stackoverflow.com/questions/17965/generate-a-core-dump-in-linux/17994#17994)和[得票最多](https://stackoverflow.com/questions/17965/generate-a-core-dump-in-linux/17994#17994)的答案建议如下：

在 Bash 中：

```
ulimit -c unlimited 
```

在 tcsh 中：

```
limit coredumpsize unlimited 
```

在这种情况下，如果程序崩溃，核心转储将创建在一个名为`core`该程序运行位置的文件中。

# eclipse - 可以在命令行上指定额外的插件目录吗

> ID：680642
> 
> 赞同：2
> 
> 时间：2009-03-25T08:10:13.160
> 
> 标签：eclipse, eclipse-plugin

使用 Eclipse 3.4，是否可以从命令行提供额外的插件目录？就像是：

```
eclipse -plugin_dir  D:/myproduct/V1.1/plugins -clean 
```

这只是为了每次都保存插件的复制。

虽然可以使用脚本进行复制，但用户可能没有系统安装 eclipse 的写入权限。

* * *

### 跟进：

@VonC 给出的解决方案是在多个 Eclipse 中重用相同的插件。

我正在寻找一个在相同的 Eclipse 中使用多个版本的插件。（如果用户安装了我的插件的 1.1 版和 1.2 版）

### 解决：

1.  -Dorg.eclipse.equinox.p2.reconciler.dropins.directory 指向的目录应该以一个名为“eclipse”的目录结尾

2.  在这个 Eclipse 中，应该是名为 plugins 的目录，

3.  将所有 jars 放在 plugins 目录中

4.  创建一个启动器，它使用额外的命令行启动 eclipse：

> -vmargs -Dorg.eclipse.equinox.p2.reconciler.dropins.directory=AbsolutePath\eclipse

可能还想添加`-clean`..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T08:19:12.153

正如在[ECLIPSE_HOME/plugins 以外的目录中安装 Eclipse (3.4+) 插件中](https://stackoverflow.com/questions/582391/installing-eclipse-3-4-plugins-in-a-directory-other-than-eclipsehome-plugins)提到的，正确的方法是定义一个**[捆绑池](http://ekkes-corner.blogspot.com/2008/06/eclipse-ganymede-p2-shared.html)**（也[介绍了这里](http://wiki.eclipse.org/Equinox_p2_Getting_Started#Bundle_pooling)）

![替代文字](https://2.bp.blogspot.com/_Xv6Yjx9z9no/SGftQroKv6I/AAAAAAAAAJc/JcPTai4GhiU/s400/p2+shared+verzeichnisse.png)

有关详细信息，请参阅[我之前的答案。](https://stackoverflow.com/questions/582391/installing-eclipse-3-4-plugins-in-a-directory-other-than-eclipsehome-plugins/582430#582430)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T08:14:13.913

空间不是什么大问题，用户可以将eclipse的系统安装复制到一个工作目录中，并在该`dropins/`目录中放置额外的插件/功能。

# jsp - JSP - 使用 src "num%C2%B2.jpg" 显示图像

> ID：680653
> 
> 赞同：1
> 
> 时间：2009-03-25T08:15:31.553
> 
> 标签：jsp

我创建了一个静态 jsp 页面，其 src 设置为**num%C2%B2.jpg**（图像的实际名称是**num².jpg**）但是 apache 无法找到图像..

我搜索了一个示例应用程序并找到了一个图片库 - [https://jgallery.dev.java.net/](https://jgallery.dev.java.net/) 但即使是这个应用程序也因**num².jpg而中断**

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T08:53:52.790

使用`<@page encoding>`标记（或 <% response.setCharacterEncoding %> in ）您的 JSP 将编码更改为拉丁语 1 或您的 Apache 期望的任何内容。

但是，这可能会破坏您页面上的一些其他字符（在所选字符集之外）。

编辑：或者，在将 URL 插入 JSP 之前对其进行 URL 编码。或者可以使用`java.net.URLEncoder`JSTL来做到这一点。`<c:url>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-31T09:36:33.650

我必须在 apache tomcat 下 server.xml 的连接器设置中添加 URIEncoding="UTF-8"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T08:41:42.630

如您所见，**²**已被编码为两个字符 - **%C2%B2**。这意味着您可能正在使用 unicode 对文件名进行编码。您需要确保当您从文件系统读回文件时，也使用了 unicode。

我不是 java 程序员，所以我可以帮助你，但这绝对是一个编码问题。您可以在对它进行 url 编码之前尝试将其转换为 ASCII...

一个快速的测试是将“num%B2.jpg”放在你的地址栏中，看看它是否有效。

# c# - 使用 C#、.NET Framework 2 读取 IPTC 信息

> ID：680654
> 
> 赞同：4
> 
> 时间：2009-03-25T08:15:41.057
> 
> 标签：c#, iptc

是否有可能使用 C# 和 .NET Framework 2 读取图片的 IPTC 信息？

我还没有找到任何解决方案。只有使用 .NET Framework 3.0 或 .NET 3.5 才能做到。

任何帮助，任何信息？

非常感谢德国！斯蒂芬

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T11:29:49.433

好的，我之前的回答有点“困惑”。这是一个 .NET 2.0 项目（Visual Studio 2008 SLN 格式）的链接，它提供了一些基本的“提取”功能[MetaExtractor ZIP (25Kb)](http://deepzoompublisher.com/TagUpdater/MetaExtractor_v0.1.zip)

代码片段：

```
// The Parser class extracts the data to hardcoded properties.
// it's 1200 lines - too many to post on StackOverflow
JpegParser parser = new JpegParser(path);
if (parser.ParseDocument())
{
    Console.WriteLine("Parsed {0} {1}", System.IO.Path.GetFileName(path), parser.Title);
    Console.WriteLine("Tags: {0}", parser.KeywordString);
    Console.WriteLine("Description: {0}", parser.Description);
    Console.WriteLine("Title: {0}", parser.Title);
    Console.WriteLine("Rating: {0}", parser.Rating);
} 
```

用法：

```
MetaExtractor "C:\Users\Craig\Pictures\anton-1.jpg" 
```

输出：

```
 == DeepZoomPublisher MetaExtractor v0.1 ==
Parsed anton-1.jpg Beach Photo
Tags: beach, blue sky
Description: Anton
Title: Beach Photo
Rating: 3

Press any key to exit... 
```

希望这比我以前的回答更有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-11T17:05:52.940

我意识到这个答案没有解决 .NET 框架 v2，但我认为对于那些使用 .NET 3.5 或更高版本的人来说，值得记录。这可能也适用于 3.0，但我没有在那里测试过。

以下函数调用将返回嵌入在 JPEG 图像中的关键字：

```
 private string[] GetKeywords(string filespec)
    {
        BitmapDecoder decoder = new JpegBitmapDecoder(new FileStream(filespec, FileMode.Open), BitmapCreateOptions.None, BitmapCacheOption.None);
        BitmapMetadata meta = (BitmapMetadata)decoder.Frames[0].Metadata;
        return meta.Keywords.ToArray<string>();
    } 
```

BitmapDecoder 和 BitmapMetadata 类包含在 WPF 中通常使用的程序集中，因此您需要引用以下程序集才能使用这些类：

*   演示核心
*   视窗基地

我在 WinForm 应用程序中成功使用了这种方法，但我怀疑它可以适用于其他应用程序类型。此外，您可以看到此示例中的抽象“BitmapDecoder”类被分配了一个 JpegBitmapDecoder 实例，但您可以为您的图像类型获取另一个解码器的实例（也支持 TIFF、GIF、PNG、BMP 和 WMP）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T22:09:47.133

斯蒂芬，

这两个链接应该很有用

[从 JPEG 读取 XMP 元数据](http://www.shahine.com/omar/ReadingXMPMetadataFromAJPEGUsingC.aspx)

[EXIF 提取器（在 CodeProject 上）](http://www.codeproject.com/KB/graphics/exifextractor.aspx)

它们都访问 JPEG 标头的略有不同的部分，以提取可以嵌入的各种元数据。我在[Searcharoo（您可以下载）](http://searcharoo.codeplex.com/)中使用了他们的代码，并为这个[DeepZoom 示例](http://conceptdev.blogspot.com/2009/03/silverlight-virtualearth-map-control_23.html)从 JPEG 中提取纬度/经度。

`JpegParser.cs`您可以从这个[13kb 代码 ZIP](http://www.deepzoompublisher.com/TagUpdater/TagUpdater_v0.1_src.zip)中获取我的课程- 它仅获取几个属性（标题/描述/关键字/评级/纬度-经度），但您应该能够在代码中看到提取更多内容的位置 == 请参阅下面的编辑==

**注意：**辛勤工作都是由上面链接的两篇文章的作者完成的。

**编辑：**下面的评论突出显示我上面提到的脸包括对and`JpegParser.cs`的引用。这些是作为（未完成的）增强功能的一部分添加的，因此可以安全地删除它们，然后该类应该在 2.0 中运行（尽管包含的项目不会 - 抱歉造成混淆）。`using System.Windows.Media.Imaging;``BitmapImage img = new BitmapImage(new Uri(filename));``JpegParser.cs`

或者，您可以从 Searcharoo 中的 JpegDocument.cs 类中获得类似的代码（需要进行一些编辑）[-](http://searcharoo.codeplex.com/)[一个](http://searcharoo.codeplex.com/SourceControl/changeset/view/20374#490868)索引文件（包括 JPEG）的 .NET 2.0 应用程序，例如这个[搜索结果](http://searcharoo.net/Search.aspx?searchfor=New%20York)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-06T14:07:29.397

我刚刚搜索了几乎整个网络以找到提取 IPTC 信息的 C# 解决方案，并在 Code Project 中找到了这个不错的全新教程：

[http://www.codeproject.com/KB/graphics/ReadingIPTCAPP14.aspx](http://www.codeproject.com/KB/graphics/ReadingIPTCAPP14.aspx)

希望它可以帮助某人。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T15:25:37.497

如果它是在 3.x 中实现的，那么它在早期版本中是不存在的。

但是，有 3rd 方库可以做到这一点。 [ImageMagick](http://www.imagemagick.org/script/index.php)就是其中之一。如果您正在寻找更简单（且免费）的实现，这篇[文章](http://www.codeproject.com/KB/graphics/iptc.aspx)或谷歌搜索可能会引导您找到解决方案。

祝你好运。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-28T16:42:23.253

在尝试了来自这里和其他地方的几个建议后，我决定编写一个类来调用 exiv2 命令行工具。在我的场景中，为每个图像生成一个进程的小性能损失是可以接受的，在其他场景中可能不会。

*   使用 System.Process 调用 exiv2.exe
*   传递参数“-pi filename.jpg”以输出所有 IPTC 字段
*   使用 System.Process.StandardOutput.ReadToEnd() 读取输出；
*   可以使用 Regex 将输出拆分为各个部分

# language-agnostic - IF-ELSE 和 SWITCH 有什么区别？

> ID：680656
> 
> 赞同：33
> 
> 时间：2009-03-25T08:16:44.920
> 
> 标签：language-agnostic, switch-statement, if-statement

有人可以向我解释一下吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-25T08:21:26.987

它们非常相似，但每个都有一些特殊功能。

**转变**

*   `switch`通常比许多嵌套更紧凑`if else`，因此更具可读性
*   如果你省略了`break`两个 switch case 之间的情况，你可以在许多类似 C 的语言中陷入下一个 case。`if else`你需要一个（这对`goto`你的读者来说不是很好......如果语言完全支持`goto`的话）。
*   在大多数语言中，`switch`只接受原始类型作为键和常量作为案例。这意味着编译器可以使用非常快的跳转表对其进行优化。
*   目前还不清楚如何`switch`正确格式化。从语义上讲，这些案例是`goto`应该向左对齐的跳转目标（如 的标签）。当你有花括号时，情况会变得更糟：

    ```
    case XXX: {
    } break; 
    ```

    或者大括号应该进入自己的行？右大括号应该放在后面`break`吗？那会有多难读？等等

*   在许多语言中，`switch`只接受某些数据类型。

**如果别的**

*   `if`允许条件中的复杂表达式，而 switch 需要一个常量
*   您不会不小心忘记`break`between `if`s 但您可以忘记 the `else`(尤其是在 cut'n'paste 期间)
*   它接受所有数据类型。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-05-12T10:12:42.163

主要区别在于*立即*`switch`发送给相关人员，通常通过索引跳转，而不是必须评估链中所需的所有条件，这意味着到达链末端的代码比到达链末端的代码更慢开始。*`case``if-else`*

 *这反过来又对链没有的`switch`语句施加了一些限制：它不能处理所有数据类型，并且所有值都必须是常量。`if-else``case`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-03-20T16:28:16.960

IF else - IT 用于做出决定

Switch 语句 - 用于根据案例值列表测试给定变量的值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-09-13T16:23:18.210

if-else 和 switch 的区别

1.  if 语句内的表达式决定是执行 if 块内的语句还是 else 块下的语句。另一方面，switch 语句中的表达式决定执行哪种情况。

2.  if-esle 语句检查是否相等以及逻辑表达式。另一方面， switch 只检查是否相等。

3.  if 语句计算整数、字符、指针或浮点类型或布尔类型。另一方面，switch 语句只计算字符或整数数据类型。

4.  执行顺序就像 if 块下的语句将执行或 else 块语句下的语句将执行。另一方面，switch 语句中的表达式决定执行哪个 case，如果您不在每个 case 之后应用 break 语句，它将执行到 switch 语句结束。

5.  如果 if 中的表达式结果为 false，则将执行 else 块中的语句。如果 switch 语句中的表达式结果为假，则执行默认语句。

6.  很难编辑 if-else 语句，因为跟踪需要更正的位置很繁琐。另一方面，很容易编辑 switch 语句，因为它们很容易跟踪。

总之，我们可以说 switch 的行为比 if else 语句快一点！！！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-05T12:02:45.463

Switch 和 if-else 语句的区别如下：

这是 if-else 阶梯的一般语法：

```
if (condition1) { //Body of if }
    else if (condition2) { //Body of if }
    else if (condition3) { //Body of if }
else { //default if all conditions return false } 
```

这是 switch 的一般语法：

```
switch ( variable )
{
 case <variable value1>: //Do Something
                                             break;
 case <variable value2>://Do Something
                                             break;
 default: //Do Something
                break;
} 
```

if-else 阶梯属于严格条件检查类型，而 switch 属于跳转值捕获类型。

切换 if-else 阶梯的优点：

*   switch 语句的运行速度比等效的 if-else 阶梯要快得多。这是因为编译器在编译过程中为一个开关生成了一个跳转表。因此，在执行过程中，它不会检查满足哪种情况，而只是决定必须执行哪种情况。
*   与 if-else 语句相比，它更具可读性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-02T17:10:36.470

明显的区别：

*   该`if...else`语句检查括号中的*条件*`true`是否计算为或`false`
*   该语句检查括号中的*值*与关键字的*值*`switch`是否相等。**`case``true`**

 **## 例子

```
var a  = 'hello' 
```

### 示例 - 如果...否则

```
if(a == 'hello') {
  print('right!')
} else if (a == 'hi')
  print('left!')
} else {
  print('wrong!')
} 
```

### 示例 - 开关

```
switch(a) {
  case 'hello': // a == 'hello'
    print('right!')
    break // You should add this
  case 'hi': // a == 'hi'
    print('left!')
    break
  default: // this executes if no equality was met in the values above.
    print('wrong!')
}

// If you are not sure of either of the parenthesis value or the
// case value or you want to make more complex conditioning, you can use `true`:

var age = 18:
switch(true) {
  case age < "18": // 18 < 18 == false
    print("under age!");
    break;
  case age == 18: // 18 == 18 == true
    print("right age!");
    break;
  default:
    print("18+!");
} 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-09-01T10:46:31.750

我认为主要区别在于，在 if-else 块中我们可以测试条件。但在 switch 中并不完全相同

# c++ - 如何延迟 C++ 基类中成员的初始化，直到派生类的ctor被执行？

> ID：680672
> 
> 赞同：0
> 
> 时间：2009-03-25T08:24:55.150
> 
> 标签：c++

这是场景：我想定义一个基类，为所有派生类分配一次缓冲区，而缓冲区的大小因不同派生类而异。我可以通过这种方式实现它：

```
class base
{
public:
     base():size(), p_array(0){}
private:
     size_t size;
     boost::shared_array<unsigned char> p_array;

}; 
```

在派生类中：

```
class derived
{
public:
     derived(size_t array_size):size(array_size)
     {
          p_array.reset(new unsigned char[size]);
     }    
}; 
```

但是，为了简化派生类的设计，我真的很想把这行：

```
p_array.reset(new unsigned char[size]); 
```

到基类的某个地方，因此只写一次。是否有任何 C++ 设计模式可以实现它？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T08:35:51.397

抱歉，为什么你有 2 个数组（和 2 个大小）？现在，如果你创建一个派生类，你有一个 2 倍的 p_array。我认为编译器应该对此给出错误。

你不想要这个吗？

```
class base
{
public:
     base():size(), p_array(0){}
     base(size_t array_size):size(array_size)
     {
          p_array.reset(new unsigned char[size]);
     }
private:
     size_t size;
     boost::shared_ptr<unsigned char> p_array;

};

class derived
{
public:
     derived(size_t array_size):base(array_size)
     {
     }
private:
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T08:39:28.550

您可以将大小传递给基类的构造函数：

```
class base
{
   base(size_):size(size_), p_array(new char[size_]) {}
} 
```

您的派生类决定了大小，尽管它需要在基础构造时知道它：

```
class largebufferderived : public base
{
   public:
     largebufferderived() : base(77220) {}
} 
```

* * *

或者您可以按需初始化缓冲区（在多线程场景中这并不总是一个好主意）：

```
boost::shared_ptr<char> Buffer() 
{
   if (!p_Array)
     p_array.reset(new unsigned char[size]);
} 
```

在基类中将 p_Array 设为私有，因此派生类只能通过 Buffer() 访问。

* * *

或者，只需添加一个“FinalConstruct”方法来调用派生类构造函数。Thi 并没有避免调用它，但至少隔离了在调用所有构造函数之后需要做什么。

顺便提一句。为什么 shared_ptr，而不是 shared_array？

# windows - 如何断开Windows远程目录？

> ID：680675
> 
> 赞同：1
> 
> 时间：2009-03-25T08:26:20.920
> 
> 标签：windows, networking, smb

我正在编写一个程序来监视远程目录，并且我使用 Windows API：WNetAddConnection。我用它来映射远程目录到 Z: 通过使用指定的用户/密码。

我把这个程序放到工作环境后，有人用explorer location "\192.168.XX\somedir" 登录了我监控的同一个目录，导致我的程序无法连接到这个目录，所以我不得不请这个人不要做这件事，但我不能强迫他们不做。

所以我想知道是否有办法断开所有其他连接，或者证明他们这样做，有人知道吗？

顺便说一句，我不是windows专家，我不知道windows网络的细节（或者这个bug的真正含义），谁能告诉我windows网络的文档在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T08:35:10.680

```
WNetCancelConnection2 
```

但这并不是对人最友好的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-27T15:42:55.427

丑陋的选择：

您可以解析“net use”的输出，然后使用“net use /d”断开您不喜欢的连接

（[WNetCancelConnection2](http://msdn.microsoft.com/en-us/library/aa385427(VS.85).aspx)似乎是 net use /d 使用的 API）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T15:37:00.137

不确定 API，但 net session /delete 会将所有打开的会话断开到共享。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-31T07:41:52.300

可以按照以下步骤进行： 1、运行命令删除所有net用户和密码，命令为：rundll32.exe shell32.dll,Control_RunDLL keymgr.dll 2、删除所有net用户信息内存使用顺序： `net use * /delete /y` 或者您可以创建一个包含以下信息的 bat 文件：

```
@echo off
rundll32.exe shell32.dll,Control_RunDLL keymgr.dll
net use * /delete /y
net use * /delete /y
net use * /delete /y
net use * /delete /y
net use * /delete /y
net use * /delete /y

net use
net use
net use

net use * /delete /y
net use * /delete /y
net use * /delete /y
net use * /delete /y
net use * /delete /y
net use * /delete /y 
```

# c++ - 12 位唯一 ID - 代码可靠性

> ID：680683
> 
> 赞同：0
> 
> 时间：2009-03-25T08:32:09.673
> 
> 标签：c++, unique, uniqueidentifier

我想要一个在一天（24 小时）内保持唯一的号码。以下是我想出的代码；我想知道它的谬误/可能的风险；“我相信”这保证了至少一天的 12 位唯一编号。

逻辑是获取当前日期/时间（hhmmssmmm）并连接查询性能计数器结果的前四个字节。

```
__forceinline bool GetUniqueID(char caUID[MAX_STRING_LENGTH])
{
    //Logic: Add HHMMSSmmm with mid 3 bytes of performance counter.
    //Guarantees that in a single milli second band (0 to 999) the three bytes 
    //of performance counter would always be unique.
    //1\. Get system time, and use
    bool bStatus = false;
    try
    {

        SYSTEMTIME localtime;
        GetLocalTime(&localtime);//Get local time, so that we may pull out HHMMSSmmm

        LARGE_INTEGER li;
        char cNT[MAX_STRING_LENGTH];//new time.
        memset(cNT, '\0', sizeof(cNT));
        try
        {
            //Try to get the performance counter,
            //if one is provided by the OEM.

            QueryPerformanceCounter(&li);//This function retrieves the current value of the 
                                         //high-resolution performance counter if one is provided by the OEM
                                         //We use the first four bytes only of it.
            sprintf(cNT, "%u", li.QuadPart);
        }
        catch(...)
        {
            //Not provided by OEM.
            //Lets go with the GetTickCounts();
            //ddHHMMSS + 4 bytes of dwTicks
            sprintf(cNT,"%04d", GetTickCount());
        }

        //Get the first four bytes.
        int iSkipTo     = 0;//This is incase we'd decide to pull out next four bytes, rather than first four bytes.
        int iGetChars   = 4;//Number of chars to get.
        char *pSub = (char*) malloc(iGetChars+1);//Clear memory
        strncpy(pSub, cNT + iSkipTo, iGetChars);//Get string
        pSub[iGetChars] = '\0'; //Mark end.

        //Prepare unique id
        sprintf(caUID, "%02d%02d%02d%3d%s", 
                                    localtime.wHour, 
                                    localtime.wMinute, 
                                    localtime.wSecond, 
                                    localtime.wMilliseconds, 
                                    pSub); //First four characters concat.

        bStatus = true;
    }
    catch(...)
    {
        //Couldnt prepare. There was some problem.
        bStatus = false;
    }

    return bStatus;
} 
```

以下是我得到的输出：

唯一：[125907 462224] 唯一：[125907 462225] 唯一：[125907 462226] 唯一：[125907 462227] 唯一：[125907 462228] 唯一：[125907 462230] 唯一：[125907 4627431] 唯一：[23] 唯一：[12590] [125907 462233] 唯一：[125907 462234] 唯一：[125907 462235] 唯一：[125907 462237] 唯一：[125907 462238] 唯一：[125907 462239] 唯一：[125907 462240] 唯一：[1259125] 唯一：[1259125] 462243] 唯一：[125907 462244] 唯一：[125907 462245] 唯一：[125907 462246] 唯一：[125907 462247] 唯一：[125907 462248] 唯一：[125907 462249] 唯一：[1225907 460272562]唯一：[125907 462253] 唯一：[125907 462254] 唯一：[125907 462255] 唯一：[125907 462256] 唯一：[125907 462257] 唯一：[125907 462258] 毫秒改变，46 唯一：[125907 62027261] 622262] 唯一：[125907 622263] 唯一：[125907 622264] 唯一：[125907 622265] 唯一：[125907 622267] 唯一：[125907 622268] 唯一：[125907 622269] 唯一：[125907 622270] 唯一：[125907 622271] 唯一：[125907 622273] 唯一：[125907 622274] 唯一：[1259125]6275] 622276] 唯一：[125907 622277] 唯一：[125907 622278] 唯一：[125907 622279] 唯一：[125907 622281] 唯一：[125907 622282] 唯一：[125907 622283] 唯一：[1225907 62027264]独特：[125907 622286] 独特：[125907 622288] 独特：[125907 622289] 独特：[125907 622290] 独特：[125907 622291] 独特：[125907 622292] 独特：[125907 6227293] 独特：[12590] 独特：[12590] [125907 622296] 唯一：[125907 622297] 唯一：[125907 622298] 唯一：[125907 622299] 唯一：[125907 622300] 唯一：[125907 622301] 唯一：[125907 622302] 唯一：[1259125] 唯一：[125912] 622305] 唯一：[125907 622306] 毫秒更改，62 唯一：[125907 782308] 唯一：[125907 782310] 唯一：[125907 782311] 唯一：[125907 782312] 唯一：[125907 782313] 唯一：[125907 782314] 唯一：[125907 782316] 唯一：[125907 782317] 唯一：[1259125] 唯一：[125912] 782319]毫秒改变，125个独特：[1259071402495]唯一：[1259071402497]唯一：[1259071402498]唯一：[1259071402499]独特：[1259071402500]独特：[1259071402502]独特：[1259071402503]独特：[1259071402504]独特：[1259071402504 ] 唯一：[1259071402507][1259071402504] 唯一：[1259071402505] 唯一：[1259071402507][1259071402504] 唯一：[1259071402505] 唯一：[1259071402507]

现在我正在考虑将生成的 ID 保存在一个列表中，并将新生成的 ID 与列表中的现有 ID 进行比较。如果它已经存在于列表中，那么我当然可以跳过这个数字并生成另一个，但当然很明显这个逻辑会失败。

非常感谢您的意见/建议/更新/等。

谢谢JT。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T08:39:47.080

如果您是在单核处理器上的一台机器上运行它，那么逻辑对我来说似乎是合理的。但是，我不知道对于连续调用的多核处理器是否同样适用。但是，生成的数字在机器之间肯定不会是唯一的。

出于好奇，您是否有理由不使用 GUID？

或者，既然您正在考虑将生成的 ID 保存在一个列表中进行比较，为什么不能创建一个生成器？由于您建议存储是一种选择，如果您存储最后使用的数字并在每次使用时增加它......您甚至可以存储日期并根据需要每天重置计数器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T08:43:12.283

我的解决方案是获取系统时间并为其添加一个计数器（伪代码）：

```
static int counter = 0;
static Time lastTime;

String getNextId() {
    Time now = System.getTime();
    if (lastTime == now)
        counter ++;
    else
        counter = 0;
    return now+counter;
} 
```

这将保证即使我更频繁地调用该方法而不是`getTime()`更改时，我也会获得一个新 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T12:55:33.627

我遇到了快速循环中的时间问题，尽管它们应该是常识，但它们没有改变（你无法控制操作系统，所以你不能假设时间每 x 毫秒改变一次等）

将计数器值添加为额外的几位数字（而不是增量）并在重新启动时或在 9999 之后将其重置应该足以隐藏这一点，使其几乎不可能发生（著名的遗言）。

然后格式是 TTTTTToooo，其中 T 是您的时间数字和 o 您的 4 位偏移量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-03T05:34:10.040

Aaron：谢谢你的评论，我用你的方法得到了我想要的。

```
__forceinline bool GetUniqueIDEx(char caUID[MAX_STRING_LENGTH])
{
    //Logic: Add HHMMSSmmm with 3 bytes counter.
    //Guarantees a unique number for a calendar date, 
    //that in a single milli second band (0 to 999) the three bytes 
    //of counter would always be unique.
    //1\. Get system time, and use

    bool bStatus = false;
    try
    {
        GetLocalTime(&localtime);//Get local time, so that we may pull out HHMMSSmmm

        char cNT[MAX_STRING_LENGTH];//new time.
        memset(cNT, '\0', sizeof(cNT));
        if(m_nCounter> MAX_COUNTER_LIMIT)
        {
            m_nCounter= 0;
        }

        sprintf(cNT, "%03d", ++m_nCounter);

        //Prepare unique id
        sprintf(caUID, "%02d%02d%02d%03d%s", 
                                            localtime.wHour, 
                                            localtime.wMinute, 
                                            localtime.wSecond, 
                                            localtime.wMilliseconds, 
                                            cNT); 

        bStatus = true;
    }
    catch(...)
    {
        //Couldnt prepare. There was some problem.
        bStatus = false;
    }

    return bStatus;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T02:27:16.690

我会使用午夜后的秒数，然后使用计数器。这可以为您提供高达每秒一千万次点击。应该很独特。使用上面 Aaron 的代码，您可以将字符串格式化为：

```
sprintf(idstr, "%05d%07d", secs_since_midnight, counter); 
```

当然，当您真的想将计数器塞入几个可打印字符（以及一年中的某天而不是月/日等）时，我也坚信使用 base-36（通过 itoa）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-11T18:17:51.940

我不确定您的流程是否可以牺牲微小的性能问题并保持逻辑简单。

如果您在两次调用之间让您的进程休眠 1 毫秒，我们可以保证 HHMMSSmmm 格式本身的唯一编号。通过这种方式，您可以消除连接部分以及您必须维护的列表以仔细检查唯一性。

Manikanthan Velayutham // 编程思考大

# multicore - 多CPU、多核和超线程有什么区别？

> ID：680684
> 
> 赞同：87
> 
> 时间：2009-03-25T08:32:23.433
> 
> 标签：multicore, smp, hyperthreading

谁能向我解释多 CPU、多核和超线程之间的区别？我总是对这些差异以及每种架构在不同场景中的优缺点感到困惑。

以下是我在网上学习和借鉴别人的评论后目前的理解。

1.  我认为超线程是其中最劣质的技术，但价格便宜。它的主要思想是重复寄存器以节省上下文切换时间；
2.  多处理器比超线程好，但是由于不同的CPU在不同的芯片上，不同CPU之间的通信比多核延迟更长，使用多芯片比多核成本和功耗更高;
3.  多核将所有 CPU 集成在一个芯片上，因此与多处理器相比，不同 CPU 之间的通信延迟大大降低。由于它使用单个芯片来包含所有 CPU，因此与多处理器系统相比，它消耗的功率更少且成本更低。

它是否正确？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-03-25T08:39:23.650

多 CPU 是第一个版本：您将拥有一个或多个主板，上面有一个或多个 CPU 芯片。这里的主要问题是 CPU 必须将它们的一些内部数据暴露给另一个 CPU，这样它们就不会妨碍它们。

下一步是超线程。主板上的一个芯片，但它内部有一些部件两次，因此它可以同时执行两条指令。

目前的发展是多核。它基本上是最初的想法（几个完整的 CPU），但在一个芯片中。优势：芯片设计人员可以轻松地将同步信号的附加线放入芯片中（而不必将它们布线在一个引脚上，然后穿过拥挤的主板并向上进入第二个芯片）。

今天的超级计算机是多 CPU、多核的：它们有很多主板，上面通常有 2-4 个 CPU，每个 CPU 都是多核的，每个 CPU 都有自己的 RAM。

[编辑] 你说得很对。只是几个小点：

*   超线程在单个内核中同时跟踪两个上下文，从而为乱序 CPU 内核提供更多并行性。即使一个线程因缓​​存未命中、分支错误预测或等待高延迟指令的结果而停滞，这也可以使执行单元保持工作。这是一种无需复制太多硬件即可获得更多总吞吐量的方法，但如果有的话，它会单独减慢每个线程。 [有关更多详细信息，请参阅此问答](https://stackoverflow.com/questions/35748305/is-duplication-of-state-resources-considered-optimal-for-hyper-threading)，以及对本段先前措辞的错误解释。

*   多 CPU 的主要问题是在它们上运行的代码最终会访问 RAM。有 N 个 CPU，但只有一条总线可以访问 RAM。所以你必须有一些硬件来确保 a) 每个 CPU 获得相当数量的 RAM 访问，b) 访问 RAM 的同一部分不会导致问题，c) 最重要的是，CPU 2 将被通知当 CPU 1 写入 CPU 2 在其内部缓存中的某个内存地址时。如果这没有发生，CPU 2 将愉快地使用缓存的值，而不会注意到它已经过时的事实

    想象一下，您有一个列表中的任务，并且您想将它们分散到所有可用的 CPU 上。因此 CPU 1 将从列表中获取第一个元素并更新指针。CPU 2 也会这样做。出于效率原因，两个 CPU 不仅会将少数字节复制到缓存中，还会复制整个“缓存行”（无论是什么）。假设是，当您读取字节 X 时，您很快也会读取 X+1。

    现在两个 CPU 在它们的缓存中都有一份内存副本。然后 CPU 1 将从列表中获取下一个项目。如果没有缓存同步，它不会注意到 CPU 2 也更改了列表，并且它将开始与 CPU 2 处理相同的项目。

    这就是有效地使多 CPU 如此复杂的原因。这样做的副作用可能会导致性能比整个代码仅在单个 CPU 上运行时所获得的性能更差。解决方案是多核的：您可以轻松添加任意数量的线来同步缓存；您甚至可以将数据从一个缓存复制到另一个（更新缓存行的*一部分*而无需刷新和重新加载它）等。或者缓存逻辑可以确保所有 CPU 在访问同一部分时获得相同的缓存行真正的 RAM，只是阻塞 CPU 2 几纳秒，直到 CPU 1 做出改变。

[EDIT2] 多核比多 CPU 更简单的主要原因是在主板上，您根本无法在两个芯片之间运行所有需要使同步有效的线路。再加上一个信号只能传播 30 厘米/纳秒的顶部（光速；在电线中，你通常会少得多）。并且不要忘记，在多层主板上，信号开始相互影响（串扰）。我们喜欢认为 0 是 0V，1 是 5V，但实际上，“0”是介于 -0.5V（从 1->0 下降线时过驱动）和 0.5V 之间的值，而“1”是高于 0.8V 的任何值。

如果您将所有东西都放在一个芯片中，则信号运行速度会更快，并且您可以拥有任意数量的信号（嗯，几乎 :)。此外，信号串扰更容易控制。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-25T08:46:51.637

[您可以在英特尔的网站或](http://www.intel.com/cd/ids/developer/asmo-na/eng/200677.htm)[耶鲁大学](http://www.yale.edu/pclt/PCHW/Hyperthreading.htm)的一篇短文中找到一些关于双 CPU、多核和超线程的有趣文章。

我希望你能在这里找到你需要的所有信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T08:40:25.177

简而言之：多CPU或多处理器系统有多个处理器。多核系统是在同一芯片上具有多个处理器的多处理器系统。在超线程中，多个线程可以在同一个处理器上运行（即这些多个线程之间的上下文切换时间非常小）。

多处理器已经存在 30 年了，但主要是在实验室中。多核是新流行的多处理器。如今，服务器处理器与多处理器一起实现了超线程。

关于这些主题的维基百科文章非常具有说明性。

# c# - C# 正则表达式排序字母和数字字符串

> ID：680692
> 
> 赞同：1
> 
> 时间：2009-03-25T08:35:25.500
> 
> 标签：c#, regex

我有一个需要订购的清单说：

```
R1-1
R1-11
R2-2
R1-2 
```

这需要订购：

```
R1-1
R1-2
R1-11
R2-2 
```

目前我正在使用 C# Regex.Replace 方法，并在字符串末尾出现单个数字之前添加一个 0，如下所示：

```
Regex.Replace(inString,@"([1-9]$)", @"0$2") 
```

我确信有一个更好的方法可以做到这一点，我只是想不出来。有没有人有一种用正则表达式对字母和数字字符串进行排序的好方法？

* * *

我已经使用下面 Greg 的方法来完成此操作，只是认为我应该添加我正在使用的代码以确保完整性：

```
public static List<Rack> GetRacks(Guid aisleGUID)
    {
        log.Debug("Getting Racks with aisleId " + aisleGUID);
        List<Rack> result = dataContext.Racks.Where(
                               r => r.aisleGUID == aisleGUID).ToList();
        return result.OrderBy(r => r.rackName, new NaturalStringComparer()).ToList();
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T08:39:28.143

我认为您所追求的是自然排序顺序，就像 Windows 资源管理器一样？如果是这样，那么我不久前写了一篇博客文章，展示[了如何在几行 C# 中实现这一点](http://gregbeech.com/blog/natural-sort-order-of-strings-and-files)。

注意：我刚刚检查并使用`NaturalStringComparer`链接条目中的 确实返回了您使用示例字符串查找的顺序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T08:48:39.697

您可以编写自己的比较器并使用正则表达式先比较“R”和“-”之间的数字，然后再比较“-”后面的数字，如果第一个数字相等。

草图：

```
public int Compare(string x, string y)
{
    int releaseX = ...;
    int releaseY = ...;
    int revisionX = ...;
    int revisionY = ...;

    if (releaseX == releaseY)
    {
        return revisionX - revisionY;
    }
    else
    {
        return releaseX - releaseY;
    }
} 
```

# c# - C# WPF 自定义控件在设计时不响应 XAML 属性？

> ID：680694
> 
> 赞同：2
> 
> 时间：2009-03-25T08:36:07.230
> 
> 标签：c#, wpf, user-controls, properties, dependencies

我创建了一个 UserControl，它本质上是一个按钮。它上面有一个图像和一个标签，我创建了两个属性来设置图像的源和标签的文本，如下所示：

```
 public ImageSource Icon
    {
        get { return (ImageSource)this.GetValue(IconProperty); }
        set { this.SetValue(IconProperty, value); icon.Source = value; }
    }
    public static readonly DependencyProperty IconProperty = DependencyProperty.Register("Icon", typeof(ImageSource), typeof(NavigationButton));

    public string Text
    {
        get { return (string)this.GetValue(TextProperty); }
        set { this.SetValue(TextProperty, value); label.Content = value; }
    }

    public static readonly DependencyProperty TextProperty = DependencyProperty.Register("Text", typeof(string), typeof(NavigationButton)); 
```

但是，当我将控件添加到我的页面时，控件不会响应我在 XAML 中设置的任何属性，例如`<controls:MusicButton Icon="/SuCo;component/Resources/settings.png/>`什么也不做。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T09:25:30.437

包装依赖属性的 CLR 属性不应该*有*任何逻辑，除了调用`GetValue`and `SetValue`。那是因为他们甚至可能不会被调用。例如，XAML 编译器将通过直接调用`GetValue`/`SetValue`而不是使用您的 CLR 属性进行优化。

如果您需要在更改依赖项属性时执行一些逻辑，请使用元数据：

```
public ImageSource Icon
{
    get { return (ImageSource)this.GetValue(IconProperty); }
    set { this.SetValue(IconProperty, value); }
}

public static readonly DependencyProperty IconProperty = DependencyProperty.Register("Icon", typeof(ImageSource), typeof(NavigationButton), new FrameworkPropertyMetadata(OnIconChanged));

private static void OnIconChanged(DependencyObject dependencyObject, DependencyPropertyChangedEventArgs e)
{
    //do whatever you want here - the first parameter is your DependencyObject
} 
```

**编辑**

在我的第一个答案中，我假设您的控件的 XAML（无论是来自模板还是直接在 UserControl 中）已正确连接到属性。您没有向我们展示 XAML，因此这可能是一个不正确的假设。我希望看到类似的东西：

```
<StackPanel>
    <Image Source="{Binding Icon}"/>
    <TextBlock Text="{Binding Text}"/>
</StackPanel> 
```

而且 - 重要的是 - 您的 DataContext 必须设置为控件本身。您可以通过各种不同的方式执行此操作，但这里有一个从后面的代码设置它的非常简单的示例：

```
public YourControl()
{
    InitializeComponent();
    //bindings without an explicit source will look at their DataContext, which is this control
    DataContext = this;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T08:53:35.987

您是否也尝试过设置 text 属性？图像的来源可能是错误的。文本更直接。

另外，在您的示例中，您错过了引号。因此，如果它是从您的真实代码中复制的，您可能需要检查一下。

除了那些公认的不太可能导致您的问题的次要原因，我建议在代码中设置属性以检查这是否有任何影响。如果有，那么你真的应该检查你的 XAML。

由于您尚未发布其余代码，因此我无法确定您是否在其他地方遇到了可能影响控件的问题。

是的，我知道我不是很有帮助，但我使用 WPF 只工作了一段时间。无论如何，希望它有所帮助。

# animation - 动画和逻辑

> ID：680695
> 
> 赞同：7
> 
> 时间：2009-03-25T08:36:46.387
> 
> 标签：animation

我有一个问题不一定特定于任何平台或 API，而是更特定于动画之间的代码交互。

游戏就是一个很好的例子。假设玩家死亡，并且有一个死亡动画必须在对象被移除之前完成。这在许多情况下很典型，其中一些动画必须在继续执行通常遵循的任何动作之前完成。你会怎么做呢？

我的问题是关于动画的控制和逻辑。您将如何设计一个能够驱动动画但同时实现自定义行为的系统？

通常出现的问题是游戏逻辑和动画数据变得相互依赖。也就是说，动画必须回调到代码中或以某种方式包含动画序列持续时间的元数据。通常更严重的问题是，当必须触发一些其他代码的动画时，比如在 1.13 秒后生成自定义精灵时，这往往会导致代码和动画的深度嵌套。带有计时器的炸弹将是逻辑和动画两者相互作用的例子，但我想让它们尽可能分开。

但是你会怎么做才能保持动画和编码两个独立的东西呢？

*最近我一直在尝试 mgrammar，我在想，DSL 可能是要走的路。这将允许动画或动画师以一种可能安全的方式表达某些事物，然后进入内容管道......*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-31T07:55:08.700

解决方案取决于您要玩的游戏。如果游戏玩法是 100% 代码驱动的，则动画由实体的状态驱动（状态驱动动画）。如果它是图形/动画驱动的，则动画长度决定了实体处于该状态（动画驱动状态）的时间长度。

后者在商业生产环境中通常更灵活，因为设计师可以说“我们需要让死亡动画更短”，然后就可以协商了。但是当你有非常精确的规则或像物理这样的模拟系统时，状态驱动的动画可能更可取。对于一般情况，没有 100% 正交且干净的解决方案。

有助于防止它变得*过于*混乱的一件事是考虑游戏 AI 模式：

游戏 AI 通常实现为某种形式的有限状态机，可能是多个状态机或以某种方式分层（最常见的划分是具有低级动作/转换的高级脚本格式）。

在低级别，您可以说“在hitreact 状态下，播放我的hitreact 动画直到它完成，然后从高级别逻辑中找出要从哪个状态继续”。在高层次上，有很多方法可以定义逻辑，但是像“接近/攻击/撤退”这样的简单重复循环是一个很好的开始方式。

这有助于防止两种行为——计划的活动和对新事件的反应——过于混合。同样，在实践中并不总是这样，原因与有时您希望代码驱动数据或相反的原因相同。但这对你来说就是人工智能。这里没有通用解决方案！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-26T01:27:24.960

我认为您应该将渲染与游戏逻辑分开。

您至少有两种不同类型的对象：

*   保存单位数据（生命值、位置、速度、力量等）和逻辑（它应该如何移动，如果生命值用完会发生什么……）的实体。
*   它的表示，即精灵、颜色、附着在它上面的粒子、声音等等。表示可以访问实体数据，因此它知道位置、命中点等。
*   如果实体可以由人类或人工智能直接控制（如汽车模拟中的汽车），则可能是控制器。

是的，这听起来像是模型-视图-控制器架构。有很多关于这方面的资源，请参阅deWiTTERS 的[这篇文章](http://dewitters.koonsolo.com/gamemvc.html)或Jorrit Rouwé[的 The Guerrilla Guide to Game Code](http://www.gamasutra.com/features/20050414/rouwe_01.shtml)，以获取特定于游戏的示例。

关于你的动画问题：对于一个垂死的单位，当模型更新它的实体并发现它没有更多的生命值时，它可以设置一个标志来表示它已经死了，并将实体从游戏中（以及从内存中）移除。稍后，当 View 更新时，它会读取标志并启动垂死动画。但是由于实体对象应该消失，因此很难决定将这个标志存储在哪里。

我谦虚的恕我直言，有更好的方法。当您的实体死亡时，您可以向注册到属于该特定实体的 UnitDiedEvent 的所有侦听器发送一个事件，然后从游戏中移除该实体。实体表示对象正在侦听该事件，其处理程序启动垂死动画。当动画结束时，实体表示终于可以被移除了。

[观察者设计模式](http://en.wikipedia.org/wiki/Observer_pattern)在这里很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T16:19:39.170

你的敌人需要有多个状态。活着和死去是不够的。活着、死去和死去都可能。你的敌人处理循环应该检查它的状态并执行不同的操作：

```
if(state == alive and hp == 0)
{
   state = dying
   currentanimation = animation(enemy_death)
   currentanimation.play()
}
elseif(state == dying and currentanimation.isPlaying == true)
{
    // do nothing until the animation is finished.
    // more efficiently implemented as a callback.
}
elseif(state == dying and currentanimation.isPlaying == false)
{
    state = dead
    // at this point either the game engine cleans up the object, or the object deletes itself.
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T09:03:31.470

我想我真的没有看到问题所在。

如果您有一些回调嵌套，我可以理解为什么事情可能难以遵循，但如果您只有一个回调用于所有动画事件和一个更新函数启动动画，那么遵循代码非常容易。

那么，将它们分开可以获得什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-26T01:36:27.607

对于我为解决这个问题而制作的几个游戏，我创建了两个动画类

asyncAnimation - 用于触发和忘记类型的动画

syncAnimation - 如果我想在返回控制之前等待动画解决

由于游戏通常有一个主循环，它看起来像这个 C# 风格的伪代码

```
while(isRunning) 
{

   renderStaticItems();
   renderAsyncAnimations();

   if (list_SyncAnimations.Count() > 0)
   {
       syncAnimation = list_SyncAnimations.First();
       syncAnimation.render();

       if (syncAnimation.hasFinished()) 
       {
           list_SyncAnimations.removeAt(0); 
           // May want some logic here saying if
           // the sync animation was 'player dying' update some variable
           // so that we know the animation has ended and the
           // game can prompt for the 'try again' screen
       }

   }
   else
   {
       renderInput();
       handleOtherLogic(); // Like is player dead, add sync animation if required.
   }
} 
```

因此，代码所做的是维护在继续游戏之前需要解决的同步动画列表 - 如果您需要等待多个动画，只需将它们堆叠起来。

此外，查看命令模式或在同步动画完成处理您的逻辑时提供回调可能是一个好主意 - 这真的是您想要的方式。

至于您的“Spawn at sec 1.13”也许 SyncAnimation 类应该有一个可覆盖的 .OnUpdate() 方法，它可以执行一些自定义逻辑（或调用脚本）

这取决于您的要求可能是什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T12:54:02.820

动画可以调用您提供的回调函数，或将通用事件发送回代码。它不需要更多的东西，它将所有逻辑都保留在代码中。只需在创建动画时注入回调或连接事件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-09T14:30:55.703

我尽可能地避免子动画出现回调。动画应表明它们已完成，应从应用程序的控制器级别调用动画完成所采取的操作。

在 Actionscript 中，这是事件调度/侦听的美妙之处 - 控制器对象可以创建目标，然后为动画在完成时调度的事件分配处理程序。

我已经在 Flash 项目中将这种模式用于几件事，它有助于保持代码的独立性，远远优于回调。

特别是如果您编写扩展 Event 以携带您需要的信息的自定义事件对象。例如带有localX、localY、stageX和stageY的MouseEvent。我使用一个我命名为 NumberEvent 的自定义来广播我的应用程序周围的任何类型的数字信息。

在 actionscript 控制器对象中：

```
var animObj:AwsomeAnim = AwsomeAnim();
animObj.start();
animObj.addEventListener(AwsomeAnim.COPLETE,_onAnimFinish);

function _onAnimFinish():void
{
    // actions to take when animation is complete here
} 
```

在不存在自定义事件的 javascript 中。我只是在动画对象中有一个布尔变量，并在控制器的计时器上检查它。

在 javascript 控制器对象中：

```
var animObj = new animObj();// among other things must set this.isComplete = false
animObj.start();

function checkAnimComplete()
{
    if(animObj.isComplete == true)
    {
        animCompleteActions();

    }else{
        setTimeout(checkAnimComplete,300);
    }
}
checkAnimComplete();

function animCompleteActions()
{
    // anim complete actions chere
} 
```

# c# - 为什么 FileSystemWatcher 检测不到来自 Visual Studio 的更改？

> ID：680698
> 
> 赞同：21
> 
> 时间：2009-03-25T08:37:27.353
> 
> 标签：c#, visual-studio-2008, filesystemwatcher

我制作了一个小型应用程序来响应文件夹中文件的更改。但是当我在 Visual Studio 2008 中编辑文件时，它从来没有检测到任何东西。如果我改为在记事本中编辑文件，一切都会按预期工作。

当然，Visual Studio 会在某个时候保存文件，但是当我关闭工作室时，观察者甚至不会触发。你知道我在这里缺少什么吗？

此示例代码 (C#) 应说明问题：

```
FileSystemWatcher fileSystemWatcher = new FileSystemWatcher("C:\Test", "*.cs");
WaitForChangedResult changed = fileSystemWatcher.WaitForChanged(WatcherChangeTypes.All);
Console.Out.WriteLine(changed.Name); 
```

我发现[Ayende 的一篇博客文章](http://ayende.com/Blog/archive/2006/02/20/FileSystemWatcherVisualStudio2005.aspx)描述了同样的问题，但不幸的是没有解决方案。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-25T10:57:59.450

这真是令人难以置信...当您尝试下面的示例程序并在 VS 中更改文件时，您会注意到输出窗口中有两行：

> 已删除
> 
> 重命名

因此 Visual Studio 永远不会*更改*现有文件，它会将内容保存到具有临时名称的新文件中，然后删除原始文件并将新文件重命名为旧名称。

实际上，这是一个很好的做法，因为如果您按照通常的方式执行此操作（仅写入更改的文件，这将导致`Changed`事件被触发），则可能会在写入过程完成之前调用事件处理程序。如果事件处理程序处理文件内容，这可能会导致问题，因为它会处理不完整的文件。

换句话说：*这不是一个错误，而是一个特性*;-)

```
 static class Program
    {
        [STAThread]
        static void Main()
        {
            FileSystemWatcher FSW = new FileSystemWatcher("c:\\", "*.cs");

            FswHandler Handler = new FswHandler();

            FSW.Changed += Handler.OnEvent;
            FSW.Created += Handler.OnEvent;
            FSW.Deleted += Handler.OnEvent;
            FSW.Renamed += Handler.OnEvent;

            FSW.EnableRaisingEvents = true;

            System.Threading.Thread.Sleep(555000);
            // change the file manually to see which events are fired

            FSW.EnableRaisingEvents = false;
        }
    }
    public class FswHandler
    {
        public void OnEvent(Object source, FileSystemEventArgs Args)
        {
            Console.Out.WriteLine(Args.ChangeType.ToString());
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-05-18T10:58:47.670

通过指定 NotifyFilter 属性解决：

```
FileSystemWatcher w = new FileSystemWatcher();           
w.NotifyFilter = NotifyFilters.LastAccess | NotifyFilters.LastWrite 
| NotifyFilters.CreationTime; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-25T14:56:34.990

只是为了记录这种可能性......

来自[msdn](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)：

> 如果多个 FileSystemWatcher 对象在 Service Pack 1 之前的 Windows XP 或 Windows 2000 SP2 或更早版本中监视相同的 UNC 路径，则只有一个对象会引发事件。在运行 Windows XP SP1 和更新版本、Windows 2000 SP3 或更新版本或 Windows Server 2003 的计算机上，所有 FileSystemWatcher 对象都会引发相应的事件。

所以我的想法是，无论出于何种原因，Visual Studio 在文件上都拥有自己的 FileSystemWatcher ......但是你没有 UNC 路径，也没有提到操作系统。

# windows - 以编程方式更改任务栏设置？

> ID：680705
> 
> 赞同：2
> 
> 时间：2009-03-25T08:40:06.363
> 
> 标签：windows, settings, taskbar

我想用一个小批处理文件或 java 程序或其他什么来更改我的任务栏的设置。
所以我想知道，是否有包含此信息的注册表项。

有谁知道，Windows 在哪里设置任务栏设置？

编辑：不，我不想在每次启动时更改任务栏设置来惹恼用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T11:20:44.387

```
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\ 
```

和64位等效？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T04:42:40.790

[TaskBarCmd](http://mihai-nita.net/2007/09/09/taskbarcmd-programmatically-change-the-windows-taskbar-settings/)似乎可以完成这项工作。它包括 C++ 源代码。它使用[IBandSite](http://msdn.microsoft.com/en-us/library/ms647027.aspx%20iBandSite%20COM%20Interface) COM 接口。没试过源码，但编译的版本似乎可以工作。

# ruby-on-rails - 模板错误：nil:NilClass 的未定义方法“每个”

> ID：680709
> 
> 赞同：0
> 
> 时间：2009-03-25T08:41:58.777
> 
> 标签：ruby-on-rails, ruby, templates, web, rubygems

我的 Rails 应用程序在本地运行良好。但是一旦我把它放在服务器上并处于生产模式，我就会收到这个错误：

```
ActionView::TemplateError (undefined method `each' for nil:NilClass) on line #7 of app/views/admin/confirm.rhtml:
4: <br>Description:
5: <br><%= @description %>
6: <br>Features:
7: <% @features.each do |feature| %>
8:      <br><%= feature.humanize %>
9: <% end %>
10: <br>Role data:

   app/views/admin/confirm.rhtml:7
   /usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/renderable.rb:39:in `send'
   /usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/renderable.rb:39:in `render'
   /usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/template.rb:73:in `render_template'
   /usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/base.rb:256:in `render'
   /usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/base.rb:367:in `_render_with_layout'
   /usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_view/base.rb:254:in `render'
   /usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:1174:in `render_for_file'
   /usr/local/lib/ruby/gems/1.8/gems/actionpack-2.2.2/lib/action_controller/base.rb:896:in `render_without_benchmark' 
```

有人知道这意味着什么吗？

编辑：好的，我发现@features 为零。但我不知道情况如何。在我的创建动作中，我有：

```
flash[:name] = params[:name]
flash[:description] = params[:description]
flash[:role_data] = params[:role_data]
flash[:user_data] = params[:user_data]
flash[:features] = params[:features]
flash[:theme] = params[:theme]
redirect_to :action => "confirm" 
```

然后在我的确认操作中，我有：

```
def confirm
    @title = "Create a new simulation"
    @features = flash[:features]
    @name = flash[:name]
    @description = flash[:description]
    @role_data = flash[:role_data]
    @user_data = flash[:user_data]
    @theme = flash[:theme]
    flash.keep
  end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T09:38:36.847

您可能应该使用会话对象在操作之间传递数据。Flash 用于在动作之间传递消息，而不是数据！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T08:48:11.087

对于该实例，您的 @features 实例变量为零。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T00:28:41.247

我认为您需要`flash.keep`执行 create 操作，因为您正在使用`redirect_to`而不是`render`.

来自[ActionController::Flash::FlashHash](http://api.rubyonrails.org/classes/ActionController/Flash/FlashHash.html)

> 当你需要将一个对象传递给当前动作时，你现在使用，当当前动作完成时你的对象就会消失。
> 
> 通过 now 设置的条目的访问方式与标准条目相同：flash['my-key']。

# .net - Silverlight 与 C++.Net

> ID：680715
> 
> 赞同：2
> 
> 时间：2009-03-25T08:45:43.947
> 
> 标签：.net, c++, silverlight

您可以使用 C++.Net 编写 Silverlight 应用程序吗？不使用 C# 或 VB.Net 作为后端语言，而是使用 C++.Net

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-26T09:35:15.537

您可以使用任何语言，只要它编译为纯托管代码即可。例如，有使用 IronPython、IronRuby 的 Silverlight 应用程序。唯一的限制是您不能拥有任何本机代码，或使用受 Silverlight 限制的 FCL 部分（例如 P/Invoke）

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-03-25T08:56:22.423

检查[这个](http://silverlight.net/forums/p/5329/164934.aspx#164934)。谷歌搜索会回答您的查询。

更新：我错了。对此表示歉意。马克回答正确。Mark ：您可以使用任何语言，只要它编译为纯托管代码即可。例如，有使用 IronPython、IronRuby 的 Silverlight 应用程序。唯一的限制是您不能拥有任何本机代码，或使用受 Silverlight 限制的 FCL 部分（例如 P/Invoke）

# c++ - 使用 TBB 时找不到 msvcp80d.dll

> ID：680721
> 
> 赞同：0
> 
> 时间：2009-03-25T08:47:37.827
> 
> 标签：c++, visual-studio

我正在使用 Intel TBB C++ 在 Visual Studio 2008 上对应用程序进行多线程处理。当我运行可执行文件时，我得到一个对话框，提示找不到“MSVCP80D.dll”。网上有很多关于这个的东西，这让我很困惑。

请帮忙。

编辑：根据答案，最后我能够解决“缺少 dll”的问题。我给出了一条通往 vc8 的 TBB 库的路径，导致依赖于 vc8 dll，这些 dll 与 Visual Studio 2005 一起使用，而不是与 2008 一起使用。（使用依赖（[http://www.dependencywalker.com/](http://www.dependencywalker.com/)）很容易确定可执行文件的运行时依赖项。）我按项目更改为依赖 vc9 dll，而不是 vc8，然后它工作正常。

要注意的另一件事是在 Windows 上使用清单文件。清单文件描述依赖关系。必须在编写应用程序时根据需要生成清单文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T13:05:20.530

MSVC80D 是 VS 2005。作为 VS2008 的一部分，您将使用 MSVC90D。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T13:09:42.923

您可以在各个地方在线找到它们。只需对其进行病毒扫描并将其放入程序的路径中，一切都会正常工作。您可能需要多个调试 dll，您可以使用 depends32.exe 来查看您缺少的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T12:22:48.667

您的应用程序是使用调试版本编译的。VC 运行时的调试版本不在路径中。尝试生成发布版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T12:25:28.007

你在你的开发机器上运行程序吗？如果不是，您可能会收到此错误。文件名末尾的“D”表示该 DLL 是调试 DLL，通常不会在未安装 Visual Studio 的计算机上。你也不应该重新分发它（复制它）。您应该编译应用程序的“发布”版本并运行它。如果由于某种原因您确实无法做到这一点，并且只有一两台计算机，请尝试在该计算机上安装 Visual Studio 的快速版本。

如果您在开发机器上遇到此问题，这显然是由编译器/链接器问题引起的。尝试进行干净的构建（“干净”，然后在 Visual Studio 中“构建”）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T12:49:53.423

好的，经过大量搜索，偶然地，我登陆了这个论坛[http://www.codeguru.com/forum/showthread.php?t=446789](http://www.codeguru.com/forum/showthread.php?t=446789)，上面写着我解释为“我正在使用的 TBB 版本不支持 VS 2008”。

但这仍然不确定。

# asp.net - ASP.NET 全局事件

> ID：680722
> 
> 赞同：0
> 
> 时间：2009-03-25T08:47:39.090
> 
> 标签：asp.net

哪个事件最适合检查 Session expired？我正在尝试捕获每个服务器请求，如果 Session 为空，则重定向到不同的页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T09:09:28.523

[您可以通过挂钩 Session_OnStart - http://msdn.microsoft.com/en-us/library/ms178583(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms178583(VS.80).aspx)来确定是否正在创建新会话

> 您可以通过将名为 Session_OnStart 的子例程添加到 Global.asax 文件来处理 Session_OnStart 事件。如果请求开始新会话，则 Session_OnStart 子例程在请求开始时运行。如果发出的请求不包含 SessionID 值，或者请求中包含的 SessionID 属性引用了已过期的会话，则将启动一个新会话。

这将有效地告诉您何时创建新会话，无论用户是刚刚到达还是会话已过期。

很难可靠地区分这两种情况。我想您可以尝试在会话 cookie 中或嵌入在 url (cookieless) 中获取会话 id，但您需要在到达上述事件之前检查它，然后检查请求是否有最初的会话 ID。检查您是否可以在无 cookie 版本中获取会话 ID，因为它已从 asp.net 为您提供的 URL 中删除（不确定您是否在生命周期的早期看到它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T09:04:10.767

这通常最好通过对所有其他类使用基 Page 类并在 Page_Load 方法中实现这一点来实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T09:30:08.927

使用继承自 Page 类的 BasePage 类。让每个 aspx 页面都继承该 BasePage 类。在 BasePage 类中，重写 OnInit 事件，您可以在其中检查 Session 或 Cookie，并将用户重定向到登录页面（例如）。
我将这种方法用于我的所有网络表单应用程序，因为它易于实现和使用。

# flash - 更改动态文本字段问题的颜色

> ID：680725
> 
> 赞同：2
> 
> 时间：2009-03-25T08:48:10.570
> 
> 标签：flash, actionscript, function, actionscript-2, textfield

我有这段代码，当我翻转链接动画剪辑时，它应该改变动态文本字段的颜色，然后在我推出时返回。我没有得到编译器错误，它只是不起作用。

```
function textColor(mc_function:MovieClip, tf_text:TextField) {
mc_function.onRollOver = function() {
    tf_text.textColor = 0x7cb0b7; 
};
mc_function.onRollOut = function() {
    tf_text.textColor = 0xffffff; 
};
}

boxLink(link_a1,text_a1);
boxLink(link_a2,text_a2);
boxLink(link_a3,text_a3); 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T09:04:39.160

试试这个：

```
function SetMouseAction(pMovieClip, pTextField):Void {
    pMovieClip.linkedText = pTextField;
    pMovieClip.onRollOver = function() {
            this.linkedText.textColor = 0x7cb0b7; 
    };
    pMovieClip.onRollOut = function() {
            this.linkedText.textColor = 0xffffff; 
    };
}

SetMouseAction(link_a1, text_a1);
SetMouseAction(link_a2, text_a2);
SetMouseAction(link_a3, text_a3); 
```

至少我已经测试过了，它对我有用

# web-services - 富时价格馈送

> ID：680733
> 
> 赞同：1
> 
> 时间：2009-03-25T08:50:02.360
> 
> 标签：web-services, financial, datafeed

有谁知道我可以获取 FTSE 100 和道琼斯指数的价格信息和图表的网络服务？

我只需要延迟的价格馈送而不是实时的。

它是为了在公共网站上显示，所以我认为我们需要一个我们可以支付费用来许可信息的提供商？

谢谢，

克里斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T08:52:24.260

如果您不需要实时数据，可以使用[Google 财经](http://www.google.com/finance)。

如需更专业的内容，您可以订阅[Reuters DataLink](http://www.reutersdatalink.com/)。

还有[来自路透社的实时数据馈送](http://about.reuters.com/productinfo/realtimedata/)，但这些是为重量级玩家提供的。

# c++ - 得米特法则或返回整个向量

> ID：680738
> 
> 赞同：4
> 
> 时间：2009-03-25T08:54:14.940
> 
> 标签：c++, oop, vector, law-of-demeter

哪一个更好：

```
public:
  const vector<int> & GetPointsVector();
private:
  vector<int> PointsVector; 
```

或者：

```
public:
  int GetCurrentPoint();
  void MoveToFirstPoint();
  void MoveToNextPoint();
  bool IsAtLastPoint();
  size_t GetNumberOfPoints();
private:
  vector<int> PointsVector; 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-25T09:01:27.543

两者都不是。最好返回 begin() 和 end() 迭代器，或者更好地为迭代器返回 boost::range。

```
private:
        typedef std::vector<int>            PointsContainer;
public: 
        typedef boost::iterator_range<PointsContainer::const_iterator> PointsRange;
        PointsRange getPointsRange() const {
            return boost::make_iterator_range(pointsContainer_.begin(), pointsContainer_.end()); 
        } 
```

优点是遍历逻辑隐藏在范围/迭代器内

使用时，一种替代方法是：

```
int p;
foreach(p, obj.getPointsRange()) {
   //...
} 
```

除此以外

```
C::PointsRange r = obj.getPointsRange();
for(C::PointsRange::iterator i = r.begin(); i != r.end(); ++i) {
      int p = *i;
      //...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T08:58:15.540

两者都不。将需要对类内部如此深入了解的函数变成成员函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T08:59:05.180

在我看来，第一种选择（严格使用 const 关键字）更好，因为那时您可以使用标准接口来访问向量的成员（例如迭代器等）。只有当您没有其他选项来保护数据免受意外修改时，才需要第二个选项（即专用访问方法）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T09:14:41.333

没有正确的答案。答案会因上下文而异，目前我们掌握的很少。

这取决于您班级的客户。在大多数情况下，您不希望临时检查员更改对象的状态，因此在某种程度上最好返回对`const`对象的引用。但是，在这种情况下，我也会将函数`const`设为 ie

```
 /* a design const - this accessor does not change the state */
 const vector<int> & GetPointsVector() const; 
```

这也很有效，因为您没有将重对象作为返回值传递（这是一个不同的问题，现在大多数编译器都执行 RVO）。

如果您的客户需要在算法中使用向量，是的，您最好提供迭代器。但是两对即

```
typedef vector<int>::iterator _MyItr;
_MyItr begin() const;
_MyItr begin();

_MyItr end() const;
_MyItr end(); 
```

这将与 STL 的设计方式保持一致。但是，在指定客户端可以期望的迭代器类型时要小心（例如：如果类规范说返回的迭代器是`RandomIterators`，它会对您的实现设置一定的期望值）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T09:12:55.520

我更喜欢封装内部数据表示并使用 forEachSomething 模板公共功能。或者，如果你有提升，你可以避免模板化 forEachSomething 并将实现放到 .cpp 文件中。

```
class Class
{
public:
    Class()
    {
        points_.push_back( 1 );
        points_.push_back( 5 );
        points_.push_back( 7 );
    }

    template <typename TFunction>
    void forEachPoint( TFunction function )
    {
        std::for_each( points_.begin(), points_.end(),
                       function );
    }

    void forEachPoint2( boost::function< void (int ) > function )
    {
        std::for_each( points_.begin(), points_.end(),
                       function );
    }
private:
    std::vector<int> points_;
};

void print( int a )
{
    std::cout << a << std::endl;
}

int main()
{
    Class object;
    object.forEachPoint( print );
} 
```

# caching - 浏览器中的网页过期消息

> ID：680742
> 
> 赞同：0
> 
> 时间：2009-03-25T08:57:08.663
> 
> 标签：caching

我正在使用 ASP .Net 和 C# 实现一个 Web 应用程序。其中一个页面要求它始终需要从服务器获取，而不是从本地浏览器缓存中获取。我已经能够做到这一点。

我们在应用程序中有一个后退按钮，它只是调用 javascript:history.back() 方法。问题是当点击后退按钮导航到总是要从服务器重新加载的页面时，浏览器会显示“网页过期消息”。

这里的意图是强制浏览器重新加载页面，而不是显示网页过期消息。

任何帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T09:00:24.597

您可能需要更改实现以使浏览器显式加载 URL：

```
window.location.href = 'http://....'; 
```

而不是调用后退按钮，因为后退按钮的目的是从缓存中获取最后一页。

（如果浏览器不这样做，他们会在注册过程或类似过程中使用后退按钮时多次重新发送您的表单数据。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T09:00:39.607

你的意思是你想控制浏览器的行为，这是不可能的。我怀疑你可以这样解决它。您可以将过期时间设置为一个较小的值（可能是 1 分钟？），以便在快速返回时页面仍然有效。

# c++ - 一个函数没有在线程内返回，如何保证不会再次进入？

> ID：680744
> 
> 赞同：1
> 
> 时间：2009-03-25T08:58:12.373
> 
> 标签：c++, winapi, synchronization, synchronous

我不希望该函数被多个线程同时输入，我也不希望它尚未返回时再次输入。有什么方法可以实现我的目标吗？非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-25T09:04:10.313

这两个目标都可以通过互斥信号量来实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T09:11:35.273

正如其他答案所解释的那样，在一个线程上进行时阻止其他线程进入该函数非常简单。但是如果你想让它在它已经被输入时阻塞在同一个线程中......好吧，那是一个死锁。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T09:46:57.543

使用临界区（InitializeCriticalSection()、EnterCriticalSection()、LeaveCriticalSection()）并实现一个入口计数器。临界区将防止来自不同线程的重新进入，而入口计数器将防止来自同一线程的重新进入。

要实现条目计数器，请使用公共变量（您的情况为布尔值）和括号类。一旦你已经进入临界区（因此没有其他线程将并行执行相同的代码）检查变量的值。如果它声明该函数已被输入 - 离开（首先释放关键部分，然后离开该函数）。否则，构造将更改变量值的括号类实例。所以下次这个线程进入函数时，它会检查变量，看到重新进入已经发生并离开。离开函数后，括号类的析构函数会将变量更改为其原始值。

对临界区条目和条目计数器更改使用括号类是明智的，这样您的代码是异常安全的，并且所有操作都按必要的顺序执行，无论您如何离开函数 - 在异常或返回语句时。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T14:01:20.600

f will only be called runs only, when nobody else is currently running it. (This is concept demonstration with only Win32 calls)

```
void f();

err call_f()
{
    static HMUTEX hMutex;
    if( !hMutex )
    {
        hMutex = ::CreateMutex( 0, TRUE, 0 );
    }
    else
    {
        if( WaitForSingleObject( hMutex, 0 ) != WAIT_OBJECT_0 )
            return ERR_ALREADY_RUNNING;
    }

    // calling f here
    f();

    ReleaseMutex( hMutex );
    return S_OK;
} 
```

Beware the minimal checking, the missing cleanup code for the mutex and the race-condition on first enter.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T09:25:30.233

既然您说的是 C++ 和 Windows，请查看[关键部分](http://msdn.microsoft.com/en-us/library/ms682608(VS.85).aspx)。不过，为了便于使用，您可能希望将其包装在几个 C++ 类中。

如果锁已经被占用，关键部分会尝试短时间的自旋循环。对于较短的代码，这通常可以避免完全阻塞等待，从而避免用户<>内核模式等的开销。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T09:05:35.490

通常您需要引入一个监视器，例如在Java 中通过将“同步”关键字添加到您的方法签名中。

（我对吗？）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T09:22:42.190

你可以这样做：

```
int some_shared_var = 0;
...
for (;some_shared_var != rank;) ;
run_my_function();
some_shared_var++; 
```

rank 是您的线程号（假设您有编号为 0 到 size-1 的线程）。

这只是一个例子。真正的实现会有所不同。这取决于您要使用哪些库/函数来并行化代码（fork、MPI 等）。但我希望它能给你一些有用的想法。

# ruby-on-rails - 如何在 Ruby on Rails 中发送和接收加密电子邮件？

> ID：680753
> 
> 赞同：7
> 
> 时间：2009-03-25T09:01:06.610
> 
> 标签：ruby-on-rails, ruby, email, encryption

我有一个在某些事件上触发电子邮件的 rails 应用程序。这些电子邮件被发送到一个单独的公司，该公司将在回复时向电子邮件添加一些额外的数据。这一切都被理解和工作，我正在解析回复，提取数据并且它工作正常。

我现在被要求加密电子邮件。

有没有人对最好的方法有任何经验/想法？

我无法保证第 3 方将使用什么电子邮件客户端，因此我需要一个可以在许多电子邮件客户端上通用的解决方案。加密必须在我发送电子邮件时由我的应用程序和客户端应用程序（Outlook、Thunderbird、Entourage 等）在回复时进行。然后我需要接收加密的电子邮件，解密并解析它以提取我需要的新信息。

任何人都可以指出可以帮助我实现这一目标的插件/文档吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T09:07:11.367

如果另一端不使用您的应用程序，您应该使用 S/MIME 或 PGP。

大多数桌面电子邮件客户端都支持开箱即用的 S/MIME，并且 PGP 通常作为插件提供（对于 Thunderbird 有[Enigmail](http://enigmail.mozdev.org/)，对于 Apple Mail 有[GPGMail](http://www.sente.ch/software/GPGMail/)等）。

此外，S/MIME 需要证书，您可以自己创建或从证书颁发机构（如[Verisign](http://www.verisign.com/)或[Thawte](http://www.thawte.com/)）购买，具体取决于您的需要。

我确信有用于 Ruby 的 S/MIME 和 PGP 库，但快速搜索并没有为我发现“一个真正的库”。但是，您始终可以让[OpenSSL](http://www.openssl.org/)（用于 S/MIME）或[GPG](http://www.gnupg.org/)为您完成繁重的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-21T15:56:06.267

我认为 Güder 的回答非常好，但请记住，所有这些都需要用户已经安装了诸如 GPG 之类的东西并且有可用的关联密钥。这种艰苦的设置过程是使电子邮件加密更广泛使用的大约 95% 的障碍。

你确定委托这个项目的人明白这并不像打开代码中的开关来发送加密电子邮件那么简单吗？

一种选择是在程序的安装过程中加入一个依赖于（并包括）GPG 的密钥管理例程。然后用户可以选择一个非常困难的密码（确保对其进行检查，使其至少是字母数字等），可以从中生成一个公钥，并上传到流行的密钥服务器。

生成的密钥可用于程序生成的电子邮件，最重要的是，该密钥对每个用户都是唯一的。然后，您可以定期对用户操作系统上的默认电子邮件客户端进行外部调用以打开电子邮件。

为了确保打开的电子邮件是加密的，我会检查环境并获取默认的电子邮件客户端，然后从您的程序中发送带有必要标志的电子邮件，以加密生成的电子邮件。例如，这意味着 Thunderbird 的 Enigmail 与 Apple 的 Mail 将有所不同。

但是不要忘记 OpenSSL，当然......

# delphi - 我在哪里可以找到一个好的德尔福库？

> ID：680760
> 
> 赞同：0
> 
> 时间：2009-03-25T09:04:26.413
> 
> 标签：delphi, delphi-6

我正在使用delphi6，它缺乏以下能力：

*   一个库对象，
*   一个列表对象（看起来像 TList,TStringList 就足够了吗？）
*   算法库（如排序，）
*   STL 之类的模板库
*   动态语言功能或 GC。
*   等等。

我怎样才能找到这些东西？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T09:21:01.553

试试[绝地代码库](http://sourceforge.net/projects/jcl/)。容器类和排序算法有很好的替代品。我认为 Delphi 6 没有 GC 或类似 STL 的库。

Delphi 6 落后于时代，检查[Delphi 2009](http://www.codegear.com/products/delphi/win32)或至少[Turbo Delphi](http://www.turboexplorer.com/delphi)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T09:31:05.150

有[DeCAL](http://sourceforge.net/projects/decal/)，它声称与 STL 相似。但是，我从未真正测试过它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T09:22:13.907

网上有很多第三方的delphi库、组件和源代码示例。只是我头顶上的一对

绝地[http://www.delphi-jedi.org/](http://www.delphi-jedi.org/)

和

一个 Delphi 超级页面[http://delphi.icm.edu.pl/](http://delphi.icm.edu.pl/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T12:13:54.273

作为 DeCAL 的替代品（它是没有泛型的 TList 的一个非常好的替代品），我将提出[Julian M Bucknall 的 EZSDL](http://www.boyet.com)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T10:00:54.780

与 Delphi 2007 for Win32 和 RAD Studio 2007 兼容的主要第三方组件列表，作者 Andreano Lanusse 在[http://edn.embarcadero.com/article/37455](http://edn.embarcadero.com/article/37455)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-25T14:35:29.583

前三个在 VCL 中，请查看帮助和来源。Delphi 6 没有泛型，因此不能与模板库一起使用。并且没有垃圾收集。

如果您想在 Delphi 中编程，请忘记它们。如果没有，请寻找另一种语言。

# php - 使用与 php 和 c 的共享内存？

> ID：680763
> 
> 赞同：3
> 
> 时间：2009-03-25T09:04:38.783
> 
> 标签：php, c, ipc, shared-memory

可以在windows中使用共享内存在php脚本和c程序之间进行通信吗？

c 程序一直运行并使用内存映射文件，即：

```
handle1 = CreateFileMapping(
 (HANDLE)0xFFFFFFFF, NULL, PAGE_READWRITE, 0, sizeof(byte)*BUFFER_SIZE, "my_foo" );

hView = (LPINT) MapViewOfFile(handle1, FILE_MAP_ALL_ACCESS, 0, 0, 0); 
```

对于 PHP 脚本，我可以只使用以下代码打开 c 程序创建的内存映射文件吗？

```
$shmkey = @shmop_open(ftok("my_foo", 'R'), "a", 0644, $buffer_size); 
```

还是c内存映射文件和php共享内存不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T09:09:31.737

PHP shmop 函数只是底层[POSIX 函数](http://linux.die.net/man/2/shmop)的包装器，在 windows 下似乎不可用。

从[PHP 手册](http://theserverpages.com/php/manual/en/ref.shmop.php)：

> 注意：Windows 2000 之前的 Windows 版本不支持共享内存。在 Windows 下，Shmop 仅在 PHP 作为 Web 服务器模块运行时才能工作，例如 Apache 或 IIS（CLI 和 CGI​​ 将不起作用）。

显然 PHP 在 apache 中模拟了这种行为，但由于它在独立的二进制文件中不可用，因此很难与 Windows 等效项集成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-16T21:01:05.230

我想让 PHP 访问由 Windows 应用程序创建和写入的共享内存。我通过创建自己的 php 扩展（称为 php_gsect.dll）来实现这一点。这可能不是您想要的，但我的 php_gsect 附加到全局部分并读取（或写入）一些字节，然后我可以对其进行操作。

仅供参考：我的 Windows 应用程序正在从另一个系统检索动态趋势数据并将数据放入一个命名的全局部分。php 网页正在从全局部分访问数据并创建图表（使用 ESJ 图表库）。

# c# - 类属性上的 StackOverFlow

> ID：680765
> 
> 赞同：3
> 
> 时间：2009-03-25T09:04:50.920
> 
> 标签：c#

### 复制：

> [C# 新手，为什么 Property Set 会抛出 StackOverflow 异常？](https://stackoverflow.com/questions/367192/new-to-c-why-does-property-set-throw-stackoverflow-exception)

我有一个名为 myClass 的简单类，它有一个名为 isAuthenticated 的属性，代码如下：

```
public class myClass
{
        public myClass()
        {
            this.isAuthenticated = false;
        }
        public bool isAuthenticated
        {
            get { return isAuthenticated; }
            set { isAuthenticated = value; }
        }
} 
```

当我初始化课程时，我在 set {...} 行上得到一个 stackoverflow，我做错了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-25T09:07:53.317

getter/setter 正在调用自己。添加成员变量。

```
{
     bool isAuthenticated;
        public myClass()
        {
            IsAuthenticated = false;
        }
        public bool IsAuthenticated
        {
            get { return isAuthenticated; }
            set { isAuthenticated = value; }
        }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-25T09:09:03.687

Because you are setting the myClass.IsAuthenticated property itself.

You have to save the value in a local variable or if you use C# 3.0 or greater just do (automatic property)

```
public bool IsAuthenticated {get; set;} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T09:18:12.793

As an addition to the "Property-calls-itself" remarks, in the latest C# version you can covert such given simple properties to an *auto-property:*

```
public class myClass
{
    public myClass()
    {
        this.IsAuthenticated = false;
    }

    public bool IsAuthenticated { get; set; }
} 
```

**Edit:** changed capitalization of the property, C# naming conventions calls for capital letters as starting letters of a public field or property.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T09:08:35.920

蛇吃它的尾巴。当您在构造函数中为 isAuthenticated 分配 true 时，您使用属性的设置器，但在设置器中，您再次设置它，因此您有某种无限设置循环。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T09:08:52.223

当它应该设置一些私有字段时，setter 正在调用自己 - 从外观上看，getter 会做同样的事情，因为您的示例不包含任何字段。如果您使用的是 .net 3.5，则可以只使用自动实现的属性...

# architecture - 软件系统按复杂度和难度排序

> ID：680766
> 
> 赞同：0
> 
> 时间：2009-03-25T09:05:14.633
> 
> 标签：architecture, project-planning, estimation

我在工作中参与了一个关于不同人构建的软件系统最大的讨论；在这种情况下，最大的问题是系统复杂性和实施难度的结合。

由于经验丰富的程序员往往会对项目的规模有直觉，即使他们不会把它写下来，我想我会向 SO 提出这个问题。

正在讨论的系统是：

*   电信计费系统。4个主要特点：
    *   实时呼叫控制，其中每 60 秒从数据库中保留一次呼叫信用，
    *   可定制的呼叫计划、最低成本路由、自定义每用户费率、
    *   每个计费服务器可同时处理 1000 个呼叫，
    *   365x24x7 和 99.999% 的可靠性。
*   赛车行业的核心投注系统。4个主要特点：
    *   客户端/服务器应用程序支持大约。1000 个现金网点和 200 个座位的呼叫中心，
    *   不是一个固定的赔率系统，根据扣除佣金和获胜者之间的共享池计算支出，
    *   大约 20 种不同的投注类型，最大组合投注为前 4 名，
    *   350x20x7 和 99.9% 的可靠性。
*   客户关系管理系统。4个主要特点：
    *   AJAX 用户界面，
    *   电子邮件集成根据收件人地址发送到不同的队列，
    *   开票，
    *   具有 3rd 方集成授权的 Web 服务 API。

缺少大量细节，但问题的重点是按“大”降序对系统进行排名（定义见上文）。任何比例都是任意的，但为了给它一些相关性，建议使用以下比例：

*   100航天飞机生命支持系统，
*   ?? 应用 X
*   1 Hello World 控制台。

我很想看看上面 3 个系统的排名以及人们曾参与过的任何其他大型系统的排名，以提供观点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T09:32:34.740

这是我的看法

1) 电信系统听起来很大，但它看起来像一个纯服务器应用程序，没有 UI，没有真正的用户，因此需要一些巧妙的数学运算、一个数据库和一些服务 = 60 分，整体复杂性 50 分 +24x7x365 的 10 分。与 MF 集成或用简化的汉字书写会获得更多积分。

2) 赌马，现在我们正在谈论，电话中的人们，呼叫中心，大量的用户界面，大量的互动，大量的肮脏财富。我会给它一个 70 分，你确实每天有 4 小时进行维护，但如果它停机 30 秒，我怀疑你是否能活到足够长的时间到达那个支持窗口。

3) 打哈欠，Ajax 有点酷，但 CRM 的主要复杂性必须是长期运行的交易，由计费系统和名称和地址支持。我会给它一个35。

让火焰开始燃烧吧 ...

# vb.net - 与 Ajax 日历扩展器相关的错误

> ID：680769
> 
> 赞同：0
> 
> 时间：2009-03-25T09:06:41.277
> 
> 标签：vb.net

我有一个显示日期的文本框。单击文本框 ajaxcalendar 必须显示在文本框的前面。但现在它在文本框后面。所以无法选择日期。任何人都可以帮助将日历放在文本框的前面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T14:28:39.257

您可能需要查看两个控件的“z-index”样式属性。z-index 值较高的那个更靠近观察者。

# django - Django Imagefield 无法通过 ModelForm 正常工作

> ID：680770
> 
> 赞同：47
> 
> 时间：2009-03-25T09:06:44.847
> 
> 标签：django, django-forms, django-models

我确定我正在做一些非常明显愚蠢的事情，但我已经试图弄清楚几个小时了，但没有任何事情发生在我身上。

我正在使用 ModelForm，因此我可以从模型中公开一些字段以进行编辑。2 个图像字段，1 个文本字段。处理表单并且 TextField 工作。这两个 ImageField 不起作用，这就是我今天在这里的原因。

我正在使用 Django 1.0.2

这是相关代码（询问您是否需要更多代码——我不包括 HTML，因为该部分似乎可以正常工作）：

模型：

```
class Company(models.Model):
    #...
    logo = models.ImageField(upload_to='logos', blank=True)
    intro_pic = models.ImageField(upload_to='intropics', blank=True)
    intro_text = models.TextField(blank=True) 
```

视图和形式：

```
def admin_edit(request, company_slug):
    company = get_object_or_404(Company, slug = company_slug)

    f = AdminEditForm(instance = company)
    if request.method == 'POST':
        f = AdminEditForm(request.POST, instance = company)
        if f.is_valid():
            print "Processing form"
            print f.cleaned_data['intro_pic']
            f.save()

    return render_to_response('uadmin/edit.html', {'company':company, 'f':f}, RequestContext(request))

class AdminEditForm(ModelForm):
    class Meta:
        model = Company
        fields = ['logo', 'intro_pic', 'intro_text'] 
```

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-03-25T13:44:43.730

好吧，我觉得自己像个白痴。为了让 Django 能够处理上传的文件，您需要将 request.FILES 变量传递给表单（有意义，对吧？！）

在我的情况下，以下行来自：

```
f = AdminEditForm(request.POST, instance = company) 
```

到：

```
f = AdminEditForm(request.POST, request.FILES, instance = company) 
```

要检查的另一件事（如果您将来遇到类似的事情）是您的表单是多部分的。您的`<form>`标签应如下所示：

```
<form enctype="multipart/form-data" method="post" action=""> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-13T03:43:30.413

这发生在我身上，因为我缺少文件输入的“名称”属性。

# java-me - 获取设备 IMEI

> ID：680782
> 
> 赞同：8
> 
> 时间：2009-03-25T09:10:02.407
> 
> 标签：java-me, midp, cldc, imei

如何以通用的方式获取Java ME设备的[IMEI](http://en.wikipedia.org/wiki/International_Mobile_Equipment_Identity)适用于所有设备

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-25T10:34:29.053

通常，使用 java.lang.System.getProperty() 可以返回设备 IMEI。

不幸的是，您需要用于获取 IMEI 的字符串参数将从一个手机制造商更改为下一个手机制造商。

要尝试的字符串：

imei
phone.imei
com.lge.imei
com.nokia.imei
com.nokia.mid.imei
com.siemens.imei
com.sonyericsson.imei
com.motorola.imei
...
你明白了。

您可能需要将字符串的最后一部分大写。

结果的格式也可以改变。
它可以是带有“IMEI”前缀和 17 位数字中间的 3 个“-”的完整 imei。
它可以是 13 或 15 位的标准化 imei ......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T10:31:09.200

没有通过 Java ME 获取 IMEI 的标准方法。一些手机[将 IMEI 公开为系统属性](http://wiki.forum.nokia.com/index.php/How_to_get_IMEI_in_Java_ME)，但其他手机不要求或要求 midlet 签署到运营商或制造商域（即不是由您）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-29T20:52:17.803

在我正在开发的游戏中，为了获得每个手机的唯一 ID（以便他们无法复制和共享保存文件），我使用每个蓝牙设备不同的蓝牙 mac 地址和获取它的 java 代码是每个设备都一样=D

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T10:54:44.463

我已经尝试过 ax 和 quickrecipeonsymbianos 的建议，但是它们都以优雅的方式解决了目的。但是，在 BlackBerry 中，我们有 getDeviceID() 来获取设备的唯一 ID，但 Java ME 缺少此功能

# ruby-on-rails - 如何解释这个 Rails 错误？

> ID：680783
> 
> 赞同：1
> 
> 时间：2009-03-25T09:10:03.967
> 
> 标签：ruby-on-rails, postgresql, web-applications

嗨，有人知道这是什么意思吗？当我将应用程序部署在服务器上并使用 PostgresQL 时，我只会收到此错误。当我在本地运行并在 SQLite 上进行测试时，这很好。我有一个 features_simulations 连接表，我认为它与它有关。

```
Processing AdminController#confirmed (for 211.30.107.155 at 2009-03-25 09:06:21) [GET]
  Session ID: 59d7fdbbb6ec77367c310df0c0928a2a

ActiveRecord::StatementInvalid (PGError: ERROR:  relation "features_simulations_id_seq" does not exist
: SELECT currval('features_simulations_id_seq')):
    /usr/local/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/connection_adapters/abstract_adapter.rb:188:in `log'
    /usr/local/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/connection_adapters/postgresql_adapter.rb:503:in `execute'
    /usr/local/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/connection_adapters/postgresql_adapter.rb:1000:in `select_raw'
    /usr/local/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/connection_adapters/postgresql_adapter.rb:987:in `select'
    /usr/local/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/connection_adapters/abstract/database_statements.rb:7:in `select_all_without_query_cache'
    /usr/local/lib/ruby/gems/1.8/gems/activerecord-2.2.2/lib/active_record/connection_adapters/abstract/query_cache.rb:60:in `select_all' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T13:56:57.520

ActiveRecord 并不真正使用复合键。连接表中仍然必须有一个 ID 才能进行原子删除和更新。我认为其他人都说过同样的话，但方式更迂回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T09:49:23.700

我不确定，但也许你需要 features_simulations 表中的 id 。如果您使用 has_and_belongs_to_many 关系，则不需要 Id。但我认为对于 has_many :through，您需要连接表中的 id 列。

尝试在迁移中添加它：

```
add_column :features_simulations, :id, :integer, :primary_key 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T11:22:09.267

我认为“features _simulations _id _seq”是一个必须在数据库中创建的序列。这个序列似乎正在为表生成 id。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-25T11:40:20.017

在 Postgres 中，您可以为自动递增字段使用序列类型，这将自动创建必要的序列。如果需要，您可以使用整数类型并手动创建序列，将默认值设置为序列中的下一个值。

似乎代码正在尝试查找序列的当前值并且由于序列不存在而失败。我不确定 rails 是否会自动为 Postgres 主键创建正确的类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-30T06:58:07.450

是夹具的问题。根据您的表名检查您的夹具名称。如果两者之间不匹配，您将收到此错误。

# javascript - 如何检测位置哈希的变化？

> ID：680785
> 
> 赞同：573
> 
> 时间：2009-03-25T09:10:18.677
> 
> 标签：javascript, ajax, dom-events, fragment-identifier, hashchange

我正在使用 Ajax 和哈希进行导航。

有没有办法检查`window.location.hash`更改是否像这样？

[http://example.com/blah](http://example.com/blah) **#123**到[http://example.com/blah](http://example.com/blah) **#456**

如果我在文档加载时检查它，它会起作用。

但是如果我有基于#hash 的导航，当我按下浏览器上的后退按钮时它不起作用（所以我从 blah#456 跳转到 blah#123）。

它显示在地址框中，但我无法用 JavaScript 捕捉它。

* * *

## 回答 #1

> 赞同：626
> 
> 时间：2009-03-25T09:38:14.070

真正做到这一点的唯一方法（以及“真正简单的历史”如何做到这一点）是通过设置一个持续检查当前哈希的间隔，并将其与之前的哈希值进行比较，我们这样做并让订阅者订阅更改的如果哈希更改，我们将触发的事件.. 它并不完美，但浏览器本身并不支持此事件。

* * *

更新以使此答案保持新鲜：

如果您正在使用 jQuery（今天对于大多数人来说这应该是基础性的），那么一个不错的解决方案是使用 jQuery 通过使用其事件系统为您提供的抽象来监听窗口对象上的 hashchange 事件。

```
$(window).on('hashchange', function() {
  //.. work ..
}); 
```

这里的好处是您可以编写甚至不需要担心 hashchange 支持的代码，但是您确实需要做一些魔术，以一种鲜为人知的 jQuery 功能[jQuery 特殊事件](http://benalman.com/news/2010/03/jquery-special-events/)的形式。

使用此功能，您基本上可以为任何事件运行一些设置代码，当有人第一次尝试以任何方式使用事件时（例如绑定到事件）。

在此设置代码中，您可以检查本机浏览器支持，如果浏览器没有本机实现这一点，您可以设置一个计时器来轮询更改，并触发 jQuery 事件。

这完全使您的代码无需了解此支持问题，这种特殊事件的实现是微不足道的（获得一个简单的 98% 工作版本），但是[当其他人已经有了](http://benalman.com/projects/jquery-hashchange-plugin/).

* * *

## 回答 #2

> 赞同：300
> 
> 时间：2009-03-25T10:33:46.043

HTML5[指定了一个`hashchange`事件](http://www.whatwg.org/specs/web-apps/current-work/multipage/history.html#history-traversal)。[现在所有现代浏览器都支持](http://caniuse.com/hashchange)此事件。在以下浏览器版本中添加了支持：

*   互联网浏览器 8
*   火狐 3.6
*   铬 5
*   野生动物园 5
*   歌剧 10.6

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2011-06-28T15:42:41.777

请注意，在 Internet Explorer 7 和 Internet Explorer 9 的情况下，该`if`语句将给出 true（对于 Windows 中的“onhashchange”），但`window.onhashchange`不会触发，因此最好存储散列并在每 100 毫秒后检查它是否已更改适用于所有版本的 Internet Explorer。

```
 if (("onhashchange" in window) && !($.browser.msie)) {
         window.onhashchange = function () {
              alert(window.location.hash);
         }
         // Or $(window).bind( 'hashchange',function(e) {
         //       alert(window.location.hash);
         //   });
    }
    else {
        var prevHash = window.location.hash;
        window.setInterval(function () {
           if (window.location.hash != prevHash) {
              prevHash = window.location.hash;
              alert(window.location.hash);
           }
        }, 100);
    } 
```

编辑 - 自 jQuery 1.9 起，`$.browser.msie`不支持。来源：[http ://api.jquery.com/jquery.browser/](http://api.jquery.com/jquery.browser/)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-10-30T00:19:09.817

IE浏览器中处理History和window.location.hash有很多技巧：

*   正如原始问题所说，如果您从页面 a.html#b 转到 a.html#c，然后单击后退按钮，浏览器不知道该页面已更改。让我举个例子：window.location.href 将是 'a.html#c'，无论你是在 a.html#b 还是 a.html#c。

*   *实际上，仅*当页面中先前存在元素 '<a name="#b">' 和 '<a name="#c">' 时，a.html#b 和 a.html#c 才会存储在历史记录中。

*   但是，如果您将 iframe 放入页面中，则在该 iframe 中从 a.html#b 导航到 a.html#c，然后单击后退按钮，iframe.contentWindow.document.location.href 会按预期更改。

*   如果您在代码中使用 'document.domain= *something* '，则无法访问 iframe.contentWindow.document.open()'（许多历史管理器都会这样做）

我知道这不是真正的回应，但也许 IE 历史记录对某人有用。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2010-06-24T17:29:30.410

Firefox 从 3.6 开始就有 onhashchange 事件。请参阅*[window.onhashchange](https://developer.mozilla.org/en/DOM/window.onhashchange)*。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2010-10-19T17:46:29.727

Ben Alman 有一个很棒的 jQuery 插件来处理这个问题：http: [//benalman.com/projects/jquery-hashchange-plugin/](http://benalman.com/projects/jquery-hashchange-plugin/)

如果你不使用 jQuery，它可能是一个有趣的 dissect 参考。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2010-10-29T09:04:18.900

您可以轻松地在“window.location”对象的“hash”属性上实现观察者（“watch”方法）。

Firefox 有[自己的实现来观察对象的变化](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/watch)，但是如果你使用一些其他的实现（比如*[在 JavaScript 中观察对象属性的变化](https://stackoverflow.com/questions/1269633/watch-for-object-properties-changes-in-javascript)*）——对于其他浏览器来说，这会成功。

代码将如下所示：

```
window.location.watch(
    'hash',
    function(id,oldVal,newVal){
        console.log("the window's hash value has changed from "+oldval+" to "+newVal);
    }
); 
```

然后你可以测试它：

```
var myHashLink = "home";
window.location = window.location + "#" + myHashLink; 
```

当然，这会触发你的观察者功能。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2017-12-07T14:36:04.380

我在反应应用程序中使用它来使 URL 根据用户所在的视图显示不同的参数。

我观看了哈希参数使用

```
window.addEventListener('hashchange', doSomethingWithChangeFunction()); 
```

然后

```
doSomethingWithChangeFunction () { 
    // Get new hash value
    let urlParam = window.location.hash;
    // Do something with new hash value
}; 
```

工作得很好，可以使用前进和后退浏览器按钮以及浏览器历史记录。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-03-25T09:31:58.407

一个不错的实现可以在[http://code.google.com/p/reallysimplehistory/](http://code.google.com/p/reallysimplehistory/)找到。唯一（但也是）问题和错误是：在 Internet Explorer 中手动修改位置哈希将重置整个历史堆栈（这是浏览器问题，无法解决）。

请注意，Internet Explorer 8 确实支持“hashchange”事件，并且由于它正在成为 HTML5 的一部分，因此您可能希望其他浏览器能够赶上。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-08-28T17:00:33.050

另一个很好的实现是[jQuery History](http://www.balupton.com/projects/jquery-history)，如果浏览器支持它，它将使用本机 onhashchange 事件，如果不支持，它将为浏览器使用适当的 iframe 或间隔，以确保成功模拟所有预期的功能。它还提供了一个很好的接口来绑定到某些状态。

另一个值得注意的项目是[jQuery Ajaxy](http://www.balupton.com/projects/jquery-ajaxy)，它几乎是 jQuery History 的一个扩展，用于将 ajax 添加到组合中。当您开始使用带有哈希的 ajax 时，它变得[非常复杂](https://stackoverflow.com/questions/3205900/how-to-show-ajax-requests-in-url/3276206#3276206)！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-02-25T02:40:16.163

```
var page_url = 'http://www.yoursite.com/'; // full path leading up to hash;
var current_url_w_hash = page_url + window.location.hash; // now you might have something like: http://www.yoursite.com/#123

function TrackHash() {
    if (document.location != page_url + current_url_w_hash) {
        window.location = document.location;
    }
    return false;
}
var RunTabs = setInterval(TrackHash, 200); 
```

就是这样......现在，无论何时您点击后退或前进按钮，页面都会根据新的哈希值重新加载。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-01-02T22:23:11.933

我一直在使用 path.js 进行客户端路由。我发现它非常简洁和轻量级（它也已发布到 NPM），并且使用了基于哈希的导航。

[path.js NPM](https://www.npmjs.com/package/pathjs "path.js npm")

[路径.js GitHub](https://github.com/mtrpcic/pathjs "路径.js GitHub")

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-12-28T17:25:55.300

我使用了一个 jQuery 插件[HUtil](http://jstalkies.blogspot.com/2009/10/history-utility.html)，并在其上编写了一个类似[YUI](http://en.wikipedia.org/wiki/Yahoo!_UI_Library) History 的界面。

检查一次。如果您需要帮助，我可以提供帮助。

# c# - 重命名文件夹中的一些文件

> ID：680786
> 
> 赞同：57
> 
> 时间：2009-03-25T09:10:25.573
> 
> 标签：c#, .net

我的任务是使用 C# 更改文件夹中某些文件的名称（即，动态地将 id 添加到每个名称中）。

示例：help.txt 到 1help.txt

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-03-25T09:12:32.993

看看[FileInfo](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.aspx)。

做这样的事情：

```
void RenameThem()
{
    DirectoryInfo d = new DirectoryInfo("c:/dir/");
    FileInfo[] infos = d.GetFiles("*.myfiles");
    foreach(FileInfo f in infos)
    {
        // Do the renaming here
        File.Move(f.FullName, Path.Combine(f.DirectoryName, "1" + f.Name));
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-10T18:26:40.120

我将把它放在这里，因为我需要为自己的目的编写这段代码。

```
using System;
using System.IO;

public static class FileSystemInfoExtensions
{
    public static void Rename(this FileSystemInfo item, string newName)
    {
        if (item == null)
        {
            throw new ArgumentNullException("item");
        }

        FileInfo fileInfo = item as FileInfo;
        if (fileInfo != null)
        {
            fileInfo.Rename(newName);
            return;
        }

        DirectoryInfo directoryInfo = item as DirectoryInfo;
        if (directoryInfo != null)
        {
            directoryInfo.Rename(newName);
            return;
        }

        throw new ArgumentException("Item", "Unexpected subclass of FileSystemInfo " + item.GetType());
    }

    public static void Rename(this FileInfo file, string newName)
    {
        // Validate arguments.
        if (file == null)
        {
            throw new ArgumentNullException("file");
        }
        else if (newName == null)
        {
            throw new ArgumentNullException("newName");
        }
        else if (newName.Length == 0)
        {
            throw new ArgumentException("The name is empty.", "newName");
        }
        else if (newName.IndexOf(Path.DirectorySeparatorChar) >= 0
            || newName.IndexOf(Path.AltDirectorySeparatorChar) >= 0)
        {
            throw new ArgumentException("The name contains path separators. The file would be moved.", "newName");
        }

        // Rename file.
        string newPath = Path.Combine(file.DirectoryName, newName);
        file.MoveTo(newPath);
    }

    public static void Rename(this DirectoryInfo directory, string newName)
    {
        // Validate arguments.
        if (directory == null)
        {
            throw new ArgumentNullException("directory");
        }
        else if (newName == null)
        {
            throw new ArgumentNullException("newName");
        }
        else if (newName.Length == 0)
        {
            throw new ArgumentException("The name is empty.", "newName");
        }
        else if (newName.IndexOf(Path.DirectorySeparatorChar) >= 0
            || newName.IndexOf(Path.AltDirectorySeparatorChar) >= 0)
        {
            throw new ArgumentException("The name contains path separators. The directory would be moved.", "newName");
        }

        // Rename directory.
        string newPath = Path.Combine(directory.Parent.FullName, newName);
        directory.MoveTo(newPath);
    }
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-25T09:15:18.027

您正在寻找的功能是`File.Move(source, destination)`名称`System.IO`空间。还要查看`DirectoryInfo`类（相同命名空间的）以访问文件夹的内容。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-10T11:58:33.863

在 .NET Framework 4.0 上，我使用`FileInfo.MoveTo()`只需要 1 个参数的方法

只是为了移动文件我的方法看起来像这样

```
private void Move(string sourceDirName, string destDirName)
{
    DirectoryInfo dir = new DirectoryInfo(sourceDirName);
    FileInfo[] files = null;

    files = dir.GetFiles();

    foreach (FileInfo file in files)
    {
        string temppath = Path.Combine(destDirName, file.Name);
        file.MoveTo(temppath);
    }
} 
```

重命名文件我的方法看起来像这样

```
private void Rename(string folderPath)
{
   int fileCount = 0;

   DirectoryInfo dir = new DirectoryInfo(folderPath);

   files = dir.GetFiles();

   foreach (FileInfo file in files)
   {
       fileCount += 1;
       string newFileName = fileCount.ToString() + file.Name;
       string temppath = Path.Combine(folderPath, newFileName);

       file.MoveTo(temppath);
   }
} 
```

如您所见，重命名文件的语法与移动文件几乎相同，只需修改使用`filename`前的`MoveTo()`方法即可。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-25T09:16:20.473

查看*[如何在 C# 中重命名文件？](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/435a2692-6161-4039-bfa9-5e6211d90c49/)*. 我不知道[C#](http://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29)没有重命名...看来您必须使用`System.IO.File.Move(oldFileName, newFileName)`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-07T08:20:01.303

您可以使用[File.Move](http://msdn.microsoft.com/en-us/library/system.io.file.move%28v=vs.110%29.aspx)，如下所示：

```
string oldFilePath = Path.Combine( Server.MapPath("~/uploads"), "oldFileName");
string newFilePath = Path.Combine( Server.MapPath("~/uploads"), "newFileName");

File.Move(oldFilePath, newFilePath); 
```

# c# - 如何使用网络路径获取默认打印机名称

> ID：680788
> 
> 赞同：10
> 
> 时间：2009-03-25T09:11:04.183
> 
> 标签：c#, vb.net

我想使用网络路径获取默认打印机名称。因为我使用网络打印机作为默认打印机。所以我在 VB.NET 或 C#.Net 中需要这个。需要帮助。提前致谢

西瓦库玛

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-25T12:06:34.743

尝试枚举`System.Drawing.Printing.PrinterSettings.InstalledPrinters`.

```
using System.Drawing.Printing;
string GetDefaultPrinter()
{
    PrinterSettings settings = new PrinterSettings();
    foreach (string printer in PrinterSettings.InstalledPrinters)
    {
        settings.PrinterName = printer;
        if (settings.IsDefaultPrinter)
            return printer;
    }
    return string.Empty;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-24T06:10:41.280

这不太好用。我在更多机器上拥有更好的经验

```
DllImport("winspool.drv", CharSet=CharSet.Auto, SetLastError=true)]
public static extern bool GetDefaultPrinter(StringBuilder pszBuffer, ref int size);

StringBuilder dp = new StringBuilder(256);
int size = dp.Capacity;
if (GetDefaultPrinter(dp, ref size)) {
        Console.WriteLine(String.Format("Printer: {0}, name length {1}", dp.ToString().Trim(), size));
} else {
    int rc = GetLastError();
    Console.WriteLine(String.Format("Failed. Size: {0}, error: {1:X}", size, rc));
} 
```

# flash - 在多个动态文本字段中嵌入字符

> ID：680789
> 
> 赞同：0
> 
> 时间：2009-03-25T09:11:21.297
> 
> 标签：flash, actionscript, text, actionscript-2, character

如何一次嵌入一些字符，并将它们嵌入到我的所有动态文本字段中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T10:19:57.607

我认为默认情况下你不能这样做，但你可以做一些接近的事情： 1\. 你去图书馆，选择“新字体”。2\. 您选择您的字体，例如“Myriad Pro”，选中“export for Actionscript”复选框。您会收到有关不存在且在运行时生成的类的消息 - 您按“确定”，不用担心。3\. 定义动态文本字段时，请执行以下操作：

```
var textFormat:TextFormat = new TextFormat();
textFormat.font = 'Myriad Pro';
textBox.setTextFormat(textFormat);
textBox.defaultTextFormat = textFormat; 
```

当然，如果大小或其他属性不存在差异，则只需要定义一次 textFormat 即可。`setTextFormat(textFormat)`应用于文本框中已经存在的文本，而应用于`defaultTextFormat`将从该点添加到文本框中的文本。

这应该够了吧。在 Flash CS4 中测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T10:04:00.950

如果您使用的是 Flash IDE，则可以使用[JSFL](http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=Part7_Extending_Flash_1.html)在文本字段中自动嵌入字符。[这是一个例子。](http://blog.samueltoth.com/?p=142)

# mysql - 如何将字符串添加到 MySQL 中的列值？

> ID：680801
> 
> 赞同：137
> 
> 时间：2009-03-25T09:15:26.917
> 
> 标签：mysql, sql-update

我需要一个 SQL 更新语句来更新所有行的特定字段，并在现有值的前面添加一个字符串“test”。

例如，如果现有值为“try”，则应变为“testtry”。

* * *

## 回答 #1

> 赞同：282
> 
> 时间：2009-03-25T09:18:37.317

您可以使用[CONCAT](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat)函数来执行此操作：

```
UPDATE tbl SET col=CONCAT('test',col); 
```

如果您想变得更聪明并且只更新尚未预先测试的列，请尝试

```
UPDATE tbl SET col=CONCAT('test',col)
WHERE col NOT LIKE 'test%'; 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-25T09:18:43.213

```
UPDATE tablename SET fieldname = CONCAT("test", fieldname) [WHERE ...] 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-06-06T06:40:12.273

MySQL 中的许多字符串更新函数似乎是这样工作的：如果一个参数是`null`，则连接或其他函数`null`也会返回。因此，要使用`null`值更新字段，首先将其设置为非空值，例如`''`

例如：

```
update table set field='' where field is null;
update table set field=concat(field,' append'); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-25T09:18:02.730

这是一个简单的

```
UPDATE YourTable SET YourColumn = CONCAT('prependedString', YourColumn); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-14T12:41:40.697

*   UPDATE table_name SET Column1 = CONCAT('newtring', table_name.Column1) 其中 1
*   UPDATE table_name SET Column1 = CONCAT('newtring', table_name.Column2) 其中 1
*   UPDATE table_name SET Column1 = CONCAT('newtring', table_name.Column2, 'newtring2') 其中 1

我们可以连接同一列或表的其他列。

# django - django 应用程序是否有可能知道用户的 Windows 域名？

> ID：680804
> 
> 赞同：0
> 
> 时间：2009-03-25T09:17:42.857
> 
> 标签：django, login, dns

我需要制作一个简单的知识库类型的应用程序以在公司内部网络中使用。为了使最终用户使用起来简单快捷，我想部分跳过所有登录（因为它只对我们信任的内部网络用户可见）并自动从用户那里提取域用户名并放入它进入数据库（不希望人们浪费时间手动输入他们的名字；他们使用应用程序浪费的时间越少，他们实际使用它的机会就越大）。

那么，是否有可能在服务器上获取此类信息？Windows 浏览器是否将它发送到一些我可以信任的标头中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T09:25:30.763

如果您使用 IIS 和 Internet Explorer，您可以打开“集成 Windows 身份验证”（NTLM 身份验证）。这会导致 IE 使用您的域基础结构自动对用户进行身份验证。自动登录后，您可以使用环境变量访问用户名`LOGON_USER`。为此目的还有一个 Apache (mod_ntlm) 模块，尽管我不知道它的状态。

也许您可以尝试自己实现[NTLM 身份验证](http://davenport.sourceforge.net/ntlm.html)，但这肯定会做很多工作。

除此之外，似乎没有办法，因为没有合理的浏览器会发送用户名......

* * *

**编辑：**似乎[python-win32 扩展](http://python.net/crew/mhammond/win32/Downloads.html)或[python-ntlm](http://code.google.com/p/python-ntlm/)可以解决问题，请查看[此线程](http://code.google.com/p/python-ntlm/issues/detail?id=4)。不过，您仍然必须将其集成到 Django 中。

# wpf - Silverlight 2.0 透视/Z 比例

> ID：680811
> 
> 赞同：1
> 
> 时间：2009-03-25T09:18:41.327
> 
> 标签：wpf, silverlight-2.0, expression-blend

如何设置 Z-Scale 一些 silverlight 元素？我可以在 Properties > Transform > Scale > Z 中看到 Z-Scale 属性，但它没有激活，我无法修改。我需要做什么来编辑 Z 比例。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T09:23:08.427

Z-Scale 和透视图适用于基于 WPF（Windows）的 XAML 接口，SL2 不支持它。SL3 将带来视角。现在，SL3 的测试版已经发布，但您只能拥有一个开发环境 - 如果您为 VS2008 安装 SL3 工具，您将失去 SL2 开发工具！

# jquery - 将 JQuery 数据选择器与输入字段验证/过滤器相结合

> ID：680816
> 
> 赞同：0
> 
> 时间：2009-03-25T09:19:24.427
> 
> 标签：jquery, jquery-ui, jquery-plugins

我正在使用 JQueryui 日期选择器。但它并不真正影响在输入字段中手动输入的值。有什么方法可以使用相同的（客户端）代码在输入字段上指定掩码/验证（当不使用数据选择器时 - 不仅仅是让日期选择器输出正确的格式）。

在 JQuery 框架中执行此操作的最一致的方法是什么？

谢谢

评论

1.  似乎 jQuery 对输入施加了一些限制（即我只能输入数字-掩码“yymmdd”），所以主要是获得验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T09:30:22.263

您可以使用 datepicker 的 formatDate 选项：http: [//docs.jquery.com/UI/Datepicker/formatDate](http://docs.jquery.com/UI/Datepicker/formatDate)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T12:38:03.967

使用[jQuery 验证插件](http://docs.jquery.com/Plugins/Validation)。它与 UI 日期选择器共存；我们在我们的应用程序中这样做。请注意，默认日期验证器不会标记明显无效的日期，例如“2009 年 2 月 40 日”，因为它使用 JavaScript 日期解析器，这对于它接受的内容有点松懈。[但是用你自己的一个替换默认验证器](http://blogs.teamb.com/craigstuntz/2009/01/15/37923/)真的很容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-26T23:01:50.810

假设您使用的是 Validate 插件，您可以编写一个自定义规则，重新实现 ui.Datepicker 自己的逻辑来决定哪些日期是可选的。我今天不得不写这篇文章，并认为其他人可以从知道如何中受益：

```
jQuery.validator.addMethod("vdate", function(value, element) {
    // Datepicker's internal method for choosing selectable ported to a custom validator method.
    // All criteria are the same, except othermonth is omitted.
    var inst =          $.data(element,'datepicker'); // instance data used internally by datepicker's functions
    var printDate =     $(element).datepicker("getDate");
    var minDate =       $.datepicker["_getMinMaxDate"](inst, 'min', true);
    var maxDate =       $.datepicker["_getMinMaxDate"](inst, 'max');
    var beforeShowDay = $.datepicker["_optionDatepicker"](element,'beforeShowDay');
    var daySettings =   (beforeShowDay ? beforeShowDay.apply((inst.input ? inst.input[0] : null), [printDate]) : [true, '']);
    var unselectable =  (!daySettings[0] || (minDate !=null && (printDate < minDate)) || (maxDate !=null && (printDate > maxDate)));
    return (this.optional(element) || !unselectable);
}, "Please choose a valid date"); 
```

这种特殊的 addMethod 具有单独检查每个字段的优势，因此如果您有多个日期选择器共享类名“vdate”但可能具有不同的 minDate/maxDate/beforeShowDay 设置，验证将检查并遵循每个日期选择器自己的规则。

此外，如果你为 beforeShowDay 编写了一个复杂的函数，它不包括周末、数字为素数的日子、你妻子的生日和每个月的最后一天，只要它在 ui.Datepicker 中工作，Validate 就会识别所有这些无效日期也是如此。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-24T16:11:11.497

你有什么理由不能做最简单的事情吗？

挂钩一个事件，例如在日期字段的模糊上，并检查如下值：

1.  将输入的长度与格式进行比较。
2.  解析日期并尝试创建一个日期对象以验证日期是否为实际日期。

# java - 是否可以在 JEditorPane 中缩放/缩放字体大小（和图像大小）

> ID：680817
> 
> 赞同：6
> 
> 时间：2009-03-25T09:19:32.853
> 
> 标签：java

是否可以在 JEditorPane 中以某种方式缩放文本和图片。

我不喜欢浏览所有的 HTML 页面来使字体变大。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-02-03T23:11:11.480

我制作了可以放大/缩小 JEditorPane 的 HTML 内容的自定义 HTMLEditorKit，它具有更好的渲染性能，我称之为**LargeHTMLEditorKit**：

```
/**
 * An extended {@link HTMLEditorKit} that allow faster
 * rendering of large html files and allow zooming of content.
 * @author Alessio Pollero
 * @version 1.0
 */
public class LargeHTMLEditorKit extends HTMLEditorKit {

     ViewFactory factory = new MyViewFactory();

        @Override
        public ViewFactory getViewFactory() {
            return factory;
        }

        class MyViewFactory extends HTMLFactory {
            @Override
            public View create(Element elem) {
                AttributeSet attrs = elem.getAttributes();
                Object elementName = attrs.getAttribute(AbstractDocument.ElementNameAttribute);
                Object o = (elementName != null) ? null : attrs.getAttribute(StyleConstants.NameAttribute);
                if (o instanceof HTML.Tag) {
                    HTML.Tag kind = (HTML.Tag) o;
                    if (kind == HTML.Tag.HTML) {
                        return new HTMLBlockView(elem);
                    }
                    else if (kind == HTML.Tag.IMPLIED) {
                        String ws = (String) elem.getAttributes().getAttribute(CSS.Attribute.WHITE_SPACE);
                        if ((ws != null) && ws.equals("pre")) {
                            return super.create(elem);
                        }
                        return new HTMLParagraphView(elem);
                    } else if ((kind == HTML.Tag.P) ||
                            (kind == HTML.Tag.H1) ||
                            (kind == HTML.Tag.H2) ||
                            (kind == HTML.Tag.H3) ||
                            (kind == HTML.Tag.H4) ||
                            (kind == HTML.Tag.H5) ||
                            (kind == HTML.Tag.H6) ||
                            (kind == HTML.Tag.DT)) {
                        // paragraph
                        return new HTMLParagraphView(elem);
                    }
                }
                return super.create(elem);
            }

        }

        private class HTMLBlockView extends BlockView {

            public HTMLBlockView(Element elem) {
                super(elem,  View.Y_AXIS);
            }

            @Override
            protected void layout(int width, int height) {
                if (width<Integer.MAX_VALUE) {
                    super.layout(new Double(width / getZoomFactor()).intValue(),
                             new Double(height *
                                        getZoomFactor()).intValue());
                }
            }

            public double getZoomFactor() {
                Double scale = (Double) getDocument().getProperty("ZOOM_FACTOR");
                if (scale != null) {
                    return scale.doubleValue();
                }

                return 1;
            }

            @Override
            public void paint(Graphics g, Shape allocation) {
                Graphics2D g2d = (Graphics2D) g;
                double zoomFactor = getZoomFactor();
                AffineTransform old = g2d.getTransform();
                g2d.scale(zoomFactor, zoomFactor);
                super.paint(g2d, allocation);
                g2d.setTransform(old);
            }

            @Override
            public float getMinimumSpan(int axis) {
                float f = super.getMinimumSpan(axis);
                f *= getZoomFactor();
                return f;
            }

            @Override
            public float getMaximumSpan(int axis) {
                float f = super.getMaximumSpan(axis);
                f *= getZoomFactor();
                return f;
            }

            @Override
            public float getPreferredSpan(int axis) {
                float f = super.getPreferredSpan(axis);
                f *= getZoomFactor();
                return f;
            }

            @Override
            public Shape modelToView(int pos, Shape a, Position.Bias b) throws BadLocationException {
                double zoomFactor = getZoomFactor();
                Rectangle alloc;
                alloc = a.getBounds();
                Shape s = super.modelToView(pos, alloc, b);
                alloc = s.getBounds();
                alloc.x *= zoomFactor;
                alloc.y *= zoomFactor;
                alloc.width *= zoomFactor;
                alloc.height *= zoomFactor;

                return alloc;
            }

            @Override
            public int viewToModel(float x, float y, Shape a,
                                   Position.Bias[] bias) {
                double zoomFactor = getZoomFactor();
                Rectangle alloc = a.getBounds();
                x /= zoomFactor;
                y /= zoomFactor;
                alloc.x /= zoomFactor;
                alloc.y /= zoomFactor;
                alloc.width /= zoomFactor;
                alloc.height /= zoomFactor;

                return super.viewToModel(x, y, alloc, bias);
            }

        }
} 
```

这是所需的**HTMLParagraphView**：

```
class HTMLParagraphView extends ParagraphView {

     public static int MAX_VIEW_SIZE=100;

        public HTMLParagraphView(Element elem) {
            super(elem);
            strategy = new HTMLParagraphView.HTMLFlowStrategy();
        }

        public static class HTMLFlowStrategy extends FlowStrategy {
            protected View createView(FlowView fv, int startOffset, int spanLeft, int rowIndex) {
                View res=super.createView(fv, startOffset, spanLeft, rowIndex);
                if (res.getEndOffset()-res.getStartOffset()> MAX_VIEW_SIZE) {
                    res = res.createFragment(startOffset, startOffset+ MAX_VIEW_SIZE);
                }
                return res;
            }

        }
        public int getResizeWeight(int axis) {
            return 0;
        }
} 
```

*然后你可以这样使用它：*

```
//Create a new JEditorPane
JEditorPane yourPane = new JEditorPane();
//Set the custom HTMLEditorKit
yourPane.setEditorKit(new LargeHTMLEditorKit());
//Set the zoom to 150%
yourPane.getDocument().putProperty("ZOOM_FACTOR", new Double(1.5)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T09:58:38.327

JEdi​​torPane 不支持这个，但你可以做一些扩展来添加你需要的功能......

尝试这个：

[http://www.developer.com/java/other/article.php/3315511](http://www.developer.com/java/other/article.php/3315511)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-14T19:38:42.503

查看[TransformUI](http://www.pbjar.org/blogs/jxlayer/jxlayer40/)，它是[JXLayer](https://jxlayer.dev.java.net/)的一个很酷的“扩展” 。开始[演示](http://www.pbjar.org/blogs/jxlayer/jxlayer40/TransformDemo.jnlp)，让您大吃一惊！;-)（点击“自动打包”复选框）

基本上，它所做的是在调用组件上的绘制之前设置缩放 AffineTransform，从而使组件所做的一切都按比例放大。因此，您的变焦就在那里..！

# sql - SQL 等式/不等式与可为空值的比较

> ID：680824
> 
> 赞同：4
> 
> 时间：2009-03-25T09:22:50.877
> 
> 标签：sql, postgresql, comparison, equality

首先采取，kludge解决方案，哨兵方法（您的程序必须不允许输入哨兵值）：

```
 select coalesce(a, -2147483648) = coalesce(b, -2147483648) as is_equal -- a little postgresism 
```

假设您忘记阻止程序中的标记值，用户在 B 字段中输入了 -2147483648，而 A 为空。上面的代码报告 true，应该报告 false，不应该报告 true 或 null。

在可空字段上比较相等性的最简洁方法是什么？A == B 应该只报告真或假，无论字段是否可以为空。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-25T09:48:41.207

可能[IS [NOT] DISTINCT FROM](http://www.postgresql.org/docs/current/static/functions-comparison.html)在这里会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T09:24:51.263

运算符 <=> 在其他数据库引擎中执行您想要的操作；它不在postgres中吗？否则，`a is null and b is null or (a is not null and b is not null and a == b)`应该工作。这有效，因为`FALSE AND NULL`is `FALSE`。

# python - python从字符串创建切片对象

> ID：680826
> 
> 赞同：10
> 
> 时间：2009-03-25T09:23:52.390
> 
> 标签：python, indexing, slice

我想从一个字符串创建一个切片对象；现在唯一的方法似乎是通过一个繁琐的 hacky eval 语句

```
class getslice:
    def __getitem__(self, idx): return idx[0]
eval("getslice()[%s, 1]" %(":-1")) 
```

提前致谢。

**编辑**：对不起，如果原始提示不清楚，在这种情况下输入是“：-1”。关键是解析字符串。Ignacio Vazquez-Abrams 的回应至少解决了这个问题（并且似乎也适用于反向索引），但我认为我上面的解决方案如果在概念上不干净（如果 Python 改变切片语法将正常工作）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T09:46:12.147

如果你想要一个切片对象，为什么不实例化一个呢？

```
s = slice(start, stop, step) 
```

“从字符串创建它”是什么意思？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-06-29T16:27:48.757

`slice(*map(lambda x: int(x.strip()) if x.strip() else None, mystring.split(':')))`

对于单个 arg 切片`'-1'`左右`'1'`，当`mystring.split(':')==1`您调用时`int(x)`

根据要求，将其从评论部分中删除。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-25T14:51:40.167

```
slice(*[{True: lambda n: None, False: int}[x == ''](x) for x in (mystring.split(':') + ['', '', ''])[:3]]) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-27T17:18:06.707

我最终来到这里是因为我希望我的脚本接受一个类似 python 的拼接参数并将其呈现为一个整数列表，我使用一个似乎回答了 OP 问题的函数来完成它：

```
# create a slice object from a string
def get_slice_obj(slicearg):
    slice_ints = tuple([ int(n) for n in slicearg.split(':') ])
    return apply(slice, slice_ints)

def ints_from_slicearg(slicearg):
    slice_obj = get_slice_obj(slicearg)
    return(range(slice_obj.start or 0, slice_obj.stop or -1, slice_obj.step or 1))

for t in ['1', '1:3', '4:9:2']:
    print t, "=>", ints_from_slicearg(t) 
```

输出：

```
1 => [0]
1:3 => [1, 2]
4:9:2 => [4, 6, 8] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-11-14T21:36:03.400

这是另一种方法（只是此处发布的其他方法的合并）：

```
def make_slice(expr):
    def to_piece(s):
        return s and int(s) or None
    pieces = map(to_piece, expr.split(':'))
    if len(pieces) == 1:
        return slice(pieces[0], pieces[0] + 1)
    else:
        return slice(*pieces) 
```

示例用法：

```
In [1]: make_slice(':')
Out[1]: slice(None, None, None)

In [2]: make_slice(':-2')
Out[2]: slice(None, -2, None)

In [3]: x = [1, 2, 3]

In [4]: x[make_slice('::-1')]
Out[4]: [3, 2, 1] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-01-29T12:28:08.820

来自 Ignacio Vazquez-Abrams 的单行代码很短但难以阅读，并且处理单个数字与`slice`. 这试图以更清洁的方式解析它。

```
def parse_slice(value):
    """
    Parses a `slice()` from string, like `start:stop:step`.
    """
    if value:
        parts = value.split(':')
        if len(parts) == 1:
            # slice(stop)
            parts = [None, parts[0]]
        # else: slice(start, stop[, step])
    else:
        # slice()
        parts = []
    return slice(*[int(p) if p else None for p in parts]) 
```

```
# unit tests:
try:
    assert parse_slice('')
    assert False, 'It should raise TypeError'
except TypeError:
    pass
assert parse_slice('2') == slice(2)
assert parse_slice('2:3') == slice(2, 3)
assert parse_slice(':3') == slice(None, 3)
assert parse_slice(':') == slice(None, None)
assert parse_slice('2:') == slice(2, None)
assert parse_slice('2:3:4') == slice(2, 3, 4)
assert parse_slice(':3:4') == slice(None, 3, 4)
assert parse_slice('2::4') == slice(2, None, 4)
assert parse_slice('2:3:') == slice(2, 3, None)
assert parse_slice('::4') == slice(None, None, 4)
assert parse_slice('2::') == slice(2, None, None)
assert parse_slice('::') == slice(None, None, None)
assert parse_slice('-12:-13:-14') == slice(-12, -13, -14)
assert parse_slice('2:3:-4') == slice(2, 3, -4)
try:
    parse_slice('1:2:3:4')
    assert False, 'It should raise TypeError'
except TypeError:
    pass 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-08-10T13:09:11.030

基于@pprzemak 起草了以下函数用于精细解析：

```
def parse_slice(v: Text):
    """
    Parses text like python "slice" expression (ie ``-10::2``).

    :param v:
        the slice expression or a lone integer
    :return:
        - None if input is None/empty
        - a ``slice()`` instance (even if input a lone numbrt)
    :raise ValueError:
        input non-empty but invalid syntax
    """
    orig_v = v
    v = v and v.strip()
    if not v:
        return

    try:
        if ':' not in v:
            ## A lone number given.
            v = int(v)
            return slice(v, v + 1)

        return slice(*map(lambda x: int(x.strip()) if x.strip() else None,
                          v.split(':')))
    except Exception:
        pass

    ## An alternative is to return `slice(None)` here.
    raise trt.TraitError("Syntax-error in '%s' slice!" % orig_v) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-06-29T14:20:01.860

这个怎么样（对于简单的非空切片间隔）：

```
sliceStr = "3:8"
mySlice = slice( *map(int, sliceStr.split(':') ) ) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-23T21:36:37.603

12年后我只需要这样做，所以这是我使用正则表达式的答案:)

```
import re
def parse_slice(string: str) -> slice:
    """
    Parse a string representation of a slice and return a slice object
    """
    # Matches one required colon, one optional colon, and up to three
    # positive or negative numbers between them
    match = re.match(r"^(-?[\d]*):(-?[\d]*)[:]?(-?[\d]*)$", string)
    if match:
        args = tuple(map(lambda s: int(s) if s else None, match.group(1, 2, 3)))
        return slice(*args)
    raise ValueError("Could not parse slice") 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-25T14:42:28.753

切片对象通常使用下标表示法创建，该表示法在内部使用 slice()，如[slice() 文档](http://docs.python.org/library/functions.html#slice)中所述。你想做的是：

```
your_string[start:end] 
```

从[python教程](http://docs.python.org/tutorial/introduction.html#strings)：

> 字符串可以下标（索引）；就像在 C 中一样，字符串的第一个字符的下标（索引）为 0。没有单独的字符类型；一个字符只是一个大小为 1 的字符串。就像在 Icon 中一样，子字符串可以用切片表示法指定：两个索引用冒号分隔。

```
>>> word = 'Help' + 'A' 
>>> word[4]
'A'
>>> word[0:2]
'He'
>>> word[2:4]
'lp' 
```

> 切片索引具有有用的默认值；省略的第一个索引默认为零，省略的第二个索引默认为被切片的字符串的大小。

```
>>> word[:2]    # The first two characters
'He'
>>> word[2:]    # Everything except the first two characters
'lpA' 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2019-08-20T13:07:59.100

我从字符串解析 numpy 样式高级索引的解决方案：[my gist](https://gist.github.com/kkew3/d1eed0984a3a44087c700215e99eefd2)。虽然这是一篇旧文章，但它是我能找到的关于这个主题的唯一一篇。希望能帮助到你。

根据建议，我将代码粘贴在这里，可能有点长......代码用法是（假设`a`是一个类似数组的对象）：给; 等等`a[parse_slice('1')]``a[1]``a[parse_slice('2:,-1')]``a[2:,-1]`

```
import re

SLICE_TEMPLATES = [
    ('s', r'(?P<i>[+-]?\d+)'),
    ('sp', r'\((?P<i>[+-]?\d+)\)'),
    ('a', r'::?'),
    ('ri-', r'(?P<i>[+-]?\d+)::?'),
    ('ri-k', r'(?P<i>[+-]?\d+)::(?P<k>[+-]?\d+)'),
    ('r-j', r':(?P<j>[+-]?\d+):?'),
    ('r-jk', r':(?P<j>[+-]?\d+):(?P<k>[+-]?\d+)'),
    ('rij', r'(?P<i>[+-]?\d+):(?P<j>[+-]?\d+):?'),
    ('rijk', r'(?P<i>[+-]?\d+):(?P<j>[+-]?\d+):(?P<k>[+-]?\d+)'),
    ('r--k', r'::(?P<k>[+-]?\d+)'),
    ('l', r'\.\.\.'),
    ('eb', r'\[(?P<e>[+-]?\d+(,[+-]?\d+)*,?)\]'),
    ('ep', r'\((?P<e>[+-]?\d+(,[+-]?\d+)+,?)\)'),
    ('ep1', r'\((?P<e>[+-]?\d+,)\)'),
]
SLICE_TEMPLATES = [(k, re.compile(v)) for k, v in SLICE_TEMPLATES]

def tokenize_slice_groups(string):
    # tokenize groups
    groups = []
    sbuf = []
    expecting = {'(': ')', '[': ']'}
    pbbuf = []
    LEGAL_CHARS = '0123456789()[]+-:.'
    WHITESPACE_CHARS = ' \t'

    for c in string:
        if c in WHITESPACE_CHARS:
            pass
        elif c == ',':
            if len(pbbuf) not in (0, 2):
                sbuf.append(c)
            else:
                groups.append(''.join(sbuf))
                sbuf.clear()
                pbbuf.clear()
        elif c in LEGAL_CHARS:
            sbuf.append(c)
            if c in '([':
                if pbbuf:
                    raise ValueError('too many brackets in axis {}'.format(
                        len(groups)))
                pbbuf.append(c)
            elif c in ')]':
                if not pbbuf:
                    raise ValueError('brackets not match in axis {}'.format(
                        len(groups)))
                if c != expecting[pbbuf[0]]:
                    raise ValueError('brackets not match in axis {}'.format(
                        len(groups)))
                pbbuf.append(c)
        else:
            raise ValueError('illegal char `{}\''.format(c))
    groups.append(''.join(sbuf))
    return groups

def parse_slice_group(string):
    for name, tem in SLICE_TEMPLATES:
        matched = tem.fullmatch(string)
        if matched:
            if name[0] == 's':
                return int(matched.group('i'))
            if name[0] == 'a':
                return slice(None, None, None)
            if name[0] == 'r':
                i, j, k = None, None, None
                if 'i' in name:
                    i = int(matched.group('i'))
                if 'j' in name:
                    j = int(matched.group('j'))
                if 'k' in name:
                    k = int(matched.group('k'))
                return slice(i, j, k)
            if name[0] == 'l':
                return ...
            # if name[0] == 'e'
            return list(map(int, filter(None, matched.group('e').split(','))))
    raise ValueError('illegal group "{}"'.format(string))

def parse_slice(string):
    groups = tokenize_slice_groups(string)
    if groups == ['']:
        raise ValueError('index must not be empty')
    if groups and groups[-1] == '':
        del groups[-1]
    index = tuple(map(parse_slice_group, groups))
    if index.count(...) > 1:
        raise ValueError('ellipsis may occur at most once')
    return index 
```

# visual-studio - 对话框在 60 秒内不可用

> ID：680827
> 
> 赞同：0
> 
> 时间：2009-03-25T09:23:59.660
> 
> 标签：visual-studio, nunit, watin

我试图在一个函数中使用两次 Dialog 处理程序。第一次它执行得很好，但第二次它挂起系统并打开对话框并显示“确定”和“取消”按钮，但永远无法单击它。它也超时并出现错误“对话框在 60 秒内不可用”

```
Dim cdhPopup As ConfirmDialogHandler 
cdhPopup = New ConfirmDialogHandler() 
If (ie.Button(Find.ById("btnDelete")).Exists) Then
    'Cancel the booking '
    ie.AddDialogHandler(cdhPopup) 
    ie.Button(Find.ById("btnDelete")).ClickNoWait() 
    cdhPopup.WaitUntilExists() 
    cdhPopup.OKButton.Click() 
    ie.WaitForComplete() 'Wait for page to finish loading '
Else 
    Assert.Fail("Could not found the Cancel Button") 
End If 
```

在我的代码中的 2 个地方使用它，第一次它执行良好，第二次在同一函数中它给出对话框不可用而它是可用的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T11:09:09.017

My best guess is that in the second pass you are again calling `ie.AddDialogHandler(cdhPopup)`, thereby registering it a second time, which is somehow crashing the program when the handlers are invoked (cross thread access to internal variables maybe?)

You should perform a check if the handler is registered, and only register it if it isn't.

# c# - 谁将 BeginInvoke、Invoke 和 EndInvoke 方法定义添加到类型化委托？

> ID：680828
> 
> 赞同：3
> 
> 时间：2009-03-25T09:24:07.677
> 
> 标签：c#, delegates

例如，如果您编写...
`public delegate void MyTypedDel(int x)`
Intellisense 显示 BeginInvoke、Invoke 和 EndInvoke 是 MyTypedDel 类型定义的一部分。
它们不是 Delegate 或 MulticastDelegate 类型定义的一部分。（Delegate 有一个 DynamicInvoke 方法，它使用后期/运行时绑定来绑定到一个方法。）

所以我的问题是这些方法在哪里混合到类型化委托类型定义中，它的实现是什么样的？我读到... Invoke 在同一线程上连续调用内部调用 BeginInvoke 和 EndInvoke。这是真的？

只是好奇这里的引擎盖下的魔法..也许我错过了一些非常明显的东西......在这种情况下是残酷的:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T09:26:51.273

编译器生成您的委托类，该类扩展`Delegate`BCL 类并添加特定于您的委托签名的方法。您可以通过在反射器中查看您的委托（或 BCL 委托）并切换到 IL 视图来看到这一点（因为 C# 反汇编程序足够聪明，可以将其转回委托声明）。例子：

```
.class public auto ansi sealed WaitCallback
    extends System.MulticastDelegate
{
    .custom instance void System.Runtime.InteropServices.ComVisibleAttribute::.ctor(bool) = { bool(true) }
    .method public hidebysig specialname rtspecialname instance void .ctor(object 'object', native int 'method') runtime managed
    {
    }

    .method public hidebysig newslot virtual instance class System.IAsyncResult BeginInvoke(object state, class System.AsyncCallback callback, object 'object') runtime managed
    {
    }

    .method public hidebysig newslot virtual instance void EndInvoke(class System.IAsyncResult result) runtime managed
    {
    }

    .method public hidebysig newslot virtual instance void Invoke(object state) runtime managed
    {
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T09:34:46.777

编译器完成了大部分工作（参见 Kent 的回复）。关于连续调用Begin/End的问题；不，不适合代表。您可以验证这一点，因为`BeginInvoke`将工作推送到`ThreadPool`, where-就好像您使用`Invoke`工作发生在当前线程上一样。

然而，这种方法在其他一些 Begin/End 对（特别是 IO 绑定操作）中很常见；但不适用于代表。

我一直在寻找更优雅的调用 Begin/End 的方式（不搞乱`IAsyncResult`等） -[请参阅此处了解更多信息](http://marcgravell.blogspot.com/2009/02/async-without-pain.html)。

# database-design - Hadoop Hbase：是否跨表传播列族

> ID：680834
> 
> 赞同：12
> 
> 时间：2009-03-25T09:25:15.757
> 
> 标签：database-design, hadoop, hbase

Hbase 文档清楚地表明您应该将类​​似的列分组到列族中，因为物理存储是由列族完成的。

但是，将两个列族放入同一个表中，而不是每个列组有单独的表，这意味着什么？是否存在以这种方式“分区”表更有意义的特定情况，以及一个“宽”表效果更好的情况？

单独的表应该导致单独的“行区域”，当某些列族（作为一个整体）非常稀疏时，这可能是有益的。相反，什么时候将列族聚集在一起是有利的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T18:22:53.760

您已经了解了列族的概念：基本上，它只是提示 HBase 将这些项目存储和复制在一起以便更快地访问。

如果您将两个列族放在同一个表中，并且始终使用不同的键来访问它们，那么这实际上与将它们放在两个单独的表中是一回事。您只能通过在同一个表中拥有两个通过相同键访问的列族获得收益。

例如：如果我有给定网站的总浏览量、同一网站的唯一浏览量、用户用于查看该网站的浏览器以及他们的互联网连接的列，我可以决定我想要前两个是列族，后两个是另一个列族。在这里，所有四个都通过相同的键访问，即所讨论的网站，所以我通过将它们放在同一个表中获得了收益。

如果它们在不同的表中，我最终将不得不对两个表进行类似连接的操作。我真的不知道这些数字，所以我不能真正告诉你类似连接的操作有多慢（因为我不记得 HBase 有一个连接，因为它是非关系的）以及分裂的临界点是什么将它们放在单独的表中比将它们放在同一个表中（反之亦然）更重要。

当然，这一切都取决于您要存储的数据，因此如果您永远不需要跨表连接，您可能希望将它们保存在单独的表中，因为您可能会争辩说它们彼此之间没有那么相关首先。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-07-14T01:14:00.420

列族是面向行与面向列访问之间的折衷。为了扩展 Chris 的网页示例，行访问将获取单个网站的所有数据（列）。面向列的操作的一个示例是对所有站点的页面浏览量求和。

后一种操作不需要浏览器和连接详细信息，这些详细信息远大于视图计数的数值，并且会显着影响查询性能。因此，HBase 提供了列族作为支持列操作的优化。

至于列是否应该在同一个表中......如果它们是同一实体的属性，我只会遵循正常的数据建模准则并将所有列放在同一个表中。列族是关于性能而不是模式。

# sql - Linq to Sql 和 Non-PK、unique-FK 关系问题

> ID：680842
> 
> 赞同：0
> 
> 时间：2009-03-25T09:27:27.030
> 
> 标签：sql, sql-server, linq, linq-to-sql, entity-framework

我最近一直在阅读 Louis Davidson 的关于 Sql Server 数据库设计的书，发现它提供了很多信息。我已经了解了很多我以前不知道（或任何东西）的概念。主要是——我找到了一种建立数据库关系的方法，这是我以前从未尝试过的。

基本上，您使用代理键作为表 PK（自动递增的 id 字段），然后设置一个或多个由一个或多个唯一键组成的备用键。然后，这些备用 kays 将是用于关系的值（或 PK，如果这对给定的关系更有意义）。

我改造了一个旧数据库，该数据库由于设计不佳而遭受一些数据不一致的困扰，以实现这种对我来说是新的思维方式。

在数据库级别上它工作得很好。Tha 关系按照它们应有的方式发挥作用，并且约束以一致、可靠的方式强制执行。

**然而**

我无法让它在实体框架或 Linq to Sql 类中正常工作。我在 EF 的 V1 中读到，它完全不支持这种关系 - 所以我转向 Linq to Sql 看看事情是否会更好。他们似乎做到了，因为当我从数据库中导入类时，所有关系都自动映射出来。问题是，一旦我尝试保存数据，由于 InvalidCastOperation 异常，我无法将数据保存到数据库中。

所以我有几个问题：

1.  这是 Linq To Sql 的限制吗？
2.  如果是这样，有没有办法解决它？最好不要为保存、更新和删除实现存储过程——类型安全是我想保留的。
3.  这种设计数据库关系的方式是“正确的”和/或一种好的做法吗？

我希望有人能对此有所了解，因为我对此感到非常沮丧。我真的无法在网上找到任何关于这个主题的好材料——所以希望这里有人能给出答案或者可以为我指明正确的方向。

非常感谢！

编辑 - 解决方案。

我最终做的是——我回到使用实体框架并重新设计数据库模式。在大多数情况下，我将关系改造成依赖主键而不是备用键。如果这不是一个选项 - 我对 EF 布局进行了一些修改。我实现了依赖于 AK 的关系——此时 EF 抱怨。为了解决这个问题，我必须在关系的多方面删除外键属性，此时 EF 接受该关系。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T10:29:05.750

1) 是的。

2）如果您可以在 L2S 模型中将您的备用密钥标记为主要密钥并将真实 PK 取消标记为 PK，那么它将起作用。

3) 从 db 的角度来看，没有错，但正如您所注意到的，L2S 或 EF 不支持它。就我个人而言，我更喜欢总是让 FK 指向 PK，并且只使用 AK 进行查找。

# qt - 有没有一种简单的方法可以在 Qt 中恢复小部件的大小？

> ID：680844
> 
> 赞同：1
> 
> 时间：2009-03-25T09:28:12.957
> 
> 标签：qt, qtgui

我正在寻找一种方法来保留 Qt 应用程序中窗口的大小。

我已经看到可以为每个小部件使用以下方法：

```
saveGeometry() 
```

但实际上，我不觉得这是一种令人满意的方法。有没有类似的东西`setAutosaveGeometry(True)`？

我特别在寻找一种存储表格列宽度的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T20:40:11.123

QHeaderView类也有两种方法可以在[QByteArray](http://doc.trolltech.com/4.5/qheaderview.htm)中保存和恢复它的状态：saveState() 和 restoreState()

表格视图的标题可以通过 Horizo​​ntalHeader() 和 verticalHeader() 方法访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T11:18:03.177

saveGeometry 返回一个 QByteArray 值，您需要将它存储在某个地方。

例子：

```
无效 MainWindow::closeEvent(QCloseEvent *event){
    QSettings 设置；

    settings.setValue("几何", saveGeometry());
}
```

要读取几何图形，请调用 restoreGeometry 函数：

```
MainWindow::MainWindow(QWidget *parent):QMainWindow(parent) {
    [...]

    QSettings 设置；

    restoreGeometry(settings.value("geometry").toByteArray());

    [...]
}
```

要了解有关窗口几何形状[的更多信息，请阅读文档](http://doc.trolltech.com/4.5/geometry.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T20:32:01.567

请参阅有关[恢复 Window's Geometry](http://doc.trolltech.com/4.5/geometry.html#restoring-a-window-s-geometry)的 Qt 文档。

# c# - XAML 矩形属性触发问题

> ID：680853
> 
> 赞同：1
> 
> 时间：2009-03-25T09:32:25.927
> 
> 标签：c#, wpf, xaml

我有一个 WPF 应用程序，其 Rectangle 触发器定义为：

```
<Style TargetType="{x:Type Rectangle}">
   <Setter Property="Rectangle.StrokeThickness" Value="1"/>
   <Style.Triggers>
      <Trigger Property="IsMouseOver" Value="True">
         <Setter Property="Rectangle.StrokeThickness" Value="4"/>
      </Trigger>
   </Style.Triggers>
</Style> 
```

一个矩形为：

```
<Rectangle Fill="Blue" StrokeThickness="2" Stroke="Black" Height="20" Width="50" /> 
```

鼠标悬停时，矩形不会改变笔画粗细。为什么不？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T10:15:23.123

从 Rectangle 对象中删除 StrokeThickness="2" ，它应该可以工作..

当您直接在 Rectangle 上设置属性时，您将覆盖 StrokeThickness 样式...

# iphone - 在 UIImageView 中画一条线的问题

> ID：680855
> 
> 赞同：1
> 
> 时间：2009-03-25T09:32:34.990
> 
> 标签：iphone, cocoa-touch, uikit, core-graphics

在我的应用程序中，我可以通过下面的代码在 UIImageView 中画一条线，当我调用该函数时，我想重画这条线更长的时间，但是，输出结果与预期不同，它只会画一条新线并删除旧的，长度保持不变，只是 y 位置不同，我不知道我的代码哪一行是错误的，或者我没有以正确的方式理解 CGContext 类，请帮助我整天摸不着头脑，找不到解决问题

```
- (void) drawLine {
    lastPoint = currentPoint;
    lastPoint.y -= 40;

    //drawImage is a UIImageView declared at header
    UIGraphicsBeginImageContext(drawImage.frame.size);
    [drawImage.image drawInRect:CGRectMake(0, 0, drawImage.frame.size.width, drawImage.frame.size.height)];

    //sets the style for the endpoints of lines drawn in a graphics context
    CGContextRef ctx = UIGraphicsGetCurrentContext();
    CGContextSetLineCap(ctx, kCGLineCapButt);
    //sets the line width for a graphic context
    CGContextSetLineWidth(ctx,2.0);
    //set the line colour
    CGContextSetRGBStrokeColor(ctx, 1.0, 0.0, 0.0, 1.0);
    //creates a new empty path in a graphics context
    CGContextBeginPath(ctx);
    //begin a new path at the point you specify
    CGContextMoveToPoint(ctx, currentPoint.x, currentPoint.y);
    //Appends a straight line segment from the current point to the provided point 
    CGContextAddLineToPoint(ctx, currentPoint.x,lastPoint.y);
    //paints a line along the current path
    CGContextStrokePath(ctx);
    drawImage.image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    currentPoint = lastPoint;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-02T00:23:23.487

我相信你已经完成了这个，但你有一个错字。

```
CGContextAddLineToPoint(ctx, currentPoint.x,lastPoint.y); 
```

应该：

```
CGContextAddLineToPoint(ctx, lastPoint.x,lastPoint.y); 
```

# java - 如何在Java的批处理文件中添加外部jar

> ID：680859
> 
> 赞同：1
> 
> 时间：2009-03-25T09:35:43.280
> 
> 标签：java, batch-file, jar

我有一个 java 批处理文件，其中包含 4 个执行步骤，用于分析任何 Java 应用程序。在其中一个步骤中，我在类路径中添加了一些运行我的核心应用程序所需的库。如果我正在分析的任何 Java 应用程序需要特定的 jar，那么如何将它们添加到批处理文件中提到的类路径中。这可以使用 JavaScript 来完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T09:46:37.967

只需将它们添加到前面。JVM 无论如何都会懒惰地加载它们。还可以在[这里](http://vafer.org/blog/20081203024812)查看选项如何。（还有评论）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T09:40:19.697

我会说您应该在启动时在脚本的 CLASSPATH 中提供这些核心 JAR。我不明白您为什么要反复获取这些 JAR 并一次又一次地将它们放在某个地方。

将这些 JAR 作为核心应用程序的一部分放在 /lib 目录中，将它们添加到脚本中的 CLASSPATH 中，然后完成它是我的建议。

# c# - 从FullyName 字符串到Type 对象

> ID：680861
> 
> 赞同：1
> 
> 时间：2009-03-25T09:35:52.250
> 
> 标签：c#, .net, reflection

有人知道如何从 FullName 中获取 Type 对象吗？

例如。

```
string fullName = typeof(string).FullName; 
Type stringType = <INSERT CODE HERE> 
Assert.AreEqual(stringType, typeof(string) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T09:38:46.270

```
string fullName = typeof(string).FullName; 
Type stringType = Type.GetType(fullName); 
```

但是，请注意，这只搜索调用程序集和核心 MS 程序集。最好使用`AssemblyQualifiedName`, 或找到第`Assembly`一个，然后使用`Assembly.GetType(fullName)`.

任何一个：

```
string qualifiedName = typeof(string).AssemblyQualifiedName;
Type stringType = Type.GetType(qualifiedName); 
```

或者

```
Assembly a = typeof(SomeOtherTypeInTheSameAssembly).Assembly;
Type type = a.GetType(fullName); 
```

* * *

更新评论；`AssemblyQualifiedName`包含版本信息的注释；这适用于配置文件之类的东西，但是如果（就像这里的情况一样）您将其用于持久性，通常最好使用独立于实现的合同。比如xml（通过`XmlSerializer`或`DataContractSerializer`）不关心具体的类型，只要布局正确即可。

如果空间是一个问题，二进制格式通常更短 - 但`BinaryFormatter`包含类型元数据，并且不是平台独立的（例如，尝试从 java 中使用它）。在这种情况下，您可能需要查看自定义序列化程序，例如[protobuf-net](http://code.google.com/p/protobuf-net/)，它是基于合同的，但使用 Google 的“协议缓冲区”跨平台有线格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T09:39:15.643

```
string fullName = typeof(string).FullName; 
Type stringType = Type.GetType(fullName);
Assert.AreEqual(stringType, typeof(string) 
```

# c# - 在代码中获取 DynamicResource

> ID：680862
> 
> 赞同：2
> 
> 时间：2009-03-25T09:36:47.647
> 
> 标签：c#, wpf, datatemplate

FrameworkElement 的 FindResource 方法允许获取在此 frameworkElement 中定义的资源。但是，我有一些动态资源位于运行时加载的另一个程序集中。从 XAML 中使用 DynamicResource 访问它没有问题，但我想知道如何从代码（例如 datatemplateselectors）中访问 Dynamicresources。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-25T09:43:54.510

`DynamicResource`本质上将资源的解析推迟到运行时，并在消费者和资源之间创建链接，以便对资源的更改仍然传播给消费者。它仍然使用`FindResource`.

如果您的外部资源被合并到您的可视化树中，您应该仍然可以使用`FindResource`. 如果没有，您可以使用[包 URI](http://msdn.microsoft.com/en-us/library/aa970069.aspx)手动加载它们。

# iphone - 我应该使用哪种委托方法来响应对文本字段的点击？

> ID：680863
> 
> 赞同：1
> 
> 时间：2009-03-25T09:37:06.647
> 
> 标签：iphone, cocoa-touch, uitextfield

我想在用户单击文本字段时打开一个面板。我想我应该使用一个响应点击事件的委托方法。我发现

```
- (void)textDidBeginEditing:(NSNotification *)aNotification 
```

方法不起作用，并且

```
- (void)controlTextDidBeginEditing:(NSNotification *)aNotification 
```

方法有效，但仅当我在文本字段中编辑文本时，才单击它。如果我再次编辑文本，此方法不起作用。为什么？

* * *

抱歉，我想我想在 mac 上使用这个，而不是在 iphone 上，如何用 cocoa 处理它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T10:20:21.443

The `textFieldDidBeginEditing:` delegate method only gets triggered when the user starts editing the text inside the `UITextField`, as the method name implies.

If you want to trigger a method when the `UITextField` is touched, you should try this:

```
[textField addTarget:self 
              action:@selector(textFieldTouched:)
    forControlEvents:UIControlEventTouchDown];

- (void) textFieldTouched:(id)sender {
    // Display the panel
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-25T14:03:35.040

正确的委托方法名称是

```
- (void)textFieldDidBeginEditing:(UITextField *)textField 
```

从文档中：

> 此方法通知委托指定的文本字段刚刚成为第一响应者。

# msbuild - MSBuild：ReadLinesFromFile 查询

> ID：680864
> 
> 赞同：0
> 
> 时间：2009-03-25T09:37:56.427
> 
> 标签：msbuild

我正在使用 ReadLinesFromFile 从 txt 文件中读取多行并将其附加到 sql.execute 中的路径。问题是它读取所有行并立即附加它们：

文本文件内容：

a.sql
b.sql

Sql.Execute ServerName="$(ServerName)" DatabaseName="CDRCntroller" path="..\DB\CDRController\BROKER\@(Prop1)。

MSBuild 的路径为：.....\BROKER\a.sql;b.sql

有什么办法可以将 Prop1 用作数组并一一引用文件中的内容？

我也尝试使用 StringToItemList 但没有运气:(

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T09:59:23.380

你应该试试这个

Sql.Execute ServerName="$(ServerName)" DatabaseName="CDRCntroller" path="..\DB\CDRController\BROKER\%(Prop1.Identity)

% 告诉 Msbuild 为每个项目重复该任务。身份是包含项目本身的元数据。

希望能帮助到你 ！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T09:46:17.920

请改用元数据表示法。像这样 ：

```
Sql.Execute ServerName="$(ServerName)" DatabaseName="CDRCntroller" path="..\DB\CDRController\BROKER\%(Prop1.Identity) 
```

# apache-flex - 如何在 flex 应用程序中重定向网页？

> ID：680867
> 
> 赞同：3
> 
> 时间：2009-03-25T09:38:33.977
> 
> 标签：apache-flex, flex3, flexbuilder

我有一个按钮控件....我需要在单击该按钮时重定向另一个网页....怎么做？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T09:45:27.313

您正在寻找该[`navigateToURL()`](http://livedocs.adobe.com/flex/3/langref/flash/net/package.html#navigateToURL())功能。

# c# - 如何在 C# 中使用 XML 和 XML 模式

> ID：680872
> 
> 赞同：0
> 
> 时间：2009-03-25T09:40:15.453
> 
> 标签：c#, xml

你好，

我想将 Outlook 联系人保存在 XML 文件中。我想比较、合并和解决这个 XML 文件与另一个可能具有相同属性的 XML 文件的冲突？另外我想知道何时编辑/新添加特定节点？我们如何使用 C# 3.5 在 XML 中实现这一点？我应该使用任何 XML 模式吗？这怎么可能？

另外请让我知道使用哪个更快 - XML 文件还是 SQLite？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T09:53:12.647

您可以使用 LINQ to XML，关于 LINQ to XML 的书籍有很多，请参考。

对于小数据，XML 应该是一种快速有效的方式，就像配置数据等。对于大数据，SQLite 是一种方式。

# yui - YUI TabView.get("tabs") => null: 竞争条件？

> ID：680874
> 
> 赞同：0
> 
> 时间：2009-03-25T09:40:41.163
> 
> 标签：yui, tabs

在我的“dom ready”函数中，我在 HTML 元素上创建了一个 TabView 并调用 tabview.getTab(0).blah()。不幸的是，我时不时地收到一个错误，即 tabView.get("tabs") 在我的 javascript 控制台（firefox）中返回 null。

```
 YAHOO.util.Event.onDOMReady(function() {
      tabview = new YAHOO.widget.TabView("content");
      var tab0 = tabview.getTab(0);
          ... 
```

tabview.getTab(0) 被实现为 tabs.get("tabs")[0]。

这种情况有时会发生，但不是每次都发生。有人解释为什么有时会发生这种情况吗？DOMReady 事件发生在整个 DOM 就位之后但在显示任何内容之前，对吗？

说到这一点，有时我会在其他一些选项卡中看到数据闪烁。对于我所希望的美好、干净的体验，这并不是一个好兆头。

这是 YUI 2.7.0/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-26T16:00:59.683

好的 - 我相信答案是，我试图同时使用原型和 YUI。从理论上讲，我认为这是可能的，但是如果您知道我的意思，那么在“dom:loaded”/onDOMReady 事件上执行操作时，您需要选择其中一个。

所以我不知道发生了什么，但这是某种竞赛，一旦我在 dom 准备好时选择了一个单一的机制来做事，一切都运行良好。

# vba - 将活动工作表保存为新工作簿的宏，询问用户位置并从新工作簿中删除宏

> ID：680875
> 
> 赞同：3
> 
> 时间：2009-03-25T09:40:50.103
> 
> 标签：vba, excel

我有一个包含三个工作表的工作簿：产品、客户、日记。我需要的是分配给上述每个表格中的按钮的宏。如果用户单击该按钮，则活动工作表应保存为具有以下命名约定的新工作簿：

`SheetName_ContentofCellB3_DD.MM.YYYY`

在哪里

*   SheetName 应该是当前活动工作表的名称
*   ContentofCellB3 每次活动工作表的单元格B3的内容
*   DD.MM.YYYY 当前日期

我编写的以下宏使上述内容：

```
Sub MyMacro()
Dim WS As Worksheet
Dim MyDay As String
Dim MyMonth As String
Dim MyYear As String
Dim MyPath As String
Dim MyFileName As String
Dim MyCellContent As Range

MyDay = Day(Date)
MyMonth = Month(Date)
MyYear = Year(Date)
MyPath = "C:\MyDatabase"

Set WS = ActiveSheet
Set MyCellContent = WS.Range("B3")

MyFileName = "MyData_" & MyCellContent & "_" & MyDay & "." & MyMonth & "." & MyYear & ".xls"
WS.Copy
Application.WindowState = xlMinimized
ChDir MyPath

If CInt(Application.Version) <= 11 Then
    ActiveWorkbook.SaveAs Filename:= _
    MyFileName, _
    ReadOnlyRecommended:=True, _
    CreateBackup:=False
Else
    ActiveWorkbook.SaveAs Filename:= _
    MyFileName, FileFormat:=xlExcel8, _
    ReadOnlyRecommended:=True, _
    CreateBackup:=False
End If
ActiveWorkbook.Close 
```

结束子

但是有一些问题希望得到您的帮助：

1.  我应该如何更改上述宏，以便用户可以决定保存新工作簿的路径？
2.  我应该如何更改上述宏，以便新工作簿不包含任何作为初始工作簿工作表一部分的宏？
3.  你在我的宏中看到什么可以用另一种更好的方法来做吗？

提前感谢大家的时间。

PS 对于我的使用情况，必须始终具有从 excel 2007 到 excel 2002 的向后兼容性

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T16:35:20.027

第一个很简单。用于`Application.GetSaveAsFilename`允许用户指定路径和文件名。

我之前使用[Chip Pearson](http://www.cpearson.com/excel/vbe.aspx)的以下内容从复制的工作簿中删除了 VBA，它应该做你所追求的：

```
子 DeleteAllVBACode()
        将 VBProj 调暗为 VBIDE.VBProject
        将 VBComp 调暗为 VBIDE.VBComponent
        将 CodeMod 调暗为 VBIDE.CodeModule

        设置 VBProj = myWorkbook.VBProject

        对于 VBProj.VBComponents 中的每个 VBComp
            如果 VBComp.Type = vbext_ct_Document 那么
                设置 CodeMod = VBComp.CodeModule
                使用 CodeMod
                    .DeleteLines 1，.CountOfLines
                结束于
            别的
                VBProj.VBComponents.Remove VBComp
            万一
        下一个 VBComp
    结束子
```

抱歉，没有时间详细查看您的代码（下班！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T20:38:52.237

为了搭载 Lunatik 的建议，您可以添加以下内容：

```
MyPath = Application.GetSaveAsFilename(FILEFILTER:="Excel Files (*.xls), *.xls", Title:="Something really clever about saving")

If MyPath <> False Then
    ActiveWorkbook.SaveAs (MyPath)
End If 
```

`GetSaveAsFilename``FALSE`如果用户点击取消，则返回。您还可以提供默认文件名。

这是一种品味，但`Format(Date, "dd.mm.yyyy")`可以取代你的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-01T04:00:45.440

另一种方法：SHBrowseForFolder

```
Private Const BIF_RETURNONLYFSDIRS = 1
Private Const BIF_DONTGOBELOWDOMAIN = 2
Private Const MAX_PATH = 260

Private Declare Function SHBrowseForFolder Lib _
"shell32" (lpbi As BrowseInfo) As Long

Private Declare Function SHGetPathFromIDList Lib _
"shell32" (ByVal pidList As Long, ByVal lpBuffer _
As String) As Long

Private Type BrowseInfo
   hWndOwner As Long
   pIDLRoot As Long
   pszDisplayName As Long
   lpszTitle As Long
   ulFlags As Long
   lpfnCallback As Long
   lParam As Long
   iImage As Long
End Type

Private Function Show_Save_WorkSheet() As String
Dim lpIDList As Long
Dim sBuffer As String
Dim szTitle As String
Dim tBrowseInfo As BrowseInfo

szTitle = "Please, specify the location where you want the Worksheet to be stored"

With tBrowseInfo
   .hWndOwner = Me.hWnd
   .lpszTitle = lstrcat(szTitle, "")
   .ulFlags = BIF_RETURNONLYFSDIRS + BIF_DONTGOBELOWDOMAIN
End With

lpIDList = SHBrowseForFolder(tBrowseInfo)

If (lpIDList) Then
   sBuffer = Space(MAX_PATH)
   SHGetPathFromIDList lpIDList, sBuffer
   sBuffer = Left(sBuffer, InStr(sBuffer, vbNullChar) - 1)       
   Show_Save_WorkSheet = sBuffer
End If
End Function 
```

# asp.net - AutoEventWireUp 页面属性是什么意思？

> ID：680878
> 
> 赞同：56
> 
> 时间：2009-03-25T09:42:13.110
> 
> 标签：asp.net, autoeventwireup

我不明白`AutoEventWireUp`页面属性负责什么。

我已经阅读了[这篇文章](http://support.microsoft.com/kb/324151)，但即使是我也不明白。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-03-25T09:54:18.087

当请求页面时，它会引发各种事件，这些事件被认为是其[生命周期](http://msdn.microsoft.com/en-us/library/ms178472.aspx)的一部分。我将Peter Bromberg 创建的[视觉表示随身携带。](http://www.eggheadcafe.com/articles/20051227.asp)

该`AutoEventWireUp`属性为 True 时，会自动将 Page 生命周期中的一些内置事件连接到它们的处理程序。这意味着您不需要显式附加这些事件（例如，在 VB 中使用 Handles 关键字）。

这些内置事件的示例是`Page_Init`和`Page_Load`。

如果您设置`AutoEventWireUp`为 True**并**提供 EventHandlers 的显式连接，您会发现它们被执行了两次！`false`这是 Visual Studio默认将此属性设置为的原因之一。

**编辑：（**在 Chester89 的评论之后）

* * *

需要注意的是， `AutoEventWireUp`Page 的属性的默认值为 ，而Page 类`true`的属性的默认值为`AutoEventWireUp``false`

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-25T10:16:23.603

添加到以前的答案；自动挂钩从 应用`TemplateControl.HookUpAutomaticHandlers`。此方法调用`TemplateControl.GetDelegateInformationWithNoAssert`其中包含哪些方法被视为事件处理程序。

在 System.Web 2.0 版中，这些是：

*   在从 Page 派生的所有类上：`Page_PreInit`, `Page_PreLoad`, `Page_LoadComplete`, `Page_PreRenderComplete`, `Page_InitComplete`, `Page_SaveStateComplete`.

*   在从 TemplateControl 派生的所有类上：`Page_Init`, `Page_Load`, `Page_DataBind`, `Page_PreRender`, `Page_UnLoad`, `Page_Error`.`

*   对从 TemplateControl 派生的所有类的事务支持：

    *   `Page_AbortTransaction`，或者如果它不存在，`OnTransactionAbort`
    *   `Page_CommitTransaction`，或者如果它不存在，`OnTransactionCommit`

System.Web 4.0 版`Page_PreRenderCompleteAsync`为从 Page 派生的所有类引入了一个。该方法（如果存在）将使用[Page.RegisterAsyncTask](http://msdn.microsoft.com/en-us/library/system.web.ui.page.registerasynctask%28v=vs.100%29.aspx)注册并在“PreRenderComplete 事件之前”自动执行（来源：[Page.ExecuteRegisteredAsyncTasks](http://msdn.microsoft.com/en-us/library/system.web.ui.page.executeregisteredasynctasks%28v=vs.100%29.aspx)）。此方法似乎非常无证，这表明最好只使用您自己的方法调用[Page.RegisterAsyncTask 。](http://msdn.microsoft.com/en-us/library/system.web.ui.page.registerasynctask%28v=vs.100%29.aspx)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-25T09:51:15.863

正如文章中提到的，如果你打开了 AutoEventWireUp，asp.net 会自动识别你有一个带有 page_load 语法的方法并自动调用它：

```
private void Page_Load(object sender, System.EventArgs e)
{
} 
```

这会以一些（非常）小的开销为代价，为您提供更简洁的代码。请注意，如果您不指定它，则必须明确告诉 asp.net 您要处理页面加载事件：

```
this.Load += new System.EventHandler(this.Page_Load); 
```

请注意，这适用于页面中的其他事件，因为它使用命名约定为*Page_Event*。

# msbuild - MSBuild、属性和导入的文件

> ID：680880
> 
> 赞同：1
> 
> 时间：2009-03-25T09:43:10.407
> 
> 标签：msbuild

是否可以运行从导入的文件“A”填充属性或项的 msbuild 任务，然后在导入文件“A”的另一个文件中使用这些值？

编辑：FileX 导入 FileA，FileY 导入 FileA。FileA 的属性之一在 FileX 中发生了更改。可以在 FileY 中访问此更改的值吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T11:17:39.993

抱歉有点混乱：

你是说 FileX 导入 FileA 和 FileY 导入 FileA。FileX 在 FileX 中设置属性 P 但 FileY 读取它？如果 X 和 Y 之间没有关系，那么唯一的方法是使用 MSBUILD 中的属性与环境变量重叠的事实。所以可能打电话

```
<exec ... setx.exe Propertyname SomeValue.... /> in fileA and the $(Propertyname) in FileB 
```

# visual-studio - 从数据库中检索 BLOB 字段时出错？

> ID：680884
> 
> 赞同：0
> 
> 时间：2009-03-25T09:44:11.233
> 
> 标签：visual-studio, visual-studio-2005, crystal-reports, blob

我正在尝试从 Oracle 检索 BLOB 字段并将其显示在水晶报表中。在查看报告时，我遇到了这个错误：

```
Failed to open a rowset.
Details: ADO Error Code: 0x
Source: Microsoft OLE DB Provider for oracle
Description: Unspecified error 
```

我使用 View 作为报告数据源，它的脚本

```
SELECT COMPANY_ID, COMPANY_LOGO FROM ID_COMPANY_SETUP; 
```

我正在使用嵌入 VS.NET 2005 的 CrystalReport。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-07T15:05:50.147

我知道问题出在哪里。它是“连接类型”。

我使用 OLE DB(ADO) 连接到数据库，而我将其更改为 Oracle Server 连接，正确检索了 blob 字段。

# c++ - functors_sort:向量

> ID：680885
> 
> 赞同：1
> 
> 时间：2009-03-25T09:44:24.603
> 
> 标签：c++

我有这堂课：

```
class QSweep{

public:
QSweep(const vector< vector<double> >& myPoints, const vector< vector<int> >&myEdges);

void intersection(vector< vector<double> >& myPoints, vector< vector<int> >& myEdges);
vector< vector<int> >* sortEdges(vector< vector<double> >& myPoints,
vector<vector<int>>& myEdges);

bool sortx(const vector< vector<int> >& edge1, const vector< vector <int> >& edge2) {
return edge1[0][0]< edge2[0][0];
};
private:
vector< vector<double> > myPoints_;
vector< vector<int> > myEdges_;
}; 
```

构造函数以这种方式创建所需的数据结构：

```
QSweep::QSweep(const vector< vector<double> >& myPoints, const vector< vector<int>>&  
myEdges){
myPoints_=vector< vector<double> > (myPoints.size(), vector< double >(3,0));
for (unsigned int i=0;i<myPoints.size();i++){
myPoints_[i][0]=myPoints[i][0];
myPoints_[i][1]=myPoints[i][1];
myPoints_[i][2]=myPoints[i][2];
}

myEdges_=vector< vector<int> > (myEdges.size(), vector< int >(2,0));
for (unsigned int i=0;i<myEdges.size();i++){
myEdges_[i][0]=myEdges[i][0];
myEdges_[i][1]=myEdges[i][1];
}
} 
```

例如：myPoints={{1.0,1.0,2.0},{18.0,4.0,2.0},{5.0,1.0,2.0}}; myEdges={{0,1},{1,2},{0,2}};

我想根据 myEdges[i][0] 给出的 myPoints 的第一个坐标对 myEdges 二维向量进行排序函数。例如，排序后 myEdges 将变为 myEdges={{0,1},{0,2} ,{1,2}} 因为 myPoints[myEdges[1][0]][0]

我试过了：

```
 bool sortx(const vector<int> & edge1,const vector<int> & edge2) {
 return myPoints_[edge1[0][0]< myPoints_[edge2[0][0];
 }; 
```

在 QSweep 的公共成员中调用：

```
int main(){
...
sort(myVector1.begin(),myVector1.end(),sortx);
} 
```

但我一直有同样的错误（即使我修改了一些东西）： sort.cpp: In static member function 'static bool QSweep::sortx(const std::vector >&, const std::vector >&)': sort .cpp:47: 错误: 静态成员函数 sort.cpp:25: 错误: 从这个位置 sort.cpp:47: 错误: 无效使用成员 'QSweep::myPoints_'在静态成员函数 sort.cpp:25 中：错误：从此位置 sort.cpp：在函数“int main()”中：sort.cpp:106：错误：“sortx”未在此范围内声明

然后我尝试为我的班级（我以前从未使用过）编写一个函子：函子是：

```
class order{
public:
QSweep* o;
//vector< vector<double> > myPoints_;
bool operator() (const vector<int>& edge1, const vector<int>& edge2){
return o->myPoints_[edge1[0]][0]<o->myPoints_[edge2[0]][0];
}
}; 
```

我在 QSweep 类之外定义了它。我将主程序中的函子称为：

```
sort(myVector1.begin(),myVector1.end(),order()); 
```

程序编译但我收到一条总线错误消息：./sort 1 2 2 3 1 3 Bus error

oii 所以我的仿函数肯定不好.. 我应该以某种方式初始化 QSweep 类的对象吗？我不明白这个函子如何知道使用 QSweep 类中的 myPoints_ 元素。

提前谢谢你，马达琳娜

* * *

qsweep 是 QSweep 类的对象，在程序编号中初始化。我在我的主程序中使用：

```
....
QSweep* s= new QSweep(myVector, myVector1);
.... 
```

在类顺序中对 o 使用这个初始化，程序编译并运行调用：

```
sort(myVector1.begin(),myVector1.end(),order(s)); 
```

对于这个扫描算法，排序只针对 myPoints_ 的第一个组件（正如我真正需要做的那样）执行。

非常感谢您的帮助！（我开始很困惑），madalina

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T10:32:20.587

Your `order` functor is the right way do go; it just seems you have omitted to initialize its `o` member.

Have you tried:

```
class order{
public:
  QSweep* o;
  order(QSweep* o_) : o(o_) {}
  bool operator() (const vector<int>& edge1, const vector<int>& edge2){
    return o->myPoints_[edge1[0]][0]<o->myPoints_[edge2[0]][0];
  }
};

sort(myVector1.begin(),myVector1.end(),order(qsweep)); 
```

The comparison function is OK, `sort` doesn't require all elements to compare greater or less than others.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T09:55:56.087

> 排序（myVector1.begin（），myVector1.end（），sortx）；

你需要告诉`std::sort`你在里面使用的是哪个`main`，如果你要使用这个表单，你想使用成员函数`sortx`。尝试：

```
sort(myVector1.begin(),myVector1.end(), std::mem_fun_ref(&QSweep::sortx)); 
```

此外，您的排序函数采用不正确的参数：

> bool sortx(常量向量<向量>&边1，常量向量<向量>&边2)

`vector`要对你的s进行排序`vector`，你应该采取：`int``sortx`

```
bool sortx(const vector<int>& edge1, const vector<int>& edge2) 
```

另外，请注意，您不能像使用多维数组那样对向量向量使用多个索引。我认为你的问题过于复杂了:)

这是对元组点类型进行排序的简化解决方案：

```
#include <iostream>

#include <iterator>
#include <algorithm>
#include <vector>

using namespace std;

template <class _MyType>
struct Point  {
    Point() {}

    void insert(_MyType const& p) { 
        _pts.push_back(p); 
    }

    bool operator<(Point<_MyType> const& o) {
        return _pts[ 0 ] < o._pts[ 0 ];
    }

private:
    typename vector<_MyType> _pts;
};

int main()
{
    Point<int> p;
    p.insert(1); p.insert(0); p.insert(2); // {1, 0, 2}
    Point<int> q;
    q.insert(-1); q.insert(10); q.insert(2); // {-1, 10, 2}
    vector<Point<int> > sweep;
    sweep.push_back(p);
    sweep.push_back(q);
    sort(sweep.begin(), sweep.end());    

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T09:58:13.367

乍一看，从您的文字来看，似乎对数据成员`static bool QSweep::sortx(...)`的使用无效。`this`这解释了编译器错误。请注意，在您提供的源代码中，该函数不是静态的。

乍一看，您不能将不完整的排序定义为`std::sort`：如果您说“我不在乎我的第二个成员更大或更小，如果第一个更大，则整个对象更大”，您将`sort`算法留在对于具有*相等*第一个成员的值，无效。

这就是为什么`sort`需要*严格的弱排序*。您还必须定义具有相同第一个成员的值的顺序。

# svn - 从 SVN 预提交挂钩运行 NArrange

> ID：680886
> 
> 赞同：0
> 
> 时间：2009-03-25T09:44:35.070
> 
> 标签：svn, hook, pre-commit

我正在尝试使用以下命令从 SVN 预提交挂钩执行[NArrange ：](http://sourceforge.net/projects/narrange/)

```
"C:\Fullpath\narrange-console.exe" "C:\SolutionDir\SolutionFile.sln" /b /t 
```

它返回错误：“挂钩脚本返回错误：”

有没有人在抢救？

**编辑：**这个钩子是 tortoisesvn 客户端钩子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T10:46:14.843

The pre-commit hook is evaluated on the repository server; not on the client. And pre-commit hooks can't change what is to be committed. (They can only deny a commit if it is not valid for some rules).

You could look at tortoisesvn client hooks, or at a post commit that does a cleanup commit when a file changes. (But make sure you don't get in an endless loop :))

# c# - Internet Explorer 问题 - 运行时错误

> ID：680893
> 
> 赞同：0
> 
> 时间：2009-03-25T09:46:44.003
> 
> 标签：c#, asp.net, internet-explorer, scripting

当我在 IE 中浏览我的项目时，它只显示错误

发生运行时错误 您要调试吗？

第 768 行错误：预期')'

这是关于任何脚本错误吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T09:49:03.827

是的，您似乎遇到了 javascript 语法错误。检查客户端脚本块中未闭合的括号和未闭合的字符串文字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T09:56:03.670

[这](http://www.jonathanboutelle.com/mt/archives/2006/01/howto_debug_jav.html)可能有助于 Internet Explorer 中的 javascript 调试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T10:05:32.460

使用 firefox + firebug ，您的 JS 错误将成为过去 ;)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-16T15:44:33.233

造成这种情况的常见原因之一可能是 javascript 处理程序的字符串参数中的非转义引号，例如：

onmouseover='myJavascriptFun("我所谓的"参数"")'

由于某种原因 IE 不像例如 FF 在解析 javascript 之前不转义引号，所以上面的代码变成了

onmouseover='myJavascriptFun("我所谓的"参数"")'

所以'）'应该在第二个“之后。

当然，该参数来自数据源，因此应该使用 htmlentities 或此类方法对其进行转义。

# c# - 在标签内保留“空白”

> ID：680896
> 
> 赞同：0
> 
> 时间：2009-03-25T09:48:12.080
> 
> 标签：c#, xml, vb.net, whitespace

是否可以在标签内保留空格？

我正在使用 XPathNodeIterator 访问 XPathDocument 中的 XML 节点（包含 XHTML 内容）。

节点中的一些标签不是“严格”的 XHTML（这在工具的最终输出中是允许的）。一些节点包含没有尾随空格的图像标签。

```
<img src="filename.png" alt="description"/> 
```

当我存储生成的节点时，它们会用尾随空格很好地格式化。

```
<img src="filename.png" alt="description" /> 
```

是否可以获取节点内容，保留标签内间距（在这种情况下没有空间）？我正在考虑类似于 PreserveWhitespace 的东西。

使用的代码的简化示例

```
xmlDoc = New XPathDocument(fileIn, xmlSpace.Preserve)
xmlNav = xmlDoc.CreateNavigator()
Dim xmlNode As XPathNodeIterator
Dim ns As XmlNamespaceManager = new XmlNamespaceManager(xmlNav.NameTable)

xmlNode = xmlNav.Select("/export/contents[target[@translate='True']]")
While xmlNode.MoveNext()
  target = xmlNode.Current.selectSingleNode("target").InnerXML
  ' ... '
End While 
```

* * *

一些背景知识：正如 Marc 指出的那样，对于标签内的非重要空白（或相关的标签顺序），生成的 XML 的含义没有区别。

我遇到的主要问题是数据来自处理新内容和旧内容的 CMS 系统。内容创建过程最近才转移到 XML/XHTML，因此系统中仍然存在较旧的非严格 XHTML 内容。

使用的 QA 工具仍然主要基于文本并为 HTML 构建，并由另一个部门运行（QA 流程将需要调整/更新）。这就是为什么我现在希望标签尽可能接近原始格式。

* * *

作为临时解决方法，我添加了一些正则表达式（比较新版本和以前版本的节点）来搜索和修复通过使用 .NET 解析 XML 引入的“差异”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T09:52:43.037

我不知道有任何解析器/xml工具/等（至少在.NET中）可以区分这两者（微不足道的空白）。就含义而言，它们是相同的 - 与它们相同的是：

```
<img alt="description" src="filename.png" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T16:35:20.647

使用正则表达式 s/[ ][/][>]/[/][>]/g 对文件进行后处理。

请注意，如果您正在生成 XHTML，将 <br /> 替换为 <br/> 可能会破坏一些低级浏览器。<br /> 被视为具有未知属性“/”的 HTML 标记，然后将其忽略。<br/> 被视为未知的 HTML 标记“br/”。

# asp.net - 为 web 服务启用 asp.net HTTP Post？

> ID：680905
> 
> 赞同：0
> 
> 时间：2009-03-25T09:50:30.593
> 
> 标签：asp.net, web-services

在我们的本地开发服务器上，我们创建的 Web 服务同时列出了 SOAP 和 HTTP Post 选项。但是在生产服务器上只列出了 SOAP。

是否需要为远程服务器进行一些明确的设置才能启用 HTTP Post？我原以为它是默认开启的，除非你明确关闭它。

这是 ASP.NET 2.0 框架。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T10:01:00.723

检查这个：http: [//msdn.microsoft.com/en-us/library/aa302435.aspx](http://msdn.microsoft.com/en-us/library/aa302435.aspx)

```
> The <protocols> element defines the
> protocols that Web services support.
> By default, HttpPost and HttpGet are
> disabled on .NET Framework versions
> 1.1 and 2.0 as follows:
>     <webServices>
>       <protocols>
>         <add name="HttpSoap1.2"/>
>         <add name="HttpSoap"/>
>         <!-- <add name="HttpPost"/> -->
>         <!-- <add name="HttpGet"/> -->
>         <add name="HttpPostLocalhost"/>
>         <add name="Documentation"/>
>       </protocols>
>     </webServices> 
```

# morphological-analysis - 有免费的德语形态分析库吗？

> ID：680907
> 
> 赞同：8
> 
> 时间：2009-03-25T09:51:57.440
> 
> 标签：morphological-analysis, languagetool

我正在寻找一个可以对德语单词进行形态分析的库，即将任何单词转换为其根形式并提供有关分析单词的元信息。

例如：

```
gegessen -> essen
wurde [...] gefasst -> fassen
Häuser -> Haus
Hunde -> Hund 
```

我的收藏：

*   它必须与名词和动词一起使用。
*   我知道鉴于德语的复杂性，这是一项非常艰巨的任务，因此我也在寻找仅提供近似值或可能仅 80% 准确的库。
*   我更喜欢不使用字典的库，但考虑到情况，我也愿意妥协。
*   我也更喜欢 C/C++/Delphi Windows 库，因为这会使它们更容易集成，但 .NET、Java 等也可以。
*   它必须是一个免费的图书馆。(L)GPL、MPL、...

**编辑：**我知道，由于单词不规则，根本无法在没有任何字典的情况下进行形态分析。当我说，我更喜欢没有字典的库时，我的意思是那些映射每个单词的完整字典：

```
arbeite -> arbeiten
arbeitest -> arbeiten
arbeitet -> arbeiten
arbeitete -> arbeiten
arbeitetest -> arbeiten
arbeiteten -> arbeiten
arbeitetet -> arbeiten
gearbeitet -> arbeiten
arbeite -> arbeiten
... 
```

这些字典有几个缺点，包括体积庞大和无法处理未知单词。

当然所有的异常只能用字典来处理：

```
esse -> essen
isst -> essen
eßt -> essen
aß -> essen
aßt -> essen
aßen -> essen
... 
```

（我的脑子现在在旋转:)）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-25T11:11:19.183

我认为您正在寻找“词干算法”。

Martin Porter 的方法在语言学家中广为人知。Porter 词干分析器基本上是一种词缀剥离算法，结合了一些针对那些特殊情况的替换规则。

大多数词干分析器提供的词干在语言上是“不正确的”。例如：“beautiful”和“beauty”都可以产生词干“beauti”，当然，这不是一个真实的词。不过，如果您使用这些词干来改进信息检索系统中的搜索结果，这并不重要。[例如， Lucene](http://lucene.apache.org/)支持 Porter 词干分析器。

Porter 还设计了一种用于开发词干分析器的简单编程语言，称为 Snowball。

Snowball 中还提供德语词干分析器。从 Snowball 源生成的 AC 版本也可在网站上找到，并附有算法的纯文本说明。

这是 Snowball 中的德语词干分析器：http: [//snowball.tartarus.org/algorithms/german/stemmer.html](http://snowball.tartarus.org/algorithms/german/stemmer.html)

如果您正在查找一个单词的相应词干，就像您在字典中找到的那样，以及有关词性的信息，您应该在 Google 上搜索“词形还原”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-28T22:57:04.953

（免责声明：我在这里链接我自己的开源项目）

可在[http://www.danielnaber.de/morphologie/](http://www.danielnaber.de/morphologie/)上以单词列表的形式获得此数据。它可以与分词器库（如 jwordsplitter）结合使用，以覆盖不在列表中的复合名词。

或者只使用[Java 中的 LanguageTool](http://www.languagetool.org/java-api/)，它以紧凑的有限状态机的形式嵌入了单词列表（另外它还包括复合拆分）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-06-25T23:26:58.877

您前段时间问过这个问题，但您仍然可以尝试使用[morphisto](http://code.google.com/p/morphisto/)。

这是一个关于如何在 Ubuntu 中执行此操作的示例：

1.  安装 Stuttgart 有限状态传感器工具

    $ sudo apt-get install sfst

2.  下载morphisto形态，例如morphisto-02022011.a

3.  压缩它，例如

    $ fst-compact morphisto-02022011.a morphisto-02022011.ac

4.  用它！这里有些例子：

    $ 回声 Hochzeit | fst-proc morphisto-02022011.ac ^Hochzeit/hohZeit<+NN>/hohZeit<+NN>/hohZeit<+NN>/hohZeit<+NN>/HochZeit<+NN>/HochZeit<+NN>/HochZeit<+ NN>/HochZeit<+NN>/Hochzeit<+NN>/Hochzeit<+NN>/Hochzeit<+NN>/Hochzeit<+NN>$

    $ 回声齿轮 | fst-proc morphisto-02022011.ac ^gearbeitet/arbeiten<+ADJ>/arbeiten<+ADJ>/arbeiten<+V>$

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-02-21T12:50:51.303

看看 LemmaGen ( [http://lemmatise.ijs.si/](http://lemmatise.ijs.si/) )，这是一个旨在为词形还原提供标准化开源多语言平台的项目。它正在做你想做的事。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-25T10:05:40.870

我认为没有字典就无法做到这一点。

基于规则的方法总是会遇到诸如

> gegessen ->
> 埃森 gegangen -> angen

（注意不会说德语的人：第二种情况下的正确解决方案是“gehen”）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T10:19:57.467

看看[狮子座](http://dict.leo.org/ende?lang=en&lp=ende&search=)。他们提供你所追求的数据，也许它会给你一些想法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-13T14:36:27.180

可以将[morphisto](http://code.google.com/p/morphisto/)与 ParZu ( [https://github.com/rsennrich/parzu](https://github.com/rsennrich/parzu) ) 一起使用。ParZu 是德语的依赖解析器。

这意味着 ParZu 也消除了 morphisto 的输出歧义

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-10-24T20:54:43.347

有一些工具可以像变形一样使用。Matetools、Morphisto 等中的组件。但痛苦是将它们集成到您的工具链中。[DKpro ( https://dkpro.github.io/dkpro-core/](https://dkpro.github.io/dkpro-core/) ) 是一个使用 UIMA 的框架，对很多这些语言工具进行了很好的封装。它允许您使用来自不同资源的不同语言工具编写自己的预处理管道，这些工具都会自动下载到您的计算机上并相互对话。您可以使用 Java 或 Groovy 甚至 Jython 来使用它。DKPro 让您可以轻松访问两个形态分析器，MateMorphTagger 和 SfstAnnotator。

你不想使用像 Porter 这样的词干分析器，它会以一种在语言上没有任何意义并且没有你描述的行为的方式来减少单词形式。如果你只想找到基本形式，动词是不定式，名词是单数主格，那么你应该使用词形还原器。[您可以在此处](http://www.ling.uni-potsdam.de/~kolb/nlp-tools.html)找到德语词形还原器列表。Treetagger被广泛使用。您还可以使用 SMORS 等形态分析仪提供的更复杂的分析。它会给你这样的东西（来自[SMORS](https://code.google.com/p/cistern/wiki/SMOR)网站的例子）：

> 这里是对“unübersetzbarstes”的分析，显示前缀、后缀和>渐变：un<PREF>übersetzen<V>bar<SUFF><+ADJ><Sup><Neut><Nom><Sg><St>

# asp.net-mvc - 如何在 ASP.NET MVC 中将嵌套数组元素属性值绑定到 TextBox

> ID：680908
> 
> 赞同：3
> 
> 时间：2009-03-25T09:52:34.083
> 
> 标签：asp.net-mvc, data-binding, binding

我有模特

```
public class User 
{
    public User()
    {
       Addreses = new List<Address>();
    }
    public String Name { get; set; }
    public String LastName { get; set; }
    public List<Address> Addresses { get; private set; }
}

public class Address
{
    public String Street { get; set; }
    public String City { get; set; }
} 
```

我想将用户地址显示为 ul 列表。我在视图页面中执行此操作

```
 using (Html.BeginForm("UpdateUser", "Home", FormMethod.Post))
    {
%>
<% =Html.TextBox("user.Name")%><br />
<% =Html.TextBox("user.LastName")%><br />
<ul>
    <% 
       for (Int32 index = 0; index < ((User)ViewData["user"]).Addresses.Count; index++)
       {%>
    <li>
        <% =Html.TextBox("user.Addresses[" + index + "].Street")%>,
        <% =Html.TextBox("user.Addresses[" + index + "].PostalCode")%>,
        <% =Html.TextBox("user.Addresses[" + index + "].City")%>
    </li>
    <% 
       }
    %>
</ul>
<input type="submit" value="Submit" />
<% }%> 
```

并且 for 语句中填充的文本框中的数据是空的。当然我可以添加下一个参数 TextBox 方法来分配值，但是上面的两个文本框（例如“user.Name”）正确读取/设置值。

我做错了什么？

PS。我正在使用 MVC RTM 1.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-05T20:58:55.370

Html.TextBox 方法需要控件的名称和控件的值

```
<ul>
    <%foreach (var address in ((User)ViewData["user"]).Addresses){ 
        <li>
            <% =Html.TextBox("Street", address.Street)%>,
            <% =Html.TextBox("PostalCode", address.PostalCode)%>,
            <% =Html.TextBox("City", address.City)%>
        </li>
    <%}%>
</ul> 
```

您也可以尝试在 MVC Futures 项目中使用 Html.TextBoxFor 方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T20:44:54.983

在您的示例中，您仅将 texbox 的“名称”和“id”属性设置为第二个重载，而不是值对象。

尝试这个：

```
<% =Html.TextBox("user.Addresses[" + index + "].Street", user.Addresses[index].Street)%> 
```

# javascript - Javascript - 从画布元素下的图像中获取像素数据？

> ID：680912
> 
> 赞同：3
> 
> 时间：2009-03-25T09:54:04.110
> 
> 标签：javascript, canvas

您可以使用 getImageData() 对画布图像上的像素颜色数据进行采样。如果我在背景图像或 Flash 电影上叠加一个透明的画布元素，我可以通过画布标签从中采样颜色吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T14:21:20.897

菲尔是对的，你不能这样做。根据设计，Canvas 仅返回其自身的固有像素数据，而不是源自其他元素的任何屏幕渲染内容。

> 您可以制作一个覆盖整个页面并捕获渲染屏幕图像的画布元素。

如果可能的话，那将是一个跨站点脚本安全漏洞。您可以 iframe 一个目标站点（利用用户的 cookie/身份验证/内部网来访问它），然后逐个像素地从中提取内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T10:33:41.707

我想不是。那时你会得到画布的颜色。我确实找到了方法`document.defaultview.getComputedStyle(element,pseudoElt)`，但是在没有背景颜色的 1 像素 div 上，它返回了“透明”。

因此，不幸的是，目前这可能是不可能的。你更高层次的目标是什么？我们或许可以想出一条替代路线。

“我之前有一个想法，将图像数据复制到 javascript 对象中。您可以制作一个覆盖整个页面并捕获渲染屏幕的图像的画布元素。一旦有了这些数据，您就可以进行真实世界的跨浏览器测试， 也许。”

如果您不介意它是静态图像，那么有一个很棒的网站可以为您做到这一点：[Browser Shots](http://browsershots.org/)。它会生成在各种不同浏览器中运行的网站的屏幕截图。

# php - php获取变量作为键，没有赋值

> ID：680914
> 
> 赞同：7
> 
> 时间：2009-03-25T09:54:18.633
> 
> 标签：php

如果我在浏览器中输入以下内容：

```
 http://domain.com/script.php?1234 
```

script.php 具有以下脚本：

```
 $key=array_keys($_GET);
   echo $key[0]; 
```

输出将是：

```
 1234 
```

（我正在尝试消除丑陋的 ?r=1234 ，如果这可行，那将是完美的。）

我的问题是，这是官方正确的还是糟糕的编程？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T10:01:32.157

你也可以

```
echo $_SERVER['QUERY_STRING'] 
```

至于创建友好的 URL，有更好的方法来做到这一点。

参见例如：[PHP 的 $_GET 和 URL 重写](https://stackoverflow.com/questions/505338/get-and-url-rewriting-for-php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T09:59:41.710

你不应该使用这种方法。如果您不希望显示您的变量，您可以使用[URL 重写](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html)使 URL 看起来不错。另外，别忘了清理你的 $_GET :)

实际上，在您的示例中，1234 是您通过 GET 发送的变量，没有值，如果您想这样看的话。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T10:00:58.523

这是对的。该变量称为 1234，它没有值。这意味着

```
GET['1234'] == ''; 
```

你也可以写[http://example.com?1234=10](http://example.com?1234=10)那么结果就是

```
GET['1234'] == '10'; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T14:28:55.963

> 我的问题是，这是官方正确的还是糟糕的编程？

Query-parameter-without-value 没有记录到可以工作，尽管它可能会在实践中继续。

如果您只想获取整个查询字符串而不将其解析为参数，那么最好的做法是直接这么说：

```
echo $_SERVER['QUERY_STRING'] 
```

（无论您做什么，都不要直接回显它！通过例如将其转换为整数来清理值，或者，如果您想允许任意字符串，则通过反斜杠转义引号和反斜杠。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-25T09:56:48.970

没有什么是正式正确的，如果它对你有用，那么一定要使用它。顺便说一句，问题在于匹配什么值。

当你有`example.com?1234&4567`Then 你将有两个没有键名的值来告诉你什么是什么。

但是如果你想去掉丑陋的 url，你应该看看 mod_rewrite

[初学者指南](http://www.workingwith.me.uk/articles/scripting/mod_rewrite)

[另一个初学者指南](http://www.sitepoint.com/article/guide-url-rewriting/)

# smlnj - 在 SML/NJ 中循环文本文件的行

> ID：680916
> 
> 赞同：1
> 
> 时间：2009-03-25T09:55:45.790
> 
> 标签：smlnj

我有这个 SML/NJ 代码，它从文本文件中读取一行，然后它会为我返回一个列表，但是我很难让它对每一行都做同样的事情，并在没有更多行时停止。任何人都可以在这里给我一个循环样本来帮助我吗？

```
fun readlist(infile : string) =
let val ins = TextIO.openIn infile

    val list = []
     fun listing() = [TextIO.inputLine ins]::list;

in listing()
end 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-12T22:38:23.330

How about something like this:

```
fun readlist (infile : string) = let
  val ins = TextIO.openIn infile
  fun loop ins =
   case TextIO.inputLine ins of
      SOME line => line :: loop ins
    | NONE      => []
in
  loop ins before TextIO.closeIn ins
end 
```

# language-agnostic - 比无限循环+块更好的游戏循环？

> ID：680921
> 
> 赞同：6
> 
> 时间：2009-03-25T09:57:41.840
> 
> 标签：language-agnostic

每个游戏教程和游戏框架（甚至是相当新的 XNA 框架）都以一个永无止境的循环开始，该循环具有等效的 DoEvents() 以防止操作系统锁定。

从非游戏的角度来看，我觉得这种代码闻起来很时髦。
没有更好的选择吗？

**--EDIT--**
很多答案说每个程序基本上都是一个循环。没错，但我觉得循环应该由您的操作系统执行，而不是由您执行。只有操作系统拥有以最佳方式分配资源所需的所有信息。或者我在这里错过了一个重要的点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T12:23:34.127

每个 Windows 应用程序的核心都有一个如下所示的循环：

```
BOOL bRet;

while( (bRet = GetMessage( &msg, NULL, 0, 0 )) != 0 ) 
{
   if (bRet == -1 )
   {
      // handle the error and possibly exit
   }
   else
   {
      TranslateMessage( &msg );
      DispatchMessage( &msg );
   }
} 
```

确保消息被分派是应用程序的工作——而不是操作系统的工作。

您可能知道，早期的 Windows 游戏使用了另一种方法，它们不会调用阻塞`GetMessage`函数，而是调用`PeekMessage`，然后在没有消息要处理时调用游戏的主处理循环。使用各种形式的延迟来尝试在不占用 100% CPU 的情况下获得足够的帧速率。只是没有足够好的计时器来提供平滑的帧速率。

今天，可能没有必要显式编写一个调用`DoEvents`. 现在*有可能*通过使用内置的计时器池计时器（在 .NET 中由 公开，并由`System.Threading.Timer`包装`System.Timers.Timer`）来获得平滑的帧速率。

我记得，及时获取鼠标和键盘事件也存在问题。我们使用直接的键盘和鼠标访问，而不是依赖于消息循环，因为消息循环通常太慢，有时会导致我们丢失信息。

我已经很多年没有写过游戏了，我也不知道 .NET 作为一个游戏平台是什么样的。输入可能仍然是一个问题——消息队列根本不够快，无法提供游戏开发人员想要的闪电般的快速响应。所以他们绕过消息队列来处理关键任务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T13:10:09.387

游戏（在大多数情况下）是模拟。传统上，这意味着您更新模拟，呈现其当前状态（例如渲染图形），然后重复。对此的自然表示是循环。

另一方面，Win32 消息泵是一个特定于平台的怪癖，面向构成 Windows 上大多数应用程序的事件驱动应用程序。它绝不是所有平台上应用程序的标准，因此并非所有软件都能很好地适应模型也就不足为奇了。因此，要修改一个典型的程序以适应 Win32 模型，您通常会一次性耗尽该队列，每次循环迭代一次，使用 PeekMessage 直到它为空。或者，您将该逻辑放入单独的线程中并酌情使用 GetMessage。

对于大多数注重性能的游戏，没有其他实用的方法可以做到这一点。首先，如果你试图让游戏事件驱动而不是轮询，那么如果你想保持许多游戏所追求的高性能，你需要比 Windows 可靠地提供更高的分辨率时间。其次，Windows 只是为游戏编写的平台之一，而重新设计游戏以很好地适应 Win32 模型对于希望使用规范游戏循环的专用游戏平台来说只会带来不便。

最后，关于“占用 100% CPU”的担忧是错误的。大多数现代游戏被设计为在具有专有硬件访问权限的全屏模式下使用，而不仅仅是共存的其他几个应用程序之一。此类游戏的客户实际上要求游戏充分利用他们的硬件，如果有故意的 Sleep() 调用或更新依赖于每秒 N 次唤醒应用程序的外部计时器，则无法做到这一点。显然，许多游戏都有例外，例如。那些被设计为主要在窗口中运行的，但重要的是要注意区别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-25T10:00:00.603

所有正在运行的程序都是永无止境的循环。尽管在某些情况下您不与循环交互（例如在 Web 编程或其他小程序中）

您的操作系统是一个等待输入命令的循环。一个游戏也一样。Web 服务器是一个等待请求的循环。

一个很好的解释来自用户[slim 对我自己的一个问题。](https://stackoverflow.com/questions/379231/how-is-gui-and-game-program-flow-compared-to-web-programs/379270#379270)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-25T10:27:30.863

更好的循环是一个无限循环，阻塞调用调度事件/消息。如果没有什么可做的，你确实不应该睡觉，而是在等待操作系统时阻塞。但是，如果在您轮询事件时操作系统确实没有阻塞，那么在轮询之间休眠是防止 100% CPU 使用的唯一解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-25T10:53:42.890

我看不出它怎么能有很大的不同？

您的程序执行发生在一个线程（或多个线程，如果你喜欢的话）。拥有一个游戏循环（或一个 win32 GetMessage/DispatchMessage 泵）就是等待事件发生然后处理它们。另一种方法是注册回调，然后调用 HandleAllMyMessages()，这将在内部做几乎相同的事情......而且这不会真的给你买任何东西。

操作系统无法神奇地将您的程序拆分为多个线程，因为它不知道您想在这些线程中做什么。为每条传入消息生成一个新线程将是性能和同步地狱。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-25T12:47:29.263

在 Win32 上，我使用多媒体计时器来调用我的游戏逻辑滴答声......

```
// request 1ms period for timer
g_mmTimer = timeBeginPeriod(1); 
if (g_mmTimer != TIMERR_NOERROR)
    return false;

//start game loop event timer/thread
g_mmTimer = timeSetEvent(10, 10, DoUpdate, 0, TIME_PERIODIC ); 
```

或者，您可以在另一个线程中完成所有绘图，以便游戏逻辑自动独立于帧速率。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-25T10:01:43.000

消息队列也是无限循环，这使得所有程序都是无限循环。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-05T20:47:49.023

`MsgWaitForMultipleEvents`将`GetMessage`/`PeekMessage`功能与超时和等待内核对象的能力相结合，例如`WaitableTimer`.

过去，我习惯于`CreateWaitableTimer`设置我想要的帧速率以及`MsgWaitForMultipleEvents`消息调度，并在过去非常流畅的动画中取得了巨大成功，而无需忙于等待。我希望其他操作系统有这么好的东西。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2009-03-25T10:04:06.257

如果你觉得不舒服，用类和接口打包它，

也就是我们所说的“开闭原则”：打开界面永远不变，关闭脏的部分。

为什么我们使用循环？因为它是我们计算机的基本结构！

# sharepoint-designer - Sharepoint 设计器无法正确显示页面

> ID：680922
> 
> 赞同：-1
> 
> 时间：2009-03-25T09:58:02.480
> 
> 标签：sharepoint-designer

当我在 sharepoint 设计器中打开 mysite 页面时，页面（请参阅[全屏图片）](http://img246.imageshack.us/img246/2805/sharepointdesignerprobl.png)未正确显示。我愿意使用这个 mysite 编辑和创建新主题。但是，当我在设计器中打开 sharepoint 服务器主页（[https://myserver/Pages/Default.aspx](https://myserver/Pages/Default.aspx)）时，一切正常。

谢谢大家的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T10:26:09.527

Sharepoint 设计器在渲染中添加了一些边框、列和其他废话，因此您不应该依赖它。它的页面渲染只能指导你，它不做精确的设计。

# javascript - 如何从Javascript中的文件名字符串中提取扩展名？

> ID：680929
> 
> 赞同：201
> 
> 时间：2009-03-25T10:00:20.960
> 
> 标签：javascript

我如何在变量中获取文件的文件扩展名？就像我有一个**1.txt**文件一样，我需要它的**txt**部分。

* * *

## 回答 #1

> 赞同：403
> 
> 时间：2009-03-25T10:18:21.963

A variant that works with all of the following inputs:

*   `"file.name.with.dots.txt"`
*   `"file.txt"`
*   `"file"`
*   `""`
*   `null`
*   `undefined`

would be:

```
var re = /(?:\.([^.]+))?$/;

var ext = re.exec("file.name.with.dots.txt")[1];   // "txt"
var ext = re.exec("file.txt")[1];                  // "txt"
var ext = re.exec("file")[1];                      // undefined
var ext = re.exec("")[1];                          // undefined
var ext = re.exec(null)[1];                        // undefined
var ext = re.exec(undefined)[1];                   // undefined 
```

Explanation

```
(?:         # begin non-capturing group
  \.        #   a dot
  (         #   begin capturing group (captures the actual extension)
    [^.]+   #     anything except a dot, multiple times
  )         #   end capturing group
)?          # end non-capturing group, make it optional
$           # anchor to the end of the string

```

* * *

## 回答 #2

> 赞同：261
> 
> 时间：2011-01-14T19:37:55.553

我个人更喜欢将字符串拆分`.`并返回最后一个数组元素:)

```
var fileExt = filename.split('.').pop(); 
```

*如果文件名*中没有`.`，则返回整个字符串。

 ***例子：**

```
'some_value'                                   => 'some_value'
'.htaccess'                                    => 'htaccess'
'../images/something.cool.jpg'                 => 'jpg'
'http://www.w3schools.com/jsref/jsref_pop.asp' => 'asp'
'http://stackoverflow.com/questions/680929'    => 'com/questions/680929' 
```

* * *

## 回答 #3

> 赞同：224
> 
> 时间：2009-03-25T10:06:38.277

使用该`lastIndexOf`方法查找字符串中的最后一个句点，并获取该字符串之后的部分：

```
var ext = fileName.substr(fileName.lastIndexOf('.') + 1); 
```

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2009-03-25T10:09:38.770

我建议使用[lastIndexOf()](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/String/lastIndexOf)而不是[indexOf()](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/String/indexOf)

```
var myString = "this.is.my.file.txt"
alert(myString.substring(myString.lastIndexOf(".")+1)) 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2012-07-18T11:22:41.227

最好使用以下内容；始终有效！

```
var ext =  fileName.split('.').pop(); 
```

这将返回不带点前缀的扩展名。你可以加 ”。” + ext 检查您希望支持的扩展！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-25T10:02:15.010

```
var x = "1.txt";
alert (x.substring(x.indexOf(".")+1)); 
```

注 1：如果文件名的格式为**file.example.txt ，这将不起作用注 2：如果文件名的格式为****文件**
，这将失败

 *** * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-11-16T08:53:14.940

尝试这个。可以解决你的问题。

```
var file_name_string = "file.name.string.png"

var file_name_array = file_name_string.split(".");
var file_extension = file_name_array[file_name_array.length - 1]; 
```

问候

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-25T10:06:51.117

如果您的文件有更多 . （点）在名称中。

```
<script type="text/javascript">var x = "file1.asdf.txt";
var y = x.split(".");
alert(y[(y.length)-1]);</script> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-25T10:06:45.827

我使用下面的代码：

```
var fileSplit = filename.split('.');
var fileExt = '';
if (fileSplit.length > 1) {
fileExt = fileSplit[fileSplit.length - 1];
} 
return fileExt; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-09-24T09:05:11.507

获取变量中的值，然后像这样分离它的扩展名。

```
var find_file_ext=document.getElementById('filename').value;
var file_ext=/[^.]+$/.exec(find_file_ext); 
```

这将对您有所帮助。

# c# - 如何为文件解压缩指定不同的解压缩路径？

> ID：680935
> 
> 赞同：0
> 
> 时间：2009-03-25T10:01:40.287
> 
> 标签：c#, .net

我正在尝试将 .zip 文件从源解压缩到目标。

它采用默认来源：

> C:\Program Files\Microsoft Visual Studio 8\Common7\IDE

源代码实际上在我的项目中。

### 代码：

```
FastZip fz = new FastZip();
fz.ExtractZip("Emp2.zip", Server.MapPath("~/Response Attachments/"), ""); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T10:09:46.117

通常，我们使用命令行工具来完成单独的工作，您可以运行脚本：

解压 XXX.zip -d C:\Program Files\Microsoft Visual Studio 8\Common7\IDE

# python - Python 动态函数名

> ID：680941
> 
> 赞同：9
> 
> 时间：2009-03-25T10:04:26.147
> 
> 标签：python, factory

我正在寻找一种更好的方法来调用基于 Python 中的变量的函数，而不是使用下面的 if/else 语句。每个状态码都有对应的功能

```
if status == 'CONNECT':
    return connect(*args, **kwargs)
elif status == 'RAWFEED':
    return rawfeed(*args, **kwargs)
elif status == 'RAWCONFIG':
    return rawconfig(*args, **kwargs)
elif status == 'TESTFEED':
    return testfeed(*args, **kwargs)
... 
```

我认为这将需要某种工厂函数，但不确定语法

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-25T10:08:32.407

你可能会觉得[`getattr`](http://docs.python.org/library/functions.html?highlight=getattr#getattr)有用，我猜

```
import module
getattr(module, status.lower())(*args, **kwargs) 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-25T10:13:15.967

执行此操作的规范方法是使用字典来模拟`switch`或`if/elif`。您会在 SO 上找到几个类似问题的问题。

将您的函数放入字典中，并将您的状态代码作为键：

```
funcs = {
    'CONNECT': connect,
    'RAWFEED': rawfeed,
    'RAWCONFIG' : rawconfig,
    'TESTFEED': testfeed
}
funcs[status](*args, **kwargs) 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-25T10:10:11.560

假设这些函数属于某个模块：

```
import module
return getattr(module, status.lower()).__call__(*args, **kwargs) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-25T10:18:46.360

它接缝你可以以稍微不同的方式使用 getattr （在我看来更优雅的方式）

```
import math
getattr(math, 'sin')(1) 
```

或者如果函数像下面这样导入

```
from math import sin 
```

sin 现在位于名称空间中，因此您可以通过以下方式调用它

```
vars()['sin'](1) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-25T10:33:39.867

对 SilentGhost 的回答进行了一些改进：

```
globals()[status.lower()](*args, **kwargs) 
```

如果要调用当前模块中定义的函数。

虽然看起来很丑。我会使用字典的解决方案。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-25T10:19:41.880

看看这个：[getattra 作为一个函数调度器](http://diveintopython.net/power_of_introspection/getattr.html#d0e9362)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-25T10:27:10.630

我以前遇到过同样的问题。看看这个问题，我认为它是你正在寻找的。

[字典或 If 语句](https://stackoverflow.com/questions/277965/dictionary-or-if-statements-jython)

希望这会有所帮助

伊夫

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-25T10:16:46.567

与上一个相比有一些变化：

```
funcs = {
'CONNECT': connect,
'RAWFEED': rawfeed,
'RAWCONFIG' : rawconfig,
'TESTFEED': testfeed
}

func = funcs.get('status')
if func：
    func(*args, **kwargs) 
```

# pdf - 将多页 PDF 转换为单个图像

> ID：680948
> 
> 赞同：13
> 
> 时间：2009-03-25T10:06:34.330
> 
> 标签：pdf, ghostscript

我正在尝试使用 GhostScript 将 PDF 转换为单个图像。

只有第一页被转换，而我的意图是生成一个非常高的 PNG/JPG 图像，所有页面连接在一起。

这些是我当前传递给 GhostScript DLL 的参数（通过 .NET 应用程序）：

```
pdf2img \
  -dNOPAUSE \
  -dBATCH \
  -dSAFER \
  -sDEVICE=png256 \
  -dGraphicsAlphaBits=4 \
  -dTextAlphaBits=4 \
  -dDOINTERPOLATE \
  -dAlignToPixels=1 \
  -r300x300 \
  -sOutputFile=GLOSS.png \
   GLOSS.pdf 
```

是否可以通过 GhostScript 将所有页面连接在一起？还是我应该求助于外部方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T10:11:47.500

你看过[ImageMagick](http://www.imagemagick.org/)吗？这个免费库可能有一个从 PDF 创建单个图像的选项（它实际上使用 Ghostscript，但添加了许多图形编辑功能，例如合并图像）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-03T15:48:42.563

使用 GS 将多页 PDF 转换为图像（PNG、JPEG、TIFF 等）后，您需要进一步将输出图像合并为多页 TIFF 图像。

[查看VietOCR.NET](http://vietocr.sf.net)的源代码，它具有功能，但分两个单独的步骤完成。您可以修改它以背靠背调用这两个函数。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-25T10:09:58.830

您很可能需要使用 GS 渲染单个页面，然后使用某些脚本语言将它们组合成单个 PNG/JPG。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2010-10-23T10:55:05.933

你可以在 Code Project 上查看这个开源项目

[http://www.codeproject.com/KB/cs/GhostScriptUseWithCSharp.aspx](http://www.codeproject.com/KB/cs/GhostScriptUseWithCSharp.aspx)

这显示了如何调用 Ghostscript 以及如何传递参数

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-25T13:20:58.653

您可以查看[PDF to Image](http://www.pdfsvg.com)

# wpf - 在 WPF 中，如何在使用 PreviewKeyDown 处理按键后取消按键？

> ID：680953
> 
> 赞同：4
> 
> 时间：2009-03-25T10:08:29.257
> 
> 标签：wpf, events, xaml

在我的 WPF 数据网格中，我捕获“删除”键，对其进行处理，然后数据网格本身通过继续处理其自己的删除键处理程序（这是我想要的）从 UI 中删除行。

但是现在我希望**CTRL-S 打开一个搜索栏**，它确实如此，但它也会继续空白用户按下 CTRL-S 时所在的单元格，所以我正在寻找**一种方法来告诉数据网格取消按键**，使其不在 Datagrid 上执行。

我怎样才能取消这样的按键？

**XAML：**

```
<toolkit:DataGrid x:Name="TheDataGrid" DockPanel.Dock="Bottom"
                  CanUserAddRows="False"
                  AlternatingRowBackground="#ddd"
                  CanUserSortColumns="true"
                  PreviewKeyDown="TheDataGrid_PreviewKeyDown"
                  AutoGenerateColumns="False"
                  RowEditEnding="TheDataGrid_RowEditEnding"> 
```

**代码隐藏：**

```
private void TheDataGrid_PreviewKeyDown(object sender, KeyEventArgs e)
{
    if (Keyboard.IsKeyDown(Key.LeftCtrl) && Keyboard.IsKeyDown(Key.S))
    {
        ShowSearchBar();
    }

    switch (e.Key)
    {
        case Key.Delete:
            DeleteCustomer(sender, e);
            break;
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T10:11:14.240

```
e.Handled = true; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-09-06T16:14:35.843

在稍微不同的情况下，我有第二个 type 参数`PreviewKeyDownEventArgs`，在这种情况下，解决方案是：

```
e.IsInputKey = true; 
```

# c# - 整数和小数的不同格式

> ID：680960
> 
> 赞同：2
> 
> 时间：2009-03-25T10:11:11.307
> 
> 标签：c#, string

有没有办法格式化字符串以显示十进制数的整数，如果它遵循 00。

如果数字为 10.00，则示例显示 10。但如果数字是 10.2 则显示 10.2

这是针对 c#, asp.net

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T10:15:08.427

在 .NET 中：

```
if (Math.Floor(d) == d)
    return d.ToString("0");
else
    return d.ToString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T10:25:34.347

当然有：

```
(if (!= 0 (- (string-to-number x) (floor (string-to-number x))))
    (number-to-string (string-to-number x))
    x) 
```

# .net - 基于 SQL Server 的程序集的配置

> ID：680964
> 
> 赞同：0
> 
> 时间：2009-03-25T10:11:55.003
> 
> 标签：.net, sql-server, configuration, clr

我有一个部署到 SQL Server 的程序集，它执行向会计系统 SDK 的导出。将其部署到 SQL Server的**原因****超出了我的控制范围**，并且我**无法修改**目标**数据库**。

在开发过程中，我将几个动态查询从硬编码移到了应用程序外部的文本文件中，以便在部署后可以根据需要调整查询。有没有一种方法可以在不使用数据库字段的情况下“通知”我的程序集这些文本文件在服务器机器上的位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-25T10:57:39.340

似乎将文本文件作为~~嵌入式~~资源添加到项目中是一种更好的方法。这免除了部署者配置程序集或部署文本文件的任何责任。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T11:41:43.447

您必须从一些众所周知的位置读取文本文件的路径，例如：

*   登记处
*   应用本地存储
*   预定义目录

# scala - Scala Map：神秘的语法糖？

> ID：680975
> 
> 赞同：10
> 
> 时间：2009-03-25T10:15:25.027
> 
> 标签：scala, maps, syntactic-sugar, scala-collections

我刚刚发现了 scala 的这种语法`Map`（在此处以*可变*形式使用）

```
val m = scala.collection.mutable.Map[String, Int]()
m("Hello") = 5
println(m) //PRINTS Map(Hello -> 5) 
```

现在我不确定这是否是语言中内置的语法*糖*，或者这里是否发生了更基本的事情，涉及到 map 扩展了`PartialFunction`. 谁能解释一下？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-25T10:32:21.490

如果你的意思是（如果你能更明确一点就好了）

```
m("Hello") = 5 
```

这是预期的语法糖

```
m.update("Hello", 5) 
```

与 m 无关。这类似于

```
m("Hello") 
```

这是语法糖

```
m.apply("Hello") 
```

（我只是在阅读“Scala 编程”。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-25T11:21:40.937

@starblue 是正确的。请注意，您还可以做一些非常有创意的事情，`update`例如返回分配的值以外*的值。*例如：

```
val a = Map(1 -> "one")      // an immutable Map[Int, String]
val b = a(2) = "two"
val c = b(5) = "five"
val d = c(1) = "uno"

d == Map(1 -> "uno", 2 -> "two", 5 -> "five")       // => true 
```

这是有效的，因为`immutable.Map#update`返回 new 的一个实例`Map`。对于受过 C 训练的眼睛来说，这看起来有点奇怪，但你会习惯的。

# c# - 根据与目标字符串的差异对字符串列表进行排序的最佳方法？

> ID：680977
> 
> 赞同：0
> 
> 时间：2009-03-25T10:16:16.693
> 
> 标签：c#, .net, sorting, collections

我需要根据列表中的字符串与目标字符串之间的差异对列表进行排序。

实现这种排序算法的最佳方法是什么？

我不太关心性能，但收藏可能会变得很大（假设有 50 万顶）。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-25T10:19:26.670

我建议计算[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)，然后简单地按整数结果排序。（[魔法密码](http://en.wikibooks.org/wiki/Algorithm_implementation/Strings/Levenshtein_distance#C.23)）

```
public void Example()
{
    string target = "target";

    List<string> myStings = new List<string>();

    myStings.Add("this");
    myStings.Add("that");

    myStrings = myStrings.OrderBy(each => Levenshtein(each, target)).ToList();
}

public int Levenshtein(string stringA, string stringB)
{
    // Magic goes here
    return 0;
} 
```

老 skool 2.0 的家伙没有 OrderBy 吗？

```
List<string> myStrings;
myStrings.Sort(LevenshteinCompare);
...

public class LevenshteinCompare: IComparer<string>
{
    public int Compare(string x, string y)
    {
        // Magic goes here
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T10:40:32.220

> 实现这种排序算法的最佳方法是什么？

开玩笑，我建议使用快速排序的库实现，将到目标字符串的距离作为排序键。

这当然不是一个有用的答案。为什么不？因为您真正想知道的是“什么是字符串的良好差异度量？”

可悲的是，*真正*问题的答案是“视情况而定”；这取决于您关心的距离的哪些属性。

话虽如此，请阅读莱文斯坦距离以及它对琴弦的真实描述。

您可以通过调整动态规划矩阵中不同步骤的权重来修改基本算法，以偏向于长期运行中出现的相同字符。

您还可以使用 Soundex 算法，该算法说明哪些字符串听起来相似（但最适合短字符串；我不知道您使用哪种输入）。

如果字符串长度相等，还可以使用汉明距离（计算字符串不同的索引数）。通过计算（单方面）不存在的索引总是不同的，这可能可以推广到*某些东西*，这给了你一些类似 Levenstein 的东西（可能有点'排序'）。

简短版本：这取决于。我已经给出了一些意见，但如果没有您提供的更多信息，我不能说哪个*对您来说是一个好的决定。*

# database - NHibernate 可以持久保存到平面文件而不是数据库吗？

> ID：680994
> 
> 赞同：8
> 
> 时间：2009-03-25T10:22:07.880
> 
> 标签：database, nhibernate, persistence, flat-file

这是一个好奇的问题。我有一个应用程序必须同时支持平面文件和数据库作为保存数据的地方。我在想也许使用 .csv 或制表符分隔的文件集作为输入......

是否可以使用 NHibernate 编写来完成这两个持久性任务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T16:25:47.007

尝试使用 Jet 引擎（[见此](http://weblogs.asp.net/fmarguerie/archive/2003/10/01/29964.aspx)）

方言和其他休眠设置应该是[Microsoft Access](http://www.hibernate.org/361.html#A4)的设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T10:59:18.853

不，据我所知。我有同样的要求，最终只使用平面 XML 文件并手动滚动所有 CRUD。

就在今天，我确实碰巧注意到 codeplex 上的这个[文件系统数据库](http://filesystemdatabase.codeplex.com/)，但还没有正确查看它。

# .net - Remove .net ContextMenuStrip Padding

> ID：680996
> 
> 赞同：2
> 
> 时间：2009-03-25T10:22:42.653
> 
> 标签：.net, contextmenustrip

When creating a ContextMenuStrip, there is a huge amount of padding around the contained controls. For example:

```
 Me.myMenu = New ContextMenuStrip
    'unset all obvious padding settings'
    Me.myMenu.ShowCheckMargin = False
    Me.myMenu.ShowImageMargin = False
    Me.myMenu.Margin = New System.Windows.Forms.Padding(0)
    Me.myMenu.Padding = New System.Windows.Forms.Padding(0)

    Dim addButton As New Button
    addButton.Size = New Size(60, 60)
    addButton.Text = "Button"
    Dim addControlHost As New ToolStripControlHost(addButton)

    Me.myMenu.Items.Add(addcontrolhost)

    Me.ContextMenuStrip = Me.myMenu 
```

This, ideally, would cause a 60x60 button to pop up at the cursor location. What actually pops up is this:

[alt text http://img144.imageshack.us/img144/8512/contextmenubutton.png](http://img144.imageshack.us/img144/8512/contextmenubutton.png)

The button is there, as expected, but despite there being no margin, no padding, and having set both Show*Margin settings to False, there is a massive border around the Button.

I'm probably missing something blindingly obvious, but how can I get rid of all the white bordering, especially that huge right-hand margin?

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-05-31T12:58:19.147

我认为设置 ShowShortCutKeys = False 会消除一些额外的右边距。

# winapi - 如何使用 Direct3D9 确定哪些显示器连接到同一物理设备？

> ID：680997
> 
> 赞同：3
> 
> 时间：2009-03-25T10:22:50.703
> 
> 标签：winapi, direct3d, multiple-monitors

使用 Direct3D9，我可以使用`IDirect3D9::GetAdapterCount()`. 但是，这会返回输出的数量，即单个双头显卡的 2 个。使用 Win32 API，我可以使用以下代码段枚举显示设备和连接的监视器：

```
DISPLAY_DEVICE displayDevice;
::ZeroMemory(&displayDevice, sizeof(displayDevice));
displayDevice.cb = sizeof(displayDevice);

/* Enumerate adapters. */
for (UINT i = 0; ::EnumDisplayDevices(NULL, i, &displayDevice, 0); i++) {

    /* Enumerate the monitors. */
    for (UINT j = 0; ::EnumDisplayDevices(displayDevice.DeviceName, j, 
            &displayDevice, 0); j++) {
        // Do stuff here
    } 
} 
```

我的问题是：在 D3D 中是否有一个等价物，如果我之后使用创建 D3D 设备也可以正常工作`D3DCREATE_ADAPTERGROUP_DEVICE`？如果不是，我是否可以对设备的枚举顺序做出任何假设，以将 Win32 API 结果与 D3D 适配器匹配？换句话说：Direct3D 适配器 0 是否保证是返回的第一个适配器`EnumDisplayDevices`？

补充：我刚刚发现，我可以将设备名称匹配`D3DADAPTER_IDENTIFIER9`到Win32的设备名称。但是，有没有办法首先从 D3D 获取物理设备？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T15:27:23.647

如果有人感兴趣，我发现了如何做到这一点：`NumberOfAdaptersInGroup`其中`D3DCAPS9`包含适配器组的主设备（具有多个交换链的物理设备）的输出数量，并且对于从属（“非物理”适配器）为零。MSDN 状态：

> NumberOfAdaptersInGroup 对于常规适配器为 1，对于多头卡的主适配器大于 1。对于多头卡的从属适配器，该值将为 0。每张卡最多可以有一个主人，但可能有很多下属。

# java - how do I get the position in a scanner after find?

> ID：680998
> 
> 赞同：0
> 
> 时间：2009-03-25T10:24:23.087
> 
> 标签：java

```
 private static String find(Scanner sc, String pattern) {  
        String Stoken;
        while (( Stoken = sc.findInLine(pattern)) == null) {
            if (sc.hasNextLine()) {
                sc.nextLine();           
            } else {
                return null;
            }
        }
        return Stoken;  // return string that match the pattern
} 
```

I know that somewhere before my data I need to get - i have a pattern -but I want to collect the data I need after the pattern - so maybe if I get the position of the pattern in the scanner I can substring in the scanner and collect what I need - but position is private - do I have a way to know it?

the data is different each time so i can not look for it directly

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T11:21:26.133

怎么样

```
int startIndexOfMatch = sc.match().start(); 
```

?

请将您的代码格式化为*代码示例*。

# php - 如何从 MySQL 记录发送自动电子邮件？

> ID：680999
> 
> 赞同：1
> 
> 时间：2009-03-25T10:24:39.623
> 
> 标签：php, mysql

我正在使用 MySQL 数据库和 PHP。
我的 MySQL 数据库包含以下记录：

```
 Name  Address    Data    email             Date
  Joy   Fortblair  10     my@gmail.comm    1/22/2009
  Bob   Atlanta    15      bob@gmail.com    2/22/2009 
```

我的意图是在以下条件下使用 PHP 发送电子邮件：

*   数据是 1 天前的数据。( `Current date - date = 1 day`)

*   它应该一次邮寄所有的电子邮件记录。

最好的入门方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-25T10:38:00.713

SQL查询非常简单，如下所示

```
SELECT *, TIMESTAMPDIFF(day, Date, NOW()) FROM `your_table_name` WHERE TIMESTAMPDIFF(day, Date, NOW()) = 1; 
```

现在您必须获取结果的内容并将它们放在一个字符串中

```
<?php
$sql = " SELECT *, TIMESTAMPDIFF(day, Date, NOW()) FROM `your_table_name` WHERE TIMESTAMPDIFF(day, Date, NOW()) = 1";
$query = mysql_query($query);
$emailBody = "";
while($row = mysql_fetch_assoc($query))
{
   $emailBody .= "Name: ".$row['Name']."; Address: ".$row['Address']."; Data: ".$row['Data']."; Email: ".$row['email']." \n";
}

mail("address@yourdomain.com", "Subject", $emailBody);
?> 
```

享受！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T10:31:49.263

```
 SELECT email FROM Table WHERE DATEDIFF(CURRENT_DATE(), Date) >= 1 
```

至于只发送一次：要么将您已发送电子邮件的事实存储在数据库中，要么每天使用相等比较 (=) 而不是大于或等于 (>=) 调用脚本*******************************