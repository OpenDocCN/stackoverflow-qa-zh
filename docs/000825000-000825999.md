# StackOverflow 问答 000825000-000825999

# orm - Classic ASP 有 OR/M 吗？

> ID：825001
> 
> 赞同：7
> 
> 时间：2009-05-05T14:01:35.860
> 
> 标签：orm, asp-classic

是否有可以在 Classic ASP 中使用的 OR/M（对象关系映射器）？即使是简化的类对象也会对处理简单的 CRUD 任务有很大帮助。

是的，我知道 ASP.NET 有很多，我将其中一些用于 ASP.NET 站点。然而，这是一个使用 ASP/VBScript 的传统电子商务网站，完全重写它是不可能的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T14:07:00.137

您可以通过 COM Interop 使用 .net，并在 .net 中执行您的 ORM。另一种选择是使用[Code Smith](http://www.codesmithtools.com)或[MyGeneration](http://www.mygenerationsoftware.com/)并生成 VB6 类。

这是一些我没有使用或研究过的 VB6 ORM： [http ://www.sparxsystems.com.au/products/ea/features.html](http://www.sparxsystems.com.au/products/ea/features.html)

如果我找到了我会更新

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T14:09:36.667

没有什么可以阻止您使用 C# 或 VB.Net 和 COM 互操作来创建可以被您的经典 ASP 页面读取的 DLL。我们已经这样做了好几次了。

[MSDN 有两个关于COM Interop](http://msdn.microsoft.com/en-us/library/aa645712(VS.71).aspx)的好教程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-23T02:04:48.070

试试我的名为 Clapper 的项目。它在 Github 上可用。[https://github.com/jeremychild/Clapper](https://github.com/jeremychild/Clapper)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-04T13:46:25.500

我还创建了一个框架，但没有上面说的一些框架那么强大，是一个简单但非常有用的框架，对我帮助很大。

它在这里： [https ://github.com/FelipeNathan/asp-orm](https://github.com/FelipeNathan/asp-orm)

这是葡萄牙语

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-05-05T14:26:14.910

我认为 IMVHO 认为 ORM 是小型项目的不错选择，但我更喜欢大型项目的简单直接 ODBC 连接。

ORM 的所有（良好）特性都可以由良好的 RDBMS（如 Oracle 或 SQL Server）提供。

# c++ - g++ 拒绝了我的简单仿函数“期望一个类型，得到'xyz'”

> ID：825015
> 
> 赞同：6
> 
> 时间：2009-05-05T14:04:36.803
> 
> 标签：c++, templates, g++, functor

我一直在玩 C++ 中的函子。特别是，我有一个对的向量，我想按对的第一个元素进行排序。我开始编写一个完全专业的仿函数（例如“bool MyLessThan(MyPair &lhs, MyPair &rhs)”）。然后，仅仅因为这类东西很有趣，我想尝试编写一个通用的“将 F 应用于这对的第一个元素”函子。我在下面写了，但 g++ 不喜欢它。我得到：

错误：“模板结构 Pair1stFunc2”的模板参数列表中参数 2 的类型/值不匹配错误：预期类型，得到“更少”

```
#include <algorithm>
#include <functional>
#include <utility>
#include <vector>

template <class P, class F>
struct Pair1stFunc2
{
    typename F::result_type operator()(P &lhs, P &rhs) const
    { return F(lhs.first, rhs.first); }

    typename F::result_type operator()(const P &lhs, const P &rhs) const
    { return F(lhs.first, rhs.first); }
};

typedef std::pair<int,int> MyPair;
typedef std::vector<MyPair> MyPairList;

MyPairList pairs;

void foo(void)
{
    std::sort(pairs.begin(),
              pairs.end(),
              Pair1stFunc2<MyPair, std::less>());
} 
```

谁能阐明我在这里做错了什么？我知道这是一个稍微人为的例子，但我想知道发生了什么，如果只是为了改进我的 STL-fu。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T14:22:30.550

为了扩展 dirkgently 的答案，这里有一个示例，说明可能会按您的意图工作：

```
template <typename T, template <typename> class F>
struct Pair1stFunc2
{
    template <typename P>
    typename F<T>::result_type operator()(P &lhs, P &rhs) const
    { F<T> f; return f(lhs.first, rhs.first); }

    template <typename P>
    typename F<T>::result_type operator()(const P &lhs, const P &rhs) const
    { F<T> f; return f(lhs.first, rhs.first); }
};

void foo(void)
{
    std::sort(pairs.begin(),
              pairs.end(),
              Pair1stFunc2<int, std::less>());
} 
```

请注意，它有效，但可能与您的想法不完全一致。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T14:13:17.920

请注意，它本身就是一个模板，当您使用函数的!`std::less`调用它时，您没有指定模板模板参数。这是一个不完整的类型，因此是问题所在。`foo()``sort``less`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T14:19:28.703

您需要使用您正在使用的比较类型专门化 std::less 。

```
Pair1stFunc2<MyPair, std::less<int> >() 
```

会成功的。在您自己的 operator() 中，您还需要实例化一个比较类型的对象，因为您不能直接调用该类。例如改变

```
return F(lhs.first, rhs.first); 
```

到

```
F func;
return func(lhs.first, rhs.first); 
```

正如另一个答案所暗示的那样，您还可以将专业化移动到函子中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T15:13:35.857

类似于 unwesen。但是您不需要使用模板模板。

```
#include <algorithm>
#include <functional>
#include <memory>
#include <vector>

typedef std::pair<int,int> MyPair;
typedef std::vector<MyPair> MyPairList;
MyPairList pairs;

// Same as original.
template <typename T,typename F>
struct Pair1stFunc2
{
    template <typename P>
    typename F::result_type operator()(P &lhs, P &rhs) const
    { F f;  // Just need to create an anstance of the functor to use.
      return f(lhs.first, rhs.first); }

    template <typename P>
    typename F::result_type operator()(const P &lhs, const P &rhs) const
    { F f;  // Just need to create an anstance of the functor to use.
      return f(lhs.first, rhs.first); }
};

void foo(void)
{
    std::sort(pairs.begin(),
              pairs.end(),
              Pair1stFunc2<int, std::less<int> >()); // initialize the version of less
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T14:40:56.263

最简单的解决方案是将您想要的参数声明为具有合适签名的函数：

```
template<typename P, bool (*F)(P,P)> struct Pair1stFunc2 { ... } 
```

在这种情况下，将函数模板作为第二个参数传递将导致以 P,P 作为参数类型对其进行重载解析。这是有效的，因为您将重载解决方案移出`struct Pair1stFunc2::operator()`

您还希望可以传入*functor*，但这些确实需要作为模板类型参数传递，然后在 operator() 内部创建：

```
typename F::result_type operator()(const P &lhs, const P &rhs) const
{ return F()(lhs.first, rhs.first); } 
```

这里，F 是函子类型，F() 是函子的一个实例。

第三种情况已经在前面介绍过，即仿函数模板。std::less 就是这样一个模板。在这种情况下，您需要一个模板模板参数。

# c++ - Pimpl 成语 vs 纯虚拟类接口

> ID：825018
> 
> 赞同：123
> 
> 时间：2009-05-05T14:05:14.057
> 
> 标签：c++, abstract-class, pimpl-idiom

我想知道是什么让程序员选择 Pimpl 习惯用法或纯虚拟类和继承。

我知道 pimpl idiom 为每个公共方法和对象创建开销都提供了一个明确的额外间接。

另一方面，纯虚拟类带有用于继承实现的隐式间接（vtable），我知道没有对象创建开销。
**编辑**：但是如果你从外部创建对象，你需要一个工厂

是什么让纯虚拟类比 pimpl 成语更不受欢迎？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-05-05T15:15:03.857

在写一个C++类的时候，考虑一下是否会是合适的

1.  值类型

    按价值复制，身份从来都不重要。它适合作为 std::map 中的键。例如，“字符串”类，或“日期”类，或“复数”类。“复制”此类的实例是有道理的。

2.  实体类型

    身份很重要。始终通过引用传递，从不通过“值”。通常，“复制”类的实例根本没有意义。当它确实有意义时，多态“克隆”方法通常更合适。示例：Socket 类、Database 类、“策略”类、任何在函数式语言中可能是“闭包”的东西。

pImpl 和纯抽象基类都是减少编译时间依赖性的技术。

但是，我只使用 pImpl 来实现值类型（类型 1），并且仅在我真的想最小化耦合和编译时依赖关系时才使用。通常，这不值得费心。正如您正确指出的那样，存在更多的语法开销，因为您必须为所有公共方法编写转发方法。对于类型 2 类，我总是使用带有关联工厂方法的纯抽象基类。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-05-05T14:09:00.927

`Pointer to implementation`通常是关于隐藏结构实现细节。`Interfaces`是关于实例化不同的实现。它们确实有两个不同的目的。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-05-05T14:12:39.327

pimpl 习惯用法可帮助您减少构建依赖项和构建时间，尤其是在大型应用程序中，并最大限度地减少将类的实现细节的标头暴露给一个编译单元。您班级的用户甚至不需要知道疙瘩的存在（除了作为他们不知道的神秘指针！）。

抽象类（纯虚拟）是您的客户必须意识到的：如果您尝试使用它们来减少耦合和循环引用，您需要添加一些允许它们创建对象的方法（例如，通过工厂方法或类，依赖注入或其他机制）。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2010-02-25T00:28:54.197

我正在寻找同一个问题的答案。在阅读了一些文章和一些实践之后，**我更喜欢使用“纯虚拟类接口”**。

1.  他们更直接（这是一个主观意见）。Pimpl 成语让我觉得我是在“为编译器”编写代码，而不是为将阅读我的代码的“下一个开发人员”编写代码。
2.  一些测试框架直接支持 Mocking 纯虚拟类
3.  确实，您***需要***一个可以从外部访问的工厂。但是，如果您想利用多态性：那也是“赞成”，而不是“反对”。...而且一个简单的工厂方法并没有那么疼

唯一的缺点（*我正在尝试对此进行调查*）是 pimpl idiom 可能更快

1.  当代理调用被内联时，继承必然需要在运行时额外访问对象 VTABLE
2.  pimpl public-proxy-class 的内存占用更小（您可以轻松地进行优化以实现更快的交换和其他类似的优化）

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2010-10-05T14:37:06.497

我讨厌痘痘！他们把课做得丑陋而且不可读。所有方法都重定向到疙瘩。您永远不会在标题中看到该类具有哪些功能，因此您无法重构它（例如，只需更改方法的可见性）。上课感觉就像“怀孕了”。我认为使用 iterfaces 更好，并且真的足以向客户端隐藏实现。您可以让一个类实现多个接口以保持它们的精简。应该更喜欢接口！注意：您不需要工厂类。相关的是类客户端通过适当的接口与其实例进行通信。我发现隐藏私有方法是一种奇怪的偏执狂，因为我们有接口，所以看不到这样做的原因。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-05-05T14:43:26.633

共享库有一个非常现实的问题，pimpl 惯用语巧妙地规避了纯虚拟无法解决的问题：如果不强制类的用户重新编译他们的代码，就无法安全地修改/删除类的数据成员。在某些情况下这可能是可以接受的，但对于系统库来说则不然。

要详细解释问题，请考虑共享库/头文件中的以下代码：

```
// header
struct A
{
public:
  A();
  // more public interface, some of which uses the int below
private:
  int a;
};

// library 
A::A()
  : a(0)
{} 
```

编译器在共享库中发出代码，该代码计算要初始化的整数的地址，使其从指向它知道的 A 对象的指针到某个偏移量（在这种情况下可能为零，因为它是唯一的成员）`this`。

在代码的用户端， a`new A`将首先分配`sizeof(A)`内存字节，然后将指向该内存的指针传递给`A::A()`构造函数 as `this`。

如果在您的库的更高版本中您决定删除整数、使其更大、更小或添加成员，则用户代码分配的内存量与构造函数代码期望的偏移量之间将不匹配。可能的结果是崩溃，如果你幸运的话——如果你不那么幸运，你的软件就会表现得很奇怪。

通过 pimpl'ing，您可以安全地向内部类添加和删除数据成员，因为内存分配和构造函数调用发生在共享库中：

```
// header
struct A
{
public:
  A();
  // more public interface, all of which delegates to the impl
private:
  void * impl;
};

// library 
A::A()
  : impl(new A_impl())
{} 
```

你现在需要做的就是让你的公共接口没有数据成员，而不是指向实现对象的指针，这样你就不会出现这类错误。

**编辑：**我可能应该补充一点，我在这里谈论构造函数的唯一原因是我不想提供更多代码 - 相同的论点适用于访问数据成员的所有函数。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2010-02-27T12:37:56.040

我们不能忘记继承是比委托更强大、更紧密的耦合。在决定在解决特定问题时采用哪些设计习惯时，我还会考虑给出的答案中提出的所有问题。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-06-13T14:05:27.680

尽管在其他答案中广泛涵盖了也许我可以更明确地说明 pimpl 对虚拟基类的一个好处：

从用户的角度来看，pimpl 方法是透明的，这意味着您可以例如在堆栈上创建类的对象并直接在容器中使用它们。如果您尝试使用抽象虚拟基类隐藏实现，则需要从工厂返回一个指向基类的共享指针，从而使其使用复杂化。考虑以下等效的客户端代码：

```
// Pimpl
Object pi_obj(10);
std::cout << pi_obj.SomeFun1();

std::vector<Object> objs;
objs.emplace_back(3);
objs.emplace_back(4);
objs.emplace_back(5);
for (auto& o : objs)
    std::cout << o.SomeFun1();

// Abstract Base Class
auto abc_obj = ObjectABC::CreateObject(20);
std::cout << abc_obj->SomeFun1();

std::vector<std::shared_ptr<ObjectABC>> objs2;
objs2.push_back(ObjectABC::CreateObject(13));
objs2.push_back(ObjectABC::CreateObject(14));
objs2.push_back(ObjectABC::CreateObject(15));
for (auto& o : objs2)
    std::cout << o->SomeFun1(); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-05T14:37:02.450

据我了解，这两件事的目的完全不同。pimple 习惯用法的目的基本上是为您提供实现的句柄，以便您可以执行诸如快速交换之类的操作。

虚拟类的目的更接近于允许多态性，即您有一个指向派生类型对象的未知指针，并且当您调用函数 x 时，您总是会为基指针实际指向的任何类获得正确的函数。

苹果和橙子真的。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-01-18T09:27:55.627

pimpl 惯用语最烦人的问题是它使维护和分析现有代码变得极其困难。因此，使用 pimpl 您付出开发人员的时间和挫折只是为了“减少构建依赖项和时间并最大限度地减少实现细节的标头暴露”。自己决定，是否真的值得。

特别是“构建时间”是您可以通过更好的硬件或使用 Incredibuild（www.incredibuild.com，也已包含在 Visual Studio 2017 中）等工具来解决的问题，因此不会影响您的软件设计。软件设计通常应该独立于软件的构建方式。

# visual-studio - 如何将保存在数据库中的图像加载到 Visual Studio ReportViewer 2008？

> ID：825020
> 
> 赞同：2
> 
> 时间：2009-05-05T14:05:38.237
> 
> 标签：visual-studio, visual-studio-2008, reportviewer

有谁知道如何获取保存在数据库中的 AI 图像并将其显示在 ReportViewer 2008 上？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T18:10:16.167

我目前正在这样做，但是，这并不容易实现。

我创建了一个在 MemoryStream 中生成 RDLC 文件的类。RDLC 内存流被发送到 reportViewer 控件，该控件依次显示报表。

在生成 RDLC 文件期间，您可以创建嵌入图像。为此，我将图像检索到 Byte 数组中，然后将 Byte 数组转换为 Base64 编码。RDLC 文件需要 Base64 编码才能正确显示图像。

同样，这并不容易实现，所以你真的需要这样做才能实现它。如果您想继续使用此方法，我可以为您提供更多详细信息。

**编辑**（更多细节）

[您可以在GotReportViewer](http://gotreportviewer.com/)获得一些关于如何动态创建 RDLC 文件的示例代码。直接链接到[VB.NET](http://gotreportviewer.com/DynamicTableVB.zip)和[C#](http://gotreportviewer.com/DynamicTable.zip)的代码。

如果您能够设法弄清楚该代码的工作原理，您将能够生成 RDLC 文件，而无需自己手动创建文件。再次，我需要强调一个事实，即您将进行很多修改才能到达您想要的位置。

现在，为了生成图像，从数据库中检索它。当您从数据库中取回它时（我使用 BLOB），您将获得一个 Byte 数组。Byte 数组保存图像的数据，但 I 不能在其当前状态下使用。要转换它，您可以执行以下操作：

```
Dim output As String = ""
output = Convert.ToBase64String(imgByteArray) 
```

生成的输出字符串将与 ReportViewer 兼容。现在您可以将此字符串动态添加到 ReportViewer 的 RDLC 文件（XML 文件）中。使用 GotReportViewer 中的代码示例，您可以执行以下操作：

```
 'Inserts embedded images into the report
  Overridable Function CreateEmbeddedImages() As Rdl.EmbeddedImagesType
    Dim bgCell As New Rdl.EmbeddedImageType
    Dim images As New Rdl.EmbeddedImagesType

    bgCell.Name = "bgTableHeader"
    bgCell.Items = New Object() {"image/jpeg", output}
    bgCell.ItemsElementName = New Rdl.ItemsChoiceType35() {Rdl.ItemsChoiceType35.MIMEType, Rdl.ItemsChoiceType35.ImageData}

    images.EmbeddedImage = New Rdl.EmbeddedImageType() {bgCell}
    Return images

  End Function 
```

RDL 类型是报表定义语言类文件。基本上，它是一个反向工程的 RDLC XSD Schema。它包含将用于为您的报告生成有效 XML 文件的类。它包含在顶部的 GotReportViewer 链接中，但您可以使用 Visual Studio 提供的 XSD.EXE 工具自己生成一个。

# vmware - Amazon EC2 可用作 VMware 测试平台？

> ID：825023
> 
> 赞同：3
> 
> 时间：2009-05-05T14:06:29.483
> 
> 标签：vmware, amazon-ec2

我们需要在本地化平台上执行测试，这会给我们的硬件资源带来一些负担，因为在短短几周内，我们可能需要多个服务器和客户端（Windows 2003 和 Windows 2008、Vista、XP、Red Hat 等）语言。

我们通常依赖带有 Windows 2003 和 VMWare 的刀片，但有时这些刀片会因准时需求而过度生长，并且如果环境需要增长，还存在采购和部署过程相当缓慢的问题。

Amazon EC2/S3 在以下场景中是否可用？

1.  在 Amazon AMI 上安装 VMWare（桌面，因为我们需要拥有快照的能力）。
2.  从 S3 加载现有 VMWare 映像并在 EC2 实例上运行它们（每个 EC2 实例上可能有 3 或 4 个服务器或客户端操作系统。

我们更感兴趣的是能够非常轻松地启动或停止 VMware snaphsot 以进行相对较短的测试。这仅用于测试配置，而不是实际服务于用户工作负载的生产环境。唯一真正的用户是测试人员。这些配置可能只需要几个星期，然后关闭几个月，直到下一个版本再次需要它们。

EC2/S3 是否是此类测试目的的可行替代方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T14:36:56.897

您真的需要 VMWare，还是在测试在 VMWare 虚拟机中运行的软件？如果您正在测试例如 VMWare 部署策略，或者正在运行测试 VMWare API 的代码，您可能实际上需要 VMWare。后者的示例可能是您正在测试应用程序服务器堆栈，并且当前使用 VMWare 在许多平台上进行测试。

如果你真的需要 VMWare，我不相信你可以在 EC2 中安装 VMWare。如果不是这种情况，有人会纠正并启发我。

如果您实际上不需要 VMWare，那么您有更多选择。如果您可以使用[无数公共 AMI](http://developer.amazonwebservices.com/connect/kbcategory.jspa?categoryID=171)之一作为基准，请克隆适当的 AMI 并对其进行自定义以满足您的需求（将自定义版本保存为您团队的私有 AMI）。然后，您可以根据需要使用任意数量的它们。也许您已经拥有一堆需要在测试中使用的 VMWare 映像。在这种情况下，您可以将您的 VMWare 映像迁移到 EC2 AMI，如 Google 中各个地方所述，例如：

[http://thewebfellas.com/blog/2008/9/1/creating-an-new-ec2-ami-from-within-vmware-or-from-vmdk-files](http://thewebfellas.com/blog/2008/9/1/creating-an-new-ec2-ami-from-within-vmware-or-from-vmdk-files)

（向 SO 审查员道歉，因为没有在此处粘贴整篇文章。它很长。）但这是一条捷径；您始终可以使用记录在案的 AMI 创建过程将任何机器（无论是否为 VMWare）转换为 AMI。为您拥有的每个 VMWare 虚拟机执行该过程，然后一切就绪。请记住，当您创建 AMI 时，您必须将其上传到 S3，这对于大型 VM 来说将花费大量时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-10T18:39:56.637

这是一个有点无耻的插件，但我们有一个新的创业公司可以解决你的问题。Amazon EC2 非常适合按需计算，但实际上只针对单个用户启动生产服务器。我们对 EC2 进行了扩展，使其成为一个虚拟实验室管理环境，具有自助服务、策略和 VM 共享。您可以在[http://LabSlice.com](http://LabSlice.com)上查看它，看看它是否满足您的需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-17T07:43:15.050

亚马逊现在自己提供了一个解决方案：http: [//aws.typepad.com/aws/2010/12/amazon-vm-import-bring-your-vmware-images-to-the-cloud.html](http://aws.typepad.com/aws/2010/12/amazon-vm-import-bring-your-vmware-images-to-the-cloud.html)

# android - 有没有办法给某人打电话并在android中播放音频文件？

> ID：825029
> 
> 赞同：6
> 
> 时间：2009-05-05T14:07:25.300
> 
> 标签：android, audio, telephony

我想创建一个紧急呼叫应用程序：如果触发，它会呼叫给定号码并播放音频文件，提供呼叫者无法提供的信息。

为此，我需要拨打电话，但要确保我可以用播放的音频文件替换扬声器的任何声音。我可以在 android 中做到这一点吗？有什么办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T18:47:30.070

此时您无法使用 G1 执行此操作，因为两个不同的处理器处理呼叫和应用程序，并且它们之间没有路径。AFAIK 这还没有在 SDK 中，但假设硬件可以做到这一点，它将被添加到 SDK 中。

[http://groups.google.com/group/android-developers/browse_thread/thread/d04c307973345fef/a628e578900b3dce?lnk=gst&q=dave+sparks+play+audio#a628e578900b3dce](http://groups.google.com/group/android-developers/browse_thread/thread/d04c307973345fef/a628e578900b3dce?lnk=gst&q=dave+sparks+play+audio#a628e578900b3dce)

# tfs - 需要从SVN服务器访问网络文件夹

> ID：825036
> 
> 赞同：1
> 
> 时间：2009-05-05T14:09:36.167
> 
> 标签：tfs, svn

我们计划在 TFS 和 SVN 之间进行每日同步。来自 TFS 的更新（最新版本）将在网络文件夹中完成，并且 SVN 存储库将被更新以从网络文件夹中获取最新版本。是否有脚本可以从 SVN 访问网络文件夹以获取最新信息？

许可证过期时，我们正在使用 TFS。我们拥有有限的 TFS 许可。所以我们在 TFS 上的开发正在进行中。但我们最终计划迁移到 SVN。我们计划将源代码移动到 SVN，并每天从 TFS 同步到 SVN。从 TFS 到 SVN 将是单向的。我们计划在网络中创建一个文件夹，该文件夹将通过脚本从 TFS db 更新为最新版本，并运行另一个脚本以从包含“最新”的网络文件夹中更新 SVN 存储库

# python - 你如何让 Python Msqldb 模块使用？而不是 %s 查询参数？

> ID：825042
> 
> 赞同：3
> 
> 时间：2009-05-05T14:10:36.960
> 
> 标签：python, sql, mysql, database

MySqlDb 是一个很棒的 Python 模块——但有一部分非常烦人。查询参数如下所示

```
cursor.execute("select * from Books where isbn=%s", (isbn,)) 
```

而在已知宇宙中的其他任何地方（oracle、sqlserver、access、sybase ......）它们看起来像这样

```
cursor.execute("select * from Books where isbn=?", (isbn,)) 
```

这意味着如果你想便携，你必须以某种方式在两种符号之间切换？还有 %s，这真的很烦人。（请不要告诉我使用 ORM 层——我会扼杀你）。

假设你可以说服 mysqldb 使用标准语法，但我还没有让它工作。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T14:15:20.320

我发现了很多关于`paramstyle`这似乎暗示它可能是你想要的信息，但是[根据这个 wiki](http://helpful.knobs-dials.com/index.php/Python_notes/Databases#parameters.2C_paramstyle)，你必须使用`paramstyle`你的库使用的，并且其中大多数不允许你更改它：

> `paramstyle`特定于您使用的库，并且提供信息 - 您必须使用它使用的库。这可能是该标准中最烦人的部分。（一些允许您设置不同`paramstyles`的，但这不是标准行为）

我发现一些关于 MySQLdb 允许这样做的帖子，但显然它并没有，因为有人表示它对他们不起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-20T03:10:13.563

据我所知，您不能使用“？” 用于带有 MySQLdb 的参数标记（开箱即用）

但是，您**可以**使用命名参数

IE

```
cursor.execute("%(param1)s = %(param1)s", {'param1':1}) 
```

将有效地执行 `1=1`

在mysql中

**但**有点像 Eli 的回答（但不是 hackish）

你可以改为：

**MyNewCursorModule.py**

```
import MySQLdb.cursors import Cursor

class MyNewCursor(Cursor):
  def execute(self, query, args=None):
     """This cursor is able to use '?' as a parameter marker"""
     return Cursor.execute(self, query.replace('?', '%s'), args)

  def executemany(self, query, args):
     ...implement... 
```

在这种情况下，您将拥有一个自定义光标，它可以执行您希望它执行 的操作**，而且**它不是 hack。它只是一个子类；）

并将其用于：

```
from MyNewCursorModule import MyNewCursor

conn = MySQLdb.connect(...connection information...
                       cursorclass=MyNewCursor) 
```

*（如果您想在大部分时间使用正常执行（临时覆盖），您也可以将类赋予 connection.cursor 函数以在那里创建它）*

...您也可以将简单的替换更改为更正确的内容（假设有一种方法可以避开问号），但这是我将留给您的：）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T14:16:45.137

我不建议这样做，但最简单的解决方案是猴子补丁`Cursor`类：

```
from MySQLdb.cursors import Cursor
old_execute = Cursor.execute
def new_execute(self, query, args):
   return old_execute(self, query.replace("?", "%s"), args) 
Cursor.execute = new_execute 
```

# java - 如何将 Java 后端与 .NET 前端连接起来

> ID：825043
> 
> 赞同：0
> 
> 时间：2009-05-05T14:10:53.917
> 
> 标签：java, .net, web-services

我有一堆使用 Hibernate 框架编写的 Java 代码，最初注定要使用 JSP 编写前端。但是，前端的要求已经改变，我们决定桌面客户端（将用 .NET 编写）更适合我们的用户。

我真的不想浪费已经编写的代码 - 任何人都可以推荐一套好的工具来编写我们将能够从 .NET 访问的基于文档的 Web 服务界面吗？

谢谢，

吉姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T14:17:25.743

如果你真的想要一个基于文档的服务接口（而不是一个 RPC 风格的 Web 服务架构），你最好的选择是创建一个基于 SOAP 的 Web 服务接口。

快速浏览一下 Java 站点会发现 Metro 堆栈可能会有所帮助：

[Java Web 服务概览](http://java.sun.com/webservices/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:41:44.730

We're developing an application with the exact architecture you describe for a finance application. We reviewed several different options, and have finally landed on using compressed CSV over HTTP.

CSV was chosen since the vast majority of data was going to be displayed in a grid on the front end, we had very large result sets >250k rows on a regular basis, and it compresses really really well.

We also looked at using:

*   ICE, but declined on that due to licensing costs and the need to reinvent so much.
*   Google's protocol buffers via servlets, but declined on that due to lack of C# support (as of last fall).
*   Compressed XML using WOX, but declined on that due to lock-in to a small thesis project for support and XML being too verbose.

The industry supports a couple of different options as well:

*   SOAP, but that has its own well documented issues.
*   IIOP, J-Integra has a product called Espresso which will allow you to do RMI from a front end.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T14:13:34.363

我个人会使用一些轻量级的 RPC 协议，无论是 XML-RPC 还是本土协议。SOAP，IMO，太胖了，不像它应该的那样具有互操作性。越简单越好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T14:15:16.077

我们有一个相当大的应用程序，它使用 Java RMI 服务器和[IIOP.NET](http://iiop-net.sourceforge.net/)来实现互操作性。我们已经将 IIOP.NET 与 Sun RMI 和 Bea Weblogic（现在的 Oracle）一起使用，没有出现重大问题。

# c# - 在刷新（F5）页面后，检查的 CheckChanged 事件没有被触发，检查是 Gridview 的子控件

> ID：825046
> 
> 赞同：0
> 
> 时间：2009-05-05T14:12:02.357
> 
> 标签：c#, asp.net, webforms

我的页面中有 3 个 gridview 控件。每个网格本身我都将复选框用作模板字段。当我选择第一个网格复选框时。它显示了一些记录。此时我按下 F5（Referesh）按钮。页面中的所有事件都没有触发。

网格中的复选框：

```
<asp:GridView ID="gvSelectQuest"  runat="server" AutoGenerateColumns="False" 
    AllowSorting="True"  onrowdatabound="gvQuestion_RowDataBound">  
    <Columns>   
        <asp:TemplateField HeaderText="Select">
            <ItemTemplate >
                <asp:CheckBox ID="chkSelectGrp" AutoPostBack ="true" OnCheckedChanged ="CheckChanged" runat="server"/>
            </ItemTemplate>
        </asp:TemplateField>                
        <asp:BoundField DataField="_quest_AdminID" HeaderText="AdminID" />
    </Columns>
</asp:GridView> 
```

复选框事件：

```
public void CheckChanged(object sender, EventArgs e)
{
    CheckBox chk = (CheckBox)(sender);
    foreach (GridViewRow rowItem in gvQuesGroup.Rows)
    {
    }
} 
```

请任何人帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T17:37:34.950

将此用于 ItemTemplate 中的复选框以触发事件，不要按 F5 触发

```
<asp:CheckBox ID="chkQuest" runat="server" OnCheckedChanged="CheckChanged" AutoPostBack="True" /> 
```

# javascript - CalendarExtender 使用 Javascript 更改日期

> ID：825047
> 
> 赞同：13
> 
> 时间：2009-05-05T14:12:05.477
> 
> 标签：javascript, ajax, calendarextender

我的页面上有一个 CalendarExtender 控件，有时必须将日期更改为下一个星期天。我目前正在使用控件的 OnClientDateSelectionChanged 属性来调用一个函数，该函数将在日期上添加几天直到其星期日。

我遇到的问题是，如果我在日历中选择一个星期二，文本框将显示下一个星期日，但日历中选择的日期仍然是星期二。

如何更新 CalendarExtender 以拥有我在 javascript 中选择的新日期？CalendarExtendar 连接到的文本框显示正确的日期...

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-13T21:28:15.753

Changing the value of the textbox that is the **TargetControlId** for the **CalendarExtender** affects the *selected date* if the following 2 conditions are met:

1.  An **onchange** event is fired on the textbox (either by changing the text manually or by calling an explicit javascript fireEvent() method.
2.  The **format** of the date entered in the textbox matches the same format used by the CalendarExtender control.

That being said, the correct way to handle this is to call the `set_selectedDate()` function of the CalendarExtender control. This one call, not only sets the selected on the Calendar, but also on the Targeted textbox at the same time.

Here's the example code:

```
<cc1:CalendarExtender ID="CalendarExtender1" runat="server" 
        OnClientDateSelectionChanged="dateSelectionChanged" 
        TargetControlID="txtDate" PopupButtonID="imgCalendar">
</cc1:CalendarExtender>

<script type="text/javascript">
  function dateSelectionChanged(sender, args){
    selectedDate = sender.get_selectedDate();
    /* replace this next line with your JS code to get the Sunday date */
    sundayDate = getSundayDateUsingYourAlgorithm(selectedDate); 
    /* this sets the date on both the calendar and textbox */
    sender.set_SelectedDate(sundayDate); 
 }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-29T12:39:28.043

```
<asp:TextBox ID="txtDate" Text='<%# Bind("Date", "{0:dd-MMM-yyyy}") %>'
                                                                                            runat="server" class="form-control input-sm m-bot15" BackColor="#ffccbb"></asp:TextBox>
                                                                                        <asp:CalendarExtender ID="CalExtender1" runat="server" Enabled="true" Format="dd-MMM-yyyy"
                                                                                            TargetControlID="txtDate">
                                                                                        </asp:CalendarExtender> 
```

# asp.net - 访问列表视图的 edititemtemplate 中的控件

> ID：825048
> 
> 赞同：5
> 
> 时间：2009-05-05T14:12:20.483
> 
> 标签：asp.net, listview

我正在使用 listview 控件。默认情况下，我使用编辑按钮显示项目模板。当按下编辑按钮时，列表视图切换到编辑项模板。我需要根据正在编辑的项目填充edititemtemplate中的控件之一-我尝试在ItemEditing事件（以及几乎所有其他事件）中访问控件（通过FindControl），但是控件只是不' t 似乎存在。我可以访问 itemtemplate 中的控件，但不能访问 edititemtemplate。

谁能让我知道如何访问列表视图的edititemtemplate中保存的控件，以及我应该从哪个事件中访问？

**编辑** 我正在尝试使用以下方法访问控件：

```
protected void UnitsLV_ItemEditing(object sender, ListViewEditEventArgs e)
{
    ListViewItem item = UnitsLV.Items[e.NewEditIndex];
    ListBox tempLB = (ListBox)e.item.FindControl("ListBox3");
} 
```

我也尝试过 ItemDataBound 和 ItemCreated。

列表视图声明是：

```
<asp:Content ID="Content1" ContentPlaceHolderID="ColumnA" runat="server">
    <asp:Panel ID="Panel1" runat="server">
        <asp:UpdatePanel ID="UpdatePanel1" runat="server">
            <ContentTemplate>
                <asp:Panel ID="SummaryPnl" runat="server">
                    <asp:ListView ID="UnitsLV" runat="server" DataSourceID="DataLDS" DataKeyNames="u_uid"
                        InsertItemPosition="LastItem" OnItemInserting="UnitsLV_ItemInserting" OnItemDataBound="UnitsLV_ItemDataBound"
                        OnItemCreated="UnitsLV_ItemCreated" onitemediting="UnitsLV_ItemEditing">
                        <ItemTemplate>
                            <tr class="rowA">
                                <td>
                                    <asp:Label runat="server" ID="UnitIDLbl" Text='<%# Eval("u_uid")%>'></asp:Label>
                                </td>
                                <td>
                                    <%# Eval("u_Title")%>
                                </td>
                                <td>
                                    <asp:LinkButton ID="EditBtn" runat="server" CommandName="Edit" CommandArgument='<%#Eval("u_uid") %>'
                                    Text="Edit" />
                                </td>
                                <td>
                                    <asp:LinkButton ID="DeleteBtn" runat="server" CommandName="Delete" CommandArgument='<%#Eval("u_uid") %>'
                                    Text="Delete" />
                                </td>
                            </tr>
                        </ItemTemplate>
                        <InsertItemTemplate>
                            <tr class="rowB">
                                <td>
                                    <br />
                                    &nbsp;
                                </td>
                                <td>
                                    <br />
                                    <asp:TextBox ID="TitleTB" runat="server" Text='<% #Bind("u_Title")%>'></asp:TextBox>
                                </td>
                                <td>
                                    <br />
                                    <asp:ListBox ID="ListBox3" runat="server"></asp:ListBox>
                                    <asp:ListBox ID="ToBeDeletedLB" runat="server"></asp:ListBox>
                                </td>
                                <td>
                                    <asp:LinkButton ID="InsertBtn" runat="server" CommandName="Insert" Text="Insert" />
                                </td>
                                <td>
                                    <asp:LinkButton ID="CancelBtn" runat="server" CommandName="Cancel" Text="Cancel" />
                                </td>
                            </tr>
                        </InsertItemTemplate>
                        <EditItemTemplate>
                            <tr class="rowB">
                                <td>
                                    <br />
                                    <asp:Label runat="server" ID="UnitIDLbl" Text='<%# Bind("u_uid")%>'></asp:Label>
                                </td>
                                <td>
                                    <br />
                                    <asp:TextBox ID="TitleTB" runat="server" Text='<% #Bind("u_Title")%>'></asp:TextBox>
                                </td>
                                <td>
                                    <br />
                                    <asp:ListBox ID="ListBox3" runat="server"></asp:ListBox>
                                    <asp:ListBox ID="ToBeDeletedLB" runat="server"></asp:ListBox>
                                </td>
                                <td>
                                    <asp:LinkButton ID="UpdateBtn" runat="server" CommandName="Update" Text="Update" />
                                </td>
                                <td>
                                    <asp:LinkButton ID="LinkButton2" runat="server" CommandName="Cancel" Text="Cancel" />
                                </td>
                            </tr>
                        </EditItemTemplate>
                        <LayoutTemplate>
                            <table id="Table2" runat="server" width="100%">
                                <tr id="Tr1" runat="server">
                                    <td id="Td1" runat="server">
                                        <table id="itemPlaceholderContainer" runat="server" border="0" style="" width="100%">
                                            <tr id="itemPlaceholder" runat="server"></tr>
                                        </table>
                                    </td>
                                </tr>
                                <tr id="Tr2" runat="server">
                                    <td id="Td2" runat="server" style=""></td>
                                </tr>
                            </table>
                        </LayoutTemplate>
                    </asp:ListView>
                </asp:Panel>
            </ContentTemplate>
        </asp:UpdatePanel>
    </asp:Panel>
</asp:Content> 
```

**编辑：** 我已经使用类似于下面的代码迭代了列表视图中的所有控件，并且该控件仍然不可见。ItemEditing 事件是否在显示编辑模板之前触发？如果是这样，我可以使用什么事件来访问编辑模板控件？

```
foreach (Control child in control.Controls)
{
   Control result = Find(child, id);
   if (result != null)
   {
      return result;
   }
} 
```

**编辑：** 我可以在列表视图的 ItemCreated 事件中访问 edititemtemplate 中的控件，但是它们没有内容（我假设数据尚未绑定），所以我无法获得密钥 -我需要进行查找以获取填充控件所需的数据。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T15:55:42.620

我已经找到了一种方法来做我需要做的事情，尽管我对此并不十分满意。

```
protected void UnitsLV_ItemDataBound(object sender, ListViewItemEventArgs e)
{
    if (UnitsLV.EditIndex > -1)
    {
        // Controls within the edititemtemplate are available via e.Item.FindControl("controlname")
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-12-21T11:01:15.987

我不知道以前的版本，但在 Visual Studio 2010 中，您可以通过“ListView.EditItem”属性轻松访问编辑项，如下所示：

```
private void myListView_ItemEditing(object sender, ListViewEditEventArgs e)
{
   myListView.EditIndex = e.NewEditIndex;
   myListView.DataBind();

   ListViewItem lvwItem = lvwLista.EditItem;
   ListBox tempLB = (ListBox) lvwItem.FindControl("ListBox3");
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-04T18:03:28.427

```
protected void ListView1_ItemUpdating(object sender, ListViewUpdateEventArgs e)
{        
        ListBox myListBox = (ListBox)(((ListView)sender).EditItem.FindControl("ListBox1")); 
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-13T22:48:51.343

```
protected void UnitsLV_ItemEditing(object sender, ListViewEditEventArgs e) 
{ 
    ListViewItem item = UnitsLV.Items[e.NewEditIndex]; 
    ListBox tempLB = (ListBox)e.item.FindControl("ListBox3"); 
} 
```

我相信我在上述函数中发现了一个错字。第二行应该是

```
ListBox tempLB = (ListBox)item.FindControl("ListBox3"); 
```

我所做的是将“e.item”替换为“item”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-01-21T13:55:56.043

我通常使用 ItemDataBound 事件...检查 ListItemType Enum 中的其他选项

```
 protected void UnitLV_ItemDataBound(object sender, DataListItemEventArgs e)
    {
        if (e.Item.ItemType == ListItemType.EditItem)
        {
                ListBox myListBox = (ListBox) e.Item.FindControl("ListBox3");
        }
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-16T21:43:04.157

这类似于公认的答案，但我认为它的作者确实在朝着这个方向努力：

```
protected void UnitsLV_ItemDataBound(object sender, ListViewItemEventArgs e)
{
    ListViewDataItem listViewDataItem = e.Item as ListViewDataItem;
    if (UnitsLV.EditIndex == listViewDataItem.DataItemIndex)
    {
        // Controls within the edititemtemplate are available via e.Item.FindControl("controlname")
    }
} 
```

# javascript - 在不实例化对象的情况下检测 Internet Explorer 中的插件

> ID：825049
> 
> 赞同：1
> 
> 时间：2009-05-05T14:12:33.477
> 
> 标签：javascript, internet-explorer, vbscript, createobject

通常，当您使用 VBScript 或 JavaScript 来 CreateObject 来检测插件时，用户会得到有点“刺耳”的安全异常。

在不实际实例化对象的情况下检测 IE 浏览器插件有哪些好方法？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-05-05T18:52:12.790

虽然我不确定检查创建对象的方法，但您仍然可以使用 javascript try-catch 块绕过安全异常。

例如：

```
function checkForObject() {
   try{
      var conn = new ActiveXObject('Msxml2.XMLHTTP');
      return true;
   } catch (e) {
      return false;
   }
} 
```

在这种情况下，实际的错误会被捕获并隐藏在用户面前。

# php - PHP 类名冲突

> ID：825052
> 
> 赞同：2
> 
> 时间：2009-05-05T14:12:47.377
> 
> 标签：php, namespaces, class, recess, vcl4php

我正在尝试将 PHP REST 框架 (Recess) 与 webapp 构建框架 (VCL4PHP) 混合，不幸的是他们喜欢将它们的类命名为相同。缓存，应用程序（可能是其他，但我放弃了应用程序）。PHP 中是否有命名空间，或者我可以通过任何方式解决这个问题，而无需重写一个或其他框架，或者我是 SF'ed？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T14:17:08.897

PHP 5.3 有命名空间，但 PHP 5.3 仍在开发中，它们不会立即解决您的问题。对于所有实际实例，您将不得不放弃其中一个框架，除非您计划分叉其中一个，以便保留您的自定义类名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T14:17:06.367

PHP 的命名空间将在 PHP 5.3 中引入。目前最好的办法是手动为每个框架的类名添加前缀。

# oracle - 有没有办法窥探另一个 Oracle 会话的内部？

> ID：825053
> 
> 赞同：1
> 
> 时间：2009-05-05T14:12:59.467
> 
> 标签：oracle, isolation-level

我有一个查看数据库的查询编辑器 ( [Toad](http://www.toadsoft.com/toad_oracle.htm) )。

同时，我也在调试一个有自己独立连接的应用程序。

我的应用程序启动一个事务，进行一些更新，然后根据一些 SELECT 语句做出决定。由于尚未提交更新语句（很多且复杂），因此我的应用程序从其 SELECT 中获得的结果与我在 Toad 中运行相同语句时获得的结果不同。

目前，我通过将应用程序的查询输出转储到文本文件中并读取它来解决这个问题。

在提交完成之前，有没有更好的方法可以窥视另一个 oracle 会话，并查看该会话看到的内容？

另一个问这个问题的方法是：在 Oracle 下，我可以只在两个会话之间启用[脏读，而不影响其他人的会话吗？](http://en.wikipedia.org/wiki/Isolation_(database_systems)#READ_UNCOMMITTED)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T22:25:25.227

不，Oracle 不允许脏读。此外，由于更改可能尚未物理写入磁盘，因此您不会在数据文件中找到它们。日志编写器将至少每三秒写入一次任何未决数据更改，因此您可以使用 Log Miner 的东西从那里挑选出来。

但总的来说，最好的办法是包含您自己的调试信息，您可以根据需要轻松打开和关闭这些信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-06T02:32:30.063

我知道这不是一个完整的答案，但是虽然没有死读，但有一些锁可以让您了解发生了什么。

在会话 1 中，如果您插入具有主键 7 的行，那么当您从会话 2 中选择时将看不到它。（那将是脏读）。

但是，如果您尝试使用主键 7 从会话 2 插入，那么它将阻塞在会话 1 后面，因为它必须等待并查看会话 1 是否会提交或回滚。您可以使用“WAIT 10”等待 10 秒以使这发生。

对于更新或任何会导致违反唯一约束的事情，也存在类似的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T20:48:06.490

您是否可以暂时使用更改会话命令或登录触发器（我自己没有尝试过）将要达到峰值的会话中的隔离级别设置为“读取未提交”？

我更喜欢做的（通常）是在代码中放置调试语句，这些语句永久保留在那里，但在生产中被关闭 - Tom Kyte 的 debug.f 包是一个有用的起点 - [http://asktom.oracle.com /tkyte/debugf](http://asktom.oracle.com/tkyte/debugf)

# html - HTML 解析 - 获取最里面的 HTML 标签

> ID：825057
> 
> 赞同：1
> 
> 时间：2009-05-05T14:13:36.407
> 
> 标签：html, parsing

当我解析 HTML 时，我希望只获取整个文档的最里面的标签。我的意图是从 HTML 文档中语义解析数据。

所以如果我有一些像这样的html

```
<html>
     <table>
           <tr><td>X</td></tr>
           <tr><td>Y</td></tr>
     </table>
</html> 
```

我想`<td>X</td>`和`<td>Y</td>`孤独。这可以使用 Beautiful Soup 或 lxml 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T14:18:37.673

在 .NET 中，我使用[HtmlAgilityPack](http://www.codeplex.com/htmlagilitypack)库轻松完成所有 html 解析。它加载 DOM，您可以按节点选择，在您的情况下选择没有子节点的节点。也许这有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T14:17:09.207

在确保文档格式正确之后（例如，通过使用 lxml 对其进行解析），您可以使用 XPath 来查询没有其他子元素的所有节点。

```
//*[计数(*) = 0]
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T14:45:43.927

如果您可以使用 DOM 处理（即在浏览器中），您可以使用*parentNode*属性处理所有标签并递归计算总数，并保留最大的一个。

在 javascript-pseudocode 中（在 FireFox 上测试）：

```
var allElements = document.getElementsByTagName("*");
var maxElementReference, maxParentNodeCount = 0;
var i;

for (i = 0; i < allElements.length; i++) {

    var count = recursiveCountParentNodeOn(allElements[i]);

    if (maxParentNodeCount < count) {
        maxElementReference = allElements[i];
        maxParentNodeCount = count;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T14:19:42.413

这是您实际上可以使用正则表达式来解析 HTML 字符串的少数情况之一。

```
\<(\w+)[^>]*>[^\<]*\</\1\s*> 
```

# http - 在labview中显示来自URL的jpeg

> ID：825059
> 
> 赞同：1
> 
> 时间：2009-05-05T14:14:26.373
> 
> 标签：http, labview

我需要制作一个labview VI，它将显示来自URL 的jpeg 图像。（url是根据一些数据生成的）

我找到了一种从硬盘驱动器显示图像的方法（读取 JPEG 文件），所以我可能需要的只是一种将其下载到临时文件的方法。

我发现的只是一些低级 TCP 客户端 VI。有没有更简单的方法？如果没有，我可以只打开一个浏览器窗口，但我宁愿不这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T14:31:29.237

看看[这篇 LAVA 帖子](http://tinyurl.com/dmw49v)，标题为*使用 Datasocket 从 Web 服务器下载图像*。唯一的缺点是它不是跨平台的，它只能在 Windows 上运行，在 Linux 上我已经看到这个代码杀死了 LabVIEW。

[OpenG Internet Connectivity 工具包](http://sourceforge.net/projects/ogic/)具有跨平台的代码。

吨

# iphone - 如何禁用出现在 UITabBarController 的更多部分中的编辑按钮？

> ID：825066
> 
> 赞同：25
> 
> 时间：2009-05-05T14:15:29.010
> 
> 标签：iphone, uitabbarcontroller

在我的应用程序（基于 Tab bar 应用程序 XCode 模板）中，我使用 UITabBarController 来显示用户可以访问的应用程序不同部分的列表。

默认情况下，当有超过 5 个项目时，UITabBarController 在标签栏中显示一个“更多”按钮。此外，它允许用户选择他希望在标签栏中可见的项目。

目前我无法实现保存和加载标签栏控制器的状态，所以我想禁用“编辑”按钮。

有什么方法可以禁用/隐藏出现在 UITabBarController 的“更多”导航控制器上的“编辑”栏按钮？

我试过：

```
tabBarController.moreNavigationController.navigationBar.topItem.rightBarButtonItem = nil; 
```

和

```
tabBarController.moreNavigationController.navigationBar.topItem.rightBarButtonItem.enabled = NO; 
```

但它们似乎不起作用。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-09-30T17:34:33.850

成为`moreNavigationController`（它是一个 UINavigationController）的代表并添加以下内容：

```
- (void)navigationController:(UINavigationController *)navigationController
        willShowViewController:(UIViewController *)viewController
        animated:(BOOL)animated {

    UINavigationBar *morenavbar = navigationController.navigationBar;
    UINavigationItem *morenavitem = morenavbar.topItem;
    /* We don't need Edit button in More screen. */
    morenavitem.rightBarButtonItem = nil;
} 
```

现在不会出现了。需要考虑的关键是 Edit 按钮不是在控制器创建之后出现，而是在显示视图之前出现，我们应该静坐直到那一刻，然后，当控制器要显示屏幕时，我们会敲掉按钮，这样它没有机会再次创建它。:)

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2009-07-29T02:27:30.117

`customizableViewControllers`是一个数组；将其设置为空数组以禁用所有编辑。

```
tabBarController.customizableViewControllers = [NSArray arrayWithObjects:nil]; 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-05T14:22:43.953

```
tabBarController .customizableViewControllers = nil; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-03-28T09:20:49.157

我试过了，这是一个例子。

在 AppDelegate.m

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {    

    // Override point for customization after application launch.

    // Add the tab bar controller's view to the window and display.
    [self.window addSubview:tabBarController.view];
    [self.window makeKeyAndVisible];

    //setting delegate to disable edit button in more.
    tabBarController.moreNavigationController.delegate = self;

    return YES;
} 
```

删除“编辑”按钮

```
 - (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated {
        UINavigationBar *morenavbar = navigationController.navigationBar;
        UINavigationItem *morenavitem = morenavbar.topItem;
        /* We don't need Edit button in More screen. */
morenavitem.rightBarButtonItem = nil;
} 
```

在您的 AppDelegate.h

```
@interface TestAppDelegate : NSObject <UIApplicationDelegate, UITabBarControllerDelegate, UINavigationControllerDelegate> 
```

如我错了请纠正我。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-10-03T23:31:34.843

我能够使用以下代码来完成这项工作。我在 Interface Builder 中创建了一个`CustomTabViewController`然后修改了我的选项卡栏控制器的类标识以使用这个自定义类。这是它使用的代码（.h 和 .m 文件内容）。关键是将属性设置为 nil，这会导致 Edit 按钮不显示。有关详细信息，请参阅：http: [//developer.apple.com/library/ios/documentation/uikit/reference/UITabBarController_Class/Reference/Reference.html#//apple_ref/occ/instp/UITabBarController/customizableViewControllers](http://developer.apple.com/library/ios/documentation/uikit/reference/UITabBarController_Class/Reference/Reference.html#//apple_ref/occ/instp/UITabBarController/customizableViewControllers) “如果数组为空或此属性的值为 nil，标签栏不允许重新排列任何项目。”

```
#import <UIKit/UIKit.h>

@interface CustomTabBarController : UITabBarController {

}
@end

#import "CustomTabBarController.h"

@implementation CustomTabBarController

- (void)viewDidLoad
{
    self.customizableViewControllers = nil;
    [super viewDidLoad];
}   

@end 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-08-12T06:25:12.553

@m4rkk 和 @lan terrell 代码不起作用。

我无法得到它，所以我完全禁用了导航栏。

```
tabBarController.moreNavigationController.navigationBar.hidden = YES; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-11-09T01:07:19.543

这可以像这样实现。它不是最优雅的解决方案，而是 It Works™。

```
// Optional UITabBarControllerDelegate method
- (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController {
    [self performSelector:@selector(removeEdit) withObject:nil afterDelay:.0001];
}
- (void)removeEdit
{
    tabBarController.moreNavigationController.navigationBar.topItem.rightBarButtonItem = nil;   
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-07-22T16:32:45.050

我不知道 iOS4，但如果你把代码放在`viewDidLoad`vs中很重要`viewWillAppear`。

即，这将起作用。

```
- (void)viewWillAppear:(BOOL)animated
{
self.customizableViewControllers = nil;
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-03-21T06:11:39.910

只需在生命周期方法中添加一行代码，即应用程序确实完成了启动：

```
- (void)applicationDidFinishLaunching:(UIApplication *)application
{ 
    tabBarController.customizableViewControllers=nil;

} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-03-21T07:02:12.653

如果您使用 NavigationController 作为您的第一个 ViewController 并按其中一个按钮进入 UITabBarController。然后除了添加下面的代码，

```
- (void)navigationController:(UINavigationController *)navigationController
        willShowViewController:(UIViewController *)viewController
        animated:(BOOL)animated 
{
    UINavigationBar *morenavbar = navigationController.navigationBar;
    UINavigationItem *morenavitem = morenavbar.topItem;
    /* We don't need Edit button in More screen. */
    morenavitem.rightBarButtonItem = nil;
} 
```

您需要添加此“if 语句”以避免在第一次单击第 5 个 ViewController 及以上时显示编辑按钮。

```
if (self.selectedIndex >= 4) 
{
    self.customizableViewControllers = nil;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-07-07T00:49:24.253

Aleks N 的答案有效，但我想稍微修改一下

```
- (void)navigationController:(UINavigationController *)navigationController
      willShowViewController:(UIViewController *)viewController
                    animated:(BOOL)animated
{
    if (navigationController.viewControllers.count == 1)
    {
        UINavigationBar *morenavbar = navigationController.navigationBar;
        UINavigationItem *morenavitem = morenavbar.topItem;
        /* We don't need Edit button in More screen. */
        morenavitem.rightBarButtonItem = nil;
    }
} 
```

因为每次在视图堆栈上推送或弹出视图控制器时都会调用此委托方法。当我们将其他视图推送到这个“更多”视图控制器上时，我们不想这样做。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-08-16T06:10:37.480

在使用大于 4.0 的 Xcode 的那些（我正在为 Snow Leopard 开发 Xcode 4.2）：

首先检查最后一次更改视图数组的位置。我认为您将可定制的View-Array 设置为nil 的方法并不重要。苹果描述说：

> 重要提示：在标签栏界面中添加或删除视图控制器也会将可自定义的视图控制器数组重置为默认值，从而允许再次自定义所有视图控制器。因此，如果您对 viewControllers 属性进行了修改（直接或通过调用 setViewControllers:animated: 方法）并且仍想限制可自定义的视图控制器，则还必须更新可自定义的ViewControllers 属性中的对象数组。

它对我有用，所以请尝试一下。我在这里找到了这个描述：[链接到 developer.apple.com](http://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewControllerCatalog/Chapters/TabBarControllers.html)上“防止标签的自定义”一章的描述。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-09-21T17:30:19.277

这是一个较晚的添加，但我认为这是一个有用的贡献。Aleks N 的回答可能会造成一种情况，即为“更多选项卡”下的每个视图控制器删除**rightBarButtonItem （正如鲍磊所说）。**我想推荐使用Bao Lei的代码，但不同的是实现它的**didShowViewController**委托方法。

由于他的代码现在存在，用户点击“更多”选项卡返回到基本**UIMoreViewController**表可能会导致**rightBarButtonItem**属于其他 viewControllers 设置为零。

```
- (void)navigationController:(UINavigationController *)navigationController
       didShowViewController:(UIViewController *)viewController
                    animated:(BOOL)animated
{
    if (navigationController.viewControllers.count == 1)
    {
        UINavigationBar *morenavbar = navigationController.navigationBar;
        UINavigationItem *morenavitem = morenavbar.topItem;
        /* We don't need Edit button in More screen. */
        morenavitem.rightBarButtonItem = nil;
    }
} 
```

区别很小，但我花了相当多的时间才找到这个错误。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2015-11-19T21:21:00.860

iPhone 6 Plus 在横向模式下允许标签栏上的按钮多于纵向模式。不幸的是，这意味着每当设备旋转时它都会重置可定制的ViewControllers 数组，并且这里的答案都没有对我有用。

我已经有了自己的 UITabBarController 子类，重写可定制视图控制器的 setter 和 getter 方法是从“更多”屏幕中删除“编辑”按钮的唯一可靠方法：

```
- (NSArray *)customizableViewControllers
{
    return nil;
}

- (void)setCustomizableViewControllers:(NSArray*)controllers
{
    //do nothing
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-10-20T18:02:04.857

唯一对我有用的解决方案

```
self.moreNavigationController.navigationBar.topItem?.rightBarButtonItem?.title = ""
self.moreNavigationController.navigationBar.topItem?.rightBarButtonItem?.isEnabled = false 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2018-10-01T04:03:19.997

我尝试了大多数这些解决方案，但遇到了旋转设备时编辑按钮会返回的问题。旋转将重置回第一个视图控制器，然后当我返回更多视图控制器时，编辑按钮就在那里。最好的解决方案是`UITabBarControllerDelegate`当更多的视图控制器成为选定的视图控制器时，将右栏按钮设置为 nil。这适用于 iOS 11-12。

```
final class DashboardController: UITabBarController {

    override func viewDidLoad() {
        super.viewDidLoad()

        delegate = self
    }
}

extension DashboardController: UITabBarControllerDelegate {
    func tabBarController(_ tabBarController: UITabBarController, didSelect viewController: UIViewController) {
        if viewController == moreNavigationController {
            moreNavigationController.navigationBar.topItem?.rightBarButtonItem = nil
        }
    }
} 
```

# c - Informix 到 Oracle：处理获取空值

> ID：825072
> 
> 赞同：2
> 
> 时间：2009-05-05T14:16:34.903
> 
> 标签：c, oracle, oracle10g, informix, oracle-pro-c

先说一点背景。我的公司正在评估是否将我们的 Informix 数据库迁移到 Oracle 10g。我们有几个 ESQL/C 程序。我已经通过 Oracle 迁移工作台运行了一些，并且一直在通过一些测试感到困惑。现在我开始意识到一些事情。

首先，我们有根本不处理空值的动态 sql 语句。根据我的阅读，我要么必须手动修改查询以利用 nvl() 函数，要么实现指标变量。有人可以确认是否需要手动修改？我们必须对转换后的 ESQL/C 程序进行的手动更改越少越好。

其次，我们有几个从各种表等中提取日期的查询，并且在 Informix 中，日期被视为 long 类型，即自 1899 年 12 月 31 日以来的天数。

在 Pro*C 中，日期被选择为什么格式？我知道这不是数字，因为我尝试在我的长变量中选择日期字段并得到 Oracle 错误，指出“预期为 NUMBER，但得到了一个日期”。所以我假设我们必须修改我们选择日期字段的方式 - 要么以转换的方式选择一个日期字段，使其变得很长（即，自 1899 年 12 月 31 日以来的天数），要么更改主机变量以匹配 Oracle 返回的内容（那是什么，字符串？）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T15:44:52.727

是的。您将需要按照您的描述修改您的查询。

长是绊倒你。long 在 Oracle 中有不同的含义。有一个特定的 DATE 类型。Generally when selecting one uses the TO_DATE function with a format, to get the result as a VARCHAR2, in exactly the format you want.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T17:41:48.920

可能它还没有击中您，但请注意，在 Oracle 中，空的 VARCHAR2 字段是 NULL。我看不出这背后的逻辑（可能是因为我来自 Informix 领域）——请记住这一点。我认为这很愚蠢-恕我直言，空字符串是有意义的，并且与 NULL 不同。

将所有 VARCHAR2 字段修改为`NOT NULL DEFAULT '-'`或任何其他任意值，或在所有返回 VARCHAR2 字段的查询中使用指示符，或始终使用`NVL()`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T19:36:42.700

为了将 oracle 日期（以 Oracle 内部格式存储）转换为长整数，您需要更改查询。使用以下公式计算您的日期：

```
to_number (to_char (date_column, 'J')) - to_number(to_char(to_date('12/31/1899', 'MM/DD/YYYY'), 'J')) 
```

Oracle 系统“J”（儒略日期）格式是自公元前 4712 年 12 月 31 日以来的天数。如果您想从较晚的日期开始计算，则需要减去该较晚日期的儒略日计数。

一个建议：不要更改程序中的所有查询（这可能会产生问题并引入错误），而是在不同的模式中创建一组视图。这些视图将与所有表命名相同，具有所有相同的列，但包括 NVL() 和 date() 公式（如上）。然后将您的应用程序指向视图模式而不是基表模式。更少的测试和更少的地方错过了一些东西。

例如，将所有表放入名为“APPS_BASE”的模式（由用户“APPS_BASE”定义。然后创建另一个名为“APPS_VIEWS”的模式/用户。在 APPS_VIEWS 创建一个视图：

```
CREATE OR REPLACE VIEW EMP AS
SELECT name, birth_date
FROM   APPS_BASE.EMP; 
```

# http - 从后面的代码访问跳转链接（井号字符 # 之后的 URL 部分）

> ID：825087
> 
> 赞同：2
> 
> 时间：2009-05-05T14:21:26.497
> 
> 标签：http, url, uri-fragment

任何人都知道是否可以在 c# 代码中访问跳转链接的名称？

我正在做一些 url 重写的东西，我想我可能看不到 URL 的那部分。

所以基本上，我的 URL 看起来有点像这样：

> [http://www.mysite.com/Terms.aspx#](http://www.mysite.com/Terms.aspx#) **Term1**

我想访问“ **Term1** ”。我在 ServerVariables 中看不到它...

有任何想法吗？！？！？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T14:39:51.727

哈希字符用于客户端导航。# 之后的任何内容都不会提交给服务器。

来自[维基百科文章](http://en.wikipedia.org/wiki/Fragment_identifier)：

> 片段标识符的功能与 URI 的其余部分不同：即，它的处理完全是客户端，没有服务器的参与。当代理（例如 Web 浏览器）向 Web 服务器请求资源时，代理将 URI 发送到服务器，但不发送片段。

它的技术名称是[Fragment Identifier](http://en.wikipedia.org/wiki/Fragment_identifier)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T14:27:14.190

也许[System.Uri.Fragment](http://msdn.microsoft.com/en-us/library/system.uri.fragment.aspx)？或者你没看到什么？

# sql - 如何克服“无法获取文本、ntext 和图像变量”。在 SQL Server 上？

> ID：825089
> 
> 赞同：0
> 
> 时间：2009-05-05T14:22:06.277
> 
> 标签：sql, sql-server, text, cursor

我收到此错误消息： *Msg 16927，Level 16，State 1，Procedure GetWfGenProcessParameters，Line 21 Cannot fetch into text、ntext 和 image 变量。*

我真的需要让这个光标与文本数据一起工作。有没有办法克服这个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T14:33:17.313

如果您正在使用`SQL Server 2005`，您可以使用`NVARCHAR(MAX)`：

```
CREATE TABLE text_test (test NTEXT NOT NULL)

INSERT
INTO    text_test
VALUES  ('test')

DECLARE @t NVARCHAR(MAX);

DECLARE txt_cur CURSOR FOR
        SELECT test
        FROM   text_test

OPEN    txt_cur

FETCH   NEXT
FROM    txt_cur
INTO    @t

CLOSE txt_cur

DEALLOCATE txt_cur
GO

DROP TABLE text_test
GO 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T14:24:46.863

首先，为什么要使用游标，要不惜一切代价避免使用游标。如果您使用基于集合的解决方案，您的问题可能会消失。但是，如果没有更多关于您要在光标中做什么的想法，很难提供建议。当然，我无法改变 SQL Server 不允许您将文本数据放入变量的事实。当您遇到系统限制时，您需要重新考虑您在做什么以及如何做。

# apache - 如何在 Apache 2.2 上设置虚拟主机

> ID：825095
> 
> 赞同：4
> 
> 时间：2009-05-05T14:22:51.627
> 
> 标签：apache, httpd.conf

谁能指导我学习如何使用 Apache 2.2 设置虚拟主机的好教程？这是我的情况：

我的笔记本电脑上运行着 Apache，我想要两个网站——一个在端口 80 上，一个在端口 8089 上。我想通过输入计算机的 IP 地址从网络上的另一台计算机访问每个站点，例如[http:// 192.168.1.102](http://192.168.1.102)和[http://192.168.1.102:8089](http://192.168.1.102:8089)。然而，当我输入第二个 url 时，它会将我定向到在端口 80 上运行的网站。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T18:41:19.943

首先，您需要指示 Apache 监听您需要的端口：

```
Listen 80
Listen 8089 
```

其次，您需要告诉它如何处理 80 和 8089 流量：

```
<VirtualHost *:80>
    DocumentRoot /website/site80
    ServerName internet.dev
</VirtualHost>

<VirtualHost *:8089>
    DocumentRoot /website/site8089
</VirtualHost> 
```

第三，您需要“允许”Apache 使用这些目录：

```
<Directory "C:/website/site80">
    Options Indexes FollowSymLinks Includes ExecCGI
    AllowOverride All
    Order allow,deny
    Allow from all
</Directory>

<Directory "C:/website/site8089">
    Options Indexes FollowSymLinks Includes ExecCGI
    AllowOverride All
    Order allow,deny
    Allow from all
</Directory> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T14:27:51.880

只需像这样定义 2 个虚拟主机，但 DocumentRoots 不同：

```
<VirtualHost *:80>
    ServerAdmin webmaster@dummy-host.somecompany.com
    DocumentRoot "/docs/dummy-host.somecompany.com"
    ServerName dummy-host.somecompany.com
    ServerAlias www.dummy-host.somecompany.com
    ErrorLog "logs/dummy-host.somecompany.com-error.log"
    CustomLog "logs/dummy-host.somecompany.com-access.log" common
</VirtualHost>

<VirtualHost *:8089>
    ServerAdmin webmaster@dummy-host.somecompany.com
    DocumentRoot "/docs/dummy-host.somecompany.com"
    ServerName dummy-host.somecompany.com
    ServerAlias www.dummy-host.somecompany.com
    ErrorLog "logs/dummy-host.somecompany.com-error.log"
    CustomLog "logs/dummy-host.somecompany.com-access.log" common
</VirtualHost> 
```

# c# - 带有水晶报表的 WPF 应用程序

> ID：825096
> 
> 赞同：1
> 
> 时间：2009-05-05T14:23:09.130
> 
> 标签：c#, wpf, crystal-reports

如何在数据库中插入图像并使用 C# WPF 应用程序在 Crystal Reports 中检索图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T14:40:07.203

您需要使用 Windows 窗体集成工具才能将 Crystal 与 WPF 一起使用。WPF 中没有针对 Crystal 的本机支持工具。使用 WFI 命名空间后，Crystal 控件的工作方式与它们在 WinForms 中的工作方式相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-25T21:50:30.373

Crystal Reports 现在支持 WPF 集成。
[http://scn.sap.com/docs/DOC-54328](http://scn.sap.com/docs/DOC-54328)

# wpf - 如何检测 WPF 中完成的数据绑定

> ID：825097
> 
> 赞同：14
> 
> 时间：2009-05-05T14:23:34.497
> 
> 标签：wpf, data-binding, treeview

当我在树视图上选择一个项目时，从我的视图模型类被实例化到视图刷新和树视图节点被高亮之间存在显着的时间间隔。

在此期间我需要显示一个等待光标 - 我尝试包装实例化我的视图模型类的代码，但是在整个数据绑定似乎完成并且节点变得高之前几秒钟，光标又回到了箭头点燃。是否有一些事件告诉我绑定何时完成，或者节点何时点亮？

这与扩展节点无关，只是选择顶级节点。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T15:29:08.987

所需的 TreeView 控件上的 Loaded 事件将在所有绑定设置后发生。我认为它发生在一切都被绘制之前，所以它可能不是你所需要的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-06-26T15:13:54.900

您可以在目标或源更新时收到通知。

```
<TreeViewItem>
    <TextBlock Name="NameText"
      Text="{Binding Path=Name, Mode=OneWay, NotifyOnTargetUpdated=True}"
      TargetUpdated="OnTargetUpdated"/>
</TreeViewItem> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-06T08:20:55.827

出现这种差距时是否存在“挂起”？也许您需要将繁重的逻辑放在单独的线程上，或者只是使用 Binding 类的 IsAsync 属性。您可能还想看看优先绑定。[这](http://www.switchonthecode.com/tutorials/wpf-tutorial-priority-bindings)是一篇关于如何使用它的非常好的文章。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T15:34:35.100

您可以覆盖 OnContentRendered for Window 控件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-05T05:38:56.350

在我的情况下，当我删除 (IsAsync=True) 属性时，ContentRendered 方法会立即捕获渲染结束。

检查控件的 IsAsync 属性。

# javascript - HTML元素的“默认操作”是否有标准资源？

> ID：825100
> 
> 赞同：5
> 
> 时间：2009-05-05T14:24:02.217
> 
> 标签：javascript, html, events, documentation, standards

我想知道是否有针对各种 HTML 元素的默认操作的定义标准。我查看了[W3C 的 HTML 规范](http://www.w3.org/TR/1999/REC-html401-19991224/cover.html)，虽然它们非常精确地说明了元素可以使用哪些属性（以及一些行为的东西，例如表单提交中包含的确切内容），但元素的行为却一无所获。我还检查了[Mozilla JS 参考](https://developer.mozilla.org/En/DOM)，也没有发现任何内容。

特别是我正在寻找表单提交按钮的默认行为；我在不同的地方看到它的默认操作是提交表单，或者它的默认操作不是提交表单而是获取焦点。`onclick="return false;"`因此，对于提交按钮是否会停止表单提交似乎没有共识。

（为清楚起见进行编辑 - 我没有尝试对提交`onclick`或类似的东西进行任何表单级别的验证；如果我是，我会使用表单来`onsubmit`代替。我真的特别有兴趣捕捉按钮上的点击和在这种情况下可能不会提交表单。这最终可能需要按钮`onclick`设置表单检查的某些状态`onsubmit`，但如果我能做到这`return false`一点，那就太好了。即使没有，那么`onsubmit`和`onclick`处理程序得到什么顺序也很关键触发（即按钮是否在运行其点击处理程序之前调度提交？）我还没有在任何地方看到指定。）

虽然只是编写一个测试代码，但我宁愿依赖规范/记录的行为，而不是一个琐碎的测试结果，如果它们存在的话，无疑会错过任何微妙之处。特别是，我上周进行了一项快速测试，似乎表明它*并没有*停止表单提交，但今天运行一个测试表明它*确实如此*。我没有找到任何权威资源来了解浏览器在您与其元素交互时*实际执行*的操作（例如，默认操作是什么，提交按钮的 onclick 处理程序是在表单提交调度之前还是之后触发等）。 )

在这种情况下，任何关于在哪里寻找的建议都将受到欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T23:13:25.770

相关文档是[DOM3 事件](http://www.w3.org/TR/DOM-Level-3-Events/events.html)和[HTML 5 规范](http://www.whatwg.org/specs/web-apps/current-work/multipage/)。

他们可能没有您需要的所有信息，但应该。因此，如果您发现缺少这些行为，请[要求指定这些行为](http://www.whatwg.org/mailing-list)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T14:40:23.270

您可能很难为此找到规范的一个原因是您正在查看多个行为。

设置`onclick="return false;"`将阻止提交按钮提交表单，但不会阻止提交表单。如果在表单中的某个字段具有焦点时按 Enter，则可以提交表单本身而不涉及提交按钮。（我不知道确切的细节，它们可能会因浏览器而异，但您会看到原理。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T12:15:53.523

对于该特定场景，您可能需要尝试不同的事件属性，因为浏览器的行为不同，onlick 用于按钮，onsubmit 是表单事件，所以很自然，如果您为 onclick 返回 false，这并不意味着on submit 不会生效，你应该单独处理onsubmit，或者委托提交到提交按钮（通过返回false onsubmit，并让onclick处理程序有form.submit），也可以尝试使用多个提交按钮来了解如何有用

我知道你可能已经知道这一点，但是我在处理表单时学到了一些其他技巧，尝试使用 event.cancelBubble = true 和 event.returnValue = false（特定于 IE，不确定 firefox），有时返回 false 不好足够...

至于文档，MSDN 库记录了所有事件的默认操作，这里是关于提交的文档：http: [//msdn.microsoft.com/en-us/library/ms535249 (VS.85).aspx#](http://msdn.microsoft.com/en-us/library/ms535249(VS.85).aspx#)

> 有趣的是：提交方法不会调用 onsubmit 事件处理程序。

太好了，否则它会陷入无限循环！

这是 onlcick 的文档 [http://msdn.microsoft.com/en-us/library/ms536913(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms536913(VS.85).aspx)

MSDN 库也记录了所有事件和对象，但要付出代价，所有 IE 都是特定的！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T05:51:13.360

是的，您可以设置一个按钮——带有一个侦听器，当单击该按钮时，您可以停止提交表单。表单的提交是表单中提交（重要）*类型的“****按钮***”的默认行为。

 *事件方法 preventDefault（或窗口事件的 returnValue=false，取决于浏览器遵循的事件模型）将阻止默认的提交行为。我也停止传播（MSIE evt.model = cancelBubble）。

例如，对于以下类型为“*提交*”的按钮：

```
<button type="submit" id="logout" name="logout" value="Log Out">Log Out</button> 
```

为该特定按钮添加一个 x-browser 事件侦听器。例如，假设 testlogout 是您的函数的名称，该函数控制单击按钮时发生的情况，则可能会使用以下内容来设置侦听器：

```
var logoutBtn = (document.getElementById && document.getElementById('logout')) || 
   (document.all && document.all['logout']) || document.forms[formname].elements['logout'] || null;
if (logoutBtn) {
   if (logoutBtn.addEventListener) {
       logoutBtn.addEventListener('click',testlogout,false);
   } else if (window.attachEvent) {
       logoutBtn.attachEvent('onclick',testlogout);
   } else {
       //legacy:
       logoutBtn.onclick = testlogout;
       //...logic for document.layers support, etc.
   }
} 
```

然后在将自动传递事件的 testlogout 函数中，您将测试任何条件。根据您设置的条件，使用 event.preventDefault 或 returnValue，再次取决于浏览器支持的情况。这些代替了内联的' ***return false*** '。例如：

```
function testlogout(e) 
{
    e = e || window.event;
    //... your logic here...
    e.stopPropagation?e. stopPropagation():(e.cancelBubble?e.cancelBubble():"");
    e.preventDefault?e.preventDefault():e.returnValue=false;
    return false; // in case all else fails?
} 
```

传递的事件当然有它自己的一组属性，它们的名称也因浏览器所遵循的模型而异。例如，这些属性将识别单击的目标按钮。

当前的事件监听模型*不*关注' *return false* '。可以说，' *return false* ' 命令将被置若罔闻。不过不用担心，只要你使用他们所理解的。

希望这有助于解决当前的潜在问题。阅读 DOM 事件和事件模型将阐明可用的方法和属性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T05:56:52.743

为什么要使用提交按钮？为什么不只使用一个按钮？`<input type="button" onclick="function(){if(allCriteriaIsMet()) this.form.submit()}" value="click me"/>`

还是我错过了什么？

# c# - 如何在c#中将字符串转换为代码

> ID：825107
> 
> 赞同：1
> 
> 时间：2009-05-05T14:26:03.070
> 
> 标签：c#, eval

我看到在 c++ 中有这样的问题我是一个非常初学者，我需要一个非常简单的例子来做到这一点。用户在文本框中编写代码，我需要做的是如何执行它？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T15:02:22.593

您可以使用 System.CodeDom 命名空间中的类将 C# 编译为内存中的程序集，并即时运行它们。 [这是一个迷你教程](http://www.codeproject.com/KB/codegen/Run-Time_Code_Generation1.aspx)。

或者，您可以使用[Reflection.Emit 动态](http://msdn.microsoft.com/en-us/library/3y322t50.aspx)构建代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T15:02:24.997

检查此[示例](http://www.codeproject.com/KB/cs/evalcscode.aspx)中使用的方法。

# linux - SCTP 是否像使用 Linux 宣传的那样工作？

> ID：825109
> 
> 赞同：4
> 
> 时间：2009-05-05T14:26:15.393
> 
> 标签：linux, networking, sctp

我打算将 SCTP 用于嵌入式 Linux 项目。任何人对 SCTP 的使用有一些评论，主要是一对多模式？它是否优于使用自制的基于 UDP 的等效解决方案？

我控制网络环境和所有涉及的设备，所以兼容性不是问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T09:47:57.473

我已经广泛使用了 lksctp，并且发现它很健壮并且可以与许多其他 sctp 实现互操作。SCTP 的套接字 API 标准仍在发展，但已经相当成熟，我希望任何进一步的更改都可以向后兼容。

我会充满信心地使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T16:22:20.310

[ACE](http://www.cs.wustl.edu/~schmidt/ACE.html)库对 SCTP 进行了性能[测试](https://svn.dre.vanderbilt.edu/viewvc/Middleware/trunk/ACE/performance-tests/SCTP/README?revision=80826&view=markup)，所以我认为它可以工作。

> 目前，这些程序提供了有关如何将 ACE 的 wrapper-facades 用于 SCTP 的唯一示例代码。将来，附加代码将放在 ACE_wrappers/examples/IPC_SAP/SOCK_SAP 目录中。

无论如何，使用像 ACE 这样的框架是一个好主意，因为它可以让您在更高级别上进行编程，并保护您免受套接字编程中容易出错的低级细节的影响。作为额外的奖励，您的代码将可移植到[ACE 支持的所有平台](http://www.cs.wustl.edu/~schmidt/ACE-versions-i.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T19:28:10.690

最佳答案是评论：

此外，Glibc 中的 SCTP 支持不太理想（换句话说，不存在）——您必须使用来自 lksctp 的库，并且它没有完全集成到普通的套接字 API 中。使用一个封装低级功能的好库的另一个理由:) – ehemient

# javascript - 如何使用 jQuery 删除所有点击事件处理程序？

> ID：825112
> 
> 赞同：129
> 
> 时间：2009-05-05T14:26:43.427
> 
> 标签：javascript, jquery, click

我有问题。基本上，当用户单击页面上的“编辑”链接时，会运行以下 Jquery 代码：

```
$("#saveBtn").click(function () {
    saveQuestion(id);
}); 
```

通过这样做，保存按钮的 onClick 事件调用该`saveQuestion()`方法并传递单击“编辑”链接的问题的 ID。

但是，如果在同一个会话中，用户在 2 个问题上单击编辑，那么它不会覆盖先前的`click`事件处理程序，而是会导致 2 个事件处理程序运行，一个可能会调用 `saveQuestion(1)`，另一个可能会调用`saveQuestion(2)`. 通过这样做，一个问题会覆盖另一个问题。

有没有办法删除所有以前`click`分配给按钮的事件？

* * *

## 回答 #1

> 赞同：218
> 
> 时间：2009-05-05T14:42:27.383

您将使用[off()](http://api.jquery.com/off/)来删除这样的事件：

```
$("#saveBtn").off("click"); 
```

但这将删除绑定到该元素的*所有点击事件。*如果带有 SaveQuestion 的函数是唯一绑定的事件，那么上面将执行此操作。如果没有，请执行以下操作：

```
$("#saveBtn").off("click").click(function() { saveQuestion(id); }); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-05T14:30:24.463

> 有没有办法删除之前分配给按钮的所有点击事件？

```
$('#saveBtn').unbind('click').click(function(){saveQuestion(id)}); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-26T21:01:30.403

```
$('#saveBtn').off('click').click(function(){saveQuestion(id)}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T14:43:30.283

如果你用...

```
$(function(){
    function myFunc() {
        // ... do something ...
    };
    $('#saveBtn').click(myFunc);
}); 
```

...那么以后解绑会更容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-21T18:23:12.743

```
$('#saveBtn').off('click').on('click',function(){
   saveQuestion(id)
}); 
```

[使用](http://api.jquery.com/on/)jquery的[开关](http://api.jquery.com/off/)

# asp.net - ASP.NET 中与 MembershipProvider 结合的企业安全应用程序块

> ID：825113
> 
> 赞同：3
> 
> 时间：2009-05-05T14:26:50.947
> 
> 标签：asp.net, architecture, enterprise-library, application-blocks

希望为 ASP.NET 应用程序实现身份验证/授权

正在研究使用 Provider 模型 MembershipProvider SQLServerMembershipProvider 等对我来说很有意义。

但是，我也在研究企业安全应用程序块。我的问题是两者可以/应该串联使用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-08-23T13:41:34.853

是的，这两个组件可以很好地配合使用。事实上，一个是建立在另一个之上的。

更重要的问题是，您的特定场景是否都需要*两者？*查看[MembershipProvider 功能为您提供的开箱即用的功能](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)。EntLib 安全块添加到您的应用程序所需的内容是什么？

# conflict - 达尔克冲突

> ID：825115
> 
> 赞同：2
> 
> 时间：2009-05-05T14:27:16.967
> 
> 标签：conflict, darcs

几天前我安装了 Darcs 并有疑问。我是唯一的程序员，我通常在应用程序的两个或三个实例上工作，开发新功能。问题来了，因为这个实例修改了相同的源代码文件，所以当我完成它们并将它们发送到主存储库时，它们会产生冲突。有什么办法可以解决这个问题吗？推送到主存储库时，我可以在多个实例中编写相同的文件而不会产生冲突吗？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T11:53:14.647

首先，当文件的不同位置发生更改时，合并时通常不会发生冲突。当两个补丁可以在没有冲突的情况下合并时，一个说它们是通勤的。在您的情况下，您在两个不同的分支中修改了文件的同一部分。在这种情况下，darcs 不允许您“推动”产生冲突的第二个补丁。

有两种方法可以解决这种冲突，但您必须开始在本地合并这两个补丁才能在您的工作存储库中解决冲突。为此，只需从主存储库中提取补丁。然后你必须编辑有问题的文件并解决冲突。

第一种方法很简单，也是首选的解决方案，您必须“修改记录”尚未在主存储库中的补丁（查看“darcs amend-record”命令的用法）。

另一种解决方案是记录分辨率补丁，方法是调用“darcs record”，然后同时推送冲突补丁和分辨率补丁。这种解决方案往往会使历史复杂化，并且会使一些后期操作变得更长。但是，当分支已被大量分布时，就需要此解决方案。

# jquery - 在回调函数中访问 $(this)

> ID：825117
> 
> 赞同：1
> 
> 时间：2009-05-05T14:27:31.240
> 
> 标签：jquery

我正在将 prompt() 更改为 jPrompt()，因为 IE 会阻止 prompt() 运行。问题是 $(this) 不再正常工作，因为 jPrompt() 不返回值，而是使用回调函数。

所以可以说我有这样的东西，它有效：

```
$("a.foo").click(function(){
    $(this).text(prompt("Type Something",""));
} 
```

当我将其转换为它时，它会中断：

```
$("a.foo").click(function(){
    jPrompt("Type something:","","", function(r) {
        $(this).text(r);
    }
} 
```

如何正确访问 $(this)？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T14:30:18.427

试试这个：

```
$("a.foo").click(function(){
    var that = this;
    jPrompt("Type something:","","", function(r) {
        $(that).text(r);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T14:30:51.297

您可以使用闭包：

```
$("a.foo").click(
  function(){
    var self = this;
    return function() {
      jPrompt("Type something:", "", "", function(r) { 
        $(self).text(r); 
      });
    }
  }()
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T14:31:39.720

问题是您试图将“r”作为元素访问。jPrompt 将传递作为“r”输入的文本。

```
$("a.foo").click(function(){
    jPrompt("Type something:","","", function(r){
        alert(r); //This will show the text entered.
    });
}); 
```

# oracle - Oracle 日期格式“2009-02-13T11:46:40+00:00”

> ID：825121
> 
> 赞同：4
> 
> 时间：2009-05-05T14:29:18.430
> 
> 标签：oracle, date, formatting

我以前得到过一些出色的帮助，我希望你能让我再次摆脱困境。

我有一个来自网络服务的日期，格式如下：2009-02-13T11:46:40+00:00

对我来说，这看起来像标准的 UTC 格式。

我需要将它插入到 Oracle 数据库中，所以我在插入时使用了 to_date()。问题是，我无法为其获取匹配的格式字符串并不断收到“ORA-01861：文字与格式字符串不匹配”错误。

我知道这是一个相当微不足道的问题，但由于某种原因，我无法让它接受正确的格式字符串。任何帮助表示赞赏。

谢谢 ：）

加雷斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T14:44:53.773

您可以直接将其转换为 TIMESTAMP_WITH_TIME_ZONE 数据类型。

```
select
  to_timestamp_tz('2009-02-13T11:46:40+00:00','YYYY-MM-DD"T"HH24:MI:SSTZH:TZM')
from
 dual

TO_TIMESTAMP_TZ('2009-02-13T11:46:40+00:00','YYYY-MM-DD"T"HH24:MI:SSTZH:TZM
---------------------------------------------------------------------------
13-FEB-09 11.46.40.000000000 AM +00:00 
```

（我假设输入字符串使用 24 小时制，因为没有 AM/PM 指示符。）

如果要将其转换为简单的 DATE，则可以，但会丢失时区信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-05T14:43:50.890

```
SELECT  CAST(TO_TIMESTAMP_TZ(REPLACE('2009-02-13T11:46:40+00:00', 'T', ''), 'YYYY-MM-DD HH:MI:SS TZH:TZM') AS DATE)
FROM    dual 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T08:30:21.420

要以指定格式导入日期，您可以设置`nls_date_format`.

例子：

```
alter session set nls_date_format='YYYY-MM-DD HH24:MI:SS' 
```

这样，您的 SQL 语句可以更短（无强制转换）。对于各种掩码，请查看[日期时间格式模型](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements004.htm#i34924)

# colors - 二分图（无向）

> ID：825124
> 
> 赞同：0
> 
> 时间：2009-05-05T14:29:35.620
> 
> 标签：colors, graph

我正在接受输入，例如 4 1 3 1 2 2 4

第一行是节点数，之后的行是边。我必须尝试为图表着色，如果不能，我需要在图表中列出导致错误的循环。

到目前为止这很好，除了其中一张图包含 1,000,000 个节点。每次我尝试使用它时，都会出现 Stack Overflow 错误，即使我对其进行了更多简化，并将 eclipse 的最大堆大小提高到 1024m。

我不是要代码，只是问我是否在做一些公然错误的事情以不断出错。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T08:02:42.107

如果它是一个二分图，您总是可以只用两种颜色对其进行着色（例如，将第一个分区着色为白色，将第二个分区着色为黑色）。

通常当一个人考虑为图表着色时，他应该指定颜色的数量。您始终可以通过为每个节点分配不同的颜色来为图形着色。另一个例子：对于平面图，只需要四种颜色。然而，对于大多数图来说，图的 [色数] 是 [NP]。

[NP] [http://en.wikipedia.org/wiki/Karp%27s_21_NP-complete_problems](http://en.wikipedia.org/wiki/Karp%27s_21_NP-complete_problems)

【色数】[http://en.wikipedia.org/wiki/Graph_coloring](http://en.wikipedia.org/wiki/Graph_coloring)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T14:42:43.047

也许你可以优化你的周期检测算法。这可能对您有所帮助：[http ://en.wikipedia.org/wiki/Cycle_detection](http://en.wikipedia.org/wiki/Cycle_detection)

除此之外，一百万个节点加上邻接矩阵可能一次处理太多了，所以也许有一种方法可以一次只加载图的一部分。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-05T14:33:54.953

嗯，这*是*一个 NP 完全问题（最长周期），所以这种事情很可能会发生。

我可能会再次碰撞堆，然后让它运行......

编辑：没关系。让我的减少倒退。

# reporting - BIRT：PDF - 生成时间

> ID：825125
> 
> 赞同：1
> 
> 时间：2009-05-05T14:30:12.700
> 
> 标签：reporting, report, birt

我有一份报告，其中预览的 html 生成大约需要 39 秒。当我尝试预览 pdf 格式的报告时，它没有在 4 分钟内完成。这正常吗？我的其他报告最多有大约 50% 的时间差异。如果它不正常，我怎样才能加快 pdf 中的报告生成速度？

谢谢！（BIRT 2.1.3，RCP 设计器）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-13T21:39:18.247

I would say 6x increase in generation time for PDF over HTML is not to be expected.

Most of my reports take no more than twice as long to export to PDF than they do to HTML. XLS export is in between HTML and PDF.

I was able to gain some optimisation on execution time by splitting up some data sets, and combining others. Some experimentation may provide you with some good results.

However a key thing to note was that my optimisation was spread across all export types, not just limited to PDF.

That isn't really much help, but it gives you something to try.

# sql - 更改 sql 中的表格单元格但如何更改？

> ID：825127
> 
> 赞同：0
> 
> 时间：2009-05-05T14:30:21.313
> 
> 标签：sql, sql-server, sql-server-2005

我需要 Sql 查询将 Table1 转换为 Table2

```
select Count(Page) as VisitingCount,CONVERT(VARCHAR(5),Date, 108) as [Time] from scr_SecuristLog     
where Date between '2009-04-30' and '2009-05-02'    
and [user] in(select USERNAME               
    from scr_CustomerAuthorities where customerID=Convert(varchar,4) and ID=Convert(varchar,43) )    
group by CONVERT(VARCHAR(5),Date, 108) order by CONVERT(VARCHAR(5),Date, 108) asc 
```

* * *

表格1

访问计数日期
1-------------------15:09
3-------15:10
7- ------------------15:15
1-----------------15:39
2----- --------------15:40
3-----------15:47

* * *

我如何更改下表中的此表

* * *

表2

来访日期
11--------------------------------15:00-15:30
6--------------------------------15 :30-16:00

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T14:34:57.307

使用 case 语句创建一个类别，然后按该类别计数。

对于（过于简单的）示例。

```
select case when Date < '15:30' then '15:00 - 15:30'
            when Date < '16:00' then '15:30 - 16:00'
            else 'After 16:00' end as category
into #temp1
from Table1

select count(*) as VistingCount, category as Date
from #temp1
group by category 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:59:54.483

请参阅我在另一个线程中的帖子 - [If 语句 SQL](https://stackoverflow.com/questions/824225/if-statement-sql/825013#825013)

您可以使用一个表来定义您希望对每个计数进行存储的界限。例如，您将有一个绑定定义，例如 ('15:01', '15:30', '15:00 - 15:30')。然后，您只需将您的数据表与此边界表连接起来，并将时间桶包含在您的 GROUP BY 中（如另一个线程中所示）。

# asp.net - 我可以从 IPAddress 确定 ZoneInfo 吗？

> ID：825130
> 
> 赞同：2
> 
> 时间：2009-05-05T14:30:35.680
> 
> 标签：asp.net, ip-address, zoneinfo

无论如何我可以计算出估计的[（奥尔森）ZoneInfo值](http://en.wikipedia.org/wiki/Zoneinfo)（例如（“美国/洛杉矶”，“欧洲/伦敦”等），用于.NET中的单个公共IP地址......？

我已经有了 ZoneInfo 值的完整列表，所以这不是问题......并且在下拉框中。我只想根据 IP 默认选择一个值。

我知道 IP 不会 100% 准确，并且代理可能会破坏事情......但这是为了获得一个粗略的价值。

这可能吗？

我在想有可能将 ZoneInfo 值关联到 GMT 时区 .. 也许？

是的.. .NET 请。

干杯！

（感谢 OpenID 使用 ZoneInfo 而不是 GMT 时区：（）

### 更新

我发现[这个页面](http://en.wikipedia.org/wiki/List_of_zoneinfo_time_zones)描述了区域和纬度/经度之间的关系。因此是否有可能（例如，有人想建议一些代码示例？）如何使用 Lat Long 确定正确的 ZoneInfo？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T14:49:30.440

那就是所谓的地理定位，它们是周围的几种产品。大多数情况下，这是一项付费服务​​。

你可以试试[这个](http://www.mantistechs.com/blog/2009/04/13/geolocalizacion-por-ip-mediante-javascript-y-json.html)……它是免费的。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T14:52:45.457

我创建了自己的服务，以通过 IP 为我提供 ISP 和国家/地区

你可以[在这里试试](http://www.balexandre.com/iplookup.aspx)

我可以分享代码，如果这是你想要的。

* * *

**新答案**

为什么要从 IP 地址获取 TimeZone？为什么需要 IP 地址？您可以轻松地从客户端获取 OffSet 时间。

我刚刚[实现了代码](http://balexandre.com/GetTimeZone.aspx)，它输出了正确的 GMT 时区。

# c# - 如何匹配多个字符的单词？

> ID：825139
> 
> 赞同：3
> 
> 时间：2009-05-05T14:33:10.370
> 
> 标签：c#, regex

我想使用正则表达式来匹配具有多个字符的所有单词，而不是完全由相同字符组成的单词。

这不应该匹配：ttttt、rrrrr、gggggggggggggg

这应该匹配：rttttttt、word、wwwwwwwwwu

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T15:53:41.940

下面的表达式可以解决问题。

```
^(?<FIRST>[a-zA-Z])[a-zA-Z]*?(?!\k<FIRST>)[a-zA-Z]+$ 
```

*   将第一个字符捕获到组中`FIRST`
*   捕获更多字符（懒惰以避免回溯）
*   确保下一个字符与`FIRST`使用否定前瞻断言不同
*   捕获所有（至少一个由于断言）剩余字符

请注意，查找与第一个字符不同的字符就足够了，因为如果没有字符与第一个字符不同，则所有字符都是相等的。

您可以将表达式缩短为以下内容。

```
^(\w)\w*?(?!\1)\w+$ 
```

这将匹配除 [a-zA-Z] 之外的更多字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T14:53:52.020

我会将所有唯一单词添加到列表中，然后使用此正则表达式

> \b(\w)\1+\b

抓住所有一个字符的单词并摆脱它们

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T14:58:07.410

这不使用正则表达式，但我相信它会满足您的要求：

```
public bool Match(string str)
{
    return string.IsNullOrEmpty(str)
               || str.ToCharArray()
                     .Skip(1)
                     .Any( c => !c.Equals(str[0]) );
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T14:46:48.543

以下 RE 将与您要求的相反：匹配单词由相同字符组成的位置。不过，它可能仍然对您有用。

```
\b(\w)\1*\b 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T15:52:40.647

```
\b\w*?(\w)\1*(?:(?!\1)\w)\w*\b 
```

或者

```
\b(\w)(?!\1*\b)\w*\b 
```

这假设您从一些较大的文本中提取单词；这就是为什么它需要单词边界和填充。如果您有一个单词列表，并且您只是想验证符合条件的单词，那么一个更简单的正则表达式可能会：

```
(.)(?:(?!\1).) 
```

...因为您已经知道每个单词只包含单词字符。另一方面，根据您对“单词”的定义，您可能需要将`\w`前两个正则表达式替换为更具体的内容，例如`[A-Za-z]`.

# java - 是否有任何库可以将 SQL 查询表示为 Java 代码中的对象？

> ID：825141
> 
> 赞同：15
> 
> 时间：2009-05-05T14:33:29.230
> 
> 标签：java, sql, api, fluent

我想知道是否有任何库可用于将 SQL 查询表示为 Java 中的对象。

在代码中，我有大量 java.lang.String 类型的静态变量，它们是手写 SQL 查询。我会寻找具有良好*流畅*API 的库，它允许我将查询表示为对象而不是字符串。

例子：

```
Query q = select("DATE", "QUOTE")
  .from("STOCKMARKET")
  .where(eq("CORP", "?"))
  .orderBy("DATE", DESC); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-01-11T20:36:27.247

[Querydsl](http://www.querydsl.com)支持查询 SQL、JPA 和 JDO 后端。

上面的例子变成：

```
query.from(stockmarket).where(stockmarket.corp.eq(someVar))
    .orderBy(stockmarket.date.desc())
    .list(stockmarket.date, stockmarket.quote); 
```

Querydsl 通过 APT 使用代码生成将 SQL 模式镜像到 Java 查询类型。这样查询是完全类型安全的（或与 SQL 的“模式兼容”）。

我是Querydsl的维护者，所以这个答案是有偏见的。

[我在这里](http://source.mysema.com/display/querydsl/Similar+frameworks)发布了 Querydsl 与其他框架的比较。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-07-03T20:27:04.483

这些是一些很好的专有库，可以动态创建类型安全的 SQL 查询

*   jOOQ：[http](http://www.jooq.org) ://www.jooq.org （我是其中的开发者）
*   [查询DSL： http](http://www.querydsl.com) ://www.querydsl.com
*   [雅曲： http](http://www.h2database.com/html/jaqu.html) ://www.h2database.com/html/jaqu.html
*   iciql：[http](http://iciql.com/) ://iciql.com/ （JaQu 的友好分支）
*   [夸尔： http](http://quaere.codehaus.org) ://quaere.codehaus.org
*   Jequel： http: [//www.jequel.de](http://www.jequel.de)（我认为处于维护模式）
*   Squiggle：[http](http://code.google.com/p/squiggle-sql) ://code.google.com/p/squiggle-sql （我认为处于维护模式）

除了以上，总有

*   休眠/JPA 标准查询
*   MyBatis

您在 jOOQ 中的示例：

```
create.select(DATE, QUOTE)
      .from(STOCKMARKET)
      .where(CORP.equal(123))
      .orderBy(DATE.desc()); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-05T14:50:24.260

[http://www.hibernate.org/](http://hibernate.org) 可能是 Java 最强大的 ORM 库。它可以做的不仅仅是简单的查询映射。因此，您可以轻松地在应用程序的其他地方实现它。对于你的情况，它可以以某种方式完成：

```
public class LookupCodeName
{
    private String code;
    private String name;

 /*... getter-setters ... */
}

public class someBL {

public List<LookupCodeName> returnSomeEntity() {
      SQLQuery sqlQuery =  (SQLQuery)((HibernateSession)em).getHibernateSession()
                        .createSQLQuery( "SELECT st.name as name, st.code as code FROM someTable st")
                        .addScalar("code")
                        .addScalar("name")
.setResultTransformer(Transformers.aliasToBean(LookupCodeName.class));
    }
return (List<LookupCodeName>)sqlQuery.list();
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-15T04:00:09.047

Jequel 看起来很漂亮： http: [//www.jequel.de/](http://www.jequel.de/)

它使用流畅的界面，因此易于阅读，几乎就像自然 SQL（来自文档）：

```
SqlString sql = select(ARTICLE.OID)
               .from(ARTICLE, ARTICLE_COLOR)
               .where(ARTICLE.OID.eq(ARTICLE_COLOR.ARTICLE_OID)
               .and(ARTICLE.ARTICLE_NO.is_not(NULL))); 
```

它还支持对带有参数的 DataSource 执行查询，因此它也可以处理参数化查询的创建。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-05T14:34:57.213

**Apache Empire-db**是一个关系数据库抽象层和数据持久性组件，与传统的对象关系映射框架 (ORM) 相比，它允许开发人员在应用程序开发中采用更加以 SQL 为中心的方法。

更多信息： [https ://empire-db.apache.org/](https://empire-db.apache.org/)

**夸尔**

[http://xircles.codehaus.org/projects/quaere](http://xircles.codehaus.org/projects/quaere)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-06T07:18:41.810

如果您不想映射字符串查询，那么您必须将您的类注释为实体并将其与表绑定，然后您可以使用休眠或 java 持久性。示例将太复杂。但是，最后你的查询会变成这样：

查找实体列表：

```
 Criteria c = createCreteria(entityManager, StockMarket.class);
    // you can add "where" clause by using c.add(Restrictions); 
   // like this: c.add(Restrictions.ilike("name", "%somename%"); where "name" is your entity's field
     List<StockMarket> smList = c.list(); 
```

通过 id 查找对象：

```
 StockMarket sm  = entityManager.find(StockMarket.class, id); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-21T02:36:48.293

您可以使用 naskarlab/fluent-query：

[https://github.com/naskarlab/fluent-query](https://github.com/naskarlab/fluent-query)

例子：

```
@Test
public void testSelect() {
    String expected = "select e0.* from Customer e0";

    String actual = new QueryBuilder()
        .from(Customer.class)
        .to(new NativeSQL())
        .sql()
        ;

    Assert.assertEquals(expected, actual);
} 
```

您可以在项目的单元测试中看到更多示例：

[https://github.com/naskarlab/fluent-query/blob/master/src/test/java/com/naskar/fluentquery/TestNativeSimpleConventionQueryTest.java](https://github.com/naskarlab/fluent-query/blob/master/src/test/java/com/naskar/fluentquery/TestNativeSimpleConventionQueryTest.java)

# java - 在 Java-webapp (war) 中，如何将 HTTP-auth 用于静态内容？

> ID：825142
> 
> 赞同：2
> 
> 时间：2009-05-05T14:33:31.990
> 
> 标签：java, web-applications, war, web.xml

我有一个 Java-webapp。webapp 被打包为一个战争文件。这些战争文件允许通过 HTTP 直接传递的静态内容。对于这场战争中的 servlet，我可以进行 HTTP 身份验证（用 servlet 本身实现）。但我也想要静态内容的 HTTP-auth。我怎么能意识到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T16:04:30.073

将您的静态 html 文件放在一个目录中，并在您的 web.xml 中定义您的安全约束。将约束映射到适当的角色。

```
<security-constraint>
        <display-name>securedResources</display-name>
        <web-resource-collection>
            <web-resource-name>securedRes</web-resource-name>
            <url-pattern>/secured/*</url-pattern>
            <http-method>GET</http-method>
            <http-method>PUT</http-method>
            <http-method>HEAD</http-method>
            <http-method>TRACE</http-method>
            <http-method>POST</http-method>
            <http-method>DELETE</http-method>
            <http-method>OPTIONS</http-method>
        </web-resource-collection>
        <auth-constraint>
            <description>
            authenticatedUser_securedRes</description>
            <role-name>authenticatedUsed</role-name>
        </auth-constraint>
    </security-constraint> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T15:18:40.120

Create a class that implements javax.servlet.Filter. See [The Essentials of Filters](http://java.sun.com/products/servlet/Filters.html)

The main method is doFilter that is passed the ServletRequest, ServletResponse and FilterChain objects. That's where you enforce authentication.

Then declare your filter in web.xml and a filter mapping as following (maps to every request)

```
 <filter>
            <filter-name>Authentication Filter</filter-name>
            <filter-class>
                    com.nfsdsystems.security.filters.AuthenticationFilter</filter-class>
    </filter>
    <filter-mapping>
            <filter-name>Authentication Filter</filter-name>
            <url-pattern>/*</url-pattern>
    </filter-mapping> 
```

# winapi - 如何以编程方式清除 MSIE/WinInet 缓存？

> ID：825144
> 
> 赞同：3
> 
> 时间：2009-05-05T14:33:55.050
> 
> 标签：winapi, caching, wininet

我正在尝试使用 Win32 API 清除 WinInet 缓存 - 通过使缓存条目无效或删除它们（没关系）。我找不到对整个缓存执行此操作的任何方法（除了迭代每个条目 - [C# 中的示例](http://www.dotnetspider.com/forum/46049-How-delete-my-temporary-internet-files.aspx)，[VB 中的另一个](http://www.vbforums.com/archive/index.php/t-440508.html)示例） - 这甚至可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T14:39:53.037

显然，可以（ab）使用 Internet 选项面板通过执行以下操作来清除缓存文件：

```
RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 8 
```

将尝试将其称为 DLL。

来源：[http](http://www.vbforums.com/archive/index.php/t-440508.html) : //www.vbforums.com/archive/index.php/t-440508.html，technorobbo 评论

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T14:44:05.477

我相当肯定执行 FindFirst/FindNextUrlCacheEntry() 然后 DeleteUrlCacheEntry() 是确保它适用于所有版本的 IE 的唯一方法。

或者，您可以将 FindFirst/ [FindNextUrlCacheGroup()](http://msdn.microsoft.com/en-us/library/aa384126(VS.85).aspx)和[DeleteUrlCacheGroup()](http://msdn.microsoft.com/en-us/library/aa383990(VS.85).aspx)与“CACHEGROUP_FLAG_FLUSHURL_ONDELETE”一起使用，但您必须确保只删除您想要的内容。例如，历史记录、cookie 和临时 Internet 文件都是缓存组。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-07-11T16:10:15.287

不要使用以下方法： RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 8 Microsoft 不支持此方法，已显示会破坏缓存并导致各种异常问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-16T09:17:56.813

FTR：参数的确切含义（上面的 8，仅表示 Internet 临时文件，而不是 Cookie 等）在[http://www.howtogeek.com/howto/windows/clear-ie7-browsing-history-from上进行了解释-命令行](http://www.howtogeek.com/howto/windows/clear-ie7-browsing-history-from-the-command-line)。

顺便说一句：不幸的是，RunDll32 是异步的，这使得它不适合在自动化 Web 测试之前运行。是否有人知道如何将其作为阻塞调用运行，或者如何以编程方式找到“临时 Internet 文件”目录的确切目录名称，以便可以对其进行轮询直到为空？用 C 编码（需要用 Java，可以用 JNI）真的是唯一的选择，对吧？;(

PS：如何发布对现有答案的回复，而不是在 stackoverflow 上开始新的答案？

# xml - XML：属性还是子项？

> ID：825147
> 
> 赞同：2
> 
> 时间：2009-05-05T14:34:53.050
> 
> 标签：xml, xsd, xml-attribute

在 XSD、SOAP 和其他 XML 约定中，您经常会看到如下内容：

```
<book>
 <title>Harry Potter</title>
 <author>J.K. Rowling</author>
</book> 
```

现在我想知道，属性发生了什么？对我来说，把它写成这样更有意义：

```
<book title="Harry Potter" author="J.K. Rowling" /> 
```

但显然，出于某种原因，比我更聪明的人选择了其他方式。有人可以解释为什么，然后是什么属性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T14:39:06.720

有些人认为差异是个人喜好问题。您可以遵循一些指导方针。

[W3Schools - XML 元素与。属性](http://www.w3schools.com/DTD/dtd_el_vs_attr.asp)

[IBM - XML 设计原则](http://www.ibm.com/developerworks/xml/library/x-eleatt.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T14:41:15.390

没有硬性规定。我倾向于将属性用于有关元素中包含的数据的*元*数据。例如

```
<book author="JK Rowling" published="September 2001">Harry Potter</book> 
```

尽管使用/特殊要求将比其他任何东西更能确定这一点。

另一个问题是后续处理。如果您使用的是 SAX 处理器，那么这种格式将导致一个方法回调，其中填充了属性结构。将数据放在多个元素中会导致相应的方法调用次数（这可能是优化过头了，但根据数据量可能值得考虑）

# date - 在erlang中将时间戳转换为日期时间

> ID：825151
> 
> 赞同：25
> 
> 时间：2009-05-05T14:35:11.300
> 
> 标签：date, time, erlang

如何在 Erlang 中将时间戳（自 1970 年 1 月 1 日以来的毫秒数...，又称纪元）转换为 Date 或 DateTime 格式？类似的东西`{Year,Month,Day}`。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-05T15:28:16.760

大致：

```
msToDate(Milliseconds) ->
   BaseDate      = calendar:datetime_to_gregorian_seconds({{1970,1,1},{0,0,0}}),
   Seconds       = BaseDate + (Milliseconds div 1000),
   { Date,_Time} = calendar:gregorian_seconds_to_datetime(Seconds),
   Date. 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-08T03:20:54.080

碰巧我有一个 github gist 和一堆 datetime 实用程序正是为了这个目的： http: [//gist.github.com/104903](http://gist.github.com/104903)。日历有大部分用于这些东西的低级管道。

```
-module(date_util).
-compile(export_all).

epoch() ->
    now_to_seconds(now())
.   

epoch_hires() ->
    now_to_seconds_hires(now())
.   

now_to_seconds({Mega, Sec, _}) ->
    (Mega * 1000000) + Sec
.   

now_to_milliseconds({Mega, Sec, Micro}) ->
    now_to_seconds({Mega, Sec, Micro}) * 1000
.   

now_to_seconds_hires({Mega, Sec, Micro}) ->
    now_to_seconds({Mega, Sec, Micro}) + (Micro / 1000000)
.   

now_to_milliseconds_hires({Mega, Sec, Micro}) ->
    now_to_seconds_hires({Mega, Sec, Micro}) * 1000
.   

epoch_gregorian_seconds() ->
    calendar:datetime_to_gregorian_seconds({{1970,1,1}, {0,0,0}})
.       

now_to_gregorian_seconds() ->
    epoch_to_gregorian_seconds(now())
.       

epoch_to_gregorian_seconds({Mega, Sec, Micro}) ->
    epoch_to_gregorian_seconds(now_to_seconds({Mega, Sec, Micro}));
epoch_to_gregorian_seconds(Now) ->
    EpochSecs = epoch_gregorian_seconds()
    , Now + EpochSecs
.       

gregorian_seconds_to_epoch(Secs) ->
    EpochSecs = epoch_gregorian_seconds()
    , Secs - EpochSecs
.

date_to_epoch(Date) ->
    datetime_to_epoch({Date, {0,0,0} })
.

datetime_to_epoch({Date, Time}) ->
    gregorian_seconds_to_epoch(
        calendar:datetime_to_gregorian_seconds({Date, Time}))
.

is_older_by(T1, T2, {days, N}) ->
    N1 = day_difference(T1, T2)
    , case N1 of
        N2 when (-N < N2) ->
            true;
        _ ->
            false
    end
.

is_sooner_by(T1, T2, {days, N}) ->
    case day_difference(T1, T2) of
        N1 when N > N1 ->
            true;
        _ ->
            false
    end
.

is_time_older_than({Date, Time}, Mark) ->
    is_time_older_than(calendar:datetime_to_gregorian_seconds({Date, Time})
        , Mark);
is_time_older_than(Time, {DateMark, TimeMark}) ->
    is_time_older_than(Time
        , calendar:datetime_to_gregorian_seconds({DateMark, TimeMark}));
is_time_older_than(Time, Mark)  when is_integer(Time), is_integer(Mark) ->
    Time < Mark
.

day_difference({D1, _}, D2) ->
    day_difference(D1, D2);
day_difference(D1, {D2, _}) ->
    day_difference(D1, D2);
day_difference(D1, D2) ->
    Days1 = calendar:date_to_gregorian_days(D1)
    , Days2 = calendar:date_to_gregorian_days(D2)
    , Days1 - Days2
.

is_time_sooner_than({Date, Time}, Mark) ->
    is_time_sooner_than(calendar:datetime_to_gregorian_seconds({Date, Time})
        , Mark);
is_time_sooner_than(Time, {DateMark, TimeMark}) ->
    is_time_sooner_than(Time
        , calendar:datetime_to_gregorian_seconds({DateMark, TimeMark}));
is_time_sooner_than(Time, Mark)  when is_integer(Time), is_integer(Mark) ->
    Time > Mark
.

subtract(Date, {days, N}) ->
    New = calendar:date_to_gregorian_days(Date) - N
    , calendar:gregorian_days_to_date(New)
.

add(Date, {days, N}) ->
    New = calendar:date_to_gregorian_days(Date) + N
    , calendar:gregorian_days_to_date(New)
. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-27T07:12:53.157

OTP 21.0 增加了这个功能

```
calendar:system_time_to_universal_time(Time, TimeUnit) -> datetime()

Types
    Time = integer()
    TimeUnit = erlang:time_unit()

Converts a specified system time into universal date and time. 
```

例子：

```
> os:system_time(1000).   
1598512151718
> calendar:system_time_to_universal_time(1598512151718, 1000).
{{2020,8,27},{7,9,11}} 
```

参考：[https ://erlang.org/doc/man/calendar.html#system_time_to_universal_time-2](https://erlang.org/doc/man/calendar.html#system_time_to_universal_time-2)

# html - CSS 嵌套没有按我想要的方式工作！

> ID：825156
> 
> 赞同：2
> 
> 时间：2009-05-05T14:36:18.537
> 
> 标签：html, css

好吧，可以说我有这个

```
<table class="infoBox">
    <tr>
        <td>
            test
        </td>
        <td>
            <table>
                <tr>
                    <td>
                        this should not be bold!
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table> 
```

然后我们得到了一些CSS

> Table.infoBox tr td { 字体粗细：粗体；}

现在我的问题是嵌套表似乎也得到了css，当我只希望外部表得到这个css时，我如何以某种方式定义它，以便嵌套表不受css的影响？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T14:40:10.900

虽然您可以对直接子级执行此操作，但并非所有浏览器都支持此操作。尝试：

```
table.infoBox tr td { font-weight: bold; }

table.infoBox table tr td { font-weight: normal; } 
```

选择器`table.infoBox tr td`所说的只是：

将此样式应用于任何`<td>`标记的子`<tr>`标记，该标记是具有 infoBox 类的任何表的子标记。

因此，您需要在此样式块下方获得更具体的信息，以便声明您想要对类 infoBox 中的表执行的操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T14:40:47.497

要么使用子选择器：

```
table.infoBox > tbody > tr > td { font-weight: bold; } 
```

（IE6 不支持）

**注意：**神秘的 tbody 元素。如果你不把它放进去，它会被浏览器插入。这是因为表格有三个部分：[thead、tbody 和 tfoot](http://www.idocs.com/tags/tables/_THEAD.html)。如果没有其中之一，行将添加到 tbody 元素。

或组合：

```
table.infoBox tr td { font-weight: bold; }
table.infoBox tr td td { font-weight: normal; } 
```

这个有很多潜在的变化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T14:41:01.320

Table.infoBox table tr td { font-weight: normal; }

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T15:21:38.053

它也可能足以使用：

```
table.infoBox { font-weight: bold; }
table.infoBox table { font-weight: normal; } 
```

或者

```
table.infoBox tr { font-weight: bold; }
table.infoBox table tr { font-weight: normal; } 
```

尽管所有 css 都依赖于整个 css 中的其他字体粗细规则，但需要注意的是 css declerations 是基于 decendensy，而不是直接的父子关系。因此，只要您没有任何更强大或更接近定义的内容，`table{}`就会对内容产生相同的影响。`td{}`

# c++ - 需要神经网络 XOR 反向传播信息

> ID：825162
> 
> 赞同：4
> 
> 时间：2009-05-05T14:37:09.097
> 
> 标签：c++, matlab, machine-learning, neural-network

有谁知道我在哪里可以找到一些关于 NN 反向传播的示例代码`XOR`，我也可以在系统训练后对其进行测试？

最好在 C++ 或 MATLAB 中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T14:42:48.630

我推荐John A. Bullinaria[的“用 C 语言实现神经网络的分步指南” 。](http://www.cs.bham.ac.uk/~jxb/NN/nn.html)

这是关于如何实现能够学习异或的多层神经网络的非常简单的演练。

文中介绍的代码是C语言的，非常容易理解。网络上的大多数“神经网络简介”文章都是基于面向对象的，并且以可重用库的形式出现，这可能会使它们更难理解和入门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:06:22.787

您已经得到了一些处理 C 代码的答案，所以这里有[一个 MATLAB 的 XOR 演示](http://www-cs.ccny.cuny.edu/~csolb/CscI1900/xor.htm)。该演示是为旧版本的 MATLAB（第 6 版）编写的，需要[神经网络工具箱](http://www.mathworks.com/products/neuralnet/)，但希望仍能为您提供有关如何实现网络的一些想法。

**编辑：**有关神经网络工具箱中反向传播算法的更多一般信息，我建议[在 MathWorks 网站上查看在线文档](http://www.mathworks.com/access/helpdesk/help/toolbox/nnet/backprop.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-15T06:24:38.763

[我在这里](https://stackoverflow.com/questions/30163573/xor-with-neural-networks-matlab)写了一篇，我觉得真的很简单。哦，什么鬼。我将在这里重新发布代码。

```
function layer2 = xornn2(iters)
    if nargin < 1
        iters = 50
    end
    T = [0 1 1 0];
    X = [0 0 1 1; 0 1 0 1; 1 1 1 1];
    m = size(T,2);
    inputsz = size(X,1)-1;
    hiddensz = 3;
    outputsz = size(T,1);
    theta1 = randn(hiddensz, 1+inputsz);
    theta2 = randn(outputsz, 1+hiddensz);
    for i = [1:iters]
        layer1 = [logsig(theta1 * X); ones(1,m)];
        layer2 = logsig(theta2 * layer1);
        delta2 = T - layer2;
        delta1 = layer1 .* (1-layer1) .* (theta2' * delta2);
        % remove the bias from delta 1\. There's no real point in a delta on the bias.
        delta1 = delta1(1:(end-1),:);
        theta2d = delta2 * layer1';
        theta1d = delta1 * X';
        theta1 = theta1 + 0.1 * theta1d;
        theta2 = theta2 + 0.1 * theta2d;
    end
end 
```

可以改进随机初始化。（我将它设为 sqrt(6./(fanin+fanout))...（来自 Yoshua Bengio 的一篇论文..）但是，它基本上可以工作.. 尝试使用 xornn(10000) 例如。你应该能够将 hiddensz 更改为 >= 2 的任何值。

# actionscript-3 - AS3 验证表单域？

> ID：825165
> 
> 赞同：0
> 
> 时间：2009-05-05T14:37:42.183
> 
> 标签：actionscript-3, validation, field

我写了一个 AS3 脚本，我有 2 个字段要验证，即电子邮件和姓名。

对于电子邮件，我使用：

```
function isValidEmail(Email:String):Boolean {
    var emailExpression:RegExp = /^[a-z][\w.-]+@\w[\w.-]+\.[\w.-]*[a-z][a-z]$/i;    
    return emailExpression.test(Email); 
} 
```

名称字段怎么样？你能给我看一些示例代码吗？

编辑：

无效的是：

*   空白的

*   4 - 20 个字符之间

*   仅限字母数字（不允许特殊字符）

*   必须以字母开头

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T22:03:25.787

我想你可能想要这样的功能：

```
function isNameValid(firstname:String):Boolean
{
    var nameEx:RegExp = /^([a-zA-Z])([ \u00c0-\u01ffa-zA-Z']){4,20}+$/;
    return nameEx.test(firstname);
} 
```

该正则表达式的概要：

*   **[a-zA-Z]** - 检查第一个字符是否为普通字母。
*   **[ \u00c0-\u01ffa-zA-Z']** - 检查所有其他字符是 unicode 字符还是空格。所以像“ *Mc'Neelan* ”这样的名字会起作用。
*   **{4,20}** - 确保名称长度在 4 到 20 个字符之间。

如果您不想要空格，可以删除中间部分开头的空格。

希望这可以帮助。这是我的参考资料：

*   [正则表达式使用 RegularExpressionValidator 验证名称 asp.net](http://carlosrivero.com/regular-expression-validate-name-asp-net-using-regularexpressionvalidator)
*   [Java - 正则表达式：验证名称](http://www.java2s.com/Code/VB/Network-Remote/RegularExpressionsValidateName.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T07:19:15.827

```
function isNameValid(firstname:String):Boolean
{
    var nameEx:RegExp = /^([a-zA-Z])([ \u00c0-\u01ffa-zA-Z']){4,20}+$/;
    return nameEx.test(firstname);
}

{4,20} instead {2,20}
Problem avoided for names like Ajit 
```

# plugins - Photoshop 插件 Pipl 资源和禁用保存

> ID：825167
> 
> 赞同：1
> 
> 时间：2009-05-05T14:37:52.807
> 
> 标签：plugins, adobe, photoshop

我有一个我用 c++ 编写的文件格式的 photoshop 插件，可以加载和打开图像，但是我没有代码以相同格式保存图像

使用 SimpleFormat 示例插件作为基础，我有以下代码：

```
 FormatFlags { fmtSavesImageResources, 
                  fmtCanRead, 
                  fmtCanWrite, 
                  fmtCanWriteIfRead, 
                  fmtCanWriteTransparency, 
                  fmtCanCreateThumbnail }, 
```

但是删除 fmtCanWrite 或 IfRead 等会在 Pipl 工具中产生解析器错误，我检查了语法，它应该是正确的，但我无法弄清楚如何做到这一点 =s

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T15:38:04.040

这确实违反直觉，但是如果您从 SDK 中查看 Plug-in Resource Guide.pdf 的 pg 77，则标志并不是真正的标志，它们实际上是关键字。根据他们给出的语法，要不包含 write 标志，您实际上需要用 do-not-write 标志替换它。

例如，这对我来说编译得很好：

```
 FormatFlags { fmtDoesNotSavesImageResources, 
                  fmtCanRead, 
                  fmtCannotWrite, 
                  fmtCanWriteIfRead, 
                  fmtCanWriteTransparency, 
                  fmtCanCreateThumbnail } 
```

# windows - IE8 本地 HTML 文件 - “系统找不到指定的文件。”

> ID：825172
> 
> 赞同：0
> 
> 时间：2009-05-05T14:39:23.537
> 
> 标签：windows, vb.net, internet-explorer-8

我们正在用 VB.NET 编写一个 Windows 客户端应用程序。在应用程序首次启动时，它会加载一个本地 HTML 文件“用户指南”，以便用户熟悉新软件。还有一个菜单选项可以访问也会产生相同错误的内容。每当启动页面时，都会出现一个对话框，说明“系统找不到指定的文件。”，然后浏览器窗口加载内容。这是特定于 IE8 的，因为我们之前使用 IE6 和 7 以及 Firefox 进行了测试，没有任何问题。

显然，当我们的一些用户单击电子邮件中的链接时，这种行为也会在 Outlook 2007 中发生，但仅限于他们单击的第一个链接。

此外，出现错误的一个条件是当前没有运行 IE8 窗口，否则会打开另一个选项卡并正常加载内容。我们在 XP 和 Vista 上收到此错误。

到目前为止，这就是我发现的关于这个问题的全部内容：

[http://www.eggheadcafe.com/conversation.aspx?messageid=34394054&threadid=34361999](http://www.eggheadcafe.com/conversation.aspx?messageid=34394054&threadid=34361999)

[http://www.microsoft.com/communities/newsgroups/en-us/default.aspx?query=general+failure.+the+url+was+&dg=microsoft.public.outlook.general&cat=en_US_db03bd1f-73aa-41e1 -abfd-27a6e3c352e5&lang=en&cr=US&pt=&catlist=&dglist=&ptlist=&exp=&sloc=en-us&mid=cb1e6b6d-71fd-4351-ae98-c10fccf5809c](http://www.microsoft.com/communities/newsgroups/en-us/default.aspx?query=general+failure.+the+url+was+&dg=microsoft.public.outlook.general&cat=en_US_db03bd1f-73aa-41e1-abfd-27a6e3c352e5&lang=en&cr=US&pt=&catlist=&dglist=&ptlist=&exp=&sloc=en-us&mid=cb1e6b6d-71fd-4351-ae98-c10fccf5809c)

任何事情都会非常感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T15:47:43.907

完全相同的问题；通过禁用特定的附加组件解决了问题：

“Sophos Web 内容扫描器”

所以，看起来反病毒插件是罪魁祸首——或者是 IE8 本身。只需在 Vista 上的“开始”框中输入 url，也可以重现问题（当插件运行时）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T15:29:48.557

该问题是由 McAfee Host Intrusion Prevention 服务引起的。停止服务可以缓解问题。所以答案是联系运行 HIPs 应用程序的团队。

# java - 为什么会有项目特定的 RuntimeException？

> ID：825176
> 
> 赞同：6
> 
> 时间：2009-05-05T14:39:56.970
> 
> 标签：java, exception, exception-handling

com.myco.myproj.MyProjRuntimeException 有什么意义，它完全扩展了 RuntimeException？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T15:22:04.700

**是的。*不要*抛出*未经检查*的异常，并将它们子类化。**

有很多关于检查异常是否真的有好处的讨论。简而言之，如果我抛出一个检查异常，我的客户真的与它有什么关系吗？

未经检查的异常是通知您的客户有关异常情况（包括非法的前提条件）的好方法，但不会让他们负担使用 try-catch 块包装对 API 的调用的负担，这在大多数情况下基本上没有任何作用，除了调试、跟踪等。

那么为什么不扔一个`RuntimeException`？它不*优雅*，而且*可读性较差*。让它成为你自己的异常，即使它只是在抛出异常时更具体。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T15:14:37.337

这取决于您是否要以与调用堆栈更远的其他异常不同的方式处理异常条件。如果您打算捕获并处理异常，那么我建议您创建自定义类型。它使代码更清晰，catch 子句更清晰。如果您不打算捕获异常，那么可能没有理由创建新类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T14:42:56.557

并不真地。可以通过简单地设置标准的消息字符串来提供从堆栈跟踪中显示异常名称获得的额外信息`RuntimeException`。但是（想一想），`RuntimeException`简单地将自定义字符串附加到任何消息上进行子类化可能很有用。

我倾向于只制作自定义检查异常；通常，标准的未经检查的异常已经涵盖了足够多的潜在情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T14:45:44.943

维护自己的异常层次结构是一种很好的风格。

但我看到只有少数人可以使用这种技术来获得真正的利润。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T15:02:56.820

Joshua Bloch 在 Effective Java 中写道：

> 使用运行时异常来指示编程错误。绝大多数运行时异常表明 *违反了先决条件*。

话虽如此，您可以将该运行时异常用作项目中使用的运行时异常层次结构的基类。这样，错误变得更加清晰和可追溯。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T15:19:31.477

许多人（包括我和 C# 的设计者）[认为](https://stackoverflow.com/questions/613954/the-case-against-checked-exceptions)检查的异常是一个失败的语言实验并避免它们。然后，在 RuntimeException 下创建自己的异常层次结构是显而易见的一步。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-10T11:49:35.130

在我看来，你应该只在你**真的**需要它们时才创建新的异常，即想要捕获它们并对它们进行特定的处理。在所有其他情况下，我并没有真正看到它的用处。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-05T15:40:20.460

Rod Jonhson 在 Expert one-on-one J2EE design and development 和 Tom 的回答 RuntimeException should be used for programming errors 中对此进行了描述。一个很好的例子是 SQLException，较低级别的数据访问 API 应该捕获它们并抛出您自己的“SQLRuntimeException”，因为大多数情况下调用代码无法对异常执行任何操作。这样，您的高级 API 不会被迫在其签名中捕获或携带较低级别的异常，这使代码更简单，更专注于业务领域。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-05T15:49:20.703

子类异常基于*它们的处理方式*而不是编写它们的人......

通常，除了记录错误并可能显示错误消息之外，无法以其他方式处理运行时异常。

检查的异常可能有一个特定的回退，在这种情况下，它们可能不应该子类化“MyFrameWorkException”——因为在这种情况下，捕获 MyFrameWorkException 不会比通用捕获（日志记录等）做更多的事情。

发明一个完整的异常层次结构是一种相当糟糕的做法，除了它们属于特定框架这一事实之外，它们几乎没有共同之处。（据说包就是用来做这个的。）

继承 RuntimeException 是完全可以的（如果现有的子类不适合）

记录未经检查的异常。对检查的异常要保守，不要建立层次结构。

# sharepoint - 自定义 SharePoint 列表视图 - 我可以将其放入功能 (WSP) 中吗？

> ID：825179
> 
> 赞同：1
> 
> 时间：2009-05-05T14:40:10.960
> 
> 标签：sharepoint, list, view, solution

这是我的情况：

我在 SharePoint 2007 Enterprise 中工作，我有一个功能可以在我部署和激活它时为我创建一个列表。到目前为止，我通常的工作流程是部署解决方案、激活它，然后打开 SharePoint Designer 来自定义列表。

我的自定义通常非常复杂，但我会保持简单。在这种情况下，假设我编辑`AllItems.aspx`，将数据视图转换为 XSLT 数据视图，然后添加一列带有静态文本。

我使用了一些不同的工具（SPSource、VSeWSS、SharePoint Manager、OCDExportList 等）来提取我的自定义`schema.xml`视图和所有默认视图，但我还没有运气弄清楚代码的`AllItems.aspx`位置定制。

当我提取（使用上述任何工具）时`AllItems.aspx`与默认值没有什么不同。schema.xml 中的`<View>`元素缩减为一行，例如：

```
<View DefaultView="TRUE" 
      MobileView="TRUE" 
      MobileDefaultView="TRUE" 
      Type="HTML" 
      FPModified="TRUE" 
      DisplayName="All Documents" 
      Url="Forms/AllItems.aspx" 
      Level="1" 
      ContentTypeID="0x" /> 
```

我真的被困在这里......我不知道该怎么做。甚至可能吗？如果我可以在我的功能中包含我的自定义设置，它将为我节省大量时间（和文档）。

如果我缺少任何其他有用的信息，请告诉我...谢谢！

* * *

**最新发现**：

在过去的几个小时里，我发现了更多。如果我将列表保存为列表模板，然后将 .stp 文件在本地保存为 .cab 文件，我可以提取其内容。其中一个文件`manifest.xml`包含`schema.xml`以及其他一些部分。

其中一个部分是每个视图`<webparts>`都有一个部分。`<webpart>`这些`<webpart>`元素中的每一个都包含一串很长的字符……不知道这些字符实际代表什么。

重要的是，如果将任何自定义视图部署为解决方案的一部分，我认为任何自定义视图实际上都必须是 Web 部件……但我并不肯定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T15:45:21.663

I have faced a similar issue a while ago. I had to create a very customized view and I had to give up the ListFormWebPart completely, and have created my own webpart to render the data.

Generally, when you customize the aspx file in SPDesigner, all your changes will be in the aspx file itself. Open it in SPDesigner and you will see there all the changes you have made. After you have converted to the XSL Data View, the standard ListFormWebPart is replaced by a DataFormWebPart, which doesn't care about the `<View>` tags specified in the schema.xml; Look in the aspx file itself for the ListFormWebPart.

Why not do all the customizations you want on a list, save the list as a template (it will include the associated AllItems.aspx) and then use that template in your feature to create your list? You could add the extracolumn from code (if it's dynamic and cannot be included in the template), and so on.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T21:56:31.640

是的你可以。从 Codeplex [http://spm.codeplex.com/获取 Sharepoint 管理器工具](http://spm.codeplex.com/)

将它安装在您农场的机器上，它将允许您通过显示所有对象的树视图浏览农场。

通过 Sharepoint GUI 创建列表，然后使用 SPM 浏览到它。

SPM 将允许您提取 MOSS/WSS 创建的描述列表视图的 xml（它显示在左侧属性网格中），然后您可以将其放入 manifest.xml

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T08:04:16.797

我有一个类似的问题，并且一直在对此进行大量研究。对我来说，dataview Web 部件是 Sharepoint 中最强大的组件之一。不幸的是，我必须以 .wsp 包的形式提供我的解决方案，这意味着我不能只创建站点并在该站点上使用 Designer。我采用了两步方法，我使用设计器创建我的数据视图，并且我还编辑了该数据视图的代码以将 ListID 和 Guids 替换为 ListName 和实际列表名称。只要列表名称相同，它就可以在任何页面/站点中导出和使用。我也在我的解决方案中创建了一个 webpart 页面文档库，我相信我可以使用 onet.xml 文件将具有 webparts 的页面添加到该库中。我会尽快获得该测试的结果。

# wpf - 在构建服务器上运行 UI 自动化测试

> ID：825180
> 
> 赞同：9
> 
> 时间：2009-05-05T14:40:11.150
> 
> 标签：wpf, testing, user-interface, automation, teamcity

我们使用 UI 自动化和 Nunit 为 WPF 应用程序创建测试 UI 测试。当您从本地计算机运行它们时，我们已经创建了可以正常工作的测试。这些测试从未在我们的构建服务器上成功运行（使用 TeamCity）。打开应用程序窗口后构建总是挂起。但是，如果我登录（远程桌面），在我们的构建服务器上，所有 UI 自动化测试也会成功运行。所以我猜测它可能与运行活动的 Windows 会话有关。任何想法如何说服我们的构建服务器创建活动 Windows 会话或任何其他解决方案以使这些测试在构建服务器上运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T15:06:52.957

你没有太多选择。我将列出我知道的两个，首先是最喜欢的选项：

*   在构建服务器上设置**虚拟机。**您的构建在虚拟机中执行。您可以锁定主机（也就是您的构建服务器）以确保安全。
*   让某人始终保持登录状态。这种偏离会产生安全问题。您可以通过移除鼠标、键盘和屏幕来稍微缓解这个问题，并且只通过 RDP 或类似的方式访问构建服务器。

* * *

**编辑**

看看这个[TestComplete FAQ](http://support.smartbear.com/viewarticle/8807/)项目： *计算机锁定时TestComplete可以执行脚本吗？*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T15:04:45.303

好吧，我只是在这里猜测。

尝试使用本地构建服务器用户而不是系统帐户运行 TeamCity 服务。在开始新构建之前，您可能必须使用该帐户登录一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T23:31:50.590

听起来你需要使用交互式会话而不是服务来运行测试。添加“允许服务与桌面交互”可能会有所帮助，但显然 Vista 不再支持此功能。

如果您可以将构建交互作为命令行运行，而不是应该工作的服务。

我们曾经使用visual studo 2008 负载代理运行我们的UIAutomation 测试来分发它们，在VM 上作为命令行工具运行没有问题。

我也同意您可能不应该在构建服务器上运行 UI 测试作为您日常构建的一部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-06T00:26:29.117

> 打开应用程序窗口后构建总是挂起。

实例化 UI 的测试？这是行不通的，例如，如果你得到一个模态对话框，构建将挂起。这就是发明 MVP 模式的原因，将活动表示代码与具体视图隔离开来。

您是否在自动化测试中使用模拟视图？

# windows-mobile - Windows CE 的串口监控应用程序？

> ID：825184
> 
> 赞同：1
> 
> 时间：2009-05-05T14:40:38.700
> 
> 标签：windows-mobile, serial-port, windows-ce

我在 Windows CE 设备上有一个应用程序，它试图通过串行端口接收数据。这不起作用，现在我正在寻找一些在该设备上运行的简单应用程序，它可以让我检查是否有任何数据进入。有没有像 HyperTerminal 这样的东西可以让我监控移动设备上的串行端口？

最好的可能是一个源代码可用的应用程序，这样我就可以根据我想在其上运行它的设备的具体情况对其进行调整（一些常用的系统 DLL 不可用）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-28T04:58:32.607

当我在 windows mobile 上进行大量基于串行通信的工作时，我发现[用于 PPC 的 ZTerm 是](http://www.tsreader.com/ztermppc/index.html)一个非常宝贵的工具。它支持直接串行连接，因此您可以使用它与串行端口、调制解调器等通信。还支持基于套接字的通信，因此您可以将其用作 telnet 与远程系统通信。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-06T06:15:47.467

在 Windows CE 中，您与串行端口的通信方式几乎与经典 Win32 中的方式相同。唯一的区别是不支持重叠 I/O。

因此，我想根据您的需要调整现有的 C++ 库会很容易。[Code Project](http://www.codeproject.com/KB/system/SerialPortComm.aspx)中有很多文章可用。[这](http://www.codeproject.com/KB/system/SerialPortComm.aspx)是一篇示例文章。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-27T11:14:22.280

试着检查[一下](http://nah6.com/~itsme/cvs-xdadevtools/tstmodem/)。如果我没记错的话，我用它来检查 COM 端口的功能（我懒得再次下载它并检查这是否正是我使用的版本......）。
它是一个基本应用程序，通过选定的 COM 端口发送和接收数据。基本，但您可以扩展功能。

# jquery - 使用单选按钮控件和 jquery 控制链接首选项

> ID：825189
> 
> 赞同：2
> 
> 时间：2009-05-05T14:41:08.527
> 
> 标签：jquery, cookies, radio-button

对于具有特定 CSS 类的任何链接，我想根据用户从一组单选按钮中的选择来控制链接是在同一个窗口、新窗口还是弹出窗口中打开（使用 onclick）——然后将该选择保存在 cookie 中（全部使用 jQuery）。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T17:40:25.897

这可能是我会做的......（你将需要[jQuery cookie 插件](http://stilbuero.de/jquery/cookie/jquery.cookie.js)）：

```
<script language="javascript">
$(function() {
    if($.cookie('link_pref')) {
    var link_pref = $.cookie('link_pref');
        $('#link_options_form :radio[value="'+ link_pref+'"]')
        .attr('checked','checked');
    }
    $.cookie('link_pref',$('#link_options_form :radio:checked').val(), {expires: 0});
    $('#link_options_form :radio').unbind('click').bind('click',function() {
         $.cookie('link_pref', $(this).val(), {expires: 0});
    });
    $('a').unbind('click').bind('click',function() {
        var link_pref = $.cookie('link_pref');
        var href = $(this).attr('href');
        var link_txt = $(this).text();
        switch(link_pref) {
            case 'new':
                $(this).attr('target','_blank');
                return true;
            case 'pop':
                window.open(href,link_txt,'width=640,height=480,toolbar=yes,location=yes,directories=yes,status=yes,menubar=yes,scrollbars=yes,copyhistory=yes,resizable=yes');
                return false;
            case 'greybox':
                // Other options found here: 
                // http://orangoo.com/labs/greybox/advance_usage.html
                GB_show(link_txt, href);
                return false;
            default:
                $(this).attr('target','_self');
                return true;
        }
    });
});
</script>

<form id="link_options_form">
    <label><input type="radio" name="link_options" value="same" /> Open in Same Window</label>
    <label><input type="radio" name="link_options" value="new" /> Open in New Window</label>
    <label><input type="radio" name="link_options" value="pop" /> Open in Pop-Up Window</label>
    <label><input type="radio" name="link_options" value="greybox" /> Open in Greybox</label>
</form> 
```

**编辑：**对不起，我没有先测试它。我有几个错别字，我忘了把 cookie 设置为开头（对不起）。我已经对其进行了测试，现在它可以与您的 HTML 一起使用。使用上面新编辑的代码。;-)

**编辑 2：**我添加了一个指向 cookie 插件的直接链接，以防万一您出于某种原因没有使用正确的链接。

**编辑3：**就我个人而言，我不会将单选按钮设置为在javascript中选中...我相信您可以使用服务器端语言访问相同的cookie。但是，我提供了一种可以在我新编辑的代码中使用的方法。

**编辑 4：**已修复选中的单选按钮错误的初始设置。这次它应该真的很有效。真的。o_0

# iphone - NSURLConnection - 如何等待完成

> ID：825191
> 
> 赞同：1
> 
> 时间：2009-05-05T14:41:39.023
> 
> 标签：iphone, cocoa-touch

我们的 iPhone 应用程序代码目前使用 NSURLConnection sendSynchronousRequest 并且工作正常，只是我们需要更多地了解连接进度和缓存，因此我们正在转向异步 NSURLConnection。

等待异步代码完成的最简单方法是什么？将其包装在 NSOperation/NSOperationQueue、performSelector... 或什么中？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T16:01:10.330

我正在回答这个问题，以防其他人将来遇到这个问题。Apple 的 URLCache 示例代码就是一个很好的例子。您可以在以下位置找到它：

*   [iOS 开发者库 - URLCache](https://developer.apple.com/iphone/library/samplecode/URLCache/index.html)

正如约翰在上面的评论中指出的那样 - 不要阻止/等待 - 通知。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T15:01:31.410

要异步使用 NSURLConnection，你需要在 initWithRequest:delegate: 中初始化它时提供一个委托。委托应该实现 NSURLConnection 委托方法。NSURLConnection 处理发生在另一个线程上，但委托方法在为关联的 NSURLConnection 对象启动异步加载操作的线程上调用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-06T06:57:35.107

除了前面提到的通知之外，一种常见的方法是让需要了解 URL 加载完成的类将自身设置为处理 URL 回调的类的委托。然后，当 URL 加载完成时，将调用委托并告知加载已完成。

事实上，如果你阻塞了线程，连接将永远不会去任何地方，因为它在同一个线程上工作（是的，即使你使用的是异步方法）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-11T15:16:10.523

我遇到了这个问题，因为我们的应用程序`NSURLConnection sendSynchronousRequest`在很多有意义的地方使用，比如在后台线程上进行一些处理，偶尔需要额外的数据来完成处理。像这样的东西：

```
// do some processing
NSData * data = someCachedData;
if (data = nil) {
    data = [NSURLConnection sendSynchronousRequest....]
    someCachedData = data;
}
// Use data for further processing 
```

如果您在同一个流程中有 3 个不同的地方可以执行此操作，则可能不希望将其分解为单独的函数（或者如果您有足够大的代码库，则根本不可行）。

在某些时候，我们需要有一个代表来进行我们的连接（进行 SSL 证书固定），我去互联网上寻找解决方案，一切都是这样的：“只使用异步，不要与框架对抗！”。好吧，`sendSynchronousRequest`存在是有原因的，这就是如何使用底层异步连接来重现它：

```
 + (NSData *)sendSynchronousRequest:(NSURLRequest *)request returningResponse:(NSURLResponse *__autoreleasing *)response error:(NSError *__autoreleasing *)error
 {
     static NSOperationQueue * requestsQueue;
     static dispatch_once_t onceToken;
     dispatch_once(&onceToken, ^{
         requestsQueue = [[NSOperationQueue alloc] init];
         requestsQueue.maxConcurrentOperationCount = NSOperationQueueDefaultMaxConcurrentOperationCount;
     });

     NSCondition * waitLock = [NSCondition new];
     [waitLock lock];

     __block NSError * returnedError;
     __block NSURLResponse * returnedResponse;
     __block NSData * returnedData;
     __block BOOL done = NO;
     [NSURLConnection sendAsynchronousRequest:request
                                        queue:requestsQueue
                            completionHandler:^(NSURLResponse * response, NSData * data, NSError * connectionError){

                     returnedError = connectionError;
                     returnedResponse = response;
                     returnedData = data;
                     [waitLock lock];
                     done = YES;
                     [waitLock signal];
                     [waitLock unlock];
                 }];
     if (!done) {
         [waitLock wait];
     }
     [waitLock unlock];
     *response = returnedResponse;
     *error = returnedError;
     return returnedData;
 } 
```

张贴在这里，以防有人像我一样看起来。

请注意，`NSURLConnection sendAsynchrounousRequest`可以用您用来发送异步请求的任何方式替换它，例如`NSURLConnection`使用委托或其他方式创建对象。

# javascript - 将公斤转换为磅和盎司的函数

> ID：825196
> 
> 赞同：3
> 
> 时间：2009-05-05T14:42:51.580
> 
> 标签：javascript, units-of-measurement

我想将公斤转换为磅和盎司，例如，如果用户输入 10 公斤，那么函数应该返回 22 磅和 0.73 盎司

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T15:44:07.780

根据@dlamblin 的回答，这是一个返回结构中的磅和盎司的函数。

```
function kToLbs(pK) {
    var nearExact = pK/0.45359237;
    var lbs = Math.floor(nearExact);
    var oz = (nearExact - lbs) * 16;
    return {
        pounds: lbs,
        ounces: oz
    };
}

var imperial = kToLbs(10);
alert("10 kg = " + imperial.pounds + " lbs and " + imperial.ounces + " oz."); 
```

以下是你将如何走另一条路：

```
function lbsAndOzToK(imperial) {
    var pounds = imperial.pounds + imperial.ounces / 16;
    return pounds * 0.45359237;
}

var kg = lbsToK({ pounds: 10, ounces: 8 });
alert("10 lbs and 8 oz = " + kg + " kg."); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T14:48:52.203

```
function kgToPounds(value) {
    return value * ?conversionValue?;
} 
```

更换`?conversionValue?`为所需的任何速率。

```
function poundsToOunces(value) {
    return value * 16;
} 
```

不是很硬的东西，这个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T14:50:59.453

```
function KtoLbs(pK) {
  nearExact = pK/0.45359237;
  lbs = Math.floor(nearExact);
  oz = (nearExact - lbs) * 16;
}
/* sigh */ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-08T01:18:20.707

谷歌几乎做到了。不会做磅和盎司。

谷歌“10 公斤盎司”

谷歌回应：10 公斤 = 352.739619 盎司

然后，您所要做的就是编写所有管道以将信息发送到谷歌并取回。

:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T14:46:53.957

这是一个简单的转换......我将把细节留给你......

[1 公斤 = 2.20462262 磅](http://www.google.com/search?rlz=1C1GGLS_enUS307US307&sourceid=chrome&ie=UTF-8&q=convert+kg+to+lb)

# sql-server-2005 - 使用 SQL Server 2005 的 Active Directory 组

> ID：825205
> 
> 赞同：0
> 
> 时间：2009-05-05T14:43:58.863
> 
> 标签：sql-server-2005, active-directory, ldap

好的，所以我已经在我的服务器上与 Active Directory 建立了连接。我知道查询活动目录有效。我想要做的是查询活动目录中的所有 ou 和/或组，并且还能够找到属于这些组/ous 的用户。

这是当前仅提取用户信息的查询（或设置为提取所有用户的存储过程的一部分）：

```
SELECT
    userAccountControl,
    DisplayName AS [NAME],
    givenName AS FIRSTNAME,
    middleName, 
    sn AS LASTNAME,
    employeeID AS EMPID,
    telephoneNumber AS EXT,
    Title, 
    Department AS DEPT,
    Division,
    sAMAccountName AS UserName,
    mail AS Email,
    homeDirectory AS HomeDir,
    userPrincipalName AS LOGON,
    manager
FROM         OPENQUERY(ADSI, 
                      '
 select
     userAccountControl,
     DisplayName,
     givenName,
     middleName,
     sn,
     employeeID,
     telephoneNumber,
     Title,
     Department,
     Division,
     sAMAccountName,
     mail,
     homeDirectory,
     userPrincipalName,
     manager
 from ''LDAP://name''
 where sn > ''a''
    and sn <''h''
 order by DisplayName
 ')
AS derivedtbl_1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T15:19:04.143

Are you aware of the fact that you cannot query more objects than the AD server is willing to return in one reply?

The ADSI SQL provider does not support paging through the results. The AD server is usually configured to return the first 1000 results only.

If you query for virtually all AD objects at once you are very likely to hit that limit.

Can you clarify what you are trying to achieve?

# javascript - 通过鼠标单击获取图像地图的坐标

> ID：825216
> 
> 赞同：1
> 
> 时间：2009-05-05T14:46:49.137
> 
> 标签：javascript, html, map

我有一个 html 图像地图，我想在用户单击地图时获取坐标。

**有没有办法通过在地图上单击鼠标来检索地图坐标？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T14:55:57.430

您可以使用 JQuery 库并执行以下操作：

```
$(".link").click(function(e){
        e.pageX;
              e.pageY;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T14:55:38.380

就在这里。但是仅使用 javascript 可能非常复杂。

如果可以，您需要实现 jquery，然后检查[此链接](http://jquery-howto.blogspot.com/2009/01/jquery-and-html-image-maps.html)。

如果您正在谈论真实的地图图像（如谷歌地图或其他东西），一旦您获得鼠标坐标，只需乘以地图比例即可。:)

# iphone - OpenGL 到 OpenGL-ES - glRectf()

> ID：825219
> 
> 赞同：3
> 
> 时间：2009-05-05T14:47:25.670
> 
> 标签：iphone, opengl, opengl-es

我正在尝试使用[“超级圣经”](http://www.starstonesoftware.com/OpenGL/)在 iPhone 上学习 OpenGL，但在从 OpenGL 移植到 OpenGL ES 时遇到了麻烦。我的理解是该`[glRectf()](http://www.opengl.org/sdk/docs/man/xhtml/glRect.xml)`功能在后者中不可用。什么是替代方法？任何相关的概念信息也将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T15:01:49.303

替代方法是画一个三角带：

```
GLfloat texture[] =
{
    0, 0,
    0, 1,
    1, 0,
    1, 1
};

GLfloat model[] =
{
    0, 0, // lower left
    0, h, // upper left
    w, 0, // lower right
    w, h  // upper right
};

glEnableClientState(GL_VERTEX_ARRAY);
glEnableClientState(GL_TEXTURE_COORD_ARRAY);

glVertexPointer(2, GL_FLOAT, 0, model);
glTexCoordPointer(2, GL_FLOAT, 0, texture);
glDrawArrays(GL_TRIANGLE_STRIP, 0, 4); 
```

这将绘制一个带宽度`w`和高度的带纹理的矩形`h`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T14:52:44.130

而不是做一个矩形，你只做两个三角形。

这实际上无关紧要，因为 iPhone 上的 GL-ES 不支持即时模式。您需要在数组中定义所有顶点并使用顶点数组渲染函数之一来绘制它们，而不是使用立即模式函数。

# java - 在哪里可以找到 Java 平方根函数的源代码？

> ID：825221
> 
> 赞同：19
> 
> 时间：2009-05-05T14:47:58.277
> 
> 标签：java, math.sqrt

我知道`Math.sqrt`电话 `StrictMath.sqrt(double a)`。

类中的方法签名`StrictMath`：

```
public static native double sqrt(double a); 
```

我想看看用于计算它 **的实际实现代码。**

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-05T14:54:04.687

当您安装 JDK 时，可以在 JDK 中找到标准库的源代码`src.zip`。`StrictMath`但是，这对您没有帮助，`StrictMath.sqrt(double)`如下所示：

```
public static native double sqrt(double a); 
```

所以它实际上只是一个本地调用，并且可能由 Java 在不同的平台上以不同的方式实现。

但是，作为`StrictMath`国家的文件：

> 为帮助确保 Java 程序的可移植性，此包中某些数值函数的定义要求它们产生与某些已发布算法相同的结果。这些算法可从著名的网络库`netlib`中以包“Freely Distributable Math Library” [fdlibm](ftp://ftp.netlib.org/fdlibm.tar)的形式获得。这些算法是用 C 编程语言编写的，因此可以理解为按照 Java 浮点运算规则执行所有浮点运算。
> 
> Java 数学库是针对 fdlibm 5.3 版定义的。如果 fdlibm 为函数（例如 acos）提供了多个定义，请使用“IEEE 754 核心函数”版本（驻留在名称以字母 e 开头的文件中）。需要 fdlibm 语义的方法有 sin、cos、tan、asin、acos、atan、exp、log、log10、cbrt、atan2、pow、sinh、cosh、tanh、hypot、expm1 和 log1p。

因此，通过找到源代码的适当版本`fdlibm`，您还应该找到 Java 使用的确切实现（并且由此处的规范强制执行）。

使用的实现`fdlibm`是

```
static const double one = 1.0, tiny=1.0e-300;

double z;
int sign = (int) 0x80000000; 
unsigned r, t1, s1, ix1, q1;
int ix0, s0, q, m, t, i;

ix0 = __HI(x); /* high word of x */
ix1 = __LO(x); /* low word of x */

/* take care of Inf and NaN */
if ((ix0 & 0x7ff00000) == 0x7ff00000) {            
    return x*x+x; /* sqrt(NaN) = NaN, 
                     sqrt(+inf) = +inf,
                     sqrt(-inf) = sNaN */
} 

/* take care of zero */
if (ix0 <= 0) {
    if (((ix0&(~sign)) | ix1) == 0) {
        return x; /* sqrt(+-0) = +-0 */
    } else if (ix0 < 0) {
        return (x-x) / (x-x); /* sqrt(-ve) = sNaN */
    }
}

/* normalize x */
m = (ix0 >> 20);
if (m == 0) { /* subnormal x */
    while (ix0==0) {
        m -= 21;
        ix0 |= (ix1 >> 11); ix1 <<= 21;
    }
    for (i=0; (ix0&0x00100000)==0; i++) {
        ix0 <<= 1;
    }
    m -= i-1;
    ix0 |= (ix1 >> (32-i));
    ix1 <<= i;
}

m -= 1023; /* unbias exponent */
ix0 = (ix0&0x000fffff)|0x00100000;
if (m&1) { /* odd m, double x to make it even */
    ix0 += ix0 + ((ix1&sign) >> 31);
    ix1 += ix1;
}

m >>= 1; /* m = [m/2] */

/* generate sqrt(x) bit by bit */
ix0 += ix0 + ((ix1 & sign)>>31);
ix1 += ix1;
q = q1 = s0 = s1 = 0; /* [q,q1] = sqrt(x) */
r = 0x00200000; /* r = moving bit from right to left */

while (r != 0) {
    t = s0 + r; 
    if (t <= ix0) { 
        s0 = t+r; 
        ix0 -= t; 
        q += r; 
    } 
    ix0 += ix0 + ((ix1&sign)>>31);
    ix1 += ix1;
    r>>=1;
}

r = sign;
while (r != 0) {
    t1 = s1+r; 
    t = s0;
    if ((t<ix0) || ((t == ix0) && (t1 <= ix1))) { 
        s1 = t1+r;
        if (((t1&sign) == sign) && (s1 & sign) == 0) {
            s0 += 1;
        }
        ix0 -= t;
        if (ix1 < t1) {
            ix0 -= 1;
        }
        ix1 -= t1;
        q1  += r;
    }
    ix0 += ix0 + ((ix1&sign) >> 31);
    ix1 += ix1;
    r >>= 1;
}

/* use floating add to find out rounding direction */
if((ix0 | ix1) != 0) {
    z = one - tiny; /* trigger inexact flag */
    if (z >= one) {
        z = one+tiny;
        if (q1 == (unsigned) 0xffffffff) { 
            q1=0; 
            q += 1;
        }
    } else if (z > one) {
        if (q1 == (unsigned) 0xfffffffe) {
            q+=1;
        }
        q1+=2; 
    } else
        q1 += (q1&1);
    }
}

ix0 = (q>>1) + 0x3fe00000;
ix1 =  q 1>> 1;
if ((q&1) == 1) ix1 |= sign;
ix0 += (m <<20);
__HI(z) = ix0;
__LO(z) = ix1;
return z; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-05T15:06:08.887

因为我碰巧有[OpenJDK](http://openjdk.java.net/)，所以我将在这里展示它的实现。

在 jdk/src/share/native/java/lang/StrictMath.c 中：

```
JNIEXPORT jdouble JNICALL
Java_java_lang_StrictMath_sqrt(JNIEnv *env, jclass unused, jdouble d)
{
    return (jdouble) jsqrt((double)d);
} 
```

`jsqrt`在 jdk/src/share/native/java/lang/fdlibm/src/w_sqrt.c 中定义`sqrt`（名称通过预处理器更改）：

```
#ifdef __STDC__
        double sqrt(double x)           /* wrapper sqrt */
#else
        double sqrt(x)                  /* wrapper sqrt */
        double x;
#endif
{
#ifdef _IEEE_LIBM
        return __ieee754_sqrt(x);
#else
        double z;
        z = __ieee754_sqrt(x);
        if(_LIB_VERSION == _IEEE_ || isnan(x)) return z;
        if(x<0.0) {
            return __kernel_standard(x,x,26); /* sqrt(negative) */
        } else
            return z;
#endif
} 
```

并且`__ieee754_sqrt`在 jdk/src/share/native/java/lang/fdlibm/src/e_sqrt.c 中定义为：

```
#ifdef __STDC__
static  const double    one     = 1.0, tiny=1.0e-300;
#else
static  double  one     = 1.0, tiny=1.0e-300;
#endif

#ifdef __STDC__
        double __ieee754_sqrt(double x)
#else
        double __ieee754_sqrt(x)
        double x;
#endif
{
        double z;
        int     sign = (int)0x80000000;
        unsigned r,t1,s1,ix1,q1;
        int ix0,s0,q,m,t,i;

        ix0 = __HI(x);                  /* high word of x */
        ix1 = __LO(x);          /* low word of x */

    /* take care of Inf and NaN */
        if((ix0&0x7ff00000)==0x7ff00000) {
            return x*x+x;               /* sqrt(NaN)=NaN, sqrt(+inf)=+inf
                                           sqrt(-inf)=sNaN */
        }
    /* take care of zero */
        if(ix0<=0) {
            if(((ix0&(~sign))|ix1)==0) return x;/* sqrt(+-0) = +-0 */
            else if(ix0<0)
                return (x-x)/(x-x);             /* sqrt(-ve) = sNaN */
        }
    /* normalize x */
        m = (ix0>>20);
        if(m==0) {                              /* subnormal x */
            while(ix0==0) {
                m -= 21;
                ix0 |= (ix1>>11); ix1 <<= 21;
            }
            for(i=0;(ix0&0x00100000)==0;i++) ix0<<=1;
            m -= i-1;
            ix0 |= (ix1>>(32-i));
            ix1 <<= i;
        }
        m -= 1023;      /* unbias exponent */
        ix0 = (ix0&0x000fffff)|0x00100000;
        if(m&1){        /* odd m, double x to make it even */
            ix0 += ix0 + ((ix1&sign)>>31);
            ix1 += ix1;
        }
        m >>= 1;        /* m = [m/2] */

    /* generate sqrt(x) bit by bit */
        ix0 += ix0 + ((ix1&sign)>>31);
        ix1 += ix1;
        q = q1 = s0 = s1 = 0;   /* [q,q1] = sqrt(x) */
        r = 0x00200000;         /* r = moving bit from right to left */

        while(r!=0) {
            t = s0+r;
            if(t<=ix0) {
                s0   = t+r;
                ix0 -= t;
                q   += r;
            }
            ix0 += ix0 + ((ix1&sign)>>31);
            ix1 += ix1;
            r>>=1;
        }

        r = sign;
        while(r!=0) {
            t1 = s1+r;
            t  = s0;
            if((t<ix0)||((t==ix0)&&(t1<=ix1))) {
                s1  = t1+r;
                if(((t1&sign)==sign)&&(s1&sign)==0) s0 += 1;
                ix0 -= t;
                if (ix1 < t1) ix0 -= 1;
                ix1 -= t1;
                q1  += r;
            }
            ix0 += ix0 + ((ix1&sign)>>31);
            ix1 += ix1;
            r>>=1;
        }

    /* use floating add to find out rounding direction */
        if((ix0|ix1)!=0) {
            z = one-tiny; /* trigger inexact flag */
            if (z>=one) {
                z = one+tiny;
                if (q1==(unsigned)0xffffffff) { q1=0; q += 1;}
                else if (z>one) {
                    if (q1==(unsigned)0xfffffffe) q+=1;
                    q1+=2;
                } else
                    q1 += (q1&1);
            }
        }
        ix0 = (q>>1)+0x3fe00000;
        ix1 =  q1>>1;
        if ((q&1)==1) ix1 |= sign;
        ix0 += (m <<20);
        __HI(z) = ix0;
        __LO(z) = ix1;
        return z;
} 
```

文件中有大量注释解释所使用的方法，为了（半）简洁起见，我省略了这些注释。[这是 Mercurial 中的文件](http://hg.openjdk.java.net/jdk6/jdk6-gate/jdk/file/a42d6999734b/src/share/native/java/lang/fdlibm/src/e_sqrt.c)（我希望这是链接到它的正确方法）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-05T14:49:25.480

从 OpenJDK 下载源代码。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-05T14:50:33.260

我不确切知道，但我认为您会在终点找到牛顿算法。

UPD：正如评论所说，具体实现取决于具体的java机器。对于 Windows，它可能使用汇编器实现，其中存在标准运算符 sqrt

# php - 从表单发布中删除子域

> ID：825226
> 
> 赞同：0
> 
> 时间：2009-05-05T14:49:34.747
> 
> 标签：php, forms

我将如何从输入到表单中的长字符串中仅提取基本 URl？

示例：用户输入：`http://stackoverflow.com/question/ask/asdfasneransea` 程序只需要：`http://stackoverflow.com`而不是`/question/ask/asdfasneransea`

使用 PHP 执行此操作的最简单方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T14:55:16.387

你可以简单地使用[`parse_url()`](http://www.php.net/parse_url)

```
$url = parse_url('http://example.com/foo/bar');
$host = $url['host']; // example.com 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T14:55:46.447

使用 parse_url 函数获取 URL 的单独部分，然后重新组合您要查找的部分。

# c# - PrintImage 导致损坏的内存错误

> ID：825232
> 
> 赞同：1
> 
> 时间：2009-05-05T14:50:40.063
> 
> 标签：c#, pdf-generation, memory-corruption

我在使用`PrintImage`ActivePDF C# 库的功能时遇到问题。当我使用它尝试在 PDF 上放置 .gif 图像时，我收到以下错误消息：

> 尝试读取或写入受保护的内存。这通常表明其他内存已损坏。

我可以毫无问题地使用`PrintJPEG`和图像功能。`PrintTIFF`有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T15:05:41.057

该图像是否来自图片框或类似控件？如果是这种情况，那么该控件会锁定该图像（我在尝试序列化包含来自 inkpicture 控件的图像的对象时遇到了同样的情况）。您需要先复制图像，然后再将其放入 pdf 文档中。

# c# - 如何从 C# 中找到活动目录中的用户？

> ID：825237
> 
> 赞同：19
> 
> 时间：2009-05-05T14:51:25.037
> 
> 标签：c#, active-directory

我试图弄清楚如何从 C# 搜索 AD，类似于“查找用户、联系人和组”在 Active Directory 用户和计算机工具中的工作方式。我有一个包含组名或用户名的字符串（通常格式为 firstname middleinitial [if they have one] lastname，但并非总是如此）。即使我对组和用户进行单独查询，我也无法找到一种可以捕获大多数用户帐户的搜索方式。查找用户、联系人和群组工具几乎每次都能将他们带回来。有人有什么建议吗？

我已经知道如何使用 DirectorySearcher 类，问题是我找不到符合我要求的查询。cn 和 samaccount 名称都与这里的用户名无关，所以我无法搜索这些。拆分并在 sn 和 givenName 上搜索并没有像该工具那样接近任何地方。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-05T15:49:30.453

你在 .NET 3.5 上吗？如果是这样 - AD 在 .NET 3.5 中具有出色的新功能 - 请查看Ethan Wilanski 和 Joe Kaplan 撰写的这篇文章[在 .NET 3.5 中管理目录安全主体。](http://msdn.microsoft.com/en-us/magazine/cc135979.aspx#S8)

其中一个重要的新功能是“PrincipalSearcher”类，它应该大大简化在 AD 中查找用户和/或组的过程。

如果您不能使用 .NET 3.5，可能会让您的生活更轻松的一件事称为“模糊名称解析”，它是一种鲜为人知的特殊搜索过滤器，可以一次搜索几乎所有与名称相关的属性。

像这样指定您的 LDAP 搜索查询：

```
searcher.Filter = string.Format("(&(objectCategory=person)(anr={0}))", yourSearchTerm) 
```

另外，我建议对“objectCategory”属性进行过滤，因为它在 AD 中默认是单值和索引的，这比使用“objectClass”要快得多。

马克

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-05T15:00:28.260

System.DirectoryServices 有两个命名空间...DirectoryEntry 和 DirectorySearcher。

有关 DirectorySearcher 的更多信息：

[http://msdn.microsoft.com/en-us/library/system.directoryservices.directorysearcher.aspx](http://msdn.microsoft.com/en-us/library/system.directoryservices.directorysearcher.aspx)

然后，您可以使用 Filter 属性按组、用户等进行过滤...

因此，如果您想按帐户名称过滤，您可以将 .Filter 设置为：

```
"(&(sAMAccountName=bsmith))" 
```

并运行 FilterAll 方法。这将返回一个 SearchResultCollection，您可以循环并提取有关用户的信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-05T15:10:03.963

您需要根据查找用户的方式构建搜索字符串。

```
using (var adFolderObject = new DirectoryEntry())
{
     using(var adSearcherObject = new DirectorySearcher(adFolderObject))
     {
          adSearcherObject.SearchScope = SearchScope.Subtree;
          adSearcherObject.Filter = "(&(objectClass=person)(" + userType + "=" + userName + "))";

          return adSearcherObject.FindOne();
     }
} 
```

userType 应该是 sAMAccountName 或 CN，具体取决于用户名的格式。

例如：
firstname.lastname（或姓氏）通常是 sAMAccountName
FirstName LastName 通常是 CN

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-05T15:12:13.130

```
public DirectoryEntry Search(string searchTerm, string propertyName)
{
   DirectoryEntry directoryObject = new DirectoryEntry(<pathToAD>);

   foreach (DirectoryEntry user in directoryObject.Children)
   {
      if (user.Properties[propertyName].Value != null)    
         if (user.Properties[propertyName].Value.ToString() == searchTerm)
             return user;                       
   }

   return null;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-05T15:11:02.010

添加到宫城的答案.​​...

这是应用于 DirectorySearcher 的过滤器/查询

```
DirectorySearcher ds = new DirectorySearcher();

ds.Filter = "samaccountname=" + userName;

SearchResult result = ds.FindOne(); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-10-21T14:28:37.310

从[Joe Kaplan 和 Ethan Wilansky](http://msdn.microsoft.com/en-us/magazine/cc135979.aspx)文章 Use this Using（来自引用 System.DirectoryServices.AccountManagement dll）得到这个：

```
using System.DirectoryServices.AccountManagement;

private bool CheckUserinAD(string domain, string username)
{
    PrincipalContext domainContext = new PrincipalContext(ContextType.Domain, domain);
    UserPrincipal user = new UserPrincipal(domainContext);
    user.Name = username;
    PrincipalSearcher pS = new PrincipalSearcher();
    pS.QueryFilter = user;
    PrincipalSearchResult<Principal> results = pS.FindAll();
    if (results != null && results.Count() > 0)
        return true;
    return false;
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-11-03T18:18:45.770

其他答案描述得不好，没有描述如何实现它们，并且大多数给出了错误的过滤器属性。您甚至不需要使用`.Filter`- 您只需将属性（姓氏 = `.Surname`，名字 = `.GivenName`）分配给一个`UserPrincipal`对象，然后在`PrincipalSearcher`触发搜索的任何事件中使用 a 搜索该对象：

```
string firstName = txtFirstName.Text;
string lastName = txtLastName.Text;

PrincipalContext ctx = new PrincipalContext(ContextType.Domain);

UserPrincipal up = new UserPrincipal(ctx);
if (!String.IsNullOrEmpty(firstName))
    up.GivenName = firstName;
if (!String.IsNullOrEmpty(lastName))
    up.Surname = lastName;

PrincipalSearcher srch = new PrincipalSearcher(up);
srch.QueryFilter = up; 
```

我假设您有名字和姓氏的文本框来获取它，ID/名称为`txtFirstName`和`txtLastName`。请注意，如果您要查找的属性中没有值，请不要将其添加到 中`UserPrincipal`，否则会导致异常。这就是我在上面包含的检查的原因。

然后，您`.FindAll`可以`srch`将搜索结果放入对象`PrincipalSearchResult`集合中`Principal`：

```
using (PrincipalSearchResult<Principal> results = srch.FindAll())
{
    if (results != null)
    {
        int resultCount = results.Count();
        if (resultCount > 0)  // we have results
        {
            foreach (Principal found in results)
            {
                string username = found.SamAccountName; // Note, this is not the full user ID!  It does not include the domain.
            }
        }
    }
} 
```

请注意，即使它`.Count()`是，结果也不会为空`0`，以及为什么两个检查都在那里。

您使用它进行迭代`foreach`以获取所需的属性，这回答了如何使用 C# 在 AD 中查找用户的问题，但请注意，您只能使用该`Principal`对象访问一些属性，如果我通过 Google 找到了这个问题（正如我所做的那样），我会非常沮丧。如果你发现这就是你所需要的——太好了，你就完成了！但为了得到其余的（并让我自己的良心安息），你必须潜入水中，我将描述如何做到这一点。

我发现你不能只使用`username`我上面放的那个，但你必须得到整个`DOMAIN\doej`名字。这就是你这样做的方式。相反，把它放在`foreach`上面的那个循环中：

```
string userId = GetUserIdFromPrincipal(found); 
```

并使用此功能：

```
private static string GetUserIdFromPrincipal(Principal prin)
{
    string upn = prin.UserPrincipalName;
    string domain = upn.Split('@')[1];
    domain = domain.Substring(0, domain.IndexOf(".YOURDOMAIN"));

    // "domain" will be the subdomain the user belongs to.
    // This may require edits depending on the organization.

    return domain + @"\" + prin.SamAccountName;
} 
```

一旦你有了它，你可以调用这个函数：

```
 public static string[] GetUserProperties(string strUserName)
    {
        UserPrincipal up = GetUser(strUserName);
        if (up != null)
        {
            string firstName = up.GivenName;
            string lastName = up.Surname;
            string middleInit = String.IsNullOrEmpty(up.MiddleName) ? "" : up.MiddleName.Substring(0, 1);
            string email = up.EmailAddress;
            string location = String.Empty;
            string phone = String.Empty;
            string office = String.Empty;
            string dept = String.Empty;

            DirectoryEntry de = (DirectoryEntry)up.GetUnderlyingObject();
            DirectorySearcher ds = new DirectorySearcher(de);
            ds.PropertiesToLoad.Add("l"); // city field, a.k.a location
            ds.PropertiesToLoad.Add("telephonenumber");
            ds.PropertiesToLoad.Add("department");
            ds.PropertiesToLoad.Add("physicalDeliveryOfficeName");

            SearchResultCollection results = ds.FindAll();
            if (results != null && results.Count > 0)
            {
                ResultPropertyCollection rpc = results[0].Properties;
                foreach (string rp in rpc.PropertyNames)
                {
                    if (rp == "l")  // this matches the "City" field in AD properties
                        location = rpc["l"][0].ToString();
                    if (rp == "telephonenumber")
                        phone = FormatPhoneNumber(rpc["telephonenumber"][0].ToString());                       
                    if (rp == "physicalDeliveryOfficeName")
                        office = rpc["physicalDeliveryOfficeName"][0].ToString();  
                    if (rp == "department")
                        dept = rpc["department"][0].ToString();
                }
            }

            string[] userProps = new string[10];
            userProps[0] = strUserName;
            userProps[1] = firstName;
            userProps[2] = lastName;
            userProps[3] = up.MiddleName;
            userProps[4] = middleInit;
            userProps[5] = email;
            userProps[6] = location;  
            userProps[7] = phone;  
            userProps[8] = office;
            userProps[9] = dept;

            return userProps;
        }
        else
            return null;
    }

    /// <summary>
    /// Returns a UserPrincipal (AD) user object based on string userID being supplied
    /// </summary>
    /// <param name="strUserName">String form of User ID:  domain\username</param>
    /// <returns>UserPrincipal object</returns>
    public static UserPrincipal GetUser(string strUserName)
    {
        PrincipalContext oPrincipalContext = new PrincipalContext(ContextType.Domain);
        try
        {
            UserPrincipal oUserPrincipal = UserPrincipal.FindByIdentity(oPrincipalContext, strUserName);
            return oUserPrincipal;
        }
        catch (Exception ex) { return null; }
    }

    public static string FormatPhoneNumber(string strPhoneNumber)
    {
        if (strPhoneNumber.Length > 0)
            //  return String.Format("{0:###-###-####}", strPhoneNumber);  // formating does not work because strPhoneNumber is a string and not a number
            return Regex.Replace(strPhoneNumber, @"(\d{3})(\d{3})(\d{4})", "$1-$2-$3");
        else
            return strPhoneNumber;
    } 
```

请注意，该`FormatPhoneNumber`功能适用​​于北美号码。它将采用找到的数字 ( `##########`) 并将其分隔为`###-###-####`.

然后，您可以在该`foreach`循环中获取这样的属性：

```
string[] userProps = GetUserProperties(userId);
string office = userProps[8]; 
```

**但是，作为一个整体解决方案，**您甚至可以将这些结果添加到`DataRow`列中，并将其作为 a 的一部分返回，`DataTable`然后您可以绑定到 a`ListView`或`GridView`。我就是这样做的，发送一个`List<string>`填充了我需要的属性：

```
 /// <summary>
    /// Gets matches based on First and Last Names. 
    /// This function takes a list of acceptable properties:
    /// USERNAME
    /// MIDDLE_NAME
    /// MIDDLE_INITIAL
    /// EMAIL
    /// LOCATION
    /// PHONE
    /// OFFICE
    /// DEPARTMENT
    ///
    /// The DataTable returned will have columns with these names, and firstName and lastName will be added to a column called "NAME"
    /// as the first column, automatically.
    /// </summary>
    /// <param name="firstName"></param>
    /// <param name="lastName"></param>
    /// <param name="props"></param>
    /// <returns>DataTable of columns from "props" based on first and last name results</returns>
    public static DataTable GetUsersFromName(string firstName, string lastName, List<string> props)
    {
        string userId = String.Empty;
        int resultCount = 0;

        DataTable dt = new DataTable();
        DataRow dr;
        DataColumn dc;

        // Always set the first column to the Name we pass in
        dc = new DataColumn();
        dc.DataType = System.Type.GetType("System.String");
        dc.ColumnName = "NAME";
        dt.Columns.Add(dc);

        // Establish our property list as columns in our DataTable
        if (props != null && props.Count > 0)
        {
            foreach (string s in props)
            {
                dc = new DataColumn();
                dc.DataType = System.Type.GetType("System.String");
                if (!String.IsNullOrEmpty(s))
                {
                    dc.ColumnName = s;
                    dt.Columns.Add(dc);
                }
            }
        } 

        // Start our search
        PrincipalContext ctx = new PrincipalContext(ContextType.Domain);

        UserPrincipal up = new UserPrincipal(ctx);
        if (!String.IsNullOrEmpty(firstName))
            up.GivenName = firstName;
        if (!String.IsNullOrEmpty(lastName))
            up.Surname = lastName;

        PrincipalSearcher srch = new PrincipalSearcher(up);
        srch.QueryFilter = up;

        using (PrincipalSearchResult<Principal> results = srch.FindAll())
        {
            if (results != null)
            {
                resultCount = results.Count();
                if (resultCount > 0)  // we have results
                {
                    foreach (Principal found in results)
                    {
                        // Iterate results, set into DataRow, add to DataTable
                        dr = dt.NewRow();
                        dr["NAME"] = found.DisplayName;

                        if (props != null && props.Count > 0)
                        {
                            userId = GetUserIdFromPrincipal(found);

                            // Get other properties
                            string[] userProps = GetUserProperties(userId);

                            foreach (string s in props)
                            {
                                if (s == "USERNAME")                   
                                    dr["USERNAME"] = userId;

                                if (s == "MIDDLE_NAME")
                                    dr["MIDDLE_NAME"] = userProps[3];

                                if (s == "MIDDLE_INITIAL")
                                    dr["MIDDLE_INITIAL"] = userProps[4];

                                if (s == "EMAIL")
                                    dr["EMAIL"] = userProps[5];

                                if (s == "LOCATION")
                                    dr["LOCATION"] = userProps[6];

                                if (s == "PHONE")
                                    dr["PHONE"] = userProps[7];

                                if (s == "OFFICE")
                                    dr["OFFICE"] = userProps[8];                                    

                                if (s == "DEPARTMENT")
                                    dr["DEPARTMENT"] = userProps[9];
                            }
                        }
                        dt.Rows.Add(dr);
                    }
                }
            }
        }

        return dt;
    } 
```

你可以这样调用这个函数：

```
string firstName = txtFirstName.Text;
string lastName = txtLastName.Text;

List<string> props = new List<string>();
props.Add("OFFICE");
props.Add("DEPARTMENT");
props.Add("LOCATION");
props.Add("USERNAME");

DataTable dt = GetUsersFromName(firstName, lastName, props); 
```

将`DataTable`填充这些列，并将一`NAME`列作为第一列，该列将具有`.DisplayName`来自 AD 的用户实际值。

**注意：** 您必须引用`System.DirectoryServices`and `System.DirectoryServices.AccountManagement`, `System.Text.RegularExpressions`,`System.Data`才能使用所有这些。

！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-11-22T21:42:47.960

我在这篇文章中寻找的代码是：

```
 string uid = Properties.Settings.Default.uid;
        string pwd = Properties.Settings.Default.pwd;
        using (var context = new PrincipalContext(ContextType.Domain, "YOURDOMAIN", uid, pwd))
        {
            using (UserPrincipal user = new UserPrincipal(context))
            {
                user.GivenName = "*adolf*";
                using (var searcher = new PrincipalSearcher(user))
                {
                    foreach (var result in searcher.FindAll())
                    {
                        DirectoryEntry de = result.GetUnderlyingObject() as DirectoryEntry;
                        Console.WriteLine("First Name: " + de.Properties["givenName"].Value);
                        Console.WriteLine("Last Name : " + de.Properties["sn"].Value);
                        Console.WriteLine("SAM account name   : " + de.Properties["samAccountName"].Value);
                        Console.WriteLine("User principal name: " + de.Properties["userPrincipalName"].Value);
                        Console.WriteLine("Mail: " + de.Properties["mail"].Value);

                        PrincipalSearchResult<Principal> groups = result.GetGroups();

                        foreach (Principal item in groups)
                        {
                            Console.WriteLine("Groups: {0}: {1}", item.DisplayName, item.Name);
                        }
                        Console.WriteLine();
                    }
                }
            }
        }
        Console.WriteLine("End");
        Console.ReadLine(); 
```

似乎任何字符的通配符都是星号 (*)。这就是为什么：

```
user.GivenName = "*firstname*"; 
```

[在Microsoft 文档](https://msdn.microsoft.com/en-us/library/ms676892(v=vs.85).aspx)中阅读更多信息

# .net - 在不使用 Office 自动化的情况下生成 PowerPoint 演示文稿有哪些技巧？

> ID：825247
> 
> 赞同：6
> 
> 时间：2009-05-05T14:53:07.530
> 
> 标签：.net, ms-office, powerpoint, openxml

虽然可以[使用 Office 自动化自动生成 PowerPoint 演示文稿](http://support.microsoft.com/kb/303717)，但[不建议在服务器上使用](http://support.microsoft.com/kb/257757)。如何在不使用 Office 自动化的情况下生成 PowerPoint 演示文稿？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-08T12:44:43.213

另一个没有被提及的选项，也就是我们最终采用的方法，是通过[兼容包使用 Office 2007 和 Office XP 中原生支持的](http://www.microsoft.com/downloads/details.aspx?FamilyId=941B3470-3AE9-4AEE-8F43-C6BB74CD1466&displaylang=en)[Open XML](http://msdn.microsoft.com/en-us/library/aa338205.aspx)文件格式。使用[Open XML SDK 1.0](http://www.microsoft.com/downloads/details.aspx?FamilyId=AD0B72FB-4A1D-4C52-BDB5-7DD7E816D046&displaylang=en)让某些东西工作起来非常简单。

首先，准备了一个通用模板文件，其中放置了标记来代替需要替换的内容。接下来，需要将 DocumentFormat.OpenXml 的引用添加到项目中。代码本身将引用 DocumentFormat.OpenXml 和 DocumentFormat.OpenXml.Packaging 命名空间。最后，遍历幻灯片的代码如下所示：

```
// Open the presentation
PresentationDocument presentation = PresentationDocument.Open(fileName, true);
// Loop through all of the slides in the presentation
foreach (SlidePart slide in presentation.PresentationPart.SlideParts)
{
    // Read the XML out of the slide
    XmlDocument xml = new XmlDocument();
    xml.Load(slide.GetStream());

    // TODO: Your XML manipulation code here

    // Save the updated slide
    xml.Save(slide.GetStream());
}
// Save the updated presentation
presentation.Close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T22:37:43.870

您可以编写一些使用可以生成 PowerPoint 格式文档的库的服务器端代码。例如，在 Java 中，您可以使用[Apache POI-HSLF](http://poi.apache.org/slideshow/index.html)以编程方式生成 PPT 文件。

根据您需要做的事情，从“模板”PPT 文件开始并以编程方式对其进行修改以插入或编辑内容可能会减少工作量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T22:44:45.837

如果你的服务器端技术是 ASP.NET，你可以使用[Aspose.Slides](http://www.aspose.com/categories/file-format-components/aspose.slides-for-.net-and-java/default.aspx)。它非常强大并且运行良好，尽管它可能不是一个具有成本效益的解决方案，具体取决于您想要做什么。

# python - 在管理界面上更改/调整日期小部件

> ID：825253
> 
> 赞同：2
> 
> 时间：2009-05-05T14:55:00.723
> 
> 标签：python, django, date, widget

我正在为我的新应用程序配置管理站点，但我发现我的设置有一点问题。

我的数据库中有一个“出生日期”字段，可通过管理站点进行编辑，但是，日期小部件不是很方便，因为如果我必须在小部件中输入 01-04-1956，我将不得不翻页很多年。此外，我不希望人们仅在一个编辑框中手动编写完整日期，因为使用破折号或斜杠作为分隔符，或者以欧洲、美国或亚洲格式引入日期总是存在问题......

McGyver（我的意思是你）会怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T15:11:46.253

使用[formfield_overrides](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.formfield_overrides)选项来使用不同的小部件。例如（未经测试）：

```
class MyModelAdmin(admin.ModelAdmin):
    formfield_overrides = {
        models.DateField: {'widget': forms.TextInput},
    } 
```

然后您需要自己进行日期转换/验证。

# c# - 文字自动化：检测是否需要分页符？

> ID：825254
> 
> 赞同：5
> 
> 时间：2009-05-05T14:55:03.033
> 
> 标签：c#, automation, ms-word, break

我正在使用 C# 编写一个项目，该项目将使用 Word Automation API 生成 Word 文档。

我想在生成的文档中的特定点插入分页符，我目前正在使用以下代码成功执行此操作：

```
// Generate page break
object pageBreak = WdBreakType.wdPageBreak;
wordApp.Selection.InsertBreak(ref pageBreak); 
```

但是，如果文档在上一页的空间不足之后自然地换到下一页，那么我真的不想生成分页符，否则我最终会得到一个空白页。

我真正想要的是能够准确找出光标的位置，如果它在当前页面的第一行和第一列，那么我可以安全地假设没有必要插入分页符。

有没有办法访问光标的位置？或者另一个可以做同样事情的解决方案？这似乎是一个简单的要求，所以如果我错过了明显的，我提前道歉。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T22:46:42.557

假设您以编程方式构建文档的方式会导致 wordApp.Selection 正确反映您在文档中的实际（和相关）位置，您可以使用其 Information 属性和以下两个属性确定其起始页上的行和列WdInformation 枚举（此处显示为 VBA；不确定 .NET PIA 语法是什么）：

```
line = wordApp.Selection.Information(wdFirstCharacterLineNumber)
col = wordApp.Selection.Information(wdFirstCharacterColumnNumber) 
```

这些值对应于 Word 状态栏中的 Ln 和 Col 值。如果它们都等于 1，那么您位于选择开始的页面的第一个位置。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T23:16:00.750

您可以尝试在段落上设置属性，使其前面有分页符。如果 Word Automation API 允许设置它，我不会，但它似乎正是您所需要的。

# database - 您是否创建类来处理数据驱动应用程序的“实体”？

> ID：825257
> 
> 赞同：2
> 
> 时间：2009-05-05T14:55:24.903
> 
> 标签：database, language-agnostic, database-driven

我是一个新手，在创建数据库应用程序时我总是只是创建我的表单并将所有代码和绑定放在那里。我没有使用包含信息的数组和列表，而是直接对数据库进行了更改。

现在我已经发展了一点，假设我向客户销售小部件并将销售信息保存在数据库中。如果我正在编写一个程序来访问数据库，我不想创建一个类型为“客户”和“小部件”的类来处理这些实体吗？

如果我弄错了，那么编程数据库应用程序的适当方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T15:01:51.300

是的。

您想研究[n 层](http://en.wikipedia.org/wiki/Multitier_architecture)编程。

基本上，您只允许前端（表示层）访问您的类库（业务层）。然后您的类库访问您的数据库。

这为您提供了一个不那么紧密耦合的解决方案，并允许更多可维护的代码。此外，通过引入层，您可以更改数据库，而无需在前端重写代码，只要不需要更改与业务层的接口即可。

就绑定而言，如果您使用的是 Visual Studio Windows Forms（2005 及更高版本），您应该能够使用[bindingSource](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingsource(VS.80).aspx)，然后您可以使用它来绑定您的控件。如果您使用的是 ASP.NET，那么您的控件应该毫无问题地绑定到对象列表。

对于 ASP.Net，[ObjectDataSource](http://msdn.microsoft.com/en-us/library/9a4kyhcx.aspx)可能值得研究。我自己没用过，但是网上有很多样例。试试[这里](http://www.asp.net/Learn/data-access/tutorial-04-cs.aspx)或[这里](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/objectdatasource.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T15:04:59.653

是的。

您想仔细查看[Object-Relational Mapping](http://en.wikipedia.org/wiki/Object-relational_mapping)。

您的真实业务实体由映射到关系表的对象建模。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T16:40:42.950

您不希望您的表示层直接依赖于您的数据库结构；问题在于，如果您的数据库结构发生变化，您的表示层必须发生变化，从长远来看，这往往会导致问题。此外，让表示层直接与数据库交互还涉及安全问题。

这里粗略的类比是市场。当你去商店买一条面包时，你不需要知道怎么种小麦；你只需要知道你有钱，他们有面包，他们会用一定数量的面包换成一定数量的钱。你不需要知道一年中什么时候种小麦，或者如何去除谷壳，或者任何其他的，因为背衬层会为你处理这些。同样，农民不需要知道如何向一大群人出售面包，甚至不需要知道如何制作面包；他所要做的就是知道如何种植小麦。

现代设计理念建议您使用中间层在表示层和数据库层之间进行交互；这是您放置业务逻辑的地方。例如，假设您在您的网站上销售小部件。不是让您的演示代码查询数据库中的小部件并显示它，而是拥有一个处理您的小部件的业务对象。这样，您的业务对象需要知道您的数据库结构是什么，而您的表示层只需要知道如何向您的业务对象询问要显示的小部件列表。更重要的是，在您的业务对象中，您可以放置​​在某些事情发生时要调用的规则。因此，当您下订单时，您的表示层不会直接更改库存和订单数据库，

通过这种方式，您将信息的显示与网站的持久性和逻辑分开。所涉及的是良好的规划；具体来说，您必须弄清楚您的网站在任何给定时间点将做什么，以及就您的业务对象将提供的接口而言，这意味着什么。然后根据这些需求实现业务对象；这些业务对象是您放置数据库结构和特定业务逻辑知识的地方（“当 A 发生时，执行 B，然后执行 C”等）。

一开始这似乎是很多额外的工作，但它确实是值得的。

# architecture - 记录 Web 应用程序流/迭代

> ID：825261
> 
> 赞同：7
> 
> 时间：2009-05-05T14:55:50.690
> 
> 标签：architecture, web-applications, documentation, uml, diagram

考虑到静态页面之间的链接以及动态视图组件（html 表单、JSP、Ajax 等）如何与服务器端组件（Servlet、Struts 操作等）交互，使用哪些工件/图表来记录 Web 应用程序的流程? 使用 UML 图吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-15T03:46:19.060

我们使用 UML 类图，使用 Conallen 的文章[Modeling Web Application Design with UML](http://www.itmweb.com/essay546.htm)的变体。你会发现这篇文章已经在网络上演变成[不同的化身，](http://www.google.com/search?q=web+application+uml)甚至成为一本书[Building-Web-Applications-UML-2nd](https://rads.stackoverflow.com/amzn/click/com/0201730383)。

我对我们使用的方法的 2 美分之旅：

根据 Conallen 的论文，我们定义了一个新的 UML 实体（原型）来表示网页或页面的一部分，以便我们可以区分服务器端代码（例如 Java servlet 或 JSP）和客户端 HTML/javascript/AJAX它生成的。例如：

*   [网页]
*   [导航栏]
*   [页面内容]
*   [标题]
*   [页脚]

有新的协会，例如：

*   [构建] - 将服务器端代码与其生成的网页或页面片段相关联
*   [apparent-link] - 在站点地图图表上的客户端页面之间使用
*   [link] - URL 链接，即 GET 请求
*   [提交] - 表单回传到服务器，即 POST 请求
*   [client-redirect] - 客户端重定向
*   [服务器重定向] - 呃

最后，一些新的图表（主要是类图的特殊化），例如：

*   [站点地图] -> 类似于类图 - 从用户的角度显示 [网页] 之间的静态关系（[表观链接]）
*   [page-generation] -> 像类图 - 显示与显示特定网页静态相关的类：生成它的代码，处理帖子提交的代码
*   [page-composition] - 就像一个类图 - 显示构成给定 [web-page] 的内容
*   [序列图] - 唯一的其他变化是序列图现在可以包含客户端实体作为参与者。

*好消息：*

*   我们发现了我们需要的 Rational Rose 图标扩展来使图表看起来有点像样。

*坏消息：*

*   这种方法工作量很大——我们现在要建模的实体数量是原来的两倍，因为我们现在除了对服务器端类进行建模之外，还对客户端实体进行建模。

阅读 Conallen 的一篇论文，了解我正在谈论的内容，但正如我所说，并没有严格遵循他的方法——我们只取了我们需要的部分。希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-13T19:39:51.660

过去，我使用 UML 状态图来记录 Web 应用程序的页面导航。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-15T14:00:03.400

我建议采用 37signals 方法进行应用程序开发。

每个页面都需要有目的。首先专注于这个目的，然后围绕它设计其他一切。

过程：

*   [用记号笔和纸](http://37signals.com/svn/posts/466-sketching-with-a-sharpie)勾勒出主要部分
*   项目清单
*   [尽早忽略细节](http://37signals.com/svn/archives2/getting_real_ignore_details_early_on.php)（他们只是碍事）
*   尽快创建一些真实的东西（即创建一些带有指向其他页面的链接的 html 文件，以显示应用程序将如何流动
*   一旦设置了站点的流程，然后添加设计组件并开始编程

将编程添加到已经设计和考虑过的东西上比设计应用程序来解决现有编程要容易得多（在大多数情况下，这需要重写代码以适应一开始遗漏的设计/流程问题）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-12T21:43:02.043

Use cases as part of activity diagrams are used by some of mine colleagues, but this is good maybe for some static high level navigation overview.

I am about to develop custom DSL, which will resemble BDD scenario format used in Cucumber with Webrat, IMHO such scenarios contain enough information to create interactionand web page models.

# php - 在 PHP 中通过 shell_exec 压缩文件：路径问题

> ID：825263
> 
> 赞同：1
> 
> 时间：2009-05-05T14:56:17.537
> 
> 标签：php, shell, zip, sudo, shell-exec

我正在开发一个网络备份服务部分，其中允许用户下载一个 zip 文件，其中包含他们从备份的列表中选择的文件。

压缩过程是通过 shell_exec 命令完成的。为此，我已授予 apache 用户 no-password sudo 对 zip 命令的权限。

我的问题是，因为我不能对包含用户备份文件的文件夹执行“sudo cd /path/to/user/files”，所以我需要指定要压缩的文件的完整绝对路径，然后进入我不想要的 zip 文件。

这就是我的意思：

用户“test1”备份了他们的文件，这些文件存储如下
/home/backups/test1/my pics/pic1.jpg
/home/backups/test1/my pics/pic2.jpg
/home/backups/test1/my图片/pic3.jpg
/home/backups/test1/hello.txt
/home/backups/test1/music/band/song.mp3

当这些文件被压缩时，它们会保留完整的路径，但我只想显示：
my pics/pic1.jpg
my pics/pic2.jpg
my pics/pic3.jpg
hello.txt
music/band/ song.mp3

有没有办法告诉 zip 截断路径，或者为每个文件指定一个自定义路径？
或者有什么方法可以将工作目录更改为用户的根备份文件夹，这样我就可以简单地指定相对文件路径。

感谢您的阅读，希望您能走到这一步，这一切都是有道理的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T15:46:00.163

I have to slightly question why you are making a potentially dangerous system shell call when there are a number of good PHP zipping classes around. The [tutorial here](http://www.granthinkson.com/2005/07/01/create-zip-files-dynamically-using-php/) shows how to easily create a class that will output a zip file to the browser. There is also a number of classes on phpclasses.org, [this seems to be the best one](http://www.phpclasses.org/browse/package/2322.html).

If you *have* to do it with a system call my suggestions are:

To truncate the path for the file you could use [symbolic links](http://en.wikipedia.org/wiki/Ln_(Unix)).

Can you not increase the permissions of the zip executable to mean that apache can use it without using sudo?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-06T23:03:53.707

一个更好的主意可能是制作一个 shell 脚本，并授予网络服务器 sudo 访问该 shell 脚本的权限。这也可能更安全

```
#!/bin/bash
#
# Zip up files for a given user
# 
# usage: backupToZipFile.sh <username>

cd home/backups/$1
tar -czf /tmp/$1.tgz . 
```

您是否还考虑过以尝试压缩文件的用户身份运行 sudo 而不是 root 用户？这也会更安全。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T15:08:00.940

您是否尝试过使用[`chdir()`](http://www.php.net/chdir)更改工作目录？

```
chdir('/home/backups/test1/'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T15:29:43.150

这似乎是一个简单的选择，但根据`man`它只是不存在。您当然可以将要存档的内容符号链接到您将创建 zip 文件的位置（我假设您实际上可以 cd 到该目录）。使用正确的选项，`zip`将不会归档符号链接本身，而是使用符号链接的名称归档符号链接文件。

例如，创建符号链接 /tmp/$PID/my pics/pic1.jpg 等，然后将所有内容压缩到 /tmp/$PID。

# design-patterns - 我应该使用什么模式将报告处理到基础架构中以允许各种表示？

> ID：825264
> 
> 赞同：5
> 
> 时间：2009-05-05T14:56:23.433
> 
> 标签：design-patterns

刚开始学习模式。这是我的一个简单问题。

我有一个`Report`包含`Page`s 的对象，每个对象都包含各种`ReportElement`s ( `Table`, `Paragraph`, `Image`) 等等。假设我想创建一个基础设施来获取`Report`和吐出各种表示形式，`Report`例如 RTF 格式的文档、TeX 格式的文档、HTML 文档等。

我在这里寻找哪种设计模式？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-05T14:58:38.843

我相信的[策略。](http://en.wikipedia.org/wiki/Strategy_pattern)

您可以创建一个 RTFReportGenerator、一个 HtmlReportGenerator 等……它们都实现了相同的“IReportGenerator”接口，但每个具体类都以不同的方式实现“WriteReport(Report r)”方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T15:59:59.070

对于一组有组织的对象，[访问者](http://en.wikipedia.org/wiki/Visitor_pattern)模式也适用。这可以更好地处理对象结构的遍历，根据您的需要，您可以将它用于需要将您的报告作为一个组来处理的其他任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T16:06:48.663

我可能会使用 Composite 模式来表示报表元素树，并使用 Visitor（如 Harald 所说）将报表对象转换为特定的具体表示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T15:09:00.597

不要寻找具体的模式。许多模式具有相同的结构，但目标不同。无论如何，您总是必须对模式进行一些更改才能在您的具体案例中使用它。在学习了模式之后，您将能够正确地思考对象及其关系。

您可以为不同的表示使用策略，您可以使用构建器来创建您的报告。

你也可以使用更简单的东西。就像委托和继承的结合（对我来说，这是您问题的最佳解决方案）。只需创建表示的层次结构（BasicView<|-- RTFView, TextView...）并将 Report 传递给 BasicView 构造函数。让不同的视图对原始报表提供不同的数据转换。

# javascript - 在 Jquery 中使用收音机令人头疼

> ID：825265
> 
> 赞同：0
> 
> 时间：2009-05-05T14:56:43.730
> 
> 标签：javascript, jquery

我有 2 台收音机：

```
<input id="a_15_0" type="radio" value="abc" name="a_15"/>
<input id="a_15_1" type="radio" value="xyz" name="a_15"/> 
```

两者都未选中。我只有收音机的名称，即`a_15`，但没有 ID。

**1）**我怎样才能得到这个收音机的选定选项的值？例如，如果用户点击了“xyz”，我怎样才能得到它？现在我正在使用：

```
var val=$('[name="a_15"]').val(); 
```

即使选择了 xyz，它也总是给出 abc 。

**2)**如何在不知道显示 xyz 的收音机 ID 的情况下通过 javascript 选择 xyz？正在做：

$('[name="a_15"]').val('xyz');

将两个无线电的值更改为 xyz，而不是选择其值为 xyz 的无线电。

我需要使用`document.myForm.a_15.value`吗？这会一直有效吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T15:01:12.283

1）尝试

```
var val = $('input[name=a_15]:checked').val(); 
```

[已检查伪类的 jQuery 文档](http://docs.jquery.com/Selectors/checked)

2）我找到的唯一解决方案是

```
$('input[name=a_15][value=xyz]').get(0).checked=true 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T15:00:43.550

[jQuery](http://docs.jquery.com/Selectors)中有多种选择器的方式；id、class 等。我相信这可以完成工作，未经测试：

```
var val= $("input[name=a_15]:checked").val(); 
```

如果您知道表格的名称，那么这肯定会做到

```
var val= jQuery('#radio_form input:radio:checked').val(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T15:02:34.013

您是否尝试过将 val() 与 :checked 选择器结合使用？

```
$('[name="a_15"]:checked').val(); 
```

至于根据值设置选择，您可能需要执行多个属性测试？

```
$('[name="a_15"][value="xyz"]').get(0).checked = true; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T15:15:56.507

你在这里有正确的代码：

[跑步](http://jsbin.com/ebibi)

[编辑](http://jsbin.com/ebibi/edit)

正确的形式是：

```
$("input[name='a_15']:checked").val(); 
```

您可以使用上面的链接进行测试

# version-control - TFS 流程指导模板锁定？

> ID：825266
> 
> 赞同：6
> 
> 时间：2009-05-05T14:57:27.473
> 
> 标签：version-control, tfs, bug-tracking, issue-tracking

我的团队正在寻求将我们的许多工具（SCM、错误跟踪、构建、测试）迁移到 TFS。我们正在考虑分阶段移动每个系统。例如，首先移动源代码控制，然后是错误/功能跟踪等……

由于我们必须选择一个流程模板来使用源代码控制（或 TFS 中的任何东西）**，我们对决策的锁定程度如何？**我希望避免以后必须创建另一个项目（或者这不像我想象的那么糟糕？）。

**我知道我理论上可以在事后自定义流程模板配置的所有内容（对吗？），但这在实践中有多可行？**

以下是我对事情发生的看法：

1.  我们迁移我们的源代码。我们选择微软的 CMMI 模板。
2.  我们创建了一个新的工作项（或签到说明），它是我们遗留错误跟踪系统的简单链接。
3.  我们工作一段时间。
4.  我们等到*有权力*（我们是一家规模相当大的软件公司）制定新的 TFS 开发工作流程。这可能是新工作项的简单集合或配置各种东西的全新模板。
5.  我们尝试在不丢失历史记录的情况下将我们的 TFS 项目迁移到这个新系统。

**我们是否会后悔我们没有等到所有这些决定都完成后才使用 TFS？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T19:38:04.427

因此，考虑您的流程模板是正确的，因为存在一定数量的“锁定”，但它并不太严重。就像你被蜂蜜而不是超级胶水粘在你的工艺模板上一样。

就个人而言，我将从 MSF Agile 模板开始。它的重量更轻，包含的工作项目更少——所以你更倾向于向它添加东西（在 TFS 中很容易，得到很好的支持）而不是把它们拿走（更复杂且不完全令人满意）。

但是，如果权力决定采用超级流程定义流程并在 12 个月内神奇地提出一个他们希望您使用的新流程模板，那么它并没有完全丢失。如果您发现要创建一个全新的团队项目，只要它在该服务器上（或 TFS 2010 中的项目集合），那么您可以将您的代码分支到新的团队项目（这意味着历史有点在当前版本的 TFS 客户端中隐藏）或者您可以创建一个新的团队项目，其中包含一个用于源代码控制的空文件夹，然后将子文件夹从旧团队项目移动到新项目。这将完美地保留历史，因为 TFS 会为同一 TFS 实例上的移动保留历史。

显然，通过在实际项目中实际使用 TFS 12 个月，当你受到打击时，你也将处于一个更好的位置，知道你希望你的闪亮的新流程模板看起来像什么 - 我经常发现这是一个从未发生过的练习，大多数人都乐于在 MSF 敏捷的边缘修修补补，或者选择更具规范性的东西，比如[Scrum For Team System](http://scrumforteamsystem.com/)。

希望有帮助，

马丁。

# php - 使用 php mail() 在电子邮件标题中包含什么？

> ID：825268
> 
> 赞同：1
> 
> 时间：2009-05-05T14:58:19.437
> 
> 标签：php, email, header

当我想发送电子邮件时，我的代码如下所示：

```
$headers =  'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
$headers .= 'From: me@localhost' . "\r\n";

// Email Variables
$toUser  = 'you@something';
$subject = "Testing";
$body    = '<html><head><title></title></head><body>
            This is my picture <img src="http://domain.com/me.jpg">';

if(mail($toUser,$subject,$body,$headers)){
  echo "Email sent!!";
} 
```

以下是我的问题：

1.  我必须包含`<html>, <head>, <title>...`标签吗？
2.  我可以使用样式表吗？例如，`<div style="...">`？
3.  我测试了将电子邮件发送到多个帐户，如果我包含`<img>`标签（用于包含图像），它会进入垃圾邮件，但如果只是纯文本，它会进入收件箱。有人知道为什么吗？以及如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T15:08:54.277

您也应该将您的电子邮件`multipart`与`text/plain`一部分一起发送。

这将让拥有纯文本邮件客户端的人阅读它，并且在任何垃圾邮件检测系统中都对您有利。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-20T23:07:05.110

邮件中的 css 问题是（再次）不是所有邮件服务的标准

这里会找到一个完整的描述

[http://www.campaignmonitor.com/css/](http://www.campaignmonitor.com/css/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T15:04:10.747

1.  不，一些邮件客户端（尤其是 webmail）会删除之前的任何内容`<body>`
2.  您可以使用内联样式`<div style="">`- 不建议使用外部 .css 文件，因为它可能无法加载。
3.  如果您只有一点文本和图像，它看起来很像垃圾邮件。如果你有更多的文字，它可能会得到不同的对待。

# .net - 如何使用参考程序集正确部署示例源？

> ID：825271
> 
> 赞同：0
> 
> 时间：2009-05-05T14:58:45.613
> 
> 标签：.net, visual-studio-2008, setup-project

我正在开发一个 .NET 类库以及一些示例源。因此，我的解决方案包括库、用于说明库的示例 VB 以及用于部署它的安装项目。

该示例对类库具有项目依赖关系，安装项目被配置为部署类库（即.NET 类库项目的输出）和 VB 应用程序的源代码。

问题是 VB 应用程序的 vbproj 文件包含项目依赖项（即它引用类库的 .csproj）。

我想要实现的是，当源代码部署在客户端机器上时，它是一个独立的项目，它依赖于（刚刚安装的）类库 DLL。

我怀疑我需要对 vbproj 文件进行一些安装后操作，但由于我是新手，我想知道这个（我会想到的）常见问题是否可以轻松处理？

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T15:04:46.770

我的建议是将您的两个项目分成两个解决方案 - 一个用于库，一个用于 VB 示例项目。

然后，您的 VB 示例项目可以直接引用库的 DLL，而不是对项目的引用。这更接近您计划“部署”此示例的方式，因此您无需在事后进行任何操作。

在编写库时，这可能会更加困难，因为您将维护两个项目，但如果您的库已经成熟，这种方式会更干净。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:05:05.253

您可以删除“项目依赖项”，而是将“程序集引用”添加到您的 VB 项目中。

# vb.net - 使用 ThreadPool.QueueUserWorkitem 生成线程时签名不兼容

> ID：825276
> 
> 赞同：0
> 
> 时间：2009-05-05T15:00:57.557
> 
> 标签：vb.net, multithreading, threadpool

错误是：

> 方法“Private Sub ProcessToolWork()”没有与委托“Delegate Sub WaitCallback(state As Object)”兼容的签名。

这是怎么回事？我从未经历过以这种方式产生线程的错误。

这是我的常规定义：

```
Public Sub ProcessWork()
      ThreadPool.QueueUserWorkItem(AddressOf ProcessToolWork)
End Sub

Private Sub ProcessToolWork()

End Sub 
```

看出什么不对了吗？

我也尝试过为这个项目制作一个新的 WaitCallback ，如下所示：

```
ThreadPool.QueueUserWorkItem(New WaitCallback(AddressOf ProcessToolWork)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T15:04:32.730

[WaitCallback](http://msdn.microsoft.com/en-us/library/system.threading.waitcallback.aspx)接受一个`state`参数（类型为`Object`）。即使你忽略它，你也必须把它放在你的方法签名中：

```
Private Sub ProcessToolWork(ByVal ignored As Object)

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-02T02:11:00.620

我自己也遇到过同样的事情。就在进行“最终”编译之前，我将 Option Strict 设置为“on”，然后出现了这个错误。

注意：这是 Option Strict，而不是 Option Explicit。

因此，如果您尝试使用 Option Strict 进行编译，则只需要提供“Byval ignored As Object”参数。

# process - 销售个人项目/产品的首选流程是什么？

> ID：825280
> 
> 赞同：11
> 
> 时间：2009-05-05T15:01:34.217
> 
> 标签：process

我已经开始着手一个个人项目，该项目最终可能具有一些现实世界的适用性。我开始接受出售许可证的想法。我敢肯定这里的其他一些人以前也这样做过，我想知道您曾经使用过哪些成功的流程。

关于许可、法律影响等有很多关于 SO 的问题。但是，我环顾四周，找不到这个问题的重复问题。需要说明的是，**我不是在寻找有关使用*何种*许可策略、*如何*宣传您的软件等等的信息，而是寻找应该做的事情的*清单*以增加成功的可能性，以及任何可能的陷阱我没有想到。**如果有人有任何个人成功的故事，他们将非常受欢迎。

对于一些背景知识，我的想法是许可一个封闭源代码的编译 .NET DLL。

我脑子里有几件事：

*   强大的文档，因为不太可能提供正式的技术支持
*   指定许可条款并与律师正式确定
*   代码混淆
*   探索许可证执行（使用商业包或自定义代码）
*   围绕产品建立一个网站，包括真实世界的代码示例，因为这是一个库
*   可能会提供某种类型的测试期，以获取反馈并稍微宣传一下名称
*   提供即时/自动购买
*   营销（天哪）

开一家单人公司来做这件事有必要（或明智）吗？

当答案出现时，我会更新这个列表。谢谢大家！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T15:24:37.890

一些技巧：

混淆：小心混淆一切。另一种方法是仅混淆关键位（许可、高级功能）。混淆所有内容的问题在于错误报告中的堆栈跟踪无效。当捕获到意外异常时，您将希望为用户提供自动报告其详细信息的选项 - 这确实有助于 QC。

许可证执行：如果它是一个很容易被盗版的实用程序，人们就会盗版它。基于激活的许可系统是理想的——如果它不是太严苛，人们将不太愿意规避它。例如，允许每个用户（家用计算机、工作计算机、笔记本电脑）至少进行 3 次激活。如果它是一个控制库，那么可能不需要基于激活的 - 将序列号烘焙到库中可能就足够了，因为客户不太可能在被盗的组件上构建自己的产品。

即时/自动购买：为此编写自定义许可服务器和网页相当容易——您只需要大约 3 个表格。LINQ to SQL 非常适合这类事情。对于支付网关，我使用 PayPal——它非常易于设置，具有销售激活码所需的功能，并且允许使用多种货币。如果您使用 PayPal，请同时启用 PDT 和 IPN，这样您就可以在屏幕上和通过电子邮件向客户提供他们的激活码。

营销：同时尝试很多事情——因为很难预测任何活动的成功。尤其是没有经验！让自己在你所销售的领域的有影响力的人中广为人知可以很好地工作。

广告：在 StackOverflow 上做广告——这就是我正在做的事情！谷歌广告词也值得一试，因为它的设置非常便宜——花 10 美元后你就会知道它是否对你有效。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T15:12:46.797

你列出了大部分实际的东西，就实际从你那里得到一个产品给客户而言——

但是，我也推荐几件事。

*   弄清楚你想如何处理所有的会计/采购/计费/等。
*   重新考虑正式的技术支持（为了钱），但不排除文档
*   与律师讨论您的所有许可决定、协议等以及公司结构
*   和你的会计师谈谈（和/或找一个擅长与小型科技公司合作的人）

其中一些会在前期花费一些钱，但以后会省去麻烦。

最后两个要点很重要——从税收的角度来看，有很多选择可以帮助您进行自我设置，根据您的具体情况，每种方法都有潜在的优势和劣势。

例如，如果您在美国，在您的清单上做任何事情之前注册公司有很多好处。如果您决定合并，您可能希望在您所在的州进行合并，但在内华达州或新泽西州（法律上非常支持公司的州）合并也有优势。如果你成功了，尽早做这件事可以随着时间的推移节省大量的工作并带来显着的好处。

此外，如果您合并，您可能需要考虑 S 与 C 军团（如果您是一两个人的行动，S 军团很棒）。如果您不合并，您可以作为独资企业或有限责任公司运营，两者各有利弊。这在很大程度上取决于您的产品（它的作用），您的预期回报等 - 拥有一位优秀的律师和一位优秀的会计师是一个巨大的祝福。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T16:29:48.607

如果您的目标是软件开发团队作为客户，那么他们可能期望看到的东西（除了您列出的那些）是：

1.  用户可能需要的任何附加项目和/或补丁的下载服务。
2.  严格的版本控制/配置管理流程，以便轻松找出他们拥有的产品版本、他们需要什么以及版本之间的差异。
3.  电子邮件/在线错误报告。
4.  产品的演示/试用版。
5.  一套很好的教程。
6.  社区支持，例如开发者论坛。这是一项很好的“增值”服务，它还有助于解决您（作为一家单人公司）对能否提供“正式技术支持”的担忧。发放一些徽章和声誉分数并获得免费的技术支持团队;) ...但如果销售起飞，认真考虑提供“正式的技术支持”，它可以对产品的认知产生巨大的影响。

...并确保网站、下载服务、许可证服务器、论坛等都得到妥善保护，并符合专业标准。如果任何外围服务低于 100%，那么这一切都会对产品造成不良影响，尤其是当您的产品是技术产品时。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T16:59:06.120

您可能不想提供正式的技术支持，但您可以寻找创造性的替代方案，例如某种主持论坛来解决问题。另外，至少提供一个电子邮件地址，以便某人与您联系。

另一件事是聘请某种设计师来使您的产品、文档、网站等看起来不错。告诉尝试设计的程序员通常很容易。

# java - 异常应该放在单独的包中吗？

> ID：825281
> 
> 赞同：30
> 
> 时间：2009-05-05T15:01:46.743
> 
> 标签：java, exception-handling

我正在进行一个项目，其中所有异常都放在一个单独的包`com.myco.myproj.exceptions`中。

这是好习惯吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-05-05T15:05:04.943

我希望该包中存在包的例外情况。例如

```
com.oopsconsultancy.models.pricing 
```

将包含定价模型和相关的例外情况。其他任何事情似乎都有点违反直觉。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-05-05T15:11:18.017

这是一种不好的做法。

这是一个巧合的分组。包应该是连贯的。不要将异常、接口、枚举、抽象类等分组到自己的包中。改为对相关概念进行分组。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-05-20T07:05:42.800

这将是一种**不好的做法**，并且会导致不必要的包间依赖关系。自定义异常类应始终定义在与能够抛出它的类相同的包中。您应该尽量减少创建在整个应用程序中使用的自定义异常，为此使用**Exception**。自定义异常，顾名思义就是自定义异常，应该专注于特定的部分。这对于自定义实用程序类应该是相同的。

包应该能够呈现单个功能单元。请参阅[此](https://docs.oracle.com/javase/tutorial/java/package/packages.html)示例。*将被抛出的自定义异常是该功能单元的一部分，并且应该在同一个包*中。

前任：

```
// Below should be in a single package
interface Draggable{}
abstract class Graphic{}
class Circle extends Graphic implements Draggable{}
class Box extends Graphic implements Draggable{}
final class GraphicValidator {// utility  class}
// don't put below in a separate 'exceptions' package, 
// who's gonna use it anyway other than the components in this package ?
class GraphicRenderingException extends Exception{} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-09-24T07:49:19.930

在我看来，问题在于您希望文件系统强调的内聚类型。

将异常与异常、服务与服务、常量与常量等分组称为**逻辑内聚**，一般认为是弱内聚。

根据事物对单一且定义明确的任务的贡献这一事实进行分组，例如`usermanagement`，或`authentication`称为**功能凝聚力**，并且被认为比逻辑凝聚力更强大和更可取。在此模型中，与用户管理相关的异常将与其他专用于用户管理的类一起进入 usermanagement 包。在这个模型中，我们根据它们的功能角色对事物进行分组，而不是基于它们是实体的“种类”——例如“例外”。

所以是的，我也将汤姆霍廷的答案加倍。这不是一个好的做法。

要了解更多关于凝聚力的信息，一些来源是[geeksforgeeks](https://www.geeksforgeeks.org/software-engineering-coupling-and-cohesion/)和[wikipedia](https://en.wikipedia.org/wiki/Cohesion_(computer_science))。我相信你也可以找到其他来源的音调，以防你想进一步研究这个概念。

# http - 如果没有可用的连接，黑莓 HTTP 请求会立即出错吗？

> ID：825289
> 
> 赞同：1
> 
> 时间：2009-05-05T15:03:07.880
> 
> 标签：http, blackberry, java-me

我有一个 HTTP 连接，由

```
HttpConnection c = (HttpConnection)Connector.open(url); 
```

其中`url`之一是：

*   `http://foo.bar;deviceside=false`
*   `http://foo.bar;deviceside=false;ConnectionType=mds-public`
*   `http://foo.bar;deviceside=true;ConnectionUID=xxxxxxx`
*   `http://foo.bar;deviceside=true;interface=wifi`

如果由于设备未连接到网络而无法建立连接，有什么方法可以导致请求立即出错？事实上，在许多情况下超时大约需要一分钟（特别是在第一次调用从网络获取信息时`c.getResponseCode()`：）

编辑：我的意思是出错了。在一种情况下，特别是 Wifi，如果 wifi 在超时之前没有打开，它会停留几分钟，我希望它立即停止。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T15:40:48.570

在尝试建立连接之前，我使用[RadioInfo](http://www.blackberry.com/developers/docs/4.3.0api/net/rim/device/api/system/RadioInfo.html)类来检查是否存在连接以及收音机是否已打开。然后，您可以在尝试连接之前向用户显示一条消息或打开收音机（如果它已关闭），从而获得更好的用户体验。

尝试使用：

```
if (RadioInfo.getState() == RadioInfo.STATE_OFF)
OR
if (RadioInfo.getSignalLevel() == RadioInfo.LEVEL_NO_COVERAGE) 
```

连接前检查连接状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-19T09:56:50.853

我将我的帖子包含在一个线程中以更快地超时。确保您的“PostThread”捕获所有异常（并保存它们）。

```
public byte[] post(String url, byte[] requestString){
    PostThread thread=new PostThread(url, requestString);

    synchronized(thread){
        try{
            thread.start();
            thread.wait(TIMEOUT);
        }catch(Throwable e){

        }//method
    }//synch

    if (thread.isAlive()){
        try{
            thread.interrupt();
        }catch(Throwable e){

        }//method
        D.error("Timeout");
    }//endif

    if (thread.error!=null) D.error(thread.error);
    if (thread.output!=null) return thread.output;
    throw D.error("No output");
}//method 
```

还有一个`ConnectionTimeout`参数，我没有测试过：例如`socket://server:80/mywebservice;ConnectionTimeout=2000`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T15:28:32.123

不是任何可以以编程方式指定的方式。这可能很烦人，但来自移动设备（尤其是黑莓手机）的连接通常会在到达目标服务器之前通过几个不同的网络和网关：无线->运营商 APN->互联网->BES（可能）->foo。 bar 服务器，因此内置了较大的超时，以解决任何这些点的潜在延迟。

您可以从 BES/MDS 服务器（或在 JDE 中，从 MDS\config\rimpublic.property 文件）控制默认设备连接超时 - 但这可能对您没有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-23T17:33:52.100

最好从不同的线程进行超时检查，因为即使建立连接也会发生这种情况，比如说网络延迟非常高，所以你不希望用户等待这么长时间或这样的事情。

因此，在这种情况下，请从另一个线程检查当前时间减去为启动连接输入的时间是否大于您设置的时间，请使用 connection.close() 关闭连接！

# visual-studio - 使用 Visual Studio 2008 为 C++/CLI 项目部署 ClickOnce

> ID：825291
> 
> 赞同：1
> 
> 时间：2009-05-05T15:04:03.183
> 
> 标签：visual-studio, winforms, visual-studio-2008, clickonce, c++-cli

如何为 ClickOnce 部署发布 C++/CLI Windows 窗体项目？C++/CLI 项目的属性窗口不包括“发布”选项卡（就像在 C# 项目中一样）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T15:54:43.903

您可以遵循[MSDN 上手动部署 ClickOnce 应用程序的指南](http://msdn.microsoft.com/en-us/library/xc3tc5xx.aspx)。

这依赖于 Windows 软件开发工具包和命令行工具而不是 Visual Studio 来进行部署。

只是另一个注意事项 - 如果可以的话，我建议尽可能[迁移到 /clr:pure](http://msdn.microsoft.com/en-us/library/ms173253(VS.80).aspx)。如果您使用的是本机代码，这将不起作用，但如果它是一个纯 Windows 窗体应用程序，它将使部署方案更简单，因为您在 ClickOnce 中遇到 CAS 要求的问题会更少。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T18:04:24.170

您不能 ClickOnce 部署用非托管代码编写的 exe。标准方法是创建一个托管代码存根 exe 来启动您的实际应用程序。

这是一个[相关的问题](https://stackoverflow.com/questions/51686/is-it-possible-to-deploy-a-native-delphi-application-with-clickonce)。

# asp.net-mvc - ASP.NET BeginForm() 表达式语法

> ID：825294
> 
> 赞同：2
> 
> 时间：2009-05-05T15:04:26.240
> 
> 标签：asp.net-mvc, lambda

我想为 ASP.NET MVC 的 Html.BeginForm 使用基于表达式的语法（例如 Html.BeginForm<HomeController>(a => a.ActionForSubmit();) 以提高它为您提供的可测试性。

我不清楚在相应操作有参数的情况下该怎么做。例如，我有一个仅是 HTTP POST 的登录操作，它有两个参数：用户名和密码。

如果我使用基于表达式的语法，我最终会得到 Html.BeginForm<MyAccountController>(a => a.Login(null null)); - 对于 BeginForm 表达式，空对（根据操作签名是必需的）对我来说似乎是多余的。我是否错误地指定了表达式？

如果相应的操作是采用 FormCollection 实例，这将如何与表达式一起使用？

谢谢，德里克。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T15:11:10.090

您可以直接输入`string.Empty`，当您发布表格时它会被填写。

我不会传入null。它会发生什么，它将首先接受您传递给表达式的内容，然后用发布的表单中的任何内容覆盖它。我发现使用 string.Empty 而不是 null 是一种最佳做法。

# html - 模型未设置 Html.DropDownList 选择值

> ID：825296
> 
> 赞同：1
> 
> 时间：2009-05-05T15:04:29.140
> 
> 标签：html, asp.net-mvc

我有一个像这样的下拉列表：

```
<%= Html.DropDownList("SoldTo", Model.SellDealerList, "Select a Dealer")%> 
```

我使用以下代码在我的控制器中填充列表：

```
SellDealerList = new SelectList(repository.GetDealerList(), "id", "name", vehicle.SoldTo); 
```

当我通过代码进行调试时，SellDealerList 上的选定值具有正在设置的值，但 HTML 源在列表中未显示选定值。

我对自己做错了什么感到困惑，但作为 MVC 的新手，我敢肯定这可能是非常简单的事情。与我见过的所有其他问题和答案的最大区别是我没有使用 ViewData。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T15:22:30.580

Check my answer to [this](https://stackoverflow.com/questions/822952/mvc-dropdown-list-value-not-being-set/824785#824785) question, maybe it helps. Perhaps you have a property "SoldTo" in your model, ViewData or ModelState. The DropDown tries to override the selected value if some of these objects has a property or key with the same name as your field. Is kind of crazy if you don't know how it works internally because you see the selected property set to true on the right item of the SelectList and yet no option of the select is selected.

# javascript - 如何在Javascript中解析变量

> ID：825311
> 
> 赞同：1
> 
> 时间：2009-05-05T15:06:24.940
> 
> 标签：javascript, jquery

我正在尝试使用此代码：

```
var field="myField";
vals[x]=document.myForm.field.value; 
```

在我的html代码中

```
<form name="myForm">
  <input type='radio' name='myField' value='123' /> 123
  <input type='radio' name='myField' value='xyz' /> xyz
</form> 
```

但这给了我错误：

```
document.myForm.field is undefined 
```

我怎样才能`field`被视为一个变量而不是一个字段？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T15:09:01.203

假设您的其他语法是正确的（我没有检查过），这将满足您的要求：

```
var field="myField";
vals[x]=document.myForm[field].value; 
```

在 JS 中，方括号运算符是按名称获取属性的访问器。[你可以在这里](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Operators/Member_Operators)阅读更多关于它的信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T15:08:22.563

使用 elements[] 集合

```
document.forms['myForm'].elements[field] 
```

[DOM 规范中的元素集合](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-40002357)

顺便提一句。如果您有两个具有相同名称的字段，要获取任何字段的值，您必须从以下内容读取：

```
var value = document.forms['myForm'].elements[field][index_of_field].value 
```

例如。

```
var value = document.forms['myForm'].elements[field][0].value 
```

并且，如果您想获取所选单选按钮的值，则必须检查选择了哪个单选按钮

```
var e = document.forms['myForm'].elements[field];
var val = e[0].checked ? e[0].value : e[1].checked ? e[1].value : null; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T15:09:57.270

你必须这样做：

```
var field = "myField";
vals[x] = document.myForm[field].value; 
```

甚至

```
vals[x] = document.forms.myForm.elements[field].value; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T17:15:31.947

根据您的标签，您似乎正在使用 jQuery。如果是这样，你可以这样做，它会让你的生活更轻松：

```
var vals = new Array();
$("form[name='myForm'] :radio").each(function() { 
    vals.push($(this).val()); 
}); 
```

:-D

# c - 仅在 Mac 上使用 -O2 编译时未定义的符号

> ID：825315
> 
> 赞同：1
> 
> 时间：2009-05-05T15:07:00.833
> 
> 标签：c, macos, linker

我正在开发一个必须在 linux 和 mac os X 上编译的库。到目前为止，我没有任何问题，使用“-g”编译在两个操作系统下都运行良好。

我尝试通过一些优化（“-O2”）进行编译，它在 linux 下运行良好，但是当我尝试在 mac os X 下将程序与我的库链接时，我得到一个未定义的符号。

有人知道我应该寻找什么吗？

```
nm mylib.a | grep _the_symbol 
```

这对于 linux 和 mac 返回相同的内容（在 linux 下没有前导下划线）：

```
154:00000018 C _the_symbol
377:         U _the_symbol 
```

这是使用该库的程序在 linux 下的编译行：

```
/usr/bin/gcc  -std=c99   CMakeFiles/prod-cons.dir/prod-cons.c.o  -o prod-cons -rdynamic -L/home/claferri/dev/build/src ../src/libckaapi.a -lpthread -Wl,-rpath,/home/claferri/dev/build/src 
```

在 mac 下：

```
/usr/bin/gcc  -std=c99 -Wl,-search_paths_first -headerpad_max_install_names -fPIC CMakeFiles/prod-cons.dir/prod-cons.c.o  -o prod-cons  -L/Volumes/Data/claferri/Work/build/src ../src/libckaapi.a /usr/lib/libpthread.dylib 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T15:41:47.523

Here's a guess at a workaround: try building the library with the -fno-common flag. If you have multiple definitions of this variable, you'll need to add "extern" to all but one.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:12:34.627

请注意，以下是一个猜测，除非/直到您提供您正在使用的确切编译器标志，否则我不能肯定地说 - 但 Xcode 默认为 setting `-fvisibility=hidden`，这将隐藏您库中的几乎所有符号，除非它是声明为可见。

你可以在 Linux 上做同样的事情，但 GCC 的默认设置是不隐藏符号。

您可以在此处找到更多信息：[http://gcc.gnu.org/wiki/Visibility](http://gcc.gnu.org/wiki/Visibility)

# linux - Firefox、Linux 中的 Flash 跟踪输出

> ID：825316
> 
> 赞同：4
> 
> 时间：2009-05-05T15:07:01.100
> 
> 标签：linux, flash, actionscript, trace

我正在开发一个在我的 linux 桌面上的服务器上运行的应用程序。由于 Linux 上 Flash 的缺点（阅读：太难了），我正在 Windows 中开发应用程序的（小）Flash 部分，这意味着来回有很多令人沮丧的事情。现在我正在尝试使用闪存跟踪器捕获闪存部分的输出，这也证明非常困难。有没有其他方法可以监控 linux 上的跟踪输出？谢谢...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-06T15:35:14.223

希望这也有帮助（为了我来自谷歌搜索）：

为了进行跟踪，您需要来自 [http://www.adobe.com/support/flashplayer/downloads.html](http://www.adobe.com/support/flashplayer/downloads.html)的 Flash Player 的调试器版本（专门寻找“调试器”版本 - 乍一看很难发现）

然后您家中的 mm.cfg 文件包含

```
ErrorReportingEnable=1 TraceOutputFileEnable=1 MaxWarnings=50 
```

然后你就可以开始了 - 重新启动浏览器。当traces开始填写时，你会发现log文件在

```
~/.macromedia/Flash_Player/Logs/flashlog.txt 
```

就像是

```
tail ~/.macromedia/Flash_Player/Logs/flashlog.txt -f 
```

应该足以跟踪跟踪。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-06T08:12:59.013

我多年来一直使用的一种不同的、令人难以置信的简单解决方法是直接在 swf 中创建一个输出模块。所有这一切都意味着一个键盘快捷键，它附加了一个带有文本字段的 MovieClip。我的所有跟踪都转到此文本字段，而不是（或除此之外）输出窗口。多年来，我当然已经改进了它，使窗口可拖动、调整大小等。但我从来不需要任何其他方法来进行简单的日志记录，而且它在所有平台上都是 100% 可靠和可重用的。

[编辑 - 对评论的回应] 没有像 javascript 的 alert() 函数那样的警报。但是使用内部文本字段就是这么简单：

动作脚本 1 版本

* * *

（见底部注释）

```
/* import ExternalInterface package */
import flash.external.*;

/* Create a movieclip for the alert. Set an arbitrary (but very high) number for the depth
 * since we want the alert in front of everything else.
 */
var alert = this.createEmptyMovieClip("alert", 32000);
/* Create the alert textfield */
var output_txt = alert.createTextField("output_txt", 1, 0, 0, 300, 200);
output_txt.background = true;
output_txt.backgroundColor = 0xEFEFEF;
output_txt.selectable = false;
/* Set up drag behaviour */
alert.onPress = function()
{
    this.startDrag();
}
alert.onMouseUp = function()
{
    stopDrag();
}

/* I was using a button to text EI. You don't need to. */
testEI_btn.onPress = function()
{
    output_txt.text = (ExternalInterface.available);
} 
```

注意：这适用于 AS1，并且可以很好地转换为 AS2（如果这样做，最好使用强数据类型，但不是严格要求）。它应该在 Flash Player 8-10 中工作。ExternalInterface 是在 Flash 8 中添加的，因此它在以前的播放器版本中不起作用。

动作脚本 3 版本

* * *

```
var output_txt:TextField = new TextField();
addChild(output_txt);
output_txt.text = (String(ExternalInterface.available)); 
```

如果你想加强一点：

```
var alert:Sprite = new Sprite();
var output_txt:TextField = new TextField();
output_txt.background = true;
output_txt.backgroundColor = 0xEFEFEF;
output_txt.selectable = false;
output_txt.width = 300;
output_txt.height = 300;
alert.addChild(output_txt);
addChild(alert);

alert.addEventListener(MouseEvent.MOUSE_DOWN, drag);
alert.addEventListener(MouseEvent.MOUSE_UP, stopdrag);

output_txt.text = (String(ExternalInterface.available));

function drag(e:MouseEvent):void
{
    var alert:Sprite = e.currentTarget as Sprite;
    alert.startDrag();
}

function stopdrag(e:MouseEvent):void
{
    var alert:Sprite = e.currentTarget as Sprite;
    alert.stopDrag();
} 
```

[/编辑]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T15:31:32.617

如果只需要运行时的trace输出，可以在Firefox中使用Firebug，然后使用Flash.external.ExternalInterface调用Firebug提供的console.log() Javascript方法。

我已经多次使用这种策略并取得了很大的成功。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-27T19:22:53.120

我使用 linux 上的 flex 编译器来构建动作脚本文件，[embed(source="file")] 用于我的所有资产，包括图像和字体，我发现 linux 上的动作脚本开发对开发人员非常友好。

再说一次，我最感兴趣的是闪存已经变成了对 Unix 友好的方式，相反 :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T16:05:24.080

[Thunderbolt](http://code.google.com/p/flash-thunderbolt/ "霹雳")是一个很棒的日志框架，具有内置的 firebug 支持。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-11T01:00:19.900

要实现 FlashTracer，请访问以下地址并确保您拥有最新的文件。 [http://www.sephiroth.it/firefox/flashtracer/](http://www.sephiroth.it/firefox/flashtracer/)。安装它并重新启动浏览器。

前往 adobe 并获取最新的闪存调试器。下载并安装 firefox 版本，因为 FlashTracer 是 firefox 添加的。

现在 firefox 有了最新的 flash 调试器和 flash 跟踪器，我们需要找到 mm.cfg

电脑位置：`C:\Documents and Settings\username`

里面`mm.cfg`应该是：

```
ErrorReportingEnable=1
TraceOutputFileEnable=1
MaxWarnings=100 //Change to your own liking. 
```

保存后，打开 Firefox，通过前往工具 > 闪光追踪器前往闪光追踪器窗口。在弹出的面板中，右下角有两个图标，单击扳手并确保将路径设置为保存日志文件的位置。还要检查一下闪光灯跟踪器是否打开，底部有一个播放/暂停按钮。

我目前使用这个实现，希望它对你有用。Flash Tracer 有点旧，但可以与最新版本的 FireFox 一起使用。我将它与 FireFox 3.0.10 一起使用。

# linq - LINQ 从表中检索字段（某个列的）不等于另一个表的值

> ID：825321
> 
> 赞同：1
> 
> 时间：2009-05-05T15:07:49.180
> 
> 标签：linq

我有两个表，它们有一个共同的列，我如何检索第一个表，其中它的列的值不等于另一个表的列的值？

这是一个例子：

```
 table1ID | foo    | fooBool        table2ID | foo      | fooin
 ----------------------------        -----------------------------

     1    |  test1  | true              1     |   test2  |    5
     2    |  test2  | true              2     |   test3  |    7
     3    |  test3  | true
     4    |  test4  | false 
```

因此，对于 foo 的值不等于 table2 的第一个表的 LINQ 查询的结果是：

```
table1ID | foo    | fooBool
---------------------------    
   1     | test1  | true
   4     | test4  | false 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T15:13:07.670

```
var results = from t1 in db.table1
              from t2 in db.table2
              where t1.foo != t2.foo
              select t1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T15:23:58.890

You could also use the [`Intersect()`](http://msdn.microsoft.com/en-us/library/bb460136.aspx) IEnumerable Extension

```
var results = db.table1.Intersect(db.table2); 
```

Or in LINQ

```
var codes = from intersected in db.table1.Intersect(db.table2)
            select intersected.foo; 
```

This would produce

```
 results 
 ----------
 test2
 test3 
```

**Update**

Thanks to Joe for pointing out that `Intersect` would produce the common items (added sample above). What you would want is the [`Except`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.except.aspx) extension method.

```
var results = db.table1.Except(db.table2); 
```

Or in LINQ

```
var codes = from diff in db.table1.Except(db.table2)
            select diff.foo; 
```

This would produce

```
 results 
 ----------
 test1
 test4 
```

# c# - 如何有效地从 TreeView 中删除选中的项目？

> ID：825323
> 
> 赞同：7
> 
> 时间：2009-05-05T15:08:06.510
> 
> 标签：c#, .net, winforms, treeview, iteration

如何轻松遍历 TreeView 中的所有节点，检查它们的 .Checked 属性，然后删除所有选中的节点？

这看起来很简单，但您不应该修改您正在迭代的集合，从而消除“foreach”循环的可能性。（.Nodes.Remove 调用正在修改集合。）如果尝试这样做，效果是只有大约一半的 .Checked 节点被删除。

即使要使用两遍：首先创建一个临时索引列表，然后在第二遍中按索引删除——每次删除时索引都会更改，从而使索引列表的完整性无效。

那么，最有效的方法是什么？

这是一个看起来不错的代码示例，但实际上只删除了大约一半的 .Checked 节点：

```
 foreach (TreeNode parent in treeView.Nodes)
            {
                if (parent.Checked)
                {
                    treeView.Nodes.Remove(parent);
                }
                else
                {
                    foreach (TreeNode child in parent.Nodes)
                    {
                        if (child.Checked) parent.Nodes.Remove(child);
                    }
                }
            } 
```

（是的，目的只是从两层深的树中修剪节点。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T15:17:43.850

Try walking through the nodes backwards. That way your index doesn't increase past your node size:

```
for( int ndx = nodes.Count; ndx > 0; ndx--)
{
  TreeNode node = nodes[ndx-1];
  if (node.Checked)
  {
     nodes.Remove(node);
  }
   // Recurse through the child nodes...
}

```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-05T15:22:10.847

This will remove the nodes after enumerating them, and can be used recursively for n-tiers of nodes.

```
void RemoveCheckedNodes(TreeNodeCollection nodes)
{
    List<TreeNode> checkedNodes = new List<TreeNode>();

    foreach (TreeNode node in nodes)
    {
        if (node.Checked)
        {
            checkedNodes.Add(node);
        }
        else
        {
            RemoveCheckedNodes(nodes.ChildNodes);
        }
    }

    foreach (TreeNode checkedNode in checkedNodes)
    {
        nodes.Remove(checkedNode);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T15:35:17.240

如果你想有效地做到这一点，你需要在检查节点时跟踪它们。将选中的树节点存储在列表中（并在它们未选中时将其删除）。

如果你有一个唯一的键和很多节点来跟踪你，也可以考虑使用字典。但是，如果您只处理 10-50，它可能不会有很大的不同。

然后，不是循环遍历整个树，而是循环遍历（较小的）节点列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T15:17:24.243

在迭代时，您可以构建一个新的未选中项目列表，然后将您的树视图重新绑定到该新列表（丢弃旧列表）。

# c - 在 C 中抓取网页的最简单方法是什么？

> ID：825327
> 
> 赞同：3
> 
> 时间：2009-05-05T15:08:47.617
> 
> 标签：c, sockets, webpage

我正在研究一个老式的 linux 变体（确切地说是 QNX），并且需要一种方法来获取网页（没有 cookie 或登录，目标 URL 只是一个文本文件），只使用套接字和数组。

有人有这个片段吗？

注意：我不控制服务器，除了盒子上已有的东西外，我几乎没有什么可使用的（考虑到限制，添加额外的库并不是真的“容易”——尽管我确实喜欢 libcurl）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T15:15:10.097

如果你想要 SSL 支持或任何花哨的东西，我会看看[libcurl 。](http://curl.haxx.se/)

但是，如果您只想从端口 80 获取一个简单的网页，那么只需打开一个 tcp 套接字，发送“ `GET /index.html HTTP/1.0\n\r\n\r`”并解析输出。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-05T15:14:54.390

我确实有一些代码，但它也支持（Open）SSL，所以在这里发布有点长。

在本质上：

*   解析 URL（拆分 URL 方案、主机名、端口号、方案特定部分

*   创建套接字：

    `s = socket(PF_INET, SOCK_STREAM, proto);`

*   `sockaddr_in`使用远程 IP 和端口填充结构

*   将套接字连接到远端：

    `err = connect(s, &addr, sizeof(addr));`

*   制作请求字符串：

    `n = snprinf(headers, "GET /%s HTTP/1.0\r\nHost: %s\r\n\r\n", ...);`

*   发送请求字符串：

    `write(s, headers, n);`

*   读取数据：

    `while (n = read(s, buffer, bufsize) > 0) { ... }`

*   关闭套接字：

    `close(s);`

注意：上面的伪代码会收集响应头*和*数据。两者之间的分割是第一个空行。

# ruby - 将 ruby .gem 文件放在哪里以便 Shoes.setup 可以找到它们？

> ID：825331
> 
> 赞同：4
> 
> 时间：2009-05-05T15:09:42.717
> 
> 标签：ruby, rubygems, dbi, shoes

很多关于鞋子中的宝石支持的问题都被问到了，但没有人回答将它们放在哪里。我在 Windows XP 上安装了 Shoes Raisins 1134，我已经下载`dbi-0.4.1.gem`并尝试让以下内容正常工作：

```
Shoes.setup do
  gem 'dbi'
end

require 'dbi'

Shoes.app 
  ...
end 
```

当我运行它时，我得到一个对话框，上面写着`Installing dbi -- Looking for dbi`几个小时没有找到 gem 文件。我试过把它放在以下所有地方都无济于事：

*   包含上述脚本的文件夹
*   D:\Program Files\Common Files\Shoes\0.r1134\ruby\gems
*   D:\Program Files\Common Files\Shoes\0.r1134\ruby\gems\1.8\gems

哪个是错误的 - 文件夹或代码？

## 编辑 - 答案：

感谢@Pesto 的回答。我已经阅读了引用的文本，但将其误解为引用 Shoes PUT 安装的 gem 文件的位置，而不是它 GOT 源的位置。在 Windows XP 中，引用转换为`%USERPROFILE%\Application Data\Shoes`，并且安装运行良好。现在开始玩它......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T15:31:14.880

代码看起来不错。例如，这只是桃子：

```
Shoes.setup do
  gem 'RedCloth'
end

require 'RedCloth'

Shoes.app do
  para RedCloth.new('*awesome*').to_html
end 
```

至于 gem 的安装位置，_why 自己[回答了这个问题](http://hackety.org/2008/05/08/clearingUpTheWholeShoesAndRubyGemsDeal.html)：

> 通过将您的宝石列表放在 Shoes.setup 块中，如果碰巧没有任何宝石，您最终会遇到上面看到的鞋子弹出窗口。Gem 安装在 ~/.shoes 中，以避免需要超级用户权限。（只是为了让鞋子远离你正常的 Ruby 东西。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-04T14:21:53.750

每当您无法检查鞋子是否能够找到宝石时，您可以在 ~/.shoes/+gem/gems 查看鞋子可用的宝石

# java - 如果启用了 TOMCAT5_SECURITY，我的程序如何询问 tomcat？

> ID：825336
> 
> 赞同：3
> 
> 时间：2009-05-05T15:10:52.947
> 
> 标签：java, tomcat

在我们的 tomcat 应用程序中，我们捕获了一个 CommunicationsException。有多种配置参数会导致这种情况，包括数据库配置设置错误，以及 tomcat 配置有 TOMCAT5_SECURITY=yes

当我们捕获异常时，我们希望向用户提供有用的错误消息。所以我们想问tomcat是否设置了TOMCAT5_SECURITY，但我们无法确定在API中的哪个位置可用。

那么什么 tomcat API 调用会告诉我们是否启用了 TOMCAT5_SECURITY 呢？

（完整的例外是 com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T17:50:45.527

我所知道的唯一 TOMCAT5_SECURITY 标志是 Ubuntu 软件包文件 /etc/default/tomcat5(.5) 中提供的标志。这是特定于 Ubuntu 的，所以我不希望它成为 Tomcat API 的一部分。请注意，该标志设置是否使用安全管理器，所以也许您应该查看它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T12:52:05.643

在启用安全性时调用一些必须抛出 SecurityException 的方法怎么样？您可以缓存结果，假设设置在运行时不会更改。

# excel - 使用 Excel 2007（Vista 64 位版本）加载 32 位 DLL

> ID：825340
> 
> 赞同：2
> 
> 时间：2009-05-05T15:11:17.453
> 
> 标签：excel, vba, dll, 64-bit, 32-bit

我发现我无法使用我的 Office 2007 版本加载任何 32 位 DLL。我使用的是 64 位 Vista，我假设 Office 也处于 64 位模式。是否可以在 32 位模式下启动 Excel 或者有没有办法使用 VB 声明 DLL 以加载 32 位 DLL？

因为我没有我正在使用的某些 DLL 的源代码，所以我不能简单地为 64 位模式重新编译东西。所以我认为我的选择是强制 Excel 在 32 位模式下运行，或者将我使用的 DLL 声明为 32 位 DLL，即使我的环境是 64 位。

我得到的错误是“找不到 DLL”，即使 DLL 实际上存在。

下面是一个示例声明。此语句是否有 32 位属性？

Private Declare Function ESQMain Lib "ESQuotes2.dll" Alias "_ESQMain@12" _ (ByVal func As Long, ByVal ticker_symbol As String, ByVal Result As String) As Integer

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T15:20:01.740

You have a bad assumption - [Office](http://arstechnica.com/microsoft/news/2009/04/confirmed-office-2010-will-come-in-32-bit-and-64-bit.ars) is not currently available in 64 bit. The next version of office (Office 2010) is rumored to be shipped with 32 & 64 bit.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:17:26.643

You can't "declare" a DLL to be 32 bits. It's either a Win32 binary or a Win64 binary. The first kind of binary can be loaded in Win32 processes, the second in Win64 processes. You can't mix them. Attributes on the Visual Basic import do not help.

So, your only option is to start the 32 bits Excel binary. It has to exist, obviously, since Office is still available for Vista 32, but the question is whether it's installed and where.

# c++ - 将一个无符号字符数组转换为一个浮点数组

> ID：825344
> 
> 赞同：7
> 
> 时间：2009-05-05T15:11:46.800
> 
> 标签：c++, casting, floating-point, char, unsigned

在 C++ 中将无符号字符数组转换为浮点数组的最佳方法是什么？

我目前有一个for循环如下

```
for (i=0 ;i< len; i++)
    float_buff[i]= (float) char_buff[i]; 
```

我还需要反转过程，即从无符号字符转换为浮点数（浮点数到8位转换）

```
for (i=0 ;i< len; i++)
    char_buff[i]= (unsigned char) float_buff[i]; 
```

任何意见，将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-05T16:47:50.903

我认为最好的方法是使用函数对象：

```
template <typename T> // T models Any
struct static_cast_func
{
  template <typename T1> // T1 models type statically convertible to T
  T operator()(const T1& x) const { return static_cast<T>(x); }
}; 
```

其次是：

```
std::transform(char_buff, char_buff + len, float_buff, static_cast_func<float>());
std::transform(float_buff, float_buff + len, char_buff, static_cast_func<unsigned char>()); 
```

这是最易读的，因为它用英语说明了正在做的事情：使用静态转换将序列转换为不同的类型。未来的演员阵容可以在一行中完成。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-05T15:18:17.827

Your solution is pretty much the best option, however, I would consider switching to:

```
char_buff[i]= static_cast<unsigned char>(float_buff[i]); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T15:17:54.130

For what purpose are you doing this? Shoving a float into a char doesn't really make sense. On most platforms a float will be 4 bytes and represent a floating point number, where as a char will be 1 byte and often represents a single character. You'll lose 3 bytes of data trying to shove a float into a char, right?

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T16:07:24.653

您的第一个循环不需要演员表。您可以从一种类型（例如 ）隐式转换`unsigned char`为更广泛的类型（例如`float`）。你的第二个循环应该使用`static_cast`：

```
for (i=0; i< len; i++)
    char_buff[i]= static_cast<unsigned char>(float_buff[i]); 
```

我们使用`static_cast`显式告诉编译器将转换为更窄的类型。如果您不使用强制转换，您的编译器可能会警告您转换可能会丢失数据。演员表操作员的存在意味着您了解您可能会丢失数据精度并且您可以接受。这**不是**一个合适的地方使用`reinterpret_cast`。使用`static_cast`，您至少对可以进行的转换有一些限制（例如，它可能不允许您将 a 转换`Bird*`为 a `Nuclear_Submarine*`）。 `reinterpret_cast`没有这样的限制。

此外，这也是[Bjarne Stroustrup](http://www.research.att.com/~bs/bs_faq2.html#static-cast)对这个主题的看法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-05T16:51:46.980

演员表是自动的，因此您无需明确说明。
但是您可以使用标准算法：

```
std::copy(char_buff,char_buff+len,float_buff); 
```

从 float 转换回 char 可能会丢失信息。所以你需要更明确。

```
std::transform(float_buff,float_buff+len,char_buff,MyTransform()); 
```

这里我们使用 MyTransform 类，它应该有一个 operator()，它接受一个浮点数并返回一个字符。这应该是微不足道的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-05T15:15:55.277

您的解决方案似乎是正确的，但在返回的路上，您可能会丢失铸造中的浮动数字。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T15:22:31.577

If you are dealing with very large arrays and performance is essential then the following may prove slightly more efficient:

```
 float *dst = float_buff;
   unsigned char *src = char_buff;

   for (i=0; i<len; i++) *dst++ = (float)*src++; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-05T18:29:40.833

没有人提到这一点，但如果你对浮点数进行任何算术运算，你可能想要舍入而不是截断......如果你有 char 49，它会变成 4.9E1，经过一些算术，它可能变成 4.89999999E1 当你把它变成一个字符时它会变成 48。

如果你没有对浮点数做任何事情，这应该不是问题，但是你为什么首先需要它作为浮点数呢？

# c# - 如何：在 PowerPoint 幻灯片上使用语法高亮显示的 C# 源代码

> ID：825353
> 
> 赞同：55
> 
> 时间：2009-05-05T15:13:16.343
> 
> 标签：c#, syntax-highlighting, powerpoint

我想在 PowerPoint 演示文稿中展示一些 C# 源代码。但是如何将***包括语法突出显示***的代码复制到幻灯片上？我可以制作屏幕截图，但这有一些缺点（难看、字体大小、无法维护）。你有什么想法吗？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-05-05T15:18:52.133

1.  copy the code from Visual Studio to PowerPoint
2.  choose "keep original formatting" on the Paste Options icon

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2011-08-09T16:57:40.743

如果我将代码从 Visual Studio 直接复制到 PowerPoint 中，使用选择性粘贴（并选择 RTF），它只会进行*一些*格式设置。
这是我如何进行所有格式化的方法。

1.  在 Visual Studio 中复制代码。( `Ctrl`+ `C`)
2.  打开一个新的 Word 文档并粘贴。( `Ctrl`+ `V`)
3.  在 Word 中重新选择代码并再次复制。( `Ctrl`+ `A`, `Ctrl`+ `C`)
4.  在 PowerPoint 中，将选择性粘贴为“HTML 格式”。( `Ctrl`+ `Alt`+ `V`)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-05T15:22:11.970

"Paste Special" (Ctrl+Alt+V) will do it. This option is available in different places depending on your version of PowerPoint.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-10-25T11:48:59.590

在[Notepad++](https://notepad-plus-plus.org) 6.9.2 或更高版本中，右键单击文本并选择`Plugin Commands`和`Copy Text with Syntax Highlighting`。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-18T02:47:00.237

1.  在 PPT 中，点击“插入”->“对象”->“新建”->“Microsoft Word 文档”
2.  将您的代码复制到 PPT 幻灯片中新创建的对象中，
3.  您现在将看到格式并突出显示。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2021-01-27T07:22:40.190

我接受以上所有答案。

我找到了一种更美观的方式来分享 ppt 中的代码，在演示中看起来会很优雅。

使用免费和开源的[https://carbon.now.sh/ ，添加您的代码，进行自定义，然后将其导出以添加到 ppt 中。](https://carbon.now.sh/)

[![在此处输入图像描述](https://i.stack.imgur.com/cdOs6.png)](https://i.stack.imgur.com/cdOs6.png)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-10-28T07:20:16.460

将代码复制并粘贴到写字板，然后从写字板复制到您想要的任何位置并保留原始格式[![保持原始格式](https://i.stack.imgur.com/DqMuD.jpg)](https://i.stack.imgur.com/DqMuD.jpg)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-05T15:20:43.563

You can use Windows Live Writer with the [Insert Code](http://insertcode.codeplex.com/) plugin to "write" the C# code and syntax highlight it. This should be copy and pastable directly into PowerPoint, since it's inlines all of the syntax highlighting using styling elements.

# sql-server - 将点从 SQL Server Multipoint 数据类型加载到表中

> ID：825356
> 
> 赞同：0
> 
> 时间：2009-05-05T15:13:57.853
> 
> 标签：sql-server, sql-server-2008, geometry, multipoint

我正在考虑使用新的几何数据类型来表示数据库中的向量的想法。多点几何数据类型可以很好地解决这个问题，但我的问题是，有没有办法用多点中的 x、y 值填充两列表，其中每个点是表中的一行，而 X 和Y 点值分别在 column1 和 column2 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T18:41:17.340

我假设您已阅读几何数据类型入门。

[http://msdn.microsoft.com/en-us/library/bb895270.aspx](http://msdn.microsoft.com/en-us/library/bb895270.aspx)

除此之外，我无能为力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T01:45:03.053

弄清楚了：

```
select
mp.id
,mp.vector.STPointN(nums.number).STX
,mp.vector.STPointN(nums.number).STY
,nums.number
from tblWithMultiPoints mp --table with an int id, and a multipoint called vector
,#NUMBERS nums --temp table with 1 - max num of points in any multipoint
where nums.number <= mp.vector.STNumPoints() 
```

# delphi - 如何在 Delphi 中将 SOAP 元素名称更改为保留字？

> ID：825358
> 
> 赞同：1
> 
> 时间：2009-05-05T15:14:24.187
> 
> 标签：delphi, soap, element, reserved-words

我使用这一行在 Delphi 注册表中为 Soap 元素注册一个类：

```
RemClassRegistry.RegisterXSClass(ToHeader, ADD_URI); 
```

在 Soap 请求消息中，我看到：

```
 <NS1:ToHeader> ... </NS1:ToHeader> 
```

是否可以更改类注册，以便使用不同的名称呈现元素，例如：

```
 <NS1:To> ... </NS1:To> 
```

还是调整请求流的唯一方法？

To 是 Delphi 中的保留字，我无法将类重命名为元素名称“To”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T16:51:44.640

看起来这就是第三个参数的用途。试试这个：

```
RemClassRegistry.RegisterXSClass(ToHeader, ADD_URI, 'To'); 
```

从 Delphi 8 开始，您*可以*使用保留字作为标识符。`&`用作转义字符，或使用完全限定名称：

```
type
  &To = class;

RemClassRegistry.RegisterXSClass(UnitName.To, Add_URI); 
```

# mysql - MySql 错误 150 - 外键

> ID：825362
> 
> 赞同：18
> 
> 时间：2009-05-05T15:14:50.363
> 
> 标签：mysql, foreign-keys, mysql-error-150

当我执行以下两个查询时（我已将它们剥离为绝对必要的）：

```
mysql> CREATE TABLE foo(id INT PRIMARY KEY);
Query OK, 0 rows affected (0.01 sec)

mysql> CREATE TABLE bar ( id INT, ref INT, FOREIGN KEY (ref) REFERENCES foo(id)) ENGINE InnoDB; 
```

我收到以下错误：ERROR 1005 (HY000): Can't create table './test/bar.frm' (errno: 150)

我的错误在哪里？我盯着这个看了半个小时都没找到他。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-05T15:22:11.423

从[`FOREIGN KEY`约束](http://dev.mysql.com/doc/refman/5.1/en/innodb-foreign-key-constraints.html)

> 如果您重新创建已删除的表，则它必须具有符合引用它的外键约束的定义。如前所述，它必须具有正确的列名和类型，并且必须在引用的键上具有索引。如果这些不满足，MySQL 返回错误号 1005 并在错误消息中引用错误 150。

我*怀疑*这是因为您没有创建`foo`为 InnoDB，因为其他一切看起来都不错。

编辑：来自同一页面 -

> 两个表都必须是 InnoDB 表，并且不能是 TEMPORARY 表。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-10-22T14:37:27.837

您可以使用该命令`SHOW ENGINE INNODB STATUS`获取有关错误的更具体信息。

它会给你一个`Status`包含大量文本的列的结果。

查找名为 LATEST FOREIGN KEY ERROR 的部分，例如可能如下所示：

```
------------------------
LATEST FOREIGN KEY ERROR
------------------------
190215 11:51:26 Error in foreign key constraint of table `mydb1`.`contacts`:
Create  table `mydb1`.`contacts` with foreign key constraint failed. You have defined a SET NULL condition but column 'domain_id' is defined as NOT NULL in ' FOREIGN KEY (domain_id) REFERENCES domains (id) ON DELETE SET NULL ON UPDATE CASCADE,
    CONSTRAINT contacts_teams_id_fk FOREIGN KEY (team_id) REFERENCES teams (id) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=COMPACT' near ' ON DELETE SET NULL ON UPDATE CASCADE,
    CONSTRAINT contacts_teams_id_fk FOREIGN KEY (team_id) REFERENCES teams (id) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 ROW_FORMAT=COMPACT'. 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-01-14T10:49:10.760

要创建外键，

1.  主列和参考列必须具有相同的定义。
2.  两个表引擎都必须是 InnoDB。

您可以使用此命令更改表的引擎，请在执行此命令之前进行备份。

改变表 [表名] ENGINE=InnoDB;

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T18:51:43.853

我有同样的问题，对于那些也有这个问题的人：

检查引用表的表名

我忘记了表名末尾的“s”

例如表客户端-> 客户端

:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-21T10:15:48.670

除了导致 MySql 错误 150 （使用 InnoDB 时）的许多其他原因之外，可能的原因`KEY`之一是表的创建语句中未定义包含在相关表中引用为外键的列名。

假设主表的创建语句是 -

`CREATE TABLE 'master_table' (
 'id' int(10) NOT NULL AUTO_INCREMENT,
 'record_id' char(10) NOT NULL,
 'name' varchar(50) NOT NULL DEFAULT '',
 'address' varchar(200) NOT NULL DEFAULT '',
 PRIMARY KEY ('id')
) ENGINE=InnoDB DEFAULT CHARSET=utf8;`

以及从主表设置外键约束的 relative_table 表的创建语法 -

`CREATE TABLE 'relative_table' (
 'id' int(10) NOT NULL AUTO_INCREMENT,
 'salary' int(10) NOT NULL DEFAULT '',
 'grade' char(2) NOT NULL DEFAULT '',
 'record_id' char(10) DEFAULT NULL,
 PRIMARY KEY ('id'),
 CONSTRAINT 'fk_slave_master' FOREIGN KEY ('record_id') REFERENCES 'master' ('record_id')
) ENGINE=InnoDB DEFAULT CHARSET=utf8;`

如果使用 InnoDB，这个脚本肯定会以 MySql 错误 150 结束。

为了解决这个问题，我们需要为表`KEY`中的列添加一个然后在表中引用`record_id`以用作foreign_key。`master_table``relative_table`

最后， , 的创建语句`master_table`将是 -

`CREATE TABLE 'master_table' (
 'id' int(10) NOT NULL AUTO_INCREMENT,
 'record_id' char(10) NOT NULL,
 'name' varchar(50) NOT NULL DEFAULT '',
 'address' varchar(200) NOT NULL DEFAULT '',
 PRIMARY KEY ('id'),
 **KEY 'record_id' ('record_id')**
) ENGINE=InnoDB DEFAULT CHARSET=utf8;`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-07T11:01:11.977

我遇到了同样的问题，原因是列的“整理”不同。一个是 latin1 而另一个是 utf8

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-08T12:00:58.670

如果您在“references”关键字后没有给出正确的列名，也可能会发生这种情况。

# sql-server - Webtrends 无法读取 Microsoft 报告服务 2008 网络日志

> ID：825364
> 
> 赞同：1
> 
> 时间：2009-05-05T15:14:54.950
> 
> 标签：sql-server

随着在 SSRS 中从 IIS 更改为他们自己的 Web 服务器，我们现在遇到了使用 Web 趋势来跟踪我们的报告利用率的问题。网络趋势说它不受支持，有没有人找到让它工作的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-20T19:53:39.490

我不知道，对不起。

[通常，您通过挖掘 ReportServer](http://www.databasejournal.com/features/mssql/article.php/3459461/MSSQL-Server-Reporting-Services-Black-Belt-Administration--Prepare-the-Execution-Log-for-Reporting.htm)数据库中的 ExecutionLog 表来“自己动手” 。这有很多关于用户、参数、持续时间、错误等的有用信息。

这里有比 IIS 日志更多的信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-11T12:29:03.650

我假设您使用的是本机报告模式。如果你将它切换到 Sharepoint 集成模式，我想你可以让一些日志记录再次工作。

# sharepoint - 没有图标，并且标记正在显示

> ID：825371
> 
> 赞同：0
> 
> 时间：2009-05-05T15:16:23.403
> 
> 标签：sharepoint, sharepoint-2007

在 MOSS 2007 的中央管理中的图标没有得到显示。它显示了一个十字符号，并且附加在十字上的信息是**使用 Shift + Enter 打开菜单 [新窗口]**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T01:13:16.453

使用 Fiddler 查看请求图像时返回的消息。

# c# - 你怎么知道你是否在主 UI 线程上？（在 CF 中）

> ID：825373
> 
> 赞同：1
> 
> 时间：2009-05-05T15:17:21.607
> 
> 标签：c#, .net, compact-framework

现在不幸的是，由于 WinCE Usb Device Arrival / Removal 通过 WindowsMessages 暴露自己，我必须确保某个（非 UI）组件**不是**在后台线程上创建的。我想通过异常断言这一点，但缺少断言代码。

该组件创建一个 MessageWindow* 并使用它来接收 USB 到达/删除的消息。问题是如果有人在后台线程上创建此组件（不一定；IsBackground = true），当线程退出窗口时，窗口将被销毁。

有任何想法吗？

*顺便说一句，我*仍然*不知道为什么 Form 不从这个类继承

**更新**

我认为我的版本 1 不是很清楚。所以这是v2。

当您在线程上为此创建 MessageWindow 或 Form 时，当该线程退出时，Window/Form 将被销毁。

我的组件正在创建一个“隐藏”消息窗口来拦截一些重要事件，因此我不希望它被破坏。因此，我必须以某种方式确保创建表单的代码在“主 UI”线程上运行。

如果可能的话，我想避免将对该组件的“主”表单的引用传递给该组件，因为它（从架构上讲）应该距离 UI 数英里。

**更新**

将日志记录问题移至单独的 Q。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T16:05:18.183

好的，我知道您不希望您的组件“了解”主窗口——这是有道理的。

这个怎么样：如果你确保你总是在主线程上实例化你的组件呢？您的组件将在构造函数的线程上创建它的侦听器窗口。

如果你这样做，那么你只需要确保你从主线程调用构造函数。我正在对您的代码做出一些假设，但我猜您的体系结构中必须有一些了解 UI 和组件的类。使用回调和主窗体的 InvokeRequired/Invoke 方法在那里创建您的组件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:30:59.077

在表单中，您使用[InvokeRequired](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.invokerequired.aspx)属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T15:34:30.893

为什么不在后台线程上创建非 UI 组件，当您去更新任何 UI 组件时，只需查看是否 invokeRequired 然后返回主线程以实际进行更新。

IMO，您应该没有什么真正束缚主要事件线程的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T15:36:42.027

你可以这样使用它：

```
void MyCallback()
{
if (form1.InvokeRequired) { // form1 is any existing gui control
    form1.Invoke(new Action<>(MyCallBack));
    return;
}
// your logic here
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-08T19:07:16.387

嘿那里：我对你的问题有一个想法。这只是一个随机的想法，我不确定它是否会起作用（我没有测试过，甚至没有编译过这个——它只是击中了我）：

如果您获得应用程序主窗口的窗口句柄，然后围绕它构建一个控件（我假设您有一个基于 gdi 的应用程序，例如 Winforms）怎么办？

此代码可能无法编译，但很接近（它会进入您的组件 - 请注意，它会使您的组件需要 gdi windows/winform 应用程序，而不是控制台或 WPF 应用程序）。

如果您确实尝试过，我很想知道它是否对您有用。

```
 using System.Diagnostics;
using System.Windows.Forms;
void Init()
{
   // get handle to the main window
   intPtr mainWindowHandle = Process.GetCurrentProcess().MainWindowHandle;
   Control mainWindow = Control.FromHandle(mainWindowHandle);
   if(mainWindow.InvokeRequired)
      mainWindow.Invoke(SetupMessageWindow);
   else
      SetupMessageWindow();
}
void SetupMessageWindow()
{
  // do your thing...
} 

```

# cpu - CPU Utiliztion per process in Win32 API

> ID：825379
> 
> 赞同：1
> 
> 时间：2009-05-05T15:18:00.370
> 
> 标签：cpu, perfmon, utilization

I am doing a project on a centralized LAN management system. I need to know how many CPU cycles is each process of a remote PC consuming(as in a Task Manager )so that the network admin can close few processes,in case the CPU utilization of a system in network goes beyond acceptable rates..

I would like to know if there is a Win32 API for this requirement of mine n if so ,i request you to give me information about it..

thank you in advance..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T03:55:05.700

Win32 API 有很多函数可以查找有关当前正在运行的进程和线程的各种信息，这里是它们的完整列表的链接：http: [//msdn.microsoft.com/en-us/library/ms683223 (VS.85 ).aspx](http://msdn.microsoft.com/en-us/library/ms683223(VS.85).aspx)

浏览该列表，您应该能够在那里找到满足您要求的函数，例如 GetProcessTimes() 返回包含进程在内核模式、用户模式等中执行的时间量的结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:29:03.467

您需要查看性能监控系统。您可以从那里获取统计信息（在 Process 计数器中）。

这是对它的（delphi）[解释](http://www.wehlou.com/Code/perfmon/index.htm)，非常好且易于理解。

当您了解它的工作原理后，您就需要[Performance Counters](http://msdn.microsoft.com/en-us/library/aa373083(VS.85).aspx) API 来读取数据计数器。

# c# - 将 PowerBuilder 应用程序移植到 .NET

> ID：825385
> 
> 赞同：16
> 
> 时间：2009-05-05T15:18:52.053
> 
> 标签：c#, .net, migration, powerbuilder, powerbuilder-conversion

有人对将 PowerBuilder 10 业务应用程序迁移到 .NET 有什么建议吗？

我的公司正在考虑将遗留的 PB 应用程序迁移到 .NET (C#)，我只是想知道是否有人有任何经验——好的或坏的——你想分享。

该应用程序相当大，有 10 个 PBL 库、一些 PFC 以及自定义框架。还有大量的 DLL 调用。最后，它使用 Microsoft SQL Server 数据库。

我们已经讨论了将“核心”应用程序代码移植到 .NET，然后根据需要移植更高级的功能。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-07T05:37:46.850

当我看到标题时，我只是想潜伏，成为一个有名的PB偏执狂。那好吧。谢谢你的信任投票，伯纳德。

我的第一个建议是摒弃自欺欺人的语言。如果我吃了一半“精简版”芝士蛋糕，我仍然会看不到我的腰带。迁移可能只需要 10 分钟。你要做的是*重写*。**时间**需要作为重写来衡量。**风险**需要作为重写来衡量。**设计工作**应该作为重写来衡量。

是的，我说的是设计努力。“迁移”让人联想到通过某个黑匣子抽取代码的图像，其中的翻译反映了从另一边出来的原始代码。您是否想复制您在 1994 年犯下的相同设计*错误*？即使有优秀的代码，我猜 PowerBuilder 中优秀的设计选择在 C# 中可能是糟糕的设计选择。直接转换是否忽略了平台的力量和优势？*在接下来的 15 年里*，你会忍受忽视良好 C# 设计的后果吗？

* * *

撇开这些咆哮不谈，因为你没有提到你“迁移到 .NET”的动机，所以很难建议你可能需要哪些选项来降低重写的风险。如果您的管理层只是决定 PowerBuilder 开发人员闻起来很糟糕，需要从办公室中删除，那么祝您重写顺利。

如果您只是想部署 Windows 窗体、Web 窗体、程序集或 .NET Web 服务，或者利用 .NET 库，那么正如 Paul 所提到的，迁移到 11.0 或 11.5 可以让您更接近迁移。（我建议再次审查并确保您已经为新平台设计了一个好的设计，尤其是 Web 窗体，但这种工作应该比重写要小得多。）如果您想部署 WPF 应用程序，我知道一年的等待时间很长，但研究 PowerBuilder 12 可能是值得的。如果正确使用，WPF 功能可能会将 PowerBuilder 置于独特而强大的位置。

如果保证将来会进行重写（淋浴似乎更便宜），您可能希望分阶段进行转换。DataWindow.NET 使您可以随身携带 DataWindows。（我本周的宠物理论是，PowerBuilder 开发人员认为 DataWindow 是理所当然的，直到他们必须重现所有内置的功能。）能够放弃预先存在的、预先测试的、多行的、可滚动的、最小的资源消耗、可打印、数据绑定的动态 UI，生成具有内置逻辑记录锁定和数据库错误转换为事件的最小 SQL，进入新应用程序是一大优势。

您还可以通过将 PowerBuilder 代码转换为可由 .NET 应用程序使用的东西来分阶段进行转换。如前所述，您可以使用现有的 PB 10 生成 COM 对象，但必须移至 11.0 或 11.5 才能生成程序集。这个值可能取决于您的应用程序的分区程度。如果您的业务逻辑在 GUI 事件和函数中蜿蜒而行，而不是被划分为非可视对象（也称为自定义类），那么它的价值可能值得怀疑。尽管如此，这是一个设计失误，*可能*应该在完全转换为 C# 之前修复；这是可以在保持 PowerBuilder 应用程序作为分阶段然后完全转换的初步步骤的同时完成的。

毫无疑问，我宁愿看到你留在 PowerBuilder。失败了，我希望看到你成功。请记住，一旦你吃了第一口，[你就必须吃完](http://www.supersizedmeals.com/food/images/articles/20061215-Heart_Attack_Grill_2.jpg)。

祝你找到那条腰带，

特里。

* * *

我看到您提到将“核心组件”移动到 .NET 开始。正如您现在可能猜到的那样，我认为分阶段的方法是一个明智的决定。现在“核心”的定义可能是有争议的，但相反的观点又如何呢？值得深思？（显然，这周开始节食是错误的。）根据 PB 现在的情况，很难根据应用程序功能（例如，PB 中的应收账款，C# 中的应付账款）在 PB 和 C# 之间划分您的应用程序。一个可能起作用的部门是 GUI 与业务逻辑。如前所述，将业务逻辑从 PB 中抽取到 C# 可以使用的可执行文件中已经成为可能。用 C# 构建 GUI，从 PB 复制 DataWindows 并将业务逻辑作为 COM 对象或程序集抽出，怎么样？换一种方式，在 PB 中使用 .NET 程序集，[COM 可调用包装器](http://pbdj.sys-con.com/node/258395)。

或者，只需在 PowerBuilder 中培训您的 C# 开发人员。这可能只是一个谣言，但我听说新的 PowerBuilder 营销标语将是“如此简单，即使是 C# 开发人员也可以使用它”。;-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-05T17:33:32.230

我认为 gbjbaanb 在上面给了你一个很好的答案。

其他一些值得考虑的问题：

*   这个 PB10 应用程序是一个新的、编写良好的 PB10 应用程序，还是它是 1998 年在 PB4 中制作的，然后多年来逐渐转换为 PB10？一个编写良好的应用程序应该在业务逻辑和 GUI 之间进行适当的隔离，并且您应该能够系统地将您的代码移植到 .Net。至少，它应该比这是一个传统的 PB 应用程序要容易得多，在这种情况下，您可能会将大量逻辑隐藏在按钮、数据窗口、菜单中，谁知道还有什么。并非不可能，但更难返工。
*   应用程序的运行情况如何？如果它还可以并且稳定，并且不需要很多新功能，那么也许它不需要重写。或者，正如 gbjbaanb 所说，您可以将 .Net 包装器放在某些部分上，然后公开您需要的功能而无需完全重写。另一方面，如果您的应用程序是坏的、令人讨厌的，并不能真正满足业务需求，并且使您的用户效率低下，那么您可能需要重写，或者进行一些严重的重构，然后进行一些增强。有PB家伙在服刑，呃，我的意思是，以第二种情况为生。

如果软件非常糟糕并且对公司的业务产生负面影响，我不反对重写，但即使这样，逐步调整和改进也是实现系统演进的风险较小的方式。

另外，在 Terry Voth 发帖之前不要放弃这个线程。他在 StackOverflow 上，是顶级 PB 人员之一。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-05T15:34:28.647

如果它相当大，您可能会在 .net（或基于 Web 的 GUI）中为它编写一个前端并使用它与您的 PB 代码进行交互，假设您可以将其作为 API 公开的功能获得更好的结果。

如果您使用的是 PB 9 或更高版本，您可以生成 COM 或 .NET dll，然后您可以通过 C# GUI 使用它们。我会推荐这个，而不是用任何新语言重写。

请记住，重写从来都不是灵丹妙药，它们最终总是比您最初预期的更加耗时、困难和错误。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-05T18:22:46.607

您可能想花一些时间研究[PowerBuilder 11.5](http://www.sybase.com:80/products/modelingdevelopment/powerbuilder)（最近发布），它增加了一些重要的 .NET 集成。

迁移到 PowerBuilder 11.5 以使用新的 .NET 代码肯定比用 C# 完全重写整个应用程序要容易得多。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-07T12:56:37.153

我不知道它是否好用，但请查看这个（商业）产品： [PB.Net](http://www.felix.fr/produits/PBNet/PBNet.cfm)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-08T16:58:58.443

> > 我本周的宠物理论是，PowerBuilder 开发人员认为 DataWindow 是理所当然的，直到他们必须重现所有内置功能。

我支持那个理论。几年前，我在一个项目中尝试过从 PB8 到 Java 的转换，即使使用第一代 HTML DataWindow 也失败了。我现在的雇主一心想迁移到 C#，尽管我们当前的产品中有超过 2K 的 DWO，但不使用 Datawindow.NET。我不期待实现的那一天。（整个产品由几个用户应用程序、十几个服务和大约 70 个 PBD 组成）

OP - 除非您的应用程序结构异常良好（可能最初是为 EA 服务器编写的？），否则这不会是一个端口。在 PB 和 .NET 环境中，事情的工作方式太不同了，普通端口无法令人满意地工作。这一点我怎么强调都不过分——如果你真的在使用 PB 事件模型，那么“端口”可能会失败。

您需要查看逻辑流（交织的 UI 和流程）、控制流（*现在*谁拥有流程或数据）、数据访问（UI、数据层，??）以及您正在使用的 DW 事件模型的各个部分从代码。如果您正在考虑 ASP.NET（就像我们一样），您的整个用户交互体验将不得不改变，这将反馈到其他考虑因素中。

与代码没有直接关系，构建自动化会发生变化（我们使用 PowerGen 进行一致的 PB 构建；MSBuild 非常不同），您的安装和设置也会发生变化。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-12T21:20:23.230

我认为任何考虑将其用于大型应用程序的人都会非常疯狂地不认真考虑使用 DataWindow.NET，以免失去对 DW 的投资。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-11T19:10:08.327

大公司的 PHB 认为 Powerbuilder 是一种玩具语言，迁移到像 C# 这样的新语言是微不足道的，并且可以以低成本完成。事实上，将 PB 应用程序迁移到任何其他语言的成本至少与在新语言上开发全新的应用程序一样多。与原始应用程序相比，生成的应用程序通常会失去功能，并会导致用户不满。我已经看到了许多尝试 - 由于难度和用户问题，所有尝试都失败了。

如果它没有坏，就不要修理它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-03-19T12:16:53.167

是的，它现在是可行的，无需重写服务组件期间。

铅 12.5>

并将目标 GUI 和服务组件迁移和集成到 c#。

迁移/集成策略可能因您的项目范围、可扩展性、资源和时间线而异。

您可以在 PowerBuilder .NET 中使用这些目标和项目类型。请参阅此链接[Sybase_PB .Net](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc37772.1250/html/pbgs/CHDFGFBFAWF.htm)

*   WPF 窗口应用程序 WPF 窗口应用程序、WCF 客户端代理或 REST 客户端代理
*   PB 程序集 WCF 客户端代理、REST 客户端代理或 PB 程序集
*   .NET 程序集 WCF 客户端代理、REST 客户端代理或 .NET 程序集
*   WCF 服务 WCF 客户端代理、REST 客户端代理或 WCF 服务

# ruby-on-rails - How to implement a profanity filter in RoR?

> ID：825389
> 
> 赞同：3
> 
> 时间：2009-05-05T15:19:25.080
> 
> 标签：ruby-on-rails, plugins

I am developing a social web application with RoR. I realized that it's probably a good idea to prevent users from inserting rude or profane language into comments or posts.

Do you know any solution or plug-in that help me prevent something like this?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T15:20:50.020

The correct term you're looking for is a *profanity filter* (edited). Here are some previous discussions on this topic:

*   [How do you implement a good profanity filter?](https://stackoverflow.com/questions/273516/how-do-you-implement-a-good-profanity-filter)
*   ["bad words" filter](https://stackoverflow.com/questions/24515/bad-words-filter)
*   [https://stackoverflow.com/questions/259610/profanity-filtering-profanity-dictionaries-scunthorpe-problem-profanity-generat](https://stackoverflow.com/questions/259610/profanity-filtering-profanity-dictionaries-scunthorpe-problem-profanity-generat)

# .net - Existing connection close when new TCP connections are made

> ID：825391
> 
> 赞同：0
> 
> 时间：2009-05-05T15:19:58.650
> 
> 标签：.net, sockets, tcp

I have a TCP listener service to which the clients connect. Lately I have started receiving this error related to disconnection. I connect around 20 clients to it and the connection works fine. But when I connect another 10 clients to the service, the previous connections break with a 10053 or 10054 error.

Previously it used to run with 100 clients but I am not sure what could be the problem. The service and the clients both are running on Windows Server 2003 because I found that Windows XP has a known problem with multiple TCP connections (related to 10053).

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T15:34:25.933

好吧，您收到的错误非常不同。

10053 是 WSAECONNABORTED - 连接被中止。这通常是由于您的应用程序堆栈中的问题（尽管有时会发生）。

10054 是 WSAECONNRESET - 连接已被对等方重置。这通常是连接另一端的问题。

你如何测试这个？连接到此服务的“客户”是您编写的吗？如果是这样，您应该在收到 10054 时跟踪客户端发生的情况。

此外，这可能是由于网络问题，与您的软件无关（直接）。您运行的网络基础设施是否发生了变化？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T12:17:31.873

我怀疑这是网络问题，或者您可能会在前 20 个客户端连接时看到它发生。只是在黑暗中拍摄，但你是如何处理这些联系的？你在使用某种数组或集合吗？您是否会无意中将现有连接设置为新连接，从而导致系统崩溃？

# asp.net - 详细信息视图行高和/或行间距

> ID：825395
> 
> 赞同：0
> 
> 时间：2009-05-05T15:20:19.850
> 
> 标签：asp.net, css

如何制作特定高度的特定详细信息视图行？我尝试了 css 和 itemstyle-height，但我似乎放错了我的大脑和/或明显不明白某些事情是如何运作的。

可能听起来很愚蠢或不适合使用，但我想使用详细信息视图来显示有关某事的信息，并且我现在用“间隔”行分隔信息。

我的问题的另一个合适的答案是在特定行之后插入空格以确保我的部分是分开的。

为什么我的模板字段的“itemstyle-height”属性不服从我的命令？我要驯服它！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T15:25:54.020

我个人并没有因为以编程方式添加分隔符行而受到冒犯，该行可让您直观地拆分数据的各个部分。

即使这需要在您的数据集中循环一次，您的性能几乎不会改变，并且额外的分隔符行将为您提供很大的灵活性，可以根据需要对部分进行样式、标签和间隔。

# asp.net - IIS 6 是否可以提供未处理的 ASP/ASPX 页面？

> ID：825400
> 
> 赞同：1
> 
> 时间：2009-05-05T15:20:52.533
> 
> 标签：asp.net, asp-classic, iis-6

我能找到的关于这个主题的唯一内容是 1997 年的一篇帖子（[http://insecure.org/sploits/microsoft.asp.iis.html](http://insecure.org/sploits/microsoft.asp.iis.html)），所以我希望这里的某个人可能对此有更多的了解话题：

有谁知道 IIS6 中是否存在任何已知漏洞，允许用户在获得服务器控制权之外查看未处理的 ASP 或 ASPX 页面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T15:26:04.127

仅当从站点的应用程序映射中删除了这些扩展，或者您做了一些其他愚蠢的事情来以这种方式配置它时，IIS 才会提供原始 asp 或 aspx。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T15:25:06.953

为什么你想要未经处理的asp页面？您可以只拥有一个链接，该链接将转义页面并将其放入用户的网页中。

对我来说，这将是一个潜在的安全风险，因为如果你忘记并留下一个安全漏洞，它就会被发现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T15:25:40.383

如果您没有正确设置脚本映射，这可能是一个问题，但这更多是部署时的问题，而不是运行时的问题。

我认为该领域的任何其他漏洞都与应用程序相关（选择文件下载服务器端......），而不是与平台相关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T15:26:05.080

您是否担心人们能够看到您的源代码？如果是这样，我就不会太担心了，尤其是使用 .net 和使用文件隐藏代码，以及适当架构的 n 层站点。

真的，唯一值得担心的是，如果您的页面上有错误并且您吐出调试代码，即使使用经典的 asp。

# javascript - 为什么 isNaN(" ")（带空格的字符串）等于 false？

> ID：825402
> 
> 赞同：179
> 
> 时间：2009-05-05T15:21:15.323
> 
> 标签：javascript, nan

在 JavaScript 中，为什么`isNaN(" ")`评估为`false`，但`isNaN(" x")`评估为`true`？

我正在对文本输入字段执行数字运算，并且正在检查该字段是`null`、`""`还是`NaN`。当有人在该字段中键入少量空格时，我的三个验证都失败了，我很困惑为什么它会通过`isNaN`检查。

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2009-05-05T15:27:11.207

JavaScript 将空字符串解释为 0，然后 isNAN 测试失败。您可以首先在字符串上使用 parseInt，它不会将空字符串转换为 0。结果应该会失败 isNAN。

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2009-05-05T15:34:54.527

您可能会觉得这很奇怪，也可能不会，但这里有一些测试代码可以向您展示 JavaScript 引擎的古怪之处。

```
document.write(isNaN("")) // false
document.write(isNaN(" "))  // false
document.write(isNaN(0))  // false
document.write(isNaN(null)) // false
document.write(isNaN(false))  // false
document.write("" == false)  // true
document.write("" == 0)  // true
document.write(" " == 0)  // true
document.write(" " == false)  // true
document.write(0 == false) // true
document.write(" " == "") // false 
```

所以这意味着

```
" " == 0 == false 
```

和

```
"" == 0 == false 
```

但

```
"" != " " 
```

玩得开心 ：）

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-05T15:32:00.837

为了更好地理解它，请打开第 43 页“ToNumber 应用于字符串类型”的[Ecma-Script 规范 pdf](http://www.ecma-international.org/publications/standards/Ecma-262.htm)

如果字符串具有数字语法，可以包含任意数量的空白字符，则可以将其转换为 Number 类型。空字符串计算为 0。字符串 'Infinity' 也应该给出

```
isNaN('Infinity'); // false 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-05T15:27:27.383

尝试使用：

```
alert(isNaN(parseInt("   "))); 
```

或者

```
alert(isNaN(parseFloat("    "))); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-05-03T07:25:39.173

从[`MDN`](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/isNaN)您面临的问题的原因

> 当 isNaN 函数的参数不是 Number 类型时，该值首先被强制转换为 Number。然后测试结果值以确定它是否为 NaN。

您可能需要检查以下全面的答案，该答案也涵盖了 NaN 比较的相等性。

> [如何测试 JavaScript 变量是否为`NaN`](https://stackoverflow.com/a/35912757/893612)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-05T15:27:37.523

我认为这是因为 Javascript 的输入：`' '`被转换为零，而`'x'`不是：

```
alert(' ' * 1); // 0
alert('x' * 1); // NaN 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-03-10T12:11:38.117

### 不完全正确的答案

Antonio Haley 的[高度赞成和接受的答案](https://stackoverflow.com/a/825430/1317805)在这里错误地假设这个过程通过 JavaScript 的`parseInt`函数：

> 您可以在字符串上使用 parseInt ...然后结果应该失败 isNAN。

我们可以很容易地用字符串反驳这个说法`"123abc"`：

```
parseInt("123abc")    // 123     (a number...
isNaN("123abc")       // true     ...which is not a number) 
```

有了这个，我们可以看到 JavaScript 的`parseInt`函数`"123abc"`以数字的形式返回`123`，但它的`isNaN`函数告诉我们这`"123abc"` *不是*数字。

### 正确答案

[ECMAScript-262 在第 18.2.3 节](https://tc39.github.io/ecma262/#sec-isnan-number)中定义了`isNaN`检查的工作方式。

> # 18.2.3 `isNaN`（数量）
> 
> `isNaN`函数是`%isNaN%`内在对象。当`isNaN`使用一个参数号调用函数时，将执行以下步骤：
> 
> 1.  让`num`？`ToNumber(number)`.
> 2.  如果`num`是`NaN`，则返回`true`。
> 3.  否则，返回`false`。

它引用的`ToNumber`函数也在[ECMAScript-262 的第 7.1.3 节](https://tc39.github.io/ecma262/#sec-tonumber)中定义。在这里，我们被告知 JavaScript 如何处理传递给该函数的字符串。

问题中给出的第一个示例是一个只包含空格字符的字符串。本节规定：

> `StringNumericLiteral`为空或仅包含空格的A将转换为`+0`.

示例字符串因此`" "`被转换为`+0`，它是一个数字。

同一部分还指出：

> 如果语法不能将 解释`String`为 的扩展`StringNumericLiteral`，则 的结果`ToNumber`是`NaN`。

如果不引用该部分中包含的所有检查，`" x"`则问题中给出的示例属于上述条件，因为它不能解释为`StringNumericLiteral`. `" x"`因此转换为`NaN`。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-05T15:38:23.287

如果你想实现一个准确的 isNumber 函数，这里有一种从*Javascript 中实现的方法：Douglas Crockford 的 The Good Parts* [第 105 页]

```
var isNumber = function isNumber(value) {
   return typeof value === 'number' && 
   isFinite(value);
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-09-13T21:38:09.747

该函数`isNaN("")`执行**字符串到数字*类型强制***

[ECMAScript 3-5 为 typeof 运算符定义了以下返回值：](http://www.ecma-international.org/ecma-262/5.1/#sec-11.4.3)

*   不明确的
*   对象（空，对象，数组）
*   布尔值
*   数字
*   细绳
*   功能

最好将我们的测试包装在一个函数体中：

```
function isNumber (s) {
    return typeof s == 'number'? true
           : typeof s == 'string'? (s.trim() === ''? false : !isNaN(s))
           : (typeof s).match(/object|function/)? false
           : !isNaN(s)
} 
```

此函数不打算测试变量*类型*，而是测试*强制值*。例如，布尔值和字符串被强制转换为数字，因此您可能希望将此函数称为`isNumberCoerced()`

如果不需要测试除*string*和*number*以外的*类型*，则可以使用以下代码段作为某些条件的一部分：

 **```
if (!isNaN(s) && s.toString().trim()!='') // 's' can be boolean, number or string
    alert("s is a number") 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-10-26T09:39:40.603

如果您真的想要正确检查它是否是整数，我建议您使用以下函数：

```
function isInteger(s)
{
   return Math.ceil(s) == Math.floor(s);
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-04-29T15:22:11.520

这`isNaN(" ")`是错误的，这是`isNaN`全局函数令人困惑的行为的一部分，因为它将非数字强制转换为数字类型。

*来自[MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/isNaN#Confusing_special-case_behavior)*：

> 自函数规范的最早版本以来`isNaN`，它对非数字参数的行为一直令人困惑。当`isNaN`函数的参数不是 Number 类型时，该值首先被强制转换为 Number。然后测试结果值以确定它是否为`NaN`. 因此，对于非数字，当强制转换为数字类型时会产生有效的非 NaN 数值（尤其是空字符串和布尔基元，当强制转换为数字值 0 或 1）时，“false”返回值可能是意料之外的；例如，空字符串肯定是“不是数字”。

另请注意，使用 ECMAScript 6，现在也有该`Number.isNaN`方法，根据 MDN：

> 与全局`isNaN()`函数相比，`Number.isNaN()`不会遇到强制将参数转换为数字的问题。这意味着现在可以安全地传递通常会转换为`NaN`的值，但实际上与`NaN`. 这也意味着只有 number 类型的值，也就是`NaN`return `true`。

**不幸的是**：

甚至 ECMAScript 6`Number.isNaN`方法也有其自身的问题，如博客文章 -[修复丑陋的 JavaScript 和 ES6 NaN 问题](http://lucono.com/post/117486285002/fixing-the-ugly-javascript-and-es6-nan-problem)中所述。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-07-23T09:25:40.823

该`isNaN`函数需要一个数字作为其参数，因此任何其他类型的参数（在您的情况下为字符串）将在执行实际函数逻辑*之前转换为数字。*（请注意，这`NaN`也是 Number 类型的值！）

顺便提一句。这对于*所有*内置函数都很常见 - 如果它们需要某种类型的参数，则实际参数将使用标准转换函数进行转换。所有基本类型（bool、string、number、object、date、null、undefined）之间都有标准转换。

可以使用 显式调用`String`to的标准转换。所以我们可以看到：`Number``Number()`

*   `Number(" ")`评估为`0`
*   `Number(" x")`评估为`NaN`

鉴于此，`isNaN`函数的结果是完全合乎逻辑的！

真正的问题是为什么标准的字符串到数字的转换会像它那样工作。字符串到数字的转换实际上是为了将像“123”或“17.5e4”这样的数字字符串转换为等效的数字。转换首先跳过初始空白（因此“123”有效），然后尝试将其余部分解析为数字。如果它不能解析为数字（“x”不是），则结果为 NaN。但是有一个明确的特殊规则，即空字符串或只有空格的字符串将转换为 0。所以这解释了转换。

参考： http: [//www.ecma-international.org/ecma-262/5.1/#sec-9.3.1](http://www.ecma-international.org/ecma-262/5.1/#sec-9.3.1)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-08-08T10:03:56.800

`NaN`!== "不是数字"

`NaN`是数字类型的值

这是 ECMAScript 中 isNaN() 的定义

```
1\. Let num be ToNumber(number).
2\. ReturnIfAbrupt(num).
3\. If num is NaN, return true.
4\. Otherwise, return false. 
```

尝试将任何值转换为数字。

```
Number(" ") // 0
Number("x") // NaN
Number(null) // 0 
```

如果要确定该值是否为`NaN`，则应先尝试将其转换为 Number 值。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-05T15:28:00.830

我不知道*为什么*，但为了解决这个问题，你总是可以在检查之前修剪空白。无论如何，您可能都想这样做。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-12-14T00:18:08.487

我写了这个快速的小函数来帮助解决这个问题。

```
function isNumber(val) {
     return (val != undefined && val != null && val.toString().length > 0 && val.toString().match(/[^0-9\.\-]/g) == null);
}; 
```

它只检查任何非数字 (0-9)、非“-”或“.”、非未定义、null 或空字符，如果没有匹配则返回 true。:)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-08-28T03:15:11.183

正如其他解释的那样，该`isNaN`函数将在验证之前将空字符串强制转换为数字，从而将空字符串更改为 0（这是一个有效数字）。但是，我发现在尝试解析空字符串或只有空格的字符串时，该`parseInt`函数会返回。`NaN`因此，以下组合似乎运作良好：

`if ( isNaN(string) || isNaN(parseInt(string)) ) console.log('Not a number!');`

此检查适用于正数、负数和带小数点的数字，因此我相信它涵盖了所有常见的数字情况。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-02-03T12:41:26.030

这个功能似乎在我的测试中有效

```
function isNumber(s) {
    if (s === "" || s === null) {
        return false;
    } else {
        var number = parseInt(s);
        if (number == 'NaN') {
            return false;
        } else {
            return true;
        }
    }
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-07-12T13:22:57.953

关于什么

```
function isNumberRegex(value) {        
    var pattern = /^[-+]?\d*\.?\d*$/i;
    var match = value.match(pattern);
    return value.length > 0 && match != null;
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-01-08T01:01:53.293

***JavaScript***内置的isNaN**函数**是 - 正如默认情况下所预期的那样 - 一个“动态类型运算符”。因此（在 DTC 过程中）可能产生简单真 | 的所有值。假如`"", " ", " 000"`, 不能为 NaN。

这意味着提供的*参数*将首先进行*转换*，如下所示：

```
function isNaNDemo(arg){
   var x = new Number(arg).valueOf();
   return x != x;
} 
```

**解释：**

在函数体的第一行，我们（首先）尝试成功地将参数转换为数字对象。并且（第二），我们使用点运算符——为了我们自己的方便——立即剥离所创建对象*的**原始**值*。

***在第二行中，我们取上一步中获得的值，以及NaN***不等于宇宙中的任何东西，甚至不等于自身这一事实的优势，例如：`NaN == NaN >> false`最终将其（不等式）与自身进行比较.

这样，只有当且仅当提供的参数返回是转换为数字对象（即非数字数字）的失败尝试时，函数才会返回***true ；***例如，NaN。

* * *

***isNaN静态()***

但是，对于静态类型运算符 - 如果需要和需要时 - 我们可以编写一个更简单的函数，例如：

```
function isNaNstatic(x){   
   return x != x;
} 
```

并完全避免 DTC，这样如果参数不是明确的 NaN 数，它将返回 false。因此，针对以下内容进行测试：

`isNaNStatic(" x"); // will return false`因为它仍然是一个字符串。

但是： `isNaNStatic(1/"x"); // will of course return true.`例如将`isNaNStatic(NaN); >> true`。

但与 相反`isNaN`，`isNaNStatic("NaN"); >> false`因为它（参数）是一个普通字符串。

ps：isNaN 的静态版本在现代编码场景中非常有用。这很可能是我花时间发布此内容的主要原因之一。

问候。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-04-12T06:32:11.530

`isNAN(<argument>)`是一个判断给定参数是否为非法数字的函数。 `isNaN`将参数类型转换为 Number 类型。如果要检查参数是否为数字？请`$.isNumeric()`在 jQuery 中使用函数。

也就是说， isNaN(foo) 等价于 isNaN(Number(foo)) 出于显而易见的原因，它接受具有所有数字作为数字的任何字符串。例如。

```
isNaN(123) //false
isNaN(-1.23) //false
isNaN(5-2) //false
isNaN(0) //false
isNaN('123') //false
isNaN('Hello') //true
isNaN('2005/12/12') //true
isNaN('') //false
isNaN(true) //false
isNaN(undefined) //true
isNaN('NaN') //true
isNaN(NaN) //true
isNaN(0 / 0) //true 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-10-27T12:41:53.830

我用这个

```
 function isNotANumeric(val) {
    	if(val.trim && val.trim() == "") {
         return true;
      } else {
      	 return isNaN(parseFloat(val * 1));
      }
    }

    alert(isNotANumeric("100"));  // false
    alert(isNotANumeric("1a"));   // true
    alert(isNotANumeric(""));     // true
    alert(isNotANumeric("   "));  // true
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-08-13T07:07:56.410

当检查某个字符串值是否带有空格或者`" "`可能`isNaN`尝试执行字符串验证时，例如：

`// value = "123 " if (value.match(/\s/) || isNaN(value)) { // do something }`

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2020-09-01T02:20:46.747

我发现有一个特定于 Number 类的方法很方便（因为像 parseInt 这样进行转换的其他函数对其中一些值有不同的输出）并使用原型继承。

```
Object.assign(Number.prototype, {
  isNumericallyValid(num) {
    if (
      num === null
      || typeof num === 'boolean'
      || num === ''
      || Number.isNaN(Number(num))
    ) {
      return false;
    }
    return true;
  }
}); 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-07-13T12:53:15.487

```
let isNotNumber = val => isNaN(val) || (val.trim && val.trim() === '');

console.log(isNotNumber(' '));
console.log(isNotNumber('1'));
console.log(isNotNumber('123x'));
console.log(isNotNumber('x123'));
console.log(isNotNumber('0'));
console.log(isNotNumber(3));
console.log(isNotNumber('    x'));
console.log(isNotNumber('1.23'));
console.log(isNotNumber('1.23.1.3'));

if(!isNotNumber(3)){
  console.log('This is a number');
}
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-08-26T11:43:46.873

我使用以下。

`x=(isNaN(parseFloat(x)))? 0.00 : parseFloat(x);`

# javascript - 添加图像叠加的问题（jQuery）

> ID：825403
> 
> 赞同：1
> 
> 时间：2009-05-05T15:21:17.900
> 
> 标签：javascript, jquery, image, overlay

我想要做的是找到所有具有特定类名的图像，并在它们上面放置一个覆盖图像。到目前为止，我在 jQuery 1.2.6 中的脚本：

```
jQuery.noConflict();
jQuery(document).ready( function($) {
  var module = $(".module-contactus div div div");
  module.find("img.let").each( function() {
    var iWidth = $(this).width();
    var iHeight = $(this).height();
    var letimg = $('<img src="/LET.png" style="position: absolute; top: 50%; left: 50%; margin-top: -' + Math.ceil(iHeight/2) + 'px; margin-left: -' + Math.ceil(iWidth/2) + 'px;" />');
    var wrapper = $( '<span style="position: relative; display: inline-block;"></span>' );
    $(this).wrap( wrapper );
    letimg.appendTo( wrapper );
  });
}); 
```

未`letimg`添加到文档中（根据 Firebug）。该`span`元素成功地包装了原始图像。此外，如果我传入`$(this)`该`appendTo`函数，它确实会起作用，但是它会被添加到原始图像中！

**编辑：**标记如下。（额外的 div 是 Joomla 的结果。）

```
<div class="module-contactus">
<div><div><div>

<img src="/contact1.jpg" />
<img class="let" src="/contact2.jpg" />

</div></div></div>
</div> 
```

脚本运行后，第二个图像被替换为：

```
<span style="position: relative; display: inline-block;">
<img class="let" src="/contact2.jpg" />
</span> 
```

但是，它最终应该是这样的：

```
<span style="position: relative; display: inline-block;">
<img class="let" src="/contact2.jpg" />
<img src="/LET.png" style="..." />
</span> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T15:35:09.910

这对我有用：

```
jQuery.noConflict();
jQuery(function($) {
    $("img.let", $(".module-contactus div div div")).each(function() {
        var iWidth = $(this).width();
        var iHeight = $(this).height();
        var letimg = '<img src="http://www.roomsinworcester.co.uk/images/stories/LET.png" style="position: absolute; top: 50%; left: 50%; margin-top: -' + Math.ceil(iHeight/2) + 'px; margin-left: -' + Math.ceil(iWidth/2) + 'px;" />';
        var wrapper = $('<span style="position: relative; display: inline-block;"></span>');
        $(this).wrap(wrapper).after(letimg);
    });
}); 
```

作为旁注。我取出了您的几个变量，并会说您可能可以继续删除其他变量（将 img 标签直接放入 after，将包装器直接放入 wrap 函数等）。不过，这两种方式都不是什么大不了的事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:45:08.527

我不确定你是否需要包装器。

尝试这样的事情。

```
jQuery(document).ready( function($) {
    var module = $(".module-contactus div div div");
    module.find("img.let").each( function() {                
        var iWidth = $(this).width();                
        var iHeight = $(this).height();                
        var letimg = $('<img src="http://www.roomsinworcester.co.uk/images/stories/LET.png" style="position: absolute; top: 50%; left: 50%; margin-top: -' + Math.ceil(iHeight/2) + 'px; margin-left: -' + Math.ceil(iWidth/2) + 'px;" />');                
        $(this).before(letimg);         
        alert(module.html());
    });
  }); 
```

# asp.net - asp.net custom grid vs GridView/ListView

> ID：825413
> 
> 赞同：1
> 
> 时间：2009-05-05T15:22:46.350
> 
> 标签：asp.net, grid

A few years ago, I decided to create my own DataGrid as I didn’t like the standard one provided by Microsoft. It’s a very simple function which takes a DataTable as an input parameter and which returns a string (the html code to display a table on a webpage).

It’s very flexible (there are some optional parameters to do the paging, sorting and to format each column the way I want) and fast (only the records which are used are retrieved from the database). The function itself is very short (about 20ish lines of code). I’ve been using it for at least 4 years now.

Assuming you have a PlaceHolder on your webpage, this is how you would call the custom function:

```
MyPlaceHolder.Controls.Add(new LiteralControl(CreateCustomGrid(MyDataTable))) 
```

CreateCustomGrid(MyDataTable))) would return something like this (if MyDataTable has 2 columns and 2 rows):

```
<table class="MyClass"  rules="all">
  <tr>
      <th>Column1</th>
      <th>Column2</th>
  </tr>
   <tr>
      <td align="center">Value1</td>
      <td align="center">Value2</td>
  </tr>
    <tr>
      <td align="center">Value3</td>
      <td align="center"><a href=’MyLink’&gt;Value4</a></td>
  </tr>
  </table> 
```

Internally the function knows how to format each column (this function is only being used on one website) but it’s also possible to change it for each individual column by using optional parameters. Same for the paging and sorting. All in all it’s very flexible and very easy to use.

Now things have changed and the DataGrid has been replaced by the GridView and/or ListView. I’ve looked at them but I don’t see anything that they do that my function doesn’t so I would be tempted to carry on using my function but I might be overlooking something. At the same time, it looks a bit odd to carry on using a custom function to generate an html table. What’s your views on this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T15:31:02.540

如果您的代码有效且经验丰富，我不会更改任何现有代码。对于其他功能，您可能需要考虑将其包装在自定义数据绑定 WebControl 中。这样你就可以使用数据源等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:30:29.453

我想说你应该调查 GridView/ListView 看看他们能做什么，但最终，如果你和你的客户对你自己的代码感到满意并且它对你有用，那么你需要它做的一切，那么就没有必要改变只是因为那里有其他东西。

# java - 如何登录 JBoss 控制台

> ID：825421
> 
> 赞同：0
> 
> 时间：2009-05-05T15:25:10.683
> 
> 标签：java, logging, jboss, log4j

我正在试验 Netbeans 和 JBoss，我想用我的代码在 JBoss 控制台上打印东西。我可以为此使用 log4j 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T15:32:30.587

是的。如果您想显示低于 INFO（默认级别），请编辑 $JBOSS_HOME/server/[config]/conf/jboss-log4j.xml 添加一个类别。

[config] --> default、minimal、web等之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T21:33:56.363

`import org.jboss.logging.Logger;`

```
Logger.getLogger(this.getClass()).info("put your message here"); 
```

在 jboss7 和 StandAlone 模式下，您的日志将在这里：
`\jboss-as-7.1.1.Final\standalone\log`

# .net - 指定命名空间时如何将 XML 序列化为通用集合

> ID：825423
> 
> 赞同：1
> 
> 时间：2009-05-05T15:25:44.067
> 
> 标签：.net, xml-serialization, xml-namespaces

假设我有以下 XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<Customers xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="Customer.xsd">
    <Customer>
        <FirstName></FirstName>
        <LastName></LastName>
    </Customer>
    <Customer>
        <FirstName></FirstName>
        <LastName></LastName>
    </Customer>
    <Customer>
        <FirstName></FirstName>
        <LastName></LastName>
    </Customer>
</Customer> 
```

我还创建了一个映射到适当字段的 Customer 对象。

现在，如果我尝试将其序列化为这样的通用列表：

```
XmlSerializer xml = new XmlSerializer(typeof(List<Customer>)); 
```

我会遇到异常，因为我的 List 未映射到与 XML 文档中的客户相同的命名空间，并且我无法将其添加为属性，因为我使用的是通用列表，而不是自定义集合

如何在不创建自定义集合的情况下告诉序列化程序将命名空间与列表匹配？

编辑：我应该详细说明一下，序列化程序抛出的异常是：

（客户 xmlns=''> 不是预期的。

现在因为我使用 List(T) 作为父节点，如何将通用列表与 XML 文档中指定的命名空间相匹配？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T16:07:33.153

我认为该错误与 <Customers> 节点而不是 xmlns 有关。

尝试

```
XmlRootAttribute xr = new XmlRootAttribute("Customers");
XmlSerializer xs = new XmlSerializer(typeof(List<Customer>), xr); 
```

默认情况下，它需要一个 <ArrayOfCustomer> 节点

# visual-studio - 如何在 Visual Studio 中调试 mbunit/Gallio 单元测试

> ID：825424
> 
> 赞同：9
> 
> 时间：2009-05-05T15:25:53.223
> 
> 标签：visual-studio, mbunit, gallio

我试图弄清楚如何在用 MbUnit/Gallio 编写的单元测试中打断点。我尝试运行 Gallio.Icarus，将 vs 调试器附加到它，断点没有被命中。接下来，我尝试从项目属性中启动 Gallio.Echo，但在提供 dll 后，我收到一条错误消息，说只能测试 .exe。单元测试从 Gallio.Icarus 运行良好，但是，我无法调试它们。

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-05T18:09:35.747

Grab Gallio v3.0.6 更新 1\. 加载您的测试并单击 Icarus GUI 本身中闪亮的新“调试”按钮。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-05T15:37:20.933

我会为此使用[TestDriven.Net](http://www.testdriven.net/)。它支持 MbUnit 测试，您只需在 Visual Studio 中单击鼠标右键即可进行调试

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-04T03:32:29.353

在这里可以找到更好的答案： [gallio test runner plugin to visual studio 2010](https://stackoverflow.com/questions/2634665/gallio-test-runner-plugin-to-visual-studio-2008-and-2010-for-mbunit-tests)

答案是将以下部分添加到您的 *.csproj 文件的 <ProjectGuid> 部分部分之后：

```
 <ProjectTypeGuids>
        {3AC096D0-A1C2-E12C-1390-A8335801FDAB}
      ; {FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}
    </ProjectTypeGuids> 
```

另请参阅：
[Visual Studio Identiy 如何测试项目？](https://stackoverflow.com/questions/7009943/how-does-visual-studio-mstest-identify-test-projects)
[支持的 VS2010 项目类型](http://onlinecoder.blogspot.com/2009/09/visual-studio-projects-project-type.html)
[列表 支持的项目类型的第二个 GUID 列表](http://www.mztools.com/articles/2008/MZ2008017.aspx)

# asp.net-ajax - 级联下拉菜单而不使用任何网络服务

> ID：825433
> 
> 赞同：1
> 
> 时间：2009-05-05T15:27:32.550
> 
> 标签：asp.net-ajax

我正在寻找一种在不使用 Web 服务的情况下进行级联下拉菜单的方法并遇到此[链接](http://forums.asp.net/p/1158057/1907062.aspx)

我尝试了底部的建议，但我得到了方法 500 错误。我在网上搜索这个错误，但我能找到的只是增加网络服务 jasonserislation 的大小，但我根本没有使用网络服务，所以我认为这不适用。

有谁知道如何在不使用 Web 服务或遇到更好的教程/howto 的情况下进行级联下拉菜单？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T15:44:24.800

Cascading Dropdown 控件并非设计为在没有 Web 服务的情况下使用。我在使用带有大型数据集的控件时遇到了大问题。我最终最终做的是以下内容：

```
<asp:ScriptManager ID="ScriptManager" runat="server" />
<asp:UpdatePanel ID="Panel1" runat="server" ChildrenAsTriggers="true">
    <ContentTemplate>
        <asp:DropDownList ID="ddlDropdown1" runat="server" OnSelectedIndexChanged="ddlDropdown1_IndexChanged" AutoPostBack="true" />
        <asp:DropDownList ID="ddlDropdown2" runat="server" />
    </ContentTemplate>
</asp:UpdatePanel>

protected void ddlDropdown1_IndexChanged (object sender, EventArgs e)
{
   // Do database access
   ....
   // Populate ddlDropdown2
} 
```

这将允许您根据需要填充尽可能多的下拉菜单级别。此解决方案不使用 Cascading Dropdown 控件，但确实为您提供了相同的效果。500 错误是来自 AJAX 的一般数据错误，通常表明您没有使用 Web 服务类上方的 [ScriptService()] 装饰器。

# php - 传递给 create_function 的 PHP 沙箱/清理代码

> ID：825434
> 
> 赞同：2
> 
> 时间：2009-05-05T15:27:37.277
> 
> 标签：php, lambda, sandbox, create-function

我正在使用 create_function 在服务器端运行一些用户代码。我正在寻找以下两个中的任何一个：

1.  有没有办法清理传递给它的代码以防止执行有害的东西？
2.  或者，有没有办法指定此代码在沙盒环境中运行，以便用户无法玩弄其他任何东西。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-07-10T09:19:49.887

[http://php.net/runkit](http://php.net/runkit)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T15:37:55.737

您可以使用[tonkenizer](http://www.php.net/manual/en/book.tokenizer.php)确定代码将做什么，然后将某些功能和操作列入白名单。我认为最终很难（或不可能）使其万无一失，特别是考虑到 PHP 的灵活性：

```
$f = "shell_exec";
$arg = 'rm -rf /';

$f($arg); // ouch
call_user_func($f, $arg); // ouch
eval("$f('$arg');"); // ouch

$newF = create_user_function('', "$f('$arg');");
$newF(); // ouch 
```

唯一可以为您提供 100% 安全性（嗯，99.9%...）的沙盒是您事后可以丢弃的虚拟机。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-04-25T00:53:11.087

我们使用标记器静态分析代码，以及修改代码以对某些事物执行运行时检查。这是通过标记器和基于标记器的脚本完成的。由于标记器与 PHP 实际使用的标记器相同，因此与编写自己的标记器相比，它可以提高您的运气。

我见过人们使用正则表达式来尝试分析一种语言。这是一个非常糟糕的主意。

但 ...

由于 PHP 是一种非常简单的语法，并且您可以访问标记器，因此您实际上可以通过禁止变量函数并仅允许调用少量列入白名单的函数来阻止大部分错误。如果您不需要 OOP，那就更好了。

但是，我们没有足够的信心解决 100% 的问题，我们用它来为付费客户的*后端*用户提供沙箱，而不是地球上每个使用键盘的用户，也许还有恶意。

我也认为这里那些将想法 100% 视为“坏做法”的人需要得到线索。有理由这样做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T06:49:35.577

您可以尝试使用基于 Java 的 PHP 解释器 Quercus 来创建安全的沙盒 PHP 环境。你可以使用 Rhino 对 JavaScript 做同样的事情，所以我认为 Quercus 可能是可能的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-05T15:34:18.023

您无法可靠地清理用户输入 - 一个坚定的黑客会找到一些晦涩难懂的方法来规避您的清理代码。

沙盒是可能的，但同样严重。如果你真的想要安全，你应该为每个调用创建一个沙箱。毕竟，有人可以执行对您沙箱的所有其他用户有害的虚假代码。

我不认为你真的想允许这样做。可以这样想：您正在提供对服务器的编程访问！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T16:00:11.300

您可以考虑创建一种用户可以使用的自定义（化）语言。然后由您来创建支持的函数库，这些函数库很可能只是 PHP 原生函数的包装器。但即便如此，使其免受黑客攻击或简单地工作充其量只是一项乏味的工作。或许您应该重新评估为什么希望用户首先拥有代码访问权限？如果您需要有人讨论这个问题，我很乐意提供帮助（或者更新您的问题，我猜？:)

希望你能解决！

-戴夫

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-07-02T10:40:04.257

这是 GitHub 上的一门课程，在早期阶段可能会有所帮助，但看起来很有希望。

[https://github.com/fregster/PHPSandbox](https://github.com/fregster/PHPSandbox)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-28T14:15:14.093

总体而言，这是个坏主意，而且 IMO 太危险了，无论您采取了何种保护措施。更好地创建一种伪语言，仅限于允许用户做的事情。

# facebook - 如何在我的网站上实施 Facebook 聊天？

> ID：825441
> 
> 赞同：1
> 
> 时间：2009-05-05T15:28:59.910
> 
> 标签：facebook

我正在开发一个类似于顶部 Digg 栏的网站。要求的功能之一是使用 Facebook 进行实时聊天。是否可以使用 Facebook Connect 或其他方法在我的网站上实现 Facebook 聊天？如果是这样，怎么办？

**[更新]**我已经看到它适用于 Pidgin 和 Adium，但我正在寻找的是基于站点的实现（想想 AJAX 和 HTML 位于页面顶部）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T15:42:24.260

Facebook 团队似乎至少已经开始（如果尚未完成）为 Facebook 聊天[实现 xmpp/jabber](http://www.facebook.com/news.php?blog=1&story=110)接口。这将允许您使用任何启用 XMPP 的客户端连接到 Facebook。也就是说，我至少可以找到一个可用的[javascript jabber 客户端库](http://blog.jwchat.org/jsjac/)。虽然，您可能必须在您的 Web 服务器上实现一个代理，以允许 JS 客户端与 Facebook 服务器通信。

此外，我不确定他们是如何做到的，但 Meebo 已经设法在他们的网站上通过 Facebook Connect启用[Facebook 聊天集成。](http://www.insidefacebook.com/2009/02/05/meebo-launches-first-official-facebook-connect-chat-integration/)我没有找到任何提及它的内容，但是可以通过 Facebook Connect API（[文档](http://wiki.developers.facebook.com/index.php/Facebook_Connect)）轻松获得此功能。

回答你的问题：是的，有可能。

# sql - Update Query from a Lookup Query

> ID：825458
> 
> 赞同：1
> 
> 时间：2009-05-05T15:33:11.910
> 
> 标签：sql, ms-access, nested, ms-access-2007

I have a spreadsheet that I am converting to an Access DB. I have a column of typed out customer names that I want to replace with the appropriate customer number from our accounting system.

I have created a table with the customer info, and a query that shows what ID needs to be inserted into the source data. What I'm looking for is:

```
UPDATE tblStarting_Data
SET CustomerID=x
WHERE TEMPCustomer=y 
```

Where X and Y come from qryIDPerCustomer.

Can I use a loop? How do I reference another query?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T15:45:52.007

Another possibility in MS Access (object names borrowed from Tomalak answer):

```
UPDATE tblStarting_Data, qryIDPerCustomer
SET tblStarting_Data.CustomerID=qryIDPerCustomer.CustomerID
WHERE tblStarting_Data.TEMPCustomer=qryIDPerCustomer.CustomerName 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T15:42:58.190

I think a JOIN will help you:

```
UPDATE 
  tblStarting_Data AS sd 
  INNER JOIN qryIDPerCustomer AS qc ON sd.TEMPCustomer = qc.CustomerName
SET 
  sd.CustomerID = qc.CustomerID; 
```

This can be expressed as a correlated sub-query as well (though the join syntax is preferable):

```
UPDATE 
  tblStarting_Data
SET 
  CustomerID = (
    SELECT  CustomerID 
    FROM    qryIDPerCustomer
    WHERE   CustomerName = tblStarting_Data.TEMPCustomer
  ) 
```

No need for a loop, both statements will update all records in `tblStarting_Data` in one step.

# xml - 递归读取 xml 文档并使用正则表达式获取内容

> ID：825459
> 
> 赞同：1
> 
> 时间：2009-05-05T15:33:42.610
> 
> 标签：xml, regex, xslt

我有一个如下的 xml 文档：

```
<menuitem navigateurl="/PressCentre/" text="&#1087;&#1088;&#1077;&#1089; &#1094;&#1077;&#1085;&#1090;&#1098;&#1088;">
    <menuitem navigateurl="/PressCentre/RegisterForPressAlerts/" text="&#1088;&#1077;&#1075;&#1080;&#1089;&#1090;&#1098;&#1088; &#1079;&#1072; &#1087;&#1088;&#1077;&#1089; &#1089;&#1098;&#1086;&#1073;&#1097;&#1077;&#1085;&#1080;&#1103;" />
    <menuitem navigateurl="/PressCentre/PressReleases/" text="&#1087;&#1088;&#1077;&#1089; &#1089;&#1098;&#1086;&#1073;&#1097;&#1077;&#1085;&#1080;&#1103;">
        <menuitem navigateurl="/PressCentre/PressReleases/PressReleasesArchive/" text="&#1072;&#1088;&#1093;&#1080;&#1074; &#1087;&#1088;&#1077;&#1089; &#1089;&#1098;&#1086;&#1073;&#1097;&#1077;&#1085;&#1080;&#1103;" />
    </menuitem>
    <menuitem navigateurl="/PressCentre/PressKit/" text="&#1087;&#1088;&#1077;&#1089; &#1082;&#1086;&#1084;&#1087;&#1083;&#1077;&#1082;&#1090;">
        <menuitem navigateurl="/PressCentre/PressKit/FactSheets/" text="&#1089;&#1087;&#1080;&#1089;&#1098;&#1082; &#1092;&#1072;&#1082;&#1090;&#1080;" />
        <menuitem navigateurl="/PressCentre/PressKit/ExpertComments/" text="&#1082;&#1086;&#1084;&#1077;&#1085;&#1090;&#1072;&#1088;&#1080; &#1085;&#1072; &#1077;&#1082;&#1089;&#1087;&#1077;&#1088;&#1090;&#1080;" />
        <menuitem navigateurl="/PressCentre/PressKit/Testimonials/" text="&#1087;&#1088;&#1077;&#1087;&#1086;&#1088;&#1098;&#1082;&#1080;" />
        <menuitem navigateurl="/PressCentre/PressKit/MediaFiles/" text="&#1084;&#1077;&#1076;&#1080;&#1103; &#1092;&#1072;&#1081;&#1083;&#1086;&#1074;&#1077;" />
        <menuitem navigateurl="/PressCentre/PressKit/Photography/" text="&#1089;&#1085;&#1080;&#1084;&#1082;&#1080;" />
    </menuitem>
    <menuitem navigateurl="/PressCentre/PressContacts/" text="&#1087;&#1088;&#1077;&#1089; &#1082;&#1086;&#1085;&#1090;&#1072;&#1082;&#1090;&#1080;" />
</menuitem> 
```

我需要获取navigationurl 之间的值（例如“/PressCentre”）。是否有众所周知的正则表达式脚本来执行此操作？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T15:48:29.470

一个基本的递归（未经测试，但我认为没关系）：

```
private void Caller(String filepath)
{
    XPathDocument oDoc = new XPathDocument(filepath);
    Readnodes( oDoc.CreateNavigator() );
}

private void ReadNodes(XPathNavigator nav)
{
    XPathNodeIterator nodes = nav.Select("menuitem");
    while (nodes.MoveNext())
    {
        //A - read the attribute
        string url = nodes.Current.GetAttribute("navigateurl", string.Empty);

        //B - do something with the data

        //C - recurse
        ReadNodes(nodes.Current);
    }
} 
```

...之所以有效，是因为 XPathNodeIterator 的 Current 属性也是 XPathNavigator。显然，您需要扩展它以将数据推送到字典或跟踪深度等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T15:49:21.933

当 XPath 是（至少对我而言）自然选择时，为什么要为此使用 Regex？这基本上就是 XSLT 应该实现的......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T15:51:48.013

您使用正则表达式的任何特殊原因？您是否尝试过为此使用 XPath？下面是一些如何使用 XPath 的示例。[http://www.w3schools.com/XPath/xpath_examples.asp](http://www.w3schools.com/XPath/xpath_examples.asp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-06T12:50:00.720

使用 xpath, //menuitem[@navigateurl]/@navigateurl 。

这个 xpath 将抓取所有具有属性 naviagate url 的菜单项并返回一个节点列表（xpath 1.0）或序列（xpath 2.0）的 navigateurl 值。通过使用 navigateurl 属性谓词，可确保仅获取叶菜单项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-26T15:35:01.460

我的帖子解决了与 OP 查询相关的特定需求，但没有具体说明 OP 的要求。当我需要正则表达式和递归时，我喜欢它们，但在这种情况下，我认为 OP 调查的目标是学习一种生成格式正确的 XML 输出的方法，而我在下面提供的内容正是如此，没有繁重的上下文源代码开发（为什么要重新发明轮子？）并在 .NET 2.0 框架中得到支持。

在我的工作中，我经常最终支持现代政府系统。这些系统通常仍然只支持部署系统上的 2.0 版本——主要是出于安全考虑。2.0 框架缺少一些较新的 .NET 版本的优雅输出，尤其是在涉及 XML 对象的地方。下面的完全验证的方法集对我来说很有价值并且可以节省时间，我将它提供给那些也为政府利益服务的隐形开发者同志。

此外，您还可以将 LinqBridge 库用于有限的 Linq 支持（.NET 到 3.5 服务包实际上在内部自我评估为 2.0，因此构建 LinqBridge 以弥合该特定差距（在使用 Visual Studio 开发到 2.0 构建时，有限的 Linq 查询支持2008). 但是，请注意，Visual Studio 2008 之前的版本目前不支持 LinqBridge。

为了最小化包发布大小并与我提供服务的组织要求保持兼容，我避免使用关联的非 XML 库（例如 Regex）来解析 XML，并坚持使用标准 XML 对象。特别是较旧的 Xml*-prefix 对象与更现代（且更灵活）的 X*-prefix 对象...

下面我提供了许多安全、简单、有效的方法，这些方法可以从各种标准 2.0 Xml* 对象生成格式化的 XML。另请注意，这些函数的主力实际上是 XPathNavigator 类，而不是它的表兄弟。

这是调用示例方法的 C# 代码片段：

```
doc = new XmlDocument();
doc.Load(Input_FilePath);
sb = StringBuilderFromXmlDocument(doc);
Out(sb);
sb = StringBuilderFromXPathDocument(new XPathDocument(Input_FilePath));
Out(sb);
sb = StringBuilderFromXPathNavigator(new XPathDocument(Input_FilePath).CreateNavigator());
Out(sb);
ss = StringFromXmlDocument(doc);
Out(ss);
ss = StringFromXPathDocument(new XPathDocument(Input_FilePath));
Out(ss);
ss = StringFromXPathNavigator(new XPathDocument(Input_FilePath).CreateNavigator());
Out(ss); 
```

以下是示例方法，其中一种方法可能足以满足您的 XML 格式化需求：

```
public static StringBuilder StringBuilderFromXmlDocument(XmlDocument _xd)
{
    XPathNavigator _xpn;
    try
    {
        _xpn = _xd.CreateNavigator();
    }
    catch
    {
        _xd.LoadXml(DEFAULT_ERROR_TEXT);
        _xpn = _xd.CreateNavigator();
    }
    return StringBuilderFromXPathNavigator(_xpn);
}

private static StringBuilder StringBuilderFromXPathDocument(XPathDocument _xpd)
{
    StringBuilder returnVal = new StringBuilder();
    XPathNavigator _xpn;
    try
    {
        _xpn = _xpd.CreateNavigator();
        returnVal.AppendLine(_xpn.OuterXml.Trim());
    }
    catch
    {
        returnVal = new StringBuilder()
            .Append(DEFAULT_ERROR_TEXT);
    }
    return returnVal;
}

private static StringBuilder StringBuilderFromXPathNavigator(XPathNavigator _xpn)
{
    StringBuilder returnVal = new StringBuilder();
    try
    {
        returnVal.AppendLine(_xpn.OuterXml.Trim());
    }
    catch
    {
        returnVal = new StringBuilder()
            .Append(DEFAULT_ERROR_TEXT);
    }
    return returnVal;
}

public static string StringFromXmlDocument(XmlDocument _xd)
{
    XPathNavigator _xpn;
    try
    {
        _xpn = _xd.CreateNavigator();
    }
    catch
    {
        _xd.LoadXml(DEFAULT_ERROR_TEXT);
        _xpn = _xd.CreateNavigator();
    }
    return StringFromXPathNavigator(_xpn);
}

private static string StringFromXPathNavigator(XPathNavigator _xpn)
{
    string returnVal;
    try
    {
        returnVal = _xpn.OuterXml.Trim();
    }
    catch
    {
        returnVal = DEFAULT_ERROR_TEXT;
    }
    returnVal = _xpn.OuterXml.Trim();
    return returnVal;
}

private static string StringFromXPathDocument(XPathDocument _xpd)
{
    string returnVal;
    XPathNavigator _xpn;
    try
    {
        _xpn = _xpd.CreateNavigator();
        returnVal = _xpn.OuterXml.Trim();
    }
    catch
    {
        returnVal = DEFAULT_ERROR_TEXT;
    }
    return returnVal;
} 
```

请享用。^^

请注意，在以后的 Framework 版本中并使用较新的 XElement 对象，您可以 foreach(){} XElement 的节点和 .ToString() 每个结果以自动正确格式化。就像我上面说的，更优雅:)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-14T16:30:17.000

**如何在 Java 中使用正则表达式递归读取 XML 文档**

```
public static void main(String[] args) {
        String data**="<CheckExistingDSLService>" +
                "<DSLPN>4137361787</DSLPN>" +
                "<DSLPN>8566944014</DSLPN>" +
                "<ClientRequestId>CRID</ClientRequestId>" +
                "<DSLPN>8566944024</DSLPN>" +
                "<ClientSystemId>SSPORD</ClientSystemId>" +
                "<Authentication>" +
                "<Id>SSPORD</Id>" +
                "</Authentication>" +
                "<Comment>Service to check CheckExistingDSL</Comment>"** +
                "</CheckExistingDSLService>";
        System.out.print("The dats is "+listDataElements(data));

    }
    private static final Pattern PATTERN_1 = Pattern.compile("<([^<>]+)>([^<>]+)</\\1>"); 
    private static List<String> listDataElements(CharSequence cs) {     
        List<String> list = new ArrayList<String>();     
        Matcher matcher = PATTERN_1.matcher(cs);    
        while (matcher.find()) {         
            if(matcher.group(1).equalsIgnoreCase("DSLPN")){
                try{
                    Long number=Long.parseLong(matcher.group(2));
                    list.add(number.toString());

                }catch(Exception e){
                    System.out.println("Do noting this is notnumber ");                 
                }
            }
        } return list; 
    } 
```

**您将得到的输出：日期为 [4137361787, 8566944014, 8566944024]**

# asp.net - Microsoft 企业应用程序块与 ASP.NET 提供程序模型的关系是什么？

> ID：825465
> 
> 赞同：4
> 
> 时间：2009-05-05T15:34:44.310
> 
> 标签：asp.net, architecture, enterprise-library

Microsoft 企业应用程序块与 ASP.NET 提供程序模型的关系是什么？（如有）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-15T03:21:32.753

企业图书馆有一个安全应用程序块。

它公开了两个可以在代码中访问的接口：

Authorization Provider 接口，它公开名为 Authorize 的单个方法，该方法采用 IPrincipal 对象的实例，该对象包含用户身份和角色的详细信息。根据您配置块的方式，授权可以通过 Windows® Authorization Manager (AzMan) 针对 Active Directory、XML 文件或数据库进行；或者使用您定义的自定义规则并在应用程序配置文件中存储为 XML。安全缓存提供程序接口，它公开允许您将用户的身份或安全上下文保存和检索为 IIdentity 实例、IPrincipal 实例或 ASP.NET 配置文件实例的方法。每个缓存的身份或安全上下文都由一个令牌标识（默认情况下是一个 GUID，尽管您可以创建和使用自己的 IToken 接口实现）。该块使用缓存应用程序块将此信息存储在数据库或隔离存储中。您也可以为缓存应用程序块创建一个自定义提供程序，并使用它来缓存位置中的信息，并使用您在提供程序中实现的技术。

然后也可以参考 ASP.NET 2.0 Provider Model：http: [//msdn.microsoft.com/zh-cn/library/aa479030.aspx](http://msdn.microsoft.com/zh-cn/library/aa479030.aspx)

# java - Java 方法和类，它们如何组合在一起？

> ID：825470
> 
> 赞同：1
> 
> 时间：2009-05-05T15:35:24.167
> 
> 标签：java, class, methods, main-method

目前我正在为一个介绍性的 Java 类编写一个程序。我的拼图有两块。希望这是一个相对简单的问题。

首先，这是我试图用作我的主程序的内容：

```
import java.util.Scanner;

public class TheATMGame
{
 public static void main(String[] args){

    Scanner input = new Scanner(System.in);

    double newBalance = 0;
    double monthlyInterest = 0;
    int answer = 0;

    int i=1;
    while (i < 100) {
        System.out.print ("Please enter your ID: ");
        answer = input.nextInt();
        System.out.println(" ");
        if (answer >=0 && answer<10) 
        TheATMGame.runGame (answer);
        else
         System.out.println("Sorry, this ID is invalid.");
     }
    }

    public static void runGame(int id) {
      double amount = 0;
      int continueOn = 0;
      while (continueOn < 4) {
        ATMGame myATM = new ATMGame();
        Scanner input = new Scanner(System.in);
        System.out.println ("---Main menu--- ");
        System.out.println ("1: Check balance ");
        System.out.println ("2: Withdraw ");
        System.out.println ("3: Deposit ");
        System.out.println ("4: exit ");

        int answer = input.nextInt();

        if (answer == 1)
            System.out.println("your balance is: " + myATM.getBalance (id));
        else if (answer == 2){
            System.out.println("Enter an amount to withdraw: ");
            amount = input.nextInt();
            myATM.withdraw(amount, id);
        }
        else if (answer == 3)
{
            System.out.println("Enter an amount to deposit: ");
            amount = input.nextInt();
            myATM.deposit(amount, id);
        }
        else if (answer == 4)
            continueOn = 4;
        else if (answer > 4)
            System.out.println ("Please review the main menu. " +
                    "Your selection must be between 1-4.");
      }
    }

//ATM class (balance, annualInterestRate2, id2)
//ATM myATM = new ATM (20000, 4.5, 1122 );
//newBalance = myATM.withdraw(2500);
//newBalance = myATM.deposit(3000);
//monthlyInterest = myATM.getMonthlyInterestRate();
//System.out.println("Your current balance is: " + newBalance);
//System.out.println ("Your monthly interest rate is: " +  monthlyInterest);

} 
```

现在这里是我想在该程序中隐含的所有类：

```
import java.util.Date;

public class ATMGame  {

    private double annualInterestRate = 0;
    private double balance = 0;
    private int id = 11;
    private int[] ids = {0,1,2,3,4,5,6,7,8,9};
    private int[] balances = {100,100,100,100,100,100,100,100,100,100};
    public Date dateCreated;

    public ATMGame() {

    }
    public ATMGame (double balance2, double annualInterestRate2, int id2) {
        balance = balance2;
        annualInterestRate = annualInterestRate2;
        id = id2;
        dateCreated.getTime();
    }

    public double getMonthlyInterestRate() {
        double monthlyInterest = annualInterestRate/12;
        return monthlyInterest;
    }

    public double withdraw(double amountWithdrawn, int id) { //This method withdraws money from the account

        double newBalance = balances[id] - amountWithdrawn;
        System.out.println("Your withdrawel has processed. New balance: " + newBalance);
        balances[id] = (int) newBalance;
        return newBalance ;

    }

    public double deposit(double amountDeposited, int id) { //This method deposits money in the account
        double newBalance = balances[id] + amountDeposited;
        System.out.println("Your deposit has processed. New Balance is: " + newBalance);
        balances[id] = (int) newBalance;
        return newBalance ;

    }

    public double getBalance(int id) {
        double myBalance = balances[id];
        balance = myBalance;
        return myBalance ;
    }

} 
```

当我尝试运行第一个程序时，它显示“未找到主类”。正如你所看到的，我写了“public void Main() ...”这一行来解决这个问题，但显然它不起作用。我究竟做错了什么？

**用“public static void main(String[] args) {”替换“public void Main() {”仍然返回错误：“No Main classes found”。**：/

[http://img21.imageshack.us/img21/9016/asdfsdfasdfg.jpg](http://img21.imageshack.us/img21/9016/asdfsdfasdfg.jpg)

我可以通过将 Main.java 更改为 TheATMGame.java 然后从 ATMGame.java 运行来修复它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T15:36:45.583

你应该使用：

```
public static void main(String[] args) 
```

而不是 Main，因为 JVM 首先调用此方法。这是一个约定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T15:36:58.487

你只是错误地定义了 main。应该：

```
public static void main(String[] args) {
    ....
} 
```

但是，您的代码会遇到其他一些问题。一眼看去...

*   您的 main() 和 runGame() 都是一个函数 - 一个不应在另一个中定义。
*   你不能将你的两个类命名为相同的东西——将 main() 类称为不同于 ATMGame 的东西。
*   不确定你要去哪里`ATM class (balance, annualInterestRate2, id2)`，但它不是有效的 Java。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T15:37:43.943

您的方法签名必须是：

```
public static void main(String[] args) {
 ...
} 
```

这是你必须遵守的约定。别的什么都行不通。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T15:43:50.497

在您的班级`ATMGame`中，替换以下内容：

```
public void Main() { 
```

和：

```
public static void main(String[] args) { 
```

此外，由于此方法必须是静态的，因此您需要更改以下内容：

```
if (answer >=0 && answer<10)
     runGame (answer);
 else 
```

和：

```
if (answer >=0 && answer<10)
     ATMGame.runGame (answer);
 else 
```

最后，您需要将方法签名更改`rungame`为也是静态的。将其更改为：

```
public void runGame(int id) { 
```

到：

```
public static void runGame(int id) { 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T16:20:00.817

公共类的名称应与文件名匹配。在您的屏幕截图中不是这种情况。还要确保一切都正确编译，然后重试（使用 public static void main(String[] args) { ... } 方法）。

# xml - 简单 XML 商品列表的 XML 模式

> ID：825471
> 
> 赞同：2
> 
> 时间：2009-05-05T15:35:52.823
> 
> 标签：xml, xsd

我正在尝试编写一个验证以下 XML 的模式：

```
<category type="rifles">
  <item>
 <name>
   AK47
     </name>
 <description>
   The USSR's chief export back in the day, and the guerrilla's best friend. On African flags than any other symbol.
  </description>
  <cost>
    4000
  </cost>
  <image>
    ak47.jpg
  </image>
  <provenance>
    The USSR.
  </provenance>
  <quantity>
    10000
  </quantity>
</item> 
```

（省略了其他项目元素、多余的标题标签和结束标签。）

并开发了以下架构：

```
<element name="store">
  <complexType>
 <sequence>
    <element name="category" maxOccurs="unbounded" >
      <complexType>
     <simpleContent>
        <extension base="string">
           <attribute name="type" type="string" />
        </extension>
      </simpleContent>
      <sequence>
        <element name="item" maxOccurs="unbounded" >
           <complexType>
          <sequence>
             <element name="name" type="string"/>
             <element name="description" type="string"/>
             <element name="image" type="string"/>
             <element name="cost" type="number"/>
             <element name="provenence" type="string"/>
             <element name="quantity" type="number"/>
           </sequence>
         </complexType>
           </element>
       </sequence>
     </complexType>
       </element>
     </sequence>
  </complexType>
</element> 
```

[在http://www.xmlme.com/Validator.aspx?mid=83](http://www.xmlme.com/Validator.aspx?mid=83)使用验证器，我得到：

架构错误：System.Xml.Schema.XmlSchemaException：复杂类型的内容模型必须包含“注释”（如果存在）；后跟零或以下之一：“simpleContent”、“complexContent”、“group”、“choice”、“sequence”或“all”；后跟零个或多个“属性”或“属性组”；后跟零个或一个“anyAttribute”。

我知道这可能听起来很傻，但谁能指出我的错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T15:51:11.227

尝试

```
<?xml version="1.0" encoding="utf-8" ?>
<!--Created with Liquid XML Studio - Developer Pro Edition 7.1.0.1135 (http://www.liquid-technologies.com)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="category">
    <xs:complexType>
      <xs:sequence>
        <xs:element minOccurs="0" maxOccurs="unbounded" name="item">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="name" type="xs:string" />
              <xs:element name="description" type="xs:string" />
              <xs:element name="cost" type="xs:unsignedShort" />
              <xs:element name="image" type="xs:string" />
              <xs:element name="provenance" type="xs:string" />
              <xs:element name="quantity" type="xs:unsignedShort" />
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
      <xs:attribute name="type" type="xs:string" use="required" />
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

# visual-studio-2008 - ReSharper 4.5 带走了 VS 2008 的所有智能感知！

> ID：825472
> 
> 赞同：2
> 
> 时间：2009-05-05T15:36:02.090
> 
> 标签：visual-studio-2008, resharper, intellisense

我最近刚刚购买了 ReSharper 4.5 与 Visual Studio 2008 一起使用。安装它后，我注意到根本没有智能感知！没有 ReSharper 智能感知，没有 VS 智能感知，什么都没有）。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T15:42:24.773

Go to Resharper -> Options -> Intellisense -> General and make sure something is selected. Also check over the Completion Behavior and Completion Appearance sections to make sure they match your expectations.

I'm using 4.5 and it works for me, but with a new install you should review the options.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T15:44:15.083

In the Resharper->Options There is a config: IntelliSense/General In which you can choose whethere to use Intellisense features from ReSharper or from Visual Studio.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T15:42:23.760

First thing I'd try would be reinstalling Resharper.

Are you getting any of the Resharper prompts or is it just Intellisense that's messed up?

# nhibernate - 使用 Fluent NHibernate 的 AutoPersistenceModel 但在单个对象中预先加载

> ID：825474
> 
> 赞同：0
> 
> 时间：2009-05-05T15:36:43.510
> 
> 标签：nhibernate, fluent-nhibernate, eager-loading

我正在使用 Fluent NHibernate 来自动映射我的实体。

这是我用于自动映射的代码：

```
new AutoPersistenceModel()
  .AddEntityAssembly(Assembly.GetAssembly(typeof(Entity)))
  .Where(type => type.Namespace.Contains("Domain") && type.BaseType != null && type.BaseType.Name.StartsWith("DomainEntity") && type.BaseType.IsGenericType == true)
  .WithSetup(s => s.IsBaseType = (type => type.Name.StartsWith("DomainEntity") && type.IsGenericType == true))
  .ConventionDiscovery.Add(
      ConventionBuilder.Id.Always(x => x.GeneratedBy.Increment())
); 
```

这工作得很好。但是现在我需要在我的域的一个对象中进行 Eager Loading。找到[了这个答案](http://groups.google.com/group/fluent-nhibernate/browse_thread/thread/6acc362331c93f6f?pli=1)。但是当我将该行添加`.ForTypesThatDeriveFrom<IEagerLoading>(map => map.Not.LazyLoad())`到代码并运行它时，我得到以下异常：

*   *尝试为 IEagerLoading 构建映射文档时出错*

请注意，我正在使用一个接口 ( `IEagerLoading`) 来标记我想要预加载的对象。

谁能帮助如何做到这一点？请记住，我想保留自动映射功能。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T17:17:40.863

你遇到的问题是它`ForTypesThatDeriveFrom<T>`的名字有点误导，它真的意味着`ForMappingsOf<T>`，所以它试图找到一个`ClassMap<IEagerLoading>`显然不存在的。

我相信您应该能够使用 custom 来处理这个问题`IClassConvention`。这不在我的脑海中，但应该可以：

```
public class EagerLoadingConvention : IClassConvention
{
  public bool Accept(IClassMap target)
  {
    return GetType().GetInterfaces().Contains(typeof(IEagerLoading));
  }

  public void Apply(IClassMap target)
  {
    target.Not.LazyLoad();
  }
} 
```

# windows - 如何将 Araxis 设置为 MSYS git 的差异/合并工具？

> ID：825478
> 
> 赞同：14
> 
> 时间：2009-05-05T15:37:37.360
> 
> 标签：windows, git, diff, msysgit, araxis

我正在尝试使用[Araxis Merge](http://www.araxis.com/merge/)作为 MSYSGit 的差异/合并工具。

我在网上找到了一些资源：

*   在[Araxis 站点上](http://www.araxis.com/merge/scm_integration.html#Git)，他们提到了一种“简单”的方式，但它暗示了不属于我的发行版的可执行文件（araxisgitdiff.exe 和 araxisgitmerge.exe）。
*   我还在[gitguru](http://gitguru.com/2009/02/22/integrating-git-with-a-visual-merge-tool/)中找到了一些信息，但实际信息 re: Araxis 充其量是稀疏的，我无法从中做出任何事情。
*   最后，有一些关于旧的[stackoverflow 帖子的信息](https://stackoverflow.com/questions/736911/how-do-you-make-git-diff-use-gitx-diff-on-os-x)，但建议的方法对我不起作用。该特定信息面向 OS X。我尽我所能“翻译”到 Windows，但没有成功：

我建立`/bin/git-diff-driver.sh`

```
#!/bin/sh

"/c/Program Files/Araxis/Araxis Merge/compare.exe" -title1:"$1 (repo version)" -title2:"$1 " -max "$2" "$5" 
```

并编辑`gitconfig`

```
[merge]
    tool = araxismerge
[mergetool "araxismerge"]
    cmd = "/c/Program Files/Araxis/Araxis Merge/compare.exe" -3 -merge -wait $LOCAL $BASE $REMOTE $MERGED
[diff]
    external = "/bin/git-diff-driver.sh" 
```

我得到的唯一结果是：

> $ git diff HEAD^ HEAD
> external diff 死了，停在 PowerEditor/src/Notepad_plus.cpp。

* * *

### 编辑：

我也尝试过使用`"c:/Program Files/Araxis/Araxis Merge/compare.exe"`答案之一所建议的exe命名，结果相同。

* * *

### 编辑：

我发现如果你使用 TortoiseGit 可以很容易地设置它，但它似乎可以自己处理 diff，并且 TortoiseGit 中的任何设置都没有说明如何在从命令行调用 diff 时将 Araxis 设置为合并工具。

* * *

### 编辑：

所以，问题是：有没有人成功地使用 Araxis Merge 来区分和合并 MSYSGit 的东西，如果有，你是怎么做到的？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-09-15T22:11:04.110

如果你想让 'git diff' 始终使用 araxis，你可以使用帮助文件中的说明，但是如果你想像通常从命令行和 'git difftool' 一样控制使用 'git diff' Araxis 图形用户界面。

尝试将以下内容添加到您的 git config::

```
[difftool "araxis"]
    path = "/c/Program Files/Araxis/Araxis Merge/compare.exe"
    renames = true
    trustExitCode = true
[diff]
    tool = araxis
    stat = true
[mergetool "araxismergetool"]
    cmd = 'C:\\Program Files\\Araxis\\Araxis Merge\\araxisgitmerge.exe' "$REMOTE" "$BASE" "$PWD/$LOCAL" "$PWD/$MERGED"
    trustExitCode = false
[mergetool]
    keepBackup = false
[merge]
    tool = araxismergetool
    stat = true 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-12-03T10:34:13.853

araxis 的文档已更新：[http ://www.araxis.com/merge/documentation-windows/integrating-with-other-applications#Git](http://www.araxis.com/merge/documentation-windows/integrating-with-other-applications#Git)

我可以使用那里显示的配置而无需任何修改。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-19T09:13:28.407

对...我在 DOS 或 Git Bash 下使用 msysgit 版本 1.6.3.2.1299.gee46c 使用 Araxis Merge 2009 的评估许可证 v2009.3713：

方法是使用新的[`git difftool`](http://kernel.org/pub/software/scm/git/docs/git-difftool.html)and [`git mergetool`](http://www.kernel.org/pub/software/scm/git/docs/git-mergetool.html)，而不是普通的差异。

首先，让我们为这些差异和合并工具设置一些脚本

```
C:\>git config --global diff.tool adifftool
C:\>git config --global diff.external git-difftool--helper
C:\>git config --global difftool.adifftool.cmd "difftool.sh \"$LOCAL\" \"$REMOTE\" \"$MERGED\""
C:\>git config --global difftool.prompt false 
```

笔记：

*   通过将 diff.external 设置为 Git 脚本`git-difftool--helper`，即使我输入“ `git diff`”，我也会使用 difftool。
*   不要忘记传递`$MERGED`给您的 difftool 脚本：这是唯一具有被 diff 文件真实名称的变量。`$LOCAL`并且`$REMOTE`是临时名称。

对于合并工具，您将设置以下全局值：

```
C:\>git config --global merge.tool amergetool
C:\>git config --global mergetool.amergetool.cmd "mergetool.sh \"$PWD/$LOCAL\" \"$PWD/$BASE\" \"$PWD/$REMOTE\" \"$PWD/$MERGED\""
C:\>git config --global mergetool.prompt false 
```

通过将这些工具设置为一些 shell 脚本，您将能够从这些脚本中切换工具。
另一种方法是命名您的工具 ( `mergetool.araxis.cmd`, `mergetool.winmerge.cmd`, ...) 并在`diff.tool`or`merge.tool`设置中指定正确的工具。

在全局环境变量引用的目录中创建`difftool.sh`和。它们甚至可以在 DOS 下工作（它们是-- shell -- 脚本）`mergetool.sh``PATH``sh`

**差异工具.sh**

```
#!/bin/sh
echo Launching Araxis Merge.exe: $3
t1="'$3 (from)'"
t2="'(to)'"
"C:/Program Files/Araxis/Araxis Merge/Compare.exe" -max -nowait -2 -title1:${t1} -title2:${t2} "$1" "$2" 
```

笔记：

*   ~~**不可能有 -title1:"someTitle With Space"** ......只有没有空格的标题才有效......所以现在，在没有任何 ' `titleN`' 选项的情况下尝试它。~~
    知道了！您不能将标题值直接传递给`-title`选项，您需要将其设置为局部变量，并带有`"' '"`引号组合（双引号将在 shell 脚本执行期间消失，留下简单的引号，在标题中允许空格！）
*   `$3`代表真实名称，而不是一些用于差异目的的临时文件名。因此，`$3`在`title1`选项中使用了其中的空格。
*   `git diff HEAD^ HEAD`不会在 DOS 会话中工作：只会`git diff "HEAD^" HEAD`。

**合并工具.sh**

```
#!/bin/sh

# Passing the following parameters to mergetool:
#  local base remote merge_result

alocal=$1
base=$2
remote=$3
result=$4

t1="'$4 (current branch)'"
t2="'(common ancestor)'"
t3="'(to be merged)'"

if [ -f $base ]
then
    "C:/Program Files/Araxis/Araxis Merge/Compare.exe" -max -wait -merge -3 -a2 -title1:${t1} -title2:${t2} -title3:${t3} "$alocal" "$base" "$remote" "$result" 
else
    "C:/Program Files/Araxis/Araxis Merge/Compare.exe" -max -wait -merge -3 -a2 -title1:${t1} -title2:${t2} -title3:${t3} "$alocal" "$result" "$remote" "$result" 
fi 
```

~~当涉及多个文件（多个差异，要合并的多个文件）时，我不确定这些脚本是否能正常工作。~~
刚刚对其进行了测试：它可以工作，并且 Araxis compare.exe 确实为每个文件打开一个选项卡以进行比较或合并。
试一试，让我们知道；）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T17:55:32.973

我认为您需要在 .gitconfig 中转义时更加小心。

不幸的是，由于 config 变量被扩展和评估的方式，你的字符串需要是一个有效的 shell 命令，然后 'git config' 转义。

尝试这样的事情：

```
[mergetool "araxismerge"]
    cmd = \"/c/Program Files/Araxis/Araxis Merge/compare.exe\" -3 -merge -wait \"$LOCAL\" \"$BASE\" \"$REMOTE\" \"$MERGED\" 
```

是的，不是很漂亮，我知道。这是`git config`直接使用实际上更容易的情况之一。

```
git config --global mergetool.araxismerge.cmd '"/c/Program Files/Araxis/Araxis Merge/compare.exe" -3 -merge -wait "$LOCAL" "$BASE" "$REMOTE" "$MERGED"' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-02T10:31:52.260

我为这个问题苦苦挣扎了很长一段时间，现在我终于可以说，所有建议的肮脏黑客（如中间 shell 脚本）都是不必要的 =D。问题是，所有最新版本的 MSYSGit（我有 1.6.4）都支持 Araxis Merge（我有 2008）开箱即用。毫不奇怪，它在内部被称为“araxis”。所以，你需要做的就是设置

```
[merge]
    tool = araxis 
```

在你的`.gitconfig`. 您还必须将 Araxis 文件夹包含到您的 PATH 环境变量中（MSYSGit 查找`Compare.exe`）。

作为一个好的衡量标准，您可以配置的与“araxis”合并工具相关的其他 Git 设置（特别是，如果您恰好选择了该名称，就像此页面上的某些人一样），应该全部删除。这包括`[mergetool "araxis"]`部分下的所有内容。请务必从所有配置（系统、全局和存储库）中删除它们，否则，它们可能会干扰正常的“内部工具”行为。

无论如何，如果您对 MSYSGit 将如何启动您的 Araxis Merge 感兴趣，或者想知道它支持哪些其他开箱即用的合并工具，则可以查看`\share\git-gui\lib\mergetool.tcl`MSYSGit 安装文件夹中的脚本。

PS。您可以通过配置`mergetool.araxis.path`in来避免设置 PATH 环境变量`.gitconfig`。就个人而言，我从不费心这样做，因为

1.  无论如何，我从命令行使用 Araxis Merge。
2.  在中指定目录路径`.gitconfig`（尤其是`"C:\Program Files\Araxis\Araxis Merge\"`包含空格的 like ）可能很难正确完成，因为它容易出现反斜杠/正斜杠问题，这会困扰 MSYSGit。

聚苯乙烯。以上所有内容也适用于使 Araxis 成为您的差异工具。即，您需要添加

```
[diff]
    tool = araxis 
```

并删除部分中的任何其他`[difftool "araxis"]`内容，如果您的配置中有它（但不要忘记设置 PATH）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T15:53:44.640

您可以尝试按照[我关于 diffMerge](https://stackoverflow.com/questions/780425/how-do-i-setup-diffmerge-with-msysgit-gitk/783667#783667)（适用于 Windows）的回答中提到的脚本，看看它是否有效。

可执行路径可以更好地表达为：

```
#!/bin/sh

"C:/Program Files/Araxis/Araxis Merge/compare.exe" -title1:"$1 (repo version)" -title2:"$1 " -max "$2" "$5" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T21:34:21.870

我发现“简单”的一种方法是安装[TortoiseGit](http://code.google.com/p/tortoisegit/)并在 TortoiseGit 选项中设置差异/合并工具。
但是，如果您想从命令行进行比较，这并不能解决问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-13T20:43:42.560

由于我一直被定制的 git 差异/合并所困扰，我想我会尝试一劳永逸地解决这个问题。我到了 AraxisMerge 开始的地方，但没有标签的标题。所以这将留给读者作为练习:)

观察和评论：

*   我没有 AraxisMerge，所以我下载了它并获得了 30 天的免费评估许可证来试用它。此版本（似乎是 7.0）附带 araxisgitdiff.exe，并且您发送的说明链接有效。所以这将是选项 #1：升级 araxis 合并。
*   由于我使用 CMD.EXE 工作，因此 'git diff HEAD HEAD^' 不起作用。'^' 需要转义为 'git diff HEAD "HEAD^"'。
*   对于我自己的工作，我使用 kdiff3 作为 Windows 上的免费替代品，它运行得相当好（这有助于它默认被 git 支持）

从 git-diff-driver.sh 开始给我同样的错误。将脚本更改为仅包含“回声”后，这并没有改变。所以错误与脚本的内容无关。

然后我从 .gitconfig 中删除了 '/bin' 部分，所以该行变为

```
external = "git-diff-driver.sh" 
```

...这开始起作用了：它开始了合并，但它没有正确地逃避 '(repo) ' 部分。作为一种解决方法，我让它在没有标题的情况下工作：

```
#!/bin/sh
"/c/Program Files/Araxis/Araxis Merge/compare.exe" -max "$2" "$5" 
```

祝你好运！

# linux - iptable 规则以丢弃有效载荷中具有特定子字符串的数据包

> ID：825481
> 
> 赞同：8
> 
> 时间：2009-05-05T15:37:58.060
> 
> 标签：linux, linux-kernel, iptables

我正在尝试编写规则来丢弃任何数据包，无论它是传出、传入还是转发，它在 TCP 或 UDP 有效负载中具有特定的子字符串。

我该怎么做？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-05T17:26:30.047

您需要一个启用了 Netfilter“[字符串匹配支持](https://unix.stackexchange.com/questions/404482/)”的内核。

那么你就可以

```
iptables -A INPUT -m string --algo bm --string "test" -j DROP
iptables -A OUTPUT -m string --algo bm --string "test" -j DROP
iptables -A FORWARD -m string --algo bm --string "test" -j DROP 
```

检查结果

```
iptables -L 
```

# asp.net-mvc - 哪个重定向具有优先权 - 控制器操作中的重定向还是 ActionFilter 的 OnActionExecuted 中的重定向？

> ID：825483
> 
> 赞同：1
> 
> 时间：2009-05-05T15:38:33.770
> 
> 标签：asp.net-mvc, action-filter

看来我又要干点奇怪的事了……

情况：

```
public ExperimentAttribute
{
    public override void OnActionExecuted (ActionExecutingContext filterContext)
    {
        filterContext.Result =
                    new RedirectToRouteResult (
                        new RouteValueDictionary (new { Action = "Action2", Controller = "Experiment" }));
    }
}

public ExperimentController
{
    [Experiment]
    public ActionResult ExperimentEntryPoint ()
    {
        RedirectToAction ("Action1", "Experiment");
    }

    public ActionResult Action1 ()
    {
        /* ... */
    }

    public ActionResult Action2 ()
    {
        /* ... */
    }
} 
```

那么，将发生哪个重定向？控制器动作中的一个，ActionFilter 中的一个，或者两者兼而有之？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T15:57:18.217

所以我刚刚进行了一个实验，证实了我的预期。

ExperimentEntryPoint 返回一个ActionResult，即重定向到Action1。

OnActionExecuted 在框架的其余部分开始处理它之前覆盖结果。当涉及到它时，它会看到重定向到 Action2 命令。

好看又清晰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T20:33:07.633

我想不出在 OnActionExecuting( ) 方法，但绝对是允许的。

执行顺序为：

*   OnActionExecuting()
*   控制器中的 Action 方法代码
*   OnActionExecuted()
*   OnResultExecuting()
*   无论分配的 ActionResult.ExecuteResult() 返回什么（呈现视图、json、内容等）
*   OnResultExecuted()

正如您的实验所示，您可以在 OnActionExecuted() 和 OnActionExecuting() 中更改 filterContext.Result。由于在控制器代码之后调用 OnActionExecuted()（例如：返回 RedirectToAction()），因此它设置为 ActionResult 的任何内容都优先。

我在 Steven Sanderson 的“Pro ASP.NET MVC 框架”一书中找到了不错的 ActionFilters 报道。[1] [2]

[1][http://books.google.com/books?id=Xb3a1xTSfZgC（ActionFilters](http://books.google.com/books?id=Xb3a1xTSfZgC) 上的内容在 Google 图书预览中不可用）

[2][http://blog.codeville.net/2009/04/29/now-published-pro-aspnet-mvc-framework-apress/](http://blog.codeville.net/2009/04/29/now-published-pro-aspnet-mvc-framework-apress/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T15:47:21.503

They can't both happen as they both return a HTTP 302 redirect.

The attribute will execute the redirect since it's the last thing to happen before the result is sent to the client. Both OnActionExecuting and OnActionExecuted will happen over top of the controller's action result.

# java - import from external lib jython

> ID：825485
> 
> 赞同：2
> 
> 时间：2009-05-05T15:38:46.360
> 
> 标签：java, eclipse, jython

I am trying to imported a java class from an external lib in jyhon and it does not work. An example

```
package run;
    import import.Imported;
    Class Run()
    {
        public static void main(String[] args){
                 pi = new PythonInterpreter(null);
        pi.execfile('script.py');
            }
    }
    //this is an external libary
    package import;
    Class Imported()
    {
         //some stuff;
    }

   //py script
   from import import Imported //this line throws an error Module not found
   #do some stuff 
```

The strangest thing is that it runs when it is compiled in Eclipse, but does not from command line. Any help?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T15:46:29.837

Sounds like your classpath is probably set incorrectly at runtime. The easiest solution is typically just to add the directory or jar file containing 'import' to sys.path.

(Also, naming your packages 'import' is just asking for trouble.)

# delphi - Best method of frequently storing, searching and modifying a large data set in Delphi

> ID：825486
> 
> 赞同：3
> 
> 时间：2009-05-05T15:39:22.317
> 
> 标签：delphi, dataset, search, storage

What would be the best way, in delphi, to create and store data which will often be searched on and modified?

Basically, I would like to write a function that searches an existing database for telephone numbers and keeps track of how many times each telephone number has been used, the first date used, and the latest date used. The database that is being searched is basically a log of orders placed, containing the telephone number that was used to place the order. It's not an SQL database or anything that can easily be queried for such things (it's an old btrieve database), so I need to create a way of gaining this information (to eventually output to a text file).

I am thinking of creating a record containing the phone number, the two dates, and the number of times used, and then adding a record to a dynamic array for each telephone number. I would then search the array, entry by entry, for each record in the database, to see if the phone number for the current record is already in the array. Then updating or creating a record as necessary.

This seems like it would work, but as there are tens of thousands of entries in the database, it may not be the best way, and a rather slow and inefficient way of doing things. Is there a better way, given the limited actions I can perform on the database?

Someone suggested that rather than using an array, use a MySQL table to keep track of the numbers, and then query each number for every database record. This seems like even more overhead though!

Thanks a lot for your time.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T16:19:07.650

我将在完全断开的 TClientDataset(cds) 中注册聚合，并在您从循环中获取它们时更新这些值。如果 Btrieve 可以按电话号码排序，那就更好了。然后使用 cd 上的数据生成报告。

（如果你走这条路，我建议从[Andreas Hausladen 的博客中获取](http://andy.jgknet.de/blog/)[Midas SpeedFix](http://andy.jgknet.de/blog/?page_id=529)，以及你可以在那里找到的其他最好的东西）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T17:10:46.420

好的，这是一种运行良好并且应该可以很好地扩展的双通道老式方法（我曾经对数百万条记录数据库使用过这种方法，虽然需要时间但给出了准确的结果）。

1.  下载并安装 Turbo Power [SysTools——](http://sourceforge.net/projects/tpsystools/)排序引擎非常适合这个过程。
2.  创建一个排序，具有固定的电话号码记录，您将使用它进行排序。
3.  遍历您的记录，在每个订单中，将电话号码添加到排序中。
4.  第一次迭代完成后，开始从排序中弹出电话号码，如果电话号码与上次读取的电话号码相同，则增加计数器，否则报告号码并清除计数器。

这个过程也可以用任何 SQL 数据库完成，但我的经验是排序方法比管理临时表更快，并且生成相同的结果。

**编辑**——你说这是一个 BTrieve 数据库，为什么不直接在电话号码上创建一个键，对那个键进行排序，然后在这个表上应用第 4 步（下一个而不是弹出）。无论哪种方式，您都需要触摸数据库中的每条记录以获取计数，索引/排序只会使您的决策过程更容易。

例如，假设您有两个表，一个是 customer 表，一个是存储结果的表，另一个是 orders 表。按相同的电话号码对两者进行排序。然后在两个列表的顶部启动一个光标，然后应用以下伪代码：

```
Count := 0;
While (CustomerTable <> eof) and (OrderTable <> eof) do
  begin
    comp = comparetext( customer.phone, order.phone );
    while (comp = 0) and (not orderTable eof) do 
      begin
        inc( Count );
        order.next;
        comp = comparetext( customer.phone, order.phone );
      end;
    if comp < 0 then
      begin
        Customer.TotalCount = count;
        save customer;
        count := 0;
        Customer.next;
      end
    else if (Comp > 0) and (not OrderTable EOF) then
      begin
        Order.Next;  // order no customer
      end;  
   end;

// handle case where end of orders reached
if (OrdersTable EOF) and (not CustomersTable EOF) then
  begin
    Customer.TotalCount = count;
    save customer;
  end; 
```

这段代码的好处是遍历两个列表一次。由于两个列表的排序相同，因此无需查找，仅在必要时才可以从上到下进行操作。唯一的要求是两个列表有共同点（在这个例子中是电话号码），并且两个列表都可以排序。

我没有处理有订单而没有客户的情况。我的假设是，如果没有客户，订单就不存在，并且会被跳过以进行计数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T16:40:36.150

如果您要将它保存在内存中并且不想要任何花哨的东西，那么您最好使用 TStringList 以便您可以使用 Find 函数。Find 使用 Hoare 的选择或快速选择，一个 O(n) 定位器。例如，定义一个类型：

```
type
   TPhoneData = class
      private
         fPhone:string;
         fFirstCalledDate:TDateTime;
         fLastCalledDate:TDateTime;
         fCallCount:integer;
      public
         constructor Create(phone:string; firstDate, lastDate:TDateTime);
         procedure updateCallData(date:TDateTime);
         property phoneNumber:string read fPhone write fPhone;
         property firstCalledDate:TDateTime read fFirstCalledDate write fFirstCalledDate;
         property lastCalledDate:TDateTime read fLastCalledDate write fLastCalledDate;
         property callCount:integer read fCallCount write fCallCount;
      end;

{ TPhoneData }

constructor TPhoneData.Create(phone: string; firstDate, lastDate: TDateTime);
begin
fCallCount:=1;
fFirstCalledDate:=firstDate;
fLastCalledDate:=lastDate;
fPhone:=phone;
end;

procedure TPhoneData.updateCallData(date: TDateTime);
begin
inc(fCallCount);
if fFirstCalledDate<date then fFirstCalledDate:=date;
if date>fLastCalledDate then fLastCalledDate:=date;
end; 
```

然后填写，报告：

```
procedure TForm1.btnSortExampleClick(Sender: TObject);
const phoneSeed:array[0..9] of string = ('111-111-1111','222-222-2222','333-333-3333','444-444-4444','555-555-5555','666-666-6666','777-777-7777','888-888-8888','999-999-9999','000-000-0000');

var TSL:TStringList;
    TPD:TPhoneData;
    i,index:integer;
    phone:string;
begin
randseed;
TSL:=TStringList.Create;
TSL.Sorted:=true;
for i := 0 to 100 do
   begin
   phone:=phoneSeed[random(9)];
   if TSL.Find(phone, index) then
      TPhoneData(TSL.Objects[index]).updateCallData(now-random(100))
   else
      TSL.AddObject(phone,TPhoneData.Create(phone,now,now));
   end;
for i := 0 to 9 do
   begin
   if TSL.Find(phoneSeed[i], index) then
      begin
      TPD:=TPhoneData(TSL.Objects[index]);
      ShowMessage(Format('Phone # %s, first called %s, last called %s, num calls %d', [TPD.PhoneNumber, FormatDateTime('mm-dd-yyyy',TPD.firstCalledDate), FormatDateTime('mm-dd-yyyy',TPD.lastCalledDate), TPD.callCount]));
      end;
   end;
end; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T15:57:58.013

抱歉，无法编辑我的帖子（当时未注册）。一旦数据库中的所有记录都被迭代，数据将被丢弃。该函数不会经常被调用。它基本上将被用作确定人们在一段时间内从我们已有的记录中订购的频率的一种方式，因此实际上只需要生成一个单独的列表。

数据将在列表创建期间保持不变。也就是说，在读取最后一条数据库记录之前，需要搜索所有电话号码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T22:12:14.977

我会建议使用[DeCAL](http://sourceforge.net/projects/decal/)（在 sf.net 上）DMap 而不是 TStringList 将项目存储在内存中。您可以指定电话是键并存储包含其余记录的记录/类结构。

所以你的 Record 类将是：

```
 TPhoneData = class
    number: string;
    access_count: integer;
    added: TDateTime.
     ...
  end; 
```

然后在代码中：

```
 procedure TSomeClass.RegisterPhone(number, phoneData);
  begin
    //FStore created in Constructor as FStore := DMap.Create;
    FStore.putPair([number, phoneData])
  end;
  ...
  procedure TSoemClass.GetPhoneAndIncrement(number);
  var
    Iter: DIterator;
    lPhoneData: TPhoneData;
  begin
    Iter := FStore.locate([number]);
    if atEnd(Iter) then
      raise Exception.CreateFmt('Number %s not found',[number])
    else
    begin
      lPhoneData := GetObject(Iter) as TPhoneData;
      lPhoneData.access_count = lPhoneData.access_count + 1;
      //no need to save back to FStore as it holds a pointer to lPhoneData
    end;
  end; 
```

DMap 实现了一个红/黑树，因此数据结构可以免费为您排序键。您还可以使用 DHashMap 来获得相同的效果并（可以说）提高速度。

DeCAL 是我最喜欢的数据结构库之一，建议任何进行内存存储操作的人来看看。

希望有帮助

# .net - 为什么使用 System.Drawing 创建的 JPEG 图像比原始位图大？

> ID：825487
> 
> 赞同：3
> 
> 时间：2009-05-05T15:39:31.567
> 
> 标签：.net, image-processing, image-manipulation, system.drawing

我遇到了一个奇怪的问题——我有大约 1450 万张位图图像，据说是未压缩的。我需要将这些位图转换为 JPG 并将它们存储在数据库中。

当我使用 .NET System.Drawing 库中提供的类将位图保存为 ImageFormat.Jpeg 时，生成的 JPEG 大约是原始位图大小的**两倍。**这是代码：

```
byte[] bitmapBytes = //get from the db
using(MemoryStream bitmapStream = new MemoryStream(bitmapBytes))
{
   using(Bitmap bitmap = (Bitmap)Bitmap.FromStream(bitmapStream))
   {
       bitmap.Save("jpg.jpg", ImageFormat.Jpeg);
   }
} 
```

我查看了其中几个图像的 HEX，看起来压缩设置为“无”。所以我假设它们是未压缩的。此外，原始文件的 HEX 具有“BMP”代码，而生成的文件具有您所期望的“JFIF”代码。

图像是黑白的，没有颜色。

关于为什么会发生这种情况的任何想法？寻找正确方向的指针...

编辑：

*   我尝试使用备用重载来保存，以允许您指定质量。没有看到任何好处。
*   我还应该说明我在这里在某种程度上坚持使用 JPEG。这是一个遗留系统，系统的其他部分需要 JPEG。

图片属性：

*   位图尺寸：152x48
*   位图文件大小：1022 字节
*   JPEG：相同尺寸
*   JPEG 大小：2.2 kb
*   位图信息：索引，1 层（2 种颜色）
*   位图分辨率：96.012x 96.012 ppi

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T15:45:46.420

这可能是因为您保存的 jpeg 图像现在是 24 位 RGB 彩色图像，其中位图是 1 bpp 黑白图像。

如果位图为 1 bpp，则 jpeg 可能不是将它们转换为的最佳格式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-05T15:59:38.760

黑白还是灰度？

来自[http://www.faqs.org/faqs/compression-faq/part2/section-6.html](http://www.faqs.org/faqs/compression-faq/part2/section-6.html)：

“JPEG 适用于全彩色或灰度图像；它不能处理双层（黑白）图像，至少不是很好。它也不处理彩色映射图像；您必须将它们预先扩展为未映射的图像“

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-05T15:43:30.933

您需要为编码器设置一个属性来告诉它要使用的压缩级别。

也可以看看

*   [编码器参数类](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.encoderparameter.aspx)
*   [Image:Save 方法（字符串、ImageCodecInfo、EncoderParameters）](http://msdn.microsoft.com/en-us/library/ytz20d80.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T15:44:23.740

您将希望切换到使用[此重载 Bitmap.Save](http://msdn.microsoft.com/en-us/library/ytz20d80.aspx)，因此您可以指定[EncoderParameter](http://msdn.microsoft.com/en-us/library/hwkztaft.aspx)。

至于为什么您的文件越来越大，可能是您的 BMP 是运行长度编码的，或者使用了更小的（不是 24 位）位图。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-05T18:19:11.450

2 色 61x64 图像的尺寸比较：

*   Fax-4 tiff：268 字节
*   2色bmp（如上）：550字节
*   8 位 jpeg：1502 字节
*   32 位 jpeg（如 System.Drawing 将创建）：2015 字节

因此，如果您必须使用 jpeg，请先将它们转换为 8 位。在 .Net 中这样做会很尴尬，但 CodeProject 和其他网站上有示例代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-07T20:23:19.480

只是想跟进我的解决方案。我能够让系统的其余部分支持 PNG 格式的图形，所以我所做的就是将位图转换为 PNG 图形，并使它们每像素 1 位黑白。这使它们变得小而高效。

所以问题是 JPG 不能很好地处理少色图像。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T15:44:02.167

[在此处查看（如何：设置 JPEG 压缩级别）以获得一些见解和示例](http://msdn.microsoft.com/en-us/library/bb882583.aspx)，ImageCodecInfo 和 EncoderParameters 是关键

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-05T18:29:14.407

只是一个想法：您说系统的一部分需要文件是 JPEG 文件。这是真的还是只需要文件具有 JPG 扩展名？如果是这样，您可以 - 尽管它很难看 - 只需重命名文件扩展名，因为您的 BMP 文件更小。

例如在 Windows 中，您可以获取一个 BMP 文件并将其扩展名更改为 JPG，当您打开它时，Windows 不会在意并正确显示它。

# mysql - Rails ActiveRecord - 有没有办法对没有 id 的表执行操作？

> ID：825489
> 
> 赞同：3
> 
> 时间：2009-05-05T15:40:16.153
> 
> 标签：mysql, ruby-on-rails, ruby, activerecord

我有一张一排两列的桌子-

```
int 'version', datetime 'updated' 
```

是否有 Rails ActiveRecord 方法来获取和设置这些列中的数据？没有 id 列。

我正在使用此表来跟踪其他表的查询版本。在另一个表的每次查询之后，版本列都会增加，并且更新的列设置为当前日期时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T15:50:24.350

在您的模型类中，用于`self.primary_key = "primary_key_column"`指定要用作主键列的列。我想在你的情况下你可以使用版本列。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T19:30:17.643

没有什么能阻止你在没有 ID 的 ActiveRecord 中使用它：

迁移包含：

```
create_table :posts, :id => false do |t|
  t.integer :version
  t.datetime :updated
end 
```

查询：

```
>> Post.create(:version => 1, :updated => Time.now)
=> #<Post version: 1, updated: "2009-05-05 19:24:31">
>> Post.all
=> [#<Post version: 1, updated: "2009-05-05 19:24:31">]
>> Post.all(:conditions => { :version => 1 })
=> [#<Post version: 1, updated: "2009-05-05 19:24:31">] 
```

日志报告这些 SQL 请求：

```
CREATE TABLE "posts" ("version" integer, "updated" datetime) ;
INSERT INTO "posts" ("version", "updated") VALUES(1, '2009-05-05 19:24:31');
SELECT * FROM "posts" 
SELECT * FROM "posts" WHERE ("posts"."version" = 1) 
```

希望有帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T15:49:33.587

`id`当没有列存在时，Rails 唯一可以使用的是`has_and_belongs_to_many`连接表。

否则，您必须使用纯 SQL，例如：

```
SomeModel.connection.execute "select * from mytable" 
```

* * *

或者，如果`version`打算成为主键，请使用约翰的答案。

# xslt - xslt concat with select inside for-each

> ID：825501
> 
> 赞同：1
> 
> 时间：2009-05-05T15:43:28.283
> 
> 标签：xslt

我可以在 xslt 的 concat 中使用 Select 吗？例如

```
<xsl:for-each select="root/OrderItems/lineitem">
  <xsl:element name="img">
    <xsl:attribute name="src">
    <xsl:value-of select="concat('http://www.site.com/r&amp;h=11', '&amp;q=',<xsl:value-of select="Quantity" />, )" />
    </xsl:attribute>
    </xsl:element>
</xsl:for-each> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T15:47:31.253

试试这个：

```
<xsl:for-each select="root/OrderItems/lineitem">
  <xsl:element name="img">
    <xsl:attribute name="src">
      <xsl:value-of 
        select="concat('http://www.site.com/r&amp;h=11', '&amp;q=', Quantity)" />
    </xsl:attribute>
  </xsl:element>
</xsl:for-each> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T15:47:44.467

不，因为它不是格式良好的 XML，所以您不能将自关闭 XML 元素放在自关闭 XML 元素中，或者我想在这种情况下您不能在 XML 属性的值中使用 XML 元素

# xslt - 条件适用于 XSLT 1.0 样式表，但不适用于 XSLT 2.0 样式表

> ID：825503
> 
> 赞同：0
> 
> 时间：2009-05-05T15:43:49.547
> 
> 标签：xslt

考虑递归调用的模板中存在的这种情况：

```
<xsl:if test="$i &lt;= $count"> 
```

我正在使用 XSLT 2.0 处理器（Saxon-B 9.1.0.6）。该条件似乎只在运行 XSLT 1.0 样式表时有效。当样式表版本设置为 2.0（应该如此）时，它将停止工作。

任何想法为什么？

这是整个事情：

```
<xsl:template name="for.loop">
    <xsl:param name="i" />
    <xsl:param name="count" />

    <xsl:if test="$i &lt;= $count">
    ...
    </xsl:if>

    <!-- Repeat the loop by recursion -->
    <xsl:if test="$i &lt;= $count">
        <xsl:call-template name="for.loop">
            <xsl:with-param name="i">
                <xsl:value-of select="$i + 1" />
            </xsl:with-param>
            <xsl:with-param name="count">
                <xsl:value-of select="$count" />
            </xsl:with-param>
        </xsl:call-template>
    </xsl:if>
</xsl:template> 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T15:58:07.187

这是我的怀疑：根据数据类型`$i`和`$coun`t 是什么，“小于”测试在 2.0 中可能会失败（它支持比 1.0 更多的数据类型），而在 1.0 中存在一个可以做正确事情的隐式转换。

在比较之前尝试将数据转换为正确的类型，例如使用`number()`.

# java - 你如何使用 Java 库？

> ID：825521
> 
> 赞同：36
> 
> 时间：2009-05-05T15:46:09.523
> 
> 标签：java, jar

我正在尝试使用开源 java 库来可视化图中的节点和边，但我完全迷失了。

我在一个文件夹中有一堆 jar 文件。单击一些 jar 文件会使 java swing 窗口弹出并显示图形。单击其他 jar 文件不会执行任何操作。

如果我想通了，我会将 jar 文件与其他文件一起粘贴在那里，还是仍然行不通？

如果我知道如何使用这些文件，这是否意味着如果我将我的 java 项目转移到另一台计算机上，我必须包含它们？我该怎么做呢？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-05T15:49:57.923

我相信如果你把 jars 放在你的类路径中，你可以像使用标准库一样导入和使用类。弄清楚类路径可能会令人困惑，但您可以在启动 jvm 时设置它。您的 IDE 也可能有它的选项。

大多数java问题都是类路径问题。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-05T15:50:20.763

您是否将这些库包含在类路径中？

如果你使用的是 eclipse，你可以

项目 -> 属性 -> Java 构建路径 ->addJar。

并且 Jar 文件应放置在工作空间内的目录中（例如 lib/）

如果您必须将项目带到另一台计算机上，您可以采取以下步骤

1.  在做任何事情之前，请导出您的项目（例如，作为 Jar 文件）。
2.  将其保存到您最喜欢的驱动器（cd / USB 驱动器/软盘/磁带）。
3.  在“另一台”计算机上，您可以将此项目导入您的工作区

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-05T16:01:53.340

在 Eclipse 中，您需要将库添加到[项目构建路径](http://help.eclipse.org/ganymede/topic/org.eclipse.jdt.doc.user/reference/preferences/java/ref-preferences-build-path.htm)中。

通常，您需要在编译时和运行时通过类路径机制提供依赖项。精确的机制各不相同，但是，例如，如果您使用[javac](http://java.sun.com/javase/6/docs/technotes/tools/index.html#basic)编译器，您将在命令行上提供您的库：

```
javac -classpath C:\dir\lib1.jar;C:\dir\lib2.jar foo/MyClass.java 
```

调用应用程序也需要这些依赖项：

```
java -classpath C:\dir\lib1.jar;C:\dir\lib2.jar;. foo.MyClass 
```

[这个页面](http://mindprod.com/jgloss/classpath.html#JAR)提供了一些很好的信息，尽管谷歌搜索“类路径”一词应该提供替代来源。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-05T15:50:39.997

您可以通过将它包含在 java 应用程序的类路径中来使用它，这样您就可以从代码中引用它。[这](http://java.sun.com/j2se/1.5.0/docs/tooldocs/windows/classpath.html)是一个入门文档。JDK 1.6 有一些更简单的选项（例如将多个 jar 文件指定为 *.jar）。这肯定有点复杂，但非常值得了解。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T15:54:49.567

你应该有这些罐子的文档。有些听起来像例子，但一个必须是核心的图形建模和渲染 Jar。希望这些示例包含源代码。

只需将该 Jar 添加到 Eclipse 中的项目中（例如，在项目的 /lib 文件夹中，然后将其添加到构建路径中）并使用文档来使用代码。您还可以使用 Eclipse 查看 Jar 文件的内部。

除非别无选择，否则可能不值得使用至少在 API 级别上没有记录的大量第三方代码，而且没有任何源示例绝对不值得。

# sharepoint - 帮助将按钮添加到列表上的“操作”菜单

> ID：825548
> 
> 赞同：1
> 
> 时间：2009-05-05T15:51:16.033
> 
> 标签：sharepoint

我创建了一个 CustomAction 功能来向列表上的“操作”菜单添加一个按钮。当我没有指定 ControlAssembly/ControlClass 属性时，就会显示该按钮。当我指定这些属性时，按钮不会显示。我尝试在网站 web.config 中添加匹配的 SafeControl 元素。我正在使用 VSeWSS。

更新 - 删除了其他问题的链接 - 不知道我是怎么做到的。我的问题是谁能告诉我为什么在我指定 ControlAssembly 和 ControlClass 属性时我的 CustomAction 按钮没有显示？

更新 2 - RegenConfigTemp 实际上确实继承自 WebControl，对不起！我的具有 Web 访问权限的机器与我的开发机器不同，除了刻录 CD 之外，无法在它们之间移动文件。

这是我的文件：

```
清单.xml
<?xml 版本="1.0" 编码="utf-8"?>
<Solution SolutionId="GUIDHERE" xmlns="http://schemas.microsoft.com/sharepoint/">
  <功能清单>
    <FeatureManifest Location="RegenConfigTemp\feature.xml" />
  </FeatureManifests>
  <组件>
    <Assembly Location="WebFeature.dll" DeploymentTarget="GlobalAssemblyCache" />
  </程序集>
</解决方案>

```

```
特征.xml
<Feature Id="GUIDHERE" Title="RegenConfigTemp" Scope="Web" Version="1.0.0.0" Hidden="FALSE" DefaultResourceFile="core" xmlns="http://schemas.microsoft.com/sharepoint/" >
  <元素清单>
    <ElementManifest Location="RegenConfigTemp\Module.xml" />
  </元素清单>
</功能>

```

```
模块.xml
<?xml 版本="1.0" 编码="utf-8"?>
<Elements Id="GUIDHERE" xmlns="http://schemas.microsoft.com/sharepoint/">
  <自定义动作
    Id="GUIDHERE"
    注册类型="列表"
    注册 ID="1981"
    GroupId="ActionsMenu"
    位置="Microsoft.SharePoint.StandardMenu"
    序列="1000"
    Title="重新生成列表内容"
    ControlAssembly="WebFeature，版本=1.0.0.0，文化=中性，PublicKeyToken=myPKTokenHere"
    ControlClass="WebFeature.RegenConfigTemp"
  ></自定义动作>
</元素>

```

```
RegenConfigTemp.cs
使用系统；
使用 System.Runtime.InteropServices；
使用 System.Web.UI.WebControls；
使用 Microsoft.SharePoint.WebControls；

命名空间 WebFeature
{
    [Guid("这里的 GUID 匹配 Module.xml 中的第一个 GUID")]
    公共类 RegenConfigTemp：WebControl
    {
        受保护的覆盖无效 OnLoad(EventArgs e)
        {
            this.EnsureChildControls();
            base.OnLoad(e);
        }
        受保护的覆盖无效 CreateChildControls()
        {
            base.CreateChildControls();
        }
    }
}

```

我将以下内容添加到 web.config

```
<SafeControl Assembly="WebFeature, Version=1.0.0.0, Culture=neutral, PublicKeyToken=myPKTokenHere" Namespace="WebFeature" TypeName="RegenConfigTemp" Safe="True" />
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T15:52:38.213

原来问题出在 Module.xml 中。我在此（已更正）行中的“版本”之后缺少“等号”符号：ControlAssembly="WebFeature, Version=1.0.0.0, Culture=neutral, PublicKeyToken=myPKTokenHere"

我走上了正确的道路 b/c 我发现了 Sharepoint 的诊断日志记录，这个博客上的第一条评论：[http](http://blog.lostparticles.net/?p=23) ://blog.lostparticles.net/?p=23正是我的问题。

谢谢大家的帮助。

更新：我也必须修复 web.config 行。我最终将 safecontrol 行放在清单中，而不是直接放在 web.config 中；谢谢JMD。（顺便说一句，为什么 VSeWSS 不为我这样做，而它为 Web 部件呢？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T18:07:25.020

你确定你的代码应该渲染任何东西吗？您从哪个类继承以及您的渲染代码在哪里？您是否检查过 SharePoint 日志是否有任何异常？

这不是您问题的答案，但您可以将 SafeControl 标记放在清单中而不是 web.config 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T21:54:17.143

当然`RegenConfigTemp`应该是从某些东西继承？目前你没有添加任何控件，所以如果你覆盖一个空控件，这就是你什么都看不到的原因。如果不出意外，请尝试设置断点或添加一些诊断跟踪以`CreateChildControls()`查看代码是否正在执行。

# c# - 在 .net 中替换 OpenFileDialog / SaveFileDialog

> ID：825552
> 
> 赞同：1
> 
> 时间：2009-05-05T15:51:59.760
> 
> 标签：c#, .net, openfiledialog, savefiledialog

在我正在处理的应用程序中，我一直在尝试将 SaveFileDialog 和 OpenFileDialog 用于它们的习惯目的（保存和打开文件。）

但是，应用程序不能支持模态表单/对话框而不崩溃，因为拥有 UI 的线程上发生了太多时间敏感的事情。

重写应用程序以将这些功能从拥有 UI 的线程中移出在短期内是不切实际的。为了完成我一直在研究的功能，我需要一个替代两个文件对话框，最好是一个可以存在于非模态表单上的控件。

有什么我可以使用的不会阻塞我拥有 UI 的线程吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T15:58:33.520

> 拥有 UI 的线程上发生了太多对时间敏感的事情。

那是你真正的问题。.Net 具有非常强大的多线程支持。我建议你把这些东西移到别处，虽然看起来很不愉快。这可能比重新实现“打开/保存”对话框的工作量少，而且从长远来看，对于您的应用程序来说肯定会少一些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T15:59:28.523

我知道的唯一现有选项是商业产品[Dialog Workshop.NET](http://www.componentage.com/dwnet.htm)。他们有一组对话框，可以选择无模式（或直接嵌入到窗口窗体而不是单独的窗口中）。

但是，我真的会考虑尝试将您的时间敏感逻辑移动到一个单独的线程中。拥有无模式对话框可能会使用户感到困惑，因为它不会像文件对话框那样表现。拥有不可阻止的 UI 还有其他潜在后果。

# javascript - 使用 javascript 应用 css 会覆盖悬停链接样式？

> ID：825553
> 
> 赞同：0
> 
> 时间：2009-05-05T15:52:01.960
> 
> 标签：javascript, css

我有一些 JavaScript 可以正确更改图像，但是一旦调用它，我的 a:hover CSS 代码就不再起作用。

用 firebug 看下面的 JavaScript 会创建这个 css 规则：

```
element.style {
background-image:url(/content/images/side_partnershipsOver.png);
}

document.getElementById('partnerships').style.backgroundImage = "url(/content/images/side_partnershipsOver.png)"; 
```

如何应用 JavaScript 并且不让 element.style 规则覆盖 a:hover 代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T16:04:33.537

据我所知，设置 element.style.backgroundImage 与使用内联样式基本相同。

```
<style type="text/css">
  a { background: blue; }
  a:hover { background:green; }
</style>
<a href="#" style="background:red;">link<a> 
```

不幸的是，内联样式总是获胜。在上面的示例中，链接将始终为红色。正如 Daniel White 所说，jQuery 在这里会非常有用。尽管您可以通过两种方式解决此问题。

一、使用javascript编写样式标签生成样式

```
document.write("<style type='text/css'>#partnerships { background-image:url(/content/images/side_partnershipsOver.png);}</style>"); 
```

或者二，手动设置 mouseenter/mouseleave 事件来处理你的悬停风格

**更新**

或三，正如 KevinUK 所指出的，使用 !important css 标签覆盖内联样式集。

```
<style type="text/css">
  a { background: blue; }
  a:hover { background:green !important; }
</style>
<a href="#" style="background:red;">link<a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-09T16:59:19.360

我也对这种 CSS js 样式差距感到沮丧，所以我构建
**了一些方法来使用 CSS 字符串从 js 应用样式**

[elm.jCSS(cssText);elm.jCSSPseudo(cssText,pseudoElt)](https://stackoverflow.com/questions/131653/how-do-i-embed-an-ahover-rule-into-a-style-attribute-in-the-middle-of-a/7476067#7476067)

# nginx - 在 nginx.conf 文件中查找强度的长度

> ID：825554
> 
> 赞同：1
> 
> 时间：2009-05-05T15:52:10.227
> 
> 标签：nginx

我的 $memcached_keys 在 nginx 的 .conf 文件中太长时遇到问题。我正在使用 memcached 模块，但我的一些网址太长了。我正在尝试使用 URL 的 MD5 哈希值，但同时我只是想知道是否有一种方法可以检查存储在变量中的字符串的长度。

所以：

```
set $memcached_key "byp-$uri";
if ($args) {
    set $memcached_key "byp-$uri?$args";
}

if (len($memcache_key) < 250) {
     memcached_pass 127.0.0.1:11211;
     error_page 404 = @cache_miss;
     error_page 502 = @cache_miss;
}
else {
    pass to @cache_miss;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-03-15T04:32:13.447

老问题但是....

要执行此类操作，您需要一个脚本设置，例如 Lua 模块：

```
location / {
    set_by_lua $memcached_key '
        if not ngx.var.args then 
            return "byp-" ..  ngx.var.uri
        else 
            return "byp-" ..  ngx.var.uri .. "?" ..  ngx.var.args
        end
    ';
    content_by_lua '
        local string = string;
        if string.len($memcached_key) < 250 then
            ngx.exec("/memcached");
        else
            ngx.exec("/cache_miss");
        end
    ';
}
location /memcached {
    internal;
    memcached_pass 127.0.0.1:11211;
    error_page 404 = /cache_miss;
    error_page 502 = /cache_miss;
}
location /cache_miss {
    internal;
    ...
} 
```

由于后者的一些怪癖，建议“内部”位置而不是命名位置，但也可以使用命名位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T13:19:01.617

我不是很肯定，但我认为它不能在 nginx 配置语言中完成。我怀疑如果它存在，它会被记录[在这里](http://wiki.nginx.org/NginxHttpMainModule)，我什么也没看到。

# java - java.lang.Math.PI 是否等于 GCC 的 M_PI？

> ID：825559
> 
> 赞同：6
> 
> 时间：2009-05-05T15:53:21.270
> 
> 标签：java, gcc, floating-point, language-features, pi

我正在用 Java 和 C/C++ 编写几个参考算法。其中一些算法使用 π。我希望每个算法的两种实现产生**相同**的结果，而不会以不同的方式舍入。迄今为止一直有效的一种方法是使用`pi`在两种语言中完全相同的自定义常量，例如 3.14159。然而，当 Java 和 GCC 库中已经定义了高精度常量时，定义 pi 让我觉得很愚蠢。

我花了一些时间编写快速测试程序，查看每个库的文档，并阅读浮点类型。但我无法说服自己 java.lang.Math.PI（或 java.lang.StrictMath.PI）是否等于 math.h 中的 M_PI。

GCC 3.4.4 (cygwin) math.h 包含：

```
#define M_PI            3.14159265358979323846
                                         ^^^^^ 
```

但是这个

```
printf("%.20f", M_PI); 
```

生产

```
3.14159265358979311600
                 ^^^^^ 
```

这表明最后 5 位数字不可信。

同时，Javadocs 说 java.lang.Math.PI 是：

> `double`比任何其他值更接近*pi*的值，圆周长与其直径的比率。

和

```
public static final double PI  3.141592653589793d 
```

它省略了常数中可疑的最后五位数字。

```
System.out.printf("%.20f\n", Math.PI); 
```

生产

```
3.14159265358979300000
                 ^^^^^ 
```

如果你在浮点数据类型方面有一定的专业知识，你能说服我这些库常量是完全相等的吗？或者他们绝对不相等？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-05T16:12:20.320

请注意以下事项。

这两个数字相同到小数点后 16 位。这几乎是相同的 48 位。

在 IEEE 64 位浮点数中，这就是所有不是符号或指数的位。

有`#define M_PI`21 位数字；这大约是 63 位的精度，这对于 IEEE 80 位浮点值很有用。

我认为您看到的是`M_PI`值中位的普通截断。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-05T16:05:37.807

您要做的是打印出 PI 值的原始位模式并进行比较。

在 Java 中，使用[http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Double.html#doubleToRawLongBits(double)](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Double.html#doubleToRawLongBits(double))方法获取应该打印为二进制的长值。

Java 5 给出：

*   PI 是 3.141592653589793
*   原始位是 4614256656552045848
*   二进制是 100000000001001001000011111101101010100010001000010110100011000

在 C 中，您`double pi = M_PI; printf("%lld\n", pi);`可以获得相同的 64 位整数：4614256656552045848（感谢 Bruno）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T16:27:36.617

**即使起始值**相同，也很难计算出相同的值。

浮点计算结果有时会因架构而异（例如 x86/PowerPC）、编译器与另一个（例如 GCC/MS C++）甚至使用相同的编译器，但编译选项不同。并非总是如此，但有时（通常是四舍五入时）。通常足以让问题被忽视，直到为时已晚（在许多次迭代和许多次舍入差异之后考虑）

这使得同步计算游戏状态的每次迭代的跨平台多人游戏变得相当困难（每个节点只接收输入，而不是实际的数据结构）。

因此，即使使用相同的语言 (C/C++)，结果也可能不同，从 Java VM 到本机主机，结果也可能不同。

**更新：**

我找不到我阅读的来源，但我找到了[Sun](http://docs.sun.com/source/806-3568/ncg_goldberg.html#3098)关于此事的一篇论文。

就像您自己回答的那样，**java.lang.Math.PI 和 GCC 的 M_PI 可以管理为具有相同的值**。魔鬼隐藏在这些价值观的使用中。IEEE 没有指定数学函数的输出（sin、cos、exp、...）。因此，**计算的输出**不一定相同。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T20:07:14.980

是的，它们是平等的，并且使用它们将确保相同算法的 GCC 和 Java 实现处于相同的基础上——至少与使用手动定义的`pi`常量一样^†。

[S. Lott](https://stackoverflow.com/questions/825559#825668)暗示的一个警告是，GCC 实现必须`M_PI`包含`double`数据类型，而不是`long double`，以确保等效性。Java 和 GCC 似乎都使用 IEEE-754 的 64 位十进制表示来表示它们各自的`double`数据类型。库值的字节表示（MSB 到 LSB），表示为 a `double`，可以如下获得（感谢[JeeBee](https://stackoverflow.com/questions/825559#825631)）：

pi_bytes.c：

```
#include <math.h>
#include <stdio.h>
int main()
{
   double pi = M_PI;
   printf("%016llx\n", *((uint64_t*)&pi));
} 
```

pi_bytes.java：

```
class pi_bytes
{
   public static void main(String[] a)
   {
      System.out.printf("%016x\n", Double.doubleToRawLongBits( Math.PI ) );
   }
} 
```

同时运行：

```
$ gcc -lm -o pi_bytes pi_bytes.c && ./pi_bytes
400921fb54442d18

$ javac pi_bytes.java && java pi_bytes
400921fb54442d18 
```

`M_PI`(as a `double`) 和的底层表示`Math.PI`是相同的，直到它们的位。

† – 正如[Steve Schnepp](https://stackoverflow.com/questions/825559#825746)所指出的，数学函数（如 sin、cos、exp 等）的输出不能保证相同，即使这些计算的输入是按位相同的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T16:11:35.983

一个双精度只有 52 位符号，所以我认为这只会给你大约 15 个基数 10 位数字，这可以解释为什么当你要求 20 位数字时你有 5 个零。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T20:07:24.327

您可以使用 BigDecimal 获得更高的准确性，例如：

```
private static final BigDecimal PI = new BigDecimal(
"3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679" +
    "8214808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196" +
    "4428810975665933446128475648233786783165271201909145648566923460348610454326648213393607260249141273" +
    "7245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094" +
    "3305727036575959195309218611738193261179310511854807446237996274956735188575272489122793818301194912" +
    "9833673362440656643086021394946395224737190702179860943702770539217176293176752384674818467669405132" +
    "0005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235" +
    "4201995611212902196086403441815981362977477130996051870721134999999837297804995105973173281609631859" +
    "5024459455346908302642522308253344685035261931188171010003137838752886587533208381420617177669147303" +
    "5982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989" +
    "3809525720106548586327886593615338182796823030195203530185296899577362259941389124972177528347913151" +
    "5574857242454150695950829533116861727855889075098381754637464939319255060400927701671139009848824012" +
    "8583616035637076601047101819429555961989467678374494482553797747268471040475346462080466842590694912" +
    "9331367702898915210475216205696602405803815019351125338243003558764024749647326391419927260426992279" +
    "6782354781636009341721641219924586315030286182974555706749838505494588586926995690927210797509302955" +
    "3211653449872027559602364806654991198818347977535663698074265425278625518184175746728909777727938000" +
    "8164706001614524919217321721477235014144197356854816136115735255213347574184946843852332390739414333" +
    "4547762416862518983569485562099219222184272550254256887671790494601653466804988627232791786085784383" +
    "8279679766814541009538837863609506800642251252051173929848960841284886269456042419652850222106611863" +
    "0674427862203919494504712371378696095636437191728746776465757396241389086583264599581339047802759009" +
    "9465764078951269468398352595709825822620522489407726719478268482601476990902640136394437455305068203" +
    "4962524517493996514314298091906592509372216964615157098583874105978859597729754989301617539284681382" +
    "6868386894277415599185592524595395943104997252468084598727364469584865383673622262609912460805124388" +
    "4390451244136549762780797715691435997700129616089441694868555848406353422072225828488648158456028506" +
    "0168427394522674676788952521385225499546667278239864565961163548862305774564980355936345681743241125"
);

public static void main(String... args) throws InterruptedException {
    System.out.println("PI to " + PI.scale() + " digits is " + PI);
    System.out.println("PI^2 to " + PI.scale() + " digits is " + 
            PI.multiply(PI).setScale(PI.scale(), BigDecimal.ROUND_HALF_UP));
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-07T23:59:18.480

带回必须在 fortran 中获取 pi 值的记忆。

由于没有常量库，我要么使用 4*atan(1.) 要么使用 acos(-1.)。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-05-05T16:06:22.783

不，它们不相等，它们在记忆中的表现不同。

一般来说，当你想比较 2 个浮点值时，你不能使用 == （如果是这样，你就不能使用 termin 'equals' 进行操作）。您应该使用与 epsilon 的比较。

```
double eps = 0.0000001;
if (Math.abs (Java_PI - Another_Pi) <= eps)
  System.out.println ("equals"); 
```

# visual-studio - 集成 SVN 源代码管理和 Visual Studio .NET 2005/2008 的正确方法？

> ID：825569
> 
> 赞同：6
> 
> 时间：2009-05-05T15:54:28.130
> 
> 标签：visual-studio, svn, version-control, svnignore

维护自动（或至少默认情况下）拒绝包含 /bin、/obj、*.suo 等文件的源代码存储库的最佳实践是什么？

是否应该要求每个开发人员为其 SVN 客户端安装设置“全局忽略”模式列表？[*这似乎过于宽泛的排除。*]

或者，源存储库维护者是否应该使用 SVN:exclude 标记每个有问题的文件和目录？[*这似乎太费时了。*]

或者，还有其他方法可以做到这一点吗？SVN 是否可以创建特定于文件夹级别的忽略列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T16:00:01.207

`svn:ignore`在包含要忽略的文件/目录的目录上设置属性。这是一笔交易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T16:09:56.767

我们目前在客户端使用强制的全局忽略模式，正如您所指出的那样，这并不理想。我们至少有一个设置和配置开发环境的文档，其中包括最新的权威忽略模式（比如这个[Best general SVN Ignore Pattern?](https://stackoverflow.com/questions/85353/best-general-svn-ignore-pattern)）。

我很好奇 svn:ignore 的行为，正如 Romain Verdier 所建议的那样。我已经对他的回答发表了评论。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-05T16:12:32.410

我建议你使用[Ankhsvn](http://ankhsvn.open.collab.net/)。它会为你做所有这些事情。

# installation - 如何使用 Inno Setup 安装程序升级 MSI 安装？

> ID：825576
> 
> 赞同：7
> 
> 时间：2009-05-05T15:55:13.667
> 
> 标签：installation, windows-installer, inno-setup

我们最近从基于 Visual Studio 设置 msi 的安装程序转移到 Inno Setup，但我们在使用这个新安装程序升级现有安装时遇到了问题。我知道即使产品代码每次更新都会更改，升级代码仍然是静态的，所以我最初尝试将其设置为 Inno Setup 项目中的 AppId，但这不起作用。然后我尝试了一些其他的 guid 都不起作用。

有没有办法使用 Inno Setup 安装程序正确升级 msi 安装？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T15:57:21.337

不，我不这么认为——InnoSetup 显然**不是**基于 MSI 的安装程序。

您需要首先使用例如 msiexec /X（产品代码或 MSI 文件名）正确卸载旧的基于 MSI 的安装，然后您可以使用 InnoSetup 安装新的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T22:06:27.397

要从 Inno Setup 安装中安装 .MSI 文件，请尝试以下几行：

```
[Files]
Source: "Your-MSI-File.msi"; DestDir: "{tmp}"

[Run]
Filename: "msiexec.exe"; Parameters: "/i ""{tmp}\Your-MSI-File.msi""" 
```

Alex Yackimoff 的学分 [http://www.jrsoftware.org/iskb.php?msi](http://www.jrsoftware.org/iskb.php?msi)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-13T16:40:37.140

我需要使用 MSI 包（替换为 Inno Setup 安装程序）来执行此操作。我在 Inno Setup 安装程序中使用以下代码在安装时自动卸载 MSI 包（如果已安装）：

```
function PrepareToInstall(var NeedsRestart: Boolean): string;
var
  OldAppGuid, SubKeyName: string;
  OldAppFound: Boolean;
  ResultCode: Integer;
begin
  NeedsRestart := false;
  result := '';
  if IsAdminInstallMode() then
  begin
    OldAppGuid := '{nnnnnnnn-nnnn-nnnn-nnnn-nnnnnnnnnnnn}';
    SubKeyName := 'SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Uninstall\' + OldAppGuid;
    OldAppFound := RegKeyExists(HKEY_LOCAL_MACHINE, SubKeyName);
    if not OldAppFound then
    begin
      SubKeyName := 'SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\' + OldAppGuid;
      OldAppFound := RegKeyExists(HKEY_LOCAL_MACHINE, SubKeyName);
    end;
    if OldAppFound then
    begin
      Exec(ExpandConstant('{sys}\msiexec.exe'),              // Filename
        '/X ' + OldAppGuid + ' /qb- REBOOT=ReallySuppress',  // Params
        '',                                                  // WorkingDir
        SW_SHOW,                                             // ShowCmd
        ewWaitUntilTerminated,                               // Wait
        ResultCode);                                         // ResultCode
    end;  
  end;
end; 
```

当然，替换`{nnnnnnnn-nnnn-nnnn-nnnn-nnnnnnnnnnnn}`为 MSI 包的产品 ID GUID。

# c# - MessageWindow - 我如何判断它是否已被破坏？

> ID：825583
> 
> 赞同：0
> 
> 时间：2009-05-05T15:56:51.183
> 
> 标签：c#, compact-framework, messagewindow

我正在使用 C# 和 CF，我需要使用 MessageWindow 来拦截 Windows 消息。

可能存在 MessageWindow 意外死亡的情况。这对我来说是个问题，因为它收到的消息有点重要，我想记录 Window 已经死掉的事实。

不幸的是，我看不到任何方式（至少在托管 API 中没有）可以收到这种通知。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T18:50:17.037

一些想法：

您可以通过在每个 X 间隔生成您自己的特殊消息来“ping”MessageWindow 吗？然后检查这个“ping”，这样你就可以确保在大约。X时间。

或者您可以覆盖 Dispose 或 Finalize 调用吗？如果这些被调用。我还假设没有抛出异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T03:43:39.143

不知道你所说的“死”是什么意思，但一般来说，当一个窗口被破坏时（包括一个 MessageWindow 的底层），你会得到一个 WM_DESTROY 调用。你能在 WndProc 中寻找它吗？

# c# - 如何在windows中获得z-order？

> ID：825595
> 
> 赞同：30
> 
> 时间：2009-05-05T15:59:21.083
> 
> 标签：c#, .net, windows, z-order

我正在制作一个与每个正在运行的应用程序交互的应用程序。现在，我需要一种获取窗口 z 顺序的方法。例如，如果 Firefox 和记事本正在运行，我需要知道哪个在前面。

有任何想法吗？除了为每个应用程序的主窗口执行此操作外，我还需要为其子窗口和姊妹窗口（属于同一进程的窗口）执行此操作。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-05T16:03:38.187

您可以使用 GetTopWindow 函数搜索父窗口的所有子窗口，并返回 z 顺序最高的子窗口的句柄。GetNextWindow 函数以 z 顺序检索下一个或上一个窗口的句柄。

GetTopWindow： http: [//msdn.microsoft.com/en-us/library/ms633514](http://msdn.microsoft.com/en-us/library/ms633514(VS.85).aspx)
(VS.85).aspx GetNextWindow： http://msdn.microsoft.com/en-us/library/ms633509(VS.85 [) .aspx](http://msdn.microsoft.com/en-us/library/ms633509(VS.85).aspx)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-03-02T05:11:32.153

简洁明了：

```
int GetZOrder(IntPtr hWnd)
{
    var z = 0;
    for (var h = hWnd; h != IntPtr.Zero; h = GetWindow(h, GW.HWNDPREV)) z++;
    return z;
} 
```

如果您需要更高的可靠性：

```
/// <summary>
/// Gets the z-order for one or more windows atomically with respect to each other. In Windows, smaller z-order is higher. If the window is not top level, the z order is returned as -1\. 
/// </summary>
int[] GetZOrder(params IntPtr[] hWnds)
{
    var z = new int[hWnds.Length];
    for (var i = 0; i < hWnds.Length; i++) z[i] = -1;

    var index = 0;
    var numRemaining = hWnds.Length;
    EnumWindows((wnd, param) =>
    {
        var searchIndex = Array.IndexOf(hWnds, wnd);
        if (searchIndex != -1)
        {
            z[searchIndex] = index;
            numRemaining--;
            if (numRemaining == 0) return false;
        }
        index++;
        return true;
    }, IntPtr.Zero);

    return z;
} 
```

（根据备注部分[`GetWindow`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms633515.aspx)，`EnumChildWindows`比`GetWindow`在循环中调用更安全，因为您的`GetWindow`循环对于外部更改不是原子的。根据参数部分[`EnumChildWindows`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms633494.aspx)，使用 null 父级调用等效于`EnumWindows`。）

然后，您无需为每个窗口单独调用`EnumWindows`（这也不是原子的并且不受并发更改的影响），而是将要比较的每个窗口发送到 params 数组中，以便可以同时检索它们的 z 顺序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-09-14T12:40:01.330

这是我的 C# 解决方案：该函数返回给定 HWND 的兄弟之间的 zIndex，从 0 开始，最低 zOrder。

```
using System;
using System.Runtime.InteropServices;

namespace Win32
{
    public static class HwndHelper
    {
        [DllImport("user32.dll")]
        private static extern IntPtr GetWindow(IntPtr hWnd, uint uCmd);

        public static bool GetWindowZOrder(IntPtr hwnd, out int zOrder)
        {
            const uint GW_HWNDPREV = 3;
            const uint GW_HWNDLAST = 1;

            var lowestHwnd = GetWindow(hwnd, GW_HWNDLAST);

            var z = 0;
            var hwndTmp = lowestHwnd;
            while (hwndTmp != IntPtr.Zero)
            {
                if (hwnd == hwndTmp)
                {
                    zOrder = z;
                    return true;
                }

                hwndTmp = GetWindow(hwndTmp, GW_HWNDPREV);
                z++;
            }

            zOrder = int.MinValue;
            return false;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-12-29T23:39:36.543

```
 // Find z-order for window.
            Process[] procs = Process.GetProcessesByName("notepad");
            Process top = null;
            int topz = int.MaxValue;
            foreach (Process p in procs)
            {
                IntPtr handle = p.MainWindowHandle;
                int z = 0;
                do
                {
                    z++;
                    handle = GetWindow(handle, 3);
                } while(handle != IntPtr.Zero);

                if (z < topz)
                {
                    top = p;
                    topz = z;
                }
            }

            if(top != null)
                Debug.WriteLine(top.MainWindowTitle); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-04-16T05:12:46.137

获取 Z-Order 实现此功能（通过使用`GetWindow`Windows API 功能）

```
[DllImport("user32.dll", SetLastError = true)]
static extern IntPtr GetWindow(IntPtr hWnd, uint uCmd);

static int GetWindowZOrder(IntPtr hWnd)
{
    var zOrder = -1;
    while ((hWnd = GetWindow(hWnd, 2 /* GW_HWNDNEXT */)) != IntPtr.Zero) zOrder++;
    return zOrder;
} 
```

返回值是一个**从零开始的索引**。返回 -1 表示无效的 hWnd。

方法是通过窗户到顶部。爬升的总数是 Z-Order 的值。

# blackberry - 黑莓 - 应用程序未显示在模拟器上

> ID：825611
> 
> 赞同：1
> 
> 时间：2009-05-05T16:01:10.940
> 
> 标签：blackberry, eclipse-plugin, rim-4.6

我正在使用 Blackberry SDK 4.6 eclipse 插件来创建应用程序。在模拟器上进行测试时，我的应用程序一直运行良好。然后我运行 clear.bat 来删除我添加的所有应用程序。

现在，每当我尝试从 Eclipse 编译和运行我的应用程序时，它都不会出现在模拟器中。我尝试再次创建整个项目，但结果仍然相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-06T08:27:36.340

尝试在启动模拟器的批处理文件中使用 /clear-flash 命令，这会将 sim 重置为“默认”模式。

.cod 文件是否与模拟器放在同一个文件夹中？从 Eclipse 运行时模拟器是否打开？

# c# - OrderedTest - 不保留先前测试的值。- visualstudio208 - 单元测试

> ID：825614
> 
> 赞同：0
> 
> 时间：2009-05-05T16:02:19.563
> 
> 标签：c#, visual-studio, unit-testing, automated-tests

我正在尝试使用 VSTS 2008 单元测试对应用程序进行单元测试。我的问题是：我想按顺序调用两个测试用例。为此，我正在使用 VSTS 2008 的有序测试用例功能。我面临的问题是我增加了 TestA 中一个变量（X）的值，并基于该值我在 TestB 中检查了一些东西。但是当控件进入 TestB 时，我得到了 X 的初始值，而不是在 TestA 中增加的值。我认为为每个测试 vsts 在内存中创建一个测试类的新实例。请提出解决方案，除了使用 STATIC 变量。

相同的代码如下

```
 [TestMethod()]
   public void ff()
    {
        i = 11;
    }

    [TestMethod()]
    public void gg()
    {
        if (i == 4)
        {

            System.Diagnostics.Debug.WriteLine("it is 4");
        }

        else
        {
            System.Diagnostics.Debug.WriteLine("it is 7");
        }
    } 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T16:10:21.667

Is it possible to redesign your tests in a way that each one can be run separately? This is the correct way to test in 99% of cases. While it does increase overhead a bit, and you may be duplicating your setup a bit, it is far easier to maintain, and each test can focus on it's single function, without worrying about environmental changes.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T18:22:09.333

使用 Test>Windows 下的 TestView 窗口运行您的有序测试。

单击解决方案中的运行所有测试将导致您的有序测试无序运行

# programming-languages - 名为“C Set 2”的编程语言

> ID：825615
> 
> 赞同：0
> 
> 时间：2009-05-05T16:02:19.720
> 
> 标签：programming-languages

有人知道 SEI 关于功能点指标的统计中引用的名为“C Set 2”的编程语言吗？

我试图用谷歌搜索一些关于这种编程语言的东西，但这种语言名称是非谷歌关键词的集合。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T16:08:39.407

C Set/2 是用于 OS/2 的 IBM C 产品。我认为它只是 C 的 IBM 版本，但已经很久了。

* * *

是的，这里有一些链接：

*   [http://www.os2site.com/sw/info/os2apars/os2apars.txt](http://www.os2site.com/sw/info/os2apars/os2apars.txt)
*   [http://www.os2museum.com/wp/os2-history/os2-2-0/](http://www.os2museum.com/wp/os2-history/os2-2-0/)
*   [http://web.archive.org/web/20100725043713/http://pages.prodigy.net/michaln/history/exhibits/index.html](http://web.archive.org/web/20100725043713/http://pages.prodigy.net/michaln/history/exhibits/index.html)

嘿，我向最终编写 CSet 的实验室人员教授 C++。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-02T18:30:59.603

C Set/2 是 OS/2 的 C 编译器。以前我在 OS/2 上工作时使用过它。

# c# - 如何从保存的数据重建 ASP.NET MVC 中的 URL/路由？

> ID：825616
> 
> 赞同：2
> 
> 时间：2009-05-05T16:03:16.160
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-routing

我对 ASP.NET MVC 框架及其管道的不熟悉把我带到了这里，我感谢任何人阅读和考虑我的问题所需要的耐心！

好的，这是场景：我有一个应用程序，它有许多带有网格的页面，这些页面显示基于搜索的数据、从其他数据向下钻取、基于上下文特定数据的报告（即它们位于 Foo 的详细信息页面上，然后单击在显示与 Foo 相关的数据表的链接上）等。

从应用程序中的所有这些页面中，用户可以通过为其命名和描述来保存“报告”或网格。这并没有真正保存显示在网格中的数据，而是保存定义网格外观的参数，保存用于*获取*数据的参数，并保存定义“位置”的参数它们是应用程序（动作、控制器、路由）——基本上是一堆关于报告/网格以及如何构建它的元数据。

所有这些保存的报告都在一个列表中可用，在应用程序的某个页面上显示名称和描述，每个链接到一个通用 URL，如“/Reports/Saved/248”（其中 248 是报告的 ID）。

*这是我需要帮助的部分：*

当我通过 url “/Reports/Saved/248” 执行操作并将元数据从数据库中拉出该特定报告时，如何将该数据和请求重定向到用于显示的相同操作、控制器和路由最初保存报告的视图？本质上，我希望用户在同一个视图中查看报表，并使用与保存报表相同的 URL。如果可能的话，如果我能够基本上“调用”相同的操作，就好像我正在进行方法调用一样，这将是一件好事。

* * *

更新：不幸的是，我们的报告页面（即这些网格出现的页面）没有使用 RESTful URL - 例如，我们有一个我们称之为高级搜索页面的页面，它需要相当多的潜在参数（近 30 个）从包含选择列表、文本框等的表单中。当用户提交该页面时，我们对接受模型绑定器为我们构建的复杂类型的操作执行 POST - 同样的操作是我想在用户调用时调用的操作从数据库中选择已保存的高级搜索。这个例子集中体现了我的问题。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T16:18:24.797

我认为您会希望将 RedirectToAction 与采用 RouteValueDictionary 的签名一起使用。您要重定向到的方法需要能够从控制器上的 ValueProvider 中提取值。它可能看起来像：

```
public ActionResult Saved( int id )
{
    var reportParams = db.Reports.SingleOrDefault( r => r.ID == id );
    if (reportParams == null)
       ...handle error...

    var routeValues = ParamsToRouteValueDictionary( reportParams );

    return RedirectToAction( reportParams.Action, reportParams.Controller, routeValues );
}

private RouteValueDictionary ParamsToRouteValueDictionary( object parameters )
{
     var values = new RouteValueDictionary();
     var properties = parameters.GetType().GetProperties()
                                .Where( p => p.Name != "Action" && p.Name != "Controller" );
     foreach (var prop in properties)
     {
         values.Add( prop.Name, prop.GetValue(parameters,null) );
     }

     return values;
} 
```

**编辑**

使用过滤器模型作为方法的参数实际上可能会更容易。您只需要操作的 GET 和 POST 版本。

```
 [ActionName("People")]
 [AcceptVerbs( HttpVerbs.Get )]
 public ActionResult PeopleDisplay( SearchModel filter )
 {
     return People( filter );
 }

 [AcceptVerbs( HttpVerbs.Post)]
 [ValidateAntiForgeryToken]
 public ActionResult People( SearchModel filter )
 {
     ....
 } 
```

然后，您将在您的数据库中存储过滤器参数（按名称）、操作（“人员”）和控制器。重定向结果将使用 GET 并被定向到 PeopleDisplay 方法，该方法又简单地使用正确的参数调用 People 方法。从表单发布直接调用 People 方法。使用两种方法可以让您使用 CSRF 预防机制。您也许可以在 TempData 中使用一个标志来确保只有在您希望限制对它的访问时才通过重定向机制调用 GET 操作。

**结束编辑**

另一种选择是简单地存储使用的视图，而不是进行重定向，只需渲染适当的视图。您需要考虑的一件事是，执行重定向最终会得到一个包含所有参数的 URL，而呈现视图将不理会 URL，只显示与创建报告时使用的 URL 相同的视图.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T16:16:39.013

您可以使用 RedirectToAction 方法发出 301 重定向到任何控制器上的特定操作方法，以及路由值：

```
ReportMeta meta = _reportDataAccess.Get(id);
return RedirectToAction(meta.Action, meta.Controller, meta.RouteData); 
```

这些值类似于：

```
meta.Action = "Bar";
meta.Controller = "Foo";
meta.RouteData = new {
    // possibly settings for the grid
    start = DateTime.Min,
    end = DateTime.Now,
    sort = "Date"
    // you get the idea
}; 
```

当然，我可以看到的直接问题是当您的控制器/操作方法随时间变化时会发生什么，报告数据将无效。但是你可能已经想到了。

# c# - MonoState、Singleton 或派生形式：CRUD 应用程序的最佳方法？

> ID：825617
> 
> 赞同：4
> 
> 时间：2009-05-05T16:03:23.960
> 
> 标签：c#, .net, winforms, design-patterns, singleton

我有一个相当大的 CRUD WinForm 应用程序，其中包含许多对象。 **人员、注册、计划、案例笔记等**。有超过 30 种表单组成应用程序，用户界面按逻辑分解。 **会员、注册、计划、案例笔记等**。

我试图弄清楚如何在*搜索表单*上搜索后创建我的***Person 对象***并将对象传递给下一个请求的表单。不管是什么，让我们说*Demographics*。简而言之，我需要 Person 对象在整个应用程序中都可用，并且只能有一个。

 **现在我对设计模式的接触为零，但我正在尝试。我已阅读[http://www.switchonthecode.com/tutorials/csharp-tutorial-singleton-pattern](http://www.switchonthecode.com/tutorials/csharp-tutorial-singleton-pattern)和[http://www.yoda.arachsys.com/csharp/singleton.html](http://www.yoda.arachsys.com/csharp/singleton.html)但我想确保我正确理解如何将此应用于我的情况。

首先，示例说明您正在访问*参考*，对吗？我弄错了还是需要访问该*值*？

其次，我还需要做些什么才能使其在全球范围内可用吗？我是否只是在每个表单上声明一个实例，但通过这个单例模式，以便没有多个？

谢谢

## 编辑 1

澄清一下，所有对象都是 Person 的子对象。此外，正如搜索页面所躲避的那样；用户可以选择不同的 currentPerson。但他们一次只能与***一个***人互动。

最后，正如我所说，我在这方面是个婴儿，如果我应该考虑其他事情，请换一种方法，如果你能提供一些解释，我将非常感激。

## 编辑 2

根据Medicine Man的评论，我想我应该澄清一下。

首先，感谢迄今为止做出贡献的所有人。其次，我不知道关于设计模式的第一件事，如果在我目前的情况下需要某个特定模式，我当然没有最模糊的认识。

如果有人有更好、更简单或在您看来更合适的将数据对象从 FORM 传递到 FORM 到 FORM 的方法，请告诉我。

最后，我只需要一种方法来跟踪我的用户从一个地方到另一个地方的信息。谢谢你

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T16:12:06.623

> 首先，示例说明您正在访问参考，对吗？我弄错了还是需要访问该值？

您正在访问的类是对内存中单个类的引用。例如，假设您的班级是：

```
public class Person { ... } 
```

如果你有一个单例，你将在内存中保存一个“人”，并在单例中共享对那个人的引用。当您访问您的单身人士时，您将使用该参考资料，这可能是您想要的。对这个人的任何改变都会在任何地方改变它。

> 其次，我还需要做些什么才能使其在全球范围内可用吗？我是否只是在每个表单上声明一个实例，但通过这个单例模式，以便没有多个？

单例基本上用于强制每次使用对象时，它都是同一个对象（每次使用都是对内存中单个对象的单独引用）。你可以在任何你需要的地方抓住单例，它就可以工作了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T16:07:49.690

你可以这样做：

```
public static class PersonController
{
    private static Person _Person;

    public static Person GetPerson()
    {
        if (_Person == null)
            _Person = new Person();

        return _Person;
    }
} 
```

这将确保只有一个人对象。您将获得对 _Person 对象的引用，而不是副本，因此任何更改都将针对您期望的单个对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T16:19:11.783

您可以使用单例模式来确保只创建一个实例。

然而，对于这是否是一个好的决定，[陪审团仍然没有](https://stackoverflow.com/questions/11831/singletons-good-design-or-a-crutch)定论（至少在我看来）。关于 SO 和其他地方有很多关于此的阅读。

我会从不同的角度来解决这个问题。我会让我的所有表单都接受构造函数中的 Person 实例。这样，每个表单只担心它是 Person 的实例。

您可以通过创建一个继承自 Form 并为您的 Person 具有字段/属性/构造函数的新类来做到这一点。然后，任何使用 Person 的表单都可以从您的新类继承。

当然，您必须管理 Person 对象的创建。你甚至可以用一个单例来做到这一点。但是，好处是每个表单都不必知道如何创建 Person 或谁创建了 Person。这样，如果您选择[远离 Singleton 模式](https://stackoverflow.com/questions/474613/how-should-i-refactor-my-code-to-remove-unnecessary-singletons)，您就不必更改对单例实例的所有引用。

**编辑：**

这里有一些代码来证明这一点。我花了一段时间才让设计师玩得很好。我不得不在 PersonForm 中添加一个空的私有构造函数来让设计器不抛出错误。

程序.cs

```
static class Program
    {
        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new MyDerivedForm(new Person { Name = "Hello World!" }));
        }
    } 
```

个人.cs

```
public class Person
{
    public virtual string Name { get; set; }
} 
```

个人表单.cs

```
using System;
using System.Windows.Forms;

public class PersonForm : Form
{
    private readonly Person myPerson;

    protected virtual Person MyPerson 
    {
        get
        {
            return this.myPerson;
        }
    }

    private PersonForm()
    {
    }

    public PersonForm(Person person)
    {
        this.myPerson = person;
    }
} 
```

MyDerivedForm.cs（添加一个名为 label1 的标签）

```
public partial class MyDerivedForm : SingletonMadness.PersonForm
{
    public MyDerivedForm(Person person)
        : base(person)
    {
        InitializeComponent();
    }

    private void MyDerivedForm_Load(object sender, EventArgs e)
    {
        label1.Text = this.MyPerson.Name;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T16:22:59.543

正如 Reed 所说，单例强制在整个应用程序中使用相同的对象。但是，从您的问题来看，在我看来，您在整个应用程序中都没有可用的 person 类的相同实例，因为有一个“搜索表单”，看起来它允许您更改当前选择的人。

在这种情况下，您的单例可能需要是一个容器类，它包含应用程序的当前上下文以及*当前*选择了哪个人。这可能是这样的：

```
public class Context
{
   private static Context _instance;

   public static Context Instance
   {
       get
       {
           if (_instance == null)
           {
               _instance = new Context();
           }
           return _instance;
       }
   }

   public Person CurrentlySelectedPerson { get; set; }

   private Context() { }
} 
```

（请注意，这不是理想的单例模式，因为它不是线程安全的......）

然后搜索表单会将当前选定的人员设置为：

```
Context.Instance.CurrentlySelectedPerson = personSelectedInForm; 
```

人口统计数据可以像这样使用它：

```
//Get the demographics for the current person
ShowDemographics(Context.Instance.CurrentlySelectedPerson); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T16:42:55.580

你也可以在你的`Person`班级中使用单态模式。

```
public class Person
{
    public Guid Id { get; set; }
    public String FirstName { get; set; }
    public String LastName { get; set; }
} 
```

为 .构建一个单态对象`Person`。

```
public class CurrentPerson
{
    public static Person Person { get; set; }

    public Guid Id
    {
        get { return CurrentPerson.Person.Id; }
        set { CurrentPerson.Person.Id = value; }
    }

    public String FirstName
    {
        get { return CurrentPerson.Person.FirstName; }
        set { CurrentPerson.Person.FirstName = value; }
    }

    public String LastName
    {
        get { return CurrentPerson.Person.LastName; }
        set { CurrentPerson.Person.LastName = value; }
    }
} 
```

现在您可以初始化单态。

```
CurrentPerson.Person = GetPersonByUserInput(); 
```

然后`CurrentPerson`在整个代码中使用实例，它们都将访问一个共同的共享状态。

```
CurrentPerson currentPerson = new CurrentPerson(); 
```

# episerver - 如何在 EPiServer 的内容编辑器中禁用发布按钮？

> ID：825620
> 
> 赞同：0
> 
> 时间：2009-05-05T16:03:51.713
> 
> 标签：episerver

我有一个 EPiServer 项目，它使用顺序工作流来验证内容更改。这工作正常，但是我们有一个小问题，即内容审阅者只是在对编辑的工作感到满意时才单击发布。他们应该做的是使用工作流任务窗口并通过它表明他们的批准。

为了强制执行此行为，我想在某些情况下禁用内容编辑器中的“发布”按钮（即，当有一个未完成的工作流任务链接到当前页面时）。

有没有人有任何想法我可以如何做到这一点，甚至可以完全解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-22T19:22:20.340

实际上，我认为您可能想重新审视您的工作流程逻辑。

如果具有发布权限的用户发布页面：这应该被视为批准。您可以轻松地连接到 Published 事件以查看该页面是否是当前正在运行的工作流的一部分。

# .net - 按钮不呈现为 XP 样式

> ID：825621
> 
> 赞同：2
> 
> 时间：2009-05-05T16:04:26.640
> 
> 标签：.net, winforms, user-interface

我有一个 .net WinForms 应用程序，其按钮在设计时显示为 XP 样式（圆角），但在运行时显示为 Windows 2000 样式（方角）。我的桌面主题设置为 XP 风格。我猜我忽略了一个明显的设置。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T16:08:20.483

在您的 Program.Main() 方法中，确保在 Application.Run 之前有这两行：

```
Application.EnableVisualStyles();
Application.SetCompatibleTextRenderingDefault(false); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T16:16:59.590

```
static void Main() 
{
    Application.EnableVisualStyles();
    Application.Run(new Form1());
} 
```

**在应用程序中创建任何控件之前必须调用**EnableVisualStyles ；**通常，**EnableVisualStyles**是**Main**函数的第一行。**

 **[MSDN 参考](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.enablevisualstyles(VS.71).aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T18:48:07.980

项目属性中还有一个名为*Enable XP Visual Styles*的选项，它具有相同的作用...实际上，如果您将代码放在上面，此复选框将成为项目属性中的检查...

# asp.net - 有没有 ASP.Net MVC 参考应用

> ID：825625
> 
> 赞同：6
> 
> 时间：2009-05-05T16:04:35.267
> 
> 标签：asp.net, asp.net-mvc, asp.net-ajax

我正在尝试学习 ASP.Net MVC 框架，我想知道是否有任何好的参考应用程序可以用来学习实现 ASP.Net 以及实现 LOB 应用程序的最佳实践。

如果可能的话，我希望看到一个也使用 AJAX 的 ASP.Net MVC 应用程序。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T16:22:49.653

NerdDinner
[http://www.codeplex.com/NerdDinner](http://www.codeplex.com/NerdDinner)

MVC 店面
[http://www.codeplex.com/mvcsamples](http://www.codeplex.com/mvcsamples)

KIGG（在 dotnetshoutout.com 上运行的 Digg 的 MVC 实现）
[http://www.codeplex.com/kigg](http://www.codeplex.com/kigg)

氧化物
[http://www.codeplex.com/oxite](http://www.codeplex.com/oxite)

代码营服务器
[http://code.google.com/p/codecampserver/](http://code.google.com/p/codecampserver/)

CarTrackr
[http://www.codeplex.com/CarTrackr](http://www.codeplex.com/CarTrackr)

StackOverflow（当然没有来源）
[http://www.stackoverflow.com](http://www.stackoverflow.com)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T16:09:16.817

[书呆子晚餐](http://www.nerddinner.com/)

[代码和教程](http://weblogs.asp.net/scottgu/archive/2009/03/10/free-asp-net-mvc-ebook-tutorial.aspx)可作为 ASP.Net MVC 1.0 Book by [Conery](https://stackoverflow.com/users/1151/rob-conery)、[Hanselman](https://stackoverflow.com/users/6380/scott-hanselman)、[Haack](https://stackoverflow.com/users/598/haacked)和[Guthrie](http://weblogs.asp.net/scottgu/)的免费章节提供（找不到 SO 用户页面）

CodePlex 上[也提供源代码](http://nerddinner.codeplex.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T16:13:49.987

你看过书呆子晚餐吗？

[ScottGu 的博客](http://weblogs.asp.net/scottgu/archive/2009/04/01/asp-net-mvc-1-0.aspx)

还

[书呆子晚餐的 html 教程](http://nerddinnerbook.s3.amazonaws.com/Intro.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T16:06:03.487

[Oxite 项目（一个开源博客引擎）](http://www.codeplex.com/oxite)

然而，有人认为这不是一个值得学习的好例子：

[Oxite - 哦，亲爱的上帝，为什么？！](http://codebetter.com/blogs/karlseguin/archive/2008/12/15/oxite-oh-dear-lord-why.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T16:28:58.283

[CarTrackr是](http://cartrackr.codeplex.com/)[ASP.NET MVC 1.0 Quickly](http://www.packtpub.com/asp-net-model-view-controller-1-0-quickly/book)一书中的一个简单示例应用程序。

# java - 如何使用 Struts 防止 XSS 漏洞

> ID：825638
> 
> 赞同：2
> 
> 时间：2009-05-05T16:06:23.860
> 
> 标签：java, struts, xss

我们需要在我们的 Struts 应用程序中添加反 XSS 支持。最具体地说，架构师要求所有用户输入必须在存储到数据库之前“清理”。由于我不想重新发明方轮，我可以为此使用哪个 Java 库？放在哪里？理想情况下，它应该是可配置的（要检查哪些输入字段，而不是请求中的所有字段）并且速度很快。我的第一个想法是 Struts Validator。

在此先感谢 Lluis

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T18:53:29.687

我建议您查看 OWASP 的[ESAPI 项目](http://www.owasp.org/index.php/ESAPI)。它已经开发了一年多，即将发布 2.0。

要转义存储在数据库中的值，请查看 Encoder.encodeForSQL() 方法（[参考实现](http://code.google.com/p/owasp-esapi-java/source/browse/trunk/src/main/java/org/owasp/esapi/reference/DefaultEncoder.java)）。

对于输入验证，请查看 Validator（[参考实现](http://code.google.com/p/owasp-esapi-java/source/browse/trunk/src/main/java/org/owasp/esapi/reference/DefaultValidator.java)）。

注意：我的理解是，Stinger 和 CSRFGuard 等旧项目提供的功能已包含在 ESAPI 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T16:24:24.237

如果你在谷歌上搜索 XSS Java 过滤器，你会想出许多开源解决方案，比如[这个](https://xssfilter.dev.java.net/).

您还可以查看[OWASP 验证项目](http://www.owasp.org/index.php/Category:OWASP_Validation_Project)。

# c# - 如何使用 .net 紧凑框架找到 DataGrid 中的行数？

> ID：825645
> 
> 赞同：1
> 
> 时间：2009-05-05T16:07:37.740
> 
> 标签：c#, .net, windows-mobile, compact-framework

如何使用 .net 紧凑框架找到 DataGrid 中的行数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T16:13:33.607

Try querying the binding context of the DataGrid: `DataGrid.BindingContext[DataGrid.DataSource].Count`

Or, assuming the data source is a DataTable and you know something about the data source, you can also try `((DataTable)dataGrid1.DataSource).Rows.Count` or the equivalent.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T18:29:16.417

您是否将 DataReader 与 DB SQL 调用一起使用？如果是这样，您可以使用多个结果集来返回 SQL 调用中的行数。

这是我在下面的链接中描述的一个很好的例子。

[确定 DataReader 将要返回多少条记录](http://www.devx.com/vb2themax/Tip/18807)

# c# - 如何将 F4 键发送到 C# 中的进程？

> ID：825651
> 
> 赞同：9
> 
> 时间：2009-05-05T16:08:49.580
> 
> 标签：c#, process, keyboard, key

我正在从 Windows 应用程序启动一个进程。当我按下按钮时，我想模拟该过程中的按键操作`F4`。我怎样才能做到这一点？

[稍后编辑]我不想`F4`在我的表单中模拟按键的按下，而是在我开始的过程中。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-05T16:13:07.120

您可以使用[System.Windows.Forms.SendKeys.Send("{F4}")](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.aspx) ;

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-05T16:26:39.160

要将 F4 键发送到另一个进程，您必须激活该进程

[http://bytes.com/groups/net-c/230693-activate-other-process](http://bytes.com/groups/net-c/230693-activate-other-process)建议：

1.  获取 Process.Start 返回的 Process 类实例
2.  查询进程.MainWindowHandle
3.  调用非托管 Win32 API 函数“ShowWindow”或“SwitchToThisWindow”

然后，您可以按照 Reed 的建议使用 System.Windows.Forms.SendKeys.Send("{F4}") 将击键发送到此进程

编辑：

下面的代码示例运行记事本并向其发送“ABC”：

```
using System;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Windows.Forms;

namespace TextSendKeys
{
    class Program
    {
        [DllImport("user32.dll")]
        static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);

        static void Main(string[] args)
            {
                Process notepad = new Process();
                notepad.StartInfo.FileName = @"C:\Windows\Notepad.exe";
                notepad.Start();

                // Need to wait for notepad to start
                notepad.WaitForInputIdle();

                IntPtr p = notepad.MainWindowHandle;
                ShowWindow(p, 1);
                SendKeys.SendWait("ABC");
            }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T17:55:32.460

可以聚焦窗口（SetForegroundWindow WINAPI），然后用windows窗体的SendKeys发送F4。

# java - 如何使用反射比较类？

> ID：825654
> 
> 赞同：9
> 
> 时间：2009-05-05T16:09:27.173
> 
> 标签：java, reflection

我正在尝试使用反射确定类的类类型，然后做一些具体的事情。例如，如果类是双精度类，则使用双精度特定方法。

我正在尝试使用

```
 if(f.getClass() == Double.class) 
```

但是，我收到编译器错误：

“不兼容的操作数类型 Class <capture#1-of ? extends Field> 和 Class<Double>”

这样做的正确方法是什么？

编辑：更清楚

f 是字段类型。通过循环反射获得

```
 (Field f : instance.getDeclaredFields()) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T16:28:23.743

有趣的错误信息（我不知道 '==' 操作员会检查那些）。但基于此，我怀疑您的比较是错误的：您试图查看 Field 类（理论上它的超类，但仅在理论上——Field 是最终的）是否与 Double.class 相同，它不可能是.

所以：是的，如果你给出正确的论据，比较应该有效。所以我怀疑你想做：

if (f.getType() == Double.class)

反而。这应该可行，因为 Double 是最后一课。否则“isAssignableFrom”会更合适。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T16:19:04.343

如果您有对象，请使用

```
if (f instanceof Double) { } 
```

另一个有趣的事情是方法 isAssignableFrom：

```
if (f.getClass().isAssignableFrom (Double.class)) { } 
```

但总的来说，这是一种糟糕的风格。使用多态性来实现依赖于类类型的逻辑。

* * *

回答评论： f instanceof Double 工作正常。

你可能写了这样的东西：

```
float f = 1.1f;
if (f instanceof Double) { ..} 
```

智能java编译器说你有CE。但：

```
public static boolean isInstanceOfDouble (Object obj) {
   return obj instanceof Double;
}

psvm (String [] args) {
   sout (isInstanceOfDouble (1.1f);
} 
```

..这很好用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T16:12:37.230

最简单的方法是

```
if (f.getClass().equals(Double.class)) 
```

**编辑：**啊，现在我看到了问题。您得到的错误是因为（由于泛型）编译器可以告诉类永远不会相等（`Field.class`不能相等`Double.class`）。使用 .equals() 会将其变成警告而不是错误，但它仍然是错误代码。

`Field.getType()`为您提供字段的类型。由于在编译时无法知道这一点，因此如果您`==`像最初那样使用运算符，则不会出现错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T16:24:45.377

您应该使用 getType() 来获取基础类型，而不是获取类。getType() 根据需要返回底层类型的类。

代码如下所示：

```
 if(f.getType().equals(Double.class)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-29T13:42:46.183

以下代码片段应该可以完美运行：

```
if (f.getType() == Double.TYPE) 
```

顺便说一句，根据我的测试（JRE7），不适`==`用于`equals`数字**类型**

# php - 具有三个可选参数但需要一个参数的 PHP 类构造？

> ID：825658
> 
> 赞同：9
> 
> 时间：2009-05-05T16:09:59.420
> 
> 标签：php, class, parameters, constructor, optional-parameters

所以基本上我明白这一点......

```
class User
{
    function __construct($id) {}
}

$u = new User(); // PHP would NOT allow this 
```

我希望能够使用以下任何参数进行用户查找，但至少需要一个，同时保留 PHP 提供的默认错误处理（如果没有传递参数）...

```
class User
{
    function __construct($id=FALSE,$email=FALSE,$username=FALSE) {}
}

$u = new User(); // PHP would allow this 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-05T16:16:39.420

您可以使用数组来处理特定参数：

```
function __construct($param) {
    $id = null;
    $email = null;
    $username = null;
    if (is_int($param)) {
        // numerical ID was given
        $id = $param;
    } elseif (is_array($param)) {
        if (isset($param['id'])) {
            $id = $param['id'];
        }
        if (isset($param['email'])) {
            $email = $param['email'];
        }
        if (isset($param['username'])) {
            $username = $param['username'];
        }
    }
} 
```

以及如何使用它：

```
// ID
new User(12345);
// email
new User(array('email'=>'user@example.com'));
// username
new User(array('username'=>'John Doe'));
// multiple
new User(array('username'=>'John Doe', 'email'=>'user@example.com')); 
```

# java - Prevent Form spam with the session

> ID：825661
> 
> 赞同：2
> 
> 时间：2009-05-05T16:10:38.297
> 
> 标签：java, session, struts, spam-prevention

I've already read most of the questions regarding techniques to prevent form spam, but none of them seem to suggest the use of the browser's session.

We have a form that sends an email to given email address and we didn't like the idea of using "captchas" or Javascript, as we wanted to keep the user journey simple and accessible to those without Javascript.

We would like to use the session object to help prevent form spam. Our webapp is developed on Weblogic Server 10 using Struts.

The solution being, when the form loads, it would set a variable in the session object. Once you click submit, we check if the session for the variable. No variable, redirect to the form. Variable exists send the email.

I would really appreciate any opinions/reasons why this might be a bad idea, so we can evaluate this solution against others.

Many thanks, Jonathan

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T17:03:46.763

没有什么可以阻止垃圾邮件发送者自动下载您的表单（从而生成 cookie）并提交它。它可能会给垃圾邮件发送者带来轻微的负担，但微不足道。

例如，可以使用命令行工具（例如 cURL）轻松下载和提交表单，并保留 cookie。然后可以从脚本重复运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T16:25:42.610

根据实现的不同，会话对象在资源使用方面可能相对较重，而且速度有些慢。此外，垃圾邮件发送者，如果他们意识到您是如何阻止他们的，他们可以在每次点击表单时通过不发送回会话 cookie 来简单地启动一个新会话。

因此，由于该技术依赖于客户端的良好行为，并且预期的行为相当容易防止，因此它可能不如其他解决问题的方法有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T16:40:18.303

感谢您的回复 cdeszaq，但我不确定您是否误解了我的问题。

为了成功完成表单提交，客户端将被迫加载表单以正确设置会话对象。只有当会话处于正确状态时，才能发送电子邮件。

如果垃圾邮件发送者没有发回会话 cookie，那么他们将无法向我的表单发送垃圾邮件，因为他们没有进入创建正确会话的表单页面。

我同意使用会话对象会创建额外的资源。我们的实现将简单地（使用 JSP）调用`session.setAttribute("formLoaded", true);`，并在我的 Struts 操作中简单地用于`session.getAttribute("formLoaded");`检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T17:18:39.770

我想知道这是否可行：

1.  每次渲染页面/表单时，创建一个随机的文本位
2.  将该文本放入会话中
3.  将该文本作为隐藏字段包含在表单中
4.  用户提交表单
5.  操作将隐藏文本与会话中的值进行比较 - 如果匹配，则发送电子邮件

由于黑客无法在会话中添加任何随机值，因此他们无法发送垃圾邮件。正确的？

# database - 有效检查可能的重复实体

> ID：825664
> 
> 赞同：1
> 
> 时间：2009-05-05T16:11:34.597
> 
> 标签：database, search, duplicate-data

我需要在用户将实体保存到数据库之前生成可能重复的列表并警告他们可能的重复。

有 7 个标准我们应该检查重复项，如果至少 3 个匹配，我们应该将其标记给用户。条件将在 ID 上全部匹配，因此不需要模糊字符串匹配，但我的问题来自这样一个事实，即至少有 3 个项目可以匹配来自7 种可能的列表。

我不想执行 99 个单独的数据库查询来查找我的搜索结果，也不想从数据库中取回全部内容并在客户端进行过滤。目前我们可能只谈论几万条记录，但随着系统的成熟，这将增长到数百万条。

有没有人想到一个很好的有效方法来做到这一点？我正在考虑一个简单的 OR 查询来从数据库中获取至少一个字段匹配的记录，然后在客户端上进行一些处理以对其进行更多过滤，但是其中一些字段的基数非常低，实际上不会减少数量巨大。

谢谢乔恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T16:14:55.727

`OR`和`CASE`求和会起作用，但效率很低，因为它们不使用索引。

您需要使`UNION`索引可用。

如果用户将`name`、和输入到数据库中`phone`，并且您想要检查至少与这些字段中的一个匹配的所有记录，则发出：`email``address``3`

```
SELECT  i.*
FROM    (
        SELECT  id, COUNT(*)
        FROM    (
                SELECT  id
                FROM    t_info t
                WHERE   name  = 'Eve Chianese'
                UNION ALL
                SELECT  id
                FROM    t_info t
                WHERE   phone = '+15558000042'
                UNION ALL
                SELECT  id
                FROM    t_info t
                WHERE   email = '42@example.com'
                UNION ALL
                SELECT  id
                FROM    t_info t
                WHERE   address = '42 North Lane'
                ) q
        GROUP BY
                id
        HAVING  COUNT(*) >= 3
        ) dq
JOIN    t_info i
ON      i.id = dq.id 
```

这将在这些字段上使用索引，并且查询会很快。

有关详细信息，请参阅我的博客中的这篇文章：

*   [**Matching 3 of 4**](http://explainextended.com/2009/04/17/matching-3-of-4/)：如何匹配至少匹配可能条件`3`的`4`

另请参阅本文所基于的这个[**问题。**](https://stackoverflow.com/questions/761014/mysql-can-you-pull-results-that-match-like-3-out-of-4-expressions)

如果您想`DISTINCT`在现有数据中包含值列表，只需将此查询包装到子查询中：

```
SELECT  i.*
FROM    t_info i1
WHERE   EXISTS
        (
        SELECT  1
        FROM    (
                SELECT  id
                FROM    t_info t
                WHERE   name  = i1.name
                UNION ALL
                SELECT  id
                FROM    t_info t
                WHERE   phone = i1.phone
                UNION ALL
                SELECT  id
                FROM    t_info t
                WHERE   email = i1.email
                UNION ALL
                SELECT  id
                FROM    t_info t
                WHERE   address = i1.address
                ) q
        GROUP BY
                id
        HAVING  COUNT(*) >= 3
        ) 
```

请注意，这`DISTINCT`不是可传递的：如果`A`匹配`B`和`B`匹配`C`，这并不意味着`A`匹配`C`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T16:23:05.987

您可能需要以下内容：

```
SELECT id
FROM 
    (select id, CASE fld1 WHEN input1 THEN 1 ELSE 0 "rule1",
        CASE fld2 when input2 THEN 1 ELSE 0 "rule2",
        ...,
        CASE fld7 when input7 THEN 1 ELSE 0 "rule2",
    FROM table)
WHERE rule1+rule2+rule3+...+rule4 >= 3 
```

这未经测试，但它显示了解决此问题的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T16:15:49.220

你用的是什么星展银行？一些支持通过使用服务器端代码来使用此类约束。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T16:17:59.963

您是否考虑过使用带有游标的存储过程？然后，您可以执行 OR 查询，然后逐个遍历记录以查找匹配项。使用存储过程将允许您在服务器上进行所有检查。

但是，我认为具有数百万条记录的表扫描总是会很慢。我认为您应该找出最有可能匹配的 7 个字段中的哪一个，确保这些字段已编入索引。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T16:19:32.797

我假设您的系统正在尝试匹配某个帖子或类似内容的标签 ID。这是一个多对多的关系，你应该有三个表来处理它。一个用于帖子，一个用于标签，一个用于帖子和标签的关系。

如果我的假设是正确的，那么处理这个问题的最佳方法是：

```
SELECT postid, count(tagid) as common_tag_count
FROM posts_to_tags
WHERE tagid IN (tag1, tag2, tag3, ...)
GROUP BY postid
HAVING count(tagid) > 3; 
```

# sql-server - 覆盖 SQL Server Reporting Service 每小时订阅

> ID：825671
> 
> 赞同：1
> 
> 时间：2009-05-05T16:12:43.890
> 
> 标签：sql-server, reporting-services

用户希望设置 SSRS 报告以通过电子邮件发送给他们。经过一番谷歌搜索后，我发现这个链接显示了报告管理器的订阅界面。这几乎具有他们需要的所有功能，除了每小时报告订阅没有给他们足够的控制权。默认情况下，他们能够设置每小时报告，并提供所需的开始时间，但乍一看，我看不出他们如何指定结束时间。我需要的是一种方式来表达“在 5 点到 10 点之间每隔一小时给我发送一份报告”。

所以我正在寻找两个答案之一：

1.  真的有一个我只是想念的结束时间吗？
2.  如果没有，我如何覆盖每小时订阅页面并获取和结束时间。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T16:35:42.230

您可以使用 SQL 报告服务 Web 服务编写自己的订阅服务。

您可以安排订阅以每小时运行一次作业，然后编写您自己的服务，在他们不需要报告时暂停作业。

更多信息在这里：

[http://msdn.microsoft.com/en-us/library/ms154066(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms154066(SQL.90).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T19:44:57.750

或者，您也可以尝试编辑 SQL Server 作业参数。当 Reporting Services 创建“订阅”时，会创建一个 SQL Server 作业。该界面中有开始和结束时间参数。我尚未验证这是否提供了您正在寻找的功能。

此外，如果这不起作用并且您不想编写自己的订阅服务，那么您可以尝试创建 5 个不同的作业，每天运行一小时。我知道这有点麻烦，但也许额外的工作维护比额外的时间来编写自己的服务更可取。

# windows - 为什么 Win32::ODBC 在 Perl 5.10 和 Cygwin 下找不到 ODBC.dll？

> ID：825672
> 
> 赞同：4
> 
> 时间：2009-05-05T16:12:55.420
> 
> 标签：windows, database, perl, odbc, cygwin

我正在尝试使用 Perl ODBC 连接到 Microsoft SQL 服务器。我的问题是 Perl 5.10.0 在使用 Win32 ODBC 驱动程序时遇到问题。

如果我运行 Perl shell 并执行这一行，我会得到错误。

```
use Win32::ODBC;

Can't load '/usr/lib/perl5/vendor_perl/5.10/i686-cygwin/auto/Win32/ODBC/ODBC.dll'
for module Win32::ODBC: No such file or directory at
/usr/lib/perl5/5.10/i686-cygwin/DynaLoader.pm line 201. 
```

我已经验证了 dll 文件确实存在。

我已经安装了 Cygwin 软件包：

*   perl (5.10.0-5)
*   perl-libwin32 (0.28-2)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-23T01:01:20.920

这似乎是一个[已知问题](http://www.mail-archive.com/cygwin-announce@cygwin.com/msg02424.html)。获取[libiodbc 源](http://switch.dl.sourceforge.net/sourceforge/iodbc/libiodbc-3.52.6.tar.gz)，应用以下补丁，构建并安装：

```
diff -ub  libiodbc-3.52.6/include/iodbcunix.h.orig
--- libiodbc-3.52.6/include/iodbcunix.h.orig        2006-01-26 09:50:59.000000000 +0000
+++ libiodbc-3.52.6/include/iodbcunix.h     2007-12-24 19:33:57.859375000 +0000
@@ -124,6 +124,7 @@
 #if defined (OBSOLETE_WINDOWS_TYPES)
 typedef unsigned char              BYTE;
 #endif
+#ifndef WIN32
 typedef unsigned short             WORD;
 typedef unsigned int               DWORD;
 typedef char *                     LPSTR;
@@ -131,6 +132,7 @@         
 typedef wchar_t *          LPWSTR; 
 typedef const wchar_t *            LPCWSTR;
 typedef DWORD *                    LPDWORD;
+#endif

 #if !defined(BOOL) && !defined(_OBJC_OBJC_H_)
 typedef int                        BOOL; 
```

* * *

**更新：** Cygwin 的人[对此问题有一个 TODO](http://article.gmane.org/gmane.os.cygwin/105517)，但现在已经有几个月了。如果等待时间太长，您可以同时伪造它：

```
#! /bin/bash

# run from the libiodbc build directory

gcc -shared -o cygiodbc-2.dll \
    -Wl,--out-implib=libcygiodbc-2.dll.a \
    -Wl,--export-all-symbols \
    -Wl,--enable-auto-import \
    -Wl,--whole-archive iodbc/.libs/libiodbc.a \
    -Wl,--no-whole-archive

gcc -shared -o cygiodbcinst-2.dll \
    -Wl,--out-implib=libcygiodbcinst-2.dll.a \
    -Wl,--export-all-symbols \
    -Wl,--enable-auto-import \
    -Wl,--whole-archive iodbcinst/.libs/libiodbcinst.a \
    -Wl,--no-whole-archive

cp cygiodbc{,inst}-2.dll /bin 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T20:00:37.053

> 我已经验证了 dll 文件确实存在。

你的意思是`/usr/lib/perl5/vendor_perl/5.10/i686-cygwin/auto/Win32/ODBC/ODBC.dll`存在吗？如果是这样，您是否具有读取和执行权限？

/usr/lib/perl5/5.10/i686-cygwin/DynaLoader.pm 第 201 行上方有一条评论：

```
# Many dynamic extension loading problems will appear to come from
# this section of code: XYZ failed at line 123 of DynaLoader.pm.
# Often these errors are actually occurring in the initialisation
# C code of the extension XS file. Perl reports the error as being
# in this perl code simply because this was the last perl code
# it executed. 
```

因此，您的安装似乎有问题。您可以尝试使用以下方法重新安装 Win32::ODBC：

```
$ cpan Win32::ODBC 
```

# functional-programming - 函数式编程——标准符号、图表等

> ID：825675
> 
> 赞同：6
> 
> 时间：2009-05-05T16:13:30.003
> 
> 标签：functional-programming, uml, diagram

我有一个问题，我认为最好通过函数式编程来解决。

来自非常必要的背景，我习惯于涉及类图/描述、通信图、状态图等的程序设计。然而，这些图都暗示或用于描述系统的状态和各种副作用对系统执行的操作。

在函数式程序的设计中是否使用了任何标准化的图表或数学符号集，或者这些程序最好用简短的函数式伪代码设计（假设函数将比命令式对应物短得多）。

谢谢，迈克

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T16:17:22.537

函数式编程有一个秘诀。

1.  它在很大程度上是无状态的，因此传统的命令式图表无关紧要。

2.  大多数普通的、普通的数学符号也是无状态的。

函数式设计更像是代数。您将定义函数，并表明这些函数的组合会产生所需的结果。

图表不是必需的，因为函数式编程比过程式编程要简单一些。它更像是传统的数学符号。使用数学技术来证明你的各种功能做正确的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-07T03:58:57.087

函数式程序员更喜欢写方程式而不是写图表。该游戏称为*等式推理*，主要涉及

*   用等号代替等号

*   应用代数定律

*   偶尔的归纳证明

这个想法是您编写“明显正确”的非常简单的代码，然后使用等式推理将其变成更清洁和/或性能更好的东西。这门艺术的大师是一位名叫理查德伯德的牛津大学教授。

例如，如果我想简化 Scheme 表达式

```
(append (list x) l) 
```

我会疯狂地用equals代替equals。使用`list`我得到的定义

```
(append (cons x '()) l) 
```

替换我有的附加正文

```
(if (null? (cons x '())) 
    l
    (cons (car (cons x '())) (append (cdr (cons x '())) l))) 
```

现在我有这些代数定律：

```
(null? (cons a b)) == #f
(car   (cons a b)) == a
(cdr   (cons a b)) == b 
```

并用equals代替我得到的equals

```
(if #f
    l
    (cons x (append '() l)) 
```

用另一条定律`(if #f e1 e2) == e2`，我得到

```
(cons x (append '() l)) 
```

如果我再次扩展 append 的定义，我会得到

```
(cons x l) 
```

我已经证明等于

```
(append (list x) l) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-27T01:46:34.783

*   有这篇非常好的文章使用动画解释 Lambda 演算：[To Dissect a Mockingbird: A Graphical Notation for the Lambda Calculus with Animated Reduction](http://dkeenan.com/Lambda/)
*   这个和上一个非常相似，但是有一个实际的实现：[Lambda Animator](http://thyer.name/lambda-animator/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-05T16:29:30.433

我对函数式编程了解不多，但这里有两件事我遇到过

*   λ (lambda) 常用于表示函数
*   f ο g 用于表示函数组成

# java - 在Java中生成唯一且短文件名的最佳方法是什么

> ID：825678
> 
> 赞同：76
> 
> 时间：2009-05-05T16:13:56.930
> 
> 标签：java, file

我不一定要使用 UUID，因为它们相当长。

该文件只需要在其目录中是唯一的。

想到的一个想法是使用`File.createTempFile(String prefix, String suffix)`，但这似乎是错误的，因为该文件不是临时文件。

需要处理在同一毫秒内创建两个文件的情况。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-05-05T16:22:00.640

好吧，你可以使用 3-argument 版本：[`File.createTempFile(String prefix, String suffix, File directory)`](http://java.sun.com/javase/6/docs/api/java/io/File.html#createTempFile(java.lang.String,%20java.lang.String,%20java.io.File))它可以让你把它放在你想要的地方。除非您告诉它，否则 Java 不会将它与任何其他文件区别对待。唯一的缺点是文件名保证至少有 8 个字符长（前缀最少 3 个字符，加上函数生成的 5 个或更多字符）。

如果这对你来说太长了，我想你总是可以从文件名“a”开始，然后遍历“b”、“c”等，直到找到一个不存在的文件。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-05-05T16:51:46.997

我会使用 Apache Commons Lang 库（[http://commons.apache.org/lang](http://commons.apache.org/lang)）。

有一个类`org.apache.commons.lang.RandomStringUtils`可用于生成给定长度的随机字符串。**不仅对文件名生成非常方便！**

这是示例：

```
String ext = "dat";
File dir = new File("/home/pregzt");
String name = String.format("%s.%s", RandomStringUtils.randomAlphanumeric(8), ext);
File file = new File(dir, name); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-05T16:17:07.860

我使用时间戳

IE

```
new File( simpleDateFormat.format( new Date() ) ); 
```

并将 simpleDateFormat 初始化为：

```
new SimpleDateFormat("File-ddMMyy-hhmmss.SSS.txt"); 
```

**编辑**

关于什么

```
new File(String.format("%s.%s", sdf.format( new Date() ),
                                random.nextInt(9))); 
```

除非同一秒内创建的文件数量太多。

如果是这样的话，名字并不重要

```
 new File( "file."+count++ ); 
```

:P

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-09-04T06:24:18.173

这对我有用：

```
String generateUniqueFileName() {
    String filename = "";
    long millis = System.currentTimeMillis();
    String datetime = new Date().toGMTString();
    datetime = datetime.replace(" ", "");
    datetime = datetime.replace(":", "");
    String rndchars = RandomStringUtils.randomAlphanumeric(16);
    filename = rndchars + "_" + datetime + "_" + millis;
    return filename;
} 
```

`// USE:`

```
String newFile;
do{
newFile=generateUniqueFileName() + "." + FileExt;
}
while(new File(basePath+newFile).exists()); 
```

输出文件名应如下所示：

```
2OoBwH8OwYGKW2QE_4Sep2013061732GMT_1378275452253.Ext 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-05T16:31:11.880

查看[File javadoc](http://java.sun.com/javase/6/docs/api/java/io/File.html)，方法 createNewFile 将仅在文件不存在时创建文件，并返回一个布尔值来说明文件是否已创建。

你也可以使用 exists() 方法：

```
int i = 0;
String filename = Integer.toString(i);
File f = new File(filename);
while (f.exists()) {
    i++;
    filename = Integer.toString(i);
    f = new File(filename);
}
f.createNewFile();
System.out.println("File in use: " + f); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-05T16:52:16.573

如果您有权访问数据库，则可以在文件名中创建和使用序列。

```
select mySequence.nextval from dual; 
```

它将保证是唯一的并且不应该变得太大（除非您要抽出大量文件）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-02-21T11:04:22.047

```
 //Generating Unique File Name
    public String getFileName() {
        String timeStamp = new SimpleDateFormat("yyyy-MM-dd_HH:mm:ss").format(new Date());
        return "PNG_" + timeStamp + "_.png";
    } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-05T16:32:37.057

结合其他答案，为什么不使用附加随机值的 ms 时间戳；重复直到没有冲突，这在实践中几乎不会发生。

例如：文件-ccyymmdd-hhmmss-mmm-rrrrrr.txt

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-11-06T06:35:45.337

我使用带有随机数的当前毫秒

IE

```
Random random=new Random();
String ext = ".jpeg";
File dir = new File("/home/pregzt");
String name = String.format("%s%s",System.currentTimeMillis(),random.nextInt(100000)+ext);
File file = new File(dir, name); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-05T16:16:25.177

为什么不只使用基于时间戳的东西..？

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-09-20T15:35:10.887

问题是同步。分离出冲突区域。

将文件命名为： `(server-name)_(thread/process-name)_(millisecond/timestamp).(extension)`
示例：`aws1_t1_1447402821007.png`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-05T16:31:17.387

如何根据四舍五入到最接近的毫秒的时间戳生成，或者您需要的任何精度......然后使用锁来同步对函数的访问。

如果您存储最后生成的文件名，您可以根据需要附加连续的字母或更多数字以使其唯一。

或者，如果您宁愿不使用锁，请使用时间步长加上线程 ID，并确保函数花费的时间超过一毫秒，或者等待它这样做。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-05T18:14:41.010

看起来您有一些创建唯一文件名的解决方案，所以我将不理会它。我会以这种方式测试文件名：

```
 String filePath;
    boolean fileNotFound = true;
    while (fileNotFound) {
        String testPath = generateFilename();

        try {
            RandomAccessFile f = new RandomAccessFile(
                new File(testPath), "r");
        } catch (Exception e) {
            // exception thrown by RandomAccessFile if 
            // testPath doesn't exist (ie: it can't be read)

            filePath = testPath;
            fileNotFound = false;
        }
    }
    //now create your file with filePath 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-06-05T10:01:57.790

这也有效

```
String logFileName = new SimpleDateFormat("yyyyMMddHHmm'.txt'").format(new Date());

logFileName = "loggerFile_" + logFileName; 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-06-10T08:47:03.243

我知道我来不及回答这个问题了。但我认为我应该把它作为它看起来与其他解决方案不同的东西。

我们可以将 threadname 和 current timeStamp 连接为文件名。但是这样有一个问题，例如某些线程名称包含像“\”这样的特殊字符，这可能会在创建文件名时产生问题。所以我们可以从线程名称中删除特殊字符，然后连接线程名称和时间戳

```
fileName = threadName(after removing special charater) + currentTimeStamp 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-07-12T04:05:49.727

为什么不使用同步来处理多线程。这是我的解决方案，它可以生成一个短文件名，而且它是独一无二的。

```
private static synchronized String generateFileName(){
    String name = make(index);
    index ++;
    return name;
}
private static String make(int index) {
    if(index == 0) return "";
    return String.valueOf(chars[index % chars.length]) + make(index / chars.length);
}
private static int index = 1;
private static char[] chars = {'a','b','c','d','e','f','g',
        'h','i','j','k','l','m','n',
        'o','p','q','r','s','t',
        'u','v','w','x','y','z'}; 
```

自爆是测试的主要功能，它的工作。

```
public static void main(String[] args) {
    List<String> names = new ArrayList<>();
    List<Thread> threads = new ArrayList<>();
    for (int i = 0; i < 100; i++) {
        Thread thread = new Thread(new Runnable() {
            @Override
            public void run() {
                for (int i = 0; i < 1000; i++) {
                    String name = generateFileName();
                    names.add(name);
                }
            }
        });
        thread.run();
        threads.add(thread);
    }

    for (int i = 0; i < 10; i++) {
        try {
            threads.get(i).join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

    System.out.println(names);
    System.out.println(names.size());

} 
```

# c# - nHibernate 包查询问题

> ID：825680
> 
> 赞同：1
> 
> 时间：2009-05-05T16:15:18.923
> 
> 标签：c#, nhibernate

我在 nHibernate 中有以下场景：

```
<class name="TestApp.Components.User,TestApp.Components"  table="Users">
    <id name="Id" column="UserId" type="Int32" unsaved-value="0">
      <generator class="native"></generator>
    </id>
    <property name="UserName" type="string" length="100" not-null="false"/>
    <bag name="Groups" table="User_Group" lazy="true" >
      <key column="UserId"></key>
      <many-to-many class="Group" column="GroupId" />
    </bag>  
<class> 
```

我需要能够编写一个查询来返回一组组中的所有用户。

本质上，我希望执行以下 sql：

```
SELECT DISTINCT username from users u, user_group ug  
WHERE u.userid = ug.userid  
AND (ug.groupid = 1 OR ug.groupid = 2 OR ug.groupid = 3) 
```

我知道我可以在 HQL 中执行此操作，但我想使用 ICriteria 接口执行此操作。

```
var session = sessionManager.GetSession();  
var items = session.CreateCriteria(typeof(User));  

ICriterion criterion = null;  

foreach (var groupid in Groups)  
{  
    ICriterion tempCriterion = Restrictions.Eq("Groups.GroupId", groupid);  
    criterion = criterion == null ? tempCriterion : Restrictions.Or(criterion, tempCriterion);  
}  
items.Add(criterion); 
```

我已经尝试了上述方法，但它出错了，我似乎无法弄清楚我错过了什么。在查询中。

关于我需要如何构建这个查询，有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T16:30:19.590

试试这个：

```
var groupsCrit = items.CreateCriteria("Groups");
var groupIds = Restrictions.Disjunction();
foreach (var groupid in Groups)
{
    groupIds.Add(Restrictions.Eq("Id", groupid)); // "Id" should be the name of the Id property on the Group class
}
groupsCrit.Add(groupIds); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T19:03:54.127

我最终找到了一个很好的解决方案：

```
if (Groups!= null && Groups.Count > 0)
{
    var items = Groups.ConvertAll(i => i.Id).ToArray();

    criteria.CreateCriteria("Groups", "g", JoinType.LeftOuterJoin);
    criteria.Add(Restrictions.In("g.Id", items));
} 
```

这正是我正在寻找的。

# c++ - How to list SQL 2005 Express instances

> ID：825687
> 
> 赞同：2
> 
> 时间：2009-05-05T16:16:26.470
> 
> 标签：c++, instance, sql-server-2005-express, sqldmo

I would like to list what instances of SQL 2005 Server (Express Editon) are installed on local or remote machine (my app is in Native C++). I found that i can make it by SQLDMO, however it seems that SQLDMO does not see SQL 2005 Express Edition and call to ListAvailableSqlServers returns empty list.

How can i make it? Playing with system registry is an extreme solution and applies only for local machines.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T19:16:00.987

明白了... 找到 SQLBrowseConnect。答案在 MSDN 中与往常一样 :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T16:46:14.450

您可以尝试[SqlDataSourceEnumerator.GetDataSources()](http://msdn.microsoft.com/en-us/library/system.data.sql.sqldatasourceenumerator.getdatasources.aspx)。在 C# 和 VB.Net 中运行良好，虽然我没有在 C++ 中尝试过。

# python - 从主机名中提取域名

> ID：825694
> 
> 赞同：18
> 
> 时间：2009-05-05T16:17:13.100
> 
> 标签：python, dns, hostname

是否有一种编程方式可以从给定的主机名中查找域名？

给定 -> www.yahoo.co.jp 返回 -> yahoo.co.jp

有效但非常缓慢的方法是：

拆分“。” 并从左侧删除 1 个组，当返回有效的 SOA 记录时，使用 dnspython 加入和查询 SOA 记录，考虑一个域

在不使用正则表达式的情况下，是否有更清洁/更快的方法来做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-06T07:09:22.753

对于哪个“域名”是任何特定“主机名”的父级，没有简单的定义。

您当前遍历树直到看到`SOA`记录的方法实际上是最正确的。

从技术上讲，您正在做的是找到“区域切割”，并且在绝大多数情况下，这将对应于从其 TLD 委派域的点。

任何仅依赖于主机名文本解析而不参考 DNS 的方法都注定要失败。

或者，使用来自[http://publicsuffix.org/](http://publicsuffix.org/)的以委托为中心的域的集中维护列表，但要注意这些列表可能不完整和/或过时。

另请参阅[这个问题](https://stackoverflow.com/questions/399250/going-where-php-parseurl-doesnt-parsing-only-the-domain/401456#401456)，所有这些都已在之前完成...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T16:26:17.807

您可以使用[`partition`](http://docs.python.org/library/stdtypes.html)代替`split`：

```
>>> 'www.yahoo.co.jp'.partition('.')[2]
'yahoo.co.jp' 
```

这将有助于解析，但显然不会检查返回的字符串是否是有效域。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T07:16:21.643

你的算法是正确的。由于区域切割**不**反映在域名中（您会看到域切割 - 点 - 但不是区域切割），它是唯一正确的。

一种**近似**算法是使用区域列表，就像 Alnitak 提到的那样。请记住，这些静态列表不具有权威性，它们缺少许多注册表，它们是陈旧的，等等。

# c# - C# 3.5 ASP.net 文件 IO 问题，UnauthorizedAccessException 到网络共享文件

> ID：825709
> 
> 赞同：2
> 
> 时间：2009-05-05T16:20:18.257
> 
> 标签：c#, asp.net, visual-studio-2008, security, file-io

每次我尝试访问（只是**读取**）网络共享*“\\server\folder1\folder2\file.pdf”上的文件时，都会收到 UnauthorizedAccessException。*

我正在模拟对上述文件夹具有读写访问权限的 domain\aspnet 用户。该文件不是只读的。

我尝试通过 System.Security.Permissions.FileIOPermission 查找权限。它只是说禁止访问所有文件。

我不确定我还能做什么。

我在 Framework 3.5、WinXP、IIS 5.1 上使用 Visual Studio 2008、ASP.net 2.0。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T16:29:23.337

ASP.NET 用户将无法使用网络路径。因此，您需要拥有一个拥有所有权限的 Windows 帐户，然后您需要在 web.config 中强加一些东西，如下所示。

```
<identity impersonate="true" userName="domainname\windowuseraccount" password="password"/> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T16:43:26.330

我假设您已正确设置了模拟。您已关闭匿名访问，将身份验证模式设置为 Windows 并将模拟设置为 true 等。

即使所有这些都正确完成并且冒充了正确的帐户，您仍然无法访问该文件。被模拟的帐户正在使用所谓的网络凭据。这些仅在进行模拟的机器上有效。当您尝试访问计算机本身上的文件时，访问是使用用户的凭据执行的，但对于共享上的文件，访问是作为未经身份验证的用户完成的，因此不允许访问。

为了允许您使用用户的凭据进行远程工作，即访问共享、远程数据库的集成安全性等，您需要使用委托而不是模拟。这是一个有点复杂的主题，涉及您的 Active Directory 设置和 IIS 配置。看看[这篇文章](http://msdn.microsoft.com/en-us/library/ms998351.aspx)，它应该给你一个很好的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T16:26:37.337

确保域用户具有安全权限*和*共享权限。也就是说，在共享文件夹上，在属性的“共享”选项卡下以及“安全”选项卡下添加域用户。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T17:08:31.790

您使用的是什么 IIS 版本？如果是版本 6，您可以将 Web 应用程序放在它自己的应用程序池中，然后将该应用程序池的标识设置为域用户帐户。然后，授予该域用户帐户访问网络共享的权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T17:24:16.700

仅供参考，您可以将以下内容放在 aspx 文件中，以验证您的页面运行的标识：

```
<%@ Page Language="C#" %>
<% Response.Write(System.Security.Principal.WindowsIdentity.GetCurrent().Name); %> 
```

To access a network share the above user will need to be a domain account setup by a network administrator.

# javascript - 如何使用 jQuery 选择所有文本区域和文本框？

> ID：825710
> 
> 赞同：57
> 
> 时间：2009-05-05T16:20:45.400
> 
> 标签：javascript, jquery

如何选择所有文本框和文本区域，例如：

```
<input type='text' /> 
```

和

```
<textarea></textarea> 
```

在页面上并有属性`style.width="90%";`应用到他们？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2009-05-05T16:22:28.733

```
$('input[type=text], textarea').css({width: '90%'}); 
```

使用标准 CSS 选择器，jQuery 也有一组用于各种表单元素的伪选择器过滤器，例如：

```
$(':text').css({width: '90%'}); 
```

将匹配所有`<input type="text">`元素。有关更多信息，请参阅[选择器文档](http://docs.jquery.com/Selectors)。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-05T16:59:26.337

密码框也是文本框，所以如果您也需要它们：

```
$("input[type='text'], textarea, input[type='password']").css({width: "90%"}); 
```

虽然文件输入有点不同，但您可能也希望包含它们（例如，为了视觉一致性）：

```
$("input[type='text'], textarea, input[type='password'], input[type='file']").css({width: "90%"}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T16:26:32.890

```
$("**:**input[type=text], :input[type='textarea']").css({width: '90%'}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-08T01:34:20.790

```
names = [];
$('input[name=text], textarea').each(
    function(index){  
        var input = $(this);
        names.push( input.attr('name') );
        //input.attr('id');
    }
); 
```

它选择 DOM 中的所有文本框和文本区域，其中 $.each 函数迭代以提供 ecah 元素的名称。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-18T11:29:20.547

只需使用`$(":input")`

禁用所有输入（文本区域、输入文本等）的示例：

```
$(":input").prop("disabled", true);
```

```
<form>
  <textarea>Tetarea</textarea>
  <input type="text" value="Text">
  <label><input type="checkbox"> Checkbox</label>
</form>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
```

# css - 为什么我的 google map api 不能正确显示气球？

> ID：825711
> 
> 赞同：0
> 
> 时间：2009-05-05T16:20:45.620
> 
> 标签：css, google-maps

这是链接：[www.mchenry.edu/maps/google.asp](http://www.mchenry.edu/maps/google.asp)

为什么位置气球不能正确显示？此外，弹出信息框也很奇怪。它在 CSS 中吗？最后，我收到不少“谷歌服务器拒绝您的 api 密钥”yada yada。我已经换了两次钥匙，运气不好。希望它对你有用。

感谢您提供的任何信息！对这个菜鸟好点。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T16:29:41.667

“records.css”文件中的以下条目导致问题：

```
img {
  background-color:#FFFFFF;
} 
```

# events - GWT：如何抑制超链接以使其不会更改我的历史令牌

> ID：825712
> 
> 赞同：4
> 
> 时间：2009-05-05T16:21:03.340
> 
> 标签：events, gwt, hyperlink, gwt-history

我想让我的超链接像按钮一样（仅响应 Click 事件），但是，当您单击它们时，它们会自动更改历史标记，这会弄乱我的应用程序中的历史记录机制。有没有办法抑制超链接的默认行为，因此它不会更改历史令牌？我尝试将 targetHistoryToken 设置为 null，但它不起作用。

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-01-10T15:38:54.233

改为使用`Anchor`。

正如java doc`Hyperlink`所说：

> 如果您想要一个不与历史系统交互的 HTML 超链接（标签），请改用 Anchor。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T07:10:54.923

就像 rustyshelf 说的，

```
最终 HTML contactLink = new HTML(""
          + 联系人姓名 + "");
contactLink.addClickHandler(new ClickHandler() {
        公共无效 onClick（ClickEvent 事件）{
  ......
 }
}

```

[http://gwt.google.com/samples/Showcase/Showcase.html#CwStackPanel](http://gwt.google.com/samples/Showcase/Showcase.html#CwStackPanel)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-03T16:31:39.760

只需从 Anchor 中删除 href=""。

```
<g:Anchor ui:field="clickField">Click here</g:Anchor> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-06T01:30:59.227

到目前为止，最简单的方法是创建您自己的扩展 Composite 的类，并将 呈现`<a> </a>`为 HTML 小部件。我遇到了同样的问题，这就是我解决它的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-19T20:35:39.763

我创建了这个类

```
import com.google.gwt.user.client.ui.HTML;

public class HyperlinkWithoutHistoryToken extends HTML {
    public HyperlinkWithoutHistoryToken(String html, boolean wordWrap) {
        super("<a href=\"javascript:undefined;\">" + html + "</a>", wordWrap);
    }
    public HyperlinkWithoutHistoryToken(String html) {
    super("<a href=\"javascript:undefined;\">" + html + "</a>");
    }
} 
```

# c# - 如何使用 Linq To XML 获取元素值

> ID：825714
> 
> 赞同：2
> 
> 时间：2009-05-05T16:21:10.050
> 
> 标签：c#, .net, xml, linq, linq-to-xml

使用 Linq To XML，如何从下面的 xml 中获取 space_id 值（720）？

我正在阅读[这篇](http://msdn.microsoft.com/en-us/library/bb308960.aspx)文章，但我认为 xml 中的命名空间是我的绊脚石。

```
<r25:spaces xmlns:r25="http://www.collegenet.com/r25" pubdate="2009-05-05T12:18:18-04:00">
  <r25:space id="VE1QOjRhMDAyZThhXzFfMWRkNGY4MA==" crc="" status="new">
    <r25:space_id>720</r25:space_id>
    <r25:space_name>SPACE_720</r25:space_name>
    <r25:max_capacity>0</r25:max_capacity>
  </r25:space>
</r25:spaces> 
```

## 编辑

这就是我所在的位置：

```
private int GetIDFromXML(string xml)
    {
        XDocument xDoc = XDocument.Parse(xml);

        // hmmm....
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T16:29:36.283

如果你只想要唯一的`space_id`元素，没有查询等：

```
XNamespace ns = "http://www.collegenet.com/r25";
string id = doc.Descendants(ns + "space_id")
               .Single()
               .Value; 
```

（哪里`doc`是`XDocument`- 或`XElement`）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T14:32:53.887

您也可以使用（上面的代码略有变化，我认为它更具可读性）

```
XNamespace ns = "http://www.collegenet.com/r25";
string id = doc.Descendants(ns.GetName("space_id").Single().Value; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-29T21:17:29.277

关于 Jon Skeets 的回答有点冗长......

```
string xml = @"<r25:spaces xmlns:r25=""http://www.collegenet.com/r25"" pubdate=""2009-05-05T12:18:18-04:00"">"
    + @"<r25:space id=""VE1QOjRhMDAyZThhXzFfMWRkNGY4MA=="" crc="""" status=""new"">"
    + @"<r25:space_id>720</r25:space_id>"
    + @"<r25:space_name>SPACE_720</r25:space_name>"
    + @"<r25:max_capacity>0</r25:max_capacity>"
    + @"</r25:space>"
    + @"</r25:spaces>";

XDocument xdoc = XDocument.Parse(xml);
XNamespace ns = "http://www.collegenet.com/r25";

var value = (from z in xdoc.Elements(ns.GetName("spaces"))
             .Elements(ns.GetName("space"))
             .Elements(ns.GetName("space_id")) 
         select z.Value).FirstOrDefault(); 
```

# reflection - 如何在 Groovy 类中“隐藏”元类属性

> ID：825716
> 
> 赞同：5
> 
> 时间：2009-05-05T16:21:50.703
> 
> 标签：reflection, groovy, metaclass

我正在创建一些简单的 groovy 类，例如

```
class Person {
    int age
    String name
} 
```

用于依赖反射提取对象属性的 Java 方法中，例如年龄和名称。问题是 metaClass 也显示为属性。更新 Java 方法以忽略此属性不是一种选择。我尝试将 metaClass 属性设置为 null ，但这不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-05-12T09:18:45.010

如果您使用 Java 和 Groovy 中的这些类，为什么不只在 Java 中创建 POJO 而不是 Groovy。我知道这不能回答您的问题，但很高兴知道为什么决定将 Groovy 用于 POJO

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-18T13:57:33.283

在创建期间为 Groovy 类注入 MetaClass。恕我直言，我认为您不能将其设置为 Null。您调用的 setMetaClass 方法仅将您可能在类上设置的任何自定义元类设置为 Null，而不是在构造期间注入的元类。

# javascript - 如何使用 URL 将变量传递给 JSP 类？

> ID：825717
> 
> 赞同：1
> 
> 时间：2009-05-05T16:21:59.063
> 
> 标签：javascript, jsp

我正在尝试修改某人编写的 JavaScript 代码以将 URL 变量（称为制造商）传递给 Java 类。有趣的是该文件是一个带有 JavaScript 的 HTML 文件。因为我是 JSP 的新手，所以我什至不确定这是否可以完成，但这里是 HTML/JavaScript 代码：

```
<html>
<head>
<script type="text/javascript">
var url = "\QWMASMatch"; // The server-side script

function Table(){
 var currentTime=new Date();
 var ele = document.getElementById('Table'); 
 function handleHttpResponse()
  {
   if (http.readyState == 4) {
      ele.innerHTML = http.responseText;
    }
  }
 var http = getHTTPObject(); // We create the HTTP Object
 var tempUrl = url;
 String manufacturer = request.getParameter("manufacturer");
 if ( manufacturer != null && !manufacturer.equals(""))
 {
 http.open("GET", tempUrl+"?"+"manufacturer="+manufacturer, true);
 http.onreadystatechange = handleHttpResponse;
 http.send(null);
 } else {
 http.open("GET", tempUrl+"?"+"Time="+currentTime, true);
 http.onreadystatechange = handleHttpResponse;
 http.send(null);
 }
}

function getHTTPObject(){
 var xmlhttp;
 /*@cc_on
 @if (@_jscript_version >= 5)
   try {
    xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
   }catch (e){
    try {
     xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
     }catch (E) {
      xmlhttp = false;
      }
  }
  @else
  xmlhttp = false;
  @end @*/
  if (!xmlhttp && typeof XMLHttpRequest != 'undefined') {
    try {
      xmlhttp = new XMLHttpRequest();
    } catch (e) {
      xmlhttp = false;
    }
  }
  return xmlhttp;
 }

</script>
</head>
<body>
<img src='enet.jpg'>
<div class='title'>
QuoteWerks-2-MAS</div>
<div id="Table">Loading . . . </div>
<script type="text/javascript">
Table()</script>
</body>
</html> 
```

我正在尝试传递一个 url 链接

> [http://localhost/QWMASMatch.html?manufacturer=ADOBE](http://localhost/QWMASMatch.html?manufacturer=ADOBE)

并将该值传递回希望由班级拾取的页面。
我添加了细分

```
 String manufacturer = request.getParameter("manufacturer");
 if ( manufacturer != null && !manufacturer.equals(""))
 {
 http.open("GET", tempUrl+"?"+"manufacturer="+manufacturer, true);
 http.onreadystatechange = handleHttpResponse;
 http.send(null);
 } else {
 http.open("GET", tempUrl+"?"+"Time="+currentTime, true);
 http.onreadystatechange = handleHttpResponse;
 http.send(null); 
```

}

...在`Table()`函数中。我对 PHP 比较熟悉，这些文件通常具有 PHP 扩展名，但是在这种情况下，原始文件使用 HTML 将变量传递到 Java`QWMASMatch`类中，只带有 else 子句。有什么想法我可能做错了吗？

当我尝试输入时，脚本似乎仍在解析 else 子句

> [http://localhost/QWMASMatch.html?manufacturer=ADOBE](http://localhost/QWMASMatch.html?manufacturer=ADOBE)

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-05T22:40:44.910

这个值应该有一个正斜杠吗？\QWMASM 匹配

看起来有点像服务器端代码在这里与 JS 混在一起：

```
String manufacturer = request.getParameter("manufacturer"); 
```

也许您打算：

```
var manufacturer = '<% out.println(request.getParameter("manufacturer")); %>'; 
```

...使用 <% %> 告诉 JSP 在服务器上执行包含的代码。

# linux - 网络感知 wx.FileDialog

> ID：825724
> 
> 赞同：1
> 
> 时间：2009-05-05T16:22:53.010
> 
> 标签：linux, ubuntu, wxpython

我在 Xubuntu 8.10 下的 wxPython 2.8.8.0 应用程序中使用 wx.FileDialog。我的问题是这个对话框不是网络感知的，所以我无法浏览 Samba 共享。
我看到这个问题也困扰着其他应用程序（Firefox，Audacious ...）所以我想问我在哪里可以找到有关如何使其工作的信息。
该对话框是否应该已经是网络感知的？我错过了什么吗？也许是某个图书馆？还是我应该编写自己的实现？
非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T07:01:54.783

罗宾·邓恩本人告诉我

> 它使用“本机”GTK 文件对话框，就像其他应用程序一样，因此 wx 对此无能为力。

因此，作为一种解决方法，我最终安装了 gvfs-fuse 并通过 $HOME/.gvfs 浏览网络。虽然有点笨拙，但它可以工作。

# java - 如何最好地将 UNC 文件路径添加到 Java 类路径

> ID：825731
> 
> 赞同：0
> 
> 时间：2009-05-05T16:24:31.397
> 
> 标签：java, classpath, unc

使用 Java (1.4) 是否可以在类路径中使用 Windows UNC 文件位置 (\\servername\filestore\etc)？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T17:11:11.707

基本上你只需要用正斜杠交换反斜杠：

```
java -classpath '//servername/filestore/etc;.' <classname> 
```

# java - 如何实现可以倒带的 OutputStream？

> ID：825732
> 
> 赞同：8
> 
> 时间：2009-05-05T16:24:32.037
> 
> 标签：java, io, outputstream

在将一些处理后的内容写入输出流之后，我需要重新访问流的开头并写出一些内容元数据。我正在写入的数据非常大，高达 4Gb，并且可以直接写入文件或内存缓冲区，具体取决于各种环境因素。

如何实现一个允许我在完成内容写入后写出标题的 OutputStream？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-05T17:15:40.823

这是一个随机访问文件输出流。

请注意，如果将其用于大量流式输出，您可以将其临时包装在 BufferedOutputStream 中以避免大量小写入（请务必在丢弃包装器或直接使用底层流之前刷新它）。

```
import java.io.*;

/**
 * A positionable file output stream.
 * <p>
 * Threading Design : [x] Single Threaded  [ ] Threadsafe  [ ] Immutable  [ ] Isolated
 */

public class RandomFileOutputStream
extends OutputStream
{

// *****************************************************************************
// INSTANCE PROPERTIES
// *****************************************************************************

protected RandomAccessFile              randomFile;                             // the random file to write to
protected boolean                       sync;                                   // whether to synchronize every write

// *****************************************************************************
// INSTANCE CONSTRUCTION/INITIALIZATON/FINALIZATION, OPEN/CLOSE
// *****************************************************************************

public RandomFileOutputStream(String fnm) throws IOException {
    this(fnm,false);
    }

public RandomFileOutputStream(String fnm, boolean syn) throws IOException {
    this(new File(fnm),syn);
    }

public RandomFileOutputStream(File fil) throws IOException {
    this(fil,false);
    }

public RandomFileOutputStream(File fil, boolean syn) throws IOException {
    super();

    File                                par;                                    // parent file

    fil=fil.getAbsoluteFile();
    if((par=fil.getParentFile())!=null) { IoUtil.createDir(par); }
    randomFile=new RandomAccessFile(fil,"rw");
    sync=syn;
    }

// *****************************************************************************
// INSTANCE METHODS - OUTPUT STREAM IMPLEMENTATION
// *****************************************************************************

public void write(int val) throws IOException {
    randomFile.write(val);
    if(sync) { randomFile.getFD().sync(); }
    }

public void write(byte[] val) throws IOException {
    randomFile.write(val);
    if(sync) { randomFile.getFD().sync(); }
    }

public void write(byte[] val, int off, int len) throws IOException {
    randomFile.write(val,off,len);
    if(sync) { randomFile.getFD().sync(); }
    }

public void flush() throws IOException {
    if(sync) { randomFile.getFD().sync(); }
    }

public void close() throws IOException {
    randomFile.close();
    }

// *****************************************************************************
// INSTANCE METHODS - RANDOM ACCESS EXTENSIONS
// *****************************************************************************

public long getFilePointer() throws IOException {
    return randomFile.getFilePointer();
    }

public void setFilePointer(long pos) throws IOException {
    randomFile.seek(pos);
    }

public long getFileSize() throws IOException {
    return randomFile.length();
    }

public void setFileSize(long len) throws IOException {
    randomFile.setLength(len);
    }

public FileDescriptor getFD() throws IOException {
    return randomFile.getFD();
    }

} // END PUBLIC CLASS 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T16:29:41.400

如果您知道标头的大小，您可以先写一个空白标头，然后在最后返回修复它`RandomAccessFile`。如果您不知道标头的大小，那么您有一个基本原则，即文件系统通常不允许您插入数据。所以你需要先写入一个临时文件，然后再写入真正的文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T16:31:54.423

Lucene 似乎有一个实现；并且 api 看起来不错。

```
getFilePointer()
void seek(long pos) 
```

[http://lucene.apache.org/java/1_4_3/api/org/apache/lucene/store/OutputStream.html](http://lucene.apache.org/java/1_4_3/api/org/apache/lucene/store/OutputStream.html)

我猜他们包装了一个[RandomAccessFile](http://java.sun.com/j2se/1.5.0/docs/api/java/io/RandomAccessFile.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T16:32:21.177

一种方法是首先将初始内容写入内存缓冲区，然后将标头写入“真实”输出流，然后刷新缓冲内容，然后再写入非缓冲流。听起来初始段不会那么长，以使缓冲合理。至于实现它，您可以使用 ByteArrayOutputStream 进行缓冲，然后让您的 OutputStream 类将“真实”输出流作为参数；并根据需要在两者之间切换。您可能需要扩展 OutputStream API 以允许定义要写入的元数据，因为这会触发从缓冲模式切换。

正如另一个答案所提到的，RandomAccessFile 也可以工作，尽管不会实现 OutputStream。

# c# - 找不到 System.Windows 程序集

> ID：825743
> 
> 赞同：33
> 
> 时间：2009-05-05T16:26:50.923
> 
> 标签：c#, wpf, silverlight, gac

这是我们得到的错误：

> 错误 1 ​​类型“System.Windows.Point”在未引用的程序集中定义。您必须添加对程序集“System.Windows，Version=2.0.5.0，Culture=neutral，PublicKeyToken=7cec85d7bea7798e”的引用。C:\PacMan\PacMan\PacMan\PacManTests\UnitTest1.cs 65 13 PacManTests

我们在无法找到 System.Windows 程序集的单元测试项目中遇到此错误，但我们的主项目可以找到程序集并正常运行。

是否有人对我们可以在何处或如何引用 System.Windows 来解决此问题有任何意见或建议？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-07-02T11:18:37.787

就我而言，没有可供选择的 System.Windows 参考。
我必须包含对**WindowsBase的引用**

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-05T16:30:56.857

添加程序集引用，就像添加任何其他框架程序集引用一样：

*   右键单击项目
*   选择“添加参考”
*   选择左侧的 .NET 选项卡，在程序集列表中找到“System.Windows”
*   双击“System.Windows”，将添加程序集引用

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-07-01T17:59:23.457

添加`System.Windows`程序集引用：

*   右键单击项目
*   选择“添加参考”
*   选择左侧的 .NET 选项卡，在程序集列表中找到“System.Windows”
*   双击“System.Windows”添加它

如果这不能解决问题，请尝试添加`PresentationFramework`和`PresentationCore`程序`WindowsBase`集 ( `.NET 3.5`)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-05T16:46:30.080

我们发现我们必须进入 Silverlight 文件夹并找到 System.Windows.dll，现在一切都很好，感谢您的帮助！

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-01-28T00:10:45.547

我曾经在一台装有 VS 2010 的机器上发生过这种情况。由于某种原因，在“**添加引用**”窗口的**.NET 选项卡**中找不到*System.Windows程序集。*很奇怪。

 ****在这种情况下，您只需转到“**浏览”选项卡**并导航到：

> C:\Windows\Microsoft.NET\assembly\GAC_MSIL\System.Windows\

在那里，选择正确的版本子文件夹（应该看起来像... `v4.0_4.0.0.0__b03f5f7f11d50a3a`），然后在那里选择 System.Windows.dll。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-05T16:30:12.150

右键单击“参考”文件夹并单击“添加参考”，然后在 .NET 选项卡下选择 System.Windows。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-02-09T14:09:24.530

我在中找到了所需的**WindowsBase.dll**

> C:\Program Files\Reference Assemblies\Microsoft\Framework\v3.0

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-08-22T18:37:16.230

好吧，它实际上是我的 wpf 应用程序中的 system.windows.presentation ......

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-11-19T09:41:47.450

如果您使用的是 .NET Framework 2.0，请参考

> System.Windows.Forms

（并使用具有相同名称的命名空间）也可以完成这项工作

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-02-24T20:24:53.083

如果您的 .NET 引用中没有 System.Windows，请尝试 WindowsBase。这修复了我在 VS 2008 中对 System.Windows.Point 的引用。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-11-02T14:09:27.843

在您的测试项目中添加与您正在测试的项目中的引用相同的引用。

我得到了这样的东西并补充说：

PresentationCore PresentationFramework WindowsBase

现在它似乎保持安静。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-09-02T10:09:56.433

我遇到了同样的问题，但是这是因为我们使用的是可移植类库并且只发生在某些 PC 安装上。

我发现通过以下方式解决这些安装的问题：

[http://www.microsoft.com/en-us/download/details.aspx?id=3556](http://www.microsoft.com/en-us/download/details.aspx?id=3556)

由于此修复程序包含在 VS2010 和 Windows 更新中，因此它只会出现在某些 PC 上。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-05-05T16:31:08.807

您必须添加对项目的引用。如果您使用的是 Visual Studio，请右键单击解决方案资源管理器中的项目，然后选择添加引用...

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-06-27T15:19:26.680

[如果您使用Portable Library Tools](http://visualstudiogallery.msdn.microsoft.com/b0e0b5e9-e138-410b-ad10-00cb3caf4981/) ，您也会遇到此错误，因为它不受支持。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-02-14T12:36:18.390

尝试添加 PresentationCore.dll 之后您可以使用 System.Windows 命名空间

# ruby - 如何将命令行参数传递给 rake 任务

> ID：825748
> 
> 赞同：1168
> 
> 时间：2009-05-05T16:27:50.517
> 
> 标签：ruby, command-line, rake, command-line-arguments

我有一个需要将值插入多个数据库的 rake 任务。

我想将此值从命令行或*另一个*rake 任务传递给 rake 任务。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1159
> 
> 时间：2009-05-05T16:45:25.480

您可以通过在任务调用中添加符号参数来指定 rake 中的正式参数。例如：

```
require 'rake'

task :my_task, [:arg1, :arg2] do |t, args|
  puts "Args were: #{args} of class #{args.class}"
  puts "arg1 was: '#{args[:arg1]}' of class #{args[:arg1].class}"
  puts "arg2 was: '#{args[:arg2]}' of class #{args[:arg2].class}"
end

task :invoke_my_task do
  Rake.application.invoke_task("my_task[1, 2]")
end

# or if you prefer this syntax...
task :invoke_my_task_2 do
  Rake::Task[:my_task].invoke(3, 4)
end

# a task with prerequisites passes its 
# arguments to it prerequisites
task :with_prerequisite, [:arg1, :arg2] => :my_task #<- name of prerequisite task

# to specify default values, 
# we take advantage of args being a Rake::TaskArguments object
task :with_defaults, :arg1, :arg2 do |t, args|
  args.with_defaults(:arg1 => :default_1, :arg2 => :default_2)
  puts "Args with defaults were: #{args}"
end 
```

然后，从命令行：

```
> 耙 my_task[1,false]
Args 是：Rake::TaskArguments 类的 {:arg1=>"1", :arg2=>"false"}
arg1 是：String 类的“1”
arg2 是：String 类的“假”

> 耙 "my_task[1, 2]"
参数为：{:arg1=>"1", :arg2=>"2"}

> 耙invoke_my_task
参数为：{:arg1=>"1", :arg2=>"2"}

> 耙invoke_my_task_2
参数为：{:arg1=>3, :arg2=>4}

> 用_prerequisite[5,6] 耙
参数为：{:arg1=>"5", :arg2=>"6"}

> 用_defaults 耙
默认参数为：{:arg1=>:default_1, :arg2=>:default_2}

> 用_defaults['x','y'] 耙
默认参数为：{:arg1=>"x", :arg2=>"y"}

```

如第二个示例所示，如果要使用空格，则需要在目标名称周围加上引号，以防止 shell 拆分空格处的参数。

**查看rake.rb**中的代码，rake 似乎没有解析任务字符串来提取先决条件的参数，所以你不能这样做`task :t1 => "dep[1,2]"`。为先决条件指定不同参数的唯一方法是在依赖任务操作中显式调用它，如`:invoke_my_task`和`:invoke_my_task_2`。

请注意，某些 shell（如 zsh）要求您转义括号：`rake my_task\['arg1'\]`

* * *

## 回答 #2

> 赞同：438
> 
> 时间：2015-04-07T21:56:36.850

选项和依赖项需要在数组中：

```
namespace :thing do
  desc "it does a thing"
  task :work, [:option, :foo, :bar] do |task, args|
    puts "work", args
  end

  task :another, [:option, :foo, :bar] do |task, args|
    puts "another #{args}"
    Rake::Task["thing:work"].invoke(args[:option], args[:foo], args[:bar])
    # or splat the args
    # Rake::Task["thing:work"].invoke(*args)
  end

end 
```

然后

```
rake thing:work[1,2,3]
=> work: {:option=>"1", :foo=>"2", :bar=>"3"}

rake thing:another[1,2,3]
=> another {:option=>"1", :foo=>"2", :bar=>"3"}
=> work: {:option=>"1", :foo=>"2", :bar=>"3"} 
```

> 注意：变量`task`是任务对象，除非您了解/关心 Rake 内部，否则它不是很有帮助。

**导轨注意：**

> 如果从 Rails 运行任务，最好通过添加`=> [:environment]`which 来预加载环境，这是一种设置*相关*任务的方法。

```
 task :work, [:option, :foo, :bar] => [:environment] do |task, args|
    puts "work", args
  end 
```

* * *

## 回答 #3

> 赞同：367
> 
> 时间：2011-02-19T11:05:41.060

除了 kch 的回答（我没有找到如何对此发表评论，抱歉）：

您不必在命令`ENV`之前将变量指定为变量`rake`。您可以将它们设置为通常的命令行参数，如下所示：

```
rake mytask var=foo 
```

并从您的 rake 文件中访问这些作为 ENV 变量，如下所示：

```
p ENV['var'] # => "foo" 
```

* * *

## 回答 #4

> 赞同：117
> 
> 时间：2013-10-19T13:09:57.043

如果你想传递命名参数（例如使用标准`OptionParser`），你可以使用这样的东西：

```
$ rake user:create -- --user test@example.com --pass 123 
```

注意`--`，这是绕过标准 Rake 参数所必需的。应该与 Rake **0.9.x**，**<= 10.3.x**一起使用。

较新的 Rake 已更改其对 的解析`--`，现在您必须确保它没有传递给`OptionParser#parse`方法，例如使用`parser.parse!(ARGV[2..-1])`

```
require 'rake'
require 'optparse'
# Rake task for creating an account

namespace :user do |args|
  desc 'Creates user account with given credentials: rake user:create'
  # environment is required to have access to Rails models
  task :create do
    options = {}
    OptionParser.new(args) do |opts|
      opts.banner = "Usage: rake user:create [options]"
      opts.on("-u", "--user {username}","User's email address", String) do |user|
        options[:user] = user
      end
      opts.on("-p", "--pass {password}","User's password", String) do |pass|
        options[:pass] = pass
      end
    end.parse!

    puts "creating user account..."
    u = Hash.new
    u[:email] = options[:user]
    u[:password] = options[:pass]
    # with some DB layer like ActiveRecord:
    # user = User.new(u); user.save!
    puts "user: " + u.to_s
    puts "account created."
    exit 0
  end
end 
```

`exit`最后将确保额外的参数不会被解释为 Rake 任务。

参数的快捷方式也应该起作用：

```
 rake user:create -- -u test@example.com -p 123 
```

当 rake 脚本看起来像这样时，也许是时候寻找另一个工具来允许它开箱即用了。

* * *

## 回答 #5

> 赞同：58
> 
> 时间：2009-05-05T16:51:45.543

我从这两个网站找到了答案：[Net Maniac](http://nhw.pl/wp/2008/10/11/rake-and-arguments-for-tasks)和[Aimred](http://www.aimred.com/news/developers/2008/10/16/arguments-for-rake/)。

您需要 rake 版本 > 0.8 才能使用此技术

正常的 rake 任务描述是这样的：

```
desc 'Task Description'
task :task_name => [:depends_on_taskA, :depends_on_taskB] do
  #interesting things
end 
```

要传递参数，请做三件事：

1.  在任务名称后添加参数名称，以逗号分隔。
2.  使用 :needs => [...] 将依赖项放在最后
3.  位置 |t, args| 做完之后。（t 是这个任务的对象）

要访问脚本中的参数，请使用 args.arg_name

```
desc 'Takes arguments task'
task :task_name, :display_value, :display_times, :needs => [:depends_on_taskA, :depends_on_taskB] do |t, args|
  args.display_times.to_i.times do
    puts args.display_value
  end
end 
```

要从命令行调用此任务，请将 []s 中的参数传递给它

```
rake task_name['Hello',4] 
```

将输出

```
Hello
Hello
Hello
Hello 
```

如果你想从另一个任务调用这个任务，并传递参数，使用调用

```
task :caller do
  puts 'In Caller'
  Rake::Task[:task_name].invoke('hi',2)
end 
```

然后命令

```
rake caller 
```

将输出

```
In Caller
hi
hi 
```

我还没有找到将参数作为依赖项的一部分传递的方法，因为以下代码会中断：

```
task :caller => :task_name['hi',2]' do
   puts 'In Caller'
end 
```

* * *

## 回答 #6

> 赞同：33
> 
> 时间：2014-11-29T19:38:18.303

在我解决这个问题之前，我无法弄清楚如何传递 args 和 :environment：

```
namespace :db do
  desc 'Export product data'
  task :export, [:file_token, :file_path] => :environment do |t, args|
    args.with_defaults(:file_token => "products", :file_path => "./lib/data/")

       #do stuff [...]

  end
end 
```

然后我这样打电话：

```
rake db:export['foo, /tmp/'] 
```

* * *

## 回答 #7

> 赞同：32
> 
> 时间：2011-02-28T20:06:33.597

实际上@Nick Desjardins 回答得很完美。但仅用于教育：您可以使用肮脏的方法：使用`ENV`参数

```
task :my_task do
  myvar = ENV['myvar']
  puts "myvar: #{myvar}"
end 

rake my_task myvar=10
#=> myvar: 10 
```

* * *

## 回答 #8

> 赞同：29
> 
> 时间：2009-05-05T16:53:13.107

另一个常用的选项是传递环境变量。在您的代码中，您可以通过 阅读它们，并且可以在命令`ENV['VAR']`之前传递它们，例如`rake`

```
$ VAR=foo rake mytask 
```

* * *

## 回答 #9

> 赞同：24
> 
> 时间：2012-10-16T07:36:27.603

```
desc 'an updated version'
task :task_name, [:arg1, :arg2] => [:dependency1, :dependency2] do |t, args|
    puts args[:arg1]
end 
```

* * *

## 回答 #10

> 赞同：22
> 
> 时间：2016-04-29T03:29:33.750

我只是想能够运行：

```
$ rake some:task arg1 arg2 
```

很简单，对吧？（没有！）

Rake 将`arg1`and解释`arg2`为任务，并尝试运行它们。所以我们只是在它发生之前中止。

```
namespace :some do
  task task: :environment do
    arg1, arg2 = ARGV

    # your task...

    exit
  end
end 
```

拿那个，括号！

**免责声明**：我希望能够在一个非常小的宠物项目中做到这一点。不适合“现实世界”使用，因为您失去了链接 rake 任务的能力（即`rake task1 task2 task3`）。海事组织不值得。只用丑陋的`rake task[arg1,arg2]`。

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2012-12-29T02:48:52.867

我在 rake 文件中使用了一个常规的 ruby​​ 参数：

```
DB = ARGV[1] 
```

然后我将文件底部的 rake 任务存根（因为 rake 将根据该参数名称查找任务）。

```
task :database_name1
task :database_name2 
```

命令行：

```
rake mytask db_name 
```

这对我来说比 var=foo ENV var 和任务 args[blah, blah2] 解决方案更干净。
存根有点笨拙，但如果您只有几个一次性设置的环境，那还不错

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2014-04-24T14:23:15.857

上述答案中传递参数的方法是正确的。但是，要使用参数运行 rake 任务，新版本的 rails 涉及到一个小的技术性

它将与 rake "namespace:taskname['argument1']" 一起使用

请注意从命令行运行任务时的倒引号。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-10-20T19:03:37.573

要将参数传递给默认任务，您可以执行以下操作。例如，说“版本”是您的论点：

```
task :default, [:version] => [:build]

task :build, :version do |t,args|
  version = args[:version]
  puts version ? "version is #{version}" : "no version passed"
end 
```

然后你可以这样称呼它：

```
$ rake
no version passed 
```

或者

```
$ rake default[3.2.1]
version is 3.2.1 
```

或者

```
$ rake build[3.2.1]
version is 3.2.1 
```

但是，我还没有找到一种方法来避免在传递参数时指定任务名称（默认或构建）。很想听听是否有人知道方法。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2014-02-16T22:05:07.223

我喜欢参数传递的“查询字符串”语法，特别是当有很多参数要传递时。

例子：

```
rake "mytask[width=10&height=20]" 
```

“查询字符串”是：

```
width=10&height=20 
```

**警告：**注意语法是`rake "mytask[foo=bar]"`而**不是** `rake mytask["foo=bar"]`

在 rake 任务中使用 解析时`Rack::Utils.parse_nested_query`，我们得到`Hash`：

```
=> {"width"=>"10", "height"=>"20"} 
```

（很酷的是你可以传递哈希和数组，更多内容如下）

这是如何实现这一点：

```
require 'rack/utils'

task :mytask, :args_expr do |t,args|
  args.with_defaults(:args_expr => "width=10&height=10")
  options = Rack::Utils.parse_nested_query(args[:args_expr])
end 
```

这是我在我的延迟作业活动记录线程gem中与Rails一起使用的一个更扩展的[示例](https://github.com/zxiest/delayed_job_active_record_threaded)：

```
bundle exec rake "dj:start[ebooks[workers_number]=16&ebooks[worker_timeout]=60&albums[workers_number]=32&albums[worker_timeout]=120]" 
```

以与上面相同的方式解析，具有环境依赖项（为了加载 Rails 环境）

```
namespace :dj do
  task :start, [ :args_expr ] => :environment do |t, args|
    # defaults here...
    options = Rack::Utils.parse_nested_query(args[:args_expr])  
  end
end 
```

给出以下内容`options`

```
=> {"ebooks"=>{"workers_number"=>"16", "worker_timeout"=>"60"}, "albums"=>{"workers_number"=>"32", "worker_timeout"=>"120"}} 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2015-02-03T01:15:17.420

上面描述的大多数方法对我都不起作用，也许它们在较新的版本中已被弃用。最新指南可以在这里找到：http: [//guides.rubyonrails.org/command_line.html#custom-rake-tasks](http://guides.rubyonrails.org/command_line.html#custom-rake-tasks)

指南中的复制和粘贴答案在这里：

```
task :task_name, [:arg_1] => [:pre_1, :pre_2] do |t, args|
  # You can use args from here
end 
```

像这样调用它

```
bin/rake "task_name[value 1]" # entire argument string should be quoted 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2017-05-12T01:05:57.930

如果您不想记住参数位置是什么，并且您想做一些类似 ruby​​ 参数散列的事情。您可以使用一个参数传入一个字符串，然后将该字符串正则表达式转换为选项哈希。

```
namespace :dummy_data do
  desc "Tests options hash like arguments"
  task :test, [:options] => :environment do |t, args|
    arg_options = args[:options] || '' # nil catch incase no options are provided
    two_d_array = arg_options.scan(/\W*(\w*): (\w*)\W*/)
    puts two_d_array.to_s + ' # options are regexed into a 2d array'
    string_key_hash = two_d_array.to_h
    puts string_key_hash.to_s + ' # options are in a hash with keys as strings'
    options = two_d_array.map {|p| [p[0].to_sym, p[1]]}.to_h
    puts options.to_s + ' # options are in a hash with symbols'
    default_options = {users: '50', friends: '25', colour: 'red', name: 'tom'}
    options = default_options.merge(options)
    puts options.to_s + ' # default option values are merged into options'
  end
end 
```

在命令行上你得到。

```
$ rake dummy_data:test["users: 100 friends: 50 colour: red"]
[["users", "100"], ["friends", "50"], ["colour", "red"]] # options are regexed into a 2d array
{"users"=>"100", "friends"=>"50", "colour"=>"red"} # options are in a hash with keys as strings
{:users=>"100", :friends=>"50", :colour=>"red"} # options are in a hash with symbols
{:users=>"100", :friends=>"50", :colour=>"red", :name=>"tom"} # default option values are merged into options 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2019-02-13T06:40:14.250

要使用传统的参数样式运行 rake 任务：

```
rake task arg1 arg2 
```

然后使用：

```
task :task do |_, args|
  puts "This is argument 1: #{args.first}"
end 
```

添加以下 rake gem 补丁：

```
Rake::Application.class_eval do

  alias origin_top_level top_level

  def top_level
    @top_level_tasks = [top_level_tasks.join(' ')]
    origin_top_level
  end

  def parse_task_string(string) # :nodoc:
    parts = string.split ' '
    return parts.shift, parts
  end

end

Rake::Task.class_eval do

  def invoke(*args)
    invoke_with_call_chain(args, Rake::InvocationChain::EMPTY)
  end

end 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2020-11-07T21:37:46.330

我在这里看不到的一件事是[如何处理任意参数](https://blog.stevenocchipinti.com/2013/10/18/rake-task-with-an-arbitrary-number-of-arguments/)。如果您传递任务定义中未列出的参数，它们仍然可以在以下位置访问`args.extras`：

```
task :thing, [:foo] do |task, args|
  puts args[:foo]     # named argument
  puts args.extras    # any additional arguments that were passed
end 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2022-02-14T11:52:18.133

```
namespace :namespace1 do
  task :task1, [:arg1, :arg2, :arg3] => :environment do |_t, args|
    p args[:arg1]
  end
end 
```

打电话

`rake namespace1:task1["1","2","3"]`

调用时无需提供环境

在 zsh 中需要将调用括在引号中

`'rake namespace1:task1["1","2","3"]'`

谢谢

* * *

## 回答 #20

> 赞同：-5
> 
> 时间：2014-02-27T13:52:06.427

在传递参数时，更好的选择是输入文件，可以是 excel 或 json 或任何您需要的文件，并从那里读取您需要的数据结构和变量，包括需要的变量名。读取一个文件可以有如下结构。

```
 namespace :name_sapace_task do
    desc "Description task...."
      task :name_task  => :environment do
        data =  ActiveSupport::JSON.decode(File.read(Rails.root+"public/file.json")) if defined?(data)
    # and work whit yoour data, example is data["user_id"]

    end
  end 
```

# 示例 json

```
{
  "name_task": "I'm a task",
  "user_id": 389,
  "users_assigned": [389,672,524],
  "task_id": 3
} 
```

# 执行

```
rake :name_task 
```

# build - 如何设置自动化机制来查找构建中断？

> ID：825757
> 
> 赞同：0
> 
> 时间：2009-05-05T16:29:43.100
> 
> 标签：build, build-automation

在一个多人处理同一个文件或同一个解决方案的不同文件的团队中，发生构建中断是很自然的。但是如何有一个自动化机制来找到构建中断？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T16:31:56.560

我认为你应该看看[持续集成](http://en.wikipedia.org/wiki/Continuous_Integration)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T16:32:10.100

您必须在自动化和定期的基础上进行构建。看看构建自动化工具。这在一定程度上取决于您使用的技术，对我们来说[Hudson](http://hudson-ci.org/)很好（持续集成也是搜索的关键词）。您可以每晚触发构建，甚至可以触发存储库中的每个变更集。这应该会给你关于损坏构建的即时反馈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T16:37:25.877

查看[CI Factory](http://cifactory.org/joomla/)以设置 CruiseControl.NET 服务器。然后让每个人都安装[CCTray](http://confluence.public.thoughtworks.org/display/CCNET/CCTray)，你们都可以收到自动构建的通知并查看当前状态。

# regex - vim 正则表达式搜索 csv 字符串并粘贴匹配项

> ID：825764
> 
> 赞同：2
> 
> 时间：2009-05-05T16:30:41.163
> 
> 标签：regex, vim

### 编辑：

我需要有关在 vim 中使用正则表达式搜索并提取发现的任何匹配项的最佳方法的建议。

* * *

我有一个看起来像这样的 csv 文件：

两个字段：

*   *ID*

*   *描述*

* * *

**0g98932**，*“长描述有时包含像 1234567 或 0000012345 甚至 BR00012345 这样的数字，但总是包含文本”*

我需要搜索每一行的描述字段。**如果第二个字段中存在与\d{10}**匹配的数字，我想将其拉出。

做类似的事情`:% s/(\d{10})/^$1/g`给了我一个

> 找不到模式 (\d{10}) 错误。

我从来没有学会如何从 vim 中的正则表达式搜索中获取和引用匹配项 - 所以这是问题的一部分。

另一部分：

我真的很想。

1.  删除除前 7 位**id**和匹配项以外的所有内容。
2.  将**id**和匹配项复制到另一个文件 - 或当前文件的顶部（某处 - 任何地方，只是为了将匹配项与未过滤的数据分开）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T21:28:15.363

关于 vim 正则表达式的重要知识是需要转义不同的级别（与 Perl 或 Ruby 中的正则表达式相反）

从`:help /\m`

```
after:    \v     \m       \M        \V    matches
                 'magic'  'nomagic'
          $      $        $         \$    matches end-of-line
          .      .        \.        \.    matches any character
          *      *        \*        \*    any number of the previous atom
          ()     \(\)     \(\)      \(\)  grouping into an atom
          |      \|       \|        \|    separating alternatives
          \a     \a       \a        \a    alphabetic character
          \\     \\       \\        \\    literal backslash
          \.     \.       .         .     literal dot
          \{     {        {         {     literal '{'
          a      a        a         a     literal 'a' 
```

默认设置是“魔术”，因此要使您提供的正则表达式起作用，您必须使用：

```
:%s/".*\(\d\{10}\).*"/\1/ 
```

如果您想删除除前 7 位 id 和匹配项以外的所有内容（我假设您的意思是要删除没有任何匹配项的行）

```
:v/^\([[:alnum:]]\{7}\),\s*".*\(\d\{10}\).*/d
:%s//\1,\2/ 
```

该`:v/<pattern>/`命令允许您在与给定模式不匹配的每一行上运行一个命令，因此这只会删除不匹配的内容。 `:s//`重用先前的模式，因此我们不必指定它。

这将转换以下内容：

```
0g98932,"long description sometimes containing numbers like 0123456789"
0g98932,"long description no numbers"
0g98932,"long description no numbers"
0g98932,"long description sometimes containing numbers like 0123456789"
0g98932,"long description no numbers"
0g98932,"long description no numbers"
0g98932,"long description no numbers"
0g98932,"long description no numbers"
0g98932,"long description sometimes containing numbers like 0123456789"
0g98932,"long description no numbers"
0g98932,"long description no numbers"
0g98932,"long description sometimes containing numbers like 0123456789" 
```

进入这个：

```
0g98932,0123456789
0g98932,0123456789
0g98932,0123456789
0g98932,0123456789 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T16:42:29.687

要抢比赛，您必须使用

```
\(pattern\) 
```

删除使用

```
:%s/not_pattern\(pattern\)another_not_pattern/\1/ 
```

# css - 黑莓是否为 iPhone UIKit 等自定义 Web 应用程序提供 CSS 库？

> ID：825766
> 
> 赞同：2
> 
> 时间：2009-05-05T16:31:07.387
> 
> 标签：css, web-applications, blackberry

有谁知道黑莓是否提供了一套标准的CSS来在黑莓浏览器上创建网络应用程序？我猜黑莓相当于 iPhone 提供的让 iPhone 网络应用看起来为 iPhone 定制的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T11:04:07.517

我不知道，但在 RIM 的网站上有一些关于黑莓浏览器的文档，[http://na.blackberry.com/eng/support/docs/subcategories/?userType=21&category= BlackBerry+Browser](http://na.blackberry.com/eng/support/docs/subcategories/?userType=21&category=BlackBerry+Browser)

您还可以查看他们为 Blackberry 提供的关于 CSS 的 PDF，[http://na.blackberry.com/eng/deliverables/5683/CSS_Reference.pdf](http://na.blackberry.com/eng/deliverables/5683/CSS_Reference.pdf)

在为黑莓浏览器开发时，他们有一个关于设计指南的 PDF，这可能很方便，[http://na.blackberry.com/eng/deliverables/4305/BlackBerry_Browser-4.6.0-US.pdf](http://na.blackberry.com/eng/deliverables/4305/BlackBerry_Browser-4.6.0-US.pdf)

# java - 用 sql 连接秋千

> ID：825772
> 
> 赞同：1
> 
> 时间：2009-05-05T16:31:49.617
> 
> 标签：java, sql, database, swing

我想学习使用 swings(java) 的 sql 连接性，任何人都可以为我的目的提出一个好的资源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-01-31T15:06:37.417

这个链接有你的问题的确切解决方案。

[Java Swings 和 Mysql 中的简单登录应用](http://praveenmax.wordpress.com/2011/01/21/simple-login-application-in-java-using-swings/) 程序 用于登录验证的 Swing 应用程序。您需要从站点[http://dev.mysql.com/downloads/connector/j](http://dev.mysql.com/downloads/connector/j/)下载“MySql Connector for Java”（又名 JConnector） /下载后，将 mysql_connector.jar 文件放在您的项目文件夹中。更好地使用某些 IDE，例如 Eclipse 或其他 .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T16:36:35.470

我认为您想了解如何将 MVC 与 Swing 一起使用，其中 Swing 是您的视图，并且您的控制器通过 JDBC 或像 Hibernate 之类的 ORM 中介处理将数据输入和输出数据库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T16:38:03.050

我假设您想将 MySQL 与 Java 连接起来。为此，您将需要 MySQL java 连接器

[Link 1](http://dev.mysql.com/usingmysql/java/) [Link 2](http://www.java2s.com/Code/Jar/JDBC-Drivers/Downloadmysqlconnectorjava513rcbinjar.htm) [一个完整的教程，但是很长:)](http://www.developer.com/java/data/article.php/3417381)

请添加更多信息。所以我们可以为您提供更多帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T20:40:02.330

尝试使用**NetBeans IDE**。在 java 模板中，有一个应用程序生成一个访问数据库的简单 Swing 界面。**它使用JPA**实现了良好的实践。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-21T19:13:34.963

我能给你的最好的链接是

[https://drive.google.com/open?id=0B36ZqeHukmpeZWZLRUhxb1FJclU](https://drive.google.com/open?id=0B36ZqeHukmpeZWZLRUhxb1FJclU)。这个ppt帮助我将swings与sql联系起来。

我写了一个代码，将sql与swings连接起来。还有注册详细信息功能，告诉您如何使用 sql 和 swing。

```
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Enumeration;

import javax.swing.AbstractButton;
import javax.swing.JOptionPane;
public class Database {
    static String JDBC_DRIVER,DB_URL;
    String USER,PASS;
    Connection conn;
    Statement stmt;

    public Database()
    {
           // JDBC driver name and database URL
        JDBC_DRIVER = "com.mysql.jdbc.Driver";
        DB_URL = "jdbc:mysql://localhost:3306";
        USER = "root";
        PASS = "anshtiger";
        conn = null;
        stmt = null;
        ResultSet rs=null;
        ResultSet rs1=null;
        try{
              //STEP 2: Register JDBC driver
              Class.forName("com.mysql.jdbc.Driver");

              //STEP 3: Open a connection
              System.out.println("Connecting to database...");

              conn = DriverManager.getConnection(DB_URL,USER,PASS);
            //STEP 4: Execute a query
              System.out.println("Creating statement...");
              stmt = conn.createStatement();
              String sq;
              sq = "create  database if not exists AIRLINE";
                stmt.execute(sq);
                System.out.println("Creating statement...");
                String sql="use AIRLINE";
                stmt.execute(sql);

           }catch(SQLException se1){                      //Handle errors for JDBC
              se1.printStackTrace();
           }catch(Exception e){                            //Handle errors for Class.forName
              e.printStackTrace();
              }

    }

   public void signupdetail(String userid, String pass2, String question, String answer, String fname, String lname,
            String gender, String string, String martial, String email,
            String mobileno, String nationality, String address, String city, String state, String country, String pincode){
   {
   try{

        String sq1 = "create table if not exists customerdetail(userid varchar(20) unique, primary key(userid),password varchar(20),question varchar(100),answer varchar(30),fname varchar(20),lname varchar(20),gender varchar(10) ,dob varchar(20),martialstatus varchar(10),emailid varchar(30),mobileno varchar(10),nationality varchar(15),address varchar(50),city varchar(15),state varchar(20),country varchar(20),pincode varchar(8))";
        stmt.execute(sq1);
        System.out.println("Creating statement...");

        String sql2="insert into customerdetail values('"+userid+"','"+pass2+"','"+question+"','"+answer+"','"+fname+"','"+lname+"','"+gender+"','"+string+"','"+martial+"','"+email+"','"+mobileno+"','"+nationality+"','"+address+"','"+city+"','"+state+"','"+country+"','"+pincode+"')";
        stmt.executeUpdate(sql2);

      stmt.close();
      conn.close();
   }catch(SQLException se1){                      //Handle errors for JDBC
      se1.printStackTrace();
   }catch(Exception e){                            //Handle errors for Class.forName
      e.printStackTrace();}
     finally{ //finally block used to close resources
      try{
         if(stmt!=null)
            stmt.close();
      }catch(SQLException se2){
      }// nothing we can do
      try{
         if(conn!=null)
            conn.close();
      }catch(SQLException se3){
         se3.printStackTrace();
      }//end finally 
     }
   }
} 
```

# .net - Visual Studio 数据生成计划架构更新

> ID：825783
> 
> 赞同：1
> 
> 时间：2009-05-05T16:33:48.053
> 
> 标签：.net, sql-server, visual-studio, teamsystem

我是 Visual Studio 中数据生成计划的新手，但我用谷歌搜索了一下，找不到这个问题的答案。我已经根据数据生成计划生成的数据在数据库端修改了我的架构（更改了 NVARCHAR 字段的大小）（由于字段太大而导致程序中断），现在我想生成基于新模式的新数据。

**有什么方法可以从数据库中重新导入架构或使其始终处于活动状态和连接状态？**

我知道我可以在生成计划中切换字段大小，但这是一个简单的案例，稍后会更复杂。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T20:22:07.547

使用模式比较（文件菜单：数据 > 模式比较 > 新模式比较）来同步项目和数据库模式。之后，如果您打开数据生成计划，它应该会要求您刷新它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-08T03:31:15.490

如果架构发生变化，IDE 不会强制您更新数据生成计划吗？

[从 MSDN](http://msdn.microsoft.com/en-us/library/aa833256(VS.80).aspx)：

> 在数据库项目中创建数据生成计划时，该计划基于项目的数据库模式。如果您创建了数据生成计划，然后数据库项目的架构发生更改，则会提示您更新该计划。在以下情况下会出现此行为：
> 
> *   您在还没有架构的数据库项目中创建数据生成计划。然后将模式导入数据库项目。
> *   您在具有架构的数据库项目中创建数据生成计划，然后架构发生更改。
> 
> 在这两种情况下，当您打开数据生成计划或当它成为活动文档时，系统都会提示您更新数据生成计划。如果您不根据架构更改更新数据生成计划，您将无法继续编辑该计划。您可以关闭并重新打开数据生成计划以再次显示提示。

有关此主题[的博客](http://blogs.msdn.com/gertd/archive/2008/02/14/data-generation-wizard.aspx)的更多证据：

> ...数据库中对象的模式必须与数据库项目中的表相匹配。

我想您可以深入研究 *.dgen 文件并执行预构建步骤（或类似的步骤），以确保它始终与您的数据库模式匹配。也许这会使事情足够自动化。

# c# - MVVM 模式，ViewModel DataContext 问题

> ID：825784
> 
> 赞同：8
> 
> 时间：2009-05-05T16:34:02.577
> 
> 标签：c#, wpf, mvvm, viewmodel, datacontext

我需要弄清楚如何在 ViewModel 之间进行通信。我是 MVVM 的新手，所以请善待。

这是一个愚蠢的例子

类定义（假设我已经在 ParentViewModel 中挂钩 Child.PropertyChanged 事件）：

```
public class ParentViewModel : ViewModelBase
{
    public ChildViewModel Child { get; set; }
}

public class ChildViewModel : ViewModelBase
{
    String _FirstName;
    public String FirstName 
    {
        get { return _FirstName; }
        set
        {
            _FirstName = value;
            OnPropertyChanged("FirstName");
        }
    }
} 
```

这是您在资源字典中看到的内容

```
<DataTemplate DataType="{x:Type vm:ParentViewModel}">
    <vw:ParentView/>
</DataTemplate>

<DataTemplate DataType="{x:Type vm:ChildViewModel}">
    <vw:ChildView/>
</DataTemplate> 
```

和 ChildView 的代码隐藏：

```
public partial class ChildView : UserControl
{
    public QueueView()
    {
        InitializeComponent();
        DataContext = new ChildViewModel();
    }
} 
```

明显的问题是，当 ChildView 被实例化（通过从 DataTemplate 中选择）时，它会创建一个新的 ChildViewModel 类，而 ParentViewModel 无权访问它。

那么如何将 View 的 DataContext 实例化为导致 DataTemplate 被选中的原始 ViewModel 呢？

一个明显的解决方法是将 ChildViewModel 中的属性合并到 ParentViewModel 中，但我宁愿将它分开，因为以便重用。

我敢肯定答案是微不足道的，我只是想知道它是什么。:)

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-05T16:42:51.383

您应该简单地删除该行：

```
DataContext = new ChildViewModel(); 
```

视图的`DataContext`将由 WPF 自动设置。`DataTemplates`始终将其数据上下文设置为模板的数据（在本例中为 ViewModel）：

```
<DataTemplate DataType="{x:Type vm:ChildViewModel}">
    <vw:ChildView/>
</DataTemplate> 
```

最终结果是您可以单独构建视图模型对象（父类和子类），然后通过简单地将它们插入内容控件来显示它们。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-06T16:04:32.747

使用 MVVM 方法在 ViewModel 之间进行通信的最简单方法是使用 Mediator 模式（Prism 中的 EventAggregator）。在以下链接中可以看到这种方法的一个很好的例子：

1.  [Sacha Barber 的 MVVM 中介者模式](http://sachabarber.net/?p=477)
2.  [MVVM + 调解器 by marlon grech](http://marlongrech.wordpress.com/2009/04/08/mvvm-mediator-acb-cool-wpf-app-the-mvvm/)

另请查看 MVVM[示例](http://blogs.msdn.com/llobo/archive/2009/05/01/download-m-v-vm-project-template-toolkit.aspx)项目框架。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T20:12:39.477

假设您有一个使用 QueueViewModel 的 QueueView。

```
public class QueueViewModel : INotifyPropertyChanged
{
    public ParentType Parent { get; set; }

    public QueueViewModel(ParentType parent)
    {
        this.Parent = parent;
        foreach (ChildType child in Parent)
        {
            child.PropertyChanged += delegate(object sender,
                PropertyChangedEventArgs e)
            {
                if (e.PropertyName != "IsSelected")
                    return;

                //do something like this:
                Parent.IsSelected = AllChildrenAreSelected();
            };
        }
    }

}

public class ParentType : INotifyPropertyChanged
{
    private bool _isSelected;

    public IList<ChildType> Children { get; set; }
    public bool IsSelected
    {
        get { return _isSelected; }
        set
        {
            _isSelected = value;
            OnPropertyChanged("IsSelected");
        }
    }
}

public class ChildType : INotifyPropertyChanged
{
    private string _name;
    private bool _isSelected;

    public string Name
    {
        get { return _name; }
        set
        {
            _name = value;
            OnPropertyChanged("Name");
        }
    }

    public bool IsSelected
    {
        get { return _isSelected; }
        set
        {
            _isSelected = value;
            OnPropertyChanged("IsSelected");
        }
    }
} 
```

-- 队列视图部分

```
<StackPanel>
<CheckBlock Text="{Binding Path=Parent.Name}" 
            IsChecked="{Binding Parent.IsSelected}"/>
<ItemsControl ItemsSource="{Binding Path=Parent.Children}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>                                    
            <CheckBox Content="{Binding Path=Name}"
                      IsChecked="{Binding Path=IsSelected, Mode=TwoWay}"/>
        </DataTemplate>
    <ItemsControl.ItemTemplate>
</ItemsControl>
</StackPanel> 
```

# php - 如何为 PHP/MySQL 应用程序自动迁移（模式和数据）

> ID：825787
> 
> 赞同：25
> 
> 时间：2009-05-05T16:35:16.253
> 
> 标签：php, mysql, deployment, migration

我在 PHP/MySQL 中有一个应用程序。我正在寻找一种自动方式升级应用程序背后的数据库。升级后我不需要与旧版本兼容。

我已经阅读了[jeff](https://blog.codinghorror.com/get-your-database-under-version-control/)和[K. Scott Allen 的](http://odetocode.com/Blogs/scott/archive/2008/02/03/11746.aspx)文章。

我仍然不确定如何为 PHP/MySQL 应用程序实现这一点。

有什么简单而好的过程吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-05T19:47:21.630

我有一个我使用的“架构”对象 - 但你可以在没有类的情况下做同样的事情..

你想要做的是创建一个' `db_schema_versions`'表：

```
CREATE TABLE db_schema_versions (
  `table` varchar(255) NOT NULL PRIMARY KEY, 
  `version` INT NOT NULL
) 
```

在您的数据库可以跟踪它所在的版本之后 - 它可以自动进行 SQL 升级。

您应该在升级架构时锁定您的架构表。这样您就不会同时有两个请求尝试升级您的架构。

所以 - 跟踪你要升级的版本 - 构建一个大开关 - 像这样：

```
class SNTrack_Db_Schema extends MW_Db_Schema_Abstract {
  protected $table = "sntrack_db_schema";
  protected $version = 5;

  protected function upgrade($fromVersion) {
    // don't break
    switch($fromVersion) {
      case 0:
        $this->db->query('CREATE TABLE sntrack_inbound_shipment (
            `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,
            `from` VARCHAR(255) NOT NULL,
            `date` DATE NOT NULL,
            `invoice` VARCHAR(255) NOT NULL,
            `notes` TEXT
          )');
        $this->setVersion(1);
      case 1:
        $this->db->query('ALTER TABLE sntrack_details ADD `shipment_id` INT');
        $this->db->query('ALTER TABLE sntrack_product ADD `inventory` INT NOT NULL DEFAULT 0');
        $this->db->query('CREATE TABLE sntrack_inventory_shipment (
            `shipment_id` INT NOT NULL,
            `product_id` INT NOT NULL,
            `qty` INT NOT NULL,
            PRIMARY KEY (`shipment_id`, `product_id`)
          )');
        $this->setVersion(2);
...etc 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-06T16:55:42.563

与 gnarf 的建议类似，我将使用以下命令运行：

*   对于架构的每一次更改，创建一个 SQL 文件，在运行时会将您从旧版本带到新版本（这可能是每个主要版本一个文件或许多较小的更改）。
*   创建一个单独的文件，按照它们必须应用的顺序列出每个 SQL 文件名（最旧的在顶部，最新的在底部）
*   在数据库中创建一个简单的“版本控制”表（它只需要一个 VARCHAR 列）

现在您需要编写一个简单的脚本，它以下列方式工作：

*   在版本控制表中查询最后应用的 SQL 更新文件的名称
*   如果有较新的 SQL 更改文件要运行，请按顺序执行它们
*   记录最新申请的SQL文件名

我希望这是有道理的

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-12-07T05:50:12.937

尝试使用此工具进行架构迁移：[https ://github.com/idler/MMP/](https://github.com/idler/MMP/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-04T19:02:31.410

我用 PHP 为 MySQL 创建了一个很小的迁移脚本。它适用于早期项目和那些（还）不需要更复杂的迁移脚本的项目。[https://github.com/kennberg/php-mysql-migrate](https://github.com/kennberg/php-mysql-migrate)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T16:45:54.123

一种方法是使用 mysqldump 将数据库转储到一个大的 sql 文件中。只需获取该文件并在新安装中获取它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-26T12:19:17.740

你不能。你要么

1.  使用在源环境上执行的所有 sql 编写更新文件，然后执行它们（如上所述），类似于 SVN。需要php脚本执行和sql编写的手动工作

2.  对两个环境进行后分析，并向用户建议应该迁移哪些更新。与第一个基本相同，只是您有一个很大的迁移步骤，而不是很多小块。SQLyog 可以分析模式和数据的差异。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-24T00:28:05.667

您还可以使用免费的 API [SqlQuerySync](https://www.sqlquerysync.com)

或为自己创建一个管理 CREATE / ALTER / DELETE 查询的数据库表。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-30T16:07:37.500

使用来自@malukenho 的migratedb [https://github.com/malukenho/MigrateDB](https://github.com/malukenho/MigrateDB)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-12-19T07:50:18.633

MySQL bench 软件（可以在 mysql 网站上找到）可以做到这一点。不过，它涉及重复的点击步骤。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-01-06T11:13:49.010

我得到了相同的目标：迁移一个大型数据库（某些表中超过一百万行）。我正在考虑使用[https://phinx.org](https://phinx.org)似乎很好地处理模式迁移，此外它还带有回滚选项以确保安全。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-07-04T14:59:17.503

你可以试试这个库：[mysql-version-control](https://github.com/smrtr/mysql-version-control)。

我喜欢这个，因为它区分了模式、核心数据和测试数据。但它以一种仍然非常易于使用的方式进行。

# jquery - 具有会计号码格式的jquery tablesorter

> ID：825789
> 
> 赞同：1
> 
> 时间：2009-05-05T16:35:31.807
> 
> 标签：jquery

我正在使用 jquery 表排序器，我正在尝试对具有类似于此的值的列进行排序：

100,000 美元 38,000 美元（4,000 美元） 2,000 美元

() 内的数据为负数。使用默认排序功能时，它不会将 ($4,000) 识别为负数，因此我尝试创建一个自定义函数来处理此问题。

下面的解决方案是我想出的，它工作正常。但我想知道是否有更好的解决方案？我是 jquery 的新手，只是在寻找一些见解。

```
$(document).ready(function() 
    { 
        $.tablesorter.addParser({
                // set a unique id
                id: 'currency-column',
                is: function(s) {
                        // return false so this parser is not auto detected
                        return false;
                },
                format: function(s) {
                         s = s.replace(/$/g,"");
                         s = s.replace(/\(/g,"-");
                         s = s.replace(/\)/g,"");
                         return $.tablesorter.formatFloat(s.replace(new RegExp(/[^0-9.-]/g),""));
                },

                type: 'numeric'
        });

        $("#myTable").tablesorter({
            headers: {
                3: { sorter:'currency-column' },
                4: { sorter:'currency-column' },
                5: { sorter:'currency-column' },
                6: { sorter:'currency-column' },
                7: { sorter: false },
                10: { sorter:'currency-column' }
            }
        }); 

    } 
); 
```

再一次，它做了需要的事情，我对结果很满意（也许我应该把它留在那里......），但如果有更好的解决方案，我很想听听。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-10-30T05:05:05.010

如何删除“，”

```
s = s.replace(/,/g,""); 
```

所以，你的功能变成：

```
format: function(s) {
         s = s.replace(/$/g,"");
         s = s.replace(/\(/g,"-");
         s = s.replace(/\)/g,"");
         s = s.replace(/,/g,"");
         return $.tablesorter.formatFloat(s.replace(new RegExp(/[^0-9.-]/g),""));
}, 
```

^.^

# java - ORM：是还是不是？

> ID：825792
> 
> 赞同：7
> 
> 时间：2009-05-05T16:35:52.167
> 
> 标签：java, orm

我必须在 Java 中开始一个中型项目，但我一般不是 ORM 的忠实粉丝，所以问题是：我是否应该在设计项目时考虑 ORM（供以后使用）？

RDBMS 是 Oracle 10g，查询将与 Oracle 语法/功能（即文本、挖掘、CONNECT BY 等）*非常耦合。*

非常感谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-05T16:38:59.333

您可能想看一下这个讨论 ORM 好处的较早问题：[使用 ORM 有什么好处？](https://stackoverflow.com/questions/398134/what-are-the-advantages-of-using-an-orm/398182)

最相关的部分（取自已接受的答案）：

> 如果你有复杂的、手动调优的 SQL，那么使用 ORM 没有多大意义。

如果您不断超越 ORM 并编写自己的 SQL，那么 ORM 可能最终会成为阻碍。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-05T16:43:10.637

因为我不允许评论你的帖子我会这样评论（缺分）。

对讨论为什么你不喜欢 ORM 会有好处。

伊莫，我会去的。如果您出于某种原因发现 ORM 的查询速度很慢，那么我会自己做。仅仅因为您在大多数任务中使用 ORM 并不意味着您必须全部使用它。但是，是的，这将是首选。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-05T18:06:04.133

我个人发现它们（嗯，Hibernate）是一个令人难以置信的时间槽。远远没有节省时间，我花了太多时间试图弄清楚它在幕后到底在做什么。正如其他人所提到的，如果您的数据模型超过了一定的复杂性，那么在您和数据库之间有另一层只会产生更多的摩擦。如果您的数据模型不是那么复杂，那么您实际上并不需要 ORM。

我**确实**建议使用某种抽象来将 SQL 排除在 Java 代码之外，但这可以简单地通过 DAO 层和属性文件或其他任何东西来完成。IBATIS 或 Spring JDBC 之类的工具也很有帮助，因为您仍然可以编写自己的查询，并且只需使用该框架来帮助处理所有样板代码，以便在 JDBC 和您的模型对象之间混洗数据。

PS：有趣的旁注。在我的办公室里，我们实际上有一张 Gavin King 的相框照片，我们都诅咒它的肖像。“喂，今天的休眠问题，轮到*你处理了，盖文来了。”* :-)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-05T16:43:50.370

ORM 的另一个优点是它在您的简历上看起来非常好。今天发布的大多数工作（至少是 Java 开发人员）都需要一些 ORM 知识。因此，如果您有机会从事某个项目，我会选择 Spring 和 Hibernate，因为它确实会提升您的简历。

我认为指向另一个问题的链接很好地涵盖了技术优势，所以我不会对它们说任何话。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-09-24T19:53:05.720

我个人更喜欢尽可能接近 SQL，所以我会使用 iBatis、JOOQ 或 MentaBean。[顺便说一句， MentaBean](http://mentabean.soliveirajr.com)提供了一种尽可能接近 SQL 的方法，同时为样板 JDBC 代码提供了很多帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-05T16:44:15.110

是的。ORM 可以减轻应用程序开发人员的大量负担；至少，在设计时考虑到它们不会给设计增加太多负担，并且如果您决定使用 ORM，将来会大有帮助。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-05T18:19:03.090

ORM 有意将您的工作对象与数据库分离，创建一个抽象（不可避免地存在泄漏）。因此，您最终只能通过隧道返回以恢复您有意消除的内容。

如果您的许多应用程序是有意在数据库中实现的，那么 ORM 只会给您的信号添加噪声 - 并衰减信号。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-05T16:40:33.123

这取决于...

而且您不必对每个数据库访问都使用 ORM...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-05T16:45:59.537

就像其他人提到的那样；如果您严重（关系）依赖数据库，ORM 几乎没有什么作用，只是添加了不太有用的抽象。但最重要的是：您（想要）是否将数据作为对象处理？如果是，那么 ORM 就是为此而设计的。如果不是，何苦呢。如果需要，您可以稍后添加 ORM - 可能需要比前期更多的时间，但是反过来（在它妨碍您之后清除 Hibernate ......）会更糟。

但是ORM之间也有区别；例如，iBatis 可能比 Hibernate 更适合（对于这个特定主题还有其他问题）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-11-26T22:22:30.800

对于特定于数据库的 SQL，OR 映射确实可能是一个问题。但是，OR-mapping 的一些概念非常强大，可以更轻松地与数据库交互。许多 OR-mapper 共有的一些概念是：

*   为您的数据库模式生成代码。
*   类型安全（通过一些 ORM）
*   比 JDBC 提供的更健壮的变量绑定
*   按对象组合 SQL 以避免 SQL 语法错误

一个很好的工具可以是[https://www.jooq.org](https://www.jooq.org)，它允许您创建任何您想要的 SQL（包括嵌套选择、联合、复杂连接、别名、存储过程、UDT 等）。

免责声明：我为供应商工作

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-02-26T15:02:27.797

ORM：是的，适用于任何企业类软件，其中数据很复杂……多层次、表格、层……但即使在这里，也建议将 NHibernate 和 EF6 以及数据库视图很好地结合起来。

没有任何特殊的应用程序。像测量一样，您需要在其中保存大量数据，但没有数据复杂性

* * *

使用 ORM 有多种可能性，一切都取决于您想要什么。

作为一个真正的 ORM 映射器，我强烈推荐**NHibernate**和**Fluent NH**映射。你需要大量的研究来构建一个漂亮的架构，但是没有什么能挡住你的路。以最小的妥协，您获得真正的灵活性。

**EF6x**（核心不是产品就绪恕我直言）被称为 ORM，但它生成的更接近于 DAL。有些事情是您无法使用 EF6 有效完成的。尽管如此，这仍然是我最喜欢的读取模型工具，而我确实将它与 NHibernate 结合在一起（我将 NH 用于 DDD/写入模型）。

现在来**表现**- 它总是有利有弊。如果您深入了解 ORM**架构**（请参阅我的文章：[避免 ORM 坏习惯](https://www.linkedin.com/pulse/get-know-your-orm-avoid-bad-habits-balazs-hideghety)），那么您会直观地找到使其更快的方法。这是我的另一篇关于如何使 EF6x**更快**5 倍的文章（至少在读取情况下）：[EF6.x 5x faster](https://www.linkedin.com/pulse/orm-read-performance-ef-vs-dapper-balazs-hideghety)

# javascript - 在谷歌地图中围绕一个点绘制半径

> ID：825794
> 
> 赞同：96
> 
> 时间：2009-05-05T16:35:55.787
> 
> 标签：javascript, google-maps, geometry, drawing

我正在使用 Google Maps API 并添加了标记。现在我想在每个标记周围添加一个 10 英里的半径，这意味着一个在缩放时表现适当的圆圈。我不知道该怎么做，而且这似乎并不常见。

[我找到了一个看起来不错的例子，](http://www.freemaptools.com/radius-around-point.htm)你也可以看看谷歌纵横。他们在那里使用带有半径的标记，就像我想要的那样。

~~**更新：**谷歌纵横使用缩放[的图像](http://www.google.com//ig/modules/friendview/fv_content/purple_circle.png)，它是如何工作的？~~ [^(（功能已弃用）)]

* * *

## 回答 #1

> 赞同：245
> 
> 时间：2010-11-25T17:21:34.077

使用 Google Maps API V3，创建一个 Circle 对象，然后使用 bindTo() 将其绑定到标记的位置（因为它们都是 google.maps.MVCObject 实例）。

```
// Create marker 
var marker = new google.maps.Marker({
  map: map,
  position: new google.maps.LatLng(53, -2.5),
  title: 'Some location'
});

// Add circle overlay and bind to marker
var circle = new google.maps.Circle({
  map: map,
  radius: 16093,    // 10 miles in metres
  fillColor: '#AA0000'
});
circle.bindTo('center', marker, 'position'); 
```

[您可以通过更改 fillColor、strokeColor、strokeWeight 等（完整 API](http://code.google.com/apis/maps/documentation/javascript/reference.html#Circle)）使其看起来像 Google Latitude 圆圈。

查看更多[源代码和示例截图](http://seriouscodage.blogspot.com/2010/11/visualizing-data-as-circles-in-google.html)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-05T17:00:10.610

似乎实现这一点的最常用方法是绘制一个[GPolygon](http://code.google.com/apis/maps/documentation/reference.html#GPolygon)，它有足够多的点来模拟一个圆。您引用的示例使用此方法。 [这个页面](http://esa.ilmari.googlepages.com/circle.htm)有一个很好的例子——在源代码中查找函数*drawCircle 。*

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-05T19:24:47.767

在球面几何形状中，形状由点、线和这些线之间的角度定义。你只有那些基本的价值观可以使用。

因此，圆（根据投影到球体上的形状）是必须使用点近似的东西。点越多，它看起来就越像一个圆圈。

话虽如此，请意识到谷歌地图正在[将地球投影到平坦的表面上](http://en.wikipedia.org/wiki/Mercator_projection)（想想“展开”地球并拉伸+展平直到它看起来“方形”）。如果你有一个平面坐标系，你可以随心所欲地在上面绘制 2D 对象。

换句话说，您*可以*在谷歌地图上绘制一个缩放的矢量圆圈。问题是，谷歌地图并没有开箱即用（他们希望尽可能接近 GIS 值）。他们只给你GPolygon，他们希望你用它来近似一个圆。然而，[这个人在](http://www.bdcc.co.uk/Gmaps/BdccGmapBits.htm)IE 上使用 vml，在其他浏览器上使用 svg（参见“SCALED CIRCLES”部分）。

现在，回到你关于使用缩放圆形图像的谷歌纬度的问题（这可能对你最有用）：如果你知道你的圆的半径永远不会改变（例如它总是围绕某个点 10 英里），那么最简单的解决方案是使用[GGroundOverlay](http://code.google.com/apis/maps/documentation/overlays.html#Ground_Overlays)，它只是一个图像 url + 图像代表的 GLatLngBounds 。您需要做的唯一工作是计算代表您的 10 英里半径的[GLatLngBounds 。](http://code.google.com/apis/maps/documentation/reference.html#GLatLngBounds)一旦你有了它，谷歌地图 api 会在用户放大和缩小时处理缩放你的图像。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-05T19:59:49.367

我过去遇到过这个问题，所以我把这个[讨论加入了书签。](http://groups.google.com/group/Google-Maps-How-Do-I/browse_thread/thread/1dca332dbb2bb9c9/b164c644c7ff8e47?#b164c644c7ff8e47)

总结一下，你可以：

1.  看看这个[圆形过滤器](http://maps.google.com/gadgets/directory?synd=mpl&backlink=http%3A%2F%2Fmaps.google.com%2Fmaps%2Fms%3Fmsa%3D0%26ie%3DUTF8%26z%3D5%26om%3D1%26msid%3D111023655921117272809.00043bc9d308dbbe57479&url=http%3A%2F%2Fjfno.net%2Ffilter.xml)的源代码，并弄清楚如何将它合并到您的项目中。
2.  用足够多的点绘制一个 GPolygon 来模拟一个圆。
3.  [修改http://www.nearby.org.uk/google/circle.kml.php?radius=30miles&lat=40.173&long=-105.1024](http://www.nearby.org.uk/google/circle.kml.php?radius=30miles&lat=40.173&long=-105.1024)生成KML文件，然后导入。在 Google 地图中，您只需将 URI 粘贴到搜索框中，它就会显示在地图上。不过，我不确定您如何使用 API 来做到这一点。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-07T11:56:30.880

我刚刚写了一篇博客文章来解决这个问题，您可能会发现它很有用： [http ://seewah.blogspot.com/2009/10/circle-overlay-on-google-map.html](http://seewah.blogspot.com/2009/10/circle-overlay-on-google-map.html)

基本上，您需要使用正确的 GLatLngBounds 创建一个 GGroundOverlay。棘手的一点是根据所需的半径计算这个想象正方形（GLatLngBounds）包围这个圆的西南角坐标和东北角坐标。数学相当复杂，但您可以参考博客中的 getDestLatLng 函数。其余的应该很简单。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-11-01T10:13:50.420

有关 API v3 解决方案，请参阅：

[http://blog.enbake.com/draw-circle-with-google-maps-api-v3](http://blog.enbake.com/draw-circle-with-google-maps-api-v3)

它围绕点创建圆圈，然后用不同的颜色显示范围内和范围外的标记。他们还计算动态半径，但在您的情况下，半径是固定的，因此工作量可能会减少。

# silverlight - 在 Blend 中针对 CLR 对象的 Silverlight 数据绑定

> ID：825798
> 
> 赞同：0
> 
> 时间：2009-05-05T16:37:58.807
> 
> 标签：silverlight, data-binding, datatemplate, blend

我喜欢 Blend 中的功能，您可以在其中设置与 CLR 对象的数据绑定，并设计您的 Silverlight 控件/页面。我的问题是围绕创建将用作 DataTemplate 的用户控件。在 Blend 中一切都很好，但仅在设计时。问题是，当我在 Blend 中编辑控件时，我将一个文本框绑定到 CLR 对象的属性，它给了我这个：

```
Text="{Binding Mode=OneWay, Path=TestAccount.Name, Source={StaticResource TestDataDS}}" 
```

但是，当我准备好运行应用程序并在 DataTemplate 中使用该用户控件来表示列表框时，我需要它看起来像这样：

```
Text="{Binding Mode=OneWay, Path=Name}" 
```

如何在 Belnd 中使用漂亮的绑定进行设计，而在准备运行项目时不必触摸/搜索和替换所有这些绑定？我正在寻找一种既适用于设计时又适用于运行时的方法。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-06T01:14:12.107

为了在 Expression Blend 中创建到 CLR 对象的数据绑定，您不需要使用“创建数据绑定”对话框的“数据字段”选项卡。事实上，这样做是非常罕见的。

使用自定义路径表达式是最常见的方式。只需选中“使用自定义路径表达式”复选框，然后输入您要绑定到的属性的名称。如果您未指定数据上下文，则数据绑定将解析为您在恰好是 DataContext 的任何对象上指定的路径。

如果要设置设计时 DataContext，可以通过设置 d:DataContext 属性来实现，确保正确定义 xmlns:d="..."

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-16T09:19:33.000

如果您使用的是 blend 2，我建议您查看使用依赖注入[的 Jonas Follesoe 的设计时/运行时博客文章。](http://jonas.follesoe.no/YouCardRevisitedImplementingDependencyInjectionInSilverlight.aspx)

如果您有幸使用 Blend 3，[请查看](http://social.msdn.microsoft.com/Forums/en-US/wpfprerelease/thread/04ae8c45-2e78-4b38-a9f0-3f059db1b855)

当您在混合中设置绑定时，“显式数据上下文”选项卡是否可用？

# iphone - 如何在 iPhone OS 上的 sqlite3 数据库中存储字符串？

> ID：825803
> 
> 赞同：0
> 
> 时间：2009-05-05T16:38:54.530
> 
> 标签：iphone, cocoa-touch, uikit

我想看看一些示例代码。也欢迎任何好的教程链接。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T17:09:46.407

这是[SQLite3 C/C++ Intro](http://www.sqlite.org/cintro.html)的链接。

过去，我使用[sqlite3_exec](http://www.sqlite.org/c3ref/exec.html) () 函数来执行 SQL 语句，而不是使用更难的预处理语句 API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T16:53:28.583

就像在任何 SQL 数据库中一样。

# winforms - 应该使用哪个事件来整理 TextBox 的显示？

> ID：825805
> 
> 赞同：0
> 
> 时间：2009-05-05T16:39:02.267
> 
> 标签：winforms, textbox

当用户离开文本框控件时，我想修剪任何空格并立即使用整理后的字符串更新显示。

这应该在 Leave、Validating 或 Validated 事件中完成吗？

谢谢

克拉伦斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T22:54:28.243

如果您只是想修剪字符串，我会使用 leave。如果您想取消休假（从选项卡、输入单击等）并保持选中文本框，则验证很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T16:56:19.170

Leave 事件最适合，因为它发生在焦点离开文本框时。

# c# - 收集实现特定接口而不进行强制转换的类型？

> ID：825806
> 
> 赞同：0
> 
> 时间：2009-05-05T16:39:17.197
> 
> 标签：c#, .net, interface

基本上我想知道特定命名空间中的所有类型是否都实现了特定的接口，例如`IEnumerable`.

我知道我可以做到：

```
foreach type ...
    if type is IEnumerable
        ... 
```

但我不想转换类型只是为了查询它是否实现了一个接口，因为无论哪种方式，转换都会被丢弃。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-05T16:42:20.387

使用**is**运算符不是强制转换，它是一个测试，听起来像你想要的。C# 中的类型转换是使用强制转换运算符（名称？）完成的，如下所示：

```
((IEnumerable)someCollection) 
```

或安全铸造操作员：

```
someCollection as IEnumerable 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T16:47:29.970

假设我没看错，您需要枚举中实现特定接口或超类型的类型列表。也许[Enumerable.OfType(this IEnumerable source)](http://msdn.microsoft.com/en-us/library/bb360913.aspx)有用吗？

```
var enumerables = myListOfThingsToCheck.OfType<IEnumerable>(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T16:49:05.847

如果您更愿意使用 lambda 语法，我认为这也可以。

```
var enumerables=Assembly.GetExecutingAssembly().GetTypes().Where(t => t.Namespace == "YOUR NAMESPACE HERE").OfType<IEnumerable>(); 
```

# sql-server - 更改数据库排序规则不会更新数据库中 varchar/text 字段的排序规则（MS SQL）

> ID：825814
> 
> 赞同：2
> 
> 时间：2009-05-05T16:41:32.603
> 
> 标签：sql-server

我更改了数据库的排序规则。更改之前的所有 text/varchar 列都设置为数据库默认值。当对数据库排序规则进行更改时，我希望设置为数据库默认值的列保持数据库默认值，因此保持链接到新的数据库排序规则。但是，我注意到这些列实际上已更改为专门设置为旧排序规则。

我确实有一个脚本可以更新所有列，但我很想知道为什么这些列没有保持 database_default 或至少设置为新的排序规则。所以我的问题是：

1：为什么列没有更新？

2：有没有办法让它们自动更新？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T16:47:24.353

我最近自己也遇到了这个问题。更改数据库默认排序规则仅适用于创建的新对象-它不会更改任何现有对象（来源：[联机丛书](http://msdn.microsoft.com/en-us/library/ms175835.aspx)-“您可以使用 COLLATE 子句更改在用户数据库中创建的任何新对象的排序规则"

我不知道有什么方法可以让它们自动更新——你需要手动更新它们。我使用了[这里的方法](http://www.ssw.com.au/ssw/KB/KB.aspx?KBID=Q711843)

# iphone - 由于加速度计值更改而更改视图属性的最佳方法是什么？

> ID：825821
> 
> 赞同：0
> 
> 时间：2009-05-05T16:42:56.610
> 
> 标签：iphone, uikit, accelerometer

我想这样做：如果设备移动（加速度计值发生变化），那么我想根据该移动在我的视图中调整一些值。

每次加速度计值发生变化时我会调用一个方法吗？我认为这不是一个好主意，因为它们可能会经常刷新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T16:51:47.883

如果您担心来自加速度计的噪声，您可以通过实施移动平均来平滑输入。这将允许您以您想要的频率采样，而不必担心来自加速度计的错误启动。

[http://en.wikipedia.org/wiki/Moving_average](http://en.wikipedia.org/wiki/Moving_average)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T16:46:52.560

如果您担心更改过于频繁，只需使用累加器即可；使用一点代码来检测更改并检查系统时间；只有在足够的系统时间过去后，您才会触发（可能累积的）更改方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T16:47:18.987

我想是的......如果不是，你只有一个选择。定期阅读。同样，周期越短，准确性越高。因此，如果您可以在检测到值更改时触发事件，则可能会更有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T22:09:12.363

当您`accelerometer:didAccelerate:`在.`UIAccelerometerDelegate``if`

在实现的类中`UIAccelerometerDelegate`，您可以拥有一个包含类似内容的属性，`lastTimeUpdated`然后在您更改视图时更新它

# iphone - 是否有任何第三方库可以在 iPhone OS 中进行酷炫的视图转换？

> ID：825826
> 
> 赞同：6
> 
> 时间：2009-05-05T16:44:30.850
> 
> 标签：iphone, cocoa-touch, uikit, core-animation

我真的不喜欢这种翻转过渡。这很无聊。我想看到一些很酷的东西，比如水效果、雾或其他。有什么可用的，还是我必须（重新）为此发明轮子？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-05T19:53:52.610

可用的动画类型`[CATransition animation]`有：

*   `kCATransitionFade`
*   `kCATransitionPush`
*   `kCATransitionMoveIn`
*   `kCATransitionReveal`
*   `@"suckEffect"`
*   `@"spewEffect"`
*   `@"genieEffect"`
*   `@"unGenieEffect"`
*   `@"rippleEffect"`
*   `@"twist"`
*   `@"tubey"`
*   `@"swirl"`
*   `@"charminUltra"`
*   `@"zoomyIn"`
*   `@"zoomyOut"`

可用的转换类型`[UIView setAnimationTransition:forView:cache:]`有：

*   `UIViewAnimationTransitionFlipFromLeft`
*   `UIViewAnimationTransitionFlipFromRight`
*   `UIViewAnimationTransitionCurlUp`
*   `UIViewAnimationTransitionCurlDown`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-05T19:58:21.757

The iPhone SDK comes with a whole bunch of built in animations. rpetrich listed some of them and I do believe that there are more.

For example using the UINavigationController class provides stock animation which, while simple, is quite effective.

# c++ - Windows Mobile 上的 CInternetSession::OpenURL 导致错误 12029（无法连接）

> ID：825827
> 
> 赞同：1
> 
> 时间：2009-05-05T16:44:36.653
> 
> 标签：c++, http, windows-mobile, mfc

我正在尝试通过在 Windows Mobile 5 上调用 CInternetSession::OpenUrl 使用 HTTP 访问数据（使用 MFC 在 C++ 中编码）。我总是收到错误代码 12029（无法连接）的异常。

我怀疑我需要先使用 Connection Manager API 来创建连接。有人可以确认吗？

我将尝试根据此处的信息 ( [http://msdn.microsoft.com/en-us/magazine/dd263096.aspx](http://msdn.microsoft.com/en-us/magazine/dd263096.aspx) ) 对其进行编码，如果合适，我将报告我的经验作为答案。获得其他输入也很好。

我已经使用以下代码成功打开了一个连接：

```
// Find out which type of connection is needed for this URL.
GUID guid;
HRESULT hresult = ConnMgrMapURL((LPCTSTR)url,&guid,NULL);
if (!SUCCEEDED(hresult))
{
delete [] url;
aError = CartoType::KErrorInternetIo;
return NULL;
}

// Get a connection.
CONNMGR_CONNECTIONINFO cinfo;
memset(&cinfo,0,sizeof(cinfo));
cinfo.cbSize = sizeof(cinfo);
cinfo.bDisabled = FALSE;
cinfo.bExclusive = FALSE;
cinfo.guidDestNet = guid;
cinfo.dwParams = CONNMGR_PARAM_GUIDDESTNET;
cinfo.dwFlags = CONNMGR_FLAG_PROXY_HTTP;
cinfo.dwPriority = CONNMGR_PRIORITY_USERINTERACTIVE;
DWORD status;
hresult = ConnMgrEstablishConnectionSync(&cinfo,&iConnectionHandle,15000,&status); 
```

我知道它有效，因为它将状态设置为`CONNMGR_STATUS_CONNECTED`；尽管如此，我`CInternetSession::OpenURL`之后立即打电话并引发异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T22:47:39.247

这是一些有效的代码。它使用较低级别的 Windows API，而不是 MFC。也许它并不理想并且包含冗余（我真的需要 ConnMgr 调用吗？），但它确实有效：

```
// Find out which type of connection is needed for this URL.
GUID guid;
HRESULT hresult = ConnMgrMapURL((LPCTSTR)url,&guid,NULL);
if (!SUCCEEDED(hresult))
    {
    delete [] url;
    aError = CartoType::KErrorInternetIo;
    return NULL;
    }

// Get a connection.
CONNMGR_CONNECTIONINFO cinfo;
memset(&cinfo,0,sizeof(cinfo));
cinfo.cbSize = sizeof(cinfo);
cinfo.bDisabled = FALSE;
cinfo.bExclusive = FALSE;
cinfo.guidDestNet = guid;
cinfo.dwParams = CONNMGR_PARAM_GUIDDESTNET;
cinfo.dwFlags = CONNMGR_FLAG_PROXY_HTTP;
cinfo.dwPriority = CONNMGR_PRIORITY_USERINTERACTIVE;
DWORD status;
hresult = ConnMgrEstablishConnectionSync(&cinfo,&iConnectionHandle,15000,&status);

HINTERNET hinternet = InternetOpen(_T("CartoType"),INTERNET_OPEN_TYPE_DIRECT,NULL,NULL,0);
HINTERNET hfile = InternetOpenUrl(hinternet,(LPCTSTR)url,NULL,0,0,1); 
```

这将返回一个我可以使用 InternetReadFile 读取的有效句柄，然后使用 InternetCloseHandle 关闭它。

# xslt - 在 XSLT 中检查字符串是否为空或空

> ID：825831
> 
> 赞同：335
> 
> 时间：2009-05-05T16:45:08.213
> 
> 标签：xslt, null, xslt-1.0, xslt-2.0

如何使用[XSL](http://en.wikipedia.org/wiki/XSL)检查值是 null 还是空？

例如，如果`categoryName`是空的？我*在选择*构造时使用。

例如：

```
<xsl:choose>
    <xsl:when test="categoryName !=null">
        <xsl:value-of select="categoryName " />
    </xsl:when>
    <xsl:otherwise>
        <xsl:value-of select="other" />
    </xsl:otherwise>
</xsl:choose> 
```

* * *

## 回答 #1

> 赞同：333
> 
> 时间：2009-05-05T16:53:02.780

```
test="categoryName != ''" 
```

**编辑**：在我看来，这涵盖了从问题中推断出的“[not] null or empty”最可能的解释，包括它的伪代码和我自己对 XSLT 的早期经验。即，“以下 Java 的等价物是什么？”：

```
// Equivalent Java, NOT XSLT
!(categoryName == null || categoryName.equals("")) 
```

有关更多详细信息，例如，明确识别 null 与空，请参阅[下面 johnvey 的答案](https://stackoverflow.com/a/825924/93345)和/或我从该答案改编[的 XSLT 'fiddle'](http://xsltransform.net/94hvTAf/3)，其中包括 Michael Kay 评论中的选项以及第六种可能的解释。

* * *

## 回答 #2

> 赞同：291
> 
> 时间：2009-05-05T17:06:31.890

如果没有任何其他信息，我将假设以下 XML：

```
<group>
    <item>
        <id>item 1</id>
        <CategoryName>blue</CategoryName>
    </item>
    <item>
        <id>item 2</id>
        <CategoryName></CategoryName>
    </item>
    <item>
        <id>item 3</id>
    </item>
    ...
</group> 
```

示例用例如下所示：

```
<xsl:for-each select="/group/item">
    <xsl:if test="CategoryName">
        <!-- will be instantiated for item #1 and item #2 -->
    </xsl:if>
    <xsl:if test="not(CategoryName)">
        <!-- will be instantiated for item #3 -->
    </xsl:if>
    <xsl:if test="CategoryName != ''">
        <!-- will be instantiated for item #1 -->
    </xsl:if>
    <xsl:if test="CategoryName = ''">
        <!-- will be instantiated for item #2 -->
    </xsl:if>
</xsl:for-each> 
```

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2009-05-05T16:53:13.107

从*[空元素](http://www.dpawson.co.uk/xsl/sect2/N3328.html#d4887e64)*：

测试某个节点的值是否为空

这取决于你所说的空是什么意思。

*   不包含子节点：`not(node())`
*   不包含文本内容：`not(string(.))`
*   不包含除空格以外的文本：`not(normalize-space(.))`
*   除了评论之外什么都不包含：`not(node()[not(self::comment())])`

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2011-12-02T15:05:30.697

关于什么？

```
test="not(normalize-space(categoryName)='')" 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2012-08-10T12:58:34.700

前两个处理空值，后两个处理空字符串。

```
<xsl:if test="USER/FIRSTNAME">
    USERNAME is not null
</xsl:if>
<xsl:if test="not(USER/FIRSTNAME)">
    USERNAME is null
 </xsl:if>
 <xsl:if test="USER/FIRSTNAME=''">
     USERNAME is empty string
 </xsl:if>
 <xsl:if test="USER/FIRSTNAME!=''">
     USERNAME is not empty string
 </xsl:if> 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2016-01-01T01:16:10.547

> 如何使用 XSL 检查值是否为空或为空？
> 
> 例如，如果`categoryName`是空的？

**这可能是最简单的 XPath 表达式**（接受答案中的表达式提供了相反的测试，如果否定，会更长）：

```
not(string(categoryName)) 
```

**说明**：

`not()`上述函数的参数`false()`恰好是上下文项没有`categoryName`子项（“null”），或者（单个这样的）`categoryName`子项具有字符串值——空字符串。

> 我*在选择*构造时使用。
> 
> 例如：
> 
> ```
> <xsl:choose>
>     <xsl:when test="categoryName !=null">
>         <xsl:value-of select="categoryName " />
>     </xsl:when>
>     <xsl:otherwise>
>         <xsl:value-of select="other" />
>     </xsl:otherwise>
> </xsl:choose> 
> ```

**在 XSLT 2.0 中使用**：

```
<xsl:copy-of select="concat(categoryName,  $vOther[not(string(current()/categoryName))])"/> 
```

**这是一个完整的例子**：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
     <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:variable name="vOther" select="'Other'"/>

 <xsl:template match="/">
  <xsl:copy-of select="concat(categoryName,$vOther[not(string(current()/categoryName))])"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时：**

```
<categoryName>X</categoryName> 
```

**产生了想要的正确结果**：

```
X 
```

**应用于此 XML 文档时**：

```
<categoryName></categoryName> 
```

或对此：

```
<categoryName/> 
```

或在此

```
<somethingElse>Y</somethingElse> 
```

**产生正确的结果**：

```
Other 
```

* * *

同样，使用这个**XSLT 1.0**转换：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:variable name="vOther" select="'Other'"/>

  <xsl:template match="/">
    <xsl:copy-of select=
    "concat(categoryName,  substring($vOther, 1 div not(string(categoryName))))"/>
  </xsl:template>
</xsl:stylesheet> 
```

**请注意**：根本没有使用条件。在这个不错的 Pluralsight 课程中了解更多关于避免条件构造的重要性：

[“ **.NET 中的战术设计模式：控制流**”](https://app.pluralsight.com/library/courses/tactical-design-patterns-dot-net-control-flow/table-of-contents)

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2011-08-12T08:26:09.710

在某些情况下，您可能想知道该值何时为 null，这在使用从 .NET 对象序列化的 XML 时尤其必要。虽然接受的答案适用于此，但当字符串为空白或空时，它也会返回相同的结果，即''，因此您无法区分。

```
<group>
    <item>
        <id>item 1</id>
        <CategoryName xsi:nil="true" />
    </item>
</group> 
```

因此，您可以简单地测试该属性。

```
<xsl:if test="CategoryName/@xsi:nil='true'">
   Hello World.
</xsl:if> 
```

有时需要知道确切的状态，你不能简单地检查 CategoryName 是否被实例化，因为不像 Javascript

```
<xsl:if test="CategoryName">
   Hello World.
</xsl:if> 
```

将为 null 元素返回 true。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-07-21T02:27:19.607

我知道这个问题很老，但是在所有答案中，我错过了一个在 XSLT 开发中这个用例的常用方法。

我想象 OP 中缺少的代码看起来像这样：

```
<xsl:template match="category">
    <xsl:choose>
        <xsl:when test="categoryName !=null">
            <xsl:value-of select="categoryName " />
        </xsl:when>
        <xsl:otherwise>
            <xsl:value-of select="other" />
        </xsl:otherwise>
    </xsl:choose>
</category> 
```

输入看起来像这样：

```
<categories>
    <category>
       <categoryName>Books</categoryName>
    </category>
    <category>
       <categoryName>Magazines</categoryName>
       <categoryName>Periodicals</categoryName>
       <categoryName>Journals</categoryName>
    </category>
    <category>
        <categoryName><!-- please fill in category --></categoryName>
    </category>
    <category>
        <categoryName />
    </category>
    <category />
</categories> 
```

即，我假设可以有零个、空的、单个或多个`categoryName`元素。使用 -style 构造来处理所有这些情况`xsl:choose`，或者换句话说，命令式的，很快就会变得混乱（如果元素可以处于不同的级别，那就更糟了！）。XSLT 中的一个典型编程习惯是使用模板（因此在 XSLT 中使用 T），它是声明式编程，而不是命令式编程（你不告诉处理器要做什么，你只告诉在满足某些条件时你想要输出什么）。对于此用例，可能类似于以下内容：

```
<!-- positive test, any category with a valid categoryName -->
<xsl:template match="category[categoryName[text()]]">
    <xsl:apply-templates />
</xsl:template>

<!-- any other category (without categoryName, "null", with comments etc) -->
<xsl:template match="category">
    <xsl:text>Category: Other</xsl:text>
</xsl:template>

<!-- matching the categoryName itself for easy handling of multiple names -->
<xsl:template match="categoryName">
    <xsl:text>Category: </xsl:text>
    <xsl:value-of select="." />
</xsl:template> 
```

这有效（适用于任何 XSLT 版本），因为上面的第一个具有更高的优先级（它有一个谓词）。“直通”匹配模板，第二个，捕获任何无效的东西。然后第三个负责`categoryName`以适当的方式输出值。

请注意，在这种情况下不需要专门匹配`categories`or `category`，因为处理器会自动处理所有子级，除非我们另有说明（在本例中，第二个和第三个模板不会进一步处理子级，因为`xsl:apply-templates`没有他们）。

这种方法比命令式方法更容易扩展，因为它自动处理多个类别，并且可以通过添加另一个匹配模板来扩展其他元素或异常。**没有 if 分支的编程**。

`null`注意：在 XML中没有这样的东西。有[xsi:nil](http://www.w3.org/TR/xmlschema-1/#xsi_nil)，但很少使用，尤其是在没有某种模式的无类型场景中。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-06-14T15:47:53.883

如果 XML 中可能不存在该元素，我将测试该元素是否存在以及字符串长度是否大于零：

```
<xsl:choose>
    <xsl:when test="categoryName and string-length(categoryName) &gt; 0">
        <xsl:value-of select="categoryName " />
    </xsl:when>
    <xsl:otherwise>
        <xsl:value-of select="other" />
    </xsl:otherwise>
</xsl:choose> 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-04-23T09:35:26.693

如果一个节点在输入 xml 中没有可用的值，如下面的 xpath，

```
<node>
    <ErrorCode/>
</node> 
```

string() 函数转换为空值。所以这很好用：

```
string(/Node/ErrorCode) ='' 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-08-18T10:12:01.397

像这样的东西对我有用：

```
<xsl:choose>
  <xsl:when test="string(number(categoryName)) = 'NaN'"> - </xsl:when> 
  <xsl:otherwise> 
    <xsl:number value="categoryName" />
  </xsl:otherwise>
</xsl:choose> 
```

或者反过来：

```
<xsl:choose>
  <xsl:when test="string(number(categoryName)) != 'NaN'">
    <xsl:number value="categoryName" />
  </xsl:when> 
  <xsl:otherwise> - </xsl:otherwise>
</xsl:choose> 
```

注意：如果您不检查空值或处理空值，IE7 将返回 -2147483648 而不是 NaN。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-06-23T08:54:53.193

实际上，我发现只测试字符串长度会更好，因为很多时候该字段不是空的，只是空的

> <xsl:when test="string-length(field-you-want-to-test)<1">

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-07-29T07:40:58.007

根据我的经验，最好的方法是：

```
<xsl:when test="not(string(categoryName))">
    <xsl:value-of select="other" />
</xsl:when>
<otherwise>
    <xsl:value-of select="categoryName" />
</otherwise> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-09-10T13:00:03.407

使用简单的 categoryName/text() 这样的测试`<categoryName/>`也可以正常工作`<categoryName></categoryName>`。

```
<xsl:choose>
    <xsl:when test="categoryName/text()">
        <xsl:value-of select="categoryName" />
    </xsl:when>
    <xsl:otherwise>
        <xsl:value-of select="other" />
    </xsl:otherwise>
</xsl:choose> 
```

# objective-c - 用于设置快捷方式的 Cocoa 控件

> ID：825835
> 
> 赞同：2
> 
> 时间：2009-05-05T16:45:57.947
> 
> 标签：objective-c, cocoa, macos, keyboard-shortcuts

我想为我的 Cocoa 应用程序构建一个首选项窗口。是否有关于设置快捷方式的控件如何工作的教程或示例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T16:49:59.887

查看[快捷方式记录器](http://wafflesoftware.net/shortcut/)。

# asp.net - 帮助 SQL Server 查询

> ID：825841
> 
> 赞同：0
> 
> 时间：2009-05-05T16:46:39.083
> 
> 标签：asp.net, sql-server, join

对不起*这是我应该放的

我的查询正在为具有超过 1 个实例的任何记录创建重复条目（无论日期如何）

```
<asp:SqlDataSource ID="EastMonthlyHealthDS" runat="server" 
    ConnectionString="<%$ ConnectionStrings:SNA_TRTTestConnectionString %>" 
    SelectCommand="SELECT [SNA_Parent_Accounts].[Company], 
                   (SELECT [Monthly_HIP_Reports].[AccountHealth] from [Monthly_HIP_Reports] where ([Monthly_HIP_Reports].[YearMonth] = @ToDtRFC) AND ([SNA_Parent_Accounts].[CompID] = [Monthly_HIP_Reports].[CompID])) as [AccountHealth],
                   [SNA_Parent_Accounts].[CompID]
                   FROM [SNA_Parent_Accounts]
                   LEFT OUTER JOIN [Monthly_HIP_Reports] ON [Monthly_HIP_Reports].[CompID] = [SNA_Parent_Accounts].[CompID]
                   WHERE (([SNA_Parent_Accounts].[Classification] = 'Business') OR ([SNA_Parent_Accounts].[Classification] = 'Business Ihn')) AND ([SNA_Parent_Accounts].[Status] = 'active') AND ([SNA_Parent_Accounts].[Region] = 'east')
                   ORDER BY [SNA_Parent_Accounts].[Company]">
    <SelectParameters>
         <asp:ControlParameter ControlID="ddMonths" Name="ToDtRFC" PropertyName="Text" Type="String"  />
    </SelectParameters>
</asp:SqlDataSource> 
```

使用 SELECT DISTINCT 似乎可以解决问题，但我不认为这是一个解决方案。数据库中没有重复的条目。所以看来我的查询表面上是在创建重复项。

该查询应获取满足 where 子句中条件的公司列表，但还应获取该特定 [YearMonth] 中每个公司的健康状态（如果存在），这是子查询的用途。如果该 YearMonth 的条目不存在，则将 Health status 留空。

但如前所述.. 如果您有一个条目表示 CompID 2 的 2009-03 和 CompID 2 的 2009-04 条目.. 无论您选择哪个月份，它都会列出该公司 2-3 次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T16:54:50.047

这个子查询：

```
(SELECT [Monthly_HIP_Reports].[AccountHealth] from [Monthly_HIP_Reports] where ([Monthly_HIP_Reports].[YearMonth] = @ToDtRFC)) as [AccountHealth], 
```

`SNA_Parent_Accounts`与任何列都不相关。

是故意的吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T17:02:55.050

您是什么意思，它“为任何具有超过 1 个实例的记录创建重复条目”？似乎如果有多个实例，则已经存在重复条目？

另外，我会看一下这部分代码：

```
SELECT count(*) FROM [SNA_Ticket_Detail] 
WHERE ([SNA_Ticket_Detail].[CompID] = [SNA_Parent_Accounts].[CompID]) 
   AND (CAST(CAST(YEAR([SNA_Ticket_Detail].[DtRFC]) AS VARCHAR(4)) 
      + '-0' + CAST(MONTH([SNA_Ticket_Detail].[DtRFC]) AS VARCHAR(2))
      AS VARCHAR(7)) = @ToDtRFC) 
   AND ([SNA_Ticket_Detail].[Reviewed] = '1') 
) as [TicketCount] 
```

我看到一个 VARCHAR(4) + '-0' + VARCHAR(2)，在我看来最多 8 个字符，填充到 VARCHAR(7) 中。你是否正在失去一个角色并像那样复制？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T16:55:11.853

我认为您应该在 [Monthly_HIP_Reports] 表和 [SNA_Parent_Accounts] 表之间添加连接。我认为这就是它被重复的地方，因为我不知道这些表是做什么用的......如果你提供更多的表描述，我肯定可以告诉你问题出在哪里......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T17:20:12.293

看来我在 LEFT OUTER JOIN 中发现了问题

我有 LEFT OUTER JOIN [Monthly_HIP_Reports] ON [Monthly_HIP_Reports].[CompID] = [SNA_Parent_Accounts].[CompID]

它正在抓取 ID 匹配的所有月度报告。我需要的是

左外连接 [Monthly_HIP_Reports] ON [Monthly_HIP_Reports].[CompID] = [SNA_Parent_Accounts].[CompID] AND ([Monthly_HIP_Reports].[YearMonth] = @ToDtRFC)

所以它也限制在 YearMonth。

谢谢大家！

# domain-driven-design - POCO vs DTO：可以对域对象进行部分水合吗？

> ID：825843
> 
> 赞同：6
> 
> 时间：2009-05-05T16:46:54.807
> 
> 标签：domain-driven-design, poco, dto

通常需要在 UI 上以各种方式显示域对象；列表、搜索结果、查看和编辑页面，以及页眉、页脚和弹出窗口。通常，您有几个不同的域对象“视图”，每个视图都显示不同的字段。

大多数建议似乎是在需要子集或超集时使用 DTO 获取数据。维护 DTO 有很多开销。简单地填充每个场景所需的域对象的属性是一种不好的方法吗？例如，您可以使用配置文件来说明应该包含哪些属性，例如：

service.GetDomainObjects(int listID, Profile.ListProfile); service.GetDomainObjects(string searchParam, Profile.SearchProfile);

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T10:26:08.310

对我来说，这归结为您希望开销在哪里，或者您将拥有一组不同的类来表示您的 DTO，或者您将拥有一组方法，每个方法都返回相同的域对象，但不同的领域被“水合”。

我会问几个问题来帮助做出决定：

*   为整个物体补水的开销是多少？增加的复杂性（DTO 或部分水合的物体）真的值得吗？
*   其他人会使用你的代码吗？您不要将人们与部分水合的对象混淆，当人们来维护您的代码时，DTO 可能会更清楚。

我对 DTO 有一点个人偏好，因为我觉得你的系统的长期维护会更容易。如果你是一个人的乐队，或者这是一个一次性的应用程序，我完全可以理解不想引入一堆会使你的代码混乱的额外类。

# string - 你能 PInvoke 多字节 ANSI 到可变参数吗？我究竟做错了什么？

> ID：825844
> 
> 赞同：0
> 
> 时间：2009-05-05T16:47:10.780
> 
> 标签：string, internationalization, pinvoke, variadic-functions

** 重大更新 ** 我犯了一个小错误，但我仍然对到底发生了什么感到好奇。

我调用的函数实际上是“fooV”，一个带有这个签名的函数：

```
foo(const char *, const char *, EnumType, va_list) 
```

这清除了我得到的 AccessViolationExceptions，但没有解释为什么 params 参数适用于所有其他 .NET 类型，除了必须转换为多字节 ANSI 字符的字符串。我将让 DLL 的开发人员在参数列表中公开实际使用的版本 ...，如果 va_list 是参数，是否有任何关于 PInvoking 的提示？

** 旧帖 **

[这与我最近提出](https://stackoverflow.com/questions/808154/how-do-i-pinvoke-a-multi-byte-ansi-string)的问题有关，但不同。

我必须使用 PInvoke 调用具有以下签名的 C 库函数：

```
foo(const char *, const char *, EnumType, ...) 
```

该函数以一种因 StructType 而异的方式配置资源；我感兴趣的情况配置了一些期望可变参数是单个 ANSI 多字节字符串的东西。我使用此 PInvoke 签名来调用该函数：

```
 [DllImport(DllName, CharSet = CharSet.Ansi, EntryPoint = "foo")]
    public static extern int Foo(string s1, string s2, EnumType st1, params string[] s3); 
```

这`params string[]`对我来说似乎很奇怪，但是以前调用此函数的签名将其用于其他类型，例如`bool`我遵循了该模式。

我用一个更友好的 .NET 方法来包装它：

```
public void Foo(string s1, string s2, string s3)
{
    int error = Dll.Foo(s1, s2, EnumType.Foo, s3);
    // handle errors
} 
```

最近我将签名更改为在 DLLImport 属性中包含“BestFitMapping = false, ThrowOnUnmappableChar = true”以符合 FxCop 的建议。这是一个红鲱鱼，我将在后面描述。

我期望做出此更改的是对 Unicode 的有限支持。例如，在具有英文代码页的机器上，如果您传递包含日文字符的字符串，则会引发异常。在日文机器上，我希望能够将日文字符串传递给函数。英语测试按预期工作，但日语测试抛出 System.Runtime.InteropServices.COMException，HRESULT 为 0x8007007A。即使没有 BestFitMapping 和 ThrowOnUnmappableChar 设置，也会发生这种情况。

我环顾四周，看到一些网站建议您只需指定普通参数即可 PInvoke varargs，所以我尝试了这个签名：

```
[DllImport(DllName, CharSet = CharSet.Ansi, EntryPoint = "foo")]
public static extern int Foo(string s1, string s2, EnumType st1, string s3); 
```

当我在英语或日语机器上使用它时，这会引发 AccessViolationException。

我不能使用 UTF-8 或其他 Unicode 编码，因为这个 C 库只需要并处理多字节 ANSI。我发现为这个函数指定 CharSet.Unicode 是可行的，但我担心这只是巧合，而不是我应该依赖的东西。我曾考虑使用系统代码页将字符串转换为 byte[]，但不知道如何指定我想将字节数组传递给 varargs 参数。

这是怎么回事？在英文机器上，英文字符工作正常，日文字符按预期抛出 ArgumentException。在日文机器上，英文字符工作正常，日文字符抛出 COMException。我的 PInvoke 签名有问题吗？我尝试使用该`MarshalAs`属性来指定 LPArray 的类型和 LPStr 的子类型，但这同样失败。UnmanagedType.LPStr 表示它是一个单字节的 ANSI 字符串；有没有办法指定多字节 ANSI 字符串？

** 更新 ** 这是考虑到当前评论的补充内容。

如果我指定 CDecl 的调用约定并采用如下普通参数：

```
[DllImport(DllName, CharSet = CharSet.Ansi, EntryPoint = "foo", CallingConvention = CallingConvention.Cdecl)]
public static extern int Foo(string s1, string s2, EnumType e1, string s3) 
```

当我使用这个规范时，我得到一个 AccessViolationException。所以我尝试了这个：

```
[DllImport(DllName, CharSet = CharSet.Ansi, EntryPoint = "foo", CallingConvention = CallingConvention.CDecl)]
public static extern int Foo(string s1, string s2, EnumType e1, string s3) 
```

这适用于英语并在我使用日语字符时抛出 COMException。

我发现唯一能始终如一地工作的是：

```
[DllImport(DllName, CharSet = CharSet.Ansi, EntryPoint = "foo", BestFitMapping = false, ThrowOnUnmappableChar = true)]
public static extern int Foo(string s1, string s2, EnumType e1, params IntPtr[] s3) 
```

为了完成这项工作，我使用 Marshal.StringToHGlobalAnsi() 并传递该指针。这适用于英语和日语。我对不理解为什么这是解决方案感到不舒服，但它确实有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T16:54:40.420

您可能还需要指定`CallingConvention=CallingConvention.Cdecl`，因为 varargs 函数将使用`_cdecl`调用约定（默认为 Winapi，而后者又默认为 StdCall）。

你可能需要别的东西，但我很确定你至少需要那个。

# language-agnostic - String.Format 中的适当文章 (a/an)

> ID：825846
> 
> 赞同：8
> 
> 时间：2009-05-05T16:47:21.030
> 
> 标签：language-agnostic, localization, grammar, nlp

我正在寻找一种文化敏感的方式来在使用适当的文章 (a/an) 时将名词正确插入句子中。它可以使用 String.Format，或者如果在其他地方存在适当的方法来执行此操作，则可能使用其他方法。

例如：

基本句子：“您正在查看一个/一个 {0}”

这应该格式化为：“你在看胡萝卜”或“你在看鸡蛋”。

我目前正在通过手动检查要插入的单词的第一个字符然后手动插入“a”或“an”来执行此操作。但我担心当应用程序本地化为其他语言时，这可能会限制我。

是否有解决此问题的最佳实践？

解决方案：问题似乎很复杂，以至于不存在以我最初所说的方式解决此问题的实用程序或框架。似乎最好的解决方案（在我的情况下）是将文章与名词一起存储在数据库中，以便翻译人员可以拥有他们需要的控制级别。感谢所有的建议！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T16:48:55.643

问题甚至在英语中，a-vs-an 不是由起始*字母*决定的，而是由起始*音*决定的。您可以根据起始字母在英语中做出很好的假设，但也有一些例外（例如“小时”、“用户”）。

最好的办法是获得一个单词的发音以便能够选择。

除此之外，下一个最好的办法是列出常见异常，然后猜测其余的。

* * *

来自[维基百科](http://en.wikipedia.org/wiki/A_and_an#Discrimination_between_a_and_an)：

> “a”或“an”的选择是由语音规则而不是拼写约定决定的。语音中使用“an”来消除在“a”和后面的单词（例如“an X-ray”）之间需要的尴尬的声门塞音（瞬间静默停顿）......以下段落是“an”的拼写规则如果不理解语音规则，可以使用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T16:56:53.677

除了 lc（一小时，一顶帽子）指出的问题外，不同语言的语法规则差异很大。例如，许多基于拉丁语的语言会根据名词的“性别”和“数字”来切换名词的冠词，这有时可以从单词的最后几个字符推断出来，但与英语有同样的问题……有许多例外。

如果您正在谈论本地化界面，我会将文章与每种语言的界面元素的名词一起存储。如果您正在处理用户输入，我看不到这样做的简单方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T17:10:50.350

在[古老的文字冒险电脑游戏](http://en.wikipedia.org/wiki/Zork)时代，解决这个问题的一种方法是让“a”、“an”、“the”等成为事物实际名称的一部分。当你在这些游戏中看到“a 邮箱”时，没有智能 AI 来确定“a”。对象的名称是“邮箱”。在某些游戏中它可能会说“你打开邮箱”，这听起来很愚蠢，而在其他游戏中它可能会说“你打开邮箱”，这意味着输入的对象有另一个名称，用于不同的语法上下文。我建议你走这条路线，而不是你现在的路线。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T16:59:35.730

其他语言也有类似的问题，但在不同的上下文中，例如取决于对象的性别或对象的实际数量（有些语言不仅区分一个对象和两个对象，而且一个、两个或多个对象的语法不同俄语中的两个对象）。

要使用德语中的示例：

相当于“您正在查看 a(n) X”将是：

“Du siehst ein X”
或“Du siehst eine X”
或“Du siehst einen X”

取决于对象X的性别。而对象的性别是您无法猜测的，它与对象的名称有关，只是基于历史传统。

因此，在大多数语言中没有简单的方法来实现这种区别。我的建议是始终使用适用于所有情况的配方，例如

“你正在看一个 X 类型的对象”
或“你正在看一个 (n) X”
或“你正在看一个 X”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T17:09:30.837

这在文化上如何敏感？你试图做的*只有*在英语中才有意义。其他语言可能需要对句子进行完全不同的更改。有些可能会修饰名词，有些可能会改变句子结构，有些可能会重新排列单词等等。

当本地化为其他语言时，您尝试做的事情*将会*中断。没有自动的方法来解决这个问题。

作为一个简单的例子，考虑一下当你尝试用英语写“the {something}”时会发生什么，你只需在单词前面加上“the”就可以了。在法语中，根据性别以及是否为复数，您可以在其前面加上 le、la 或 les。在丹麦语中，您改为添加“en”或“et”后缀。因此，当单词 table 翻译为“bord”时，“table”变成了“bordet”。并且“椅子”（stol）变成了“偷来的”。

解决这个问题的唯一有意义的方法是让翻译者控制*整个*句子。不要以为你可以在这里和那里插入一些与文化相关的词。

所以在实践中，最好的解决方案可能是接受你的应用程序不能简单地本地化。也许您可以确保一些关键语言是可能的，除此之外，忽略这个问题。然后，如果您将来需要将应用程序翻译成语言 X，请与翻译人员一起对应用程序代码进行必要的更改。

或者，您必须完全放弃尝试自己构造句子。确保句子正确的唯一方法是让翻译人员写下*整个*句子。当然，当您希望能够交换单个单词时，这会导致问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T16:57:35.640

有一个名为[.NET 变形器](http://andrewpeters.net/inflectornet/)的库，它用于复数/单数化，可能会以相同的方式重新利用或扩展此类事物。您在这里寻找的是一个一般规则，然后您可以调整例外情况......例如，以字母组合开头的单词通常发音为元音。虽然这不是[严格来说]文化敏感的，但它至少应该让你开始用英语。

# php - 如何在 Wordpress 中创建图像翻转导航按钮

> ID：825850
> 
> 赞同：0
> 
> 时间：2009-05-05T16:48:10.060
> 
> 标签：php, html, css, wordpress

在 Wordpress 中创建基于 wp_list_pages 和 wp_list_categories 的导航栏很容易。但是这些输出文本，你不能以不同的方式影响每个输出 li。

我知道我可以手动创建导航栏，但是有没有用图像替换 wp_list_ 输出的好方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T20:06:03.783

Just alter your CSS to display the images as backgrounds to the li elements and the anchors as block elements. For best usability, set the text-indent in your anchors to something line -9999px.

To better understand how to select and style the nav list and its elements, read [this](http://codex.wordpress.org/wp_list_pages#Markup_and_styling_of_page_items).

# c# - 实体框架：使用 FK 值保存记录而不查找关系

> ID：825856
> 
> 赞同：3
> 
> 时间：2009-05-05T16:49:56.970
> 
> 标签：c#, asp.net, entity-framework

我有一个表“费用”，其中包含一个“费用类型”表的 FK 值。现在，如果我想保存新的费用，我首先获取 FK 的 int 值，查找 ExpenseType 表，并将对象分配给费用对象。例如：

```
//create new expense
var e = new Expense();

//lookup the associated expense type
var et = context.ExpenseTypeSet.First(e -> e.expenseTypeID == 10);

//set field values
e.expenseName = "Some name";
e.expenseType = et;

//save
context.Save(); 
```

有没有一种方法可以创建/插入记录，而无需首先被迫对 FK 表进行查找？不需要查找并强制进行额外的数据库命中。我已经知道 FK ID ... 那么有没有办法设置 ID 并让它快乐？

提前致谢 -

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T17:10:09.917

您也可以使用 EntityReference 执行此操作：

```
e.expenseTypeReference.EntityKey 
   = new EntityKey("MyContainer.expenseTypeSet", "expenseTypeID", 10); 
```

我有一个涵盖此问题和相关问题的[技巧系列](http://blogs.msdn.com/alexj/archive/2009/03/26/index-of-tips.aspx)：

你可能特别想看看这个[技巧 7](http://blogs.msdn.com/alexj/archive/2009/03/25/tip-7-faking-foreign-key-properties-in-net-3-5-sp1.aspx)，它讨论了为 FK 创建假属性。除非您愿意，否则您不需要走那么远，但是这些原则很有用。

# f# - 从 F# 中的列表中提取单个元素

> ID：825858
> 
> 赞同：7
> 
> 时间：2009-05-05T16:50:07.140
> 
> 标签：f#, functional-programming, sequence

我想从 F# 中的序列中提取单个项目，或者如果没有或不止一个则给出错误。做这个的最好方式是什么？

我目前有

```
let element = data |> (Seq.filter (function | RawXml.Property (x) -> false | _ -> true))
                   |> List.of_seq
                   |> (function head :: [] -> head | head :: tail -> failwith("Too many elements.") | [] -> failwith("Empty sequence"))
                   |> (fun x -> match x with MyElement (data) -> x | _ -> failwith("Bad element.")) 
```

它似乎有效，但它真的是最好的方法吗？

编辑：当我被指出正确的方向时，我想出了以下内容：

```
let element = data |> (Seq.filter (function | RawXml.Property (x) -> false | _ -> true))
                   |> (fun s -> if Seq.length s <> 1 then failwith("The sequence must have exactly one item") else s)
                   |> Seq.hd
                   |> (fun x -> match x with MyElement (_) -> x | _ -> failwith("Bad element.")) 
```

估计会好看一点

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T17:36:32.567

以现有序列标准函数的样式完成

```
#light

let findOneAndOnlyOne f (ie : seq<'a>)  = 
    use e = ie.GetEnumerator()
    let mutable res = None 
    while (e.MoveNext()) do
        if f e.Current then
            match res with
            | None -> res <- Some e.Current
            | _ -> invalid_arg "there is more than one match"          
    done;
    match res with
        | None -> invalid_arg "no match"          
        | _ -> res.Value 
```

你可以做一个纯粹的实现，但它最终会跳过箍以保持正确和高效（在第二场比赛中快速终止真的需要一个标志说'我已经找到它了'）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-05T16:54:00.000

序列具有查找功能。

```
val find : ('a -> bool) -> seq<'a> -> 'a 
```

但是如果你想确保seq只有一个元素，那么做一个Seq.filter，然后取filter后的长度并确保它等于1，然后取head。全部在 Seq 中，无需转换为列表。

编辑：在旁注中，我*将*建议检查结果的*尾部*是否为空（O（1），而不是使用函数`length`（O（n））。尾部不是 seq 的一部分，但我认为您可以找到一种模拟该功能的好方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-24T15:07:54.760

What's wrong with using the existing library function?

```
let single f xs = System.Linq.Enumerable.Single(xs, System.Func<_,_>(f))

[1;2;3] |> single ((=) 4) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-04T11:02:49.500

更新的答案是使用 Seq.exactlyOne 引发 ArgumentException

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T12:01:39.597

用这个：

```
> let only s =
    if not(Seq.isEmpty s) && Seq.isEmpty(Seq.skip 1 s) then
      Seq.hd s
    else
      raise(System.ArgumentException "only");;
val only : seq<'a> -> 'a 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-23T21:10:00.247

我的两分钱......这适用于选项类型，所以我可以在我的自定义可能单子中使用它。可以很容易地修改，但可以使用异常来代替

```
let Single (items : seq<'a>) =
    let single (e : IEnumerator<'a>) =
        if e.MoveNext () then
            if e.MoveNext () then
                raise(InvalidOperationException "more than one, expecting one")
            else
                Some e.Current
        else
            None
    use e = items.GetEnumerator ()
    e |> single 
```

# asp.net - 如何在 asp.net 中显示页面生成时间？

> ID：825859
> 
> 赞同：2
> 
> 时间：2009-05-05T16:50:08.013
> 
> 标签：asp.net

监控渲染我的 asp.net 页面需要多长时间的最简单方法是什么（如果重要的话，我仍在使用 webforms）？

我知道页面生命周期非常复杂，但我基本上只是在寻找一个数字，它告诉我我的代码运行了多长时间并将其显示在页面的底部（或任何地方）。

**编辑**

有几个人提到了 asp.net 跟踪配置，这太棒了，我不知道我是怎么错过的。我仍在寻找的一件事是如何仅输出最终渲染时间：即

```
Response.Write(Context.Trace.FinalRenderTimeFromFirst) 
```

但我不知道如何检查微量元素的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T16:57:27.760

我使用 Fiddler ( [http://www.fiddler2.com/Fiddler2/version.asp](http://www.fiddler2.com/Fiddler2/version.asp) ) 来处理这些事情。它不是特定于 ASP.NET 的，但它会在呈现给客户端时分解您的页面，并显示在页面进入浏览器时加载每个页面所花费的时间。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T16:51:27.323

您想要启用跟踪。

从[.NET 跟踪的基础知识](http://www.asp101.com/articles/robert/tracing/default.asp)：

> [M]修改web.config中的trace元素如下：
> 
> `<trace enabled="true" .../>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T16:53:09.770

将 trace=true 放在 .aspx 文件的第一行，并在后面的代码中使用 response.trace("") 向其中添加附加信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-19T17:14:25.520

我通常将这个简单的代码添加到布局视图的底部：

```
<!-- Page generated in @((DateTime.UtcNow - HttpContext.Current.Timestamp.ToUniversalTime()).TotalSeconds.ToString("F4")) s --> 
```

我正在使用带有 Razor 的 ASP.NET MVC，但也应该很容易移植到 Web 窗体。

输出类似：

```
<!-- Page generated in 0.4399 s --> 
```

这开始测量`HttpContext`创建的时间（根据[文档](https://msdn.microsoft.com/en-us/library/system.web.httpcontext.timestamp(v=vs.110).aspx)），并在写入输出之前停止，因此它应该非常准确。

它可能不适用于所有用例（如果您想测量子操作或忽略 MVC 操作之外的时间等），但它很容易粘贴到视图中。

对于更高级的诊断，我曾经使用[Glimpse](http://getglimpse.com/)。

# macos - 右键单击或两指点击

> ID：825874
> 
> 赞同：0
> 
> 时间：2009-05-05T16:53:43.357
> 
> 标签：macos, right-click

如何将 CTRL+W 或关闭窗口、关闭选项卡添加到右键单击或双击菜单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T16:57:32.440

它将在您的触摸板选项中...但是您没有提供有关您实际使用的内容的足够详细信息，因此很难在正确的位置引导您...

请编辑您的消息并添加信息...

而且，这不是真正要求它的好地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T17:24:50.223

这实际上与编程相关（尽管我不确定提问者是否有意）。您需要编写一个[上下文菜单插件](http://developer.apple.com/documentation/Cocoa/Conceptual/MenuList/Articles/DisplayContextMenu.html)。

# php - PHP SQL 包装器

> ID：825876
> 
> 赞同：2
> 
> 时间：2009-05-05T16:54:09.423
> 
> 标签：php, sql, wrapper

有人对 PHP 中的 SQL 包装器有什么建议吗？我一直在使用 ezSQL，这很棒，但想看看是否有人有任何其他建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-05T17:35:16.953

[教义](http://www.doctrine-project.org/)，如果你想要完整的 ORM。如果您只需要一个查询构建器，[Zend_DB_Table就很好。](http://framework.zend.com/manual/en/zend.db.table.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T17:01:00.407

[PDO](http://ca3.php.net/pdo)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-05T17:34:40.917

我建议[Zend Framework](http://framework.zend.com/) DB backage，它具有适用于大多数数据库连接（PDO、MySQL、SQL Server、Oracle、Sqlite）的适配器，面向对象并使用行网关和表网关模式，防止 SQL 注入，与存储过程一起使用，具有内置分析器等，但如果你想要一些 ORM 解决方案，我建议[Propel](http://propel.phpdb.org/)或[Doctorine](http://www.doctrine-project.org/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T17:26:32.043

您总是可以研究像[Propel](http://propel.phpdb.org/trac/)这样的 ORM 解决方案。

# iphone - UIScrollView：当用户滚动时，我将如何回收可滚动网格中的对象？

> ID：825877
> 
> 赞同：0
> 
> 时间：2009-05-05T16:54:17.363
> 
> 标签：iphone, performance, uiscrollview

我有一个带有图像网格的 UIScrollView。目前他们只有6个，但有一天可能会有几百个。因此，在 UIScrollView 中创建几百个 UIImageView 对象并用图像数据填充它们当然是个坏主意。我想我是在 Apple 文档的某个地方读到的：他们建议只创建需要填充可滚动可见区域的 mutch 元素。

但如果我立即重新定位 UIImageView 元素，我担心会出现性能问题。我认为。当用户开始向下滚动时（假设它从 0,0 开始），我必须重新定位那些超出顶部可见区域的 UIView 对象，将它们快速定位到底部，然后分配非常（！！ ) 快速将新图像对象添加到该行中的 UIImageViews。我的意思是......如果用户开始像野生瞪羚一样滚动，越来越快怎么办？

你这样做的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T18:54:44.797

UIScrollView（或者实际上是 UIKit）非常擅长不重绘不变的东西。如果您只移动（或移除以回收）屏幕（或剪辑）视图，您将不会导致重绘。同上在屏幕外添加子视图。

如果您没有启用分页，您可能需要实现一些 UIView 提供的更快的绘图代码。不过我会先测试一下——iPhone 的物理限制在一定程度上限制了滚动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T19:06:58.090

在类似但规模较小的情况下，我通过加载超出滚动视图维度所需的数量来处理这个问题，但不是整个数据集。我只是水平滚动，我发现在当前可见的图像的每一侧加载 1 或 2 个图像可以让事情变得流畅。当只有 1 个可见时，它仍然会加载 3 或 5 个图像，但这比加载数十个图像要好得多。您需要进行一些试验，以了解您需要在可见区域周围允许多少坡度。

动态加载/卸载图像最好在滚动视图的委托方法中处理。

# java - 替换文本边界内的表达式

> ID：825879
> 
> 赞同：4
> 
> 时间：2009-05-05T16:54:40.047
> 
> 标签：java, email, text, mime, replace

我有一个相当烦人的问题，我在 Java 中使用简单的递归方法解决了这个问题。但是，我正在寻找一种更好的方法来做到这一点。

最初的问题涉及在 Quoted Printable/Base64 编码的 Mime 标头中存在空白 - 当我阅读 RFC 2047 规范时 - 这是不允许的。这意味着当存在空白时，MIME 标头的解码失败，例如

```
=?iso-8859-1?Q?H=E4 ll and nothing?= 
```

或更准确地说：

```
=?iso-8859-1?Q?H=E4 ll?= preserve this text =?iso-8859-1?Q?mo nk ey?= 
```

目标是仅删除 =？?= 边界（或使用 =20 重新编码）。应保留此之外的其他文本。

我正在寻找解决这个问题的替代方法，我的目标语言是 Java。关于最简单，最干净的方法的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T17:07:28.597

您可以构建一个简单的状态机来跟踪您是否介于 =? 和 ?= ，然后按字符读取输入字符，并在需要时通过字符转换空格输出它...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T18:48:28.120

好吧，我不知道更好，但这是另一种方法：

```
 public static void main( String[] args )
    {
        String ex1 = "=?iso-8859-1?Q?H=E4 ll?= " + 
            "preserve this text =?iso-8859-1?Q?mo nk ey?=";
        String res1 = removeSpaces( ex1 );

        System.out.println( ex1 );
        System.out.println();
        System.out.println( res1 );
    }

    public static String removeSpaces( String str )
    {
        StringBuffer result = new StringBuffer();
        String strPattern = "(\\?.+\\?)";
        Pattern p = Pattern.compile( strPattern );
        Matcher m = p.matcher( str );

        if ( !m.find() || m.groupCount() == 0 )
        { // Contains no matching sequence.
            return str;
        }

        for ( int i = 1; i <= m.groupCount(); i++ )
        {
            m.appendReplacement( result, 
                m.group( i ).replaceAll( "\\s", "" ) );
        }

        return result.toString();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T17:04:37.790

正则表达式[http://java.sun.com/docs/books/tutorial/essential/regex/](http://java.sun.com/docs/books/tutorial/essential/regex/)。

\s = 空格
\S = 非空格
\? = 转义问号
。= 所有字符，类似于较弱模式匹配中的 *。

使用这样的方法进行多部分查找和替换可能是最简单的：拉出这部分：=\?.\?=

将该部分中的 \s 全局替换为空字符串。

把零件放回去。

如果您使用正则表达式足够长的时间，您可能可以将其归结为一次搜索和替换......

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-05T17:11:25.090

您可以在 ? 上拆分字符串，然后将其放回原处，在替换空格和不替换空格之间交替。

编辑：哎呀。错过了等号。会更正。

编辑 2：更正的实现（源自 Matcher.appendReplacement() 的 Javadoc 示例）：

```
String input = "=?iso-8859-1?Q?H=E4 ll?= what about in this case? :) =?iso-8859-1?Q?mo nk ey?=";

Pattern p = Pattern.compile("=\\?(.*?)\\?=");
Matcher m = p.matcher(input);
StringBuffer sb = new StringBuffer();
while (m.find()) {
    m.appendReplacement(sb, m.group().replaceAll(" ", ""));
}
m.appendTail(sb);
System.out.println(sb.toString()); 
```

# visual-studio-2008 - Visual Studio 2008 - 设置：同步按钮。- 未找到 user.config 文件

> ID：825882
> 
> 赞同：4
> 
> 时间：2009-05-05T16:55:00.000
> 
> 标签：visual-studio-2008

它并没有真正引起问题，但它让我很烦......有谁知道如何在 Visual Studio 中刷新用户配置的位置？当我在项目属性-> 设置中单击同步时。我收到错误消息：在以下任何位置都找不到 user.config 文件。这些路径不再存在，所以我知道为什么会出现错误消息。

有任何想法吗？我确实在注册表中快速搜索了路径，但对于我可以删除的内容，没有什么是真正明显的。也许它包含在解决方案的文件中？

视觉工作室 2008 Windows XP

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T09:04:03.280

即使单击“同步”按钮，我似乎也无法重置我的设置。这个问题只发生在 Windows 8 操作系统中，但我在 Windows 7 中没有遇到任何问题。所以，与其把你的头撞到墙上，我想分享一下。

打开文件资源管理器并按 CTRL+D 或单击面包屑栏，然后输入“%appdata%” - 返回一个文件夹，然后打开“本地”文件夹并查找与您的项目或解决方案名称相同的文件夹。 . 并删除该文件夹。

希望有帮助。

-- 更新 -- 我想指出这个问题是针对在 Windows 8 中运行的 Visual Studio 2012 造成的。抱歉，没有看到日期。这已经很老了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T16:59:28.600

这不是错误，而是“没有要删除的文件，因此实际上什么也没做”的警告。

从“[设置选项卡上的同步按钮](http://www.developmentnow.com/g/55_2006_3_0_0_729014/Synchronize-button-on-the-Settings-tab.htm)”：

> “同步”按钮用于从磁盘中删除运行时生成的、特定于应用程序的 user.config 文件。如果您的应用程序没有任何用户范围的应用程序设置（这意味着所有应用程序设置的范围都是“应用程序”），那么 VS2005 IDE 将不会在运行时删除 user.config 文件。

当您在调试会话之间更改设置架构时，您将使用此按钮，因此版本不会“不同步”并导致从设置文件读取错误。

当然，警告也会在您第二次连续单击“同步”时发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-14T21:02:06.747

从 2010 版到现在我的 2013 版，我从未见过此功能在 Visual Studio 中正常工作。以下位置是空的，但配置文件确实存在于 appdata\local\\.vshost.exe_StrongName_ 中的某个位置，并且后面跟着一堆加密字符。

VS 总是找不到这个文件，显然是 MS VS dev。不敦促团队纠正那个坏事。

# java - 与无参数 StackTraceElement 构造函数相关的 CXF IllegalAnnotationException

> ID：825887
> 
> 赞同：0
> 
> 时间：2009-05-05T16:56:16.797
> 
> 标签：java, cxf

我有一个使用 Apache CXF 2.1.3 构建的 Web 服务。其中一个 web 参数是 java.lang.Throwable。当我调用 JaxWsServerFactoryBean.setServiceBean 时，我得到一个 IllegalAnnotationException，因为 java.lang.StackTraceElement 没有无参数构造函数。

[这里](https://issues.apache.org/jira/browse/CXF-1592?page=com.atlassian.jira.plugin.system.issuetabpanels%3Aall-tabpanel)的 JIRA 错误报告声称已经解决了这个问题，但我仍然遇到异常。有任何想法吗？

我正在使用 java 1.6.0_11。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T21:34:10.203

您是否尝试过更新到 CXF 2.1.5？

# c# - 确保纯文本文件中存在一行的最有效方法

> ID：825893
> 
> 赞同：5
> 
> 时间：2009-05-05T16:57:21.943
> 
> 标签：c#, .net, file-io, performance

我正在使用 C# (.Net 2.0)，并且我有一个相当大的文本文件（平均约 1600 行），我需要定期检查以确保存在特定的文本行。

这样做最有效的方法是什么？我真的每次都必须将整个文件加载到内存中吗？

是否有我可以使用的某种文件内容搜索 api？

感谢您提供任何帮助/建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T17:05:57.397

好吧，您始终可以使用[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)在文件发生更改时为您提供一个事件，这样您就可以按需扫描文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T17:05:25.933

如果文本行总是相同的，那么使用 RegEx 匹配该行的文本可能比循环文件以匹配使用 String.Equals() 或 == 的文本更有效。

也就是说，我不知道在 C# 中如何在文件中查找文本而不将文件打开到内存中并读取行。

这个[链接](http://dotnetperls.com/Content/Regex-File-Tutorial.aspx)是一个很好的教程，使用正则表达式来匹配使用 c# 的文件中的行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T17:21:34.320

除非它们是很长的行，否则在现代计算术语中 1600 行并不多！文件 IO 将由运行时处理，并将被缓冲，并且速度惊人，内存占用惊人地不起眼。

只需逐行读取文件，或使用`System.IO.File.ReadAllLines()`，然后查看该行是否存在，例如使用与字符串的整行比较。

这不会成为你的瓶颈。

如果您经常轮询和/或不必要地使用正则表达式，您的瓶颈可能会出现。如果文件未更改，最好使用文件系统观察程序来避免解析文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-05T17:11:10.537

这实际上取决于您对“高效”的定义。

如果您的意思是内存高效，那么您可以使用流阅读器，这样您一次只有一行文本在内存中，不幸的是这比一次加载整个内容要慢，并且可能会锁定文件。

如果您的意思是在尽可能短的时间内完成，那么这是一项将从并行架构中获得巨大收益的任务。将文件拆分为块并将每个块传递给不同的线程进行处理。当然，这并不是 CPU 效率特别高，因为它可能会使您的所有内核都处于高使用率状态。

如果您只想做最少的工作，您是否已经知道有关该文件的任何信息？多久会更新一次？每行的前 10 个字符是否始终相同？如果您上次查看了 100 行，是否需要再次重新扫描这些行？任何这些都可以为时间和内存使用带来巨大的节省。

归根结底，虽然没有灵丹妙药，但搜索文件（在最坏的情况下）是 O(n) 操作。

* * *

对不起，只是重新阅读，它可能会让人觉得讽刺，我不是故意的。我只是想强调，你在一个领域取得的任何收益都可能在其他地方失去，在这种情况下，“高效”是一个非常模糊的术语。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-05T17:24:57.993

```
List<String> lines = System.IO.File.ReadAllLines(file).ToList()
lines.Contains("foo"); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-05T17:09:45.143

您应该能够像这样循环遍历这些行：

```
String line;
while ((line = file.ReadLine()) != null)
{
    if (line matches regex blah)
        return true;
}
return false; 
```

ReadLine 方法仅将文件的一行加载到内存中，而不是整个文件。当循环再次运行时，对该行的唯一引用将丢失，因此，该行将在需要时被垃圾收集。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T17:28:10.450

我将结合这里使用的几种技术：

1）。在文件上设置 FileSystemWatcher。设置必要的过滤器以防止误报。您不想不必要地检查文件。

2）。当 FSW 引发事件时，使用字符串 fileString = File.ReadAllLines() 获取内容。

3）。使用简单的正则表达式查找字符串的匹配项。

4）。如果匹配项的索引大于 -1，则文件包含索引中任何值的字符串。

You've successfully avoided having to parse the file line by line, you *have* potentially loaded a large amount of data (although 1600 lines of text is hardly that large) into memory. When the string literal goes out of scope it'll be reclaimed by the garbage collector.

# eclipse-pde - CDT 的 Eclipse PDE 弹出窗口扩展

> ID：825899
> 
> 赞同：0
> 
> 时间：2009-05-05T16:58:54.437
> 
> 标签：eclipse-pde

我刚刚将我的插件从 Eclipse 版本 3.3.2 移动到版本 3.4.1。我添加到项目导航器（通过 Object Contribution IFile）的弹出菜单扩展不会出现在 C++ 可执行文件中。IResource 对象贡献不会出现在 Debug 和 Release 文件夹中。这些类型的贡献是否被禁用？有没有办法扩展这些对象的上下文菜单？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-06T16:44:10.000

这不是不同版本的 Eclipse 的问题，而是不同的 Eclipse 透视图的问题。

当 Project Navigator 在 C++ 透视图中打开时，表示项目、发布/调试容器和二进制文件的对象不是从 IResource / IFile 派生的，因此无法使用 Object Contribution IFile。这些对象位于“CDT”包层次结构中。

在其他透视图中，例如 PDE 透视图，树中的对象确实派生自 IResource。

# soap - silverlight2 消息类缺少 CreateBufferedCopy 方法

> ID：825900
> 
> 赞同：1
> 
> 时间：2009-05-05T16:59:03.047
> 
> 标签：soap, silverlight-2.0, message

我正在尝试读取两次肥皂响应，但我收到了已读取的错误消息...有一些示例如何避免这种情况但是...他们使用的是**CreateBufferedCopy**方法，我在 silverlight2 Message 对象上**找不到它：**

微软在 silverlight doc 中也有这句话：

[http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.message.getreaderatbodycontents(VS.95).aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.message.getreaderatbodycontents(VS.95).aspx) "如果要多次访问正文，请使用 CreateBufferedCopy(Int32) 创建一个 MessageBuffer 实例。”

# python - 仅捕获 Python 中的一些运行时错误

> ID：825909
> 
> 赞同：7
> 
> 时间：2009-05-05T17:01:44.240
> 
> 标签：python, exception-handling, try-catch, runtime-error

我正在导入一个在某些情况下会引发以下错误的模块： RuntimeError: pyparted requires root access

我知道我可以在导入之前检查 root 访问权限，但我想知道如何通过 try/except 语句捕获这种特殊类型的错误以供将来参考。有什么方法可以区分这个 RuntimeError 和其他可能引发的错误？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-05T17:17:04.470

您可以检查异常的属性以区分其他可能的`RuntimeError`异常。例如，如果错误与预定义的消息文本不匹配，则重新引发错误。

```
 try:
        import pypatred
    except RuntimeError,e:
        if e.message == 'RuntimeError: pyparted requires root access':
            return 'pyparted - no root access'
        raise 
```

当然，直接文本比较只是一个例子，您可以搜索包含的子字符串或正则表达式。

值得注意的是`.message`exceptions 的属性[从 Python 2.6 开始被弃用](http://docs.python.org/dev/whatsnew/2.6.html#other-language-changes)。`.args`您通常可以在 中找到文本`args[0]`。

> ... 对于 2.6，该`message`属性已被弃用，取而代之的是该`args`属性。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-05T17:56:44.843

> 我知道我可以在导入之前检查 root 访问权限，但我想知道如何通过 try/except 语句捕获这种特殊类型的错误以供将来参考。有什么方法可以区分这个 RuntimeError 和其他可能引发的错误？

如果错误是由特定条件引起的，那么我认为捕获错误的最简单方法是测试条件，您可以自己提出更具体的错误。毕竟在抛出错误之前存在所有“错误”，因为在这种情况下它是环境问题。

我同意上述观点——错误的文本匹配是一种可怕的前景。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-05T17:08:01.933

```
try:
    import pyparted
except RuntimeError:
    print('RuntimeError is raised')
    raise 
```

教程中有关[异常处理的](http://docs.python.org/tutorial/errors.html#handling-exceptions)更多信息。

这种情况[`ImportError`](http://docs.python.org/library/exceptions.html?highlight=exception#exceptions.ImportError)在我看来应该会产生。你可以自己做：

```
try:
    import pyparted
except RuntimeError as e:
    raise ImportError(e) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T17:08:31.620

是的。

```
 try:
        import module
   except RuntimeError:
         pass 
```

导入被解释为任何其他语句，它们并不特殊。你可以做一个

```
if condition:
     import module 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-05T17:08:49.450

```
try:
   import ...
except RuntimeError:
   # Do something 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-05-15T06:29:27.460

[RuntimeError](http://docs.python.org/2/library/exceptions.html#exceptions.RuntimeError)在检测到不属于任何其他类别的错误时引发

```
def foo():
   try:
      foo()
   except RuntimeError, e:
      print e
      print " Runtime Error occurred due to exceeded maximum recursion depth " 
```

这就是我们将如何捕获由python中超出递归限制引起的RuntimeError

如果你想在递归限制上调用你的函数，你可以执行以下操作

```
import sys
def foo():
     try:
        foo()
     except RuntimeError, e:
        sys.setrecursionlimit(1200)
        foo() 
```

但始终强烈不建议更改递归限制，但允许对递归限制进行非常小的更改

# objective-c - 关键字/标签的 Cocoa 控件

> ID：825913
> 
> 赞同：0
> 
> 时间：2009-05-05T17:02:59.527
> 
> 标签：objective-c, cocoa, macos, tags, keyword

我想为我的 Cocoa 应用程序构建一个关键字/标签功能。是否有关于设置关键字/标签的控件如何工作的教程或示例？我希望它看起来像 iPhoto 中的“关键字”窗口，您可以从“窗口”->“显示关键字”获得。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T17:05:53.933

有一个内置控件，称为[NSTokenField](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSTokenField_Class/index.html)，它是 NSTextField 的简单子类。您提供一个字符串和一组分隔符，它会自动标记它们。

# design-patterns - 使用与域实体的一对一接口是好的还是坏的做法？为什么？

> ID：825919
> 
> 赞同：27
> 
> 时间：2009-05-05T17:04:57.587
> 
> 标签：design-patterns, dns, interface, domain-driven-design

我在我从事的一些 DDD 企业应用程序中看到的一件事是使用与域实体相同的接口，具有属性和功能的一对一映射。实际上，域对象总是通过它的一对一接口使用，并且所有域实体都具有这种风格的一对一接口。

例如：

域对象帐户：

```
public class Account : IAccount
{
     public string Name {get;set;}
     //...some more fields that are also in IAccount
     public decimal Balance {get;set;}
} 
```

和它的匹配界面

```
public interface IAccount
{
   string Name {get;set;}
   //... all the fields in Account
   decimal Balance {get;set;}
} 
```

但最近我越来越相信这实际上是一种反模式。
我由开源社区的一些架构师运行它，他们说这是基于设计错误或缺陷，位于设计链的某个位置。

所以我告诉我的同事，他们应该停止为域对象创建接口。因为它们没有任何用途，并且每当您更新域实体时，您都必须更新界面。

首先声称这些接口提供了“解耦”，但我反驳说，由于接口与域实体具有一对一的关系，因此它们并没有真正提供任何解耦，对接口的更改意味着在域实体，反之亦然。

下一个声明是我们需要这些接口来进行测试。我的反驳是 Rhino-mocks 提供了具体类的模拟和存根。但他们声称 Rhino-mocks 在具体类方面存在问题。我不知道我是否买了它，即使 rhino-mocks 在具体类方面有问题，但这并不一定意味着我们应该为域实体使用接口。

所以我很好奇：

为什么要为您的域实体提供一对一的接口？

为什么不？

为什么这是一个好的或坏的做法？

谢谢阅读！

**编辑**：我应该注意我一直在使用接口，我相信如果需要它，我会立即使用接口。但我特别指的是具有一对一接口的域实体。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-05T17:13:22.233

如上所述，这是一种不好的做法，但是...

您的接口需要与域实体不同，这并没有什么特别的原因；有时它确实是正确的映射。但令人怀疑的是，情况总是如此。值得关注的问题是界面是否真正设计，或者它们是否只是因为缺乏时间/懒惰而被放置到位。

使用您的示例，您描述的 IAccount 接口在 Account 对象上公开了 getter 和 setter；使用帐户的所有东西都需要设置帐户余额，并且在该接口级别指定隐含权限，这似乎有点奇怪且不太可能。您的系统中是否没有您只想检查但不设置帐户余额的地方？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-05T17:31:10.473

始终将域对象指定为接口而不是直接指定为类的最大原因是为您在实现上提供一定程度的自由度。在您的示例中，您只有一种 IAccount，所以它有点多余。

但是如果你有，例如：

```
public class Account : IAccount { ... }       // Usual account, persistent
public class MockAccount : IAccount { ... }   // Test mock object
public class TransAccount : IAccount { ... }  // Account, not persistent
public class SimAccount : IAccount { ... }    // Account in a performance sim 
```

等等？

通过将域对象定义为接口，您可以在不干扰域定义的情况下替换实现。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-05T17:31:21.470

一般来说，如果我的类不属于 Strategy 或 Visitor 等设计模式的一部分，我不会添加接口。

添加接口对于 Strategy 和 Visitor 这样的设计模式非常有用，但在这些情况下，我不会复制域类的 getter 和 setter。相反，我创建特定于我创建的设计模式接口的接口。

```
interface SomeStrategy {
   void doSomething(StrategyData data);
}

interface StrategyData {
   String getProperty1();

   String getProperty2();
} 
```

这允许我让域类实现这些接口，或者使用适配器模式。我发现这是一种更简洁的方法，只是为了它而创建接口。

设计应始终减少不确定性。为它而创建接口并不能减少不确定性，实际上它可能会增加混乱，因为它没有任何意义。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-11T14:31:51.923

实体上的一对一接口是一种反模式

[詹姆斯格雷戈里在这里](http://www.lostechies.com/blogs/jagregory/archive/2009/05/09/entity-interface-anti-pattern.aspx)说得比我好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-17T00:48:24.140

我同意你的看法。接口应该充当契约，因此与域实体具有一对一的接口没有任何价值。如果您想抽象某种行为，它可能会很有用。但是，这在某些情况下会起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-26T07:35:36.357

这个怎么就一发不可收拾了？

正如查理马丁所说，我发现拥有一个域对象的接口允许我选择我的实现。

一个基本的例子是一个对象的标识符（object.Id），这将取决于您存储该对象的位置以及创建它的责任可能会或可能不会在以后的数据实现中休息。在 SQL Server 中，您可能会使用自动编号，但在 Azure 表存储中，您可能会使用 Guid，但您不希望更改应用程序的业务逻辑，因为您更改了存储数据的位置。

我可能会也可能不会选择让我的域对象持久化，甚至在表示层中使用它——这取决于我的应用程序的最佳范围。但是在公共层中添加一组公共域接口允许我针对它们编写服务并一次又一次地重用它们。

如果我们没有 IAddress，我们将讨论关于什么应该是地址的相同论点，如果没有 ICreditCard，新程序员将重写信用卡的东西。

反模式标签是对语言的错误使用，它过度简化了描述解决复杂多样任务的价值的方法。

大多数模式都有一席之地，即使是被诟病的 Singleton，这意味着它不是“反模式”，至少就术语所暗示的而言。

# iphone - 有没有关于如何在 iPhone OS 中使用加速度计的好例子？

> ID：825923
> 
> 赞同：1
> 
> 时间：2009-05-05T17:06:23.777
> 
> 标签：iphone, uikit, accelerometer

我认为地球重力存在一些问题，所以我想知道是否有加速度计通过减去这些来工作的例子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T17:16:06.937

（太糟糕了，你不能向地球提交一个错误来解决它的重力问题！）

[UIAcceleration 类参考](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIAcceleration_Class/Reference/UIAcceleration.html)中的“相关示例代码”下列出了几个示例。

正如该文档所述，1.0 的值大约代表 +1g。因此，如果您将 iPhone 竖直指向上方，您应该会看到大致 <0, -1, 0>。当您旋转手机时，加速度矢量的大小`sqrt(x*x+y*y+z*z)`应保持在 1 左右。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T19:00:52.397

Apple 的 AccelerometerGraph 演示包括实现高通滤波器的示例代码——有效地过滤掉重力的影响。只需抓住它并根据您的需要进行修改非常简单。

# c# - 人体模拟器设计资源。（想想13楼）

> ID：825925
> 
> 赞同：2
> 
> 时间：2009-05-05T17:06:53.853
> 
> 标签：c#, simulation

那天看到 13 楼后，我已经痴迷于编写这样的模拟器。

我已经编写了几个具有男性和女性子类的人类基类的模拟。他们有一个名为 runYear 的例程，并且他们进行交互。他们约会、工作、死亡、生孩子、伤心、自杀、离婚等等。

它将运行数千“年”，并根据种子参数变得非常大或死亡。

我的问题是：我真的已经用尽了我能做的事情，我希望从头开始重写它，但我希望有一个向前发展的基础。是否有任何人可以指出我的好书或文章可以帮助我更好地理解我需要如何设计这个或我应该包括哪些关键基础？

在技​​术点上：

1.  我应该考虑使用面向对象的数据库来存储这些信息吗？
2.  我打算用 C# 写这个（出于舒适的原因），学习 LISP 会更好吗？
3.  有没有其他人遇到过这样的开源模拟器我可以从中得到一些想法

任何其他想法/建议都会很棒。

埃里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T18:37:58.143

这种模拟器最复杂的不是如何实现它，而是你如何为你的生物建模，以及它们与彼此和环境的交互。

只需使用您最熟悉的工具即可。一开始我不太可能使用任何类型的数据库，我会使用我的编程语言使用的数据结构，并且可能在需要持久性时将数据结构写入和读取到普通文件。

这里有一些关于这种模拟的链接。它们中的大多数不是人类水平，而是在稍微“较低”的水平上工作，想想昆虫、细菌和 DNA。

*   [维基百科：人工生命](http://en.wikipedia.org/wiki/Artificial_life)
*   [维基百科：生活模拟游戏](http://en.wikipedia.org/wiki/Life_simulation_game)
*   [维基百科：多代理系统](http://en.wikipedia.org/wiki/Multi-agent_system)

关于现有系统的几个示例：

*   [Breve - 3d 生活模拟器](http://www.spiderland.org/breve/)
*   [达尔文机器人](http://www.darwinbots.com/WikiManual/index.php?title=Main_Page)
*   [Creatures，一款商业化的人造生命游戏](http://en.wikipedia.org/wiki/Creatures_(artificial_life_program))

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T17:18:16.057

[一群](http://www.swarm.org/index.php/Main_Page)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T17:50:15.810

首先，您需要从创建 World 类开始。您的 World 类将包含一个世界可以做的所有事情。你会想要合并重力、空气、地面、墙壁等。你可能想从给天空一个限制开始，因为你不希望有人离开你的世界并在记忆中做他自己的事情某处。

设置好 World 后，为自己创建一个 Abstract Human 类。本课程将具备基本的人类能力。您可以指定身高、体重、年龄等内容...

从那里，您继承 Human 类，并创建 Woman 和 Man 类，每个类都有其特殊属性。Woman 类可以有 BreastSize、CookingSkill、SexualPrownessLevel 等... Man 类主要用于跟踪谁是秃头。

从那里，你可以走得更远，分成种族，如亚洲人、印度人等。每个种族也会有自己的特点。

一旦你解决了所有这些问题，你就可以开始研究有趣的东西了。您可以创建对象来破坏他们的生活，例如疾病、宗教、金钱、犯罪、贫困、饥饿、洪水、龙卷风等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T18:19:06.770

我认为第一步是首先能够以描述性的方式描述您的问题。

我喜欢把它当作一个`System-of-Systems`问题。为此，请查看[SysML](http://www.sysmlforum.com/FAQ.htm)。这样，您可以从高层次开始，然后随着系统的发展增加越来越多的保真度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T18:49:06.993

您应该查看[离散事件模拟](http://en.wikipedia.org/wiki/Discrete_event_simulation)框架（最后有指向列表的链接）。我只知道用于 Python 的[SimPy](http://simpy.sourceforge.net/)，但还有其他的，开源的和商业的。基本框架也很简单，所以应该是简单的“编程练习”。

# concurrency - 开锁应用领域

> ID：825928
> 
> 赞同：1
> 
> 时间：2009-05-05T17:07:29.080
> 
> 标签：concurrency, locking

JDK 的 ConcurrentHashMap 使用了 lock-striping 技术。尽量减少锁定开销是个好主意。是否有任何其他库或工具可以利用它？例如，数据库引擎是否使用它？

如果该技术在其他领域没有太大用处，它的局限性是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-02-15T18:45:56.427

当有一种方法可以在不影响数据完整性的情况下将高争用锁分解为多个锁时，锁条带化非常有用。如果这是可能的或不应该考虑一下，但并非总是如此。数据结构也是决定的因素。所以如果我们使用一个大数组来实现一个哈希表，对整个哈希表使用一个锁来同步它会导致线程顺序访问数据结构。如果这是哈希表上的同一位置，那么这是必要的，但是，如果他们正在访问表的两个极端怎么办。

使用锁定条带化绝对可以节省大量时间。[场景](http://harisankar-krishnaswamy.blogspot.in/2012/02/making-concurrent-software-finding.html)的多次运行几乎可以将执行时间减半。

锁条带化的缺点是很难获得受条带化影响的数据结构的状态。在示例中，表的大小或尝试列出/枚举整个表可能很麻烦，因为我们需要获取所有条带锁。

# c++ - 具有任何返回类型和任何参数的派生函子

> ID：825935
> 
> 赞同：0
> 
> 时间：2009-05-05T17:08:55.830
> 
> 标签：c++, templates, inheritance, functor

我有一个使用函子作为工作单元的课程。它在其 Run() 方法中接受对仿函数的引用。要允许此类对任何函子进行操作，所有这些函子必须派生自我的基函子类，如下所示：

```
class baseFunctor{

public:
    virtual void operator()()=0;
    virtual baseFunctor Clone()=0;
}; 
```

这可行，但显然它将这些函子限制为具有返回 void 且不接受任何参数的运算符方法。我需要能够在我的类中接受一个函子，它可以接受任何类型的参数并返回任何东西。它显然是可行的，但我似乎无法找到一种方法来做到这一点。我曾考虑过使用模板、多重继承，但我一直受到以下事实的阻碍：需要运行此函子的类必须能够接受任何类型，因此将接受基类类型，因此不知道实际类型的函子。

任何有关查看途径的建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T17:23:06.623

调用函子的类如何知道要提供哪些参数以及如何处理返回值（如果有）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T17:42:43.567

所以，如果我没看错的话，你有一个“访客模式”。你抬头看可能是件好事。

*有人*需要知道函子是什么类型才能给它参数。通常使用函子，参数被分配给派生类的字段，并且 operator() 将对这些字段进行操作。也就是说，调用函子并且对它一无所知的愚蠢方法由更有知识的人给出了闭包（方法加参数都在一个类中）。

如果您确实想要在 operator() 中接受多个参数的泛型仿函数，那么模板将使您成功，但您需要每个参数一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T17:22:11.993

如果您愿意使用 Boost 库 (www.boost.org)，您可能会发现 Boot.Bind 和 Boost.Function 特别感兴趣。我过去曾使用它们来实现与您所讨论的内容非常相似的事情。

如果您使用Boost.Bind，您可以对函子执行currying，以说明函子预期的参数数量与Run 方法预期的参数数量（即零）之间的差异。创建函子的代码必须将任何参数绑定到特定值，从而创建一个可以传递给 Run() 的零参数函子。

MV

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T18:05:14.603

我同意尼尔的观点。您的主类必须知道要传递哪些参数以及这些函子期望的返回值。您可以将您的“仿函数”类型转换为支持具有必要参数和返回值的函数的适当类吗？

```
class baseFunctor
{
};

class functor1x2: public baseFunctor
{
public:
    virtual void* execute(void*, void*);

}

class MainClass
{
public:
   void Execute(baseFunctor* ipFunctor)
   {
      functor1x2* lpFunctor1x2 = dynamic_cast<functor1x2*>(ipFunctor);
      if(lpFunctor1x2)
      {
         lpFunctor1x2->execute(NULL, NULL);
      }
   }
} 
```

正如 Drew 所指出的，我不确定使用访问者模式无法更容易实现的这种方法可以实现什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T17:27:17.613

也许 std::tr1::function 对您来说很有趣？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T17:20:05.930

为什么要返回函子？你也存储一些状态吗？一些更多的细节将不胜感激，因为不太清楚你到底想做什么。

如果您打算使用继承，请查看 Covariant Return Types（和[Virtual Constructor idiom](http://www.parashift.com/c++-faq-lite/virtual-functions.html#faq-20.8)）。

现在，对于问题的实质：问题实际上不在于传入函子，而在于函子应用程序。您可能还想看看[`boost::lambda`](http://www.boost.org/doc/libs/1_39_0/doc/html/lambda.html)和[`boost::parameter`](http://www.boost.org/doc/libs/1_38_0/libs/parameter/doc/html/index.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T17:21:38.110

我认为您需要省略号参数，例如 C++ 的可变参数。

# php - PHP字符编码问题

> ID：825939
> 
> 赞同：4
> 
> 时间：2009-05-05T17:09:43.457
> 
> 标签：php, xml, utf-8, character-encoding

我需要帮助解决我想要一劳永逸地排序的字符编码问题。这是我从 XML 提要中提取的一些内容的示例，插入到我的数据库中然后拉出。

如您所见，许多特殊的 html 字符已损坏/损坏。

我怎样才能一劳永逸地阻止这一切？我如何能够支持所有类型的字符等？

我已经尝试了我能找到的每一段编码，它有时会纠正大多数情况，但仍有一些代码已损坏。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-07T09:33:49.887

**绝对一劳永逸**地确保您再也不会遇到编码问题：

**随时随地使用 UTF-8！**

那就是（如果你使用mysql和php）：

*   例如，将数据库中的所有表设置为排序规则“utf8_general_ci”。
*   建立数据库连接后，运行以下 SQL 查询：“SET NAMES 'utf8'”
*   始终确保您的编辑器设置为 UTF-8 编码。
*   在 HTML 文档的部分中有以下元标记：

    *<meta http-equiv="content-type" content="text/html; charset=utf-8">*

还有一些额外的提示：

*   当您使用 PHP 进行字符串操作时，请使用[多字节函数](http://php.net/mbstring)。
*   您也可以在某个时候检查[http://docs.kohanaphp.com/core/utf8 。](http://docs.kohanaphp.com/core/utf8)

或者：

您可以只使用一个简单的服务器端配置文件来处理所有编码内容。在这种情况下，您根本不需要标题和/或元标记或 php.ini 文件修改。只需将您想要的字符集编码添加到 .htaccess 文件并将其放入您的 www 根目录中。如果你想摆弄字符集字符串并使用你的 php 代码 - 那是另一个故事。数据库排序规则当然必须是正确的。

脚注：UTF-8 不是编码解决方案，它是*一种**解决*方案。只要考虑到使用的环境，使用什么字符集/编码并不重要。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T17:11:49.350

我最喜欢的关于 JoelOnSoftware 编码的文章：[每个软件开发人员绝对、肯定必须了解 Unicode 和字符集的绝对最小值](http://www.joelonsoftware.com/articles/Unicode.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T17:36:34.470

看起来您提供的链接包含以 utf-8 编码的数据。（点击该链接，然后将浏览器的编码更改为 utf-8）。

我听起来您在从数据库中插入和检索时遇到问题。确保您的数据库表已将 utf-8 设置为编码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T17:24:35.137

似乎 UTF-8 编码的文本是用 ISO 8859-1 解释的。

如果您正在处理 XML 文档，则必须使用在[HTTP 标头字段](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17)`charset`中的参数或[XML 声明](http://www.w3.org/TR/xml/#dt-xmldecl)中的属性中给出的编码。如果两者都没有给出，则 XML 规范将 UTF-8 或 UTF-16 声明为[默认字符编码](http://www.w3.org/TR/xml/#charencoding)，您必须使用一些[检测](http://www.w3.org/TR/xml/#sec-guessing-no-ext-info)。[`Content-Type`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17)`encoding`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-23T06:20:49.313

连接到数据库之后，但在执行任何事务之前，请执行以下行，以确保所有数据库通信都使用 UTF-8：

`mysql_query("SET character_set_results = 'utf8', character_set_client = 'utf8', character_set_connection = 'utf8', character_set_database = 'utf8', character_set_server = 'utf8'", $dbconn);`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T17:24:11.737

首先，确保您的数据库的字符编码设置为支持 UTF-8。其次，PHP 的[ICONV](http://us2.php.net/iconv)将成为您的朋友。最后，确保您的响应标头发送正确的字符编码（同样，UTF-8）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T17:25:42.593

你试过[`utf8_encode()`](http://php.net/manual/function.utf8-encode.php)吗[`utf8_decode()`](http://php.net/manual/function.utf8-decode.php)？

您使用哪一个将完全取决于您的数据是如何编码的，您没有指定，但它们对于这种情况非常有用。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-05T17:28:42.100

```
header('Content-type: text/html; charset=UTF-8') ;

/**
 * Encodes HTML safely for UTF-8\. Use instead of htmlentities. 
 *
 * @param string $var 
 * @return string 
 */
function html_encode($var)
{
    return htmlentities($var, ENT_QUOTES, 'UTF-8');
} 
```

那两个救了我，我认为它现在*正在工作*。如果我继续遇到问题，我会回来。我应该将它存储在数据库中，例如“&”还是“&”？

# c# - 在数据仍在内存中时确定未来文件的大小

> ID：825944
> 
> 赞同：4
> 
> 时间：2009-05-05T17:10:18.823
> 
> 标签：c#

这是 C#/.NET 2.0。

所以我有一个包含 XML 文件未来内容的字符串。它包含来自图像文件的元数据和二进制数据。一旦我将字符串中的数据写入文件系统，我想以某种方式确定 XML 文件的大小。

我尝试了以下方法，但都不起作用：

```
Console.Out.WriteLine("Size: " + data.Length/1024 + "KB"); 
```

和

```
Console.Out.WriteLine("Size: " + (data.Length * sizeof(char))/1024 + "KB"); 
```

两者都不起作用（结果文件的实际大小与这些方法中的任何一个返回的大小不同）。我显然在这里遗漏了一些东西。任何帮助，将不胜感激。

XML序列化：

```
// doc is an XMLDocument that I've built previously
StringWriter sw = new StringWriter();
doc.Save(sw);
string XMLAsString = sw.ToString(); 
```

写入文件系统（XMLAsString 作为名为 data 的变量传递给此函数）：

```
Random rnd = new Random(DateTime.Now.Millisecond);      
FileStream fs = File.Open(@"C:\testout" + rnd.Next(1000).ToString() +  ".txt", FileMode.OpenOrCreate);
StreamWriter sw = new StreamWriter(fs);
app.Diagnostics.Write("Size of XML: " + (data.Length * sizeof(char))/1024 + "KB");
sw.Write(data);
sw.Close();
fs.Close(); 
```

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-05T17:15:18.653

您错过了编码过程的工作原理。尝试这个：

```
string data = "this is what I'm writing";
byte[] mybytes = System.Text.Encoding.UTF8.GetBytes(data); 
```

如果以某种“正常”的方式写入数组，则数组的大小正是它应该在磁盘上占用的字节数，因为 UTF8 是文本输出的默认编码（我认为）。可能写了一个额外的 EOF（文件结尾）字符，也可能没有，但你应该非常接近。

编辑：我认为值得每个人记住 C#/.NET 中的字符不是一个字节长，而是两个，并且是 unicode 字符，然后将其*编码*为输出格式所需的任何内容。这就是为什么任何方法`data.Length*sizeof(char)`都行不通的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T17:39:55.553

如果要确定文件是否适合媒体，则必须考虑文件系统的分配大小。10 字节长的文件不会占用磁盘上的 10 字节。空间需求以离散步骤增加，由分配大小（也称为集群大小）确定。

有关 NTFS 和 FAT 群集大小的详细信息，请参阅[此 Microsoft 支持文章](http://support.microsoft.com/kb/140365)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T17:13:43.103

在 NTFS 中，如果您的文件系统设置为压缩，则最终文件可能会小于实际文件的大小。那是你的问题吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T17:17:51.050

您可以将其保存（或写入）到内存流，然后确定该内存流的大小，这是在不将其写入磁盘的情况下确定实际大小的唯一方法。

看不出有任何意义，您不妨将其保存为本地文件，查看最终文件大小，然后选择如何处理它。

如果您要做的只是对添加了一堆编码的二进制元素后 XML 文件的大小进行合理估计，并且我们可以假设 XML 的其余部分与编码的二进制文件相比可以忽略不计内容，然后是确定由于编码而引入的膨胀的问题。

通常，我们将使用 base64 编码对二进制内容进行编码，这会导致每 3 个二进制字节对应 4 个字节的 ASCII，即 33% 的膨胀。所以估计是 data.Length * 1.33333

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T17:17:18.790

你上面的例子是什么`data`？xml文件中的二进制数据是如何表示的？

您很可能希望对字节数组进行完全序列化以准确猜测大小。序列化程序可能会执行任意操作，例如添加 CDATA 标记，并且如果您出于某种原因需要将文件保存为 UTF-16 而不是 UTF-8，那么这可能会使您的大小翻倍。

# python - python中的抽象类+mixin+多重继承

> ID：825945
> 
> 赞同：29
> 
> 时间：2009-05-05T17:10:43.893
> 
> 标签：python, abstract-class, multiple-inheritance, mixins

所以，我认为代码可能比我用语言更好地解释了我想要做的事情，所以这里是：

```
import abc

class foo(object):
    __metaclass__ = abc.ABCMeta
    @abc.abstractmethod
    def bar(self):
        pass

class bar_for_foo_mixin(object):
    def bar(self):
        print "This should satisfy the abstract method requirement"

class myfoo(foo, bar_for_foo_mixin):
    def __init__(self):
        print "myfoo __init__ called"
        self.bar()

obj = myfoo() 
```

结果：

```
TypeError: Can't instantiate abstract class myfoo with abstract methods bar 
```

我试图让 mixin 类满足抽象/接口类的要求。我错过了什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-05T17:49:37.620

继承不应该反过来吗？在 MRO`foo`目前来之前`bar_for_foo_mixin`，然后理所当然地抱怨。有了`class myfoo(bar_for_foo_mixin, foo)`它应该可以工作。

而且我不确定您的课程设计是否是正确的方法。由于您使用 mixin 来实现`bar`，因此最好不要从 foo 派生而只需将其注册到 'foo' 类（即`foo.register(myfoo)`）。但这只是我的直觉。

为了完整起见，这里是[ABCs 的文档](http://docs.python.org/library/abc.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-06T10:25:40.343

我认为（在类似情况下测试）反转基类是有效的：

```
class myfoo(bar_for_foo_mixin, foo):
    def __init__(self):
        print "myfoo __init__ called"
        self.bar() 
```

所以在 mro() 中，它会在找到抽象版本之前找到 bar() 的具体版本。不知道这是否真的是在后台发生的事情。

干杯，拉斯

PS：在 python 2.7 中工作的代码（python 3 有不同的方式来设置元类）是：

```
class A(object):
    __metaclass__ = abc.ABCMeta

    @abc.abstractmethod
    def do(self):
        pass

class B(object):
    def do(self):
        print "do"

class C(B, A):
    pass

c = C() 
```

# c# - 如何启用\禁用表的所有子控件？

> ID：825948
> 
> 赞同：4
> 
> 时间：2009-05-05T17:10:54.453
> 
> 标签：c#, javascript

我有一个复选框，当它被选中时，我想启用一个表及其子控件，当它被禁用时，我想做相反的事情。

我已经明白我必须迭代表的所有子控件，我的问题是是否有任何好的和通用的方法来做这件事。

提前致谢，

盎司

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-05T17:21:31.823

你可以用**[jQuery](http://jquery.com)**做到这一点。假设您的 HTML 如下所示：

```
<input type="checkbox" onclick="toggleControls(this)"/>Controls Disabled
<table id="myTable">
 <tr>
  <td>Name: <input type="text" /></td>
  <td>Select: <input type="radio" /></td>
 </tr> ..... 
```

toggleControls() 函数用于禁用/启用表格内的**所有控件（***这意味着所有文本框、按钮、复选框、单选按钮和下拉菜单*）如下所示：

```
<script>
   function toggleControls(e){
     $('#myTable input,select,textarea').attr('disabled',e.checked);
   }
</script> 
```

jQuery 的 css 选择器使这一行可以禁用/启用控件。使用普通的旧 javascript，该函数将如下所示：

```
var myTable = document.getElementById("myTable");
var controls= myTable.getElementsByTagName("input"); 
// Repeat the previous line for "select" and "textarea"
for(i = 0; i < controls.length; i++) {
    control = controls[i];
    control.disabled = !control.disabled;        
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T17:20:33.463

例如，使用框架（使用 Prototype.js）处理选择器和类名要容易得多。

单击此项目时，启用所有具有“mycontrols”类的项目。

```
$('containerDiv').select('.mycontrols').each(function(element){element.disabled=false}) 
```

# python - 通过 Django 管理站点添加数据时更改大小写（上/下）

> ID：825955
> 
> 赞同：7
> 
> 时间：2009-05-05T17:11:49.990
> 
> 标签：python, django, admin, case

我正在配置我的新项目的管理站点，我有点怀疑我应该怎么做，通过管理站点添加数据时点击“保存”，所有内容都转换为大写......

编辑：好的，我知道 .upper 属性，我做了一个视图，我知道该怎么做，但我想知道管理站点上是否有任何属性可用于字段配置：P

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-05T17:52:51.200

如果您的目标是在管理部分保存时仅将内容转换为大写，您将需要[创建一个具有自定义验证的表单以](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#adding-custom-validation-to-the-admin)更改大小写：

```
class MyArticleAdminForm(forms.ModelForm):
    class Meta:
        model = Article
    def clean_name(self):
        return self.cleaned_data["name"].upper() 
```

如果您的目标是始终具有大写的值，那么您应该[覆盖](http://docs.djangoproject.com/en/dev/topics/db/models/#overriding-predefined-model-methods)模型字段中的保存：

```
class Blog(models.Model):
    name = models.CharField(max_length=100)
    def save(self, force_insert=False, force_update=False):
        self.name = self.name.upper()
        super(Blog, self).save(force_insert, force_update) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-09T11:52:36.277

文档中更新的示例建议使用 args、kwargs 作为传递：

> Django 将不时扩展内置模型方法的功能，添加新参数。如果您在方法定义中使用 *args, **kwargs，则可以保证您的代码在添加这些参数时会自动支持它们。

```
class Blog(models.Model):
    name = models.CharField(max_length=100)
    tagline = models.TextField()

    def save(self, *args, **kwargs):
        do_something()
        super(Blog, self).save( *args, **kwargs) # Call the "real" save() method.
        do_something_else() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T17:40:47.940

你必须[覆盖 save()](http://docs.djangoproject.com/en/dev/topics/db/models/#overriding-predefined-model-methods)。文档中的一个示例：

```
class Blog(models.Model):
    name = models.CharField(max_length=100)
    tagline = models.TextField()

    def save(self, force_insert=False, force_update=False):
        do_something()
        super(Blog, self).save(force_insert, force_update) # Call the "real" save() method.
        do_something_else() 
```

# iphone - 如何使用 pagingEnabled=YES 设置 UIScrollView 的分页行为？

> ID：825967
> 
> 赞同：1
> 
> 时间：2009-05-05T17:15:08.937
> 
> 标签：iphone, uikit, uiscrollview

文档说：

> 如果该属性的值为 YES，则当用户滚动时，滚动视图会在视图边界的倍数处停止。默认值为 NO。

很好，当用户滚动时它会在视图边界的倍数处停止；）但是有多少倍数？那蜜蜂是怎么计算的？我有一个非常奇怪的行为。我有 15 张 50x50 的小图像垂直对齐。我如何设置它会在每滚动 50 个单位或每张图像时停止？它确实停在顶部一次，一次在中间，一次在最后。这不是我所期望的行为。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T18:51:27.910

它停在每个边界的倍数上。即，如果您的滚动视图的边界为 0,0,100,100，它将在每个 100 的倍数处停止，直到内容区域结束。假设原点为 0 (0*100)，单次滑动手势会将您发送到 0,100（如果未启用方向锁定，则为 100,0 或 100,100）。

要对此进行调试，我需要查看滚动视图的边界、内容矩形以及内容框架内所有子视图图像的框架。

我怀疑你的滚动视图滚动到它的边界倍数而不是你的子视图的框架 - 如果它们不匹配，你必须自己实现分页。

# session - 使用 FreePascal 在 KDE/Gnome 下检测进入/退出会话

> ID：825969
> 
> 赞同：0
> 
> 时间：2009-05-05T17:15:24.317
> 
> 标签：session, gnome, kde, freepascal, switch-user

在得到一个很好的答案后，我问了这个问题：[如何检测 Windows 中“切换用户”的 2 种状态](https://stackoverflow.com/questions/416313/how-do-i-detect-the-2-states-of-switch-user-in-windows)

我的目的是找出 KDE/Gnome 下的 Switch User 是否有类似的 API 调用，我可以用 FreePascal 监控。

如果不使用 FreePascal，至少在 C/C++ 中使用的相应 lib 条目

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T16:26:41.040

我很确定监控 DBUS 消息可以捕获有关会话进入和退出的消息。其实我不知道 FreePascal 是否提供 DBUS api。

一个肮脏的解决方案可以是执行和解析*/usr/bin/dbus-monitor*输出。

祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T12:27:36.537

是的，安装了一个 dbus 包，并且我在去年年底运行了示例。

有关示例，请参见 /packages/dbus/examples/busexample.pp

# mysql - MySQL 查询日志记录到 Syslog-ng 服务器

> ID：825973
> 
> 赞同：0
> 
> 时间：2009-05-05T17:15:46.297
> 
> 标签：mysql, logging, syslog

是否可以将查询记录到中央 syslog-ng 服务器？需要在现有的集中式日志服务器中存在 mysql 查询日志。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-17T14:49:26.093

我在 syslog-ng 客户端上有这个配置：

```
source s_mysql_instance_1 {
        pipe("mysqld-1.error.log" log_prefix("mysqlsrv-instance_1"));
        unix-stream ("/dev/log");
        internal();
};

source s_mysql_instance_2 {
        pipe("mysqld-2.error.log" log_prefix("mysqlsrv-instance_2"));
        unix-stream ("/dev/log");
        internal();
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-09T20:09:31.460

这个答案没有解决问题。该日志在 syslog-ng 服务器中出现了一段时间，并且在客户端或服务器中没有显示任何错误而停止。

它可能是客户端或服务器的 syslog-ng 中的错误超时参数，但我找不到任何东西:(

# c# - 如何将动画 gif 添加到按钮？

> ID：825990
> 
> 赞同：2
> 
> 时间：2009-05-05T17:19:08.973
> 
> 标签：c#, animation, button, gif, animated-gif

你能告诉我如何将动画 gif 添加到 c# 中的按钮。仅通过将 gif 添加到资源并设置为按钮图像效果不佳（下一帧出现在前一帧之上）。问题似乎在某种程度上 c# 如何处理透明度，但我不知道如何解决它。

提前致谢。

- - 编辑 - -

在玩了 gif 之后，问题在于 gif 的透明度。下一帧是在前一帧上绘制的，所以我想在动画中间变得透明的元素没有正确完成（它们仍然具有前一帧的颜色）。解决方案是在下一帧上创建白色区域以覆盖前一帧。白色是我的透明颜色，所以在那之后一切看起来都很好:)

我希望有人会看到它有用。快乐编程:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-04T21:09:01.203

只是给大家一个注释。如果在 .Image 属性上使用 Gif 动画而不是在 .BackGroundImage 属性上使用，则 Gif 动画将自动播放。以防万一有人这样尝试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T17:31:31.160

为此，您需要执行以下操作：

1.  将 BackGroundImageLayout 属性设置为 Center。此属性默认设置为平铺。

2.  将按钮的 Image 属性设置为动画 GIF。

这将起作用，因为我对其进行了测试，并且对我有用。

编辑：下面发布的设计器代码：

```
 this.Button4.BackgroundImageLayout = System.Windows.Forms.ImageLayout.Center;
 this.Button4.Image = (System.Drawing.Image)resources.GetObject("Button4.Image");
 this.Button4.Location = new System.Drawing.Point(220, 329);
 this.Button4.Name = "Button4";
 this.Button4.Size = new System.Drawing.Size(81, 68);
 this.Button4.TabIndex = 4;
 this.Button4.Text = "Button4";
 this.Button4.UseVisualStyleBackColor = true; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-21T09:26:20.067

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Media;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        SoundPlayer sp = new SoundPlayer(@"1.wav");
        SoundPlayer s = new SoundPlayer(@"2.wav");

        private System.Windows.Forms.Label[] arLabel;
        int temp = 10;
        int help = 0;
        int r = 0, b = 0, a, tem = 0;
        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {

        }

        private void button1_Click(object sender, EventArgs e)
        {
            f1();
        }

          private void arLabel_Click(object sender, System.EventArgs e)
        {
            Label myButton = (Label)sender;

            if (myButton.Text == "")
            {

                myButton.ForeColor = System.Drawing.Color.Red;

                sp.Play();
                temp = 1;

                myButton.Text = "x".ToString();
                help = 0;
                f3();
            }
            for (int i = 0; i < arLabel.Length; i++)
            {
                if (arLabel[i].Text != "x")
                    this.arLabel[i].ForeColor = System.Drawing.Color.Green;
            }

            s.Play();
//------------------------------------------------------------------------------------------------------------------------------------

            if (temp == 1)
            {
                if (arLabel[6].Text == "" && arLabel[0].Text == "x" || arLabel[8].Text=="x"&&arLabel[6].Text=="")
                    arLabel[6].Text = "o".ToString();
                else if (arLabel[4].Text == "")
                    arLabel[4].Text = "o".ToString();
                //------------------------------------------------------------------------------------------------------------------------------------

                else if (arLabel[0].Text == arLabel[1].Text && arLabel[2].Text == "")//
                    arLabel[2].Text = "o".ToString();
                else if (arLabel[0].Text == arLabel[2].Text && arLabel[1].Text == "")//
                    arLabel[1].Text = "o".ToString();
                else if (arLabel[1].Text == arLabel[2].Text && arLabel[0].Text == "")//
                    arLabel[0].Text = "o".ToString();
                //------------------------------------------------------------------------------------------------------------------------------------
                else if (arLabel[6].Text == arLabel[7].Text && arLabel[8].Text == "")
                    arLabel[8].Text = "o".ToString();
                else if (arLabel[6].Text == arLabel[8].Text && arLabel[7].Text == "")
                    arLabel[7].Text = "o".ToString();
                else if (arLabel[8].Text == arLabel[7].Text && arLabel[6].Text == "")
                    arLabel[6].Text = "o".ToString();
                //------------------------------------------------------------------------------------------------------------------------------------
                else if (arLabel[3].Text == arLabel[4].Text && arLabel[5].Text == "")
                    arLabel[5].Text = "o".ToString();
                else if (arLabel[3].Text == arLabel[5].Text && arLabel[4].Text == "")
                    arLabel[4].Text = "o".ToString();
                else if (arLabel[5].Text == arLabel[4].Text && arLabel[3].Text == "")
                    arLabel[3].Text = "o".ToString();
                //------------------------------------------------------------------------------------------------------------------------------------
                else if (arLabel[0].Text == arLabel[3].Text && arLabel[6].Text == "")
                    arLabel[6].Text = "o".ToString();
                else if (arLabel[0].Text == arLabel[6].Text && arLabel[3].Text == "")
                    arLabel[3].Text = "o".ToString();
                else if (arLabel[6].Text == arLabel[3].Text && arLabel[0].Text == "")
                    arLabel[0].Text = "o".ToString();

//------------------------------------------------------------------------------------------------------------------------------------

                else if (arLabel[1].Text == arLabel[4].Text && arLabel[7].Text == "")
                    arLabel[7].Text = "o".ToString();
                else if (arLabel[1].Text == arLabel[7].Text && arLabel[4].Text == "")
                    arLabel[4].Text = "o".ToString();
                else if (arLabel[7].Text == arLabel[4].Text && arLabel[1].Text == "")
                    arLabel[1].Text = "o".ToString();
//------------------------------------------------------------------------------------------------------------------------------------
                else if (arLabel[2].Text == arLabel[5].Text && arLabel[8].Text == "")
                    arLabel[8].Text = "o".ToString();
                else if (arLabel[8].Text == arLabel[5].Text && arLabel[2].Text == "")
                    arLabel[2].Text = "o".ToString();
                else if (arLabel[2].Text == arLabel[8].Text && arLabel[5].Text == "")
                    arLabel[5].Text = "o".ToString();
                //------------------------------------------------------------------------------------------------------------------------------------
                else if (arLabel[0].Text == arLabel[4].Text && arLabel[8].Text == "")
                    arLabel[8].Text = "o".ToString();
                else if (arLabel[0].Text == arLabel[8].Text && arLabel[4].Text == "")
                    arLabel[4].Text = "o".ToString();
                else if (arLabel[8].Text == arLabel[4].Text && arLabel[0].Text == "")
                    arLabel[0].Text = "o".ToString();
                //------------------------------------------------------------------------------------------------------------------------------------
                else if (arLabel[2].Text == arLabel[4].Text && arLabel[6].Text == "")
                    arLabel[6].Text = "o".ToString();
                else if (arLabel[2].Text == arLabel[6].Text && arLabel[4].Text == "")
                    arLabel[4].Text = "o".ToString();
                else if (arLabel[4].Text == arLabel[6].Text && arLabel[2].Text == "")
                    arLabel[2].Text = "o".ToString();
                //------------------------------------------------------------------------------------------------------------------------------------
                else 
                    for (int i = 0; i < 9; i++)
                    {
                        if (arLabel[8].Text == "")
                        {
                            arLabel[8].Text = "o".ToString();
                            break;
                        }
                        else if (arLabel[7].Text == "")
                        {
                            arLabel[7].Text = "o".ToString();
                            break;
                        }
                        else if (arLabel[6].Text == "")
                        {
                            arLabel[6].Text = "o".ToString();
                            break;
                        }

 //------------------------------------------------------------------------------------------------------------------------------------
                        else if (arLabel[i].Text == "")
                        {
                            this.arLabel[i].ForeColor = System.Drawing.Color.Red;
                            arLabel[i].Text = "o";
                            break;
                        }

                    }

            }
            temp = 0;
            help = 1;
            f3();

        }

        private void f1()
        {
            this.arLabel = new Label[9];
            int b = 400;
            int c = 40;
            for (int i = 0; i < arLabel.Length; i++)
            {
                if (i == 3 || i == 6)
                {
                    c = c + 200;
                    b =400;
                }
                this.arLabel[i] = new Label();
                this.arLabel[i].Location = new System.Drawing.Point(b, c);
                this.arLabel[i].Size = new System.Drawing.Size(200, 200);
                this.arLabel[i].TabIndex = i;
                this.arLabel[i].BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;
                this.arLabel[i].Text = "".ToString();
               arLabel[i].Click += new System.EventHandler(this.arLabel_Click);
                this.Controls.Add(arLabel[i]);
                this.arLabel[i].Font = new System.Drawing.Font("Modern No. 20", 120.74999F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
                this.arLabel[i].ForeColor = System.Drawing.Color.Green;
                arLabel[i].Visible = true;
                this.arLabel[i].BackColor = System.Drawing.Color.Khaki;
                this.arLabel[i].BorderStyle = System.Windows.Forms.BorderStyle.Fixed3D;
                b = b + 200;
            }
        }
        private void f3()
        {
            if (arLabel[0].Text == arLabel[1].Text && arLabel[2].Text == arLabel[1].Text && arLabel[1].Text != "".ToString())
            {
                temp = 0;
                f2();
            }
            if (arLabel[3].Text == arLabel[4].Text && arLabel[3].Text == arLabel[5].Text && arLabel[3].Text != "".ToString())
            {
                temp = 0;
                f2();
            }
            if (arLabel[6].Text == arLabel[7].Text && arLabel[8].Text == arLabel[6].Text && arLabel[6].Text != "".ToString())
            {
                temp = 0;
                f2();
            }
            // if (arLabel[0].Text == arLabel[3].Text && arLabel[0].Text == arLabel[6].Text && arLabel[6].Text != "".ToString())
            // f2();
            if (arLabel[0].Text == arLabel[3].Text && arLabel[0].Text == arLabel[6].Text && arLabel[6].Text != "".ToString())
            {
                f2();
                temp = 0;
            }
            if (arLabel[1].Text == arLabel[4].Text && arLabel[4].Text == arLabel[7].Text && arLabel[7].Text != "".ToString())
            {
                temp = 0;
                f2();
            }
            if (arLabel[2].Text == arLabel[5].Text && arLabel[8].Text == arLabel[2].Text && arLabel[2].Text != "".ToString())
            {
                temp = 0;
                f2();
            }
            if (arLabel[0].Text == arLabel[4].Text && arLabel[4].Text == arLabel[8].Text && arLabel[8].Text != "".ToString())
            {
                temp = 0;
                f2();
            }
            if (arLabel[2].Text == arLabel[4].Text && arLabel[6].Text == arLabel[4].Text && arLabel[4].Text != "".ToString())
            {
                temp = 0;
                f2();
            }
        }
        private void f2()
        {
            if (help == 1)
            {

                r++;
               // label4.Text = r.ToString();
                MessageBox.Show("THE is o");
                f6();
            }
            else
            {

                b++;

              //  label5.Text = b.ToString();
                MessageBox.Show("THE is x");
            }

            for (int i = 0; i < arLabel.Length; i++)

                arLabel[i].Text = "".ToString();
            f6();
        }
        private void f6()
        {
            Random number = new Random();
            a = number.Next(0, 8);
            this.arLabel[a].ForeColor = System.Drawing.Color.Green;
            arLabel[a].Text = "o".ToString();

            s.PlaySync();

        }
    }

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-10T12:53:36.513

我已经开始工作了。

两件事情中的一件对我有用：

1.  我重新编辑了 gif，将属性添加到每一帧以取消绘制自身。

2.  我已经更改了 VS 的版本（我使用的是免费的专业学生版，现在我使用的是 MSDN 订阅的一个）

感谢您的输入。它引导我得出结论，VS 本身可能有问题，而不是我的编程风格:)***********