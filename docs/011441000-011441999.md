# StackOverflow 问答 11441000-11441999

# php - Javascript 发送错误的值

> ID：11441006
> 
> 赞同：2
> 
> 时间：2012-07-11T20:31:59.983
> 
> 标签：php, mysql, ajax, jquery

我正在尝试使用表单中的 ajax 将值发送到 mysql 数据库。我通过获取表单的父文章然后获取带有 id="email" 的子元素来选择值，如您在此处看到的...

```
var email = $(this).parent("article").children("#email").val() //gets the user's email 
```

但是，当我将数据发送到 php 文件以上传到 mysql 数据库时，它似乎做错了什么，而不是存储的函数（如下所示）中键入的值......这里发生了什么！？

```
function (a) {var c,d,e,g=this[0];{if(!!arguments.... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:33:49.220

你可以试试`find()`方法：

> .children() 方法与 .find() 的不同之处在于 .children() 仅沿 DOM 树向下移动一个级别，而 .find() 也可以向下遍历多个级别以选择后代元素（孙子等）。

```
var email = $(this).parent("article").find("#email").val() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:35:33.977

似乎有点混乱。您正在使用#email，这意味着一个id，您在页面上只能有一个。jQuery 将识别主题标签并默认使用本机“getElementById”浏览器方法。

所以这：

```
var email = $(this).parent("article").children("#email").val() 
```

可以转换成这样：

```
var email = $("#email").val() 
```

# asp.net-mvc-3 - 使用 ACS 身份验证对 ASP.NET MVC 3 应用程序进行负载测试

> ID：11441018
> 
> 赞同：0
> 
> 时间：2012-07-11T20:32:45.383
> 
> 标签：asp.net-mvc-3, visual-studio-2010, azure, load-testing, acs

我有一个使用 Windows Azure ACS 进行身份验证的 ASP.NET MVC 3 应用程序。我正在寻找性能和负载测试这个应用程序。如何创建将通过 ACS 身份验证过程的测试。我已经完成了记录性能测试，然后将其添加到有 25 个用户的负载测试中，但在同时运行时似乎失败了。是否有一些技巧来处理登录的并发性。

我相当确定问题最终是测试是对令牌进行硬编码，并且令牌在某些时候无效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T06:00:06.223

在测试时，您可以延长令牌的生命周期。默认值为 600 秒（10 分钟），这显然在您记录的时间和测试运行的时间之间过期。令牌生命周期是依赖方的设置：

![ACS 令牌生命周期](../Images/2fb4f71db11168e672ba74ed6606bf87.png)

这个 migt 可以帮助您解决问题。只是不要忘记，在生产环境中使用长寿命令牌是不可取的！

# jquery - 仅在 Firefox 中的 JQuery AJAX 异常：“无法在层次结构中的指定点插入节点”（HierarchyRequestError）

> ID：11441020
> 
> 赞同：5
> 
> 时间：2012-07-11T20:32:48.253
> 
> 标签：jquery, ruby-on-rails, ajax, ruby-on-rails-plugins

非常奇怪的问题：我有一个由两部分组成的下拉菜单，在其中选择一个州将添加第二个下拉菜单，为您提供该州的 MSA 区域列表。

这是使用对控制器的 JQuery Get 请求完成的，该控制器返回 Select 下拉列表中的区域列表，例如

```
jQuery(function($) {
  // when the #area_state field changes
  $("#area_state").change(
    function() {
      // make a call and replace the content
      var state = $('select#area_state :selected').val();
      if(state == "") state="0";
      jQuery.get(
        '/getmsas/' + state,
        function(data){ $("#msas").html(data); }
      )
    return false;
    }
  );
}) 
```

注意 - 此代码改编自此处的教程：[http ://www.petermac.com/rails-3-jquery-and-multi-select-dependencies/](http://www.petermac.com/rails-3-jquery-and-multi-select-dependencies/)

这在 Chrome 和 IE 中运行良好，但在 Firefox (13.0.1) 中它不起作用，产生两个错误：

```
Error: junk after document element
Source File: http://localhost:3000/getmsas/Connecticut
Line: 2, Column: 1
Source Code:
<select id="area_msa" name="area[msa]"><option value="">Select Area (Optional)</option> 
```

和

```
Error: uncaught exception: [Exception... "Node cannot be inserted at the specified point
in the hierarchy"  code: "3" nsresult: "0x80530003 (HierarchyRequestError)"  location:   
"http://localhost:3000/assets/jquery.js?body=1 Line: 6498"] 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-11T22:20:39.087

所以我强行解决了这个问题。我真的不明白为什么这个问题是特定于 Firefox 的，但可能会调查它。

我可以通过为 dataType（get 方法的最后一个参数）添加一个参数来明确地将其声明为 html 来解决此问题。

Get 在此处的 JQuery 文档中进行了描述：http: [//api.jquery.com/jQuery.get/](http://api.jquery.com/jQuery.get/)

```
jQuery.get( url [, data] [, success(data, textStatus, jqXHR)] [, dataType] ) 
```

因此，有效的代码是添加“html”作为 dataType 参数：

```
jQuery(function($) {
  // when the #area_state field changes
  $("#area_state").change(
    function() {
      // make a call and replace the content
      var state = $('select#area_state :selected').val();
      if(state == "") state="0";
      jQuery.get(
        '/getmsas/' + state,
        function(data){ $("#msas").html(data); },
        "html"
        // ABOVE LINE IS THE FIX
      )
    return false;
    }
  );
}) 
```

同样，我需要调查为什么这是 Firefox 特有的；这让我发疯了，所以希望它可以帮助别人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:42:17.643

不确定这是否只是不完整的复制粘贴，但

```
<select id="area_msa" name="area[msa]"><option value="">Select Area (Optional)</option> 
```

需要关闭选择标签，否则你的 html 的其余部分嵌套在选择元素中......这很糟糕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-02T19:15:42.623

我只在 FF 中遇到了同样的问题。我的 Servlet 正在返回内容类型为“文本”的文本。FF 将此解释为 text/xml 并尝试在正文中插入 xml - 因此出现错误

我将内容类型更改为 text/plain - 一切都很好

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-25T14:50:27.420

我已经解决了这个添加

`header('Content-Type: text/html; charset=utf-8');`

在 php 中获取文件。当标头未正确设置时，会发生错误（当从一台服务器移动到另一台服务器时，在旧服务器上它工作正常，在新服务器上工作正常，直到我设置标头）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-02T10:57:55.950

我遇到了同样的问题，并且仅在响应为空时发生，例如，我期待一个包含记录的表，但没有任何内容可显示。

# linux - 在 xubuntu 上自动启动/运行“./abcd”文件/程序

> ID：11441025
> 
> 赞同：0
> 
> 时间：2012-07-11T20:32:59.157
> 
> 标签：linux, autorun, xubuntu

如何为必须像这样启动的程序创建自动启动条目：

```
/home/user/Desktop/app/./applicationname 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:36:01.293

编辑`/home/user/.bash_profile`并添加一行，说`/home/user/Desktop/app/./applicationname &`应该这样做。

# windows - 在 Windows 7 上使用 vbs 更改 IP 地址

> ID：11441030
> 
> 赞同：0
> 
> 时间：2012-07-11T20:33:32.277
> 
> 标签：windows, shell, windows-7, vbscript

我曾尝试使用此脚本更改 windows xp 上的 ipaddress，并且效果很好。

```
Dim strIPAddress
Dim strSubnetMask
Dim strGateway
Dim intGatewayMetric
Dim strDns1
Dim strDns2

strIPAddress = "10.10.10.50"
strSubnetMask = "255.255.255.0"
strGateway = "10.10.10.1"
intGatewayMetric = 1
strDns1 = "10.10.10.9"
strDns2 = "10.10.10.10"

Set objShell = WScript.CreateObject("Wscript.Shell")
objShell.Run "netsh interface ip set address name=""Local Area Connection"" static " & strIPAddress & " " & strSubnetMask & " " & strGateway & " " & intGatewayMetric, 0, True
objShell.Run "netsh interface ip set dns name=""Local Area Connection"" static "& strDns1, 0, True
objShell.Run "netsh interface ip add dns name=""Local Area Connection"" addr="& strDns2, 0, True
Set objShell = Nothing
WScript.Quit 
```

请问我需要改变什么才能让它与 Windows 7 一起工作

谢谢克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T20:49:43.797

```
Set WshShell = WScript.CreateObject("WScript.Shell")
If WScript.Arguments.length = 0 Then
Set ObjShell = CreateObject("Shell.Application")
ObjShell.ShellExecute "wscript.exe", """" & _
WScript.ScriptFullName & """" &_
 " RunAsAdministrator", , "runas", 1
Else
end if 

Dim strIPAddress
Dim strSubnetMask
Dim strGateway
Dim intGatewayMetric
Dim strDns1
Dim strDns2

strIPAddress = "10.0.0.25"
strSubnetMask = "255.255.255.0"
strGateway = "10.0.0.1"
intGatewayMetric = 1
strDns1 = "8.8.8.8"
strDns2 = "10.0.0.1"

Set objShell = WScript.CreateObject("Wscript.Shell")
objShell.Run "netsh interface ip set address name=""Local Area Connection"" static " & strIPAddress & " " & strSubnetMask & " " & strGateway & " " & intGatewayMetric, 0, True
objShell.Run "netsh interface ip set dns name=""Local Area Connection"" static "& strDns1, 0, True
objShell.Run "netsh interface ip add dns name=""Local Area Connection"" addr="& strDns2, 0, True
Set objShell = Nothing
WScript.Quit 
```

# javascript - .back 和 .pushState - 两个历史的故事

> ID：11441034
> 
> 赞同：6
> 
> 时间：2012-07-11T20:34:07.297
> 
> 标签：javascript, html, history

这不是一个问题，而是一个有趣问题的结果。这也是一种“从失败中吸取教训”

我正在尝试为 IE 的 HTML5 历史鸭拳编写单元测试（使用 window.hash 作为状态维护的替代品）。鸭拳按预期工作，在用户测试期间，我在 IE、Chrome 和 Firefox 中获得了一致的结果。

问题出现的地方是单元测试。在它们中，我对 history.pushState()、.replaceState、.back() 和 .forward() 进行了各种组合。这些在 Firefox 和 IE 中运行良好，但 Chrome 给了我完全不一致的结果。下面的答案解释了原因。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-11T20:34:08.573

考虑以下：

```
var originalPath = window.location.pathname.toString();
history.pushState({ value: 'Foo' }, '', 'state-1');
history.pushState({ value: 'Bar' }, '', 'state-2');

history.pushState({ value: 'Baz' }, '', 'state-3');
history.back();
history.back();
console.log(history.state.value);
//So we can hit refresh and see the results again...
setTimeout(function () {
    history.replaceState(null, '', originalPath);
}, 250); 
```

人们会期望这段代码返回“Foo”——在 Firefox 和我的 IE 鸭拳中，这正是它所做的——但在 Chrome 中，它以“Baz”响应。

经过一番调查，我解决了问题：IE和Firefox同步更新历史记录，如果需要加载任何页面，则异步进行。Chrome 似乎立即进入异步状态。

证据：

```
window.onpopstate = function () {
    console.log('ping');
}
history.pushState({ value: 'Foo' }, '', 'state-1');
history.back();
console.log('pong'); 
```

在 Firefox 中，这会返回 'ping'；'pong' - 表示事件是作为 history.back() 调用的一部分分派的。在 Chrome 中，这会返回 'pong'；'ping' - 表示事件被放置在队列中等待调度。

如果这个事件分派模型没有被用来管理历史和位置对象的状态，这不会那么糟糕 - 但显然它是。

```
window.onpopstate = function () {
    console.log('Event...', history.state, window.location.pathname.toString());
}
history.pushState({ value: 'Foo' }, '', 'state-1');
history.back();
console.log('Inline...', history.state, window.location.pathname.toString()); 
```

这是一个有趣的怪癖，需要使用 jQuery Deferred 链才能正常工作以进行我的单元测试。我对此并不特别高兴，但你能做什么？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-10T16:28:06.093

为了在单元测试中处理异步返回事件，我使用[了 HistoryJS](https://github.com/browserstate/history.js/)和[Jasmine](http://www.htmlgoodies.com/beyond/javascript/test-asynchronous-methods-using-the-jasmine-runs-and-waitfor-methods.html)。这是一个更新历史事件中的计数器以跟踪 chrome 何时处理事件和 Jasmine 的异步支持以阻止单元测试的情况，直到我们看到事件更改：

增加计数器：

```
History.Adapter.bind(window, 'statechange', function() {

    // Increment the counter
    window.historyEventCounter++;

}); 
```

Jasmine 异步单元测试。waitsFor 将阻塞，直到历史事件发生：

```
describe('back navigation', function () {
    it('should change url', function () {

        var initialHistoryEventCount;

        // Cache the initial count

        runs(function() {
            initialHistoryEventCount = window.historyEventCounter;
            History.back();
        });

        // Block until the event counter changes

        waitsFor(function() {
            return (initialHistoryEventCount !== app.historyEventCounter);
        }, "The page should be navigated back", 1000);

        // Now confirm the expected back behaviour. Event failures will time-out.

        runs(function() {
            expect(window.location.href).toEqual("http:// my back url");

            // ... more tests about the page state
        });
    }
} 
```

# r - 导入具有多位数字的（64位）整数时，R中出现奇怪的错误

> ID：11441035
> 
> 赞同：8
> 
> 时间：2012-07-11T20:34:08.267
> 
> 标签：r, precision, digits, read.csv

我正在导入一个 csv，它有一列包含很长的整数（例如：2121020101132507598）

> a<-read.csv('temp.csv',as.is=T)

当我将这些整数作为字符串导入时，它们会正确通过，但是当作为整数导入时，最后几位数字会发生变化。我不知道发生了什么...

> 1 "4031320121153001444" 4031320121153001472
> 2 "4113020071082679601" 4113020071082679808
> 3 "4073020091116779570" 4073020091116779520
> 4 "2081720101128577687" 2081720101128577792
> 5 "4041720081087539887" 4041720081087539712
> 6 "4011120071074301496" 4011120071074301440
> 7 "4021520051054304372" 4021520051054304256
> 8 "4082520061068996911" 4082520061068997120
> 9 "4082620101129165548" 4082620101129165312

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-11T21:02:06.650

正如其他人所指出的，您不能表示那么大的整数。但是 R 并没有将这些值读入整数，而是将它们读入双精度数字。

双精度只能准确地将数字表示到 ~16 位，这就是为什么您看到数字在 16 位后四舍五入的原因。有关可能的解决方案，请参阅[gmp](http://cran.r-project.org/web/packages/gmp/index.html)、[Rmpfr](http://cran.r-project.org/web/packages/Rmpfr/index.html)和[int64](http://cran.r-project.org/web/packages/int64/index.html)包。虽然我在其中的任何一个中都没有看到从文件中读取的功能，但也许您可以通过查看它们的来源来制作一些东西。

更新：这是将文件放入`int64`对象的方法：

```
# This assumes your numbers are the only column in the file
# Read them in however, just ensure they're read in as character
a <- scan("temp.csv", what="")
ia <- as.int64(a) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-11T21:13:16.847

R 的最大整数值约为 2E9。正如@Joshua 在另一个答案中提到的那样，一个潜在的解决方案是 int64 包。

而是将值作为字符导入。然后转换为类型[int64](http://cran.r-project.org/web/packages/int64)。

```
require(int64)
a <- read.csv('temp.csv', colClasses = 'character', header=FALSE)[[1]]
a <- as.int64(a)
print(a)
[1] 4031320121153001444 4113020071082679601 4073020091116779570
[4] 2081720101128577687 4041720081087539887 4011120071074301496
[7] 4021520051054304372 4082520061068996911 4082620101129165548 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-11T20:35:52.757

您根本无法表示那么大的整数。看

```
.Machine 
```

我的盒子上有

```
$integer.max
[1] 2147483647 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-11T20:37:35.253

32 位有符号整数的最大值为 2,147,483,647。你的数字要大得多。

尝试将它们作为浮点值导入。

在 R 或任何其他语言中处理浮点运算时，有一些注意事项需要注意：

[http://blog.revolutionanalytics.com/2009/11/floatingpoint-errors-explained.html](http://blog.revolutionanalytics.com/2009/11/floatingpoint-errors-explained.html)

[http://blog.revolutionanalytics.com/2009/03/when-is-a-zero-not-a-zero.html](http://blog.revolutionanalytics.com/2009/03/when-is-a-zero-not-a-zero.html)

[http://floating-point-gui.de/basic/](http://floating-point-gui.de/basic/)

# ruby-on-rails - Rails 2错误设置Time.zone

> ID：11441037
> 
> 赞同：1
> 
> 时间：2012-07-11T20:34:12.763
> 
> 标签：ruby-on-rails, session, timezone

我有以下设置：

'配置/环境.rb'

```
config.time_zone = 'UTC' 
```

'application_controller.rb'

```
before_fiter :set_timezone

def set_timezone
  session[:time_zone] = current_user.time_zone # => 'Brasilia'
  Time.zone = session[:time_zone] 
end 
```

但是，在我看来，当我尝试：

```
<%= Time.zone.now %> 
```

它返回我在“environment.rb”上设置的时区，而不是会话值中存在的时区。

任何想法？

# php - 如何获取当前 VM product_id 以在我的查询中使用

> ID：11441039
> 
> 赞同：1
> 
> 时间：2012-07-11T20:34:16.763
> 
> 标签：php, joomla, virtuemart

我需要显示`product`表格中的产品信息。我还有另一张桌子，`manufacturer`.

我有一个查询，通过连接这两个表来显示产品制造商。

如何获取`WHERE`表达式中产品的当前id？请在下面查看我的查询

```
$query = "SELECT vmm.mf_name,vmm.mf_desc"
  . "FROM xxx_virtuemart_manufacturers_fr_fr AS vmm, 
          xxx_virtuemart_product_manufacturers as vmp"
. "WHERE vmm.virtuemart_manufacturer_id=vmp.virtuemart_manufacturer_id
      AND vmp.virtuemart_product_id=1 LIMIT 0, 30"; 
```

从上面的查询中，`product_id`是 1。但我想要一个动态变量`virtuemart_product_id`。

有什么解决办法吗？请帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:38:28.813

只需将它绑定到一个变量

```
$result = mysql_fetch_assoc($query);

$id = $result['id']; 
```

尽管您应该使用 mysqli 或 PDO，但希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:39:31.853

您可以为该变量使用 php 数组，并循环对每个值运行查询的数组。如果您知道可能的所有值，则可以使用`vmp.virtuemart_product_id IN ('1', '2', '3', ...)` 您也可以进行子查询，例如`vmp.virtuemart_product_id = (SELECT value FROM ...)`

对不起。我从您的问题中所理解的内容中尽可能多地回答了。

# three.js - 您可以在纹理图像上替换黑色之类的颜色吗？

> ID：11441040
> 
> 赞同：1
> 
> 时间：2012-07-11T20:34:20.420
> 
> 标签：three.js

我有一个高分辨率的 jpg 来制作地球上的云。但是，由于它是 jpg（找不到好的 PNG 格式），我想看看是否有办法去除黑色，使其透明：这是图片：[http ://www.benmarshall.me/projects/playground/ 072012/assets/imgs/earth-clouds-high.jpg](http://www.benmarshall.me/projects/playground/072012/assets/imgs/earth-clouds-high.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T18:56:15.860

您可以编写一个着色器，在其中将纹理作为统一发送，而 UV 作为变量发送。在片段程序中，放置一个 if 子句，将黑色 (0.0, 0.0, 0.0, 1.0) 替换为您选择的颜色。对于透明度，更改 alpha 值（vec4 中的最后一个值）- 0.0 是完全透明的，1.0 是完全不透明的。希望这可以帮助

# python - 在 Python 中编写一个上下文管理器，它本身使用 with 语句

> ID：11441042
> 
> 赞同：22
> 
> 时间：2012-07-11T20:34:32.883
> 
> 标签：python, contextmanager

我正在尝试编写一个使用其他上下文管理器的上下文管理器，因此客户不需要知道整个配方，只需要知道我正在呈现的界面。我不能这样做`@contextmanager`——如果你被异常打断，调用后的代码`yield`不会被执行，所以我需要使用基于类的管理器。

这是一个小示例脚本：

```
from contextlib import contextmanager
import pprint

d = {}

@contextmanager
def simple(arg, val):
    print "enter", arg
    d[arg] = val
    yield
    print "exit", arg
    del d[arg]

class compl(object):
    def __init__(self, arg, val):
        self.arg=arg
        self.val=val

    def __enter__(self):
        with simple("one",1):
            with simple("two",2):
                print "enter complex", self.arg
                d[self.arg] = self.val

    def __exit__(self,*args):
        print "exit complex", self.arg
        del d[self.arg]

print "before"
print d
print ""

with compl("three",3):
    print d
    print ""

print "after"
print d
print "" 
```

输出如下：

```
before
{}

enter one
enter two
enter complex three
exit two
exit one
{'three': 3}

exit complex three
after
{} 
```

我希望它输出这个：

```
before
{}

enter one
enter two
enter complex three
{'one': 1, 'three': 3, 'two': 2}

exit complex three
exit two
exit one
after
{} 
```

有没有办法告诉基于类的上下文管理器将自己与其他上下文管理器一起包装？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-11T20:58:16.133

```
@contextmanager
def compl(arg, val):
    with simple("one",1):
        with simple("two",2):
            print "enter complex", arg 
            try:
                d[arg] = val
                yield
            finally:
                del d[arg]
                print "exit complex", arg 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-02-09T00:51:42.493

你写道，“我不能使用@contextmanager 来做到这一点——如果你被异常打断，yield 调用之后的代码不会被执行。” 如果你有必须运行的代码，你可以把它放在一个`try/finally`块中。

```
import contextlib

@contextlib.contextmanager
def internal_cm():
    try:
        print "Entering internal_cm"
        yield None
        print "Exiting cleanly from internal_cm"
    finally:
        print "Finally internal_cm"

@contextlib.contextmanager
def external_cm():
    with internal_cm() as c:
        try:
            print "In external_cm_f"
            yield [c]
            print "Exiting cleanly from external_cm_f"
        finally:
            print "Finally external_cm_f"

if "__main__" == __name__:
    with external_cm() as foo1:
        print "Location A"
    print
    with external_cm() as foo2:
        print "Location B"
        raise Exception("Some exception occurs!!") 
```

输出：

```
Entering internal_cm
In external_cm_f
Location A
Exiting cleanly from external_cm_f
Finally external_cm_f
Exiting cleanly from internal_cm
Finally internal_cm

Entering internal_cm
In external_cm_f
Location B
Finally external_cm_f
Finally internal_cm
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "C:\Anaconda\lib\site-packages\spyderlib\widgets\externalshell\sitecustomize.py", line 540, in runfile
    execfile(filename, namespace)
  File "C:\untitled0.py", line 35, in <module>
    raise Exception("Some exception occurs!!")
Exception: Some exception occurs!! 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-11T20:59:14.810

您正在做的事情的问题在于，`with`在您的`__enter__`调用中使用时，当您进入包装上下文管理器时，您既进入又离开包装的上下文管理器。如果您想编写自己的上下文管理器，当您进入包装器时进入包装的上下文管理器，然后在您离开时退出它们，您必须手动调用包装的上下文管理器的函数。您可能还需要担心异常安全性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-10-01T14:49:27.597

如果您根据问题的措辞看到这个答案，这里是解决方案的摘要

```
@contextmanager
def your_custom_context_manager():
    with open(...) as f:
       # do your thing here, e.g. have an `if` statement, or another `with` statement
       yield f  # this is where your new context manager will start from

with your_custom_context_manager() as f:
    # do your stuff 
```

# android - Android IPC 参考

> ID：11441048
> 
> 赞同：0
> 
> 时间：2012-07-11T20:34:48.120
> 
> 标签：android, ipc

我正在使用自定义 ROM 的 Android 框架。出于某种原因，我需要通过引用将对象发送到另一个应用程序，而不是通过克隆数据。不想要 AIDL 或意图，因为他们需要通过 Parcelable 或 Json 复制数据。

像这样：

```
App1
void func1(TextView t)
{
   App2.func2(t);
}

App2
void func2(TextView t)
{
   String s=t.toString();
} 
```

猜测发送引用是可能的，因为我听说 JVM 中没有进程的概念，所以没有进程的边界。可能吗？如果没有，可以在 JNI 下使用 C++ 共享内存完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:40:54.133

Android 有自己的虚拟机，称为 Dalvik，与 JVM 不同，Dalvik 在 DalvikVM（进程）的不同实例中运行不同的应用程序。因此，在 Android 中有几种 IPC 机制（Binder 就是其中之一）。

在您的情况下，您需要使用 Ashmem。这是一种共享内存，但专门用于 Android。我在这方面只有理论知识，从未亲自尝试过。

[这](http://www.androidenea.com/2010/03/share-memory-using-ashmem-and-binder-in.html)是一篇如何创建共享内存区域的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-30T10:19:55.413

不，您不能拥有相同的引用，唯一的方法是通过各种 IPC 机制复制对象，但引用会有所不同，因为它们是 2 个无法共享内存的独立进程。

# android - SeekBar setThumb(null) 崩溃 NullPointerException

> ID：11441050
> 
> 赞同：0
> 
> 时间：2012-07-11T20:34:51.020
> 
> 标签：android, android-widget, seekbar

所以我有一个 SeekBar 在下载文件时会填满。下载完成后，填充的 SeekBar 就会消失。我运行 setThumb(null) 方法来填充它，而不是只显示一个拇指图标。好吧，现在使用较新的操作系统，此方法会使用 NullPointerException 使程序崩溃。我将它设置为实际的可绘制对象，但它在开始时填满了我不想要的一半。当我根本不竖起拇指时，它显示出一个丑陋的小东西。你能帮忙的话，我会很高兴。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:42:16.167

你可以做两件事：

*   使用 a [`ProgressBar`](http://developer.android.com/reference/android/app/ProgressDialog.html)，而不是 a`SeekBar`
*   将拇指可绘制对象设置为透明可绘制对象（[`ColorDrawable`](http://developer.android.com/reference/android/R.color.html#transparent)或透明图像）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T18:58:05.857

所以解决这个问题的方法是将它变成一个 ProgressBar（感谢 Romain Guy 和 MH），然后改变它的样式。这个网站基本上解释了它并且非常有帮助：[http ://android-er.blogspot.com/2010/11/progressbar-running-in-asynctask.html](http://android-er.blogspot.com/2010/11/progressbar-running-in-asynctask.html)

# php - PDO 不在表中插入多于一行

> ID：11441054
> 
> 赞同：1
> 
> 时间：2012-07-11T20:35:07.993
> 
> 标签：php, mysql, sql, pdo

我无法将图像数据插入我的数据库。我有一张桌子叫`images`. 当使用 PHPMyAdmin 转储时，它看起来像这样：

```
CREATE TABLE IF NOT EXISTS `images` (
  `id` int(11) NOT NULL,
  `orig_name` varchar(255) COLLATE utf8_unicode_ci NOT NULL,
  `hash` varchar(6) COLLATE utf8_unicode_ci NOT NULL,
  `filename` varchar(12) COLLATE utf8_unicode_ci NOT NULL,
  `uploaded` datetime NOT NULL,
  `views` int(11) NOT NULL DEFAULT '0',
  `album_id` int(11) DEFAULT NULL,
  `user_id` int(11) DEFAULT NULL,
  `server_id` int(11) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `user_id` (`user_id`),
  KEY `server_id` (`server_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; 
```

这是我用来插入行的代码：

```
// Database connection
$db = new PDO('mysql:host=localhost;dbname=testdb', 'root', '');                  

// some code...

$st = $db->prepare('INSERT INTO `images` (orig_name, hash, filename, uploaded, server_id)
                    VALUES (?, ?, ?, ?, (SELECT `id` FROM `servers` WHERE `name` = ?))');
$st->execute(array($origName, $fileHash, $filename, date('c'), $server));

// more code...

// Database cleanup
$st = null;
$db = null; 
```

该脚本不返回任何错误，并且可以完美地插入第一行。如果脚本再次运行，它将无法在表中插入更多行`images`。我看不出它为什么会这样，每次进入每个字段的数据都是唯一的（server_id 字段除外）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:42:48.120

您的`id`字段未设置为 auto_increment。

将添加您发布的第一条记录，其中 NULL 为`id`; 不会添加第二条记录，因为已经有一条以 NULL 作为主键的记录，所以它会失败 - 你在代码中没有任何错误检查，所以它不会打印出它得到的错误背部。

# c# - 如何更改 XNA 中的色调？

> ID：11441055
> 
> 赞同：4
> 
> 时间：2012-07-11T20:35:10.477
> 
> 标签：c#, colors, xna, argb

我有一个颜色类`Microsoft.Xna.Framework.Color`。如何更改其色调（或获得色调略有不同的新颜色）。我应该将其转换为`System.Drawing.Color`，然后以某种方式更改并转换回来吗？我在任何地方都找不到任何有用的信息。

**编辑** 示例：我有红色 R:255、G:0、B:0。现在我想获得更多的橙色。然后，如果我得到这种颜色并再次转换它，我会得到更多的橙色，然后经过一些转换，我会变成黄色、绿色等。我不知道每种颜色的 ARGB 的确切值，我也不知道需要他们。我只需要将颜色的色调改变一些因素（例如 10 度）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T20:44:28.327

您应该使用[A](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.color.a%28v=xnagamestudio.35%29.aspx) [R](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.color.r%28v=xnagamestudio.35%29.aspx) [G](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.color.g%28v=xnagamestudio.35%29.aspx) [B](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.color.b%28v=xnagamestudio.35%29.aspx)属性并更改值以获得不同的 nyansers。

例如：

```
Color color = new Color(0,0,0);
//Then you can change the argb properties:
color.A = 10;
color.R = 15;
color.G = 9;
color.B = 25; 
```

* * *

如果我理解你需要这样的东西：

```
public static class Utilities
{
    public static void Increase(this Color color, int value)
    {
        if(color.R >= color.G && color.R >= color.B)
           color.R += value;
        else if(color.G >= color.R && color.G >= color.B)
           color.G += value;
        else
           color.B += value;
    }

    public static void Decrease(this Color color, int value)
    {
        if(color.R <= color.G && color.R <= color.B)
           color.R -= value;
        else if(color.G <= color.R && color.G <= color.B)
           color.G -= value;
        else
           color.B -= value;
    }
} 
```

* * *

然后：

```
Color myColor = new Color(10,0,0);
myColor.Increase(10);
//or
myColor.Decrease(10); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-20T04:56:00.567

我做了一些研究，发现这篇文章有 C++ 代码：

[http://www.cs.rit.edu/~ncs/color/t_convert.html](http://www.cs.rit.edu/~ncs/color/t_convert.html)

我已将代码修改为 C#，添加了 IncreaseHueBy 方法，并修复了一些错误：

```
 public static void IncreaseHueBy(ref Color color, float value, out float hue)
 {
     float h, s, v;

     RgbToHsv(color.R, color.G, color.B, out h, out s, out v);
     h += value;

     float r, g, b;

     HsvToRgb(h, s, v, out r, out g, out b);

     color.R = (byte)(r);
     color.G = (byte)(g);
     color.B = (byte)(b);

     hue = h;
 }

 static void  RgbToHsv(float r, float g, float b, out float h, out float s, out float v)
 {
     float min, max, delta;
     min = System.Math.Min(System.Math.Min(r, g), b);
     max = System.Math.Max(System.Math.Max(r, g), b);
     v = max;               // v
     delta = max - min;
     if (max != 0)
     {
         s = delta / max;       // s

         if (r == max)
             h = (g - b) / delta;       // between yellow & magenta
         else if (g == max)
             h = 2 + (b - r) / delta;   // between cyan & yellow
         else
             h = 4 + (r - g) / delta;   // between magenta & cyan
         h *= 60;               // degrees
         if (h < 0)
             h += 360;
     }
     else
     {
         // r = g = b = 0       // s = 0, v is undefined
         s = 0;
         h = -1;
     }

 }
 static void HsvToRgb(float h, float s, float v, out float r, out float g, out float b)
 {
     // Keeps h from going over 360
     h = h - ((int)(h / 360) * 360);

     int i;
     float f, p, q, t;
     if (s == 0)
     {
         // achromatic (grey)
         r = g = b = v;
         return;
     }
     h /= 60;           // sector 0 to 5

     i = (int)h;
     f = h - i;         // factorial part of h
     p = v * (1 - s);
     q = v * (1 - s * f);
     t = v * (1 - s * (1 - f));
     switch (i)
     {
         case 0:
             r = v;
             g = t;
             b = p;
             break;
         case 1:
             r = q;
             g = v;
             b = p;
             break;
         case 2:
             r = p;
             g = v;
             b = t;
             break;
         case 3:
             r = p;
             g = q;
             b = v;
             break;
         case 4:
             r = t;
             g = p;
             b = v;
             break;
         default:       // case 5:
             r = v;
             g = p;
             b = q;
             break;
     }
 } 
```

我通过使用值 1 将色调每帧增加 1 来对其进行测试，并且效果相当好。请注意，可能存在一些舍入错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T20:39:26.420

根据[此文档](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.color%28v=xnagamestudio.35%29.aspx)，您可以将所需的任何 RGB(A) 值传递给 XNA 颜色类构造函数。您还可以使用 R、B 和 G 属性在之后更改它们

例子：

```
Color myColor = new Color(150, 100, 100);

myColor.R = 200 
```

该示例会将红色变为稍深的红色。

使颜色从红色变为橙色到黄色变为绿色的示例是

```
Color myColor = new Color(255, 0, 0);

for(int i=0; i<255; i++)
{
    myColor.R--;
    myColor.G++
} 
```

红色和绿色产生黄色，因此红色的数量越多，它就越红，绿色的数量越多，它的绿色就越多。相同的两个数字使它更红。

你也可以通过其他方式逐渐改变颜色，只要你知道光的原色是如何工作的。
您永远不会找到一个名为`Color.MakeRedder()`or的函数`Color.MakeGreener()` ，它将始终专注于某种颜色的数学表示，（RBG 是最常见的，但还有其他表示）

如果你想将 Hue 转换为 RBG[这里有一个关于如何做的指南](http://www.cs.rit.edu/~ncs/color/t_convert.html)

可能最简单的方法是跟踪一个`System.Drawing.Color`类作为您的基色类，并`Color`根据您的`System.Drawing.Color`类相应地修改您的 XNA 类。

如果您想真正冒险，可以查看是否可以创建一个扩展（继承自）的类`Microsoft.Xna.Framework.Color`，覆盖 R、G 和 B 属性，以便它们基于底层`System.Drawing.Color`对象

# shell - 在 shell 脚本中调用 awk

> ID：11441058
> 
> 赞同：5
> 
> 时间：2012-07-11T20:35:26.587
> 
> 标签：shell, awk

如果直接在终端上运行，我有这个命令可以正确执行。

```
awk '/word/ {print NR}' file.txt | head -n 1 
```

目的是找到单词`'word'`第一次出现的行号`file.txt`。

但是当我把它放在一个脚本文件中时，它似乎不起作用。

```
#! /bin/sh

if [ $# -ne 2 ]
then
        echo "Usage: $0 <word> <filename>"
        exit 1
fi

awk '/$1/ {print NR}' $2 | head -n 1 
```

那么我做错了什么？

谢谢，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-11T20:38:29.077

用双引号替换单引号，以便`$1`由 shell 评估：

```
awk "/$1/ {print NR}" $2 | head -n 1 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-11T20:38:37.020

在 shell 中，单引号防止参数替换；所以如果你的脚本是这样调用的：

```
script.sh word 
```

那么你*想*运行这个 AWK 程序：

```
/word/ {print NR} 
```

但你*实际上*正在运行这个：

```
/$1/ {print NR} 
```

不用说，AWK 不知道`$1`应该是什么。

要解决此问题，请将单引号更改为双引号：

```
awk "/$1/ {print NR}" $2 | head -n 1 
```

这样外壳就可以代替`word`.`$1`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-11T20:50:06.177

您应该使用 AWK 的变量传递功能：

```
awk -v patt="$1" '$0 ~ patt {print NR; exit}' "$2" 
```

使不必要`exit`的。`head -1`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-11T21:00:31.413

您还可以将值作为变量传递给 awk：

```
awk -v varA=$1 '{if(match($0,varA)>0){print NR;}}' $2 | head -n 1 
```

似乎比上面更麻烦，但说明了传递变量。

# facebook - Facebook Open graph 仅适用于 wordpress 网站上的某些页面

> ID：11441065
> 
> 赞同：0
> 
> 时间：2012-07-11T20:35:59.703
> 
> 标签：facebook, wordpress, facebook-opengraph, social

我有一个 wordpress 网站[socialshoreditch.com](http://socialshoreditch.com/)，每个帖子页面都有社交分享图标，出于某种原因，它们并不适用于每个帖子页面，即使它们都相同。另外，当我分享链接时，有时我会得到 opengraph 数据，有时却没有。

由于这是 wordpress 和所有模板，我正在努力找出它为什么不起作用。

有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T15:11:10.493

看看这个人：view-source：http://socialshoreditch.com/news/amazon-moves-to-tech-city/

您的元配置不正确！

```
<!-- Open Graph Tags -->
<meta property="og:type" content="" />
<meta property="og:title" content="" />
<meta property="og:url" content="" />
<meta property="og:site_name" content="" />
<meta property="fb:app_id" content="352115961525715"/>  
<meta property="og:description" content="" />
<!-- End Open Graph Tags --> 
```

这是一个工作示例：[http ://www.mediaprime.it/blog/133/facebook-acquisisce-acrylic-software/](http://www.mediaprime.it/blog/133/facebook-acquisisce-acrylic-software/)

# ios - Facebook iOS SDK 3.0 是否不能在 iOS 3.x 上运行？

> ID：11441067
> 
> 赞同：3
> 
> 时间：2012-07-11T20:36:01.333
> 
> 标签：ios, facebook-ios-sdk

[Facebook iOS SDK 3.0 Beta](https://developers.facebook.com/ios/)显示“这些新功能适用于 iOS 4.0 及更高版本。” 这是否意味着它不能在 iOS 3.x 上运行？这是否意味着如果我有一个支持 iOS 3.x 的应用程序，我就不能使用 Facebook iOS SDK 3.0？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-11T21:05:26.743

正确的。Facebook iOS SDK 3.0 不适用于 iOS 3.x。我们觉得 iOS 4.x 中的生产力增强（例如块）实在是太有用了。SDK 是开源的，我们计划维护历史记录，其中包括适用于 3.x 的现有代码。这样，对于需要继续支持旧版本 iOS 的应用程序来说，仍然有一个选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T20:43:52.697

可以肯定地说是，您将无法使用 iOS SDK 3.0，或者您将不再能够支持 iOS 3.x。

您也可以将其解释为您可以在 iOS 3.x 上使用它，但某些功能可能根本不起作用，在这种情况下，更改您使用的 SDK 没有意义，因为您将无法使用新功能的优势。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T22:23:25.770

值得一提的是，Apple 在 WWDC 2012 上宣布超过 80% 的 iOS 用户正在使用 iOS 5；另一个重要的百分比是使用 iOS 4。

我意识到您可能有使用 3.x 的特定业务需求，但世界正在迅速远离 3.x（甚至 4.x！），这应该考虑到您的平台设计。

之前的稳定（非 3.0）Facebook SDK 仍然兼容 3.x 设备。

# c# - 单击浏览器上的后退按钮时，Asp.Net Force Page_Load

> ID：11441083
> 
> 赞同：1
> 
> 时间：2012-07-11T20:37:28.543
> 
> 标签：c#, asp.net, internet-explorer, caching, response

我有一个在 Visual Studio 2010 中创建的 ASP.NET 项目。所以要开始这个项目，我得到了通用的“MY ASP.NET APPLICATION”页面。此后，我删除了所有通用内容，并根据用户的需求构建了应用程序。

在我的 default.aspx 页面上，我有一个`datagrid`包裹在`UpdatePanel`. 当用户从 中选择一行时`datagrid`，我导航到一个新页面。一切正常，但如果用户单击浏览器中的后退按钮，它就像是从旧的缓存版本加载页面一样，因为它再次显示通用的“我的 ASP.NET 应用程序”页面。

我已经对此进行了一段时间的研究，所有内容都表明，如果您告诉`Response`不要使用缓存，`Page_Load`如果用户单击后退按钮，它将强制点击。但是，这样做对我不起作用。如果我要单击刷新按钮或键入 F5，则我的页面已成功重新加载。我正在使用 IE9，这是我在`Page_Load`我的母版页中尝试过的：

```
 Response.Cache.SetExpires(DateTime.Now.AddDays(-1));
        Response.Cache.SetValidUntilExpires(false);
        Response.Cache.SetRevalidation(HttpCacheRevalidation.AllCaches);
        Response.Cache.SetCacheability(HttpCacheability.NoCache);
        Response.Cache.SetNoStore();
        Response.Expires = -1441;
        Response.ExpiresAbsolute = DateTime.Now.AddDays(-1);
        Response.AppendHeader("pragma", "no-cache");
        Response.CacheControl = "No-cache";
        Response.AddHeader("cache-control", "no-store, no-cache, must-revalidate"); 
```

另外，我尝试将其插入母版页的脚本中：

```
<meta http-equiv="Expires" content="0"/>
<meta http-equiv="Cache-Control" content="no-cache"/>
<meta http-equiv="Pragma" content="no-cache"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T13:34:13.917

今天一大早就想通了。事实证明，这只是使用 Ajax 时的另一个问题。当用户在数据网格中选择一行时，我在重定向到新页面之前没有添加历史记录点。所以我只需要在做重定向之前做一个`AddHistoryPoint`，`scriptmanager`附近一切都很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:11:12.843

我会从两件事开始。

首先，在浏览器中，我会转到 Internet 选项 > 浏览历史记录设置。如果“检查存储页面的较新版本”设置为从不，那么我会将其移至自动。

其次，我会查看实际的文件系统（不在 Visual Studio 中，使用文件资源管理器）以查看该文件是否确实仍然存在。如果是这样，我会删除它。

# makefile - 具有共享相同配方的多个规则的 Makefile

> ID：11441084
> 
> 赞同：39
> 
> 时间：2012-07-11T20:37:29.090
> 
> 标签：makefile, rules

我想知道是否可以编写一个包含多个规则的 Makefile，每个规则都定义了自己的先决条件，并在不复制配方的情况下执行所有这些规则。例子：

```
TARGETS= file1 file2 file3

all: $(TARGETS)

file1: dep1 dep2
file2: dep2 dep3 dep4
file3: dep2 dep1
    cat $^ > $@ 
```

谢谢！

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-07-11T20:41:12.483

是的，它是以一种相当明显的方式编写的：

```
TARGETS= file1 file2 file3

all: $(TARGETS)

file1: dep1 dep2
file2: dep2 dep3 dep4
file3: dep2 dep1

$(TARGETS):
    cat $^ > $@ 
```

## UPD。

只是为了澄清。

通用[make 规则](http://www.gnu.org/software/make/manual/make.html#Rule-Syntax)如下所示：

```
targets... : prerequisites...
    recipe
    ... 
```

规则的任何部分都可以省略。如果没有配方，可以在 makefile 中的任何位置填充先决条件列表，目标可以出现在多个规则语句的左侧。

例如，下面的例子等价于上面的例子（好吧，假设 Makefile 设计得当，所以先决条件的顺序无关紧要）：

```
file1 file3       : dep1
file1 file2 file3 : dep2
file2             : dep3 dep4 
```

与列出先决条件不同，每个目标最多可以有一个明确的配方。在配方中，您可以使用[自动变量](http://www.gnu.org/software/make/manual/make.html#Automatic-Variables)来获取目标名称、先决条件列表等。

## UPD。2

正如@Calmarius 在评论中提到的那样，这不适用于[模式规则](http://www.gnu.org/software/make/manual/make.html#Pattern-Rules)，例如`%.txt: %.foo`. 目标中的多个模式意味着该规则**一次**生成所有这些目标。

> 此模式规则有两个目标：
> 
> ```
> %.tab.c %.tab.h: %.y
>     bison -d $< 
> ```
> 
> 这告诉 make 配方`bison -d x.y`将同时制作`x.tab.c`和`x.tab.h`。如果文件 foo 依赖于 files`parse.tab.o`并且`scan.o`文件 scan.o 依赖于 file `parse.tab.h`，那么当`parse.y`改变时，配方`bison -d parse.y` 将只执行一次，并且两者的先决条件 `parse.tab.o`都会`scan.o`得到满足。

但是，可以在模式规则中定义多个先决条件（即，前提是其目标包含一个`%`词干，否则它将是一个常规规则）。

# grails - GORM createCriteria() "AND" 问题

> ID：11441086
> 
> 赞同：0
> 
> 时间：2012-07-11T20:37:43.890
> 
> 标签：grails, grails-orm

2 领域类，人物和属性

```
class Person {
static hasMany = [attributes : Attribute]    

}

class Attribute{
String key
String value
} 
```

查询 fname：

```
def c = Person.createCriteria()
def result = c.list{

attributes {
          eq("key", "fname")
          eq("value", "foo")
}   

println result
} 
```

结果：[foo foo ,foo bar]

查询 lname：

```
def c = Person.createCriteria()
def result = c.list{

attributes {
          eq("key", "lname")
          eq("value", "bar")
}   

println result
} 
```

结果：[bar bar ,foo bar]

查询 lname 或 fname：

```
def c = Person.createCriteria()
def result = c.list{
or{
attributes {
          eq("key", "fname")
          eq("value", "foo")
}

attributes {
          eq("key", "lname")
          eq("value", "bar")
}
}

println result
} 
```

结果：[foo foo ,foo bar ,bar bar]

但如果我将 OR 更改为 And，我没有得到任何结果：

```
def c = Person.createCriteria()
def result = c.list{
and{
attributes {
          eq("key", "fname")
          eq("value", "foo")
}

attributes {
          eq("key", "lname")
          eq("value", "bar")
}
}

println result
} 
```

结果： []

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:39:27.463

我为此找到了一个肮脏的解决方法：

```
 def list1= Person.createCriteria().list { 
            attributes { 
                    eq("key", "fname") 
                    eq("value", "foo") 
            } 
        } 
def list2= Person.createCriteria().list { 
            attributes { 
                    eq("key", "lname") 
                    eq("value", "bar") 
            } 
        } 
        return list1.intersect(list2) 
```

[资源](http://grails.1312388.n4.nabble.com/Criteria-Builder-how-to-query-multiple-matching-items-in-associated-list-td1367989.html "资源")

我会留下这个问题没有答案，希望有人会想出更好的东西

# svg - 背景图像通过canvg将Raphael SVG填充到Canvas是黑色的

> ID：11441089
> 
> 赞同：2
> 
> 时间：2012-07-11T20:38:03.333
> 
> 标签：svg, raphael

我发现这里有关将 raphael SVG 转换为画布元素的信息非常有用。但是我有点卡住了——我画了一个 Raphael SVG（它有点难看，抱歉，但它可以工作），我几乎可以通过 canvg 在画布上重新创建它，除了我的填充图案都是黑色的。渲染的 SVG 代码有问题吗？

这是我的 raphael 绘图的 svg 代码（innerHTML）示例：

```
<svg height="530" version="1.1" width="530" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="overflow-x: hidden; overflow-y: hidden; position: relative; "><desc>Created with Raphaël 2.0.0</desc><defs><pattern id="BDC4C7DB-1FF9-4BE5-B868-C7B68C6A7B8B" x="0" y="0" patternUnits="userSpaceOnUse" height="1" width="1" patternTransform="matrix(1,0,0,1,0,0) translate(535.9612108001184,76)"><image x="0" y="0" href="assets/img/crush_gloss/coral_bell_gloss.jpg"></image></pattern><pattern id="75CC740F-C521-4E46-BE6F-2CE15E4CD6D4" x="0" y="0" patternUnits="userSpaceOnUse" height="1" width="1" patternTransform="matrix(1,0,0,1,0,0) translate(-31.03878919988169,426)"><image x="0" y="0" href="assets/img/crush_gloss/coral_bell_gloss.jpg"></image></pattern><pattern id="70CBF480-046A-4F7D-8B41-FD642EC8109B" x="0" y="0" patternUnits="userSpaceOnUse" height="1" width="1" patternTransform="matrix(1,0,0,1,0,0) translate(265.9612108001183,76)"><image x="0" y="0" href="assets/img/crush_gloss/habenero_gloss.jpg"></image></pattern><pattern id="146B2DC3-E4B5-4959-BFCD-6A6CF69E3300" x="0" y="0" patternUnits="userSpaceOnUse" height="1" width="1" patternTransform="matrix(1,0,0,1,0,0) translate(238.96121080011827,26)"><image x="0" y="0" href="assets/img/crush_gloss/coral_bell_gloss.jpg"></image></pattern> ... AND ON ... </defs></svg> 
```

我正在使用以下内容尝试在画布中重新创建我的 SVG：

```
innerSVG=document.getElementById('app_display').innerHTML;
//alert (innerSVG);
// load svg snippet in the canvas  
canvg('canv', innerSVG); 
```

我的图案画得很好，我的背景填充颜色很好，只是我画的图案上的图像填充不好；他们总是黑色的。我已经尝试通过完整的 url 引用它们，相对的，它没有区别。此页面上没有基本元标记。关于我错在哪里的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:46:22.440

尝试`href`用`xlink:href`

```
<image x="0" y="0" xlink:href="assets/img/crush_gloss/coral_bell_gloss.jpg"></image> 
```

或者...

```
canvg('canv', innerSVG.replace("href","xlink:href")); 
```

# java - Java，平均数字列表

> ID：11441092
> 
> 赞同：0
> 
> 时间：2012-07-11T20:38:13.093
> 
> 标签：java, average

在下面的 Java 代码中，我的平均温度是小数点后 1 位。

例如，而不是`69.0`它的`6.9`.

输入可以是任意 10 个数字。所以假设我输入了 10 个温度，每个 1 是 10 度。10 个输入的总数为 100，因此平均值应为 10，但我收到的平均值为 1.0。

代码：

```
import java.util.Scanner;
public class NumberAboveAverage {
    public static void main(String[] args) {
        Scanner input = new Scanner(System.in);
        final int TotalTemps = 10;
        double[] numbers = new double[TotalTemps];
        double sum = 0;
        double average = 0;
        double max = 0;
        for (int n = 0; n < numbers.length; n++) {
            System.out.print("Enter a temperature: ");
            numbers[n] = input.nextInt();

            if (numbers[n] > max) {
               max = numbers[n];
            }
            sum = numbers[n];
        }

        for (int i = 0; i < numbers.length; i++) {
            sum = numbers[i];
        }

        average = sum / 10;    //average is not an average of the numbers.
        System.out.println("Average temp = " + average);

        int count = 0;
        for (int i = 0; i < numbers.length; i++) {
            if (numbers[i] > average) {
               count++;
            }
        }
        System.out.println(count + " days were above average");
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-11T20:41:13.197

您实际上并没有将数字相加。

它应该是`sum += numbers[i];`

不是`sum = numbers[i];`

您似乎还试图这样做两次，这是不必要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:42:31.580

您求和两次（第二个 for 循环）并错误地使用：
`sum = numbers[n];`
而不是：
`sum += numbers[n];`

您应该将代码更改为：

```
...
         for (int n = 0; n < numbers.length; n++) {
            System.out.print("Enter a temperature: ");
            numbers[n] = input.nextInt();

            if (numbers[n] > max) {
               max = numbers[n];
            }
            sum += numbers[n];
         }

         // SECOND FOR LOOP REMOVED !!!

         average = sum / 10;
         System.out.println("Average temp = " + average);

        ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T20:43:23.163

你错过了一个`+`

```
sum = numbers[n]; 
```

需要是

```
sum += numbers[n]; 
```

这无济于事，

```
 for (int i = 0; i < numbers.length; i++) {
    sum = numbers[i];
 } 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-11T20:41:07.970

代替

```
average = sum / 10; 
```

和

```
average = sum / 10.0; 
```

# eclipse - 在我使用来自 Eclipse 的 svn 后，subclipse 在 sts 中中断

> ID：11441093
> 
> 赞同：0
> 
> 时间：2012-07-11T20:38:15.423
> 
> 标签：eclipse, spring, svn, eclipse-plugin, subclipse

很长一段时间，我的 subversion 客户端工作得很好，我在 sts 中使用了一段时间，但是有一天 sts 崩溃了，我回滚到 eclipse 了一段时间，在那段时间我使用 subclipse 更新了我的一个项目. 现在 STS 再次启动并运行，但由于某种原因，如果我尝试从 sts 更新或提交，我会收到以下错误：

```
The path '{pathname}' appears to be part of a Subversion 1.7 or greater
working copy.  Please upgrade your Subversion client to use this
working copy. 
```

subclipse 实际上没有可用的更新，sts 仍然可以从仪表板识别最近安装的 subclipse。关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T15:02:12.077

您应该能够在 STS 中安装 Subclipse 1.8.x。更新站点 URL 为：

[http://subclipse.tigris.org/update_1.8.x](http://subclipse.tigris.org/update_1.8.x)

该版本包括 Subversion 1.7 客户端，因此一旦执行此操作，您就应该做好准备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:53:44.647

Subclipse JavaHL 库以进行 SVN 连接。在 Windows 上，如果您拥有最新的 Subclipse，看起来您应该自动安装它，但如果没有，它们有各种安装说明（唉，取决于系统）。

# c++ - 错误：将“char”分配给“char [11]”时的类型不兼容

> ID：11441094
> 
> 赞同：-1
> 
> 时间：2012-07-11T20:38:15.693
> 
> 标签：c++, arrays, class

我正在尝试创建一个允许用户设置成员数组变量的成员函数。

我一直在到处寻找，但在我的代码中找不到问题，

```
#include <string>
#include <iostream>
using namespace std;

class Employee
{
   protected:
      string name;
      char ssn[11];
      char id[5];
      char hired[8];
   public:
      Employee(char ssn, char id, char hired);     //Constructor
      Employee(string name);
      ~Employee();      //Destructor
      void setName(string n) { n = name; }
      void setSSN(char i) { ssn = i; }

};

int main()
{
return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:49:33.680

让我们看看你的`setSSN`功能：

```
void setSSN(char i) { ssn = i; } 
```

SNN，最有可能表示社会安全号码，不只是一个数字，而是 11，对吧？那为什么`setSSN`只输入一个字符（数字）`(char i)`？因此，`setSSN`函数应该采用包含员工 SSN 的字符串，并且该字符串应该与类的`ssn`成员变量具有相同的风格`Employee`，以便让您在`setSSN`函数体中将一个字符串变量分配给另一个字符串变量。如果您已经熟悉`string`C++ 标准库的类，您可能应该使用该类来存储和操作所有字符串。

# c++ - c ++类构造函数参考结构

> ID：11441095
> 
> 赞同：0
> 
> 时间：2012-07-11T20:38:22.387
> 
> 标签：c++, reference, constructor, initialization

我有一个类打印机

```
class Printer{
     struct foo{
        int i;
     };
     foo & f;
}; 
```

当我调用Printer的构造函数时，我需要初始化f，因为f是一个引用，但我想要的是首先调用foo的构造函数并创建它的一个实例，然后将它分配给f。我的问题是如果我打电话

```
Printer::Printer():f(foo(0)){ } 
```

有一个错误说我不能使用对结构的临时实例的引用。有办法解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:47:28.203

在这种情况下，引用没有任何意义。请尝试以下操作：

```
class Printer{
     struct foo{
        int i;
        foo(int i_) : i(i_) {}  // Define a constructor
     };

     foo f;  // Not a reference anymore!

public:
     Printer::Printer() : f(0) {}  // Initialise f
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:05:17.313

您可以通过一步声明 struct foo 并定义 f 来使 Oli 的答案略短：

```
class Printer{
    struct foo{
        int i;
        foo(int i_) : i(i_) {}
    } f;
public:
    Printer() : f(0) {}
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:47:11.950

我认为您实际上不想引用`foo`但`foo`它本身。

当您调用 时`foo(0)`，它会创建一个结构并将其作为“浮动”对象返回。您不能为其分配引用，因为没有人“持有”它，并且一旦构造函数退出它就会被丢弃。

所以，如果你想保留对它的引用，你首先必须将它存储在一个持久的实际对象中。在这种情况下，您可能只想将整个结构保留在类中。

# parsing - SDP解析器的“测试向量”集？

> ID：11441098
> 
> 赞同：0
> 
> 时间：2012-07-11T20:38:31.670
> 
> 标签：parsing, testing, sdp

我编写了一个 SDP（会话描述协议，RFC 4566）解析器，我想用一组全面的“测试向量”来测试它，即一组 SDP 描述，尽可能强调解析器的各个方面.

我搜索了诸如“sdp 测试解析”之类的东西，但信噪比很低（也因为 SDP 有很多含义）。最接近一组测试向量的是java代码

[http://grepcode.com/file/repository.jboss.org/maven2/javax.sip/jain-sip-ri/1.2.86/test/gov/nist/javax/sdp/parser/SdpParserTest.java](http://grepcode.com/file/repository.jboss.org/maven2/javax.sip/jain-sip-ri/1.2.86/test/gov/nist/javax/sdp/parser/SdpParserTest.java)

但这只是四个示例，我正在寻找更详尽的内容。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T05:03:21.963

您可能会发现，仅在 SO 中搜索 SDP 就会产生足够的 SDP 供您在测试中使用……我知道我进行了快速搜索，并且对这个数字感到惊讶！

要记住的另一件事是，可以随时向 IANA 注册各种属性......

[https://www.rfc-editor.org/rfc/rfc4566](https://www.rfc-editor.org/rfc/rfc4566) - 8.2.4。属性名称（“att-field”）

属性字段名称（“att-field”）必须在 IANA 注册并记录在案，因为同名下的属性冲突会引起明显的问题。SDP 中的未知属性会被简单地忽略，但是使协议碎片化的冲突属性是一个严重的问题。

如果在 IANA 注册，SDP 中还有其他项目可能会发生变化。

您将需要查看他们的网站[http://www.iana.org/protocols/](http://www.iana.org/protocols/)

特别是[http://www.iana.org/assignments/sdp-parameters/sdp-parameters.xml](http://www.iana.org/assignments/sdp-parameters/sdp-parameters.xml)但很可能是其他人。

然后，您还可以制作一个程序来下载每个 xml 文件并根据 xml 文件中的信息创建一个随机 SDP，然后测试解析它，但由于您制作的文件不会是太多的测试......

# java - tomcat 中的 Java Web 应用程序定期冻结

> ID：11441099
> 
> 赞同：26
> 
> 时间：2012-07-11T20:38:31.633
> 
> 标签：java, spring, tomcat, web-applications

我运行 Tomcat (7.0.28) 的 Java Web 应用程序定期变得无响应。我希望对可能的罪魁祸首（同步？）提出一些建议，以及一些推荐的工具，用于收集有关崩溃期间发生的情况的更多信息。我积累的一些事实：

*   当 web 应用程序冻结时，tomcat 继续向应用程序提供请求线程，但应用程序不会释放它们。线程池填满到最大值（当前为 250），然后后续请求立即失败。在正常操作期间，活动线程永远不会超过 2 或 3 个。

*   当问题发生时，我们的任何 tomcat 或 Web 应用程序日志中都没有记录任何类型的错误或异常。

*   通过 tomcat 管理 web 应用程序在我们的应用程序上执行“停止”然后“启动”立即解决了这个问题（直到今天）。

*   最近的频率是一天两三次，今天更糟，可能是二十次，有时还没有立即恢复。

*   该问题仅在工作时间出现

*   我们的暂存系统不会出现此问题

*   当问题发生时，服务器上的处理器和内存使用率保持不变（并且相当低）。Tomcat 报告有大量可用内存。

*   出现问题时，Tomcat 会继续响应。管理 web 应用程序运行良好，tomcat 继续向我们的应用程序发送请求，直到池中的所有线程都被填满。

*   当问题发生时，我们的数据库服务器保持响应。我们使用 Spring 框架进行数据访问和注入。

*   当使用率很高时，通常会出现问题，但使用率从来不会出现异常高的峰值。

*   问题历史：大约一年半前发生了类似的事情。经过多次服务器配置和代码更改，问题直到大约一个月前才消失。在过去的几周内，它的发生频率要高得多，平均每天 2 或 3 次，有时连续数次。

*   我今天发现了一些可能不是线程安全的服务器代码，我对此进行了修复，但问题仍然存在（尽管频率较低）。这是非线程安全代码可能导致的问题吗？

**更新：**有几篇文章暗示数据库连接池耗尽，我朝那个方向做了一些搜索，发现了另一个[Stackoverflow 问题](https://stackoverflow.com/questions/3525529/whats-the-proper-way-to-handle-jdbc-connections-with-spring-and-dbcp)，它解释了我遇到的几乎所有问题。

显然，在 Apache 的 BasicDataSource 实现中，maxActive 和 maxIdle 连接的默认值都是 8。此外，maxWait 设置为 -1，因此当池耗尽并且新的连接请求进入时，它将永远等待而不记录任何有点例外。我仍将等待此问题再次发生并在 JVM 上执行 jstack 转储，以便我可以分析该信息，但看起来这就是问题所在。它唯一没有解释的是为什么应用程序有时无法从这个问题中恢复。我想请求有时会堆积起来，一旦落后，它就永远赶不上。

**更新二：**我在崩溃期间运行了一个 jstack，发现了以下大约 250 个（最大线程）：

```
"http-nio-443-exec-294" daemon prio=10 tid=0x00002aaabd4ed800 nid=0x5a5d in Object.wait() [0x00000000579e2000]
   java.lang.Thread.State: WAITING (on object monitor)
        at java.lang.Object.wait(Native Method)
        at java.lang.Object.wait(Object.java:485)
        at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:1118)
        - locked <0x0000000743116b30> (a org.apache.commons.pool.impl.GenericObjectPool$Latch)
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:106)
        at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
        at org.springframework.jdbc.datasource.DataSourceUtils.doGetConnection(DataSourceUtils.java:111)
        at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:77)
        at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:573)
        at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:637)
        at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:666)
        at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:674)
        at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:718) 
```

对我未经训练的眼睛来说，这看起来相当确凿。看起来数据库连接池已达到上限。我配置了 3 秒的 maxWait，而没有修改 maxActive 和 maxIdle，只是为了确保当池填满时我们开始看到记录的异常。然后我会将这些值设置为适当的值并进行监控。

**更新三：**配置 maxWait 后，我​​开始在我的日志中看到这些，如预期的那样：

```
 org.apache.commons.dbcp.SQLNestedException: Cannot get a connection, pool error Timeout waiting for idle object
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:114)
        at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
        at org.springframework.jdbc.datasource.DataSourceUtils.doGetConnection(DataSourceUtils.java:111)
        at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:77) 
```

我已将 maxActive 设置为 -1（无限），将 maxIdle 设置为 10。我将监视一段时间，但我的猜测是问题到此为止。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-12T08:07:19.940

根据经验，您可能希望查看您的**数据库连接池**实现。可能是您的数据库有足够的容量，但您的应用程序中的连接池仅限于少量连接。我不记得细节，但我似乎记得有一个类似的问题，这是我改用[BoneCP](http://jolbox.com/)的原因之一，我发现它在负载测试下非常快速和可靠。

尝试下面建议的调试后，尝试增加池中可用的连接数，看看是否有任何影响。

> 我今天发现了一些可能不是线程安全的服务器代码，我对此进行了修复，但问题仍然存在（尽管频率较低）。这是非线程安全代码可能导致的问题吗？

这取决于您所说的线程安全是什么意思。在我看来，您的应用程序正在导致线程[死锁](http://sergebeauchamp.blogspot.co.uk/2010/11/how-to-debug-and-detect-deadlocks.html)。您可能希望使用配置为允许调试器连接的 JVM 运行生产环境，然后使用 JVisualVM、JConsole 或其他分析工具（YourKit 是优秀的 IMO）来查看您拥有的线程以及它们的内容'正在等待。

# python - 在没有 Google Driver UI 的情况下将大文件上传到 Google Drive 的 POST 消息

> ID：11441100
> 
> 赞同：1
> 
> 时间：2012-07-11T20:38:33.463
> 
> 标签：python, google-app-engine, google-drive-api

我的理解是，要使用 API 版本 2 从我自己的应用程序将大文件上传到 Google Drive，我应该发送如下消息。不幸的是，我不知道如何使用 Python 为多部分消息实现这种格式。有没有人有示例 Python 代码可以让我朝着正确的方向前进？

谢谢，克里斯

* * *

```
POST /upload/drive/v2/files?uploadType=multipart

Authorization: Bearer <Access token>
Content-Length: <length>
Content-Type: multipart/related; boundary="<a base64 encoded guid>"

--<a base64 encoded guid>
Content-Type: application/json

{"title": "test.jpg", "mimeType":"image/jpeg", "parents":[]}
--<a base64 encoded guid>
Content-Type: image/jpeg
Content-Transfer-Encoding: base64

<base64 encoded binary data>
--<a base64 encoded guid>-- 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:50:07.003

Google Drive API 的参考指南包含多种语言的代码片段，包括所有 API 端点的 Python。

对于您的用例，[drive.files.insert](https://developers.google.com/drive/v2/reference/files/insert)端点有答案：

```
from apiclient import errors
from apiclient.http import MediaFileUpload
# ...

def insert_file(service, title, description, parent_id, mime_type, filename):
  """Insert new file.

  Args:
    service: Drive API service instance.
    title: Title of the file to insert, including the extension.
    description: Description of the file to insert.
    parent_id: Parent folder's ID.
    mime_type: MIME type of the file to insert.
    filename: Filename of the file to insert.
  Returns:
    Inserted file metadata if successful, None otherwise.
  """
  media_body = MediaFileUpload(filename, mimetype=mime_type, resumable=True)
  body = {
    'title': title,
    'description': description,
    'mimeType': mime_type
  }
  # Set the parent folder.
  if parent_id:
    body['parents'] = [{'id': parent_id}]

  try:
    file = service.files().insert(
        body=body,
        media_body=media_body).execute()

    return file
  except errors.HttpError, error:
    print 'An error occured: %s' % error
    return None 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T17:16:01.957

我在其他地方找到了答案，这个 Python 代码产生了问题中显示的消息。

```
url = 'https://www.googleapis.com/upload/drive/v2/files?uploadType=multipart'

boundary = base64.b64encode(uuid.uuid4().bytes)
parts = []
parts.append('--' + boundary)
parts.append('Content-Type: application/json')
parts.append('')
parts.append(json.dumps({
    'title': name,
    'mimeType': 'image/jpeg',
    'parents': [{
        'kind': 'drive#file',
        'id': folderId
        }] if folderId else []
    }))
parts.append('--' + boundary)
parts.append('Content-Type: image/jpeg')
parts.append('Content-Transfer-Encoding: base64')
parts.append('')
parts.append(base64.b64encode(content))
parts.append('--' + boundary + '--')
parts.append('')
body = '\r\n'.join(parts)

headers = {
    'Content-Type': 'multipart/related; boundary="%s"' % boundary,
    'Content-Length': str(len(body)),
    'Authorization': 'Bearer %s' % access_token
    }
response = urlfetch.fetch(url, payload=body, method='POST', headers=headers)
assert response.status_code == 200, '%s - %s' % (response.status_code, response.content)
r = json.loads(response.content) 
```

# ruby-on-rails - Rails 中的 SLIM 模板：如何从实例变量呈现 html 元素？

> ID：11441104
> 
> 赞同：1
> 
> 时间：2012-07-11T20:38:45.887
> 
> 标签：ruby-on-rails, ruby-on-rails-3.1, haml, slim-lang

*   红宝石 1.9.2p290
*   导轨 3.1.1

如何从**SLIM**模板中的控制器创建 html 元素？

我会解释：

在我看来，我想通过某些条件更改“h1”html标签。

**但我想把逻辑放在控制器中。**

```
case params[:controller] when "recipes", "chefs"
    case params[:action] when "show", "index"
      @h_number = "h2"
    else
      @h_number ="h1"
    end
  else
    @h_number ="h1"
end 
```

在我的**SLIM**视图中，我想要这样的东西：

```
= @h_number#logo
    = link_to image_tag("image.png"), root_path 
```

结果是：

```
<h1 id="logo"><a href="/"><img src="image.png"></a></h2> 
```

或者

```
<h2 id="logo"><a href="/"><img src="image.png"></a></h2> 
```

是否可以？

我清楚了吗？对不起我的英语。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T22:12:14.073

我高度怀疑这是可能的。但是你总是可以创建一个辅助方法来做到这一点

在您的应用程序帮助文件中，

```
module ApplicationHelper
    def logo
        num = case params[:controller] when "recipes", "chefs"
          case params[:action] when "show", "index" then 2 end
        end || 1

        "<h#{num}>" + link_to(image_tag("image.png"), root_path) + "</h#{num}>"
    end
end 
```

在您的模板中

```
body
  header
    == logo 
```

你的控制器不需要任何东西。

# asp.net-mvc-3 - MVC3 中模型类的 Razor 视图下拉列表

> ID：11441108
> 
> 赞同：2
> 
> 时间：2012-07-11T20:39:02.970
> 
> 标签：asp.net-mvc-3

我在 MVC3 中有两个模型类，其中一个`Services`具有这些属性

```
public int ID { get; set; }
public string Name { get; set; }
public string Description { get; set; }
public string Image { get; set; }
public int ChildOf { get; set; } 
```

它还有一个 Entityframework 的数据库表

另一个模型`Quata`具有这些属性

```
public int ID { get; set; }
public string Sender_Name { get; set; }
public string Description { get; set; }
.....
......
public Services Service_ID { get; set; } 
```

它还有一个 Entityframework 的数据库表

我想创建一个 Razor(C#) 视图 ( `for Quata`)，用户可以在其中通过填写 html 表单发送 quata，但我想在其中显示一个**下拉列表**，其中`Services ID`包含**下拉值**和**下拉文本**`Services Name`，该下拉文本也来自 Services DB 表。

 **我的问题是我应该如何创建该动态**下拉**列表`@Html.DropDownListFor`？并将从该**下拉列表**中选择的数据发送到控制器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T22:09:22.243

试试这个

控制器：

```
 public ActionResult Create()
    {
        var Services = new Services();

        Services.Load(); //load services..

        ViewBag.ID = new SelectList(Services.ToList(), "Id", "Name");

        return View();
    }

[HttpPost]
public ActionResult Create(Quata Quata)
    {
        //save the data 
    } 
```

强类型视图：（使用 Razor）

```
@model Quata

@using (Html.BeginForm()) {
<fieldset>
    <legend>Quata</legend>

    <div>
        @Html.LabelFor(model => model.Service_ID.ID, "Service")
    </div>
    <div>
        @Html.DropDownList("ID", String.Empty)
    </div>

    <p>
        <input type="submit" value="Create" />
    </p>
</fieldset>
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:42:03.210

看一眼`@Html.DropDownListFor`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T22:12:45.447

所以说你的视图模型有一个所述服务的列表。

以下内容可能对您有用（您可能不需要 for 循环，编辑器应该消除它，但我遇到了一些奇怪的绑定问题）。

在您的顶级视图中，指向您的视图模型（@model Quata，假设 Quata 是您的视图模型）具有以下代码：

```
@For i = 0 To Model.DropdownListInput.Count - 1
                Dim iterator = i
                @Html.EditorFor(Function(x) x.DropdownListInput(iterator), "EnumInput")
        Next 
```

在您的编辑器模板中（在视图文件夹下创建一个子文件夹，此下拉列表将在称为编辑器模板中，并根据您的需要命名模板，我的是 EnumInput）。

在您的编辑器模板中，它应该指向您的服务模型（@model 服务）具有类似于以下代码的内容（替换为您的适当变量名称）：

```
@<div class="editor-label">
    @Html.LabelFor(Function(v) v.value, Model.DisplayName)
</div>
@<div class="editor-field">
    @Html.DropDownListFor(Function(v) v.value, New SelectList(Model.ParamEnums, "ValueForScript", "EnumValue"), "--Please Select A Value--")
    @Html.ValidationMessageFor(Function(v) v.value)
</div> 
```

用你的列表替换列表，用你的替换 lambda 值 (@Html.DropDownListFor(x => x.id, New SelectList(x.ServiceList, "ID", "Name"), "--请选择一个值-- “） 或类似的东西。

请注意，此代码是在 VB 中，但它应该提供一个粗略的指南。**

# sql-server - 动态枢轴显示选民如何投票

> ID：11441115
> 
> 赞同：-1
> 
> 时间：2012-07-11T20:39:36.237
> 
> 标签：sql-server, tsql, sql-server-2005, pivot

这是表结构：

```
Election
ElectionId ElectionName
1          12P
2          11G

History
ElectionId VoterId HowVoted
1          1       Rep
2          2       Dem
1          2       Non 

Voter
VoterId VoterName
1       Bill Smith
2       John Hearst 
```

我想要这样的输出：

```
VoterName   12P  11P  note: Election names change so need to be pivoted dynamically
Bill Smith  Rep  Null
John Hearst Non  Dem 
```

我基本上需要将 ElectionNames 转为 Column Names，然后显示选民如何在行中投票。建议？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:10:47.273

您可以使用动态 SQL 执行此操作，如下所示：

```
-- Get column names
DECLARE @Columns VARCHAR(MAX);  SET @Columns = '';
SELECT @Columns = @Columns + ', [' + ElectionName + ']' FROM Election;
SET @Columns = SUBSTRING(@Columns, 3, LEN(@Columns)) -- Remove the leading ', '

-- Declare dynamic SQL
DECLARE @sql VARCHAR(MAX);
SET @sql = 'WITH CTE AS
(
    SELECT VoterName, ElectionName, HowVoted
    FROM Election e
        INNER JOIN History h ON e.ElectionId = h.ElectionId
        INNER JOIN Voter v ON v.VoterId = h.VoterId
)
SELECT [VoterName], ' + @Columns + 'FROM CTE
PIVOT (MAX(HowVoted) FOR ElectionName IN ('+ @Columns + ')) AS p'

-- Run dynamic SQL
EXEC(@sql) 
```

# java - 不幸的是 Project_Name 已停止

> ID：11441120
> 
> 赞同：1
> 
> 时间：2012-07-11T20:40:10.530
> 
> 标签：java, android

我有一个简单的应用程序，您可以在 textview 中输入文本并按提交，它会在另一个 Activity 中显示文本。但是，当我按下提交时，给我消息“不幸地发送已停止”我查看了 SO 上的其他线程，但[不幸的是 myfirstproject stop working 错误在 java](https://stackoverflow.com/questions/9189518/unfortunately-myfirstproject-stopped-working-error-in-java)似乎最接近，他们说检查 LogCat 文件，它想出了不止一个错误：

```
07-11 19:38:01.925: E/Trace(729): error opening trace file: No such file or directory (2)
07-11 19:38:05.815: I/Choreographer(729): Skipped 451 frames!  The application may be doing too much work on its main thread.
07-11 19:38:06.009: D/gralloc_goldfish(729): Emulator without GPU emulation detected.
07-11 19:38:35.046: I/Choreographer(729): Skipped 45 frames!  The application may be doing too much work on its main thread.
07-11 19:38:41.427: D/AndroidRuntime(729): Shutting down VM
07-11 19:38:41.435: W/dalvikvm(729): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
07-11 19:38:41.585: E/AndroidRuntime(729): FATAL EXCEPTION: main
07-11 19:38:41.585: E/AndroidRuntime(729): java.lang.IllegalStateException: Could not execute method of the activity
07-11 19:38:41.585: E/AndroidRuntime(729):  at android.view.View$1.onClick(View.java:3591)
07-11 19:38:41.585: E/AndroidRuntime(729):  at android.view.View.performClick(View.java:4084)
07-11 19:38:41.585: E/AndroidRuntime(729):  at android.view.View$PerformClick.run(View.java:16966)
07-11 19:38:41.585: E/AndroidRuntime(729):  at android.os.Handler.handleCallback(Handler.java:615)
07-11 19:38:41.585: E/AndroidRuntime(729):  at android.os.Handler.dispatchMessage(Handler.java:92)
07-11 19:38:41.585: E/AndroidRuntime(729):  at android.os.Looper.loop(Looper.java:137)
07-11 19:38:41.585: E/AndroidRuntime(729):  at android.app.ActivityThread.main(ActivityThread.java:4745)
07-11 19:38:41.585: E/AndroidRuntime(729):  at java.lang.reflect.Method.invokeNative(Native Method)
07-11 19:38:41.585: E/AndroidRuntime(729):  at java.lang.reflect.Method.invoke(Method.java:511)
07-11 19:38:41.585: E/AndroidRuntime(729):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
07-11 19:38:41.585: E/AndroidRuntime(729):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
07-11 19:38:41.585: E/AndroidRuntime(729):  at dalvik.system.NativeStart.main(Native Method)
07-11 19:38:41.585: E/AndroidRuntime(729): Caused by: java.lang.reflect.InvocationTargetException
07-11 19:38:41.585: E/AndroidRuntime(729):  at java.lang.reflect.Method.invokeNative(Native Method)
07-11 19:38:41.585: E/AndroidRuntime(729):  at java.lang.reflect.Method.invoke(Method.java:511)
07-11 19:38:41.585: E/AndroidRuntime(729):  at android.view.View$1.onClick(View.java:3586)
07-11 19:38:41.585: E/AndroidRuntime(729):  ... 11 more
07-11 19:38:41.585: E/AndroidRuntime(729): Caused by: android.content.ActivityNotFoundException: Unable to find explicit activity class {com.point/com.point.DisplayMessageActivity}; have you declared this activity in your AndroidManifest.xml?
07-11 19:38:41.585: E/AndroidRuntime(729):  at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1541)
07-11 19:38:41.585: E/AndroidRuntime(729):  at android.app.Instrumentation.execStartActivity(Instrumentation.java:1416)
07-11 19:38:41.585: E/AndroidRuntime(729):  at android.app.Activity.startActivityForResult(Activity.java:3351)
07-11 19:38:41.585: E/AndroidRuntime(729):  at android.app.Activity.startActivityForResult(Activity.java:3312)
07-11 19:38:41.585: E/AndroidRuntime(729):  at android.app.Activity.startActivity(Activity.java:3522)
07-11 19:38:41.585: E/AndroidRuntime(729):  at android.app.Activity.startActivity(Activity.java:3490)
07-11 19:38:41.585: E/AndroidRuntime(729):  at com.point.MainActivity.sendMessage(MainActivity.java:34)
07-11 19:38:41.585: E/AndroidRuntime(729):  ... 14 more
07-11 19:43:41.995: I/Process(729): Sending signal. PID: 729 SIG: 9 
```

SO 上的链接还说了一些关于不创建 TextView 并且它为 NULL 的内容。

有人能帮我吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-11T20:45:07.317

如果您更好地查看错误日志，您会看到：

> 引起：android.content.ActivityNotFoundException：找不到明确的活动类{com.point/com.point.DisplayMessageActivity}；您是否在 AndroidManifest.xml 中声明了此活动？

那么，您在文件`DisplayMessageActivity`中声明了吗？`AndroidManifest.xml`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-11T20:46:55.287

**将此添加到应用程序标记**下的清单文件中：

```
<activity android:name=".DisplayMessageActivity"></activity> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T20:44:24.117

从您的堆栈跟踪：

```
Unable to find explicit activity class {com.point/com.point.DisplayMessageActivity}; 
have you declared this activity in your AndroidManifest.xml? 
```

[你？](http://developer.android.com/guide/components/activities.html#Declaring)

# javascript - 如何（正确）使用 RowExpander 在网格中呈现附加数据

> ID：11441122
> 
> 赞同：0
> 
> 时间：2012-07-11T20:40:27.457
> 
> 标签：javascript, extjs, extjs4.1

我正在尝试在网格中的 rowbody 中呈现一些数据（使用 RowExpander 插件）。我的问题是 ol'`rowBodyTpl`对我来说还不够，因为这些数据来自正在呈现的记录中的商店记录（嗯……）。

简单地说：网格的每条**记录**都有一个商店（我们称之为**Items**）。所以，我想渲染**记录**数据和**项目**记录的一些数据。

这样做的最佳（ish）方式是什么？

覆盖插件的`renderer`功能，覆盖，还是都不覆盖？`rowexpander``getAdditionalData`

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-23T18:01:08.523

我知道这个问题已经有几年了，但这是我目前用来处理这种情况的一个技巧。它利用了 XTemplates 允许的“逐字”块。这些允许您通过用`{% ... %}`. 在这些代码块中，`this`设置为 XTemplate 本身。XTemplate 有一个`owner`属性，在我们的例子中，它引用了`RowExpander`插件本身，而插件本身又具有一个`grid`引用网格的属性。因此，这样的事情允许您将任意数据添加到传递给`rowBodyTpl`.

```
Ext.create('Ext.grid.Panel', {
    ...
    injectRowBodyData: function(values) {
        values.MyInjectedContent = "Here's some extra data!";
    },
    plugins: [
        {
            ptype: 'rowexpander',
            rowBodyTpl: [
                '{% this.owner.grid.injectRowBodyData(value); %}',
                '<div>',
                    '<h1>{Title}</h1>',
                    '<p>{Content}</p>,
                    '<p>{MyInjectedContent}</p>',
                '</div>'
            ]
        }
    ]
}); 
```

希望 Sencha 将修复该插件，以便在将来提供一种处理此问题的方法。但目前这运作良好。我用 v4.2.1.883 对此进行了测试，但这应该适用于任何以前版本的 Ext 4。我能想到的唯一可能会阻止它在未来工作的是 XTemplate 的`owner`属性不再指向插件，或者插件没有引用带有它的 `grid`属性的网格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T12:22:51.137

我如何“解决”这个问题，它可能会帮助其他人：

我覆盖了**rowexpander**插件的 getRowBodyFeatureData，因为这个函数不仅接收要应用于模板的数据，还接收记录本身，所以我只是`data`从记录中添加了额外的存储/数组。

不确定它是否是最好的方法，但是嘿......至少它有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-10T16:52:38.173

您还可以使用以下`if else`语句`rowBodyTpl`：

**检查 ”：”**

```
"<tpl if='phone == \":\"'>",
"<tpl else>",
"</tpl>" 
```

**检查空字符串**

```
"<tpl if='phone == \"\"'>",
"</tpl>" 
```

此示例取自此处：[链接](https://www.sencha.com/forum/showthread.php?261278-tpl-if-else-question)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-11T21:49:32.407

这是我通常的做法：

```
Ext.create('Ext.grid.Panel',{
border: true,
store: 'ds',
    columns: []
    plugins: [{
            ptype: 'rowexpander',
            rowBodyTpl : ['<p><b>Title:</b>{name}<br/><b>Description:</b> {description}<br/><b>Experiment Design:</b> {experimentdesign}</p>']
    }],
    renderTo: 
}); 
```

# java - 如何在 java 中使用 ImageJ 打开图像

> ID：11441126
> 
> 赞同：2
> 
> 时间：2012-07-11T20:40:32.743
> 
> 标签：java, image-processing, imagej

我想在 java 中使用 ImageJ 框架分析图像。如何打开图像？我需要一个`ImageProcessor`对象才能生成直方图。这是我到目前为止的代码：

```
public void run(ImageProcessor ip) {
        int[] H = new int[256]; // histogram array
        int w = ip.getWidth();
        int h = ip.getHeight();

        for (int v = 0; v < h; v++) {
            for (int u = 0; u < w; u++) {
                int i = ip.getPixel(u, v);
                H[i] = H[i] + 1;
            }
        }

        // ... histogram H[] can now be used
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T00:21:11.763

我使用不适合 ColorProcesser 的医学灰度图像。在那种情况下，我使用

```
Opener opener = new Opener();  
String imageFilePath = "somePath";
ImagePlus imp = opener.openImage(imageFilePath);
ImageProcesser ip = imp.getProcessor(); // ImageProcessor from ImagePlus 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-10T15:40:36.337

我没有看到任何指定您希望如何打开图像的内容，但我在下面添加了一些代码，这些代码将打开文件夹打开器窗口，您可以导航到图像文件夹（我认为它主要用于图像堆栈，但您可以只需将堆栈大小设置为 1，它应该可以打开单个图像）。

```
import ij.plugin.FolderOpener;

// Do this stuff in your run method
FolderOpener fo = new FolderOpener(); // create FolderOpener object
ImagePlus your_imgPlus; // create ImagePlus object
your_imgPlus = fo.open(null); // call FolderOpener.open() 
```

open() 中的 null 参数允许打开文件夹选择窗口，您也可以使用文件路径作为参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T20:43:42.600

首先创建一个`java.awt.Image`，然后用它来构造一个[`ColorProcessor`](http://rsbweb.nih.gov/ij/developer/api/ij/process/ColorProcessor.html)（的子类`ImageProcessor`）对象。

```
Image myImage;
// instantiate myImage
ImageProcessor processor = new ColorProcessor(myImage); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-25T11:27:11.450

```
 File inputFile = new File("someImage.png");
    Image someImage = null;
    try {
        someImage = ImageIO.read(inputFile);
    } catch (IOException e) {
        e.printStackTrace();
    }
    ImagePlus imagePlus = new ImagePlus();
    imagePlus.setImage(someImage);
    ColorProcessor processor = (ColorProcessor) imagePlus.getProcessor(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-29T19:37:09.093

答案很旧，所以可能有一些变化，但我更喜欢使用静态方法 IJ.openImage(java.lang.String path_to_file) [http://rsb.info.nih.gov/ij/developer/api/ij/ IJ.html](http://rsb.info.nih.gov/ij/developer/api/ij/IJ.html)。此方法返回一个 ImagePlus 对象。

我自己使用绝对文件路径，但我怀疑相对路径也应该可以正常工作。如果您希望 ImageProcessor 与 ImagePlus 相关联，请调用 getProcessor()。

# jquery - 如何传递数据和开发应用程序

> ID：11441136
> 
> 赞同：1
> 
> 时间：2012-07-11T20:41:14.723
> 
> 标签：jquery

特别考虑到 js 和 jquery 的使用，试图整理一些一般性的东西。正在通过 stackoverflow 阅读数百万个答案，却没有清楚地了解如何将数据传递给另一个函数以及我们如何构建应用程序。

我得到了非常常见的模式：

```
$(document).ready(function){

   $('.classname').click(function() { 
      var varone = $(this).attr('name');
   });

   $('.class2name').click(function(){
      var vartwo = $(this).height();
   });

}); 
```

然后我从 (document).ready 出去，想做一些处理，比如

```
 function dosmth() {
       var freaksum = varone + vartwo;
    } 
```

我怎么做？我想传递对象，而不是制作全局变量。

处理此类开发大型应用程序的做法是什么？我想要一些函数，它使用来自其他函数的大量变量进行大量操作。如何在我的操作功能中获取所有这些对象？如果我必须在单个函数中而不是在几个不同的函数中使用这些变量怎么办，比如

```
function dosmth() {
   var freaksum = varone + vartwo;
}

function dosmthelse() {
   var freakmult = varone * vartwo;
} 
```

等等等等

抱歉拖了这么久，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:59:11.290

在您当前的示例中，您的两个函数`dosmth`并`dosmthelse`没有对变量的任何访问权限`varone`，`vartwo`因为它们不存在于同一范围内。~~解决此问题的唯一~~一种方法是使这些变量存在于单击事件和函数都可用的范围内。

最简单的方法是简单地将它们设为全局。

```
var varone, vartwo;

$(document).ready(function){
   $('.classname').click(function() { 
      varone = $(this).attr('name');
   });

   $('.class2name').click(function(){
      vartwo = $(this).height();
   });
});
function dosmth() {
   var freaksum = varone + vartwo;
}

function dosmthelse() {
   var freakmult = varone * vartwo;
} 
```

然而，通常最好不要使用全局作用域，所以我们可以这样做：

```
(function($){
    var varone, vartwo;
    $(document).ready(function){
       $('.classname').click(function() { 
          varone = $(this).attr('name');
       });

       $('.class2name').click(function(){
          vartwo = $(this).height();
       });
    });
    function dosmth() {
       var freaksum = varone + vartwo;
    }

    function dosmthelse() {
       var freakmult = varone * vartwo;
    }
})(jQuery); 
```

现在您没有任何全局变量，它们仍然可以在两个地方访问。

您还可以（根据您的情况）将这些值存储在其他地方，例如元素上。

如果没有更多关于你试图解决的现实情况的信息，那就是我能做到的。

# php - 通过 PHP 将 HTML 页面转换为图像？

> ID：11441142
> 
> 赞同：0
> 
> 时间：2012-07-11T20:41:33.843
> 
> 标签：php, image-processing, imagemagick, gd, image-manipulation

我正在寻找一种从 PHP 字符串的输出中自动生成图像（.png、.jpg 或 .gif）的方法。

理想情况下，我正在寻找采用 HTML + CSS 或 URL 的字符串，以所有 HTML / CSS 格式获取该页面的输出，并创建保留格式的图像，然后输出该图像文件。

如果不支持 CSS 格式，则纯 HTML 格式或任何下一个最佳选项都可以。

有什么建议么？

# php - 简单的页面重定向？

> ID：11441146
> 
> 赞同：1
> 
> 时间：2012-07-11T20:41:40.760
> 
> 标签：php, .htaccess, redirect

[我在http://site.com/services/](http://site.com/services/)有一个页面，我只想将其重定向到[http://site.com/servics/first-service/](http://site.com/servics/first-service/)

执行此操作的最佳重定向是什么，我该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-11T20:43:45.267

**PHP**：

```
header("Location: yourpage.php");
exit; 
```

您必须使用`exit`or `die`after`header`才能停止执行您的代码。此外，代码必须在任何输出之前执行。

* * *

**HTML**：

```
<meta http-equiv="refresh" content="0;url=yourpage.php"> 
```

代码应该放在`<head></head>`标签之间。

* * *

**JavaScript**：

```
window.location = "yourpage.php"; 
```

* * *

**.htaccess**：

```
Redirect 301 /oldpage.php /newpage.php 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:45:48.240

这可以通过一个简单的[重定向](http://httpd.apache.org/docs/2.0/mod/mod_alias.html#redirect)指令来完成。

```
Redirect /services /services/first-service 
```

您可以选择发送给客户端的响应代码类型。我提供的链接上的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T20:47:57.457

如果是永久更改，要使用 301 重定向 google 有一些[关于此事的好内容](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=83105)

要构建重定向，只需添加

```
redirect 301 /services/  http://site.com/services/first-service/ 
```

到目录树顶层的 .htacess 。 **注意我将“servcs”从您的示例切换到服务**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T20:43:14.320

在 JavaScript 中：`window.location = "/first-service";`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-18T21:36:20.213

我将此用作文件夹中的索引文件，我不希望公众浏览，，，，

```
 <meta name="robots" content="noindex, nofollow" />
    <meta name="googlebot" content="noindex, nofollow" />

<?php

$url = 'http://' . $_SERVER['HTTP_HOST'];            // Get the server//

header('Location: ' . $url, true, 301);              // Use either 301 or 302//

?> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-07-11T20:43:58.843

你试过 javascript`window.location = "http://site.com/servics/first-service/";`吗？我希望它有效。

# php - 将文件上传到远程服务器的优点

> ID：11441149
> 
> 赞同：0
> 
> 时间：2012-07-11T20:41:45.047
> 
> 标签：php, codeigniter, file-upload, webserver

我的 php 脚本允许用户上传图像并将它们存储在同一服务器的目录中。将用户上传的文件传输到不同 FTP 帐户上的远程服务器时，是否有安全或性能优势？

我想将上传的文件存储在与我的 php 脚本不在同一目录中并连接到我的数据库的服务器上会更安全。你觉得呢？你有没有什么想法？欢迎提供有关如何正确使用远程服务器的建议。

注意：我计划使用 Codeigniter 的[FTP 类](http://codeigniter.com/user_guide/libraries/ftp.html)来处理所有传输，并且我正在将图像 URL 保存到 mysql 中的远程目录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:48:34.917

这并不比将它们存储在同一台服务器上更安全，因为用户只要知道自己的位置就可以执行您的 PHP 脚本。他们可以很容易地找到 PHP 脚本的位置，而无需知道它（并且不会在同一目录中看到图像）。

您将看到性能下降（可能非常明显，具体取决于您访问电子邮件的频率），并且不会看到安全性提高。

如果您不希望用户能够执行您的 PHP 文件，您可以更改指定目录中用户的读取/执行能力（如果您希望用户可以将您的 PHP 文件放在带有照片的文件夹之外）可以访问图像而无需访问 PHP 文件）

如果您担心用户上传您不希望他们上传的文件，您可以通过说“不允许这些文件类型”或“只允许这些文件类型”并检查来限制他们可以上传的文件类型上传文件时使用 PHP。

# php - PHP、CodeIgniter、会话和跟踪 ID

> ID：11441152
> 
> 赞同：1
> 
> 时间：2012-07-11T20:42:07.440
> 
> 标签：php, ios, session

我的网站适用于访问我的受登录保护的 API 页面的 Web 浏览器。但是我正在制作一个需要访问 API 的 IOS 程序（原始 POST，而不是 UIWEBVIEW），但我不知道如何：

**A)**给 iphone 一个会话 ID，并且
**B)**将该会话 ID 发送到服务器以访问 API 页面。

我认为这是访问需要会话/cookie的API页面需要做的事情......

注意：我没有使用任何 CI 会话库 - 自己制作的。CI 将会话存储在文件缓存中，而不是数据库中。

# django - Tastypie - 查询集或过滤器

> ID：11441153
> 
> 赞同：0
> 
> 时间：2012-07-11T20:42:09.813
> 
> 标签：django, tastypie

我正在使用**美味**的派，但我遇到了一个问题。

我的问题：

用户可以发布消息，如果其他用户订阅了该用户，他们可以在他们的主页上看到这些消息。**就像**推特用户发推文和关注者在看他们的推文一样。

我有一个用于所有消息的公共 api。
我可以使用过滤特定用户的消息`?userid=1`

**问题的糟糕解决方案：**
我可以使用过滤多个用户消息（从而解决问题）
`?userid__in=1&userid__=5&...`

但这不是一个好方法，因为 url 长度将增加到可能不允许的数量。（2000 个字符）

有没有更好的方法来做到这一点？
有没有一种方法可以`request.user`在查询**集中**使用来进行连接？
还是我应该使用某种**高级过滤**？

谢谢你！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T01:15:31.270

Tastypie 已经通过 __in 过滤支持这一点（ORM 支持 Tastypie 的所有内容都会公开，除了否定）。无需编码。

看这里：[http ://django-tastypie.readthedocs.org/en/v0.9.11/resources.html#basic-filtering](http://django-tastypie.readthedocs.org/en/v0.9.11/resources.html#basic-filtering)

```
path/to/api/resource/?user_id__in=1,2,3,4,5,6 
```

但是，如果有人订阅了许多用户，您的 URL 仍然会变得很大。相反，您可以做的是将此信息保存在 DB 模型中（哪个用户订阅了哪个用户，作为模型内的递归多对多关系，通过单独的联合模型）。

然后，您可以通过您的资源公开它，而无需通过您的 URL 指定订阅作为参数和/或过滤器。相反，您在资源中的基本查询集将是：

```
userids = request.user.subscription_userset.values(id) 
```

前提是您的模型中有`self`ManyToManyRelationship `User`。看[这里](http://django-tastypie.readthedocs.org/en/v0.9.11/fields.html#tastypie.fields.RelatedField.related_name)，[这里](http://django-tastypie.readthedocs.org/en/v0.9.11/fields.html#tomanyfield)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:44:40.213

如果您让某人传递`user_ids`他们想要查看更新的列表，然后对其进行过滤怎么办？像这样的东西：

`URL: your/api/messages.json?user_ids=5,8,10,25`

然后在代码中将其转换为实际列表，并查询：

`Message.objects.filter(user__id__in=user_ids)`

# mysql - keepalived + MySQL 定期 MISC_CHECK

> ID：11441155
> 
> 赞同：2
> 
> 时间：2012-07-11T20:42:14.270
> 
> 标签：mysql

我已经完成了 Keepalived + MySQL (master - master) 设置。

我将 MASTER 和 BACKUP 的优先级保持不变，因为我不希望它们开始频繁摆动（一次切换 VIP 就足够了）。

如果我使用简单的“vrrp-script”检查 mysql 守护程序是否关闭，此设置工作正常。例如

```
script to check mysql daemon
vrrp_script chk_mysql {
   script "killall -0 mysqld"      # verify the pid is exist or not
   interval 2                           # check every 2 seconds
   weight 2
} 
```

我想通过一个 python 脚本进行更深入的健康检查。我想为此使用 MISC_CHECK。

例如

```
 MISC_CHECK {
           misc_path “script_to_call_python_script.sh xxxx xxxx xxxx xxxx”
           misc_timeout  5
        } 
```

我的查询是：

1.  如何使 MISC_CHECK 以指定的时间间隔运行？
2.  否则，“vrrp_script”中脚本的“必需”输出是什么，以便我可以在那里运行 shell 脚本（运行是周期性间隔）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-25T21:10:46.970

将 python 代码放在一个文件夹中，然后在你的 vrrp_script 中调用它

```
vrrp_script chk_mysql {
   script "location of you python script"      
   interval "the specified interval"                           
   weight 2
} 
```

根据检查将输出设置为 0 或 1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-31T02:12:32.450

正如@nimesh 上面所说， vrrp_script 直接支持 python 脚本。只需将您的 shell/python/rudy 位置与`script "location of you script"`配置一起放置即可。

# python - 有没有办法找到短语并捕获下一个令牌值

> ID：11441161
> 
> 赞同：1
> 
> 时间：2012-07-11T20:42:22.330
> 
> 标签：python, parsing

所以我在服务器上有一个文件：

COADREAD ATF7 Missense_Mutation NGXA-AZ-3984 P17544 A436T

COADREAD ATG10 Missense_Mutation NGXA-AB-A010 Q9H0Y0 H133N

我的目标是找到 id (P17544)，它在文件的第 5 列中并捕获/存储（我需要稍后打印该数字）它后面的令牌数是 436（这个数字应该介于两者之间来自第 6 列 A436T 的两个字母）。我可以这样做吗？我以前用 lxml 工作了一点，但仍然不确定如何做到这一点。提前致谢

这是我所拥有的

文件=打开（'text.txt'，'r'）

查找={}

对于文件中的行：

```
myid, token = file.rsplit(' ', 2)[1:]

token = token[1:-1] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:51:47.073

*使用内置`str`方法*的最简单方法：

```
d = 'COADREAD ATF7 Missense_Mutation NGXA-AZ-3984 P17544 A436T'
myid, token = d.rsplit(' ', 2)[1:] # will except if can't be unpacked so you know you've got exactly 2 elements...
token = token[1:-1] 
```

如果你想指定两个字母之间的数字，你可以使用正则表达式......`re.match('[A-Z](\d{3})[A-Z]', token[1]) # or similar...`

**澄清：**

`d.rsplit(' ', 2)``' '`- 从返回的末尾开始在 s 处拆分字符串`['COADREAD ATF7 Missense_Mutation NGXA-AZ-3984', 'P17544', 'A436T']` 。假设我们只寻找最后两个元素，我们用切片删除第一个元素，所以我们得到`d.rsplit(' ', 2)[1:]`which given `['P17544', 'A436T']`。

使用解包，我们命名我们的变量，并通过使用保证它的长度为 2 `myid, token = d.rsplit(' ', 2)[1:]`- 如果它没有恰好两个元素，则赋值将失败。

现在这`myid`应该是您希望使用切片从令牌中删除第一个和最后一个字符的 id，即`token = token[1:-1]`.

然后：

```
print myid, token
# P17544 436 
```

**关于查找的评论：**

在解析文件行后查找：

```
lookup = {}
for line in file:
    # do steps above so you have myid, token
    lookup[myid] = token 
```

然后lookup['P17544'] 将返回'436'

希望这更清楚...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:46:17.533

听起来很容易...沿空格拆分-然后提取第五个字段...以及第六个字段中的所有数字。还是我错过了什么？

```
>>> tokens = "COADREAD ATF7 Missense_Mutation NGXA-AZ-3984 P17544 A436T".split()
>>> print tokens[4]
P17544
>>> print ''.join([c for c in tokens[5] if c.isdigit()])
436 
```

# java - How to protect a java library from being used in other projects?

> ID：11441170
> 
> 赞同：0
> 
> 时间：2012-07-11T20:42:57.453
> 
> 标签：java, copy-protection

I have developed a java library which I consider as a valuable intellectual property. I want to protect it from being used by unallowed softwares.

I shall say my library has a clean API, and I shall distribute the source code of the project which is using it (not the library) to my customer.

I mean I want to change the library somehow that it only works properly in my company's projects, but no-one else could not use it, in other projects.

What is the best solution to protect the library?

I must add that I can obfuscate the library (but not the customers' application).

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T00:39:36.213

2 possibilities:

*   You want to publish the source code of your app and allow clients to compile it by themselves and to modify the source; In this case, protecting your library is technically impossible, whatever the language.
*   You give the source only for information, you don't want them to compile or modify the source. In this case I see at least 2 levels of security can implement :

    1.  You compile and obfuscate your application **with the source of your library** . That way, all your public API will be obfuscated and so almost unusable (unless someone really want to unobfuscate it, good luck...). You can also repackage your classes, all your library classes will be in the same packages than the app, so it will be very hard to know which files are part of the library and what it is doing.
    2.  You implement a mechanism at compilation that compute a hash of your app jar and modify your library source code to check at runtime that the app is really your app.

I believe that obfuscating is enough. If someone succeed in understanding your obfuscated code, he will crack the solution 2 quite easily.

Except that, you cannot do anything, there is no mechanism for that.

For obfuscating I strongly recommend [Proguard](http://proguard.sourceforge.net/)

# html - 当我在 django 模板输出中有文本和 html 时，如何仅输出 html 图像标签？

> ID：11441171
> 
> 赞同：0
> 
> 时间：2012-07-11T20:43:04.550
> 
> 标签：html, django, django-templates

我正在使用它来输出，

```
{{ movie.img }} 
```

我得到的输出应该是这样的，

```
u'<img src="//upload.wikimedia.org/wikipedia/en/thumb/8/8a/Dark_Knight.jpg/220px-Dark_Knight.jpg" alt="" height="327" width="220" >\nTheatrical release poster' 
```

我如何只输出 html 图像部分？我不希望戏剧发行海报出现在输出中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:58:25.643

由于您只是将其作为文本获取，因此您最好的解决方案是编写一个模板过滤器，该过滤器将去除不在`<img>`html 标记中的内容。

如果对象是 ImageField（或 FileField），则只能调用 url 属性，`{{ movie.img.url }}`

**更新**

好的，这是一个基本的，可能过于幼稚的模板过滤器供您使用。

```
from django import template
from django.template.defaultfilters import stringfilter
import re

register = template.Library()

@register.filter(is_safe=True)
@stringfilter
def get_img_tag(value):
    result = re.search("<.*?>", value)
    if result:
        return result.group()
    return value 
```

采用：

```
{{ movie.img|get_img_tag|safe }} 
```

# php - 使用 php 和 html 选择框过滤 SQL 查询

> ID：11441174
> 
> 赞同：1
> 
> 时间：2012-07-11T20:43:07.017
> 
> 标签：php, mysql, html

我正在开发一个网站，人们可以在其中买卖新车或二手车。我想使用 php 和 sql 语句设置一个简单的过滤器，当然还有 html 选择框（下拉选项）。我已经获得了所有其他选择来帮助并相信我，这非常感谢。然而，我一直试图让“价格过滤器”发挥作用，却一无所获。下面是我在 html 中的选择框的样子。

```
<select name="price" size="0">
<option value="100000">Under $100,000</option>
<option value="<?php echo " BETWEEN '100000' AND '250000' "?>">Between $100,000 and $250,000</option>
<option value=">250000<500000">Between $250,000 and $500,000</option>
<option value=">500000<750000">Between $500, 000 and $750,000</option>
<option value=">7500000">Over $750,000</option>
</select> 
```

这是我对价格变量的 $_POST 语句：

```
$price = mysql_real_escape_string($_POST['price']); 
```

这是我的sql语句：

```
$sql = sprintf("SELECT * FROM  `chjadb_vehicles` WHERE  `v_make` LIKE  '$make'AND `v_year` =  '$year'AND  `v_trans` LIKE  '$trans'AND  `condition` LIKE  '$cond' AND `b_style` LIKE '$b_style' AND `v_price` '$price'"); 
```

之后我有一个应该打印结果的基本循环。现在根据我的理解（正确与否），当用户从下拉菜单中选择特定选项时，“选项值”中的值将传递给 $_POST 语句。之后，它应该将 $price 替换为 BETWEEN '100000' AND '250000' 之间的实际文本，从而完成查询语句。所以从 sql 语句打印出来的最终语句应该是：

```
"SELECT * FROM  `chjadb_vehicles` WHERE  `v_make` LIKE  '$make'AND  `v_year` =  '$year'AND  `v_trans` LIKE  '$trans'AND  `condition` LIKE  '$cond' AND  `b_style` LIKE '$b_style' AND `v_price` BETWEEN '100000' AND '250000'"` 
```

但是我收到此错误：

BETWEEN \'100000\' AND \'250000\' 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 8 行的 '' BETWEEN \'100000\' AND \'250000\' '' 附近使用正确的语法

关于我哪里出错的任何想法？谢谢

问候， D. Ruddock

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T18:18:38.397

行后：

```
$sql = sprintf("SELECT * FROM `chjadb_vehicles` WHERE `v_make` L.... 
```

放：

```
echo "<br><br>".$sql."<br><br>"; 
```

暂且，使用页面时在浏览器中查看最终的SQL查询。找出错误在哪里，然后删除“ `echo`”语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:48:33.473

我自己很新，但我认为您不需要在 BETWEEN 语句中的数字周围加上引号。我想你可以把它们拿出来。如果我错了，我相信我会得到纠正，但这是我的想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:50:08.393

最后的`是错字吗？如果不是，那可能就是问题所在。

# asp.net-mvc-3 - MVC3 razor 将 http 响应流呈现为视图

> ID：11441175
> 
> 赞同：0
> 
> 时间：2012-07-11T20:43:13.400
> 
> 标签：asp.net-mvc-3

我正在尝试在 MVC3 中呈现 HTTP 响应（或通过重定向）。

本质上，我是通过我的控制器的 HTTP 帖子调用 PayPal。这将返回一个表示为字符串的网页。即贝宝“输入您的卡”详细信息屏幕。

如何将其呈现为 MVC 中的视图或弹出窗口？这可能吗？

我试过 Html.raw 但我收到“非法字符”错误消息。

谢谢

错误消息是

路径中的非法字符。

说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.ArgumentException：路径中有非法字符。

源错误：

在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

堆栈跟踪：

```
[ArgumentException: Illegal characters in path.]
   System.IO.Path.CheckInvalidPathChars(String path, Boolean checkAdditional) +10298082
   System.IO.Path.Combine(String path1, String path2) +42
   System.Web.Compilation.DiskBuildResultCache.GetPreservedDataFileName(String cacheKey) +27
   System.Web.Compilation.DiskBuildResultCache.GetBuildResult(String cacheKey, VirtualPath virtualPath, Int64 hashCode, Boolean ensureIsUpToDate) +14
   System.Web.Compilation.BuildManager.GetBuildResultFromCacheInternal(String cacheKey, Boolean keyFromVPP, VirtualPath virtualPath, Int64 hashCode, Boolean ensureIsUpToDate) +206
   System.Web.Compilation.BuildManager.GetVPathBuildResultFromCacheInternal(VirtualPath virtualPath, Boolean ensureIsUpToDate) +51
   System.Web.Compilation.BuildManager.GetVPathBuildResultInternal(VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate) +53
   System.Web.Compilation.BuildManager.GetVPathBuildResultWithNoAssert(HttpContext context, VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate) +103
   System.Web.Compilation.BuildManager.GetVirtualPathObjectFactory(VirtualPath virtualPath, HttpContext context, Boolean allowCrossApp, Boolean throwIfNotFound) +165
   System.Web.Compilation.BuildManager.GetObjectFactory(String virtualPath, Boolean throwIfNotFound) +33
   System.Web.Mvc.BuildManagerWrapper.System.Web.Mvc.IBuildManager.FileExists(String virtualPath) +9
   System.Web.Mvc.BuildManagerViewEngine.FileExists(ControllerContext controllerContext, String virtualPath) +41
        System.Web.Mvc.VirtualPathProviderViewEngine.GetPathFromGeneralName(ControllerContext controllerContext, List`1 locations, String name, String controllerName, String areaName, String cacheKey, String[]& searchedLocations) +140
   System.Web.Mvc.VirtualPathProviderViewEngine.GetPath(ControllerContext controllerContext, String[] locations, String[] areaLocations, String locationsPropertyName, String name, String controllerName, String cacheKeyPrefix, Boolean useCache, String[]& searchedLocations) +288
   System.Web.Mvc.VirtualPathProviderViewEngine.FindView(ControllerContext controllerContext, String viewName, String masterName, Boolean useCache) +136
   System.Web.Mvc.<>c__DisplayClassc.<FindView>b__b(IViewEngine e) +24
   System.Web.Mvc.ViewEngineCollection.Find(Func`2 lookup, Boolean trackSearchedPaths) +141
  System.Web.Mvc.ViewEngineCollection.FindView(ControllerContext controllerContext, String viewName, String masterName) +181
   System.Web.Mvc.ViewResult.FindView(ControllerContext context) +109
   System.Web.Mvc.ViewResultBase.ExecuteResult(ControllerContext context) +121
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResult(ControllerContext controllerContext, ActionResult actionResult) +13
   System.Web.Mvc.<>c__DisplayClass1c.<InvokeActionResultWithFilters>b__19() +23
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation) +242
   System.Web.Mvc.<>c__DisplayClass1e.<InvokeActionResultWithFilters>b__1b() +21
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult) +177
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +324
   System.Web.Mvc.Controller.ExecuteCore() +106
   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +91
   System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +10
   System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__5() +34
   System.Web.Mvc.Async.<>c__DisplayClass1.<MakeVoidDelegate>b__0() +19
   System.Web.Mvc.Async.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _) +10
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
   System.Web.Mvc.<>c__DisplayClasse.<EndProcessRequest>b__d() +48
   System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +60
       System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +9478661
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +178 
```

我的剃须刀代码是

```
@model string

@{    ViewBag.Title = "Order Submitted"; }

@if (Model != null)
{
    Html.Raw(Model);
   //Html.RenderPartial("TestView", Model);
} 
```

我将网页作为字符串传递并尝试呈现它 - 这实际上可能吗？

# c++ - 如何编译 C++ 项目（使用 g++）以在其他计算机上使用？

> ID：11441181
> 
> 赞同：2
> 
> 时间：2012-07-11T20:43:36.103
> 
> 标签：c++, opencv, compilation, g++

这可能很明显，但我想在我做任何轻率的事情之前确定要做什么。我想将我的 C++ 程序、库和所有内容编译为发布可执行文件，以便该文件可以在任何计算机上运行（运行相同的操作系统）。现在，我在 Mac OS X (10.7.4) 上，我需要能够在其他 Mac 上运行我的可执行文件。问题是我在我的项目中使用 OpenCV 库，而我只在这台计算机上安装了它。有没有办法用 g++ 编译，如果我在没有安装 OpenCV 库的计算机上打开这个程序，它仍然可以工作？如，将所有依赖项构建到可执行文件中。或者这会自动发生吗？

我对“.o”目标文件也很陌生，那么这些与它有什么关系吗？我更喜欢将它全部放入一个文件的方法，但只要它有效，我就会接受一个包。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T22:19:21.210

要扩展 molbdnilo 的答案，您需要创建一个应用程序包（请参阅[Apple Bundle Programming guide](https://developer.apple.com/library/mac/#documentation/CoreFoundation/Conceptual/CFBundles/Introduction/Introduction.html)）。您需要将控制台应用程序移动到`MyApp.app/Contents/MacOS/MyApp`. 还有一个 Frameworks 目录，您需要在其中添加 OpenCV 库作为框架。有关 OpenCV 框架的一些信息，请参阅[OpenCV Wiki](http://opencv.willowgarage.com/wiki/PrivateFramework)。框架（最简单的）几乎是一个包装在特定目录结构中的动态库。

我建议考虑`Xcode`在 mac 上使用，因为与通过脚本和 Makefile 自己做相比，它简化了包的构建和链接到框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:01:46.163

有两种方法可以做到这一点。如果您不打算与您要链接的任何库遇到许可问题，您可以静态链接。这很容易通过使用来处理。`g++ -o myApp -static -lopencv myapp.cpp` 但是，这也取决于您要链接到的库的现有静态库。如今，大多数使用共享库分发静态库。

另一种方法是分发共享库并告诉您的应用程序强制它使用`-rpath`. 注意：我是在告诉你 Linux 的方法，它可能在 Mac 上可以工作，但我无法测试。

所以说你所有的共享库都和你的可执行文件在同一个目录下，你可以编译：`g++ -rpath ./ -lopencv -o YourApp yourApp.cpp`

我希望这有帮助。

# c# - 带有表达式树的复杂构建器方法

> ID：11441191
> 
> 赞同：2
> 
> 时间：2012-07-11T20:43:59.830
> 
> 标签：c#, .net, linq, expression-trees

假设我必须在运行时创建以下方法

```
Type someType = ...; // assigned somewhere

var method = (presenter) => 
{
    var instance = new SomeType(); // I've only default constructor here
    instance.SomeProperty = presenter;
    return instance;
} 
```

有人知道如何在运行时使用表达式树创建这样的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T21:12:16.253

这里的关键是用来`Expression.Block`获取multi statement lambda。你可以使用类似的东西：

```
void Main()
{
    var p = Expression.Parameter(typeof(int), "presenter");
    var instance = Expression.Variable(typeof(Foo), "instance");
    var ctor = typeof(Foo).GetConstructor(new Type[0]);
    var block = Expression.Block(new [] { instance },
        Expression.Assign(instance, Expression.New(ctor)),
        Expression.Assign(Expression.Property(instance, "SomeProperty"), p),
        instance
    );

    var lambda = Expression.Lambda<Func<int,Foo>>(block, p);
    Foo f = lambda.Compile()(5);
    Console.WriteLine(f.SomeProperty);
}

class Foo 
{
    public int SomeProperty {get;set;}
} 
```

当然，您需要调整它以适应您的需求，哪些部分是可变的，哪些不是，等等，但它展示了总体思路。

# webkit - 使用 webkit 进行无头浏览

> ID：11441192
> 
> 赞同：13
> 
> 时间：2012-07-11T20:44:00.463
> 
> 标签：webkit, google-chrome-devtools, phantomjs

我正在使用基于 webkit 的工具来构建用于抓取网页的无头浏览器（我需要这个，因为我想评估在页面上找到的 javascript 并获取最终呈现的页面）。但是，到目前为止，我实施的两个不同的系统表现出非常差的性能。我已经实现了两个不同的系统，它们都使用 webkit 作为后端：

1.  使用 Google Chrome：我将启动 Google Chrome 并使用 Chrome 公开的 webSockets 与每个选项卡进行通信以进行远程调试（[通过有线调试](https://developers.google.com/chrome-developer-tools/docs/remote-debugging#remote)）。这样我可以控制每个选项卡，加载一个新页面，一旦页面加载，我就可以获取加载网页的 DOM。
2.  使用[phantomjs](http://code.google.com/p/phantomjs/wiki/QuickStart)：phantomjs 使用 webkit 加载页面并提供无头浏览选项。正如 phantomjs 示例中所解释的，我使用 page.open 打开一个新 URL，然后在页面加载后通过评估页面上的 javascript 来获取 dom。

我的目标是尽可能快地抓取页面，如果页面在前 10 秒内没有加载，则声明它失败并继续前进。我知道每个页面都需要一段时间才能加载，因此为了增加每秒加载的页面数，我在 Chrome 中打开了许多选项卡或使用 phantomjs 启动多个并行进程。以下是我观察到的表现：

1.  如果我在 Chrome / 20 个 phantomjs 实例中打开超过 20 个选项卡，CPU 使用率就会飙升。
2.  由于 CPU 使用率很高，很多页面的加载时间超过 10 秒，因此我的失败率更高（大约 80% 的页面加载请求失败）
3.  如果我打算将失败保持在总请求数的 5% 以下，我每秒加载的 URL 不能超过 1 个。

在尝试了这两个基于 webkit 的系统之后，感觉性能瓶颈是 webkit 渲染引擎，因此想从这里的其他用户那里了解我每秒可以抓取的 URL 数量。我的硬件配置是：

1.  处理器：Intel® Core™ i7-2635QM（1 个处理器，4 个内核）
2.  显卡：AMD Radeon HD 6490M (256MB)
3.  内存：4GB
4.  网络带宽足以加载页面超过我观察到的性能

我想问这个邮件列表的问题是，有没有人有使用 webkit 为一组随机 URL 抓取网页的经验（比如从 twitter 流中选择 10k 个 URL），我可以合理地期望每秒抓取多少个 URL ?

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-30T18:01:11.267

这个问题实际上与硬件比软件更相关，但无论如何让我为您指出一些更好的方向。

首先，要了解每个页面本身都会产生多个线程。它将下载页面，然后开始为页面上的元素（如 javascript 文件、css 文件和图像）生成新的下载线程。[参考：[http](http://blog.marcchung.com/2008/09/05/chromes-process-model-explained.html) ://blog.marcchung.com/2008/09/05/chromes-process-model-explained.html ]

因此，根据页面的结构，您最终可能会为页面同时运行相当数量的线程，再加上您尝试一次执行太多加载，您就会遇到问题。

[Optimal number of threads per core](https://stackoverflow.com/questions/1718465/optimal-number-of-threads-per-core)的 Stack Overflow 线程提供了有关您遇到的情况的更多信息。你的CPU超载了。

您的处理器是 4 个物理 8 个逻辑核心。我建议一次生成不超过 4 个连接，让辅助逻辑核心在那里处理一些线程。你可能会发现你甚至需要减少这个数字，但 4 是一个很好的起点。通过一次渲染第 4 页而不是让整个系统超载尝试渲染 20 页，您实际上会提高整体速度，因为您最终会获得更少的缓存交换。首先根据几个容易计时的位置计时您的时间。然后尝试越来越少。会有一个甜蜜点。请注意，PhantomJS 的无头浏览器版本可能会更好，因为在无头模式下它可能不会下载图像（一个加号）。

不过，您最好的整体选择是使用[http://www.webkit.org/](http://www.webkit.org/)上的 webkit 源代码自己渲染部分页面。由于您似乎只需要呈现 html 和 javascript。这减少了您的连接数量，并允许您以更高的效率控制您的线程。在这种情况下，您可以创建一个事件队列，将您的所有主 url 放到那里。产生 4 个工作线程，它们都在工作队列之外工作，因为它们处理页面并需要下载更多源，他们可以将这些进一步下载添加到队列中。一旦页面的所有文件都下载到内存（或磁盘，如果您担心内存）的特定 url，您就可以将一个项目添加到事件队列中以呈现页面，然后根据需要对其进行解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T04:40:10.237

取决于您要解析的数据，如果您只关心 javascript 和 html ，那么超文本查询语言将提供巨大的加速，[http://htql.net/](http://htql.net/)，或者您可以考虑在云中设置一些东西如[http://watirmelon.com/2011/08/29/running-your-watir-webdriver-tests-in-the-cloud-for-free/](http://watirmelon.com/2011/08/29/running-your-watir-webdriver-tests-in-the-cloud-for-free/)

# mysql - 将 JSON 数组添加到 MYSQL

> ID：11441195
> 
> 赞同：0
> 
> 时间：2012-07-11T20:44:14.047
> 
> 标签：mysql, arrays, json

我正在尝试通过数组名称获取特定值：

```
<?php
$json = json_decode($_POST['json'], true);

print_r($json);
?> 
```

我得到这个变量：

```
Array
(
    [0] => Array
        (
            [name] => pav
            [value] => g
        )

    [1] => Array
        (
            [name] => ppav
            [value] => f
        )

    [2] => Array
        (
            [name] => kiekis
            [value] => g
        )

    [3] => Array
        (
            [name] => kaina
            [value] => g
        )

    [4] => Array
        (
            [name] => ppav
            [value] => f
        )

    [5] => Array
        (
            [name] => kiekis
            [value] => g
        )

    [6] => Array
        (
            [name] => kaina
            [value] => f
        )

    [7] => Array
        (
            [name] => ppav
            [value] => g
        )

) 
```

尝试使用 foreach 函数，但无法获得特定值：

```
foreach ($json as $key => $value) {
    echo "name".$key['name']." value".$value['value']."<br />";
} 
```

它打印所有数组值：

```
name value<br />name valueasd<br />name valueasd<br />name values<br />name values<br />name values<br />name values<br />name valuea<br />name valueasd<br />name valued<br /> 
```

但我无法按名称选择特定值添加到 nysql。怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T12:40:32.247

以下是经过测试的代码

```
<?php
    $json_array = array(
                    array('name'=>'pav', 'value'=>'g'),
                    array('name'=>'ppav', 'value'=>'f'),
                    array('name'=>'kiekis', 'value'=>'g'),
                    array('name'=>'ppav', 'value'=>'f')
                    );

    echo "<pre>";
    print_r($json_array);
    echo "</pre>";

    $assoc_array = array();

    for($i = 0; $i < sizeof($json_array); $i++)
    {
        $key = $json_array[$i]['name'];
        $assoc_array[$key] = $json_array[$i]['value'];
    }

    echo "<pre>";
    print_r($assoc_array);
    echo "</pre>";

    echo "assoc_array['pav'] = ".$assoc_array['pav'];
?> 
```

下面给出了代码的输出，您可以看到与您的数组完全相同的数组被转换为关联数组，这是一个问题，因为您的数组具有重复的名称，例如。ppav 或 kiekis，因此只有 1 个 kiekis 或 ppav 索引具有最新值。

![在此处输入图像描述](../Images/c0968880733727246359fc9ef47a46a9.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T08:30:53.707

你必须重新创建数组

```
$json_array = json_decode($_POST['json'], true);
$assoc_array = array();

for($i = 0; $i < sizeof($json_array); $i++)
{
     $key = $json_array[$i]['name'];
     $assoc_array[$key] = $json_array[$i]['value'];
} 
```

在此之后，您将获得 $assoc_array 并且您可以通过键访问其元素。

# android - 在Android中从URL获取图像到ImageView的最佳方法是什么

> ID：11441198
> 
> 赞同：0
> 
> 时间：2012-07-11T20:44:25.207
> 
> 标签：android

当单击按钮时，我正在使用一种方法从 URL 获取图像，但是它花费了太多时间，大约 4-5 秒才能使用 3G 而不是 wi-fi 显示大小仅为 6 kb 的图像。

我的方法是这样的；

```
public static Bitmap getBitmapFromURL(String src) {
    try {
        Log.e("src",src);
        URL url = new URL(src);
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        connection.setDoInput(true);
        connection.connect();
        InputStream input = connection.getInputStream();
        Bitmap myBitmap = BitmapFactory.decodeStream(input);
        Log.e("Bitmap","returned");
        return myBitmap;
    } catch (IOException e) {
        e.printStackTrace();
        Log.e("Exception",e.getMessage());
        return null;
    }
} 
```

接着;

```
 Bitmap bimage =  getBitmapFromURL("http://www.replikler.net/test2.jpg");
    ImageView image = (ImageView)findViewById(R.id.movie_image);
    image.setImageBitmap(bimage); 
```

您知道从 url 获取图像的另一种方法（更快）吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T20:56:30.713

```
imageView.setImageDrawable(Drawable.createFromStream((InputStream)new URL(url).getContent(), "src")); 
```

# php - 使用 PHP 添加 CSS if 语句？

> ID：11441210
> 
> 赞同：0
> 
> 时间：2012-07-11T20:45:57.063
> 
> 标签：php, css, if-statement

我有一个 if 语句，它只在周日和周三显示倒计时。但是，我还需要为主体添加填充以使其正确显示。

所以基本上我需要在执行一行php时为body添加填充。

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:50:47.533

为了使您的样式和 HTML 分开，您可以基于相同的 if 语句向正文添加一个类。然后使用您的 CSS 为该类添加样式：

```
<?php 
$dayOfWeek = date( "w", $timestamp);
if ($dayOfWeek == 0 || $dayOfWeek == 3) { ?>
    <body class="withCountdown">
<?php } else { ?>
    <body>
<?php } ?>

body.withCountdown {
    padding: 10px;
} 
```

（请原谅我生疏的 PHP 语法！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T20:51:45.740

```
<body style="padding:<?php echo(is_sunday() ? '4px' : '0' );?>" > 
```

# c++ - 将自午夜以来的毫秒转换为时间对象

> ID：11441212
> 
> 赞同：0
> 
> 时间：2012-07-11T20:46:11.497
> 
> 标签：c++, time

我有一个传入的数据馈送，它给了我一个自午夜以来毫秒数的整数。

我想把它转换成某种时间对象，这样我就可以显示时间了。

例如，1000 = 00:00:01

有没有一种简单的方法可以做到这一点？我需要时间结构吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:59:06.103

您可以为此使用一个小助手结构，但这对于您的简单请求可能有点过分：

```
#include <iostream>
#include <iomanip>    

struct MidnightTime{
    MidnightTime(unsigned int miliseconds) : 
    seconds((miliseconds/1000) % 60), 
    minutes((miliseconds/60000) % 60),
    hours((miliseconds/3600000) % 24){}

    unsigned int seconds, minutes, hours;
};

std::ostream& operator<<(std::ostream& out, const MidnightTime& t){
    out << std::setfill('0') << std::setw(2) << t.hours << ":" <<
           std::setfill('0') << std::setw(2) << t.minutes << ":" << 
           std::setfill('0') << std::setw(2) << t.seconds;
    return out;
}

int main(){
    std::cout << MidnightTime(1000) << std::endl; // will result in 00:00:01
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:50:04.507

```
x = ms / 1000
seconds = x % 60
x /= 60
minutes = x % 60
x /= 60
hours = x % 24 
```

然后你可以`cout`为你解析的时间。这仅适用于自午夜以来的持续时间。它不会显示日期。

# python - python 可重用的用户错误处理

> ID：11441217
> 
> 赞同：0
> 
> 时间：2012-07-11T20:46:33.140
> 
> 标签：python, error-handling, functional-programming, user-defined

我一直在玩弄错误处理。特别是用户定义的错误。

但是我不确定以下方法是否是一个坏主意/推荐/很奇怪？

```
import operator
from functools import partial

class GenericError(Exception):
    def __init__(self, value):
        self.value = value
    def __str__(self):
        return repr(self.value)

def errorhandle(error, func):
    print(func.__name__, "says: ", error)
# or perhaps error_dictionary[error]

def f_test_bool(x, bo, y, et, m, ef):
    """ generic boolean test. If boolean_operator(x,y) == True -->  raise passed in Error """
    try: 
        if bo(x,y):
            raise et(m)
        else:
            return x
    except et as err:
        ef(err, f_test_bool)

partial_ne = partial(f_test_bool, 
                     bo=operator.__ne__, 
                     et=GenericError, 
                     ef=errorhandle)

partial_ne( x = 5, 
            y = 6, 
            m = "oops, 5 is not equal to 6" )

>>> imp.reload(errorhandling)
f_test_bool says:  'oops, 5 is not eqal to 6' 
```

我的想法是，通过这种方式，我可以拥有一个可以重用的简单模块，并通过管道传递值，而无需将用户定义的错误添加到我编写的任何新函数中。我认为这会让事情变得更干净。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T20:53:56.517

您为应该简单明了的事情增加了很多开销。不要忘记[禅](http://www.python.org/dev/peps/pep-0020/)：

> 简单胜于复杂。

为什么不简单：

```
if 5 != 6:
   raise ValueError('oops, 5 is not equal to 6') 
```

# javascript - Javascript 客户端哪些数据库可用，不包括浏览器特定的数据库

> ID：11441218
> 
> 赞同：0
> 
> 时间：2012-07-11T20:46:36.817
> 
> 标签：javascript, database, html

试图确定哪些实际的非浏览器 (HTML 5) 特定数据库可用于 JavaScript 客户端编程。我不想使用 activeX 控件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-23T13:28:39.353

如果您正在客户端上寻找 NoSQL 风格的数据库，您可以查看[http://www.forerunnerdb.com](http://www.forerunnerdb.com)。如果您希望 DOM 自动反映对数据的更改，它支持与 MongoDB 相同的查询语言并具有数据绑定模块。

它也是开源的，不断更新新功能，并且它周围的社区正在迅速发展。

*免责声明，我是该项目的首席开发人员。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T00:24:06.360

最初 W3C 创建了[Web SQL](http://www.w3.org/TR/webdatabase/)，但它不再有效。当前的风格是[索引数据库 API](http://www.w3.org/TR/IndexedDB/)，它是一个独立的规范，但需要支持[DOM 3 事件](http://www.w3.org/TR/IndexedDB/#bib-DOM-LEVEL-3-EVENTS)、[HTML5](http://www.w3.org/TR/IndexedDB/#bib-HTML5)、[WebIDL](http://www.w3.org/TR/IndexedDB/#bib-WEBIDL)和[WebWorkers](http://www.w3.org/TR/IndexedDB/#bib-WEBWORKERS)。

最近的浏览器应该提供一些支持，但我认为它并不那么完整，当然也不是无处不在。如果你的目标是流行的移动设备或最近的桌面浏览器，你可能没问题。

# git - Git合并与无关文件冲突？

> ID：11441219
> 
> 赞同：0
> 
> 时间：2012-07-11T20:46:51.147
> 
> 标签：git, merge, conflict

当尝试从我们软件的一个较旧版本分支合并到主版本时，我在 Git 1.7.5.4 中遇到了一些非常奇怪的行为。

```
$ git checkout master
$ git merge 0.1.2.3
[...]
Auto-merging ProjectA/src/main/groovy/com/example/package/Something.groovy
CONFLICT (content): Merge conflict in ProjectA/src/main/groovy/com/example/package/Something.groovy
[...]
Automatic merge failed; fix conflicts and then commit the result. 
```

看着那个文件，我看到了一些非常奇怪的东西：

```
$ cat ProjectA/src/main/groovy/com/example/package/Something.groovy

<<<<<<< HEAD
[contents of ProjectA/src/main/groovy/com/example/package/Something.groovy]
=======
[contents of ProjectC/src/main/groovy/com/example/something/Different.groovy !!]
>>>>>>> 0.1.2.3 
```

该`Something.groovy`文件在另一个分支上不存在。该`Different.groovy`文件不再存在于 master 分支上。我本来希望收到关于文件不存在的合并冲突警告。我没想到它会错误地与另一个项目中完全不相关的文件相关联。

知道什么会导致这样的事情吗？我不认为这是哈希冲突，使用`git log --raw`and查看文件历史的哈希值`git show --raw`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T05:39:49.923

我会获取最新版本的 git 并再次尝试。你用的那个已经一岁多了。

其次，检查文件内容是否相似。Git 根据内容检测文件的移动，并将使用它来帮助合并分支。

# java - 如何在 java 中获取 jpg 的像素尺寸？

> ID：11441222
> 
> 赞同：1
> 
> 时间：2012-07-11T20:46:57.277
> 
> 标签：java, image, file

我需要找到一种方法来计算图像的长度和宽度（这是一个.jpg）我有文件的长度但它没有用，因为我想创建一个数组来存储关于每个像素的信息我正在使用的图像文件。

```
public void getImageData(){
    File f= new File("myPicture.jpg");
    this.length = (int) f.length();
        System.out.println("length of file = " + length);
        BufferedImage image = null;
        try {
            image = ImageIO.read(f);
            } 
        catch (IOException e) {

            e.printStackTrace();
            } 
```

非常感谢帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:50:13.477

一旦你得到`BufferedImage`，你可以调用属性[`getWidth()`](http://docs.oracle.com/javase/7/docs/api/java/awt/image/BufferedImage.html#getWidth%28%29)和[`getHeight()`](http://docs.oracle.com/javase/7/docs/api/java/awt/image/BufferedImage.html#getHeight%28%29)它：

```
int imageWidth = image.getWidth();
int imageHeight = image.getHeight(); 
```

希望这可以帮助。

# jquery - 使用 jQuery 打印表单

> ID：11441227
> 
> 赞同：0
> 
> 时间：2012-07-11T20:47:21.920
> 
> 标签：jquery

所有，我的页面上有以下 HTML/PHP：

```
if(isset($_GET['user_id']) && $_SESSION['role']=="admin"){
$user_id = $_GET['user_id'];
}else{
$user_id = $_SESSION['user_id'];
}
?>
<button id="print_timeline" value="<?php echo $user_id; ?>">Print Timeline</button> 
```

当我单击按钮时，我得到了以下 jQuery：

```
jQuery("#print_timeline").click(function(event){
    var user_id = jQuery(this).val();
    window.location.href = site_url + 'print.php/?user_id=' + user_id;
}); 
```

我正在尝试在不离开当前页面的情况下打印 print.php 页面，只需打开打印机属性即可打印我的 print.php 页面。在我的 print.page 上，我有以下代码可以自动打印它：

```
<body onload="window.print()"> 
```

知道如何实现这一目标吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:04:03.403

当您这样做时，`window.location.href=...`您将离开当前页面。您可能想要使用`window.open`打开一个“弹出窗口”并保持原始页面仍然存在

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:13:01.853

您可以使用 AJAX 加载页面...

# c++ - 我应该如何使用新的 C++11 标准来编程 C++？

> ID：11441237
> 
> 赞同：4
> 
> 时间：2012-07-11T20:48:25.867
> 
> 标签：c++, c++11

我已经编写 C++ 有一段时间了，我习惯于做以下事情：

```
vector<int> vi;
for (vector<int>::const_iterator it = vi.begin(); it != vi.end(); ++it) {
    // do something with it
} 
```

然而，新的 C++ 标准 C++11 引入了`auto`关键字，因此我可以编写如下内容：

```
vector<int> vi;
for (auto it : vi ) 
    // do something with it
} 
```

我应该开始在我的代码中使用它，还是应该使用迭代器方法？

同样的问题也适用于新 C++11 标准中的许多其他事情。我是否应该开始在我的代码中使用新事物而忘记旧的做事方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:03:35.940

这取决于项目和编译器支持。C++11 增加了很多东西来让你的程序更易读、更快、更健壮等等。

C++11 的唯一缺点是并非所有平台都支持它。您的项目要求可能要求支持不支持 C++11 的平台或编译器，或者迁移到 C++11 所获得的价值可能不如放弃缺少 C++11 的编译器或平台所失去的价值支持。

这不是一个全有或全无的决定。您可能可以选择一些适合您的功能并决定留下一些其他功能，直到稍后您的更多编译器有更好的支持。

不同的项目会有所不同，判断将取决于你对 C++11 带来的各种好处的重视程度与对旧平台支持的重视程度。随着时间的推移，C++11 会变得更加有利，直到毫无疑问，但现在您只需要查看您的项目并决定您是否可以接受 C++11 以及哪些部分可以接受。

# vb.net - VB.NET ~ How can I encapsulate my code to be used over and over?

> ID：11441238
> 
> 赞同：1
> 
> 时间：2012-07-11T20:48:28.190
> 
> 标签：vb.net, browser, encapsulation

I know I seem to ask the same types of questions but with much trial and error I finally got my app to do what I needed it to do. I have a form with a button on it. When clicked it creates a form, a web browser, a picture box, a text box, and a button.

The web browser, picture box, textbox, and the button are all placed onto this form at run time.

My question is now how can I encapsulate this to be used over and over again. I've tried just putting this into a class and creating an instance of the class but I keept getting an error on my document completing stating my code isn't referring to an object.

But here is my code.

Thanks

```
Public Class CaptchaWindow
Dim myform As New Form
Dim webbrowser As New WebBrowser
Dim picturebox As New PictureBox
Dim textbox As New TextBox
Dim submitbtn As New Button
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
ProfileMaker.Show()
End Sub

Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
Call myspecs()

AddHandler submitbtn.Click, AddressOf captchasubmit
AddHandler webbrowser.DocumentCompleted, AddressOf webcompleteddesignfloat
webbrowser.Navigate("http://www.designfloat.com/register/")

End Sub

Sub myspecs()

'FORM SIZE AND LOCATION
myform.Size = New Drawing.Size(1542, 771)
myform.Location = New Drawing.Point(15, 15)

'WEBBROWSER SIZE AND LOCATION
webbrowser.Size = New Drawing.Size(1000, 577)
webbrowser.Location = New Drawing.Point(12, 181)
webbrowser.ScriptErrorsSuppressed = True

'PICTUREBOX SIZE AND LOCATION
picturebox.Size = New Drawing.Size(299, 83)
picturebox.Location = New Drawing.Point(12, 12)
picturebox.BorderStyle = BorderStyle.Fixed3D

'TEXBOX SIZE AND LOCATION
textbox.Size = New Drawing.Size(299, 20)
textbox.Location = New Drawing.Point(12, 101)

'BUTTON SIZE AND LOCATION
submitbtn.Size = New Drawing.Size(75, 23)
submitbtn.Location = New Drawing.Point(118, 127)
submitbtn.Text = "Submit"

myform.Controls.Add(webbrowser)
myform.Controls.Add(picturebox)
myform.Controls.Add(textbox)
myform.Controls.Add(submitbtn)
myform.Show()

End Sub

Sub webcompleteddesignfloat()
For Each element As HtmlElement In webbrowser.Document.GetElementsByTagName("input")
If element.GetAttribute("name") = "reg_username" Then
element.SetAttribute("value", ProfileMaker.Username.Text)
End If
Next

For Each element As HtmlElement In webbrowser.Document.GetElementsByTagName("input")
If element.GetAttribute("name") = "reg_email" Then
element.SetAttribute("value", ProfileMaker.Email.Text)
End If
Next

For Each element As HtmlElement In webbrowser.Document.GetElementsByTagName("input")
If element.GetAttribute("name") = "reg_password" Then
element.SetAttribute("value", ProfileMaker.Password.Text)
End If
Next

For Each element As HtmlElement In webbrowser.Document.GetElementsByTagName("input")
If element.GetAttribute("name") = "reg_password2" Then
element.SetAttribute("value", ProfileMaker.Password.Text)
End If
Next

If webbrowser.ReadyState = WebBrowserReadyState.Complete Then
For Each Captcha As HtmlElement In webbrowser.Document.Images
If Captcha.GetAttribute("src").Contains("http://www.google.com/recaptcha/api/image?    c=") Then
picturebox.Load(Captcha.GetAttribute("src"))
End If
Next
End If

End Sub

Sub captchasubmit()

If webbrowser.ReadyState = WebBrowserReadyState.Complete Then
For Each Captcha As HtmlElement In webbrowser.Document.Images
If Captcha.GetAttribute("src").Contains("http://www.google.com/recaptcha/api/image?c=") Then
picturebox.Load(Captcha.GetAttribute("src"))
End If
Next
End If

For Each element As HtmlElement In webbrowser.Document.GetElementsByTagName("input")
If element.GetAttribute("id") = "recaptcha_response_field" Then
element.SetAttribute("value", textbox.Text)
End If
Next

For Each element As HtmlElement In webbrowser.Document.GetElementsByTagName("button")
If element.GetAttribute("name") = "submit" Then
element.InvokeMember("click")
End If
Next

myform.Dispose()

End Sub 
```

The below part is when I tried to create an instance of this from a class.

```
Private Sub Button3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button3.Click
Dim mystuff As New CaptchaClass
mystuff.Handler()
mystuff.captchasubmit()
mystuff.webcompleteddesignfloat()

End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:58:02.137

You should `Imports` your class namespace to the current scope (page) at the beggining of the code

```
Imports Namespace.CaptchaWindow

Class Page1

Private Sub Button3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button3.Click
Dim mystuff As New CaptchaClass
End Sub

End Class 
```

Also look at [Namespaces](http://www.vbdotnetheaven.com/uploadfile/ggaganesh/namespacesinvbdotnet04202005005133am/namespacesinvbdotnet.aspx) if you doesn't know what it is.

# wpf - 绑定到字典

> ID：11441243
> 
> 赞同：0
> 
> 时间：2012-07-11T20:48:44.860
> 
> 标签：wpf, mvvm, observablecollection, ivalueconverter

我想我有一个相当有趣的问题。我有一个模型，其中主要数据结构确实需要是字典。我想将该字典的值绑定到列表框。我有一个 ObservableDictionary 类，可以在必要时触发集合更改事件。不幸的是，如果我绑定到这个可观察的字典，列表框将填充 KeyValuePairs，我无法为其创建 IValueConverter，因为 KeyValuePairs 不是对象，它们是结构。xaml 中有什么方法可以指定我想要所有 Pairs 的 .value 吗？

如果我只是在我绑定的属性中返回 Dictionary 的值，则该列表是不可观察的，因此不会随字典更新。有没有办法在绑定到集合时使用 INotifyPropertyChanged 强制 UI 更新？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T20:50:37.293

使用[`DisplayMemberPath`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.displaymemberpath.aspx)或[`ItemTemplate`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemtemplate.aspx)。

# dojo - 我可以在 Bottle 模板中使用 dojo 框架吗？如果可以，如何使用？

> ID：11441245
> 
> 赞同：1
> 
> 时间：2012-07-11T20:49:02.293
> 
> 标签：dojo, bottle

我已经在网站中使用了 dojo 框架，效果很好，我正在尝试在我的瓶子模板中使用它，但没有成功。我正在从谷歌的托管版本中加载 claro 主题和 dojo javascript。不过，我的 dijit 都没有出现。我无法在 Bottle 中使用外部库，还是缺少一些基本的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T16:01:21.010

是的，您可以将外部库与 Bottle 一起使用。如果您有问题，请检查您的 HTML。例如，如果您缺少结束标记，则事情不会按预期工作。

# facebook-graph-api - 从 Facebook API / FQL 获取帖子洞察数据

> ID：11441248
> 
> 赞同：1
> 
> 时间：2012-07-11T20:49:21.780
> 
> 标签：facebook-graph-api, facebook-fql, facebook-insights

Facebook 洞察仪表板有一个网格，显示所有最近的帖子以及覆盖率/参与度/病毒式指标。如何从 Facebook 的图形 API 或 FQL 中提取这种类型的帖子数据？

![Facebook 洞察仪表板](../Images/352578d69ea0f9d706155b6f20b2f6e2.png)

# c++ - 是否有用于封装线程行为的通用设计模式或面向对象的方法？

> ID：11441250
> 
> 赞同：1
> 
> 时间：2012-07-11T20:49:31.403
> 
> 标签：c++, multithreading, oop, design-patterns, pthreads

我最近一直在 Linux 上使用 pthreads，并希望在不久的将来开始研究使用 boost 线程。我从未使用过 MS Visual Studio，所以我不知道那里的方法，但我（必须）使用 Embarcadero C++ Builder（以前称为 Borland）我发现它的少数好东西之一是它有一个内置的类`TThread`。这是一个可以派生的类，以提供良好封装的数据以及启动和终止函数。我更喜欢这种方法而不是传递函数的 pthread 方式和`void*`被传递到线程创建函数中。我想知道是否有某种设计模式或结构通常用于提供以这种方式封装线程功能的更加面向对象的设计模式或结构？我可以尝试自己创建它，但我不能成为第一个渴望这种方法的人，我想知道是否有一种“标准”的方式来实现它。

编辑：或者，如果这是一个非常糟糕的主意，也许可以说明为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:01:46.720

我认为最*标准*的方法是使用标准线程库（与 密切相关`boost::thread`，而不是 100% 相同）。我会避免重新设计已经由专家委员会设计、审查和验证的东西。

另请注意，对于您在评论中提到的那种操作，您可能需要查看标准库的*未来*部分（再次类似于 boost 对应部分），尤其是`std::asynch`函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:02:46.823

我喜欢 boost::thread 的设计方式（我在 Rouge Wave 的线程库中看到了类似的设计）。基本上，通过传递要执行的函数来启动线程，然后可以使用该线程对象来加入该线程。pthread 在设计上非常相似，但 boost::thread 更容易使用。

# java - 无法弄清楚如何在 Java EE Spring Web 项目中从表单中获取数据

> ID：11441252
> 
> 赞同：1
> 
> 时间：2012-07-11T20:49:36.943
> 
> 标签：java, spring, web-applications

我觉得自己像个彻头彻尾的白痴，在工作的最后 5 个小时里，我试图弄清楚 Spring 以及如何做到这一点。

我在“checklist.jsp”中有一个表单，我想获取用户放入表单的数据。我稍后会使用这些数据，但我现在只想捕获它......

我有 checklist.jsp，它有一个名为“ChecklistController.java”的控制器。这是我在 checklist.jsp 中的表格

```
<form method="POST" action="checklist.jsp">
    <table>
    <tr>
        <td>FQDN:</td>
        <td colspan="2"><input type='text' id="FQDN" /></td>
        <td><input type="radio" id="rdoScript" /></td>
        <td>Script 1 </td>
        <td><input type="radio" id="rdoScript" /></td>
        <td>Script 2</td>
    </tr>
    </table>
    <input type="submit" value="Run" id="selectionSubmit" />
 </form> 
```

请注意：我使用的是标签，但我更改了它，以便我可以实际看到该页面。我一直在玩它来回。

这是我的 ChecklistController.java

```
@Controller
// handling methods are relative to this controller
public class ChecklistController {
    private ChecklistService service;
    private static final Log LOG = LogFactory.getLog(ChecklistController.class);

    @RequestMapping("/checklist")
    public ModelAndView checklist() throws Exception{
        ModelAndView mavChecklist = new ModelAndView("checklist");
        mavChecklist.addObject("test",service.simpleTest());
        mavChecklist.addObject("date",service.getDateTime());
        return mavChecklist;
    }

    @Autowired
    public void setService(ChecklistService service){
        this.service = service;
    }
} 
```

我的想法是将数据放入一个 bean 中，所以我创建了这个类。UserSel.java

```
public class UserSel implements java.io.Serializable {

    /**
     * 
     */
    private static final long serialVersionUID = 1L;
    private String script;
    private String FQDN;

    public UserSel(){
    }

    public String getFQDN() {
        return FQDN;
    }

    public void setFQDN(String fqdn) {
        FQDN = fqdn;
    }

    public String getScript() {
        return script;
    }

    public void setScript(String script) {
        this.script = script;
    }
} 
```

我希望我提供了足够的信息。我想采用 FQDN 和脚本选择，并能够使用用户的这些选择（运行远程脚本）。

如果需要更多信息，请告诉我——我现在对 Spring 感到沮丧:(

编辑：添加当前 ChecklistController.java

```
@Controller
// handling methods are relative to this controller
public class ChecklistController {
private ChecklistService service;
private static final Log LOG = LogFactory.getLog(ChecklistController.class);

@RequestMapping("/checklist")
public ModelAndView checklist(@ModelAttribute(value="UserSel")UserSel userSel) throws Exception{
    ModelAndView mav = viewRender();
    String FQDN = userSel.getFQDN();
    String getScript = userSel.getScript();
    mav.addObject("FQDN", FQDN);
    mav.addObject("script",getScript);
    return mav; 
}

@RequestMapping("/newchecklist")
public ModelAndView viewRender() {
    ModelAndView mav=new ModelAndView();
    mav.addObject("UserSel ", new UserSel ());
    mav.setViewName("checklist");
    return mav;
}

@Autowired
public void setService(ChecklistService service){
    this.service = service;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:04:51.570

这样的事情将允许您接收已发布的表单输入作为请求处理程序的参数：

```
@RequestMapping("/checklist")
public ModelAndView checklist(
    @RequestParam("FQDN") String FQDN,
    @RequestParam("rdoScript") int rdoScript) {
    // ...
} 
```

有关更多信息，请参阅[Spring 框架参考文档](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-ann-requestparam)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T08:49:18.197

1）添加弹簧的形式tld。并像这样重写你的表格

```
<form:form commandName="UserInfo" method="POST" action="/web/checklist">
  <tr>
        <td>FQDN:</td>
        <td colspan="2"><input path="FQDN" /></td>
        <td><form:radiobutton path="script" value="1"/></td>
        <td><form:radiobutton path="script" value="2"/></td>
    </tr>
    <input type="submit" value="Save Changes" />
</form:form> 
```

2.修改您的控制器以获取提交的值。

```
@Controller
// handling methods are relative to this controller
public class ChecklistController {
    private ChecklistService service;
    private static final Log LOG = LogFactory.getLog(ChecklistController.class);

    //Called when you submit data and access it like this.
    @RequestMapping("/checklist")
    public ModelAndView checklist(@ModelAttribute(value="UserSel")UserSel userSel) throws Exception{

        //userSel.get..... you will get submited values like this here. Use your service class here. And return appropriate ModelAndView

        return mavChecklist;
    }

    //Call this method first to get blank jsp. This will bind your dataclass to jsp, in which you will get data once you submit.
     @RequestMapping("/newcheklist")
    public ModelAndView viewRender() {
        ModelAndView mav=new ModelAndView();
        mav.addObject("UserSel ", new UserSel ());
        mav.setViewName("checklist");
        return mav;
    }
    @Autowired
    public void setService(ChecklistService service){
        this.service = service;
    }
} 
```

*由于您没有提供更多像上下文文件这样的代码，我需要做出某些假设*。

# javascript - 您可以选择流到下一行的类的所有 div 吗？

> ID：11441254
> 
> 赞同：4
> 
> 时间：2012-07-11T20:49:44.303
> 
> 标签：javascript, jquery, html, css

所以我有 7 到 12 个样式相同的 div，它们都向左浮动。我正在为流到第二行的所有选择器寻找一个 css 选择器。我很确定这对于标准 css 是不可能的，但我想知道是否有人知道任何 jQuery 或其他可以完成此任务的技巧。非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T20:54:44.823

正如您所说的那样，使用 CSS（我知道）无法做到这一点。但是，使用 jQuery 可以很容易地完成它。

一种方法是使用[过滤器](http://api.jquery.com/filter/)和[偏移量](http://api.jquery.com/offset/)的组合来仅保留顶部偏移量高于其他元素的元素（那些不适合第一行的元素）。

```
var $elm = $(".yourSelector"); // Use your selector here
var $secondRowElms = $elm.filter(function () {
   // Compare each item with the first item, to see if it has higher offset
   return ($elm.first().offset().top < $(this).offset().top);        
}); 
```

**这里也是一个演示：http:** [//jsfiddle.net/8ppJP/1/](http://jsfiddle.net/8ppJP/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T20:56:39.897

```
var $divs = $('.container .sub');

var arrOffsetTops = [];

$divs.each(function(index,element){
   arrOffsetTops[index]=element.position().top;
   arrOffsetTops[index].newLine = (index==0 ? true : false);
   if(index > 0) {
     if(arrOffsetTops[index] > arrOffsetTops[index-1]) {
        // it's on another line
        arrOffsetTops[index].newLine = true;
     }
  }
}); 
```

然后，您可以使用索引循环遍历数组并检查 .newLine == true 以执行您需要对 div 执行的任何操作。

**更新：**

如何使用它的一个例子：

```
var divCount = $divs.length;
for(var i=0; i<divCount; i++) {
 if(true == arrOffsetTops[ i ].newLine) {
  $divs.eq( i ).addClass('newline-marker');
 }
}

.newline-marker {
 -webkit-box-shadow:0 0 10px black;
 -khtml-box-shadow:0 0 10px black;
 -moz-box-shadow:0 0 10px black;
 -o-box-shadow:0 0 10px black;
 -ms-filter: "progid:DXImageTransform.Microsoft.Shadow(Strength=2, Direction=0, Color='#000000')";
 filter: progid:DXImageTransform.Microsoft.Shadow(Strength=2, Direction=0, Color='#000000');
 box-shadow:0 0 10px black;
 zoom:1;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T21:04:57.053

试试这个：

```
$('.divs:not(:first)').filter(function(){
   return $(this).position().top - $(this).height() == 0
}).nextAll().andSelf().addClass('next') 
```

[演示](http://jsfiddle.net/gTzV7/)

# php - zen cart 为产品添加尺寸

> ID：11441264
> 
> 赞同：0
> 
> 时间：2012-07-11T20:50:17.580
> 
> 标签：php, zen-cart

我是 Zen Cart 的新手，正在编辑现有的商店。我想显示购物车中产品的尺寸（即宽度、高度、长度和几个产品特定尺寸）。

我有一个很好的谷歌，我能找到的唯一方法包括运输插件 ozpost（我不想要的月费）和加拿大邮政，但这是针对英国网站的，它与运输无关，它只是一个卖点。

我找不到任何插件来做到这一点，或者如何编辑代码以添加它们的示例。我真的很感激任何帮助......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T10:45:28.847

有一个模块可以做你想做的事：[Numinix Product Fields](http://www.numinix.com/zen-cart-modules/admin/numinix-product-fields)

您需要使用可选字段，但安装和使用相当简单。并且，如果运输模块支持，此模块可用于各种运输计算，或者您可以修改运输模块以支持它。

如果您只需要在前端显示尺寸而不将其用于运输，这真的很简单。您只需要编辑您的 includes/templates/YOUR_TEMPLATE/templates/tpl_product_info_display.php 并添加一行代码来调用尺寸。如果您下载该模块，您将找到一个示例文件，您可以在其中看到所需的代码。在您的情况下（对于尺寸），这将是

```
<?php echo (($flag_show_product_info_dimensions == 1 && ($products_length != 0 || $products_width != 0 || $products_height != 0)) ? '<li>' . $products_dim_display . '</li>'  : '') . "\n"; ?> 
```

还有另一种选择——您可以在数据库中的产品表中添加其他属性。您需要更改 4 个核心文件，添加一个函数和一些语言定义。请记住，这是非常微妙的，你真的需要知道你在做什么才能让它工作，所以我不会在这里解释它。我已经做过很多次了，但有时我还是会出错。

不要忘记备份备份备份！:)

# java - 数据库插入

> ID：11441266
> 
> 赞同：0
> 
> 时间：2012-07-11T20:50:30.590
> 
> 标签：java, database, jdbc

```
if(lines.size() >= 5){
    String Actor  = it.next();
    String Bio = it.next();
    String More_Bio = it.next();
    String Reason = it.next();
    String Fact = it.next(); 

    if ( it.hasNext()== true &&it.next().startsWith("Actor : ") )
    {

         // for quotes

      Actor = Actor.replace("'", "''");
         // remove comment
      Actor = Actor.replace("Actor:  ", " ");

         System.out.println(Actor);

    }

    if ( it.hasNext()== true &&it.next().startsWith("Bio: ") )
    {

      Bio = Bio.replace("'", "''");
      Bio = Bio.replace("Bio:  ", "");
      System.out.println(Bio);

    }

     if (it.hasNext()== true &&it.next().startsWith("More_Bio: "))
    { 
    More_Bio = More_Bio.replace("'", "''");
    More_Bio = More_Bio.replace("More_Bio:  ", "");
    System.out.println(More_Bio);

    }
     if (it.hasNext()== true &&it.next().startsWith("Reason: ") )
    { 
    Reason = Reason.replace("'", "''");
    Reason = Reason.replace("Reason:  ", "");
    System.out.println(Reason);

    }
    if (it.hasNext()== true &&it.next().startsWith("Fact: ") )
    { 
   Fact =Fact.replace("'", "''");
   Fact =Fact.replace("Fact:  ", "");
    System.out.println(Fact);

    }

    Statement statement = con.createStatement();
    statement.executeUpdate("INSERT INTO Tiffany (Actor, Bio, More_Bio, Reason,Fact) values('"+Actor+"','"+Bio+"','"+More_Bio+"','"+Reason+"','"+Fact+"')"); 
```

从 Actor 读取的文件：Zac Efron

简介：他出生在加利福尼亚州的圣路易斯奥比斯波，在附近的阿罗约格兰德长大，在客串了几集“夏日之地”（2004）之后，他加入了常规演员阵容，饰演疯狂的女孩卡梅隆贝尔。Efron 还出演了几部试播集，例如 Carl Laemke 的广阔世界 (2003) (TV) 和 Triple Play (2004) (TV)。

More_Bio : Efron 于 2006 年 6 月毕业于 Arroyo Grande 高中。Efron 最喜欢的运动包括高尔夫、滑雪、攀岩和单板滑雪。在为“Summerland”在海滩上度过了几天之后，他最近增加了冲浪。

原因：自从我第一次在“歌舞青春”和“发胶”中看到他时，我就喜欢上了这位漂亮、漂亮、有才华的演员，现在他更火了。他是好莱坞的当红王子。

事实：Zac 最珍贵的财产是他的亲笔签名棒球收藏，他是旧金山巨人队的忠实粉丝。

演员：泰勒·洛特纳

生物：泰勒丹尼尔劳特纳出生在密歇根州大急流城，父母黛博拉和丹尼尔劳特纳出生。他和妹妹 Makena 在密歇根州哈德逊维尔的一个彬彬有礼的罗马天主教家庭中长大。

More_Bio : 然而，除了对武术的热爱之外，泰勒在七岁时很快就对表演产生了热爱，当时从事演艺事业的武术教练鼓励他试镜，以便在一个小角色中露面。汉堡王广告。

理由：这是一个大块头的青少年偶像！我爱他作为“暮光之城”系列中的雅各布·布莱克！他是我见过的最好看的人之一。当我给他发推文时，我很兴奋，他回复了一次！

事实：他在高中一年级和二年级时踢足球。他有德国、法国、荷兰和美洲原住民（特别是渥太华和波塔瓦托米）血统。我的天啊！我们都喜欢莱昂国王乐队。

我正在尝试将上面的文件放入数据库。但这是我运行它时遇到的错误。

```
Exception in thread "main" com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: 
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 's favorite sports include golf, skiing, rock climbing, and snowboarding. 

He rece' at line 1
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:406)
    at com.mysql.jdbc.Util.getInstance(Util.java:381)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1030)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:956)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3491)
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3423)
    at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1936)
    at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2060)
    at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2536)
    at com.mysql.jdbc.StatementImpl.executeUpdate(StatementImpl.java:1564)
    at com.mysql.jdbc.StatementImpl.executeUpdate(StatementImpl.java:1485)
    at TiffanyWriter.main(TiffanyWriter.java:109) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:13:44.817

您应该使用[`PreparedStatement`](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html)主要是因为它可以防止[SQL 注入攻击](http://en.wikipedia.org/wiki/SQL_injection)。@John Moses 从 Java 官方文档中发布了使用 PreparedStatement 的教程，这是另一个很好的链接：[MySQL 和 Java JDBC - 教程](http://www.vogella.com/articles/MySQLJava/article.html)。

将您的代码移动到 PreparedStatement，它应该是这样的：

```
PreparedStatement ps = con.prepareStatement("INSERT INTO Tiffany(Actor, Bio, More_Bio, Reason, Fact) VALUES (?, ?, ?, ?, ?) ");
ps.setString(1, Actor);
ps.setString(2, Bio);
ps.setString(3, More_Bio);
ps.setString(4, Reason);
ps.setString(5, Fact);
ps.executeUpdate(); 
```

不要忘记在使用资源后关闭它们：

```
ps.close();
con.close(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T20:54:35.300

您需要转义单引号。幸运的是，Java 使用 PreparedStatements [http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html解决了这个问题](http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html)

# php - PHP读取Javascript数组

> ID：11441272
> 
> 赞同：6
> 
> 时间：2012-07-11T20:50:47.317
> 
> 标签：php, javascript

我正在将一个数组从 Javascript 传递到 PHP 页面，如下所示。

```
var arrF1 = [{"Item":"item1no",
      "Desc":"item1desc",
      "Remarks":"item1note"},
             {"Item":"item2no",
      "Desc":"item2desc",
      "Remarks":"item2note"}
    ];
$.ajax({        
   type: "POST",
   url: "http://www.mydomain.com/pdfs/flist.php",
   data: { favArray : arrF1 },
   success: function() {
        alert('ok, sent');
   }
}); 
```

在我的 PHP 页面中，我读取了如下数组。

```
$fArray = json_decode($_POST['favArray']) 
```

我试图像这样访问数组值。

```
$fArrav[0]->{'Item'}
$fArrav[0]->{'Desc'}
$fArrav[1]->{'Item'} 
```

它是否正确？我正在使用 FPDF 在服务器上生成 PDF。但是有了上面的内容，它没有读取数组。

我一定做错了。请帮忙。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:06:54.687

使用这个 PHP：

```
function handlePost() {
    $a = $_POST['favArray'];
    var_dump($a);
} 
```

..还有这个Javascript：

```
function post() {
    var a1 = [ 
        {"Item":"109249383",
         "Desc":"item1desc",
         "Remarks":"item1note"},

        {"Item":"298298210",
         "Desc":"item2desc",
         "Remarks":"item2note"}
    ];

    $.ajax({
        type: "POST",
        url: "readArray.php",
        data: { favArray : a1 },
        success: function() {
            alert1('ok, sent');
        }
    });
} 
```

...我得到这个输出：

```
HTTP/1.1 200 OK
Content-Type: text/html
Server: Microsoft-IIS/7.5
X-Powered-By: PHP/5.3.10
Date: Wed, 11 Jul 2012 21:04:16 GMT
Content-Length: 315

array(2) {
  [0]=>
  array(3) {
    ["Item"]=>
    string(9) "109249383"
    ["Desc"]=>
    string(9) "item1desc"
    ["Remarks"]=>
    string(9) "item1note"
  }
  [1]=>
  array(3) {
    ["Item"]=>
    string(9) "298298210"
    ["Desc"]=>
    string(9) "item2desc"
    ["Remarks"]=>
    string(9) "item2note"
  }
} 
```

在这种情况下，线路上数据的编码**不是 JSON**。它是 'application/x-www-form-urlencoded' 根据 jQuery`ajax`函数使用的默认值。看起来像这样：

```
favArray=%5B%7B%22Item%22%3A%22109249383%22%2C%22Desc%22%3A%22item1desc%22%2C
    %22Remarks%22%3A%22item1note%22%7D%2C%7B%22Item%22%3A%22298298210%22%2C%22
    Desc%22%3A%22item2desc%22%2C%22Remarks%22%3A%22item2note%22%7D%5D 
```

（全部在一行上）
因此`json_decode`在 PHP 中调用是没有意义的 - 从来没有涉及任何 JSON。PHP 自动解码 url 编码的帖子正文。

* * *

如果你*想*用 JSON 编码，那么你可以`JSON.stringify()`直接使用。这*可能*需要`json2.js`在浏览器端。（见[这个答案](https://stackoverflow.com/questions/891299/browser-native-json-support-window-json/891306#891306)）

要使用 JSON，您需要在浏览器中使用以下内容：

```
function post_json_encoded() {
    $.ajax({
        type: "POST",
        url: "postArray.php",
        contentType: 'application/json', // outbound header
        dataType: 'text',                // expected response
        data: JSON.stringify(a1),        // explicitly encode
        success: function() {
            alert1('ok, json sent');
        }
    });
} 
```

...然后在 php 方面是这样的：

```
function handlePost() {
    header('Content-Type: text/plain; charset="UTF-8"');
    $post_body = file_get_contents('php://input');
    $a = json_decode($post_body);
    var_dump($a);
} 
```

在这种情况下，在线表示如下所示：

```
[{"Item":"109249383","Desc":"item1desc","Remarks":"item1note"},
 {"Item":"298298210","Desc":"item2desc","Remarks":"item2note"}] 
```

...和 ​​php var_dump 输出是这样的：

```
array(2) {
  [0]=>
  object(stdClass)#1 (3) {
    ["Item"]=>
    string(9) "109249383"
    ["Desc"]=>
    string(9) "item1desc"
    ["Remarks"]=>
    string(9) "item1note"
  }
  [1]=>
  object(stdClass)#2 (3) {
    ["Item"]=>
    string(9) "298298210"
    ["Desc"]=>
    string(9) "item2desc"
    ["Remarks"]=>
    string(9) "item2note"
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:25:34.517

```
$fArray = $_POST['favArray'];
echo $fArray[0]['Item']; // item1no
echo $fArray[1]['Item']; // item2no 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T20:54:47.350

不需要额外的括号：

```
$fArrav[0]->Item 
```

# php - 如果 || 我的代码不能正常工作

> ID：11441278
> 
> 赞同：3
> 
> 时间：2012-07-11T20:51:06.480
> 
> 标签：php, if-statement

这是我的代码

```
<?php

if( $country==("United Stats" || Canada || United Kingdom) ) {
   echo $Country;
}

?> 
```

我想说“如果 Country == United Stats 'or' Canada 'or' United Kingdom >>> echo $Country

当我使用 || 它不能正常工作 请问有什么问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:54:06.427

```
<?php
$cs = array('United States', 'Canada', 'United Kingdom');
if(in_array($country, $cs)){
echo $country
}
?> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-11T20:52:59.873

你不能这样做，你需要写：

```
if( $country=="United Stats" || $country=="Canada" || $country=="United Kingdom" ) { 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-11T20:54:15.007

```
if (in_array($country, array('United Stats', 'Canada', 'United Kingdom'))) { 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-11T20:53:11.997

您必须将 $country 与每个变量进行比较

```
if ($country == "United States" ||
    $country == "Canada" ||
    $country == "United Kingdom") {

    echo $country;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-11T20:54:16.130

您的代码不是有效的 PHP 语法。这将起作用：

```
<?php

if( $country == "United Stats" || $country == "Canada"
        || $country == "United Kingdom" ) {
    echo $country;
}

?> 
```

顺便说一句，您似乎是 PHP 新手。您应该阅读[文档](http://www.php.net/docs.php)，也许还应该阅读一本书来学习该语言。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-11T20:53:02.197

```
<?php
if( $country=="United Stats" Or $country=="Canada" Or $country=="United Kingdom" ) {
   echo $country;
}
?> 
```

或者

```
<?php
if( $country=="United Stats" || $country=="Canada" || $country=="United Kingdom" ) {
   echo $country;
}
?> 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-07-11T20:58:17.580

```
<?php

$country = "Canada";
if( $country=="United Stats" || $country=="Canada" || $country=="United Kingdom" ) {
   echo $country;
}

?> 
```

# eclipse - 如何使用 STS Eclipse 将下载的插件添加到 grails 项目中

> ID：11441279
> 
> 赞同：0
> 
> 时间：2012-07-11T20:51:09.623
> 
> 标签：eclipse, grails, grails-plugin

我想知道，有没有什么方法可以使用 STS（Sprint 工具套件）将下载的插件添加到项目中，就像我们在 intellj ide（添加自定义插件）[http://wiki.jetbrains.net/intellij/Managing_Grails_plugins](http://wiki.jetbrains.net/intellij/Managing_Grails_plugins)

例如，我已经下载了 jasper 插件，我将如何将它添加到我的圣杯项目中。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:57:41.933

在您的*BuildConfig.groovy*文件中，您可以添加插件。

将以下内容合并到*grails.project.dependency.resolution*闭包中：

```
repositories{
  mavenRepo "https://repository.jboss.org/nexus/"
}

plugins {
 compile ":jasper:1.5.3"
} 
```

# css - 移动第一响应图像技术

> ID：11441280
> 
> 赞同：1
> 
> 时间：2012-07-11T20:51:11.857
> 
> 标签：css, responsive-design

当前以移动优先方式处理响应式图像的标准方法是什么？

也就是说：今天是否有一种可接受的方法允许将小分辨率图像提供给移动/小屏幕宽度设备，而将较大分辨率图像提供给平板电脑/台式机等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:59:08.450

在标签上省略`width`和，如果它的父元素是响应式的，它会缩放。`height``<img />`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T11:15:48.477

就像 sanusart 写给你的那样。

例如，如果您使用 Twitter Bootstrap 扩展（被许多人认为是最好的或最好的面向响应式设计的框架之一）并将其设置为使用[响应式设计](http://twitter.github.com/bootstrap/scaffolding.html#responsive)（默认情况下未设置），那么您所要做的就是将您的图像放入响应式容器中，例如`well`：

```
<div class="well">
    <img src="img/logo.png" class="img-polaroid" />
</div> 
```

您的图像将根据屏幕分辨率调整其尺寸。

如果你想用左右边距分开它，你可以使用[流体布局](http://twitter.github.com/bootstrap/scaffolding.html#fluidGridSystem)，例如：

```
<div class="well">  
    <div class="row-fluid">
        <div class="span2"></div>
        <div class="span8"><img src="img/sunflower.jpg" /></div>
        <div class="span2"></div>
    </div>
</div> 
```

但我们知道，在宽屏幕上（如纵向模式的手机），您的左右“分隔符”[会上下堆叠](https://stackoverflow.com/a/14891349/1469208)，这可能会产生不必要的副作用。

# asp.net - 将异常信息从 Global.asax 传递到 ErrorPage.aspx

> ID：11441284
> 
> 赞同：0
> 
> 时间：2012-07-11T20:51:29.657
> 
> 标签：asp.net, error-handling, message-passing, pageobjects

我在 Global.asax 中有一个全局错误处理程序，并试图在名为 ErrorPage.aspx 的页面中显示异常信息。我已经阅读了微软关于在 asp.net 页面之间传递信息的页面 (http://msdn.microsoft.com/en-us/library/6c3yckfw.aspx)。我认为这些都行不通：

*   QueryString：我担心异常的长度会超过QueryString的最大长度。
*   发布信息： Global.asax 页面没有任何表单字段。
*   会话状态：会话状态在 Global.asax 中不可用
*   公共价值观：我认为这仅适用于 .aspx 页面
*   来自源页面的控件：Global.asax 不能有 asp.net 控件。

我目前的想法是创建 ErrorPage 对象的实例并导航到它是合乎逻辑的（就像您可以在 Windows 窗体应用程序中所做的那样），但我不知道如何做到这一点，或者在 asp 中是否可行。网。

最终，我正在寻找一种在标准 .aspx 页面中显示由全局错误处理程序捕获的错误的方法。任何的意见都将会有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T23:42:16.817

我会做什么：

1.  记录异常信息，包括日志文件中的堆栈跟踪，
2.  重定向到带有错误代码的 ErrorPage（常规 http 错误代码 + 一个通用的“未知错误” + 可能是一些对应用程序有意义的自定义错误）在查询字符串参数中传递，
3.  显示此错误代码的预定义消息。

几乎没有理由向最终用户显示实际的错误消息，更详细的错误信息无法承受。如果要显示完整信息以进行调试，请在 web.config 中关闭自定义错误

# windows-phone-7 - 使用独立存储升级 Windows Phone 7.5 应用程序

> ID：11441285
> 
> 赞同：2
> 
> 时间：2012-07-11T20:51:43.633
> 
> 标签：windows-phone-7, isolatedstorage, marketplace

我在 Marketplace 上有一个应用程序，该应用程序使用独立存储。

我对应用程序进行了更新，它修复了一些错误，还添加了与我的网站连接和同步的功能（这是同一应用程序的基于云的版本）。

我的问题是；升级期间 isostore 被擦除或损坏的风险是什么？协议是警告用户还是我们假设他们定期备份手机并认为这不是问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:55:35.303

我相信隔离存储仍然完好无损（毕竟，这就是为什么有专用的 API 用于就地升级数据库架构的原因）——只有当应用程序被卸载时，它的隔离存储才会被擦除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T07:46:08.747

正如 Rowland 所说，`Isolated storage`只有在卸载应用程序时才会擦除。如果您在更新中更改了从存储中写入或读取数据的方式，请确保更新不会破坏任何内容。

[Windows Phone 的独立存储最佳实践](http://msdn.microsoft.com/en-us/library/ff769544%28v=vs.92%29.aspx)

# c# - 创建表达式树以获取属性值

> ID：11441287
> 
> 赞同：0
> 
> 时间：2012-07-11T20:51:46.380
> 
> 标签：c#, linq, lambda

我有一种方法可以遍历构建“。”的表达式树。属性名称的分隔字符串

```
public static string GetPropertyNameFor<TSource, TProperty>(Expression<Func<TSource, TProperty>> propertyLambda, bool fullyQualified)
{
       // if fullyQualified return Bar.BoolProp1
       // else return BoolProp1
} 
```

用法：

```
var propName = GetPropertNameFor<Foo, bool>(foo=>foo.Bar.BoolProp1); 
```

但是我现在需要做的是在运行时调用该方法。我有类型和 PropertyInfo 层次结构。大概我需要创建一个覆盖，将一个类型作为另一个 arg 访问，并创建一个表达式树以传递给properyLambda。

那是对的吗？所有表达式树的例子看起来都非常复杂；任何建议表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:01:47.703

使用`expression.Compile()`. 它为您提供了表示 lambda 表达式的方法。

# java - java.sql.SQLException：没有合适的驱动程序

> ID：11441289
> 
> 赞同：0
> 
> 时间：2012-07-11T20:51:47.743
> 
> 标签：java

我能够很好地部署我的战争，当我尝试运行它时，我在控制台日志中得到一些运行时错误

```
Cannot create JDBC driver of class 'oracle.jdbc.OracleDriver' for connect URL 'jdbcracle:thin(DESCRIPTION = (LOAD_BALANCE = ON)(FAILOVER = ON)(ADDRESS = (PROTOCOL = TCP)(HOST = TSS2A056N1-vip.svr.us.co.net)(PORT = 4329))(ADDRESS = (PROTOCOL = TCP)(HOST = TSS2A056N2-vip.svr.us.co.net)(PORT = 4329)) (CONNECT_DATA = (SERVICE_NAME = atmt01d_taf.co.net)(FAILOVER_MODE = (TYPE = select) (METHOD = basic))))'
java.sql.SQLException: No suitable driver
at java.sql.DriverManager.getDriver(DriverManager.java:264)
at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createConnectionFactory(BasicDataSource.java:1437)
at org.apache.tomcat.dbcp.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1371)
at org.apache.tomcat.dbcp.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044)
at org.springframework.orm.hibernate3.LocalDataSourceConnectionProvider.getConnection(LocalDataSourceConnectionProvider.java:81)
at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:423)
at org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:144)
at org.hibernate.jdbc.JDBCContext.connection(JDBCContext.java:119)
at org.hibernate.transaction.JDBCTransaction.begin(JDBCTransaction.java:57)
at org.hibernate.impl.SessionImpl.beginTransaction(SessionImpl.java:1326)
at org.springframework.orm.hibernate3.HibernateTransactionManager.doBegin(HibernateTransactionManager.java:555)
at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:371)
at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:317)
at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:105)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:625)
at com.jpmc.tss.tspayments.rest.controller.CustomizeColumnsController$$EnhancerByCGLIB$$76448fa3.getColumnsToDisplay(<generated>)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:174)
at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:421)
at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:409)
at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:771)
at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:716)
at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:560)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
at org.apache.jk.server.JkCoyoteHandler.invoke(JkCoyoteHandler.java:190)
at org.apache.jk.common.HandlerRequest.invoke(HandlerRequest.java:291)
at org.apa 
```

我认为这是一个类路径问题 - 我确保 classes12.jar 和 ojdbc-11.2.0.1.0.jar 都在 tomcat home/lib 和 java home/jre/lib/ext 中，并且这两个目录都在类路径中. 我还确认 ojdbc-11.2.0.1.0.jar 在我的应用程序的 Libraries/Maven Dependencies 目录中。

在这一点上，我觉得战争应该可以访问这个驱动程序 jar。任何想法如何调试这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T20:54:38.430

在您的连接 URL 中输入错误？

```
jdbcracle:thin(DESCRIPTION.... 
```

应该

```
jdbc:oracle:thin(DESCRIPTION.... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T15:23:18.790

我解决了这个问题——基本上我的数据源连接参数是错误的。与我的类路径上的 oracle jar 无关。

# kentico - CSS 中的 kentico 本地化宏

> ID：11441292
> 
> 赞同：0
> 
> 时间：2012-07-11T20:51:54.700
> 
> 标签：kentico

我正在尝试在 CSS 文件中使用宏（在站点管理器-> 开发中）。

这是我的 CSS 代码：

```
@import url('/CMSPages/GetResource.ashx?stylesheetname=sitecss{$=|en-US=eng$}');

a, a:visited, a:active {
  color:#407a1f;
}
.... 
```

当我在默认文化和英语之间切换时，这似乎无法在网站上动态运行。

它唯一有效的时候是如果我保存 CSS 文件（在站点管理器中），而站点本身处于某种文化中。

简而言之：宏在保存 CSS 文件时“采用”文化，并且在页面加载时不是动态的。

我该如何解决这个问题？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T11:49:29.933

据我所知，您不能让 CSS 代码动态化。但是，您可以轻松地执行此操作，如下所述：

*   Kentico 为文档的 body 标签添加了一个特殊的类。检查您的源代码，如果当前文化是 en-US，您将看到 body 标签有一个类 ENUS，如果当前文化是 en-GB，则为 ENGB，依此类推。
*   然后，您可以通过定义以下规则来相应地更改您的 CSS 代码：
    *   body.ENUS .container { 浮动：左；}
    *   body.ENGB .container { 浮动：对；}
    *   body.FRFR .container { 浮动：无；}

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T13:01:21.547

在版本 6 及更高版本中，您可以 通过在[http://devnet.kentico.com/docs/devguide/index.html?combining_stylesheets.htm](http://devnet.kentico.com/docs/devguide/index.html?combining_stylesheets.htm) 上查看更多信息`@import url('/CMSPages/GetResource.ashx?stylesheetname=sitecss{%CurrentCulture%}');` 来直接解析目标 CSS `{% CSS["<stylesheet code name>"] %}`

# mongodb - 一次递增数百个计数器，redis 还是 mongodb？

> ID：11441293
> 
> 赞同：2
> 
> 时间：2012-07-11T20:52:10.560
> 
> 标签：mongodb, redis, schema

**背景/意图：**

因此，我将从头开始创建一个事件跟踪器，并对如何执行此操作有一些想法，但我不确定处理数据库方面的最佳方法。我感兴趣的一件事是允许这些事件完全动态，但同时允许报告关系事件计数器。

例如，按操作系统划分的所有国家/地区。期望的效果是：

1.  美国事件数
    *   iOS - 美国发生的事件数
    *   Android - 在美国发生的事件数
2.  CA # 事件
    *   iOS - CA 中发生的事件数
    *   Android - 在 CA 中发生的事件数
3.  等等

我的意图是能够像这样接受这些事件名称：

```
/?country=US&os=iOS&device=iPhone&color=blue&carrier=Sprint&city=orlando&state=FL&randomParam=123&randomParam2=456&randomParam3=789 
```

这意味着为了对类似上面的事情进行关系计数器，我可能会为每个请求增加 100 多个计数器。

假设每天将有 10+ 百万个上述请求。

我希望在跟踪事件名称方面保持完全动态，并且我还希望以这样一种方式进行，即对数据的查找保持超快。因此，我一直在研究为此使用 redis 或 mongodb。

**问题：**

1.  有没有更好的方法来做到这一点，然后在保持字段动态的同时进行计数器？

2.  如果这一切都在一个文档中（结构像一棵树），那么使用 mongodb 中的 $inc 运算符在一个操作中同时增加 100 多个计数器是否可行且不慢？这里的好处是我可以在单个查询中快速检索一个“活动”的所有统计信息。

3.  这会更适合 redis 并为事件的所有适用计数器做一个 zincrby 吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T16:25:38.753

根据您的关键结构的布局方式，我建议对zincr 命令进行流水线操作。你有一个简单的“提交”触发器——请求。如果你要迭代你的参数和 zincr 每个键，那么在请求结束时传递执行命令它将非常快。我已经实现了一个像你描述为 cgi 和 Django 应用程序的系统。我按照以下思路设置了一个关键结构：

YYYY-MM-DD:HH:MM -> 排序集

并且能够使用单个进程在 redis 端每秒处理 150000-200000 增量，这对于您描述的场景来说应该足够了。这个关键结构允许我根据时间窗口获取数据。我还为密钥添加了过期时间以避免编写数据库清理过程。然后，我有一个 cronjob，它会使用上述关键模式的变体进行设置操作，以将统计数据“汇总”到每小时、每天和每周。我提出这些想法是因为它们是您可以利用 Redis 的内置功能使报告方面更简单的方法。还有其他方法可以做到这一点，但这种模式似乎运作良好。

正如 eyossi 所指出的，对于进行并发写入和读取的系统来说，全局锁可能是一个真正的问题。如果您将其编写为实时系统，则并发性很可能是一个问题。如果它是一个“end if day”日志解析系统，那么除非您在输入时运行多个解析器实例或报告，否则它不太可能触发争用。关于在 Redis 中保持快速读取，我会考虑设置一个只读的 redis 实例，它从主实例中脱离出来。如果您将它放在运行报告的服务器上并将报告进程指向它，则生成报告应该非常快。

根据您的可用内存、数据集大小以及是否在 redis 实例中存储任何其他类型的数据，您可能会考虑运行 32 位 redis 服务器以降低内存使用率。一个 32b 的实例应该能够将大量此类数据保存在一小块内存中，但如果运行普通的 64 位 Redis 不会占用太多内存，请随意使用它。一如既往地测试您自己的使用模式以验证

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:15:18.947

在 redis 中，您可以使用`multi`同时增加多个键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T22:29:43.300

我对 MongoDB 有过一些不好的体验，我发现当你有很多写入它时它可能真的很棘手......

您可以查看[此链接](http://slowping.com/2011/ten-things-i-didnt-know-about-mongodb/)以获取更多信息，并且不要忘记阅读“MongoDB 使用 1 BFGL (big f***ing global lock)”的部分（可能已经在 2.x 版本中改进 - 我没有检查它）

另一方面，我有很好的经验`Redis`，我用它来进行大量的读/写，而且效果很好。您可以在此处找到有关我如何使用的更多信息`Redis`（以了解并发读取/写入的数量）：http: [//engineering.picscout.com/2011/11/redis-as-messaging-framework.html](http://engineering.picscout.com/2011/11/redis-as-messaging-framework.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T07:23:17.503

如果您不需要原子功能，我宁愿使用`pipeline`..`multi`

# android - 使用样式在主题中设置活动背景？

> ID：11441297
> 
> 赞同：44
> 
> 时间：2012-07-11T20:52:24.437
> 
> 标签：android

我想为我的所有活动使用可绘制的背景。我怎样才能用一种风格做到这一点？

```
// styles.xml
<style name="MyTheme" parent="Theme.Sherlock.Light.DarkActionBar.ForceOverflow">
    <item name="android:background">@drawable/my_background</item>  
</style> 
```

它设置了所有小部件的背景。我只是想让它为活动工作。

谢谢

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2012-07-11T20:59:35.043

利用

```
<item name="android:windowBackground">@drawable/my_background</item> 
```

# java - 使用 JACKSON 的 JAXB 到 JSON

> ID：11441299
> 
> 赞同：6
> 
> 时间：2012-07-11T20:52:27.113
> 
> 标签：java, json, spring, jaxb

在我的应用程序中，JAXB 输出生成如下：

`this.marshalOut(jaxb_Object, fileOutputStream);`

这是对生成 XML 文件的 spring Object XML Mapping Marshallers 的方法调用。现在，我也喜欢在这一行之后生成 JSON 文件。任何人都知道使用 JAXB 输入生成 JSON 输出。

我在网上找到了这个示例代码：

```
ObjectMapper mapper = new ObjectMapper();
AnnotationIntrospector introspector = new JacksonAnnotationIntrospector();
// make deserializer use JAXB annotations (only)
mapper.getDeserializationConfig().setAnnotationIntrospector(introspector);
// make serializer use JAXB annotations (only)
mapper.getSerializationConfig().setAnnotationIntrospector(introspector);
mapper.writeValue( outputStream, jaxb_object); 
```

已`setAnnotationIntrospector`弃用，还有其他方法可以解决此问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-08-12T22:01:07.980

以下工作（并且不使用任何不推荐使用的构造函数）：

```
ObjectMapper mapper = new ObjectMapper();

AnnotationIntrospector introspector =
    new JaxbAnnotationIntrospector(mapper.getTypeFactory());   

mapper.setAnnotationIntrospector(introspector); 
```

具体来说，这条线

```
new JaxbAnnotationIntrospector(mapper.getTypeFactory()); 
```

使用未弃用的构造函数。我已经对此进行了测试，它成功地处理了 JAXB 注释（例如 @XmlTransient，在我的例子中）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-06-10T14:48:32.673

您可以按照文档中的说明使用[jackson-module-jaxb-annotations](https://github.com/FasterXML/jackson-module-jaxb-annotations)来注册`JaxbAnnotationModule`模块：

```
JaxbAnnotationModule module = new JaxbAnnotationModule();
// configure as necessary
objectMapper.registerModule(module); 
```

这样做您现在可以同时使用 JAXB 注释和 Jackson 本机注释。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-24T09:30:26.760

如果您将 Jackson 更新到 2.0，它不会被弃用：

[http://fasterxml.github.com/jackson-databind/javadoc/2.0.0/com/fasterxml/jackson/databind/ObjectMapper.html](http://fasterxml.github.com/jackson-databind/javadoc/2.0.0/com/fasterxml/jackson/databind/ObjectMapper.html)

你可以在这里看到我的配置（Spring）：

[带有 JAXB 注释的 Spring 3.1.2 中的注册器 MappingJackson2HttpMessageConverter](https://stackoverflow.com/questions/12514285/registrer-mappingjackson2httpmessageconverter-in-spring-3-1-2-with-jaxb-annotati)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-06-12T13:33:17.330

对我来说正确的解决方案是：

```
ObjectMapper objectMapper = new ObjectMapper();
objectMapper.setAnnotationIntrospector(new JaxbAnnotationIntrospector()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-12T15:17:53.853

根据杰克逊 javadoc：

```
setAnnotationIntrospector

@Deprecated
public final void setAnnotationIntrospector(AnnotationIntrospector ai)

    Deprecated. Since 1.8, use either withAnnotationIntrospector(AnnotationIntrospector) or Module API instead

    Method for replacing existing annotation introspector(s) with specified introspector. Since this method modifies state of configuration object directly, its use is not recommended 
```

您是否检查了该方法`withAnnotationIntrospector(AnnotationIntrospector ai)`以查看它是否对您的情况有用？

# c++ - 如果可能，静态断言，否则动态断言？

> ID：11441302
> 
> 赞同：11
> 
> 时间：2012-07-11T20:52:36.863
> 
> 标签：c++, static-assert

假设我有一个模板函数，它接受一个整数和一个对类型 T 实例的 const 引用。现在根据整数，只有一些 T 是可接受的，否则在运行时会引发异常。

如果此函数的所有使用都使用常量整数，则可以使 int 成为模板参数并使用静态断言来检查它是否可以接受。所以不是`func(1,c)`一个人会使用`func<1>(c)`并且会获得编译时类型检查。有什么方法可以编写`func(1,c)`并保持编译时检查，同时还可以编写`func(i,c)`和使用动态断言？目标是使其对开发人员透明。添加这种安全性而无需为诸如编译时常量之类的事情打扰开发人员就太好了。他们可能只记得`func(1,c)`总是有效并使用它，避免检查。

**如何尽可能使用静态断言和动态断言定义函数？**

* * *

以下代码显示了**Ivan Shcherbakov**的 GCC 解决方案：

```
#include <iostream>
#include <cassert>

template<typename T>
void __attribute__((always_inline)) func(const int& i, const T& t);

void compile_time_error_() __attribute__((__error__ ("assertion failed")));

template<>
  void __attribute__((always_inline))
  func(const int& i, const float& t)
{
    do {
        if (i != 0) {
            if (__builtin_constant_p(i)) compile_time_error_();
            std::cerr << "assertion xzy failed" << std::endl;
            exit(1);
        }
    } while (0);
    func_impl<float>(i,t);
} 
```

这将只允许 i=0 和 T=float 的组合。对于其他组合，一个好方法是创建一个宏，该宏产生`template<> func(const int& i, const T& t)`替换 T 和 i != 0 的代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-11T21:47:48.580

好吧，如果您使用的是 GCC，则可以使用肮脏的 hack，但它仅在启用函数内联（-O1 或更多）时才有效：

```
void my_error() __attribute__((__error__ ("Your message here")));

template <typename T1, typename T2> struct compare_types 
{
    enum {Equals = 0};
};

template <typename T1> struct compare_types<T1,T1> 
{
    enum {Equals = 1};
};

template <typename Type> __attribute__((always_inline)) void func(int a, Type &x)
{
    if (__builtin_constant_p(a))
    {
        if (a == 1 && compare_types<Type,char>::Equals)
            my_error();
    }
} 
```

在这种情况下 when`a == 1`和`Type`is `char`，你会得到一个错误。这是一个将触发它的示例：

```
int main()
{
    char x;
    func(1, x);
    return 0;
} 
```

请注意，此示例严重依赖 gcc 特定的`__builtin_constant_p()`函数，并且不适用于其他编译器！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-14T11:40:27.617

让我解释一下问题，以便在我的回答中更准确：

> 运行时断言**有时会**在编译时报告错误。

Gcc 可以，但仅在某些优化级别上，并且错误消息非常不具信息性。Clang 本身不能（没有错误属性），但不要忘记 clang**分析器**。Analyzer 可以报告一些运行时错误，例如取消引用空指针。

所以这里有一个“智能”运行时断言的想法和简单的测试：

```
#include <cstdlib> // std::abort

#if !defined(__clang__) && defined(__GNUC__)
// clang emulates gcc
# define GCC_COMPILER 1
#else
# define GCC_COMPILER 0
#endif

#if GCC_COMPILER
void assertion_failed_message() __attribute__((__error__("assertion failed")));
#endif

inline void smart_assert(bool condition) {
#if GCC_COMPILER
  // gcc is very 'sensitive', it must be first code lines in this function
  if (__builtin_constant_p(condition) && !condition) {
    assertion_failed_message();
  }
#endif

  if (condition) {
    // Ok
    return;
  }

#if defined(__clang_analyzer__)
  enum {
    ASSERTION_FAILED = 0xdeadfull
  };
  int *a = nullptr;
  *a = ASSERTION_FAILED;
#endif

  // Implement some standart error, like abort
  std::abort();
}

void test_condition_2(bool condition) {
  smart_assert(condition);
}

void test_condition_1(bool condition) {
  test_condition_2(condition);
}

void test_condition_0(bool condition) {
  test_condition_1(condition);
}

int main() {
  test_condition_0(0==1);
  return EXIT_SUCCESS;
} 
```

Gcc 在 O2 优化级别报错，很好。但是报告消息在主函数中，并且不要留下任何关于 test_condition_{0,1,2} 的信息。

Clang 分析器报告错误，如果您使用 Xcode，您可以看到从 main 到 smart_assert 的所有路径： ![clang_analyzer_report](../Images/308425ea86f2599e8cbe72fd270a7092.png)

**PS** clang 分析器并不完美，所以如果你尝试 test_condition_0(argc)，不会报错（真正的运行时检查），但如果你尝试 test_condition_0(argc==1)，则会报错。

# mysql - 一对多 SQL SELECT 到单行

> ID：11441305
> 
> 赞同：33
> 
> 时间：2012-07-11T20:52:40.467
> 
> 标签：mysql, pivot

我有两个表中的数据。

第一个表有一个名为 PKID 的主键

```
PKID  DATA
0    myData0
1    myData1
2    myData2 
```

第二个表将表 1 中的 PKID 列作为外键

```
PKID_FROM_TABLE_1  U_DATA
       0          unique0
       0          unique1        
       0          unique2
       1          unique3
       1          unique4
       1          unique5
       2          unique6
       2          unique7
       2          unique8 
```

我现在做的基本 SELECT 语句是

```
SELECT a.PKID, a.DATA, b.U_DATA
FROM table1 as a
INNER JOIN table2 as b
ON a.PKID = b.PKID_FROM_TABLE_1 
```

这会产生一个像这样的表：

```
PKID   DATA     U_DATA
 0   myData0    unique0
 0   myData0    unique1
 0   myData0    unique2
 1   myData1    unique3
 1   myData1    unique4
 1   myData1    unique5
 2   myData2    unique6
 2   myData2    unique7
 2   myData2    unique8 
```

我想要的是下表：

```
PKID   DATA    U_DATA1    U_DATA2    U_DATA3
 0     myData0 unique0    unidque1   unique2
 1     myData1 unique3    unidque4   unique5
 2     myData2 unique6    unidque7   unique8 
```

如果有帮助，每个 PKID 将在 table2 中恰好有 3 个条目。

在 MySQL 中这样的事情可能吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-11T21:07:46.213

这是获得结果的一种方法。

这种方法使用相关的子查询。每个子查询使用一个`ORDER BY`子句对 table2 中的相关行进行排序，并使用该`LIMIT`子句检索第 1、第 2 和第 3 行。

```
SELECT a.PKID
     , a.DATA
     , (SELECT b1.U_DATA FROM table2 b1
         WHERE b1.PKID_FROM_TABLE_1 = a.PKID 
         ORDER BY b1.U_DATA LIMIT 0,1
       ) AS U_DATA1
     , (SELECT b2.U_DATA FROM table2 b2
         WHERE b2.PKID_FROM_TABLE_1 = a.PKID 
         ORDER BY b2.U_DATA LIMIT 1,1
       ) AS U_DATA2
     , (SELECT b3.U_DATA FROM table2 b3
         WHERE b3.PKID_FROM_TABLE_1 = a.PKID 
         ORDER BY b3.U_DATA LIMIT 2,1
       ) AS U_DATA3
  FROM table1 a
 ORDER BY a.PKID 
```

* * *

跟进

@gliese581g 指出这种方法可能存在性能问题，外部查询返回大量行，因为 SELECT 列表中的每个子查询都会针对外部查询中返回的每一行执行。

不用说，这种方法需要一个索引：

```
ON table2 (PKID_FROM_TABLE_1, U_DATA) 
```

-或者，至少-

```
ON table2 (PKID_FROM_TABLE_1) 
```

如果定义了外键，则后一个索引很可能已经存在。前一个索引将允许完全从索引页面满足查询（“使用索引”），而不需要排序操作（“使用文件排序”）。

@glies581g 非常正确地指出，这种方法的性能在“大”集上可能会出现问题。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-07-19T20:01:32.710

根据您的 MySQL 版本，您可以查看 GROUP_CONCAT

# matlab - 多个图像 - Matlab

> ID：11441306
> 
> 赞同：1
> 
> 时间：2012-07-11T20:52:42.643
> 
> 标签：matlab, user-interface, video, image-processing

我编写了一个 matlab 项目，它将视频作为输入，将其切割成帧，并一帧一帧地显示给用户，让他能够对每一帧进行更改。

我想添加一个“侧边栏”，向用户显示特定的框架，以及从 1 到 10 的 GUI 框架的按钮，当他可以按“->”或“<-”移动到 prev\接下来 10 帧，并且可以单击一个帧以更大的尺寸显示它。

像这样的东西：

```
 This is the GUI: 
```

> ```
> .__________________________________.
> |                                  | 
> |          Frame No. i             | 
> |                                  | 
> |--------------------------------- | 
> |<-| Frame j|j+1|.....|Frame j+9|->| 
> |__________________________________| 
> ```

我考虑过使用“子图”，但不知道如何添加在单击时显示\更新上一个\下一个帧的功能。

另一种实现是这样的：

```
% The Main Image:
   hAx = axes('Position',[0 0.3 1 0.8], 'Parent',hFig);
   hMainImg = imshow(img, 'Parent',hAx);

% the slider
hPanel = uipanel('Position',[0 0.04 1 0.26], 'Parent',hFig);
uicontrol('Style','slider', 'Parent',hFig, ...
    'Callback',@slider_callback, ...
    'Units','normalized', 'Position',[0 0 1 0.04], ...
    'Value',1, 'Min',1, 'Max',mx, 'SliderStep',[1 10]./mx); 
```

但是，那么滑块呢？

任何想法我该如何实施？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T08:53:43.610

您可以查看我发布到 MatlabCentral 的 videoioPlayer。播放器通过 VIDEOIO 库逐帧读取文件（*.avi、*.mov、*.mpeg、...）中的视频——因此 videoio 库非常节省内存。

videoioPlayer 允许用户通过键盘输入来跳转视频（例如，'+' 前进一帧，'CTRL +' 进一步跳转 10 帧，'ALT +' 前进 100 帧，'SPACE' 是开始/暂停/恢复播放等.) 此外，videoioPlayer 允许插入（自定义）过滤器功能，该过滤器功能在显示之前应用于每个帧。并且 videoioPlayer 可以与其他 videoioPlayer 同步，以便同时显示 2 个视频（例如原始视频和处理后的视频）

可以编写一个过滤器插件（参见 videoioPlayer 的演示文件）来处理您的用户输入；因此，如果您设法编译了 videoiolibrary（在 linux 下直接编译，对​​于 mac 来说有点棘手，从未尝试过 windows 但您需要 VisualStudio），您可以直接使用播放器来完成您的任务。

如果您不想使用 videoiolib，您可以更改播放器以使用不同的帧抓取方法，或者只是尝试了解 videoioplayer 中的回调函数以获得对您项目的启发。

以下是链接：

[http://sourceforge.net/projects/videoio/files/](http://sourceforge.net/projects/videoio/files/)

[http://www.mathworks.com/matlabcentral/fileexchange/35119-videoioplayer](http://www.mathworks.com/matlabcentral/fileexchange/35119-videoioplayer)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T23:28:44.897

这是一个工作示例。我们打开一个小视频文件，并读取其所有 141 帧。您可以使用滑块浏览它们，单击任何小图像以将其显示在主轴上。

```
function framesBrowserDemo()
    %# read all frames at once
    vid = VideoReader('xylophone.mpg');
    numImgs = get(vid, 'NumberOfFrames');
    frames = read(vid);
    clear vid

    %# design GUI
    numThumbs = 5;
    mx = numImgs-numThumbs+1;
    hFig = figure('Menubar','none');
    hPanel = uipanel('Position',[0 0.04 1 0.16], 'Parent',hFig);
    uicontrol('Style','slider', 'Parent',hFig, ...
        'Callback',@slider_callback, ...
        'Units','normalized', 'Position',[0 0 1 0.04], ...
        'Value',1, 'Min',1, 'Max',mx, 'SliderStep',[1 10]./mx);

    %# main axis, and show first frame
    hAx = axes('Position',[0 0.2 1 0.8], 'Parent',hFig);
    hMainImg = imshow(frames(:,:,:,1), 'Parent',hAx);

    %# thumbnail axes
    hThumImg = zeros(numThumbs,1);
    for i=1:numThumbs
        %# create axis, show frame, hookup click callback
        hAx = axes('Parent',hPanel, ...
            'Position',[(i-1)/numThumbs 0 1/numThumbs 1]);
        hThumImg(i) = imshow(frames(:,:,:,i), 'Parent',hAx);
        set(hThumImg(i), 'ButtonDownFcn',@click_callback)
        axis(hAx, 'normal')
    end

    %# callback functions
    function slider_callback(src,~)
        val = round(get(src,'Value'));  %# starting index
        %# update the thumbnails
        for k=1:numel(hThumImg)
            set(hThumImg(k), 'CData',frames(:,:,:,k+val-1))
            drawnow
        end
    end

    function click_callback(src,~)
        %# update the main image
        set(hMainImg, 'CData',get(src,'CData'));
        drawnow
    end
end 
```

![截屏](../Images/126e4355c5616c61ede4334c13be9b46.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T09:01:13.637

您可以使用 subplot 命令定义布局：

[http://www.mathworks.de/help/techdoc/ref/subplot.html](http://www.mathworks.de/help/techdoc/ref/subplot.html)

# ios - 导入 Monkeytalk 项目

> ID：11441307
> 
> 赞同：0
> 
> 时间：2012-07-11T20:52:44.117
> 
> 标签：ios, testing

我的本地机器上有monkeytalk 脚本。

我压缩了工作区目录并将其移动到服务器

如何将工作区的项目/内容导入服务器上的 monkeytalk。

基本上，我如何用 Monkeytalk 打开一个项目！？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T13:08:38.030

您可以通过以下方式从 MonkeyTalk 导入项目。

1.  转到“文件”菜单。
2.  选择“导入”
3.  在“一般”下
4.  选择“现有项目进入工作区”
5.  点击下一步”
6.  选择要导入的工作空间的根目录。

希望这可以帮助。

# mysql - 使用 MySQL 进行 SQL 查询

> ID：11441313
> 
> 赞同：2
> 
> 时间：2012-07-11T20:53:20.747
> 
> 标签：mysql, hibernate, jersey, jax-rs

我正在使用 Jesey 在 java (JAX-RS) 中实现一个 Restful Web 服务。我在 Tomcat v7.0 上运行它我使用 Hibernate 将数据映射到数据库（MySQL）。我有一个查询来获取可交付成果列表：

```
deliverables = (List<Deliverable>) session.createQuery("Select deliverable from
                Task as t where t.project.id= :id And t.user.username = :name")
    .setLong("id", projectId).setString("name", username).list(); 
```

它给了我一百个可交付成果，但我想在任务表中排名前三。我很感激任何帮助。如何修改查询？

请注意，这三个可交付成果不应重复。

与@Freg 答案存在冲突。当我使用这些查询时，一切正常：

```
deliverables = (List<Deliverable>) session.createQuery(
    "from Deliverable as d where d.project.id= :id").setLong("id", projectId).list();
    long task_id;
    for(Deliverable d: deliverables) {
        task_id =  (long) session.createQuery("Select Max(id) from Task as t where     
        t.deliverable.id = :id and t.user.username = :name")
        .setLong("id", d.getId()).setString("name", username).uniqueResult();
         d.setTask_id(task_id);
    }
    sortDeliverable(deliverables);   // sort by Task_id 
```

我认为在@FGreg 提供的查询中，不考虑 max(id)，例如使用 task_id = 31, 643 的交付物两次。它可能认为 Task_id = 31，这是错误的。任何帮助解决它？

我尝试了@Freg 查询，但没有区别。然后它工作正常，除了重复问题。

我试过这个：

```
deliverables = (List<Deliverable>) session.createQuery("from Deliverable as d inner join 
 Task as t where t.id = (select max(t1.id) from Task as t1 where t1.deliverable.id = d.id)   
 and d.project.id= :id and t.user.username = :name order by t.id desc")
                    .setMaxResults(3)
                    .setLong("id", projectId)
                    .setString("name", username)
                    .list(); 
```

我在堆栈跟踪中遇到了新错误：

```
Jul 13, 2012 5:03:10 PM org.hibernate.hql.internal.ast.ErrorCounter reportError
ERROR:  Path expected for join!
Jul 13, 2012 5:03:10 PM org.hibernate.hql.internal.ast.ErrorCounter reportError
ERROR:  Path expected for join!
 Path expected for join!
    at org.hibernate.hql.internal.ast.HqlSqlWalker.createFromJoinElement(HqlSqlWalker.java:371)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.joinElement(HqlSqlBaseWalker.java:3477)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.fromElement(HqlSqlBaseWalker.java:3263)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.fromElementList(HqlSqlBaseWalker.java:3141)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.fromClause(HqlSqlBaseWalker.java:694)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.query(HqlSqlBaseWalker.java:550)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.selectStatement(HqlSqlBaseWalker.java:287)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.statement(HqlSqlBaseWalker.java:235)
    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.analyze(QueryTranslatorImpl.java:248)
    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.doCompile(QueryTranslatorImpl.java:183)
    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.compile(QueryTranslatorImpl.java:136)
    at org.hibernate.engine.query.spi.HQLQueryPlan.<init>(HQLQueryPlan.java:101)
    at org.hibernate.engine.query.spi.HQLQueryPlan.<init>(HQLQueryPlan.java:80)
    at org.hibernate.engine.query.spi.QueryPlanCache.getHQLQueryPlan(QueryPlanCache.java:119)
    at org.hibernate.internal.AbstractSessionImpl.getHQLQueryPlan(AbstractSessionImpl.java:214)
    at org.hibernate.internal.AbstractSessionImpl.createQuery(AbstractSessionImpl.java:192)
    at org.hibernate.internal.SessionImpl.createQuery(SessionImpl.java:1537)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.hibernate.context.internal.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:350)
    at $Proxy65.createQuery(Unknown Source)
    at se.softwerk.timelog.controller.DeliverableManager.deliverableList2(DeliverableManager.java:185)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at com.sun.jersey.spi.container.JavaMethodInvokerFactory$1.invoke(JavaMethodInvokerFactory.java:60)
    at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:205)
    at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75)
    at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147)
    at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1469)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1400)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1349)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1339)
    at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:416)
    at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:537)
    at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:708)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:224)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:928)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:539)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:298)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)

Jul 13, 2012 5:03:10 PM org.hibernate.hql.internal.ast.ErrorCounter reportError
ERROR:  Invalid path: 't.id'
Jul 13, 2012 5:03:10 PM org.hibernate.hql.internal.ast.ErrorCounter reportError
ERROR:  Invalid path: 't.id'
 Invalid path: 't.id'
    at org.hibernate.hql.internal.ast.util.LiteralProcessor.lookupConstant(LiteralProcessor.java:131)
    at org.hibernate.hql.internal.ast.tree.DotNode.resolve(DotNode.java:219)
    at org.hibernate.hql.internal.ast.tree.FromReferenceNode.resolve(FromReferenceNode.java:118)
    at org.hibernate.hql.internal.ast.tree.FromReferenceNode.resolve(FromReferenceNode.java:114)
    at org.hibernate.hql.internal.ast.HqlSqlWalker.resolve(HqlSqlWalker.java:883)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.expr(HqlSqlBaseWalker.java:1246)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.exprOrSubquery(HqlSqlBaseWalker.java:4252)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.comparisonExpr(HqlSqlBaseWalker.java:3730)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.logicalExpr(HqlSqlBaseWalker.java:1923)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.logicalExpr(HqlSqlBaseWalker.java:1848)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.logicalExpr(HqlSqlBaseWalker.java:1848)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.whereClause(HqlSqlBaseWalker.java:782)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.query(HqlSqlBaseWalker.java:583)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.selectStatement(HqlSqlBaseWalker.java:287)
    at org.hibernate.hql.internal.antlr.HqlSqlBaseWalker.statement(HqlSqlBaseWalker.java:235)
    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.analyze(QueryTranslatorImpl.java:248)
    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.doCompile(QueryTranslatorImpl.java:183)
    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.compile(QueryTranslatorImpl.java:136)
    at org.hibernate.engine.query.spi.HQLQueryPlan.<init>(HQLQueryPlan.java:101)
    at org.hibernate.engine.query.spi.HQLQueryPlan.<init>(HQLQueryPlan.java:80)
    at org.hibernate.engine.query.spi.QueryPlanCache.getHQLQueryPlan(QueryPlanCache.java:119)
    at org.hibernate.internal.AbstractSessionImpl.getHQLQueryPlan(AbstractSessionImpl.java:214)
    at org.hibernate.internal.AbstractSessionImpl.createQuery(AbstractSessionImpl.java:192)
    at org.hibernate.internal.SessionImpl.createQuery(SessionImpl.java:1537)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.hibernate.context.internal.ThreadLocalSessionContext$TransactionProtectionWrapper.invoke(ThreadLocalSessionContext.java:350)
    at $Proxy65.createQuery(Unknown Source)
    at se.softwerk.timelog.controller.DeliverableManager.deliverableList2(DeliverableManager.java:185)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source) 
```

模型类：

```
@Entity
public class Task {

    @Id
    @GeneratedValue
    private long id;

    @ManyToOne(optional = false)
    private User user;

    @ManyToOne(optional = false)
    private Project project;

    @ManyToOne(optional = false)
    private Deliverable deliverable;
} 
```

和可交付成果：

```
@Entity
public class Deliverable {

    @Id
    @GeneratedValue
    private long id;

    @Column(name = "short", nullable = false)
    private String key;

    @Column(nullable = false)
    private String name;

    @OneToMany(targetEntity = Task.class, mappedBy = "deliverable", fetch = FetchType.LAZY, cascade = CascadeType.ALL)
    @JsonIgnore
    private Collection<Task> tasks;

    @ManyToOne(optional = false, fetch = FetchType.EAGER)
    @JoinColumn(name = "project")
    private Project project;

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "parent")
    private Deliverable parent;

    @OneToMany(targetEntity = Deliverable.class, mappedBy = "parent", fetch = FetchType.LAZY, cascade = CascadeType.ALL)
    @JsonIgnore
    private Collection<Deliverable> children;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:09:42.750

我认为您要求按 ID 排序的前 3`Deliverable`名。`Task`你可以尝试这样的事情：

**编辑：**好的，我会再试一次。这应该`Deliverable`通过`Task.id`仅将`Deliverable`关联到`max(Task.id)`

```
deliverables = 
        (List<Deliverable>) session.createQuery(
            "from Deliverable as d, Task as t
                where t.deliverable.id = d.id and
                t.id = (select max(t1.id) from Task t1 where t1.deliverable.id = d.id)
                and d.project.id= :id
                and t.user.username = :name
                order by t.id desc")
        .setMaxResults(3)
        .setLong("id", projectId)
        .setString("name", username)
        .list(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-12T05:13:59.160

mysql没有TOP，在sql末尾使用ORDER BY和LIMIT子句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-12T03:41:22.353

我不确定 TOP 函数在 mysql 中是否可用，但尝试使用它并分享结果。你可以这样写：SELECT TOP 2 * FROM Persons

检查此链接，它将为您提供更多详细信息。 [在此处输入链接描述](http://www.w3schools.com/sql/sql_top.asp)

# php - 添加身份验证会在成功登录时引发错误（使用敏捷工具包）

> ID：11441316
> 
> 赞同：0
> 
> 时间：2012-07-11T20:53:30.987
> 
> 标签：php, user-interface, frameworks, atk4

我试图添加 $this->api->auth->check(); 到我的 test.php 页面，当我正确输入登录凭据时它会引发错误：

```
Error in AJAX response: SyntaxError: invalid XML attribute value
Exception_Logic

Method is not defined for this object

Additional information:

    class: Model
    method: tryLoadBy
    arguments: Array ( [0] => email [1] => demo ) 
```

它与包含的“DVD 租赁”示例有同样的问题，当我尝试登录到管理部分时，它给出了一个错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T03:14:58.950

我认为它可能与这个错误有关： [https ://github.com/atk4/atk4/issues/67](https://github.com/atk4/atk4/issues/67)

# loops - 需要一个脚本来根据文件名创建文件夹，并自动移动文件

> ID：11441317
> 
> 赞同：1
> 
> 时间：2012-07-11T20:53:36.440
> 
> 标签：loops, batch-file

我需要一个可以运行的批处理文件（适用于 Windows），它将占用（非常）大量文件，并将它们放在自己的文件夹中。

源目录的结构如下：

```
\\Movies\Movie1.mkv
\\Movies\Movie1.idx
\\Movies\Movie1.sub
\\Movies\Movie1.jpg
\\Movies\Movie1.mkv_sheet.jpg

\\Movies\Movie2.mkv
\\Movies\Movie2.idx
\\Movies\Movie2.sub

\\Movies\Movie3.mkv
\\Movies\Movie3.idx
\\Movies\Movie3.sub 
```

我需要它根据 mkv 文件名创建一个文件夹，然后将 Movie*.* 移动到该文件夹​​中，如下所示：

```
\\Movies\Movie1\Movie1.mkv
\\Movies\Movie1\Movie1.idx
\\Movies\Movie1\Movie1.sub
\\Movies\Movie1\Movie1.jpg
\\Movies\Movie1\Movie1.mkv_sheet.jpg

\\Movies\Movie2\Movie2.mkv
\\Movies\Movie2\Movie2.idx
\\Movies\Movie2\Movie2.sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:29:58.030

*编辑使用注释中指定的路径*

```
@echo off
pushd D:\Video
for %%F in (*.mkv) do (
  2>nul md "%%~nF"
  >nul move /y "%%~nF*.*" "%%~nF"
)
popd 
```

# cakephp - 有没有办法在 cakePHP 中获取渲染视图的列表？

> ID：11441319
> 
> 赞同：0
> 
> 时间：2012-07-11T20:53:41.140
> 
> 标签：cakephp

我想获取为请求呈现的所有视图文件的列表。也许在 sql 日志之后打印出来？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T22:07:47.457

如果这是出于调试目的，请使用[DebugKit](https://github.com/cakephp/debug_kit/)

往下看`Timer`，它将向您显示每个渲染的视图文件以及每个视图文件花费了多长时间。

# python - Python 安装包

> ID：11441323
> 
> 赞同：2
> 
> 时间：2012-07-11T20:53:58.027
> 
> 标签：python, installation, packages

我如何安装包，特异性 [http://klappnase.bubble.org/TkinterTreectrl](http://klappnase.bubble.org/TkinterTreectrl)，我是将文件拖到某处还是使用终端安装？如果那是我需要做的，如何从终端安装？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:45:37.970

如果您使用的是 Ubuntu，您应该只使用软件中心。

```
sudo apt-get install {package-name} 
```

应该就这么简单。也是的，这应该来自终端。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:49:28.917

我假设您已经通过浏览器下载了 zip 文件并将其放入`${HOME}/Downloads`

打开终端并尝试以下命令：

```
cd ${HOME}/Downloads
ls # a bunch of stuff is here, one of the files should be TkinterTreectrl-1.0.zip 
unzip TkinterTreectrl-1.0.zip 
cd TkinterTreectrl-1.0
sudo python setup.py install 
```

当然，您可能需要获取一些依赖项并安装它们。

安装 python 模块通常只需要`<sudo> python setup.py install`解压包含文件的存档。

为了将来参考，以下是如何解压具有各种扩展名的文件：

```
.zip    --> unzip filename.zip
.gz     --> gunzip filname.gz
.tar.gz --> tar -xzvf filename.tar.gz
.tgz    --> tar -xzvf filename.tgz
.bz2    --> bunzip2 filename.bz2 
```

# java - 如何从 .ajax 调用返回两个 JSON 数组？

> ID：11441326
> 
> 赞同：1
> 
> 时间：2012-07-11T20:54:15.053
> 
> 标签：java, javascript, ajax, json, servlets

我正在使用 jqPlot，因为我找不到一个像样的地方来了解如何通过 JSON 将多个系列发送到 jqplot，我将尝试解决它。

*所以这里有一点背景：*

现在，我可以调用我的 servlet 并返回一个 JSON 数组，其中包含要在图表中显示的数据。

**AJAX 调用**

```
$.ajax({
            type:   'POST',
            cache:  'false',
            data:   params,             
            url:    '/miloWeb/PlotChartServlet',
            async:  false,
            dataType: 'json',
            success: function(series){                  
                coordinates =  [series] ;
            },
            error: function (xhr, ajaxOptions, thrownError){
                alert(ajaxOptions);
            }   
        }); 
```

**伺服器**

```
 private void generateCoordinates(HttpServletRequest request, HttpServletResponse response) throws IOException{

    JSONArray coordinates = new JSONArray();
    try {
        coordinates = findChartCoordinatesByPatientPK();
    } catch (JSONException e) {
        e.printStackTrace();
    }
    response.getOutputStream().print(coordinates.toString());

} 
```

这样做是返回字符串：

> [["07/06/2000","22.0"],["08/06/2000","20.0"],["08/06/2003","15.0"],["08/06/2005 ","35.0"],["08/06/2007","12.0"],["08/06/2010","10.0"],["08/06/2012","10.0"]]

所以我将它存储在变量“坐标”中，并使用这些来绘制 jqPlot 图：

```
var plot10 = $.jqplot ('chartdiv', coordinates); 
```

*到目前为止，一切都很好，现在是我想要实现的目标：*

如果我硬编码一个字符串来表示另一个数组中的两个数组，如下所示：

```
[[["07/06/2000","22.0"],["08/06/2000","20.0"],["08/06/2003","15.0"],["08/06/2005","35.0"],["08/06/2007","12.0"],["08/06/2010","10.0"],["08/06/2012","10.0"]], [["07/06/2000","21.0"],["08/06/2000","19.0"],["08/06/2003","14.0"],["08/06/2005","34.0"],["08/06/2007","11.0"],["08/06/2010","9.0"],["08/06/2012","9.0"]]] 
```

我可以让 jQplot 在图表中绘制两条不同的线！所以我尝试做同样的事情并通过 servlet 返回一个与该字符串完全相同的字符串：

**不工作的服务器**

```
 private void generateCoordinates(HttpServletRequest request, HttpServletResponse response) throws IOException{
        JSONArray coordinates = new JSONArray();
        JSONArray coordinates2 = new JSONArray();
        try {
            coordinates = VitalsBB.findChartCoordinatesByPatientPK();
            coordinates2 = VitalsBB.findChartCoordinatesByPatientPK2();
        } catch (JSONException e) {
            e.printStackTrace();
        }
        response.getOutputStream().print( coordinates.toString() + ", " + coordinates2.toString());

    } 
```

但这不起作用，它给了我一个解析错误。那么我需要修改AJAX调用吗？或者有没有办法将两个返回`JSON arrays.toString()`给我的表单并将它们存储在一个变量中？或者也许我需要两个变量？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-11T20:57:53.550

当您调用`response.getOutputStream().print()`.

试试这个：

```
response.getOutputStream().print("[" + coordinates.toString() + ", " + coordinates2.toString() + "]"); 
```

如果您的代码在您对数组进行硬编码时有效，那么这应该有效。

# c# - 通过 C# 代码创建数据绑定控件？

> ID：11441328
> 
> 赞同：0
> 
> 时间：2012-07-11T20:54:19.800
> 
> 标签：c#, windows-phone-7, xaml, itemssource, databound

我知道在 XAML 中可以使用代码创建数据模板，这样您就可以根据自己的喜好设置控件的样式和绑定：

```
 <ListBox x:Name="statusBox">
        <ListBox.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel />
            </ItemsPanelTemplate>
        </ListBox.ItemsPanel>
        <ListBox.ItemTemplate>
            <DataTemplate>
                <Grid x:Name="ListBoxItemLayout" >
                    <StackPanel>
                        <TextBlock x:Name="time" Style="{StaticResource PhoneTextNormalStyle}" Margin="0" Width="462" Text="{Binding time}" FontSize="16" FontWeight="Bold"/>
                        <TextBlock x:Name="status"  Style="{StaticResource PhoneTextNormalStyle}" Margin="0" Width="462" Text="{Binding status}" TextWrapping = "Wrap" Height="85" HorizontalAlignment="Left" VerticalAlignment="Top"/>
                    </StackPanel>
                </Grid>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox>

 public class status
    {
        public string time{ get; set; }
        public string statusText{ get; set; }
    }

        List<status> list = new List<status>();

        status aStatus = new status() { time="3:00pm", statusText="this is a status" };
        list.Add(aStatus);

        statusBox.ItemsSource = list; 
```

但是，在我最新的项目中，我有一个动态添加项目/页面的数据透视控件，因此我无法在页面上定义任何 xaml。有什么解决方法吗？

我想要做的是仅通过 c# 代码创建一个数据模板，这样我就可以在我的应用程序中实例化一个新控件。

```
 List<status> list = new List<status>();
                statusBox lb = new statusBox(); // <-------------------- look here

                status aStatus = new status() { time="3:00pm", statusText="this is a status" };
                list.Add(aStatus);
                list.Add(aStatus);

                lb.ItemsSource = list;

                PivotItem pi = new PivotItem();
                pi.Content = lb;
                Pivot pivot = pivot1;
                pivot.Items.Add(pi); 
```

是否可以通过这种方式创建自定义控件？如果是这样，如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T08:02:44.730

首先，在手机资源部分创建一个DataTemplate

```
<phone:PhoneApplicationPage.Resources>
    <DataTemplate x:Name="listBoxTemplate">
        <Grid >
            <StackPanel>
                <TextBlock Style="{StaticResource PhoneTextNormalStyle}" Margin="0" Width="462" Text="{Binding time}" FontSize="16" FontWeight="Bold"/>
                <TextBlock Style="{StaticResource PhoneTextNormalStyle}" Margin="0" Width="462" Text="{Binding statusText}" TextWrapping = "Wrap" Height="85" HorizontalAlignment="Left" VerticalAlignment="Top"/>
            </StackPanel>
        </Grid>
    </DataTemplate>
</phone:PhoneApplicationPage.Resources> 
```

然后在代码隐藏文件中使用以下代码动态生成ListBox

```
ListBox lb = new ListBox() { Name = "statusBox" };
lb.ItemTemplate = this.listBoxTemplate;

List<status> list = new List<status>();
status aStatus = new status() { time = "3:00pm", statusText = "this is a status" };
list.Add(aStatus);
list.Add(new status() { time = "4:00pm", statusText = "this is another status" });

lb.ItemsSource = list;
this.ContentPanel.Children.Add(lb); 
```

# asp.net - 路由表排序问题

> ID：11441335
> 
> 赞同：2
> 
> 时间：2012-07-11T20:54:49.653
> 
> 标签：asp.net, asp.net-routing

我们的路由表设置如下：

```
// ... specific routes

routes.MapRoute(
    "aspx", 
    "{controller}.aspx/{action}/{id}", 
    new { controller = "Home", action = "Index", id = UrlParameter.Optional });

routes.MapRoute(
    "Default", 
    "{controller}/{action}/{id}", 
    new { controller = "Home", action = "Index", id = UrlParameter.Optional }); 
```

这允许 URL 喜欢`/Foo.aspx`并且也`/Foo`可以正确路由到`FooController.Index`. 我相信这是为了向后兼容而添加的。但是，当使用`UrlHelper`生成 URL时`UrlHelper.Action`，会使用更丑陋的 URL 版本。例如，`Url.Action("Bar", "Foo")`产量`Foo.aspx/Bar`。

我希望生成的 URL 使用更干净的`Default`路由。如果我交换两个`MapRoute`调用，则此方法有效，但随后`/Foo.aspx`不再路由到，`FooController`因为它`.aspx`被视为包含在`{controller}`占位符中。

URL 参数中是否有任何方法`MapRoute`可以让我们将路由放在`Default`路由之前`aspx`并允许两者都工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:03:29.410

你可以尝试`Html.RouteLink`在那里你给出你的路由应该使用的路由名称

[http://msdn.microsoft.com/en-us/library/system.web.mvc.html.linkextensions.routelink.aspx](http://msdn.microsoft.com/en-us/library/system.web.mvc.html.linkextensions.routelink.aspx)

它应该工作。

# iphone - 有没有办法将 TabBarItem 的图标追溯设置为系统项？

> ID：11441337
> 
> 赞同：0
> 
> 时间：2012-07-11T20:54:57.380
> 
> 标签：iphone, objective-c, ios, ipad

我知道您可以使用 initWithTabBarSystemItem:tag: 在 Objective-C 中初始化 TabBarItem，但是在创建 TabBarItem 之后有没有办法设置图标？例如：

```
self.tabBarItem.title = "@Browser";
self.tabBarItem.image = 
```

由于预定义的系统图标列表是一个枚举，我不确定如何插入它们，因为 image 属性会查找 UIImage * 类型的对象。

# .htaccess - htaccess 午夜后重定向

> ID：11441345
> 
> 赞同：0
> 
> 时间：2012-07-11T20:55:33.437
> 
> 标签：.htaccess

我想在某个日期的午夜之后重定向 HTTP 请求，那么我该如何更改：

```
RewriteCond %{HTTP_HOST} ^.*$
RewriteRule ^mypage/?$ http://mysite.com/my-other-page/ [R=302,L] 
```

所以它只发生在 2012-07-12 00:00:01 之后

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:02:22.640

由于您不希望在框架/脚本中执行此操作，请查看 mod_rewrite 的 TIME 变量：

概述： [http ://www.askapache.com/htaccess/time_hour-rewritecond-time.html](http://www.askapache.com/htaccess/time_hour-rewritecond-time.html)

示例： [http ://www.askapache.com/htaccess/mod_rewrite-variables-cheatsheet.html#TIME](http://www.askapache.com/htaccess/mod_rewrite-variables-cheatsheet.html#TIME)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:00:54.487

您应该使用日期函数在代码中管理它：

PHP 示例：

```
if ($date < $somedate) {
    header('HTTP/1.1 302 Found');
    header('Location: http://www.example.com/error.php');
    exit;
} 
```

# python - 取python中索引滑动窗口的总和

> ID：11441347
> 
> 赞同：0
> 
> 时间：2012-07-11T20:55:46.283
> 
> 标签：python, list, int, sum, sliding-window

我环顾四周，但无法找出我的代码失败的原因，以及如何正确地做到这一点。我是编码新手（3 天），所以请原谅我的笨拙。

我从一个整数列表开始，本质上我想创建一个新的或更新的列表，其中新列表的第一个索引的值 = 原始列表的前 10 个值的总和 (0-10)，然后是新的列表的第二个索引的值 = 原始列表 (1-11) 索引值的总和。

问题是它错误地添加了所有内容，并且以一种我还无法弄清楚模式的方式。

这是我所拥有的：

```
def sum_range(filename, grouping = 10):
    """sums up the ss values for 'groupings' numbers of indices.
    Shows ALL results, regardless of how high or low strandedness is"""

    sslist = ssc_only(filename)
    # "ssc_only(filename)" takes my input and returns it as a list of int,
    # which I want to use for this function

    sslist = [sum(sslist[i:i+grouping]) for i in sslist]

    return sslist 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T20:59:09.670

我认为您可能想要`for i in range(len(sslist))` （如果您担心内存消耗，请使用`xrange`而不是在 python 2 中）。`range`

```
lstlen=len(sslist)
sslist = [sum(sslist[i:min(i+grouping,lstlen)]) for i in range(lstlen)] 
```

您正在循环列表*项*而不是列表*索引*

当然，您的最后 10 个元素将是少于 10 个元素的总和。由于我不知道您想对这些元素做什么，所以我会让您自己弄清楚您想对它们做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:06:45.020

不要认为你的求和是正确的......如果你以 10 个为一组，你会得到比原始列表少 10 个样本 - 这`len(r) - 10`在下面的表达式中给出。

```
>>> r = range(20)
>>> r
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
>>> [sum(r[n:10+n]) for n in range(len(r)-10)]
[45, 55, 65, 75, 85, 95, 105, 115, 125, 135] 
```

# .net - 在 XAML 中使用 VisualStateManager 动画边框调整大小

> ID：11441349
> 
> 赞同：0
> 
> 时间：2012-07-11T20:55:53.553
> 
> 标签：.net, wpf, silverlight, xaml

我有一个边框，它根据内容（异步加载）改变大小，是否可以在 xaml 中设置边框大小的动画？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T04:11:43.467

对的，这是可能的。您必须使用边框的缩放而不是使用它们的高度和宽度。请通过以下链接解决您的问题。

[动画边框大小](http://www.exploresilverlight.com/2012/07/animate-border-without-defining-size.html)

干杯! 维诺德

# asp.net-mvc-3 - 使用 Universal Providers 在 SQL Server CE 上以编程方式创建成员数据库

> ID：11441352
> 
> 赞同：0
> 
> 时间：2012-07-11T20:56:04.733
> 
> 标签：asp.net-mvc-3, asp.net-membership, sql-server-ce, membership-provider

我需要在 SQL Server CE4 服务器上以编程方式创建标准成员数据库。我正在使用 asp.net 通用提供商来提供会员资格，如下所述：[http ://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx)

我尝试使用`System.Web.Management SqlServices.Install()`如下：

```
SqlServices.Install("local.sdf", SqlFeatures.Membership, connectionString.ConnectionString); 
```

但它总是抛出一个错误，说它无法连接到 SQL Server 数据库。

我怀疑`SqlServices.Install()`可能不支持与 SQL Server CE 的连接，但我很好奇其他人是否找到了解决方法。这是一个 MVC3 应用程序，我正在尝试在重新部署应用程序之前自动构建一个空数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-28T19:59:46.217

ErikEJ 是正确的。但是，为了让成员资格提供程序生成 .sdf（SQL Server Compact 4.0 本地数据库），您需要在您的 web.config 中提供适当的 connectionString，如***[Hanselman 帖子](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx)***中所述。

此外，我发现使用您已经开始并在您的初始帖子中描述的方法 Jon Galloway 有一个很棒的 SimpleMembership 演练，它几乎与您正在做的事情相同，而不是使用它使用 SimpleMembership 的 MembershipProvider，我发现材料可以互换。

我是***[活生生的证据](https://stackoverflow.com/questions/16259581/mvc4-membership-sql-server-compact-4-0-exception-unable-to-find-the-reque/16266927#16266927)***，加油！

# internet-explorer - Jquery Ajax 请求未在 IE 中发送

> ID：11441354
> 
> 赞同：3
> 
> 时间：2012-07-11T20:56:08.757
> 
> 标签：internet-explorer, jquery, jquery-post

我有一个在 FF、Chrome、Opera 和 Safari 中工作的 ajax 请求。我在 IE 中对其进行了测试，它执行了两个请求中的第一个。它从 php 脚本中获取 IP，但是当它发布到我的 java servlet 时，它不会发出请求；我用小提琴和wireshark进行了测试，请求没有被发送出去。我尝试将 ajax 缓存设置为 false 没有帮助。不确定它可能是什么。php 发送的唯一区别是 IE 不发送 Client Accept-Charset。这让我相信这个问题与第一个请求有关；但是它正确地获取了数据，所以我有点难以理解？我删除了特定地址，但其余代码或多或少相同。
更改了我的代码，以便我没有嵌入式请求，我准备好文档，阻止 IE 冻结但它仍然没有发送出去。它现在还返回 Ajax 请求上的一般错误返回。更改代码更像下面

```
 <script>
$(function()
{
    function myfunction(event) 
    {  
        var email = $("#emailInput").val();
        if (email.indexOf('@') == -1 || email.indexOf('.') == -1)
        {
            alert("Please Enter a Valid Email");
        }
        else
        {   
            var eEmail = "email:" + email +"," + "ip:" + ip;
            Email = "="+encodeURIComponent(eEmail);

            $.support.cors = true;
            $.ajax(
                {
                url: 'myServletURI',
                type: 'POST',
                data: eEmail,
                cache: 'false',
                error: function(xhr,textStatus)
                {
                    alert(textStatus);
                },
                success: function(data)
                { 
                    //I have a JS lib I wrote to parse results
                    var result = makeDictionary(data);
                    if(result["command"] == "failed")
                    {
                        alert("Error");
                    }
                    else
                    {
                        window.location = "goToNextPage.html";
                    }                                                      
                }
            });
        }
    }
return false;
}); 
</script> 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T20:36:35.367

您认为这可能是跨站点错误的评论让我觉得这可能是您的答案：[Access denied to jQuery script on IE](https://stackoverflow.com/questions/5087549/access-denied-to-jquery-script-on-ie)

要点是您不能使用 jquery 在 IE 中进行跨站点 ajax 请求，您必须使用 XDomainRequest。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-03T07:18:59.240

我使用“GET”而不是“POST”，它在 IE9 中为我工作

# android - 线性渐变在移动网络浏览器中不起作用

> ID：11441357
> 
> 赞同：7
> 
> 时间：2012-07-11T20:56:21.710
> 
> 标签：android, css, ios, mobile

我正在编写一个移动网络应用程序，我想知道是否有人可以帮助我理解和修复这些线性渐变，以便它们`Safari-mobile`在`Android-browser`.

我相信我正确使用了每个供应商前缀，我什至提供了备用背景颜色，但是每当我在移动设备上查看应用程序时，应用渐变背景的元素是透明的。换句话说，背景是透明的，渐变不会显示在移动设备上。意思是，即使是后备颜色也不起作用。

更奇怪的是，它们（渐变）出现在 android 和`iOS`.

有人可以帮我修复这些渐变，以便它们在桌面和移动设备上都可以使用，还可以教我如何使用后备背景颜色和背景图像？

我真的很感激任何和所有的帮助！

这是我到目前为止所拥有的：

```
background:#fff;
background:transparent -ms-linear-gradient(top, rgba(255,255,255,.65), rgba(255,255,255,.9));
background:transparent url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHByZXNlcnZlQXNwZWN0UmF0aW89Im5vbmUiPjxsaW5lYXJHcmFkaWVudCBpZD0iaGF0MCIgZ3JhZGllbnRVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giIHgxPSI1MCUiIHkxPSIxMDAlIiB4Mj0iNTAlIiB5Mj0iLTEuNDIxMDg1NDcxNTIwMmUtMTQlIj4KPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iI2ZmZiIgc3RvcC1vcGFjaXR5PSIwLjY1Ii8+CjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iI2ZmZiIgc3RvcC1vcGFjaXR5PSIwLjkiLz4KICAgPC9saW5lYXJHcmFkaWVudD4KCjxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiBmaWxsPSJ1cmwoI2hhdDApIiAvPgo8L3N2Zz4=);
background:transparent -o-linear-gradient(90deg, rgba(255,255,255,.65) 0%, rgba(255,255,255,.9) 100%);
background:transparent -moz-linear-gradient(90deg, rgba(255,255,255,.65) 0%, rgba(255,255,255,.9) 100%);
background:transparent -webkit-gradient(linear, 0%, 0%, 0%, 100%, from(rgba(255,255,255,.65), to(rgba(255,255,255,.9));
background:transparent -webkit-linear-gradient(90deg, rgba(255,255,255,.65) 0%, rgba(255,255,255,.9) 100%);
background:transparent linear-gradient(90deg, rgba(255,255,255,.65) 0%, rgba(255,255,255,.9) 100%); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-11T21:24:41.327

这应该适用于刚刚测试过的每个浏览器（甚至是移动浏览器）：

```
#element {
    background: -moz-linear-gradient(black, transparent); /* FF 3.6+ */  
    background: -ms-linear-gradient(black, transparent); /* IE10 */  
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #000000), color-stop(100%, #ffffff)); /* Safari 4+, Chrome 2+ */  
    background: -webkit-linear-gradient(black, transparent); /* Safari 5.1+, Chrome 10+ */  
    background: -o-linear-gradient(black, transparent); /* Opera 11.10 */  
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#000000', endColorstr=transparent); /* IE6 & IE7 */  
    -ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr='#000000', endColorstr=transparent)"; /* IE8+ */  
    background: linear-gradient(black, transparent); /* the standard */  
    z-index: 1;
} 
```

在浏览器上查看这两个不错的 CSS 网站：

*   [站点 1](http://praktikanten.brueckenschlaeger.org/2011/05/18/css-gradient-and-mobile-browsers)
*   [站点 2](http://www.impressivewebs.com/css3-linear-gradient-syntax/)

    *（我用这个演示[http://jsfiddle.net/luissanchezm86/4Kwb4/](http://jsfiddle.net/luissanchezm86/4Kwb4/)在 iOS 5.1.1 上对其进行了测试）*

希望能帮助到你！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-11-25T04:26:47.257

至少在移动 safari 中，您不能使用关键字`transparent`，而必须使用`rgba(255,255,255,0)`。证明：[https ://developer.apple.com/library/archive/documentation/InternetWeb/Conceptual/SafariVisualEffectsProgGuide/Gradients/Gradient.html](https://developer.apple.com/library/archive/documentation/InternetWeb/Conceptual/SafariVisualEffectsProgGuide/Gradients/Gradient.html)

搜索透明，你甚至会在他们的官方文档中看到，他们使用`rgba`透明颜色。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T21:14:28.850

财产透明有必要吗？

见： http: [//www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

# c++ - Hello world 程序在 gtkmm 中崩溃

> ID：11441364
> 
> 赞同：2
> 
> 时间：2012-07-11T20:57:36.283
> 
> 标签：c++, windows-7, mingw, gtkmm

我正在尝试让 gtkmm 使用 MinGW 在 Windows 7 上工作。但是，当我从[gtkmm-tutorial](http://developer.gnome.org/gtkmm-tutorial/2.22/gtkmm-tutorial.html#sec-helloworld)编译 hello world 程序后，exe 会因段错误而崩溃。

我已经用这个编译了程序：

```
$ g++ helloworld.cc main.cc -o hw `pkg-config --cflags --libs gtkmm-2.4` 
```

这是 gdb 显示的内容：

```
$ gdb hw.exe
GNU gdb (GDB) 7.2
Copyright (C) 2010 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "mingw32".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from c:\dev/hw.exe...done.
(gdb) run
Starting program: c:\dev/hw.exe
[New Thread 4348.0x1560]
[New Thread 4348.0x1430]

Program received signal SIGSEGV, Segmentation fault.
0x664d85b2 in Glib::ObjectBase::ObjectBase (this=0x47453c, __vtt_parm=0x1,
    __in_chrg=<value optimized out>) at objectbase.cc:49
49      objectbase.cc: No such file or directory. 
```

我是一个新手，所以我不知道如何让它工作。

我从[这里](https://live.gnome.org/gtkmm/MSWindows#gtkmm)下载了 gtkmm（2.22 版本）和 g++ 的版本：

```
$ g++ -v
Using built-in specs.
COLLECT_GCC=c:\Mingw\bin\g++.exe
COLLECT_LTO_WRAPPER=c:/mingw/bin/../libexec/gcc/i686-pc-mingw32/4.7.1/lto-wrappe
r.exe
Target: i686-pc-mingw32
Configured with: ../src/configure --prefix=/c/temp/gcc/dest --with-gmp=/c/temp/g
cc/gmp --with-mpfr=/c/temp/gcc/mpfr --with-mpc=/c/temp/gcc/mpc --enable-language
s=c,c++ --with-arch=i686 --with-tune=generic --disable-libstdcxx-pch --disable-n
ls --disable-shared --disable-sjlj-exceptions --disable-win32-registry --enable-
checking=release --enable-lto
Thread model: win32
gcc version 4.7.1 (GCC) 
```

我需要更多的东西吗？还是我做错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T22:52:55.383

似乎 MinGW[对 GCC 4.7.0 进行了 ABI 更改](http://mingw-users.1079350.n2.nabble.com/MinGW-GCC-4-7-0-released-tt7578133.html)。如果你的 gtkmm 是用早期的 GCC 编译的，这会导致你看到的问题。尝试使用相同的编译器重建 gtkmm。

# php - PHP 字符串连接

> ID：11441369
> 
> 赞同：56
> 
> 时间：2012-07-11T20:58:07.377
> 
> 标签：php, string-concatenation

是否可以连接字符串，如下所示？如果没有，这样做的替代方法是什么？

```
while ($personCount < 10) {
    $result += $personCount . "person ";
}

echo $result; 
```

它应该看起来像`1 person 2 person 3`人等。

您不能`+`在连接中使用符号，那么有什么替代方法？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2012-07-11T20:59:18.780

仅`.`用于连接。你错过了`$personCount`增量！

```
while ($personCount < 10) {
    $result .= $personCount . ' people';
    $personCount++;
}

echo $result; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-11T21:03:34.277

一步（恕我直言）更好

```
$result .= $personCount . ' people'; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-12T02:37:37.053

```
while ($personCount < 10) {
    $result .= ($personCount++)." people ";
}

echo $result; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-03-18T17:59:11.143

这应该更快。

```
while ($personCount < 10) {
    $result .= "{$personCount} people ";
    $personCount++;
}

echo $result; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-11T21:32:07.390

我认为这段代码应该可以正常工作：

```
while ($personCount < 10) {
    $result = $personCount . "people ';
    $personCount++;
}
# I do not understand why you need the (+) with the result.
echo $result; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-08-09T06:31:52.360

```
$personCount = 1;
while ($personCount < 10) {
    $result = 0;
    $result .= $personCount . "person ";
    $personCount++;
    echo $result;
} 
```

# c++ - 在 Windows 命令提示符下打印 libcurl 响应

> ID：11441371
> 
> 赞同：0
> 
> 时间：2012-07-11T20:58:09.123
> 
> 标签：c++, unicode, cmd, libcurl

我试图打印出我从 curl 查询（UTF-8 字符集）得到的答案，在执行查询后，我使用以下代码创建了一个字符串：

```
size_t writeToString(char* ptr, size_t size, size_t nmemb, std::string* stringPtr) {
    stringPtr->append(ptr, nmemb*size);
    return size*nmemb;
} 
```

在执行`cout`字符串时，Unicode 字符显示为它们的代码（例如 \u0434）。我尝试将命令提示符的代码页更改为 65001。是否可以在 Windows 命令提示符中打印出 UTF-8 curl 响应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T01:46:00.317

您是否尝试在 cout 之前将其存储在**std::wstring**（而不是 std::string）中？

这个问题可能会有所帮助： [UTF8 to/from wide char conversion in STL](https://stackoverflow.com/questions/148403/utf8-to-from-wide-char-conversion-in-stl)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T01:49:19.147

尝试调用`SetConsoleOutputCP(65001)`，然后使用`WriteConsole()`or`WriteConsoleOutput()`代替`std::cout`.

否则，将 UTF-8 数据解码为 UTF-16，然后将其转换为 Ansi，然后再使用`std::cout`.

# android - 防止片段自定义动画在屏幕旋转上播放？

> ID：11441373
> 
> 赞同：2
> 
> 时间：2012-07-11T20:58:16.707
> 
> 标签：android, android-fragments

我在 FragmentTransaction 中为我的秒表片段使用自定义动画。这是代码：

```
private void addStopWatch() {
    if(_stopwatchFragment == null) {
        _stopwatchFragment = new StopwatchFragment();

        FragmentTransaction fragmentTransaction = getSupportFragmentManager().beginTransaction();
        fragmentTransaction.setCustomAnimations(R.anim.anim_slide_down, R.anim.anim_slide_up)
                           .add(R.id.ContentContainer, _stopwatchFragment, STOPWATCH_TAG)
                           .commit();

        _stopwatchVisible = true;
    }
} 
```

每当屏幕旋转时，就会再次播放 R.anim.anim_slide_down 动画（这里我不是添加新片段，而是重新附加已经存在的片段）。有没有办法避免这种行为，让片段与活动视图一起出现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T00:06:29.680

这可以通过在活动中使用静态字段轻松解决。将其声明为活动类的静态成员：

```
private static boolean hasAnimated = false; 
```

然后在你的方法中你可以这样做：

```
private void addStopWatch() {
    if(_stopwatchFragment == null) {
        _stopwatchFragment = new StopwatchFragment();

        FragmentTransaction fragmentTransaction = getSupportFragmentManager().beginTransaction();

        if(!hasAnimated) {
            fragmentTransaction.setCustomAnimations(R.anim.anim_slide_down, R.anim.anim_slide_up)
                               .add(R.id.ContentContainer, _stopwatchFragment, STOPWATCH_TAG)
                               .commit();
            hasAnimated = true
        } else {
            fragmentTransaction.add(R.id.ContentContainer, _stopwatchFragment, STOPWATCH_TAG)
                               .commit();
        }

        _stopwatchVisible = true;
    }
} 
```

虽然我不确定这是否需要对活动破坏进行适当的清理。可以肯定的是，在 onDestroy() 中将 hasAnimated 设置为 false。

# csv - 从 .csv 文件中获取数据，分析，产生输出 - python3

> ID：11441380
> 
> 赞同：0
> 
> 时间：2012-07-11T20:58:59.697
> 
> 标签：csv, python-3.x

我正在尝试在 Python3 中完成作业。[它与此处](http://www.cse.msu.edu/~cse231/PracticeOfComputingUsingPython/05_ListsTuples/Basketball/)找到的 pdf 非常相似

关于如何获取我需要的信息的执行，以及如果可能的话，一些可以让我继续前进的代码，我有几个问题。我是 python 新手。`"directory not found"`正如我现在所拥有的代码一样，在运行一个函数以尝试读取数据后，我不断收到错误消息。我知道该`.csv`文件应该位于我在 WingIDE 中保存它的目录中，但我无法让它正常工作。

我的第一个问题是在从我的 get_file_list 中读取 .csv 文件的每一行之后，获取每个类别并将其放入效率方程的最佳方法是什么？

这是我的`get_data_list`功能：

```
def get_data_list(filename):
    data_file = open(filename, "r")
    data_list = [ ] 
    for line_str in data_file:
        data_list.append(line_str.strip().split(','))
    return data_list 
```

当我运行时，`get_data_list("player_regular_season.csv")`我收到以下错误：

> builtins.IOError：[Errno 2] 没有这样的文件或目录：'player_regular_season.csv'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T06:27:34.787

对于第一次尝试，您可以将数据文件与 Python 程序放在同一目录中，然后从该目录中启动它。

还可以尝试使用单一用途脚本来学习如何使用目录。从标准文档[15.1.5 中学习函数。文件和目录](http://docs.python.org/py3k/library/os.html#files-and-directories)，即[os.getcwd()](http://docs.python.org/py3k/library/os.html#os.getcwd)，[os.chdir(path)](http://docs.python.org/py3k/library/os.html#os.chdir)，然后是[10.1。os.path - 常见的路径名操作](http://docs.python.org/py3k/library/os.path.html#module-os.path)，即[os.path.isfile(path)](http://docs.python.org/py3k/library/os.path.html#os.path.isfile)。

但也请阅读文档中其他功能的文档以了解可用的功能。

在了解如何使用文件名和路径时，请查看[13.1。csv — CSV 文件读取和写入](http://docs.python.org/py3k/library/csv.html)。不要害怕所有的东西，从头开始[——13.1.5。使用 csv 模块的示例](http://docs.python.org/py3k/library/csv.html#examples)。

# django - Django URL 别名

> ID：11441382
> 
> 赞同：-2
> 
> 时间：2012-07-11T20:59:06.523
> 
> 标签：django, django-views

我是 Django 新手，我有一个大问题。我不喜欢 Django 的“url 模式”哲学。

我不希望我的页面看起来像 [http://domain.com/object/title-of-object](http://domain.com/object/title-of-object) 我想要 [http://domain.com/title-of-object](http://domain.com/title-of-object) 当然我会有不止一种类型的对象。

有没有一种优雅的方法可以用 Django 实现这一点（不使用硬编码的 url）？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T23:04:26.973

有没有想过，如果你想做的事情似乎很难实现，那么你做错了吗？/foo/name-of-foo/ 有什么问题？

我试图想象您的用例，并想知道您是否只需要少数页面的“人工”URL。如果是这样，它可以使用 /foo/slug-for-foo/ 方法，然后使用[django.contrib.redirects](https://docs.djangoproject.com/en/dev/ref/contrib/redirects/)应用程序来支持重定向到更理智、更 RESTful 的手写 URL？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:05:54.613

有可能的。您必须创建一个包罗万象的 URL 模式，您将为此创建一个视图，该视图将搜索所有可能的对象类型，找到匹配的对象类型，然后处理并返回它。通常，这是一个坏主意。

# c# - 返回一个通用的 IEnumerable

> ID：11441395
> 
> 赞同：27
> 
> 时间：2012-07-11T20:59:50.520
> 
> 标签：c#, generics, ienumerable

我正在搞乱泛型和 IEnumerable，但我有点卡住了。这就是我想要做的事情：我想要一个返回任何集合类型的方法 - 实现 IEnumerable (?) - （例如：列表、堆栈、队列......）

此外，我希望能够返回任何数据类型的任何集合类型。所以我希望这个方法能够返回 a`List<string>,`和 a `Stack<int>`，以及 a `List<double>`... 等等。

```
 public IEnumerable<T> returnSomething() 
    {
        Stack<int> stackOfInts = new Stack<int>();
        List<string> listOfStrings = new List<string>();
        return stackOfInts;
    } 
```

这是我到目前为止所尝试的。但是这不起作用，我收到此错误：

```
Cannot implicitly convert type 'System.Collections.Generic.Stack<int>' to 'System.Collections.Generic.IEnumerable<T>'. An explicit conversion exists (are you missing a cast?) 
```

但是，如果我将`IEnumerable<T>`方法签名中的 替换为`IEnumerable<int>`，我可以返回任何 int 类型的集合。然而，这意味着，现在我不能再返回`ListOfStrings`了。

将不胜感激任何建议或想法:)

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-07-11T21:02:52.187

您需要在方法中添加[泛型类型参数](http://msdn.microsoft.com/en-us/library/0zk36dx2)：

```
public IEnumerable<T> ReturnSomething<T>() 
{
    Stack<T> stackOfT = new Stack<T>();
    return stackOfT;
} 
```

类型参数出现在方法名称之后，但在参数之前。也可以有一个具有多个类型参数的方法。

当您调用该方法时，您可以指定类型：

```
IEnumerable<int> myInts = ReturnSomething<int>(); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-11T21:06:31.833

诀窍是**声明** `<T>`正确，如果你定义了 generic `<T>`，那么你必须在你的方法中坚持它，所以如果你`IEnumerable<T>`在你的方法中的其他地方你必须使用`<T>`而不是`<int>`任何其他类型。

只有在您实际**使用**泛型类型时才会用泛型替换`<T>`真实类型。

查看示例

```
class Foo<T>
{
    public IEnumerable<T> GetList()
    {
        return new List<T>();
    }

    public IEnumerable<T> GetStack()
    {
        return new Stack<T>();
    }
}

class Program
{
    static void Main(string[] args)
    {
        Foo<int> foo = new Foo<int>();
        IEnumerable<int> list = foo.GetList();
        IEnumerable<int> stack = foo.GetStack();

        Foo<string> foo1 = new Foo<string>();
        IEnumerable<string> list1 = foo1.GetList();
        IEnumerable<string> stack1 = foo1.GetStack();
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-11T21:06:45.087

```
public IEnumerable<T> returnSomething() 
{
    Stack<int> stackOfInts = new Stack<int>();
    return (IEnumerable<T>) stackOfInts;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-11T21:07:21.217

类型参数需要由调用者在某处指定。

在实例化泛型类时：

```
public class MyClass<T>
{
    public IEnumerable<T> returnSomething()
    {
        Stack<T> stackOfTs = new Stack<T>();
        List<T> listOfTs = new List<T>();
        return stackOfTs;
    }
}

var v = new MyClass<int>();
foreach(var item in v.returnSomething())
{
} 
```

或者在调用非泛型类的泛型方法时：

```
public class MyClass
{
    public IEnumerable<T> returnSomething<T>()
    {
        Stack<T> stackOfTs = new Stack<T>();
        List<T> listOfTs = new List<T>();
        return stackOfTs;
    } 
}

var v = new MyClass();
foreach(var item in v.returnSomething<int>())
{
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-11-24T03:34:24.500

**如需更多帮助，完整结构如下...**

**我的模型是**

```
 public class Student
{
    public int studentId { get; set; }
    public string studentName { get; set; }
    public string subject { get; set; }
    public string studentClass { get; set; }
    public int RollNumber { get; set; }

} 
```

**IEnumerable 返回数据列表**

```
 public static IEnumerable<Student> ReturnSomething()
        {
            IList<Student> studentList = new List<Student>()
            {
                new Student()
                    {studentId = 1, studentName = "Bill", subject = "Science", studentClass = "nine", RollNumber = 01},
                new Student()
                    {studentId = 2, studentName = "Steve", subject = "Arts", studentClass = "ten", RollNumber = 03},
                new Student()
                    {studentId = 3, studentName = "Ram", subject = "Commerce", studentClass = "nine", RollNumber = 05},
                new Student()
                    {studentId = 1, studentName = "Moin", subject = "Science", studentClass = "ten", RollNumber = 06}
            };

            return studentList;
        } 
```

**最后一个是访问代码**

```
 Student student = new Student();
 IEnumerable<Student> studentList = ReturnSomething();

        foreach (Student VARIABLE in studentList)
        {
            student.studentName += VARIABLE.studentName + " "+ "Class= ";
            student.studentClass += VARIABLE.studentClass + " ";
        }

        Console.WriteLine(student.studentName + student.studentClass);
        Console.ReadKey(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-11T21:06:39.693

是的，如果您更改 I，您可以返回任何类型`Enumerable<T> to IEnumerable<dynamic>`

像这样：

```
public IEnumerable<dynamic> returnSomething() 
{
..... 
```

# c++ - 初始化 QList 作为静态类成员给出 LNK2001 错误

> ID：11441396
> 
> 赞同：1
> 
> 时间：2012-07-11T20:59:54.823
> 
> 标签：c++, qt, static-members, qlist, lnk2001

这最好由代码本身来解释。我想使用 a`QList<MyStruct>`作为静态成员，但得到一个链接器错误 2001 ( `LNK2001`)。代码在文件中的顺序相同`MyClass.h`

```
struct MyStruct{
    double  x;
    ...
};
typedef QList<MyStruct> MyStructList;

class MyClass
{
....
private:
    static MyStructList _myValues; // does not work => LNK2001
           MyStructList _myValues; // Test 1 OK
    static QList<int> _myValues; // Test 2 OK 
```

有什么提示吗？**Eran 的回答（见下面的评论）是正确的提示。解决了**

```
LNK2001:
error: LNK2001: unresolved external symbol "private: static class QList<struct> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:13:39.563

另一个被遗忘的静态成员定义的案例......`MyStructList MyClass::_myValues`应该放在项目的一个 .cpp 文件中。

# oauth-2.0 - 如何从我的 Oauth 令牌中读取声明？

> ID：11441400
> 
> 赞同：0
> 
> 时间：2012-07-11T21:00:27.937
> 
> 标签：oauth-2.0, claims-based-identity

我创建了一个安全令牌服务，它连接到我的身份存储并返回一个带有声明的 OAuth2 令牌（如果有效）。我为此使用 Thinktecture.IdentityServer。现在我可以将令牌传递给我的 API，但是如何在我的 Web 服务中使用此令牌以确保它返回根据令牌中的适当声明过滤的数据？

我认为这里可能存在一些示例：[https](https://github.com/thinktecture/Thinktecture.IdentityModel.45/tree/master/Samples/Web%20API) ://github.com/thinktecture/Thinktecture.IdentityModel.45/tree/master/Samples/Web%20API但我不确定我是否理解这里发生的事情。有人可以编写一个 GET 来解析来自 jwt 令牌的身份声明并返回一组声明吗？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-07-12T16:04:42.100

I think the answer can be found [here](http://leastprivilege.com/2012/05/25/json-web-token-jwt-support-in-thinktecture-identitymodel/), but these [integration tests](https://github.com/thinktecture/Thinktecture.IdentityServer.v2/blob/master/src/Tests/Integration%20Tests/OAuth2Tests.cs) were much more helpful.

# android - 如何在 Android 中通过单击按钮来展开和隐藏滚动视图

> ID：11441409
> 
> 赞同：1
> 
> 时间：2012-07-11T21:01:17.990
> 
> 标签：android, button, hide, scrollview, expand

我正在尝试创建一个带有 4 个按钮的页面。

当我单击一个按钮时，该按钮应保持突出显示状态，其下方应出现一个带有文本的滚动视图，然后按下该按钮下方的按钮（必要时甚至关闭屏幕）。再次单击按钮后，滚动视图将再次隐藏。

如何让滚动视图在单击按钮时隐藏并重新出现？

这就是我想要的样子：http: [//img407.imageshack.us/img407/3448/47163794.png](http://img407.imageshack.us/img407/3448/47163794.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T22:09:50.053

这是我最近所做的`ExpandableListView`。这相当容易。

它拥有迄今为止我在 android 中见过的最大的构造函数之一。

* * *

使用`ExpandableListView`.

```
<LinearLayout>

    <ExpandableListView>
        <!-- Set the properties, if you need to see them, let me know. -->
    </ExpandableListView>

</LinearLayout> 
```

* * *

现在在某些视图中使用布局。

```
public void onCreate() {

    ExpandableListView example = findViewById(/* The id of the expandable list view */);

    example.setAdapter(
            new SimpleExpandableListAdapter(
                        /* the context */,
                        /* the map of parents/groups */,
                        /* the layout to map the parents/groups to */,
                        /* the key to search for in the parents/groups map */,
                        /* the id of the textview inside the layout to map the parent/group to */,
                        /* the map of children */,
                        /* the layout to map the children to */,
                        /* the key to search for in the children map */,
                        /* the id of the textview inside the layout to map the children to */)
            )
} 
```

* * *

还有其他可用的适配器，但这是最基本的适配器。

基本上只要看看[开发者网站](http://developer.android.com/reference/android/widget/ExpandableListView.html)。这个[例子](http://www.coderzheaven.com/2011/04/10/expandable-listview-in-android-using-simpleexpandablelistadapter-a-simple-example/)也有点帮助，但开发者的网站还有很长的路要走。

如果您有任何问题，请告诉我。

* * *

**跟进**

> *他把createGroupList（）。看起来这是他注释掉的功能。这究竟是在做什么？*

他基本上是在该函数中创建`List`of并返回创建的对象。`HashMaps`是的，您应该这样做，它有助于使您的代码更简洁。

> *此外，这些列表显示得很小，无论如何要使它们更大？*

修改`TextView`你有显示你的孩子和组。`View`在他们的`xml`布局中添加填充。只需调整`dp`. 你可以增加`textSize`或者你可以添加一个`style`像我在下面显示的。

```
<TextView 
        android:id="@+id/groupTextView"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        style="@android:style/TextAppearance.Medium"
        android:paddingLeft="50dp"
        android:paddingTop="25dp"
        android:paddingBottom="25dp"/> 
```

> *我希望父组成为列表，但不希望子组成为子列表，我希望它们成为我可以添加文本的文本框（我从网上获取）。我如何制作子文本框而不是列表。*

您可能需要为这种情况创建自己`Adapter`的。您将需要扩展`BaseExpandableListAdapter`. 我可能是错的，可能有更简单的方法......但我不知道。

* * *

**额外的跟进**

> 不明白你的意思。在子列表中输入的文本出现在这行代码中：child.put("Sub Item", "test")。我可以将我想要的文本放在“测试”的位置，但“测试”出现在每个父列表下。

您`createChildList`需要返回一个`List<ArrayList<HashMap<String, String>>>`.

你`createChildList`应该看起来像这样：

```
private List<ArrayList<HashMap<String, String>>> createChildList(int maxValue) {

                ArrayList<ArrayList<HashMap<String, String>>> groupList = 
                                new ArrayList<ArrayList<HashMap<String, String>>>();

                for (int i = 0; i <= maxValue; i++) {
                        ArrayList<HashMap<String, String>> childList = 
                                        new ArrayList<HashMap<String, String>>();

                        for (int j = 0; j <= maxValue; j++) {
                                HashMap<String, String> map = new HashMap<String, String>();

                                map.put("Sub Item", "test: " + String.valueOf(j));
                                childList.add(map);
                        }

                        groupList.add(childList);
                }

                return groupList;
        } 
```

让我知道这是否有效。

# php - codeigniter：为什么这个模型会发出与 codeigniter session 相关的严重警告问题？

> ID：11441411
> 
> 赞同：2
> 
> 时间：2012-07-11T21:01:22.827
> 
> 标签：php, codeigniter, session, warnings, models

这是模型：

```
 <?php

class Generalfeaturesmodel extends CI_Model      
{              
    protected $websitename;            

    public function __construct()                                   
    { 
        parent::__construct();
        $this->websitename = 'GameSwap';   
    } 

    // helper function that retrieves all the data from the specified table.  Basically since this is in the swap account model
    // only use it for swap account related tables, not membership related tables for instance.
    public function getdetails($tablename)
    {
        $query = $this->db->get($tablename);  
        $allrows = array();
        $i=0;
        foreach($query->result_array() as $row) 
        {
            $allrows[$i++]=$row;
        }
        return $allrows;       
    } 

    // returns all the games based on the query conditions.
    // @conditions - an associative array containing the conditions for the query.
    // returns an array with all the games based on the where clauses.
    public function gettargetswaps($where)  
    {      
        $query = $this->db->get_where('swaps',$where);
        $targetswaps = array(); 
        $i = 0; 
        foreach($query->result_array() as $s)  
        { 
            $query = $this->db->get_where('games',array('id'=>$s['gameid'])); 
            $details = $query->row_array();
            $gamedetails = array('name'=>$details['name'],'consoleid'=>$details['consoleid'],'genreid'=>$details['genreid'],'imgurl'=>$details['imgurl']);
            $targetswaps[$i] = array_merge($s,$gamedetails); 
            $i++;  
        } 
        return $targetswaps;
    }
}   
?> 
```

基本上这是我加载上述模型时遇到的错误：

```
A PHP Error was encountered
Severity: Warning
Message: Cannot modify header information - headers already sent by (output started at /home/phpgod/public_html/johnnyarias/ci_website/application/models/generalfeaturesmodel.php:50)
Filename: libraries/Session.php
Line Number: 672 
```

这是 Session.php 文件中抛出/或与错误有关的函数：

```
function _set_cookie($cookie_data = NULL)
{
    if (is_null($cookie_data))
    {
        $cookie_data = $this->userdata;
    }

    // Serialize the userdata for the cookie
    $cookie_data = $this->_serialize($cookie_data);

    if ($this->sess_encrypt_cookie == TRUE)
    {
        $cookie_data = $this->CI->encrypt->encode($cookie_data);
    }
    else
    {
        // if encryption is not used, we provide an md5 hash to prevent userside tampering
        $cookie_data = $cookie_data.md5($cookie_data.$this->encryption_key);
    }

    $expire = ($this->sess_expire_on_close === TRUE) ? 0 : $this->sess_expiration + time();

    // Set the cookie
    setcookie(
                $this->sess_cookie_name,
                $cookie_data,
                $expire,
                $this->cookie_path,
                $this->cookie_domain,
                $this->cookie_secure
            );
} 
```

Generalfeaturesmodel 中的第 50 行是文件的结尾（就在 '?>' php 标记之后）...我不知道这里可能出了什么问题？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T05:47:17.897

也似乎是您 <?php 前面的制表符空间，正如 Damien 所提到的，离开关闭 ?> 更安全，因此如果在文件末尾保存换行符，则没有输出

# python - 多线程 S3 下载不会终止

> ID：11441412
> 
> 赞同：1
> 
> 时间：2012-07-11T21:01:28.263
> 
> 标签：python, multithreading, amazon-s3, boto

我正在使用 python boto 和线程从 S3 快速下载许多文件。我在我的程序中多次使用它，效果很好。但是，有一次它不起作用。在该步骤中，我尝试在 32 核机器（Amazon EC2 cc2.8xlarge）上下载 3,000 个文件。

下面的代码实际上成功地下载了每个文件（除了有时会出现重试无法修复的 httplib.IncompleteRead 错误）。然而，32 个线程中只有 10 个左右实际终止，程序就挂起。不知道为什么会这样。所有文件都已下载，所有线程都应该退出。当我下载较少的文件时，他们会执行其他步骤。我已经被简化为使用单个线程下载所有这些文件（这可以工作但速度非常慢）。任何见解将不胜感激！

```
from boto.ec2.connection import EC2Connection
from boto.s3.connection import S3Connection
from boto.s3.key import Key

from boto.exception import BotoClientError
from socket import error as socket_error
from httplib import IncompleteRead

import multiprocessing
from time import sleep
import os

import Queue
import threading

def download_to_dir(keys, dir):
    """
    Given a list of S3 keys and a local directory filepath,
    downloads the files corresponding to the keys to the local directory.
    Returns a list of filenames.
    """
    filenames = [None for k in keys]

    class DownloadThread(threading.Thread):

        def __init__(self, queue, dir):
            # call to the parent constructor
            threading.Thread.__init__(self)
            # create a connection to S3
            connection = S3Connection(AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY)
            self.conn = connection
            self.dir = dir
            self.__queue = queue

        def run(self):
            while True:
                key_dict = self.__queue.get()
                print self, key_dict
                if key_dict is None:
                    print "DOWNLOAD THREAD FINISHED"
                    break
                elif key_dict == 'DONE': #last job for last worker
                    print "DOWNLOADING DONE"
                    break
                else: #still work to do!
                    index = key_dict.get('idx')
                    key = key_dict.get('key')
                    bucket_name = key.bucket.name
                    bucket = self.conn.get_bucket(bucket_name)
                    k = Key(bucket) #clone key to use new connection
                    k.key = key.key

                    filename = os.path.join(dir, k.key)
                    #make dirs if don't exist yet
                    try:
                        f_dirname = os.path.dirname(filename)
                        if not os.path.exists(f_dirname):
                            os.makedirs(f_dirname)
                    except OSError: #already written to
                        pass

                    #inspired by: http://code.google.com/p/s3funnel/source/browse/trunk/scripts/s3funnel?r=10
                    RETRIES = 5 #attempt at most 5 times
                    wait = 1
                    for i in xrange(RETRIES):
                        try:
                            k.get_contents_to_filename(filename)
                            break
                        except (IncompleteRead, socket_error, BotoClientError), e:
                            if i == RETRIES-1: #failed final attempt
                                raise Exception('FAILED TO DOWNLOAD %s, %s' % (k, e))
                                break
                            wait *= 2
                            sleep(wait)

                    #put filename in right spot!
                    filenames[index] = filename

    num_cores = multiprocessing.cpu_count()

    q = Queue.Queue(0)

    for i, k in enumerate(keys):
        q.put({'idx': i, 'key':k})
    for i in range(num_cores-1):
        q.put(None) # add end-of-queue markers
    q.put('DONE') #to signal absolute end of job

    #Spin up all the workers
    workers = [DownloadThread(q, dir) for i in range(num_cores)]
    for worker in workers:
        worker.start()

    #Block main thread until completion
    for worker in workers:
        worker.join() 

    return filenames 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T22:02:32.263

升级到 AWS 开发工具包版本 1.4.4.0 或更高版本，或仅使用 2 个线程。旧版本的[限制](https://forums.aws.amazon.com/thread.jspa?threadID=91229)为最多 2 个同时连接。这意味着如果您启动 2 个线程，您的代码将运行良好；如果您启动 3 个或更多，您一定会看到不完整的读取和用尽的超时。

您会看到虽然 2 个线程可以大大提高您的吞吐量，但超过 2 个线程并没有太大变化，因为您的网卡一直都很忙。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T23:03:36.927

S3Connection 使用 httplib.py 并且该库不是线程安全的，因此确保每个线程都有自己的连接至关重要。看起来你正在这样做。

Boto 已经拥有自己的重试机制，但您在其之上添加了一个重试机制来处理某些其他错误。我想知道是否建议在 except 块内创建一个新的 S3Connection 对象。看起来底层的 http 连接在那个时候可能处于不寻常的状态，最好从一个新的连接开始。

只是一个想法。

# ruby-on-rails - rails 不呈现 application.html.erb

> ID：11441415
> 
> 赞同：2
> 
> 时间：2012-07-11T21:01:39.683
> 
> 标签：ruby-on-rails, layout, rendering

我正在通过一个小项目学习rails，我正在使用rails 3.2.3。

我使用漂亮的生成器来创建我的模型和布局以及用于登录的间隙宝石。

现在，当我转到模型的索引页面时，只呈现索引页面，而不是布局中的 application.html.erb。我尝试添加

```
layout 'application' 
```

在应用程序控制器和我的模型控制器中。但仍然没有帮助。此外，当我单击删除时，它会将我带到显示页面。

我的 application.html.erb 看起来像这样

```
<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for?(:title) ? yield(:title) : "Untitled" %></title>
    <%= stylesheet_link_tag "application" %>
    <%= javascript_include_tag 'application' %>
    <%= javascript_include_tag 'rails' %>
    <%= csrf_meta_tag %>
    <%= yield(:head) %>
  </head>
  <body>
    <div id="container">
      <% flash.each do |name, msg| %>
        <%= content_tag :div, msg, :id => "flash_#{name}" %>
      <% end %>
      <%= content_tag :h1, yield(:title) if show_title? %>
      <%= yield %>
    </div>
  </body>
</html> 
```

我什至尝试将 javascript 包含标记更改为 :defaults 但仍然不起作用。

有人面临同样的情况吗？

# javascript - JQuery datepicker 来回填充文本字段页面（Chrome）

> ID：11441418
> 
> 赞同：0
> 
> 时间：2012-07-11T21:01:43.053
> 
> 标签：javascript, jquery, html, google-chrome

我对 JQuery 日期选择器以及浏览器中的前进和后退按钮有疑问。

我有两个文本字段，一个是“日期”字段，一个是常规文本输入字段。在页面加载时，我使用以下代码初始化日期选择器：

```
$(document).ready(function() {
      $('#date').datepicker()
      $('#date').datepicker("setDate",new Date())
}); 
```

该页面显示良好，并且日期选择器中有正确的日期。一切都按预期工作，但是如果我按下浏览器的后退按钮，然后按下前进按钮（将我带回到同一页面），那么空的文本字段现在会被日期选择器框中的内容填充。

作为参考，这里是相关的 html 片段

```
 <body>
    <p>
      Here I will have two text boxes, one datepicker and one regular
    </p>
    <input type="text" id="notdate"/>
    <input type="text" id="date"/>
  </body> 
```

目标：我需要日期框以文本形式显示已经存在的日期，并且我想摆脱页​​面向前/向后重新加载时的输入重复。

注意：如果您在按后退/前进之前更改其他文本框，一切都很好。希望有一种比在加载页面时触摸所有框更简单的方法来修复它。=]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:37:29.360

Julian 提供了一个正确的解决方法。赋予文本字段名称属性似乎可以解决问题。不知道为什么考虑到 div 是相同的，但它确实解决了这个问题。

# ios - 如何将两个 m4a 音频文件“混合/叠加”在一起

> ID：11441426
> 
> 赞同：1
> 
> 时间：2012-07-11T21:02:04.270
> 
> 标签：ios, audio, background-music

在终于成功地找到一种在 iPhone 上将多个语音文件连接成一个音频文件的方法之后，我现在正试图在语音文件的长度上叠加一个音频文件。

所以基本上我有两个`.m4a`文件：

1.  voice.m4a 例如大约 10 秒。
2.  music.m4a 大约 5 秒。

我需要的是以这样的方式组合两个文件，即生成的*单个*音频文件现在包含语音文件背景中的音乐，因此基本上生成的输出应该有 10 秒的语音和5秒的音乐重复了两次。拥有一个包含所有这些内容的文件是绝对重要的。

我试图在 iPhone 上的应用程序中完成所有这些工作。

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T10:19:21.770

如果您希望以编程方式执行此操作，则需要更深入地了解 CoreAudio。对于更简单的解决方案，您可以使用 AudioQueues 或更细粒度的控制 AudioUnits 和 AUGraph。MultiChannelMixer 是您正在寻找的音频单元。不幸的是，这里没有详细的教程（仅编写教程本身需要几天时间），但我希望我能指出正确的方向。

如果您决定走这条路并想做进一步的音频编程，那么这个简单的例子，那么我强烈建议您购买“Learning Core Audio, A Hands-on Guide to Audio Programming for Mac and iOS” - Chris Adamson，凯文·阿维拉。你可以在亚马逊、平装本或 Kindle 上找到它。

# javascript - 如何使vim自动打开.js作为编译的.coffee并保存回.js

> ID：11441428
> 
> 赞同：0
> 
> 时间：2012-07-11T21:02:08.647
> 
> 标签：javascript, vim, compiler-construction, coffeescript

我找到了如何在写入时将 js 编译为 coffe，但没有找到如何在读取时将 js 编译为 coffe。打动我这可能很棒。

这是可能的，还是有充分的理由说明这是一个坏主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T06:54:02.890

我不能说准确的语法是什么，但如果你在 vim 中启用了特定于文件类型的自动命令，你应该能够将 javascript -> coffee 编译器挂钩到“在缓冲区加载之前执行”。您应该在 vim 中找到相关信息，尝试“help autocmd”。在那里你应该找到一些关于“BufReadPre”和“FileReadPre”的东西，这应该是正确的。由于您已经完成了编写，因此您可能比我从头顶知道的将编译器连接到该 autocmd 的语法更好。

# c# - 从 Nunit 获取失败的测试列表

> ID：11441430
> 
> 赞同：2
> 
> 时间：2012-07-11T21:02:13.833
> 
> 标签：c#, unit-testing, nunit

我有一个包含 8000 多个测试的测试套件，并且很难看到哪些测试在代码更改之间中断（这些测试用例是从某些日志文件中自动提取的查询）。

有没有一种简单的方法来获取 NUnit 运行的失败测试列表？理想情况下，我想比较哪些测试在运行之间受到影响。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:11:50.527

您可以实现“NUnit.Core.Extensibility.IAddin”和“NUnit.Core.EventListener”。所以你可以操纵你的测试结果。NUnit（2.5 或更高版本）将自动加载实现“IAddin”方法的类。

像那样：

```
using System;
using System.Text;
using NUnit.Core.Extensibility;
using NUnit.Core;

namespace YourNUnitAddIns
{
    /// <summary>
    /// Coleta informacoes da execucao do NUnit.
    /// </summary>
    [NUnitAddin(
        Name="CollectNUnitFailAddIn",
        Description="do something",
        Type=ExtensionType.Core)]
    public class CollectNUnitFailAddIn : IAddin, EventListener
    {
        #region IAddin Members

        public bool Install(IExtensionHost host)
        {    
            IExtensionPoint suiteBuilders = host.GetExtensionPoint("SuiteBuilders");
            IExtensionPoint testBuilders = host.GetExtensionPoint("TestCaseBuilders");
            IExtensionPoint events = host.GetExtensionPoint("EventListeners");

            if (events == null)
                return false;

            events.Install(this);

            return true;
        }

        #endregion

        #region EventListener Members

        public void RunFinished(Exception exception)
        {
            //do something here.
        }

        public void RunFinished(TestResult result)
        {
            //do something here.
        }

        public void RunStarted(string name, int testCount)
        {
            //do something here.
        }

        public void SuiteFinished(TestResult result)
        {
            //do something here.
        }

        public void SuiteStarted(TestName testName)
        {
            //do something here.
        }

        public void TestFinished(TestResult result)
        {
            //do something here.
        }

        public void TestOutput(TestOutput testOutput)
        {
            //do something here.
        }

        public void TestStarted(TestName testName)
        {
            //do something here.
        }

        public void UnhandledException(Exception exception)
        {
            //do something here.
        }

        #endregion
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T19:41:37.077

您应该能够从 NUnit 的 Xml 输出的简单 xslt 转换中获得结果。

CruiseControl 等持续集成工具已经为此构建了 XSLT 翻译。

[https://github.com/ccnet/CruiseControl.NET/blob/master/project/xsl/AlternativeNUnitDetails.xsl](https://github.com/ccnet/CruiseControl.NET/blob/master/project/xsl/AlternativeNUnitDetails.xsl)

# oracle - Oracle 11g2 是否支持 sem_match 函数的游标？

> ID：11441431
> 
> 赞同：1
> 
> 时间：2012-07-11T21:02:14.403
> 
> 标签：oracle, semantics, owl

我试图通过在我在 Oracle 中创建的语义模型上运行与语义相关的 sql 来探索 Oracle 数据库的语义特性。但我不能让它工作，关于这方面的信息很少。

该过程的功能很简单，从 sparql 查询中获取结果集。

```
CREATE OR REPLACE PROCEDURE PROC_MERGE_PATHWAY_SEM AS 
TYPE c_type IS REF CURSOR;
semCursor c_type;
p1 VARCHAR2(40);
p2 VARCHAR2(40);
interCount INTEGER;

BEGIN
OPEN semCursor FOR
 'SELECT p1, p2, COUNT(g) as interCount
  FROM TABLE (sem_match (
                  "{?p1 <http://example.com/test.owl#relates_to> ?g .  ?p2              <http://example.com/test.owl#relates_to> ?g }",
                      sem_models("pathway"),
                      null,
                      null,
                      null))';

LOOP
FETCH semCursor INTO p1, p2, interCount;
EXIT WHEN semCursor%NOTFOUND;
DBMS_OUTPUT.PUT_LINE(p1||','||p2||','||interCount);
END LOOP; 

/*
FOR records IN semCursor LOOP
 DBMS_OUTPUT.PUT_LINE('test'); 
END LOOP; */
END PROC_MERGE_PATHWAY_SEM; 
```

编译错误如下：

ORA-00972: 标识符太长

ORA-06512：在“SYSTEM.PROC_MERGE_PATHWAY_SEM”，第 9 行

ORA-06512: 在第 2 行

我不确定它是由游标语句包装的 sem_match 语法错误引起的，还是 Oracle 11g2 中的错误引起的？有人可以帮我解决这个问题吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T22:39:16.443

您似乎`"`在通话中使用了双引号 ( ) `sem_match`，我认为您应该使用两个单引号 ( `''`)；您需要它，因为它已经在`open ... for`.

（我可能应该注意到我从未使用过语义，但[文档](http://docs.oracle.com/cd/B28359_01/appdev.111/b28397/sdo_rdf_concepts.htm#CHDJACII)表示单引号）。

双引号导致其中的整个字符串被视为文字标识符，因此出现错误消息。

但是正如 Mat 评论的那样，您不需要 . 周围的单引号`select`，因此您不需要转义`sem_match`.

**更新了以下评论**：假设您确实需要将整个`select`包裹在单引号中，正如您链接到的文章所建议的那样，已经在命令中的单引号需要转义，这在 Oracle 中是通过一起使用两个单引号来完成的 ( `''`); 在看起来很像双引号（`"`）的文章中，所以我可以理解您的困惑。根据您放入粘贴箱的代码：

```
create or replace
PROCEDURE PROC_MERGE_PATHWAY_SEM AS 
TYPE c_type IS REF CURSOR;
semCursor c_type;
p1 VARCHAR2(40);
p2 VARCHAR2(40);
interCount INTEGER;

BEGIN
  OPEN semCursor FOR
     'SELECT p1, p2, COUNT(g) as interCount
      FROM TABLE (sem_match (
                      ''{?p1 <http://example.com/test.owl#relates_to> ?g .  ?p2 <http://example.com/test.owl#relates_to> ?g }'',
                          sem_models(''pathway''),
                          null,
                          null,
                          null))';

   LOOP
   FETCH semCursor INTO p1, p2, interCount;
   EXIT WHEN semCursor%NOTFOUND;
    DBMS_OUTPUT.PUT_LINE(p1||','||p2||','||interCount); 
   END LOOP; 

 /*
  FOR records IN semCursor LOOP
    DBMS_OUTPUT.PUT_LINE('test'); 
  END LOOP; */
END PROC_MERGE_PATHWAY_SEM; 
```

`"`您在原始问题中的查询中的每一个都被**两个**单引号替换，因此`sem_models("pathway")`变为`sem_models(''pathway'')`.

# wcf - 将 XML 文本从我的客户端传递到 RIA 服务时遇到问题

> ID：11441435
> 
> 赞同：0
> 
> 时间：2012-07-11T21:02:35.500
> 
> 标签：wcf, wcf-ria-services

我试图在查询操作中将以下 XML 文本传递给 RIA 服务，该操作返回可查询的实体序列作为响应：

```
<?xml version="1.0" encoding="utf-8"?>
<project>
    <item type="Item" filetype="cabinet" category="EZ Workshop" name="EZW Panel Edge-Banded" height="24.000000" width="36.000000" depth="0.725000" quantity="1">
    </item>
    <item type="Item" filetype="cabinet" category="EZ Furniture" name="Entry Bench" height="19.000000" width="48.000000" depth="17.999999" quantity="1">
    </item>
    <item type="Item" filetype="cabinet" category="EZ Closet Euro Style" name="CSEKD Tall H3R 28-72W 12-24D" height="84.000000" width="54.000000" depth="19.999999" quantity="1">
    </item>
    <item type="Item" filetype="assembly" category="EZ Pro ManCave" name="EZ Corn Hole Game-Set" height="0" width="0" depth="0" quantity="1">
    </item>
    <item type="Item" filetype="assembly" category="EZ Office" name="EZ 30 Printer Stand" height="0" width="0" depth="0" quantity="1">
    </item>
    <item type="Item" filetype="assembly" category="Corporate Culture Pro" name="C-Table" height="0" width="0" depth="0" quantity="1">
    </item>
</project> 
```

这是查询操作：

```
[Query]
public IQueryable<ProjectItem> GetItemsFromImport(String a_strImportXml)
{
    // Return empty sequence for now as a test.
    return new ProjectItem[0].AsQueryable();
} 
```

当我传递完整的 XML 时，我得到了那个烦人的“未找到”异常，并且我的操作中的断点永远不会被击中。我正在使用 Visual Studio 2010 的 ASP.NET 开发服务器。当我得到“未找到”时，它预示着不好的事情。踢球者是，当我传递一个空字符串时，我根本没有任何异常，并且断点被击中。

正如您所见，它不是一个非常长的 XML 文档。发送的数据量是否有限制？我必须转义文档吗？

谢谢。

**编辑：**

我发现在发送文档之前，我只需要将结构字符（'<'、'>' 和 '&'）从文档中转义。我是`String.Replace`用来做的。有谁知道是否有更好的方法来实现这一点。可能类似于`Uri.EscapeDataString`？

```
var strImportXml = a_xImport.ToString();
strImportXml = strImportXml.Replace("&", "&amp;");
strImportXml = strImportXml.Replace("<", "&lt;");
strImportXml = strImportXml.Replace(">", "&gt;"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T20:42:34.107

好的，所以我想这就是我自己问题的答案。我发现在发送文档之前，我只需要将结构字符（'<'、'>' 和 '&'）从文档中转义。我正在使用 String.Replace 来做到这一点。有谁知道是否有更好的方法来实现这一点。也许类似于 Uri.EscapeDataString 的东西？

```
var strImportXml = a_xImport.ToString();
strImportXml = strImportXml.Replace("&", "&amp;");
strImportXml = strImportXml.Replace("<", "&lt;");
strImportXml = strImportXml.Replace(">", "&gt;"); 
```

**注意：**我仍然想知道是否有更好的方法来做到这一点。

# php - 抽象类和static关键字的使用

> ID：11441438
> 
> 赞同：1
> 
> 时间：2012-07-11T21:02:55.807
> 
> 标签：php, oop

对不起，如果标题看起来很奇怪，我不知道如何称呼它。我正在检查一个框架，我想知道它是如何工作的？

```
<?php
//namespace and use

abstract class Model {
    //...
    public function __call($method,$params){
        //some stuff
        return static::$$method;
    }
} 
```

它是一个抽象类，那么 static 指的是什么类呢？（考虑到它没有扩展任何东西）我尝试了`var_dump`方法，但该方法不在该类中。为什么它有一个双美元符号。

**编辑：**哦，它会调用该`__callStatic`方法。我需要药片。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:07:46.340

它被称为“后期静态绑定”，与`self`始终引用定义它的上下文（“类”）不同，它始终引用调用它的上下文。

# ruby-on-rails - Ruby VCR gem 不断记录相同的请求

> ID：11441439
> 
> 赞同：12
> 
> 时间：2012-07-11T21:03:01.400
> 
> 标签：ruby-on-rails, ruby, rspec, cucumber, vcr

在我的黄瓜支持目录中，我在 vcr.rb 中有以下内容：

```
require 'vcr'

VCR.configure do |c|
  c.cassette_library_dir = 'fixtures/vcr_cassettes'
  c.hook_into :webmock
  c.ignore_localhost = true
  c.default_cassette_options = { record: :new_episodes }
end 
```

我正在对调用 Google Maps API 的城市名称进行地理编码。我正在尝试记录和存根这些请求，但它一直将相同的请求记录到同一个 yml 文件中：

```
- request:
    method: get
    uri: http://maps.googleapis.com/maps/api/geocode/json?address=Miami,%20FL&language=en&sensor=false
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - ! '*/*'
      User-Agent:
      - Ruby
  # response...

- request:
    method: get
    uri: http://maps.googleapis.com/maps/api/geocode/json?address=Miami,%20FL&language=en&sensor=false
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept-Encoding:
      - gzip;q=1.0,deflate;q=0.6,identity;q=0.3
      Accept:
      - ! '*/*'
      User-Agent:
      - Ruby 
```

这是相同的 URL 和相同的请求，VCR 不应该存根请求吗？每次我尝试搜索同一个城市时，如何防止我的规范访问 API？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-12T01:40:13.147

很难确定您发布的内容发生了什么，但我可以更多地解释 VCR 的工作原理，并对这种行为的可能原因进行一些猜测。

VCR 使用[请求匹配器](https://www.relishapp.com/myronmarston/vcr/v/2-2-3/docs/request-matching)来尝试查找先前记录的 HTTP 交互以进行回放。在单个磁带会话期间，当一个 HTTP 交互被播放时，它被认为是“使用的”并且不会再次播放（除非您使用[allow_playback_repeats](https://www.relishapp.com/myronmarston/vcr/v/2-2-3/docs/request-matching/playback-repeats)选项）。

所以......这里有几种可能性：

*   也许 VCR 无法匹配您的 HTTP 请求。您使用的是什么请求匹配器？有一些简单的方法可以解决这个问题（见下文）。
*   如果您不使用`:allow_playback_repeats`（这是默认设置，我建议您如何使用 VCR），那么如果在您的测试中提出了多个重复请求，那么您看到的行为可能会发生 - 例如，磁带可能只有一个匹配请求，但您正在测试其中 2 个 - 这将播放一个并记录一个（因为您正在使用`:new_episodes`）。

为了解决这个问题，我建议您使用[debug_logger](https://www.relishapp.com/myronmarston/vcr/v/2-2-3/docs/configuration/debug-logging)选项让 VCR 打印它正在做什么以及它如何尝试匹配每个请求。这应该让您深入了解正在发生的事情。您还可以覆盖任何[内置的请求匹配器](https://github.com/myronmarston/vcr/blob/v2.2.3/lib/vcr/request_matcher_registry.rb#L109-116)并提供您自己的逻辑和/或在匹配器中设置断点：

```
VCR.configure do |c|
  c.register_request_matcher :uri do |request_1, request_2|
    debugger # so you can inspect the requests here
    request_1.uri == request_2.uri
  end
end 
```

您可能还遇到了 VCR 错误，尽管比较 URI（使用`String#==`）是一个非常基本的操作，以至于我很难想象那里有错误。如果您无法弄清楚，请随意打开一个 github 问题（希望使用调试记录器输出和/或触发此问题的代码示例）。

附带说明一下，我建议您使用`:once`记录模式（默认）而不是`:new_episodes`. `:once`永远不会将额外的 HTTP 交互记录到现有的磁带上——它只允许录制一次磁带。如果请求无法匹配，它会引发错误，提醒您它无法匹配的事实。 `:new_episodes`另一方面，它将记录任何找不到匹配项的请求，这就是您所看到的行为。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-02-14T19:18:24.167

当我遇到类似问题时，我通过使[match_requests_on](https://www.relishapp.com/vcr/vcr/v/1-6-0/docs/cassettes/request-matching#match-on-request-body)设置更具体来解决它：

```
VCR.configure do |c|
    c.default_cassette_options = {
        match_requests_on: [:uri, :body, :method]
    }
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-11T21:28:28.007

我经历过类似的行为，所以我所做的基本上是保持设置为`:none`. 如果出现任何新请求，我使用`:any`，运行执行请求的测试套件部分并将其设置回`:none`.

似乎`:new_episodes`使用一些奇怪的启发式方法来确定什么是新请求以及已经发生了什么请求。在我们的例子中，它将对支付网关的两个不同的请求标记为相同的请求，导致无休止的调试时间——因为我们得到了一个类似的`RefundOk`答案`CaptureRequest`。最好不要用`:new_episodes`...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-03T11:03:51.920

如果您未定义匹配参数，则将 Elasticsearch 与 VCR 一起使用将始终重新生成磁带。我必须将匹配定义为仅`:method`因为`:uri`and`:body`可以在每次测试运行时更改。

```
VCR.configure do |c|
  c.hook_into :webmock
  c.ignore_localhost = true
  c.configure_rspec_metadata!
  c.cassette_library_dir = 'spec/cassettes'
  c.default_cassette_options = { record: :new_episodes,
                                 match_requests_on: [:method] }
end 
```

# iphone - iPad/iPhone 应用程序中网格中的下拉列表

> ID：11441440
> 
> 赞同：0
> 
> 时间：2012-07-11T21:03:05.113
> 
> 标签：iphone, ios, ipad, uitableview

我想在 tableView 中列出产品，一旦我有了这些产品，我想在该网格中有一个包含整数值的下拉列表。这看起来有点像下面。如何在该网格中有一个下拉列表，如控件，允许用户从 0-9 中选择一个整数值？

```
Description    Integer Value     Bool
Product 1      1                 Yes
Product 2      8                 No 
```

我不知道控件的名称或如何实现它，任何方向都非常感谢。

# mysql - MySQL删除除了一个

> ID：11441447
> 
> 赞同：3
> 
> 时间：2012-07-11T21:03:46.430
> 
> 标签：mysql, sql

我有以下数据库结构：

```
id   idproperty    idgbs
 1    1             136
 2    1             128       
 3    1             10
 4    1             1
 5    2             136
 6    2             128
 7    2             10
 8    2             1
 9    3             561
10    3             560
11    3             10
12    3             1
13    4             561
14    4             560
15    4             10
16    4             1
17    5             234
18    5             120
19    5             1
20    6             234
21    6             120
22    6             1 
```

以下是详细信息：

该表涉及`idproperty`不同的地理位置。例如：

```
idgbs

  1 refers to United States
 10 refers to Alabama with parentid 1 (United States)
128 refers to Alabama Gulf Coast with parentid 10 (Alabama)
136 Dauphin Island with parentid 128 (Alabama Gulf Coast) 
```

所以，结构是：

```
United States > Alabama > Alabama Gulf Coast > Dauphin Island 
```

我想删除 idproperty 的所有条目，除了第一个带有 idgbs 136、128、10、1 集的条目，即在所有 GBS 中保留至少 1 个属性并删除其他条目。

此外，有时是4级地理条目，有时是3级。

请共享逻辑和 SQL 查询以删除每个唯一 GBS 中除一个之外的所有条目。

GBS 1, 10, 128, 136 是唯一的，因此数据库应该只包含这些 GBS 的 1 个属性 ID。

查询后，表如下所示：

```
id   idproperty    idgbs
 1    1             136
 2    1             128       
 3    1             10
 4    1             1
 9    3             561
10    3             560
11    3             10
12    3             1
17    5             234
18    5             120
19    5             1 
```

改写问题：

我想在每个根级别 GBS 中保留属性，即多芬岛应该只有一个属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T22:48:42.107

呼……我想我明白你现在想要什么了。我不能放过这个;-)

我必须意识到，在问题中，您希望删除属性 2，因为它与属性 1 共享一个层次结构。一旦我意识到这一点，我就有了以下想法。基本上，我们加入了 self 的聚合版本两次：第一次告诉我们我们的“gbs 层次结构路径”是什么，第二次**匹配任何具有*相同*层次结构的*先前*属性***。发现没有共享其层次结构的“先前”属性的行将被保留，其余具有该层次结构的行将被删除。这可能会进一步调整，但我现在想分享这个。我已经用您显示的数据对其进行了测试，并且得到了您发布的结果。*

 *```
DELETE 
  each_row.*
FROM property_gbs AS each_row

JOIN ( SELECT 
         idproperty, 
         GROUP_CONCAT(idgbs ORDER BY idgbs DESC SEPARATOR "/") AS idgbs_path 
       FROM property_gbs 
       GROUP BY idproperty
     ) AS mypath 
     USING(idproperty)

LEFT JOIN ( SELECT 
              idproperty, 
              GROUP_CONCAT(idgbs ORDER BY idgbs DESC SEPARATOR "/") AS idgbs_path 
            FROM property_gbs  
            GROUP BY idproperty
          ) AS previous_property 
      ON mypath.idgbs_path = previous_property.idgbs_path 
  AND previous_property.idproperty < each_row.idproperty

WHERE previous_property.idproperty 
```

请注意，最后一行不是拼写错误，我们只是检查是否存在具有相同路径的先前属性。如果有，则删除当前评估的行。

干杯!

# 澄清说明

这里的想法是将每一行与其层次结构相关联，即使它是代表层次结构中间某处的行（例如问题中的行：{2,1,128}）。通过第一次加入聚合，每一行现在“知道”它的路径是什么（因此该行将获得“136/128/10/1”）。然后，我们可以在第二个连接中使用该值来查找具有相同路径的其他属性，但前提是它们的属性 ID 较低。这使我们能够检查是否存在具有相同“路径”的低 ID 属性，并删除表示*具有*此类“低阶路径兄弟”的属性的任何行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T21:41:44.647

I'm really not sure. But try this.

```
DELETE a1 FROM table a1, table a2 
WHERE a1.id > a2.id 
AND a1.idgbs = a2.idgbs 
AND a1.idgbs <> 1 
```

if you want to keep the row with the lowest id.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-11T22:49:08.940

这个很困难@dang，但我很享受这个挑战。

```
;With [CTE] as (Select id ,idproperty ,idgbs ,Row_Number() Over(Partition By idgbs order by idproperty Asc) as RN From [TableGBS])
,[CTE2] as (Select * From [CTE] Where RN > 1)
,[CTE3] as (Select idproperty ,count(*) as [Count] From [CTE2] Group by idproperty)
Delete from [TableGBS] Where id in (Select a.id From [CTE] as a Left Join [CTE3] as b on a.idproperty = b.idproperty Where RN > 1 And [Count] > 2); 
```

由于我认为您不能在 sqlfiddle 中执行删除语句，因此它将删除在 select 语句中显示的行：[http ://sqlfiddle.com/#!3/08108/40](http://sqlfiddle.com/#!3/08108/40)

**编辑：**我使用链接到 Microsoft SQL Server Management Studio 的 MySQL，所以这可能不适合你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T21:16:45.500

这种技术将表与自身的聚合版本连接起来，基本上将表中的每一行与哪个 idproperty 的 idgbs 最低的知识相匹配，如果它不共享该 idproperty（即具有最低的行），则删除该行idproperty 与自身连接时不会被删除，但具有该 idgbs 的其余行将被删除）。

```
DELETE 
  each_row.*
FROM table AS each_row
  JOIN (select MIN(idproperty), idgbs FROM table GROUP BY idgbs) as lowest_id
  USING(idgbs)
WHERE each_row.idproperty != lowest_id.idproperty; 
```*

# java - Java：主机名的 AxisFault Server.userException

> ID：11441453
> 
> 赞同：0
> 
> 时间：2012-07-11T21:04:39.790
> 
> 标签：java, axis

我正在本地部署我的应用程序，这就是我在日志中看到的

```
java.lang.IllegalArgumentException: display description cannot be null
AxisFault
 faultCode: {http://schemas.xmlsoap.org/soap/envelope/}Server.userException
 faultSubcode: 
 faultString: java.lang.IllegalArgumentException: display description cannot be null
 faultActor: 
 faultNode: 
 faultDetail: 
    {http://xml.apache.org/axis/}hostname:air.local

java.lang.IllegalArgumentException: display description cannot be null
    at org.apache.axis.message.SOAPFaultBuilder.createFault(SOAPFaultBuilder.java:222)
    at org.apache.axis.message.SOAPFaultBuilder.endElement(SOAPFaultBuilder.java:129)
    at org.apache.axis.encoding.DeserializationContext.endElement(DeserializationContext.java:1087)
    at org.apache.xerces.parsers.AbstractSAXParser.endElement(Unknown Source)
    at org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown Source)
    at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)
    at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
    at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)
    at org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)
    at org.apache.xerces.jaxp.SAXParserImpl.parse(Unknown Source)
    at org.apache.axis.encoding.DeserializationContext.parse(DeserializationContext.java:227)
    at org.apache.axis.SOAPPart.getAsSOAPEnvelope(SOAPPart.java:696)
    at org.apache.axis.Message.getSOAPEnvelope(Message.java:435)
    at org.apache.axis.handlers.soap.MustUnderstandChecker.invoke(MustUnderstandChecker.java:62)
    at org.apache.axis.client.AxisClient.invoke(AxisClient.java:206)
    at org.apache.axis.client.Call.invokeEngine(Call.java:2784)
    at org.apache.axis.client.Call.invoke(Call.java:2767)
    at org.apache.axis.client.Call.invoke(Call.java:2443)
    at org.apache.axis.client.Call.invoke(Call.java:2366) 
```

这是什么意思？

我该如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:11:52.880

这是后端的错误，请参阅`faultString`

```
faultString: java.lang.IllegalArgumentException: display description cannot be null 
```

一旦我处理好了，一切都很好

# image - Coldfusion8中是否有用于创建图像的lazyloader功能？

> ID：11441458
> 
> 赞同：1
> 
> 时间：2012-07-11T21:05:08.247
> 
> 标签：image, coldfusion, lazy-loading

我有一个显示缩略图的产品搜索，还提供当前结果集的缩放视图（1-24 个结果）。

在 Coldfusion 中，我目前正在这样做以创建 lo-res 和 hi-res 图像：

```
<cfimage name="myImage" source="#bildpfad##bilddateiname#" action="read" />
    <cfif IsImage(myImage) is true>
    <cfscript>
        variables.breakdown = "";
        variables.lastcount = 0;
    </cfscript> 
    <!--- low res --->
    <cfscript>
        ImageSetAntialiasing(myImage,"on");
        variables.breite = ImageGetWidth(myImage);
        variables.breite = 240;
        ImageScaleToFit(myImage, variables.breite,"");
    </cfscript>
    <cfxml variable="imageXml">
        <cfimage action="writetobrowser" source="#myImage#" />
    </cfxml>
    <cfset variables.imageSrc = imageXml.xmlRoot.xmlAttributes.src>
    <!--- hi res --->
    <cfscript>
        variables.breite = 900;
        ImageScaleToFit(myImage, variables.breite,"");
    </cfscript>
    <cfxml variable="imageXmlXL">
        <cfimage action="writetobrowser" source="#myImage#"/>
    </cfxml>
    <cfset variables.imageSrcXL = imageXmlXL.xmlRoot.xmlAttributes.src>
    <cfoutput><div class="resultsImgWrap">
        <a href="#variables.imageSrcXL#">#imageXml#</a></div>
    </cfoutput> 
```

虽然这在同时创建缩略图和缩放图像方面效果很好，但需要一段时间来处理......

所以我想知道 Coldfusion 中是否有类似延迟加载器的功能，它会立即显示缩略图并在“背景”中创建缩放图像。

**问题：**
知道这样的事情是否可能吗？或者如果有更好的方法，我也不介意。

感谢指点！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:20:45.710

您可以调整一次大小（例如在上传/添加图像之后）并始终使用该缩略图。这将是我的选择。

至于延迟加载...您将需要某种 JavaScript 插件来进行 ajax 图像加载。每个 img src 都可以是`getThumnail.cfm?id=x&w=200&h=200`. 您还可以在 CF 端缓存调整大小的缩略图。

# eclipse - 在 Eclipse 中调试 Solr 代码

> ID：11441468
> 
> 赞同：1
> 
> 时间：2012-07-11T21:05:35.163
> 
> 标签：eclipse, solr

Eclipse 和 Solr 的新手，我将 apache-solr-3.6.0.war 导入 Eclipse 并使用 tomcat 插件运行 Solr。现在我想调试一些现有的代码，但是如何导入 Solr 源代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:23:58.260

在不知道您如何准确导入它的情况下：听起来您正在寻找[Source attachment](https://stackoverflow.com/questions/122160/is-there-an-easy-way-to-attach-source-in-eclipse)。

如果直接使用[Solr 源代码](http://apache.mirror.clusters.cc/lucene/solr/3.6.0/)可能会更好。检查发布中包含的 README 文件，有一个 ant 任务来初始化 eclipse：

> 要设置你的 ide 运行 [...] 'ant eclipse'。

然后使用[ivy](http://ant.apache.org/ivy/)加载所有依赖项，您可以从 IDE 中运行它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-15T23:17:48.910

您还可以查看整个 Lucene/Solr 源代码：

1.  安装 Subclipse 插件
2.  选择`New...`>`Project...`
3.  `SVN`>`Checkout projects from SVN...`
4.  [将此链接](http://svn.apache.org/repos/asf/lucene/dev)添加 为新存储库
5.  选择分支`/branches/lucene_solr_3_6`（如果你想要最后一个稳定版本。如果你想使用尖端源，请使用主干）
6.  选择`Check out as a project in a workspace`并保留其他所有默认值

然后，结帐完成后，要完成设置，您不必手动摆弄 JAR，只需：

1.  右键单击 main `build.xml`，即项目根目录中的那个
2.  选择`Run As...`>`Ant build...`选择（按此顺序）
3.  `ivy-bootstrap`和`resolve`任务（将下载所有 JAR 依赖项）
4.  然后按以下顺序运行：（`validate, clean-idea, eclipse, compile, get-maven-poms, generate-maven-artifacts`仅当您打算使用 Maven 时，最后两个）。

就是这样，您现在应该在您的工作区中看不到红色，并且构建了 Lucene 和 Solr JAR。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-04T02:31:47.447

像这样运行 solr：

```
java -jar -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=1044 start.jar 
```

Solr 将启动，但等待您从 Eclipse 连接以继续。

然后在 Eclipse 中，转到：

1.  运行/调试配置...
2.  选择远程 Java 应用程序
3.  按新建按钮创建一个新的远程配置
4.  将 1044 放在端口上
5.  点击调试

这是在 Java 中调试远程应用程序的标准方法

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-07-16T09:17:51.720

```
./solr start -p 8983 -f -a "-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=0.0.0.0:8000" 
```

开始 solr

1.  提供在 8983 端口上运行的应用程序
2.  提供 Xrunjdwp:transport=dt_socket
3.  远程ip地址0.0.0.0:8000 然后去eclipse [![eclipse中的solr调试模式配置](../Images/8f384d71d09f253e33d0b63af4bb21fe.png)](https://i.stack.imgur.com/vyGni.png)

# bugzilla - 群组编辑权限

> ID：11441469
> 
> 赞同：0
> 
> 时间：2012-07-11T21:05:41.110
> 
> 标签：bugzilla

我是管理 Bugzilla 的新手，可以设置权限，以便组中的每个成员都可以编辑分配给同一组成员的错误？

例如，如果我是 的成员`groupA`并且有另一个成员分配的错误`GroupA`，该成员可以接受这个错误并编辑一些值吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-05T03:52:32.513

是的，如果您启用了编辑错误权限，那么您可以编辑分配给同一组成员的错误。

如果您没有设置编辑错误权限，请通过以下方式设置：

*   点击员工链接
*   输入您的用户名并搜索
*   单击您的用户名并在编辑错误上打勾

如果您是管理员，请单击第一组复选框以获得管理员权限。否则使用第二组复选框

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T19:33:47.617

如果您分配给 bug 的用户是您组的成员并且拥有 editbugs 权限，他将能够更改所有 bug 字段。

我认为你可以拒绝他的 editbugs 权限，但是如果他不能更新他的进度并写评论，那么将他分配给这个 bug 有什么意义......

# javascript - 在幻灯片末尾停止 Twitter Bootstrap Carousel

> ID：11441474
> 
> 赞同：16
> 
> 时间：2012-07-11T21:05:49.603
> 
> 标签：javascript, jquery, twitter-bootstrap, carousel

Bootstrap 轮播是一种奇怪的野兽。我尝试调整 $next 以防止无限循环，但最终要么打破它，要么阻止幻灯片在到达终点时向后退。

我希望轮播只在列表中滑动而不是无限循环。

任何帮助，将不胜感激。

```
$next = $next.length ? $next : this.$element.find('.item')[fallback]()
if ($next.hasClass('active')) return
if ($.support.transition && this.$element.hasClass('slide')) {
    this.$element.trigger(e)
    if (e.isDefaultPrevented()) return
    $next.addClass(type)
    $next[0].offsetWidth // force reflow
    $active.addClass(direction)
    $next.addClass(direction)
    this.$element.one($.support.transition.end, function() {
        $next.removeClass([type, direction].join(' ')).addClass('active')
        $active.removeClass(['active', direction].join(' '))
        that.sliding = false
        setTimeout(function() {
            that.$element.trigger('slid')
        }, 0)
    })
} else {
    this.$element.trigger(e)
    if (e.isDefaultPrevented()) return
    $active.removeClass('active')
    $next.addClass('active')
    this.sliding = false
    this.$element.trigger('slid')
} 
```

更新：这与“自动播放”无关，我特指手动按下左右按钮。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-10-03T11:13:35.010

对于轮播不无限循环（使用 Bootstrap 3.0.0），并在最后一张幻灯片停止，除非单击“下一个”箭头，以下是最好的方法：

```
$('.carousel').carousel({
  interval: 5000,
  wrap: false
}); 
```

将`wrap`选项设置为`false`告诉轮播自动停止在幻灯片中循环。我希望这能正确回答你的问题。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-11T21:56:24.797

您可以在页面中添加一些代码以在`slid`事件发生后隐藏适当的轮播控件：

```
$('#myCarousel').on('slid', '', function() {
  var $this = $(this);

  $this.children('.carousel-control').show();

  if($('.carousel-inner .item:first').hasClass('active')) {
    $this.children('.left.carousel-control').hide();
  } else if($('.carousel-inner .item:last').hasClass('active')) {
    $this.children('.right.carousel-control').hide();
  }

}); 
```

此示例假定[Twitter Bootstrap 示例轮播上使用的标记。](http://twitter.github.com/bootstrap/javascript.html#carouselhttp://twitter.github.com/bootstrap/javascript.html#carousel)

确保在打开页面时隐藏左侧。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-03-14T19:26:36.243

`data-wrap="false"`在 div 中添加属性

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-05-08T23:52:57.280

最简单的方法如下：

```
//intro slider
$('#carousel_fade_intro').carousel({
    interval: 2500,
    pause: "false"
})

//Stop intro slider on last item
var cnt = $('#carousel_fade_intro .item').length;
$('#carousel_fade_intro').on('slid', '', function() {
    cnt--;
    if (cnt == 1) {
        $('#carousel_fade_intro').carousel('pause');
    }
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-03-13T10:30:25.910

对于在同一页面上为**多个轮播**寻找**Bootstrap 3解决方案的人，请尝试以下操作：**

 **```
$(function() {
    // init carousel
    $('.carousel').carousel({
        pause: true,        // init without autoplay (optional)
        interval: false,    // do not autoplay after sliding (optional)
        wrap:false          // do not loop
    });
    // init carousels with hidden left control:
    $('.carousel').children('.left.carousel-control').hide();
});

// execute function after sliding:
$('.carousel').on('slid.bs.carousel', function () {
    // This variable contains all kinds of data and methods related to the carousel
    var carouselData = $(this).data('bs.carousel');
    // get current index of active element
    var currentIndex = carouselData.getItemIndex(carouselData.$element.find('.item.active'));

    // hide carousel controls at begin and end of slides
    $(this).children('.carousel-control').show();
    if(currentIndex == 0){
        $(this).children('.left.carousel-control').fadeOut();
    }else if(currentIndex+1 == carouselData.$items.length){
        $(this).children('.right.carousel-control').fadeOut();
    }
}); 
```

如果这不适用于您的情况，请现在告诉我。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-10-26T10:51:26.203

如果您使用的是引导程序 3，请使用此

```
$('.carousel').carousel({
  wrap: false
}); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-01-30T14:25:13.427

不确定这是否仅与最新版本的 Bootstrap 有关，但在最外面的轮播容器上设置 data-wrap="false" 将阻止它继续通过最后一张幻灯片。

来源： http: [//getbootstrap.com/javascript/#carousel-options](http://getbootstrap.com/javascript/#carousel-options)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-06-05T09:05:45.007

此处发布的代码有两个问题：如果您在同一页面上有多个轮播，则无法使用；如果您单击指示点，则无法使用。此外，在**Bootstrap 3**中，该事件已更改名称。

以下代码是[此代码](https://stackoverflow.com/a/20468576/1252920)的更新版本。在这里你可以找到更[详细的解释](http://blog.netgloo.com/2014/06/05/how-to-hide-carousel-controls-on-first-and-last-items-in-bootstrap-3/)

```
checkitem = function() {
  var $this;
  $this = $("#slideshow");
  if ($("#slideshow .carousel-inner .item:first").hasClass("active")) {
    $this.children(".left").hide();
    $this.children(".right").show();
  } else if ($("#slideshow .carousel-inner .item:last").hasClass("active")) {
    $this.children(".right").hide();
    $this.children(".left").show();
  } else {
    $this.children(".carousel-control").show();
  }
};

checkitem();

$("#slideshow").on("slid.bs.carousel", "", checkitem); 
```**

# html - 如何将页面与 wkhtmltopdf 右对齐？

> ID：11441475
> 
> 赞同：1
> 
> 时间：2012-07-11T21:05:51.063
> 
> 标签：html, pdf-generation, wkhtmltopdf

我有一个在 html 中用 RTL 编写的页面，它可以，但是在使用[wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/)转换后它是居中的。

我如何告诉 wkhtmltopdf 将该页面向右对齐？

对于页眉和页脚，有一个选项，但是如何为正文做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T13:49:17.253

Could you post your sources somewhere so it would be a bit easier to test?

Have you tried using CSS for the text aligns? Try doing a few tests with simple html files that have paragarphs with the following CSS rules for example:

```
.rtl {
    direction: rtl; 
    text-align: right;
    unicode-bidi: bidi-override; 
}

.ltr {
    direction: ltr; 
    text-align: left;
    unicode-bidi: bidi-override;
} 
```

The CSS rules are taken from an answer by @ThinkingStiff what I would imagine would be the solution or at least very similar: [https://stackoverflow.com/a/11787780/694325](https://stackoverflow.com/a/11787780/694325)

# credit-card - 如何显示信用卡号的最后 4 位

> ID：11441479
> 
> 赞同：1
> 
> 时间：2012-07-11T21:06:12.143
> 
> 标签：credit-card, pci-dss

我需要为用户提供连接到我们系统的信用卡的最后 4 位数字（例如 Skype）。它应该看起来像：

> 我们将从您的卡中扣款 xxx-xxx-xxxx-1234

对于 CD 授权和收费，我们使用一些“支付网关”。不幸的是，他们没有任何基于交易号的 API 可以向我返回该数据。在我的本地数据库中保留最后 4 位数字是否合法，根据 PCI 可以吗？

或者也许有不同的方法可以做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T21:02:06.480

PCI 的定义点是主帐号是否存在（存储、处理或传输）。

PAN 的长度为 16-19 位。截断/屏蔽的 PAN 最多显示前六位和后四位。它可以显示较少提供它的这些子集。

在您提到的情况下，您只是在谈论最后四位数字。这不算作 PAN，因此 PCI 不适用，您完全可以存储和显示这些数字。

但是，不要忘记您从哪里获得数字。如果您的处理器返回完整的 PAN 并且您进行了替换/屏蔽，那么您将需要考虑 PCI，因为即使您不存储它，您也将传输（接收）和处理 PAN。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T20:46:53.360

就这个 ：）

```
We will charge your card:
<% card_info_xxx = @card_info.card_number.length - 4
   1.upto(card_info_xxx) { concat 'x'.squish }
%><%= @card_info.card_number[-4..-1] %> 
```

# php - PHP字符串替换在字符串的末尾

> ID：11441480
> 
> 赞同：3
> 
> 时间：2012-07-11T21:06:14.470
> 
> 标签：php

我有一长串`Quick brown fox jumped over..... Friends`。我需要将字符串替换为`S`空`Friends`字符串，以便最终显示为`Friend`.

我怎样才能做到这一点 ？`str_replace`基本上会做到的，但是我怎样才能把最后一个字符砍掉呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-11T21:11:02.687

当您知道要删除哪些字符时，请使用`rtrim`：

```
$str = rtrim($str, "s"); 
```

在此示例中，当且仅当它是最后一个字符时，我们将删除它`s`（您可以指定字符串中的字符列表）。

当您只想删除任何最后一个字符时，请使用 substr：

```
$str = substr($str, 0, -1); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-11T21:10:02.937

使用 substr：

```
$str= substr($str, 0, -1); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-11T21:09:06.230

您可以使用[substr](http://php.net/manual/en/function.substr.php)。

```
$message = substr($message, 0, -1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T21:09:43.157

为什么不删除最后一个字符：

```
$str = substr($str, 0, strlen($str)-1); 
```

# maven - 仅运行失败的测试的 Maven 'test' 命令

> ID：11441481
> 
> 赞同：5
> 
> 时间：2012-07-11T21:06:17.813
> 
> 标签：maven

有没有办法调用仅运行上次调用失败的测试的 maven 'test' 命令？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T04:07:26.763

尝试使用 surefire 插件的[runOrder](http://maven.apache.org/plugins/maven-surefire-plugin/test-mojo.html#runOrder)参数。看起来它`${expression}`不允许您从命令行更改属性，所以我会自己动手：

```
... POM stuff here....
<properties>
    <!-- plugin's default value for this param -->  
    <surefire.test.runOrder>filesystem</surefire.test.runOrder>
</properties>
....
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-surefire-plugin</artifactId>
  <configuration>
    <runOrder>${surefire.test.runOrder}</runOrder>
  </configuration>
</plugin>
.... 
```

然后你可以在命令行中选择你想要的设置：

`mvn -Dsurefire.test.runOrder=failedfirst test`（或`package`或您想要的任何阶段）。

# c++ - C++ 变量声明 re：内存使用

> ID：11441482
> 
> 赞同：0
> 
> 时间：2012-07-11T21:06:18.303
> 
> 标签：c++, pointers

嗨，我知道这是一个非常愚蠢/基本的问题，但是代码之间有什么区别：-

```
int *i;
for(j=0;j<10;j++)
  {
    i = static_cast<int *>(getNthCon(j));
    i->xyz
  } 
```

而且，像这样的东西：-

```
for(j=0;j<10;j++)
  {
    int *i = static_cast<int *>(getNthCon(j));
    i->xyz;
  } 
```

我的意思是，这些代码在逻辑上是否极其相同，或者由于其本地性质会有所不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:13:23.153

一个实际的区别是`i`. 在第一种情况下，`i`在循环的最后一次迭代之后继续存在。在第二个它没有。

在某些情况下，您可能想知道`i`所有计算完成后的值。在这种情况下，请使用第二种模式。

不太实际的区别是`=`每种情况下令牌的性质。在第一个例子`i = ...`中表示*赋值*。在第二个例子中，`int *i = ...`表示*初始化*。某些类型（但不是`int*`nor `fp_ContainerObject*`）可能会以不同的方式处理赋值和初始化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:12:56.700

它们之间几乎没有区别。

在第一个代码示例中，`i`在循环外部声明，因此您在每次迭代中重用相同的指针变量。第二个`i`是循环体的局部。

由于`i`不在循环外使用，并且在一次迭代中分配给它的值不会在以后的迭代中使用，因此最好在本地声明它，如第二个示例中所示。

顺便说一句，`i`指针变量的名字不好；它通常用于`int`变量，尤其是`for`循环中使用的变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T21:25:20.697

对于任何健全的优化编译器，在内存分配方面都没有区别。唯一的区别是`i`. 这是一个示例程序（是的，我意识到这里有泄漏）：

```
#include <iostream>

int *get_some_data(int value) {
    return new int(value);
}

int main(int argc, char *argv[]){
    int *p;
    for(int i = 0; i < 10; ++i) {
        p = get_some_data(i);
        std::cout << *p;
    }

    return 0;
} 
```

以及生成的汇编输出：

```
int main(int argc, char *argv[]){   
01091000  push        esi  
01091001  push        edi  
    int *p;
    for(int i = 0; i < 10; ++i) {
01091002  mov         edi,dword ptr [__imp_operator new (10920A8h)]  
01091008  xor         esi,esi  
0109100A  lea         ebx,[ebx]  
        p = get_some_data(i);
01091010  push        4  
01091012  call        edi  
01091014  add         esp,4  
01091017  test        eax,eax  
01091019  je          main+1Fh (109101Fh)  
0109101B  mov         dword ptr [eax],esi  
0109101D  jmp         main+21h (1091021h)  
0109101F  xor         eax,eax  
        std::cout << *p;
01091021  mov         eax,dword ptr [eax]  
01091023  mov         ecx,dword ptr [__imp_std::cout (1092048h)]  
01091029  push        eax  
0109102A  call        dword ptr [__imp_std::basic_ostream<char,std::char_traits<char> >::operator<< (1092044h)]  
01091030  inc         esi  
01091031  cmp         esi,0Ah  
01091034  jl          main+10h (1091010h)  
    } 
```

现在使用在循环内声明的指针：

```
int main(int argc, char *argv[]){   
008D1000  push        esi  
008D1001  push        edi  
    for(int i = 0; i < 10; ++i) {
008D1002  mov         edi,dword ptr [__imp_operator new (8D20A8h)]  
008D1008  xor         esi,esi  
008D100A  lea         ebx,[ebx]  
        int *p = get_some_data(i);
008D1010  push        4  
008D1012  call        edi  
008D1014  add         esp,4  
008D1017  test        eax,eax  
008D1019  je          main+1Fh (8D101Fh)  
008D101B  mov         dword ptr [eax],esi  
008D101D  jmp         main+21h (8D1021h)  
008D101F  xor         eax,eax  
        std::cout << *p;
008D1021  mov         eax,dword ptr [eax]  
008D1023  mov         ecx,dword ptr [__imp_std::cout (8D2048h)]  
008D1029  push        eax  
008D102A  call        dword ptr [__imp_std::basic_ostream<char,std::char_traits<char> >::operator<< (8D2044h)]  
008D1030  inc         esi  
008D1031  cmp         esi,0Ah  
008D1034  jl          main+10h (8D1010h)  
    } 
```

如您所见，输出是相同的。请注意，即使在*调试*版本中，程序集也保持不变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T22:42:57.573

Ed S. 表明大多数编译器将为这两种情况生成相同的代码。但是，正如 Mahesh 指出的那样，它们实际上并不相同（即使`i`在版本 1 中在循环范围之外使用但不是版本 2 是合法的这一明显事实之外）。让我尝试以一种不会误导的方式来解释这两者如何都是真的。

首先，存储空间`i`从哪里来？

该标准对此保持沉默——只要在 范围的整个生命周期内都可以使用存储空间`i`，它就可以在编译器喜欢的任何地方。但是处理局部变量（技术上是具有自动存储持续时间的变量）的典型方法是按`sizeof(i)`字节扩展适当范围的堆栈帧，并将`i`作为偏移量存储到该堆栈帧中。

“教学编译器”可能总是为每个作用域创建一个堆栈框架。但是真正的编译器通常不会打扰，尤其是在进入和退出循环范围时没有任何反应的情况下。（除了查看程序集或使用调试器进行调试外，您无法分辨出区别，因此当然可以这样做。）因此，两个版本最终可能会`i`引用完全相同的偏移量函数的栈帧。（实际上，很有可能`i`最终会出现在寄存器中，但这并不会改变这里的任何重要内容。）

现在让我们看看生命周期。

在第一种情况下，编译器必须`i`在函数范围内声明它的位置进行默认初始化，每次通过循环将其复制分配到其中，并在函数范围的末尾销毁它。在第二种情况下，编译器必须`i`在每个循环开始时复制初始化，并在每个循环结束时销毁它。像这样：

如果`i`是类类型，这将是一个非常显着的差异。（如果不明白为什么，请参见下文。）但它不是，它是一个指针。这意味着默认初始化和销毁​​都是无操作的，并且复制初始化和复制分配是相同的。

因此，生命周期管理代码在这两种情况下都是相同的：每次循环都复制一次，仅此而已。

换句话说，存储被允许并且可能会是相同的；生命周期管理必须相同。

我答应回到为什么如果我是班级类型这些会有所不同。

比较这个伪代码：

```
i.IType();
for(j=0;j<10;j++) {
  i.operator=(static_cast<IType>(getNthCon(j));
}
i.~IType(); 
```

对此：

```
for(j=0;j<10;j++) {
  i.IType(static_cast<IType>(getNthCon(j));
  i.~IType();
} 
```

乍一看，第一个版本看起来“更好”，因为它是 1 个 IType()、10 个 operator=(IType&) 和 1 个 ~IType()，而第二个是 10 个 IType(IType&) 和 10 个 ~IType()。对于某些课程，这可能是真的。但是，如果您考虑 operator= 的工作原理，它通常必须至少相当于复制构造和破坏。

所以这里真正的区别是第一个版本需要一个默认构造函数和一个复制赋值运算符，而第二个版本不需要。如果你取出那个 static_cast 位（所以我们谈论的是转换构造函数和赋值而不是复制），你所看到的就相当于：

```
for(j=0;j<10;j++) {
  std::ifstream i(filenames[j]);
} 
```

显然，在这种情况下，您会尝试将 i 拉出循环。

但同样，这仅适用于“大多数”类；你可以很容易地设计一个版本 2 非常糟糕而版本 1 更有意义的类。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-07-11T21:08:01.660

在第二种情况下，对于每次迭代，都会在堆栈上创建一个新的指针变量。而在第一种情况下，指针变量只创建一次（即在进入循环之前）

# c# - IQueryable 可以与引用的局部变量的不同值一起使用吗？

> ID：11441491
> 
> 赞同：1
> 
> 时间：2012-07-11T21:06:42.887
> 
> 标签：c#, linq-to-entities

以下代码的目的是查找可用的 ID。

我写它时的想法是每次`query.Any()`运行，然后查询再次运行，并使用局部`id`变量中新增加的值。这源于我的知识，`id`在执行查询之前不会被评估。

从我的实验结果来看，我可以看到它不是这样工作的，我想知道您如何重新编写代码以实现其既定目标，同时保持使用 LINQ to EF 的风格？

我知道如何以简单的方式重写——我的目标是更好地理解 LINQ 表达式的延迟执行及其执行上下文。

```
int id = 4700;
var query = from c in Advertisers
            where c.ID == id
            select c;
int loopCount = 0;
while(query.Any())
{
    if(++loopCount == 5)
    {
        Console.WriteLine ("Cannot find a safe id.");
        break;
    }
    Console.WriteLine ("Already a record with " + id);
    id++;
}
Console.WriteLine ("The available id is " + id); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T00:23:59.783

从上面的代码中，问题是 id 已更新，但您的 IQueryable 对象未更新。您需要在查询的 where 子句中更改 id 的值。我知道的最简单的方法是封装初始查询，然后更改我需要的任何内容。

例如：

```
 using (var context = new ModelContainer())
    {
        IQueryable<Advertiser> queryAdvertisers = 
            from c in context.Advertisers
            select c;

        for (int i = 0; i < 100; i++)
        {
            if (queryAdvertisers.Where(a => a.ID == i).Any())
            {
                Console.WriteLine("ID:{0} already exists.", i);
            }
            else
            {
                Console.WriteLine("ID:{0} does not exist.", i);
            }
        }
    } 
```

通常我会将 queryAdvertisers 重构为方法或类。

# javascript - AJAX 连接到本地主机？

> ID：11441495
> 
> 赞同：0
> 
> 时间：2012-07-11T21:06:46.897
> 
> 标签：javascript, android, ajax

我正在设计可以在服务器（目前是我自己的本地计算机）上调用 php 的 javascript

最终，我将使用 phonegap 来解释 javascript 并显示结果......

我的问题似乎是连接到实际的服务器。

这是我的javascript：

```
 <!DOCTYPE html>
<html>
<head>
<script type="text/javascript">
function loadXMLDoc() {
    var xmlhttp;
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp = new XMLHttpRequest();
    } else { // code for IE6, IE5
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange = function() {
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            document.getElementById("myDiv").innerHTML = xmlhttp.responseText;
        }
    }
    xmlhttp.open("POST", "http://127.0.0.1/myfiles/WorkingVersionVQuickLook.php", true);
    xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xmlhttp.send("ipaddress=208.74.76.5");
}
</script>
</head>
<body>
<h2>AJAX</h2>
<button type="button" onclick="loadXMLDoc()">Request data</button>
<div id="myDiv"></div>
</body>
</html> 
```

当我引用 WorkingVersionVQuicklook.php 而不是 localhost 后跟位置时，它可以工作，如下所示：

```
 xmlhttp.open("POST","WorkingVersionVQuickLook.php",true) 
```

但是一旦我在本地主机上添加了确切的位置，它就不会了。

当我导出到我的 Android 模拟器时，即使可以运行的版本也无法在模拟器上运行，这让我想到我应该在本地机器上指定它。但是因为当我不通过浏览器运行它时它甚至不起作用，所以它在模拟器上不起作用。

请帮助我创建一个成功映射的连接，以便它适用于浏览器，然后希望适用于我的 android！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:10:31.713

尝试使用`/myfiles/WorkingVersionVQuickLook.php`而不是`http://127.0.0.1/myfiles/WorkingVersionVQuickLook.php`. 使用 XHR 连接到不同的主机可能会很棘手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:23:03.400

潜在的解决方案：

首先，我认为您可能缺少绝对 URL 中的端口号。其次，您需要使用用于从网络上的其他计算机连接到您的计算机的 IP 地址。这是因为模拟器作为自己的虚拟机运行，因此使用 localhost 或相对 URL 将导致请求被发送到模拟器上的指定路径，而不是主操作系统文件系统中的路径。

（编辑以更直接地回答问题）

# winapi - Visual C++ 中的歧义指针

> ID：11441496
> 
> 赞同：1
> 
> 时间：2012-07-11T21:06:51.277
> 
> 标签：winapi, visual-c++, pointers, datepicker

大家好，我是 Visual C++ 中 Win32 API 编程的新手。我正在使用 Microsoft Visual Studio 2008 专业版。我对指针有点困惑。请注意，虽然我可能是 Windows 编程的新手，但我不是 C 或 C++ 的新手，因此我非常了解指针的概念。导致问题的指针与对话框中的日期和时间选择器控件有关。现在根据 msdn 文档，日期和时间选择器使用**WM_NOTIFY**消息与应用程序通信，消息中的**LPARAM**将是指向**NMHDR**结构的指针。那是-： **'日期和时间选择器 (DTP) 控件在接收到用户输入或处理并对回调字段作出反应时发送通知代码。控件的父级以 WM_NOTIFY 消息的形式接收这些通知代码。**

现在我可以通过在收到 WM_NOTIFY 消息时将 LPARAM 类型转换为 NMHDR 的指针来访问 NMHDR 结构。即：

```
case WM_NOTIFY:
            if ((((NMHDR*)lparam)->idFrom == IDC_DATETIMEPICKER)&&
                ((NMHDR*)lparam)->code == DTN_DATETIMECHANGE)
            { LPNMDATETIMECHANGE lpChange=(LPNMDATETIMECHANGE)lparam;
            DisplayTime(&(lpChange->st));
                MessageBox(NULL,"wm_notify","test",MB_OK);
            }
            return TRUE; 
```

但是看看这段代码的第四行。我将刚才转换为 NMHDR 结构的相同 lparam 转换为 NMDATETIMECHANGE 结构。

我的问题是这怎么可能？如何将单个参数转换为引用两个不同结构的两个不同指针？NMHDR 和 LPNMDATETIMECHANGE 结构是根本不同的结构。您可以在这里查看-：[NMHDR](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775514%28v=vs.85%29.aspx)和[NMDATETIMECHANGE](http://msdn.microsoft.com/en-us/library/ms930615.aspx)

这怎么可能？我知道可以将指针的值存储在具有不同数据类型的其他变量中，并在我们想要使用它时再次将其转换回来。但是怎么可能有一个指针指向两个不同的结构呢？我的意思是我不认为N **​​MHDR**和**NMDATETIMECHANGE**结构是内存中的同一个实体，那么单个指针如何同时引用它们？我希望他们有两个不同的内存地址？哦，请注意，这段代码已经过测试，它可以工作。我的源代码如下：

```
#include <Windows.h>
#include <CommCtrl.h>
#include <cstdio>
#include "resource.h"

#pragma comment(linker,"\"/manifestdependency:type='win32' \
name='Microsoft.Windows.Common-Controls' version='6.0.0.0' \
processorArchitecture='x86' publicKeyToken='6595b64144ccf1df' language='*'\"")

LRESULT CALLBACK WindowFunc(HWND, UINT, WPARAM, LPARAM);
BOOL CALLBACK DialogFunc(HWND, UINT, WPARAM, LPARAM);

VOID InitOptions(HWND);
VOID DisplayTime(SYSTEMTIME*);

char szWinName[]="Timer Main Window";
HWND hDlg=NULL;
HINSTANCE hInst;

int WINAPI WinMain(HINSTANCE hThisInst, HINSTANCE hPrevInst,
                   LPSTR lpszArgs, int nWinMode)
{
    HWND hwnd;
    MSG msg;
    WNDCLASSEX wndclass;

    wndclass.cbSize=sizeof(WNDCLASSEX);

    wndclass.hInstance=hThisInst;
    wndclass.lpszClassName=szWinName;
    wndclass.lpfnWndProc=WindowFunc;
    wndclass.style=0;

    wndclass.hIcon=LoadIcon(hThisInst,MAKEINTRESOURCE(IDI_ICON1));
    wndclass.hIconSm=LoadIcon(hThisInst,MAKEINTRESOURCE(IDI_ICON2));
    wndclass.hCursor=LoadCursor(NULL,IDC_ARROW);

    wndclass.lpszMenuName=NULL;
    wndclass.cbClsExtra=0;
    wndclass.cbWndExtra=0;

    wndclass.hbrBackground=(HBRUSH) GetStockObject(LTGRAY_BRUSH);

    if(!RegisterClassEx(&wndclass)) return 0;

    InitCommonControls();

    hInst=hThisInst;

    hwnd=CreateWindow(
        szWinName,
        "Auto Timer (Work in progress)",
        WS_OVERLAPPEDWINDOW,
        CW_USEDEFAULT,
        CW_USEDEFAULT,
        CW_USEDEFAULT,
        CW_USEDEFAULT,
        NULL,
        NULL,
        hThisInst,
        NULL
        );

    while(GetMessage(&msg, NULL, 0, 0)>0)
    { if (!hDlg||!IsDialogMessage(hDlg,&msg))
    {
        TranslateMessage(&msg);
        DispatchMessage(&msg);
    }
    }
    return msg.wParam;

}

LRESULT CALLBACK WindowFunc(HWND hwnd, UINT message, WPARAM wparam, 
                            LPARAM lparam)
{ 
    switch(message){
        case WM_DESTROY:
            PostQuitMessage(0);
            break;
        case WM_CREATE:
            hDlg=CreateDialog(hInst,MAKEINTRESOURCE(IDD_FORMVIEW),
                hwnd,(DLGPROC)DialogFunc);
            break;
        default:
            return DefWindowProc(hwnd,message,wparam,lparam);
    }
    return 0;
}
BOOL CALLBACK DialogFunc(HWND hwnd, UINT message, 
                         WPARAM wparam, LPARAM lparam)
{ 
  switch(message)
    {
    case WM_INITDIALOG:
        SendMessage(hwnd,WM_SETICON, ICON_SMALL , 
            (LPARAM)LoadIcon(hInst,MAKEINTRESOURCE(IDI_ICON2)));
        return TRUE;
    case WM_CTLCOLORSTATIC:
        if (SendDlgItemMessage(hDlg,IDC_COMBO,CB_GETCOUNT,0,0)<6)
        {
            InitOptions(hDlg);
        }
        return (INT_PTR)GetStockObject(WHITE_BRUSH);
    case WM_NOTIFY:
        if ((((NMHDR*)lparam)->idFrom == IDC_DATETIMEPICKER)&&
            ((NMHDR*)lparam)->code == DTN_DATETIMECHANGE)
        { LPNMDATETIMECHANGE lpChange=(LPNMDATETIMECHANGE)lparam;
        DisplayTime(&(lpChange->st));
            MessageBox(NULL,"wm_notify","test",MB_OK);
        }
        return TRUE;
    case WM_COMMAND:
        switch LOWORD(wparam)
        { case IDC_BUTTON1:
        /*
          Button Code here.
          */
            if (SendDlgItemMessage(hDlg,IDC_RADIO5,BM_GETSTATE,0,0)==BST_CHECKED)
            { MessageBox(NULL,"radio5","test",MB_OK);
            }
            return TRUE;
        case IDC_RADIO5:
        EnableWindow(GetDlgItem(hDlg,IDC_COMBO),TRUE);
        EnableWindow(GetDlgItem(hDlg,IDC_DATETIMEPICKER),FALSE);
        EnableWindow(GetDlgItem(hDlg,IDC_DATETIMEPICKER1),FALSE);
        return TRUE;

        case IDC_RADIO6:
        EnableWindow(GetDlgItem(hDlg,IDC_COMBO),FALSE);
        EnableWindow(GetDlgItem(hDlg,IDC_DATETIMEPICKER),TRUE);
        EnableWindow(GetDlgItem(hDlg,IDC_DATETIMEPICKER1),TRUE);
        return TRUE;

        default:
            return FALSE;
    }
    case WM_CLOSE:
        DestroyWindow(hwnd);
        hDlg=NULL;
        PostQuitMessage(0);
        return TRUE;
}
    return FALSE;
}
VOID InitOptions(HWND hDlg){
    SendDlgItemMessage(hDlg,IDC_COMBO,CB_ADDSTRING,0,(LPARAM)("1 minute"));
    SendDlgItemMessage(hDlg,IDC_COMBO,CB_ADDSTRING,0,(LPARAM)("5 minutes"));
    SendDlgItemMessage(hDlg,IDC_COMBO,CB_ADDSTRING,0,(LPARAM)("10 minutes"));
    SendDlgItemMessage(hDlg,IDC_COMBO,CB_ADDSTRING,0,(LPARAM)("20 minutes"));
    SendDlgItemMessage(hDlg,IDC_COMBO,CB_ADDSTRING,0,(LPARAM)("30 minutes"));
    SendDlgItemMessage(hDlg,IDC_COMBO,CB_ADDSTRING,0,(LPARAM)("1 hour"));
    SendDlgItemMessage(hDlg,IDC_COMBO,CB_SETCURSEL,0,0);
    SendDlgItemMessage(hDlg,IDC_RADIO5,BM_SETCHECK,BST_CHECKED,0);
    SendDlgItemMessage(hDlg,IDC_RADIO1,BM_SETCHECK,BST_CHECKED,0);
    SendDlgItemMessage(hDlg,IDC_DATETIMEPICKER1,DTM_SETFORMAT,0,(LPARAM)"dd/MMM/yyyy");
    EnableWindow(GetDlgItem(hDlg,IDC_DATETIMEPICKER1),FALSE);
}

VOID DisplayTime(SYSTEMTIME *time)
{
    char t[500];

    sprintf_s(t,"Year=%d\n Month=%d\n Day=%d\n Hour=%d\n Minute=%d\n Seconds=%d\n",
        time->wYear,time->wMonth,time->wDay,
        time->wHour,time->wMinute,time->wSecond);
    MessageBox(NULL,t,"Test",MB_OK);
} 
```

我的资源脚本如下：

```
// Microsoft Visual C++ generated resource script.
//
#include "resource.h"

#define APSTUDIO_READONLY_SYMBOLS
/////////////////////////////////////////////////////////////////////////////
//
// Generated from the TEXTINCLUDE 2 resource.
//
#include "afxres.h"

/////////////////////////////////////////////////////////////////////////////
#undef APSTUDIO_READONLY_SYMBOLS

/////////////////////////////////////////////////////////////////////////////
// English (U.S.) resources

#if !defined(AFX_RESOURCE_DLL) || defined(AFX_TARG_ENU)
#ifdef _WIN32
LANGUAGE LANG_ENGLISH, SUBLANG_ENGLISH_US
#pragma code_page(1252)
#endif //_WIN32

#ifdef APSTUDIO_INVOKED
/////////////////////////////////////////////////////////////////////////////
//
// TEXTINCLUDE
//

1 TEXTINCLUDE 
BEGIN
    "resource.h\0"
END

2 TEXTINCLUDE 
BEGIN
    "#include ""afxres.h""\r\n"
    "\0"
END

3 TEXTINCLUDE 
BEGIN
    "\r\n"
    "\0"
END

#endif    // APSTUDIO_INVOKED

/////////////////////////////////////////////////////////////////////////////
//
// Dialog
//

IDD_FORMVIEW DIALOGEX 0, 0, 298, 178
STYLE DS_ABSALIGN | DS_SETFONT | DS_SETFOREGROUND | DS_CENTER | WS_MINIMIZEBOX | WS_VISIBLE | WS_CAPTION | WS_SYSMENU
EXSTYLE WS_EX_APPWINDOW | WS_EX_NOACTIVATE
CAPTION "SR-Timer(Work in Progress)"
FONT 10, "Verdana", 400, 0, 0x0
BEGIN
    GROUPBOX        "Tasks",IDC_STATIC1,11,45,84,103,WS_GROUP,WS_EX_TRANSPARENT
    CONTROL         "ShutDown",IDC_RADIO1,"Button",BS_AUTORADIOBUTTON,19,63,44,10,WS_EX_TRANSPARENT
    CONTROL         "Restart",IDC_RADIO2,"Button",BS_AUTORADIOBUTTON,19,81,40,10,WS_EX_TRANSPARENT
    CONTROL         "Stand By",IDC_RADIO3,"Button",BS_AUTORADIOBUTTON,19,114,46,10,WS_EX_TRANSPARENT
    CONTROL         "Hibernate",IDC_RADIO4,"Button",BS_AUTORADIOBUTTON,19,130,48,10,WS_EX_TRANSPARENT
    CONTROL         "Log Off",IDC_RADIO7,"Button",BS_AUTORADIOBUTTON,19,98,44,9,WS_EX_TRANSPARENT
    GROUPBOX        "Timing",IDC_STATIC2,196,44,90,107,WS_GROUP,WS_EX_TRANSPARENT
    CONTROL         "Pre-set Time",IDC_RADIO5,"Button",BS_AUTORADIOBUTTON,201,56,53,9,WS_EX_TRANSPARENT
    GROUPBOX        "Presets",IDC_STATIC3,206,65,68,30,0,WS_EX_TRANSPARENT
    CONTROL         "Specify Time",IDC_RADIO6,"Button",BS_AUTORADIOBUTTON,201,97,54,9,WS_EX_TRANSPARENT
    GROUPBOX        "Time",IDC_STATIC4,208,106,67,42,0,WS_EX_TRANSPARENT
    CONTROL         "",IDC_DATETIMEPICKER,"SysDateTimePick32",DTS_RIGHTALIGN | DTS_UPDOWN | WS_DISABLED | WS_TABSTOP | 0x8,213,133,58,11,WS_EX_TRANSPARENT
    PUSHBUTTON      "Schedule Task",IDC_BUTTON1,184,159,104,14,BS_CENTER,WS_EX_TRANSPARENT
    COMBOBOX        IDC_COMBO,213,78,57,12,CBS_DROPDOWNLIST | WS_VSCROLL | WS_TABSTOP,WS_EX_TRANSPARENT
    CONTROL         "",IDC_DATETIMEPICKER1,"SysDateTimePick32",DTS_RIGHTALIGN | WS_TABSTOP,213,116,58,13,WS_EX_TRANSPARENT
    CONTROL         118,IDC_STATIC,"Static",SS_BITMAP,0,0,299,178
END

/////////////////////////////////////////////////////////////////////////////
//
// Icon
//

// Icon with lowest ID value placed first to ensure application icon
// remains consistent on all systems.
IDI_ICON1               ICON                    "Test.ico"
IDI_ICON2               ICON                    "small.ico"

/////////////////////////////////////////////////////////////////////////////
//
// DESIGNINFO
//

#ifdef APSTUDIO_INVOKED
GUIDELINES DESIGNINFO 
BEGIN
    IDD_FORMVIEW, DIALOG
    BEGIN
        BOTTOMMARGIN, 177
    END
END
#endif    // APSTUDIO_INVOKED

/////////////////////////////////////////////////////////////////////////////
//
// Bitmap
//

IDB_BITMAP1             BITMAP                  "time_back.bmp"
#endif    // English (U.S.) resources
/////////////////////////////////////////////////////////////////////////////

#ifndef APSTUDIO_INVOKED
/////////////////////////////////////////////////////////////////////////////
//
// Generated from the TEXTINCLUDE 3 resource.
//

/////////////////////////////////////////////////////////////////////////////
#endif    // not APSTUDIO_INVOKED 
```

我的资源标题如下：

```
//{{NO_DEPENDENCIES}}
// Microsoft Visual C++ generated include file.
// Used by Timer.rc
//
#define IDD_FORMVIEW                    101
#define IDI_ICON1                       109
#define IDI_ICON2                       110
#define IDB_BITMAP1                     118
#define IDC_DATETIMEPICKER              1002
#define IDC_RADIO1                      1003
#define IDC_RADIO2                      1004
#define IDC_RADIO3                      1005
#define IDC_RADIO4                      1006
#define IDC_BUTTON1                     1007
#define IDC_RADIO5                      1011
#define IDC_RADIO6                      1013
#define IDC_COMBO                       1015
#define IDC_STATIC1                     1017
#define IDC_STATIC2                     1018
#define IDC_STATIC3                     1022
#define IDC_STATIC4                     1023
#define IDC_COMBO1                      1024
#define IDC_DATETIMEPICKER1             1025
#define IDC_RADIO7                      1026

// Next default values for new objects
// 
#ifdef APSTUDIO_INVOKED
#ifndef APSTUDIO_READONLY_SYMBOLS
#define _APS_NEXT_RESOURCE_VALUE        120
#define _APS_NEXT_COMMAND_VALUE         40001
#define _APS_NEXT_CONTROL_VALUE         1027
#define _APS_NEXT_SYMED_VALUE           101
#endif
#endif 
```

您可以制作自己的 VC++ 项目并进行测试，看看我说的是不是真的。如果您仍然不相信，请给我您的邮件 ID，我会将整个项目通过电子邮件发送给您。请我需要帮助，因为这是一个违背我在 C 语言中的指针基础的问题。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T21:09:23.853

如果仔细观察，您会发现它`NMDATETIMECHANGE`包含 a`NMHDR`作为其第一个成员，因此它实际上是一个派生类。（严格来说不是派生类，因为 C 没有类，但它是派生类的 C 模拟。）`NMDATETIMECHANGE`因此，转换为向下转换。

更正式地说，这是一个`CONTAINING_RECORD(NMDATETIMECHANGE, hdr, (NMHDR*)lparam)`但打字很多，所以大多数人将其简化为直接演员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T13:44:18.697

```
typedef struct tagNMDATETIMECHANGE {
    NMHDR nmhdr;
    DWORD dwFlags;
    SYSTEMTIME st;
} NMDATETIMECHANGE, *LPNMDATETIMECHANGE; 
```

这就是 NMDATETIMECHANGE 结构的定义。注意第一个成员是 NMHDR 类型。因此，如果您使用指向 NMDATETIMECHANGE 结构的指针，您实际上是指向 NMHDR 的基地址。这就是您可以将 LPARAM 类型转换为 NMHDR* 和 NMDATETIMECHANGE* 的原因。

# java - Android R18 更新后从调试视图打开源代码编辑 .class

> ID：11441498
> 
> 赞同：22
> 
> 时间：2012-07-11T21:06:54.870
> 
> 标签：java, android, eclipse, debugging

当我在 Eclipse 中调试我的代码时，当我打开编辑器发现我无法编辑它时，我很生气，因为我实际上正在查看 .class 文件的源代码。在调试模式下，如何让 Eclipse 打开 .java 文件而不是 .class 文件？

*编辑：当我*在代码中遇到断点时，它会将我带到 MyFile.class，而不是 MyFile.java，所以我可以看到*我的*代码但不能编辑它。

编辑：我猜它与 Android 和 ADT R18 有关

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-07-17T16:42:26.297

在我终于找到了一些时间和充分的理由来更深入地研究这个问题之后，我将详细说明 Thornbjorn 的回答。

最近，Google 改变了您的 Android 项目打包外部 Android 库的方式。在 ADT R17（我认为）中，它开始将外部项目源打包到 .jar 文件中，并将它们直接包含到您的项目中的 Android Dependencies 或 /libs 文件夹中。

现在，当调试器遇到断点时，它会在 .jar 中显示您的源代码，本质上是告诉您编辑 .class 文件。问题是这个文件是只读的，所以你必须手动去寻找你的 .java 源代码。（疼痛）

修复方法是在调试视图中右键单击项目名称，然后从菜单中选择“编辑源查找...”。从那里删除默认查找路径。之后，手动添加项目引用的关联项目（不是 jar）。这是通过单击添加，选择 Java 项目，然后检查适当的项目来完成的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-01T01:56:04.797

好的，所以我讨厌成为“那个人”，考虑到这对多少人有用，但这对我来说根本不起作用。我的意思是“编辑源查找...”菜单项不在上下文菜单中。我没有错过在 Debug Perspective 中执行此操作的指令（大概在 Debug Perspective 的 Project Explorer 中）。我在应用程序运行和应用程序暂停时尝试了它。我尝试检查应用程序项目的菜单（大概是说明所指的内容）和库项目的菜单。没有骰子。这是最新的 Eclipse 版本。

但是，我能够解决这个问题：

1.  在您的应用程序或您尝试为其链接源代码的库中设置断点。实际上，只要*您尝试为其链接源的库有一个在断点被命中时将出现在调用堆栈上的函数，*您实际上就可以将它放在任何地方。
2.  开始调试您的应用程序。
3.  导航您的应用程序以命中断点。
4.  确保您在 Debug 透视图中。
5.  在“调试”选项卡（出现调用堆栈的位置）中，找到库中的*任何*函数。
6.  右键单击该函数。“编辑源查找...”菜单选项应该在那里（靠近底部）。
7.  从这里开始，说明与 Styler 的说明相同。单击“添加”，选择“Java 项目”并添加您的项目（或多个项目）。
8.  在您退出“Edit Source Lookup...”窗口之前，如果您像我一样，您会看到 Eclipse 已选择将一堆您没有选择的东西添加到列表中。其中一些东西（可能在名称为“Android Private Libraries”的可扩展项目下）可能是您刚刚为其添加源的库的 jar。从列表中删除这些 jar。
9.  利润！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-01-06T05:03:56.990

1.  打开`main project properties -> Java Build Path -> Projects`选项卡并添加主项目所依赖的项目。
2.  切换到`Order and Export`选项卡并取消选中`Android Dependencies`
3.  享受

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-11T21:13:19.017

出于某种原因，Eclipse 不相信类文件来自您的 Java 文件。这通常是错误配置的构建路径，或使用 jar 文件而不是生成 jar 文件的项目。

查看项目管理器面板（`<->`按钮）以查看 Eclipse 在何处找到类文件，然后找出为什么它使用该位置而不是您的项目与源文件。

# scala - scala中的隐式提升

> ID：11441499
> 
> 赞同：5
> 
> 时间：2012-07-11T21:06:59.580
> 
> 标签：scala, implicits

我想将函数从隐式转换`A => B`为`List[A] => List[B]`.

我写了以下隐式定义：

```
implicit def lift[A, B](f: A => B): List[A] => List[B] = ... 
```

不幸的是，当我编写以下代码时，未应用隐式：

```
val plusOne: (List[Int]) => List[Int] = (x: Int) => (x + 1) 
```

如果我用明确的时间注释函数，它工作正常。

为什么？我该如何解决？

更新。似乎该问题特定于匿名函数。相比：

```
@Test
def localLiftingGenerics {
  implicit def anyPairToList[X, Y](x: (X, Y)): List[X] => List[Y] = throw new UnsupportedOperationException  

  val v: List[String] => List[Int] = ("abc", 239)
}

@Test
def localLiftingFuns {
  implicit def fun2ListFun[X, Y](f: X => Y): List[X] => List[Y] = throw new UnsupportedOperationException

  val v: List[String] => List[Int] = ((x: String) => x.length)
} 
```

第一个编译得很好。第二个被标记为错误

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T09:51:52.240

根据[Scala 语言规范](http://www.scala-lang.org/docu/files/ScalaReference.pdf)/表达式/匿名函数（6.23）：

> 如果匿名函数的预期类型是 scala.Function *n* [ *S [1] , ..., S [n] , R* ]，则*e*的预期类型是*R* ...

因此，函数的结果类型将被推断为`List[Int]`除非您将函数定义与函数值分配分开（以摆脱预期的类型）：

```
val function = (x: Int) => (x + 1)
val plusOne: (List[Int]) => List[Int] = function 
```

或明确指定函数类型：

```
val plusOne: (List[Int]) => List[Int] = ((x: Int) => (x + 1)): Int => Int 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:42:42.230

The implicit conversion for the input value compiles. So we just have a problem for the output of the anonymous function

```
 def localLiftingFuns {
   implicit def fun2ListFun[X, Y](f: X => Y): List[X] => Y = throw new UnsupportedOperationException

   val v: List[String] => Int = ((x: String) => x.length)
 } 
```

A possible fix using a second implicit conversion:

```
 def localLiftingFuns {
   implicit def fun2ListFun[X, Y](f: X => List[Y]): List[X] => List[Y] = throw new UnsupportedOperationException
   implicit def type2ListType[X](x:X): List[X] = throw new UnsupportedOperationException

   val v: List[String] => List[Int] = ((x: String) => x.length)
 } 
```

This version compiles.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T21:37:47.293

[(Scala 2.9.1-1 (Java HotSpot(TM) 64-Bit Server VM, Java 1.7.0_05)]

**第一个观察：**如果你复制`fun2ListFun`并重命名它，例如，``fun2ListFun，你会得到

```
found   : String => <error>
 required: List[String] => List[Int]

Note that implicit conversions are not applicable because they are ambiguous:
 both method fun2ListFun2 of type [X, Y](f: X => Y)List[X] => List[Y]
 and method fun2ListFun of type [X, Y](f: X => Y)List[X] => List[Y]
 are possible conversion functions from String => <error> to List[String] => List[Int]
  val v: List[String] => List[Int] = ((x: String) => x.length) 
```

看起来编译器似乎认为这两种隐式都适用。

**第二个观察：**

分裂

```
val v: List[String] => List[Int] = ((x: String) => x.length) /* Error*/ 
```

进入

```
val f = ((x: String) => x.length)
val v: List[String] => List[Int] = f /* Works */ 
```

使编译器高兴。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T08:35:26.427

似乎编译器很难弄清楚函数的类型发生了什么。如果你能给他一点帮助，它会起作用：

```
scala> implicit def lift[A,B](f: A => B) = (_:List[A]).map(f)
lift: [A, B](f: (A) => B)(List[A]) => List[B]

scala> val f: List[Int] => List[Int] = ((_:Int) + 1):(Int => Int)
f: (List[Int]) => List[Int] = <function1> 
```

# iphone - 当我从 Xcode 为 iOS 模拟器编译和部署应用程序时，编译后的 .ipa 驻留在哪里？

> ID：11441503
> 
> 赞同：11
> 
> 时间：2012-07-11T21:07:28.950
> 
> 标签：iphone, xcode, testing, ios-simulator

我希望能够传递为模拟器编译的 iphone 应用程序的版本。这里的想法是能够将应用程序的副本提供给不同的虚拟机，他们可以将应用程序部署到 iOS 模拟器并运行一些测试。

但是在为 iOS 模拟器编译应用程序后，我找不到该死的 *.ipa。有谁知道它住在哪里？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-11T22:39:33.723

您可以通过以下方式查看构建产品的放置位置：

```
Xcode Menu-> Preferences-> Locations 
```

或者，如果您有项目特定设置，可以通过查看

```
Xcode Menu-> File-> Project Settings 
```

我认为它从这些位置的产品构建 ipa 并将它们加载到模拟器中。因此，您可能无法在这些位置找到 .app 的实际 .ipa。

如果你想要一个ipa。进行存档构建。执行 Ad Hoc 分发并将生成的 .ipa 保存到您的桌面。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-07-11T22:45:15.513

没有 .ipa——Xcode 自己将`.app`包复制到模拟器中。您可以检查：

```
~/Library/Developer/Xcode/DerivedData/YourProject-<some garbage>/Build/Products/Debug-iphonesimulator/ 
```

（显然，如果您要分发发布版本，请交换 Debug for Release），或者，从以下位置获取实际安装在模拟器中的版本：

```
~/Library/Application Support/iPhone Simulator/<OS version>/Applications/<some UUID>/. 
```

`Applications`您可以通过在上述目录中创建一个任意命名的文件夹并将其放入其中，将该应用程序包复制到另一个模拟器中`.app`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T21:32:48.740

您是否已经尝试过以下位置？？？

库/开发人员/Xcode/DerivedData

# ruby-on-rails-3 - 工厂女孩序列不递增

> ID：11441505
> 
> 赞同：12
> 
> 时间：2012-07-11T21:07:31.787
> 
> 标签：ruby-on-rails-3, rspec2, factory-bot

我试图让 FactoryGirl 为我生成一些名称，但序列似乎没有增加。

```
# spec/factories/vessel.rb
require 'factory_girl'
FactoryGirl.define do

  sequence :vessel_name do |n|
    "TK42#{n}"
  end

  factory :vessel do
    name FactoryGirl.generate(:vessel_name)
    vessel_type 'fermenter'
    volume_scalar 100.0
    volume_units 'bbl'
  end
end 
```

* * *

```
# spec/models/vessel_spec.rb
require 'spec_helper'

describe Vessel do

  context 'working in the factory' do

    it 'makes a valid vessel' do
      vessel = FactoryGirl.create(:vessel)
      vessel.should be_valid, "Invalid vessel #{vessel.valid? || vessel.errors.messages.inspect}"
    end

    it 'makes another valid vessel' do
      vessel = FactoryGirl.create(:vessel)
      vessel.should be_valid, "Invalid vessel #{vessel.valid? || vessel.errors.messages.inspect}"
    end

  end

end 
```

规格输出是

```
Vessel
  working in the factory
    makes a valid vessel
    makes another valid vessel (FAILED - 1)

Failures:

  1) Vessel working in the factory makes another valid vessel
     Failure/Error: vessel = FactoryGirl.create(:vessel)
     ActiveRecord::RecordInvalid:
       Validation failed: Name has already been taken
     # ./spec/models/vessel_spec.rb:13:in `block (3 levels) in <top (required)>' 
```

* * *

```
# app/models/vessel.rb
class Vessel < ActiveRecord::Base

  attr_accessible :name, :vessel_type, :volume_scalar, :volume_units

  validates :name, :presence => true, :uniqueness => true

end 
```

* * *

```
0 HAL:0 work/nrb-brewery-management % bundle show factory_girl_rails rspec
/home/brundage/.rvm/gems/ruby-1.9.3-p0/gems/factory_girl_rails-3.5.0
/home/brundage/.rvm/gems/ruby-1.9.3-p0/gems/rspec-2.11.0

0 HAL:0 work/nrb-brewery-management % rails c test
Loading test environment (Rails 3.2.6)
1.9.3p0 :001 > FactoryGirl.generate :vessel_name
 => "TK422" 
1.9.3p0 :002 > FactoryGirl.generate :vessel_name
 => "TK423" 
1.9.3p0 :003 > FactoryGirl.generate :vessel_name
 => "TK424" 
1.9.3p0 :004 > FactoryGirl.generate :vessel_name
 => "TK425" 
```

为什么 FactoryGirl 不在我的规范中生成名称序列？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-20T04:26:39.210

这行得通，这意味着您不能在规范中的任何地方覆盖名称，因为构建后挂钩将始终运行并覆盖任何名称。

您的原始示例不起作用的原因是您在定义工厂时调用序列，而不是在运行工厂时调用。您可以为每次工厂运行时调用的属性定义提供一个块。这样，您就有机会为每个实例生成一个值，而不是为所有实例生成一个值。这最常用于序列和时间。

您可以使用以下代码段修复原始示例：

```
sequence :vessel_name do |n|
  "TK42#{n}"
end

factory :vessel do
  name { generate(:vessel_name) }
  vessel_type 'fermenter'
  volume_scalar 100.0
  volume_units 'bbl'
end 
```

如果可以使用相同的格式生成所有名称，您还可以通过重命名序列来完全省略该值：

```
sequence :name do |n|
  "TK42#{n}"
end

factory :vessel do
  name
  vessel_type 'fermenter'
  volume_scalar 100.0
  volume_units 'bbl'
end 
```

但是，如果您需要为不同的工厂提供不同的名称格式，那将不起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T22:38:59.823

答案是：

```
require 'factory_girl'

FactoryGirl.define do

  sequence :vessel_name do |n|
    "TK42#{n}"
  end

  factory :vessel do
    vessel_type 'fermenter'
    volume_scalar 100.0
    volume_units 'bbl'
    after :build do |v|
      v.name = FactoryGirl.generate(:vessel_name)
    end
  end
end 
```

# android - Android表格布局图片边距

> ID：11441509
> 
> 赞同：2
> 
> 时间：2012-07-11T21:07:52.230
> 
> 标签：android, android-layout

我有以下表格布局，用于在网格中显示图像按钮。

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/tableLayout1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

<TableRow
    android:id="@+id/tableRow4"
    android:layout_weight="1" >

    <ImageButton
        android:id="@+id/button_one"
        android:layout_width="0dp"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:adjustViewBounds="true"
        android:background="@drawable/button"
        android:scaleType="fitCenter"
        android:src="@drawable/button_one" />

    <ImageButton
        android:id="@+id/button_two"
        android:layout_width="0dp"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:adjustViewBounds="true"
        android:background="@drawable/button"
        android:scaleType="fitCenter"
        android:src="@drawable/button_two" />
</TableRow>

<TableRow
    android:id="@+id/tableRow4"
    android:layout_weight="1" >

    <ImageButton
        android:id="@+id/button_three"
        android:layout_width="0dp"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:adjustViewBounds="true"
        android:background="@drawable/button"
        android:scaleType="fitCenter"
        android:src="@drawable/button_three" />
</TableRow> 
```

如您所见，第一行包含两列，第二行包含一列。

我希望图像扩展以适合表格单元格。然而，底部图像按钮的边缘与顶部的两个图像按钮并没有完全对齐。就好像底部单元格上有额外的填充或边距。

任何想法如何让这些完美排列？

提前致谢。

截屏：

![在此处输入图像描述](../Images/ae60845a190c1d80816ac565aeb9c8d5.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T10:29:58.510

正如 vasart 所提到的，将所有替换`fitCenter`为`fitXY`就可以了

更新的 XML：

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/tableLayout1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#ffffff" >

    <TableRow
        android:id="@+id/tableRow4"
        android:layout_weight="1" >

        <ImageButton
            android:id="@+id/button_one"
            android:layout_width="0dp"
            android:layout_height="fill_parent"
            android:layout_weight="1"
            android:adjustViewBounds="true"
            android:background="@drawable/button"
            android:scaleType="fitXY" />

        <ImageButton
            android:id="@+id/button_two"
            android:layout_width="0dp"
            android:layout_height="fill_parent"
            android:layout_weight="1"
            android:adjustViewBounds="true"
            android:background="@drawable/button"
            android:scaleType="fitXY" />
    </TableRow>

    <TableRow
        android:id="@+id/tableRow5"
        android:layout_weight="1" >

        <ImageButton
            android:id="@+id/button_three"
            android:layout_width="0dp"
            android:layout_height="fill_parent"
            android:layout_weight="1"
            android:adjustViewBounds="true"
            android:background="@drawable/button"
            android:scaleType="fitXY" />
    </TableRow>

</TableLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T11:49:16.913

我解决了这个问题...

我最初使用九个补丁绘制作为背景，因为我有弯曲的角落，但是当我切换到带有尖角的常规图像时，我忘记了从图像中删除边框......哇！重做图像解决了问题 - 我的 xml 原样正常。

/掌脸

# exception - 致命异常：AsyncTask #1

> ID：11441510
> 
> 赞同：0
> 
> 时间：2012-07-11T21:07:52.533
> 
> 标签：exception, task

我有一个致命异常：AsyncTask #1 在下面的部分，但不知道为什么。

```
 /**
     * getting Charts from URL
     * */
    protected String doInBackground(String... args) {
        // Building Parameters
        ArrayList<NameValuePair> params = new ArrayList<NameValuePair>();
        // getting JSON string from URL
        JSONObject json = jParser.makeHttpRequest(url_read, "POST", params);

        // Check your log cat for JSON response
        Log.d("Charts: ", json.toString());

        try {
            // Checking for SUCCESS TAG
            int success = json.getInt(TAG_SUCCESS);

            if (success == 1) {
                // products found
                // Getting Array of Products

                JSONArray charts = json.getJSONArray(TAG_CHARTS);

                // looping through All Products
                for(int i=0;i<charts.length();i++) {
                    JSONObject json_data = charts.getJSONObject(i);

                    String id = json_data.getString("id");
                    String interpret = json_data.getString("interpret");
                    String titel = json_data.getString("titel");
                    String album = json_data.getString("album");
                    String albumcover = json_data.getString("albumcover");
                    String likes = json_data.getString("likes");

                    HashMap<String, String> map = new HashMap<String, String>();

                    map.put(TAG_ID, id);
                    map.put(TAG_INTERPRET, interpret);
                    map.put(TAG_TITEL, titel);
                    map.put(TAG_ALBUM, album);
                    map.put(TAG_ALBUMCOVER, albumcover);
                    map.put(TAG_LIKES, likes);       

                    songslist.add(map);

                }
            } else {
                // no products found
                // Launch Add New product Activity
                Intent i = new Intent(getApplicationContext(),
                        CreateSong.class);
                // Closing all previous activities
                i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                startActivity(i);
            } 
        } catch (JSONException e) {
            e.printStackTrace();
        }

        return null;
    } 
```

这是我的第一个问题。希望你知道该怎么做。我从数据库中获取数据并将它们放入 JSON 数组，然后放入 Hashmap，但似乎错误来自 JSON。

编辑：记录猫

```
07-11 23:20:48.320: D/CLIPBOARD(13241): Hide Clipboard dialog at Starting input: finished by someone else... !
07-11 23:20:52.510: D/dalvikvm(13241): GC_FOR_ALLOC freed 139K, 3% free 9004K/9223K, paused 13ms
07-11 23:20:52.650: E/JSON Parser(13241): Error parsing data org.json.JSONException: Value <!DOCTYPE of type java.lang.String cannot be converted to JSONObject
07-11 23:20:52.650: W/dalvikvm(13241): threadid=11: thread exiting with uncaught exception (group=0x40c331f8)
07-11 23:20:52.675: E/AndroidRuntime(13241): FATAL EXCEPTION: AsyncTask #1
07-11 23:20:52.675: E/AndroidRuntime(13241): java.lang.RuntimeException: An error occured while executing doInBackground()
07-11 23:20:52.675: E/AndroidRuntime(13241):    at android.os.AsyncTask$3.done(AsyncTask.java:278)
07-11 23:20:52.675: E/AndroidRuntime(13241):    at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
07-11 23:20:52.675: E/AndroidRuntime(13241):    at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
07-11 23:20:52.675: E/AndroidRuntime(13241):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
07-11 23:20:52.675: E/AndroidRuntime(13241):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
07-11 23:20:52.675: E/AndroidRuntime(13241):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
07-11 23:20:52.675: E/AndroidRuntime(13241):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
07-11 23:20:52.675: E/AndroidRuntime(13241):    at java.lang.Thread.run(Thread.java:856)
07-11 23:20:52.675: E/AndroidRuntime(13241): Caused by: java.lang.NullPointerException
07-11 23:20:52.675: E/AndroidRuntime(13241):    at de.andreasgloeckner.ShowCharts$LoadAllProducts.doInBackground(ShowCharts.java:172)
07-11 23:20:52.675: E/AndroidRuntime(13241):    at     de.andreasgloeckner.ShowCharts$LoadAllProducts.doInBackground(ShowCharts.java:1)
07-11 23:20:52.675: E/AndroidRuntime(13241):    at android.os.AsyncTask$2.call(AsyncTask.java:264)
07-11 23:20:52.675: E/AndroidRuntime(13241):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
07-11 23:20:52.675: E/AndroidRuntime(13241):    ... 4 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T22:08:38.083

您的代码中有一个 NullPointerException（ShowCharts.java，第 172 行）。现在弄清楚那是哪一行。您显然正在访问一个空对象，或者只是在此处共享第 172 行。可能是`songslist`对象。我在您共享的代码块中看不到初始化。

```
Caused by: java.lang.NullPointerException
    07-11 23:20:52.675: E/AndroidRuntime(13241):    at de.andreasgloeckner.ShowCharts$LoadAllProducts.doInBackground(ShowCharts.java:172) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T06:18:08.097

从 doInBackground 方法内部，您无法更改或触摸任何 UI 元素，因此您无法调用另一个活动，您需要做的是从 Asynctask 的 onPostExecute 方法内部调用另一个活动

# html - 多日日历事件的 HTML 标记

> ID：11441514
> 
> 赞同：11
> 
> 时间：2012-07-11T21:08:23.623
> 
> 标签：html, css, calendar

我熟悉标准的基于 colspan 的方法，用于在 HTML 中显示（多周或月视图）日历，事件跨越多天。（谷歌日历就是这样做的，作为众多例子之一。）

我很好奇是否有人知道实现相同目标的无表方法。也许它只是不重要，这是对表格元素的“好”使用，但我认为它可能在这个响应式设计的时代更相关。

这是一个响应式、无表格日历的示例。（不过，没有多日活动。）[https://pittsburghkids.org/calendar](https://pittsburghkids.org/calendar)在其小视口版本中，从语义上讲，它不再是一张桌子。同样，正如@ThinkingStiff 在下面提到的，如果您在客户端从“月视图”切换到“列表视图”，则表在语义上也并不真正适合。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-11T21:14:47.140

## 日历！=表格

日历在语义上*不是*表格。它们感觉像表格，因为这是我们总是看到它们的方式，但是为了使数据在*语义上*呈表格形式，每一行都必须包含一个唯一的实体，而它们没有。在日历中，***天*是实体**。

令人困惑的是，我们还将天分组为几周。人们很自然地认为一个月是几个星期的集合，但事实并非如此，它是几天的集合。一个月平均有 4.3 周。表中的一行**不能包含一个实体的*一部分*或*多个*实体。**

## 行 == 实体，列 == 属性

将其与在线购物车进行比较。您购物车中的物品是表格的。每**行**代表购物车中的一种**商品**。每**列**要么是项目的一个**属性**（名称、股票编号、价格），要么是一个属性的聚合（数量、总量）。您永远不会在一行中看到两种不同的商品类型（因为这没有意义），并且购物车不能包含 4.3 行。

## 一个解法

对于我使用的这个演示`<divs>`，每天设置一个`display: inline-block`，但您可能想要使用一个`<ol>`. 在月/周/日视图之间更改时，天数流动良好（表格不可能）。对于多日活动，Javascript 可以做布局。

**演示：http:** [//jsfiddle.net/ThinkingStiff/XXm8y/](http://jsfiddle.net/ThinkingStiff/XXm8y/)

### 输出：

![在此处输入图像描述](../Images/11eb659d0b36b0904d2855b1ea25cdab.png)

### 脚本：

```
var events = [{ from: 3, to: 9 }, { from: 4, to: 4 }, { from: 9, to: 11 },{ from: 4, to: 12 }];

for( var eventIndex = 0, event; event = events[eventIndex], eventIndex < events.length; eventIndex++ ) {
    for( var dayIndex = event.from; dayIndex <= event.to; dayIndex++ ) {
        var dayElement = document.getElementById( 'day' + dayIndex ),
            firstDay = document.getElementsByClassName( 'event' + eventIndex ),
            top;
        if( firstDay.length ) {
            top = firstDay[0].style.top;
        } else {
            var eventCount = dayElement.getElementsByClassName( 'event' ).length;
            top = ( eventCount * 20 ) + 'px';
        };
        var html = '<div '
            + 'class="event event' + eventIndex + '" '
            + 'style="top: ' + top + ';">' 
            + eventIndex
            + '</div>';
        dayElement.insertAdjacentHTML( 'beforeEnd', html );
    };        
};
​ 
```

### CSS：

```
#calendar {
    border: 1px solid black;
    height: 400px;
    width: 504px;    
}
.day {
    display: inline-block;
    height: 80px;
    position: relative;
    vertical-align: top;
    width: 72px;   
}
.day:nth-child( even ) {
    background-color: pink;
}
.day:nth-child( odd ) {
    background-color: lightblue;
}
.event {
    background-color: lightgrey;
    height: 20px;   
    position: absolute;
    text-align: center;
    width: 100%;
} 
```

​</p>

### HTML：

```
<div id="calendar">
    <div id="day1" class="day"></div><div id="day2" class="day"></div><div id="day3" class="day"></div><div id="day4" class="day"></div><div id="day5" class="day"></div><div id="day6" class="day"></div><div id="day7" class="day"></div><div id="day8" class="day"></div><div id="day9" class="day"></div><div id="day10" class="day"></div><div id="day11" class="day"></div><div id="day12" class="day"></div><div id="day13" class="day"></div><div id="day14" class="day"></div><div id="day15" class="day"></div><div id="day16" class="day"></div><div id="day17" class="day"></div><div id="day18" class="day"></div><div id="day19" class="day"></div><div id="day20" class="day"></div><div id="day21" class="day"></div><div id="day22" class="day"></div><div id="day23" class="day"></div><div id="day24" class="day"></div><div id="day25" class="day"></div><div id="day26" class="day"></div><div id="day27" class="day"></div><div id="day28" class="day"></div><div id="day29" class="day"></div><div id="day30" class="day"></div><div id="day31" class="day"></div>
</div>​ 
```

# c# - 多用户的 C# 文本文件共享方案

> ID：11441515
> 
> 赞同：0
> 
> 时间：2012-07-11T21:08:26.837
> 
> 标签：c#, filestream, file-locking, filelock, multi-user

与其从头开始编写文本文件共享 Windows 窗体应用程序，我想我只想问是否有人有我可以使用的片段 (C#) 或方法？

该应用程序只需要创建一个文本文件，并允许多个用户从网络上的不同电脑上使用相同的应用程序将注释附加到文件中。基本上，我试图让多个用户使用这个简单的应用程序对项目进行频繁的更新/评论/状态更改。

我研究了一些文件流锁定建议，但再次想看看是否有人愿意分享代码片段。

提前感谢您的任何帮助。戴尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:14:18.773

尝试使用`System.IO.File.AppendText`方法这可以完成您正在寻找的所有文件操作

> **备注取自 MSDN**
> 
> StreamWriter(String, Boolean) 构造函数重载。如果 path 指定的文件不存在，则创建该文件。如果文件确实存在，则对 StreamWriter 的写入操作会将文本附加到文件中。文件打开时允许其他线程读取文件。
> 
> path 参数允许指定相对或绝对路径信息。相对路径信息被解释为相对于当前工作目录。要获取当前工作目录，请参阅 GetCurrentDirectory。
> 
> 路径参数不区分大小写。该方法等价于

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:17:40.360

使用 Client-Server 方法，例如使用 AppendText 和 GetText 两种方法创建 WCF 服务，然后只有 WCF 服务会写入文件。

这是基本 WCF 客户端-服务器的示例

[http://www.switchonthecode.com/tutorials/wcf-tutorial-basic-interprocess-communication](http://www.switchonthecode.com/tutorials/wcf-tutorial-basic-interprocess-communication)

# php - ffmpeg 进度条 - PHP 中的编码百分比

> ID：11441517
> 
> 赞同：27
> 
> 时间：2012-07-11T21:08:36.240
> 
> 标签：php, regex, parsing, ffmpeg

我在服务器上用 PHP 和 bash 编写了一个完整的系统，以在我的 VPS 上转换和流式传输 HTML5 视频。ffmpeg在后台完成转换，内容输出到**block.txt**。

看了以下帖子：

[ffmpeg可以显示进度条吗？](https://stackoverflow.com/questions/747982/can-ffmpeg-show-a-progress-bar)

和

[ffmpeg 视频编码进度条](https://stackoverflow.com/questions/3770927/ffmpeg-video-encoding-progress-bar)

除其他外，我找不到一个可行的例子。

我需要以百分比形式获取当前编码的进度。

**我在上面链接的第一篇文章给出了：**

```
$log = @file_get_contents('block.txt');

preg_match("/Duration:([^,]+)/", $log, $matches);
list($hours,$minutes,$seconds,$mili) = split(":",$matches[1]);
$seconds = (($hours * 3600) + ($minutes * 60) + $seconds);
$seconds = round($seconds);

$page = join("",file("$txt"));
$kw = explode("time=", $page);
$last = array_pop($kw);
$values = explode(' ', $last);
$curTime = round($values[0]);
$percent_extracted = round((($curTime * 100)/($seconds)));

echo $percent_extracted; 
```

$percent_extracted 变量回显为零，由于数学不是我的强项，我真的不知道如何在这里进步。

**这是 block.txt 的 ffmpeg 输出中的一行（如果有帮助）**

> 时间=00:19:25.16 比特率= 823.0kbits/s 帧=27963 fps= 7 q=0.0 大小= 117085kB 时间=00:19:25.33 比特率= 823.1kbits/s 帧=27967 fps= 7 q=0.0 大小= 117085kB时间=00:19:25.49 比特率= 823.0kbits/s 帧=27971 fps= 7 q=0.0 大小= 117126kB

请帮我输出这个百分比，完成后我可以创建自己的进度条。谢谢。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-07-12T15:57:31.870

好的，我找到了我需要的东西——希望这也能帮助其他人！

**首先，您希望将 ffmpeg 数据输出到服务器上的文本文件。**

```
ffmpeg -i path/to/input.mov -vcodec videocodec -acodec audiocodec path/to/output.flv 1> block.txt 2>&1 
```

**所以，ffmpeg 的输出是 block.txt。现在在 PHP 中，让我们这样做！**

```
$content = @file_get_contents('../block.txt');

if($content){
    //get duration of source
    preg_match("/Duration: (.*?), start:/", $content, $matches);

    $rawDuration = $matches[1];

    //rawDuration is in 00:00:00.00 format. This converts it to seconds.
    $ar = array_reverse(explode(":", $rawDuration));
    $duration = floatval($ar[0]);
    if (!empty($ar[1])) $duration += intval($ar[1]) * 60;
    if (!empty($ar[2])) $duration += intval($ar[2]) * 60 * 60;

    //get the time in the file that is already encoded
    preg_match_all("/time=(.*?) bitrate/", $content, $matches);

    $rawTime = array_pop($matches);

    //this is needed if there is more than one match
    if (is_array($rawTime)){$rawTime = array_pop($rawTime);}

    //rawTime is in 00:00:00.00 format. This converts it to seconds.
    $ar = array_reverse(explode(":", $rawTime));
    $time = floatval($ar[0]);
    if (!empty($ar[1])) $time += intval($ar[1]) * 60;
    if (!empty($ar[2])) $time += intval($ar[2]) * 60 * 60;

    //calculate the progress
    $progress = round(($time/$duration) * 100);

    echo "Duration: " . $duration . "<br>";
    echo "Current Time: " . $time . "<br>";
    echo "Progress: " . $progress . "%";

} 
```

这会输出剩余时间的百分比。

您可以将其作为唯一回显到页面的文本，从另一个页面您可以使用 jQuery 执行 AJAX 请求以获取该文本并将其输出到 div 中，例如，每次更新您的页面10 秒。:)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-01-05T17:10:47.097

ffmpeg 现在有一个进度选项，它使输出更容易解析。

> ffmpeg -progress block.txt -i path/to/input.mov -vcodec videocodec -acodec audiocodec path/to/output.flv 2>&1

在开始编码之前，您可以获得总帧数以及许多其他信息（这就是使用 bash 所做的事情。我是一名 Perl 程序员，所以我不知道您如何将这些信息输入到您的PHP 脚本）。

> eval $(ffprobe -of flat=s=_ -show_entries stream=height,width,nb_frames,duration,codec_name path/to/input.mov);
> 宽度=${streams_stream_0_width};
> 高度=${streams_stream_0_height};
> 帧=${streams_stream_0_nb_frames};
> videoduration=${streams_stream_0_duration};
> audioduration=${streams_stream_1_duration};
> 编解码器=${streams_stream_0_codec_name};
> 回声 $width,$height,$frames,$videoduration,$audioduration,$codec;

-of flate=s=_ 表示将每个 name=value 放在单独的行上。-show_entries 告诉它显示后面的条目（-show_streams 的流，-show_format 的格式等） stream=... 表示从 -show_streams 输出中显示这些项目。请尝试以下操作以查看可用的内容：

> ffprobe -show_streams 路径/to/input.mov

进度文件的输出大约每秒添加一次。编码完成后的内容如下所示。在我的脚本中，我每秒将文件放入一个数组中，并以相反的顺序遍历数组，仅使用我找到的第一个 [最后一个反转前] 两个“进度”行之间的内容，以便我使用文件末尾的最新信息。可能有更好的方法。这是来自没有音频的 mp4，因此只有一个流。

> frame=86
> fps=0.0
> stream_0_0_q=23.0
> total_size=103173
> out_time_ms=1120000
> out_time=00:00:01.120000
> dup_frames=0
> drop_frames=0
> 进度=继续
> frame=142
> fps=140.9
> stream_0_0_q=23.0
> total_size=415861
> out_time_ms=0300
> out_time_ms=0: 36 00:03.360000
> dup_frames=0
> drop_frames=0
> 进度=继续
> 帧=185
> fps=121.1
> stream_0_0_q=23.0
> total_size=1268982
> out_time_ms=5080000
> out_time=00:00:05.080000
> dup_frames=0
> drop_frames=0
> 进度=继续
> frame=225
> fps=110.9
> stream_0_0_q=23.0
> total_size=2366000
> out_time_ms=6680000
> out_time=00:00:06.680000
> dup_frames=0
> drop_frames=0
> 进度=继续
> 帧=262
> fps=103.4
> stream_0_0_q=23.0
> total_size=0 :
> 810570
> out_time_ms 00:08.160000
> dup_frames=0
> drop_frames=0
> progress=继续
> 帧=299
> fps=84.9
> stream_0_0_q=-1.0
> total_size=6710373
> out_time_ms=11880000
> out_time=00:00:11.880000
> dup_frames=0
> drop_frames=0
> progress=end

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-26T08:09:09.740

如果 javascript 更新您的进度条，javascript 可以“直接”执行第 2 步：

**[本例需要[道场](http://dojotoolkit.org/)]**

* * *

**[1](http://dojotoolkit.org/ "道场")** *php：*开始转换并将状态写入文本文件 - 示例语法：

```
exec("ffmpeg -i path/to/input.mov path/to/output.flv 1>path/to/output.txt 2>&1"); 
```

* * *

对于第二部分，我们**只需要 javascript**来读取文件。以下示例将 dojo.request 用于 AJAX，但您也可以使用 jQuery 或 vanilla 或其他任何东西：

**[2]** *js：*从文件中获取进度：

```
var _progress = function(i){
    i++;
    // THIS MUST BE THE PATH OF THE .txt FILE SPECIFIED IN [1] : 
    var logfile = 'path/to/output.txt';

/* (example requires dojo) */

request.post(logfile).then( function(content){
// AJAX success
    var duration = 0, time = 0, progress = 0;
    var result = {};

    // get duration of source
    var matches = (content) ? content.match(/Duration: (.*?), start:/) : [];
    if( matches.length>0 ){
        var rawDuration = matches[1];
        // convert rawDuration from 00:00:00.00 to seconds.
        var ar = rawDuration.split(":").reverse();
        duration = parseFloat(ar[0]);
        if (ar[1]) duration += parseInt(ar[1]) * 60;
        if (ar[2]) duration += parseInt(ar[2]) * 60 * 60;

        // get the time 
        matches = content.match(/time=(.*?) bitrate/g);
        console.log( matches );

        if( matches.length>0 ){
            var rawTime = matches.pop();
            // needed if there is more than one match
            if (lang.isArray(rawTime)){ 
                rawTime = rawTime.pop().replace('time=','').replace(' bitrate',''); 
            } else {
                rawTime = rawTime.replace('time=','').replace(' bitrate','');
            }

            // convert rawTime from 00:00:00.00 to seconds.
            ar = rawTime.split(":").reverse();
            time = parseFloat(ar[0]);
            if (ar[1]) time += parseInt(ar[1]) * 60;
            if (ar[2]) time += parseInt(ar[2]) * 60 * 60;

            //calculate the progress
            progress = Math.round((time/duration) * 100);
        }

        result.status = 200;
        result.duration = duration;
        result.current  = time;
        result.progress = progress;

        console.log(result);

        /* UPDATE YOUR PROGRESSBAR HERE with above values ... */

        if(progress==0 && i>20){
            // TODO err - giving up after 8 sec. no progress - handle progress errors here
            console.log('{"status":-400, "error":"there is no progress while we tried to encode the video" }'); 
            return;
        } else if(progress<100){ 
            setTimeout(function(){ _progress(i); }, 400);
        }
    } else if( content.indexOf('Permission denied') > -1) {
        // TODO - err - ffmpeg is not executable ...
        console.log('{"status":-400, "error":"ffmpeg : Permission denied, either for ffmpeg or upload location ..." }');    
    } 
},
function(err){
// AJAX error
    if(i<20){
        // retry
        setTimeout(function(){ _progress(0); }, 400);
    } else {
        console.log('{"status":-400, "error":"there is no progress while we tried to encode the video" }');
        console.log( err ); 
    }
    return; 
});
}
setTimeout(function(){ _progress(0); }, 800); 
```

# c - 重复移动“x <<= 1”后值是否会为0？

> ID：11441524
> 
> 赞同：9
> 
> 时间：2012-07-11T21:09:07.160
> 
> 标签：c, bit-shift

我想知道在下面的程序中 x 是否会达到零。

请考虑：

```
int main ()
{
    int x = 1;
    while (x)
      {
        x <<= 1;
      }
    return 0;
} 
```

该程序的预期行为应该正常退出还是永远循环？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-11T21:11:16.570

两者都不是（或两者），它在`x`溢出时以未定义的行为运行。

[C99](http://www.open-std.org/jtc1/sc22/WG14/www/docs/n1256.pdf)规范第 6.5.7 节说：

> E1 << E2 的结果是 E1 左移 E2 位位置；空出的位用零填充。如果 E1 具有无符号类型，则结果的值为 E1 × 2 ^(E2)，比结果类型中可表示的最大值多模一减少。如果 E1 有带符号类型和非负值，并且 E1 × 2 ^(E2)在结果类型中是可表示的，那么这就是结果值；**否则，行为是 undefined**。

# dynamics-crm-2011 - Dynamics CRM 2011 - 导入具有太多属性的解决方案

> ID：11441527
> 
> 赞同：1
> 
> 时间：2012-07-11T21:09:38.133
> 
> 标签：dynamics-crm-2011, dynamics-crm-4

这是我的问题。我有一个 crm 4 组织，需要转换为 crm 2011。这已经完成，它已作为 crm 2011 导入。我有一个 dev crm 2011，我一直在对其进行表单更改并自定义我的销售流程和屏幕。我正在尝试将 dev crm 解决方案导入新转换的 crm 4 组织，但出现此错误：

> 内部异常：Microsoft.Crm.CrmException：无法创建属性 new_welcomepacketsentbyname，因为我们已达到实体允许的最大属性数 (1000)。实体 ID：70816501-edb9-4740-a16c-6a5efbc05d84

我理解这个限制，我将不得不减少属性的数量。以下是我的问题：

1.  我是否在 crm 4 组织中更改它？我要更改我导入的解决方案吗？

2.  我怎么知道我必须减少多少？

3.  我怎么知道在哪个实体中做呢？如何找到 ID 为：70816501-edb9-4740-a16c-6a5efbc05d84 的实体？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T14:38:57.163

转换很棘手，因为您通常需要在上线时再次转换 4.0 以获取最新数据。

1.  由于上述原因，我建议您在 CRM 4 组织中进行更改，这样您就不会在上线转换期间遇到问题。
2.  select * from MetadataSchema.Attribute a where a.EntityId = 'guid'
3.  select * from MetadataSchema.Entity where EntityId = 'guid'

# c# - 制作一个即使未列出也始终获得授权的角色

> ID：11441534
> 
> 赞同：4
> 
> 时间：2012-07-11T21:09:48.563
> 
> 标签：c#, asp.net-mvc-3, roleprovider

在 MVC3 中，有没有办法让角色（*SuperAdmin*）即使没有在角色列表中明确列出，也**总是被授权？**

例如，使用此标记...

`[Authorize(Roles="Accounting")]`

即使我不是*会计*角色，作为*超级管理员*，有没有办法获得此操作的授权？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:27:54.163

我强烈建议您阅读[保护您的 ASP.NET MVC 3 应用程序](http://blogs.msdn.com/b/rickandy/archive/2011/05/02/securing-your-asp-net-mvc-3-application.aspx)。

首先，创建您的`AnonymousAttribute`：

```
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, 
                AllowMultiple = false,    
                Inherited = true)]
public sealed class AllowAnonymousAttribute : Attribute 
{ 
} 
```

其次，创建您的`GlobalAuthorize`属性：

```
public sealed class GlobalAuthorize : AuthorizeAttribute
{
    public override void OnAuthorization(AuthorizationContext filterContext)
    {
        bool bypassAuthorization = 
            filterContext.ActionDescriptor
                         .IsDefined(typeof(AllowAnonymousAttribute), 
                                    true)
            || filterContext.ActionDescriptor
                            .ControllerDescriptor
                            .IsDefined(typeof(AllowAnonymousAttribute),
                                       true)
            || (filterContext.RequestContext
                            .HttpContext
                            .User != null
                && filterContext.RequestContext
                                .HttpContext
                                .User
                                .IsInRole("SuperAdmin"));

        if (!bypassAuthorization)
        {
            base.OnAuthorization(filterContext);
        }
    }
} 
```

第三，在您的全局过滤器（global.asax）中注册 GlobalAuthorize：

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
  filters.Add(new GlobalAuthorize());
} 
```

现在所有控制器都需要用户登录才能访问。控制器或控制器方法可以通过 AllowAnonymous 属性被允许匿名访问。此外，具有超级管理员角色的用户允许使用所有方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:22:18.120

您可以`AuthorizeAttribute`在`AuthorizeCore`方法中创建您可以实现额外逻辑的自定义位置。

一个没有正确错误处理的简单示例：

```
public class AuthorizeSuperAdminAttribute : AuthorizeAttribute
{
     protected virtual bool AuthorizeCore(HttpContextBase httpContext) 
     {    
         IPrincipal user = httpContext.User; 
         if (user.Identity.IsAuthenticated && user.IsInRole("SuperAdmin"))
                return true;

         return base.AuthorizeCore(httpContext);    
     }
} 
```

然后您可以在您的操作中正常使用它：

```
[AuthorizeSuperAdmin(Roles="Accounting")]
public ActionResult MyAction()
{
} 
```

# jquery - 动态表单验证 jquery 验证插件

> ID：11441536
> 
> 赞同：1
> 
> 时间：2012-07-11T21:10:02.540
> 
> 标签：jquery, forms, validation, jquery-plugins

验证与表单和验证插件作为静态表单一起工作。我需要将表单插入页面，然后对其进行验证 - 不适合我。

```
 $(document).ready(function(){
   var validator = $("#loginForm").validate({
       // rules for field names
       rules: {
            cname: "required", 
            cpass: "required"
    },
    // inline error messages for fields above
    messages: {

            cname: "required", 
            cpass: "required"
    }
}); // for validating the form

$("#loginForm").validate({
  submitHandler: function(form) { //Only runs when valid
      form.submit();
  }
});   

  var htmlStr = '<form class="cmxform" id="loginForm" method="get" action="https://www.myURL.com/login.php"><p><label for="cname">Name</label><em>*</em><input id="cname" name="name" size="25" class="required" minlength="2" /></p><p><label for="cpass">Password</label><em>*</em><input type="password" id="cpass" name="pass" size="25" class="required" minlength="2" /></p><input id="mySubmit" class="submit" type="submit" value="Submit"/></form>';

  function createForm(){
  // fires with body onload
  $("#login-container").html(htmlStr);
     }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:39:02.817

您需要使用`delegate`jquery 的功能使其与动态元素一起使用:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T22:42:31.297

将 html 添加到页面后，将验证代码移至右侧。由于您的函数`$("#loginForm")`中可能不存在，因此该区域中的任何内容都不会运行。您可能希望您的代码如下所示：`document.ready``validate`

```
function createForm(){
  // fires with body onload
  $("#login-container").html(htmlStr);

  var validator = $("#loginForm").validate({
     // rules for field names
     rules: {
            cname: "required", 
            cpass: "required"
    },
    // inline error messages for fields above
    messages: {
            cname: "required", 
            cpass: "required"
    }
  });  
} 
```

您遇到的其他问题 - 无需手动提交表单`submitHandler`- 如果表单有效，验证器将为您执行此操作。此外，根据您设置消息对象的方式，实际的错误消息将是“必需”一词。不确定这是不是你想要的......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T00:53:20.227

```
var htmlStr = '<form class="cmxform" id="loginForm" method="post" action="https://www.myURL.com/login.php"><p><label for="cname">Name</label><em>*</em><input id="cname" name="name" size="25" class="required" minlength="5" /></p><p><label for="cpass">Password</label><em>*</em><input type="password" id="cpass" name="pass" size="25" class="required" minlength="8" /></p><input id="mySubmit" class="submit" type="submit" value="Submit"/></form>';

function createForm(){
     $("#login-container").html(htmlStr);
     var validator = $("#loginForm").validate({
       });  
 };

 <body onload="createForm()">

<div id="login-container">&nbsp;</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T21:05:22.903

我发现以这种方式添加规则对我不起作用，可能是因为在插入的 HTML 中概述了规则，而不是稍后使用 var validator = (规则) 添加规则。当这些内联规则是插入的 HTML 的一部分时，它们起作用的唯一方法是让我添加一个函数，就像添加规则一样，但没有添加任何规则。代码如下。表单是动态生成的，动态插入的，并且规则必须是动态的。我采取的这种方法是正确的，还是只是碰巧奏效了？

```
 var htmlStr = '<form class="cmxform" id="loginForm" method="post" action="https://www.myURL.com/login.php"><p><label for="cname">Name</label><em>*</em><input id="cname" name="name" size="25" class="required" minlength="5" /></p><p><label for="cpass">Password</label><em>*</em><input type="password" id="cpass" name="pass" size="25" class="required" minlength="8" /></p><input id="mySubmit" class="submit" type="submit" value="Submit"/></form>';

  function createForm(){
   $("#login-container").html(htmlStr);
   var validator = $("#loginForm").validate({
     });  
  }; 
```

# mysql - 每行动态sql

> ID：11441538
> 
> 赞同：7
> 
> 时间：2012-07-11T21:10:22.710
> 
> 标签：mysql

我有一个代表书店之类的数据库。有一个表包含书籍可以在其中的类别。一些类别是简单地使用另一个包含类别-项目关系的表来定义的。但也有一些类别可以通过编程方式定义——可以使用查询定义特定作者的类别（SELECT item_id FROM items WHERE author = "John Smith"）。所以我的类别表有一个“查询”列；如果它不为空，我使用它来获取类别中的项目，否则我使用 category_items 表。

目前，我让应用程序（PHP 代码）做出此决定，但这意味着当我们遍历所有类别时需要进行大量单独的查询。有没有办法将此动态 SQL 合并到连接中？就像是：

```
SELECT c.category, IF(c.query IS NULL, count(i.items), count(EXECUTE c.query)
FROM categories c
LEFT OUTER JOIN category_items i
ON c.category = i.category 
```

EXECUTE 需要一个准备好的语句，但我需要为每一行准备一个不同的语句。此外，EXECUTE 不能用于表达式，它只是一个顶级语句。建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T00:27:36.910

当您想按出版商列出书籍时会发生什么？国家？语？您必须将它们全部放入一个“category_items”表中。您将如何选择要执行的动态查询？查询中的查询方法不起作用。

我认为您的“类别”概念过于宽泛，导致 SQL 过于复杂。我将替换“类别”以仅代表“类型”（用于书籍）。流派在它们自己的表中定义，并且 item_genres 将它们连接到 items 表。Books-by-author 和 books-by-genre 应该只是应用程序级别的单独查询，而不是尝试在数据库/SQL 级别使用相同（某种）查询来完成它们。（如果您有音乐和书籍，它们可能不应该全部存储在一个“项目”表中，因为它们是不同的概念......有不同的流派、作者与艺术家等）

我知道这并不能真正以您想要的方式解决您的问题，但我认为您不尝试那样做会更快乐。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T21:27:06.983

这是我最终在 PHP 客户端中解决这个问题的方法。

我决定只保留 category_items 表中的成员资格，并在提交期间使用动态查询来更新此表。

这是我的脚本中调用的函数，用于在提交或更新期间更新项目的类别。它需要一个用户选择的类别列表（只能从没有动态查询的类别中选择），并使用这个和动态查询来确定项目当前所在的类别与那些类别之间的区别它应该在其中，并根据需要插入/删除以使它们同步。（请注意，我的数据库中的实际表名与我的问题中的不同，我使用了一些通用术语。）

```
function update_item_categories($dbh, $id, $requested_cats) {
    $data = mysql_check($dbh, mysqli_query($dbh, "select id, query from t_ld_categories where query is not null"), 'getting dynamic categories');
    $clauses = array();
    while ($row = mysqli_fetch_object($data))
        $clauses[] = sprintf('select %d cat_id, (%d in (%s)) should_be_in',
            $row->id, $id, $row->query);
    if (!$requested_cats) $requested_cats[] = -1; // Dummy entry that never matches cat_id
    $requested_cat_string = implode(', ', $requested_cats);
    $clauses[] = "select c.id cat_id, (c.id in ($requested_cat_string)) should_be_in
                  from t_ld_categories c
                  where member_type = 'lessons' and query is null";
    $subquery = implode("\nunion all\n", $clauses);
    $query = "select c.cat_id cat_id, should_be_in, (member_id is not null) is_in
              from ($subquery) c
              left outer join t_ld_cat_members m
              on c.cat_id = m.cat_id
              and m.member_id = $id";
    // printf("<pre>$query</pre>");
    $data = mysql_check($dbh, mysqli_query($dbh, $query), 'getting current category membership');
    $adds = array();
    $deletes = array();
    while ($row = mysqli_fetch_object($data)) {
        if ($row->should_be_in && !$row->is_in) $adds[] = "({$row->cat_id}, $id)";
        elseif (!$row->should_be_in && $row->is_in) $deletes[] = "(cat_id = {$row->cat_id} and member_id = $id)";
    }
    if ($deletes) {
        $delete_string = implode(' or ', $deletes);
        mysql_check($dbh, mysqli_query($dbh, "delete from t_ld_cat_members where $delete_string"), 'deleting old categories');
    }
    if ($adds) {
        $add_string = implode(', ', $adds);
        mysql_check($dbh, mysqli_query($dbh, "insert into t_ld_cat_members (cat_id, member_id) values $add_string"),
            "adding new categories");
    }
} 
```

# javascript - 如何在经过身份验证的页面上测试 javascript 隐藏/显示行为？

> ID：11441540
> 
> 赞同：3
> 
> 时间：2012-07-11T21:10:38.350
> 
> 标签：javascript, ruby-on-rails, twitter-bootstrap, capybara, jasmine

**上下文：**当用户登录并查阅他自己的个人资料时，他可以单击他的头像，此单击会显示一个下拉菜单，其中包含“上传头像”选项。当用户单击此选项时，它会打开一个带有表单的模式，用于为头像上传新图像。我正在使用 twitter bootstrap 来处理下拉列表（和模式）。

当然，我想测试一下。但我不知道怎么做。

让我们专注于下拉功能，因为模态测试可能几乎相同：

起初我在考虑使用 capybara，但无法通过其 CSS 属性`display: none`或`display: block`. 我读到有些人建议检查像`hidden`水豚这样的课程。但在这种情况下，因为我使用的是 Twitter Bootstrap，所以只有一个`dropdown`例子。

而且我不想修改引导行为只是为了能够测试它，这将是一种气味。

这是我的 rspec 套件的示例：

```
describe 'should display a dropdown menu' do
   let(:user) { FactoryGirl.create :user }
   before do
     sign_in_as user
     # I have routes just like that: /1/firstname-lastname
     visit(profile_path(id: user.id, first: user.first_name.downcase, last: user.last_name.downcase))

     click_link 'avatar-dropdown'
   end
   it { should have_css('.dropdown-menu', visible: true) }
   describe 'with an upload link' do [...] end
end 
```

HTML 看起来像：

```
<div class="dropdown" id="avatar-menu">
  <a class="dropdown-toggle" id="avatar-dropdown" data-toggle="dropdown" href="#avatar-menu">
    <%= @user.avatar %>
  </a>
  <ul class="dropdown-menu">
    <li><a class="upload-avatar" href="#">Upload an image</a></li>
  </ul>
</div> <!-- #upload-menu --> 
```

当然，它不适用于`visible: true`，因为`display: none`是由 twitter bootstrap 的 CSS 设置的。

然后，我想用 Jasmine 测试这种行为（潜入的好时机），但如果我这样做了，我应该如何注册用户？我不知道它是否共享测试数据库，但我认为我不能使用工厂女孩在 Jasmine 中生成新用户，可以吗？我什至不知道访问 Jasmine 中的注册页面（如果可能的话？）并提交表格是否可以解决问题。与认证相同。

我如何测试这些行为？我应该使用水豚（有什么技巧吗？）还是茉莉花（那该怎么办？）

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-12T06:45:59.407

好吧，我已经设法让水豚工作了。我不确定它是否适用于其他所有情况，但在我的情况下它有效：

我们需要通过传递给Capybara 来激活[Selenium](http://www.opinionatedprogrammer.com/2011/02/capybara-and-selenium-with-rspec-and-rails-3/)或`js: true``describe``it`

```
describe 'should display a dropdown menu', js: true do
   let(:user) { FactoryGirl.create :user }
   before do
     sign_in_as user
     # I have routes just like that: /1/firstname-lastname
     visit(profile_path(id: user.id, first: user.first_name.downcase, last: user.last_name.downcase))

     click_link 'avatar-dropdown'
   end
   it { should have_css('.dropdown-menu', visible: true) }
   describe 'with an upload link' do [...] end
end 
```

这样，capybara 似乎真的会检查属性是否可见。每次我运行测试时它都会启动 Firefox，这可能会非常痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T17:52:13.803

> 起初我在考虑使用 capybara，但无法通过其 CSS 属性 display: none 或 display: block 检查元素是否可见

你能不能做这样的事情：

```
page.has_xpath?("/xpath/here[contains(@style, 'display: block')]") 
```

其中 'display: none' 将在不可见时替换 'display: block'。

# python - 如何将 apt-get 安装到我的 virtualenv？

> ID：11441546
> 
> 赞同：30
> 
> 时间：2012-07-11T21:11:00.557
> 
> 标签：python, virtualenv, apt-get

这是可能的，当然。

例如 - 我可以像这样下载 python-dbus： $ sudo apt-get download python-dbus

但是接下来我应该做什么，在我当前的 virtualenv 中使用这个 .deb 包？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-12-04T18:59:22.443

如果你真的需要这样做，你可以将全局安装的文件直接复制到你的 virtualenv 中。例如，我无法让 pycurl 工作，因为没有安装所需的库，但是安装`apt-get install python-pycurl`了。所以我做了以下事情：

```
sudo apt-get install python-pycurl
cp /usr/lib/python2.7/dist-packages/pycurl* ~/.virtualenvs/myenv/lib/python2.7/site-packages/ 
```

安装说它正在将它添加到/usr/lib/python2.7。因此，在查看了将它们复制到我的 virtualenv 中的文件之后，我在该目录中查找了带有 pycurl 的站点包或 dist 包。您还必须将任何可执行文件从 bin 复制到 virtualenv 的 bin 目录中。

此外，`pip install -r requirements.txt`在那里运行一个成功找到的 pycurl 并跳过它，就好像我通过 pip 安装它一样。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-11T21:59:16.623

你为什么想做这个？重点是避免做那样的事情......

```
virtualenv whatever
cd whatever
bin/pip install dbus-python 
```

您还可以选择指定`--no-site-packages`to`virtualenv`以使其更加独立。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-05T03:17:22.207

首先安装 dbus 开发库（你可能需要一些其他的开发库，但这就是我所需要的）

```
sudo apt-get install libdbus-1-dev libdbus-glib-1-dev 
```

接下来，激活您的 virtualenv，运行以下命令。它会失败，但没关系。

```
pip install dbus-python 
```

最后，进入您的 virtualenv 的构建目录并以非 Python 方式安装它。

```
cd $VIRTUAL_ENV/build/dbus-python
chmod +x configure
./configure --prefix=$VIRTUAL_ENV
make
make install 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-11-28T08:59:08.850

另一种解决方案是全局安装，然后允许 virtualenv 能够看到它。例如，假设我们要为 Python 3 安装 matplotlib：

1.  `sudo apt update`# 先更新
2.  `sudo apt install python3-matplotlib` # 全局安装
3.  `sudo pip3 install -U virtualenv` # 使用 pip3 为 Python 3 安装 virtualenv
4.  `virtualenv --system-site-packages -p python3 ./venv`#system-site-packages 选项允许 venv 查看所有全局包，包括 matplotlib
5.  `source ./venv/bin/activate`#激活 venv 以在 virtualenv 中使用 matplotlib
6.  `deactivate` # 在你使用完 virtualenv 之前不要退出

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-12-19T15:13:04.413

要在现有虚拟环境中包含系统站点包，请打开配置文件： `<PATH_TO_YOUR_VENV_FOLDER>/pyvenv.cfg`

并更改`false`为`true``include-system-site-packages`

```
include-system-site-packages = true 
```

保存并重新加载您的虚拟环境。

*（在 Raspbian GNU/Linux 10（buster）上使用 virtualenv 20.2.2 进行测试，以将安装了 apt 的 python3-pyqt5 拉入我的虚拟环境中）*

如果是针对新环境@Joshua Kan使用带有命令的标志的[答案](https://stackoverflow.com/a/53515591/2974621)可能就是您想要的。`--system-site-packages``venv`

# php - 需要帮助使用 MAMP 调试 CakePHP 与 MySQL 的连接，错误：数据库中缺少表（似乎没有原因）

> ID：11441548
> 
> 赞同：1
> 
> 时间：2012-07-11T21:11:10.433
> 
> 标签：php, mysql, ajax, cakephp, mamp

我之前问过一个问题： [CakePHP 中缺少数据库表，我已经按照约定尝试了一切](https://stackoverflow.com/questions/11434810/missing-database-table-in-cakephp-ive-followed-the-conventions-and-tried-every)

从那以后发现我的问题不在于我的模型或控制器，而在于我与 MAMP 或 MySQL 服务器的连接。重要的是要注意，我确实有 2 个模型/控制器可以正常使用数据库。只是现在我添加了另一个控制器/模型，当我尝试连接时，Cake 给出了错误：缺少数据库表

错误：在数据源默认值中找不到模型投票的表投票。

我已经调试了两天，并在另一台机器上复制了它，所以我确定我的模型/控制器设置正确。

我已将问题缩小到几件事：1\. 我的 Cake 配置中有一些东西使用旧模式（我不知道这会如何发生）2\. MAMP 连接出现问题新表

有人对调试或解决此问题有任何建议吗？太感谢了。

威尔斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T23:42:24.880

检查所有表是否具有相同的引擎。我曾经遇到过问题，因为我在 MyISAM 上有一些表，而在 InnoDB 上有一些新表（由 MySQL Workbench 生成）

希望能帮助到你

# android - 如何区分 Android 应用程序是否在 Amazon Kindle Fire 上运行？

> ID：11441551
> 
> 赞同：15
> 
> 时间：2012-07-11T21:11:20.740
> 
> 标签：android, kindle-fire

我最近被亚马逊移动应用分发门户拒绝了我的应用，理由是 Menu->“Rate the App”选项重定向到 Google Play 商店。

为了被接受，它应该重定向到亚马逊应用商店，下载 URL 必须是[http://www.amazon.com/gp/mas/dl/android?p=packagename](http://www.amazon.com/gp/mas/dl/android?p=packagename)这当然是有意义的。

所以我需要类似的东西：

```
String url = isKindle 
    ? "http://www.amazon.com/gp/mas/dl/android?p=packagename" 
    : "https://play.google.com/store/apps/details?id=packagename"; 
```

问题是：如何区分应用程序是在 Kindle Fire 上运行还是在“原生”Android 系统上运行？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-11T21:15:07.487

你可以阅读这些：

```
android.os.Build.MANUFACTURER 
android.os.Build.MODEL 
```

在 Kindle Fire 上，这些返回值“Amazon”和“Kindle Fire”。

[http://developer.android.com/reference/android/os/Build.html](http://developer.android.com/reference/android/os/Build.html)

这应该足以让您的应用确定它在 Kindle Fire 上运行。

* * *

**更新：**

以上适用于第一代 Kindle Fire。

较新型号的 Kindle Fire 具有不同的 android.os.Build.MODEL 值。

[https://developer.amazon.com/sdk/fire/specifications.html](https://developer.amazon.com/sdk/fire/specifications.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-05-31T17:31:40.043

好消息！[显然](https://forums.developer.amazon.com/forums/thread.jspa?messageID=3679)，亚马逊商店的最新版本终于[`PackageManager.getInstallerPackageName()`](http://developer.android.com/reference/android/content/pm/PackageManager.html#getInstallerPackageName%28java.lang.String%29)与`"com.amazon.venezia"`Google Play 的`"com.android.vending"`.

较旧的应用程序仍会返回`null`，我还没有真正验证 API 或安装新商店然后升级旧应用程序是否会设置安装程序。但是安装一个新的应用程序并检查`/data/system/packages.xml`是否`installer`正确设置。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-18T01:38:30.300

请务必更新 Build.MODEL 检查以处理新的 Kindle Fire 设备。

*   KFOT = Kindle Fire
*   KFTT = Kindle Fire HD 7"
*   KFJWI = Kindle Fire HD 8.9" Wi-Fi
*   KFJWA = Kindle Fire HD 8.9" WAN

[这些列在https://developer.amazon.com/sdk/fire/specifications.html](https://developer.amazon.com/sdk/fire/specifications.html)的图表底部

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-16T02:14:44.687

检测 Kindle Fire 是解决方案的一部分，但不是整个解决方案。[该线程](https://forums.developer.amazon.com/forums/thread.jspa?threadID=205&tstart=0)中的（当前）最后一篇文章似乎触及了“这是从亚马逊商店安装的”的核心——这很可能是 Kindle Fire，也可能不是！

<剪辑，稍作编辑>

确定应用程序是否在生产模式下通过 Appstore 安装的正确方法是使用`onSdkAvailable(boolean isSandboxMode)`方法。

[onSdkAvailable(boolean isSandboxMode) 方法](https://developer.amazon.com/sdk/in-app-purchasing/documentation/developer-guide.html)的文档。抽象的：

*   一旦您`PurchasingObserver`向`PurchasingManager`
*   此方法告诉您采购框架是在沙盒模式下运行测试数据，还是在生产模式下运行真实数据
*   如果您的应用是通过亚马逊客户端下载的，`isSandboxMode`将返回 false
*   初始化方法应该在`onStart()`生命周期方法中调用

在注册您的`PurchaseObserver`时，您会收到一个异步回调，`onSdkAvailable(Boolean isSanboxMode)`. 如果应用程序是通过亚马逊客户端下载的，那么`isSandboxMode`将始终返回 false。此代码将在生产模式下成功运行，但在开发/测试环境中，isSandboxMode 将始终返回 true，因为在测试环境中未通过 Amazon 客户端下载应用程序。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-11T21:15:32.577

我只会创建 2 个应用程序。一款适用于安卓。一个用于 Kindle。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-22T01:29:50.813

您可以包含一个指向一般网页的链接，然后该网页可以将流量重定向到 Amazon AppStore 或 Google Play。

例如，您可以包含链接 www.yourwebsite.com/getapp，然后将流量重定向到 Google Play 或 Amazon。

亚马逊不太可能接受 Google Play 链接，即使背后有逻辑。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-21T10:25:14.350

实际上，您可以完全跳过检查，只需链接到 market://details?id=packagename

# macos - 在 OS X Lion 中更改 WiFi 登录页面的默认浏览器

> ID：11441558
> 
> 赞同：1
> 
> 时间：2012-07-11T21:11:52.820
> 
> 标签：macos, osx-lion, wifi

在 OS X Lion 中通过登录页面连接到 WiFi 网络时，将打开一个弹出的 Safari 浏览器窗口，其中包含登录页面。

有什么办法可以更改用于此的浏览器？（例如，更改为 chrome 将使我能够保存 WiFi 登录凭据）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T03:17:14.210

你应该去 Safari -> 首选项 -> 常规。

选择 Chrome 作为您的默认浏览器。这应该（希望）改变登陆页面。

# javascript - 使用ajax提交具有未知数量字段的html表单

> ID：11441559
> 
> 赞同：0
> 
> 时间：2012-07-11T21:11:54.747
> 
> 标签：javascript, jquery, html, ajax, forms

我有一个由成对的文本字段组成的表单。用户可以根据需要创建任意数量的配对并填写字段。字段行被添加到表的底部。以下是格式示例：

```
<form id="dataForm">
<table id="textTable">
<tbody>
<tr>
  <td><h2>Dancer</h2></td>
  <td><h2>Place</h2></td>
</tr>
<tr>
  <td><input type="text" name="Dancer0" size="15" id="Dancer0"></td>
  <td><input type="text" name="Place0" size="15" id="Place0"></td>
</tr>
<tr>
  <td><input type="text" name="Dancer1" size="15" id="Dancer1"></td>
  <td><input type="text" name="Place1" size="15" id="Place1"></td>
</tr>
</tbody>
</table>
<input type="button" id="newRow" value="New Row" accesskey="/" onclick="moreFields();">
<input type="button" value="Update" name="Submit" onclick="submitForm(this.form);">
</form> 
```

我遇到的麻烦是让表单使用 ajax 正确提交到外部 php 页面。这是我现在正在使用的功能：

```
function submitForm(form)
{
jQuery.ajax({
    type: "POST",
    url: <?php echo '"'.dirname(curPageURL()).'/ResultsUpdater.php"' ?>,
    data: form.serialize(),
    success: function(msg){
        alert(msg);
    }
});
return false;
} 
```

在其他示例中，我看到他们使用 $ 来表示 jQuery，它会放在“form”之前：但是我`$(form).serialize()`的`$.ajax({...`服务器不喜欢`$`. 我也试过`jQuery.form.serialize()`了，但这也不起作用。我在控制台中得到的错误总是沿着`"TypeError: 'undefined' is not an object (evaluating 'jQuery.form.serialize')"`

如果我可以将一堆键值对提交给 php 文件（据我所知，serialize() 就是这样做的），那就太好了。

[您可以在这里](http://www.marxon13.com/WMSO/TestComp/Updater/ResultsIndex.php)试用表格

只需选择其中一项即可查看表单。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:18:45.613

你可以这样做：

```
jQuery("#dataForm").serialize(); 
```

我已经在您引用的页面上成功尝试过。

由于`$`在您的页面上未定义，我最好的猜测是您加载了一些重置`$`为未定义的脚本。那么最好的方法是回退到使用`jQuery`，因为`$`它只是`jQuery`.

# wpf - ObservableCollection 绑定到 Listview

> ID：11441560
> 
> 赞同：0
> 
> 时间：2012-07-11T21:11:55.950
> 
> 标签：wpf, binding, constructor, observablecollection

我真的不明白为什么以及在后台发生了什么，所以请帮助我。我有一个简单的 ListView：

```
<ListView Height="100" HorizontalAlignment="Left" Margin="67,84,0,0" ItemsSource="
{Binding Path=ListBinding}" Name="listView1" VerticalAlignment="Top" Width="351" /> 
```

和一个按钮：

```
<Button Content="Button" Height="23" HorizontalAlignment="Left" Margin="162,41,0,0"
 Name="button1" VerticalAlignment="Top" Width="75" Click="button1_Click" /> 
```

我将数据上下文设置为我的“viewmodel”类：

```
 InitializeComponent();

        this.DataContext = new VM1(); 
```

现在，如果我在 VM1 的构造函数中初始化 obscollection，则当我使用 button1_click 函数填充 ListBinding 时，绑定将起作用：

```
private void button1_Click(object sender, RoutedEventArgs e)
{
    (this.DataContext as VM1).Do();
} 
```

* * *

```
public VM1()
{
   ListBinding = new ObservableCollection<string>();
}

public void Do()
{
    ListBinding.Add("VM1 works 1");
    ListBinding.Add("VM1 works 2");
} 
```

但是如果我在 Do() 函数中初始化它，它不会：

```
public VM1()
{ }

public void Do()
{
   ListBinding = new ObservableCollection<string>();
   ListBinding.Add("VM1 NOT works 1");
   ListBinding.Add("VM1 NOT works 2");
} 
```

我想这个问题的答案可能是一个班轮，我想了解“为什么”。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:33:36.017

您没有列出 ListBinding 属性的代码。属性设置器必须调用 NotifyOfPropertyChange，以便更新绑定。ObservableCollection 会自动更新列表的内容更改，而不是整个列表对象。

希望有帮助。

编辑：这是该属性的代码：

```
 private ObservableCollection<string> _listBinding // backing field
    public ObservableCollection<string> ListBinding
    {
        get { return _listBinding; }
        set {
            _listBinding = value;
            NotifyOfPropertyChange("ListBinding"); // let the bindings update
        }
    } 
```

# twitter - Twitter API，转发操作后出现 404 错误

> ID：11441562
> 
> 赞同：0
> 
> 时间：2012-07-11T21:12:07.167
> 
> 标签：twitter, twitter-oauth

我可以成功发布状态，但我被转推卡住了。

我正在尝试使用 Twitter API 和 tmhOauth 转发一条推文，并带有以下代码段：

```
$tmhOAuth = new tmhOAuth(array( 'consumer_key'    => YOUR_CONSUMER_KEY,
            'consumer_secret' => YOUR_CONSUMER_SECRET,
            'user_token'      => $atoken1,
            'user_secret'     => $atoken2, ));
$code = $tmhOAuth->request('POST', $tmhOAuth->url('1/statuses/retweet'),
        array('id' => '223136515088318466' )); 
```

但是这段代码给出了以下错误：

```
[errors] => Array
    (
        [0] => Array
            (
                [message] => Sorry, that page does not exist
                [code] => 34
            )

    ) 
```

但我可以看到状态存在： [https ://twitter.com/Sekban_iCemil/status/223136515088318466](https://twitter.com/Sekban_iCemil/status/223136515088318466)

我很确定消费者密钥和秘密是正确的，并且用户令牌和秘密是由用户授权的。

我想念什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T23:52:08.617

您的网址不是`http://api.twitter.com/1/statuses/retweet`but `http://api.twitter.com/1/statuses/retweet/223136515088318466.json`。它写在文档中：[https ://dev.twitter.com/docs/api/1/post/statuses/retweet/%3Aid](https://dev.twitter.com/docs/api/1/post/statuses/retweet/%3Aid)

# php - 使用 PayPal Payments PRO 一键付款

> ID：11441564
> 
> 赞同：-2
> 
> 时间：2012-07-11T21:12:12.127
> 
> 标签：php, api, paypal

我正在处理一个事件管理器项目，我想这样做，所以当用户创建他们的帐户时，他们将不得不接受 PayPal 计费协议。一旦发生这种情况，我希望他们能够在活动中单击购买，并立即从他们的 PayPal 帐户中收取费用。我已经准备好使用 PayPal Payments Pro，只需要让它工作。

这是 PayPal 的可能性，还是我必须走不同的路线？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T15:21:27.137

我发现您可以在注册期间使用 SetCustomerBillingAgreement API 操作来设置计费协议。然后在收取付款时，您可以使用 DoReferenceTransaction API 操作并使用在之前操作中返回的计费协议 ID。

# backbone.js - 绑定视图方法以动态更改视图的 HTML 类

> ID：11441567
> 
> 赞同：0
> 
> 时间：2012-07-11T21:12:27.027
> 
> 标签：backbone.js, backbone-views

```
var foo = Backbone.View.extend({    
  tagName: 'div',
  className: 'unselected',
  events: {
    'click div' : 'select'
  },  
  initiate: function () {
    ._bindall(this, 'render' , 'select' );    
    this.render();
  },
  render: function () {
    $(this.el).html(_.template($("#template").html(),{...});
    return this;
  },
  select: function () {
    if ( this.className == 'selected' ) {
      this.className = 'unselected';
    }
    else {
      this.className = 'selected';
    }
    this.render();
  }
}); 
```

当我单击此 div 框时，className 已正确更新，但 html 未更新。因此，视图的 className 将更改为“selected”，但是当我检查网页上的 div 框元素时，它仍然显示为“class="unselected"。” 我也希望在单击时更新 html。

建议或指向教程/文档的链接将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:20:47.433

`Backbone.View`s 只是一个方便的占位符——*不是*实际的 DOMElements。您需要`this.el`通过以下方式进行更新：

```
select: function () {

  if ( this.className == 'selected' ) {
    this.className = 'unselected';
  }
  else {
    this.className = 'selected';
  }
  this.el.className = this.className;
  this.render();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T00:18:59.123

您可能想要做的是在 el 选择器本身上执行此操作，并使用链接的 jquery toggleClass 调用。您可以在一行中完成所有操作：

```
select : function() {
    this.$el.toggleClass('selected').toggleClass('unselected');
} 
```

快捷方便...

# symfony - 从外部系统验证到 Symfony 2.0

> ID：11441570
> 
> 赞同：1
> 
> 时间：2012-07-11T21:12:43.693
> 
> 标签：symfony, saml-2.0

我对 Symfony2 比较陌生。我已经使用 Symfony2 的内置安全机制构建了一个系统，通过对数据库中的用户进行身份验证。让我们称这个系统为“B”

在使用相同凭据的不同服务器上的 asp.net 中有一个应用程序（我已经从该系统复制了 users 表）。让我们将此系统称为“A”。用户是否可以单击 ASP 应用程序中的链接将他们重定向到 Symfony2 应用程序并自动验证他们而无需重新输入登录凭据？

我对系统“A”的编程控制有限。是否有可能有一个单一/静态/预定义的加密用户凭据，可以从系统 A 用于对系统 B 上的用户进行身份验证（当然提供用户类型作为数据参数，以便我可以将系统 B 中的用户限制为他/她授权的任务）。一旦通过身份验证，用户应该能够直接与 symfony2 应用程序交互，就像他们使用系统 B 的登录页面登录一样。

更清楚地说，这是事件的流程：

1.  用户登录到 ASP.NET 系统。
2.  用户单击链接以重定向到 Symfony2 应用程序
3.  用户自动通过身份验证，并根据他对 Symfony2 应用程序的角色获得访问权限

请注意，我无法在 Symfony 服务器上维护用户数据库。我只会有关于可用的不同用户类型的信息。

我查看了 Symfony2 方法的自定义身份验证提供程序，但不确定它是否能解决将客户端/用户完全重定向到 Symfony2 应用程序的目的。它看起来更像是一种 Web 服务身份验证方法，但我可能错了。

SAML 是实现这一目标的更好选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T22:34:09.983

首先，这是一个已解决的问题。诸如[OAuth](http://oauth.net/)之类的东西的存在是有原因的。我建议在尝试制定自己的解决方案（并处理安全后果）之前先研究一下。

但要回答你的问题：

在我看来，如果不能更改系统“A”中的某些内容，就没有安全的方法可以做到这一点。不知何故，Symfony 应用程序需要能够从系统“A”获得一些高度不可猜测的哈希令牌，以便它可以对其进行身份验证。其他任何事情都是不安全的。

理想情况下，您应该在系统“A”上创建将用户发送到 Symfony 应用程序的表单，从用户的用户名和会话或其他内容创建一个哈希，并在将用户重定向到 Symfony 应用程序时将其与用户一起发送（即在 URL参数：类似`http://symfony-app.com/login?token=[the really long, un-guessable hash]`）。系统“B”会将该哈希值存储在数据库中一段有限的时间，并且您的 Symfony 应用程序将针对该哈希值进行身份验证。

# vba - 如何获得列中的第一个非空单元格？

> ID：11441572
> 
> 赞同：2
> 
> 时间：2012-07-11T21:12:49.357
> 
> 标签：vba, excel

如果一个单元格是空的，我希望它查看上面的单元格。如果那个是空的，它将在上面的单元格中查找，直到找到一个非空单元格。当它发生时，它应该返回它。这将是一个名为`loopUp`. 然后，当我在这样的单元格公式中使用它时：`=loopUp(D24)`，并且范围 D18:D24 为空，它将显示 D17 中的内容。

这是一些伪：

```
Function loopUp(Cell)
    while Cell is empty
        Cell becomes cell above
    return cell 
```

我是 VBA 新手。我坚持的事情是如何传递一个单元格的地址而不是它的值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T21:35:21.133

遵循 Siddharth 的最后建议，这里有一种解决方法。

```
Function LoopUp(rng As Range) As Variant

Dim intCnt As Long

LoopUp = "Nothing found"

For intCnt = rng.Row To 1 Step -1
    If Not IsEmpty(Cells(intCnt, rng.Column)) Then
        LoopUp = Cells(intCnt, rng.Column)
        Exit For
    End If
Next

End Function 
```

**更新**

这可能是一个更好、更干净、更容易理解的解决方案。我测试了一下，但有人可能会破坏它！

```
Function LoopUp(rng As Range) As Variant

If Not IsEmpty(rng) Then LoopUp = rng
Else
    If rng.End(xlUp).Row = 1 Then LoopUp = "Nothing found" Else LoopUp = rng.End(xlUp)
End If 

End Function 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T21:15:55.687

```
Function LoopUp(rng as Range)
    With rng.Cells(1)
        If Len(.Value) > 0 Then
            Lookup = .Value
        Else
            LoopUp = .End(xlUp).Value
        End If
    End With
End Function 
```

编辑：有一些讨论如果在传递的 Range 参数上方没有“非空”单元格会发生什么。由于 OP 没有指定在这种情况下应该发生什么，这只会返回一个空响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T21:34:33.147

UDF 将如下所示：

```
Function loopUp(Cell)
  Do While IsEmpty(Cell)
    Set Cell = Cell.Offset(-1)
  Loop
  loopUp = Cell
End Function 
```

请注意，仅当 Cell 本身发生更改时才会重新计算该函数，而不是当您更改 Cell 上方的范围（函数扫描）时，为了解决这个问题，添加第二个虚拟参数，该参数应设置为您想要函数的范围监视要重新计算（为简单起见，可能是整个列）。

# c++ - Qt 上的分段错误

> ID：11441574
> 
> 赞同：0
> 
> 时间：2012-07-11T21:12:57.203
> 
> 标签：c++, qt, segmentation-fault

我正在使用 Qt Creator 开发一个 OpenGL 程序，然后发生了一个非常奇怪的事实。

我的程序正在运行，但现在不行了。我没有对其进行任何更改。可以肯定的是，现在我使用的是旧版本。它也不再起作用了。因此，我决定调试我的应用程序并意识到发生了 Segfault。我`qDebug() <<(...)`在主函数的第一行写了一个，但屏幕上什么也没有出现。

由于巨大的静态分配，我曾经遇到过类似的段错误（没有执行任何操作）。我在我的代码中寻找了类似的问题，但无法找到它。

有人知道发生了什么吗？

我将 QtCreator 与 Qt 4.7 和 Ubuntu 12.04 一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:52:37.110

我解决了它重新安装Qt。我相信我在更新某些程序时弄乱了它的库。希望它可以帮助其他有类似问题的人！感谢您的评论！

# c# - C# CRM QueryExpression LinkEntity 通过多个字段加入

> ID：11441575
> 
> 赞同：0
> 
> 时间：2012-07-11T21:12:59.320
> 
> 标签：c#, dynamics-crm, crm

是否可以在 CRM 中动态加入多个字段？

我的意思是在 SQL 中是这样的

```
select field1, field2, ..., fieldN
from ServiceAppointment
inner join bh_product
on bh_product.bh_contract = ServiceAppointment.bh_product.bh_contract
and bh_product.serviceid = ServiceAppointment.serviceid 
```

我正在尝试使用 queryexpression 提出上述问题，但我没有得到我想要的行为，而且我最终得到的记录比预期的要多。如果我事先知道第 2 个字段的值，我可以这样做，但是在运行时我不知道什么，并且查询必须加入 2 个字段。我的实际代码如下，减去我想不出的部分。

这行不通...我只希望有 2 条记录，但我得到了数百条记录...

```
var leContact = new LinkEntity(ServiceAppointment.EntityLogicalName, ActivityParty.EntityLogicalName, "activityid", "activityid", JoinOperator.Inner);
leContact.LinkCriteria = new FilterExpression();
leContact.LinkCriteria.AddCondition("partyid", ConditionOperator.Equal, contactId);
queryExpression.LinkEntities.Add(leContact);
result = GetServiceActivityList(queryExpression);

var leService = new LinkEntity(ServiceAppointment.EntityLogicalName, BrightHorizons.Shared.CRM.Interface.Service.EntityLogicalName, "serviceid", "serviceid", JoinOperator.Inner);
queryExpression.LinkEntities.Add(leService);
result = GetServiceActivityList(queryExpression);

// THIS IS THE PROBLEM    
    var leProduct = new LinkEntity(ServiceAppointment.EntityLogicalName, bh_product.EntityLogicalName, "bh_contract", "bh_contract", JoinOperator.Inner);
    var leProduct2 = new LinkEntity(ServiceAppointment.EntityLogicalName, bh_product.EntityLogicalName, "serviceid", "bh_service", JoinOperator.Inner);
    queryExpression.LinkEntities.Add(leProduct2);
    queryExpression.LinkEntities.Add(leProduct);
    result = GetServiceActivityList(queryExpression);

//THIS ALSO DOESNT WORK 
    var leProduct = new LinkEntity(ServiceAppointment.EntityLogicalName, bh_product.EntityLogicalName, "bh_contract", "bh_contract", JoinOperator.Inner);
    leProduct.AddLink(bh_product.EntityLogicalName, "bh_service", "bh_service", JoinOperator.Inner);
    queryExpression.LinkEntities.Add(leProduct);
    result = GetServiceActivityList(queryExpression); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T15:09:28.523

我不确定你是否看过它，但在 Linq 中连接真的很容易（[msdn 示例](http://msdn.microsoft.com/en-us/library/gg509017.aspx)）。我写过这样的 Contact-Accounts 连接：

```
var appContacts = (
from c in ctx.contacts
join a in ctx.accounts on c.contactid equals a.primarycontactid
where a.name.Contains("Contoso")
select new { c.contactid, c.fullname }).ToList()); 
```

N:N 上有[一个很好的线程在这里](https://stackoverflow.com/questions/9097921/crm-2011-nn-many-to-many-linq-issue)。

# google-drive-api - google docs/drive resource_id 是全球唯一的吗？

> ID：11441579
> 
> 赞同：5
> 
> 时间：2012-07-11T21:13:08.753
> 
> 标签：google-drive-api

当文件被重命名/修改/传递时，我们可以依赖 resource_id 的全局唯一性吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:27:56.657

是的，无论文件的元数据和/或内容如何更改，Google 云端硬盘文件的 ID 都将保持不变。

# memory-leaks - 匿名函数泄漏内存

> ID：11441584
> 
> 赞同：2
> 
> 时间：2012-07-11T21:13:22.930
> 
> 标签：memory-leaks, anonymous-function, rust

得到的错误：

```
$ rustc leakyFunction.rs --test
$ ./leakyFunction 

running 1 test
test testForLeakage ... Unreclaimed object found at 0xb6d02d98: ((), (10))
leaked memory in rust main loop (1 objects)
leakyFunction: /home/havvy/rust/src/rt/memory_region.cpp:172:
    memory_region::~memory_region(): Assertion `false' failed.
Aborted (core dumped) 
```

锈代码（简化的测试用例）：

```
use std;

type boxedFn = { theFn: fn () -> uint };

fn createClosure (closedUint: uint) -> boxedFn {
    { theFn: fn@ () -> uint { closedUint } }
}

#[test]
fn testForLeakage () {
    let aFn: boxedFn = createClosure(10);

    let myInt: uint = aFn.theFn();

    assert myInt == 10;
} 
```

为什么会泄漏内存？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:15:51.660

每当您看到内存泄漏时，这就是 Rust 中的一个错误（除非您正在处理本机代码……在这种情况下，我们的泄漏检测器可能找不到它）。在这种情况下，它是问题 #1896。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T08:33:12.783

上面代码中的主要错误是记录不能不受约束的函数。通过将类型从 fn 切换到 fn@，上面的代码片段就可以工作了。

# pdf - 如何让 DataWindow 正确保存为 PDF？

> ID：11441590
> 
> 赞同：1
> 
> 时间：2012-07-11T21:13:41.977
> 
> 标签：pdf, powerbuilder, ghostscript, datawindow

这是我的问题。我目前正在尝试将 DataWindow 打印到 PowerBuilder 12.5 中的 PDF 文件。我得到了一些代码，它目前看起来像这样。

```
//dw_1.Modify("Datawindow.Export.PDF.Method = Distill! ")
//dw_1.Modify("DataWindow.Export.PDF.Method = XSLFOP! ")
dw_1.Object.DataWindow.Export.PDF.Method = Distill!
//dw_1.Object.DataWindow.Printer = "\\prntsrvr\pr-6"
dw_1.Object.DataWindow.Export.PDF.Distill.CustomPostScript="No"
dw_1.SaveAs("c:\dw_one.pdf", PDF!, false) 
```

我在机器上安装了 GhostScript，但我在某些地方读到需要创建新打印机并在 PB 驱动程序目录中设置一些驱动程序。有人可以启发我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:38:19.817

我自己就是这样做的。

您想安装 ghostscript [http://www.ghostscript.com/download/gsdnld.html](http://www.ghostscript.com/download/gsdnld.html)并为您的操作系统（32 位与 64 位）安装合适的我自己使用的是 9.02 版本

您以机器管理员身份安装它，安装程序应自动为您生成“Sybase Datawindow PS”打印机设备。

完成后，您无需在数据窗口中设置任何内容即可使其正常工作，默认设置即可

只要做： `dw_1.saveas( "c:\somefilename.pdf", PDF!, false )` 和中提琴！一个PDF

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-24T05:42:16.630

安装 do pdf8 和 ghost 脚本。它会在运行时要求您将其保存为 pdf 。单击确定，等待大约 2 分钟后，它会将您的数据窗口转换为 pdf。有关更多详细信息，请观看此视频[https://www.youtube.com/watch?v=BfuV7a_4ONU](https://www.youtube.com/watch?v=BfuV7a_4ONU)

# installation - 安装程序如何在系统重启时执行延迟写入

> ID：11441593
> 
> 赞同：1
> 
> 时间：2012-07-11T21:13:59.287
> 
> 标签：installation, uninstallation

我需要将文件的删除和/或修改延迟到系统关闭之前或完全启动之前。原因是我有当前在其他几个进程中加载​​的二进制文件，并且这些文件被锁定，直到这些进程关闭。这是安装人员一直面临的常见问题。我相信他们只是在大多数进程停止运行后在启动（或关闭）时发生文件更改，以确保没有加载任何程序集。您如何以编程方式执行这些延迟的文件副本？

# php - 传输会话信息的php路径问题

> ID：11441598
> 
> 赞同：1
> 
> 时间：2012-07-11T21:14:21.103
> 
> 标签：php

我有一个非常简单的问题，但我对 php 真的很陌生。我刚刚下载了一个有趣的聊天插件，叫做 comechat。准确地说，有一个 cometchat direvtoru 包含 php 文件。后者只需要 $_SESSION['user'] 来处理。但它没有，我认为我的代码传输用户会话信息时存在路径问题。

在我的代码方面，我有以下架构：基本上三个目录

*   类（包含除 index.php 之外的所有我的 php 文件，account.php 生成用户会话）
*   模板（包含我所有的 html 文件）
*   公共包含 - index.php - css目录 - js目录 - cometchat目录

index.php 处理 'classes' 的 php 文件，然后后面的文件使用 smarty 引擎处理 html 文件。

我试图通过进入 index.php 中的 require_once path/config.php 来调用 cometchat 目录的配置文件，但它没有用。所以我可能有一个愚蠢的问题，但是：如果我在 index.php 中调用这个配置文件，并且知道 index.php 实例化 account.php 文件的帐户类（创建用户会话的位置），那么 require_once 路径/配置是否.php 将检索会话信息。更一般地说，anypne 可以帮助解决这个问题吗？

最好的，迈赫迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T23:35:38.627

也许您应该在 cometchat 目录的配置文件中调用 require_once index.php，在 cometchat 目录的配置文件中，类似这样：

require_once('../index.php')

# asp.net-mvc - 修剪除具有 NoTrim 属性的输入字段之外的所有输入字段

> ID：11441599
> 
> 赞同：7
> 
> 时间：2012-07-11T21:14:23.007
> 
> 标签：asp.net-mvc, data-annotations, model-binding, custom-attributes, customvalidator

我正在开发一个不是我创建的 ASP.NET MVC 2 应用程序。应用程序中的所有输入字段都在模型绑定期间被修剪。但是，我想要一个 NoTrim 属性来防止某些字段被修剪。

例如，我有以下状态下拉字段：

```
<select name="State">
    <option value="">Select one...</option>
    <option value="  ">International</option>
    <option value="AA">Armed Forces Central/SA</option>
    <option value="AE">Armed Forces Europe</option>
    <option value="AK">Alaska</option>
    <option value="AL">Alabama</option>
    ... 
```

问题是当用户选择“国际”时，我会收到验证错误，因为两个空格已被修剪，并且状态是必填字段。

这是我想做的事情：

```
 [Required( ErrorMessage = "State is required" )]
    [NoTrim]
    public string State { get; set; } 
```

到目前为止，这是我所拥有的属性：

```
[AttributeUsage( AttributeTargets.Property, AllowMultiple = false )]
public sealed class NoTrimAttribute : Attribute
{
} 
```

在 Application_Start 中设置了一个自定义模型绑定器：

```
protected void Application_Start()
{
    ModelBinders.Binders.DefaultBinder = new MyModelBinder();
    ... 
```

这是进行修剪的模型活页夹的一部分：

```
protected override void SetProperty( ControllerContext controllerContext,
                                     ModelBindingContext bindingContext,
                                     PropertyDescriptor propertyDescriptor,
                                     object value )
{
    if (propertyDescriptor.PropertyType == typeof( String ) && !propertyDescriptor.Attributes.OfType<NoTrimAttribute>().Any() )
    {
        var stringValue = (string)value;

        if (!string.IsNullOrEmpty( stringValue ))
        {
            value = stringValue.Trim();
        }
    }

    base.SetProperty( controllerContext, bindingContext, propertyDescriptor, value );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:43:04.720

NoTrim 看起来不错，但正是该`[Required]`属性会拒绝空格。

> RequiredAttribute 属性指定当验证表单上的字段时，该字段必须包含一个值。如果属性为 null、包含空字符串 ("") 或仅包含空白字符，则会引发验证异常。

[http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.requiredattribute.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.requiredattribute.aspx)

要解决此问题，您可以创建自己的属性版本或使用 RegexAttribute。我不确定该`AllowEmptyStrings`属性是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T22:33:44.920

我只是将“”替换为“-1”或“-”之类的东西。如果这是唯一的情况，当然……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-23T17:57:03.613

这个怎么样？

```
[MinLength(2, ErrorMessage = "State is required")]
[DisplayFormat(ConvertEmptyStringToNull=false)] 
```

# wpf - 如何在代码中将 WPF 组件高度设置为“*”？

> ID：11441602
> 
> 赞同：1
> 
> 时间：2012-07-11T21:14:41.597
> 
> 标签：wpf, height, code-behind

我想`"*"`在代码中动态设置组件高度。我怎样才能做到这一点？

我知道如何将其设置为定义的值：

```
DataGrid.Height = "500"; 
```

以及如何设置为“自动”：

```
DataGrid.Height = Double.NaN; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:30:36.977

星号大小仅存在于极少数组件中，其`Grid`本身*不是*其中之一。[`GridLength`](http://msdn.microsoft.com/en-us/library/system.windows.gridlength.aspx)有[一个构造函数](http://msdn.microsoft.com/en-us/library/ms557307.aspx)，它将尺寸调整方案的类型作为参数。

如果要拉伸组件，请不要为`Width`/设置任何值，`Height`并确保`Horizontal`/`VerticalAlignment`是`Stretch`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-19T13:37:23.357

您也可以使用 columndefinitions/rowdefinitions 来执行此操作`GridUnitType`，例如：

```
RowDefinition rd = new RowDefinition();
rd.Height = new GridLength(1.0, GridUnitType.Star);
grid.RowDefinitions.Add(rd); 
```

另请参阅：[后面代码中的网格星型](https://stackoverflow.com/questions/5459595/grid-star-size-in-code-behind)

# java - 为什么在 Jasmin HelloWorld 中使用 aload_0？

> ID：11441603
> 
> 赞同：2
> 
> 时间：2012-07-11T21:14:43.087
> 
> 标签：java, jasmin

有官方 Jasmin HelloWorld 示例的开始。

```
.class public NoJad.j
.super java/lang/Object

.method public <init>()V
   aload_0

   invokenonvirtual java/lang/Object/<init>()V
   return
.end method

.method public static main([Ljava/lang/String;)V
   .limit stack 2
... 
```

为什么会有`aload_0`指令？local var 0 由什么组成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T21:18:58.480

它正在调用基类的构造函数（`Object`在本例中）：

```
this.super(); 
```

在非静态方法中，索引下的局部变量`0`始终是`this`引用，因此将引用`aload_0`推`this`到引用堆栈的顶部。然后在栈顶（ ）的一个对象上`invokenonvirtual`调用指定的方法（）。`Object/<init>()``this`

# java - 在运行时修改 Ehcache 配置

> ID：11441606
> 
> 赞同：2
> 
> 时间：2012-07-11T21:14:46.977
> 
> 标签：java, spring, ehcache, terracotta

我在 Spring 框架中使用 ehcache。我正在使用 ehcache.xml 来初始化 ehcache。但是我想在运行时添加某些属性，例如 terracottaconfig。为此，我重写了 EhCacheManagerFactoryBean 类。目前我正在重写这个类的 getObject() 方法（我不知道这是否是一个正确的重写方法，因为在使用 ehcache.xml 文件初始化类之前调用​​了其他方法 setResource() 和 afterPropertiesSet()。）

这是我的弹簧配置文件

```
<bean id="cacheManager"
class="com.dexknows.util.CustomEhCacheManagerFactoryBean">
<property name="configLocation">
   <value>file:///${vp_data_dir}/ehcache.xml</value>
</property>     
<property name="terracottaConfigUrl" value="#{dexProperties['terracottaConfig.Url']}"/>
</bean> 
```

这是我覆盖的类方法

```
public class CustomEhCacheManagerFactoryBean extends EhCacheManagerFactoryBean {

    private String terracottaConfigUrl;
    private Resource resourceConfiguration;

    @Override
    public void setConfigLocation(Resource configLocation) {            
        super.setConfigLocation(configLocation);
    }

    @Override
    public void afterPropertiesSet() throws IOException, CacheException {

        super.afterPropertiesSet();
    }

    @Override
    public CacheManager getObject() {

        CacheManager manager = super.getObject();

        TerracottaClientConfiguration terracottaClientConfiguration = new TerracottaClientConfiguration();
        terracottaClientConfiguration.setRejoin(true);
        terracottaClientConfiguration.setUrl(terracottaConfigUrl);

        manager.getConfiguration().setDynamicConfig(true);
        manager.getConfiguration().terracotta(terracottaClientConfiguration);

Configuration().terracotta(terracottaClientConfiguration)));
    return manager;

    }

    public String getTerracottaConfigUrl() {
        return terracottaConfigUrl;
    }

    public void setTerracottaConfigUrl(String terracottaConfigUrl) {
        this.terracottaConfigUrl = terracottaConfigUrl;
    }

} 
```

我收到以下异常：

创建名为“cacheManager”的 bean 时出错：FactoryBean 在创建对象时抛出异常；嵌套异常是 java.lang.IllegalStateException: net.sf.ehcache.config.Configuration.dynamicConfig 不能动态更改

我设置了 dynamicConfig="true"

```
<ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:noNamespaceSchemaLocation="ehcache.xsd"
         updateCheck="false"
         monitoring="autodetect"
         dynamicConfig="true"
         name="xyz"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T22:22:39.083

分析 EhCacheManagerFactoryBean 类的源码后发现 'terracottaConfiguration' 不能动态改变。**只有枚举 DynamicProperty 中提到的属性才能动态更改**。不过，如果有人找到文档并提及相同内容，那将很有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T17:51:25.843

只有几个动态属性：

*   `timeToIdleSeconds`
*   `timeToLiveSeconds`
*   `maxElementsInMemory`
*   `maxElementsOnDisk`

它们在（“动态配置”）的官方[Javadocs 中有所提及。`net.sf.ehcache.config.CacheConfiguration`](http://ehcache.org/apidocs/net/sf/ehcache/config/CacheConfiguration.html)

# ios - 如何确定 -[UIImage imageNamed:] 将加载的文件的路径？

> ID：11441608
> 
> 赞同：3
> 
> 时间：2012-07-11T21:14:50.330
> 
> 标签：ios, uiimage

我有一个继承的项目，其中包含一堆使用的代码`-[UIImage imageWithContentsOfFile:]`和完整的路径。我将它转换为使用`-[UIImage imageNamed:]`和只是文件名（无扩展名），所以我可以传递它，比如`@"icon"`并获得`icon.png`or `icon@2x.png`or `icon~ipad.png`，视情况而定。

问题是，程序中有一部分我想检查图像的大小，如果它太大，我想显示，而不是`TooBigImage.png`.

所以我需要知道，如果我调用`[UIImage imageNamed: someName]`，它将使用哪个扩展/修改名称。基本上，我想要那个文件的路径，所以我可以在加载图像之前检查它的大小。

或者，如果有办法检查`imageSizeForImageNamed:`或类似的东西，我可以使用它，我只是不知道。

我宁愿**不**重新实现整个“如果视网膜，附加@2x，等等......”的事情，因为那是（a）麻烦和（b）脆弱（如果Apple改变/增强行为怎么办？）

提示？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:02:14.250

对于像素的使用`size`和`scale`属性：

```
UIImage *getMySize = [UIImage imageNamed:@"blah"];

float width = getMySize.scale * getMySize.size.width;

float height = getMySize.scale * getMySize.size.height; 
```

这是[UIImage 文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-11T22:32:22.267

`[UIImage imageNamed: @"icon"]`总是在应用程序主包中查找。所以`icon.png`必须位于要找到的捆绑包中。那里不允许有子路径。

但是，您可以通过使用此处的优势来定义自己的捆绑包，`[NSBundle bundleWithPath: @"subfolder"]`然后您可以使用捆绑包方法来检索优化的资产。

```
NSBundle *bundle = [[NSBundle bundleWithPath: @"folder"] autorelease]; 
```

然后，`[bundle pathForResource:ofType:]`将从您的文件夹（即 icon~ipad）返回正确的图像资源路径，`[UIImage imageWithContentsOfFile:]`并将处理大小修改器。

虽然这个问题没有答案，但它很好地总结了我的经验。 [NSBundle pathForResource:ofType: 和 UIImage imageWithContentsOfFile: 如何处理比例和设备修饰符？](https://stackoverflow.com/questions/11090963/how-do-nsbundle-pathforresourceoftype-and-uiimage-imagewithcontentsoffile-han)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-11T22:06:16.920

据我所知，您应该实现自己的功能来手动检查文件的大小。

您可以自己生成名称，例如：

```
-(bool)fileOk:(NSString*)filename
{
    bool retina = [UIScreen mainScreen].scale == 2.0;
    static bool iPad = UI_USER_INTERFACE_IDIOM()==UIUserInterfaceIdiomPad;

    //Generate the filename
    NSString *fullFilename = [NSString stringWithFormat:@"%@%@%@",filename,(retina)?@"@2x":@"",(iPad)?@"~ipad":@"~iphone"]; 

    //Get the size:

    NSError *error;
    NSString *fullPath=[[NSBundle mainBundle] pathForResource:fullFilename ofType:@"png"];
    NSDictionary *fileDictionary = [[NSFileManager defaultManager] attributesOfItemAtPath: fullPath error:&error];

    return (fileDictionary && [fileDictionary fileSize]<SOME_TO_BIG_SIZE_CONSTANT);
} 
```

然后您可以选择是否要显示图像。我没有尝试过代码，所以可能有一些错字...我希望这就是您要找的...

# nant - 在退出/完成时执行 NAnt 目标

> ID：11441610
> 
> 赞同：1
> 
> 时间：2012-07-11T21:14:55.987
> 
> 标签：nant

我被要求使用 NAnt 创建一个清理目标，该目标将删除构建文件中各种其他目标留下的文件。主文件有近一千行和一百多个目标，所以我不想手动添加对清理目标的调用。另一方面，我宁愿为这个构建的用户自动化它，这样他们就不必每次使用任何其他目标时都运行相同的 NAnt 目标。

当构建中的目标结束时，是否有任何方法可以触发 NAnt 目标，或者通过 NAnt 自动执行此过程的任何其他方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T18:29:08.273

一位同事在上面找到了文档，而不是我希望找到的地方。但是，以下属性使它起作用：

```
<property name="nant.onsuccess" value="targetGoesHere" />
<property name="nant.onfailure" value="targetGoesHere" /> 
```

# image - 尝试为 navigationItem 设置 titleView 在模拟器上有效，但在实际设备上无效

> ID：11441616
> 
> 赞同：3
> 
> 时间：2012-07-11T21:15:23.640
> 
> 标签：image, set, navigationitem, titleview

我正在尝试使用以下代码在 NavigationBar 中设置 titleView。它在模拟器上正确显示，但在设备上却没有。

这是我的代码：

```
UIImage *imageTitle = [UIImage imageNamed: @"tittle_SW.png"];
UIImageView *imageViewForTitle = [[UIImageView alloc] initWithImage: imageTitle];

self.navigationItem.titleView = imageViewForTitle;
self.navigationItem.titleView.autoresizesSubviews = NO; 
```

我尝试在 initWithNibName 和 viewDidLoad 中使用此代码，并且它们都可以在模拟器上运行，但在设备上没有显示任何内容。

# ios - 从不同的 ViewController 声明对象

> ID：11441619
> 
> 赞同：0
> 
> 时间：2012-07-11T21:15:45.237
> 
> 标签：ios, xcode, uiviewcontroller, declaration

在我的应用程序中，我有一个具有 UITextField 和 UIButton 的 ViewController (ViewController 1)。在我的 ViewController 2 中，我有一个 UINavigationBar。我希望能够在 ViewController 1 文本字段中键入内容，按下按钮，然后将 ViewController 2 中的 UINavigationBar 文本设置为 ViewController 1 中的 UITextField。但是，当然，Xcode 不会让您在没有其他 ViewController 的情况下声明对象做更多的工作。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:37:15.743

类似于 Oscar 的答案，但如果这是一个字符串，您希望多个视图控制器可以访问，那么您可以在您的应用程序委托中设置一个属性。

```
In AppDelegate
@property (NSString *) myString;

In View Controller setting
myAppDelegate *appDelegate =  (myAppDelegate *)[[UIApplication sharedApplication] delegate];
appDelegate.myString = @"meh"; 

In View Controller getting
myAppDelegate *appDelegate=  (myAppDelegate *)[[UIApplication sharedApplication] delegate];
NSString *mehStr = appDelegate.myString; 
```

这不是完整的代码，但你明白了。我不确定我是否会过度地将东西发送回 appdelegate，但对于一个字符串，它应该可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T22:22:23.863

您的问题不是很清楚，但据我所知，您希望将`ViewController`'s`UIButton`设置`NavigationBar`为第二个标题`ViewController`？

对我来说这似乎是一种非常奇怪的行为，但我认为这可能会对你有所帮助。

在您第一次`ViewController`创建协议/委托功能时，您`UIButton`可以在按下时调用：

```
-(IBAction) changeTitle:(id) sender {    
[self.delegate buttonPressed:txtView.text];
} 
```

然后将您`UITextField`的文本发送给您`AppDelegate`或创建这两个`ViewControllers`的人，您将在那里收到该文本并将其发送给您的第二个`ViewController`。

```
-(void)buttonPressed:(NSString *)text{
secondViewController.title = text;
} 
```

`ViewController`如果该行不起作用，也许您将不得不实现一种方法来更改第二个标题。希望这对您有用，并且我理解您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T21:21:05.127

尚未对此进行测试，但以下内容应该适合您：

```
navBar.topItem.title = @"title"; 
```

或者

```
self.navigationItem.title=@"title"; 
```

@"title" 将被替换为在将 VC2 推入导航控制器堆栈之前设置的字符串变量（在 VC2 中）......

干杯

# java - 比较器与 Apache BeanComparator

> ID：11441623
> 
> 赞同：16
> 
> 时间：2012-07-11T21:16:05.253
> 
> 标签：java, performance, apache, comparison, comparator

考虑一个简单的类：

```
class Employee {

String name;
int sal;

....//getters and setters
} 
```

例如，我可以创建一个比较器来对字段名称进行排序。

```
class EmpSortByName implements Comparator<Employee>{

 @Override
 public int compare(Employee e1, Employee e2){
  return e1.getName().compareTo(e2.getName());
 }
} 
```

但是，查看 apache commons BeanComparator，可以通过以下方式实现排序：

```
BeanComparator bc = new BeanComparator("name");
Collections.sort(employeeList, bc); 
```

因此，通过使用 BeanComparator，我可以用最少的代码实现排序。使用 Comparators 和 BeanComparators 之间的权衡是什么：在性能、使用场景（多字段排序、其他因素）方面？

我也知道要使用 BeanComparator，必须导入 beanutils jar。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-11T21:24:35.950

BeanComparator 使用反射来访问 name 属性并比较两个对象。尽管反射性能有所提高，但仍不如直接访问字段快。这是否重要取决于在您的应用程序中调用它的次数以及在何种上下文中。

另一个问题是，如果您重构方法并将其重命名为`getLastName()`，则使用 BeanComparator 的代码将不会被重构，并且直到运行时（或单元测试时）才会注意到该问题。

坦率地说，实现比较器非常简单，我认为使用反射不是一个好主意。避免 4 行琐碎代码的好处不足以弥补它引起的性能和可维护性问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T06:20:01.143

同样使用 beancomparator，您可以使用 compareTuple 轻松比较多个属性 `org.ujac.util.BeanComparator beanComparator = new org.ujac.util.BeanComparator(compareTuple); Collections.sort(List,beanComparator);`

# c# - 更新文本框内容

> ID：11441624
> 
> 赞同：-2
> 
> 时间：2012-07-11T21:16:12.047
> 
> 标签：c#, wpf, prism

我有一个绑定到属性的 TextBox。有没有办法在不使用的情况下更新文本框的内容

```
RaisePropertyChanged(() => Property); 
```

物业内？

我想在另一个 Property2 中更新 Property1 的值，然后更新在 Property2 中绑定到 Property1 的 TextBox 的值。

那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T22:00:29.033

我相信您可能正在寻找 PropertyChangedCallback。

基本语法是这样的：

 ````
static ClassName() 
{
    Property = DependencyProperty.Register("PropertyName", typeof(propertyType), typeof(ownerType), 
    new UIPropertyMetadata(new PropertyChangedCallback(PropertyChangedCallback));
}

static void PropertyChangedCallback(DependencyObject obj, DependencyPropertyChangedEventArts e)
{
    ClassName class = obj as ClassName;
    // Manipulate properties by accessing them through class.
} 
````  `有关详细信息，请参阅此链接：http: [//msdn.microsoft.com/en-us/library/ms745795.aspx](http://msdn.microsoft.com/en-us/library/ms745795.aspx)`

# android - Android 锁屏和键盘控制

> ID：11441626
> 
> 赞同：1
> 
> 时间：2012-07-11T21:16:18.483
> 
> 标签：android, media-player, broadcastreceiver, lockscreen

我正在为 Android 编写一个媒体播放器应用程序。到目前为止一切都很顺利，但是我现在进入了困难的阶段！

我有两个问题。我需要实施服务活动吗？据我了解，这是允许应用程序继续在后台工作所必需的。但是，当我移动到平板电脑上的其他程序时，我的工作正常，并且毫无问题地返回应用程序。有人可以解释一下服务的优势吗？

其次，我想将媒体播放器与 ICS 中的标准锁屏控件集成，并使其利用具有键盘播放/暂停跳过控件的平板电脑（例如华硕变压器）。如果有人能指出正确的方向让我开始，我将不胜感激。从我的谷歌搜索来看，似乎需要 BroadcastReciever，或者可能需要 RemoteControlClient，但我不知道从哪里开始！

我有一个带有操作栏选项卡的主要活动，其中包含一个音乐播放器片段和一个视频播放器片段。

我需要专门为锁定屏幕创建布局，还是可以使用标准 API？

任何帮助都感激不尽！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-20T13:45:47.697

您应该查看 android SDK 示例附带的 Random Music Player 示例。它为您提供在 ICS 设备及以上设备上的锁定屏幕控制和蓝牙控制能力。我自己用过，很好用。此外，Github 上的 UniversalMusicPlayer 示例：[https ://github.com/googlesamples/android-UniversalMusicPlayer](https://github.com/googlesamples/android-UniversalMusicPlayer)

[示例代码](http://developer.android.com/samples/index.html)也可以在网上找到。

伊戈尔

# video - 让 DIV 基于其父 DIV 居中？

> ID：11441627
> 
> 赞同：0
> 
> 时间：2012-07-11T21:16:21.570
> 
> 标签：video, youtube, embedding

我正在开发一个网站。我正在创建下拉列表作为网站的菜单。我创建了隐藏的 div，当您将鼠标悬停在顶部菜单中的链接上时会出现这些 div。但是，我无法弄清楚如何让他们以父母为中心。我假设这是因为它们的位置是“绝对的”，但我不知道我还能如何创建隐藏的 DIV 来覆盖其他东西而不是绝对的。我真的不知道要发布我的代码的哪些部分，所以如果你想知道我在说什么，请访问 www.theguildwars2hq.com 并将鼠标悬停在顶部的链接上。您会注意到它们都从它们上方链接的左边框开始。我希望它们自动以链接为中心，但在顶部偏移处它们被编码。

此外，一旦 div 达到一定高度，有没有办法让 div 自动创建第二列？

我希望这有点道理，如果很少的话。如果没有具体的东西可以展示和指出，就很难解释我的观点。

# java - TCP-Streaming：音频/视频同步

> ID：11441628
> 
> 赞同：0
> 
> 时间：2012-07-11T21:16:22.043
> 
> 标签：java, tcp, network-programming, synchronization, streaming

我有一个关于 TCP/Live-Streaming/Synchronization（编程语言：Java）的问题：

假设我有一个客户端，它正在从相机捕获音频和视频。它通过 TCP 套接字同时（通过线程）将音频和视频数据发送到服务器，即在两个不同的线程上同时接收音频和视频流。

[我知道，UDP 通常用于直播应用程序，但有一些原因，我使用 TCP 的原因..]

所以，问题是：是否有机会通过 TCP 失去同步？在不同的套接字上有两个流（一个用于音频，一个用于视频），可能存在一个问题，即必须重新发送一个数据包，但是丢失数据包的重新发送是否会成为问题（我的意思是，当通过 TCP 重新发送一个数据包，这会导致永久延迟还是客户端只是发送丢失的数据包和下一个数据包更快几毫秒）？

我同时将音频和视频信号发送到服务器。他们会总是同时到达服务器吗？如果没有，有没有办法产生/模拟问题？

我做了一些测试，音频和视频总是同步的。但我不确定是否会一直这样（即使在流媒体播放超过 5 小时后）。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T00:16:51.727

如果您使用两个不同的套接字，则无法保证。TCP 保证以正确的顺序传输数据，但如果您使用两个不同的音频和视频流，则不适用。

但是，如果连接速度足够快，应该不会有问题。它尽可能快地发送它。如果一个流被“阻塞”，它会延迟并且不同步，但我怀疑你发送视频的情况会发生这种情况（只要它不是太高的 FPS 或分辨率）。

我认为使用单个流会更安全，但老实说，我认为你的方式很好。这一切都取决于：客户端的速度、服务器的速度和网络的速度。

# php - PHP获取关系mysql innodb数据库中的所有匹配行

> ID：11441631
> 
> 赞同：1
> 
> 时间：2012-07-11T21:16:32.803
> 
> 标签：php

我在数据库中创建了 3 个具有多对多关系的表。我的数据库中的变量`$refernece_keys`应该返回数据库中的所有相关字段 - 但它只返回第一个分配的字段并忽略其他字段。

`e.g. page1 should return keys_href: id's 1, 2, 3, 4, 8, 10, 15 - however it only returns id:1 page2 should return keys href: id's 3, 4, 5, 7, 8, 11 - however it only returns id:3`

我的 ARRAY 有问题吗？

```
$SQL = 
   "SELECT  * FROM learn_more AS lm 

LEFT JOIN  learn_more_to_reference_key AS lmtrk 
        ON  lm.id = lmtrk.learn_more_id 

LEFT JOIN  reference_keys AS rk 
        ON  rk.keys_id = lmtrk.reference_key_id

     WHERE  lm.page_title = '$this_page'";

$result = mysql_query($SQL) or die(mysql_error()); 

 while ($db_field = mysql_fetch_array($result))
{   
        $id                =     $db_field['id'];
        $main_title        =     $db_field['main_title'];
        $main_content     =     $db_field['main_content'];
        $reference_keys   =     $db_field['keys_href']; 
        $sub_title        =     $db_field['sub_title'];
        $sub_content      =     $db_field['sub_content'];
} 
```

------------------------------------------------>编辑

我的 PHP 视图页面是一个模板

```
<div id="content">  
<div class="section_frame">

<div class="section_title">
<?php echo $main_title; ?>
</div>

<div class="section_content">
<?php echo $main_content; ?>
</div>

<div class="section_content_ref">
<span class="hl_reference"><u>key references:</u></span> 
<?php echo $reference_keys; ?>
</div>

<div class="sub_section_title">
<?php echo $sub_title; ?>
</div>

<div class="sub_section_content">
<?php echo $sub_content; ?>
</div> 
```

所以基本上我只想让我的价值观得到回应..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:41:33.383

啊，我的第一个想法是，由于您的 while 循环遍历所有记录，因此在完成后只有最后一条记录可用......除了您只看到第一个记录。如果要`echo $id`在 while 循环中添加，是否会打印所有 ID？此外，如果您有更多代码来完成示例，这将有所帮助。

```
$items = array();
while ($db_field = mysql_fetch_array($result))
{   
    $id                =     $db_field['id'];
    $main_title        =     $db_field['main_title'];
    $main_content     =     $db_field['main_content'];
    $reference_keys   =     $db_field['keys_href']; 
    $sub_title        =     $db_field['sub_title'];
    $sub_content      =     $db_field['sub_content'];
    $items[$id] = array($main_title, $main_content, $reference_keys, $sub_title, $sub_content);
} 
```

以上将创建一个数组，其中每个记录的 id 指向记录信息。这是否符合您的目标？

# php - 使用 preg_match() 显示字符串的前 n 段

> ID：11441635
> 
> 赞同：3
> 
> 时间：2012-07-11T21:16:59.793
> 
> 标签：php, regex, preg-match

下面的代码显示了字符串的第一段，但我希望它显示前三段：

```
preg_match("/<p>(.*)<\/p>/",$paragraphs,$matches);
echo $matches[0]; 
```

我是正则表达式的新手，所以我一直在努力解决这个问题。有任何想法吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T21:23:13.720

您可以使用`preg_match_all`：

```
preg_match_all("/<p>(.*)<\/p>/", $paragraphs, $matches);
echo $matches[0][0];
echo $matches[0][1];
echo $matches[0][2]; 
```

当您使用`preg_match_all`时，$matches 中的每个子数组都会为每个匹配项获得一个新条目。

有关更多信息，请参阅 php.net/manual/en/function.preg-match-all.php。

# javascript - jquery：帮助中心在图像悬停时可变大小的 div

> ID：11441638
> 
> 赞同：1
> 
> 时间：2012-07-11T21:17:19.323
> 
> 标签：javascript, jquery

我有一个小问题我不明白。我做了一个jsfiddle来说明它。

[http://jsfiddle.net/sandrodz/czfGy/9/](http://jsfiddle.net/sandrodz/czfGy/9/)（更新为包括图片）

因此，当用户将鼠标悬停在图像上时，应该显示包含文本“晴天多云”的 div，此按摩会有所不同，因此可以更小或更大。

我希望它以图像为中心。但不幸的是，我的 jquery 逻辑无法正常工作，并且悬停似乎向左移动。

有任何想法吗？

```
$("#tempicon img").hover(function() {
    divW = ($(this).next("div").width() / 2) - ($(this).outerWidth() / 2);
    $(this).next("div").css({marginLeft: -divW }).animate({ opacity: "show" }, "fast");
}, function() {
    $(this).next("div").animate({opacity: "hide"}, "fast");
}); 
```

为了增加混乱，我在另一个 div 上使用了相同的确切代码，它完美地工作：S

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:02:44.873

试试我的工作[更新](http://jsfiddle.net/czfGy/12/)（Firefox/Chrome）。**`middle of image - width/2 of label`**是正确的。

我做了什么：我添加了变量名，这在确定定位时应该会有所帮助。另外，我将其更改`marginLeft`为简单的`left`. 通过这种计算，只要所有内容（图像和标签`div`）都在同一个[“偏移父级”](http://jqapi.com/#p=position)内并且您不更改`position`其中一个的属性，您应该没问题。

# python - 如何在 Python 中动态选择和传递命名参数？

> ID：11441639
> 
> 赞同：4
> 
> 时间：2012-07-11T21:17:21.993
> 
> 标签：python

有效载荷是逗号分隔的数据块，表示来自逆变器的读数。这些读数需要存储在一个名为 InverterHistory 的表中。每个字段并不总是有一个值。该模型已设置为允许字段为空/空白。因此，我试图在将其分配给字段之前检查是否存在值。这是我到目前为止所拥有的：

```
i = Inverter.objects.get(mac=u)
payload.reverse()

try:
    ac_volts_a = str(payload.pop())
    ac_volts_b = str(payload.pop())
    ac_volts_c = str(payload.pop())
    ac_current_a = str(payload.pop())
    ac_current_b = str(payload.pop())
    ac_current_c = str(payload.pop())
    dc_volts = str(payload.pop())
    dc_current = str(payload.pop())
    kw_out = str(payload.pop())
    mwh_total = str(payload.pop())
    current_time  = datetime.datetime.utcnow().strftime("%Y-%m-%d %H:%M:%S")

    i_data = InverterHistory(
        inverter = i,
        if ac_volts_a: 
            voltage_ac_a = float(ac_volts_a),
        if ac_volts_b: 
            voltage_ac_b = float(ac_volts_b),   
        if ac_volts_c: 
            voltage_ac_c = float(ac_volts_c),
        if ac_current_a: 
            current_ac_a = float(ac_current_a), 
        if ac_current_b: 
            current_ac_b = float(ac_current_b),
        if ac_current_c: 
            current_ac_c = float(ac_current_c),
        if dc_volts: 
            voltage_dc = float(dc_volts),   
        if dc_current: 
            current_dc = float(dc_current), 
        if kw_out: 
            kwout = float(kw_out),
        if mwh_total: 
            mwh = float(mwh_total),
        recordTime  = datetime.datetime.utcnow().strftime("%Y-%m-%d %H:%M:%S"))
    i_data.save()
except Exception, e:
    print >> sys.stderr, "Error While Recording Inverter History"
    print >> sys.stderr, e
    raise Http404 
```

我对python相当陌生，不知道如何正确编码上述内容。当我尝试编译代码时，我在 if 语句开始时遇到错误。我怎样才能修复上面的代码，以便它可以按需要编译和工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-11T21:50:24.380

当您编写时`i_data = InverterHistory(...)`，您正在创建一个类型的对象，`InverterHistory`并且`...`是您传递给构造函数的参数。在 Python 中构造对象就像调用函数或方法一样，不能将逻辑放在括号内。所以，你会得到一个错误，因为在`if`那里放置一个语句是不正确的语法。

您需要做的是将逻辑移出括号并将所有变量放入 Python`dict`中。然后，您可以将其`dict`作为参数传递给对`InverterHistory`.

```
params = {
    'inverter': i,
    'recordTime': datetime.datetime.utcnow().strftime("%Y-%m-%d %H:%M:%S")
}
if ac_volts_a:
    params['voltage_ac_a'] = float(ac_volts_a)
if ac_volts_b: 
    params['voltage_ac_b'] = float(ac_volts_b)

# Do the same with all your attributes
# ...

# Then you can create your object and pass it the dictionary you have created
i_data = InverterHistory(**params) 
```

解`**params`包字典。这意味着解释器将从`key: value`字典中获取所有内容并将它们转换为`key=value`. 这样，`if`语句所针对的每个参数都`True`将作为命名参数传递给`InverterHistory`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-11T21:28:52.890

您应该在调用方法之前构造参数字典，然后使用 python 关键字 unpack 运算符将字典作为参数传递。

简化示例：

```
kwargs = {"inverter":i}
if ac_volts_a: 
  kwargs['voltage_ac_a'] = float(ac_volts_a)
i_data = InverterHistory(**kwargs) 
```

相关的 SE 问题： [*args 和 **kwargs 是什么意思？](https://stackoverflow.com/questions/287085/what-does-args-and-kwargs-mean)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T21:20:58.847

我不太明白你想要做什么，但错误是因为第一条`if`语句之前的两行括号不匹配。`if`调用函数时，参数列表中不能有语句。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T21:22:03.317

一件事-我认为您不能说`def some_func(if blah: x = 0)`，但您可以将其改写为`def some_func(x = 0 if blah else None)`. 您将替换`if then`为`if then else`，但它应该更适合口译员。

所以这部分：

```
 i_data = InverterHistory(
    inverter = i,
    if ac_volts_a: 
        voltage_ac_a = float(ac_volts_a),
    if ac_volts_b: 
        voltage_ac_b = float(ac_volts_b),   
    if ac_volts_c: 
        voltage_ac_c = float(ac_volts_c),
    if ac_current_a: 
        current_ac_a = float(ac_current_a), 
    if ac_current_b: 
        current_ac_b = float(ac_current_b),
    if ac_current_c: 
        current_ac_c = float(ac_current_c),
    if dc_volts: 
        voltage_dc = float(dc_volts),   
    if dc_current: 
        current_dc = float(dc_current), 
    if kw_out: 
        kwout = float(kw_out),
    if mwh_total: 
        mwh = float(mwh_total),
    recordTime  = datetime.datetime.utcnow().strftime("%Y-%m-%d %H:%M:%S")) 
```

所有 if 语句都是“倒退”的。

编辑：

更好的方法可能是这样的：

```
i_data = InverterHistory(**keywords) 
```

然后在定义中，你使用这个构造：

```
 def InverterHistory(**kws):
    voltage_ac_a = float(kws.get('ac_volts_a',0.00)); 
```

或者

```
 def InverterHistory(**kws):
    voltage_ac_a = kws.get('ac_volts_a',None);
    voltage_ac_a = float(voltage_ac_a) if voltage_ac_a else None # avoids error if none 
```

# java - 使用 JUnit 在 Spring 中测试 CRUD 时获取同一行的多个 ID

> ID：11441640
> 
> 赞同：2
> 
> 时间：2012-07-11T21:17:22.147
> 
> 标签：java, spring, unit-testing, junit

我正在使用带有 AbstractTransactionalJUnit4SpringContextTests 的 JUnit4，并且想创建简单的 CRUD 单元测试 - 如下所示。但是，对 SQL 更新的调用导致事务管理器为我的测试实例生成一个新 ID。由于在更新过程中没有传回新 ID，因此我不再拥有我正在测试的行的主键 - 这阻碍了测试的其余部分。

有没有办法阻止事务管理器在调用更新时为书生成新 ID？（如果没有更好的方法来测试 CRUD？）

```
@Test
public void testCRUDBook() {
    Book b1 = new Book(title, author);
    BookFactory factory = database.getBookFactory();
    int id = factory.createBook(b1);

    Book b2 = factory.readBook(id);        
    assertEquals(b1.getTitle(), b2.getTitle());
    assertEquals(b1.getAuthor(), b2.getAuthor());

    b2.setTitle("title 2");
    b2.setAuthor("author 2");
    assertTrue(factory.updateBook(b2));

    // The problem arises here as updating the book record causes a new Id 
    // to be generated so querying by Id is no longer possible.
    Book b3 = factory.readBook(b2.getId());        
    assertEquals(b3.getTitle(), "title 2");
    assertEquals(b3.getAuthor(), "author 2");    

    assertTrue(factory.deleteBook(b3));
} 
```

书是这样的：

```
public class Book {
    private int id;
    private String title;
    private String author;

    public Book() {}

    // NEW
    public Book(String title, String author) {
        this.title = title;
        this.author = author;
    }

    // READ
    public Book(int id, String title, String author) {
        this.id = id;
        this.title = title;
        this.author = author;
    }

    // GENERIC ACCESSORS (left out for brevity)
} 
```

为了完整性 - 工厂：

```
public class BookFactory extends BaseDatabaseFactory {

        @Transactional
    public int createBook(final Book b) {
        final String insertSQL = "INSERT INTO book (author, title) VALUES (?, ?)";
        KeyHolder keyHolder = new GeneratedKeyHolder();
        try {
            int update = jdbcTemplate.update(
                    new PreparedStatementCreator() {
                        @Override
                        public PreparedStatement createPreparedStatement(Connection connection) throws SQLException {
                            PreparedStatement ps = connection.prepareStatement(insertSQL, PreparedStatement.RETURN_GENERATED_KEYS);
                            ps.setString(1, b.getTitle());
                            ps.setString(2, b.getAuthor());
                            return ps;
                        }
                    },
                    keyHolder);
            if (update != 1) {
                throw new IllegalStateException("Adding book record to database resulted in " + update + " records.");
            }
            return keyHolder.getKey().intValue();
        } catch (DataAccessException ex) {
            String msg = "Falied to create new book:" + b.toString() + "ex:" + ex.getMessage();
            throw new RuntimeException(msg);
        }
    }

    private static class BookRowMapper implements RowMapper {
        @Override
        public Object mapRow(ResultSet rs, int rowNum) throws SQLException {
            Book b = new Book();
            b.setId(rs.getInt("id"));
            b.setTitle(rs.getString("title"));
            b.setAuthor(rs.getString("author"));
            return b;
        }
    }

    @Transactional
    public Book readBook(int id) {
        Book b = null;
        try {
            String sql = "SELECT * FROM book WHERE id = " + id;
            b = (Book) jdbcTemplate.queryForObject(sql, new Object[]{}, new BookRowMapper());
        } catch (DataAccessException ex) {
            throw new RuntimeException("Falied to locate book.", ex);
        }
        return b;
    }    

    @Transactional
    public boolean updateBook(final Book b) {
        final String updateSQL = "UPDATE book SET author = ?, title = ? WHERE id = ?";
        try {
            jdbcTemplate.update(
                    new PreparedStatementCreator() {
                        @Override
                        public PreparedStatement createPreparedStatement(Connection connection) throws SQLException {
                            PreparedStatement ps = connection.prepareStatement(updateSQL);
                            ps.setString(1, b.getAuthor());
                            ps.setString(2, b.getTitle());
                            ps.setInt(3, b.getId());
                            return ps;
                        }
                    });
        } catch (DataAccessException ex) {
            log.error("Falied to update Book:" + b.toString(), ex);
            return false;
        }
        return true;
    }

    @Transactional
    public boolean deleteBook(final Book b) {
        try {
            jdbcTemplate.update("DELETE FROM book WHERE id = ?", b.getId());
        } catch (DataAccessException ex) {
            log.error("Falied to delete Book:" + b.toString(), ex);
            return false;
        }
        return true;
    }    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:42:50.440

Can you make the id an Integer type instead? It looks as if the factory causes a new instance to be created when you do the update to b2\. id should be nullable.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T22:09:44.620

在尝试记录问题时修复了问题（通过粘贴整洁的工厂代码）。createBook(book) 和 readBook(int) 工厂方法缺少 @Transactional 注释；我曾认为事务是从调用测试容器继承的——显然情况并非如此。跨事务拆分测试必须创建该行的多个实例。

我希望这可以帮助遇到同样问题的其他人。

# php - 在类中声明尚不存在的变量

> ID：11441641
> 
> 赞同：0
> 
> 时间：2012-07-11T21:17:23.970
> 
> 标签：php, static, constructor

如何让以下代码不会在我的脸上爆炸？

```
<?php 

    class abc{
    }
    abc::$someDynamicVariable
?> 
```

我真的不想事先声明变量，并希望我可以在`__construct`函数中声明它（javascript函数的`arguments`数组有人吗？）

我得到的错误是：

> 致命错误：访问未声明的静态属性：abc::$someDynamicVariable in

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:26:53.843

你不必马上给它一个值：

```
class abc{
    public static $theVariable;

    // only give it a value when initialized 
    public function __construct() {
       $this->theVariable = "someValue"
    }
}
abc::$someDynamicVariable 
```

或者你可以用不同的类来扩展它

```
class abc{
    public static $theVariable;
} 
```

延长

```
class cab extends abc {
   public function __construct() {
       $this->theVariable = "someValue"
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:27:45.187

您可以使用[PHP 的魔法方法](http://www.php.net/manual/en/language.oop5.magic.php) `__set()`并`__get()`设置/获取目前尚不存在的动态属性。

这是一个例子：

```
class Foo {
    private $data = array();

    public function __set($key, $value) {
        $this->data[$key] = $value;
    }

    public function __get($key) {
        return $this->data[$key];
    }
}

$foo = new Foo();
$foo->something = "bla"; // using magic __set()

echo $foo->something; // using magic __get() 
```

# ruby-on-rails - 设置没有种子数据的数据库

> ID：11441643
> 
> 赞同：11
> 
> 时间：2012-07-11T21:17:44.843
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我需要用表格等设置我的数据库，但在某些情况下，我不希望加载我的种子数据。`db/seeds.rb`每次我想忽略我的种子数据时，我也不想删除或移动我的文件。

有没有办法执行`rake db:setup`和忽略种子数据的任务？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-11T21:21:26.437

是的。只需使用以下两个命令：

```
rake db:create
rake db:schema:load 
```

`rake db:setup`所做的只是创建数据库 ( ) ，从( )`db:create`加载数据，然后插入种子数据 ( )。您可以分别执行这些步骤。`db/schema.rb``db:schema:load``db:seed`

# actionscript-3 - as3 安全沙盒违规

> ID：11441645
> 
> 赞同：1
> 
> 时间：2012-07-11T21:17:56.890
> 
> 标签：actionscript-3, load, flash, sandbox

我已经阅读了所有类似的主题，但没有运气，所以我发布了一个关于这个错误的新问题。

我正在尝试使用以下代码从另一个 swf 文件加载 swf 文件：

```
var loader:Loader = new Loader()

//listen for loading progress
loader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, onProgress);

//listen for when the load is finished
loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onComplete);

loader.contentLoaderInfo.addEventListener(SecurityErrorEvent.SECURITY_ERROR, onLoaderError);

//load!
var rr:URLRequest = new URLRequest("http://localhost/Gen-Tree.swf")
loader.load(rr);

function onLoaderError(event:SecurityErrorEvent) {
    trace("hi")
}

function onProgress(event:ProgressEvent):void
{
    //calculate how much has been loaded
    var percentageLoader:Number = event.bytesLoaded / event.bytesTotal;

    //use your percentage number here to drive a loader bar graphic
}

function onComplete(event:Event):void
{
    //remove listeners now that loading is done
    loader.contentLoaderInfo.removeEventListener(ProgressEvent.PROGRESS, onProgress);
    loader.contentLoaderInfo.removeEventListener(Event.COMPLETE, onComplete);

    //add loaded swf to the stage
    addChild(loader.content);

} 
```

我收到如下错误消息：

```
SecurityDomain 'http://localhost/Gen-Tree.swf' tried to access incompatible context 'file:///C|/Users/Alex/Desktop/Gen%2DTree%202012/Programming/loader.swf'
*** Security Sandbox Violation ***
SecurityDomain 'http://localhost/Gen-Tree.swf' tried to access incompatible context 'file:///C|/Users/Alex/Desktop/Gen%2DTree%202012/Programming/loader.swf'
*** Security Sandbox Violation ***
SecurityDomain 'http://localhost/Gen-Tree.swf' tried to access incompatible context 'file:///C|/Users/Alex/Desktop/Gen%2DTree%202012/Programming/loader.swf' 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-11T21:25:20.977

您正在尝试从文件系统中加载外部 swf，这将引发安全错误。将它放在服务器上，它应该可以正常工作，只要两个 swf 在同一个域上。或者运行本地服务器并尝试它。

如果两个 swf 不在同一个域中，则需要添加一个`crossdomain.xml`. 它会在服务器根目录上运行，看起来像这样：

```
<?xml version="1.0"?>
<cross-domain-policy>
    <allow-access-from domain="*" />
</cross-domain-policy> 
```

除非您不应该只使用`*`它，因为它会使您面临安全风险。您需要专门将其他域列入白名单。[您可以在此处](http://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html)了解有关跨域策略文件的更多信息。

**更新：**
此外，由于加载器 swf 正在访问它正在加载的内容（通过`loader.content`），您需要为该内容 swf 添加安全权限（看起来它被称为`Gen-Tress.swf`）：

```
import flash.system.Security;

Security.allowDomain("*"); 
```

还值得注意的是`Loader`is a `DisplayObject`，这意味着您可以直接将其添加到`stage`with`addChild(loader)`而不是`addChild(loader.content)`。通过不访问`Loader`的内容，您通常可以避免安全沙箱违规错误，并且不必处理允许域和跨域策略。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-11T22:27:41.277

您可以尝试加载 swf，然后使用 loader.loadBytes() 重新加载加载程序内容。这样您就可以创建 swf 的 bytearray 克隆并绕过安全沙箱。到目前为止，它与图像配合得很好。我在我的博客上解释了这个过程：http: [//www.inklink.co.at/blog/?p=14](http://www.inklink.co.at/blog/?p=14)

带有图像的示例如下：

```
function loadPicture():void
{
    var req:URLRequest = new URLRequest("YOUR_URL_HERE");
    var _picLoader:Loader = new Loader();
    _picLoader.contentLoaderInfo.addEventListener(Event.COMPLETE,loader2ByteArray);
    _picLoader.load(req);
}

function loader2ByteArray(evt:Event):void
{
    var lInfo:LoaderInfo = LoaderInfo(evt.target);
    var ba:ByteArray = lInfo.bytes;
    reloadByteArray(ba);
}

function reloadByteArray(ba:ByteArray):void
{
    var reloader:Loader = new Loader();
    reloader.loadBytes(ba);
    reloader.contentLoaderInfo.addEventListener(Event.COMPLETE, reloaderComplete);
}

function reloaderComplete(evt:Event):void
{
    var imageInfo:LoaderInfo = LoaderInfo(evt.target);
    var bmd:BitmapData = new BitmapData(imageInfo.width,imageInfo.height);
    bmd.draw(imageInfo.loader);
    var resultBitmap:Bitmap = new Bitmap(bmd);
    addChild(resultBitmap);
} 
```

希望能帮助到你！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T07:40:14.197

```
var loader_context:LoaderContext = new LoaderContext();
if (Security.sandboxType!='localTrusted') loader_context.securityDomain = SecurityDomain.currentDomain;
loader_context.applicationDomain = ApplicationDomain.currentDomain;
currentLoader = new Loader();
currentLoader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, onProgress);
currentLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onLoadComplete);
currentLoader.load(new URLRequest(baseLink + pName + ".swf"), loader_context); 
```

也许你可以尝试添加`loadercontext`它。

# php - PHP显示来自YouTube URL的视频ID

> ID：11441646
> 
> 赞同：2
> 
> 时间：2012-07-11T21:18:06.470
> 
> 标签：php, regex

我目前正在尝试通过 url 检索 YouTube 视频 ID。我创建了一个`getYoutubeVideoID`剥离`$url`并找到`$sVideoID`. 问题是，当我回显变量时，我得到 $sVideoID 的空值。`$sVideoID`如果我为它分配视频 ID，为什么我没有得到任何价值结果？

```
<?php

if($_POST)
{

$url     = $_POST['yurl'];

function getYoutubeVideoID($url) {
    $sVideoID = preg_replace('~https?://(?:[0-9A-Z-]+\.)?(?:youtu\.be/| youtube\.com\S*[^\w\-\s])([\w\-]{11})      
        (?=[^\w\-]|$)(?![?=&+%\w]*(?:[\'"][^<>]*>| </a>))[?=&+%\w-]*~ix','<a href="http://www.youtube.com/watch?v=$1">YouTube link: $1</a>',$url);
    return $sVideoID;
}

    $hth        = 300; //$_POST['yheight'];
    $wdth       = 500; //$_POST['ywidth'];

?>

<?
//Iframe code

echo htmlentities ('<iframe src="http://www.youtube.com/embed/'.$sVideoID.'" frameborder="0" width="'.$wdth.'" height="'.$hth.'"></iframe>');

?>

<?
//Old way to embed code
echo htmlentities ('<embed src="http://www.youtube.com/v/'.$sVideoID.'" width="'.$wdth.'" height="'.$hth.'" type="application/x-shockwave-flash"  wmode="transparent" embed="" /></embed>');
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:25:58.793

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T21:30:06.750

也许我错了，或者您没有包含所有相关数据，但是我在您的代码中没有看到您执行创建的函数的任何地方。

而不是你目前正在做的，试试这个：

```
echo htmlentities ('<iframe src="http://www.youtube.com/embed/'.getYoutubeVideoID($url).'" frameborder="0" width="'.$wdth.'" height="'.$hth.'"></iframe>'); 
```

你不能简单地定义一个函数，它会执行并分配变量。你所拥有的函数，当它被执行时，在它的位置返回一个变量。例如，您可以`return value`为您的函数分配 $var ：

```
$var = getYoutubeVideoID($url); 
```

而不是上面的，你甚至可以试试这个：

```
$sVideoID = getYoutubeVideoID($url); 
```

最后，您可以[`parse_url()`](http://php.net/manual/en/function.parse-url.php)结合使用 with[`parse_str()`](http://www.php.net/manual/en/function.parse-str.php)来从您的 url 中获取数据，而不是像其他人所指出的那样使用正则表达式：

```
$arr = parse_url($url);
parse_str($arr['query'], $output);
echo $output['v']; 
```

# php - PHP：随着时间的推移使用 php 会话时，“网站的重定向太多”

> ID：11441650
> 
> 赞同：2
> 
> 时间：2012-07-11T21:18:25.513
> 
> 标签：php, session, timeout

在我的页面中使用此代码时遇到问题：

**带有过期会话的代码**

```
<?php 
session_start();
if(!isset($_SESSION['clientmacs']) ) { 
    header('Location: index.php');
} else {
    if(time() - $_SESSION['timeLogin'] > 1800) {
        header('Location: include/logout.php');
    }
    $userclient = $_SESSION['clientmacs'];
?>
<html>
    HTML CODE
</html>
<?php
}
?> 
```

但是，如果我使用此代码，问题就会消失，并且页面可以正常工作：

**没有过期会话的代码**

```
<?php 
session_start();
if(!isset($_SESSION['clientmacs'])) { 
    header('Location: index.php');
} else {
    $userclient = $_SESSION['client'];;
?>
<html>
    HTML CODE
</html>
<?php
}
?> 
```

**谷歌浏览器中的错误：**

```
This webpage has a redirect loop

Http://localhost/mac/index.php The website has too many redirects. The incidence may be
resolved by deleting the cookies from this site or allowing third party cookies. If
that fails, the incidence may be related to a bug in the server configuration, not the
computer. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T21:22:31.717

您需要在执行重定向时重置 $_SESSION 超时值（$_SESSION['timeLogin']），否则当客户端从重定向返回时，会话中的值是相同的并且将再次被重定向。

您可以通过以下方式解决它：

```
if(!isset($_SESSION['clientmacs']) ) {
    $_SESSION['clientmacs'] = ""; // add this line if not added somewhere else
    header('Location: index.php');
} 
```

和

```
if(time() - $_SESSION['timeLogin'] > 1800) {
    $_SESSION['timeLogin'] = time(); // add this line
    header('Location: include/logout.php');
} 
```

也许（取决于您的逻辑）最好清除整个会话，并`session_destroy()`在您执行重定向时通过正常流程（）重新配置它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T21:21:23.550

这是您需要添加的内容

```
if(!isset($_SESSION['clientmacs'])) { 
    $_SESSION['clientmacs'] = 'something' // or it will redirect forever;
    header('Location: index.php');
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-11T21:22:01.570

您的注销正在重定向到您的索引，它将再次检查条件

`if(time() - $_SESSION['timeLogin'] > 1800)`

这将是真实的并将其发送回注销，依此类推。你需要改变你的 $_SESSION['timeLogin'] 否则你永远不会打破这个循环。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T21:22:59.110

尝试计算 IF 语句之外的时间差。

例如

```
$difference = time() - $_SESSION['timeLogin'];

if($difference > 1800){
    //Do Something
} 
```

# php - 将图像解析为数据 [任何语言]

> ID：11441659
> 
> 赞同：2
> 
> 时间：2012-07-11T21:19:06.027
> 
> 标签：php, c++, asp.net, image, image-processing

我正在尝试向编程语言提供图像并返回一组特定于该类型图像的数据。图像大小可能会改变，某些元素的位置可能会改变。但是，所有元素都将位于相对于特定对象的相同位置。

我需要从图像中提取文本和数字。

这可以用任何语言来完成。我对自己的 PHP/C++ 编程能力最有信心，但我可以做任何事情。只是为了可用性，我可能更喜欢 Windows 应用程序而不是 PHP。

据我所知，这应该是可能的，如果复杂的话。如果有人能指出我正确的方向，我可以从那里开始工作。在这里和 Google 上的搜索只会返回试图从 JSON/XML 等解析图像链接的人。

提前致谢！如果您想了解更多信息，请发表评论

**编辑：**更具体地说，这是为了让一位朋友帮助他自动化领导公会中更繁琐的部分。下面的图片是两个独立的游戏，我希望能够使用它。我需要提取的字段被选中。请记住，图像的大小可能会发生变化（它们只是屏幕截图，可以是任意大小）

[图片已删除]

我需要提取图像和相应的数字。该图像需要与一组图像匹配，以确定数字将使用的“名称”。需要提取该屏幕上的每个项目。

[图片已删除]

在这个游戏中，我需要提取与该用户句柄相对应的名称和捐赠金额。我需要为该页面上的每个用户名执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:30:46.917

从图像中提取文本称为光学字符识别，也称为 OCR。由于您提到 C++，我建议您从[OpenCV](http://opencv.willowgarage.com/wiki/)开始。

这看起来是一个很好的起点：[OpenCV 中的基本 OCR](http://blog.damiles.com/2008/11/basic-ocr-in-opencv/)

在提取图像时。在这种情况下，您想要开始的可能是边缘检测。

[OpenCV 教程，包括边缘检测](http://dasl.mem.drexel.edu/~noahKuntz/openCVTut5.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T22:14:01.847

我从未在 PHP 中使用过 OCR，但我看到这篇文章可能会帮助你。

[http://de77.com/php/ocr-optical-character-recognition-in-php](http://de77.com/php/ocr-optical-character-recognition-in-php)

它利用位于此处的 OCR 库：

[http://jocr.sourceforge.net/download.html](http://jocr.sourceforge.net/download.html)

# c++ - 拇指杆位置只有一次

> ID：11441660
> 
> 赞同：1
> 
> 时间：2012-07-11T21:19:07.107
> 
> 标签：c++, arduino

我正在使用以下代码来确定拇指操纵杆的位置：

```
const int Left = 1;
const int Right = 2;
const int Up = 3;
const int Down = 4;
const int Center = 0;
int lastButton = -1;

int xpin = 4;
int ypin = 5;

int xAxis;
int yAxis;
char* myStrings[]={"Left","Right","Up","Down"};
int button;

void setup() {
    Serial.begin(9600);
}

void loop() {
    xAxis=map(analogRead(xpin), 0, 1023, 0, 10);
    yAxis=map(analogRead(ypin), 0, 1023, 0, 10);

    if (button == lastButton) {
        //Serial.println(0);
        //button = 0;
        delay(50);
    } else {
        if (xAxis < 4 ) {
            button = Left;
        }
        else if (xAxis > 6 ) {
            button = Right;
        }

        if (yAxis < 4 ) {
            button = Down;
        }
        else if (yAxis > 6 ) {
            button = Up;
        }

        Serial.println(myStrings[button-1]);
        button = 0;
        delay(50);
    }

    lastButton = button;
} 
```

上面的代码在我的 arduino 上工作得很好，但我希望只获得**一次**位置，而不是每秒钟都获得一次。

如何将代码更改为仅取**一个值，直到再次居中（0）**？

例子：

如果我将操纵杆向左移动，它会显示：

```
Left
Left
Left
Left
etc etc until i release it. 
```

我想做的是：

```
Left
then it stops until i release it. 
```

任何帮助都会很棒！

**更新**

```
 if (xAxis ==5 ) { 
   button = Center; 
 }

 if (yAxis ==5 ) { 
   button = Center; 
 } 
```

似乎与 Up 和 Down 配合得很好，但对 Left 和 Right 却不是。有时它会起作用，但更多时候却不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:23:30.040

记住上次迭代时的位置，并与之进行比较以查看它是否已更改：

```
int lastButton = 0;
...
void loop() {
    button = ...// Read button state
    ...
    if (button != lastButton) {
        ... // New keypress
        lastButton = button;
    }
} 
```

完整的清理代码：

```
enum ButtonState { Neutral=0, Left=1, Right=2, Up=3, Down=4 };

ButtonState lastButton = Neutral;

const int XPin = 4;
const int YPin = 5;

char* myStrings[]={"Neutral", "Left","Right","Up","Down"};

void setup() {
    Serial.begin(9600);
}

ButtonState readButtonState() {
    int xAxis=map(analogRead(XPin), 0, 1023, 0, 10);
    int yAxis=map(analogRead(YPin), 0, 1023, 0, 10);
    if (xAxis < 4 ) return Left;
    if (xAxis > 6 ) return Right;
    if (yAxis < 4 ) return Down;
    if (yAxis > 6 ) return Up;
    return Neutral;
}

void loop() {
    ButtonState button = readButtonState();
    if (button != lastButton) {
        Serial.println(myStrings[button]);
        lastButton = button;
    }
    delay(50);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:57:17.073

它应该更像这样：

```
const int Left = 1;
const int Right = 2;
const int Up = 3;
const int Down = 4;

int xpin = 4;
int ypin = 5;

int xAxis;
int yAxis;
char* myStrings[]={"Left","Right","Up","Down"};
int button;

void setup() {
  Serial.begin(9600);
}
int lastButton = -1; // init lastButton to a never occurring value

void loop() {

   xAxis=map(analogRead(xpin), 0, 1023, 0, 10);
   yAxis=map(analogRead(ypin), 0, 1023, 0, 10);

   if (xAxis < 4 ) { 
     button = Left; 
   }
   else if (xAxis > 6 ) { 
     button = Right; 
   }

   if (yAxis < 4 ) { 
     button = Down; 
   }
   else if (yAxis > 6 ) { 
     button = Up;
   }

   if (button == lastButton){
       //Serial.println(0);
       //button = 0;
       delay(50); // wait more
   }else{
       lastButton = button;
       Serial.println(myStrings[button-1]);
       button = 0;
       delay(50);
   }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:10:01.073

Check out this google code project, the author really did some great work here. I'm using this in a project of mine and it requires VERY little customization (if any at all).

This is a joystick widget that is already very solid and is easily customizable. I'm always hesitant to use other people's code, but it would have taken me quite a while to make anything as awesome as this.

**Demo**: [http://code.google.com/p/mobile-anarchy-widgets/wiki/JoystickView](http://code.google.com/p/mobile-anarchy-widgets/wiki/JoystickView)

**Source**: [http://code.google.com/p/mobile-anarchy-widgets/source/browse/trunk/Widgets/src/com/MobileAnarchy/Android/Widgets/Joystick/JoystickView.java](http://code.google.com/p/mobile-anarchy-widgets/source/browse/trunk/Widgets/src/com/MobileAnarchy/Android/Widgets/Joystick/JoystickView.java)

# android - (Android) 获取 Facebook 相册的链接

> ID：11441664
> 
> 赞同：1
> 
> 时间：2012-07-11T21:20:02.490
> 
> 标签：android, facebook, facebook-graph-api

我的应用程序将照片上传到用户 Facebook 个人资料中的唯一相册，并且还单独制作了一个墙贴。我想获取照片上传到的相册的链接，这样我就可以在随后的墙贴中显示相册链接。

```
imageParams.putByteArray("picture", byteArray);
        String albumID = facebookConnector.getFacebook().request("me/photos",imageParams,"POST"); 
```

上传图像并将 ID 存储在 String 变量中。

```
getParams.putString("link", link);
        facebookConnector.getFacebook().request("me/albums", getParams, "GET"); 
```

这是我可能需要帮助的一点，因为我不确定我是否以请求理解的方式向它询问我想要的东西。如何获取存储在专辑对象中的 url 'link' 值，用于使用 albumID 变量标识的专辑？

# c++ - cout a stringstream 两次以损坏的 cout 结束（最小示例）

> ID：11441665
> 
> 赞同：1
> 
> 时间：2012-07-11T21:20:05.793
> 
> 标签：c++, cout, stringstream, streambuf

我有以下代码，但我不太明白为什么结果恰好如下所示：

```
#include <iostream>
#include <sstream>

using namespace std;
int main () {

   std::stringstream s;

   std::streambuf *backup;
   backup = cout.rdbuf();

   s << "Oh my god" << endl;

   cout << "Before1" << endl;
       cout << s.rdbuf();
   cout << "After1" << endl;

   cout << "Before2" << endl;
   //s.seekg(0, std::ios_base::beg); // If that is in: After 2 is printed!
   cout << s.rdbuf();
   //cout.rdbuf(backup); // If that is in, also After 2 is printed!
   cout << "After2" << endl;

} 
```

**输出：**

```
Before1
Oh my god
After1
Before2 
```

其余的在哪里？¿ 只有当我们取消注释上述行时才会输出它......内部会发生什么？有人知道吗？=) 会很有趣...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T21:38:37.540

检查失败位是否设置为on `cout`。您也可以只清除失败位，使用`cout.clear()`.

* * *

这是标准（第 27.7.3.6.3 节）中的规则，要求在这种情况下设置失败位：

> `basic_ostream<charT,traits>& operator<<(basic_streambuf<charT,traits>* sb);`
> 
> 效果：表现为未格式化的输出函数。哨兵对象构造完成后，if `sb`is null 调用`setstate(badbit)`（可能会抛出`ios_base::failure`）。
> 
> 从中获取字符`sb`并将它们插入`*this`. 读取`sb`并插入字符，直到发生以下任何情况：
> 
> *   文件结束出现在输入序列上；
> *   在输出序列中插入失败（在这种情况下，不提取要插入的字符）；
> *   从 获取字符时发生异常`sb`。
> 
> **如果函数没有插入任何字符，它会调用`setstate(failbit)`**（可能会抛出`ios_base::failure`）。如果在提取字符时抛出异常，则函数设置`failbit`为错误状态，并且如果`failbit`在`exceptions()`捕获的异常中为 on，则重新抛出。
> 
> 回报：`*this`。

# java - Java 错误：比较方法违反了它的一般约定

> ID：11441666
> 
> 赞同：103
> 
> 时间：2012-07-11T21:20:15.190
> 
> 标签：java, compare, migration, java-7, comparator

我看到了很多关于这个的问题，并试图解决这个问题，但经过一个小时的谷歌搜索和大量的试验和错误，我仍然无法解决它。我希望你们中的一些人发现了这个问题。

这就是我得到的：

```
java.lang.IllegalArgumentException: Comparison method violates its general contract!
    at java.util.ComparableTimSort.mergeHi(ComparableTimSort.java:835)
    at java.util.ComparableTimSort.mergeAt(ComparableTimSort.java:453)
    at java.util.ComparableTimSort.mergeForceCollapse(ComparableTimSort.java:392)
    at java.util.ComparableTimSort.sort(ComparableTimSort.java:191)
    at java.util.ComparableTimSort.sort(ComparableTimSort.java:146)
    at java.util.Arrays.sort(Arrays.java:472)
    at java.util.Collections.sort(Collections.java:155)
    ... 
```

这是我的比较器：

```
@Override
public int compareTo(Object o) {
    if(this == o){
        return 0;
    }

    CollectionItem item = (CollectionItem) o;

    Card card1 = CardCache.getInstance().getCard(cardId);
    Card card2 = CardCache.getInstance().getCard(item.getCardId());

    if (card1.getSet() < card2.getSet()) {
        return -1;
    } else {
        if (card1.getSet() == card2.getSet()) {
            if (card1.getRarity() < card2.getRarity()) {
                return 1;
            } else {
                if (card1.getId() == card2.getId()) {
                    if (cardType > item.getCardType()) {
                        return 1;
                    } else {
                        if (cardType == item.getCardType()) {
                            return 0;
                        }
                        return -1;
                    }
                }
                return -1;
            }
        }
        return 1;
    }
} 
```

任何想法？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2012-07-11T21:31:40.650

异常消息实际上非常具有描述性。它提到的合同是*传递性*： if`A > B`和`B > C`then for any `A`, `B`and `C`: `A > C`。我用纸和铅笔检查了它，你的代码似乎有几个漏洞：

```
if (card1.getRarity() < card2.getRarity()) {
  return 1; 
```

`-1`如果你不返回`card1.getRarity() > card2.getRarity()`。

* * *

```
if (card1.getId() == card2.getId()) {
  //...
}
return -1; 
```

`-1`如果 id 不相等，则返回。您应该返回`-1`或`1`取决于哪个 id 更大。

* * *

看看这个。除了更具可读性之外，我认为它实际上应该可以工作：

```
if (card1.getSet() > card2.getSet()) {
    return 1;
}
if (card1.getSet() < card2.getSet()) {
    return -1;
};
if (card1.getRarity() < card2.getRarity()) {
    return 1;
}
if (card1.getRarity() > card2.getRarity()) {
    return -1;
}
if (card1.getId() > card2.getId()) {
    return 1;
}
if (card1.getId() < card2.getId()) {
    return -1;
}
return cardType - item.getCardType();  //watch out for overflow! 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2016-01-25T19:29:21.837

您可以使用以下类来查明比较器中的传递性错误：

```
/**
 * @author Gili Tzabari
 */
public final class Comparators
{
    /**
     * Verify that a comparator is transitive.
     *
     * @param <T>        the type being compared
     * @param comparator the comparator to test
     * @param elements   the elements to test against
     * @throws AssertionError if the comparator is not transitive
     */
    public static <T> void verifyTransitivity(Comparator<T> comparator, Collection<T> elements)
    {
        for (T first: elements)
        {
            for (T second: elements)
            {
                int result1 = comparator.compare(first, second);
                int result2 = comparator.compare(second, first);
                if (result1 != -result2)
                {
                    // Uncomment the following line to step through the failed case
                    //comparator.compare(first, second);
                    throw new AssertionError("compare(" + first + ", " + second + ") == " + result1 +
                        " but swapping the parameters returns " + result2);
                }
            }
        }
        for (T first: elements)
        {
            for (T second: elements)
            {
                int firstGreaterThanSecond = comparator.compare(first, second);
                if (firstGreaterThanSecond <= 0)
                    continue;
                for (T third: elements)
                {
                    int secondGreaterThanThird = comparator.compare(second, third);
                    if (secondGreaterThanThird <= 0)
                        continue;
                    int firstGreaterThanThird = comparator.compare(first, third);
                    if (firstGreaterThanThird <= 0)
                    {
                        // Uncomment the following line to step through the failed case
                        //comparator.compare(first, third);
                        throw new AssertionError("compare(" + first + ", " + second + ") > 0, " +
                            "compare(" + second + ", " + third + ") > 0, but compare(" + first + ", " + third + ") == " +
                            firstGreaterThanThird);
                    }
                }
            }
        }
    }

    /**
     * Prevent construction.
     */
    private Comparators()
    {
    }
} 
```

只需`Comparators.verifyTransitivity(myComparator, myCollection)`在失败的代码前面调用即可。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2013-11-27T08:05:04.520

它也与JDK的版本有关。如果在JDK6做的好，可能会出现你描述的JDK 7的问题，因为jdk 7的实现方式已经改变了。

看这个：

说明：`java.util.Arrays.sort`和（间接）使用的排序算法`java.util.Collections.sort`已被替换。如果新的排序实现`IllegalArgumentException`检测到`Comparable`违反`Comparable`合同的 a ，它可能会抛出 a 。之前的实现默默地忽略了这种情况。如果需要以前的行为，您可以使用新的系统属性`java.util.Arrays.useLegacyMergeSort`, 来恢复以前的合并排序行为。

我不知道确切的原因。但是，如果在使用排序之前添加代码。会没事的。

```
System.setProperty("java.util.Arrays.useLegacyMergeSort", "true"); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-07-11T21:35:58.810

考虑以下情况：

首先，`o1.compareTo(o2)`被称为。`card1.getSet() == card2.getSet()`碰巧是真的`card1.getRarity() < card2.getRarity()`，所以你返回 1。

然后，`o2.compareTo(o1)`被调用。再次，`card1.getSet() == card2.getSet()`是真的。然后，你跳到下面`else`，然后`card1.getId() == card2.getId()`恰好是真的，所以也是`cardType > item.getCardType()`。你再次返回 1。

由此`o1 > o2`， 和`o2 > o1`。你违反了合同。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-11T21:35:01.057

```
 if (card1.getRarity() < card2.getRarity()) {
            return 1; 
```

但是，如果`card2.getRarity()`小于`card1.getRarity()`您可能不会返回**-1**。

您同样会错过其他情况。我会这样做，您可以根据自己的意图进行更改：

```
public int compareTo(Object o) {    
    if(this == o){
        return 0;
    }

    CollectionItem item = (CollectionItem) o;

    Card card1 = CardCache.getInstance().getCard(cardId);
    Card card2 = CardCache.getInstance().getCard(item.getCardId());
    int comp=card1.getSet() - card2.getSet();
    if (comp!=0){
        return comp;
    }
    comp=card1.getRarity() - card2.getRarity();
    if (comp!=0){
        return comp;
    }
    comp=card1.getSet() - card2.getSet();
    if (comp!=0){
        return comp;
    }   
    comp=card1.getId() - card2.getId();
    if (comp!=0){
        return comp;
    }   
    comp=card1.getCardType() - card2.getCardType();

    return comp;

    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-10-18T09:55:05.300

它也可能是一个 OpenJDK 错误......（在这种情况下不是，但它是相同的错误）

如果像我这样的人偶然发现这个关于

```
java.lang.IllegalArgumentException: Comparison method violates its general contract! 
```

那么它也可能是Java版本中的一个错误。我在某些应用程序中运行了几年以来的 compareTo。但突然它停止工作并在所有比较完成后抛出错误（我在返回“0”之前比较了 6 个属性）。

现在我刚刚发现了这个 OpenJDK 的 Bugreport：

*   **JDK-8210311**
*   影响版本/秒：8、11
*   修复版本/秒：12
*   [https://bugs.openjdk.java.net/browse/JDK-8210311](https://bugs.openjdk.java.net/browse/JDK-8210311)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-12-25T11:48:37.607

我遇到了一个类似的问题，我试图对一个简单`n x 2 2D array`整数`contests`的二维数组进行排序。这在大多数情况下都有效，但为一个输入引发了运行时错误：-

```
Arrays.sort(contests, (row1, row2) -> {
            if (row1[0] < row2[0]) {
                return 1;
            } else return -1;
        }); 
```

错误：-

```
Exception in thread "main" java.lang.IllegalArgumentException: Comparison method violates its general contract!
    at java.base/java.util.TimSort.mergeHi(TimSort.java:903)
    at java.base/java.util.TimSort.mergeAt(TimSort.java:520)
    at java.base/java.util.TimSort.mergeForceCollapse(TimSort.java:461)
    at java.base/java.util.TimSort.sort(TimSort.java:254)
    at java.base/java.util.Arrays.sort(Arrays.java:1441)
    at com.hackerrank.Solution.luckBalance(Solution.java:15)
    at com.hackerrank.Solution.main(Solution.java:49) 
```

查看上面的答案，我尝试添加条件，`equals`但我不知道为什么，但它有效。希望我们必须明确指定所有情况下应返回的内容（大于、等于和小于）：

```
 Arrays.sort(contests, (row1, row2) -> {
            if (row1[0] < row2[0]) {
                return 1;
            }
            if(row1[0] == row2[0]) return 0;
            return -1;
        }); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-06-07T18:43:59.383

我有同样的症状。对我来说，事实证明另一个线程正在修改比较对象，而排序发生在 Stream 中。为了解决这个问题，我将对象映射到不可变的临时对象，将 Stream 收集到一个临时 Collection 并对其进行排序。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-04-09T01:46:09.970

我在类似以下的类中遇到了同样的错误`StockPickBean`。从此代码调用：

```
List<StockPickBean> beansListcatMap.getValue();
beansList.sort(StockPickBean.Comparators.VALUE);

public class StockPickBean implements Comparable<StockPickBean> {
    private double value;
    public double getValue() { return value; }
    public void setValue(double value) { this.value = value; }

    @Override
    public int compareTo(StockPickBean view) {
        return Comparators.VALUE.compare(this,view); //return 
        Comparators.SYMBOL.compare(this,view);
    }

    public static class Comparators {
        public static Comparator<StockPickBean> VALUE = (val1, val2) -> 
(int) 
         (val1.value - val2.value);
    }
} 
```

得到同样的错误后：

> java.lang.IllegalArgumentException：比较方法违反了它的一般约定！

我改变了这一行：

```
public static Comparator<StockPickBean> VALUE = (val1, val2) -> (int) 
         (val1.value - val2.value); 
```

至：

```
public static Comparator<StockPickBean> VALUE = (StockPickBean spb1, 
StockPickBean spb2) -> Double.compare(spb2.value,spb1.value); 
```

这修复了错误。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-09-02T11:58:56.023

我必须对几个标准进行排序（日期，以及，如果相同的日期；其他事情......）。在 Eclipse 上使用旧版本 Java 的工作，在 Android 上不再工作：比较方法违反合同......

在阅读了 StackOverflow 之后，我编写了一个单独的函数，如果日期相同，我会从 compare() 调用该函数。此函数根据条件计算优先级，并将 -1、0 或 1 返回给 compare()。它现在似乎起作用了。

# mysql - mysql更新动态列名

> ID：11441669
> 
> 赞同：0
> 
> 时间：2012-07-11T21:20:34.983
> 
> 标签：mysql

我正在尝试更新列名是变量的表，以便可以通过包含列名的数组的迭代来指定它。例如：

```
UPDATE my_table
    SET $column_name=$foo
    WHERE something=$bar 
```

SET 语法是问题所在。我尝试通过连接构建查询，但嵌套的引号让我很困惑。硬连线列规范有效。

这是我尝试在不生成 PHP 错误但在某处失败的版本中构建的实际查询。想法是将列 $v 设置为表 baccess 中的字母 N（简化细节）。

```
mysql_query("UPDATE baccess SET " . $v . "=N
WHERE studentid=$_SESSION[student_id]") 
or die(mysql_error()); 
```

谢谢

# eclipse - Eclipse 标尺背景颜色

> ID：11441677
> 
> 赞同：6
> 
> 时间：2012-07-11T21:21:02.143
> 
> 标签：eclipse

1.  如何更改日食垂直标尺背景颜色？
2.  包含折叠圈的标尺/列的名称是什么？
3.  如何更改上述标尺/clomun 的背景颜色？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-08T05:39:03.857

> ```
> what is name of the ruler/column that includes the folding circles? 
> ```

它被称为代码折叠边距，或简称折叠边距。

> ```
> How can I change eclipse Vertical Ruler background color?
> How can I change the background color of the above ruler/clomun? 
> ```

恐怕 Eclipse 有许多不可自定义的 UI 设置，这两个就是其中之一。已提出功能请求以允许更改代码折叠边距。[代码折叠的背景颜色](https://bugs.eclipse.org/bugs/show_bug.cgi?id=194313)鉴于该请求已经存在超过 5 年，我不太乐观你会得到一个解决方案。你可以评论这个问题来提高它。

您还可以在他们的 bugtracker 页面上提出功能请求。[https://bugs.eclipse.org/bugs/](https://bugs.eclipse.org/bugs/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T13:44:59.200

通常我将我的颜色与 Eclipse 提供的默认设置一起使用，但我知道很多人喜欢 Eclipse 的替代外观（通常使用深色主题），所以，我决定试一试......

要更改默认颜色，您必须在窗口 > 首选项菜单中查看一些地方：

```
General > Editors > Text Editors (to set the background color / selection color, etc. for all editors)

General > Editors > Text Editors > Annotations (to set the colors for the occurrences highlight, tasks, etc.)

Pydev > Editor (to set the pydev editor-related colors)

General > Appearance > Colors an Fonts (to set what's not available in the other places) 
```

现在，在您正确设置了这些颜色之后，您真正应该做的一件事是导出您刚刚更改的首选项，以便以后可以导入它们。

为此，请转到 File > Export > Preferences 并将所有首选项导出到一个文件，然后打开该文件并删除所有与颜色无关的首选项（除了 file_export_version，Eclipse 在导入时需要它）——注意您也可以保留您一直输入的其他首选项，并且使用干净的 Eclipse 安装仅使用您想要配置的内容可能会更容易（这样您在该首选项文件中就没有太多首选项）。

稍后，您可以通过 File > Import > Preferences 在 Eclipse 中导入这些首选项。

我使用的深色主题的首选项给出了以下结果（请注意，您可能必须重新启动 Eclipse 以使左侧标尺看起来正确）：

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T13:59:31.253

您只能使用 Preferences -> General -> Editors -> Text Editors -> Annotations 配置垂直标尺中显示的内容。你不能禁用它。希望这会有所帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-29T08:09:14.013

这不是一个彻底的答案，但这是我在调试时提取的 SWT 间谍日志：

```
AnnotationRulerColumn$5 {}@140230138540928
  Style: NO_FOCUS | LEFT_TO_RIGHT | DOUBLE_BUFFERED 
  Layout Data: null
  Bounds: Rectangle {44, 0, 9, 206}

Children:

Peers:
  *AnnotationRulerColumn$5 {}@140230138540928 Layout Data: null Bounds: Rectangle {44, 0, 9, 206}
  AnnotationRulerColumn$5 {}@140230141853568 Layout Data: null Bounds: Rectangle {0, 0, 12, 206}
  LineNumberRulerColumn$4 {}@140230140489248 Layout Data: null Bounds: Rectangle {12, 0, 32, 206}

Parent Tree:
[CUT]

                                                       Canvas {}@139916372127008
                                                         Style: LEFT_TO_RIGHT | DOUBLE_BUFFERED 
                                                         Bounds: Rectangle {0, 0, 954, 276}
                                                         Layout: org.eclipse.jface.text.source.SourceViewer$RulerLayout@4a767290
                                                         LayoutData: null
                                                        CompositeRuler$CompositeRulerCanvas {}@139916355542160
                                                             Style: LEFT_TO_RIGHT | DOUBLE_BUFFERED 
                                                             Bounds: Rectangle {0, 0, 29, 258}
                                                             Layout: org.eclipse.jface.text.source.CompositeRuler$RulerLayout@76b6b86f
                                                             LayoutData: null 
```

``

# android - 微调器无法解析或不是字段

> ID：11441680
> 
> 赞同：-1
> 
> 时间：2012-07-11T21:21:07.437
> 
> 标签：android

我正在研究 SDK 中的 ApiDemos 示例并尝试将 Menu 示例（App/Menu/Inflate 与 Menu-MenuInflateFromXml.java 分开）。

```
package my.android.Menu;

import my.android.Menu.R;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.widget.ArrayAdapter;
import android.widget.LinearLayout;
import android.widget.Spinner;
import android.widget.TextView;
import android.widget.Toast;

public class MyMenu extends Activity {

    /**
     * Different example menu resources.
     */
    private static final int sMenuExampleResources[] = {
        R.menu.title_only, R.menu.title_icon, R.menu.submenu, R.menu.groups,
        R.menu.checkable, R.menu.shortcuts, R.menu.order, R.menu.category_order,
        R.menu.visible, R.menu.disabled
    };

    /**
     * Names corresponding to the different example menu resources.
     */
    private static final String sMenuExampleNames[] = {
        "Title only", "Title and Icon", "Submenu", "Groups",
        "Checkable", "Shortcuts", "Order", "Category and Order",
        "Visible", "Disabled"
    };

    /**
     * Lets the user choose a menu resource.
     */
    private Spinner mSpinner;

    /**
     * Shown as instructions.
     */
    private TextView mInstructionsText;

    /**
     * Safe to hold on to this.
     */
    private Menu mMenu;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

     // Create a simple layout
        LinearLayout layout = new LinearLayout(this);
        layout.setOrientation(LinearLayout.VERTICAL);   

     // Create the spinner to allow the user to choose a menu XML
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
                android.R.layout.simple_spinner_item, sMenuExampleNames); 
        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        mSpinner = new Spinner(this);

        // When programmatically creating views, make sure to set an ID
        // so it will automatically save its instance state

        mSpinner.setId(R.id.spinner);//Error Line
        mSpinner.setAdapter(adapter);

        setContentView(R.layout.main);
    }
} 
```

IDE 显示此错误“微调器无法解析或不是字段”，我无法继续。我没有看到任何包含“微调器”的 XML 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:43:34.977

As per Tim's comment above:

put this line in your `onCreate()`

```
mSpinner = (Spinner) findViewById(R.id.spinner); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T22:11:15.633

您应该将您的`setContentView(R.layout.main);`右下方移到`super.onCreate(savedInstanceState);`It's necessary to set the content of your Activity before using its Views 并且您不需要以编程方式实例化微调器视图。只需使用在**main.xml**文件中定义的 Spinner（我假设您在此文件中有一个 Spinner）。

```
 /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

     // Create a simple layout
        LinearLayout layout = new LinearLayout(this);
        layout.setOrientation(LinearLayout.VERTICAL);   

     // Create the spinner to allow the user to choose a menu XML
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
                android.R.layout.simple_spinner_item, sMenuExampleNames); 
        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        //mSpinner = new Spinner(this);

        // When programmatically creating views, make sure to set an ID
        // so it will automatically save its instance state

        // mSpinner.setId(R.id.spinner);//Error Line
        mSpinner = (Spinner) findViewById(R.id.you_spinner_id); //you_spinner_id must be defined at main.xml
        mSpinner.setAdapter(adapter);
    } 
```

# osgi - 我可以使用 ConfigAdmin 在 OSGi 中创建临时配置吗？

> ID：11441681
> 
> 赞同：0
> 
> 时间：2012-07-11T21:21:11.810
> 
> 标签：osgi, equinox, apache-felix

我想在 OSGi 中创建一个配置对象，但不会持久化，因此在重新启动框架时它不会存在。类似于捆绑包的 START_TRANSIENT。

一些背景知识：我有一个基于 OSGi (Felix) 的客户端应用程序，部署在 OBR 上。我正在谈论的配置对象有效地启动了应用程序。这很好用，但有时内容在上下文停止时发生了变化。在这种情况下，它会在 OSGi 恢复所有捆绑包并添加所有配置选项时启动应用程序。然后我注入正确的配置，应用程序停止，然后再次重新启动。

所以它*确实有效*，但是应用程序启动了两次，在它重建其旧状态之前我无法访问框架。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T23:36:42.853

OSGi 配置管理规范不支持这一点。对于我熟悉的任何 CM impl，我也不知道非标准方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T00:50:38.090

正如 BJ 所说，Configuration Admin 规范中没有对此的标准支持。

但是，[Felix 实现](http://felix.apache.org/site/apache-felix-config-admin.html)支持两个可能对您有所帮助的功能。首先，您可以设置`felix.cm.dir`配置 configadmin 保存其内部状态的位置的属性（默认情况下将在 Framework 存储目录下的某个位置）。您可以将其设置为您控制的位置，然后在每次启动 OSGi 时简单地擦除它（您也可以在每次启动时擦除整个 OSGi 框架存储目录......有些人这样做，但它会产生更广泛的后果要求）。

其次，如果您需要更多控制，Felix ConfigAdmin 支持使用[`PersistenceManager`服务](http://svn.apache.org/viewvc/felix/releases/org.apache.felix.configadmin-1.0.8/src/main/java/org/apache/felix/cm/PersistenceManager.java?revision=734642&view=markup)自定义其持久性。您可能可以实现这一点并为您想要控制的特定 pid 返回空/不存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T08:38:09.190

好的，我最后做了以下事情：

*   我创建了一个特殊的非常小的“引导”包，我没有从 OBR 提供它，而是从类路径安装它。

*   *该*捆绑包控制配置，当我真的想加载该配置时，我使用 START_TRANSIENT 。

不完全漂亮，它完成了工作。我确实认为在 OSGi 中进行临时配置是有意义的。

# javascript - Rails javascript不适用于heroku雪松

> ID：11441682
> 
> 赞同：1
> 
> 时间：2012-07-11T21:21:16.873
> 
> 标签：javascript, ruby-on-rails-3, heroku, production

我正在尝试在生产者环境中的 heroku 上运行我的应用程序，但我的 javascript 在那里不起作用。我的开发环境运行良好。所以当我把它推到heroku时它就下来了。

我的宝石文件是：

```
 source 'https://rubygems.org'
ruby '1.9.3'

gem 'rails', '3.2.6'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'bourbon'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
  gem 'asset_sync'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer'
  gem 'twitter-bootstrap-rails'
end

group :production, :staging do
  gem 'unicorn'
  gem 'pg'
  gem 'fog'
  gem 'newrelic_rpm'
end

group :development, :test do
    gem 'rspec-rails', '~> 2.8.0'
    gem 'webrat', '~> 0.7.3'
    gem 'simplecov'
    gem 'sqlite3'
end

gem 'heroku'
gem 'jquery-rails'
gem 'simple_form', :git => 'git://github.com/plataformatec/simple_form.git'
gem 'devise'
gem 'friendly_id', '~> 4.0.1'
gem 'validates_cnpj'
gem 'RedCloth'
gem 'best_in_place'
gem 'delocalize'
gem 'carrierwave'
gem 'rmagick'
gem 'geocoder'
gem 'kaminari'
gem 'simple-navigation'
gem 'omniauth-facebook'
gem 'koala'
gem 'whenever', :require => false
gem 'delayed_job_active_record' 
```

所以我的资产编译正确，没有错误，并且全部发送到 amazon s3。

如果我把这一行放在 HTML 的开头，一些 javascript 就开始工作了。

```
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script> 
```

在我的应用程序中有一个 gmaps，当我调试我的应用程序时，我发现 javascript 只在地图所在的地方工作，所以我把这条线放在头上，javascript 开始工作。

有人可以帮我吗？我不知道为什么我的应用程序会出现这个问题。

谢谢

# mysql - mysql join 从 3 个表中获取数据，时间和 int 的加法作为求和值的倍数得到错误

> ID：11441687
> 
> 赞同：0
> 
> 时间：2012-07-11T21:21:30.977
> 
> 标签：mysql, database

我需要获取飞机的名称（aircraft_type），单架飞机的时间总和（aircraft_master 上的标志 A），为单架飞机支付的费用总和（费用表下的 ac_id）

使用查询作为

```
select
  t1.aircraft_type,
  sec_to_time(sum(time_to_sec(t2.ft_duration))),
  sum(t3.fee_amount)
from
  aircraft_master t1 
  left join flying_test t2 on t2.ac_id = t1.ac_id
  left join fees_detail t3 on t3.ac_id = t1.ac_id
where
  t2.per_detail_id = '12'
  and t3.per_detail_id = '12'
group by
  t1.ac_id] 
```

没有加入 fly_test 我得到正确的飞行时间；无需付费加入，我就能获得为单架飞机支付的正确金额。使用这两种方法我得到了很多时间和费用。

SQL表和数据：

```
-- phpMyAdmin SQL Dump
-- version 3.4.5
-- http://www.phpmyadmin.net
--
-- Host: localhost
-- Generation Time: Jul 11, 2012 at 11:07 PM
-- Server version: 5.5.16
-- PHP Version: 5.3.8

SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+00:00";

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;

--
-- Database: `aviation`
--

-- --------------------------------------------------------

--
-- Table structure for table `aircraft_master`
--

CREATE TABLE IF NOT EXISTS `aircraft_master` (
  `ac_id` int(10) NOT NULL AUTO_INCREMENT,
  `aircraft_type` varchar(50) DEFAULT NULL,
  `aircraft_engine` varchar(150) DEFAULT NULL,
  `flag` varchar(1) DEFAULT NULL,
  PRIMARY KEY (`ac_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=22 ;

--
-- Dumping data for table `aircraft_master`
--

INSERT INTO `aircraft_master` (`ac_id`, `aircraft_type`, `aircraft_engine`, `flag`) VALUES
(1, NULL, 'Single Engine', 'E'),
(2, NULL, 'Multi Engine', 'E'),
(3, 'CH2T', '1', 'A'),
(4, 'C172', '1', 'A'),
(5, 'C152', '1', 'A'),
(6, 'VT-SMT', '3', 'R'),
(7, 'VT-MDU', '3', 'R'),
(8, 'VT-RIT', '3', 'R'),
(9, 'VT-AFA', '4', 'R'),
(10, 'VT-TSM', '4', 'R'),
(11, 'VT-AFR', '4', 'R'),
(12, 'VT-RRM', '4', 'R'),
(13, 'VT-JSN', '4', 'R'),
(14, 'VT-AKN', '5', 'R'),
(15, 'VT-PBA', '5', 'R'),
(16, 'VT-AKA', '5', 'R'),
(17, 'VT-AFN', '5', 'R'),
(18, 'VT-AFN', '5', 'R'),
(19, 'VT-EMO', '5', 'R'),
(20, 'VT-EMP', '5', 'R'),
(21, 'VT-RJT', '3', 'R');

-- --------------------------------------------------------

--
-- Table structure for table `fees_detail`
--

CREATE TABLE IF NOT EXISTS `fees_detail` (
  `fee_id` int(11) NOT NULL AUTO_INCREMENT,
  `per_detail_id` int(10) NOT NULL,
  `fee_detail_id` varchar(10) NOT NULL,
  `fee_date` date DEFAULT NULL,
  `mode_id` int(11) DEFAULT NULL,
  `fee_amount` int(10) DEFAULT NULL,
  `bank_id` int(20) DEFAULT NULL,
  `bank_branch` varchar(100) DEFAULT NULL,
  `chqdd_no` int(20) DEFAULT NULL,
  `fee_comment` varchar(150) DEFAULT NULL,
  `fee_posting_time` datetime NOT NULL,
  `ac_id` int(10) DEFAULT NULL,
  PRIMARY KEY (`fee_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=19 ;

--
-- Dumping data for table `fees_detail`
--

INSERT INTO `fees_detail` (`fee_id`, `per_detail_id`, `fee_detail_id`, `fee_date`, `mode_id`, `fee_amount`, `bank_id`, `bank_branch`, `chqdd_no`, `fee_comment`, `fee_posting_time`, `ac_id`) VALUES
(16, 12, '9', '2012-06-13', 87, 70000, NULL, NULL, NULL, 'c172', '2012-06-16 17:20:34', 4),
(17, 12, '10', NULL, NULL, 10000, NULL, NULL, NULL, NULL, '0000-00-00 00:00:00', 3),
(18, 12, '10', NULL, NULL, 10000, NULL, NULL, NULL, NULL, '2012-07-10 12:00:05', 3);

-- --------------------------------------------------------

--
-- Table structure for table `flying_test`
--

CREATE TABLE IF NOT EXISTS `flying_test` (
  `ft_id` int(10) NOT NULL AUTO_INCREMENT,
  `ft_from` varchar(10) DEFAULT NULL,
  `ft_from_time` time DEFAULT NULL,
  `ft_to` varchar(10) DEFAULT NULL,
  `ft_to_time` time DEFAULT NULL,
  `ft_pic` varchar(50) DEFAULT NULL,
  `ft_engine` varchar(10) DEFAULT NULL,
  `per_detail_id` int(10) NOT NULL,
  `ft_remark` varchar(512) DEFAULT NULL,
  `ft_type` int(3) DEFAULT NULL,
  `ft_ftftpr` int(10) DEFAULT NULL,
  `ft_nature_exercise` int(3) DEFAULT NULL,
  `ftpr_ut` varchar(150) DEFAULT NULL,
  `ftpr_co_pilot` varchar(150) DEFAULT NULL,
  `ftpr_pi_us` varchar(150) DEFAULT NULL,
  `ft_status` int(3) DEFAULT NULL,
  `ft_aircraft` int(5) DEFAULT NULL,
  `ft_regno` int(3) DEFAULT NULL,
  `ft_landings` int(3) DEFAULT NULL,
  `ft_duration` time DEFAULT NULL,
  `fee_detail_id` int(10) DEFAULT NULL,
  `ft_act` time DEFAULT NULL,
  `ft_sim` time DEFAULT NULL,
  `ft_simulator` time DEFAULT NULL,
  `ft_dh` int(3) DEFAULT NULL,
  `ft_exercise` int(3) DEFAULT NULL,
  `ft_date` date DEFAULT NULL,
  PRIMARY KEY (`ft_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=83 ;

--
-- Dumping data for table `flying_test`
--

INSERT INTO `flying_test` (`ft_id`, `ft_from`, `ft_from_time`, `ft_to`, `ft_to_time`, `ft_pic`, `ft_engine`, `per_detail_id`, `ft_remark`, `ft_type`, `ft_ftftpr`, `ft_nature_exercise`, `ftpr_ut`, `ftpr_co_pilot`, `ftpr_pi_us`, `ft_status`, `ft_aircraft`, `ft_regno`, `ft_landings`, `ft_duration`, `fee_detail_id`, `ft_act`, `ft_sim`, `ft_simulator`, `ft_dh`, `ft_exercise`, `ft_date`) VALUES
(79, 'VISL', '10:00:00', 'VISL', '23:00:00', 'vcvc', '1', 12, 'dss', NULL, 16, 101, NULL, NULL, NULL, 20, 3, 8, 1, '15:30:00', 10, '00:00:00', '00:00:00', '00:00:00', 18, 38, '2012-07-07'),
(80, NULL, NULL, NULL, NULL, NULL, NULL, 12, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 4, NULL, NULL, '02:30:00', 9, NULL, NULL, NULL, NULL, NULL, '2012-07-25'),
(81, NULL, NULL, NULL, NULL, NULL, NULL, 12, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 3, NULL, NULL, '02:30:00', 10, NULL, NULL, NULL, NULL, NULL, '2012-07-25'),
(82, 'VISL', '15:30:00', 'VISL', '15:45:00', 'none', '1', 12, 'none', NULL, 16, 100, NULL, NULL, NULL, 20, 3, 6, 1, '00:15:00', NULL, '00:00:00', '00:00:00', '00:00:00', 18, 38, '2012-07-11');

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T22:00:55.847

您有一个经典问题，您将一个表连接到其他几个表，但需要部分聚合。

您需要通过加入子查询来解决这个问题：

```
select t1.aircraft_type,
       s1.val,
       sus2.fees
from (select t1.aircraft_type, sec_to_time(sum(time_to_sec(t2.ft_duration))) as val 
      from aircraft_master t1 left join
           flying_test t2
           on t2.ac_id = t1.ac_id
      where t2.per_detail_id = '12'
      group by t1.aircraft_type
     ) s1 left outer join
     (select ac_id, sum(t3.fee_amount) as fees
      from fees_detail
      where t3.per_detail_id = '13'
      group by ac_id
     ) s2
     on s2.ac_id = s1.ac_id 
```

如果这不完全正确，我深表歉意。我的浏览器有问题，所以我希望你能明白。

# node.js - EC2上的clod9，访问问题

> ID：11441688
> 
> 赞同：0
> 
> 时间：2012-07-11T21:21:38.800
> 
> 标签：node.js, cloud9-ide

js社区，

我设法在我的亚马逊 EC2 Linux 发行版上安装了 cloud9，但我很难尝试访问它。

我像这样启动 cloud9 bin/cloud9.sh -l 0.0.0.0 -p 3131 它开始

然后我使用以下网址访问云 9 [http://ec2-XX-XXX-XX-XXX.eu-west-1.compute.amazonaws.com:3131/](http://ec2-XX-XXX-XX-XXX.eu-west-1.compute.amazonaws.com:3131/)

它给了我以下错误

```
IDE server initialized. Listening on 0.0.0.0:3131
path.exists is now called `fs.exists`.

node.js:0
// Copyright Joyent, Inc. and other Node contributors.
^
RangeError: Maximum call stack size exceeded 
```

我还在安全组中为端口 3131 使用自定义 tcp 打开端口。

我是否缺少一些配置文件或任何东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T01:47:41.380

在您上面的评论中，您表明您正在使用 node.js v0.8.2

但是，根据安装自述文件，cloud9 将无法在 node.js v0.8.xx 上运行：[https ://github.com/ajaxorg/cloud9/blob/master/README.md](https://github.com/ajaxorg/cloud9/blob/master/README.md)

[从这个 Github 问题页面， cloud9](https://github.com/ajaxorg/cloud9/issues/1896)的 node.js 推荐版本似乎是 0.6.1.9：https://github.com/ajaxorg/cloud9/issues/1896

# django - Apache 虚拟连接、Django、mod_wsgi

> ID：11441689
> 
> 赞同：1
> 
> 时间：2012-07-11T21:21:39.707
> 
> 标签：django, apache, mod-wsgi, dreamhost

我在共享环境（Dreamhost）中使用 Django 运行站点，但在本地环境中使用 1.4。

有时，我会受到许多 Apache 虚拟连接（例如`[10/Jul/2012:00:49:16 -0700] "OPTIONS * HTTP/1.0" 200 136 "-" "Apache (internal dummy connection)"` ）的影响，这会导致站点无响应（它会因资源消耗或最大连接数而被杀死）。

这不会在此帐户的其他站点上发生（尽管没有一个正在运行 Django）。我试图找出一种方法来防止这种情况发生，但我不确定要使用什么故障排除过程。关于这个问题的过程或共同来源的指导将是有用的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:56:26.370

尝试：

```
<Limit OPTIONS>
Order allow,deny
Deny from all
</Limit> 
```

这将导致 Apache 返回 403 禁止，并且如果问题是他们目前正在进入应用程序，则不会将其传递给任何 Django 应用程序。

# php - 聚合数组并在详细信息旁边显示聚合结果

> ID：11441691
> 
> 赞同：1
> 
> 时间：2012-07-11T21:21:44.550
> 
> 标签：php, arrays, oop, yii

我有一个`$department`变量，它是一个`Department`类的实例。

该类`Department`有一个名为的属性`$employees`，其中包含与该部门相关的实例数组`Employee`（从数据库中检索）。

该类`Employee`有一个名为`$salary_amount`and的属性`$job_type_id`。`$employees`数组元素按`$job_type_id`排序。

对于指定的部门，我正在输出该部门的员工列表，如下所示：

```
Employees for IT Department
----------------------------

<?php foreach($department->employees as $employee): ?>
  <?php echo $employee->name; ?>
  <?php echo $employee->salary_amount; ?>
<?php endforeach; ?> 
```

**什么是一种有效的操作方式，以便我可以** **在员工列表旁边显示****每个**`$department->employees` **人的总和？** `$salary_amount` **`$job_type_id`**

 ****```
Employees for IT Department
----------------------------

## Help Desk ##

Joseph Lazar
$47,000

John Q. Smith
$15,444

--> Total Salary for Help Desk: $62,444

## Database Administrator ##

Piet Pietersen
$55,120

Ivan Horvat
$63,750

--> Total Salary for Help Desk: $118,870 
```

**当前方法**

目前，`$employees`由单个 SQL 查询填充，按我想要的方式排序结果。[然后，我运行一个单独的 SQL 查询，使用另一个问题](https://stackoverflow.com/questions/11394954/grouped-aggregations-with-yii-stat)的技术来`$salary`获取每个总和的数组。`$job_type_id`

但是，第二个查询的结果集存储在不同的变量`$subtotals`中。因此，我仍然存在有效地让 Sum-Total 与员工列表“在上下文中”显示的问题。

我碰巧正在使用[Yii 框架](http://www.yiiframework.com)，但这可能无关紧要，除非我应该从完全不同的角度考虑或处理这类问题？请在评论中告诉我。

**更新 1**

这是我正在使用的当前代码，但是感觉很混乱，并且可能有更好的方法。如上所述，聚合是由单独的 SQL 完成的，但是我愿意接受替代方案。

```
<?php 

$employee_key = 0;
$employees_count = sizeof($department->employees);

$type_sum_key = 0;
$current_type_in_focus = null;
$next_type_in_focus = null;

foreach($department->employees as $employee)
{
  $current_type_in_focus = $employee->job_type_id;
  $next_type_in_focus = (isset($department->employees[$employee_key+1])) ? $department->employees[$employee_key+1]->job_type_id : null;

  # output individual employee data
  echo $employee->name;
  echo $employee->salary_amount;

  # output aggregated total for job type
  if ( $current_type_in_focus !== $next_type_in_focus || $employee_key+1 == $employees_count )
  {
    echo '--> Total Salary for ' . $employee->jobType->name . ': ' . $department->subtotals[$type_sum_key]->total;
    $type_sum_key++; 
  }

  $income_key++;
}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T23:12:56.263

一种方法是使用 while 循环。例如（为了清楚起见，以下代码示例不格式化输出，它还输出 job_type_id 而不是描述，因为问题中未显示该数据）：

```
 $employees = $department->employees;
    $employee = current($employees);

    while($employee)
    {
        $job_type_id = $employee->job_type_id;
        $total_salary = 0;

        echo "## Job Type $job_type_id ##";

        while ($employee && $employee->job_type_id == $job_type_id)
        {
            echo $employee->name;
            echo $employee->salary_amount;
            $total_salary += $employee->salary_amount;
            $employee = next ($employees);
        }

        echo "-->Total Salary for Job Type $job_type_id: $total_salary";
    } 
```****

# sql - 并排合并来自不同表的匹配数据

> ID：11441696
> 
> 赞同：2
> 
> 时间：2012-07-11T21:22:19.443
> 
> 标签：sql

我有一个 select 语句，它从一个每月汇总表中收集数据，如下所示

```
companyname, employee, id, usage_a, ... usage_m 
```

我需要从 6 个每月汇总表创建报告，如下所示

```
companyname, employee, id, 
jan_usage_a, ...june_usage_a, average (jun_jan_usage_a), 
...  
jan_usage_m, ...june_usage_m, average (jan_jun_usage_m) 
```

我用更少的列做了类似的事情，但是我必须为每个月的使用情况创建一个包含列的表，然后使用单个查询逐月合并数据。最后，我将导出到 excel 创建另一列，以平均所需月份的每次使用情况。

对于上面的报告，我必须创建一个超过一百列的表格。我的问题是有没有更好的方法来做到这一点？谢谢。

对不起，如果标题有点不清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:46:54.417

如果您有六个不同的表，则需要将它们连接在一起：

```
select tjan.companyname, tjan.employee, tjan.id, <rest of tjan columns>, <rest of jfeb columns>
from tjan join
     tfeb 
     on tjan.companyname = tfeb.companyname and
        tjan.employee = tfeb.employee and
        tjan.id = tfeb.id
etc. etc. etc. 
```

您遇到的问题是不同月份的人口可能不同，因此连接会丢失行。处理此问题的一个好方法是使用驱动表：

```
select . . .
from (select companyname, employee, id from tjan union
      select companyname, employee, id from tfeb union
      . . .
     ) driving left outer join
     tjan
     on tjan.companyname = driving.companyname and
        tjan.employee = driving.employee and
        tjan.id = driving.id left outer join
     tfeb
     on tfeb.companyname = driving.companyname and
        tfeb.employee = driving.employee and
        tfeb.id = driving.id left outer join
    . . . 
```

您可以在一条 SQL 语句中完成所有这些操作。有重复的部分（比如select中的列名）。考虑使用 Excel 来生成这些。

# android - minSdkVersion 破解程序

> ID：11441701
> 
> 赞同：1
> 
> 时间：2012-07-11T21:22:34.613
> 
> 标签：android

所以每当我添加

```
<uses-sdk android:minSdkVersion = "7"></uses-sdk> 
```

我的应用程序拒绝正常工作。用户界面是微型的（字体小，按钮比平时小）。我尝试将 minversion 从 7-15 更改，但没有一个起作用。我的手机是 4.0.4 每次我拿出

```
<uses-sdk android:minSdkVersion> 
```

它完美地工作。可悲的是谷歌市场需要这个，我不能上传应用程序不起作用。有任何想法吗？如果我需要提供更多信息，请询问，非常感谢！

该应用程序主要是一个XML应用程序，没有图形界面，只有原生按钮等。我正在使用`Theme.Holo.Light`主题。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:41:03.003

The easy fix is likely to set `minSdkVersion` to 1; this should give you the same behavior as leaving it out, but allow you to upload your app to the Play store.

The better solution would be to set it to an appropriate value based on what APIs you use and testing it on various devices, and adjust your layouts to work appropriately.

# jquery - 我的 div 滑块没有拉入内部 div

> ID：11441703
> 
> 赞同：1
> 
> 时间：2012-07-11T21:22:39.343
> 
> 标签：jquery, slider

**Javascript：**

```
function Slider() {
    $(".slider #1").show("fade", 500);
    $(".slider #1").delay(5500).hide("slide", {
        direction: 'left'
    }, 500);
    var sc = $(".slider div").size();
    var count = 2;
    setInterval(function() {
        $(".slider #" + count).show("slide", {
            direction: 'right'
        }, 500);
        $(".slider #" + count).delay(5500).hide("slide", {
            direction: 'left'
        }, 500);
        if (count == sc) {
            count = 1;
        } else {
            count = count + 1;
        }
    }, 6500);
}​ 
```

**HTML：**

```
<div class="slider">
  <div id="1" style="position:relative">
    <img src=". .  ." />
    <div>
      <p style="width:350px; position:absolute; top:100px; left:10px">TEXT . .  .</p>
    </div>
  </div>
  <div id="2" style="position:relative">
    <img src=". .  ." />
    <div>
      <p style="width:350px; position:absolute; top:100px; left:10px">TEXT . .  .</p>
    </div>
  </div>
  <div id="3" style="position:relative">
    <img src=". .  ." />
    <div>
      <p style="width:350px; position:absolute; top:100px; left:10px">TEXT . .  .</p>
    </div>
  </div>
</div> 
```

所以我想做一个滑块。我的 imgaes 工作得很好，但我想在图像之上添加 CSS 文本。当我运行脚本时，它不会拉入文本 div。它只是拉出图像。

[http://jsfiddle.net/KzeMg/](http://jsfiddle.net/KzeMg/)

# regex - 负环视——正则表达式

> ID：11441705
> 
> 赞同：1
> 
> 时间：2012-07-11T21:22:43.097
> 
> 标签：regex

我正在尝试自己学习正则表达式，因此这是一个愚蠢的活动。

我正在尝试检索其中包含“足球”的任何单词，但将“足球”排除在外——这样我就可以得到其他任何东西——足球运动员、足球运动员、足球。只是不是“足球”。

我发现这`\bfootball(?!s)\b`摆脱了足球运动员和足球。我如何只排除“足球”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:31:51.170

您必须在断言内移动单词边界：

```
/\bfootball(?!s\b)/ 
```

这比完全删除单词边界更正确。当你完全删除边界时，你会错过`s`后面的单词和一些东西： `footballsa`例如。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:26:09.350

`\bfootball(?!s)\b`不包括“足球运动员”，因为您正在寻找一个单词边界，然后是“足球”，然后不是 S，然后是另一个单词边界（这不允许您在“足球”之后找到任何东西）。摆脱结束词边界（换句话说，使用`\bfootball(?!s\b)`代替）。

# vb6 - 第二次单击时未调用 Mouse Down 事件

> ID：11441707
> 
> 赞同：1
> 
> 时间：2012-07-11T21:22:58.990
> 
> 标签：vb6, mouseevent, picturebox

我有一个应用程序，我在图片框上画一条线/正方形。我还需要用户单击图片框上的特定点（在绘制正方形/线之后）以获得第二个点的位置。但是鼠标按下事件不适用于第二次单击。我的代码如图所示：

```
Dim m_Drawing As Boolean
'm_Drawing = False
Dim m_Startx As Single
Dim m_Starty As Single
Dim m_endx As Single
Dim m_endy As Single
Dim square_click As Boolean
'square_click = False
Dim line_click As Boolean
'line_click = False
Dim bclick As Boolean
'blick = True
Dim startx As Single
Dim starty As Single
Dim endx As Single
Dim endy As Single
Dim laserx_mm As Single
Dim lasery_mm As Single
Dim rectx_mm As Single
Dim recty_mm As Single
Dim xpos As Single
Dim ypos As Single
Dim uxpos As Single
Dim uypos As Single
Dim dist As Single
Dim dist1 As Single

Private Sub Command1_Click()
square_click = True
End Sub

Private Sub Command2_Click()
line_click = True
End Sub

Private Sub Picture1_MouseDown(Button As Integer, Shift As Integer, X As Single, Y As Single)
Dim diffx As Single
Dim diffy As Single

Picture1.Cls
If m_Startx = 0 And m_Starty = 0 Then
m_Startx = X
m_Starty = Y
'End If
startx = X
starty = Y
rectx_mm = X
recty_mm = Y
'move to start position
ElseIf m_Startx <> 0 And m_Starty <> 0 Then
laserx_mm = X
lasery_mm = Y

diffx = rectx_mm - laserx_mm
diffy = recty_mm - lasery_mm

dist = xpos + (diffx / 4.74 / 1000)
dist1 = ypos - (diffy / 4.68 / 1000)

End If
End Sub

Private Sub Picture1_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
endx = X
endy = Y
m_endx = X
m_endy = Y
If square_click = True Then
Picture1.Line (m_Startx, m_Starty)-(endx, endy), vbWhite, B
ElseIf line_click = True Then
Picture1.Line (m_Startx, m_Starty)-(endx, endy), vbWhite
End If
End Sub 
```

编码：`ElseIf m_Startx <> 0 And m_Starty <> 0`

除非并且直到我在那里设置断点，否则不会被执行。我不确定为什么会这样。请帮帮我！希望我足够清楚！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T12:12:18.520

我`Debug.Print "Here I am"`在你的内部打了一个电话`ElseIf m_Startx <> 0 And m_Starty <> 0`......在第二次点击时就像一个魅力。也许您可能想要使用更深的颜色或更粗的线条？白线很难看到。

# relational-database - 在关系数据库中表示多态关联的最佳方法是什么？

> ID：11441716
> 
> 赞同：2
> 
> 时间：2012-07-11T21:23:35.963
> 
> 标签：relational-database, polymorphic-associations

假设表格的这种表示：

![db 父/子表](../Images/c2f75db3d3b483ed04525c8b47b992e4.png)

Object 是包含所有其他 4 个子表的 objectid 的“父”表。
'something' 表除了有一个 objectid 列之外，还将包括 linked_to_objectid 列。此列仅指向来自 object1 和 object2（而不是来自 object3）的 objectid。

我的问题是我每次插入一行时都必须检查，如果 linked_to_objectid 不是来自 object3 。

另一种方法是在对象表中添加另一列来描述 objectid 是什么类型的对象......但我觉得这是错误的。

我知道这个模型违反了正常的形式规则，但我找不到其他方法。
任何人都可以帮助我并找到最好的建模方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-22T14:12:08.627

我认为您的答案是在表中使用互惠的主键/外键和主键的分区部分，例如：

```
 CREATE TABLE object_class (
     id int not null unique, -- hand assigned
     label text not null primary key
 );

 CREATE TABLE object (
     object_id bigserial not null primary key,
     class_id int not null references object_class(id),
     ...., 
     UNIQUE (object_id, class_id)
 );

 CREATE TABLE object1 (
      object_id bigint not null,
      class_id bigint not null,
      .....
      check(class_id = 1),
      primary key (object_id, class_id),
      foreign key (object_id, class_id) references object(object_id, class_id)
 );

 etc. 
```

现在，如果您使用的是 PostgreSQL，您可能可以使用表继承和约束触发器来实现一些更简洁的东西，但这是相对高级的东西。

# c# - 从锯齿状数组中选择单个元素

> ID：11441718
> 
> 赞同：0
> 
> 时间：2012-07-11T21:23:54.190
> 
> 标签：c#, .net, linq

我正在研究一个让我的大脑融化的问题，尽管我认为它不应该这么难。我的例子很长，所以我会尽量让我的问题简短！

我有一个数组对象，其中包含一些也是数组的元素。例如：

```
customerAddresses = new customer_address[]
{
  new    // address #1
  {
    customer_id = 6676979,
    customer_address_seq = 1,
    customer_address_match_codes = new []
    {
      new
      {
        customer_address_seq = 1,
        customer_id = 6676979,
        customer_match_code_id = 5
      }
    }
  },
  new    // address #2
  {
    customer_id = 6677070,
    customer_address_seq = 1,
    customer_address_match_codes = new []
    {
      new
      {
        customer_address_seq = 1,
        customer_id = 6677070,
        customer_match_code_id = 4
      },
      new
      {
        customer_address_seq = 1,
        customer_id = 6677070,
        customer_match_code_id = 5
      },
      new
      {
        customer_address_seq = 1,
        customer_id = 6677070,
        customer_match_code_id = 3
      }
    }
  },
  new    // address #3
  {
    customer_id = 6677070,
    customer_address_seq = 2,
    customer_address_match_code = new []
    {
      new
      {
        customer_address_seq = 2,
        customer_id = 6677070,
        customer_match_code_id = 4
      },
      new
      {
        customer_address_seq = 2,
        customer_id = 6677070,
        customer_match_code_id = 5
      }
    }
  }
}; 
```

如您所见，数组包含许多地址记录，每个`customer_id`和的组合都有一条记录`customer_address_seq`。我要做的是`customer_address`根据以下规则找到最佳匹配：

*   必须`customer_match_code_id`等于 4 并且必须有 1 等于 5
*   如果有一个`customer_match_code_id`等于 3，则认为这是`customer_address`一个更强的匹配。

根据上述规则，第二个`customer_address`元素是“最佳匹配”。然而，这个问题的最后一点复杂性是可能有*多个*“最佳匹配”。我需要如何处理这种情况是通过`customer_address`记录 minimum`customer_id`和 minimum `customer_address_seq`。

我在想使用 LINQ 将是我最好的选择，但我对它的经验不够，所以我只是不停地旋转我的轮子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:36:47.173

未经测试且名称不同，但这应该可以帮助您

```
 customer cb = null;
            customer[] cs = new customer[] {new customer()};

            foreach (customer c in cs.OrderBy(x => x.id).ThenBy(y => y.seq))
            {
                if(c.addrs.Any(x => x.num == "5"))
                {
                    if(c.addrs.Any(x => x.num == "3"))
                    {
                        if (cb == null) cb = c;
                        if (c.addrs.Any(x => x.num == "2"))
                        {
                            cb = c;
                            break;
                        }
                    }
                }
            } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T00:13:22.070

在 LINQ 中似乎很简单：

```
var query =
    from ca in customerAddresses
    where ca.customer_address_match_codes.Any(
        mc => mc.customer_match_code_id == 4)
    where ca.customer_address_match_codes.Any(
        mc => mc.customer_match_code_id == 5)
    orderby ca.customer_id
    orderby ca.customer_address_seq
    orderby ca.customer_address_match_codes.Any(
        mc => mc.customer_match_code_id == 3) descending
    select ca;

var result = query.Take(1); 
```

看起来怎么样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T00:13:39.833

必须对您的班级进行更改，以便您实际上将您的一个集合分配给某些东西：

```
customer_address_match_codes = new customer_address_match_code[]
{
  new
  {
    customer_address_seq = 1,
    customer_id = 6676979,
    customer_match_code_id = 5
  }
} 
```

然后这是我测试过的 LINQ，它按照您的要求执行：

```
var result = (from c in customerAddresses
    let isMatch = c.customer_address_match_codes
                     .Where (cu => cu.customer_match_code_id == 4).Any () &&
                  c.customer_address_match_codes
                     .Where (cu => cu.customer_match_code_id == 5).Any ()
    let betterMatch = isMatch && c.customer_address_match_codes
                  .Where (cu => cu.customer_match_code_id == 3).Any () ? 1 : 0
    where isMatch == true
    orderby betterMatch descending, c.customer_id, c.customer_address_seq
    select c)
    .FirstOrDefault (); 
```

我在这里使用匿名类型的数据编写了一个示例：http: [//ideone.com/wyteM](http://ideone.com/wyteM)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T23:25:20.987

这听起来像是 LINQ 的工作

```
var bestMatch = (from address in DATA
where address.customer_address_match_code.Any(
  x => x.customer_match_code_id == 4)
where address.customer_address_match_code.Any(
  x => x.customer_match_code_id == 5)
select address).OrderBy(
  x => x.customer_address_match_code.Where(
    y => y.customer_match_code_id >= 3)
  .OrderBy(y => y.customer_match_code_id)
  .First()
  .customer_match_code_id).FirstOrDefault(); 
```

我的理论是这样的：选择同时具有 customer_match_code_id == 4 和 customer_match_code_id == 5 的地址。然后按至少为 3 的最低 customer_match_code_id 对它们进行排序，然后取第一个。如果有一个 customer_match_code_id 等于 3，则选择那个，如果没有，则选择其他一些。如果 4 和 5 均不匹配，则返回 null。

未经测试。

# php - 在 php 中使用 mongodb $slice 功能

> ID：11441720
> 
> 赞同：-4
> 
> 时间：2012-07-11T21:23:57.467
> 
> 标签：php, mongodb

我如何将这个 shell 翻译成 php：

```
db.products.find({}, {comments:{$slice: 5}} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T23:51:07.813

你试过什么？

这看起来像一个非常简单的案例：

```
db->products->find( array(), array('comments' => array( '$slice' => 5 ) ) ); 
```

简单的翻译有什么特别的问题吗？

# jquery - IE 尝试解析 JSON 时出错

> ID：11441722
> 
> 赞同：5
> 
> 时间：2012-07-11T21:24:16.317
> 
> 标签：jquery, json, internet-explorer

总而言之，我正在尝试解析一些 JSON，而 IE 给了我一个错误，但毫不奇怪，其他浏览器都可以使用它。这是我的代码：

```
var result = JSON.parse(data.result); 
var uploadType = result[0].upload_type;
var filename = result[0].name;
var insert_id = result[0].insert_id; 
```

我在第一行遇到错误。知道如何制作这个 IE 证明吗？

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-11T21:26:34.017

Internet Explorer 在版本 8 之前不支持`JSON.parse`。您可以[`jQuery.parseJSON`](http://api.jquery.com/jQuery.parseJSON)改用（我看到您已标记问题[jquery](/questions/tagged/jquery "显示标记为“jquery”的问题")）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:27:49.733

Internet Explorer 不支持 JSON.parse，请参考[json2](http://www.json.org/js.html)脚本，您将获得相同的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-12T19:35:07.443

我试过这个，这对我有用： [https ://github.com/flowersinthesand/jquery-stringifyJSON](https://github.com/flowersinthesand/jquery-stringifyJSON)

以前的解决方案对我不起作用，即使这样： [https ://github.com/douglascrockford/JSON-js](https://github.com/douglascrockford/JSON-js)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T21:28:59.433

您没有指定 IE 版本，但如果您使用的是 IE8 或更早版本，它本身不支持 JSON 对象。

你需要一个第三方库来填充这个特性。

jQuery 是一种选择。

您可以在此处找到许多其他选项：[https ://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-28T21:24:41.413

对于那些不能使用第三方库的人，您可以随时使用

```
eval('var data = ' + request.responseText); 
```

获得相同的功能

# ios - 使用 sleepy mongoose api 从 iphone 应用程序访问安装在 aws ec2 实例上的 mongodb

> ID：11441724
> 
> 赞同：2
> 
> 时间：2012-07-11T21:24:25.663
> 
> 标签：ios, objective-c, mongodb, ios4

我正在开发一个 iphone 应用程序，该应用程序应该使用安装在 aws ec2 实例上的 mongodb 作为后端。我已经在实例上设置了 mongodb，并将 sleepy mongoose 设置为 api，并且可以通过 ssh 执行添加、查询等操作。但我想使用 sleepy mongoose api 从 iphone 应用程序代码（xcode4）做同样的事情。有人可以帮我吗？

（PS-我已经使用 mongodb 自己的 rest api 实现了相同的功能，但对如何使用 sleepy mongoose 感到困惑！）

谢谢皮亚利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T23:05:01.280

它基本上是 8 个文件，可能有 1000 行代码，所以在源代码和[原始博客文章](http://www.kchodorow.com/blog/2010/02/22/sleepy-mongoose-a-mongodb-rest-interface/)之间，你应该有你需要的一切。它基本上只是使用`curl`调用，所以无论您通过 x-code 进行 Web 请求，都是您使用 sleepy mongoose 的方式。

也就是说，请不要将昏昏欲睡的猫鼬用于任何严重或敏感数据的事情。这只是一些 10gen 工程师共同完成的一个项目。它有几个单元测试，没有安全模型，也不能保证完全覆盖驱动程序功能。

# c# - 将值传递给控制器 方法时出错

> ID：11441725
> 
> 赞同：1
> 
> 时间：2012-07-11T21:24:30.123
> 
> 标签：c#, asp.net, asp.net-mvc-3, entity-framework

这是错误报告：

> 参数字典包含“Grid.Controllers.GridController”中方法“System.Web.Mvc.ActionResult Delete(Int32)”的不可空类型“System.Int32”的参数“id”的空条目。可选参数必须是引用类型、可空类型或声明为可选参数。参数名称：参数

这是我的代码：

```
public ActionResult Edit(int ProductId)
    {
        using (var db = new radioEntities())
        {
            return View(db.CAT_Products.Find(ProductId));
        }
    } 
```

我的路由表：

```
public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Grid", action = "Index", id = UrlParameter.Optional } // Parameter defaults
        );

    } 
```

我的动作链接：

```
@Html.ActionLink("Edit", "Edit", new { /* id=item.PrimaryKey */ }) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T21:27:03.650

当`id`您的 RouteTable (global.asax.cs) 中有一个时，您必须为参数使用相同的名称：

```
//public ActionResult Edit(int ProductId)
public ActionResult Edit(int id) 
```

您应该编辑（修复）ActionLink：

```
//@Html.ActionLink("Edit", "Edit", new { /* id=item.PrimaryKey */ })
@Html.ActionLink("Edit", "Edit", new { id=item.YourKey })  // depends on your Model and other code 
```

# java - 保留正则表达式解析的数据

> ID：11441731
> 
> 赞同：0
> 
> 时间：2012-07-11T21:25:05.250
> 
> 标签：java, regex, parsing

我有一个正则表达式模式，它匹配我需要完全按照我需要解析的数据。不幸的是，使用 split 方法它会删除所需的数据并将垃圾传递给我。通常我会尝试另一个正则表达式做相反的事情，但它并不像听起来那么简单。它必须在 Java 中，因为这部分是更大的程序/包的一部分。

> 模式 p = Pattern.compile("/^\{\?|\:|\=|\||(\- configurationFile)|(isUsingRESTDescription)|(\restURL) *=(\s|\w|\.|\ -|\:|\/|\;|\[|\]|\'|\})* \r/g");

这是我正在解析的字符串（每个部分后都有回车）：

*   SearchResult::getBleh(): {BLEHID=BLEH blehLastmoddate=1-Jul-11 bleh=BLEH; Beh description=blehbleh BlEh=bleh1231bleh bLeH=bleh-blehbleh 1 media= [http://bleh.com/13](http://bleh.com/13) Date=22-May-12 name=[]} String[] items = p.split(input^);

上面的内容与我想要的相反。

你会认为有人会遇到这个问题。帮助将不胜感激:)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:35:57.060

使用捕获组。[您可以在Pattern](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html)的 javadoc 中了解它们。

一个例子：

```
 Pattern p = Pattern.compile("[^/]*/([^/]*)/.*");
  Matcher m = p.matcher("foo/bar/input");
  if (m.find()) {
     String captured = m.group(1); // This equals "bar"
     String matched = m.group(0); // This equals "foo/bar/input"
  } 
```

位于 a 中括号内的任何内容`Pattern`都是捕获组。根据`Matcher`遇到左括号的时间索引捕获组。组 0 始终是整个匹配区域。

# c# - 如何递归查找所有空文件

> ID：11441735
> 
> 赞同：0
> 
> 时间：2012-07-11T21:25:23.647
> 
> 标签：c#, powershell

您如何在空目录中找到所有空文件。给定的文件可能有回车或空格。我也需要捕捉这些。我可以在 powershell 或 c# 中使用代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:43:54.147

Powershell 让它变得简单：

`Get-ChildItem -Path C:\dir -recurse -Filter { $_.Length -eq 0 }`

`#YOUR HOMEWORK: filter for your CRLF criteria as well`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T21:35:29.993

```
var files = new DirectoryInfo("Your path").GetFiles("*.*", SearchOption.AllDirectories);
foreach(var file in files) 
{
    using(var r = new StreamReader(file.OpenRead()))
    {
       string content = r.ReadToEnd();
       if(string.IsnullOrWhitespace(content))
       {
       // do stuff
       }
    }
} 
```

代码不在我的顶部，没有测试它，你可以得到这个想法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-11T21:32:26.487

System.IO 有你想要的类

```
 DirectoryInfo di = new DirectoryInfo("c:\\Luke101");
    FileInfo[] fiArr = di.GetFiles();

    foreach (FileInfo fi in fiArr)
    {
        if(fi.Length == 0)
        {
            //.. Then do stuff
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-12T11:33:17.880

获取从文件开头到结尾的所有零字节长度文件或只有空格、制表符、CR 的文件。

```
Get-ChildItem <path> -Recurse | 
Where-Object {!$_.PSIsContainer -and ($_.Length -eq 0 -or ([IO.File]::ReadAllText($_.FullName) -match '^\s+$') } 
```

# android - Resources$NotFoundException：来自可绘制资源的文件 res/color/dark.xml

> ID：11441737
> 
> 赞同：1
> 
> 时间：2012-07-11T21:25:30.883
> 
> 标签：android

`Resources$NotFoundException: File res/color/dark.xml from drawable resource`

我有那个错误。我尝试了干净的项目。我可以在“R”文件中看到“黑暗”。我可以在项目中使用它：我的意思是自动完成运行良好，但是当我在模拟器上打开应用程序时出现此错误。我是如何使用它的：

```
songList.setSelector(R.color.dark); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:39:55.297

正确的使用方法`setSelector()`是：

在 res/drawable 中创建一个 xml

例如，让`res/drawable/selector.xml`

```
<?xml version="1.0" encoding="utf-8"?>
   <selector xmlns:android="http://schemas.android.com/apk/res/android">
<item android:state_selected="true"   
    android:drawable="@color/black" />
</selector> 
```

然后在你的声明黑色`res\values\strings.xml`

```
<color name="black">#000000</color> 
```

然后将选择器设置为

```
songList.setSelector( R.drawable.selector); 
```

注意：回答来自[这篇](https://stackoverflow.com/questions/4342405/android-setselector-color-for-listview-not-working)文章的想法。

编辑：尝试在 Eclipse 中清理您的项目并重新启动 Eclipse。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:37:01.493

您将可绘制资源放在 res/color 文件夹中。你应该把它放在 res/drawable 文件夹中。

# c# - 数据方法中的 Task.Factory.StartNew() -- 传递 this.Database？

> ID：11441740
> 
> 赞同：1
> 
> 时间：2012-07-11T21:25:35.203
> 
> 标签：c#, multithreading, closures

我正在尝试将数据方法中的存储过程调用转换为异步调用。这是原始方法：

```
public void InsertFoo(Foo foo)
{
    this.Database.SomeStoredProcedure(foo);
} 
```

我的第一次尝试是这样的：

```
public void InsertFoo(Foo foo)
{
    Task.Factory.StartNew(() =>
    {
        this.Database.SomeStoredProcedure(foo);
    });
} 
```

但是，我收到 this.Database 为空的运行时错误。（this.Database 是 L2S 数据上下文。）

然后我做了一些研究，并认为创建自己的本地副本就可以了：

```
public void InsertFoo(Foo foo)
{
    MyDataContext db = this.Database;

    Task.Factory.StartNew(() =>
    {
        db.SomeStoredProcedure(foo);
    });
} 
```

但是，db 在线程实际使用它之前就被释放，从而导致另一个运行时错误。

我只是想将 this.Database 传递给线程方法。那可能吗？如果是这样，怎么做？this.Database 在方法返回时将被销毁，因为类实例已经消失，所以我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:39:57.073

鲍勃。由于 InsertFoo 方法立即返回，包含的对象实例可用于收集，因此当调用数据库时，数据库实例已被释放。

例如，如果你正在做类似的事情

```
using(var xx = new FooContainer()){

xx.Foo(foo);

} 
```

然后，您的 FooContainer 将在 foo 方法中的异步调用执行之前进行处理。

我认为您最好异步调用 InsertFoo 而不是从该方法中进行异步调用。

例如`Task.Factory.StartNew(()=> xx.InsertFoo(foo))`，使用完成时的延续来整理`xx`包含对象的内容。

# php - 将多请求扩展到不同的服务

> ID：11441742
> 
> 赞同：1
> 
> 时间：2012-07-11T21:25:44.547
> 
> 标签：php, service, multiprocessing, scale, curl-multi

我有一项服务，我需要根据每个用户请求询问 40 个外部服务 (API) 以从它们那里获取信息。例如，一个用户正在搜索一些信息，而我的服务要求 40 个外部合作伙伴获取信息，将其聚合到一个数据库（mysql）中并将结果显示给用户。

目前我有一个 multicurl 解决方案，我一次有 10 个合作伙伴请求，如果有人完成了请求，那么软件将从剩余的 30 个合作伙伴添加到 multicurl 队列中，直到所有 40 个请求完成，结果在数据库中。

这个解决方案的问题是它不能在许多服务器上扩展，我想要一些解决方案，我可以一次触发 40 个请求，例如在 2-3 个服务器上划分，并且只等待很长时间，作为最慢的合作伙伴提供结果 ;-) 这意味着，如果最慢的合作伙伴需要 10 秒，我将在 10 秒内获得所有 40 个合作伙伴的结果。在 multicurl 上，当一次有超过 10-12 个请求时，我遇到了麻烦。

什么样的解决方案，你能给我提供什么，我得到尽可能少的资源，并且可以在一台服务器上运行许多进程并且是可扩展的。我的软件是用 PHP 编写的，这意味着我需要使用框架或 API 很好地连接到解决方案。

我希望你能理解我的问题和需要。请询问，如果有不清楚的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T22:38:22.593

一种可能的解决方案是使用[消息队列](http://en.wikipedia.org/wiki/Message_queue)系统，如[beanstalkd](http://kr.github.com/beanstalkd/)、[Apache ActiveMQ](http://activemq.apache.org/)、[memcacheQ](http://memcachedb.org/memcacheq/)等。

一个高级示例是：

*   用户向您的服务请求信息
*   您的服务将请求添加到队列中（大概是您要查询的 40 个服务中的每一个）
*   一个或多个作业服务器连续轮询队列以获取工作
*   作业服务器从队列中获取消息以执行某些工作，将数据添加到数据库并从队列中删除项目。

在这个模型中，由于现在执行 40 个请求的一个任务是分布式的并且不再是一个“进程”的一部分，因此难题的下一部分将是弄清楚如何将一组工作标记为已完成。这部分可能不是那么困难，或者它可能会带来新的挑战（取决于数据和您的应用程序）。也许您可以使用另一个缓存/数据库行来设置一个计数器来完成特定请求所需的作业数量，并且随着每个队列工作人员完成一个请求，它可以将计数器减 1。一旦计数器为 0，您知道请求已经完成。但是当你这样做时，你需要确保计数器变为 0 并且不会因为某种原因卡住。

这至少是一种方式，希望对您有所帮助或为更多想法打开大门。

# vb.net - 使用 vb.net 从文本文件中提取信息

> ID：11441743
> 
> 赞同：2
> 
> 时间：2012-07-11T21:25:54.633
> 
> 标签：vb.net

我正在使用 cmd 使用 ipconfig > computer.txt 将用户网络规范打印到文本文件中。这方面的一个例子是

```
Windows IP Configuration

Wireless LAN adapter Wireless Network Connection:

   Connection-specific DNS Suffix  . : 
   Link-local IPv6 Address . . . . . : fe80::cd7a:50b3:1284:865%12
   IPv4 Address. . . . . . . . . . . : 10.0.0.26
   Subnet Mask . . . . . . . . . . . : 255.0.0.0
   Default Gateway . . . . . . . . . : 10.0.0.1

Ethernet adapter Local Area Connection:

   Connection-specific DNS Suffix  . : 
   Link-local IPv6 Address . . . . . : fe80::5c3a:ae77:81:8cdf%11
   IPv4 Address. . . . . . . . . . . : 10.0.0.25
   Subnet Mask . . . . . . . . . . . : 255.255.255.0
   IPv4 Address. . . . . . . . . . . : 192.168.1.12
   Subnet Mask . . . . . . . . . . . : 255.255.255.0
   Default Gateway . . . . . . . . . : 10.0.0.1 
```

我将如何使用它来查找适配器默认网关之一（向下 x 行，然后：

不确定这是否是正确的做法。

如果没有，使用 vb.net 查找子网掩码/默认网关的最佳方法是什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:33:07.140

如果格式始终相同`String.IndexOf`并且`String.Substring`是有效的方法：

```
Dim gateWays = From line In File.ReadLines("C:\Temp\data.txt")
               Skip 10
               Let gatewayIndex = line.IndexOf("Default Gateway . . . . . . . . . :")
               Where gatewayIndex > -1
               Select line.Substring(gatewayIndex + "Default Gateway . . . . . . . . . :".Length)
Dim firstGateWay = gateWays.FirstOrDefault 
```

您可以使用[`Enumerable.Skip`](http://msdn.microsoft.com/en-us/library/bb358985.aspx)跳过 x 行，在此示例中为 10。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T22:05:58.100

这应该做你想要的：

```
Private Function GetGateway(ByVal fileName As String) As String
    Dim sr As New System.IO.StreamReader(fileName)
    Dim foundEthernet As Boolean = False
    Dim gateway As String = ""

    Do Until sr.EndOfStream
        Dim line As String = sr.ReadLine()

        If line.Contains("Ethernet adapter LAN:") OrElse line.Contains("Ethernet adapter Local Area Connection:") Then
            foundEthernet = True
        End If

        If foundEthernet Then
            If line.Contains("Default Gateway . . . . . . . . . :") Then
                gateway = line.Substring(line.IndexOf(":") + 1).Trim
                Exit Do
            End If
        End If
    Loop
    sr.Close()

    Return gateway
End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T22:35:48.147

此外，正如 mellamokb 所提到的，如果您在查询的 PC 上运行此应用程序，您可以使用

```
System.Net.NetworkInformation.NetworkInterface.GetAllNetworkInterfaces 
```

获取此信息。

# php - for循环中变量后的php变量

> ID：11441745
> 
> 赞同：1
> 
> 时间：2012-07-11T21:26:00.773
> 
> 标签：php

我需要一种方法来做到这一点

```
for($i=1;$i<=10;$i++){
$id$i = "example" . $i;
} 
```

注意第二行有 $id$i 所以对于第一个循环 $id1 将等于 example1 在第二个循环 $id2 将等于 example2 等等......非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T21:28:31.160

您可以使用[变量变量名](http://php.net/manual/en/language.variables.variable.php)来执行此操作；但是，如果您只使用数组，它可能会更方便：

```
for($i = 1, $i <= 10, $i++) {
    $id[] = "example" . $i;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:35:57.520

```
$var = array();
for($i=1; $i<=10; $i++) {
$var['id' . $i] = 'example' . $i;
}
extract($var, EXTR_SKIP);
unset($var); 
```

但是为什么不使用一个简单的数组呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T21:30:31.480

使用数组会好得多，但你*可以*这样做：

```
for($i=1; $i<=10; $i++){
    $var ="id$i";
    $$var = "example" . $i;
} 
```

这是我建议做的事情：

```
$ids = array;
for($i = 1; $i <= 10; $i++) {
    $ids[$i] = "example" . $i;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-11T21:30:37.343

`$i`您可以创建一个名称为的大小数组`$id`，并将每个元素插入到不同的索引中。

```
for($i=1;$i<=10;$i++){
    $id[$i] = "example" . $i;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-11T21:28:50.967

`$`如果在字符串前面放另一个字符串，则可以将字符串转换为变量（变量的名称） ：

```
$str = "number";
$number = 5;
$$str = 8;
echo $number;  // will output 8 
```

所以在你的例子中，你可以这样做：

```
for($i = 1; $i <= 10; $i++) {
    $str_var = "id".$i;
    $$str_var = "example".$i;
} 
```

# python - 如何让 SVM 很好地处理 scikit-learn 中的缺失数据？

> ID：11441751
> 
> 赞同：26
> 
> 时间：2012-07-11T21:26:25.270
> 
> 标签：python, machine-learning, scikit-learn

我正在使用 scikit-learn 进行一些数据分析，并且我的数据集有一些缺失值（用 表示`NA`）。`genfromtxt`我用with加载数据`dtype='f8'`并开始训练我的分类器。

`RandomForestClassifier`和对象上的分类很好`GradientBoostingClassifier`，但使用`SVC`from`sklearn.svm`会导致以下错误：

```
 probas = classifiers[i].fit(train[traincv], target[traincv]).predict_proba(train[testcv])
  File "C:\Python27\lib\site-packages\sklearn\svm\base.py", line 409, in predict_proba
    X = self._validate_for_predict(X)
  File "C:\Python27\lib\site-packages\sklearn\svm\base.py", line 534, in _validate_for_predict
    X = atleast2d_or_csr(X, dtype=np.float64, order="C")
  File "C:\Python27\lib\site-packages\sklearn\utils\validation.py", line 84, in atleast2d_or_csr
    assert_all_finite(X)
  File "C:\Python27\lib\site-packages\sklearn\utils\validation.py", line 20, in assert_all_finite
    raise ValueError("array contains NaN or infinity")
ValueError: array contains NaN or infinity 
```

是什么赋予了？我怎样才能让 SVM 很好地处理丢失的数据？请记住，丢失的数据适用于随机森林和其他分类器。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-12T15:34:29.820

您可以在使用 SVM 之前进行数据插补以处理缺失值。

编辑：在 scikit-learn 中，有一种非常简单的方法可以做到这一点，如图[所示](http://scikit-learn.org/stable/modules/preprocessing.html#imputation-of-missing-values)。

（从页面复制并修改）

```
>>> import numpy as np
>>> from sklearn.preprocessing import Imputer
>>> # missing_values is the value of your placeholder, strategy is if you'd like mean, median or mode, and axis=0 means it calculates the imputation based on the other feature values for that sample
>>> imp = Imputer(missing_values='NaN', strategy='mean', axis=0)
>>> imp.fit(train)
Imputer(axis=0, copy=True, missing_values='NaN', strategy='mean', verbose=0)
>>> train_imp = imp.transform(train) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-12T08:17:36.863

您可以删除具有缺失特征的样本，也可以将缺失特征替换为其按列的中位数或均值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-05-31T11:31:53.757

这里最受欢迎的答案已经过时了。“Imputer”现在是“SimpleImputer”。[此处](https://stackoverflow.com/questions/30317119/classifiers-in-scikit-learn-that-handle-nan-null)给出了当前解决此问题的方法。估算训练和测试数据对我的工作如下：

```
from sklearn import svm
import numpy as np
from sklearn.impute import SimpleImputer

imp = SimpleImputer(missing_values=np.nan, strategy='mean')
imp = imp.fit(x_train)

X_train_imp = imp.transform(x_train)
X_test_imp = imp.transform(x_test)

clf = svm.SVC()
clf = clf.fit(X_train_imp, y_train)
predictions = clf.predict(X_test_imp) 
```

# javascript - 动态添加/删除 HTML 时防止内存泄漏

> ID：11441755
> 
> 赞同：4
> 
> 时间：2012-07-11T21:26:44.643
> 
> 标签：javascript, jquery, jquery-mobile

我正在使用 PhoneGap 和 JQuery Mobile 创建一个应用程序，我希望在其中从某些后端服务读取数据并根据收到的内容添加/删除列表项（也可能是 div）。自然地，我想防止应用程序在长时间使用时速度过慢。

在添加/删除 HTML 时是否有任何一般的最佳实践？我对此很陌生，所以我不太了解 DOM 是如何工作的等等。

目前我正在使用 JQuery 的 append 将 HTML 行添加到某些容器 div，并使用 .html("") 删除元素。这是可以接受的，还是有更好的方法来做到这一点？

编辑：供您参考，我使用的是 JQuery Mobile 1.1.0 和 Phonegap 1.9.0。不知道这是否有帮助，但你去。

我希望在尽可能多的移动设备上使用这个应用程序，但我猜 iOS 和 Android 是目前最大的市场。

澄清一下，我实际上还没有遇到重大问题（还），我只是想避免以后遇到任何事情，并且必须通过大量代码来尝试解决问题。我认为如果我们能就一组最佳实践达成一致，这对每个人都会很有用，即在 .append 上使用 innerHTML()、remove vs innerHTML("") 等等：P

一些示例代码：

```
function changeList(sel){
            var xmlfolder="/"
            var name = sel[sel.selectedIndex].value+".xml";                
            var location= xmlfolder+name;
            var list = document.getElementById("opList"); //opList is the container
            list.innerHTML=""; //what i'm using to remove the previous occupant
                               //: is there a better way of doing this?
            //reading stuff                
            $.ajax({

                type:'GET',
                cache: false,
                url: location,
                dataType:"xml",
                success: function(data){
                    xmlInfo=data;

                    var i=0;
                    $(data).find("data").each(function(){

                        var string = "";
                        var sName=$(this).find("name").text();

                        string +=("<li>");
                        string +=("<a href=#details data-transition = slide >");
                        string+= sName;
                        string+="</a></li>";
                         $('#opList').append(string); //is there a better way of appending?
                         i++;

                    })

                    $('#opList').listview('refresh');

                },                    
                error:function(e){
                    alert("failed D:");
                    console.log(e);
                }

            });

        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T21:32:53.630

我只是想给你一些想法，我们会看看有什么坚持！

确保编造您的 HTML 并将其一次性添加到 DOM 中，而不是在循环中添加点点滴滴之类的东西。

例如（这样做）：

```
var arr    = ['Title 1', 'Title 2', 'Title 3'],
    output = [];

for (var i = 0, len = arr.length; i < len; i++) {
    output.push('<li>' + arr[i] + '</li>');
}
$('ul').append(output.join('')); 
```

请注意我如何只选择一次容器，这是关键，即使您必须在循环内引用 DOM 元素，请确保缓存对循环外元素的引用，否则您每次迭代都不必要地做额外的工作.

例如（不要这样做，除了 DOM 元素缓存，这很好）：

 ~~~~```
var arr = ['Title 1', 'Title 2', 'Title 3'],
    $ul = $('ul');

for (var i = 0, len = arr.length; i < len; i++) {
    $ul.append('<li>' + arr[i] + '</li>');
} 
```~~  ~~如果您要向 DOM 添加一些复杂的 HTML 结构，请执行与之前相同的操作，创建一个“临时”容器，对其进行处理，然后一次将整个内容附加到 DOM。例如：

```
var $tmpObj = $('<div id="my-div" />').append(
    $('<span class="my-title" />').text('Title 1')
).append(
    $('<div class="my-description" />').append(
        $('<span class="my-copy" />').text('Blah Blah Blah')
    )
).on('click', function () {
    alert('Don\'t Touch Me!');
}).data('my-data-key', 'my-data-val');

$('#my-div').replaceWith($tmpObj); 
```

我喜欢存储与对象关联的数据，`$.data()`这样当一个元素被删除时，它的数据也是如此，因此我们不会用无用的数据耗尽内存。

使用 JSPerf.com，如果使用得当，它是一个了不起的工具。您可以运行测试以确定哪种方法对操作更快。这是我不久前设置的一个示例：http: [//jsperf.com/jquery-each-vs-for-loops/2](http://jsperf.com/jquery-each-vs-for-loops/2)

不要不必要地创建全局变量。当你这样做时，它会在查找这些变量时产生额外的开销。这行：`xmlInfo=data;`应该是`var xmlInfo=data;`除非`xmlInfo`要在 AJAX 回调函数之外访问。基本上，当您在函数（或嵌套函数）内部查找全局范围内的变量时；首先浏览器将查看当前范围，然后是当前范围的父范围，一直到全局范围。因此，如果您尝试在函数内部访问函数内部的全局变量，那么您现在的查找量大约是使用局部范围变量的三倍。如果必须使用全局范围的变量，请将其缓存在函数中并在函数中使用本地版本以避免额外的循环时间。~~~~

# javascript - javascript 返回值始终未定义

> ID：11441759
> 
> 赞同：1
> 
> 时间：2012-07-11T21:27:25.917
> 
> 标签：javascript

我正在尝试检索分离函数的 2 个属性，并在函数结束之前调试那里的值，它们有一个值，但返回值始终是未定义的，我不知道为什么！

.js 文件

```
function STAAPlanlat(){
  alert ("the function");

  if (navigator.geolocation) {
    //we supposed to call the handlers of the expections 
    navigator.geolocation.watchPosition(function(position) {
      alert("show position ");
     //  x.innerHTML="Latitude: " + position.coords.latitude +"<br />Longitude: " + position.coords.longitude;  
      var lat=position.coords.latitude;
      var lan=position.coords.longitude;    

      //x.innnerHTML=out
      alert(lat+"<"+lan);
      return lan;
    });

  } else {
    alert("error");
  }
} 
```

我收到了有关 lan 和 lat 值的警报

但是当我调用分隔文件时，它返回未定义的返回值

```
 <!DOCTYPE html>
 <html>
 <head>
     <script type="text/javascript" src="STAAP1.2.js"> </script>

 <script type="text/javascript">
     function test(){
     var out=STAAPlanlat();     
     document.getElementById("STAAPlanlat").value = "lan is"+out;
     //document.writeln("lan is"+out);
     }
     </script>  
 </head>
 <body>
 <p id="STAAPlanlat">Test the division</p>
 <button onclick="test()">STAAPlanlat()</button>
 <button onClick="alertme()" >Alert</button>

 </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:33:27.140

因为你不是从主函数返回它，你是从嵌入式匿名函数返回它，它没有做任何事情。做这个：

```
function STAAPlanlat(){
var lat;
var lan;
alert ("the function");
if (navigator.geolocation) {
    //we supposed to call the handlers of the expections 
    navigator.geolocation.watchPosition(function(position) {
        alert("show position ");
        //  x.innerHTML="Latitude: " + position.coords.latitude +"<br />Longitude: " + position.coords.longitude;   
        lat=position.coords.latitude;
        lan=position.coords.longitude;  

        //x.innnerHTML=out
        alert(lat+"<"+lan);
    });
    return lan;
}
else
    alert("error");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T21:36:41.477

您在匿名函数中返回，并且这个值永远不会分配给任何东西。你可以用回调做你想做的事。

```
// untested code, hope it works
function STAAPlanlat(callback){
    alert ("the function");
    if (navigator.geolocation) {
        navigator.geolocation.watchPosition(function(position) {
            var lat=position.coords.latitude;
            var lan=position.coords.longitude;  
            callback(lat, lan);
        });
    }
    else{
        alert("error");
    }
} 
```

而你的测试功能......

```
function test(){
    var out;
    STAAPlanlat(function(lat, lon) { out = lat; });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T21:33:51.600

因为函数 STAAPlanlat 不返回任何值。您的匿名函数返回`lan`，但它是异步回调。在之前添加`return lan;`：

```
document.getElementById("STAAPlanlat").value = "lan is" + lan; 
```

# batch-file - DOS 批处理脚本 - 将目录重命名为其最新文件的日期

> ID：11441761
> 
> 赞同：0
> 
> 时间：2012-07-11T21:27:34.283
> 
> 标签：batch-file

这是我的情况。我有几百个文件夹（在 Windows XP 下），每个文件夹都包含几个 .jpg。当我在重命名其中一个文件夹的过程中不小心选择了所有文件夹时，文件夹的名称都搞砸了。

我要做的是编写一个 DOS Batch 脚本，它将遍历每个文件夹，确定目录中最新文件的修改日期并将文件夹重命名为 YYYY-MM-DD 格式的该日期。因此：

```
Directory of C:\Work_Area\Messed_up_dir_name

07/11/2012  10:01 AM    <DIR>          
07/11/2012  10:01 AM    <DIR>          
03/10/2008  11:00 AM           176,640 image1.jpg
08/07/2007  02:27 PM            25,088 image2.jpg
04/12/2007  04:52 PM           132,608 image3.jpg
02/06/2007  06:11 PM            61,086 image4.jpg 
```

变成`"C:\Work_Area\2008-03-10\"`

这是我到目前为止写的...

```
@echo off   
REM ITERATE THROUGH EACH DIRECTORY
FOR /F "DELIMS==" %%d in ('DIR "%ROOT%" /AD /B') DO ( 
    ECHO %%d
    cd %%d
    REM DETERMINE NEWEST FILE
    FOR /F %%a in ('DIR /O:-D /B') DO @ECHO %%~ta
    cd ..     
    REM echo Newest=%Newest%    
    REM move "%%f" "%Newest%"           
    pause   
) 
```

显然，日期中的斜杠需要更改为另一个字符才能成功。如果有人可以帮助我解决这个问题，将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-12T15:53:06.730

此脚本将重命名目录树的文件夹，其根在脚本的第一个参数 (%1) 中指定。我编写了脚本以满足该问题的第二条评论中指定的要求。

编写的脚本实际上会回显将运行的重命名命令。准备好重命名时，只需从 REN 前面删除 ECHO 命令即可。

如果同级文件夹具有具有相同时间戳的最新修改文件，则至少一次重命名将失败。

此外，该脚本无法重命名不包含任何文件的文件夹。

```
@echo off
setlocal disableDelayedExpansion
if "%~1" neq "" pushd %1
for /f "eol=: delims=" %%D in ('dir /s /b /ad ^| sort /r') do call :renameFolder "%%D"
exit /b

:renameFolder
pushd %1
for /f "eol=: delims=" %%F in ('dir /b /a-d /o-d') do (
  for /f "tokens=1-4* delims=/: " %%A in ("%%~tF") do (
    popd
    echo ren %1 "%%C-%%A-%%B %%D.%%E"
    exit /b
  )
) 
```

# ios - 阻止 UIView 旋转到横向

> ID：11441762
> 
> 赞同：2
> 
> 时间：2012-07-11T21:27:35.503
> 
> 标签：ios, uiview, uiinterfaceorientation

我在导航控制器中有一个 UIView，我试图阻止这个视图进入景观，但是我尝试使用的方法永远不会触发..代码低于任何帮助将不胜感激..

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    if(interfaceOrientation == UIInterfaceOrientationLandscapeRight)
    {
        return NO;
    }
    else if(interfaceOrientation == UIInterfaceOrientationLandscapeLeft)
    {
        return NO;
    }
    return NO;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T21:33:16.443

您应该`return NO;`为父导航控制器或在 a 上设置`UIViewController`，而不是在`UIView`.

此外，这与更少的代码相同：

## iOS 5.x

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
} 
```

## iOS 6

从 iOS 6 开始，`shouldAutorotateToInterfaceOrientation:`已弃用。如果视图控制器不覆盖该`supportedInterfaceOrientations`方法，`UIKit`则从应用程序委托或应用程序的 Info.plist 文件中获取默认旋转。

您将需要使用：

```
- (NSUInteger)supportedInterfaceOrientations NS_AVAILABLE_IOS(6_0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-10T23:29:07.583

另一种选择是修改部署信息。

![截屏](../Images/b53eca650846e4c65f8504d616098566.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T21:33:24.643

此方法需要在`UIViewController`实例中实现，而不是在`UIView`.

此外，您实际上正在返回`NO`所有方向，这是不正确的。您需要返回`YES`至少一个方向（最常见的方向`UIInterfaceOrientationPortrait`）。

# android - 优化/组合相关的 Android 布局

> ID：11441772
> 
> 赞同：3
> 
> 时间：2012-07-11T21:28:18.123
> 
> 标签：android, performance, optimization, layout

我想要一些关于 Android UI (in) 效率的建议。我正在尝试确定为我的应用程序构建特定布局的最佳方式，但是我认为我最初的想法可能会冒着降低性能的风险。基本上我有三个非常相似和相关的应用程序组件，要配置它们，我需要用户输入。这三个组件在全局集中共享不同的参数。我想确定一种在设备上显示此输入表单的良好、流畅的方式。

我想做的只是允许用户使用一种形式代替三种形式。所有三个组件都是相关/相似的，它们共享一些用户需要输入的配置参数。

**我最初的想法如下：**

1.  通过 XML 为三个实例中的任何一个构建初始显示所需的 UI 元素的广泛布局。不幸的是，考虑到按行组织的参数数量，在这种情况下**总共将达到大约 50 个视图对象。**
2.  创建活动，以便用户进入屏幕，并了解他们最初需要从屏幕顶部的 Spinner 小部件中选择三个值之一。
3.  通过使用按位比较运算符，只需显示/隐藏与所选 Spinner 值相关的各种控件。（通过 Spinner 的 onItemSelectedListener() 触发）
4.  创建一些次要/轻量级动画等，以便他们了解正在添加或删除拼图的各个部分以反映他们的选择。

或者，第二种理论涉及使用三个不同的活动，并在三个不同的活动之间保存状态，在它们之间传递参数......也许我应该放弃我最初的想法并使用沿着这些思路的东西？第三种选择？

这样做的主要动机不仅仅是将其分解为三种不同的形式，它应该允许用户在选择重新考虑他们的初始选择时体验到一致的 UI，并且将挫败感降到最低。使用上述方法，如果用户填写了一半的表单并决定他们想使用 Spinner 的替代选项，他们的信息显然会被保留，因为他们将使用相同的视图对象。

我想请大家就如何实现这一点提出一些建议，而不会冒着在典型的中端 Android 设备上出现太多性能下降的风险（我的意思是大多数用户拥有的手机，从 Froyo 起，尤其是那些来自姜饼的人）。我很担心，因为我只能使用一台测试设备，而且它是 HTC One X 手机，对于了解大多数普通设备如何渲染更复杂的布局，这显然是一个非常糟糕的选择。

我也很感激有关优化性能提示的任何指导...我从搜索社区和 Android 的开发人员资源中了解到，渲染某些布局对象比渲染其他对象更详尽，我应该尽可能选择 LinearLayout（而不是 RelativeLayout例如）。是否有任何确定的资源来比较 UI 选项的性能？我非常愿意为您节省时间和精力，并亲自去获取知识。

提前感谢您的时间和精力。干杯。

**编辑：**我想我应该提一下，如果有必要，在最初加载活动时（无论如何是第一次），几乎不需要将这些视图都绘制到屏幕上......如果需要，我最初只能加载几个视图，并且微调器小部件。默认情况下，这就像加载“未选择选项”而不是选项 1。如果设备运行缓慢，对用户的影响实际上可能很小，因为他们的设备在加载 Activity 时实际上只需要绘制少量的视图对象。在任何时候，设备可能只需要在任何时候渲染并随后显示大约 30 个视图对象。我想关键问题是，“如果他们的手机正在努力加载大量 XML，用户是否会遇到挂起或延迟，即使它”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:32:55.330

+1 在这个问题上付出了巨大的努力。我个人的建议是你坚持你的第二个理论。将数据与视图分开——将输入的值存储在 SharedPreferences 或数据库之类的地方——并具有三种不同的布局（每个表单一个）。在创建 Activity 时，检查每个公共字段是否有以前存储的值，如果存在则填充该字段。尝试做类似第一个列表的事情，虽然可能很聪明，但并不理想。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:31:26.393

我认为只为不同的设备屏幕开发布局会更有意义。您可以这样做，并将不同的布局放在不同的文件夹中。这是一篇很棒的文章，讨论了其中的一些内容。我不会给人们选择的“选项”。他们可能并不总是知道答案，因此最好让手机决定使用哪种布局。

这是这篇文章：

[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

# javascript - 区分程序化 Bing AJAX 地图导航与用户平移/缩放和窗口大小调整

> ID：11441781
> 
> 赞同：3
> 
> 时间：2012-07-11T21:29:01.183
> 
> 标签：javascript, bing-maps

我有一个场景，我需要在窗口调整大小或平板电脑方向更改时不断保持特定的`LocationRect`最佳拟合（即结果`map.setView({ bounds: myLocationRect })`）在地图中可见，直到用户与地图交互以更改当前视图。

我需要一些关于如何做到这一点的指导。考虑到有多少不同的鼠标和键盘交互可以改变视图，我不想过滤所有这些交互；过滤掉包含 HTML 元素的地图改变大小的场景似乎更合适。

我已经尝试通过跟踪地图元素的先前宽度/高度并监听`targetviewchanged`事件来做到这一点；但是，这对我来说并不可靠。原因是，如果我重置视图，我无法可靠地暂停收听`targetviewchanged`. 例如：

```
function resetView() {
    if(!_keepAoiInView) return; // unhook setInterval as well; omitted for brevity

    _suspend = true;
    _map.setView({ bounds: theBoundsIWant });
    _suspend = false;
}

function ontargetviewchanged() {
    // This suspend check doesn't work - 
    //  resetView() isn't always lower in the call stack;
    //  therefore, _suspend is set back to false before the
    //  targetviewchanged event fires.
    if(_suspend) return;

    _keepAoiInView = false;  // unhook setInterval as well; omitted for brevity
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T03:19:01.433

如果您似乎无法开始`targetviewchanged`工作，也许值得重新考虑跟踪其他事件。

您可以使用[pointer.js](https://github.com/borismus/pointer.js)更轻松地跟踪所有不同的可能交互。这样，您只需要捕获几种类型的事件，这些事件在后台代表多种类型的事件。如果它与 Bing 地图配合得很好，那可能会解决鼠标、触摸和可能的手势事件的问题。

我怀疑这可能无法解决键盘事件的问题，但也许监控这些事件也是可以管理的。

# ruby-on-rails - 未设置正则表达式全局变量

> ID：11441782
> 
> 赞同：5
> 
> 时间：2012-07-11T21:29:07.407
> 
> 标签：ruby-on-rails, ruby, regex, activesupport

我遇到了一些看起来不寻常的事情，我想知道是否有人可以解释原因。

```
1.8.7 :001 > some_str = "Hello World"
 => "Hello World" 
1.8.7 :002 > some_str.try(:match, /^(\w*)/)
 => #<MatchData "Hello" 1:"Hello"> 
1.8.7 :003 > $1
 => nil 
1.8.7 :004 > some_str.match(/^(\w*)/)
 => #<MatchData "Hello" 1:"Hello"> 
1.8.7 :005 > $1
 => "Hello" 
```

我不确定为什么`$1`第一次没有设置全局变量，而是第二次设置了全局变量。有什么见解吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T22:12:13.963

`try`定义为

```
def try(method, *args, &block)
  send(method, *args, &block)
end 
```

当然，在 nil 上它只返回 nil 除外。为什么这很重要？因为正则表达式全局变量不是真正的全局变量：它们是在每个方法和每个线程的基础上维护的（通过阅读 ruby​​ 源代码很容易看到这一点）。当您`match`通过`try`全局调用时，它们被设置在范围内，`try`但在下一种情况下，它们被设置在顶层。很容易验证这一点

```
def do_match string, regexp
  string =~ regexp
  $1
end
do_match "Hello World", /^(\w*)/ #=> returns 'Hello'
$1 #=> returns nil 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T22:12:23.760

让我告诉你`try`是如何实现的。如果您想自己查看，请查看 activesupport 源。它在[/lib/active_support/core_ext/object/try.rb中定义](https://github.com/rails/rails/blob/master/activesupport/lib/active_support/core_ext/object/try.rb)

```
class Object
  def try(*a, &b)
    if a.empty? && block_given?
      yield self
    else
      public_send(*a, &b)
    end
  end
end 
```

这基本上做了什么，只是将方法名称和完整的参数发送到`Object`. `public_send`与 send 相同，但只能用于调用公共方法。

所以我重写了这个，以调试你的问题：

```
class Object
  def try(*a)
    result = public_send(*a)
    puts $1.inspect
    result
  end
end

string = "Hello"
string.try(:match, /^(\w*)/)
puts $1.inspect 
```

这输出

```
"Hello"
nil 
```

所以出现了一个大问题：**这是 ruby​​ 解释器中的错误吗？**. *也许。*至少它没有记录在任何官方来源中。我找到了一个参考，告诉以下内容（[请参阅*全局变量*](http://www.rubyist.net/~slagell/ruby/globalvars.html)。）

> [...]，`$_`并`$~`具有本地范围。它们的名称表明它们应该是全球性的，但这样更有用，而且使用这些名称是有历史原因的。

所以它似乎`$1`也不是一个全局变量，即使它被内核报告为一个全局变量：

```
1.9.3-p194 :001 > global_variables
 => [:$;, :$-F, :$@, :$!, :$SAFE, :$~, :$&, :$`, :$', :$+, :$=, :$KCODE, :$-K,
     :$,, :$/, :$-0, :$\, :$_, :$stdin, :$stdout, :$stderr, :$>, :$<, :$.,
     :$FILENAME, :$-i, :$*, :$?, :$$, :$:, :$-I, :$LOAD_PATH, :$",
     :$LOADED_FEATURES, :$VERBOSE, :$-v, :$-w, :$-W, :$DEBUG, :$-d, :$0,
     :$PROGRAM_NAME, :$-p, :$-l, :$-a, :$binding, :$1, :$2, :$3, :$4, :$5, :$6,
     :$7, :$8, :$9] 
```

为了确保这一点，我将这种不一致转发给了 Ruby Bug Tracker。请参阅[Ruby 错误 #6723](https://bugs.ruby-lang.org/issues/6723)

# asp.net-mvc - TagBuilder 类导致致命错误

> ID：11441784
> 
> 赞同：0
> 
> 时间：2012-07-11T21:29:19.263
> 
> 标签：asp.net-mvc

当我在控制器中使用 TagBuilder 类时，我的网站崩溃并简单地返回一个平淡的页面。

该代码在运行 Windows 7 的本地计算机上完美运行。我现在尝试使用两个不同的 Web 主机，它们都有相同的问题：如果我在后面的代码中使用 TagBuilder 类，则会出现空白页面。我已经制定了一个解决方法，因此我只需使用 String.Format 构建标签字符串，但我会理解问题所在，然后更正错误。

我觉得我应该提供一些代码，但我已将其范围缩小到以下行：

```
// A blank page is returned if unless I uncomment the following line
// and avoid the TagBuilder class.
TagBuilder tag = new TagBuilder("link"); 
```

对于以下问题，我真的很感激我能得到的任何帮助，因为我无法理解这个错误是如何发生的。

我应该去哪里看？网络配置？我试过启用跟踪，但这对我没有帮助。Microsoft 最近在 TagBuilder 类中是否进行了任何更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T19:55:02.087

我从来不知道为什么我的代码不起作用，但我确实找到了解决方案：我现在在将网站发布到网站之前对其进行预编译。我完全不知道为什么会这样。:)

# java - Java EE 5 和休眠

> ID：11441785
> 
> 赞同：3
> 
> 时间：2012-07-11T21:29:24.760
> 
> 标签：java, hibernate, jakarta-ee, data-access

我可以在 Java EE 5 中使用哪个版本的 Hibernate？我可以使用最新版本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:34:49.793

任何。JPA 和 Hibernate 都不会限制您对应用程序服务器的选择。他们是独立的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T06:26:59.020

见[http://www.hibernate.org/](http://www.hibernate.org/)，它说最新的 4.1.4 版本可以与 Java EE 5 一起使用。

# css - CSS加载时背景属性的URL消失

> ID：11441786
> 
> 赞同：0
> 
> 时间：2012-07-11T21:29:30.090
> 
> 标签：css, url, background, background-image

我遇到了最奇怪的 CSS 问题。我的 CSS 在我的 localhost 服务器上运行良好，但是当我将它加载到实时服务器上时，背景属性中的“url”消失了。

这是 HTML - 非常基本的 div：<div id="header-wrapper"> </div>

这是我工作文件中的 CSS：

```
#header-wrapper {
    overflow: hidden;
    height: 300px;
    background: url('../images/bgblue.jpg') repeat-x left top;
} 
```

以下是我在实时站点上查看页面源时显示的内容：

```
#header-wrapper {
    overflow: hidden;
    height: 300px;
    background: 

    (images/bgblue.jpg) repeat-x left top;
} 
```

如您所见，“url”部分已消失。更奇怪的是，紧随其后的 div 具有完全相同的格式并且显示正常。帮助！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T16:55:23.847

我注意到了这个问题，样式没有显示在实时页面上。它通常发生在语法错误时，浏览器不加载该规则，因此 Firebug 甚至不显示它。清除缓存并转到 .css 文件的 url，确保它正在发送预期的代码。如果是这样，则存在语法错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:47:21.357

如果它是“完全”相同的格式，那么您提到的下一个 div 应该具有相同的 id。Id 应该在一个页面中使用一次。

我不知道这是否有帮助，但请尝试`background-image: url`。

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-11T21:48:27.467

尝试使用：

```
#header-wrapper {
overflow: hidden;
height: 300px;
background: url(/images/bgblue.jpg) repeat-x left top;
} 
```

# php - MYSQL 中的 TIMESTAMPDIFF 计算两个日期之间的月数

> ID：11441787
> 
> 赞同：2
> 
> 时间：2012-07-11T21:29:39.607
> 
> 标签：php, mysql, date, timestamp

我的服务器使用的是旧版本的 PHP，所以很遗憾我不能使用 $datetime1->diff($datetime2) 方法。

我目前正在使用以下代码，但它并没有真正起作用：

```
$from = explode("-",date("Y-m-d",$recurring_invoices->start_date));
$to = explode("-",date("Y-m-d",$to_time));
$months = ($to[0]-$from[0])*12+$to[1]-$from[1]; 
```

它将 7 月 30 日至 6 月 1 日计算为一个整月。它应该只计算从 7 月 1 日到 6 月 1 日的整个月份。

我注意到有一个 MYSQL TIMESTAMPDIFF 函数，但我似乎也无法让它工作。

```
$query = "SELECT TIMESTAMPDIFF(MONTH,'$recurring_invoices->start_date','$from_time')";
print_r($this->queryResult($query)); 
```

或者

```
$query = "SELECT TIMESTAMPDIFF(MONTH, from_date, to_date) FROM agenda";
print_r($this->queryResult($query)); 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:55:22.157

我认为这应该可行，~~但现在未经~~测试[并](http://codepad.viper-7.com/7dpxHj)已修复：

```
list($startYear, $startMonth, $startDay) = explode('-', date('Y-n-j', $recurring_invoices->start_date));
list($endYear, $endMonth, $endDay) = explode('-', date('Y-n-j', $to_time));

$months = 0;
$months += ($endYear-$startYear) * 12;
$months += $endMonth - $startMonth;
if ($startDay > $endDay) {
  $months -= 1;
}

echo $months; 
```

# javascript - javascript中构造函数和对象之间的等价性

> ID：11441788
> 
> 赞同：0
> 
> 时间：2012-07-11T21:29:43.740
> 
> 标签：javascript

我理解构造函数是一个返回对象的特殊函数。但

```
> Animal = function (){this.species='animal'}
> a=new Animal()
> b={species:'animal'}
> a==b

==> false 
```

为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T21:30:39.543

像这样的比较不是“深度”比较。“a”和“b”要么指代完全相同的对象，要么不指代相同的对象。

换句话说，通过比较两个变量，您是在比较对对象的引用，而不是对象本身。

*编辑——***原始**类型（布尔值、数字、字符串）和对象引用之间存在差异。就像我说的，你的问题是一对对象引用。如果两个对象引用指向同一个对象，则它们被认为是相等的。在你的情况下，他们没有。它们是两个不同的对象，碰巧具有相同的属性和相同的值。对象的属性在比较中不发挥作用，`==`因为这只是定义语言的工作方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T21:39:14.000

在此处阅读有关真理与平等的更多信息。非常好的帖子。

[http://javascriptweblog.wordpress.com/2011/02/07/truth-equality-and-javascript/](http://javascriptweblog.wordpress.com/2011/02/07/truth-equality-and-javascript/)

# mysql - 更新查询不起作用

> ID：11441789
> 
> 赞同：0
> 
> 时间：2012-07-11T21:29:46.940
> 
> 标签：mysql, netbeans

我有一个应该可以工作的更新查询，但由于某种原因它不起作用

```
String sql="UPDATE TB_EARTHORIENTATIONPARAMETER_UI SET  YEAR='year1',  MONTH='month1',  DAY='day1',  MJD='mjd1',  WHERE (EOPID=1)"; 
```

它给了我以下错误

```
Incorrect integer value 'year1' for column YEAR at row1 
```

我的表由以下列及其类型组成

```
| EOPID         | int(11) | NO   | PRI | NULL    | auto_increment |
| YEAR          | int(11) | YES  |     | NULL    |                |
| MONTH         | int(11) | YES  |     | NULL    |                |
| DAY           | int(11) | YES  |     | NULL    |                |
| MJD           | int(11) | YES  |     | NULL    |                | 
```

我以以下方式从 jTable 检索要在我的 sql 更新查询中使用的值

```
Object year=model.getValueAt(row, column);
        years=year.toString();
        year1=Integer.parseInt(years); 
```

所以我相信我使用的是正确的类型，但我不知道为什么它不会更新。这是mysql版本的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:33:23.303

您的查询应该是这样的。

```
String sql="UPDATE TB_EARTHORIENTATIONPARAMETER_UI 
            SET  
                YEAR="+year1+",  
                MONTH="+month1+",  
                DAY="+day1+",  
                MJD="+mjd1+"  
            WHERE 
                EOPID=1"; 
```

其中`year1`, `month1`, `day1`,`mjd1`应该是包含适当值的变量（`WHERE`尽管在子句之前有一个额外的 comm）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:33:15.053

系统抱怨你给它一个字符串（“year1”），而不是它期望的整数值（例如 2012）。

你应该这样写：

```
String sql="UPDATE TB_EARTHORIENTATIONPARAMETER_UI SET  YEAR=" +
            year1.toString() + ", month..." 
```

# php - 带有 FPDI 模板和 CSS 的 TCPDF

> ID：11441790
> 
> 赞同：1
> 
> 时间：2012-07-11T21:29:48.750
> 
> 标签：php, pdf, tcpdf, fpdi

将 TCPDF 与 FPDI 模板一起使用时，在此过程中会丢失一些 CSS 支持。问题是边框或背景颜色之类的东西，最终出现在 PDF 模板下方的图层中。TCPDF 用于`SetLineStyle()`将 CSS 边框/背景转换为 PDF，这似乎是问题所在。

例如：

```
$this->setSourceFile($filename); // /path/to/my/background.pdf
$imported_page = $this->ImportPage(1);
$this->useTemplate($imported_page);

...

$html = '<table style="border: 1px solid #000;"><tr><td style="background-color: #ff0000;">...</td></tr></table>';

$this->writeHTMLCell(45, 25, 160, 29, $html); 
```

不呈现 CSS 边框。一旦`useTemplate()`删除边界就在那里。使用 Illustrator 分析生成的 PDF 会发现一些有趣的事情：

PDF 图层`useTemplate()`- 从上到下：

1.  表/内容层
2.  PDF 模板图层 (群展)
3.  边框和背景层（路径）

PDF 图层没有`useTemplate()`- 从上到下：

1.  表/内容层
2.  边框和背景层（路径）

在 Illustrator 中禁用包含 PDF 模板的图层组时，边框和背景变得可见。

不幸的是，我们没有找到将 PDF 模板图层组放在堆栈底部的方法，以便其他所有内容都呈现在其上方。我们能想出的唯一解决方法是将`writeHTMLCell()`调用包装在`startTemplate()`/中`endTemplate()`并完成`printTemplate()`：

```
$this->setSourceFile($filename); // /path/to/my/background.pdf
$imported_page = $this->ImportPage(1);
$this->useTemplate($imported_page);

...

$html = '<table style="border: 1px solid #000;"><tr><td style="background-color: #ff0000;">...</td></tr></table>';

$workaround_template = $this->startTemplate($w, $h);
$this->writeHTMLCell(45, 25, 160, 29, $html); 
$this->endTemplate();
$this->printTemplate($workaround_template, $x, $y, $w, $h, 'T', 'L'); 
```

所以出于好奇：这是唯一的方法，还是有办法将 PDF 模板放在所有事情的底部？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-27T09:03:02.433

解决方案是确实使用 setPageMark() 。这对我来说非常有效：

```
public function AddPage($orientation = '', $format = '') {
    global $pdf_data_path;
    parent::AddPage($orientation, $format);
    if ($this->use_headed) {
        $this->setSourceFile($pdf_data_path."/headed.pdf");
        $tplidx = $this->importPage(1, '/MediaBox');
        $this->useTemplate($tplidx, 0, 0, 0, 0, true);
        $this->setPageMark();
    }       
} 
```

关键是在使用模板后放置 setPageMark() 。然后边框将堆叠在生成的 PDF 中的模板顶部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T18:55:35.703

您是否尝试使用[setPageMark()](http://www.tcpdf.org/doc/classTCPDF.html#a15d65cdde4d6d9df6d1c7fdb985c0e22) -方法？

# c# - 三点角的圆弧怎么画？

> ID：11441793
> 
> 赞同：2
> 
> 时间：2012-07-11T21:30:02.607
> 
> 标签：c#, wpf, xaml, custom-controls, controls

我正在创建一个可以绘制角度的控件。我有三个依赖对象。

*   半径：线的长度
*   StartAngle：我应该从什么角度开始
*   角度

这是有关当前绘制的程序的屏幕截图（红线是我要绘制的）。

![在此处输入图像描述](../Images/90f50078a1d4702cd5e20fc01647acce.png)

所以我还没有完成的是弧线。我需要一些帮助来绘制它。这就是我所拥有的。

```
public class AngleControl2 : Control
{
    static AngleControl2()
    {
        DefaultStyleKeyProperty.OverrideMetadata(typeof(AngleControl2), new FrameworkPropertyMetadata(typeof(AngleControl2)));
    }

    public double Angle
    {
        get { return (double)base.GetValue(AngleProperty); }
        set { base.SetValue(AngleProperty, value); }
    }

    public static readonly DependencyProperty AngleProperty =
      DependencyProperty.Register("Angle", typeof(double), typeof(AngleControl2), new PropertyMetadata(90.0, new PropertyChangedCallback(AngleChanged)));

    public double StartAngle
    {
        get { return (double)base.GetValue(StartAngleProperty); }
        set { base.SetValue(StartAngleProperty, value); }
    }

    public static readonly DependencyProperty StartAngleProperty =
      DependencyProperty.Register("StartAngle", typeof(double), typeof(AngleControl2), new PropertyMetadata(0.0, new PropertyChangedCallback(AngleChanged)));

    public double Radius
    {
        get { return (double)base.GetValue(RadiusProperty); }
        set { base.SetValue(RadiusProperty, value); }
    }

    public static readonly DependencyProperty RadiusProperty =
      DependencyProperty.Register("Radius", typeof(double), typeof(AngleControl2), new PropertyMetadata(100.0));

    static void AngleChanged(DependencyObject property, DependencyPropertyChangedEventArgs args)
    {
        AngleControl2 c = (AngleControl2)property;

        Line line1 = c.GetTemplateChild("PART_Line1") as Line;
        Line line2 = c.GetTemplateChild("PART_Line2") as Line;

        if (line1 != null)
        {
            line1.X2 = Math.Cos((c.StartAngle + c.Angle) * (Math.PI / 180)) * c.Radius;
            line1.Y2 = Math.Sin((c.StartAngle + c.Angle) * (Math.PI / 180)) * c.Radius;
        }

        if (line2 != null)
        {
            line2.X2 = Math.Cos(c.StartAngle * (Math.PI / 180)) * c.Radius;
            line2.Y2 = Math.Sin(c.StartAngle * (Math.PI / 180)) * c.Radius;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:34:50.003

有一个[`ArcSegment`](http://msdn.microsoft.com/en-us/library/system.windows.media.arcsegment.aspx)类可以做到这一点，阅读文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-13T20:34:09.800

使用路径代替线会更容易。例如，如果您有以下模板

```
<Canvas Width="200" Height="200">
    <Path x:Name="PART_Path" Stroke="Green" StrokeThickness="3" Canvas.Left="100" Canvas.Top="100"/>
</Canvas> 
```

然后您可以在 AngleChanged 事件中使用此代码：

```
Path path = c.GetTemplateChild("PART_Path") as Path;

if (path != null)
{
    Point p = new Point(
        Math.Cos((this.StartAngle + this.Angle) * (Math.PI / 180)) * this.Radius,
        Math.Sin((this.StartAngle - this.Angle) * (Math.PI / 180)) * this.Radius);

    Point q = new Point(
        Math.Cos((this.StartAngle) * (Math.PI / 180)) * this.Radius,
        Math.Sin((this.StartAngle) * (Math.PI / 180)) * this.Radius);

    path.Data = new PathGeometry()
    {
        Figures = new PathFigureCollection()
        {
            new PathFigure()
            {
                StartPoint = new Point(0, 0),
                Segments = new PathSegmentCollection()
                {
                    new LineSegment() { Point = p }
                }
            },
            new PathFigure()
            {
                StartPoint = new Point(0, 0),
                Segments = new PathSegmentCollection()
                {
                    new LineSegment() { Point = q }
                }
            },
            new PathFigure()
            {
                StartPoint = new Point(p.X/3, p.Y/3),
                Segments = new PathSegmentCollection()
                {
                    new ArcSegment()
                    {
                        IsLargeArc = (Math.Abs(this.Angle) % 360) > 180,
                        RotationAngle = Math.Abs(this.Angle) * (Math.PI / 180),
                        SweepDirection = this.Angle < 0 ? SweepDirection.Counterclockwise : SweepDirection.Clockwise,
                        Point = new Point(q.X/ 3, q.Y/ 3),
                        Size = new Size(this.Radius / 3, this.Radius/3)
                    }
                }
            },
        }
    };
} 
```

请注意，像这样在 OnApplyTemplate() 中调用 AngleChanged 处理程序也是一个更好的主意，这样视觉对象就会在启动时显示出来。

```
protected override void OnApplyTemplate()
{
    base.OnApplyTemplate();
    AngleChanged(this, null);
} 
```

# android - Android：在不同的屏幕密度上绘制相同大小的线或圆

> ID：11441796
> 
> 赞同：2
> 
> 时间：2012-07-11T21:30:18.280
> 
> 标签：android, size, draw, paint, stroke

当我将绘画笔触大小设置为 15 时，它适合一个屏幕，而在另一个屏幕上它太大或太小，我怎么知道屏幕密度以让它设置笔触宽度以适应屏幕密度？

我正在尝试将它用于动态壁纸、服务而不是应用程序，所以我无法使用获取 Windows 管理器...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:43:15.210

> i am trying to use it for a live wallpaper, a service, not an application, so i can't use get windows manager...

You mean Activity. Even a live wallpaper Service is still defined as a component inside of an application, but anyway...

The best way is to put your dimension into a resource and let the resource framework do the math for you. Define a `res/values/dimens.xml` file that looks like this:

```
<resources>
    <dimen android:name="strokeWidth">15dp</dimen>
</resources> 
```

Then inside of your `Service` you can call:

```
Resources res = getResources();
float strokeWidth = res.getDimension(R.dimen.strokeWidth); 
```

This will return back a value scaled for the screen density since the dimension was defined in "dp" units. So it will be 15@MDPI, 22.5@HDPI, and so on. You can also use `getDimensionPixelOffset()` or `getDimensionPixelSize()` if you want the value back as an `int` instead.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:33:24.393

这篇文章可能会帮助你：

[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

最终，您将不得不针对不同的屏幕密度进行开发。

# c++ - glUniforms() 和 [] 运算符重载问题

> ID：11441797
> 
> 赞同：0
> 
> 时间：2012-07-11T21:30:20.020
> 
> 标签：c++, opengl, pointers, reference

我在编译以下代码时遇到了一些问题：

```
GLint iModelMatrix = glGetUniformLocation(m_shaderProgramID, "mvMatrix");
glUniformMatrix4fv(iModelMatrix, 1, GL_FALSE, &myMatrix[0]);

GLint iLight = glGetUniformLocation(m_shaderProgramID, "vLightPos");
glUniform3fv(iLight, 1, &myVector[0]); 
```

现在 myMatrix 和 myVector 是两个对象，每个类都重载了 [] 运算符，如下所示：

```
inline float& operator[](int index)     { return m_data[index]; }
inline float  operator[](int index) const   { return m_data[index]; } 
```

我收到以下错误：

```
error C2102: '&' requires l-value 
```

我试图理解为什么 '&' 需要左侧值？我以前传递过这样的数据。我不是简单地将地址赋予 m_data 数组的第一个索引吗？这不构成浮动*吗？

为什么不满足功能规范？

```
void glUniformMatrix4fv(GLint location, GLsizei count, GLboolean transpose, const GLfloat *value); 
```

编辑：

好吧，似乎因为我将这些对象作为 const 引用传递给进行上述调用的函数，所以它按值传递 float* 数组，因此我无法引用它们。

我尝试添加第三个 [] 运算符：

```
inline const float& operator[](int index) const    { return m_data[index]; } 
```

但这让我的编译器爆炸了。我不能这样做有什么原因吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T22:14:57.270

这个：

```
inline float  operator[](int index) const   { return m_data[index]; } 
```

应该*转换*成这样：

```
inline const float &operator[](int index) const   { return m_data[index]; } 
```

如果要取返回值的地址。您不添加第三个版本；您将当前的更改为此*。*您不能获取临时地址，但可以获取`const&`.

`float*`就个人而言，我认为你应该有一个只返回or的特殊函数，`const float*`就像 C++11 对[std::vector::data](http://en.cppreference.com/w/cpp/container/vector/data)所做的那样。这样，您只需跟注`myMatrix.data()`，而不必`&...[0]`拼凑。它是自我记录且显而易见的。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-11T22:04:14.427

只需将结果存储`operator[]`在局部变量中：

```
float tmp = myMatrix[0];
glUniformMatrix4fv(iModelMatrix, 1, GL_FALSE, &tmp); 
```

这避免了不能被视为左值的未命名临时。

# drupal - Drupal 和 XCart。共享用户

> ID：11441800
> 
> 赞同：0
> 
> 时间：2012-07-11T21:30:31.213
> 
> 标签：drupal, x-cart

我刚刚为一个客户完成了一个 xcart 的皮肤设计，他给我发了一封电子邮件，让我知道他一直在与一家 iPhone 开发公司交谈，该公司将在 Drupal 之上为他构建一个社交网络应用程序。

他想知道 xcart 是否能够共享来自 Drupal 的数据，反之亦然。特别是，他们希望一个平台上的注册可以被另一个平台访问，这也可以是任何一个站点访问有关购物习惯或社交互动的信息以推送另一个系统的功能/产品等

这是我第一次接触 xcart，我对 Drupal 的经验为零，但是，我做了一些研究，发现 Drupal 有一个电子商务模块。由于 xcart 系统尚未上线（现在在应用程序启动之前一直处于暂停状态），是否会更快、更容易、更便宜（以开发时间计）和更多的未来证明来废弃我们已经用 xcart 完成的事情，然后重新在 Drupal 电子商务模块上给商店换皮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T17:08:27.580

我看了一下 xcart ，它似乎只是另一个与 zencart/类似意大利面条代码类似的购物车。如果您需要的一切都在那里，那很好，但如果您需要扩展或修改现有行为，那将成为一场噩梦。

您应该使用 Drupal 有几个原因：

1.  更少的麻烦——你只需要学习 Drupal，而不是两个系统
2.  Drupal 将提供您需要的大部分选项；[Ubercart](http://drupal.org/project/ubercart)和[Commerce](http://drupal.org/project/commerce)都有很多功能，所以我怀疑你会错过什么
3.  您还没有准备好 xcart，所以现在离开它并切换到 Drupal 会“更便宜”
4.  集成 3 个系统与集成 2 个系统仍然存在巨大差异，尤其是当您不熟悉 xcart 或 Drupal 时

我不知道你商店的确切要求，但我会说先去 Ubercart 看看它是否适合你。对于初次使用的用户来说更容易理解，拥有成熟的社区和许多提供额外功能的附加模块。

Commerce 主要面向对 Drupal 有丰富经验并了解主要概念的人。那里的所有东西都被提升到另一个抽象的“层”中，这对于新程序员来说很难理解。此外，您经常会发现自己必须亲自动手并使用其他模块进行调试，这可能会很痛苦并且需要花费太多时间。

# html - 哪些浏览器支持 favicon 链接标签？

> ID：11441806
> 
> 赞同：-4
> 
> 时间：2012-07-11T21:30:55.643
> 
> 标签：html, favicon

有没有人支持使用 favicon 的链接标签，而**不是**网站的根目录？我正在考虑这样做作为将文件托管在每个站点的根目录的替代方法，因为我在这样做时遇到了问题。

我的两个网站上的文档类型是：

第一个站点：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" > 
```

第二个站点：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" > 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:37:54.753

链接到所有主流浏览器都应该支持的网站图标的方法是：

```
<link rel="shortcut icon" href="http://example.com/myicon.ico" /> 
```

根据[这篇 Wikipedia 文章](http://en.wikipedia.org/wiki/Favicon)，Internet Explorer、Chrome、Firefox、Opera 和 Safari 支持这种引用图标的方式。

根据[Microsoft](http://msdn.microsoft.com/en-us/library/ms537656%28VS.85%29.aspx)的说法，自 IE7 以来一直支持网站图标。

**边注**

我相信使用`<link>`而不是仅仅将它放在根目录中通常是最好的策略。这样您就可以控制显示的图标。假设您想在将来的某个时间更改图标。使用链接时，您可以重命名图标，强制浏览器下载新图标。否则，用户可能会继续看到您的旧图标，因为它是从浏览器缓存中加载的。

# c# - 获取正在运行的应用程序的屏幕

> ID：11441807
> 
> 赞同：2
> 
> 时间：2012-07-11T21:31:10.103
> 
> 标签：c#, winapi, position

当我得到它的句柄时，我想检测一个窗口显示在哪个屏幕上。我`SetWindowPos()`在 Win API 中找到了一个函数，但不幸的是不`GetWindowPos()`只是 a `GetWindowRect()`，但这会产生一些奇怪的值。

我有两台设备，左边一台 1280x1024，右边一台（主要）1680x1050。当我想获得最小化 Firefox 的位置时，我会在任一屏幕上获得 b/l/r/t -31973/-32000/-31840/-32000。

我怎么知道这是我的左屏还是右屏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:33:24.720

尝试[`GetWindowPlacement`](http://msdn.microsoft.com/en-us/library/ms633518.aspx)，以便找到窗口在恢复后将使用的矩形。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T21:47:15.770

WinAPI 有一个[`MonitorFromRect`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145063%28v=vs.85%29.aspx)函数，这可能是你需要的。我不确定是否有 C# 等价物，但您可以通过互操作调用它。

请注意，该窗口可以在两个监视器上，也可以不在两个监视器上。API 有相应的标志，例如`MONITOR_DEFAULTTONEAREST`.

# qt - 使用 QPropertyAnimation 调整窗口大小

> ID：11441809
> 
> 赞同：6
> 
> 时间：2012-07-11T21:31:14.823
> 
> 标签：qt, animation

我有以下问题：我想使用 QPropertyAnimation 调整窗口大小，以便看起来不错，但是在调整大小时窗口也会立即移动，而我不想这样做，我只想调整窗口大小和不改变其位置值。

所以，这是我的代码：

```
animation = new QPropertyAnimation(this, "geometry");
animation->setDuration(150);
animation->setStartValue(QRect(preferences::x(), preferences::y(), width, window_height_min));
animation->setEndValue(QRect(preferences::x(), preferences::y(), width, window_height_min+expand_general_to));
animation->start(); 
```

其中 width 和 window_height_min 和 expand_general_to 是我自己的变量，用于处理必须完成的调整大小。但是，preferences::x() 和preferences::y() 真正处理我的窗口的位置，那么为什么它会移动，而prefereces::x() 两次都一样？（在开始值和结束值中）？

提前感谢您的任何答案！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-12T04:20:34.727

请尝试设置 size 属性。

```
animation = new QPropertyAnimation(this, "size");
animation->setDuration(150);
animation->setStartValue(QSize(width, window_height_min));
animation->setEndValue(QSize(width, window_height_min+expand_general_to));
animation->start(); 
```

# git - 不同开发平台之间的依赖跟踪

> ID：11441814
> 
> 赞同：0
> 
> 时间：2012-07-11T21:31:46.797
> 
> 标签：git, dependency-management

当唯一常见的部分是 Git 时，任何人都知道如何最好地跟踪不同开发语言/平台之间的依赖关系？

我最初的想法是在提交消息中使用一些特殊的标签，例如“DEPEND: [proj/repo-abbr]: [commit-or-tag]”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:20:10.390

这，呃，听起来很残酷。您不能使用[世界](http://maven.apache.org/)上众多[依赖](http://rubydoc.info/gems/rake/0.9.2.2/frames)管理[工具之一](https://buildr.apache.org/)[的](http://www.cmake.org/)任何特殊原因？即使是[最古老、](http://www.gnu.org/software/make/manual/make.html)最[简单](http://ant.apache.org/)和[最古怪](http://www.gnu.org/software/autoconf/)（诚然有些人会说[“邪恶”](http://news.ycombinator.com/item?id=1499738)）在构建过程中而不是在提交时处理依赖关系？

# xpath - JMeter XPath 提取器 SAXException

> ID：11441815
> 
> 赞同：1
> 
> 时间：2012-07-11T21:31:50.370
> 
> 标签：xpath, jmeter, jsoup

我正在使用 xpath 提取器从响应数据中检索表单属性值。但是，此响应数据包含字符串“C&I”等数据，这会导致以下 SAXException

> jmeter.extractor.XPathExtractor: SAXException while processing `(substring-after(//form[@id='headerForm']/@action,'/dashboard.xhtml?'))` 对实体“I”的引用必须以';'结尾 分隔符。

我无法控制这些数据，因为它是从数据库中获取的。我尝试检查“使用整洁（容错解析器）”选项。这会导致以下警告/错误

> 错误 - jmeter.util.XPathUtil：TidyException：第 35 行第 31 列 - 警告：修剪空 <div>

响应的第 35 行如下：

```
`<div style="clear: both;"></div>`

```

提取该属性值对于我的进一步处理至关重要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-12T12:51:58.497

至于所有有解决方案的东西，它可能又快又脏，但对于一个问题总是有更多的解决方案。

我建议使用[jsoup](http://jsoup.org/)来为您解析 HTML，而不是使用 xpath 提取器。我假设您正在尝试提取特定表单的操作属性。

第 1 步 -> 将`jsoup-1.6.3.jar`或任何其他版本添加到您的`JMETER_HOME\lib`

第 2 步 -> 将 a 添加`BeanShell PostProcessor`到您的`Sampler`HTTP 或任何其他

第 3 步 -> 在脚本大框中粘贴此代码：

```
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.select.Elements;

String html = prev.getResponseDataAsString(); // get response from your sampler
Document doc = Jsoup.parse(html);
String formAction = doc.select("#headerForm").attr("action");
vars.put("action", formAction); 
```

HTML 选择器是基于 jquery 的。所以它可以做非常漂亮和整洁的事情。无论如何，您应该有`${action}`变量可以在测试中进一步使用。

**更新**

所以你不要纠结于我创建的 jMeter 后处理器的代码，`Html Extractor`这里调用的是 github url：

[https://github.com/c0mrade/Html-Extractor](https://github.com/c0mrade/Html-Extractor)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:36:25.597

源文档中的杂散`&`在 XML 中是不合法的。来自 XML 规范（强调我的）

> 与号字符 (&) 和左尖括号 (<) 仅在用作标记分隔符时，或在注释、处理指令或 CDATA 部分中时，才能以其文字形式出现。它们在内部实体声明的文字实体值内也是合法的；请参阅“4.3.2 格式良好的解析实体”。**如果在其他地方需要它们，则必须使用数字字符引用或字符串“ *&* ;”对它们进行转义 和“ *<* ;” 分别**。

解析器将 解释`&`为实体引用的开头，它期望以分号结尾。

资源：

*   [http://www.w3.org/TR/1998/REC-xml-19980210/#syntax](http://www.w3.org/TR/1998/REC-xml-19980210/#syntax)

请注意，您包含的错误（几乎可以肯定）是不相关的。Tidy 只是指出 div 不包含任何内容（即它是空的）。

# iphone - 关闭应用程序后数据被删除 [IOS]

> ID：11441817
> 
> 赞同：0
> 
> 时间：2012-07-11T21:31:57.920
> 
> 标签：iphone, ios, cocoa, core-data

我编写了一个 ios 应用程序，以便将数据保存到核心数据，然后使用以下代码获取它：

```
 NSManagedObjectContext *context = [self managedObjectContext];
NSError *error;

NSManagedObject *failedBankInfo = [NSEntityDescription
                                   insertNewObjectForEntityForName:@"UserData"
                                   inManagedObjectContext:context];
[failedBankInfo setValue:[NSNumber numberWithInt:1] forKey:@"userId"];

NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription
                               entityForName:@"UserData" inManagedObjectContext:context];
[fetchRequest setEntity:entity];
NSArray *fetchedObjects = [context executeFetchRequest:fetchRequest error:&error];
for (NSManagedObject *info in fetchedObjects) {
     NSLog(@"Name: %@", [info valueForKey:@"userId"]);

} 
```

这里没有问题。但是在我关闭我的应用程序并将 setvalue 修改为 2 后，我只收到最后一个数据，即 2。之前的数据 (1) 被删除。

即使在我关闭我的应用程序后，我应该怎么做才能保留数据条目。

谢谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:53:36.750

您需要创建一个`UIManagedDocument`来保存Core Data 信息。我通常创建`UIManagedDocument`作为类的属性。例如，我创建了一个`UIManagedDocument`名为`theManagedDocument`：

```
NSURL *url = [[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask] lastObject];
url = [url URLByAppendingPathComponent:@"DocumentName"];

self.theManagedDocument = [[UIManagedDocument alloc] initWithFileURL:url];

if([[NSFileManager defaultManager] fileExistsAtPath:[url path]])
{
    [theManagedDocument openWithCompletionHandler:^(BOOL success){
        if(success) [self documentIsReady];
        if(!success) NSLog(@"Couldn't Open Document");
    }];
}
else 
{
    [theManagedDocument saveToURL:url forSaveOperation:UIDocumentSaveForCreating completionHandler:^(BOOL success){
        if(success) [self documentIsReady];
        if(!success) NSLog(@"Couldn't Create Document");
    }];
} 
```

然后我创建了一个方法`documentIsReady`，当文档被成功创建或打开时调用（如果它已经存在则打开，否则创建）。我还将上下文作为属性。这里称为`context`。我还在您的代码中添加了：

```
- (void) documentIsReady
{
    if(self.theManagedDocument.documentState == UIDocumentStateNormal) 
    {
        self.context = self.theManagedDocument.managedObjectContext;
        NSError *error;

        NSManagedObject *failedBankInfo = [NSEntityDescription
                               insertNewObjectForEntityForName:@"UserData"
                               inManagedObjectContext:self.context];
        [failedBankInfo setValue:[NSNumber numberWithInt:1] forKey:@"userId"];

        NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
        NSEntityDescription *entity = [NSEntityDescription
                           entityForName:@"UserData" inManagedObjectContext:self.context];
        [fetchRequest setEntity:entity];
        NSArray *fetchedObjects = [self.context executeFetchRequest:fetchRequest error:&error];
        for (NSManagedObject *info in fetchedObjects) {
            NSLog(@"Name: %@", [info valueForKey:@"userId"]);
        }
    }
} 
```

然后，您将需要在完成使用后关闭文档：

```
[self.theManagedDocument closeWithCompletionHandler:^(BOOL success){
    if(success) NSLog(@"Closed Successfully");
    if(!success) NSLog(@"Error Closing Document");
}]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T07:37:53.777

您没有保存新记录。

```
[self.managedObjectContext save:nil]; 
```

# bash - 变量中进程替换的 Bash 问题

> ID：11441821
> 
> 赞同：0
> 
> 时间：2012-07-11T21:32:09.963
> 
> 标签：bash, process, substitution

我正在尝试在将“if”设置为变量的 bash 脚本中获取 dd 命令。变量可能是 /dev/zero 或者可能像 <(yes $'\01' | tr -d "\n") 一样复杂

我似乎可以让后者工作。

```
write_file=/dev/zero
dd if=$write_file bs=2048 seek=1 of=/dev/sda count=524288 
```

这样可行。

```
write_file="<(yes $'\01' | tr -d "\n")"
dd if=$write_file bs=2048 seek=1 of=/dev/sda count=524288 
```

这行不通。我得到一个

```
dd: invalid option -- 'd'
Try `dd --help' for more information. 
```

但是如果我做一个直

```
dd if=<(yes $'\01' | tr -d "\n") bs=2048 seek=1 of=/dev/sda count=524288 
```

在脚本中它工作正常。

我确定需要进行一些转义，但我离 bash 专家还很远，无法弄清楚如何做到这一点！

更新：尝试以下建议

```
write_file="<(yes $'\01' | tr -d \"\n\")"
dd if="$write_file" bs=2048 seek=1 of=/dev/sda count=524288 
```

并得到

```
dd: opening `<(yes $\'\\01\' | tr -d "\\n")': No such file or directory 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T15:49:43.123

Bash 不会解析你的变量的内容并直接将它传递给 dd，它不知道如何处理它。您可以强制 Bash 使用“eval”解析变量：

```
 write_file="<(yes $'\01' | tr -d \"\n\")"
 command="dd if=$write_file bs=2048 seek=1 of=/dev/sda count=524288"
 eval "${command}" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T18:40:31.950

好的..我想我需要在 dd 前面添加一个“eval”。

所以：

```
write_file="<(yes $'\x5a' | tr -d \"\n\")"
eval dd if=$write_file bs=2048 seek=1 of=/dev/sda count=5242 
```

作品！我猜它在进行变量替换或类似的事情后会重新解析。

我从[这里得到了提示](http://fvue.nl/wiki/Bash%3a_Why_use_eval_with_variable_expansion?)

有趣的是我`eval`昨天尝试使用但我无法让它工作。我一定是在某处遗漏了一些引用或转义..

# mysql - 何时在 mysql 中使用 TEXT 而不是 VARCHAR

> ID：11441823
> 
> 赞同：48
> 
> 时间：2012-07-11T21:32:19.620
> 
> 标签：mysql

> **可能重复：**
> [MySQL：大 VARCHAR 与 TEXT？](https://stackoverflow.com/questions/2023481/mysql-large-varchar-vs-text)

既然`VARCHAR`现在可以有 65k 字节，那么什么时候应该`TEXT`使用 then 而不是`VARCHAR`?

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-07-11T22:26:06.627

long`VARCHAR`的存储方式与`TEXT`/`BLOB`中的字段相同`InnoDB`。

> Innodb 以相同的方式处理存储预期的 BLOB、TEXT 以及 long VARCHAR。这就是 Innodb 手册将其称为“长列”而不是 BLOB 的原因。

[来源](http://www.mysqlperformanceblog.com/2010/02/09/blob-storage-in-innodb/)

除非您需要索引这些列（在这种情况下`VARCHAR`要快得多），否则没有理由对长字段使用`VARCHAR`over `TEXT`- 有一些引擎特定的优化`MySQL`可以根据长度调整数据检索，您应该使用正确的列类型利用这些。

如果您正在使用`MyISAM`关于该主题的深入讨论，请[点击此处](http://nicj.net/2011/01/20/mysql-text-vs-varchar-performance)。

* * *

`TEXT`并且`BLOB`存储在表外，表中只有一个指向实际存储位置的指针。

`VARCHAR`与表内联存储。`VARCHAR`大小合理时速度更快。

根据[这个测试](http://forums.mysql.com/read.php?24,105964,105964)，`VARCHAR`大约是文本的三倍。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-11T21:34:08.557

文本应该用于非常长的不确定长度的字符串。此外，返回 TEXT 字段的查询往往比对应的 VARCHAR 慢得多。

# matlab - 从数据源中随机选择

> ID：11441829
> 
> 赞同：0
> 
> 时间：2012-07-11T21:32:53.287
> 
> 标签：matlab, dataset

> **可能重复：**
> [随机 m×n 矩阵的 randperm 子集](https://stackoverflow.com/questions/7781542/randperm-subset-of-random-m-by-n-matrix)

当尝试从数据集“fulldata”中随机选择 1000 行时出现错误，我不太确定它在 matlab 中是如何完成的，但这是我尝试过的：

```
data = datasample(fulldata,6,1000) 
```

完整数据为 490256x6，我想从该数据中选择 1000 个随机行。在matlab中它抛出错误

```
??? Undefined function or method 'datasample' for input arguments
of type 'double'.

Error in ==> randomselection at 44
data = datasample(fulldata,6,1000) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T22:52:18.693

您可以改为使用这样的方法来获取它，而无需依赖 datasample：

```
pointsToPick = 1000;  %# Numbers to pick
rVec = randperm(N);   %# Random permutation of datapoint indices (N=490256 in your case)  

randomSample = fulldata(rVec(1:pointsToPick),:); %# Random sample 
```

# django - request.is_secure() 对于 uwsgi 服务器总是返回 false

> ID：11441832
> 
> 赞同：6
> 
> 时间：2012-07-11T21:32:59.270
> 
> 标签：django, https, nginx, uwsgi

我们为基于 Django 的应用程序使用 Ngnix + uWSGI 设置。

我们的问题是，即使我们在 https 上提供内容，它也`request.is_secure()`总是返回**false 。**

uWSGI文档中提到过，我`uwsgi_param UWSGI_SCHEME $scheme`在nginx配置或者uwsgi_params中设置了，但是没有用。

我们还为同一应用程序提供了基于 Nginx + apache 的设置，它工作得很好。

任何帮助将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-12T11:50:51.537

问题解决了 ！！

我们尝试了几件事来修复它，但无法让它工作。关于我们稍后分析的问题，我将在这里提供更多信息。我们当前在 webfaction 上的设置如下所示：

WebFaction Nginx -> 我们的 nginix -> uwsgi 服务器

我们发现 webfaction nginx 的配置存在一些问题，它正在通过 http 协议本身将（https 和 http）的所有流量传递给我们的 nginx。因此，首先我们更改了此设置以将正确的流量传递给正确的服务器。

还是我们发现两个 nginx 服务器设置的 $scheme 都不正确，所以我们最后做的是在我们的 nginx 中设置以下内容进行 https 配置：

```
uwsgi_param UWSGI_SCHEME https; 
```

这解决了现在的问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-04-27T14:38:08.703

对于`gunicorn`服务器固定：

将此行添加到`nginx.conf`文件中：

```
proxy_set_header        X-Forwarded-Proto           $scheme; 
```

并将这一行添加到`settings.py`文件中：

```
SECURE_PROXY_SSL_HEADER = ('HTTP_X_FORWARDED_PROTO', 'https') 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-01-19T10:13:09.333

我花了半天的时间来解决这个问题，所以让每个人都头疼

首先，

放

```
uwsgi_param   HTTP_X_FORWARDED_PROTO    $scheme; 
```

在 nginx.conf

然后将此行放入 settings.py

```
SECURE_PROXY_SSL_HEADER = ('HTTP_X_FORWARDED_PROTO', 'https') 
```

如果您使用的是 Django<1.4，您还需要启用`django-secure`中间件

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-12-06T17:54:08.700

我建议使用`request.scheme`而不是`request.is_secure()`检查我们当前是否使用`https`协议。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-12T03:50:05.360

is nginx the https terminator or you have some other server before it ?

In such a case the $scheme variable in nginx will always map to 'http'. You have to manually set it to 'https'

uwsgi_param UWSGI_SCHEME https;

# salesforce - 为什么我的页面块表底部没有呈现？

> ID：11441833
> 
> 赞同：0
> 
> 时间：2012-07-11T21:32:59.573
> 
> 标签：salesforce, visualforce

我的桌子底部被切断了，我不知道为什么。它是嵌入在页面布局中各部分之间的 VF 页面。

有什么想法/建议吗？

这是代码。

```
<apex:pageBlock title="Support Tickets">
  <apex:pageBlockTable value="{!Cases}" var="c">
  <apex:column >
    <apex:facet name="header">Support Ticket</apex:facet>
     <apex:outputLink value="/{!c.id}">{!c.caseNumber}</apex:outputLink>
  </apex:column>

  <apex:column >
     <apex:facet name="header">Subject</apex:facet>
     <apex:outputLink value="/{!c.id}">{!c.subject}</apex:outputLink>
  </apex:column>

  <apex:column >
     <apex:facet name="header">Created Date</apex:facet>{!c.createdDate}
  </apex:column>

 <apex:column >
   <apex:facet name="header">Status</apex:facet>{!c.Status}
 </apex:column>        
</apex:pageBlockTable>        
</apex:pageBlock>
</apex:form>
</apex:page> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T22:46:28.867

这个限制很可能是页面布局的实际高度。这可以在页面布局配置中更改，而不是在代码中。您的页面位于 IFrame 中，该 IFrame 具有由页面布局本身控制的固定大小，而不是由其中包含的页面决定。

转到：名称|设置|自定义|案例（假设您正在扩展案例对象）|页面布局|编辑。单击 Visualforce 页面以显示您的自定义页面，然后单击右上角的扳手。

![VF 页面属性](../Images/9a421226e3c58cb52f2eebcea7137bdd.png)

如果您没有看到此内容或无法访问 Salesforce 的此部分，请与您的管理员联系以获得访问权限。

# android - 如何将焦点放在特定的 EditText 上并显示软键？

> ID：11441837
> 
> 赞同：0
> 
> 时间：2012-07-11T21:33:09.747
> 
> 标签：android, android-layout

当一个活动打开时，我需要将焦点设置在两个编辑文本之一上并自动打开软键盘，这样用户就可以开始打字了。如何才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:36:40.407

在布局的 xml 中，`<requestFocus />`在您想要聚焦的 EditText 下添加。

# browser - 让 UTF-8 文本文件显示在所有浏览器上

> ID：11441847
> 
> 赞同：5
> 
> 时间：2012-07-11T21:33:35.033
> 
> 标签：browser, utf-8, apache2

我想要我的网页

```
http://www.gmarks.org/math_in_e-mail.txt 
```

在我的 Apache 2.2.14 服务器上正确显示在所有平台上的所有浏览器中（或接近此的东西）。我已经包括了这条线

```
AddDefaultCharset utf-8 
```

在适当的 .htaccess 文件中。然而，我发现，在我自己的机器上，运行 Ubuntu 10.04，页面显示与我想要的完全一样，只是在谷歌 Chrome 浏览器中。其他浏览器中的问题：在 Opera 中，最后两行不显示，在 Firefox 中，下标*aleph*太小，在 rekonq 中，最后两行显示不正确，各种 Fraktur 字符重复，其他不显示，在 Midori 中，Opera 和 Firefox问题都出现了，在 Arora 中，Firefox 和 rekonq 问题都出现了，在 Epiphany 中出现了 Opera 问题。

是否可以在我的 .htaccess 文件中放入其他内容，或者我可能设置的其他一些配置，以使该网页在任何地方都能正确显示？我想我必须依赖每个用户在他或她的计算机上安装的字体集（显然它违背了网页使用 GIF 图像之类的目的）。我发现浏览器之间的差异很奇怪：每个浏览器是否在某个配置文件中包含自己的一组字体，或者它们是否访问包含整个计算机字体的某个目录？（最后一个问题的答案是否取决于操作系统？）

进一步的问题：我会更好地将 .htaccess 文件中的行更改为

```
AddCharset UTF-8 .txt 
```

有没有一种方法可以使 .txt 文件默认显示为增加字体大小？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T21:28:57.443

浏览器不会知道文本是 UTF-8 编码的，除非文本以 UTF-8 BOM 开头（假设浏览器甚至会查找）或 HTTP`Content-Type`标头将 UTF-8 指定为字符集，即：`Content-Type: text/plain; charset=utf-8`。如果`AddCharset`告诉 Apache 为 .txt 文件生成该属性，那就太好了。

无法单独为 .txt 文件指定字体。您必须为此使用 HTML。要为 .txt 文件指定字体，您必须编写一个服务器端脚本，该脚本输出围绕 .txt 文件内容的 HTML 包装器，然后将 HTTP`Content-Type`标头设置为指定`text/html`而不是`text/plain`数据类型。

# jquery - li 后的 Jquery 位置分隔符

> ID：11441862
> 
> 赞同：1
> 
> 时间：2012-07-11T21:35:27.420
> 
> 标签：jquery, menu

所以我有这个菜单。

```
<div class="menu">
<ul>
<li class="page_item page-item-23 current_page_item">
<a href="http://localhost/irises/">Forside</a></li>
<li class="page_item page-item-26">
<a href="http://localhost/irises/?page_id=26">Produkter</a>
<ul class='children'>
<li class="page_item page-item-83">
<a href="http://localhost/irises/?page_id=83">Produkt 1</a>
</li>
<li class="page_item page-item-203">
<a href="http://localhost/irises/?page_id=203">Produkt 2</a>
</li>
</ul>
</li>
<li class="page_item page-item-41">
<a href="http://localhost/irises/?page_id=41">Kursuskalender</a>
</li>
<li class="page_item page-item-2">
<a href="http://localhost/irises/?page_id=2">Nyheder</a>
</li>
<li class="page_item page-item-16"><a href="http://localhost/irises/?page_id=16">IRIS Enterprise Solutions</a></li>
<li class="page_item page-item-62">
<a href="http://localhost/irises/?page_id=62">Kontakt</a>
</li>
</ul>
</div> 
```

所以当我这样做时

```
$('.menu ul li').after('<li class="delimiter">|</li>'); 
```

我在每个主菜单点之后都有一个分隔符，但也在子菜单内。

```
<ul class='children'> 
```

如果我只想要主菜单点之间的分隔符，jquery 会怎样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T21:36:35.270

像这样指定特定的孩子：`$('.menu > ul > li').after('<li class="delimiter">|</li>');`

# android - 了解运行时使用的布局

> ID：11441864
> 
> 赞同：2
> 
> 时间：2012-07-11T21:35:37.997
> 
> 标签：android, layout

我有两个用于测试的安卓设备。一种是分辨率为 480x320，另一种是分辨率为 800x480。我在 layout-normal 和 layout 目录中定义了不同的布局。我还尝试了 layout-hdpi、layout-mdpi 等不同的组合。

有没有办法从某处的日志中知道设备属于哪个布局类别，仅用于调试目的。我想知道运行时使用哪个目录的布局文件。如果没有，那么有人可以告诉我具有上述分辨率的两个设备的布局目录的正确组合。

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-11T22:14:48.220

查找运行时使用的布局（来自`layout-ldpi`、`layout-mdpi`文件夹等）。您可以在布局中使用标签属性。例如，假设您为不同的屏幕定义了两种布局，一种在`layout-mdpi`文件夹中，另一种在文件`layout-hdpi`夹中。像这样的东西：

```
<?xml version="1.0" encoding="utf-8"?>
<!--Layout defined in layout-mdi folder-->
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/MainLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:tag="mdpi"
    android:orientation="horizontal" >

    <!-- View and layouts definition-->
<!LinearLayout> 
```

和：

```
<?xml version="1.0" encoding="utf-8"?>
<!--Corresponding Layout defined in layout-hdi folder-->
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/MainLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:tag="hdpi"
    android:orientation="horizontal" >

    <!-- View and layouts definition-->
<!LinearLayout> 
```

要检查运行时使用的布局，您可以使用以下内容：

```
LinearLayout linearLayout = (LinearLayout) findViewById(R.id.MainLayout);
if(linearLayout.getTag() != null) {

   String screen_density = (String) linearLayout.getTag();
}

if(screen_density.equalsIgnoreCase("mdpi") {
   //layout in layout-mdpi folder is used
} else if(screen_density.equalsIgnoreCase("hdpi") {
   //layout in layout-hdpi folder is used
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:27:00.823

这是@Angelo's answer的扩展，可能会根据您使用元素的方式起作用：在每个文件中，如果您有不需要操作的相同元素，则可以为您定义的每个布局赋予不同的 ID （而不是标记它）。

例如，假设我不需要操作基本线性布局，我只需要操作其中的视图。

这是我的 hdpi 布局：

```
<?xml version="1.0" encoding="utf-8"?>
<!--Corresponding Layout defined in layout-hdpi folder-->
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/layout-hdpi"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" >
    <!-- View and layouts definition-->
</LinearLayout> 
```

这是一个 mdpi 布局：

```
<?xml version="1.0" encoding="utf-8"?>
<!--Corresponding Layout defined in layout-mdpi folder-->
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/layout-mdpi"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" >
    <!-- View and layouts definition-->
</LinearLayout> 
```

这是我的代码，它决定了它的布局：

```
if ( findViewById(R.id.layout-hdpi) != null ) {
    //we are in hdpi layout
} else if ( findViewById(R.id.layout-mdpi) != null ) {
    //we are in mdpi layout
} 
```

这个想法是，您在不同文件中为该项目定义的 ID 中只有一个实际存在，并且无论哪个 ID 都在实际加载的布局中。需要注意的是，如果您以后确实需要操作该项目，则此方法会产生大量额外工作，并且可能并不理想。您不希望在诸如 EditText 之类的项目上使用此技术，因为您必须检查您所处的布局以决定使用哪个 id 来获取该编辑文本。

# json - ActionScript3 上的 JSON 错误

> ID：11441866
> 
> 赞同：0
> 
> 时间：2012-07-11T21:35:49.700
> 
> 标签：json, actionscript-3

我在 Flash 上有一个模拟移动应用程序的代码：

```
package  
{

import flash.display.Sprite;
import flash.events.MouseEvent;
import flash.events.*;
import flash.net.*;
import com.adobe.serialization.json.*;

public class ScreenCategories extends Sprite 
{

    private var lastButtonEndedY:int;
    private var categories:Array;
    private var dataUrl:String = "getCategories.php";

    // Change this to false to use local static data instead;
    private var useRemoteData:Boolean = true;

    // Constructor: Create an array of three categories
    public function ScreenCategories()
    {
        lastButtonEndedY = 35;

        if ( useRemoteData )
        {
            loadCategories();
        }
    }

    public function loadCategories():void
     {
        var request:URLRequest = new URLRequest(dataUrl);
        var loader:URLLoader = new URLLoader();
        loader.dataFormat = URLLoaderDataFormat.TEXT;
        loader.addEventListener(Event.COMPLETE, categoryLoad_complete);
        loader.load(request);
     }

     private function categoryLoad_complete(evt:Event):void
     {
        var jsonText:String = evt.target.data;

        //Deserialize JSON
        categories = JSON.decode(jsonText) as Array;   
    }

    private function initializeCategory():void
    {
        // for each "category" in our list (Array)...
        for (var count in categories)
        {
            // Create a button for each of the categories that exist in our Array
            var aCategory:BtnCategory = new BtnCategory(categories[count].category);

            // Add the BtnCategory to the stage
            aCategory.x = 0;
            aCategory.y = lastButtonEndedY;
            aCategory.name = categories[count].id; // give it a unique name!
            addChild(aCategory);

            lastButtonEndedY += (aCategory.getHeight() + 1);
        }

        addEventListener(MouseEvent.CLICK, mouseClicked);
    }

    public function mouseClicked(e:MouseEvent)
    {
        removeEventListener(MouseEvent.CLICK, mouseClicked);

        // trace the name of the button that was pressed, in this case - the category number!
        var btnPressed:int = parseInt(e.target.name);

        // if the category exists in the Array (ie. not undefined), then display that category!
        if (categories[btnPressed] != undefined)
        {
            displayCategory(btnPressed)
        }

        addEventListener(MouseEvent.CLICK, mouseClicked);
    }

    // We want to go forward to see the list of products in this category, call back to Main.as so make that happen.
    public function displayCategory(categoryId)
    {
        trace ("display product category:" + categoryId);
        var par:* = parent;
        par.displayCategory(categoryId);
    }

}

} 
```

但我收到以下错误：

```
**JSONParseError: Unexpected < encountered
    at com.adobe.serialization.json::JSONTokenizer/parseError()[/Users/rominamora/Documents/AOD/term 3/interactive design/assignment3/com/adobe/serialization/json/JSONTokenizer.as:704]
    at com.adobe.serialization.json::JSONTokenizer/getNextToken()[/Users/rominamora/Documents/AOD/term 3/interactive design/assignment3/com/adobe/serialization/json/JSONTokenizer.as:206]
    at com.adobe.serialization.json::JSONDecoder/nextToken()[/Users/rominamora/Documents/AOD/term 3/interactive design/assignment3/com/adobe/serialization/json/JSONDecoder.as:102]
    at com.adobe.serialization.json::JSONDecoder()[/Users/rominamora/Documents/AOD/term 3/interactive design/assignment3/com/adobe/serialization/json/JSONDecoder.as:71]
    at com.adobe.serialization.json::JSON$/decode()[/Users/rominamora/Documents/AOD/term 3/interactive design/assignment3/com/adobe/serialization/json/JSON.as:95]
    at ScreenCategories/categoryLoad_complete()[/Users/rominamora/Documents/AOD/term 3/interactive design/assignment3/ScreenCategories.as:45]
    at flash.events::EventDispatcher/dispatchEventFunction()
    at flash.events::EventDispatcher/dispatchEvent()
    at flash.net::URLLoader/onComplete()** 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:45:07.557

您可能从 getCategories.php 收到无效的 JSON。

尝试在浏览器中运行 getCategories.php 脚本（通过在地址栏中粘贴（完整）URL）并将获得的 JSON 复制到[jsonlint](http://jsonlint.com/)验证器中。这应该让您对任何无效的事情有所了解。

有关有效 JSON 的定义，请查看[json.org](http://www.json.org/)

# android - 如何在通话记录中检测未知电话号码（Android 提供商）

> ID：11441877
> 
> 赞同：1
> 
> 时间：2012-07-11T21:36:32.123
> 
> 标签：android, android-contentprovider, calllog

我想检测我的通话记录列表中的未知电话号码。

电话上的未知号码是`-1`或`-2`。

我的问题是*如何检测这种类型的呼叫*？

我尝试检测：

```
number = Integer.parseInt(number);
if(number < 0){

} 
```

但它不工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:30:18.627

尝试以下操作：

1）记录一切。

放

```
 Log.debug("ClassName", "number = " +number); 
```

2) number = Integer.parseInt(number); 看起来不太对劲。尝试

假设incomingPhoneNumber 被定义为一个字符串。

```
 String incomingPhoneNumber;

   try{

     int phoneNumber = Integer.parseInt(incomingPhoneNumber);

    }catch (Exception e) {
      Log.debug("ClassName", "error = "+e.getMessage());
      } 
```

在 Eclipse 中，您需要转到窗口 --> 显示视图 --> Logcat 并检查日志消息，但您还应该设置断点并在调试模式下运行。一次走一条线。

告诉我们您是否收到来电的负数。

3）在最开始放置断点并在调试模式下运行。告诉我们你得到了什么。

4）与用户的问题进行沟通。人们正在努力提供帮助，但您需要回答我们的问题，我们才能为您提供帮助。例如，我们确实需要查看 number 的定义才能知道代码是否可以工作。

# javascript - HTML5 Canvas：如何在画布上有图像和形状，并且形状是 Drag n Droppable？

> ID：11441879
> 
> 赞同：1
> 
> 时间：2012-07-11T21:36:39.733
> 
> 标签：javascript, html, html5-canvas

我在创建 HTML5 画布时遇到问题，其中存在图像，存在形状，并且形状可在同一舞台上拖动。我的直觉告诉我，我需要创建多个图层或多个阶段/画布。然后让一个是常规的，另一个是动力学的。我找到了一些可拖动形状的代码，显示图像和形状的代码，我认为我的问题只在于语法的实现。这是代码：

```
<!DOCTYPE HTML>
<html>
  <head>
    <style>
      body {
        margin: 0px;
        padding: 0px;
      }
      canvas {
        border: 1px solid #9C9898;
      }
    </style>
    <script src="http://www.html5canvastutorials.com/libraries/kinetic-v3.10.0.js"></script>
    <script>
      window.onload = function() {
        var stage = new Kinetic.Stage({
          container: "container",
          width: 578,
          height: 200

        var layer = new Kinetic.Layer();
        var rectX = stage.getWidth() / 2 - 50;
        var rectY = stage.getHeight() / 2 - 25;

        var box = new Kinetic.Rect({
          x: rectX,
          y: rectY,
          width: 100,
          height: 50,
          fill: "#00D2FF",
          stroke: "black",
          strokeWidth: 4,
          draggable: true
        });

        var layer1 = new Kinetic.Layer();

        var imageObj = new Image();
        imageObj.onload = function() {
          var image = new Kinetic.Image({
            x: stage.getWidth() / 2 - 53,
            y: stage.getHeight() / 2 - 59,
            image: imageObj,
            width: 106,
            height: 118
          });

          layer1.add(image);
          stage.add(layer1);

        // add cursor styling
        box.on("mouseover", function() {
          document.body.style.cursor = "pointer";
        });
        box.on("mouseout", function() {
          document.body.style.cursor = "default";
        });

        layer.add(box);
        stage.add(layer);

        imageObj.src = "http://www.html5canvastutorials.com/demos/assets/yoda.jpg";
      };

    </script>
  </head>
  <body onmousedown="return false;">
    <div id="container"></div>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T23:22:46.877

试试这个网站：[w3shools.com/html5/html5_draganddrop.asp](http://www.w3schools.com/html5/html5_draganddrop.asp)

# postgis - postgis st_geomfromgml，我的观点有什么问题？

> ID：11441885
> 
> 赞同：2
> 
> 时间：2012-07-11T21:37:02.923
> 
> 标签：postgis, gml

在 PostGIS 2.0 中，我尝试：

```
select ST_GeomFromGML(
  '<gml:Point srsName="urn:ogc:def:crs:EPSG::28992">
       <gml:pos>275466.0 565559.0 0.0</gml:pos>
   </gml:Point>'); 
```

这给出了一个错误：

```
********** Error **********

ERROR: invalid GML representation
SQL state: XX000
Context: SQL function "st_geomfromgml" statement 1 
```

我的观点有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T03:46:47.660

看起来解析器假设一个 2D 几何，当你实际上有一个 3D 几何时，即使你可能没有使用 Z 维度，除非你的点在海平面上（它是 0.0）。如果你明确声明维度属性，你会得到正确的结果：

```
SELECT ST_AsText(ST_GeomFromGML(
  '<gml:Point srsName="urn:ogc:def:crs:EPSG::28992">
       <gml:pos dimension="3">275466.0 565559.0 0.0</gml:pos>
   </gml:Point>'));

         st_astext
---------------------------
 POINT Z (275466 565559 0)
(1 row) 
```

# sockets - 使用 Winsock 发送/接收 HMODULE

> ID：11441887
> 
> 赞同：0
> 
> 时间：2012-07-11T21:37:09.460
> 
> 标签：sockets, tcp, winsock, receiver

我正在处理一个 C++ 项目，其中两个进程（在同一台机器上运行）使用 WinSock 通过 TCP 相互通信。进程“A”加载了几个必须由进程“B”使用的 Dll。

但是，在这种情况下，我无法理解如何使用 send/recv 方法来发送和接收 HMODULE。是否可以？如果是这样，正确的方法是什么。（我一直在尝试以下方法）：

过程一：

```
 HMODULE hmod = LoadLibrary(L"MathFunc.dll");
        iResult = send( Socket, (char*)hmod, sizeof(HMODULE), 0 ); 
```

过程乙：

```
typedef double (* addFunc)(double, double);

int __cdecl main(void) 
{
...
HMODULE receiver;
iResult = recv(ClientSocket, (char*)&receiver, sizeof(HMODULE), 0);
addFunc adder = (addFunc)GetProcAddress(receiver, "Add");
double resi = adder(1.0, 2.0);
...
return 0;
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T23:56:28.343

> 进程“A”加载了几个必须由进程“B”使用的 Dll。

这已经是不可能的了，更不用说发送 HMODULES 了。进程必须加载自己的 DLL。

# .htaccess - github 提交挂钩 url 的 htacces

> ID：11441888
> 
> 赞同：0
> 
> 时间：2012-07-11T21:37:14.563
> 
> 标签：.htaccess, github

我正在尝试使用 github 的提交挂钩 url。

我已经通过我试图隐藏的目录中的 htaccess 文件将 url 添加到我试图隐藏的文件夹中，除了 git hub 之外的所有人。

```
order deny,allow
deny from all
allow from 50.57.128.197, sh2.rs.github.com, 108.171.174.178, sh3.rs.github.com 
```

在我的服务器上，我有以下错误：

```
[error] [client 188.220.202.221] client denied by server configuration: xxx 
```

有没有想过我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T09:13:12.647

所以我将 github 的提交 url 指向一个触发 git pull 请求的 php 文件。

超级简单，效果很好。

# hudson - 如何使用 Nexus 和 Jenkins 实现持续部署

> ID：11441889
> 
> 赞同：1
> 
> 时间：2012-07-11T21:37:18.223
> 
> 标签：hudson, jenkins, nexus, continuous-deployment

我正在尝试实现一个持续部署系统，但我似乎无法为我们的问题找到一个好的答案。我们使用 Jenkins 运行 maven 构建来生成我们的工件并将它们部署到 Nexus。我看到一些项目将所有内容捆绑到单个 war 或 tar 文件中，按名称从 Nexus 中提取每个请求的一个文件并将其部署到应用程序服务器，但这需要他们事先知道他们有哪些版本可用。我的项目有很多 jars/wars/binaries 以及其他工件，它们没有使用应用程序服务器进行部署。我们想要做的是能够从nexus 中提取软件的任何快照或发布版本，并生成安装包或将其直接传送到远程服务器。

澄清：我希望 QA 或开发能够从 Jenkins 中选择一个版本；Jenkins 将在其中轮询 Nexus 以获取可用版本，然后从 Nexus 自动部署到服务器。

是否有一种简单的联系/行家方式将软件输出到测试系统？

那么，有没有办法通过 ant/ivy、Jenkins、maven、gradle 轮询 nexus 以确定哪些修订可用？如果有帮助我会写点别的。

我看到这里问了一个类似的问题：[How do I choose an artifact from Nexus in a Hudson / Jenkins job?](https://stackoverflow.com/questions/7737634/how-do-i-choose-an-artifact-from-nexus-in-a-hudson-jenkins-job) ，但 9 个月后仍未得到答复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:46:43.577

Nexus 为您提供标准的 HTTP 浏览功能。您可以通过 HTTP 浏览存储库并查看可用的内容。

我仍然不明白你的用例。如果你知道你想要哪个版本的项目，那么问题是什么？

最简单的方法是编写一个安装程序 pom.xml，其中包含一个 ${} 占位符，用于表示您想要的工件版本，然后调用 mvn`mvn package -Dproduct.version=1.0.0`

如果您使用容器，PAX 的插件允许您访问特定的工件，例如 mvn:myGroup/myArtifact/myVersion，它会自动从 Maven 中提取。

Nexus 没有做任何魔术。这是组/artifactId/versions 的 URL 上的所有众所周知的路径

# shell - 没有 -v 选项的 awk 中的 shell 变量正在工作

> ID：11441895
> 
> 赞同：0
> 
> 时间：2012-07-11T21:37:54.530
> 
> 标签：shell, awk, grep

我注意到可以在 awk 脚本中使用 shell 脚本变量，如下所示：

```
var="help"
awk 'BEGIN{print "'$var'" }' 
```

谁能告诉我如何更改`var`内部 awk 的值，同时保留 awk 外部的值？

类似于在 awk 中访问 shell 脚本的变量，我们可以在 awk 中访问 shell 数组吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:41:15.623

是不可能的; 您拥有的唯一变体：

*   使用命令替换并将输出写入`awk`变量；
*   将数据写入文件，然后从外壳读取；
*   产生 shell 输出，然后用`eval`.

例子。

命令替换，一个变量：

```
$ export A=10
$ A=$(awk 'END {print 2*ENVIRON["A"]}' < /dev/null)
$ echo $A
20 
```

在这里，您将 A 乘以 2 并将乘法的结果写回。

`eval`; 两个变量：

```
$ A=10
$ B=10
$ eval $(awk 'END {print "A="2*ENVIRON["A"]"; B="2*ENVIRON["B"]}' < /dev/null)
$ echo $A
20
$ echo $B
20
$ awk 'END {print "A="2*ENVIRON["A"]"; B="2*ENVIRON["B"]}' < /dev/null
A=40; B=40 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T22:00:59.350

它使用文件中介，但它确实有效：

```
var="hello world"
cat > /tmp/my_script.awk.$$ <<EOF
BEGIN { print \"$var\" }
EOF
awk /tmp/my_script.awk.$$
rm -f /tmp/my_script.awk.$$ 
```

这使用了`here document`shell 的特性，查看你的 shell 手册，了解有关此处文档中插值的规则。

# ant - 使用 Ant 在子目录中运行 PigUnit

> ID：11441899
> 
> 赞同：0
> 
> 时间：2012-07-11T21:38:05.840
> 
> 标签：ant, junit, hadoop, apache-pig, filenotfoundexception

我的问题是通过 ant 从父目录运行 PigUnit。

我直接从[PigUnit](http://pig.apache.org/docs/r0.8.1/pigunit.html)站点使用 PigUnit 示例。

我正在使用的 ant 脚本在这里：

```
 <junit printsummary="on" fork="true" haltonfailure="yes">
        <jvmarg value="-Duser.dir=${basedir}"/>

        <classpath refid="junit.class.path" />
        <formatter type="xml" />
        <batchtest todir="${test.report.dir}">
            <fileset dir="${test.dir}">
                <include name="**/*Test*.java" />
            </fileset>
        </batchtest>
    </junit>
</target> 
```

如果我在项目的工作目录中运行 ant，这个脚本工作得非常好。但是，当我在 Pig 项目的父目录中的 ant 构建脚本中使用这行代码远程调用脚本时

```
 <ant dir="${pig.dir}" target="main" inheritall="false" antfile="build.xml"/> 
```

我得到一个 FileNotFoundException：

`java.io.FileNotFoundException">java.io.FileNotFoundException: top_queries.pig (No such file or directory) at java.io.FileInputStream.open(Native Method) at java.io.FileInputStream.<init>(FileInputStream.java:138) at org.apache.pig.pigunit.PigTest.readFile(PigTest.java:273) at org.apache.pig.pigunit.PigTest.readFile(PigTest.java:269) at org.apache.pig.pigunit.PigTest.<init>(PigTest.java:92) at TopQueriesTest.testTop2Queries(Unknown Source)`

如果我从父目录中的命令行运行 ant，也会发生同样的 FNF 异常： `ant -f PigJavaTest/build.xml junit`

我帮助 PigUnit 找到 top_queries.pig 文件以指定 top_queries.pig 文件相对于 Pig 项目父目录的位置的解决方法，例如

`PigTest test = new PigTest("PigTestJava/top_queries.pig", args);`

但这不是最优的，因为当从与父目录不同的目录运行 ant 时它会中断。

其他 JUnit 测试将从父目录正常运行，但 PigUnit 总是抛出相同的 FNF 异常。我还尝试使用 PigServer 进行简单测试（加载/转储文件），并且 PigServer 测试的行为就像 PigUnit 一样。

为什么从父目录调用 ant 时会抛出这个 FileNotFoundException，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T10:37:37.737

你有一个猪文件的相对路径。因此，如果您从项目的工作目录调用 ant 脚本，它应该可以工作。当您从父项目调用 ant 脚本时，相对路径现在是相对于父目录的。

*   [http://ant.apache.org/manual/Tasks/ant.html](http://ant.apache.org/manual/Tasks/ant.html)

当您在此处调用 ant 任务时，您正确设置了 dir 属性，但这只会更改脚本中后续的 ${basedir} 属性的值，而不是 junit 任务运行时的实际工作目录。

我建议你在你的 junit 任务中使用 dir 属性来硬设置工作目录（我猜这就是你试图用 jvmarg 选项做的事情）：

```
<junit printsummary="on" fork="true" haltonfailure="yes" dir="${basedir}">
    <jvmarg value="-Duser.dir=${basedir}"/>

    <classpath refid="junit.class.path" />
    <formatter type="xml" />
    <batchtest todir="${test.report.dir}">
        <fileset dir="${test.dir}">
            <include name="**/*Test*.java" />
        </fileset>
    </batchtest>
</junit> 
```

有关详细信息，请参阅[http://ant.apache.org/manual/Tasks/junit.html](http://ant.apache.org/manual/Tasks/junit.html)

# c# - 使用扩展方法“编程到接口”：什么时候走得太远了？

> ID：11441905
> 
> 赞同：7
> 
> 时间：2012-07-11T21:38:45.607
> 
> 标签：c#, interface, extension-methods, api-design

**背景：**本着[“编程到接口，而不是实现”](http://pragmaticjava.blogspot.ch/2008/08/program-to-interface-not-implementation.html)和[Haskell 类型类](http://www.haskell.org/tutorial/classes.html)的精神，作为一个编码实验，我正在思考创建一个主要基于接口和扩展组合的 API 意味着什么方法。我有两个指导方针：

1.  尽可能避免类继承。接口应该实现为`sealed class`es。
    [（这有两个原因：首先，因为子类化引发了一些令人讨厌的问题，即如何在其派生类中指定和执行基类的契约。其次，这就是 Haskell 类型类的影响，多态性不需要子类化。）]

2.  尽可能避免使用实例方法。如果可以使用扩展方法完成，则首选这些方法。
    [（这旨在帮助保持接口紧凑：可以通过组合其他实例方法完成的所有操作都成为扩展方法。接口中保留的是核心功能，尤其是状态更改方法。）]

**问题：**我对第二条指南有疑问。考虑一下：

```
interface IApple { }
static void Eat(this IApple apple)
{
    Console.WriteLine("Yummy, that was good!");
}

interface IRottenApple : IApple { }
static void Eat(this IRottenApple apple)
{
    Console.WriteLine("Eat it yourself, you disgusting human, you!");
}

sealed class RottenApple : IRottenApple { }
IApple apple = new RottenApple();
// API user might expect virtual dispatch to happen (as usual) when 'Eat' is called:
apple.Eat(); // ==> "Yummy, that was good!" 
```

显然，对于预期的结果（`"Eat it yourself…"`），`Eat`应该是一个常规的实例方法。

**问题：**关于使用扩展方法与（虚拟）实例方法的改进/更准确的指导方针是什么？什么时候使用扩展方法来“编程到接口”走得太远了？在什么情况下实际需要实例方法？

我不知道是否有*任何*明确的一般规则，所以我不期待一个完美的、普遍的答案。对上述准则 (2) 的任何有充分理由的改进都值得赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T22:00:19.863

您的指导方针已经足够好：它已经说“尽可能”。因此，任务实际上是在更多细节中拼出“尽可能”位。

我使用这种简单的二分法：如果添加方法的目的是隐藏子类之间的差异，则使用扩展方法；如果目的是突出差异，请使用虚拟方法。

您`Eat`的方法是引入子类之间差异的方法的示例：吃（或不吃）苹果的过程取决于它是哪种苹果。因此，您应该将其实现为实例方法。

尝试隐藏差异的方法示例如下`ThrowAway`：

```
public static void ThrowAway(this IApple apple) {
    var theBin = RecycleBins.FindCompostBin();
    if (theBin != null) {
        theBin.Accept(apple);
        return;
    }
    apple.CutUp();
    RecycleBins.FindGarbage().Accept(apple);
} 
```

如果扔掉苹果的过程是相同的，不管苹果的种类如何，那么该操作是在扩展方法中实现的主要候选者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T22:09:06.123

对我来说，预期的输出是正确的。您将变量类型转换为（可能使用错误）作为 IApple。

例如：

```
IApple apple = new RottenApple();
apple.Eat();  // "Yummy, that was good!"
IRottenApple apple2 = new RottenApple();
apple2.Eat(); // "Eat it yourself, you disgusting human, you!"
var apple3 = new RottenApple();
apple.Eat();  // "Eat it yourself, you disgusting human, you!" 
```

> 问题：关于使用扩展方法与（虚拟）实例方法的改进/更准确的指导方针是什么？什么时候使用扩展方法来“编程到接口”走得更远？在什么情况下实际需要实例方法？

在开发应用程序时只是我的个人意见：

当我编写我可能或其他人可能使用的东西时，我会使用实例方法。这是因为它是对实际类型的要求。`FlyingObject`考虑一个带有方法的接口/类`Fly()`。这是飞行物体的基本基本方法。创建扩展方法真的没有意义。

我使用（很多）扩展方法，但这些从来都不是使用它们扩展的类的要求。例如，我有`int`创建一个扩展方法`SqlParameter`（另外它是内部的）。将该方法作为 int 基类的一部分仍然没有任何意义，它实际上与 int 是什么或做什么无关。扩展方法在视觉上是创建使用类/结构的可重用方法的好方法。

# android - 安卓切换活动

> ID：11441908
> 
> 赞同：5
> 
> 时间：2012-07-11T21:39:20.383
> 
> 标签：android, android-intent, android-activity

我有 2 个活动。一个叫`Login`一个叫`ListDeals`。`Login`有一个带有提交按钮的表单，当按下该按钮时，应该将我们的活动切换到`ListDeals`. 这行得通。

但是，在 Logcat 中，我没有收到表明活动已开始的消息。此外，在 中`ListDeals`，如果用户按下后退按钮，这两个活动都应该被杀死。我环顾四周，这就是我想出的：

```
public class Login extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.login_screen);

    Button submit=(Button)findViewById(R.id.submit);
    submit.setOnClickListener(onSubmit);
}

private View.OnClickListener onSubmit=new View.OnClickListener() {

    @Override
    public void onClick(View view) {
        Intent myIntent=new Intent(view.getContext(),ListDeals.class );
        startActivityForResult(myIntent,0);

    }
};

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.login_screen, menu);
    return true;
}

@Override
public void onActivityResult(int requestCode,int resultCode, Intent data) {
    if(resultCode==2) {
        finish();
    } 
}

} 
```

* * *

```
public class ListDeals extends Activity {
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.deals_list);
        System.out.println("starting activity");
    }

    @Override
    protected void onDestroy() {
        System.out.println("dude");
        setResult(2);
        super.onDestroy();

    }

    protected void onStop(){
        setResult(2);
        super.onStop();

    }

} 
```

但是，当我按下后退按钮时，它会带我回到`Login`我不想要的活动。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T21:45:05.220

在您的点击处理程序中`onSubmit`，只需完成您的登录活动，就像这样。这样，它就不会出现在活动堆栈上，因此，从您的其他活动中按下将使用户回到他们开始的位置。

```
private View.OnClickListener onSubmit=new View.OnClickListener()
{
    @Override
    public void onClick(View view)
    {
        Intent myIntent=new Intent(view.getContext(),ListDeals.class);
        startActivity(myIntent);
        finish();
    }
}; 
```

此外，为了解决您的第二个问题，请使用[Log 类方法](http://developer.android.com/reference/android/util/Log.html)，例如`Log.i`或`Log.d`用于调试消息，这些方法将显示在 logcat 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T21:41:51.313

在开始新活动之前完成登录。此外，您不需要结果。

```
private View.OnClickListener onSubmit=new View.OnClickListener() {

    @Override
    public void onClick(View view) {
        Intent myIntent=new Intent(Login.this, ListDeals.class );
        startActivity(myIntent);
        Login.this.finish() // add this to finish it.

    }
}; 
```

# asp.net - 在两个站点之间共享 ASP.NET 登录的用户数据

> ID：11441909
> 
> 赞同：0
> 
> 时间：2012-07-11T21:39:20.777
> 
> 标签：asp.net, asp.net-membership

我需要以用户方式集成两个 ASP.NET 站点。我有一个允许用户登录的网页 ASP.NET 4 站点。它有一个自定义用户提供程序。现在，我编写了一个 ASP.NET MVC3 站点，该站点需要与 Web Pages 站点无缝协作，并且只允许来自 Web Pages 站点的用户提供程序的某些用户调用某些操作。作为最后的手段，MVC 站点可以访问 Web Pages 站点的用户数据存储。

PS 如果有必要，我可以将 ASP.NET MVC 站点配置为位于 IIS 中网页站点的子文件夹中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T22:10:59.167

要设置`FormsAuthentication`跨多个子域使用，请配置以下内容：

指定没有特定子域的 Authentication cookie 的域 - 允许浏览器从任何子域访问 Authentication 票证：

```
<!-- ... -->
<authentication mode="Forms">
    <forms loginUrl="/Index" domain="authtest.com"> ... </forms>
    <!-- ... -->
</authentication>
<!-- ... --> 
```

确保单独的应用程序使用*相同*的机器密钥，以便它们可以正确加密/解密身份验证票证：

```
<!-- ... -->
<system.web>    
    <machineKey validationKey=" ... 3D26FD5F940C2FD0AF8065F29A"
            decryptionKey=" ... 940CD33EBCE5065F2F2334D"
            validation="SHA1"  decryption="AES" />
    <!-- ... -->
</system.web>
<!-- ... --> 
```

其他一切都是标准的 ASP.Net 身份验证详细信息/配置。

# jquery - 使用 Zurb Foundation 的“Unreveal”模态

> ID：11441913
> 
> 赞同：8
> 
> 时间：2012-07-11T21:39:37.400
> 
> 标签：jquery, modal-dialog, zurb-foundation

我在一个网站上使用 Zurb Foundation，我试图让一个模式窗口与 Reveal JS 插件一起工作。我看到您可以`dismissModalClass`向传递给的参数添加一个选项，该选项`reveal()`会将事件处理程序附加到按钮等，这将在单击时关闭模式。

有没有办法用 Reveal 手动关闭模态窗口？我希望能够将关闭方法附加到不同的自定义事件。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-11T22:53:00.853

您可以通过执行以下操作在其他事件中简单地触发点击

```
$('.close-reveal-modal','#myModal').click() 
```

**更新**

查看插件的源代码后，看起来他们将一个事件绑定到名为`reveal:close`. 所以你也可以做这样的事情

```
$('.otherClose').click(function(){
    $('#myModal').trigger('reveal:close')
})​ 
```

**[这是一个小提琴](http://jsfiddle.net/BY7ZF/5/)**

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-08-03T09:35:40.373

您还可以使用以下内容：

```
$('#myModal').foundation('reveal', 'close'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T14:41:02.117

你可以使用他们的 jQuery 插件 jquery.foundation.reveal.js

```
 $('#mymModal').reveal({
        dismissmodalclass: 'close-reveal-modal' //class name of button to close open dialog
        }
    }); 
```

# javascript - How to calculate percentage of size change for window resize?

> ID：11441917
> 
> 赞同：2
> 
> 时间：2012-07-11T21:40:14.583
> 
> 标签：javascript, jquery, html, jquery-plugins, resize

I'm trying to calculate the percentage that the browser was resized but I can't seem to capture the size of the window before the resize began and then the size after it finishes.

```
$(function () {
    var originalHeight = $(window).height();
    $(window).resize(function (e) {
        var newHeight = $(window).height();
        var percentageChange = newHeight / originalHeight;
        $('body').html('old: ' + originalHeight + ' | new: ' + newHeight);
        originalHeight = newHeight;
    });
}); 
```

The two numbers (originalHeight and newHeight) always match for some reason. Is there something I can to to simulate two additional events such as `beginResize` or `endResize`? If I could do that then I could do this:

```
$(function () {
    var originalHeight;
    $(window).beginResize(function () {
        originalHeight = $(window).height();
    });
    $(window).endResize(function () {
        var newHeight = $(window).height();
        var percentageChange = newHeight / originalHeight;
        alert(percentageChange);
}); 
```

Any ideas?

## Update:

I was able to duplicate this locally in a blank environment, but not on jsfiddle. I can only conclude that the iframe environment on jsfiddle is interfering.

When I execute the following page:

```
<!DOCTYPE html>

<html>
<head>
    <title>Isolate</title>
    <script type="text/javascript" src="~/Scripts/jquery-1.7.2.js"></script>
    <script type="text/javascript">
        $(function () {
            var originalHeight = $(window).height();
            $(window).resize(function (e) {
                var newHeight = $(window).height();
                var percentageChange = newHeight / originalHeight;
                $('body').append('old: ' + originalHeight + ' | new: ' + newHeight + ' | percentage: ' + percentageChange + '<br />');
                originalHeight = newHeight;
            });
        });
    </script>
</head>
<body>
</body>
</html> 
```

I get the following results:

```
old: 417 | new: 418 | percentage: 1.0023980815347722
old: 418 | new: 418 | percentage: 1
old: 418 | new: 419 | percentage: 1.0023923444976077
old: 419 | new: 419 | percentage: 1
old: 419 | new: 420 | percentage: 1.0023866348448687
old: 420 | new: 420 | percentage: 1
old: 420 | new: 422 | percentage: 1.0047619047619047
old: 422 | new: 422 | percentage: 1
old: 422 | new: 423 | percentage: 1.0023696682464456
old: 423 | new: 423 | percentage: 1 
```

It seems that the resize event is running twice for every resize. First time it detects a difference between original and new, but second time the values are the same because the first run updates originalHeight to the newHeight.

You can see in [this fiddle](http://jsfiddle.net/8RzE3/3/) that this double event run problem does not occur. Each entry shows different values for old and new.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T22:37:00.217

这种行为完全是特定于浏览器的。它既不会出现在 Opera、Firefox 或 IE 中，也不会出现在 Chrome 中。

为了避免这种行为，您可以简单地检查最后一次更新是否发生在某个时间间隔内（例如最后 100 毫秒）（[小提琴](http://fiddle.jshell.net/8RzE3/6/)，在所有常见浏览器中测试）：

```
$(function () {
    var originalHeight = $(window).height();
    var originalHeightTime = new Date();
    $(window).resize(function (e) {
        var newTime = new Date();
        if (newTime - originalHeightTime < 100)
            return;
        var newHeight = $(window).height();
        var percentageChange = newHeight / originalHeight;
        $('body').html('old: ' + originalHeight + ' | new: ' + newHeight + ' | percentage: ' + percentageChange);
        originalHeight = newHeight;
        originalHeightTime = newTime;
    });
}); 
```

# asp.net - Precompiled views: can I still read the contents at runtime?

> ID：11441920
> 
> 赞同：4
> 
> 时间：2012-07-11T21:40:59.790
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3

I have my views setup to pre-compile, and therefore, at runtime if I were to try and read the view file (e.g. "~\Views\User\Report.cshtml") I'd get the following dummy-text, as opposed to the contents of my view:

> This is a marker file generated by the precompilation tool, and should not be deleted!

Problem is, I'd like to re-use the cshtml view, and rerender it another way at runtime, but I cannot due to the above restriction.

**The scenario:**

An admin can see a list of users in a /User/Report route. It outputs some HTML that has a list of all users, and their information in an HTML table. These admins frequently want to download this html file (styles and all) to email it as an attachment to someone else. They could, of course, go to File->Save in their browser, but I wanted to simplify that action by adding a link to the page "Download this report as HTML" that would simply return the same page's content, as a forced-downloaded HTML file (2012-07-11_UserReport.html).

So, what I tried to do was re-render the view by running the Report.cshtml file's contents through ASP.NET's File() method, like this:

```
var html = System.IO.File.ReadAllText(Server.MapPath(@"~\Views\User\Report.cshtml"));
var bytes = System.Text.Encoding.UTF8.GetBytes(html);

return File(bytes,"text/html",string.Format("{0}_UserReport.html",DateTime.Now.ToString("yyyy-MM-dd"))); 
```

But, like I mentioned earlier, the file comes back as the dummy-text, not the view, since I'm pre-compiling the views.

**I understand that to get around the pre-compilition, I could simply copy the Report.cshtml file, and rename it to Report.uncompiled (adding it to the csproj as of course) and read the contents of it, that's an ok solution, but not good enough.**

What I would really like to know is: Is there a way I can get at that pre-compiled content? I looked in the Assembly's embedded resources, and they are not there. Any ideas/suggestions?

**Updated with current solution**

So after searching around some more, and trying to use WebClient/WebRequest to just make a request to the route's URL and send the response back down to the user to download while at the same time trying to pass the user's .ASPXAUTH cookie (that made WebClient/WebRequest time out for some reason? I even tried to create a new ticket, same result) I ended up going with what I didn't want to do: duplicate the view file, and rename it so it's not precompiled.

The view file (Report.uncompiled) had to be modified a bit as it was, and then I ran it through [RazorEngine's](http://razorengine.codeplex.com/) Razor.Parse method and got what I needed, but it just felt hackey. Would still like a way to access the view file (Report.cshtml) even after it's compiled.

```
var templateHtml = Razor.Parse(System.IO.File.ReadAllText(Server.MapPath(@"~\Views\User\Report.uncompiled")),model);
var bytes        = System.Text.Encoding.UTF8.GetBytes(templateHtml);

return File(bytes, "text/html", string.Format("{0}_UserReport.html", DateTime.Now.ToString("yyyy-MM-dd"))); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:32:11.610

WebClient 类会起作用吗？

```
using System.Net;

using (WebClient client = new WebClient ()) 
{
    client.DownloadFile("http://yourwebsite.com/test.html", @"C:\directory.html");
    // If you just want access to the html, see below
    string html = client.DownloadString("http://yourwebsite.com/test.html");
} 
```

每当您的用户单击一个按钮时就触发此事件，然后它将页面的当前内容保存在哪里？您可能还可以有一个目录选择器，并将他们选择的任何内容输入第二个参数。

它本质上与浏览器保存的功能相同，如果这是您想要的。

# php - Sort SQL JOIN results in PHP arrays

> ID：11441923
> 
> 赞同：0
> 
> 时间：2012-07-11T21:41:09.773
> 
> 标签：php, mysql, join, multidimensional-array

I got 2 relational tables:

```
table "categories"
id int(11)
title varchar(255)

table "posts"
id int(11)
title varhcar(255)
category_id int(11) // foreign key 
```

If I select the "categories" table, I would like to get a PHP array with al the categories (as in "SELECT * categories") but including an inner array with all its posts:

```
Array (
    /* first category */
    [0] = Array (
        [id] => 1
        [title] => "Rock"
        /* all its posts */
        [posts] => Array (
            [0] = Array(
                [id] = 100
                [title] = "Rock post title"
                [category_id] = 1
            )
            [1] = Array(
                [id] = 101
                [title] = "Other rock post title"
                [category_id] = 1
            )
     )
    /* second category */
    [1] = Array (
    )
/* ... */
) 
```

If I just made a "join" query I get all the results combined, something like:

```
id     title    id    title               category_id
1      Rock     100   "Rock post title"   1
2      Rock     101   "Other rock post"   1
3      Rock     102   "Final rock post"   1 
```

I don't want to make multiple queries, because I think is inefficient.

Is there anyway to achive the desire result with one query?

I know CakePHP manage to return relational tables results in this format, so I'm looking to achieve the same result.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:50:49.580

连接应该类似于：

```
select c.id, c.title, p.id, p.title, p.category_id 
from categories c, posts p
where c.id = p.category_id 
order by c.id, p.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T23:28:26.277

首先，如果您想要此功能，请考虑使用 ORM 库（例如 CakePHP 和其他框架提供的库），而不是为已经解决的问题滚动您自己的代码。

你不能在 SQL 中做“内部数组”，这不是没有很大的丑陋（比如将记录打包到一个字符串列中，然后在 PHP 中解包它们）。

但是对于一个快速的'n 肮脏的解决方案，只要你在查询中重命名帖子 ID 和标题（例如，'post_id'），就可以使用你原来的连接查询，以避免与类别 ID 混淆。然后遍历结果集并构建您的数组。

```
$newArray = array();
foreach($resultset as $row) {
    if(!array_key_exists($row['category_id'],$newArray)) {
       $newArray[$row['category_id']] = array('id' => $row['category_id'], 'title' => $row['title'], 'posts' => array());
    }
    $newArray[$row['category_id']]['posts'] = array('id' => $row['post_id'], 'title' => $row['post_title'], 'category_id' => $row['category_id']);
} 
```

我没有在编辑器中编写此代码，因此我为拼写错误道歉。你明白了一般的想法。

# email - 设置 SPF 记录以允许从 Google Apps 和 Bluehost 发送电子邮件

> ID：11441924
> 
> 赞同：2
> 
> 时间：2012-07-11T21:41:13.680
> 
> 标签：email, spf

我需要能够从 Google Apps（我的 gmail 帐户）和托管在 Bluehost 上的网站发送电子邮件。如何创建允许我从这些位置发送电子邮件但限制从其他位置发送电子邮件的 SPF 记录？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-11T21:50:28.557

像这样：

`v=spf1 include:_spf.google.com a a:abc.example.org a:xyz.example.org -all`

这就是说，包括 Google 的 SPF 记录（这将允许他们的所有邮件服务器代表您的域发送邮件），并允许该域中具有 A 记录的任何内容，并通过验证其 A 记录特别允许其他 2 个主机。其他一切都失败。

为此，您需要确切知道哪些邮件服务器出站邮件将来自 Bluehost。我对它们了解不多，但这可能是您自己的服务器，或者他们的出站服务器。如果是后者，您可能还可以使用另一个“包含”子句来包含他们的记录，这样您就不必及时了解他们所做的任何更改。

这个网站是一个有用的工具。谷歌提供其他。[http://tools.bevhost.com/spf/](http://tools.bevhost.com/spf/)

# jquery - MVC PartialView 加载导致问题

> ID：11441925
> 
> 赞同：0
> 
> 时间：2012-07-11T21:41:14.730
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-partialview

我正在使用 .load() 加载局部视图。它给我带来了很多问题，因为加载后 DOM 变得一团糟。

有没有其他方法可以加载部分视图。

目前我正在使用：

```
 $("#stlist").load('@Url.Action("kitsEdit","Speaker")' + '?id=' +  '@Model.spkrid') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T05:12:28.580

无需使用jquery

```
<div id="stlist">
    @html.Action("kitsEdit","Speaker", new { id = Model.spkrid })
</div> 
```

# java - Linux Ubuntu Android SDK 管理器未启动 - android:java: 未找到

> ID：11441928
> 
> 赞同：11
> 
> 时间：2012-07-11T21:41:36.393
> 
> 标签：java, android, linux, ubuntu

我将 android SDK 提取到我创建的名为“/usr/android/android-sdk-linux”的文件夹中。我进入“工具/”并双击可执行文件“android”，单击“在终端中运行”，但没有任何反应。我也单击“运行”，但再次没有任何反应。我在终端（`./android`命令）中运行它，我得到：

```
./android: 1: ./android: java: not found
./android: 1: ./android: java: not found
./android: 110: exec: java: not found 
```

那么为什么会这样呢？

**编辑：**这是结果`~$ java`

```
* default-jre
* gcj-4.6-jre-headless
* openjdk-6-jre-headless
* gcj-4.5-jre-headless
* openjdk-7-jre-headless 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-25T01:04:56.553

我所要做的就是`sudo apt-get install openjdk-7-jdk`。再也不要尝试手动安装。哦，对不起，我对以前的答案一无所知。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-07-02T06:30:38.347

当您使用基于 Debian 的 Linux 发行版时，如果您手动安装 JDK（而不是从存储库），更好的解决方案是创建一个指向 java 命令的符号链接。

我解决了这个问题。创建一个名为**/usr/bin/java的****符号链接**并将其指向**/home/your_name/your_jdk_folder/bin/java**

 ****这是终端/konsol 中的示例命令

```
sudo ln -s /home/azware/tmp/jdk1.7.0_03/bin/java /usr/bin/java 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-18T16:49:01.483

在 /opt/jdk 中使用带有 Sun JDK 1.8 的 Ubuntu 14.04 我解决了这个问题：

```
sudo update-alternatives --install /usr/local/bin/java java /opt/jdk/bin/java 0
sudo update-alternatives --install /usr/local/bin/javac javac /opt/jdk/bin/javac 0 
```

这使用了 Ubuntu 也使用的基于 Debian 的替代系统。请注意，这是在您没有安装任何其他 Java（即 OpenJDK）的情况下。如果您安装了另一个 Java，那么您很可能已经为它安装了另一个 Java。请参阅 update-alternatives 手册页以了解系统如何工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-11T21:47:49.857

看起来你没有安装java。尝试运行`java`- 没有找到吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-11T22:03:18.390

确保您已安装 Java6 **JDK**。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-08T05:42:18.417

我在 ubuntu 14.04, 64bit 上使用 android studio，这个错误是由于文件权限问题引起的`$home/android-studio/sdk/tools`

```
$sudo chmod -R 755 ./* 
```

运行命令`$home/android-studio/sdk/tools`解决了这个问题。****

# postgresql - PostgreSQL password authentication failure on Linux only

> ID：11441932
> 
> 赞同：1
> 
> 时间：2012-07-11T21:41:45.693
> 
> 标签：postgresql, postgresql-9.1

I encountered something weird with connecting to a PostgreSQL database from Tomcat on a Linux server. For some weird reason I cannot connect to the database eventhough if I run the same application and configuration on a Windows machine the authentication works just fine. I can also login with pgAdmin from my Windows machine.

So when I login with pgAdmin I update the password to be the same as it was before and that all off a sudden it works :-S. If I look at the MD5 hash that was generated it's exactly the same as before. Does anybody know what might be going on?

I suspect something with case sensitivity but I can't really figure out how that is possible since I use exactly the same configuration on the Linux server and on the Windows machine.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T18:43:24.460

这真是一件愚蠢的事情。我使用错误的语法来创建用户。我从 pgAdmin 复制粘贴了包含散列密码的 SQL 语句，因此当我尝试使用实际密码登录时，身份验证失败。

它在我的 Windows 机器上工作的原因是因为我将我的内部网络配置为受信任，所以它根本没有使用我指定的密码。所以看起来它只能在 Windows 上工作，但实际上并非如此。

# ios - 如何在 iOS 的 NSAttributedString 中设置属性？

> ID：11441934
> 
> 赞同：1
> 
> 时间：2012-07-11T21:41:53.307
> 
> 标签：ios, cocoa-touch, core-text, nsattributedstring

我正在尝试在 iOS 中设置 NSAttributedString 的臭名昭著的 NSFontAttributeName 属性，但它似乎不起作用：

1.  首先，似乎没有为 iOS 定义任何 NS 常量
2.  我在某处读到，我可以通过传递 CoreText 常量来解决它。很好......但仍然，该属性需要一个 NSFont 并且我坚持使用 UIFont 或 CTFontRef，这两种方法似乎都不起作用：

这不起作用：

```
CTFontRef ctFont = CTFontCreateWithName((CFStringRef)[UIFont boldSystemFontOfSize:16].fontName, [UIFont boldSystemFontOfSize:16].pointSize, NULL);
[myAttString addAttribute:(NSString*)kCTFontNameAttribute
                          value:(id)ctFont
                          range:NSMakeRange(0, myAttString.length-1)]; 
```

这不起作用：

```
[myAttString addAttribute:(NSString*)kCTFontNameAttribute
                          value:[UIFont boldSystemFontOfSize:16]
                          range:NSMakeRange(0, myAttString.length-1)]; 
```

有没有办法使这项工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-11T22:37:56.160

我找到了！

基本上，结果我应该使用的字典键的字符串常量是 kCTFontAttributeName

这整件事就是一场秀...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-11T21:57:56.013

NS 常量和完整的属性字符串支持将在那里。不过iOS5还没有。

CoreText 常量确实有效，CTFontRef 也是我使用它的方式。您的代码的第一块应该可以工作。您能否验证您的其他代码位问题不在其他地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-27T10:00:18.893

这样做：

```
let paragraphStyle = NSMutableParagraphStyle()
paragraphStyle.alignment = .center

let attributes = [NSParagraphStyleAttributeName :  paragraphStyle,
                  NSFontAttributeName :   UIFont.systemFont(ofSize: 24.0),
                  NSForegroundColorAttributeName : UIColor.blue,
                  ]

let attrString = NSAttributedString(string: "Stop\nall Dance",
                               attributes: attributes) 
```

# wordpress - Wordpress template file author.php. How to get author ID?

> ID：11441935
> 
> 赞同：1
> 
> 时间：2012-07-11T21:41:55.857
> 
> 标签：wordpress, wordpress-theming

Question is about Wordpress template file author.php.

At author.php, I need to output author ID, to get more info, but I cant do that. Maybe someone can help ? Example: [http://www.domain.com/?author=1](http://www.domain.com/?author=1) Need to output Author ID: 1

[http://www.domain.com/?author=2](http://www.domain.com/?author=2) Need to output Author ID 2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T06:27:25.177

查看法典作者模板部分的[作者信息设置部分。](http://codex.wordpress.org/Author_Templates#Setting_Up_for_Author_Information)初始化`$curauth`后，您应该可以使用`$curauth->ID`.

# jquery - How do I simulate a click only on page refreshes?

> ID：11441936
> 
> 赞同：0
> 
> 时间：2012-07-11T21:42:09.117
> 
> 标签：jquery, refresh, reload

I want to simulate a click,

> $("#genStats").trigger("click");

every time I refresh the page

> window.location.reload()

but not on the initial page load.

What's the easiest way of doing this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T22:41:50.433

查看其他 SO 帖子：[检查页面是否在 Javascript 中重新加载或刷新](https://stackoverflow.com/questions/5004978/check-if-page-reloaded-or-refresh-in-js)

这里要注意的是，这会检测用户是否是*第一次*登陆页面。因此，如果它们降落在那里并刷新，您将获得所需的效果。但是，如果他们离开又回来，它会将其视为刷新。如果这是不可接受的，您将需要在所有其他页面上设置一个脚本来清除此 cookie。

这是你在你的情况下会做的事情：

```
function isFirstVisit() {
    if (document.cookie.indexOf('beenhere') === -1) {
        // cookie doesn't exist, create it now
        document.cookie = 'beenhere=1';
        return true;
    }
    return false;
}

$(document).ready(function(){
    if (!isFirstVisit()) {
        $("#genStats").trigger("click");
    }
}); 
```

并删除您其他页面上的 cookie：

```
function removeCookie(sKey) {  
    if (!sKey || !this.hasItem(sKey)) { return; }  
    var oExpDate = new Date();  
    oExpDate.setDate(oExpDate.getDate() - 1);  
    document.cookie = escape(sKey) + "=; expires=" + oExpDate.toGMTString() + "; path=/";  
}
removeCookie("beenhere"); 
```

[这是一个很好的资源`document.cookie`](https://developer.mozilla.org/en/DOM/document.cookie)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:45:58.000

在您的 javascript 代码中放置 $(document).ready() 函数，一旦页面完全加载，它将触发您的点击。

# installation - 输出重定向如何在 Inno Setup 中工作？

> ID：11441938
> 
> 赞同：5
> 
> 时间：2012-07-11T21:42:24.477
> 
> 标签：installation, inno-setup

我在这里看到了这个问题：[How to get an output of an Exec'ed program in Inno Setup?](https://stackoverflow.com/questions/1136770/how-to-get-the-output-of-an-execed-program-in-inno-setup)

但我自己不能让它工作，注释掉的代码是我试图让它工作的尝试，但我求助于一个 bat 文件，因为我无法让我的重定向工作。`CacheInstanceName`并且`CacheInstanceDir`是在别处定义的全局变量：

```
function CheckCacheExists(): Integer;
var
  args: String;
  buffer: String;
  ResultCode: Integer;
begin
  // args := 'qlist ' + CacheInstanceName + ExpandConstant(' nodisplay > {tmp}\appcheck.txt');
  // MsgBox(args, mbInformation, MB_OK);
  // Exec(CacheInstanceDir + '\bin\ccontrol.exe', 'qlist ' + CacheInstanceName + ExpandConstant(' nodisplay > "{tmp}\appcheck.txt"'), '', SW_SHOW,

  ExtractTemporaryFile('checkup.BAT');
  Exec(ExpandConstant('{tmp}\checkup.BAT'), CacheInstanceDir + ' ' + 
    CacheInstanceName + ' ' + ExpandConstant('{tmp}'), '', SW_SHOW,
    ewWaitUntilTerminated, ResultCode);
  LoadStringFromFile(ExpandConstant('{tmp}\appcheck.txt'),buffer);
  if Pos('^', buffer) = 0 then
  begin
    Result := 0
  end
  else 
  begin
    Result := 1
  end 
end; 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-12T20:58:22.963

输出重定向语法是命令提示符的一项功能，而不是核心 Windows API。因此，如果要重定向输出，则需要通过`{cmd} /c actual-command-line > output-file`. 不要忘记在适当的地方包含引号，因为`{tmp}`（和其他常量）可能包含空格。

但是，您应该强烈考虑将该批处理文件中的任何内容重写为实际代码。您可以在批处理文件中执行的任何操作都可以直接在 Inno 脚本或从脚本调用的 DLL 中执行。这使您可以更好地控制错误检查和要检索的任何数据的格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-31T10:42:39.267

尝试使用字符串中的参数直接在命令行上运行该命令，`args`以查看可能指示问题的结果。

此外，请检查您尝试将输出重定向到的文件是否未被其他进程使用。我发现当发生这种情况时，实际命令可能会成功执行，`Exec`命令返回`True`，但`ResultCode`指示错误并且没有输出写入重定向中使用的文件。在另一个实例正在使用的文件的这个特定实例中，该`SysErrorMessage(ResultCode)`命令仅返回`Incorrect function`. 但是，正如我首先提到的，直接在命令行上进行测试会返回该文件正在被另一个进程使用。

# javascript - getElementId('divname' + varname) ::: Not Working?

> ID：11441940
> 
> 赞同：0
> 
> 时间：2012-07-11T21:42:35.880
> 
> 标签：javascript, while-loop, scope, getelementbyid

I have a long set of divs where I'd like to change all of their background colors to a random color when someone clicks the "home" button with a cascading delay (which I'll add later). I've been testing this in jfiddle and I can't seem to get it to work.

For example, with a while loop of 1-10 on jsfiddle: [http://jsfiddle.net/PWvaw/17/](http://jsfiddle.net/PWvaw/17/)

Am I having a var scope issue or is there an issue with placing a string/variable combo in a getElementByID method? It seems to show, when I place head tags in the HTML section of jfiddle, the code turns red right after the "getElementById("

```
switch (randomNumberOne) {
  case 1:
    document.getElementById( 
```

Any help would be appreciated. I did a search here already and found nothing conclusive, however, I apologize if I missed an answer. Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:47:29.457

只需删除颜色代码中的分号即可。

```
function backgroundColorChange() {
    var num = 1;
    while (num <= 10) {
        var randomNumberMe = Math.floor((Math.random()*10)+1);
        console.log(randomNumberMe);
        switch (randomNumberMe) {
            case 1:
              document.getElementById('r' + num).style.backgroundColor = '#db0058';
              break;
            case 2:
              document.getElementById('r' + num).style.backgroundColor = '#80e800';
              break;
            case 3:
              document.getElementById('r' + num).style.backgroundColor = '#ffb700';
              break;
            case 4:
              document.getElementById('r' + num).style.backgroundColor = '#4b5ed7';
              break;
            default:
              document.getElementById('r' + num).style.backgroundColor = '#ffffff';
              break;
        }
        num += 1;
    }
} 
```

[jsfiddle](http://jsfiddle.net/PWvaw/18/)

# html - 缩放浏览器时停止warpper div移动

> ID：11441942
> 
> 赞同：0
> 
> 时间：2012-07-11T21:42:46.217
> 
> 标签：html, css

我有一个简单的页面，上面有一个带有背景颜色的包装器。当我将浏览器缩放到一个小尺寸时，包装器会弹出位置。它像左边的 20px 被添加了。

此外，当您缩小浏览器时，输入字段会下拉到下一行。我怎么能阻止它。

[http://www.artaholic.com/push/bc/acc.html](http://www.artaholic.com/push/bc/acc.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:53:09.320

去除那个：

```
<link type="text/css" rel="stylesheet" href="bootstrap/css/bootstrap-responsive.css"/> 
```

如果你不是真的需要它。它会解决跳跃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:54:35.633

来自 bootstrap responsive 的 20px ，我相信这一行：

```
@media (max-width: 767px) {
  body {
    padding-right: 20px;
    padding-left: 20px;
  } 
```

# html - Side by side divs w/ negative relative position

> ID：11441943
> 
> 赞同：0
> 
> 时间：2012-07-11T21:42:49.337
> 
> 标签：html, css, css-float

I'm trying to create two side by side divs in a wrapper. The first div, #content, is a position:relative div.

```
#wrapper {
background-image: url(assets/images/BG2.gif);
margin-right: auto;
margin-left: auto;
width: 996px;
overflow: auto;
}

#content {
position: relative;
top: 10px;
left: 10px;
width: 745px;
background-color: red;
}

#important {
float: right;
position: relative;
top: -1120px;
width: 231px;
margin-right: 10px;
background-color: green;
} 
```

The problem is that the second div, #important, is displayed under the first one. There is enough space for both divs and the padding/margins. I can make it work by floating it to the right and using a negative top position and it displays fine, but I feel as though there is a better/correct way of doing this.

HTML:

```
<div id="wrapper">
  <div id="content">
    <img src="assets/photos/bid day 046.jpg" alt="Bid Day" width="745" height="311" />
      <div id="fraternity">
      <p align="center"><span class="style5"><strong>TITLE</strong><br />
      Subtitle<br />
      Sub-subtitle</span></p>
      <p align="justify">depry derp</p>
      <p align="justify">derp derp derp</p>
      <p class="style5" align="center"><br/><strong>Title<br/>
      Twitter Feed</strong></p>   
      <div id="twitter">
        <script src="http://widgets.twimg.com/j/2/widget.js"></script>
        <script>...</script>
      </div>
    </div>
    <div class="fb-like-box" data-href="something" data-width="292" data-colorscheme="dark" data-show-faces="false" data-stream="true" data-header="false">
    </div> 
  </div>
  <div id="important">
    <p align="center"><strong>IMPORTANT INFORMATION</strong><br />Derp!</p>
    <img class="divider" src="assets/images/hr.gif" alt="HR" width="183" height="15" />
    <p align="center"><strong>Achievements<br /></p>
    <img class="divider" src="assets/images/hr.gif" alt="HR" width="183" height="15" />
    <p align="center" class="style11"><strong>UPCOMING  EVENTS<br /></strong>stuff<br /></p>
    <p align="center"><br /> <strong>more stuff</strong><br /></p>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T21:49:05.167

使`#wrapper`s 位置为`relative`or `absolute`。

然后将内部 div 位置设置为`absolute`.

jsfiddle 示例：http: [//jsfiddle.net/kRHTj/](http://jsfiddle.net/kRHTj/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:51:20.783

我会让它们向左或向右浮动。

# javascript - Concatenate Variable Onto Form Input Value Using Javascript

> ID：11441948
> 
> 赞同：0
> 
> 时间：2012-07-11T21:43:14.860
> 
> 标签：javascript, jquery, variables, concatenation

I have a PHP `while` loop that generates a table containing `input` tags. Each input box is given a unique name by appending the input box name and the loop value.

```
<?php
$i=1;
$r=0;
while($i<=$positionjobrows)
{
    ?>
    <tr>
        <td>
            <?PHP echo $i; ?>
        </td>
    <td>
    <input type=text NAME="position<?PHP echo $i; ?>" id="position<?PHP echo $i; ?>"  style="border: 1px solid #2608c3;color:red; width=200px" value="<? echo mysql_result($resultpositionjob,$r,0);?>"> 
    </td>
    <td>
    <input type=text NAME="job<?PHP echo $i; ?>" id="job<?PHP echo $i; ?>"  style="border: 1px solid #2608c3;color:red; width=200px" value="<? echo mysql_result($resultpositionjob,$r,1);?>"> 
    </td>
    <td>
    <SELECT NAME="person<?PHP echo $i; ?>" id="person<?PHP echo $i; ?>" style="border: 1px solid #2608c3;color:red; width=200px" onchange="get(<? echo $i; ?>);"> 
    <OPTION VALUE=0 >
    <?=$optionpeople?> 
    </SELECT>
    </td>
    <td>
    <div id="training<?PHP echo $i; ?>"><font color=grey size=2>Training details will be shown here</div>
    </td>
    </tr>
    <?PHP
    $i++;
    $r++;
    }
    ?> 
```

I am trying to modify my javascript / jquery script to use each of the generated input box names.

For example the input box position will be named position1, position2, position3 etc. I call the script using onchange="get(row)" where row is the loop instance. so for position1 the onchange will be onchange"get(1)"

This is passed to my javascript / jquery script:

```
<script type="text/javascript">
        function get(row){

        $.post ('getpeopleinjobs.php',{ 
        postvarposition: form.[position+row].value,
        postvarjob: form.job+row.value, 
        postvarperson: form.person+row.value, 
        postrow: row}, 
            function(output){
                $('#training'+row).html(output).show();
                    });
        alert(postvarposition); 

        }

</script> 
```

As you can see, I want to set the variable postvarposition to the `id` of the inputbox (position) + the row number. I want to concatenate the two together inside the `form.position.value` statement. So get(1) will then produce:

```
postvarposition: form.position1.value 
```

My thinking is along these lines, but is not working:

```
postvarposition: form.[position+row].value, 
```

How can I concatenate the name of the inputbox against the row?

Thanks as always for the help.

**UPDATE**

This code below works for the first row where I manually append '1' to the input tag name.

```
<script type="text/javascript">
        function get(row){
        alert(row);
        $.post ('getpeopleinjobs.php',{ 
        postvarposition: form.position1.value,
        postvarjob: form.job1.value, 
        postvarperson: form.person1.value, 
        postrow: row}, 
            function(output){
                $('#training'+row).html(output).show();
                    });
                }
</script> 
```

I have then tried to change it as advised by machineghost but this still doesnt work. I have confirmed that the value of variable row is 1 with the alert message.

```
<script type="text/javascript">
        function get(row){
        alert(row);
        $.post ('getpeopleinjobs.php',{ 
        postvarposition: form[position+row].value,
        postvarjob: form[job+row].value, 
        postvarperson: form[person+row].value, 
        postrow: row}, 
            function(output){
                $('#training'+row).html(output).show();
                    });
                }
</script> 
```

Google Chrome (F12) ouputs error `Uncaught ReferenceError: position is not defined`

any advice or suggestions would be appreciated.

Many Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T22:34:15.620

如果要使用括号语法，则不能将其与句点语法结合使用。换句话说：

```
form.[position+row].value 
```

应该：

```
form[position+row].value 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T06:55:46.717

现在工作100%。

应该

form["position"+row].value 根据 machineghost 的建议。

# android - SimpleAdapter duplicating items

> ID：11441951
> 
> 赞同：0
> 
> 时间：2012-07-11T21:43:24.407
> 
> 标签：android, listactivity, simpleadapter

I am using `SimpleAdapter` for displaying a `ListView`, but whenever I press the back button, and open the activity (which shows the list) again, the entries of the list become double.

If I do it again, array values again concatenates with the items of the list.

List variable of array is declared as

```
 private static final ArrayList<HashMap<String,String>> list = new ArrayList<HashMap<String,String>>(); 
```

my code in `onCreate()` of `List.java`:

```
setContentView(R.layout.list);

    HashMap<String,String> temp = new HashMap<String,String>();
    temp.put("first","Strength");
    temp.put("second", strength);
    list.add(temp);

    HashMap<String,String> temp1 = new HashMap<String,String>();
    temp1.put("first","what");
    temp1.put("second", "??");
    list.add(temp1);

    HashMap<String,String> temp2 = new HashMap<String,String>();
    temp2.put("first","Time");
    temp2.put("second", "time");
    list.add(temp2);

    HashMap<String,String> temp3 = new HashMap<String,String>();
    temp3.put("first","Repeat");
    temp3.put("second", "everyday");
    list.add(temp3);

    setListAdapter(new SimpleAdapter(this,list,R.layout.row_view, new String [] {"first","second"}, new int [] {R.id.rowTextView1, R.id.rowTextView2} )); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:47:01.093

您可以创建一个 if 语句来检查列表中是否已有任何内容，如下所示：

```
if(list.size() == 0){

HashMap<String,String> temp = new HashMap<String,String>();
temp.put("first","Strength");
temp.put("second", strength);
list.add(temp);

HashMap<String,String> temp1 = new HashMap<String,String>();
temp1.put("first","what");
temp1.put("second", "??");
list.add(temp1);

HashMap<String,String> temp2 = new HashMap<String,String>();
temp2.put("first","Time");
temp2.put("second", "time");
list.add(temp2);

HashMap<String,String> temp3 = new HashMap<String,String>();
temp3.put("first","Repeat");
temp3.put("second", "everyday");
list.add(temp3);
} 
```

# linq - LINQ Query for An object with 2 collections

> ID：11441952
> 
> 赞同：3
> 
> 时间：2012-07-11T21:43:26.843
> 
> 标签：linq, asp.net-mvc-4

I have a class `SearchOutput` which has a property `FilterGroups` that's an `IEnumerable<FilterGroup>`. In this instance, the `FilterGroups` is a list of two objects both holding the properties `Filters` and `Name`. Both objects hold different filters and a different name ("Brands" and "Color").

How would I get just one of those object's filters using LINQ?

Here is my code in the view:

```
@foreach(var filterGroup in Model.FilterGroups)
{
    foreach(var filter in filterGroup.Filters.Take(10))
    {
        <li>
            <a href="javascript:void(0)"><span class="tickMark"></span><strong>@filter.Name<span>(@filter.ProductCount)</span></strong></a>
        </li>
    }
} 
```

My classes:

```
public sealed class Filter
{
    public string Id { get; set; }

    public bool IsChecked { get; set; }

    public string Name { get; set; }

    public int ProductCount { get; set; }
}

[DebuggerDisplay("{Name}")]
public sealed class FilterGroup
{
    public IEnumerable<Filter> Filters { get; set; }

    public string Name { get; set; }
}

public sealed class SearchOutput
{
    ...
    public IEnumerable<FilterGroup> FilterGroups { get; set; }
    ...
} 
```

My controller's Action:

```
var searchOutput = new SearchOutput
{
    Layout = layout,
    ActionUrl = "/shop/{0}/{1}".FormatForInvariantCulture(input.Slug, input.Id),
    BreadboxSection = breadboxSection,
    Breadcrumbs = breadcrumbLinks,
    CurrentPage = page,
    FilterGroups = filterGroups,
    Name = isStorefront ? breadcrumbLinks.Last().Text : string.Empty,
    NextPageUrl = BuildNextPageUrl(products, input, page, selections, sort),
    PreviousPageUrl = BuildPreviousPageUrl(input, page, selections, sort),
    Products = productList,
    Selections = selections,
    SpotlightFilters = spotlightFilters,
    TotalPages = BuildTotalPages(products),
    UpcomingShows = UpcomingShows
};

if(isStorefront)
    return View("~/Views/" + RenderViewType + "/Store.cshtml", searchOutput);
else
    return View("~/Views/" + RenderViewType + "/Search.cshtml", searchOutput); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T22:23:25.840

而不是通过 foreach 循环，`FilterGroup`您可以使用以下方法获取`Filters`第一个`FilterGroup`：

```
@foreach(var filter in Model.FilterGroups.First(x => x.Name == "Brands").Filters.Take(10))
{
    <li>
        <a href="javascript:void(0)"><span class="tickMark"></span><strong>@filter.Name<span>(@filter.ProductCount)</span></strong></a>
    </li>
}

@foreach(var filter in Model.FilterGroups.First(x => x.Name == "Color").Filters.Take(10))
{
    <li>
        <a href="javascript:void(0)"><span class="tickMark"></span><strong>@filter.Name<span>(@filter.ProductCount)</span></strong></a>
    </li>
} 
```

# iphone - 覆盖 prefix.pch IOS 中的 NSLOG

> ID：11441962
> 
> 赞同：4
> 
> 时间：2012-07-11T21:44:32.963
> 
> 标签：iphone, objective-c, ios, xcode, ios5

我读了这篇文章：[http](http://weakreference.wordpress.com/2011/06/22/overriding-nslog-on-ios/) ://weakreference.wordpress.com/2011/06/22/overriding-nslog-on-ios/ 。

文章的思路是把这两个东西加到你app的prefix.pch文件中，这样你就可以覆盖NSLog的行为了。

我要添加的两件事是：

```
#define NSLog(...) customLogger(__VA_ARGS__); 
```

和

```
void customLogger(NSString *format, ...) {
    va_list argumentList;
    va_start(argumentList, format);
    NSMutableString * message = [[NSMutableString alloc] initWithFormat:format
        arguments:argumentList];

    [message appendString:@"Our Logger!"]; // Our custom Message!
    NSLogv(message, argumentList); // Originally NSLog is a wrapper around NSLogv.
    va_end(argumentList);
    [message release];
} 
```

xCode 抛出一个错误 match-o 错误，它找到了 customLogger 的重复项。

有没有人成功覆盖 NSLog？

谢谢！

**编辑以回应 Rob：**

好，太棒了。我们正在取得进展！我按照你的要求移动了东西。这是我们现在所拥有的：

我的自定义记录器：

```
void customLogger(NSString *format, ...) {

    va_list args;
    va_start(args, format);
    va_end(args);
    [newLogger log:format withArgs:args];
}

//This is a newLogger Method
+ (void) log:(NSString *)format withArgs:(va_list) args{

    NSArray *occ = [format componentsSeparatedByString:@"%@"];

    NSInteger characterCount = [occ count]; 

    NSArray *stringItems = [format componentsSeparatedByString:@"%@"];

    NSMutableString *tmp = [[NSMutableString alloc] initWithFormat: @"%@",[stringItems objectAtIndex:0]];

    for( int i = 1; i < characterCount; i++ ) {
        NSString *value = va_arg(args, NSString *);
        [tmp appendString:value];
        [tmp appendString:[stringItems objectAtIndex:i]];
    }

    // Need to alter the above and actually do something with the args! 
    [tmp appendString:@"\n"];
    [[newLogger sharedInstance].logBuffer appendString:tmp];

    if ([newLogger sharedInstance].textTarget){
        [[newLogger sharedInstance].textTarget setText:sharedInstance.logBuffer];
    }
} 
```

当我调用 +log 时，线程 1 上出现 SIBABRT 错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-11T21:50:53.120

听起来您在文件中定义`customLogger`了`.pch`。这意味着每个`.m`文件都包含它，因此`.o`您的项目创建的每个文件都包含自己的`customLogger`. 这就是为什么您会从链接器中得到重复的符号定义错误。

您只需在`customLogger`中声明`.pch`，如下所示：

```
void customLogger(NSString *format, ...); 
```

并创建一个`customLogger.m`包含定义的文件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-01-24T13:46:34.067

试试这个代码。它覆盖了 NSLog。在最后的 ClassName-Prefix.pch 文件中编写以下代码

```
#ifdef DEBUG
#    define DLog(...) NSLog(__VA_ARGS__)
#else
#   define DLog(...) /* */
#endif 
```

在 ViewController.m 文件中，

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    DLog(@"printing from DLog");

    DLog(@"printing again from DLog");

// Do any additional setup after loading the view, typically from a nib.
} 
```

这将在控制台中打印句子。如果您发现困难，请告诉我。

# java - JList 未显示在 JScrollPane 上

> ID：11441963
> 
> 赞同：2
> 
> 时间：2012-07-11T21:44:42.433
> 
> 标签：java, mysql, sql, swing, jlist

我正在为一家家族企业制定一个计划，该计划将管理其原材料供应商的宣传册。我发现您将需要所有代码，因此我将其发布在 pastebin 上。[http://pastebin.com/Gc3aLe10](http://pastebin.com/Gc3aLe10)

而且，在这里我附上我认为问题所在的地方：

```
tnBuscar.addActionListener(new ActionListener(){
        public void actionPerformed(ActionEvent e) {

            String search = searchField.getText();
            Connection con = null;
            java.sql.Statement st = null;
            ResultSet rs = null;

            String url = "jdbc:mysql://localhost:3306/";
            String db = "FAVEGA";
            String driver = "com.mysql.jdbc.Driver";
            String user = "root";
            String pass = "";
            try {
                Class.forName(driver);
                con = DriverManager.getConnection(url + db, user, pass);
                con.setAutoCommit(false);
                st = con.createStatement();
                String sql = "SELECT * FROM catalogos WHERE id = '" + search + "' OR name LIKE '%" + search + "%' OR keywords LIKE '%" + search + "%'";
                rs = st.executeQuery(sql);
                while (rs.next()) {
                    final String resultName = rs.getString("name");
                    buffer.add(resultName);
                }
            } catch (ClassNotFoundException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            } catch (SQLException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }finally{
                btnEditar.setVisible(true);
                btnReiniciar.setVisible(true);
                final JList list = new JList(buffer.toArray());         
                final JScrollPane scrollPane = new JScrollPane(list);
                scrollPane.add(list);
                scrollPane.setViewportBorder(new LineBorder(new Color(0, 0, 0)));
                scrollPane.setBounds(67, 195, 269, -143);
                buscarPanel.add(scrollPane);                    
                list.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
                list.setBounds(0, 0, 435, 240);

                scrollPane.setPreferredSize(new Dimension(70, 80));
                list.setLayoutOrientation(JList.VERTICAL);
                buscarPanel.invalidate();
                buscarPanel.validate();
                btnEditar.addActionListener(new ActionListener(){
                    public void actionPerformed(ActionEvent e) {
                        if(list.getSelectedValue() != null){
                            String selectedValue = (String) list.getSelectedValue();
                            tab.setSelectedIndex(2);
                            btnReiniciar.addActionListener(new ActionListener(){
                                public void actionPerformed(ActionEvent e) {
                                scrollPane.setVisible(false);
                                btnEditar.setVisible(false);
                                btnReiniciar.setVisible(false);
                            }
                            });
                }
                    }
                });
            }
        }
    }); 
```

这个按钮在我的数据库中搜索项目，但它在运行时不加载 JList。问题是什么？PS：没有运行时错误，没有 Stacktrace。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:53:50.617

1.  不要重新创建整个 GUI，

2.  使用[XxxListModel](http://docs.oracle.com/javase/tutorial/uiswing/components/list.html#creating)而不是删除并添加`JComponents`到`JPanel`

3.  对 XxxModel 的所有更新都[必须在 EDT 上完成](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)

4.  `finally`总是触发正确的块，但不是创建 GUI 的正确位置

5.  必须调用`revalidate()`&`repaint()`如果你删除然后添加`JComponent`/添加到已经可见的`container`

# html - 从 iframe 子继承 url 扩展

> ID：11441964
> 
> 赞同：0
> 
> 时间：2012-07-11T21:44:55.913
> 
> 标签：html, iframe, javascript-events

我有一个加载 iframe 全屏的网页，我希望父页面有一个动态 url，所以当您单击子页面并导航到 www.childpage.com/page1 时，可见的父 url 更改为 www.parentpage。 com/page1。我还希望 www.parentpage.com/page1 成为硬链接，因此直接访问该 url 会将 iframe 加载为 www.childpage.com/page1。

我知道这是可能的，但到目前为止，我发现大多数答案要么令人困惑，要么不完整。非常感谢！为这个简单/可能多余的问题道歉。

# c++ - Boost Threads Producer/Consumer 意外行为

> ID：11441965
> 
> 赞同：0
> 
> 时间：2012-07-11T21:45:02.947
> 
> 标签：c++, multithreading, boost, boost-thread, producer-consumer

我目前正在编写一个应用程序（使用 boost），它将有一个生产者抓取帧和一个消费者阅读帧。我在生产者中添加了一个睡眠语句来模拟抓取帧的时间。我希望消费者等待条件变量，并在生产者的第一次通知被唤醒以读取帧。但是，我在日志文件中看到的是消费者（主线程）在条件变量上等待，但是在消费者退出等待读取帧之前，生产者经历了几次通知。

这是我的 Worker.h

```
class Worker {
static log4cxx::LoggerPtr m_log;

public:
    Worker();
    virtual ~Worker();

    void start();
    void stop();
    void getCurrentFrame(/*cv::Mat& frame*/);

private:
    void processFrames();

    volatile bool m_stopRequested;

    bool m_bFrameReady;
    boost::mutex m_mutex;
    boost::condition_variable condF;

    boost::shared_ptr<boost::thread> m_thread;
}; 
```

工人.cpp

```
LoggerPtr Worker::m_log(Logger::getLogger("fdx.Worker"));

Worker::Worker() {
    m_bFrameReady = false;

    LOG4CXX_INFO(m_log, "Worker() c-tor");

    m_stopRequested = false;

}

Worker::~Worker() {
    LOG4CXX_INFO(m_log, "Worker() d-tor");
}

void Worker::start()
{
    LOG4CXX_INFO(m_log, "Worker()::start()");
    assert(!m_thread);

    m_thread = boost::shared_ptr<boost::thread>(new boost::thread(&Worker::processFrames, this));

    LOG4CXX_WARN(m_log, "Worker()::start() thread[" << m_thread->get_id() << "] started!");
}

void Worker::stop()
{
    LOG4CXX_INFO(m_log, "Worker()::stop()");

    if(m_thread != NULL)
    {
        LOG4CXX_INFO(m_log, "Worker()::stop() ThrId [" << m_thread->get_id() << "]");
        m_stopRequested = true;
        m_thread->join();
    }
    else
    {
        LOG4CXX_WARN(m_log, "Worker()::stop() The thread for this camera was never started.");
    }

LOG4CXX_INFO(m_log, "Worker()::stop() thread stopped!");
}

void Worker::processFrames()
{
    LOG4CXX_WARN(m_log, "Worker()::processFrames() Thread[" << boost::this_thread::get_id() << "] starting...");

    int rc = 0;
    std::stringstream ss;

    while(!this->m_stopRequested)
    {
        boost::mutex::scoped_lock lock(m_mutex);
        LOG4CXX_WARN(m_log, "Worker()::processFrames() Got a Write lock");

        m_bFrameReady = true;
        LOG4CXX_WARN(m_log, "Worker()::processFrames() Frame ready set to true");

        boost::this_thread::sleep(boost::posix_time::milliseconds(200));

        LOG4CXX_WARN(m_log, "Worker()::processFrames() Write Un-lock");

        lock.unlock();

        LOG4CXX_WARN(m_log, "Worker()::processFrames() Notify");

        condF.notify_one();
    }
}

void Worker::getCurrentFrame()
{
    boost::mutex::scoped_lock lock(m_mutex);

    while(!this->m_bFrameReady)
    {
        LOG4CXX_WARN(m_log, "Worker::getCurrentFrame() wait for Read lock");
        condF.wait(lock);
    }

    LOG4CXX_WARN(m_log, "Worker::getCurrentFrame() Frame ready; Got a Read lock");

    m_bFrameReady = false;

    LOG4CXX_WARN(m_log, "Worker::getCurrentFrame() Frame ready set to false");

    LOG4CXX_WARN(m_log, "Worker::getCurrentFrame() Read Un-lock");
    lock.unlock();

} 
```

主文件

```
LoggerPtr logger(Logger::getLogger("TCamApp"));

int main(int argc, char** argv)
{
int rc = 0;

char cwDir[FILENAME_MAX];

Worker* pWorker = NULL;

memset(cwDir, 0, sizeof(cwDir));
getcwd(cwDir, FILENAME_MAX);

std::cout << "Current Working Dir[" << cwDir << "]" << endl;

std::stringstream ss;
ss << "" << cwDir << "/logs.properties";
std::cout << "logs.properties file[" << ss.str() << "]" << endl;

struct stat st;
if(!stat(ss.str().c_str(), &st))
{
    PropertyConfigurator::configure(ss.str());
}
else
{
    BasicConfigurator::configure();
}

LOG4CXX_INFO(logger, "Application [" << argv[0] << "] starting...");

pWorker = new Worker();
assert(pWorker);

pWorker->start();

for(int i = 0; i < 100; i++)
{
    pWorker->getCurrentFrame();

    LOG4CXX_INFO(logger, "Iteration [" << i << "]");

    //boost::this_thread::sleep(boost::posix_time::milliseconds(20));
}

pWorker->stop();

LOG4CXX_INFO(logger, "Application [" << argv[0] << "] stopping...");

return rc;
} 
```

以下是我的日志文件的摘录：

```
2012-07-11 15:33:53,943 [0x7f5707bcf780] INFO  TCamApp - Application [/home/op/workspace/TestThreads/Debug/TestThreads] starting...
2012-07-11 15:33:53,944 [0x7f5707bcf780] WARN  fdx.Worker - Worker()::start() thread[0x15e4c50] started!
2012-07-11 15:33:53,944 [0x7f5707bcf780] WARN  fdx.Worker - Worker::getCurrentFrame() wait for Read lock
2012-07-11 15:33:53,944 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Thread[0x15e4c50] starting...
2012-07-11 15:33:53,944 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Got a Write lock
2012-07-11 15:33:53,944 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Frame ready set to true
2012-07-11 15:33:54,145 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Write Un-lock
2012-07-11 15:33:54,145 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Notify
2012-07-11 15:33:54,145 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Got a Write lock
2012-07-11 15:33:54,145 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Frame ready set to true
2012-07-11 15:33:54,345 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Write Un-lock
2012-07-11 15:33:54,345 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Notify
2012-07-11 15:33:54,345 [0x7f5707bcf780] WARN  fdx.Worker - Worker::getCurrentFrame() Frame ready; Got a Read lock
2012-07-11 15:33:54,345 [0x7f5707bcf780] WARN  fdx.Worker - Worker::getCurrentFrame() Frame ready set to false
2012-07-11 15:33:54,345 [0x7f5707bcf780] WARN  fdx.Worker - Worker::getCurrentFrame() Read Un-lock
2012-07-11 15:33:54,346 [0x7f5707bcf780] INFO  TCamApp - Iteration [0]
2012-07-11 15:33:54,346 [0x7f5707bcf780] WARN  fdx.Worker - Worker::getCurrentFrame() wait for Read lock
2012-07-11 15:33:54,346 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Got a Write lock
2012-07-11 15:33:54,346 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Frame ready set to true
2012-07-11 15:33:54,546 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Write Un-lock
2012-07-11 15:33:54,547 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Notify
2012-07-11 15:33:54,547 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Got a Write lock
2012-07-11 15:33:54,547 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Frame ready set to true
2012-07-11 15:33:54,747 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Write Un-lock
2012-07-11 15:33:54,747 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Notify
2012-07-11 15:33:54,747 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Got a Write lock
2012-07-11 15:33:54,747 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Frame ready set to true
2012-07-11 15:33:54,948 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Write Un-lock
2012-07-11 15:33:54,948 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Notify
2012-07-11 15:33:54,948 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Got a Write lock
2012-07-11 15:33:54,948 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Frame ready set to true
2012-07-11 15:33:55,148 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Write Un-lock
2012-07-11 15:33:55,149 [0x7f57059c1700] WARN  fdx.Worker - Worker()::processFrames() Notify
2012-07-11 15:33:55,149 [0x7f5707bcf780] WARN  fdx.Worker - Worker::getCurrentFrame() Frame ready; Got a Read lock
2012-07-11 15:33:55,149 [0x7f5707bcf780] WARN  fdx.Worker - Worker::getCurrentFrame() Frame ready set to false
2012-07-11 15:33:55,149 [0x7f5707bcf780] WARN  fdx.Worker - Worker::getCurrentFrame() Read Un-lock
2012-07-11 15:33:55,149 [0x7f5707bcf780] INFO  TCamApp - Iteration [1] 
```

从日志中可以看出，主线程等待读取，但另一个线程会在主线程退出它的 wait() 之前产生多个通知。

我研究了一些并认为我已经正确编码了它，但它的行为不像我预期的那样。我将不胜感激有关解决方案的任何建议。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-13T03:25:45.807

这是意料之中的，因为生产者线程在互斥锁锁定的情况下处于休眠状态。一旦它醒来，它就会通知消费者并再次锁定它。无法保证谁将锁定互斥锁是“公平的”。

您似乎试图实现的是一个异步队列。它通常包含 2 个条件变量：一个在队列满时抑制生产者，另一个在队列为空时抑制消费者。无论生产或消费队列中的项目需要多长时间，互斥锁只会在推送/弹出操作期间被锁定 - 这应该非常快。

您的 sleep 语句可能只是使您的操作系统的调度程序偏向于为生产者线程提供更多优先级。将 sleep 移出临界区，以模拟push 操作**之外**的处理，您应该会看到消费者线程的响应速度更快。

在相关说明中，您可以将哨兵对象（即特殊值，如指针队列上的空指针）推送到队列上，而不是轮询原子变量以终止，让消费者线程知道他们必须停止.

# python - 如何在 Django 中访问数据库但不支持 ORM

> ID：11441968
> 
> 赞同：2
> 
> 时间：2012-07-11T21:45:07.160
> 
> 标签：python, django, database-connection, mysql-error-1064, mysql-python

我的 Django 应用程序中有第二个数据库，其中充满了与我的国家（巴西）和相关街道、社区、城市和州的邮政编码相当的静态数据。

我正在尝试像这样访问它：

```
from django.db import connections
from django.conf import settings

try:
    cursor = connections[settings.CEP_DATABASE_NAME].cursor()
    .... 
```

但我收到以下错误：

```
OperationalError: (1049, "Unknown database 'cep'") 
```

我的设置.py：

```
CEP_DATABASE_NAME = 'cep'
DATABASES = {
    'default': {
        'NAME': 'hypersaber',
        'ENGINE': 'django.db.backends.mysql',
        'USER': 'root',
        'PASSWORD': 'root',
        'HOST' : 'localhost',
        'PORT' : '3306',
        'OPTIONS' : {"init_command": "SET storage_engine=INNODB"}
    },
    CEP_DATABASE_NAME: {
        'NAME': CEP_DATABASE_NAME,
        'ENGINE': 'django.db.backends.mysql',
        'USER': 'root',
        'PASSWORD': 'root',
        'HOST' : 'localhost',
        'PORT' : '3306',
        'OPTIONS' : {"init_command": "SET storage_engine=INNODB"}
    }
} 
```

我的两个 MySQL 数据库实例都已启动并正在运行。

我错过了一些配置吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T21:58:39.397

你的代码对我来说看起来不错。

我不得不问一个显而易见的问题：该数据库是否真的存在于本地主机上？

这是 MySQLdb 模块抛出的异常，这让我认为这里没有任何特定于 django 的错误，这就是为什么我问它是否只是一个真正的低级错误。

您可以从常规（非 django）python 脚本访问数据库吗？

# vb.net - vb.net 组合和或运算符

> ID：11441973
> 
> 赞同：1
> 
> 时间：2012-07-11T21:45:16.140
> 
> 标签：vb.net

非常简单的问题，如何将 and or 运算符组合到同一个语句中。

c.GetType 是 getType(TextBox) AND foo 或 bar 或 baz

这是行不通的

```
For Each c As Control In Me.Controls
    If (c.GetType Is GetType(TextBox)) And ((c.Name <> "txtID") Or (c.Name <> "txtAltEmail")) Then
        'do something
    End If
Next 
```

这有效：

```
For Each c As Control In Me.Controls
    If (c.GetType Is GetType(TextBox)) And (c.Name <> "txtID") Then
        'do something
    End If
Next 
```

谢谢，我是.net 新手！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T21:50:10.517

顺便说一句，您可以使用 LINQ 来提高清晰度。：

```
Dim allTextBoxes = From txt In Me.Controls.OfType(Of TextBox)()
                  Where txt.Name <> "txtID" AndAlso txt.Name <> "txtAltEmail"
For Each txt In allTextBoxes
    ' do something with the TextBox '
Next 
```

*   `OfType`仅返回给定类型的控件，在本例中为 TextBoxes
*   `Where`按属性过滤控件`Name`（注意：[`And`和`AndAlso`差异](https://stackoverflow.com/questions/302047/what-is-the-difference-between-and-and-andalso-in-vb-net)）
*   `For Each`迭代结果`IEnumerable(Of TextBox)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T22:07:06.437

从数学的角度来看，您的第一个陈述没有意义。表达方式

```
X <> A or X <> B 
```

将始终返回`true`（鉴于 ，`A <> B`在您的情况下满足自`"txtID" <> "txtAltEmail"`）。

（如果`X = A`，第二个子句为真。如果`X = B`，第一个子句为真。如果`X`是别的，两个子句都为真。）

你可能打算写的是

```
If (TypeOf c Is TextBox) AndAlso (c.Name <> "txtID") AndAlso (c.Name <> "txtAltEmail") Then 
```

或者

```
If (TypeOf c Is TextBox) AndAlso Not ((c.Name = "txtID") OrElse (c.Name = "txtAltEmail")) Then 
```

这在逻辑上是等价的。

（我还冒昧地将您的类型检查更改为更优雅的变体，并将 And/Or 替换为更有效的对应项。）

# android - avd manager 不会启动虚拟设备

> ID：11441977
> 
> 赞同：1
> 
> 时间：2012-07-11T21:45:36.683
> 
> 标签：android, android-emulator, avd

我刚刚安装了sdk。我在 avd manager 中创建了一个虚拟设备，并将其保存在 d:\userdata\admisistrator.android\avd 中。但是，当我尝试启动虚拟设备时，出现错误“恐慌：无法打开：D:\Userdata\username.android/avd/droid2.in”

出于某种原因，它将虚拟设备保存在管理区域中，但尝试从我的

# php - 如何访问在另一个 PHPUnit 测试中初始化的对象

> ID：11441979
> 
> 赞同：3
> 
> 时间：2012-07-11T21:45:48.453
> 
> 标签：php, phpunit

我有这个代码：

```
public function testFoo() {
    $this->object = newBar();
} 
```

但后来，例如，在方法中`testAdd()`，`$this->object`是`null`。`testAdd`之后执行`testFoo`。

为什么会发生这种情况，整个测试用例是否有类似 setUp 的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T23:32:46.583

每个测试方法都在测试用例类的新实例上执行。确实有一个 setup 方法在每次测试之前调用，它被称为[`setUp`](http://www.phpunit.de/manual/current/en/fixtures.html).

```
public function setUp() {
    $this->object = newBar();
}

public function testFoo() {
    // use $this->object here
}

public function testBar() {
    // use $this->object here too, though it's a *different* instance of newBar
} 
```

如果您需要在测试用例的所有测试中共享状态（通常是不明智的），您可以使用静态`setUpBeforeClass`方法。

```
public static function setUpBeforeClass() {
    self::$object = newBar();
}

public function testFoo() {
    // use self::$object here
}

public function testBar() {
    // use self::$object here too, same instance as above
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T22:00:55.527

我之前在这里问过一个类似的问题：[为什么 symfony DOMCrawler 对象没有在依赖的 phpunit 测试之间正确传递？](https://stackoverflow.com/questions/11311744/why-are-symfony-domcrawler-objects-not-properly-passed-between-dependent-phpunit).

基本上，除非您明确地使它们依赖，否则在测试之间调用某种`shutdown`方法，这是不建议的。`setUp`如果每个测试都需要某些东西，则一种选择是覆盖该方法。

# php - jquery函数与php表单冲突

> ID：11441981
> 
> 赞同：0
> 
> 时间：2012-07-11T21:45:57.087
> 
> 标签：php, jquery, arrays, forms, post

首先是代码：

```
<script type="text/javascript">

(function($){

 $countForms = 1;

      $.fn.addForms = function(idform){

                    var myform = "<table>"+
                     "  <tr>"+
                     "     <td>Field A ("+$countForms+"):</td>"+
                     "     <td><input type='text' name='field["+$countForms+"][a]'></td>"+
                     "     <td>Field B ("+$countForms+"):</td>"+
                     "     <td><textarea name='field["+$countForms+"][b]'></textarea></td>"+
                     "     <td><button>remove</button></td>"+
                     "  </tr>"+
                     "</table>";

                    if(idform=='mybutton'){

                        myform = $("<div>"+myform+"</div>");
                        $("button", $(myform)).click(function(){ $(this).parent().parent().remove(); });
                        $(this).append(myform);
                        $countForms++;
                    }

      };
})(jQuery);         

$(function(){
    $("#mybutton").bind("click", function(e){
    e.preventDefault();
    var idform=this.id;

        if($countForms<3){
            $("#container").addForms(idform);
        }       
    });
}); 
```

```
 <?php
$ligax=mysqli_connect('localhost','root');
if(!$ligax){
    echo '<p> Falha na ligação.'; exit;
}
mysqli_select_db($ligax,'dados_arrays');

    if ( isset( $_POST['field'] ) )
{
    echo '<table>';
    foreach ( $_POST['field'] as $diam )
    {
        // here you have access to $diam['top'] and $diam['bottom']
        echo '<tr>';
        echo '  <td>', $diam['a'], '</td>';
        echo '  <td>', $diam['b'], '</td>';
        echo '</tr>';
    }
    echo '</table>';
}       
?>

<body>

<div id="container"><div>
<form method="post" name="b" >
<table>
    <tr>
        <td>Field A</td>
        <td><input type='text' name='field[0][a]'></td>
        <td>Field B</td>
        <td><textarea name="field[0][b]"></textarea></td>
        <td><button>remove</button></td>
    </tr>
</table>
</div>
</div>
<button id="mybutton">add form</button>

<div align="center">
<p><input type="submit" value="Registar" name="registar"></p>
</div>

<?php

    if($ligax) mysqli_close($ligax);

?>
</body> 
```

代码的第一部分是一个 jquery 函数，它在我需要时复制表单的字段。第二个是表单本身和用于接收来自表单的值的 $_POST 方法。

我的问题是这部分“foreach ($_POST['field'] as $diam)”没有从 jquery 的重复字段中捕获值。也许是因为它是在页面运行后出现的东西，我不知道。这就是为什么我需要帮助和建议。我如何捕获来自 jquery 生成的输入的值？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:51:09.033

您正在寻找的词是`.noConflict`API：[http ://api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)

许多 JavaScript 库使用 $ 作为函数或变量名，就像 jQuery 一样。在 jQuery 的例子中，$ 只是 jQuery 的别名，所以所有功能都可以在不使用 $ 的情况下使用。如果我们需要在 jQuery 旁边使用另一个 JavaScript 库，我们可以通过调用 $.noConflict() 将 $ 的控制权返回给另一个库：

[http://api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)

```
jQuery.noConflict();
(function($) { 
  $(function() {
    // more code using $ as alias to jQuery
  });
})(jQuery);
// other code using $ as an alias to the other library 
```

在“无冲突”模式下，$ 快捷方式不可用，使用较长的 jQuery。例如：

```
$(document).ready(function(){
     $(#somefunction) ...
}); 
```

变成：

```
jQuery(document).ready(function(){
    jQuery(#somefunction) ...
}); 
```

为了使用 $ 的默认 jQuery 快捷方式，您可以在代码周围使用以下包装器：

```
jQuery(document).ready(function($) {
    // $() will work as an alias for jQuery() inside of this function
}); 
```

该包装器将导致您的代码在页面完成加载时执行，并且 $ 将用于调用 jQuery。如果出于某种原因，您希望您的代码立即执行（而不是等待 DOM 就绪事件），那么您可以使用此包装器方法：

```
(function($) {
    // $() will work as an alias for jQuery() inside of this function
})(jQuery); 
```

**好读：** [http ://codex.wordpress.org/Function_Reference/wp_enqueue_script#jQuery_noConflict_wrappers](http://codex.wordpress.org/Function_Reference/wp_enqueue_script#jQuery_noConflict_wrappers)

**进一步，如果你热衷：**

[jQuery 中的 $ 是什么意思？](https://stackoverflow.com/questions/7486661/what-does-mean-in-jquery)

这应该有助于解渴`:)`可能希望这会有所帮助！

[在 iife 中理解 $ vs. jQuery 而不是 $](https://stackoverflow.com/questions/11403266/understanding-vs-jquery-in-iife-instead-of/11403349#11403349)

**更新**请注意，您需要仔细检查其他地方并执行此操作，其余冲突将得到解决。

```
jQuery.noConflict();
(function($){

 $countForms = 1;

      $.fn.addForms = function(idform){

                    var myform = "<table>"+
                     "  <tr>"+
                     "     <td>Field A ("+$countForms+"):</td>"+
                     "     <td><input type='text' name='field["+$countForms+"][a]'></td>"+
                     "     <td>Field B ("+$countForms+"):</td>"+
                     "     <td><textarea name='field["+$countForms+"][b]'></textarea></td>"+
                     "     <td><button>remove</button></td>"+
                     "  </tr>"+
                     "</table>";

                    if(idform=='mybutton'){

                        myform = $("<div>"+myform+"</div>");
                        $("button", $(myform)).click(function(){ $(this).parent().parent().remove(); });
                        $(this).append(myform);
                        $countForms++;
                    }

      };
})(jQuery); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T14:14:33.460

您的问题在于您附加字段的位置。您正在表单之外添加表单域。

您附加表格的逻辑：

```
if(idform=='mybutton'){
    myform = $("<div>"+myform+"</div>");
    $("button", $(myform)).click(function(){
        $(this).parent().parent().remove();
    });
    $(this).append(myform);
    $countForms++;
} 
```

应该：

```
if(idform=='mybutton'){
    myform = $("<div>"+myform+"</div>");
    $("button", $(myform)).click(function(){
        $(this).parent().parent().remove();
    });
    $("formelement").append(myform);
    $countForms++;
} 
```

假设您修改表单标记以分配 id `formelement`。根据需要进行调整。

# graphics - Debian Sqeeze 问题 - GPU 挂起

> ID：11441984
> 
> 赞同：0
> 
> 时间：2012-07-11T21:46:14.590
> 
> 标签：graphics, hardware, debian, driver, linux-device-driver

这发生在我使用英特尔显卡在我的 Zenith PC 上执行全新安装 Debian Squeeze 6.0.5 之后。安装很顺利，Gnome 桌面非常快速且响应迅速。但是，有时桌面会在某些事件中冻结。这发生在几次：

1.  当我在顿悟浏览器中打开一个 html 文件时。
2.  用户退出。
3.  插入了闪存驱动器。

当桌面冻结时，我通过按 alt+f1 切换到 tty 终端并执行 root 登录。然后，当我尝试切换到主桌面时，我在黑屏上阅读了以下内容：

```
X.Org X Server 1.7.7
Release Date: 2010-05-04
X Protocol Version 11, Revision 0
Build Operating System: Linux 2.6.32-5-amd64 i686 Debian
Current Operating System: Linux workstation1 2.6.32-5-686 #1 SMP Sun May 6 04:01:19........
Kernel Command Line....
...
...
..
FATAL: Module fbcon not found.
SELinux: Disabled on system, not enabling in X server
(EE) Intel(0): Detected a hung GPU, disabling acceleration. 
```

对我来说，这似乎是与驱动程序相关的问题，尽管它也可能是与 X 相关的问题。我的显卡类型：

```
Intel(R) 82845G/GL/GE/PE/GV Graphics Controller 
```

有没有办法知道 Debian 是否安装了正确的驱动程序？我确实有我的 PC 附带的所有驱动程序 CD，但它们是专门用于 Windows 操作系统的。

你们中的任何一位 Debian 专家可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:59:27.880

其他人似乎对该芯片组也有问题： http://forums.debian.net/viewtopic.php?f=7& [t=71083](http://forums.debian.net/viewtopic.php?f=7&t=71083)

你可以给 vesa 驱动程序一个旋转，看看它是否有效： [http ://packages.debian.org/sid/xserver-xorg-video-vesa](http://packages.debian.org/sid/xserver-xorg-video-vesa)

请记住删除其他驱动程序。我不是 Debian 用户，但您应该能够列出已安装的软件包：

```
dpkg -l 
```

如果列表太长，只需 grep 获取 xserver 或 xorg。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T18:44:41.880

我运行了命令：`Xorg -configure`. 在做了一些研发之后，在编辑 xorg.conf 之后，这对我有用：

```
Option "DRI" "false"
Option "Tiling" "false"
Option "Shadow" "true" 
```

现在我的桌面运行坚如磐石而不会挂起。为了验证，我故意尝试通过打开浏览器、终端、突触（甚至是 Eclipse！）的几个实例来关闭系统，这个设置没有失败。当然，当我对它进行“压力测试”时，从 xorg.conf 中删除这些设置再次导致我的桌面冻结。

# ruby - 使用 watir-webdriver（或 Ruby 中的任何其他方式）抓取 POST 请求 AJAX 网页？

> ID：11441985
> 
> 赞同：0
> 
> 时间：2012-07-11T21:46:22.200
> 
> 标签：ruby, screen-scraping, web-scraping, watir-webdriver, http-post

我正试图从[棕榈滩县治安官办公室的警察记录纸上获取逮捕数据。](http://www.pbso.org/index.cfm?fa=blotter)

我将搜索范围限制在西棕榈滩市，追溯数据（1974 年 10 月 31 日）。

我正在使用火狐。

当我得到结果时，我打开 FireBug，检查 HTML 选项卡，我可以从页面中看到我想要的信息（即被捕者的姓名、逮捕地址、指控等）。

我检查了 Net>>XHR>>Post 选项卡以找到 POST 请求参数，但将其放入我的代码中没有任何作用。我完全是 watir-webdriver 的新手，这可能无济于事。

这是我的代码：

```
require 'watir-webdriver'
require 'net/http'
require 'uri'

b = Watir::Browser.new
b.goto 'http://www.pbso.org/index.cfm?fa=blotter'
b.text_field(:name => 'start_date').set '01/01/1900'
b.text_field(:name => 'city_name').set 'West Palm Beach'
b.button(:name => 'process').click 
```

有谁知道是否可以获得响应页面 HTML（即包含姓名、地址、犯罪等的 HTML）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T00:22:55.047

如果要获取页面的 HTML，可以执行以下操作：

```
puts b.html 
```

或者将其限制为包含数据的表的 HTML：

```
puts b.table(:class, 'contentTxt').html 
```

尽管您必须遍历所有结果页面。所以像这样，请注意您需要等到每次导航后出现结果。

```
at_end = false
begin
  #Wait until the results appear
  b.table(:class, 'contentTxt').wait_until_present

  #Output the results
  puts b.table(:class, 'contentTxt').html

  #Go to next page if it exists
  if b.link(:text => /Next/, :class => 'contentTxt').exists?
    b.link(:text => /Next/, :class => 'contentTxt').click
  else 
    at_end = true
  end
end until at_end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-12T01:57:07.803

那个看起来还不错，我会用 mechanize 代替：

```
require 'mechanize'
agent = Mechanize.new
form = agent.get('http://www.pbso.org/index.cfm?fa=blotter').forms[0]
form['captcha_id'] = -1

# page 1 of results
page = form.submit

# page 2 of results
form['fromrec'] = form['fromrec'].to_i + 5
page = form.submit 
```

watir-webdriver 和 ajax 更新结果的问题是当曾经存在的 dom 元素突然消失时会出现错误

# javascript - 文本节点的大小会影响 DOM 遍历的速度吗？

> ID：11441991
> 
> 赞同：0
> 
> 时间：2012-07-11T21:47:00.757
> 
> 标签：javascript, performance, dom

我有一个相当大的单页应用程序，大约 800K。大约 500K 是发送到客户端的数据。`<script>`我正在考虑在标签的头部移动一些只是 json 字符串的元素。

当浏览器遍历 DOM 时，它是否也在`<head>`标签中查找（在这种情况下不会有任何好处），遍历是否只发生在`<body>`标签内部？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T21:49:24.650

使用时`document.querySelectorAll("some selector example")`，头部中的元素也会被考虑。这可以通过使用以下方法轻松解决：

```
document.body.querySelectorAll("...") 
```

这同样适用于`getElementsByTagName`, `getElementsByClassName`,`querySelector`等。
但不适用于`getElementById`，因为 id 在文档中必须是唯一的，因此限制上下文没有意义。

顺便说一句，文本也是一种节点类型。`<script> ...500kb... </script>`生成以下 DOM 树：

```
SCRIPT
    #text 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-11T21:59:15.037

如果可以的话，我会尝试重构数据从服务器返回的方式，而不是将内容转移到浏览器可能解析或不解析的地方。

也许有一个快速响应，只返回基本信息，然后对另一个请求做出更全面的响应。

我也有一个可以创建这么多数据的网络服务。 **800K**对我来说也是极限，但我已经使端点更加具体以限制该数据。

干杯格伦

# oracle - oracle完整性约束

> ID：11441993
> 
> 赞同：2
> 
> 时间：2012-07-11T21:47:04.863
> 
> 标签：oracle

这是我第一次使用 Oracle。

我手动在数据库中插入了一些东西：

```
insert into ATTR_TYPE_VALUE (ATTR_TYPE_ID, VALID_VALUE, CREATED_BY) 
(select ATTR_TYPE_ID, 'Ad', 2 from ATTR_TYPE where VALUE = 'ind') 
```

我收到以下错误：

> 第 1 行出现错误：ORA-02291：违反完整性约束 (LO.ATTR_TYPE_VALUE_FK02) - 未找到父键

这是我在研究中发现的：

对于插入语句，当您尝试插入没有匹配父项的子项时，此 ORA-02291 错误很常见，如外键约束所定义。在这种情况下，您需要将父行添加到表中，然后重新插入子表行。

这是否意味着表`VALUE='ind'`中不存在`ATTR_TYPE`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-11T22:12:35.483

定义了哪些列`ATTR_TYPE_VALUE_FK02`以及您引用了哪些表和列？

```
SELECT fk_columns.table_name,
       fk_columns.column_name,
       fk_columns.position,
       pk_columns.table_name,
       pk_columns.column_name,
       pk_columns.position
  FROM all_constraints fk_constraint,
       all_cons_columns fk_columns,
       all_cons_columns pk_columns
 WHERE fk_constraint.owner             = 'LO'
   AND fk_constraint.constraint_name   = 'ATTR_TYPE_VALUE_FK02'
   AND fk_constraint.owner             = fk_columns.owner
   AND fk_constraint.constraint_name   = fk_columns.constraint_name
   AND fk_constraint.r_owner           = pk_columns.owner
   AND fk_constraint.r_constraint_name = pk_columns.constraint_name 
```