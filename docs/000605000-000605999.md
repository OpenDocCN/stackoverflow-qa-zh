# StackOverflow 问答 000605000-000605999

# css - FF 帮助中的自动换行/中断？

> ID：605007
> 
> 赞同：0
> 
> 时间：2009-03-03T03:35:42.473
> 
> 标签：css, internet-explorer, firefox

我正在建立新的网站 FF 和 IE 兼容...在 Firefox 中用句子换行填充容器的最佳方法是什么？这在 IE 中有效，没有任何问题。

目前我正在使用以下文档类型 `<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">`

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T21:10:11.583

尝试了一个测试用例：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<style>
.articleContent { width:200px;
}
</style>
</head>
<body>
<table><tr><td> <div class="articleContent" > this is a sentence that goes on and on. this is a sentence that goes on and on. this is a sentence that goes on and on. this is a sentence that goes on and on. this is a sentence that goes on and on. </div> </td></tr></table>
</body>
</html> 
```

在 FF/konq 中渲染良好。听起来你的 CSS 在某处被覆盖了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T20:40:19.127

尝试将以下内容添加到您的 CSS

```
#container {overflow: auto;} 
```

或者

```
#container {overflow: hidden;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-20T03:18:19.440

你可能意味着类似的东西

```
div.mydiv {
    width: 400px;
    height: auto;
    text-align: justify;
    overflow: hidden;
} 
```

我不认为单词之间有任何控制中断：它们总是在必要时出现。

# c# - 多人纸牌游戏的游戏架构和设计策略

> ID：605009
> 
> 赞同：9
> 
> 时间：2009-03-03T03:36:07.513
> 
> 标签：c#, .net, design-patterns, playing-cards

我对游戏开发还比较陌生，所以我决定从头开始创建一个爱好项目，既可以体验又可以娱乐。特定的游戏类似于被称为[三张牌吹牛](http://en.wikipedia.org/wiki/Three_card_brag)的扑克。该游戏在电影*Lock, Stock 和 Two Smoking Barrels*中播放。

我一直在阅读一些关于游戏开发的 SO 主题，尽管主要是[这个问题](https://stackoverflow.com/questions/361002/any-patterns-for-modelling-board-games)。这有助于改进我创建对象的原始方式。

我遇到的一个特殊问题是定义游戏状态。我最初的方法是将所有内容分开（例如将筹码堆放在一个`Player`类中），但是在阅读了对我之前提到的[问题](https://stackoverflow.com/questions/361002/any-patterns-for-modelling-board-games)的回答之后，似乎游戏的所有可能状态都应该在一个`GameState`对象中维护。我想出的基本上是这样的：

```
abstract class CardGameState
{
    protected List<Player> _Players;
    protected Player _CurrentPlayer;
    protected Dictionary<Player, int> _Chips;
    protected Dictionary<Player, Hand> _CurrentHand;
    protected Dictionary<Player, PlayerStatuses> _PlayerStatus; // PlayerStatuses.InHand, PlayerStatuses.Folded, PlayerStatuses.SittingOut, etc.
    /* etc. */ 
```

其中每个`CardGameState`都通过一些操作进行修改：

```
public interface IAction
{
    string Name { get; }

    CardGameState Apply(CardGameState state);
    bool IsLegal(CardGameState state);
} 
```

现在我强烈地感觉到这违背了面向对象编程的目的，因为与玩家相关的数据（在这种情况下，是他的筹码堆、手牌和当前状态）没有被`Player`对象封装。

另一方面，如果玩家加注，我将创建一个`RaiseAction`that implements `IAction`，但接口只接受当前游戏状态，如果筹码堆存储在类`IAction`中，我认为这不是理想的`Player`.

基本上，我的问题是：我是否可以两全其美，这样我就可以准确表示游戏状态，同时将所有与游戏状态中的对象特别相关的数据保存在给定对象中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T04:20:45.097

在在线游戏中，使用[命令模式](http://en.wikipedia.org/wiki/Command_pattern)（您的 IAction）是标准且经过验证的方法。它不是玩家意义上的面向对象，但动作是面向对象的，所以从纯理论的角度来看，我猜它是一个可靠的设计模式。在实践中，我见过的每一个成功的在线游戏都是这样实现它的，但请注意，动作游戏通常使用非常小的谨慎的动作/数据包，直到它实际上变成一种流。

**编辑：**

在我回答这个问题很长时间后，我回到这里并意识到这个问题的另一个解决方案是实现 GameState 的 Players、Decks 等......它是从具有**Apply(IAction action)**成员的**IState**类派生的。这种方式对象对自己应用动作，而不是让应用程序对对象应用动作，这会将动作和状态映射到[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)而不是命令模式。任何一种解决方案都可以工作，visitor 的开销更大，封装更多，而 command 是更简单的解决方案，封装更少。

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T04:08:55.700

似乎您可能为了面向对象而将其面向对象...

看起来像鲍勃马丁的经典[保龄球游戏](http://www.objectmentor.com/resources/articles/xpepisode.htm)问题。

编辑：-总结-
这是一篇长篇文章，但基本上，通过 TDD 和重构，保龄球评分应用程序从一个包含大量类和多态性的巨大集群变为 20 或 30 行优雅的代码。为什么？因为他们一开始并不真的需要在那里

# c# - 如何在 LINQ 中使用项目列表执行 Contains()？

> ID：605012
> 
> 赞同：1
> 
> 时间：2009-03-03T03:36:40.600
> 
> 标签：c#, dynamic-linq

我想构建一个 dlinq 查询来检查标题中是否包含任意数量的项目。我知道您可以`.Contains()`使用列表，但我需要检查标题是否包含任何项目，而不是项目是否包含标题的一部分。例如：我在列表*“培根、鸡肉、猪肉”*中有三个项目。*我需要“鸡屋”*的标题来匹配。

```
 var results = (from l in db.Sites
   where list.Contains(l.site_title)
   select l.ToBusiness(l.SiteReviews)).ToList(); 
```

如果我尝试前 2 个答案，我会收到错误消息`"Local sequence cannot be used in LINQ to SQL implementation of query operators except the Contains() operator."`

第三个解决方案给了我

> 方法 'System.Object DynamicInvoke(System.Object[])' 不支持对 SQL 的转换。”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T03:40:42.307

试试下面的。您可以结合使用 Where 和 Any 来搜索子字符串匹配项。

```
var results = (from l in db.Sites
                where list.Where(x => 0 != x.IndexOf(l)).Any()
                select l.ToBusiness(l.SiteReviews)).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T06:42:53.477

一种方法是动态构建查询，如下所述：

[http://andrewpeters.net/2007/04/24/dynamic-linq-queries-contains-operator/](http://andrewpeters.net/2007/04/24/dynamic-linq-queries-contains-operator/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T04:54:03.243

我终于弄明白了。感谢我的好伙伴科里的帮助。有两种方法可以做到。

```
var resultSets = (from k in list
                  select (from b in db.Sites
                          where b.site_title.Contains(k)
                          select b.ToBusiness()).ToList<Business>()).ToList();

 List<Business> all = new List<Business>();

 for (int i = 0; i < resultSets.Count; ++i)
 {
     all.AddRange(resultSets[i]);
 } 
```

这是一个 linq 查询，它将成功地执行所述操作。同样，您也可以手动以纯文本形式构建 sql 查询。

# python - python：如何在多线程中发送数据包然后线程杀死自己

> ID：605013
> 
> 赞同：5
> 
> 时间：2009-03-03T03:37:31.423
> 
> 标签：python, multithreading, sockets, timer, packet

我有个问题。我想使用 python 在一定时间内（比如说 1 分钟）向某个主机发送连续的字节流。

到目前为止，这是我的代码：

```
#! /usr/bin/env python                                                          

import socket
import thread
import time

IP = "192.168.0.2"
PADDING = "a" * 1000 #assume the MTU is slighly above 1000
DATA = PADDING + "this is sentence number = "
PORT = 14444
killed = False
test_time = 60 #60 seconds of testing

def send_data():
  s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
  s.connect((IP, PORT))
  count = 1
  starttime = time.clock()
  while elapsed < test_time:
    sent = s.send(DATA + str(count) + "\n")
    if sent == 0: break # assume that if nothing is sent -> connection died
    count = count+1
    elapsed = time.clock() - starttime
    if killed:
      break
  s.close()
  print str(count) + " has been sent"

print "to quit type quit"
thread.start_new_thread(send_data, ())

while True:
  var = raw_input("Enter something: ")
  if var == "quit":
    killed = True 
```

很少有人问，除了每次轮询 time.clock 之外，有没有更好的方法让线程在 60 秒后死掉？当我运行这个程序时，它会正确发送字节，但是当我输入退出时，另一个线程不会死，即使我设置了 var kill = True。我想知道这是为什么？var Killed 的范围应该到达另一个线程吧？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T10:20:58.130

I recommned using threading module. Even more benefit is to use InterruptableThread for terminating the thread. You do not have to use flag for terminating your thread but exception will occur if you call terminate() on this thread from parent. You can handle exception or not.

```
import threading, ctypes

class InterruptableThread(threading.Thread):
@classmethod
def _async_raise(cls, tid, excobj):
    res = ctypes.pythonapi.PyThreadState_SetAsyncExc(tid, ctypes.py_object(excobj))
    if res == 0:
        raise ValueError("nonexistent thread id")
    elif res > 1:
        ctypes.pythonapi.PyThreadState_SetAsyncExc(tid, 0)
        raise SystemError("PyThreadState_SetAsyncExc failed")

def raise_exc(self, excobj):
    assert self.isAlive(), "thread must be started"
    for tid, tobj in threading._active.items():
        if tobj is self:
            self._async_raise(tid, excobj)
            return

def terminate(self):
    self.raise_exc(SystemExit) 
```

**EDIT:** You can rewrite your code like this using another thread that is waiting 1 minute and then killing your other thread

```
def send_data:
    IP = ...
    # other vars

    ...
    s = socket.socket(.....)

    # no killed checking
    # no time checking
    # just do your work here
    ...
    s.close()

my_thread = InterruptableThread(target=send_data)
my_thread.start()

def one_minute_kill(who):
   time.sleep(60)
   who.terminate()

killer_thread = InterruptableThread(target=one_minute_kill, args=[my_thread])
killer.start()

print "to quit type quit"
while my_thread.isAlive():
  if raw_input("Enter something: ") == "quit":
    my_thread.terminate() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T05:48:02.203

我不知道如何使用“线程”模块来做到这一点，但我可以使用“线程”模块来做到这一点。我认为这段代码完成了你想要的。

有关线程模块的文档：http: [//docs.python.org/library/threading.html](http://docs.python.org/library/threading.html)

```
#!/usr/bin/python

import time
from threading import Thread
import threading
import sys

test_time = 10
killed = False

class SillyThread( threading.Thread ):
    def run(self):
        global killed
        starttime = time.time()
        counter = 0
        while (time.time() - starttime) < test_time:
            if killed:
                break
            counter = counter + 1
            time.sleep(0.1)
        print "I did %d loops" % counter

class ManageThread( threading.Thread ):
    def run(self):
        global killed
        while True:
            var = raw_input("Enter something: ")
            if var == "quit":
                killed = True
                break
        print "Got var [%s]" % var

silly = SillyThread()
silly.start()
ManageThread().start()
Thread.join(silly)
print "bye bye"
sys.exit(0) 
```

请注意，我使用 time.time() 而不是 time.clock()。time.clock() 给出了 Unix 上经过的处理器时间（参见[http://docs.python.org/library/time.html](http://docs.python.org/library/time.html)）。我认为 time.clock() 应该在任何地方都可以使用。我将 test_time 设置为 10 秒，因为我一分钟都没有耐心。

如果我让它运行整整 10 秒，会发生以下情况：

```
leif@peacock:~/tmp$ ./test.py
Enter something: I did 100 loops
bye bye 
```

如果我输入“退出”，会发生以下情况：

```
leif@peacock:~/tmp$ ./test.py
Enter something: quit
Got var [quit]
I did 10 loops
bye bye 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-14T02:05:32.617

你可以很容易地做到这一点，而无需线程。例如，使用 Twisted，您只需设置一个定时调用和一个生产者：

```
from twisted.internet.protocol import ClientFactory, Protocol
from twisted.internet import reactor

class Noisy(Protocol):
    def __init__(self, delay, data):
        self.delay = delay
        self.data = data

    def stop(self):
        self.transport.unregisterProducer()
        self.transport.loseConnection()
        reactor.stop()

    def resumeProducing(self):
        self.transport.write(self.data)

    def connectionMade(self):
        self.transport.registerProducer(self, False)
        reactor.callLater(self.delay, self.stop)

factory = ClientFactory()
factory.protocol = lambda: Noisy(60, "hello server")
reactor.connectTCP(host, port, factory)
reactor.run() 
```

与线程方法相比，这具有各种优势。它不依赖守护线程，因此您实际上可以清理网络连接（例如，在必要时发送关闭消息）而不是依赖平台来破坏它。它为您处理所有实际的低级网络代码（您的原始示例在 socket.send 返回 0 的情况下做错了事情；此代码将正确处理这种情况）。您也不必依赖 ctypes 或晦涩的 CPython API 来在另一个线程中引发异常（因此它可以移植到更多版本的 Python 并且实际上可以立即中断阻塞的发送，这与其他一些建议的方法不同）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T06:11:08.777

如上所述，使用[threading](http://docs.python.org/library/threading.html)模块，它更容易使用并提供了几个同步原语。它还提供了一个在指定时间后运行的[Timer类。](http://docs.python.org/library/threading.html#id7)

如果您只想让程序退出，您可以简单地将发送线程设置为守护进程。您可以通过在调用 start() 之前调用 setDaemon(True) 来做到这一点（2.6 可能会使用守护进程属性）。只要非守护线程正在运行，Python 就不会退出。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T03:43:47.370

确保“退出”正常工作，并添加一个小字来测试输入是否正常工作。

```
if var == "quit":
 print "Hey we got quit" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T04:11:21.093

变量 elapsed 未初始化。在 while 循环上方将其设置为零。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T03:54:32.547

测试范围很容易`killed`：

```
>>> import thread
>>> killed = False
>>> import time
>>> def test():
...  while True:
...   time.sleep(1)
...   if killed:
...     print 'Dead.'
...     break
... 
>>> thread.start_new_thread(test, ())
25479680
>>> time.sleep(3)
>>> killed = True
>>> Dead. 
```

# ios - UIScrollView 暂停 NSTimer 直到滚动完成

> ID：605027
> 
> 赞同：85
> 
> 时间：2009-03-03T03:40:54.303
> 
> 标签：ios, uiscrollview, nstimer

当 a `UIScrollView`（或其派生类）正在滚动时，似乎所有`NSTimers`正在运行的都暂停，直到滚动完成。

有没有办法解决这个问题？线程？优先级设置？任何事物？

* * *

## 回答 #1

> 赞同：204
> 
> 时间：2010-04-30T04:23:32.757

一个易于实施的解决方案是：

```
NSTimer *timer = [NSTimer timerWithTimeInterval:... 
                                         target:...
                                       selector:....
                                       userInfo:...
                                        repeats:...];
[[NSRunLoop mainRunLoop] addTimer:timer forMode:NSRunLoopCommonModes]; 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2016-10-18T19:43:01.397

对于任何使用 Swift 3 的人

```
timer = Timer.scheduledTimer(timeInterval: 0.1,
                            target: self,
                            selector: aSelector,
                            userInfo: nil,
                            repeats: true)

RunLoop.main.add(timer, forMode: RunLoopMode.commonModes) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-03T14:42:38.627

是的，Paul 是对的，这是一个运行循环问题。具体来说，您需要使用 NSRunLoop 方法：

```
- (void)addTimer:(NSTimer *)aTimer forMode:(NSString *)mode 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-03T04:44:07.287

如果您希望计时器在滚动时触发，则必须运行另一个线程和另一个运行循环；由于计时器是作为事件循环的一部分处理的，因此如果您正忙于处理滚动视图，则永远不会使用计时器。尽管在其他线程上运行计时器的性能/电池损失可能不值得处理这种情况。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-01-05T05:56:23.207

这是快速版本。

```
timer = NSTimer.scheduledTimerWithTimeInterval(0.01, target: self, selector: aSelector, userInfo: nil, repeats: true)
            NSRunLoop.mainRunLoop().addTimer(timer, forMode: NSRunLoopCommonModes) 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2020-01-27T23:28:45.753

tl; dr runloop 正在处理与滚动相关的事件。它无法处理更多事件——除非您手动更改计时器的配置，以便在 runloop 处理*触摸*事件时处理*计时器。*或尝试替代解决方案并使用 GCD

 ** * *

iOS 开发者必读。很多事情最终都是通过RunLoop来执行的。

源自[Apple 的 docs](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/Multithreading/RunLoopManagement/RunLoopManagement.html)。

## 什么是运行循环？

> 运行循环非常像它的名字听起来。它是您的线程进入并用于运行事件处理程序以响应传入事件的循环

## 事件的传递是如何中断的？

> 因为在运行运行循环时会传递计时器和其他周期性事件，所以绕过该循环会中断这些事件的传递。每当您通过进入循环并重复从应用程序请求事件来实现鼠标跟踪例程时，就会出现这种行为的典型示例。因为您的代码是直接抓取事件，而不是让应用程序正常分派这些事件，所以在您的鼠标跟踪例程退出并将控制权返回给应用程序之前，活动计时器将无法触发。

## 如果在 run loop 执行过程中触发 timer 会发生什么？

这种情况发生了很多次，我们都没有注意到。我的意思是我们将计时器设置为在 10:10:10:00 触发，但是 runloop 正在执行一个持续到 10:10:10:05 的事件，因此计时器在 10:10:10:06 触发

> 类似地，如果在 run loop 正在执行处理程序例程的中间时触发计时器，则计时器将等待直到下一次通过 run loop 来调用其处理程序例程。如果运行循环根本没有运行，则计时器永远不会触发。

## 滚动或任何使运行循环保持忙碌的东西会在我的计时器将要触发的所有时间转移吗？

> 您可以将计时器配置为仅生成一次或重复生成事件。重复计时器会根据计划的触发时间而不是实际的触发时间自动重新调度自身。例如，如果定时器计划在特定时间触发，并且此后每 5 秒触发一次，则计划的触发时间将始终落在原始的 5 秒时间间隔上，即使实际触发时间延迟也是如此。如果触发时间延迟太多以至于错过了一个或多个预定的触发时间，则计时器在错过的时间段内仅触发一次。在错过的时段触发后，计时器将重新安排到下一个预定的触发时间。

## 如何更改 RunLoops 的模式？

你不能。操作系统只会为您改变自己。例如，当用户点击时，模式切换到`eventTracking`。用户点击完成后，模式返回`default`。如果您希望某些东西在特定模式下运行，那么由您来确保发生这种情况。

* * *

# 解决方案：

当用户滚动时，运行循环模式变为[`tracking`](https://developer.apple.com/documentation/foundation/runloop/mode/1428765-eventtracking)。RunLoop 设计用于换档。一旦模式设置为`eventTracking`，它就会优先处理触摸事件（记住我们的 CPU 内核有限）。[这是操作系统设计者的架构设计](https://stackoverflow.com/a/7223765/5175709)。

默认情况下，计时器不会安排在该`tracking`模式上。他们安排在：

> 创建一个计时器并将其安排在 **默认**模式下的当前运行循环中。

下面是这样做的[`scheduledTimer`](https://developer.apple.com/documentation/foundation/timer/1412416-scheduledtimer) ：

```
RunLoop.main.add(timer, forMode: .default) 
```

如果您希望计时器在滚动时工作，那么您必须执行以下任一操作：

```
let timer = Timer.scheduledTimer(timeInterval: 1.0, target: self,
 selector: #selector(fireTimer), userInfo: nil, repeats: true) // sets it on `.default` mode

RunLoop.main.add(timer, forMode: .tracking) // AND Do this 
```

或者只是这样做：

```
RunLoop.main.add(timer, forMode: .common) 
```

最终执行上述任一操作意味着您的线程*不会*被触摸事件阻塞。这相当于：

```
RunLoop.main.add(timer, forMode: .default)
RunLoop.main.add(timer, forMode: .eventTracking)
RunLoop.main.add(timer, forMode: .modal) // This is more of a macOS thing for when you have a modal panel showing. 
```

* * *

## 替代解决方案：

您可以考虑将 GCD 用于您的计时器，这将帮助您“保护”您的代码免受运行循环管理问题的影响。

对于非重复使用：

```
DispatchQueue.main.asyncAfter(deadline: .now() + 5) {
    // your code here
} 
```

对于重复计时器，请使用：

了解[如何使用 DispatchSourceTimer](https://stackoverflow.com/a/25952724/5175709)

* * *

从我与 Daniel Jalkut 的讨论中深入挖掘：

问题：GCD（后台线程）（例如后台线程上的 asyncAfter）如何在 RunLoop 之外执行？我的理解是，一切都将在 RunLoop 内执行

不一定 - 每个线程最多有一个运行循环，但如果没有理由协调线程的执行“所有权”，则可以为零。

线程是一种操作系统级别的功能，它使您的进程能够在多个并行执行上下文中拆分其功能。运行循环是一种框架级别的功能，它允许您进一步拆分单个线程，以便多个代码路径有效地共享它。

通常，如果您调度在线程上运行的东西，它可能不会有运行循环，除非调用`[NSRunLoop currentRunLoop]`会隐式创建一个运行循环。

简而言之，模式基本上是输入和计时器的过滤机制

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-02-27T08:12:35.807

对于任何使用 Swift 4 的人：

```
 timer = Timer(timeInterval: 1, target: self, selector: #selector(timerUpdated), userInfo: nil, repeats: true)
    RunLoop.main.add(timer, forMode: .common) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-02-19T21:53:12.977

在 swift 5 中测试

```
var myTimer: Timer?

self.myTimer= Timer.scheduledTimer(withTimeInterval: 1, repeats: true) { timer in
      //your code
}

RunLoop.main.add(self.myTimer!, forMode: .common) 
```

# c++ - C++：从类内访问 operator[] 的便捷方式？

> ID：605037
> 
> 赞同：48
> 
> 时间：2009-03-03T03:46:22.043
> 
> 标签：c++, operator-overloading

`operator[]`我有一个重载数组下标/括号运算符的 C++ 类。这在我的课外非常方便，我可以在那里写`foo[bar`]。*但是，当我在*我的类中实现方法时，我不知道如何使用这种表示法。

我知道我可以写`operator[](bar)`，`this->operator[](bar)`但是这些都相当笨拙，并且首先剥夺了操作员的很多便利。（我也知道我可以添加一个调用运算符的新方法。）有没有一种我可以编写`this[bar]`或`this->[bar]`类似的好方法？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-03-03T03:47:52.443

```
(*this)[bar]; 
```

对我来说很好。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-03T03:48:42.957

采用

```
(*this)[bar] 
```

调用`operator[]`实例对象的。

假设`bar`是一个整数（或者可以自动转换为一个），`this[bar]`将`this`指针视为一个数组并索引该数组的`bar`第 -th 个元素。除非`this`在数组中，否则将导致未定义的行为。如果`bar`不是类似整数，则预计会出现编译时错误。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-03T04:14:51.490

我使用 at() 函数，并让 operator[] 在幕后调用 at() 函数，因此 operator[] 只是语法糖。这就是 std::vector 的做法，所以这似乎是一种合理的（优先）方式。

现在来看一个完整的语法糖破解（不能说我完全推荐它，但可能会让你喜欢）：

```
class Widget
{
    Widget&     self;
public:
    Widget() :self(*this)
    {}

    void operator[](int)
    {
        printf("hello");
    }

    void test()
    {
        //scripting like sugar
        //you pay the price of an extra reference per class though
        self[1]; 
    }
};

int main(int argc, char* argv[])
{
    Widget w;
    w[1];
    w.test();
    return 0;
} 
```

此外，如果您想免费执行此操作，无需支付参考费用，**并且**是某个致力于让程序员受苦的邪恶教派的追随者，您可以这样做：

```
#define self (*this) 
```

实际上，我认为这就是大多数句柄在 Apple 的 NS API 中实现的方式......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-03T04:09:50.160

另一种方法`(*this)[bar]`是使用命名成员函数来完成`operator[]`. 重载的运算符使您的用户更轻松。更重要的是，它们是您班级**界面**的一部分。问问自己，根据自己的公共接口来实现你的类是否真的有意义。如果没有，我建议编写一个单独的（受保护的或私有的）成员函数来完成这项工作，然后让`operator[]`任何其他函数调用它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-15T19:57:50.943

```
 operator[](bar) 
```

这也应该有效。这个对我有用！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T03:48:47.200

您可以使用**(*this)[bar]**，但这可能不会有太大的改进......

# c - 用 C 编写网站？

> ID：605064
> 
> 赞同：6
> 
> 时间：2009-03-03T04:04:48.147
> 
> 标签：c

我刚刚在阅读[http://www.meebo.com/](http://www.meebo.com/)关于我们页面，并阅读了这一行：“另外，我们是少数仍在使用 C 的人之一！”

考虑到 meebo 是一个在线聊天客户端，它们如何与 C 一起工作？他们如何使用 C 作为后端？它如何与前端交互？例如，假设用户创建了一个新帐户，并且要创建新目录，那么信息如何从前端到后端？

如果这是一个无效的问题，我很抱歉。

谢谢

编辑 1：CGI 简介教程很棒。我可以从我的图书馆中找到任何关于这方面的好书吗？

非常感谢小伙伴们的快速回复！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-03T04:07:49.980

我不知道 meebo 是如何做到的，但鉴于它是聊天软件，他们可能有一个用 C 编写的自定义服务器来处理实际的消息流量。

但是，Apache 和大多数其他 HTTP 服务器始终能够调用 C 程序，就像它们可以为某些请求调用 PHP、CGI 和其他语言一样。有些网站甚至是用 Lisp 编写的。

与解释性语言不同，每次都必须编译后端，但这发生在推出时，并且是构建/生产脚本的一部分。

必须仔细选择 C ​​程序运行的权限和用户帐户，当然 C 网站会遇到任何其他 C 程序可能遇到的相同问题，例如缓冲区溢出、segfault、stackoverflow 等。只要您以减少的权限运行它，您会受到更好的保护，并且它并不比任何其他语言/平台/架构差。

然而，对于服务器，它仍然被广泛使用——我想这是黄金标准。你可以找到很多用 Java、C++ 和其他所有语言编写的服务器，但 C 似乎仍然存在。

-亚当

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T04:09:50.800

Meebo 使用一个名为[mod_meebo](https://web.archive.org/web/20120419200829/http://blog.meebo.com/?p=49)的自定义 Lighttpd 模块。它没有完全回答你的问题，但我想你可能会感兴趣。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T04:36:46.413

我已经在 50 行代码（稀疏）或几百行（更好），最多约 5k（安全）中推出了非阻塞 HTTP 1.1 服务器。服务器会将动态共享对象作为模块加载以处理特定类型的请求。

父代码将处理连接跟踪、保持活动、GET/POST/HEAD 请求并将它们提供给在启动时加载的处理程序。当我在嵌入式设备上使用非常小的肘部空间时，我这样做了，这些设备必须具有某种基于 Web 的控制面板 .. 特别是控制电源插座的设备。

每个 DSO 的入口点由所使用的 URL 和方法定义（即 /foo 的行为取决于它所服务的请求类型）。

我的小服务器做得很好，可以处理大约 150 个没有分叉或线程的客户端，甚至还有一个不错的小模板系统，因此 UI 人员无需手持即可修改页面。

我绝对**不会**在任何类型的生产站点上使用这种设置，即使是带有留言簿的基本 hello world 主页。

现在，如果我所要做的就是监听端口 80/443，接受带有小 POST 负载的请求，清理它们并将它们转发给其他客户端......它有点不同。但这是一个特定于任务的服务器，它假装是一个网络服务器，它不使用 C 来生成动态页面。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T04:08:52.830

很多服务器端程序都可以用 C 语言完成，更不用说[CGI 编程](http://www.cs.tut.fi/~jkorpela/forms/cgic.html)了。他们也可以[将 C 与 MySQL](http://dev.mysql.com/doc/refman/5.0/en/c.html)一起使用，这是很有可能的。但是如果不能访问他们的源代码，我们就无法知道他们使用了多少 C。

声称他们是“少数仍在使用 C 的人之一”可能只是一个笑话。至少有了这样的统计数据[，我希望如此。](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)

-约翰

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-03T04:09:43.093

您可以看到一个很好的 C 语言网站示例，其中包含源代码：[化石](http://www.fossil-scm.org/)。

它使用 SQLite 作为后端。

# c++ - 将类视为一等对象

> ID：605067
> 
> 赞同：6
> 
> 时间：2009-03-03T04:06:09.483
> 
> 标签：c++, oop, prototype, design-patterns

我正在阅读 GoF 的书，在原型部分的开头我读到：

> 这种好处主要适用于像 C++ 这样不将类视为第一类对象的语言。

我从未使用过 C++，但我对 OO 编程确实有很好的理解，但是，这对我来说没有任何意义。任何人都可以详细说明这一点（如果有帮助，我已经使用\使用：C、Python、Java、SQL。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T04:15:41.113

对于其他所有人，这是完整的报价：

> “减少子类化。工厂方法 (107) 通常会生成与产品类层次结构平行的 Creator 类层次结构。原型模式允许您克隆原型，而不是要求工厂方法创建新对象。因此，您不需要Creator 类层次结构。这种好处主要适用于像 C++ 这样不将类视为一流对象的语言。像 Smalltalk 和 Objective C 这样的语言获得的好处较少，因为您始终可以将类对象用作创造者。类对象在这些语言中已经表现得像原型一样。” - GoF，第 120 页。

正如[史蒂夫所说](http://www.cpptalk.net/gof-c-doesnt-treat-classes-as-frist-class-objects--vt45396.html)，

> 我发现它很微妙，因为人们可能将其理解为暗示 /instances/ 的类在 C++ 中不被视为第一类对象。如果 GoF 使用的相同词出现在不太正式的环境中，它们很可能是有意的 /instances/ 而不是类。对 /you/ 来说，这种区别似乎并不微妙。然而，/我/确实不得不考虑一下。
> 
> 我相信区别很重要。如果我没记错的话，编译的 C++ 程序不需要保留任何可以重建创建对象的类的工件。IOW，使用 Java 术语，没有 /Class/ 对象。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-03T04:20:02.867

对于要成为第一类对象的类，语言需要支持诸如允许函数将类（而不是实例）作为参数、能够将类保存在容器中以及能够从函数返回类等操作。

对于具有一流类的语言示例，请考虑 Java。任何对象都是其类的实例。该类本身就是[java.lang.Class](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Class.html)的一个实例。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-03T04:32:35.130

在 Java 中，每个类本身就是一个对象，派生自 java.lang.Class，它允许您从程序中访问有关该类、其方法等的信息。C++ 不是这样的。类（与其对象相反）在运行时并不是真正可访问的。有一个叫做 RTTI（运行时类型信息）的工具可以让你按照这些思路做一些事情，但它非常有限，而且我相信会有性能成本。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-03T04:38:15.913

您使用过 python，它是一种具有一流类的语言。您可以将类传递给函数，将其存储在列表中等。在下面的示例中，函数 new_instance() 返回它传递的类的新实例。

```
class Klass1:
    pass

class Klass2:
    pass

def new_instance(k):
    return k()

instance_k1 = new_instance(Klass1)
instance_k2 = new_instance(Klass2)

print type(instance_k1), instance_k1.__class__
print type(instance_k2), instance_k2.__class__ 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-03T04:42:07.713

C# 和 Java 程序可以知道它们自己的类，因为 .NET 和 Java 运行时都提供[反射](http://en.wikipedia.org/wiki/Reflection_(computer_science))，这通常让程序拥有关于其自身结构的信息（在 .NET 和 Java 中，这种结构恰好是类）。

如果不依赖运行时环境，您将无法承受反射，因为程序本身无法自我感知*。但是，如果您的程序的执行是由运行时管理的，那么程序可以从运行时获得有关自身的信息。由于 C++ 被编译为本机、非托管代码，因此您无法在 C++** 中进行反射。

...

* 好吧，程序没有理由不能读取自​​己的机器代码并“尝试对自己做出结论”。但我认为这是没有人愿意做的事情。

** 不完全准确。使用可怕的基于宏的 hack，只要您的类层次结构只有一个根，您就可以实现类似于反射的效果。MFC 就是一个例子。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T06:34:56.613

模板元编程为 C++ 提供了更多使用类的方法，但老实说，我不认为当前的系统允许人们可能想做的所有操作（主要是没有标准的方法来发现所有可用的方法）一个类或对象）。这不是疏忽，而是设计使然。

# internet-explorer - Internet Explorer 和 Firefox 调试器和多版本测试器

> ID：605069
> 
> 赞同：0
> 
> 时间：2009-03-03T04:06:26.800
> 
> 标签：internet-explorer, firefox

我正在使用 IETester 测试多个版本。是否有用于调试 Internet Explorer 脚本错误的工具？

同样，Firefox 是否有类似的工具可以在一个框中检查多个版本，例如 IETester？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T04:26:30.403

我使用[VirtualBox](http://www.virtualbox.org/)来管理具有不同浏览器版本的多个环境。

在 Linux 上，并行运行多个版本的 Firefox 很容易（这里有[一个例子](http://olex.openlogic.com/wazi/2008/running-multiple-firefox-versions-side-by-side/)），但我想你是在 Windows 上，所以 VirtualBox 是我的建议。=^)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T04:37:52.027

你可以试试[这个 Internet Explorer 开发者工具栏](http://www.microsoft.com/downloads/details.aspx?FamilyID=e59c3964-672d-4511-bb3e-2d5e1db91038&displaylang=en)。

此外，[Visual Studio](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio)显然允许您在浏览器中进行脚本调试（如果有的话）。

您还询问了测试多个版本的 Firefox。便携式 Firefox 可能是个好主意。它将允许您同时安装多个版本，而无需花费太多时间为它们设置配置文件。它有 Firefox 1、1.5、2 和 3 的版本 - 在这里查看[旧版本](http://portableapps.com/apps/internet/firefox_portable#legacy)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T04:12:27.690

很难准确说出您在说什么，但我建议您使用[Firebug](http://en.wikipedia.org/wiki/Firebug_%28software%29)在 Firefox 中进行调试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T04:12:37.487

[Firebug](http://www.getfirebug.com/)是最好的 JavaScript 调试工具之一。但是，它仅适用于 Firefox。我相信[Internet Explorer 8](http://en.wikipedia.org/wiki/Internet_Explorer_8)测试版附带了一些 Web 开发工具，但我没有使用过它们，也无法评论它们的质量或有用性。

在检查您的网站在不同引擎中的呈现方面，我发现[IE Tab](https://addons.mozilla.org/firefox/addon/1419) Firefox 插件对于快速检查我在[Internet Explorer 7](http://en.wikipedia.org/wiki/Internet_Explorer_7)中的布局非常有用。

# c# - 如何在 C# 和 DevExexpress TextEditor 中使用掩码显示自定义代码

> ID：605070
> 
> 赞同：0
> 
> 时间：2009-03-03T04:06:45.473
> 
> 标签：c#

我正在尝试显示类似 ABC/DEF/00012 或 ABC/EDF/01234 或 ABC/DEF/00009 的代码

我使用正则表达式掩码 \w{3}/\w{3}/?????

问号是我无法弄清楚的困难部分。

基本上，我尝试用字符和数字显示代码。我想自动在数字上添加前导零。

拜伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T04:20:45.890

似乎您正在尝试匹配最后的 5 位数字：

\w{3}/\w{3}/\d{5}

# unix - 如何将参数传递给 shell 脚本？

> ID：605083
> 
> 赞同：8
> 
> 时间：2009-03-03T04:11:51.450
> 
> 标签：unix, batch-file, shell, dos

我有一个这样的批处理文件：

```
java temptable %1 %2 
```

我需要上面的等效 shell 脚本。我会将参数传递给 shell 脚本，并且应该传递给 temptable。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-03T04:15:02.787

对于 bash（它是*一种*shell，但可能是 Linux 世界中最常见的一种），相当于：

```
java temptable $1 $2 
```

假设参数中没有空格。如果有空格，你应该引用你的论点：

```
java temptable "$1" "$2" 
```

你也可以这样做：

```
java temptable $* 
```

或者：

```
java temptable "$@" 
```

如果您希望通过所有参数（同样，第二个参数相当于引用每个参数：“$1”“$2”“$3”...）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-03-19T10:31:21.453

```
#!/bin/bash
# Call this script with at least 3 parameters, for example
# sh scriptname 1 2 3
echo "first parameter is $1"
echo "Second parameter is $2"
echo "Third parameter is $3"
exit 0 
```

输出：

```
[root@localhost ~]# sh parameters.sh 47 9 34
first parameter is 47
Second parameter is 9
Third parameter is 34 
```

# asp.net - 使用表单身份验证将用户链接到配置文件

> ID：605093
> 
> 赞同：0
> 
> 时间：2009-03-03T04:15:41.083
> 
> 标签：asp.net, forms-authentication

我正在将旧版 winform 应用程序移动到网络上，并希望获得有关表单身份验证的一些建议。我是否正确假设表单身份验证比汇总我自己的用户身份验证功能更好？

我自己滚动很容易，因为这是 winform 应用程序所做的并且表结构已经支持它，但是表单身份验证看起来会更好地保护站点和用户身份验证信息。

我是一名老程序员，但在 Web 开发方面还很年轻，多年来我了解到，使用内置的 MS 工具有时看起来比实际工作要好……表单身份验证不是其中一种情况吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T04:23:11.503

使用表单身份验证并不意味着您不能使用这些表。您将检查用户名/密码，并告诉 asp.net 用户已通过身份验证。Asp.net 将从那里继续，确保识别和验证来自该用户的进一步请求（基于身份验证票证）。

**更新 1：**后来在 asp.net 上包含了会员提供程序，并对其进行了一些控制。即使这样，您仍然可以实现自己的成员资格提供程序，在非常简单的情况下，您可以通过仅实现 1 或 2 个方法来实现。如果您有几个功能，并且它们与会员提供者支持的功能不匹配，我会坚持自定义实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T06:55:33.117

我会说表单身份验证是一种您可能不会遇到“买家悔恨”的情况。您可以选择使用一些非常不错的功能。该模型非常灵活，因为它允许您[实现自己的 Membership Providers](http://msdn.microsoft.com/en-us/library/f1kyba5e.aspx)。

# powershell - 如何从 SSIS 执行 PowerShell 脚本

> ID：605099
> 
> 赞同：5
> 
> 时间：2009-03-03T04:19:28.577
> 
> 标签：powershell, ssis

有谁知道如何从 SSIS 执行 PowerShell 脚本？我已经创建了脚本，它可以从命令行运行。该脚本采用几个命令行参数，从 cmd.exe 调用时可以正常工作。

我在 SSIS 中使用执行进程任务，无法执行脚本文件。我正在使用表达式来传递脚本的名称和命令行参数。该任务返回一个不完整的字符串标记错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T14:22:56.693

从 VS 到使用额外脚本启动 PSH（对于 Cmdlet 项目），我使用以下命令行：

```
powershell -noexit -command ". ./Startup.ps1" 
```

-noexit 将保留实例（因此您不希望这样），将所有真实命令放在脚本中以进行点源可避免非常长的命令行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-06-25T10:06:56.920

转到**执行流程任务**编辑器 ->**流程**选项卡并设置以下选项：

*   可执行文件 -`C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe`
*   论据 -`-File ".\PowershellScript/ps1" "arg_1_value" "arg_2_value" ... "arg_n_value"`

参考下面的截图： [![在此处输入图像描述](https://i.stack.imgur.com/aRQu8.png)](https://i.stack.imgur.com/aRQu8.png)

# windows - 命令提示符执行同名文件的顺序（a.bat vs a.cmd vs a.exe）

> ID：605101
> 
> 赞同：20
> 
> 时间：2009-03-03T04:20:34.660
> 
> 标签：windows, command-line, cmd, batch-file

Windows 命令提示符执行具有相同名称但扩展名不同的文件的顺序是什么？

例如，我有一堆可执行文件`something.cmd`：`something.bat`和`something.exe`. `something`当我输入命令提示符时（假设它们在路径上等），哪些会被执行？如果该文件不存在，那么将执行哪个文件？

有没有描述这个的参考资料？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-03T04:41:50.863

好的，我根据我进行的其他一些搜索做了一些快速的实验。

要点是命令的顺序取决于扩展存储在`PATHEXT`环境变量中的顺序。所以最初我有：

```
PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.RB;.RBW 
```

对于上面的示例，它的运行顺序是：

```
something.exe
something.bat
something.cmd 
```

更改它们在`PATHEXT`环境变量中定义的顺序确实改变了它们的执行顺序。

# webpage - 减小页面大小

> ID：605109
> 
> 赞同：2
> 
> 时间：2009-03-03T04:24:57.830
> 
> 标签：webpage

任何人都知道如何在加载时减小页面大小？无论如何，我可以减小 CSS 文件的大小和 Javascript 文件的大小？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T04:29:55.153

*   [Gzip 压缩](http://www.websiteoptimization.com/speed/tweak/compress/)
*   [缩小](http://en.wikipedia.org/wiki/Minify)
*   将多个请求合并为一个

GZIP 压缩对基于文本的响应（如样式表和 HTML）有效，但对图像无效。

缩小对 CSS 和 Javascript 有效（对 Javascript 更是如此）。根据您的语言和框架，有各种可用的解决方案。这会通过删除空格和尽可能缩短标识符名称来混淆发送的代码。

将多个请求组合成一个请求可以大大减少延迟，即使它不会节省太多带宽。它为用户带来更快的感知加载时间。您可以将多个 CSS 文件合并为一个，这很容易。对于图像，您可以使用一种称为[sprites](http://css-tricks.com/css-sprites-what-they-are-why-theyre-cool-and-how-to-use-them/)的技术。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T04:29:55.137

[YUI 的 Compressor](http://developer.yahoo.com/yui/compressor/)是一种选择。

[YSlow](http://developer.yahoo.com/yslow/)可以很好地了解为什么它很慢。

它确实倾向于为大型网站而不是小型网站提出建议，因此请运用常识。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T04:29:10.753

你的意思是传输的字节数？如果是这样，您将使用[HTML 的 GZIP 压缩](http://developer.yahoo.com/performance/rules.html#gzip)。在 Apache 中，使用[mod_deflate](http://httpd.apache.org/docs/2.0/mod/mod_deflate.html)。那里也有 servlet 过滤器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T04:33:11.447

[w3compiler](http://www.w3compiler.com/)是一个工具，可以完全满足您的需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T04:39:11.930

有一本很棒的书，叫做[高性能网站](https://rads.stackoverflow.com/amzn/click/com/0596529309)。这是一本 O'Reilly 的书，它将带您完成客户端性能升级的各个步骤。它涵盖了您建议的主题，例如 CSS 和 JS 文件大小等。

# javascript - 在javascript中查找上个月的第一天

> ID：605113
> 
> 赞同：38
> 
> 时间：2009-03-03T04:27:29.150
> 
> 标签：javascript

给定一个日期对象，如何在javascript中获取其上个月的第一天

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-03-03T04:31:55.287

```
function firstDayInPreviousMonth(yourDate) {
    var d = new Date(yourDate);
    d.setDate(1);
    d.setMonth(d.getMonth() - 1);
    return d;
} 
```

编辑：好吧......我肯定在这里学到了一些东西。我认为这是涵盖所有情况的最简单的解决方案（是的，它确实适用于 1 月份）：

```
function firstDayInPreviousMonth(yourDate) {
    return new Date(yourDate.getFullYear(), yourDate.getMonth() - 1, 1);
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-03T04:34:30.930

以下应该有效：

```
now = new Date();
if (now.getMonth() == 0) {
    current = new Date(now.getFullYear() - 1, 11, 1);
} else {
    current = new Date(now.getFullYear(), now.getMonth() - 1, 1);
} 
```

请记住，月份是从零开始的，因此 12 月是*11*而不是 12。

但是，正如其他人所指出的那样，月份包装，即使作为原子构造函数的一部分，所以以下也是可能的：

```
now = new Date();
firstDayPrevMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-03-03T14:21:10.673

我喜欢这个解决方案。它可能不是最简短的，但它突出了 Date() 对象上的 setDate() 方法的一些功能，这些功能并不是每个人都熟悉的：

```
function firstDayPreviousMonth(originalDate) {
    var d = new Date(originalDate);
    d.setDate(0); // set to last day of previous month
    d.setDate(1); // set to the first day of that month
    return d;
} 
```

它利用 .setDate(0) 将日期更改为指向上个月的最后一天，而 .setDate(1) 将其（进一步）更改为指向该月的第一天这一事实。它让核心 Javascript 库完成繁重的工作。

你可以在这里看到一个[正常工作的 Plunk](http://plnkr.co/edit/YmP3RF?p=preview)。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-08-14T07:06:52.220

这将有助于获得上个月的第一个和最后一个日期。

```
 function getLastMonth(){
        var now = new Date();
        var lastday  = new Date(now.getFullYear(), now.getMonth(), 0);
        var firstday = new Date(lastday.getFullYear(), lastday.getMonth(), 1);
        var lastMonth = firstday.getDate()+'/'+(firstday.getMonth()+1)+'/'+firstday.getFullYear()+' - '+lastday.getDate()+'/'+(firstday.getMonth()+1)+'/'+lastday.getFullYear();
        return lastMonth;
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-05-10T09:03:39.327

为什么要重新发明轮子？

使用[moment.js](https://momentjs.com/docs/)或替代方案之一（Luxon、Day.js 等）：

`moment().subtract(1, "months").startOf("months").toDate()`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-10-08T01:03:47.337

我需要在 BootStrap Min 月中使用当月的乞讨，并且不想把它全部写出来。

```
(() => new Date(new Date().getFullYear(), new Date().getMonth(),1, 0))() 
```

# asp.net - 表单身份验证表位置

> ID：605115
> 
> 赞同：0
> 
> 时间：2009-03-03T04:28:58.757
> 
> 标签：asp.net, forms, forms-authentication

当使用 aspnet_regsql 创建表单身份验证的基表时，建议将这些表存储在应用程序数据库目录中，还是应该创建一个仅用于身份验证的数据库目录。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T04:42:32.750

没关系。

如果您最终需要将成员表上的记录与您自己的目录连接起来，我建议您使用应用程序数据库。

否则，请使用您的数据库管理首选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T05:29:27.257

为了澄清 jro 所说的内容，您可以跨 dbs 加入，但在那里您会失去一些性能。

其次，如果您想维护引用约束，您将需要同一个数据库中的表。我的意思是，如果您的应用程序有一个新表，比如 CustomerOrders，并且您希望确保 UserID 列值存在于 Users 表中，您将需要在同一个数据库中的那些值。

# c# - c#中的定点数学？

> ID：605124
> 
> 赞同：56
> 
> 时间：2009-03-03T04:33:01.197
> 
> 标签：c#, math, fixed-point

我想知道这里是否有人知道 c# 中定点数学的任何好的资源？我见过这样的事情（[http://2ddev.72dpiarmy.com/viewtopic.php?id=156](http://2ddev.72dpiarmy.com/viewtopic.php?id=156)）和这个（[What's the best way to do fixed-point math?](https://stackoverflow.com/questions/79677/whats-the-best-way-to-do-fixed-point-math)），以及一些关于是否十进制的讨论确实是定点或实际上是浮点（更新：响应者已确认它绝对是浮点），但我还没有看到用于计算余弦和正弦之类的可靠 C# 库。

我的需求很简单——我需要基本的运算符，加上余弦、正弦、arctan2、PI……我想就是这样。也许平方。我正在编写一个 2D RTS 游戏，我大部分时间都在工作，但是当使用浮点数学（双打）时，单位移动在多台机器上随着时间（10-30 分钟）有非常小的不准确性，导致不同步。目前这仅在 32 位操作系统和 64 位操作系统之间，所有 32 位机器似乎都保持同步而没有问题，这就是让我认为这是一个浮点问题的原因。

我从一开始就意识到这是一个可能的问题，因此尽可能地限制了我对非整数位置数学的使用，但是为了以不同的速度平滑对角线运动，我正在计算弧度中点之间的角度，然后用 sin 和 cos 获得运动的 x 和 y 分量。这是主要问题。我还在为线段交叉点、线-圆交叉点、圆-矩形交叉点等进行一些计算，这些计算也可能需要从浮点数移动到定点数以避免跨机器问题。

如果有 Java 或 VB 或其他类似语言的开源代码，我可能会转换代码以供我使用。对我来说，首要任务是准确性，尽管我希望在目前的性能上尽可能少地损失速度。这整个定点数学的东西对我来说是非常新的，我很惊讶谷歌上关于它的实用信息如此之少——大多数东西似乎要么是理论，要么是密集的 C++ 头文件。

非常感谢您能为我指明正确方向所做的任何事情；如果我能做到这一点，我计划将我放在一起的数学函数开源，以便为其他 C# 程序员提供资源。

更新：我绝对可以为我的目的制作一个余弦/正弦查找表，但我认为这不适用于 arctan2，因为我需要生成一个包含大约 64,000x64,000 个条目的表（哎呀）。如果您知道任何关于计算诸如 arctan2 之类的有效方法的编程解释，那就太棒了。我的数学背景还可以，但是高级公式和传统的数学符号对我来说很难翻译成代码。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-03-05T18:36:03.340

好的，这是我根据原始问题中的链接提出的定点结构，但还包括对如何处理除法和乘法的一些修复，并为模块、比较、移位等添加了逻辑：

```
public struct FInt
{
    public long RawValue;
    public const int SHIFT_AMOUNT = 12; //12 is 4096

    public const long One = 1 << SHIFT_AMOUNT;
    public const int OneI = 1 << SHIFT_AMOUNT;
    public static FInt OneF = FInt.Create( 1, true );

    #region Constructors
    public static FInt Create( long StartingRawValue, bool UseMultiple )
    {
        FInt fInt;
        fInt.RawValue = StartingRawValue;
        if ( UseMultiple )
            fInt.RawValue = fInt.RawValue << SHIFT_AMOUNT;
        return fInt;
    }
    public static FInt Create( double DoubleValue )
    {
        FInt fInt;
        DoubleValue *= (double)One;
        fInt.RawValue = (int)Math.Round( DoubleValue );
        return fInt;
    }
    #endregion

    public int IntValue
    {
        get { return (int)( this.RawValue >> SHIFT_AMOUNT ); }
    }

    public int ToInt()
    {
        return (int)( this.RawValue >> SHIFT_AMOUNT );
    }

    public double ToDouble()
    {
        return (double)this.RawValue / (double)One;
    }

    public FInt Inverse
    {
        get { return FInt.Create( -this.RawValue, false ); }
    }

    #region FromParts
    /// <summary>
    /// Create a fixed-int number from parts.  For example, to create 1.5 pass in 1 and 500.
    /// </summary>
    /// <param name="PreDecimal">The number above the decimal.  For 1.5, this would be 1.</param>
    /// <param name="PostDecimal">The number below the decimal, to three digits.  
    /// For 1.5, this would be 500\. For 1.005, this would be 5.</param>
    /// <returns>A fixed-int representation of the number parts</returns>
    public static FInt FromParts( int PreDecimal, int PostDecimal )
    {
        FInt f = FInt.Create( PreDecimal, true );
        if ( PostDecimal != 0 )
            f.RawValue += ( FInt.Create( PostDecimal ) / 1000 ).RawValue;

        return f;
    }
    #endregion

    #region *
    public static FInt operator *( FInt one, FInt other )
    {
        FInt fInt;
        fInt.RawValue = ( one.RawValue * other.RawValue ) >> SHIFT_AMOUNT;
        return fInt;
    }

    public static FInt operator *( FInt one, int multi )
    {
        return one * (FInt)multi;
    }

    public static FInt operator *( int multi, FInt one )
    {
        return one * (FInt)multi;
    }
    #endregion

    #region /
    public static FInt operator /( FInt one, FInt other )
    {
        FInt fInt;
        fInt.RawValue = ( one.RawValue << SHIFT_AMOUNT ) / ( other.RawValue );
        return fInt;
    }

    public static FInt operator /( FInt one, int divisor )
    {
        return one / (FInt)divisor;
    }

    public static FInt operator /( int divisor, FInt one )
    {
        return (FInt)divisor / one;
    }
    #endregion

    #region %
    public static FInt operator %( FInt one, FInt other )
    {
        FInt fInt;
        fInt.RawValue = ( one.RawValue ) % ( other.RawValue );
        return fInt;
    }

    public static FInt operator %( FInt one, int divisor )
    {
        return one % (FInt)divisor;
    }

    public static FInt operator %( int divisor, FInt one )
    {
        return (FInt)divisor % one;
    }
    #endregion

    #region +
    public static FInt operator +( FInt one, FInt other )
    {
        FInt fInt;
        fInt.RawValue = one.RawValue + other.RawValue;
        return fInt;
    }

    public static FInt operator +( FInt one, int other )
    {
        return one + (FInt)other;
    }

    public static FInt operator +( int other, FInt one )
    {
        return one + (FInt)other;
    }
    #endregion

    #region -
    public static FInt operator -( FInt one, FInt other )
    {
        FInt fInt;
        fInt.RawValue = one.RawValue - other.RawValue;
        return fInt;
    }

    public static FInt operator -( FInt one, int other )
    {
        return one - (FInt)other;
    }

    public static FInt operator -( int other, FInt one )
    {
        return (FInt)other - one;
    }
    #endregion

    #region ==
    public static bool operator ==( FInt one, FInt other )
    {
        return one.RawValue == other.RawValue;
    }

    public static bool operator ==( FInt one, int other )
    {
        return one == (FInt)other;
    }

    public static bool operator ==( int other, FInt one )
    {
        return (FInt)other == one;
    }
    #endregion

    #region !=
    public static bool operator !=( FInt one, FInt other )
    {
        return one.RawValue != other.RawValue;
    }

    public static bool operator !=( FInt one, int other )
    {
        return one != (FInt)other;
    }

    public static bool operator !=( int other, FInt one )
    {
        return (FInt)other != one;
    }
    #endregion

    #region >=
    public static bool operator >=( FInt one, FInt other )
    {
        return one.RawValue >= other.RawValue;
    }

    public static bool operator >=( FInt one, int other )
    {
        return one >= (FInt)other;
    }

    public static bool operator >=( int other, FInt one )
    {
        return (FInt)other >= one;
    }
    #endregion

    #region <=
    public static bool operator <=( FInt one, FInt other )
    {
        return one.RawValue <= other.RawValue;
    }

    public static bool operator <=( FInt one, int other )
    {
        return one <= (FInt)other;
    }

    public static bool operator <=( int other, FInt one )
    {
        return (FInt)other <= one;
    }
    #endregion

    #region >
    public static bool operator >( FInt one, FInt other )
    {
        return one.RawValue > other.RawValue;
    }

    public static bool operator >( FInt one, int other )
    {
        return one > (FInt)other;
    }

    public static bool operator >( int other, FInt one )
    {
        return (FInt)other > one;
    }
    #endregion

    #region <
    public static bool operator <( FInt one, FInt other )
    {
        return one.RawValue < other.RawValue;
    }

    public static bool operator <( FInt one, int other )
    {
        return one < (FInt)other;
    }

    public static bool operator <( int other, FInt one )
    {
        return (FInt)other < one;
    }
    #endregion

    public static explicit operator int( FInt src )
    {
        return (int)( src.RawValue >> SHIFT_AMOUNT );
    }

    public static explicit operator FInt( int src )
    {
        return FInt.Create( src, true );
    }

    public static explicit operator FInt( long src )
    {
        return FInt.Create( src, true );
    }

    public static explicit operator FInt( ulong src )
    {
        return FInt.Create( (long)src, true );
    }

    public static FInt operator <<( FInt one, int Amount )
    {
        return FInt.Create( one.RawValue << Amount, false );
    }

    public static FInt operator >>( FInt one, int Amount )
    {
        return FInt.Create( one.RawValue >> Amount, false );
    }

    public override bool Equals( object obj )
    {
        if ( obj is FInt )
            return ( (FInt)obj ).RawValue == this.RawValue;
        else
            return false;
    }

    public override int GetHashCode()
    {
        return RawValue.GetHashCode();
    }

    public override string ToString()
    {
        return this.RawValue.ToString();
    }
}

public struct FPoint
{
    public FInt X;
    public FInt Y;

    public static FPoint Create( FInt X, FInt Y )
    {
        FPoint fp;
        fp.X = X;
        fp.Y = Y;
        return fp;
    }

    public static FPoint FromPoint( Point p )
    {
        FPoint f;
        f.X = (FInt)p.X;
        f.Y = (FInt)p.Y;
        return f;
    }

    public static Point ToPoint( FPoint f )
    {
        return new Point( f.X.IntValue, f.Y.IntValue );
    }

    #region Vector Operations
    public static FPoint VectorAdd( FPoint F1, FPoint F2 )
    {
        FPoint result;
        result.X = F1.X + F2.X;
        result.Y = F1.Y + F2.Y;
        return result;
    }

    public static FPoint VectorSubtract( FPoint F1, FPoint F2 )
    {
        FPoint result;
        result.X = F1.X - F2.X;
        result.Y = F1.Y - F2.Y;
        return result;
    }

    public static FPoint VectorDivide( FPoint F1, int Divisor )
    {
        FPoint result;
        result.X = F1.X / Divisor;
        result.Y = F1.Y / Divisor;
        return result;
    }
    #endregion
} 
```

根据 ShuggyCoUk 的评论，我看到这是 Q12 格式。这对我的目的来说是相当精确的。当然，除了错误修正之外，在我提出问题之前，我已经掌握了这种基本格式。我一直在寻找的是使用这样的结构在 C# 中计算 Sqrt、Atan2、Sin 和 Cos 的方法。我所知道的 C# 中没有任何其他东西可以处理这个问题，但在 Java 中，我设法找到了Onno Hommes 的[MathFP](http://home.comcast.net/~ohommes/MathFP/)库。这是一个自由的源软件许可证，所以我已经将他的一些功能转换为我在 C# 中的用途（我认为对 atan2 进行了修复）。享受：

```
 #region PI, DoublePI
    public static FInt PI = FInt.Create( 12868, false ); //PI x 2^12
    public static FInt TwoPIF = PI * 2; //radian equivalent of 260 degrees
    public static FInt PIOver180F = PI / (FInt)180; //PI / 180
    #endregion

    #region Sqrt
    public static FInt Sqrt( FInt f, int NumberOfIterations )
    {
        if ( f.RawValue < 0 ) //NaN in Math.Sqrt
            throw new ArithmeticException( "Input Error" );
        if ( f.RawValue == 0 )
            return (FInt)0;
        FInt k = f + FInt.OneF >> 1;
        for ( int i = 0; i < NumberOfIterations; i++ )
            k = ( k + ( f / k ) ) >> 1;

        if ( k.RawValue < 0 )
            throw new ArithmeticException( "Overflow" );
        else
            return k;
    }

    public static FInt Sqrt( FInt f )
    {
        byte numberOfIterations = 8;
        if ( f.RawValue > 0x64000 )
            numberOfIterations = 12;
        if ( f.RawValue > 0x3e8000 )
            numberOfIterations = 16;
        return Sqrt( f, numberOfIterations );
    }
    #endregion

    #region Sin
    public static FInt Sin( FInt i )
    {
        FInt j = (FInt)0;
        for ( ; i < 0; i += FInt.Create( 25736, false ) ) ;
        if ( i > FInt.Create( 25736, false ) )
            i %= FInt.Create( 25736, false );
        FInt k = ( i * FInt.Create( 10, false ) ) / FInt.Create( 714, false );
        if ( i != 0 && i != FInt.Create( 6434, false ) && i != FInt.Create( 12868, false ) && 
            i != FInt.Create( 19302, false ) && i != FInt.Create( 25736, false ) )
            j = ( i * FInt.Create( 100, false ) ) / FInt.Create( 714, false ) - k * FInt.Create( 10, false );
        if ( k <= FInt.Create( 90, false ) )
            return sin_lookup( k, j );
        if ( k <= FInt.Create( 180, false ) )
            return sin_lookup( FInt.Create( 180, false ) - k, j );
        if ( k <= FInt.Create( 270, false ) )
            return sin_lookup( k - FInt.Create( 180, false ), j ).Inverse;
        else
            return sin_lookup( FInt.Create( 360, false ) - k, j ).Inverse;
    }

    private static FInt sin_lookup( FInt i, FInt j )
    {
        if ( j > 0 && j < FInt.Create( 10, false ) && i < FInt.Create( 90, false ) )
            return FInt.Create( SIN_TABLE[i.RawValue], false ) + 
                ( ( FInt.Create( SIN_TABLE[i.RawValue + 1], false ) - FInt.Create( SIN_TABLE[i.RawValue], false ) ) / 
                FInt.Create( 10, false ) ) * j;
        else
            return FInt.Create( SIN_TABLE[i.RawValue], false );
    }

    private static int[] SIN_TABLE = {
        0, 71, 142, 214, 285, 357, 428, 499, 570, 641, 
        711, 781, 851, 921, 990, 1060, 1128, 1197, 1265, 1333, 
        1400, 1468, 1534, 1600, 1665, 1730, 1795, 1859, 1922, 1985, 
        2048, 2109, 2170, 2230, 2290, 2349, 2407, 2464, 2521, 2577, 
        2632, 2686, 2740, 2793, 2845, 2896, 2946, 2995, 3043, 3091, 
        3137, 3183, 3227, 3271, 3313, 3355, 3395, 3434, 3473, 3510, 
        3547, 3582, 3616, 3649, 3681, 3712, 3741, 3770, 3797, 3823, 
        3849, 3872, 3895, 3917, 3937, 3956, 3974, 3991, 4006, 4020, 
        4033, 4045, 4056, 4065, 4073, 4080, 4086, 4090, 4093, 4095, 
        4096
    };
    #endregion

    private static FInt mul( FInt F1, FInt F2 )
    {
        return F1 * F2;
    }

    #region Cos, Tan, Asin
    public static FInt Cos( FInt i )
    {
        return Sin( i + FInt.Create( 6435, false ) );
    }

    public static FInt Tan( FInt i )
    {
        return Sin( i ) / Cos( i );
    }

    public static FInt Asin( FInt F )
    {
        bool isNegative = F < 0;
        F = Abs( F );

        if ( F > FInt.OneF )
            throw new ArithmeticException( "Bad Asin Input:" + F.ToDouble() );

        FInt f1 = mul( mul( mul( mul( FInt.Create( 145103 >> FInt.SHIFT_AMOUNT, false ), F ) -
            FInt.Create( 599880 >> FInt.SHIFT_AMOUNT, false ), F ) +
            FInt.Create( 1420468 >> FInt.SHIFT_AMOUNT, false ), F ) -
            FInt.Create( 3592413 >> FInt.SHIFT_AMOUNT, false ), F ) +
            FInt.Create( 26353447 >> FInt.SHIFT_AMOUNT, false );
        FInt f2 = PI / FInt.Create( 2, true ) - ( Sqrt( FInt.OneF - F ) * f1 );

        return isNegative ? f2.Inverse : f2;
    }
    #endregion

    #region ATan, ATan2
    public static FInt Atan( FInt F )
    {
        return Asin( F / Sqrt( FInt.OneF + ( F * F ) ) );
    }

    public static FInt Atan2( FInt F1, FInt F2 )
    {
        if ( F2.RawValue == 0 && F1.RawValue == 0 )
            return (FInt)0;

        FInt result = (FInt)0;
        if ( F2 > 0 )
            result = Atan( F1 / F2 );
        else if ( F2 < 0 )
        {
            if ( F1 >= 0 )
                result = ( PI - Atan( Abs( F1 / F2 ) ) );
            else
                result = ( PI - Atan( Abs( F1 / F2 ) ) ).Inverse;
        }
        else
            result = ( F1 >= 0 ? PI : PI.Inverse ) / FInt.Create( 2, true );

        return result;
    }
    #endregion

    #region Abs
    public static FInt Abs( FInt F )
    {
        if ( F < 0 )
            return F.Inverse;
        else
            return F;
    }
    #endregion 
```

Hommes 博士的 MathFP 库中还有许多其他函数，但它们超出了我的需要，因此我没有花时间将它们翻译成 C#（由于他使用的是很长，我正在使用 FInt 结构，这使得转换规则很难立即看到）。

这些函数在此处编码的准确性对于我的目的来说绰绰有余，但如果您需要更多，您可以增加 FInt 上的 SHIFT AMOUNT。请注意，如果这样做，那么 Hommes 博士函数的常数将需要除以 4096，然后乘以新的 SHIFT AMOUNT 所需的任何值。如果您这样做并且不小心，您可能会遇到一些错误，因此请务必对内置的数学函数进行检查，以确保您的结果不会因错误地调整常数而被推迟。

到目前为止，这个 FINt 逻辑似乎与等效的内置 .net 函数一样快，如果不是快一点的话。这显然会因机器而异，因为 fp 协处理器会确定这一点，所以我没有运行特定的基准测试。但它们现在已集成到我的游戏中，与以前相比，我发现处理器利用率略有下降（这是在 Q6600 四核上 - 平均使用率下降约 1%）。

再次感谢所有为您的帮助发表评论的人。没有人直接指出我要找的东西，但你给了我一些线索，帮助我自己在谷歌上找到了它。我希望这段代码对其他人有用，因为在公开发布的 C# 中似乎没有任何可比的东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T09:00:26.483

在例如 1/1000 比例中使用 64 位整数。您可以正常加减。当你需要乘然后乘整数然后除以1000。当你需要sqrt，sin，cos等然后转换为long double，除以1000，sqrt，乘以1000，转换为整数。机器之间的差异应该无关紧要。

您可以使用另一个比例来更快地划分，例如 1024 as `x/1024 == x >> 10`。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-10-14T21:53:07.280

我在 C# 中实现了一个定点 Q31.32 类型。它执行所有基本算术运算、sqrt、sin、cos、tan，并且被单元测试很好地覆盖。你可以在[这里](https://github.com/asik/FixedMath.Net)找到它，有趣的类型是 Fix64。：

请注意，该库还包括 Fix32、Fix16 和 Fix8 类型，但这些类型主要用于试验，并不完整且没有错误。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-07-06T16:49:55.833

我知道这个线程有点旧，但为了记录，这里有一个在 C# 中实现定点数学的项目的链接：[http ://www.isquaredsoftware.com/XrossOneGDIPlus.php](http://www.isquaredsoftware.com/XrossOneGDIPlus.php)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-03T10:31:01.413

除了缩放整数之外，还有一些任意精度的数值库，它们通常包括“BigRational”类型，并且定点只是十分母的固定幂。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-03-27T14:28:12.017

我创建了一个类似的定点结构。使用 new() 会降低性能，因为即使您使用的是结构，它也会将数据放入堆中。请参阅 Google（.NET 中的 C# Heap(ing) Vs Stack(ing)：第 I 部分）使用 struct 的真正力量是能够不使用 new 并将值传递给堆栈。我下面的示例在堆栈上执行以下操作。1\. [result int ] 在堆栈 2\. [a int ] 在堆栈 3\. [b int ] 在堆栈 4\. [* ] 运算符在堆栈 5\. value 结果返回没有堆分配的成本。

```
 public static Num operator *(Num a, Num b)
    {
        Num result;
        result.NumValue = a.NumValue * b.NumValue;
        return result;
    } 
```

# java - 如何从 JAAS LoginModule 中读取 Java 属性文件

> ID：605127
> 
> 赞同：0
> 
> 时间：2009-03-03T04:34:23.037
> 
> 标签：java, apache, tomcat, properties, jaas

我想从 JAAS loginModule 读取我的应用程序 WEB-INF 文件夹或我的 tomcat/apache 服务器中的属性文件。但我不明白如何以独立于主机名的方式从 LoginModule 中正确引用位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T07:16:44.907

您可以使用 catalina.base 系统属性：

```
File confDir = new File(System.getProperty("catalina.base"), "conf");
File confFile = new File(confDir, "myprops.properties");
InputStream in = new FileInputStream(confFile);
try {
    props.load(in);
} finally {
    in.close();
} 
```

# javascript - 如何从 JavaScript 中的日期对象获取前一周的第一天？

> ID：605133
> 
> 赞同：2
> 
> 时间：2009-03-03T04:39:11.730
> 
> 标签：javascript

给定一个日期对象，如何获取前一周的第一天

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T04:40:55.187

这个[Datejs 库](http://groups.google.com/group/datejs/browse_thread/thread/d1a5323a95c48525)看起来可以相对轻松地完成这类事情。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T04:56:54.680

**代码：**

```
function getPreviousSunday()
{
    var today=new Date();
    return new Date().setDate(today.getDate()-today.getDay()-7);
}

function getPreviousMonday()
{
    var today=new Date();
    if(today.getDay() != 0)
      return new Date().setDate(today.getDate()-7-6);
    else
      return new Date().setDate(today.getDate()-today.getDay()-6);
} 
```

**推理：**

取决于前一周的第一天是什么意思。为了讨论，我假设您的意思是上周日。

要找到要减去的天数：

*   获取当前星期几。
*   如果一周中的当前日期是星期日，则减去 7 天
*   如果当天是星期一，则减去 8 天

...

*   如果当天是星期六 13 天

确定要减去的天数后，实际代码很容易：

```
var previous_first_day_of_week=new Date().setDate(today.getDate()-X); 
```

其中 X 是上面讨论的值。此值为 today.getDay() + 7

如果到一周的第一天你的意思是别的，你应该能够从上述步骤中推断出答案。

注意：将负值传递给 setDate 函数是有效的，它将正常工作。

关于星期一的代码。您有这种特殊情况，因为 getDay() 在星期一之前的星期日订购。因此，在这种情况下，我们基本上将 getDay() 替换为 getDay() 的周六值 + 1 的值，以重新排序周日到周末。

我们使用 6 的值与星期一进行减法运算，因为 getDay() 每天返回的值比我们想要的高 1。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T05:09:05.760

```
function previousWeekSunday(d) { 
    return new Date(d.getFullYear(), d.getMonth(), d.getDate() - d.getDay() - 7); 
}

function previousWeekMonday(d) { 
    if(!d.getDay())
        return new Date(d.getFullYear(), d.getMonth(), d.getDate() - 13); 
    return new Date(d.getFullYear(), d.getMonth(), d.getDate() - d.getDay() - 6); 
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-28T21:11:19.317

其他人的帖子我不是很懂。这是我用来显示相对于给定日期的周日至周六周的 javascript。因此，例如，要获得“上周”，您要检查太阳/星期六球门柱相对于 7 天前的情况：`new Date()-7`

```
 // variables
    var comparedate = new Date()-7; // a week ago
    var dayofweek =  comparedate.getDay();

    // just for declaration
    var lastdate;
    var firstadate;

    // functions
    function formatDate (dateinput) // makes date "mm/dd/yyyy" string
    {
        var month = dateinput.getMonth()+1;
        if( month < 10 ) { month = '0' + month }

        var date = dateinput.getDate();
        if( date < 10 ) { var date = '0' + date }

        var dateoutput = month + '/' + date + '/' + dateinput.getFullYear();

        return dateoutput;
    }

    // Sunday to Saturday ... Sunday is the firstdate, Saturday is the lastdate
    // (modify this block if you want something different eg: Monday to Sunday)
     if ( dayofweek == 6 ) { lastdate = comparedate; firstdate = comparedate-6; }           // Saturday
     else if ( dayofweek == 0 ) { lastdate = comparedate+6; firstdate = comparedate; }      // Sunday
     else if ( dayofweek == 1 ) { lastdate = comparedate+5; firstdate = comparedate-1; }    // Monday
     else if ( dayofweek == 2 ) { lastdate = comparedate+4; firstdate = comparedate-2; }    // Tuesday
     else if ( dayofweek == 3 ) { lastdate = comparedate+3; firstdate = comparedate-3; }    // Wednesday
     else if ( dayofweek == 4 ) { lastdate = comparedate+2; firstdate = comparedate-4; }    // Thursday
     else if ( dayofweek == 5 ) { lastdate = comparedate+1; firstdate = comparedate-5; }    // Friday

    // Finish
     var outputtowebpage = formatDate(firstdate) + ' - ' + formatDate(lastdate);
     document.write(outputtowebpage); 
```

每次我需要这样做时，我都必须查看它。所以，我希望这对其他人有帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T05:00:04.300

一周的第一天可以是星期日或星期一，具体取决于您所在的国家/地区：

```
function getPrevSunday(a) {
    return new Date(a.getTime() - ( (7+a.getDay())*24*60*60*1000 ));
};

function getPrevMonday(a) {
    return new Date(a.getTime() - ( (6+(a.getDay()||7))*24*60*60*1000 ));
}; 
```

如果要将日期对象设置为上一个星期日，可以使用：

```
a.setDate(a.getDate()-7-a.getDay()); 
```

和前一个星期一：

```
a.setDate(a.getDate()-6-(a.getDay()||7)); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-09T09:05:39.307

在其他示例中，当周日落在其他月份时，您将遇到问题。这应该可以解决问题：

```
var today, todayNumber, previousWeek, week, mondayNumber, monday;
today = new Date();
todayNumber = today.getDay();
previousWeek = -1; //For every week you want to go back the past fill in a lower number.
week = previousWeek * 7;
mondayNumber = 1 - todayNumber + week;
monday = new Date(today.getFullYear(), today.getMonth(), today.getDate()+mondayNumber); 
```

# sql - 在单个结果行中连接选定的值，可以完成（不分组）吗？

> ID：605148
> 
> 赞同：2
> 
> 时间：2009-03-03T04:48:50.863
> 
> 标签：sql, mysql

我有以下结构：
main: id | 元数据子： main_id
| another_table_id
main 以一对多的方式连接到 sub。

我希望将我的结果作为一条记录取回，如下所示：
[main_id] [meta_data] [another_table_id,another_table_id,another_table_id]

**是否可以在不使用 GROUP BY 的情况下在 MySql 中使用？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T05:12:08.950

我会说这样做的自然方法是使用 GROUP_CONCAT，如果没有 GROUP BY，就不可能做到这一点。

看来，GROUP BY 是做想要的事情的正确方法。

MySQL 可以使用 GROUP BY 完成此连接，无需临时表或文件排序，如果这是关于 GROUP BY 的问题。您需要确保存在与 GROUP BY 列匹配的索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T05:01:01.800

您是否正在寻找 MySqls [GROUP_CONCAT](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)函数。

# java - 如何从任何文件夹运行批处理文件

> ID：605150
> 
> 赞同：2
> 
> 时间：2009-03-03T04:49:45.243
> 
> 标签：java, batch-file

```
cd ../../jobs
set CLASSPATH=.;../xyz.jar;../mysql-connector-java-5.1.6-bin.jar
java folser.folder1 ../Files/MySQL.xml
cd .. 
```

我需要从任何目录运行批处理文件。我已经为java设置了路径。有谁能够帮我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T04:57:29.500

在 *nix 下（例如 Linux）：

```
cd "`dirname \"$0\"`"
# your current directoy is now the script's directory
cd ../../jobs
set CLASSPATH=.:../xyz.jar:../mysql-connector-java-5.1.6-bin.jar
java folder.folder1 ../Files/MySQL.xml
cd ..
# when the script terminates, you are automatically
#  back to the original directory 
```

在 Windows NT/XP/等下：

```
SETLOCAL
PUSHD .
REM current directory has been saved and environment is protected
CD /d %~dp0
REM your current directoy is now the script's directory
CD ..\..\jobs
SET CLASSPATH=.;..\xyz.jar;..\mysql-connector-java-5.1.6-bin.jar
java folder.folder1 ..\Files\MySQL.xml
CD ..
REM before the script terminates, you must explicitly
REM return back to the original directory
POPD
ENDLOCAL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-11T01:06:04.113

虽然我不能对弗拉德的回答发表评论（评论需要比答案更多的分数？！）我总是会警惕依赖：

```
CD /d %~dp0 
```

因为 Windows 不能 CD 到 UNC 路径，并且有一个令人讨厌的习惯，那就是让您进入 %windir% 而不是潜在的灾难性结果。

相反，虽然它更冗长，但您通常最好在每次需要完整路径时参考 %~dp0 （或包含该值的变量）。

坏的：

```
cd /d %~dp0
rd temp 
```

好的：

```
rd %~dp0\temp 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T04:54:57.463

您的消息有点乱码，我假设您说 java 在路径上，但您无法从批处理文件正确运行您的应用程序。看起来您缺少 java 的类路径选项 (-cp)。尝试这个：

> ```
> cd ../../jobs
> set CLASSPATH=.;../xyz.jar;../mysql-connector-java-5.1.6-bin.jar
> java -cp %CLASSPATH% folser.folder1 ../Files/MySQL.xml
> cd .. 
> ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T04:56:56.227

使用 %cd% 获取当前目录（即批处理文件所在的目录）

例如

 `````
set JAVA_HOME=%cd%\jdk1.x.x
set PATH=%JAVA_HOME%\bin;%PATH%
set CLASSPATH=%JAVA_HOME%\lib\tools.jar;%cd%\lib\myjar.jar;etc,etc 
````  `# css - Internet Explorer 6 背景色

> ID：605162
> 
> 赞同：3
> 
> 时间：2009-03-03T04:59:49.433
> 
> 标签：css, internet-explorer-6

我使用下面的代码将页面分成两半，28% 和 72%。但是wrapper标签设置的背景色应该填充28%；就我而言，它在[Internet Explorer 7](http://en.wikipedia.org/wiki/Internet_Explorer_7)中运行良好。

在[Internet Explorer 6](http://en.wikipedia.org/wiki/Internet_Explorer_6)中，背景颜色在 100% 的宽度上可见，而不是 28%。

我该如何解决？

### 我的代码：

```
#wrapper{ 
    float:left; 
    width:28%;
    background:#f5f5dc;  
} 
```

**HTML**

```
<div id="wrapper">
    <ul id="testnav">
        <li>  <a href="#">LOCATIONS</a>
            <ul id="subnav">
                <li id="content_1"><a href="#">Note </a></li>
            </ul>
        </li>
    </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-12T13:17:50.000

这是一个古老的 Internet Explorer 错误，只有*同时*存在复杂的[CSS](http://en.wikipedia.org/wiki/Cascading_Style_Sheets)和复杂的[HTML](http://en.wikipedia.org/wiki/HTML)时才会发生。例如，在[https://drupal.org/node/129014](https://drupal.org/node/129014)它也发生了。

什么对我有用：我在父母和孩子（在你的情况下，#wrapper）上都指定了背景颜色，并且两个[DOM](http://en.wikipedia.org/wiki/Document_Object_Model)节点也得到了缩放：1。

# ruby - 如何在 Ruby 中进行事件处理？

> ID：605169
> 
> 赞同：17
> 
> 时间：2009-03-03T05:05:58.827
> 
> 标签：ruby, design-patterns, events, observer-pattern

我来自 C# 背景，刚刚开始使用 Ruby 进行编程。问题是，我需要知道如何在我的类中引发事件，以便在需要发生事情时触发各种观察者。

问题是我所拥有的关于 Ruby 的书籍甚至都没有提到事件，更不用说提供示例了。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-03T08:22:31.893

问题已经得到解答，但是如果您想看一下，标准库中内置了一个[观察者。](http://www.ruby-doc.org/stdlib/libdoc/observer/rdoc/index.html)我过去曾将它用于一个小型游戏项目，并且效果很好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T05:25:27.967

我尝试用一​​点 C 和主要是 Ruby 在 Ruby 中编写一个 GUI 库。它最终变得如此缓慢，我放弃了并且从未发布它。但是我为它编写了一个事件系统，我试图使它比 C# 更容易。我重写了几次以使其更易于使用。我希望它有点帮助。

```
class EventHandlerArray < Array
  def add_handler(code=nil, &block)
    if(code)
      push(code)
    else
      push(block)
    end
  end
  def add
    raise "error"
  end
  def remove_handler(code)
    delete(code)
  end
  def fire(e)
    reverse_each { |handler| handler.call(e) }
  end
end

# with this, you can do:
#  event.add_handler
#  event.remove_handler
#  event.fire (usually never used)
#  fire_event
#  when_event
# You just need to call the events method and call super to initialize the events:
#  class MyControl
#    events :mouse_down, :mouse_up,
#           :mouse_enter, :mouse_leave
#    def initialize
#      super
#    end
#    def when_mouse_up(e)
#      # do something
#    end
#  end
#  control = MyControl.new
#  control.mouse_down.add_handler {
#    puts "Mouse down"
#  }
# As you can see, you can redefine when_event in a class to handle the event.
# The handlers are called first, and then the when_event method if a handler didn't
# set e.handled to true. If you need when_event to be called before the handlers,
# override fire_event and call when_event before event.fire. This is what painting
# does, for handlers should paint after the control.
#  class SubControl < MyControl
#    def when_mouse_down(e)
#      super
#      # do something
#    end
#  end
def events(*symbols)
  # NOTE: Module#method_added

  # create a module and 'include' it
  modName = name+"Events"
  initStr = Array.new
  readerStr = Array.new
  methodsStr = Array.new
  symbols.each { |sym|
    name = sym.to_s
    initStr << %Q{
      @#{name} = EventHandlerArray.new
    }
    readerStr << ":#{name}"
    methodsStr << %Q{
      def fire_#{name}(e)
        @#{name}.fire(e)
        when_#{name}(e) if(!e.handled?)
      end
      def when_#{name}(e)
      end
    }
  }
  eval %Q{
    module #{modName}
      def initialize(*args)
        begin
          super(*args)
        rescue NoMethodError; end
        #{initStr.join}
      end
      #{"attr_reader "+readerStr.join(', ')}
      #{methodsStr.join}
    end
    include #{modName}
  }
end

class Event
  attr_writer :handled
  def initialize(sender)
    @sender = @sender
    @handled = false
  end
  def handled?; @handled; end
end 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-08-02T19:23:17.883

极其简单的 Ruby 监听器。这并不能完全替代 .NET 事件，但这是一个非常简单的侦听器的非常简单的示例。

```
module Listenable

    def listeners() @listeners ||= [] end

    def add_listener(listener)
        listeners << listener
    end

    def remove_listener(listener)
        listeners.delete listener
    end

    def notify_listeners(event_name, *args)
        listeners.each do |listener|
            if listener.respond_to? event_name
                listener.__send__ event_name, *args
            end
        end
    end

end 
```

要使用：

```
class CowListenable
    include Listenable

    def speak
        notify_listeners :spoken, 'moooo!'
    end

end

class CowListener

    def initialize(cow_listenable)
        cow_listenable.add_listener self
    end

    def spoken(message)
        puts "The cow said '#{message}'"
    end

end

cow_listenable = CowListenable.new
CowListener.new(cow_listenable)
cow_listenable.speak 
```

输出：

```
The cow said 'moooo!' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-27T23:39:53.363

**披露：我是`event_aggregator`gem的维护者**

根据您想要解决问题的方式，您可能会使用事件聚合器。通过这种方式，您可以发布某种类型的消息，然后让您的对象监听您希望它们接收的类型。在某些情况下，这可能比正常事件更好，因为您的对象之间的耦合非常松散。事件生产者和监听者不需要共享对对方的引用。

有一个宝石可以帮助您解决这个问题，称为`event_aggregator`. 有了它，您可以执行以下操作：

```
#!/usr/bin/ruby

require "rubygems"
require "event_aggregator"

class Foo
    include EventAggregator::Listener
    def initialize()
        message_type_register( "MessageType1", lambda{|data| puts data } )

        message_type_register( "MessageType2", method(:handle_message) )
    end

    def handle_message(data)
        puts data
    end

    def foo_unregister(*args)
        message_type_unregister(*args)
    end
end

class Bar
    def cause_event
        EventAggregator::Message.new("MessageType1", ["Some Stuff",2,3]).publish
    end
    def cause_another_event
        EventAggregator::Message.new("MessageType2", ["Some More Stuff",2,3]).publish
    end
end

f = Foo.new

b = Bar.new
b.cause_event
b.cause_another_event
# => Some Stuff
     2
     3
# => Some More Stuff
     2
     3 
```

请注意，默认情况下它是异步的，因此如果您只执行此脚本，则脚本可能会在事件传递之前退出。要禁用异步行为，请使用：

```
EventAggregator::Message.new("MessageType1", ["Some Stuff",2,3], false).publish
#The third parameter indicates async 
```

希望这对您的情况有所帮助

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-03T05:30:14.837

我不确定你的意思是什么，但你可能会在你的类中使用异常并在某些“事件”上引发它们。如果您需要用于 GUI 开发的事件，那么大多数 GUI 框架都会定义自己的事件处理风格。

希望这有点回答你的问题。

# django - 如何为 django 使用 nginx 虚拟服务器 + fcgi？

> ID：605173
> 
> 赞同：18
> 
> 时间：2009-03-03T05:08:55.340
> 
> 标签：django, nginx, fastcgi

我想通过 nginx 运行几个虚拟主机，每个虚拟主机都通过 fcgi 为不同的 django 应用程序提供服务。这可能吗？如果是这样，是否有人有关于从哪里/如何开始的良好资源？nginx 文档似乎主要是示例，但我正在尝试的特定配置都没有......

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-03T05:25:03.723

最近有两篇关于设置 nginx 的不错的博客文章，但都使用 nginx 来提供静态（或缓存）内容，并使用 apache + mod_wsgi 来服务 Django。我自己更喜欢这个，因为 mod_wsgi 使流程管理比 fcgi 容易得多（还有其他优点）。

无论如何，这里是帖子：

*   [Django 和 Ubuntu 无畏年鉴](http://lethain.com/entry/2009/feb/13/the-django-and-ubuntu-intrepid-almanac/)
*   [django、nginx、memcached——动态三重奏](http://weichhold.com/2008/09/12/django-nginx-memcached-the-dynamic-trio/)

编辑：好吧，在我切换到 apache + mod_wsgi 之前，我用我的 nginx + django + 虚拟主机配置文件挖出了一个旧的 tar 文件。这是一台开发机器，因此您需要调整工人数、连接数等。

**nginx.conf：**

```
user nginx nginx;
worker_processes 2;

error_log /var/log/nginx/error_log info;

events {
    worker_connections  1024;
    use epoll;
}

http {
    include         /etc/nginx/mime.types;
default_type    application/octet-stream;

log_format main
            '$remote_addr - $remote_user [$time_local] '
    '"$request" $status $bytes_sent '
            '"$http_referer" "$http_user_agent" '
    '"$gzip_ratio"';

client_header_timeout   3m;
client_body_timeout     3m;
send_timeout            3m;

connection_pool_size            256;
client_header_buffer_size       1k;
large_client_header_buffers     4 2k;
request_pool_size               4k;

gzip on;
gzip_min_length 1100;
gzip_buffers    4 32k;
gzip_types      text/plain text/html application/x-javascript text/xml text/css;

output_buffers  4 32k;
postpone_output 1460;

sendfile        on;
tcp_nopush      on;
tcp_nodelay     on;

keepalive_timeout       75 20;

ignore_invalid_headers  on;

include vhosts.d/*.conf;
} 
```

因此，主 nginx.conf 包含 vhosts.d/ 子目录中的每个文件。我的文件之一是在 localhost 上提供 PHP（可能正在运行 phpMyAdmin），如下所示：

**vhosts.d/00_localhost：**

```
server {

  listen 127.0.0.1:80;
  server_name localhost;

  access_log /var/log/nginx/localhost.access_log main;
  error_log /var/log/nginx/localhost.error_log info;

  root /var/www/localhost/htdocs;
  index index.php index.html index.htm;

    location ~ .php$ {
        fastcgi_pass   127.0.0.1:8888;
        fastcgi_index  index.php;
        fastcgi_param  SCRIPT_FILENAME  /var/www/localhost/htdocs$fastcgi_script_name;
        fastcgi_param  QUERY_STRING     $query_string;
        fastcgi_param  REQUEST_METHOD   $request_method;
        fastcgi_param  CONTENT_TYPE     $content_type;
        fastcgi_param  CONTENT_LENGTH   $content_length;
  }
} 
```

然后是这样的本地 Django 开发服务器：

**50_django.local：**

```
server {

  listen  80;
  server_name django.local;

  access_log /var/log/nginx/django.access.log main;
  error_log /var/log/nginx/django.error.log info;

  root /var/www/django.local;

  location ~* ^.+\.(mpg|avi|mp3|swf|zip|tgz|gz|rar|bz2|doc|xls|exe|ppt|txt|tar|mid|midi|wav|rtf|mpeg)$ {
    access_log off;
    break;
  }

  location ~* ^.+\.(jpg|jpeg|gif|png|ico|css|bmp|js)$ {
    expires 30d;
    break;
  }

  location / {
    fastcgi_pass unix:/var/www/django.local/server.sock;
    include fastcgi.conf;
  }

  location ^~ /admin/ {
    fastcgi_pass unix:/var/www/django.local/server.sock;
    include fastcgi.conf;
    access_log off;
    auth_basic "Welcome to admin";
  }
} 
```

最后，每个虚拟服务器都包含每个位置的 fastcgi.conf。

**fastcgi.conf：**

```
fastcgi_pass_header Authorization;
fastcgi_intercept_errors off;

fastcgi_param PATH_INFO         $fastcgi_script_name;
fastcgi_param REQUEST_METHOD    $request_method;
fastcgi_param QUERY_STRING      $query_string;
fastcgi_param CONTENT_TYPE      $content_type;
fastcgi_param CONTENT_LENGTH    $content_length;
fastcgi_param SERVER_PORT       $server_port;
fastcgi_param SERVER_PROTOCOL   $server_protocol;
fastcgi_param SERVER_NAME       $server_name;

fastcgi_param REQUEST_URI       $request_uri;
fastcgi_param DOCUMENT_URI      $document_uri;
fastcgi_param DOCUMENT_ROOT     $document_root;
fastcgi_param SERVER_ADDR       $server_addr;
fastcgi_param REMOTE_USER       $remote_user;
fastcgi_param REMOTE_ADDR       $remote_addr;
fastcgi_param REMOTE_PORT       $remote_port;
fastcgi_param SERVER_SOFTWARE   "nginx";
fastcgi_param GATEWAY_INTERFACE "CGI/1.1";

fastcgi_param UID_SET           $uid_set;
fastcgi_param UID_GOT           $uid_got; 
```

我不确定以上所有内容都是必需的，但这是我切换到 mod_wsgi 的另一个原因...卓越的支持和文档 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:46:14.943

因为有人问了这个问题，所以有人创建了一个 pip 可安装的 django 包，它将从你的 settings.py 为你生成一个 apache 或 nginx vhost 文件

`pip install django-vhost`

在这里查看：[https ://bitbucket.org/djangostars/django-vhost](https://bitbucket.org/djangostars/django-vhost)

# xmpp - 什么是正确的 XMPP 客户端响应 节？

> ID：605177
> 
> 赞同：2
> 
> 时间：2009-03-03T05:11:50.340
> 
> 标签：xmpp

当我从服务器上的花名册中手动删除联系人时，服务器发送给我的内容如下（openfire）：

```
'<iq type="set" id="183-87" to="foo@edmund.local/hydra"><query xmlns="jabber:iq:roster"><item jid="bar@yahoo.edmund.local" name="baz" ask="unsubscribe" subscription="none"><group>Buddies</group></item></query></iq>'
'<iq type="set" id="187-88" to="foo@edmund.local/hydra"><query xmlns="jabber:iq:roster"><item jid="bar@yahoo.edmund.local" name="baz" subscription="none"><group>Buddies</group></item></query></iq>'
'<presence type="unsubscribed" to="foo@edmund.local" from="bar@yahoo.edmund.local"/>' 
```

如果我回复一个“取消订阅”状态节（根据 RFC 3921，我认为这是正确的），服务器会继续向我发送更多“未订阅”状态的垃圾邮件。

无论哪种方式，下次我的客户登录时，名册中都没有任何变化。难道我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T10:58:30.757

这取决于您在谈论哪个客户 - 是订阅者还是订阅者。

.

如果客户端是订阅者，那么什么都没有：

根据[第 9.4 节](http://xmpp.org/rfcs/rfc3921.html#rfc.section.9.4)，如果订阅者发送`unsubscribe`请求，或者其他原因导致客户端被取消订阅，服务器必须确认请求/报告状态更改并做出`unsubscribed`响应。互动到此结束。

`unsubscribe`如果订阅者每次收到来自服务器的状态通知时发送另一个请求`unsubscribed`，告诉它先前的订阅已被删除，那么它永远不会结束。

.

如果客户端是订阅节点，则可能会发送一个`unsubscribe`确认允许删除订阅，但是当您在正常机制之外更改名册时，这是否仍然有效，我不确定。

我对 9.4 中表格的阅读是针对取消订阅期间订阅者和服务器之间的消息：

```
subscriber            server             subscribee
    | -- unsubscribe --> |                    |
    |                    | -- unsubscribe --> |
    |                    | <- unsubscribed -- | (optional)
    |                    | -- unsubscribed -> |
    | <- unsubscribed -- |                    | 
```

我对[第 8.6 节](http://xmpp.org/rfcs/rfc3921.html#rfc.section.8.6)的阅读，名册删除是这样的：

```
subscriber            server             subscribee
    | ----- remove ----> |                    |
    |                    | -- unsubscribe --> |
    |                    | -- unsubscribed -> |
    |                    | -- unavailable --> |
    | <- unsubscribed -- |                    |
    | <-- unavailable -- |                    | 
```

任何一个客户都不需要确认。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T08:58:46.677

我太生疏了，无法直接回答您，但是由于已经有几个小时没有答案了，所以让我提个建议...

加载 pidgin 或其他可以记录 xmlstream 的客户端，从该客户端发送取消订阅，然后复制您在日志中看到的代码。

这将帮助您获得正确的节，或者它将识别 openfire 中的不兼容（不太可能，但谁知道）。

# wpf - 在 WPF 文本框中设置焦点

> ID：605179
> 
> 赞同：0
> 
> 时间：2009-03-03T05:13:23.330
> 
> 标签：wpf, vb.net

我正在 WPF 中编写一个控件，该控件在窗体上绘制一个形状，然后绘制该形状的尺寸。这些尺寸是可编辑的，因此它们显示在文本框中。当用户更改文本框中的尺寸时，形状会更新。

当显示尺寸的文本框失去焦点时，我正在更新形状，即一旦文本框失去焦点，形状和所有尺寸都会重绘。文本框以两种方式之一失去焦点 - 当用户按下 Tab 键或当用户单击文本框外的另一个控件时。

我的问题是，当用户按下 Tab 键或单击文本框外的其他位置时，整个控件将被重绘，并且焦点未设置到应位于的下一个控件。这真的很烦人，因为选项卡完全停止工作，并且要使用鼠标设置焦点，用户必须单击两次。有没有解决的办法？

我的控件的图像如下所示

[替代文字 http://img223.imageshack.us/img223/9496/cavity.png](http://img223.imageshack.us/img223/9496/cavity.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T15:16:05.987

似乎您想在此窗口中自己管理选项卡顺序并执行此操作，我认为您会订阅这些编辑字段上的 GotKeyboardFocus 和 LostKeyboardFocus 事件，然后如果您不满意，则将焦点移至适当的位置焦点已经转移到哪里。

# java - 如何在 Eclipse 项目中添加 Apache POI 库？

> ID：605181
> 
> 赞同：15
> 
> 时间：2009-03-03T05:15:35.057
> 
> 标签：java, eclipse

我从 apache.org 下载了 Apache POI，但不知道如何将它与我在 Eclipse 中的现有项目之一一起使用。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-03T20:11:02.160

有好几种方法，有的好，有的坏……

*   添加外部 Jar - 正如 jjnguy 所说的那样。*但是*，**这不是**一个好的选择...问题是，如果您与其他人共享您的项目并且他们将 jar 放在不同的位置，他们将获得构建路径错误

*   添加变量 - 类似于添加外部 jar，但更灵活。您可以定义一个类路径变量（在 Java 首选项下），它代表包含 jar 的目录。在您的项目中，当您添加变量时，您选择您定义的 var 并按“扩展”以指定实际的 jar。只要您和项目的其他开发人员定义变量，您就可以根据需要将 jar 放在不同的位置

*   将 jar 添加到您的项目中 - 在您的项目中创建一个目录（可选，可能称为 lib）并使用 File->Import 将 jar 导入其中，或者如果您的操作系统支持，将其作为图标拖到文件夹中（在 windows I打开一个资源管理器窗口并将其从那里拖到eclipse中的文件夹中）。然后，右键单击 jar 并选择 Build-Path->Add to build path。

*   在单独的项目中添加 jar 并引用它。将最后一个项目符号中提到的 jar 添加到该 jar 的单独项目中。从项目中选择 Build-Path->Configure Build path。转到“订购和导出”选项卡并确保检查 jar。现在您可以配置您的项目以引用新项目。这使事情变得更加模块化。

*   创建一个用户库 - 在 Java 首选项下，您可以定义一个包含 jar 的“用户库”。这有点类似于类路径变量，但可以引用多个 jar，您只需将其添加到项目中一次。

*   创建一个类路径容器插件。这更复杂，但如果您为人们提供一组插件，这是一个不错的选择。类路径容器可以像库一样添加到项目中，它可以管理 jar，甚至可以根据需要搜索它们。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T05:22:26.757

您可以在以下位置找到将外部 jars 添加到项目的选项：Project > Properties > Java Build Path > Libraries 选项卡。

单击“添加外部 Jar”并找到您拥有 POI 库的位置。

# sql - 不同的sql查询

> ID：605182
> 
> 赞同：0
> 
> 时间：2009-03-03T05:16:14.260
> 
> 标签：sql

我有一个简单的表，只有名称和电子邮件，名为 name_email。

我正在尝试从中获取数据，以便：如果两行**具有相同的名称**，但一个具有以“@yahoo.com”结尾的电子邮件，而另一行具有不同的电子邮件，则具有“@”的那一个yahoo.com 的电子邮件应该被丢弃。

获取这些数据的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T05:44:48.967

好的，我不会再与那些说我不应该提倡数据库模式更改的人打架了（是的，你知道你是谁 :-)，但这就是我的做法。

1/如果你绝对不能改变模式，我会用代码解决它（无论是数据库外的真正诚实的程序代码，还是作为你的 DBMS 允许的任何语言的存储过程）。

这将检查数据库中的非雅虎名称并返回它，如果有的话。如果不存在，它将尝试返回 yahoo 名称。如果两者都不存在，它将返回一个空数据集。

2/ 如果您可以更改架构并且您希望 SQL 查询来完成这项工作，我会这样做。在您的表中创建一个名为 CLASS 的单独列，对于非雅虎地址，该列预计设置为 0，雅虎地址设置为 1。

创建插入/更新触发器以检查行的每次添加或更改，根据电子邮件地址（以什么结尾）设置 CLASS。这保证了 CLASS 将始终正确设置。

当您查询您的表时，按名称和类对其进行排序，并且只选择第一行。这将为您提供以下首选项的电子邮件地址：非雅虎、雅虎、空数据集。

就像是：

```
select name, email
from tbl
where name = '[name]'
order by name, class
fetch first row only; 
```

如果您的 DBMS 没有等效于 DB2 的“仅获取第一行”子句，您可能仍然需要编写代码来只处理一条记录。

如果您想处理所有名称，但只处理该名称的特定所需电子邮件，那么这样的程序就足够了（我对尝试以程序方式使用 SQL 等关系代数的观点非常残酷，所以我不会在这里把它们强加给你）：

```
# Get entire table contents sorted in name/class order.
resultSet = execQuery "select name, email from tbl order by name, class"

# Ensure different on first row
lastName = resultSet.value["name"] + "X"

# Process every single row returned.
while not resultSet.endOfFile:
    # Only process the first in each name group (lower classes are ignored).
    if resultSet.value["name"] != lastName:
        processRow resultSet.value["name"] resultSet.value["email"]
    # Store the last name so we can detect next name group.
    lastName = resultSet.value["name"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T07:00:02.547

```
select ne.*
from name_email ne
where ne.email not like '%@yahoo.com' escape '\' or
    not exists(
               select 1 from name_email
               where name = ne.name and
               email not like '%@yahoo.com' escape '\'
              ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T05:26:28.417

您可以使用以下内容来排除无效的电子邮件地址：

```
SELECT name, email
FROM name_email
WHERE email NOT LIKE '%@yahoo.com' // % symbol is a wildcard so joe@yahoo.com and guy@yahoo.com both match this query.
AND name = 'Joe Guy'; 
```

或者这样做只包含有效的电子邮件地址或域：

```
SELECT name, email
FROM name_email
WHERE email LIKE '%@gmail.com'
AND name = 'Joe Guy'; 
```

如果您提前知道要查询的特定名称以及要排除或包含的电子邮件地址或域，则此方法效果很好。

或者，如果您不在乎返回哪个电子邮件地址，而只想返回一个，则可以使用以下内容：

```
SELECT DISTINCT (name, email)
FROM name_email; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T05:42:16.727

你可以做

```
SELECT TOP 1 email
FROM name_email
WHERE name = 'Joe Guy'
ORDER BY case when email like '%yahoo.com' then 1 else 0 end 
```

因此，最后按 *@yahoo.com 排序它们，然后按其他排序，然后取第一个。

编辑：对不起，误读了这个问题——你想要一个每个名字的列表，只有一封电子邮件，以及对非雅虎电子邮件的偏好。大概可以将上面的内容与group by一起使用，我将不得不重新考虑它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T06:15:32.900

从数据库中获取所有行，不知道名称是什么（并且不需要真正关心），但只是希望它们显示，如果匹配，如果电子邮件包含，则跳过匹配，在这种情况下，**@yahoo .com**

```
SELECT DISTINCT name, email FROM name_email 
  WHERE email NOT LIKE '%@yahoo.com' 
  GROUP BY name; 
```

这样做会抓取所有行，但如果名称与另一行匹配，则只会抓取一条记录。但是，如果有两行名称匹配，请将电子邮件中的**@yahoo.com 删除。**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T10:56:32.743

不是很漂亮，但我相信它应该工作

```
select 
    ne.name 
    ,ne.email
from 
    name_email ne
    inner join (
        select 
            name 
            ,count(*) as emails_per_name
        from 
            name_email
        group by name
    ) nec 
        on ne.name = nec.name
where
    nec.emails_per_name = 1
    or (nec.emails_per_name > 1 and ne.email not like ('%@yahoo.com')) 
```

这是假设重复的电子邮件将在 yahoo.com 域中 - 如您的问题中所指定，如果每个名称有超过一封电子邮件，这些将被排除在外

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T13:25:07.860

如果您使用 SQL Server 2005 或 Oracle，您可以使用排名（分析）功能轻松解决您的问题。

```
select a.name, a.name_email
from (select name, name_email,
             row_number() over (partition by name
                                order by case
                                           when name_email like '%@yahoo.com' then 1
                                           when name_email like '%@gmail.com' then 1
                                           when ... (other 'generic' email) then 1
                                           else 0
                                         end) as rn) as a
where a.rn = 1 
```

通过为各种通用电子邮件名称分配不同的值，您甚至可以拥有“首选项”。正如这里所写，如果您同时拥有 yahoo 和 gmail 地址，则无法预测会选择哪一个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T13:34:50.007

您可以为此使用 UNION。选择没有 yahoo.com 的所有内容，然后只选择有 yahoo.com 且不在第一个列表中的记录。

SELECT DISTINCT (name, name_email) FROM TABLE WHERE name_email NOT '%yahoo.com' UNION SELECT DISTINCT (name, name_email) FROM TABLE WHERE name NOT IN (SELECT DISTINCT (name, name_email) FROM TABLE WHERE name_email NOT '%yahoo.com ')

# multithreading - 如果有的话，Erlang 进程如何映射到内核线程？

> ID：605183
> 
> 赞同：48
> 
> 时间：2009-03-03T05:16:26.007
> 
> 标签：multithreading, erlang, parallel-processing, lightweight-processes

Erlang 以能够支持许多轻量级进程而闻名。它可以这样做是因为这些不是传统意义上的进程，甚至不是 P 线程中的线程，而是完全在用户空间中的线程。

这很好（实际上很棒）。但是，Erlang 线程如何在多核/多处理器环境中并行执行呢？当然，它们必须以某种方式映射到内核线程才能在单独的内核上执行吗？

假设是这种情况，这是如何完成的？许多轻量级进程是否映射到单个内核线程？

或者有没有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-03-03T09:03:41.687

答案取决于使用的 VM：

1）*非SMP*：有**一个调度**器（OS线程），它执行所有Erlang进程，取自**可运行进程池**（即那些没有被eg阻塞的`receive`）

2）*SMP*：有**K个调度**器（OS线程，K通常是CPU核数），从**共享进程队列**中执行Erlang进程。它是一个简单的 FIFO 队列（带有锁以允许从多个 OS 线程同时访问）。

3) *R13B 和更新版本中的 SMP*：将有**K 个调度程序**（如前所述）从**多个进程队列**执行 Erlang 进程。每个调度程序都有自己的队列，因此将添加从一个调度程序到另一个调度程序的进程*迁移逻辑。*此解决方案将通过避免共享进程队列中的过度锁定来提高性能。

有关详细信息，请参阅爱立信公司的 Kenneth Lundin 为 2008 年 11 月 13 日在斯德哥尔摩举行的 Erlang 用户大会准备的[文档。](http://www.erlang.se/euc/08/euc_smp.pdf)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-30T23:49:27.953

我想修改以前的答案。

Erlang，或者更确切地说是 Erlang 运行时系统 (erts)，将调度程序（OS 线程）的数量和运行队列的数量默认为平台上的处理元素数量。那是处理器内核或硬件线程。您可以使用以下方法在运行时更改这些设置：

```
erlang:system_flag(schedulers_online, NP) -> PrevNP 
```

Erlang 进程还没有与任何调度程序有任何关联。在调度程序之间平衡进程的逻辑遵循两个规则。1) 饥饿的调度器会窃取另一个调度器的工作。2) 迁移路径设置为将进程从具有大量进程的调度程序推送到具有较少工作的调度程序。这样做是为了确保每个进程的减少计数（执行时间）的公平性。

然而，调度程序可以锁定到特定的处理元素。默认情况下不这样做。要让 erts 执行 scheduler->core affinity 使用：

```
erlang:system_flag(scheduler_bind_type, default_bind) -> PrevBind 
```

在文档中可以找到其他几种绑定类型。在重负载情况下使用亲和力可以大大提高性能！特别是在高锁争用情况下。此外，至少可以说，Linux 内核无法处理超线程。如果您的平台上有超线程，您应该在 erlang 中真正使用此功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T05:31:17.500

我在这里纯粹是猜测，但我想有少量线程，它们从公共进程池中选择进程来执行。一旦一个进程遇到阻塞操作，执行它的线程就会把它放在一边并选择另一个。当一个正在执行的进程导致另一个进程被解除阻塞时，该新解除阻塞的进程将被放入池中。我想一个线程也可能会停止一个进程的执行，即使它在某些点没有被阻塞以服务其他进程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-18T12:44:54.000

我想为接受的答案中描述的内容添加一些输入。

Erlang 调度器是 Erlang 运行时系统的重要组成部分，它提供了自己的抽象和实现操作系统线程之上的轻量级进程的概念。

每个调度程序都在单个 OS 线程中运行。通常情况下，硬件上的 CPU（内核）有多少个调度器（虽然它是可配置的，当调度器的数量超过硬件内核的数量时自然不会带来太多价值）。系统也可能被配置为调度程序不会在操作系统线程之间跳转。

现在，当创建 Erlang 进程时，ERTS 和调度程序完全负责管理生命周期和资源消耗以及内存占用等。

核心实现细节之一是，当调度程序从运行队列中选择该进程时，每个进程都有 2000 次可用的时间预算。保证系统中的每一个进展（甚至是 I/O）都有一个减少预算。这就是使 ERTS 成为具有抢先式多任务处理系统的真正原因。

我会推荐 Jesper Louis Andersen 关于该主题的一篇很棒的博客文章[http://jlouisramblings.blogspot.com/2013/01/how-erlang-does-scheduling.html](http://jlouisramblings.blogspot.com/2013/01/how-erlang-does-scheduling.html)

作为简短的回答：Erlang 进程不是操作系统线程，并且不直接映射到它们。Erlang 调度程序是在操作系统线程上运行的，并提供更细粒度的 Erlang 进程的智能实现，将这些细节隐藏在程序员的眼睛后面。

# c# - 如何对列表进行排序 基于 T?

> ID：605189
> 
> 赞同：15
> 
> 时间：2009-03-03T05:20:22.923
> 
> 标签：c#, sorting, generic-list

我的代码如下所示：

```
Collection<NameValueCollection> optionInfoCollection = ....
List<NameValueCollection> optionInfoList = new List<NameValueCollection>();
optionInfoList = optionInfoCollection.ToList();

if(_isAlphabeticalSoting)
   Sort optionInfoList 
```

我尝试了 optionInfoList.Sort() 但它不起作用。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-03T05:38:59.213

使用 sort 方法和 lambda 表达式，真的很容易。

```
myList.Sort((a, b) => String.Compare(a.Name, b.Name)) 
```

上面的示例显示了如何按对象类型的 Name 属性进行排序，假设 Name 是字符串类型。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-03T05:43:39.763

如果你只是想`Sort()`工作，那么你需要实现`IComparable`或`IComparable<T>`在课堂上。

如果您不介意创建*新*列表，可以使用`OrderBy`/ `ToList`LINQ 扩展方法。如果你想用更简单的语法对现有列表进行排序，你可以添加一些扩展方法，启用：

```
list.Sort(item => item.Name); 
```

例如：

```
public static void Sort<TSource, TValue>(
    this List<TSource> source,
    Func<TSource, TValue> selector)
{
    var comparer = Comparer<TValue>.Default;
    source.Sort((x, y) => comparer.Compare(selector(x), selector(y)));
}
public  static void SortDescending<TSource, TValue>(
    this List<TSource> source,
    Func<TSource, TValue> selector)
{
    var comparer = Comparer<TValue>.Default;
    source.Sort((x, y) => comparer.Compare(selector(y), selector(x)));
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-21T19:26:31.430

```
public class Person  {
    public string FirstName { get; set; }
    public string LastName { get; set; }
}

List<Person> people = new List<Person>();

people.Sort(
    delegate(Person x, Person y) {
        if (x == null) {
            if (y == null) { return 0; }
            return -1;
        }
        if (y == null) { return 0; }
        return x.FirstName.CompareTo(y.FirstName);
    }
); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T05:26:38.807

您需要设置一个比较器，告诉 Sort() 如何排列项目。

查看[List.Sort 方法 (IComparer)](http://msdn.microsoft.com/en-us/library/234b841s.aspx)以获取有关如何执行此操作的示例...

# sql-server - SQL Server 中的键是全局的 - 为什么？

> ID：605193
> 
> 赞同：1
> 
> 时间：2009-03-03T05:22:40.813
> 
> 标签：sql-server, key, naming

MS SQL Server 中的索引和约束在它们定义的表中是本地的。因此，您可以在多个表中创建相同的索引或约束名称而不会遇到麻烦。

外键约束（每个人都应该知道不是键，而是约束）将出现在 Keys 子文件夹中，并且它们的名称似乎是全局范围的。

有人知道为什么“键”具有全局范围的名称吗？我确实了解键和索引之间的区别。我不明白为什么名称范围会有如此大的差异。在所有情况下，它们对于为其定义的表都是“本地的”。

TIA

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T05:39:13.970

根据 Peter Gulutzan 和 Trudy Pelzer 的“SQL-99 Complete, real”，约束名称由它们所在的*模式*限定，并且约束影响的表必须位于相同的模式中。但是约束名称不受该表名的限制。约束名称在它所在的架构中必须是唯一的。

*   是的：`myschema.some_primary_key`
*   不： `myschema.mytable.some_primary_key`

至于“为什么”会出现这种情况，我认为它与 SQL-99 中的一种约束有关，称为`ASSERTION`. 断言不“属于”单个表，主键、外键和检查约束也是如此。断言声明了一个条件，该条件必须为真才能使任何`INSERT/UPDATE/DELETE`成功，并且断言可以引用多个表。用任何表来限定这些约束名称是没有意义的。

不知道有多少个RDBMS品牌实现了SQL断言（其实我一个也不知道），但是他们还不如遵守标准的SQL规则约束名称，所以将来他们可以选择实现断言功能符合标准。

# http-caching - 管理重复下载

> ID：605195
> 
> 赞同：0
> 
> 时间：2009-03-03T05:24:14.367
> 
> 标签：http-caching

在我的公司，我们主要是在个人机器上自行管理软件安装。通常有几个用户下载同一个文件。是否有可用于缓存下载和排队新下载请求的工具？我正在寻找一种解决方案，如果用户在本地存在之前下载的副本，但仍允许用户从 Internet 下载新副本（如果他愿意的话）。这样的工具存在吗？

**编辑：**为什么不赞成/关闭？与编程无关？这不是很多开发团队共同的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T05:45:52.113

您可能正在寻找缓存 HTTP 代理，例如[SQUID](http://www.squid-cache.org/)。以我的经验，即使对于大型安装，如 Debian Linux（约 2GB 下载），正确配置它也会有所帮助，尽管对于 Debian 案例，有专门的工具，如 apt-cache。

# gridview - 如何在网格视图控件中选择特定的单元格值？

> ID：605212
> 
> 赞同：0
> 
> 时间：2009-03-03T05:35:30.423
> 
> 标签：gridview

如何在网格视图控件中选择特定单元格值以存储在另一个变量（字符串）中。

我在 GridView 中创建了一个空行，并在该行中输入了空白值。

我现在如何从 GridView 更新数据库表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-09T09:30:27.390

```
foreach(GridViewRow row in this.urgridname.Rows)
{
var a=row.Cells[1].Text
} 
```

获取 GridView 行的单元格值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-10-10T17:35:29.443

***如何在网格视图控件中选择特定单元格值以存储在另一个变量（字符串）中。***

***我现在如何从 GridView 更新数据库表？***

这些是单独的问题

***如何在网格视图控件中选择特定单元格值以存储在另一个变量（字符串）中。***

```
String value = myGridView.Rows(x).Cells(y).ToString() 
```

***我现在如何从 GridView 更新数据库表？***

如果您使用的是 DataSet 并将 GridView 绑定到 DataTable，则需要为该 DataTable 调用 TableAdapter 上的 Update 方法：

```
myAdapter.Update(myDataSet.myDataTable) 
```

# vb6 - 寻找比 FlexGrid 更多的 VB6 网格

> ID：605213
> 
> 赞同：0
> 
> 时间：2009-03-03T05:35:39.877
> 
> 标签：vb6, grid

我真正需要的只是 2 列。第一列将有一些文本，第二列需要有一个组合框，允许用户从中选择。

如果控件是免费的，则奖励。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T08:54:28.527

你检查过VBAccelerator的[S-Grid了吗？](http://vbaccelerator.com/home/VB/Code/Controls/S_Grid_2/S_Grid_2/article.asp)

也得到了很好的性能比较 -[文章](http://vbaccelerator.com/home/VB/Code/Controls/S_Grid_2/Performance/article.asp)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T05:52:31.443

这不是datagrid在VB6中提供的吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T08:19:09.843

我们使用[VSFlexGrid](http://www.componentsource.com/products/componentone-vsflexgrid-pro/index.html)，由编写 MSFlexGrid 的人编写的 IIRC，MSFlexGrid 随 Visual Studio 提供，但具有更多功能，包括单元内组合。

在另一个项目中，我使用隐藏的组合和免费的 MSFlexGrid 编写代码来“伪造”：在网格的 _Click 事件中，移动组合并调整其大小以适应单元格（必要时考虑滚动条），设置 ZOrder（带到前面），使 Visible 和 SetFocus。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T08:32:29.343

Janus Grid ( [http://www.janusys.com/janus/library/HTMLFiles/GridEX2000/GridEX2000.htm](http://www.janusys.com/janus/library/HTMLFiles/GridEX2000/GridEX2000.htm) )，支持这个，但它不是免费的

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-03T16:00:20.093

组件一构建了一个我们在各处使用的全能网格。这是一个很棒的工具，我们对此非常满意。

*   便于使用; 非常深思熟虑。
*   很好的帮助和文档。
*   它只是工作；我们没有遇到任何问题。
*   属性和方法是有意义的，并且完全按照他们应该做的。

[http://www.componentone.com/SuperProducts/VSFlexGridPro/](http://www.componentone.com/SuperProducts/VSFlexGridPro/)

以下是我们应用程序中网格的一些屏幕截图：

[替代文字 http://img15.imageshack.us/img15/3339/tempwvr.jpg](http://img15.imageshack.us/img15/3339/tempwvr.jpg)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-19T22:56:18.987

这是一个免费的网格，它被实现为没有依赖关系的单文件控件。它的重量相当轻且易于实施。

[山猫网格](http://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=70425&lngWId=1)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-10T14:51:11.107

了解更多优秀的 3rd-party 网格控件，例如 FlexGrid。它不是免费的，但足够便宜并且仍然受支持。这是来自 10tec 的 iGrid：http: [//10tec.com/activex-grid/](http://10tec.com/activex-grid/)

顺便说一句，它的第一个版本是基于 vbAccelerator SGrid，但现在它走自己的路了；）

# sql-server - TSQL - 对联合查询求和

> ID：605217
> 
> 赞同：23
> 
> 时间：2009-03-03T05:37:10.700
> 
> 标签：sql-server, tsql

我在存储过程中有一个联合所有查询。

我想做的是对一列求和并将该查询返回给客户端

我该怎么做？

马尔科姆

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-03T06:03:25.537

```
SELECT
    othercol1, othercol2,
    SUM(bar)
FROM
    (
    SELECT
       othercol1, othercol2, bar
    FROM
       RT
    UNION ALL
    SELECT
       othercol1, othercol2, bar
    FROM
       FM
    ) foo
GROUP BY
    othercol1, othercol2 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-03T06:00:23.670

```
SELECT SUM(MyCol) FROM
(
SELECT ... MyCol FROM Table1
UNION ALL
SELECT ... MyCol FROM Table2
)as tbl 
```

# c# - 套接字编程

> ID：605220
> 
> 赞同：1
> 
> 时间：2009-03-03T05:39:18.090
> 
> 标签：c#, sockets

我试图在 c# 中创建一个服务器应用程序。在代码中我使用的是 TcpListener 类。

```
 TcpListener t = new TcpListener(5555);
    t.Start(); 

```

但是，它提供了一个错误消息：类、结构或接口成员声明中的标记“（”无效。

是否需要额外的参考资料？
请帮忙。

```
 namespace WindowsApplication1
{
    public partial class lanmessenger : Form
    {
        [DllImport("user32.dll")]
        static extern bool HideCaret(IntPtr hWnd);

        public lanmessenger()
        {
            InitializeComponent();
        }

        private void textBox1_TextChanged(object sender, EventArgs e)
        {

        }
        private void button1_Click(object sender, EventArgs e)
        {
            StringBuilder sb = new StringBuilder(this.textBox1.Text);
            sb.AppendLine(this.textBox2.Text);
            this.textBox1.Text = sb.ToString();
            this.textBox2.Text = "\0";
            HideCaret(this.textBox1.Handle);
        }
        private void textBox1_MouseClick(object sender, MouseEventArgs e)
        {
            HideCaret(this.textBox1.Handle);
        }
        StreamWriter streamWriter;
        StreamReader streamReader;
        NetworkStream networkStream;
        TcpListener t = new TcpListener(5555);
        t.Start();

    }
} 

```

这是到目前为止的完整源代码。我无法找到错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T05:47:35.263

对我来说很好。您需要在代码中添加以下行。

使用 System.Net.Sockets；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T05:48:10.393

如果您在项目中有对 System.dll 的引用并且有 System.Net.Sockets 命名空间的 using 语句，那么您提供的代码没有任何问题。

看起来你在某个地方有太多的“（”。

您对 t.Start() 的调用必须在类的方法中。这是错误的：

```
class lanmessenger
{
    ...
    TcpListener t = new TcpListener(5555);  // ok to initialize like this
    t.Start();  // wrong...put this in a method
} 
```

这是对的：

```
class lanmessenger
{
    TcpListener t = new TcpListener(5555);  // ok to initialize like this

    public lanmessenger
    {
        InitializeComponent();
        t.Start();  // put it here
    }    
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T05:50:31.760

你不会忘记把代码放在某个类的某个方法中吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T06:40:34.730

是的，这里的问题只是这段代码不在你的类的方法中：

t.Start();

这就是给你特定的编译器错误的原因。您不能调用类本身中的方法，该方法必须在其他方法中。从语法上讲，其他东西在哪里都很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T20:53:23.610

您确定不想将 WCF 用于服务器应用程序吗？

# ruby-on-rails - 尝试让我的第一个 Rails 应用程序运行时出错

> ID：605223
> 
> 赞同：0
> 
> 时间：2009-03-03T05:39:36.887
> 
> 标签：ruby-on-rails

我有一本书叫“Learning Ruby”，在 Rails 部分下，一步一步地介绍了如何创建一个简单的 Rails Web 应用程序。

它说在最后键入命令：

> ./script/generate 脚手架地址簿地址簿

但是在中途我得到了错误：

> 参数数量错误（1 对 2）

我认为这是因为版本略有不同，但我无法让我的 rails 应用程序正常工作，希望这里有人能帮助我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T05:46:41.597

如果你`script/generate scaffold`不带任何参数运行，它会告诉你如何使用它：

```
$ script/generate scaffold
Usage: script/generate scaffold ModelName [field:type, field:type]

Options:
        --skip-timestamps            Don't add timestamps to the migration file for this model
        --skip-migration             Don't generate a migration file for this model
        --force-plural               Forces the generation of a plural ModelName

Rails Info:
    -v, --version                    Show the Rails version number and quit.
    -h, --help                       Show this help message and quit.

General Options:
    -p, --pretend                    Run but do not make any changes.
    -f, --force                      Overwrite files that already exist.
    -s, --skip                       Skip files that already exist.
    -q, --quiet                      Suppress normal output.
    -t, --backtrace                  Debugging: show backtrace on errors.
    -c, --svn                        Modify files with subversion. (Note: svn must be in path)
    -g, --git                        Modify files with git. (Note: git must be in path)

Description:
    Scaffolds an entire resource, from model and migration to controller and
    views, along with a full test suite. The resource is ready to use as a
    starting point for your RESTful, resource-oriented application.

    Pass the name of the model (in singular form), either CamelCased or
    under_scored, as the first argument, and an optional list of attribute
    pairs.

    Attribute pairs are column_name:sql_type arguments specifying the
    model's attributes. Timestamps are added by default, so you don't have to
    specify them by hand as 'created_at:datetime updated_at:datetime'.

    You don't have to think up every attribute up front, but it helps to
    sketch out a few so you can start working with the resource immediately.

    For example, 'scaffold post title:string body:text published:boolean'
    gives you a model with those three attributes, a controller that handles
    the create/show/update/destroy, forms to create and edit your posts, and
    an index that lists them all, as well as a map.resources :posts
    declaration in config/routes.rb.

    If you want to remove all the generated files, run
    'script/destroy scaffold ModelName'.

Examples:
    `./script/generate scaffold post`
    `./script/generate scaffold post title:string body:text published:boolean`
    `./script/generate scaffold purchase order_id:integer amount:decimal` 
```

# java - boolean[] vs. BitSet：哪个更有效？

> ID：605226
> 
> 赞同：71
> 
> 时间：2009-03-03T05:40:42.547
> 
> 标签：java, arrays, performance, memory, bitsets

就内存和 CPU 使用而言，什么更有效 - s 数组`boolean`或 BitSet？不使用特定的 BitSet 方法，仅使用 get/set/clear（==、=、Arrays.fill 分别为数组）。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-03-03T21:04:06.620

*   `Boolean[]`每个布尔值使用大约 4-20 个字节。
*   `boolean[]`每个布尔值使用大约 1 个字节。
*   `BitSet`每个布尔值使用大约 1 位。

内存大小对您来说可能不是问题，在这种情况下 boolean[] 可能更容易编码。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-03-03T07:41:08.687

从一些使用 Sun JDK 1.6 计算素数的基准测试（最好的 10 次迭代来预热，给 JIT 编译器一个机会，并排除随机调度延迟，Core 2 Duo T5600 1.83GHz）：

除了非常小的尺寸外，BitSet 比 boolean[] 更节省内存。数组中的每个布尔值都占用一个字节。来自 runtime.freeMemory() 的数字对于 BitSet 来说有点混乱，但更少。

boolean[] 的 CPU 效率更高，除了非常大的尺寸，它们大约是均匀的。例如，对于大小为 100 万的 boolean[] 大约快四倍（例如 6 毫秒对 27 毫秒），对于 10 和 1 亿，它们大约是偶数。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2018-07-19T11:38:53.697

在这里，您可以看到比较 boolean[][] 三角矩阵与 BitSet[] 三角矩阵的内存/时间基准。

我创建、设置和读取 (size * (size-1) / 2) 值并比较内存使用情况和时间......

[![在此处输入图像描述](https://i.stack.imgur.com/3mA2B.png)](https://i.stack.imgur.com/3mA2B.png)

[![在此处输入图像描述](https://i.stack.imgur.com/q3upz.png)](https://i.stack.imgur.com/q3upz.png)

希望这有助于...

这里的代码......（只是一个快速肮脏的测试代码，对不起;）

```
import java.util.BitSet;
import java.util.Date;

public class BooleanBitSetProfiler {

    Runtime runtime;
    int sum = 0;
    public void doIt() {

        runtime = Runtime.getRuntime();
        long[][] bitsetMatrix = new long[30][2];
        long[][] booleanMatrix = new long[30][2];
        int size = 1000;
        for (int i = 0; i < booleanMatrix.length; i++) {
            booleanMatrix[i] = testBooleanMatrix(size);
            bitsetMatrix[i] = testBitSet(size);
            size += 2000;
        }
        int debug = 1;
        for (int j = 0; j < booleanMatrix.length; j++){
            System.out.print(booleanMatrix[j][0] + ";");
        }
        System.out.println();
        for (int j = 0; j < booleanMatrix.length; j++){
            System.out.print(booleanMatrix[j][1] + ";");
        }
        System.out.println();
        for (int j = 0; j < bitsetMatrix.length; j++){
            System.out.print(bitsetMatrix[j][0] + ";");
        }
        System.out.println();
        for (int j = 0; j < bitsetMatrix.length; j++){
            System.out.print(bitsetMatrix[j][1] + ";");
        }
        System.out.println();
    }

    private long memory () {
        return runtime.totalMemory() - runtime.freeMemory();
    }
    private long[] testBooleanMatrix(int size) {
        runtime.gc();
        long startTime = new Date().getTime();
        long startMemory = memory();
        boolean[][] matrix = new boolean[size][];
        for (int i = 0; i < size; i++) {
            matrix[i] = new boolean[size - i - 1];
        }
        long creationMemory = memory();
        long creationTime = new Date().getTime();
        for (int i = 0; i < size; i++)  {
            for (int j = 0; j < matrix[i].length; j++) {
                matrix[i][j] = i % 2 == 0;
            }
        }
        long setMemory = memory();
        long setTime = new Date().getTime();
        for (int i = 0; i < size; i++)  {
            for (int j = 0; j < matrix[i].length; j++) {
                if (matrix[i][j]) sum++;
            }
        }
        long readTime = new Date().getTime();
        System.out.println("Boolean[][] (size " + size + ")");
        System.out.println("Creation memory " + printMem(creationMemory-startMemory) + ", set memory " + printMem(setMemory-startMemory));
        System.out.println("Creation time " + printTime(creationTime-startTime) + ", set time " + printTime(setTime - creationTime) + " read time " + printTime(readTime - setTime) + "\n");
        runtime.gc();
        return new long[]{(setMemory-startMemory)/(1024*1024), (readTime-startTime)};
    }
    private long[] testBitSet(int size) {
        runtime.gc();
        long startTime = new Date().getTime();
        long startMemory = memory();
        BitSet[] matrix = new BitSet[size];
        for (int i = 0; i < size; i++) {
            matrix[i] = new BitSet(size - i - 1);
        }
        long creationMemory = memory();
        long creationTime = new Date().getTime();
        for (int i = 0; i < size; i++)  {
            for (int j = 0; j < matrix[i].size(); j++) {
                matrix[i].set(j, (i % 2 == 0));
            }
        }
        long setMemory = memory();
        long setTime = new Date().getTime();
        for (int i = 0; i < size; i++)  {
            for (int j = 0; j < matrix[i].size(); j++) {
                if (matrix[i].get(j)) sum++;
            }
        }
        long readTime = new Date().getTime();
        System.out.println("BitSet[] (size " + size + ")");
        System.out.println("Creation memory " + printMem(creationMemory-startMemory) + ", set memory " + printMem(setMemory-startMemory));
        System.out.println("Creation time " + printTime(creationTime-startTime) + ", set time " + printTime(setTime - creationTime) + " read time " + printTime(readTime - setTime) + "\n");
        runtime.gc();
        return new long[]{(setMemory-startMemory)/(1024*1024), (readTime-startTime)};
    }

    private String printMem(long mem) {
        mem = mem / (1024*1024);
        return mem + "MB";
    }
    private String printTime(long milis) {
        int seconds = (int) (milis / 1000);
        milis = milis % 1000;
        return seconds > 0 ? seconds + "s " + milis + "ms" : milis + "ms";
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-03T21:42:47.667

您的问题有点左字段，但如果存储是一个问题，您可能需要研究[Huffman compression](http://en.wikipedia.org/wiki/Huffman_coding)。例如，`00000001`可以按频率压缩到等价于`{(7)0, (1)1}`. 更“随机化”的字符串`00111010`将需要更复杂的表示，例如`{(2)0, (3)1, (1)0, (1)1, (1)0}`，并占用更多空间。根据您的位数据的结构，您可能会从它的使用中获得一些存储优势，超越`BitSet`.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-11-05T12:14:56.973

至于内存， a 的文档[`BitSet`](http://docs.oracle.com/javase/7/docs/api/java/util/BitSet.html)具有非常明确的含义。尤其：

> 每个位集都有一个当前大小，即该位集当前使用的空间位数。请注意，大小与位集的实现有关，因此它可能会随着实现而改变。位集的长度与位集的逻辑长度相关，并且独立于实现来定义。

Java 库类的源代码是公开的，人们可以很容易地[自行检查](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/BitSet.java)。尤其：

```
The internal field corresponding to the serialField "bits".
89 
90     private long[] words; 
```

至于速度；这取决于一个人在做什么。一般来说，不要提前考虑速度；使用在语义上最有意义的任何工具，并导致最清晰的代码。仅在观察到未满足性能要求并确定瓶颈后进行优化。

由于许多原因，来到 SO 并询问 A 是否比 B 快是愚蠢的，包括但不限于：

1.  这取决于应用程序，通常没有响应的人可以访问该应用程序。在使用它的上下文中对其进行分析和分析。确保它是一个实际上值得优化的瓶颈。
2.  像这样询问速度的问题通常表明 OP 认为他们关心效率，但不愿意描述并且没有定义性能要求。在表面之下，这通常是一个危险信号，表明 OP 正朝着错误的方向前进。

我知道这是一个老问题，但最近才出现；我相信这是值得补充的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T15:16:04.320

这取决于一如既往。是的，BitSet 的内存效率更高，但是一旦您需要多线程访问 boolean[] 可能是更好的选择。例如，对于计算素数，您只需将布尔值设置为 true，因此您实际上并不需要同步。[Hans Boehm](http://www.hpl.hp.com/techreports/2004/HPL-2004-209.pdf)写了一些关于此的论文，同样的技术可用于标记图中的节点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T05:45:54.703

从 Java 到 CPU 完全是特定于 VM 的。例如，过去布尔值实际上是作为 32 位值实现的（今天很可能是这样）。

除非您知道这很重要，否则最好编写清晰的代码，对其进行分析，然后修复速度缓慢或消耗大量内存的部分。

您可以随时执行此操作。例如，我曾经决定不对字符串调用 .intern() ，因为当我在分析器中运行代码时，它会减慢它的速度（尽管使用的内存更少）。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-03T05:45:06.610

我相信 BitSet 的内存和 CPU 效率更高，它可以在内部将位打包成 int、longs 或本机数据类型，而 boolean[] 需要每个数据位一个字节。此外，如果您要使用其他方法（and、or 等），您会发现 BitSet 更有效，因为不需要遍历数组的每个元素；而是使用按位数学。

# c - fseek / 循环倒带

> ID：605247
> 
> 赞同：3
> 
> 时间：2009-03-03T05:47:57.070
> 
> 标签：c, performance, fseek

我有一个代码中的情况，其中有一个巨大的函数可以逐行解析记录，验证并写入另一个文件。

如果文件中有错误，它会调用另一个拒绝记录并写入拒绝原因的函数。

由于程序中的内存泄漏，它与 SIGSEGV 一起崩溃。从崩溃的地方“重新启动”文件的一种解决方案是将最后处理的记录写入一个简单文件。

为此，需要将处理循环中的当前记录号写入文件。如何确保数据在循环内的文件上被覆盖？

使用 fseek 在循环中首先定位/倒带会降低性能吗？

记录的数量可能很多，有时（高达 500K）。

谢谢。

编辑：内存泄漏已经修复。重新启动解决方案被建议作为一种额外的安全措施和手段，以提供重新启动机制以及 SKIP n 记录解决方案。很抱歉没有早点提及。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T06:03:25.550

遇到此类问题时，可以采用以下两种方法之一：

1.  *您建议的方法*：对于您阅读的每条记录，将记录号（或输入文件上返回的位置）**写出**`ftell`到单独的*书签*文件中。为确保您准确地从上次中断的地方继续，为了不引入重复记录，您必须`fflush`在每次写入之后（同时写入`bookmark`和输出/拒绝文件）。这以及一般的无缓冲写入操作会减慢典型的（无失败) 情景显着。为了完整起见，请注意您可以通过三种方式写入书签文件：
    *   `fopen(..., 'w') / fwrite / fclose`- 极慢
    *   `rewind / truncate / fwrite / fflush`- 稍微快一点
    *   `rewind / fwrite / fflush`-*稍微快一点*；您可以跳过`truncate`，因为记录号（或`ftell`位置）将始终与前一个记录号（或位置）一样长或更长`ftell`，并且将完全覆盖它，前提是您在启动时截断文件一次**（这回答了您的原始问题）**
2.  *假设在大多数情况下*一切都会顺利；失败后恢复时，只需**计算已经输出的记录数**（正常输出加上拒绝），然后从输入文件中跳过等量的记录数。
    *   这使典型（无故障）场景保持非常快，而在故障后恢复场景的情况下不会显着影响性能。
    *   您不需要`fflush`归档，或者至少不需要经常归档。`fflush`在切换到写入拒绝文件之前，您仍然需要主输出文件，并且`fflush`在切换回写入主输出文件之前拒绝文件（对于 500k 记录输入，可能需要数百或数千次。）只需删除输出/拒绝文件中最后一个未终止的行，直到该行的所有内容都将是一致的。

**我强烈推荐方法#2**。与方法 #2 所需的任何额外（缓冲）读取相比，方法 #1（三种可能性中的任何一种）所需要的写入非常昂贵（`fflush`可能需要几毫秒；将其乘以 500k，你会得到几分钟——同时计算500k 记录文件中的行只需要几秒钟，而且，文件系统缓存正在*使用，而不是对*你不利。）

* * *

**编辑** 只是想澄清实现方法2所需的确切步骤：

*   当分别写入输出和拒绝文件时，您只需在从写入一个文件切换到写入另一个文件时刷新。考虑以下场景来说明执行这些 flushes-on-file-switch 的必要性：

    *   假设您将 1000 条记录写入主输出文件，然后
    *   您必须在拒绝文件中写入 1 行，而无需先手动刷新主输出文件，然后
    *   您在主输出文件中再写入 200 行，而无需先手动刷新拒绝文件，然后
    *   运行时会*自动*为您刷新主输出文件，因为您在主输出文件的缓冲区中积累了大量数据，即 1200 条记录
        *   *但*运行时尚未自动将拒绝文件刷新到磁盘，因为文件缓冲区仅包含一条记录，不足以自动刷新
    *   您的程序此时崩溃
    *   您恢复并计算主输出文件中的 1200 条记录（运行时为您刷新了这些记录），但拒绝文件中的 0（！）条记录（未刷新）。
    *   您继续处理记录 #1201 处的输入文件，假设您只有 1200 条记录成功处理到主输出文件；被拒绝的记录将丢失，第 1200 条有效记录将被重复
    *   *你不想要这个！*
*   现在考虑在切换输出/拒绝文件后手动刷新：
    *   假设您将 1000 条记录写入主输出文件，然后
    *   您遇到一条属于拒绝文件的无效记录；最后一条记录有效；这意味着您正在切换到写入拒绝文件：在写入拒绝文件之前刷新主输出文件
    *   您现在将 1 行写入拒绝文件，然后
    *   您遇到一个属于主输出文件的有效记录；最后一条记录无效；这意味着您正在切换到写入主输出文件：在写入主输出文件之前刷新拒绝文件
    *   您在主输出文件中再写入 200 行，而无需先手动刷新拒绝文件，然后
    *   假设运行时没有为您自动刷新任何内容，因为自上次手动刷新主输出文件以来缓冲的 200 条记录不足以触发自动刷新
    *   您的程序此时崩溃
    *   您恢复并计算主输出文件中的 1000 条有效记录（您在切换到拒绝文件之前手动刷新了这些记录），以及拒绝文件中的 1 条记录（您在切换回主输出文件之前手动刷新）。
    *   您正确地恢复处理记录 #1001 处的输入文件，这是紧跟在无效记录之后的第一个有效记录。
    *   您重新处理接下来的 200 条有效记录，因为它们没有被刷新，但是您没有丢失记录，也没有重复
*   如果您对运行时自动刷新之间的间隔不满意，您也可以每 100 条或每 1000 条记录手动刷新一次。这取决于处理记录是否比刷新更昂贵（如果处理更昂贵，则经常刷新，可能在每条记录之后刷新，否则仅在输出/拒绝之间切换时刷新。）

*   从失败中恢复

    *   打开输出文件和拒绝文件*以进行读取和写入*，并从读取和计算每条记录（例如 in `records_resume_counter`）开始，直到到达文件末尾
    *   *除非您在输出**每条**记录*后刷新，否则您还需要对输出和拒绝文件中的最后一条记录执行一些特殊处理：
        *   在从中断的输出/拒绝文件中读取记录之前，请记住您在所述输出/拒绝文件中的位置（使用`ftell`），我们称之为`last_valid_record_ends_here`
        *   阅读记录。验证记录不是部分记录（即运行时尚未将文件刷新到记录的*中间*）。
        *   *如果每行有一条记录，则可以通过检查记录中的最后一个字符是否为回车符或换行符（`\n`或 `r`）来轻松验证*
            *   如果记录完整，则增加记录计数器并继续下一条记录（或文件结尾，以先到者为准。）
            *   如果记录是部分的，则`fseek`返回`last_valid_record_ends_here`并停止从此输出/拒绝文件中读取；不要增加计数器；继续下一个输出或拒绝文件，除非你已经完成了所有这些
    *   打开输入文件以读取并`records_resume_counter`从中跳过记录
        *   继续处理并输出到输出/拒绝文件；这将自动附加到您停止读取/计算已处理记录的输出/拒绝文件
        *   如果您必须对部分记录刷新执行特殊处理，您输出的下一条记录将覆盖其上一次运行 (at `last_valid_record_ends_here`) 的部分信息 - 您将没有重复、垃圾或丢失的记录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T05:52:38.527

如果您可以更改代码以使其将最后处理的记录写入文件，为什么不能更改它以修复内存泄漏？

在我看来，解决问题的根本原因而不是治疗症状是一个更好的解决方案。

`fseek()`并且`fwrite()`会降低性能，但远不及打开/写入/关闭类型的操作。

我假设您会将`ftell()`值存储在第二个文件中（这样您就可以从上次中断的地方继续）。您也应该始终`fflush()`使用该文件，以确保将数据从 C 运行时库写入操作系统缓冲区。否则，您的 SEGV 将确保该值不是最新的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T05:53:15.560

与其写出整个记录，在每个记录的开头调用 ftell() 并写入文件指针的位置可能会更容易。当您必须重新启动程序时， fseek() 到文件中最后写入的位置并继续。

当然，修复内存泄漏是最好的；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T05:56:14.307

如果您为每条记录写入最后处理的位置，这将对性能产生显着影响，因为您需要提交写入（通常通过关闭文件）然后再次重新打开文件。在其他作品中，fseek 是您最不担心的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T06:03:56.457

我会停止挖掘更深的洞，而只是通过[Valgrind](http://valgrind.org)运行程序。这样做应该可以避免泄漏以及其他问题。

# sql - 用于大容量的 rrd 工具替代品

> ID：605251
> 
> 赞同：7
> 
> 时间：2009-03-03T05:51:08.920
> 
> 标签：sql, time-series, rrdtool, opentsdb

我很想知道是否有任何替代 rrdtool 来记录时间序列数据。我正在寻找可以扩展以监视大量设备的东西。

从我读到的关于这个主题的内容来看，当您使用大量数据访问 rrdtool 时，它会受到 I/O 限制。由于我设想这可以扩展到要监视的大量设备，因此我很好奇是否有任何替代方案不会阻塞 I/O。首选基于 SQL，但不一定。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-08-25T13:39:50.890

有一些时间序列数据库以高可用性和/或可伸缩性为目标。

也许看看

*   [rrdcached](http://oss.oetiker.ch/rrdtool/doc/rrdcached.en.html) , rrd 之上的缓存层
*   [耳语，](http://graphite.wikidot.com/whisper)[石墨](http://graphite.wikidot.com/start)背后的数据库引擎
*   [opentsdb](http://opentsdb.net/)是一个分布式、可扩展的时序数据库（TSDB），写在 HBase 之上
*   [reconnoiter](https://labs.omniti.com/labs/reconnoiter)虽然它的重点更多的是监控

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-02-04T11:34:12.137

如果 I/O 性能是主要问题，那么您需要研究类似[rrdcached](http://oss.oetiker.ch/rrdtool/doc/rrdcached.en.html)的东西，它在 RRDTools 的当前版本 (1.4) 中可用。

I/O 开销不是正在写入的数据的函数，毕竟每个值每个数据源有 8 个字节。I/O 带宽来自于在写出之前需要读入整个扇区（通常为 4k）这一事实。突然要写 8 个字节，你已经读/写了 8k 个字节。

rrdcached 将所有这些写入合并在一起，因此当更新 RRD 时，有用数据（实际 DS 值）与浪费数据（扇区中的备用字节）的比率会降低。

当检测到 rrdcached 正在运行时（通过环境变量），所有 RRDTools 都会自动使用它。这允许他们在需要时触发刷新，例如在从数据生成图表时。

虽然切换到基于 SQL 的解决方案可能有助于考虑支持 SQL 所需的额外 I/O。考虑到您不倾向于在那种随机访问模式中使用 RRD 数据，数据库对于这个问题来说有点像大锤。坚持使用 RRDTool 将继续访问所有理解并可以使用文件的工具生态系统，这非常有用，尤其是在您已经熟悉它的情况下。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T06:02:39.767

我的一个朋友不久前在 SQL 后端做了一些工作来存储循环数据：[http ://rrs.decibel.org](http://rrs.decibel.org)

但是，我怀疑由于您询问“要监控的设备”，您可能正在寻找更完整的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-12T18:36:18.417

如果每秒 I/O 操作是您的主要瓶颈并且您使用的是 Linux，那么有一个简单的 hack 方法，它只会消耗您的内存。使用 tmpfs 挂载来暂存您的 RRD 写入。

所有的 i/o 操作都将在内存中完成，并且不会出现在执行磁盘 i/o 时发现的任何瓶颈（这甚至比使用固态磁盘还要快）。然后，您可以使用 cron 作业和 rsync 每隔几分钟将更改的 RRD 复制到磁盘一次。

* * *

**创建目录**

```
bash-4.2# mkdir /mnt/rrd-reads
bash-4.2# mkdir /mnt/rrd-writes 
```

**使用适当的选项创建最大 500MB 的 RAM 文件系统**

```
bash-4.2# mount -t tmpfs -o size=500m,mode=0750,uid=collectd,gid=collectd none /mnt/rrd-writes
bash-4.2# echo "none /mnt/rrd-writes tmpfs size=500m,mode=0750,uid=collectd,gid=collectd 1 2" >> /etc/fstab 
```

**将旧的 RRD 文件复制到新的挂载点**

```
bash-4.2# cp -a /var/lib/collectd/rrd/* /mnt/rrd-writes 
```

**配置您的 rrd-writing 应用程序以写入新的挂载点**

```
bash-4.2# sed -i -e 's/DataDir "\/var\/lib\/collectd\/rrd"/DataDir "\/mnt\/rrd-writes"/' /etc/collectd/collectd.conf 
```

**设置 cron 作业以每 2 分钟仅将更改的 RRD 同步到磁盘一次**

```
bash-4.2# echo "*/2 * * * * collectd rsync -a /mnt/rrd-writes/* /mnt/rrd-reads/ ; sync" > /etc/cron.d/rrd-sync 
```

* * *

在开始编写 rrd 应用程序*之前*，不要忘记将保存的 RRD 文件复制到挂载点！您可能需要编辑该服务的初始化脚本，以确保文件在它启动之前就在那里。如果它在没有文件的情况下启动，则会创建新的裸文件，并且一旦读取的目录被空 RRD 覆盖，您将非常困惑。

如果在某些时候您需要调整 tmpfs 挂载的大小，您可以即时执行此操作：

```
bash-4.2# mount -t tmpfs -o remount,size=850m /mnt/rrd-writes 
```

# php - PHP 的 Oracle PDO 是否会在 DELETE 上挂起？

> ID：605253
> 
> 赞同：0
> 
> 时间：2009-03-03T05:51:31.743
> 
> 标签：php, oracle, pdo

这挂在Php（5.2.6-Win32 + Oracle10g）中是一个错误，还是我做错了什么？

```
try {
    $conn = new PDO($DB,$USER,$PASSWORD);
    $conn->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION );
    //connected
    try {
        $conn->exec("DELETE FROM MY_TABLE");
        echo "done";
... 
```

**注意：**我不知道这是否是一个错误，我猜是。但是，由于我在快速搜索后找不到这方面的错误报告。我可能做错了什么，所以我想我先在这里问一下，以防万一其他人有类似的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T07:18:39.287

数据库中是否同时进行其他活动？如果是的话，我会怀疑死锁。一些未提交的 DML 事务可能会锁定`MY_TABLE`.

如果您不需要回滚功能，请考虑使用`TRUNCATE`而不是`DELETE`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T08:38:10.703

没有 WHERE 的 DELETE 将（很可能）对表进行完整扫描。这意味着它读取“高水位线”下的每个块 - 即表曾经使用过的每个块。因此，如果表曾经非常大，那么删除少量记录可能需要很长时间。[因为它不“知道”只有四条记录，直到它读取所有空间。]

截断不会这样做。它只是移动表的高水位标记，以便任何正在使用的块迅速变得未使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T06:31:21.677

它不太可能挂起，因为 PDO 似乎使用了很多，尽管我不知道 Oracle 使用了多少。

A`delete from my_table`可能需要一些时间，具体取决于有多少记录。您等了多长时间才决定它被挂起以及表中有多少条记录？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T18:33:45.390

如果有一个事务在同一个表上运行，它可能会阻止您的 DELETE。

# ruby - Ruby 'require' 语句是在类定义的内部还是外部？

> ID：605261
> 
> 赞同：49
> 
> 时间：2009-03-03T05:55:07.460
> 
> 标签：ruby, object

在 Ruby 中使用类文件时，您是将“requires”语句放在文件顶部还是在类定义中？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-03-03T06:23:40.807

从技术上讲，这并不重要。`require`只是一个普通的方法调用，它被调用的范围并不影响它的工作方式。放置的唯一区别是，当它放置的任何代码被评估时，它将被执行。

实际上，您应该将它们放在顶部，以便人们可以一目了然地看到文件的依赖关系。那是它的传统场所。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-03T06:02:06.427

在顶部。

```
require 'rubygems'
require 'fastercsv'

class MyClass
  # Do stuff with FasterCSV
end 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-03T10:05:13.893

我可以看到不将 a 放在文件顶部的一个可能原因`require`：加载成本高且并不总是执行的地方。我遇到的一种情况是，例如，代码及其测试在同一个文件中，这是我不时喜欢做的事情，尤其是对于小型库代码。然后我可以从我的编辑器运行该文件并运行测试。在这种情况下，当文件`require`从其他地方输入时，我不想`test/unit`被加载。

有点像这样：

```
def some_useful_library_function()
  return 1
end

if __FILE__ == $0
  require 'test/unit'
  class TestUsefulThing < Test::Unit::TestCase
    def test_it_returns_1
      assert_equal 1, some_useful_library_function()
    end
  end
end 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-03-03T10:40:06.667

将它们放在哪里并不重要，但是如果将它们放在*or*`class`表达式`module`中，那么看起来您正在将`require`d 文件中的任何内容导入到类的名称空间中，这是不正确的：所有内容都以全局结尾命名空间（或*库*中定义的任何命名空间）。

因此，最好将它们放在顶部以避免任何混淆。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-03T06:02:51.277

在文件的顶部，大多数（但不是所有）语言都以这种方式处理导入。我发现以这种方式处理它们更清洁、更容易。

我认为只有这样才有意义......就像你在文件中途那样：

```
class Foo
  def initialize(init_value)
    @instance_var = init_value

# some 500 lines of code later....

  end
end

class Bar
# oh look i need an import now!
require 'breakpoint' 
```

如您所见，跟踪它们将非常困难。更不用说如果您想**在代码的前面**使用导入的函数，您可能不得不回溯并再次包含它，因为另一个导入将特定于该类。导入相同的文件也会在运行时产生大量开销。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-14T00:18:24.493

我觉得**require**语句属于类内部。使用类意味着我们接受了 OOP 的基本原则，即对象应该尽可能松耦合。对我来说，这意味着最小化外部依赖。如果我稍后将一个类移动到它自己的文件中，我不想让它中断，因为我没有跟踪该类使用的所有必要的**require语句。**

**在文件中包含重复的require**语句不会导致任何问题，并且它简化了下一个继承您的代码的程序员不可避免地会发生的重构。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-02-19T15:19:46.390

大多数答案建议将*require*语句放在文件的顶部。但是，当需要嵌套类/模块时，您可能需要考虑将它们放在类中（在顶部）。看看这个例子：

```
# foo.rb
require './foo/bar'

class Foo < Struct.new(:name, :description)
  def bar
    Bar.new(self)
  end
end 
```

```
# foo/bar.rb
class Foo
  class Bar < Struct.new(:foo)
  end
end 
```

irb：

```
require './foo'
# ...
# TypeError (superclass mismatch for class Foo) 
```

发生这种情况是因为*Bar*嵌套在*Foo*中，并且需要通过将*Bar*类嵌套在*Foo*类中来定义它。然而，由于*Foo*尚未定义，它现在由嵌套结构定义。在成功需要*Bar*之后，我们现在尝试定义继承自另一个类的*Foo*类。由于*Foo*已经定义（通过嵌套结构）并且继承只能在类的初始定义上发生，因此这失败了。从而提高：

> TypeError（Foo 类的超类不匹配）

*只需在Foo*类中移动 require 语句即可解决此问题。

# vim - 在慢速连接上使用 vim 的提示？

> ID：605263
> 
> 赞同：23
> 
> 时间：2009-03-03T05:55:33.043
> 
> 标签：vim, ssh, vi

我正在通过慢速连接使用 vim，这有点痛苦。我可以在 vim 中做些什么来减轻疼痛吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-03T06:07:08.507

vi 的创建是为了使用超过 300 波特的调制解调器，这就是为什么有所有那些有趣和奇怪（和短）的命令来移动和导航。学习他们...

玩一些类似的东西

```
:10 -> 跳转到第 10 行
 7j -> 向下移动 7 行

```

因为我的键盘在 f 和 j 键上有一个小点，所以我使用 j 键上的点来轻松找到 vim 导航“hjkl”。

但最好的事情是永远不要滚动，搜索移动是一个救生员。当您搜索时，您的指针会直接指向您搜索的内容，这意味着不需要那些缓慢的导航。如果您最终通过 ssh 编辑非常大的文件，这将非常有用...

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-04T01:33:13.383

几件事情要调查。

*   :he懒重画
*   :he ttyfast
*   :he 不同步

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-03T06:07:44.107

您可以尝试设置[timeout](http://www.vim.org/htmldoc/options.html#%27timeout%27)和[ttimeout](http://www.vim.org/htmldoc/options.html#%27ttimeout%27)，这样 Vim 将等待直到收到完整的映射或键序列。

或者您可以增加[timeoutlen](http://www.vim.org/htmldoc/options.html#%27timeoutlen%27)值，这是等待键码或映射键序列完成的时间（以毫秒为单位）。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-03T06:20:06.697

我认为最好的办法是在本地编辑它并传输文件。这可以自动化，因此感觉就像远程编辑：

[http://vim.wikia.com/wiki/Editing_remote_files_via_scp_in_vim](http://vim.wikia.com/wiki/Editing_remote_files_via_scp_in_vim)

另请参阅此相关问题的答案：

[远程编程](https://stackoverflow.com/questions/601532/remotely-programming)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-07T03:26:18.500

在缓慢的连接中，逐个字符地移动光标是很痛苦的，因为你没有得到即时的视觉反馈，所以你总是移动得太多或太少。

所以对我来说最有效的是使用更智能的动作和命令，比如：

*   `fx`-- 跳到下一个字母`x`
*   `5w`-- 向前移动 5 个单词
*   `ci(`-- 替换括号之间的内容
*   `dap`-- 删除当前段落
*   等等。

我在浏览器的文本区域中输入时总是想念这些命令，就像现在一样:)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-11-03T00:46:13.617

找出导致性能问题的原因的诀窍是禁用vim 中的*所有内容*，然后慢慢地将部件重新引入，直到找出导致性能问题的原因。

即删除（或移动或重命名）以下文件/目录以快速禁用：

*   `C:\Program Files\Vim\_vimrc`
*   `C:\Program Files\Vim\vimfiles`
*   `C:\Program Files\Vim\vim72\autoload`
*   `C:\Program Files\Vim\vim72\plugin`

在 Unix/Linux/OS X 上，这些文件应该存在于：

*   `~/.vim/plugin`
*   `~/.vim/autoload`

如果您在其中任何一个地方都找不到它，那么该`:version`命令可以显示`.vimrc`正在使用的文件。插件目录应该在附近。

* * *

启动 vim - 如果没有任何设置，它可能看起来很奇怪。但它现在应该可以接受。

然后开始逐个引入位，直到找出导致问题的原因。

我这样做了，发现以下库存插件在通过 VPN 使用 Vim 时会导致问题：

*   匹配参数.vim
*   netrwPlugin.vim
*   vimball插件.vim

这些插件引入的大多数问题是添加新的自动命令（如在 BufEnter 期间），在编辑远程文件时性能不佳。您可能会发现您也有自己的插件，这可能会导致性能问题。

然后，我编写了一个函数来删除远程工作时的这些自动命令：

```
let g:NotEditingRemotely = 1

function! s:ToggleRemoteFile()
    if exists("g:NotEditingRemotely")
        " Disable the matchparen.vim plugin"
        :NoMatchParen

        " Turn off detection of the type of file"
        filetype off

        " Disable the netrwPlugin.vim"
        au! Network
        au! FileExplorer

        " Remove tag scanning (t) and included file scanning (i)"
        set complete=.,w,b,u,k

        " Remove these autocommands which were added by vimBallPlugin.vim"
        au! BufEnter *.vba
        au! BufEnter *.vba.gz
        au! BufEnter *.vba.bz2
        au! BufEnter *.vba.zip

        unlet g:NotEditingRemotely

        :echo 'Remote Edit mode turned on'
    else
        " Enable the matchparen.vim plugin"
        :DoMatchParen

        " Turn on detection of files"
        filetype on

        " Add back in tag scanning (t) and included file scanning (i)"
        set complete=.,w,b,u,t,i,k

        let g:NotEditingRemotely = 1

        :echo 'Remote Edit mode turned off'
    endif
endfunction

command! -nargs=0 ToggleRemoteFile call s:ToggleRemoteFile()
noremap <F6> :ToggleRemoteFile<CR> 
```

放入你的 vimrc 看看它是否有区别。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-11-03T15:17:13.677

我不确定这是否适用，但如果你的连接完全是喜怒无常的并且可能会退出，我会使用带有“屏幕”的 vim。screen 为您提供了一个虚拟终端，如果它退出，您可以重新连接到该终端，这样您的 vim 窗口是持久的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-03T18:15:18.647

我的建议是关闭 vim 中的语法高亮。特别是对于大文件，这使 vim 对我来说响应更快。( `:syntax off`)

编辑：这也可能有帮助，来自 vim 文档：

[http://www.vim.org/htmldoc/term.html#slow-fast-terminal](http://www.vim.org/htmldoc/term.html#slow-fast-terminal)（看起来发布的建议已经包含了这个文档中的一些内容）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-03T06:00:39.193

Vim 是为慢速连接而设计的。您是否正在利用运动命令和线选择操作？我的建议是好好学习 Vim 的非光标关键部分。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-27T23:14:39.687

你在 SSH 上吗？如果是这样，请使用 SSH 压缩。`ssh -C`应该有很大帮助。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-01-19T11:38:35.070

使用 mosh：[http ://www.linuxscrew.com/2012/04/11/why-mosh-is-better-than-ssh/?replytocom=804158#respond](http://www.linuxscrew.com/2012/04/11/why-mosh-is-better-than-ssh/?replytocom=804158#respond)

```
apt-get install mosh
yum install mosh
(or whatever appropriate command for your system) 
```

然后只需使用“mosh”而不是“ssh”。

它是为慢速连接而设计的，从对我的慢速 3G 连接的快速测试到服务器，它似乎都很好地支持它。

*注意*当连接到非标准端口时，一定要更新 /etc/ssh/ssh_config

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-04-04T09:59:46.900

不要设置选项`cursorline`或`colorcolumn`. 否则 vim 会明显滞后。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-03T06:08:02.343

通过使用快捷方式在文件中上下移动并沿线移动可以减轻痛苦，但正如我经常经历的那样，在慢速连接上做任何事情都是非常痛苦的。我发现如果有可能，我可以`scp`通过将文件传送到我的工作站、在那里平静地编辑它并重新加载它来节省大量时间和挫败感。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-10-24T06:47:47.120

对于重复的任务，您可以将一系列命令映射到单个按键。假设您要查找和替换一个单词（foo 和 bar），但不是它的所有实例

```
/foo
:map g cwbar^v^[n 
```

如果要替换，请键入 g 和 n 跳过

*   cw=换字
*   ^v = crtl+v 启用录制键击，如 ESC 和 ENTER
*   ^[ = ctrl+ESC
*   n = 搜索字符串的下一个实例

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-11-03T11:08:04.173

[Depesz](http://www.depesz.com/)的[vim 启动缓慢](http://www.depesz.com/index.php/2009/07/10/slow-vim-startup/)可能不是你的情况，但也许它对你也有帮助。

# mobile - 除 Java 外，移动应用开发的“最佳”平台？

> ID：605265
> 
> 赞同：2
> 
> 时间：2009-03-03T05:56:37.283
> 
> 标签：mobile

哪个平台最适合学习 Java 以外的移动开发。目前我使用了很多 java，它对大多数事情都非常有用，除非你试图做更多低级的事情。

此处提出了类似的问题[https://stackoverflow.com/questions/598252/most-promising-mobile-platforms](https://stackoverflow.com/questions/598252/most-promising-mobile-platforms)但大多数回复都推荐了目前尚未广泛使用的技术。在美国，每个人都在谈论 iPhone，但在南非可能只有不到 1000 人拥有这款手机，而 Android 手机尚未推出。

因此，我正在寻找针对最多手机的建议。据我所知，这将是共生体？

我不会看 windows mobile，因为它已经输掉了这场战斗，并且看起来将继续留在它的小市场领域。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T06:22:35.100

我发现 Symbian 是一个很好的平台，可以选择在其上开始移动应用程序开发。Symbian 社区最近一直在增长。工具越来越好，SDK/文档也越来越好。最重要的是，Symbian 瞄准并占领了一个日益强大的巨大市场。开发可能比使用不同的语言（如 java）或平台需要更多时间，但它肯定更灵活，您最终会更多地了解嵌入式开发和手机的不同方面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T06:00:50.533

[BREW SDK](http://brew.qualcomm.com/brew/en/developer/overview.html)是一种替代方案。它适用于许多设备，并且非常适合跨平台（手机）开发。你可以这样使用 C/C++。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T12:12:30.110

看起来你回答了你自己的问题。如果您想针对大多数手机并需要访问低级功能，那么在当前的移动市场上，选择 Symbian 和 Series60。

无耻插件：最近写的一本书，旨在向开发人员介绍 symbian 上的移动 c++ 开发[http://developer.symbian.com/quick](http://developer.symbian.com/quick)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-27T11:09:13.730

这些天你应该专注于 HTML5，因为这似乎是跨平台开发的方式。大多数主要移动平台都不同程度地支持它，但到目前为止似乎已经确定了未来。

# windows - 阅读和响应屏幕上的匹配标准

> ID：605266
> 
> 赞同：0
> 
> 时间：2009-03-03T05:58:12.833
> 
> 标签：windows, screen-scraping

我正在为我的 Win32 系统开发一些可以查找和响应特定屏幕事件的东西。例如，当我的屏幕（屏幕的 30x30 像素部分）的位图范围 (100,100) 到 (130,130) 与提供的 30x30 像素基线匹配时，请执行特定操作。

任何人都可以让我开始吗？也许有一个框架可以让这更容易？或者我可以使用的包？甚至可能是第 3 方实用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T06:25:57.853

您可以尝试获取桌面窗口[`GetDesktopWindow`](http://msdn.microsoft.com/en-us/library/ms633504(VS.85).aspx)（dc ( ) 然后将您感兴趣的区域从桌面 dc 位块传输到内存中的 dc( ) 中。在这一切之后不要忘记清理。[`GetWindowDC`](http://msdn.microsoft.com/en-us/library/dd144947(VS.85).aspx)[`CreateCompatibleDC`](http://msdn.microsoft.com/en-us/library/dd183489(VS.85).aspx)[`CreateCompatibleBitmap`](http://msdn.microsoft.com/en-us/library/dd183488(VS.85).aspx)[`SelectObject`](http://msdn.microsoft.com/en-us/library/dd162957(VS.85).aspx)[`BitBlt`](http://msdn.microsoft.com/en-us/library/dd183370(VS.85).aspx)

哦，如果您在托管代码中执行此操作，您可以在[PInvoke.net](http://pinvoke.net)上找到所有这些 API 。您还需要使用[`Imaging.CreateBitmapSourceFromHBitmap`](http://msdn.microsoft.com/en-us/library/system.windows.interop.imaging.createbitmapsourcefromhbitmap.aspx)将位图从本机位图复制到托管位图中。

我是凭记忆写下这一切的；它曾经在 XP 上工作，但我没有在 Vista 或 Win7 上尝试过。

**编辑：**在网上快速搜索“.Net 屏幕截图”会返回几个点击，包括[这个](http://www.developerfusion.com/code/4630/capture-a-screen-shot/)带有 C# 和 VB.Net 中的示例代码的点击。

# vb.net - 我已经使用 gacutil 安装了 mytext.dll 程序集 - 但我无法访问它或在 VB.Net 中引用它

> ID：605268
> 
> 赞同：1
> 
> 时间：2009-03-03T05:59:00.087
> 
> 标签：vb.net, gac

将我自己的 .dll 添加到 GAC 后如何引用它？我成功地将我的 .dll 添加到 GAC，在列表中看到了它。但是，当我尝试在 Visual Studios 中引用时......我迷路了。非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T06:03:18.593

添加引用对话框不是整个 GAC；-p

请参阅[此处](http://www.csharp411.com/adding-assemblies-to-the-visual-studio-add-reference-dialog/)了解演练（我相信 VB 和 C# 的步骤是相同的​​）。更简单的是“浏览...”到您想要的 dll；就个人而言，除非我*绝对*需要它，否则我会避免使用 GAC，例如作为“服务组件”托管在 COM+ 中的 COM 可调用包装器。除此之外，文件引用在 IMO 中效果更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T06:07:15.167

在这点上我只能支持 Marc。您无需参考 GAC；您可以在构建期间从另一个文件夹中引用它。

# ruby-on-rails - 路由资源问题

> ID：605282
> 
> 赞同：2
> 
> 时间：2009-03-03T06:03:51.353
> 
> 标签：ruby-on-rails

我正在使用`map.resources`and设置 Rails 站点`map.resource`，但遇到了限制（至少据我所知）。

这是我目前的路线。

```
map.with_options :conditions => { :subdomain => true } do |sub|
  sub.root :controller => 'company'

  sub.resource :company do |company|
    company.resources :clients, :path_prefix => nil, :name_prefix => nil, :collection => { :sort => :post } do |clients|
      clients.resources :projects, :path_prefix => ":client/:project"
    end
  end

  sub.resource :user, :collection => { :logout => :get }
end 
```

一般来说，这是我想要的结果：
**/client-name/action**
调用客户端控制器，并将客户端名称作为某种相同的哈希传递。

**/client-name/project-name/action**
调用 Projects 控制器，但将客户端名称作为保持不变的哈希传递。它想将其作为 id 传递。

我希望保持我的 URL 结构非常基本，所以：

1.  客户名称 = 雅虎
2.  项目名称 = 登录页面

/client-name/ - 这应该使用该`Clients.show`方法。
/client-name/edit - 这应该使用该`Clients.edit`方法。
/client-name/project-name - 这应该使用该`Projects.show`方法。
/client-name/project-name/edit - 这应该使用该`Projects.edit`方法。

尽管使用我当前的路由，它被解释为：
/client-name/projects - 这是使用该`Projects.index`方法。
/clients/client-name - 这是使用`Clients.show`方法。

我非常感谢所提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T23:35:42.360

资源映射不是那么强大。此外，它还在 URI 中添加了资源（公司、项目等）的名称。可能仍然有一种方法可以使用资源映射来实现您想要做的事情，但我认为使用常规映射更容易：

```
map.connect ':client',      :controller => 'clients', :action => 'show'
map.connect ':client/edit', :controller => 'clients', :action => 'edit'

map.connect ':client/:project',      :controller => 'projects', :action => 'show'
map.connect ':client/:project/edit', :controller => 'projects', :action => 'edit' 
```

# java - Web 应用程序中的上下文属性是否应该成为线程安全的？

> ID：605284
> 
> 赞同：0
> 
> 时间：2009-03-03T06:04:06.783
> 
> 标签：java, multithreading

我在 Web 应用程序中创建一个上下文（例如 TestContext.java）作为单例。多 struts 动作将访问上下文。我应该将上下文属性创建为线程安全的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T06:36:51.650

是的，您应该：多个主题可以同时访问它。

# browser - 有哪些方法可以用来避免页面被浏览器缓存？

> ID：605285
> 
> 赞同：0
> 
> 时间：2009-03-03T06:04:50.773
> 
> 标签：browser, caching

我有一个用户正在尝试查看在线考试的问题。在考试期间，他们选择 4 个答案中的 1 个，然后单击“答案”。对于这个用户来说，它似乎一遍又一遍地加载相同的页面/问题，因为它应该在回答每个问题后前进到一个新问题。我的猜测是它正在缓存，但它似乎不是浏览器缓存，因为他们已经尝试过 Internet Explorer 和 Firefox。他们正在使用卫星互联网，所以我的猜测是他们的网络/路由器上还有其他一些缓存。

这是从服务器发送的标头。

```
HTTP/1.1 200 OK 
Date: Tue, 03 Mar 2009 05:52:38 GMT 
Server: Apache/2.2.8 (Unix) 
X-Powered-By: PHP/5.2.6 
Set-Cookie: PHPSESSID=[...]; path=/ 
Expires: Thu, 19 Nov 1981 08:52:00 GMT 
Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0 
Pragma: no-cache 
Connection: close 
Content-Type: text/html; charset=UTF-8 
```

我已经让用户完全重置了他们的浏览器设置，但并没有什么不同。我在页面的 GET 查询/字符串中添加了时间戳，例如：

```
/path/question.php?exam_id=2323&user_exam_id=2334&timestamp=1236063834 
```

我可以使用哪些其他方法来强制用户的计算机在每次页面加载时刷新页面？

服务器正在运行 Apache、PHP、MySQL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T06:12:07.683

参见[w3.org 的 Cache-Control 规范，Cache-Control](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9)只能有一个值。我假设你想要无缓存。

编辑：要么这是一个旧规范，要么实际上是不同的。尝试

```
Cache-Control: no-cache, no-store
Pragma: no-cache
Expires: -1 
```

（从[这里](http://blog.httpwatch.com/2008/10/15/two-important-differences-between-firefox-and-ie-caching/)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T06:25:57.807

设置 Cookie：PHPSESSID=[...]; 路径=/

他们是否有可能运行某种 cookie 控件？

如果是这样，可以将 PHP 设置为通过 URL 传播会话 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T06:10:07.470

我用：

```
缓存控制：无缓存
Pragma：无缓存
过期：1970 年 1 月 1 日星期四 00:00:00 GMT
```

编辑：......从来没有遇到过问题。似乎在用户和您的应用程序之间存在一些非常强大的缓存层。

# html - Safari中的框架集问题

> ID：605288
> 
> 赞同：0
> 
> 时间：2009-03-03T06:06:05.997
> 
> 标签：html, safari

我面临一个 Frames 问题。当我试图从另一个框架集重定向一个页面时，它会给出“未定义”错误。

假设我有一个框架集，我将其分为 2 个水平框架，并且在较低的框架下，我再次分为 2 个垂直框架，现在我想从“左侧”框架重新加载框架页面的右侧，我意味着我会从左侧导航将页面重定向到 Frame 的右侧。

重定向时，我收到异常为“未定义”。

请帮帮我。这为我创造了很多问题。

提前致谢

问候比杰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T06:49:08.407

您必须提供链接或形成目标属性，该属性将包含您尝试重新加载的框架的名称。

# javascript - 标题消息就像在 Stack Overflow 上一样

> ID：605291
> 
> 赞同：45
> 
> 时间：2009-03-03T06:07:28.723
> 
> 标签：javascript, html, css, header

这是我第一次访问堆栈溢出，我看到了一个漂亮的标题消息，其中显示了一个文本和一个关闭按钮。

标题栏是固定的，非常适合吸引访问者的注意力。我想知道你们中是否有人知道获得相同标题栏的代码。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-03T09:59:49.260

快速纯 JavaScript 实现：

```
function MessageBar() {
    // CSS styling:
    var css = function(el,s) {
        for (var i in s) {
            el.style[i] = s[i];
        }
        return el;
    },
    // Create the element:
    bar = css(document.createElement('div'), {
        top: 0,
        left: 0,
        position: 'fixed',
        background: 'orange',
        width: '100%',
        padding: '10px',
        textAlign: 'center'
    });
    // Inject it:
    document.body.appendChild(bar);
    // Provide a way to set the message:
    this.setMessage = function(message) {
        // Clear contents:
        while(bar.firstChild) {
            bar.removeChild(bar.firstChild);
        }
        // Append new message:
        bar.appendChild(document.createTextNode(message));
    };
    // Provide a way to toggle visibility:
    this.toggleVisibility = function() {
        bar.style.display = bar.style.display === 'none' ? 'block' : 'none';
    };
} 
```

如何使用它：

```
var myMessageBar = new MessageBar();
myMessageBar.setMessage('hello');
// Toggling visibility is simple:
myMessageBar.toggleVisibility(); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2011-01-04T05:44:00.790

# 更新：

* * *

# [查看演示](http://jsbin.com/apiri4/3)

**使用的代码：**

```
$(function(){
  $('#smsg_link').click(function(){
  showMessage('#9BED87', 'black', 'This is sample success message');
  return false;
});

$('#imsg_link').click(function(){
  showMessage('#FFE16B', 'black', 'This is sample info message');
  return false;
});

$('#emsg_link').click(function(){
  showMessage('#ED869B', 'black', 'This is sample error message');
  return false;
});
});

/*
showMessage function by Sarfraz:
-------------------------
Shows fancy message on top of the window

params:
  - bgcolor:     The background color for the message box
  - color:     The text color of the message box
  - msg:       The message text
*/
var interval = null;

function showMessage(bgcolor, color, msg)
{
    $('#smsg').remove();
    clearInterval(interval);

    if (!$('#smsg').is(':visible'))
    {
        if (!$('#smsg').length)
        {
            $('<div id="smsg">'+msg+'</div>').appendTo($('body')).css({
                position:'fixed',
                top:0,
                left:0,
                width:'98%',
                height:'30px',
                lineHeight:'30px',
                background:bgcolor,
                color:color,
                zIndex:1000,
                padding:'10px',
                fontWeight:'bold',
                fontSize:'18px',
                textAlign:'center',
                opacity:0.8,
                margin:'auto',
                display:'none'
            }).slideDown('show');

            interval = setTimeout(function(){
                $('#smsg').animate({'width':'hide'}, function(){
                    $('#smsg').remove();
                });
            }, 3000);
        }
    }
} 
```

* * *

如果您想创建自己的，请查看[`slideToggle`](http://api.jquery.com/slideToggle/)jQuery 的功能。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-03T06:39:51.453

相关的 CSS 将包括：

```
position: fixed;
top: 0;
width: 100%; 
```

[更多信息`position:fixed`](http://www.w3schools.com/Css/pr_class_position.asp)：

> 具有 position: fixed 的元素定位在相对于浏览器窗口的指定坐标处。元素的位置由“left”、“top”、“right”和“bottom”属性指定。无论滚动如何，元素都会保持在该位置。在 IE7 中工作（严格模式）

如果 IE6 支持对您很重要，您可能希望[研究解决方法](http://www.google.com/search?hl=en&safe=off&rlz=1C1GGLS_enUS291US304&q=position+fixed+ie6&btnG=Search)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-03-07T20:38:38.617

这是使用 jQuery 的另一种方法，它也可以在显示/隐藏时向上/向下滑动。

`<body>`在页面中的标记之后添加以下 HTML ：

```
<div id="msgBox">
    <span id="msgText">My Message</span>           
    <a id="msgCloseButton" href='#'>close</a>
</div> 
```

将此 CSS 添加到您的样式表

```
#msgBox {
    padding:10px; 
    background-color:Orange; 
    text-align:center; 
    display:none; 
    font:bold 1.4em Verdana;
}
#msgCloseButton{
    float:right;    
} 
```

最后，这里是设置关闭按钮和功能以显示和隐藏消息栏的 javascript：

```
/* Document Ready */
$(function () {
    SetupNotifications();
});

SetupNotifications = function () {
    //setup close button in msgBox
    $("#msgCloseButton").click(function (e) {
        e.preventDefault();
        CloseMsg();
    });
}

DisplayMsg = function (sMsg) {
    //set the message text
    $("#msgText").text(sMsg);
    //show the message
    $('#msgBox').slideDown();
}

CloseMsg = function () {
    //hide the message
    $('#msgBox').slideUp();
    //clear msg text
    $("#msgtText").val("");
} 
```

要执行一个简单的测试，你可以试试这个：

```
<a href='#' onclick="javascript: DisplayMsg('Testing');">Show Message!</a> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-04T05:54:34.343

像这样的东西？

```
$("#bar").slideUp(); 
```

但是，在这里我认为他们首先淡出栏，然后将主容器抬起，所以会是这样的：

```
$("#bar").fadeOut(function(){
    $("#container").animate({"top":"0px"});
}); 
```

# sql-server - 使用带有 sql server 2005 的 sqlclient 数据提供程序而不是 oledb 数据提供程序的好处

> ID：605294
> 
> 赞同：0
> 
> 时间：2009-03-03T06:09:07.597
> 
> 标签：sql-server, sql-server-2005, ado.net, oledb, sqlclient

最近我想从 oledb 数据提供者转移到 sqlclient，因为我使用 sql server 2005 express edition 作为我的应用程序的后端，其中包含数百万条记录。

谁能给我同样的具体理由

请尽快回复

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T09:07:23.363

当您使用 sql server 2005 作为您的应用程序后端时，我希望使用 sqlclient 的性能会更好，因为不会有任何类型的转换层，因为它通过表格数据流 (TDS) 进行通信，而 oledb 由于它是一个通用的提供者。

它在下面的 MSDN 链接中提到了它...

> System.Data.SqlClient 包括一个表格数据流 (TDS) 解析器，用于直接与 SQL Server 通信。

[MSDN 链接](http://msdn.microsoft.com/en-us/library/kb9s9ks0.aspx)

另一个提到 TDS 的链接

[ADO.NET 和 SQL Server 性能提示](http://www.sql-server-performance.com/tips/ado_net_performance_p1.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T06:42:17.050

欺骗？[OleDB 与 SQLClient 的优缺点是什么？](https://stackoverflow.com/questions/473932/what-are-the-pros-and-cons-of-oledb-versus-sqlclient)

# c# - 绑定属性中抛出的数据绑定 numericupdown“隐藏”异常

> ID：605295
> 
> 赞同：1
> 
> 时间：2009-03-03T06:10:03.337
> 
> 标签：c#, data-binding, exception-handling

我遇到了一个问题，即从属性集访问器中抛出的异常没有被我的全局异常处理程序捕获。

我在一个更大的应用程序中遇到了这个问题，经过大量的牙齿故障排除后，我尝试并成功地在一个更简单的项目中复制了这个问题。

以下是代码和行为。有人可以解释一下这种行为以及我应该如何正确编码以实现所需的结果，即全局事件处理程序捕获的异常。

```
//Program.cs - Wire up global exception handling
static class Program
{
[STAThread]
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);

    Application.ThreadException += new ThreadExceptionEventHandler(Application_ThreadException);
    Application.SetUnhandledExceptionMode(UnhandledExceptionMode.CatchException);

    Application.Run(new Form1());
}

static void Application_ThreadException(object sender, ThreadExceptionEventArgs e)
{
    MessageBox.Show("Exception occured : " + e.Exception.Message);
} 
```

*

```
//In main form create instance of class containing bound property and setup databinding
//to numericUpDown control
private void Form1_Load(object sender, EventArgs e)
{
    _car = new Car();
    _car.NumberOfWheels = 4;
    numericUpDown1.DataBindings.Add(new Binding("Value", _car, "NumberOfWheels", true, DataSourceUpdateMode.OnPropertyChanged));
} 
```

*

```
public int NumberOfWheels
{
    get { return _numberOfWheels; }
    set
    {
        if (value < 4)
            //Throw some exception
            throw new ArgumentNullException("Argument null exception trigger in Number Of Wheels property");

         _numberOfWheels = value;
    } 
```

}

如果我在“throw new ArgumentNullException”行设置断点，那么当我更改 numericUpDown 控件（绑定到 NumberOfWheels 属性）的值时，程序肯定会在此时中断。然而，这是检测是否抛出异常的唯一方法。通过 UI 不会显示引发异常的消息，即它没有被全局异常处理程序捕获。

相反，如果我通过单击按钮更改属性的值，则会引发异常并被我的处理程序捕获，并显示一个消息框。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T01:08:48.667

谢谢穆法卡

这非常有帮助，让我进一步扩展了我在数据绑定方面的知识。然而，异常仍然没有被全局异常处理程序捕获。代码在 binding_BindingComplete 的最后一个 '}' 处中断，并显示“ArgumentNullException 未被用户代码处理”。

我可以按照你的描述让它工作的唯一方法是如果我设置

```
binding.FormattingEnabled = false; 
```

但这似乎有它自己的问题。

我想我现在要做的是采用你的方法，但我不会再次抛出异常，而是显示一个消息框并恢复原始值。

```
private void binding_BindingComplete(object sender, BindingCompleteEventArgs e)
{
   if (e.BindingCompleteState == BindingCompleteState.Exception)
   {
       MessageBox.Show(e.Exception.Message);
       e.Binding.ReadValue(); //resets value to actual value of data source instead of leaving it as changed value of control
   }
} 
```

我可能可以将此处理程序用于所有数据绑定控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T06:48:39.560

绑定将“吞下”或“隐藏”异常。这大概是为了更容错。

您需要侦听 BindingComplete 事件并检查 BindingCompleteEventArgs BindingCompleteState 属性上的 BindingCompleteState。如果该值为 BindingCompleteState.Exception，则 BindingCompleteEventArgs Exception 属性将包含引发的异常。

```
 public Form1()
    {
        InitializeComponent();

        Binding binding = new Binding("Value", _car, "NumWheels", true, DataSourceUpdateMode.OnPropertyChanged);
        numericUpDown1.DataBindings.Add(binding);
        binding.BindingComplete += new BindingCompleteEventHandler(binding_BindingComplete);

    }

    void binding_BindingComplete(object sender, BindingCompleteEventArgs e)
    {
        if (e.BindingCompleteState == BindingCompleteState.Exception)
        {
            throw e.Exception;
        }
    } 
```

# javascript - 这个表达式是什么意思：“javascript:{}”

> ID：605301
> 
> 赞同：0
> 
> 时间：2009-03-03T06:12:19.383
> 
> 标签：javascript, html

我有一个示例应用程序，如下所示。

```
<a href="javascript:{}" id="anchorlnk">Go</a> 
```

链接调用哪个 javascript 函数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T06:19:03.173

它什么也不做，`{}`链接上的创建一个新的未使用的空对象，*不是*函数调用......

也许您的事件在页面加载时被绑定，而有人只是为了什么都不做而把它放在一边。您可以简单地使用 href="#"

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T06:46:03.250

人们使用不同的技术什么都不做:)更多的例子是：

```
href="javascript:;"
href="javascript://"
href="javascript:void();" 
```

如果你使用

```
href="#" 
```

那么您可能会有一个 onclick 事件处理程序，请确保在“onclick 代码”末尾返回 false，否则页面将滚动到顶部，这可能会让用户非常不愉快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T06:17:01.167

很简单：什么都没有。

# sql - TSQL - 如何对 2 列使用 case 语句？

> ID：605304
> 
> 赞同：5
> 
> 时间：2009-03-03T06:13:08.273
> 
> 标签：sql, tsql

我想对 2 列的结果做一个案例。我该怎么做呢？

例如：

```
SELECT CASE amount=100 AND DATE IS NOT NULL WHEN 0 THEN 'Something' ELSE '' 
```

类似的东西？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-03T06:18:02.943

```
select case
    when amount = 100 and date is not null then 'something'
    else 'something else'
    end 
```

这是一个“搜索案例表达式”（[参见 MSDN](http://msdn.microsoft.com/en-us/library/ms181765.aspx)）：

```
 CASE
      WHEN Boolean_expression THEN result_expression [ ...n ] 
      [ ELSE else_result_expression ]  END 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T06:18:05.283

```
select someColumnName,
       case 
         when amount = 100  AND someothercondition then 'XXX'
         when amount = 1000  AND anothercondition then 'YYY'
         else 'WWW' 
       end as "MyColumnName"
from myTable 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T06:18:13.347

```
select 
case 
    when 
        amount = 100 
        and date is not null    
    then 
        '0'
    else 
        'something else'
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T06:20:01.003

寻找`SELECT WHEN`

[http://www.4guysfromrolla.com/webtech/102704-1.shtml](http://www.4guysfromrolla.com/webtech/102704-1.shtml)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2011-01-20T09:46:30.840

选择金额 = 100 且日期不为空的情况，然后“某事”，否则“金额=0 时的某事，然后“其他事”以 MyColumnName 结尾

# wpf - 在 WPF DataTemplate 中引用控件

> ID：605306
> 
> 赞同：2
> 
> 时间：2009-03-03T06:14:44.433
> 
> 标签：wpf, xaml, listbox, datatemplate, code-behind

在我为我的教堂设计的 WPF 页面中，我有两个 ListBox 控件绑定到两个 Linq-to-Entities 查询的结果：第一个列表框/查询包含所有今年尚未承诺的人，第二个列表框/查询包含所有已承诺的人（及其相关的承诺）。具体来说：

```
var familiesWithNoPledges = from family in entities.Family.Include("Pledge")
    where !family.Pledge.Where(p => p.PledgeYearID == pledgeYear).Any()
    select family;

var familiesWithPledges = from family in entities.Family
    join pledge in entities.Pledge.Include("PledgeFrequency").Where(p => p.PledgeYearID == pledgeYear) on family equals pledge.Family
    select new { family, pledge }; 
```

当应用程序的用户从第一个 ListBox 中选择一个家庭时，ListBox 项会略微扩展以显示承诺的字段，以便将承诺详细信息添加到第二个 ListBox。它看起来像这样：

[http://wouldbetheologian.com/images/PledgeManager.jpg](http://wouldbetheologian.com/images/PledgeManager.jpg) [（非现场图片）](http://wouldbetheologian.com/images/PledgeManager.jpg)

底层数据库（除其他外）有一个“家庭”表，与“承诺”表具有 1:many 关系。而当用户点击“Add Pledge”按钮时，我想创建新的Pledge实例，保存到数据库中，然后刷新两个控件。

但我不知道该怎么做。如果我尝试在代码隐藏中执行此操作，则“添加承诺”按钮的（n 个实例）的事件处理程序似乎无法引用相关控件；在 XAML 中，如果我尝试将 ListBoxItem DataTemplate 控件绑定到 Family.Pledge（或 Family.Pledge.FirstOrDefault()）字段，当我查看 Add 事件处理程序中的当前 Family 对象时，这些字段仍然为空承诺按钮。

关于如何解决这个问题的任何想法？或者有没有更好的 UI 模型我应该完全看一下？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T07:05:15.123

最简单的方法是让表示 ListBox ItemsSource 中的项目的类具有您在 DataTemplate 中引用的所有字段。然后在您的按钮处理程序中，您可以使用按钮的数据上下文访问新的承诺信息。

```
 private void AddPledge_Click(object sender, RoutedEventArgs e)
    {
        Button b = sender as Button;
        PotentialPledge p = b.DataContext as PotentialPledge;

        //do stuff with pledge
    } 
```

可能有一种方法可以做到这一点，而无需模板化字段成为构成 ListBox 的 ItemsSource 的类的一部分（我自己只是学习 WPF），但这有效。如果这没有帮助，我稍后再回头（现在开始工作）。

无论如何，为你的教会制作一个应用程序真是太棒了，它看起来很不错。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T09:48:42.267

谢谢，安德鲁，做到了。关键是我必须为有问题的 DockPanel 创建一个单独的 DataContext，然后将它绑定到在模板中创建的 Pledge 对象的新实例。

```
<ListBox>
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Grid>
                <Grid.Resources>
                    <local:Pledge x:Key="pledge" />
                </Grid.Resources>

                <DockPanel DataContext="{Binding Source={StaticResource pledge}}" >
                    <TextBox Name="txtAmount" Text="{Binding Path=Amount}" />
                    <TextBox Name="txtEnvelopeID" Text="{Binding Path=EnvelopeID}" />
                    <!-- Bind the Tag property of the Button to the DataContext of the ListBoxItem, i.e.  the current Family object -->
                    <Button Tag="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DataContext}" Name="addPledge" Click="addPledge_Click"  >
                        Add Pledge -->
                    </Button>
                </DockPanel>
            </Grid>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

我仍然需要了解更多详细信息才能正确设置 Pledge 对象，但我能够通过将 Button 的 Tag 属性绑定到其模板化父对象的 DataContext 来获取它们：

```
<Button 
    Tag="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=DataContext}" 
    Name="addPledge" 
    Click="addPledge_Click" 
/> 
```

从那里，我能够在代码隐藏中处理其余部分：

```
 private void addPledge_Click(object sender, RoutedEventArgs e)
    {
        try
        {
            // Set any additional necessary properties.
            Button button = (Button)sender;
            Pledge pledge = (Pledge)button.DataContext;
            pledge.PledgeYear = (PledgeYear)cboYear.SelectedItem;
            pledge.Family = (Family)button.Tag;

            // Update the database and refresh the Listboxes.
            entities.AddToPledge(pledge);
            entities.SaveChanges();
            LoadUnpledgedListBox();
            LoadPledgedListBox();
        }
        catch (System.Data.UpdateException ex)
        {
            MessageBox.Show("Error updating database: " + ex.Message);
        }
        catch (System.Exception ex)
        {
            Classes.Utils.HandleGenericError(ex);
        }
    } 
```

非常感谢——这为我指明了正确的方向。

# php - 将配置变量存储在站点根目录下 PHP 站点的 XML 文件中是否太冒险了？

> ID：605308
> 
> 赞同：2
> 
> 时间：2009-03-03T06:15:16.973
> 
> 标签：php, xml, apache, .htaccess

我注意到 Magento 将 MySQL 连接详细信息存储在一个 XML 文件中，该文件在 docroot 之上不受保护。这似乎……很危险。

XML 似乎是一种存储配置数据的便捷方式，除了一件事，输入[http://www.domain.com.au/library/config.xml](http://www.domain.com.au/library/config.xml)将向世界展示您的私人详细信息！

我继续使用 XMl 文件并将其添加到我的 .htaccess 文件中。

```
<Files ~ "\.xml$"> // regex files that end with xml extension
Order allow,deny 
Deny from all // don't show them
</Files> 
```

现在我*对此*很满意，现在我不太确定。如果 .htaccess 文件被意外删除/损坏（除了人为错误之外还会发生这种情况），如果有一天我想将应用程序放在非 apache 服务器上怎么办......是否每个服务器都具有阻止 XML 文件的等效项，以及如果他们这样做了，他们是否可以像 .htaccess 一样在文件夹级别进行更改（而不仅仅是 httpd.conf 文件）。

我的问题是...... XML 的便利性（易于更新，需要修补的设计师不会感到如此害怕）是否超过了潜在的问题（暴露私人数据）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T06:51:17.027

我个人只会以不能直接访问的格式或位置的格式存储配置文件信息。所以我要么使用 docroot 上方的 XML 格式，要么使用 PHP $config['varname'] = 'value' 格式。如果直接调用，后面的方法只会呈现一个空白页面（只要它都是 PHP 并且不包含 HTML 并且不回显）。

Gallery、vBulletin 和 Joomla 都使用我提到的第二种方法。我知道我之前在其他 PHP 相关问题中提到过这些项目，但它似乎是一种在项目之间被广泛使用和接受的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T06:18:10.197

简短的回答，不，不是。但更好的问题是。如果它没有存储在配置文件中，你会将它保存在哪里？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T10:17:44.067

我完全同意 inventix 的观点，但也提供了第三个选项，应该与

命名存储配置信息的文件

.htananything.whatever

在服务器范围内，所有以 .ht 开头的文件都无法被外部用户读取{这就是为什么 htaccess 总是 .htaccess}

个人我只将配置文件包含和函数库存储在文档根目录之外，但要理解，有些不能因此总是在它们上使用 .htnaming 约定，因为使用该软件的人必须在文档树中移动 $includesfolder这样的服务器

# iphone - 显示 UIActivityIndi cator x 秒

> ID：605311
> 
> 赞同：3
> 
> 时间：2009-03-03T06:16:11.963
> 
> 标签：iphone, cocoa-touch

我有一个 UITableViewController，它是 RootViewController。它的 XIB 只有一个表格视图。我已经通过 IB 添加了一个 UIActivityIndi​​cator 并创建了一个 IBOutlet。我以编程方式向 RootViewController 添加了一个带有删除按钮的工具栏。当用户单击工具栏的删除按钮时，我想在屏幕中央显示指示器。下面的方法从数据库中删除数据，这发生得非常快。我想让用户知道发生了什么事。如果我在没有 sleep() 的情况下运行下面的代码，它碰巧很快而且我看不到指标。但有些出于某种原因，无论如何我都没有看到指标。我猜 sleep() 会阻止重绘？如果我取出 sleep() 和最后两行，我会看到指示器，但它当然永远不会消失。它也显示在窗口的左上角。

如何使下面的代码正常工作，以使指示器至少显示 1/2 - 1 秒？

如何在窗口中间对齐指示器？

```
[self.navigationController.view addSubview:activityIndicator];
[activityIndicator startAnimating];
[activityIndicator setNeedsDisplay];

//do something which might happen really fast

sleep(1); //create illusion
[activityIndicator stopAnimating];
[activityIndicator removeFromSuperview]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T10:42:30.543

在您处理完事件并返回到运行循环之前，微调器不会开始旋转。解决这个问题的方法是让运行循环为你完成任务。

这是我的意思的一个例子：

```
- (IBAction)deleteAction:(id)sender {
    [self.navigationController.view addSubview:activityIndicator];
    [activityIndicator startAnimating];

    // Spinner won't start spinning until we finish processing this event, so
    // we're just going to schedule the rest of what we need to do.

    // doDelete: will run when the main thread gets its next event.
    [self performSelectorOnMainThread:@selector(doDelete:)
                           withObject:record
                        waitUntilDone:NO];

    // removeSpinner: will run in at least one second, but will wait if
    // another event (like the doDelete: one) is in the middle of running.
    [self performSelector:@selector(removeSpinner:)
               withObject:activityIndicator
               afterDelay:1.0];
}
- (void)doDelete:(id)record {
    [record delete];   // or whatever it is you need to do
}
- (void)removeSpinner:(UIActivityIndicator*)activityIndicator {
    [activityIndicator stopAnimating];
    [activityIndicator removeFromSuperview];
} 
```

注意：此代码中没有任何内容可以保证在“睡眠”期间阻止它处理其他触摸，因此请确保以某种方式锁定其他事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-20T21:21:31.107

正如亚当所提到的，除非工作（在本例中为删除操作）在后台线程中完成，否则微调器不会显示。这是我根据 Brent 的初始代码编写的代码。我对其进行了修改以调用在后台线程中完成工作的函数，然后在完成后使用主线程移除微调器。

```
- (void)removeSpinner:(id)record {
    [activityIndicator stopAnimating];
    [activityIndicator removeFromSuperview];

    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Thank You" message:@"Thanks for your feedback!"
                                                                                                 delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
    [alert show];
    [alert release];

    // return to feedings tab
  tabBarController.selectedIndex = 0;
}

- (void)doFeedback:(id)record {
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

    int j;
    for (int i = 0; i < 1000000000; i++) {
        j = j + i;
    }
    [self performSelectorOnMainThread:@selector(removeSpinner:) withObject:nil waitUntilDone:NO];

    [pool release];
}

- (IBAction)handleSend {        
    [self.view addSubview:activityIndicator];
    [activityIndicator startAnimating];

    // Spinner won't start spinning until we finish processing this event, so
    // we're just going to schedule the rest of what we need to do. 
    // doFeedback: will run when the main thread gets its next event.   
    [self performSelectorInBackground:@selector(doFeedback:) withObject:nil];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T06:42:47.517

问题是当你在做你的事情时，主运行循环没有运行。为了显示活动指示器，需要运行主运行循环，以便它可以更新其动画。为了获得预期的行为，您需要在单独的线程中异步执行数据库操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-07T10:13:15.260

[self.navigationController.view addSubview:activityIndi​​cator]; [activityIndi​​cator startAnimating];

[self performSelector:@selector(removeSpinner:) withObject:activityIndi​​cator afterDelay:5.0];

# crystal-reports - 如何为 VB.NET Crystal Report 插入 Crystal Report 页脚？

> ID：605313
> 
> 赞同：1
> 
> 时间：2009-03-03T06:16:22.993
> 
> 标签：crystal-reports

此报告页页脚已存在。但我错过了页脚部分删除。所以我想再次插入页脚.....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T06:48:48.483

右键单击设计器视图（不是预览）中报告的任何部分的空白部分。从上下文菜单中选择“报告”，然后选择“选择专家...”。从Section Expert您可以看到Report Footer（最后一个部分），您可以添加额外的子部分、抑制、隐藏、取消隐藏等。

# compression - 确定用于一系列字节的最佳压缩算法

> ID：605315
> 
> 赞同：3
> 
> 时间：2009-03-03T06:17:59.493
> 
> 标签：compression

对于我的个人项目，我正在编写一个小类来压缩和解压缩一种相当晦涩的格式。我有完整的规格，但这不是问题所在。

首先，这种“格式”使用一组 6 种不同的压缩类型以及未压缩的字节数据块。格式是 RLE、RLE 的一个分支，其中数字递增每个字节（例如 3、4、5、...）、16 位 RLE、LZ-Copy、反向 LZ-copy 和 LZ-Copy Xor' d 255。这不是最干净的规格，但我也没有设计它。

我的压缩例程应该接收一个 1 到 65535 字节的数组，并且（希望）尽可能地压缩它。我之前的尝试只是简单地计算出来，从未压缩流中的任何索引开始，上面的哪些压缩技术将提供最佳压缩，然后压缩该方法将压缩到压缩字节数组的字节数，然后从新的“未压缩”索引，例如：

```
{0,0,0,1,2,3,4} 
```

该算法将首先读取开头有三个零，然后输出规范使用的 RLE 编码，然后从第四个元素开始，将读取递增 RLE 将覆盖 '1,2,3, 4' 足够好并在返回之前压缩它。

总结的问题是，在尝试找出要使用的最佳规范时，即使在小（20-30）字节数组上，例程也*非常慢。*任何人都可以提供有关我如何优化它的提示，或者我是否可以提供更多信息来提供帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T06:52:03.703

听起来您要做的是为文件的每个可能段（我们称您的可变长度 1-64K 块段）计算大量压缩可能性。如果我错了，请纠正我，但是您是否从以下选择中计算出第一段的最佳压缩（方法 0 未压缩）：

*   压缩方式0，长度1字节。
*   压缩方式1，长度1字节。
*   : : : : :
*   压缩方式6，长度1字节。
*   压缩方式0，长度2字节。
*   压缩方式1，长度2字节。
*   : : : : :
*   压缩方式6，长度65534字节。
*   压缩方式0，长度65535字节。
*   压缩方式1，长度65535字节。
*   压缩方式2，长度65535字节。
*   压缩方式3，长度65535字节。
*   压缩方式4，长度65535字节。
*   压缩方式5，长度65535字节。
*   压缩方式6，长度65535字节。

这将花费大量时间（每段大约 420,000 次压缩尝试）。如果您正在这样做，您最好选择单个段大小（例如，64K）并对其应用七种压缩方法中的每一种以选择最佳的。然后，对于每个段，输出“方法”字节，后跟压缩数据。

# xml - Android 项目中 XML 文件的架构在哪里？

> ID：605325
> 
> 赞同：37
> 
> 时间：2009-03-03T06:21:07.567
> 
> 标签：xml, android, schema, dtd

Android 上使用的 XML 文件（如 AndroidManifest.xml 或布局）的架构（DTD 或 XML 架构）在哪里？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-06T05:08:37.717

架构不作为 xml 文件存在。模式取决于您的程序使用的 UI 类。[这里](http://groups.google.com/group/android-developers/browse_frm/thread/d85b6c2d0e301126/8dbbcb11543672e5?lnk=gst&q=schema+exist#8dbbcb11543672e5)有一个稍微好一点的讨论。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-02-14T13:57:18.413

通常，在 XML 中定义命名空间不必是一个真实的现有 URL，而只是一个全球唯一的字符串（因此人们更喜欢使用他们自己的 URL）。当然，如果这个 URL 包含 XML 模式（或更糟的是 DTD），那就太好了。如果有人会创建 Android Ressource Schemata，那也很好。我可以帮助他作为 CS 的学士论文。- 柏林 Solymosi 教授

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T12:45:17.233

XML 模式似乎没有记录，但这里有一个有用的所有布局对象及其允许属性的列表：

[http://developer.android.com/reference/android/R.styleable.html#lfields](http://developer.android.com/reference/android/R.styleable.html#lfields)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-04-26T11:54:20.880

一直在搜索同一主题以了解 android studio 如何在 XML 中完成自动完成和内容，我也希望找到一些 XSD 或其他东西，但是：

> 在 Android 中，我们混合使用静态和动态 DOM 定义：
> 
> 1-某些文件是使用类和注释定义的，例如 Manifest （注意：要获得正确的信息，您很可能应该使用合并的清单，但这超出了本文档的范围）。
> 
> 2-从资源中读取其他信息，使用命名约定来查找包含与给定 XML 标记相关的属性的样式。例如，如果我们识别出一个标签对应于布局文件中的 View 子类（例如“TextView”），我们会找到对应的样式，查看它包含的属性并为给定标签注册与这些属性资源对应的 DOM 扩展. 有关读取样式的代码，请参阅 AttributeProcessingUtil 和 SubtagsProcessingUtil，有关插入 DOM 系统的扩展，请参阅 AndroidDomExtender。
> 
> 3-有时样式是静态确定的，但属性是动态读取的，以与项目中使用的平台版本保持同步。这是使用 @Styleable 注释完成的。

[https://android.googlesource.com/platform/tools/adt/idea/+/refs/heads/mirror-goog-studio-master-dev/android/src/org/jetbrains/android/dom/README.md](https://android.googlesource.com/platform/tools/adt/idea/+/refs/heads/mirror-goog-studio-master-dev/android/src/org/jetbrains/android/dom/README.md)

例如，这是在 android studio 的源代码中定义形状可绘制 XML 的方式：

```
@DefinesXml
@Styleable("GradientDrawable")
public interface Shape extends DrawableDomElement {
  @Styleable("DrawableCorners")
  List<DrawableDomElement> getCornerses();

  @Styleable("GradientDrawableGradient")
  List<DrawableDomElement> getGradients();

  @Styleable("GradientDrawablePadding")
  List<DrawableDomElement> getPaddings();

  @Styleable("GradientDrawableSize")
  List<DrawableDomElement> getSizes();

  @Styleable("GradientDrawableSolid")
  List<DrawableDomElement> getSolids();

  @Styleable("GradientDrawableStroke")
  List<DrawableDomElement> getStrokes();
} 
```

styleables（如 GradientDrawablePadding）在 android 的 attrs.xml 中定义

[https://android.googlesource.com/platform/tools/adt/idea/+/refs/heads/mirror-goog-studio-master-dev/android/src/org/jetbrains/android/dom/drawable/Shape。爪哇](https://android.googlesource.com/platform/tools/adt/idea/+/refs/heads/mirror-goog-studio-master-dev/android/src/org/jetbrains/android/dom/drawable/Shape.java)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-11T16:21:36.027

如果您遇到了模式`http://schemas.android.com/apk/res/android`被识别等问题，您可以在**Settings** (或**Preferences** ) > **Languages & Frameworks** > **Schemas and DTDs**下添加它。单击“忽略的架构和 DTD”下的 + 号并添加架构 URL。您不应再收到代码错误/警告。

# php - 如何使用 PHP 提供 gzipped xml 文件以供下载

> ID：605335
> 
> 赞同：3
> 
> 时间：2009-03-03T06:26:59.550
> 
> 标签：php, xml, gzip

我有一个 PHP 脚本，可以从 db 创建一个 xml 文件。我想让脚本创建 xml 数据并立即使 .gzip 文件可供下载。你能给我一些想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-03T06:31:20.400

[您可以使用gzencode](http://www.php.net/manual/en/function.gzencode.php)功能轻松应用 gzip 压缩。

```
<?
header("Content-Disposition: attachment; filename=yourFile.xml.gz");
header("Content-type: application/x-gzip");

echo gzencode($xmlToCompress); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T06:44:03.660

像这样的东西？

```
<?php
 header('Content-type: application/x-gzip');
 header('Content-Disposition: attachment; filename="downloaded.gz"');
 $data = implode("", file('somefile.xml'));
 print( gzencode($data, 9) ); //9 is the level of compression
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T06:33:30.800

如果您没有可用的[gzip 模块](http://www.php.net/manual/en/book.zlib.php)，

```
<?php

  system('gzip filename.xml');

?> 
```

# architecture - Killer Apps 架构说明

> ID：605336
> 
> 赞同：8
> 
> 时间：2009-03-03T06:27:34.870
> 
> 标签：architecture

几周前，我的一个朋友向我展示了一个网站，其中解释和描述了最受欢迎网站的架构（youtube、amazon、facebook），它还显示了一些关于它们的有趣统计数据。

有谁知道我在哪里可以找到这些信息？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-03T06:35:22.107

是[高可扩展性](http://highscalability.com/)吗？具体来说，[现实生活架构](http://highscalability.com/links/weblink/24)部分？

-约翰

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T06:36:27.530

我相信这将是**[http://highscalability.com/](http://highscalability.com/)**

# jboss - Oracle BC4J 是否仍受支持？

> ID：605345
> 
> 赞同：-1
> 
> 时间：2009-03-03T06:33:06.027
> 
> 标签：jboss, oracle-adf

我们需要从 OAS 9.0.4 迁移到 JBoss，并且我们希望随身携带 BC4J 应用程序。我正在寻找有关 BC4J 在我们的新平台上的可支持性以及需要哪些许可证的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T12:20:04.910

我不确定许可证要求，但本教程

将解释如何将您的 bc4j 应用程序重新部署到 JBoss

[http://www.oracle.com/technology/products/jdev/howtos/appservers/deploy_bc4j_to_jboss.html](http://www.oracle.com/technology/products/jdev/howtos/appservers/deploy_bc4j_to_jboss.html)

# .net - DevShock SMPP 组件的任何消息？

> ID：605346
> 
> 赞同：0
> 
> 时间：2009-03-03T06:33:17.447
> 
> 标签：.net, sms, components

我正在维护一个将 DevShock SMPP 组件用于 .NET 的程序。我注意到很长一段时间（至少 6 个月）该[网站](http://www.devshock.com/)有一个“正在建设中的新网站”通知，说它将在 2008 年 9 月之前准备好。
有人知道它是否会回来吗？
有谁知道.NET 的另一个免费的可比较库/组件？

2009 年 12 月更新 - 网站现在显示新网页将于 2009 年 12 月推出

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T06:44:34.923

IP*Works 有一个：[http ://www.nsoftware.com/products/component/smpp.aspx](http://www.nsoftware.com/products/component/smpp.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-06T10:11:29.617

来自[aboutus.org](http://www.aboutus.org/DevShock.com "aboutus.org")，以下是开发者的联系信息 :)

aa@pla.net.py

Gral Garay 613 E/ Lillo y Bertoni
亚松森，巴拉圭

+595 971230094，传真：+1 571 434 4620

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-04T09:54:48.383

如果有人需要，我仍然可以下载该文件：

[http://sites.google.com/site/freesmsuk/smpp/devshock.smpp.zip](http://sites.google.com/site/freesmsuk/smpp/devshock.smpp.zip)

问候

担。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-12T00:47:10.580

不确定您是否仍在寻找替代库。我刚刚在 Sourceforge 遇到了另一个项目（EasySMPP - [http://sourceforge.net/projects/easysmpp/](http://sourceforge.net/projects/easysmpp/)）。尚不确定代码（即将深入研究），但您可能会有所收获。

# asp.net - 服务器上的 Crystal Reports 日历错误

> ID：605358
> 
> 赞同：-1
> 
> 时间：2009-03-03T06:41:50.483
> 
> 标签：asp.net, crystal-reports, localhost

我的*Crystal Reports*在本地主机上运行良好，但在服务器上却不行。*当我在Crystal Reports*中按下日历时，它会显示`Run time Error`。

我正在使用*ASP.NET 2.0*、*vb.net*、*SQL 2005*。

如何在服务器上配置*Crystal Reports*？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T11:52:21.423

正如 dincer80 所说，您应该正确部署 Crystal 报表。[这可能有助于部署](http://aspalliance.com/672)。

还有另一个关于主题的[MSDN 参考。](http://msdn.microsoft.com/en-us/library/aa287928(VS.71).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-03T15:38:52.407

您使用的是什么版本的 Crystal Reports？您可以从 SAP Crystal 站点下载运行时分发模块——那里有大部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-08T21:12:36.203

您缺少的关键细节是您使用的 Crystal Reports 版本（与 Visual Studio 捆绑，而不是安装在 Visual Studio 之上的 Crystal Reports 的完整副本）以及您遇到的运行时错误。

我怀疑您收到有关水晶程序集无法加载的错误。尽管所有这些答案都在正确的轨道上（部署运行时），但我认为您最好阅读此页面： http: [//resources.businessobjects.com/support/additional_downloads/runtime.asp](http://resources.businessobjects.com/support/additional_downloads/runtime.asp)

正确识别正在使用的运行时是绝对关键的。请记住，Visual Studio 2002/2005/2008/2010 都可以使用捆绑版本或特定的 Crystal Reports 版本。要知道您使用的是哪一个，您应该检查您的 .NET 项目引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T09:22:52.950

而不是 xcopy 应用程序，您需要创建一个安装程序项目并将水晶报告作为您的应用程序的先决条件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T07:22:07.063

您是否确定它是否正确安装在服务器上？

# html - HTML中的非折叠但仍然（行）可破坏的空间？

> ID：605360
> 
> 赞同：19
> 
> 时间：2009-03-03T06:42:35.957
> 
> 标签：html, whitespace

如果我想在看起来像三个空格的行中间有空格，但如果行太长仍然可以打破，我可以在 HTML 中使用什么？

常规空格被折叠（一系列空格看起来与单个空格相同），并且在不间断空格 ( ) 处，行不能被打破。

**更新**：我认为我真正想要的是一个仍然可以打破长行的＜pre＞标签（我需要显示源代码）。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-08-18T19:29:23.060

我实际上有你正在寻找的确切答案。我到处搜索这个答案，没有任何人建议完美。所以，我想出了一个解决方案并尝试了它，并且发现它没有任何缺陷！

[加罗](https://stackoverflow.com/a/605470/578288)实际上是对的（他只是没有解释或完全接受）。解决方案不是`&nbsp;`单独放置，而是放置`&nbsp;<wbr>`. 只需进行简单的搜索和替换，然后`<wbr>`在每个`&nbsp;`. 完美运行！

该`<wbr>`标签是所有主要浏览器都支持的鲜为人知的标签，它告诉浏览器仅在需要时才在此处放置换行符。

更新：我发现一个浏览器在 IE 8 中不能完全正常工作！他们居然把`<wbr>`标签拿出来了！我通过创建一个类来解决这个问题：

```
.wbr:before { content: "\200B" } 
```

而不是替换`&nbsp;`为`&nbsp;<wbr>`，而是将其替换为以下内容：

```
&nbsp;<wbr><span class='wbr'></span> 
```

在 PHP 中，这看起来像：

```
$text = str_replace(" ","&nbsp;<wbr><span class='wbr'></span>", $text); 
```

不要忘记添加类。

显然，这有点过分了，用所有这些替换了一个空格，但它确实可以按预期工作，因为我从未见过它对我有用的标记。

如果这太乱了，另一种解决方案是将双空格换成a，`&nbsp;`然后是一个普通空格。这将交替`&nbsp;`和正常空间并在我的测试中工作。

在 PHP 中，这看起来像：

```
$text = str_replace("  ","&nbsp; ", $text); 
```

希望这可以帮助！我对此进行了足够的研究；我想我应该把它传下去。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-03T06:55:01.077

一个或多个 em 空格 ( ) 怎么样？当然，这取决于用户的字体大小。如果这在您的设计中不起作用，请考虑使用 en 空格 ( )。

您可能还想查看维基百科上[的各种空间表。](http://en.wikipedia.org/wiki/Space_(punctuation)#Table_of_spaces)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-03T06:48:13.010

如果您的[目标不是 IE](http://www.quirksmode.org/css/whitespace.html)（8 标准模式除外）：

```
<span style="white-space: pre-wrap">   </span> 
```

对于 IE，`<span style="width:3ex"></span>`在 quirks 模式下工作，所以合并它们并...

```
<span style="width:3ex;white-space:pre-wrap">   </span> 
```

这似乎在我尝试过的任何地方都有效......除了 IE7 标准。哦！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-03T07:02:10.777

两个不间断空格之间的空格不会起作用吗？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-03T07:50:55.793

[<wbr>](http://www.quirksmode.org/oddsandends/wbr.html)怎么样？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T06:46:12.127

两个`&nbsp;`后跟一个常规空格怎么样？唯一的缺点（据我所知）是，如果换行符自然落在常规空格处，由于不间断空格，您将在前一行有一些尾随空格，但我没有'认为这不会对页面的实际外观产生影响。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-03T07:59:49.360

最好退后一步，问问你要渲染的是什么。这个超宽的空间意味着什么？

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-20T04:27:05.880

它在您的文本空间示例之间的左侧空间提供 100px

span style="margin-left:100px;"

(n_n)

# user-interface - 从 Web GUI 远程执行交互式 shell 脚本

> ID：605373
> 
> 赞同：2
> 
> 时间：2009-03-03T06:49:04.443
> 
> 标签：user-interface, shell, scripting, interactive

我的项目需要通过 Web GUI 远程执行交互式 shell 脚本。这意味着打印到脚本标准输出的内容必须在 GUI 上可用，并且用户输入必须从 GUI 获取并写入脚本的标准输入。

我的问题是（a）这是一个好主意（暂时搁置它是一个要求的事实）？(b) 以前有人解决过这类问题吗？如果是，那么“最好”的方法是什么？

编辑#1：要执行的脚本与 Web 服务器不在同一主机上。

编辑＃2：

感谢您的回复！我担心浏览器端解决方案不符合我的目的，因为用户可以启动一个或多个脚本，可以关闭浏览器，过一段时间再回来检查脚本的输出并提供输入。

我提出的设计涉及将脚本的输出存储到不同的文件中，当用户启动浏览器时，它开始从文件中读取并不断轮询（通过 Ajax），直到脚本完成执行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T07:01:33.710

似乎您需要某种后台进程才能使其正常工作。您不能从单个脚本执行此操作，因为当这样的脚本正在运行时 - 浏览器认为它正在加载页面。如果这需要比预期更长的时间，它会中止并声明。“服务器响应时间过长”

因此，实际上您需要生成/分叉一个单独的进程，并从客户端向服务器发出定期请求，这将导致服务器端脚本连接到该进程并与之交换消息。

例如，参见[phpterm](http://phpterm.sourceforge.net/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T16:43:32.760

也许您有理由不考虑它，但是基于 Web 的 shell 进入服务器呢？例如 AjaxTerm ( [http://antony.lesuisse.org/software/ajaxterm/](http://antony.lesuisse.org/software/ajaxterm/) )

我记得，您可以配置它可以登录的用户帐户，然后您可以应用通常的控件来限制用户可以运行哪些脚本（或 chroot？）。

毕竟，如果你想运行一个 shell 脚本，为什么不使用 shell 呢？:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T06:55:35.380

听起来像 CGI

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T07:01:08.377

这可能不是一个好主意。交互式 shell 脚本通常不通过网页执行...

但当然有可能。

相反，想想你想要完成什么，并制作一个由标准 Web 组件组成的漂亮 UI。也许您可以构建一些像“向导”一样工作的东西？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-20T11:50:13.973

您可以使用[Expect](http://www.nist.gov/el/msid/expect.cfm)模拟用户启动进程作为 nohup 或后台作业，注销，然后定期重新登录以检查其日志文件或提供输入。

# yui - 我可以在 YUI 菜单中创建一个不是菜单项的项目吗

> ID：605374
> 
> 赞同：0
> 
> 时间：2009-03-03T06:49:05.317
> 
> 标签：yui, yui-menu

我有一个基于[此示例的](http://developer.yahoo.com/yui/examples/menu/topnavfrommarkup_source.html)[YUI 菜单](http://developer.yahoo.com/yui/menu/)顶部栏导航菜单。

我希望能够在其中插入用作标题而不是菜单项的项目。例如，我可能有一个不同类别的产品列表，并且我想要每个类别的标题。我不想要子菜单 - 我想要菜单内的标题。

我希望它就像这样做一样简单：

```
 <li class="menuHeading">Heading</li> 
```

（并且显然定义了`menuHeading`风格）。

这实际上有效 - 因为该项目出现在菜单中的正确位置。但它表现为一个菜单项（当我翻转它时以蓝色突出显示）。我在 Chrome 中检查了 DOM，似乎 YUI 菜单 javascript 实际上正在添加以下类`'yuimenuitem'`并为其提供生成的 ID。

有没有一种“官方”的方式来做我想做的事，还是我必须求助于一些技巧，我想只是`menuHeading`在我将鼠标悬停在它上面时将类更改为具有白色背景，但我宁愿不这样做，如果我不必。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-05T16:23:45.077

YUI 菜单支持内置标题——它们被称为组标题。有两个 YUI 菜单示例说明了如何为组命名：

[http://developer.yahoo.com/yui/examples/menu/example05.html](http://developer.yahoo.com/yui/examples/menu/example05.html) [http://developer.yahoo.com/yui/examples/menu/example06.html](http://developer.yahoo.com/yui/examples/menu/example06.html)

# jquery - jQuery 突出显示与 DataTable 绑定的 DataList 中的关键字

> ID：605377
> 
> 赞同：0
> 
> 时间：2009-03-03T06:49:29.310
> 
> 标签：jquery

当我在返回的结果中搜索高亮搜索关键字时，我发现了这个[http://forums.asp.net/p/1390512/2970477.aspx#2970477 。](http://forums.asp.net/p/1390512/2970477.aspx#2970477)但是没有关于如何实现这一点的解决方案或演示。我有类似的问题。任何人都可以帮助调查上述帖子的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T07:23:26.437

[让我为你谷歌 :)](http://tinyurl.com/dzwtjj)

编辑 ：

1.  将以下定义添加到您的 css 中`highlight`：`.highlight { background-color: yellow }`. 您可以根据需要对其进行更新。
2.  在您的页面中包含 jquery.highlight-3.js 脚本。
3.  为了使思考变得容易，请将您的数据列表放在`<div id="searchResults">...</div>`标签中。
4.  生成将在页面加载时触发的客户端脚本。对于要突出显示的每个单词，您应该执行以下 javascript：`$('#searchResults').highlight('yourWordHere'));`

编辑 2：

这是一个示例**服务器端**代码。

```
string keywords = keywordsTextBox.Text;
StringBuilder highlightScript = new StringBuilder();

foreach (keyword in keywords.Split(' '))
    highlightScript.AppendFormat("$('#searchResults').highlight('{0}'));", keyword);

ClientScript.RegisterStartupScript(GetType(), "highlightScript", highlightScript.ToString(), true); 
```

我们不再是 jquery 领域，我认为您需要阅读更多关于 asp.net 应用程序开发的内容。

# ruby-on-rails - ruby/rails 的自然语言日期解析器

> ID：605388
> 
> 赞同：6
> 
> 时间：2009-03-03T06:55:50.153
> 
> 标签：ruby-on-rails, ruby, datetime, nlp

有人知道Ruby中类似于[Date.js的东西吗？](http://www.datejs.com/)能够从以下内容返回日期对象的东西：“从今天起两周”。记住牛奶网络应用程序将此功能整合到他们的系统中，并且非常易于使用。

我会使用 Date.js 库本身，但因为它位于客户端，所以它有其局限性。如果用户没有启用 javascript，则该功能将丢失。这将影响手机用户，理想情况下，他们会通过短信 (sms) 使用我们的系统。

我很想使用已经存在的解决方案，但如果不是，将这段代码移植到 Ruby 中会有多难？我真的不太了解自然语言解释，但似乎需要一些时间。

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-03T06:59:04.293

不要忘记在 Ruby 中一切都是对象，您已经从语言本身获得了一些非常易读的语句：

```
2.weeks.from_now.utc 
```

相当于“从今天起两周”。

然而，对于*真正的*自然语言，可能是**[慢性](http://www.yup.com/articles/2006/09/10/a-natural-language-date-time-parser-for-ruby-chronic)**[的，可能是ruby​​forge](http://chronic.rubyforge.org/)的一个更专业的库。

```
Chronic.parse('this tuesday 5:00')
#=> Tue Aug 29 17:00:00 PDT 2006 
```

# .net - 如何列出 Win32.DLL 中的可用方法

> ID：605389
> 
> 赞同：6
> 
> 时间：2009-03-03T06:58:36.620
> 
> 标签：.net, winapi, dll, interop

我有一个 DLL 文件，其中包含一些我想在我的应用程序中调用的有用函数。我不再有它的文档了。

如何发现 DLL 导出的函数及其方法签名？

有没有列出函数及其参数的实用程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T07:08:12.463

垃圾箱/出口

( [Dumpbin](http://msdn.microsoft.com/en-us/library/aa446532.aspx)`[1` ] 是 Windows SDK 中的一个实用程序)

`[1]`：http: [//msdn.microsoft.com/en-us/library/aa446532.aspx](http://msdn.microsoft.com/en-us/library/aa446532.aspx)

编辑：顺便说一句，当我在标签中看到“互操作”和“.NET”时，不要忘记 Reflector 和[pinvoke.net](http://pinvoke.net)。（当然，这些对实际的 Win32 DLL 导出都没有帮助。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T07:19:33.433

Windows SDK 用于包含可用于探索 DLL 内容的*依赖项遍历器GUI 实用程序：*

> Dependency Walker 是一个免费实用程序，它可以扫描任何 32 位或 64 位 Windows 模块（exe、dll、ocx、sys 等）并构建所有依赖模块的层次树图。对于找到的每个模块，它列出了该模块导出的所有函数，以及这些函数中的哪些函数实际上被其他模块调用。另一个视图显示最少的所需文件集，以及每个文件的详细信息，包括文件的完整路径、基地址、版本号、机器类型、调试信息等。

如今，[它可以在这里找到](http://dependencywalker.com/)。

有关方法签名的详细信息和创建互连代码，请在[pinvoke 站点](http://www.pinvoke.net/)`.NET`中查找您的 DLL 。您还可以尝试他们的 Visual Studio 2003 和 2005 加载项。

# jquery - 使用 jQuery 在单击时显示/隐藏 div 以创建“单击菜单”

> ID：605395
> 
> 赞同：2
> 
> 时间：2009-03-03T07:01:57.673
> 
> 标签：jquery

我是 jQuery 新手，需要一些帮助才能在点击时显示和隐藏 div。基本上，一旦用户单击链接，并且一旦用户单击刚刚显示的 div 内的链接，我就需要显示一个 div（包含一个小菜单）。或者在 div 之外单击我需要再次隐藏 div。我的 HTML 看起来像这样（我将存在于页面上的许多地方）。

```
<a class="menu" href="#">Menu</a>
<div class="menu-content" style="display: none; position: absolute; border: 1px solid black; background-color: White;padding: 5px;">
 <div><a href="#">Menu option 1</a></div>
 <div><a href="#">Menu option 2</a></div>
</div> 
```

我还有一个包含整个页面的 div，我认为我会设置另一个点击事件来隐藏 div（以捕获实际菜单之外的点击）。

这是解决这个问题的正确方法吗？然后我如何删除包装器 div 等上的处理程序等。我还应该考虑什么来解决这个问题（如果它是正确的方法）？

***更新：***根据下面接受的答案，我添加了这个来解决它

```
//Need to return false here, otherwise the event will bubble up and trigger the hide on body
$('.menu').click(function() { $('.menu-content').hide();$(this).next().show();return false; });
$('body, .menu-content a').click(function() { $('.menu-content').hide();});
$('.menu-content a').click(function() { alert($(this)); }); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-03T07:11:14.063

```
html:

<a class="menu" href="#">Menu</a>
<div class='a_menu' style="display: none; position: absolute; border: 1px solid black; background-color: White;padding: 5px;">
 <div><a href="#">Menu option 1</a></div>
 <div><a href="#">Menu option 2</a></div>
</div>

script:

$('.menu').click(function() { $(this).next('.a_menu').show(); });
$('body, .a_menu a').click(function() { $('.a_menu').hide(); }); 
```

我会用 SPANS 替换 < A > 标签，而不是用'cursor:pointer'

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-27T00:02:06.757

基于上面的问题和答案，我能够简化 jquery 代码以获得更接近我需要的东西。HTML 很丑，这里有一个完整的菜单栏，可以将下拉菜单放在上下文中。

```
<html>
<head>
  <style>
#menu {
}

#menu ul {
  margin: 0;
  padding: 8px 0px 0px 0px;
  list-style: none;
  line-height: normal;
}

#menu li {
  display: block;
  float: left;
}

#menu a,#menu span {
  display: block;
  float: left;
  height: 28px;
  background: #34579D;
  margin-right: 3px;
  padding: 8px 15px 0px 15px;
  letter-spacing: -1px;
  text-decoration: none;
  text-align: center;
  text-transform: lowercase;
  font-family: Arial, Helvetica, sans-serif;
  font-size: 14px;
  font-weight: normal;
  color: #FFFFFF;
}

#menu .drop-menu {
  cursor: pointer;
}

#menu li ul {
  display: none;
  position: absolute;
  margin-top: 31px;
}

#menu li ul li {
  background: #FFFFFF;
  border-style: solid;
  border-width: 3px;
  border-color: #FFFFFF;
}
  </style>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
  <script type="text/javascript">
  //<![CDATA[
  //Need to return false here, otherwise the event will bubble up and trigger the hide on body
  $(document).ready(function() {
    $('.drop-menu').click(function() {
      $('.drop-menu-content').toggle();
      return false;
    });
    $('body, .drop-menu-content span').click(function() {
      $('.drop-menu-content').hide();
    });
  });
  //]]>
  </script>
</head>
<body>
  <div id="menu">
    <ul>
      <li><a href="/" class="first">Home</a></li>
      <li><a href="/order_report.html" class="value">Order Computer Calculated Value Report</a></li>
      <li><a href="/php/order_appraisal.php">Order An Appraisal</a></li>
      <li class="current_page_item"><span class="drop-menu">Sample Reports</span>
        <ul class="drop-menu-content">
          <li><a target="_blank" href="/documents/value_check.pdf">Computer Calculated Report ($20)</a></li> <br />
          <li><a target="_blank" href="/documents/desktop.pdf">Computer Desk Top Appraisal ($45)</a></li> <br />
          <li><a target="_blank" href="/documents/exterior.pdf">Desk Top/Drive by Appraisal ($95)</a></li>
        </ul>
      </li>
      <li><a href="/FAQ.html">FAQ</a></li>
      <li><a href="/about_us.html">About Us</a></li>
      <li><a href="/php/contact.php">Contact Us</a></li>
      <li>
        <div class="menu-content">
        <ul>
          <a href="/php/contact.php">Contact Us</a>
        </ul>
        </div>
      </li>
    </ul>
  </div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T07:06:39.317

看看[suckerfish](http://www.alistapart.com/articles/dropdowns)和[listamatic](http://css.maxdesign.com.au/listamatic/)。您试图实现的目标可能只能通过 CSS 来解决。此外，您将对如何以更语义化的方式进行导航有所了解。

然后，您可以深入了解 jQuery，了解无法用纯 HTML+CSS 完成的内容。

# .net - 更改列表框项目的前景色

> ID：605397
> 
> 赞同：1
> 
> 时间：2009-03-03T07:02:17.580
> 
> 标签：.net, wpf, silverlight, listbox, xbap

我的 XBAP（WPF 浏览器应用程序）项目之一遇到问题：

这里我有两个列表框：

*   一个包含文本内容的简单列表
*   第二个包含一个扩展器作为每个项目：

[![替代文字](https://i.stack.imgur.com/SR0V1.jpg)](https://i.stack.imgur.com/SR0V1.jpg)

现在，当我单击第一个列表框中（左侧）中的项目时，前景变为白色，如果选择了另一个项目，则前景变为黑色。

至于第二个列表框（右侧）中的项目，当我单击该项目时，前景保持黑色。这是因为文本内容本身包含在 Expander 控件中：

[![替代文字](https://i.stack.imgur.com/MLlXu.jpg)](https://i.stack.imgur.com/MLlXu.jpg)

现在，如何使 Expander 控件前景色的行为类似于选择列表框项/更改选择项时的行为？是否有任何依赖属性可用于完成此操作？

注意：我希望第二个列表框（右）在前景色方面与第一个（左）完全相同。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T08:21:24.813

只需像这样添加`Foreground="{TemplateBinding TextElement.Foreground}"`到模板中的元素

```
<DataTemplate DataType="{x:Type l:City}">
    <Expander 
        Header="Click to Expand" 
        Foreground="{TemplateBinding TextElement.Foreground}"
        >
        <TextBlock 
            Text="{Binding Name}" 
            Foreground="{TemplateBinding TextElement.Foreground}"
            />
    </Expander>
</DataTemplate> 
```

# python - 由外部模块分配的 Python 变量可用于打印，但不能用于在目标模块中分配

> ID：605399
> 
> 赞同：1
> 
> 时间：2009-03-03T07:03:28.043
> 
> 标签：python, scoping

我有两个文件，一个在 webroot 中，另一个是位于 web root 上方一个文件夹的引导程序（顺便说一下，这是 CGI 编程）。

Web 根目录中的索引文件导入引导程序并为其分配一个变量，然后调用 aa 函数来初始化应用程序。到目前为止，一切都按预期工作。

现在，在引导文件中，我可以打印变量，但是当我尝试为变量赋值时，会引发错误。如果您拿走赋值语句，则不会引发错误。

我真的很好奇范围界定在这种情况下是如何工作的。我可以打印变量，但我不能分配给它。这是在 Python 3 上。

**索引.py**

```
# Import modules
import sys
import cgitb;

# Enable error reporting
cgitb.enable()
#cgitb.enable(display=0, logdir="/tmp")

# Add the application root to the include path
sys.path.append('path')

# Include the bootstrap
import bootstrap

bootstrap.VAR = 'testVar'

bootstrap.initialize() 
```

**引导程序.py**

```
def initialize():
    print('Content-type: text/html\n\n')
    print(VAR)
    VAR = 'h'
    print(VAR) 
```

谢谢。

编辑：错误信息

```
UnboundLocalError: local variable 'VAR' referenced before assignment 
      args = ("local variable 'VAR' referenced before assignment",) 
      with_traceback = <built-in method with_traceback of UnboundLocalError object at 0x00C6ACC0> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T07:23:30.337

试试这个：

```
 def initialize():
    global VAR
    print('Content-type: text/html\n\n')
    print(VAR)
    VAR = 'h'
    print(VAR) 

```

如果没有“全局 VAR”，python 想要使用局部变量 VAR 并为您提供“UnboundLocalError：分配前引用的局部变量 'VAR'”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T12:15:47.293

不要将它声明为全局，而是传递它并在需要新值时返回它，如下所示：

```
def initialize(a):
    print('Content-type: text/html\n\n')
    print a
    return 'h'

----

import bootstrap
b = bootstrap.initialize('testVar') 
```

# assemblies - 如何在内存中加载依赖程序集以使用 Assembly.Load() 方法

> ID：605404
> 
> 赞同：0
> 
> 时间：2009-03-03T07:07:22.433
> 
> 标签：assemblies

我有三个 dll ProjBL.dll、ProjDL.dll 和 ProjMC.dll。

ProjBL.dll 是业务对象 dll

ProjDL.dll 是数据访问层方法dll

ProjMC.dll 是 Master Class dll 包含的属性

ProjDL.dll 依赖于 ProjMC.dll，ProjBL.dll 依赖于 ProjDL.dll

我已经使用 Assembly.Load() 方法从 D 上的文件夹加载 ProjBL.dll 在内存中：具有指定文件夹的驱动器。

目前它给出了“未找到依赖程序集之一”的错误

使用的方法如下

```
 DirectoryInfo dllDirectory = new DirectoryInfo(folderPath); 
    FileInfo[] dllFiles = dllDirectory.GetFiles("*.dll"); 
    int dllCount = dllFiles.Length; 
    FileStream fs = null;         
    if (dllCount > 0) 
    { 
        long streamLength = 0; 
        for (int fileCount = 0; fileCount < dllCount; fileCount++) 
        { 
            fs = new FileStream(dllFiles[fileCount].FullName, FileMode.Open); 
            streamLength += fs.Length; 
            fs.Close(); 
        } 
        byte[] memory = new byte[streamLength]; 
        byte[] memory1 = null; 
        byte[] memory2 = null; 
        byte[] memory3 = null; 

        fs = new FileStream(dllFiles[0].FullName, FileMode.Open); 
        BinaryReader br = new BinaryReader(fs); 
        memory1 = br.ReadBytes(Convert.ToInt32(fs.Length));  // Loads ProjMC.dll 

        fs = new FileStream(dllFiles[1].FullName, FileMode.Open); 
        br = new BinaryReader(fs); 
        memory2 = br.ReadBytes(Convert.ToInt32(fs.Length));  // Loads ProjDA.dll 

        fs = new FileStream(dllFiles[2].FullName, FileMode.Open); 
        br = new BinaryReader(fs); 
        memory3 = br.ReadBytes(Convert.ToInt32(fs.Length));   // Loads ProjBL.dll 

        fs.Close(); 
        br.Close(); 

        memory1.CopyTo(memory, 0); 
        memory2.CopyTo(memory, memory1.Length); 
        memory3.CopyTo(memory, (memory1.Length + memory2.Length)); 

        assemblyUsed = Assembly.Load(memory);   

    }         
    return assemblyUsed; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-08T05:12:32.683

由于 ProjBL.dll 需要 ProjDL.dll 而需要 ProjMC.dll，因此 CLR 在加载 ProjBL.dll 时需要能够找到 ProjDL.dll 和 ProjMC.dll（以及任何其他依赖项）。

如果它们与可执行文件在同一目录中或在探测路径中，它应该能够找到它们。您可以使用 fuslogvw 查看 CLR 在哪里寻找依赖程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T07:24:13.377

为什么这么复杂？`Assembly.LoadFrom(string)`会很好地完成这项工作。或者您正在尝试实现一些非常奇怪的行为？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-23T23:41:51.010

当前应用程序查找程序集时，它会在多个位置（bin 文件夹、gac 等）查找。如果找不到，则开发人员需要手动告诉应用程序在哪里查找。您可以通过拦截 AssemblyResolve 事件并使用事件参数告诉 CLR 您的程序集在哪里来做到这一点。

```
AppDomain.CurrentDomain.AssemblyResolve += CurrentDomain_AssemblyResolve;
....................
Assembly CurrentDomain_AssemblyResolve(object sender, ResolveEventArgs args)
{
   var assemblyPath=
          Path.GetFullPath("..\\..\\..\\example\\" + args.Name.Substring(0,  args.Name.IndexOf(",")) + ".dll");

    return Assembly.LoadFrom(assemblyPath);
} 
```

# actionscript - Flash play() 立即处理？

> ID：605407
> 
> 赞同：0
> 
> 时间：2009-03-03T07:09:26.877
> 
> 标签：actionscript, flash, playing

`play()`Flash中的功能：

1.  将 MovieClip 的播放头移动到下一帧——一旦`play()`被调用
2.  将 MovieClip 的状态更改为“正在播放” - 实际上将 MovieClip 移动到下一帧，当电影移动到下一帧时

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T21:34:10.040

在正常情况下，它是选项 2。但是，可以立即重新绘制框架。但是有一个问题，您只能在鼠标移动和计时器间隔处理程序中执行此操作。在 AS3 中查看[MouseEvent.updateAfterEvent](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/events/MouseEvent.html)和[TimerEvent.updateAfterEvent](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/events/TimerEvent.html)方法。在 AS 2 中有一个全局[updateAfterEvent](http://livedocs.adobe.com/flash/9.0/main/00001233.html)函数，您可以使用相同的限制进行调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T07:14:18.830

我认为它**2.**将 MovieClip 的状态更改为“正在播放”

# java - 对于使用 java 5、jboss、mysql、apache，您推荐什么 ec2 映像 (ami)？

> ID：605408
> 
> 赞同：2
> 
> 时间：2009-03-03T07:10:19.667
> 
> 标签：java, mysql, apache, jboss, amazon-ec2

对于使用 java 5、jboss、mysql、apache，您推荐什么 ec2 映像 (ami)？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T19:57:03.473

试试[这个](http://developer.amazonwebservices.com/connect/entry!default.jspa?categoryID=116&externalID=1523&fromSearchPage=true)，或者只安装一个 Amazon 基础 Fedora 8 AMI，自己安装堆栈并创建自己的自定义 AMI（更灵活）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-21T16:45:53.373

也许我是偏执狂，但我建议与知名的 AMI 图像提供商合作。对我来说，在值得信赖的系统上安装所需的软件是值得的。我并不是说到处都有特洛伊木马和服务器端间谍软件，但请想一想：为什么在闯入后必须从媒体安装？因为即使事情看起来不错，您也永远无法确定您是否可以信任您的系统。正如神谕所说，“了解你自己”。

这些天来，我一直在享受 Ubuntu 8.10 服务器映像（只需搜索带有字符串“canonical”的 AMI）。如果您添加 Universe 存储库，那么当然还有 Sun Java5 包和 Apache httpd。我不确定JBoss，抱歉。

# iphone - 如何在 iPhone 上使用 self 类方法？（概念问题）

> ID：605414
> 
> 赞同：-2
> 
> 时间：2009-03-03T07:13:29.487
> 
> 标签：iphone, class, methods, class-design, instance

我在 ClassName.m 中编写了一个实例方法：

```
-(void)methodName:(paraType)parameter
{...}
```

并使用它调用它

```
[self methodName:parameter]; 
```

会弹出一个警告，但代码仍然可以成功运行。

这是因为我还没有创建类的实例吗？为什么该方法仍然正常运行？调用 self 方法来防止警告的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T07:54:21.400

那么接收警告帮助的第一步是发布警告:)

我假设这是关于无法识别的消息？如果是这样，那是因为尽管编译器看到了对“methodName”的调用，但它不知道这对对象是否有效。

我猜你的代码看起来像；

```
-(void) someFunc
{
  ...
  [self methodName:parameter]; 
  ...
}

-(void)methodName:(paraType)parameter
{
...
} 
```

你可以；

a) 将“methodName”函数放在文件的前面，以便编译器在调用之前看到它。

b) 在类接口中声明它。例如

```
// Foo.h
@interface Foo {
...
}
-(void) methodName:(paraType)parameter;
@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T07:50:45.403

您收到的警告是什么？

你的头文件中有方法的定义吗？

您使用的语法是对 self 调用方法的正确方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T07:54:23.040

该方法将起作用，因为 Objective-C 方法是在运行时解析的。我希望您收到的警告类似于“Object Foo 可能无法响应 -methodName:”，然后它会告诉您它默认返回类型为`id`. `-methodName:`那是因为编译器在编译您调用它的代码时还没有看到声明或定义。要删除警告，请在类的接口或类的类别中声明该方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-29T05:03:58.090

如果您收到警告，可能是因为方法签名不在接口中。

```
@interface foo ....

-(void)method; 
```

一旦编写了实现，警告就会消失，因为这不是编译器第一次看到该方法。不这样做也可以工作，但警告信息很烦人。

# c# - 加载 XML 文档并在树视图中显示它

> ID：605417
> 
> 赞同：2
> 
> 时间：2009-03-03T07:15:53.100
> 
> 标签：c#, xml, winforms

我必须加载一个 Xml 文档并在 winform 的树视图中显示。这是一段代码。请告诉错误是什么。

```
private void AddingNodesToTree(ref XmlNode xnode, ref TreeNode tnode)
{ 
    TreeNode subNode = treeNodes.Add(xnode.Name);
    subNode.Tag = xnode;
    foreach (XmlNode subElement in xnode.ChildNodes)
    {
        AddingNodesToTree(subNode.Nodes, subElement);
    }
} 
```

在此之后，我在该树中选择节点以显示所选节点的属性：

```
private void treeView1_AfterSelect(object sender, TreeViewEventArgs e)
{
    XmlNode xNode = e.Node.Tag as XmlNode;

    if (xNode != null)
    {
        foreach (XmlNode subNode in xNode.ChildNodes)
        {
            listBox1.Items.Add(subNode.Name);
        }
    }
} 
```

这段代码中可能出现的错误是什么？请纠正。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T07:31:51.487

一方面，在您对您的递归调用中`AddingNodesToTree`没有指定`ref`参数。不过，目前还不清楚为什么它们首先会出现在参数上。您对递归调用的参数似乎也是错误的类型。它*实际上是*一个递归调用，还是你调用了一个你没有显示的重载？

第二个明显的问题是您没有`tnode`在`AddingNodesToTree`. 这行应该：

```
TreeNode subNode = treeNodes.Add(xnode.Name); 
```

实际上是这样的：

```
TreeNode subNode = tnode.Add(xnode.Name); 
```

最后，你还没有告诉我们到底出了什么问题。您的代码是否无法编译或无法按预期工作？如果是前者，编译器错误是什么？如果是后者，请详细说明实际行为与预期行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T07:32:45.273

我的猜测：你想显示节点的属性，所以迭代 xNode.Attributes 而不是 xNode.ChildNodes。或者，在添加属性之前清除列表视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T07:31:52.703

我猜你有一个编译器错误

```
private void AddingNodesToTree(ref XmlNode xnode, ref TreeNode tnode)
{ 
    TreeNode subNode = treeNodes.Add(xnode.Name);
    subNode.Tag = xnode;
    foreach (XmlNode subElement in xnode.ChildNodes)
    {
    // you call it with the wrong params?
        AddingNodesToTree(subNode.Nodes, subElement);
    //should be
        AddingNodesToTree(ref subElement, ref subNode);
    }
} 
```

# iphone - 如何在 iPhone 上的 HTTP 连接失败时弹出警报？

> ID：605425
> 
> 赞同：5
> 
> 时间：2009-03-03T07:23:22.007
> 
> 标签：iphone, http, exception, exception-handling, connection

我想编写一些代码来处理 HTTP 连接失败时的异常。我使用以下代码：

```
-(void) connection:(NSURLConnection *)connection
  didFailWithError: (NSError *)error {
    UIAlertView *errorAlert = [[UIAlertView alloc]
                    initWithTitle: [error localizedDescription]
                    message: [error localizedFailureReason]
                    delegate:nil
                    cancelButtonTitle:@"OK"
                    otherButtonTitles:nil];
    [errorAlert show];
    [errorAlert release];
    [activityIndicator stopAnimating];
    NSLog (@"Connection Failed with Error");
} 
```

但是当连接失败时，程序就会崩溃。如何让警报弹出而不会导致程序崩溃？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T18:05:35.440

您的代码没有明显错误，您需要提供更多信息。

确保你有一个[断点`objc_exception_throw`](http://www.corbinstreehouse.com/blog/index.php/2008/08/your-most-important-breakpoint-in-cocoa/)，然后在调试器下运行程序。然后您可以确定在哪一行抛出异常。

一个疯狂的猜测，但也许`[error localizedDescription]`或`[error localizedFailureReason]`正在回归`nil`。

# c# - 当用户双击其关联文件时，如何打开应用程序？

> ID：605428
> 
> 赞同：6
> 
> 时间：2009-03-03T07:23:45.513
> 
> 标签：c#

我正在创建一个使用某种文件格式作为其数据源的应用程序。我希望每当用户双击此文件时打开此应用程序，例如当用户双击 Word 文档时 MS Word 将如何打开。我该如何做到这一点？另外，我将如何使用用户选择的文件填充数据字段。我会使用 program.cs 类中的 args[] 吗？我正在使用 c# 来编写这个应用程序。

NB 我希望当应用程序安装在主机上而不用户做任何事情时建立这种关联。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-09-28T16:53:37.470

**首先**，您需要设置文件关联，以便您的文件类型与您的应用程序相关联，打开文件类型将运行您的应用程序。

您可以以编程方式进行文件关联，这里有一些细节提到： http: [//www.codeproject.com/KB/dotnet/System_File_Association.aspx](http://www.codeproject.com/KB/dotnet/System_File_Association.aspx)

如果您有一个，您也可以通过您的应用程序的安装项目来完成它。对于“新手”来说，这是一条**更容易的道路。**使用 Visual Studio 获取安装项目以添加文件关联并设置文件图标的详细信息如下： [http ://www.dreamincode.net/forums/topic/58005-file-associations-in-visual-工作室/](http://www.dreamincode.net/forums/topic/58005-file-associations-in-visual-studio/)

否则，如果您使用 InnoSetup、Wix 等，那么我想您可以看到这些安装程序为您创建关联的说明。

**第二**，您需要让您的应用程序接受命令行参数。打开的文件作为命令行参数传递。您需要处理参数以获取文件路径/名称并打开给定的文件。这里有一个很好的代码描述： [C# Command Line arguments problem in Release build](https://stackoverflow.com/questions/728317/c-command-line-arguments-problem-in-release-build/730545#730545)

`MessageBox.Show(s)`在您的情况下，您将调用您定制的参数解析方法，而不是显示处理程序的表单。对于只接受文件名作为参数打开的简单应用程序，这可能很简单

```
foreach (string filePathName in Args)
                DoNamedFileOpen(filePathName); 
```

您的代码还可以有一种方法，可以从文件中提取您感兴趣的数据字段的值等。

这是一个很好的简单方法，可以解决在安装应用程序时设置文件关联，使用图标，并让应用程序处理这些文件的打开。

当然，还有很多其他选项，例如运行时文件关联（询问用户是否需要关联）、检测“损坏的”关联等。

这个问题在这里很久了，但我希望这对新搜索有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T07:26:57.147

看到[这个](http://www.codeproject.com/KB/dotnet/System_File_Association.aspx)。或者[，](http://www.google.com/search?hl=en&q=windows+file+associations&btnG=Google+Search&aq=0&oq=windows+file+asso)如果您需要 API 信息，请点击此处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T07:53:36.597

从 .NET 3.5 SP1 开始，ClickOnce 也支持文件关联。在项目的属性中，切换到`Publish`选项卡并单击`Options`按钮。该对话框中有一个`File Associations`部分允许您指定文件扩展名、描述和自定义图标。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T07:26:29.893

首先，您必须将文件类型扩展名与可执行文件相关联。在 Windows 上，您可以通过注册表执行此操作（搜索“文件类型关联窗口”）。在这个问题中，您会发现一些有趣的提示：[Filetype association with application (C#)](https://stackoverflow.com/questions/222561/filetype-association-with-application-c) [Script to associate an extension to a program](https://stackoverflow.com/questions/212906/script-to-associate-an-extension-to-a-program)

您的程序必须对命令行参数或参数做出反应。在Java中，确实是main方法的字符串数组。我猜，在 C# 中也是一样的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T07:28:52.880

如果您不需要以编程方式执行此操作，请右键单击图标，单击打开方式...，然后选择“始终使用此程序...”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T07:36:44.470

这通常由您的安装程序处理。例如，我使用了[INNO 安装](http://www.innosetup.com/isinfo.php)程序，当双击/打开关联的文件扩展名时，安排它调整用户的注册表以启动您的应用程序非常简单。它甚至会为您处理 MIME 类型以及在卸载时清除这些内容，这是一件非常好的事情

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T06:30:20.503

我设法解决了这个问题。我使用 WIX 创建了一个安装文件，并要求它在安装时将文件与应用程序相关联。

# parsing - 你将如何解析 Markdown？

> ID：605434
> 
> 赞同：130
> 
> 时间：2009-03-03T07:27:37.813
> 
> 标签：parsing, markdown

> 编辑：我最近了解了一个名为 CommonMark 的项目，它可以正确识别和处理原始 Markdown 规范中的歧义。[http://commonmark.org/](http://commonmark.org/)它有很好的 C# 库支持。

[您可以在此处](http://daringfireball.net/projects/markdown/syntax)找到语法。

下载后的源代码是用[Perl](http://en.wikipedia.org/wiki/Perl)编写的，我无意兑现。它充斥着正则表达式，它依赖[MD5](http://en.wikipedia.org/wiki/MD5)散列来转义某些字符。这有点不对劲！

我即将为[Markdown](http://en.wikipedia.org/wiki/Markdown)硬编码一个解析器。这有什么经验？

如果你对 Markdown 的实际解析没有任何意义，请抽空。（这听起来可能很苛刻，但是是的，我正在寻找洞察力，而不是解决方案，即第三方库）。

为了对答案有所帮助，正则表达式旨在**识别模式**！不要解析整个语法。人们认为这样做是 foobar。

*   如果您考虑 Markdown，它基本上是基于段落的概念。
*   因此，一种合理的方法可能是将输入分成几段。
*   段落有很多种，例如标题、文本、列表、块引用和代码。
*   因此，挑战在于识别这些段落以及它们出现在什么上下文中。

一旦我发现它值得分享，我会回来提供解决方案。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-03-03T10:35:56.473

我所知道的唯一使用实际解析器的降价实现是[Jon MacFarleane](https://GitHub.Com/JGM/)的[peg-markdown](https://GitHub.Com/JGM/PEG-Markdown/)。[它的解析器](https://GitHub.Com/JGM/PEG-Markdown/tree/master/markdown_parser.leg)基于名为[peg的](http://Piumarta.Com/software/peg/)[Parsing Expression Grammar](http://PDOS.CSAIL.MIT.Edu/%7Ebaford/packrat/)解析器生成器。

* * *

编辑：[Mauricio Fernandez](http://EigenClass.Org/R2/)最近发布了他的[Simple Markup Markdown parser](https://GitHub.Com/MFP/OcsiBlog/blob/master/simple_markup.ml)，这是他作为[OcsiBlog](https://GitHub.Com/MFP/OcsiBlog/) Weblog Engine 的一部分编写的。因为解析器是用[OCaml](http://Caml.INRIA.Fr/)编写的，所以它*非常*简单和简短（[解析器为 268 SLOC，](https://GitHub.Com/MFP/OcsiBlog/blob/more-markdown-compat/simple_markup.ml) [HTML 发射器](https://GitHub.Com/MFP/OcsiBlog/blob/more-markdown-compat/simple_markup__html.ml)为 43 SLOC [*）*](http://EigenClass.Org/R2/writings/markdown-redux-html-generation)，但[速度非常快](http://EigenClass.Org/R2/writings/markdown-redux-html-generation)（比[折扣](http://WWW.Pell.Portland.Or.Us/%7Eorc/Code/markdown/)（用手工优化的 C 编写）快 20%，快*六*百倍比[BlueCloth](http://Deveiate.Org/projects/BlueCloth/) ([红宝石](http://Ruby-Lang.Org/)))，尽管它甚至还没有针对性能进行优化。因为它仅供 Mauricio 自己的博客内部使用，与[官方 Markdown 规范](http://DaringFireball.Net/projects/markdown/syntax/)有一些偏差，但 Mauricio 创建[了一个分支来恢复大部分更改](https://GitHub.Com/MFP/OcsiBlog/tree/more-markdown-compat/)。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2010-05-03T08:16:07.537

上周我发布了一个新的基于解析器的 Markdown Java 实现，称为[pegdown](http://github.com/sirthias/pegdown)。pegdown 使用 PEG 解析器首先构建抽象语法树，然后将其写入 HTML。因此，它比基于正则表达式的方法非常干净，更容易阅读、维护和扩展。PEG 语法基于 John MacFarlanes C 实现“peg-markdown”。

也许你感兴趣的东西...

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-03T09:20:06.483

如果我要尝试解析 markdown （及其扩展[Markdown extra](http://michelf.com/projects/php-markdown/extra/)），我想我会尝试使用状态机并一次解析一个字符，然后将一些表示文本位的内部结构链接在一起，一次all 被解析，从所有串在一起的对象中生成输出。

基本上，当我读取输入文件时，我会构建一个类似迷你 DOM 的树。
要生成输出，我只需遍历树并输出 HTML 或其他任何内容（PS、LaTex、RTF、...）

可能增加复杂性的事情：

*   您可以混合使用 HTML 和 markdown，尽管该规则很容易实现：只需忽略两个平衡标签之间的任何内容并逐字输出。

*   URL 和注释可以在文本底部有参考。使用超链接的数据结构可以简单地记录如下内容：

    ```
    [my text to a link][linkkey]
    results in a structure like: 
        URLStructure: 
        |  InnerText : "my text to a link"
        |  Key       : "linkkey"
        |  URL       : <null> 
    ```

*   标题可以用下划线定义，这可能会迫使我们对通用段落使用简单的数据结构，并在阅读文件时修改其属性：

    ```
    ParagraphStructure:
    |  InnerText    : the current paragraph text 
    |                 (beginning of line until end of line).
    |  HeadingLevel : <null> or 1-4 when we can assess 
    |                 that paragraph heading level, if any. 
    ```

无论如何，只是一些想法。

我确信有许多小细节需要处理，并且我很确定正则表达式在此过程中会变得很方便。
毕竟，它们是用来处理文本的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-03T07:45:17.727

我可能已经阅读了足够多的语法规范来了解它，并了解如何解析它。

阅读现有的解析器代码当然很棒，既可以了解复杂性的主要来源，也可以了解是否使用了任何特殊的聪明技巧。使用 MD5 校验和似乎有点奇怪，但我对代码的研究还不够深入，无法理解为什么要这样做。一个名为`_EscapeSpecialChars()`states 的例程中的注释：

> 我们将每个这样的字符替换为其对应的 MD5 校验和值；这可能是矫枉过正，但它应该可以防止我们意外地与转义值发生冲突。

用完整的 MD5 替换单个字符确实看起来很奢侈，但也许真的很有意义。

当然，考虑创建一个“真正的”语法是很聪明的，这样像[Flex](https://github.com/westes/flex)这样的工具才能摆脱正则表达式的困境。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-03T07:44:40.970

如果 Perl 不是你的菜，那么[至少有 10 种其他语言](http://markdown.infogami.com/)的 Markdown 实现。它们可能并非都具有 100% 的兼容性，但往往非常接近。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-04-29T06:11:22.183

[MarkdownPapers](http://markdown.tautua.org)是另一种 Java 实现，其解析器以[JavaCC](http://en.wikipedia.org/wiki/JavaCC)语法定义。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T07:54:35.627

如果您使用的编程语言有超过三个其他用户，您应该能够找到一个库来为您解析它。快速搜索一下 CL、Haskell、Python、JavaScript、Ruby 等库。您极不可能需要重新发明这个轮子。

如果您真的必须从头开始编写它，我建议您编写一个适当的解析器。使用这种技术，您不必使用 MD5 散列来转义。（我同意如果你必须做这样的事情，是时候重新考虑你的设计了。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T07:46:16.333

[在这里](https://github.com/showdownjs/showdown/)你可以找到 Markdown 的 JavaScript 实现。它还严重依赖正则表达式，因为这只是解析文本的最快和最简单的方法。

但它保留了 MD5 部分。

我无法直接帮助解析的编码，但也许这个链接可以帮助你。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-03T07:47:22.510

有多种语言可用的库，包括 php、ruby、java、c#、javascript。我建议查看其中的一些想法。

这取决于您希望使用哪种语言，为了实现它的最佳方式，将有惯用和非惯用方式来实现它。

正则表达式在 perl 中工作，因为 perl 和正则表达式是最好的朋友。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-03T08:20:28.687

Markdown 是一种 JAWL（只是另一种 wiki 语言）

那里有很多开源 wiki，您可以检查解析器的代码。大多数使用正则表达式

查看螺丝转维基，它有一个有趣的多通道格式化程序管道，一个非常好的技术 - 参见 /core/Formatter.cs 和 /core/FormatterPipeline.cs

最好是使用/加入现有项目，这类事情总是比看起来要困难得多

# networking - 通过网络工作

> ID：605440
> 
> 赞同：0
> 
> 时间：2009-03-03T07:32:27.630
> 
> 标签：networking

我在网络上使用 aix box。我正在使用腻子在盒子上工作。问题是它太慢了，但我们确实有一个高速网络。

除了腻子之外，还有什么终端程序可以帮助我舒适地工作……通过做一些缓冲或其他机制，我不会觉得我在拨号。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T09:42:34.543

PuTTY 非常快——我从来没有遇到过任何问题。

你确定瓶颈在哪里了吗？您的客户端和服务器之间的网络的确切设置是什么？AIX 服务器是否负载过重？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T07:39:46.927

我有同样的问题，具体取决于我在哪里。最近，在家里，当我的主要 ISP 经历“成长的痛苦”时，我的备份连接速度非常慢

我已经有一段时间没有使用腻子了，它有 gzip 压缩的选项吗？如果没有，我建议使用官方的 OpenSSH 客户端（但在 Windows 上安装可能会很痛苦）。

我通常使用 ssh -C (compression) user@host，提速几乎是 30%。我感觉到你的痛苦，打字时很糟糕，每个字符需要大约 3 秒才能出现。

# svn - 具有 2 个 SVN 服务器的代码的相同工作副本

> ID：605441
> 
> 赞同：12
> 
> 时间：2009-03-03T07:32:41.420
> 
> 标签：svn

是否可以使用相同的工作副本并将其放入两个不同的 SVN 服务器（提交、更新、...）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T07:39:05.057

是的，您可以使用 Relocate（谢谢，Peter）命令将您的工作副本与第一个存储库连接，在那里提交，然后重新定位到第二个存储库并在那里提交。最好先在其他地方复制您的工作副本文件夹。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T07:57:50.767

[如何同步两个 Subversion 存储库？](https://stackoverflow.com/questions/143130/how-to-synchronize-two-subversion-repositories)

[我可以在两个 SVN 存储库中拥有一个项目吗？](https://stackoverflow.com/questions/425975/can-i-have-one-project-in-two-svn-repositories)

[SVN：一个工作副本，两个存储库？](https://stackoverflow.com/questions/580443/svn-one-working-copy-two-repositories)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T07:39:55.273

如果多个人将与不同的 svn 服务器通话，您将遇到麻烦。两台服务器不会相互通信以确保它们没有冲突，使用相同的修订号等。至少，我不知道有任何 svn hack 可以做到这一点。（还有其他基于 svn 的分布式版本系统，例如[svk](http://svk.bestpractical.com/)。）

这里的核心目标是什么？您是否可以只推送到单个服务器，然后有一个提交后挂钩将更改复制到另一台服务器，这将允许从其他位置轻松进行只读访问？

您可以提供的有关您想做的事情的详细信息越多，我们就越有可能为您提供帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T07:41:55.317

Mercurial、Bazaar 或 Git 等分布式版本控制系统更适合此类任务。您可以将更改*推送到*任意数量的存储库中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T07:48:27.687

它可能但非常激烈。我目前必须这样做，因为我的 ISP 已经脑残，而且我在到达欧洲的各个数据中心时遇到了难题。所以，我推送到我在加拿大的服务器，该服务器会立即推送到真实的存储库。

有两次，我实际上最终得到了不同的修订号（+1），这意味着我的下一个 svn up 变得非常有趣。

所以，我只是使用 SSHFS（一个 FUSE 挂载）来编辑加拿大副本上的文件，然后直接提交。它仍然是一个真正的痛苦，也是我如此喜欢 Mercurial 的众多原因之一。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-24T14:13:12.753

首先，将您的代码签出到每个服务器，然后创建一个脚本 svn_up.sh，如下所示：

```
ssh  server_one_ip_address svn up /path_to_working_copy_on_server1
ssh  server_two_ip_address svn up /path_to_working_copy_on_server2 
```

使用 sh svn_up.sh 而不是 svn up

# visual-studio-2008 - VS2008 删除我在 .js 文件中的缩进

> ID：605461
> 
> 赞同：1
> 
> 时间：2009-03-03T07:46:50.047
> 
> 标签：visual-studio-2008, json, extjs, indentation

我正在使用 ExtJs 框架，因此必须在 vs2008 中编写大量 JS 代码，但是，VS2008 不断消除我的缩进并让我发疯。

如何删除“自动缩进”功能？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T08:06:13.447

简单的答案是：**关闭格式选项卡中的自动格式**

[从此处](http://blogs.msdn.com/webdevtools/archive/2008/05/12/introducing-jscript-formatting-in-vs-2008-sp1.aspx)的文档中提取

* * *

JScript 特定设置在新的工具/选项/文本编辑器/JScript 节点下可用

这四个选项卡是：

**常规**和**标签**

此处的选项是所有编辑器（包括 JScript）的标准选项

**格式化**

此选项卡专为 JScript 设计，包含大部分 JScript 特定格式功能

自动格式化：本节指的是当用户“实时”键入和操作代码时，何时会发生格式化。基本上，格式化是在用户构建代码时执行的。

*   输入时格式化完成的行（默认打开）：一旦按下 {ENTER}，该行将根据设置的选项进行格式化
*   格式化完成的声明；（默认开启）：一次；按下，该行将根据设置的选项进行格式化
*   在 } 上格式化完成的块（默认打开）：一旦按下 }，块将根据设置的选项进行格式化
*   粘贴时格式化（默认开启）：将代码粘贴到编辑器后，将根据设置的选项进行格式化

**各种各样的**

此选项卡也是 JScript 特定的，包含验证规则和语句完成选项

# c# - IDisposable GC.SuppressFinalize(this) 位置

> ID：605466
> 
> 赞同：11
> 
> 时间：2009-03-03T07:49:40.117
> 
> 标签：c#, .net, idisposable, suppressfinalize

我为我的代码使用默认的 IDisposable 实现模板（模式）。

片段：

```
public void Dispose()
{
    Dispose(true);

    GC.SuppressFinalize(this);
}

protected virtual void Dispose(bool isDisposing)
{
    if (!this.disposed)
    {
        if (isDisposing)
        {
            //cleanup managed resources
        }

        //cleanup unmanaged resources

        this.disposed = true;
    }
} 
```

我的问题：为什么在 Dispose 公共方法中调用“GC.SuppressFinalize(this)”？在处置托管资源后，我会将“GC.SuppressFinalize(this)”放在受保护方法的“if (isDisposing)”部分中。

像这样：

```
protected virtual void Dispose(bool isDisposing)
{
    if (!this.disposed)
    {
       if (isDisposing)
       {
           //cleanup managed resources

           GC.SuppressFinalize(this);
       }

       //cleanup unmanaged resources

       this.disposed = true;
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-03T08:55:30.847

我想这是模板设计模式的一个明显案例。

您的抽象类旨在处理所需的所有重要/必要任务（此处为 GC.SuppressFinalize(this)），并允许派生类仅覆盖部分代码。

这里有两种情况：
Snippet 1, SuppressFinalize, in Dispose
Snippet 2, SuppressFinalize, in Dispose(true)

在这里，片段 1 确保始终执行 GC.SuppressFinalize。虽然代码片段 2 让 GC.SuppressFinalize 的执行受**派生类**支配。

因此，通过将 GC.SuppressFinalize 放在 Dispose 方法中，作为类的设计者，您将始终确保无论派生类编写什么代码，都会执行 GC.SuppressFinalize。

这只是在 Dispose 而不是 Dispose(true) 中编写 SuppressFinalize 的好处。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-03T10:56:05.363

该`Dispose(bool isDisposing)`方法不是[`IDisposable`](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)接口的一部分。

您通常会`Dispose(true)`从您的[`Dispose`](http://msdn.microsoft.com/en-us/library/system.idisposable.dispose.aspx)方法调用，并`Dispose(false)`从您的终结器调用，作为尚未处置对象的情况下的后备。

调用[`SuppressFinalize`](http://msdn.microsoft.com/en-us/library/system.gc.suppressfinalize.aspx)告诉 GC 不需要调用对象的终结器，大概是因为在`Dispose`调用时所有清理工作都已完成。

如果您的班级没有终结器，那么您根本不需要调用`SuppressFinalize`，因为没有终结器可以抑制！

Joe Duffy[在处理、完成、垃圾收集等方面有一些很好的指导方针](http://www.bluebytesoftware.com/blog/2005/04/08/DGUpdateDisposeFinalizationAndResourceManagement.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T08:04:09.693

我认为可以选择任一布局，但可能他们想在受保护的 Dispose 方法中强调“将所有解除分配代码放入此方法中”，因此他们将另一个处理（抑制终结）工件放在其他地方。

此外，假设派生类有另一个调用受保护的 Dispose 方法的原因，但仍然希望发生终结（无论出于何种想象的原因，我不知道）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T10:20:37.603

原因 .Dispose 是托管代码（您的代码）处置对象从而选择退出最终确定的时候。人们通常通过终结器创建另一条进入 Dispose(bool disposing) 的路线，并且该调用对于终结器来说没有任何意义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T07:54:50.073

这个想法是你的清理代码应该只被调用一次。但是有两个入口点：`Dispose`方法终结器和对象终结器。当`Dispose`被调用时，您选择退出终结，以便您的清理代码只被调用一次。这里的[代码](http://msdn.microsoft.com/en-us/library/ms244737(VS.80).aspx)可能会更好地说明它。

引用：

```
// NOTE: Leave out the finalizer altogether if this class doesn't 
// own unmanaged resources itself, but leave the other methods
// exactly as they are. 
```

# php - xdebug vim插件的问题

> ID：605469
> 
> 赞同：0
> 
> 时间：2009-03-03T07:50:50.847
> 
> 标签：php, vim, xdebug

我正在为 vim 使用 xdebug 插件。进行一些更改后，我能够运行调试器但无法设置断点。所以，我启用了 xdebug.remote_log，下面是设置断点对应的日志语句。

<- breakpoint_set -i 5 -t line -f file:///C:\htdocs\testLocal.php -n 36 ->

它仅以正确的格式向调试器发出请求，但不知道为什么调试器返回“命令不可用”。请让我知道是否有任何问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-20T22:17:41.233

确保在包含 php 表达式的行上设置断点，*而不是*在空行或仅包含右括号的行上。

在空行上设置断点不起作用，并返回您得到的神秘的“找不到命令”错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-25T01:15:53.527

我有同样的问题。当我检查 xdebug 日志时，它显示 file:///http://myapp.local 如您所见，我的 ide（PHP eclipse）似乎插入了额外的“http://”，将其视为 URL 而不是文件.

幸运的是，我的 index.php 就是这种情况。其他文件断点已正确传达给 xdebug，只要他们不知道跨越多行，我就能够在 php 表达式上设置和命中断点。后者由于某种原因会导致断点没有命中而只是通过。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-31T20:01:46.320

我最近刚刚安装了同样的东西，并找到了[Blake Johnson 的教程，](http://www.blakerobertjohnson.com/debugging-php-on-windows-with-xdebug-and-vim)所有关于在 Vim 中安装和使用 Xdebug 的内容。

此外，请尝试清除您可能拥有的页面上的所有 cookie。这通常会导致插件以一种奇怪的方式搞砸。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-14T08:26:56.633

我在“file:///C:\htdocs\testLocal.php”中发现了一个额外的“/”，可能是 vim 插件与 windows 文件路径不兼容？

# c# - 用于指示更改的 SQL 列名

> ID：605471
> 
> 赞同：0
> 
> 时间：2009-03-03T07:53:31.700
> 
> 标签：c#, sql, sqlcachedependency

我真的不知道如何制定标题。但这是我的问题。我们正在使用 SqlCacheDependencies 来更新缓存对象。但是这背后的查询是“复杂的”，我们想让它变得更容易一些。

我们的第一个想法是添加一个像 DateChanged 这样的字段名，并使用 DateChanged 来检查对象是否实际发生了更改，而不是加载表的所有列。

```
SELECT DateChanged FROM Table1 
```

代替

```
SELECT Id, Title, DateChanged, Description FROM Table1 
```

但我希望有人能告诉我是否有其他方法可以做到这一点，或者是否有标准来命名表示更改的列。“实体框架”或“NHibernate”之类的框架如何处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T07:58:10.457

它通常被称为“时间戳”

即在

*   [LLBLGEN](http://davidhayden.com/blog/dave/archive/2006/10/24/ConcurrencyTimestampLLBLGenPro.aspx)
*   [LINQTOSQL](http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2008/07/01/10557.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T08:01:26.423

这些是我在“可审计”实体上使用的列：

```
版本：hibernate的乐观并发控制
createdBy: FK 给用户
modifiedBy: FK 给用户
createdAt：时间戳
修改时间：时间戳
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T08:59:18.717

如果您使用的是 SQL Server，请注意时间戳列的命名有些误导。虽然它可用于跟踪列的更改，但它的值与日期或时间无关。它可以被认为是数据库中唯一的 ID，仅此而已。[http://msdn.microsoft.com/en-us/library/aa260631.aspx](http://msdn.microsoft.com/en-us/library/aa260631.aspx)

为了知道是否发生了更改，您需要两个时间戳，就像在 cherouvim 的回答中一样。一个在创建对象时设置，另一个在任何修改时设置，可能通过更新触发器。如果它们不同，则该对象已被编辑，但您无法准确判断何时。

在 SQL Server 上，您必须使用相同的模式，但使用日期时间列。然后，您可以通过从 mod 日期中减去创建日期来计算行的日期。

# entity-framework - 实体框架的继承问题（每种类型的表）

> ID：605473
> 
> 赞同：0
> 
> 时间：2009-03-03T07:53:59.513
> 
> 标签：entity-framework, inheritance, table-per-type

对于我目前正在处理的项目的一部分，我有一组用于联合操作的四个表。一个表是其他三个表的抽象基础，每个表都在我的 EF 模型中表示，如下所示：

[EF 模型 -- 动作 http://chris.charabaruk.com/system/files/images/EF+Model+Actions.png](http://chris.charabaruk.com/system/files/images/EF+Model+Actions.png)

但是，我目前面临两个问题。第一个问题是`Actor`（对 a 的引用`User`）和`Subject`（对与每种类型的操作关联的类的实体的引用）`null`在我的子类中，尽管关联的数据库列在其关联表中保存了行的有效键。虽然我可以通过获取密钥`ActorReference`，`SubjectReference`但这当然需要设置一个新的 EF 上下文并查询它以获取引用的对象（也是 null）。*`Foo`*`Reference.Value`

第二个问题是具体动作类与其相关实体类之间关系的互惠端总是什么都没有。例如`Task.RelatedActions`，它应该给我所有引用特定任务对象的对象，它`TaskAction`完全没有对象。同样，数据库中存在有效行，Entity Framework 只是没有将它们放入对象中并将它们交给我。`Subject``RelatedActions`

任何人都知道我做错了什么，我应该怎么做才能让它发挥作用？

**更新：**似乎所有关系属性都不再在我的实体模型中工作了。哎呀...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T04:00:15.183

我认为您在这里遇到的问题是默认情况下 EF 不会自动加载相关实体。如果加载实体，除非您执行以下操作之一，否则对相关实体的集合或引用将为空：

1) 使用预先加载以便在单个查询中检索您的主要实体和相关实体。为此，请通过添加对 Include 方法的调用来修改您的查询。在上面的示例中，您可以使用以下查询：

```
from a in context.Actions.Include("Actor") select a 
```

这将使用相关的 Actor 方法检索每个操作。

2）在需要时使用显式延迟加载来检索相关实体：

```
action1.ActorReference.Load() 
```

在 .Net 4.0 随附的 EF 版本中，您还将拥有以下附加选项：

3）打开隐式延迟加载，以便在您引用导航属性时自动检索相关实体。

*   丹尼

# optimization - 如何计算开始-步骤-停止编码方案的最佳参数？

> ID：605480
> 
> 赞同：4
> 
> 时间：2009-03-03T07:55:35.953
> 
> 标签：optimization, data-compression

start-step-stop 码是一种数据压缩技术，用于压缩相对较小的数字。

该代码的工作原理如下：它具有三个参数，start、step 和 stop。Start 确定用于计算前几个数字的位数。Step 确定当我们用完时要添加多少位到编码中并停止确定用于对数字进行编码的最大位数。

因此，编码的长度由 l = start + step * i 给出。

特定代码的“i”值使用一元编码。即，多个 1 位后跟一个终止 0 位。如果我们已经停止，那么我们可以删除终止的 0 位。如果 i 为零，我们只写出 0 位。

因此 (1, 2, 5) 开始-步骤-停止代码将按如下方式工作：

值 0，编码为：0 0
值 1，编码为：0 1
值 2，编码为：10 000
值 9，编码为：10 111
值 10，编码为：11 00000
值 41，编码为：11 11111

那么，给定一个包含多个数字的文件，我们如何计算该文件的最佳开始-步骤-停止代码？最佳参数被定义为那些将导致最大压缩比的参数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T21:51:40.460

这些“开始-步骤-停止”代码看起来像是调用[霍夫曼代码](http://en.wikipedia.org/wiki/Huffman_coding)的不同方式。有关计算它们的伪代码的概要，请参见[基本技术。](http://en.wikipedia.org/wiki/Huffman_coding#Basic_technique)

本质上，这就是算法的作用：

在开始 Huffman 编码之前，您需要收集要压缩的每个符号的统计信息（它们在要压缩的文件中的总频率）。

之后，您可以使用该信息创建一棵[二叉树](http://en.wikipedia.org/wiki/Binary_tree)，以便最常用的符号位于树的顶部（因此使用较少的位）并且没有编码具有[前缀 code](http://en.wikipedia.org/wiki/Prefix_code)。因为如果编码具有公共前缀，则解压缩可能会产生歧义。

在霍夫曼编码结束时，您的起始值将是最浅叶节点的深度，您的步长将始终为 1（从逻辑上讲，这是有道理的，为什么要强制比您需要的更多位，一次只添加一个，）和您的停止值将是最深叶节点的深度。

如果频率统计数据未排序，则需要 O(nlog n) 来完成，如果它们按频率排序，则可以在 O(n) 中完成。

对于这种类型的编码，霍夫曼编码保证具有最佳的平均压缩率：

> Huffman 能够设计出这种类型中最有效的压缩方法：当实际符号频率与用于创建代码的频率一致时，没有其他将单个源符号映射到唯一的比特串会产生更小的平均输出大小。

这应该可以帮助您为您的问题实施理想的解决方案。

**编辑：**虽然相似，但这不是 OP 想要的。

这些代码的创建者的这篇[学术论文](http://www.stevenpigeon.org/Publications/publications/ssc_full.pdf)描述了开始-步骤-停止代码、开始-停止代码的概括。然而，作者在第 2 节末尾简要描述了如何获得最佳开始-步骤-停止。它涉及使用统计随机变量，或暴力资助最佳组合。在没有任何文件先验知识的情况下，算法为 O((log n)^3)。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T08:02:50.303

我使用的方法是一个简单的蛮力解决方案。该算法遵循以下基本步骤：

1.  计算文件中每个数字的频率。在同一遍中，计算文件中数字的总数，并将最大的数字确定为 maxNumber。

2.  将每个数字的概率计算为其频率除以文件中数字的总数。

3.  确定“optimalStop”等于 log2(maxNumber)。这是在香农信息论中应该用来表示 maxNumber 的理想位数，因此是对特定数字编码中使用的最佳最大位数的合理估计。

4.  对于从 1 到“optimalStop”的每个“开始”值，重复步骤 5 - 7：

5.  对于从 1 到 ("optimalStop" - "start") / 2 的每个“step”值，重复步骤 6 和 7：

6.  对于某个整数 i，计算最接近满足 stop = start + step * i 的“optimalStop”的“stop”值。

7.  计算此编码将使用的平均位数。这可以计算为每个数字的概率乘以给定编码中的位长度。

8.  选择具有最低平均位数的编码。

# asp.net - Hotmail 中的电子邮件地址小部件

> ID：605483
> 
> 赞同：1
> 
> 时间：2009-03-03T07:57:54.200
> 
> 标签：asp.net, widget

从 hotmail 向某人发送电子邮件时，“收件人”字段有一个小部件，其中各个电子邮件地址会自动封装在可关闭的框中。

这个小部件或控件叫什么？

我可以从任何地方下载或购买此控件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T08:20:51.807

Gmail 也有同样的功能。雅虎也有，我猜。它基于您在 to/cc/bcc 框中的联系人列表的自动完成。

[雅虎！UI 库：自动完成](http://developer.yahoo.com/yui/autocomplete/ "雅虎！ UI 库：自动完成")

[自动完成小部件 :: 基本 JSON 实现](http://www.java2s.com/Code/JavaScript/Ajax-Layer/AutoCompleteWidgetBasicJSONImplementation.htm "自动完成小部件 :: 基本 JSON 实现")

# compact-framework - 紧凑框架中的串行端口 - RTSEnable 和 DtrEnable

> ID：605485
> 
> 赞同：2
> 
> 时间：2009-03-03T07:58:46.443
> 
> 标签：compact-framework, serial-port

如何`RTSEnable`使用`DtrEnable`？我发现有些天平可以与我的应用程序通信，但即使设置匹配，有些天平也不能。（波特率、奇偶校验、数据位、停止位和握手）

串行端口设置保存在配置文件中，其想法是在需要时支持可能设置的不同组合。通常，我们的设备被编程为有`handshake = NONE`，但如果一些奇怪的设备不能有`handshake=NONE`，我应该插入一个条件，例如：

```
if (serialport.Handshake != NONE) {
    serialport.RTSEnable = true;
    serialport.DtrEnable = true;
} 
```

或者更确切地说，其他握手（除了`NONE`）是否会在没有`RTSEnable`并`DtrEnable`设置为 的情况下工作`true`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T15:05:53.237

是否需要硬件握手完全取决于您连接的串行设备。您必须阅读设备的 OEM 规范，查看设备是否需要握手以及是否需要对 RTS 或 DTR 进行任何特殊处理。

# html - 指向 html 上的某些文件时，绝对路径和相对路径有区别吗？

> ID：605488
> 
> 赞同：1
> 
> 时间：2009-03-03T08:00:24.333
> 
> 标签：html, performance

我们的办公室刚刚得到了这个经验丰富的新人，并一直坚持我们停止使用绝对路径，例如：

`http://somesite.com/subdir1/images/filename.ext`

当指向我们图像的路径时，当它位于调用它的文件旁边时，说我们本来可以使用：

`./subdir1/images/filename.ext`

但是原因为什么我们之前使用绝对路径是为了防止当我们将另一个页面放在另一个目录中时出现死链接，而不是递归 地显式键入

`"../../"`OR ......那么使用它们时真的有区别吗？ 他说每个绝对网址都是对服务器的单独请求。但从那以后我一直在使用这种方法，我可以安全地保证预期的快速响应时间，有人能启发我吗？`"./"`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T08:04:29.940

一切都是对服务器的单独 http 请求。相对或绝对都无所谓。

当然，如果绝对 url 指向同一个网站但在不同的主机上，那么这*可能会*加快速度，因为它打破了[2 个并发 http 请求限制](http://www.openajax.org/runtime/wiki/The_Two_HTTP_Connection_Limit_Issue)。例如，您的网站位于**www.example.com**并且您从**static.example.com**提供所有图像。

防止您提到的链接断开问题的另一种方法是通过虚拟 URL：/images/foo.png

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T08:15:59.413

Using relative paths make it possible for you to move your entire webapplication to another domain and/or folder without fixing every path.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T08:17:28.007

Relative paths make for smaller HTML, resulting in less bandwidth consumption.

Relative paths are context friendly, meaning both "site.com" and "www.site.com" will work equally well, without the need for redirects from "site.com" to "www.site.com".

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T08:12:13.463

绝对路径将是绝对根目录，并且用途广泛，您以后可以将文件移动到另一个目录，并且链接仍然可以使用。如果您更改了域名，没问题，链接仍然有效。

```
/foo/monkey-wrench.song 
```

Relative paths would be relative to the page you're on, and breaks if you ever move the file outside of its current directory.

```
../foo/everlong.song 
```

Slapping on the domain part would make it an absolute URL.

```
http://example.com/foo/this-is-a-call.song 
```

Which is good if you have a scraper come along and then they would be able to link back to your own site so that when you check the referrer logs, you know who to go about sending that take down notice to.

Difference between the two would be how much more busy work you want to create for yourself later on.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T08:15:09.573

I prefer to parse Request.RawURL manually to avoid collisions with urls

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T11:22:57.000

There might be a bit of a cargo-cult thing going on there.

Where I work, we were told by the server techs that absolute URLs *did* cause delays, because there was load-balancing involved. An absolute URL would go back to the switch and be relayed to one of four servers, whereas a local one wouldn't.

So it might have been true at his old work place. Whether it's true at your workplace is for you to find out.

But if he can't explain why he's saying it, it's a folk-belief until proven otherwise.

# iphone - 点击时隐藏/显示导航栏和工具栏

> ID：605492
> 
> 赞同：10
> 
> 时间：2009-03-03T08:01:57.310
> 
> 标签：iphone

我试图隐藏我的导航栏和工具栏，类似于照片应用程序的工作方式。

任何指针将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-07-28T02:23:56.003

这也有效:)

```
[self.navigationController setNavigationBarHidden:YES animated:YES]; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-03T09:33:49.960

尝试像这样为 UINavigationBar 和 UIToolBar 的 y 值设置动画

```
[UIView beginAnimations: nil context:NULL];
[UIView setAnimationDuration:0.4];
[UIView setAnimationDelegate: self];
CGRect rect = self.navigationController.navigationBar.frame;
rect.origin.y = -40;
self.navigationController.navigationBar.frame = rect;
[UIView commitAnimations]; 
```

希望这对你也有帮助。

一种。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-30T23:40:29.273

在 iOS 8 中，您可以通过以下方式简单地实现：

```
self.navigationController.hidesBarsOnTap = YES 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T03:27:24.410

那么你仍然可以使用

```
[self.navigationController setNavigationBarHidden:YES animated:YES]; 
```

当导航/工具栏显示时，您可以阻止视图向上滑动。您可以让导航/工具栏在视图上淡入淡出，而无需滑动视图。试试这个对我有用的代码。

```
self.wantsFullScreenLayout = YES; 
```

也就是说，如果您当前在视图控制器上。

# nhibernate - SchemaExport、NHibernate 和删除外键

> ID：605495
> 
> 赞同：2
> 
> 时间：2009-03-03T08:02:53.143
> 
> 标签：nhibernate, schemaexport

我正在构建我的映射，然后使用模式导出来更新我的数据库。但是，如果我在我的映射中删除一个关联，因为它不再在映射中，所以当我运行 SchemaExport 时，它不会删除已删除关联的外键。这意味着它随后无法删除与该外键关联的表。这进一步意味着它无法重新创建表，并且我得到一个“数据库中已经有一个名为 Foo 的对象”异常。有没有办法通过模式导出暴力删除表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-07-28T12:59:59.210

最干净的方法是使用旧的 nhibernate 配置执行 SchemaExport.Drop，然后使用新配置进行创建。

或者，您可以删除并重新创建数据库本身，这是一个在文件级别为 SQL Server Express 执行此操作的示例：http: [//nicholas.piasecki.name/blog/2010/01/integration-testing-with-sql-server- express-2008-nhibernate-and-mstest/](http://nicholas.piasecki.name/blog/2010/01/integration-testing-with-sql-server-express-2008-nhibernate-and-mstest/)

# c++ - 从模板化父类访问继承的变量

> ID：605497
> 
> 赞同：29
> 
> 时间：2009-03-03T08:03:29.443
> 
> 标签：c++, inheritance, templates

考虑以下代码：

```
template<class T> class Foo
{
public:
  Foo() { a = 1; }

protected:
  int a;
};

template<class T> class Bar : public Foo<T>
{
public:
  Bar() { b = 4; };

  int Perna(int u);

protected:
  int b;

};

template<class T> int Bar<T>::Perna(int u) 
{ 
  int c = Foo<T>::a * 4; // This works
  return (a + b) * u;    // This doesn't
} 
```

g++ 3.4.6、4.3.2 和 4.1.2 给出错误

```
test.cpp: In member function `int Bar<T>::Perna(int)':
test.cpp:25: error: `a' was not declared in this scope 
```

g++ 2.96 和 MSVC 6、7、7.1、8 和 9 接受它，（至少）旧的 Intel 和 SGI c++ 编译器也接受它。

新的 Gnu C++ 编译器是否遵守标准？如果他们这样做了，继承类无法看到受保护的继承成员变量的原因是什么？

另外，如果有

```
int A() { return a; } 
```

在 Foo 中，我得到错误

```
test.cpp:25: error: there are no arguments to A that depend on a template parameter, so a declaration of A must be available
test.cpp:25: error: (if you use -fpermissiveâ, G++ will accept your code, but allowing the use of an undeclared name is deprecated) 
```

当我尝试在 Bar 的成员函数中使用它时。我也觉得这很奇怪：Bar 继承了 Foo，所以我认为很明显 Bar 范围内的 A() 是 Foo::A()。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-03T08:20:42.477

后来的 GCC 版本正确地实现了该标准。

该标准规定模板中的非限定名称是不相关的，并且必须在定义模板时进行查找。那时，依赖基类的定义是未知的（可能存在基类模板的特化），因此无法解析非限定名称。

对于在基类中声明的变量名和函数名都是如此。

正如您所观察到的，解决方案是提供变量或函数的限定名称，或者提供“使用”声明。例如

```
template<class T> 
int Bar<T>::Perna(int u) 
{ 
  int c = Foo<T>::a * 4; // This works
  c = this->a * 4; // and this

  using Foo<T>::a; 
  c = a * 4; // and with 'using', so should this
} 
```

（我实际上不是 100% 确定使用版本的正确语法，也无法从这里进行测试，但你明白了）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-09-04T11:32:08.973

GCC 给出的错误信息表明您的 GCC 版本仍然存在一个仅在 GCC4.7 主干版本中解决的错误。旧版本，包括 GCC4.1 将很乐意接受以下代码

```
template<typename T>
struct A {
  void f(int) { }
};

template<typename T>
struct B : A<T> {
  void g() { T t = 0; f(t); }
};

int main() {
  B<int> b; b.g();
} 
```

GCC 将在基类中查找并`f`在基类中找到声明。*GCC 这样做是因为**isdependent*，因为“依赖于模板参数”有参数（看看它给你的错误消息！）。但是标准禁止 GCC 这样做有两个原因`f(t)``A<T>`*`f`*`f`

1.  该标准说，使用不合格的名称将永远不会在依赖的基类中找到声明，*无论名称是否是依赖的*。

2.  该标准说，在实例化时对函数名称的依赖查找只会执行 ADL。

GCC 4.7 在这方面正确地实施了标准。

# c# - .NET 加密字节数组

> ID：605498
> 
> 赞同：1
> 
> 时间：2009-03-03T08:03:45.793
> 
> 标签：c#, .net, encryption

有没有办法在不使用流的情况下加密字节数组？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2011-09-09T11:05:14.713

事实上，您根本不需要使用任何流来操作字节。您唯一需要的是调用 ICryptoTransform 的 TransformFinalBlock() 方法，该方法可以是从 SymmetricAlgorithm 类派生的任何算法的加密器或解密器

```
public class CryptoProvider
{
    private SymmetricAlgorithm _algorithm = new RijndaelManaged();

    public byte[] EncryptData(byte[] data, string password)
    {
        GetKey(password);

        ICryptoTransform encryptor = _algorithm.CreateEncryptor();

        byte[] cryptoData = encryptor.TransformFinalBlock(data, 0, data.Length);

        return cryptoData;
    }

    public byte[] DecryptData(byte[] cryptoData, string password)
    {
        GetKey(password);

        ICryptoTransform decryptor = _algorithm.CreateDecryptor();

        byte[] data = decryptor.TransformFinalBlock(cryptoData, 0, cryptoData.Length);

        return data;
    }

    private void GetKey(string password)
    {
        byte[] salt = new byte[8];

        byte[] passwordBytes = Encoding.ASCII.GetBytes(password);

        int length = Math.Min(passwordBytes.Length, salt.Length);

        for (int i = 0; i < length; i++)
            salt[i] = passwordBytes[i];

        Rfc2898DeriveBytes key = new Rfc2898DeriveBytes(password, salt);

        _algorithm.Key = key.GetBytes(_algorithm.KeySize / 8);
        _algorithm.IV = key.GetBytes(_algorithm.BlockSize / 8);

    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T08:08:14.660

如果您担心磁盘 I/O，可以使用 MemoryStream。

但是，RSACryptoServiceProvider 类将对字节数组进行操作。此类使用 RSA 算法的实现来执行非对称加密和解密。

[此处](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rsacryptoserviceprovider.aspx)的示例显示了如何使用字节数组执行此操作

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T08:08:09.777

好吧，您*可以*编写自己的加密算法 - 但使用内置的流 API 写入 a[`MemoryStream`](http://msdn.microsoft.com/en-us/library/system.io.memorystream.aspx)然后使用[`ToArray`](http://msdn.microsoft.com/en-us/library/system.io.memorystream.toarray.aspx).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T09:01:56.230

使用 Microsoft 企业库的[Cryptography Application Block](http://msdn.microsoft.com/en-us/library/dd139964.aspx)可以做到这一点，但我同意其他人的观点，即不使用流并没有真正获得任何好处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T10:46:48.257

[http://www.obviex.com/samples/Code.aspx?Source=EncryptionCS&Title=Symmetric%20Key%20Encryption&Lang=C%23](http://www.obviex.com/samples/Code.aspx?Source=EncryptionCS&Title=Symmetric%20Key%20Encryption&Lang=C%23)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-03T08:41:22.630

使用块密码并自己实现。

但这几乎可以肯定是没有意义的，因为在字节数组上使用 MemoryStream 应该可以正常工作，并且会使用经过良好测试的实现。

当您谈论加密时，自己实现某些东西*通常*是一个坏主意。

# reporting-services - Data Dynamics Reports 是否适合我的需求？

> ID：605507
> 
> 赞同：2
> 
> 时间：2009-03-03T08:07:17.407
> 
> 标签：reporting-services, activereports, componentone

我们目前使用[ActiveReports](http://www.datadynamics.com/Products/ProductOverview.aspx?Product=ARNET3)（由 Data Dynamics，现为 Grape City）制作罐装报告，但正在考虑升级到他们的[Reports](http://www.datadynamics.com/Products/DDRPT/default.aspx)包。如果您使用过它，我很想听听您的看法：

*   性能 - 您是否认为它可以很好地扩展基于 Web 的应用程序（特别是与 ActiveReports 相比）
*   导出到 Excel - 它似乎提供了一个更干净的 Excel 导出（ActiveReports 的 Excel 导出很糟糕，我们考虑切换的最大原因）
*   其他优点/缺点（我的公司很小，2 个许可证的 3,000 美元对我们来说很多）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T00:28:03.167

以下是有关 ActiveReports 和数据动态报告的一些附加信息供您考虑：

**ActiveReports 许可：**

每个开发人员都有许可证。没有版税。您可以编写任意数量的应用程序，并将您的应用程序部署到任意数量的用户或服务器，而无需任何额外费用。在此处阅读[ActiveReports 许可协议](http://www.datadynamics.com/Products/ProductLicenseAgreement.aspx?Product=ARNET3)。

**向 Excel 报告：**

首先，schooner 是绝对正确的，所有其他报告工具在导出到 excel 时的情况都很糟糕。经过多年的 ActiveReports 经验，我们认识到了这一点。坦率地说，将设计为在 Web 上进行分页或部署的报告放入基于单元格的电子表格布局中是一个非常困难的问题。

但是，对于 Data Dynamics Reports，我们采用了完全不同的方法。我们不是创建另一个“导出到 Excel”，在其中我们查看“分页”报告输出并尝试以某种方式将其放入电子表格中，而是基于两件事生成 excel 输出：模板和报告中的实际数据。通过使用一个模板，它实际上是一个特殊格式的 Excel 表（单元格中有一些特殊的占位符），报告引擎可以将报告的内容输出到一个 Excel 表，完全独立于分页时报告的布局方式。我们将此概念称为 Excel 的“转换扩展”，因为它获取报告的内容并基于模板将其转换为 Excel。

默认情况下，DDReports 将生成一个默认模板，您会发现它通常具有非常好的输出。但是，如果 excel 输出不是您想要的，您可以指示 DDReports 保存模板，以便您可以在 excel 中自定义输出。

了解此内容的最佳方式是[在此处观看 Data Dynamics Reports 中的 Excel 转换扩展的截屏视频](http://www.datadynamics.com/Products/DDRPT/ScreencastViewer.aspx?ID=XLS01)。如果您不耐烦并查看一个简单模板的示例，请跳到截屏视频中的 1:20 左右。请记住，这是一个非常简单的模板，而且可能性要复杂得多。不幸的是，到目前为止，我们还没有发布关于使用 excel 转换扩展模板语法的非常好的文档，但是如果您有任何问题，请告诉我，我会为您提供帮助！只需对此帖子发表评论或向我们的支持团队发送电子邮件即可。

斯科特·威勒克

数据动态 / GrapeCity

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-08-05T14:11:06.947

我用过它，它摇滚！它有一个报表设计器控件，允许您的用户动态构建自己的报表，并支持在单个报表中使用的多个数据源。市场上最好的报告工具没有。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-25T13:46:30.370

我们使用这两种产品，它们彼此完全不同。我一直是 Active Reports 的长期用户，并且很喜欢它们。但是到了选择 .net 报告工具的时候，我们不想花一大笔钱，所以我们决定购买他们的 DDR 产品。我花了几个星期才习惯它，因为我一直在尝试像 Active Reports 一样使用它。不是一个好主意。无论如何，一旦你习惯了它，它就会做得很好。他们需要做一些事情来改进产品。以下是突出的事情。

1.  您无法访问代码区域中的控件集合。如果您想更改报表中的数据绑定等任何内容，这将是一个大问题。

2.  如果您在设计器中重新打开报表，则必须刷新数据库连接。这需要一段时间才能弄清楚，我们想知道为什么我们的字段在重新加载报告时不会显示在预览模式中。

3.  他们的新技术支持非常好。他们最近被买断了，现在当你打电话给技术支持时，你会遇到一个不知道总是告诉你有人会给你回电话的人。80% 的时间你没有回电。有 20% 的时间您会通过电子邮件收到与您的问题无关的样本。现在，这两种产品都适用于电路板。他们曾经有很好的技术支持。我希望他们能解决这个问题。

这些是主要问题，我知道他们正在努力解决这些问题。就像我说的，我们使用 boh DDR 和 Active Reports。如果您需要制作复杂的报告，请坚持使用 Active Reports。如果它们很简单并且您不想花很多钱，那么 DDR 就可以正常工作。我看到 DDR 在每个版本中都在变得更好，但需要一段时间才能解决问题。

只是我的观点

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T10:42:11.590

我也只使用过 ActiveReports，但在我看来，它们的网络许可模型一般来说有点贵，特别是如果您需要在多个服务器上开发多个应用程序。然后还有每个开发人员的成本。

我使用 DevXpress XtraReports 并且到目前为止对它非常满意，它具有一些相当不错的导出功能和更好的许可模型。

关于导出到 Excel，我没有看到任何报告工具做得很好，主要是由于报告本身的格式问题。我们通常做的是向用户提供格式化的报告，以及用于 Excel 导出的附加链接，这是与报告使用的原始数据类似但不同的查询。

格式化可打印报告的另一个选择是使用 Infragistics 等网格，它允许您进行排序、分组、摘要，并具有出色的 Excel 导出功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-09T05:18:36.920

这是为了向[比尔](https://stackoverflow.com/questions/605507/has-anyone-used-data-dynamics-reports/681658#681658)在此线程中的响应提供更多信息。我试图发表评论，但房间用完了:)

比尔 感谢您的诚实评估。对于你提到的问题，让我从内部给你一些意见：

1：诚然，访问控件集合不像使用 AR 那样直观，但你/可以/做到。您需要在报告之外执行此操作（而不是在嵌入到报告中的脚本/代码中）。为此，您可以在 ReportDefinition 对象中加载 rdlx 文件。例如：

```
var rpt = new DataDynamics.Reports.ReportDefinition(new FileInfo("myfile...rdlx"));
var list = (DataDynamics.Reports.ReportObjectModel.List)rpt.Report.Body.ReportItems["myList"];
var txt = (DataDynamics.Reports.ReportObjectModel.TextBox)list.ReportItems["myTextBox"];
txt.Value = "=Fields!MyField.Value"; 
```

但是，根据您所追求的场景，可能有比更改控件/报告项本身的绑定更好的方法来处理此问题。如果不了解您的特定场景/目标，很难说更多。

2：最近我参与了一些关于如何在不久的将来改进这一点的讨论。开发团队正在收集用例并对各种缓存策略进行一些调查，以将设计人员中的数据库访问量降至最低。因此，在即将到来的构建中寻找这方面的改进。

3：不幸的是，我们正在与新的技术支持团队一起应对一些挑战。但是，我们在不断改进，我们正在努力尽快培养新人。如果您在支持的事件中遇到问题，请随时通过电子邮件向我发送您的案例编号，我将努力尝试升级您的案例或以任何方式提供帮助（grapecity dot com 的 scott dot willeke） .

再次感谢您的反馈，我的下一封信是基于您的反馈的内部信，以帮助我们改进！

```
Scott Willeke
Program Manager
Data Dynamics / GrapeCity inc. 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-09T12:57:25.987

我从 2004 年开始使用这个产品。性能很好，许可也很棒。从早期版本的迁移很棒。它有一些缺陷，例如在生产环境中高速大批量生产的幻影图像，并且缺少一些水晶和条形码问题所带来的好处。但这引擎很快。然后是第 7 版。真是一团糟！渲染 4 x 4 标签的时间从 320 毫秒缩短到 800 毫秒。尝试获取补丁...祝你好运。试着让某人打电话突然变得像中了彩票一样。如果性能不是一个因素，而您只需要简单的报告，那就去做吧。否则，请三思而后行。至于我们，如果我们的 QA 可以通过，这是最后一个版本。我们正在购买替代产品。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-24T15:58:27.363

它们很好，我不是想吓唬你，但在我看来，以下是事实：

优点

1.  活跃的社区……您可以期待一夜之间的回应。
2.  帮助您入门的好东西 - walkr-thrus、教程、示例、视频等
3.  内部构建 - 就像 Linux 内核补丁一样，您可以为他们的开发团队能够解决的问题获得“热修复”
4.  Web 报表查看器可用，也可以在 Visual Studio 中使用 - 就像其他报表工具一样。

缺点

1.  周渲染引擎 - 如果您在表格行中使用子报告，您不能指望它们会导出到 word/excel 没有任何问题。
2.  糟糕的错误修复 - 修复错误需要一年多的时间 - 自 2011 年 11 月 11 日以来，我一直在关注一个错误，但他们仍然一直说“我们会在修复此错误后立即通知您”
3.  不太主动发布稳定版本。- 发布下一个稳定版本需要一年的时间。
4.  对渲染的控制较低，如果您希望嵌入一些代码，您可能不会使用事件，但是是的，Data Dynamics 确实提供了 VB.net（而且只是 VB.net！）（[自定义代码](http://www.datadynamics.com/Help/ddReports/ddrwlkCustomCode.html)）支持，您可以将它用于验证错字的东西

我正在分享一些链接供您参考：

[论坛](http://www.datadynamics.com/ConvertCrystalReportsToActiveReports.aspx)| [如何分区](http://www.datadynamics.com/ConvertCrystalReportsToActiveReports.aspx)| [演练](http://www.datadynamics.com/Help/ddReports/webframe.html)| [有用的资源](http://www.datadynamics.com/Help/ddReports/webframe.html)| [钻孔](http://www.datadynamics.com/ConvertCrystalReportsToActiveReports.aspx)| [视频](http://www.datadynamics.com/Help/ddReports/webframe.html)| [转换 Crystal 报表](http://www.datadynamics.com/ConvertCrystalReportsToActiveReports.aspx)（记住：反之亦然是不可能的）| [在线帮助/文档 - 用户指南](http://www.datadynamics.com/Help/ddReports/webframe.html)| [网络报告查看器](http://www.datadynamics.com/Help/ddReports/ddrwlkWebReportViewer.html)

# c# - DataGridViewComboBoxColumn - 编辑项目

> ID：605514
> 
> 赞同：0
> 
> 时间：2009-03-03T08:09:33.003
> 
> 标签：c#, datagridview, datagridviewcombobox

我正在使用 DataGridView 并有一个 DataGridViewComboBox 类型的列，我偶然发现了一个问题。基本上，根据单元格的值，我想将 .Items 设置为一组特定的字符串，但是当值更改时，我想更改 .Items 列表。但是有了这个，我偶尔会从列表中删除一个当前被另一个 DataGridViewCell 占用的字符串，这会更改所有等于已删除项目的值，直到我将它重新添加回列表（在我完成之后编辑）。

所以基本上，我想知道是否有一种方法可以从组合框下拉列表中隐藏一些项目，以便在选择某个单元格时，他们无法选择不允许的项目。

谢谢，

劳埃德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T11:50:32.943

不是对整个列进行数据绑定，而是分别对每一行的 DataGridViewComboBoxCell 进行数据绑定。这样一来，您就不会让一行中的 .items 影响另一行中的 .items。

# svn - Git-Svn 是否存储 Svn 密码？

> ID：605519
> 
> 赞同：31
> 
> 时间：2009-03-03T08:15:46.653
> 
> 标签：svn, git-svn

我在几个工作项目中使用 git-svn，我注意到几乎每执行一个操作，都会提示我输入我的 Svn 密码。对于某些操作，我会收到多次提示（大概 b/c 在幕后进行了几个操作）。例如，在克隆存储库时，在克隆实际开始之前会提示我 5 次。

我直接使用 Svn 的项目不这样做。这是预期的吗？我可以做些什么来缓存我的凭据吗？

谢谢。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-17T13:27:36.853

我最终不得不一起删除 auth 目录并允许 Subversion 为我重建它。似乎没有其他任何工作。对于不知道的人，auth 目录位于 ~/.subversion (Mac/Linux) 中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-09-30T21:07:26.223

我在 Sierra 也遇到了类似的问题。`svn`使用存储的凭据工作正常，但`git svn`不会使用存储的凭据，并不断提示重新输入。

我的解决方案是删除钥匙串中存储的密钥，然后`git svn`在任何其他程序之前使用。如果`git svn`是程序将密码存储在钥匙串中，则权限设置正确。一旦`git svn`用于在钥匙串中创建条目，则`svn`可以正常使用，并允许访问由创建的密钥`git svn`，此时他们都将使用存储库而没有任何问题，并且不会一直提示我输入密码.

如果任何其他程序在钥匙串中设置密码，则该程序没有问题，但`git svn`不会被授予权限。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-10-04T22:41:10.797

也许是一个愚蠢的想法，但我发现`git-svn`即使在重置钥匙串条目后也会重新提示输入密码。所以我更改了该项目的访问控制，以便“所有应用程序”可以访问它。似乎工作？

[![钥匙串项访问控制](https://i.stack.imgur.com/xTpta.png)](https://i.stack.imgur.com/xTpta.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T08:36:40.863

您应该要求 SVN 缓存您的凭据：

```
# $ svn update --username 'user2' --password 'password'
# user1@domain.com's password: 
```

但是，正如 SO 问题[Subversion 忽略“--password”和“--username”选项](https://stackoverflow.com/questions/34687/subversion-ignoring-password-and-username-options)中提到的那样，检查到底是什么提示您输入密码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-19T19:03:18.380

我有一个类似的问题。最初，我在一个远程 centos 服务器上，试图抓取所有远程 svn 分支，将它们作为真正的 git 分支推送到一个干净的来源，以便通过以下方式从 svn 硬切换到 git：

```
for remote in `git branch -r` ; do git checkout $remote; git pull; done 
```

那里有大约 240 个远程分支。（我不可能为每个拉动输入密码）

我最终做的是将 repo 下载到我的本地机器（mac）并启用钥匙串来处理密码缓存。我将所有 svn 提交都拉到本地，然后将我的 repo 复制回远程机器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-16T12:06:19.590

在 OSX 上，如果您以前使用过 svn，看起来 svn 已经创建了一个密码条目（在 OSX 密钥环应用程序中）， git svn 不能使用也不能创建一个新的。症状是它每次都询问，并且 SourceTree 无法与 System git 一起使用（由于另一个原因，它也无法与内置 git 一起使用）。

我的解决方案是删除此条目，然后使用 git svn 一次，它将创建一个正确的条目。从那时起，SourceTree 也在工作。

[https://stackoverflow.com/a/55706141/580672](https://stackoverflow.com/a/55706141/580672)

# windows - 批处理文件中的打印时间（毫秒）

> ID：605522
> 
> 赞同：64
> 
> 时间：2009-03-03T08:16:57.837
> 
> 标签：windows, batch-file, time

如何在 Windows 批处理文件中打印时间（以毫秒为单位）？

我想测量批处理文件中各行之间传递的时间，但 Windows 的“时间/T”不打印毫秒。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-03-03T11:48:05.240

`%time%`应该可以工作，前提是两次通话之间已经过去了足够的时间：

```
@echo OFF

@echo %time%
ping -n 1 -w 1 127.0.0.1 1>nul
@echo %time% 
```

在我的系统上，我得到以下输出：

> 6:46:13.50
> 6:46:13.60

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-03-04T03:38:17.013

如果你正在做类似的事情

```
for /l %%i in (1,1,500) do @echo %time% 
```

或者

```
if foo (
    echo %time%
    do_something
    echo %time%
) 
```

那么您可以简单地将 a`setlocal enabledelayedexpansion`放在批处理文件的开头并使用它`!time!`而不是`%time%`在执行时评估，而不是在解析行时（包括括号中的完整块）。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2011-02-14T12:44:02.137

下面的批处理“程序”应该做你想要的。请注意，它以厘秒而不是毫秒为单位输出数据。所用命令的精度仅为厘秒。

这是一个示例输出：

```
STARTTIME: 13:42:52,25
ENDTIME: 13:42:56,51
STARTTIME: 4937225 centiseconds
ENDTIME: 4937651 centiseconds
DURATION: 426 in centiseconds
00:00:04,26 
```

这是批处理脚本：

```
@echo off
setlocal

rem The format of %TIME% is HH:MM:SS,CS for example 23:59:59,99
set STARTTIME=%TIME%

rem here begins the command you want to measure
dir /s > nul
rem here ends the command you want to measure

set ENDTIME=%TIME%

rem output as time
echo STARTTIME: %STARTTIME%
echo ENDTIME: %ENDTIME%

rem convert STARTTIME and ENDTIME to centiseconds
set /A STARTTIME=(1%STARTTIME:~0,2%-100)*360000 + (1%STARTTIME:~3,2%-100)*6000 + (1%STARTTIME:~6,2%-100)*100 + (1%STARTTIME:~9,2%-100)
set /A ENDTIME=(1%ENDTIME:~0,2%-100)*360000 + (1%ENDTIME:~3,2%-100)*6000 + (1%ENDTIME:~6,2%-100)*100 + (1%ENDTIME:~9,2%-100)

rem calculating the duratyion is easy
set /A DURATION=%ENDTIME%-%STARTTIME%

rem we might have measured the time inbetween days
if %ENDTIME% LSS %STARTTIME% set set /A DURATION=%STARTTIME%-%ENDTIME%

rem now break the centiseconds down to hors, minutes, seconds and the remaining centiseconds
set /A DURATIONH=%DURATION% / 360000
set /A DURATIONM=(%DURATION% - %DURATIONH%*360000) / 6000
set /A DURATIONS=(%DURATION% - %DURATIONH%*360000 - %DURATIONM%*6000) / 100
set /A DURATIONHS=(%DURATION% - %DURATIONH%*360000 - %DURATIONM%*6000 - %DURATIONS%*100)

rem some formatting
if %DURATIONH% LSS 10 set DURATIONH=0%DURATIONH%
if %DURATIONM% LSS 10 set DURATIONM=0%DURATIONM%
if %DURATIONS% LSS 10 set DURATIONS=0%DURATIONS%
if %DURATIONHS% LSS 10 set DURATIONHS=0%DURATIONHS%

rem outputing
echo STARTTIME: %STARTTIME% centiseconds
echo ENDTIME: %ENDTIME% centiseconds
echo DURATION: %DURATION% in centiseconds
echo %DURATIONH%:%DURATIONM%:%DURATIONS%,%DURATIONHS%

endlocal
goto :EOF 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-03T08:30:31.407

也许[这个工具](http://www.microsoft.com/DOWNLOADS/details.aspx?familyid=913795CD-7026-4143-AE85-1F5E096F9BE0&displaylang=en)（[存档版本](https://web.archive.org/web/20140830232632if_/http://download.microsoft.com/download/win2000platform/timethis/1.00.0.1/nt5/en-us/timethis_setup.exe)）可以提供帮助？它不会返回时间，但它是衡量命令所用时间的好工具。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-10-10T12:11:07.430

在 CMD 中计时任务很简单

```
echo %TIME% && your_command && cmd /v:on /c echo !TIME! 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-02-20T08:37:35.177

> %TIME% 在午夜后采用 H:MM:SS,CS 格式，因此转换为厘秒 > 不起作用。早上 6 点 46 分看到 Patrick Cuff 的帖子，似乎不仅仅是我。

但是有了这条线，你应该很容易解决这个问题：

```
if " "=="%StartZeit:~0,1%" set StartZeit=0%StartZeit:~-10%
if " "=="%EndZeit:~0,1%" set EndZeit=0%EndZeit:~-10% 
```

谢谢你的好灵感！我喜欢在我的 mplayer、ffmpeg、sox 脚本中使用它来为旧的 PocketPlayers 拉皮条我的媒体文件，只是为了好玩。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-12-03T12:49:23.057

你必须小心你想做的事情，因为它不仅仅是为了得到时间。

该批次具有表示日期和时间的内部变量：*%DATE% %TIME%*。但它们依赖于 Windows 语言环境。

*%日期%*：

*   dd.MM.yyyy
*   dd.MM.yy
*   dMyy
*   日/月/年
*   yyyy-MM-dd

*%TIME%*：

*   H:mm:ss,毫秒
*   HH:mm:ss,毫秒

现在，您的脚本将运行多长时间以及何时运行？例如，如果它超过一天并且确实过了午夜它肯定会出错，因为午夜之间的 2 个时间戳之间的差异是负值！您需要日期来找出正确的日期之间的距离，但是如果日期格式不是常数，您如何做到这一点？如果您继续将它们用于数学目的，则具有*%DATE%*和*%TIME%的事情可能会变得越来越糟。*

原因是存在*%DATE%*和*%TIME%*只是为了在输出中向用户显示日期和时间，而不是用于计算。因此，如果您想在某些时间值之间建立正确的距离或根据日期和时间生成一些唯一值，那么您必须使用与*%DATE%*和*%TIME%*不同且准确的东西。

我正在使用 wmic windows 内置实用程序来请求这些东西（将其放在脚本文件中）：

```
for /F "usebackq tokens=1,2 delims==" %%i in (`wmic os get LocalDateTime /VALUE`) do if "%%i" == "LocalDateTime" echo.%%j 
```

或在 cmd.exe 控制台中键入：

```
for /F "usebackq tokens=1,2 delims==" %i in (`wmic os get LocalDateTime /VALUE`) do @if "%i" == "LocalDateTime" echo.%j 
```

这样做的缺点是在频繁调用的情况下性能较慢。在我的机器上，每秒大约有 12 个调用。

如果你想继续使用它，那么你可以写这样的东西（*get_datetime.bat*）：

```
@echo off

rem Description:
rem   Independent to Windows locale date/time request.

rem Drop last error level
cd .

rem drop return value
set "RETURN_VALUE="

for /F "usebackq tokens=1,2 delims==" %%i in (`wmic os get LocalDateTime /VALUE 2^>NUL`) do if "%%i" == "LocalDateTime" set "RETURN_VALUE=%%j"

if not "%RETURN_VALUE%" == "" (
  set "RETURN_VALUE=%RETURN_VALUE:~0,18%"
  exit /b 0
)

exit /b 1 
```

现在，您可以在脚本中的某处解析*%RETURN_VALUE% ：*

```
call get_datetime.bat
set "FILE_SUFFIX=%RETURN_VALUE:.=_%"
set "FILE_SUFFIX=%FILE_SUFFIX:~8,2%_%FILE_SUFFIX:~10,2%_%FILE_SUFFIX:~12,6%"
echo.%FILE_SUFFIX% 
```

# rhino-mocks - Rhino Mocks - Ctor 测试中的私有属性

> ID：605526
> 
> 赞同：1
> 
> 时间：2009-03-03T08:19:27.160
> 
> 标签：rhino-mocks, rhino

我有一个非常简单的问题，我是 rhino 新手，这是我的课：我想用 Expect.SetPropertyWithArgument 测试属性

谁能告诉我怎么做，因为我试过但它不起作用..

```
public class person
{    

    public string Name {get;private set;}

    public person(string name)
    {
        Name = name;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T08:29:21.253

关键`Expect.SetPropertyWithArguments`是在模拟对象上设置了一个属性，而不是在*被测*对象上。我还要指出，您显示的代码根本没有设置属性 - 它正在设置一个*字段*。

# .net - 如何在配置文件中指定程序集的确切位置

> ID：605527
> 
> 赞同：6
> 
> 时间：2009-03-03T08:19:57.797
> 
> 标签：.net, asp.net, configuration

我有一个 Web 应用程序和一个相应的 web.config。应用程序依赖于程序集，这些程序集位于系统中特定路径（例如 c:\programms\myprog\bla.dll）中，但未在 GAC 中注册。如何告诉我的 Web 应用程序在哪里可以找到它所依赖的这些程序集？我想我可以在 web.config 的某个地方做到这一点。但是怎么做？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T08:32:58.173

检查这篇关于[程序集绑定重定向](http://msdn.microsoft.com/en-us/library/2fc472t2(vs.71).aspx)的文章。

基本上你应该把它添加到你的配置文件中：

```
<runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1" appliesTo="v1.0.3705">
            <dependentAssembly> 
               * assembly information goes here *
            </dependentAssembly>
       </assemblyBinding>
</runtime> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T08:47:05.097

您应该使用[http://msdn.microsoft.com/en-us/library/efs781xb(VS.71).aspx](http://msdn.microsoft.com/en-us/library/efs781xb(VS.71).aspx)中给出的代码库元素，即使文章说 href，它也可以用于本地路径

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T13:36:09.147

为什么将组件存储在 1 个特定位置？出于调试目的？您还可以添加提示路径以进行调试。向它添加一个文件 ref 并使其复制 local = true。程序集查找将首先在 debug\bin 文件夹（应用程序库）中进行本地查找。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-05T15:32:24.877

只要有可能，始终将您的程序集存储在 GAC 中。它的行为就像您现在使用的单个目录，并具有并行部署的额外优势！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T08:37:12.763

用于注册自定义控件和用户控件：

```
<system.web>
    <pages>
      <controls>
        <add assembly="WebApp.CustomControl"
                namespace="WebApp.CustomControls"
                tagPrefix="cc" />
      </controls>
    </pages>
</system.web> 
```

对于注册程序集：

```
<assemblies>
  <add assembly="WebApp.Util, Version=1.0, Culture=neutral, PublicKeyToken=f573aa5672ce4fd2"/>
</assemblies> 
```

希望这可以帮助 ！

# c# - 为 OleDbDataAdapter 编写自定义插入/更新命令

> ID：605529
> 
> 赞同：0
> 
> 时间：2009-03-03T08:20:42.430
> 
> 标签：c#, sql, dataset, oledb, insert-update

我正在使用 OleDbDataAdapter 填充数据集中的表。问题是 select sql 语句非常复杂（使用左连接从众多表中获取数据）并且 OleDbCommandBuilder 无法为我编写插入/更新语句。

我想知道这里最好的做法是什么？没有多少列可以更改数据（仅需要 30 列中的 6-8 列左右），但重要的是我可以尽可能简单地执行 OleDbDataAdapter.Update（速度和资源使用非常重要）。

有没有人有这样做的经验？这里最好/推荐的行动方案是什么？

谢谢您的意见！

编辑：我还可以在为 OleDbDataAdapter 编写更新语句时使用一些帮助，尤其是在涉及多表更新时。如果有人能指点我一些文学作品，那就太好了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-09T17:19:19.170

在这种情况下，我建议您手动编写 SQL。

# iphone - 如何在 iPhone 上放大选取器视图？

> ID：605532
> 
> 赞同：0
> 
> 时间：2009-03-03T08:21:07.000
> 
> 标签：iphone, objective-c, user-interface, resize, uipickerview

我在应用程序中的一个视图中添加了一个 PickerView，但它的尺寸太小（高度）。我发现我无法拖动以使其“更长”。那么如何改变它的大小呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T14:42:04.447

唯一的方法是调整pickerView.frame.size.height，但是你会得到一些非常糟糕的视觉伪影。

我会长期努力地试图规避这种控制的既定设计。如果你有这么多项目或者你的项目对于这个视图来说太大了，那么 UITableView 可能就是你想要的。它的可定制性更高，可以处理所有不同形状和大小的项目/单元格。

# c++ - 在 std::floor 之后转换为 int 可以保证正确的结果吗？

> ID：605533
> 
> 赞同：50
> 
> 时间：2009-03-03T08:21:21.803
> 
> 标签：c++, math, floor

我想要一个`floor`具有语法的函数

```
int floor(double x); 
```

但`std::floor`返回一个`double`. 是

```
static_cast <int> (std::floor(x)); 
```

保证给我正确的整数，还是我有一个不合一的问题？它似乎有效，但我想确定。

对于奖励积分，为什么首先`std::floor`返回 a`double`呢？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-03T08:26:42.027

double 的范围远大于 32 或 64 位整数的范围，这就是`std::floor`返回 a 的原因`double`。`int`只要它在适当的范围内，转换为就应该没问题 - 但请注意，a`double`不能准确地表示所有 64 位整数，因此当您超出精确度的点时，您也可能会出现`double`错误连续两次双打之差大于1。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-03T08:27:07.173

```
static_cast <int> (std::floor(x)); 
```

几乎可以满足您的需求，是的。它为您提供最接近的整数，向 -infinity 四舍五入。至少只要您的输入在整数可表示的范围内。我不确定'添加 .5 之类的东西是什么意思，但它不会产生相同的效果

std::floor 返回一个双精度值，因为这是最通用的。有时您可能希望对浮点数或双精度数进行四舍五入，但保留类型。也就是说，将 1.3f 舍入到 1.0f，而不是 1。

如果 std::floor 返回一个 int，那将很难做到。（或者至少你会有额外的不必要的演员在那里减慢速度）。

如果 floor 仅执行舍入本身，而不更改类型，则可以在需要时将其转换为 int 。

另一个原因是双精度数的范围远大于整数。可能无法将所有双精度数舍入为整数。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-26T12:37:49.820

C++ 标准说（4.9.1）：

“浮点类型的右值可以转换为整数类型的右值。转换截断；也就是说，小数部分被丢弃。如果截断的值不能在目标类型中表示，则行为未定义”。

因此，如果要将 double 转换为 int，则该数字在 int 范围内，并且所需的向上舍入为零，那么只需将数字转换为 int 就足够了：

(int)x;

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-03T08:33:48.200

如果您想处理各种数字条件并希望以受控方式处理不同类型的转换，那么也许您应该查看[Boost.NumericConversion](http://www.boost.org/doc/libs/1_38_0/libs/numeric/conversion/doc/html/index.html)。这个库允许处理奇怪的情况（如超出范围、舍入、范围等）

这是文档中的示例：

```
#include <cassert>
#include <boost/numeric/conversion/converter.hpp>

int main() {

    typedef boost::numeric::converter<int,double> Double2Int ;

    int x = Double2Int::convert(2.0);
    assert ( x == 2 );

    int y = Double2Int()(3.14); // As a function object.
    assert ( y == 3 ) ; // The default rounding is trunc.

    try
    {
        double m = boost::numeric::bounds<double>::highest();
        int z = Double2Int::convert(m); // By default throws positive_overflow()
    }
    catch ( boost::numeric::positive_overflow const& )
    {
    }

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-03T08:37:53.090

大多数标准数学库使用双精度，但也提供浮点版本。如果您不想使用双精度数，则 std::floorf() 是 std::floor() 的单精度版本。

编辑：我已经删除了我之前答案的一部分。我曾说过在转换为 int 时地板是多余的，但我忘记了这仅适用于正浮点数。

# c++ - 扩展作为内存传递的向量的大小

> ID：605539
> 
> 赞同：2
> 
> 时间：2009-03-03T08:23:47.727
> 
> 标签：c++, stl, vector

我将我的向量传递给一个需要 ac 数组的函数。它返回它填充的数据量（类似于 fread）。有没有办法告诉我的向量改变它的大小以包含函数传入的数量？

当然，我确保向量有容量（）来保存这么多数据。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T08:33:51.993

不，没有支持“扩展”向量的方法，因此它包含已直接复制的额外值。依靠“容量”分配您可以写入的非大小内存绝对不是您应该依赖的东西。

您应该在调用函数之前调整大小，然后再调整为正确的值，以确保您的向量具有所需的空间量。例如

```
vector.resize(MAX_SIZE);
size_t items = write_array(&(vec[0]), MAX_SIZE)
vector.resize(items); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T08:29:02.160

`capacity`仅告诉您保留了多少内存，而不是向量的大小。

您应该首先将大小调整为所需的最大大小：

```
vec.resize(maxSizePossible);
size_t len = cfunc(&(vec[0]));
vec.resize(len); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T08:28:57.357

嗯..
`vector.resize(size);`
?

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T08:30:03.407

std::vector 有一个以新大小作为参数的 resize() 方法。因此，只需使用函数返回的数字调用它就可以了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T08:45:29.390

`std::back_inserter`可能是你需要的。假设您的输入函数能够使用迭代器，请将它传递给`std::back_inserter(myvector)`. 这会将`push_back`所有内容写入迭代器，并根据需要隐式调整向量的大小。

# php - PHP 解析错误

> ID：605540
> 
> 赞同：0
> 
> 时间：2009-03-03T08:24:26.307
> 
> 标签：php

```
<?php
$this_is_my_array = array("John","Johan");
for(int i = 5; i < 5; i++){
echo "$this_is_my_array[i] ";
}
//Adding name Markus
array_push($this_is_my_array,"Markus");
for(int i = 5; i < 5; i++){
echo "$this_is_my_array[i] ";
}
//Removing name from array
$this_is_my_array2= array_pop($this_is_my_array);
for(int i = 5; i < 5; i++) {
echo "$this_is_my_array2[i] ";
} 
```

我只是在玩/学习 php，但这段代码给了我错误。

```
PHP Parse error: parse error, expecting ';' in C:\main.php php on line 3 
```

我怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T08:26:48.733

对于初学者，您的变量 i 应该是 $i，带有美元符号。这是你的大部分错误。但还有一些其他问题。尝试这个。

```
echo("start");

$this_is_my_array = array("John","Johan");
for($i = 5; $i < 5; $i++){
    echo $this_is_my_array[$i];
}

//Adding name Markus
array_push($this_is_my_array,"Markus");
for($i = 5; $i < 5; $i++){
echo "$this_is_my_array[$i] ";
}
//Removing name from array
$this_is_my_array2= array_pop($this_is_my_array);
for($i = 5; $i < 5; $i++) {
echo "$this_is_my_array2[$i] ";
}

echo "end"; 
```

但是看看你的 for 循环，它说

$i = 5

当 $i 小于 5 时，做一些事情

但是 $i 已经是 5。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T08:27:42.490

变量 i 应该是 $i。输出数组时丢失引号，不需要。

做这个：

```
for($i = 5; $i < 5; $i++) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T08:27:50.680

```
for(int i = 5; i < 5; i++){ 
```

应该

```
for($i = 5; $i < 5; $i++){ 
```

您正在混合 C 风格的语法。变量应*始终*以 $ 开头

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T09:57:58.873

你的循环永远不会*循环*，因为**$i**总是**5**。

试试这个以获得一些结果：

```
<?php
$this_is_my_array = array("John","Johan");
for($i = 1; $i < 5; $i++){
echo $this_is_my_array[$i] ;
}
//Adding name Markus
array_push($this_is_my_array,"Markus");
for($i = 1; $i < 5; $i++){
echo $this_is_my_array[i];
}
//Removing name from array
$this_is_my_array2= array_pop($this_is_my_array);
for($i = 1; $i < 5; $i++) {
echo $this_is_my_array2[i] ;
}
?> 
```

# long-integer - 在没有 long long 的系统中乘以 23 位数据类型

> ID：605550
> 
> 赞同：0
> 
> 时间：2009-03-03T08:28:45.593
> 
> 标签：long-integer, multiplication

我正在尝试在微控制器中实现浮点运算，到目前为止我已经取得了很大的成功。

问题在于我在计算机中进行乘法运算的方式，它工作正常：

```
unsigned long long gig,mm1,mm2;
unsigned long m,m1,m2;
mm1 = f1.float_parts.mantissa;
mm2 = f2.float_parts.mantissa;

m1 = f1.float_parts.mantissa;
m2 = f2.float_parts.mantissa;

gig = mm1*mm2; //this works fine I get all the bits I need since they are all long long, but won't work in the mcu

gig = m1*m2//this does not work, to be precise it gives only the 32 least significant bits , but works on the mcu 
```

所以你可以看到我的问题是，`__muldi3`如果我在`gig = mm1*mm2`那里尝试，微控制器会抛出一个未定义的引用。

如果我尝试使用较小的数据类型，它只会保留最低有效位，这是我不希望的。我需要产品的 23 msb 位。

有没有人对我如何做到这一点有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T09:01:12.940

为简短的回答道歉，我希望其他人会花时间写一个更完整的解释，但基本上你做的完全就像你在纸上用手乘两个大数字一样！只是不是使用基数 10，而是使用基数 256。也就是说，将您的数字视为字节向量，并使用每个字节来处理“手动乘法”时对数字所做的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T02:31:55.833

__muldi3() 的 FreeBSD 实现中的注释很好地解释了所需的过程，请参阅[muldi3.c](http://fxr.watson.org/fxr/source/libkern/muldi3.c?v=DFBSD)。如果您想直接查看源代码（总是一个好主意！），根据评论，此代码基于 Knuth 的[计算机编程艺术](https://rads.stackoverflow.com/amzn/click/com/0201896842)卷中描述的算法。2（第 2 版），第 4.3.3 节，第 278.（注意链接是第三版的。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T09:08:18.430

回到 Intel 8088（最初的 PC CPU 和我为其编写汇编代码的最后一个 CPU），当您将两个 16 位数字（32 位？哇哦）相乘时，CPU 将在两个不同的寄存器中返回 2 个 16 位数字 - 一个与 16 msb 和 lsb 之一。

你应该检查你的微控制器的硬件功能，也许它有类似的设置（如果有的话，你显然需要汇编代码）。

否则，您将不得不自己实现乘法。

# c# - 代码错误：加载 XML 文档

> ID：605566
> 
> 赞同：-1
> 
> 时间：2009-03-03T08:36:13.377
> 
> 标签：c#, xml, winforms

这是指之前提出的一个问题。这是完整的代码，它给了我一个错误：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Xml;
using System.Text;
using System.Windows.Forms;
using System.Collections;
using System.IO;

namespace LoadXMLtreeDisplay
{
    public partial class TreeDisplay : Form
    {
        public string Filename
        {
            get { return filename; }
        }
        protected string filename;
        public TreeDisplay()
        {
            InitializeComponent();
            this.Text = "Tree View of XML File";//Form Title.
        }
       private void treeDocLoadMethod(string nameofFile)
        {
                XmlDocument xdoc = new XmlDocument();
                xdoc.Load(nameofFile);
                this.treeView1.Nodes.Clear();
                this.treeView1.Nodes.Add(new TreeNode(xdoc.DocumentElement.Name));
                TreeNode tNodeObj = new TreeNode();
                tNodeObj = this.treeView1.Nodes[0];
                XmlNode xNode = xdoc.DocumentElement;
                AddingNodesToTree(tNodeObj, xNode);
                treeView1.Nodes[0].Expand();
                treeView1.CollapseAll();
        }//treeDocLoadMethod

        private void AddingNodesToTree(refXmlNode xnode,TreeNode tnode)
        {

            TreeNode subNode = tnode.Add(xnode.Name);
            subNode.Tag = xnode;
            foreach (XmlNode subElement in xnode.ChildNodes)
            {
                AddingNodesToTree(ref subElement, ref subNode);
            }       

        } 
        private void treeView1_AfterSelect(object sender, System.Windows.Forms.TreeViewEventArgs e)
        { listBox1.Items.Clear();
            TreeNode currentNode = e.Node;
            XmlElement currentElement = (XmlElement)currentNode.Tag;
            XmlAttributeCollection attCol = currentElement.Attributes;
            foreach (XmlAttribute xmlatt in attCol)
            {
                listBox1.Items.Show(xmlatt);
            }
         }

//Rest of the code is for winform display(various buttons and boxes)
     }
} 
```

编译后我收到错误：

> 预期的类、委托、枚举、接口或结构类型或命名空间定义，或预期的文件结尾

请你能告诉我可能的错误来源是什么以及如何纠正它？我是 C# 的新手

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T08:38:40.233

第一行缺少一个空格；应该是“ref XmlNode”而不是“refXmlNode”

编辑：不是第一行（不再）；但上面写着：

```
private void AddingNodesToTree(refXmlNode xnode,TreeNode tnode) 
```

# c# - Web 服务强制转换异常为什么？

> ID：605570
> 
> 赞同：1
> 
> 时间：2009-03-03T08:37:21.237
> 
> 标签：c#, .net, web-services, exception, serialization

```
Error Cannot implicitly convert type 'string[]' to 'System.Collections.Generic.List<string>' 
```

上述错误是我调用 Web 服务的方法时引起的

```
List<string> bob = myService.GetAllList(); 
```

其中：GetAllList =

```
[WebMethod]
        public List<string> GetAllList()
        {

            List<string> list ....
            return list;
        } 
```

我已经重建了整个解决方案，更新了服务引用，但我仍然得到一个转换异常有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T08:39:21.200

你需要这样做：

```
List<string> bob = new List<string>(myService.GetAllList()); 
```

泛型列表的构造函数的重载采用指定类型的 IEnumerable 来初始化数组。您不能像异常状态一样将其隐式转换为该类型。

安德鲁

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T08:39:58.593

SOAP 协议不支持泛型集合。

试试这个：

```
List<string> bob = new List<string>(myService.GetAllList()); 
```

# javascript - 在 JavaScript 中从当前日期获取上个月的第一个日期

> ID：605575
> 
> 赞同：57
> 
> 时间：2009-03-03T08:39:10.060
> 
> 标签：javascript

请任何人分享代码以在 JavaScript 中从当前日期查找上个月的第一个日期。例如，如果当前日期是 2009 年 1 月 25 日，我应该得到 2008 年 12 月 1 日作为结果。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-03-03T08:54:50.070

很简单，使用[日期方法](http://www.w3schools.com/jsref/jsref_obj_date.asp)：

```
 var x = new Date();
  x.setDate(1);
  x.setMonth(x.getMonth()-1); 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2018-04-30T10:05:32.610

最简单的方法是：

```
var x = new Date();
x.setDate(0); // 0 will result in the last day of the previous month
x.setDate(1); // 1 will result in the first day of the month 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-02-17T20:09:53.927

处理从一月到十二月的更新年份

```
var prevMonth = function(dateObj) {
	var tempDateObj = new Date(dateObj);

	if(tempDateObj.getMonth) {
		tempDateObj.setMonth(tempDateObj.getMonth() - 1);
	} else {
		tempDateObj.setYear(tempDateObj.getYear() - 1);
		tempDateObj.setMonth(12);
	}

	return tempDateObj
};

var wrapper = document.getElementById('wrapper');

for(var i = 0; i < 12; i++) {
	var x = new Date();
  var prevDate = prevMonth(x.setMonth(i));
	var div = document.createElement('div');
  div.textContent = 
  "start month/year: " + i + "/" + x.getFullYear() +
  " --- prev month/year: " + prevDate.getMonth() +
  "/" + prevDate.getFullYear() +
  " --- locale prev date: " + prevDate.toLocaleDateString();
  wrapper.appendChild(div);
}
```

```
<div id='wrapper'>
</div>
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-03T08:44:28.143

检查此链接：

[http://blog.dansnetwork.com/2008/09/18/javascript-date-object-adding-and-subtracting-months/](http://blog.dansnetwork.com/2008/09/18/javascript-date-object-adding-and-subtracting-months/)

编辑：我举了一个例子：

```
Date.prototype.SubtractMonth = function(numberOfMonths) {
var d = this;
d.setMonth(d.getMonth() - numberOfMonths);
d.setDate(1);
return d;
}

$(document).ready(function() {
    var d = new Date();
    alert(d.SubtractMonth(1));
}); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-09-18T14:15:49.210

**重要提示：这里使用的一些答案`setMonth()`是错误的**：

2019 年使用的一种内衬（使用 ES6 语法；所有主要浏览器和 Node 都支持）：

```
 const date = new Date().toISOString(); // "2019-09-18T13:49:12.775Z"
    const [yyyy, mm, dd, h, i, s] = date.split(/T|:|-/);

    // previous month's last day
    const prev = new Date(new Date().setDate(0)).toISOString();
    const [pyyyy, pmm] = prev.split(/T|:|-/); 
```

请注意，数组解构允许您跳过部分：

```
 const date = new Date().toISOString();
    const [, , dd, , i] = date.split(/T|:|-/); 
```

**说明**：上面的代码获取 ISO 日期`2019-09-18T13:49:12.775Z`并将其拆分为`:`or`-`或`T`返回一个数组`[2019, 09, 18, 13, 49, 12]`，然后该数组被[解构](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)。

## 使用`setMonth()`错误：

```
date = new Date("Dec 31, 2019")
date.setMonth(date.getMonth() - 1);
date; // Dec 1, 2019! 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-07-31T21:19:56.673

这对我有用

```
var curDateMonth = new Date();
var prvDateMonth = new Date(curDateMonth.getFullYear(),curDateMonth.getMonth()-1,curDateMonth.getMonth());
console.log(curDateMonth.toLocaleString('en-US', { month: 'long' }) +' vs '+ prvDateMonth.toLocaleString('en-US', { month: 'long' })); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-12-19T09:52:55.390

要获得上个月的上午 00:00:00，请使用以下命令：

```
let d = new Date();
d.setDate(1);
d.setMonth(d.getMonth() - 1);
d.setHours(0,0,0,0);
const lastMonthStart = new Date(d); 
```

希望这可以帮助！！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-02-13T08:53:27.910

```
//  Previous Month Detail
let prevStartDate = new Date(this.date.getFullYear(), this.date.getMonth() - 1, 1);
console.log(prevStartDate);
let preEndDate = new Date(this.date.getFullYear(), this.date.getMonth() - 1 + 1, 0);
console.log(preEndDate);
//Current Month Detail
let cStartDate = new Date(this.date.getFullYear(), this.date.getMonth(), 1);
console.log(cStartDate);
let cEndDate = new Date(this.date.getFullYear(), this.date.getMonth(), 1, 0);
console.log(cEndDate);
//Next Month Detail
let nStartDate = new Date(this.date.getFullYear(), this.date.getMonth() + 1, 1);
console.log(nStartDate);
let nendDate = new Date(this.date.getFullYear(), this.date.getMonth() + 1 + 1, 0);
console.log(nendDate); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-12-09T12:23:42.827

//试试这个就可以了

```
let date = new Date();
let month = new Date().getMonth();
let prevMonth = date.setMonth(month - 1)
let formatPrevMonth = new Date(date.setMonth(month - 1));

console.log(formatPrevMonth) 
```

# php - 我需要从 javascript 中删除某个会话变量

> ID：605576
> 
> 赞同：1
> 
> 时间：2009-03-03T08:39:21.183
> 
> 标签：php, javascript, ajax

我需要从 javascript 函数中删除某个会话变量，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T08:51:13.743

我不认为这是可能的。会话存在于服务器上（我知道严格来说不是真的，但就这个答案而言，它是真的）。

我会编写一个脚本（PHP 或类似的）来取消设置会话变量并触发对它的 ajax 调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T08:51:33.010

您需要使用对服务器的 Ajax 调用来访问/删除会话变量，因为会话仅在服务器端而不是客户端进行控制/处理。

# delphi - Indy 写缓冲 / 高效 TCP 通信

> ID：605580
> 
> 赞同：8
> 
> 时间：2009-03-03T08:40:12.367
> 
> 标签：delphi, tcp, performance, client-server, indy

我知道，我问了很多问题……但作为一个新的 delphi 开发人员，我一直在思考所有这些问题 :)

这个处理使用 indy 10 的 TCP 通信。为了提高通信效率，我将客户端操作请求编码为单个字节（在大多数情况下，当然后面是其他数据字节，但在这种情况下只有一个单个字节）。问题是

```
var Bytes : TBytes;
...
SetLength (Bytes, 1);
Bytes [0] := OpCode;
FConnection.IOHandler.Write (Bytes, 1);
ErrorCode := Connection.IOHandler.ReadByte; 
```

不会立即发送该字节（至少不调用服务器执行处理程序）。例如，如果我将“1”更改为“9”，一切正常。我假设 Indy 缓冲传出字节并尝试禁用写缓冲

```
FConnection.IOHandler.WriteBufferClose; 
```

但它没有帮助。如何发送单个字节并确保立即发送？而且 - 我在这里添加另一个小问题 - 使用 indy 发送整数的最佳方式是什么？不幸的是，我在 TIdTCPServer 的 IOHandler 中找不到像 WriteInteger 这样的函数......和

```
WriteLn (IntToStr (SomeIntVal)) 
```

对我来说似乎不是很有效率。我是连续使用多个写命令还是将内容打包在一个字节数组中并发送一次，这有什么不同吗？

感谢您的任何回答！

编辑：我添加了一个提示，我正在使用 Indy 10，因为关于读写过程似乎有重大变化。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-04T03:38:53.707

默认情况下禁用写缓冲。您可以通过测试 fConnection.IOHandler.WriteBufferingActive 属性来检查写入缓冲以查看它是否在您的代码中处于活动状态。

至于发送整数的最佳方式……“这取决于”您的协议和总体目标。具体来说，使用 FConnection.IOHandler.Write() 因为有重载方法可以写入几乎任何类型的数据，包括整数。

取自 IdIOHandler：

```
// Optimal Extra Methods
//
// These methods are based on the core methods. While they can be
// overridden, they are so simple that it is rare a more optimal method can
// be implemented. Because of this they are not overrideable.
//
//
// Write Methods
//
// Only the ones that have a hope of being better optimized in descendants
// have been marked virtual
procedure Write(const AOut: string; const AEncoding: TIdEncoding = enDefault); overload; virtual;
procedure WriteLn(const AEncoding: TIdEncoding = enDefault); overload;
procedure WriteLn(const AOut: string; const AEncoding: TIdEncoding = enDefault); overload; virtual;
procedure WriteLnRFC(const AOut: string = ''; const AEncoding: TIdEncoding = enDefault); virtual;
procedure Write(AValue: TStrings; AWriteLinesCount: Boolean = False; const AEncoding: TIdEncoding = enDefault); overload; virtual;
procedure Write(AValue: Byte); overload;
procedure Write(AValue: Char; const AEncoding: TIdEncoding = enDefault); overload;
procedure Write(AValue: LongWord; AConvert: Boolean = True); overload;
procedure Write(AValue: LongInt; AConvert: Boolean = True); overload;
procedure Write(AValue: SmallInt; AConvert: Boolean = True); overload;
procedure Write(AValue: Int64; AConvert: Boolean = True); overload;
procedure Write(AStream: TStream; ASize: Int64 = 0; AWriteByteCount: Boolean = False); overload; virtual; 
```

您遇到的另一个问题是“我是连续使用多个写入命令还是将内容打包在一个字节数组中并发送一次，这有什么不同吗？” 在大多数情况下，是的，它会有所作为。对于压力很大的服务器，您将不得不更多地参与字节如何来回发送，但在这个级别，您应该将您的发送抽象为一个单独的协议类型类，该类构建要发送的数据并将其发送到突发并有一个接收协议，它接收一堆数据并将其作为一个完整的单元进行处理，而不是将事情分解为发送/接收整数、字符、字节数组等。

作为一个非常粗略的快速示例：

```
TmyCommand = class(TmyProtocol)
private
  fCommand:Integer;
  fParameter:String;
  fDestinationID:String;
  fSourceID:String;
  fWhatever:Integer;
public
  property Command:Integer read fCommand write fCommand;
  ...

  function Serialize;
  procedure Deserialize(Packet:String);
end;

function TmyCommand.Serialize:String;
begin
  //you'll need to delimit these to break them apart on the other side
  result := AddItem(Command) + 
            AddItem(Parameter) + 
            AddItem(DestinationID) + 
            AddItem(SourceID) + 
            AddItem(Whatever);
end; 
procedure TMyCommand.Deserialize(Packet:String);
begin
   Command := StrToInt(StripOutItem(Packet));
   Parameter := StripOutItem(Packet);
   DesintationID := StripOutItem(Packet); 
   SourceID := StripOutItem(Packet);
   Whatever := StrToInt(StripOutItem(Packet));
end; 
```

然后通过以下方式发送：

```
 FConnection.IOHandler.Write(myCommand.Serialize()); 
```

另一方面，您可以通过 Indy 接收数据，然后

```
 myCommand.Deserialize(ReceivedData); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T09:33:50.727

我对 Indy 不熟悉，但您可能想查看它的 API 以获取 TCP_NODELAY 选项（您可能需要对 Indy 源代码树进行 grep 查找类似的东西 - “延迟”应该不区分大小写。）

编辑：**[Rob Kennedy](https://stackoverflow.com/users/33732/rob-kennedy)**指出我所指的属性是**`TIdIOHandlerSocket.UseNagle`**- 谢谢！

这个问题是 TCP 的本质所固有的。TCP 确实保证数据传输的顺序与发出时相同，但不**保证**消息边界。换句话说，源操作系统、目标操作系统以及沿途的任何路由器都可以自由地合并来自连接的数据包或随意对它们进行分段。您必须将 TCP 传输视为流，*而不是*一系列单独的数据包。因此，您将必须实现一种机制，通过该机制您可以分隔各个消息（例如，通过一个魔术字节，如果它也可能出现在您的消息数据中，您必须转义它），或者您可以发送以下消息的长度首先，然后是实际消息。

当我需要发送消息边界很重要的消息时（例如您的情况），我总是使用 UDP 和简单的 ACK/重传方案。可能要考虑到这一点。UDP 更适合用于命令消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T09:30:12.077

听起来您必须刷新缓冲区。试试这个：

```
TIdTCPConnection.FlushWriteBuffer; 
```

如果您不想要写缓冲区，请使用：

```
TIdTCPConnection.CancelWriteBuffer; 
```

根据帮助，这首先调用ClearWriteBuffer，清除缓冲区，然后调用CloseWriteBuffer。

发送整数（使用 Indy 10）的最佳方式是使用 TIdIOHandler.Write （根据 Indy 10 的帮助，Write 被重载以处理不同类型的数据，包括整数）

# audio - 如何从音频文件中分离男性和女性的声音（在 C++ 或 Java 中）

> ID：605586
> 
> 赞同：6
> 
> 时间：2009-03-03T08:47:08.997
> 
> 标签：audio, speech-recognition, speech

我想区分音频文件中的男性和女性声音并将它们分开。作为输出，我希望将两个声音分开。你能帮我吗？编码可以用 java 还是 c++ 完成

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-03T09:23:33.137

这可能是一个非常复杂的问题，类似于编写自己的语音识别（或识别）算法。

您首先将音频转换为频域，这是使用[快速傅里叶变换](http://en.wikipedia.org/wiki/Fast_Fourier_transform)完成的。

对于您进行 FFT 的每个时间片，这将为您提供频率及其幅度的列表。您将需要通过分析谐波来检测基音。2 次和 3 次谐波将最清晰。很难弄清楚它们是哪些谐波，尤其是在背景噪音和人们的声音之间的自然差异方面，哪些谐波最大。然后，您可以尝试通过您猜到的基本音调来确定说话者是男性还是女性。

请记住，在诸如齿音（'s'、't'等）的许多语音部分中，没有音调，只有噪音。它需要非常聪明。

希望这能让你朝着正确的方向前进。

*注意：如果两个声音是同时的，并且你想干净地分开它们，那么这对你没有帮助。我不相信任何活着的人已经解决了这样的问题。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-26T00:35:35.860

我认为这已经成为可能。我刚开始在斯坦福大学和 Andrew Ng 教授一起参加关于机器学习的在线课程，在第一堂课中，他展示了一个演示，其中处理了两个重叠声音的录音并提取了单个声音（与音乐相同）背景和说话的人）。显然，它使用了一种无监督学习算法，可以提取两种底层模式。您可能想查看该课程（这里有该课程的一个版本：[http](http://www.academicearth.org/courses/machine-learning) ://www.academicearth.org/courses/machine-learning ）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-09T13:40:26.507

使这成为可能的一种工具是**[LIUM spkdiarization](http://lium3.univ-lemans.fr/diarization/doku.php/)**。它是用 Java 编写并在 GPL 下可用，它是一种语音识别工具，使用男性、女性和儿童的统计模型。幸运的是，我们提供了模型，您可以使用它而无需标记记录和训练模型。

有关示例，请参见[LIUM wiki 的脚本页面，](http://lium3.univ-lemans.fr/diarization/doku.php/scripting)在页面中搜索“性别”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T10:05:08.810

我首先要说这是不可能的。语音识别真的非常非常难。

您的问题不清楚 - 声音是否重叠？如果是这样，将它们分开将非常困难。

如果它们是分开的，您更有可能的赌注是拥有大量男性和女性声音的样本，并寻找共同特征（以及以编程方式识别它们的方法）。如果样本记录不干净（如果它们有背景噪音），事情就会变得更加复杂。

您可能会以平均音调逃脱 - 男性的声音*通常*比女性的声音更深。.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T09:54:34.777

您要问的是一项艰巨的任务。thomasrutter 写了一些“指针”如何做到这一点 - 但是，我想如果你想在任何地方使用它（在各种音乐中（当然是唱歌）），算法必须非常强大。也许从歌曲中分离（拆分）单个乐器样本开始会更好/更容易。

# .net - winmm.dll 不能作为参考添加

> ID：605587
> 
> 赞同：0
> 
> 时间：2009-03-03T08:47:25.890
> 
> 标签：.net, vb.net

我正在使用 VS2005 并在 vb.net 中制作项目，我试图添加 winmm.dll 文件，但出现此错误。

> 无法添加对“C:\Documents and Settings\rhyatco\My Documents\winmm.dll”的引用。这不是有效的程序集或 COM 组件。只能引用扩展名为“dll”的程序集和 COM 组件。请确保该文件是可访问的，并且它是一个有效的程序集或 COM 组件。

我已经下载了 2 个 winmm.dll，但它并没有真正起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T09:10:48.860

Winmm.dll 包含 win32 api 函数，而不是 com 组件或 .net 类型。

要在 VB 中使用 dll 中的函数，您需要使用“声明语句”。

[您可以在此处](http://msdn.microsoft.com/en-us/library/4zey12w5.aspx)找到有关“声明语句”语法的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T08:54:48.697

可能是因为 winmm.dll 不是 COM DLL 也不是 .Net 程序集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T09:29:50.250

例如，如果您想使用 winmm.dll 播放声音（从 pinvoke.net 复制的示例）转到[http://www.pinvoke.net/](http://www.pinvoke.net/)以获取所有其他 API 的示例和定义：

```
 Public Declare Auto Function PlaySound Lib "winmm.dll" (ByVal pszSound As String, ByVal hmod As IntPtr, ByVal fdwSound As Integer) As Boolean
Public Declare Auto Function PlaySound Lib "winmm.dll" (ByVal pszSound As Byte(), ByVal hmod As IntPtr, ByVal fdwSound As SoundFlags) As Boolean
<Flags()> _
Public Enum SoundFlags As Integer
    SND_SYNC = &H0
    SND_ASYNC = &H1
    SND_NODEFAULT = &H2
    SND_MEMORY = &H4
    SND_LOOP = &H8
    SND_NOSTOP = &H10
    SND_PURGE = &H40
    SND_NOWAIT = &H2000
    SND_ALIAS = &H10000
    SND_FILENAME = &H20000
    SND_RESOURCE = &H40004
End Enum

Public Shared Sub Play(ByVal strFileName As String)
    PlaySound(strFileName, IntPtr.Zero, SoundFlags.SND_FILENAME Or SoundFlags.SND_ASYNC)
End Sub

Public Shared Sub Play(ByVal waveData As Byte())
    'bad idea, see http://blogs.msdn.com/larryosterman/archive/2009/02/19/playsound-xxx-snd-memory-snd-async-is-almost-always-a-bad-idea.aspx
    PlaySound(waveData, IntPtr.Zero, SoundFlags.SND_ASYNC Or SoundFlags.SND_MEMORY)
End Sub

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim ip As UIntPtr = UIntPtr.Zero
    Dim result As Boolean = PlaySound("C:\path\to\wav\file.wav", IntPtr.Zero, ip)
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-10T23:49:01.783

只是一个补充。如果未指定路径，该`Declare Lib Libname`语句将在多个位置进行搜索。`Libname`winmm.dll 长期以来一直是（并且一直是）Windows 的一部分，并且在大多数安装中，它位于“system32”文件夹中。这就是为什么`Declare Lib "winmm.dll"`简单有效。

# java - Java EE 安全性 - 应用程序客户端

> ID：605589
> 
> 赞同：0
> 
> 时间：2009-03-03T08:49:34.670
> 
> 标签：java, security, jakarta-ee

我正在编写一个 Java EE 项目，该项目将拥有来自 3-6 个不同客户端的所有内容。该项目是开源的，我想知道可以/应该使用哪些安全机制。问题是：因为它是开源的，我相信任何拥有用户的人都可以编写自己的客户端（可能不现实，但确实有可能）并与服务器/数据库联系。我已经尝试过以不同角色将不同数据读/写到数据库的所有场景，我得出结论，我必须有一些比这更高级别的安全机制（仅检查*是否*帐户类型允许使用该 ID 保留该实体，依此类推...）。在某种程度上，我必须知道联系的客户是*我的正确客户*写道。签署 Jar 文件可以解决整个问题，还是有其他方法可以解决？

-Yngve

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T16:10:01.427

I really think that if restricting the available activities on the server side (based on role) is not sufficient, than you've got a bigger problem. Even if a user doesn't write their own client, whatever mechanism you are using for your remote calls is likely to be vulnerable to being intercepted and manipulated. The bottom line is that you should limit the possible calls that can be made against the server, and should treat each call to the server as potentially malicious.

Can you think of an example scenario in which there's a server action that a particular authenticated user would be allowed to take that would be fine if they're using your client but dangerous if they're not using your client? If so I'd argue that you're relying too strongly on your client.

However, rather than just criticize I'd like to try to also offer some actual answers to your question as well. I don't think signing your jar file will be sufficient if you're imagining a malicious user; in general, public-key cryptography may not help you much since the hypothetical malicious user who is reverse-engineering your source will have access to your public key and so can spoof whatever authentication you build in.

Ultimately there has to be someone in the system you trust, and so you have to figure out who that is and base your security around them. For example, let's imagine that there may be many users at a particular company who you don't necessarily trust, and one admin who oversees them, who you do trust. In that scenario you could set up your client so that the admin has to enter a special code at startup, and have that code be kept in memory and passed along with any request. This way, even if the user reverse-engineers your code they won't have the admin code. Of course, the calls from your client to your server will still be vulnerable to being intercepted and manipulated (not to mention that this requirement would be a royal pain in the neck to your users).

Bottom line: if your user's machine is calling your server, than your user is calling your server. Don't trust your user. Limit what they can do, no matter what client they're using.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T09:07:18.153

好吧，任何人都可以使用源代码，但部署和数据库的配置肯定不是。部署应用程序时，您可以添加具有角色的用户。最简单的做法是将它们保存在数据库中。当然，表的内容只有数据库管理员可以访问。数据库管理员将配置应用程序，以便它可以访问所需的表。当用户尝试登录时，他/她必须提供用户名和密码。应用程序将读取该表以对用户进行身份验证/授权。

这种类型的安全性是最常见的一种。为了真正安全，您必须通过安全路径 (HTTPS) 传递凭据。为了获得更高程度的安全性，您可以使用 HTTPS 客户端身份验证。为此，您可以为每个客户端生成一个公钥并使用服务器的私钥对其进行签名。然后客户端需要在每个请求中发送这个签名密钥。

编辑：能够编写他/她自己的客户端的用户不会降低应用程序的安全性。如果需要先登录，他/她仍然无法访问该应用程序。如果登录成功，则将创建一个会话（cookie），并将其与每个请求一起传递。看看[Spring 安全性](http://static.springsource.org/spring-security/site/index.html)。它确实有一个相当陡峭的学习曲线，但如果你这样做一次，那么你可以在几分钟内为任何应用程序添加安全性。

# java - 告诉 Java 不要将对象推入交换空间

> ID：605592
> 
> 赞同：3
> 
> 时间：2009-03-03T08:50:48.380
> 
> 标签：java, memory-management, virtual-memory

是否可以告诉 JVM 提示操作系统最好不要将某个对象推出交换空间？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-03T09:28:02.113

最简洁的答案是不。

Java 不允许您对交换的内容和“固定”到 RAM 中的内容进行任何控制。

担心这类事情通常表明您的项目中还有其他问题。操作系统总体上会更好地确定应该交换什么和不应该交换什么。你的工作是编写你的软件，这样它就不会试图猜测底层 VM/OS 会做什么，而只需专注于提供你的功能和一个好的设计。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T10:09:52.247

这个问题在 Eclipse 中也很明显，KeepResident 肮脏的黑客插件（[http://suif.stanford.edu/pub/keepresident/](http://suif.stanford.edu/pub/keepresident/)）避免了它。

这可能是一个很好的起点？我还没有看到它被广泛使用，所以也许它已经集成到标准的 Eclipse 发行版中了？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T09:01:21.707

嘿！您正在使用托管语言进行编程。你为什么要考虑这些？如果你无法忘记这些东西，你总是可以选择用 C 编程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T09:35:47.647

简短的回答是（如上所述）：不要这样做:-)。

不过原则上是可以的。大多数操作系统确实允许“锁定”某些内存区域以防止被交换（例如Linux 下的[mlock(2)](http://linux.die.net/man/2/mlock)，Windows 下的 VirtualLock）。

VM 可以通过适当的 API 将此功能公开给 Java 应用程序。但是，我所知道的虚拟机都没有这样做，所以要做到这一点，您首先必须修改您的虚拟机......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-03T09:53:07.043

如果您定期访问它，那么它当时恰好位于的任何页面（JVM 在垃圾收集期间移动东西）都不会被分页，除非其他东西更积极地请求内存。但是没有办法告诉JVM不要将它移动到另一个页面，并且操作系统只知道页面。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T10:29:22.107

不是答案，但缺乏评论点，我保留此选项:)

有理由不在交换中存储信息。无论是密码还是其他机密信息，都不应该在磁盘上永久存在。此外，周末后回到我的电脑，我希望一些东西可以立即可用。

（非Java）本机可能有一些方法可以为每个/大多数操作系统执行此操作。对于 Windows，这绝对是可能的。但不是直接从 java 出来的（想想 JNI）。根据此选项的绝望程度，您始终可以考虑使用视频内存或其他一些不会换出的硬件设备。这允许您仍然使用标准的 java api，例如 jogl 来存储信息。但不知何故，我怀疑这与您正在寻找的实施/结果有关。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-09T21:06:37.577

基本上，您希望将整个 JVM 一直保留在主内存中。

# language-agnostic - 如何让您的代码为负载平衡做好准备

> ID：605596
> 
> 赞同：5
> 
> 时间：2009-03-03T08:51:43.243
> 
> 标签：language-agnostic, load-balancing

正如我们过去所做的那样，我想为每个转向负载平衡的人收集有用的信息，因为您的代码必须注意一些问题*。*

我们从一个 apache 服务器转移到 squid 作为反向代理/负载均衡器，后面有三个 apache 服务器。

我们使用的是 PHP/MySQL，所以问题可能会有所不同。

## 我们必须解决的问题：

### 会话

我们从“默认”php 会话（文件）转移到分布式 memcached-sessions。简单的解决方案，必须完成。这样，您也不需要负载均衡器上的“粘性会话”。

### 缓存

对于每个 Web 服务器的非分布式 apc-cache，我们添加了另一个用于分布式对象缓存的 memcached-layer，并用它替换了所有旧的/过时的文件缓存系统。

### 上传

上传到共享 (nfs) 文件夹。

## 我们为速度优化的事情：

### 静态文件

我们的主 NFS 运行一个 lighttpd，提供（也是用户上传的）图像。Squid 意识到了这一点，并且从不向我们的 apache 节点查询图像，这极大地提高了性能。Squid 还被配置为将这些文件缓存在 ram 中。

**你做了什么来让你的代码/项目为负载平衡做好准备，考虑这一举措的人们是否有任何其他顾虑，以及你使用的是哪种平台/语言？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T09:14:51.393

这样做时：

对于 http 节点，我努力争取单个系统映像（ocfs2 对此很有用），并根据场景使用磅或十字路口作为负载平衡器。节点应该有一个小的本地磁盘用于交换并避免大多数（但不是全部）CDSL 的麻烦。

然后我将 Xen 加入其中。如果您在 Xenbus 上放置少量的临时信息（即 Linux 实际承诺处理每个 VM aka Committed_AS 的虚拟内存量），您可以快速检测到脑死负载平衡器并对其进行调整。Oracle 也注意到了这一点……现在正在努力改进 Linux 中的气球驱动程序。

之后，我查看了将任何给定应用程序的数据库使用拆分到 sqlite3 和应用程序本机所需的任何数据库的成本，同时意识到我需要拆分数据库，以便 posix_fadvise() 可以完成它的工作，而不会不必要地污染内核缓冲区。由于大多数 DBMS 服务都希望自己进行缓冲，因此您还必须让它们自己进行集群。这确实决定了我使用的数据库集群的类型以及我对气球驱动程序所做的事情。

然后，Memcache 服务器从一个精简的 initrd 启动，而特权域再次监视它们的内存和 CPU 使用情况，因此它知道何时启动更多。

心跳/接管的选择实际上取决于给定的网络和集群的预期使用情况。很难一概而论。

最终结果通常是 5 或 6 个物理节点，具有相当多的内存来启动虚拟机监视器 + 来宾，同时连接到镜像存储。

存储也很难笼统地描述。有时我使用集群 LVM，有时不使用。当 LVM2 最终摆脱其当前基于字符串的 API 时，这种情况不会改变。

最后，所有这些协调都会导致像[Augeas](http://augeas.net/)那样基于通过 Xenbus 通信的事件即时更新配置。这包括 ocfs2 本身，或任何其他配置不能驻留在单个系统映像上的服务。

这真的是一个特定于应用程序的问题..你能举个例子吗？我喜欢 memcache，但并不是每个人都能从使用它中受益，例如。我们是在审查您的配置还是在讨论一般的最佳实践？

**编辑：**

很抱歉如此以 Linux 为中心……它通常是我在设计集群时使用的。

# java - 适用于 Linux 和 Mac 的 Java 的免费本机启动器

> ID：605598
> 
> 赞同：2
> 
> 时间：2009-03-03T08:53:03.973
> 
> 标签：java

我的 Java 应用程序需要一个巨大的内存堆。我需要使用启动我的应用程序

java -Xms32m -Xmx128m xyz.jar

因此，我想为我的 Java 应用程序创建本机启动器，我可以在其中传递 JVM 堆大小参数。我计划在 Windows 平台上使用 JSmooth [http://jsmooth.sourceforge.net/](http://jsmooth.sourceforge.net/)。

但是，我还想为 Linux 和 Mac 创建本机启动器。我可以知道哪些开源/免费软件可以帮助我这样做吗？

LaunchAnywhere [http://www.zerog.com/iamanual/usermanual_ia55/WebHelp/launchanywhere/abo12e.htm](http://www.zerog.com/iamanual/usermanual_ia55/WebHelp/launchanywhere/abo12e.htm)

看起来不错。但它是一个商业软件。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T09:22:41.453

嗯，您可以考虑使用[Java Webstart](http://en.wikipedia.org/wiki/Java_Webstart)。它不仅仅是一个启动器，但它可以做你想做的事情。它简化了部署，您还可以手动安装应用程序并离线使用它们，并且它是跨平台的。

或者您可以只编写一个简单的启动器 shell 脚本。许多应用程序都这样做，而且效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T12:53:02.773

这可能不是您想要的答案，但我会[在 MacOS 上使用应用程序包，](http://developer.apple.com/documentation/Java/Conceptual/Java14Development/00-Intro/JavaDevelopment.html)在 linux/unix 上使用简单的 shell 脚本。

唯一的原因是，在 OSX 上使用 web 启动和/或 shell 脚本的最终用户体验并不是那么好，Mac 用户希望一切都像 Mac 应用程序包一样工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-27T23:53:41.710

使用“/Developer/Applications/Utilities/Jar Bundler”将您的 Jar 打包为 Mac 应用程序。这使得指定图标、堆大小的启动参数、最低 Java 版本、系统属性等变得容易。

# iphone - 关于 iPhone 上 HTTP 异常处理的问题

> ID：605599
> 
> 赞同：0
> 
> 时间：2009-03-03T08:53:14.427
> 
> 标签：iphone, http, exception, exception-handling, connection

我尝试添加一个方法来处理异常，但程序只是崩溃而不是弹出一个 AlertView。

1）我建立了连接：

```
-(void)connect:(NSString *)strURL
{
    NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString:strURL]
                                                            cachePolicy:NSURLRequestUseProtocolCachePolicy    
                                                            timeoutInterval:60.0];

    NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
    if (theConnection) 
    {
        // receivedData is declared as a method instance elsewhere
        receivedData = [[NSMutableData data] retain];
    } 
    else 
    { 
        // inform the user that the download could not be made
    }

} 
```

2）我添加方法来接收数据并将其转换为字符串：

```
- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    // append the new data to the receivedData
    // receivedData is declared as a method instance elsewhere
    [receivedData appendData:data];
    ReturnStr = [[NSString alloc] initWithData:data encoding:NSASCIIStringEncoding];
} 
```

3）我添加异常处理方法：

```
 -(void) connection:(NSURLConnection *)connection didFailWithError: (NSError *)error {

    UIAlertView *errorAlert = [[UIAlertView alloc]
                               initWithTitle: [error localizedDescription]
                               message: [error localizedFailureReason]
                               delegate:self
                               cancelButtonTitle:@"OK"
                               otherButtonTitles:nil];
    [errorAlert show];
} 
```

在我将 strURL 更改为错误的 url 后，程序就崩溃了。为什么没有弹出 AlertView 的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T18:22:21.593

查看[我在此文件中的错误处理](http://github.com/matthewmccullough/iphoneandjavawebservices/blob/21ae01c9114f3a7e9e7439465f1c2dc4ca570c64/iPhoneConsumer-REST/Classes/IPhoneWSConsumerViewController.m)。如果您将 URL 设置为无效 URL，它会（在我的示例中）返回一个不错的对话框错误消息。我只是试了一下确定。

链接文件中的相关代码为：

```
-(void) connection:(NSURLConnection *)connection
  didFailWithError: (NSError *)error {
  UIAlertView *errorAlert = [[UIAlertView alloc]
                 initWithTitle: [error localizedDescription]
                 message: [error localizedFailureReason]
                 delegate:nil
                 cancelButtonTitle:@"OK"
                 otherButtonTitles:nil];
  [errorAlert show];
  [errorAlert release];
  [activityIndicator stopAnimating];
  NSLog (@"Connection Failed with Error");
} 
```

# c# - 从应用程序的多个线程到数据库的多个连接会提高插入查询性能吗？

> ID：605607
> 
> 赞同：3
> 
> 时间：2009-03-03T08:55:24.390
> 
> 标签：c#, multithreading, database-connection

在这里，我正在处理一个包含数千万条记录的数据库。我有一个连接到数据库的应用程序，从表中的单个列中获取所有数据，并对它进行一些操作并更新它（对于 SQL Server - 使用游标）。

对于数百万条记录，更新需要非常非常……很长时间。所以我想通过

1.  使用多个线程，每个线程都有一个独立的连接。

或者

2.  通过在所有线程中使用单个连接来触发更新查询。

哪个更快，或者如果您有任何其他想法请解释。

我需要一个独立于数据库类型的解决方案，或者即使您知道每种数据库的具体解决方案，也请回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T09:01:06.217

你试图达到的加速是行不通的。相反，它会减慢整体处理速度，因为数据库现在还必须保持多个连接/会话/事务同步。

对于重复性和可比性操作，尽可能少地保留连接/事务。如果您的口味需要太长时间，则可以尝试分析是否可以以某种方式优化查询。还可以查看适合您问题的特定于数据库的扩展（即批量操作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T10:13:56.247

一切都取决于数据库及其运行的硬件。

如果数据库可以利用并发处理，并避免对共享资源的争用（例如，页基锁将跨越多条记录，而基于记录则不会）。在这种情况下，共享资源包括硬件，单个核心盒将无法真正并行执行多个 CPU 密集型活动（例如解析 SQL）。

即使数据库本身无法利用并发性，网络延迟也可能有助于缓解并发插入。

与任何性能问题一样，在您的特定场景中可以替代测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T10:56:36.970

如果可能，请尝试使用存储过程进行所有处理并更新记录。

# java - 适用于 Java 程序员的 PowerBuilder？

> ID：605619
> 
> 赞同：4
> 
> 时间：2009-03-03T08:59:41.993
> 
> 标签：java, powerbuilder

我的一个朋友在他的公司使用一个用 PowerBuilder 编写的[ERP软件。](http://en.wikipedia.org/wiki/Enterprise_Resource_Planning)不幸的是，（唯一的）开发人员即将退休。我的朋友非常喜欢这个软件，并且想继续使用它至少十年，所以我的朋友决定购买源代码。

他想创业来维护软件和开发新功能。目前，该软件可能有大约 50 个安装在野外，他已经认识了一群潜在的买家。

现在他正在寻找一名开发人员并问我...我做了一点 C/C++ 编程、一点 VB 和一堆其他语言，但在过去的几年里，我通过编写 Java Web 应用程序来赚钱。根据我的阅读，PowerBuilder 对我来说看起来很陈旧，几乎没有任何教程，没有开源框架，笨拙的版本控制，甚至没有阅读任何测试框架。StackOverflow 上的人们说他们希望语言/IDE 已经死了。此外，我维护的代码完全没有记录和测试。

您认为对于以前从未听说过 PowerBuilder 的人来说，维护这样的软件是可能的吗？

**编辑**：好的，谢谢你的回答。我们决定彻底淘汰旧的应用程序并用最新的语言重新编写它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T13:05:15.927

是的，这是可能的。Powerbuilder 不是一门难学的语言，特别是如果您已经使用过 VB。

Powerbuilder 社区远小于您可能使用的 Java 等社区，但它确实存在。提出问题的最佳位置（除了 SO！）是[sybase.public.powerbuilder.*](http://groups.google.com/groups/dir?sel=usenet%3Dsybase.public.powerbuilder%2C)新闻组。

对于单元测试，请尝试[PowerUnit](http://sourceforge.net/projects/powerunit/)，对于源代码控制，您可以通过[PBSCCProxy](http://dm.char.com.ua/pb/pbscc/pbscc.htm)、[TamTam SVN SCC](http://www.daveswebsite.com/software/tamtamsvn/index.shtml)或[PushOK SVN SCC proxy](http://www.pushok.com/soft_svn.php)使用 Subversion 。

很长一段时间以来，它一直是一种小众语言。在我看来，这是由于所需工具的前期成本，这基本上阻止了任何新人考虑它。

未来是相当光明的：[Sybase 正在蓬勃发展](http://www.sybase.com/detail?id=1061945)，致力于 PowerBuilder，并定期宣布向版本 12 发展，这将是一个完整的 .NET 语言，如 C# 和 VB.NET，并将附带[一个基于 VisualStudio 的 IDE](http://techno-kitten.com/Changes_to_PowerBuilder/powerbuilder_s_future/powerbuilder_s_future.html)。您将能够直接将代码迁移到版本 12，无需重写。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-13T17:43:03.073

我的职业生涯始于 PowerBuilder 开发人员，但当我意识到 PB 几乎是一种死语言时，我很快就转向了 java 和 python。

此外，即使有可用于应用编程“良好实践”的工具，它们也并不广为人知且有些昂贵，所以即使没有版本控制（！！），我也不得不工作，撇开自动化测试或持续一体化。

这是一种几乎任何人都可以在很短的时间内开始构建可用应用程序且几乎不需要培训的语言，而且应用程序的构建速度非常快，与 Java 相比，这需要一段时间的学习，直到开发人员能够高效地工作，即便如此，开发一个 webapp 也需要时间。

但回报是维护，这很快就变成了一场噩梦。即使是数据库中的微小更改（例如数据库列中的类型更改）也会破坏引用它的每个数据窗口（PB 无处不在的数据访问组件）。

它与 VB 非常相似，因为几乎任何人都可以在其中开发应用程序，只需很少的编程知识，应用程序的平均质量非常低，数据库耦合难以管理，并且受到不良编码实践的困扰。

我的建议是不要以这种语言建立开发人员职业生涯，除非有钱证明它是合理的，在这种情况下，作为“计划 b”继续培训自己使用替代技术，以免与语言一起过时。

并且始终努力使您的编码和解决问题的技能保持“良好状态”，因为这种语言对此无济于事。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-05T15:43:40.227

是的，任何称职的程序员，甚至一些不那么称职的程序员都可以使用 PowerBuilder。但是，我不同意早期的答案之一。它在某种意义上不同于.Net VB 之前的版本：它支持真正的 OO 原则（封装、继承和包含多态性 [但不支持 C# 和 Java 中通过接口的操作多态性]）。经典 VB 没有继承。

Paul Lefebvre 和 Colin Pickard 的其他回答是正确的：PB 仍然存在，尽管它比过去更像是一种小众语言，而 Sybase 确实在朝着 .Net 的方向发展。至于源代码控制，PB 支持一些接口（我们将它与 VSS 一起使用），但我很感谢 Colin 提供的一组不错的链接，将来可能会派上用场。

框架：最常见的是 Sybase 多年前开源的 PowerBuilder 基础类。

我对你的警告是：我在上面说过，人们不必是特别强大的程序员来编写 PB。PB很容易学习，但需要时间来掌握。它在 90 年代后期经历了最辉煌的日子，当时任何可以双击 Windows 图标启动应用程序的人都认为他们是程序员。尽管真正支持 OO，但大多数 PB 应用程序都不是设计和编写良好的应用程序。它们通常是完全的 hack 工作（批评当时缺乏经验丰富的开发人员和软件开发的不成熟，而不是 PB 本身，它仍然是一个非常强大的工具）。如果你继承了一个真正易于维护和管理的代码库，那么你就是少数。PB 代码几乎总是可以归类为遗留代码。好消息是有很多挑战。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-26T12:10:46.053

考虑到听起来有偏见的风险，我认为 PB 是目前更好的 RAD 工具之一，明年计划的新版本 PB12 将再次让它变得有趣，因为它使用 Visual Studio 的 VSShell 作为其新的 IDE（Intellisense 等）。我目前正忙于在编译器团队中工作，将所有 .NET 好东西添加到 PowerScript 中，这些好东西在 C# 中使用过，比如委托、接口、属性等，但仍然保持语言易于使用。PB 也是少数提供从旧版本迁移到新版本的开发平台之一，新的 PB12 也不例外。PB12 生成的应用程序将使用 WPF 和后来的 Silverlight 用于 PB12 后的现代外观，所以我非常兴奋。我本身不是 PB 开发人员（C++），但我仍然认为快速生成 C/S 应用程序很难被击败。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-28T22:08:15.770

迁移到另一种语言是否可行取决于原始应用程序的技术质量。

在您阅读我的“PB 很好”之前：我是 93 年以来的 PowerBuilder 开发人员。PowerBuilder 非常有活力和活力。是的，很多人在千禧年之后不久就离开了这门语言，但也有不少人后来又回来了。不，我不赚钱卖PB！

PowerBuilder 应用程序与任何其他工具的最大区别在于 DataWindow 技术。它在知识渊博的开发人员手中是如此强大的工具。示例：为 INSERT/UPDATE/DELETE 动态创建最佳 SQL。接近所有事物的每个属性都可以是使用 DW 缓冲区中的数据的表达式。DropDown DW 非常酷。DW 和 PB 的其余部分是真正独立于 DBMS 的！

当我的许多 DataWindows 只需要 4 个函数调用时，代码完成有多重要？

*   定义数据库连接 >> dwData.SetTransObject(SQLCA)
*   从数据库中读取所有数据 >> dwData.Retrieve()
*   将数据写入数据库 >> dwData.Update(true, false)
*   提交时重置 >> dwData.ResetUpdate( )

我敢打赌：如果最初的开发人员知道如何真正利用 DataWindows - 您对迁移到 Java 或 C# 所做的任何估计都不会接近实际发生的情况。如果他们没有：该应用程序只是另一个应用程序，其数据绑定方式与您的新工具不同。

使用 PowerBuilder 时您会松动什么？您需要接受 4GL 及其 VM 是按原样设计的 - 无法访问 VM 的源代码，因此您无法进行自己的 VM 自定义。没有关闭 NULL 支持来提高速度。无需通过重写 VM 的事件管理器来更改事件顺序。4GL 意味着更少的代码行。DataWindow 意味着更少的 LOC。4GL 意味着更少的 geaky 位调整。

/MicKr- 顺便说一句：PocketBuilder 是 Windows Mobile 的 PB - 好主意！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T14:54:55.820

是的，您当然可以学习 PowerBuilder。但是，您是否愿意是一个只有您才能回答的问题。

我使用 PowerBuilder 很多年了（版本 4 到 9）。有些部分我真的很喜欢。这是构建业务应用程序的好方法。它是面向对象的，DataWindow 是一项很棒的技术。

但它也有不好的地方。IDE 是过时的。代码编辑器很简单（例如，没有代码完成）。与源代码管理的集成很烦人，而且社区很小。它是仅限 Windows 的。

有一本杂志（PowerBuilder Developer's Journal - SYSCON），但现在它很薄。然而，Sybase 似乎确实为 PowerBuilder 的未来版本准备了一些巧妙的东西。

就个人而言，我非常喜欢它，如果有机会我会回去。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T09:27:02.253

很久以前我在powerbuilder上工作过，6.5版它非常易于使用，可以与VB进行比较。我觉得维护应用程序并进行小修复和增强系统会很容易。有不少公司仍在使用 powerbuilder 并维护旧应用程序。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-10-10T22:49:50.557

Powerbuilder 非常简单，您会发现 datawindows 对象对制作报告、界面、表单等非常有帮助。

如果你懂visual basic，那就更简单了

我在 2 个月内学会了 powerbuilder。

powerbuilder 的一个缺点是每个许可证的成本。

# c# - 如何获取内存中的对象大小？

> ID：605621
> 
> 赞同：236
> 
> 时间：2009-03-03T09:00:51.867
> 
> 标签：c#, .net, performance, memory, profiling

我需要知道我的对象在内存中消耗了多少字节（在 C# 中）。例如多少 my `Hashtable`, or `SortedList`, or `List<String>`.

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2010-07-04T03:08:37.927

这可能不准确，但对我来说足够接近

```
long size = 0;
object o = new object();
using (Stream s = new MemoryStream()) {
    BinaryFormatter formatter = new BinaryFormatter();
    formatter.Serialize(s, o);
    size = s.Length;
} 
```

* * *

## 回答 #2

> 赞同：129
> 
> 时间：2009-03-03T09:15:43.217

我不认为你可以直接得到它，但有几种方法可以间接找到它。

一种方法是使用该[`GC.GetTotalMemory`](https://msdn.microsoft.com/en-us/library/system.gc.gettotalmemory%28v=vs.110%29.aspx)方法来测量创建对象前后使用的内存量。这不会是完美的，但只要您控制应用程序的其余部分，您就可以获得您感兴趣的信息。

除此之外，您可以使用分析器来获取信息，或者您可以使用[分析 api](http://msdn.microsoft.com/en-us/library/bb384547.aspx)来获取代码中的信息。但我认为这并不容易使用。

请参阅[找出 C# 中的对象正在使用多少内存？](https://stackoverflow.com/questions/60820/find-out-how-much-memory-is-being-used-by-an-object-in-c)对于类似的问题。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2009-03-03T09:15:37.837

非托管对象：

*   `Marshal.SizeOf(object yourObj);`

值类型：

*   `sizeof(object val)`

托管对象：

*   看起来没有直接的方法来获取托管对象，参考： [https ://docs.microsoft.com/en-us/archive/blogs/cbrumme/size-of-a-managed-object](https://docs.microsoft.com/en-us/archive/blogs/cbrumme/size-of-a-managed-object)

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2011-11-17T16:54:16.220

好的，这个问题已经被回答并接受了，但是有人让我把我的答案写出来，这样你就可以了。

首先，不能肯定地说。这是一个内部实现细节，没有记录。但是，基于对象包含在其他对象中。现在，我们如何计算缓存对象的内存需求？

我之前在这篇[文章](http://www.codeproject.com/KB/biztalk/BizTalkCaching.aspx)中触及过这个主题：

> 现在，我们如何计算缓存对象的内存需求？好吧，你们大多数人都知道，Int32 和 float 是四个字节，double 和 DateTime 是 8 个字节，char 实际上是两个字节（不是一个字节），等等。字符串稍微复杂一点，2*(n+1)，其中 n 是字符串的长度。对于对象，它将取决于它们的成员：只需总结其所有成员的内存需求，记住所有对象引用只是 32 位框上的 4 字节指针。现在，这实际上并不完全正确，我们没有考虑堆中每个对象的开销。我不确定您是否需要担心这一点，但我想，如果您将使用大量小对象，则必须考虑开销。每个堆对象的成本与其原始类型一样多，加上四个字节用于对象引用（在 32 位机器上，虽然 BizTalk 在 64 位机器上也运行 32 位），加上 4 个字节用于类型对象指针，我认为 4 个字节用于同步块索引。为什么这个额外的开销很重要？好吧，假设我们有一个有两个 Int32 成员的类；在这种情况下，内存要求是 16 个字节而不是 8 个。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2011-11-17T10:44:24.433

以下代码片段应该返回传递给它的任何对象的大小（以字节为单位），只要它可以被序列化。我从 Quixant 的一位同事那里得到了这个，以解决在游戏平台上写入 SRAM 的问题。希望它有所帮助。感谢 Carlo Vittuci。

```
/// <summary>
/// Calculates the lenght in bytes of an object 
/// and returns the size 
/// </summary>
/// <param name="TestObject"></param>
/// <returns></returns>
private int GetObjectSize(object TestObject)
{
    BinaryFormatter bf = new BinaryFormatter();
    MemoryStream ms = new MemoryStream();
    byte[] Array;
    bf.Serialize(ms, TestObject);
    Array = ms.ToArray();
    return Array.Length;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-03T10:51:51.897

In debug mode

load SOS

and execute dumpheap command.

# xml - 免费可分发的 XML 编辑器/验证器

> ID：605622
> 
> 赞同：0
> 
> 时间：2009-03-03T09:01:05.983
> 
> 标签：xml, validation, editor

我正在寻找可以作为我产品的一部分分发的免费 XML 编辑器/验证器。有人熟悉这种工具吗？

谢谢，穆尼什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T09:14:33.720

对不起，我看错了问题...

Altova [Authentic](http://www.altova.com/download/authentic/xml_db_form_editor_desktop.html)（免费）是否适合您的目的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T09:27:19.353

我不确定您是否可以将其作为产品的一部分进行分发。
但也许您可以提供一个指向Microsoft的[XML Notepad 2007的链接？](http://www.microsoft.com/downloads/details.aspx?FamilyID=72D6AA49-787D-4118-BA5F-4F30FE913628&displaylang=en)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T09:30:55.520

我可以推荐带有“XML”插件的[JEdit](http://www.jedit.org/)（请参阅网站上的插件部分）。

它允许您编辑 XML、针对 DTD 或 XSD 进行验证、在可停靠的 Sidekick 中显示元素树。还具有元素、属性和实体的完成弹出窗口。

它是免费软件 (GPL)，因此您可以自由分发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T09:34:20.350

[Sharpdeveop](http://www.icsharpcode.net/OpenSource/SD/)确实具有可作为插件使用的 XML 编辑器，可以将其提取出来并发送到。

恕我直言，MS 的 XML 记事本不太好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T13:12:50.933

带有 XML 实用程序的 Notepad++ - 但首先检查许可！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T14:48:15.853

氧气很好，但不是免费的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-06-30T01:34:41.790

也许你可以使用 camv 库来构建你自己的工具，只要你有验证规则模板，它可以从模式中生成，修改它以适应你自己的业务，然后用你的代码（UI）包装它，就可以了更重要的是（以满足您的特定要求）

这里有一个关于如何将 camv 与您的代码集成的简单教程。

[http://www.zenmeo.com/wordpress/xml-validation-using-camv-framework-tutorial/](http://www.zenmeo.com/wordpress/xml-validation-using-camv-framework-tutorial/)

# c++ - 用于 C++ 的 Python 的 PubSub/观察者模式？

> ID：605629
> 
> 赞同：1
> 
> 时间：2009-03-03T09:02:25.700
> 
> 标签：c++, python, observer-pattern, publish-subscribe

我正在寻找 Python PubSub 库的 C++ 替代品，在该库中我不必将信号与插槽左右连接，而是可以注册一种特殊的消息，而不知道可以发送它的对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T18:51:31.507

也许你误解了什么是信号和插槽。使用信号和插槽，您不必知道谁发送信号。您的“客户端”类只声明插槽，外部管理器可以将信号连接到它们。

我建议您查看 Qt。这是一个了不起的跨平台库，不仅仅支持 GUI。它有一个方便有效的信号和槽实现，你可以使用它。

如今，它还获得了 LGPL 的许可（除了 GPL 和商业），因此您几乎可以将它用于任何目的。

重新澄清您的评论，为什么不对错误提出异常？父母可以通知 GUI，或者 GUI 可以注册父母发出的信号。这样，父母也不必了解 GUI。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T11:56:27.653

你可以使用boost库吗？如果是这样，那么结合函数和绑定库允许您执行以下操作。如果您的编译器支持，您可以使用 tr1 功能执行相同的操作。

```
#include <iostream>
#include <list>
#include <boost/function.hpp>
#include <boost/bind.hpp>

typedef boost::function< void() > EVENT_T ;

template<typename F>
class Subject
{
    public:
        virtual void attach ( F o )
        {
            obs_.push_back ( o );
        }

        virtual void notify()
        {
            for ( typename std::list<F>::iterator i = obs_.begin(); i != obs_.end(); ++i )
                ( *i ) ();
        }

    private:
        std::list<F> obs_;
} ;

class Button : public Subject<EVENT_T>
{
    public:
        void onClick()
        {
            notify() ;
        };
};

class Player
{
    public:

        void play()
        {
            std::cout << "play" << std::endl ;
        }
        void stop()
        {
            std::cout << "stop" << std::endl ;
        }

};

class Display
{
    public:
        void started()
        {
            std::cout << "Started playing" << std::endl ;
        }
};

Button playButton ;
Button stopButton ;
Player thePlayer;
Display theDisplay ;

int main ( int argc, char **argv )
{
    playButton.attach ( boost::bind ( &Player::play, &thePlayer ) );
    playButton.attach ( boost::bind ( &Display::started, &theDisplay ) );
    stopButton.attach ( boost::bind ( &Player::stop, &thePlayer ) );

    playButton.onClick() ;
    stopButton.onClick() ;
    return 0;
} 
```

因此，当您运行它时，您会得到：

```
play
Started playing
stop

Press any key to continue. 
```

所以..这是你要找的那种东西吗？

有关大部分代码的来源，请参见[此处](http://www.ddj.com/cpp/184403873)和[此处。](http://www.boost.org/doc/libs/1_38_0/libs/bind/bind.html#with_boost_function)

编辑： boost::signal 库也可能做你想做的事。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-06T18:20:00.687

你为什么不只实施一个？这不是一个复杂的模式（好吧，取决于你真正想要的）。无论如何，我前段时间已经实现了一个快速而肮脏的。它没有经过优化、同步和单线程。我希望你可以用它来制作你自己的。

```
#include <vector>
#include <iostream>
#include <algorithm>

template<typename MESSAGE> class Topic;
class Subscriber;

class TopicBase
{
    friend class Subscriber;
private:
    virtual void RemoveSubscriber(Subscriber* subscriber)=0;
};

template<typename MESSAGE>
class Topic : public TopicBase
{
    friend class Subscriber;
private:
    class Callable
    {
    public:
        Callable(Subscriber* subscriber, void (Subscriber::*method)(const MESSAGE&))
            :m_subscriber(subscriber)
            ,m_method(method)
        {
        }
        void operator()(const MESSAGE& message)
        {
            (m_subscriber->*m_method)(message);
        }
        bool operator==(const Callable& other) const
        {
            return m_subscriber == other.m_subscriber && m_method == other.m_method;
        }
    public:
        Subscriber* m_subscriber;
        void (Subscriber::*m_method)(const MESSAGE&);
    };
public:
    ~Topic()
    {
        //unregister each subscriber
        for(std::vector<Callable>::iterator i = m_subscribers.begin(); i != m_subscribers.end(); i++)
        {
            std::vector<TopicBase*>& topics  = i->m_subscriber->m_topics;
            for(std::vector<TopicBase*>::iterator ti = topics.begin();;)
            {
                ti = std::find(ti, topics.end(), this);
                if(ti == topics.end()) break;
                ti = topics.erase(ti);
            }
        }
    }
    void SendMessage(const MESSAGE& message)
    {
        for(std::vector<Callable>::iterator i = m_subscribers.begin(); i != m_subscribers.end(); i++)
        {
            (*i)(message);
        }
    }
private:
    void Subscribe(Subscriber* subscriber, void (Subscriber::*method)(const MESSAGE&))
    {
        m_subscribers.push_back(Callable(subscriber, method));
        subscriber->m_topics.push_back(this);
    }
    void Unsubscribe(Subscriber* subscriber, void (Subscriber::*method)(const MESSAGE&))
    {
        std::vector<Callable>::iterator i = std::find(m_subscribers.begin(), m_subscribers.end(), Callable(subscriber, method));
        if(i != m_subscribers.end())
        {
            m_subscribers.erase(i);
            subscriber->m_topics.erase(std::find(subscriber->m_topics.begin(), subscriber->m_topics.end(), this)); //should always find one
        }
    }
    virtual void RemoveSubscriber(Subscriber* subscriber)
    {
        for(std::vector<Callable>::iterator i = m_subscribers.begin() ; i != m_subscribers.end(); i++)
        {
            if(i->m_subscriber == subscriber)
            {
                m_subscribers.erase(i);
                break;
            }
        }
    }
private:
    std::vector<Callable> m_subscribers;
};

class Subscriber
{
    template<typename T> friend class Topic;
public:
    ~Subscriber()
    {
        for(std::vector<TopicBase*>::iterator i = m_topics.begin(); i !=m_topics.end(); i++)
        {
            (*i)->RemoveSubscriber(this);
        }
    }
protected:
    template<typename MESSAGE, typename SUBSCRIBER>
    void Subscribe(Topic<MESSAGE>& topic, void (SUBSCRIBER::*method)(const MESSAGE&))
    {
        topic.Subscribe(this, static_cast<void (Subscriber::*)(const MESSAGE&)>(method));
    }
    template<typename MESSAGE, typename SUBSCRIBER>
    void Unsubscribe(Topic<MESSAGE>& topic, void (SUBSCRIBER::*method)(const MESSAGE&))
    {
        topic.Unsubscribe(this, static_cast<void (Subscriber::*)(const MESSAGE&)>(method));
    }
private:
    std::vector<TopicBase*> m_topics;
};

// Test

Topic<int> Topic1;

class TestSubscriber1 : public Subscriber
{
public:
    TestSubscriber1()
    {
        Subscribe(Topic1, &TestSubscriber1::onTopic1);
    }
private:
    void onTopic1(const int& message)
    {
        std::cout<<"TestSubscriber1::onTopic1 "<<message<<std::endl;
    }
};

class TestSubscriber2 : public Subscriber
{
public:
    void Subscribe(Topic<const char*> &subscriber)
    {
        Subscriber::Subscribe(subscriber, &TestSubscriber2::onTopic);
    }
    void Unsubscribe(Topic<const char*> &subscriber)
    {
        Subscriber::Unsubscribe(subscriber, &TestSubscriber2::onTopic);
    }
private:
    void onTopic(const char* const& message)
    {
        std::cout<<"TestSubscriber1::onTopic1 "<<message<<std::endl;
    }
};

int main()
{
    Topic<const char*>* topic2 = new Topic<const char*>();
    {
        TestSubscriber1 testSubscriber1;
        Topic1.SendMessage(42);
        Topic1.SendMessage(5);
    }
    Topic1.SendMessage(256);

    TestSubscriber2 testSubscriber2;
    testSubscriber2.Subscribe(*topic2);
    topic2->SendMessage("owl");
    testSubscriber2.Unsubscribe(*topic2);
    topic2->SendMessage("owl");
    testSubscriber2.Subscribe(*topic2);
    delete topic2;

    return 0;
} 
```

# jquery - 当id包含点时，如何使用jquery按ID选择html节点？

> ID：605630
> 
> 赞同：187
> 
> 时间：2009-03-03T09:03:15.727
> 
> 标签：jquery

如果我的 html 看起来像这样：

```
<td class="controlCell">
    <input class="inputText" id="SearchBag.CompanyName" name="SearchBag.CompanyName" type="text" value="" />
</td> 
```

如何使用 JQuery 选择 #SearchBag.CompanyName？我无法让它工作，我担心它是打破这一切的点。烦人的事情是重命名我所有的 id 会做很多工作，更不用说可读性的损失了。

**注意：**
请不要开始谈论如何不为布局而制作表格。我非常清楚[CSS 的价值和缺点，](http://meyerweb.com/eric/thoughts/2009/02/17/wanted-layout-system/)并努力尽可能地使用它。

* * *

## 回答 #1

> 赞同：228
> 
> 时间：2009-03-03T10:09:49.063

@Tomalak 在评论中：

> 由于 ID 选择器必须以哈希 # 开头，因此此处不应有歧义

“#id.class” 是一个有效的选择器，它需要一个 id 和一个单独的类来匹配；它是有效的，并不总是完全多余的。

选择文字 '.' 的正确方法 在 CSS 中是转义它：“#id\.moreid”。这曾经在一些较旧的浏览器（特别是 IE5.x）中引起问题，但所有现代桌面浏览器都支持它。

相同的方法在 jQuery 1.3.2 中似乎确实有效，尽管我还没有彻底测试过；quickExpr 没有选择它，但更多涉及的选择器解析器似乎正确：

```
$('#SearchBag\\.CompanyName'); 
```

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2009-03-03T09:08:15.530

一种变体是这样的：

```
$("input[id='SearchBag.CompanyName']") 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2013-06-06T05:33:28.597

如果你使用，你不需要逃避任何东西`document.getElementById`：

```
$(document.getElementById('strange.id[]')) 
```

`getElementById`假设输入只是一个 id 属性，因此点不会被解释为类选择器。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2012-08-02T12:37:04.610

**简短回答**：如果你有一个 id= 的元素`"foo.bar"`，你可以使用选择器`$("#foo\\.bar")`

**更长的答案**：这是 jquery 文档的一部分 - 您可以在此处找到部分选择器：http: [//api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

您的问题已在文档开头得到解答：

```
如果您希望使用任何元字符（例如
!"#$%&'()*+,./:;?@[\]^`{|}~ )
作为名称的文字部分，您必须使用
两个反斜杠：\\. 例如，如果你有一个 id="foo.bar" 的元素，
您可以使用选择器 $("#foo\\.bar")。W3C CSS 规范包含
关于有效 CSS 选择器的完整规则集。同样有用的是
Mathias Bynens 关于标识符的 CSS 字符转义序列的博客条目。

```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-09-19T20:53:41.000

当您的 ID 在变量中时，attr 选择似乎是合适的：

```
var id_you_want='foo.bar';
$('[id="' + id_you_want + '"]'); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-02-04T11:49:37.010

这记录在[jQuery 选择器 API](http://api.jquery.com/category/selectors/)中：

> 要将任何元字符（例如 `!"#$%&'()*+,./:;<=>?@[\]^`{|}~`）用作名称的文字部分，必须使用两个反斜杠对其进行转义：`\\`. 例如，带有 的元素 `id="foo.bar"`可以使用选择器`$("#foo\\.bar")`。

简而言之，为`.`加上前缀`\\`。

```
$('#SearchBag\\.CompanyName') 
```

问题是它`.`会匹配一个类，所以`$('#SearchBag.CompanyName')`会匹配`<div id="SearchBag" class="CompanyName">`。转义的 with`\\.`将被视为普通`.`的，没有特殊意义，与您想要的 ID 匹配。

这适用于所有`!"#$%&'()*+,./:;<=>?@[\]^`{|}~`在 jQuery 中作为选择器具有特殊意义的字符。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-08-04T18:02:23.920

正在寻找更通用解决方案的人，我找到了一种解决方案，它在任何特殊字符之前插入一个反斜杠，这解决了与从包含特殊字符的 div 检索名称和 ID 相关的问题。

> "str1.str2%str3".replace(/[^\w\s]/gi, '\\$&')
> 
> 返回 "Str1\\.str2\\%str3"

希望这是有用的！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-03-13T23:52:20.610

您可以使用属性选择器：

```
$("[id='SearchBag.CompanyName']"); 
```

或者您可以指定元素类型：

```
$("input[id='SearchBag.CompanyName']"); 
```

# perl - 如何使用 Class::ArrayObjects？

> ID：605641
> 
> 赞同：3
> 
> 时间：2009-03-03T09:07:47.463
> 
> 标签：perl

[我编写了一个使用Class::ArrayObjects](http://search.cpan.org/perldoc?Class::ArrayObjects)的简单程序，但它没有按预期工作。该程序是：

TestArrayObject.pm:

```
package TestArrayObject;
use Class::ArrayObjects define => { 
                       fields  => [qw(name id address)], 
                   };

sub new {
    my ($class) = @_;
    my $self = [];
    bless $self, $class;
    $self->[name] = '';
    $self->[id] = '';
    $self->[address] = '';
    return $self;
}
1; 
```

测试.pl

```
use TestArrayObject;
use Data::Dumper;

my $test = new TestArrayObject;
$test->[name] = 'Minh';
$test->[id] = '123456';
$test->[address] = 'HN';
print Dumper $test; 
```

当我运行 Test.pl 时，输出数据是：

```
$VAR1 = bless( [
             'HN',
             '',
             ''
           ], 'TestArrayObject' ); 
```

我想知道“姓名”和“身份证”的数据在哪里？

谢谢，明。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-03T09:20:08.947

**始终**使用`use strict`. 尝试`use warnings`尽可能多地使用。

由于`use strict`您的测试脚本甚至无法运行，Perl 将发出以下错误消息：

```
Bareword "name" not allowed while "strict subs" in use at test.pl line 8.
Bareword "id" not allowed while "strict subs" in use at test.pl line 9.
Bareword "address" not allowed while "strict subs" in use at test.pl line 10.
Execution of test.pl aborted due to compilation errors. 
```

这是因为数组索引的名称仅对 TestArrayObject 模块可见，而对测试脚本不可见。

为了使您的类面向对象，我建议您为变量实现访问器，例如 get_name/set_name 并从类模块外部使用这些访问器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T09:39:34.067

根据 Manni 的评论，我对我的程序进行了一些更改，如下所示：

TestArrayObject.pm:

```
package TestArrayObject;
use strict;
use Class::ArrayObjects define => {
                                  fields  => [qw(name id address)],
                                };
sub new {
    my ($class) = @_;
    my $self = [];
    bless $self, $class;    
    return $self;
}

sub Name {
    my $self = shift;
    $self->[name] = shift if @_;
    return $self->[name];
}

sub Id {
    my $self = shift;
    $self->[id] = shift if @_;
    return $self->[id];
}

sub Address {
    my $self = shift;
    $self->[address] = shift if @_;
    return $self->[address];
}

1; 
```

==> 我添加了一些获取/设置方法来访问内部数组对象。

测试.pl：

```
use strict;
use TestArrayObject;
use Data::Dumper;

my $test = new TestArrayObject;
$test->Name('Minh');
$test->Id('123456');
$test->Address('HN');
print Dumper $test; 
```

最后的输出是：

```
$VAR1 = bless( [
             'Minh',
             '123456',
             'HN'
           ], 'TestArrayObject' ); 
```

这正是我所期望的。

谢谢。

# eclipse - 是否可以仅使用键盘在 Eclipse 中工作？

> ID：605644
> 
> 赞同：19
> 
> 时间：2009-03-03T09:08:53.017
> 
> 标签：eclipse, workflow, keyboard, accessibility

正如我们大多数人时不时所做的那样，我尝试改进我的工作流程。由于 Eclipse 是我的主要 IDE，我想知道是否可以在没有鼠标的情况下使用它。我浏览了可用的快捷方式并尝试使用它们而不是鼠标。我发现了一些有趣的功能，比如 Ctrl+3 可以打开 Apple 聚光灯之类的东西。

我知道有很多关于最喜欢的快捷方式等的问题，但我想知道它是否有效，因为目前没有鼠标感觉 100% 有点糊。

那么有人像那样使用Eclipse吗？是否有一些提示可以缓解这种变化？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-03T09:42:32.170

是的，有可能。首先，请查看[每个 Java 程序员都应该知道的 10 个 Eclipse 导航快捷方式](http://rayfd.wordpress.com/2007/05/20/10-eclipse-navigation-shortcuts-every-java-programmer-should-know/)。当你使用这 10 个快捷键和评论的一些快捷键时，你已经会看到性能的巨大提升。

“打开类型”和“打开资源”对话框区分大小写，因此在打开类型对话框中键入“NPE”时，我得到两个匹配项 NoPermissionException 和 NullPointerException。因此，必须使用具有一致拼写的好名称。

Ctrl+F11 启动一个程序，F11 调试它。请注意如何检查在 Window-Preferences-Run/Debug-Launching 中“启动操作”的值是否设置为您的需要。

您可能希望自定义搜索对话框 (Ctrl+h) 以仅显示文件搜索（默认为上下文敏感地为您提供不同的搜索选项卡）。

Ctrl+n 允许您创建新内容（打开带有初始过滤器文本的向导以过滤可能的下一页）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-03T10:12:18.980

我是一个使用eclipse的盲人程序员。虽然有很多快捷方式，但我发现人们经常忽略使用键盘上的菜单。如果您经常使用的某个功能似乎不受键盘快捷键的支持，您可以在首选项中创建一个快捷方式，或者使用键盘快捷键（例如 alt+f）访问文件菜单和一个允许的单字母组合您访问该项目。例如，按 alt+f 然后按 a 来访问另存为对话框。带下划线的字母是您要在菜单中点击一次的字母。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T16:25:02.723

您可以做几件事来提高 Eclipse 的键盘：鼠标使用率。

首先，如果您按下 Ctrl-Shift-L，它会显示您可以使用的所有快捷键的主列表。如果您知道自己想做什么，这通常是一种更快的方法，无需翻阅菜单，而且作为奖励，您将学习一些以前不知道的快捷方式。

您可以尝试的另一件事是一个名为[MouseFeed](http://www.mousefeed.com/)的插件，它看起来很有前途。它会告诉您使用的任何菜单项的快捷方式，如果没有，则会提醒您创建一个。它基本上充当辅助轮，直到您尽可能接近 100% 使用键盘。我不确定它在 3.4 中的效果如何，但你可以试一试。

希望有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T10:24:23.397

在这里，您可以获得所有键绑定的[Eclipse Shortcut Overview](http://eclipse-tools.sourceforge.net/EclipseEmacsKeybindings_3_1.pdf) PDF 文件。如果您愿意，您可以打印此文件并将其放在键盘旁边。

# database - 数据库网络延迟

> ID：605648
> 
> 赞同：12
> 
> 时间：2009-03-03T09:09:28.880
> 
> 标签：database, performance, latency

我目前正在开发一个 n 层系统并与一些数据库性能问题作斗争。我们一直在研究的一个领域是数据库服务器和应用程序服务器之间的延迟。在我们的测试环境中，两个盒子之间的平均 ping 时间在 0.2 毫秒左右，但在客户端站点上，它在 8.2 毫秒左右。这是我们应该担心的事情吗？

对于您的平均系统，你们认为合理的延迟是多少，您将如何测试/测量延迟？

卡尔

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-02T18:02:05.563

很抱歉回复非常不及时，但是当我在寻找其他人在他们的应用服务器和数据库服务器之间实现的网络延迟的指标时，我偶然发现了这个问题。无论如何，我注意到其他答案

无论如何，简而言之：是的，网络延迟（通过 ping 测量）可以产生巨大的差异。

如果您的数据库响应为 0.001 毫秒，那么您将看到从 0.2 毫秒到 8 毫秒 ping 的巨大影响。我听说数据库协议很健谈，如果这是真的，则意味着它们会受到较慢的网络延迟而不是 http 的影响。

更有可能的是，如果您正在运行 1 个查询，那么添加 8 毫秒以从数据库中获取回复并不重要。但是，如果您正在执行 10,000 次查询，这些查询通常发生在错误代码或未优化使用 ORM 的情况下，那么您将需要额外等待 80 秒才能进行 8 毫秒的 ping，而对于 0.2 毫秒的 ping，您只需等待 4 秒。

作为我自己的政策问题，我从不让客户端应用程序直接联系数据库。我要求客户端应用程序始终通过应用程序服务器（例如 REST Web 服务）。这样一来，如果我不小心遇到了“1+N”ORM 问题，那么它的影响就没有那么大了。我仍然会尝试解决根本问题...

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-03T09:13:47.933

总之：不！

您应该监控的是查询的全局性能（即传输到数据库 + 执行 + 传输回您的服务器）

您可以做的是使用性能计数器来监控您的查询通常需要执行的时间。您可能会看到您的结果超过毫秒区域。

没有“合理的延迟”之类的东西。您应该考虑“项目的合理延迟”，这取决于您正在处理的内容而有很大差异。人们对实时交易平台和只读业余网站的期望不同。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-06-10T02:16:47.763

在基于 linux 的服务器上，您可以使用 tc 命令自己测试延迟的影响。

例如，此命令将为通过 eth0 的所有数据包添加 10ms 延迟

```
tc qdisc add dev eth0 root netem delay 10ms 
```

使用此命令消除延迟

```
tc qdisc del dev eth0 root 
```

此处提供更多详细信息：http: [//devresources.linux-foundation.org/shemminger/netem/example.html](http://devresources.linux-foundation.org/shemminger/netem/example.html)

所有应用程序都会有所不同，但我肯定见过 10 毫秒延迟对系统性能产生重大影响的情况。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-18T15:29:51.507

answers.com 的一位负责人表示，根据他们的研究，网页加载的 400 毫秒等待时间大约是他们第一次开始让人们取消页面加载并转到其他地方的时间。我的建议是查看从最初的客户请求到履行的整个过程，如果您在那里做得很好，则无需进一步优化。8.2 毫秒 vs 0.2 毫秒在数学意义上是指数级的，但从人类意义上来说，没有人能真正感知到 8.0 毫秒的差异。这就是他们在比赛中完成照片的原因；）

# php - RichTextEditor 是 PHP/代码对 php 片段友好的

> ID：605654
> 
> 赞同：0
> 
> 时间：2009-03-03T09:11:14.647
> 
> 标签：php, javascript, richtext, rte

我似乎找不到一个 js RTE 可以与其中交织的 php 片段友好地玩耍。我想要一个用于多个站点后端的迷你 CMS。视图在这里和那里有一些 php 片段

是否有任何 RTE 可以单独使用 php，甚至显示它与漂亮的格式混合在一起？

即使在 html 模式下输入并来回切换，TinyMCE 也会杀死标签。如果粘贴到源代码模式，FCKEdit 似乎保持代码完整，但它没有显示在编辑端，所以如果有人删除了一个包含一些 php 的元素，bop，它就消失了。

并且没有一个编辑器喜欢创建良好的缩进代码，这也是一个不错的加分项，但可能会问得过头了，呵呵。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T09:32:01.120

Javascript 富文本编辑器利用浏览器内置的 DesignMode 或 ContentEditable 功能来实现嵌入式 HTML 编辑，这些不支持嵌入的 PHP 标签。

解决方案必须将这些转换为其他形式，不会被浏览器的 HTML 编辑器弄糊涂，然后在提交时将它们转换回 PHP 标记。

可以做到的。但是，我不知道有什么这样做的。

至于创建良好缩进的代码，这是一个类似的问题。浏览器在其嵌入式 HTML 编辑器中处理它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-07T01:20:45.530

几周前我有一个类似的问题： [Textarea that can do syntax highlighting on the fly？](https://stackoverflow.com/questions/1619167/textarea-that-can-do-syntax-highlighting-on-the-fly)

这对您来说可能是正确的：http: [//marijn.haverbeke.nl/codemirror/](http://marijn.haverbeke.nl/codemirror/) 他们甚至混合了 PHP 和 HTML 突出显示。

# c++ - 表 api

> ID：605663
> 
> 赞同：2
> 
> 时间：2009-03-03T09:13:50.990
> 
> 标签：c++, api

假设您有一个表格小部件类。

你做`table.row(i).column(0).setText(students[i].surname())`
或`table[0][i] = students[i].surname()`

后者的意义不大，但简单却如此诱人；）

同上：`table.row(0).column(0).setBackground(red)`
对：`table[0][0].setBackground(red)`

请注意，`Table::row`返回 a `Table::Row`，其`column`函数返回 Table::Cell，并且 Table::Cell 提供`setText`或`op=`（以及 setBackground）。和
相同。`Table::op[]``Table::Row::op[]`

你的意见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T09:34:10.507

作为许多常见情况的不那么冗长的替代方案，我还将提供如下内容：

```
table.rowcol(i, j) = "blah"; // rowcol returns directly a cell
table.colrow(k, t).SetBackground(black); 
```

基本上，方法的名称只是作为参数顺序的提示。此外，作为单一方法，您可以执行更好的异常处理 IMO。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T09:17:41.623

第二个。它与第一个含义一样多，并且更容易阅读和输入。（我真的不明白你为什么说它“意义不大”。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T09:18:07.440

实际上你不会做这两件事。它们都是错误代码，如果没有行，可能会导致异常。

```
if(table.rows > 0)
{
    var row = table.row[0];
    if(row.columns > 0)
    {
        var col = row.column[0];
        etc... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T09:25:19.060

`Table::row()`和方法的解决方案`Table::Row::column()`更具可读性（通常），并且允许您在以后明确创建`Table::column()`方法、`Table::Column`（代理）类和`Table::Column::row()`方法，如果需要的话。此解决方案还可以轻松找到访问行/列的所有位置，这在您使用运算符重载时要困难得多。

然而，正如其他人指出的那样，第二种解决方案减少了打字，而且在我看来，可读性也不会差很多。（在某些情况下甚至可能更具可读性。）

不过，由您决定，我只是给出两种解决方案的一些含义:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T09:26:19.027

```
table.row(i).column(0) 
```

这种风格被称为[Named Parameter Idiom](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.18)。这使得以您喜欢的任何方式重新排序一组调用作为位置参数的替代方案变得容易。但是，如果每个[链接](http://www.parashift.com/c++-faq-lite/references.html#faq-8.4)调用都返回相同的原始对象，则此方法有效。当然，在您的情况下，您有一个`row`对象和一个`column`对象。所以，这里没有太多收获。

第二种结构的易用性为选择后者而不是前者提供了另一个令人信服的理由。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T09:49:33.557

没有一种方法比另一种更好。这取决于您对数据结构所做的事情。

也就是说，对于一个简单的表格小部件（假设您没有编写复杂的类似 Excel 的应用程序），我会寻求简单的语法而不是更通用的界面。所以 table[0][1] = "blah" 对我来说很好用。

# svn - 强制颠覆不合并特定文件

> ID：605677
> 
> 赞同：2
> 
> 时间：2009-03-03T09:19:02.493
> 
> 标签：svn, entity-framework

我们在使用实体框架和颠覆的项目中遇到问题。

每次有人尝试合并 edmx 文件时，该文件都会损坏。我们添加了一个**svn:needs-lock**属性，但这意味着没有人可以在本地编辑文件。看到[这个](https://stackoverflow.com/questions/569948/force-user-to-lock-file-in-svn-before-editing)帖子。

我们需要能够在开发过程中在本地编辑文件，然后在文件准备好时将更改应用到文件。我们意识到这意味着我们将对文件进行一些本地更改。

也许还有其他人遇到过实体框架和颠覆的问题？

BR拉尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T09:23:12.980

如果 Subversion 认为它是一个文本文件，它只会尝试合并一个文件。如果您手动设置一个表示二进制语义的 mime-type，则不会进行合并，这可以通过手动设置一个表示文件是二进制而不是文本的 mime-type 来完成。

[有关更多信息，请参阅此页面](http://svnbook.red-bean.com/en/1.0/ch07s02.html)上标题为 svn:mime-type 的部分。

如果将 mime-type 设置为 application/octet-stream，它将始终将文件标记为处于冲突状态。

```
svn propset svn:mime-type application/octet-stream FILENAME.EDMX 
```

我冒昧地猜测，Subversion 不可能直接忽略对文件的本地修改，除非您只是要求 Subversion 根本不跟踪文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T09:23:48.143

[正如同一篇文章](https://stackoverflow.com/questions/569948/force-user-to-lock-file-in-svn-before-editing)中所解释的，只需使用**svn lock**来修改锁定的文件，然后像往常一样提交它。

例如：

```
svn lock favicon.gif 
```

我错过了什么吗？

# git - 整理 Git 混乱

> ID：605681
> 
> 赞同：9
> 
> 时间：2009-03-03T09:20:48.603
> 
> 标签：git, version-control, branch, dvcs

我刚刚继承了一个使用 Git 维护的项目。有一次，代码被部署到 3 个独立的系统上，每个系统都维护着自己的分散式 Git 存储库。

3 个系统中的每一个都在 3 个不同的方向上扩展了原始基础系统。三个系统都没有相互同步。一些更改在主分支上，其他更改在新分支上。

我怎样才能将 3 个不同的来源放在一起，以便我可以：

1.  找到一个共同的工作基础；
2.  找出哪些更改是应该应用于所有 3 个系统的错误修复；和
3.  以一种健全的方式维护 3 个系统，以便只有一个公共分支并分离出 3 个不同系统所需的定制？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-03T09:29:10.113

我可能会首先将所有存储库推送到中央存储库中的单独分支，从中我可以轻松地在分支之间进行变基、合并等。

一个好的可视化工具，如[git-age](http://wiki.github.com/krig/git-age)、[gitnub](http://wiki.github.com/Caged/gitnub)、[gitx](http://gitx.frim.nl/)、[giggle](http://live.gnome.org/giggle)可以创造奇迹，但你的任务可能会相当乏味，除非你能找到分支点。如果有类似的补丁应用于所有分支，您可以使用（交互式）[rebase](http://git-scm.com/docs/git-rebase)重新排序您的提交，使它们处于相同的顺序。然后你可以开始“压缩”你的分支，通过将提交放入 master 来向上移动分支点。关于如何使用 rebase 重新排序提交的一个很好的描述可以在[这里](http://gitready.com/advanced/2009/03/20/reorder-commits-with-rebase.html)找到。

[Git Howto Index](http://www.kernel.org/pub/software/scm/git/docs/howto-index.html)提供的链接中描述了您可能需要采取的操作。一份好的[备忘单](http://zrusin.blogspot.com/2007/09/git-cheat-sheet.html)总是触手可及。另外，我怀疑 Eric Sinks 的后续文章“ [DVCS 和 DAG，第 1 部分](http://www.ericsink.com/entries/dvcs_dag_1.html)”将包含一些有用的内容（它没有，但读起来很有趣）。

其他值得拥有的链接是：[Git Magic](http://www-cs-students.stanford.edu/~blynn/gitmagic/)、[Git Ready](http://gitready.com/)和[SourceMage Git Guide](http://www.sourcemage.org/Git_Guide)

我希望所有的 repos 都有很好的提交消息，告诉你每个补丁的目的，就是那个或代码审查 :)

至于如何维护自定义，我们在以下方面很幸运：

我们首先将定制代码与通用代码分开（或保持分开）。然后我们尝试了两种方法；两者都运行良好：

1.  所有部署都有自己的存储库，用于保存自定义。
2.  所有部署在“自定义”存储库中都有自己的分支。

在第一次部署并看到第二次是事实之后，我们花了一些时间试图预测未来的定制/切割点，以减少定制回购（替代品 1，这是我们目前使用的方法）和基础/核心中的重复回购。

是的，每当我们注意到核心/自定义拆分滑落时，我们都会尝试无情地重构 :)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-12T13:09:58.977

好的。经过一番艰苦的努力，我设法做到了。对于任何从事类似任务的人来说，这将涉及很多：

```
git rebase
```

命令以及当事情搞砸时：

```
git reflog
```

其次是

```
git reset --hard HEAD@{ref}
```

# c# - 如何在 C# 中查找数组列表是单维还是多维？

> ID：605682
> 
> 赞同：0
> 
> 时间：2009-03-03T09:20:53.610
> 
> 标签：c#, .net, arrays

在 C# 中，我使用结构创建了 ArrayList。所以它创建了多维数组列表。

```
public struct ParameterValues
{
    public ArrayList al;
};

ArrayList alCombined = new ArrayList();

for(int i=0; i < CONDITION , i++)
    alCombined.Add(obj.pValue.al); 
```

的尺寸`ArrayList alCombined`取决于条件。如果它为 1，则创建一维数组列表。否则正在创建多维 Arraylist。

现在为了访问 alCombined 的元素，我正在对其进行类型转换并访问，例如

```
(((ArrayList)al[i])[j]) 
```

但是，如果它是一维数组列表，则会发生错误，因为无法将类型转换为 Arraylist。

所以我需要一个解决方案，或者如何找到它是否是单维/多维数组列表。仅供参考：它不应该依赖于 CONDITION 变量。就像如果 d 条件不止一个，那么它肯定是多维的。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T09:47:42.610

真的没有“多维 ArrayList”这样的东西。`ArrayLists`没有特定的元素类型。您可能有一个元素是整数，另一个是字符串，另一个是 an `int[]`，另一个是 an`ArrayList`本身。

关于您的代码的一些建议：

*   可变结构是个坏主意。避开他们。很有可能你一开始并不真正想要一个结构，而可变结构可能会导致各种意外行为。
*   公共领域是个坏主意。避开他们。字段是实现细节，不应成为 API 的一部分。
*   `ArrayList`已被有效弃用 - 改用泛型集合。这将使类型信息更加清晰。
*   你应该设计你的数据结构，这样你就不会陷入这种情况。理想情况下，您的代码中应该很少进行执行时类型检查。也许如果您可以向我们提供有关您想要实现的目标的更多信息，我们可以帮助您重新设计它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T09:25:04.227

怎么样

```
if(al[i] is ArrayList)
{
   ...
} 
```

# javascript - 画廊的最佳 JavaScript 实现是什么？

> ID：605684
> 
> 赞同：2
> 
> 时间：2009-03-03T09:22:01.470
> 
> 标签：javascript

我们需要为客户的新网站实施画廊功能。他们在上一个网站上也有类似的功能，使用的是基于[Moo Tools的](http://mootools.net/)[Smooth Gallery](http://smoothgallery.jondesign.net/showcase/gallery/)。

我们可以继续做同样的事情。但是，在我们这样做之前，是否有人对替代方案有任何建议，如果有，请解释为什么您认为您的选择更好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T15:58:22.453

也许看看[展览](http://simile.mit.edu/exhibit/)。（因为它是免费的，而且看起来很简单）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-14T08:08:11.040

最常见的选项是 LightBox - 有纯 JavaScript 版本和基于 jQuery 的 LightBox 2。

您确实需要自己比较所有选项，看看哪个最适合您的需求，但 LightBox 允许您在全尺寸图像上拥有一组带有后退/前进导航的缩略图，如果 JavaScript 被关闭，它就是您的画廊仍然可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-14T08:14:45.300

我通常使用 fancybox ( [http://fancybox.net/](http://fancybox.net/) ) 和 Scrollable ( [http://flowplayer.org/tools/scrollable.html](http://flowplayer.org/tools/scrollable.html) )。你可以在这里查看我的实现示例（现在很不稳定）：http: [//events.coffeencode.org/photos/1/](http://events.coffeencode.org/photos/1/)

# c# - 如何在 C# 中同时读取和写入文件

> ID：605685
> 
> 赞同：73
> 
> 时间：2009-03-03T09:22:09.287
> 
> 标签：c#, file-io, filestream

我想读取和写入文件。这行不通。

```
static void Main(string[] args)
{
    StreamReader sr = new StreamReader(@"C:\words.txt");
    StreamWriter sw = new StreamWriter(@"C:\words.txt");
} 
```

如何在 C# 中读取和写入文件？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-03-03T09:27:41.660

您需要一个单独的流，为读取和写入而打开。

```
FileStream fileStream = new FileStream(
      @"c:\words.txt", FileMode.OpenOrCreate, 
      FileAccess.ReadWrite, FileShare.None); 
```

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2010-09-29T11:52:03.557

不要忘记简单的路线：

```
 static void Main(string[] args)
    {
        var text = File.ReadAllText(@"C:\words.txt");
        File.WriteAllText(@"C:\words.txt", text + "DERP");
    } 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2009-04-08T04:54:06.223

```
var fs = File.Open("file.name", FileMode.OpenOrCreate, FileAccess.ReadWrite);
var sw = new StreamWriter(fs);
var sr = new StreamReader(fs);

...

fs.Close();
//or sw.Close(); 
```

关键是使用 FileAccess.ReadWrite 标志打开文件。然后，您可以使用初始 FileStream 创建所需的任何 Stream/String/Binary Reader/Writers。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-27T11:08:26.287

该线程似乎回答了您的问题：[同时读取写入文件](https://stackoverflow.com/questions/3817477/simultaneous-read-write-a-file-in-c-sharp)

基本上，您需要声明两个 FileStream，一个用于读取操作，另一个用于写入操作。Writer Filestream 需要以“追加”模式打开您的文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-07-21T17:01:16.453

您可以试试这个：每次运行此代码时，都会在 bin->debug 文件夹中自动创建“Filename.txt”文件，或者您可以指定文件的路径，例如：@“C:/...”。您可以通过转到 bin -->debug 文件夹来检查“Hello”是否存在

PS 不要忘记在此代码段之后添加 Console.Readline() 否则控制台将不会出现。

```
TextWriter tw = new StreamWriter("filename.txt");
        String text = "Hello";
        tw.WriteLine(text);
        tw.Close();

        TextReader tr = new StreamReader("filename.txt");
        Console.WriteLine(tr.ReadLine());
        tr.Close(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-08-28T22:33:01.817

@Ipsita 制作了一个改进代码 - 用于**异步读写**文件 I/O

```
readonly string logPath = @"FilePath";
...
public async Task WriteToLogAsync(string dataToWrite)
{
    TextReader tr = new StreamReader(logPath);
    string data = await tr.ReadLineAsync();
    tr.Close();

    TextWriter tw = new StreamWriter(logPath);
    await tw.WriteLineAsync(data + dataToWrite);
    tw.Close();
}
...
await WriteToLogAsync("Write this to file"); 
```

# windows - 如何编写多行命令？

> ID：605686
> 
> 赞同：222
> 
> 时间：2009-03-03T09:22:39.427
> 
> 标签：windows, command-line, command-prompt

我们如何将命令扩展到下一行？

基本上，Linux 的 Windows 替代方案是什么：

```
ls -l \
/usr/ 
```

在这里，我们使用反斜杠将命令扩展到下一行。

Windows 的等价物是什么？

* * *

## 回答 #1

> 赞同：379
> 
> 时间：2009-03-03T09:31:53.337

在尝试了我键盘上的几乎每个键之后：

```
C:\Users\Tim>cd ^
Mehr? Desktop

C:\Users\Tim\Desktop> 
```

所以它似乎是 ^ 键。

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2009-03-03T10:05:34.783

在 Windows 命令提示符中，`^`用于转义命令行上的下一个字符。（Like`\`用在字符串中。）需要在命令行中使用的字符应该有一个 ^ 前缀，因此这就是它适用于换行符的原因。

作为参考，需要转义的字符（如果指定为命令参数而不是在引号内）是：`&|()`

因此，相当于您的 linux 示例将是（*更多？*作为提示）：

```
C:\> dir ^
More? C:\Windows 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-03-14T12:35:58.347

插入符号有效，但下一行不应以双引号开头。例如，这将不起作用：

```
C:\ ^
"SampleText" .. 
```

在没有双引号的情况下开始下一行（不是一个有效的例子，只是为了说明）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-02-15T00:08:47.173

如果你来这里是为了寻找这个问题的答案，但不*完全*是 OP 的意思，即你如何让多行 CMD 在一行中工作*，*我有一个危险的答案给你。

尝试将它与实际使用管道的东西一起使用，比如说`findstr`是很成问题的。处理`else`s 也是如此。但是，如果您只想从 CMD 直接执行多行条件命令，而不是通过批处理文件，这应该可以正常工作。

假设您希望在命令提示符下直接运行批处理中的类似内容：

```
@echo off
for /r %%T IN (*.*) DO (
    if /i "%%~xT"==".sln" (
        echo "%%~T" is a normal SLN file, and not a .SLN.METAPROJ or .SLN.PROJ file
        echo Dumping SLN file contents
        type "%%~T"
    )
) 
```

现在，您可以使用续行克拉 ( `^`) 并像这样手动输入它，但是警告，这很乏味，如果你搞砸了，你可以学习再次输入它的乐趣。

`^`好吧，由于括号内的转义机制，它不会起作用*耸耸肩*至少不是按原样写。您实际上需要像这样将克拉加倍：

```
@echo off ^
More? for /r %T IN (*.sln) DO (^^
More? if /i "%~xT"==".sln" (^^
More? echo "%~T" is a normal SLN file, and not a .SLN.METAPROJ or .SLN.PROJ file^^
More? echo Dumping SLN file contents^^
More? type "%~T")) 
```

相反，您可以从不需要克拉的轨道的错误一侧成为一个肮脏的偷偷摸摸的脚本编写者，通过在`|`每个循环/表达式的延续中将它们换成单个管道 ( )：

```
@echo off
for /r %T IN (*.sln) DO if /i "%~xT"==".sln" echo "%~T" is a normal SLN file, and not a .SLN.METAPROJ or .SLN.PROJ file | echo Dumping SLN file contents | type "%~T" 
```

# user-interface - 编辑/管理大型非循环图的最佳 GUI 概念

> ID：605691
> 
> 赞同：3
> 
> 时间：2009-03-03T09:23:23.653
> 
> 标签：user-interface, graph

关键是能够快速直观地管理潜在的大型图形结构

我遇到的概念是：

*   树
*   树状图
*   维恩图
*   双曲树

您更喜欢哪一个或其他想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T09:31:50.543

对于大型图表，我遇到的最佳实用 UI 解决方案是[Mark Shepherd 的 spring graph](http://web.archive.org/web/20120103172324/http://mark-shepherd.com/blog/springgraph-flex-component)。它的扩展性也很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-15T16:30:47.573

您可能想看看 GUESS，它具有一些不错的快速原型制作功能，例如用于图形操作/生成的集成领域特定语言，并包括各种图形布局。这意味着您可以轻松破解演示并检查您是否喜欢该界面。

[http://graphexploration.cond.org/](http://graphexploration.cond.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-13T01:48:31.997

这里有一些针对不同尺度的巧妙想法：

1.  [Zircle UI](https://zircleui.github.io/zircleUI/#/)一个真正酷的 vuejs 组件，导航感觉有点像通过曼德布罗分形缩放。atm 由六个级别限制。
2.  TU Graz[采用 D3 Smart 解决方案的树浏览器。](https://github.com/unused/hyperbolic-tree-browser)不确定许可影响，但看起来很有希望。
3.  [gephi](https://gephi.org/)这将被数据记者用来显示非常大的图，但不是最具交互性的解决方案。
4.  [yed/yworks](https://www.yworks.com/)非常有经验的公司，拥有各种出色的图表解决方案
5.  [Graphviz 的GraphQLViz](https://github.com/Macroz/GraphQLviz)空间热棒。

为什么不使用思维导图解决方案？那里有很多很酷的东西。例如

1.  [mindmeister](https://www.mindmeister.com) 伟大的网络解决方案，您可以像谷歌文档一样轻松地分享您的工作。
2.  [simplemind](https://simplemind.eu/)作为应用程序或 PC。我个人的最爱，尤其是在我手边。还有免费版。
3.  [freemind](https://de.wikipedia.org/wiki/FreeMind)具有不同分支、大量插件和 groovy-DSL 的开源软件

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T10:03:59.450

[天轨](http://cgi.cse.unsw.edu.au/~wyos/skyrails/)是一个有趣的概念；编辑将通过其命令行完成，而不是直接操作。该实现目前处理 10^4 个节点，这不是正常测量的大图（现在的大图意味着您无法轻松地将它们放入 32 位内存），但该概念利用了与生俱来的人类 3D 导航技能，因此应该尽可能扩大规模。

# java - 从 URL 获取文件名

> ID：605696
> 
> 赞同：164
> 
> 时间：2009-03-03T09:24:25.333
> 
> 标签：java, file, parsing, url, filenames

在 Java 中，给定 a`java.net.URL`或 a`String`的形式`http://www.example.com/some/path/to/a/file.xml`，获取文件名减去扩展名的最简单方法是什么？所以，在这个例子中，我正在寻找返回的东西`"file"`。

我可以想到几种方法来做到这一点，但我正在寻找易于阅读且简短的东西。

* * *

## 回答 #1

> 赞同：217
> 
> 时间：2013-06-18T11:30:54.790

与其重新发明轮子，不如使用 Apache [commons-io](http://commons.apache.org/proper/commons-io/)：

```
import org.apache.commons.io.FilenameUtils;

public class FilenameUtilTest {

    public static void main(String[] args) throws Exception {
        URL url = new URL("http://www.example.com/some/path/to/a/file.xml?foo=bar#test");

        System.out.println(FilenameUtils.getBaseName(url.getPath())); // -> file
        System.out.println(FilenameUtils.getExtension(url.getPath())); // -> xml
        System.out.println(FilenameUtils.getName(url.getPath())); // -> file.xml
    }

} 
```

* * *

## 回答 #2

> 赞同：200
> 
> 时间：2009-03-03T09:37:19.407

```
String fileName = url.substring( url.lastIndexOf('/')+1, url.length() );

String fileNameWithoutExtn = fileName.substring(0, fileName.lastIndexOf('.')); 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2015-11-23T12:23:36.773

如果您不需要摆脱文件扩展名，这里有一种方法可以做到这一点，而无需诉诸容易出错的字符串操作，也无需使用外部库。适用于 Java 1.7+：

```
import java.net.URI
import java.nio.file.Paths

String url = "http://example.org/file?p=foo&q=bar"
String filename = Paths.get(new URI(url).getPath()).getFileName().toString() 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2009-03-03T09:33:12.130

这应该削减它（我将把错误处理留给你）：

```
int slashIndex = url.lastIndexOf('/');
int dotIndex = url.lastIndexOf('.', slashIndex);
String filenameWithoutExtension;
if (dotIndex == -1) {
  filenameWithoutExtension = url.substring(slashIndex + 1);
} else {
  filenameWithoutExtension = url.substring(slashIndex + 1, dotIndex);
} 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2017-11-08T15:13:18.070

一个班轮：

```
new File(uri.getPath).getName 
```

完整代码（在 scala REPL 中）：

```
import java.io.File
import java.net.URI

val uri = new URI("http://example.org/file.txt?whatever")

new File(uri.getPath).getName
res18: String = file.txt 
```

**注意**：`URI#gePath`已经足够智能剥离查询参数和协议的方案。例子：

```
new URI("http://example.org/hey/file.txt?whatever").getPath
res20: String = /hey/file.txt

new URI("hdfs:///hey/file.txt").getPath
res21: String = /hey/file.txt

new URI("file:///hey/file.txt").getPath
res22: String = /hey/file.txt 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2009-12-06T20:42:35.970

```
public static String getFileName(URL extUrl) {
        //URL: "http://photosaaaaa.net/photos-ak-snc1/v315/224/13/659629384/s659629384_752969_4472.jpg"
        String filename = "";
        //PATH: /photos-ak-snc1/v315/224/13/659629384/s659629384_752969_4472.jpg
        String path = extUrl.getPath();
        //Checks for both forward and/or backslash 
        //NOTE:**While backslashes are not supported in URL's 
        //most browsers will autoreplace them with forward slashes
        //So technically if you're parsing an html page you could run into 
        //a backslash , so i'm accounting for them here;
        String[] pathContents = path.split("[\\\\/]");
        if(pathContents != null){
            int pathContentsLength = pathContents.length;
            System.out.println("Path Contents Length: " + pathContentsLength);
            for (int i = 0; i < pathContents.length; i++) {
                System.out.println("Path " + i + ": " + pathContents[i]);
            }
            //lastPart: s659629384_752969_4472.jpg
            String lastPart = pathContents[pathContentsLength-1];
            String[] lastPartContents = lastPart.split("\\.");
            if(lastPartContents != null && lastPartContents.length > 1){
                int lastPartContentLength = lastPartContents.length;
                System.out.println("Last Part Length: " + lastPartContentLength);
                //filenames can contain . , so we assume everything before
                //the last . is the name, everything after the last . is the 
                //extension
                String name = "";
                for (int i = 0; i < lastPartContentLength; i++) {
                    System.out.println("Last Part " + i + ": "+ lastPartContents[i]);
                    if(i < (lastPartContents.length -1)){
                        name += lastPartContents[i] ;
                        if(i < (lastPartContentLength -2)){
                            name += ".";
                        }
                    }
                }
                String extension = lastPartContents[lastPartContentLength -1];
                filename = name + "." +extension;
                System.out.println("Name: " + name);
                System.out.println("Extension: " + extension);
                System.out.println("Filename: " + filename);
            }
        }
        return filename;
    } 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2015-07-17T05:38:20.780

**获取**带扩展名的文件**名**，**不带扩展**名，**只有扩展**名只有 3 行：

```
String urlStr = "http://www.example.com/yourpath/foler/test.png";

String fileName = urlStr.substring(urlStr.lastIndexOf('/')+1, urlStr.length());
String fileNameWithoutExtension = fileName.substring(0, fileName.lastIndexOf('.'));
String fileExtension = urlStr.substring(urlStr.lastIndexOf("."));

Log.i("File Name", fileName);
Log.i("File Name Without Extension", fileNameWithoutExtension);
Log.i("File Extension", fileExtension); 
```

**日志结果：**

```
File Name(13656): test.png
File Name Without Extension(13656): test
File Extension(13656): .png 
```

希望它会帮助你。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-03-03T09:34:36.777

我想出了这个：

```
String url = "http://www.example.com/some/path/to/a/file.xml";
String file = url.substring(url.lastIndexOf('/')+1, url.lastIndexOf('.')); 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2016-02-16T10:18:13.697

```
String fileName = url.substring(url.lastIndexOf('/') + 1); 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2018-07-07T07:57:05.633

有一些方法：

**Java 7 文件 I/O：**

```
String fileName = Paths.get(strUrl).getFileName().toString(); 
```

**阿帕奇共享：**

```
String fileName = FilenameUtils.getName(strUrl); 
```

**使用泽西岛：**

```
UriBuilder buildURI = UriBuilder.fromUri(strUrl);
URI uri = buildURI.build();
String fileName = Paths.get(uri.getPath()).getFileName(); 
```

**子串：**

```
String fileName = strUrl.substring(strUrl.lastIndexOf('/') + 1); 
```

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2014-11-07T21:50:04.843

把事情简单化 ：

```
/**
 * This function will take an URL as input and return the file name.
 * <p>Examples :</p>
 * <ul>
 * <li>http://example.com/a/b/c/test.txt -> test.txt</li>
 * <li>http://example.com/ -> an empty string </li>
 * <li>http://example.com/test.txt?param=value -> test.txt</li>
 * <li>http://example.com/test.txt#anchor -> test.txt</li>
 * </ul>
 * 
 * @param url The input URL
 * @return The URL file name
 */
public static String getFileNameFromUrl(URL url) {

    String urlString = url.getFile();

    return urlString.substring(urlString.lastIndexOf('/') + 1).split("\\?")[0].split("#")[0];
} 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2013-10-11T08:53:14.800

这是在 Android 中执行此操作的最简单方法。我知道它不适用于 Java，但它可以帮助 Android 应用程序开发人员。

```
import android.webkit.URLUtil;

public String getFileNameFromURL(String url) {
    String fileNameWithExtension = null;
    String fileNameWithoutExtension = null;
    if (URLUtil.isValidUrl(url)) {
        fileNameWithExtension = URLUtil.guessFileName(url, null, null);
        if (fileNameWithExtension != null && !fileNameWithExtension.isEmpty()) {
            String[] f = fileNameWithExtension.split(".");
            if (f != null & f.length > 1) {
                fileNameWithoutExtension = f[0];
            }
        }
    }
    return fileNameWithoutExtension;
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-03-03T10:18:02.460

从字符串创建一个 URL 对象。当您第一次拥有一个 URL 对象时，有一些方法可以轻松提取您需要的任何信息片段。

我强烈推荐 Javaalmanac 网站，该网站有大量示例，但后来已经移动。您可能会发现[http://exampledepot.8waytrips.com/egs/java.io/File2Uri.html](http://exampledepot.8waytrips.com/egs/java.io/File2Uri.html)很有趣：

```
// Create a file object
File file = new File("filename");

// Convert the file object to a URL
URL url = null;
try {
    // The file need not exist. It is made into an absolute path
    // by prefixing the current working directory
    url = file.toURL();          // file:/d:/almanac1.4/java.io/filename
} catch (MalformedURLException e) {
}

// Convert the URL to a file object
file = new File(url.getFile());  // d:/almanac1.4/java.io/filename

// Read the file contents using the URL
try {
    // Open an input stream
    InputStream is = url.openStream();

    // Read from is

    is.close();
} catch (IOException e) {
    // Could not open the file
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-08-25T09:59:57.750

如果您只想从 java.net.URL 获取文件名（不包括任何查询参数），您可以使用以下函数：

```
public static String getFilenameFromURL(URL url) {
    return new File(url.getPath().toString()).getName();
} 
```

例如，这个输入 URL：

```
"http://example.com/image.png?version=2&amp;modificationDate=1449846324000" 
```

将被翻译成这个输出字符串：

```
image.png 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-12-20T14:07:49.750

我发现一些 url 在直接传递时会`FilenameUtils.getName`返回不需要的结果，因此需要将其包装起来以避免被利用。

例如，

```
System.out.println(FilenameUtils.getName("http://www.google.com/..")); 
```

返回

> ..

我怀疑有人愿意允许。

以下函数似乎工作正常，并显示了其中一些测试用例，并且`null`在无法确定文件名时返回。

```
public static String getFilenameFromUrl(String url)
{
    if (url == null)
        return null;

    try
    {
        // Add a protocol if none found
        if (! url.contains("//"))
            url = "http://" + url;

        URL uri = new URL(url);
        String result = FilenameUtils.getName(uri.getPath());

        if (result == null || result.isEmpty())
            return null;

        if (result.contains(".."))
            return null;

        return result;
    }
    catch (MalformedURLException e)
    {
        return null;
    }
} 
```

### 以下示例中包含一些简单的测试用例：

```
import java.util.Objects;
import java.net.URL;
import org.apache.commons.io.FilenameUtils;

class Main {

  public static void main(String[] args) {
    validateFilename(null, null);
    validateFilename("", null);
    validateFilename("www.google.com/../me/you?trex=5#sdf", "you");
    validateFilename("www.google.com/../me/you?trex=5 is the num#sdf", "you");
    validateFilename("http://www.google.com/test.png?test", "test.png");
    validateFilename("http://www.google.com", null);
    validateFilename("http://www.google.com#test", null);
    validateFilename("http://www.google.com////", null);
    validateFilename("www.google.com/..", null);
    validateFilename("http://www.google.com/..", null);
    validateFilename("http://www.google.com/test", "test");
    validateFilename("https://www.google.com/../../test.png", "test.png");
    validateFilename("file://www.google.com/test.png", "test.png");
    validateFilename("file://www.google.com/../me/you?trex=5", "you");
    validateFilename("file://www.google.com/../me/you?trex", "you");
  }

  private static void validateFilename(String url, String expectedFilename){
    String actualFilename = getFilenameFromUrl(url);

    System.out.println("");
    System.out.println("url:" + url);
    System.out.println("filename:" + expectedFilename);

    if (! Objects.equals(actualFilename, expectedFilename))
      throw new RuntimeException("Problem, actual=" + actualFilename + " and expected=" + expectedFilename + " are not equal");
  }

  public static String getFilenameFromUrl(String url)
  {
    if (url == null)
      return null;

    try
    {
      // Add a protocol if none found
      if (! url.contains("//"))
        url = "http://" + url;

      URL uri = new URL(url);
      String result = FilenameUtils.getName(uri.getPath());

      if (result == null || result.isEmpty())
        return null;

      if (result.contains(".."))
        return null;

      return result;
    }
    catch (MalformedURLException e)
    {
      return null;
    }
  }
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-10-31T20:39:17.327

Urls最后可以有参数，这个

```
 /**
 * Getting file name from url without extension
 * @param url string
 * @return file name
 */
public static String getFileName(String url) {
    String fileName;
    int slashIndex = url.lastIndexOf("/");
    int qIndex = url.lastIndexOf("?");
    if (qIndex > slashIndex) {//if has parameters
        fileName = url.substring(slashIndex + 1, qIndex);
    } else {
        fileName = url.substring(slashIndex + 1);
    }
    if (fileName.contains(".")) {
        fileName = fileName.substring(0, fileName.lastIndexOf("."));
    }

    return fileName;
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-11-12T20:16:17.353

[urllib](https://github.com/EricEdens/urllib)中的`Url`对象允许您访问路径的非转义文件名。这里有些例子：

```
String raw = "http://www.example.com/some/path/to/a/file.xml";
assertEquals("file.xml", Url.parse(raw).path().filename());

raw = "http://www.example.com/files/r%C3%A9sum%C3%A9.pdf";
assertEquals("résumé.pdf", Url.parse(raw).path().filename()); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-03T10:27:17.600

使用 split() 重做安迪的回答：

```
Url u= ...;
String[] pathparts= u.getPath().split("\\/");
String filename= pathparts[pathparts.length-1].split("\\.", 1)[0]; 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2011-06-23T07:56:25.210

```
public String getFileNameWithoutExtension(URL url) {
    String path = url.getPath();

    if (StringUtils.isBlank(path)) {
        return null;
    }
    if (StringUtils.endsWith(path, "/")) {
        //is a directory ..
        return null;
    }

    File file = new File(url.getPath());
    String fileNameWithExt = file.getName();

    int sepPosition = fileNameWithExt.lastIndexOf(".");
    String fileNameWithOutExt = null;
    if (sepPosition >= 0) {
        fileNameWithOutExt = fileNameWithExt.substring(0,sepPosition);
    }else{
        fileNameWithOutExt = fileNameWithExt;
    }

    return fileNameWithOutExt;
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2013-06-15T09:15:24.317

这个怎么样：

```
String filenameWithoutExtension = null;
String fullname = new File(
    new URI("http://www.xyz.com/some/deep/path/to/abc.png").getPath()).getName();

int lastIndexOfDot = fullname.lastIndexOf('.');
filenameWithoutExtension = fullname.substring(0, 
    lastIndexOfDot == -1 ? fullname.length() : lastIndexOfDot); 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-08-18T18:52:06.173

为了返回**不带扩展名且不**带**参数**的文件名，请使用以下命令：

```
String filenameWithParams = FilenameUtils.getBaseName(urlStr); // may hold params if http://example.com/a?param=yes
return filenameWithParams.split("\\?")[0]; // removing parameters from url if they exist 
```

为了返回**不带参数的扩展名文件名，**请使用：

```
/** Parses a URL and extracts the filename from it or returns an empty string (if filename is non existent in the url) <br/>
 * This method will work in win/unix formats, will work with mixed case of slashes (forward and backward) <br/>
 * This method will remove parameters after the extension
 *
 * @param urlStr original url string from which we will extract the filename
 * @return filename from the url if it exists, or an empty string in all other cases */
private String getFileNameFromUrl(String urlStr) {
    String baseName = FilenameUtils.getBaseName(urlStr);
    String extension = FilenameUtils.getExtension(urlStr);

    try {
        extension = extension.split("\\?")[0]; // removing parameters from url if they exist
        return baseName.isEmpty() ? "" : baseName + "." + extension;
    } catch (NullPointerException npe) {
        return "";
    }
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-05-31T12:37:21.357

除了所有高级方法之外，我的简单技巧是`StringTokenizer`：

```
import java.util.ArrayList;
import java.util.StringTokenizer;

public class URLName {
    public static void main(String args[]){
        String url = "http://www.example.com/some/path/to/a/file.xml";
        StringTokenizer tokens = new StringTokenizer(url, "/");

        ArrayList<String> parts = new ArrayList<>();

        while(tokens.hasMoreTokens()){
            parts.add(tokens.nextToken());
        }
        String file = parts.get(parts.size() -1);
        int dot = file.indexOf(".");
        String fileName = file.substring(0, dot);
        System.out.println(fileName);
    }
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-09-04T12:08:49.630

如果您使用的是**Spring**，则有一个[帮助](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/util/UriComponentsBuilder.html)程序来处理 URI。这是解决方案：

```
List<String> pathSegments = UriComponentsBuilder.fromUriString(url).build().getPathSegments();
String filename = pathSegments.get(pathSegments.size()-1); 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2020-03-11T16:35:11.697

返回新文件(Uri.parse(url).getPath()).getName()

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2015-02-02T14:40:29.250

```
create a new file with string image path

    String imagePath;
    File test = new File(imagePath);
    test.getName();
    test.getPath();
    getExtension(test.getName());

    public static String getExtension(String uri) {
            if (uri == null) {
                return null;
            }

            int dot = uri.lastIndexOf(".");
            if (dot >= 0) {
                return uri.substring(dot);
            } else {
                // No extension.
                return "";
            }
        } 
```

* * *

## 回答 #26

> 赞同：-2
> 
> 时间：2019-02-11T02:48:38.133

我有同样的问题，和你的一样。我通过这个解决了它：

```
var URL = window.location.pathname; // Gets page name
var page = URL.substring(URL.lastIndexOf('/') + 1); 
console.info(page) 
```

* * *

## 回答 #27

> 赞同：-3
> 
> 时间：2009-03-03T10:13:02.363

导入java.io.*；

```
import java.net.*;

public class ConvertURLToFileName{

   public static void main(String[] args)throws IOException{
   BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
   System.out.print("Please enter the URL : ");

   String str = in.readLine();

   try{

     URL url = new URL(str);

     System.out.println("File : "+ url.getFile());
     System.out.println("Converting process Successfully");

   }  
   catch (MalformedURLException me){

      System.out.println("Converting process error");

 } 
```

我希望这能帮到您。

# c# - 优化 Web 服务客户端性能？

> ID：605702
> 
> 赞同：0
> 
> 时间：2009-03-03T09:25:46.377
> 
> 标签：c#, asp.net, performance, service

我正在为 ASP.Net asmx Web 服务使用自动生成的代理。我发现将 HttpWebRequest 发送到我的 Web 服务器时，客户端的吞吐量非常好（非常大）。但是当使用自动生成器代理时，它很慢。我想知道一些优化客户端性能的一般方法，尤其是增加吞吐量。如果可以通过在服务器端更改一些配置来改进它，那也很棒！

顺便说一句：我正在使用 ASP.Net Web 服务的 Web 方法的异步方法调用。

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T09:29:11.877

提高代理类构建速度的最佳方法是在`XmlSerializers`您的二进制文件中发布一个程序集。如果您在项目属性中选择，则它由 Visual Studio 生成，也可以由.NET 附带的[`sgen.exe`工具手动生成。](http://msdn.microsoft.com/en-us/library/bk3w6240(VS.80).aspx)

# sql - 奇怪的 SQL 2000 查询性能问题

> ID：605705
> 
> 赞同：1
> 
> 时间：2009-03-03T09:26:43.533
> 
> 标签：sql, sql-server, performance

在一些 SQL 查询性能调整中，我注意到以下查询运行缓慢，但它并没有破坏 CPU，而且似乎没有其他系统瓶颈导致它运行缓慢。事实上，它运行时的 CPU 平均值为 15%：

**更新：** 有问题的查询在包含 800 条记录的游标循环中运行：

```
cursor = SELCT DISTINCT param1,param2, param3, param4 
    FROM t_Table 
    GROUP BY param1,param2, param3, param4 
    ORDER BY param1,param2, param3, param4 DESC 

cursor loop:
  SELECT @maxval1 = max(iField1), 
    @maxval2 = max(iField2), 
    @dtDateMin = Min(dtDate),
    @dtDateMax = Max(dtDate) 
  FROM t_Table 
  WHERE iSomeField1 = @param1 
    AND iSomeField2 = @param2 
    AND iSomeField3 = @param3 
    AND iSomeField4 = @param4
next 
```

（注意：iSomeField1-4 有索引设置）

然后，我将单个最小/最大部分分解为四个查询，以查看服务器如何响应并在 CPU 达到 100% 峰值时获得全吞吐量，并且块在 2 秒内运行，而不是上面的 > 5 分钟。虽然我确实对性能提升感到满意，但我希望一些聪明的 DBA 来解释为什么会这样，以及他们可以对这些类型的查询提供哪些其他提示？

```
SELECT TOP 1 @maxval1 = iField1 
FROM t_Table 
WHERE iSomeField1 = @param1 
  AND iSomeField2 = @param2 
  AND iSomeField3 = @param3 
  AND iSomeField4 = @param4 
ORDER BY field1 DESC

SELECT TOP 1 @maxval2 = iField2 
FROM t_Table 
WHERE iSomeField1 = @param1 
  AND iSomeField2 = @param2 
  AND iSomeField3 = @param3 
  AND iSomeField4 = @param4 
ORDER BY field2 DESC

SELECT TOP 1 @dtDateMin = dtDate 
FROM t_Table 
WHERE iSomeField1 = @param1 
  AND iSomeField2 = @param2 
  AND iSomeField3 = @param3 
  AND iSomeField4 = @param4 
ORDER BY dtDate ASC

SELECT TOP 1 @dtDateMax = dtDate 
FROM t_Table 
WHERE iSomeField1 = @param1 
  AND iSomeField2 = @param2 
  AND iSomeField3 = @param3 
  AND iSomeField4 = @param4 
ORDER BY dtDate DESC 
```

请注意，我是一名开发人员，而不是 DBA，但想更多地了解 SQL Server 如何在上述查询的幕后工作。为了补充下面的一些答案，我知道并且确实使用查询执行计划器来分析性能问题，令我困惑的是，尽管表上有索引，但为什么第一个查询在 SQL 服务器上表现不佳。

更新：查询 1 对查询 2+ 的 CPU 使用率截图在游标循环中运行：

[查询 1 和查询 2 的 CPU 使用率 http://img22.imageshack.us/img22/3262/sqlperfodd.png](http://img22.imageshack.us/img22/3262/sqlperfodd.png) [查询 1 EP http://img513.imageshack.us/img513/5681/query1.png](http://img513.imageshack.us/img513/5681/query1.png) [查询 2 EP http: //img365.imageshack.us/img365/9715/query2.png](http://img365.imageshack.us/img365/9715/query2.png)

架构如下所示（这是我们真实表的缩减版本，但我们使用的是结构和索引）。

```
CREATE TABLE [dbo].[t_Table] (
[ID] [int] IDENTITY (1, 1) NOT NULL ,
[dtDate] [datetime] NULL ,
[iField1] [int] NULL ,[iField2] [int] NULL ,
[iSomeField1] [int] NULL ,[iSomeField2] [int] NULL ,
[iSomeField3] [int] NULL ,[iSomeField4] [int] NULL) ON [PRIMARY]

CREATE  CLUSTERED  INDEX [IX_dtDate] ON [dbo].[t_Table]([dtDate], [iField1],
[iSomeField1]) WITH  FILLFACTOR = 90 ON [PRIMARY]

ALTER TABLE [dbo].[t_Table] ADD 
CONSTRAINT [PK_t_Table] PRIMARY KEY  NONCLUSTERED 
([ID]) ON [PRIMARY] 

CREATE  INDEX [idx_field1234] ON [dbo].[t_Table]([iSomeField1], [iSomeField2],
[iSomeField3], [iSomeField4]) ON [PRIMARY]

CREATE  INDEX [idx_field1] ON [dbo].[t_Table]([iSomeField1]) [PRIMARY] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T10:26:00.693

I have had a look at your query and run some quick tests through it. As Diego mentioned, the execution plan in Query Analyzer is a great tool for troubleshooting this kind of thing.

First of all a note on indexes - when SQL recieves a query it will run through a series of steps - to simplify this process one of the main tasks here is to decide what is the most effecient way to retrieve the data. SQL will look at the table structure, statistics and indexes to determine what it believes will be the optimal path. It will ultimately choose one index to use to retrieve data (never multiple indexes).

The index is basically a lookup to where data is stored on the table (or in the case of the clustered index it actually defines HOW the data is stored on the disk). If your query is using a number of columns (either in the query, where or order clauses) then the query will need to retrieve these so that it can return your query. SQL will look at the index and then look at the order it needs to retrieve indexes in. Ideally SQL will be able to "seek" directly to the data you have requested (the most common alternative is a "scan", which basically means the entire index / structure has been scanned for the data). These terms are used in the above execution plan. There is a lot of additional complexity in the above (for example in some queries you may see bookmark lookups, where SQL uses an index to find the row and then perform a lookup to get any associated data) but that should be a good starting step.

As an aside here I will mention a site that i think is great for SQL performance info - www.sql-server-performance.com

Taking the above and applying to your information we can see that your main query is performing a clustered index "scan" - i.e. it searches the entire table to retrieve the information you requested. This means that no index was found that would allow it to directly seek to the information you required. To execute this query SQL would need to perform a filter on your fields 1 - 4, and then aggregate information (the MAX query) on the field and date columns.

As an extreme example, this index would allow a seek:

```
CREATE INDEX [idx_field1234567] ON [dbo].[t_Table](
   [iSomeField1], 
   [iSomeField2], 
   [iSomeField3], 
   [iSomeField4], 
   [dtDate], 
   [iField1],
   [iField2]
) 
WITH FILLFACTOR = 90, PAD_INDEX  ON [PRIMARY]

```

However you should note a lot goes into creating an index, and generally you should avoid adding too many columns to an index and you should avoid too many indexes on a table. In SQL 2000 the index tuning wizard is a good deal to provide a decent baseline of indexes.

As Diego said, the above may seem daunting but the site above was a great reference for me.

Good luck!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T10:39:01.350

It depends. What indexes are on the table? What volume of rows are within the table? I've just created a sample which performed well but it may be very different to your scenario. As a rule, if the optimizer has trouble then the query needs to be simplified. What you have done maybe what is required. It depends. Here's the SQL I knocked up to see if I could find anything obvious with the show execution plan on.

set nocount on

GO

if object_id('tempdb..#MaxMinExample')is not null drop table #MaxMinExample

GO

create table #MaxMinExample([key] int identity(1,1) primary key clustered,iField1 int,iField2 int,dtDate datetime,iSomeField1 int,iSomeField2 int,iSomeField3 int,iSomeField4 int)

GO

--initial data set which we'll cartesian

insert into #MaxMinExample(iField1 ,iField2 ,dtDate ,iSomeField1 ,iSomeField2 ,iSomeField3 ,iSomeField4 ) values (1,2,getdate(),1,2,3,4) insert into #MaxMinExample(iField1 ,iField2 ,dtDate ,iSomeField1 ,iSomeField2 ,iSomeField3 ,iSomeField4 ) values (2,3,getdate()+1,4,5,6,7) insert into #MaxMinExample(iField1 ,iField2 ,dtDate ,iSomeField1 ,iSomeField2 ,iSomeField3 ,iSomeField4 ) values (3,4,getdate()+2,5,6,7,8) insert into #MaxMinExample(iField1 ,iField2 ,dtDate ,iSomeField1 ,iSomeField2 ,iSomeField3 ,iSomeField4 ) values (5,6,getdate()+3,6,7,8,9) insert into #MaxMinExample(iField1 ,iField2 ,dtDate ,iSomeField1 ,iSomeField2 ,iSomeField3 ,iSomeField4 ) values (6,7,getdate()+4,7,8,9,10)

GO

--create loads of data

declare @count int set @count=1 while (select count(*) from #MaxMinExample)<865830 begin insert into #MaxMinExample(iField1 ,iField2 ,dtDate ,iSomeField1 ,iSomeField2 ,iSomeField3 ,iSomeField4 ) select a.iField1+@count ,a.iField2+@count ,a.dtDate+@count ,a.iSomeField1+@count ,a.iSomeField2+@count ,a.iSomeField3+@count ,a.iSomeField4+@count from #MaxMinExample a cross join #MaxMinExample b set @count=@count+1 end

GO

--create the indexes

create index MaxMinExample_iSomeField1 on #MaxMinExample(iSomeField1) create index MaxMinExample_iSomeField2 on #MaxMinExample(iSomeField2) create index MaxMinExample_iSomeField3 on #MaxMinExample(iSomeField3) create index MaxMinExample_iSomeField4 on #MaxMinExample(iSomeField4) create index MaxMinExample_dtDate on #MaxMinExample(dtDate)

GO

declare @maxval1 int,@maxval2 int,@dtDateMin datetime,@dtDateMax datetime,@param1 int,@param2 int,@param3 int,@param4 int

select @param1=4,@param2=5,@param3=6,@param4=7

select @maxval1 = max(iField1), @maxval2 = max(iField2), @dtDateMin = Min(dtDate),@dtDateMax = Max(dtDate) from #MaxMinExample where iSomeField1=@param1 and iSomeField2=@param2 and iSomeField3=@param3 and iSomeField4=@param4

select top 1 @maxval1 = iField1 from #MaxMinExample where iSomeField1=@param1 and iSomeField2=@param2 and iSomeField3=@param3 and iSomeField4=@param4 order by iField1 DESC select top 1 @maxval2 = iField2 from #MaxMinExample where iSomeField1=@param1 and iSomeField2=@param2 and iSomeField3=@param3 and iSomeField4=@param4 order by iField2 DESC select top 1 @dtDateMin = dtDate from #MaxMinExample where iSomeField1=@param1 and iSomeField2=@param2 and iSomeField3=@param3 and iSomeField4=@param4 order by dtDate ASC select top 1 @dtDateMax = dtDate from #MaxMinExample where iSomeField1=@param1 and iSomeField2=@param2 and iSomeField3=@param3 and iSomeField4=@param4 order by dtDate DESC

Mark Baekdal - www.dbghost.com - SQL Developer

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T09:39:52.350

不幸的是，您提供的信息不足以给您一个准确的答案，但我想我可以给您一个有用的提示。SQL Server 允许您查看它用于访问数据的查询计划；这样的计划会详细告诉您访问什么、何时、以何种方式以及在每个步骤中处理了多少行。它还告诉您每个步骤消耗了多少时间/资源，让您轻松找到瓶颈。

要在查询分析器中显示执行计划，请打开查询菜单并单击“显示执行计划”。然后运行您的第一个查询并检查计划；在另一个窗口中，运行第二个查询并再次检查计划。通过这种方式，您可以看到它们之间的区别、使用了哪些索引（如果有）并更好地了解 SQL Server。

一个提示：如果一开始一切看起来都很复杂，不要气馁，这只是慢慢来的问题。

最后，对于 SQL Server（当然 MSDN 除外）的一个有用资源是 www.sqlservercentral.com，您可以在其中找到用户和专家的答案。我希望这有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-18T11:23:53.840

最后，该项目移至基于 MicroStrategy 的新 DWH 和 BI 堆栈，因此这成为了一个问题，新的 DWH 具有不同的架构，并且在 SQL 2008 中完成（但我从未深入了解它：/）

# c# - 编译替换正则表达式

> ID：605712
> 
> 赞同：1
> 
> 时间：2009-03-03T09:28:28.507
> 
> 标签：c#, regex

我想构建一个我必须在我的项目中使用的常见正则表达式的正则表达式程序集。我使用这些正则表达式来匹配模式并替换它。我使用构建程序集的这段代码。

```
AssemblyName an = new AssemblyName("MyRegExp");

RegexCompilationInfo[] rciList = { 
    new RegexCompilationInfo(@"\<b\>(.+?)\<\/b\>", RegexOptions.IgnoreCase, "BoldCode", "MyRegExp", true),
    new RegexCompilationInfo(@"\<i\>(.+?)\<\/i\>", RegexOptions.IgnoreCase, "ItalicCode", "MyRegExp", true)
};

Regex.CompileToAssembly(rciList, an); 
```

但是，我找不到在哪里指定替换字符串。事实上，我会使用这些正则表达式来替换标签**在 html 文件中由 . 因此，替换字符串也是不变的。**

 **我不希望调用程序集指定替换字符串，因为它总是相同的，跨越不同的调用程序集。

在此先感谢您的任何建议，法比安

编辑1：

也许我误解了我需要做什么。我有几个正则表达式总是用相同的模式替换。我用字符串替换所有**字符串**，用字符串*替换*字符串，依此类推。

编译的正则表达式很棒，但我错过了编译程序集中的替换模式。我设法使用 Helper 类构建了一个解决方法，构建了一个转换数组。

我最初的问题更多的是：它是一种在编译的正则表达式中指定替换字符串的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T10:09:26.210

[.NET Reflector](http://www.red-gate.com/products/reflector/)对于这样的事情非常有帮助。看一下由`Regex.CompileToAssembly`

创建的类型派生自 Regex。因此，您可以像使用内联创建的 Regex 实例一样使用*它们*。

* * *

关于。编辑有问题：答案似乎是：无法在生成的程序集中包含指定的字符串。

但是，考虑到 using`CompileToAssembly`意味着一个多步骤的构建过程（创建程序集生成器，运行它以创建程序集，然后引用该程序集），可以扩展它以添加其他内容。创建正则表达式程序集，并创建一个替换字符串程序集，然后使用 ilmerge 将它们组合成一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T11:54:00.637

看起来“CompileToAssembly”方法不直接支持这一点，因此您必须找到其他方法将替换字符串与正则表达式相关联。如果要将替换字符串存储在生成的程序集中，那么我能想到的一个选项是在自定义属性中指定它（“CompileToAssembly”的第三个参数）。

我认为这会为程序集生成自定义属性（而不是单个正则表达式），但您可以例如使用类似的东西（注意：您必须自己声明此属性）：

```
[RegexReplaceString("RegexName", "Replacement")] 
```

当使用从您的应用程序生成的 DLL 时，您必须添加一些处理来加载替换字符串并将其与已编译的 Regex 对象一起存储在某个类中。这看起来有点困难，但至少，如果这是您的目标，它可以让您将替换字符串存储在生成的 DLL 中。

# cocoa - 绑定自定义 NSView：是否需要创建 IBPlugin？

> ID：605721
> 
> 赞同：14
> 
> 时间：2009-03-03T09:31:27.643
> 
> 标签：cocoa, interface-builder, cocoa-bindings, nsview, ibplugin

我创建了一个 NSView 的子类来将图像绘制为模式：

```
@interface CePatternView : NSView
{
    NSImage*    image;
    id      observableObjectForImage;
    NSString*   keyPathForImage;
}

@end 
```

我实现了以下内容来公开绑定：

```
+ (void)initialize
{
    // Expose the "image" binding to IB.
    [self exposeBinding:@"image"];  
}

- (Class)valueClassForBinding:(NSString *)binding
{
    if([binding isEqualToString:@"image"])
        return [NSImage class];
    return nil; // Unknown binding
} 
```

不幸的是，*图像*绑定没有显示在 Interface Builder 中。

**我真的必须创建一个 IBPlugin 才能在 Interface Builder 中公开绑定吗？**对于我不打算重用的自定义视图来说，这似乎有点过头了。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-03T19:59:23.623

对标题的回答：不，您可以在没有 IB 插件的情况下绑定自定义视图（通过在代码中进行）。
对问题正文的回答：是的，您确实需要一个 IB 插件来公开 IB 中的绑定。

除非您将代码放入 Interface Builder 中，否则您的代码不会在 Interface Builder 中运行，并且该`exposeBinding:`消息就是您的代码。因此，您需要将其放入 Interface Builder 中。这意味着编写一个 IB 插件。

此外，IB 插件与旧的 IB 调色板不同。插件需要 IB 3 并且更容易创建。调色板需要 IB 2 并且创建起来很痛苦。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-25T03:27:42.277

我只是使用不同的标准绑定（例如 toolTip）将我的控制器对象绑定到我的视图对象，然后使用文本编辑器编辑 XIB 文件并手动更改 XML。

此后，绑定可以正常工作，甚至可以正确显示在 Interface Builder 中以启动！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T14:33:07.417

不，您可以使用该方法

`bind:toObject:withKeyPath:options:`

以编程方式建立绑定。我相信您确实必须创建一个 IB 调色板才能让绑定出现在 Interface Builder 中，但是对于我不打算重用的一次性类，我从来没有打扰过。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T16:46:58.360

如果您可以设法手动进行绑定，您将节省大量时间。与几行手动绑定代码相比，创建自定义 IB 调色板需要大量工作。但是，如果您的需求需要自定义 IB 调色板，那么我将首先查看 NSView 子类将需要什么，以编码方式进行。一个很好的起点是 Crawford 的绑定网站：

[http://homepage.mac.com/mmalc/CocoaExamples/controllers.html](http://homepage.mac.com/mmalc/CocoaExamples/controllers.html)

在过去的几年里，我经常使用它，它对我的​​自定义 IB 调色板对象和一般的绑定问题有很大帮助。在他的网站上有一个示例，专门详细说明了带有自定义绑定的自定义 NSView。

还有一点需要注意的是，您的自定义视图也必须在 Interface Builder 环境中工作。需要在自定义 NSView 对象的绑定代码中进行一些小修复，以便它在 Interface Builder 中正常运行和绑定。这些细节也在 Crawford 的网站上注明：

[http://homepage.mac.com/mmalc/CocoaExamples/controllers.html#ibBindings](http://homepage.mac.com/mmalc/CocoaExamples/controllers.html#ibBindings)

# .net - 如何使用存根对象对刷新功能进行单元测试

> ID：605726
> 
> 赞同：0
> 
> 时间：2009-03-03T09:32:06.813
> 
> 标签：.net, unit-testing

我正在做一个单元测试，它执行一些业务逻辑，最终会导致数据的刷新（所以再次执行相同的查询）。

使用依赖注入（使用 Castle-Windsor），单元测试使用存根对象，因此从获取数据的方法返回实体的静态列表。

那么如何测试这个方法是否被再次调用呢？

我在其中一个实体中滥用了日期时间字段来测试第二次获取（刷新后的日期时间！= 刷新前），但我认为这并不是一个好的解决方案。

有人可以为此提供一个优雅的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T09:50:55.910

问题“那么我怎样才能测试这个方法是否被再次调用？” 听起来您真的想要*模拟*而不是*存根*-您正在测试*协议*，而不仅仅是要返回一组静态数据。我个人喜欢[Rhino.Mocks](http://ayende.com/projects/rhino-mocks.aspx)库。

# bind - jQuery 将多个函数绑定到一个元素

> ID：605734
> 
> 赞同：1
> 
> 时间：2009-03-03T09:34:10.723
> 
> 标签：bind, jquery, jquery-1.3.2

奇怪，有没有可能在一个元素上在 jquery 中放置多个绑定？

```
$('input').click(clickfn).click(clickfn) 
```

我正在使用 1.3.2

```
function clickme() { alert('click me') }

$('.click', mod).bind("brrr", clickme).bind("brrr", clickme)
                .click(function() { $('.click', mod).trigger("brrr"); }); 
```

这也行不通。执行一次。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T09:49:32.060

你所拥有的应该可以正常工作……它对我有用（也适用于 jQuery 1.3.2）。试试这个：

```
$('input').click(function(ev){ alert('func 1'); }).click(function(ev){ alert('func 2'); }); 
```

当您单击`input`元素时，您应该会看到出现连续的警报。也许您`false`在第一个函数中返回？这将停止事件传播，因此不会触发第二个处理程序。

顺便说一句，我看到您正在对`input`元素执行此操作，因此您可能希望使用[`focus`](http://docs.jquery.com/Events/focus#fn)事件而不是`click`.

# asp.net - 打开一个下拉菜单，然后更改默认值

> ID：605739
> 
> 赞同：0
> 
> 时间：2009-03-03T09:34:59.380
> 
> 标签：asp.net

如果我有一个下拉框，我怎样才能有一个默认选择（知道如何执行此操作），它会在打开下拉列表时更改为下拉列表中的另一个成员？

例如：我的下拉菜单有 2 个值 - “Hello”和“Hello Back”。“Hello”是默认值（0），但是当下拉框打开时如何显示“Hello Back”？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T09:48:27.447

您可以通过将 Hello Back 的值或 Text 作为参数来使用 Dropdownlist 的 findbyvalue 或 findbytext 方法。例如，您可以这样做。

dropdownlist1.items.findbytext("Hello Back").selected=true

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T09:48:40.907

您将需要使用 javascript 来实现这样的东西。根据您的要求，一个基本示例是：

```
<script type="text/javascript">
function selectOption()
{
    var thisDLL = document.getElementById("myDDL").options[1].selected = "true";
}
<select id="myDDL" name="myDDL" onclick="javascript:selectOption();">
   <option value="Hello" selected="true" >Hello</option>
   <option value="Hello back" selected="true">Hello back</option>
</select> 
```

或者，您可以使用 onFocus 事件触发该事件。

编辑：修复了javascript中的错误

# flash - Flash 9：如何确定流媒体轨道是否为单声道？

> ID：605748
> 
> 赞同：0
> 
> 时间：2009-03-03T09:38:45.190
> 
> 标签：flash, audio, streaming, mp3

几个月来我一直试图解决这个问题......在 Flash 9 中，我试图加载一个流式 MP3 文件并计算它的轨道长度。我可以做到这一点，但是当 mp3 的通道是单声道时，时间是原始音轨长度的两倍。我是怎么想出来的？好吧，我通过在 Windows 上录制到 Sound Recorder 来测试我的播放器，但幸运的是，我忘了用立体声录制 MP3。

现在，在 Flash 中，我尝试使用加载的字节数、总字节数、播放位置和所有您可能想到的公式来计算持续时间。数学很好。问题是当 Flash 加载 mp3 时，它会自动假定文件是立体声的。因此，当它加载数据时，它会继续并将其认为拥有的字节量加倍，因为它识别出一个特定大小的通道，然后将其加倍以获得立体声。这会产生负载大小的错误值，通过正确的数学运算，仍然会使轨道长度加倍。这就是为什么单声道不适用于我们使用的常用公式。

为了解决这个问题，我需要一种方法来确定文件是单声道还是立体声。不，ID3 数据也返回错误值，我已经尝试使用 soundTransform.leftToLeft、soundTransform.leftToRight、soundTransform.rightToLeft 和 soundTransform.rightToRight 手动确定（它返回立体声值）。

我不知道有什么方法可以让 Flash 正确地告诉你文件有哪些音频通道。我希望我只是忽略了一些东西，任何帮助或故障排除提示，无论我是否已经尝试过，都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T09:41:17.960

你确定ID3是正确的？
我有几个 mp3 报告长度错误，不是因为立体声/单声道问题，而是因为标头损坏。

# java - 同一个tomcat实例中的多个webapp如何共享数据库连接池？

> ID：605749
> 
> 赞同：1
> 
> 时间：2009-03-03T09:39:02.477
> 
> 标签：java, hibernate, tomcat, saas, multi-tenant

请记住，每个 webapp 都有自己独立的数据库（但所有数据库都在同一个数据库服务器中）。

场景是我有一个多租户 saas 应用程序 - 我为每个客户部署相同的应用程序。每个客户都在一个名为 的数据库上工作`db_cid`，其中`cid`是客户 ID，即唯一的客户标识符。

使用休眠模式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T10:15:47.787

如果您需要在 Web 应用程序之间共享资源，则必须让 Web 容器管理它们，并将它们放在 JNDI 中。然后，Web 应用程序可以非常轻松地从 JNDI 上下文中获取资源。

JDBC 连接池非常典型，因此每个 Web 容器都记录了如何设置它们。

对于独立程序，我们使用 Simple JNDI [http://www.osjava.org/simple-jndi/](http://www.osjava.org/simple-jndi/)，它提供了外部配置，允许我们将代码库与配置完全分离。

试试看，你会喜欢的：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T10:10:20.840

您是否考虑过在 tomcat（全局）上下文中配置 JNDI 连接？它可以是一个池连接，如[JNDI 数据源示例](http://www.mbaworld.com/docs/jndi-datasource-examples-howto.html)中所述。

# sql - 在数据库中搜索和替换部分字符串

> ID：605768
> 
> 赞同：68
> 
> 时间：2009-03-03T09:45:21.120
> 
> 标签：sql, sql-server, tsql

我需要替换所有 iframe 标签，在我的数据库中存储为 nvarchar。我可以使用以下 sql 问题找到条目：

```
SELECT * FROM databasename..VersionedFields WHERE Value LIKE '%<iframe%' 
```

假设我要替换以下代码段：

```
code before iframe <iframe src="yadayada"> </iframe> code after iframe 
```

有了这个：

```
code before iframe <a>iframe src="yadayada"</a> code after iframe 
```

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2009-03-03T10:00:14.623

您可以使用 UPDATE 语句使用 REPLACE 设置值来执行此操作

```
UPDATE
    Table
SET
    Column = Replace(Column, 'find value', 'replacement value')
WHERE
    xxx 
```

执行此操作时您需要非常小心！我强烈建议先进行备份。

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2009-03-03T10:01:11.207

我认为 2 更新电话应该做

```
update VersionedFields
set Value = replace(value,'<iframe','<a><iframe')

update VersionedFields
set Value = replace(value,'> </iframe>','</a>') 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-03T13:15:45.963

```
update VersionedFields
set Value = replace(replace(value,'<iframe','<a>iframe'), '> </iframe>','</a>') 
```

你一次性完成。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-13T03:37:43.200

我刚刚遇到了类似的问题。我将 db 的内容导出到一个 sql 文件中，并使用 TextEdit 查找和替换我需要的所有内容。简单ftw！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T09:54:54.403

我会考虑为这种字符串操作编写一个带有 RegEx 支持的 CLR 替换函数。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-07-28T13:19:16.943

更新数据库并设置 fieldName=Replace (fieldName,'FindString','ReplaceString')

# javascript - 使用javascript拖放多个项目以及ID

> ID：605773
> 
> 赞同：0
> 
> 时间：2009-03-03T09:47:13.563
> 
> 标签：javascript, drag-and-drop

我需要一个 javascript 来拖放多个项目以及项目 ID 和项目所在的 ID。它应该同时支持 IE 和 Mozilla。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T10:06:33.360

You can also do it with JQuery. I'd never used JQuery before, and I needed a drag-and-drop functionality. It didn't take long to figure out how to use it.

You'll need to install [JQuery](http://www.jquery.com) and also [JQuery UI](http://jqueryui.com/) and then use the [Draggable](http://docs.jquery.com/UI/API/1.7/Draggable) and [Droppable](http://docs.jquery.com/UI/API/1.7/Droppable) plugins.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T10:02:27.270

这可能会有所帮助，一个非常好的免费库：[Drag & Drop for Images and Layers](http://www.walterzorn.com/dragdrop/dragdrop_e.htm)

但是您应该实现自己的逻辑来支持丢弃的项目。

# sql - 交换 ms-sql 表

> ID：605774
> 
> 赞同：19
> 
> 时间：2009-03-03T09:47:29.710
> 
> 标签：sql, swap

我想以最好的方式换到桌子。
我有一个 IpToCountry 表，我每周根据我导入的外部 CSV 文件创建一个新表。

我发现进行切换的最快方法是执行以下操作：

```
sp_rename IpToCountry IpToCountryOld
go
sp_rename IpToCountryNew IpToCountry
go 
```

这样做的问题是表可能仍然在两者之间被访问。
如何在 SQL 中解决这个问题？
在考虑使用 sp_getapplock 和 sp_releaseapplock，但我想尽可能快地保持从表中读取的功能。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-03T11:36:40.213

假设您无法更新/插入现有表，为什么不使用[视图](http://msdn.microsoft.com/en-us/library/ms187956.aspx)包装对表的所有访问？

例如，您可能最初将数据存储在名为*IpToCountry20090303*的表中，您的视图将如下所示：

```
CREATE VIEW IpToCountry
AS
SELECT * FROM IpToCountry20090303 
```

当新数据进来时，您可以创建并填充*IpToCountry20090310*表。填充表格后，只需更新您的视图：

```
ALTER VIEW IpToCountry
AS
SELECT * FROM IpToCountry20090310 
```

切换将是完全原子的，不需要任何显式锁定或事务。视图更新后，您可以简单地删除旧表（如果您愿意，也可以保留它）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-03-11T15:53:42.240

我在让分区功能大规模工作时遇到了问题。CREATE 和 DROP PARTITION 是阻塞操作，您对阻塞几乎没有控制权，如果它无法获得锁，它将以严重级别 16 失败并终止您的连接——如果不重新建立，您将无法捕获并重试连接。但它可能对你有用。此外，需要 MSS 企业版，您不能使用 SE——对于一些规模较小或成本较高的商店来说可能太多了。

我还发现视图 redef 会在 sys 表和对象上以大规模（= 事务量 + 不断插入的数据的绝对量）阻塞 sys 表和对象，因此这些操作可能会在诸如重新索引和 DTCC 之类的事情上死锁——在一种情况下，特别是 SSMS 中的用户（所有事物）试图在对象资源管理器中浏览视图（有人需要告诉那些人有关 READPAST 的信息）。同样，您的里程可能会有所不同。

相比之下， sp_rename 在规模上对我来说效果很好：它使您可以控制锁定及其范围。要在交换之前解决阻塞问题，请尝试如下所示。从表面上看，这似乎在大批量时具有相同的规模问题......但我在实践中没有看到它。所以，为我工作......但同样，每个人的需求和经历都是不同的。

```
DECLARE @dummylock bit 
BEGIN TRANSACTION 
BEGIN TRY
   -- necessary to obtain exclusive lock on the table prior to swapping
   SELECT @dummylock = 1 WHERE EXISTS (SELECT 1 FROM A WITH (TABLOCKX))
   -- may or may not be necessary in your case
   SELECT @dummylock = 1 WHERE EXISTS (SELECT 1 FROM B WITH (TABLOCKX))
   exec sp_rename 'A', 'TEMP'
   exec sp_rename 'B', 'A'
   exec sp_rename 'TEMP', 'B'
   COMMIT TRANSACTION
END TRY
BEGIN CATCH
   -- other error handling here if needed
   ROLLBACK TRANSACTION 
END CATCH 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T12:34:22.100

另一种实现您希望实现的方法是使用表分区，这是一种在 SQL Server 企业版中可用的技术。

表名可以保持不变。表导入完成后，您只需简单地切换包含旧数据的分区并切换到新分区。

以下白皮书包含您入门所需的所有信息。

[http://msdn.microsoft.com/en-us/library/ms345146.aspx](http://msdn.microsoft.com/en-us/library/ms345146.aspx)

干杯，约翰

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T09:57:33.383

IpToCountryOld 会发生什么？你把它扔掉吗？在这种情况下，为什么不截断 IpToCountry 并导入我的新数据。

如果您需要保留数据，如何将加载日期存储在表上并将“当前”加载日期存储在某个地方以在 WHERE 子句中使用？然后在数据成功加载时切换当前日期。

你没有说你使用的是哪个数据库，所以我不知道它有多大用处，但是你有任何引用该表的存储过程吗？请注意，在某些平台上，SP 是使用对不会随重命名而更改的表的内部引用进行编译的，因此存在 SP 在不重新编译的情况下不会获取新数据的风险。视图和存储的解析查询也是如此。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T10:31:29.527

你不能在下班时间不导入一张桌子吗？

或者为什么不只是进行数据更新，即更新现有记录并在循环导入数据时逐条记录添加任何新记录。这将使表保持活动状态并减少添加和删除完整表的整体影响。

被导入的数据是什么结构，表格设计，格式，PK等？由此我们或许可以给你一个更好的答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-13T19:47:37.693

刚刚在一个临时表上遇到了类似的问题，该表在使用适当的锁进行缩放时遇到了问题。

在引用您的表的任何地方，您都可以调用一个存储过程来询问表名。

存储过程可以根据提供的参数选择创建新表或返回旧表。

# emacs - 如何获取 Emacs lisp 非交互式函数的列表？

> ID：605785
> 
> 赞同：14
> 
> 时间：2009-03-03T09:49:53.090
> 
> 标签：emacs, function, lisp

如何获得可以在 Emacs Lisp 中使用的非交互式函数的完整列表？

交互式功能很容易在帮助系统中找到，但我想要一份我可以使用的所有其他功能的完整列表。例如`concat`, `car`,`cdr`等（最好有文档）。

谢谢

埃德

编辑：感谢 Jouni。我玩弄了他的答案，并让它对结果进行排序（使用他的代码结果来帮助我找到正确的排序函数！）

```
(flet ((first-line (text)
                   (if text
                       (substring text 0 (string-match "\n" text))
                     "")))
  (let ((funclist (list)))
    (mapatoms 
     (lambda (x)
       (and (fboundp x)                     ; does x name a function?
            (not (commandp (symbol-function x))) ; is it non-interactive?
            (subrp (symbol-function x))          ; is it built-in?
            (add-to-list 'funclist 
                         (concat (symbol-name x) " - " (first-line (documentation x))
                                 "\n")))))
    (dolist (item (sort funclist 'string<))
      (insert item)))) 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-03T12:50:56.727

这是基本思想 - 任何不清楚的概念请参阅[Emacs Lisp 手册](http://www.gnu.org/software/emacs/manual/elisp.html)。

```
(flet ((first-line (text)
         (if text
             (substring text 0 (string-match "\n" text))
           "")))
  (mapatoms 
   (lambda (x)
     (and (fboundp x)                          ; does x name a function?
          (not (commandp (symbol-function x))) ; is it non-interactive?
          (subrp (symbol-function x))          ; is it built-in?
          (insert (symbol-name x) " - " (first-line (documentation x)) "\n"))))) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-09-05T22:11:57.057

尝试`apropos`代替`apropos-command`. 这将为您提供所有功能，而不仅仅是交互式功能。`C-h a`默认情况下绑定到后者，但是如果您正在做很多 elisp hacking，我建议将其绑定到前者。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T10:18:08.527

您可以检查 obarray 的内容，尽管它包含所有符号，而不是“所有函数”。

或者，以下方法可以解决问题（将引入部分 CL 兼容性包）：

> (reduce (lambda (so-far next) (if (fboundp next) (cons next so-far) so-far)) obarray :initial-value nil)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T09:57:14.583

尝试使用空输入的 apropos 命令。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T10:00:19.443

没关系。事实证明，Ch f（描述函数）确实包含非交互式函数，尽管我仍然有兴趣找到一种仅查看/搜索非交互式函数（尤其是仅内置函数）的方法。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-03T09:54:19.350

你可以做的比[看网站更糟糕](http://www.gnu.org/software/emacs/manual/elisp.html)

# javascript - 如何在同一张地图上使用带有多个标记的谷歌地图 API

> ID：605786
> 
> 赞同：10
> 
> 时间：2009-03-03T09:49:56.270
> 
> 标签：javascript, asp.net, google-maps, google-maps-api-2

所以，我有以下脚本来使用谷歌地图 API，一切都很好，但我需要创建一个具有多个标记的地图（指向某物的气球形图标），我需要每个标记都指向地图的不同区域（即不同的坐标），我该怎么做？

```
<script type="text/javascript">

         function load() {

        var map = new GMap2(document.getElementById("map"));
        var marker = new GMarker(new GLatLng(<%=coordinates%>));

        var html="<img src='simplemap_logo.jpg' width='20' height='20'/> " +
             "<%=maptitle%><br/>" +
             "<%=text%>";

        map.setCenter(new GLatLng(<%=coordinates%>), <%=zoom%>)
        map.setMapType(G_HYBRID_MAP);
        map.addOverlay(marker);
        map.addControl(new GLargeMapControl());
        map.addControl(new GScaleControl());
        map.addControl(new GMapTypeControl());

        marker.openInfoWindowHtml(html);
        }

        //]]>
        </script> 
```

还有一个问题，如果我将脚本文本作为变量传递，让我们说一下：

```
<script type="text/javascript">
<%=ScriptText%>
</script> 
```

我的 <%=ScriptText%> 将是一个字符串，我将构建它并将其值分配给一个名为 ScriptText 的 Friend 或公共变量，它还能正常运行和工作吗？（我这样做是为了使我的脚本动态化并且根据我如何将其构建为字符串而有所不同，因为我在 javascripting 方面是文盲；P）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-31T06:06:40.427

obeattie 和 gregers 都是对的。通常，您需要将标记参数存储在某种数组中，以后您将至少使用两次：

1.  将叠加层添加到地图时
2.  将其添加到 GLatLngBounds 对象以计算中心点和缩放级别时

数组或标记看起来像一个对象数组，例如：

```
var latlng1 = [
    new GLatLng( 48.1234, -120.1234 ),
    new GLatLng( 48.5678, -120.5678 ),
    new GLatLng( 48.9101, -120.9112 ),
    new GLatLng( 48.1121, -120.1314 ),
    new GLatLng( 48.3145, -120.1516 ),
    new GLatLng( 48.1617, -120.1718 ),
    new GLatLng( 48.1819, -120.1920 ),
    new GLatLng( 48.2021, -120.2122 )
]; 
```

添加标记的代码类似于：

```
 // assume that map1 is an instance of a GMap2 object

  // #0 -- google maps api requires us to call setCenter first before calling any other operation on the map
  map1.setCenter( new GLatLng( 0, 0 ), 0 );

  // #1 -- add markers
  for ( var i = 0; i < latlng1.length; i++ )
  {
    var marker = new GMarker( latlng1[ i ] );
    map1.addOverlay( marker );
  }

  // #2a -- calculate center
  var latlngbounds = new GLatLngBounds( );
  for ( var i = 0; i < latlng1.length; i++ )
  {
    latlngbounds.extend( latlng1[ i ] );
  }

  // #2b -- set center using the calculated values
  map1.setCenter( latlngbounds.getCenter( ), map1.getBoundsZoomLevel( latlngbounds ) ); 
```

至于您关于在客户端 javascript 中使用服务器端脚本的问题，是的，您可以将它们混合在一起。从你的描述来看，我认为这是你需要做的：

```
<script type="text/javascript">
    var latlng1 = new Array( );
</script>
<script type="text/javascript">
    <%
        do until rs.eof
            %>
            latlng1.push( new GLatLng( parseFloat( '<%= rs( "Lat" ) %>' ), parseFloat( '<%= rs( "Lng" ) %>' ) ) );
            <%
            rs.movenext
        loop
    %>
</script> 
```

我在以下位置发表了一篇文章：[http ://salman-w.blogspot.com/2009/03/zoom-to-fit-all-markers-polylines-or.html](http://salman-w.blogspot.com/2009/03/zoom-to-fit-all-markers-polylines-or.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T10:09:18.440

您需要为[`GMarker`](http://code.google.com/apis/maps/documentation/reference.html#GMarker)要在地图上标记的每个地点创建一个新的。[这里](http://code.google.com/apis/maps/documentation/overlays.html#Markers)有相当不错的`GMarker`s文档。

要创建一个`GMarker`，您将从文档中看到您首先需要创建一个`GLatLng`表示要放置标记的位置。您没有提到想要气球中的任何内容，所以我假设它只是您所追求的标记。在您的情况下，代码可能如下所示：

```
var markerCoords = [
    new GLatLng(<latitude>, <longitude>),
    new GLatLng(<latitude>, <longitude>),
    [...]
];

for (coord in markerCoords){
    map.addOverlay(new GMarker(coord));
}; 
```

我相信您可能可以确切地知道这里发生了什么，但以防万一，我创建了一个`GLatLng`对象数组（这可以是任何长度[在界限内哈哈]），然后对其进行迭代，向地图添加标记对于`GLatLng`数组中定义的每个。

如果您计划创建大量标记，您可能会发现使用[Marker Manager](http://code.google.com/apis/maps/documentation/overlays.html#Marker_Manager)很有用，这将加速同时渲染大量标记（通过不渲染屏幕外标记并压缩屏幕上的标记（如果有）在屏幕的一个区域中有很多）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T12:44:45.430

obeattie 很好地回答了你的问题。但从您的示例代码来看，您似乎还希望地图缩放到包含标记的区域。要使用多个标记执行此操作，您可以创建为每个标记扩展的[GLatLngBounds 。](http://code.google.com/apis/maps/documentation/reference.html#GLatLngBounds)然后，您可以从边界对象中获取适合您的标记集合的中心和缩放。

`var markersBounds = GLatLngBounds(); var coord = null; for (coord in markerCoords){ coord = new GMarker(coord); map.addOverlay(); markersBounds.extend(coord); };`

 ````
var markersCenter = markersBounds.getCenter();
var markersZoom = G_HYBRID_MAP.getBoundsZoomLevel(markersBounds);

map.setCenter(markersCenter, markersZoom); 
````  `我不是 100% 确定 G_HYBRID_MAP。[getBoundsZoomLevel](http://code.google.com/apis/maps/documentation/reference.html#GMapType.getBoundsZoomLevel)，但如果我没记错的话， G_HYBRID_MAP 是[GMapType](http://code.google.com/apis/maps/documentation/reference.html#GMapType)的一个实例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-11T13:19:16.383

我有类似的东西，但事件不起作用。我可以在对象的构造函数中添加侦听器吗？

```
//Localization object onstructor
function Localization(width, height, description, img_source){
    this.point = new GLatLng(width, height);
    this.marker = new GMarker(this.point);
    this.description = description;
    this.img_source = img_source;
    GEvent.addListener(this.marker, "click", function(){marker.openInfoWindowHtml(this.description);});
}

//map localizations to show on map
var localizations = [
    new Localization( 52.9015797, 15.2602200, 'Poznań1', 'eye1' ),
    new Localization( 52.9025797, 15.1602200, 'Poznań2', 'eye2' ),
    new Localization( 52.9035797, 15.2702200, 'Poznań3', 'eye3' ),
    new Localization( 52.9045797, 15.2102200, 'Poznań4', 'eye4' ),
]

var map = new GMap2(document.getElementById("mapa"));
map.setCenter(localizations[3].point, 13);
map.setUIToDefault();

for(i=0; i < localizations.length; i++){
    localization=localizations[i];
    map.addOverlay(localization.marker);
    localization.marker.openInfoWindowHtml(localization.description);
} 
```

# c# - 为什么 Winforms 中有这么多不同的集合？

> ID：605788
> 
> 赞同：2
> 
> 时间：2009-03-03T09:51:47.547
> 
> 标签：c#, winforms

如果我想在组合框中显示 10 000 个项目（只是一个示例），从磁盘加载列表很快，但是当我设置数据源时它很慢。有没有办法只指向数据而不将其转换为组合框集合。

```
List<string> myitems = getItems();

ComboBox box = new ComboBox();
box.DataSource = myitems;        // <--- Takes a long time 
```

来自德尔福，一切都是 StringList，我发现所有不同的集合有点奇怪，为什么他们不直接使用`List<T>`或其他一些与控件不紧密耦合的类？

在德尔福：

```
textbox.lines = myitems
listbox.items = myitems
combobox.items = myitems 
```

all 只是设置一个指向相同数据的指针，即即时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T10:25:44.533

The underlying Windows combo control (like several others) can operate in "virtual" mode where it is populated on demand, not needing to pre-load a large number of items. This saves both memory and time, and allows extremely long content lists.

Unfortunately the native WinForm controls don't seem to support this mode of operation, but maybe a different wrapper is available?

# c# - 实体框架和 VARBINARY

> ID：605790
> 
> 赞同：7
> 
> 时间：2009-03-03T09:52:14.113
> 
> 标签：c#, asp.net, sql-server-2005, entity-framework

我正在使用 .NET 实体框架，并且我有一个包含 varbinary 的实体。在从数据库中检索到 varbinary 之后，是否有一种简单的方法可以在代码隐藏中获取它的大小？

我在想可能有某种方法可以直接从实体中获取大小，例如 entity.Context.Size - 或者是否需要以不同的方式处理它？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-07-21T11:37:15.443

A`varbinary`转换为`byte[]`Entity Framework 中的字段，这意味着您可以检查数组的**Length**属性：

```
int fieldSize = entity.MyVarBinaryField.Length; 
```

正如[tster 所说](https://stackoverflow.com/a/5409481/137471)：在 LINQ to Entities 查询中，您可以调用[SqlFunctions类的](http://msdn.microsoft.com/en-us/library/dd466188.aspx)[DataLength](http://msdn.microsoft.com/en-us/library/system.data.objects.sqlclient.sqlfunctions.datalength.aspx)方法，该方法将转换为生成的 SQL 语句中的[DATALENGTH](http://msdn.microsoft.com/en-us/library/ms173486.aspx)函数调用。这仅适用于 SQL Server 和 Entity Framework 4 或更高版本：

```
int? fieldSize = repository.Entity
  .Select(e => SqlFunctions.DataLength(e.MyVarBinaryField)).Single(); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-03-23T17:52:01.483

我知道这个问题很老，但 EF 现在通过使用`SqlFunctions.DataLength()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T11:56:17.700

我通过运行另一个查询来解决它，获取单元格的 DATALENGTH()。不是最顺畅的方式，但它有效。

不过，我仍然很想知道是否有人能对此提出答案。

# apache-flex - LoaderContext 和 ApplicationDomain 随 Adob e AIR 变化？

> ID：605791
> 
> 赞同：8
> 
> 时间：2009-03-03T09:52:37.920
> 
> 标签：apache-flex, flash, actionscript-3, air

我目前正在尝试从标准 AS3 应用程序和 AIR 应用程序加载外部 SWF 文件。似乎 AIR 应用程序的行为方式与 Flash Player 运行的标准 SWF 不同。

根据[文档](http://livedocs.adobe.com/flash/9.0_fr/ActionScriptLangRefV3/flash/system/LoaderContext.html#applicationDomain)， 的`applicationDomain`属性`LoaderContext`也可以在 AIR 应用程序中使用，但它似乎不起作用。

我有以下代码：

```
package {
    import flash.display.Loader;
    import flash.display.LoaderInfo;
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.net.URLRequest;
    import flash.system.ApplicationDomain;
    import flash.system.LoaderContext;

    public class Invoker extends Sprite
    {
        private var _ldr : Loader;

        public function Invoker()
        {
            _ldr = new Loader();
            _ldr.contentLoaderInfo.addEventListener(Event.COMPLETE, onChildOneComplete);

            var ldrC : LoaderContext = new LoaderContext(false,
                new ApplicationDomain(ApplicationDomain.currentDomain)
            );

            _ldr.load(new URLRequest("otherSwf.swf"), ldrC);
        }

        private function onChildOneComplete(e : Event) : void
        {
            var c1ad : ApplicationDomain = (e.target as LoaderInfo).applicationDomain;
            var inad : ApplicationDomain = ApplicationDomain.currentDomain;

            trace("Child One parentDomain : " + c1ad.parentDomain);
            trace("Invoker parentDomain   : " + inad.parentDomain);

            trace("Child One has Invoker  : " + c1ad.hasDefinition("Invoker"));
            trace("Invoker has Invoker    : " + inad.hasDefinition("Invoker"));
        }
    }
} 
```

将此代码编译为 SWF 文件并使用 Flash Player 启动它会执行此输出，这似乎是正确的：

```
Child One parentDomain : [object ApplicationDomain]
Invoker parentDomain   : null
Child One has Invoker  : true
Invoker has Invoker    : true 
```

但是与 AIR 应用程序相同的代码会产生不同的输出：

```
Child One parentDomain : null
Invoker parentDomain   : null
Child One has Invoker  : false
Invoker has Invoker    : true 
```

根据文档，第一个输出（使用带有 Flash Player 的 SWF，而不是 AIR 应用程序）是正确的。此外，使用此代码段并将应用程序域更改为其他可能的配置（如`new ApplicationDomain(null)`、 或`ApplicationDomain.currentDomain`）确实与 SWF 文档中所说的完全一致，但不会更改 AIR 应用程序的输出。

任何线索为什么 AIR 只是忽略传递给加载程序上下文的应用程序域？关于这个特定问题的任何文档？

非常感谢你。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-03T10:37:12.133

知道了。

该问题是由`SecurityDomain`AIR 应用程序中系统的不同行为引起的。在 AIR 应用程序中加载 SWF 文件时，它始终依赖于不同的沙箱。因此，AIR`SecurityDomain`为这个 SWF 创建了一个新的。

由于 a`SecurityDomain`是一组一个或多个`ApplicationDomain`s，因此此行为强制创建一个 new `ApplicationDomain`（在 new 内`SecurityDomain`），忽略指定的一个（属于 'main' `SecurityDomain`）。

有一种解决方法，使用`URLLoader`. 从字节码（使用`Loader.loadBytes`）加载时，SWF 会在同一个`SecurityDomain`. 这就是为什么你必须把它设置`allowLoadBytesCodeExecution`为真的，因为它可能是不安全的。所以间接加载SWF，首先通过一个`URLLoader`，然后用`Loader.loadBytes`，解决这个问题。

这是片段：

```
package {
    import flash.display.Loader;
    import flash.display.LoaderInfo;
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.net.URLLoader;
    import flash.net.URLLoaderDataFormat;
    import flash.net.URLRequest;
    import flash.system.ApplicationDomain;
    import flash.system.LoaderContext;
    import flash.utils.ByteArray;

    public class Invoker extends Sprite
    {
        public function Invoker()
        {
            var uldr : URLLoader = new URLLoader();
            uldr.dataFormat = URLLoaderDataFormat.BINARY;
            uldr.addEventListener(Event.COMPLETE, onBytesComplete);

            uldr.load(new URLRequest("otherSwf.swf"));
        }

        private function onBytesComplete(e : Event) : void
        {
            var bytes : ByteArray = (e.target as URLLoader).data;

            var ldr : Loader = new Loader();
            ldr.contentLoaderInfo.addEventListener(Event.COMPLETE, onChildComplete);

            var ldrC : LoaderContext = new LoaderContext();

            // This property was for AIR 1.0.
            //ldrC.allowLoadBytesCodeExecution = true;

            // Since AIR 2.0, it's allowCodeImport.
            ldrC.allowCodeImport = true;

            ldr.loadBytes(bytes, ldrC);
        }

        private function onChildComplete(e : Event) : void
        {
            var c1ad : ApplicationDomain = (e.target as LoaderInfo).applicationDomain;
            var inad : ApplicationDomain = ApplicationDomain.currentDomain;

            trace("Child One parentDomain : " + c1ad.parentDomain);
            trace("Invoker parentDomain   : " + inad.parentDomain);

            trace("Child One has Invoker  : " + c1ad.hasDefinition("Invoker"));
            trace("Invoker has Invoker    : " + inad.hasDefinition("Invoker"));
        }
    }
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T16:28:27.787

这是一个很好的，thanx :)

还有一个细节：**allowLoadBytesCodeExecution**现在是一个遗留属性，它是在 AIR 1.0 中定义的。从 AIR 2.0 开始，改用**allowCodeImport**。

曹, PG

# language-agnostic - 你见过的最昂贵的错误/缺陷

> ID：605797
> 
> 赞同：7
> 
> 时间：2009-03-03T09:53:44.937
> 
> 标签：language-agnostic

您在实践中看到的最昂贵的软件错误/缺陷是什么。

有一些著名的案例，例如[Therac 25](http://en.wikipedia.org/wiki/Therac-25)，但我很想知道您亲眼目睹或直接听说过哪些问题。我们都有“一个曾经在一家老公司工作的朋友”，并且永远不会承认自己不小心向别人的信用卡收费。

引起了什么问题，为什么会出现？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T11:00:23.200

我猜[这个](http://en.wikipedia.org/wiki/Ariane_5_Flight_501)（[更多信息](http://archive.eiffel.com/doc/manuals/technology/contract/ariane/page.html)）可能是最昂贵的单一故障（5 亿美元）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T10:45:57.463

好吧，我可以分享一个故事：

很久很久以前，我在一家公司工作，该公司签订了一份维护应用程序的合同，该应用程序基本上是用 Oracle SP 编写的。我不得不迁移其中一个，结果我不了解业务，所以我*按原样*迁移它。

问题是SP最后没有做commit，而是返回了一些数据，迁移出来的Java代码一模一样。sp 所做的是将一些数据写入表，返回包含一些计费信息的文档，但计费信息从未写入数据库。

接下来发生的事情是我们收到了很多付款，但不知道如何将它们与数据库数据相关联，因此我们不得不做很多魔术来尝试关联付款。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T11:43:24.267

[Y2K](http://www.encyclopedia.com/doc/1G1-54035911.html)错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T14:49:11.917

我曾经关闭了 CNA 的整个风险管理系统，因为我不了解数据库字段上的索引是什么。由于系统停止运行，CNA 在大约四个小时内没有批准任何新的保险单。我不知道财务成本是多少，但我的经理不得不进行一些严重的损害控制。

我永远不会再忽略表扫描和索引查找之间的区别。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-12-07T07:54:59.970

如果我没记错的话，曾经有一个小软件错误将某个值乘以一千 if a ，而不是 a 。被使用了。除非是癌症治疗设备的辐射剂量，否则没什么大不了的。人们死了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-02T02:18:03.400

我最近做了一些关于技术债务成本的调查，发现了两个案例：

1.  一个在大约 30 分钟内使 Knight Capical 损失 4.4 亿美元的错误：[http ://www.cio.com/article/713628/Software_Testing_Lessons_Learned_From_Knight_Capital_Fiasco](http://www.cio.com/article/713628/Software_Testing_Lessons_Learned_From_Knight_Capital_Fiasco)
2.  一个花费 Trend Micro 800 万美元的错误：[http ://www.pcworld.com/article/121825/article.html](http://www.pcworld.com/article/121825/article.html)

这些案例表明，当技术债务失控时，它可能会非常昂贵。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-26T16:33:58.470

嗯... Heartbleed 可能仍在累积数百万美元。我敢肯定还有很多服务器还没有打补丁。

[http://www.theguardian.com/technology/2014/apr/18/heartbleed-bug-will-cost-millions](http://www.theguardian.com/technology/2014/apr/18/heartbleed-bug-will-cost-millions)

[http://www.eweek.com/security/heartbleed-ssl-flaws-true-cost-will-take-time-to-tally.html](http://www.eweek.com/security/heartbleed-ssl-flaws-true-cost-will-take-time-to-tally.html)

# c# - 如何使用 c# 检索两个 html 标记之间的文本？

> ID：605804
> 
> 赞同：0
> 
> 时间：2009-03-03T09:57:35.100
> 
> 标签：c#, html, regex

如何使用 c# 检索两个 html 标记之间的文本？

编辑：这是我的问题的唯一目的，“如何使用 c# 在两个 html 标记中检索字符串”，仅此而已。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T10:06:56.167

假设您指的是获取标签中的文本，您可以使用 HTML 解析框架，例如[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)，也可以使用正则表达式。就像是：

```
(?<=\<title\>).+?(?=\<\/title\>) 
```

以上将仅匹配标题标签内的文本。

**编辑：**你真的应该更新你的问题，以更好地解释你想要实现的目标。SO 的成员非常乐意提供帮助，但如果他们无法确定您想要什么，他们可能会转向其他人的问题。

# vba - 以编程方式访问图表源数据名称

> ID：605808
> 
> 赞同：2
> 
> 时间：2009-03-03T09:58:36.330
> 
> 标签：vba, excel, charts

我从相同的工作簿中复制了一些图表，但每个图表的源数据（42 个图表，每个有 6 个系列）仍然包含完整的文件名路径。源表和单元格是相同的，所以我只想找到路径字符串并将其替换为“”。但是，我找不到获取源数据名称的方法（因为它出现在 refedit 框中）。从那里，我可以更换我需要的东西。

我们拥有的是这样的：

`ActiveChart.SeriesCollection(1).Values = "='C:\[oldfile.xls]Charts.Data'!R1C17:R1C28"`

而且我只想将“”中的部分作为字符串，并执行我的功能以删除文件路径。如果我尝试从中获取字符串，即：

`sourcestring = ActiveChart.SeriesCollection(1).Values`

我收到一个错误；似乎VBA在读取它时认为它是一个数组，但在分配给它时可以使用一个字符串。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T14:37:49.277

你是对的，你不能真正得到显示在 refedit 框中的相同公式......你必须操纵你正在使用的系列的 .Formula 或 .FormulaR1C1 属性，并重建公式并设置到 values 和/或 xvalues 属性。

这段代码应该可以工作，有一些函数可以提取公式的不同部分......我认为它应该适合你，或者至少希望能帮助你找出最好的方法......

```
Sub ChangeActiveChartData()
    ChangeChartData ActiveChart
End Sub

Sub ChangeChartData(TheChart As Chart)
    If TheChart Is Nothing Then Exit Sub

    Dim TheSeries As Series
    Set TheSeries = TheChart.SeriesCollection(1)

    Dim TheForm As String
    TheForm = TheSeries.FormulaR1C1

    Dim XValsForm As String
    XValsForm = GetXValuesFromFormula(TheForm)
    Debug.Print XValsForm
    XValsForm = GetRangeFormulaFromFormula(XValsForm)
    Debug.Print XValsForm

    Dim ValsForm As String
    ValsForm = GetValuesFromFormula(TheForm)
    Debug.Print ValsForm
    ValsForm = GetRangeFormulaFromFormula(ValsForm)
    Debug.Print ValsForm

    XValsForm = "=" & TheChart.Parent.Parent.Name & "!" & XValsForm ' TheChart's parents parent is the worksheet; we're assuming the chart is embedded in a worksheet
    ValsForm = "=" & TheChart.Parent.Parent.Name & "!" & ValsForm

    TheSeries.XValues = XValsForm
    TheSeries.Values = ValsForm

End Sub

Function GetXValuesFromFormula(SeriesFormula As String) As String
    ' Find string between first and second commas
    Dim FormulaParts() As String
    FormulaParts = Split(SeriesFormula, ",")
    GetXValuesFromFormula = FormulaParts(1)

End Function

Function GetValuesFromFormula(SeriesFormula As String) As String
    ' Find string between second and third commas
    Dim FormulaParts() As String
    FormulaParts = Split(SeriesFormula, ",")
    GetValuesFromFormula = FormulaParts(2)

End Function

Function GetRangeFormulaFromFormula(TheFormula As String) As String
    ' return to the right of the ! character in theformula
    Dim ExclamPos As Integer
    ExclamPos = InStrRev(TheFormula, "!")
    If ExclamPos > 0 Then
        GetRangeFormulaFromFormula = Right(TheFormula, Len(TheFormula) - ExclamPos)
    Else
        GetRangeFormulaFromFormula = TheFormula
    End If
End Function 
```

# entity-framework - 实体框架：条件外键

> ID：605813
> 
> 赞同：4
> 
> 时间：2009-03-03T09:59:52.190
> 
> 标签：entity-framework, mapping, foreign-keys, many-to-many, conditional

我在数据库中有以下架构：

*   **BillingReferences** (ReferenceType *tinyint* , ReferencingId *tinyint* , ReferencedType *tinyint* , ReferencedId *tinyint* , IsActive *bit* ) - 其中所有字段（IsActive 除外）都是唯一索引的一部分。
*   **BillingType** (BillingTypeId *tinyint* , 名称*varchar(50)* )

ReferencingType 和 ReferencedType 是 BillingTypes 的外键。BillingTypes 包含以下行：

计费类型 ID | 姓名

1 | 标签

2 | 国家

3 | 支付提供商

4 | 付款方式

5 | 银行

ReferencedId 和 ReferencedId 表示以下实体之一的 Id（取决于引用/引用类型）：

*   **银行**（BankId *tinyint*，名称*varchar(50)*）
*   **国家**（CountryId *tinyint*，名称*varchar(50)*）
*   **标签**（LabelId *tinyint*，名称*varchar(50)*）
*   **PaymentProviders**（PaymentProviderId *tinyint*，名称*varchar(50)*）
*   **PaymentOptions** (PaymentOptionId *tinyint* , 名称*varchar(50)* )

将来每个实体都会添加更多不同的列，但现在这是简单的模式。

*每个实体（国家除外）与国家之间都有*(1- ) 的连接。标签与银行、PaymentProviders 和 PaymentOptions*有 (1-) 的连接。*并且 PaymentProviders 与 PaymentProviders 有 (1-*) 的连接

例如，如果我想将 BankId 为 201 的银行连接到 CountryId 为 3003 的国家/地区，我将在 BillingReferences 中有一条如下所示的记录：ReferencingType = 5 ReferencingId = 201 ReferencedType = 2 ReferencedId = 3003 IsActive = 1

出于可扩展性考虑，我们没有为每种类型的连接创建连接/引用表 - 如果我们想要添加另一个实体，我们所要做的就是添加它的表并在 BillingReferences 和 BillingType 中为其添加记录。

问题是我无法在 BillingReferences 和每个实体之间配置条件外键，我似乎也无法使用 EntityFramework 配置/映射它......

我找不到任何使用这种实现类型的教程或示例。我是否必须为每个连接创建一个参考表，或者有没有办法使用 EntityFramework 来配置它？

谢谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T10:10:18.187

AFAIK，没有办法做到这一点。

我会为每种类型创建一个单独的表，除非你真的有充分的理由不这样做。您提到的考虑不是一个好的考虑，恕我直言。

拥有更多表确实允许您在键上放置外键约束，并且它可以很好地转换为 EF。它还有助于提高性能：与更小的表相比，具有一百万行的大型引用表将花费更多时间来查询（除非您总是想要一个类型的所有引用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T12:59:08.627

不仅在实体框架中没有办法做到这一点，在 SQL 中也没有办法做到这一点。您不能拥有引用五个不同表之一的外键。

我认为您应该做的是拥有一个父抽象引用类型，并使具体类型成为该父类型的子类型。现在你只有一个外键，一个表。您可以选择每个类型的表或每个层次结构映射的表。鉴于您提到的任何类型中都没有任何特殊列，我认为[每个层次结构映射的表](http://msdn.microsoft.com/en-us/library/bb738443.aspx "如何：定义具有按层次结构表继承的模型（实体框架）")对您来说是一个更好的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-31T22:13:32.203

您可以完成您想要的唯一方法是构建一个触发器来处理服务器端的处理。您不能将这样的 FK 映射到多个表。但是触发器可以处理该逻辑。当然，那将完全在 EF 之外......

我还建议您为每种类型建立一个单独的表。我认为从长远来看更容易维护。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-03T14:45:21.927

好吧，我想我会使用 Inferis 的建议并为每种类型创建一个单独的表。

谢谢你们的回答-他们帮助**了很多**:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-19T03:03:42.573

在 SQL 中，您可以基于单个表为每种类型创建一个视图。每个视图都可以执行连接以检索与该类型相关的信息。这也使您可以将链接视为一个整体而忽略其类型。

# javascript - 包含的 javascript 文件中有 asp.net-mvc 生成的 url 吗？

> ID：605818
> 
> 赞同：1
> 
> 时间：2009-03-03T10:01:29.880
> 
> 标签：javascript, asp.net-mvc

我的 asp.net-mvc 视图包含一个 javascript 文件。此 javascript 文件具有以下行：

```
$("input[id='SearchBag.CompanyName']").autocomplete("Search.mvc/AutoComplete/"); 
```

这行得通。伟大的。但如果我可以用生成的 URL 替换自动完成的路径会更好，这样如果我更改路由路径，我就不必更改 JS 文件中的任何代码。在未包含的文件中，我可以像

```
$("input[id='SearchBag.CompanyName']").autocomplete('<%=Url.Action("AutoComplete", "Search") %>) 
```

但是在包含的文件中，这不会被解析。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T10:47:31.063

假设您实际上想做一些比您发布的更复杂的事情......

您可以创建一个“Javascript”控制器，其视图具有文本/javascript 内容。

视图内容主要是文字 javascript，但它允许您使用 <%= %> 助手。

您需要适当地配置响应缓存以避免对该内容的过多请求。

但是，对于简单的文字 URL，例如您的问题，我不确定是否值得费心。

# ruby - 如何在 Ruby 中解析制表符分隔的文本行？

> ID：605821
> 
> 赞同：7
> 
> 时间：2009-03-03T10:03:04.977
> 
> 标签：ruby, parsing, delimiter, lexical-analysis, csv

我发现 Ruby 的`each`功能有点混乱。如果我有一行文本，`each`循环将给我每个空格分隔的单词，而不是每个单独的字符。

那么检索由制表符分隔的字符串部分的最佳方法是什么。目前我有：

```
line.split.each do |word|
...
end 
```

但这并不完全正确。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-03T10:28:10.080

我不确定我是否完全理解您的问题，但是如果您想拆分制表符上的行，您可以将其指定为拆分的参数：

```
line.split("\t").each ... 
```

或者您可以将其指定为正则表达式：

```
line.split(/\t/).each ... 
```

每个基本上只是遍历数组中的所有项目，然后 split 从字符串中生成一个数组。

# java - 在 Java 中扩展 Serializable 类时，我为 serialVersionUID 选择什么重要吗？

> ID：605828
> 
> 赞同：44
> 
> 时间：2009-03-03T10:06:21.427
> 
> 标签：java, serialization

我正在扩展一个实现[Serializable 接口](http://java.sun.com/javase/6/docs/api/java/io/Serializable.html)的类 (ArrayBlockingQueue) 。Sun 的文档（和我的 IDE）建议我应该设置这个值以防止恶作剧：

> 但是，强烈建议所有可序列化的类都显式声明 serialVersionUID 值，因为默认的 serialVersionUID 计算对类细节高度敏感，这些细节可能因编译器实现而异，因此可能在反序列化期间导致意外的 InvalidClassExceptions。

现在，我不在乎放在那里的价值。有关系吗？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-03-03T10:08:36.290

不-只要您在正确的时间更改它（即当您进行影响序列化的更改时，例如删除一个字段），您使用什么值并不重要。

为简单起见，我建议从 0 开始，每次需要时将其增加 1。

序列化[规范](http://download.oracle.com/javase/1.5.0/docs/guide/serialization/spec/version.html#6678)有更多细节。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-03T10:09:51.950

对 serialVersionUID 唯一重要的是类的二进制兼容序列化版本具有相同的 serialVersionUID；也就是说，如果您没有对类的序列化形式进行任何重大更改，那就没问题了。

当然，更好的选择是使用序列化为您提供的高级选项，这样就不会发生任何重大更改。我建议阅读有关 readResolve() 等的内容。Effective Java 详细介绍了该领域的一些棘手问题。

# wpf - Databinding items to Canvas

> ID：605836
> 
> 赞同：0
> 
> 时间：2009-03-03T10:09:50.437
> 
> 标签：wpf, data-binding, canvas

I have a userControl that contains a canvas. I would like to databind items to it so they are positioned automagically.

[Here's](http://www.iconstructions.be/myblog/avalon-position-data-binding.aspx) a great example that shows how to databind items on **a** canvas, but I want it to work on **my** specific userControl. (I believe it's not possible to specify a userControl in a ItemsPanelTemplate)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-05T13:52:57.187

根据您的`UserControl`工作，您的一个选择是创建自己的`Canvas`子类，然后您可以在您的`ItemsPanel`（Panel 的任何子类都可以使用）中使用它。这假定您对 UserControl 所做的一切都是定位项目。

如果你真的想使用 a `UserControl`，我脑海中的一个选项是添加一个`ItemsControl`到你的`UserControl`（它有 Canvas 作为 ItemsPanel）并通过绑定项目到它`TemplateBinding`

# c++ - C++ 和 C 文件 I/O

> ID：605839
> 
> 赞同：7
> 
> 时间：2009-03-03T10:10:14.897
> 
> 标签：c++, file, io

C++ 文件 I/O 比 C 文件 I/O 更难。那么在 C++ 中，为文件 I/O 创建一个新库是否有用？我的意思是`<fstream>` 任何人都可以告诉 C++ 文件 I/O 有什么好处吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-03T10:21:42.733

**观点**

我不知道任何使用 C++ 流的真实项目。它们太慢且难以使用。有几个较新的库，如[FastFormat](http://www.fastformat.org/)和声称更好的[Boost版本，在上一期 ACCU Overload 杂志中有一篇关于它们的文章。](http://www.boost.org/doc/libs/1_38_0/libs/format/index.html)就我个人而言，在过去 15 年左右的时间里，我一直在 C++ 中使用 c FILE 库，我认为没有理由改变。

**速度**

下面是一个小测试程序（我快拼起来）来展示基本的速度问题：

```
#include <stdio.h>
#include <time.h>

#include<iostream>
#include<fstream>

using namespace std;

int main( int argc, const char* argv[] )
    {
    const int max = 1000000;
    const char* teststr = "example";

    int start = time(0);
    FILE* file = fopen( "example1", "w" );
    for( int i = 0; i < max; i++ )
        {
        fprintf( file, "%s:%d\n", teststr, i );
        }
    fclose( file );
    int end = time(0);

    printf( "C FILE: %ds\n", end-start );

    start = time(0);
    ofstream outdata;
    outdata.open("example2.dat");
    for( int i = 0; i < max; i++ )
        {
        outdata << teststr << ":" << i << endl;
        }
    outdata.close();
    end = time(0);

    printf( "C++ Streams: %ds\n", end-start );

    return 0;
    } 
```

我的电脑上的结果：

```
C FILE: 5s
C++ Streams: 260s

Process returned 0 (0x0)   execution time : 265.282 s
Press any key to continue. 
```

正如我们所看到的，这个简单的例子慢了 52 倍。我希望有办法让它更快！

*注意：*在我的示例中将 endl 更改为 '\n' 改进了 C++ 流，使其仅比 FILE* 流慢 3 倍（感谢[jalf](https://stackoverflow.com/users/33213/jalf)），可能有办法让它更快。

**使用困难**

我不能争辩说 printf() 并不简洁，但它更灵活（IMO）并且更易于理解，一旦您通过了宏代码的初始 WTF。

```
double pi = 3.14285714;

cout << "pi = " << setprecision(5)  << pi << '\n';
printf( "%.5f\n", pi );

cout << "pi = " << fixed << showpos << setprecision(3) << pi << '\n'; 
printf( "%+.3f\n", pi );

cout << "pi = " << scientific << noshowpos << pi<< '\n';
printf( "%e\n", pi ); 
```

**问题**

是的，可能需要一个更好的 C++ 库，很多是[FastFormat](http://www.fastformat.org/)就是那个库，只有时间会证明。

戴夫

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-03T10:47:20.627

消除缓冲区溢出对我来说似乎是 C++ 的一大胜利。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-03T12:12:23.370

请看一下

[http://www.ddj.com/cpp/184403651](http://www.ddj.com/cpp/184403651)

那么你会更喜欢 C++ I/O 而不是 CI/O。

简而言之，如果您在读取或写入之前知道数据大小以及速度，则首选 C。如果您不知道数据大小和高效代码，则首选 C++。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-03T13:16:11.953

为了回应 David Allan Finch 的回答，我修复了他的基准测试代码中的一个错误（他在每一行之后都刷新了 C++ 版本中的流），并重新运行了测试：

C++ 循环现在看起来像这样：

```
start = time(0);
{
    ofstream outdata("example2.txt");
    for( int i = 0; i < max; i++ )
    {
        outdata << teststr << ":" << i << "\n"; // note, \n instead of endl
    }
}
end = time(0); 
```

我运行了 10000000 次迭代（比原始代码多 10 倍，否则，对于 time() 糟糕的分辨率来说，数字太小了，无法给我们任何有意义的东西））输出是：

```
G++ 4.1.2:
C FILE: 4s
C++ Streams: 6s

MSVC9.0:
C FILE: 10s
C++ Streams: 23s 
```

（请注意，MSVC 版本是在我的笔记本电脑上运行的，其硬盘驱动器明显较慢）

但这会给我们带来 1.5-2.3 倍的性能差异，具体取决于实现。和其他外部因素。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-03T13:00:33.007

printf()/fwrite 风格的 I/O 和 C++ IO 流格式之间的性能差异在很大程度上取决于实现。一些实现（例如 Visual C++）在 FILE * 对象之上构建其 IO 流，这往往会增加其实现的运行时复杂性。但是请注意，以这种方式实现库没有特别的限制。

在我个人看来，C++ I/O 的好处如下：

*   如前所述，类型安全。
*   实施的灵活性。可以编写代码来对通用 ostream 或 istream 对象进行特定的格式化或输入。然后应用程序可以使用任何类型的派生流对象调用此代码。如果现在需要将我针对文件编写和测试的代码应用于套接字、串行端口或某种其他类型的内部流，则可以创建特定于该类型 I/O 的流实现。以这种方式扩展 C 风格的 I/O 几乎是不可能的。
*   语言环境设置的灵活性：在我看来，使用单一全局语言环境的 C 方法存在严重缺陷。我曾遇到过调用库代码（一个 DLL）的情况，这些代码更改了我的代码下的全局语言环境设置并完全弄乱了我的输出。C++ 流允许您将任何语言环境灌输（）到流对象。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T10:14:57.007

std::ifstream 和 std::ofstream 已经在 stl 库中。您不必创建自己的。

主要好处是所有输出和输入都是类型安全的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T10:15:49.017

C 和 C++ 是两种不同的语言。C++ 文件 io 需要一些时间来适应，但是一旦您使用算法、异常等，它们往往会很自然地到位。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-08-07T11:40:47.767

每当我需要在 C++ 中的文件中输入/输出时，我只使用两行。

```
freopen("input.txt","r",stdin); // for input from file
freopen("output.txt","w",stdout);// for output from file 
```

现在您可以像往常一样从控制台扫描变量，并且打印为输出的任何内容都将显示在 output.txt 文件中。

所以我不认为c ++中的文件I/O很难，它比c更容易。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-03T10:14:51.343

很多。缺点也是。有关详细信息，请参阅 C++ 语言常见问题解答。简而言之：类型安全和用户定义类型。

# c - 我要转换 malloc 的结果吗？

> ID：605845
> 
> 赞同：2650
> 
> 时间：2009-03-03T10:13:02.940
> 
> 标签：c, malloc, casting

在[这个问题](http://stackoverflow.com/questions/571945/getting-a-stack-overflow-exception-when-declaring-a-large-array)中，有人在[评论](http://stackoverflow.com/questions/571945/getting-a-stack-overflow-exception-when-declaring-a-large-array#comment388297_571961)中建议我不应该***转换***结果`malloc`。即，我应该这样做：

```
int *sieve = malloc(sizeof(*sieve) * length); 
```

而不是：

```
int *sieve = (int *) malloc(sizeof(*sieve) * length); 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：2415
> 
> 时间：2009-03-03T10:17:53.817

### TL;博士

```
int *sieve = (int *) malloc(sizeof(int) * length); 
```

有两个问题。强制转换并且您使用类型而不是变量作为 sizeof 的参数。相反，这样做：

```
int *sieve = malloc(sizeof *sieve * length); 
```

### 长版

**没有**；你*不*投射结果，因为：

*   这是不必要的，因为`void *`在这种情况下会自动且安全地提升为任何其他指针类型。
*   它增加了代码的混乱，强制转换不是很容易阅读（特别是如果指针类型很长）。
*   它会让你重复自己，这通常是不好的。
*   如果您忘记包含`<stdlib.h>`. 这可能会导致崩溃（或者，更糟糕的是，直到稍后在代码的某些完全不同的部分中才会导致崩溃）*。*考虑如果指针和整数大小不同会发生什么；那么你通过强制转换隐藏了一个警告，并且可能会丢失你返回的地址。注意：从 C99 开始，隐式函数已从 C 中消失，这一点不再相关，因为没有自动假设未声明的函数返回`int`.

作为澄清，请注意我说“你不施放”，而不是“你*不需要*施放”。在我看来，即使你做对了，加入演员阵容也是失败的。这样做根本没有好处，但是有一堆潜在的风险，包括演员表表明你不知道这些风险。

另请注意，正如评论员所指出的那样，上面讨论的是纯 C，而不是 C++。我非常坚信 C 和 C++ 是独立的语言。

要进一步补充，您的代码会不必要地重复`int`可能导致错误的类型信息 ( )。最好取消引用用于存储返回值的指针，将两者“锁定”在一起：

```
int *sieve = malloc(length * sizeof *sieve); 
```

这也将 移到`length`前面以增加可见性，并用`sizeof`;删除多余的括号。仅当参数是类型名称*时才需要*它们。许多人似乎不知道（或忽略）这一点，这使得他们的代码更加冗长。记住：`sizeof`不是函数！:)

* * *

虽然在极少数情况下移到`length`前面*可能会*增加可见度，但还应注意，在一般情况下，最好将表达式写为：

```
int *sieve = malloc(sizeof *sieve * length); 
```

由于在这种情况下保留第`sizeof`一个，确保乘法至少通过`size_t`数学完成。

比较：`malloc(sizeof *sieve * length * width)`与`malloc(length * width * sizeof *sieve)`第二个相比，可能会溢出`length * width`when`width`并且`length`是比 . 更小的类型`size_t`。

* * *

## 回答 #2

> 赞同：435
> 
> 时间：2009-03-03T10:17:21.433

在 C 中，您不需要强制转换`malloc`. 返回的指向 void 的指针`malloc`会自动转换为正确的类型。但是，如果您希望您的代码使用 C++ 编译器进行编译，则需要进行强制转换。社区中的首选替代方法是使用以下内容：

```
int *sieve = malloc(sizeof *sieve * length); 
```

如果您更改`sieve`.

正如人们指出的那样，演员阵容很糟糕。特别是指针转换。

* * *

## 回答 #3

> 赞同：386
> 
> 时间：2013-02-14T16:15:37.000

你**确实**投了，因为：

*   它使您的代码在 C 和 C++ 之间**更具可移植性**，并且正如 SO 经验所表明的那样，许多程序员声称他们是在真正用 C++（或 C 加上本地编译器扩展）编写时用 C 编写的。
*   不这样做**可能会隐藏错误**：请注意所有混淆何时编写`type *`与编写的 SO 示例`type **`。
*   它使您不会注意到您没有找到`#include`适当的头文件的想法错过**了树木的森林**。这就像说“不要担心你没有让编译器抱怨没有看到原型的事实——讨厌的 stdlib.h 是要记住的真正重要的事情！”
*   它强制进行**额外的认知交叉检查**。它将（所谓的）所需类型放在您为该变量的原始大小所做的算术旁边。我敢打赌，您可以进行一项 SO 研究，该研究表明，`malloc()`当有演员表时，错误被捕获的速度要快得多。与断言一样，揭示意图的注释可以减少错误。
*   以机器可以检查的方式重复自己通常是一个**好**主意。事实上，这就是断言，而这种使用 cast 就是断言。断言仍然是我们获得正确代码的最通用技术，因为图灵多年前就提出了这个想法。

* * *

## 回答 #4

> 赞同：188
> 
> 时间：2009-03-03T11:17:46.327

正如其他人所说，C 不需要它，但 C++ 需要它。如果您认为要使用 C++ 编译器编译 C 代码，无论出于何种原因，您都可以使用宏，例如：

```
#ifdef __cplusplus
# define NEW(type, count) ((type *)calloc(count, sizeof(type)))
#else
# define NEW(type, count) (calloc(count, sizeof(type)))
#endif 
```

这样你仍然可以以非常紧凑的方式编写它：

```
int *sieve = NEW(int, 1); 
```

它将为 C 和 C++ 编译。

* * *

## 回答 #5

> 赞同：160
> 
> 时间：2015-10-09T21:23:21.457

来自[维基百科](https://en.wikipedia.org/wiki/C_dynamic_memory_allocation#Advantages_to_casting)：

> **铸造的优势**
> 
> *   包括强制转换可能允许 C 程序或函数编译为 C++。
>     
>     
> *   演员表允许最初返回 char * 的 malloc 的 1989 之前版本。
>     
>     
> *   如果目标指针类型发生变化，转换可以帮助开发人员识别类型大小的不一致，特别是当指针声明远离 malloc() 调用时（尽管现代编译器和静态分析器可以在不需要转换的情况下警告这种行为）。
>     
>     
> 
> **铸造的缺点**
> 
> *   在 ANSI C 标准下，强制转换是多余的。
>     
>     
> *   添加强制转换可能会掩盖包含标头*stdlib.h的失败*，其中找到了 malloc 的原型。在没有 malloc 原型的情况下，标准要求 C 编译器假定 malloc 返回一个 int。如果没有强制转换，则在将此整数分配给指针时发出警告；但是，使用演员表时，不会产生此警告，从而隐藏了一个错误。在某些架构和数据模型上（例如 64 位系统上的 LP64，其中 long 和指针是 64 位而 int 是 32 位），此错误实际上可能导致未定义的行为，因为隐式声明的 malloc 返回一个 32-位值，而实际定义的函数返回一个 64 位值。根据调用约定和内存布局，这可能会导致堆栈粉碎。这个问题在现代编译器中不太可能被忽视，因为他们统一产生一个未声明的函数已被使用的警告，所以仍然会出现一个警告。例如，GCC 的默认行为是显示一条警告，内容为“内置函数的不兼容隐式声明”，无论是否存在强制转换。
>     
>     
> *   如果指针的类型在其声明时发生更改，则可能还需要更改调用 malloc 并强制转换的所有行。

尽管**不进行强制转换的 malloc 是首选方法，并且大多数有经验的程序员都选择它**，但您应该使用任何您喜欢的知道问题的方法。

即：如果您需要将 C 程序编译为 C++（尽管它是一种单独的语言），则必须转换 use 的结果`malloc`。

* * *

## 回答 #6

> 赞同：113
> 
> 时间：2009-03-03T10:18:12.710

在 C 中，您可以将指针隐式转换`void`为任何其他类型的指针，因此不需要强制转换。使用一个可能会向不经意的观察者暗示需要一个是有某种原因的，这可能会产生误导。

* * *

## 回答 #7

> 赞同：110
> 
> 时间：2014-03-20T15:53:14.890

您不会强制转换 的结果`malloc`，因为这样做会给您的代码添加毫无意义的混乱。

人们转换结果的最常见原因`malloc`是因为他们不确定 C 语言是如何工作的。这是一个警告信号：如果您不知道特定语言机制是如何工作的，那么*不要*猜测。在 Stack Overflow 上查找或询问。

一些评论：

*   void 指针可以转换为/从任何其他指针类型转换，无需显式转换（C11 6.3.2.3 和 6.5.16.1）。

*   然而，C++ 不允许在`void*`和另一个指针类型之间进行隐式转换。所以在 C++ 中，强制转换是正确的。但是如果你用 C++ 编程，你应该使用`new`而不是`malloc()`. 而且你永远不应该使用 C++ 编译器来编译 C 代码。

    如果您需要使用相同的源代码同时支持 C 和 C++，请使用编译器开关来标记差异。不要试图用相同的代码来满足两种语言标准，因为它们不兼容。

*   如果 C 编译器因为您忘记包含标头而找不到函数，您将收到一个编译器/链接器错误。因此，如果您忘记包含`<stdlib.h>`这没什么大不了的，您将无法构建您的程序。

*   在遵循超过 25 年历史的标准版本的古代编译器上，忘记包含`<stdlib.h>`会导致危险行为。因为在那个古老的标准中，没有可见原型的函数会隐式地将返回类型转换为`int`. 显式地转换结果`malloc`会隐藏这个错误。

    但这真的不是问题。您没有使用 25 年的计算机，那么为什么要使用 25 年的编译器呢？

* * *

## 回答 #8

> 赞同：101
> 
> 时间：2009-03-03T10:16:21.467

在 C 中，您可以获得从`void *`任何其他（数据）指针的隐式转换。

* * *

## 回答 #9

> 赞同：75
> 
> 时间：2013-06-09T17:31:35.053

现在不需要强制转换返回的值`malloc()`，但我想补充一点，似乎没有人指出：

在古代，也就是在**ANSI C**提供`void *`指针作为泛型类型之前，`char *`就是这种用法的类型。在这种情况下，强制转换可以关闭编译器警告。

参考：[C 常见问题](http://c-faq.com/malloc/cast.html)

* * *

## 回答 #10

> 赞同：57
> 
> 时间：2014-03-28T18:21:31.837

只是添加我的经验，学习计算机工程，我看到我看到用 C 编写的两三个教授总是使用 malloc，但是我问的那个（拥有巨大的 CV 和对 C 的理解）告诉我这是绝对没有必要的，但是以前只是绝对具体，让学生进入绝对具体的心态。本质上，强制转换不会改变它的工作方式，它完全按照它说的去做，分配内存，并且强制转换不会影响它，你得到相同的内存，即使你错误地将它强制转换为其他东西（并且以某种方式逃避编译器错误）C 将以相同的方式访问它。

**编辑：**铸造有一定的意义。当您使用数组表示法时，生成的代码必须知道它必须提前多少内存位置才能到达下一个元素的开头，这是通过强制转换来实现的。这样，您就知道对于 double，您会提前 8 个字节，而对于 int，您会提前 4 个字节，依此类推。因此，如果您使用指针表示法，它没有效果，在数组表示法中它变得必要。

* * *

## 回答 #11

> 赞同：56
> 
> 时间：2013-02-07T22:22:34.110

强制转换 的结果`malloc`，因为它返回`void*`，并且 a`void*`可以指向任何数据类型。

* * *

## 回答 #12

> 赞同：40
> 
> 时间：2015-10-09T17:47:38.610

这就是[GNU C 库参考](http://www.gnu.org/software/libc/manual/html_node/Basic-Allocation.html)手册所说的：

> 您可以将结果存储`malloc`到任何指针变量中而无需强制转换，因为 ISO C 会在必要时自动将类型转换`void *`为另一种类型的指针。但是在赋值运算符以外的上下文中，或者如果您可能希望您的代码在传统 C 中运行，则强制转换是必要的。

事实上，[ISO C11 标准](http://www.compsci.hunter.cuny.edu/~sweiss/resources/c11standard.pdf)(p347) 是这样说的：

> 如果分配成功，则返回的指针经过适当对齐，以便它可以分配给指向具有基本对齐要求的任何类型对象的指针，然后用于访问分配的空间中的此类对象或此类对象的数组（直到空间被显式释放）

* * *

## 回答 #13

> 赞同：36
> 
> 时间：2014-07-13T06:42:25.510

void 指针是通用对象指针，C 支持从 void 指针类型到其他类型的隐式转换，因此不需要显式类型转换。

但是，如果您希望相同的代码在不支持隐式转换的 C++ 平台上完美兼容，则需要进行类型转换，因此这完全取决于可用性。

* * *

## 回答 #14

> 赞同：31
> 
> 时间：2013-04-26T16:43:31.443

返回的类型是 void*，可以将其强制转换为所需的数据指针类型，以便可解引用。

* * *

## 回答 #15

> 赞同：31
> 
> 时间：2014-03-17T13:16:41.423

这取决于编程语言和编译器。如果`malloc`在 C 中使用，则无需进行类型转换，因为它会自动进行类型转换。但是，如果您使用的是 C++，那么您应该键入 cast 因为`malloc`会返回一个`void*`类型。

* * *

## 回答 #16

> 赞同：30
> 
> 时间：2015-09-04T11:52:04.793

在 C 语言中，可以将 void 指针分配给任何指针，这就是不应该使用类型转换的原因。如果你想要“类型安全”的分配，我可以推荐以下宏函数，我总是在我的 C 项目中使用它们：

```
#include <stdlib.h>
#define NEW_ARRAY(ptr, n) (ptr) = malloc((n) * sizeof *(ptr))
#define NEW(ptr) NEW_ARRAY((ptr), 1) 
```

有了这些，你可以简单地说

```
NEW_ARRAY(sieve, length); 
```

对于非动态数组，第三个必备函数宏是

```
#define LEN(arr) (sizeof (arr) / sizeof (arr)[0]) 
```

这使得数组循环更安全、更方便：

```
int i, a[100];

for (i = 0; i < LEN(a); i++) {
   ...
} 
```

* * *

## 回答 #17

> 赞同：21
> 
> 时间：2015-12-04T17:27:54.660

习惯 GCC 和 Clang 的人都被宠坏了。那里并不是那么好。

多年来，我被要求使用的年代久远的编译器吓坏了。公司和管理人员通常会采用极其保守的方法来更改编译器，甚至不会*测试*新的编译器（具有更好的标准合规性和代码优化）是否可以在他们的系统中工作。工作开发人员的实际情况是，当您编写代码时，您需要覆盖您的基础，不幸的是，如果您无法控制可以将哪些编译器应用于您的代码，那么强制转换 malloc 是一个好习惯。

我还建议许多组织应用他们自己的编码标准，如果它被定义，*那*应该是人们遵循的方法。在没有明确指导的情况下，我倾向于最有可能在任何地方编译，而不是盲目地遵守标准。

在当前标准下没有必要的论点是非常有效的。但这个论点忽略了现实世界的实用性。我们不是在一个完全由当时的标准统治的世界中编码，而是由我喜欢称之为“本地管理的现实领域”的实用性来编码。这比时空更弯曲和扭曲。:-)

YMMV。

我倾向于将 malloc 转换为防御性操作。不漂亮，不完美，但通常是安全的。（老实说，如果你没有包含 stdlib.h 那么你*比*强制转换 malloc 有更多的问题！）。

* * *

## 回答 #18

> 赞同：20
> 
> 时间：2020-06-12T19:20:34.013

# **这个问题是基于意见的滥用的主题。**

有时我会注意到这样的评论：

> [不要转换 malloc 的结果](https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc)

或者

> [为什么你不投射 malloc 的结果](https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc)

关于 OP 使用强制转换的问题。评论本身包含指向此问题的超链接。

这在*任何*情况下都是不恰当和不正确的。当这真的是一个人自己的编码风格问题时，没有对错之分。

* * *

### 为什么会这样？

它基于两个原因：

1.  这个问题确实是基于意见的。从技术上讲，这个问题应该在几年前以基于意见的方式结束。一个“*我要*”或“*我不要*”或等效的“*我应该*”或“*我不应该*”的问题，如果没有自己意见的态度，你就无法专注地回答。关闭问题的原因之一是因为它“可能会导致基于意见的答案”，正如这里所展示的那样。

2.  许多答案（包括[@unwind](https://stackoverflow.com/users/28169/unwind)最明显和公认的[答案](https://stackoverflow.com/a/605858/12139179)）要么完全或几乎完全基于意见（如果你自己铸造或重复自己会被添加到你的代码中的神秘“混乱”会很糟糕）并显示省略演员表的明确而集中的倾向。他们一方面争论演员阵容的冗余，但更糟糕的是，他们争论解决由编程本身的错误/失败引起的错误——如果一个人想要使用.`#include <stdlib.h>``malloc()`

* * *

我想对所讨论的一些观点提出真实的看法，而不是我的个人意见。有几点需要特别注意：

1.  这样一个非常容易陷入自己观点的问题需要一个中性利弊的答案。不仅有缺点也有优点。

    此答案中列出了优缺点的一个很好的概述：

    [https://stackoverflow.com/a/33047365/12139179](https://stackoverflow.com/a/33047365/12139179)

    （由于这个原因，我个人认为这是迄今为止最好的答案。）

* * *

2.  最多遇到的一个原因是省略演员表的原因是演员表可能隐藏了一个错误。

    如果有人使用`malloc()`返回的隐式声明`int`（自 C99 以来隐式函数已从标准中消失）并且`sizeof(int) != sizeof(int*)`，如本问题所示

    [为什么这段代码在 64 位架构上会出现段错误，但在 32 位上却能正常工作？](http://stackoverflow.com/q/7545365/168175)

    演员会隐藏一个错误。

    虽然这是真的，但它只显示了故事的一半，因为演员的遗漏只会是一个更大的错误的前瞻性解决方案 - 不包括`stdlib.h`使用`malloc()`.

    这永远不会是一个严重的问题，如果你，

    1.  使用符合 C99 或更高版本的编译器（推荐并且应该是强制性的），并且

    2.  `stdlib.h`当您想在代码中使用时，不要忘记包含，`malloc()`这本身就是一个巨大的错误。

* * *

3.  有些人争论 C 代码的 C++ 合规性，因为强制转换在 C++ 中是必需的。

    首先要笼统地说：用 C++ 编译器编译 C 代码并不是一个好习惯。

    C 和 C++ 实际上是两种完全不同的语言，具有不同的语义。

    但是，如果您真的想要/需要使 C 代码与 C++ 兼容，反之亦然，请使用编译器开关而不是任何强制转换。

    由于演员表具有被宣布为多余甚至有害的倾向，因此我想重点关注这些问题，这些问题很好地说明了演员表有用甚至是必要的理由：

    *   [https://stackoverflow.com/a/34094068/12139179](https://stackoverflow.com/a/34094068/12139179)

    *   [https://stackoverflow.com/a/36297486/12139179](https://stackoverflow.com/a/36297486/12139179)

    *   [https://stackoverflow.com/a/33044300/12139179](https://stackoverflow.com/a/33044300/12139179)

* * *

4.  当您的代码，分别分配指针的类型（以及转换的类型）发生变化时，转换可能是无益的，尽管这在大多数情况下不太可能。然后您还需要维护/更改所有强制转换，如果您的代码中有几千次调用内存管理函数，这真的可以总结并降低维护效率。

* * *

### 概括：

事实是，如果分配的指针指向具有基本对齐要求的对象（包括所有对象中的大多数），则根据 C 标准（从 ANSI-C (C89/C90) 开始），强制转换是多余的。

您不需要进行强制转换，因为在这种情况下指针会自动对齐：

> “连续调用aligned_alloc、calloc、malloc和realloc函数分配的存储顺序和连续性是未指定的。**如果分配成功，则返回的指针被适当对齐，以便它可以分配给指向任何类型对象的指针一个基本的对齐要求**，然后用于访问分配的空间中的此类对象或此类对象的数组（直到空间被显式释放）。
> 
> 资料来源：C18，§7.22.3/1

* * *

> “*基本对齐*是小于或等于 的有效对齐`_Alignof (max_align_t)`。对于所有存储持续时间的对象，实现应支持基本对齐。以下类型的对齐要求应为基本对齐：
> 
> ——所有原子的、合格的或不合格的基本类型；
> 
> — 所有原子的、合格的或不合格的枚举类型；
> 
> — 所有原子的、合格的或不合格的指针类型；
> 
> — 其元素类型具有基本对齐要求的所有数组类型；57)
> 
> ——第 7 章中作为完整对象类型指定的所有类型；
> 
> — 所有结构或联合类型，其所有元素都具有具有基本对齐要求的类型，并且没有一个元素具有指定非基本对齐的对齐说明符。
> 
> 57.  如 6.2.1 中所述，后面的声明可能会隐藏前面的声明。”
> 
> 资料来源：C18，§6.2.8/2

但是，如果您为扩展对齐要求的实现定义的对象分配内存，则需要进行强制转换。

> 扩展*对齐*由大于 的对齐表示`_Alignof (max_align_t)`。是否支持任何扩展对齐以及支持它们的存储持续时间是实现定义的。具有扩展对齐要求的类型是过度对齐类型.58)
> 
> 来源。C18，§6.2.8/3

其他一切都取决于具体的用例和自己的意见。

请注意你如何教育自己。

我建议您首先仔细阅读到目前为止所做的*所有*答案（以及他们可能指向失败的评论），然后在您或如果您没有`malloc()`针对特定案例提出结果时建立自己的意见。

请注意：

**这个问题没有正确和错误的答案。这是风格问题，您自己决定选择哪种方式（当然，如果您没有受到教育或工作的强迫）。请注意这一点，不要让欺骗你**。

* * *

最后一点：我最近投票决定以基于意见的方式结束这个问题，多年来确实需要。如果您获得关闭/重新打开特权，我也想邀请您这样做。

* * *

## 回答 #19

> 赞同：18
> 
> 时间：2017-08-16T12:25:30.430

## 不，您不会转换`malloc()`.

通常，您**不会投射到或从`void *`**.

不这样做的一个典型原因是失败`#include <stdlib.h>`可能会被忽视。这在很长一段时间内都不再是问题了，因为 C99 使*隐式函数声明*非法，因此如果您的编译器至少符合 C99，您将收到一条诊断消息。

但是有一个**更强有力的理由**不引入不必要的指针转换：

在 C 中，**指针转换几乎总是一个错误**。这是因为以下规则（**N1570 中的 §6.5 p7**，C11 的最新草案）：

> 对象的存储值只能由具有以下类型之一的左值表达式访问：
> — 与对象的有效类型兼容的类型，
> — 与对象的有效类型兼容的类型的限定版本，
> —对应于对象有效类型的有
> 符号或无符号类型， — 对应于对象有效类型的限定版本的有符号或无符号类型，
> — 聚合或联合类型，包括一个其成员中的上述类型（递归地，包括子聚合或包含联合的成员），或者
> - 字符类型。

这也称为*严格别名规则*。所以下面的代码是*未定义的行为*：

```
long x = 5;
double *p = (double *)&x;
double y = *p; 
```

而且，有时令人惊讶的是，以下内容也是如此：

```
struct foo { int x; };
struct bar { int x; int y; };
struct bar b = { 1, 2};
struct foo *p = (struct foo *)&b;
int z = p->x; 
```

有时，您**确实**需要转换指针，但鉴于*严格的别名规则*，您必须非常小心。因此，代码中任何出现的指针转换都是您**必须仔细检查其有效性**的地方。因此，您永远不会编写不必要的指针转换。

### tl;博士

简而言之：因为在 C 语言中，**任何***指针*转换的出现都应该为需要特别注意的代码提出一个危险信号，因此您永远不应该编写*不必要*的指针转换。

* * *

旁注：

*   在某些情况下，您实际上*需要*强制转换为`void *`，例如，如果您想打印指针：

    ```
    int x = 5;
    printf("%p\n", (void *)&x); 
    ```

    强制转换在这里是必要的，因为`printf()`它是一个可变参数函数，所以隐式转换不起作用。

*   在 C++ 中，情况有所不同。在处理派生类的对象时，转换指针类型有些常见（并且正确）。`void *`因此，在 C++ 中，到和从的转换**不是**隐式的，这是有道理的。C++ 有一整套不同风格的转换。

* * *

## 回答 #20

> 赞同：17
> 
> 时间：2016-03-30T00:23:45.463

我加入演员表只是为了表明不赞成类型系统中的丑陋漏洞，它允许以下代码段之类的代码在没有诊断的情况下编译，即使没有使用演员表来导致错误的转换：

```
double d;
void *p = &d;
int *q = p; 
```

我希望那不存在（并且它在 C++ 中不存在），所以我投了。它代表了我的品味和我的编程政治。我不仅在投指针，而且在有效地投选票，并[驱逐愚蠢的恶魔](http://dilbert.com/strip/1994-02-03)。*如果我真的* 不能[摆脱愚蠢](http://dilbert.com/strip/1994-02-02)，那么至少让我以抗议的姿态表达我的愿望。

事实上，一个好的做法是`malloc`用返回的函数来包装（和朋友）`unsigned char *`，并且基本上从不`void *`在你的代码中使用。如果您需要指向任何对象的通用指针，请使用`char *`or `unsigned char *`，并在两个方向上进行强制转换。也许可以放纵的一种放松是使用类似`memset`和`memcpy`不使用演员表的功能。

关于强制转换和 C++ 兼容性的主题，如果您编写代码以使其同时编译为 C 和 C++（在这种情况下，您*必须*`malloc`在将其分配给 以外的东西时强制转换返回值`void *`），您可以做一个非常有帮助的为自己做的事情：您可以使用宏进行转换，在编译为 C++ 时转换为 C++ 样式转换，但在编译为 C 时减少为 C 转换：

```
/* In a header somewhere */
#ifdef __cplusplus
#define strip_qual(TYPE, EXPR) (const_cast<TYPE>(EXPR))
#define convert(TYPE, EXPR) (static_cast<TYPE>(EXPR))
#define coerce(TYPE, EXPR) (reinterpret_cast<TYPE>(EXPR))
#else
#define strip_qual(TYPE, EXPR) ((TYPE) (EXPR))
#define convert(TYPE, EXPR) ((TYPE) (EXPR))
#define coerce(TYPE, EXPR) ((TYPE) (EXPR))
#endif 
```

如果您遵守这些宏，那么`grep`在您的代码库中简单搜索这些标识符将显示您的所有演员表在哪里，因此您可以查看其中是否有任何不正确。

然后，如果您定期使用 C++ 编译代码，它将强制使用适当的强制转换。例如，如果您`strip_qual`仅用于删除`const`or `volatile`，但程序更改为涉及类型转换，您将获得诊断，并且您将不得不使用强制转换组合来获得所需的转换。

为了帮助您遵守这些宏，GNU C++（不是 C！）编译器有一个漂亮的特性：为所有出现的 C 样式转换生成一个可选诊断。

```
     -Wold-style-cast（仅限 C++ 和 Objective-C++）
         如果使用旧样式（C 样式）强制转换为非 void 类型，则发出警告
         在 C++ 程序中。新型演员表（dynamic_cast，
         static_cast、reinterpret_cast 和 const_cast）不太容易受到攻击
         到意想不到的效果，更容易搜索。

```

如果您的 C 代码编译为 C++，您可以使用此`-Wold-style-cast`选项找出所有`(type)`可能出现在代码中的强制转换语法，并通过从上述宏（或必要时组合）。

这种转换处理是在“干净的 C”中工作的最大的独立技术理由：结合 C 和 C++ 方言，这反过来在技术上证明了强制转换`malloc`.

* * *

## 回答 #21

> 赞同：16
> 
> 时间：2015-06-12T15:23:56.197

尽可能在 C 中编程时最好的做法是：

1.  使您的程序通过 C 编译器编译并打开所有警告`-Wall`并修复所有错误和警告
2.  确保没有变量声明为`auto`
3.  `-Wall`然后使用带有and的 C++ 编译器对其进行编译`-std=c++11`。修复所有错误和警告。
4.  现在再次使用 C 编译器进行编译。您的程序现在应该可以在没有任何警告的情况下编译，并且包含更少的错误。

此过程允许您利用 C++ 严格类型检查，从而减少错误数量。特别是，此过程会强制您包含`stdlib.h`，否则您将获得

> `malloc`未在此范围内声明

并且还迫使您强制转换结果，`malloc`否则您将得到

> `void*`从到 的无效转换`T*`

或者你的目标类型是什么。

我能找到用 C 而不是 C++ 编写的唯一好处是

1.  C 有一个明确的 ABI
2.  C++ 可能会生成更多代码[异常、RTTI、模板、*运行时*多态性]

请注意，在理想情况下，当将 C 的公共子集与*静态*多态特性一起使用时，第二个缺点应该消失。

对于那些觉得 C++ 严格规则不方便的人，我们可以使用带有推断类型的 C++11 特性

```
auto memblock=static_cast<T*>(malloc(n*sizeof(T))); //Mult may overflow... 
```

* * *

## 回答 #22

> 赞同：16
> 
> 时间：2016-06-29T07:30:41.113

我更喜欢做演员，但不是手动的。我最喜欢的是使用glib 中的`g_new`和`g_new0`宏。如果不使用 glib，我会添加类似的宏。这些宏在不影响类型安全的情况下减少了代码重复。如果类型错误，您将在非空指针之间获得隐式转换，这将导致警告（C++ 中的错误）。如果您忘记包含定义`g_new`and的标头`g_new0`，您将收到错误消息。`g_new`并且`g_new0`两者都采用相同的参数，不像`malloc`那样采用的参数少于`calloc`. 只需添加`0`即可获得零初始化内存。代码可以用 C++ 编译器编译而无需更改。

* * *

## 回答 #23

> 赞同：14
> 
> 时间：2015-09-10T15:58:49.030

强制转换仅适用于 C++ 而不是 C。如果您使用的是 C++ 编译器，则最好将其更改为 C 编译器。

* * *

## 回答 #24

> 赞同：12
> 
> 时间：2017-10-03T13:13:38.653

**malloc 的强制转换在 C 中是不必要的，但在 C++ 中是强制性的。**

在 C 中不需要强制转换，因为：

*   `void *`在 C 的情况下会自动且安全地提升为任何其他指针类型。
*   如果您忘记包含`<stdlib.h>`. 这可能会导致崩溃。
*   如果指针和整数的大小不同，那么您正在通过强制转换隐藏警告，并且可能会丢失返回地址的位。
*   如果指针的类型在其声明时发生更改，则可能还需要更改所有`malloc`被调用和强制转换的行。

另一方面，强制转换可能会增加程序的可移植性。即，它允许将 C 程序或函数编译为 C++。

* * *

## 回答 #25

> 赞同：10
> 
> 时间：2015-07-29T05:53:42.437

void 指针背后的概念是它可以转换为任何数据类型，这就是 malloc 返回 void 的原因。此外，您必须注意自动类型转换。因此，尽管您必须这样做，但并不强制强制转换指针。它有助于保持代码清洁并有助于调试

* * *

## 回答 #26

> 赞同：9
> 
> 时间：2016-07-18T10:36:57.243

void 指针是通用指针，C 支持从 void 指针类型到其他类型的隐式转换，因此不需要显式类型转换。

但是，如果您希望相同的代码在不支持隐式转换的 C++ 平台上完美兼容，则需要进行类型转换，因此这完全取决于可用性。

* * *

## 回答 #27

> 赞同：9
> 
> 时间：2016-11-08T10:09:54.020

1.  如前所述，C 不需要它，但 C++ 需要它。

2.  包括强制转换可能允许 C 程序或函数编译为 C++。

3.  在 C 中这是不必要的，因为 void * 会自动且安全地提升为任何其他指针类型。

4.  **但是，如果您当时进行转换，如果您忘记包含stdlib.h**，它可能会隐藏错误 。这可能会导致崩溃（或者，更糟糕的是，直到稍后在代码的某些完全不同的部分中才会导致崩溃）。

    因为**stdlib.h**包含了 malloc 的原型，所以找到了。在没有 malloc 原型的情况下，标准要求 C 编译器假定 malloc 返回一个 int。如果没有强制转换，则在将此整数分配给指针时发出警告；但是，使用演员表时，不会产生此警告，从而隐藏了一个错误。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2022-01-17T11:11:40.473

主要问题`malloc`是获得*合适的尺寸*。

返回的内存形式`malloc()`是*无类型*的，并且由于简单的强制转换，它不会神奇地获得*有效的类型。*

我想这两种方法都很好，选择应该取决于程序员的意图。

1.  如果为**type**分配内存，则使用强制转换。

`ptr = (T*)malloc(sizeof(T));`

2.  如果为给定指针分配内存，则不要使用强制转换。

`ptr = malloc(sizeof *ptr);`

### 广告 1

第一种方法通过为给定类型分配内存来确保正确的大小，然后对其进行强制转换以确保将其分配给正确的指针。如果使用了不正确的类型，`ptr`那么编译器将发出警告/错误。如果类型`ptr`改变了，那么编译器会指向代码需要重构的地方。

而且，第一种方法可以组合成一个类似于`new`C++中运算符的宏。

```
#define NEW(T) ((T*)malloc(sizeof(T)))
...
ptr = NEW(T); 
```

此外，如果`ptr`is ，此方法有效`void*`。

## 广告 2

第二种方法不关心类型，它通过从指针的类型中获取正确的大小来确保正确的大小。这种方法的主要优点是每当类型`ptr`改变时自动调整存储大小。它可以在重构时节省一些时间（或错误）。

缺点是该方法不起作用，`ptr`但`void*`它可能被认为是一件好事。并且它不适用于 C++，因此不应该在 C++ 程序将使用的头文件中的内联函数中使用它。

就个人而言，我更喜欢第二种选择。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2020-03-05T15:56:20.197

对我来说，这里的带回家和结论`malloc`是完全没有必要在 C 中进行强制转换，但是如果您进行强制转换，它不会影响`malloc`，因为`malloc`仍会为您分配您请求的祝福内存空间。另一个带回家的是人们进行强制转换的原因或原因之一，这是为了使他们能够用 C 或 C++ 编译相同的程序。

可能还有其他原因，但几乎可以肯定，其他原因迟早会让你陷入严重的麻烦。

# emacs - 如何在 Emacs Lisp 中访问当前区域的内容？

> ID：605846
> 
> 赞同：47
> 
> 时间：2009-03-03T10:13:04.267
> 
> 标签：emacs, lisp, region

我想将当前区域的内容作为函数中的字符串访问。例如：

```
(concat "stringa" (get-region-as-string) "stringb") 
```

谢谢

埃德

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-03-03T10:51:18.153

正如starblue所说，`(buffer-substring (mark) (point))`如果设置了标记，则返回该区域的内容。如果您不想要[字符串属性](https://www.gnu.org/software/emacs/manual/html_node/elisp/Text-Properties.html)，则可以使用`'buffer-substring-no-properties`变体。

但是，如果您正在编写*交互式*命令，则有一种更好的方法来获取区域的端点，使用`(interactive "r")`. 下面是一个例子`simple.el`：

```
(defun count-lines-region (start end)
  “打印区域中的行数和字符数。”
  （交互式“r”）
  （消息“区域有 %d 行，%d 个字符”
       (count-lines start end) (- end start)))

```

当从 Lisp 代码调用时，`(interactive ...)`表单被忽略，因此您可以使用此函数通过传递适当的参数来计算缓冲区中*任何*部分的行数，而不仅仅是区域：例如，`(count-lines-region (point-min) (point-max))`计算缩小部分中的行数的缓冲区。但是当交互调用时，`(interactive ...)`表单会被计算，`"r"`代码提供点和标记，作为两个数字参数，最小的在前。

请参阅 Emacs Lisp 手册，第[21.2.1 节使用 Interactive](http://www.gnu.org/software/emacs/manual/html_node/elisp/Using-Interactive.html#Using-Interactive)和[21.2.2 Code Characters for interactive](http://www.gnu.org/software/emacs/manual/html_node/elisp/Interactive-Codes.html#Interactive-Codes)部分。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2009-03-03T10:23:15.333

[`buffer-substring`](http://www.gnu.org/software/emacs/manual/html_node/elisp/Buffer-Contents.html)一起`region-beginning`并且`region-end`可以做到这一点。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-03-03T05:39:35.257

如果您想将 Lisp 代码中的区域内容复制到用户可访问的数据结构（如 kill-ring、X 剪贴板或寄存器），Emacs Lisp 手册建议使用[`filter-buffer-substring`](http://www.gnu.org/software/emacs/manual/html_node/elisp/Buffer-Contents.html#index-filter_002dbuffer_002dsubstring-2827)而不是简单的`buffer-substring`. 在复制之前，该函数应用来自名为 的列表变量的过滤器函数[`filter-buffer-substring-functions`](http://www.gnu.org/software/emacs/manual/html_node/elisp/Buffer-Contents.html#index-filter_002dbuffer_002dsubstring_002dfunctions-2828)。该功能是[在 22.3 版本中添加的](https://www.gnu.org/software/emacs/news/NEWS.22.3)。

# actionscript-3 - #FFFFFF <-> 0xFFFFFF 之间的颜色值是否有转换函数

> ID：605849
> 
> 赞同：1
> 
> 时间：2009-03-03T10:14:38.677
> 
> 标签：actionscript-3, flex3

"#FFFFFF" <-> 0xFFFFFF 之间是否有颜色值的转换函数

我喜欢从 String 中读取一个值并将其转换为十六进制数

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-03T10:32:21.677

用 0x 或空字符串替换 # 并执行 ParseInt("FFFFFF", 16)? 请记住#FFF 是有效的并且等于#FFFFFF。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T15:12:26.293

如果您使用的是 flex 编译器，您可以使用 mx.styles.StyleManager 将命名颜色（例如格式 #xxxxxx 甚至像红色这样的常用名称）转换为 uint。

[API 参考](http://livedocs.adobe.com/flex/2/langref/mx/styles/StyleManager.html#getColorName())

# java - 是否可以删除“类 " 这个 Java 方法的参数？

> ID：605859
> 
> 赞同：1
> 
> 时间：2009-03-03T10:17:55.080
> 
> 标签：java, generics

我有一个带有以下签名的 Java 方法：

```
public <T> List<HtmlOptionsComposite> convertToHtmlOptionsCompositeList
    (List<? extends T> objects, 
     Class<T> clazz, 
     String getValueMethodName, 
     String getDescriptionMethodName, 
     String getDiscontinuedMethodName)
{ ... } 
```

该方法需要该`clazz`参数才能`clazz.getMethod(...)`在每个给定对象上使用反射（），但是我真的需要将其作为参数传递给该方法吗？有什么方法可以重构代码以自动计算出 clazz 应该是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T10:21:34.543

您可以调用`getClass()`列表中的第一个对象。这会给你一个`Class<? extends T>`而不是`Class<T>`虽然 - 特别是这意味着可能会给出一些不应该给出的方法（因为它们`T`本身不是方法）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T11:21:15.523

考虑：

```
public interface T {
    void foo (); 
}

class S {
    private class U implements T {
        public void foo () { ... }
    }

    private class V implements T {
        public void foo () { ... }
    }
} 
```

如果您使用列表的第一个实例的类，则该类可能与列表的其他实例的类不同 - 该列表可能是 SU 和 SV 实例的混合。因此，您需要调用`getClass()`列表中的每个实例。

此外，虽然 T.foo() 是公共的，但 U 和 V 中的实现将无法在 S 之外访问，因为 U 和 V 是私有类。

因此，如果没有 class 参数，那么对于每个元素，您都需要获取其类，按名称查找方法并将该方法设置为可访问。这是可能的，但这比获得一个公共方法要多得多。

# macos - Mac OS X Tiger Server 中的权限问题

> ID：605874
> 
> 赞同：-3
> 
> 时间：2009-03-03T10:25:28.433
> 
> 标签：macos, permissions, administration

我遇到以下问题：

我们的用户正在使用运行 Mac OS Leopard 的 Mac 通过 AFP 连接到运行 Tiger Server（版本 10.4.11）的 Xserve。

在 Xserve 上，我创建了一个名为“staff”的用户组（使用 Directory Admin）并将一些用户帐户放入该组。然后，我创建了我希望他们能够访问的文件夹的组“员工”所有者。

现在，每当任何用户访问服务器上的文件并将其保存时，其权限都会恢复为用户的权限，而不是“员工”的权限。更奇怪的是：当我通过 AFP 创建一个新文件夹并授予“员工”读/写权限时，它立即恢复为“所有人：无访问权限”

我很奇怪。任何指向解决方案的指针将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-17T20:58:49.627

尝试查找 setuid 和 setgid 位对目录的影响。MacOSX 是 Unix，它让我想起了大约八年前我在 HPUX 上遇到的一个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-18T23:19:54.833

我怀疑您需要`setgid`在目录上设置位。见[维基百科](http://en.wikipedia.org/wiki/Setuid#setgid_on_directories)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-17T14:11:10.580

这有点像在黑暗中拍摄，但我在桌面 OSX 的权限上遇到了一些问题，对于服务器 OSX 可能也是如此。

在桌面上，每个新用户都会创建一个与该用户匹配的唯一组。服务器是否以这种方式运行，如果是，您是否尝试过删除该组？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-17T20:53:25.303

看起来这可能是 Leopard 客户端框架中的错误；你用 10.4 客户端盒尝试过同样的事情吗？我说它看起来像一个错误的原因是什么？这个线程： http://lists.psu.edu/cgi-bin/wa?A2=ind0903&L=macenterprise&T=0&F=&S=&P= [204647](http://lists.psu.edu/cgi-bin/wa?A2=ind0903&L=macenterprise&T=0&F=&S=&P=204647)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-21T01:13:59.090

我认为您需要为每个用户设置一个默认/主组，这样虽然文件的所有者可以更改组，但这并不意味着具有组访问权限的每个人都可以访问该文件。还要记住确保您对目录/文件具有组读取和写入权限。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-12T22:52:20.820

打开 ACL，通过 ACL 添加组并设置权限，然后传播。

# java - Proxool 最大连接数

> ID：605876
> 
> 赞同：0
> 
> 时间：2009-03-03T10:25:44.343
> 
> 标签：java, connection-pooling, proxool

我正在使用[proxool](http://proxool.sourceforge.net/) java 连接池（版本 0.9.1）。一切正常，直到我达到最大连接数。如果达到最大连接数 proxool 立即抛出`SQLExcepion`：

```
java.sql.SQLException: Couldn't get connection because we are at maximum 
connection count (n/n) and there are none available 
```

当然，`n`显示的不是最大连接数。

为什么 proxool`SQLException`立即抛出而不是等待可用连接？当然不是永远，但可配置的超时会很棒。

我不知道它是否重要，但我在 Tomcat J2EE 应用程序中使用 proxool。proxool 的参数在中定义，`context.xml`我正在使用[Proxool DataSource Support](http://proxool.sourceforge.net/datasource.html)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T14:58:22.777

我在 proxool 邮件列表上问这个问题，我得到了一个快速但不幸的是否定的[答案](http://sourceforge.net/mailarchive/forum.php?thread_name=b179a41c0903060630y7512fd26j5727fce6f14b4f97%40mail.gmail.com&forum_name=proxool-user)。

现在不支持可配置（或任何类型的）超时，但是有计划实现此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T20:10:28.363

我快速查看了源代码，这看起来像是 ConnectionPool.getConnection 的标准行为。[文档](http://proxool.sourceforge.net/api-dev/org/logicalcobwebs/proxool/ConnectionPool.html#getConnection())说同样的话。

还有其他数据库池库（例如 Apache DBCP 和 C3P0），但您必须进行一些重构才能使用它们。另一种方法是自己包装 getConnection 方法（或修改 proxool 源）并使其按您想要的方式工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T09:45:06.627

您可以使用 Thread.sleep() 来处理它。达到最大连接数时，Proxool 会引发异常。一旦你检测到它，你可以通过调用“Thread.sleep()”等待一段时间，希望在这段时间之后，连接将再次可用。

```
公共连接 getConnection() 抛出 SQLException {
    连接 conn = null;
    而 (conn ==null){
      尝试 {
        conn = DriverManager.getConnection("proxool."+connectionPoolAlias);
      } 捕捉（SQLException e）{
        e.printStackTrace();
        字符串方法名 =e.getStackTrace()[0].getMethodName();
        if (methodName.equalsIgnoreCase("checkSimultaneousBuildThrottle") ||
                                     methodName.equalsIgnoreCase("quickRefuse")){
          尝试{
            线程.sleep(500);
          }catch(InterruptedException 即){}
        }别的{
          扔 e;
        }
      }
    }
    返回连接；
  }

```

# python - 新 Python 文档中使用的搜索引擎是什么？

> ID：605888
> 
> 赞同：14
> 
> 时间：2009-03-03T10:32:52.720
> 
> 标签：python, python-sphinx

它是内置在[Sphinx](http://sphinx.pocoo.org/)中的吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-03T11:43:27.763

看起来 Sphinx 包含自己的英语搜索引擎。请参阅[http://sphinx.pocoo.org/_static/searchtools.js](http://sphinx.pocoo.org/_static/searchtools.js)和 searchindex.js/.json（请参阅[Sphinx 文档索引](http://sphinx.pocoo.org/searchindex.js)36Kb、[Python 文档索引](http://docs.python.org/searchindex.js)857Kb 和[Grok 文档](http://grok.zope.org/doc/dev/searchindex.json)37Kb）。

生成文档时正在预先计算索引。

当一个搜索时，静态页面被加载，然后 _static/searchtools.js 从查询字符串中提取搜索词，规范化（大小写，词干等）它们并在加载时在 searchindex.js 中查找。

第一次搜索尝试需要相当长的时间，连续搜索要快得多，因为索引缓存在浏览器中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-03T11:34:39.547

Sphinx 搜索引擎是用 Javascript 构建的。它使用*JQuery*和一个*（有时非常大）*包含搜索词的 javascript 文件。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-03-03T10:50:02.977

是的。然而，Sphinx 不是内置的。搜索小部件是 sphinx 的一部分。您所说的“内置”是什么意思？

在页面本身：http: [//docs.python.org/about.html](http://docs.python.org/about.html)

[http://sphinx.pocoo.org/](http://sphinx.pocoo.org/)

# performance - 沃斯定律仍然成立吗？

> ID：605889
> 
> 赞同：12
> 
> 时间：2009-03-03T10:33:28.537
> 
> 标签：performance, language-agnostic

[Niklaus Wirth](http://en.wikipedia.org/wiki/Niklaus_Wirth)在 1995 年的格言：

**«软件变慢的速度比硬件变快的速度快»**

*   你认为这是真的吗？
*   您应该如何衡量软件的*“速度”*？按 CPU 周期还是按时间您需要完成某些任务？
*   如果软件实际上变得更快、更精简（以 CPU 周期和 MB 的 RAM 衡量）并且对新版本的响应更快，例如 Firefox 3.0 与 2.0 相比，Linux 2.6 与 2.4 相比，Ruby 1.9 与 1.8 相比，那又如何呢？[还是比旧软件（如 Google 的V8 引擎](http://en.wikipedia.org/wiki/V8_JavaScript_engine)）快几个数量级的全新软件？这不是否定这条法律吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-03T10:48:04.540

是的，我认为这是真的。

如何衡量软件的*速度*？解决任务的好时间是一个相关指标。作为一个软件用户，我不在乎我的机器是 2 核还是 16 核。我希望我的操作系统能够快速启动，我的程序能够快速启动，而且我绝对不想等待诸如打开文件之类的简单事情完成。软件必须*感觉*快。所以 .. 启动 Windows Vista 时，我没有看到快速软件。

软件/框架通常会提高它们的性能。这很好，但这些大多是微小的变化。例外证明了规则:)

在我看来，这一切都与*感觉*有关。感觉就像几年前计算机速度更快。当然，我无法在那些旧机器上运行当前的游戏和软件。但他们只是更快:)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-03T12:03:26.903

并不是软件变慢了，而是它的复杂性增加了。

我们现在建立在许多抽象层次上。
SO上的人们最后一次用汇编语言编码是什么时候？
大多数人从来没有，也永远不会。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-03T10:53:54.713

一般来说，法律是正确的。正如您所说，存在“证明规则”的例外情况。我哥哥最近在他的 2GHz+ 电脑上安装了 Win3.1，它一眨眼就启动了。

我想法律成立的原因有很多：

1.  现在许多进入这个行业的程序员从来没有考虑过有限的速度/资源系统，所以他们从来没有真正考虑过他们的代码的性能。
2.  通常在最后期限之前编写代码具有更高的重要性，性能调整通常在错误修复/新功能之后进行。

我发现 FF 缺少即时启动对话框很烦人，因为在启动应用程序后主窗口需要一段时间才能出现，而且我不确定点击是否“有效”。OO 也受此困扰。

网上有几篇关于在不改变实际速度的情况下改变对软件速度的看法的文章。

编辑：

除了以上几点之外，效率不高的一个例子是这个网站，或者更确切地说，大多数其他问答网站。该网站一直被开发为快速响应，并且显示出来。将此与其他站点进行比较 - 我发现基于 phpBB 的站点很灵活但速度很慢。谷歌是另一个高度重视速度的例子（它甚至告诉你搜索花了多长时间） - 与谷歌开始时周围的其他搜索引擎相比（现在，由于谷歌，它们都很快）。

编写快速代码需要大量的努力、技能和经验，这是我发现许多程序员所缺乏的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-03T11:32:37.290

这是错误的。正确的是

**软件变慢*的速度*与硬件变快的速度相同。**

原因是这主要取决于人类的耐心，它保持不变。它也忽略了提及今天的软件超过 30 年前，即使我们忽略了眼睛糖果。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-03T11:48:23.583

根据我自己的经验，我不得不不同意沃斯定律。

当我第一次接触电脑时（在 80 英寸），显示一张小静止图片的时间是显而易见的。今天我的电脑可以实时解码和显示 1080p AVCHD 电影。

另一个指标是视频游戏的每秒帧数。不久前，它曾经是 15fps 左右。今天，30fps 到 60 fps 的情况并不少见。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-03T11:08:31.637

软件速度慢的问题之一是大多数开发人员使用具有多核 CPU 和 RAM 负载的高端机器作为他们的主要工作站。因此，他们不会轻易注意到性能问题。

他们日常活动的一部分应该是在预期客户将使用的较慢的主流硬件上运行他们的代码。这将展示真实世界的表现，并让他们专注于改善瓶颈。甚至在资源有限的虚拟机中运行也可以帮助进行此审查。

更快的硬件不应该成为创建缓慢草率代码的借口，但它确实如此。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-02T13:07:00.043

引用 UX 研究：

> 21 年的技术进步使现代 PC 处于完全不同的不同容量联盟中。但“用户体验”在过去的二十年里并没有太大变化。由于臃肿的代码必须包含数百个普通用户甚至不知道存在的功能，更不用说曾经使用过，软件公司已经压低了我们的 PC 以有效抵消其巨大的速度优势。

老式 Mac 和现代双核上 UX 的详细比较：http: [//hubpages.com/hub/_86_Mac_Plus_Vs_07_AMD_DualCore_You_Wont_Believe_Who_Wins](http://hubpages.com/hub/_86_Mac_Plus_Vs_07_AMD_DualCore_You_Wont_Believe_Who_Wins)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-03T11:04:25.547

我的机器每天都变得越来越慢和笨拙。我将大部分减速归因于运行防病毒软件。当我想加快速度时，我发现禁用防病毒软件会产生奇迹，尽管我很担心就像在破旧的妓院里一样。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-03-03T11:06:08.757

我认为 Wirth 定律很大程度上是由摩尔定律引起的——如果你的代码运行缓慢，你就会忽略它，因为它运行得足够快。性能并不重要。

现在摩尔定律已经改变了方向（更多的内核而不是更快的 CPU），计算机实际上并没有变得更快，所以我希望性能成为软件开发中更重要的因素（直到一个非常好的并发编程范式达到无论如何，主流）。你知道，软件在仍然有用的同时速度有多慢是有限制的。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-03T11:58:41.703

是的，现在的软件可能更慢或更快，但你不是在比较喜欢和喜欢。该软件现在具有更多功能，并且对它的期望更多。

让我们举个例子：Powerpoint。如果我从 90 年代初开始使用 Powerpoint 创建幻灯片，我可以很容易地制作具有漂亮色彩、漂亮文本等的幻灯片。现在，它是带有移动图形、精美过渡、漂亮图像的幻灯片。

关键是，是的，软件速度较慢，但​​它做得更多。

使用该软件的人也是如此。回到 70 年代，要创建演示文稿，您必须创建自己的透明胶片，甚至可能使用钢笔 :-)。现在，如果你做同样的事情，你会被笑出房间的。它需要相同的时间，但质量更高。

这（在我看来）就是为什么计算机不能提高生产力，因为您花费相同的时间做“工作”。但是，如果您使用今天的软件，您的结果看起来更专业，您的工作质量也会有所提高。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-03-03T12:15:11.353

Skizz 和 Dazmogan 说得对。

*   一方面，当程序员试图让他们的软件花费尽可能少的周期时，他们成功了，而且速度快得令人眼花缭乱。

*   另一方面，当他们不这样做时（大多数情况下），他们对“Galloping Generality”的兴趣会耗尽每个可用的周期，然后是一些。

我做了很多性能调整。（我选择的方法是随机停止。）几乎在所有情况下，速度缓慢的原因都是类和数据结构的过度设计。

奇怪的是，过度事件驱动和冗余数据结构的原因通常是“效率”。

正如 Bompuis 所说，我们建立在许多抽象层之上。这正是问题所在。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-03-03T11:46:47.287

是的，它是正确的。你已经给出了一些突出的例子来反驳这个论点，但请记住，这些例子是由一个知识渊博的大社区开发的，他们或多或少地了解编程的良好实践。

使用内核的人都知道不同的 CPU 架构、多核问题、缓存线等。关于在主线内核中包含硬件性能计数器支持的有趣正在进行的讨论。从“政治”的角度来看，这很有趣，因为内核人员和在性能监控方面拥有丰富经验的人员之间存在冲突。

开发 Firefox 的人明白，浏览器应该是“轻量级的”和快速的才能流行起来。在某种程度上，他们设法做得很好。

新版本的软件应该在更快的硬件上运行，以便获得相同的用户体验。但价格是否公正？我们如何评估功能是否以有效的方式添加？

但是回到主题，很多人在完成学业后并没有意识到与性能、并发相关的问题（甚至更糟的是，他们并不关心）。很长一段时间以来，摩尔定律一直在提供稳定的性能提升。因此，人们编写了平庸的代码，甚至没有人注意到低效的算法、数据结构或更底层的东西有问题。

然后一些限制开始发挥作用（例如热效率），不再可能以几美元的价格获得“轻松”的速度。仅仅依赖硬件性能改进的人可能会洗个冷水澡。另一方面，对算法、数据结构、并发问题有深入了解的人（很难招聘这些......）将继续编写好的应用程序，他们在就业市场上的价值将会增加。

Wirth 定律不应仅按字面意思解释，它还与糟糕的代码膨胀、违反保持简单愚蠢的规则以及浪费机会使用“更快”硬件的人有关。

此外，如果您碰巧在 HPC 领域工作，那么这些问题就会变得非常明显。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-03-03T12:34:53.987

在某些情况下并非如此：游戏的帧速率和多媒体内容的显示/播放今天比几年前要好得多。

在一些极其常见的情况下，法律非常非常适用。在 Vista 中打开“我的电脑”窗口以查看您的驱动器和设备需要 10-15 秒，感觉就像我们在倒退。我*真的*不想在这里引发任何争议，但正是这一点以及打开 Photoshop 所需的巨大时间差异驱使我离开 Windows 平台并转向 Mac。关键是，这种常见任务的放缓严重到足以让我跳出我以前的舒适区以摆脱它。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2011-02-01T19:31:35.600

找不到道理。为什么这句话是法律？

你永远无法比较软件和硬件，它们太不同了。

硬件是真正的材料，软件是书面代码。

连接只是软件必须控制硬件的性能。在硬件中执行步骤后，软件需要完成标志，因此可以完成软件的下一个订单。

为什么要减慢软件速度？我们总是试图让它更快！

为了使硬件更快（更改打印模块甚至计算机的物理部件），需要以真正的物理方式做很多事情。

如果 Wirth 意味着：在一台计算机上执行此操作（= 一个软件和硬件系统），这可能是有意义的。

为了获得更高的硬件速度，有必要了解硬件的功能、某一时刻并行输入或输出的数量以及一秒钟内可能开关的频率。最后同样重要的是，不同的硬件打印具有相同的或具有数字因子的乘法频率。

因此，如果您更改硬件中的某些内容，软件可能会很容易自动变慢。- Wirth 在硬件方面的思考更多，他是伟大的发明家之一，因为计算机存在于德语地区。

另一种方式并不容易。您必须非常准确地了解计算机的系统软件，才能通过更改计算机的软件（=系统软件，机器程序）来加快硬件速度。如果你使用更多的层，你几乎对硬件的速度没有直接影响。

也许这可能是沃斯法则思维的解释……我明白了！

# java - Sort a single String in Java

> ID：605891
> 
> 赞同：152
> 
> 时间：2009-03-03T10:34:09.037
> 
> 标签：java, string, sorting

Is there a native way to sort a String by its contents in java? E.g.

```
String s = "edcba"  ->  "abcde" 
```

* * *

## 回答 #1

> 赞同：239
> 
> 时间：2009-03-03T10:37:32.773

`toCharArray` followed by `Arrays.sort` followed by a String constructor call:

```
import java.util.Arrays;

public class Test
{
    public static void main(String[] args)
    {
        String original = "edcba";
        char[] chars = original.toCharArray();
        Arrays.sort(chars);
        String sorted = new String(chars);
        System.out.println(sorted);
    }
} 
```

EDIT: As tackline points out, this will fail if the string contains surrogate pairs or indeed composite characters (accent + e as separate chars) etc. At that point it gets a lot harder... hopefully you don't need this :) In addition, this is just ordering by ordinal, without taking capitalisation, accents or anything else into account.

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-03-03T10:37:43.443

No there is no built-in String method. You can convert it to a char array, sort it using Arrays.sort and convert that back into a String.

```
String test= "edcba";
char[] ar = test.toCharArray();
Arrays.sort(ar);
String sorted = String.valueOf(ar); 
```

Or, when you want to deal correctly with locale-specific stuff like uppercase and accented characters:

```
import java.text.Collator;
import java.util.Arrays;
import java.util.Comparator;
import java.util.Locale;

public class Test
{
  public static void main(String[] args)
  {
    Collator collator = Collator.getInstance(new Locale("fr", "FR"));
    String original = "éDedCBcbAàa";
    String[] split = original.split("");
    Arrays.sort(split, collator);
    String sorted = "";
    for (int i = 0; i < split.length; i++)
    {
      sorted += split[i];
    }
    System.out.println(sorted); // "aAàbBcCdDeé"
  }
} 
```

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2015-03-02T22:19:43.443

在 Java 8 中，它可以通过以下方式完成：

```
String s = "edcba".chars()
    .sorted()
    .collect(StringBuilder::new, StringBuilder::appendCodePoint, StringBuilder::append)
    .toString(); 
```

使用长度为 1 的字符串流（未排序字符串中的每个字符都转换为流中的字符串）的稍短的替代方法是：

```
String sorted =
    Stream.of("edcba".split(""))
        .sorted()
        .collect(Collectors.joining()); 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2013-02-16T09:12:48.473

[转换为字符数组](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#toCharArray%28%29)→[排序](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#sort%28char%5B%5D%29)→[转换回字符串](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#String%28char%5B%5D%29)：

```
String s = "edcba";
char[] c = s.toCharArray();        // convert to array of chars 
java.util.Arrays.sort(c);          // sort
String newString = new String(c);  // convert back to String
System.out.println(newString);     // "abcde" 
```

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2013-02-16T08:59:54.817

一种更原始​​的方法，不使用 sort Arrays.sort 方法。这是使用插入排序。

```
public static void main(String[] args){
    String wordSt="watch";
    char[] word=wordSt.toCharArray();

    for(int i=0;i<(word.length-1);i++){
        for(int j=i+1;j>0;j--){
            if(word[j]<word[j-1]){
                char temp=word[j-1];
                word[j-1]=word[j];
                word[j]=temp;
            }
        }
    }
    wordSt=String.valueOf(word);
    System.out.println(wordSt);
} 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2009-03-03T10:43:31.463

```
 String a ="dgfa";
    char [] c = a.toCharArray();
    Arrays.sort(c);
    return new String(c); 
```

Note that this will not work as expected if it is a mixed case String (It'll put uppercase before lowercase). You can pass a comparator to the Sort method to change that.

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-03-28T13:26:41.167

程序 ：

1.  首先将字符串转换为char数组
2.  然后对字符数组进行排序
3.  将字符数组转换为字符串
4.  打印字符串

代码片段：

```
 String input = "world";
    char[] arr = input.toCharArray();
    Arrays.sort(arr);
    String sorted = new String(arr);
    System.out.println(sorted); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-03-18T10:47:08.447

问题：在java中对字符串进行排序

```
public class SortAStringInJava {
    public static void main(String[] args) {

        String str = "Protijayi";
// Method 1
        str = str.chars() // IntStream
                .sorted().collect(StringBuilder::new, StringBuilder::appendCodePoint, StringBuilder::append).toString();

        System.out.println(str);
        // Method 2
        str = Stream.of(str.split(" ")).sorted().collect(Collectors.joining());
        System.out.println(str);
    }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-01-14T18:34:39.373

```
str.chars().boxed().map(Character::toString).sorted().collect(Collectors.joining()) 
```

或者

```
s.chars().mapToObj(Character::toString).sorted().collect(Collectors.joining()) 
```

或者

```
Arrays.stream(str.split("")).sorted().collect(Collectors.joining()) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-02-28T20:45:57.557

使用 Stream API 并处理 Unicode 补充字符的解决方案：

```
public static String sort(final String s) {
    return s.codePoints()
            .sorted()
            .collect(StringBuilder::new, StringBuilder::appendCodePoint, StringBuilder::append)
            .toString();
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-24T16:06:00.843

如果您想将最坏情况的时间复杂度`nlogn`从`n`

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2017-07-11T12:30:20.773

```
public static void main(String[] args) {
    String str = "helloword";   
    char[] arr;
    List<Character> l = new ArrayList<Character>();
    for (int i = 0; i < str.length(); i++) {
        arr = str.toCharArray();
        l.add(arr[i]);

    }
    Collections.sort(l);
    str = l.toString();
    System.out.println(str);
    str = str.replaceAll("\\[", "").replaceAll("\\]", "")
            .replaceAll("[,]", "");
    System.out.println(str);

} 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2017-11-28T11:50:16.123

在 Java 中不使用集合：

```
import java.util.Scanner;

public class SortingaString {
    public static String Sort(String s1)
    {
        char ch[]=s1.toCharArray();         
        String res=" ";

        for(int i=0; i<ch.length ; i++)
        {
            for(int j=i+1;j<ch.length; j++)
            {
                if(ch[i]>=ch[j])
                {
                    char m=ch[i];
                    ch[i]=ch[j];
                    ch[j]=m;
                }
            }

            res=res+ch[i];

        }

        return res;
    }

    public static void main(String[] args) {
        Scanner sc=new Scanner(System.in);
        System.out.println("enter the string");

        String s1=sc.next();
        String ans=Sort( s1);

        System.out.println("after sorting=="+ans);
    }
} 
```

输出：

> 输入字符串==
> 
> 排序
> 
> 排序后== ginorst

# django - Django：查询没有主键的只读视图

> ID：605896
> 
> 赞同：29
> 
> 时间：2009-03-03T10:36:46.643
> 
> 标签：django, django-models

```
class dbview(models.Model):
    # field definitions omitted for brevity
    class Meta:
        db_table = 'read_only_view'

def main(request):
    result = dbview.objects.all() 
```

渲染时遇到异常：（1054，“'字段列表'中的未知列'read_only_view.id **'** ”）

我在视图中看**不到主键。**有解决方法吗？

评论：
我无法控制使用 Django 访问的视图。MySQL 浏览器在那里显示列但没有主键。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-04T10:50:30.487

当你说‘我无法控制我使用 Django 访问的视图时。MySQL 浏览器在那里显示列，但没有主键。

我假设您的意思是这是一个旧表，并且您不允许添加或更改列？

如果是这样并且确实没有主键（即使是字符串或非 int 列*），那么该表还没有设置好，性能可能很糟糕。

不过对你来说没关系。您所需要的只是保证每一行都是唯一的列。在您的模型中将其设置为 'primary_key = True ，Django 会很高兴。

*   还有另一种可能存在问题。如果没有保证唯一的列，则该表可能正在使用复合主键。也就是说 - 它指定将两列放在一起将提供一个唯一的主键。这是完全有效的关系建模，但不幸的是 Django 不支持。在这种情况下，除了原始 SQL 之外，您无能为力，除非您可以添加另一列。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-07-21T18:48:37.020

我一直有这个问题。我有一个不能或不想更改的视图，但我希望有一个页面来显示复合信息（可能在管理部分）。我只是覆盖保存并引发 NotImplementedError：

```
 def save(self, **kwargs):
        raise NotImplementedError() 
```

（虽然这在大多数情况下可能不需要，但它让我感觉好一点）

我还在 Meta 类中将 managed 设置为 False。

```
 class Meta:
       managed = False 
```

然后我只需选择任何字段并将其标记为主键。它是否真的独一无二并不重要，您只是在做过滤器以在页面上显示信息等。

似乎对我来说工作得很好。如果我忽略了这种技术有任何问题，请发表评论。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-03T11:51:13.377

如果视图中确实*没有主键*，则没有解决方法。

[Django 要求每个模型只有一个字段`primary_key=True`。](http://docs.djangoproject.com/en/dev/topics/db/models/#id1)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-03T11:40:18.003

运行时应该有一个自动生成的`id`字段`syncdb`（如果您的模型中没有定义主键，那么 Django 会`AutoField`为您插入一个）。

此错误意味着 Django 正在向您的数据库询问该`id`字段，但不存在。你可以运行`django manage.py dbshell`然后`DESCRIBE read_only_view;`发布结果吗？这将显示数据库中的所有列。

或者，您可以包含您排除的模型定义吗？（并确认您在运行后没有更改模型定义`syncdb`？）

# lucene.net - 为什么这个 Lucene 查询是“包含”而不是“startsWith”？

> ID：605899
> 
> 赞同：6
> 
> 时间：2009-03-03T10:37:06.220
> 
> 标签：lucene.net, startswith

```
string q = "m";
Query query = new QueryParser("company", new StandardAnalyzer()).Parse(q+"*"); 
```

将导致查询成为 prefixQuery :company:a*

我仍然会得到像“非洲舰队”这样的结果，很明显 A 不是在开始，因此给了我不想要的结果。

```
Query query = new TermQuery(new Term("company", q+"*")); 
```

将导致查询成为 termQuery :company:a* 并且不返回任何结果。可能是因为它将查询解释为完全匹配，而我的值都不是“a*”文字。

```
Query query = new WildcardQuery(new Term("company", q+"*")); 
```

将返回与前缀查询相同的结果；

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-03-30T11:20:05.920

StandardAnalyzer 会将“Fleet Africa”标记为“fleet”和“africa”。您的 a* 搜索将匹配后面的术语。

如果您想将“Fleet Africa”视为一个单独的术语，请使用不会在空格上分解字符串的分析器。KeywordAnalyzer 就是一个示例，但您可能仍希望将数据小写，以便查询不区分大小写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T10:53:12.873

简短的回答：您的所有查询都不会将搜索限制在字段的开头。你需要一个[EdgeNGramTokenFilter](http://lucene.apache.org/java/2_3_0/api/org/apache/lucene/analysis/ngram/EdgeNGramTokenFilter.html)或类似的东西。有关 Lucene 中自动完成的实现，请参阅[此问题](https://stackoverflow.com/questions/120180/how-to-do-query-auto-completionsuggestions-in-lucene)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-16T12:17:18.657

另一种解决方案可能是使用 StringField 来存储 ex 的数据：“Fleet Africa” 然后使用 WildCardQuery.. 现在 f* 或 F* 会给出结果，但 A* 或 a* 不会。

**StringField 已编入索引但未标记化。**

# silverlight - Silverlight：“名称已存在于树中”

> ID：605907
> 
> 赞同：4
> 
> 时间：2009-03-03T10:41:11.280
> 
> 标签：silverlight, xaml, user-controls, tooltip

这是我编写 Silverlight XAML 时经常出现的问题。在这种情况下，我制作了一个附加了 ToolTip 的用户控件 VerticalTabStop（附加代码）。我实例化了几个用户控件，然后我得到调试窗口和以下错误：

```
Line:52
Error: Unhandled Error in Silverlight 2 Application
Code: 2028
Category: ParserError
Message: The name already exists in the tree: AltLabel.
File:
Line: 0
Position: 0 
```

当我将鼠标悬停在按钮上时，我收到了很多这样的消息。对我在这里做错了什么有什么建议吗？

干杯

```
Nik

<UserControl
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    x:Class="SLEntityPresenterWebPart.VerticalTabStop"
    d:DesignWidth="20" d:DesignHeight="27">

    <Grid x:Name="LayoutRoot">
        <StackPanel>
            <Canvas x:Name="TabStopCanvas" Height="27" Width="20">
                <ToolTipService.ToolTip>
                    <TextBlock x:Name="AltLabel" Text="Substitute me"/>
                </ToolTipService.ToolTip>
                <Image x:Name="IconImg" Canvas.Left="7" Canvas.Top="9" Width="26" Height="26" Source="Contact.png" Canvas.ZIndex="5" Margin="0,-9,0,0" RenderTransformOrigin="0.5,0.5">
                    <Image.RenderTransform>
                        <TransformGroup>
                            <ScaleTransform ScaleX="0.85" ScaleY="0.85"/>
                            <SkewTransform/>
                            <RotateTransform/>
                            <TranslateTransform X="0"/>
                        </TransformGroup>
                    </Image.RenderTransform>
                </Image>
                <Image Source="stop.png" Margin="3,0,0,0"/>
            </Canvas>

        </StackPanel>
    </Grid>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-04-06T18:40:32.943

即使在 Silverlight 4 中也有非常相似的错误。如果您创建自定义用户控件，通常：

```
<UserControl xmlns:MyNameSpace="clr-namespace:MyNameSpace" x:Class="MyNameSpace.MyClass" 
x:Name="userControl" ... /> 
```

然后，如果您在 xaml 代码中添加 2 个没有名称的控件（带预览）：

```
<MyNameSpace:MyClass ... />
<MyNameSpace:MyClass ... /> 
```

将出现异常“名称已存在于树中：userControl”。发生这种情况是因为 Silverlight 找不到名称（未命名 [MyClass]）并查看 UserControl，它在其中两次找到“userControl”。

解决方案之一是为控件命名：

```
<MyNameSpace:MyClass x:Name = "MyControl1" ... /> 
```

或者从代码初始化这个控件：

```
MyClass control = new MyClass();
SomeGrid.Children.Add(control); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-05T04:21:47.323

这是 Silverlight 中的一个错误。解决此问题的方法是删除工具提示中 TextBlock 上的 Name 属性。

我想你有这个名字是有原因的，而且不能从代码中引用这个元素对你来说是个问题。作为解决此问题的方法，请尝试将工具提示 xaml 替换为：

```
<ToolTipService.ToolTip>
    <ToolTip x:Name="AltLabel" Content="Substitute me" />
</ToolTipService.ToolTip> 
```

现在您可以通过执行 AltLabel.Content 来获取文本。如果这不能解决您的问题，请告诉我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-17T11:04:13.937

昨天我正在为同样的消息而苦苦挣扎...... **ParserError - 树中已经存在该名称：** *blah*

就我而言，问题在于以某种方式添加了一个引用……给自己。（项目自己的 bin/debug 文件夹中的项目 DLL）。删除此引用解决了问题。

似乎这个错误信息太模糊了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-03T19:42:42.323

尝试在堆栈面板中删除任何名称，如 ' x:Name="TabStopCanvas" '，它对我有用。

# c++ - 单元测试一个类是不可复制的，以及其他编译时属性

> ID：605915
> 
> 赞同：19
> 
> 时间：2009-03-03T10:45:33.923
> 
> 标签：c++, unit-testing, compiler-errors

有没有办法测试编译时错误，但实际上不产生错误？例如，如果我创建了一个不可复制的类，我想测试尝试复制它会产生编译器错误的事实，但我仍然想执行其他运行时测试。

```
struct Foo {
    int value_;
    Foo(int value) : value_(value) {}
  private:
    Foo(const Foo&);
    const Foo& operator=(const Foo&);
};

int main()
{
    Foo f(12);
    assert(f.value_ == 12);
    assert(IS_COMPILER_ERROR(Foo copy(f);));
} // Would like this to compile and run fine. 
```

我想这不能像那样简单地完成，但是有没有一种惯用的方法来做到这一点，或者我应该推出自己的解决方案（也许使用脚本编译单独的测试文件并测试结果？）？

注意：我使用 non-copyable 只是为了说明我的观点，所以我对使用 boost::noncopyable 等的答案不感兴趣。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-04T01:05:00.613

您可以使用 make 来完成。每个测试都是一个代码片段。这是一个工作示例，其中包含 2 个 VC++ 测试。（我使用了 2 个批处理文件进行通过测试和失败测试）。我在这里使用 GNU make。

生成文件：

```
 FAILTEST = .\failtest.bat
PASSTEST = .\passtest.bat

tests: must_fail_but_passes \
    must_pass_but_fails

must_fail_but_passes:
    @$(FAILTEST) $@.cpp

must_pass_but_fails:
    @$(PASSTEST) $@.cpp 
```

must_pass_but_fails.cpp

```
 struct Foo {
    int value_;
    Foo(void) : value_(0) {}
  private:
    Foo(const Foo&);
    const Foo& operator=(const Foo&);
};

int main()
{
    Foo f(12);
    return 0;
} 
```

must_fail_but_passes.cpp

```
 struct Foo {
    int value_;
    Foo(int value) : value_(value) {}
  private:
    Foo(const Foo&);
    const Foo& operator=(const Foo&);
};

int main()
{
    Foo f(12);
    return 0;
} 
```

passtest.bat

```
 @echo off
cl /nologo %1 >NUL
if %errorlevel% == 0 goto pass
@echo %1 FAILED
:pass 
```

失败测试.bat

```
 @echo off
cl /nologo %1 >NUL
if not %errorlevel% == 0 goto pass
@echo %1 FAILED
:pass 
```

请注意，cl.exe（即 Visual Studio 编译器）需要在您的路径中才能“正常工作”

玩得开心！

PS我怀疑这会让我出名:-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-02-18T11:18:40.020

顺便说一句，我所知道的唯一允许这种开箱即用测试的构建系统是 Boost.Build：

在这里检查” [http://beta.boost.org/boost-build2/doc/html/bbv2/builtins/testing.html](http://beta.boost.org/boost-build2/doc/html/bbv2/builtins/testing.html)

例如，

```
# in your Jamfile
compile-fail crappy.cpp ; 
```

.

```
int main()
{
  my crappy cpp file
} 
```

有关更多示例，`grep -R compile-fail`请参见您的`BOOST_TOP_DIR\libs`目录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T10:57:41.943

不幸的是，没有简单的方法可以按照您想要的方式测试编译错误，我之前也想这样做。

无论如何，如果您的测试足够小，您可以编写简短的不可编译代码，例如您的示例，并使用脚本验证生成的错误是否正确（再次说明）。

这类事情的一个例子是 Unix 的配置脚本，在我看到的不止几个脚本中，他们尝试编译小样本来验证编译器的版本/能力，以正确配置 makefile。

所以至少你可以知道你并不孤单。现在，如果你为这类事情编写了一个成功的测试框架，你可能会成名:)

**编辑：**您也可以使用#define 尝试或不编译无法编译的代码，如下所示：

```
#ifdef _COMPILETEST
#define TRY_COMPILE(...) (__VA_ARG__)
#else
#define TRY_COMPILE(...)
#end 
```

请注意，这是我刚刚想到的事情，这种模式可能存在很多问题，但它可能会成为一些更好想法的种子。

# c# - WinForms 标签不想透明的原因是什么？

> ID：605920
> 
> 赞同：29
> 
> 时间：2009-03-03T10:46:54.683
> 
> 标签：c#, winforms, transparency

为什么我不能将标签的背景颜色设置为透明？我以前做过，但现在它只是不想......

我创建了一个新的 UserControl，添加了一个进度条和一个标签。当我将标签的 BackColor 设置为透明时，它仍然是灰色 =/ 这是为什么？

我想要的是将标签放在进度条顶部，以便其文本在进度条“中”...

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-03T21:22:16.030

向您的项目添加一个新类并发布如下所示的代码。建造。将新控件从工具箱顶部拖放到表单上。

```
using System;
using System.Windows.Forms;

public class TransparentLabel : Label {
  public TransparentLabel() {
    this.SetStyle(ControlStyles.Opaque, true);
    this.SetStyle(ControlStyles.OptimizedDoubleBuffer, false);
  }
  protected override CreateParams CreateParams {
    get {
      CreateParams parms = base.CreateParams;
      parms.ExStyle |= 0x20;  // Turn on WS_EX_TRANSPARENT
      return parms;
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-03T10:57:22.023

WinForms 并不真正支持透明控件，但是你可以自己制作一个透明控件。[在这里查看我的答案](https://stackoverflow.com/questions/373913/setting-the-parent-of-a-usercontrol-prevents-it-from-being-transparent/373961#373961)。

在您的情况下，您可能应该子类化进度条并覆盖 OnPaint 方法以在进度条上绘制文本。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-08-09T07:33:12.960

最简单的解决方案如下：

1.  在可视化编辑器或表单的构造函数中将背景颜色设置为透明度：

    this.label1.BackColor = System.Drawing.Color.Transparent;

2.  设置标签的 Parent 属性以控制您希望在文本后面可见。这可以在表单构造函数或 Load 方法中完成：

    this.label1.Parent = progressBar1;

确实，这不是 DirectX 中的真正透明度。您在显示上看到的结果仅由两层组成。你不能用这种方法总结超过两层（每一层都有自己的透明度，由 alpha 参数定义）。但它适用于您在 Winforms 编程中可能遇到的许多实际情况。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-03-25T21:50:48.777

使用 LinkLabel 而非普通标签

```
 private void MakeTransparentLabel(System.Windows.Forms.LinkLabel LinkLabel)
    {
        this.MakeTransparentLabel(LinkLabel, Color.White);
    }
    private void MakeTransparentLabel(System.Windows.Forms.LinkLabel LinkLabel, Color ForeColor)
    {
        LinkLabel.ForeColor = ForeColor;
        LinkLabel.LinkColor = ForeColor;
        LinkLabel.VisitedLinkColor = ForeColor;
        LinkLabel.ActiveLinkColor = ForeColor;
        LinkLabel.DisabledLinkColor = ForeColor;
        LinkLabel.LinkArea = new LinkArea(0, 0);
        LinkLabel.LinkBehavior = LinkBehavior.NeverUnderline;
        LinkLabel.Cursor = Cursors.Arrow;
        LinkLabel.BackColor = Color.Transparent;
    }
    private void SetTransparentLabelText(System.Windows.Forms.LinkLabel LinkLabel, string Text)
    {
        if (string.IsNullOrEmpty(Text)) { LinkLabel.Text = " "; return; }
        LinkLabel.Text = Text;
    } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-02-12T10:54:56.260

这是一个非常简单的解决方案，效果很好：

```
public class MyLabel : Label
{
    private bool fTransparent = false;
    public bool Transparent
    {
        get { return fTransparent; }
        set { fTransparent = value; }
    }
    public MyLabel() : base()
    {
    }
    protected override CreateParams CreateParams
    {
        get
        {
            if (fTransparent)
            {
                CreateParams cp = base.CreateParams;
                cp.ExStyle |= 0x00000020; //WS_EX_TRANSPARENT
                return cp;
            }
            else return base.CreateParams;
        }
    }
    protected override void WndProc(ref Message m)
    {
        if (fTransparent)
        {
            if (m.Msg != 0x14 /*WM_ERASEBKGND*/ && m.Msg != 0x0F /*WM_PAINT*/)
                base.WndProc(ref m);
            else 
            {
                if (m.Msg == 0x0F) // WM_PAINT
                    base.OnPaint(new PaintEventArgs(Graphics.FromHwnd(Handle), ClientRectangle));
                DefWndProc(ref m);
            }
        }
        else base.WndProc(ref m);
    }
} 
```

当标签背景颜色为透明时，标签仅在第一次创建时拍摄其底层控件，之后标签背景颜色为常数。每次标签重新绘制自身时，它都会重新绘制为固定的颜色或图案。

覆盖 CreateParams 会影响控件窗口的创建方式，从而实现真正的透明度。

覆盖 WndProc 您可以控制应将哪些消息传递给基类。我们必须过滤 WM_ERASEBKGND 和 WM_PAINT，但我们还必须触发绘制事件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-03T11:13:29.003

如果您想专注于设计您的 Windows 应用程序，我建议您使用 WPF。

在 WPF 中使控件透明是非常容易的。

```
<TextBox Width="200" Height="40" Opacity="0.5"/> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-05-26T14:54:54.763

这是我不久前写的一个透明控件，它显示旋转的文本。大部分代码都来自[这里](https://web.archive.org/web/20141227200000/http://bobpowell.net/transcontrols.aspx)，尽管 IIRC 我必须进行一些调整才能使其正常工作。

```
using System;
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Drawing.Text;
using System.Linq;
using System.Windows.Forms;

namespace MyNamespace
{
    public partial class RotatedText : UserControl
    {
        private readonly Timer _invalidationTimer;
        private const int WS_EX_TRANSPARENT = 0x00000020;

        public RotatedText()
        {
            this.SetStyle(ControlStyles.SupportsTransparentBackColor, true);
            InitializeComponent();

            _invalidationTimer = new Timer {Interval = 500, Enabled = true};
            _invalidationTimer.Tick += TickHandler;
        }

        [Browsable(true)]
        [DesignerSerializationVisibility(DesignerSerializationVisibility.Visible)]
        [Category("Appearance")]
        [Description("Text which appears in control")]
        public string Text { get; set; }

        #region Transparent background
        protected override CreateParams CreateParams
        {
            get
            {
                CreateParams cp = base.CreateParams;
                cp.ExStyle |= WS_EX_TRANSPARENT;
                return cp;
            }
        }

        private void TickHandler(object sender, EventArgs e)
        {
            InvalidateEx();
        }

        private void InvalidateEx()
        {
            if (Parent != null)
                Parent.Invalidate(Bounds, false);
            else
                Invalidate();
        }

        protected override void OnPaintBackground(PaintEventArgs e)
        {
            //Intentionally do nothing - stops background from drawing
            //base.OnPaintBackground(e);
        } 
        #endregion

        //Rotate text and draw
        protected override void OnPaint(PaintEventArgs e)
        {
            double angleRadians = Math.Atan2(Height, Width);
            float angleDegrees = -1*(float) (angleRadians*180/Math.PI);
            angleDegrees *= 0.9f;
            e.Graphics.RotateTransform(angleDegrees, MatrixOrder.Append);
            e.Graphics.TranslateTransform(20, Height - 75, MatrixOrder.Append);
            e.Graphics.TextRenderingHint = TextRenderingHint.AntiAliasGridFit;
            Font font = new Font("Ariel", 50);
            e.Graphics.DrawString(Text, font, Brushes.Gray, 1, 2); //Shadow
            e.Graphics.DrawString(Text, font, Brushes.Red, 0, 0);
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T10:50:58.340

因此，正如对我之前回答的评论所述，控制是默认行为，并且我记得是透明的。

无论如何，您是否尝试过设置 UserControl 的背景属性或标签所在的容器（面板、表单等？），您的标签应该反映该颜色 :)

* * *

旧答案：我已经有一段时间没有进行 winforms 编程了，但我记得标签默认是透明的？因此，它只有获得实际颜色的文本，而免费的颜色模仿它背后的任何东西:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-05T17:30:11.570

完全可以做到你想要达到的目标。玩控件只需要一点时间。可以创建一个具有透明背景的 Label 控件，并将其放在 Progressbar 控件的顶部。

检查[我对](https://stackoverflow.com/questions/1517179/c-overriding-onpaint-on-progressbar-not-working/1519913#1519913)另一个 SO 问题的回答。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-05T17:42:00.207

至于对您的问题的解释，Windows 不会像您期望的那样对背景控件进行透明度 - 我猜灰色背景实际上是表单的表面。在表单表面和标签之间绘制的任何控件都将被忽略。

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2010-02-13T03:01:16.510

选择**BackColor**，转到 Web 选项卡，然后选择透明。生成以下内容。

```
 this.label1.BackColor = System.Drawing.Color.Transparent; 
```

# oracle - How to call a function with Rowtype parameter from a select statement in Oracle

> ID：605925
> 
> 赞同：7
> 
> 时间：2009-03-03T10:49:09.763
> 
> 标签：oracle, stored-procedures

I have an oracle function which has an in parameter which is of rowtype of a table, from a select statement i need to pass the current row to this function so that it does some processing and returns a value. Is there a pseudo variable that can be used within the context of a select statement something equivalent to a old and new in trigger.

I would like to do something like

```
select *,function1(rowtype) from table1 
```

I want to avoid passing multiple parameters, so the question should be seen in that context.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T17:03:20.083

您不能使用 %ROWTYPE 执行此操作。%ROWTYPE实际上是PL/SQL记录类型，在SQL中不是合法类型，所以不能在SELECT中使用。您应该创建一个与表具有相同列的对象类型，更改为期望该对象类型而不是 %ROWTYPE 的函数，然后您可以编写如下内容：

```
SELECT function(table1_typ(column1, column2, column3))
  FROM table1 t1 
```

缺点：您仍然必须在 SELECT 中键入所有列，并且如果您更改表，则还需要更改对象类型和 SELECT。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T11:05:40.753

Why not just pass the id of the row in and make the function work on that?

* * *

EDIT: You might be able to construct an OBJECT / TYPE on the fly and pass that to a function. Then you'll only need to query for the data once. Let me know if you need an example.

* * *

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-03T11:06:03.453

你可以这样做：

```
DECLARE
    foo table1%ROWTYPE;
BEGIN
     function1(foo);
END; 
```

编辑：您可以查看[此博客文章](http://itq.nl/how-to-call-oracle-stored-procedure-with-rowtype-inout-parameter-directly-from-code/)以获取有关如何使用此技术的更详细说明。

# jsf - JBoss Richfaces ModalPanel - 基于条件的调用

> ID：605929
> 
> 赞同：0
> 
> 时间：2009-03-03T10:50:17.250
> 
> 标签：jsf

我正在使用 JBoss Richfaces，当发生特定情况时，我需要调用 rich:modalPanel。

示例代码在这里——

这是模态面板

```
<rich:modalPanel  id="show_alert" height="125" width="325" zindex="2000">
                <h:outputText value="shamik testing"/><br/>
                <a4j:commandButton value="#{uiLabel.no}" onclick="#             {rich:component('show_alert')}.hide()" styleClass="button"/>
</rich:modalPanel> 
```

当有人单击此链接时，我想显示模式面板。

```
<a4j:commandLink value="#{uiLabel.config_ret}" id = "aaa"

actionListener="#{aging.configureRetention}"                            reRender="cp_tab_form">
<rich:componentControl for="show_alert" attachTo="aaa" operation="show" event="onclick"/>           
</a4j:commandLink> 
```

我正在尝试使 operation="#{bean.cond}" 使操作的名称动态出现。但不工作。

我想在 bean.cond = false 时调用 operation = hide，在 bean.cond = true 时调用 operation = show。

我可能在这里做一些非常愚蠢的事情:-(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T11:04:29.617

抱歉发布它.. 我没有重新渲染 commandLink :-( 抱歉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T13:07:45.097

您还可以查看使用 a4j:commandLink 的“数据”属性来返回 bean.cond 的值

# php - HTML+CSS to RTF (in PHP)?

> ID：605936
> 
> 赞同：17
> 
> 时间：2009-03-03T10:54:21.157
> 
> 标签：php, html, css, rtf

I am seeking a solution to converting HTML + CSS (2.1) to RTF in PHP. While I have found a superb solution for HTML to PDF in [Prince XML](http://www.princexml.com), I've yet to find anything that:

*   can convert HTML to RTF (or DOC);
*   runs on a Linux server;
*   is callable from PHP;
*   handles paged media and the ability to add page headers and footers; and
*   handles tables.

Is there anything out there?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-14T06:56:56.900

最简单的方法是使用**phpLiveDocx**。它是 Zend 框架的组件，完全免费。

支持的模板文件格式（输入）

*   DOCX - Microsoft Word DOCX 格式
*   DOC - Microsoft Word DOC 格式
*   RTF - 富文本格式文件
*   TXD - TX 文本控制格式

支持的文档文件格式（输出）

*   DOCX - Microsoft Word DOCX 格式
*   DOC - Microsoft Word DOC 格式
*   RTF - 富文本格式文件
*   PDF - Acrobat 可移植文档格式
*   TXD - TX 文本控制格式
*   TXT - ANSI 纯文本

从项目网站：

“phpLiveDocx 允许开发人员通过将来自 PHP 的结构化数据与在文字处理器中创建的模板相结合来生成文档。生成的文档可以保存为 PDF、DOCX、DOC 或 RTF 文件。概念与邮件合并相同。”

有关详细信息，请参阅：

[http://www.phplivedocx.org/articles/brief-introduction-to-phplivedocx/](http://www.phplivedocx.org/articles/brief-introduction-to-phplivedocx/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-05T02:56:30.273

**对于您所有的文档转换需求**，您可以使用[OpenOffice](http://www.openoffice.org/)（以无头模式运行）。您可以[使用命令行参数](http://club.mandriva.com/xwiki/bin/KB/OpenOfficeCommandline)调用它来执行转换，或者您可以使用[PUNO](http://puno.sourceforge.net/install.html)[与它](http://dag.wieers.com/home-made/unoconv/)交互。您可以在每次需要转换时生成一个新的 OpenOffice 实例，或者您可以让一个或多个实例作为守护程序运行。

无论选择哪种接口，您都可能希望在打开 html 之后，但在导出为 Word 之前使用宏来添加自定义页眉和页脚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-10T17:44:51.857

[HTML-to-PDF 转换器PD4ML](http://pd4ml.com/php.htm)有一个 PHP 包装器。可选地 PD4ML 可以生成[RTF 而不是 PDF](http://pd4ml.com/cookbook/html_to_rtf_conversion.htm)。您只需要在其命令行中添加**-outformat rtf**或**-outformat rtfwmf （并相应地调整 HTTP 标头）。**

# c# - 正则表达式在 C# 程序中查找代码块

> ID：605941
> 
> 赞同：0
> 
> 时间：2009-03-03T10:56:35.113
> 
> 标签：c#, regex

我必须使用 C# 中的正则表达式从给定代码中找到代码块。

例如，我必须从以下代码中找到 For 循环块

```
For A in 1..10 
Loop
stmt1;
For C in cur_op
Loop
stmt2;
end loop;
end loop;
For T in 4..8
loop
stmt3;
end loop; 
```

我想检索代码块

```
For A in 1..10 
Loop
stmt1;
For C in cur_op
Loop
stmt2;
end loop;
end loop; 
```

和

```
For T in 4..8
loop
stmt3;
end loop; 
```

任何人都可以为此建议我一个正则表达式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T11:48:58.403

我不认为这是可能的。您要求使用正则表达式来解析上下文无关语言，虽然 Perl REs 实际上可以解析 CFL，但我不确定 C# 正则表达式可以做到这一点，并且使用它并不是最大的乐趣。

您的问题的自然解决方案是为该语言创建一个解析器，并从中获取信息。你可以使用像 CoCo/R 或 ANTLR 这样的解析器生成器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T11:59:19.517

好吧，使用 .net Regex 可以做到这一点，如果你真的不需要真正的解析器，你可以选择这个解决方案。[codeproject.com 上的这篇文章](http://www.codeproject.com/KB/recipes/Nested_RegEx_explained.aspx)很好地解释了它，我可以确认它运行良好（我用它来实现一个简单的 bbcode 解析器）。

您的模式可能看起来像这样：

```
String pattern = @"
(?# line 01) For ... in ...
(?# line 02) (?>
(?# line 03)   For ... in ... (?<DEPTH>)
(?# line 04)   |
(?# line 05)   end loop; (?<-DEPTH>)
(?# line 06)   |
(?# line 07)   .?
(?# line 08) )*
(?# line 09) (?(DEPTH)(?!))
(?# line 10) end loop;
"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T11:57:40.677

使用 Regex 进行平衡并不那么明显，因为您需要正确匹配最外层的`For.. end loop;`.

通过遍历每一行的基本循环可能会更简单，当它包含时增加一个计数器，当它包含`FOR`时减少它`end loop;`。当计数器为正时，将当前行附加到结果中。
当计数器达到 0 时，你就得到了你的块。

我[最近为另一个 SO question 提出了类似的](https://stackoverflow.com/questions/600733/using-java-to-find-substring-of-a-bigger-string-using-regular-expression/601926#601926)建议。

如果您只需要在`For..end loop;`.

正如 jpalecek 所说，如果你需要做更多的事情，你最好使用更合适的解析方法，否则你的工作会变得越来越困难。

# wpf - How to bind to Popup.IsOpen to Validation.HasError in code

> ID：605943
> 
> 赞同：0
> 
> 时间：2009-03-03T10:57:08.793
> 
> 标签：wpf, validation, popup

I have a Textbox which is bound to my data object. If the validation fails, I would like to show a popup which contains the error message. In XAML this works fine. I'm using the following XAML:

```
<TextBox Height="23" Margin="54,12,104,0" Name="textBox1" 
VerticalAlignment="Top" Text="{Binding Value, ValidatesOnExceptions=True, UpdateSourceTrigger=PropertyChanged}"></TextBox>

        <Popup Name="myPopup" PlacementTarget="{Binding ElementName=textBox1}"
                       IsOpen="{Binding ElementName=textBox1, Path=(Validation.HasError), Mode=OneWay}"
                       >
            <TextBlock Name="myPopupText" Background="LightBlue" Foreground="Blue">
                        The value is invalid
            </TextBlock>
        </Popup> 
```

My problem is that I have to create the popup and binding in code and I cannot get it to work. I have tried several different options. I also used dummy converter just to see whether the binding works at all. It seems that the binding works when I create it (it gets the initial value) but after that nothing happens. I can see that the Validation.HasError updates correctly (TextBox's border turns red), but that's it. My dummy converter is not called. Following is the code I'm using:

```
 Popup popup = new Popup();
    popup.Name = "somepopup";
    // Source is the textbox which is bound to the data object
    popup.PlacementTarget = source;
    popup.Placement = PlacementMode.Bottom;
    TextBlock txtblock = new TextBlock();
    txtblock.Background = Brushes.LightBlue;
    txtblock.Foreground = Brushes.Blue;
    txtblock.Text = "this is the error message";
    popup.Child = txtblock;

    Binding is_open_binding = new Binding("(Validation.HasError)");
    is_open_binding.UpdateSourceTrigger = UpdateSourceTrigger.PropertyChanged;
    is_open_binding.Source = source;
    is_open_binding.Mode = BindingMode.OneWay;
    is_open_binding.NotifyOnValidationError = true;
    is_open_binding.ValidatesOnExceptions = true;
    is_open_binding.Converter = new TempValueConverter();
    popup.SetBinding(Popup.IsOpenProperty, is_open_binding); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T11:21:31.293

只是做了一个简单的测试，它工作正常。这是我的 XAML：

```
<Window x:Name="_root" x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <StackPanel>
        <TextBox x:Name="_textBox">
            <TextBox.Text>
                <Binding Path="Text" ElementName="_root" UpdateSourceTrigger="PropertyChanged">
                    <Binding.ValidationRules>
                        <ExceptionValidationRule/>
                    </Binding.ValidationRules>
                </Binding>
            </TextBox.Text>
        </TextBox>
        <!--<Popup x:Name="_popup" IsOpen="{Binding (Validation.HasError), ElementName=_textBox, Mode=OneWay}">-->
        <Popup x:Name="_popup">
            <Border BorderThickness="1" BorderBrush="Black" Background="White">
                <TextBlock>Here I am.</TextBlock>
            </Border>
        </Popup>
    </StackPanel>
</Window> 
```

这是代码隐藏：

```
using System;
using System.Windows;
using System.Windows.Controls.Primitives;
using System.Windows.Data;

namespace WpfApplication1
{
    public partial class Window1 : Window
    {
        public string Text
        {
            get { return "Text"; }
            set { if (value != "Text") throw new InvalidOperationException("Bla"); }
        }

        public Window1()
        {
            InitializeComponent();

            var binding = new Binding("(Validation.HasError)");
            binding.Source = _textBox;
            binding.UpdateSourceTrigger = UpdateSourceTrigger.PropertyChanged;
            binding.Mode = BindingMode.OneWay;
            binding.NotifyOnValidationError = true;
            binding.ValidatesOnExceptions = true;
            //binding.Converter = new TempValueConverter();
            _popup.SetBinding(Popup.IsOpenProperty, binding);
        }

        private sealed class TempValueConverter : IValueConverter
        {
            #region IValueConverter Members

            public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
            {
                throw new NotImplementedException();
            }

            public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
            {
                throw new NotImplementedException();
            }

            #endregion
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T11:40:23.837

我还做了一个简单的解决方案并复制到你的代码中，它运行得很好。Kent 在 XAML 中声明了他的 Popup，但我使用了您的确切代码来创建 Popup 和设置绑定，因此差异不应该是您的问题的原因。

我想知道您是否可以发布源变量的来源。你没有表现出来，我想知道这是否是你认为的那样。

您可能会尝试的另一件事是保留对弹出窗口的引用，以防它被垃圾收集。我相信这可能是可能的，就好像我正确地记得绑定使用一周事件处理程序来进行更改通知一样，因此它们不会成为到 Popup 实例的任何持久链接。我认为这不太可能，但可能值得一试。

仅供参考，我用来测试的代码如下。

XAML 文件：

```
<Window x:Class="PopupOpenBindingTest.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1"
    Height="300"
    Width="300">
<Grid>
    <TextBox Height="23"
             Margin="54,12,104,0"
             Name="textBox1"
             VerticalAlignment="Top"
             Text="{Binding Text, ValidatesOnExceptions=True, UpdateSourceTrigger=PropertyChanged}" />
</Grid></Window> 
```

代码隐藏。

```
public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();

        DataContext = new DataObjectTest();
        this.Loaded += new RoutedEventHandler(Window1_Loaded);
    }

    void Window1_Loaded(object sender, RoutedEventArgs e)
    {
        TextBox source = textBox1;

        Popup popup = new Popup(); 
        popup.Name = "somepopup";
        popup.PlacementTarget = source; 
        popup.Placement = PlacementMode.Bottom; 
        TextBlock txtblock = new TextBlock(); 
        txtblock.Background = Brushes.LightBlue; 
        txtblock.Foreground = Brushes.Blue; 
        txtblock.Text = "this is the error message"; 
        popup.Child = txtblock;
        Binding is_open_binding = new Binding("(Validation.HasError)");// { Path = new PropertyPath(Validation.HasErrorProperty) }; 
        is_open_binding.UpdateSourceTrigger = UpdateSourceTrigger.PropertyChanged; 
        is_open_binding.Source = source; 
        is_open_binding.Mode = BindingMode.OneWay; 
        is_open_binding.NotifyOnValidationError = true; 
        is_open_binding.ValidatesOnExceptions = true; 
        //is_open_binding.Converter = new TempValueConverter(); 
        popup.SetBinding(Popup.IsOpenProperty, is_open_binding);
    }

    public class DataObjectTest
    {
        private string _text = string.Empty;

        public string Text
        {
            get { return _text; }
            set
            {
                if (value.Length > 5)
                    throw new InvalidOperationException("Blah blah blah");

                _text = value;
            }
        }
    } 
```

# .net - 关于在 WinForms 应用程序中嵌入 Excel 工作表的问题

> ID：605948
> 
> 赞同：0
> 
> 时间：2009-03-03T10:58:43.627
> 
> 标签：.net, excel

我以两种方式将 Excel 工作表嵌入 WinForms C# 应用程序 - 使用 WebBrowser 控件和使用 dsoFramer 控件。在这两种情况下，我都面临以下两个问题： 1\. 如何使我的嵌入式电子表格成为只读的？我发现的唯一方法是保护底层的 Excel 文件，但这会导致烦人的消息框一直弹出。2\. 如果我在启动我的应用程序之前在单独的进程中启动 MS Excel，则在显示我的嵌入式工作表后，独立的 Excel 会冻结。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T13:49:59.017

[SpreadsheetGear for .NET](http://www.spreadsheetgear.com/)带有一个与 Excel 兼容的 Windows Forms 电子表格控件，您可以简单地将其拖到您的表单中。它包括一个工作簿设计器，允许您直接在 Visual Studio 中编辑工作簿或从磁盘加载 Excel 工作簿，还包括一个类似于 Excel 的综合 API（除了它对 .NET 友好）。

如果这对您有用，您可以[了解更多信息](http://www.spreadsheetgear.com/support/samples/windowsforms.aspx)并亲自尝试[免费评估](https://www.spreadsheetgear.com/downloads/register.aspx)。

免责声明：我拥有 SpreadsheetGear LLC

# sql-server - How to have partial incremental synchronizations based on a GUID?

> ID：605949
> 
> 赞同：0
> 
> 时间：2009-03-03T10:59:15.230
> 
> 标签：sql-server, oracle, synchronization, guid

I need to synchronize an SQL Server database to Oracle through an Oracle Transparent Gateway. The synchronization is performed in batches, so I need to get the next set of data from the point where I left off.

The problem I'm having is that the only field I have in the source, to help me, is a GUID. If it were a number I could just order by it, keep the last one processed and restart the process by getting the records which are > my recorded number. This won't work with a GUID.

Any ideas?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T11:21:47.360

显然这有效：

```
SELECT * FROM v_source_supplier_prices
WHERE HEXTORAW(REPLACE(ID,'-','')) > HEXTORAW(REPLACE('0022F17B-24B3-43EC-8D81-FFD3149950E7','-','')) 
ORDER BY HEXTORAW(REPLACE(ID,'-','')) 
```

ID 是源系统上的 GUID 字段。

不知道要多少钱...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-07T11:41:42.210

您也可以对字符串（varchar、varchar2）进行排序，那么为什么需要一个数字呢？将 guid 转换为字符串不是更快吗？也许它们已经存储为字符串？

# php - javascript没有被调用

> ID：605953
> 
> 赞同：0
> 
> 时间：2009-03-03T11:01:33.243
> 
> 标签：php, javascript, ajax

我有以下 javascript 函数，当它们在独立文件中时，将从页面正确调用。

```
function deleteItem(layer, url) {
    var xmlHttp=GetXmlHttpObject();
    if(xmlHttp==null) {
        alert("Your browser is not supported?");
    }
    xmlHttp.onreadystatechange = function() {
        if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
            if(xmlHttp.responseText == 'result=true') {
                var row = document.getElementById(layer);
                row.parentNode.removeChild(row);
            }
            document.getElementById(layer).innerHTML=xmlHttp.responseText;
        } else if (xmlHttp.readyState==1 || xmlHttp.readyState=="loading") {
            document.getElementById(layer).innerHTML="loading";
        }
    }
    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);
}
function deleteRec(layer, pk) {
    url = "get_records.php?cmd=deleterec&pk="+pk+"&sid="+Math.random();
    if (confirm("Confirm Delete?")) {
        deleteItem(layer, url);
    }
}
function GetXmlHttpObject() {
    var xmlHttp=null;
    try {
        xmlHttp=new XMLHttpRequest();
    }
    catch (e) {
        try {
            xmlHttp =new ActiveXObject("Microsoft.XMLHTTP");
        }
        catch (e) {
        }
    }
    return xmlHttp;
} 
```

它是这样调用的：

```
 echo '<td><a href="#" onclick="deleteRec(\'article_' . $pk .'\', \'' . $pk . '\')">DELETE</a></td>' . "\n"; 
```

这将显示确认对话框，如果单击“确定”，将删除该页面，这是应该的。

然而。

当我的其他必要功能放在js文件中时，什么都不会发生。

```
function update(layer, url) {
    var xmlHttp=GetXmlHttpObject();
    if(xmlHttp==null) {
        alert("Your browser is not supported?");
    }
    xmlHttp.onreadystatechange = function() {
        if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
            document.getElementById(layer).innerHTML=xmlHttp.responseText;
        } else if (xmlHttp.readyState==1 || xmlHttp.readyState=="loading") {
            document.getElementById(layer).innerHTML="loading";
        }
    }
    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);
}
function updateByPk(layer, pk) {
    url = "get_auction.php?cmd=GetAuctionData&pk="+pk+"&sid="+Math.random();
    update(layer, url);
}
function updateByQuery(layer, query) {
    url = "get_records.php?cmd=GetRecordSet&query="+query+"&sid="+Math.random();
    update(layer, url);
}
function updateByPage(layer, query, pg) {
    url = "get_records.php?cmd=GetRecordSet&query="+query+"&pg="+pg+"&sid="+Math.random();
    update(layer, url);
}
function deleteItem(layer, url) {
    var xmlHttp=GetXmlHttpObject();
    if(xmlHttp==null) {
        alert("Your browser is not supported?");
    }
    xmlHttp.onreadystatechange = function() {
        if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
            if(xmlHttp.responseText == 'result=true') {
                var row = document.getElementById(layer);
                row.parentNode.removeChild(row);
            }
            document.getElementById(layer).innerHTML=xmlHttp.responseText;
        } else if (xmlHttp.readyState==1 || xmlHttp.readyState=="loading") {
            document.getElementById(layer).innerHTML="loading";
        }
    }
    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);
}
function deleteRec(layer, pk) {
    url = "get_records.php?cmd=deleterec&pk="+pk+"&sid="+Math.random();
    if (confirm("Confirm Delete?")) {
        deleteItem(layer, url);
    }
}
function GetXmlHttpObject() {
    var xmlHttp=null;
    try {
        xmlHttp=new XMLHttpRequest();
    }
    catch (e) {
        try {
            xmlHttp =new ActiveXObject("Microsoft.XMLHTTP");

        }
        catch (e) {
        }
    }
    return xmlHttp;
}
function makewindows(html) {
    child1 = window.open ("about:blank");
    child1.document.write(html);
    child1.document.close();
} 
```

JavaScript 本身似乎没有任何问题，所以我想知道是否以某种方式取消了某些内容。即使将 deleterec() 更改为简单的警报，也不会发生任何事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T11:07:06.303

我想知道您的 JS 代码中是否检测到错误？如果您的 Javascript 中有语法错误，则浏览器可能不会运行任何它。如果您使用的是 Firebug 之类的调试器，这将帮助您跟踪错误。

或者，尝试一次添加一个函数，它会告诉您哪个函数正在破坏事物。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T11:09:10.637

尝试使用 FireBug 来遵循有效的代码。
此外，如果您有一个完整的页面要显示，那可能会有点清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T11:19:21.860

首先，在这个文本块中：

```
 if(xmlHttp.responseText == 'result=true') {
                // Here you remove the appropriate element from the DOM rather than trying to update something within the DOM
                var row = document.getElementById(layer);
                row.parentNode.removeChild(row);
        }
        document.getElementById(layer).innerHTML=xmlHttp.responseText; 
```

你实际上并不想要这条线：

```
document.getElementById(layer).innerHTML=xmlHttp.responseText; 
```

此外，尝试在函数列表中将 deleteRec 函数放在 deleteItem 函数之前。

我还建议您在安装了[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)的 Firefox 中对此进行测试。这将向您显示页面上发生的任何 Javascript 错误。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-03T11:05:24.267

也许您用于将 js 文件包含到页面中的 html 标记不正确

包含脚本的正确方法是

```
<script type="text/css" src="myfile.js"></script> 
```

以下将**不起作用**

```
<script type="text/css" src="myfile.js" /> 
```

我还建议您使用 Firefox 的错误控制台，这是一款不错的应用程序，如果有任何问题，它会通知您。

# clickonce - 清除 ClickOnce 部署垃圾的建议

> ID：605954
> 
> 赞同：16
> 
> 时间：2009-03-03T11:02:27.347
> 
> 标签：clickonce

.NET ClickOnce 应用程序被部署到 C:\Documents and Settings\\Local Settings\Apps\2.0 的子文件夹中。在开发中，我们倾向于进行大量的小改动，并且通过定期部署，很多垃圾会堆积到这个文件夹中。令人惊讶的是，“删除 Internet 临时文件”不会从该文件夹中删除旧文件。有谁知道 Windows / .NET 是否采取任何措施从此处删除内容，或者是否继续累积。谢谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2011-03-15T14:44:52.363

```
rundll32 %windir%\system32\dfshim.dll CleanOnlineAppCache 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-03T15:16:44.800

Mage 是框架 sdk 附带的 ClickOnce 工具。命令...

```
Mage.exe -cc 
```

...将清除您的应用程序缓存。您可能需要稍微搜索一下才能找到法师。不同版本的 sdk 似乎安装在不同的位置。在我的机器上，它位于此处**C:\Program Files\Microsoft SDKs\Windows\v6.0A\bin\mage.exe**。

另一种选择是使用发布选项，使您的应用程序可以离线使用。然后，您将在常规的“添加/删除程序”中获得一个条目，可用于删除应用程序。

# windows - Windows 初始屏幕的标准尺寸

> ID：605965
> 
> 赞同：10
> 
> 时间：2009-03-03T11:07:25.460
> 
> 标签：windows, splash-screen

是否有标准的初始屏幕尺寸或初始屏幕尺寸指南？这是针对 XP 和 Vista 的音乐播放应用程序。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-03T11:22:20.120

[http://msdn.microsoft.com/en-us/library/aa511284.aspx](http://msdn.microsoft.com/en-us/library/aa511284.aspx)中的 Windows 用户体验指南仅声明不应使用启动画面，除非是异常长时间加载的应用程序。因此，不会过多影响用户的初始屏幕尺寸（即不覆盖整个屏幕，如果用户的屏幕分辨率低于开发人员:)）应该仍然适用，如果这是必要的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T11:13:50.203

纯粹根据经验：没有。

即使是 MS 应用程序，例如 Office 和 Visual Studio 也没有不同的大小（并且 VS 的大小会随着更多组件的添加而增长）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-17T18:49:28.620

我使用我的启动画面作为我的登录窗口。我只使用 550X400 作为初始屏幕尺寸，因为这是标准向导的尺寸。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-29T21:20:21.043

我在 Windows 应用程序的 UX 指南中找到了这篇 Microsoft 文章：[**启动屏幕指南**](https://msdn.microsoft.com/en-us/library/windows/apps/hh465338.aspx)。

它提到了这个尺寸：

```
Scale   Image size (pixels)

1x      620 x 300

1.4x    868 x 420

1.8x    1116 x 540 
```

# css - Firefox 中的 CSS 菜单损坏 (display:table-cell;)

> ID：605967
> 
> 赞同：3
> 
> 时间：2009-03-03T11:08:54.087
> 
> 标签：css, firefox, dotnetnuke, dotnetnuke-5

HTML：

```
<td align="center" width="100%">
<a class="Forum_ib_moderate" href="Default.aspx" title="Moderate"></a>
<a class="Forum_ib_admin" href="Default.aspx" title="Admin"></a>
... 
```

CSS：

```
A.Forum_ib_moderate:link, A.Forum_ib_moderate:visited, A.Forum_ib_moderate:active, A.Forum_ib_moderate:hover
{
background-image: url(images/ib_moderate.png);
background-repeat: no-repeat;
background-position: center;
padding-left: 2px;
padding-right: 2px;
padding-top: 8px;
padding-bottom: 0px;
height: 35px;
width: 35px;
display:table-cell;
}

A.Forum_ib_admin:hover
{
background-image: url(images/ib_admin_hover.png);

} 
```

菜单在 IE 中看起来很好，在 Firefox 中显示为垂直。如果我关闭“显示：表格单元；” 在 Firebug 中设置样式，然后将其重新打开，它会修复该菜单节点。

[![替代文字](https://i.stack.imgur.com/Fs5qm.jpg)](https://i.stack.imgur.com/Fs5qm.jpg)

有任何想法吗？

ps：我不想弄乱菜单本身，因为它是 DNN 论坛 4.4.3 的一部分。我宁愿修复 CSS 以使其正确显示。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T11:18:30.490

实际上，我认为您会发现 IE 有效，因为它**忽略了** `display: table-cell`. `Display: table-cell`其实是你的问题。

我猜正在发生的是 IE 正在将它们恢复为内联元素，因此是水平的。

将其更改为：

```
display: inline; 
```

根据需要添加一些填充（左右），你会得到你想要的。

或者，您可以浮动它们（左和/或右）。

Besdies，他们已经在一个表格单元格中。里面的表格单元格显示有点不对。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-22T17:05:50.543

我们也遇到过这个问题。仍在寻找解决方案。在我们的例子中，我们需要保持 display: table-cell 布局。

Firefox 有时似乎是随机的，它会导致表格单元对象包装而不是像一个实际的表格一样。一个 REFRESH 修复它，这只会使它更难以修复错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-08T18:04:46.840

似乎是一个简单的 FireFox 错误。我遇到了相反的问题：在 Win XP 上的 FF 3.5.9 中刷新*后*，表格单元格排列在彼此下方的 DIV 。

我找不到任何解决方案（将单元格包装成一行，溢出隐藏等），但将 FireFox 更新到 3.6.3 并希望该版本的用户很少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-24T14:26:46.863

这听起来类似于我正在尝试修复的 Firefox 回流错误。显然表格对于渲染来说真的很糟糕，因为它们会导致回流，而且似乎 Firefox 有时会错过回流。

我发现以下页面很有帮助：

*   [http://www.stubbornella.org/content/2009/03/27/reflows-repaints-css-performance-making-your-javascript-slow/](http://www.stubbornella.org/content/2009/03/27/reflows-repaints-css-performance-making-your-javascript-slow/)
*   [http://www.mozilla.org/newlayout/doc/reflow.html](http://www.mozilla.org/newlayout/doc/reflow.html)

# jquery - jQuery：计算列表元素的数量？

> ID：605969
> 
> 赞同：136
> 
> 时间：2009-03-03T11:09:37.093
> 
> 标签：jquery, html

我有一个从一些服务器端代码生成的列表，在使用 jQuery 向它添加额外的东西之前，我需要弄清楚其中已经有多少项目。

```
<ul id="mylist">
    <li>Element 1</li>
    <li>Element 2</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：228
> 
> 时间：2009-03-03T11:12:17.727

尝试：

```
$("#mylist li").length 
```

只是好奇：为什么你需要知道尺寸？你不能只使用：

```
$("#mylist").append("<li>New list item</li>"); 
```

?

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-03-03T11:14:42.963

```
var listItems = $("#myList").children();

var count = listItems.length; 
```

当然你可以用

```
var count = $("#myList").children().length; 
```

有关 jQuery 的更多帮助，[http](http://docs.jquery.com/Main_Page) ://docs.jquery.com/Main_Page是一个不错的起点。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-07-23T05:53:31.173

调用 .size() 方法或 .length 属性时会得到相同的结果，但首选 .length 属性，因为它没有函数调用的开销。所以最好的方法：

```
$("#mylist li").length 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-03T11:12:39.520

我认为应该这样做：

```
var ct = $('#mylist').children().size(); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-03-24T12:10:24.613

当然还有以下内容：

```
var count = $("#myList").children().length; 
```

可以浓缩为：（通过删除不需要设置变量的“var”）

```
count = $("#myList").children().length; 
```

* * *

然而这更干净：

```
count = $("#mylist li").size(); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-11-20T06:46:04.487

尝试

```
$("#mylist").children().length 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-08-30T10:14:07.980

计算列表元素的数量

```
alert($("#mylist > li").length); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-08-29T09:12:09.567

另一种计算列表元素数量的方法：

```
var num = $("#mylist").find("li").length;
console.log(num);
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<ul id="mylist">
  <li>Element 1</li>
  <li>Element 2</li>
  <li>Element 3</li>
  <li>Element 4</li>
  <li>Element 5</li>
</ul>
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-29T09:16:04.237

```
$("button").click(function(){
    alert($("li").length);
 });
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.2.3/jquery.min.js"></script>
<!DOCTYPE html>
<html>
<head>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
  <meta charset="utf-8">
  <title>Count the number of specific elements</title>
</head>
<body>
<ul>
  <li>List - 1</li>
  <li>List - 2</li>
  <li>List - 3</li>
</ul>
  <button>Display the number of li elements</button>
</body>
</html>
```

# linux - 命令行视频编辑工具

> ID：605970
> 
> 赞同：0
> 
> 时间：2009-03-03T11:09:48.607
> 
> 标签：linux, command-line, video

我正在寻找可以帮助进行视频编辑的（linux）命令行工具。我最感兴趣的是：

*   切割
*   过渡
*   效果

任何指针将不胜感激（我知道 ffmpeg 可以进行基本切割，但除此之外没有太多）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-06T00:58:18.303

我使用的两个工具是[transcode](http://www.transcoding.org/cgi-bin/transcode)和[mencoder](http://en.wikipedia.org/wiki/MEncoder)。

> Transcode 是一套命令行实用程序，用于对视频和音频编解码器进行转码，以及在不同的容器格式之间进行转换。
> 
> 提供各种视频和音频预处理和后处理过滤器，包括（但不限于）：
> 
> *   帧率转换
> *   平滑
> *   切割
> 
> MEncoder是一个基于mplayer的免费命令行视频解码、编码和过滤工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T17:48:12.480

[WINE 下的Avisynth](http://avisynth.org/mediawiki/Main_Page)是您最好的选择。您可以使用 ffmpeg 或 mencoder 进行实际编码，并使用 avisynth .avs 文件进行实际编辑。您可能还必须使用 WINE 下的 mencoder 来访问 avs 文件。我自己没有尝试过，但它应该可以工作，除非有任何 WINE 问题。

如果这是某些生产应用程序的一部分，如果有任何方法可以将工作分配到实际的 Windows 计算机上，那么您将为自己省去很多痛苦。

如果您想亲自动手，可以尝试使用 gstreamer 和[Gnonlin](http://gnonlin.sourceforge.net/)制作您自己的 CLI 视频应用程序。您实际上可以使用像 Ruby 这样的语言来调用 gstreamer，因此您不必使用 C。

# javascript - 在 JavaScript 中格式化日期

> ID：605971
> 
> 赞同：1
> 
> 时间：2009-03-03T11:10:04.393
> 
> 标签：javascript, date

在 Java 脚本中使用 newDate() 函数，我可以获得今天的日期。我得到的日期格式为 2009 年 3 月 3 日（d/m/yyyy）。但我实际上需要格式为 2009-03-03 (yyyy-mm-dd) 的日期。任何人都可以让我知道如何根据需要格式化日期吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-03T11:16:54.377

您通常必须编写自己的函数来处理日期的格式，因为 javascript 不包含以用户定义的方式格式化日期的好方法。你可以在网上找到一些不错的代码，因为这已经完成了，试试这个：

[http://blog.stevenlevithan.com/archives/date-time-format](http://blog.stevenlevithan.com/archives/date-time-format)

编辑：上面的代码看起来很不错，并且通过日期对象的原型安装了一个很酷的“格式”方法。我会用那个。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T11:50:37.870

如果你想自己滚动，这不是太难，你可以使用内置的 javascript[日期对象方法](http://www.javascriptkit.com/jsref/date.shtml)。

例如，要以您想要的格式获取当前日期，您可以执行以下操作：

```
var myDate = new Date();
var dateStr = myDate.getFullYear + 
    '-' + (myDate.getMonth()+1) + '-' + myDate.getDate(); 
```

如果您需要当天的两位数格式，您可能需要对 getDate() 方法进行零填充。

我为日期转换创建了一些有用的 js 函数并在我的应用程序中使用它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-13T15:51:12.453

有一个非常好的库来管理 JS 中的日期。

试试[这个](http://www.datejs.com/)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-03T16:18:53.090

You'll pretty much have to format it yourself, yeah.

```
var curDate = new Date();
var year = curDate.getFullYear();
var month = curDate.getMonth() + 1;
var date = curDate.getDate();
if (month < 10) month = "0" + month;
if (date < 10) date = "0" + date;
var dateString = year + "-" + month + "-" + date; 
```

It's a bit long, but it'll work (:

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-29T12:04:45.390

**在您的页面中添加 jquery ui 插件。**

```
function DateFormate(dateFormate, dateTime) {
    return $.datepicker.formatDate(dateFormate, dateTime);
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-14T15:16:22.157

只是另一种选择，我写道：

[DP_DateExtensions 库](http://www.depressedpress.com/Content/Development/JavaScript/Extensions/DP_DateExtensions/Index.cfm)

不确定它是否有帮助，但我发现它在几个项目中很有用。

支持日期/时间格式、日期数学（添加/减去日期部分）、日期比较、日期解析等。它是自由开源的。

如果您已经在使用框架（它们都有能力），则没有理由考虑它，但如果您只需要快速将日期操作添加到项目中，请给它一个机会。

# c# - 解析 XML 时如何访问节点的“行”和“列”

> ID：605974
> 
> 赞同：1
> 
> 时间：2009-03-03T11:11:30.350
> 
> 标签：c#, xml, parsing

在 C# 中，当从文件或字符串加载文档时，有没有办法计算出 XmlNode 在原始 XML“文本”中的位置？我希望能够报告我正在处理的 XML 文档的问题。

例如：

***“foo.xml 中的错误 - 属性 'pet' 的值必须是一种蓬松的哺乳动物，在第 27 行第 13 列 [此处为原始 XML 文本的片段...]”***

**编辑：** 无法使用模式验证进行检查。这是另一个不那么无聊的示例错误消息来说明：“指定的插件类型'Addins.LogWindow'必须是公共的”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T12:45:56.973

好吧，您不应该编写自己的 XmlParser，但在 Compact Framework 中，我们别无选择，因为 XmlDocument 与达赖喇嘛在氯胺酮上的速度一样慢，因此我们在解析 Xml 文件时使用 XmlReader。

每当发现有问题或不一致时，我们都会抛出异常，并将 XmlReader 传递给异常。然后，我们可以通过将 XmlReader 转换为包含线条和位置属性的 IXmlLineInfo 对象来提取线条位置。

不知道这是否会有所帮助。一般来说，我不会在桌面上编写自己的 XmlParser，这就是为什么我不愿建议将此作为解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T12:40:20.217

抱歉，很少有 DOM 实现会为您记住节点的原始解析位置。大多数只报告解析错误的任何位置信息。例如，在 DOM Level 3 LS 中，只有在存在[DOMError时才能获得对](http://www.w3.org/TR/DOM-Level-3-Core/core.html#ERROR-Interfaces-DOMError)[DOMLocator](http://www.w3.org/TR/DOM-Level-3-Core/core.html#Interfaces-DOMLocator)的引用。

我所知道的唯一一个在解析后会跟踪的小鬼是 pxdom，这适用于 Python，所以对你没有多大用处。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T11:14:21.247

XML Schema 对您有用吗？

[http://support.microsoft.com/kb/318504](http://support.microsoft.com/kb/318504)

# visual-studio-2008 - VS2008 类设计器和实体框架设计器有什么关系？

> ID：605978
> 
> 赞同：0
> 
> 时间：2009-03-03T11:12:50.783
> 
> 标签：visual-studio-2008, entity-framework

我正在学习实体框架，并注意到它的设计器看起来很像 Visual Studio 类设计器，但似乎并没有以任何方式使用它，事实上，这似乎是两种以不同方式解决类似问题的方法。

我在这里遗漏了什么，或者这两个工具可以以某种方式一起使用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T11:16:11.447

这两个工具对图表使用相同的通用 VS 实现（DSL 工具也使用它）。因此具有共同的外观和感觉。

两者都指定类，并允许编辑成员。然而除此之外它们非常不同，类图只生成代码，但实体设计器还管理映射和 ORM 后端。

# c - 如何检查 unicode 字符是否在 C 中的给定范围内？

> ID：605985
> 
> 赞同：0
> 
> 时间：2009-03-03T11:14:43.417
> 
> 标签：c, utf-8, c++builder

以下函数是为 java 编写的，并已针对 C 进行了调整。

```
bool isFullwidthKatakana(WideChar C)
{
  return(('\u30a0'<=C)&&(C<='\u30ff'));
} 
```

问题是我的框架（“CodeGear C++Builder”）显示了这个错误：

> [BCC32 警告] Unit1.cpp(101)：W8114 由通用字符名称“\u30a0”表示的字符无法在当前代码页中表示 (1252)

并且是否满足条件不返回true。

例如，一个输入是“ア”（0x30A2）。

我该怎么办？如何更改代码页？

**感谢三个答案，他们都解决了。**

```
return((0x30a0<=C)&&(C<=0x30ff)); 
```

似乎表达式 \u30a0 不正确，这一切都是正确的

```
return((0x30a0<=C)&&(C<=0x30ff));
return (unsigned int) C >= 0x30a0u && (unsigned int) C <= 0x30ffu;
return((L'\u30a0'<=C)&&(C<=L'\u30ff')); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-03T11:27:37.237

应该可以将字符（显式或隐式）转换为无符号整数，然后只使用这样的常量：

```
return (unsigned int) C >= 0x30a0u && (unsigned int) C <= 0x30ffu; 
```

应该这样做。

顺便说一句，我建议不要使用（单字符）大写参数名称，很容易认为它是编译时常量（在 C 和 C++ 中通常为大写）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T11:29:41.290

IIUC，您需要检查一个宽 unicode 字符（可能是 utf-16，因为您在 Windows 上）是否在一个范围内。这可以使用您显示的代码来完成，您只需将字符文字设为宽字符文字即可。在 C++ 和 C 中，它们是通过在文字前面加上 L 来制作的，例如。`L'a'`或`L"ahoj"`。

在你的情况下，我会尝试

```
bool isFullwidthKatakana(WideChar C)
{
  return((L'\u30a0'<=C)&&(C<=L'\u30ff'));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T11:30:14.080

该错误似乎与字符文字的使用有关，而不是与测试有关。因此，将代码点作为整体文字进行测试，例如：

```
bool isFullwidthKatakana(WideChar C)
{
  return(( (WideChar)0x30a0 <= C )&&(C <= (WideChar)0x30ff ));
} 
```

# java - 使用休眠的旧版映射

> ID：605986
> 
> 赞同：0
> 
> 时间：2009-03-03T11:15:05.007
> 
> 标签：java, hibernate, mapping

对于我当前的项目，我必须使用 hibernate 映射一个遗留数据库，但我遇到了一些问题。数据库是使用一个“实体”表设置的，该表包含所有域对象的公共属性。属性包括（除其他外）创建日期、所有者（用户）和随后在表中用于域对象的主键。

上下文的简单表示如下：

```
table entity
 - int id
 - varchar owner

table account
 - int accountid (references entity.id)

table contact
 - int contactid (references entity.id)
 - int accountid (references account.accountid) 
```

当我尝试将集合映射添加到我的帐户映射时，我的问题就出现了，其中包含属于该帐户的所有联系人。我的尝试归结为以下几点：

```
<hibernate-mapping>
    <class name="Contact" table="entity">
        <id name="id" column="id">
            <generator class="native" />
        </id>
        <join table="contact">
            <key column="contactid"/>
            <!-- more stuff -->
        </join> 
    </class>
</hibernate-mapping>

<hibernate-mapping>
    <class name="Account" table="entity">
        <id name="id" column="id">
            <generator class="native" />
        </id>

        <bag name="contacts" table="contact">
            <key column="accountid" />
            <one-to-many class="Contact"/>
        </bag> 

        <join table="account">
            <key column="accountid"/>
            <!-- more stuff -->
        </join>

    </class>
</hibernate-mapping> 
```

但是，当我尝试获取帐户时，我收到一条 SQL 错误，指出实体表不包含名为 accountid 的列。我明白为什么会发生这种情况：当我希望它在联系人表中查找时，映射会尝试在实体表中查找 accountid 列。我在这里遗漏了一些明显的东西，还是应该从另一个方向解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T11:39:20.003

在我看来，您实际上需要使用 Table Per Subclass 范例来映射继承。

像这样的东西：

```
<class name="entity" table="entity">
    <id name="id" column="id">
        ...
    </id>

    <joined-subclass name="contact" table="contact">
        <key column="contactid"/>
    </joined-subclass>

    <joined-subclass name="account" table="account">
        <key column="accountid"/>
    </joined-subclass>
</class> 
```

顺便说一句，这是近似的——它在 Hibernate 文档的第 9.1.2 节中有详细描述（以防万一你找不到它，它被称为“每个子类的表”）。

干杯

富有的

# sql-server - MS SQL：抑制存储过程中调用的存储过程的返回值

> ID：605996
> 
> 赞同：12
> 
> 时间：2009-03-03T11:18:34.170
> 
> 标签：sql-server, stored-procedures, nocount

我认为我遇到了与 kcrumley 在问题“[通过经典 ASP 从另一个存储过程调用存储过程](https://stackoverflow.com/questions/107585/problem-calling-stored-procedure-from-another-stored-procedure-via-classic-asp)的问题”中描述的问题相同的问题。但是他的问题并没有真正包括解决方案，所以我再试一次，添加我自己的观察：

我有两个存储过程：

```
CREATE PROCEDURE return_1 AS BEGIN
    SET NOCOUNT ON;
    SELECT 1
END

CREATE PROCEDURE call_return_1_and_return_2 AS BEGIN
    SET NOCOUNT ON;
    EXEC return_1
    SELECT 2
END 
```

请注意，这两个过程都包含“SET NOCOUNT ON”。当我执行“call_return_1_and_return_2”时，我仍然得到两个记录集。首先是值 1，然后是值 2。

这使 ASP（经典的 VBScript ASP）脱离了轨道。

关于如何抑制第一个结果集的任何提示？为什么即使有 NOCOUNT 也存在？

跳过 ASP 中的第一个记录集不是一种选择。我需要一个“仅限数据库”的解决方案。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-03T16:13:59.907

正如马特在他的评论中指出的那样，这两种解决方案都没有真正“吞下”第一个结果集。我不知道你为什么想要这个，但你可以通过使用表变量“吞下”第一个 exec 的结果。它必须与结果集列的确切数量和类型相匹配。像这样：

```
CREATE PROCEDURE return_1 AS 
    SET NOCOUNT ON;
    SELECT 1
GO
CREATE PROCEDURE call_return_1_and_return_2 AS 
    SET NOCOUNT ON;
    DECLARE @Result TABLE (res int)
    insert into @Result EXEC return_1
    SELECT 2
GO 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-03T11:26:26.600

它不是导致这种情况的 NOCOUNT，您的存储过程每个都有一个选择，因此每个都进入自己的结果集中。这可以通过更改您的第一个存储过程以使用输出参数将数字 1 传回而不是执行选择来避免。然后，第二个存储过程可以检查输出参数以获取运行所需的数据。

尝试这样的事情

```
CREATE PROCEDURE Proc1
(
    @RetVal INT OUTPUT
)
AS
SET NOCOUNT ON
SET @RetVal = 1 
```

```
CREATE PROCEDURE Proc2
AS
SET NOCOUNT ON
DECLARE @RetVal int
EXEC    [dbo].[Proc1]
        @RetVal = @RetVal OUTPUT
SELECT  @RetVal as N'@RetVal' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T11:28:54.240

这些不是返回变量，而是输出记录集。我想一旦 SQL Server 将输出刷新到客户端，你就完蛋了，无法收回。

我将通过向 SP return_1 添加一个参数来解决这个问题，该参数将控制 return_1 是选择记录还是只是做一些事情并静默退出。`**``***