# StackOverflow 问答 000857000-000857999

# sql - GROUP BY, ORDER BY - 如何根据项目的最新外观进行分组

> ID：857007
> 
> 赞同：2
> 
> 时间：2009-05-13T09:37:13.357
> 
> 标签：sql, mysql

我有这样的查询（Mysql 5.X，PHP - 为易读而格式化）

```
$query ="
SELECT 
  p.p_pid, 
  p.p_name, 
  p.p_url 
FROM 
  activity a, 
  products p 
WHERE 
  a.a_uid= ".$uid_int." 
  AND a.a_pid > 0 
  AND p.p_pid = a.a_pid 
GROUP BY 
  a.a_pid 
ORDER BY 
  a.a_time DESC LIMIT 6
"); 
```

一般来说，它应该生成用户看到的 6 种最新产品的唯一列表。

问题是，如果用户不止一次地看过一个产品。其中一个在最近 6 个活动中，其中一个在最近 6 个活动之前查询不返回产品。我假设 (group by) 不会在 a_time 中留下产品的最新出现时间。我该如何纠正？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T09:43:16.137

您是否尝试过按 MAX(a.a_time) 订购？

```
SELECT 
  p.p_pid, 
  p.p_name, 
  p.p_url 
FROM products p 
INNER JOIN activity a on p.p_pid = a.a_pid 
WHERE 
  a.a_uid= ".$uid_int." 
GROUP BY 
  p_pid, p_name, p_url
ORDER BY 
  max(a.a_time) DESC 
  LIMIT 6 
```

作为最佳实践，在没有聚合的情况下对您使用的每一列使用 GROUP BY。MySQL 是少数允许您使用未分组列的数据库之一。它会从您选择的行中为您提供一个随机列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T09:45:28.367

我当然希望对该`$uid_int`变量进行双重检查以进行 SQL 注入。

```
$query ="
SELECT 
  MAX(p.p_pid)  p_pid, 
  MAX(p.p_name) p_name, 
  MAX(p.p_url)  p_url
FROM 
  activity a
  INNER JOIN products p ON p.p_pid = a.a_pid 
WHERE 
  a.a_uid= ".$uid_int." 
  AND a.a_pid > 0 
GROUP BY 
  a.a_pid 
ORDER BY 
  MAX(a.a_time) DESC 
LIMIT 6
"); 
```

有时我想知道 MySQL 允许在没有显式聚合的情况下进行分组是否是一个好的设计决定......

# xml - XSL：避免将命名空间定义导出到生成的 XML 文档

> ID：857010
> 
> 赞同：50
> 
> 时间：2009-05-13T09:38:09.437
> 
> 标签：xml, xslt, namespaces, export, msxsl

我想从一些 XML 文件中获取数据并将它们转换为新的 XML 文档。但是，我不希望 XSLT 中命名空间的定义出现在结果文档中。

换句话说：

来源：

```
<Namespace:Root xmlns:Namespace="http://www.something.com"> 
```

样式表：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:Namespace="http://www.something.com"> 
```

结果：

```
<resultRoot xmlns:Namespace="http://www.something.com">
<!--I don't want the Namespace definition above--> 
```

我正在使用 msxsl 进行转换。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2009-05-13T09:41:13.100

您可以使用元素的`exclude-result-prefixes`属性`xsl:stylesheet`来避免将命名空间前缀发送到输出文档中：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0"
         xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
         xmlns:prefix1="http://www.something.com"
         exclude-result-prefixes="prefix1">

</xsl:stylesheet> 
```

要从输出文档中抑制多个命名空间，请指定它们以空格分隔：

```
exclude-result-prefixes="prefix1 prefix2 prefix3" 
```

来自[XSLT 规范](http://www.w3.org/TR/xslt#literal-result-element)：

> 当样式表仅将命名空间声明用于寻址源树时，在 exclude-result-prefixes 属性中指定前缀将避免结果树中多余的命名空间声明。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-13T10:17:38.547

迪沃的答案已经被选中，而且是恰当的。

但是，如果您有兴趣深入挖掘，请查看我的巨著中关于“XSLT 中的命名空间”这一广受欢迎的主题的[“太多命名空间”部分。](http://lenzconsulting.com/namespaces-in-xslt/#too_many_namespaces)（是的，这意味着开玩笑。:-)）

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2009-05-13T09:40:48.047

使用扩展元素前缀=“命名空间”

像：

```
<xsl:stylesheet
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:datetime="http://exslt.org/dates-and-times"
xmlns:str="http://exslt.org/strings"
xmlns:exsl="http://exslt.org/common"
xmlns:uw="xalan://ru.sbtc.util.XSLUtil"
extension-element-prefixes="exsl str datetime uw"
version="1.0"> 
```

# java - 是否可以使用远程 JVM 获取 MemoryMXBean 实例？

> ID：857014
> 
> 赞同：2
> 
> 时间：2009-05-13T09:38:32.683
> 
> 标签：java, mbeans

我发现这篇很好的文章解释了如何为你的虚拟机查询当前内存[http://recursor.blogspot.com/2006/10/memory-notifications-in-java.html](http://recursor.blogspot.com/2006/10/memory-notifications-in-java.html)

我的问题是，是否可以轻松地从远程 VM 获取 MemoryMXBean 类的实例（以及我将如何做到这一点），还是我必须求助于手动查询 MBean？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-07-01T16:27:02.840

as described on [this page](http://java.sun.com/javase/6/docs/api/java/lang/management/package-summary.html#examples) you can access it remotly, with the `MBeanServerConnection`:

```
 MBeanServerConnection mbs;

   // Connect to a running JVM (or itself) and get MBeanServerConnection
   // that has the JVM MXBeans registered in it
   ...

   try {
       // Assuming the RuntimeMXBean has been registered in mbs
       ObjectName oname = new ObjectName(ManagementFactory.RUNTIME_MXBEAN_NAME);

       // Get standard attribute "VmVendor"
       String vendor = (String) mbs.getAttribute(oname, "VmVendor");
   } catch (....) {
       // Catch the exceptions thrown by ObjectName constructor
       // and MBeanServer.getAttribute method
       ...
   } 
```

however, as far as I understand, you won't be able to use the Java interface, you'll need to query the properties you want with

```
CompositeDataSupport mem = (CompositeDataSupport)serv.getAttribute(memory, "NonHeapMemoryUsage") ; 
```

and

```
mem.get("committed") 
```

which is quite awfull ('stringly-typed' interface, as they said in another question).

As Brian Agnew said, the JConsole view is very usefull to find out where the information you want is stored.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T10:41:24.187

您可以远程查询 JMX bean。请参阅 JMX 教程中的[JMX 连接器](http://java.sun.com/j2se/1.5.0/docs/guide/jmx/tutorial/connectors.html#wp5529)部分。

直接的方法可能是使用[JConsole](http://java.sun.com/developer/technicalArticles/J2SE/jconsole.html)来确定您想要查询的内容（在本例中是您的 MemoryMXBean），然后围绕它编写代码。

# php - PHP，如何创建倒数计时器？

> ID：857016
> 
> 赞同：2
> 
> 时间：2009-05-13T09:38:59.220
> 
> 标签：php, javascript, redirect

这个怎么做：

“您将在 5..(4,3,2,1) 秒内被重定向到 domain.com”

在php中？？？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-13T09:51:34.487

我很确定 javascript 是你最好的选择。唯一的另一种方法是每秒重定向到一个新的 URL，在我看来这太过分了。

这是示例倒计时的完整源代码：

```
<html>
  <head>
    <meta http-equiv="refresh" content="5;url=http://example.com" />
    <title>Countdown Sample</title>
  </head>
  <body>
    you will be redirected to example.com in <span id="seconds">5</span>.
    <script>
      var seconds = 5;
      setInterval(
        function(){
          document.getElementById('seconds').innerHTML = --seconds;
        }, 1000
      );
    </script>
  </body>
</html> 
```

## 编辑

这是根据 Alnitak 的建议改进的版本：

我已经更改了 JavaScript 以重定向用户并防止倒计时低于 1，并且我在没有 JavaScript 的用户`<noscript>`周围添加了一个标签。`<meta>`

```
<html>
  <head>
    <noscript>
      <meta http-equiv="refresh" content="5;url=http://example.com" />
    </noscript>
    <title>Countdown Sample</title>
  </head>
  <body>
    you will be redirected to example.com in <span id="seconds">5</span>.
    <script>
      var seconds = 5;
      setInterval(
        function(){
          if (seconds <= 1) {
            window.location = 'http://example.com';
          }
          else {
            document.getElementById('seconds').innerHTML = --seconds;
          }
        },
        1000
      );
    </script>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-13T09:42:21.677

最好不要在 PHP 中这样做，因为它需要 Web 服务器在倒计时运行时保持与客户端的连接打开。

这将（恕我直言）在 Javascript 中使用`setInterval()`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-13T09:52:12.847

您应该使用 javascript 来可视化倒计时，在 php 中您可以为重定向设置一个计时器，如下所示：

```
header('refresh: 5; url=http://www.stackoverflow.com'); 
```

其中 refresh: x 以秒为单位设置等待重定向的时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T09:42:44.033

简短的回答：你不能。

长答案：PHP 是服务器端的，因此一旦发送页面，PHP 就与它无关。您正在寻找的东西可以通过多种方式实现。您可以使用 javascript（允许您进行“视觉”倒计时）或在文档元素中设置元刷新标记，例如：<meta http-equiv="refresh" content="5;url= [http ://yoursite.com](http://yoursite.com) ">

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T09:53:41.970

您可以使用该函数实现 Javascript 倒计时`setInterval()`，每秒调用 5 秒以创建一个计时器函数来倒计时。当时间过去后，您可以使用`document`'`location.href`属性将用户重定向到页面；例如，在关闭 Javascript 的情况下，创建一个硬链接将它们定向到页面也是有益的。

例如：

```
var timeLeft, id;

function startCountDown()
{
    timeLeft = 5;
    id = setInterval(countDown, 1000);
}

function countDown()
{
    timeLeft -= 1;

    //Update the text which states how much time is remaining until the
    //user is redirected here..

    if(timeLeft==0)
    {
        clearInterval(id);

        //Redirect to the desired URL
        document.location.href = "http://domain.com";
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-07T12:58:07.030

感谢您的反馈意见

```
 function timer(stamp)
                {
                    var temp=stamp;
                    temp=temp-1;
                    document.getElementById('mylbl').innerHTML = temp;
                    if(temp<=0)
                    {
                        window.location = "http://www.tasolglobal.com"
                        exit();
                    }
                    setTimeout("timer("+temp+")",1000); 
                }

    </script>

</head>

<body bgcolor="black" text="white" onload="timer(10+1)" >

    <?php
        //$sec=5;
        $to=$_REQUEST['from'];          //Set your email address where you want to get feedback
        $from=$_REQUEST['from'];        //This will be the senders email add
        $message=$_REQUEST['mesg'];     //This contains message from feed fackback form
        $subject=$_REQUEST['subject'];      //This contains subject of Feedback form. You can also set value as                                     feedback so you can find feedback mail easily
        $header="From: $from";          //Header of the feedback mail
        mail($to,$subject,$message,$header);

        echo "<br><br><h1>Thank You For Your Feedback...
            </h1><br><font color=red size=3>Your Will Be Redirected To HOME PAGE... Within ";
            echo "<label id=mylbl></label>" ;
        echo " Seconds";            
    ?>
</body> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-08T16:16:31.750

你可以混合使用javascript和php，当你进入页面时，你会得到一个日期，你需要通过php从数据库倒计时，然后用javascript倒计时。[http://free-countdown.co.nr/](http://free-countdown.co.nr/)使用了类似的东西

# windows-mobile - Pocket Internet Explorer 插件

> ID：857025
> 
> 赞同：1
> 
> 时间：2009-05-13T09:40:56.983
> 
> 标签：windows-mobile

是否可以使用 VS.Net 2008，C# 为 Pocket IE（我在三星 Omnia i900 设备上运行 Windows Mobile 6.1 Pro）创建插件。我想要浏览器中的一个菜单选项，当它被选中时，它会将我所在的当前 URL 发送到移动程序 - 不管程序是否正在运行。然后程序可以获取 URL 并对其进行任何操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T13:57:23.167

不可以。Pocket IE 是本机应用程序，由于 CF 不支持 CLR Hosting，因此它无法创建托管对象。您可以为 PIE 编写 COM 组件，但必须在 C++ 中完成。

# bash - 为什么有时当我在 bash 提示符上粘贴命令时，即使我不按 Enter 也会执行？

> ID：857029
> 
> 赞同：8
> 
> 时间：2009-05-13T09:42:06.750
> 
> 标签：bash, copy-paste

该命令无需按 Enter 即可执行。这有时会很危险...

为什么会这样，我该如何预防？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-13T09:47:22.480

因为你用它粘贴换行符。它有时很有用，例如，您可以一次复制/粘贴许多命令（长的多行脚本）。

好吧，我从来没有想过要阻止这种特殊行为。这是正常的和预期的。WYPIWYG - 你粘贴的就是你得到的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-13T23:24:38.807

您正在粘贴一个或多个换行符。除了简单地不复制和粘贴换行符之外，您还可以做一些事情来解决这个问题：

*   对于单行命令，先输入“#”，这样命令就会被注释掉。然后您可以返回并编辑它。

*   使用 bash 的（看似鲜为人知的）**编辑和执行命令**功能。`CTRL-x` `CTRL-e`如果您使用 emacs 键绑定（默认）或`ESC v`使用 vi 键绑定，您可以点击它来调用它。这将调用包含您当前命令行的文本编辑器。然后，您可以粘贴到编辑器中，然后编辑命令。保存并退出后，编辑器保存的命令将被执行（如果要中止注释掉所有行或完全清除缓冲区）。您可以设置与`FCEDIT`或`EDITOR`环境变量一起使用的编辑器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T10:44:51.810

阻止执行的一种快速方法是键入注释字符#，然后粘贴命令。

我经常这样做，因为我在复制和抓取无关字符时手指很粗。

当您在注释字符后粘贴时，该命令位于历史缓冲区中，您可以对其进行编辑、取消注释并运行它。

---回复评论

你是对的，这仅适用于单行命令。如果剪贴板中有多行数据，则可以通过 sed 管道传输剪贴板数据。

愚蠢的 bash 技巧 #400 万和一：

`prompt:$ xclip -o -selection clipboard | sed --regexp-extended 's/^(.*)$/# \1;/'`

会变成这样：

`for i in *.JPG;`

`do echo mv $i ${i/.JPG/.jpg};`

`done;`

进入这个：

`# for i in *.JPG;`

`# do echo mv $i ${i/.JPG/.jpg};`

`# done;`

这真的不值得努力，但有点有趣；>

# algorithm - 关于 Levenshtein 距离的问题

> ID：857031
> 
> 赞同：0
> 
> 时间：2009-05-13T09:42:20.413
> 
> 标签：algorithm, levenshtein-distance

1）为什么我们在这些行上加 1？

```
 d[i-1, j] + 1, // deletion 
    d[i, j-1] + 1, // insertion 
```

线

```
if s[i] = t[j] then cost := 0

        else cost := 1 
```

应该考虑删除/较低的字长，还是我错过了什么？

2）此外，评论状态删除和插入。我是否认为它正在检查两个单词中的已删除字符（整数 j/i 表示单词的长度），因为较低的值将表示已删除的字符。

使用的代码在这里（因为它是伪代码，我没有语言特定的问题，这个线程不属于任何语言类别）：

[http://www.iterasi.net/openviewer.aspx?sqrlitid=z0cloj7xhk-ce0f72v4cjq](http://www.iterasi.net/openviewer.aspx?sqrlitid=z0cloj7xhk-ce0f72v4cjq)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T10:03:43.563

你读过[http://www.merriampark.com/ld.htm](http://www.merriampark.com/ld.htm)吗？

您正在计算将一个字符串转换为另一个字符串所需的转换成本——插入和删除的数量。

这种转换的“成本”表示两个字符串之间的距离。

交易所呢？这就是[Damerau-Levenshtein](http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance)算法，它是不同的。包括交换并没有太大改善。

本质是在两个单词之间创建一个矩阵，并逐列计算每个单词的每个字母到另一个单词的每个字母的“距离”。该矩阵的右下角是考虑到所有字母的总距离。

问题1）

“上方”的单元格反映了更改的历史，并且该行的字符（通常）与此不同，因此该单元格相对于它是一个删除。

“左侧”单元格反映了更改的历史，并且该列的字符（通常）与此不同，因此该单元格是相对于它的插入。

这通常是错误的唯一一次是具有三个字母序列的单词。少见的英文。

行列比较的成本为 0 或 1。

“历史加一变更”与变更的实际成本的最小值为适用成本。

问题2）

变量`i`和`j`不是任何东西的长度。它们是比较矩阵中的位置。“插入”和“删除”是将一个单词转换为另一个单词所需的动作。插入/删除动作的计数是单词之间的距离。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T09:58:36.377

1）这些行计算删除情况下的距离，插入情况下的距离，以及在替换情况下使用“成本”的距离......

删除和插入在距离计算中有效地算作“1”，因此是 +1。

我们可以相信只有当字符不同时才会有替换，因此如果两个字符相等，则“成本 = 0”......

新的距离就是这 3 个假设之间的*最小*距离，所以你并不总是加 1 ...

2）如果我计算“FooBar”和“FoBaWhatever”之间的距离，即使第二个字符串比第一个字符串长，我也会删除一些字符......

当然，如果第二个字符串比第二个字符串短（ FooBar -> FoBa ）我会发现一些删除但无法提前知道它们在哪里......

# vb.net - 安装项目对 .NET COM 有什么作用？

> ID：857035
> 
> 赞同：1
> 
> 时间：2009-05-13T09:42:43.363
> 
> 标签：vb.net, visual-studio-2008, com, vb6, installation

好的，想象一下 Visual Studio 2008 中最简单的解决方案，它带有框架 3.5 (OS = Win XP)，我在其中添加了一个类库。然后我添加了一个 COM 类。这个 COM 类非常简单，它只公开了 1 个函数：

```
Public Function SayHello() As String
 Return " Hello."
End Function 
```

我已经构建了这个类库，它生成了 .dll 和 .tlb。我在 VB6 应用程序的引用框中（位于同一个 comp）中看到了 .tlb，所以我引用了它。我打电话给 SayHello，运行它，然后……“自动化错误”。

我在某处找到了一篇文章如何制作一个安装项目，然后安装 .dll。在我使用此安装项目单独安装 .dll 后，COM 组件的工作方式与我的 VB6 应用程序中的一样。

好的，现在我的问题......为什么？有人可以向我解释一下我显然没有做的安装项目。

PS：为了清楚起见，它在 VB2005 和 Framework 2.0 上运行良好......但现在我无法让这个最简单的示例项目工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T09:57:51.637

除非您为程序集的类型库显式指定 UUID，并且所有 COM 公开的类和接口 VS 在每次重建时都会自动更改它们以防止所谓的“COM 地狱”（UUID 的注册表污染）。

在编译 VS 之前注销以前版本的程序集，然后编译程序集并注册新的程序集。如果使用者（您的 VB 应用程序）没有立即重新编译，它现在将无法使用该程序集，因为注册表中没有关于该程序集的先前版本和相应类型库的数据。

为了解决这个问题，您需要为所有暴露于 COM 的实体显式指定 UUID，然后您必须彻底保持二进制兼容性。

# php - 如何从 PHP Web 应用程序调用 siebel Web 服务？

> ID：857047
> 
> 赞同：2
> 
> 时间：2009-05-13T09:45:49.223
> 
> 标签：php, web-services, siebel

我正在开发一个门户，我必须通过其中一个已发布的 Web 服务从 siebel 呼叫中心应用程序中提取一些数据。如果有人为示例应用程序提供一些代码片段，我会很高兴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-26T07:56:16.937

siebel 的所有 Web 服务都使用 SOAP 协议发布，您只需要从 siebel 客户端应用程序 > Web 服务 > 入站获取 wsdl。例如，通过 php_soap 客户端从 php 使用它。下面是一个关于在 php 中编写soap客户端的例子：[php_soap client](http://devzone.zend.com/article/689)

我有 siebel webservices 调用的 java、python 和 perl 示例，但不适用于 php。希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-22T15:50:38.080

我不知道这是否可能。大多数 Siebel 业务层访问只能通过 OLE 或 Java 对象接口进行。也许如果使用某种集成服务公开访问权限，您可以这样做，例如 MQ 或其他东西。

我简短，我没有例子。它需要拼凑在一起。如果你想通了，拉维，你会得到很多钱。祝你好运，我的朋友！

# php - I need to push into an array values based on a specific condition, what is the correct way to do this?

> ID：857051
> 
> 赞同：1
> 
> 时间：2009-05-13T09:46:55.227
> 
> 标签：php, arrays

I have a forcycle that contains a condition (and an incremental value i):

```
if(condition)){$arr[$i] = array("value" => $node->nodeValue));}
else{$arr[$i] = array("string" => $node->nodeValue);} 
```

In the end I need to have an array like this:

```
 Array ( [1] => Array ( [string] => abc [value] => 0,999 ) 
            [2] => Array ( [string] => meh [value] => 0,123 ) 
            [x] => Array ( [string] => xxx [value] => xxx ) ) 
```

I understand that my code doesn't work, I think I should use array_push, but I was wondering is there are better way to achieve this

Thank you very much

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T10:06:39.890

I'm sorry, the question is not very clear.. Is that what you are trying to do?

```
$result = array();
foreach( $nodes as $node ) 
{
    $type = 'value';
    if( is_string( $node->nodeValue ) )
    {
        $type = 'string';
    }

    $result[][$type] = $node->nodeValue;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T10:00:37.560

You can write it somewhat more concise using the ?: operator:

```
$fieldname = ($condition? "value" : "string"); 
$arr[$i][$fieldname] = $node->nodeValue ; 
```

# entity-framework - 多对多关系插入和删除

> ID：857052
> 
> 赞同：0
> 
> 时间：2009-05-13T09:47:06.880
> 
> 标签：entity-framework

我有实体

*   用户：

ID

姓名

导航：组

*   团体：

ID

姓名

导航：用户

关系：

*   usrgrp

用户

标识组

在这里，我不想将数据添加到关系而不是主要实体。请举例说明如何删除并插入 usrgrp。

提前致谢。s。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T12:13:21.400

实体框架将把 usrgrp 表包含到导航中。它不会有实体。因此，对该表的所有访问都只能通过用户和组实体。由于这是多对多关系，因此您可以以几乎相同的方式从任一端访问该关系。

```
someUser.Group.Add(new Group());
someUser.Group.Remove(someExistingGroup);
context.SaveChanges(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T16:52:03.020

Craig 是对的，因为该`usrgrp`表只有 2 个 FK，它是一个纯连接表，因此实体框架将其解释为 ManyToMany 关联。

正如 Craig 上面的代码示例所示，这对于大多数客户来说通常都很好。

但是，如果您想独立管理 UserGroup 关系，一种选择是向 usrgrp 表添加一个额外的列，标识列可能是最简单的。然后，实体框架不能再将该表折叠成导航，因此您将看到 usrgrp 表的实体，您可以独立操作该实体。

IE

```
someUser.UserGroups.Add(new UserGroup {User = someUser, Group = someGroup}); 
```

请注意，您不必指定 Identity 列（这会很麻烦），因为它是存储生成的。

一般来说，大多数客户不希望看到纯连接表的实体，因为没有它，编程体验会更简单。例如 LINQ 查询变得有点复杂：

这个：

```
var users = from g in ctx.Groups
            from u in g.Users
            where g.Name == "Administrators"
            select u; 
```

变成：

```
var users = from g in ctx.Groups
            from ug in g.UserGroups
            where g.Name == "Administrators"
            select ug.User; 
```

希望这个额外的澄清有助于

亚历克斯

# c# - 计算容纳 Graphics 对象所需的图像大小

> ID：857054
> 
> 赞同：1
> 
> 时间：2009-05-13T09:47:27.270
> 
> 标签：c#, graphics, barcode

我正在为工作编写一个条形码应用程序，我在其中创建一个图形对象并为代码 39 条形码绘制各种条形图。我使用以下代码创建图形对象：

```
int reqBarcodeWidth = 100;
int reqBarcodeHeight = 40;

objBitmap = new Bitmap(reqBarcodeWidth, reqBarcodeHeight);

objGraphics = Graphics.FromImage(objBitmap); 
```

然而，我想做的一件事是允许使用不同的单位来绘制图形对象，例如：

```
objGraphics.PageUnit = GraphicsUnit.Inch; 
```

但是，如果我这样做，我怎么知道要创建什么大小的位图以适合其上的完整条形码？

提前感谢您的帮助。

### 更新：

谢谢回复。我以前看过条形码字体，并且真的想取消在许多机器上安装字体。

还有一个我没有提到的程序的功能是打印仓库的库存代码，这些代码没有与之关联的 EAN 代码。这些通常是来自中国的具有复杂库存代码的物品。这些将需要使用 Code 128 条形码，该条形码使用扩展的字符范围并且占用更少的空间。

困难的部分主要是完成它只是创建我需要整理的图像。我不知道我是否想以一种复杂的方式来做这件事，之前并没有真正对图像做过任何工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T12:01:32.310

你知道存在绘制条形码的字体，所以你可以避免所有这些混乱吗？？？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T21:35:33.090

> > 但是，如果我这样做，我怎么知道要创建什么大小的位图以适合其上的完整条形码？

位图基于具有特定分辨率的物理设备，通常以 DPI（每英寸点数）测量。Windows 操作系统为显示器分配 96 或 120 dpi 的逻辑分辨率。打印机的物理分辨率为 300 - 600，有时高达 1200 或更高。处理胶片的照排机可以具有高达 2540 或更高 DPI 的物理分辨率。

逻辑分辨率意味着 X 点在某个设备上等于一英寸。通常这是一个近似值，可用于缩放。物理分辨率表示设备可以实现（或实际存在）X 个每英寸点数。

在制作条形码和打印到设备时，您必须考虑该设备的分辨率。如果您有一个 4 英寸宽的条形码并想在 600 dpi 打印机上打印，您需要一个 4 * 600 = 2400 像素宽的位图。在某些设备上打印还有其他影响，这样您就不会无意中缩小/放大代码条。

我所有漫无边际的要点是，您应该使用矢量格式（例如 .WMF 或 .EMF）生成条形码，然后将其渲染为针对您要输出到的设备量身定制的位图。这也将允许您在 CorelDRAW 或 Adob​​e Illustrator 等矢量绘图程序中编辑代码。

大多数（如果不是全部）条码都有一个宽度公式，它会告诉您在给定特定编码（条码中编码的符号系统）的情况下最终代码的宽度（以英寸为单位）。

有了这些知识，您可以使用类似于以下内容制作条形码（将此 vb.net 代码复制并粘贴到新项目的 form.load 或按钮单击事件中）：

```
 Dim gfx As Graphics = Me.CreateGraphics
Dim hdc As IntPtr = gfx.GetHdc()
Dim mf As System.Drawing.Imaging.Metafile = New Imaging.Metafile("c:\1.wmf", hdc, New RectangleF(0, 0, 5 * 2540, 1 * 2540), Imaging.MetafileFrameUnit.GdiCompatible)
Dim g As Graphics = Graphics.FromImage(mf)
g.PageUnit = GraphicsUnit.Inch

g.FillRectangle(Brushes.Blue, New RectangleF(0, 0, 5, 1))
g.FillRectangle(Brushes.Red, New RectangleF(0.25, 0.25, 4.5, 0.5))

g.Dispose()
mf.Dispose()
gfx.ReleaseHdc(hdc)
gfx.Dispose() 
```

*   图元文件构造函数中的尺寸是英寸 * 2540。2540 是一个常数，表示每英寸 0.01 毫米。这是底层 GDI 使用的。

*现在使用 CorelDRAW 或 Illustrator 等真正的*矢量图形程序打开“1.wmf”文件。（您不能使用 MSPaint 或 Windows Preview 等...）您会注意到您有一个 5x1 蓝色矩形，中间有一个 4.5 x 0.5 红色矩形。

这就是应如何将您的条形码*绘制到元文件*中。用您的条形码绘制例程替换蓝色和红色矩形代码。不要忘记创建一个透明的大小框架来告诉元文件你的绘图边界。

```
 g.FillRectangle(Brushes.Transparent, rectBounds) 
```

绘制条形码并将其保存到元文件后，您可以使用 GDI+ 加载它并将其渲染为具有输出设备分辨率的位图。显然，最后一步是将位图发送到您的输出设备，除非您的输出设备当然内置了矢量或 postscript 处理器。

好吧，这可能比您想知道的更多，但这是*正确*的方法，如果您的代码被指责为“不可扫描”，它将为您节省大量时间和心痛。 .

祝你好运，让我知道结果如何。

# oracle - 在oracle中将字符串转换为整数

> ID：857059
> 
> 赞同：4
> 
> 时间：2009-05-13T09:49:10.327
> 
> 标签：oracle, odp.net

我正在尝试将 Oracle（版本 8i）中的一列字符串解析为整数。

我正在通过 Oracle.DataAccess 库访问结果

我已经使用`TO_NUMBER`掩码将字符串转换为没有小数位的数字。问题是*客户端代码*中的值被检索为十进制而不是整数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T11:29:13.220

```
CAST(field AS integer) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T12:24:09.447

NUMBER 列在 ODP.NET 中始终以小数形式返回。要解决这个问题，请将其作为 OracleDecimal 拉回，它有几个“Toxxxx”方法可以将值转换为您需要的本机 .NET 类型。

```
while (myOracleDataReader.Read())
{
    int x = myOracleDataReader.GetOracleDecimal(0).ToInt32();
} 
```

（如果上面的代码不是 100% 正确，请原谅我，因为我家里没有安装 ODP.NET。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T10:46:39.047

[TO_NUMBER](http://www.techonthenet.com/oracle/functions/to_number.php)是您想要的，特别是`TO_NUMBER('42', '99')`版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T11:23:44.710

您始终可以使用 round 函数（或 trunc 或 floor 函数）将小数转换为整数

# c - 如何将任意大整数从基数 10 转换为基数 16？

> ID：857070
> 
> 赞同：3
> 
> 时间：2009-05-13T09:53:15.623
> 
> 标签：c, base

该程序需要一个任意大的无符号整数的输入，该整数表示为以 10 为基数的一个字符串。输出是另一个以 16 为基数表示整数的字符串。

例如，输入为“1234567890987654321234567890987654321234567890987654321”，输出为“CE3B5A137DD015278E09864703E4FF9952FF6B62C1CB1”

算法越快越好。

如果输入限制在 32 位或 64 位整数之内，那就很容易了；例如，以下代码可以进行转换：

```
#define MAX_BUFFER 16
char hex[] = "0123456789ABCDEF";

char* dec2hex(unsigned input) {
    char buff[MAX_BUFFER];
    int i = 0, j = 0;
    char* output;

    if (input == 0) {
        buff[0] = hex[0];
        i = 1;
    } else {
        while (input) {
            buff[i++] = hex[input % 16];
            input = input / 16;
        }
    }

    output = malloc((i + 1) * sizeof(char));
    if (!output) 
        return NULL;

    while (i > 0) {
        output[j++] = buff[--i];        
    }
    output[j] = '\0';

    return output;
} 
```

真正具有挑战性的部分是“任意大”无符号整数。我用谷歌搜索过，但他们中的大多数都在谈论 32 位或 64 位内的转换。没有找到运气。

任何人都可以给出任何点击或任何可以阅读的链接吗？

提前致谢。

**编辑**这是我最近遇到的一个面试问题。谁能简要解释一下如何解决这个问题？我知道有一个 gmp 库并且我以前使用过它；然而，作为一个面试问题，它不需要使用外部库。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-14T00:39:46.110

1.  分配一个整数数组，元素个数等于输入字符串的长度。将数组初始化为全 0。

    这个整数数组将以 16 为基数存储值。

2.  将输入字符串中的十进制数字添加到数组的末尾。将现有值乘以 10 添加结转，将新值存储在数组中，新结转值是 newvalue div 16。

    ```
    carryover = digit;
    for (i = (nElements-1); i >= 0; i--)
    {
        newVal = array[index] * 10) + carryover;
        array[index] = newval % 16;
        carryover = newval / 16;
    } 
    ```

3.  打印数组，从第 0 个条目开始并跳过前导 0。

* * *

这是一些可以工作的代码。毫无疑问，可能会进行一些优化。但这应该足以作为一个快速而肮脏的解决方案：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "sys/types.h"

char HexChar [16] = { '0', '1', '2', '3', '4', '5', '6', '7',
                      '8', '9', 'A', 'B', 'C', 'D', 'E', 'F' };

static int * initHexArray (char * pDecStr, int * pnElements);

static void addDecValue (int * pMyArray, int nElements, int value);
static void printHexArray (int * pHexArray, int nElements);

static void
addDecValue (int * pHexArray, int nElements, int value)
{
    int carryover = value;
    int tmp = 0;
    int i;

    /* start at the bottom of the array and work towards the top
     *
     * multiply the existing array value by 10, then add new value.
     * carry over remainder as you work back towards the top of the array
     */
    for (i = (nElements-1); (i >= 0); i--)
    {
        tmp = (pHexArray[i] * 10) + carryover;
        pHexArray[i] = tmp % 16;
        carryover = tmp / 16;
    }
}

static int *
initHexArray (char * pDecStr, int * pnElements)
{
    int * pArray = NULL;
    int lenDecStr = strlen (pDecStr);
    int i;

    /* allocate an array of integer values to store intermediate results
     * only need as many as the input string as going from base 10 to
     * base 16 will never result in a larger number of digits, but for values
     * less than "16" will use the same number
     */

    pArray = (int *) calloc (lenDecStr,  sizeof (int));

    for (i = 0; i < lenDecStr; i++)
    {
        addDecValue (pArray, lenDecStr, pDecStr[i] - '0');
    }

    *pnElements = lenDecStr;

    return (pArray);
}

static void
printHexArray (int * pHexArray, int nElements)
{
    int start = 0;
    int i;

    /* skip all the leading 0s */
    while ((pHexArray[start] == 0) && (start < (nElements-1)))
    {
        start++;
    }

    for (i = start; i < nElements; i++)
    {
        printf ("%c", HexChar[pHexArray[i]]);
    }

    printf ("\n");
}

int
main (int argc, char * argv[])
{
    int i;
    int * pMyArray = NULL;
    int nElements;

    if (argc < 2)
    {
        printf ("Usage: %s decimalString\n", argv[0]);
        return (-1);
    }

    pMyArray = initHexArray (argv[1], &nElements);

    printHexArray (pMyArray, nElements);

    if (pMyArray != NULL)
        free (pMyArray);

    return (0);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-05-01T22:52:33.657

我写了[一篇文章](https://jonnydee.wordpress.com/2011/05/01/convert-a-block-of-digits-from-base-x-to-base-y)，描述了 Python 中的一个简单解决方案，可用于将一系列数字从任意数基转换为任意数基。我最初在 C 中实现了该解决方案，并且我不希望依赖于外部库。我认为你应该能够用 C 或任何你喜欢的方式重写非常简单的 Python 代码。

这是Python代码：

```
import math
import string

def incNumberByValue(digits, base, value):
   # The initial overflow is the 'value' to add to the number.
   overflow = value
   # Traverse list of digits in reverse order.
   for i in reversed(xrange(len(digits))):
      # If there is no overflow we can stop overflow propagation to next higher digit(s).
      if not overflow:
         return
      sum = digits[i] + overflow
      digits[i] = sum % base
      overflow = sum / base

def multNumberByValue(digits, base, value):
   overflow = 0
   # Traverse list of digits in reverse order.
   for i in reversed(xrange(len(digits))):
      tmp = (digits[i] * value) + overflow
      digits[i] = tmp % base
      overflow = tmp / base

def convertNumber(srcDigits, srcBase, destDigits, destBase):
   for srcDigit in srcDigits:
      multNumberByValue(destDigits, destBase, srcBase)
      incNumberByValue(destDigits, destBase, srcDigit)

def withoutLeadingZeros(digits):
   for i in xrange(len(digits)):
      if digits[i] != 0:
         break
   return digits[i:]

def convertNumberExt(srcDigits, srcBase, destBase):
   # Generate a list of zero's which is long enough to hold the destination number.
   destDigits = [0] * int(math.ceil(len(srcDigits)*math.log(srcBase)/math.log(destBase)))
   # Do conversion.
   convertNumber(srcDigits, srcBase, destDigits, destBase)
   # Return result (without leading zeros).
   return withoutLeadingZeros(destDigits)

# Example: Convert base 10 to base 16
base10 = [int(c) for c in '1234567890987654321234567890987654321234567890987654321']
base16 = convertNumberExt(base10, 10, 16)
# Output list of base 16 digits as HEX string.
hexDigits = '0123456789ABCDEF'
string.join((hexDigits[n] for n in base16), '') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T10:03:33.517

> 真正具有挑战性的部分是“任意大”无符号整数。

您是否尝试过使用[GNU MP Bignum](http://gmplib.org/)库？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T10:02:05.547

这是一个 BigInt 库：

```
http://www.codeproject.com/KB/cs/BigInt.aspx?msg=3038072#xx3038072xx 
```

不知道它是否有效，但这是我在 Google 上找到的第一个。它似乎具有解析和格式化大整数的功能，因此它们也可能支持不同的基数。

**编辑：**啊，您使用的是 C，我的错误。但是您可能能够从代码中获得灵感，或者使用 .NET 的人可能会有同样的问题，所以我将把它留在这里。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T10:04:40.190

Unix`dc`能够对任意大整数进行基本转换。打开 BSD 源代码可[在此处](http://www.openbsd.org/cgi-bin/cvsweb/src/usr.bin/dc/)获得。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-30T15:51:55.203

Python：

```
>>> from string import upper
>>> input = "1234567890987654321234567890987654321234567890987654321"
>>> output = upper(hex(int(input)))[2:-1]
>>> print output
CE3B5A137DD015278E09864703E4FF9952FF6B62C1CB1 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-08-10T09:50:54.743

这是上面提到的用javascript实现的算法：

```
function addDecValue(hexArray, value) {
  let carryover = value;
  for (let i = (hexArray.length - 1); i >= 0; i--) {
    let rawDigit = ((hexArray[i] || 0) * 10) + carryover;
    hexArray[i] = rawDigit % 16;
    carryover = Math.floor(rawDigit / 16);
  }
}

function toHexArray(decimalString) {
  let hexArray = new Array(decimalString.length);
  for (let i = 0; i < decimalString.length; i++) {
    addDecValue(hexArray, Number(decimalString.charAt(i)));
  }
  return hexArray;
}

function toHexString(hexArray) {
  const hexDigits = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F'];
  let result = '';
  for (let i = 0; i < hexArray.length; i++) {
    if (result === '' && hexArray[i] === 0) continue;
    result += hexDigits[hexArray[i]];
  }
  return result
}

toHexString(toHexArray('1234567890987654321234567890987654321234567890987654321')); 
```

# c++ - 我可以迭代在一个迭代器范围内但不在另一个迭代器范围内的元素吗？

> ID：857072
> 
> 赞同：2
> 
> 时间：2009-05-13T09:53:16.777
> 
> 标签：c++, stl, iterator, range

假设我有一个顺序容器，以及该容器中当前“活动”的元素的范围（一对迭代器）。在某个时候，我计算了一个新的应该处于活动状态的元素范围，它可能与之前的范围重叠。然后，我想迭代旧活动范围内但不在新活动范围内的元素以“停用”它们（并类似地迭代新范围内但不是旧范围内的元素以“激活” ' 他们）。

这可能吗？

如果我知道新活动范围的开始在容器中总是比旧活动范围的开始晚，是否会变得更容易？

出于问题的目的，假设容器是一个向量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T10:01:29.773

您可以将两组用于最后一个活动范围，另一个用于当前活动范围。使用[`set_difference`](http://www.sgi.com/tech/stl/set_difference.html)算法获取要激活/停用的对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T16:13:23.707

你需要的是一个`range_difference`函数。我虽然 Boost.Range 会提供类似的东西，但我在他们的文档中没有找到任何东西（好吧，我没有彻底搜索......），所以我自己整理了。

以下函数返回一对范围，其中包含由 (first1,last1) 表示的范围与由 (first2,last2) 表示的范围之间的差异的结果。前提条件是 first1 必须位于 first2 之前或相同的位置。

```
template <typename InputIterator>
std::pair<
    std::pair<InputIterator, InputIterator>, 
    std::pair<InputIterator, InputIterator> >
range_difference(InputIterator first1, InputIterator last1,
                 InputIterator first2, InputIterator last2)
{
    typedef std::pair<InputIterator, InputIterator> Range;

    InputIterator it;

    // first1 must be <= first2
    for (it = first1 ; it != last1 && it != first2 ; ++it);

    Range left_range = std::make_pair(first1, it); // Left range

    if (it == last1) 
        return std::make_pair(left_range, std::make_pair(first2, first2));

    // it == first2
    while (it != last1 && it != last2) ++it;

    return std::make_pair(left_range, std::make_pair(it, last1)); // Right range
} 
```

如果 range2 完全包含在 range1 中，则差异的结果可以由两部分组成。你最终得到一个左范围和一个右范围：

```
 |_____________________|__________________|________________________|    
first1                first2             last2                    last1 
```

在这种情况下，函数返回 (first1, first2),(last2, last1)。

在这个其他配置中，

```
 |_____________________|                 |________________________|    
first1                last1             first2                    last2 
```

函数返回 (first1, last1),(first2, first2)。还有许多其他可能的配置。但是，要知道的重要一点是，在正确范围为空的情况下，它将位于**max(first2, last1)**。您将在示例中看到这是多么必要。

最后，如果first1和first2在同一个位置，返回的左边范围为空，id(first1,first1)。

现在，我们如何使用此功能来解决您的问题？好吧，这对于“停用”范围来说相当容易，但对于“激活”范围来说有点棘手：

```
typedef std::vector<Activable>::iterator Iterator;

Iterator old_beg, old_end, new_beg, new_end; // Old and new ranges

typedef std::pair<Iterator, Iterator> Range;
typedef std::pair<Range, Range> SplitRange;

SplitRange deactivate = range_difference(old_beg, old_end, new_beg, new_end);

// Left range
for (Iterator it = deactivate.first.first;
     it != deactivate.first.second;
     ++it)
    it->deactivate();

// Right range
for (Iterator it = deactivate.second.first;
     it != deactivate.second.second;
     ++it)
    it->deactivate();

SplitRange activate = 
    range_difference(new_beg, new_end, new_beg, deactivate.second.first);
// Note the use of the previously returned right range -------^

for (Iterator it = activate.second.first;
     it != activate.second.second;
     ++it)
    it->activate(); 
```

你去吧。也许这个解决方案对你的问题有点矫枉过正，但我​​认为这个`range_difference`功能在很多地方都很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T11:32:22.153

这是一个简单的解决方案：

```
typedef std::pair<std::vector<T>::iterator, std::vector<T>::iterator> Range;
void Update(std::vector<T>& v, Range oldActive, Range newActive)
{
    int op = 0;
    for (std::vector<T>::iterator i = v.begin(), end = v.end(); i != end; ++i)
    {
        if (i == oldActive.first) op += 1;
        if (i == oldActive.second) op -= 1;
        if (i == newActive.first) op += 2;
        if (i == newActive.second) op -= 2;
        if (op == 1) i->Deactivate();
        if (op == 2) i->Activate();
    }
} 
```

这故意将简单性放在效率之前作为起点，因为它扫描整个向量；另一方面，它是单次传递，不进行复制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T13:46:14.337

我想我会保持简单：

```
// Iterators denoting the old and new ranges (might be cleaner to use some kind
// of typedef like James Hopkin's did, but that's not the most important)
std::vector<Activable>::iterator old_beg,
                                 old_end,
                                 new_beg,
                                 new_end;

std::vector<Activable>::iterator it;

// Deactivate
for (it = old_beg ;                   // go from the beginning of the old range
     it != old_end && it != new_beg ; // to either the end of the old one or the
     ++it)                            // beginning of the new one
    it->deactivate();

// "Jump" to the correct position
if (it == old_end) it = new_beg; // no overlap
else               it = old_end; // overlap

// Activate
for (; it != new_end ; ++it)
    it->activate(); 
```

你会注意到我假设新范围不能完全包含在旧范围中（例如，你不能有一个从索引 4 到 10 的旧范围，而一个从 5 到 7 的新范围）。如果是这种情况，您需要稍微更改算法。

# jquery - jQuery UI 滑块固定值

> ID：857075
> 
> 赞同：16
> 
> 时间：2009-05-13T09:55:16.947
> 
> 标签：jquery, jquery-ui

我正在尝试让 jQuery 滑块设置要滑动的值，而不是最小和最大数量之间的每个数字。

我想要“0、25、50、100、250、500”作为人们也可以滑动但无法弄清楚它是如何完成的唯一数量。将它们放在“价值”部分似乎没有任何作用。

```
<script type="text/javascript">
$(function() {
    $("#slider-range").slider({
        range: true,
        min: 0,
        max: 500,
        values: [100, 250],
        slide: function(event, ui) {
            $("#amount").val('Miles: ' + ui.values[0] + ' - ' + ui.values[1]);
        }
    });
    $("#amount").val('Miles: ' + $("#slider-range").slider("values", 0) + ' - ' + $("#slider-range").slider("values", 1));
});
</script> 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-13T12:26:17.587

值初始化器用于提供多拇指滑块的起始位置。

我将提供一个可能值的数组，更改滑块以映射到该数组的范围，然后更改您的表示位以从适当的数组元素中读取。

**范围滑块：多拇指版本**

```
$(function() {
    var valMap = [0, 25, 50, 100, 250, 500];
    $("#slider-range").slider({
        min: 0,
        max: valMap.length - 1,
        values: [0, 1],
        slide: function(event, ui) {                        
            $("#amount").val('Miles: ' + valMap[ui.values[0]] + ' - ' + valMap[ui.values[1]]);                
        }       
    });
    $("#amount").val('Miles: ' + valMap[$("#slider-range").slider("values", 0)] + ' - ' + valMap[$("#slider-range").slider("values", 1)]);
}); 
```

![在此处输入图像描述](https://i.stack.imgur.com/ALROv.png)

**范围滑块：单拇指版本**

* * *

```
$(function() {
    var valMap = [0, 40, 50, 63, 90, 110, 125, 140, 160, 225, 250];
    $("#slider-range").slider({
        min: 1,
        max: valMap.length - 1,
        value: 0,
        slide: function(event, ui) {                        
            $("#amount").val(valMap[ui.value]);                
        }       
    });
    //$("#amount").val(valMap[ui.value]);
}) 
```

;

**最小的html：**

```
<input type="text" id="amount" value="40" />
<div id="slider-range"></div> 
```

![在此处输入图像描述](https://i.stack.imgur.com/3ywxY.png)

# bash - IP 地址和国家与 AWK 在同一行

> ID：857077
> 
> 赞同：3
> 
> 时间：2009-05-13T09:55:36.897
> 
> 标签：bash, awk

我正在寻找一个基于 IP 列表的单行程序，它将附加 IP 所在的国家/地区

所以如果我有这个作为输入：

```
87.229.123.33
98.12.33.46
192.34.55.123 
```

我想制作这个：

```
87.229.123.33 - GB
98.12.33.46 - DE
192.34.55.123 - US 
```

我已经有了一个返回 IP 国家/地区的脚本，但我需要用 awk 将它们粘合在一起，到目前为止，这是我想出的：

```
$ get_ips | nawk '{ print $1; system("ip2country " $1) }' 
```

这很酷，但是ip和国家不在同一行显示，如何将系统输出和ip合并在一行？

如果您有更好的方法来做到这一点，我愿意接受建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T11:54:21.760

您可以使用*printf*代替 print：

```
{ printf("%s - ", $1); system("ip2country " $1); } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T13:23:39.460

awk 中正确的单行解决方案是：

```
awk '{printf("%s - ", $1) ; system("ip2country \"" $1 "\"")}' < inputfile 
```

但是，我认为如果您使用如下所示的 python 程序会更快：

```
#!/usr/bin/python
# 'apt-get install python-geoip' if needed
import GeoIP
gi = GeoIP.new(GeoIP.GEOIP_MEMORY_CACHE)
for line in file("ips.txt", "r"):
    line = line[:-1] # strip the last from the line
    print line, "-", gi.country_code_by_addr(line) 
```

如您所见，geoip 对象仅初始化一次，然后被所有查询重用。查看[geoip 的 python 绑定](http://www.maxmind.com/app/python)。另请注意，您的 awk 解决方案每行 2 次分叉一个新进程！

我不知道您需要处理多少条目，但如果它很多，您应该考虑一些不分叉并将geoip数据库保存在内存中的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T10:07:12.917

我将使用 perl 单行符来回答，因为我比 awk 更了解该语法。“chomp”将切断困扰你的换行符。

```
get_ips | perl -ne 'chomp; print; print `ip2country $_`' 
```

# javascript - 在其他文本中搜索文本并使用 javascript 突出显示它

> ID：857079
> 
> 赞同：2
> 
> 时间：2009-05-13T09:55:55.213
> 
> 标签：javascript

在html静态页面的buttonclick上找到文本框中给定的文本。然后使用javascript突出显示它

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T10:03:01.130

**[这是在 Page 中搜索文本](http://www.javascripter.net/faq/searchin.htm)**的代码示例。它本质上相当于在浏览器中使用+ in 进行**查找。**如果您使用[jQuery](http://jquery.com)库，您可以使用[Search-Highlight 插件](http://www.jquery.info/The-plugin-SearchHighlight)以类似于 Google 搜索的方式突出显示文本。`CTRL``F`

```
<html>
<head>
<script language="JavaScript">
<!--
var TRange=null;
function findString (str) {
 if (parseInt(navigator.appVersion)<4) return;
 var strFound;
 if (window.find) {

  // CODE FOR BROWSERS THAT SUPPORT window.find
  strFound=self.find(str);
  if (strFound && self.getSelection && !self.getSelection().anchorNode) {
   strFound=self.find(str)
  }
  if (!strFound) {
   strFound=self.find(str,0,1)
   while (self.find(str,0,1)) continue
  }
 }
 else if (navigator.appName.indexOf("Microsoft")!=-1) {

  // EXPLORER-SPECIFIC CODE

  if (TRange!=null) {
   TRange.collapse(false)
   strFound=TRange.findText(str)
   if (strFound) TRange.select()
  }
  if (TRange==null || strFound==0) {
   TRange=self.document.body.createTextRange()
   strFound=TRange.findText(str)
   if (strFound) TRange.select()
  }
 }
 else if (navigator.appName=="Opera") {
  alert ("Opera browsers not supported, sorry...")
  return;
 }
 if (!strFound) alert ("String '"+str+"' not found!")
 return;
}
//-->
</script>
</head>
<body>
<form name="f1" action="" 
    onSubmit="if(this.t1.value!=null && this.t1.value!='') findString(this.t1.value);return false">
    <input type="text" name=t1 value="" size=20>
    <input type="submit" name=b1 value="Find">
    <p>This is some sample text.</p>
</form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-28T12:49:37.313

```
 <form id=f1 name="f1" action="" 
onSubmit="if(this.t1.value!=null && this.t1.value!='')
findString(this.t1.value);return false"
>
<input type="text" id=t1 name=t1size=20>
<input type="submit" name=b1 value="Find">
</form>
<script>
var TRange=null;

function findString (str) {
 if (parseInt(navigator.appVersion)<4) return;
 var strFound;
 if (window.find) {

  // CODE FOR BROWSERS THAT SUPPORT window.find

  strFound=self.find(str);
  if (!strFound) {
   strFound=self.find(str,0,1);
   while (self.find(str,0,1)) continue;
  }
 }
 else if (navigator.appName.indexOf("Microsoft")!=-1) {

  // EXPLORER-SPECIFIC CODE

  if (TRange!=null) {
   TRange.collapse(false);
   strFound=TRange.findText(str);
   if (strFound) TRange.select();
  }
  if (TRange==null || strFound==0) {
   TRange=self.document.body.createTextRange();
   strFound=TRange.findText(str);
   if (strFound) TRange.select();
  }
 }
 else if (navigator.appName=="Opera") {
  alert ("Opera browsers not supported, sorry...")
  return;
 }
 if (!strFound) alert ("String '"+str+"' not found!")
 return;
}
</script> 
```

# ruby-on-rails - 建议请求：通过 rails 服务本地文件夹（或不服务？）

> ID：857081
> 
> 赞同：1
> 
> 时间：2009-05-13T09:56:21.360
> 
> 标签：ruby-on-rails, http, upload, download

任务：通过 http/80 将服务器上本地文件夹中的文件提供给客户端。最后，我计划模拟客户端上的文件夹，但这与我的问题无关。

因此，该服务器上有一个现有的 Rails 应用程序（基于 rest/xml），客户端将与这些文件一起使用。

我不需要在上传或下载时对文件执行任何逻辑，所以我问自己：

1.  我是否需要让我的 Rails 应用程序参与提供这些文件？
2.  网络服务器不应该单独处理本地文件和客户端之间的链接吗？
3.  这种新的 Rails Metal 或 Rack 集成会成为解决方案的一部分吗？（两个都不熟悉）

我想这里重要的是 http over 80 端口。

感谢您对此事的任何指示或建议，干杯，Max

我知道，通过良好的时间投资，我可以花几个小时查看所有这些并弄清楚，但我非常非常忙，为我节省了很多时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-15T21:31:30.497

Apache? Just add another `<Directory>` section to your configuration for the Rails app:

```
Alias /static-files /path/to/the/static-files
<Directory /path/to/the/static-files>
    Order allow, deny
    Allow from all
    # whatever else you need, Options, AllowOverride, etc.
</Directory> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-15T03:01:07.887

you can use X-Sendfile if you are using Apache or Lighty (see [this](http://john.guen.in/past/2007/4/17/send_files_faster_with_xsendfile/) blog post). Nginx supports [X-Accel-Redirect](http://blog.kovyrin.net/2006/11/01/nginx-x-accel-redirect-php-rails/). Both of these approaches will let your web server directly send the file without involving your rails app.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T10:39:23.567

将文件放在“公共”目录的子目录中 - 与样式表和 javascripts 一样

# hibernate - 休眠 - 问题帮助

> ID：857083
> 
> 赞同：1
> 
> 时间：2009-05-13T09:56:41.950
> 
> 标签：hibernate

我有个问题。

我的应用程序使用 1) 现有的休眠连接来检索一些数据。现在它必须 2) 更新同一数据库中的一些表，从中检索数据，这必须通过单独的连接发生。

是否可以为此目的单独拥有一个 hibernate.cfg.xml 文件？

如果是这样，我将如何区分连接。

或者我不能在第二种情况下使用休眠本身？

请帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T13:18:28.033

有两种方法可以做到这一点。您可以将 XML 配置文件显式传递给配置：

```
AnnotationConfiguration cfg1 = new AnnotationConfiguration();
cfg.configure("/hibernate1.cfg.xml");

AnnotationConfiguration cfg2 = new AnnotationConfiguration();
cfg.configure("/hibernate2.cfg.xml"); 
```

或者您可以在获取 SessionFactory 之前手动更新数据库属性：

```
Configuration cfg1 = new Configuration();
cfg1.addClass(...)
Properties p = new Properties();
p.put(Environment.DATASOURCE, "jdbc/database1"); // if using JNDI
p.put(Environment.URL, DRIVER, etc..) // if using a direction connection
cfg1.addProperties(p);
cfg1.buildSessionFactory(); 
```

...重复使用不同属性的其他配置

无论您怎么做，您都可以从正确的会话工厂获取会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T11:02:14.730

在没有测试过这种情况的情况下，应该可以使用 Hibernate。您需要使用相同的映射设置两个*SessionFactory*`-> hibernate.cfg.xml` ，但连接的配置不同（ ）。在应用程序中使用看起来像

```
// read entry using first session factory
Session sessionForRead = readSessionFactory.getCurrentSession(); // or openSession()
sessionForRead.beginTransaction();
MyEntry entry = (MyEntry) sessionForRead.load(MyEntry.class, someId) // or whatever to load entries
sessionForRead.getTransaction().commit();

// update entry using the other session factory
Session sessionForUpdate = updateSessionFactpry.getCurrentSession(); // or openSession()
sessionForUpdate.beginTransaction();
sessionForUpdate.update(entry);
sessionForUpdate.getTransaction().commit(); 
```

还有一种方法可以使用给定的 JDBC 连接打开会话（请参阅[SessionFactory 的 JavaDoc](https://www.hibernate.org/hib_docs/v3/api/org/hibernate/SessionFactory.html#openSession(java.sql.Connection))），但我从未使用过它。也许你可以试一试。不过，第一个解决方案对我来说看起来更干净。

# c++ - 隐藏自动完成弹出窗口的最正确方法是什么？

> ID：857085
> 
> 赞同：1
> 
> 时间：2009-05-13T09:57:07.643
> 
> 标签：c++, winapi, autocomplete

我正在纯 WinApi 中开发一个自定义自动完成控件，我遇到的问题是我不知道在控件外部单击时如何隐藏弹出窗口（例如模拟组合框下拉行为）。它通常是如何实现的？我应该使用鼠标捕获吗？谢谢。

UPD：跟踪键盘焦点不符合要求，因为拖动父窗口也应该隐藏下拉菜单。

UPD：鼠标捕获不起作用，因为它“在鼠标悬停在捕获窗口上时捕获鼠标输入，或者在鼠标悬停在捕获窗口上且按钮仍处于按下状态时按下鼠标按钮”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T10:54:58.300

阅读[本文](http://msdn.microsoft.com/en-us/magazine/cc163572.aspx)后，我现在相信使用 SetWindowsHookEx 和 WH_MOUSE 钩子是可行的方法。

但也许有一个更简单的解决方案？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T14:24:17.560

自动完成是 Win32 api (Shell) 中的本机
您不需要代码。
（Windows Shell Autocomplete的源代码见[Win32组](http://groups.google.com/group/comp.os.ms-windows.programmer.win32/topics?lnk=srg)）

# visual-studio-2008 - 在 Visual Studio 2008 上禁用 Visual Studio 托管进程

> ID：857096
> 
> 赞同：1
> 
> 时间：2009-05-13T09:59:46.237
> 
> 标签：visual-studio-2008, configuration

我发现的所有禁用 Visual Studio 托管过程的说明如下：

1.  在 Visual Studio 中打开一个项目。
2.  在项目菜单上，单击属性。
3.  单击调试选项卡。
4.  清除启用 Visual Studio 托管进程复选框。

我相信这适用于 VS 2005，因为在我的 VS 2008 C++ 项目中没有“调试”这样的选项卡，而是“调试”，并且没有用于禁用托管进程的复选框。

所以我的问题是，如何禁用 VS 2008 上的托管进程？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T10:25:57.690

这些说明适用于 VS 2008，但仅适用于 VB / C# 项目。据我所知，VS 不使用 C++ 项目的托管服务。

# emacs - 如何仅针对 Emacs 中的特定模式或缓冲区过滤编译输出？

> ID：857098
> 
> 赞同：5
> 
> 时间：2009-05-13T10:00:30.650
> 
> 标签：emacs, compilation, filtering, elisp, buffer

我有一个`html-mode`启用的 HTML 页面。我调用函数`sgml-validate`来检查任何标记错误。它基于`compilation-mode`. 我想从编译输出中删除一些警告，所以我编写了一个函数并将其挂钩`compilation-filter-hook`（此变量未记录，但`compilation-filter`会调用它）。一切正常。我的问题是，如何确保仅在 HTML 页面（通过`sgml-validate`）上开始编译过程时才调用我的过滤器函数？

我看到了两种方法，但都没有奏效：

*   首先，我可以检查 的值`major-mode`。但它总是返回`compilation-mode`，因为在`*compilation*`缓冲区上启用了它。（我在 的[源代码中`grep+`](http://www.emacswiki.org/emacs/grep+.el)找到了一个过滤器函数，他们确实检查了 的值`major-mode`。我不知道它是如何正常工作的。）
*   另一个想法是仅将我的过滤器函数挂钩到 HTML 文件的缓冲区，但由于类似的原因，它无法工作，因为编译过程的输出进入单独的缓冲区。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T11:10:41.470

同时，我发现`compilation-start`接受一个可选参数`mode`，这将是编译缓冲区的主要模式。所以我可以创建一个从 派生的主要模式`compilation-mode`，并在那里定义我的过滤器函数现在连接到正确的缓冲区。

唯一的问题是现在`sgml-validate`不允许我将`mode`参数设置为`compilation-start`，但这是另一个问题。

（当然，我不认为这是最终的解决方案。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T13:54:13.857

听起来您可以建议 smgl-validate 以便它在执行所有其他操作之前执行过滤。例如：

```
（defadvice sgml-validate（围绕修复过滤命令激活）
    (let ((return-value ad-do-it))
      （过滤器函数返回值））））

```

# database - 使用 DB2 .NET 数据提供程序调用异步过程

> ID：857100
> 
> 赞同：1
> 
> 时间：2009-05-13T10:00:37.357
> 
> 标签：database, ado.net, db2

有没有办法使用 DB2 .NET 数据提供程序异步调用 DB2 存储过程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T21:30:10.983

有多种方法 - 哪种方法合适取决于您的情况。

我在 Oracle 中所做的是根据工作项 ID 队列从数据库中取回 1000 条 XML 项。使用数据读取器一次性将它们取出并不起作用，因此我在几个不同的线程上一次取出 1 个（每个线程从队列中取出一个工作项，直到队列为空）。当每个单独的线程返回结果时，它会将 XML 放入一个生产者消费者队列中——基于[Joseph Albahari 出色的线程教程的](http://www.albahari.com/threading/part2.aspx)队列。一个单独的线程查看生产者消费者队列，对数据执行 XSL 转换并将它们写到一个文件中——当然，我首先在单线程中进行了基准测试，这明显慢了很多。

我尝试使用线程[池](http://www.albahari.com/threading/part3.aspx#_Thread_Pooling)/[异步委托](http://www.albahari.com/threading/part3.aspx#_Asynch_Delegates)开始（因为关于线程的一般建议是在可能的情况下使用线程池，委托也间接使用），如果您没有超过 64 个项目要做，这可能会起作用。[`WaitHandle.WaitAll`通常有 64 个工作项的限制。](http://msdn.microsoft.com/en-us/magazine/cc163914.aspx). 因为我有 1000 个，所以这不是一个好选择，除了分批 64 批做这些看起来很笨拙。

当每个人都没有更多工作要做时，我从内存中优雅地退出了生产者线程，然后阻塞直到生产者消费者队列也为空。

最重要的是确保每个线程上有完全独立的数据库对象，否则你会偶然发现线程问题。

如果您只想在 Windows 表单/WPF 应用程序中异步执行 1 个存储过程，您可能需要查看使用[后台工作组件](http://www.albahari.com/threading/part3.aspx#_BackgroundWorker)。

如果您知道是否需要任何进一步的信息，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T10:07:29.373

BeginExecuteNonQuery 不起作用？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-03T09:19:55.677

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T14:04:28.520

问题是没有 BeginExecuteNonQuery。

# .net - 为什么使用 TransactionScope 和 MSDTC 的 VS 数据库单元测试会失败？

> ID：857103
> 
> 赞同：2
> 
> 时间：2009-05-13T10:01:28.463
> 
> 标签：.net, unit-testing, exception-handling, msdtc

我们使用[DatabaseTestFixture](http://softwaredevscott.spaces.live.com/blog/cns!1A9E939F7373F3B7!155.entry)类针对 SQL Server 2000 数据库运行了一些单元测试，该类使用未提交的 TransactionScope，因此所有更改都会回滚。测试针对本地数据库运行，没有问题。

然后，我们将单元测试指向一个通用数据库服务器，并在运行单元测试的机器上设置 MSDTC，这台机器一切正常。

现在虽然我们已经设置了一台新机器，它将针对相同的公共数据库运行单元测试。单元测试不在这台机器上运行，我们得到以下错误：

> System.Transactions.TransactionException ：事务已被隐式或显式提交或中止。

MSDTC 设置与正在运行的设置完全相同，我们逐屏比较。

有没有人经历过这样的事情？或者得到任何关于我们可以在哪里寻找可能导致它的线索的指示？

我们检查了 Windows 版本和服务包、防火墙选项、msdtc 选项、VS 版本和服务包。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-25T19:15:25.873

这似乎与 NUnit 2.5 有关。在此之前，以下代码运行良好：

```
[SetUp]
public void SetUp() {
    this._testDataContext = new DataContext();
    this._transactionScope = new TransactionScope();
}

[TearDown]
public void TearDown() {
    if (_transactionScope != null)
    {
        this._transactionScope.Dispose();
    }
    if (_testDataContext != null)
    {
        _testDataContext.Dispose();
    }
} 
```

在 2.5 中，事务范围需要用`TransactionScopeOption.RequiresNew`. 我假设它没有被正确处理，或者 NUnit 在运行测试时运行了一些环境事务。将 SetUp 方法的第二行更改为

```
this._transactionScope = new TransactionScope(TransactionScopeOption.RequiresNew); 
```

它应该可以正常工作。

如果有人设法更好地解释为什么会发生这种情况，我很想听听。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T15:01:07.307

此问题可能与您使用的 Nunit 版本有关。运行单元 2.5 时我遇到了完全相同的问题，但是当我使用 nunit 2.4.8 或 2.2 运行单元测试时，问题神秘地消失了。

请尝试这个让我知道，这样我就可以提高我微不足道的个人资料积分！

问候

苹果电脑

# c# - Plinq 给出了与 Linq 不同的结果——我做错了什么？

> ID：857107
> 
> 赞同：6
> 
> 时间：2009-05-13T10:02:17.637
> 
> 标签：c#, linq, plinq

谁能告诉我正确的 Plinq 代码是什么？我将双精度数组的每个元素的正弦绝对值的平方根相加，但 Plinq 给了我错误的结果。

该程序的输出是：

Linq 聚合 = 75.8310477905274（正确） Plinq 聚合 = 38.0263653589291（大约应该是一半）

我一定是做错了什么，但我不知道是什么...

（我在 Core 2 Duo Windows 7 x64 PC 上使用 Visual Studio 2008 运行它。）

这是代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main()
        {
            double[] array = new double[100];

            for (int i = 0; i < array.Length; ++i)
            {
                array[i] = i;
            }

            double sum1 = array.Aggregate((total, current) => total + Math.Sqrt(Math.Abs(Math.Sin(current))));
            Console.WriteLine("Linq aggregate = " + sum1);

            IParallelEnumerable<double> parray = array.AsParallel<double>();
            double sum2 = parray.Aggregate((total, current) => total + Math.Sqrt(Math.Abs(Math.Sin(current))));
            Console.WriteLine("Plinq aggregate = " + sum2);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T12:06:35.077

聚合在 PLINQ 中的工作方式略有不同。

来自[MSDN 博客：](http://blogs.msdn.com/pfxteam/archive/2008/06/05/8576194.aspx)

> 用户并没有期望一个值来初始化累加器，而是给我们一个生成该值的工厂函数：

```
public static double Average(this IEnumerable<int> source)
{
    return source.AsParallel().Aggregate(
        () => new double[2],
        (acc, elem) => { acc[0] += elem; acc[1]++; return acc; },
        (acc1, acc2) => { acc1[0] += acc2[0]; acc1[1] += acc2[1]; return acc1; },
        acc => acc[0] / acc[1]);
} 
```

> 现在，PLINQ 可以为每个线程初始化一个独立的累加器。现在每个线程都有自己的累加器，折叠函数和累加器组合函数都可以自由地改变累加器。PLINQ 保证不会从多个线程同时访问累加器。

因此，在您的情况下，您还需要传递一个累加器函数，该函数对并行聚合的输出求和（因此您看到的结果大约是应有的一半）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T14:59:37.697

谢谢 MSDN 博客。它现在似乎工作正常。我改变了我的代码如下：

```
using System;
using System.Linq;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main()
        {
            Test();
        }

        static void Test()
        {
            double[] array = new double[100];

            for (int i = 0; i < array.Length; ++i)
            {
                array[i] = i;
            }

            double sum1 = array.Aggregate((total, current) => total + Math.Sqrt(Math.Abs(Math.Sin(current))));
            Console.WriteLine("Linq aggregate = " + sum1);

            IParallelEnumerable<double> parray = array.AsParallel();

            double sum2 = parray.Aggregate
            (
                0.0,
                (total1, current1) => total1 + Math.Sqrt(Math.Abs(Math.Sin(current1))),
                (total2, current2) => total2 + current2,
                acc => acc
            );

            Console.WriteLine("Plinq aggregate = " + sum2);
        }
    }
} 
```

# c++ - 从覆盖函数调用覆盖函数

> ID：857113
> 
> 赞同：26
> 
> 时间：2009-05-13T10:04:34.840
> 
> 标签：c++, inheritance, oop, virtual, overriding

假设我在 B 类中有虚函数 foo()，并且我需要在 B 的派生类 D 类中稍有不同的行为。创建覆盖函数 D::foo() 并调用 B::foo( ) 从那里，经过特殊情况处理？像这样：

```
void D::foo()
{
  if (/*something*/)
     // do something
  else
     B::foo();
} 
```

我不是在问这是否可行，我知道它会。我想知道，就良好的 OOD 而言，它是否正确。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-13T10:09:17.780

这非常好。事实上，执行某些操作的规范方法是调用基类方法，然后执行任何操作（或相反）。我在想`operator=`这里。构造函数通常也以这种方式工作，即使这在初始化列表中有点伪装。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-13T10:08:25.613

是的，只要您不违反 Liskov 替换原则，完全可以。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T10:07:21.373

是的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T10:07:36.940

我已经看到 GUI 框架使用它来回退基类的默认实现，其中包含指示错误/抛出异常/返回通用值的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T10:19:21.820

没关系。您提供的语法也可用于临时关闭多态性，即当您调用 obj->B::foo() 时，将从类 B 中选择方法，无论 foo() 是否为虚拟且 obj 是否为 B 的实例与否（它必须是扩展 B 的类的实例）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T10:10:40.883

是的，这就是你的编译器每次生成构造函数和析构函数时为你做的事情：例如调用母亲的那个。我经常在自己的代码中依赖那个“技巧”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-17T19:53:49.323

调用 base 的实现很好，但是**有条件**地这样做会使您远离构造函数语义，这与其他答案中的建议相反。

您可能会以两种方式遇到[脆弱的基类问题：](http://en.wikipedia.org/wiki/Fragile_base_class "脆弱的基类")

*   通过假设`B::foo()`为整个层次结构提供共同的行为（即，忘记方法并不总是被调用）
*   讨厌的问题取决于`// do something`实际做什么！

为了完整起见，让我们提一下对称设计方法：[模板模式](http://en.wikipedia.org/wiki/Template_pattern)（调用特定子部分的基本实现）

# c# - 如何对 DataGridView 列进行排序？

> ID：857115
> 
> 赞同：1
> 
> 时间：2009-05-13T10:05:14.590
> 
> 标签：c#

我创建了一个 DataTable，如下所示：

```
 accTable = new DataTable();
        accTable.Columns.Add(new DataColumn("Date"));
        accTable.Columns.Add(new DataColumn("Amt"));
        accTable.Columns.Add(new DataColumn("Item")); 
```

并通过以下方式填充：

```
 foreach (DataRow myDataRow in myDataSet.Tables[0].Rows)
            {
                DataRow accRow = accTable.NewRow();
                //code skipped

                accRow["Date"] = date.ToString("d"); //tried without converting to string also
                accRow["Amt"] = int.Parse(cells[1].ToString());
                accRow["Item"] = cells[2].ToString();

                accTable.Rows.Add(accRow);
            } 
```

然后我将 DataGridView 绑定到 DataTable accTable，如下所示：

```
 dataGridView1.DataSource = accTable; 
```

如何使日期列可排序。默认情况下，它按字母顺序排序。在哪里可以将列的类型设置为 DateTime。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T10:35:22.123

该列有一个`DataType`. 您是否尝试将其设置为`DateTime`？

```
var accTable = new DataTable();

var columnSpec = new DataColumn("Date");
columnSpec.DataType = typeof(DateTime);
accTable.Columns.Add(columnSpec); 
```

当然，您可以在一行中执行此操作（*感谢 BFree*）：

```
accTable.Columns.Add("Date",typeof(DateTime)); 
```

您将其绑定`DataTable`到 a`DataGridView`然后为视图上的每一列设置`SortMode`属性：

```
column.SortMode = DataGridViewColumnSortMode.Automatic; 
```

我确实有一些代码可以完成所有这些工作，但是我将其转换为使用可为空的类型（包括 DateTime 字段）并且它不再像我预期的那样工作。如果我能让它再次正常工作，我会更新这个答案。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-08-12T07:08:37.993

对于日期数据，我们可以使用以下代码：

```
dgv_transfer_from.Sort(dgv_transfer_from.Columns["Date_Out"], ListSortDirection.Ascending); 
```

# .net - 使用 WPF 双向数据绑定时更改 setter 属性中的值

> ID：857116
> 
> 赞同：5
> 
> 时间：2009-05-13T10:06:00.080
> 
> 标签：.net, wpf, data-binding

我有一个绑定到实体对象上的文本属性的文本框。我希望能够重新格式化用户在某些情况下输入的文本 - 例如，如果用户输入“2/4”（分数） - 我想将其更改为“1/2”。

通过 Text-property 的“set-part”，我可以更改 Entity-object 上的值，但这不会出现在 TextBox 中——它仍然显示为“2/4”？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-13T10:26:52.463

原因是 WPF 中的绑定系统是“智能的”，当您更改 TextBox 中的值时，它假定 PropertyChanged 事件将为该属性触发并忽略它。

您可以通过调用强制 TextBox 刷新其绑定：

```
textBox.GetBindingExpression(TextBox.TextProperty).UpdateTarget(); 
```

但困难在于找到一个很好的地方来挂钩它。显然你的数据对象不能这样做，因为它没有对 TextBox 实例的引用。您可以通过将 TextBox 链接到数据对象的 PropertyChanged 事件处理程序来在包含 TextBox 的窗口中执行此操作，但这感觉不是很干净。

如果我想到更好的解决方案，我将编辑此响应，但至少这解释了绑定不起作用的*原因。*

* * *

啊哈！将绑定更改为 IsAsync=true：

```
<TextBox x:Name="textBox" Text="{Binding Path=TestData, IsAsync=true}"/> 
```

似乎改变了行为，以便它*在*由 setter 触发时关注 PropertyChanged 事件。

* * *

作为附录（32 个月后），此行为已[在 .NET 4 中更改](http://karlshifflett.wordpress.com/2009/05/27/wpf-4-0-data-binding-change-great-feature/)，您将不再需要 IsAsync。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T10:25:07.647

您是否实现了 INotifyPropertyChanged 并调用它？

```
 private string _fraction;

    public string Fraction
    {
        get { return _fraction; }
        set
        {
            _fraction = ReduceFraction(value);
            NotifyPropertyChanged("Fraction");
        }
    }

    private string ReduceFraction(string value)
    {
        string result = "1/2";
        // Insert reduce fraction logic here
        return result;
    }

    public event PropertyChangedEventHandler PropertyChanged;

    private void NotifyPropertyChanged(String info)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(info));
        }
    } 
```

# netbeans - 用递增的数字替换 Netbeans 编辑器中的数字

> ID：857119
> 
> 赞同：0
> 
> 时间：2009-05-13T10:06:46.693
> 
> 标签：netbeans, replace, sequence

我在 Netbeans 6.1 编辑器中有一些看起来像这样的代码

fooString(8)
fooString(8)
fooString(8)
fooString(8)
foostring2(8)
foostring3(8)
foostring4(8)
foostring5(8)
foostring6(8)
foostring7(8)
foostring7(9)
foostring7(10)
foostring7( 11)
脚串7(12)

我想将其转换为 fooString(1)
fooString(2)
fooString(3)
fooString(4)
foostring2(5)
foostring3(6)
foostring4(7)
foostring5(8)
foostring6(9)
foostring7(10)
foostring7(11 )
foostring7(12)
foostring7(13)
foostring7(14)

有没有办法，例如有规律的表达或其他任何事情来完成这项工作？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T07:27:44.173

您想以编程方式执行此操作吗？如果没有，那么我将执行以下操作

1.  使用正则表达式在数字周围插入一个制表符，因此 (8) 变为 (\t8\t)
2.  将此复制到 Excel 工作表。该选项卡会将数字排列在单独的列中，即 excel 看起来像这样。

    ```
     A            B        C
       foostring(      8        )

       foostring1(     8        )

       foostring2(     8        ) 
    ```

    等等

3.  现在更改 B 列中的值。只需在前 2 行中键入 1 和 2 并向下拖动以填充 rset 行。

4.  复制回 netbeans 编辑器并删除在步骤 1 中插入的选项卡。

# rich-internet-application - 富互联网应用解决方案

> ID：857133
> 
> 赞同：1
> 
> 时间：2009-05-13T10:09:31.680
> 
> 标签：rich-internet-application

我正在评估在下一个项目中使用的富 Internet 应用程序解决方案。我听说过以下解决方案 -

1.  Adobe Flex
2.  extJS
3.  Jboss Richfaces
4.  冰面
5.  甲骨文 ADF
6.  JavaFX
7.  银光
8.  GWT

我想知道是否有更多可用的解决方案。

如果您能就上述解决方案提供任何有价值的反馈，我将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T10:15:02.497

[IT Mill Toolkit](http://itmill.com/)是建立在 GWT 之上的“服务器驱动”框架。

*评论：*来自沉重的 PHP 和 Java 敌对背景，我发现 Toolkit 使用起来非常快。考虑到您在代码中所做的更改会立即反映在您在浏览器中看到的内容上，能够只编写（强类型的、面向 OO 的）Java 是不错的选择。

设置起来有点棘手，但 IT Mill 有一个 Eclipse 插件，据说可以帮助解决这个问题。唯一的问题是插件本身使用起来有点不直观:)

0.02 欧元</p>

*回复评论：* GWT 和 IMT 最大的区别在于 GWT 完全在浏览器内部运行（例如 FireBug 的恶意/可利用环境），而 IMT 仅使用 GWT 来呈现服务器端状态。因此，虽然您可以使用 GWT 和 IMT 在浏览器中编辑您想要的任何值，但 GWT 会很乐意接受用户编辑的变量值，IMT 在服务器端跟踪值，并且不允许客户端之间存在任何差异和服务器。

另一个很大的区别是，每次您使用相对耗时的 GWT 交叉编译器（将 Java 编译为 JavaScript）对 GWT 小部件进行任何更改时，都需要对其进行编译。另一方面，IMT 只需要重新部署到 servlet 容器，更改就在那里，因为 IMT 内部的 GWT 小部件不需要重新编译。使用 Tomcat，它几乎是即时的（即，只要 Tomcat 注意到 Eclipse 已经动态地重新编译了这些类）。

*@the_drow：*不熟悉 Dijit，这是一个答案：Dojo 只是 javascript，这意味着它只是客户端。Vaadin（née IT Mill Toolkit）也部​​分存在于服务器端（称自己为“服务器驱动”），因此您不能仅通过更改 JavaScript 变量值来破解客户端。有[一张图表](http://vaadin.com/comparison)将 Vaadin 与其他同类产品进行了比较。不包含 Dojo，但包含 JQuery，这与 Dojo 有点相似

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T10:21:30.817

我有过使用 Spring Webflow + Rich Faces 的经验，结果好坏参半 - 在屏幕上显示结果的时间真的很短，但是微调演示部分很痛苦。

即，如果您正在构建一些面向技术/后端/标准的 GUI - 没关系，如果您要构建数百万 web2.0 用户使用的前端，那么您最终会在演示部分 css/javascript 上搞砸。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-08T03:16:09.143

在评估和阅读了各种 RIA 解决方案后，我最终选择了 GWT 和 GWT-Ext。我为我和我的团队看到了这些好处——

1.  我们习惯了 Eclipse，所以这是一个优势。
2.  能够在 Eclipse 中使用 Java Debugger 非常有帮助。
3.  Eclipse 中的 GWT 托管模式，因此每次更改都不需要编译和部署。
4.  大型开发者社区
5.  大量现成的组件
6.  以前的 Java 知识很有帮助
7.  与 Swing 类似，该团队在早期的项目中也致力于 Swing。
8.  观感也不错
9.  Maven 支持也可用。
10.  可以编写Junit测试用例。
11.  除了 Java，不需要其他语言知识。
12.  基于注释的简单 RPC 配置。

# c++ - 如何处理来自 MFC 应用程序中动态创建的控件的消息？

> ID：857135
> 
> 赞同：8
> 
> 时间：2009-05-13T10:10:08.637
> 
> 标签：c++, visual-c++, mfc, event-handling

想象一下，我有一个 CDialog，它在用户单击按钮时动态创建控件。它可能是这样的：

```
// We don't know which is the first id for the new buttons until runtime (!)
MyDialog::MyDialog(/*whatever parameters needed*/, first_id)
  : next_id_(first_id) 
{ /*...*/ }

BOOL MyDialog::OnSomeButtonClicked()
{
  CButton* new_button = new CButton;
  new_button->Create("Caption", WS_CHILD | WS_VISIBLE, this->new_button_rect_, 
                     this, this->next_id_++);
} 
```

那么我的问题是：我如何处理来自这个按钮的消息？是否可以使用 MFC 消息映射工具？

该解决方案应该适用于 vs6 和 vs2005。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T18:00:45.437

这些是我到目前为止按相关性顺序找到的解决方案：

1.  `ON_COMMAND_RANGE`如果您可以定义要处理的控件 ID 的范围，请使用此选项。

2.  重载`CWnd::PreTranslateMessage()`并使用收到的消息做任何你想做的事情。注意：处理按钮时，请注意 BN_CLICKED 事件不是发送到 PreTranslateMessage 而是直接发送到窗口过程。

3.  重载`CWnd::WindowProc()`并使用收到的消息做任何你想做的事情。请注意，在处理按钮时，这是我发现处理 BN_CLICKED 事件的唯一方法。

有趣的链接：

*   [请帮助处理 PreTranslateMessage 和用户定义的消息。](http://www.codeguru.com/forum/archive/index.php/t-280028.html)
*   [TN006：消息映射](http://msdn.microsoft.com/en-us/library/0812b0wa(VS.80).aspx)

我希望这会有所帮助……谢谢大家的贡献。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T11:22:56.397

尽管您不知道 id 的确切值，但如果您知道可能的 ID 范围，则可以使用以下宏。

```
BEGIN_MESSAGE_MAP(MyDialog, CDialog)
    ...
    ...
    ON_COMMAND_RANGE(1000, 5000, OnButtonDynamic)
END_MESSAGE_MAP()

void MyDialog::OnButtonDynamic(UINT nID)
{

} 
```

这适用于 1000 - 5000 范围内的 id。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-05T11:53:22.337

我迟到了几年，但解决方案是为每个按钮分配相同的控件 id（无需在 resource.h 中“保留”id，并且对可以控制的控件数量没有人为限制被创建），保存窗口句柄并在该按钮的处理程序中使用 GetCurrentMessage()：

```
// resource.h
#define IDC_DYNAMIC_BUTTON 123

// In message map
ON_BN_CLICKED(IDC_DYNAMIC_BUTTON, OnDynamicButtonClicked)

// Store the window handles when creating them in a member:
std::map<HWND, SomeStruct> m_Buttons;
... fill this map when creating the buttons, presumably in OnInitDialog()

// Actual handler
void MyDialog::OnDynamicButtonClicked()
{
    const MSG* message = GetCurrentMessage();

    if (m_Buttons.find((HWND)message->lParam) != m_Buttons.end()) {
        // Do something with m_Buttons[(HWND)message->lParam]
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T10:27:47.097

我相信这篇文章解释得很好，并且有源代码。我没有尝试过，所以我不能保证它有效，但在我认为它可能会有所帮助的时候。

[文章](http://www.codeproject.com/KB/tabs/CMyTabCtrl.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T14:50:14.437

[您可以在此处](http://www.flounder.com/kb103788.htm)找到有关无模式对话框的详细信息（+ 更多信息）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-24T09:22:13.190

在 Resouce.h 中插入处理程序 ID 的条目然后在处理程序的消息映射中插入条目，如 ON_BN_CLICKED(IDC_BTNCREATE, OnBnClickedrunCreated) 或者您可以直接使用整数 ID，如 ON_BN_CLICKED(1200, OnBnClickedrunCreated)。如果您使用第二版，则无需在 resource.h 中插入条目。在 .h 和 .cpp 文件中给出处理程序的定义和声明。你会得到你的答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-21T01:37:18.170

使用这种方式：ON_CONTROL_RANGE(wNotifyCode, id1, id2, memberFxn)。例如：

```
ON_CONTROL_RANGE(EN_UPDATE, IDC_EDIT_START, IDC_EDIT_END, OnEnUpdateEditParams) 
```

# linux - Linux 上 Shoes 的软件包选项

> ID：857137
> 
> 赞同：0
> 
> 时间：2009-05-13T10:10:47.967
> 
> 标签：linux, shoes

`--package`在 Linux 上似乎缺少 Shoes 的选项。`./shoes.run --package`

任何想法它在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T17:57:50.280

尝试“shoes2.run -- --package”

这对我有用，但只能从 shoooes.net 下载 - 而不是来自 ubuntu repos 的版本：S

# asp.net - 使用 Windows 身份验证检索客户端用户名

> ID：857140
> 
> 赞同：0
> 
> 时间：2009-05-13T10:13:01.520
> 
> 标签：asp.net, asp.net-membership

我试图在 ASP.NET 中检索登录到我们 Intranet 上的计算机的人的用户名和客户端计算机名。这仅用于记录目的。我检索了用户名“System.Security.Principal.WindowsIdentity.GetCurrent().Name”，问题是访问此站点的所有人都显示相同的用户名（即我部署应用程序的服务器名称）。请帮忙。我在 web.config 中使用 Windows 身份验证模式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T10:15:18.583

您正在使用的代码将获得`WindowsIdentity`与当前线程（这是 ASP.NET 正在运行的标识）相关联。除非您基于不起作用的客户端用户身份进行模拟。你需要使用这个：

```
HttpContext.Current.User.Identity.Name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T10:54:51.887

用户的名称可以由[@Mehrdad](https://stackoverflow.com/questions/857140/retreving-client-username-by-uing-windows-authentication/857149#857149)描述。对于用户机器的名称，您可以像这样使用**HttpRequest**对象：

```
if(Request.IsAuthenticated)
    string userName = Request.LogonUserIdentity.Name;
string machineAddress = Request.UserHostAddress;
string machineName = Request.UserHostName; 
```

（编辑）

在 web.config 文件中，我使用了这一行：

```
<system.web>
    <authentication mode="Windows"/>
</system.web> 
```

在 default.aspx.cs 我使用这个：

```
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        StringBuilder sb = new StringBuilder();

        if (Request.IsAuthenticated)
        {
            sb.AppendFormat("User Name: {0}<br/>", Request.LogonUserIdentity.Name);
        }
        else
        {
            sb.Append("Request not authenticated");
        }

        sb.AppendFormat("Machine Address: {0}<br/>", Request.UserHostAddress);
        sb.AppendFormat("Machine Name:    {0}<br/>", Request.UserHostName);

        lblTest.Text = sb.ToString();
    }
} 
```

这产生以下输出：

**用户名：HPAS\amantur**

**机器地址：127.0.0.1**

**机器名称：127.0.0.1**

# c# - 控制器和操作上的 MVC 属性

> ID：857142
> 
> 赞同：7
> 
> 时间：2009-05-13T10:14:16.837
> 
> 标签：c#, asp.net-mvc

有没有办法在控制器级别而不是特定操作上添加属性。例如，假设我的控制器中有 10 个动作，其中只有 1 个动作不需要我创建的特定属性。

```
[我的属性]
公共类 MyController : 控制器
{
    公共 ActionResult Action1() {}
    公共 ActionResult Action2() {}

    [删除_我的属性]
    公共 ActionResult Action3() {}
}

```

我可能会将此动作移动到另一个控制器中（但不喜欢那样），或者我可以将 MyAttribute 应用于除 Action3 之外的所有动作，但只是想是否有更简单的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T01:13:12.197

我知道我对游戏的回答有点晚了（将近四年），但我遇到了这个问题并想分享一个我设计的解决方案，让我可以做几乎原始问题想要做的事情，以防万一它有帮助未来的任何其他人。

该解决方案涉及一个名为 的小宝石`AttributeUsage`，它允许我们在控制器（甚至任何基本控制器！）上指定一个属性，然后根据需要覆盖（忽略/删除）单个操作或子控制器。它们将“级联”到只有最细化的属性实际触发的位置：即，它们从最不具体（基本控制器）到更具体（派生控制器），再到最具体（动作方法）。

就是这样：

```
[AttributeUsage(AttributeTargets.Class|AttributeTargets.Method, Inherited=true, AllowMultiple=false)]
public class MyCustomFilterAttribute : ActionFilterAttribute
{

    private MyCustomFilterMode _Mode = MyCustomFilterMode.Respect;        // this is the default, so don't always have to specify

    public MyCustomFilterAttribute()
    {
    }
    public MyCustomFilterAttribute(MyCustomFilterMode mode)
    {
        _Mode = mode;
    }

    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        if (_Mode == MyCustomFilterMode.Ignore)
        {
            return;
        }

        // Otherwise, respect the attribute and work your magic here!
        //
        //
        //
    }

}

public enum MyCustomFilterMode
{
    Ignore = 0,
    Respect = 1
} 
```

（听说你喜欢属性，所以我在属性上放了一些属性！这就是让魔术在最顶层起作用的真正原因：允许它们继承/级联，但只允许其中一个执行。）

以下是它现在的使用方式：

```
[MyCustomFilter]
public class MyBaseController : Controller
{
    // I am the application's base controller with the filter,
    // so any derived controllers will ALSO get the filter (unless they override/Ignore)
}

public class HomeController : MyBaseController
{
    // Since I derive from MyBaseController,
    // all of my action methods will also get the filter,
    // unless they specify otherwise!

    public ActionResult FilteredAction1...
    public ActionResult FilteredAction2...

    [MyCustomFilter(Ignore)]
    public ActionResult MyIgnoredAction...    // I am ignoring the filter!

}

[MyCustomFilter(Ignore)]
public class SomeSpecialCaseController : MyBaseController
{
    // Even though I also derive from MyBaseController, I can choose
    // to "opt out" and indicate for everything to be ignored

    public ActionResult IgnoredAction1...
    public ActionResult IgnoredAction2...

    // Whoops! I guess I do need the filter on just one little method here:
    [MyCustomFilter]
    public ActionResult FilteredAction1...

} 
```

我希望它可以编译，我从一些类似的代码中提取它并对其进行了一些搜索和替换，因此它可能并不完美。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T14:56:04.443

您必须覆盖/扩展默认属性并添加自定义构造函数以允许排除。或者您可以为排除创建自定义属性（在您的示例中是 [Remove_MyAttribute]）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T16:53:05.623

Johannes 给出了正确的解决方案，这就是我的编码方式......希望它可以帮助其他人。

```
[MyFilter("MyAction")]
公共类 HomeController : 控制器
{
    公共 ActionResult Action1...
    公共 ActionResult Action2...
    公共 ActionResult MyAction...
}

公共类 CompressFilter : ActionFilterAttribute
{
    私人 IList _ExcludeActions = null;

    公共压缩过滤器（）
    {
        _ExcludeActions = 新列表（）；
    }

    公共 CompressFilter（字符串 excludeActions）
    {
        _ExcludeActions = new List(excludeActions.Split(','));
    }

    公共覆盖无效 OnActionExecuting(ActionExecutingContext filterContext)
    {
        HttpRequestBase 请求 = filterContext.HttpContext.Request;

        字符串 currentActionName = (string)filterContext.RouteData.Values["action"];

        if (_ExcludeActions.Contains(currentActionName))
            返回;

        ...
    }

```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T13:28:50.080

您尝试做的通常模式是拥有和属性，并带有一个布尔参数，该参数指示该属性是否被应用。

前任：

```
[ComVisible] which is equivalent with [ComVisible(true)]

or 

[ComVisible(false)] 
```

如果您的情况，您将拥有：

```
[MyAttribute] // defaults to true

and

[MyAttribute(false)] for applying the attribute on excluded members 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T10:34:07.037

您可以通过将特定操作传递给主要属性来排除特定操作：

```
 [MyAttribute(Exclude="Action3")] 
```

**编辑**

我的例子是从头开始的（你可以看到下面是VB.NET，也许这就是它出错的地方），这就是我实现的方式：

```
<Models.MyAttribute(Exclude:="Action3")> _
Public Class MyController
Inherits System.Web.Mvc.Controller

End Class 
```

# sql-server - T-SQL 查询汇总 SQL Server 2000 数据库中的数字字段

> ID：857144
> 
> 赞同：0
> 
> 时间：2009-05-13T10:14:28.007
> 
> 标签：sql-server, tsql

我有一个 SQL Server 2000 数据库，我想检索数据库用户表中包含的所有数字字段的摘要信息。

我可以使用以下查询检索名称、数据类型和大小：

```
SELECT  t.name AS [TABLE Name],
c.name AS [COLUMN Name],
p.name AS [DATA Type],
p.length AS [SIZE]
FROM dbo.sysobjects AS t
JOIN dbo.syscolumns AS c
ON t.id=c.id
JOIN dbo.systypes AS p
ON c.xtype=p.xtype
WHERE t.xtype='U'
and p.prec is not null 
```

我怎样才能更进一步，并列出每个字段中包含的平均值？

这可以通过子查询来完成，还是我必须将此查询的结果放在游标中并循环遍历每列的第二个选择查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T13:45:17.070

我最好和快速的猜测是使用光标：

```
DECLARE @Table varchar(80)
DECLARE @Column varchar(80)
DECLARE @Sql varchar(300)

DECLARE fields CURSOR FORWARD_ONLY
FOR SELECT t.name AS [Table], c.name AS [COLUMN]
FROM dbo.sysobjects AS t
JOIN dbo.syscolumns AS c ON t.id=c.id
JOIN dbo.systypes AS p ON c.xtype=p.xtype
WHERE t.xtype='U'
  and p.name = 'int'
  and p.prec is not null

OPEN fields

FETCH NEXT FROM fields 
INTO @Table, @Column

WHILE @@FETCH_STATUS = 0
BEGIN
    SET @sql = 'SELECT ''' + @Table + '.' + @Column + ''', Avg(' + @Column+ ') FROM ' + @Table
    EXEC(@Sql)

    FETCH NEXT FROM fields 
    INTO @Table, @Column

END
CLOSE fields
DEALLOCATE fields 
```

临时表也应该可以正常工作。您还可以添加 Min() 和 Max() 值。希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T10:35:28.347

在我看来，您需要一个分析工具。您可以使用 Visual Studio 2008 Database Edition，或开源替代品，例如[DataCleaner](http://sourceforge.net/projects/datacleaner/)。

# sharepoint - 什么可能导致 SharePoint 无法下载 WSDL？

> ID：857146
> 
> 赞同：0
> 
> 时间：2009-05-13T10:14:56.587
> 
> 标签：sharepoint, sharepoint-2007, download, bdc

我使用随 SharePoint 2007 SDK 提供的编辑器创建了一个 BDC 条目。在我的本地安装上没有问题。当系统管理员尝试将其导入临时场时，他收到以下错误消息：

> 应用程序定义导入失败。发生以下错误：下载“ [http://path/to/someservice?WSDL=1](http://path/to/someservice?WSDL=1) ”时出错。在行：0 和位置：0 或之前遇到错误

组织内的任何人都可以访问该路径。WSDL 已被验证为有效。我还尝试将 WSDL 放在物理文件中并在 BDC 条目中指向该文件，但仍然没有运气。

附加问题：SharePoint 是否需要执行权限来处理 BDC 条目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-01-04T19:34:09.367

Web 服务托管在 Sharepoint 服务器中？

还要记住，要导入 BDC 定义，登录的用户需要在您上传文件的 SSP 内的**业务数据目录权限部分中进行编辑。**

问候。

# c# - 如何在不更改 C#.Net 中的分辨率的情况下裁剪图像？

> ID：857147
> 
> 赞同：3
> 
> 时间：2009-05-13T10:14:58.987
> 
> 标签：c#, .net, image, resolution, crop

我做了一个小程序来分割大图，并把它们的一部分。当我导入由“Microsoft Paint”制作的图像时，这个图像是“96 dpi”，所以我的程序运行良好。

但是我有由 Photoshop 制作的图片，当我裁剪这些图片时，其分辨率为 71.6 dpi，新裁剪的图片采用 96 dpi 分辨率，因此它们之间的大小有所不同。

## **我想裁剪图片并保持其分辨率。**

.

非常感谢您

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T15:24:43.990

`Bitmap.clone`允许您创建图像的裁剪副本，然后可以保存。它不应该改变分辨率或任何东西（如果您在图像较小时放大更多的程序中打开图像，图像会看起来更大）。它不能用于扩展画布（您会出现内存不足错误）。因此，只需`Image`从文件中获取一个，转换为`Bitmap`, （`system.drawing`命名空间）并将其克隆为更小，然后保存。

例子：

```
using System.Drawing;
//...
Bitmap x = (Bitmap) Image.FromFile(@"c:\tmp\food.png");
Image x2 = x.Clone(new Rectangle(25, 25, 50, 50), x.PixelFormat);
x2.Save(@"c:\tmp\food2.png"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T10:22:30.567

DPI（每英寸点数）只是像素大小和介质大小之间的关系。如果您的图像为 1024 x 768 像素，则为 1024 x 768。位图/二进制文件没有固有的 DPI。

例如，如果您想在以 300 dpi 打印的打印机上打印该图像，那么您可以计算纸张上的尺寸。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T15:22:11.000

Bitmap 类的 SetResolution() 方法允许您指定图像的分辨率。

请参阅[http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.setresolution.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.setresolution.aspx)

# jquery - jQuery 表单插件 - 如何更改“目标”（用于响应）值

> ID：857152
> 
> 赞同：4
> 
> 时间：2009-05-13T10:15:58.253
> 
> 标签：jquery, jquery-plugins, jquery-forms-plugin

这是参考 jQuery 1.3 和 jQuery Form Plug 2.25。

希望这对业余爱好者来说也是小菜一碟，但我一无所知。

```
var x;
$('div#response').fadeOut(300,function()
{
   // do something
   x = this;
}
$('#myForm').ajaxForm({ 
    target: x,
    success: function() 
      { 
        // do something
      }
}); 
```

我想做的是将目标值定义为我预先定义的变量；我们会说它是“x”。这在上面的示例中显示，但“目标：x”行当然会失败。我怎样才能做到这一点？

另外：我知道在这个例子中 x = div#response，但在我正在处理的现实世界问题中，我没有一个可靠的 x 定义。我知道在这个例子中我可以将“target：x”更改为“target：div#response”，它会起作用，但这个例子只是为了论证。我需要目标等于 x。我怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T11:35:07.640

假设 x 是一个 jquery 包装集，这样的东西应该可以工作：

```
$('#myForm').ajaxForm({
  success: function(responseText, statusText) {
    x.html(responseText);
  }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T10:32:26.993

假设您的 ajax 调用返回纯文本，这应该可以工作：（如果需要，您可以删除目标选项，变量`x`将被设置为任一方式。）

```
$('#myForm').ajaxForm({
  target: $('#someDiv'),
  success: function(response) {
    x = response;
  }
}); 
```

# php - Cookie 未在 PHP 脚本中正确设置

> ID：857153
> 
> 赞同：5
> 
> 时间：2009-05-13T10:16:03.447
> 
> 标签：php, cookies, output-buffering

我在 php 中很新，并尝试使用 cookie，但它在我的网站中没有工作，任何人都可以指导我，我的代码出了什么问题：

```
<?php
session_start();
?>
<script>
function Redirect(url)
{
 location.href = url;
}

</script>
<?php 

define('_VALID_ACCESS', true);
include_once "includes/connect.php";
include_once "includes/login.php";

if(empty($_POST['loginname']) || empty($_POST['password']))
{
    $msg = "User or password is empty";
}
else
{
    if(login($_POST['loginname'], $_POST['password']) == true)
    {
        $usern = $_POST['loginname'];
        session_register('loginname');
        $loginname = $usern;        
        sleep(1);
            if(activestatus($_POST['loginname'], $_POST['password']) == true)
            {
            $usern = $_POST['loginname'];
            session_register('loginname');
            $loginname = $usern;        
            sleep(1);

            $hour = time() + 3600;
            setcookie("ID_my_site", $_POST['loginname'], $hour);
            setcookie("Key_my_site", $_POST['password'], $hour); 
            $test = $_COOKIE["ID_my_site"];
            $msg = "<script> Redirect ('home.html?testname=".$test."')</script>"; 
             //header("Location: home.html"); 
            }
            else
            {
            $msg = "<script> Redirect ('valid.php?testname=".$usern."')</script>"; 
            }

    }
    else
    {
        $msg = "<font color=red>User or Password is wrong</font>";
    }
}
echo '<div id="divTarget">' . $msg . '</div>'; 
?>
  <link rel="stylesheet" href="css/blueprint/screen.css" type="text/css" media="screen, projection">
  <link rel="stylesheet" href="css/blueprint/print.css" type="text/css" media="print">
  <link rel="stylesheet" href="css/blueprint/ie.css" type="text/css" media="screen, projection">  
 <body>
 <div class="container" id="login_container">
<form id="login" action="action.php" method="post" name="loginform" >
    <fieldset id="login_screen"  style="width:350px">
        <label id="login_label" for="login">User Login </label> 
        <br><br>
        <label for="login">Email Address</label>
        <input type="text" name="loginname" id="loginname" value="email@coolmates.com">    
        <p id="space"><label for="password">Password</label>
        <input type="password" id="password" name="password"  value="********" ></p>
        <input type="checkbox">Keep me signed in until i signout
        <p id="test"><input type="submit" value="Submit"></p>
        <a href="forgetpassword.html">Forgot
        your password</a>&nbsp;&nbsp;|<span id="free">Not a member?</span><a href="regForm.html">Sign up</a><blink><span id="free">Free</span></blink> 
        </p>
    </fieldset>
</form> </div>
</body> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-19T02:15:24.840

打开 display_errors 并将您的 error_reporting 设置为 E_ALL，您应该会看到有关“已发送标头”的错误消息 - 您必须在发送任何 HTML 之前调用 setcookie()。来自 php.net/setcookie：

> setcookie() 定义了一个 cookie 与其余的 HTTP 标头一起发送。与其他标头一样，必须在脚本的任何输出之前发送 cookie（这是协议限制）。这要求您在任何输出之前调用此函数，包括和标记以及任何空格。

在您发布此位的代码块中：

```
<script>
function Redirect(url)
{
 location.href = url;
}

</script> 
```

在您尝试设置 cookie 之前就直接输出到浏览器。

您的两种可能性是使用输出缓冲，以便在最后输出所有内容，或者切换到一种方法，其中所有处理代码首先在一个脚本中执行，然后设置 $_SESSION 和 cookie 值，然后包含第二个第一个脚本的末尾包含要输出到浏览器的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T01:31:37.610

试试这个（指定您网站的根目录）：

```
setcookie("ID_my_site", $_POST['loginname'], $hour,'/'); 
```

或试试这个（在您的登录名中添加引号）：

```
setcookie("ID_my_site", "$_POST['loginname']", $hour,'/'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T10:19:19.323

第一个你不需要 session_register，你可以这样做。

由于 session_register 是自 4.1.0 以来的首选方法，自 PHP 5.3 起已弃用

```
$_SESSION["loginname"] = $_POST["loginname"] 
```

第二，如果您要使用会话，您的流程可能会更好，因为这不起作用。

```
$_SESSION["foo"] = 1;
header("Location: stuff.php"); 
```

然后就无法在 stuff.php 中查看会话数据。您可以将用户发送到主页，并在那里进行身份验证，如果通过，则您只需继续加载主页，如果没有，则将用户发送回登录像这样的页面。

```
if($_SESSION["authenticated"] == 0)
{
    header("Location: login.php");
    die();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T23:11:57.813

此外，您不应该将密码存储为 cookie 数据——这是一个很大的安全性不可以！！！

如果您想做类似的事情，请设置一个唯一的 - 随机 - 标识符，当他们登录并使用它时会更改（您仍然应该使用 MD5）

# java - java中的freedesktop.org通知

> ID：857154
> 
> 赞同：5
> 
> 时间：2009-05-13T10:16:35.867
> 
> 标签：java, notifications, dbus

有一个使用 DBUS 的 freedesktop.org 通知系统。看起来很简单，但我就是不知道如何在 Java 中使用它。

有人可以指出一些示例代码来显示一条简单的消息吗？

谢谢！:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-11-17T21:02:01.637

[Java-gnome 项目](http://java-gnome.sourceforge.net/)中有一些代码可能对您有用。签出[org.gnome.notify](http://java-gnome.sourceforge.net/4.0/doc/api/index.html?overview-summary.html)包。Java-gnome 4.0.12 包含对可能是您正在寻找的 libnotify-api 的一些支持。

Java-gnome 通知在我的列表中，但我还没有机会使用它。

如果 java-gnome 库不适合您，使用[dbus-java 中](http://dbus.freedesktop.org/doc/dbus-java/dbus-java/dbus-javase14.html#x41-4400014)[的规范](http://www.galago-project.org/specs/notification/0.9/index.html)和示例可以实现通知。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-13T10:21:21.457

[文档](http://dbus.freedesktop.org/doc/dbus-java/dbus-java/)呢？:-)

# java - 我可以将 maven ant 任务与自定义 maven 存储库一起使用吗？

> ID：857155
> 
> 赞同：0
> 
> 时间：2009-05-13T10:16:36.817
> 
> 标签：java, maven-2, ant, build

我需要指定某个目录，maven ant 任务应该将其用作存储库。 **maven.repo.local**似乎不适用于此。还有其他想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T19:33:56.407

您应该查看 Maven 存储库标签。您可以指定一个存储库，但其范围可能超出您的预期。

[Maven 仓库](http://maven.apache.org/guides/introduction/introduction-to-repositories.html)

# iphone - 为什么设置图层边界矩形的anchorPoint会表现得如此奇怪？

> ID：857158
> 
> 赞同：3
> 
> 时间：2009-05-13T10:16:49.907
> 
> 标签：iphone, cocoa-touch, uikit

我尝试设置 anchorPoint 属性，以便通过定义明确的轴旋转视图。但：

```
myView.layer.anchorPoint = CGPointMake(myView.layer.anchorPoint.x - 1.0, myView.layer.anchorPoint.y); 
```

Wenn 我将它移动 -1.0，它不会只向左移动 1 个单位。相反，我的整个视图向右移动视图的宽度。

那是什么样的坐标系？好像倒过来了。但单位也与例如 myView.frame.size.width 的单位不匹配？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-13T12:35:56.060

anchorPoint 是图层中的标准化位置。也就是说，(0.0, 0.0) 是图层的左上角（在 iPhone 翻转的 UIView 图层坐标系中），而 (1.0, 1.0) 是右下角。(0.5, 0.5) 是图层的中间。这些位置与大小无关，因此只是相对位置。

这使得可以围绕该锚点进行缩放，如果锚点是绝对坐标，这将是令人困惑的。

# .net - asp.net：如何在不使用键的情况下访问字典的每个元素？

> ID：857162
> 
> 赞同：3
> 
> 时间：2009-05-13T10:18:42.913
> 
> 标签：.net, dictionary, indexing

我想使用 int 索引访问我的字典 Dictionary 的每个对象。如何做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T10:20:39.027

```
Dictionary<KeyType, ValueType> myDictionary = . . .

foreach(KeyValuePair<KeyType, ValueType> item in myDictionary)
{
   Console.WriteLine("Key={0}: Value={1}", item.Key, item.Value);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T10:22:57.133

您可以使用 foreach 循环，如下所示：

```
Dictionary<string, string> dict = new Dictionary<string, string>();
dict.Add("key1", "value2");
dict.Add("key2", "value");
foreach (KeyValuePair<string, string> item in dict)
   Console.WriteLine(item.Key + "=" + item.Value); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T10:29:43.457

或者，如果您使用 Visual Studio 2008 工作，您可能会：

```
foreach(var item in myDictionary)
{
   . . . 
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T10:51:32.393

我最喜欢的方法是这个（尽管我猜到目前为止给出的任何解决方案都会为你解决问题）：

```
// set up the dictionary
Dictionary<string, string> dictionary = new Dictionary<string, string>();
dictionary.Add("A key", "Some value");
dictionary.Add("Another key", "Some other value");

// loop over it
Dictionary<string, string>.Enumerator enumerator = dictionary.GetEnumerator();
while (enumerator.MoveNext())
{
    Console.WriteLine(enumerator.Current.Key + "=" + enumerator.Current.Value);
} 
```

# javascript - 如何更改图像上的颜色？

> ID：857181
> 
> 赞同：0
> 
> 时间：2009-05-13T10:24:49.767
> 
> 标签：javascript

如果我单击图像，它应该更改图像部分的颜色。然后我想替换图像。可以使用 javasript 完成吗？请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T10:27:02.807

JavaScript 不能更改 .jpg、.png 或 .gif 等物理图像（据我所知），但替换图像很容易。

```
document.getElementById("foo").src = "example.jpg"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T05:10:10.043

至于颜色变化，是的，它可以做到，你可以用你的图像用 SVG 和 Canvas 元素和 JavaScript 做一些东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T10:29:05.657

如果您的意思是更改单击像素的颜色，不是，仅 JavaScript 是不可能的。但是您可以获取坐标并将它们传递给 PHP 脚本。在 PHP 中，您可以更改图像。

[http://de2.php.net/manual/en/book.image.php](http://de2.php.net/manual/en/book.image.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T10:39:20.383

除非我误解了，否则我认为您可以在要更改的图像上方放置透明图像，从而改变图像的外观。[我想我曾经用原型](http://www.prototypejs.org/)做过这样的事情。

# .net - 同步不同版本的对象

> ID：857191
> 
> 赞同：1
> 
> 时间：2009-05-13T10:27:46.270
> 
> 标签：.net, synchronization

我有一个基于数据模型的 Windows 窗体应用程序和一个包含类似数据模型的 Windows Mobile 应用程序。当用户在移动应用程序中输入信息时，我会将其与主应用程序中的数据同步。这是通过在主应用程序中使用移动应用程序中使用的类定义，然后对两个不同模型之间的同步进行编码来实现的。

我现在正处于移动应用程序已得到增强并创建了一个新版本的地步，因此当主应用程序中发生同步时，它可能是从具有不同数据模型的移动 v1 或 v2 同步的。

实现同步的最佳方法是什么。例如，主应用程序和移动应用程序的 v2 包含需要同步的订单的订单日期。如果从不包含此属性的移动应用程序的 v1 同步，则应忽略它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T10:52:44.870

我会将模型对象子类化为版本 2：

```
public class DataObject
{
     public string CustomerName { get; set; }
}

public class DataObjectVersion2 : DataObject
{
    public DataTimeOrderDate { get; set; }
} 
```

然后在 WinForms 应用程序中，您只需检查类型以确定有多少数据可用：

```
public void SyncDataFromMobile(DataObject data)
{
    this.WinformsData = new WinFormsDataObject();

    this.WinFormsData.CustomerName = data.CustomerName;

    DataObjectVersion2 data2 = data as DataObjectVersion2;

    if (data2 != null)
    {
        SyncDataFromMobileVersion2(data2);
    }
}

private void SyncDataFromMobileVersion2(DataObjectVersion2 data)
{
    this.WinFormsData.OrderDate = data.OrderDate;
} 
```

# sql-server-2005 - 在 SQL Server 2005 中使用 IF THEN 和 GOTO

> ID：857193
> 
> 赞同：0
> 
> 时间：2009-05-13T10:27:47.360
> 
> 标签：sql-server-2005

下面是一个存储过程，其中 iam 传递 DriverID=0，DrivarCode =DD1 和 DriverName =Ram。虽然执行控制将失败。控制即将到达 IF ((@DriverName!=NULL) 和 ((@DriverCode!=NULL))，之后将失败。DriverName 和 DriverCode 包含值。但仍然会失败。这可能是什么原因

```
Create Procedure InsertUpdateM
(
    @DriverID int,
    @DriverCode varchar(50),
    @DriverName varchar(50),
    @Msg varchar(50) output
)

AS
BEGIN
IF @DriverID=0
    BEGIN
        SELECT DriverName,DriverCode FROM DriverM WHERE DriverName=@DriverName and DriverCode=@DriverCode
        IF(@@RowCount>0) GOTO Fails
            IF ((@DriverName!=NULL) and ((@DriverCode!=NULL))
                BEGIN
                    INSERT INTO DriverM(DriverCode,DriverName) values(@DriverCode,@DriverName)
                END
    END
ELSE
    BEGIN
        SELECT DriverName,DriverCode FROM DriverM WHERE DriverName=@DriverName and DriverCode=@DriverCode
        IF(@@RowCount>0) GOTO Fails
            IF ((@DriverName!=NULL) and ((@DriverCode!=NULL)
                BEGIN
                    UPDATE DriverM SET DriverCode=@DriverCode,DriverName=@DriverName WHERE DriverID=@DriverID
                END
    END
END

Fails
    SET @Msg='Failed' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T10:39:13.347

我什至不确定这段代码是如何解析的。存储过程结束后出现“失败”，并且它不以冒号结尾。你想要更像这样的东西：

```
ELSE
    BEGIN -- Begin 1
        SELECT DriverName,DriverCode FROM DriverM WHERE DriverName=@DriverName and DriverCode=@DriverCode
        IF(@@RowCount>0) GOTO Fails
            IF ((@DriverName!=NULL) and ((@DriverCode!=NULL)
                BEGIN -- Begin 2
                    UPDATE DriverM SET DriverCode=@DriverCode,DriverName=@DriverName WHERE DriverID=@DriverID
                END  -- End of 2
    END -- End of 1

GOTO Succeeds
Fails:
    SET @Msg='Failed'
Succeeds:
END -- End of SP 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-18T06:50:10.257

您可以使用以下代码来实现它。

```
Driverid:
    IF EXISTS(your query to check)
    BEGIN
        GOTO Driverid
    END 
```

# php - PHP PDO 连接到具有集成安全性的 SQL Server？

> ID：857194
> 
> 赞同：6
> 
> 时间：2009-05-13T10:27:54.660
> 
> 标签：php, sql-server, pdo

我可以使用 PDO 连接到 SQL Server 2008 并使用 mssql 驱动程序集成安全性吗？目前正在做这样的事情来正常连接：

```
$db = new PDO("mssql:host=host;dbname=db", "user", "pass"); 
```

使用 SQL Server 身份验证可以正常工作，但是必须为大量数据库创建 SQL Server 登录名很痛苦，因此如果可能的话，最好使用集成安全性。我在 Windows 上将 PHP 作为 CLI 运行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-07-22T20:25:01.077

该站点提供了帮助： [PHP 的 SQL Server 驱动程序：了解 Windows 身份验证](http://blogs.msdn.com/b/brian_swan/archive/2010/02/10/sql-server-driver-for-php-understanding-windows-authentication.aspx)

解决我的问题的要点是：

*   启用 Windows 身份验证
*   禁用匿名身份验证
*   从 PDO 连接中删除用户名和密码

```
$conn = new PDO( "sqlsrv:server=$serverName ; Database=$dbName" ); 
```

我的测试是使用 2010 年 6 月发布的最新驱动程序（SQL Server Driver for PHP 2.0 CTP2）。

# c# - HtmlAgilityPack 选择的子节点不符合预期

> ID：857198
> 
> 赞同：40
> 
> 时间：2009-05-13T10:29:06.453
> 
> 标签：c#, .net, asp.net, xpath, html-agility-pack

我正在尝试使用 HtmlAgilityPack 库来解析页面中的一些链接，但我没有看到这些方法所期望的结果。在下面，我有一个 HtmlNodeCollection 链接。对于每个链接，我想检查是否有图像节点，然后解析它的属性，但是 linkNode 的 SelectNodes 和 SelectSingleNode 方法似乎是在搜索父文档而不是 linkNode 的 childNodes 给出了什么？

```
HtmlDocument htmldoc = new HtmlDocument();
htmldoc.LoadHtml(content);
HtmlNodeCollection linkNodes = htmldoc.DocumentNode.SelectNodes("//a[@href]");

foreach(HtmlNode linkNode in linkNodes)
{
    string linkTitle = linkNode.GetAttributeValue("title", string.Empty);
    if (linkTitle == string.Empty)
    {
        HtmlNode imageNode = linkNode.SelectSingleNode("/img[@alt]");     
    }
} 
```

如果存在，还有其他方法可以获得linkNode的图像子节点的alt属性吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-13T10:46:27.703

您应该从“/img[@alt]”中删除正斜杠前缀，因为它表示您希望从文档的根目录开始。

```
HtmlNode imageNode = linkNode.SelectSingleNode("img[@alt]"); 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2010-11-18T04:30:51.880

通过 xpath 查询，您还可以使用“。” 指示搜索应从当前节点开始。

```
HtmlNode imageNode = linkNode.SelectSingleNode(".//img[@alt]"); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-13T12:33:00.293

另外，请注意空检查。SelectNodes 返回 null 而不是空白集合。

```
HtmlNodeCollection linkNodes = htmldoc.DocumentNode.SelectNodes("//a[@href]");

**if(linkNodes!=null)**
{
   foreach(HtmlNode linkNode in linkNodes)
  {
     string linkTitle = linkNode.GetAttributeValue("title", string.Empty);
     if (linkTitle == string.Empty)
     {
       **HtmlNode imageNode = linkNode.SelectSingleNode("img[@alt]");**   
     }
  }
} 
```

# vb.net - VB.NET 中覆盖方法的问题（错误 BC30284）

> ID：857202
> 
> 赞同：2
> 
> 时间：2009-05-13T10:30:40.337
> 
> 标签：vb.net, inheritance, com

我的基类中有一个可覆盖的子

```
Project1:
Public Class BaseClass
    Protected Overridable Sub MySub(ByVal Parameter as MyType)
End Class

Project2:
Public Class DerivedClass
    Inherits BaseClass
    Protected Overrides Sub MySub(ByVal Parameter as MyType)
End Class 
```

MyType 是来自外部 COM 库的类型。当我试图在派生类中覆盖它时，我得到

`error BC30284: sub 'MySub' cannot be declared 'Overrides' because it does not override a function in a base class`

我已将所需的 COM 引用添加到包含基类和派生类的项目中。知道如何摆脱这个错误吗？我正在使用 VS2005 和 .NET 2.0

编辑：所有其他覆盖都工作正常，如果我使用引用的 COM 类型作为参数，我只会收到错误。如果我将参数更改为对象，则覆盖效果很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T11:32:27.067

您是否考虑或尝试过使用[TlbImp.exe](http://msdn.microsoft.com/en-us/library/tt0cf3sx(VS.80).aspx)从 COM 类型库生成静态 DLL，并从两个项目中引用它（而不是使用 COM 引用）以确保它们引用完全相同的东西？TlbImp 包含在 Visual Studio 中，但我在只安装了 Visual Studio Express 的系统上找不到它，所以如果你使用 express，你可能需要去寻找它（链接的页面可能有也可能没有你想要的版本）。我怀疑如果每个项目都有自己的 COM 引用，Visual Studio 可能会为每个项目创建一个单独的 COM 包装器，并且生成的 COM 包装器在生成的 GUID 等方面可能并不完全一致。因此，通过创建并强制使用单个包装器，您可以将其作为可能的问题消除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T11:26:13.390

与使用 TlbImp 不同，另一种选择是拥有一个单独的项目，您可以在其中将 MyType 封装在一个 .NET 类中，并将该项目包含在您的两个示例中。

因此，您最终会得到一个中间 MyDotNetType，它将作为构造函数参数 Mytype（COM 对象）并将其作为只读属性公开。然后 MySub 调用将 MyDotNetType 作为参数。

亲切的问候

诺埃尔

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-28T11:27:23.227

如果您有不同的参数或数据类型或任何参数不匹配，请检查基类和派生类中函数的签名。然后你会得到这种类型的错误。简单请检查函数名、参数名和数据类型。它对我有用。我希望这个答案会有所帮助。

谢谢，拉穆五世

# delphi - 如何让 Delphi 2009s (Refactor) Extract Interface 工作？

> ID：857204
> 
> 赞同：1
> 
> 时间：2009-05-13T10:31:44.123
> 
> 标签：delphi, ide, refactoring, delphi-2009

我正在尝试使用 Delphi 2009 的重构从类中提取接口。该类看起来像这样：

```
Type
  TMyClass = class(TObject)
  private
    FPrivateVar: Integer;
  public
    procedure MyPublicProc(Value: String); 
    function MyPublicFunc(Value: String): String;
  end; 
```

如果我将光标放在公共部分，右键单击并选择 Refactoring|Extract interface，然后有一个轻微的停顿......什么都没有。我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T14:18:03.757

我正在使用 Delphi 2009 版本 12.0.3210.17555（已安装更新 1 和 2），并且我检查了您课堂上的功能...

只要我只有你的类接口，并且方法没有实现，我就会收到这个错误消息：

> 选择应包含一个或多个类或一个或多个类成员。

我按 Ctrl+Shift+C 完成了类的实现，然后又试了一次，效果很好：

[http://www.picoodle.com/view.php?img=/2/5/13/kykl1zna1e5r/f_ExtractIntem_4aaede9.png&srv=img30](http://www.picoodle.com/view.php?img=/2/5/13/kykl1zna1e5r/f_ExtractIntem_4aaede9.png&srv=img30)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T11:37:59.757

在 D2007 中它工作正常。（我必须启用/添加模型支持，它会自动要求它）。当我单击一个过程（例如将光标放在 MyPublicProc 中的某个位置）时，它可以正常工作。

如果您打开反射视图，您会看到错误吗？（德尔福 -> 视图 -> 重构）

# caching - 使用 cmd 命令=> ipconfig/dnsflush 清除我的缓存？

> ID：857208
> 
> 赞同：0
> 
> 时间：2009-05-13T10:32:36.510
> 
> 标签：caching, dns, flash, ipconfig

如果我的计算机是多个实时网站的网络服务器，如果我在命令提示符编辑器中键入 ipconfig/dnsflush 会不会有任何危害？

我总是遇到这个问题。我在 .html 文件中嵌入了 flash (swf)。每当我更新 swf 时，.html 文件总是使用旧的 swf，即使我清除了缓存和其他任何内容。

有什么方法可以让我的 .html 文件始终获取最新/更新的 swf 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T10:38:56.593

键入 ipconfig/dnsflush 不会解决您的问题，那就是刷新 DNS 缓存，您的问题是浏览器正在缓存您的 SWF 文件。有几种方法可以阻止这种情况。最简单的方法可能是在 EMBED/OBJECT 标记中的 SWF 文件的 URL 上添加一个随机查询字符串：

```
<script type="text/javascript">
<!--
document.write('<object etc ... ');
document.write('<param name="movie" value="filename.swf?r=' + Math.round(Math.random() * 99999) + '">');
document.write(' the other param tags here );
document.write('<embed src="filename.swf?r=' + Math.round(Math.random() * 99999) + '" etc .... </embed>');
document.write('</object>');
//-->
</script> 
```

但请注意，这意味着您的 SWF 将每次都重新下载，而不是从浏览器缓存中下载。如果您不希望这样，请考虑在查询字符串中添加版本号而不是随机数，并在您希望客户端下载新的 SWF 文件时增加它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T10:57:37.997

我有一个小的 php 片段，用于在 flash 的 url 末尾附加我将文件上传到服务器时的 unixtime。这样我只需上传新的，一切都会自动排序。

# windows - 如何在 Windows XP 和 Vista 下存储时区首选项

> ID：857209
> 
> 赞同：1
> 
> 时间：2009-05-13T10:33:53.747
> 
> 标签：windows, timezone, registry

在 Windows XP 和 Vista（以及服务器 2003 和 2008）之间，Microsoft 已经删除了`Index`密钥`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Time Zones`并猜测我们存储在数据库中的值来记录员工的时区......

（请参阅[http://support.microsoft.com/kb/935369](http://support.microsoft.com/kb/935369)）。

什么是最好的使用价值？微软似乎提倡使用相关时区的注册表项的名称（如`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Time Zones\GMT Standard Time`），但这对我来说就像是魔法常数。

是否有一个值可以保证在 Windows 版本、文化、翻译和本地化中是唯一且固定的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T14:16:47.907

不幸的是，这些魔法常数似乎是识别这些时区的最佳方式。

事实上，这正是 .NET 3.5 的[TimeZoneInfo](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.aspx)类[用作](http://blogs.msdn.com/bclteam/archive/2007/06/07/exploring-windows-time-zones-with-system-timezoneinfo-josh-free.aspx)其 Id 字段的内容。

.NET 的文档说它“是唯一标识特定时区的密钥字符串”。暗示它不是本地化的。

# java - 如何在 Java 中执行 rd 命令？

> ID：857212
> 
> 赞同：3
> 
> 时间：2009-05-13T10:34:51.280
> 
> 标签：java

我该如何执行

> rd /s /qc:\文件夹

在 Java 中？

它在命令行上完美运行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T11:23:18.877

根据[dtsazza 的回答](https://stackoverflow.com/questions/857212/how-do-i-execute-rd-command-in-java/857220#857220)：

```
Runtime.getRuntime().exec("cmd.exe /k rd /s /q c:\\folder"); 
```

它在 WinXP SP3 下完美运行。该`/k`参数显示，随后将执行一个命令，该命令必须在`cmd.exe`.

祝你好运！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T10:38:31.680

检查[Runtime.exec](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#exec(java.lang.String))方法，它允许您调用外部进程。（请记住，您会失去一些平台独立性，因为这将依赖于`rd`安装了命令的机器和路径。）

更好的选择可能是在纯 Java 中做同样的事情 - 以下应该是等价的：

```
private void deleteDirectory(File directory)
{
   for (File entity : directory.listFiles())
   {
      if (entity.isDirectory())
      {
         deleteDirectory(entity);
      }
      else
      {
         entity.delete();
      }
   }
   directory.delete();
}

deleteDirectory(new File("C:\\folder")); 
```

根据需要添加错误检查。:-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T10:46:44.037

查看 Apache Commons-IO 中的 FileUtils；特别是[deleteDirectory](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html#deleteDirectory(java.io.File))和[deleteQuietly](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html#deleteQuietly(java.io.File))方法，它们都可以递归地删除目录。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T10:39:21.943

看`File.delete(String path)`方法，即：

```
new File("c:\\folder").delete(); 
```

如果`/s`（递归）删除很重要，那么（未经测试）：

```
public void deltree(File file) {
    if (file.isDirectory()) {
        for (File f : file.listFiles()) {
            deltree(f);
        }
    }
    file.delete();
}

public void deltree(String path) {
    deltree(new File(path));
} 
```

调用为：

```
deltree("c:\\folder"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T10:42:36.323

您只能删除 Java 中的空目录。首先，您必须删除文件和子目录。

```
 public static boolean removeDirectoryRecursively(File dir) {
            if (dir.isDirectory()) {
                String[] children = dir.list();
                for (int i = 0; i < children.length; i++) {
                    boolean success = removeDirectoryRecursively(new File(dir, children[i]));
                    if (!success) {
                        return false;
                    }
                }
            }
            // The directory is now empty so delete it
            return dir.delete();
        } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T11:03:32.373

如果您想完全按照您指定的方式执行它，您可以执行

```
Process p=Runtime.getRuntime().exec("cmd.exe /k rd /s /q c:\\folder"); 
```

# c# - 替换方法的所有用法（引入间接）

> ID：857213
> 
> 赞同：2
> 
> 时间：2009-05-13T10:35:15.960
> 
> 标签：c#, refactoring, resharper

我通常不太喜欢重构工具。无需赘述。不过，我偶尔会尝试新版本。这是我在评估 resharper 4.5 时尝试做的事情：

我需要用包装方法（要创建）替换方法的所有用法，但我不能。我通常很讨厌注意到一个明显的特征，是这样吗？如果resharper没有这个功能，你知道这样的工具吗？

编辑 2：示例已改进为包括实例方法调用。编辑：这是一个简单的案例。

```
 static void Main(string[] args)
    {
        while(true)
        {
            if (Console.ReadKey().Key == ConsoleKey.Escape)
            {
                Thread.Sleep(10);
                if (Quiting()) break;
            }
            Console.Beep(250, 50);
        }
    }

    static bool Quiting()
    {
        if (Console.In.Peek() > 0)
        {
            Console.Beep(250, 150);
            return false;
        }
        return true;
    } 
```

我需要的是这样的：（Edit2：添加了一个实例示例）

```
 private static StringBuilder _builder = new StringBuilder();

    static void Main(string[] args)
    {
        while(true)
        {
            var key = Console.ReadKey();
            if (key.Key == ConsoleKey.Escape)
            {
                Thread.Sleep(10);
                if (Quiting()) break;
            }
            _builder.Append(" (").Append(key.KeyChar).Append(") ");
            Beep(250, 50);
        }
    }

    static bool Quiting()
    {
        if (Console.In.Peek() > 0)
        {
            Beep(250, 150);
            _builder.Append('@');
            return false;
        }
        return true;
    }

    static void Beep(int frequency, int duration)
    {
        // finally cursor ends up here
        Console.Beep(250, 50);
    } 
```

Console.Beep 调用被重构。接下来让我们重构 StringBuilder.Append(char) ：

```
class Program
{
    private static StringBuilder _builder = new StringBuilder();

    static void Main(string[] args)
    {
        while(true)
        {
            var key = Console.ReadKey();
            if (key.Key == ConsoleKey.Escape)
            {
                Thread.Sleep(10);
                if (Quiting()) break;
            }
            _builder.Append(" (").AppendUpper(key.KeyChar).Append(") ");
            Beep(250, 50);
        }
    }

    static bool Quiting()
    {
        if (Console.In.Peek() > 0)
        {
            Beep(250, 150);
            _builder.AppendUpper('n');
            return false;
        }
        return true;
    }

    static void Beep(int frequency, int duration)
    {
        // finally cursor ends up here
        Console.Beep(250, 50);
    }
}

static class StringBuilderExtensions
{
    public static StringBuilder AppendUpper(this StringBuilder builder, char c)
    {
        return builder.Append(char.ToUpper(c));
    }
} 
```

从用法中选择并可能省略常用参数（例如上面的 250）或非扩展静态的常用实例参数将使此功能更有价值。希望这可以解决问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T10:45:01.000

ReSharper 没有将此作为单一重构。我可能会这样做：

1.  选择要包装的方法的内容，并使用提取方法从内容中创建一个新的私有方法。
2.  原始方法现在是“自身”的简单包装。如果您愿意，可以重命名它，或者随意操作它（使其成为静态的，移动到不同的类，用 try/catch 包围，等等）。

* * *

**编辑：** 根据您的编辑，您似乎还有一个问题。Console.Beep 不仅不在*同一个*班级，甚至不在*你的*班级。

但是如果你不介意一点搜索和替换，那么你可以把它放到你自己的类中，然后继续重构：

```
namespace Temporary {
    public class Console {
        public static void Beep(int x, int y) {System.Console.Beep(x,y);}
    }
} 
```

然后执行“Replace in Files”以将 Console.Beep 替换为 Temporary.Console.Beep，并按上述方法进行操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T10:39:40.697

它不包含在任何 .NET 重构 IIRC 中，具有这种重构的工具是 Eclipse，但不适用于 .NET/C#

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T10:41:30.677

假设包装器方法将在同一个类中，您可以将当前方法重命名为新包装器方法的名称（Resharper 中的 ctrl+R+R）。这也将重命名解决方案中对此方法的所有调用。然后手动重命名原始方法（不要使用 Resharper，否则所有调用也会被重命名）并添加包装器方法。

* * *

根据您的编辑，我认为您将无法从我见过的任何 Visual Studio 加载项中获得您想要的功能（除了简单的查找和替换，我猜这会让您获得一些方式） .

根据您愿意为此投入多少时间和精力，我想可以使用[DXCore](http://www.devexpress.com/Products/Visual_Studio_Add-in/DXCore/)框架并编写一个可以进行这种重构的插件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-21T01:19:19.040

Resharper 具有[搜索和替换模式](http://www.jetbrains.com/resharper/webhelp/Reference__Search_with_Pattern.html)功能。它可以搜索和替换模式和表达式。

这将重构`Console.Beep()`对您自己的方法的所有调用。如果 250 是第一个参数，它只会替换用法：

![重新调用 Console.Beep()](https://i.stack.imgur.com/AyQfv.png)

但是，这将取代`Console.Beep()`您自己的 Beep 方法中的使用。您将不得不手动替换该用法。

# c# - Windows 服务依赖注入

> ID：857217
> 
> 赞同：0
> 
> 时间：2009-05-13T10:37:17.127
> 
> 标签：c#, .net, windows-services

有没有办法将一个“myWindowsService”设置为在同一台机器上运行的另一个服务，如“SqlService”？

问题是如果您不知道将安装“myWindowsService”的“sql 服务”的名称，但我的服务取决于 sql 已经在运行。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T11:25:48.530

编辑：没有正确阅读问题。

一种解决方法（不是最优雅的解决方案）是针对具有已知实例名称的已知白名单枚举所有服务。

* * *

使用 ManagementObject 您可以设置依赖项（但您必须知道服务的名称）：

```
 bool SetServiceDependencies(string serviceName, string[] dependencies)
    {
        try
        {
            string objPath = string.Format("Win32_Service.Name='{0}'", serviceName);
            //Uses lazy initialization
            ManagementObject mmo = new ManagementObject(new ManagementPath(objPath));
            //Get properties to check if object is valid, if not then it throws a ManagementException
            PropertyDataCollection pc = mmo.Properties;
        }
        catch (ManagementException me)
        {   //Handle errors
            if (me.ErrorCode == ManagementStatus.NotFound) {
                //Service not found
            }
            return false;
        }
        try
        {   
            object[] wmiParams = new object[11];    //parameters for Win32_Service mmo object Change-parameters
            wmiParams[10] = dependencies;

            //Should we remove dependencies, use array containging 1 empty string
            if (dependencies == null || dependencies.Length == 0)
            {
                wmiParams[10] = new string[] { "" };
            }

            //Change dependencies
            string returnStatus = mWmiService.InvokeMethod("Change", wmiParams).ToString();
        }
        catch (Exception)
        {
            return false;
        }
        return true;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T13:37:17.940

如果您正在使用

```
sc create <service> 
```

语法，您可以为此提供其他服务，这将使您安装的服务依赖于正在启动的服务。

```
sc create <service> depend= mssqlserver 
```

如果您使用 ServiceInstaller 类，这也可以自动完成。该控制器的属性中有一个区域用于定义启动依赖项。

我知道您说过您可能不知道其他服务的名称，但是更改依赖项也很简单。

# release - 一个大版本还是几个小版本？

> ID：857231
> 
> 赞同：3
> 
> 时间：2009-05-13T10:41:40.350
> 
> 标签：release, release-management

当您对现有的业务线应用程序进行增强时，您认为将更改批量更改为不太频繁的较大版本，还是在较小的版本中不断发布新功能更好？假设有硬件升级或数据库升级，您是在版本中也进行这些更改，还是将它们分开？

将所有内容一起发布的优点是对业务的干扰更少，涉及的工作时间更少，但是您以后遇到的任何问题都可能是由于数据库升级、硬件或任何数量的软件更改造成的。

很少发布并且通常可以更容易地跟踪发布导致的任何问题，但会导致更多的中断和更多的回归测试时间。

哪个更好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T10:46:20.433

考虑每个版本如何影响客户。频繁的小版本发布是否会因为更快地解决关键问题而让他们更快乐？这会提高您的销售和声誉吗？如果它会仔细估计这些好处是否超过了所做的额外工作，否则就选择对你更方便的路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T10:51:51.860

这真的取决于你所处的环境。一些场景：

*许多客户*：您希望所有客户尽可能拥有相同的版本。每年、每半年或每季度发布一次大版本要容易得多，因为测试和推出的协调成本非常高。在这种情况下，我也会包括数据库更改。

*“大型基础设施”*：如果在大型公司环境中工作，并且有专门的操作系统和数据库人员，那么发布的总体成本也很高，因此不太频繁地发布较大的版本会更好。

简而言之，计算发布在人力、业务中断、协调、测试方面的成本，并将其与每个新功能或错误修复的好处联系起来。

我通常倾向于每年发布 1-2 个大版本，并在其间进行错误修复以供表演者使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T10:55:27.393

我认为最好的答案是：两者兼而有之。

例如，如果您添加了一些吸引眼球的东西，或者使名称文本框更加“ajaxy”，或者可能会添加一种新型报告 - 将其设为“小”版本。尽早发布，并尽可能经常发布。

另一方面，如果您更改了面向用户的流程，迫使用户“重新培训”，或者如果您需要大规模的基础架构更改 - 进行大版本，并尽可能少地进行。

正如您所说，如果中断很少或没有中断，请尽可能多地执行，您的用户会因此而更快乐 - 而且您实际上将花费更少的时间进行回归测试，因为您只需要测试与更改相关的所有内容你做了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T10:49:17.467

就个人而言，我更喜欢大版本。

我家里有软件，它每周提供多次更新。这很烦人，因为没有自动更新功能，只是一个不断回来的通知。

你可能想看看这个类似的问题：[你应该多久发布一次软件更新](https://stackoverflow.com/questions/360028/how-often-should-you-release-software-updates)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T10:50:20.037

我认为最好将其整合到一个大版本中并进行修补，因为您需要解决问题。

作为开发人员，您需要预测系统中可能出现的问题和中断，以使其尽可能健壮。这通常意味着事先进行大量测试。

还要考虑到最终用户可能不想为产品中较小的增量付费，他们也可能等待大更新。一个很好的例子是当我得到 Adob​​e Photoshop 时，他们似乎每年都会发布一个新版本，所以我只是等到看起来合适的时候

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T10:53:10.487

较少数量的版本意味着您将一次找到所有错误。很难知道哪个代码更改导致了哪个错误。然后，您在级联错误方面遇到了更多问题 - 您几个月前所做的一次代码更改导致了一个错误，但与此同时，您又进行了五次更改，这些更改都取决于您几个月前引入的错误。

较小的高质量版本更好。较小的版本更容易获得高质量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T10:54:43.713

事实上 - 两者兼而有之。
您可以将开发分为 DEVEL 和 RELEASE 分支吗？任何紧急问题都应尽快在 REL 分支上完成，并作为修补程序发送给用户。在将修补程序应用到 REL 分支后，应用补丁的需求将发送给 DEV 团队（注意：要修复 REL 上的一些问题，您必须编写一些快速代码，而在 DEV 分支中，您需要花一些时间重新考虑建议的修复，因为 DEV 分支中的条件可能已经改变，所以通常你会编写完全不同的代码来修复 DEV 或 REL 分支中的相同问题）。
当全新版本的开发完成时，您必须测试从 REL 迁移的新功能和补丁。如果一切正常，您将可以部署全新的大版本，并将当前的 DEV 归档到 REL，而旧的 REL 现在将被封存。

# nhibernate - 审计日志记录休眠

> ID：857234
> 
> 赞同：1
> 
> 时间：2009-05-13T10:42:07.367
> 
> 标签：nhibernate, logging, audit

您能否为使用 NHibernate 的审计登录提供一些示例（ASP.Net+C# codd，而不是 java 代码）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-26T16:36:39.057

[事件监听器](http://nhforge.org/doc/nh/en/index.html#objectstate-events)比拦截器更适合审计信息。[这是](http://ayende.com/Blog/archive/2009/04/29/nhibernate-ipreupdateeventlistener-amp-ipreinserteventlistener.aspx)来自[Ayende 博客](http://ayende.com/Blog/Default.aspx)的一个很好的例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-14T14:12:43.267

我经常看到使用拦截器完成此操作。通过 Google 可以找到很多关于实施拦截器进行审计的博客文章，比如[这篇](http://www.lostechies.com/blogs/rhouston/archive/2008/03/27/creating-a-timestamp-interceptor-in-nhibernate.aspx)文章。

# java - Java相当于Ant的Java任务中的fork？

> ID：857236
> 
> 赞同：3
> 
> 时间：2009-05-13T10:43:09.613
> 
> 标签：java, ant, fork

[Ant Java 任务](http://ant.apache.org/manual/Tasks/java.html)提供`fork`参数，根据定义*“如果启用，则触发另一个 VM 中的类执行”*。由于我们正在处理大量数据，因此设置此参数可以避免耗尽 Java 堆空间。
我们希望能够通过 Java 类来做同样的事情。实现所提供的功能的最佳方法是`fork`什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T10:46:04.537

执行另一个 java 进程。例如，通过使用 ProcessBuilder 类。

[http://java.sun.com/javase/6/docs/api/java/lang/ProcessBuilder.html](http://java.sun.com/javase/6/docs/api/java/lang/ProcessBuilder.html)

您可以根据需要运行任意数量的工作进程。让他们有一个单独的主班，从那个主班做他们的任务，并在他们的任务完成后退出。

您必须弄清楚它们的类路径，以及系统上 java 二进制文件的位置，但这是可行的。

我认为您甚至可以在他们通过 Process.waitFor() 完成时收到通知。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T12:06:04.813

如果您查看`ant`源代码， when `fork`is `true`，那么它只是包装了一个`Execute`任务，最终，被调用的代码是

```
Runtime.getRuntime().exec(cmd, env); 
```

下载并查看源代码`org.apache.tools.ant.taskdefs.Java`，`org.apache.tools.ant.taskdefs.Execute`将为您提供一些很好的指导，帮助您找到可执行文件的位置以独立于平台的方式运行等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T10:51:40.503

我认为你可以直接使用Ant API...Ant 可以直接在Java 类中使用。Javadoc 在其二进制发行版中可用。

# sql - 为什么我的 SQL 语句在一个 SQL 语句中计算来自不同表的不同字段？

> ID：857237
> 
> 赞同：0
> 
> 时间：2009-05-13T10:43:43.637
> 
> 标签：sql, tsql

我有一个 SQL 查询：

```
SELECT 
    e.name as estate_name 
    , g.name as governing_body
    , count(s.id) as total_stands 
    , count(sp.id) as service_providers 
FROM estates e 
    LEFT JOIN governing_bodies    
        ON e.governing_body_id = g.id 
    LEFT JOIN stands s 
        ON s.estate_id = e.id 
    LEFT JOIN services sp 
        ON sp.estate_id = e.id 
GROUP BY e.id 
```

看来我的计数是相乘的。如果我的第一个计数是 3，第二个计数是 10，则`service_providers`字段和`total_stands`字段中的结果将为 30。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T11:48:14.360

What about changing the `COUNT(blah)` constructs to `COUNT(DISTINCT blah)` ?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T10:52:42.437

count() 显示为您的组找到的行数。由于您正在对房地产进行分组，因此它将计算您加入房地产的行数。连接会增加行数，所以 3 x 10 = 30 听起来是正确的计数。运行不带 GROUP BY 的查询以查看发生了什么。

修复它的一种方法如下所示：

```
SELECT 
    e.name as estate_name, 
    g.name as governing_body, 
    (select count(*) from stands s where s.estate_id = e.id) as stands,
    (select count(*) from services sp where sp.estate_id = e.id) as services
FROM estates e
LEFT JOIN governing_bodies g on e.governing_body_id = g.id 
```

写出 Alex Martelli 的信息丰富的答案：

```
SELECT 
    e.name as estate_name 
    , g.name as governing_body
    , count(distinct s.id) as total_stands 
    , count(distinct sp.id) as service_providers 
FROM estates e 
    LEFT JOIN governing_bodies    
        ON e.governing_body_id = g.id 
    LEFT JOIN stands s 
        ON s.estate_id = e.id 
    LEFT JOIN services sp 
        ON sp.estate_id = e.id 
GROUP BY e.id, g.name 
```

或者，作为 JOIN 语法的更复杂的替代方案：

```
SELECT 
    e.name as estate_name, 
    g.name as governing_body, 
    IsNull(stand_count.total,0) as stand_count,
    IsNull(service_count.total,0) as service_count
FROM estates e
LEFT JOIN governing_bodies g on e.governing_body_id = g.id
LEFT JOIN (
   select estate_id, total = count(*) from stands group by estate_id
) stand_count on stand_count.estate_id = e.id
LEFT JOIN (
    select estate_id, total = count(*) from services group by estate_id
) service_count on service_count.estate_id = e.id
GROUP BY
    e.name,
    g.name,
    IsNull(stand_count.total,0),
    IsNull(service_count.total,0) 
```

# jsp - JSP 重定向：会话丢失问题

> ID：857239
> 
> 赞同：3
> 
> 时间：2009-05-13T10:44:37.893
> 
> 标签：jsp, session, redirect, cookies

将 a 替换为`<jsp:forward page="URL">`a 后`response.sendRedirect("URL");`，我发现一旦发生重定向，我就会失去会话。有没有办法通过重定向保留会话，或者重构会话 cookie 并将其与重定向一起发送？

我知道我可以通过 使用 JavaScript `window.location = "URL";`，但这远非理想！

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T11:00:28.993

您不必重新发送 cookie，因为如果您建立了会话，则 cookie 应该已经在客户端（浏览器）上。

你确定你失去了会话？你如何检测到这一点？您重定向到的 url 所代表的页面中是否有新会话？

浏览器是否接受cookies？否则你应该使用 url 重写。这是最可能的原因。您可以`HttpServletResponse.encodeRedirectURL`在将 url 传递给`response.sendRedirect`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-28T22:20:17.120

当您使用 jsp:forward 标记时，它会将**请求**对象转发到标记指示的 URL。您实际上是在转发请求对象。

当您使用**响应**对象的 sendRedirect() 方法时，您只是将绝对 URL 发送回客户端的 Web 浏览器。换句话说，响应变成了对给定 URL 的重定向，然后客户端的浏览器会调用该 URL。

如果数据是请求的一部分，则会丢失；因此，如果您在设置会话的用户名属性之前尝试重定向，则会发生这种情况。

如果您真的失去了会话，这可能表明几件事： 1) 如果新 URL 不在同一个域中，则不会发送 cookie。2) 如果新的 URL 在 cookie 路径之外，则不会发送 cookie。3) 浏览器未设置为允许使用 cookie。在这种情况下，您必须在使用 jsp:forward 时对 URL 进行编码，所以如果是这种情况，我会感到惊讶。

在任何这些情况下，都会建立一个新会话，并使用新域和 URL 的路径创建一个新的 cookie。

# c# - 如何从该行的文本框中访问 DataGridRow？

> ID：857244
> 
> 赞同：0
> 
> 时间：2009-05-13T10:45:24.493
> 
> 标签：c#, .net, datagrid, datarowview

在 DataGrid 中，当文本框中的文本发生更改时，我想将该行中另一个字段的值添加到数组中。

```
public void txtTitle_TextChanged(object sender, EventArgs e)
{
    TextBox titleBox = (TextBox)sender;
    DataGridItem myItem = (DataGridItem)titleBox.Parent.Parent;
    string test = DataBinder.Eval(myItem.DataItem, "prod_id").ToString();
} 
```

但是 myItem.DataItem 的计算结果为 null。我期待它评估为 DataRowView？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T18:33:51.700

如果您执行以下操作，您可以触发 TextChanged 事件：

```
<asp:DataGrid ID="DataGrid1" runat="server" AutoGenerateColumns="False" 
    onitemdatabound="DataGrid1_ItemDataBound">
    <Columns>
        <asp:TemplateColumn HeaderText="Test">
            <ItemTemplate>
                <asp:TextBox OnTextChanged="txtBox_TextChanged" ID="TextBox1" runat="server" AutoPostBack="True"></asp:TextBox>
            </ItemTemplate>
        </asp:TemplateColumn>
        <asp:BoundColumn DataField="Name" HeaderText="Test 1"></asp:BoundColumn>
    </Columns>
</asp:DataGrid> 
```

您会注意到我设置了以下属性： AutoPostBack="True" 我还手动将 OnTextChanged="txtBox_TextChanged" 添加到文本框中。

在我后面的代码中，我有：

```
protected void txtBox_TextChanged(object sender, EventArgs e)
{
    TextBox txtBox = (TextBox)sender;
    Label1.Text = txtBox.Text;
} 
```

触发事件的唯一方法是您在键入后失去对文本框的关注。

需要考虑的要点：这将导致回发，因此 Ajax 可能是保持用户体验良好的好方法。您需要确保将 DataBind() 包装在 if (!IsPostBack) 中

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-22T22:47:52.113

实际上，我通过在表中添加一个自动编号列来解决这个问题，并使用它的值来确定表中行的位置，然后使用它的值来影响数据网格中的相应行。如原始问题所述，我现在只是更改行的颜色，而不是将该行中的值添加到数组中。

```
public void txtPrice_TextChanged(object sender, EventArgs e)
{
    TextBox txtPrice = (TextBox)sender;
    DataGridItem myItem = (DataGridItem)txtPrice.Parent.Parent;
    markRows(myItem, true);
}

public void markRows(DataGridItem myItem, bool toSave)
{
    // Prepeare to save this record?
    CheckBox thisSave = (CheckBox)myItem.FindControl("chkSave");
    thisSave.Checked = toSave;
    // Establish the row's position in the table
    Label sNo = (Label)myItem.FindControl("SNo");
    int rowNum = Convert.ToInt32(sNo.Text) - 1;
    CheckBox rowSave = (CheckBox)grid.Items[rowNum].FindControl("chkSave");

    // Update background color on the row to remove/add highlight 
    if (rowSave.Checked == true)
        grid.Items[rowNum].BackColor = System.Drawing.Color.GreenYellow;
    else
    {
        Color bgBlue = Color.FromArgb(212, 231, 247);
        grid.Items[rowNum].BackColor = bgBlue;
        // some code here to refresh data from table?
    }
} 
```

# javascript - 有没有 jQuery unfocus 方法？

> ID：857245
> 
> 赞同：203
> 
> 时间：2009-05-13T10:45:50.047
> 
> 标签：javascript, jquery

如何取消焦点文本区域或输入？没找到`$('#my-textarea').unfocus();`方法？

* * *

## 回答 #1

> 赞同：350
> 
> 时间：2009-05-13T10:47:30.603

```
$('#textarea').blur() 
```

文档位于：[http ://api.jquery.com/blur/](http://api.jquery.com/blur/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-05-29T03:16:46.860

根据您的问题，我相信答案是如何*触发 blur*，而不仅仅是（甚至）设置事件：

```
 $('#textArea').trigger('blur'); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-11-29T06:28:42.040

猜你在找[`.focusout()`](http://api.jquery.com/focusout/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-01-17T12:17:18.293

我喜欢以下方法，因为它适用于所有情况：

```
$(':focus').blur(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-30T14:40:36.700

这对我有用：

```
// Document click blurer
$(document).on('mousedown', '*:not(input,textarea)', function() {
    try {
        var $a = $(document.activeElement).prop("disabled", true);
        setTimeout(function() {
            $a.prop("disabled", false);
        });
    } catch (ex) {}
}); 
```

* * *

## 回答 #6

> 赞同：-13
> 
> 时间：2012-06-19T15:37:35.653

所以你可以这样做

```
$('#textarea').attr('enable',false) 
```

尝试并提供反馈

# unix - 打印代码的硬拷贝

> ID：857251
> 
> 赞同：2
> 
> 时间：2009-05-13T10:46:30.310
> 
> 标签：unix, shell

我必须提交一个软件项目，该项目需要包含所有代码的纸质或 .pdf 副本。

我考虑过的一种解决方案是按上下文对类进行分组并执行 cat *.extension > out.txt 以提供所有代码，然后通过对最终文本文件进行分类，我应该有一个文本文件，其中包含按上下文分组的类。这不是一个理想的解决方案；不会有分页符。

我的另一个想法是在要加入的文件之间注入乳胶分页符的 shell 脚本，这会更容易接受。虽然我不太擅长脚本或乳胶。

是否有任何工具可以为我做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T10:53:15.010

看一下[enscript](http://www.codento.com/people/mtr/genscript/)（或[nenscript](http://www.risacher.org/nenscript/)），它将转换为 Postscript，在列中呈现，添加页眉/页脚并执行[语法突出显示](http://www.seekingfire.com/documents/bitesized/prettyprintsource.html)。如果您想以一种像样的方式打印代码，这非常有效。

例如，这是我的设置（在 zsh 函数中）

```
 # -2 = 2 columns
  # -G = fancy header
  # -E = syntax filter
  # -r = rotated (landscape)

  # syntax is picked up from .enscriptrc / .enscript dir
  enscript -2GrE  $* 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T10:55:29.953

有关快速解决方案，请参阅[a2ps](http://www.gnu.org/software/a2ps/)，然后是 ps2pdf。对于更好、更复杂的解决方案，我会选择一个简单的脚本，将每个文件放在 LaTeX[列表](http://www.ctan.org/tex-archive/macros/latex/contrib/listings/)环境中并组合结果。

# c++ - 库中的 c++ 常量；不工作

> ID：857258
> 
> 赞同：0
> 
> 时间：2009-05-13T10:48:03.303
> 
> 标签：c++, constants

当我尝试包含具有以下声明的库时，任何人都知道为什么这不起作用：

```
namespace wincabase
{
  const char* SOMESTRING = "xx";
} 
```

虽然这很好：

```
namespace wincabase
{
  const int X = 30;
} 
```

当我链接库时，我在第一种情况下使用 gcc 收到“多个定义”错误。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T10:54:02.793

const char* 表示指向 const char 的指针。这意味着指针本身**不是**常量。

因此它是一个正常的变量，所以你需要使用

```
extern const char* SOMESTRING; 
```

在头文件中，和

```
const char* SOMESTRING = "xx"; 
```

在库的一个编译单元中。

* * *

或者，如果它是指向 const char 的**const**指针，那么您应该使用：

```
const char* const SOMESTRING = "xx"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T10:55:17.377

您将指针声明为 const，然后将其指向编译单元中定义的字符串文字，因此如果您在头文件中使用它，您将复制字符串文字。您需要做的是在头文件中声明指针，并在库的源文件中定义字符串。

标题：

```
extern const char* SOMESTRING; 
```

在库中的一些源文件中：

```
const char* SOMESTRING = "xx"; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T17:40:02.973

除了 Tobi 指出的方法：

```
const char* const SOMESTRING = "xx"; 
```

另一种选择是将其声明为**const**字符*数组*：

```
const char SOMESTRING[] = "xx"; 
```

这种方法可能为编译器提供额外的优化机会，例如将字符串放在生成的二进制文件的只读部分；尽管可以想象编译器可能能够使用第一种方法执行类似的优化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T13:56:14.150

您需要分别声明和定义它们：

```
Plop.h
======
namespace wincabase
{
   extern const char* SOMESTRING;  // declare
}

Plop.cpp
========
const char* wincabase::SOMESTRING = "xx"; // define 
```

# database - 为什么在 CakePHP 中重命名我的数据库后出现错误？

> ID：857259
> 
> 赞同：0
> 
> 时间：2009-05-13T10:48:49.103
> 
> 标签：database, cakephp, renaming

上传使用 cakephp 创建的应用程序后，我发现我必须重命名数据库。我相应地重命名了我的数据库并更改了“config”文件夹中 database.php 文件中的设置。但是我的应用程序仍然没有运行。我看到这条错误消息“缺少数据库表”“错误：找不到模型主题的数据库表 tbl_topics。”

我已经仔细检查了数据库中 tbl_topics 的存在（它在数据库中）但是应用程序说“找不到表”可能是什么问题，请帮助我......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T11:05:34.193

确保`host/user/pass`您在 config.php 文件中设置的可以访问该数据库和表

您也可以尝试运行`cake schema generate --dry`，这将解决您可能遇到的任何连接问题

还可以查看您`app/tmp/logs`的有关您遇到的问题的一些额外信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T11:06:15.533

获取您用于 cakephp 的用户名和密码，它是数据库连接，并从命令行连接到数据库。我假设您使用的是 unix 类型的系统和 mysql？

```
mysql --user=user_name --password=your_password db_name 
```

...然后尝试运行一个简单的选择：

```
SELECT * FROM tbl_topics 
```

如果您在那里遇到错误，它至少会确定这是一个低级别的数据库问题，并且可能的解决方案是您需要授予该用户名权限以从该数据库中进行选择。您当前对该用户的访问级别可能正在授予对旧名称下的数据库的访问权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T12:23:04.660

您可能也上传了缓存文件。确保删除 /app/tmp/cache/* 中的所有文件

**警告**：不要删除文件夹，只删除文件！

另外，请确保您的 tmp 文件夹和所有子文件夹都是全局可写的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T12:35:54.610

:-) 终于明白了.... :-D

我忘记在主服务器上分配用户访问我的应用程序数据库的权限。分配权限后一切正常。

无论如何，谢谢大家的宝贵答案......它帮助我获得了一些关于 cakephp 的额外知识。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T11:55:36.140

最后一个想法是检查您的模型缓存。我不知道为什么这会影响您的连接，但值得一看`app/tmp/cache`。

# javascript - Javascript open.window 在被调用函数中返回 null

> ID：857262
> 
> 赞同：1
> 
> 时间：2009-05-13T10:49:55.967
> 
> 标签：javascript, function, class, dom-events

我开发了一个函数，调用时应该打开一个窗口，但它会返回`null`。如果我在原始 JavaScript 函数中打开窗口，它就可以工作。我想它是将控制权传递给另一个函数的原始函数，但由于某种原因这不起作用。

这是我的原始函数，这基本上调用了一个新的 JavaScript 文件并加载了一个 HTML 文件，当“就绪”时，它需要显示 window.open 以及现在为字符串形式的 HTML 文件。

```
order.prototype.printMe = function() {
    order_resume.loadthis("myTestPage.html", "showData");

    // OPENING WINDOW HERE WORKS; but the the html file that is loaded
    // in above line hasn't finsihed loading - so i need to show it form
    // the function below once in "ready" state 

/*      child1 = window.open ("about:blank","_blank");
        child1.document.write( myDocument );
        child1.document.close();
*/      
} 
```

这是我从原始函数调用的函数：

```
function showResume() {
    this.req = false;

    reservaResumen.prototype.showData = function() {
        if (this.req.readyState == 4) {
            child1 = window.open("about:blank", "_blank"); /// THIS RETURNS NULL
            child1.document.write("test");
            child1.document.close();
        }
    }

    reservaResumen.prototype.loadthis = function(url, myMethod) {
        if (window.XMLHttpRequest && !(window.ActiveXObject)) {
            try {
                this.req = new XMLHttpRequest();
            }
            catch (e) {
                this.req = false;
            }
        }
        else if (window.ActiveXObject) {
            try {
                this.req = new ActiveXObject("Msxml2.XMLHTTP");
            }
            catch (e) {
                try {
                    this.req = new ActiveXObject("Microsoft.XMLHTTP");
                }
                catch (e) {
                    this.req = false;
                }
            }
        }
        if (this.req) {
            var loader = this;
            this.req.onreadystatechange = function() {
                eval("loader." + myMethod + ".call(loader)")
            }
            this.req.open("GET", url, true);
            this.req.send("");
        }
    }​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-09-22T17:12:26.740

请参阅[此讨论主题](http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/88b3165b-980a-49fe-b66b-c86e8289c30d)，该主题将此问题归因于在 64 位 Windows 7 上运行的 32 位 IE8 浏览器。

几天前我刚遇到这个。我的开发机器开始出现不同的行为，弹出窗口不再在许多站点上工作，包括我开发的站点，并且看不到修复。我必须以管理员身份启动 IE，然后它才能工作。禁用保护模式并不能解决此问题。64位浏览器没有这个问题。

为什么就我而言，这只是几周前才开始的，我不能说。9/16 有一个安全更新，我怀疑它导致了行为的改变。这很奇怪。

# java - Red5 + Java + Windows 安装 + ant 编译：可以，但是为什么呢？

> ID：857270
> 
> 赞同：0
> 
> 时间：2009-05-13T10:52:20.237
> 
> 标签：java, red5

**我对 java和**java Server 世界都是全新的......但我对面向对象编程有很好的了解（17 年）。我的问题是：

为什么我必须调用 ant 才能使其工作（见下文，如果您不感兴趣，请跳过我的问题 ^_^ ）？

这就是我想要的：创建一个可以进行视频会议的简单应用程序（= 服务器接收一个客户端视频流并将其分派给 X 客户端）。我希望它是免费的（Adobe Server 大约需要 10000 美元）。我找到的唯一解决方案是 Red5（见[那里](http://code.google.com/p/red5/)）

我已经下载并安装了 0.7 版本。以下是我为能够成功编译 Red5 的 java 应用程序所做的步骤：

1.  下载并安装 (Windows XP) 最新版本 (0.7)
2.  在安装文件夹中手动下载和复制一些在 0.7 安装中被遗忘的文件（与 v0.6 版本相比，猜猜是哪些）（`ivy.xml`如果我记得的话）
3.  进入`[Red5 path]\webapps`文件夹。复制/粘贴`tutorial`文件夹。
4.  将文件夹重命名为`myapp`.
5.  编辑该文件夹中的所有 xml 文件，搜索字符串`tutorial` 并将其重命名为`myapp`
6.  这是我所做的，*但**它**不起作用***：用 javac 编译：
    `javac -classpath "[Red5 path]\red5.jar" -d "[Red5 path]\webapps\myapp\WEB-INF\classes" Application.java javac -classpath "[Red5 path]\red5.jar" -d "[Red5 path]\webapps\myapp\WEB-INF\classes" TestService.java`
7.  一切正常，但一旦我启动 Flex 客户端，来自服务器的答案是“无效的应用程序”
8.  经过多次尝试，我发现删除所有内容，但该代码使一切正常：

    ```
    package myapp;

    import org.red5.server.adapter.ApplicationAdapter;
    import org.red5.server.api.IConnection;
    import org.red5.server.api.IScope;    

    /* myapp */
    public class Application extends ApplicationAdapter {

    ```
    public String sayHello(Object[] params){
        return "got : " + params[0].toString();
    } 
    ```

    } 
    ```

然后我希望能够追踪。

1.  我编写了在 Red5 示例中运行的代码：

    ```
    `package myapp;

    import org.slf4j.Logger;
    import org.slf4j.LoggerFactory;
    import org.red5.server.adapter.ApplicationAdapter;
    import org.red5.server.api.IConnection;
    import org.red5.server.api.IScope;

    public class Application extends ApplicationAdapter {

    ```
    protected static Logger log = LoggerFactory.getLogger(Application.class);

    public String sayHello(Object[] params){
        log.info("I got your name: "+params[0].toString());
        return "I got your name: " + params[0].toString();
    } 
    ```` 

    `}` 
    ```

`*   重新启动 Red5 服务器后：我总是得到服务器的响应：“无效的应用程序”

    *   然后我下载了[ant](http://ant.apache.org/bindownload.cgi)，解压到`[Red5 path]`*   我创建了一个新文件`[Red5 path]\webapps\myapp\WEB-INF\build.xml`*   我已经把那个xml放在里面了：`

 ````
<project name="Projet myapp" default="compile" basedir=".">
    <target name="clean" description="Clean output directories">
    </target>
    <target name="compile" depends="clean">
        <javac srcdir="./src" destdir="./classes" source="1.6" classpath="C:\Program Files\Red5\red5.jar" >
        </javac>
    </target>
    <target name = "jar" depends ="compile">
        <echo message ="Creating jar..."/>
        <jar destfile="./lib/myapp.jar" basedir="./classes"/>
        <echo message ="Done."/>
    </target>
</project> 
```

6.  运行一个 shell，然后输入：
     ````
    cd [Red5 path]\webapps\myapp\WEB-INF
    ......\apache-ant-1.7.1\bin\ant jar
    ```` 
`*   现在一切正常！*   这是问题！*   我不明白的是：
    **为什么我必须调用 ant 才能使其工作？**`

 `* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T11:02:31.220

Ant 将编译代码（编译目标）和构建 jar 文件（目标 jar），该文件将放置在 lib 文件夹中。当您简单地使用 javac 编译代码时，不会生成 jar 文件。

# java - Tomcat问题重新部署：

> ID：857271
> 
> 赞同：0
> 
> 时间：2009-05-13T10:52:22.313
> 
> 标签：java, tomcat, deployment

在 catalina 日志文件中，当尝试重新部署 Web 应用程序时，我们会在某些情况下看到此错误消息：

```
INFO: Deploying web application archive ROOT.war
13-May-2009 09:50:09 org.apache.catalina.core.StandardContext processTlds
SEVERE: Error reading tld listeners java.lang.IllegalArgumentException: URI has an authority component
java.lang.IllegalArgumentException: URI has an authority component
    at java.io.File.<init>(File.java:340)
    at org.apache.catalina.startup.TldConfig.getJarPaths(TldConfig.java:695)
    at org.apache.catalina.startup.TldConfig.execute(TldConfig.java:277)
    at org.apache.catalina.core.StandardContext.processTlds(StandardContext.java:4441)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4248)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:791)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:771)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:525)
    at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:829) 
```

由于 NAS（网络附加存储）暂时无法访问，因此该应用程序似乎已重新部署。可能是权限意味着“无法访问”，但我喜欢理解原因和信息。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T13:20:40.683

实际上，它看起来与JAR 中包含格式错误的[URI的](http://java.sun.com/javase/6/docs/api/java/net/URI.html)[.tld 文件](http://java.sun.com/j2ee/1.4/docs/tutorial/doc/JSPTags6.html)有关。检查您正在重新部署的应用程序中 JAR 的内容。

（还有你为什么要重新部署ROOT？）

# sql-server - CLR 存储过程：如何设置模式/所有者？

> ID：857272
> 
> 赞同：10
> 
> 时间：2009-05-13T10:52:23.793
> 
> 标签：sql-server, stored-procedures, sql-server-2005, sqlclr, sql-server-data-tools

我正在为一些复杂的过滤和操作开发基于 Linq 的 CLR 存储过程，否则如果在更“传统”的存储过程中实现，则需要大量混乱且性能不佳的 T-SQL 代码。

这很好用，但我找不到如何在部署阶段设置此存储过程的架构，以便更好地组织和分离模块中的数据库对象。

有任何想法吗？

提前谢谢了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-01-04T19:36:39.927

**更新：** 在 Visual Studio 2012 中，这现在可以通过“SQL Server 数据库项目”的项目属性窗口来完成。相关属性是“项目设置”选项卡上的“默认架构”。修改此值会修改生成的部署脚本，将 Schema 名称放在 Functions、Stored Procedures 等前面... 请务必将 Schema 对象添加到具有相同名称的项目中，否则会出现构建错误。

* * *

我不知道您使用的是什么版本的 Visual Studio，但是当您在 Visual Studio 2010 中创建 CLR 存储过程项目时，该项目包含两个 SQL 脚本：PreDeploymentScript.sql 和 PostDeploymentScript.sql。

我们只是使用这些来以我们想要的方式操纵事物。

在预部署脚本中，我们有这样的内容：

```
-- DROP EXISTING ITEM FROM CURRENT SCHEMA
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[Utilities].[fn_Create_Md5_Hash]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [Utilities].[fn_Create_Md5_Hash]
GO 
```

然后，在部署后脚本中，我们有：

```
-- DEPLOYMENT WIZARD RECREATES ITEM IN dbo SCHEMA
-- DROP NEW ITEM FROM dbo SCHEMA
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[fn_Create_Md5_Hash]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [dbo].[fn_Create_Md5_Hash]
GO

-- RECREATE THE ITEM BACK IN THE SCHEMA YOU WANT
CREATE FUNCTION [Utilities].[fn_Create_Md5_Hash](@source [varbinary](max))
RETURNS [varbinary](8000) WITH EXECUTE AS CALLER
AS 
EXTERNAL NAME [NameSpace].[UserDefinedFunctions].[fn_Create_Md5_Hash]
GO 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T11:04:33.057

当您创建引用程序集的过程时，您可以创建此包装器，该包装器由您想要的任何架构拥有。有关如何部署存储过程的演练，请参阅[有关部署 CLR 存储过程的 MSDN 文章。](http://msdn.microsoft.com/en-us/library/ms254956(VS.80).aspx)通过将创建过程语句更改为以下内容：

```
CREATE SCHEMA foo

CREATE PROCEDURE foo.hello
AS
EXTERNAL NAME helloworld.HelloWorldProc.HelloWorld 
```

您现在可以拥有一个由`foo`模式拥有的过程。

# asp.net-mvc - 在 GAC 中加载 System.Web.Mvc 时，.NET MVC 是否工作？

> ID：857276
> 
> 赞同：2
> 
> 时间：2009-05-13T10:52:58.333
> 
> 标签：asp.net-mvc, visual-studio-2008, assemblies, gac

**是否允许将 System.Web.Mvc 放入 GAC？允许：它有效吗？**

我已经这样做了，我所有的项目都有从 System.Web.Mvc.ViewPage 继承的问题......

**编辑** 希望这不会吓到你：

```
C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE> "c:\WINDOWS\Microsoft.NET\Framework\v3.5\vbc.exe" /t:library /utf8output /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\56b70440\003d6f34_8989c901\EntitySpaces.SqlServerCeProvider.DLL" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.Drawing\2.0.0.0__b03f5f7f11d50a3a\System.Drawing.dll" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.WorkflowServices\3.5.0.0__31bf3856ad364e35\System.WorkflowServices.dll" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.Web.Abstractions\3.5.0.0__31bf3856ad364e35\System.Web.Abstractions.dll" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.Web.Extensions\3.5.0.0__31bf3856ad364e35\System.Web.Extensions.dll" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\de7cc3b4\0097d136_8989c901\EntitySpaces.LoaderMT.DLL" /R:"C:\WINDOWS\assembly\GAC_32\System.Data\2.0.0.0__b77a5c561934e089\System.Data.dll" /R:"C:\WINDOWS\assembly\GAC_MSIL\System\2.0.0.0__b77a5c561934e089\System.dll" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.Runtime.Serialization\3.0.0.0__b77a5c561934e089\System.Runtime.Serialization.dll" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\2afa6c79\006aa035_8989c901\EntitySpaces.NpgsqlProvider.DLL" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.Xml.Linq\3.5.0.0__b77a5c561934e089\System.Xml.Linq.dll" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.Web.Services\2.0.0.0__b03f5f7f11d50a3a\System.Web.Services.dll" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\4a9a547a\006aa035_8989c901\EntitySpaces.OracleClientProvider.DLL" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\ea5276d6\0051153a_699ec901\System.Web.Mvc.DLL" /R:"C:\WINDOWS\assembly\GAC_32\System.Web\2.0.0.0__b03f5f7f11d50a3a\System.Web.dll" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\f8843c3a\0097d136_8989c901\EntitySpaces.Web.Design.DLL" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\4137948d\003d6f34_8989c901\EntitySpaces.Npgsql2Provider.DLL" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.ServiceModel\3.0.0.0__b77a5c561934e089\System.ServiceModel.dll" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\b72019d9\003d6f34_8989c901\EntitySpaces.MySqlClientProvider.DLL" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.Data.DataSetExtensions\3.5.0.0__b77a5c561934e089\System.Data.DataSetExtensions.dll" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.Xml\2.0.0.0__b77a5c561934e089\System.Xml.dll" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.Configuration\2.0.0.0__b03f5f7f11d50a3a\System.Configuration.dll" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_global.asax.hiqvxvcm.dll" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.Data.Linq\3.5.0.0__b77a5c561934e089\System.Data.Linq.dll" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\ad4567e4\006aa035_8989c901\EntitySpaces.Loader.DLL" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\b543038f\006aa035_8989c901\EntitySpaces.Core.DLL" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\701637c6\003d6f34_8989c901\EntitySpaces.VistaDBProvider.DLL" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_vpbbzwke.dll" /R:"C:\WINDOWS\assembly\GAC_32\System.EnterpriseServices\2.0.0.0__b03f5f7f11d50a3a\System.EnterpriseServices.dll" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\66dcb3ba\006aa035_8989c901\EntitySpaces.Web.DLL" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.Core\3.5.0.0__b77a5c561934e089\System.Core.dll" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.ServiceModel.Web\3.5.0.0__31bf3856ad364e35\System.ServiceModel.Web.dll" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.Web.Routing\3.5.0.0__31bf3856ad364e35\System.Web.Routing.dll" /R:"C:\WINDOWS\assembly\GAC_MSIL\EC\1.0.0.0__2fce90138e5217ab\EC.dll" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.Web.Mobile\2.0.0.0__b03f5f7f11d50a3a\System.Web.Mobile.dll" /R:"C:\WINDOWS\assembly\GAC_MSIL\System.IdentityModel\3.0.0.0__b77a5c561934e089\System.IdentityModel.dll" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\750052d7\716d39b6_bfd3c901\VandaagLijst.DLL" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\d5308498\003d6f34_8989c901\EntitySpaces.MSAccessProvider.DLL" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\5ad7a5b5\006aa035_8989c901\EntitySpaces.SqlClientProvider.DLL" /R:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\assembly\dl3\54566418\003d6f34_8989c901\EntitySpaces.Interfaces.DLL" /out:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.dll" /debug- /win32resource:"c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\p7uswgud.res" /define:_MYTYPE=\"Web\" /imports:Microsoft.VisualBasic,System,System.Collections,System.Collections.Specialized,System.Configuration,System.Text,System.Text.RegularExpressions,System.Web,System.Web.Caching,System.Web.SessionState,System.Web.Security,System.Web.Profile,System.Web.UI,System.Web.UI.WebControls,System.Web.UI.WebControls.WebParts,System.Web.UI.HtmlControls,System.Web.Mvc,System.Web.Mvc.Ajax,System.Web.Mvc.Html,System.Web.Routing,System.Linq,System.Collections.Generic,EC /warnaserror- /optionInfer+  "c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.0.vb" "c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.1.vb" "c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.2.vb" "c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.3.vb" 
```

Microsoft (R) Visual Basic 编译器版本 9.0.30729.1 版权所有 (c) Microsoft Corporation。版权所有。

C:\Bugging\VandaagLijst\VandaagLijst\Views\home\List.aspx(1)：错误 BC30456：“标题”不是“ASP.views_home_list_aspx”的成员。

```
 __ctrl.Title = ""
        ~~~~~~~~~~~~ 
```

C:\Bugging\VandaagLijst\VandaagLijst\Views\home\List.aspx(1)：错误 BC30456：“InitializeCulture”不是“ASP.views_home_list_aspx”的成员。

```
 Me.InitializeCulture
        ~~~~~~~~~~~~~~~~~~~~ 
```

C:\Bugging\VandaagLijst\VandaagLijst\Views\home\List.aspx(1)：错误 BC30456：“MasterPageFile”不是“ASP.views_home_list_aspx”的成员。

```
 __ctrl.MasterPageFile = "~/Views/Shared/Site.Master"
        ~~~~~~~~~~~~~~~~~~~~~ 
```

C:\Bugging\VandaagLijst\VandaagLijst\Views\home\List.aspx(7)：错误 BC30456：“AddContentTemplate”不是“ASP.views_home_list_aspx”的成员。

```
 Me.AddContentTemplate("TitleContent", New System.Web.UI.CompiledTemplateBuilder(AddressOf Me.__BuildControlContent1))
        ~~~~~~~~~~~~~~~~~~~~~ 
```

C:\Bugging\VandaagLijst\VandaagLijst\Views\home\List.aspx(11)：错误 BC30456：“AddContentTemplate”不是“ASP.views_home_list_aspx”的成员。

```
 Me.AddContentTemplate("MainContent", New System.Web.UI.CompiledTemplateBuilder(AddressOf Me.__BuildControlContent2))
        ~~~~~~~~~~~~~~~~~~~~~ 
```

C:\Bugging\VandaagLijst\VandaagLijst\Views\home\List.aspx(13)：错误 BC30451：未声明名称“模型”。

```
 For Each item In Model
                        ~~~~~ 
```

c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.2.vb(42) : error BC30198: ')' 预期。

```
 Inherits System.Web.Mvc.ViewPage(of IEnumerable(of Models.TestClass)
                                                                       ~ 
```

c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.2.vb(43)：错误 BC30154：类 'views_home_list_aspx' 必须实现 'ReadOnly 属性 IsReusable( ) 作为接口“System.Web.IHttpHandler”的布尔值。实现属性必须具有匹配的“ReadOnly”或“WriteOnly”说明符。

```
 Implements System.Web.SessionState.IRequiresSessionState, System.Web.IHttpHandler
                                                              ~~~~~~~~~~~~~~~~~~~~~~~ 
```

c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.2.vb(43)：错误 BC30149：类 'views_home_list_aspx' 必须实现 'Sub ProcessRequest(context作为 HttpContext)' 用于接口 'System.Web.IHttpHandler'。

```
 Implements System.Web.SessionState.IRequiresSessionState, System.Web.IHttpHandler
                                                              ~~~~~~~~~~~~~~~~~~~~~~~ 
```

c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.2.vb(55)：错误 BC30311：无法转换“ASP.views_home_list_aspx”类型的值到“System.Web.Mvc.ViewPage”。

```
 CType(Me,Global.System.Web.Mvc.ViewPage).AppRelativeVirtualPath = "~/Views/home/List.aspx"
              ~~ 
```

c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.2.vb(57)：错误 BC30456：“ReadStringResource”不是“ASP. views_home_list_aspx'。

```
 Global.ASP.views_home_list_aspx.__stringResource = Me.ReadStringResource
                                                               ~~~~~~~~~~~~~~~~~~~~~ 
```

c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.2.vb(61)：错误 BC30456：“GetWrappedFileDependencies”不是“ASP. views_home_list_aspx'。

```
 Global.ASP.views_home_list_aspx.__fileDependencies = Me.GetWrappedFileDependencies(dependencies)
                                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 
```

c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.2.vb(68) : 错误 BC30456: 'Context' 不是 'ASP. views_home_list_aspx'。

```
 Return CType(Me.Context.Profile,System.Web.Profile.DefaultProfile)
                         ~~~~~~~~~~ 
```

c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.2.vb(74) : 错误 BC30456: 'Context' 不是 'ASP. views_home_list_aspx'。

```
 Return CType(Me.Context.ApplicationInstance,ASP.global_asax)
                         ~~~~~~~~~~ 
```

c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.2.vb(193) : 错误 BC30284: sub 'FrameworkInitialize' 不能被声明为 'Overrides' 因为它不会覆盖基类中的子类。

```
 Protected Overrides Sub FrameworkInitialize()
                            ~~~~~~~~~~~~~~~~~~~ 
```

c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.2.vb(195)：错误 BC30456：“SetStringResourcePointer”不是“ASP. views_home_list_aspx'。

```
 Me.SetStringResourcePointer(Global.ASP.views_home_list_aspx.__stringResource, 0)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~ 
```

c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.2.vb(197)：错误 BC30456：“AddWrappedFileDependencies”不是“ASP. views_home_list_aspx'。

```
 Me.AddWrappedFileDependencies(Global.ASP.views_home_list_aspx.__fileDependencies)
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 
```

c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.2.vb(201)：错误 BC30284：函数 'GetTypeHashCode' 不能被声明为'Overrides'，因为它不会覆盖基类中的函数。

```
 Public Overrides Function GetTypeHashCode() As Integer
                              ~~~~~~~~~~~~~~~ 
```

c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\root\24f69041\8efa8a35\App_Web_p7uswgud.2.vb(206) : 错误 BC30284: sub 'ProcessRequest' 不能被声明为 'Overrides' 因为它不会覆盖基类中的子类。

```
 Public Overrides Sub ProcessRequest(ByVal context As System.Web.HttpContext)
                         ~~~~~~~~~~~~~~ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T11:01:54.327

它在运行时工作。您仍然需要有一个引用的程序集。您如何为构建/VS.NET 环境引用程序集？

从这里你可以看到...

[http://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx](http://haacked.com/archive/2008/11/03/bin-deploy-aspnetmvc.aspx)

...默认是将这些程序集安装到 GAC 中，如果要对 MVC 程序集进行 bin 部署（例如，在共享托管情况下），则必须明确解决此问题。

# mysql - MySQL 错误“未选择数据库”

> ID：857281
> 
> 赞同：0
> 
> 时间：2009-05-13T10:54:15.803
> 
> 标签：mysql, apache, lamp

我在**localhost**上使用 LAMP 。我可以使用 mysql db 登录，进入主页（数据驱动），但是当我进入这个特定页面时，它很好，但是当我刷新错误是“未选择数据库”时，每个页面都会这样说。

我重新启动了 Apache、MySQL 服务器

浏览器 FF、IE、Chrome 都显示相同的错误，也清除了缓存。同时使用相同 LAMP 服务器的其他网站也可以正常工作。

现在这很奇怪

欢迎所有想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T10:56:34.023

主要页面是否正在使用`mysql_select_db("foo")`而这个特定页面没有？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T10:57:34.223

当您使用 php 连接时，您没有选择数据库（或选择失败）。是否可能使用了未正确填充的变量？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T10:57:47.983

在代码（PHP）的某处，默认数据库被重置，可能是在共享数据库连接上。我想这是您使用的产品中的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T11:08:30.460

尝试浏览它与数据库连接的代码并尝试提取数据。大多数时候，有一个配置文件定义了连接属性，如用户名、密码、数据库服务器、端口和要使用的数据库。

例如在 phpMyAdmin 中将信息保存在*library/Config.class.php*文件中。

# unix - 是否可以在 unix cut 命令中使用字符串作为分隔符？

> ID：857286
> 
> 赞同：21
> 
> 时间：2009-05-13T10:55:06.287
> 
> 标签：unix, cut, utilities

如果我想使用字符串作为分隔符来剪切文本列表，这可能吗？例如，我有一个目录，其中一个 shell 脚本列表调用相同的 perl 脚本说

```
abc.pl 
```

所以当我这样做的时候

```
$grep abc.pl * 
```

在那个目录中，它给了我以下结果

```
xyz.sh: abc.pl 1 2
xyz2.sh: abc.pl 2
mno.sh: abc.pl 3
pqr.sh: abc.pl 4 5 
```

我基本上想要“abc.pl”之后的所有输出（检查现在将哪些范围参数传递给perl）

当我尝试

```
$grep abc.pl * | cut -d'abc.pl' -f2 
```

或者

```
$grep abc.pl * | cut -d'abc\.pl' -f2 
```

它给了我

```
cut: invalid delimiter 
```

当我读 man for cut 时，它说

> delim 可以是多字节字符。

我在这里做什么/解释错了？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2017-05-17T20:35:29.353

尝试使用这个。

```
$grep abc.pl * | awk -F 'abc.pl' '{print $2}' 
```

-F fs --field-separator fs 使用 fs 作为输入字段分隔符（FS 预定义变量的值）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-13T11:12:28.817

> 当我阅读 man for cut 时，它声明 ... delim 可以是多字节字符。

多字节，但只有一个字符，而不是字符串。

```
canti:~$ ll | cut --delimiter="delim" -f 1,2
cut: the delimiter must be a single character
Try `cut --help' for more information.

canti:~$ cut --version  
cut (GNU coreutils) 5.97 
```

您只能将输出分隔符指定为字符串（在这种情况下无用）：

```
 --output-delimiter=STRING                                                          
        use STRING as the output delimiter the default is to use the input delimiter 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-13T10:56:55.177

为什么不使用`grep abc.pl | awk '{print $3, $4}'`？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T11:17:41.320

$ grep abc.pl * | 剪切-d''-f3-999

在这种情况下，只需使用空格字符作为分隔符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-15T10:50:56.157

或者你可以试试 Ruby：

```
grep abc.pl * | ruby -ne 'p $_.chomp.split("abc.pl").last' 
```

# architecture - IOC - 注入多个依赖项

> ID：857288
> 
> 赞同：0
> 
> 时间：2009-05-13T10:55:17.253
> 
> 标签：architecture, modeling

考虑以下内容：

```
public class DependencyA {}
public class DependencyB {}
public class DependencyC {}
public class DependencyD {}

public class Service1
{
    public Service1(DependencyA a, DependencyB b, DependencyC c, DependencyD d) { ... }
}
public class Service2
{
    public Service2(DependencyA a, DependencyB b, DependencyC c, DependencyD d) { ... }
}
public class Service3
{
    public Service3(DependencyA a, DependencyB b, DependencyC c, DependencyD d) { ... }
} 
```

我发现我的许多服务都依赖于多个通用组件，并且正在考虑实现如下所示的全部解决方案（全部通过 Windsor 连接）以节省服务构造函数中的代码重复。

```
public class DependencyContainer
{
    public DependencyA A { get; set; }
    public DependencyB B { get; set; }
    public DependencyC C { get; set; }
    public DependencyD D { get; set; }
}

public class Service1
{
    public Service1 (DependencyContainer container) { ... }
} 
```

或者，我可以创建一个 ServiceBase 类。

```
public class ServiceBase
{
    public DependancyA A { get; set; }
    public DependancyB B { get; set; }
    public DependancyC C { get; set; }
    public DependancyD D { get; set; }
}

public class Service1 : ServiceBase {} 
```

真正的问题是，这是否突出了服务中更广泛的设计问题？

也许我把 DI 走得太远了，但这些都是真正的依赖。

如果是这样，我该如何解决这个问题？如果不是，建议的解决方案是实现这一目标的有效方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T11:08:05.827

如果没有更广泛的背景，很难谈论这个问题，但您可能正在处理过于细粒度的依赖关系。这四个依赖项是否属于一起？它们作为一个有凝聚力的整体有意义吗？

如果是这样，您的方法非常有效。

如果没有，您的架构可能会碰壁。您可能以这样一种方式划分了您的域，即应该将责任放在一个或多个（隐式存在的）实体中，附加到其他实体。在这种情况下，您应该查看您的域并尝试识别这些重复出现的隐式实体，使它们显式并将行为移入其中。然而，这是一个更难的问题，并且非常特定于您的域和应用程序。

而且和IoC无关

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T14:02:57.663

对你的服务有太多的依赖可能表明你的服务做了太多的事情。换句话说，它可能违反了单一责任原则。

# php - 在 zend 部分循环中使用助手

> ID：857293
> 
> 赞同：0
> 
> 时间：2009-05-13T10:55:47.813
> 
> 标签：php, model-view-controller, zend-framework

我正在使用 Zend Framework 库/框架

在某些时候，我需要将一组文本（带有给定的 objectKey）提供给 partialloop 助手。

现在在 partialLoop 视图中我想使用 Zend Translate。

现在我明白 Zend Translate 不是 objectKey 的可访问性，但是有没有办法在这里使用 Zend Translate 甚至使用帮助器......？

提前谢谢，数学

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T14:53:22.763

translate() 视图助手在部分循环的视图脚本中仍然可用，因为它假定您已经使用键“Zend_Translate”将 Zend_Translate 对象放入注册表

问候，

抢...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T12:33:42.350

解决方案是将翻译放入[Zend Framework 和 Zend Translations](http://devzone.zend.com/article/4513-Zend-Framework-and-Translation)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T22:30:59.703

你可以试试这个。. 这样，“$translate”对象在所有视图中都可用，因此对 viewhelpers 也是可用的。

**引导程序.php**

```
protected function _initTranslate()
{
    $translate = new Zend_Translate(array(
        'adapter' => 'gettext',
        'content' => APPLICATION_PATH . '/locale/en-US.mo',
        'locale'  => 'en'
    ));

    Zend_Registry::set('translate', $translate);
    Zend_Form::setDefaultTranslator($translate);

    $this->bootstrap('view');
    $view = $this->getResource('view');
    $view->translate = $translate;
} 
```

希望能帮助到你！

# apache - conf 或 .htaccess——什么时候使用哪个？

> ID：857295
> 
> 赞同：0
> 
> 时间：2009-05-13T10:55:56.270
> 
> 标签：apache, .htaccess

Apache URL 重写逻辑可以写在 conf 或 .htaccess 文件中。哪个更适合，适合什么场合？假设我的 Web 根目录中有 .htaccess，并且在 Apache/conf 目录中也定义了一个 conf 文件，那么哪个文件会首先启动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T10:58:32.753

仅解决您问题的一部分：如果您不需要增加`.htaccess`不同目录中文件的灵活性，请不要使用它们；它们减慢了请求的处理速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T13:22:05.860

.htaccess 文件位于根文件夹中，可以很容易地与网页一起复制到另一个目的地。在托管环境中，配置文件可能并不总是可访问的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T13:10:36.860

.conf 文件 mod_rewrite 指令将首先出现——在 URL 到文件名的转换阶段之前。但在大多数情况下，这种差异将是微乎其微的。有性能方面的考虑，但它们只会影响流量非常大的网站或功能不足的硬件。

# asp.net - 在 asp.net 中添加管理子域

> ID：857303
> 
> 赞同：0
> 
> 时间：2009-05-13T10:57:57.873
> 
> 标签：asp.net, hosting, subdomain

我有一个我在家托管的网站。我想向我的网站添加一个子域，例如：admin.mywebsite.com 最好创建一个新项目并将 DNS 指向该项目，还是应该在当前项目下的文件夹中创建管理应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T12:16:18.713

我认为没有“最佳”选择，当然也不是在所有情况下都是最佳选择。

就个人而言，我会将管理员与主站点捆绑在一起，因为它将帮助您将 Web 应用程序中数据访问的更改与管理系统中的更改同步。当您部署新版本时，您知道您正在部署一起工作的管理站点和主站点。当你有两个时，你有两个项目要维护，两个要部署，你可能会发现在两者之间共享代码很痛苦。

您可能希望更严格地对站点进行分区，因此也许两个站点最适合您。如果您没有令人信服的理由进行分居，那么请不要失去上述好处。

# php - 如何在php中扣除时间？

> ID：857305
> 
> 赞同：1
> 
> 时间：2009-05-13T10:58:18.870
> 
> 标签：php, time

我写了这个

```
<?php
session_start();

if(!isset($_SESSION['now'])){
$_SESSION['now'] = time();
}

if(time() > ($_SESSION['now'] + 300)){
echo "15 minutes have passed";
} else {
echo "waiting";
}

?> 
```

我想要做的是，让用户等待 15 分钟，然后他/她才能查看页面。代码是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T11:01:28.210

是的，代码是正确的，您可以通过更小的时间限制来尝试它。

```
if(time() => ($_SESSION['now'] + 900)){ 
```

只是为了更加确定。

试试这个看看你的变量打印出来的是什么。

```
<?php
session_start();

if(!isset($_SESSION['now'])){
$_SESSION['now'] = time();
}

if(time() > ($_SESSION['now'] + 10)){
    echo date("d.m.Y H:i", time())."<br />";
    echo date("d.m.Y H:i", $_SESSION['now'])."<br />";
    echo "15 minutes have passed";
} else {
    echo date("d.m.Y H:i", time())."<br />";
    echo date("d.m.Y H:i", $_SESSION['now'])."<br />";
    echo "waiting";
}

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T11:06:23.740

time() 函数返回自 Epoch 以来的秒数。15 分钟等于 900 秒，而不是 300 秒。除此之外，代码是正确的。

# c# - 如何处理非致命错误情况

> ID：857307
> 
> 赞同：2
> 
> 时间：2009-05-13T10:58:35.047
> 
> 标签：c#, error-handling

我不确定这是否是重复的，但如果是，请随时关闭它。

背景：我正在编写的游戏有一个计时器组件，它支持停止和暂停方法。有问题的非严重错误案例正在执行诸如在计时器已经暂停时调用 Pause 之类的事情，这不是致命的，但不会导致方法名称所暗示的状态变化

问题：
1\. 一般如何表示非致命但异常情况？
2\. 在这些情况下我真的应该抛出异常吗？考虑到暂停时调用 Pause 不会造成任何伤害，我认为这有点笨拙
3\. 我是不是在想这个

**更新：**
基于这里的回复和评论是我选择采取的策略：在开发构建中会发生异常，因为我考虑了这些错误，我想抓住它们并纠正它们。我不能证明发布版本中的例外是合理的，因为这些错误不会破坏游戏状态，而且我认为应用程序的用户不会因为我未能正确编码而失去他们来之不易的分数

感谢您的所有回复，这对我来说很有教育意义。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T11:01:21.487

如果计时器已经暂停，我认为您可以忽略呼叫。假设该方法被称为 Pause() 那么客户端只需要在方法调用之后暂停计时器，并且只有在不会抛出异常时才应该抛出异常；该方法对定时器的当前状态没有任何要求。

另一方面，如果该方法被称为 ChangeTimerFromRunningToPaused() ，那么这意味着它仅在正在运行的计时器上调用它才有效。在这些情况下，我希望它会引发异常，通知客户端计时器未处于有效状态以处理此方法调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T11:32:15.430

针对其他答案，我会考虑抛出异常。如果是我的代码执行第二次`Pause()`调用，我可能会认为我的代码在它不应该调用的地方被破坏了。也许我错过了一张支票`if (Timer.IsRunning) { }`，我不想通过默默地忽略电话来隐藏这个错误。即使调用是由用户输入触发的——例如单击按钮——这也可能表明设计不佳，我应该看看它。也许该按钮应该被禁用。

我想得越多，想到第二次调用不应该是表示错误调用代码的异常的情况就越少。所以，是的，我会抛出异常。

**更新**

在评论中，Martin Harris 建议`Debug.Assert()`在开发过程中使用来获取错误。我认为这太弱了，因为您不会在生产代码中遇到错误。但是，您当然不想因为这个非致命错误而使生产中的应用程序崩溃。因此，我们将在堆栈中捕获此异常并生成错误报告，然后像什么都没发生一样恢复。

这里有两个goo链接。

[API 设计神话：异常是针对“异常错误”](http://blogs.msdn.com/kcwalina/archive/2008/07/17/ExceptionalError.aspx,)
[的编码恐怖 - 异常驱动的开发](https://blog.codinghorror.com/exception-driven-development/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T11:02:22.313

在这种情况下（将一些状态机移动到它已经存在的状态），我会跳过调用。通常，非致命错误或警告不应作为异常抛出，而是作为结果返回（可以忽略或处理，只要最适合情况）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T11:03:06.383

不，不要抛出异常，异常很重。再暂停也没什么不好。我看不出有什么害处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-14T10:52:17.367

[这看起来与我的一个问题](https://stackoverflow.com/questions/750675/how-to-handle-an-invalid-execution-state)相似（尽管不相同），也许那里的答案对您有帮助。

# perl - 如何在 Perl 中检查有效的日期格式？

> ID：857308
> 
> 赞同：3
> 
> 时间：2009-05-13T10:59:17.713
> 
> 标签：perl, date, format

我从数据库中的一个变量中获取日期字段，目前我正在使用以下代码检查日期是否为“yyyy-mm-dd”格式

```
if ( $dat =~ /\d{3,}-\d\d-\d\d/ ) 
```

我的问题是，有没有更好的方法来实现这一点。

非常感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T11:19:40.223

[OWASP Validation Regex Repository](http://www.owasp.org/index.php/OWASP_Validation_Regex_Repository)的美国格式日期版本，支持闰年：

> ^(?:(?:(?:0?[13578]|1[02])(/|-|.)31)\1|(?:(?:0?[1,3-9]|1 [0-2])(/|-|.)(?:29|30)\2))(?:(?:1[6-9]|[2-9]\d)?\d{2 })$|^(?:0?2(/|-|.)29\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0 [48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^( ?:(?:0?[1-9])|(?:1[0-2]))(/|-|.)(?:0?[1-9]|1\d|2[0 -8])\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$

正则[表达式库](http://regexlib.com/Search.aspx?k=date)包含一个更简单的版本，类似于其他建议，它被转换为您的问题：

```
^\d{4}-\d{1,2}-\d{1,2}$ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T20:31:49.590

正如其他人所指出的，如果这是来自数据库的日期字段，则它应该采用明确定义的格式，因此您可以使用简单的正则表达式，例如 toolkit 提供的正则表达式。

但这样做的缺点是它会接受无效的日期，例如 2009-02-30。同样，如果您正在处理成功地将其转换为数据库中日期类型字段的日期，那么您应该是安全的。

一种更强大的方法是使用 CPAN 中的众多日期/时间模块之一。Date::Manip 可能是一个不错的选择，特别是检查 ParseDate() 函数。

[http://metacpan.org/pod/Date::Manip](http://metacpan.org/pod/Date::Manip)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T11:06:45.923

怎么样

```
/\d{2}\d{2}?-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/ 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T11:05:29.063

\d 可以匹配来自其他语言的数字字符。YYY 真的是有效的年份吗？如果它必须是四位数，破折号，两位数，破折号，两位数，我更喜欢`/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/`or `/^[12][0-9]{3}-[0-9]{2}-[0-9]{2}$/`。请注意要匹配的字符串周围的空格字符。

当然，这并没有检查那里的字符的合理性，除了第二个例子中的第一个字符。如果需要，您最好将其传递给日期解析模块，然后检查其输出以获取逻辑结果。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-07-12T13:46:33.883

最好的轻量级解决方案是使用[Date::Calc](http://search.cpan.org/perldoc?Date%3A%3ACalc)的***check_date***子例程，这是一个示例：

```
use strict;
use warnings
use Date::Calc qw[check_date];

## string in YYYY-MM-DD format, you can have any format
## you like, just parse it
my @dt_dob = unpack("A4xA2xA2",$str_dob_date);

unless(check_date(@dt_dob)) {
    warn "Oops! invalid date!";
} 
```

我希望这会有所帮助:-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T11:05:35.723

那么你可以开始：

```
/\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|30|31)/ 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T20:55:47.523

我强烈建议您不要编写自己的正则表达式来执行此操作。日期/时间解析很简单，但有一些棘手的方面，这是一个已经解决了数百次的问题。您无需设计、编写和调试另一个解决方案。

如果你想要一个正则表达式，最好的解决方案可能是使用我的 Regexp::Common::time 插件用于 Regexp::Common 模块。您可以指定简单或复杂、严格或模糊的日期/时间匹配，它有一个非常广泛的测试套件。

如果您只想解析特定的日期格式，最好使用 Dave Rolsky 出色的 DateTime 模块的众多解析/格式化插件之一。

如果您想在匹配后验证日期/时间值，我建议您使用 Time::Normalize 模块。

希望这可以帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-27T07:20:43.640

我认为使用没有外部检查的正则表达式非常复杂！我用一个小子来得到它：

```
sub check_date {
    my $date_string = shift;

    # Check the string fromat and get year, month and day out of it.
    # Best to use a regex.
    return 0 unless $date_string =~ m/^(\d{4})-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])$/;

    # 31\. in a month with 30 days
    return 0 if ($3 >= 31 and ($2 == 4 or $2 == 6 or $2  == 9 or $2 == 11));
    # February 30\. or 31.
    return 0 if ($3 >= 30 and $2 == 2);
    # February 29\. in not a leap year.
    return 0 if ($2 == 2 and $3 == 29
                 and not ($1 % 4 == 0 and ($1 % 100 != 0 or $1 % 400 == 0)));

    # Date is valid
    return 1;
} 
```

[我从regular-expressions.info](https://www.regular-expressions.info/dates.html)得到了这个想法（以及大部分代码）。还有其他例子。

# c# - 自动填充/屏幕抓取多页网络表单

> ID：857317
> 
> 赞同：0
> 
> 时间：2009-05-13T11:01:55.993
> 
> 标签：c#, .net, asp.net

首先很抱歉，如果这是一个重复的问题，我花了一段时间搜索并且找不到任何看起来相同的东西。

我需要自动完成多页 web 表单，然后在 asp.net 系统中处理结果。理想的解决方案是创建一个接收一些数据的 Web 服务，然后通过网站对其进行处理并返回结果——然后我可以在任何需要此功能的应用程序中使用它。需要填写的表格比较复杂，还包括一些if/then/else的逻辑，比如：

1.  完整的个人资料
2.  输入邮政编码
3.  如果找到 1 个结果转到 5
4.  显示可能地址的列表，当一个选定的goto 5时
5.  如果地址时间 < 3 年，则显示新地址页面

等等

我创建了一个解决方案，它启动一个 ActiveX 浏览器控件并控制网站，就好像用户正在输入运行良好的数据一样但是受到并发用户的限制（任何 > 1 开始导致问题，> 2 不允许windows默认设置），有没有更好的方法呢？我听说过 Selenium 虽然没有使用过，但这是一个可能的解决方案吗？

我已经研究过使用 WebClient 类，并在帖子中将其用于屏幕抓取系统，但是我不知道如何将这些调用链接在一起以实现完整的工作流程。

仅供参考 - 这项工作是在网站所有者完全知情和同意的情况下进行的。他们有一系列开发任务，构建内部 API 并不具有这些功能，因此虽然他们对实现这种类型的解决方案感到高兴，但他们最终无法改变任何事情。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T11:13:33.510

[Watir](http://wtr.rubyforge.org/)有一个名为[WatiN](http://watin.sourceforge.net/)的 .NET 端口- 如果您还没有尝试过，可能值得一试。

# mysql - 让邮件进入 Rails 更快：Pop3 / Imap 还是直接 MySQL 查询？

> ID：857321
> 
> 赞同：0
> 
> 时间：2009-05-13T11:02:33.590
> 
> 标签：mysql, ruby-on-rails, email, pop3

我将重写我的另一个问题，因为问题案例有所改变：

如果我想从我的邮件服务器（不同的机器）获取邮件到我的 Rails 应用程序中进行处理，那么更快：

*   通过 net/Pop 或 net/imap 连接以下载邮件
*   将邮件服务器上的邮件存储在 MySQL 数据库中（使用 DBMail 之类的东西），然后直接连接到 MySQL 数据库
*   还是我还没有看到第三种选择？也许让邮件服务器本身将邮件发布到 Rails 应用程序？

谢谢你的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T14:23:00.487

不仅有第三个选项，还有很多:) 例如，您可以将邮件服务器的邮箱目录安装到您的 Rails 应用程序服务器中。然后它就像本地文件夹一样，您可以直接使用邮箱，这可能是最快的解决方案，因为不涉及 IMAP/POP 服务器软件。

而且如果你不沉迷于 ActiveRecord，你也可以使用[DataMapper 的 IMAP 适配器](http://github.com/vanpelt/dm-imap-adapter/tree/master)。但我没有这方面的经验，也不知道它是否有效。

# ruby-on-rails - Rails 应用程序中的 Twitter 身份验证 - 注销

> ID：857346
> 
> 赞同：0
> 
> 时间：2009-05-13T11:08:32.083
> 
> 标签：ruby-on-rails, authentication, twitter

我已经在我的 Rails 应用程序中实现了 twitter 身份验证，在我的本地开发盒上。但是我无法让应用程序注销。清除这两个cookie还不够吗？记住令牌和-twitterauth-session？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T19:31:25.850

我不熟悉 Twitter 身份验证的细节，但通常您应该`reset_session`在控制器中调用该方法。

# c++ - 从 NSIS 脚本调用 COM exe API

> ID：857347
> 
> 赞同：0
> 
> 时间：2009-05-13T11:08:37.467
> 
> 标签：c++, nsis

是否可以从 NSIS 脚本调用在 COM exe 服务器中公开的 api？我找不到任何文档。如果有人知道，请回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T14:04:52.140

基本语法如下所示：

```
System::Call "$0->2()" 
```

其中 $0 是 COM 对象，2 是 vtable 中方法的基于 0 的索引（2 是 Release）

[http://nsis.sourceforge.net/System_plug-in_readme#Usage_Examples_2](http://nsis.sourceforge.net/System_plug-in_readme#Usage_Examples_2)

# ruby-on-rails - 基于父模型从子模型中仅选择一行

> ID：857350
> 
> 赞同：0
> 
> 时间：2009-05-13T11:08:59.493
> 
> 标签：ruby-on-rails, activerecord

以下是2个模型之间的关联：

```
class FotoGossip < ActiveRecord::Base
   has_many :uploads
end

class Upload < ActiveRecord::Base
   belongs_to :foto_gossip
end

@latest_uploads = Upload.all(:include => :foto_gossip, :order => "created_at DESC", :limit => 5) 
```

它显示上传模型的最新 5 张照片。
但是，我想显示来自 Uploads 的 5 张图片，order_by created_date DESC 但每个 FotoGossip 只显示 1 张图片。
它类似于将最近的 FotoGossip 与 Uploads 模型中的一张照片组合在一起。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T13:27:45.430

我认为您可以像在中一样使用[ActiveRecord::Base#calculate](http://api.rubyonrails.org/classes/ActiveRecord/Calculations/ClassMethods.html#M002135)

```
@latest = Update.maximun(:creted_at,:distinct=>:foto_gossip_id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T06:45:02.437

以下 AR 查询解决了它。

```
@latest_uploads = Upload.all(:include => :foto_gossip, :order => "created_at DESC", :limit => 5, :group => :foto_gossip_id) 
```

神奇之处在于 :group 选项。

# language-agnostic - 如何修改地图元素键

> ID：857352
> 
> 赞同：1
> 
> 时间：2009-05-13T11:09:41.520
> 
> 标签：language-agnostic, map

我有一个包含元素映射的容器。

```
class MyContainer{
.....
Map<String,MyElement> elements = new ...
...
} 
```

每个元素都有 name 属性。地图中的键是元素的名称。即方法插入如下：

```
void addElement(MyElement elem){
    elements.put(elem.getName,elem);
 } 
```

我需要使用地图数据结构，因为我有很多基于元素名称的读取操作。

问题是我需要支持元素名称的修改。更改元素名称必须在地图中派生更改。（使用新键插入元素，否则我将无法找到该元素）

我想过两个选择：

1.  将 setName 方法添加到 MyElement 类，该方法将更新其名称已更改的容器。

2.  不要在 MyElement 类中添加 setName 方法，在容器中添加重命名元素方法，容器将负责更新地图中的元素名称和键。

选项 1 意味着我必须保持从每个元素到容器的引用。（这部分程序应该保持低内存占用）。

你说什么？你看到更好的选择了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T11:32:46.507

我会在元素的 setName 方法上触发属性更改通知，并在正在侦听该通知的容器对象中处理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T11:35:00.340

首先，请注意，如果`MyElement`可以想象可以在没有 的上下文中使用`MyContainer`，则选项 1 不适用。

`MyContainer`与 有明显的关系`MyElement`，因为它的代码`MyElement`通过它的映射引用实例。反之则不然：中的代码`MyElement`不需要引用`MyContainer`. 所以选项2更好。

不过，也许您可​​以选择第三种混合选项：

*   `MyElement`有一个`rename`只更改自己名称的方法，并且`MyContainer`有一个`rename`调用`MyElement.rename`映射中的对象并将其移动到新键的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T11:44:48.357

If the element is only used in this container.

Put the rename operation on the container.

Make the rename method on the element private so another programmer can't accidentally change just the element and forget to update the container.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T11:55:16.920

选项 2 是最简单和最有效的，因此是我的选择。显然你知道这一点，那么困境是什么？

另一种选择是创建一个 MyString 类，它将作为 std::string 和对 MyContainer 的引用。MyString 的修改方法将负责重新映射，并且您的占用空间仍然很小。例如：

```
class MyString;
class MyElement {
...
   MyString name;
...
};

MyContainer * aContainer = new MyContainer;
new MyElement(MyString("Yaron Cohen",aContainer), ...); /* MyString need to be explicit only upon MyElement construction. takes care of inserting into container. */
...
MyElement * someElement = aContainer["Yaron Cohen"]; /* just std::string for lookup */
someElement->name = "Dana International": /* MyString takes care of remapping */ 
```

请注意，此选项也支持多个键和容器，例如 FirstName、LastName（如果只有这些是唯一的......）

另一种选择是如果 MyContainer 是单例。

要考虑的另一件事是，名称多久更改一次？

# .net - 如何在命令行使用 .NET Framework 编译器编译程序。？

> ID：857355
> 
> 赞同：2
> 
> 时间：2009-05-13T11:11:01.533
> 
> 标签：.net, visual-c++, c++-cli

我想使用 .NET2.0 编译器编译一个 c++ 程序。所以我导航到 c:\windows\Microsoft.Netframework\2.0.57\ 并使用 csc 编译器进行编译。

它显示了很多错误。

但它编译 csharp 文件。但在视觉工作室它编译。所以我认为在安装了 Visual Studio C++ 编译器时我是这样认为的。

### 文件名 test.cpp

使用命名空间系统；

```
class test

{

   void disp()

   {

      Console::WriteLine("Hello");
   }

 };

 void main()

{

  test *t=new test();

   t->disp();

} 
```

所以请告诉我是否可以在命令提示符下使用基于 .net framework 2.0 的编译器编译 c++ 文件以及如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T11:14:17.363

`csc`是 C# 编译器，所以你不应该对它不编译 C++ 感到惊讶。

使用`cl`（C++ 编译器）和`/clr`开关来编译 C++/CLI 代码。或者，如果您有解决方案/项目文件，请使用`msbuild`.

请注意，与 C# 编译器不同，C++ 编译器不随 .NET 一起提供。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T11:15:27.627

C# 编译器不喜欢 C++ 代码应该不足为奇。你不妨喂它 vb / java / 不管 - 它不会是合法的。

要编译 C++，您需要 C++ 编译器，可能来自 C++ Express Edition。请注意，为了将其编译为混合/IL，它将被托管 C++。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T11:16:02.663

csc 是 csharp 的编译器，而不是 C++

从命令行编译的最简单方法是使用 msbuild，并将您的项目（或解决方案文件）的名称传递给它。

# html - 字段集内的字段集

> ID：857363
> 
> 赞同：44
> 
> 时间：2009-05-13T11:13:21.623
> 
> 标签：html

我认为不允许嵌入字段集（另一个字段集中的字段集） - 但我想确认一下。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-05-13T11:17:20.837

```
<!ELEMENT FIELDSET - - (#PCDATA,LEGEND,(%flow;)*) -- form control group --> 
```

[字段集必须包含一个图例，后跟零个或多个 %flow 元素](http://www.w3.org/TR/html4/interact/forms.html#h-17.10)

```
<!ENTITY % flow "%block; | %inline;"> 
```

流包括 %block

```
<!ENTITY % block
 "P | %heading; | %list; | %preformatted; | DL | DIV | NOSCRIPT |
  BLOCKQUOTE | FORM | HR | TABLE | FIELDSET | ADDRESS"> 
```

块包括 FIELDSET

没事。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-05-13T11:20:07.010

是的你可以。[http://validator.w3.org/](http://validator.w3.org/)上的 W3C 验证器对此很满意：

```
<html><head><title>test</title></head>
<body><form action='go'>
<fieldset><legend>1</legend>
    <fieldset><legend>2</legend>
    <input type='text'>
    </fieldset>
</fieldset>
</form>
</body></html> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T11:18:55.013

是的，你可以这样做。更多信息[http://reference.sitepoint.com/html/fieldset](http://reference.sitepoint.com/html/fieldset)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-13T11:14:37.563

不，这是合法的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-07T22:29:20.830

这是合法的，事实上我已经使用过很多次了

# wpf - WPF - 来自 ListBox DataTemplate 内的两个源的多重绑定

> ID：857365
> 
> 赞同：2
> 
> 时间：2009-05-13T11:13:49.283
> 
> 标签：wpf, image, binding, listbox, itemssource

我试图环顾四周，看看我是否遗漏了一些基本的东西，但我似乎无法理解我做错了什么。

我有一个列表框，我想将 itemssource 绑定到数据集中的照片集合视图。问题是，我需要从 MasterView CollectionView 中获取图像所在的目录，以及从 DetailView CollectionView 中获取各个文件名。所以我定义了资源：

```
<CollectionViewSource x:Key="MasterView" />
<CollectionViewSource Source="{Binding Source={StaticResource MasterView}, Path='tblGallery_tblPictures'}" x:Key="DetailView" /> 
```

这似乎没有问题，我可以浏览数据集并查看主数据和详细数据。

为了获得完整的图像路径，我发现我需要一个多重绑定来将两者放在一起，并成功创建了一个：

```
 <ListBox HorizontalAlignment="Stretch"
    VerticalAlignment="Stretch"
    ItemsSource="{Binding Source={StaticResource DetailView}}">
    <ListBox.ItemTemplate>
       <DataTemplate>
         <Image Width="120"
            Stretch="Uniform"
            Margin="8,8,8,8">
            <Image.Source>
              <BitmapImage DecodePixelWidth="120">
                <BitmapImage.UriSource>
                  <MultiBinding Converter="{StaticResource imagePathConverter}">
                    <Binding Source="{StaticResource MasterView}" Path="galleryLocation" />
                    <Binding Path="pictureFileName" />
                  </MultiBinding>
                 </BitmapImage.UriSource>
                </BitmapImage>
               </Image.Source>
             </Image>                        
          </DataTemplate>
       </ListBox.ItemTemplate>
     <ListBox.ItemsPanel>

     <ItemsPanelTemplate>
        <WrapPanel Orientation="Horizontal" HorizontalAlignment="Stretch" />
     </ItemsPanelTemplate>
   </ListBox.ItemsPanel>
 </ListBox>

 Public Function Convert(ByVal values() As Object, ByVal targetType As System.Type, ByVal parameter As Object, ByVal culture As System.Globalization.CultureInfo) As Object Implements System.Windows.Data.IMultiValueConverter.Convert

    If values.Count() <> 2 Then
        Throw New InvalidOperationException("Correct Values Not Provided")
    End If

    Dim directory As String
    Dim fileName As String
    Dim imgUri As Uri = Nothing

    If TypeOf values(0) Is String And TypeOf values(1) Is String Then
        directory = CType(values(0), String)
        fileName = CType(values(1), String)

        If directory <> "" And fileName <> "" Then
            If directory.LastIndexOf("/") = directory.Length - 1 Then
                imgUri = New Uri(directory & fileName, UriKind.Absolute)
            Else
                imgUri = New Uri(directory & "/" & fileName, UriKind.Absolute)
            End If

        End If
    End If

    Return (imgUri)

End Function 
```

我对后续代码的假设是，DataTemplate 中的 MultiBinding 可以访问列表框中定义为 ItemsSource 的 BindingSource。但是，当我查看 MultiValueConverter 代码时，它只传递来自 MasterView 的数据和第二个值的通用对象。

为了看看我是否可以让它工作，我在多重绑定中添加了详细的源信息：

```
<MultiBinding Converter="{StaticResource imagePathConverter}">
  <Binding Source="{StaticResource MasterView}" Path="galleryLocation" />
  <Binding Source="{StaticResource DetailView}" Path="pictureFileName" />
</MultiBinding> 
```

这至少让我看到列表框中有 5 张图片，但它们都是同一张图片。似乎对 DetailView CollectionView 的多重绑定访问只显示了第一项。

有没有办法将“pictureFileName”链接到当前的 ItemsSource 项，以便显示正确的图片？

谢谢！

乔什

# javascript - 从节点列表转换时的for循环设置长度变量

> ID：857366
> 
> 赞同：2
> 
> 时间：2009-05-13T11:13:49.593
> 
> 标签：javascript

呸！那是一个很长的标题。

我正在阅读 WROX 为 Web 开发人员提供的专业 JavaScript 书籍，我遇到了这个示例代码，我只是想知道这是否是最佳实践：

```
function convertToArray(nodes) {
   array = new Array();
   for (var i=0, len=nodes.length; i < len; i++) {
      array.push(nodes[i]);
   }
   return array;
} 
```

让我摸不着头脑的是“len=nodes.length”。我认为 for 循环中的第一句话只运行一次，我错了吗？是否有理由在运行之前将变量 (len) 设置为 nodeList 的长度？你也会对普通数组这样做吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T11:20:14.763

那是出于性能原因。局部变量更快有几个原因：

*   需要在循环中一直访问长度，每次迭代一次；
*   局部变量查找比成员查找快；
*   If`nodes`是一个数组，then`.length`是一个神奇的属性，它可能需要比成员变量更长的时间来检索。
*   如果`nodes`是一个 ActiveX 对象，那么`.length`可能会导致对该对象的方法调用，因此这是所有操作中最昂贵的操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T11:35:51.010

虽然我们正在讨论微优化，但以下内容应该更快：

```
function convertToArray(nodes) {
    var i = nodes.length,
        array = new Array(i); // potentially faster than `array = []`
                              //  --  see comments

    while(i--)
        array[i] = nodes[i];

    return array;
} 
```

它需要少一个局部变量，使用 a`while`而不是`for`循环，并使用数组赋值而不是函数调用`push()`。

另外，因为~~我们倒计时~~我们预先分配了数组的槽，数组的长度不必在每个迭代步骤中改变，~~但只在第一个~~.

# svn - ReviewClipse 与 Zend Studio for Eclipse

> ID：857371
> 
> 赞同：1
> 
> 时间：2009-05-13T11:14:47.237
> 
> 标签：svn, eclipse-plugin

我在最新的 Zend Studio (6.1.2) 中安装了最新的 ReviewClipse 和最新的 Subeclipse 插件。我已经通过 Subeclipse 连接到 Subversion，但我没有得到帮助文件建议的 Review 上下文菜单：“您可以从 Review - Review Project 下的 Subversion 共享项目的上下文菜单中启动审查向导...您的项目必须与 Subversion 共享，并且与存储库的连接有效。”

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T11:34:46.440

我在 Java Perspective 的 Package Explorer 中找到了 Review Context 菜单。

# jquery - Jquery.cascade 插件如何匹配文本而不是值？

> ID：857373
> 
> 赞同：0
> 
> 时间：2009-05-13T11:14:59.407
> 
> 标签：jquery, plugins, cascade

我正在使用[这里](http://devlicio.us/blogs/mike_nichols/archive/2008/05/25/jquery-cascade-cascading-values-from-forms.aspx)的插件。谢谢你。

我将它用于多个下拉菜单。问题是我希望它根据文本过滤源列表，但是插件仅按值过滤。相信它设置在这一行：

`.filter(function() { return opt.match.call(this, opt.getParentValue(parent)); })`

*   opt.match.call - 在下拉列表中调用匹配方法
*   this - 这是要过滤的列表
*   opt.getParentValue(parent) - 返回所选值的 id，我想改变这个。

我只是不知道我应该如何更改插件本身以提供 selectedItem 或直接提供文本。

任何想法都值得赞赏。提前致谢。干杯，X。

**编辑：**
最后我找到了解决方案。我需要像这样修改 jquery.cascade.js：

`getParentValue: function(parent) { return $(parent+" option:selected"); }`

然后我可以得到文本值。:-) 所以我的匹配标准如下所示：

`function matchStates(selectedItem) {
return this.When == selectedItem.val() && this.Where == selectedItem.text();
};`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T12:09:43.247

您想自己定义一个函数并在设置级联时将其传递给选项。

```
 jQuery("#your_child").cascade("#parent_control", {
        getParentValue: function(parent) {
            // write code to return the text of
            // #parent_control instead of the value here
        }
    }); 
```

# firefox - 在 Firefox 中访问 IP 地址时发送 Host 标头

> ID：857376
> 
> 赞同：14
> 
> 时间：2009-05-13T11:15:34.023
> 
> 标签：firefox, testing, http-headers

这不是一个真正的编程问题，而是更多关于编程和测试工具的问题。

有没有办法让 Firefox 发送标头

```
Host: mydomain.com 
```

访问页面时

```
http://ip.address.goes.here/ 
```

以便 Apache 可以将其路由到正确的 VirtualHost？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T11:22:34.137

您可以将主机名和 IP 地址添加到主机文件中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T11:20:53.547

您是否尝试过[Modify Headers Firefox 扩展](https://addons.mozilla.org/en-US/firefox/addon/967)？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T11:24:05.117

如果您正在创建站点并希望将主机标头映射到 IP（可能是您的本地开发盒）以进行测试，那么您应该考虑[改为编辑主机文件。](http://en.wikipedia.org/wiki/Hosts_file)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T11:22:07.723

只需在主机文件中设置一个条目。一直为我工作:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T11:21:40.050

我猜你可以使用[TamperData](https://addons.mozilla.org/en-US/firefox/addon/966)扩展来手动添加它。

# msbuild - 使用 msbuild 构建并动态设置项目引用

> ID：857379
> 
> 赞同：8
> 
> 时间：2009-05-13T11:16:49.293
> 
> 标签：msbuild, reference

我有几个引用 SQL Server 程序集的项目。对于 SQL Server 2005 和 SQL Server 2008，我目前维护 2 个项目文件，它们指向相同的源文件，唯一的区别是对 SQL Server 程序集的引用。

有什么方法可以让我只维护一个项目并在我的构建脚本中动态指定引用？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-12-02T22:46:46.417

寻找解决您遇到的相同问题的解决方案时，我提出了在 ItemGroup 上设置条件的建议解决方案。但这有一个副作用，因为在 Visual Studio 引用中我可以看到这两个引用，这也影响了 ReSharper。

我终于使用了选择其他时选择，并且我不再对 ReSharper 和 Visual Studio 显示两个参考有任何问题。

```
<Choose>
  <When Condition=" '$(Configuration)' == 'client1DeployClickOnce' ">
    <ItemGroup>
        <ProjectReferenceInclude="..\client1\app.Controls\app.Controls.csproj">
        <Project>{A7714633-66D7-4099-A255-5A911DB7BED8}</Project>
        <Name>app.Controls %28Sources\client1\app.Controls%29</Name>
      </ProjectReference>
    </ItemGroup>
  </When>
  <Otherwise>
    <ItemGroup>
      <ProjectReference Include="..\app.Controls\app.Controls.csproj">
        <Project>{2E6D4065-E042-44B9-A569-FA1C36F1BDCE}</Project>
        <Name>app.Controls %28Sources\app.Controls%29</Name>
      </ProjectReference>
    </ItemGroup>
  </Otherwise>
</Choose> 
```

您可能会在我的博客文章中了解更多相关信息：[在您的 MSBuild 项目文件中使用 Condition 的 ProjectReference][https://laurentkempe.com/2009/12/03/ProjectReference-with-Condition-in-your-MSBuild-project-文件/]

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T22:08:37.403

Every MSBuild element (*ok almost every*) can have a [Condition](http://msdn.microsoft.com/en-us/library/7szfhaft.aspx) associated with it. What I would suggest is that you edit the project file (which is an MSBuild file itself) and place all the SQL server references in an ItemGroup which has a condition on it for instance:

```
 <ItemGroup Condition="'$(SqlServerTargetEdition)'=='2005'">
    <!-- SQL Server 2005 References here -->
    <Reference Include="..."/>
  </ItemGroup> 
```

And another ItemGroup for Sql server 2008:

```
 <ItemGroup Condition="'$(SqlServerTargetEdition)'=='2008'">
    <!-- SQL Server 2008 References here -->
    <Reference Include="..."/>
  </ItemGroup> 
```

You should provide a default value for the property SqlServerTargetEdition before those items are declared. Then at the command line you can override that value using the /p switch when invoking [msbuild.exe](http://msdn.microsoft.com/en-us/library/ms164311.aspx).

Sayed Ibrahim Hashimi

My Book: [Inside the Microsoft Build Engine : Using MSBuild and Team Foundation Build](https://rads.stackoverflow.com/amzn/click/com/0735626286)

# java - 用Java表示Excel工作表值的好方法

> ID：857380
> 
> 赞同：1
> 
> 时间：2009-05-13T11:16:57.310
> 
> 标签：java, excel, dto, apache-poi

考虑到我有一个以下格式的 excel 表：

**人** **年龄**
Foo 29
Bar 27

现在我想读取这些值（使用 POI HSSF）并且必须处理它们。最好的方法是什么？

请注意，我的应用程序中没有对象人员，因为 excel 表中可能出现的值是任意的（即它可能不是人名和年龄）。所以，我需要使用某种 HashMap 来存储这些值。如果多行，有一个 List 好吗！？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T14:01:49.303

```
public class Grid {
    private Row headerColumns;
    private List<Row> dataRows;

    public Grid() {
        dataRows = new LinkedList<Row>();
    }

    public Grid(int rowCount) {
        dataRows = new ArrayList<Row>(rowCount);
    }

    public void addHeaderRow(List<String> headers) {
        this.headerColumns = new Row(headers);
    }

    public void addDataRow(List<String> data) {
        this.dataRows.add( new Row(data) );
    }

    public List<Row> getAllData() {
        List<Row> data = new ArrayList<Row>(1+dataRows.size());
        data.add(this.headerColumns);
        data.addAll(dataRows);
        return data;
    }

    public Row getHeaderColumns() {
        return headerColumns;
    }

    public List<Row> getDataRows() {
        return dataRows;
    }
}

class Row {
    private List<String> data;

    public Row(List<String> data) {
        this.data = data;
    }

    public void addColumn(String columnData) {
        data.add(columnData);
    }

    public List<String> getData() {
        return data;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T11:19:30.163

如果定义了格式，请创建一个包含所有这些字段的类。

如果未定义格式，则传递行，或列表，甚至 DOM 从 excel 到 dom 转换。你没有选择。我建议只使用 POI 的原生 Row 和 Cell 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T11:54:21.353

是的，如果您有多个键值，则不能使用 map。而且我没有为这个问题找到一些内置类。您可以尝试编写某种包装器。如果您不关心速度，请使用如下简单的二维数组：

```
String[][] filter = new String[initial width][initial height]; 
```

它可以是 Object 而不是 String；

# php - XML 与 MySQL 直接查询性能

> ID：857384
> 
> 赞同：0
> 
> 时间：2009-05-13T11:18:14.250
> 
> 标签：php, mysql, xml, performance

如果有的话，使用 XML 作为 Php 应用程序 (A) 和通过另一个 Php 应用程序 (B) 的 MySQL 数据库之间的接口而不是从 Php 应用程序 (A) 直接查询数据库的性能开销是多少？

应用程序 (A) 和数据库在同一台服务器上和不同的服务器上之间会有多大的变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T11:30:23.607

这里有许多变量会影响性能。通常，数据库连接比传输和解析 XML 更快，但网络延迟、消息大小和数据复杂性等问题都会影响速度的快慢。

另一方面，只有一个程序与数据库交互有一些很好的理由，比如数据完整性，这可能使开销成本值得支付。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T14:06:31.840

XML 是一种相当繁重的语言，因为它有很多额外的数据来传达特定的数据（即开始/结束标签）。此处理占用大量 CPU，因此对于较大的消息，它会显着影响性能。如果消息大小足够小，性能应该不会太差，您只需要考虑生成 XML 的内容以及处理它的内容。

在我看来，MySQL 会更快、更容易开发、更容易管理（存储/更新/删除）。

# panel - 更新面板中更新进度完成后如何调用函数？

> ID：857385
> 
> 赞同：0
> 
> 时间：2009-05-13T11:18:29.977
> 
> 标签：panel, progress

我在更新面板中有一个按钮。另一个函数说 function1 在这个按钮的点击事件中被执行。一旦function1完成执行，我想调用一个javascript函数。我如何知道 function1 何时完成执行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T11:24:17.830

假设 function1 在服务器上运行，而 function2 在客户端上，处理 Sys.WebForms.PageRequestManager MSAjax 类的 endRequest 事件。

# css - 更好的 css div 对齐（3 列，中大）

> ID：857394
> 
> 赞同：0
> 
> 时间：2009-05-13T11:21:29.160
> 
> 标签：css

我希望 html (div.main) 的主要文本接近标准纸张尺寸（8.5 英寸 - 两者的边距为 1 英寸 = 6.5）

我希望我的侧边栏菜单不在此范围内。所以我想出了如何将页面锁定在 1024 分辨率附近（我使用 996 像素，所以我有空间放置垂直滚动条）

这在 1024 和 1280 宽度分辨率下看起来相当不错，但我不确定更高。另外，也许你们有一个建议如何更好地对齐（将 6.5 英寸保持在中心）

索引.html

```
<div>
    <div class="menu">
    <ul>
    <li><a href="">Home</a></li>
    <li>Test</li>
    <li>Test 2</li>
    <li>Contact</li>
    </ul>
    </div>
</div>

<div class="row">
<div class="dummy">&nbsp;</div>

<div class="main">
lots of textlots of textlots of textlots of textlots of textlots of textlots of textlots of text
...
lots of textlots of textlots of textlots of textlots of textlots of textlots of textlots of text
</div>

<div class="sidebar">
Some links here</br>
<br>Some links here</br>
<br>Some links here</br>
<br>Some links here</br>
<br>Some links here</br>
</div>
</div>

</body>
</html> 
```

我的.css：

```
div.row
{
    width: 996px;
    margin-left: auto;
    margin-right: auto;
}

div.dummy {
    float: left;
    padding-right: 148px;
}

div.sidebar {
    float: left;
    padding-left: 32px;
}

div.main
{
    width: 6.5in;
    float: left;
}

.menu    { padding-bottom: 60px; }
.menu ul { margin:0px auto; }
.menu li {
    width: 22%;
    text-align:center;
    display:block;
    float:left;
    }
.menu a  { display:block; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-28T19:14:31.363

像素是可变宽度的，完全取决于查看设备。例如，在极端情况下，iPhone 的宽度约为 2 英寸，宽度为 380 像素。一个典型的 15 英寸显示器大约是 8 英寸宽和 800 像素宽度。所以 iPhone 大约是分辨率的 4 倍。

此外，如果您将同一台显示器的分辨率从 800x600 更改为 1024x768，您现在可以在同一物理空间中拥有更多像素。这意味着之前显示为 7 英寸的内容现在可能显示为大约 5 英寸。

解决这个问题的唯一方法是使用`pt`s 而不是`px`s。72pts 大约是 1 英寸。我个人从不使用`pt`s，但听说浏览器在处理使用它们的 CSS 时非常不一致。

因此，要回答您的具体问题，您需要在页面上使用足以包含侧边栏和`#main`div 的固定大小。一个浮动到左边，另一个浮动到右边。

# c++ - 预处理器指令的替代方案

> ID：857395
> 
> 赞同：6
> 
> 时间：2009-05-13T11:21:32.607
> 
> 标签：c++, c-preprocessor

我从事在 Symbian 平台上开发 C++ 手机应用程序。其中一项要求是它必须适用于从第 2 版手机到第 5 版手机的所有 Symbian 手机。现在，不同版本的 Symbian SDK 存在差异。我必须使用预处理器指令有条件地编译与构建应用程序的 SDK 相关的代码，如下所示：

```
#ifdef S60_2nd_ED
  Code
#elif S60_3rd_ED
  Code
#else
  Code 
```

现在，由于我正在开发的应用程序并非微不足道，它很快就会增长到数万行代码，并且像上面这样的预处理器指令将遍布各处。我想知道在这种情况下是否有任何替代方法或者可能是使用这些预处理器指令的更好方法。

请帮忙。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-13T11:26:44.283

嗯......这取决于差异的确切性质。如果可以将它们抽象出来并将它们隔离到特定的类中，那么您可以走这条路。这将意味着拥有某些类的特定于版本的实现，并切换整个实现，而不仅仅是这里和那里的几行。

你会有

*   我的类.h
*   MyClass_S60_2nd.cpp
*   MyClass_S60_3rd.cpp

等等。您可以选择要编译的 CPP 文件，方法是使用上面的 #ifdefs 将整个内部包装起来，或者我在构建级别（通过 Makefile 或其他方式）控制在为各种目标构建时包含哪些文件。

根据更改的性质，这可能要干净得多。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-13T11:30:07.290

在我们公司，我们编写了很多跨平台代码（win32/ps3/xbox/etc 的游戏开发）。
为了尽可能避免与平台相关的宏，我们通常使用以下几个技巧：

*   将平台相关的代码提取到平台抽象库中，这些库在不同平台上具有相同的接口，但实现不同；
*   将代码拆分为不同平台的不同 .cpp 文件（例如：“pipe.h”、“pipe_common.cpp”、“pipe_linux.cpp”、“pipe_win32.cpp”……）；
*   使用宏和辅助函数来统一特定于平台的函数调用（例如：“#define usleep(X) Sleep((X)/1000u)”）；
*   使用跨平台的第三方库。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-13T14:00:51.897

我一直在你所在的地方。

一个技巧是，即使您要在代码中设置条件，也不要打开 Symbian 版本。这使得将来难以添加对新版本的支持，或者难以为在某些方面不寻常的手机进行定制。相反，确定您所依赖的实际属性是什么，围绕这些编写代码，然后包含一个头文件，该文件执行以下操作：

```
#if S60_3rd_ED
    #define CAF_AGENT 1
    #define HTTP_FILE_UPLOAD 1
#elif S60_2nd_ED
    #define CAF_AGENT 0
    #if S60_2nd_ED_FP2
        #define HTTP_FILE_UPLOAD 1
    #else
        #define HTTP_FILE_UPLOAD 0
    #endif
#endif 
```

等等。显然，如果您愿意，您可以按功能而不是按版本对定义进行分组，每个配置具有完全不同的标头，或者任何适合您的方案。

我们也为您继承的 UI 类进行了定义，因此 S60 和 UIQ 之间有一些共同的 UI 代码。事实上，由于产品是什么，我们没有太多与 UI 相关的代码，所以其中相当一部分是常见的。

不过，正如其他人所说，最好将变量行为集中到类和函数中，并链接不同的版本。

[编辑回应评论：

我们非常努力地避免做任何依赖于分辨率的事情——幸运的是，特定的应用程序并没有让这变得太困难，所以我们有限的 UI 非常通用。我们打开屏幕分辨率的主要目的是用于启动画面/背景图像等。我们有一个脚本来预处理构建文件，它将宽度和高度替换为文件名，splash_240x320.bmp 或其他。我们实际上是手动生成的图像，因为没有那么多不同的尺寸，而且图像也不会经常变化。相同的脚本生成了一个 .h 文件，其中包含生成文件生成中使用的大多数值的#defines。

This is for per-device builds: we also had more generic SIS files which just resized images on the fly, but we often had requirements on installed size (ROM was sometimes quite limited, which matters if your app is part of the base device image), and resizing images was one way to keep it down a bit. To support screen rotation on N92, Z8, etc, we still needed portrait and landscape versions of some images, since flipping aspect ratio doesn't give as good results as resizing to the same or similar ratio...]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T11:27:53.907

如果可能，您可以尝试为所有平台定义一个通用接口。然后，实现每个平台的接口。

使用预处理器指令选择正确的实现。

这样，您将在代码中更少的地方使用平台选择指令（理想情况下，在一个地方，明确地在声明接口的头文件中）。

这意味着类似：

```
commoninterface.h /* declaring the common interface API. Platform identification preprocessor directives might be needed for things like common type definitions */
platform1.c /*specific implementation*/
platform2.c /*specific implementation*/ 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T11:37:45.703

看看[SQLite](http://www.sqlite.org/download.html)。他们有同样的问题。他们将依赖于平台的东西移动到单独的文件中，并通过使用排除整个文件内容的预处理器指令来有效地编译只需要的东西。这是一种广泛使用的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T11:37:25.077

不知道替代方案，但是您可以做的是，为不同版本的操作系统使用不同的文件。例子

`#ifdef S60_2nd_ED`

`#include "graphics2"`

`#elif S60_3rd_ED`

`#include "graphics3"`

`#else`

`#include "graphics"`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T12:53:51.817

您可以像他们为 linux 内核中的程序集定义所做的那样。每个架构都有自己的目录（例如 asm-x86）。所有这些文件夹都聚集了相同的高级头文件，呈现相同的界面。配置内核时，会创建一个名为 asm 的链接，指向相应的 asm-arch 目录。这样，所有 C 文件都包含 .

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-13T13:09:32.340

S60 2nd ed 和 3rd ed 应用程序之间存在一些不限于代码的差异：应用程序资源文件不同，图形格式和打包它们的工具不同，mmp 文件在许多方面不同。

根据我的经验，不要尝试过多地自动化它，而是为第 2 版和第 3 版提供单独的构建脚本。在代码级别，与拥有通用抽象 API 的类的区别在于，仅在极少数情况下使用标志。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-13T13:47:46.893

您应该尽量避免通过代码传播#ifs。

相当; 在头文件中使用#if 来定义替代宏，然后在代码中使用单个宏。

这种方法使您可以使代码更具可读性。

例子：

```
 Plop.h
 ======

 #if V1
 #define    MAKE_CALL(X,Y)    makeCallV1(X,Y)
 #elif V2
 #define    MAKE_CALL(X,Y)    makeCallV2("Plop",X,222,Y)
 ....
 #endif

 Plop.cpp
 ========

 if (pushPlop)
 {
     MAKE_CALL(911,"Help");
 } 
```

为了帮助将这个拆分版本的特定代码转换为它们自己的函数，然后使用宏来激活如上所示的函数。您还可以将 SDK 的更改部分包装在您自己的类中，以尝试提供一致的接口，然后您的所有差异都在包装类中进行管理，从而使您的代码更整洁。

# java - 访问servlet时Tomcat java.lang.NoClassDefFoundError下？

> ID：857409
> 
> 赞同：7
> 
> 时间：2009-05-13T11:24:28.937
> 
> 标签：java, eclipse, tomcat, xstream

我正在 Eclipse 中编写一个 Web 应用程序，并且我正在使用 XStream 序列化库来生成我的 JSON。

我已经将构建 JSON 的代码封装在一个由我的 serverlet 调用的类中。然后封装的类有一个主要的测试方法，当我运行它时，一切似乎都正常。

但是，当我从我的servelet 调用类时，我得到一个`java.lang.NoClassDefFoundError`错误，说我没有加载XStream 库。我假设我的构建路径错误，但我已将 XStream 库设置在项目的构建路径中，据我所知它应该可以工作。

这里可能出了什么问题？

以下是确切的例外：

```
java.lang.ClassNotFoundException: com.thoughtworks.xstream.io.HierarchicalStreamDriver
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1387)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1233)
    at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:320)
    at SecurePaymentAjaxData.doPost(SecurePaymentAjaxData.java:44)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)
    at java.lang.Thread.run(Thread.java:619) 
```

这是使用 xstream 类的相关代码：

```
XStream xstream = new XStream(new JettisonMappedXmlDriver());
xstream.setMode(XStream.NO_REFERENCES);
xstream.alias("CallDataUpdate", CallDataUpdate.class);
xstream.alias("CardStatus", CardStatus.class);
String jsonData = xstream.toXML(updateData); 
```

我强调这段代码在作为 java 应用程序运行时运行良好，我确信这与加载库有关，我只是不知道我哪里出错了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-13T11:28:27.417

不要忘记**构建**方式和**部署**方式之间存在差异。也就是说，您可能正在针对 XStream 进行构建，但您也应该将其打包到 .war 文件中以进行部署。

分解生成的 .war 文件（`jar tvf {filename}`以查看内容）并检查它是否存在（在 .jar 下的文件`WEB-INF/lib`）。我怀疑不是。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-13T11:30:26.760

我发现了问题：

如果您右键单击项目并选择属性，您可以设置“Java EE 模块依赖项”以包含您正在使用的模块。

嘿，Presto 它有效。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-12-10T14:07:59.927

Java EE Module Dependencies 似乎是要走的路。但是，Eclipse Helios 中的菜单名称发生了变化：该特定菜单现在位于“部署程序集”下。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-08T15:38:06.367

一个容易犯的错误是错误命名WEB_INF下的目录，我将它命名为libs而不是lib，编译正常但tomcat会抛出错误。

# c# - 动态创建枚举

> ID：857414
> 
> 赞同：36
> 
> 时间：2009-05-13T11:26:12.927
> 
> 标签：c#

我有以下结构的枚举：

```
public enum DType
{       
    LMS =  0,
    DNP = -9,
    TSP = -2,
    ONM =  5,
    DLS =  9,
    NDS =  1
} 
```

我正在使用这个枚举来获取名称和值。由于需要添加更多类型，因此我需要从 XML 文件中读取类型和值。有什么方法可以从**XML**文件动态创建这个枚举，以便我可以保留程序结构。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-05-13T11:28:33.657

可能，您应该考虑使用 a`Dictionary<string, int>`代替。

如果您想`enum`在**编译时**动态生成，您可能需要考虑[T4](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2014-07-17T13:19:46.410

使用 EnumBuilder 动态创建枚举。这将需要使用反射。

第 1 步：使用汇编/枚举构建器创建枚举

```
// Get the current application domain for the current thread.
AppDomain currentDomain = AppDomain.CurrentDomain;

// Create a dynamic assembly in the current application domain,
// and allow it to be executed and saved to disk.
AssemblyName aName = new AssemblyName("TempAssembly");
AssemblyBuilder ab = currentDomain.DefineDynamicAssembly(aName, AssemblyBuilderAccess.RunAndSave);

// Define a dynamic module in "TempAssembly" assembly. For a single-
// module assembly, the module has the same name as the assembly.
ModuleBuilder mb = ab.DefineDynamicModule(aName.Name, aName.Name + ".dll");

// Define a public enumeration with the name "Elevation" and an 
// underlying type of Integer.
EnumBuilder eb = mb.DefineEnum("Elevation", TypeAttributes.Public, typeof(int));

// Define two members, "High" and "Low".
eb.DefineLiteral("Low", 0);
eb.DefineLiteral("High", 1);

// Create the type and save the assembly.
Type finished = eb.CreateType();
ab.Save(aName.Name + ".dll"); 
```

第 2 步：使用创建的枚举

```
System.Reflection.Assembly ass = System.Reflection.Assembly.LoadFrom("TempAssembly.dll");
System.Type enumTest = ass.GetType("Elevation");
string[] values = enumTest .GetEnumNames(); 
```

希望有帮助

# java - Map.get(Object key) 不是（完全）通用的原因是什么

> ID：857420
> 
> 赞同：433
> 
> 时间：2009-05-13T11:28:30.927
> 
> 标签：java, generics, collections, map

决定在[`java.util.Map<K, V>`](http://java.sun.com/javase/6/docs/api/java/util/Map.html#get(java.lang.Object)).

为了澄清这个问题，该方法的签名是

`V get(Object key)`

代替

`V get(K key)`

我想知道为什么（同样的事情`remove, containsKey, containsValue`）。

* * *

## 回答 #1

> 赞同：276
> 
> 时间：2009-05-13T17:14:45.620

正如其他人所提到的，原因`get()`等不是通用的，因为您要检索的条目的键不必与您传入的对象的类型相同`get()`；该方法的规范只要求它们相等。这源于该`equals()`方法如何将对象作为参数，而不仅仅是与对象相同的类型。

`equals()`尽管许多类已经定义了它的对象只能等于它自己类的对象，这可能是普遍事实，但在 Java 中有很多地方并非如此。例如，规范`List.equals()`说如果两个 List 对象都是 List 并且具有相同的内容，则它们是相等的，即使它们是不同的实现`List`。所以回到这个问题的例子，根据方法的规范，`Map<ArrayList, Something>`我可以`get()`使用 a`LinkedList`作为参数调用，它应该检索作为具有相同内容的列表的键。`get()`如果是通用的并且限制了它的参数类型，这是不可能的。

* * *

## 回答 #2

> 赞同：112
> 
> 时间：2009-05-13T11:42:15.350

Google 的一位出色的 Java 编码员 Kevin Bourrillion 不久前在一篇[博](http://smallwig.blogspot.com/2007/12/why-does-setcontains-take-object-not-e.html)文中写了关于这个问题的文章（诚然是在`Set`代替的上下文中`Map`）。最相关的一句话：

> 统一地，Java 集合框架（以及 Google 集合库）的方法从不限制其参数的类型，除非有必要防止集合被破坏。

我不完全确定我是否同意它作为一个原则 - 例如，.NET 似乎需要正确的密钥类型 - 但值得遵循博客文章中的推理。（在提到 .NET 之后，值得解释的是，它在 .NET 中不是问题的部分原因是 .NET 中存在*更大*的问题，即差异更有限......）

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-05-13T11:34:45.987

合同是这样表达的：

> 更正式地说，如果此映射包含从键 k 到值 v 的映射，使得 (key==null ? k==null : **key.equals(k)** )，则此方法返回 v；否则返回null。（最多可以有一个这样的映射。）

（我的重点）

因此，成功的键查找取决于输入键对相等方法的实现。这*不一定*取决于 k 的类别。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-06-25T19:24:33.950

这是对[Postel 定律的应用，](https://www.rfc-editor.org/rfc/rfc793#section-2.10) “在你所做的事情上要保守，在你从别人那里接受的事情上要自由。”

无论类型如何，都可以进行平等检查；该`equals`方法在`Object`类上定义并接受任何`Object`作为参数。`Object`因此，密钥等价和基于密钥等价的操作接受任何类型都是有意义的。

当映射返回键值时，它会通过使用 type 参数尽可能多地保存类型信息。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-05-14T14:16:56.360

*我认为泛型教程的这一部分解释了这种情况（我的重点）：*

“您需要确保通用 API 没有过度限制；它必须继续支持 API 的原始合同。再次考虑 java.util.Collection 中的一些示例。预通用 API 如下所示：

```
interface Collection { 
  public boolean containsAll(Collection c);
  ...
} 
```

将其泛化的天真尝试是：

```
interface Collection<E> { 
  public boolean containsAll(Collection<E> c);
  ...
} 
```

**虽然这肯定是类型安全的，但它不符合 API 的原始合同。** containsAll() 方法适用于任何类型的传入集合。只有当传入的集合确实只包含 E 的实例时，它才会成功，但是：

*   传入集合的静态类型可能不同，可能是因为调用者不知道传入的集合的确切类型，也可能是因为它是 Collection<S>，其中 S 是 E 的子类型。
*   使用不同类型的集合调用 containsAll() 是完全合法的。例程应该工作，返回错误。”

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-13T13:38:18.860

原因是包含由哪些方法决定`equals`，`hashCode`哪些是方法，`Object`并且都带有一个`Object`参数。这是 Java 标准库中的一个早期设计缺陷。再加上 Java 类型系统的限制，它强制所有依赖 equals 和 hashCode 的东西取`Object`.

`Object.equals`在 Java 中拥有类型安全哈希表和相等性的唯一方法是避免`Object.hashCode`使用泛型替代品。[函数式 Java](http://code.google.com/p/functionaljava)带有类型类就是为了这个目的：[`Hash<A>`](http://functionaljava.googlecode.com/svn/artifacts/2.19/javadoc/fj/pre/Hash.html)和[`Equal<A>`](http://functionaljava.googlecode.com/svn/artifacts/2.19/javadoc/fj/pre/Equal.html). 提供了一个包装器，它在其构造函数[`HashMap<K, V>`](http://functionaljava.googlecode.com/svn/artifacts/2.19/javadoc/fj/data/HashMap.html)中接受`Hash<K>`and 。`Equal<K>`因此，此类`get`和`contains`方法采用 type 的通用参数`K`。

例子：

```
HashMap<String, Integer> h =
  new HashMap<String, Integer>(Equal.stringEqual, Hash.stringHash);

h.add("one", 1);

h.get("one"); // All good

h.get(Integer.valueOf(1)); // Compiler error 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2017-03-23T08:38:17.327

兼容性。

在泛型可用之前，只有 get(Object o)。

如果他们将此方法更改为 get(<K> o) ，它可能会迫使 Java 用户进行大量代码维护，以使工作代码再次编译。

他们本*可以*引入一个*额外*的方法，比如 get_checked(<K> o) 并弃用旧的 get() 方法，以便有一个更温和的过渡路径。但由于某种原因，这并没有完成。（我们现在的情况是你需要安装 findBugs 之类的工具来检查 get() 参数和地图声明的键类型 <K> 之间的类型兼容性。）

我认为与 .equals() 语义有关的论点是虚假的。（从技术上讲，它们是正确的，但我仍然认为它们是假的。如果 o1 和 o2 没有任何共同的超类，那么没有一个头脑正常的设计师会让 o1.equals(o2) 为真。）

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-01-01T14:37:09.710

还有一个更重要的原因，它在技术上无法完成，因为它破坏了 Map。

Java 具有多态泛型结构，例如`<? extends SomeClass>`. 标记此类引用可以指向用 签名的类型`<AnySubclassOfSomeClass>`。但是多态泛型使该引用成为**只读**的。编译器允许您仅将泛型类型用作方法的返回类型（如简单的 getter），但阻止使用泛型类型为参数的方法（如普通的 setter）。这意味着如果您编写`Map<? extends KeyType, ValueType>`，编译器不允许您调用方法`get(<? extends KeyType>)`，并且映射将无用。唯一的解决方案是使此方法不通用：`get(Object)`.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-13T11:33:02.667

向后兼容性，我猜。`Map`（或`HashMap`）仍然需要支持`get(Object)`。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-12-18T13:00:54.563

我看着这个，想他们为什么这样做。我认为现有的任何答案都不能解释为什么他们不能让新的通用接口只接受密钥的正确类型。实际原因是，即使他们引入了泛型，他们也没有创建新接口。Map 接口与旧的非泛型 Map 相同，它只是用作泛型和非泛型版本。这样，如果您有一个接受非泛型 Map 的方法，您可以传递它 a`Map<String, Customer>`并且它仍然可以工作。同时 get 的合约接受 Object 所以新的接口也应该支持这个合约。

在我看来，他们应该添加一个新接口并在现有集合上实现，但他们决定支持兼容接口，即使这意味着 get 方法的设计更差。请注意，集合本身将与现有方法兼容，只有接口不兼容。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-02-09T14:48:15.630

我们刚才正在做大的重构，我们错过了这个强类型的 get() 来检查我们没有错过一些旧类型的 get()。

但我发现编译时间检查的解决方法/丑陋的技巧：使用强类型 get、containsKey、remove... 创建 Map 接口并将其放入项目的 java.util 包中。

仅调用 get(), ... 类型错误，您将收到编译错误，其他所有编译器似乎都可以（至少在 eclipse kepler 内部）。

在检查你的构建后不要忘记删除这个接口，因为这不是你在运行时想要的。

# php - PHP - 引用重定向脚本

> ID：857427
> 
> 赞同：10
> 
> 时间：2009-05-13T11:30:19.490
> 
> 标签：php, http-referer

通常，在搜索答案时，我发现某些网站将允许您阅读他们提供的信息，例如，如果引荐来源是 google.com。但是，如果您直接链接到该信息，它将不可用。

我正在寻找的是最小的 PHP 脚本，它将设置我选择的引用者和目的地，如下所示：

```
http://example.com/ref_red.php?referer=http://google.com/&end=http://example.net/ 
```

笔记：

*   **ref_red.php**是我示例中脚本的名称。
*   **referer**和**end**应该接受*http*、*https*、*ftp*。
*   **referer**和**end**可以包含任何类型的 URI，例如简单如[http://end.com](http://end.com)或复杂如: `http://example.com/some/rr/print.pl?document=rr`。

**注意：**根据回复中的建议，我正在添加此内容。该脚本本身并不是一个完整的代理。**仅会代理初始 HTTP 请求**（而不是图像等后续请求），其**唯一目的**是设置**referer**。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-14T01:21:57.657

此函数应该为您提供一个起点，它将获取具有指定引荐来源网址的任何 http url

处理查询参数应该很简单，所以我将把这部分留给你做

```
<?php

    echo geturl('http://some-url', 'http://referring-url');

    function geturl($url, $referer) { 

        $headers[] = 'Accept: image/gif, image/x-bitmap, image/jpeg, image/pjpeg,text/html,application/xhtml+xml'; 
        $headers[] = 'Connection: Keep-Alive'; 
        $headers[] = 'Content-type: application/x-www-form-urlencoded;charset=UTF-8'; 
        $useragent = 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.0.3705; .NET CLR 1.1.4322; Media Center PC 4.0)'; 

        $process = curl_init($url); 
        curl_setopt($process, CURLOPT_HTTPHEADER, $headers); 
        curl_setopt($process, CURLOPT_HEADER, 0); 
        curl_setopt($process, CURLOPT_USERAGENT, $useragent);
        curl_setopt($process, CURLOPT_REFERER, $referer);
        curl_setopt($process, CURLOPT_TIMEOUT, 30); 
        curl_setopt($process, CURLOPT_RETURNTRANSFER, 1); 
        curl_setopt($process, CURLOPT_FOLLOWLOCATION, 1); 

        $return = curl_exec($process); 
        curl_close($process); 

        return $return; 
    } 

?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T12:03:07.843

您可以使用 Internet 上提供的允许隐藏引用者（通过设置其地址）的服务之一，但您不能强加一个不是实际引用者的特定引用者。在将用户重定向到目标网站之前，必须将用户实际重定向到该网站（将显示为引用者）。

其中一项服务： http: [//linkanon.com](http://linkanon.com)

编辑：

由于您现在更改了问题，因此我关于在 PHP 中编写一个充当代理的用户代理的评论适用，但这接近于犯罪活动，因为您将向可能认为的用户显示第三方网站她在实际的网站中，而实际上她将加载您的内容（您传递的内容）。要执行这种近乎犯罪的活动（您距离尝试读取用户名和密码仅一步之遥），您需要使用自己的书面用户代理使用 PHP 加载第三方的网站内容，该用户代理指定虚假的引荐来源并简单地传递输出给您网站的访问者。PHP 中允许发送 HTTP 标头的函数是 header($header)：

```
header("Referer: http://example.org"); 
```

您可以尝试阅读有关Referer标头的HTTP（这是世界转向的协议）规范，而不是对试图提供帮助的人大喊大叫：http: [//www.w3.org/Protocols/rfc2616/rfc2616-sec14 .html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html) （参见第 14.36 节）。

您可能还想阅读[http://en.wikipedia.org/wiki/Referrer_spoofing](http://en.wikipedia.org/wiki/Referrer_spoofing)，您可以在其中看到所有关于客户端的内容。PHP是服务器端。你所能做的就是尝试编写一个由 PHP 生成的客户端代码（Javascript），但如果你运气好的话，那么你正在闯入用户的世界。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T11:32:46.007

引用者是由您的浏览器设置的，而不是由任何服务器端机制设置的。我猜你可以在 PHP 中构造一个代理来发出远程服务器的请求并适当地设置引用标头。只使用 Firefox 插件似乎更有用，例如[http://www.stardrifter.org/refcontrol/](http://www.stardrifter.org/refcontrol/)。

编辑：我会改写你的问题，以明确你想要编写一个 PHP 代理，并带有一个自定义的引用标头。我可能只是修改类似的东西[http://sourceforge.net/projects/poxy/](http://sourceforge.net/projects/poxy/)获取referrer 参数并将其传递。

再次编辑：你可能很清楚你在问什么，但要求不可能的事情并不能使它成为可能。浏览器负责设置referer header；它使用导致它重定向到新资源的 URI。你要求一个脚本，上面写着“请访问[http://example.net](http://example.net)，但当你这样做时假装我实际上是 www.foo.com”。服务器没有机制来指示浏览器“撒谎”它来自哪里。

我想这可能是通过一些复杂的 JavaScript 黑客攻击实现的，但这将是黑帽意义上的黑客攻击——一个能够强制浏览器欺骗引用者的网站将是一个真正的安全漏洞。

# sql-server - 存储过程中的临时表

> ID：857433
> 
> 赞同：35
> 
> 时间：2009-05-13T11:30:46.133
> 
> 标签：sql-server, stored-procedures

我一直想知道 sp 中的临时表以及所有这些如何影响并发。SP 在 MSSQL 08 服务器上制作。

如果我有一个 SP，我在其中创建一个临时表并像这样再次删除它：

```
BEGIN

CREATE TABLE #MyTempTable
(
   someField int,
   someFieldMore nvarchar(50)
)

... Use of temp table here
... And then..

DROP TABLE #MyTempTable

END 
```

这个 SP 会被非常频繁地调用，所以我的问题是这里会不会出现并发问题？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-13T11:32:03.887

没有。每个连接都会创建临时表的独立实例。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-05-13T11:34:49.387

也许。

以一个 # (#example) 为前缀的临时表将在每个会话的基础上保留。因此，如果您的代码在另一个调用正在运行（例如后台线程）时再次调用存储过程，那么创建调用将失败，因为它已经存在。

如果您真的很担心，请改用表变量

```
DECLARE @MyTempTable TABLE 
(
   someField int,
   someFieldMore nvarchar(50)
) 
```

这将特定于该存储过程调用的“实例”。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-13T11:42:49.703

不是真的，我说的是 SQL Server。临时表（带有单个 #）存在并且在它创建的范围内可见（范围绑定）。每次调用存储过程时，它都会创建一个新范围，因此该临时表仅存在于该范围内。我相信临时表对于在该范围内调用的存储过程和 udf 也是可见的。但是，如果您使用双井号 (##)，那么它们在您的会话中变为全局，因此作为创建临时表的会话的一部分对其他执行进程可见，您将不得不考虑是否有可能访问临时表同时是可取的或不可取的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-12-22T15:47:52.280

对于所有推荐使用表变量的人，请谨慎使用。表变量不能被索引，而临时表可以。处理少量数据时最好使用表变量，但如果处理较大的数据集（例如 50k 条记录），临时表将比表变量快得多。

还要记住，您不能依靠 try/catch 来强制清理存储过程。某些类型的失败不能在 try/catch 中被捕获（例如，由于名称解析延迟而导致的编译失败）如果你想确定你可能需要创建一个可以对工作存储过程进行 try/catch 的包装存储过程并在那里进行清理。

例如创建 proc worker AS BEGIN -- 在这里做一些事情 END

```
create proc wrapper AS
BEGIN
    Create table #...
    BEGIN TRY
       exec worker
       exec worker2 -- using same temp table
       -- etc
    END TRY
    END CATCH
       -- handle transaction cleanup here
       drop table #...
    END CATCH 
END 
```

表变量总是有用的一个地方是它们**不会**在事务回滚时回滚。这对于捕获要在主事务之外提交的调试数据很有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-23T14:44:54.830

根据 SQL Server 2008 Books 可以创建本地和全局临时表。本地临时表只在当前会话中可见，全局临时表对所有会话可见。

'#table_temporal

'##table_global

如果在存储过程或应用程序中创建的本地临时表可以由多个用户同时执行，则数据库引擎必须能够区分不同用户创建的表。数据库引擎通过在每个本地临时表名称内部附加一个数字后缀来实现此目的。

那么就不会出现问题了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-23T09:14:24.767

简而言之：**没有**

* * *

**说明**：

根据官方文档：[https ://docs.microsoft.com/en-us/sql/t-sql/statements/create-table-transact-sql?view=sql-server-ver15](https://docs.microsoft.com/en-us/sql/t-sql/statements/create-table-transact-sql?view=sql-server-ver15)

> 如果在存储过程或应用程序中创建的本地临时表可以由多个用户同时执行，则数据库引擎必须能够区分不同用户创建的表。数据库引擎通过在每个本地临时表名称内部附加一个数字后缀来实现此目的。存储在 tempdb 中 sysobjects 表中的临时表的全名由 CREATE TABLE 语句中指定的表名和系统生成的数字后缀组成。为允许后缀，为本地临时名称指定的 table_name 不能超过 116 个字符。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-05-13T11:46:38.013

数据库对所有#temp 表使用相同的锁，所以如果你使用很多，你会遇到死锁问题。最好使用@table 变量进行并发。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-05-13T12:39:56.317

尽可能使用@temp 表——也就是说，您只需要一个主键，并且不需要访问从属存储过程中的数据。

如果您需要从下级存储过程访问数据（它是存储过程调用链的邪恶全局变量），并且您没有其他干净的方法在存储过程之间传递数据，请使用 #temp 表。如果您需要二级索引，也可以使用它（尽管，如果您需要多个索引，请真正问问自己它是否是#temp 表）

如果您这样做，请*始终*在函数顶部声明您的#temp 表。当 SQL 看到 create table 语句时，SQL 将强制重新编译您的存储过程......因此，如果您在存储过程中间有 #temp 表声明，则存储过程必须停止处理并重新编译。

# c# - Winform根目录路径。如何再次！

> ID：857435
> 
> 赞同：2
> 
> 时间：2009-05-13T11:30:58.443
> 
> 标签：c#, winforms, deployment

大家好，首先为提出这样一个简单但多余的问题而道歉，但我的情况似乎有点不同，谷歌搜索未能提供答案。我有一个包含 2 个项目的解决方案，比如 proj1 和 proj2，其中 proj1 是一个 winform 应用程序，proj2 是一个类库应用程序。proj1 坐在这里

> C:\Documents and Settings\myname\My Documents\Visual Studio 2005\Projects\proj1\proj1

一个班级图书馆在这里

> C:\Documents and Settings\myname\My Documents\Visual Studio 2005\Projects\proj1\proj2

现在我在子文件夹 Report 中有一个报告，其中我有我的水晶报告和其他我需要的东西，我需要这个 proj1 的根路径

> C:\Documents and Settings\myname\My Documents\Visual Studio 2005\Projects\proj1\proj1

所以我附加`@"Report\myreport.rpt"`到它。我相信它应该是已部署机器上的相对路径。如果我错了，请纠正我。主要思想是拥有报告文件夹的相对路径

> C:\Documents and Settings\myname\My Documents\Visual Studio 2005\Projects\proj1\proj\Report。

从我在网上搜索的所有内容中，`Environment.CurrentDirectory`或`Application.StartupPath`或`Application.ExecutablePath`或`System.Reflection.Assembly.GetExecutingAssembly().Location`只是给了我 bin/proj1.exe 或调试文件夹。我只是不知道该怎么做

感谢您阅读此内容。哦，是的！并为你的好意回答。PS：使用 C#2.0

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T11:38:02.143

您只需`Copy to Output Directory`将报告文件的属性设置为`Copy allways`或“如果较新则复制”。这将在构建期间将报告复制到实际输出目录下，您可以使用`Path.Combine(Application.StartupPath, "Reports", "report.rpt")`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T11:39:43.233

您不会从已编译的程序集中获取*项目*文件夹，因为（据我所知）它不知道它是从哪里编译的。但是，您将获得*运行程序集的文件夹，即*您从中获得的“调试文件夹” `Application.ExecutablePath`。

您最好将报告复制到 bin/debug 文件夹的 Reports 文件夹中，然后从那里访问它们（您可以使用它`Application.ExecutablePath`来获取它）。然后当你需要移动编译的文件时，你可以移动Reports文件夹。

部署时，您将具有以下结构：

```
C:\Program Files\proj1\proj1.exe
C:\Program Files\proj1\Reports\myreport.rpt
```

而不是以下（这是你的建议？）：

```
C:\Program Files\proj1\proj1.exe
C:\Documents and Settings\myname\My Documents\Visual Studio 2005\Projects\proj1\Reports\myreport.rpt
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-05-14T14:02:35.610

```
string path =new DirectoryInfo(Environment.CurrentDirectory).Parent.Parent.FullName 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T11:36:50.493

我认为查找程序集所在文件夹的最安全方法是：

```
private static string GetAppFolder()
{
    return new FileInfo(Assembly.GetExecutingAssembly().Location).Directory.FullName;
} 
```

...并使用该功能，您可以获得您的报告路径：

```
Path.Combine(GetAppFolder(), @"Report\myreport.rpt") 
```

# asp.net-membership - User.Identity.IsAuthenticated false 直到从登录页面重定向

> ID：857436
> 
> 赞同：6
> 
> 时间：2009-05-13T11:30:58.677
> 
> 标签：asp.net-membership

我有一个使用 ASP.NET 成员资格的登录页面。一旦我验证了用户，我需要将一些关于他们的详细信息存储在 Session 变量中。问题是

```
Membership.GetUser() == null and 
User.Identity.IsAuthenticated == false 
```

直到我离开页面。

我试过使用

```
FormsAuthentication.Authenticate(tbUsername.Text, tbPassword.Text); 
```

并检查 User.Identity.IsAuthenticated 但它返回 false 直到我到达另一个页面。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-14T18:17:17.077

好吧，`FormsAuthentication.Authenticate()`返回 a `boolean`，因此您将知道身份验证是否成功。如果是，您可以将用户的用户名传递给`Membership.GetUser()`并访问返回的`MembershipUser`对象以获取您需要的任何数据并将其存储在会话中。

```
if (FormsAuthentication.Authenticate(tbUsername.Text, tbUsername.Text)) {
   MembershipUser user = Membership.GetUser(tbUsername.Text);
   // Set session variables here.
   FormsAuthentication.RedirectFromLoginPage(tbUsername.Text, rememberMe.Checked);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T18:24:25.780

取决于您的操作方式，但如果您不使用 ASP 登录控件并且您自己进行身份验证，则需要像这样设置 AuthCookie...

```
string userName = UserName.Text;
string password = Password.Text;

if (Membership.ValidateUser(userName, password))
{
   FormsAuthentication.SetAuthCookie(userName, true);

   MembershipUser user = Membership.GetUser();

   if(user != null){
      // success
   }
   else{
      // failed
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T18:24:15.797

如果您没有使用登录控件，您是否尝试过调用 FormsAuthentication.RedirectFromLoginPage(authorizedUserName, createPersistantCookie); 然后检查？

如果您使用的是 Login 控件，那么您可以处理该控件上的一个事件来获取您需要的数据，例如[LoggedIn](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.login.loggedin.aspx)

# sql - 需要对 SQL 和 Crystal Reports 进行良好的版本控制

> ID：857438
> 
> 赞同：2
> 
> 时间：2009-05-13T11:31:02.250
> 
> 标签：sql, crystal-reports

我们有几个大型数据存储，我们在其中存储用于度量报告的数据。一个是 SQL 2000，另一个是 2005。我们使用 Crystal Reports 11 作为我们的报告工具。

在过去的几周里，由于 Db 的变化或报告中的变化，我们收到了一些非常明显的报告“崩溃”。

为了尽量减少这些错误，我正在考虑将我们的数据库和 Crystal 报告的脚本放入某种版本控制中。有人可以指出我如何在某种版本控制下获得这些资产的正确方向吗？我们公司确实有颠覆，这行得通吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-01-20T01:02:31.170

有两种方法可以处理这个问题：

1.  您可以使用任何版本控制（Visual Source Safe、SVN 等）。每次更改报告文件时都将其导出为报告定义格式（菜单 File->Print->Export ，格式：报告定义），并将报告和报告定义文件都添加到版本控制中。报告定义文件是一个文本文件，可以与任何其他文本文件进行比较，因此您将能够看到更改的内容。报告文件是二进制文件，无法与常规版本控制软件进行比较，但如果需要，您可以使用它来恢复以前的版本。这种方法的优点是它是免费的。缺点是您必须执行额外的步骤，并且比较仅限于导出到报告定义文件的内容。例如，格式、位置、大小等将不会被导出。

2.  有一个工具：R-Tag Crystal Version Control。这是一个仅适用于 Crystal 报表的版本控制，将作为常规版本控制工作，但也将比较二进制报表文件。此外，您将能够搜索报告的结构。此工具将比方法 1 中的报告定义进行更多比较，并且将节省您的时间，因为没有额外的步骤和导出。与第一种方法相比的缺点是这是一个付费软件。您可以在此处找到更多信息：[http ://www.r-tag.com/Pages/VersionControl.aspx](http://www.r-tag.com/Pages/VersionControl.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T21:14:49.247

您可以对 Crystal Report 文件使用标准版本控制工具。然而，处理数据库有点困难。

### Visual Studio Team System 2008 数据库版（数据老兄）

您可以使用此版本的 Visual Studio 来管理您的数据库，数据库表、视图、存储过程、函数等的定义存储为创建脚本（就像您从空白数据库开始一样）。然后，Visual Studio 函数将创建数据库差异（架构比较或数据比较）并生成从一个版本的数据库到另一个版本（即在 DEV 和 TEST 实例之间）所需的脚本。

数据库定义是放入版本控制的内容（因此您可以随时查看数据库的外观），Visual Studio 通过生成从一个版本到另一个版本的适当脚本来填充其余部分。

### 艰难的道路

跟踪您的数据库、修改数据库的脚本和迁移模式。如果您想获得数据库的某个版本，您将从一个空数据库开始，然后连续运行每个脚本，直到您获得所需的数据库版本。

这基本上是 Ruby on Rails 在使用 db_migration 功能时所做的事情，但是如果您正确编码迁移文件，它可以通过版本回退 - 但我假设您在 Windows 上使用 .NET。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-15T22:39:19.090

我们目前正在研究 ReportMiner 的一款名为[RptDiff](http://www.reportminer.com)[的](http://www.reportminer.com/Products/RptDiff.shtml)产品，以帮助进行水晶报表版本控制。如果我们对标准产品中的报告进行了重大更改并且我们的客户已经定制了旧版本，我们希望能够比目视检查报告更容易地判断需要应用哪些更改。在我们购买只是为了做功课之前，我目前正在堆栈溢出中寻找另一种选择。到目前为止，我们还没有看到任何其他报告差异以及水晶免费提供的内容（导出文本定义）。

# javascript - Internet Explorer 和 JavaScript 事件 currentTarget

> ID：857439
> 
> 赞同：44
> 
> 时间：2009-05-13T11:31:13.310
> 
> 标签：javascript, internet-explorer, events

有没有办法使用 IE 7 或 8 获取事件的当前目标？

对于其他浏览器（firefox、opera、chrome 等），我们可以使用 `event.currentTarget`，也可以使用`this`关键字来引用处理事件的对象。

但是在**Internet Explorer**中，我们没有`currentTarget`属性，并且`this`指的是 window 对象！

那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2011-02-16T19:26:46.737

你可以做类似的事情

```
target = (event.currentTarget) ? event.currentTarget : event.srcElement; 
```

尽管正如@Marc 提到的，您可以使用为您规范化事件的 JQuery 框架。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-03-06T12:03:37.860

我有类似的问题。`this`如[brainjar.com 上的一篇文章](http://www.brainjar.com/dhtml/events/default3.asp)中所述，我使用关键字解决了它

> 要在 IE 中获取 currentTarget 属性的等效项，请在标记中设置事件处理程序时使用 this 关键字作为参数。
> 
> ...
> 
> 功能 myHandler（事件，链接）{ ... }

在同一页面上，您可以找到下表：

![在此处输入图像描述](https://i.stack.imgur.com/Q5BIy.png)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-12-09T19:41:44.020

简短的回答是：使用 jQuery。

虽然`event.currentTarget`在 IE 上无法访问，但 jQuery 将为您规范化事件，因此您的代码也可以在 IE 上运行（如此[处](http://brandonaaron.net/blog/2009/05/12/jquery-edge-bind-with-a-different-this)所述）

请注意，使用`event.srcElement`, 正如其他答案中所建议的那样，**并不**等同，因为`srcElement`对应于`target`，而不是，如[本页](http://www.quirksmode.org/js/events_order.html)`currentTarget`末尾所述。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-03-16T15:05:01.297

使用此函数，您可以在添加时传递对象并在侦听器中获取它。关于这个的问题是你有一个匿名函数作为 eventlistener 并且在 actionscript 中你不能删除一个匿名监听器。不知道关于js。

```
addEvent:function(object,type,listener,param)
    {
    if(object.addEventListener)
      object.addEventListener(type, function(e){ listener(object, e, param);}, false );
    else
    if(object.attachEvent)
      object.attachEvent('on'+type, function(e){ e = getEvent(e); listener(object, e, param);});
    },

getEvent:function(e)
        {
    if(!e) e = window.event; // || event
    if(e.srcElement) e.target = e.srcElement;
    return e;
    },

removeEvent:function(object,type,listener)
    {
    if(object.removeEventListener)
    object.removeEventListener(type, listener, false);
    else
    object.detachEvent('on'+type, listener);
    }

var div = document.getElementById('noobsafediv');
var div2 = document.getElementById('noobsafediv2');
addEvent(div,'mouseover',mouseover,['astring',111,div2]);

function mouseover(object,e,param)
 {
 console.log(object,e,param);
 } 
```

它是我的框架，我称之为 jNoob。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T21:05:29.533

我假设您想要使用“this”上下文，因为同一个处理程序将处理多个可能的对象。在这种情况下，请参阅 quirksmode recoding 竞赛中出色的 AddEvent 脚本。（[http://www.quirksmode.org/blog/archives/2005/09/addevent_recodi.html](http://www.quirksmode.org/blog/archives/2005/09/addevent_recodi.html)）。这段代码使我能够从 html 中获取我的最后一个 javascript。更重要的是，它似乎适用于我测试过的所有浏览器。简单紧凑。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-02T21:18:36.993

这个函数`currentTarget`在它是 IE 的情况下创建，所以你不再需要修补你的代码！

```
function eventListener(e,t,f) {
   if(e.addEventListener)
       e.addEventListener(t,f);
   else
       e.attachEvent('on' + t,
                     function(a){
                         a.currentTarget = e;
                         f(a);
                     });
} 
```

常规 JS（不适用于 9 以下的 IE）：

```
function myfunction(e) {
    alert(e.currentTarget.id);
}

e = document.getElementById('id');
e.AddEventListener(e,'mouseover',myfunction); 
```

使用此功能（将在 9 以下的 IE 上工作）：

```
function myfunction(e) {
    alert(e.currentTarget.id);
}
e = document.getElementById('id');
eventListener(e,'mouseover',myfunction); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-05-23T10:59:45.537

使用原型 JS，您可以使用：

```
var target = Event.element(event); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-07-24T18:25:05.347

附加说明：有时 IE（如 ie 7）会为 event.target 返回 undefined，因此它甚至不会将其评估为真或假（无论是在 if 还是在三元运算符中）。此外，即使您尝试`typeof event.target == 'undefined'`它仍然会出错说“event.target 未定义”。这当然是愚蠢的，因为那是你正在测试的。
显然，将事件传递给旧 IE 中的函数是一个问题。您要解决的问题是：

```
event = event ? event : window.event;
if (typeof event.target == 'undefined') {
    var target = event.srcElement;
    } else {
    var target = event.target;
    } 
```

请注意，您在符合标准的浏览器中重新编写事件并获取 IE 的全局事件。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-03-05T06:07:57.593

**Internet Explorer 6 - 8**不实现 event.currentTarget。

来自[Mozilla 开发者网络](https://developer.mozilla.org/en-US/docs/Web/API/event.currentTarget#Browser_compatibility)的引述：

> 在 Internet Explorer 6 到 8 上，事件模型是不同的。事件侦听器使用非标准 element.attachEvent 方法附​​加。在此模型中，没有等效于 event.currentTarget 的对象，这是全局对象。**模拟 event.currentTarget 功能的一种解决方案是将您的处理程序包装在一个调用处理程序的函数中，该函数使用 Function.prototype.call 并将元素作为第一个参数。这样，这将是预期值。**

如果您仍然使用**jQuery**，那么 jQuery 会负责规范化事件对象及其属性（如其他答案中多次所述）。引用[jQuery API 文档](https://api.jquery.com/category/events/event-object/)：

> jQuery 的事件系统根据 W3C 标准规范化事件对象。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-12-21T09:19:07.637

[从 IE 版本 9 开始支持 currentTarget 属性。](http://msdn.microsoft.com/en-us/library/ie/ff974942%28v=vs.85%29.aspx)

[在 IE9+ 中试试这个示例](http://www.w3schools.com/js/tryit.asp?filename=try_dom_event_currenttarget)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-06-11T13:14:33.633

我想给出一个更简单的答案，这个肉与anas'和user1515360的答案中的肉一样：

```
if (browserDoesNotUnderstandCurrentTarget) {
        someElement.onclick = function (e) {
                if (!e) { var e = window.event; }
                e.currentTarget = someElement;
                yourCallback(e);
        }
}
else {
        someElement.onclick = yourCallback;
} 
```

当然，用 onclick 替换您希望的任何事件。

这使得 e.currentTarget 在不支持 currentTarget 的浏览器上可用。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-08-14T03:57:47.073

好吧，我不确定，但这可能是一个解决方案：因为 srcElement 给出的子元素不应该有一个事件，因为这会干扰父元素上的事件，也不会干扰事件声明的顶部元素之前的任何其他上层元素（如 onmosedown=""）所以这是代码：

```
if (!event) event = window.event; 
if (event.currentTarget) element = event.currentTarget; 
else{element = event.srcElement; while(element.onmousedown==null) element = element.parentNode;}
if(element.nodeType==3) element=element.parentNode;  // defeat Safari bug 
```

到目前为止，这似乎对我来说工作正常，如果你发现问题，请纠正我 cz 我需要一个我不想使用 jquery 的解决方案。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-03-22T21:23:18.450

您始终可以使用**闭包**并传入事件处理程序已附加到的元素。沿着这些路线的东西......

```
function handlerOnClick (currentTarget) {
    return function () {
        console.log(currentTarget);
    } 
}

var domElement = document.createElement('DIV');
domElement.innerHTML = 'Click me!';
domElement.onclick = handlerOnClick(domElement);
document.body.appendChild(domElement); 
```

# java - 重用 TableCellEditor 对象

> ID：857440
> 
> 赞同：0
> 
> 时间：2009-05-13T11:31:16.070
> 
> 标签：java, swing, tablecelleditor

所以我有很多表格和很多单元格编辑器，里面有很多东西。我想我应该重用它们，而不是每次都做 new() ，因为整个事情都设置了 getTableCellEditorComponent() 但是，几乎每次我尝试这样做时，我都会在旧单元格中得到“剩菜”和其他奇怪的东西。我通常可以通过每次制作一个新的来纠正问题，但这很糟糕吗？

谢谢！约书亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T12:14:53.567

`JTable`s 很大。虽然 a 中的`JComponent`子类`TableCellEditor`也可能很大，但并不值得担心。此外，最好避免共享可变对象，尤其是像 Swing 组件这样复杂的对象。每个组件生命周期有一个父级似乎是一个不错的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T12:21:19.623

由于每个 总是有零个或一个编辑器`JTable`，因此调用的性能`getTableCellEditorComponent()`并不是非常关键。但是，在处理表格渲染器时必须避免创建新组件。

# php - PHP 用一个扭曲的方式在所有其他单词上爆炸？

> ID：857441
> 
> 赞同：1
> 
> 时间：2009-05-13T11:31:42.980
> 
> 标签：php, explode

> **重复：[在所有其他单词上爆炸](https://stackoverflow.com/questions/840807/wondering-how-to-do-php-explode-over-every-other-word)**

```
$string = "This is my test case for an example." 
```

如果我确实爆炸了，`' '`我会得到一个

```
Array('This','is','my','test','case','for','an','example.'); 
```

我想要的是其他空间的爆炸。

我正在寻找以下输出：

```
Array( 

[0] => Array ( 

[0] => This is
[1] => is my
[2] => my test
[3] => test case 
[4] => case for 
[5] => for example. 

) 
```

所以基本上每2个单词的短语都会输出。

有谁知道解决办法？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T12:17:59.130

这将提供您正在寻找的输出

```
$string = "This is my test case for an example.";
$tmp = explode(' ', $string);
$result = array();
//assuming $string contains more than one word
for ($i = 0; $i < count($tmp) - 1; ++$i) {
    $result[$i] = $tmp[$i].' '.$tmp[$i + 1];
}
print_r($result); 
```

封装在一个函数中：

```
function splitWords($text, $cnt = 2) 
{
    $words = explode(' ', $text);

    $result = array();

    $icnt = count($words) - ($cnt-1);

    for ($i = 0; $i < $icnt; $i++)
    {
        $str = '';

        for ($o = 0; $o < $cnt; $o++)
        {
            $str .= $words[$i + $o] . ' ';
        }

        array_push($result, trim($str));
    }

    return $result;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T13:52:37.837

另一种使用“追逐指针”的方法是这个片段。

```
$arr = explode( " ", "This is an example" );
$result = array();

$previous = $arr[0];
array_shift( $arr );
foreach( $arr as $current ) {
    $result[]=$previous." ".$current;
    $previous = $current;
}

echo implode( "\n", $result ); 
```

不需要索引和计数，而是将所有这些内部表示的东西留给 foreach 方法（或 array_map 等）总是很有趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T15:15:23.973

没有循环的简短解决方案（和可变字数）：

```
 function splitStrByWords($sentence, $wordCount=2) {
        $words = array_chunk(explode(' ', $sentence), $wordCount);
        return array_map('implode', $words, array_fill(0, sizeof($words), ' '));
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T11:33:44.913

想到两个快速选项：按每个单词分解并成对重新组合，使用正则表达式而不是explode() 来拆分字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T11:55:53.690

```
$arr = explode($string);
$arr2 = array();
for ( $i=0; $i<size($arr)-1; $i+=2 ) {
    $arr2[] = $arr[i].' '.$arr[i+1];
}
if ( size($arr)%2==1 ) {
    $arr2[] = $arr[size($arr)-1];
} 
```

$arr2 是解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-05-22T07:02:58.427

```
 $content="This is my test case for an example";
  $tmp=explode(" ",$content);
  $text = array();
  $b=0;
  for ($i = 0; $i < count($tmp)/2; $i++) {
      $text[$i] = $tmp[$b].' '.$tmp[$b + 1];
      $b++;
  $b++;
  }
  print_r($text); 
```

# php - PHP MySQL 查询“创建表” - 初学者需要帮助

> ID：857446
> 
> 赞同：0
> 
> 时间：2009-05-13T11:32:15.477
> 
> 标签：php, mysql

我正在尝试使用 PHP MySQL 查询“创建表”创建一个简单的数据库表，但它不起作用。

下面的代码有什么问题？

```
 // Make a MySQL Connection
mysql_connect("localhost","the_database_name","the_database_password") or die(mysql_error());
mysql_select_db("the_database_name") or die(mysql_error());

// Create a MySQL table in the selected database
mysql_query("CREATE TABLE downloads_list(
download_id INT(7) UNSIGNED NOT NULL AUTO_INCREMENT,
download_date TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP,
visitor_first_name VARCHAR(20) NOT NULL,
visitor_last_name VARCHAR(20) NOT NULL,
visitor_email VARCHAR(50) NOT NULL,
visitor_phone VARCHAR(30) NOT NULL,
store_name VARCHAR(20) NOT NULL,
document_name VARCHAR(200) NOT NULL,
PRIMARY KEY (download_id)")
 or die(mysql_error());  

echo "Table Created!"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T11:36:27.747

看起来你没有关闭你刚刚打开的括号`download_list`。

# c# - 在 C# 中使用事件处理程序进行顶级异常处理

> ID：857448
> 
> 赞同：1
> 
> 时间：2009-05-13T11:32:24.430
> 
> 标签：c#, exception, events, asynchronous

我目前正在问自己一些关于异常处理和事件处理程序的问题，希望你们中的一些人能给我一些帮助。

我将开始解释我想在我的 c# 应用程序中实现的目标：

我有一个顶级方法（我们称之为 main 方法）。此方法调用异步方法（称为连接），该方法连接到 FTP 服务器。

一个EventHandler对象与这个连接相关联，当连接成功时会调用一个“回调”方法。

我想处理可以在整个过程中启动的异常。所以我想在顶级方法中抓住它。它适用于由 connect 方法（在顶级方法内部调用）启动的异常。但是，它不适用于“回调”方法内部调用的异常：顶级方法不会捕获它们并且执行失败。

我该怎么做才能使这些异常被顶级方法捕获？我不想在回调中处理这些异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T14:20:50.007

考虑以下代码片段，用于将所有代码包装在全局异常处理程序中：

```
namespace MyClient
{
  class Program
  {
    static void Main(string[] args)
    {
      try
      {
        bool isSuccess = SubMain(string[] args);
      }
      catch (Exception e)
      {
        HandleExceptionGracefully(e);
      }
    }
    static bool SubMain(string[] agrs)
    {
       // Do something
    }
    static void HandleExceptionGracefully(Exception e)
    {
       // Display/Send the exception in a graceful manner to the user/admin.
    }
  }
} 
```

另外，不要忘记使您的错误处理对[用户友好。](http://www.codinghorror.com/blog/archives/001238.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T11:40:22.953

看看 Backgroundworker 是如何处理这个问题的：Exception 被传播到 Completed 事件处理程序。

我假设您有某种形式的 State 对象传递给委托/从委托传递，您可以在其中添加这样的属性。而且您必须在最外层范围内捕获线程中的所有异常。但是“处理”只是意味着传递它。

RunWorkerCompleted 事件有一个标准模式，请参阅[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.runworkercompleted.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T11:39:22.737

Application 类中有一个名为[ThreadException](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception(VS.71).aspx)的事件处理程序。每当在当前调用堆栈中的任何地方抛出一个未捕获的异常时，都会触发此事件。

* * *

编辑：

抱歉，我误读了这个问题 - 我没有意识到您示例中的“主要”方法不是实际的***主要***方法。在这种情况下，您可能希望在回调中捕获异常，但不对其进行处理 - 只需将其作为事件参数的一部分传递回 main 方法。

Winforms 中的 BackgroundWorker 做了类似的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-14T09:34:30.157

感谢您的回答。

似乎使用 BackgroundWorker 解决了这个问题。

我没有尝试，因为我选择避免这种实现负担。所以我拿走了我的异步调用，让我的应用程序同步运行。

对于使用 Compact Framework 而不是完整的 .NET Framework 的人的一个提示：BackgroundWorker 在 CF 中不可用，但 OpenNETCF 提供了类似的解决方案（请参阅 Smart Device Framework 中的 BackgroundWorker 类）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T12:53:28.517

处理这种顶级异常处理问题的更方便的方法是使用委托。

这些 c# 委托允许以异步方式调用方法。委托还允许顶级异常处理。实际上，委托中抛出的异常会在原始线程上重新抛出。

我不知道为什么我以前没有考虑过代表。我希望它会有所帮助。

请参阅这些关于代表的好文章：

[第1条](http://www.albahari.com/threading/part3.aspx#_Asynch_Delegates)

[第二条](http://www.akadia.com/services/dotnet_delegates_and_events.html#The%20very%20basic%20Delegate)

# jquery - jQuery表单验证：字段无效时的标准窗口对话框

> ID：857454
> 
> 赞同：0
> 
> 时间：2009-05-13T11:33:55.100
> 
> 标签：jquery, jquery-plugins, jquery-validate

我需要一个非常基本的客户端表单验证：每当遇到无效字段时，都会显示一个标准的 windows 对话框，停止检查剩余的字段，并取消提交。

用 jQuery 完成上述操作的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T11:45:45.017

You may try tagging all fields you need to validate with a class of "RequiredField" and then use Jquery to validate them all at once. For the ones that fail you can add a class of highlight to turn them, say, red.

After that you can show a warning that says the highlighted fields are invaild.

```
function CheckStandardInputs(){
    //Check for required fields.
    var ReqFields = $(".RequiredField[value='']");

```
if(ReqFields.size() > 0){
    if(HighlightBlanks){
        ReqFields.addClass("Highlight");
    }
            //Remove highlight on change.
    ReqFields.change(function () {$(this).removeClass("Highlight");});
    return false;
}else{
    return true;
} 
```

}

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T11:43:20.933

What's wrong with the standard jQuery [validation plugin](http://docs.jquery.com/Plugins/Validation)?

# wpf - 如何在 Image.Source 上显示验证错误？

> ID：857465
> 
> 赞同：2
> 
> 时间：2009-05-13T11:36:24.800
> 
> 标签：wpf, validation, data-binding, binding

我将 Image 的 Source 属性绑定到模型上的 URI 字符串属性：

```
<Image Validation.ErrorTemplate="{StaticResource validationTemplate}">
  <Image.Source>
    <Binding Path="LargeImage.ImageUri">
      <Binding.ValidationRules>
        <ExceptionValidationRule/>
      </Binding.ValidationRules>
    </Binding>
  </Image.Source>
</Image>

<ControlTemplate x:Key="validationTemplate">
  <Border BorderThickness="2" CornerRadius="2" BorderBrush="Red">
    <AdornedElementPlaceholder/>
  </Border>
</ControlTemplate> 
```

当 LargeImage.ImageUri 不是有效图像时，我希望图像显示红色边框，但这没有发生。

这是因为问题在于转换绑定值，而不是设置它？

我可以看到将字符串 ImageUri 转换为 ImageSource 时引发了异常：

```
System.Windows.Data Error: 18 : Cannot convert 'C:\not-an-image.txt' from type 'String' to type 'System.Windows.Media.ImageSource' for 'en-US' culture with default conversions; consider using Converter property of Binding. NotSupportedException:'System.NotSupportedException: No imaging component suitable to complete this operation was found. ---> System.Runtime.InteropServices.COMException (0x88982F50): Exception from HRESULT: 0x88982F50
   --- End of inner exception stack trace ---
   at MS.Internal.HRESULT.Check(Int32 hr)
   at System.Windows.Media.Imaging.BitmapDecoder.SetupDecoderFromUriOrStream(Uri uri, Stream stream, BitmapCacheOption cacheOption, Guid& clsId, Boolean& isOriginalWritable, Stream& uriStream, UnmanagedMemoryStream& unmanagedMemoryStream, SafeFileHandle& safeFilehandle)
   at System.Windows.Media.Imaging.BitmapDecoder.CreateFromUriOrStream(Uri baseUri, Uri uri, Stream stream, BitmapCreateOptions createOptions, BitmapCacheOption cacheOption, RequestCachePolicy uriCachePolicy, Boolean insertInDecoderCache)
   at System.Windows.Media.Imaging.BitmapFrame.CreateFromUriOrStream(Uri baseUri, Uri uri, Stream stream, BitmapCreateOptions createOptions, BitmapCacheOption cacheOption, RequestCachePolicy uriCachePolicy)
   at System.Windows.Media.ImageSourceConverter.ConvertFrom(ITypeDescriptorContext context, CultureInfo culture, Object value)
   at MS.Internal.Data.DefaultValueConverter.ConvertHelper(Object o, Type destinationType, DependencyObject targetElement, CultureInfo culture, Boolean isForward)'
System.Windows.Data Error: 6 : 'TargetDefaultValueConverter' converter failed to convert value 'C:\not-an-image.txt' (type 'String'); fallback value will be used, if available. BindingExpression:Path=LargeImage.ImageUri; DataItem='ItemSettings' (HashCode=60569775); target element is 'Image' (Name=''); target property is 'Source' (type 'ImageSource') NotSupportedException:'System.NotSupportedException: No imaging component suitable to complete this operation was found. ---> System.Runtime.InteropServices.COMException (0x88982F50): Exception from HRESULT: 0x88982F50
   --- End of inner exception stack trace ---
   at MS.Internal.Data.DefaultValueConverter.ConvertHelper(Object o, Type destinationType, DependencyObject targetElement, CultureInfo culture, Boolean isForward)
   at MS.Internal.Data.TargetDefaultValueConverter.Convert(Object o, Type type, Object parameter, CultureInfo culture)
   at System.Windows.Data.BindingExpression.ConvertHelper(IValueConverter converter, Object value, Type targetType, Object parameter, CultureInfo culture)' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-23T15:30:11.067

> 这是因为问题在于转换绑定值，而不是设置它？

在某种程度上是的，如果您的意思是设置/更新绑定源而不是绑定目标，请参阅 MSDN 描述[`ExceptionValidationRule`](http://msdn.microsoft.com/en-us/library/system.windows.controls.exceptionvalidationrule.aspx)：

> 表示检查绑定源属性**更新期间引发的异常的规则。**

突出显示的短语是这里的关键：该规则适用于更新源的绑定操作，而不是目标。在您的情况下， Image.Source 是绑定目标，而 LargeImage.ImageUri 是绑定源，因此与您要实现的目标相反。

本质上，您希望验证现有模型而不是用户输入（典型示例是接受用户输入并应用一些约束的 TextBox，例如字符串长度或整数范围）。但是，通过WPF[`ValidationRule`类](http://msdn.microsoft.com/en-us/library/system.windows.controls.validationrule.aspx)数据绑定仅针对后一种情况：

> 提供一种创建自定义规则以检查用户输入有效性的方法。

有关更多详细信息，请参阅[数据绑定概述](http://msdn.microsoft.com/en-us/library/ms752347.aspx)中的[数据验证](https://docs.microsoft.com/en-us/dotnet/framework/wpf/data/data-binding-overview#data-validation)部分。

# javascript - 从被调用函数调用 javascript 函数（在原始函数中）？

> ID：857484
> 
> 赞同：0
> 
> 时间：2009-05-13T11:42:39.377
> 
> 标签：javascript, function, reference

无论如何从另一个函数调用一个函数..很难解释。举个例子。一个函数加载 html 页面，并在准备好后调用原始函数。

我想我需要传递一个参考，但不确定如何做到这一点......如果我将它设置为“this” - 它似乎不起作用

有任何想法吗？

```
order.prototype.printMe = function(){
    order_resume.loadthis("myTestPage.html", "showData");
}

order.prototype.testme= function(){
     alert("i have been called");
}

//Then when in "loadthis" need to call 

orderRsume.prototype.loadthis= function(){
    //  DO SOME STUFF AND WHEN LOADS IT ARRIVES IN OnReady
}

order.prototype.OnReady= function(){
  /// NEED TO CALL ORIGINAL "testme" in other function
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T12:09:24.167

我不清楚你真正想做什么。在 JS 中，函数是[一流的对象](http://en.wikipedia.org/wiki/First-class_function)。因此，您可以将函数作为参数传递给另一个函数：

```
Cook("lobster", 
     "water", 
     function(x) { alert("pot " + x); }); 
```

* * *

```
order.somefunc = function(){
    // do stuff
}

order.anotherone = function(func){
    // do stuff and call function func
    func();
}

order.anotherone(order.somefunc); 
```

* * *

如果你需要从它的主体中引用未命名的函数，下面的语法应该可以工作：

```
order.recursivefunc = function f(){
    // you can use f only in this scope, afaik
    f();
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T12:59:58.627

我稍微更改了您的 loadthis 函数的签名，以便将其传递给实际加载的命令。

我还假设您的 doSomeStuff 函数接受回调函数。我假设它可能是 AJAX 调用，因此在 AJAX 调用结束时调用回调函数将是微不足道的。如果您需要有关如何从 AJAX 调用中触发此回调函数的更多信息，请评论此答案。

```
order.prototype.printMe = function(){
    order_resume.load(this, "myTestPage.html", "showData");
}

order.prototype.testme= function(){
     alert("i have been called");
}

//Then when in "loadthis" need to call 

orderRsume.prototype.load = function(order, page, action){
    //  DO SOME STUFF AND WHEN LOADS IT ARRIVES IN OnReady
    doSomeStuff(page, action, function()
    {
        order.OnReady();
    });
}

order.prototype.OnReady= function(){
  /// NEED TO CALL ORIGINAL "testme" in other function
  this.testme();
} 
```

# .net - DataContractSerializer：为什么不删除成员？

> ID：857486
> 
> 赞同：5
> 
> 时间：2009-05-13T11:42:59.733
> 
> 标签：.net, serialization, versioning, datacontractserializer, backwards-compatibility

我正在阅读 Microsoft's [Best Practices: Data Contract Versioning](http://msdn.microsoft.com/en-us/library/ms733832.aspx)，他们指出：

> 不要在以后的版本中删除数据成员，即使**IsRequired**属性在以前的版本中保留为默认属性**false 。**

任何人都可以提出任何理由吗？他们没有详细说明。由于他们说可以在以后的版本中添加数据成员，因此删除似乎也可以 - 实际上，旧版本会将其视为添加。

我想，不同之处在于您应该在最后添加新成员（使用 DataMemberAttribute 上的 Order 属性），而被删除的属性可能不会在最后。但是他们也说在加载的时候丢失的成员会保持默认值，所以很明显，丢失的成员是可以的。

我错过了什么？如果我废弃了我的产品的某个功能并删除了与之相关的 [DataMember] 属性，我会导致哪些版本互操作问题（向前兼容和向后兼容）？

此外，如果我决定对前向兼容性不感兴趣（即，如果我不担心旧版本打开新文件），是否还会存在此类问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T12:19:01.157

仅仅是因为外部服务消费者可能会提供/使用该数据（它们是在您删除某些成员之前创建的）。如果您更改了服务方法签名，`DataContractSerializer`将无法再识别`DataContract`，因为未知的数据成员。

因此，如果您的服务消费者都是已知的，那么您可以轻松地按照自己的意愿操作数据成员，只要您：

*   不要破坏消费者或
*   正确告知他们更改

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T12:22:29.577

一个问题是，即使它在序列化/反序列化期间没有中断，您也可能会丢弃数据——这意味着您无法成功地将数据往返返回给调用者。即给出简单的方法：

```
public SomeType Echo(SomeType obj) {
    return obj;
} 
```

如果调用者将带有额外属性的旧对象传递给您，他们可能希望返回该值。[您可以使用扩展数据](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iextensibledataobject.extensiondata.aspx)API （单独）启用此功能，但坦率地说，人们很少为此烦恼。

# database-design - 建议偶尔使用一个好的实体关系图构建工具？

> ID：857488
> 
> 赞同：16
> 
> 时间：2009-05-13T11:43:28.220
> 
> 标签：database-design, diagram, entity-relationship

免费软件是一个加号。您能否也用一句话描述为什么它应该足以满足偶尔使用的需求？

编辑：您可以查看这个很酷的[链接](http://www.reference.com/browse/entity-relationship+diagram)，提供有关实体关系图和工具的更多信息

编辑：对于选择的答案几个提示 - 点击实体，即使它看起来像圆圈并输入名称并输入 - 它会给你实体框 - 点击关联，Ctrl + L会给你很好的线条

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-13T13:08:09.690

您可以将[StarUML](http://staruml.sourceforge.net)与 ER 扩展一起使用。它完全免费，稳定且易于学习。

更新：09.10.2017：StarUML 不再免费！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T13:12:25.203

Dbdesigner 4 位于[http://www.fabforce.net/dbdesigner4/downloads.php](http://www.fabforce.net/dbdesigner4/downloads.php)。它是免费的，易于使用，可以进行逆向工程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-20T19:45:27.703

yEd 是一款功能强大的桌面应用程序，可用于快速有效地免费生成高质量图表。

[http://www.yworks.com/en/products_yed_about.html](http://www.yworks.com/en/products_yed_about.html)

MySQL Workbench 也很出色

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T12:49:43.807

Oracle 数据建模 - 与 Oracle、MsSQL 和 DB2 一起使用

MySQL Workbench - 与 MySQL 一起使用

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T08:47:58.793

如果您使用的是 Visual Studio - 它集成了自己的图表工具。对我来说足够好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T13:01:14.800

试试[Dezign for Databases](http://www.datanamic.com/dezign/index.html)。它非常易于使用（但对于大多数开发任务来说足够强大，支持范围广泛的数据库，最后价格（~245 美元）并不高。我个人对这个工具非常满意。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T13:05:52.873

Toad Data Modeler - 花费 400 美元，但物有所值。目前它提供了许多不错的功能，而且还在不断增加。这个工具周围有一个优秀的用户社区，并且很容易与开发团队保持联系。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-06-06T14:25:38.157

SQL Power Architect 社区版，位于[http://www.sqlpower.ca/page/architect_download_os](http://www.sqlpower.ca/page/architect_download_os)。我的一个朋友将它用于一个项目，并说它很简单，相当强大，而且免费。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-21T22:19:00.133

我在另一个答案中说过，但我还有两个建议：

1）似乎没有人提到我的大学推荐的好工具。它的 620K 下载名为`ER-Assistant`. 它的基本纯黑色/白色`ERD`，但有些类似。它是免费的并使用乌鸦脚符号，但仅限于 Windows。 [http://highered.mcgraw-hill.com/sites/0072942207/student_view0/e_r_assistant.html](http://highered.mcgraw-hill.com/sites/0072942207/student_view0/e_r_assistant.html)

2) Lucid Charts 也不错。在您获得非常复杂的图表之前，它可以免费使用。它基于网络，显然与平台无关 [https://www.lucidchart.com](https://www.lucidchart.com)

# c# - How I can find all extension methods in solution?

> ID：857489
> 
> 赞同：9
> 
> 时间：2009-05-13T11:43:45.257
> 
> 标签：c#, visual-studio-2008, extension-methods

How I can find all extension methods in solution ?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-13T11:47:53.690

If I were doing it I would search all files for the string "( this " -- your search string may differ based on your formatting options.

**EDIT**: After a little bit of experimentation, the following seems to work for me with high precision using "Find in Files" (Ctrl-Shift-F)

*   Search string: "`\( this [A-Za-z]`" (minus quotes, of course)
*   Match case: unchecked
*   Match whole word: unchecked
*   Use: Regular Expressions
*   Look at these file types: "*.cs"

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-13T12:35:54.093

我会使用反射查看生成的程序集；遍历静态类型以查找具有`[ExtensionAttribute]`...的方法

```
static void ShowExtensionMethods(Assembly assembly)
{
    foreach (Type type in assembly.GetTypes())
    {
        if (type.IsClass && !type.IsGenericTypeDefinition
            && type.BaseType == typeof(object)
            && type.GetConstructors().Length == 0)
        {
            foreach (MethodInfo method in type.GetMethods(
                BindingFlags.Static |
                BindingFlags.Public | BindingFlags.NonPublic))
            {
                ParameterInfo[] args;

                if ((args = method.GetParameters()).Length > 0 &&
                    HasAttribute(method,
                      "System.Runtime.CompilerServices.ExtensionAttribute"))
                {
                    Console.WriteLine(type.FullName + "." + method.Name);
                    Console.WriteLine("\tthis " + args[0].ParameterType.Name
                        + " " + args[0].Name);
                    for (int i = 1; i < args.Length; i++)
                    {
                        Console.WriteLine("\t" + args[i].ParameterType.Name
                            + " " + args[i].Name);
                    }
                }
            }
        }
    }
}
static bool HasAttribute(MethodInfo method, string fullName)
{
    foreach(Attribute attrib in method.GetCustomAttributes(false))
    {
        if (attrib.GetType().FullName == fullName) return true;
    }
    return false;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T11:53:22.760

也许可以使用本文中有关[如何查找针对对象的扩展方法](http://abdullin.com/journal/2009/1/10/how-to-find-extension-methods-targeting-object.html)的代码？例如，可以稍微重写并使用它来转储所有扩展方法，而不仅仅是那些针对`object`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T11:52:18.563

您只是想`(this ...`通过反射检查源代码（只需在文件中查找）或正在运行的程序（在这种情况下，[这个](https://stackoverflow.com/questions/721800/using-reflection-to-check-if-a-method-is-extension-method)讨论可以帮助您）？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T12:12:12.510

解决方案范围的文本搜索，使用与您的编码风格匹配的正则表达式。类似的东西`"( *this +"`（添加了第一个可选空间以获得一些容错性）。

# objective-c - Mixing procedural and Object oriented programming

> ID：857491
> 
> 赞同：3
> 
> 时间：2009-05-13T11:44:25.440
> 
> 标签：objective-c, oop, programming-languages

So, a long long time ago I used to program procedurally initially with Basic on my first BBC Model B and then a small amount of Pascal at university as well as assembly along the way.

Then along came OO which seemed much more sensible all round and that was all I used with C++, Perl, Java, Ruby.....

Coming back to programming non web stuff after a break of some 8 years or so on the iPhone I've found Objective C really easy to pick up but every now and again have to drop out of Objective C and back to plain old C for low level stuff and that's where it's back to procedural programming again.

What I'm after is a good guide about how to mix Object Orientated and procedural styles, how to do memory management, whether to wrap the procedural parts in object etc. etc.

Also a good basic guide to good procedural style for C would be helpful as I don't even seem to be able to think in procedural terms any more.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T12:21:02.323

我的建议是使用面向对象编程作为实现的最高级别的组织和过程编程。OO 最擅长定义接口、组件之间的契约、将代码划分为连贯的块等。

当程序员第一次开始学习对象时，有一种对对象发疯的倾向，当一个简单的内置类型就可以做到时，把所有东西都变成对象。每个数字都成为一个类，然后方法在类上激增，以防万一。它可能成为一种拖延，延迟你最终开始编写可以完成某些工作的代码的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T11:54:44.410

如果有帮助，只需将您的过程/函数视为静态类方法。您的内存引用的范围略有不同，但差别不大。如果您将函数限制为仅访问作为参数传递的数据，则更容易，因为您不必弄清楚符号。

**编辑**：我应该澄清一下，我在这里以一般的方式说话。我还没有做过任何 iPhone 开发，所以我可以谈谈那里有关内存访问/管理的细节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T13:22:42.223

据我所知，面向对象编程本质上是将数据和对这些数据的操作联系在一起。
C++ 和 Ojective-C 提供了已经成熟的机制来帮助您，但您仍然可以自己设法做到这一点。

许多 C 库只是将结构指针绑定为 OO 方法的第一个参数。
您可以通过谷歌搜索“C object oriented programming”找到更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T11:53:02.183

你不必以程序的方式思考。将所有低级别的东西包装到类中。你可以使用objective-c++。

# c# - Layout of ComboBox items

> ID：857492
> 
> 赞同：2
> 
> 时间：2009-05-13T11:44:25.737
> 
> 标签：c#, .net, wpf, xaml

I have ComboBox item style as follows (simplified):

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="35"/>
    </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0" />
            <Path Grid.Column="1" Style={StaticResource StarStyle}/>
</Grid> 
```

The result is as expected. An item in my list looks as follows:

[alt text http://robbertdam.nl/share/p1.png](http://robbertdam.nl/share/p1.png)

Howver, when I select that item. It looks like this:

[alt text http://robbertdam.nl/share/p2.png](http://robbertdam.nl/share/p2.png)

I want to have the stars right aligned. What am I missing?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T11:55:43.177

我忘了提到我已经定义了这种风格

```
 <Style x:Key="ComboItemsStyle" TargetType="{x:Type ComboBoxItem}">
            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
        </Style> 
```

将此样式分配给我的 ComboBox 解决了它：

```
 <Style x:Key="ComboStyle" TargetType="{x:Type ComboBox}">
            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
        </Style> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T11:50:15.137

“路径”对象是否具有“对齐”属性？也就是说，你能强制它与这个 XAML 对齐吗？

```
<Path Grid.Column="1" Align="Right" Style={StaticResource StarStyle}/> 
```

**编辑**

不，它没有。在这种情况下，我建议将路径嵌入到可以对齐的容器中。也许：

```
<DockPanel Grid.Column="1">
    <Path DockPanel.Dock="Right" Style={StaticResource StarStyle}/>
</DockPanel> 
```

# c# - 使用 WMI ChangeZoneType 将 DNS 区域从次要更改为主要

> ID：857494
> 
> 赞同：2
> 
> 时间：2009-05-13T11:44:58.997
> 
> 标签：c#, .net, vb.net, dns, wmi

以前有没有人在 C#\VB.net 中使用过 WMI ChangeZoneType DNS 命令。当我尝试调用 changezonetype 命令时，我得到一个不正确的参数异常。我从 dns 服务器（通过查询）获得了要更改的 dns 区域，将 zonetype 设置为适当的 uint 值，但随后出现异常。我正在尝试将区域从次要更改为主要，根据[MSDN](http://msdn.microsoft.com/en-us/library/ms682759(VS.85).aspx) ，所有其他值都是可选的（据我所知，当您想从主要更改为次要时需要）所以我没有包括它们。

下面是我正在使用的代码......

```
 For Each DNSZone As ManagementObject In mgrZones
            mngrZones = DNSZone.GetMethodParameters("ChangeZoneType")
            mngrZones("ZoneType") = System.Convert.ToUInt32(zoneType)
            DNSZone.InvokeMethod("ChangeZoneType", mngrZones, Nothing)
        Next 
```

有人有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T16:12:30.153

在环顾四周寻找一些答案后，我尝试了以下方法，它奏效了。

```
enter code here
    For Each DNSZone As ManagementObject In mgrZones            
         DNSZone("zonetype") = 1 'sets it to primary
         DNSZone.Put()
   Next 
```

尼尔

# drupal - Is the Zen theme for Drupal enterprise ready?

> ID：857495
> 
> 赞同：2
> 
> 时间：2009-05-13T11:45:21.133
> 
> 标签：drupal, e-commerce, themes

I'm starting a build of a Drupal based online store, using Ubercart etc. It is likely my client will turn over a lot of sales on the site, so it must be secure.

Of course I will want to create a unique theme for this, so is [Zen](http://drupal.org/project/zen) a good place to start or should I avoid it and start from scratch?

Quote:

> Zen is the ultimate starting theme for Drupal. If you are building your own standards-compliant theme, you will find it much easier to start with Zen than to start with Garland or Bluemarine

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T22:53:26.923

Zen 主题旨在为您完成一些基本设置，例如创建内容优先的布局，并为您构建一些常用的变量。如果您从现有的 XHTML 设计开始并希望将其转换为 Drupal，则最好跳过 zen 并从头开始构建主题。

Zen 很独特，也有自己的优点和缺点，有点像使用 CSS 框架。安全性比它添加到 Drupal 主题的额外概念复杂性更令人担忧。如果您习惯了它并且正在制作主题，它是一个有用的电动工具，否则它会增加混乱。不过，安全性不是问题：在这方面很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T02:37:55.970

这是迄今为止对初学者主题最完整/最精彩的评论：

[http://www.chapterthree.com/blog/review-drupal-6-starter-themes](http://www.chapterthree.com/blog/review-drupal-6-starter-themes)

[它在http://drupal.org/project/studio](http://drupal.org/project/studio)之前就已经存在了，所以除了这些之外还要考虑工作室。

也就是说，每当我有选择时，我都会选择[Zen](https://www.drupal.org/project/zen)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T12:40:09.873

以我的经验，是的，从一些包含所有必需内容的基本模板开始（而不是从头开始）更容易。Zen 与 Drupal 一样简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T13:59:11.023

我发现框架主题更好更简单。Zen 主题更像是开发主题的库。

# php - Unlimited diskspace/Bandwidth for hosting ASP.NET vs PHP website?

> ID：857497
> 
> 赞同：0
> 
> 时间：2009-05-13T11:45:26.220
> 
> 标签：php, asp.net, hosting, bandwidth, diskspace

We are thinking to use **Dotnetnuke(ASP.NET)** as platform for creating asp.net based social networking site. Surprisingly, Its difficult to find webhost with **unlimited diskspace/badnwidth** to store/stream lots of photos/videos.

On the other hand, *PHP based webhosting companies do provide unlimited diskspace/bandwidth*. Check it [here](http://www.top10webhosting.com)

So, I have two questions:

1) Does Diskspace/Bandwidth in webhosting scenario have anything to do with technology(PHP/ASP.NET) and OS(Windows/Linux)?

2) Recommendation of hosting providers with diskspace/Bandwidth for hosting ASP.NET website.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T12:10:03.667

您找不到的原因是没有任何主机可以为您提供无限带宽，因为它是一种有限的资源。检查所有这些产品的条款，您会发现当他们说“无限制”时，它们通常表示“没有任意限制”，但这与“您可以使用任意数量的带宽”不同。

使用您提供的那个列表，我去了 HostMonster，他恰好是列表的顶部，他们用他们的术语说：

> **“无限”是什么意思**。HostMonster.Com 没有对单个订阅者可以使用的资源数量设置任意限制或上限。...snip ... 因此，**一个典型的网站可能会经历一段非常受欢迎的时期，并因此增加了存储空间，而没有经历任何相关的托管费用增加**。

基本上，如果你被slashdotted，那么他们不会把你打断。这与永远忙碌不同。

> **“无限”并不意味着什么。**... snip ... HostMonster.Com 提供的“无限”服务并非旨在允许单个或少数订阅者的行为不公平或不利地影响其他订阅者的体验。
> 
> HostMonster.Com 的服务是共享托管服务，这意味着**多个订阅者网站托管在同一台服务器上并共享服务器资源**。HostMonster.Com 的服务旨在满足美国小型企业和家庭企业网站订户的典型需求。**它并非旨在支持大型企业、国际企业或更适合专用服务器的非典型应用程序的持续需求**。

如果您想要尽可能多的带宽，则需要为此付费。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T12:00:41.327

对于像社交网站这样大的东西，您希望查看自己的服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T12:11:34.977

PHP/MySQL 是免费的，因为它是开源的——托管公司可以以“额外”的方式为您提供更多——例如更大的磁盘空间和带宽。微软堆栈花费数千美元，他们必须把这笔钱赚回来！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T14:45:52.617

适合您情况的最佳解决方案似乎是 VPS，您需要的所有控制成本只是专用服务器的一小部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T14:50:38.850

查看一些云存储解决方案，例如 Amazon 的 S3 或 Mosso 的 Cloud Files。这是无限的空间/带宽，但就像每个人都说的那样 - 没有什么是免费的。不过价格很公道。

# windows - WCHAR array not properly marshalled

> ID：857507
> 
> 赞同：0
> 
> 时间：2009-05-13T11:47:06.670
> 
> 标签：windows, com, interop, marshalling

I have a COM interface with a following method definition (IDL notation):

```
SCODE GetText( [in, out] ULONG* pcwcBuffer,
              [out, size_is(*pcwcBuffer)] WCHAR* awcBuffer ); 
```

Typelib marshaling is used for COM+, the type library is registered, other methods of the interface work allright when called through COM+, but not this method.

The server side copies an array of WCHARs into the `awcBuffer` and its length into `pwcBuffer`, no buffer overrun ever occurs.

```
static const wchar_t* Text = L"Sample";
STDMETHODIMP CImpl::GetText( ULONG* bufferLength, WCHAR* buffer )
{
    const int length = wcslen( Text );
    *bufferLength = length;
    memcpy( buffer, Text, length * sizeof( WCHAR ) );
    return S_OK;
} 
```

When the client calls this method through COM+ the buffer contents gets lost. Specifically only the first wide char is preserved - if the server copies "Sample" wide character string, the client only receives "S" string. The return value on the client size is S_OK, the buffer length returned to the client is exactly the same as what the server copied.

I finally switched to BSTR to workaround this problem but it's really interesting why the whole valid looking construct doesn't work.

What's the possible reason of the described behaviour?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T12:43:32.613

IIRC，typelib 编组器忽略 size_is 属性——因此，只有 1 个字符被编组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T12:53:33.707

J. 传球是对的。要使 typelib 编组器工作，COM 接口必须与 OLE 自动化兼容。typelib marshaller 是在 oleaut32.dll 中实现的，所以我猜名字里有线索。

[size_is] 是完全有效的 IDL，并编译成有效的类型库，但类型库封送器只能处理有效接口的子集。该子集通常称为 OLE 自动化。顺便说一句，VB6 客户端只能说 OLE 自动化，因此他们也无法使用您的界面。

尝试使用 IDL 中的 [oleautomation] 属性标记您的接口。它应该给你一个警告或错误消息，可能会指向你关于这个主题的更多信息。

在“普通”COM 中，您可以从 IDL 生成代理/存根 DLL 来进行编组，但恐怕我不记得 COM+ 是否会使用您的自定义编组代码，即使您费心构建它。

更新：在 Juval Lowy 的“COM 和 .NET 组件服务”一书中，我发现了这样的声明：“ *...配置的组件不能使用需要自定义封送处理的接口*”。所以我猜这个接口永远不会在 COM+ 中工作。如果可以，请重新编写以使用 BSTR。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T12:13:45.987

几个问题：

*   你为什么不使用`BSTR`？
*   你有`GetText`函数的来源吗？
*   函数返回的缓冲区大小是多少？

# java - Monitor JRockit JVM via SNMP

> ID：857513
> 
> 赞同：4
> 
> 时间：2009-05-13T11:48:15.637
> 
> 标签：java, snmp, jrockit

I would like to monitor my Java application (running in JRockit) via SNMP protocol. I only need some basic informations. Is there any startup parameter that I can add to my app to enable SNMP?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T13:09:22.467

JRockit 中的 SNMP 与 Sun 的 JVM 中的工作方式相同。详情在[这个网页上](http://java.sun.com/j2se/1.5.0/docs/guide/management/SNMP.html)。

简而言之，您要做的是：

1.  从...开始`-Dcom.sun.management.snmp.port=portNum`
2.  将 ACL 模板文件复制`JRE_HOME/lib/management/snmp.acl.template`到中`JRE_HOME/lib/management/snmp.acl`，并使其只有所有者可读可写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T14:05:18.597

我不相信 JRockit 可以在 SNMP 上发布统计信息。我所看到的监控系统所做的是连接 JRockit 中的 JMX 监控点......

当然你也可以使用上面提到的 JMX bean 中插入的 JRMC 工具。

HTH 汤姆

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T14:12:57.273

标准 JRockit JVM 不支持 SNMP。最常见的方法是附加一个 JMX SNMP 连接器。我以前使用过[AdventNet 之一](http://www.adventnet.com/products/snmpadaptor/index.html)。

# sql-server-2005 - CLR Stored Procedures: alternatives to SqlContext.Pipe.SendResultsStart / SendResultsRow / SendResultsEnd?

> ID：857514
> 
> 赞同：3
> 
> 时间：2009-05-13T11:48:19.023
> 
> 标签：sql-server-2005, stored-procedures, clr

A related question to a previous one regarding the same subject. In a CLR stored procedure, I am bulding a collection of objects which represent a data set after a complex filtering. This collection is then "translated" in a resulset with the SqlContext.Pipe.SendResultsStart / SendResultsRow / SendResultsEnd loop and delivered.

Despite this works as it should, it doesn't feel optimal because of the loop etc. Are there any better alternatives to, say, convert collections to SQL resultsets on the fly?

Thanks in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-25T08:17:45.353

更好的选择是将集合组织成一个 xml 文档。（您可以通过 .NET 库轻松完成）然后您可以使用 sql node xml 方法解析 xml 文档以返回结果集。您可以使用 LINQ 库将集合转换为 XML。设计水平会根据上下文而变化。但我发现这种方式非常有效。

# javascript - Screen Scraping from a web page with a lot of Javascript

> ID：857515
> 
> 赞同：17
> 
> 时间：2009-05-13T11:48:52.127
> 
> 标签：javascript, html, dom, screen-scraping

I have been asked to write an app which screen scrapes info from an intranet web page and presents the certain info from it in a nice easy to view format. The web page is a real mess and requires the user to click on half a dozen icons to discover if an ordered item has arrived or has been receipted. As you can imagine users find this irritating to say the least and it would be nice to have an app anyone can use that lists the state of their orders in a single screen.

Yes I know a better solution would be to re-write the web app but that would involve calling in the vendor and would cost us as small fortune.

Anyway while looking into this I discovered the web page I want to scrape is mostly Javascript (although it doesn't use any AJAX techniques). Does anyone know if a library or program exists which I could feed with the Javascript and which would then spit out the DOM for my app to parse ?

I can pretty much write the app in any language but my preference would be JavaFX just so I could have a play with it.

Thanks for your time.

Ian

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T12:15:22.160

您可以考虑使用[HTMLunit](http://htmlunit.sourceforge.net) 这是一个无需控制浏览器即可自动浏览的 java 类库，它集成了 Mozilla Rhino Javascript 引擎来处理它加载的页面上的 javascript。还有一个 JRuby 包装器，名为 Celerity。它的 javascript 支持现在还不是很完美，但是如果你的页面不使用很多 hack，那么性能应该比控制浏览器好得多。此外，您不必担心在抓取结束后 cookie 以及与控制浏览器相关的所有其他讨厌的事情（历史记录、自动完成、临时文件等）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T12:26:20.037

既然您说没有使用 AJAX，那么所有信息都存在于 HTML 源中。javascript 只是根据用户点击来呈现它。因此，您需要对应用程序的工作方式进行逆向工程，解析 html 和 javascript 代码并提取有用信息。这是严格的文本解析业务——你不应该处理运行 javascript 和生成新的 DOM。这将更难做到。

如果使用 AJAX，你的工作会更轻松。您可以轻松了解 AJAX 服务的工作方式（可能通过接收 JSON 和 XML）并提取信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T12:57:12.903

您可以考虑使用greasemonkey JS。Greasemonkey 是一个非常强大的 Firefox 插件，它允许您在特定网站的同时运行自己的脚本。这允许您修改网站的显示方式、添加或删除内容。您甚至可以使用它进行 AJAX 样式查找和添加动态内容。

如果您的工具是供内部使用的，并且用户都乐于使用 Firefox，那么这可能是赢家。

问候

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-17T16:09:34.510

我建议 IRobotSoft 网络刮刀。它是一款专用的免费屏幕抓取软件，具有最佳的 javascript 支持。您可以使用其可视界面创建和测试机器人。您还可以使用其 ActiveX 控件将其嵌入到您自己的应用程序中并隐藏浏览器窗口。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T12:56:23.187

我同意[kgiannakakis 的回答](https://stackoverflow.com/questions/857515/screen-scraping-from-a-web-page-with-a-lot-of-javascript/857672#857672)。如果您不能对 javascript 进行逆向工程以识别信息的来源，然后使用[Urllib2](http://www.voidspace.org.uk/python/articles/urllib2.shtml)和[Beautiful Soup 库](http://www.crummy.com/software/BeautifulSoup/)编写一些简单的 Python 脚本来抓取相同的信息，我会感到惊讶。

如果 Python 和抓取是一个新想法，那么有一些关于如何开始的优秀[教程。](http://www.palewire.com/2008/04/20/python-recipe-grab-a-page-scrape-a-table-download-a-file/)

**[编辑]**看起来也[有 Python 版本的 mechanize](http://wwwsearch.sourceforge.net/mechanize/)。是时候重新编写我不久前开发的一些刮板了！:-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-02-20T16:28:50.230

我创建了一个项目[site2archive](https://github.com/damoeb/site2archive)，它使用*phantomJs*来渲染包括 JS 内容和*wget*来抓取。*phantomJs*基于 Webkit，提供与 Safari 和 Google Chrome 类似的浏览环境。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T12:10:12.200

我会选择 Perl 的[Win32::IE::Mechanize](http://search.cpan.org/~abeltje/Win32-IE-Mechanize-0.009/lib/Win32/IE/Mechanize.pm)，它可以让您自动化 Internet Explorer。您应该能够单击图标并提取文本，同时让 MSIE 完成处理所有 JS 的烦人任务。

# branch - 关于扩展使用分支的利弊

> ID：857521
> 
> 赞同：0
> 
> 时间：2009-05-13T11:51:43.183
> 
> 标签：branch, process, code-organization, configuration-management

我希望能够为大多数可想到的情况和组织选择正确的分支策略。因此，我正在寻找在开发组织中扩展代码存储库分支的使用的积极和消极影响的广泛列表。

请在每个帖子中只发布一个赞成*或* **反对***的*意见，以便投票系统可以帮助对反馈进行排名。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T11:59:44.387

优点：通过将最新部署的版本保留在主干中，可以快速推出小型修复，而无需对最新开发版本进行广泛测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T11:51:56.473

**优点：**开发人员可以在更紧密的迭代中更自由地工作，而不会踩到彼此的脚。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T11:55:56.593

优点：如果您有很多分支，您将被迫采用现代 DVCS（我的经验是使用 Mercurial，但我听说 git 或 Bazaar 也不错），而不是继续使用传统的集中式系统（例如 svn）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-13T12:06:43.953

**优点：**分支可用于在尝试新代码时促进“假设”场景。最后可以做出合并新功能或放弃它的决定。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T11:56:56.467

**骗局（它可能是一个大骗局）：**在未来的某个时间点合并。持续时间越长，代码库的偏差越大，你的生活就会越艰难。我的建议：非常仔细地考虑分支并确保仅在必要时才这样做，并在以后需要时考虑合并所涉及的工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-13T12:11:13.900

**缺点：**同时在空中有太多的分支，你开始忘记在哪里提交了东西，在哪里进行了更改等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T12:05:38.543

**缺点**：合并噩梦。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T21:05:29.067

**优点：**为同时开发或支持多个工作流而分散代码具有更大的灵活性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-13T11:52:19.453

**缺点：**初级开发人员的学习门槛更高。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-13T12:04:20.977

**优点**：每次更新都独立于其他更新，因此可以并行工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-13T12:28:04.340

**缺点：****必须**有人管理分支机构并保持领先地位。在大多数团队中，这都是靠边站的。

# sql - Char(4) 与 int 作为表中的 StatusID/StatusCode 列

> ID：857530
> 
> 赞同：2
> 
> 时间：2009-05-13T11:53:58.640
> 
> 标签：sql, sql-server

我需要一个包含十几个可能值的状态列。有什么理由我应该选择 int (StatusID) 而不是 char(4) (StatusCode)？由于 sql server 不支持命名常量，因此在存储过程和视图中用作常量时，char 比 int 更具描述性。为了澄清，我仍然会使用查找表。因为我需要一个更具描述性的 UI 文本。所以这个决定只是为了在我维护存储过程和视图时帮助我作为开发人员。

现在我倾向于 char(4)。尤其是因为在 SQL Server Management Studio 中设计视图会阻止我添加注释（我知道可以在脚本编辑器中添加它，但实际上我会更频繁地使用视图设计器，尤其是在视图微不足道的情况下）。StateCODE = 'NEW' 比 StateID = 1000 更具可读性。我想问题是是否存在 char(4) 有问题的情况，并且由于数据库非常小，我不太担心轻微的性能影响（喜欢使用 TinyInt 与 int)，但更怕代码维护问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T12:07:50.427

数据库纯粹主义者会说键在业务领域中应该没有意义，并且您应该创建一个状态表，您可以在其中查找状态的描述和其他含义。

但对于运营商和最终用户而言，拥有描述性状态代码可能是一件好事。它甚至不必是 char(4)，你可以将其设为 varchar(20)。这允许他们在没有连接的情况下进行查询，并以更简单的方式检查数据库。

最后，我认为char(20)组织会运行得更顺畅，周五早点回家。但是 int 组织对数据库有更好的抽象，他们可以在周五晚上享受元编程（或在论坛上进行推广。）

（所有这一切都假设您正在编写业务支持软件。更成功的业务支持系统之一 SAP 成功地使用了有意义的密钥。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T12:12:12.917

每种方法都有很多优点和缺点。我确信会出现其他支持使用 char(4) 的论点。我选择 int 而不是 char 的原因包括：

1.  我总是使用查找表。它们允许保留并轻松检查价值的审计跟踪。例如，如果您的状态代码之一是“MING”，并且做出了从某个日期将其从“MING”更改为“MONG”的业务决策，我的查找表会处理此问题。

2.  更小的索引——如果你需要索引这个列，它会更薄。

3.  可扩展性 - 好的，我提出了这个词，但是如果您需要从 4 个字符变为 5 个字符，例如，查找表将是一种祝福。

4.  描述：我们在这里使用了很多 TLA，一旦您知道它们是什么就很棒，但是如果我给商业用户一份报告说“GDA 的 2007 1001”，他们不一定会认为 GDA = Good Dead on Arrival。使用查找表，我可以添加此描述。

5.  最佳实践：找不到手头的链接，但这可能是我在 K.Tripp 文章中读到的内容。旨在使您的聚集主键递增整数以优化索引。

当然，如果你绝对肯定你永远不需要超过 4 个字符，那么没有理由不把它放在桌子上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T12:11:26.693

最好的事情应该是具有定义值的**查找表**，然后将其与使用该*枚举*的原始表相关联。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T12:12:44.443

排序模糊是对 char 4 说不的原因之一： ABcD = abCD = äBCd 吗？

如果您有 12 个可能的值，为什么不使用 tinyint/byte 和状态表？如果您必须存储 1000 万行的状态，则 3 个字节不同并且排序规则/字符串比较加起来。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T12:14:59.353

我遇到这个用例的地方是列，这些列将映射到我在编程时通常会使用枚举的东西。您是否将 Enum 的整数值或 Enum 的名称存储在数据库列中？老实说，我已经做到了这两种方式。通常，我会问自己数据库是否会在我正在构建的应用程序之外使用。如果是这样，我将选择人类可读的格式存储在数据库中。如果不是，那么我将选择整数值，因为它可以在代码中重构（它只是一个强制转换而不是解析操作）Enum 时节省一点时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T12:11:26.100

您也可以在 int 上使用 tinyint

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T13:48:45.753

我总是选择 int 只是因为它们更容易映射到代码中的枚举。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T14:20:06.763

如果您正在处理大量数据和高吞吐量，那么 smallint 或 tinyint 可以提供更好的性能和更小的硬盘占用空间。如果您的应用程序中的数据通常通过 Access 或 Cognos 等应用程序直接查看，那么您的业务人员可能会喜欢这些描述性值。我知道，当我作为数据库开发人员角色的一部分分析数据时，我厌倦了加入许多查找表，因为我不记得是 1 = Foo 和 2 = Bar 还是 1 = Bar 和 2 = Foo。

此外，尽管如果您必须通过这些可能具有较小索引的代码来查找行，性能会得到提高，但如果您经常查找行而不考虑代码，则必须执行连接也可能会受到伤害（以较小的方式）但是您必须在其中包含文本值。在大多数应用程序中，这不是问题，并且可能只会在大型数据仓库/报告环境中发挥作用。

# java - 将 Maven 项目信息注入 Swing 应用程序框架资源？

> ID：857540
> 
> 赞同：1
> 
> 时间：2009-05-13T11:55:54.253
> 
> 标签：java, swing, maven-2, appframework

我有一个使用 Swing 应用程序框架的 Maven 项目，并且想将 pom.xml 中的项目信息注入到我的应用程序的全局资源中以避免重复。

基本应用程序（通过 netbeans 提供）使用 Application.title、Application.version、Application.vendor、Application.description 资源等用于窗口标题和框配置，但我找不到在运行时以编程方式设置这些值的方法，并且我不是 maven maven，所以没有技能在构建时注入它们。

有人对如何最好地达到预期结果有任何建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-11-04T21:45:32.077

您可以尝试使用[过滤资源](http://www.sonatype.com/books/maven-book/reference/resource-filtering-sect-description.html)。如果您创建一个属性文件，请说它`src/main/resources/com/myapp/app.properties`看起来像这样：

```
version=${project.version}
name=${project.name}
id=${project.artifactId} 
```

他们需要在您的`pom.xml`：

```
<build>
  <resources>
    <resource>src/main/resources</resource>
    <filtering>true</filtering>
  </resources>
</build> 
```

现在，当 maven 构建您的项目时，它将展开属性文件，并将其放在类路径中。然后您可以调用[getResourceAsStream("/com/myapp/app.properties")](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#getResourceAsStream(java.lang.String))将其读入您的应用程序。

Whist maven 会自动创建一个文件`/META-INF/maven/$groupId/$artifactId/pom.properties`，这可能没有您需要的所有信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T12:07:25.810

您可以将它们保存在单独的属性文件中，并从 pom.xml 和您的应用程序中读取它。

另一种选择是从类路径中读取 pom.xml 文件（mvn 会将其放在 META-INF 文件夹中）并从那里将其解析为纯 xml 文件。

我会选择第一个选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T12:09:08.163

我会尝试使用 maven-antrun-plugin。将必要的 maven 属性传递给 ant 并创建一个 ant 构建脚本，该脚本直接修改应用程序属性文件或 spring 上下文配置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T09:27:35.517

另一种方法是使用 properties-maven-plugin 生成一个单独的属性文件，然后将此属性文件添加到应用程序包名称中：

对于`pom.xml`要写入的`application.properties`文件：

```
<build>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>properties-maven-plugin</artifactId>
            <version>1.0-alpha-2</version>
            <executions>
                <execution>
                    <phase>process-resources</phase>
                    <goals>
                        <goal>write-project-properties</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <outputFile>${project.build.outputDirectory}/application.properties</outputFile>
            </configuration>
        </plugin>
        ...
    </plugins>
    ...
</build> 
```

将 包含`application.properties`到您的应用程序中：

```
public class MyApplication extends SingleFrameApplication

    public MyApplication() {
        super();
        addGeneratedApplicationProperties();
    }

    private void addGeneratedApplicationProperties() {
        ResourceManager resourceManager = getContext().getResourceManager();
        getContext().setApplicationClass(MyApplication.class);
        List<String> bundleNames = new LinkedList<String>(resourceManager.getApplicationBundleNames());
        bundleNames.add(0, "application");
        resourceManager.setApplicationBundleNames(bundleNames);
    }

    ...
} 
```

但是，我发现 maven-filter-solution 方式更优雅。

# awk - AWK 语法问题

> ID：857543
> 
> 赞同：1
> 
> 时间：2009-05-13T11:56:00.930
> 
> 标签：awk

我想使用 awk 从 100 中减去一列。我努力了

```
awk '{ t = 100-$2 } END { print t }' /alps/average.log 
```

它只给了我减去的最后一个值。如果我想在终端上输出整列，如何实现？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T11:59:25.247

尝试这个：

```
awk '{print 100-$2}' /alps/average.log 
```

标签后的命令`END`仅在文件结束后执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T11:58:43.607

`print t`在未标记的块中，绝对不是在标记的块中`END`！

# c# - 实现异步方法

> ID：857544
> 
> 赞同：0
> 
> 时间：2009-05-13T11:56:18.933
> 
> 标签：c#, asynchronous

我正在寻找在类库中实现方法的同步和异步版本。目前我已经这样做了，以便 Async 方法触发一个新线程并对其进行处理。要确定操作是否已完成，用户应轮询属性以查看它是否已完成。

我想改进它，我认为使用某种形式的异步回调或结果会更好，但我不确定如何实现它，或者，如果确实有必要。任何人都可以提供任何建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T11:57:57.947

```
public static void Queue(Action action, Action done) {
    ThreadPool.QueueUserWorkItem(_ =>
    {
        try {
            action();
        } 
        catch (ThreadAbortException) { /* dont report on this */ } 
        catch (Exception ex) {
            Debug.Assert(false, "Async thread crashed! This must be fixed. " + ex.ToString());
        }
        // note: this will not be called if the thread is aborted
        if (done != null) done();
    });
} 
```

用法：

```
 Queue( () => { Console.WriteLine("doing work"); }, 
           () => { Console.WriteLine("work was done!"); } ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-09T07:56:57.540

您可以使用回调方法而不是轮询。查看我对[AsyncCallback的回答](https://stackoverflow.com/questions/1047662/asynccallback/1047677#1047677)

**编辑：**

使用带有回调的自己的异步委托的 FileCopy 示例：

```
 public class AsyncFileCopier
    {
        public delegate void FileCopyDelegate(string sourceFile, string destFile);

        public static void AsynFileCopy(string sourceFile, string destFile)
        {
            FileCopyDelegate del = new FileCopyDelegate(FileCopy);
            IAsyncResult result = del.BeginInvoke(sourceFile, destFile, CallBackAfterFileCopied, null);
        }

        public static void FileCopy(string sourceFile, string destFile)
        { 
            // Code to copy the file
        }

        public static void CallBackAfterFileCopied(IAsyncResult result)
        {
            // Code to be run after file copy is done
        }
    } 
```

您可以将其称为：

```
AsyncFileCopier.AsynFileCopy("abc.txt", "xyz.txt"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T12:03:29.390

异步委托可能是另一种选择。

阅读MSDN 上的[使用委托进行异步编程](http://msdn.microsoft.com/en-us/library/22t547yb.aspx)

# c# - 如何使用 DirectShow.NET C# 访问音频流

> ID：857546
> 
> 赞同：4
> 
> 时间：2009-05-13T11:57:14.827
> 
> 标签：c#, .net-3.5, streaming, directshow, directshow.net

我想做的是将任意音频文件传递给 DirectShow 过滤器并最终使用 .NET 3.5 C# 和 DirectShow.NET 接收（PCM 音频）流对象。我想达到我可以说的一点：

```
 Stream OpenFile(string filename) {...} 
```

和

```
stream.Read(...) 
```

我已经在 DirectShow 上阅读了几天，并认为我已经开始掌握过滤器和过滤器图的概念。我找到了示例（[到文件](http://www.informikon.com/directshow-tutorials/yet-another-capture-sample-in-c.html)/[到设备](http://replay.waybackmachine.org/20091021154718/http://geocities.com/contactgirish/DirectShow.html)）如何播放音频或将其写入文件，但似乎找不到 Stream 对象的解决方案。这甚至可能吗？如果我错过了什么，你能给我指出正确的方向吗？

最好的，

豪克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-14T16:12:55.083

我想与您分享我自己的问题的解决方案（我的重点是异国情调的 bwf 文件格式。因此得名。）：

```
 using System;
    using System.Collections.Generic;
    using System.Text;
    using DirectShowLib;
    using System.Runtime.InteropServices;
    using System.IO;

    namespace ConvertBWF2WAV
    {
        public class BWF2WavConverter : ISampleGrabberCB
        {
            IFilterGraph2 gb = null;
            ICaptureGraphBuilder2 icgb = null;
            IBaseFilter ibfSrcFile = null;
            DsROTEntry m_rot = null;
            IMediaControl m_mediaCtrl = null;
            ISampleGrabber sg = null;

            public BWF2WavConverter() 
            { 
                // Initialize
                int hr;
                icgb = (ICaptureGraphBuilder2)new CaptureGraphBuilder2();
                gb = (IFilterGraph2) new FilterGraph();
                sg = (ISampleGrabber)new SampleGrabber();

    #if DEBUG
                m_rot = new DsROTEntry(gb);
    #endif
                hr = icgb.SetFiltergraph(gb);
                DsError.ThrowExceptionForHR(hr);
            }

            public void reset()
            {
                gb = null;
                icgb = null;
                ibfSrcFile = null;
                m_rot = null;
                m_mediaCtrl = null;
            }

            public void convert(object obj) 
            {
                string[] pair = obj as string[];
                string srcfile = pair[0];
                string targetfile = pair[1];

                int hr;

                ibfSrcFile = (IBaseFilter)new AsyncReader();
                hr = gb.AddFilter(ibfSrcFile, "Reader");
                DsError.ThrowExceptionForHR(hr);

                IFileSourceFilter ifileSource = (IFileSourceFilter)ibfSrcFile;
                hr = ifileSource.Load(srcfile, null);
                DsError.ThrowExceptionForHR(hr);

                // the guid is the one from ffdshow
                Type fftype = Type.GetTypeFromCLSID(new Guid("0F40E1E5-4F79-4988-B1A9-CC98794E6B55"));
                object ffdshow = Activator.CreateInstance(fftype);
                hr = gb.AddFilter((IBaseFilter)ffdshow, "ffdshow");
                DsError.ThrowExceptionForHR(hr);

                // the guid is the one from the WAV Dest sample in the SDK
                Type type = Type.GetTypeFromCLSID(new Guid("3C78B8E2-6C4D-11d1-ADE2-0000F8754B99"));
                object wavedest = Activator.CreateInstance(type);
                hr = gb.AddFilter((IBaseFilter)wavedest, "WAV Dest");
                DsError.ThrowExceptionForHR(hr);

                // manually tell the graph builder to try to hook up the pin that is left
                IPin pWaveDestOut = null;
                hr = icgb.FindPin(wavedest, PinDirection.Output, null, null, true, 0, out pWaveDestOut);
                DsError.ThrowExceptionForHR(hr);

                // render step 1
                hr = icgb.RenderStream(null, null, ibfSrcFile, (IBaseFilter)ffdshow, (IBaseFilter)wavedest);
                DsError.ThrowExceptionForHR(hr);

                 // Configure the sample grabber
                IBaseFilter baseGrabFlt = sg as IBaseFilter;
                ConfigSampleGrabber(sg);
                IPin pGrabberIn = DsFindPin.ByDirection(baseGrabFlt, PinDirection.Input, 0);
                IPin pGrabberOut = DsFindPin.ByDirection(baseGrabFlt, PinDirection.Output, 0);
                hr = gb.AddFilter((IBaseFilter)sg, "SampleGrabber");
                DsError.ThrowExceptionForHR(hr);
                AMMediaType mediatype = new AMMediaType();
                sg.GetConnectedMediaType(mediatype);

                hr = gb.Connect(pWaveDestOut, pGrabberIn);
                DsError.ThrowExceptionForHR(hr);

                // file writer
                FileWriter file_writer = new FileWriter();
                IFileSinkFilter fs = (IFileSinkFilter)file_writer;
                fs.SetFileName(targetfile, null);
                hr = gb.AddFilter((DirectShowLib.IBaseFilter)file_writer, "File Writer");
                DsError.ThrowExceptionForHR(hr);

                // render step 2
                AMMediaType mediatype2 = new AMMediaType();
                pWaveDestOut.ConnectionMediaType(mediatype2);
                gb.Render(pGrabberOut);

                // alternatively to the file writer use the NullRenderer() to just discard the rest

                // assign control
                m_mediaCtrl = gb as IMediaControl;

                // run
                hr = m_mediaCtrl.Run();
                DsError.ThrowExceptionForHR(hr);

            }

            //
            // configure the SampleGrabber filter of the graph
            //
            void ConfigSampleGrabber(ISampleGrabber sampGrabber)
            {
                AMMediaType media;

                // set the media type. works with "stream" somehow...
                media = new AMMediaType();
                media.majorType = MediaType.Stream;
                //media.subType = MediaSubType.WAVE;
                //media.formatType = FormatType.WaveEx;

                // that's the call to the ISampleGrabber interface
                sg.SetMediaType(media);

                DsUtils.FreeAMMediaType(media);
                media = null;

                // set BufferCB as the desired Callback function
                sg.SetCallback(this, 1);
            }

            public int SampleCB(double a, IMediaSample b)
            {
                return 0;
            }

            /// <summary>
            /// Called on each SampleGrabber hit.
            /// </summary>
            /// <param name="SampleTime">Starting time of the sample, in seconds.</param>
            /// <param name="pBuffer">Pointer to a buffer that contains the sample data.</param>
            /// <param name="BufferLen">Length of the buffer pointed to by pBuffer, in bytes.</param>
            /// <returns></returns>
            public int BufferCB(double SampleTime, IntPtr pBuffer, int BufferLen)
            {
                byte[] buffer = new byte[BufferLen];
                Marshal.Copy(pBuffer, buffer, 0, BufferLen);
                using (BinaryWriter binWriter = new BinaryWriter(File.Open(@"C:\directshowoutput.pcm", FileMode.Append)))
                {
                    binWriter.Write(buffer);
                }
                return 0;
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T12:15:30.010

这（[AVILibrary Wrapper](http://www.codeproject.com/KB/audio-video/avifilewrapper.aspx)）可能会引导您找到一个解决方案，它不是基于 DirectSound 的（我觉得它非常倾向于将您的代码与播放硬件接口）但可能是答案。

另一种方法可以在[这里](http://www.csharp-home.com/index/tiki-read_article.php?articleId=110)找到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T15:25:10.377

NAudio怎么样？[http://www.codeplex.com/naudio](http://www.codeplex.com/naudio) 它有一个流实现。

# dsl-tools - 如何在 DSL 工具图中嵌套形状？

> ID：857548
> 
> 赞同：0
> 
> 时间：2009-05-13T11:58:26.183
> 
> 标签：dsl-tools

我有一个包含两个主要域类的 DSL：Area 和 Entity。区域由 GeometryShape 在视觉上表示，而实体由 CompartmentShape 表示。实体可以嵌入到区域中，也可以不嵌入（在这种情况下，它们嵌入在根对象中，这是一种区域）。实体之间可能存在关系，包括不同领域的实体之间。区域不能嵌入到其他区域内，实体也不能嵌入到其他实体内。

我的问题是我无法从图表中获得我想要的行为。实体在区域中的嵌入在模型级别上运行得非常好，但视觉表示表现不稳定。例如，如果我拖动在该区域之外的区域中创建的实体，它不再响应鼠标单击（我有执行重新父级的代码，但不知何故，事物的图表方面被破坏了）。

我已经到处搜索了如何做到这一点的样本，但结果都是空的。我在网上找到的每个示例都通过“引用”关系模拟嵌套，而我正在执行域类（以及它们关联的形状类）的真正嵌入。

有没有人有如何做到这一点的例子？

当我发泄时，我是唯一一个认为图表/形状类被大量记录不足的人吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T12:49:21.543

[我相信在Domain-Specific Development with Visual Studio DSL Tools](https://rads.stackoverflow.com/amzn/click/com/0321398203)中有一个例子。此外，您可能想在[Visual Studio 可扩展性](http://social.msdn.microsoft.com/Forums/en-US/vsx/threads)论坛上提问。

# java - 将问题附加到孩子

> ID：857555
> 
> 赞同：1
> 
> 时间：2009-05-13T11:59:47.630
> 
> 标签：java, xml, dom

我正在尝试使用 Java 和 org.w3c.dom 制作一些简单的 XML，但是当我尝试将孩子附加到孩子时遇到了困难，如下所示：

```
<root>
     <child>
          <childOfTheChild>Some text</childOfTheChild>
     </child>
</root> 
```

我尝试了很多这样的变体（比如首先附加孩子而不是创建 childOfTheChild 等）：

```
Element root = doc.getDocumentElement();

Element child = doc.createElement("child");
Element childOfTheChild = doc.createElement("childOfTheChild ");

Text st = doc.createTextNode("Some text");

childOfTheChild.appendChild(st);
child.appendChild(childOfTheChild );

root.appendChild(child); 
```

我总是得到相同的结果，即：

```
<root>
     <child>null</child>
</root> 
```

这段代码有问题还是可能有其他问题？

***编辑：***

打印功能可以与一些测试 XML 一起正常工作......因此，该功能没有一些美感校正：

```
//Call System.out.println( print(dokument.getFirstChild()) );
private String print(Node node) {

    String txt = "";  //xml string presentation

    //Get the primary node name and any existing attributes, like <myNode att1='some val'>
    if (node.getNodeType() == node.ELEMENT_NODE) 
    {
        //The name
        txt += "<" + node.getNodeName();

        //Insert the attributes
        if (node.hasAttributes()) 
        {
            NamedNodeMap atts = node.getAttributes();
            for (int i = 0; i < atts.getLength(); i++) {
                Node atts = atts.item(i);
                txt += " " + atts.getNodeName() + " = '" + atts.getNodeValue() + "'";
            }
        }
        txt +=  ">\n";
    }

    int nChilds = -1;

    //Get any existing child nodes, so the <root><child1></child1></root>
    if (node.hasChildNodes()) 
    {
        NodeList childs = node.getChildNodes();
        nChilds  = childs.getLength();

        if (nChilds == 1) 
        {
            txt += childs.item(0).getNodeValue();
        } 
        else 
        {
            for (int j = 0; j < nChilds; j++) {
                txt += print(childs.item(j));
            }
        }
    }

    //And the ending of the primary node, like </root>
    if (node.getNodeType() == node.ELEMENT_NODE) 
    {
        txt += "</" + node.getNodeName();
        txt +=  ">\n";
    }
    return txt;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T12:50:53.133

对我有用吗？：

```
import static org.junit.Assert.assertTrue;

import java.io.StringWriter;

import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;
import javax.xml.transform.Transformer;
import javax.xml.transform.TransformerConfigurationException;
import javax.xml.transform.TransformerException;
import javax.xml.transform.TransformerFactory;
import javax.xml.transform.TransformerFactoryConfigurationError;
import javax.xml.transform.dom.DOMSource;
import javax.xml.transform.stream.StreamResult;

import org.junit.Test;
import org.w3c.dom.DOMImplementation;
import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Text;

public class DomTest {

    @Test
    public void testDom() throws Exception {
        Document document = createEmptyDocument();

        Element root = document.getDocumentElement();
        Element child = document.createElement("child");
        Element childOfTheChild = document.createElement("childOfTheChild");
        Text st = document.createTextNode("Some text");
        childOfTheChild.appendChild(st);
        child.appendChild(childOfTheChild);
        root.appendChild(child);

        assertTrue(serialise(document).contains("Some text"));
    }

    private Document createEmptyDocument() throws ParserConfigurationException {
        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
        DOMImplementation domImpl = dbf.newDocumentBuilder()
                .getDOMImplementation();
        Document document = domImpl.createDocument(null, "root", null);
        return document;
    }

    private String serialise(Document document)
            throws TransformerFactoryConfigurationError,
            TransformerConfigurationException, TransformerException {
        TransformerFactory xff = TransformerFactory.newInstance();
        Transformer xf = xff.newTransformer();
        StringWriter sw = new StringWriter();
        xf.transform(new DOMSource(document), new StreamResult(sw));
        return sw.toString();
    }
} 
```

# ruby - Webby-Compass 集成 - 等效的 config.rb 文件？

> ID：857559
> 
> 赞同：0
> 
> 时间：2009-05-13T12:01:14.180
> 
> 标签：ruby, rubygems, compass-sass, webby

在 23:08 的[Compass 截屏视频](http://wiki.github.com/chriseppstein/compass)中，Chris Eppstein 开始在他的纯 Compass 项目中编辑一个名为*config.rb的文件。*Chris 使用此文件使用*img_url()函数在他的图像中配置相对路径名（该函数必须未记录，因为我在*[邮件列表](http://groups.google.com/group/compass-users/)或[网站上](http://wiki.github.com/chriseppstein/compass/)找不到任何关于它的信息。）。

我正在使用[Compass Integration开发一个](http://wiki.github.com/chriseppstein/compass/webby-integration)[Webby 项目](http://webby.rubyforge.org/)，但在我的 Webby 项目中找不到*config.rb*文件。我猜我项目根目录中的*SiteFile*文件会做同样的事情，但我对此并不完全确定。

 **有谁知道Webby/Compass 集成项目中*config.rb*文件的等价物是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T19:42:28.563

截屏视频很可能已过时。

要将指南针加载到您的 Webby 项目中，请使用以下选项设置您的站点文件：

```
require 'compass'

Compass.configuration do |config|
  config.project_path = File.dirname(__FILE__)
  config.sass_dir = File.join('src', 'stylesheets' )
end

Webby.site.sass_options.update(Compass.sass_engine_options) 
```

来自[https://github.com/Compass/compass/wiki/webby-integration](https://github.com/Compass/compass/wiki/webby-integration)

# python - 无限递归尝试检查 TreeCtrl 的所有元素

> ID：857560
> 
> 赞同：0
> 
> 时间：2009-05-13T12:01:18.690
> 
> 标签：python, wxpython

我有一个 TreeCtrl，其中可以为多个 Item 分配与 PyData 相同的对象。更新对象时，我想更新树中所有以该对象为 PyData 的项目。

我认为下面的代码可以很好地解决问题，但由于某种原因，逻辑测试 (current != self.GetFirstVisibleItem()) 总是返回 true 导致无限递归。谁能解释为什么？

```
def RefreshNodes(self, obj, current=None):
    print "Entered refresh"
    current = current or self.GetFirstVisibleItem()
    if current.IsOk():
        print self.GetPyData(current).name
        if self.GetPyData(current) == obj:
            self.RefreshNode(current)
        current = self.GetNextVisible(current)
        if current != self.GetFirstVisibleItem():
            self.RefreshNodes(obj, current) 
```

编辑：以上显然是基于 wx.TreeCtrl 的类的一部分

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T12:44:08.790

“下一个”项目如何成为第一个项目？

这似乎是一个重言式。下一个永远不是第一个。

```
 current = self.GetNextVisible(current)

    current != self.GetFirstVisibleItem() 
```

next 似乎并没有从头开始。看来 next 最后应该返回一个无效项目（IsOk 为 False）。

有关这方面的信息，请参见[http://wxpython.org/onlinedocs.php](http://wxpython.org/onlinedocs.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T12:37:57.040

没有办法`current != self.GetFirstVisibleItem()`是假的。请参阅下面的评论

```
def RefreshNodes(self, obj, current=None):
    print "Entered refresh"
    current = current or self.GetFirstVisibleItem()
    if current.IsOk():
        print self.GetPyData(current).name
        if self.GetPyData(current) == obj:
            self.RefreshNode(current)

        #current = next visible item
        current = self.GetNextVisible(current)

        #current can't equal the first visible item because
        # it was just set to the next visible item, which 
        # logically cannot be first
        if current != self.GetFirstVisibleItem():   
            self.RefreshNodes(obj, current) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T13:09:15.927

刚刚意识到问题：如果 current 不是一个有效的项目，它的逻辑值为 False。

因此， current = current 或 self.GetFirstVisibleItem() 行在调用 current.IsOk() 之前回绕到第一个项目...

# css - 内联显示定义术语和描述

> ID：857561
> 
> 赞同：6
> 
> 时间：2009-05-13T12:01:22.277
> 
> 标签：css

我正在为页面上的某些元素使用定义列表，并需要它们内联显示，例如：它们**通常**看起来像：

**<def term>**
        <def desc>
        <def desc>

我需要它们看起来像（注意多个 DD）：

**<def term>** <def desc> <def desc>
**<def term>** <def desc> <def desc>
**<def term>** <def desc> <def desc>

我可以在 moz 中使用浮点数让它们正常工作，但无论我尝试什么，它们都不会在 IE 中工作，我通常会得到类似的东西：

**<def term>** <def desc> <def desc> <def desc> <def desc> <def desc> <def desc>
**<def term>**
**<def term>**

有没有人找到解决这个问题的方法，我真的很想避免在可能的情况下添加额外的标记，但没有将它们更改为无序列表，我没有想法:(

提前致谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-09T15:56:30.183

**注意：**您必须避免 DD 元素之间的空格才能正常工作。

IE8+ 无需 hack：

```
dd,
dt{
    display: inline;
    margin: 0;
}
dd:before {
    content: ' '; /* space them */
}
dt:before { /* insert line break before <dt> */
    content:"\A";
    white-space:pre;
}
dt:first-child:before { /* disable line break before the first <dt> */
    content: none;
} 
```

如果您不需要支持 IE8，请跳过第 4 条 CSS 规则，只需将此选择器用于第 3 条：`dt:not(:first-child):before`

结果应该是这样的：（ [演示）](http://codepen.io/bfred-it/pen/gjHDn)

```
DT DD DD
DT DD DD 
```

如果您想变得*很酷*，可以将第二条规则替换为：

```
dd + dd:before {
    content: ', '; /* add comma between definitions */
}

dt:after {
    content: ':';
} 
```

结果应该是这样的：（ [演示）](http://codepen.io/bfred-it/pen/KDHam)

```
DT: DD, DD
DT: DD, DD 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T13:53:01.643

默认样式表

> dt,dd { 浮动：左；}
> dd + dt { 清除：左；}

即 6 & 7 样式表：

> dt {浮动：无；} dd {位置：相对；顶部：-19px；/*取决于你的行高*/ }

即6

> [http://code.google.com/p/ie7-js/](http://code.google.com/p/ie7-js/)

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T14:06:59.967

只需[给它们所有布局](http://haslayout.net/haslayout)，最简单的方法是使用 CSS 属性 .yourstuff { zoom: 1; }

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T14:07:06.237

这有效（诚然，仅在 FF 3.xx 和 Opera 9.x 上测试过，都在 Ubuntu 8.04 上）：

**CSS**：

```
p {
    display: block;
}
dl {
    display: block;
    margin: 0;
}
dt {
    display: block;
    width: 7em;
    border-right: 1px solid #ccc;
    margin: 0;
}
dd {
    display: none;
    margin: 0;
    position: relative;
    /* 'position: absolute' would probably work better, 
        and lose the line break left by the 'position: relative;' */
    top: -1em;
    left: 8em;
}
dt:hover + dd, dt:hover + dd + dd {
   /* Couldn't find a way to target all sibling 
      dds of a dt without the + operator (and listing all of them),
      but it works, albeit kludgy */
    display: inline;
}
dd:after {
    content:"; ";
}
dd:last-child:after {
    content:"";
} 
```

**HTML**：

```
<div id="content">
    <dl>
        <dt>first dt</dt><dd>first dt's first dd</dd><dd>first dt's second</dd>
        <dt>second dt</dt><dd>second dt's first dd</dd><dd>second dt's second</dd>
        <dt>third dt</dt><dd>third dt's third dd</dd><dd>third dt's second</dd>
    </dl>
</div> 
```

链接到工作示例，在 FF 3 和 Opera 9.x 下测试：
[http ://www.davidrhysthomas.co.uk/so/dls.html](http://www.davidrhysthomas.co.uk/so/dls.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T12:39:13.260

您是否尝试过清除 dt 中的浮动？像这样：

```
dt { clear: left; }
dd { float: left; } 
```

* * *

**编辑：**这是一个验证的跨浏览器解决方案：

```
dd,dt{ display: inline; }

<dl>
 <dt>1</dt><dd>1.1</dd><dd>1.2<br/></dd>
 <dt>2</dt><dd>2.1</dd><dd>2.2<br/></dd>
</dl> 
```

但是，如您所见， br 非常讨厌且没有语义。希望其他人可以提出更好的解决方案。:)

# toolbar - 从 BHO 激活 IE 附加组件

> ID：857563
> 
> 赞同：0
> 
> 时间：2009-05-13T12:01:36.990
> 
> 标签：toolbar, bho, deskband

我写了两个对象，一个桌带工具栏和一个用于 IE 的 bho。目标是 bho 在安装后显示工具栏。微软的做法是使用 pBrowser->ShowBrowserBar(&vtBandGUID, &vtShow, 0);

此方法可以很好地显示和隐藏已通过插件管理器激活但不适用于已停用插件的工具栏。有没有办法以编程方式做与插件管理器完全相同的事情（启用/禁用特定插件）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-19T00:39:43.983

你应该澄清你的问题。

编写代码来激活用户特别禁用的加载项可能被视为恶意行为，并可能导致相关应用程序被标记为恶意软件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-05T02:04:56.053

您可以通过向此键添加/删除名为“Flags”的 DWORD 注册表值（值为 1）来启用/禁用 BHO：

```
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Ext\Settings\<BHO CLSID> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-21T10:15:02.610

此外，该`0`值`Flags`表示启用。`1`表示禁用。

有时会输入 1 以外的其他值（例如 256）。

```
HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Ext\Settings\<BHO CLSID> 
```

# svn - SVN 命令不会出现在上下文菜单中

> ID：857564
> 
> 赞同：53
> 
> 时间：2009-05-13T12:01:44.557
> 
> 标签：svn, tortoisesvn

我刚刚下载并安装了 SVN Tortoise，但菜单上没有出现任何命令。这怎么可能？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-13T12:07:36.013

你重启你的机器了吗？

**更新：**

我自己也遇到了同样的问题！当我在 1.5 上安装 1.6 版时发生了这种情况。当我重新启动机器时，我在开始菜单中找到了 Tortoise 条目，但不是通过上下文菜单。当我点击“设置”时，出现了一条错误消息。所以，我卸载了 1.6 并重新安装了它。现在它又开始工作了！是的，通过上下文菜单可用。我相信这是一个错误。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2010-08-02T16:46:30.897

我在 Windows 7 64 位上遇到了同样的问题。我重新安装了很多次，但仍然无法在资源管理器中看到上下文覆盖。所以我查看了 TortoiseSVN 的更新日志，看到了一个建议进行修复安装。这解决了我的问题。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-05-13T12:39:49.517

除了第一次重启...

您运行的是 64 位还是 32 位 Windows？Tortoise 作为 shell 扩展运行，因此如果您的 Windows 操作系统是 64 位并且您安装了 32 位版本的 Tortoise，您将看不到上下文菜单。

在旁注中。如果您在 64 位操作系统中使用像 Total Commander 这样的 32 位工具，并且希望在 Explorer 和 Total Commander 中都使用上下文菜单扩展，那么您实际上必须同时安装 32 位和 64 位版本的 Tortoise。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2011-11-08T19:22:00.857

我的总指挥官遇到了问题并多次卸载/重新安装，但真正的“问题”是乌龟设置。来自[http://shalom.craimer.org/info/tech-journal/articles/653/The-context-menu-and-icons-for-TortoiseSVN-dont-appear-in-Total-Commander-but-the-do -出现在-Windows-Explorer.-Why.html](http://shalom.craimer.org/info/tech-journal/articles/653/The-context-menu-and-icons-for-TortoiseSVN-dont-appear-in-Total-Commander-but-the-do-appear-in-Windows-Explorer.-Why.html)

*   TortoiseSVN 安装程序中的“修复”
*   重新开始
*   在 TortoiseSVN 设置中（在资源管理器中右键单击并在上下文菜单中选择“TortoiseSVN”下的“设置...”）->“图标覆盖”取消选中标记为“仅在资源管理器中显示覆盖和上下文菜单”的复选框。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-09-16T10:30:44.277

修复安装解决了问题。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-30T08:05:31.287

TSVN 在您的情况下不起作用的原因有很多。你最好的办法是查看 TortoiseSVN 支持列表，如果没有在列表中发布消息 - 他们是一群友好的人。

哎呀，看起来我还不能发布链接 - 去 google-groups 并寻找 TortoiseSVN，有两个列表 tortoisesvn-dev 和 tortoisesvn，不要在开发列表上询问您将被要求在“用户”列表上询问

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-11-30T08:48:00.240

我在资源管理器上下文菜单中有 TortoiseSVN，但在 UnrealCommander 上下文菜单中丢失了它。

我不得不手动从注册表中删除 TortoiseSVN 的所有条目。因为修复安装对我没有影响。

但是在重新安装 TortoiseSVN 之后，我成功了。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-12-09T10:31:29.827

顺便说一句，我在 Windows Vista 64 位上遇到了同样的问题。不得不做两次重新安装/重启的事情。安装程序是 TortoiseSVN-1.6.12.20536-x64-svn-1.6.15.msi。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-04-23T04:11:26.617

无论我做什么 - 安装/卸载/重新安装/修复 - 没有任何效果。只有在安装了 WANDisco Subversion Tortoise 后也开始工作了。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-04-15T15:32:02.200

我在 Windows 7 系统上遇到了完全相同的问题。上下文菜单中绝对没有任何内容表明存在 Tortoise SVN。我完成了上面建议的所有安装、重新安装、修复、重新启动等。

最终为我解决的问题是安装 64 位版本。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-05-25T14:54:58.137

这是我解决问题的方法：

在全新的 Windows 7 64 位操作系统上，我安装了一些 32 位应用程序和 64 位 totoisesvn 应用程序。

shell弹出菜单中没有图标！

为了解决它，我：

*   卸载了同样使用菜单的 32 位应用程序，
*   卸载了64位svn
*   使用 regedit 手动删除 ShellIconoverlayIdentifyer 配置单元中的任何剩余部分
*   重新启动
*   然后重新安装svn 64位svn，
*   然后是 32 位程序。

成功！出现了 svn 菜单项（虽然 32 位仍然不可见）。

结论：**在安装 32 位应用程序之前安装 64 位应用程序**。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-07-18T11:34:29.290

如果您错过了覆盖图标、常规的“SVN 更新”和“SVN 提交”命令，而是有一个“SVN 升级工作副本”命令，您应该单击它。出现的原因是 TortoiseSVN 已升级并且工作副本格式已更改。这必须从 1.7+ 手动升级。这将带回您的命令和覆盖图标。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-08-05T11:35:44.213

从 1.5 升级到 1.6 版本后，我遇到了“无上下文菜单”的问题。第一次重新安装后，我遇到了一个新问题：“没有乌龟图标”。我再次重新安装了乌龟 1.6.16 build 21511。

重启后一切正常。我有一台XP下的win-32bit机器。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-08-10T15:44:29.660

使用32位Win XP我卸载重新启动然后重新安装并再次重新启动并解决了问题

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2010-07-31T05:18:36.450

与上面其他人的建议类似，我遇到了这个问题，根本原因是 32 v 64 位。我安装了 WANDisco Subversion - 并且在此过程中还自动安装了 TortoiseSVN。

但是它安装的版本是 32 位的，我不得不卸载它并单独重新安装 64 位版本的 TortoiseSVN。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-01-19T02:57:19.257

它可以通过修复 TortoiseSVN 并立即重新启动操作系统来修复。确保您使用的操作系统版本正确（32 位 || 64 位）。

当我升级到 TortoiseSVN 到版本 TortoiseSVN-1.6.12.20536-win32-svn-1.6.15 时，我在 Window Server 2003 R2 上遇到了同样的问题。现在已经解决了。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-03-29T11:33:35.887

您可能会在 SVN 设置内的上下文菜单中选中**“隐藏未版本化路径的菜单”。**取消选中该框并选中或按 Shift + 右键单击​​以显示上下文菜单。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2013-06-05T13:18:23.350

我只是在追赶红鲱鱼，也许其他人也经历过同样的事情：

我认为移动版本文件不再出现上下文菜单。原来我正试图将文件移动到我尚未添加到颠覆的文件夹中。一旦我在 Tortoise 中添加了文件夹，上下文菜单选项就会重新出现。嗬！

* * *

## 回答 #19

> 赞同：-3
> 
> 时间：2015-10-30T09:45:31.763

1.  安装
2.  重启机器
3.  修复安装

它对我有用

# c# - 什么是 C# 等价于 PHP 的“self::”？

> ID：857571
> 
> 赞同：11
> 
> 时间：2009-05-13T12:03:31.277
> 
> 标签：c#, oop

在 C# 中，当我想从该类的另一个静态方法调用该类的静态方法时，是否可以使用**通用前缀**（例如 PHP）`self::`而不是类名？

所以在下面的例子中，而不是说**`Customer.DatabaseConnectionExists()`**，我怎么能说这样的话，**`Self.DatabaseConnectionExists()`**例如，如果我更改类的名称，我不必去更改所有的前缀？

```
class Customer
{
    public string FirstName { get; set; }
    public string LastName { get; set; }

    public static Customer GetCurrentCustomer()
    {
        if (Customer.DatabaseConnectionExists())
        {
            return new Customer { FirstName = "Jim", LastName = "Smith" };
        }
        else
        {
            throw new Exception("Database connection does not exist.");
        }
    }

    public static bool DatabaseConnectionExists()
    {
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-13T12:06:34.687

没有真正的等价物 - 您必须指定类名，即

```
Customer.DatabaseConnectionExists() 
```

或完全错过预选赛，即

```
DatabaseConnectionExists() 
```

后一种调用方式是可取的，因为它更简单并且不会失去任何意义。此外，它与实例中的方法调用更加内联（即调用 by`InstanceMethod()`和*not* `this.InstanceMethod()`，这过于冗长）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-13T12:06:26.327

如果您从类内部调用该方法，则无需指定 ::Self 之类的任何内容，只需方法名称即可。

```
class Customer
{
    public string FirstName { get; set; }
    public string LastName { get; set; }

    public static Customer GetCurrentCustomer()
    {
        if (DatabaseConnectionExists())
        {
            return new Customer { FirstName = "Jim", LastName = "Smith" };
        }
        else
        {
            throw new Exception("Database connection does not exist.");
        }
    }

    public static bool DatabaseConnectionExists()
    {
        return true;
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T12:06:39.010

把它放在外面。`DatabaseConnectionExists`在类内部定义。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T12:06:41.660

只需不带任何前缀即可调用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T12:06:19.617

不，没有。但是使用重构工具，更改类的名称不应该让您太担心。

# perl - 需要帮助使用 perl 解析来自 php 套接字服务器的流数据

> ID：857575
> 
> 赞同：1
> 
> 时间：2009-05-13T12:05:07.497
> 
> 标签：perl, parsing, sockets, stream, iostream

我正在为我的公司开发一个项目，该项目使用套接字服务器 (php) 从远程设备收集数据。如何让这个 perl 程序直接在流上运行，而不是先让服务器写入一个 tmp 文件，然后在该文件上运行这个脚本，然后写出一个 csv 文件以插入数据库？

~~我考虑过使用 IO::Socket 但我不知道该怎么做。~~

此外，如果有人对如何清理此代码有任何提示/指示，我们将不胜感激。（我仍然是一个 Perl n00b ;-)）

这是到目前为止我对 perl prog 所做的。（运行后我得到了两个 tmp 文件）：

```
 #vim set sw=2 ts=2
#!/usr/bin/perl
use warnings;
use strict;
use Data::Dumper;
&convert;

#open the source file, strip out any unneeded chars, reformat the data
sub convert{
    my $source = "$ARGV[0]";
    my $dest = "$ARGV[0]"."_tmp.txt";
    chomp $source;
    open SOURCE, '', $dest or die "Could not open '$dest' $!";

    # move the data from the source file into an array
    my %fields;
    my @field_names = qw/FIELD1 FIELD2 FIELD3 FIELD4 FIELD5 FIELD6/;
    my $pack_definition = 'a4 a2 a1 a4 a4 a8A*'; 
    while(){

        # strip out the packet header 
        s#T18##g;
        s#T00##g;
        s/^(FF14).*$//g;
        s/^(FF18).*$//g;
        s/(^|\n)[\n\s]*/$1/g;

        # arrange the data into the necessary order
        @fields{@field_names} = unpack($pack_definition, $_);
        s#(FF15)(.{2})(.{1})(.{2})(.{2})(.{2})(.{2})(.{2})(.{2})(.{2})(.{2})#$1\t$2\t$3\t$5$4\t$7$6\t$11$10$9$8#g;
        s#(FF16)(.{2})(.{1})(.{2})(.{2})(.{2})(.{2})(.{2})(.{2})(.{2})(.{2})#$1\t$2\t$3\t$4\t$5\t$6\t$7\t$8\t$9\t$10\t$11#g;
        s#(FF17)(.{2})(.{1})(.{2})(.{2})(.{2})(.{2})(.{4})(.{4})#$1\t$2\t$3\t$5$4\t$7$6\t$8\t$9#g;
        my @spds =  /(FF15)\t(.{2})\t(.{1})\t(.{4})\t(.{4})\t(.{8})/;

        # convert the data from hex to ascii
        foreach my $data (@spds){
            my $replacement = hex($data);  
            s#$data#$replacement#g;
        }
        my @psis = /(FF16)\t(.{2})\t(.{1})\t(.{2})\t(.{2})\t(.{2})\t(.{2})\t(.{2})\t(.{2})\t(.{2})\t(.{2})/;
        foreach my $data1(@psis){
            my $replacement1 = hex($data1);
            s#$data1#$replacement1#g;
        }
        my @rates=  /(FF17)\t(.{2})\t(.{1})\t(.{4})\t(.{1,4})\t(.{4})\t(.{4})/;
        foreach my $data2 (@rates){
            my $replacement2 = hex($data2);  
            s#$data2#$replacement2#g;
        }

        # print the converted data to the destination file
        print DEST;
    }
    # close the files
    close SOURCE;
    close DEST;
}
&create_vals;

# perform conversion from raw values to human readable output
sub create_vals{      
    my $source = "$ARGV[0]"."_tmp.txt";
    my $dest = "$ARGV[0]"."_converted.txt";
    chomp $source;
    open SOURCE, '', $dest or die "Cannot open '$dest' for writing $!";
    while(){
        s#(65301)\t(.{2})\t(8)\t(.{1,5})\t(.{1,5})\t(.{1,4})#"'".$1."','". $2."','". $3."','". ($4/8)."','". ($5/8)."','". ($6/20)."'"#eg;
        s#(65302)\t(.{2})\t(8)\t(.{1,3})\t(.{1,3})\t(.{1,3})\t(.{1,3})\t(.{1,3})\t(.{1,3})\t(.{1,3})\t(.{1,3})#"'".$1."','". $2."','". $3."','". $4."','". (($5*1.8)-40)."','". (($6*1.8)-40)."','". ($7*.58)."','".($8*.58)."','".($9*.29008)."','".(($10*1.8)-40)."','".$11."'"#eg;
        s#(65303)\t(.{2})\t(8)\t(.{1,5})\t(.{1,5})\t(.{1,5})\t(.{1,5})#"'".$1."','". $2."','". $3."','". ($4*0.014)."','". ($5*.05)."'"#eg;
        print DEST;
    }
}
    close SOURCE;
    close DEST;
__END__ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T06:48:35.173

如果“直接在流上运行”意味着“接受来自远程设备而不是 PHP 服务器的连接”，那么 IO::Socket 是一种可行的方法。谷歌有[很多例子](http://www.google.com/search?q=TCP+Servers+with+IO%3A%3ASocket)，你也可以查看[perlipc](http://search.cpan.org/~nwclark/perl-5.8.9/pod/perlipc.pod#TCP_Servers_with_IO::Socket)文档。

# .net - 在 IL 中查找方法调用的参数值

> ID：857593
> 
> 赞同：2
> 
> 时间：2009-05-13T12:08:15.683
> 
> 标签：.net, il, mono.cecil

我有几个特殊的方法，我想分析它们在编译的程序集中调用。

例子：

```
public static class SrcHelper {
    [MySpecialMethod]
    [Conditional( "DEBUG" )]
    public static void ToDo( params object[] info ) {
        /* do nothing */
        /* this method is not called when code is compiled in RELEASE mode */
    }
}
// ... somewhere else in another assembly ...
Array CreateArraySampleMethod( int size ) {
    // This call has only informative character. No functionality is required.
    SrcHelper.ToDo( "Should create array of ", typeof( MyClass ), " with specified size." );
    throw new NotImplementedException();
} 
```

从这个编译的代码中，我想得到参数值{“应该创建具有指定大小的“，MyClass，”数组。” }。我尝试使用 Mono 的 Cecil，并找到了调用“ToDo”方法的说明。但是现在我很困惑如何用参数值来识别指令。

我知道，情况可能很复杂，有些参数的值无法解决。但我只需要解析常量值 - 这足以满足我的目的。

谢谢。

**编辑：** “ToDo”方法（和类似方法）应用作注释的替代方法（ //, /* ... */ ），编译后，应进行 IL 分析并自动生成文档和具体装配的 todo-list .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T12:23:51.680

代码生成有点混乱，但可以在简单的情况下完成：

编译：

```
public static void Main(string[] args)
{
    Console.WriteLine("", // ignore this argument
       "Should create array of ", typeof(int), " with specified size." "x");
} 
```

（添加“x”以强制它使用参数重载）

给

```
.method public hidebysig static void Main(string[] args) cil managed
{
    .custom instance void [mscorlib]System.STAThreadAttribute::.ctor()
    .maxstack 4
    .locals init (
        [0] object[] objArray)
    L_0000: ldstr ""
    L_0005: ldc.i4.4 
    L_0006: newarr object
    L_000b: stloc.0 
    L_000c: ldloc.0 
    L_000d: ldc.i4.0 
    L_000e: ldstr "Should create array of "
    L_0013: stelem.ref 
    L_0014: ldloc.0 
    L_0015: ldc.i4.1 
    L_0016: ldtoken int32
    L_001b: call class [mscorlib]System.Type 
                [mscorlib]System.Type::GetTypeFromHandle(
                    valuetype [mscorlib]System.RuntimeTypeHandle)
    L_0020: stelem.ref 
    L_0021: ldloc.0 
    L_0022: ldc.i4.2 
    L_0023: ldstr " with specified size."
    L_0028: stelem.ref 
    L_0029: ldloc.0 
    L_002a: ldc.i4.3 
    L_002b: ldstr "x"
    L_0030: stelem.ref 
    L_0031: ldloc.0 
    L_0032: call void [mscorlib]System.Console::WriteLine(string, object[])
    L_0037: ret 
} 
```

所以你要做的是解析 il 以检测被推入编译器生成数组的参数。一个脆弱但可能足以说：

1.  找到对“我的方法”的调用。
2.  找到最近的上一个 newarr 对象
3.  将所有 ldstr 和 ldtoken 放在它们之间，并假设它们是参数。

这很粗糙，但可能足以满足您的需求。

AOP 风格的方法将通过简单地检测每次调用以转储值来在*运行时*为您提供所需的内容，但在简单的时候，上述方法是您唯一现实的选择，仅给出 IL。

生成的代码在发布版本中可能非常不同，您将无法发现自动生成的数组与某人自己明确创建它（可能离调用站点更远，甚至在不同的方法/构造函数/类中。

### 附带条件

我应该在您编辑后说明为什么要这样做，基于属性的注释是一个更好的解决方案，我不明白为什么当您可以直接属性时，您会希望在方法中执行此操作......

# python - 在 Python 中设置 sax 解析器的编码

> ID：857597
> 
> 赞同：6
> 
> 时间：2009-05-13T12:09:11.627
> 
> 标签：python, unicode, sax

当我将 utf-8 编码的 xml 提供给 ExpatParser 实例时：

```
def test(filename):
    parser = xml.sax.make_parser()
    with codecs.open(filename, 'r', encoding='utf-8') as f:
        for line in f:
            parser.feed(line) 
```

...我得到以下信息：

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "test.py", line 72, in search_test
    parser.feed(line)
  File "/System/Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/xml/sax/expatreader.py", line 207, in feed
    self._parser.Parse(data, isFinal)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xb4' in position 29: ordinal not in range(128) 
```

我可能在这里遗漏了一些明显的东西。如何将解析器的编码从“ascii”更改为“utf-8”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T12:22:58.547

您的代码在 Python 2.6 中失败，但在 3.0 中有效。

这在 2.6 中确实有效，大概是因为它允许解析器本身找出编码（可能通过读取 XML 文件第一行可选指定的编码，否则默认为 utf-8）：

```
def test(filename):
    parser = xml.sax.make_parser()
    parser.parse(open(filename)) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-13T13:18:29.203

Python 2.6 中的 SAX 解析器应该能够解析 utf-8 而不会破坏它。尽管您省略了与解析器一起使用的 ContentHandler，但如果该内容处理程序尝试将任何非 ascii 字符打印到您的控制台，则会导致崩溃。

例如，假设我有这个 XML 文档：

```
<?xml version="1.0" encoding="utf-8"?>
<test>
   <name>Champs-Élysées</name>
</test> 
```

而这个解析器：

```
import xml.sax

class MyHandler(xml.sax.handler.ContentHandler):

    def startElement(self, name, attrs):
        print "StartElement: %s" % name

    def endElement(self, name):
        print "EndElement: %s" % name

    def characters(self, ch):
        #print "Characters: '%s'" % ch
        pass

parser = xml.sax.make_parser()
parser.setContentHandler(MyHandler())

for line in open('text.xml', 'r'):
    parser.feed(line) 
```

这将很好地解析，并且内容确实会保留 XML 中的重音字符。唯一的问题是`def characters()`我已经注释掉的那一行。在 Python 2.6 的控制台中运行，这将产生您所看到的异常，因为 print 函数必须将字符转换为 ascii 才能输出。

您有 3 种可能的解决方案：

**一**：确保您的终端支持 unicode，然后`sitecustomize.py`在您的终端中创建一个条目`site-packages`并将默认字符集设置为 utf-8：

导入 sys sys.setdefaultencoding('utf-8')

**二**：不要将输出打印到终端（面面相觑）

**三**`unicodedata.normalize`：使用将非ascii字符转换为ascii等价物或`encode`将字符转换为ascii以进行文本输出的规范化输出： `ch.encode('ascii', 'replace')`. 当然，使用这种方法您将无法正确评估文本。

使用上面的选项一，您的代码在 Python 2.5 中工作得很好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-12-04T18:03:11.063

Jarret Hardie 已经解释了这个问题。但是那些正在为命令行编码，并且似乎没有“sys.setdefaultencoding”可见的人，解决这个错误（或“功能”）的快速工作是：

```
import sys
reload(sys)
sys.setdefaultencoding('utf-8') 
```

希望`reload(sys)`不会破坏其他任何东西。

此旧博客中的更多详细信息：

[虚幻的 setdefaultencoding](http://blog.ianbicking.org/illusive-setdefaultencoding.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-11-08T19:24:21.313

要为 SAX 解析器设置任意文件编码，可以使用[InputSource](https://docs.python.org/2/library/xml.sax.reader.html#xml.sax.xmlreader.InputSource)，如下所示：

```
def test(filename, encoding):
    parser = xml.sax.make_parser()
    with open(filename, "rb") as f:
        input_source = xml.sax.xmlreader.InputSource()
        input_source.setByteStream(f)
        input_source.setEncoding(encoding)
        parser.parse(input_source) 
```

这允许解析具有非 ASCII、非 UTF8 编码的 XML 文件。例如，可以解析用 LATIN1 编码的扩展 ASCII 文件，例如： `test(filename, "latin1")`

（添加此答案以直接解决此问题的标题，因为它在搜索引擎中往往排名很高。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-20T22:27:44.757

评论 janpf 的答案（对不起，我没有足够的声誉把它放在那里），请注意 Janpf 的版本会破坏 IDLE，这需要它自己的标准输出等，这与 sys 的默认值不同。所以我建议将代码修改为：

```
import sys

currentStdOut = sys.stdout
currentStdIn = sys.stdin
currentStdErr = sys.stderr

reload(sys)
sys.setdefaultencoding('utf-8')

sys.stdout = currentStdOut
sys.stdin = currentStdIn
sys.stderr = currentStdErr 
```

可能还有其他变量需要保留，但这些似乎是最重要的。

# iphone - 应用程序关闭并重新启动后，对 SQLite 数据库的某些更改不会持续存在

> ID：857610
> 
> 赞同：1
> 
> 时间：2009-05-13T12:11:40.747
> 
> 标签：iphone, objective-c, sqlite

我有一个正在开发的 iPhone 应用程序，当应用程序启动时，我打开一个 SQLite 数据库连接，并在应用程序终止时关闭它。该数据库位于应用程序文档文件夹中。

在应用程序的生命周期中，我运行了几个`INSERT`和`UPDATE`语句。但是，由于某种原因，`UPDATE`一旦应用程序关闭然后重新启动，我的语句就无法正确保存。我正在打电话`sqlite3_prepare_v2`，`sqlite3_step`而且是`sqlite3_finalize`正确的，所以我确信交易应该完成。我已经在所有这 3 个函数上添加了断点，它们都被击中，并且都返回了正确的值。

当我在更新后关闭应用程序并查看文档目录时，我可以看到另一个带有 -journal 的数据库文件。这是否意味着某些交易无法正常工作？

我还注意到，在我`applicationWillTerminate:`使用关闭连接的方法中`sqlite3_close()`，它正在返回`SQLITE_BUSY`。为什么会这样？

我已经挣扎了一整天，所以我真的希望有人能指出我正确的方向！

这是我执行更新查询的代码：

```
// 更新语句
sqlite3_stmt *stmt;
char *query = "更新记录 SET fielda = ? WHERE pkfield = ?;";
if (sqlite3_prepare_v2(database, query, -1, &stmt, nil) == SQLITE_OK &&

   // 绑定
   sqlite3_bind_text(stmt, 1, [myNSStringVar UTF8String], -1, nil) == SQLITE_OK &&
   sqlite3_bind_int(stmt, 2, recordID) == SQLITE_OK) {

   // 执行
   int ret = sqlite3_step(stmt);
   如果（ret == SQLITE_DONE）{
      sqlite3_finalize(stmt);
   }
}

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T15:52:27.050

啊……我想通了！我的一个不起眼的 finalize 声明从未真正实现过！因为它只是一个 SELECT 语句，所以我没有检查它，因为它与任何数据操作或事务无关！这是窗外一天的发展价值！但我不会再犯这个错误了！

无论如何，感谢您的帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T12:39:37.067

如果您正在重用更新语句，您应该在使用后立即在语句上调用 sqlite3_reset()，调用 sqlite3_clear_bindings() 也可能适合确保重置分配的参数。然后，您应该仅在清理时调用 sqlite3_finalize。这可能是您的问题，因为如果该语句仍在执行并且您在其上调用 sqlite3_finalize 则执行将被中断。也就是说，如果您还没有，您很可能应该重用语句以提高效率。对我来说，它是这样工作的：

```
static sqlite3_stmt *update_statement = nil;

-(void)performUpdateOnRow: (NSInteger)primaryKey {

    if (update_statement == nil){
        const char *sql = "UPDATE foo SET bar=?,baz=? WHERE pk=?";
        if( sqlite3_prepare_v2(database, sql, -1, &update_statement, NULL) != SQLITE_OK ){
                // Insert some serious error handling here!
        }
    }
    sqlite3_bind_text(update_statement, 1, @"first", -1,SQLITE_TRANSIENT);
    sqlite3_bind_text(update_statement, 2, @"second", -1,SQLITE_TRANSIENT); 
    sqlite3_bind_int(update_statement, 3, primaryKey);

    sqlite3_step(update_statement);
    sqlite3_reset(update_statement);

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T12:46:44.670

看起来您需要让 sqlite 在杀死您的应用程序之前完成当前任务 - SQLITE_Busy 表示[“数据库文件已锁定”](http://www.sqlite.org/c3ref/c_abort.html)，因此遵循[此处的文档](http://www.sqlite.org/c3ref/stmt.html)应该会让您走上正确的道路。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T12:55:59.537

您确定在应用程序使用期间将大量内容保存到您的 SQLite DB 对性能来说是最好的吗？

我倾向于在运行时将更改等存储在 NSMutableArray 中，每次更新对象时都将“脏”标志设置为 YES。

然后在我的 applicationWillTerminate 方法中，我调用以下内容：

```
[todos makeObjectsPerformSelector:@selector(dehydrate)]; 
```

我的“脱水”方法（这是基于 Apple 自己的 SQLite 数据库操作指南）基本上是这样的：

```
- (void) dehydrate {
if (dirty) {
    if (dehydrate_statement == nil) {
        const char *sql = "UPDATE todo SET text=?,priority=?,complete=?,detail=? WHERE pk=?";
        if (sqlite3_prepare_v2(database,sql,-1,&dehydrate_statement,NULL) != SQLITE_OK) {
            NSAssert1(0,@"Error: failed to prepare statement with message '%s'.",sqlite3_errmsg(database));
        }
    }

    sqlite3_bind_int(dehydrate_statement, 5, self.primaryKey);
    sqlite3_bind_text(dehydrate_statement, 4, [self.detail UTF8String],-1,SQLITE_TRANSIENT);
    sqlite3_bind_int(dehydrate_statement, 3, self.status);
    sqlite3_bind_int(dehydrate_statement, 2, self.priority);
    sqlite3_bind_text(dehydrate_statement, 1, [self.text UTF8String],-1,SQLITE_TRANSIENT);
    int success = sqlite3_step(dehydrate_statement);

    if (success != SQLITE_DONE) {
        NSAssert1(0,@"Error: failed to save changes with message '%s'.", sqlite3_errmsg(database));
    }

    sqlite3_reset(dehydrate_statement);
    dirty = NO;
    }
} 
```

这有帮助吗？

# .net - 我是否需要 .NET Framework 2.0 SDK 才能使用基于 .NET 的编译器从命令行编译

> ID：857611
> 
> 赞同：0
> 
> 时间：2009-05-13T12:11:46.800
> 
> 标签：.net, c++, visual-c++

嗨，我写了一个类似的代码

文件名 test.cpp

```
#include<stdio.h>

void main()

{

 printf("Hello");
}

} 
```

我的计算机中安装了 .Net Framework 2.0。**使用MSBuild.exe**编译

 **当我尝试从命令行编译它并使用**msbuild.exe**导航到 .NET frameworl 2.0 文件夹时，它显示警告和错误 VCBuild.exe 不可用安装 framework2.0 sdk 我真的需要它吗？？？

帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T12:18:16.947

试试免费的 Visual C++ 编译器，它应该可以满足您的需求。

你可以在[这里](http://www.microsoft.com/express/download/#webInstall)找到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T12:15:00.197

好吧，您当然需要某个地方的 C++ 编译器 - 并且在普通框架中没有 C++ 编译器（与 C# 不同）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-06T07:26:44.737

您不能仅使用 .net 框架的 msbuild.exe 构建 .net 项目。您需要拥有 .net 框架 2.0 SDK 或者您应该已经安装了 .net Studio。最好在不打开 Visual Studio 的 IDE 的情况下安装 Visual Studio Express Edition 并将 MSBuild.exe 用于您的应用程序。

# svn - 使用 cc.net 自动发布开发人员的工作

> ID：857612
> 
> 赞同：2
> 
> 时间：2009-05-13T12:11:57.707
> 
> 标签：svn, msbuild, nunit, cruisecontrol.net

我想构建一个开发人员构建项目，然后需要将其发布到服务器，并且在成功发布后需要针对该开发人员发布构建我的测试项目。基本思想是每当任何开发人员在 Svn 上提交某些内容时运行此过程。

目前我正在使用 CC.net 和 MSBuild。任何人都知道如何完成这项工作。

步骤 1\. 开发人员在 SVN 上提交 步骤 2\. 检测 Svn 上的更改并在构建服务器上进行更新 步骤 3\. 使用最近的更改构建项目 步骤 4\. 将其发布到服务器 步骤 5\. 然后针对最近的发布运行测试（我我通过使用 cc.net、msbuild 和 nunit 成功地完成了这个过程）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T12:15:13.847

如果您使用的是项目标签，您还可以在其中包含发布商。例如：

```
<project >  
 <tasks>  ... 
 </tasks>   
<publishers> 
 <buildpublisher>   
   <sourceDir>path with built binaries</sourceDir>
   <publishDir>path that will be shared</publishDir>
  </buildpublisher> 
 </publishers> 
</project> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T12:43:44.987

无论构建成功还是失败，CC.Net 中的发布者部分都会被执行。您需要在任务部分下添加“发布以构建服务器”作为任务 - 将其放在最后一个构建步骤之后。

这将导致 CC.Net 仅在所有先前的“任务”完成时“发布以构建服务器”，而不会引发错误代码。

通常，如果您知道 DOS .bat 文件中“发布以构建服务器”所需的内容，您可以执行以下操作；

```
<tasks>
    <msbuild>
        <executable>C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe</executable>
        <workingDirectory>c:\Somewhere</workingDirectory>
        <projectFile>Something.sln</projectFile>
        <buildArgs>/noconsolelogger /p:Configuration=Debug /v:m</buildArgs>
        <targets>Build</targets>
        <timeout>720</timeout>
        <logger>C:\program files (x86)\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MsBuild.dll</logger>
    </msbuild>
    <exec>
        <executable>C:\program files (x86)\CruiseControl.NET\server\PublishToServer.bat</executable>
        <baseDirectory>C:\somewhere</baseDirectory>
        <buildArgs></buildArgs>
        <buildTimeoutSeconds>9000</buildTimeoutSeconds>
    </exec>
</tasks> 
```

正如 slawekg 指出的那样，您可以使用 buildpublisher，它**仅**在构建成功时才会执行，但是我仍然发现使用批处理文件进行复制比使用 buildpublisher 更可配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-07T16:30:49.630

You might also consider writing the "push" into your MS Build Script. This would give you the flexibility and control that Sam is talking about and still ensure that the publish only happens if the build succeeds.

# sql - 存储过程中的 Linq to SQL 选择

> ID：857616
> 
> 赞同：0
> 
> 时间：2009-05-13T12:12:46.860
> 
> 标签：sql, linq-to-sql

我有一个通过 LINQ to SQL 调用的存储过程，存储过程调用其中的另一个存储过程，并有一个 SELECT 来输出结果。SELECT 结果没有返回到我的 LINQ to SQL，我只能获取 int 结果值。如何在存储过程中获取存储过程的选择结果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T12:20:50.000

LINQ 设计器无法准确解析您的存储过程以确定架构。一种解决方法是将您的存储过程临时更改为适当模式的简单选择。在设计器中重新映射它。然后，将存储的过程改回原来的。通过这种方式，设计人员能够找出架构并将其正确映射到正确的实体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T16:03:57.280

当您从 Sql Server Management Studio 调用存储过程时，它是否返回多个行集？

如果是这种情况，使用 LINQ 中的存储过程并非易事，请参阅[这篇文章](http://blogs.microsoft.co.il/blogs/bursteg/archive/2007/10/05/linq-to-sql-stored-procedures-with-multiple-results-imultipleresults.aspx)。

使用 DataReader 中的 NextResult 方法可以轻松读取多个结果：

```
var com = yourConnection.CreateCommand();
com.CommandText = "execute dbo.YourSp 'par1'";
var read = com.ExecuteReader();
// Move to second result set and read it
read.NextResult();
while (read.Read()) {
    Console.WriteLine(read["MyField"]);
} 
```

# windows - 适用于 Windows 开发的最简单的免费电子邮件服务器

> ID：857617
> 
> 赞同：1
> 
> 时间：2009-05-13T12:12:53.273
> 
> 标签：windows, email, testing

我在 Windows 平台上开发 Java 应用程序，我的应用程序需要发送电子邮件。出于开发/测试目的，我可以在 Windows 上运行的简单且免费的电子邮件服务器是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T13:13:58.213

如果您运行的不是 Windows 的低端家庭版，那么有一个内置的 SMTP 服务器（安装 IIS 和组件）。

但也许你想要一个“假”服务器，一个只假装转发邮件的服务器。寻找[Dumbster](http://quintanasoft.com/dumbster/)或 .NET 端口 NDumbster

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T13:56:44.353

我对[MailEnable](http://www.mailenable.com/)很幸运。它是免费的，而且设置起来相当容易。

# javascript - Javascript - 如何从文件输入控件中提取文件名

> ID：857618
> 
> 赞同：147
> 
> 时间：2009-05-13T12:12:57.983
> 
> 标签：javascript, browser, extract

当用户在网页中选择文件时，我希望能够仅提取文件名。

我确实尝试了 str.search 功能，但是当文件名如下时它似乎失败了：**c:\uploads\ilike.this.file.jpg**。

我们如何只提取没有扩展名的文件名？

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2012-02-10T21:15:01.773

要拆分字符串 ({filepath}/{filename}) 并获取文件名，您可以使用如下内容：

```
str.split(/(\\|\/)/g).pop() 
```

> “pop 方法从数组中删除最后一个元素并将该值返回给调用者。”
> [Mozilla 开发者网络](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/pop)

例子：

从：`"/home/user/file.txt".split(/(\\|\/)/g).pop()`

你得到：`"file.txt"`

* * *

## 回答 #2

> 赞同：145
> 
> 时间：2009-05-13T12:24:23.817

假设您的**<input type="file" >**有一个**上传**ID，这应该可以解决问题：

```
var fullPath = document.getElementById('upload').value;
if (fullPath) {
    var startIndex = (fullPath.indexOf('\\') >= 0 ? fullPath.lastIndexOf('\\') : fullPath.lastIndexOf('/'));
    var filename = fullPath.substring(startIndex);
    if (filename.indexOf('\\') === 0 || filename.indexOf('/') === 0) {
        filename = filename.substring(1);
    }
    alert(filename);
} 
```

* * *

## 回答 #3

> 赞同：130
> 
> 时间：2016-11-05T14:52:47.430

现在有一个更简单的方法：

```
var fileInput = document.getElementById('upload');   
var filename = fileInput.files[0].name; 
```

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2016-12-15T20:38:35.467

非常简单

```
let file = $("#fileupload")[0].files[0]; 
file.name 
```

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2018-03-09T23:56:29.800

假设：

```
<input type="file" name="file1" id="theFile"> 
```

JavaScript 将是：

```
var fileName = document.getElementById('theFile').files[0].name; 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-05-13T12:20:03.933

```
var pieces = str.split('\\');
var filename = pieces[pieces.length-1]; 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2015-08-22T13:41:36.683

我假设您想删除所有扩展名，`/tmp/test/somefile.tar.gz`即`somefile`.

使用正则表达式的直接方法：

```
var filename = filepath.match(/^.*?([^\\/.]*)[^\\/]*$/)[1]; 
```

正则表达式和数组操作的替代方法：

```
var filename = filepath.split(/[\\/]/g).pop().split('.')[0]; 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-05-10T16:38:56.887

我刚刚制作了我自己的版本。我的函数可以用来从中提取你想要的任何东西，如果你不需要全部，那么你可以很容易地删除一些代码。

```
<html>
<body>
<script type="text/javascript">
// Useful function to separate path name and extension from full path string
function pathToFile(str)
{
    var nOffset = Math.max(0, Math.max(str.lastIndexOf('\\'), str.lastIndexOf('/')));
    var eOffset = str.lastIndexOf('.');
    if(eOffset < 0 && eOffset < nOffset)
    {
        eOffset = str.length;
    }
    return {isDirectory: eOffset === str.length, // Optionally: && nOffset+1 === str.length if trailing slash means dir, and otherwise always file
            path: str.substring(0, nOffset),
            name: str.substring(nOffset > 0 ? nOffset + 1 : nOffset, eOffset),
            extension: str.substring(eOffset > 0 ? eOffset + 1 : eOffset, str.length)};
}

// Testing the function
var testcases = [
    "C:\\blabla\\blaeobuaeu\\testcase1.jpeg",
    "/tmp/blabla/testcase2.png",
    "testcase3.htm",
    "C:\\Testcase4", "/dir.with.dots/fileWithoutDots",
    "/dir.with.dots/another.dir/"
];
for(var i=0;i<testcases.length;i++)
{
    var file = pathToFile(testcases[i]);
    document.write("- " + (file.isDirectory ? "Directory" : "File") + " with name '" + file.name + "' has extension: '" + file.extension + "' is in directory: '" + file.path + "'<br />");
}
</script>
</body>
</html> 
```

将输出以下内容：

*   名称为“testcase1”的文件具有扩展名：“jpeg”在目录中：“C:\blabla\blaeobuaeu”
*   名为“testcase2”的文件具有扩展名：“png”在目录中：“/tmp/blabla”
*   名为“testcase3”的文件具有扩展名：“htm”在目录中：“”
*   名称为“Testcase4”的目录具有扩展名：“”在目录中：“C:”
*   名为“fileWithoutDots”的目录具有扩展名：“”在目录中：“/dir.with.dots”
*   名称为“”的目录具有扩展名：“”在目录中：“/dir.with.dots/another.dir”

`&& nOffset+1 === str.length`添加到`isDirectory`：

*   名称为“testcase1”的文件具有扩展名：“jpeg”在目录中：“C:\blabla\blaeobuaeu”
*   名为“testcase2”的文件具有扩展名：“png”在目录中：“/tmp/blabla”
*   名为“testcase3”的文件具有扩展名：“htm”在目录中：“”
*   名称为“Testcase4”的目录具有扩展名：“”在目录中：“C:”
*   名为“fileWithoutDots”的目录具有扩展名：“”在目录中：“/dir.with.dots”
*   名称为“”的目录具有扩展名：“”在目录中：“/dir.with.dots/another.dir”

给定测试用例，您可以看到与此处提出的其他方法相比，此函数的工作非常稳健。

新手注意 \\: \ 是一个转义字符，例如 \n 表示换行符和 \ta 制表符。为了能够写入 \n，您必须实际键入 \\n。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-06-26T05:34:34.743

**输入**：`C:\path\Filename.ext`
**输出**：`Filename`

在 HTML 代码中，像这样设置 File`onChange`值...

```
<input type="file" name="formdata" id="formdata" onchange="setfilename(this.value)"/> 
```

假设您的文本字段 id 是“wpName”...

```
<input type="text" name="wpName" id="wpName"> 
```

JavaScript

```
<script>
  function setfilename(val)
  {
    filename = val.split('\\').pop().split('/').pop();
    filename = filename.substring(0, filename.lastIndexOf('.'));
    document.getElementById('wpName').value = filename;
  }
</script> 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-05-21T19:45:02.420

两个高度赞成的答案实际上都没有提供“只是没有扩展名的文件名”，而其他解决方案对于这样一个简单的工作来说代码太多了。

我认为这应该是任何 JavaScript 程序员的单行代码。这是一个非常简单的正则表达式：

```
function basename(prevname) {
    return prevname.replace(/^(.*[/\\])?/, '').replace(/(\.[^.]*)$/, '');
} 
```

首先，将任何内容剥离到最后一个斜线（如果存在）。

然后，在最后一个时期之后剥离任何东西（如果存在）。

它很简单，它很健壮，它完全实现了所要求的。我错过了什么吗？

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-03-07T13:33:33.093

```
// HTML
<input type="file" onchange="getFileName(this)">

// JS
function getFileName(input) {
    console.log(input.files[0].name) // With extension
    console.log(input.files[0].name.replace(/\.[^/.]+$/, '')) // Without extension
} 
```

[如何删除扩展](https://stackoverflow.com/a/4250408/1355416)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-10-16T10:15:05.463

```
var path = document.getElementById('upload').value;//take path
var tokens= path.split('\\');//split path
var filename = tokens[tokens.length-1];//take file name 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-09-27T08:16:12.170

以上答案都不适合我，这是我的解决方案，它使用文件名更新禁用的输入：

```
<script type="text/javascript"> 
  document.getElementById('img_name').onchange = function () {
  var filePath = this.value;
    if (filePath) {
      var fileName = filePath.replace(/^.*?([^\\\/]*)$/, '$1');
      document.getElementById('img_name_input').value = fileName;
    }
  };
</script> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-12-05T00:16:00.957

```
//x=address or src
if(x.includes('/')==true){xp=x.split('/')} //split address
if(x.includes('\\')==true){xp=x.split('\\')} //split address
xl=xp.length*1-1;xn=xp[xl] //file==xn
xo=xn.split('.'); //file parts=xo
if(xo.lenght>2){xol=xo.length-1;xt=xo[xol];xr=xo.splice(xol,1);
xr=xr.join('.'); // multiple . in name
}else{
xr=xo[0]; //filename=xr
xt=xo[1]; //file ext=xt
}
xp.splice(xl,1); //remove file
xf=xp.join('/'); //folder=xf , also corrects slashes

//result
alert("filepath: "+x+"\n folder: "+xf+"("+xl+")\n file: "+xn+"\n filename: "+xr+"\n .ext:  "+xt) 
```

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2018-02-07T10:11:14.243

如果您使用的是 jQuery，那么

```
$("#fileupload").val(); 
```

# performance - 查询共享库性能

> ID：857620
> 
> 赞同：0
> 
> 时间：2009-05-13T12:13:12.180
> 
> 标签：performance, shared

我对静态库和共享库（windows - dll）之间的性能差异（从消耗的周期的角度）有疑问。

我有一些代码的静态库。我也有一个用于相同代码的动态库。我已将这两个库链接到一个应用程序。

如果我对这两个库进行分析，性能会不会有任何差异（消耗的周期、缓存命中/未命中等）。（分析条件，两个库的参数相同）

如果有，两者表现差异的原因可能是什么？

谢谢你。

-广告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T12:23:24.300

一旦 DLL 中的例程被 thunk 插入，调用它们时除了额外的 CALL/RET 之外没有性能差异。

# regex - 如何在标签中查找引号？

> ID：857623
> 
> 赞同：4
> 
> 时间：2009-05-13T12:13:15.237
> 
> 标签：regex, vb.net, string, tags, quotes

我有一个这样的字符串：

`This <span class="highlight">is</span> a very "nice" day!`

我在 VB 中的 RegEx 模式应该是什么样子，才能在标签中找到引号？我想用什么来代替它...

`This <span class=^highlight^>is</span> a very "nice" day!`

像 <(")[^>]+> 这样的东西不起作用:(

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-13T13:02:50.617

这取决于您的正则表达式风格，但这适用于大多数人：

```
"(?=[^<]*>) 
```

**编辑：**对于任何好奇这是如何工作的人。这翻译成英语是“在下一个 < 之前找到一个后跟 > 的引用”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T14:08:03.100

正则表达式根本不擅长解析 HTML（请参阅[您能否提供一些示例，说明为什么用正则表达式解析 XML 和 HTML 很困难？](https://stackoverflow.com/questions/701166)为什么）。您需要的是一个 HTML 解析器。请参阅[您能否提供一个使用您最喜欢的解析器解析 HTML 的示例？](https://stackoverflow.com/questions/773340)对于使用各种解析器的示例。

如果您使用的是 VB.net，您应该可以使用[HTMLAgilityPack](https://stackoverflow.com/questions/773340/can-you-provide-an-example-of-parsing-html-with-your-favorite-parser/773769#773769)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-13T12:24:39.103

试试这个：`<span class="([^"]+?)?">`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-13T12:26:20.567

这应该得到标签中的第一个属性值：

```
<[^">]+"(?<value>[^"]*)"[^>]*> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-13T12:39:01.797

如果您打算替换标签中的所有引号，则可以使用以下正则表达式：

`(<[^>"]*)(")([^>]*>)`

这将隔离引号前后的子字符串。*请注意，这不会尝试匹配左引号和右引号。它只是匹配标签中的引号。*

# java - 为某些记录器设置日志级别，但不为其他记录器设置

> ID：857634
> 
> 赞同：3
> 
> 时间：2009-05-13T12:16:19.633
> 
> 标签：java, logging

我正在开发一个使用 java.util.logging 来满足其日志记录需求的 Java 应用程序。此应用程序使用大量外部库（JDBC、JMS 客户端、JSR-160 实现等），其中一些还使用 java.util.logging。

*当我在命令行上指定一个标志时，我想将我的*Loggers的日志级别设置为ALL，但到目前为止，我只找到了为所有记录器设置级别的方法，而不仅仅是我的。

我的记录器都称为“com.mycompany.myapp.SomeClass”，当我将“com.mycompany.myapp”的级别设置为 ALL 时，不会记录任何额外信息。当我将根记录器的级别设置为 ALL 时，所有记录器的所有信息都会记录到控制台，这是太多的信息！

如何在不让所有其他记录器淹没我的日志文件的情况下将我自己的记录器设置为 ALL？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T14:50:47.743

实际上，我不确定您为什么遇到您所描述的问题。我创建了一个简单的 JUnit 测试（如下），并且设置日志级别的工作方式完全符合我的预期（这似乎也符合您期望它们的工作方式）。

您是否尝试在自定义记录器中记录级别设置低于 INFO 的消息？从我包含的测试中可以看出，默认的日志记录处理程序默认设置为 INFO。您需要更改*该处理程序的*级别以查看 FINE 消息（也显示）。

```
import java.util.logging.Handler;
import java.util.logging.Level;
import java.util.logging.Logger;
import org.junit.Test;

public class SimpleLoggerTest {

    private void logMessages(Logger logger) {
        logger.warning(getLoggerName(logger) + ": warning message");
        logger.info(getLoggerName(logger) + ": info message");
        logger.fine(getLoggerName(logger) + ": fine message");
    }

    private String getLoggerName(Logger logger) {
        String loggerName = logger.getName();
        if (loggerName.isEmpty()) {
            return "[root logger]";
        }
        return loggerName;
    }

    private void listHandlerLevels(Logger logger) {
        for (Handler handler : logger.getHandlers()) {
            logger.info(getLoggerName(logger) + ": handler level = " + handler.getLevel());
        }
        Logger parentLogger = logger.getParent();
        if (null != parentLogger) {
            for (Handler handler : parentLogger.getHandlers()) {
                logger.info("parent logger handler (" + getLoggerName(parentLogger) + "): handler level = " + handler.getLevel());
            }
        }
    }

    private void setHandlerLevels(Logger logger, Level level) {
        for (Handler handler : logger.getHandlers()) {
            handler.setLevel(level);
        }
        Logger parentLogger = logger.getParent();
        if (null != parentLogger) {
            for (Handler handler : parentLogger.getHandlers()) {
                handler.setLevel(level);
            }
        }
    }
    @Test
    public void testLoggingLevel() {
        Logger myLogger = Logger.getLogger(SimpleLoggerTest.class.getName());
        Logger rootLogger = myLogger.getParent();

        // list the default handler levels
        listHandlerLevels(myLogger);
        listHandlerLevels(rootLogger);

        // log some messages
        logMessages(myLogger);
        logMessages(rootLogger);

        // change the logger levels
        myLogger.setLevel(Level.ALL);
        rootLogger.setLevel(Level.WARNING);

        // list the handler levels again
        listHandlerLevels(myLogger);
        listHandlerLevels(rootLogger);

        // log some messages (again)
        logMessages(myLogger);
        logMessages(rootLogger);

        // change Handler levels to FINE
        setHandlerLevels(myLogger, Level.FINE);

        // list the handler levels (last time)
        listHandlerLevels(myLogger);
        listHandlerLevels(rootLogger);

        // log some messages (last time)
        logMessages(myLogger);
        logMessages(rootLogger);
    }
} 
```

产生这个输出...

```
May 13, 2009 10:46:53 AM SimpleLoggerTest listHandlerLevels
INFO: parent logger handler ([root logger]): handler level = INFO
May 13, 2009 10:46:53 AM java.util.logging.LogManager$RootLogger log
INFO: [root logger]: handler level = INFO
May 13, 2009 10:46:53 AM SimpleLoggerTest logMessages
WARNING: SimpleLoggerTest: warning message
May 13, 2009 10:46:53 AM SimpleLoggerTest logMessages
INFO: SimpleLoggerTest: info message
May 13, 2009 10:46:53 AM java.util.logging.LogManager$RootLogger log
WARNING: [root logger]: warning message
May 13, 2009 10:46:53 AM java.util.logging.LogManager$RootLogger log
INFO: [root logger]: info message
May 13, 2009 10:46:53 AM SimpleLoggerTest listHandlerLevels
INFO: parent logger handler ([root logger]): handler level = INFO
May 13, 2009 10:46:53 AM SimpleLoggerTest logMessages
WARNING: SimpleLoggerTest: warning message
May 13, 2009 10:46:53 AM SimpleLoggerTest logMessages
INFO: SimpleLoggerTest: info message
May 13, 2009 10:46:53 AM java.util.logging.LogManager$RootLogger log
WARNING: [root logger]: warning message
May 13, 2009 10:46:53 AM SimpleLoggerTest listHandlerLevels
INFO: parent logger handler ([root logger]): handler level = FINE
May 13, 2009 10:46:53 AM SimpleLoggerTest logMessages
WARNING: SimpleLoggerTest: warning message
May 13, 2009 10:46:53 AM SimpleLoggerTest logMessages
INFO: SimpleLoggerTest: info message
May 13, 2009 10:46:53 AM SimpleLoggerTest logMessages
FINE: SimpleLoggerTest: fine message
May 13, 2009 10:46:53 AM java.util.logging.LogManager$RootLogger log
WARNING: [root logger]: warning message 
```

这就是我试图在[我的其他回复](https://stackoverflow.com/questions/857634/set-loglevel-for-some-loggers-but-not-others/857746#857746)中传达的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T12:45:39.943

每个[Logger](https://docs.oracle.com/javase/8/docs/api/java/util/logging/Logger.html)都有一个[Handler](https://docs.oracle.com/javase/8/docs/api/java/util/logging/Handler.html)和它自己的 log [Level](https://docs.oracle.com/javase/8/docs/api/java/util/logging/Level.html)。

您的记录器的处理程序是否也可能没有设置为 ALL 并且忽略了消息？（这很混乱，我知道）。

这是O'Reilly[在 2002 年发表的一篇关于 Java 日志记录的文章。](https://web.archive.org/web/20180506084006/http://www.onjava.com/pub/a/onjava/2002/06/19/log.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T13:44:46.463

是的，JDK 自己的日志框架有时可能是一个真正的婊子。正如您正确注意到的那样，根记录器的处理程序的日志级别是问题所在。您在问题中提出的解决方案几乎是一个很好的解决方案：

```
Logger logger = Logger.getLogger("com.mycompany.myapp");
Handler handler = new ConsoleHandler(); /* or whatever you like. */
handler.setLevel(Level.ALL);
logger.addHandler(handler);
logger.setLevel(Level.ALL);
logger.setUseParentHandlers(false); /* <- important. */ 
```

当您在该记录器“下方”创建记录器时，即名称如“com.mycompany.myapp.foo.Foo”，它们将仅记录到您创建的记录器。该记录器的父记录器（根记录器）将不会获取来自您的应用程序的任何日志消息，但将从 JDK 的其他部分（例如 Swing 或 AWT）接收消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T12:47:35.870

设置属性

```
com.mycompany.myapp.level = ALL 
```

应该做你想做的。

但是所有的记录器都需要用相关的类名正确命名！例如

```
package com.mycompany.myapp;

public class MyClass{
    private static Logger theLogger =
         Logger.getLogger(MyClass.class.getName());
    ...
} 
```

另一种可能的解释是您的配置没有正确传递给日志框架。尝试喂食

```
LogManager.getLogManager().readConfiguration(InputStream); 
```

您在启动时的日志记录配置。这就是我所做的，这对我有用。

# c# - WPF - 计算 FlowDocument 的宽度

> ID：857639
> 
> 赞同：2
> 
> 时间：2009-05-13T12:18:09.723
> 
> 标签：c#, .net, wpf, layout, flowdocument

我正在使用 C# 和 VS2008。

我有一个包含 FlowDocument 的 WPF 应用程序，其中包含一个段落，其中包含许多相当短的行（即 Spans 和 LineBreaks）。但是线的长度会有所不同。我希望 FlowDocument 的宽度足够大，以容纳最长的这些行而不换行，但不要更宽，以免浪费空间。

将其放入 Width=Auto 的网格列中不起作用：FlowDocument 总是消耗允许的最大宽度，因为 FlowDocument 可以有效地换行以适应许多不同的宽度。

当我在代码中生成它们时，我可以遍历这些行，并为每个行计算一个宽度，但我在 Span 或 Run 类上看不到 Width 属性。

关于如何自动或手动设置此文档的宽度的任何想法？

* * *

我使用了 AndrewS 的建议并从 FlowDocument 移动到 StackPanel 的标签，每个标签都包含一行。XAML 标记是

```
<Border BorderThickness="2" Margin="2" BorderBrush="Black">
    <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
        <StackPanel 
         Orientation="Vertical"
            x:Name="itemsStackPanel" />
    </ScrollViewer>
</Border> 
```

代码创建跨度并将它们添加如下：

```
 Label itemLabel = new Label();
        // pad left and right, keep close top and bottom
        itemLabel.Padding = new Thickness(2,0,2,0);
        itemLabel.Content = contentSpan;
        this.itemsStackPanel.Children.Add(itemLabel); 
```

大小现在很完美，唯一的障碍是字体看起来与旁边的 FlowDocument 不完全相同，尽管字体系列和字体大小相同（Segoe UI，15pt），并且标签看起来很多比 FlowDocument 中的行更远。我已将此作为[一个单独的问题提出](https://stackoverflow.com/questions/858728/wpf-flowdocument-and-label-formatting-difference)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T13:14:22.923

您可以将这些行替换为不同类型的元素，例如 TextBlocks 或 Labels（您可以对其进行控制换行）或“专为固定格式的文档演示和打印场景而设计”的 Glyphs。

我真的不认为您想尝试测量线条并强制文档宽度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-03T09:46:48.420

我有类似的情况，但我确实想测量线宽。遗憾的是，RichTextBox 有两个重要的特性捆绑在一起——运行和格式化中的文本前景色和背景色。我需要颜色并且不太关心格式。我有一个字符“网格”，我想在字符上运行几个“光标”。我计划将背景颜色实现为单个光标，并使用前景色进行语法着色。这是一个固定宽度的字体，我不希望网格换行，所以基本上没有格式。我想我可以将其实现为一个网格，我可以在运行时根据我的文本有多大来设置行和列，但这似乎是一种真正的资源浪费——尤其是在文件非常大的情况下——即，一个 100x100 的网格，每个单元格中都有一个单独的标签。最初，也许有点天真，我认为使用 RichTextBox 会很容易，但我开始不相信。另一种可能性是将画布放在标准 TextBox 的顶部并自己绘制矩形，但必须处理所有东西，因为东西滚动等等。对我来说听起来很丑陋且容易出错。我现在的代码是：

```
 private static void SetRichText(RichTextBox rtb, string[] arLines)
    {
        Contract.Assert(arLines.All(l => l.Length == arLines[0].Length));
        FlowDocument doc = new FlowDocument { PageWidth = 65535.0 };

        IEnumerable<Paragraph> iep = arLines.Select(l =>
                                            {
                                                Paragraph p = new Paragraph();
                                                p.Inlines.Add(new Run(l));
                                                return p;
                                            });
        foreach (Paragraph p in iep)
        {
            doc.Blocks.Add(p);
        }

        rtb.Document = doc;
        doc.PagePadding = new Thickness(0, 0, 0, 0);

        Rect rcEOL = rtb.Document.ContentStart.GetPositionAtOffset(arLines[0].Length).GetCharacterRect(LogicalDirection.Forward);
        // TODO : Figure why I have to add a fudge factor in the following (I'm guessing some margin I'm unaware of in the 
        // RichTextBox somewhere)...
        rtb.Document.PageWidth = rcEOL.Right + 18;
    } 
```

正如我在评论中所说，这似乎适用于我目前的情况，但我还没有真正与其他许多人一起测试过，所以我不确定它是否能正常工作，而且无论如何它只是一个大杂烩，我可以' t解释所以我想知道如何正确处理这个问题。感谢您的任何回复。哦，我应该指出，正如我上面所说的，for 是固定的音高，所有传入的字符串都与合同强制执行的长度相同，因此所有行的长度应该完全相同。

# opencv - OpenCV 库和 WM

> ID：857645
> 
> 赞同：0
> 
> 时间：2009-05-13T12:20:12.527
> 
> 标签：opencv

我刚刚使用 OpenCV 库创建了一个应用程序，如果我可以在我的 PDA 上使用这个计算机视觉应用程序会很棒，它上面有 Windows Mobile 6.0。

你知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T14:35:56.490

如果您有 Visual Studio，只需创建一个嵌入式项目。查看[Windows Mobile 开发中心](http://msdn.microsoft.com/en-us/windowsmobile/default.aspx)了解更多信息。除非它是一个非常简单的应用程序，或者您正在处理分辨率非常低的图像，否则如果您能够获得可接受的性能，我会感到惊讶。

# web-crawler - 从站点获取 URL 列表

> ID：857653
> 
> 赞同：114
> 
> 时间：2009-05-13T12:22:58.250
> 
> 标签：web-crawler

我正在为客户部署一个替换站点，但他们不希望所有旧页面都以 404 结尾。保持旧的 URL 结构是不可能的，因为它很可怕。

所以我正在编写一个 404 处理程序，它应该寻找一个被请求的旧页面并永久重定向到新页面。问题是，我需要所有旧页面 URL 的列表。

我可以手动执行此操作，但如果有任何应用程序可以为我提供刚刚给出主页的相对 URL（例如：/page/path，而不是 http:/.../page/path）URL，我会很感兴趣页。就像蜘蛛一样，但它不关心内容，只是寻找更深的页面。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-05-13T12:26:03.097

我并不是要回答我自己的问题，但我只是想运行一个站点地图生成器。第一个我发现[http://www.xml-sitemaps.com](http://www.xml-sitemaps.com)有一个很好的文本输出。非常适合我的需要。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-05-13T12:28:39.690

做`wget -r -l0 www.oldsite.com`

我相信，然后`find www.oldsite.com`就会显示所有网址。

或者，只需在每个 404 请求上提供自定义的未找到页面！即，如果有人使用了错误的链接，他会得到页面告诉该页面没有找到，并就网站的内容做出一些提示。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-01-31T20:32:35.423

这是站点地图生成器的列表（显然您可以从中获取站点的 URL 列表）：[http ://code.google.com/p/sitemap-generators/wiki/SitemapGenerators](http://code.google.com/p/sitemap-generators/wiki/SitemapGenerators)

> 网站地图生成器
> 
> 以下是生成或维护 XML Sitemaps 格式文件的工具的链接，该格式是在 sitemaps.org 上定义的开放标准，并受到 Ask、Google、Microsoft Live Search 和 Yahoo! 等搜索引擎的支持。站点地图文件通常包含网站上的 URL 集合以及这些 URL 的一些元数据。以下工具通常会生成“网络类型”的 XML 站点地图和 URL 列表文件（有些可能还支持其他格式）。
> 
> 请注意：Google 尚未测试或验证本网站上列出的第三方软件的功能或安全性。如有任何关于软件的问题，请直接联系软件作者。我们希望您喜欢这些工具！
> 
> 服务器端程序
> 
> *   Enarion phpSitemapsNG (PHP)
> *   Google 站点地图生成器（Linux/Windows，32/64 位，开源）
> *   Outil en PHP（法语，PHP）
> *   Perl 站点地图生成器 (Perl)
> *   Python 站点地图生成器 (Python)
> *   简单站点地图 (PHP)
> *   SiteMap XML 动态站点地图生成器 (PHP) $
> *   OS/2 的站点地图生成器（REXX 脚本）
> *   XML 站点地图生成器 (PHP) $
> 
> CMS 和其他插件：
> 
> *   ASP.NET - Sitemaps.Net
> *   DotClear（西班牙语）
> *   点清除 (2)
> *   德鲁巴
> *   电子商务模板 (PHP) $
> *   电子商务模板（PHP 或 ASP）$
> *   生活类型
> *   MediaWiki 站点地图生成器
> *   mnoGoSearch
> *   操作系统商务
> *   php网站
> *   克隆
> *   RapidWeaver
> *   文本模式
> *   电子公告
> *   维卡维基 (PHP)
> *   WordPress
> 
> 可下载工具
> 
> *   GSiteCrawler (Windows)
> *   GWebCrawler & Sitemap Creator (Windows)
> *   G-Mapper (Windows)
> *   Inspyder Sitemap Creator (Windows) $
> *   IntelliMapper (Windows) $
> *   Microsys A1 站点地图生成器 (Windows) $
> *   Rage Google Sitemap Automator $ (OS-X)
> *   Screaming Frog SEO Spider 和站点地图生成器 (Windows/Mac) $
> *   站点地图专业版 (Windows) $
> *   站点地图编写器 (Windows) $
> *   DevIntelligence 的站点地图生成器 (Windows)
> *   Sorrowmans 站点地图工具 (Windows)
> *   站点映射器 (Windows) $
> *   Vigos Gsitemap (Windows)
> *   视觉 SEO 工作室 (Windows)
> *   WebDesignPros 站点地图生成器（Java Webstart 应用程序）
> *   网络灯 (Windows/Mac) $
> *   WonderWebWare 站点地图生成器 (Windows)
> 
> 在线发电机/服务
> 
> *   AuditMyPc.com 站点地图生成器
> *   自动地图
> *   自动站点地图 $
> *   Enarion phpSitemapsNG
> *   免费站点地图生成器
> *   Neuroticweb.com 站点地图生成器
> *   ROR 站点地图生成器
> *   ScriptSocket 站点地图生成器
> *   SeoUtility 站点地图生成器（意大利语）
> *   站点地图文档
> *   站点地图
> *   网站地图提交
> *   智能 IT 咨询 Google 站点地图 XML 验证器
> *   XML 站点地图生成器
> *   XML 站点地图生成器
> 
> 带有集成站点地图生成器的 CMS
> 
> *   混凝土5
> 
> Google 新闻站点地图生成器 以下插件允许发布商更新 Google 新闻站点地图文件，这是我们在帮助中心中描述的 sitemaps.org 协议的一种变体。除了站点地图文件的正常属性外，Google 新闻站点地图还允许发布者描述他们发布的内容类型，以及指定单个文章的访问级​​别。有关 Google 新闻的更多信息，请访问我们的帮助中心和帮助论坛。
> 
> *   WordPress 谷歌新闻插件
> 
> 代码片段/库
> 
> *   ASP 脚本
> *   Emacs Lisp 脚本
> *   Java 库
> *   Perl 脚本
> *   PHP 类
> *   PHP 生成器脚本
> 
> 如果您认为出于正当理由应该添加或删除某个工具，请在网站管理员帮助论坛中发表评论。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-06-26T13:20:27.483

我发现的最好的是[http://www.auditmypc.com/xml-sitemap.asp](http://www.auditmypc.com/xml-sitemap.asp)，它使用 Java，对页面没有限制，甚至可以将结果导出为原始 URL 列表。

它还使用会话，因此如果您使用的是 CMS，请确保在运行爬网之前已注销。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-13T12:28:00.567

因此，在理想情况下，您应该为网站中的所有页面制定规范。您还将拥有一个测试基础架构，可以访问您的所有页面以对其进行测试。

你可能不在一个理想的世界里。为什么不这样做……？

1.  在众所周知的旧 URL 和新 URL 之间创建映射。当您看到旧网址时重定向。我可能会考虑提出“此页面已移动，它的新网址是 XXX，您很快就会被重定向”。

2.  如果您没有映射，请显示“抱歉 - 此页面已移动。这是指向主页的链接”消息并根据需要重定向它们。

3.  记录所有重定向——尤其是那些没有映射的。随着时间的推移，为重要的页面添加映射。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-13T12:28:23.187

来自 linux 机器的 wget 也可能是一个不错的选择，因为可以切换到蜘蛛并更改其输出。

编辑：wget 在 Windows 上也可用：http: [//gnuwin32.sourceforge.net/packages/wget.htm](http://gnuwin32.sourceforge.net/packages/wget.htm)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T12:27:13.157

编写一个蜘蛛，它从磁盘读取每个 html 并输出“a”元素的每个“href”属性（可以用解析器完成）。请记住哪些链接属于某个页面（这是 MultiMap 数据结构的常见任务）。在此之后，您可以生成一个映射文件，作为 404 处理程序的输入。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-13T12:29:22.187

我会研究任何数量的在线站点地图生成工具。就我个人而言，我过去使用过[这个](http://www.auditmypc.com/xml-sitemap.asp)（基于 java 的），但如果你在谷歌上搜索“站点地图生成器”，我相信你会找到很多不同的选项。

# vb.net - vs 2008 断片段功能

> ID：857657
> 
> 赞同：0
> 
> 时间：2009-05-13T12:23:29.777
> 
> 标签：vb.net, visual-studio, visual-studio-2008, code-snippets

有没有办法重置为 Visual Studio 2008 附带的原始 vb.net 片段？

我最近安装了一个购买的第三方库，它设法破坏了几乎所有的默认片段。

我可以看到这些片段确实存在于 C:\Program Files\Microsoft Visual Studio 9.0\VB\Snippets\1033 中，但只有以下部分加载到 vs 2008：

应用程序办公室开发操作系统 wpf

任何帮助，将不胜感激...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T13:41:16.140

找到了解决办法！！！

我去了工具>代码片段管理器并重新添加了 C:\Program Files\Microsoft Visual Studio 9.0\VB\Snippets\1033 文件夹

现在一切都很好！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T12:27:51.190

您可以尝试通过调用它来重置 IDE 设置`/resetsettings`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T13:32:51.380

听起来您的 SnippetIndex 文件已损坏。您列出的目录中应该有一个名为 SnippetIndex.xml 的文件。这是为了构建片段的初始列表而查阅的文件。你能检查那个文件，看看它有多大。它应该至少有 500+ 行（我的是 579）。

如果它更少，那么这几乎肯定是你的问题。您可以通过修复 Visual Studio 安装来解决此问题

1.  转到控制面板-> 添加删除程序
2.  选择 Visual Studio
3.  选择维修

# c++ - OpenProcess 在 64 位平台上返回 access_denied

> ID：857665
> 
> 赞同：0
> 
> 时间：2009-05-13T12:25:10.243
> 
> 标签：c++, winapi, 64-bit

我有一个功能：

```
HANDLE snapshot=CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);

...

result=Process32First(snapshot,&pe);
while(result) {
  if(!_stricmp(process_name,pe.szExeFile)) {
    processes.push_back(pe.th32ProcessID);
  }
  result=Process32Next(snapshot,&pe);
}

for(dword_vector::iterator i=processes.begin(); i!=processes.end(); ++i){
  HANDLE hProcess=OpenProcess(PROCESS_TERMINATE, FALSE, *i);
  if(hProcess) {
    TerminateProcess(hProcess, 0);
    CloseHandle(hProcess);
  }
} 
```

它在 32 位平台上运行良好，但在 64 位平台上 OpenProcess 为某些进程返回 Access_denied（可以很好地计算 32 位上的相同进程）。我试图打开的所有进程都是 32 位的。

有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T13:59:37.670

这可能真的存在，但您是从**网络**驱动器执行代码吗？我见过 .NET 应用程序在从网络驱动器运行时无法完成非常基本的事情。

如果是，请尝试将可执行文件移动到本地磁盘，看看是否有帮助。

是的，我知道这是一个非常奇怪的建议，我只是想如果这是它可能有帮助的问题:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-10T04:03:09.207

您的应用程序是 64 位进程还是 32 位进程？不能从 32 位进程打开 64 位进程。

使用任务管理器确保您的应用程序是 64 位的。如果没有，请将其修复并编译为 64 位，您应该能够打开其他 64 位进程和 32 位进程。

如果您的应用是 32 位的，则可能是权限问题。尝试以管理员身份运行它，看看是否能解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T13:38:27.597

会不会是你在 64 位平台上登录的用户没有权限终止这些进程？例如，在 Vista 上，UAC 处于活动状态，您是管理员，但没有运行提升权限并试图关闭系统进程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-07T02:22:48.433

我对操作有同样的假设。经过多次测试，我知道 access_denied 进程的原因是它们在 SYSTEM 用户下，而不是因为它们是 64 位的。

# jquery - 检查 XMLHttpRequest 中的验证错误

> ID：857666
> 
> 赞同：2
> 
> 时间：2009-05-13T12:25:15.110
> 
> 标签：jquery, spring

```
$.post(actionUrl, serializedForm, function(response) {
 ...
} 
```

我需要检查表单验证是否成功（我不需要知道确切的验证错误）。验证是由 Spring 完成的，我不想干涉这个过程，因为有一些烦人的依赖关系。

最好的方法是什么？是否有 Spring 错误对象作为响应，还是只能在服务器端访问？

我还想知道 jQuery 站点中是否有任何关于响应的适当文档？我怎样才能遍历或操纵它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T12:40:51.153

根据actionUrl返回的内容，“response”可以是xml文档、json对象、文本等……取决于服务器设置的Content-Type。由您的服务器端脚本在响应中发送有关任何验证错误的信息，以便它们在 AJAX 回调中可用。JQuery 的[文档](http://docs.jquery.com/Ajax/jQuery.post#urldatacallbacktype)有一些例子。

# javascript - 如何在浏览器中从 JavaScript 连接到 SQL Server 数据库？

> ID：857670
> 
> 赞同：309
> 
> 时间：2009-05-13T12:26:07.073
> 
> 标签：javascript, sql-server, database-connection

谁能给我一些示例源代码，展示如何在本地从 JavaScript 连接到 SQL Server 2005 数据库？我正在桌面上学习网络编程。

还是我需要使用任何其他脚本语言？如果你有的话，建议一些替代方案，但我现在正尝试用 JavaScript 来做。我的 SQL Server 本地安装在我的桌面上——SQL Server Management Studio 2005 和 IE7 浏览器。

* * *

## 回答 #1

> 赞同：756
> 
> 时间：2009-05-13T12:29:45.413

出于多种原因（不良做法、安全问题等），您不应该使用客户端 javascript 访问数据库，但如果您真的想这样做，这里有一个示例：

```
var connection = new ActiveXObject("ADODB.Connection") ;

var connectionstring="Data Source=<server>;Initial Catalog=<catalog>;User ID=<user>;Password=<password>;Provider=SQLOLEDB";

connection.Open(connectionstring);
var rs = new ActiveXObject("ADODB.Recordset");

rs.Open("SELECT * FROM table", connection);
rs.MoveFirst
while(!rs.eof)
{
   document.write(rs.fields(1));
   rs.movenext;
}

rs.close;
connection.close; 
```

连接到 sql server 的更好方法是使用一些服务器端语言，如 PHP、Java、.NET 等。客户端 javascript 应仅用于接口。

并且有一个关于服务器javascript存在的古老传说的传言，但这是另一个故事。;)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-08-21T21:52:01.577

这样做真的很糟糕，因为共享您的连接字符串会使您的网站面临许多无法简单修补的漏洞，如果您希望它是安全的，则必须使用不同的方法。否则，您将向大量受众开放以利用您的网站。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-04-01T14:39:22.797

一个完美的工作代码..

```
 <script>
    var objConnection = new ActiveXObject("adodb.connection");
    var strConn = "driver={sql server};server=QITBLRQIPL030;database=adventureworks;uid=sa;password=12345";
    objConnection.Open(strConn);
    var rs = new ActiveXObject("ADODB.Recordset");
    var strQuery = "SELECT * FROM  Person.Address";
    rs.Open(strQuery, objConnection);
    rs.MoveFirst();
    while (!rs.EOF) {
        document.write(rs.fields(0) + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");
        document.write(rs.fields(1) + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");
        document.write(rs.fields(2) + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    ");
        document.write(rs.fields(3) + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    ");
        document.write(rs.fields(4) + "<br/>");
        rs.movenext();
    }
</script> 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-13T12:37:47.553

## 网页服务

SQL 2005+ 支持您*几乎*可以使用的本机 Web 服务，尽管我不建议这样做，因为您可能面临安全风险。为什么我说*差不多*。好吧，Javascript 不是 SOAP 原生的，所以实际制作它会有点复杂。您必须通过`XmlHttpRequest`. 检查谷歌的 Javascript SOAP 客户端。

*   [http://msdn.microsoft.com/en-us/library/ms345123.aspx](http://msdn.microsoft.com/en-us/library/ms345123.aspx) - SQL 原生 Web 服务
*   [http://www.google.com/search?q=javascript+soap](http://www.google.com/search?q=javascript+soap) - Javascript SOAP 客户端的 Google 结果

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-05-01T12:45:47.723

在 HTA 中使用 JavaScript 时，我没有使用`driver={SQL Server};...`连接字符串，但命名的 DSN 没问题：
我设置了*TestDSN*，它测试正常，然后`var strConn= "DSN=TestDSN";`工作，所以我继续为我的内部测试和学习目的进行试验。

我们的服务器有几个正在运行的实例，例如**server1\dev**和**server1\Test**这让事情变得更加棘手，因为我设法浪费了一些时间忘记逃避`\`as `\\`:)
在连接字符串出现一些死胡同之后`server=server1;instanceName=dev`，我最终得到了这个一个工作：
`var strConn= "Provider=SQLOLEDB;Data Source=server1\\dev;Trusted_Connection=Yes;Initial Catalog=MyDatabase;"`

使用 Windows 凭据而不是提供用户/密码，我发现一个有趣的转移是发现`Integrated Security = true`v `Integrated Security = SSPI`v的微妙之处`Trusted_Connection=Yes`- 请参阅[Integrated Security = True 和 Integrated Security = SSPI 之间的区别](https://stackoverflow.com/questions/1229691/difference-between-integrated-security-true-and-integrated-security-sspi)

请注意，RecordCount 会像`-1`使用默认的*adOpenForwardOnly*类型一样返回。如果您正在处理较小的结果集和/或不介意一次在内存中使用全部内容，请使用`rs.Open(strQuery, objConnection, 3);` *(3=adOpenStatic)*，这会给出有效的`rs.RecordCount`

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-13T12:29:30.250

我不认为你可以从客户端 javascripts 连接到 SQL 服务器。您需要学习一些服务器端语言来构建可以与您的数据库交互的 Web 应用程序，并且仅使用 javascript 来使您的用户界面更好地与之交互。

您可以根据您的语言偏好选择任何服务器端脚本语言：

*   PHP
*   ASP.NET
*   Ruby On Rails

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-13T13:01:07.843

（对不起，这是关于 SQL 后端的更通用的答案——我没有阅读关于 SQL Server 2005 的 WebServices 功能的答案。虽然，这个功能仍然通过 HTTP 运行，而不是更直接地通过套接字，所以基本上他们已经建立一个迷你网络服务器到数据库服务器，所以这个答案仍然是你可以采取的另一条路线。）

您也可以使用套接字（谷歌“javascript 套接字”）直接连接，此时我的意思是为此目的使用 Flash 文件，尽管 HTML5 将 Web 套接字作为规范的一部分，我相信它可以让您做同样的事情。

有些人提到安全问题，但如果您正确设计了数据库权限，理论上您应该能够从任何前端（包括 OSQL）访问数据库，并且不会出现安全漏洞。那么，安全问题是如果您不通过 SSL 连接。

最后，不过，我很确定这都是理论上的，因为我不相信存在任何 JavaScript 库来处理 SSL 或 SQL Server 的通信协议，所以除非你愿意自己弄清楚这些事情最好在浏览器和数据库之间使用 Web 服务器和服务器端脚本语言。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-07-14T12:22:46.180

如前所述，它不应​​该使用客户端 Javascript 来完成，但是有一个框架可以更安全地实现您想要的东西。

Nodejs 是一个允许您使用 javascript 编写服务器连接的框架，因此查看 Nodejs，您可能会学到更多关于与数据库通信和获取所需数据的知识。

# textarea - IE7浏览器文本区域显示问题

> ID：857674
> 
> 赞同：1
> 
> 时间：2009-05-13T12:26:57.010
> 
> 标签：textarea

在我们的应用程序中，我们有一个行大小为 20 的文本区域。早些时候，当我们使用 IE6 浏览器时，文本区域在屏幕上正常显示，但在切换 IE7 浏览器后，我们看到填充 20 行后，活动滚动条开始显示文本区域，而文本区域仅显示 19 行并且 1 行隐藏在滚动条中，要检查 1 行，我们必须使用滚动条。请注意，我们的文本区域的行大小是 20，这意味着它应该显示 20 行而没有活动滚动条，这在 IE6 浏览器中发生但在 IE7 中没有发生。

我们不确定以前是否有其他人遇到过这种问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T08:36:03.753

伙计们..到目前为止，我们已经通过对文本区域使用底部填充完成了一些解决方法......通过这样做，所有内容都在文本区域框中正确显示，但活动滚动条仍然保留在文本区域框中。

如果你们有任何不同的解决方案，请告诉我们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T12:33:07.843

你能在某处设置一个CSS规则来设置物理高度`textarea`吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T12:33:16.203

您可以尝试将 Overflow 属性应用于文本区域的 CSS。尝试溢出：自动；或溢出：隐藏；。最后一个将消除所有滚动条。您也可以尝试更改边框宽度：薄；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-23T05:00:23.143

尽管使用 row="20"，但请尝试为 textarea 使用固定高度。并且不要忘记放置行高。它肯定会解决这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T13:27:31.717

我认为您正在使用溢出：滚动，将其设置为溢出：自动。我检查了它，它正在工作！

# nhibernate - 在 NHibernate 或 Vice Versa 之前学习 SubSonic？

> ID：857678
> 
> 赞同：1
> 
> 时间：2009-05-13T12:27:47.400
> 
> 标签：nhibernate, orm, subsonic

我们一直在为我们公司的项目使用我们自己的 DAL，对于通过的 2 个项目，这给我们带来了问题。因此，我想学习 SubSonic 和/或 NHibernate。是先学习 SubSonic 还是 NHibernate 更好？有什么优点/缺点？从我从相关问题中读到的内容来看，NHibernate 比 SubSonic 更复杂，所以我想从后者开始。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T12:51:45.083

SubSonic 比 NHibernate 容易得多，您几乎可以立即开始使用它（很少的截屏视频就完成了）。在 NHibernate 中，您需要做更多的工作才能启动——XML 配置、会话处理和诸如此类的东西。因此，如果您是 ORM 新手，请先学习 SubSonic，然后再深入研究 NHibernate。就个人而言，我认为对于小型项目，您甚至可以愉快地使用 SubSonic :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T14:30:12.020

SubSonic 是一个[Active Record ORM](http://en.wikipedia.org/wiki/Active_record_pattern)。如果那是您正在寻找的内容，则应将其与其他活动记录 ORM（例如[Castle](http://www.castleproject.org/) ）进行比较。Castle 建立在 nHibernate 之上，因此您的团队可以在需要时扩展到完整的功能集。此时，您将苹果与苹果进行比较，从哪个开始都没有关系。

如果您不是在寻找 Active Record 风格的 ORM，请尝试从 Fluid nHivernate 开始，以稍微降低学习曲线。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T12:35:27.963

我对 SubSonic 了解不多，但我最近承担了使用 NHibernate 进行工具化的任务，发现这[本书](http://www.manning.com/kuate/)（可能是唯一真正的书）非常有用

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T13:15:45.417

NHibernate 肯定更复杂，但随着这种复杂性而来的是更大的灵活性。Subsonic 很棒，但你也应该知道它是一个非常开源的项目，虽然它目前很稳定，但它背后没有 NHibernate 那样活跃的开发社区。

要注意的另一件事是，亚音速是一种“代码生成器”，它实际上会为您生成一堆东西。NHibernate 是字面意义上的 ORM，因为您将对象映射到数据库。您可以使用代码生成器为您生成映射，但这是一种完全不同的 ORM 思考方式。

就个人而言，如果您查看 subsonic 并发现它具有您需要的一切，那么我会看一下，甚至可能是 linq to sql，但是如果您发现您遇到了更复杂的对象问题，那么也许 NHibernate 值得学习.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T13:23:21.770

答案取决于许多不同的因素。如果您学习 nHibernate，您将为自己打开许多学习曲线的大门，但它们都得到了回报。Sub Sonic 可以让你快速上手，但它基于代码生成，这意味着你有界限。使用 nHibernate，您可以定义自己的映射。事实上，使用 Fluent Interface nHibernate 映射，映射对象更加容易、简单和快捷。有一个非常活跃的用户组[链接文字](http://groups.google.com/group/nhusers?pli=1)

此外，您还拥有完全的映射灵活性。nHibernate 可能有点难以开始，但它完全值得学习。我自己使用 nHibernate 为我的客户编写了 2 个专业项目。

# jquery - 如何在匹配之前更改输入的文本

> ID：857690
> 
> 赞同：0
> 
> 时间：2009-05-13T12:30:39.157
> 
> 标签：jquery, autocomplete

我有一个 jQuery.autocomplete 字段，显示有限范围的十进制数字。前任：

```
var the_list = ['+2.23', '+1.10', '-1.10', '-2.00', '-3.00',] 
```

但我允许用户输入像“2.3”和“-5”这样的数据。当我开始输入这些值时，至少我可以获得部分匹配来帮助我。

但是如果我（或其他手指笨拙的人）输入“2,3”（用逗号而不是小数点）怎么办。一旦我击中逗号，我将没有匹配项。这可以通过某种方式解决吗？

*我的想法是在keydown*事件上创建一个处理程序，女巫在自动完成处理程序启动之前用小数点替换逗号。我试图向该字段添加一个事件处理程序，但随后自动完成程序停止一起工作，似乎也没有办法指定处理程序的执行顺序。

如果可能的话，请告诉我如何做到这一点。欢迎任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T04:56:56.323

假设您正在使用此处找到的 jquery 自动完成插件： [http ://www.pengoworks.com/workshop/jquery/autocomplete.htm](http://www.pengoworks.com/workshop/jquery/autocomplete.htm)

然后修改插件文件来改变这个：

```
 function onChange() {
    // ignore if the following keys are pressed: [del] [shift] [capslock]
    if( lastKeyPressCode == 46 || (lastKeyPressCode > 8 && lastKeyPressCode < 32) ) return $results.hide();
    var v = $input.val();
    if (v == prev) return;
    prev = v;
    if (v.length >= options.minChars) {
        $input.addClass(options.loadingClass);
        requestData(v);
    } else {
        $input.removeClass(options.loadingClass);
        $results.hide();
    }
}; 
```

对此：

```
 function onChange() {
    // ignore if the following keys are pressed: [del] [shift] [capslock]
    if( lastKeyPressCode == 46 || (lastKeyPressCode > 8 && lastKeyPressCode < 32) ) return $results.hide();
    var v = $input.val();
            v = fixBadChars(v);
    if (v == prev) return;
    prev = v;
    if (v.length >= options.minChars) {
        $input.addClass(options.loadingClass);
        requestData(v);
    } else {
        $input.removeClass(options.loadingClass);
        $results.hide();
    }
};
    function fixBadChars(v) {
         // Customize this to your tastes
         return v.replace(',','.');
    }; 
```

我只是快速浏览了一下插件，但我猜测/希望这可能会起作用......

// 开始编辑 两者的区别是：

```
 v = fixBadChars(v);

    function fixBadChars(v) {
         // Customize this to your tastes
         return v.replace(',','.');
    }; 
```

// 结束编辑

这是插件的直接链接：参考：[http ://www.pengoworks.com/workshop/jquery/lib/jquery.autocomplete.js](http://www.pengoworks.com/workshop/jquery/lib/jquery.autocomplete.js)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T11:23:07.933

非常感谢 DismissedAsDrone 帮助我设法让我的东西正常工作。我对建议的解决方案做了一些修改，因为我想更新输入框的实际值，而不仅仅是搜索中使用的值。

## 这是我所做的

我从 jQuery 的[这个](http://docs.jquery.com/Plugins/Autocomplete)自动完成插件 (v1.0.2) 开始。

**我在$.Autocompleter.defaults**对象代码中添加了一个 preFilter 选项（1 行代码），如下所示：

```
$.Autocompleter.defaults = {
    inputClass: "ac_input",
    ...,
    preFilter: function(value) { return value; },
    ... 
```

**在 onChange 函数中，我在var currentValue ...**行之后添加了 preFilter（4 行代码）的用法：

```
var currentValue = $input.val();

if ( options.preFilter(currentValue) != currentValue ) {
    $input.val(options.preFilter(currentValue));
    return;
} 
```

## 如何使用它

为了利用新选项来解决我的具体问题，我这样使用它：

```
$(function() {
    $("#the_inputfield").autocomplete(the_data, {
        minChars: 0,
        max: 100,
        selectFirst: false,
        matchContains: true,
        preFilter: function(value) { return value.replace(',','.'); },
    });
}); 
```

# .net - Visual Studio 2008 中的 System.ComponentModel.Component

> ID：857691
> 
> 赞同：0
> 
> 时间：2009-05-13T12:31:04.523
> 
> 标签：.net, visual-studio-2008, visual-studio-2005, data-access

我正在使用 Visual Studio 2008 维护一个 .Net 2.0 应用程序。构建该应用程序时，它最初位于 Visual Studio 2003 中，并使用 System.ComponentModel.Component 类进行数据访问。您可以将命令、连接等拖放到组件的设计器表面。

在 2008 年，数据访问类不会“粘”在组件上。即，该命令的代码不会在类中生成。

1.  这是什么时候改变的？2005 年？
2.  是否有这种行为的替代品，也许使用 db pro 版？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T12:33:25.750

“替换”是使用类型化的 DataSet（使用“Add->New Item”并选择 DataSet，然后将表、视图或存储过程拖到设计图面上）。或实体框架/LINQ to Entities。

而且，是的，这在 VS2005 中发生了变化。

* * *

一项小小的研究让我感到疑惑，因为“它对我有用”。

1.  打开一个简单的类库项目
2.  右键单击并选择“添加 -> 组件”。创建组件并显示熟悉的组件设计图面。
3.  查看工具箱。请注意，SqlCommand 等不在其上。右键单击工具箱并选择“选择项目”。
4.  在过滤器框中键入“System.Data”。它将帮助您找到所有的老朋友，“SqlConnection”、“SqlCommand”、“SqlDataAdapter”，甚至“DataSet”和“DataView”。将它们全部选中，然后单击“确定”。
5.  将 SqlConnection 拖到设计图面上。像往常一样配置它。
6.  将 SqlCommand 拖到设计图面上，正常配置。我什至将 Connection 属性设置为指向我的第一个 SqlConnection。
7.  将“SqlDataAdapter”拖到设计图面上。将出现正常的“配置 DataAdapter”对话框。配置适配器，选择“创建数据集”等。
8.  保存组件，然后关闭它。
9.  再次打开组件。所有这些碎片仍然存在。

你试过什么没用？

# ruby - Ruby 中是否存在某种看不见的数组终止？

> ID：857702
> 
> 赞同：4
> 
> 时间：2009-05-13T12:34:07.717
> 
> 标签：ruby, arrays

我正在编写一种方法，该方法采用可变长度的数组并压缩并将它们转换为匹配的数组长度。

该方法接受从 50 到 126 的任意数组长度。..并在调用时根据参数将它们转换下来。这意味着我正在动态访问在方法调用时指定的范围。这也意味着我将访问不存在的数组的索引。除此之外，我访问的范围可能是相等的。这就是我的问题所在：与任何其他不存在的索引相反，当使用范围访问数组时，数组的终止口袋的行为似乎很奇怪

```
>> a = [0, 1, 2, 3, 4]
# => [0, 1, 2, 3, 4]  

>> a[5]
# => nil  

>> a[4..4]
# => [4]

>> a[6..6]
# => nil  

>> a[5..5]
# => [] <------GGRAAAAAhhh!!! Thought you were nil

>> a[5..7]
# => []   <-------you too

>> a[6..7]
# => nil <-----but you are behaving 
```

有谁知道为什么会这样？它是针对我的代码的空数组的额外测试，但是在我整天在我的 rails 应用程序中追踪这个错误之后，我更加好奇。FWIW 我在 Mac OS X 上运行 Ruby 1.8.6，补丁级别 114

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T12:48:40.000

看起来很奇怪，但这是一个记录在案的行为： [http ://www.ruby-doc.org/core/classes/Array.html#M002183](http://www.ruby-doc.org/core/classes/Array.html#M002183)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T12:49:23.883

超出范围的选择是一种特殊情况，按照文档工作：

[http://www.ruby-doc.org/core/classes/Array.html#M002183](http://www.ruby-doc.org/core/classes/Array.html#M002183)

尽管我同意这并不完全明显。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T12:50:14.070

[这是Ruby 数组](http://www.ruby-doc.org/core/classes/Array.html#M002183)的一个特性。仅当您采用数组的子集时才会发生，该子集的第一个端点等于长度。

~~它允许您执行以下操作：~~

 ~~```
a = [1,2,3]
a[3..3] = [4,5] # a = [1,2,3,4,5] 
```~~  ~~编辑：实际上，您可以在任何范围内做到这一点。我的错。

# jquery - jquery：变量返回NaN

> ID：857703
> 
> 赞同：2
> 
> 时间：2009-05-13T12:34:54.720
> 
> 标签：jquery, variables, position

**不要让下面的代码吓跑你**。这个问题真的很简单，只有两行很麻烦：

为什么我的代码会生成 NaN 错误代码？我正在尝试从另一个变量值中减去一个变量值，因此元素的位置将是正确的。

变量从 jQuery position() 得到它们的值，无论如何它应该是整数。

**检查这些行：**

```
// For some reason NaN error code gets generated when line below gets executed.
var posTop = Startpos.top - Stoppos.top;
var posLeft = Startpos.left - Stoppos.left; 
```

**完整代码：**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <meta http-equiv="Content-type" content="text/html; charset=iso-8859-1" />
    <title>Drag drop 1</title>
    <script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
    <script type="text/javascript" src="js/jquery-ui-1.7.1.custom.min.js"></script>
    <script type="text/javascript">
    $(document).ready(function() {
        var Startpos = new Array;
        var Stoppos = new Array;

        // Make images draggable.
        $(".item").draggable({

            // Elements cannot go outside #container
            containment: 'parent',

            // Make sure the element can only be dropped in a grid.
            grid: [150,150],

            // Find original position of dragged image.
            start: function(event, ui) {

                // Make sure picture always are on top when dragged (z-index).
                $(this).css({'z-index' : '100'});

                // Show start dragged position of image.
                Startpos = $(this).position();
                $("div#start").text("START: \nLeft: "+ Startpos.left + "\nTop: " + Startpos.top);
            },

            // Find position where image is dropped.
            stop: function(event, ui) {

                // Revert to default layer position when dropped (z-index).
                $(this).css({'z-index' : '10'});

                // Show dropped position.
                Stoppos = $(this).position();
                $("div#stop").text("STOP: \nLeft: "+ Stoppos.left + "\nTop: " + Stoppos.top);
            }
        });
        $(".item").droppable({
            drop: function(event, ui) {

                // Dragged image gets swapped with dropped on image.
                var prev_position = "#" + $(this).attr('id');
                // For some reason NaN error code gets generated when line below gets executed.
                var posTop = Startpos.top - Stoppos.top;
                var posLeft = Startpos.left - Stoppos.left;

                // Below variables will work. But unfortunately they
                // doesn't give the correct numbers for the purpose.
                // var posTop = Startpos.top;
                // var posLeft = Startpos.left;

                $(prev_position).css({'top' : posTop, 'left' : posLeft});

                $("div#test").text("Passed variables. Top: " + posTop + " left: " + posLeft);
            }
        });
    });
    </script>
    <style>
    body {

    }
    #container {
        position:relative;
        width:480px;
        border:1px solid #000;
    }
    .item {
        position:relative;
        width:150px;
        height:150px;
        z-index:10;
    }
    </style>
</head>
<body>
    <div id="container">
        <img id="productid_1" src="images/pic1.jpg" class="item" alt="" title="" /><img id="productid_2" src="images/pic2.jpg" class="item" alt="" title="" /><img id="productid_3" src="images/pic3.jpg" class="item" alt="" title="" /><img id="productid_4" src="images/pic4.jpg" class="item" alt="" title="" /><img id="productid_5" src="images/pic5.jpg" class="item" alt="" title="" /><img id="productid_6" src="images/pic6.jpg" class="item" alt="" title="" /><img id="productid_7" src="images/pic7.jpg" class="item" alt="" title="" /><img id="productid_8" src="images/pic8.jpg" class="item" alt="" title="" /><img id="productid_9" src="images/pic9.jpg" class="item" alt="" title="" />
    </div>
    <div style="clear:both;"></div>
    <div id="start">Waiting...</div>
    <div id="stop">Waiting...</div>
    <div id="hover">Waiting...</div>
    <div id="stop2">Waiting...</div>
    <div id="test">Waiting...</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T12:49:43.963

问题是 droppable.drop()在 draggable.stop()*之前*被调用。因此，您的 Stoppos 尚未计算。

解决这个问题的一种方法是简单地跟踪正在拖动的项目，并在 droppable.drop() 中计算该项目的位置。例如（您的代码的子集），请注意“拖动”对象。

```
$(document).ready(function() {
        var Startpos = new Array;
        var Stoppos = new Array;
        var Dragging = null;

        // Make images draggable.
        $(".item").draggable({

                // Elements cannot go outside #container
                containment: 'parent',

                // Make sure the element can only be dropped in a grid.
                grid: [150,150],

                // Find original position of dragged image.
                start: function(event, ui) {
                        Dragging=this;
                        // Make sure picture always are on top when dragged (z-index).
                        $(this).css({'z-index' : '100'});

                        // Show start dragged position of image.
                        Startpos = $(this).position();
                        $("div#start").text("START: \nLeft: "+ Startpos.left + "\nTop: " + Startpos.top);
                },

                // Find position where image is dropped.
                stop: function(event, ui) {
                        // Revert to default layer position when dropped (z-index).
                        $(this).css({'z-index' : '10'});

                        // Show dropped position.
                        Stoppos = $(this).position();
                        $("div#stop").text("STOP: \nLeft: "+ Stoppos.left + "\nTop: " + Stoppos.top);
                        Dragging=null;
                }
        }); 
```

但是，可能还有其他几种合法的方法可以解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T12:41:04.927

据我所知 position() 不是 jQuery 函数。

试试这个：

```
Startpos = $(this).offset(); 
```

然后，您应该能够访问 top 和 left 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T13:04:04.920

你确定这些是导致问题的线路吗？-

你能确认一下“var posTop = Startpos.top - Stoppos.top;”

向 posTop 返回一个有效的整数/双精度值？上周我正在编写我的一个项目并且遇到了同样的 NaN 问题，我尝试将值解析为 Integer 并且它起作用了。

因为您正在进行数学计算，请在减去它们之前尝试将值解析为 Double/Int，

有时，解决方案非常简单，而我们往往过于复杂。

如果解析不起作用，则可能是您没有从数组中传递正确的值。尝试类似 Startpos[0].Top

希望这有帮助，祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T13:14:35.090

当您执行此计算时，Startpos 或 Stoppos 仍然只是一个空数组。

尝试将它们设置为合适的默认值 (0, 0)，因为这可能更容易追踪误入歧途的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T13:24:29.177

令我困惑的是，这有效：

代替：

```
var posTop = Startpos.top - Stoppos.top;
var posLeft = Startpos.left - Stoppos.left; 
```

和：

```
var posTop = Startpos.top;
var posLeft = Startpos.left; 
```

即使数字不是我想要的，也会起作用。由于某种原因，简单的减法似乎无效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T14:35:51.700

谢谢你们的帮助:)

发现了问题。

```
Stoppos = $(this).position(); 
```

不应该在：

```
$(".item").draggable({
stop: function(event, ui) { 
```

但改为：

```
$(".item").droppable({
drop: function(event, ui) { 
```

**完整代码：**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <meta http-equiv="Content-type" content="text/html; charset=iso-8859-1" />
    <title>Drag drop 1</title>
    <script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
    <script type="text/javascript" src="js/jquery-ui-1.7.1.custom.min.js"></script>
    <script type="text/javascript">
    $(document).ready(function() {
        var Startpos = null;
        var Stoppos = null;

        // Make images draggable.
        $(".item").draggable({

            // Elements cannot go outside #container
            containment: 'parent',

            // Make sure the element can only be dropped in a grid.
            grid: [150,150],

            // Find original position of dragged image.
            start: function(event, ui) {

                // Make sure picture always are on top when dragged (z-index).
                $(this).css({'z-index' : '100'});

                // Show start dragged position of image.
                Startpos = $(this).position();
                $("div#start").text("START: \nLeft: "+ Startpos.left + "\nTop: " + Startpos.top);
            },

            // Find position where image is dropped.
            stop: function(event, ui) {

                // Revert to default layer position when dropped (z-index).
                $(this).css({'z-index' : '10'});
            }
        });
        $(".item").droppable({
            drop: function(event, ui) {

                // Dragged image gets swapped with dropped on image.
                var prev_position = "#" + $(this).attr('id');
                Stoppos = $(this).position();
                var posTop = Startpos.top - Stoppos.top;
                var posLeft = Startpos.left - Stoppos.left;
                $(prev_position).css({'top' : posTop, 'left' : posLeft});

                // Test window
                $("div#stop").text("STOP: \nLeft: "+ Stoppos.left + "\nTop: " + Stoppos.top);
                $("div#test").text("Passed variables. Top: " + posTop + " left: " + posLeft);
            }
        });
    });
    </script>
    <style>
    body {

    }
    #container {
        position:relative;
        width:480px;
        border:1px solid #000;
    }
    .item {
        position:relative;
        width:150px;
        height:150px;
        z-index:10;
    }
    </style>
</head>
<body>
    <div id="container">
        <img id="productid_1" src="images/pic1.jpg" class="item" alt="" title="" /><img id="productid_2" src="images/pic2.jpg" class="item" alt="" title="" /><img id="productid_3" src="images/pic3.jpg" class="item" alt="" title="" /><img id="productid_4" src="images/pic4.jpg" class="item" alt="" title="" /><img id="productid_5" src="images/pic5.jpg" class="item" alt="" title="" /><img id="productid_6" src="images/pic6.jpg" class="item" alt="" title="" /><img id="productid_7" src="images/pic7.jpg" class="item" alt="" title="" /><img id="productid_8" src="images/pic8.jpg" class="item" alt="" title="" /><img id="productid_9" src="images/pic9.jpg" class="item" alt="" title="" />
    </div>
    <div style="clear:both;"></div>
    <div id="start">Waiting...</div>
    <div id="stop">Waiting...</div>
    <div id="hover">Waiting...</div>
    <div id="stop2">Waiting...</div>
    <div id="test">Waiting...</div>
</body>
</html> 
```

现在我只需要弄清楚如何在图像被多次移动时正确放置它们。似乎 position:relative 会自动添加到可拖动对象中，并且在计算位置时会遇到麻烦:(

# c# - 获取一个类型的所有派生类型

> ID：857705
> 
> 赞同：68
> 
> 时间：2009-05-13T12:35:34.220
> 
> 标签：c#, .net

是否有更好的（性能更高或更好的代码；）方法来查找类型的所有派生类型？目前我正在使用类似的东西：

1.  获取使用过的程序集中的所有类型
2.  用所有这些类型检查我的类型，如果它是“IsAssignable”

我想知道是否有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2013-07-16T15:08:10.493

I [once](https://stackoverflow.com/questions/2689566/how-to-add-xmlinclude-attribute-dynamically/14403538#14403538) used this Linq-method to get all types inheriting from a base type B:

```
 var listOfBs = (
                    from domainAssembly in AppDomain.CurrentDomain.GetAssemblies()
                    // alternative: from domainAssembly in domainAssembly.GetExportedTypes()
                    from assemblyType in domainAssembly.GetTypes()
                    where typeof(B).IsAssignableFrom(assemblyType)
                    // alternative: where assemblyType.IsSubclassOf(typeof(B))
                    // alternative: && ! assemblyType.IsAbstract
                    select assemblyType).ToArray(); 
```

**EDIT**: As this still seems to get more rep (thus more views), let me add some more details:

*   As the above-mentioned link states, this method uses Reflection on each call. So when using the method repeatedly for the same type, one could probably make it much more efficient by loading it once.
*   As [Anton](https://stackoverflow.com/a/857720) suggests, maybe you could (micro)optimize it using `domainAssembly.GetExportedTypes()` to retrieve only publicly visible types (if that's all you need).
*   As [Noldorin](https://stackoverflow.com/a/857728) mentions, `Type.IsAssignable` will also get the original (non-derived) type. (`Type.IsSubclassOf` will not, but `Type.IsSubclassOf` will not work if the base type is an interface).
*   One may want/need to check for a 'real' class: `&& ! assemblyType.IsAbstract`. (Note that all interfaces are considered abstract, see [MSDN](https://msdn.microsoft.com/en-us/library/system.type.isabstract%28v=vs.110%29.aspx).)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-13T12:40:16.893

我很确定您建议的方法将是查找所有派生类型的更简单方法。父类不存储任何关于它们的子类是什么的信息（如果它们这样做会很愚蠢），这意味着无法避免在这里搜索所有类型。

唯一的建议是使用该`Type.IsSubclassOf`方法，而不是`Type.IsAssignable`为了检查特定类型是否从另一个派生。不过，也许您需要使用一个原因`Type.IsAssignable`（例如，它适用于接口）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-13T12:39:29.750

如果是这种情况，您可以挤出的唯一优化是`Assembly.GetExportedTypes()`仅用于检索公开可见的类型。除此之外，没有办法加快速度。LINQ 可能有助于提高可读性，但不会提高性能。

您可以做一些短路来避免不必要的调用`IsAssignableFrom`，根据 Reflector 的说法，这是相当昂贵的调用，方法是首先测试所讨论的类型是否是必需的“类”。也就是说，您只搜索类，测试枚举或数组的“可分配性”是没有意义的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-13T12:41:03.087

我认为没有更好或直接的方法。

更好：使用`IsSubclassOf`而不是`IsAssignable`.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-21T17:17:02.587

假设 baseType 包含您要检查的 System.Type 对象，并且 matchType 包含具有当前迭代类型的 System.Type 对象（通过 foreach 循环或其他方式）：

如果你想检查 matchType 是从我使用的 baseType 表示的类派生的

```
matchType.IsSubclassOf(baseType) 
```

如果你想检查 matchType 是否实现了我会使用的 baseType 表示的接口

```
matchType.GetInterface(baseType.ToString(), false) != null 
```

当然，我会将 baseType.ToString() 存储为全局变量，因此我不需要一直调用它。而且由于您可能在有很多类型的上下文中需要它，您还可以考虑使用 System.Threading.Tasks.Parallel.ForEach-Loop 来遍历所有类型...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T12:40:52.620

如果您只是对浏览感兴趣，那么 .NET Reflector 可以做到这一点。但是，这并不是真正可行的事情。您想要当前加载的程序集中的所有类型吗？执行程序集引用的程序集？有许多不同的方法来获取类型列表，并且编写一些可以解释（并提供选项）的东西将是一个相当大的成本和相对较低的收益。

你想做什么？可能有更好（或至少更有效）的方法来完成它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-05-17T01:08:44.947

我最终使用了最佳答案给出的代码。唯一的问题是我希望代码更具可读性，所以我写了基本相同的东西，但改为这样：

```
var derived_types = new List<Type>();
foreach (var domain_assembly in AppDomain.CurrentDomain.GetAssemblies())
{
  var assembly_types = domain_assembly.GetTypes()
    .Where(type => type.IsSubclassOf(typeof(MyType)) && !type.IsAbstract);

  derived_types.AddRange(assembly_types);
} 
```

在我的情况下，我使用了`type.IsSubClassOf(MyType)`因为我只想要不包括上面提到的基类的派生类型。我还需要派生类型不是抽象的（`!type.IsAbstract`）所以我也排除了派生的抽象类。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-01-21T17:17:20.347

只需在开始时创建派生类型的静态字典并使用它进行查找。例如。`public static Dictionay<Type, Type[]> DerivedTypes { get;set; }` 其中 Type 是您要包含在搜索中的任何类型，Type[] 是派生类型的列表。在应用程序启动时填写字典并在应用程序的整个生命周期中使用它。

# sql-server - 登录 SQL2008 出现问题

> ID：857721
> 
> 赞同：0
> 
> 时间：2009-05-13T12:39:35.740
> 
> 标签：sql-server, sql-server-2008

我最近安装了 SQL2008，但无法从另一个应用程序登录。我已将安全设置为共享身份验证，并为 SA 登录指定了密码。我可以使用管理工作室的 SA 和密码登录，也可以使用 osql 命令从命令提示符登录，但是当尝试从第三方软件（特别是 WhereNet VSS）登录时，我会弹出“SQL 实例名称或登录信息不正确，请重试。”

有什么建议么？不幸的是，在我成功登录到 SQL 服务器之前，我无法安装该软件，所以我尽快通过这个是至关重要的。

谢谢，

约瑟夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-13T12:42:57.297

您是否启用了与 SQL Svr 实例的远程连接（请参阅服务器属性、连接）？此外，请确保 Windows（或专有）防火墙不会干扰连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T21:45:49.157

除了允许来自 SQL Server 实例属性的远程连接 --> 连接之外，您是否从**SQL Server 外围应用配置**工具配置了远程连接？如果不是，您可能想使用这些选项来启用通过 TCP/IP 和/或命名管道的远程连接。

另外 - 您是否从**配置管理器工具**检查TCP/IP 属性是否正确配置（TCP 端口正确设置等）

你有没有尝试在另一台机器上做同样的事情，看看它是否在相同的设置下工作？

# wpf - 如何从资源中获取 BitmapImage？

> ID：857732
> 
> 赞同：36
> 
> 时间：2009-05-13T12:41:01.853
> 
> 标签：wpf, resources, bitmapimage, pack-uri

我的程序集包含一个带有 BuildAction==Resource 的图像。我想从此嵌入资源中获取 BitmapImage。

我可以像这样从文件中加载 BitmapImage：

```
var bitmap = new BitmapImage(new Uri(path)); 
```

但是如何创建一个引用嵌入资源图像的 Uri？

当我尝试创建“ [pack URI](https://docs.microsoft.com/en-us/dotnet/desktop/wpf/app-development/pack-uris-in-wpf) ”（例如`pack://application:,,,/MyImage.png`or `pack://application:,,,/MyAssembly;component/MyImage.png`）时，会引发异常：

**System.UriFormatException “无效的 URI：由于存在冒号 (':')，因此需要端口，但无法解析端口。”**

[我在这篇博](https://web.archive.org/web/20091026154637/http://compilewith.net/2009/03/wpf-unit-testing-trouble-with-pack-uris.html)文中找到了 UriFormatException 的修复方法

但是，应用该修复程序后，我仍然会在尝试从包 URI 加载 BitmapImage 时遇到异常。

使用该`pack://application:,,,/Image.png`格式时，我得到一个 NullReferenceException，而在使用该`pack://application:,,,/AssemblyName;component/Image.png`格式时，我得到一个 NotSupportedException “Uri 前缀无法识别”。

* * *

**总结** 我的问题是我试图在实例化任何 WPF 控件/窗口/等之前在进程中使用“包 URI”，因此“包”URI 方案尚未注册（其他 WPF 所需的“东西”也必须也不要设置，因为手动注册打包方案本身并不能解决问题）。解决方案是等到实例化我的 WPF 用户控件后才能使用包 URI。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-13T12:47:27.633

[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/aa970069.aspx)包含您可能想了解的有关 WPF 中的资源 URI（通常称为包 URI）的所有信息。您可能会更频繁地使用*相对 URI ，因此请参阅***表 4**，这应该是特别有用的。

如果您想简要了解资源（包）URI，请参阅[此博客文章](http://geekswithblogs.net/NewThingsILearned/archive/2008/04/28/refer-to-resources-in-wpf-with-pack-uri.aspx)。它表明语法确实相对简单：

```
pack://application:,,,/ResourceFile.xaml

pack://application:,,,/ReferencedAssembly;component/ResourceFile.xaml 
```

但是，有一些怪癖需要解决（根据我的经验），因此通常需要进行一些实验才能找到正确的资源 URI。

# java - 在 Java 中分叉一个进程

> ID：857735
> 
> 赞同：4
> 
> 时间：2009-05-13T12:42:27.343
> 
> 标签：java, runtime

是否可以从一个执行序列创建一个完整的“程序”分支，将其执行为两个子程序？

产生的子程序完全相同。它们具有相同的执行顺序和值，但现在它们是两个不同的程序。这就像创建一个对象的克隆，从而为我们提供了两个相同类型的不同对象来处理。但不仅仅是一个对象和一些值，在这里我们想要创建一个已经加载到 JVM 中的程序的完全并行执行序列（希望 Java 的答案）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T12:47:39.177

您似乎正在寻找与 Unix的[fork 系统调用等效的 Java。](http://en.wikipedia.org/wiki/Fork_(operating_system))

这在 Java 中不存在，也不清楚它是否可能，因为 Unix 中的进程在 JVM 中没有直接的等价物（线程的独立性不如进程）。

然而，Java 7 计划了一个 fork 框架：

[http://www.ibm.com/developerworks/java/library/j-jtp11137.html](http://www.ibm.com/developerworks/java/library/j-jtp11137.html)

它与 Unix 的 fork/join 不同，但它分享了一些想法并且可能有用。

当然你可以在 Java 中进行并发编程，只是不是通过 fork()，而是使用 Threads。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T13:59:28.373

我不确定你到底想在这里做什么。对我来说，这听起来像是你对一个最好用另一种方式解决的问题有一个解决方案。这样的事情会实现你的**最终目标**吗？

```
public class MyApp implements Runnable
  {
  public MyApp(int foo, String bar)
    {
    // Set stuff up...
    }

  @Override
  public void run()
    {
    // Do stuff...
    }

  public static void main(String[] argv)
    {
    // Parse command line args...

    Thread thread0 = new Thread(new MyApp(foo, bar));
    Thread thread1 = new Thread(new MyApp(foo, bar));

    thread0.start();
    thread1.start();
    }
  } 
```

虽然我可能会`main()`在真正的应用程序中放入另一个对象，因为生命周期管理是一个单独的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T12:45:07.463

好吧，使用 ProcessBuilder 您可以生成另一个程序。

在 Ant 的 Java 任务中看到[Java 相当于 fork 吗？](https://stackoverflow.com/questions/857236/java-equivalent-of-fork-in-java-task-of-ant/857247#857247)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-13T12:46:25.777

请阅读[此处](http://en.wikipedia.org/wiki/Thread_(computer_science))和[此处](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.html)的线程。

# vb.net - 在 VB.NET 中抑制过时的警告

> ID：857741
> 
> 赞同：14
> 
> 时间：2009-05-13T12:43:45.687
> 
> 标签：vb.net, warnings, obsolete

我在[Visual Studio 2008](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2008)中有使用过时方法的 VB.NET 代码，并希望禁止显示警告。不幸的是，遵循建议并不是一个好的解决方案，因为它需要使用不同的类，它在重要方面的工作方式不同。

我正在尝试使用 System.Diagnostics.CodeAnalysis.SuppressMessage 来抑制警告，但我不知道该写什么作为属性的参数并且找不到任何相关参考。

我还应该说，右键单击错误列表中的错误我没有任何“抑制消息”选项。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-13T13:27:45.240

如果您使用的是 Visual Studio，则可以执行以下操作。

1.  右键单击项目并选择“卸载”
2.  右键单击项目并选择“编辑 SomeProjectName.vbproj”
3.  您应该看到两个名为“NoWarn”的 XML 元素标记。将数字 40000 添加到已经存在的数字列表中（确保对文件中的每个 NoWarn 标记执行此操作）
4.  保存文件
5.  右键单击项目并选择重新加载（您必须关闭 .vbproj 文件）

这将摆脱警告。数字 40000 是过时警告的 VB.Net 错误号。您可以以这种方式抑制任何警告。

注意：如果 NoWarn 标记不存在，请将其添加到具有以下值的主 PropertyGroup 元素

```
<NoWarn>40000</NoWarn> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T12:46:09.473

在 VS.NET 中，您可以右键单击并抑制代码分析警告。这将为您添加属性。

但是，“不要使用过时的 API”警告不是来自代码分析，因此 SurpressMessage 属性不起作用。这是一个编译器警告。

对于 VS.NET，您需要使用...关闭此警告

```
/nowarn:0618 
```

...在命令行中（或者只是将“0618”添加到 csproj 属性的 Suppress Warnings 字段中）。无论 VB 警告编号是什么，您都应该这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-01T16:31:59.977

我能够在我的 VB 项目中用 JaredPar 的回答解决这个问题，谢谢！

我确实对我的**C#**测试项目有相同的警告，我通过在项目属性的构建选项卡的抑制警告部分添加**618**来删除。

请记住 VB 和 C# 的错误代码是不同的。

* * *

如果要纠正这些警告，则需要为 Microsoft OracleClient Developers 安装和使用 ODP.NET

Microsoft 正在弃用 System.Data.OracleClient，也称为 Microsoft OracleClient。Microsoft OracleClient 提供程序开发人员可以利用这个机会重新评估当前和即将进行的项目使用哪个数据提供程序。Oracle 建议开始使用 Oracle Data Provider for .NET (ODP.NET) 构建新的 Oracle .NET 应用程序并将现有应用程序迁移到 ODP.NET。

[http://www.oracle.com/technetwork/topics/dotnet/index-085703.html](http://www.oracle.com/technetwork/topics/dotnet/index-085703.html)

# oracle - Oracle 如何将查询导出到文本/csv 文件

> ID：857744
> 
> 赞同：6
> 
> 时间：2009-05-13T12:44:50.287
> 
> 标签：oracle, plsql, csv, export, text-files

我想知道如何将查询从 PL/SQL 导出到文本文件或 csv 文件。我想到的查询会导出大量数据（大约 1 gig）。因此，我还希望将数据拆分为多个文件；

out1.csv out2.csv out3.csv

我希望能够决定要拆分多少个文件。

任何人都知道如何做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T12:46:55.183

使用[UTL_FILE](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14258/u_file.htm)。

一个众所周知的（可能是关于这个主题的最完整的讨论）讨论可以在 Ask Tom, [Here](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:88212348059)找到，请注意那里的许多示例都可以追溯到 oracle 8，因此在您的版本中可能有更好的方法来做到这一点甲骨文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-27T09:47:55.973

试试这个

用于创建 MYDIR

```
create or replace directory MYDIR as 'F:/DATA/'; 
```

通过**SYS**用户授予**MYDIR**的所有权限执行此过程

 **```
 CREATE OR REPLACE PROCEDURE export_to_csv(refcur out sys_refcursor) IS
      v_file   UTL_FILE.file_type;
      v_string VARCHAR2(4000);
      CURSOR c_emp IS
        SELECT ROLE_ID, ROLE_DESC FROM role_mst;
    BEGIN
      open refcur for
        SELECT ROLE_ID, ROLE_DESC FROM role_mst;
      v_file := UTL_FILE.fopen('MYDIR', 'empdata.csv', 'w', 1000);       
      -- if you do not want heading then remove below two lines
      v_string := 'Emp Code, Emp Name';
      UTL_FILE.put_line(v_file, v_string);
      FOR cur IN c_emp LOOP
        v_string := cur.ROLE_ID || ',' || cur.ROLE_DESC;
        UTL_FILE.put_line(v_file, v_string);
      END LOOP;
      UTL_FILE.fclose(v_file);
    EXCEPTION
      WHEN OTHERS THEN
        dbms_output.put_line(sqlerrm);
        IF UTL_FILE.is_open(v_file) THEN
          UTL_FILE.fclose(v_file);
        END IF;
    END; 
```

# sql - 如何将 .sql 脚本拆分为多个文件？

> ID：857754
> 
> 赞同：4
> 
> 时间：2009-05-13T12:47:17.990
> 
> 标签：sql, sql-server-2005, tsql

我正在使用 DatabasePublishingWizard 生成一个包含数据和模式的大型创建脚本。它生成的文件非常庞大，因此打开脚本来修复任何语法错误几乎是不可能的，小于 4gb 的机器很难让它运行！我应该怎么做？我该怎么做？感谢大家提供的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T13:06:11.207

使用数据库发布向导，您可以将所有对象创建为单独的文件，而不是一个大文件。然后您可以将所有文件放在源代码管理中并跟踪所有更改。

我当前的项目使用脚本来重新创建用于开发的数据库。该脚本删除所有现有对象，然后使用以下语句为每个对象文件读取它们。

sqlcmd -S %1 -d THRIVEHQ -E -b -i "../Tables/Schema.sql" if %ERRORLEVEL% NEQ 0 goto 错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T14:21:39.990

只想添加到凯文的评论中。将脚本分成单独的文件然后编写脚本以按执行顺序放置所有文件。

当将具有大量相互依赖关系的大型数据库转储为一个大文件时，不会对您有多大好处，因为在大多数情况下，脚本不会在没有错误的情况下执行。在我的世界中，我使用命名约定来帮助我快速查看在这种情况下哪些视图依赖于其他视图。例如，如果我有一个视图只生成数据转储，我会使用类似 v_VIEW_NAME_ORIGINATING-TABLE_Dump 的东西，然后我会将后缀更改为类似 _weekly 或 _weekly_Summary 的视图，以获取从主转储表派生的视图.

多年前我吸取了教训，并且在我的所有数据库中都遵循了这个命名模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-21T05:45:09.997

试试 DBSourceTools。
[http://dbsourcetools.codeplex.com](http://dbsourcetools.codeplex.com)
它会将您的整个数据库脚本写入磁盘，每个数据库对象一个文件。
使用部署目标，您可以从文件重新创建任何数据库。
它专门设计用于帮助开发人员将他们的数据库置于源代码控制之下。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T12:50:07.643

在我的脑海中，我会说编写一个脚本将文件分成多个文件，并在每个“GO”语句之后发生中断。您可以编写另一个脚本来按顺序执行每个分解的文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T12:52:35.657

我会分步进行。

将所有表和视图生成为 1 个脚本。

将所有存储过程和授权生成为 1 个脚本。

使用 DTS 或 SSIS 迁移数据。

所有这些都可以通过 MS SQL Server Management Studio 实现。

# apache - 如何在没有互联网连接的情况下通过局域网访问运行 apache 服务器的站点

> ID：857774
> 
> 赞同：39
> 
> 时间：2009-05-13T12:50:53.413
> 
> 标签：apache, localhost, easyphp

我正在使用 EasyPhp 在 Windows XP SP2 计算机上运行服务器。让我们称之为computer_1。电脑的ip地址是192.168.1.2

现在我在局域网上有另一台计算机（computer_2），IP 地址为 192.168.1.3

我想从computer_2 访问computer_1 上的站点。

computer_2 可以 ping computer_1（ping 192.168.1.2 有效）

但是当我在 computer_2 的浏览器中输入[http://192.168.1.2](http://192.168.1.2) 时，什么也没有发生。

我想从computer_2 访问comupter_1 上的站点。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-05-13T13:04:34.030

在你`httpd.conf`确保你有：

```
Listen *:80 
```

如果您使用的是 VirtualHosts，请按以下方式设置它们：

```
NameVirtualHost *
<VirtualHost *>
   ...
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-06-03T08:03:38.077

打开 Apache 服务器的 httpd.conf（先备份） 查找以下内容： 听

将行更改为

```
Listen *:80 
```

仍在 httpd.conf 中，查找以下内容（或类似内容）：

```
<Directory />
    Options FollowSymLinks
    AllowOverride None
    Order deny,allow
    Allow from all
    Deny from all
</Directory> 
```

将此块更改为：

```
<Directory />
    Options FollowSymLinks
    AllowOverride None
    Order deny,allow
    Allow from all
    #Deny from all
</Directory> 
```

保存 httpd.conf 并重启 apache

打开服务器的 80 端口，让每个人都可以访问您的服务器。

打开控制面板>>系统和安全>>Windows防火墙然后单击“高级设置”，然后从左侧面板中选择“入站规则”，然后单击“添加规则...”。从列表中选择“端口”作为选项，然后在下一个屏幕中选择“TCP”协议并在“特定本地端口”下输入端口号“80”，然后单击“下一步”按钮并选择“允许连接”和然后为该端口提供通用名称和描述，然后单击完成。

重新启动 WAMP 并在 LAN 或 WAN 中访问您的计算机。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-10-27T12:59:43.337

*** Don't change anything to Listen : keep it as it is..

1) Open httpd.conf of Apache server (backup first) Look for the the following :

```
<Directory />
    Options FollowSymLinks
    AllowOverride None
    Order deny,allow
    Allow from all
    #Deny from all
</Directory> 
```

and also this

```
<Directory "cgi-bin">
    AllowOverride None
    Options None
    Order allow,deny
    Allow from all
</Directory> 
```

2) Now From taskbar :

> Click on wamp icon > Apache > Apache modules > apache_rewrite (enable this module)

And Ya Also Activate "Put Online" From same taskbar icon

You need to allow port request from windows firewall setting.

(Windows 7)

> Go to control panel > windows firewall > advance setting (on left sidebar)

then

> Right click on inbound rules -> add new rule -> port -> TCP (Specific port 80 - if your localhost wok on this port) -> Allow the connections -> Give a profile name -> ok

Now Restart all the services of Apache server & you are done..

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-10-22T20:07:17.770

如果您确实更改了位于**conf_files文件夹下的****httpd.conf**文件，请不要使用 Windows 记事本，您需要一个 unix 文本编辑器，尝试**TED pad**，对您的 httpd.conf 文件进行任何更改后保存它。ps：如果您使用 dos/windows 编辑器，您最终会收到**“Apache 文件更改错误”**消息。所以要小心....萨拉姆

 ******* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-02-17T07:17:25.340

无需将您的 wamp 站点运行到另一台计算机上。1.首先关闭防火墙。2\. 通过点击时钟附近的 wamp 图标将在线设置为 wamp。

最后在另一台计算机上运行浏览器并输入 http:\ip 地址或计算机名称，例如 http:\192.168.1.100

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-05-04T08:57:31.433

未经您的同意，您的防火墙不允许任何新连接共享信息。唯一要做的就是同意您的防火墙。

1.  转到控制面板中的防火墙设置

2.  点击高级设置

3.  单击入站规则并添加新规则。

4.  选择“规则类型”进行移植。

5.  允许对所有程序进行此操作。

6.  允许将此规则应用于所有配置文件，即域、私有、公共。

7.  给这条规则起任何名字。

而已。现在，连接在同一网络上的另一台 PC 和手机可以访问本地站点。让我们开始开发。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T12:55:50.770

~~请重新表述您的问题。你的第一句话没有意义。~~ .

要解决您的问题：

[http://ip.of.server/](http://ip.of.server/)原则上应该可以工作。但是，根据配置（虚拟主机），仅使用正确的主机名可能有效。

无论如何，如果您有网络，您应该正确配置DNS，否则可能会出现各种问题（例如这样）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T12:59:33.650

您可能还想检查您的服务器配置 - 有时开发类型服务器的默认设置是只接受来自 localhost 的连接。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-16T07:53:43.250

1.  导航到 C:\wamp\alias。
2.  使用项目名称制作文件，例如 phpmyadmin.conf
3.  添加以下部分并更改：

    选项索引 FollowSymLinks MultiViews AllowOverride all Order Deny,Allow Allow from all

将目录更改为您的目录路径，例如 c:\wamp\www\projectfolder

1.  确保在 httpd.conf 中为所有目录（如第一个目录）设置相同的内容：

    选项索引 FollowSymLinks AllowOverride All Order allow,deny Allow from all

第二个目录：

```
<Directory "c:/wamp/www/">

#
# Possible values for the Options directive are "None", "All",
# or any combination of:
#   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
#
# Note that "MultiViews" must be named *explicitly* --- "Options All"
# doesn't give it to you.
#
# The Options directive is both complicated and important.  Please see
# http://httpd.apache.org/docs/2.0/mod/core.html#options
# for more information.
#
    Options Indexes FollowSymLinks

#
# AllowOverride controls what directives may be placed in .htaccess files.
# It can be "All", "None", or any combination of the keywords:
#   Options FileInfo AuthConfig Limit
#
    AllowOverride all

#
# Controls who can get stuff from this server.
#

#   onlineoffline tag - don't remove
    Order Deny,Allow
    Allow from all

</Directory>

<Directory "icons">
    Options Indexes MultiViews
    AllowOverride None
    Order allow,deny
    Allow from all
</Directory> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-06-08T10:58:20.923

1.  打开`internet protocol properties`computer_2 上的“”部分。
2.  `Preferred DNS server`在“ ”文本框中输入computer_1的IP地址（192.168.1.2），点击**确定**，关闭对话框。

现在尝试在computer_2 上再次打开该网站。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-09-20T03:44:08.403

我试图从我的手机（安卓）访问我的本地主机网站（在我的电脑上）。配置类似于 Windows 10、WAMP 2.4.23、PHP 网站，我的手机在安卓上运行。我的手机和电脑都连接到同一个wifi。

[我可以使用 url http://localhost/mysite](http://localhost/mysite)或[http://127.0.0.1/mysite](http://127.0.0.1/mysite)在我的电脑上打开我的网站。我的电脑 ip 是 192.168.0.1（比如说），我的手机 ip 是 192.168.0.2（比如说）并且都连接在同一个 wifi 上。

我尝试了所有设置，例如更改 httpd.conf、httpd-vhosts.conf 只是发现我需要的只是禁用我的防火墙。当然，完全禁用防火墙并不是一个好主意。我的电脑上运行着avast 防病毒软件。如果我检查过去一小时（左右）的防火墙日志，我可以看到我的移动 IP 已尝试连接到我的电脑上运行的网站。它所需要的只是通过在 avast UI 中创建一个新规则来添加一个例外，该规则将允许来自我的移动 IP 的连接。

希望这可以帮助某人。

# c++ - 用for_each调用容器元素成员的成员函数？

> ID：857786
> 
> 赞同：4
> 
> 时间：2009-05-13T12:55:06.667
> 
> 标签：c++, stl, functor, foreach

令人困惑的标题，希望一些代码可以澄清：

```
struct MyNestedType {
    void func();
};

struct MyType {
    MyNestedType* nested;
}

std::vector<MyType> vec;

// ... populate vec

// I want something approximating this line, but that doesn't use made-up C++!
std::for_each(vec.begin(), vec.end(), std::mem_fun_ref(&MyType::nested->func)); 
```

所以基本上我想在容器的每个元素上调用一个方法，但它实际上不是类型的方法，它是包含类型的一些方法......我知道我可以编写一个函数对象来“传递”调用但是我想调用一些方法，这会变得一团糟。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T13:14:24.593

为什么不使用简单的 for 循环？

```
for(vector<MyType>::iterator i = vec.begin(); i != vec.end(); ++i)
    i->nested->func(); 
```

或者，您可以使用 lambda 表达式或 boost::foreach

```
FOREACH(MyType x, vec)
    x.nested->func(); 
```

您可以使用 binders 和 mem_funs 构建您的表达式，但这会变得非常混乱和混乱！将所有内容放在一个 std::foreach 行中没有任何优势。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T13:43:53.703

你可以使用这样的函子

```
template <typename T, T* MyType::* TMember, void (T::* TNestedMember)() >
struct Caller {
    Caller() {
    }

    template <typename TObject>
    void operator()(TObject object) {
        (object.*TMember->*TNestedMember)();
    }
}; 
```

解决您的问题

```
struct MyNestedType {
    MyNestedType(int a):
        a_(a){
    }
    void func() {
        std::cout << "MyNestedType::func " << a_ << std::endl;
    }
    void foo() {
        std::cout << "MyNestedType::foo " << a_ << std::endl;
    }
    int a_;
};
struct MyType {
    MyNestedType* nested;
};

int main()
{
    std::vector<MyType> vec;

    std::auto_ptr<MyNestedType> nt1(new MyNestedType(2));
    std::auto_ptr<MyNestedType> nt2(new MyNestedType(5));
    MyType t1 = {nt1.get()};
    MyType t2 = {nt2.get()};

    vec.push_back(t1);
    vec.push_back(t2);

    std::for_each(vec.begin(), vec.end(), 
                  Caller<MyNestedType, &MyType::nested, &MyNestedType::func>());
    std::for_each(vec.begin(), vec.end(), 
                  Caller<MyNestedType, &MyType::nested, &MyNestedType::foo>());
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T13:25:47.460

也许你可以将 func() 添加到 struct MyType() 中：

```
void func(...) {
   nested->func(...);
} 
```

这样，您将没有单独的适配器仿函数，而是在包装器类型中进行聚合，即非常常规的 OOP 技术。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T13:39:10.480

如果你想使用 for_each 你需要一个仿函数。

```
struct CallMyFunc
{
    void operator()(MyType& obj)    {   obj.nested->func();}
};

std::for_each(vec.begin(), vec.end(), CallMyFunc()); 
```

或者，我会使用以下描述的 boost::FOREACH 语法：

Dario：[用for_each调用容器元素成员的成员函数？](https://stackoverflow.com/questions/857786/call-member-functions-of-members-of-elements-of-a-container-with-foreach/857878#857878)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T14:38:46.920

是的，可以使用`boost::bind`它，但它会变得混乱。`boost::bind`请使用@Dario's boost for-each方式，但为了完整起见，这里是一个

```
std::for_each(vec.begin(), vec.end(), 
    boost::bind(&MyNestedType::func, boost::bind(&MyType::nested, _1))); 
```

无论如何，碰巧的是，我们甚至没有得到一个很好的单线：）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T13:08:42.120

使用Boost的[`transform_iterator`](http://www.boost.org/doc/libs/1_39_0/libs/iterator/doc/transform_iterator.html)怎么样？

# php - 数组值问题

> ID：857793
> 
> 赞同：0
> 
> 时间：2009-05-13T12:56:56.463
> 
> 标签：php, arrays

我有一个问题，一个例程（我无法修改）返回我一个 3 嵌套数组 - 或 - 一个 2 嵌套数组。键值永远不会相同，但是，我想规范化嵌套，以便每次可以使 2 个嵌套数组深 3 级，以避免“注意：未定义索引：”错误。或者如果可能的话，有一个例程来计算数组的深度，以便我可以相应地编码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T13:01:05.020

您可以使用 isset() 来确定数组中是否存在特定级别。如果没有，请添加它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T13:02:42.553

```
function get_depth($arr) {
   foreach ( $arr as $arr2 ) {
     if ( is_array($arr2) ) {
       return 1+get_depth($arr2);
     }
     break;
   }
   return 1;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T13:01:27.157

好吧，这个答案真的取决于你在做什么。为什么不简单地检查嵌套数组是否存在？

```
if (isset($val[3][2])) {
  ....
} 
```

# java - 现在在 Java 中使用的主要工具/框架是什么？

> ID：857795
> 
> 赞同：0
> 
> 时间：2009-05-13T12:57:25.650
> 
> 标签：java, jakarta-ee

我是一名切换到 Java 的 .NET / C++ 程序员。10 多年前，我在大学时接触过 Java。

为了能够用 Java 编写 Web 应用程序，需要学习哪些典型的东西？

我能想到的：JSP/Servlets Eclipse EJB

这些天人们还使用什么？

这个想法是能够登陆一个Java项目并使自己变得有用

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-13T12:58:41.200

[休眠](https://www.hibernate.org/)和[春天](http://www.springsource.org/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T12:59:56.770

工具部门： [Eclipse](http://www.eclipse.org/)和[Netbeans](http://www.netbeans.org/)

（对于以 Web 为中心的 Java 开发，请参阅基于 Eclipse 的[Aptana IDE](http://www.aptana.com/)）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T13:06:58.800

我在大量使用 Java 的客户之间迁移。这是我看到人们使用的：

a) 很多：

*   JDBC
*   小服务程序
*   蚂蚁
*   日志4J
*   Eclipse/Intellij

b) 经常：

*   JSP
*   春天
*   马文
*   网页服务
*   Apache Commons 库

c) 几乎没有：

*   EJB（不是从 2002 年左右开始！）。

我没有遇到过 Hibernate 或其他 ORM。我不知道为什么，我承认，因为它在 SO 的背景下似乎很受欢迎。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T13:15:44.917

如果您特别关注 Web 应用程序，那么了解和理解许多独立于 Java 的主题很重要：

*   JavaScript
*   SQL
*   CSS
*   XML（特别是 XPath）
*   HTML
*   HTTP

在学习可能会或可能不会简化处理它们的代码创建的 Java 框架之前，您需要掌握这些概念。

就特定于 Java 的库和框架而言，这些是必不可少的：

*   Servlet 和 JSP
*   JDBC
*   蚂蚁
*   [Apache Commons——](http://commons.apache.org/)出于对所有美好事物的热爱，不要重新发明公共库！

这些很好，但在学习上述所有内容之前过于狭窄而无法专注：

*   春天
*   休眠
*   马文
*   JSF

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-13T15:58:02.063

Grails 也是一个 Java 平台 Web 应用程序框架，尽管它是用 Groovy 语言而不是 Java 编码的，Java 更像 Python 或 Ruby 并且是动态类型的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-07-21T07:14:32.353

它基于项目和公司，我正在编写一些我遇到的工具/框架

**IDE：**

*   蚀
*   Jboss 开发者
*   IBM 拉德
*   弹簧工具套装(sts)

**存储库**

*   SVN
*   Smartsvn
*   乌龟
*   吉特

**内置工具** - Ant - Maven

**Presentation** -Html, javascript, jquery, ajax -Html with jsp -Html with Struts tags -Html with Spring tag liabaries

**控制器** -Servlets -Struts -Spring

**商务** -Ejb-Spring

**数据库** -Jdbc -Spring

**其他** - WebService - Soap , Rest - Putty - FileZilla - log$j - Mokitio - Junit

# sql - 将 sql mobile 数据与 mysql 服务器同步

> ID：857797
> 
> 赞同：1
> 
> 时间：2009-05-13T12:57:43.090
> 
> 标签：sql, mysql, mobile, synchronize

我们可以将 SQL mobile 中的数据与 SQL Server 同步。但我需要将移动数据与 mysql 服务器同步。有什么办法可以满足我的要求...？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T13:04:07.043

您应该查看[ado.net 的同步服务](http://msdn.microsoft.com/en-us/library/bb726002.aspx)。您将需要编写一些代码，但您可以与任何有 ADO.NET 提供程序可用的数据库同步。[http://dev.mysql.com/downloads/connector/net/6.0.html](http://dev.mysql.com/downloads/connector/net/6.0.html)提供了一个 MySQL 提供程序

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T13:06:15.307

您当前是否在使用 Microsoft Sync Framework？虽然在移动设备上的 SQL CE 数据库和服务器端的 SQL Server 2008 之间进行配置是最简单的，但也可以为其他 DBMS 编写自定义 SyncProvider。我只有为 Oracle 后端编写自定义同步提供程序的经验，这里有关于如何执行此操作的详细信息：[http](http://www.syncguru.com/projects/SyncServicesDemoOracle.aspx) ://www.syncguru.com/projects/SyncServicesDemoOracle.aspx - 但您可以编写同步提供程序对于任何带有 .net 提供程序的 DBMS。

# javascript - 选择所有复选框并通过单击按钮将其传递到另一个页面

> ID：857806
> 
> 赞同：0
> 
> 时间：2009-05-13T13:00:14.193
> 
> 标签：javascript

你好，

我的报告中有多个复选框。我使用两个按钮全选和取消全选来选择所有复选框和取消选择所有复选框。但我无法将检查的值传递给另一个报告。只有当我手动选择复选框时，才会在报告中传递这些值。

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T13:05:01.723

我假设您的全选和取消全选按钮正在使用 javascript 来设置或取消设置表单中的所有其他复选框。

未设置的复选框不会传递。只有一套。如果你需要一个明确的 0 或 1 来传递，你将不得不做一些事情，比如添加额外的隐藏字段被同步到复选框的状态，但这将充满问题（例如，没有 javascript = FAIL ）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T13:23:45.827

您可以有一堆隐藏字段伴随复选框，并在未选中复选框时设置它们的值。

或者，当您需要一个字段的两个或多个状态时，请使用单选按钮。

# sql-server - LINQ to SQL Take w/o Skip 导致多个 SQL 语句

> ID：857807
> 
> 赞同：7
> 
> 时间：2009-05-13T13:00:22.790
> 
> 标签：sql-server, linq, linq-to-sql

我有一个 LINQ to SQL 查询：

```
from at in Context.Transaction
select new  {
    at.Amount,
    at.PostingDate,
    Details = 
        from tb in at.TransactionDetail
        select new {
            Amount = tb.Amount,
            Description = tb.Desc
        }
} 
```

这会导致执行一条 SQL 语句。一切都很好。

但是，如果我尝试从此查询返回已知类型，即使它们具有与匿名类型相同的结构，我也会为顶层执行一条 SQL 语句，然后为每个“子”集执行一条附加 SQL 语句。

有没有办法让 LINQ to SQL 发出一条 SQL 语句并使用已知类型？

编辑：我必须有另一个问题。当我将我的查询的一个非常简单（但仍然是分层的）版本插入 LINQPad 并使用只有 2 或 3 个成员的新创建的已知类型时，我确实得到了一条 SQL 语句。当我知道更多时，我会发布和更新。

编辑 2：这似乎是由于 Take 中的一个错误。有关详细信息，请参阅下面的答案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-15T15:25:55.360

首先 - Take bug 的一些推理。

如果你**只是 Take**，查询翻译器只使用 top。如果加入子集合破坏了基数，Top10 将不会给出正确答案。所以查询翻译器不会加入子集合（而是为子集合请求）。

如果您**Skip 和 Take**，那么查询翻译器会在父行上使用一些 RowNumber 逻辑......这些行号让它占用 10 个父级，即使由于每个父级有 5 个子级，这实际上是 50 条记录。

如果您使用**Skip(0) 和 Take**，则 Skip 会被翻译器作为非操作删除 - 就像您从未说过 Skip 一样。

从您所在的位置（调用 Skip and Take）到“简单的解决方法”，这将是一个艰难的概念飞跃。我们需要做的是强制翻译发生在翻译器无法将 Skip(0) 作为非操作删除的地方。我们需要调用 Skip，并在稍后提供跳过的号码。

```
DataClasses1DataContext myDC = new DataClasses1DataContext();
  //setting up log so we can see what's going on
myDC.Log = Console.Out;

  //hierarchical query - not important
var query = myDC.Options.Select(option => new{
  ID = option.ParentID,
  Others = myDC.Options.Select(option2 => new{
    ID = option2.ParentID
  })
});
  //request translation of the query!  Important!
var compQuery = System.Data.Linq.CompiledQuery
  .Compile<DataClasses1DataContext, int, int, System.Collections.IEnumerable>
  ( (dc, skip, take) => query.Skip(skip).Take(take) );

  //now run the query and specify that 0 rows are to be skipped.
compQuery.Invoke(myDC, 0, 10); 
```

这会产生以下查询：

```
SELECT [t1].[ParentID], [t2].[ParentID] AS [ParentID2], (
    SELECT COUNT(*)
    FROM [dbo].[Option] AS [t3]
    ) AS [value]
FROM (
    SELECT ROW_NUMBER() OVER (ORDER BY [t0].[ID]) AS [ROW_NUMBER], [t0].[ParentID]
    FROM [dbo].[Option] AS [t0]
    ) AS [t1]
LEFT OUTER JOIN [dbo].[Option] AS [t2] ON 1=1 
WHERE [t1].[ROW_NUMBER] BETWEEN @p0 + 1 AND @p1 + @p2
ORDER BY [t1].[ROW_NUMBER], [t2].[ID]
-- @p0: Input Int (Size = 0; Prec = 0; Scale = 0) [0]
-- @p1: Input Int (Size = 0; Prec = 0; Scale = 0) [0]
-- @p2: Input Int (Size = 0; Prec = 0; Scale = 0) [10]
-- Context: SqlProvider(Sql2005) Model: AttributedMetaModel Build: 3.5.30729.1 
```

这就是我们获胜的地方！

```
WHERE [t1].[ROW_NUMBER] BETWEEN @p0 + 1 AND @p1 + @p2 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T13:58:45.177

我现在已经确定这是一个可怕的错误的结果。匿名与已知类型结果不是原因。真正的原因是Take。

以下结果产生 1 个 SQL 语句：

```
query.Skip(1).Take(10).ToList();
query.ToList(); 
```

然而，下面展示了每个父行一个 sql 语句的问题。

```
query.Skip(0).Take(10).ToList();
query.Take(10).ToList(); 
```

谁能想到任何简单的解决方法？

编辑：我想出的唯一解决方法是检查我是否在第一页（IE Skip(0)），然后拨打两个电话，一个使用 Take(1)，另一个使用 Skip(1 ).Take(pageSize - 1) 和 addRange 将列表放在一起。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T13:51:23.440

我没有机会尝试这个，但鉴于匿名类型不是 LINQ 的一部分，而是 C# 构造，我想知道你是否可以使用：

```
from at in Context.Transaction
select new KnownType(
    at.Amount,
    at.PostingDate,
    Details = 
        from tb in at.TransactionDetail
        select KnownSubType(
                Amount = tb.Amount,
                Description = tb.Desc
        )
} 
```

显然，Details 需要是一个 IEnumerable 集合。

我在这方面可能会很宽泛，但它至少会给你一个新的思路去追求，这不会造成伤害，所以请原谅我的漫无边际。

# c++ - C++ 中的静态类数据与匿名命名空间

> ID：857814
> 
> 赞同：16
> 
> 时间：2009-05-13T13:02:03.600
> 
> 标签：c++, namespaces, static-members

我偶尔会有带有私有静态数据成员的类。我目前正在争论是否应该将这些替换为实现文件中未命名命名空间中的静态变量。除了不能在内联方法中使用这些变量之外，还有其他缺点吗？我看到的优点是对班级的用户完全隐藏了它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T13:17:18.113

我不相信好处值得可读性影响。我通常认为私密的东西“足够隐蔽”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T13:27:44.510

1) 对二元组织增加限制的形式存在缺陷。在 1990 年代 C++ 会议上的一次演讲中，Walter Bright 报告说通过组织他的代码使相互调用的函数在同一个编译单元中实现了显着的性能提升。例如，如果在执行期间 Class1::method1 对 Class2 方法的调用远多于对其他 Class1::methods 的调用，则在 class2.cpp 中定义 Class1::method1 意味着 Class1::method1 将与方法位于同一代码页上它正在调用，因此不太可能因页面错误而延迟。这种重构使用类静态比使用文件静态更容易进行。

2)*反对*引入命名空间关键字的一个论据是“你可以对一个类做同样的事情”，你会看到类和结构在前命名空间时代的源代码中被用作穷人的命名空间。令人信服的反驳是因为命名空间是可重新打开的，并且任何地方的任何函数都可以使自己成为命名空间的一部分或访问外部命名空间，所以你可以用命名空间做一些你*不能*用类做的事情。这与您的问题有关，因为它表明语言委员会认为命名空间范围非常类似于类范围；这减少了在使用匿名命名空间而不是类静态时存在一些微妙的语言陷阱的机会。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-14T02:12:30.343

我不同意其他答案。尽可能远离类定义。

在[Scott Meyers 的 Effective C++ 第 3 版](https://rads.stackoverflow.com/amzn/click/com/0321334876)中，他建议优先使用非友元函数而不是类方法。通过这种方式，类定义尽可能小，私有数据在尽可能少的地方被访问（封装）。

遵循这一原则进一步导致了[pimpl 成语](http://www.gamedev.net/reference/articles/article1794.asp)。但是，需要平衡。确保您的代码是可维护的。盲目地，遵循此规则会导致您将所有私有方法文件设为本地文件，并将所需的成员作为参数传入。这将*改善*封装，但会破坏可维护性。

尽管如此，文件本地对象很难进行单元测试。通过一些巧妙的黑客攻击，您可以在单元测试期间访问私有成员。访问文件本地对象有点[复杂](http://code.google.com/p/googletest/wiki/GoogleTestAdvancedGuide#Static_Functions)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-26T01:16:16.453

我部分同意 Greg 的观点，因为未命名的命名空间成员并不比私有数据更封装。毕竟，封装的目的是向其他模块隐藏实现细节，而不是向其他程序员隐藏。尽管如此，我确实认为在某些情况下这是一种有用的技术。

考虑如下类：

```
class Foo {
public:
    ...
private:
    static Bar helper;
}; 
```

在这种情况下，任何想要使用 Foo 的模块也必须知道 Bar 的定义，即使该定义与以往无关。这些头文件依赖导致更频繁和更长的重建。将 helper 的定义移动到 Foo.cpp 中的未命名命名空间是打破这种依赖关系的好方法。

我也强烈反对未命名的命名空间在某种程度上比静态数据成员更不可读或更难维护的概念。从标题中删除不相关的信息只会使其更简洁。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T13:19:51.510

它不仅对班级用户隐藏它们，而且对您隐藏它们！如果这些变量是类的一部分，它们应该以某种方式与类相关联。

根据您要对它们执行的操作，您可以考虑在静态成员函数中将它们设为静态变量：

```
// header file
class A {
  public:
     static void func();
};

// cpp file
void A :: func() {
    static int avar = 0;
    // do something with avar
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-13T13:28:54.617

我想这归结为这些变量在类的上下文中是否具有某些实际含义（例如，指向所有对象使用的一些公共内存的指针）或者只是一些您需要在方法之间传递的临时数据，而不是混乱与类。在后一种情况下，我肯定会使用未命名的命名空间。在前者中，我会说这是个人品味的问题。

# c# - 大型智能视图模型、哑视图和任何模型，最好的 MVVM 方法？

> ID：857820
> 
> 赞同：8
> 
> 时间：2009-05-13T13:03:12.520
> 
> 标签：c#, wpf, mvvm, architecture

以下代码是对我之前的 MVVM 方法（[胖模型、瘦 ViewModels 和哑视图，最好的 MVVM 方法？](https://stackoverflow.com/questions/852441/fat-models-skinny-viewmodels-and-dumb-views-the-best-mvvm-approach)）的重构，其中我**将逻辑和 INotifyPropertyChanged 实现从模型移回了 ViewModel**。这更有意义，因为正如所指出的，您**经常必须使用无法更改**或不想更改的模型，因此您的 MVVM 方法应该能够与任何模型类一起使用存在。

此示例仍然**允许您在 Visual Studio 和 Expression Blend 的设计模式下查看模型中的实时数据**，我认为这很重要，因为您可以拥有一个设计器连接到的模拟数据存储，其中包含最小和最大的字符串UI可能会遇到这样他就可以根据那些极端来调整设计。

问题：

*   我有点惊讶我什至必须在我的 ViewModel 中“放置一个计时器”，因为这似乎是 INotifyPropertyChanged 的​​一个功能，它似乎是多余的，但这是我可以让 XAML UI 不断（一次每秒）反映我的模型的状态。因此，如果您在以后遇到任何不利条件（例如线程或性能**方面），听到任何可能采用这种方法的人会很有趣。**

*如果您只是将 XAML 和代码复制到新的 WPF 项目中，则以下代码将起作用。*

**XAML：**

```
<Window x:Class="TestMvvm73892.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:TestMvvm73892"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <ObjectDataProvider 
              x:Key="DataSourceCustomer" 
              ObjectType="{x:Type local:CustomerViewModel}" 
             MethodName="GetCustomerViewModel"/>
    </Window.Resources>

    <DockPanel DataContext="{StaticResource DataSourceCustomer}">
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
            <TextBlock Text="{Binding Path=FirstName}"/>
            <TextBlock Text=" "/>
            <TextBlock Text="{Binding Path=LastName}"/>
        </StackPanel>
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
            <TextBlock Text="{Binding Path=TimeOfMostRecentActivity}"/>
        </StackPanel>

    </DockPanel>

</Window> 
```

**代码背后：**

```
using System;
using System.Windows;
using System.ComponentModel;
using System.Threading;

namespace TestMvvm73892
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
        }
    }

    //view model
    public class CustomerViewModel : INotifyPropertyChanged
    {
        private string _firstName;
        private string _lastName;
        private DateTime _timeOfMostRecentActivity;
        private Timer _timer;

        public string FirstName
        {
            get
            {
                return _firstName;
            }
            set
            {
                _firstName = value;
                this.RaisePropertyChanged("FirstName");
            }
        }

        public string LastName
        {
            get
            {
                return _lastName;
            }
            set
            {
                _lastName = value;
                this.RaisePropertyChanged("LastName");
            }
        }

        public DateTime TimeOfMostRecentActivity
        {
            get
            {
                return _timeOfMostRecentActivity;
            }
            set
            {
                _timeOfMostRecentActivity = value;
                this.RaisePropertyChanged("TimeOfMostRecentActivity");
            }
        }

        public CustomerViewModel()
        {
            _timer = new Timer(CheckForChangesInModel, null, 0, 1000);
        }

        private void CheckForChangesInModel(object state)
        {
            Customer currentCustomer = CustomerViewModel.GetCurrentCustomer();
            MapFieldsFromModeltoViewModel(currentCustomer, this);
        }

        public static CustomerViewModel GetCustomerViewModel()
        {
            CustomerViewModel customerViewModel = new CustomerViewModel();
            Customer currentCustomer = CustomerViewModel.GetCurrentCustomer();

            MapFieldsFromModeltoViewModel(currentCustomer, customerViewModel);

            return customerViewModel;
        }

        public static void MapFieldsFromModeltoViewModel
             (Customer model, CustomerViewModel viewModel) 
        {
            viewModel.FirstName = model.FirstName;
            viewModel.LastName = model.LastName;
            viewModel.TimeOfMostRecentActivity = model.TimeOfMostRecentActivity;
        }

        public static Customer GetCurrentCustomer()
        {
            return Customer.GetCurrentCustomer();
        }

        //INotifyPropertyChanged implementation
        public event PropertyChangedEventHandler PropertyChanged;
        private void RaisePropertyChanged(string property)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(property));
            }
        }

    }

    //model
    public class Customer
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public DateTime TimeOfMostRecentActivity { get; set; }

        public static Customer GetCurrentCustomer()
        {
            return new Customer 
                       { FirstName = "Jim"
                         , LastName = "Smith"
                         , TimeOfMostRecentActivity = DateTime.Now 
                       };
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-13T19:19:58.473

我喜欢你上面的示例，我认为它实现了 MVVM 的精神。不过，为了澄清起见，ViewModel 代码和 Model 代码不应与实际的背后代码位于同一源文件中。事实上，我认为他们不应该在同一个项目中。

这是我理解的MVVM：

M - 模型是从业务层 (BL) 返回的数据。这应该是轻量级的，包含只读数据。Model 类是哑的，不包含 Update、Write 或 Delete 逻辑，并且由 BL 作为请求、命令、操作等的结果生成。Model 类不知道消费应用程序的呈现需求，因此它们可以被任何方式的应用程序使用。为了真正利用这种可重用性，我们希望模型类独立于 UI 项目。

VM - ViewModel 包含通信层：它向 BL 发出请求并以适合呈现的方式处理结果。与上面的示例一样，它也接收模型并重新格式化它以满足特定的演示需求。将其视为“绑定类”。在上面的示例中，数据只是从一个对象移动到下一个对象，但 ViewModel 将负责诸如公开“FullName”类型属性或将前导零添加到 ZipCode 之类的事情。绑定类是实现 INotifyPropertyChanged 的​​类是正确的。再一次，为了可重用性，我可能会将这一层提取到它自己的项目中。这将允许您在不更改管道的情况下尝试各种 UI 选项。

V - View 绑定到在 VM 中创建的 Binding 类对象。View 超级愚蠢：它对 BL 或 VM 一无所知。数据可以双向绑定，但 VM 处理错误、验证等。任何数据同步操作都是通过将请求传回 BL 来处理的，然后再次处理结果。

这取决于应用程序的类型，但不断检查模型以查看它是否已更改似乎很笨拙。假设您正在连接到从 DAL 构建业务对象（BO）的 BL，该 DAL 正在连接到数据库。在这种情况下，您将不断地重新创建 BO，我敢肯定这会成为性能杀手。您可以在 BL 上实现一个收听通知的结帐系统，或者有一种方法来将最后已知的更改时间与实际时间进行比较，或者您可以在 BL 上缓存 BO。只是一些想法。

另外，我上面说过模型应该是轻量级的。有一些重量级的选项，比如 CSLA，但我不确定它们与 MVVM 理念的契合程度。

我并不是要冒充专家，到目前为止，我只是在设计我们的新软件架构时研究这些想法。我很想读一些关于这个话题的讨论。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T13:59:37.390

我个人的看法是，虽然应该使用**Model来加载和存储数据，但****ViewModel 的**职责是知道何时需要这些数据，因此在 ViewModel 中使用计时器是有意义的。通过这种方式，您可以将您的模型与不同的 ViewModel 一起使用（对于这种情况，只检索一次数据就足够了，而不是每秒检索一次）。

有几点需要考虑：

*   实现您的模型以支持异步数据检索（如果您想针对 Silverlight，这非常重要）
*   小心从后台线程更新集合（在您的示例中不是问题，但是如果您需要使用 ObservableCollection 而不是记住它不能从非 UI 线程更新，[请在此处阅读更多信息](http://mokosh.co.uk/post/2009/04/10/updating-observablecollectiont-from-background-thread/)）

# javascript - 打印 HTML 表单

> ID：857821
> 
> 赞同：0
> 
> 时间：2009-05-13T13:03:41.957
> 
> 标签：javascript, html, css, printing

我正在尝试使用 javascript 打印页面，它工作正常，但问题来自其中的页面 havign 表单。如果我们打印正在打印的表单值很好，但我们得到的是 html 控件（如 input ，dropdown）也正在打印。除了服务器端处理之外，有人可以有任何其他想法吗

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T13:06:57.490

您可以像这样将打印样式表附加到您的页面......

```
<link rel="stylesheet" href="print.css" media="print"/> 
```

然后在打印样式表中您可以指定...

```
input, select
{
    display: none;
} 
```

这将隐藏您的表单控件元素，但仅在打印页面时。您可以通过隐藏导航和链接来扩展它，即在您的网页的打印版本上无用的任何内容

**编辑：**正如正确指出的那样，如果您仍想在文本框等中显示值，您可以将边框样式属性设置为“无”（+您认为合适的任何样式声明），并且仅隐藏打印时无用的元素，例如纽扣

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T13:07:10.033

您可以为打印和屏幕显示提供不同的 css。

在您的打印 css 中，您可能可以通过将边框设置为空、将背景设置为白色等来摆脱大多数 html 控件的可见部分。不过，我还没有尝试过以这种方式摆脱所有东西，所以你最终可能还是会得到一些奇怪的东西。不过值得一试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T13:09:32.400

是的。您必须定义一个不同的 CSS 样式来支持`media="print"`. 用于打印的 CSS 将隐藏适当的控件并显示静态字段。

*   W3C - [http://www.w3.org/TR/CSS2/media.html](http://www.w3.org/TR/CSS2/media.html)
*   浏览器支持： http: [//www.codestyle.org/css/media/print-BrowserSummary.shtml](http://www.codestyle.org/css/media/print-BrowserSummary.shtml)

# c# - 针对停止的 Windows 服务的 C# ExecuteCommand

> ID：857826
> 
> 赞同：1
> 
> 时间：2009-05-13T13:04:44.030
> 
> 标签：c#, windows-services

我正在开发一个应用程序以通过 Windows 服务在后台实现工作。由于 MSDN 教程，我创建了该服务，然后我可以正确启动或停止它。

我的服务还需要执行自定义命令。因此，我在服务类中实现了“ *OnCustomCommand* ”方法。

我可以发送命令 ID 在 128 到 255 之间的自定义执行命令，相应地我在网上找到的所有内容。

我的问题是：服务停止时我无法在服务上执行命令。`ExecuteCommand()`每次`System.InvalidOperationException`我在`serviceController`.

```
Cannot control <myservice> service on computer '.' 
```

服务运行时不会发生这种情况。

MSDN 说

> 当您调用 ExecuteCommand 时，服务的状态不会改变。如果服务已启动，则状态保持为正在运行。如果服务已停止，则状态保持为已停止，依此类推。

所以我想这实际上可以`executeCommand`在停止的服务上实现。

我的服务安装为 LocalSystem 服务，并`serviceController`以管理员权限运行。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T13:12:02.227

无法针对已停止的服务执行 ExecuteCommand。我相信您正在阅读的文档告诉您的是，如果停止，调用 ExecuteCommand 将不会启动该服务。这并不是说您仍然可以调用该方法；基本上不存在执行该方法的对象。我认为您最好的解决方案是找到一种方法来确定服务是否已停止，如果已停止，请重新启动它，然后调用 ExecuteCommand。否则，您可以使用一种“肮脏的黑客”并尝试调用，如果失败，则捕获异常并启动服务并再次尝试。绝不是首选，但可能。

编辑：

假设您使用的是[ServiceController](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicecontroller.aspx)，您可以使用[Status](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicecontroller.status.aspx)属性来确定服务是否正在运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T13:07:55.430

无法针对已停止的服务执行命令。

如果它没有运行，那么它就不会“在那里”监听您发送的命令。

# asp.net - ASP.NET：在客户端添加控件

> ID：857834
> 
> 赞同：6
> 
> 时间：2009-05-13T13:06:24.107
> 
> 标签：asp.net, javascript

如果我有一个带有表单的页面（想象一个只有 TextBoxes 和一个提交按钮的简单页面）并且我希望允许用户通过 javascript 动态地将更多 TextBoxes 添加到表单中，那么处理请求服务器端的最佳方法是什么?

示例：我有一个呈现如下的页面：

```
<input type = "text" id = "control1" name = "control1" />
<input type = "text" id = "control2" name = "control2" />
<input type = "text" id = "control3" name = "control3" />
<input type = "submit" /> 
```

用户触发了一些 Javascript，页面结果如下：

```
<input type = "text" id = "control1" name = "control1" />
<input type = "text" id = "control2" name = "control2" />
<input type = "text" id = "control3" name = "control3" />
<input type = "text" id = "control4" name = "control4" />
<input type = "text" id = "control5" name = "control5" />
<input type = "submit" /> 
```

处理这种情况的最佳方法是什么，或者更一般地说，使用客户端和服务器端动态生成的输入（例如，如何从例如从数据库中获取的一些数据开始在服务器端生成它们）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T14:04:39.487

我已经多次做过类似的事情。我的首选方法通常是`Add`在 UpdatePanel 中使用中继器和按钮（标记为 ）。

对于`Button_OnClick`后面代码中的事件，请执行与此类似的操作；

```
 Loop through the Items collection of the Repeater
 Use item.FindControl("txtUserInput") to get the TextBox for that item
 Save the text of each input to List<string> 
 Add an empty string to the the list
 Databind the repeater to this new list 
```

这是一些示例代码；

```
<asp:Repeater runat="server" ID="rptAttendees">
    <ItemTemplate>
        <asp:TextBox runat="server" ID="txtAttendeeEmail" Text='<%# Container.DataItem %>'></asp:TextBox>
    </ItemTemplate> 
</asp:Repeater>

protected void btnAddAttendee_Click(object sender, EventArgs e)
{
    var attendees = new List<string>();

    foreach (RepeaterItem item in rptAttendees.Items)
    {
        TextBox txtAttendeeEmail = (TextBox)item.FindControl("txtAttendeeEmail");
        attendees.Add(txtAttendeeEmail.Text);
    }

    SaveAttendees();
    attendees.Add("");
    rptAttendees.DataSource = attendees;
    rptAttendees.DataBind();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T13:41:08.730

如果您希望能够使用 FindControl 方法在后面的代码中访问它们，AJAX UpdatePanel 可能是您最好的选择。请记住，每次更新 UpdatePanel 时，您都会经历整个页面生命周期，但只会从服务器获取更新面板中呈现的部分，因此请注意开销。

如果您使用 Javascript 动态创建它们，您将无法使用 FindControl 在后面的代码中访问它们，因为它们不会在页面事件生命周期中重新创建。另外，要小心，因为如果您同时使用某种循环创建大量它们，它可能会减慢速度，尤其是在 Internet Explorer 中。

如果您使用 Javascript 动态创建控件，您还可以考虑将 AJAX 和 WebServices 与 WebMethods 一起使用来提交数据而不是回发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T13:16:48.427

在客户端，创建一个用于创建输入的 JS 函数，例如：

```
var numCtrl = 1; // depends on how many you have rendered on server side
var addCtrl = function() {
    var in = document.createElement('input');
    in.name = "control" + ++i;
    in.type = "text";
    in.id = "control" + i;
    document.getElementById("yourcontainer").appendChild(in);
} 
```

..在服务器端只需查找您的 HTTP 参数集合，遍历它，然后只选择那些匹配 /control\d*/

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T13:57:16.160

我已经开始在我的许多 webforms 应用程序中使用 jquery，并且发现动态控件和使用 JSON 与页面的 WebMethods 通信的组合让我可以更好地控制页面的呈现方式并消除不必要的回发。

当我想触发回发时，我使用 javascript 填充页面上被 jquery 隐藏的服务器控件，然后单击服务器控件按钮。如果用户不能使用 javascript，这允许页面优雅地降级。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T13:12:17.933

在服务器端查看 Request.Form["controlN"] ，您将在其中找到旧字段和新字段。

在服务器端，您可以动态添加控件，例如：

```
foreach (Type object in MyDBCollection)
{
   Controls.Add (new TextBox ());
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T13:17:59.687

在网络表单中，如果您希望这些值回发并能够以典型的方式访问它们，那么您将没有太多选择。我建议您使用 Ajax UpdatePanel 来允许在页面生命周期的适当点（*在*onLoad 之前）注册控件，这也会对您是否需要这些框在回发中持久存在产生影响。其他 2 个答案中涉及的 JS 方法不会通过回发保留文本框。

MVC 为您提供了更多的回旋余地，因为没有那种疯狂的页面生命周期、控件注册、视图状态等妨碍您。

所以最大的问题是，您使用的是哪种 ASP.Net 模型/框架？

* * *

由于您确实在使用网络表单，如果它们对您有用，我强烈建议您使用更新面板。它将允许您以不会妨碍事件验证等方式添加控件。

# java - 动作脚本到 java (red5)

> ID：857841
> 
> 赞同：0
> 
> 时间：2009-05-13T13:08:04.057
> 
> 标签：java, flash, actionscript-3, actionscript, red5

我正在尝试将现有的 actionscript 程序（服务器部分）迁移到 java（red5）。但是，我被以下代码阻止：

```
Client.prototype.requestInterview = function () { }; 
```

有谁知道red5中Client.prototype的等价物是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T14:01:28.527

通过在“原型”中定义对象（在您的情况下为函数），您基本上是在定义类成员。在您的情况下，它将是常规实例方法（在 java 中是公共的）

# .net - Xpath 和 XmlNameSpace

> ID：857850
> 
> 赞同：4
> 
> 时间：2009-05-13T13:09:31.730
> 
> 标签：.net, xml, xpath, namespaces

我有以下 XML

```
<?xml version="1.0"?>
<FileHeader 
  xmlns="urn:schemas-ncr-com:ECPIX:CXF:FileStructure:020001" 
  VersionNumber="020001" 
  TestFileIndicator="P" 
  CreationDate="13012009" 
  CreationTime="172852" 
  FileID="0000000001"
>
  <Item 
    ItemSeqNo="09011340010009" 
    PayorBankRoutNo="00704524" 
    Amount="398000" 
    AccountNo="000003850010205" 
    SerialNo="000512" 
    TransCode="03"
    PresentingBankRoutNo="00400019" 
    PresentmentDate="13012009" 
    CycleNo="01" 
    NumOfImageViews="2" 
    ClearingType="01" 
    DocType="D" 
    CurrencyInd="LYD" 
    IQAIgnoreInd="0" 
    CashValueInd="1" 
    TruncatingRTNo="00405117" 
    SpecialHandling="00" 
    RepresentmentCnt="0" 
    MICRRepairFlags="000000"
  >
    <AddendA 
      BOFDRoutNo="00400019" 
      BOFDBusDate="13012009" 
      DepositorAcct="0000534983"
    />
    <ImageViewDetail ... 
```

我需要使用 XmlDocument .NET 类的 Select(xpath_expression) 方法到达元素“ImageViewDetail”。

以下代码不起作用

```
xmlDocument.Select("//Item/AddendA/ImageViewDetail"); 
```

除非我删除

```
xmlns="urn:schemas-ncr-com:ECPIX:CXF:FileStructure:020001" 
```

来自“文件头”标签

在这里处理命名空间的正确方法是什么？

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-13T13:14:40.147

`XmlNamespaceManager`在 xpath 中使用和 别名：

```
 XmlNamespaceManager mgr = new XmlNamespaceManager(doc.NameTable);
    mgr.AddNamespace("x", doc.DocumentElement.NamespaceURI);
    foreach (XmlNode node in doc.SelectNodes(
          "//x:Item/x:AddendA/x:ImageViewDetail", mgr))
    {
        Console.WriteLine(node.OuterXml);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T13:14:08.867

检查[http://www.vijaymukhi.com/documents/books/csclasses/chap7.htm](http://www.vijaymukhi.com/documents/books/csclasses/chap7.htm)你可能会发现一些可以提供帮助的东西。

# subsonic - 亚音速存储库 BuildUpdateQuery 错误？

> ID：857865
> 
> 赞同：0
> 
> 时间：2009-05-13T13:12:56.593
> 
> 标签：subsonic

我正在使用 ActiveRecord，当我调用 Model.Save 调用 repositry.Update 和 BuildUpdateQuery 时，它会检查项目是否为 ActiveRecord，然后返回脏列。我没有任何脏列。我认为这是因为我没有更改模型上的任何内容，但问题是它继续尝试更新没有设置列的数据库，因此您得到 UPDATE TABLE WHERE ID = 22

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-14T17:27:39.583

绝对似乎是 ActiveRecord 模板中的一个错误。[您应该向 google 代码库http://code.google.com/p/subsonicthree/issues/list](http://code.google.com/p/subsonicthree/issues/list)提交问题。检查该错误是否尚未首先列出。

# sql-server - Microsoft SQL：CASE WHEN 与 ISNULL/NULLIF

> ID：857866
> 
> 赞同：6
> 
> 时间：2009-05-13T13:13:05.750
> 
> 标签：sql-server, null

除了可读性之外，在防止 SQL 中的除以 0 错误时，使用 CASE WHEN 语句与 ISNULL/NULLIF 是否有任何显着的好处？

```
CASE WHEN (BeginningQuantity + BAdjustedQuantity)=0 THEN 0 
ELSE EndingQuantity/(BeginningQuantity + BAdjustedQuantity) END 
```

对比

```
ISNULL((EndingQuantity)/NULLIF(BeginningQuantity + BAdjustedQuantity,0),0) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T14:58:03.037

请记住，NULL 与 0 不同。因此问题中的两个代码片段可以针对相同的输入返回不同的结果。

例如，如果 StartingQuantity 为 NULL，则第一个表达式的计算结果为 NULL：

```
CASE WHEN (NULL + ?)=0 THEN 0 ELSE ?/(NULL + ?) END 
```

现在 (NULL + ?) 等于 NULL，NULL=0 为假，因此评估 ELSE 子句，给出 ?/(NULL+?)，结果为 NULL。但是，第二个表达式变为：

```
ISNULL((?)/NULLIF(NULL + ?,0),0) 
```

这里NULL+？变为 NULL，由于 NULL 不等于 0，NULLIF 返回第一个表达式，即 NULL。外部 ISNULL 捕捉到这一点并返回 0。

所以，下定决心：你是防止被零除，还是被 NULL 除？;-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T13:27:44.603

在您的示例中，我认为性能可以忽略不计。但在其他情况下，根据除数的复杂性，答案是“视情况而定”。

这是一个关于该主题[的有趣博客：](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/sql-server-efficient-handling-of-divide)

为了可读性，我喜欢 Case/When。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T13:19:33.883

在我看来，使用 Isnull/Nullif 比使用 Case When 更快。我宁愿 isnull/nullif。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T13:38:51.307

我会使用 ISNULL，但尝试对其进行格式化，以便更好地显示含义：

```
SELECT
    x.zzz
        ,x.yyyy
        ,ISNULL(
                   EndingQuantity / NULLIF(BeginningQuantity+BAdjustedQuantity,0)
                ,0)
        ,x.aaa
    FROM xxxx... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T15:46:21.927

```
CASE WHEN (coalesce(BeginningQuantity,0) + coalesce(BAdjustedQuantity,0))=0 THEN 0 ELSE coalesce(EndingQuantity,0)/(coalesce(BeginningQuantity,0) + coalesce(BAdjustedQuantity,0)) END 
```

你最好的选择恕我直言

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-03T15:52:49.407

抱歉，这里是更简化的构建 sql 查询。

```
SELECT 

(ISNULL([k1],0) + ISNULL([k2],0)) /

CASE WHEN (
(
   CASE WHEN [k1] IS NOT NULL THEN 1 ELSE 0 END +
   CASE WHEN [k2] IS NOT NULL THEN 1 ELSE 0 END
) > 0 )
THEN
(
  CASE WHEN [k1] IS NOT NULL THEN 1 ELSE 0 END +
  CASE WHEN [k2] IS NOT NULL THEN 1 ELSE 0 END
)
ELSE 1 END

FROM dbo.[Table] 
```

# email - 使用错误跟踪系统通过电子邮件添加错误

> ID：857869
> 
> 赞同：0
> 
> 时间：2009-05-13T13:13:42.300
> 
> 标签：email, bug-tracking

您知道任何支持通过向特定地址发送电子邮件来添加错误的错误跟踪工具吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T13:28:10.390

没有特定的顺序：

*   [准时](http://www.axosoft.com/products/ontime.aspx)

    细节：

    [http://www.axosoft.com/products/ontime_overview.aspx?cn=ovr_email2ticket](http://www.axosoft.com/products/ontime_overview.aspx?cn=ovr_email2ticket)

*   [雾虫](http://fogcreek.com/FogBugz/)

    细节：

    [http://fogcreek.com/FogBugz/LearnMore.html?section=ScreenshotTool](http://fogcreek.com/FogBugz/LearnMore.html?section=ScreenshotTool)

*   [布吉拉](http://www.bugzilla.org/)

    细节：

    [http://www.bugzilla.org/features/#email-in](http://www.bugzilla.org/features/#email-in)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T13:41:44.440

[Trac 存储库中有一个Trac](http://trac.edgewall.org/)示例：[trac emailfilter](http://trac.edgewall.org/browser/trunk/contrib/emailfilter.py)

也就是说，如果您熟悉 Python，那么为 Trac 编写自己的票证创建例程非常简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T13:25:14.747

[布吉拉](https://wiki.mozilla.org/Bugzilla:FAQ:Bugzilla_Email#How_do_I_set_up_the_email_interface_to_submit.2Fchange_bugs_via_email.3F)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-28T21:51:48.093

您可以配置 TestTrack Pro 来监控电子邮件地址。当电子邮件进入时，它们会自动转换为问题。您可以选择将软件配置为向发件人回复特定信息（例如：缺陷编号或分配的案例编号）。

# ms-access - Access 中不同值的运行计数

> ID：857872
> 
> 赞同：1
> 
> 时间：2009-05-13T13:14:03.267
> 
> 标签：ms-access

我将数据存储在 MS Access 数据库中，如下所示：

```
Date         User
20090101     1001
20090101     1002
20090102     1001
20090103     1001
20090103     1003 
```

我正在尝试创建一个查询来显示唯一用户的每日运行计数。例如：

```
Date        Daily Count   Unique User Running Count
20090101    2             2
20090102    1             2
20090103    2             3 
```

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T13:54:00.330

在大多数 SQL 实现中，您可以使用聚合函数 count(distinct user) 进行选择。但 Access 不支持该构造。我认为您能做的最好的事情就是在子查询中选择不同的值并计算它们。

我打算写一个查询，但这个[链接](http://blogs.msdn.com/access/archive/2007/09/19/writing-a-count-distinct-query-in-access.aspx)似乎做得很好。

HTH 汤姆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T13:23:04.750

您的查询看起来像这样......但是没有数据就无法测试它：

```
SELECT Date, Count(Date) As [Daily Count], Count(User) As [Unique User Running Count]
FROM TableName
GROUP BY Date 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-05T13:35:48.587

我做到了！一个简单的解决方案是最好的：不需要 SQL 编码。

![在此处输入图像描述](https://i.stack.imgur.com/tpbVN.jpg)

在 Access、查询设计、

```
Column 1 = 
Field=Date
tablename=yourname
Total=Groupby
Column2 =
Field=Date
Table=yourname
Total=Count 
```

# .net - SQL Server 2005 故障转移群集使用一台服务器？

> ID：857875
> 
> 赞同：0
> 
> 时间：2009-05-13T13:14:19.117
> 
> 标签：.net, sql-server, sql-server-2005, cluster-computing, failover

我正在开发一个托管在 SQL Server 2005 故障转移群集上的应用程序。该应用程序（使用 C#、.Net 2.0 开发）利用了许多集群资源（打印机、文件共享等）。我想建立一个复制集群的测试环境。但是，当前的测试环境只有一个 SQL 服务器，并且没有希望再获得第二台服务器来创建一个完整的集群。有什么方法可以只使用一台服务器来模拟集群环境吗？

任何建议将不胜感激。

非常感谢，MagicAndi。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T13:45:09.143

恰好今天 SQL Server Central 发布了一篇关于此的文章：[在 MS VS2005 R2 第 1 部分下设置 SQL 集群，作者 Perry Whittle](http://www.sqlservercentral.com/articles/Clustering/65994/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T16:10:34.057

使用虚拟机。我为此使用了 MS Virtual Server 和 R2，它支持创建虚拟集群。当我不得不针对集群进行测试并确保我的代码能够优雅地进行故障转移时，我已经这样做了很多次。

整个过程有点复杂，因为您需要创建一个虚拟专用网络并让两个虚拟主机共享集群的虚拟 SCSI 驱动器，但幸运的是那里有很好的分步指南。这是一个很好的：http: [//www.microsoft.com/technet/prodtechnol/virtualserver/deploy/cvs2005.mspx](http://www.microsoft.com/technet/prodtechnol/virtualserver/deploy/cvs2005.mspx)

集群启动并运行后，继续在其上安装集群 SQL 实例，该过程与在真实金属集群上执行此操作完全相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T13:17:09.563

我认为您可以通过操作系统虚拟化来实现它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T13:17:20.860

唯一可能的选择是在一台服务器上设置虚拟机。但是，老实说，我不知道 MS 集群是否支持使用虚拟机作为集群节点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T14:21:15.607

我还没有尝试过，但是您可以尝试在服务器上安装另一个 sql server 实例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-28T12:41:27.387

不，MS 集群确实支持使用虚拟机作为集群节点....如果物理机具有良好的资源，使用虚拟机测试集群环境是一个不错的选择。

# html - PCDATA 和 CDATA 到底是什么？

> ID：857876
> 
> 赞同：31
> 
> 时间：2009-05-13T13:14:22.657
> 
> 标签：html, xml, xhtml, cdata, pcdata

似乎 PCDATA 和 CDATA 的松散定义是

1.  PCDATA 是字符数据，但*要*被解析。
2.  CDATA 是字符数据，*不会*被解析。

但是后来有人告诉我，实际上已经解析了 CDATA 或者实际上没有解析 PCDATA ......所以这有点令人困惑。有谁知道真正的交易是什么？

**更新**：我实际上在维基百科上添加了 PCDATA 定义......所以不要太认真地对待这个答案，因为这只是我对它的粗略理解。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-13T13:21:55.580

来自维基：

[个人电脑数据](http://en.wikipedia.org/wiki/PCDATA)

> 简单来说，PCDATA 代表 Parsed Character Data。这意味着字符将由 XML、XHTML 或 HTML 解析器解析。（`&lt;`将更改为 <，`<p>`将被视为段落标签等）。将其与 CDATA 进行比较，其中字符不会被 XML、XHTML 或 HTML 解析器解析。

[数据中心](http://en.wikipedia.org/wiki/CDATA)

> 术语 CDATA，意思是字符数据，在标记语言 SGML 和 XML 中用于不同但相关的目的。该术语表示文档的某个部分是一般字符数据，而不是非字符数据或具有更具体、有限结构的字符数据。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-14T10:59:01.903

PCDATA 和 CDATA 都被解析。它们都是*字符*数据。

它们都必须只包含有效字符。例如，如果您的文档编码为 UTF-8，则 CDATA 部分的内容仍必须是有效的 UTF-8 字符。所以随机二进制数据可能会阻止文档格式正确。如果只是为了找到结束部分标记，仍然会解析 CDATA 部分。但是其他类似标记的字符，如 <、> 和 & 被解析器忽略并按原样传递。

PCDATA 文字`<`和`&`（和`'`/或`"`属性值）中的 OTOH 必须转义，否则它们将被解释为标记。实体也将扩大。

所以是的，CDATA 部分确实被解析了。我不确定为什么你被告知 PCDATA 没有被解析。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-13T13:20:07.890

PCDATA - 解析的字符数据

CDATA -（未解析的）字符数据

[http://www.w3schools.com/XML/xml_cdata.asp](https://web.archive.org/web/20150913104318/http://www.w3schools.com:80/xml/xml_cdata.asp)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-24T05:26:29.920

*   PCDATA 是将由解析器解析的文本。文本内的标签将被视为标记，实体将被展开。
*   CDATA 是*不会*被解析器解析的文本。文本内的标签 *不会*被视为标记，实体也不会被展开。

默认情况下，一切都是 PCDATA。在下面的例子中，忽略根，`<bar>`将被解析，它没有内容，只有一个孩子。

```
<?xml version="1.0"?>
<foo>
<bar><test>content!</test></bar>
</foo> 
```

当我们要指定一个元素只包含文本，不包含子元素时，我们使用关键字PCDATA，因为这个关键字指定元素必须包含可解析的字符数据——即除小于(< ) 、大于 (>) 、和号 (&)、引号 (') 和双引号 (")。

在下一个示例中， bar 是 CDATA，未进行解析，并且具有 content `"<test>content!</test>"`。

```
<?xml version="1.0"?>
<foo>
<bar><![CDATA[<test>content!</test>]]></bar>
</foo> 
```

SGML 中有几个内容模型。#PCDATA 内容模型表示元素可能包含纯文本。它的“已解析”部分意味着其中的标记（包括 PI、注释和 SGML 指令）被解析而不是显示为原始文本。这也意味着实体引用被替换。

另一种允许纯文本内容的内容模型是 CDATA。在 XML 中，元素内容模型可能不会隐式设置为 CDATA，但在 SGML 中，这意味着在元素的内容中忽略了标记和实体引用。然而，在 CDATA 类型的属性中，实体引用被替换。

在 XML 中，#PCDATA 是唯一的纯文本内容模型。如果您想在元素中允许文本内容，您可以使用它。CDATA 内容模型可以通过#PCDATA 中的 CDATA 块标记显式使用，但默认情况下元素内容可能不会定义为 CDATA。

在 DTD 中，包含文本的属性类型必须是 CDATA。属性声明中的 CDATA 关键字与 XML 文档中的 CDATA 部分具有不同的含义。在 CDATA 部分中，所有字符都是合法的（包括 <、>、&、' 和“字符），除了“]]>”结束标记。

#PCDATA 不适用于属性的类型。它用于“叶子”文本的类型。

仅出于历史原因，#PCDATA 前面带有一个散列（也称为“hashtag”或 octothorp）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T13:21:30.417

你的第一个定义是正确的。

PCDATA 被解析，这意味着实体被扩展并且文本被视为标记。XML 解析器不解析 CDATA。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-12T09:38:36.543

如果在 XHTML DTD 中只有元素默认设置为 CDATA，它会节省很多丑陋的手动覆盖……为什么脚本块会包含其他元素？如果有这样的元素，它们将由 JS 解释器在 DOM 操作操作中处理——在这种情况下，XML 解析器在文档插入和呈现之前仍应完全忽略它们。我想它可能是为了强制使用外部脚本资源文件而设计的，这最终是一件好事。

# php - 在 Vim 中格式化 PHP 代码

> ID：857885
> 
> 赞同：34
> 
> 时间：2009-05-13T13:15:05.637
> 
> 标签：php, vim, code-formatting, tidy

我目前使用 Vim 作为轻量级 IDE。我有 NERDTree、bufexplorer、supertab 和 ctags 插件，它们*几乎*可以满足我的所有需求。对我来说唯一缺少的是自动代码格式化。

我正在处理一些混乱的 PHP 代码，这些代码的缩进和代码格式不一致，理想情况下，我可以突出显示我想要格式化的代码（整个文件也可以）并运行命令来整理它。

有没有人有一个很好的解决方案在 Vim 中工作？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-05-13T13:20:45.080

`shift`在 vim 中修复 PHP 缩进的快速方法是使用-直观地选择要使用的行`v`，然后按等于 ( `=`) 触发自动格式化。

至于其他格式问题，您可能正在考虑使用一些正则表达式搜索和替换，例如`:%s/^M/\r/g`(that's `ctrl`- `V` `ctrl`- `m`, not `caret`- `M`) 来修复行尾

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-11-14T12:01:58.063

vim进入普通模式，然后输入

```
1GVG= 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-07-09T10:46:38.923

# PSR-2 格式的格式

对于新标准[编码风格指南 PSR-2](http://www.php-fig.org/psr/psr-2/)，请使用[PHP-CS-Fixer](https://github.com/FriendsOfPHP/PHP-CS-Fixer)。

有一个 Vim 插件：[Vim-php-cs-fixer](https://github.com/stephpy/vim-php-cs-fixer)

### 如何安装：

安装`PHP-CS-Fixer`（使用 全局安装`Composer`）：

```
composer global require friendsofphp/php-cs-fixer 
```

然后添加 Vim 插件 ( `Pathogen`)：

```
cd ~/.vim/bundle
git clone git@github.com:stephpy/vim-php-cs-fixer.git 
```

重新启动 Vim。

## 默认映射：

```
<leader>pcd " For directory
<leader>pcf " For flie 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-12-06T23:02:32.573

有一个 vim 插件可以在 vim 中对您的代码进行格式化。它被称为 vim-autoformat，你可以在这里阅读并下载它：

[https://github.com/vim-autoformat/vim-autoformat](https://github.com/vim-autoformat/vim-autoformat)

它将外部代码格式化程序集成到 vim 中。安装此插件后，您只需安装外部代码格式化程序即可让所有内容开箱即用。它支持 php 格式化程序**phpCB**，这是迄今为止我见过的最好的 php 格式化程序。

**更新：**由于代码破坏行为，不再支持 phpCB。但是，vim 的 indentfile 始终用作备用，允许您至少在没有可用的格式化程序时缩进您的代码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-13T14:11:19.930

[vim 网站](http://vim.org)不是最容易浏览的，但那里有大量耐嚼的牛轧糖中心。

例如，我在那里找到[了这个 php 缩进脚本](http://www.vim.org/scripts/script.php?script_id=1120)。试试看。

# .net - .NET HTML DOM 解析器？

> ID：857912
> 
> 赞同：15
> 
> 时间：2009-05-13T13:22:09.290
> 
> 标签：.net, html, dom

有人知道免费提供的 .NET HTML DOM 解析器吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-13T13:24:51.393

[Html 敏捷包](http://www.codeplex.com/htmlagilitypack)是您的朋友。它已经过很好的测试（应对标签汤以及格式良好的（X）HTML）。我还听说人们在生产应用程序中使用它没有任何问题。

# java - 为什么我会在文件关闭时关心 IOExceptions？

> ID：857913
> 
> 赞同：13
> 
> 时间：2009-05-13T13:22:17.043
> 
> 标签：java, file, io

我经常在Java代码中看到这种事情......

```
try
{
    fileStream.close();
}
catch (IOException ioe)
{
    /* Ignore. We do not care. */
} 
```

这是合理的，还是傲慢的？

我什么时候会关心关闭文件失败？忽略此异常意味着什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-13T13:26:04.120

我*至少*会记录异常。

如果由于无法刷新数据而导致关闭文件的尝试失败，我已经看到它偶尔会发生。如果您只是吞下异常，那么您已经在不知不觉中丢失了数据。

理想情况下，如果您已经在另一个异常的上下文中（即您在 finally 块中，但由于另一个异常而不是已完成 try 块），您可能应该吞下该异常，但如果您的操作不是，则抛出它成功的。不幸的是，整理起来有点难看:(

但是，是的，您至少应该记录它。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-13T13:25:30.423

您会关心该`close()`方法是否将写入的内容从缓冲区刷新到文件系统，并且会失败。例如，如果您正在写入的文件位于已变得不可用的远程文件系统上。

注意上面的re。刷新适用于任何输出流，而不仅仅是文件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T13:40:42.570

最常见的 close() 问题是磁盘空间不足，或者正如 Brian 提到的，远程流已失效。

笔记：

你真的应该看到类似的东西（注意：我还没有编译检查过）

```
SomeKindOfStream stream = null;
Throwable pending = null;
try {
    stream = ...;
    // do stuff with stream

} catch (ThreadDeath t) {
    // always re-throw thread death immediately
    throw t;

} catch (Throwable t) {
    // keep track of any exception - we don't want an exception on
    //   close() to hide the exceptions we care about!
    pending = t;

} finally {
    if (stream != null)
        try {
            stream.close();
        } catch (IOException e) {
            if (pending == null)
                pending = e;
        }
    }
    if (pending != null) {
        // possibly log - might log in a caller
        throw new SomeWrapperException(pending);
          // where SomeWrapperException is unchecked or declared thrown
    }
} 
```

为什么这一切？

请记住，Java 一次只能跟踪一个“未决”异常。如果主 try 块的主体抛出异常，**并且**finally 中的 close() 抛出异常，那么您唯一知道的就是 close()。

上述结构执行以下操作：

*   跟踪尝试的主体中抛出的任何可投掷物
*   如果该异常是线程死亡，请立即重新抛出它！
*   关闭时，如果我们没有挂起的异常，则跟踪关闭异常；否则应该跟踪先前抛出的异常。（在这种情况下，您可能应该尝试记录 close() 错误）
*   最后，如果有一个未决的异常，处理它。我通常把它包起来再扔。就个人而言，我使用未经检查的包装器，因此我不需要让调用链中的所有调用者都声明 throws。

为此，我通常使用模板方法模式来创建异常管理，然后覆盖作为 try 主体的 doWork() 方法。

# wpf - Surface 中的交互式 3D 对象

> ID：857914
> 
> 赞同：3
> 
> 时间：2009-05-13T13:22:18.107
> 
> 标签：wpf, xaml, 3d, pixelsense

如何在 WPF 中创建交互式 3D 对象？例如，它可以是一个可以旋转的 3D 立方体，并且每一侧都有“点击”手势来触发不同的动作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T20:12:05.753

看看 ViewPort3D 类 - 它有一个可以 3d 旋转的相机。只需连接一个 MouseDown 事件处理程序并修改相机位置。

[http://www.kindohm.com/technical/wpf3dtutorial.htm](http://www.kindohm.com/technical/wpf3dtutorial.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T13:50:01.867

交互式 3D**效果**在 WPF/Surface 中当然是可行的，尽管它需要一些工作。例如，看看[这里的东西](http://drdave.co.uk/blog/post/Surface-Physics-Demo-Part-3.aspx)，尤其是第一张图片 1:50 左右的滚动地球。显示的实现是 Surface，但这主要是具有一些不同输入机制的 WPF……不幸的是，他没有显示代码……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-07T09:35:54.050

看看[codeplex.com/3DTools](http://codeplex.com/3DTools)。把你包`ViewPort3D`进`Interactive3DDecorator`.

# html - 将 div 定位在另一个 div 的底部附近

> ID：857916
> 
> 赞同：102
> 
> 时间：2009-05-13T13:22:46.403
> 
> 标签：html, css, layout

我有外部 div 和内部 div。我需要将内部 div 放在外部的底部。

外部 div 是有弹性的（例如宽度：70%）。我还需要将内部块居中。

描述的化妆的简单模型如下图所示：

![在此处输入图像描述](https://i.stack.imgur.com/CJWr9.png)

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-13T13:35:50.017

在 Firefox 3、Chrome 1 和 IE 6、7 和 8 上测试并运行：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
                      "http://www.w3.org/TR/html4/strict.dtd">
<html><body>
<div style='background-color: yellow; width: 70%;
            height: 100px; position: relative;'>
    Outer
    <div style='background-color: green;
                position: absolute; left: 0; width: 100%; bottom: 0;'>
        <div style='background-color: magenta; width: 100px;
                    height: 30px; margin: 0 auto; text-align: center'>
            Inner
        </div>
    </div>
</div>
</body>
</html> 
```

现场版本：http: [//jsfiddle.net/RichieHindle/CresX/](http://jsfiddle.net/RichieHindle/CresX/)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-13T13:40:42.037

您需要为底部的一个包装 div 以使其居中。

```
<style>
   /* making it look like your nice illustration */
   #outer { width: 300px; height: 200px; background: #f2f2cc; border: 1px solid #c0c0c0; }
   #inner { width: 50px; height: 40px; background: #ff0080; border: 1px solid #800000; }

   /* positioning the boxes correctly */
   #outer { position: relative; }
   #wrapper { position: absolute; bottom: 3px; width: 100%; }
   #inner { margin: 0 auto; }
</style>

<div id="outer">
   <div id="wrapper"><div id="inner"></div></div>
</div> 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-08-15T04:02:11.623

CSS3`Flexbox`让底部定位非常容易。检查[**Flexbox 支持表**](http://caniuse.com/#search=flexbox)

**HTML**

```
<div class="outer">
  <div class="inner">
  </div>
</div> 
```

**CSS**

```
.outer {
  display: flex;
  justify-content: center; /* Center content inside */
}
.inner {
  align-self: flex-end; /* At the bottom of the parent */
} 
```

**输出：**

```
.outer {
  background: #F2F2CD;
  display: flex;
  width: 70%;
  height: 200px;
  border: 2px solid #C2C2C3;
  justify-content: center;
}
.inner {
  background: #FF0081;
  width: 75px;
  height: 50px;
  border: 2px solid #810000;
  align-self: flex-end;
}
```

```
<div class="outer">
  <div class="inner">
  </div>
</div>
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-13T14:21:59.833

适用于所有浏览器，包括 ie6。

```
<style>
    #outer{
        width: 70%;
        background-color: #F2F2CC;
        border: 1px solid #C0C0C0;
        height: 500px;
        position: relative;
        text-align: center;
    }

    #inner{
        background-color: #FF0080;
        border: 1px solid black;
        width: 30px;
        height: 20px;

        /* Position at the bottom */
        position: relative;
        top: 95%;

        /* Center */
        margin: 0 auto;
        text-align: left;
    }
</style>

<div id="outer">
    <div id="inner">
    </div>
</div> 
```

# php - RUBY 和 RAILS 对 PHP 和 CODEIGNITER 的主要优势是什么

> ID：857924
> 
> 赞同：1
> 
> 时间：2009-05-13T13:24:01.940
> 
> 标签：php, jquery, ruby-on-rails, ruby

我们即将开始一个新的 Web2/AJAX 应用程序，并试图确定是否值得花时间和精力学习 Ruby/RubyOnRails 而不是我们目前使用的 PHP、CodeIgnitor 和 JQuery。

关键问题是干净/快速/现代的 AJAX UI、强大的错误处理和可维护性。

我将感谢经验丰富的 PHP 和 RUBY 开发人员的公正（如果那是所有可能的谈话语言/框架）的评论。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T13:33:46.357

关于 Ruby 我不能说太多，但我可以说我经常觉得 PHP 名声不好。PHP 是你做的。是的，那里有很多糟糕的 PHP 代码，但你知道，它主要是由那些会编写糟糕的 Ruby 或糟糕的 Python 的人编写的。PHP 拥有如此广泛的受众，各种能力的程序员都在使用它，其中许多人正在编写糟糕的程序。

也就是说，您可以用 PHP 编写好的程序。你有优秀的开发人员吗？如果是这样，您当然可以用 PHP 编写好的代码。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-13T17:34:09.037

PHP 的名声很糟糕，因为它易于访问。任何人都可以开始编写 PHP，而且现在大多数托管解决方案都提供 PHP，因此有很多非程序员类型的人使用 PHP 编写程序。这些程序缺乏适当的计算机科学学科。

随着 PHP 开始采用现代语言特性，PHP 社区内有一个非常广泛的运动，即朝着可读、格式良好的代码发展。随着 PHP5 的出现，OOP 成为了现实，随之而来的是关于 OOP 最佳实践和开发模式的书籍和材料的爆炸式增长。虽然 PHP 经常用于编写格式错误的、草率的意大利面条式代码，但其语言工具允许开发人员在 MVC、OOP 和 TDD 等开发范式中进行编程。

更不用说，PEAR 极大地提高了社区脚本的质量和可访问性。PHP 最强大的资产是它的社区，而且它一直在变得更强大、更自律。在许多方面，PHP 与 JavaScript 非常相似——它有一个非常草率的开端，开发人员和社区一直试图从中恢复。JavaScript 是一种非常草率的语言，但该语言有一些极其强大的部分，在 Ajax 和交互式 Web 应用程序时代为其带来了当之无愧的尊重。

像 Ruby 和 Python 这样的语言充满了面向计算机程序员的东西。如果您雇用 Python 或 Ruby 程序员，仅仅因为程序员了解这种语言，他们喜欢干净、组织良好的代码的可能性要比 PHP 开发人员高很多倍。这是这些语言文化的一部分，也是传福音的人。

在我看来，Ruby 或 Ruby on Rails 本质上没有什么比这更好的了。Rails 是第一个主流 MVC 开发框架，但它的流行和成功促进了可以想象的每种语言的类似框架的开发。选择用 Ruby 编写 Rails 并不意味着 Ruby 比 PHP 更好，许多人可能会争论。考虑到编写 Rails 的时间以及 37signals 对晦涩的事物的迷恋，我可以完全理解这一举​​动。当时，Web 脚本语言相当蹩脚，37signals 正在寻找一种更能满足应用程序程序员而非脚本编写者需求的语言。

You're not being held back using a PHP framework like Zend Framework, CakePHP, or symfony. CakePHP and symfony are both directly modelled after Rails, even if they aren't direct ports. Akelos is an actual port of Rails to PHP. Zend Framework is the most fully featured framework I've used so far. Don't be afraid to experiment, but jumping ship to a completely different platform isn't necessary and it won't change the way you do business. It's the same business in a different dialect.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-13T15:58:31.720

一门语言最重要的特点是你喜欢使用它的程度。如果您喜欢所使用的语言，您的生活不仅会变得更好，而且您会编写更好的代码并提高工作效率。当然，这完全是主观的；然而，我从未听过任何一流的程序员谈论他们多么喜欢 PHP。

当然，要达到流利程度的语言/框架组合，你真的知道它是否会漂浮你的船需要大量的时间投入。在我看来，即使你最终决定更喜欢不同的工具，你所花的时间也会让你成为一个更好的程序员，所以，去吧！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-13T13:50:22.583

我认为这与语言无关，而与社区中使用的学科有关。如果您是 PHP 开发人员，不对其代码进行单元或功能测试，那么没人会在意。有很多这样的 PHP 开发人员。如果您是 Rails 开发人员并且没有自动测试您的代码，那么您很奇怪，您一定有什么问题。

在我看来，Ruby on Rails 不仅仅是一个框架，而是社区附带的所有工具。建议您使用某种半自动部署工具，例如 Capistrano。如果你不是，你又是奇怪的。等等。

我同意 dicroce 的观点，你可以用两种语言/框架在你的腿上射击。你可以使用 PHP 并尝试使用一些最初用于 Rails 的工具，我相信你会得到很好的结果。

# tcp - 应用程序级别的校验和作为 tcp 校验和可能太弱了？

> ID：857930
> 
> 赞同：4
> 
> 时间：2009-05-13T13:25:58.083
> 
> 标签：tcp, jakarta-ee, network-programming, network-protocols, enterprise

这篇论文（[当 CRC 和 TCP 校验和不一致时](http://portal.acm.org/citation.cfm?doid=347059.347561)）表明，由于 TCP 校验和算法相当弱，使用 TCP 时每 1600 万到 100 亿个数据包就会发生未检测到的错误。

是否有任何应用程序开发人员通过在应用程序级别添加校验和来保护数据免受此类错误的影响？

在执行 EJB 远程方法调用 (Java EE 5) 时，是否有任何模式可用于防止此类错误？或者 Java 是否已经自动校验和序列化对象（除了底层网络协议）？

企业软件已经在计算机上运行，​​不仅执行内存 ECC，而且还在 CPU 内的寄存器等（SPARC 和其他）处进行错误检查。使用 Solaris ZFS 可以防止存储系统（硬盘驱动器、电缆等）的位错误。

因为 TCP，我从不害怕网络误码——直到我看到那篇文章。

为一些非常少的客户端服务器远程接口实现应用程序级校验和可能不是很多工作。但是，在单个数据中心的多台机器上运行的分布式企业软件呢？可能有大量的远程接口。

SAP、甲骨文等企业软件供应商是否都忽略了这类问题？银行呢？股票交易软件呢？

**跟进：**非常感谢您的所有回答！因此，检查未检测到的网络数据损坏似乎非常罕见 - 但它们似乎确实存在。

难道我不能简单地通过将 Java EE 应用程序服务器（或 EJB 部署描述符）配置为使用 RMI over TLS 并将 TLS 配置为使用 MD5 或 SHA1 并通过配置 Java SE 客户端来解决这个问题吗？这是否是一种获得可靠透明校验和的方法（尽管通过矫枉过正），这样我就不必在应用程序级别实现它？还是我完全混淆了网络堆栈？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T13:29:44.990

我曾为 IB 开发过交易系统，我可以向您保证不会进行额外的校验和 - 大多数应用程序都使用裸套接字。鉴于当前金融领域的问题，我认为糟糕的 TCP/IP 校验和应该是您最不担心的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T18:52:29.313

我相信每个关心数据完整性的应用程序都应该使用安全哈希。然而，大多数人没有。人们只是忽略了这个问题。

尽管多年来我经常看到数据损坏——即使是通过校验和得到的数据——实际上最令人难忘的是股票交易系统。一个坏的路由器正在破坏数据，因此它通常可以通过 TCP 校验和。它正在打开和打开相同的位。当然，对于实际上未能通过 TCP 校验和的数据包，没有人会收到警报。该应用程序没有额外的数据完整性检查。

这些消息是股票订单和交易之类的东西。破坏数据的后果与听起来一样严重。

幸运的是，损坏导致消息无效，导致交易系统完全崩溃。一些业务损失的后果远没有执行虚假交易的潜在后果那么严重。

我们很幸运地发现了这个问题——有人在所涉及的两台服务器之间的 SSH 会话失败并出现了一条奇怪的错误消息。显然 SSH 必须保证数据的完整性。

在此事件之后，该公司没有采取任何措施来降低在飞行或存储过程中数据损坏的风险。相同的代码仍在生产中，事实上，其他代码已经投入生产，假设它周围的环境永远不会破坏数据。

这实际上是所有相关人员的正确决定。防止由系统的其他部分（例如内存故障、硬盘控制器故障、路由器故障）引起的问题的开发人员不太可能获得任何收益。额外的代码会产生添加错误或被指责为实际上不相关的错误的风险。如果以后确实出现问题，那将是别人的错。

对于管理来说，这就像花时间在安全上。发生事故的几率很低，但“浪费”的努力是可见的。例如，请注意如何将端到端数据完整性检查与此处的过早优化进行比较。

自从那篇论文发表以来，事情发生了变化——所有变化都是我们拥有更高的数据速率、更复杂的系统以及更快的 CPU，从而降低了加密哈希的成本。腐败的机会更多，预防腐败的成本更低。

真正的问题是在您的环境中检测/预防问题或忽略它们是否更好。请记住，通过检测问题，它可能成为您的责任。如果你花时间防止管理层没有意识到的问题是问题，它会让你看起来像是在浪费时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T20:15:33.773

嗯，那篇论文是 2000 年的，所以它是很久以前的（伙计，我老了），而且痕迹非常有限。因此，对他们的数字持保留态度。也就是说，看看情况是否仍然如此会很有趣。但是，我怀疑事情已经发生了变化，尽管某些类别的错误可能仍然存在，例如硬件故障。

**如果您确实需要**额外的应用程序级保证， 则比校验和更有用的是数据的 SHA-N 哈希或 MD5 等。

# javascript - IE：令人难以置信的跳表标题

> ID：857934
> 
> 赞同：-1
> 
> 时间：2009-05-13T13:27:33.323
> 
> 标签：javascript, html, css, internet-explorer

**免责声明：正如标题中所说，这仅**针对 Internet Explorer 。这是进行内部开发的一个好处——在处理这样的事情时，它让生活变得更轻松。

免责声明 2：我可以在 IE7 和 IE6 中重现此内容。我还没有尝试过 IE8，因为在我们的公司环境中这对我们来说是不可用的。

我的目标是创建一个表格，其中内容滚动，同时保持 THEAD 固定。有很多不同的方法可以做到这一点；你可以在这篇文章的底部看到我的方法。不幸的是，我没有地方公开托管此示例，但您可以将其复制并粘贴到此处进行测试： [http ://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_parse](http://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_parse)

因此，如果您向下滚动表格，并将鼠标悬停在表格中的第一个单元格上，您会看到我正在谈论的现象：标题行向上跳！

这就是有趣的地方。该表由第三方 ASP.NET 控件呈现。所以我不能改变正在发出的 HTML；只有CSS。使用 IE7 开发人员的工具栏，我可以知道，当我将鼠标悬停在控件上时，控件的类正在发生变化（正在添加一个新类）。奇怪的是，工具栏没有*在*标题上显示任何 onmouseover 或 onmouseleave 事件，只是它调用 _events 和 control 的东西，它们都是 [Object]。消息来源也没有透露任何有用的信息。

所以我的目标是只使用 CSS 来防止这个标题行跳转。这甚至可能吗？如果可能的话，是否可以在没有 CSS 表达式的情况下完成（我极力避免这样做）？

这是模拟我所看到的示例 HTML。

粘贴到这里进行测试：[http ://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_parse](http://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_parse)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 过渡//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<头部>
<style type="text/css">
.ScrollContainer
{
    溢出-y：自动！重要；
    溢出-x：隐藏！重要；
    边距：0 自动；
    宽度：100%！重要；
    最大高度：275px；
    边框底部：实心 1px #009DD9;
}

.ScrollContainer .MasterTable
{
    宽度：自动！重要；
}

.ScrollContainer 表
{
    表格布局：固定；    
}

.ScrollContainer .GridHeader
{
    位置：相对；
    顶部：0px；
    边框顶部：实心 1px #009DD9;
    右边框：实心 1px #009DD9;
    边框底部：实心 1px #009DD9;
    左边框：实心 1px #009DD9;
    背景：#cccccc；
}

#Spacer
{
    高度：350px；
}

.GridHeader
{
    高度：30px！重要；
}

</style>
</head>
<正文>
<div id="Spacer"></div>
<div class="ScrollContainer">
<div class="假人">
<div class="网格">
<table class="MasterTable">
<colgroup>
<col/><col/><col/><col/><col/><col/>
</colgroup>
<头><tr>
<th class="GridHeader" onMouseEnter="this.className = this.className + 'GridOver';" onMouseLeave="this.className = this.className.replace('GridOver', '');" ><a href="#" style="GridLink">第 1 列</a></th>
<th class="GridHeader"><a href="#" style="GridLink">第 2 列</a></th>
<th class="GridHeader"><a href="#" style="GridLink">第 3 列</a></th>
<th class="GridHeader"><a href="#" style="GridLink">第 4 列</a></th>
<th class="GridHeader"><a href="#" style="GridLink">第 5 列</a></th>
<th class="GridHeader"><a href="#" style="GridLink">第 6 列</a></th></tr>
</thead>
<tbody>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
<tr><td>A</td><td>B</td><td>X</td><td>D</td><td>E</td><td>F</td ></tr>
</tbody>
</table>
</div>
</div>
</div>
</正文>
</html>
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T15:13:30.857

我了解您的问题指定严格通过 CSS 进行更改。我建议使用 JQuery 解决方案，因为使用 JQuery 可以在文档加载后进行 CSS 更改。

谦虚命名的[Stupid 固定标题](http://jackysee.googlepages.com/fixedheaders.html)是一个 JQuery 插件，它允许垂直和水平滚动。

[Suprotim Agarwal在此处](http://www.dotnetcurry.com/ShowArticle.aspx?ID=255&AspxAutoDetectCookieSupport=1)展示了专门用于 ASP.NET GridView 的 JQuery 方法。

JQuery 也可能允许您有效地修改由 ASP 控件生成的 HTML，因为您可以在 ASP 控件准备好表格后在 JavaScript 中简单地抓取表格并用属性填充它。这取决于时间以及 ASP 控件对外部人员通过 DOM 操作其表的感知程度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T14:30:11.130

您是否尝试过为那些讨厌的元素[提供布局？](http://haslayout.net/haslayout)如果这没有帮助，还有另一个，在背景上放置 1px 透明 gif。

# .net - .net 中的强命名

> ID：857936
> 
> 赞同：10
> 
> 时间：2009-05-13T13:27:40.407
> 
> 标签：.net

什么是强命名以及它在 .Net 中有何用处

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T13:29:12.383

我建议您阅读[强名称程序集可以让您远离 DLL 地狱](http://www.techrepublic.com/article/strong-name-assemblies-can-keep-you-out-of-dll-hell)：

> 强名称程序集允许开发人员简化组件更新并避免臭名昭著的 DLL Hell。深入了解强名称并了解如何使用它们来确保 .NET 应用程序的版本兼容性和安全性。

另请参阅[本文](http://msdn.microsoft.com/en-us/library/xc31ft41(VS.71).aspx)以获取有关如何对程序集进行强命名的快速教程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T13:30:02.743

它还可用于确保程序集不会被篡改，因为它是从原始发布者发布的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T13:35:10.737

我写了一个很长的回复，概述了如何强烈地命名一个程序集来阻止第三方篡改程序集作为对这个[问题](https://stackoverflow.com/questions/798621/do-i-need-to-publish-the-public-key-from-snk-file/802018#802018)的回答。如果您还想知道如何以及为什么，这可能会很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-24T21:58:03.913

我认为避免由于潜在的弱权限引起的DLL 劫持（*或任何你称之为的）问题的重要功能之一。*

假设您的应用程序中的一个 DLL 可以由“每个人”编写，在这种情况下，有人可以修改它，并且当高权限运行 .NET 应用程序时，攻击者可以提升他们的权限。

这很酷，因为在现实世界中，您可以看到这些针对应用程序的攻击，例如反病毒和其他依赖于多个不同位置的多个 DLL 的复杂应用程序。

# c# - 如何获取数据库表的字段名称？

> ID：857942
> 
> 赞同：10
> 
> 时间：2009-05-13T13:27:59.733
> 
> 标签：c#, database, ms-access

如何获取 MS Access 数据库表的字段名称？

是否有我可以使用的 SQL 查询，或者是否有 C# 代码来执行此操作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T16:28:55.887

使用[IDataReader.GetSchemaTable()](http://msdn.microsoft.com/de-de/library/system.data.idatareader.getschematable%28VS.80%29.aspx)

这是一个访问表模式并将其以 XML 格式打印出来的实际示例（只是为了查看您获得的信息）：

```
class AccessTableSchemaTest
{
    public static DbConnection GetConnection()
    {
        return new OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=..\\Test.mdb");
    }

    static void Main(string[] args)
    {
        using (DbConnection conn = GetConnection())
        {
            conn.Open();

            DbCommand command = conn.CreateCommand();
            // (1) we're not interested in any data
            command.CommandText = "select * from Test where 1 = 0";
            command.CommandType = CommandType.Text;

            DbDataReader reader = command.ExecuteReader();
            // (2) get the schema of the result set
            DataTable schemaTable = reader.GetSchemaTable();

            conn.Close();
        }

        PrintSchemaPlain(schemaTable);

        Console.WriteLine(new string('-', 80));

        PrintSchemaAsXml(schemaTable);

        Console.Read();
    }

    private static void PrintSchemaPlain(DataTable schemaTable)
    {
        foreach (DataRow row in schemaTable.Rows)
        {
            Console.WriteLine("{0}, {1}, {2}",
                row.Field<string>("ColumnName"),
                row.Field<Type>("DataType"),
                row.Field<int>("ColumnSize"));
        }
    }

    private static void PrintSchemaAsXml(DataTable schemaTable)
    {
        StringWriter stringWriter = new StringWriter();
        schemaTable.WriteXml(stringWriter);
        Console.WriteLine(stringWriter.ToString());
    }
} 
```

**兴趣点：**

1.  不要通过给出始终评估为 false 的 where 子句来返回任何数据。当然，这只适用于您对数据不感兴趣的情况:-)。
2.  使用 IDataReader.GetSchemaTable() 获取包含有关实际表的详细信息的 DataTable。

**对于我的测试表，输出是：**

```
ID, System.Int32, 4
Field1, System.String, 50
Field2, System.Int32, 4
Field3, System.DateTime, 8
--------------------------------------------------------------------------------
<DocumentElement>
  <SchemaTable>
    <ColumnName>ID</ColumnName>
    <ColumnOrdinal>0</ColumnOrdinal>
    <ColumnSize>4</ColumnSize>
    <NumericPrecision>10</NumericPrecision>
    <NumericScale>255</NumericScale>
    <DataType>System.Int32, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</DataType>
    <ProviderType>3</ProviderType>
    <IsLong>false</IsLong>
    <AllowDBNull>true</AllowDBNull>
    <IsReadOnly>false</IsReadOnly>
    <IsRowVersion>false</IsRowVersion>
    <IsUnique>false</IsUnique>
    <IsKey>false</IsKey>
    <IsAutoIncrement>false</IsAutoIncrement>
  </SchemaTable>
  [...]
</DocumentElement> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-13T13:34:28.430

这将适用于 sql server 2005 及更高版本：

```
select * from INFORMATION_SCHEMA.COLUMNS 
where TABLE_Name='YourTableName'
order by ORDINAL_POSITION 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-13T15:02:24.977

运行此查询：

```
select top 1 *
From foo 
```

然后遍历结果集中的列表字段（和返回值）以获取字段名称。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-13T13:32:29.617

您是否在问如何获取数据库中表的列名？

如果是这样，它完全取决于您使用的数据库服务器。

在 SQL 2005 中，您可以从 INFORMATION_SCHEMA.Columns 视图中进行选择

```
SELECT *
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'MyTable' 
```

在 SQL 2000 中，您可以将 SysObjects 加入 SysColumns 以获取信息

```
SELECT     
    dbo.sysobjects.name As TableName
    , dbo.syscolumns.name AS FieldName
FROM
    dbo.sysobjects 
    INNER JOIN dbo.syscolumns 
         ON dbo.sysobjects.id = dbo.syscolumns.id
WHERE
    dbo.sysobjects.name = 'MyTable' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T19:50:45.210

使用 DAO 自动化类。你的 Visual Studio 安装中可能已经有一个互操作库。如果没有，创建一个很容易；只需添加对 DAO COM 库的引用。

```
using dao;
...
DBEngineClass dbengine = new DBEngineClass();
dbengine.OpenDatabase(path, null, null, null);
Database database = dbengine.Workspaces[0].Databases[0];
List<string> fieldnames = new List<string>();
TableDef tdf = database.TableDefs[tableName];
for (int i = 0; i < tdf.Fields.Count; i++)
{
    fieldnames.Add(tdf.Fields[i].Name);
}
database.Close();
dbengine.Workspaces[0].Close(); 
```

这就像查询系统表（我发现在 Access 中存在问题）一样简单，并且您可以通过这种方式获得很多附加信息。

**编辑：** 我已经修改了我昨天发布的代码，我刚刚从 VB.NET 翻译了这些代码，并且缺少了几部分。我在 VS2008 中用 C# 重写并测试了它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-05-08T19:42:00.607

此代码会将表的所有列名打印为具有`getter`所有列名属性的类，然后可以在`c#`代码中使用

```
 declare @TableName sysname = '<EnterTableName>'
    declare @Result varchar(max) = 'public class ' + @TableName + '
    {'

    select @Result = @Result + '
        public static string ' + ColumnName + ' { get { return "'+ColumnName+'"; } }
    '
    from
    (
        select
            replace(col.name, ' ', '_') ColumnName,
            column_id ColumnId
        from sys.columns col
            join sys.types typ on
                col.system_type_id = typ.system_type_id AND col.user_type_id = typ.user_type_id
        where object_id = object_id(@TableName)
    ) t
    order by ColumnId

    set @Result = @Result  + '
    }'

    print @Result 
```

**输出：**

```
 public class tblPracticeTestSections
 {
   public static string column1 { get { return "column1"; } }

   public static string column2{ get { return "column2"; } }

   public static string column3{ get { return "column3"; } }

   public static string column4{ get { return "column4"; } }

 } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T13:31:39.243

根据您使用的数据库引擎，您可以轻松地查询数据库系统表以获取该信息

对于访问，我找不到答案，我知道您[可以在访问中看到 sys 表](http://www.techonthenet.com/access/database/view_systables.php)，从那里您可以尝试确定该信息的位置，但我不确定如何执行此部分。尝试使用示例但无处可去

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-11-01T18:11:15.087

对于 c# 中的 microsoft SQL，您可以执行以下操作：

```
Dictionary<string, int> map = 
(from DataRow row in Schema.Rows
 let columnName = (string)row["ColumnName"]
  select columnName)
 .Distinct(StringComparer.InvariantCulture)
 .Select((columnName, index) => new { Key = columnName, Value = index })
 .ToDictionary(pair => pair.Key, pair => pair.Value); 
```

因此在其索引中创建了一个列名映射，可以按如下方式使用：

```
internal sealed class ColumnToIndexMap
{
    private const string NameOfColumn = "ColumnName";
    private DataTable Schema { get; set; }
    private Dictionary<string, int> Map { get; set; }

    public ColumnToIndexMap(DataTable schema)
    {
        if (schema == null) throw new ArgumentNullException("schema");
        Schema = schema;

        Map = (from DataRow row in Schema.Rows
               let columnName = (string)row[NameOfColumn]
               select columnName)
              .Distinct(StringComparer.InvariantCulture)
              .Select((columnName, index) => new { Key = columnName, Value = index })
              .ToDictionary(pair => pair.Key, pair => pair.Value);
    }

    int this[string name]
    {
        get { return Map[name]; }
    }

    string this[int index]
    {
        get { return Schema.Rows[index][NameOfColumn].ToString(); }
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-01T20:07:48.327

我对 OleDb.Connection 的 GetSchema 属性很满意：

提供列数据的类。这将返回数据库中的所有列。然后可以通过列名过滤生成的 DataTable，这些列名（大部分）对应于标准 INFORMATION_SCHEMA（MS Access 不为我们提供）中的那些：

```
 class JetMetaData
    {
        /// <summary>
        /// Returns a datatable containing MetaData for all user-columns
        /// in the current JET Database. 
        /// </summary>
        /// <returns></returns>
        public static DataTable AllColumns(String ConnectionString)
        {
            DataTable dt;

            using (OleDbConnection cn = new OleDbConnection(ConnectionString))
            {
                cn.Open();
                dt = cn.GetSchema("Columns");
                cn.Close();
            }
            return dt;
        }

    } 
```

然后，在一个相当粗略且不那么优雅的示例中使用该类，并在 TABLE_NAME 上进行过滤：

```
 private void Form1_Load(object sender, EventArgs e)
    {
        DataTable dt = JetMetaData.AllColumns("", Properties.Settings.Default.JetConnection);
        String RowFilter = "TABLE_NAME = 'YourTableName'";
        DataView drv = dt.DefaultView;
        drv.RowFilter = RowFilter;

        DataGridView dgv = this.dataGridView1;

        dgv.DataSource = drv;

    } 
```

请注意，我并没有假装这都是完美的代码。这只是一个例子。但是我在很多场合都使用过这样的东西，实际上甚至创建了一个应用程序来使用类似的方法编写整个 MS Access 数据库（约束和所有）。

虽然我在这个线程中看到其他人提到了 get Schema，但似乎有些实现过于复杂。. .

希望有帮助！

# assembly - x86 汇编编码中的宏

> ID：857951
> 
> 赞同：3
> 
> 时间：2009-05-13T13:29:25.940
> 
> 标签：assembly, macros, x86

有人可以解释如何在 x86 汇编编码中使用宏吗

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T13:35:54.277

这取决于您使用的编译器。

通常，汇编器宏将采用以下形式；

```
begin MyMacro %1, %2
   mov eax, %1
   add eax, %2
end 
```

这将存在于源代码的标题部分中，除非被引用，否则不会输出任何代码。您可以将其与其他汇编器内联。

```
mov ecx, 88
MyMacro ecx, 12
asr ecx, 3 
```

在这种情况下，“参数”%1 和 %2 将替换为 ecx 和 12，生成以下输出

```
mov ecx, 88
mov eax, ecx
add eax, 12
asr ecx, 3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T13:37:25.397

这是一个非常广泛的问题。有无数种使用宏的方法。一些汇编语言开发人员大量使用它们，有些人讨厌它们。

最常见的方法之一是将宏用于函数序言和尾声。另一种是使用它们来获取堆栈上的保存参数。

# java - 设计应用程序和GUI之间的界面

> ID：857959
> 
> 赞同：4
> 
> 时间：2009-05-13T13:30:53.600
> 
> 标签：java

对于家庭作业，我需要构建一个小型 java 应用程序。主要目标是学习如何与 XML 交互。但第二个目标是学习如何构建这样的应用程序。

我在编程方面有相当多的经验，但在设计程序方面经验很少。我读过设计模式和设计原则，如 Solid 和 TDD。但我发现很难知道如何实施这些想法。

我遇到的一个问题是 GUI 和应用程序之间的隔离。在应用程序上，我们希望能够根据不同的标准进行排序。对于每个标准，都会有一个按钮（如列表的标题）。这将导致触发事件。但是我应该如何传递应该排序的标准，以及如何发回排序的数据？

可以为每个按钮定义一个不同的事件，但是您将有几个类似的事件，唯一的目标是区分排序标准。

另一种方法是定义一个事件，然后传递一个字符串或整数，这将指定应按什么标准排序，但随后您将获得 if else 语句的列表，并且不遵守开放封闭原则。

你将如何设计这样一个系统。

**编辑：**

我在这里最大的担忧是试图让这个*'open-closed'*。正如有人问的那样，数据是对象的集合。有什么方法可以很容易地添加标准进行排序？或者这不是真的可行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T13:33:38.867

如果我很好理解您的问题，您需要单独的 GUI 和应用程序逻辑。

查看 MVC 模式。 [http://en.wikipedia.org/wiki/MVC](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)

也许对你更好的是 MVP 模式 [http://en.wikipedia.org/wiki/Model_View_Presenter](http://en.wikipedia.org/wiki/Model_View_Presenter)

如果您有 MVC 模式的经验，请查看一些用于桌面应用程序的 Java MVC 框架（主要用于 Web）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-13T13:37:56.613

听起来确实有点像您的数据将显示在表格中，如果您使用的是 Swing，JTable 现在支持排序。查看来自 Sun 的 Swing trail 中的[JTable 教程。](http://java.sun.com/docs/books/tutorial/uiswing/components/table.html#sorting)

我会说作为一个通用解决方案，您可能会将标准作为参数传递给任何排序。

另一个建议是不要太担心模式，只要保持你的设计简单和代码可读，你就可以适应小型应用程序。有时很容易陷入所有漂亮的模式中，然后尝试将它们挤进您的应用程序中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T13:37:25.880

您可能还想查看[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)。

实际实现见[这篇](http://java-x.blogspot.com/2007/01/implementing-observer-pattern-in-java.html)文章。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T13:38:04.383

很高兴看到您正在考虑这个问题，这比不幸比例的开发人员所能说的要多。

您当然应该研究诸如 MVC 之类的设计模式。我个人最喜欢的是 MVVM 模式。如果你google它，你通常会发现它链接到WPF应用程序，但它没有理由不能应用于更广泛的平台（它毕竟只是一种设计模式）。我更喜欢将“视图”视为外部接口而不是 GUI。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T13:45:46.477

最好的方法是有“一个事件，然后传递一个字符串或整数”。

根据您使用的底层数据结构，您不需要使用 switch 语句来对数据进行排序。如果您有一个数据表，您可以使用字符串来指定要排序的列。如果你有一个对象集合并且列代表它们的属性，那就更棘手了。在 .Net 中，您可以使用 LINQ 做一些简洁的事情，让您按字符串表示的属性进行排序。但是在 java 中，您总是可以诉诸反射来获取要排序的字段值。

如果您将数据表示为传递 int 的多维数组，则表示要排序的数组的属性-y 索引。在任何情况下，总有一种技术可以避免使用 switch 语句进行排序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-13T13:37:52.510

好吧，如果你传递了一个 int，它对应于你想要排序的列号，你就不需要 case 语句（或一堆“if”语句），你可以只索引那个列。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T13:38:44.570

将 GUI 的呈现与 GUI 的逻辑分开。然后你可以使用 TDD 创建逻辑层，而表现层将只是逻辑层和 GUI 框架之间的简单胶水代码。

按照此页面上的链接了解更多信息：[http ://martinfowler.com/eaaDev/ModelViewPresenter.html](http://martinfowler.com/eaaDev/ModelViewPresenter.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T14:09:46.657

查看[GlazedLists](http://www.publicobject.com/glazedlists/)进行过滤/排序/等。列表上的操作，以及用于在 YAML 文件中声明 GUI 元素的简单方法的[JavaBuilder](http://code.google.com/p/javabuilders/)。（第一个几乎是必须的，第二个是方便）

我过去常常避开 GUI 开发，因为它要么很痛苦，要么我需要使用一些拙劣的图形工具来设计以我不理解的方式工作的 GUI。但是上面的工具包使用起来非常简单，让我把精力集中在我的程序实际在做什么而不是如何显示它上。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-06T19:21:08.233

“可以为每个按钮定义一个不同的事件，但是你会有几个类似的事件，唯一的目标是区分排序标准。”

我实际上会使用命令模式，使用它一个对象（通常称为动作）将封装调用方法所需的所有信息（动作接收者）。

类似于以下内容：

```
public enum CommandType{ 
    SORT_BY_CRITERIA_1, 
    SORT_BY_CRITERIA_2, 
    SORT_BY_CRITERIA_3; 
}

public interface Command{
     public CommandType getCommandType();
     // Any other information you need to pass to the receiver
}

public class CriteriaOneCommand implements Command{
       private final CommandType commandType;

       public CriteriaOneCommand(){
           commandType = SORT_BY_CRITERIA_1;
       }

       public CommandType getCommandType(){
           return commandType;
       }
} 
```

## 接收者

```
public void action(Command command){
       CommandType type = command.getCommandType();

       // If type is criteria 1, sort using that criteria
       // If type is criteria 2, sort using that criteria
} 
```

即使您决定使用一个事件，也倾向于使用枚举而不是使用 int/String 来区分不同类型的事件。

# c++ - Qt QImage 像素操作问题

> ID：857962
> 
> 赞同：3
> 
> 时间：2009-05-13T13:32:33.190
> 
> 标签：c++, qt, bit-manipulation, steganography, qimage

我目前正在使用 Qt 编写隐写术应用程序。我试图将我的消息位隐藏在像素蓝色的最低有效位中。

从调试中我可以看出这部分工作正常。但是，在将我的位隐藏在消息中之后，我保存图像然后重新打开它。这就是问题发展的地方。

当我在（重新打开的）图像`scanLines`中阅读时，我阅读的内容与我之前写的不同，我不知道为什么。也许只是我愚蠢，或者我错过了一些东西。任何帮助将非常感激。

我到目前为止的代码如下

```
void MainWindow::Encrypt(QImage image, QString message) {
    if(image.isNull()) {
        qDebug() << "PROBLEM";
    }

    image = image.convertToFormat(QImage::Format_ARGB32);

    QVector<bool> bvec;
    QByteArray bytes = message.toAscii();
    char mask;
    QRgb tempPix;

    for(int i = 0; i < bytes.size(); i++) {
        for(int j = 0; j < 8; j++) {
            mask = (0x01 << j);
            bvec.push_back((bytes[i] & mask) == mask);
        }
    }

    if(image.height() < bvec.size()) {
        qDebug() << "Not enough space in image";
    }

    for(int j = 0; j < bvec.size(); j++) {
        QRgb *pixel = (QRgb *)image.scanLine(j);
        tempPix = *pixel;
        int blue = qBlue(tempPix);

        blue &= 0xFE;
        blue |= (bvec[j] == 1) ? 0x01 : 0x00;
        *pixel = qRgba(qRed(tempPix), qGreen(tempPix), blue, qAlpha(tempPix));
    }

    if(image.save(filename) != true) {
       emit addToStatusLog("Did not save. Error");
    }   
}

void MainWindow::Decrypt(QImage image) {
    char temp = 0x00;
    qint8 mask = 0x01;
    QVector<bool> bvec;
    QRgb *pixel;
    int blue;

    image = image.convertToFormat(QImage::Format_ARGB32);

    for(int i = 0; i < image.height(); i++) {
        pixel = (QRgb *)image.scanLine(i);
        blue = qBlue(*pixel);
        bvec.push_back((blue & mask) == mask);
    }

     for(int j = 0; j < bvec.size(); j++) {
        if(j % 8 == 0 && j != 0) {
            qDebug() << temp;
            temp = 0x00;
        }
        temp |= (bvec[j]) ? (0x01 << (j%8)) : 0x00;
    }

    qDebug() << temp;
} 
```

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-13T13:42:18.633

确保您没有使用有损格式（例如 JPEG）进行保存。

# c# - 是否可以从远程应用程序 StatusBarWndClass 获取单元格文本？

> ID：857964
> 
> 赞同：0
> 
> 时间：2009-05-13T13:33:36.433
> 
> 标签：c#, vb6, screen-scraping

我有一个旧版 vb 应用程序，它的状态栏中有我想用来驱动 .NET 应用程序的数据。

我使用 spy++ 深入了解了窗口结构，并成功使用 FindWindow 和 FindWindowEx 来获取 StatusBarWndClass 的句柄。现在我正在努力访问状态栏中的实际数据。我尝试使用 WM_GETTEXT 消息但没有成功。

1.  是否可以从远程 StatusBarWndClass 获取单元格信息？
2.  如果可能的话，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-31T13:45:52.107

尝试 SB_GETTEXT 消息。[http://msdn.microsoft.com/en-us/library/bb760749(VS.85).asp](http://msdn.microsoft.com/en-us/library/bb760749(VS.85).aspx)

# .net - Linq to Entities - SQL“IN”子句

> ID：857973
> 
> 赞同：248
> 
> 时间：2009-05-13T13:35:05.527
> 
> 标签：.net, linq, linq-to-entities, in-clause

在 T-SQL 中，您可以进行如下查询：

```
SELECT * FROM Users WHERE User_Rights IN ("Admin", "User", "Limited") 
```

您将如何在 LINQ to Entities 查询中复制它？甚至可能吗？

* * *

## 回答 #1

> 赞同：373
> 
> 时间：2009-05-13T13:37:37.050

你需要从你思考它的方式来改变它。不是在预定义的一组适用用户权限中查找当前项目的用户权限，而是询问一组预定义的用户权限是否包含当前项目的适用值。这与在 .NET 的常规列表中查找项目的方式完全相同。

使用 LINQ 有两种方法，一种使用查询语法，另一种使用方法语法。本质上，它们是相同的，可以根据您的喜好互换使用：

***查询语法：***

```
var selected = from u in users
               where new[] { "Admin", "User", "Limited" }.Contains(u.User_Rights)
               select u

foreach(user u in selected)
{
    //Do your stuff on each selected user;
} 
```

***方法语法：***

```
var selected = users.Where(u => new[] { "Admin", "User", "Limited" }.Contains(u.User_Rights));

foreach(user u in selected)
{
    //Do stuff on each selected user;
} 
```

在这种情况下，我个人的偏好可能是方法语法，因为我可以像这样通过匿名调用执行 foreach，而不是分配变量：

```
foreach(User u in users.Where(u => new [] { "Admin", "User", "Limited" }.Contains(u.User_Rights)))
{
    //Do stuff on each selected user;
} 
```

从语法上看，这看起来更复杂，您必须了解 lambda 表达式或委托的概念才能真正弄清楚发生了什么，但正如您所见，这会相当多地压缩代码。

这一切都取决于你的编码风格和偏好——我的三个例子都在做同样的事情，但略有不同。

另一种方法甚至不使用 LINQ，您可以使用相同的方法语法将“where”替换为“FindAll”并获得相同的结果，这也适用于 .NET 2.0：

```
foreach(User u in users.FindAll(u => new [] { "Admin", "User", "Limited" }.Contains(u.User_Rights)))
{
    //Do stuff on each selected user;
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-04-27T13:50:48.563

这应该足以满足您的目的。它比较两个集合并检查一个集合的值是否与另一个集合中的值匹配

```
fea_Features.Where(s => selectedFeatures.Contains(s.feaId)) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-04-03T13:08:46.913

在这种情况下，我会选择 Inner Join。如果我使用包含，它会迭代 6 次，尽管事实上只有一个匹配项。

```
var desiredNames = new[] { "Pankaj", "Garg" }; 

var people = new[]  
{  
    new { FirstName="Pankaj", Surname="Garg" },  
    new { FirstName="Marc", Surname="Gravell" },  
    new { FirstName="Jeff", Surname="Atwood" }  
}; 

var records = (from p in people join filtered in desiredNames on p.FirstName equals filtered  select p.FirstName).ToList(); 
```

## 包含的缺点

假设我有两个列表对象。

```
List 1      List 2
  1           12
  2            7
  3            8
  4           98
  5            9
  6           10
  7            6 
```

使用包含，它将搜索列表 2 中的每个列表 1 项目，这意味着迭代将发生 49 次！！！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-08-05T10:10:48.900

这可能是您可以直接使用 LINQ 扩展方法检查 in 子句的可能方式

```
var result = _db.Companies.Where(c => _db.CurrentSessionVariableDetails.Select(s => s.CompanyId).Contains(c.Id)).ToList(); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-07-10T08:34:08.170

我还尝试使用类似 SQL-IN 的东西 - 查询**Entity Data Model**。我的方法是一个字符串构建器来组成一个大的 OR 表达式。这太难看了，但恐怕这是现在唯一的办法。

现在好了，看起来像这样：

```
Queue<Guid> productIds = new Queue<Guid>(Products.Select(p => p.Key));
if(productIds.Count > 0)
{
    StringBuilder sb = new StringBuilder();
    sb.AppendFormat("{0}.ProductId = Guid\'{1}\'", entities.Products.Name, productIds.Dequeue());
    while(productIds.Count > 0)
    {
        sb.AppendFormat(" OR {0}.ProductId = Guid\'{1}\'",
          entities.Products.Name, productIds.Dequeue());
    }
} 
```

**在这种情况下使用 GUID**：正如您在上面看到的，在查询字符串片段中的 GUID ifself 之前总是有单词“GUID”。如果您不添加此内容，则会`ObjectQuery<T>.Where`引发以下异常：

> 参数类型“Edm.Guid”和“Edm.String”与此操作不兼容。接近等于表达式，第 6 行，第 14 列。

在 MSDN 论坛中找到了这个，可能会有所帮助。

马蒂亚斯

... 期待 .NET 和 Entity Framework 的下一个版本，届时一切都会变得更好。:)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-08-08T13:32:32.593

BenAlabaster 答案的另一种方法

首先，您可以像这样重写查询：

```
var matches = from Users in people
        where Users.User_Rights == "Admin" ||
              Users.User_Rights == "Users" || 
              Users.User_Rights == "Limited"
        select Users; 
```

当然，这更“罗嗦”并且写起来很痛苦，但它的工作原理都是一样的。

因此，如果我们有一些实用方法可以很容易地创建这些类型的 LINQ 表达式，我们就会做生意。

使用实用方法，您可以编写如下内容：

```
var matches = ctx.People.Where(
        BuildOrExpression<People, string>(
           p => p.User_Rights, names
        )
); 
```

这将构建一个具有与以下效果相同的表达式：

```
var matches = from p in ctx.People
        where names.Contains(p.User_Rights)
        select p; 
```

但更重要的是，它实际上适用于 .NET 3.5 SP1。

这是使这成为可能的管道功能：

```
public static Expression<Func<TElement, bool>> BuildOrExpression<TElement, TValue>(
        Expression<Func<TElement, TValue>> valueSelector, 
        IEnumerable<TValue> values
    )
{     
    if (null == valueSelector) 
        throw new ArgumentNullException("valueSelector");

    if (null == values)
        throw new ArgumentNullException("values");  

    ParameterExpression p = valueSelector.Parameters.Single();

    if (!values.Any())   
        return e => false;

    var equals = values.Select(value =>
        (Expression)Expression.Equal(
             valueSelector.Body,
             Expression.Constant(
                 value,
                 typeof(TValue)
             )
        )
    );
   var body = equals.Aggregate<Expression>(
            (accumulate, equal) => Expression.Or(accumulate, equal)
    ); 

   return Expression.Lambda<Func<TElement, bool>>(body, p);
} 
```

我不打算解释这个方法，只是说它本质上使用 valueSelector（即 p => p.User_Rights）为所有值构建了一个谓词表达式，并将这些谓词 OR 在一起以创建一个完整的表达式谓词

资料来源：http: [//blogs.msdn.com/b/alexj/archive/2009/03/26/tip-8-writing-where-in-style-queries-using-linq-to-entities.aspx](http://blogs.msdn.com/b/alexj/archive/2009/03/26/tip-8-writing-where-in-style-queries-using-linq-to-entities.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-05-03T00:53:04.833

真实例子：

```
var trackList = Model.TrackingHistory.GroupBy(x => x.ShipmentStatusId).Select(x => x.Last()).Reverse();
List<int> done_step1 = new List<int>() {2,3,4,5,6,7,8,9,10,11,14,18,21,22,23,24,25,26 };
bool isExists = trackList.Where(x => done_step1.Contains(x.ShipmentStatusId.Value)).FirstOrDefault() != null; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-05T16:13:49.263

这不完全是 IN 运算符，但它可能会帮助您获得预期的结果，并且可能是一种更通用的方法（因为它允许比较两个集合）：[INTERSECT](https://sql.sh/cours/intersect)

这是一个工作示例

```
var selected = 
  users.Where(u => 
    new[] { "Admin", "User", "Limited" }.Intersect(new[] {u.User_Rights}).Any()
  );
OR
var selected = 
  users.Where(u => 
    new[] {u.User_Rights}.Intersect(new[] { "Admin", "User", "Limited" }).Any()
  ); 
```

我想应该对性能进行基准测试（针对当前接受的答案）以完全验证这个解决方案......

## 编辑 ：

正如 Gert Arnold 要求的示例（EF 6）：这段代码为我提供了名字和/或姓氏与“John”或“Doe”匹配的任何用户：

```
// GET: webUsers
public async Task<ActionResult> Index()
{
  var searchedNames = new[] { "John", "Doe" };

  return 
    View(
      await db
        .webUsers
        .Where(u => new[] { u.firstName, u.lastName }.Intersect(searchedNames).Any())
        .ToListAsync()
    );

  //return View(await db.webUsers.ToListAsync());
} 
```

* * *

## 回答 #9

> 赞同：-15
> 
> 时间：2012-01-31T03:13:04.933

严重地？你们从来没用过

```
where (t.MyTableId == 1 || t.MyTableId == 2 || t.MyTableId == 3) 
```

# c# - 如何构建一个同时接受对象和原语的通用 C# 数组内容打印机？

> ID：857976
> 
> 赞同：0
> 
> 时间：2009-05-13T13:35:54.183
> 
> 标签：c#, .net, arrays, tostring

我只是想通过打印出 int 和 string 数组的内容来快速调试 web 服务。有没有办法用一种方法做到这一点？

我试过

```
public static string ArrayToString(object[] array)
{
    StringBuilder sb = new StringBuilder();

    foreach (Object item in array)
    {
        sb.Append(item.ToString());
        sb.Append(" ");
    }

    return sb.ToString();
} 
```

但是当我尝试向它发送一个原始数组（int []）时，这会窒息，因为它不是一个对象。

我觉得很奇怪，因为将 int 发送到下面的方法有效

```
static void PrintObject(object obj)
{
    Console.WriteLine(obj.ToString());
} 
```

有没有办法用一种方法做到这一点，还是我只需要手动创建两个单独的方法？

* * *

当然，我是否应该使用数组是有问题的，但是 Web 服务已经到位。

**也可以看看：**

*   [在 .NET 中何时在 Generic.Lists 上使用 Array()](https://stackoverflow.com/questions/413174/when-to-use-a-array-over-generic-lists-in-net)
*   [被认为有些有害的数组](http://blogs.msdn.com/ericlippert/archive/2008/09/22/arrays-considered-somewhat-harmful.aspx)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T13:40:25.453

尝试这样的事情：

```
static String toString<T>(IEnumerable<T> list)
{
    StringBuilder sb = new StringBuilder();

    foreach (T item in list)
    {
        sb.Append(item.ToString());
        sb.Append(" ");
    }

    return sb.ToString();
} 
```

`T`编译器会很高兴地通过您传入的列表的类型来推断类型，如下所示：

```
toString(new int[] { 1, 2, 3 });
toString(new String[] { "1", "2", "3" }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T13:43:38.523

```
public static string ArrayToString<T>(T[] array)
{
   StringBuilder sb = new StringBuilder();

    foreach (T item in array)
    {
        sb.Append(item.ToString());
        sb.Append(" ");
    }

    return sb.ToString();
} 
```

然后

```
int[] x = new int[] { 1, 2, 3 };

string[] y = new string[] { "a", "b", "c" };

Console.WriteLine(ArrayToString(x));
Console.WriteLine(ArrayToString(y)); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-13T13:42:48.133

为什么选择阵列？您的代码不依赖于数组的任何特定属性，而只是看到一个对象列表。似乎 IEnumerable 将是一个更好的选择，并且几乎允许任何对象集合

```
public static string ArrayToString(IEnumerable source)
{
    StringBuilder sb = new StringBuilder();

    foreach (Object item in source)
    {
        sb.Append(item.ToString());
        sb.Append(" ");
    }

    return sb.ToString();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T13:37:43.540

```
private string PrintObjects<T>(IEnumerable<T> objs)
{
    return string.Join(" ", objs.Select(o => o.ToString()).ToArray());
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-13T13:46:34.650

有几种方法可以做到这一点。

如果你有 Linq，你可以做

```
int[] foo = new int[] {1,2,3,4};
ArrayToString(foo.Cast<Object>().ToArray()); 
```

然后发送。

或者，您可以制作一个通用的扩展方法

```
public static string ToString<T>(this IEnumerable<T> val)
{
    StringBuilder sb = new StringBuilder();
    foreach(var item in val) 
    {
       sb.Append(item.ToString());
       sb.Append(" ");
    }
    return sb.ToString();
} 
```

# c# - 请批评我的课

> ID：857979
> 
> 赞同：2
> 
> 时间：2009-05-13T13:37:10.560
> 
> 标签：c#, .net, class, gedcom

很久以前我上过几节学校的课，老实说，我从来没有真正理解过课堂的概念。我最近“重新上马”，一直在尝试寻找一些真实世界的应用程序来创建一个类。

您可能已经看到我正在尝试解析大量的家谱数据，这些数据采用非常古老且过时的格式，称为 gedcom

我创建了一个 Gedcom Reader 类来读取文件，对其进行处理并将其作为两个列表提供，其中包含我认为需要使用的数据

对我来说更重要的是我创建了一个类来做到这一点，所以我非常想让这里的专家告诉我我做对了什么以及我可以做得更好（我不会说错，因为这件事有效而且已经足够好了为了我）

班级：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.IO;

namespace GedcomReader
{

    class Gedcom
    {
        private string GedcomText = "";

        public struct INDI
        {
            public string ID;
            public string Name;
            public string Sex;
            public string BDay;
            public bool Dead;
        }
        public struct FAM
        {
            public string FamID;
            public string Type;
            public string IndiID;
        }

        public List<INDI> Individuals = new List<INDI>();
        public List<FAM> Families = new List<FAM>();

        public Gedcom(string fileName)
        {
            using (StreamReader SR = new StreamReader(fileName))
            {
                GedcomText = SR.ReadToEnd();
            }
            ReadGedcom();

        }

        private void ReadGedcom()
        {
            string[] Nodes = GedcomText.Replace("0 @", "\u0646").Split('\u0646');
            foreach (string Node in Nodes)
            {
                string[] SubNode = Node.Replace("\r\n", "\r").Split('\r');
                if (SubNode[0].Contains("INDI"))
                {
                    Individuals.Add(ExtractINDI(SubNode));

                }
                else if (SubNode[0].Contains("FAM"))
                {
                    Families.Add(ExtractFAM(SubNode));
                }
            }
        }

        private FAM ExtractFAM(string[] Node)
        {
            string sFID = Node[0].Replace("@ FAM", "");
            string sID = "";
            string sType = "";
            foreach (string Line in Node)
            {
                // If node is HUSB
                if (Line.Contains("1 HUSB "))
                {
                    sType = "PAR";
                    sID = Line.Replace("1 HUSB ", "").Replace("@", "").Trim();
                }
                //If node for Wife
                else if (Line.Contains("1 WIFE "))
                {
                    sType = "PAR";
                    sID = Line.Replace("1 WIFE ", "").Replace("@", "").Trim();
                }
                //if node for multi children
                else if (Line.Contains("1 CHIL "))
                {
                    sType = "CHIL";
                    sID = Line.Replace("1 CHIL ", "").Replace("@", "");
                }
            }
            FAM Fam = new FAM();
            Fam.FamID = sFID;
            Fam.Type = sType;
            Fam.IndiID = sID;

            return Fam;
        }
        private INDI ExtractINDI(string[] Node)
        {

            //If a individual is found
            INDI I = new INDI();
            if (Node[0].Contains("INDI"))
            {
                //Create new Structure

                //Add the ID number and remove extra formating
                I.ID = Node[0].Replace("@", "").Replace(" INDI", "").Trim();
                //Find the name remove extra formating for last name
                I.Name = Node[FindIndexinArray(Node, "NAME")].Replace("1 NAME", "").Replace("/", "").Trim();
                //Find Sex and remove extra formating
                I.Sex = Node[FindIndexinArray(Node, "SEX")].Replace("1 SEX ", "").Trim();

                //Deterine if there is a brithday -1 means no
                if (FindIndexinArray(Node, "1 BIRT ") != -1)
                {
                    // add birthday to Struct 
                    I.BDay = Node[FindIndexinArray(Node, "1 BIRT ") + 1].Replace("2 DATE ", "").Trim();
                }

                // deterimin if there is a death tag will return -1 if not found
                if (FindIndexinArray(Node, "1 DEAT ") != -1)
                {
                    //convert Y or N to true or false ( defaults to False so no need to change unless Y is found.
                    if (Node[FindIndexinArray(Node, "1 DEAT ")].Replace("1 DEAT ", "").Trim() == "Y")
                    {
                        //set death
                        I.Dead = true;
                    }
                }

            }
            return I;
        }
        private int FindIndexinArray(string[] Arr, string search)
        {
            int Val = -1;
            for (int i = 0; i < Arr.Length; i++)
            {
                if (Arr[i].Contains(search))
                {
                    Val = i;
                }
            }
            return Val;
        }
    }
} 
```

执行：

```
using System;
using System.Windows.Forms;
using GedcomReader;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            string path = @"C:\mostrecent.ged";
            string outpath = @"C:\gedcom.txt";
            Gedcom GD = new Gedcom(path);

            GraphvizWriter GVW = new GraphvizWriter("Family Tree");
            foreach(Gedcom.INDI I in GD.Individuals)
            {
                string color = "pink";
                if (I.Sex == "M")
                {
                    color = "blue";
                }
                GVW.ListNode(I.ID, I.Name, "filled", color, "circle");

                if (I.ID == "ind23800")
                {MessageBox.Show("stop");}
                //"ind23800" [ label="Sarah Mandley",shape="circle",style="filled",color="pink" ];
            }
            foreach (Gedcom.FAM F in GD.Families)
            {

                if (F.Type == "par")
                {
                    GVW.ConnNode(F.FamID, F.IndiID);
                }
                else if (F.Type =="chil")
                {
                    GVW.ConnNode(F.IndiID, F.FamID);
                }
            }
           string x =  GVW.SB.ToString();
            GVW.SaveFile(outpath);
            MessageBox.Show("done");
        }
    } 
```

我特别感兴趣的是是否可以对我不知道我如何在实现中使用它们的结构做任何事情是最好的，但它再次起作用

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T13:51:33.487

它可能更具可读性。很难阅读和理解。

您可以学习 SOLID 原则 ( [http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod) )

Robert C. Martin 在 Oredev 2008 上就清洁代码做了很好的介绍（[http://www.oredev.org/topmenu/video/agile/robertcmartincleancodeiiifunctions.4.5a2d30d411ee6ffd2888000779.html](http://www.oredev.org/topmenu/video/agile/robertcmartincleancodeiiifunctions.4.5a2d30d411ee6ffd2888000779.html)）

一些关于代码可读性的推荐书籍：

*   肯特贝克“实施模式”

*   罗伯特 C 马丁“清洁代码”罗伯特 C

*   Martin “C# 中的敏捷原则、模式和实践”

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-13T13:41:37.107

快速思考：

*   嵌套类型不应该是可见的。
*   ValueTypes（结构）应该是不可变的。
*   字段（类变量）不应公开。而是通过属性公开它们。
*   检查传递的参数是否存在无效值，例如 null。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-13T13:43:32.063

我建议你看看这个地方：[http](http://refactormycode.com/) ://refactormycode.com/ 。

对于一些快速的事情，你的命名是我开始改变的最大的事情。无需使用全大写或缩写词。

此外，[FxCop](http://msdn.microsoft.com/en-us/library/bb429476.aspx)将帮助进行许多建议的更改。例如，`FindIndexinArray`将被命名为`FindIndexInArray`.

编辑：

我不知道这是您的代码中的错误还是设计使然，但是在中`FindIndexinArray`，一旦找到匹配项，您就不会中断循环。您想要数组中的第一个（中断）还是最后一个（无中断）匹配？

# svn - SVN 行尾样式

> ID：857991
> 
> 赞同：8
> 
> 时间：2009-05-13T13:38:15.130
> 
> 标签：svn, line-endings, eol

当我尝试在 SVN 中提交文件时，其显示错误为“提交失败”。详细信息如下......提交 svn：行尾样式不一致。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-13T13:41:07.327

检查目录 / 文件上的 svn 属性。如果您定义了 svn:eol-style，但您的文件包含不同的样式（Unix vs DOS），则提交将失败，因为 SVN 不知道要转换为哪个。

参考：[http ://svn.haxx.se/users/archive-2006-07/0702.shtml](http://svn.haxx.se/users/archive-2006-07/0702.shtml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T14:04:59.610

一旦您知道 svn 期望的行尾样式，大多数现代编辑器都可以选择将您的源代码完全转换为一种或另一种样式。您还可以运行正则表达式来检测和更改它们（我喜欢 Perl）。

MSDOS EOL: "\r\n"

UNIX EOL：“\n”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-16T10:25:33.453

检查提交消息本身中的 EOL：如果您使用`--file`开关从文件中传递提交消息，请确保**提交消息**中的 EOL 样式是一致的（所有 DOS 或所有 UNIX）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-08T15:18:32.643

对于追随者，以下是手动将道具设置为一个或另一个的方法：

```
 svn propset svn:eol-style LF path/to/filename 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-11T21:42:38.283

我在 Windows 环境中使用 TortoiseSVN。我在尝试提交项目文件时遇到了同样的错误，可能是用 Linux（一个 AVR32 项目）编写的。我可以通过在 Microsoft Visual Studio 中打开每个文件来解决这个问题，此时 VS 提示我规范化行尾。选择这样做导致乌龟停止抱怨。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-31T04:58:11.050

从您的工具（如 kdiff）本身中选择行尾样式...右侧底部（就在输出行上方）

# asp.net - 使用多线程的asp.net更新UI

> ID：857999
> 
> 赞同：6
> 
> 时间：2009-05-13T13:40:01.993
> 
> 标签：asp.net, multithreading, user-interface

我有一个包含以下内容的 ASP.NET 网站

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server" >
     <ContentTemplate>
          <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>                
     </ContentTemplate>            
</asp:UpdatePanel> 
```

我创建了一个线程函数。在执行此功能期间，我想更新用户界面上的一些控件。

```
protected void Page_Load(object sender, EventArgs e)
{
    new Thread(new ThreadStart(Serialize_Click)).Start();
}
protected void Serialize_Click()
{
    for (int i = 1; i < 10; i++)
    {
        Label1.Text = Convert.ToString(i);
        UpdatePanel1.Update();
        System.Threading.Thread.Sleep(1000);
    }
} 
```

如何在线程执行期间更新 Web 控件？我需要强制“UpdatePanel1”回发吗？如何？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T14:46:50.557

您需要使用客户端计时器（或其他方法）让浏览器向服务器请求更新，例如这个简化的示例：

```
<asp:UpdatePanel ID="up" runat="server">        
    <ContentTemplate>
        <asp:Timer ID="Timer1" runat="server" Interval="1000" OnTick="timer_Ticked" />
        <asp:Label ID="Label1" runat="server" Text="1" />
    </ContentTemplate>
</asp:UpdatePanel> 
```

然后在您的代码隐藏中：

```
protected void timer_Ticked(object sender, EventArgs e)
{
    Label1.Text = (int.Parse(Label1.Text) + 1).ToString();
} 
```

如果您有一个正在更新某些状态的后台进程，您将需要将共享状态存储在会话、http 缓存或数据库中。请注意，由于许多因素，缓存可能会过期，并且如果 IIS 回收应用程序池，后台线程可能会被终止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T14:40:16.433

这不会像你想象的那样做。

在前端使用 js 计时器来调用更新页面的 web 方法会更有意义。

请记住，对于服务器，一旦页面呈现给您，它就不再存在，直到再次调用。网络是一种无状态的媒介。Postback 和 viewstate 让人感觉它不是，但它确实是。

因此，您将无法从服务器调用客户端，这是您尝试做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T13:54:46.010

您必须使用 javascript/jquery 来轮询服务器以进行更改。这是所有这些花哨的 jquery/ajax 东西的更不幸的副作用之一：人们忘记了浏览器必须轮询 Web 服务器 - 它只是一种单向连接，即使它有时确实感觉像客户端 winforms 应用程序. 最终，浏览器必须自行发出 http post/get 请求。是的，您可以提前发出客户端 javascript 来告诉它这样做，但这需要您知道何时准确地回调。听起来您有一些在完成后将执行的任意代码，因此在这种情况下您必须不断轮询。

-Oisin********~~****``