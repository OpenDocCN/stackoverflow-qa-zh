# StackOverflow 问答 000603000-000603999

# c# - app.config/web.config 中的变量

> ID：603009
> 
> 赞同：95
> 
> 时间：2009-03-02T16:37:15.507
> 
> 标签：c#, variables, web-config, app-config

是否可以在`app.config`or`web.config`文件中执行以下操作？

```
<appSettings>
 <add key="MyBaseDir" value="C:\MyBase" />
 <add key="Dir1" value="[MyBaseDir]\Dir1"/>
 <add key="Dir2" value="[MyBaseDir]\Dir2"/>
</appSettings> 
```

然后我想在我的代码中访问 Dir2，只需说：

```
 ConfigurationManager.AppSettings["Dir2"] 
```

当我在不同的服务器和位置安装我的应用程序时，这将对我有所帮助，我只需在整个`app.config`. （我知道我可以管理代码中的所有连接，但我更喜欢这种方式）。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-02T17:25:09.587

一个稍微复杂但更灵活的替代方法是创建一个表示配置部分的类。在你的`app.config`/`web.config`文件中，你可以有这个：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <!-- This section must be the first section within the <configuration> node -->
    <configSections>
        <section name="DirectoryInfo" type="MyProjectNamespace.DirectoryInfoConfigSection, MyProjectAssemblyName" />
    </configSections>

    <DirectoryInfo>
        <Directory MyBaseDir="C:\MyBase" Dir1="Dir1" Dir2="Dir2" />
    </DirectoryInfo>
</configuration> 
```

然后，在您的 .NET 代码中（我将在示例中使用 C#），您可以像这样创建两个类：

```
using System;
using System.Configuration;

namespace MyProjectNamespace {

    public class DirectoryInfoConfigSection : ConfigurationSection {

        [ConfigurationProperty("Directory")]
        public DirectoryConfigElement Directory {
            get {
                return (DirectoryConfigElement)base["Directory"];
            }
    }

    public class DirectoryConfigElement : ConfigurationElement {

        [ConfigurationProperty("MyBaseDir")]
        public String BaseDirectory {
            get {
                return (String)base["MyBaseDir"];
            }
        }

        [ConfigurationProperty("Dir1")]
        public String Directory1 {
            get {
                return (String)base["Dir1"];
            }
        }

        [ConfigurationProperty("Dir2")]
        public String Directory2 {
            get {
                return (String)base["Dir2"];
            }
        }
        // You can make custom properties to combine your directory names.
        public String Directory1Resolved {
            get {
                return System.IO.Path.Combine(BaseDirectory, Directory1);
            }
        }
    }
} 
```

最后，在您的程序代码中，您可以`app.config`使用新类以这种方式访问​​变量：

```
DirectoryInfoConfigSection config =
  (DirectoryInfoConfigSection)ConfigurationManager.GetSection("DirectoryInfo");
String dir1Path = config.Directory.Directory1Resolved;  // This value will equal "C:\MyBase\Dir1" 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2011-10-10T23:07:50.467

您可以使用我的库[Expansive](https://github.com/anderly/Expansive)来完成。[也可在此处](https://www.nuget.org/packages/Expansive/)的 nuget 上找到。

它是以此为主要用例设计的。

### 中等示例（使用 AppSettings 作为令牌扩展的默认来源）

在 app.config 中：

```
<configuration>
    <appSettings>
        <add key="Domain" value="mycompany.com"/>
        <add key="ServerName" value="db01.{Domain}"/>
    </appSettings>
    <connectionStrings>
        <add name="Default" connectionString="server={ServerName};uid=uid;pwd=pwd;Initial Catalog=master;" provider="System.Data.SqlClient" />
    </connectionStrings>
</configuration> 
```

对要扩展的字符串使用**.Expand()**扩展方法：

```
var connectionString = ConfigurationManager.ConnectionStrings["Default"].ConnectionString;
connectionString.Expand() // returns "server=db01.mycompany.com;uid=uid;pwd=pwd;Initial Catalog=master;" 
```

或者

按如下方式使用 Dynamic ConfigurationManager 包装器“Config”（不需要显式调用 Expand()）：

```
var serverName = Config.AppSettings.ServerName;
// returns "db01.mycompany.com"

var connectionString = Config.ConnectionStrings.Default;
// returns "server=db01.mycompany.com;uid=uid;pwd=pwd;Initial Catalog=master;" 
```

### 高级示例 1（使用 AppSettings 作为令牌扩展的默认来源）

在 app.config 中：

```
<configuration>
    <appSettings>
        <add key="Environment" value="dev"/>
        <add key="Domain" value="mycompany.com"/>
        <add key="UserId" value="uid"/>
        <add key="Password" value="pwd"/>
        <add key="ServerName" value="db01-{Environment}.{Domain}"/>
        <add key="ReportPath" value="\\{ServerName}\SomeFileShare"/>
    </appSettings>
    <connectionStrings>
        <add name="Default" connectionString="server={ServerName};uid={UserId};pwd={Password};Initial Catalog=master;" provider="System.Data.SqlClient" />
    </connectionStrings>
</configuration> 
```

对要扩展的字符串使用 .Expand() 扩展方法：

```
var connectionString = ConfigurationManager.ConnectionStrings["Default"].ConnectionString;
connectionString.Expand() // returns "server=db01-dev.mycompany.com;uid=uid;pwd=pwd;Initial Catalog=master;" 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-02T17:12:11.413

好问题。

我不认为有。我相信如果有一种简单的方法会很出名，而且我看到微软正在 Visual Studio 2010 中创建一种机制，用于部署不同的配置文件以进行部署和测试。

然而，话虽如此；我发现您在该`ConnectionStrings`部分中有一种名为“|DataDirectory|”的占位符。也许你可以看看那里有什么工作......

这是`machine.config`展示它的一部分：

```
 <connectionStrings>
    <add
        name="LocalSqlServer"
        connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true"
        providerName="System.Data.SqlClient"
    />
 </connectionStrings> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-02T16:51:48.513

我以为我刚看到这个问题。

简而言之，不，应用程序配置中没有变量插值。

你有两个选择

1.  您可以自己滚动以在运行时替换变量
2.  在构建时，根据目标部署环境的特定细节调整应用程序配置。[处理配置噩梦的](http://weblogs.asp.net/sweinstein/archive/2008/08/24/dealing-with-the-configuration-nightmare.aspx)一些细节

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-02T18:13:55.663

通常，我最终会编写一个带有属性的静态类来访问我的 web.config 的每个设置。

```
public static class ConfigManager 
{
    public static string MyBaseDir
    {
        return ConfigurationManager.AppSettings["MyBaseDir"].toString();
    }

    public static string Dir1
    {
        return MyBaseDir + ConfigurationManager.AppSettings["Dir1"].toString();
    }

} 
```

通常，我也会在此类需要时进行类型转换。它允许对您的配置进行键入访问，如果设置发生更改，您只能在一个地方编辑它们。

通常，用这个类替换设置相对容易，并且提供了更好的可维护性。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-02T16:47:24.887

你有几个选择。您可以通过构建/部署步骤来执行此操作，该步骤将处理您的配置文件，用正确的值替换您的变量。

另一种选择是定义您自己的支持此的配置部分。例如想象这个xml：

```
<variableAppSettings>
 <variables>
    <add key="@BaseDir" value="c:\Programs\Widget"/>
 </variables>
 <appSettings>
    <add key="PathToDir" value="@BaseDir\Dir1"/>
 </appSettings>
</variableAppSettings> 
```

现在，您将使用自定义配置对象来实现这一点，该对象将在运行时为您替换变量。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-11-24T21:38:33.450

您可以在您`app.config`描述的场景中使用环境变量

```
<configuration>
  <appSettings>
    <add key="Dir1" value="%MyBaseDir%\Dir1"/>
  </appSettings>
</configuration> 
```

然后，您可以通过以下方式轻松获取路径：

```
var pathFromConfig = ConfigurationManager.AppSettings["Dir1"];
var expandedPath = Environment.ExpandEnvironmentVariables(pathFromConfig); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-02T16:27:07.730

在里面`<appSettings>`你可以创建应用程序密钥，

```
<add key="KeyName" value="Keyvalue"/> 
```

稍后您可以使用以下方法访问这些值：

```
ConfigurationManager.AppSettings["Keyname"] 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-02-10T17:47:39.153

我建议你[DslConfig](https://github.com/johannes-brunner/DslConfig)。使用 DslConfig，您可以使用全局配置中的分层配置文件，每个服务器主机配置来配置每个服务器主机上的每个应用程序（请参阅 AppSpike）。
如果这对您来说很复杂，您可以使用全局配置 Variables.var
只需在 Varibales.var 中配置

```
baseDir = "C:\MyBase"
Var["MyBaseDir"] = baseDir
Var["Dir1"] = baseDir + "\Dir1"
Var["Dir2"] = baseDir + "\Dir2" 
```

并获取配置值

```
Configuration config = new DslConfig.BooDslConfiguration()
config.GetVariable<string>("MyBaseDir")
config.GetVariable<string>("Dir1")
config.GetVariable<string>("Dir2") 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-02T16:39:05.143

我认为您不能声明和使用变量来定义配置文件中的 appSettings 键。我一直像你一样在代码中管理串联。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-02T16:39:57.900

我正在为您想要的东西而苦苦挣扎，但是您可以将覆盖文件添加到应用程序设置中，然后根据每个环境设置该覆盖文件。

```
<appSettings file="..\OverrideSettings.config"> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-02T17:00:27.243

为了推出需要配置大量具有相似值的项目的产品，我们使用小型控制台应用程序来读取 XML 并根据传入的参数进行更新。安装程序在向用户询问要求（提供）的信息。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-11-03T10:12:19.570

我建议遵循 Matt Hamsmith 的解决方案。如果实现起来有问题，那么为什么不在 AppSettings 类的后台创建一个扩展方法呢？

就像是：

```
 public static string GetValue(this NameValueCollection settings, string key)
    {

    } 
```

在方法中，您使用 Linq 搜索 DictionaryInfoConfigSection 并返回具有匹配键的值。不过，您需要将配置文件更新为以下内容：

```
<appSettings>
  <DirectoryMappings>
    <DirectoryMap key="MyBaseDir" value="C:\MyBase" />
    <DirectoryMap key="Dir1" value="[MyBaseDir]\Dir1"/>
    <DirectoryMap key="Dir2" value="[MyBaseDir]\Dir2"/>
  </DirectoryMappings>
</appSettings> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-06-24T09:54:12.457

我想出了这个解决方案：

1.  在应用程序 Settings.settings 我定义了一个变量 ConfigurationBase （类型=字符串范围=应用程序）
2.  我在 Settings.settings 的目标属性中引入了一个变量，所有这些属性都必须设置为 Scope=User
3.  在 app.xaml.cs 中，我读出了 ConfigurationBase 的值
4.  在 app.xaml.cs 中，我用 ConfigurationBase 值替换了所有变量。为了在运行时替换值，必须将属性设置为 Scopr=User

我对这个解决方案不太满意，因为我必须手动更改所有属性，如果我添加一个新属性，我必须在 app.xaml.cs 中考虑它。

这是来自 App.xaml.cs 的代码片段：

```
string configBase = Settings.Default.ConfigurationBase;
Settings.Default.CommonOutput_Directory = Settings.Default.CommonOutput_Directory.Replace("${ConfigurationBase}", configBase); 
```

**更新**

刚刚发现了一个改进（再次来自 app.xaml.cs 的代码片段）：

```
string configBase = Settings.Default.ConfigurationBase;

foreach (SettingsProperty settingsProperty in Settings.Default.Properties)
{
    if (!settingsProperty.IsReadOnly && settings.Default[settingsProperty.Name] is string)
    {
        Settings.Default[settingsProperty.Name] = ((string)Settings.Default[settingsProperty.Name]).Replace("${ConfigurationBase}", configBase);
    }
} 
```

现在替换适用于我的设置中具有 Type=string 和 Scope=User 的所有属性。我想我喜欢这种方式。

**更新2**

显然，在属性上运行时不需要设置 Scope=Application 。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-08-12T17:38:13.273

# 三种可能的解决方案

> 我知道我迟到了，我一直在寻找是否有任何新的解决方案来解决可变配置设置问题。有一些答案涉及我过去使用的解决方案，但大多数似乎有点令人费解。我想我会看看我的旧解决方案并将实现放在一起，以便它可以帮助那些正在努力解决同样问题的人。

对于此示例，我在控制台应用程序中使用了以下应用程序设置：

```
<appSettings>
    <add key="EnvironmentVariableExample" value="%BaseDir%\bin"/>
    <add key="StaticClassExample" value="bin"/>
    <add key="InterpollationExample" value="{0}bin"/>
  </appSettings> 
```

## 1.使用环境变量

> 我相信autocro [autocro的回答](https://stackoverflow.com/a/33904324/2466243 "autocro的回答")触及到了它。我只是在做一个在构建或调试时应该足够的实现，而不必关闭 Visual Studio。我以前使用过这个解决方案......

*   ### 创建将使用 MSBuild 变量的预构建事件

    > 警告：使用不容易替换的变量，因此请使用您的项目名称或类似的变量名称。

    `SETX BaseDir "$(ProjectDir)"`

*   ### 重置变量；使用类似以下内容：

    [在 Stack Overflow 上刷新环境变量](https://stackoverflow.com/a/171737/2466243)

*   ### 使用代码中的设置：

'

```
private void Test_Environment_Variables()
{
    string BaseDir = ConfigurationManager.AppSettings["EnvironmentVariableExample"];
    string ExpandedPath = Environment.ExpandEnvironmentVariables(BaseDir).Replace("\"", ""); //The function addes a " at the end of the variable
    Console.WriteLine($"From within the C# Console Application {ExpandedPath}");
} 
```

'

## 2.使用字符串插值：

*   ### 使用 string.Format() 函数

`

```
private void Test_Interpollation()
{
    string ConfigPath = ConfigurationManager.AppSettings["InterpollationExample"];
    string SolutionPath = Path.GetFullPath(Path.Combine(System.AppDomain.CurrentDomain.BaseDirectory, @"..\..\"));
    string ExpandedPath = string.Format(ConfigPath, SolutionPath.ToString());
    Console.WriteLine($"Using old interpollation {ExpandedPath}");
} 
```

`

## 3.使用静态类，这是我主要使用的解决方案。

*   ### 实施

`

```
private void Test_Static_Class()
{
    Console.WriteLine($"Using a static config class {Configuration.BinPath}");
} 
```

`

*   ### 静态类

`

```
static class Configuration
{
    public static string BinPath
    {
        get
        {
            string ConfigPath = ConfigurationManager.AppSettings["StaticClassExample"];
            string SolutionPath = Path.GetFullPath(Path.Combine(System.AppDomain.CurrentDomain.BaseDirectory, @"..\..\"));
            return SolutionPath + ConfigPath;
        }
    }
} 
```

`

# 项目代码：

## 应用程序配置：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <startup> 
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.6.1" />
    </startup>
  <appSettings>
    <add key="EnvironmentVariableExample" value="%BaseDir%\bin"/>
    <add key="StaticClassExample" value="bin"/>
    <add key="InterpollationExample" value="{0}bin"/>
  </appSettings>
</configuration> 
```

## 程序.cs

```
using System;
using System.Configuration;
using System.IO;

namespace ConfigInterpollation
{
    class Program
    {
        static void Main(string[] args)
        {
            new Console_Tests().Run_Tests();
            Console.WriteLine("Press enter to exit");
            Console.ReadLine();
        }        
    }

    internal class Console_Tests
    {
        public void Run_Tests()
        {
            Test_Environment_Variables();
            Test_Interpollation();
            Test_Static_Class();
        }
        private void Test_Environment_Variables()
        {
            string ConfigPath = ConfigurationManager.AppSettings["EnvironmentVariableExample"];
            string ExpandedPath = Environment.ExpandEnvironmentVariables(ConfigPath).Replace("\"", "");
            Console.WriteLine($"Using environment variables {ExpandedPath}");
        }

        private void Test_Interpollation()
        {
            string ConfigPath = ConfigurationManager.AppSettings["InterpollationExample"];
            string SolutionPath = Path.GetFullPath(Path.Combine(System.AppDomain.CurrentDomain.BaseDirectory, @"..\..\"));
            string ExpandedPath = string.Format(ConfigPath, SolutionPath.ToString());
            Console.WriteLine($"Using interpollation {ExpandedPath}");
        }

        private void Test_Static_Class()
        {
            Console.WriteLine($"Using a static config class {Configuration.BinPath}");
        }
    }

    static class Configuration
    {
        public static string BinPath
        {
            get
            {
                string ConfigPath = ConfigurationManager.AppSettings["StaticClassExample"];
                string SolutionPath = Path.GetFullPath(Path.Combine(System.AppDomain.CurrentDomain.BaseDirectory, @"..\..\"));
                return SolutionPath + ConfigPath;
            }
        }
    }
} 
```

## 预建事件：

[项目设置 -> 构建事件](https://i.stack.imgur.com/MFuLA.png)

# visual-studio - Multi-language build tools

> ID：603010
> 
> 赞同：0
> 
> 时间：2009-03-02T16:37:16.287
> 
> 标签：visual-studio, build-process, legacy-code

I have a build process for a large enterprise system comprising several dozen separate EXEs and DLLs. These use multiple languages, C, C++, Fortran, Python, Awk and a couple more. The build scripts are 4DOS batch processes which evolved over 4 decades. They are large and unwieldy and need constant care and feeding.

I must keep the Visual Studio solution and project files as the basic compile/link entities. What's the best tool for wrapping these disparate languages all together. 4DOS is very old and cumbersome.

EDIT:

Thanks gang. I think I'll try SCONS first because it's Python. We have plenty of people well versed in Python to be able to update and maintain it. I'm 61 now and it's not going to be me supporting this in the long term. I don't like anything requiring JAVA or XML because those are not languages already in our product mix and we have enough in play.

Those blog posts were good. He concluded that SCONS was best but simply too slow for his purposes. I'm not looking for speed in nightly builds. It's got until 7 AM. I want readability and maintainability.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T16:45:25.220

例如[Apache Ant](http://ant.apache.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T19:27:42.163

蚂蚁是一个不错的选择。我也很想尝试[Rake](http://rake.rubyforge.org/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T11:31:21.097

我知道[Maven](http://maven.apache.org/)不关注 Java 以外的任何东西，但也许它至少值得一提。至少在启用 C/C++ 方面已经做了一些工作。与 Ant 相比，它以类似的方式可插入，但它是声明式的而不是命令式的，具有标准化的依赖管理，以及甚至可以分布的构建结果存储库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T19:47:49.680

我认为最好的选择是[NAnt](http://nant.sourceforge.net)和 MSBulid

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T19:50:42.700

[也许是斯康斯](http://www.scons.org/)？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T20:04:38.550

这些可能有点过时 - 构建系统可能已经发展了很多，但这至少应该让您更好地了解预期的内容：

*   [追求完美的构建系统](http://gamesfromwithin.com/?p=42)
*   [追求完美构建系统（第 2 部分）](http://gamesfromwithin.com/?p=44)

就个人而言，我从来不需要任何特别的东西，这是 VS 项目/解决方案文件、makefile 和 BATCH 无法实现的，所以我不会特别推荐任何东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T20:15:27.837

[肯定是斯康斯](http://www.scons.org/)。它自然地与fortran和C一起使用，它是基于python的，所以它也不应该有任何问题（虽然从未将它用于py，所以不能从经验中判断）。而且，比它们中的大多数更具可读性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-13T18:59:13.767

ANT + [terp](http://codemesh.com/products/terp/)用于 C++ 部分。terp 可以很好地与 VisualStudio 以及许多平台上的许多其他 C++ 编译器配合使用。不过，ANT 需要 Java，即使只是作为托管技术。我不知道这是否符合您的要求，或者您是否只是不想开始编写 Java 代码。

# java - Dumping a java object's properties

> ID：603013
> 
> 赞同：69
> 
> 时间：2009-03-02T16:38:01.353
> 
> 标签：java, reflection, properties, dump, tostring

Is there a library that will recursively dump/print an objects properties? I'm looking for something similar to the [console.dir()](http://getfirebug.com/console.html) function in Firebug.

I'm aware of the commons-lang [ReflectionToStringBuilder](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/builder/ReflectionToStringBuilder.html) but it does not recurse into an object. I.e., if I run the following:

```
public class ToString {

    public static void main(String [] args) {
        System.out.println(ReflectionToStringBuilder.toString(new Outer(), ToStringStyle.MULTI_LINE_STYLE));
    }

    private static class Outer {
        private int intValue = 5;
        private Inner innerValue = new Inner();
    }

    private static class Inner {
        private String stringValue = "foo";
    }
} 
```

I receive:

> ToString$Outer@1b67f74[ intValue=5
> innerValue=ToString$Inner@530daa ]

I realize that in my example, I could have overriden the toString() method for Inner but in the real world, I'm dealing with external objects that I can't modify.

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-03-02T16:48:35.523

You could try [XStream](http://x-stream.github.io/).

```
XStream xstream = new XStream(new Sun14ReflectionProvider(
  new FieldDictionary(new ImmutableFieldKeySorter())),
  new DomDriver("utf-8"));
System.out.println(xstream.toXML(new Outer())); 
```

prints out:

```
<foo.ToString_-Outer>
  <intValue>5</intValue>
  <innerValue>
    <stringValue>foo</stringValue>
  </innerValue>
</foo.ToString_-Outer> 
```

You could also output in [JSON](http://x-stream.github.io/json-tutorial.html)

And be careful of circular references ;)

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2011-11-15T15:22:56.510

I tried using XStream as originally suggested, but it turns out the object graph I wanted to dump included a reference back to the XStream marshaller itself, which it didn't take too kindly to (why it must throw an exception rather than ignoring it or logging a nice warning, I'm not sure.)

I then tried out the code from user519500 above but found I needed a few tweaks. Here's a class you can roll into a project that offers the following extra features:

*   Can control max recursion depth
*   Can limit array elements output
*   Can ignore any list of classes, fields, or class+field combinations - just pass an array with any combination of class names, classname+fieldname pairs separated with a colon, or fieldnames with a colon prefix ie: `[<classname>][:<fieldname>]`
*   Will not output the same object twice (the output indicates when an object was previously visited and provides the hashcode for correlation) - this avoids circular references causing problems

You can call this using one of the two methods below:

```
 String dump = Dumper.dump(myObject);
    String dump = Dumper.dump(myObject, maxDepth, maxArrayElements, ignoreList); 
```

As mentioned above, you need to be careful of stack-overflows with this, so use the max recursion depth facility to minimise the risk.

Hopefully somebody will find this useful!

```
package com.mycompany.myproject;

import java.lang.reflect.Array;
import java.lang.reflect.Field;
import java.util.HashMap;

public class Dumper {
    private static Dumper instance = new Dumper();

    protected static Dumper getInstance() {
        return instance;
    }

    class DumpContext {
        int maxDepth = 0;
        int maxArrayElements = 0;
        int callCount = 0;
        HashMap<String, String> ignoreList = new HashMap<String, String>();
        HashMap<Object, Integer> visited = new HashMap<Object, Integer>();
    }

    public static String dump(Object o) {
        return dump(o, 0, 0, null);
    }

    public static String dump(Object o, int maxDepth, int maxArrayElements, String[] ignoreList) {
        DumpContext ctx = Dumper.getInstance().new DumpContext();
        ctx.maxDepth = maxDepth;
        ctx.maxArrayElements = maxArrayElements;

        if (ignoreList != null) {
            for (int i = 0; i < Array.getLength(ignoreList); i++) {
                int colonIdx = ignoreList[i].indexOf(':');
                if (colonIdx == -1)
                    ignoreList[i] = ignoreList[i] + ":";
                ctx.ignoreList.put(ignoreList[i], ignoreList[i]);
            }
        }

        return dump(o, ctx);
    }

    protected static String dump(Object o, DumpContext ctx) {
        if (o == null) {
            return "<null>";
        }

        ctx.callCount++;
        StringBuffer tabs = new StringBuffer();
        for (int k = 0; k < ctx.callCount; k++) {
            tabs.append("\t");
        }
        StringBuffer buffer = new StringBuffer();
        Class oClass = o.getClass();

        String oSimpleName = getSimpleNameWithoutArrayQualifier(oClass);

        if (ctx.ignoreList.get(oSimpleName + ":") != null)
            return "<Ignored>";

        if (oClass.isArray()) {
            buffer.append("\n");
            buffer.append(tabs.toString().substring(1));
            buffer.append("[\n");
            int rowCount = ctx.maxArrayElements == 0 ? Array.getLength(o) : Math.min(ctx.maxArrayElements, Array.getLength(o));
            for (int i = 0; i < rowCount; i++) {
                buffer.append(tabs.toString());
                try {
                    Object value = Array.get(o, i);
                    buffer.append(dumpValue(value, ctx));
                } catch (Exception e) {
                    buffer.append(e.getMessage());
                }
                if (i < Array.getLength(o) - 1)
                    buffer.append(",");
                buffer.append("\n");
            }
            if (rowCount < Array.getLength(o)) {
                buffer.append(tabs.toString());
                buffer.append(Array.getLength(o) - rowCount + " more array elements...");
                buffer.append("\n");
            }
            buffer.append(tabs.toString().substring(1));
            buffer.append("]");
        } else {
            buffer.append("\n");
            buffer.append(tabs.toString().substring(1));
            buffer.append("{\n");
            buffer.append(tabs.toString());
            buffer.append("hashCode: " + o.hashCode());
            buffer.append("\n");
            while (oClass != null && oClass != Object.class) {
                Field[] fields = oClass.getDeclaredFields();

                if (ctx.ignoreList.get(oClass.getSimpleName()) == null) {
                    if (oClass != o.getClass()) {
                        buffer.append(tabs.toString().substring(1));
                        buffer.append("  Inherited from superclass " + oSimpleName + ":\n");
                    }

                    for (int i = 0; i < fields.length; i++) {

                        String fSimpleName = getSimpleNameWithoutArrayQualifier(fields[i].getType());
                        String fName = fields[i].getName();

                        fields[i].setAccessible(true);
                        buffer.append(tabs.toString());
                        buffer.append(fName + "(" + fSimpleName + ")");
                        buffer.append("=");

                        if (ctx.ignoreList.get(":" + fName) == null &&
                            ctx.ignoreList.get(fSimpleName + ":" + fName) == null &&
                            ctx.ignoreList.get(fSimpleName + ":") == null) {

                            try {
                                Object value = fields[i].get(o);
                                buffer.append(dumpValue(value, ctx));
                            } catch (Exception e) {
                                buffer.append(e.getMessage());
                            }
                            buffer.append("\n");
                        }
                        else {
                            buffer.append("<Ignored>");
                            buffer.append("\n");
                        }
                    }
                    oClass = oClass.getSuperclass();
                    oSimpleName = oClass.getSimpleName();
                }
                else {
                    oClass = null;
                    oSimpleName = "";
                }
            }
            buffer.append(tabs.toString().substring(1));
            buffer.append("}");
        }
        ctx.callCount--;
        return buffer.toString();
    }

    protected static String dumpValue(Object value, DumpContext ctx) {
        if (value == null) {
            return "<null>";
        }
        if (value.getClass().isPrimitive() ||
            value.getClass() == java.lang.Short.class ||
            value.getClass() == java.lang.Long.class ||
            value.getClass() == java.lang.String.class ||
            value.getClass() == java.lang.Integer.class ||
            value.getClass() == java.lang.Float.class ||
            value.getClass() == java.lang.Byte.class ||
            value.getClass() == java.lang.Character.class ||
            value.getClass() == java.lang.Double.class ||
            value.getClass() == java.lang.Boolean.class ||
            value.getClass() == java.util.Date.class ||
            value.getClass().isEnum()) {

            return value.toString();

        } else {

            Integer visitedIndex = ctx.visited.get(value);
            if (visitedIndex == null) {
                ctx.visited.put(value, ctx.callCount);
                if (ctx.maxDepth == 0 || ctx.callCount < ctx.maxDepth) {
                    return dump(value, ctx);
                }
                else {
                    return "<Reached max recursion depth>";
                }
            }
            else {
                return "<Previously visited - see hashCode " + value.hashCode() + ">";
            }
        }
    }

    private static String getSimpleNameWithoutArrayQualifier(Class clazz) {
        String simpleName = clazz.getSimpleName();
        int indexOfBracket = simpleName.indexOf('['); 
        if (indexOfBracket != -1)
            return simpleName.substring(0, indexOfBracket);
        return simpleName;
    }
} 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-05-18T20:23:23.973

You can use ReflectionToStringBuilder with a custom ToStringStyle, for example:

```
class MyStyle extends ToStringStyle {
    private final static ToStringStyle instance = new MyStyle();

    public MyStyle() {
        setArrayContentDetail(true);
        setUseShortClassName(true);
        setUseClassName(false);
        setUseIdentityHashCode(false);
        setFieldSeparator(", " + SystemUtils.LINE_SEPARATOR + "  ");
    }

    public static ToStringStyle getInstance() {
        return instance;
    };

    @Override
    public void appendDetail(StringBuffer buffer, String fieldName, Object value) {
        if (!value.getClass().getName().startsWith("java")) {
            buffer.append(ReflectionToStringBuilder.toString(value, instance));
        } else {
            super.appendDetail(buffer, fieldName, value);
        }
    }

    @Override
    public void appendDetail(StringBuffer buffer, String fieldName, Collection value) {
        appendDetail(buffer, fieldName, value.toArray());
    }
} 
```

And then you invoke it like:

```
ReflectionToStringBuilder.toString(value, MyStyle.getInstance()); 
```

Beware of circular references though!

* * *

You can also use json-lib ([http://json-lib.sourceforge.net](http://json-lib.sourceforge.net)) and just do:

```
JSONObject.fromObject(value); 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2010-11-24T23:40:02.580

this will print out all fields (including arrays of objects) of an object.

Fixed version of Ben Williams post from [this thread](https://stackoverflow.com/questions/37628/what-is-reflection-and-why-is-it-useful)

Note: this method uses recursion so If you have a very deep object graph you may get a stack-overflow (no pun intended ;) IF so you need to use the VM parameter -Xss10m. If your using eclipse put it in run>runconfiguration>augments (tab) VM augment box and press apply

```
import java.lang.reflect.Array;
import java.lang.reflect.Field;

public static String dump(Object o) {
    StringBuffer buffer = new StringBuffer();
    Class oClass = o.getClass();
     if (oClass.isArray()) {
         buffer.append("Array: ");
        buffer.append("[");
        for (int i = 0; i < Array.getLength(o); i++) {
            Object value = Array.get(o, i);
            if (value.getClass().isPrimitive() ||
                    value.getClass() == java.lang.Long.class ||
                    value.getClass() == java.lang.Integer.class ||
                    value.getClass() == java.lang.Boolean.class ||
                    value.getClass() == java.lang.String.class ||
                    value.getClass() == java.lang.Double.class ||
                    value.getClass() == java.lang.Short.class ||
                    value.getClass() == java.lang.Byte.class
                    ) {
                buffer.append(value);
                if(i != (Array.getLength(o)-1)) buffer.append(",");
            } else {
                buffer.append(dump(value));
             }
        }
        buffer.append("]\n");
    } else {
         buffer.append("Class: " + oClass.getName());
         buffer.append("{\n");
        while (oClass != null) {
            Field[] fields = oClass.getDeclaredFields();
            for (int i = 0; i < fields.length; i++) {
                fields[i].setAccessible(true);
                buffer.append(fields[i].getName());
                buffer.append("=");
                try {
                    Object value = fields[i].get(o);
                    if (value != null) {
                        if (value.getClass().isPrimitive() ||
                                value.getClass() == java.lang.Long.class ||
                                value.getClass() == java.lang.String.class ||
                                value.getClass() == java.lang.Integer.class ||
                                value.getClass() == java.lang.Boolean.class ||
                                    value.getClass() == java.lang.Double.class ||
                                value.getClass() == java.lang.Short.class ||
                                value.getClass() == java.lang.Byte.class
                                ) {
                            buffer.append(value);
                        } else {
                            buffer.append(dump(value));
                        }
                    }
                } catch (IllegalAccessException e) {
                    buffer.append(e.getMessage());
                }
                buffer.append("\n");
            }
            oClass = oClass.getSuperclass();
        }
        buffer.append("}\n");
    }
    return buffer.toString();
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-08-24T19:52:26.473

I wanted an elegant solution to this problem that:

*   Does not use any external library
*   Uses [Reflection](http://docs.oracle.com/javase/tutorial/reflect/) to access fields, including superclass fields
*   Uses recursion to traverse the Object-graph with only one stack frame per call
*   Uses an [IdentityHashMap](http://docs.oracle.com/javase/7/docs/api/java/util/IdentityHashMap.html) to handle backwards references and avoid infinite recursion
*   Handles primitives, auto-boxing, CharSequences, enums, and nulls appropriately
*   Allows you to choose whether or not to parse static fields
*   Is simple enough to modify according to formatting preferences

I wrote the following utility class:

```
import java.lang.reflect.Array;
import java.lang.reflect.Field;
import java.lang.reflect.Modifier;
import java.util.IdentityHashMap;
import java.util.Map.Entry;
import java.util.TreeMap;

/**
 * Utility class to dump {@code Object}s to string using reflection and recursion.
 */
public class StringDump {

    /**
     * Uses reflection and recursion to dump the contents of the given object using a custom, JSON-like notation (but not JSON). Does not format static fields.<p>
     * @see #dump(Object, boolean, IdentityHashMap, int)
     * @param object the {@code Object} to dump using reflection and recursion
     * @return a custom-formatted string representing the internal values of the parsed object
     */
    public static String dump(Object object) {
        return dump(object, false, new IdentityHashMap<Object, Object>(), 0);
    }

    /**
     * Uses reflection and recursion to dump the contents of the given object using a custom, JSON-like notation (but not JSON).<p>
     * Parses all fields of the runtime class including super class fields, which are successively prefixed with "{@code super.}" at each level.<p>
     * {@code Number}s, {@code enum}s, and {@code null} references are formatted using the standard {@link String#valueOf()} method.
     * {@code CharSequences}s are wrapped with quotes.<p>
     * The recursive call invokes only one method on each recursive call, so limit of the object-graph depth is one-to-one with the stack overflow limit.<p>
     * Backwards references are tracked using a "visitor map" which is an instance of {@link IdentityHashMap}.
     * When an existing object reference is encountered the {@code "sysId"} is printed and the recursion ends.<p>
     * 
     * @param object             the {@code Object} to dump using reflection and recursion
     * @param isIncludingStatics {@code true} if {@code static} fields should be dumped, {@code false} to skip them
     * @return a custom-formatted string representing the internal values of the parsed object
     */
    public static String dump(Object object, boolean isIncludingStatics) {
        return dump(object, isIncludingStatics, new IdentityHashMap<Object, Object>(), 0);
    }

    private static String dump(Object object, boolean isIncludingStatics, IdentityHashMap<Object, Object> visitorMap, int tabCount) {
        if (object == null ||
                object instanceof Number || object instanceof Character || object instanceof Boolean ||
                object.getClass().isPrimitive() || object.getClass().isEnum()) {
            return String.valueOf(object);
        }

        StringBuilder builder = new StringBuilder();
        int           sysId   = System.identityHashCode(object);
        if (object instanceof CharSequence) {
            builder.append("\"").append(object).append("\"");
        }
        else if (visitorMap.containsKey(object)) {
            builder.append("(sysId#").append(sysId).append(")");
        }
        else {
            visitorMap.put(object, object);

            StringBuilder tabs = new StringBuilder();
            for (int t = 0; t < tabCount; t++) {
                tabs.append("\t");
            }
            if (object.getClass().isArray()) {
                builder.append("[").append(object.getClass().getName()).append(":sysId#").append(sysId);
                int length = Array.getLength(object);
                for (int i = 0; i < length; i++) {
                    Object arrayObject = Array.get(object, i);
                    String dump        = dump(arrayObject, isIncludingStatics, visitorMap, tabCount + 1);
                    builder.append("\n\t").append(tabs).append("\"").append(i).append("\":").append(dump);
                }
                builder.append(length == 0 ? "" : "\n").append(length == 0 ? "" : tabs).append("]");
            }
            else {
                // enumerate the desired fields of the object before accessing
                TreeMap<String, Field> fieldMap    = new TreeMap<String, Field>();  // can modify this to change or omit the sort order
                StringBuilder          superPrefix = new StringBuilder();
                for (Class<?> clazz = object.getClass(); clazz != null && !clazz.equals(Object.class); clazz = clazz.getSuperclass()) {
                    Field[] fields = clazz.getDeclaredFields();
                    for (int i = 0; i < fields.length; i++) {
                        Field field = fields[i];
                        if (isIncludingStatics || !Modifier.isStatic(field.getModifiers())) {
                            fieldMap.put(superPrefix + field.getName(), field);
                        }
                    }
                    superPrefix.append("super.");
                }

                builder.append("{").append(object.getClass().getName()).append(":sysId#").append(sysId);
                for (Entry<String, Field> entry : fieldMap.entrySet()) {
                    String name  = entry.getKey();
                    Field  field = entry.getValue();
                    String dump;
                    try {
                        boolean wasAccessible = field.isAccessible();
                        field.setAccessible(true);
                        Object  fieldObject   = field.get(object);
                        field.setAccessible(wasAccessible);  // the accessibility flag should be restored to its prior ClassLoader state
                        dump                  = dump(fieldObject, isIncludingStatics, visitorMap, tabCount + 1);
                    }
                    catch (Throwable e) {
                        dump = "!" + e.getClass().getName() + ":" + e.getMessage();
                    }
                    builder.append("\n\t").append(tabs).append("\"").append(name).append("\":").append(dump);
                }
                builder.append(fieldMap.isEmpty() ? "" : "\n").append(fieldMap.isEmpty() ? "" : tabs).append("}");
            }
        }
        return builder.toString();
    }
} 
```

I tested it on a number of classes and for me it's extremely efficient. For example, try using it to dump the main thread:

```
public static void main(String[] args) throws Exception {
    System.out.println(dump(Thread.currentThread()));
} 
```

**Edit**

Since writing this post I had reason to create an iterative version of this algorithm. The recursive version is limited in depth by total stack frames, but you might have reason to dump an extremely large object graph. To handle my situation, I revised the algorithm to use a stack data structure in place of the runtime stack. This version is time-efficient and is limited by heap size instead of stack frame depth.

You can download and use the [iterative version here](https://github.com/bryanwagner/string-dump).

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-02T16:52:33.690

Maybe you could use an XML binding framework like [XStream](https://x-stream.github.io/), [Digester](http://commons.apache.org/digester/) or [JAXB](http://jaxb.java.net/) for that.

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-06-03T13:10:57.117

You should use RecursiveToStringStyle:

```
System.out.println(ReflectionToStringBuilder.toString(new Outer(), new RecursiveToStringStyle())); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-05-23T09:42:32.927

You could use [Gson](https://github.com/google/gson) to represent your object in json format :

```
new GsonBuilder().setPrettyPrinting().create().toJson(yourObject); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-05-24T05:26:41.143

I recommend you to use the [GSON](https://github.com/google/gson) Lib fo Java.

if You use Maven you can use [this](https://maven-badges.herokuapp.com/maven-central/com.google.code.gson/gson).

Or you can download the Jar file from [here](http://central.maven.org/maven2/com/google/code/gson/gson/2.3.1/gson-2.3.1.jar).

Here example how to use it:

```
Gson gson = new GsonBuilder().setPrettyPrinting().create();
String json = gson.toJson(obj);
System.out.println(json); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-06-11T09:33:32.240

```
JSONObject.fromObject(value) 
```

Does not work for Map objects with other keys than String. Maybe JsonConfig can handle this.

# dynamics-crm - Disable Case Resolution Action on form load

> ID：603015
> 
> 赞同：0
> 
> 时间：2009-03-02T16:38:32.210
> 
> 标签：dynamics-crm, dynamics-crm-4

I am trying to disable the ability to resolve a case in CRM unless a couple fields have data. I would like to gray out the case resolution action and was wondering if anyone knew how to do this on the form Load.

Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-25T15:35:35.787

尝试在 Case 表单的 OnLoad 事件上使用此代码：

```
var menuItem = document.getElementById('_MIresolve');
if (menuItem)
  menuItem.disabled = 1; 
```

您可以 Ctrl+N 任何 CRM 页面，以便能够查看其源代码并找出控件的 ID。

# embedded - Getting Epson receipt printer to print from Arduino

> ID：603026
> 
> 赞同：12
> 
> 时间：2009-03-02T16:41:32.127
> 
> 标签：embedded, serial-port, arduino, epson

I'm trying to build a microprinter using an Arduino and an Epson TM-T88II receipt/[POS](http://en.wikipedia.org/wiki/Point_of_sale) printer. The printer uses the [Epson Esc/POS](http://en.wikipedia.org/wiki/Point_of_sale#Hardware_interface_standardization_.28post_1990s.29) system, but I can't get it to do anything at all from the Arduino. I'm doing things like:

```
#include <SoftwareSerial.h>

#define out_pin 3
#define in_pin 2
SoftwareSerial printer = SoftwareSerial(in_pin, out_pin);

void setup()
{
    pinMode(in_pin, INPUT);
    pinMode(out_pin, OUTPUT);
    printer.begin(9600);

    delay(1000);

    printer.print(0x1B, BYTE);
    printer.print('@'); // ESC(HEX 1B) @ is supposed to initialize the printer
    printer.print("hello world");
    printer.print(0xA, BYTE); // print buffer and line feed
} 
```

I just can't get the printer to respond at all. The printer powers up and prints its self test just fine. It's a serial ([RS-232](http://en.wikipedia.org/wiki/RS-232)) printer, and I'm connecting it to the Arduino through a [MAX233](http://en.wikipedia.org/wiki/MAX232) chip. I've checked and rechecked my connections through the chip, which I think are right based on a friend who has a similar setup working. I read somewhere that the TM-T88 printers need null-modem serial cables, so I bought an adapter, and that didn't seem to make any difference.

I'm new to electronics, so I'm completely stumped. I just want to get it to print something, so I can get to the fun part - the programming :). Any thoughts on things to test/try? I can give more detail on wiring or anything else, just didn't want this to get TOO long.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-03T04:18:01.700

您使用的是 RS-232 收发器吗？Arduino 输出 0 和 5 V 用于串行，而打印机使用 -12 和 12 V 用于串行。您应该使用[MAX232](http://en.wikipedia.org/wiki/MAX232)或类似设备来获得正确的物理接口。（如果你把Arduino上的串口倒过来，你可能会作弊，但这可能行不通，而且刚开始的时候更麻烦。）

一旦解决了这些问题，RTS 和 DTR 可能就是您的问题了。您应该能够更改打印机上的 DIP 开关设置并完全关闭流控制，或将其切换到软件流控制。

此外，您可能需要同时发送换行符和回车符。

但是，一旦完成所有操作，即使没有任何重置命令，它也应该可以正常打印。发送一堆 ASCII 字符和换行/回车，它会全部吐出。

您现在可以忽略 RX 线（在 Arduino 端，TX 在打印机端） - 只需发送数据，直到您弄清楚接线、电平转换、流量控制等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T03:55:28.527

我会将另一台 PC 而不是打印机连接到串行电缆的另一端，并在该系统上运行 telnet 或[PuTTY](http://en.wikipedia.org/wiki/PuTTY)，以确保您正在通过串行端口进行通信并实际进行通信。如果是这样，您可以使用相同的解决方案将数据发送到打印机以确认所有设置，例如数据位数、奇偶校验等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T19:58:18.033

您可以检查是否可以从 Arduino 和打印机与 PC 通信。

我会使用示波器来查看串行信号是否按应有的方式从 Arduino 和 MAX 输出，但您可能没有。

您确定通讯设置正确吗？您将波特率设置为 9600，但是数据位、奇偶校验位、停止位呢？控制线呢？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-29T11:25:15.617

我做了一个类似的项目并且遇到了同样的问题。您需要一根零调制解调器/交叉电缆从 max232 连接到打印机，因为两个设备都处于从属配置

# sql-server - SQL Server 维护建议？

> ID：603031
> 
> 赞同：2
> 
> 时间：2009-03-02T16:42:02.827
> 
> 标签：sql-server, performance, maintenance

我经营着一个在线摄影社区，似乎该网站在数据库访问方面陷入了爬行，有时会超时。

我认为自己相当有能力编写 SQL 查询和设计表，但绝不是 DBA ......因此问题。

一些背景：

1.  我的站点和 SQL 服务器正在远程主机上运行。我通过 SQL Server Mgmt 从 Visual Studio 和 SQL 更新 ASP.NET 代码。工作室快车。我没有对服务器的物理访问权限。

2.  我所有存储的过程（我想我都得到了）都包含在事务中。

3.  此时主表只有9400条记录。我每晚向该表添加 12 条新记录。

4.  这个主表上有一个视图，它将其他几个表中的数据汇集到一个视图中。

5.  辅助表是较小的记录，但更多。一个是 70,000，另一个是 115,000。这些是#3 中项目的评论和评分记录。

6.  索引位于最需要的字段上。我将它们设置为自动重新计算大表上的统计信息。

当站点停止运行时，如果我运行代码来清除事务日志、更新统计信息、重建主视图以及重建存储过程以获取评论，速度就会恢复。但是，我必须手动执行此操作。

可悲的是，我的用户对这些问题感到沮丧，他们的参与减少了。

所以我的问题是......在远程环境中，设置和安排维护计划以保持我的 SQL 数据库在其峰值运行的最佳方式是什么？

非常感谢！KLK

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T17:42:07.423

我的直觉说你做错了什么。这听起来有点像您听到的那些故事，除非您每晚重新启动服务器，否则某些系统无法保持正常运行:-)

您的查询有问题，您拥有的行数几乎总是与性能无关，而且您的数据库无论如何都非常小。我对 SQL Server 不太熟悉，但我想它有一些非常棒的查询分析工具。我还想象它有一种记录慢速查询的方法。

我真的听起来像您缺少索引。当然，您可能认为您已经添加了正确的索引，但在您确认正在使用之前，这并不重要。也许你认为你有正确的，但你的查询表明不是这样。

首先，弄清楚如何记录您的查询。很有可能你有一个杀手在那里做一些索引可以修复的顺序扫描。

其次，您可能有一堆小查询正在杀死它。例如，您可能有一些“用户”对象，每次您从 user_id 查找用户名时都会访问数据库。寻找你查询数据库一百次的地方并用缓存替换它——即使那个“缓存”只不过是一个在请求结束时被擦除的私有变量。

底线是，我真的怀疑它在 SQL Server 中配置错误。我的意思是，如果你因为系统停顿而不得不每晚重新启动服务器，你会责怪系统还是你的代码？同样的交易......学习 SQL Server 提供的工具，我敢打赌它们非常漂亮:-)

话虽如此，一旦你承认自己做错了什么，享受这个过程。对我来说，没有什么比优化慢速数据库查询更有趣了。令人惊奇的是，您可以使用 10 秒的运行时间将其转换为具有 50 毫秒运行时间的查询，并使用一个放置良好的索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T17:01:12.577

您无需将维护任务设置为维护计划。

只需创建一个存储过程来执行您希望执行的维护任务、索引重建、统计更新等。

然后创建一个调用您的存储过程的作业。该作业可以配置为按您想要的时间表运行。

要创建作业，请使用过程 sp_add_job。

要创建计划，请使用过程 sp_add_schedule。

我希望我所详述的内容清晰易懂，但如果您需要进一步的帮助，请随时给我留言。

干杯，约翰

# c - 代码中的真值表？如何构造状态机？

> ID：603035
> 
> 赞同：10
> 
> 时间：2009-03-02T16:43:07.580
> 
> 标签：c, state-machine, truthtable

我有一个（有点）大的真值表/状态机，需要在我的代码（嵌入式 C）中实现。我预计此状态机的行为规范将来会发生变化，因此我希望将来可以轻松修改它。

我的真值表有 4 个输入和 4 个输出。我将所有内容都保存在 Excel 电子表格中，如果我可以将其粘贴到我的代码中并进行一些格式化，那将是理想的选择。

我在想我想像这样访问我的真值表：

```
u8 newState[] = decisionTable[input1][input2][input3][input4]; 
```

然后我可以通过以下方式访问输出值：

```
setOutputPin( LINE_0, newState[0] );
setOutputPin( LINE_1, newState[1] );
setOutputPin( LINE_2, newState[2] );
setOutputPin( LINE_3, newState[3] ); 
```

但为了得到它，看起来我必须做一个相当混乱的表，如下所示：

```
static u8 decisionTable[][][][][] =
 {{{{ 0, 0, 0, 0 },
    { 0, 0, 0, 0 }},
   {{ 0, 0, 0, 0 },
    { 0, 0, 0, 0 }}},
  {{{ 0, 0, 1, 1 },
    { 0, 1, 1, 1 }},
   {{ 0, 1, 0, 1 },
    { 1, 1, 1, 1 }}}},
 {{{{ 0, 1, 0, 1 },
    { 1, 1, 1, 1 }},
   {{ 0, 1, 0, 1 },
    { 1, 1, 1, 1 }}},
  {{{ 0, 1, 1, 1 },
    { 0, 1, 1, 1 }},
   {{ 0, 1, 0, 1 },
    { 1, 1, 1, 1 }}}}; 
```

那些嵌套的括号可能有点令人困惑——有没有人对如何在我的代码中保持漂亮的表格有更好的想法？

谢谢！

**根据 HUAGHAGUAH 的回答进行编辑：**

结合每个人的输入（谢谢——我希望我能“接受”这些答案中的 3 个或 4 个），我想我会尝试将它作为一个二维数组。我将使用一个小的位移宏来索引我的数组：

```
#define SM_INPUTS( in0, in1, in2, in3 ) ((in0 << 0) | (in1 << 1) | (in2 << 2) | (in3 << 3)) 
```

这将使我的真值表数组看起来像这样：

```
static u8 decisionTable[][] = {
{ 0, 0, 0, 0 },
{ 0, 0, 0, 0 },
{ 0, 0, 0, 0 },
{ 0, 0, 0, 0 },
{ 0, 0, 1, 1 },
{ 0, 1, 1, 1 },
{ 0, 1, 0, 1 },
{ 1, 1, 1, 1 },
{ 0, 1, 0, 1 },
{ 1, 1, 1, 1 },
{ 0, 1, 0, 1 },
{ 1, 1, 1, 1 },
{ 0, 1, 1, 1 },
{ 0, 1, 1, 1 },
{ 0, 1, 0, 1 },
{ 1, 1, 1, 1 }}; 
```

然后我可以像这样访问我的真值表：

```
decisionTable[ SM_INPUTS( line1, line2, line3, line4 ) ] 
```

我会试一试，看看效果如何。我还将用更有用的 #defines 替换 0 和 1，这些 #defines 表达了每个状态的含义，以及解释每行输出的输入的 /**/ 注释。谢谢大家的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T16:53:32.550

我建议（首选方法优先）：

*   使用宏初始化每个“行” - 这将隐藏宏调用中的大括号。
*   使用注释来拆分行。
*   使用 init 函数显式初始化上下文 - 可能使用函数来初始化每个部分。这类似于上面的第一个选项，但缺点是必须在使用状态机之前调用 init 函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T16:47:31.173

就个人而言，我会从配置文件中读取它。也许是 CSV，它很容易从 Excel 导出。或者，您可以从 Excel 中复制并粘贴到纯文本中，从而为您提供以空格分隔的值，这同样易于导入。

这也意味着，鉴于您正在使用 C，您不必在每次决策表更改时重新编译代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T17:10:21.510

不需要多维表。使用 4 位 => 4 位映射，您可以有一个 u8[16] 数组将输入映射到输出。状态查找会便宜得多，并且您可以使用一些移位和掩码操作来提取单个位。

如果填充行的算法易于编码，您可以#define 一个宏来按索引号填充每一行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T17:03:38.000

如果你的真值表都是布尔值，你可以把它折叠成一个对列表，例如

```
1111,0000
1110,0110
... 
```

对于数据压缩，将值表示为字节（两个 nybbles）...

在哪里/如何存储它以在您的特定嵌入式系统配置中进行软编码，只有您可以说;-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T17:10:08.110

如果真值表真的只有 4x4x4x4，那么我会使用宏。如果它要超过那个，我会使用[Ragel](http://www.complang.org/ragel/)。很有可能它会比你编写更小、更快的 C 代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T17:12:31.207

为了获取您的输出状态，我没有看到对当前状态的任何引用。这意味着它不是一个状态机，而只是一个真值表。有四个输入，因此只有 16 种可能的输入组合。所以，一张有 16 个位置的桌子应该可以做到。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T17:43:38.497

通常当你遇到这样的问题时，人们会尝试将其简化为一个简单的布尔公式。我不明白为什么这不是最好的方法。它会更紧凑，更易读，而且它有可能更快（我想少数 AND 和 OR 将比查找表方法所需的乘法/移位 + 内存访问的集合执行得更快）。将此表简化为布尔公式的最简单方法是使用[K-Map](http://en.wikipedia.org/wiki/Karnaugh_map)。

# javascript - 需要帮助理解 jQuery .val() 函数

> ID：603040
> 
> 赞同：1
> 
> 时间：2009-03-02T16:44:42.303
> 
> 标签：javascript, jquery

```
alert("data going into $hidden: " + selected.data[1]);

hidden.val(selected.data[1]);

alert("data now in $hidden: " + $hidden.val()); 
```

上面最后一行中的 $hidden.val() 返回未定义的原因是什么？我已经验证 selected.data[1] 包含一个整数值。

**编辑#1：**每条评论的一些额外上下文：（$hidden 是一个隐藏的输入字段）

```
$.fn.extend({
    autocomplete: function(urlOrData, hidden, options) {
        var isUrl = typeof urlOrData == "string";
        var $hidden = $(hidden);
        options = $.extend({}, $.Autocompleter.defaults, {
            url: isUrl ? urlOrData : null,
            data: isUrl ? null : urlOrData,
            delay: isUrl ? $.Autocompleter.defaults.delay : 10,
            max: options && !options.scroll ? 10 : 150
        }, options);

        // if highlight is set to false, replace it with a do-nothing function
        options.highlight = options.highlight || function(value) { return value; };

        // if the formatMatch option is not specified, then use formatItem for backwards compatibility
        options.formatMatch = options.formatMatch || options.formatItem;

        return this.each(function() {
            new $.Autocompleter(this, options, $hidden);
        }); 
```

和...

```
$.Autocompleter = function(input, options, $hidden) {
        //... 

        function selectCurrent() {
            var selected = select.selected();
            if (!selected)
                return false;

            var v = selected.result;
            previousValue = v;

            if (options.multiple) {
                var words = trimWords($input.val());
                if (words.length > 1) {
                    v = words.slice(0, words.length - 1).join(options.multipleSeparator) + options.multipleSeparator + v;
                }
                v += options.multipleSeparator;
            }

            alert("data going into $hidden: " + selected.data[1]);

            $hidden.val(selected.data[1]);

            alert("data now in $hidden: " + $hidden.val()); 
```

**编辑#2：** 更多细节......我正在尝试在具有多个文本框控件（每个都实现自动完成）的表单上使用 jQuery 自动完成扩展。每个文本框旁边的表单上有一个单独的按钮，该按钮将表单提交给处理函数，该处理函数需要查找所选项目的值并将其保存到数据库中。我想解决这个问题的方法是在表单上包含一个隐藏字段来保存所选值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T20:20:51.193

谢谢保罗·贝甘蒂诺。我发现我没有在隐藏字段 id 前使用 # 传递初始 hidden in，因此 $hidden 从未正确设置。我很难调试，因为自动完成功能在 ascx 控件中作为嵌入式资源。一旦我确保 hidden 的值包括 # 它可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T16:58:43.723

$hidden 可以是未选中的复选框吗？

# mysql - MySQL中的快速页面检索，索引使用情况？

> ID：603041
> 
> 赞同：1
> 
> 时间：2009-03-02T16:44:52.227
> 
> 标签：mysql, performance, indexing, paging

我想加快一个基本上按照以下模式检索数据页面的 MySQL 查询

```
select
 my_field_A,
 my_field_B
where
 time_id >= UNIX_TIMESTAMP('1901-01-01  00:00:00') AND
 time_id < UNIX_TIMESTAMP('2009-01-16  00:00:00') 
```

该字段`time_id`是一个 MySQL 索引，但是，查询的行为就像在每次查询时都读取了整个数据库（检索几行已经很慢了）。我不是 MySQL 专家。有人能猜到我做错了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T16:48:34.963

确保您在 time_id 上有一个索引（B-tree），这对于范围查询应该是有效的。还要确保 time_id 采用适当的时间格式。

如果您真的想了解 mysql 在做什么，您可以在查询前面添加关键字“解释”并在您的 mysql 客户端中运行它。这将显示一些关于 mysql 正在做什么以及执行什么样的扫描的信息。

[http://dev.mysql.com/doc/refman/5.0/en/using-explain.html](http://dev.mysql.com/doc/refman/5.0/en/using-explain.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T16:48:19.037

由于可能有很多`time_id`' 符合这些标准，`MySQL`因此可能认为全表扫描更好。

尝试强制索引：

```
SELECT
 my_field_A,
 my_field_B
FROM mytable FORCE INDEX (index_name_on_time_id)
WHERE
 time_id >= UNIX_TIMESTAMP('1901-01-01  00:00:00') AND
 time_id < UNIX_TIMESTAMP('2009-01-16  00:00:00') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T13:14:43.767

你需要更低的范围吗？有早于 1901 年的条目吗？time_id 列是如何生成的？如果每次将新条目添加到 DB 时 time_id 总是更大，您可能需要考虑查找与 2009-01-16 最接近的条目的 ID，然后按 ID 选择

```
select my_field_A, my_field_B
FROM
  mytable
WHERE
  id <= ? 
```

如果不是这种情况，请尝试检查 MySQL 5.1 中可用的分区并按年分解表，这应该会显着提高速度。

# cocoa - 如果您不需要使预定的 NSTimer 无效，是否有任何理由保留它？

> ID：603044
> 
> 赞同：3
> 
> 时间：2009-03-02T16:45:19.120
> 
> 标签：cocoa, macos, nstimer

我要回顾一些粗略的代码来整理它，我看到我一直保留从返回的 NSTimers`scheduledTimerWithTimeInterval:target:selector:userInfo:repeats:`并将它们存储在一个字段中 - 然后在它触发时释放并清空该字段。在某些情况下，我稍后会使用计时器向其发送无效消息 - 但在许多情况下不会。

在最近的代码中，我通常只是安排计时器并忘记它。我知道构造函数方法是自动释放的，并且计时器在它处于活动状态时由运行循环保留 - 所以我认为这没有任何问题。

所以，只是为了完善我的理解——还有其他原因我应该坚持我的计时器，还是我现在正在做的事情是公认的习语？

这都是在 iPhone 代码的上下文中，但我不认为这是特定于 iPhone 的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T16:47:59.193

我只是让运行循环处理保留，我自己 - 拥有计时器而不是我的是运行循环。如果你明白我的意思。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T17:02:33.697

我在回答我自己的问题。

我主要是在问这个问题，因为我一直在浏览类参考文档，而这个问题并没有真正弄清楚。我已经阅读了 ADC 中的 Timer Programming Topics：Using Timers 文章，它很好地涵盖了它——尤其是最后关于内存管理的部分。

根据我现在正在做的事情（只是安排，除非我需要能够调用 invalidate 或 isValid 等）是正确的方法。

# php - 如何使用 jQuery、PHP 和 MySQL 实现聊天？

> ID：603046
> 
> 赞同：4
> 
> 时间：2009-03-02T16:47:11.817
> 
> 标签：php, sockets

我使用 php、mysql 和 jquery 制作了一个聊天脚本。它使用 json 从服务器获取数据。它使用最后获取的消息 id 向服务器发出固定间隔的请求，以从服务器获取新消息。但是当多个用户聊天时，一个小时内就会向服务器发出成千上万的请求，而托管人肯定会阻止它。

我认为 gmail 聊天使用套接字。因为它肯定不会发送固定间隔的请求。你们中的任何人都可以给我一些示例代码或一些解决这个问题的方向。

请我迫切需要帮助。

提前谢谢了。我对所有人的尊重和问候。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T16:58:35.780

如果您使用的主机在发出这么多请求时会“肯定地阻止它”，那么您可能需要考虑获取不同的主机或升级您的托管包，然后再担心您的代码。看看[Facebook 如何实现他们的聊天：](http://www.facebook.com/note.php?note_id=14218138919)

> 我们选择从一个用户向另一个用户获取文本的方法包括在每个 Facebook 页面上加载一个 iframe，并让该 iframe 的 Javascript 通过持久连接发出 HTTP GET 请求，该请求在服务器为客户端提供数据之前不会返回。如果请求被中断或超时，它将重新建立。这绝不是一种新技术：它是 Comet 的变体，特别是 XHR 长轮询和/或 BOSH。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T17:25:53.313

您可能会发现使用 Prototype 的 comet 守护程序和[jetty 网络服务器](http://www.mortbay.org/jetty/)查看“彗星”技术的示例很有用。码头下载中的示例代码有一个用于聊天的示例应用程序。

我最近自己安装了 jetty，所以你可能会发现我的安装命令日志很有用：

开始尝试运行彗星服务

[从http://maven.apache.org/](http://maven.apache.org/)下载 Maven

[使用http://maven.apache.org/download.html#Installation](http://maven.apache.org/download.html#Installation)安装 Maven 我做了以下命令提取到 /home/sdwyer/apache-maven-2.0.9

```
> sdwyer@pluto:~/apache-maven-2.0.9$ export M2_HOME=/home/sdwyer/apache-maven-2.0.9
> sdwyer@pluto:~/apache-maven-2.0.9$ export M2=$M2_HOME/bin
> sdwyer@pluto:~/apache-maven-2.0.9$ export PATH=$M2:$PATH.
> sdwyer@pluto:~/apache-maven-2.0.9$ mvn --version
-bash: /home/sdwyer/apache-maven-2.0.9/bin/mvn: Permission denied

> sdwyer@pluto:~/apache-maven-2.0.9$ cd bin
> sdwyer@pluto:~/apache-maven-2.0.9/bin$ ls
m2 m2.bat m2.conf mvn mvn.bat mvnDebug mvnDebug.bat

> sdwyer@pluto:~/apache-maven-2.0.9/bin$ chmod +x mvn

> sdwyer@pluto:~/apache-maven-2.0.9/bin$ mvn –version

Maven version: 2.0.9
Java version: 1.5.0_08
OS name: “linux” version: “2.6.18-4-686″ arch: “i386″ Family: “unix”
sdwyer@pluto:~/apache-maven-2.0.9/bin$ 
```

[从http://www.mortbay.org/jetty/](http://www.mortbay.org/jetty/)下载 jetty 服务器 解压到 /home/sdwyer/jetty-6.1.3

```
> sdwyer@pluto:~$ cd jetty-6.1.3//examples/cometd-demo

> mvn jetty:run 
```

运行整个下载堆栈

完成后打开浏览器并将其指向： `http://localhost:8080`并测试演示。

示例演示的代码可以在目录中找到：

```
jetty-6.1.3/examples/cometd-demo/src/main/webapp/examples 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T17:26:12.797

对或错，托管公司可能会因为以下几个原因而变得暴躁：

1) 他们使用 apache prefork 的可能性很大。每个聊天请求都​​可能是一个新连接，因此占用了一个 apache 进程。每个 apache 进程占用 1mb 到 100mb 的内存。

2）如果他们维护数据库服务器，而您，客户，在数据库编程方面很烂，您可以锤击他们的数据库。“吮吸”意味着从“没有正确的索引”到“进行大量微小查询而不是漂亮的胖查询”。

正如上面所建议的，确保您的代码使用持久连接。还：

1）在客户端上实现退避算法。在活动期间每秒轮询服务器一次，然后退回到五秒，然后是十、二十等……这样你就不会在没有活动时敲击服务器。

2）多个标签会杀了你。用户打开 10 个选项卡，它们都让您的聊天小部件每秒轮询服务器一次？坏消息。即使您的主机没有生气，您的性能也会下降。

如果这个东西变得很大，那么设计你的系统，让你可以独立于你的 web 应用程序的其余部分运行聊天服务器位。换句话说，客户端将向“chat.yourwebapp.com”发出请求，而后者又在 lighttpd 之类的东西上运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-20T15:00:57.940

在javascript中尝试套接字

[http://code.google.com/p/jsocket/](http://code.google.com/p/jsocket/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T17:07:54.870

楼主为什么要屏蔽？您对页面发出标准的 http 请求，如果您的主机不允许，那么是时候切换了。

至于使用套接字，没有通过javascript连接到套接字的本机能力，尽管我相信JSocket是一个允许您通过实际连接到服务器的嵌入式闪存桥接套接字的库。还没有寻找执行此操作的 jquery 插件，可能是其中之一。

您的服务器端代码也会发生巨大变化（持久性与轮询非常不同），因此您可以为您完成工作。

我建议只做你正在做的事情，如果它无法处理它，就升级你的主机。除非您一次要拥有大量用户？一个缓存系统，这样你就不会在每个请求上都访问数据库，如果它变得那么忙，它可能会加快速度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-20T15:50:10.583

您考虑在页面中嵌入一个小型 Flash 电影，然后使用套接字来处理与服务器的通信。这将减轻服务器的大量负载，并使所有内容保持同步变得更加容易。UI 仍然可以使用 JavaScript 制作。
您将继续使用您的 JavaScript 解决方案，然后默默地忽略我的回答 :-)

# arrays - 填充表格数据的打印输出

> ID：603047
> 
> 赞同：11
> 
> 时间：2009-03-02T16:47:12.157
> 
> 标签：arrays, ruby, formatting

我知道这可能很简单，但我在一个文件中有一些数据，例如：

```
Artichoke

Green Globe, Imperial Star, Violetto

24" deep

Beans, Lima

Bush Baby, Bush Lima, Fordhook, Fordhook 242

12" wide x 8-10" deep 
```

我希望能够格式化成一个漂亮的 TSV 类型的表格，看起来像这样：

```
 Name  | Varieties    | Container Data
----------|------------- |-------
some data here nicely padded with even spacing and right aligned text 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-02T17:22:13.510

尝试[`String#rjust(width)`](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-rjust)：

```
"你好".rjust(20) #=> "你好"

```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-06-01T16:32:50.407

我写了一个宝石来做到这一点： http: [//tableprintgem.com](http://tableprintgem.com)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-07-31T19:34:53.233

没有人提到过“最酷”/最紧凑的方式——使用`%`操作符——例如：`"%10s %10s" % [1, 2]`. 这是一些代码：

```
xs = [
  [“这个代码”，“是”，“确实”]，
  [“非常”，“紧凑”，“和”]，
  [“我希望你会”，“找到”，“它有帮助！”]，
]
m = xs.map { |_| _。长度 }
xs.each { |_| _.each_with_index { |e, i| s = e.size; m[i] = s 如果 s > m[i] } }
xs.each { |x| 放 m.map { |_| "%#{_}s" }.join(" " * 5) % x }

```

给出：

```
      这段代码确实
           非常紧凑和
我希望你会发现它有帮助！

```

这是使代码更具可读性：

```
最大长度 = xs.map { |_| _。长度 }
xs.each 做 |x|
  x.each_with_index 做 |e, i|
    s = e.size
    max_lengths[i] = s 如果 s > max_lengths[i]
  结尾
结尾
xs.each 做 |x|
  格式 = max_lengths.map { |_| "%#{_}s" }.join(" " * 5)
  放置格式 % x
结尾

```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-02T17:43:15.050

这是一个相当完整的示例，假设如下

*   您的产品列表包含在一个名为 veg.txt 的文件中
*   您的数据排列在每条记录的三行中，字段位于连续行上

我对rails有点菜鸟，所以毫无疑问有更好、更优雅的方法来做到这一点

```
#!/usr/bin/ruby

class Vegetable

  @@max_name ||= 0  
  @@max_variety ||= 0  
  @@max_container ||= 0  

  attr_reader :name, :variety, :container

  def initialize(name, variety, container)
    @name = name
    @variety = variety
    @container = container  

    @@max_name = set_max(@name.length, @@max_name)  
    @@max_variety = set_max(@variety.length, @@max_variety)  
    @@max_container = set_max(@container.length, @@max_container)
  end

  def set_max(current, max)
    current > max ? current : max
  end

  def self.max_name  
    @@max_name  
  end  

  def self.max_variety  
    @@max_variety  
  end  

  def self.max_container()  
    @@max_container  
  end  

end

    products = []

    File.open("veg.txt") do | file|

      while name = file.gets
        name = name.strip
        variety = file.gets.to_s.strip
        container = file.gets.to_s.strip
        veg = Vegetable.new(name, variety, container)
        products << veg
      end
    end

    format="%#{Vegetable.max_name}s\t%#{Vegetable.max_variety}s\t%#{Vegetable.max_container}s\n"
    printf(format, "Name", "Variety", "Container")
    printf(format, "----", "-------", "---------")
    products.each do |p|
        printf(format, p.name, p.variety, p.container)
    end 
```

以下示例文件

```
朝鲜蓟
绿色地球，帝国之星，紫罗兰
24" 深
豆类，利马
布什宝贝，布什利马，福特胡克，福特胡克 242
12" 宽 x 8-10" 深
土豆
爱德华国王，西瑞，泽西皇家
36" 宽 x 8-10" 深

```

产生以下输出

```
       名称 品种容器
       ---- -------- ---------
  朝鲜蓟绿球，帝王星，紫罗兰 24" 深
豆，利马布什婴儿，布什利马，福特胡克，福特胡克 242 12 英寸宽 x 8-10 英寸深
   土豆 King Edward, Desiree, Jersey Royal 36" 宽 x 8-10" 深

```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-03-06T22:15:27.197

我有一个小功能可以将二维数组打印为表格。每行必须有相同数量的列才能工作。它也很容易根据您的需求进行调整。

```
def print_table(table)
  # Calculate widths
  widths = []
  table.each{|line|
    c = 0
    line.each{|col|
      widths[c] = (widths[c] && widths[c] > col.length) ? widths[c] : col.length
      c += 1
    }
  }
  # Indent the last column left.
  last = widths.pop()
  format = widths.collect{|n| "%#{n}s"}.join(" ")
  format += " %-#{last}s\n"
  # Print each line.
  table.each{|line|
    printf format, *line
  }
end 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-11-05T15:49:22.713

另一个 gem：[https](https://github.com/visionmedia/terminal-table) ://github.com/visionmedia/terminal-table Terminal Table 是一个快速简单，但功能丰富的 ASCII 表生成器，用 Ruby 编写。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T17:17:19.090

[Kernel.sprintf](http://www.ruby-doc.org/core/classes/Kernel.html#M005984)应该可以帮助您入门。

# javascript - 如何使用 iGoogle 上的可拖动部分？

> ID：603059
> 
> 赞同：8
> 
> 时间：2009-03-02T16:49:46.020
> 
> 标签：javascript, igoogle

查看 iGoogle 时，可以将每个部分拖放到页面上的任何其他位置，然后保存页面状态。我很好奇这是如何完成的，因为我想提供此功能作为概念证明的一部分？

**更新**

你是如何做到的，以便保存你更改为的布局以供下次加载？我猜这是某种饼干？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T16:51:43.740

任何最新的客户端框架都会提供这种功能。

*   [jQuery](http://jquery.com/)
*   [小唯](http://developer.yahoo.com/yui/)
*   [GWT](http://code.google.com/webtoolkit/)
*   [原型](http://www.prototypejs.org/)

仅举几个...

关于数据的“保存”（持久性，如果您愿意的话），这取决于您网站的后端，但这通常是通过对服务器的异步调用来完成的，该服务器将状态保存到数据库（通常）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-02T20:10:54.587

[NETTUTS 有一个关于将其中一个与 jQuery 放在一起的教程](http://net.tutsplus.com/tutorials/javascript-ajax/inettuts/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T16:52:25.407

[使用jQuery](http://jquery.com/)非常简单。查看有关该主题的[此博客条目](http://geekswithblogs.net/AzamSharp/archive/2008/02/21/119882.aspx)。

**编辑：**当我回答时，我错过了问题的“页面状态已保存”部分。该部分将根据您构建应用程序的方式而有很大差异。您需要以某种方式存储页面的状态，这将取决于用户。如果您不介意每次清除 cookie 缓存时都强制用户恢复他们的偏好，您可以使用 cookie 存储状态。

我不知道您的应用程序是如何构建的，所以我无法提出任何进一步的建议，但是在 jQuery 中存储 cookie 也非常简单。[这篇博](http://www.shopdev.co.uk/blog/cookies-with-jquery-designing-collapsible-layouts/)文的第一部分几乎告诉你你需要知道的一切。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T16:53:56.557

我不想对此给出简短的回答，但是有几十个不同的 JavaScript 库提供了这种类型的功能，并且谷歌上有很多教程和操作指南：

[http://www.google.com/search?q=javascript+draggable](http://www.google.com/search?q=javascript+draggable)

您可能想看看一些 JavaScript 库/框架：

*   [jQuery](http://jquery.com/)
*   [MooTools](http://mootools.net/)
*   [雅虎用户界面 (YUI) 库](http://developer.yahoo.com/yui/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T17:07:12.470

这里没有提到的一种方法是，从 2.0 框架中的 ASP.NET 开始，微软推出了一种称为 WebParts 的东西，它能够构建可以以相同方式拖放和放置的控件。这应该是用户创建自己的 Web 2.0 风格门户的一种简单方法。

# c# - 用于显示图形和突出显示兴趣点的自定义 WPF 控件

> ID：603063
> 
> 赞同：0
> 
> 时间：2009-03-02T16:51:55.377
> 
> 标签：c#, wpf, custom-controls

问大家一个问题，我负责开发一个应用程序来查看我们为环境筛选所做的测试周期的数据，产品被放置在环境控制中，在运行各种自检的同时冷冻和加热产品。我的经理希望将温度随时间变化的图表显示为 x/y 图表，但他还希望有一个指示当前测试所在位置的指示器，该指示器有一个小框，提供更多信息，（测试状态，当前测试，运行时间等）

所以我在想的是我需要制作一个能够显示此散点图的自定义控件，并且还可以为我的附加信息框包含另一个内容控件，我应该使用什么基本控件作为基础，我应该看什么用于绘制我的图表，我该如何为此进行布局？我假设使用画布控件是我布局的最佳选择，而带有 PathFigures 的 DrawingGroups 是图形的最佳选择……谁能给我更多指导？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T22:43:54.897

[VisiFire](http://visifire.com/)也许是您的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T16:53:48.383

也许你应该看看 Sacha Barber 的[WPF Graph Control](http://www.codeproject.com/KB/WPF/WPFTickerGraph.aspx)。这可能是一个很好的起点

# javascript - “？：^”正则表达式是什么意思？

> ID：603069
> 
> 赞同：13
> 
> 时间：2009-03-02T16:52:55.187
> 
> 标签：javascript, regex

我正在查看这个子表达式（这是在 JavaScript 中）：

```
(?:^|.....) 
```

我知道**吗？**当它跟随一个字符时表示“零次或一次”，但不确定在这种情况下它意味着什么。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-02T17:21:44.930

使用组时，您通常有几个选项可以修改组的行为：

```
(foo)     // default behavior, matches "foo" and stores a back-reference
(?:foo)   // non-capturing group: matches "foo", but doesn't store a back-ref
(?i:foo)  // matches "foo" case-insensitively
(?=foo)   // matches "foo", but does not advance the current position
          // ("positive zero-width look-ahead assertion")
(?!foo)   // matches anything but "foo", and does not advance the position 
          // ("negative zero-width look-ahead assertion") 
```

仅举几例。

它们都以“？”开头，这是表示组修饰符的方式。在这种情况下，问号与可选性无关。

它只是说：

```
(?:^foo)  // match "foo" at the start of the line, but do not store a back-ref 
```

有时，存储对您无论如何都不会使用的匹配部分的反向引用只是矫枉过正。当组只是为了使复杂的表达式原子化（例如，它应该作为一个整体匹配或失败），存储反向引用是不必要的资源浪费，甚至可能会减慢正则表达式的速度。有时，您只想成为*与您相关的第一组*，而不是*regex 中的第一组*。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-02T16:55:35.663

您可能会在这种情况下看到它

```
(?:...) 
```

这意味着该组不会被捕获或用于反向引用。

**编辑：**为了反映您修改后的问题：

```
(?:^|....) 
```

表示“匹配行首或匹配...”，但不要捕获组或将其用于反向引用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T16:56:27.660

`(?:some stuff)`表示您不想单独匹配括号中的表达式。通常，在括号中分组的正则表达式的部分是分组的，可以单独引用（这称为使用反向引用）。

见[http://www.regular-expressions.info/brackets.html](http://www.regular-expressions.info/brackets.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-02T18:34:03.180

## 简答

它将（括号中的）组标记[为非捕获](http://www.regular-expressions.info/brackets.html)组。

## 关于此特定表达式的详细信息

非捕获组的表示法是：

```
(?:<expresson>) 
```

在您提供的实例中，插入符号 (^) 是表达式的一部分，而不是捕获组表示法的一部分。而这个实例也不是特殊字符。

看起来他们正在使用带有插入符号的“或”运算符（管道）。因此，他们希望匹配插入符号或管道右侧的任何内容，但不将表达式捕获为一个组（`?:`在分组字符的开头完成。

## 一般来说

非捕获组允许您以不可[反向引用](http://www.regular-expressions.info/brackets.html)的方式对表达式进行分组，并且还将提高表达式的性能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T16:58:12.227

*“(?:x) 匹配 'x' 但不记得匹配项。”*

[https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Regular_Expressions](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Regular_Expressions)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T16:55:29.160

?：一般表示将该组设为非捕获。[你可以在这里](http://www.regular-expressions.info/named.html)做一些研究。

我几乎肯定任何正则表达式引擎都应该，但是当我在引擎之间切换时，我遇到了一些怪癖。

编辑：应该是这样，非捕获似乎工作正常。

# class - 如何动态创建 WMI 属性？

> ID：603074
> 
> 赞同：0
> 
> 时间：2009-03-02T16:54:09.660
> 
> 标签：class, properties, wmi

当用户检索我的类的实例时，我想动态创建属性。用 c++ 实现，但 Put 不能动态创建属性。

有人可以指出我需要用来用属性和值动态“填充”一个空类的函数吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T17:54:54.507

我不确定你可以，或者至少不能直接，因为 WMI 类需要预先定义。但是，您可以与具有 Name 和 Value 属性的 WMI 类的多个实例相关联。

# windows - fgets() 的替代方案？

> ID：603075
> 
> 赞同：1
> 
> 时间：2009-03-02T16:54:21.080
> 
> 标签：windows, visual-c++

**描述：**

*   从可执行文件中获取输出

**笔记：**

*   由于 fgets() 声明，无法编译

**问题：**

*   fgets 的最佳替代方案是什么，因为 fgets 需要 char *？
*   有更好的选择吗？

**插图：**

```
void Q_analysis (const char *data)
{
string buffer;
size_t found;
found = buffer.find_first_of (*data);

FILE *condorData = _popen ("condor_q", "r");
while (fgets (buffer.c_str(), buffer.max_size(), condorData) != NULL)
{
    if (found == string::npos)
    {
        Sleep(2000);
    } else {
        break;
    }
}
return;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T17:05:33.177

您应该对字符串 [cppreference使用 string.getline 函数](http://www.cppreference.com/wiki/string/getline)

但是，在您的情况下，您应该使用 char[] 来读取。

例如

```
string s;
char buffer[ 4096 ];
fgets(buffer, sizeof( buffer ), condorData);
s.assign( buffer, strlen( buffer )); 
```

或您的代码：

```
void Q_analysis( const char *data )
{
    char buffer[ 4096 ];

    FILE *condorData = _popen ("condor_q", "r");
    while( fgets( buffer, sizeof( buffer ), condorData ) != NULL )
    {
        if( strstr( buffer, data ) == NULL )
        {
                Sleep(2000);
        }
        else
        {
                break;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T17:12:05.967

与其将缓冲区声明为字符串，不如将其声明为：

```
char buffer[MY_MAX_SIZE] 
```

用它调用 fgets，然后在需要时从缓冲区构建字符串，而不是采用其他方式。

您所做的事情不起作用的原因是您将缓冲区内容的*副本*作为 c 样式字符串获取，而不是指向缓冲区内部的指针。根据设计，它是只读的。

——马库斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T17:14:52.420

你是对的，你不能直接读入 a`std::string`因为它`c_str`和`data`方法都返回 const 指针。您可以改为阅读 a `std::vector<char>`。

您也可以使用该`getline`功能。但它需要一个 iostream 对象，而不是 C 文件指针。但是，您可以通过特定于供应商的方式从一个到另一个。有关如何从一种文件类型转换到另一种文件类型的图表和一些建议，请参阅“[处理句柄的便捷指南”。](http://www.flounder.com/handles.htm)调用`fileno`你`FILE*`来获取一个数字文件描述符，然后用`fstream::attach`它来将它与一个`fstream`对象相关联。然后你可以使用`getline`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T17:16:19.297

试试 boost 库 - 我相信它具有从 FILE* 创建 fstream 的功能

或者您可以使用 fileno() 从 FILE 获取标准 C 文件句柄，然后使用 fstream::attach 将流附加到该文件。从那里你可以使用 getline() 等。像这样的东西：

```
FILE *condorData = _popen ("condor_q", "r");
std::ifstream &stream = new std::ifstream();
stream.attach(_fileno(condorData)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-08T05:51:56.257

我还没有很好地测试它，但下面似乎可以完成这项工作：

```
//! read a line of text from a FILE* to a std::string, returns false on 'no data'
bool stringfgets(FILE* fp, std::string& line)
{
  char buffer[1024];
  line.clear();

  do {
    if(!fgets(buffer, sizeof(buffer), fp))
      return !line.empty();

    line.append(buffer); 
  } while(!strchr(buffer, '\n'));
  return true;
} 
```

但是请注意，这将愉快地读取 100G 行文本，因此必须注意这不是来自不受信任的源文件或套接字的 DoS 向量。

# asp.net - 如何在asp.net中传递加密的查询字符串

> ID：603092
> 
> 赞同：7
> 
> 时间：2009-03-02T17:03:55.660
> 
> 标签：asp.net

我需要在 asp.net 页面之间传递值。如何加密 URL 中的这些值？示例：Response.Redirect("customerAdd.aspx?customerId=" + custId);

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-02T17:19:43.250

查看[Mads Kristensen 的](http://madskristensen.net/)文章，了解将加密/解密所有查询字符串的 HttpModule。 [http://madskristensen.net/post/httpmodule-for-query-string-encryption](http://madskristensen.net/post/httpmodule-for-query-string-encryption)

他的代码使用 HttpModule 解析传出的 HTML 以加密和替换所有相对路径查询字符串。HttpModule 还捕获传入请求并重写请求 url 以使用未加密的查询字符串。

好的部分是您可以放入模块，并且您的代码不需要知道查询字符串何时被加密。从代码的角度来看，查询字符串的工作方式与往常一样。

我们已经使用它五年多了，而且效果很好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T17:12:03.317

愚蠢的长代码文件将使用完全加密为您完成：

我建议使用 SessionID 作为盐，然后它会为每个用户更改，但在回发时是稳定的。

```
///////////////////////////////////////////////////////////////////////////////
// SAMPLE: Symmetric key encryption and decryption using Rijndael algorithm.
// 
// To run this sample, create a new Visual C# project using the Console
// Application template and replace the contents of the Class1.cs file with
// the code below.
//
// THIS CODE AND INFORMATION IS PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND, 
// EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED 
// WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR PURPOSE.
// 
// Copyright (C) 2002 Obviex(TM). All rights reserved.
// 
using System;
using System.IO;
using System.Text;
using System.Security.Cryptography;
namespace TDX.Portal.Utilities
{
    /// <summary>
    /// This class uses a symmetric key algorithm (Rijndael/AES) to encrypt and 
    /// decrypt data. As long as encryption and decryption routines use the same
    /// parameters to generate the keys, the keys are guaranteed to be the same.
    /// The class uses static functions with duplicate code to make it easier to
    /// demonstrate encryption and decryption logic. In a real-life application, 
    /// this may not be the most efficient way of handling encryption, so - as
    /// soon as you feel comfortable with it - you may want to redesign this class.
    /// </summary>
    public class RijndaelSimple
    {
        /// <summary>
        /// Encrypts specified plaintext using Rijndael symmetric key algorithm
        /// and returns a base64-encoded result.
        /// </summary>
        /// <param name="plainText">
        /// Plaintext value to be encrypted.
        /// </param>
        /// <param name="passPhrase">
        /// Passphrase from which a pseudo-random password will be derived. The
        /// derived password will be used to generate the encryption key.
        /// Passphrase can be any string. In this example we assume that this
        /// passphrase is an ASCII string.
        /// </param>
        /// <param name="saltValue">
        /// Salt value used along with passphrase to generate password. Salt can
        /// be any string. In this example we assume that salt is an ASCII string.
        /// </param>
        /// <param name="hashAlgorithm">
        /// Hash algorithm used to generate password. Allowed values are: "MD5" and
        /// "SHA1". SHA1 hashes are a bit slower, but more secure than MD5 hashes.
        /// </param>
        /// <param name="passwordIterations">
        /// Number of iterations used to generate password. One or two iterations
        /// should be enough.
        /// </param>
        /// <param name="initVector">
        /// Initialization vector (or IV). This value is required to encrypt the
        /// first block of plaintext data. For RijndaelManaged class IV must be 
        /// exactly 16 ASCII characters long.
        /// </param>
        /// <param name="keySize">
        /// Size of encryption key in bits. Allowed values are: 128, 192, and 256\. 
        /// Longer keys are more secure than shorter keys.
        /// </param>
        /// <returns>
        /// Encrypted value formatted as a base64-encoded string.
        /// </returns>
        public static string Encrypt(string plainText,
                                     string passPhrase,
                                     string saltValue,
                                     string hashAlgorithm,
                                     int passwordIterations,
                                     string initVector,
                                     int keySize)
        {
            // Convert strings into byte arrays.
            // Let us assume that strings only contain ASCII codes.
            // If strings include Unicode characters, use Unicode, UTF7, or UTF8 
            // encoding.
            byte[] initVectorBytes = Encoding.UTF8.GetBytes(initVector);
            byte[] saltValueBytes = Encoding.UTF8.GetBytes(saltValue);

            // Convert our plaintext into a byte array.
            // Let us assume that plaintext contains UTF8-encoded characters.
            byte[] plainTextBytes = Encoding.UTF8.GetBytes(plainText);

            // First, we must create a password, from which the key will be derived.
            // This password will be generated from the specified passphrase and 
            // salt value. The password will be created using the specified hash 
            // algorithm. Password creation can be done in several iterations.
            PasswordDeriveBytes password = new PasswordDeriveBytes(
                                                            passPhrase,
                                                            saltValueBytes,
                                                            hashAlgorithm,
                                                            passwordIterations);

            // Use the password to generate pseudo-random bytes for the encryption
            // key. Specify the size of the key in bytes (instead of bits).
            byte[] keyBytes = password.GetBytes(keySize / 8);

            // Create uninitialized Rijndael encryption object.
            RijndaelManaged symmetricKey = new RijndaelManaged();

            // It is reasonable to set encryption mode to Cipher Block Chaining
            // (CBC). Use default options for other symmetric key parameters.
            symmetricKey.Mode = CipherMode.CBC;

            // Generate encryptor from the existing key bytes and initialization 
            // vector. Key size will be defined based on the number of the key 
            // bytes.
            ICryptoTransform encryptor = symmetricKey.CreateEncryptor(
                                                             keyBytes,
                                                             initVectorBytes);

            // Define memory stream which will be used to hold encrypted data.
            MemoryStream memoryStream = new MemoryStream();

            // Define cryptographic stream (always use Write mode for encryption).
            CryptoStream cryptoStream = new CryptoStream(memoryStream,
                                                         encryptor,
                                                         CryptoStreamMode.Write);
            // Start encrypting.
            cryptoStream.Write(plainTextBytes, 0, plainTextBytes.Length);

            // Finish encrypting.
            cryptoStream.FlushFinalBlock();

            // Convert our encrypted data from a memory stream into a byte array.
            byte[] cipherTextBytes = memoryStream.ToArray();

            // Close both streams.
            memoryStream.Close();
            cryptoStream.Close();

            // Convert encrypted data into a base64-encoded string.
            string cipherText = Convert.ToBase64String(cipherTextBytes);

            // Return encrypted string.
            return cipherText;
        }

        /// <summary>
        /// Decrypts specified ciphertext using Rijndael symmetric key algorithm.
        /// </summary>
        /// <param name="cipherText">
        /// Base64-formatted ciphertext value.
        /// </param>
        /// <param name="passPhrase">
        /// Passphrase from which a pseudo-random password will be derived. The
        /// derived password will be used to generate the encryption key.
        /// Passphrase can be any string. In this example we assume that this
        /// passphrase is an ASCII string.
        /// </param>
        /// <param name="saltValue">
        /// Salt value used along with passphrase to generate password. Salt can
        /// be any string. In this example we assume that salt is an ASCII string.
        /// </param>
        /// <param name="hashAlgorithm">
        /// Hash algorithm used to generate password. Allowed values are: "MD5" and
        /// "SHA1". SHA1 hashes are a bit slower, but more secure than MD5 hashes.
        /// </param>
        /// <param name="passwordIterations">
        /// Number of iterations used to generate password. One or two iterations
        /// should be enough.
        /// </param>
        /// <param name="initVector">
        /// Initialization vector (or IV). This value is required to encrypt the
        /// first block of plaintext data. For RijndaelManaged class IV must be
        /// exactly 16 ASCII characters long.
        /// </param>
        /// <param name="keySize">
        /// Size of encryption key in bits. Allowed values are: 128, 192, and 256.
        /// Longer keys are more secure than shorter keys.
        /// </param>
        /// <returns>
        /// Decrypted string value.
        /// </returns>
        /// <remarks>
        /// Most of the logic in this function is similar to the Encrypt
        /// logic. In order for decryption to work, all parameters of this function
        /// - except cipherText value - must match the corresponding parameters of
        /// the Encrypt function which was called to generate the
        /// ciphertext.
        /// </remarks>
        public static string Decrypt(string cipherText,
                                     string passPhrase,
                                     string saltValue,
                                     string hashAlgorithm,
                                     int passwordIterations,
                                     string initVector,
                                     int keySize)
        {
            // Convert strings defining encryption key characteristics into byte
            // arrays. Let us assume that strings only contain ASCII codes.
            // If strings include Unicode characters, use Unicode, UTF7, or UTF8
            // encoding.
            byte[] initVectorBytes = Encoding.UTF8.GetBytes(initVector);
            byte[] saltValueBytes = Encoding.UTF8.GetBytes(saltValue);

            // Convert our ciphertext into a byte array.
            byte[] cipherTextBytes = Convert.FromBase64String(cipherText);

            // First, we must create a password, from which the key will be 
            // derived. This password will be generated from the specified 
            // passphrase and salt value. The password will be created using
            // the specified hash algorithm. Password creation can be done in
            // several iterations.
            PasswordDeriveBytes password = new PasswordDeriveBytes(
                                                            passPhrase,
                                                            saltValueBytes,
                                                            hashAlgorithm,
                                                            passwordIterations);

            // Use the password to generate pseudo-random bytes for the encryption
            // key. Specify the size of the key in bytes (instead of bits).
            byte[] keyBytes = password.GetBytes(keySize / 8);

            // Create uninitialized Rijndael encryption object.
            RijndaelManaged symmetricKey = new RijndaelManaged();

            // It is reasonable to set encryption mode to Cipher Block Chaining
            // (CBC). Use default options for other symmetric key parameters.
            symmetricKey.Mode = CipherMode.CBC;

            // Generate decryptor from the existing key bytes and initialization 
            // vector. Key size will be defined based on the number of the key 
            // bytes.
            ICryptoTransform decryptor = symmetricKey.CreateDecryptor(
                                                             keyBytes,
                                                             initVectorBytes);

            // Define memory stream which will be used to hold encrypted data.
            MemoryStream memoryStream = new MemoryStream(cipherTextBytes);

            // Define cryptographic stream (always use Read mode for encryption).
            CryptoStream cryptoStream = new CryptoStream(memoryStream,
                                                          decryptor,
                                                          CryptoStreamMode.Read);

            // Since at this point we don't know what the size of decrypted data
            // will be, allocate the buffer long enough to hold ciphertext;
            // plaintext is never longer than ciphertext.
            byte[] plainTextBytes = new byte[cipherTextBytes.Length];

            // Start decrypting.
            int decryptedByteCount = cryptoStream.Read(plainTextBytes,
                                                       0,
                                                       plainTextBytes.Length);

            // Close both streams.
            memoryStream.Close();
            cryptoStream.Close();

            // Convert decrypted data into a string. 
            // Let us assume that the original plaintext string was UTF8-encoded.
            string plainText = Encoding.UTF8.GetString(plainTextBytes,
                                                       0,
                                                       decryptedByteCount);

            // Return decrypted string.   
            return plainText;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T17:06:02.783

你的意思是这样的[http://www.4guysfromrolla.com/webtech/012000-1.shtml](http://www.4guysfromrolla.com/webtech/012000-1.shtml)？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T17:06:50.940

创建一个键/值对字符串。加密它。Base64吧。现在，只需有一个名为“x”之类的查询字符串变量，其值将是 Base64 字符串，例如：

domain.com/MyPage?x=hfjhwke878979blahblah

然后，您解密并使用它并将其放回键/值数据结构中。这是一种方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T17:07:13.483

您可以使用内置的 .NET 加密工具对字符串进行加密。您需要对字符串使用 Server.HtmlEncode/Server.HtmlDecode 以确保加密的字符串符合 HTTP。

[这](http://www.codeproject.com/KB/security/SimpleEncryption.aspx)是一篇关于 .NET 中的加密的文章。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T17:15:41.170

假设你有一个像这样的 url：

```
www.example.com/customerAdd.aspx?customerId=custId&password=weak 
```

您可以做的是获取字符串“ **customerId=custId&password=weak** ”，用密钥对其进行加密，将生成的密文编码为 base64，现在 URL 变为（类似于）：

```
www.example.com/customerAdd.aspx?s=KJADSN1234kNmnanjnads 
```

请记住将加密密钥存储在服务器端。不要将其发送到客户端。

现在，如果您对所有加密会话使用相同的密钥，则可以重新使用 URL。即，您可以将 URL 发送给其他人，他们可以访问同一页面。但是这种方案会降低加密的安全性。

如果您更改每个会话的加密密钥，您将获得额外的安全性，但会话关闭后 URL 将无效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-22T11:09:06.493

尝试构建一个类似于[此页面上](http://www.dotnetspark.com/kb/1279-triple-des-encryption-and-decryption-using.aspx)的脚本块。

它允许您添加一个简单的类并使用简单的密码加密/解密字符串。您可以使用 Session.SessionID 作为密码。请注意，一旦用户关闭他/她的浏览器窗口，链接将不再起作用。

注意：TripleDES 不是很安全，请参阅[此](http://msdn.microsoft.com/en-us/library/ms172831(VS.80).aspx)Microsoft 文章

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-04T18:45:14.727

您可以在 [https://www.code2night.com/Blog/MyBlog/Url-Encryption-in-AspNet-MVC](https://www.code2night.com/Blog/MyBlog/Url-Encryption-in-AspNet-MVC)查看 Asp.Net MVC 中的 url enryption ，它将解释使用自定义 Html Helpers 和 Filter 使用 url 加密属性。

# email - IMAP 文件夹/消息同步策略？

> ID：603106
> 
> 赞同：5
> 
> 时间：2009-03-02T17:07:43.187
> 
> 标签：email, synchronization, imap

我即将将**IMAP 电子邮件集成**添加到我们的一个 Web 应用程序（ASP.NET / SQL Server）中。我已经在使用一个[商业库](http://www.aspnetimap.com/)，它公开了最重要的 IMAP 功能：获取文件夹列表、获取消息标题、获取 mime 消息等）

从 IMAP 服务器“实时”获取电子邮件数据效果很好。但是困难的任务来了：我必须保持**缓存 SQL 数据库的电子邮件/文件夹与 IMAP 服务器同步**（我必须显示应用不同标准的数据）。

我们的数据库模式本质上包含一个“文件夹”和一个“电子邮件”表。“电子邮件”表主要包含标题信息，如“FromAddress”、“FromName”、“IsRead”、“IsAnswered”、“IsForwarded”、“HasAttachments”等（**不**包括电子邮件内容或附件）。

我必须考虑两种主要情况：

1.  第一次（或在用户重新组织文件夹后）获取所有消息
2.  获取新的/最近的消息

考虑到性能是一个主要的设计标准（我不能每次连接时都查询/比较数千条消息，以便找到如果用户移动或删除了一些旧电子邮件，则退出）。

*谢谢！*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T17:31:20.493

从您图书馆的功能列表中：

> 更好的 UniqueId 支持：我们为请求消息的唯一 ID 添加了更多选项。您现在可以在消息的 DataTable 中返回 UniqueId，以便返回到 IMAP 服务器。

和：

> *   仅检索新消息
> *   搜索标记的消息
> *   将消息标记/取消标记为已读

在我看来，您的库似乎拥有保持 SQL 服务器同步所需的所有支持。您可以以编程方式将消息标记为已读，并且该库支持仅检索新消息。这会照顾你的第二个项目。

您的策略将部分取决于您的解决方案如何运作。如果我正确地阅读了您的问题，则从同步的角度来看，您的用户在 IMAP 服务器上管理他们的电子邮件，并且您的 SQL Server 已“订阅”到 IMAP 服务器。

如果这是正确的，那么同步实际上是一项后台任务。我的方法是在逐个用户的基础上使用事件模型进行同步。如果可能，当用户有活动（新的/删除的电子邮件）时“通知”同步程序。将同步“作业”添加到将同步作业批处理在一起的后台进程。通知模型将确保同步程序仅适用于需要同步的用户。

小型新/已删除电子邮件同步作业转到一个“处理器”，而较大的作业（例如完全重新同步和文件夹重组）转到另一个。为了保持较高的整体吞吐量，可能必须拆分非常大的重新同步作业。“小型作业”和“大型作业”处理器可能是两个不同的服务，或者可能是两个不同的线程，具体取决于性能和设计考虑。

# c++ - OS X 上 Carbon OpenGL 应用程序的字体

> ID：603114
> 
> 赞同：1
> 
> 时间：2009-03-02T17:09:30.420
> 
> 标签：c++, macos, opengl, fonts, macos-carbon

我正在尝试将文本渲染添加到我正在为 OS X 开发的 Carbon OpenGL 应用程序中。

由于现在不推荐使用 aglUseFont，我正在寻找另一种添加文本以及能够查询字形属性（即宽度、高度、间距等）的方法

到目前为止，我已经调查了 CoreText 和 ATSUI，但都没有太多运气。

请帮我！！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T20:24:50.387

你可以看看[FreeType](http://www.freetype.org/)项目：它是一个开源、可移植的字体渲染引擎，支持 OpenType、TrueType、Postscript Type 1 和其他格式。FreeType 与 OpenGL 有几个开源集成；参见例如[OGLFT](http://oglft.sourceforge.net/)。或者你可以自己动手：让 FreeType 生成一些合适的像素格式的位图，然后将这些位图传递给`glTexImage2D`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T21:24:03.997

最后，我只是为我的字体选择了旧的 glBitmap。

找到了一个创建渲染每个字符并获取其相关信息（宽度、高度、偏移量等）的[苹果开发示例](http://developer.apple.com/samplecode/GLCarbonCGLFullScreen/listing18.html)

但是，如果我以后有时间做更多的工作，我计划使用上面建议的 FreeType 项目。

谢谢！

# python - python打开文本文件，每个字符之间有一个空格

> ID：603115
> 
> 赞同：21
> 
> 时间：2009-03-02T17:09:38.173
> 
> 标签：python, csv, text-files

每当我尝试使用 python 命令打开一个 .csv 文件时， `fread = open('input.csv', 'r')` 它总是以每个字符之间的空格打开文件。我猜是文本文件有问题，因为我可以使用相同的命令打开其他文本文件并且它们已正确加载。有谁知道为什么一个文本文件会在 python 中这样加载？

谢谢。

**更新**

好的，我在 Jarret Hardie 的帖子的帮助下得到了它

这是我用来将文件转换为 ascii 的代码

```
fread = open('input.csv', 'rb').read()
mytext = fread.decode('utf-16')
mytext = mytext.encode('ascii', 'ignore')
fwrite = open('input-ascii.csv', 'wb')
fwrite.write(mytext) 
```

谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-02T17:36:55.253

递归的帖子可能是正确的......文件的内容可能是用多字节字符集编码的。事实上，如果是这种情况，您可能会在 python 本身中读取文件，而无需先在 python 之外对其进行转换。

尝试类似：

```
fread = open('input.csv', 'rb').read()
mytext = fread.decode('utf-16') 
```

'b' 标志确保文件被读取为二进制数据。您需要知道（或猜测）原始编码......在这个例子中，我使用了 utf-16，但是 YMMV。这会将文件转换为 unicode。如果您确实有一个包含多字节字符的文件，我不建议将其转换为 ascii，因为您最终可能会在此过程中丢失很多字符。

编辑：感谢您上传文件。文件前面有两个字节，表明它确实使用了宽字符集。如果你很好奇，可以按照一些人的建议在十六进制编辑器中打开文件……你会在文本版本中看到一些东西，比如“ID|”。（ETC）。点是每个字符的额外字节。

上面的代码片段似乎可以在我的机器上使用该文件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-02T17:22:06.723

该文件以某种 unicode 编码进行编码，但您将其作为 ascii 读取。在 python 中使用之前，尝试将文件转换为 ascii。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T17:18:54.703

csv 不是一个简单的 txt 文件，其值用逗号分隔。只需尝试使用文本编辑器打开它，看看文件格式是否正确。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-17T09:39:21.857

要读取编码文件，您可以简单地替换`open`为`codecs.open`.

```
fread = codecs.open('input.csv', 'r', 'utf-16') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T17:15:28.267

它从来没有发生在我身上，但正如 truppo 所说，文件一定有问题。

尝试在 Excel/BrOffice Calc 中打开文件并再次将文件另存为 Csv。

如果问题仍然存在，请尝试数据的子集：文件的第 10 行/最后 10 行/中间 10 行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T17:54:02.560

好的，我在 Jarret Hardie 的帖子的帮助下得到了它

这是我用来将文件转换为 ascii 的代码

```
fread = open('input.csv', 'rb').read()
mytext = fread.decode('utf-16')
mytext = mytext.encode('ascii', 'ignore')
fwrite = open('input-ascii.csv', 'wb')
fwrite.write(mytext) 
```

谢谢！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T17:55:56.830

以二进制模式“rb”打开文件。在 HEX 编辑器中检查它并检查空填充“00”。在类似 Scintilla 文本编辑器中打开文件以检查文件中存在的字符。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-22T18:48:31.323

这是快速简便的方法，尤其是如果python无法正确解析输入

```
sed 's/ \(.\)/\1/g' 
```

# tfs - 非视觉工作室用户的工作项访问

> ID：603123
> 
> 赞同：2
> 
> 时间：2009-03-02T17:12:00.117
> 
> 标签：tfs

我们正在使用 TFS 进行源代码控制，并且正在试用 TFS 工作项跟踪。我想知道，没有安装 Visual Studio 的人是否可以通过基于浏览器的用户界面访问、创建和编辑工作项？

我们的技术支持团队需要能够使用工作项。如果支持团队和项目经理无法获得足够的访问权限，TFS 工作项将不适合我们公司。

我也不熟悉许可的工作方式。如果非 Visual Studio 用户可以使用 TFS 工作项，他们是否需要许可证？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-13T21:20:54.157

有多种选择（最花钱）：

1.  **[Team System Web Access](http://msdn.microsoft.com/en-us/teamsystem/bb676728.aspx)**
    Team System Web Access（以前称为 TeamPlain）是 Visual Studio 2005 Team Foundation Server 的 Web 界面。Team System Web Access 可供现有 Team Foundation Server 用户免费下载，并将整合到 Visual Studio Team System 的未来版本中。

2.  **[仅工作项视图](http://msdn.microsoft.com/en-us/library/cc668124.aspx)**
    Team System Web Access 提供了一个仅工作项视图，该视图限制了功能，因此您只能创建和查看您自己的工作项。此视图旨在帮助您在没有客户端访问许可证 (CAL) 时使用 Team Foundation Server。您不需要 CAL 来创建新工作项或查看和更新​​您创建的工作项。仅工作项视图会限制功能，以便您遵守 Team Foundation Server 最终用户许可协议的这一方面。有关详细信息，请参阅[Visual Studio Team System 2008 许可白皮书](http://www.microsoft.com/downloads/details.aspx?FamilyId=CE194742-A6E8-4126-AA30-5C4E969AF2A3&displaylang=en)。

3.  **[Outlook 集成](http://blogs.msdn.com/bharry/archive/2009/03/17/tfs-outlook-add-ins.aspx)**（来自 Brian Harry 的博客）
    将 Team Foundation Server 工作项集成到 Outlook 用户体验中仍然是一个受欢迎的创新领域。就在最近，一位作者给我发了一封邮件，内容是关于一个名为 Wit-It 的新作品！使工作项表单可以从 TFS 工作项更改通知中轻松打开。它与从事件通知配置到 Team System Web Access 的链接并不完全不同，但它使用了一些人会更喜欢的本地富客户端 UI。

    还有其他几个具有不同完整性级别的 Outlook 扩展产品。如果这是一个让您感兴趣的领域，您还可以查看：

    [团队展开](http://www.teamexpand.com/)

    [团队外观](http://www.personifydesign.com/products/teamlook/teamlook.aspx)

    [团队伙伴](http://www.ekobit.com/ProductsDetailView.aspx?id=1)

    如果我遗漏了任何内容，我深表歉意。正如我所说，显然这里有很多兴趣和一些有创造力的人。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T17:18:02.117

对于非 Visual Studio 用户，[Team System Web Access是一个很好的基于 Web 的选项。](http://msdn.microsoft.com/en-us/teamsystem/bb676728.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T17:17:56.640

应该有一个 Web 界面，一个网站和一个与 TFS 一起安装的 SharePoint 门户。该门户将让您访问文档并查看一些报告。该网站将让您处理文档、源代码控制、工作项和错误报告。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T17:33:00.893

就许可而言，成熟的 TFS 用户需要 TFS CAL（除了普通的 Windows Server CAL）。

但是，对于特定类型的“轻量级”用户，可能不需要 TFS CAL（我不确定，但我认为仍然需要 Windows Server CAL）。有关详细信息，请参阅[http://blogs.msdn.com/bharry/archive/2007/11/23/tfs-licensing-change-for-tfs-2008.aspx](http://blogs.msdn.com/bharry/archive/2007/11/23/tfs-licensing-change-for-tfs-2008.aspx)。

与往常一样，MS 服务器应用程序许可要求通常非常复杂 - 您需要自己进行研究（可能与 MIcrosoft 协商）以确定您的实际许可要求。

# delphi - madExcept + UPX

> ID：603130
> 
> 赞同：1
> 
> 时间：2009-03-02T17:12:38.227
> 
> 标签：delphi, madexcept, upx

我在 Delphi 2007 上使用 madExcept + UPX 时遇到问题。每当我打开压缩的应用程序时，都会出现一个 Windows 异常对话框，代码为 0xc0000005。有人有解决方案吗？

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-02T20:27:53.360

异常堆栈跟踪等需要将内存代码地址映射到存储在可执行文件中的虚拟地址，以便它们可以与 .map 文件或指示函数或源文件和行的调试信息相关联。通常，映射是直截了当且相对线性的。

可执行压缩搞砸了这一点，因为它没有直接的映射，尤其是不符合 PE 规范的映射。这是因为可执行压缩将可执行文件中的初始化例程替换为将数据从磁盘提取到内存中（这也意味着压缩的可执行文件不与其他实例共享页面，并且比未压缩的可执行文件使用更多的内存，因为它们需要一次所有的页面），然后转发到新扩展的原始初始化例程。

因此，如果在堆栈跟踪中没有非常巧妙的代码位置相对地址存储，这两种技术不太可能一起工作。

FWIW，我个人不建议使用可执行打包程序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-05T19:27:05.717

MadShi 自己的论坛已经对此进行了介绍：

[论坛文章#1](http://forum.madshi.net/viewtopic.php?t=4143&highlight=upx)
[论坛文章#2](http://forum.madshi.net/viewtopic.php?t=1016&highlight=upx)

周围还有很多其他主题，但总而言之，MadExcept 3.* 及之后的版本可以与 UPX 一起正常工作，但不能在下面。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T17:18:11.663

该异常代码通常意味着它是未处理的外部异常。如果不使用 UPX 会怎样？异常会消失吗？

顺便说一句，它可能与 MadExcept 无关。该异常代码通常表明异常发生在可以设置 VCL 的异常处理程序之前，因此它也可能发生在 MadExcept 被挂钩之前。

编辑：从您的评论看来，UPX 的压缩技术可能会干扰 MadExcept/Delphi 连接异常处理程序链的能力。你检查了布鲁斯提供的链接吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T16:30:08.280

使用 upx 尝试以下开关：

--compress-exports=0

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T17:42:10.607

我已经成功地将 madExcept 与 ASProtect 一起使用，所以我知道它可以与 exe 压缩一起使用。但是，UPX 可能存在一些特定[问题](http://forum.madshi.net/viewtopic.php?t=4614&sid=41fb1d720ef611233d3de1f8dbab1d66)。

# javascript - 如何使用 JQuery 将新的 TR 插入 HTML 表的中间？

> ID：603132
> 
> 赞同：8
> 
> 时间：2009-03-02T17:13:15.170
> 
> 标签：javascript, jquery, html

我知道如何使用 JQuery 将新行附加到表中：

```
var newRow = $("<tr>..."</tr>");
$("#mytable tbody").append(newRow); 
```

问题是如何在现有行之前创建一个新行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-02T17:18:09.837

```
var newRow = $("<tr>...</tr>");
$("#idOfRowToInsertAfter").after(newRow); 
```

关键是知道要在之后插入新行的行的 id，或者至少想出一些选择器语法来获得该行。

[jQuery 文档`after()`](http://docs.jquery.com/Manipulation/after)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-02T17:18:20.460

```
where_you_want_it.before(newRow) 
```

或者

```
newRow.insertBefore(where_you_want_it) 
```

——马库斯

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-02T17:18:02.317

而不是这样：

```
$("#mytable tbody").append(newRow); 
```

你会想做这样的事情：

```
$("#id_of_existing_row").after(newRow); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-02T18:50:59.210

和：

```
var newTr = $('<tr>[...]</tr>'); 
```

你可以……</p>

1.  在您知道 ID（或任何其他属性）的另一行之后（或之前，如果您选择）插入它：

    ```
    $('#<id of the tr you want to insert the new row after>').after(newTr) 
    ```

2.  在特定的行索引之后插入它（索引是从 0 开始的，而不是从 1 开始的）：

    ```
    $($('table#<id> tr')[<index>]).after(newTr) 
    ```

3.  …或者正如你提到的，绝对中间是可能的：

    ```
    var existingTrs = $('table#<id> tr')
    $(existingTrs[parseInt(existingTrs.length / 2)]).after(newTr) 
    ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-13T08:08:03.323

例如，如果您将插入图像放入您的表中，这将是这样的：

表格中的最后一个单元格：

```
 <td> <img class=\"insertRow\" src=\"/images/imgInsertRow.jpg\" /> </td> 
```

你的jQuery代码：

```
$('table td img.insertRow').click(function(){
   var newRow=$('<tr>........</tr>');
   $(this).parent().parent().after(newRow);
}); 
```

# delphi - Inscriber 技术通过 Builder 和 Delphi - Alpha 通道支持

> ID：603138
> 
> 赞同：0
> 
> 时间：2009-03-02T17:16:27.017
> 
> 标签：delphi, alpha, getdibits

我正在与 Inscriber Technology 的 Via Builder 合作。此应用程序将 TGA 序列动画合并到一个 .via 文件中，从而更好地加载大型序列，因为此文件已优化。有一些插件可以将其与某些 Adob​​e 产品一起使用。

我正在研究 Delphi，我的问题是我无法从帧中取回原始的 alpha 通道。使用他们的 VIACODECLib_TLB 库，我有以下功能：

```
function GetFrameBitmap(Frame: Integer): Integer; 
```

来自 IViaFile 接口。这个函数应该从原始序列返回一个帧位图的句柄。以下代码可以工作：

```
viaObject: IViaFile;
bmp: TBitmap;
index: Integer;

bmp.Handle := ViaObject.GetFrameBitmap(index); 
```

但生成的位图是没有 Alpha 通道的原始帧。实际上，整个图像的 alpha 通道为零。

假设我做错了什么，我尝试使用 GetDIBits 函数，以确保某处有一个 alpha 通道。所以我分配了足够长的内存来存储位图，假设它有 4 个通道并使用 GetDIBits 函数。我得到了和以前一样的结果：正常帧，整个图像的 alpha 通道为零。

请注意，Inscriber（其论坛已死）声称其 Via Builder 具有完整的 alpha 支持。我知道有人设法在 C++ 上使用 GetDIBits 函数正确加载帧，但是将代码“翻译”为 Delphi 不起作用。

任何帮助将非常感激。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T20:33:21.583

我建议你仔细看看你同事的 C++ 代码，它应该是有效的。你可能错过了一些细节。有多少代码是 Windows API，有多少是一些供应商特定的图形代码？API的东西应该很容易翻译成Delphi。

您可能会发现 Delphi 的`TBitmap`类不支持透明度，因此您需要使用其他一些图形支持库而不是普通的旧 GDI。但是，如果您使用 获取原始位图数据`GetDIBits`，您至少应该能够看到 alpha 通道数据在那里。（您仍然需要找到一种正确显示位图的方法，但至少您知道您有正确的数据开始。）

# wpf - 使 WPF 应用程序始终保持焦点

> ID：603140
> 
> 赞同：0
> 
> 时间：2009-03-02T17:17:42.787
> 
> 标签：wpf, focus

我正在编写的 WPF 应用程序存在问题。该应用程序需要能够始终保持专注。运行它的计算机是一台高度专业化的机器，其唯一目的是运行此应用程序。

机器没有连接键盘（它有一个触摸屏），所以唯一可以窃取焦点的是windows自己的“需要的windows”，比如windows update等。

我怎样才能使我的应用程序始终保持焦点？是否可以使整个应用程序模态化？

# 编辑：

谢谢你们的回答。我想我现在最终会使用 Topsmost，但我肯定会检查 babysmash 的来源，因为该应用程序完全按照我想要的方式工作，就其处理焦点的方式而言。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T17:22:25.537

查看[BabySmash](http://www.codeplex.com/babysmash)的来源。它专门设计用于即使在非常奇怪的情况下也能保持专注。（这是一个专为全屏运行而设计的程序，让宝宝们在键盘上敲打——所以相当多的注意力集中在捕捉各种奇怪的键盘组合和警报消息上）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T17:34:45.007

我会用

```
<Window ... Topmost="True"> 
```

我xml。但也许这不是你要找的

# asp.net - ASP.NET ObjectDataSource SelectParameters CookieParameter 问题

> ID：603153
> 
> 赞同：3
> 
> 时间：2009-03-02T17:19:12.363
> 
> 标签：asp.net, cookies

如果我的 cookie 设置如下： Response.Cookies("Employees")("UserID") = 43

如何从 ObjectDataSource SelectParameters CookieParameter 中获取此值？

```
<asp:ObjectDataSource ID="odsProducts" runat="server" TypeName="MyCompany.Products" SelectMethod="GetAll">
     <SelectParameters>
         <asp:CookieParameter CookieName="????" Name="UserID" Type="Int32" />
     </SelectParameters>        
</asp:ObjectDataSource> 
```

我假设我需要做这样的事情？

```
<asp:ObjectDataSource ID="odsProducts" runat="server" TypeName="MyCompany.Products" SelectMethod="GetAll">
     <SelectParameters>
         <asp:CookieParameter CookieName="Employees.UserID" Name="UserID" Type="Int32" />
     </SelectParameters>        
</asp:ObjectDataSource> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-08T12:05:51.060

您可以创建自定义控件来解决此问题。Kevin Isom 的博客有一个博客条目。
[数据源的自定义参数](http://weblogs.asp.net/kevinisom/archive/2007/09/01/custom-parameter-for-a-datasource.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-10T02:23:26.757

不理想，但您可以在代码隐藏 odsProducts.SelectParameters["UserId"].DefaultValue = Response.Cookies["Employees"]["UserID"] 中设置 ObjectDatasource 的参数 DefaultValue

那里可能有语法错误。

# sharepoint - SharePoint 列表项不返回字段

> ID：603154
> 
> 赞同：1
> 
> 时间：2009-03-02T17:19:40.723
> 
> 标签：sharepoint, list

您好我有一个关于 SPListItem 以及如何从中检索值的问题。在我所在的视图中，我可以访问“文章”没问题，但是当我尝试访问“链接”时，我会出错，说对象未初始化。我不明白这是怎么回事？为什么我可以获取文章字段时无法获取链接。这是我正在使用的代码：

```
SPList myList = eachWeb.Lists["Listings"];
SPListItemCollection myItemCollection = myList.GetItems(myList.Views["Active Announcements"]);
for (int i = 0; i < myItemCollection.Count; i++)
{
SPListItem realitem = myItemCollection[i]; 
writer.Write(realitem["Article"].ToString()+"<BR>"); // Works without the bottom line
writer.Write(realitem["Link"].ToString()+"<BR>");  // Causes error 
```

我的视图包含文章和链接的列。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T17:29:57.360

字段的内部名称可能与显示名称不匹配；特别是如果您在创建列表后更改了名称。尝试调试并查看 中的字段名称，`SPListItemCollection`看看您是否可以找出它在那里。

# php - 如何对类似新闻进行分组

> ID：603159
> 
> 赞同：2
> 
> 时间：2009-03-02T17:21:19.707
> 
> 标签：php, mysql, rss

我正在尝试构建一个 rss-news 获取服务器来收集有关某个主题的几个站点的所有新闻。通常这些网站有类似的新闻，信息几乎相同。怎么可能对这样的新闻进行分组。例如显示第一个然后是其他链接的摘要？

有人有这方面的经验吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T17:25:27.153

寻找关键字（例如，将描述拆分为单词并删除 100 个左右最常见的单词中的任何一个），然后通过这些单词的共现将它们聚集在一起。通常只看最长的单词会给你一个很好的快速近似值。

换句话说，如果您有一个包含“主题组”的表，您可以将每个项目分配到一个新的或现有的主题组。首先，查看是否有任何现有主题组与新项目共享足够的关键字；如果有，把它放在那里。如果没有，则使用其关键字创建一个新主题组，并将其添加为该主题组的第一个成员。

——马库斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-27T22:07:40.863

我认为它被称为集群：

*   [k-均值聚类](http://en.wikipedia.org/wiki/K-means_clustering)
*   [层次聚类](http://nlp.stanford.edu/IR-book/html/htmledition/hierarchical-agglomerative-clustering-1.html)

我只是查找相关问题并找到[更好的答案](https://stackoverflow.com/questions/3320753/how-to-group-compare-similar-news-articles/3320865#3320865)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-22T01:37:08.080

最好通过比较文章的“语义签名或语义 DNA”来完成。这意味着您需要先进行自然语言处理。

# perl - Perl 是处理繁重文本的好选择吗？

> ID：603163
> 
> 赞同：3
> 
> 时间：2009-03-02T17:22:12.823
> 
> 标签：perl, text

我有这个 Web 应用程序，它需要执行几个繁重的文本处理任务：删除某些字符、解析 XML 文件等等。其中一些涉及正则表达式。

该 Web 应用程序有一些 Java 实现和一些 PHP 实现。是否值得为此类任务使用 Perl 或其他特定的文本处理语言，或者使用 PHP 真的没有区别？

我什至想过使用 Sed、Awk 甚至一些编译的 C 脚本来处理文本。有很多文本需要处理...

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-02T17:24:47.700

是的，Perl 是一个不错的选择。作为一种语言，它绝对比 Java 或 PHP 更适合这类任务。如果你有 Perl 知识，我会推荐它来完成这类任务。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-02T20:19:16.737

我也建议你使用 Perl，它是为文本处理而设计的。

但是，如果您要解析/处理 XML，请不要尝试推出自己的解决方案，有几个高质量的模块可以正确完成这项工作。作为初学者，我建议您看一下[XML::Twig](http://search.cpan.org/~mirod/XML-Twig-3.32/Twig.pm)

[此外，对于正则表达式，在Regexp::Common](http://search.cpan.org/~abigail/Regexp-Common-2.122/lib/Regexp/Common.pm)发行版下有几十个已经制作好的。很可能你会在那里找到你需要的东西，它会节省你的时间。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-02T17:30:54.393

Perl 是用于文本处理的语言。它的设计考虑到了这一点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-02T17:28:24.617

文本处理正是创建 Perl 的目的。毕竟它是实用的提取和报告语言。另一方面，对于 Web 应用程序，我更喜欢 Python。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-02T17:29:05.100

是的，Perl 在设计时就考虑到了处理文本。

它具有大量有用的文本处理功能，并且它是我（很久以前）使用的第一种具有正则表达式的语言。

[http://en.wikipedia.org/wiki/Perl](http://en.wikipedia.org/wiki/Perl)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-02T18:03:13.147

是的。文本处理是 PERL 的 #1 强项。由于您将集成到现有应用程序中，因此您需要执行一个外部程序，因此请考虑如何安全地运行它，并可能将其作为后台进程运行（以避免实时 Web 应用程序的启动延迟。）

# sql-server - 您使用什么工具来开发和管理您的数据库？

> ID：603165
> 
> 赞同：0
> 
> 时间：2009-03-02T17:22:23.977
> 
> 标签：sql-server, database, oracle, toad

我一直使用Quest 的[TOAD](http://www.quest.com/toad/)在 Oracle 和 MS SQL Server 中进行开发和管理工作。但是，我尽量不要在我的选择中短视。您是否会推荐其他工具来让我连接到数据库并执行我的开发和管理职责？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T17:28:58.673

对于 Oracle（和它出现的 MySQL），您可以使用 Oracle 的免费“SQL Developer”，它是 Java 也可以在 Mac OS X 和 Linux 上运行。

对于 PostgreSQL，有一个在线解决方案的 phpPgAdmin，对于 MySQL 来说是等价的。也有像 PgAdmin3 这样的独立应用程序，但我很长时间没有使用它们，更喜欢 psql 命令行界面。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T17:28:28.330

我个人喜欢 MS SQL Server Management Studio 到 SQL Sever。SSMS 2008 是对 SSMS 2005 的一个非常好的改进。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T17:38:51.427

[SqlManager.net](http://sqlmanager.net/)有一系列用于数据库横截面的工具。还可以看看[Altova 的 Database Spy](http://www.altova.com/products/databasespy/database_tool.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T17:41:15.647

我以前用过 TOAD，印象不是很深。我喜欢使用的是[适用于 Visual Studio .Net 的 Oracle 工具](http://www.oracle.com/us/corporate/press/015343_EN)。他们的工具在 Visual Studio 的服务器资源管理器中工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T17:57:11.973

请参阅有关该主题的[这个](https://stackoverflow.com/questions/214930/alternatives-to-toad)问题。
对我来说，在 Oracle 的专用工具中，Toad 胜过所有选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T17:47:37.147

令人惊讶的是，phpMyAdmin。不是最好的工具，但从来没有让我失望，它几乎已经安装在任何地方。我希望它支持的数据库引擎比它的名字所暗示的要多。

# api - 用于测试 API 的 cURL 的 GUI 前端

> ID：603170
> 
> 赞同：74
> 
> 时间：2009-03-02T17:24:03.600
> 
> 标签：api, rest, http, testing, curl

我正在（手动）测试一个充分利用 GET/POST/PUT/DELETE 方法的 RESTful API。与其在命令行上使用 cURL 来快速测试不同的输入选项，如果有一个 Windows GUI 应用程序可以使这更容易，那将很方便。有这样的东西存在吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-02T18:21:23.353

将[海报](https://addons.mozilla.org/en-US/firefox/addon/2691)与[Firefox](http://www.mozilla.com/firefox/)一起使用。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-09-27T18:12:34.737

我知道这篇文章有点老了，但是Chrome 的[Dev HTTP Client](https://chrome.google.com/webstore/detail/aejoelaoggembcahagimdiliamlcdmfm)是迄今为止我发现的最好的插件。

除了提供漂亮的 UI 来格式化响应（如 JSON 和 XML），它还允许您保存任何请求。恕我直言，最好的功能是能够设置不同的“上下文”和设置变量。例如，您可以有一个“生产”和“开发”上下文，每个上下文都有一个“主机”变量。那么您的请求字符串可能是`http://${host}/foo`.

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2013-09-23T12:45:31.753

[Insomnia](https://insomnia.rest/)是一个漂亮的 Windows、Mac 和 Linux 桌面应用程序，用于调试 RESTful API（我个人最喜欢的）

[Postman](https://chrome.google.com/webstore/detail/postman-rest-client-packa/fhbjgbiflinjbdggehcddcbncdddomop?hl=en)是一个用于 API 测试和自定义 http 请求的 Chrome 扩展。您可以保存请求以供以后使用、设置不同的环境（暂存、部署）以及与团队中的其他人协作和共享请求。

[Firefox 的HttpRequester](https://addons.mozilla.org/en-US/firefox/addon/httprequester/)类似于 Postman。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-02T19:55:09.990

我喜欢[RESTclient](http://code.google.com/p/rest-client/)。不过，它不会格式化 HTML（我假设 Poster 会），所以如果您收到 500 错误，您可以自己挖掘返回的文本。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-06-04T19:35:59.737

此外，我会说带有[Chrome的](http://www.google.com/chrome)[XHR POSTER](https://chrome.google.com/webstore/detail/akdbimilobjkfhgamdhneckaifceicen) 的 UI 比 Poster 更好。

**更新**
XHR 一直给我带来问题。[Restlet](https://chrome.google.com/webstore/detail/dev-http-client/aejoelaoggembcahagimdiliamlcdmfm?utm_source=plus) for Chrome 的 DHC 也很不错。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-07-23T14:23:03.297

找到了一个有用的（免费）网络工具，现在已经存在了！

[https://curlbuilder.com/](https://curlbuilder.com/)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-12-30T14:32:56.403

[Fiddler](http://www.fiddler2.com/fiddler2/version.asp)是一个非常好的工具。您可以查看请求历史记录，支持所有 HTTP 动词，使用必要的标头（如 Content-Length）完成请求。您正在寻找的功能称为“请求生成器”。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-05-21T05:17:57.503

为了让这个列表保持最新，这里有一个更好、更新的 Chrome 扩展：[高级 REST 客户端](https://chrome.google.com/webstore/detail/advanced-rest-client/hgmloofddffdnphfgcellkdfbfbjeloo)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-01-20T10:50:36.053

试试 gURL：[http](http://code.google.com/p/gurl/) ://code.google.com/p/gurl/ 这是一个简单的 HTTP 请求生成器，基于 curl

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-12-03T12:52:37.707

在我尝试过的所有**Firefox扩展中，** [HttpRequester](https://addons.mozilla.org/en-US/firefox/addon/httprequester/)对我来说是最好的工具。它非常清晰，不缺少功能。

对于**Chrome**，我会推荐[Advanced REST client](https://chrome.google.com/webstore/detail/advanced-rest-client/hgmloofddffdnphfgcellkdfbfbjeloo)或[Postman](https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop)。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-07-23T13:42:04.677

[OS X 的爪子](https://luckymarmot.com/paw)非常好。撰写本文时为 29.99 美元。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-01-30T00:25:16.090

我认为[Hurl](http://www.hurl.it)是一个很好的候选人？

# asp.net - Asp.Net AutoEventWireup - 它在做什么代码明智

> ID：603173
> 
> 赞同：3
> 
> 时间：2009-03-02T17:24:28.980
> 
> 标签：asp.net, autoeventwireup

我一直在研究反射器中的 Page、TemplateControl 和 Control 类，试图找出 AutoEventWireUp 属性实际使用的位置。我失败得很惨。

我对 AutoEventWireUp 的理解很粗略，但我认为它会导致事件处理程序方法自动连接到事件？所以我想我会看到一些发生这种情况的代码，但事实并非如此。

AutoEventWireUp 实际上在哪里使用？我可以在反射器中看到代码吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T17:35:41.853

我本来打算写一个解释，但 K. Scott Allen 的解释[要好得多](http://odetocode.com/blogs/scott/archive/2006/02/16/2914.aspx)。

我的建议是避免`AutoEventWireup`并覆盖基本的“OnEvent”方法或显式连接您自己的事件，因为这将更快、更不神奇且更易于调试。

# html - 谁能给我指出一篇关于“抽象 HTML”的好文章？

> ID：603174
> 
> 赞同：-2
> 
> 时间：2009-03-02T17:24:31.680
> 
> 标签：html, xhtml, abstraction, template-engine, tiles

我目前正在开发具有大量重复 HTML 代码的遗留电子商务系统前端。

我试图找到一种方法来抽象出复杂性，就像将相似类之间的相似性移动到共享抽象基类时一样。

IE“取出变化并抽象化”

我以前使用过 Tiles 等 Java 框架来执行此操作，但目前我使用的是 Webby。

此外，在之前抽象 HTML 时，我是从头开始编写代码并使用 MVC 框架，所以这让事情变得更容易一些（不必将任何东西与 diff 进行比较）。

有人会知道我所描述的内容的另一个术语，或者可能是一篇关于为此目的抽象现有 HTML 代码的好文章吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T17:53:43.217

这个特定的特性并不是最好的文档，但是 Webby 有允许您编写页面片段并将它们包含在其他页面中的部分。创建一个名称以下划线开头的文件（比如，`"_untocaesar"`），然后您可以通过`<% render(:partial => '_untocaesar') %>`使用 ERB 过滤器来包含它。

部分可以有标题来指示处理，就像普通页面一样。因此，通过结合像 ERB 和 partials 这样的模板语言，您应该能够为您的网站提供一个非常干净的因子。

这不是一般的 HTML 概念，因为 HTML 实际上只是静态页面，因此如果没有预处理器，您*将无法做到这一点。*它通常由您使用的框架处理。瓷砖是一个，韦比是另一个。它的具体工作方式在某种程度上取决于框架本身。

# c# - C#：如何从派生类的静态方法调用基类的静态方法？

> ID：603177
> 
> 赞同：21
> 
> 时间：2009-03-02T17:24:58.760
> 
> 标签：c#, inheritance, static, base, derived-class

在 C# 中，我有基类 Product 和派生类 Widget。

产品包含一个静态方法 MyMethod()。

我想从静态方法 Widget.MyMethod() 调用静态方法 Product.MyMethod()。

我不能使用 base 关键字，因为它只适用于实例方法。

我可以显式调用 Product.MyMethod()，但如果我稍后将 Widget 更改为从另一个类派生，我必须修改该方法。

C# 中是否有一些类似于 base 的语法允许我从派生类的静态方法调用基类的静态方法？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-02T17:27:35.807

`static`方法基本上是一种从面向对象概念中回退的方法。结果，它们在继承层次结构中不是很灵活，并且不可能直接做这样的事情。

我能想到的最接近的东西是`using`指令。

```
using mybaseclass = Namespace.BaseClass;

class MyClass : mybaseclass {

  static void MyMethod() {  mybaseclass.BaseStaticMethod();  }

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-09-23T22:38:49.487

可以办到：

```
public class Parent1
{
    protected static void Foo()
    {
        Console.WriteLine("Parent1");
    }
}

public class Child : Parent1
{
    public static void Foo()
    {
        return Parent1.Foo();
    }
} 
```

可用于单元测试受保护的静态方法（例如）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-02T17:41:55.817

可以，但我不推荐。

```
public class Parent1
{
    public static void Foo()
    {
        Console.WriteLine("Parent1");
    }
}

public class Child : Parent1
{
    public new static void Foo()
    {
        Type parent = typeof(Child).BaseType;
        MethodInfo[] methods = parent.GetMethods();
        MethodInfo foo = methods.First(m => m.Name == "Foo");
        foo.Invoke(null, null);
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-03T10:55:39.337

使用反射调用静态方法与调用实例方法完全相同，只是您为实例传递了 null。您需要 FlattenHierarchy 因为它是在祖先中定义的。

```
var type = assy.GetType("MyNamespace.MyType");
MethodInfo mi = type.GetMethod("MyStaticMethod", 
  BindingFlags.Static | BindingFlags.Public | BindingFlags.FlattenHierarchy);
mi.Invoke(null, null); 
```

进一步的阅读和思考让我提出了与其他回答相同的问题：为什么要使用这样的静态方法？您是否尝试进行函数式编程，如果是，为什么不使用 lambda 表达式呢？如果您想要具有共享状态的多态行为，实例方法会更好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-07T14:08:41.423

首先也是最重要的，如果您担心重新设置类的父级，那么您可能做错了继承。继承应该用于建立“is-a”关系，而不是简单地促进代码重用。如果您需要单独重用代码，请考虑使用委托，而不是继承。我想你可以在子类型和它的父类型之间引入一个中间类型，但我会让这种可能性驱动我的设计。

其次，如果您需要使用基类中的功能但扩展它并且用例调用静态方法，那么您可能需要考虑使用一些外部类来保存该功能。在我看来，这方面的经典案例是工厂模式。实现工厂模式的一种方法是通过工厂方法，这是一个类的静态方法，用于构造该类的实例。通常构造函数是受保护的，因此工厂方法是从外部构建类的唯一方法。

在继承层次结构中重用工厂方法的一种方法是将公共代码放在受保护的方法中并从工厂方法调用该方法，而不是直接从子类型工厂方法调用基类工厂方法。更好的实现可能使用相同的技术，但将工厂方法移动到工厂类并使用构造函数逻辑（现在是内部的，而不是私有的），可能与初始化方法结合使用来创建对象。如果您继承的行为是类外部的（解密/验证/等），您可以在工厂内使用共享方法（或组合）以允许在工厂方法之间重用。

在不知道您使用静态方法的目标的情况下，很难给您一个准确的方向，但希望这会有所帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T17:35:23.277

静态方法不是多态的，所以你想做的事情是不可能的。

试图找到一种将静态方法视为多态的方法是可能的，但很危险，因为语言本身不支持它。

一些建议：

*   反射
*   给基类起别名（比如[Mehrdad 的例子](https://stackoverflow.com/questions/603177/c-how-do-i-call-a-static-method-of-a-base-class-from-a-static-method-of-a-deriv/603188#603188)）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T23:05:33.857

静态方法是“类级”方法。它们旨在成为适用于特定类的所有实例的方法。因此，此方法的继承没有意义，因为它会改变应用于类实例的含义。例如，如果您正在循环通过一组产品（一些是 Widget，一些不是）并在每个产品上调用 MyMethod，那么被调用的方法将由类的实例确定。这违反了静态方法的目的。

您可以通过根本不使用静态方法来更干净地执行您想要的操作，因为在您的示例中，MyMethod 似乎不适用于 Product 的所有实例。但是，您可以通过使用像“IMyMethod”这样的接口类来实现您所描述的相同效果。这种方法仍然没有使用静态方法。我想我没有看到需要静态方法。为什么要使用静态方法开始？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-02T17:31:29.603

考虑到静态方法不应该在实例数据中中继......你应该有一个静态的“MyMethod”，它根据参数或类似的东西表现不同。

请记住，在一个类中定义的静态方法只是对代码进行排序的一种方式......但如果将该方法放在其他地方也是一样的......因为它不会中继放置它的对象。

**编辑：**我认为您最好的选择是明确使用 Product.MyMethod ...如果您认为...您的 Widget 更改其基类的可能性不大...在这种情况下，这只是一个小改动在代码中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-12-14T22:01:31.507

这很简单。比使用别名、反射等要简单得多。也许在 .NET、IDK 的新添加中它变得更容易了，但这工作得非常好。与实例方法一样，访问基类方法不需要`base`使用，它是可选的，通常在继承和基类具有相同名称的方法时需要。即使没有`base`关键字，您也可以访问基类的静态方法，就好像它们在您调用的类中一样。我只在从派生类的**静态**方法调用基本**静态**方法时测试了这一点。如果您从**实例**方法调用静态方法，可能无法正常工作。

 ****```
public class BaseThings
{
    protected static void AssertPermissions()
    {
        //something
    }
}

public class Person:BaseThings
{
    public static void ValidatePerson(Person person)
    {
        //just call the base static method as if it were in this class.
        AssertPermissions();            
    }
} 
```

# asp.net - ASP.NET - 在一页上单独验证两个表单？

> ID：603178
> 
> 赞同：4
> 
> 时间：2009-03-02T17:24:58.917
> 
> 标签：asp.net, forms, validation

我有一个应该是相当简单的 ASP.NET 问题，而且我认为我过去已经找到了一种解决方法，但是这次我没有尽头地试图为它找到一个可行的解决方案。

我有一个带有许多输入控件和一系列表单验证器的 ASP.NET 页面。我希望页面有单独的表单，其中只有一些验证器由提交按钮 A 触发，而其他验证器由提交按钮 B 触发。一个示例是一个包含带有验证的站点搜索框的站点，以及要填写的评论部分或表单在同一页面上。提交评论时，您不希望触发搜索验证，并且在运行搜索时，您不希望触发评论表单验证器。

我需要的是一种“验证面板”，或单独的表单标签来包含这些部分。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T17:29:33.883

您可以为此使用[ValidationGroup](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)属性。

但不要忘记，您的 asp.net 页面中不能有多个表单。

# asp.net - 带有 jQ uery 集成问题的旧版 ASP.NET 1.1

> ID：603180
> 
> 赞同：0
> 
> 时间：2009-03-02T17:25:11.350
> 
> 标签：asp.net, jquery, vb.net, asp.net-1.1

我正在开发一个用 VB.NET 为 ASP.NET 1.1 编写的遗留 Web 应用程序。一个特定页面有一个包含多个字段的表单。为了响应下拉框更改值，我正在清除一些字段，将一些下拉框重置为第一个选项，并在 UI 中将它们全部设置为“禁用”。为此，我正在使用 jQuery。我向所有这些字段添加了一个 CSS 类，然后我的 jQuery 选择器类似于以下内容：$("*.my-css-class"). 这是一些示例代码来解释。

```
var fields = $("*.fields");
if (some_condition) {
    fields.val("");
    fields.attr("selectedIndex", 0);
    fields.attr("disabled", "disabled");
} 
```

UI 响应上述 js 代码按预期更新，但是当我回发页面以响应按钮单击时，原始值仍保留在与这些控件相关的服务器端。例如，txtSomething 是具有 CSS 类“字段”的字段之一（因此它将被上面的 jQuery 选择器选中）。用户在此文本框中键入“1234”并提交表单。要么将相同的页面回发回自身并保留其值，要么我返回此页面并在服务器端预填充值（例如，用户单击摘要页面上的“编辑”按钮），因此控件 txtSomething 被初始化在值为“1234”的客户端上。我的 jQuery 代码会清除用户在 UI 中看到的值，然后用户单击提交按钮。如果我使用 jQuery 选择器查询该值，则该字段的值是一个空字符串。当页面被回发并且我正在单步执行代码（或使用此控件的值做某事）时，它仍然是“1234”。

非常重要的一点是，这些值在提交一次后会被发送回浏览器。因此，想象一个正在提交的表单，或者这些值在服务器端绑定或设置并输出到预先填充的浏览器的任何情况（而不是使用默认值或空值输出到浏览器）。如果我默认加载页面（空文本框），输入一些文本，然后触发 js 函数清除这些字段，我输入的值永远不会到达服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T17:44:53.503

为什么需要禁用这些字段？禁用控件可以使它们无法将值发布到服务器......至少当 asp.net 控件被禁用服务器端时会发生这种情况。

**更新1：**不能怀疑它是否只是服务器端，所以我查了一下:) [http://www.w3.org/TR/html401/interact/forms.html#h-17.12.1](http://www.w3.org/TR/html401/interact/forms.html#h-17.12.1)。 ..“在本例中，INPUT 元素被禁用。因此，它无法接收用户输入，也不会随表单提交其值。”，所以我是对的，即使在客户端禁用它也不会发布值

# sql - SQL 设置来自另一个查询的列名

> ID：603183
> 
> 赞同：1
> 
> 时间：2009-03-02T17:25:51.893
> 
> 标签：sql, reporting-services

我正在使用 MS Reporting Services 绘制 Oracle 数据库中的一些数据。我想用另一个 select 语句中的值来命名我的 select 语句中的列。这可能吗？

喜欢而不是

```
Select Column1 As 'Test' From Table1 
```

我可以做类似的事情吗

```
Select Column1 As (Select column2 from Table2 where Value = 1) From Table1 
```

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T17:29:00.653

我认为您必须单独查询，然后动态形成查询。有兴趣看看是否有不同的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T18:11:04.717

我的 PL/SQL 有点生疏了，所以接下来的伪代码比可编译和测试的代码还要多。这完全不在我的脑海中。但是如果你知道表中列的具体序号位置，你可以试试这个：

列名 varchar2(50) :=

```
Select column_name
From all_tab_columns c 
Where lower(table_name) = '<% Your Table2 Name %>' And
    column_id = 9 -- The appropriate ordinal
Order By column_id; 
```

从 Table1 中选择 Column1 作为 columnName；

可能有更多从“all_tab_columns”中提取的列值也会对您有所帮助。环顾四周，看看。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T18:34:51.463

您可以将所有需要的列名查询到单独的报表数据集中，创建隐藏的多值报表参数 vColumns，以列作为参数默认值设置数据集，并将其用作字符串数组：
Parameters!vColumns(0).Value - 将是第一个列等，因此您可以将它们用作查询参数。

请参阅[第 4 课：添加多值参数](http://msdn.microsoft.com/en-us/library/aa337396(SQL.90).aspx)

# putty - 如何向腻子发送命令

> ID：603187
> 
> 赞同：1
> 
> 时间：2009-03-02T17:27:08.863
> 
> 标签：putty

我正在用 C 编写一个简单的可执行文件，它需要打开一个 putty 会话并向其发送命令，然后关闭 putty。我可以打开/关闭 putty 会话（我还不错），但我不太确定如何向 putty 发送命令。

有任何想法吗？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T17:39:21.190

从[腻子常见问题解答](http://www.chiark.greenend.org.uk/~sgtatham/putty/faq.html#faq-ipc)：

> 如何使用 PuTTY 从另一个程序中建立 SSH 连接？
> 
> 最好的选择可能是使用命令行连接工具 Plink。如果您可以将 Plink 作为第二个 Windows 进程启动，并安排您的主进程能够通过管道将数据发送到 Plink 进程并从中接收数据，那么您应该能够从您的程序建立 SSH 连接。
> 
> 例如，这就是 CVS for Windows 所做的。

除了直接打开站点外，Plink 还可以使用 PuTTY 保存的会话。

PLink 的选项记录在PuTTY 手册的[第 7 章中。](http://tartarus.org/~simon/putty-snapshots/htmldoc/Chapter7.html#plink)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T17:38:42.177

使用 DLL，卢克。[http://www.winputty.com/](http://www.winputty.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T17:32:39.367

你看过[QuickPutty](http://www.deckmyn.org/olivier/software)的源代码吗？它是 LGPL 许可的。

# java - Ant 和 Maven 的区别

> ID：603189
> 
> 赞同：184
> 
> 时间：2009-03-02T17:27:58.457
> 
> 标签：java, maven-2, ant, build-management

有人能告诉我 Ant 和 Maven 之间的区别吗？我也从未使用过。我知道它们用于自动化 Java 项目的构建，但我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：222
> 
> 时间：2009-03-30T21:33:24.030

在[Maven: The Definitive Guide](http://www.sonatype.com/books/maven-book/reference/public-book.html)中，我在简介中写了关于 Maven 和 Ant 之间的差异的部分标题是[“Ant 和 Maven 之间的差异”](http://www.sonatype.com/books/maven-book/reference/installation-sect-compare-ant-maven.html)。这是一个答案，它结合了该介绍中的信息和一些附加说明。

**一个简单的比较**

我向您展示这个只是为了说明，在最基本的层面上，Maven 具有内置约定。这是一个简单的 Ant 构建文件：

```
<project name="my-project" default="dist" basedir=".">
    <description>
        simple example build file
    </description>   
    <!-- set global properties for this build -->   
    <property name="src" location="src/main/java"/>
    <property name="build" location="target/classes"/>
    <property name="dist"  location="target"/>

    <target name="init">
      <!-- Create the time stamp -->
      <tstamp/>
      <!-- Create the build directory structure used by compile -->
      <mkdir dir="${build}"/>   
    </target>

    <target name="compile" depends="init"
        description="compile the source " >
      <!-- Compile the java code from ${src} into ${build} -->
      <javac srcdir="${src}" destdir="${build}"/>  
    </target>

    <target name="dist" depends="compile"
        description="generate the distribution" >
      <!-- Create the distribution directory -->
      <mkdir dir="${dist}/lib"/>

      <!-- Put everything in ${build} into the MyProject-${DSTAMP}.jar file
-->
      <jar jarfile="${dist}/lib/MyProject-${DSTAMP}.jar" basedir="${build}"/>
   </target>

   <target name="clean"
        description="clean up" >
     <!-- Delete the ${build} and ${dist} directory trees -->
     <delete dir="${build}"/>
     <delete dir="${dist}"/>
   </target>
 </project> 
```

在这个简单的 Ant 示例中，您可以看到您必须如何准确地告诉 Ant 要做什么。有一个编译目标，其中包括将 src/main/java 目录中的源代码编译到 target/classes 目录的 javac 任务。您必须准确地告诉 Ant 您的源代码在哪里，您希望生成的字节码存储在哪里，以及如何将这一切打包到一个 JAR 文件中。尽管最近的一些发展有助于减少 Ant 的过程性，但开发人员使用 Ant 的经验是编写用 XML 编写的过程性语言。

将前面的 Ant 示例与 Maven 示例进行对比。在 Maven 中，要从一些 Java 源创建 JAR 文件，您需要做的就是创建一个简单的 pom.xml，将源代码放在 ${basedir}/src/main/java 中，然后从命令行运行 mvn install . 实现相同结果的示例 Maven pom.xml。

```
<project>
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.sonatype.mavenbook</groupId>
  <artifactId>my-project</artifactId>
  <version>1.0</version>
</project> 
```

这就是你在 pom.xml 中所需要的。从命令行运行 mvn install 将处理资源、编译源代码、执行单元测试、创建 JAR 并将 JAR 安装在本地存储库中以便在其他项目中重用。无需修改，您可以运行 mvn site 然后在 target/site 中找到一个 index.html 文件，其中包含指向 JavaDoc 的链接和一些关于您的源代码的报告。

诚然，这是最简单的示例项目。仅包含源代码并生成 JAR 的项目。遵循 Maven 约定且不需要任何依赖项或自定义的项目。如果我们想开始自定义行为，我们的 pom.xml 将会变大，在最大的项目中，您可以看到非常复杂的 Maven POM 集合，其中包含大量插件自定义和依赖声明。但是，即使您的项目的 POM 文件变得更加庞大，它们所保存的信息类型也与使用 Ant 的类似大小项目的构建文件完全不同。Maven POM 包含声明：“这是一个 JAR 项目”和“源代码在 src/main/java 中”。Ant 构建文件包含明确的指令：“这是项目”、“`src/main/java`”、“`javac`针对这个目录运行”、“将结果放入`target/classses`”、“从 .... 创建一个 JAR”等。Ant 必须明确说明该过程，而 Maven 有一些“内置”的东西只知道源代码在哪里以及应该如何处理。

**高级比较**

这个例子中 Ant 和 Maven 的区别？蚂蚁...

*   没有像通用项目目录结构这样的正式约定，您必须准确地告诉 Ant 在哪里可以找到源代码以及在哪里放置输出。随着时间的推移，非正式的约定已经出现，但它们还没有被编入产品中。
*   是程序性的，你必须准确地告诉 Ant 做什么以及什么时候做。你必须告诉它编译，然后复制，然后压缩。
*   没有生命周期，您必须定义目标和目标依赖项。您必须手动将一系列任务附加到每个目标。

马文在哪里...

*   有约定，它已经知道你的源代码在哪里，因为你遵循了约定。它将字节码放在目标/类中，并在目标中生成一个 JAR 文件。
*   是声明性的。您所要做的就是创建一个 pom.xml 文件并将您的源代码放在默认目录中。Maven 负责其余的工作。
*   有一个生命周期，您在执行`mvn install`. 该命令告诉 Maven 执行一系列序列步骤，直到它到达生命周期。作为整个生命周期旅程的副作用，Maven 执行了许多默认插件目标，这些目标执行诸如编译和创建 JAR 之类的事情。

**常春藤呢？**

是的，所以像史蒂夫拉夫兰这样的人会读到这个比较并吹犯规。他将讨论答案如何完全忽略了称为 Ivy 的东西，以及 Ant 可以在最新版本的 Ant 中重用构建逻辑的事实。这是真实的。如果您有一群聪明的人使用 Ant + antlibs + Ivy，那么您最终会得到一个设计良好且有效的构建。尽管如此，我非常确信 Maven 是有意义的，但我很乐意将 Ant + Ivy 与一个拥有非常敏锐的构建工程师的项目团队一起使用。话虽如此，我确实认为您最终会错过许多有价值的插件，例如 Jetty 插件，并且您最终会做一大堆您不需要随着时间的推移做的工作。

**比 Maven vs. Ant 更重要**

1.  是您使用存储库管理器来跟踪软件工件。我建议[下载 Nexus](http://nexus.sonatype.org)。您可以使用 Nexus 代理远程存储库，并为您的团队提供一个地方来部署内部工件。
2.  您对软件组件进行了适当的模块化。一个大的整体组件很少随着时间的推移而扩展。随着项目的发展，您将需要模块和子模块的概念。Maven 非常适合这种方法。
3.  您为构建采用了一些约定。即使您使用 Ant，您也应该努力采用与其他项目一致的某种形式的约定。当一个项目使用 Maven 时，这意味着任何熟悉 Maven 的人都可以选择构建并开始运行它，而不必为了弄清楚如何编译该东西而摆弄配置。

* * *

## 回答 #2

> 赞同：113
> 
> 时间：2009-06-18T03:12:01.743

**Maven 是一个框架，Ant 是一个工具箱**

Maven 是一辆预制的公路车，而 Ant 是一套汽车零件。使用 Ant，您必须制造自己的汽车，但至少如果您需要进行任何越野驾驶，您可以制造合适类型的汽车。

换句话说，Maven 是一个框架，而 Ant 是一个工具箱。如果您对在框架范围内工作感到满意，那么 Maven 就可以了。对我来说，问题是我一直碰到框架的界限，它不会让我出去。

**XML 详细程度**

tobrien 是一个非常了解 Maven 的人，我认为他对这两种产品进行了非常好的、诚实的比较。他将一个简单的 Maven pom.xml 与一个简单的 Ant 构建文件进行了比较，并提到了 Maven 项目如何变得更加复杂。我认为值得看一下您在简单的实际项目中更有可能看到的几个文件的比较。以下文件代表多模块构建中的单个模块。

一、Maven文件：

```
<project 
    xmlns="http://maven.apache.org/POM/4.0.0" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-4_0_0.xsd">

    <parent>
        <groupId>com.mycompany</groupId>
        <artifactId>app-parent</artifactId>
        <version>1.0</version>
    </parent>

    <modelVersion>4.0.0</modelVersion>
    <artifactId>persist</artifactId>
    <name>Persistence Layer</name>

    <dependencies>

        <dependency>
            <groupId>com.mycompany</groupId>
            <artifactId>common</artifactId>
            <scope>compile</scope>
            <version>${project.version}</version>
        </dependency>

        <dependency>
            <groupId>com.mycompany</groupId>
            <artifactId>domain</artifactId>
            <scope>provided</scope>
            <version>${project.version}</version>
        </dependency>

        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate</artifactId>
            <version>${hibernate.version}</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>commons-lang</groupId>
            <artifactId>commons-lang</artifactId>
            <version>${commons-lang.version}</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring</artifactId>
            <version>${spring.version}</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>org.dbunit</groupId>
            <artifactId>dbunit</artifactId>
            <version>2.2.3</version>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>org.testng</groupId>
            <artifactId>testng</artifactId>
            <version>${testng.version}</version>
            <scope>test</scope>
            <classifier>jdk15</classifier>
        </dependency>

        <dependency>
            <groupId>commons-dbcp</groupId>
            <artifactId>commons-dbcp</artifactId>
            <version>${commons-dbcp.version}</version>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>com.oracle</groupId>
            <artifactId>ojdbc</artifactId>
            <version>${oracle-jdbc.version}</version>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>org.easymock</groupId>
            <artifactId>easymock</artifactId>
            <version>${easymock.version}</version>
            <scope>test</scope>
        </dependency>

    </dependencies>

</project> 
```

和等效的 Ant 文件：

```
<project name="persist" >

    <import file="../build/common-build.xml" />

    <path id="compile.classpath.main">
        <pathelement location="${common.jar}" />
        <pathelement location="${domain.jar}" />
        <pathelement location="${hibernate.jar}" />
        <pathelement location="${commons-lang.jar}" />
        <pathelement location="${spring.jar}" />
    </path>

    <path id="compile.classpath.test">
        <pathelement location="${classes.dir.main}" />
        <pathelement location="${testng.jar}" />
        <pathelement location="${dbunit.jar}" />
        <pathelement location="${easymock.jar}" />
        <pathelement location="${commons-dbcp.jar}" />
        <pathelement location="${oracle-jdbc.jar}" />
        <path refid="compile.classpath.main" />
    </path>

    <path id="runtime.classpath.test">
        <pathelement location="${classes.dir.test}" />
        <path refid="compile.classpath.test" />
    </path>

</project> 
```

tobrien 使用他的示例来说明 Maven 具有内置约定，但这并不一定意味着您最终会编写更少的 XML。我发现事实恰恰相反。pom.xml 比 build.xml 长 3 倍，并且没有偏离约定。事实上，我的 Maven 示例没有显示配置插件所需的额外 54 行。该 pom.xml 用于一个简单的项目。当您开始添加额外的需求时，XML 确实开始显着增长，这对于许多项目来说并不少见。

**但是你必须告诉 Ant 该怎么做**

当然，我上面的 Ant 示例并不完整。我们仍然需要定义用于清理、编译、测试等的目标。这些目标是在一个通用构建文件中定义的，该文件由多模块项目中的所有模块导入。这让我明白了所有这些东西必须在 Ant 中显式编写，而在 Maven 中是声明性的。

的确，如果我不必显式编写这些 Ant 目标，它会节省我的时间。但是多少时间？我现在使用的通用构建文件是我 5 年前编写的，从那时起只做了轻微的改进。在我对 Maven 进行了 2 年的实验之后，我将旧的 Ant 构建文件从壁橱里拿出来，掸掉了灰尘，然后重新开始工作。对我来说，在 5 年的时间里，必须明确告诉 Ant 做什么的成本加起来不到一周。

**复杂**

我想提到的下一个主要区别是复杂性及其对现实世界的影响。构建 Maven 的目的是减少负责创建和管理构建过程的开发人员的工作量。为了做到这一点，它必须很复杂。不幸的是，这种复杂性往往会否定他们的预期目标。

与 Ant 相比，Maven 项目的构建人员会花费更多时间：

*   阅读文档：关于 Maven 的文档要多得多，因为你需要学习的东西还有很多。
*   教育团队成员：他们发现向知道的人提问比自己寻找答案更容易。
*   构建故障排除：Maven 不如 Ant 可靠，尤其是非核心插件。此外，Maven 构建是不可重复的。如果您依赖于插件的 SNAPSHOT 版本，这很可能，您的构建可能会在您没有更改任何内容的情况下中断。
*   编写 Maven 插件：插件通常在编写时考虑到特定的任务，例如创建一个 webstart 包，这使得将它们重用于其他任务或将它们组合以实现目标变得更加困难。因此，您可能必须编写自己的一个来解决现有插件集中的空白。

相比之下：

*   Ant 文档简洁、全面且集中在一处。
*   蚂蚁很简单。尝试学习 Ant 的新开发人员只需要了解一些简单的概念（目标、任务、依赖项、属性），就能够弄清楚他们需要了解的其余内容。
*   蚂蚁是可靠的。在过去的几年里，Ant 的发布并不多，因为它已经可以工作了。
*   Ant 构建是可重复的，因为它们通常是在没有任何外部依赖项的情况下创建的，例如在线存储库、实验性第三方插件等。
*   蚂蚁是全面的。因为它是一个工具箱，所以您可以组合这些工具来执行几乎任何您想要的任务。如果您需要编写自己的自定义任务，这很简单。

**熟悉度**

另一个区别是熟悉程度。新开发人员总是需要时间来跟上进度。熟悉现有产品在这方面有所帮助，Maven 支持者正确地声称这是 Maven 的好处。当然，Ant 的灵活性意味着您可以创建任何您喜欢的约定。所以我使用的约定是将我的源文件放在一个目录名 src/main/java 中。我编译的类进入一个名为 target/classes 的目录。听起来很熟悉是不是。

我喜欢 Maven 使用的目录结构。我认为这是有道理的。还有他们的构建生命周期。所以我在我的 Ant 构建中使用相同的约定。不仅因为它有意义，而且因为任何以前使用过 Maven 的人都会熟悉它。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-03-02T17:42:34.567

Ant主要是一个构建工具。

Maven 是一个项目和依赖项管理工具（当然也可以构建您的项目）。

如果您想避免使用 Maven， Ant+ [Ivy](http://ant.apache.org/ivy/)是一个很好的组合。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-03-02T18:30:41.910

仅列出更多差异：

*   Ant 没有正式的约定。您必须准确地告诉 Ant 在哪里可以找到源代码、在哪里放置输出等等。
*   蚂蚁是程序性的。你必须准确地告诉 Ant 该怎么做；告诉它编译，复制，然后压缩等。
*   Ant 没有生命周期。
*   Maven 使用约定。只要您遵循这些约定，它就会自动知道您的源代码在哪里。你不需要告诉 Maven 它在哪里。
*   Maven 是声明性的；您所要做的就是创建一个 pom.xml 文件并将您的源代码放在默认目录中。Maven 将负责其余的工作。
*   Maven 有一个生命周期。您只需调用*mvn install*并执行一系列序列步骤。
*   Maven 具有关于常见项目任务的智能。要运行测试，只要文件位于默认位置，只需执行*mvn test即可。*在 Ant 中，您首先需要 JUnit JAR 文件，然后创建一个包含 JUnit JAR 的类路径，然后告诉 Ant 它应该在哪里查找测试源代码，编写一个编译测试源的目标，然后最后执行单元测试与 JUnit。

**更新：**

这来自[Maven：权威指南](http://oreilly.com/catalog/9780596517335/index.html)。对不起，我完全忘了引用它。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-03-02T17:41:21.390

[Maven还是蚂蚁？](https://stackoverflow.com/questions/80622/maven-or-ant)是一个与此问题非常相似的问题，它应该可以帮助您回答您的问题。

[什么是马文？](http://maven.apache.org/what-is-maven.html)在官方网站上。

**编辑：**对于一个新的/未开发的项目，我建议使用 Maven：“约定优于配置”将为您节省大量编写和设置构建和部署脚本的时间。当您使用 ant 时，构建脚本的长度和复杂性往往会随着时间的推移而增长。对于现有项目，很难将它们的配置/布局硬塞到 Maven 系统中。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2009-03-02T18:49:47.120

Maven 既可以作为依赖管理工具——它可以用来从中央存储库或你设置的存储库中检索 jars——也可以作为声明性构建工具。“声明式”构建工具与更传统的 ant 或 make 等构建工具之间的区别在于您配置需要完成的工作，而不是如何完成。例如，您可以在 maven 脚本中说项目应该打包为 WAR 文件，而 maven 知道如何处理它。

Maven 依赖于项目目录布局的约定以实现其“声明性”。例如，它对放置主代码的位置、放置 web.xml 的位置、单元测试的位置等有一个约定，但也可以在需要时更改它们。

您还应该记住，在 maven 中有一个用于运行 ant 命令的插件：

[http://maven.apache.org/plugins/maven-ant-plugin/](http://maven.apache.org/plugins/maven-ant-plugin/)

此外，maven 的原型使项目的启动速度非常快。例如，有一个 Wicket 原型，它提供了一个 maven 命令，您可以运行该命令来获得一个完整的、可立即运行的 hello world 类型的项目。

[https://wicket.apache.org/start/quickstart.html](https://wicket.apache.org/start/quickstart.html)

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-05-07T03:03:17.780

我可以带一个从未见过 Ant 的人——它`build.xml`的 s 写得相当好——他们可以理解发生了什么。我可以让同一个人向他们展示一个 Maven POM，他们不会知道发生了什么。

在一个庞大的工程组织中，人们写到 Ant 文件变得庞大且难以管理。我已经编写了这些类型*并*清理了 Ant 脚本。它真的是提前了解您需要做的事情，并设计一组可以在 3 年以上的时间内响应变化和扩展的模板。

除非你有一个简单的项目，否则学习 Maven 约定和 Maven 完成工作的方式是相当多的工作。

归根结底，您不能将使用 Ant 或 Maven 的项目启动视为一个因素：这实际上是总拥有成本。组织需要在几年内维护和扩展其构建系统是必须考虑的主要因素之一。

构建系统最重要的方面是依赖管理和表达构建配方的灵活性。如果做得好，它必须有点直观。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-03-02T17:39:52.360

我会说这取决于您项目的大小......就个人而言，我会将 Maven 用于需要直接编译、打包和部署的简单项目。一旦您需要做一些更复杂的事情（许多依赖项，创建映射文件......），我会切换到 Ant......

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-03-02T17:32:03.737

Maven 还包含一个大型的常用开源项目存储库。在构建期间，Maven 可以为您下载这些依赖项（以及您的依赖项依赖项:)），以使构建项目的这一部分更易于管理。

# c# - 格式化数据绑定标签事件

> ID：603193
> 
> 赞同：0
> 
> 时间：2009-03-02T17:28:45.943
> 
> 标签：c#, .net, winforms

我有 Windows 窗体应用程序和一个基于 DataGridView 选择的数据绑定标签。我要做的是在选择网格中的新行后格式化标签文本（以字节为单位的文件大小）。我该如何连接？我尝试使用 TextChanged，但我的格式化函数被调用了两次，一次是在将数据绑定文本添加到标签时，一次是在我将文本格式化为我想要的之后。我可以在这里放一个 if 或 try catch 来阻止它第二次，但希望有更好的方法来做到这一点。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T17:36:56.080

不要使用该`TextChanged`事件。相反，获取连接到绑定的 Format 事件并附加到绑定的`Binding`实例。`Label`

然后，当数据更改并更新标签时，将触发 Format 事件，并且在该事件处理程序中，您可以以自定义方式设置格式（我假设使用常规格式字符串无法表达）。

# python - 有标签时查找锚文本

> ID：603199
> 
> 赞同：3
> 
> 时间：2009-03-02T17:29:43.977
> 
> 标签：python, regex

我想在一对链接到给定站点的 <a> 标记之间找到文本

这是我用来查找内容的 re 字符串：

```
r'''(<a([^<>]*)href=("|')(http://)?(www\.)?%s([^'"]*)("|')([^<>]*)>([^<]*))</a>''' % our_url 
```

结果将是这样的：

```
r'''(<a([^<>]*)href=("|')(http://)?(www\.)?stackoverflow.com([^'"]*)("|')([^<>]*)>([^<]*))</a>''' 
```

这对于大多数链接来说都很好，但它会因为其中包含标签的链接而出错。我尝试将正则表达式的最后一部分从：

```
([^<]*))</a>''' 
```

到：

```
(.*))</a>''' 
```

但这只是链接后页面上的所有内容，这是我不想要的。关于我能做些什么来解决这个问题有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T17:37:13.863

代替：

```
[^<>]* 
```

尝试：

```
((?!</a).)* 
```

换句话说，匹配任何不是`</a`序列开头的字符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T00:13:46.640

```
>>> import re
>>> pattern = re.compile(r'<a.+href=[\'|\"](.+)[\'|\"].*?>(.+)</a>', re.IGNORECASE)
>>> link = '<a href="http://stackoverflow.com/questions/603199/finding-anchor-text-when-there-are-tags-there">Finding anchor text when there are tags there</a>'
>>> re.match(pattern, link).group(1)
'http://stackoverflow.com/questions/603199/finding-anchor-text-when-there-are-tags-there'
>>> re.match(pattern, link).group(2)
'Finding anchor text when there are tags there' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T17:32:17.637

我不会使用正则表达式 - 使用像[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/)这样的 HTML 解析器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T17:32:35.403

做一个非贪婪的搜索，即

```
(.*?) 
```

# php - 在 PHP 中使用彗星？

> ID：603201
> 
> 赞同：83
> 
> 时间：2009-03-02T17:30:18.670
> 
> 标签：php, comet

我正在考虑使用 PHP 后端实现实时聊天，但我在一个讨论彗星的网站上遇到了这个评论：

> 我的理解是 PHP 对于 Comet 来说是一种糟糕的语言，因为 Comet 要求您保持对每个浏览器客户端的持久连接。使用 mod_php 这意味着为每个根本无法扩展的客户端绑定一个全职的 Apache 孩子。我认识的从事 Comet 工作的人大多使用 Twisted Python，它旨在处理成百上千的同时连接。

这是真的？或者它是可以配置的东西？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-11-23T15:09:31.643

同意/扩展已经说过的话，我认为 FastCGI 不会解决问题。

## 阿帕奇

对 Apache 的每个请求都将使用一个工作线程，直到请求完成，这对于 COMET 请求可能需要很长时间。

[这篇关于 Ajaxian](http://ajaxian.com/archives/comet-with-apache-and-jetty)的文章提到在 Apache 上使用 COMET，这很困难。该问题并非特定于 PHP，而是适用于您可能希望在 Apache 上使用的任何后端 CGI 模块。

建议的解决方案是使用['event' MPM 模块](http://httpd.apache.org/docs/2.2/mod/event.html)，它改变了请求被分派到工作线程的方式。

> 此 MPM 尝试修复 HTTP 中的“保持活动状态”问题。客户端完成第一个请求后，客户端可以保持连接打开，并使用同一个套接字发送更多请求。这可以在创建 TCP 连接时节省大量开销。然而，Apache 传统上让整个子进程/线程等待来自客户端的数据，这也带来了自身的缺点。为了解决这个问题，这个 MPM 使用一个专用线程来处理 Listening 套接字和所有处于 Keep Alive 状态的套接字。

不幸的是，这也不起作用，因为它只会在请求完成*后*“打盹” ，等待来自客户端的新请求。

## PHP

现在，考虑到问题的另一面，即使您解决了每个彗星请求保留一个线程的问题，您仍然需要每个请求一个 PHP 线程——这就是为什么 FastCGI 无济于事。

您需要类似[Continuations](http://en.wikipedia.org/wiki/Continuation)的东西，它允许在观察到它们触发的事件时恢复彗星请求。AFAIK，这在 PHP 中是不可能的。我只在 Java 中见过它——请参阅 Apache [Tomcat 服务器](http://tomcat.apache.org/tomcat-6.0-doc/aio.html)。

**编辑：**

这里有[一篇](http://iamseanmurphy.com/2009/03/02/high-performance-comet-on-a-shoestring/)关于使用负载平衡器 ( [HAProxy](http://haproxy.1wt.eu/) ) 的文章，允许您在同一服务器的 80 端口上同时运行 apache 服务器和启用彗星的服务器（例如，jetty、tomcat for Java）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2010-08-27T21:29:32.503

您可以使用 Nginx 和 JavaScript 来实现基于 Comet 的聊天系统，该系统非常可扩展，内存或 CPU 使用率极低。

我在这里有一个非常简单的示例，可以帮助您入门。它涵盖了使用 NHPM 模块编译 Nginx，并包含 jQuery、PHP 和 Bash 中简单发布者/订阅者角色的代码。

[http://blog.jamieisaacs.com/2010/08/27/comet-with-nginx-and-jquery/](http://blog.jamieisaacs.com/2010/08/27/comet-with-nginx-and-jquery/)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-08-24T23:26:57.897

## PHP

我发现这个有趣的小[截屏视频](http://screenr.com/SNH)解释了简单的彗星。作为旁注，我真的认为这会在任何实际负载下杀死您的服务器。当只有几个用户时，我会说只使用这个解决方案。这个解决方案实现起来非常简单（截屏只需要您 5 分钟的时间 :)）。但正如我之前所说，我认为这对很多并发用户来说并不好（猜你应该对其进行基准测试；））因为：

1.  它使用文件 I/O，这比从内存中获取数据要慢得多。例如功能`filemtime()`，
2.  其次，但我认为至少 PHP 没有一个像样的线程模型。PHP 并不是为此而设计的，因为[没有共享模型](http://talks.php.net/show/lt2004-lamp/3)。就像幻灯片上所说的“共享数据被推送到数据存储层”，例如 MySQL。

## 备择方案

如果你想做任何彗星/长轮询，我真的认为你应该尝试其他选择。您可以使用多种语言，例如：

*   Java/JVM：码头[延续](http://docs.codehaus.org/display/JETTY/Continuations)。
*   蟒蛇：达斯汀的[晃动](https://stackoverflow.com/questions/333664/simple-long-polling-example-code/338685#338685)。
*   Erlang：comet/etc 的流行语言。
*   Lua、Ruby、C、Perl 仅举几例。

只需执行一个简单的谷歌搜索，就会向您展示很多 PHP 替代方案（我认为在任何大负载上都会杀死您的服务器）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-02T17:46:20.003

mod_php 不是使用 PHP 的唯一方法。你可以使用fastcgi。PHP 必须用`--enable-fastcgi`.

PHP 作为 FastCGI：[http ://www.fastcgi.com/drupal/node/5?q=node/10](http://www.fastcgi.com/drupal/node/5?q=node/10)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-01-21T09:54:41.887

你也可以试试[https://github.com/reactphp/react](https://github.com/reactphp/react)

> React 是 PHP 中用于事件驱动编程的低级库。它的核心是一个事件循环，在它之上它提供了低级实用程序，例如：流抽象、异步 dns 解析器、网络客户端/服务器、http 客户端/服务器、与进程的交互。第三方库可以使用这些组件来创建异步网络客户端/服务器等。
> 
> 事件循环基于反应器模式（因此得名），并受到 EventMachine (Ruby)、Twisted (Python) 和 Node.js (V8) 等库的强烈启发。

介绍性示例显示了一个侦听端口 1337 的简单 HTTP 服务器：

```
<?php

$i = 0;

$app = function ($request, $response) use (&$i) {
    $i++;

    $text = "This is request number $i.\n";
    $headers = array('Content-Type' => 'text/plain');

    $response->writeHead(200, $headers);
    $response->end($text);
};

$loop = React\EventLoop\Factory::create();
$socket = new React\Socket\Server($loop);
$http = new React\Http\Server($socket);

$http->on('request', $app);

$socket->listen(1337);
$loop->run(); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-24T21:05:13.297

我有一个类似的问题。我发现有趣的一个选项是使用现有的 Comet 服务器，如 cometd-java 或 cometd-python，作为核心消息中心。然后，您的 PHP 代码只是 Comet 服务器的客户端——它可以像其他客户端一样从频道发布或读取消息。

这里链接了一个有趣的代码片段：http: [//morglog.org/](http://morglog.org/?p=22=1) ?p=22=1 ，它实现了这个方法的一部分（尽管也有一些调试代码）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-07-27T21:27:22.667

您将很难在 PHP 中实现 comet，因为它固有的单线程特性。

查看[Websync On-Demand](http://www.frozenmountain.com/websync) - 该服务允许您通过服务器端发布集成 PHP，卸载繁重的并发连接内容，并让您立即创建实时聊天应用程序。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-11-18T06:55:27.180

我目前正在使用套接字函数实现一个可扩展的 PHP Comet 服务器。它被称为 'phet' ( [ph]p com[et] )

项目页面：http: [//github.com/Tim-Smart/phet](http://github.com/Tim-Smart/phet)

免费免费加入开发。我目前已经设法完成大部分服务器逻辑，只需要完成客户端的东西。

编辑：最近使用该方法添加了“多线程”功能`pcntl_fork`:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-11-23T14:30:16.467

刚刚为 nginx Web 服务器推出了一个新模块，它将允许 Comet 使用任何语言，包括 PHP。

[http://www.igvita.com/2009/10/21/nginx-comet-low-latency-server-push/](http://www.igvita.com/2009/10/21/nginx-comet-low-latency-server-push/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-06-23T19:51:41.153

您将必须在 PHP 中创建自己的服务器。使用 Apache/mod_php 甚至 fastcgi 根本无法扩展。几年前，但可以让你开始：

PHP-彗星服务器：http: [//sourceforge.net/projects/comet/](http://sourceforge.net/projects/comet/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-02T17:48:11.420

我认为这更像是一个问题，因为有很多 apache 线程一直在运行是一个问题。如果它以与 PHP（通常）相同的方式通过 apache 工作，那么任何语言都将存在。

# wpf - 如何在 ItemTemplate 中找到我的“CheckBox”项目？

> ID：603203
> 
> 赞同：26
> 
> 时间：2009-03-02T17:30:52.723
> 
> 标签：wpf, itemscontrol

我有以下（非常简单的）ItemsControl：

```
<ItemsControl Name="BlahList" ItemsSource="{Binding Blah}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <CheckBox Name="MyCheckBox" Content="{Binding Text}" />
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

在代码中，我想做以下事情：

```
foreach (var dahCurrentItem in BlahList.Items)
{
    var ItemCheckBox = BlahList.GimmeMyControl(dahCurrentItem, "MyCheckBox")

    // I'm going to do something with the check box here...
} 
```

我怎么做？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-02T20:03:57.037

好的，肯特得到了赞扬，但它只是*大部分是*正确的:)

```
// This part was good:
var container = _itemsControl.ItemContainerGenerator.ContainerFromItem(dahCurrentItem) as FrameworkElement; 
```

但是......第二部分将返回null，所以它必须如下：

```
var checkBox = _itemsControl.ItemTemplate.FindName("MyCheckBox", container) as CheckBox; 
```

他的代码看起来应该可以工作，但就我而言，我不得不这样做。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-02T17:35:38.283

首先，如果有任何方法可以避免它，请不要这样做。将 的各种属性绑定`CheckBox`到您的视图模型而不是尝试手动将它们拉出来要干净得多。

也就是说，如果你需要访问你的`CheckBox`，你应该能够使用这样的代码：

```
var container = _itemsControl.ItemContainerGenerator.ContainerFromItem(dahCurrentItem) as FrameworkElement;
var checkBox = container.FindName("MyCheckBox") as CheckBox; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-03T18:45:04.093

这是一个捕获包含您的 ItemsControl 项目的容器的示例：

```
 CheckBox checkbox = sender as CheckBox;

        foreach (var item in MembersItemsControl.Items)
        {
            var container = 
MembersItemsControl.ItemContainerGenerator.ContainerFromItem(item) as FrameworkElement;

            UserInformation user = container.DataContext as UserInformation;

            bool isMale = true;
            if (user.sex == isMale && checkbox.IsChecked.Value == true)
            {
                container.Visibility = System.Windows.Visibility.Visible;
            }
        } 
```

我希望这会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-30T15:00:29.880

我使用了 Kent 和 Timothy 提供的代码，但我也需要这一行。

整个代码片段如下：

```
var container = _itemsControl.ItemContainerGenerator.ContainerFromItem(dahCurrentItem) as FrameworkElement;
container.ApplyTemplate()
var checkBox = _itemsControl.ItemTemplate.FindName("MyCheckBox", container) as CheckBox; 
```

干杯!

# sharepoint - 使用 xslt 将 guid 附加到超链接

> ID：603208
> 
> 赞同：2
> 
> 时间：2009-03-02T17:31:58.573
> 
> 标签：sharepoint, xslt

我在sharepoint中返回了一些xml，我使用xslt像这样创建超链接。

```
<a href="{substring-before(Sign-up-Link,',')}">
    Sign up for event
</a> 
```

我还在`<guid>1234</guid>`xml 中返回了一个元素，我想要它，以便链接将带有作为查询字符串附加的 guid

例如[http://www.foo.com/signup.aspx?guid=1234](http://www.foo.com/signup.aspx?guid=1234)

我如何附加 guid？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T17:34:40.780

取决于 guid 在 xml 中出现的位置，但我想 concat() 会做到这一点，例如

```
<a href="{concat(substring-before(Sign-up-Link,','),'?guid=',guid)}"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T19:13:14.250

```
 <a>
            <xsl:attribute name="href">
                {substring-before(Sign-up-Link,',')}?guid=
                <xsl:value-of select="@guid">
                </xsl:value-of>
            </xsl:attribute>
            <xsl:attribute name="class">
                SignUpLink
            </xsl:attribute>
            Sign Up
        </a> 
```

那可能行得通...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-03T20:39:33.947

```
<a href="{substring-before(Sign-up-Link,',')}?guid={XPathExpression---Selecting---The---GUID}">
    Sign up for event
</a> 
```

**由于没有显示实际的 XML 文档，我们无法猜测使用什么 XPath 表达式来选择它**。

因此，在`href`上述文字结果元素的属性中，第二个 AVT（attribute-value-template）仅包含此 XPath 表达式的占位符。

# solaris - shell 脚本如何知道它在 Solaris 区域中运行？

> ID：603212
> 
> 赞同：5
> 
> 时间：2009-03-02T17:32:23.297
> 
> 标签：solaris

shell 脚本在 Solaris 实例中安装和配置一些服务和应用程序。其中一项服务是 NTP - 但 NTP 不能在非全局区域中运行（它可以，但 xntpd 在尝试调整时钟时失败；相反，该区域从全局区域继承时间）。

shell 脚本如何判断它确实在非全局 Solaris 区域中运行，以便在这些情况下跳过 NTP 配置步骤？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T18:45:43.013

使用`zonename(1)`. 在全局区域（或在没有任何区域的独立服务器上）中，这将返回字符串`global`。

```
NAME
   zonename - print name of current zone

SYNOPSIS
   zonename

DESCRIPTION
   The zonename utility prints the name of the current zone.

... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T18:01:44.147

您也可以尝试`zoneadm list -cv`，在全局区域中，您将看到如下输出：

```
# zoneadm list -cv
ID NAME             STATUS         PATH
0 global           running        /
1 zone1            running        /zones/zone1 
```

而在任何其他区域中，您只会看到该特定区域，例如

```
# zoneadm list -cv
ID NAME             STATUS         PATH
1 zone1            running        /zones/zone1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T09:45:02.813

好吧，如果您在区域内运行脚本并希望确保它在区域上运行，那么运行以下命令

```
arp -a |grep SP 
```

您可以在上述命令的输出中的 1 行中看到您的全局区域。根据此输出在脚本中应用检查可能会很有用。

# c# - 泛型问题（类型参数与构造函数）

> ID：603229
> 
> 赞同：-1
> 
> 时间：2009-03-02T17:35:42.277
> 
> 标签：c#, .net, generics, class

如果您有一个自定义集合类，它将单个水果类的权重单独存储在 float/double 中，如下所示：

```
1.1, 3.3, 6.6, 4.4, ... 
```

并且您需要指定它是浮点型还是双精度型并区分水果类型，这样做是否更好：

使用枚举：

```
FruitList<float, FruitType.Orange> 
```

或者

在构造函数中使用枚举：

```
FruitList<float> (FruitType.Orange) 
```

或者

使用一个类：

```
FruitList<float, Orange> 
```

或者

在构造函数中使用类：

```
FruitList<float> (Orange) 
```

让我感到困惑的是在 <> 区域中指定这些东西是否有意义（不知道那个区域叫什么）？

哪种做法更好、更快、更有效？

顺便说一句，Orange 类从来没有在任何地方使用过，如果这样指定类型有意义，就写它？

编辑：顺便说一句，这只是一个示例案例，而不是实际案例，但这清楚地反映了这一点。就像它都是浮点数/双精度数并传递给其他一些方法。但是这些方法需要知道正确执行哪种类型的水果。水果本身没有任何意义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T17:39:42.157

`FruitList<float>(FruitType.Orange)`可能是要走的路。

`float`不能是类型参数以外的任何东西。水果类型只是一个属性。创建单独的类型并为其使用类型参数是没有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T17:41:25.913

首先，枚举值不是类型，所以例子

```
FruitList<float, FruitType.Orange> 
```

不会工作。如果你想确保你的通用列表是静态类型的，`Orange`你将不得不使用这个

```
FruitList<float, Orange> 
```

即使您永远不会使用该`Orange`课程。如我所见，可能不需要，因为您可以在变量名中传达类型：

```
FruitList<float> orangeWeights = new FruitList<float>(FruitType.Orange); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T17:54:36.973

取决于你的橙色是否会像一个……标签……像颜色。汽车可以是蓝色和红色，但仍然是“相同”的汽车。如果你想让 Orange 能够做一些特别的事情，不同于普通水果或苹果的事情，我创建了一个抽象 Fruit 类和一个 Orange 子类，然后使用 <> 事物。如果只是一个标签的东西，比如颜色，那么我猜枚举可以做得很好。

我认为通过使用类/结构更容易进行类型检查等。比如，如果有人试图在你的水果清单中添加一些苹果类型的水果会发生什么？会变成橘子吗？是否必须检查水果的水果类型是否为橙色？如果不是，会发生什么？参数异常？

我想我会去上课和<>东西。但这就是我。实际上，如果是我，我想我会继续使用`decimal`重量和其他需要测量的东西......然后有类似的东西（完全错误的语法等，但希望你能明白）：

```
class FruitList<TFruit> where TFruit : Fruit {}

abstract class Fruit {public abstract decimal Weight {get; protected set; }}

class Orange : Fruit { ... } 
```

# security - 某些页面上显示的安全警告消息

> ID：603230
> 
> 赞同：0
> 
> 时间：2009-03-02T17:36:05.753
> 
> 标签：security

我正在使用 Jboss 应用程序服务器。我已经在 ssl (https) 上实现了整个网站，该网站在 Internet Explorer 浏览器上运行良好，但该网站在 Mozilla/Konqueror 浏览器上显示以下信息，但仅在特定页面上。

**安全警告：虽然此页面已加密，但您输入的信息将通过未加密的连接发送，并且很容易被第三方读取。你确定你要继续吗 ？继续取消**

这是Jboss的功能吗？

如果整个站点都在 https 上运行，那么为什么仅在特定页面上显示此信息？

我应该怎么做才能摆脱这个问题？

请帮帮我！！！！！！！！！我的 mailid 是**[已编辑]**

谢谢并恭祝安康，

阿赫塔尔巴特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T17:38:29.307

检查从非 SSL 位置请求的图像或其他资源。这通常是问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T18:02:34.053

在此处发布您的电子邮件地址可能不是最好的主意，它很可能会被垃圾邮件发送者收集（尽管 Gmail 确实有一个相当有效的垃圾邮件过滤器）。也极不可能有人通过电子邮件回复您，因为这会破坏 Stack Overflow 的目的，这可能就是您的问题被否决的原因。

要解决您的问题，您必须找到显示您所看到的对话框或消息的页面，然后查看该网页的来源。确保任何`<form>`标签的 action 属性要么是相对于当前服务器（即 - `action="/some/path/..."`），要么是绝对的但指向 https（即 - `action="https://some_server/some/path/..."`）。

如果您使用任何 AJAX 调用，您还必须确保它们使用的是 https。

该消息似乎不太可能是资源不安全地发送给您的结果。该消息似乎更有可能是`<form>`带有不正确属性的标签`action`或不安全的 AJAX 调用的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T18:12:15.980

检查 ACTION 属性的 FORM 标记。该操作应该是一个 HTTPS URL（如果是相对的，它应该是，但如果是绝对的，则可能不是。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-13T11:55:07.300

我想你会在这个页面上找到一些对你有帮助的信息

[http://blog.httpwatch.com/2009/04/23/fixing-the-ie-8-warning-do-you-want-to-view-only-the-webpage-content-that-was-delivered-安全/](http://blog.httpwatch.com/2009/04/23/fixing-the-ie-8-warning-do-you-want-to-view-only-the-webpage-content-that-was-delivered-securely/)

# wpf - WPF ListBox ListCollectionView 匿名类型导航问题

> ID：603232
> 
> 赞同：0
> 
> 时间：2009-03-02T17:36:46.033
> 
> 标签：wpf, datagrid, object, anonymous

问题示例：

框架：WPF 可视化控件：来自 CodePlex 的 DataGrid

```
public Window()
{
  InitializeComponent();

  var listView = new ListCollectionView(
    new[]
    {
       new 
       {   
         Bool = false,
         Str = "Value1"
       },
       new 
       {   
          Bool = false,
          Str = "Value1"
       }
     }.ToList());

  dataGrid.ItemsSource = listView;

  listView.MoveCurrentToFirst();
  listView.MoveCurrentToNext();
} 
```

如果更改其中一种匿名类型的值，则 DataGrid 游标不会将位置更改为 1：

```
var listView = new ListCollectionView(
    new[]
    {
       new 
       {   
         Bool = false,
         Str = "Value1"
       },
       new 
       {   
          Bool = false,
          Str = "Value2"
       }
     }.ToList()); 
```

光标工作正确且 SelectedIndex = 1。

我认为这是因为匿名对象覆盖 GetHashCode() 对于匿名对象 GetHashCode：所有字段的总和。如果匿名对象的 2 个不同实例的字段相同，则 GetHashCode() 将为两个实例返回相同的值。

也许 DataGrid 在内部使用 GetHashCode 比较对象并且不会更改 SelectedPosition。

有谁知道如何避免这个问题？将匿名对象分配给 DataGrid 是必需的，我无法创建强类型对象，这意味着我必须为对象创建一个包装器并自动生成列：

```
public class ViewItemHodler
{
   public object ViewItem { get; set; }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T18:28:32.697

DataGrid 上有一个 CustomSort 属性，您可以将其设置为`IComparer<T>`允许您为匿名类型实现自定义排序顺序的实现。这里有关于 CustomSort 属性的更多信息：

[http://blogs.msdn.com/jgoldb/archive/2008/08/26/improving-microsoft-datagrid-ctp-sorting-performance.aspx](http://blogs.msdn.com/jgoldb/archive/2008/08/26/improving-microsoft-datagrid-ctp-sorting-performance.aspx)

你要做的实际上是创建一个 shell 类，它接受一个`Comparer<T>`委托，然后在`IComparer<T>.Compare`.

这样，您可以使用 var 在创建匿名类型的代码中声明实例（因为您不知道 T 是什么）。

你被绑定到匿名类型并且不能创建强类型对象的想法有点荒谬。您没有从编译时未知的来源创建匿名查询，所以我不明白为什么要限制匿名类型。

# c# - 选择平台 C#/MsSql 或 Php/Mysql 或 JSP 还是什么？

> ID：603237
> 
> 赞同：0
> 
> 时间：2009-03-02T17:37:34.610
> 
> 标签：c#, php, mysql, sql-server, reporting-services

似乎这里有大量非常聪明的人，所以我认为这是问几个相关问题的最佳场所（无耻奉承）。您对任何项目的反馈将不胜感激。

我即将开发一个非常大的基于网络的运营、库存、销售管理系统。我原本打算使用 C#/MsSql/Reporting，但现在倾向于 Php/MySql。

1.  **多种设施支持**。我希望所有这些都在一个地方运行，但我需要每个设施能够在互联网连接中断的情况下相互独立运行。服务器可以驻留在每个设施中并复制到中央设施。MS Replication 将挂起大型数据库的数据库。MS 建议将数据库重组为更小的部分……谢谢。MySql 似乎具有非常可靠的可复制特性。关于这个问题的想法？
2.  **分销**：最终这可能会出售给业内其他公司。使用上述方法，我必须将系统分发到客户设施中的服务器。使用 C#，我可以分发已编译的代码。使用 PHP，任何知识产权都是易受攻击的。
3.  **报告**。我能用 PHP 打印标签和真正特别配置的报告吗？PDF导出是必须的。MsSql 有报告服务，但它在 PDF 字体嵌入方面存在问题，灵活性非常耗时，我认为手动构建它可能会更快。MS 打印控制似乎也有问题。
4.  **成本。** 负载可能永远不会超过 100 个同时点击。完整的 Ms 服务器许可成本过高。sql express 会支持这种负载吗？MySql 成本结构非常吸引人。

提前感谢您的洞察力。对不起这本书。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T17:49:19.967

与大多数软件一样，最大的成本因素几乎肯定是开发人员的时间。

记住这一点，你应该选择你的团队能够以最快的速度启动和运行的任何东西。您建议的两个堆栈都可以完成工作。

（尽管我确信有人会在一分钟内完成 PHP 并建议您使用 C#/MS Stack）

从 PHP 的角度回答其他观点，这是我最了解的：

1.  mysql 中的复制会做你想做的事，但要确保你设置了一些东西让你知道是否有问题。

2.  您可以使用 Zend_Guard 来编译 PHP，但它是有成本的。PHP 5.3 即将发布，其中包括 Phar 档案 - java jar 档案的无耻副本，因此您可以将应用程序作为单个文件分发。

3.  PHP 可以通过 fPDF 做 PDF。从未使用过 MS 选项，因此不确定此处的比较情况。

4.  我认为 sql server express 可以做到这一点，mysql 也可以。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T17:49:54.147

*   **如果您打算销售，将第 2 点与第 4 点**相加，您应该认为，虽然在您的公司中它不会超过 100 个同时点击，但在您要销售给它的公司中，它可以超过 10000 个点击。所以你现在应该考虑可扩展性

*   由于它是您所说的庞大规模的应用程序，因此您应该期望将来有人想要与它进行通信，不包括 php，用于 jsp 或 c#，以便您可以在需要时制作 Web 服务。

*   PHP 也不允许像 C# 或 JSP 那样多的分发。

*   **3 - 报告**您可以使用其中任何一种语言来做到这一点。

我认为最终取决于您知道如何更好地处理。我会选择一种我已经知道的语言，而不是使用一种新的语言。这样，您将最大限度地减少部署时间，这可能也非常重要。

对于数据库，我认为您可以获得 mysql 或 posgresql，因为它们都是免费的，并且会降低您的成本。

希望能帮助到你 ：）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T17:55:21.993

“我即将开发一个非常大的基于网络的运营、库存、销售管理系统。” - 这是一项非常雄心勃勃的事业。您这样做是为了娱乐、教育还是盈利？你打算出售或开源这个吗？

当然，您意识到市场上已经有很多替代品。你的比其他人有什么优势？

听起来像是经典的购买与构建选择。你在建造之前考虑过购买吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T17:50:37.530

听起来你更喜欢 C# 和 MySQL。MySQL 有几篇关于[将 .NET 与 MySQL](http://dev.mysql.com/usingmysql/dotnet/)和[Connector/NET](http://dev.mysql.com/downloads/connector/net/5.0.html)驱动程序结合使用的文章。

不幸的是，我对使用 MySQL 进行报告知之甚少。

# oracle - Oracle10 和 JDBC：如何让 CHAR 在比较时忽略尾随空格？

> ID：603245
> 
> 赞同：8
> 
> 时间：2009-03-02T17:39:28.880
> 
> 标签：oracle, jdbc, char

我有一个查询

> ... WHERE PRT_STATUS='ONT' ...

prt_status 字段被定义为 CHAR(5)。所以它总是用空格填充。查询结果不匹配。为了使这个查询工作我必须做

> ... WHERE rtrim(PRT_STATUS)='ONT'

这确实有效。

这很烦人。

同时，我的几个纯 Java DBMS 客户端（Oracle SQLDeveloper 和 AquaStudio）对第一个查询没有问题，它们返回正确的结果。TOAD 也没有问题。

我认为他们只是将连接置于某种兼容模式（例如 ANSI），因此 Oracle 知道 CHAR(5) 期望与不考虑尾随字符进行比较。

**如何使用我在应用程序中获得的 Connection 对象来做到这一点？**

**更新**我无法更改数据库架构。

**解决方案**这确实是 Oracle 将字段与传入参数进行比较的方式。

绑定完成后，字符串通过 PreparedStatement.setString() 传递，它将类型设置为 VARCHAR，因此 Oracle 使用未填充的比较——但失败了。

我尝试使用 setObject(n,str,Types.CHAR)。失败。反编译显示，Oracle 忽略了 CHAR 并再次将其作为 VARCHAR 传入。

最终起作用的变体是

```
setObject(n,str,OracleTypes.FIXED_CHAR); 
```

它使代码不可移植。

UI 客户端成功的原因不同——它们使用字符文字，而不是绑定。当我输入 PRT_STATUS='ONT' 时，'ONT' 是一个文字，因此使用填充方式进行比较。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-02T17:55:32.697

请注意，[Oracle`CHAR`使用空白填充的比较语义来比较值。](http://download.oracle.com/docs/cd/B10501_01/server.920/a96524/c13datyp.htm#701)

从[数据类型比较规则](http://download.oracle.com/docs/cd/B10501_01/server.920/a96540/sql_elements2a.htm#46504)，

> 仅当比较中的两个值都是数据类型 CHAR、NCHAR、文本文字的表达式或 USER 函数返回的值时，Oracle 才使用空白填充的比较语义。

在您的示例中，是`'ONT'`作为绑定参数传递的，还是如您所说明的那样以文本方式内置到查询中？如果是绑定参数，则确保它被绑定为 type `CHAR`。否则，请验证所使用的客户端库版本，因为 Oracle 的真正旧版本（例如 v6）对于`CHAR`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T19:19:16.443

如果您无法更改您的数据库表，您可以修改您的查询。

RTRIM 的一些替代方案：

> .. WHERE PRT_STATUS 像 'ONT%' ...
> 
> .. WHERE PRT_STATUS = 'ONT' ... -- T 后面的 2 个空格
> 
> .. WHERE PRT_STATUS = rpad('ONT',5,' ') ...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T17:42:42.400

我会将 CHAR(5) 列更改为 db 中的 varchar2(5)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-24T16:42:25.127

您可以在查询中使用 cast to char 操作：

```
... WHERE PRT_STATUS=cast('ONT' as char(5)) 
```

或者以更通用的 JDBC 方式：

```
... WHERE PRT_STATUS=cast(? as char(5)) 
```

然后在你的 JDBC 代码中使用`statement.setString(1, "ONT");`

# java - 库（jar）应该进入存储库吗？

> ID：603247
> 
> 赞同：7
> 
> 时间：2009-03-02T17:39:48.570
> 
> 标签：java, jar, repository, project

当您开始在 Java 中使用第三方库时，您将他们的 jars 添加到您的项目中。您是否还将罐子添加到存储库中，或者您只是保留本地安装。如果是后者，您如何在团队成员之间同步才能工作？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-02T17:53:56.273

是的。您应该将开发人员在干净系统上（除了安装 JDK 和 ant）检查和构建项目所需的任何内容添加到存储库中。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-02T17:42:09.297

不，如果您使用 Maven。将它们放入 Maven 存储库（如果它们还没有，大多数开源库已经在公共 Maven 存储库中）。

是的，如果您使用 Ant。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-02T17:50:57.310

如果您使用的是 ANT 并且想要没有 maven 的 maven 样式依赖管理，请查看[Ivy](http://ant.apache.org/ivy/)。它可以从 maven 存储库下载，甚至可以读取 maven pom 文件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-02T18:07:40.687

是的，第三方库应该是版本控制的，因为您希望每个人都针对该库的相同版本进行编译。这样，当第三方库发生更新时，您只需在一个地方进行更改，每个人都会更新到新版本。否则你很容易得到著名的：“它在我的机器上编译！”-综合症。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T19:44:39.953

假设您不使用 Maven，那么您绝对应该检查 3rd 方 jar 的版本。您（或更重要的是，跟随您的维护开发人员）应该能够从存储库中提取您的应用程序版本，并拥有编译和运行时所需的所有 3rd 方 jar 的所有正确版本。

您还应该维护第 3 方 jar 的版本控制历史，再次帮助维护开发人员。将它们签入存储库是执行此操作的最简单和最有效的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T17:43:57.170

我建议对构建项目所需的一切进行版本控制。除非您使用像 maven 这样的构建工具。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T18:59:25.197

## 简答

不

## 更长的答案

在此期间，请使用网络上与 repo 分开的文件夹。

## 长期解决方案

使用[Maven](http://maven.apache.org/)。它是为处理您的构建、配置和外部 jar 依赖关系而构建的。

不过，请转到[此处](http://www.sonatype.com/books/maven-book/reference/public-book.html)获取文档。（众所周知，官方的 Maven 文档参差不齐）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-02T17:42:22.243

最近我一直将 JAR 排除在 SVN 之外。我有一个单独的存储库，用于将它们拉入项目、管理依赖项并跟踪不同的版本。

这就是 Maven 的诞生。我必须学习如何很好地使用它，但在那之前我会保留自己的 JAR 存储库。

# c# - 如何轻松还原 DataBound 表单上的更改？

> ID：603249
> 
> 赞同：2
> 
> 时间：2009-03-02T17:40:14.947
> 
> 标签：c#, .net, wpf, data-binding

如果我有一个带有控件数据绑定到实例变量对象的表单，有没有办法恢复用户所做的更改，可能通过执行以下操作：

```
myLocalObject = DataLayer.GetCurrentState(); 
```

并让表单的控件（绑定到 myLocalObject）自动获取更改？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T17:42:35.613

看看[`IEditableObject`](http://msdn.microsoft.com/en-us/library/system.componentmodel.ieditableobject.aspx)界面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-11T00:35:33.383

我发现以下方法可以解决问题：

```
var myLocalObject = DataLayer.GetCurrentState();
LayoutRoot.DataContext = null;
LayoutRoot.DataContext = myLocalObject; 
```

出于某种原因，如果我没有将 DataContext 设置为 null，我的绑定控件在还原更改时不会获取更改。

# c# - How would you prevent user from adding/removing lines in a TextBox?

> ID：603258
> 
> 赞同：0
> 
> 时间：2009-03-02T17:42:01.560
> 
> 标签：c#, winforms

How would you prevent the user from adding or removing lines in a TextBox? By that I mean, if I set the text in a textbox to 7 lines with some text, how can I make sure that it will always be 7 lines of text there? The user must be able to edit those lines like usual, but not remove a line entirely, and not add any new ones.

Would have to take into account both keyboard input and also things like cut and paste, etc.

Any good ideas?

* * *

**Reason:** I want to make a file renamer kind of like [Oscar's Renamer](http://www.mediachance.com/free/renamer.htm). You give it a folder, and it loads the filenames into a textbox where you can do changes pretty much like you do in a text editor. When you are happy with your changes, you write them back. Reason for constant `n` lines in textbox is then of course that line `n` is the name of file `n`. Adding a new line shouldn't be allowed since you only have those files in that folder. Removing a line should also not be allowed since you would then be missing a name for a file.

Why go through the trouble of making something like this when it already exists? Well, I am curious to see if I could do it, and thought it could be a nice excercise to learn a few things along the way. Since it has some interesting problems that needs to be solved. Like this one :) There are also some features I think are lacking in that [Oscar's Renamer](http://www.mediachance.com/free/renamer.htm). So... to sum up: I'm doing it to learn and to try make an even better version of it. I know fully well that I may just as well fail completely though, or just never finish it :p But that is another story. I want to learn

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T17:46:03.810

You have the wrong interface then for the data. In this case, you should have a fixed number of textboxes, one for each line of data. This would allow the user to modify the contents of each line, but not remove a line or add a line.

Trying to make a multi-line textbox do this will be maddening at best, since you will have to determine when a new line is added/removed and then kill the change.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T18:23:32.443

Why not use a Listbox instead?

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T17:48:37.517

I'd probably let the user do what they want on the textbox, then add validation to show the user there is an error when they go above 7 lines (e.g. red-outline and tooltip or something). If they are under 7 lines, no problem, add them when you come to process that data.

What is the specific reason you want the always 7 lines? Like casperOne said, maybe the interface you're using isn't ideal to your needs.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T17:48:55.350

One possible way of doing this is to sub-class the Textbox control and override the winProc method. This method handles all window messages pumped to the windowed control (Textbox in your case). You could monitor the use of the backspace and delete keys and carat position and discard the key strokes that attempt to remove carriage return line feed sequences. And provide the user with an interactive alert that tells them why they cannot remove entire lines.

Doing it this way gives you complete control and is the lowest level way to see **all** input that is coming into your Textbox control. You can intercept certain messages and discard them, the ones that you want to allow just pass them through into the base class method. Such as if the user highlights all lines and hits the delete key. There is other event handlers that you can use to intercept keyboard input but they have some limitations, the winProc will allow you to check any message directed to the control including delete, backspace copy and paste etc, mouse clicks etc.

Sample:

```
public class myCustomTextBox : TextBox
{
    protected override void WndProc(ref Message m)
    {
        if (m.Msg == 770) // window paste message id
        {
            string clipBoardData = Clipboard.GetDataObject().GetData(DataFormats.Text).ToString();
            handlePasteEvent(clipBoardData);
        }
        else
        {
            base.WndProc(ref m);
        }
    }
    private void handlePasteEvent(string pasteData)
    {
        // process pasted data
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T19:22:48.587

Since you already have stated that this is a learning project, a see if I can do it-project, I think you should throw in some WPF into it. A listbox with a itemtemplate would solve this very nicely.

If that's out of the way, I would consider using a datagrid instead of a textbox.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T19:55:48.290

Load your data in a editable DataGrid instead of a TextBox, that should make things much more simple, and also you can pick which columns are editable and which are not.

Here's an example that uses a DataGridView and simulates your textbox:

*   The grid lines are hidden.
*   The headers of columns and rows are hidden.
*   The background color is the same color a TexBox has.

Add a DataGridView to a form and use the following code:

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;

namespace Test
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            this.dataGridView1.AllowUserToResizeRows = false;
            this.dataGridView1.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.Fill;
            this.dataGridView1.BackgroundColor = SystemColors.Window;
            this.dataGridView1.BorderStyle = BorderStyle.None;
            this.dataGridView1.CellBorderStyle = DataGridViewCellBorderStyle.None;
            this.dataGridView1.ColumnHeadersHeightSizeMode = DataGridViewColumnHeadersHeightSizeMode.AutoSize;
            this.dataGridView1.ColumnHeadersVisible = false;
            this.dataGridView1.EditMode = DataGridViewEditMode.EditProgrammatically;
            this.dataGridView1.MultiSelect = false;
            this.dataGridView1.RowHeadersVisible = false;
            this.dataGridView1.SelectionChanged += new System.EventHandler(this.dataGridView1_SelectionChanged);

            dataGridView1.DataSource = Directory.GetFiles(Environment.CurrentDirectory).Select(f => new FileEdit { FileName = Path.GetFileName(f) }).ToList();
        }

        private void dataGridView1_SelectionChanged(object sender, EventArgs e)
        {
            dataGridView1.BeginEdit(true);
        }

    }

    class FileEdit
    {
        public string FileName { get; set; }    
    }
} 
```

# c# - 安全地将文件上传到备用服务器 C# .net 2.0

> ID：603271
> 
> 赞同：1
> 
> 时间：2009-03-02T17:43:54.567
> 
> 标签：c#, security, redirect, file-upload

我有一个.net 2.0 上的 C# Web 应用程序托管在服务器 A 上。该 Web 应用程序允许用户使用`<input id="File1" name="filMyFile" type="file" runat="server" />`服务器 A 上传文件。这一切都很好。

我现在被要求修改 Web 应用程序，以允许 A 提供的页面允许直接上传到服务器 B，而无需在 A 上存储任何信息，甚至暂时也不存储。

出于安全原因，我被要求这样做。我正在考虑可能使用 iframe 并让服务器 B 仅托管使用 SSL 包装请求的上传部分。我不完全确定这样做的安全隐患，但是我已经看到一些网站，其中他们的登录控制他们 SSL 只包含登录部分的 iframe 和他们网站的其余部分是不安全的。

这是一件好事吗？有人可以推荐更好的方法吗？也许建议一个基本的架构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T17:47:42.030

为什么不直接将`form`操作设置为服务器 B 上的 SSL 安全页面？

```
<form method="POST" action="https://serverb/uploadmanager.ashx" ...> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T17:49:59.310

我使用了 iframe 方法，其中带有上传表单的 iframe 代码托管在服务器 B 上。它运行得相当好。如果需要，您还可以在服务器 B 上托管整个页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T17:55:12.993

您也可以将文件直接写入 SQL 数据库。从安全的角度来看，我更喜欢这种方法，因为文件永远不会存在于服务器硬盘上。然后可以在两台服务器之间共享它。

另一方面，对未首先写入磁盘的文件进行 AV 扫描更加困难。

# java - 什么是最好的 java 图像处理库/方法？

> ID：603283
> 
> 赞同：261
> 
> 时间：2009-03-02T17:47:43.387
> 
> 标签：java, image-processing, image-manipulation

我同时使用 JAI 媒体 API 和 ImageMagick？

ImageMagick 有一些可扩展性问题，基于 JNI 的 JMagick 也没有吸引力。与 ImageMagick 相比，JAI 在调整大小操作时质量较差。

有谁知道任何优秀的工具，无论是开源的还是商业的，都是原生 java 并提供高质量的结果？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2012-02-23T18:18:16.960

I know this question is quite old, but as new software comes out it does help to get some new links to projects that might be interesting for folks.

[imgscalr](https://github.com/thebuzzmedia/imgscalr) is pure-Java image resizing (and simple ops like padding, cropping, rotating, brighten/dimming, etc.) library that is painfully simple to use - a single class consists of a set of simple graphics operations all defined as *static* methods that you pass an image and get back a result.

The most basic example of using the library would look like this:

```
BufferedImage thumbnail = Scalr.resize(image, 150); 
```

And a more typical usage to generate image thumbnails using a few quality tweaks and the like might look like this:

```
import static org.imgscalr.Scalr.*;

public static BufferedImage createThumbnail(BufferedImage img) {
    // Create quickly, then smooth and brighten it.
    img = resize(img, Method.SPEED, 125, OP_ANTIALIAS, OP_BRIGHTER);

    // Let's add a little border before we return result.
    return pad(img, 4);
} 
```

All image-processing operations use the raw Java2D pipeline (which is hardware accelerated on major platforms) and won't introduce the pain of calling out via JNI like library contention in your code.

imgscalr has also been deployed in large-scale productions in quite a few places - the inclusion of the AsyncScalr class makes it a perfect drop-in for any server-side image processing.

There are numerous tweaks to image-quality you can use to trade off between speed and quality with the highest ULTRA_QUALITY mode providing a scaled result that looks better than GIMP's Lancoz3 implementation.

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2009-03-05T23:58:09.260

有[ImageJ](http://rsbweb.nih.gov/ij/)，它号称是

> 世界上最快的纯Java图像处理程序

它可以用作另一个应用程序中的库。它的架构并不出色，但它可以完成基本的图像处理任务。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2010-02-28T04:55:58.760

另一个不错的选择：[马文](http://marvinproject.sourceforge.net/en/index.html)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-03-06T10:14:54.707

我不是 Java 人，但 OpenCV 非常适合我的需求。不确定它是否适合你的。这是一个Java端口，我认为： [http ://docs.opencv.org/2.4/doc/tutorials/introduction/desktop_java/java_dev_intro.html](http://docs.opencv.org/2.4/doc/tutorials/introduction/desktop_java/java_dev_intro.html)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-03-02T18:02:11.417

[处理](http://processing.org/)是新的，但非常非常好。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-07-09T20:45:50.390

Try to use [Catalano Framework](https://code.google.com/p/catalano-framework/).

Keypoints:

*   Architecture like AForge.NET/Accord.NET.
*   Run in the both environments with the same code, desktop and Android.
*   Contains several filters in parallel.
*   Development is on full steam.

The Catalano Framework is a framework for scientific computing for Java and Android. The project started as an initial port of the many features of the AForge.NET and Accord.NET frameworks for .NET, but is steadily growing with more advanced features which are now being shared between those projects.

Example:

```
FastBitmap fb = new FastBitmap(bitmap);

Grayscale g = new Grayscale();
g.applyInPlace(fb);

Threshold t = new Threshold(120);
t.applyInPlace(fb);

bitmap = fb.toBitmap();

//Show the result 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-04-11T17:07:41.210

imo the best approach is using [GraphicsMagick Image Processing System](http://www.graphicsmagick.org/) with [im4java](http://im4java.sourceforge.net/) as a comand-line interface for Java.

There are a lot of advantages of GraphicsMagick, but one for all:

*   GM is used to process billions of files at the world's largest photo sites (e.g. Flickr and Etsy).

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-08-13T14:40:33.150

[http://im4java.sourceforge.net/](http://im4java.sourceforge.net/) - 如果您正在运行 linux，则分叉一个新进程并不昂贵。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-02T18:04:21.350

对于商业工具，您可能想尝试 Snowbound。

[http://www.snowbound.com/](http://www.snowbound.com/)

我对他们的体验有些过时，但我发现他们的 Java Imaging API 比 JAI 更容易使用并且速度更快。

他们的客户支持和代码示例也非常好。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-13T15:54:06.627

RoboRealm 视觉软件[列表](http://www.roborealm.com/links/vision_software.php)在许多其他非 Java 库中提到[了 JHLabs](http://www.jhlabs.com/ie/index.html)和[NeatVision 。](http://www.neatvision.com/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-12-26T13:36:27.760

I cannot say that it is the "best" library, but I think you can try this: [http://algart.net/java/AlgART/](http://algart.net/java/AlgART/) It is an open-source Java library, supporting generalized "smart" arrays and matrices with elements of different types (from 1 bit to 64-bit floating point), including 2D-, 3D- and multidimensional image processing and other algorithms, working with arrays and matrices. Unfortunately right now it consists not enough demo and examples, but, on the other hand, it contains a lot of JavaDocs. It lay in the base of commercial software (SIMAGIS) during several years, but now it is open-source.

# python - 需要python lxml语法帮助来解析html

> ID：603287
> 
> 赞同：16
> 
> 时间：2009-03-02T17:48:28.097
> 
> 标签：python, html-parsing, lxml

我是 python 的新手，我需要一些关于使用 lxml 查找和迭代 html 标签的语法方面的帮助。以下是我正在处理的用例：

HTML 文件的格式相当好（但并不完美）。屏幕上有多个表格，一个包含一组搜索结果，一个用于页眉和页脚。每个结果行都包含一个搜索结果详细信息的链接。

1.  我需要找到带有搜索结果行的中间表（我能够弄清楚这一行）：

    ```
     self.mySearchTables = self.mySearchTree.findall(".//table")
        self.myResultRows = self.mySearchTables[1].findall(".//tr") 
    ```

2.  我需要找到此表中包含的链接（这是我卡住的地方）：

    ```
     for searchRow in self.myResultRows:
            searchLink = patentRow.findall(".//a") 
    ```

    它似乎并没有真正找到链接元素。

3.  我需要链接的纯文本。我想`searchLink.text`如果我实际上首先获得了链接元素，那将会是这样的。

最后，在 lxml 的实际 API 参考中，我无法找到有关 find 和 findall 调用的信息。我从在谷歌上找到的一些代码中收集到了这些。我是否遗漏了有关如何使用 lxml 有效查找和迭代 HTML 标记的内容？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-02T19:27:20.340

好的，首先，关于解析 HTML：如果您遵循 zweiterlinde 和 S.Lott 的建议，至少使用[lxml 中包含的 beautifulsoup](http://lxml.de/elementsoup.html)版本。这样，您还将获得一个不错的 xpath 或 css 选择器界面的好处。

但是，我个人更喜欢 lxml 中包含的 Ian Bicking 的[HTML 解析器](http://lxml.de/lxmlhtml.html)。

其次，`.find()`来自`.findall()`lxml 试图与 ElementTree 兼容，这两种方法[在 ElementTree 的 XPath Support 中](http://effbot.org/zone/element-xpath.htm)进行了描述。

这两个函数相当容易使用，但它们的 XPath 非常有限。我建议尝试使用完整的 lxml[`xpath()`方法](http://lxml.de/xpathxslt.html#the-xpath-method)，或者，如果您已经熟悉 CSS，请使用[`cssselect()`method](http://lxml.de/cssselect.html)。

以下是一些示例，其 HTML 字符串解析如下：

```
from lxml.html import fromstring
mySearchTree = fromstring(your_input_string) 
```

使用 css 选择器类，您的程序大致如下所示：

```
# Find all 'a' elements inside 'tr' table rows with css selector
for a in mySearchTree.cssselect('tr a'):
    print 'found "%s" link to href "%s"' % (a.text, a.get('href')) 
```

使用 xpath 方法的等价物是：

```
# Find all 'a' elements inside 'tr' table rows with xpath
for a in mySearchTree.xpath('.//tr/*/a'):
    print 'found "%s" link to href "%s"' % (a.text, a.get('href')) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-02T17:51:14.063

你没有在这个项目中使用[Beautiful Soup有什么原因吗？](http://www.crummy.com/software/BeautifulSoup/)这将使处理不完美的文档变得更加容易。

# c# - asp：asp：超链接内的按钮无法导航到 Internet Explorer 中的页面

> ID：603290
> 
> 赞同：1
> 
> 时间：2009-03-02T17:48:51.510
> 
> 标签：c#, asp.net

我有一个 asp:button，它位于 asp:hyperlink 中。当您在 Firefox 中单击该按钮时，它会转到由 asp:hyperlink 指定的正确 url，但如果您在 Internet Explorer 中单击该按钮，它会停留在同一页面上。我只是使用按钮上的 PostBackUrl 属性来解决问题，但这里是代码示例：

```
<asp:Hyperlink ID="hyp" runat="server" NavigateUrl="Page2.aspx">
<asp:Button ID="btn" runat="server" Text="Submit" /></asp:Hyperlink> 
```

**为什么上面的方法在 Firefox 中有效，而在 IE 中无效？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T17:53:24.073

你所做的不是很正确。

只需添加按钮并在其单击处理程序中执行以下操作：

```
Response.Redirect("Page2.aspx"); 
```

或者，您可以编写一行 javascript：

```
<input type="button" value="Text" onclick="location='Page2.aspx'" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T17:54:17.130

您在超链接中使用按钮是否有原因？根据您尝试实现的设计，我将仅使用 Button 或 LinkBut​​ton ，然后在代码隐藏中的逻辑之后进行重定向

```
<asp:Button runat='server' id='button1' Text='Click Me' Click='button1_Click' />
<asp:LinkButton runat='server' id='linkbutton1' Text='Click Me'  Click='button1_Click' /> 
```

**代码隐藏**

```
protected void button1_Click(object sender, EventArgs e) {
  // some logic
  Response.Redirect("Page2.aspx");
} 
```

**火狐与 Internet Explorer**

我怀疑您在 Firefox 和 Internet Explorer 之间存在差异，因为事件在浏览器之间冒泡/传播的方式。如果您想取消事件的传播，您需要在您的按钮单击事件处理程序（在 javascript 中）中包含对 event.preventDefault() 或 event.stopPropagation() 的调用？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T17:51:44.717

您的按钮正在同一页面上执行回发。如果我是你，我会尝试在 HTML 工具箱中使用标准按钮，而不是 ASP.NET 按钮。

编辑：我更强烈建议消除您的按钮控件并适当地设置超链接的样式，或者消除两者并改用超链接按钮控件并将其显示属性设置为显示为按钮。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T17:56:19.387

我会使用一个`<asp:LinkButton CssClass="myButton" OnClick="Redirect" />`然后 CSS 来设置你希望它的外观和代码隐藏来处理功能。

```
protected void Redirect(object sender, EventArgs e)
{
   // do something
} 
```

在我看来，呈现、标记和功能的三向分离是要走的路

# internet-explorer - 反射终端仿真器 - 与 IE 集成

> ID：603311
> 
> 赞同：1
> 
> 时间：2009-03-02T17:52:57.243
> 
> 标签：internet-explorer, vba, com, terminal, terminal-emulator

我正在尝试在反射终端模拟器中运行的遗留应用程序和在 IE 中运行的基于浏览器的应用程序之间实现一些集成。

我正在使用主机启动脚本，以便将维护和部署问题与旧版应用程序隔离开来。所有脚本都将在旧版应用程序中生成，并使用转义序列传输到 Reflection。

我目前能够：

1.  启动 IE
2.  设置选项，例如隐藏工具栏
3.  导航到 URL
4.  将状态信息传输回旧版应用程序
5.  等待来自旧版应用程序的“关闭”信号
6.  关闭 IE

这是执行此操作的 VBA 代码：

```
 Sub Main
  Dim CR as String
  CR = CHR$(rcCR)
  Dim objIE as Object
  Set objIE = CreateObject("InternetExplorer.Application")
  objIE.ToolBar = false
  objIE.Navigate("http://www.google.com/")
  objIE.Visible = true
  Session.Transmit "OK" & CR
  Session.WaitForString "CLOSE", 0, rcAllowKeystrokes
  objIE.Quit
End Sub 
```

这样做的问题是脚本会继续运行，直到它从旧版应用程序获得关闭命令。

我想要做的是使用一个脚本来启动浏览器，然后使用另一个脚本来关闭它或将其重新用于另一个 URL。但是，我无法找到一种方法来跨脚本调用保存对 IE 的引用。在 Sub Main 之外将 objIE 声明为 Global 并没有帮助。Session 对象在脚本调用中确实存在，但它似乎没有我可以用于此目的的属性。（Session 确实有一个 UserData 属性，但那是一个字符串，而不是一个对象。）

这是我想做的一个例子：

脚本 1 - 打开 IE 并保持打开状态：

```
 Sub Main
  Dim CR as String
  CR = CHR$(rcCR)
  Dim objIE as Object
  Set objIE = CreateObject("InternetExplorer.Application")
  objIE.ToolBar = false
  objIE.Navigate("http://www.google.com/")
  objIE.Visible = true
  Session.Transmit "OK" & CR
End Sub 
```

脚本 2 - 将原始 IE 窗口发送到新 URL

```
 Sub Main
  Dim CR as String
  CR = CHR$(rcCR)
  Dim objIE as Object
  Set objIE = FindOriginalIE()
  objIE.Navigate("http://www.stackoverflow.com/")
  Session.Transmit "OK" & CR
End Sub 
```

脚本 3 - 关闭 IE

```
 Sub Main
  Dim CR as String
  CR = CHR$(rcCR)
  Dim objIE as Object
  Set objIE = FindOriginalIE()
  objIE.Quit
  Session.Transmit "OK" & CR
End Sub 
```

我无法弄清楚的部分是如何实现脚本 2 和 3 中使用的 FindOriginalIE() 函数。

我尝试使用 GetObject() 而不是 CreateObject()，但这让我无处可去。GetObject() 不会打开新的 IE 窗口，也不会找到现有的窗口。我怀疑这是因为我在 Citrix 下运行，但我不确定。

我现在唯一的线索是尝试使用 IE 的 hWND 重新连接到原始窗口，或者使用 DDE 而不是 OLE。然而，我对其中任何一个都没有太大的运气，主要是因为缺乏文档。

所以，我的问题是：

1.  我正在尝试使用 OLE 做什么？也就是说，有没有办法在主机启动的脚本调用中保持我对 IE 的句柄？
2.  我应该期望 GetObject() 工作，还是死路一条？
3.  是否可以在主机启动的脚本中使用 Win32 API 使用 hWND 重新连接到 IE？

非常感谢任何指向相关文章、示例代码或其他见解的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-16T04:15:47.817

InternetExplorer 对象不支持AFAIK GetObject。然而这还不是结束:) 在[许多其他方法](http://www.xtremevbtalk.com/archive/index.php/t-247343.html)中，您可以将它从 shell32 的 windows 集合中拉出来。要使示例代码（改编自上面链接中的代码）正常工作，您需要设置对以下内容的引用：

1.  微软互联网控制
2.  Microsoft HTML 对象库
3.  Microsoft Shell 控件和自动化

```
`Public Sub RunMeFirst()
    Dim objIE As SHDocVw.InternetExplorer
    Set objIE = New SHDocVw.InternetExplorer
    objIE.Visible = True
    objIE.navigate "[http://www.google.com/](http://www.google.com/)"
    Do Until objIE.readyState = READYSTATE_COMPLETE
        DoEvents
    Loop
End Sub

Public Sub RunMeSecond()
    Dim objIE As SHDocVw.InternetExplorer
    Dim doc As MSHTML.HTMLDocument
    Set objIE = GetIEByURL("[http://www.google.com/](http://www.google.com/)")
    Set doc = objIE.document
    MsgBox doc.body.innerText
End Sub

Private Function GetIEByURL(ByVal URL As String) As SHDocVw.InternetExplorer
    Dim objShell As Shell32.Shell
    Dim objExplorer As Shell32.ShellFolderView
    Dim obj As Object
    Set objShell = New Shell
    For Each obj In objShell.Windows
        If TypeOf obj Is SHDocVw.InternetExplorer Then
            If StrComp(obj.LocationURL, URL, vbTextCompare) = 0& Then
                Exit For
            End If
        End If
    Next obj
    Set GetIEByURL = obj
End Function` 
```

`我认为可能值得讨论您要完成的工作。机器人 IE 是一种非常笨拙的方法（我经常对此感到内疚），但可能有更好的、资源消耗更少的方法。`

 `# c - 使用 C 编程在特定时间间隔产生音调

> ID：603313
> 
> 赞同：3
> 
> 时间：2009-03-02T17:53:10.050
> 
> 标签：c, embedded, pic18

我为 PIC18F 使用 C 语言来产生音调，使它们中的每一个都以特定的时间间隔播放。我使用 PWM 来产生音调。但我不知道如何创建间隔。这是我的尝试。

```
#pragma code                                    // 
void main (void)
{

 int i=0;
    // set internal oscillator to 1MHz  
    //OSCCON = 0b10110110;                    // IRCFx = 101
    //OSCTUNEbits.PLLEN = 0;                //PLL disabled

    TRISDbits.TRISD7 = 0;

    T2CON  = 0b00000101;                    //timer2 on
    PR2    = 240;
    CCPR1L = 0x78;
    CCP1CON= 0b01001100;

LATDbits.LATD7=0;
Delay1KTCYx(1000);

while(1);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T18:33:27.193

当我进行嵌入式编程时，我发现添加注释非常有用，可以准确解释我在设置配置寄存器时的意图。这样，当我下次必须更改代码时，我就不必返回数据表来弄清楚`0x01001010`当我试图摸索代码时会发生什么。（请确保评论与更改保持同步）。

从我可以解码的内容来看，您似乎已经设置了 PWM 寄存器，但无法以所需的时间间隔更改频率。有几种方法可以做到，这里有2个想法：

*   您可以在启动时读取计时器，添加所需的间隔以获得目标时间，并在 while 循环中轮询计时器。当计时器达到目标时，设置新的 PWM 占空比，并将下一个间隔添加到目标时间。这将正常工作，直到您需要开始在后台循环中执行其他操作。
*   您可以将 timer0 的计数设置为`0xFFFF-interval`，并将其设置为在翻转时中断。在 ISR 中，设置新的 PWM 占空比，并将 timer0 计数复位到下一个间隔。

在嵌入式进程中控制时序的一种常见方法如下所示：

```
int flag=0;
void main()
{
  setup_interrupt(); //schedule interrupt for desired time.
  while (1)
  {  
     if (flag)
     {  
        update_something();
        flag = 0;
     }
  } 
```

在哪里`flag`设置？在中断处理程序中：

```
void InterruptHandler()
{
  flag = 1;
  acknowledge_interupt_reg = 0;
} 
```

您已经拥有示例中的所有部分，只需将它们放在正确的位置即可。在您的情况下，`update_something()`将更新 PWM。逻辑看起来像：“如果它打开，将其关闭；否则打开它。如果需要，更新音调（占空比）”

在主 while 循环中应该不需要额外的延迟或暂停。目标是它一遍又一遍地运行，等待某事做。如果程序需要以不同的速率做其他事情，你可以再加一个标志，这个标志完全独立触发，两个任务的时间不会相互干扰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T18:42:46.980

*EDIT:*
I'm now confused about what you are trying to accomplish. Do you want a series of pulses of the same tone (on-off-on-off)? Or do you want a series of different notes without pauses (do-re-me-fa-...)? I had been assuming the latter, but now I'm not sure.

* * *

After seeing your updated code, I'm not sure exactly how your system is configured, so I'm just going to ask some questions I hope are helpful.

1.  ~~Is the PWM part working? Do you get the initial tone? I'm assuming yes.~~
2.  ~~Does your hardware have some sort of clock pulse hooked up to the RA4/T0CKI pin? If not, you need T0 to be clock mode, not counter mode.~~
3.  ~~Is the interrupt being called? You are setting INT0IE, which enables the external interrupt, not the timer interrupt~~
4.  ~~What interval do you want between tone updates? Right now, you are getting `0xFFFF / (clock_freq/8)` You need to set the TMR0H/L registers if you want something different.~~
5.  What's on LATD7? and why are you clearing it? *Are you saying it enables PWM output?*
6.  Why the call to Delay()? The timer itself should be providing the needed delay. *There seems to be a disconnect about how to do timing. I'll expand my other answer*
7.  Where are you trying to change the PWM frequency? Don't you need to write to PR2? *You will need to give it a different value for every different tone.*

* * *

> "Halting build on first failure as requested."

This just says you have some syntax error, without showing us the error report, we can't really help.

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-03-02T18:08:17.627

在 Windows 中，您可以使用 kernel32 中的 Beep 功能：

```
 [DllImport("kernel32.dll")]
    private static extern bool Beep(int frequency, int duration); 
```

# vb.net - .NET 中的数据绑定用户控件

> ID：603318
> 
> 赞同：2
> 
> 时间：2009-03-02T17:53:46.880
> 
> 标签：vb.net, data-binding, user-controls

我正在寻找有关如何在用户创建的控件上正确实现数据绑定的一些信息。

我的 UserControl 包含一个文本框、一个按钮和一个 MonthCalendar。我可以将数据绑定到我的用户控件内的文本框，但是，我想在 UserControl 本身上实现数据绑定，而不是引用控件内的文本框。

我试图设置一个属性如下：

```
 <System.ComponentModel.Bindable(True)> _
Public Property BoundDate() As DateTime
    Get
      Return _currentSelectedDate
    End Get
    Set(ByVal value As DateTime)
      SetDateTime(value, True)
    End Set
  End Property 
```

但是，当我向控件添加绑定源时，该字段不会填充数据，它保持空白。我需要做些什么来让数据在之后出现吗？

任何人都可以指导我找到一个好的教程，或者如果可能的话，在这里解释一下。该项目是用 VB.NET 编写的。

**编辑**：我正在实现 DefaultBindingPropertyAttribute

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T18:30:56.947

此时绑定的文本框是什么？我建议如下：

1.  在用户控件加载事件中，以声明方式将文本框绑定到一个私有成员变量，例如私有_boundDate as DateTime
2.  你有没有设置你的boundDate属性更新_boundDate

[这看起来是一本不错的读物，虽然我自己没有看过](https://rads.stackoverflow.com/amzn/click/com/032126892X)

# linq - 使用 LINQ 子查询填充子集合属性

> ID：603323
> 
> 赞同：1
> 
> 时间：2009-03-02T17:54:24.587
> 
> 标签：linq, linq-to-sql

一般来说，我对 LINQ 还是很陌生，但到目前为止，我已经设法弄清楚了以获得我想要/需要的结果。下面的 LINQ2SQL 查询产生所需的结果，其中有 Location 对象，每个对象都有自己的 Units 集合。完成初始变量声明是为了设置我需要从中查询的值，这些值不应该与我的问题相关，但对于上下文是必需的。

我遇到的问题是有 400 多个位置，而我目前构建查询的方式是针对每个位置而不是一个大查询访问数据库。这导致性能受到很大影响，需要 30 多秒才能返回完整结果，这是不可接受的。我有一个存储过程 SQL 查询，它只在一两秒内返回结果。

有没有办法重组这个查询，这样我就不会为每个位置都打数据库？我确定这是由 Units 子查询中额外的“ToList()”引起的，但我不知道如何在没有 ToList() 的情况下调整结果。任何性能调整都会有很大的帮助。谢谢你的帮助！

```
Dim curNames1 = (From ons In dc.organization_names _
    Where ons.eff_date <= ssDate _
    Order By ons.eff_date Descending _
    Group ons By ons.organization_id Into gNames = Group _
    Select New With { _
    Key .Key = organization_id, _
    .Result = gNames.Take(1)}) _
    .SelectMany(Function(a) (a.Result))

Dim curLocs1 = (From oLocs In dc.organization_locations _
    Where oLocs.eff_date <= ssDate _
    Order By oLocs.eff_date Descending _
    Group oLocs By oLocs.organization_id Into gLocs = Group _
    Select New With { _
    Key .Key = organization_id, _
    Result = gLocs.Take(1)}) _
    .SelectMany(Function(a) (a.Result))

Dim curStatuses1 = (From oEDate In dc.organization_conversion_dates _
    Where oEDate.edate <= ssDate _
    Order By oEDate.edate Descending _
    Group oEDate By oEDate.organization_id Into gEDates = Group _
    Select New With { _
    Key .Key = organization_id, _
    .Result = gEDates.Take(1)}) _
    .SelectMany(Function(a) (a.Result))

Dim curCommand1 = (From oCommand In dc.organization_service_assigneds _
    Where oCommand.eff_date <= ssDate _
    Order By oCommand.eff_date Descending _
    Group oCommand By oCommand.organization_id Into gCmds = Group _
    Select New With { _
    Key .Key = organization_id, _
    .Result = gCmds.Take(1)}) _
    .SelectMany(Function(a) (a.Result))

Dim curComponent1 = (From oCompo In dc.organization_compos _
    Where oCompo.eff_date <= ssDate _
    Order By oCompo.eff_date Descending _
    Group oCompo By oCompo.organization_id Into gCompos = Group _
    Select New With { _
    Key .Key = organization_id, _
    .Result = gCompos.Take(1)}) _
    .SelectMany(Function(a) (a.Result))

ss.Locations = New ObservableCollection(Of Location)(( _
    From map In dc.MapBackgrounds Where map.MapID = options.Map _
    Let Locs = map.Schemes.SchemeLocations _
    From SchemeLoc In Locs _
    Where (options.Locations.Count = 0 Or _
        options.Locations.Contains(SchemeLoc.Location.ID)) _
    Select New Location With { _
    .ID = SchemeLoc.Location.ID, .Name = SchemeLoc.Location.Location, _
    .Y = SchemeLoc.Y, .X = SchemeLoc.X, _
    .Country = New Country With _
    {.ID = SchemeLoc.Location.Countries.ID, _
    .Name = SchemeLoc.Location.Countries.country}, _
    .State = If(SchemeLoc.Location.State = -1, Nothing, _
    New USState With {.ID = SchemeLoc.Location.States.ID, _
    .Name = SchemeLoc.Location.States.state, _
    .Abbreviation = SchemeLoc.Location.States.state}), _
    .Units = New ObservableCollection(Of MillitaryUnit)(( _
    From curLoc In curLocs1 _
    Where curLoc.location = SchemeLoc.Location.ID _
    From curName In curNames1 _
    Where curName.organization_id = curLoc.organization_id _
    And (options.UnitSizes.Count = 0 Or _
        options.UnitSizes.Contains(curName.UnitSize)) _
    And (options.UnitTypes.Count = 0 Or _
    options.UnitTypes.Contains(curName.UnitType)) _
    From curEDate In curStatuses1 _
    Where curEDate.organization_id = curLoc.organization_id _
    And (options.Statuses.Count = 0 Or _
    options.Statuses.Contains(curEDate.status)) _
    From curCmd In curCommand1 _
    Where curCmd.organization_id = curLoc.organization_id _
    And (options.Commands.Count = 0 Or _
    options.Commands.Contains(curCmd.service_assigned)) _
    From curCompo In curComponent1 _
    Where curCompo.organization_id = curLoc.organization_id _
    And (options.Components.Count = 0 Or _
    options.Components.Contains(curCompo.compo)) _
    From curTable In curLoc.Organization.organization_tables _
    Where curTable.organization_id = curLoc.organization_id _
    And (options.Tables.Count = 0 Or _
    (options.Tables.Contains(curTable.table_id) Or _
    curTable.Tables.Any(Function(a) (options.Tables.Contains(a.parent_id))))) _
        Select New MillitaryUnit With { _
        .ID = curLoc.organization_id, _
        .Name = curName.name, _
        .IconPath = curName.icon, _
        .ConversionStatus = curEDate.Status1.status, _
        .ServiceCommand = curCmd.Service_Assigneds.service_assigned, _
        .Component = curCompo.Components.compo}).Distinct().ToList())}).ToList()) 
```

更新（2009 年 3 月 3 日上午 10:58）：我设法使用下面的查询在一个查询中取回数据，但这是一个平面表结果。我怎样才能塑造它，使组织的东西在每个位置下变得分层？我相信我想使用“组加入”之类的东西，但我不熟悉它是如何工作的。位置信息是“OrgID”列的所有内容。我需要将这些数据塑造成一个位置集合，每个位置都有一个“单位”属性，该属性是位于该位置的组织的集合。有什么指导吗？

```
Dim locationsquery = (From map In dc.MapBackgrounds Where map.MapID = 1 Let Locs = map.Schemes.SchemeLocations _
                     From SchemeLoc In Locs Join curLoc In curLocs1 On SchemeLoc.LocID Equals curLoc.location  _
                     Join curName In curNames1 On curLoc.organization_id Equals curName.organization_id _
                     Join curStatus In curStatuses1 On curLoc.organization_id Equals curStatus.organization_id _
                     Join curCommand In curCommand1 On curLoc.organization_id Equals curCommand.organization_id _
                     Join curComponent In curComponent1 On curLoc.organization_id Equals curComponent.organization_id _
                     Select New With {.LocationID = SchemeLoc.LocID, .X = SchemeLoc.X, .Y = SchemeLoc.Y, _
                                      .LocationName = SchemeLoc.Location.Location, _ 
                                      .CountryID = SchemeLoc.Location.Countries.id, .CountryName = SchemeLoc.Location.Countries.country, _
                                      .StateID = SchemeLoc.Location.State, .StateName = SchemeLoc.Location.States.state, .StateAbbrev = SchemeLoc.Location.States.state, _
                                      .OrgID = curLoc.organization_id, _
                                      .OrgName = curName.name, _
                                      .OrgLocID = curLoc.location, _
                                      .IconPath = curName.icon, _
                                      .ConversionStatus = curStatus.status1.status, _
                                      .CurCmd = curCommand.service_assigneds.service_assigned, _
                                      .CurCompo = curComponent.components.compo}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T18:10:46.763

不要将成员公开为 a `List<T>`，而是将属性类型更改为 an`IEnumerable<T>`或 an `IQueryable<T>`。然后，您可以删除对 ToList 的调用，并且您的查询*应该*能够一次性在服务器上完全执行。

此外，这种代码是 LINQ to SQL 开始崩溃的地方，IMO。我认为，如果您有一个可以为您提供所需结果的存储过程，那么您应该使用它，并让 LINQ to SQL 处理返回的数据到您的对象的映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T21:24:18.223

所以我最终重做并提出了以下解决方案，它只查询数据库两次并且速度更快：

```
 Dim locationsOnly = (From map In dc.MapBackgrounds Where map.MapID = 1 Let Locs = map.Schemes.SchemeLocations _
                                  From SchemeLoc In Locs _
                                  Where (options.Locations.Count = 0 Or options.Locations.Contains(SchemeLoc.LocID)) _
                                  Select New With {.LocationID = SchemeLoc.LocID, .X = SchemeLoc.X, .Y = SchemeLoc.Y, _
                                      .LocationName = SchemeLoc.Location.Location, _
                                      .CountryID = SchemeLoc.Location.Countries.ID, .CountryName = SchemeLoc.Location.Countries.country, _
                                      .StateID = SchemeLoc.Location.State, .StateName = SchemeLoc.Location.States.state, .StateAbbrev = SchemeLoc.Location.States.state}).ToList()

Dim orgsOnly = (From curLoc In curLocs1 _
                    Join curName In curNames1 On curLoc.organization_id Equals curName.organization_id _
                    Join curStatus In curStatuses1 On curLoc.organization_id Equals curStatus.organization_id _
                    Join curCommand In curCommand1 On curLoc.organization_id Equals curCommand.organization_id _
                    Join curComponent In curComponent1 On curLoc.organization_id Equals curComponent.organization_id _
                    Join curTable In dc.organization_tables On curLoc.organization_id Equals curTable.organization_id _
                    Where (options.UnitSizes.Count = 0 Or options.UnitSizes.Contains(curName.UnitSize)) _
                        And (options.UnitTypes.Count = 0 Or options.UnitTypes.Contains(curName.UnitType)) _
                        And (options.Statuses.Count = 0 Or options.Statuses.Contains(curStatus.status)) _
                        And (options.Commands.Count = 0 Or options.Commands.Contains(curCommand.service_assigned)) _
                        And (options.Components.Count = 0 Or options.Components.Contains(curComponent.compo)) _
                        And (options.Tables.Count = 0 Or (options.Tables.Contains(curTable.table_id) Or curTable.Tables.Any(Function(a) (options.Tables.Contains(a.parent_id))))) _
                    Select New With {.OrgLocID = curLoc.location, _
                       .MilUnit = New MillitaryUnit With { _
                       .ID = curLoc.organization_id, _
                       .Name = curName.name, _
                       .IconPath = curName.icon, _
                       .ConversionStatus = curStatus.Status1.status, _
                       .ServiceCommand = curCommand.Service_Assigneds.service_assigned, _
                       .Component = curComponent.Components.compo}}).Distinct().ToList()

ss.Locations = New System.Collections.ObjectModel.ObservableCollection(Of Location)((From loc In locationsOnly _
                    Group Join org In orgsOnly On loc.LocationID Equals org.OrgLocID Into Orgs = Group _
                    Select New Location With { _
                        .ID = loc.LocationID, _
                        .Name = loc.LocationName, _
                        .X = loc.X, _
                        .Y = loc.Y, _
                        .Country = New Country With {.ID = loc.CountryID, .Name = loc.CountryName}, _
                        .State = New USState With {.ID = loc.StateID, .Name = loc.StateName, .Abbreviation = loc.StateAbbrev}, _
                        .Units = New System.Collections.ObjectModel.ObservableCollection(Of MillitaryUnit)((From curOrg In Orgs _
                            Select curOrg.MilUnit).ToList())}).ToList()) 
```

感谢您的帮助 casperOne！

# perl - 你在 Perl 工具箱中保留了什么？

> ID：603340
> 
> 赞同：9
> 
> 时间：2009-03-02T17:57:29.323
> 
> 标签：perl, module

我是一名 Perl 开发人员，并被我用于几乎所有事情的特定模块套件所吸引。我主要构建 GIS 和面向数据库的 Web 应用程序，用于报告和数据输入等。

我很好奇其他 Perl 开发人员经常使用哪些模块组。

矿：

*   电脑动画
*   DBI
*   电子表格::WriteExcel
*   电子表格::ParseExcel
*   HTML::模板
*   文本::模板
*   PDF::模板
*   PDF::API2
*   地理::形状文件
*   LWP::简单
*   XML::简单

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-02T18:47:29.920

检查最近的东西，这是我最常看到的：

*   [Getopt::Long](http://search.cpan.org/perldoc?Getopt::Long)和[Pod::Usage](http://search.cpan.org/perldoc?Pod::Usage)使选项和手册页变得轻而易举
*   [File::Find](http://search.cpan.org/perldoc?File::Find)因为我终于明白了，尽管我想使用[File::Find::Rule](http://search.cpan.org/perldoc?File::Find::Rule)代替，但我一直忘记
*   [Data::Dumper](http://search.cpan.org/perldoc?Data::Dumper) - 又名，你不知道你已经拥有的最好的调试器
*   [鲤鱼](http://search.cpan.org/perldoc?Carp)找出我做错了什么
*   [当](http://search.cpan.org/perldoc?Storable)适当的数据库太多时可存储
*   [POSIX](http://search.cpan.org/perldoc?POSIX)，但几乎只适用于`strftime`
*   [App::Ack](http://search.cpan.org/perldoc?ack) - 我几乎忘记了它，因为我经常使用它，但在 Perl 中并没有在命令行中使用 Grep。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-03T01:49:35.147

在我的头顶上：

*   [DBIx::类](http://search.cpan.org/dist/DBIx-Class/)
*   [驼鹿](http://search.cpan.org/dist/Moose/)
*   [URI](http://search.cpan.org/dist/URI/)
*   [轻量化](http://search.cpan.org/dist/libwww-perl/)
*   [约会时间](http://search.cpan.org/dist/DateTime/)
*   [开发::封面](http://search.cpan.org/dist/Devel-Cover/)
*   [数据::自卸车](http://search.cpan.org/dist/Data-Dumper/)
*   [测试::更多](http://search.cpan.org/dist/Test-Simple/)
*   [测试::类](http://search.cpan.org/dist/Test-Class/)
*   [基准](http://search.cpan.org/dist/perl-5.8.9/lib/Benchmark.pm)
*   [开发::DProf](http://search.cpan.org/dist/perl-5.8.9/ext/Devel/DProf/DProf.pm)

我可能错过了一些明显的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-02T19:17:37.990

这里有三个很好的来源：

*   Perl 5 wiki 的[推荐 CPAN 模块](http://www.perlfoundation.org/perl5/index.cgi?recommended_cpan_modules)列表
*   The [Phalanx 100](http://qa.perl.org/phalanx/)，大约 100 个稳定、经过良好测试和流行的 Perl 模块的列表（编译于 2004 年）
*   Perl Best Practice 的[推荐模块列表](http://my.safaribooksonline.com/0596001738/perlbp-APP-D-SECT-2?portal=oreilly)，以及Perl wiki 上的最新[相关评论。](http://www.perlfoundation.org/perl5/index.cgi?pbp_module_recommendation_commentary)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-03T08:29:41.910

*   [ack](http://search.cpan.org/perldoc?ack) - 类固醇上的 grep
*   [DBIx::Class](http://search.cpan.org/perldoc?DBIx::Class::Manual::Intro) - ORM
*   [DBIx::Simple](http://search.cpan.org/perldoc?DBIx::Simple) - quick'n'easy DB 访问
*   [Log::Log4perl](http://search.cpan.org/perldoc?Log::Log4perl) - 日志记录
*   [Log::Trace](http://search.cpan.org/perldoc?Log::Trace) - 调试/执行跟踪
*   [Data::Dump](http://search.cpan.org/perldoc?Data::Dump) - 调试/数据检查
*   [DateTime](http://search.cpan.org/perldoc?DateTime) - 日期操作（及其朋友：[DateTime::Format::*](http://search.cpan.org/search?query=DateTime::Format::)）
*   [测试::最](http://search.cpan.org/perldoc?Test::Most)- 测试
*   [Net::Server](http://search.cpan.org/perldoc?Net::Server) - 简单的守护进程
*   [Cache::FastMmap](http://search.cpan.org/perldoc?Cache::FastMmap) - 快速 IPC 通信
*   [YAML](http://search.cpan.org/perldoc?YAML) - 简单、人类可读的数据存储

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-03T14:07:46.933

*   [POE](http://search.cpan.org/perldoc?POE)
*   [WWW::Mechanize](http://search.cpan.org/perldoc?WWW::Mechanize)
*   [Spreadsheet::WriteExcel](http://search.cpan.org/perldoc?Spreadsheet::WriteExcel)
*   [GD](http://search.cpan.org/perldoc?GD)
*   [DBM::Deep](http://search.cpan.org/perldoc?DBM::Deep)
*   [XML::Twig](http://search.cpan.org/perldoc?XML::Twig)
*   [Net::Telnet::Cisco](http://search.cpan.org/perldoc?Net::Telnet::Cisco)
*   [Net::CIDR](http://search.cpan.org/perldoc?Net::CIDR)
*   [Math::BigInt](http://search.cpan.org/perldoc?Math::BigInt)
*   [Math::BigFloat](http://search.cpan.org/perldoc?Math::BigFloat)
*   [Math::BigRat](http://search.cpan.org/perldoc?Math::BigRat)
*   [Math::Business::BollingerBands](http://search.cpan.org/perldoc?Math::Business::BollingerBands)
*   [Math::Units::PhysicalValue](http://search.cpan.org/perldoc?Math::Units::PhysicalValue)
*   [Statistics::Basic](http://search.cpan.org/perldoc?Statistics::Basic)
*   [Net::SMTP::OneLiner](http://search.cpan.org/perldoc?Net::SMTP::OneLiner)
*   [Net::IMAP::Simple::Plus](http://search.cpan.org/perldoc?Net::IMAP::Simple::Plus)
*   [X11::Protocol](http://search.cpan.org/perldoc?X11::Protocol)
*   [CGI::Fast](http://search.cpan.org/perldoc?CGI::Fast)
*   [CGI::Session](http://search.cpan.org/perldoc?CGI::Session)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-02T18:10:55.017

我有一段时间没有使用 Perl（抱歉，我的雇主混合使用了 Java 和 C#），但我记得使用过以下内容（按字母顺序）：

*   [电脑动画](http://search.cpan.org/perldoc?CGI)
*   [CGI::会话](http://search.cpan.org/perldoc?CGI::Session)
*   [地穴::密码MD5](http://search.cpan.org/perldoc?Crypt::PasswdMD5)
*   [DBI](http://search.cpan.org/perldoc?DBI)
*   [文件::查找](http://search.cpan.org/perldoc?File::Find)
*   [POSIX](http://search.cpan.org/perldoc?POSIX)
*   [模板](http://search.cpan.org/perldoc?Template) [（模板工具包）](http://template-toolkit.org/)
*   [URI::转义](http://search.cpan.org/perldoc?URI::Escape)

（你可能会注意到那里的非框架 webapp 模块的焦点......）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-02T18:45:54.043

我最常见的模块可能是

*   [电脑动画](http://search.cpan.org/perldoc?CGI)
*   [HTML::模板](http://search.cpan.org/perldoc?GetOpt::LongHTML::Template)
*   [DBI](http://search.cpan.org/perldoc?DBI)
*   [XML::简单](http://search.cpan.org/perldoc?XML::Simple)
*   [轻量化](http://search.cpan.org/perldoc?LWP)
*   [POSIX](http://search.cpan.org/perldoc?POSIX)
*   [文件::查找](http://search.cpan.org/perldoc?File::Find)

我不确定它是否算作“工具”，但我倾向于以主要功能风格编写我的程序。我尝试只为每个变量分配一次，并尝试避免修改其参数的子例程。我通常更喜欢“ [`grep`](http://perldoc.perl.org/functions/grep.html)”或“ [`map`](http://perldoc.perl.org/functions/map.html)”而不是循环。这条规则的最大例外是当我建立一个返回值时。我可以将东西推到数组的末尾，或者在循环中将项目添加到散列中。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-03T19:05:45.407

不计算所有模块开发和测试工具链的东西，我完成工作的工具箱包括：

螺母和螺栓：

*   [文件::啜饮](http://search.cpan.org/perldoc?File::Slurp)
*   [File::Spec](http://search.cpan.org/perldoc?File::Spec)（如果限于核心）或[Path::Class](http://search.cpan.org/perldoc?Path::Class)（如果不是）
*   [文件::临时](http://search.cpan.org/perldoc?File::Temp)
*   [IO::CaptureOutput](http://search.cpan.org/perldoc?IO::CaptureOutput) -- 即将被[Capture::Tiny取代](http://search.cpan.org/perldoc?Capture::Tiny)
*   [IPC::Run3](http://search.cpan.org/perldoc?IPC::Run3)
*   [标量::实用程序](http://search.cpan.org/perldoc?Scalar::Util)
*   [可储存](http://search.cpan.org/perldoc?Storable)

手动工具：

*   [存档::提取](http://search.cpan.org/perldoc?Archive::Extract)
*   [配置::小](http://search.cpan.org/perldoc?Config::Tiny)
*   [数据::转储::流媒体](http://search.cpan.org/perldoc?Data::Dump::Streamer)
*   [Email::Simple](http://search.cpan.org/perldoc?Email::Simple)和朋友（只发送，不解析！）
*   [参数::验证](http://search.cpan.org/perldoc?Params::Validate)
*   [模板::简单](http://search.cpan.org/perldoc?Template::Simple)
*   [领带::文件](http://search.cpan.org/perldoc?Tie::File)
*   [YAML::XS](http://search.cpan.org/perldoc?YAML::XS)（比[YAML::Syck](http://search.cpan.org/perldoc?YAML::Syck)更健壮）

电动工具：

*   [轻量化](http://search.cpan.org/perldoc?LWP)
*   [Mail::Box](http://search.cpan.org/perldoc?Mail::Box)（处理来自野外的电子邮件的必备工具）
*   [以太网](http://search.cpan.org/perldoc?POE)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-02T18:08:41.760

我使用 DBIx::Simple 而不是普通的 DBI，界面更简单、更规则。当然，还有用于 XML 处理的 XML::Twig。然后 Getopt::Std 用于（简单）选项，YAML::Syck 用于不需要数据库的临时存储以及调试，而不是 Data::Dumper。而且，像您一样，Text::Template 用于最复杂的输出。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-04T06:02:51.737

我经常使用这些，其中许多可以追溯到 10 年前。

**当然， CPAN**模块是我们有时会忘记的最好的模块之一，因为它会淡入背景。可以这么说，它是一个元模块。

下面的顶部组出现在我们`newperl`脚本的输出中，它提供了最佳实践的工作示例。生成的 perl 脚本在基本调试中实现了一些基本要求和提示，因此 perl 新手可以使用真实的设计养成良好的习惯。我们也有类似`newperlmod`的。

前两个更像是pragma，因为它们真正与内置语言的性质挂钩。

*   **[严格的](http://search.cpan.org/perldoc?strict)**
*   **[英语](http://search.cpan.org/perldoc?English)**

    *   **使用英语**主要是为了帮助其他阅读 Perl 的人
*   **[CWD](http://search.cpan.org/perldoc?Cwd)**

*   **[文件::查找](http://search.cpan.org/perldoc?File::Find)**
*   **[文件::基本名称](http://search.cpan.org/perldoc?File::Basename)**
*   **[鲤鱼](http://search.cpan.org/perldoc?Carp)**
*   **[日期::计算](http://search.cpan.org/perldoc?Date::Calc)**
*   **[GetOpt::长](http://search.cpan.org/perldoc?GetOpt::Long)**
*   **[数据::自卸车](http://search.cpan.org/perldoc?Data::Dumper)**

数据收集工具箱——更专业

*   **[Spreadsheet::ParseExcel](http://search.cpan.org/perldoc?Spreadsheet::ParseExcel)**和**[Text::CSV_XS——](http://search.cpan.org/perldoc?Text::CSV_XS)**甚至教经理们使用这些 :)
*   **[轻量化](http://search.cpan.org/perldoc?LWP)**
*   **[XML::Simple](http://search.cpan.org/perldoc?XML::Simple)**和**[XML::Parser](http://search.cpan.org/perldoc?XML::Parser)**
*   **[`tie`](http://perldoc.perl.org/functions/tie.html)**使用 G/DBM 系列：用于快速、可扩展的持久哈希
*   **[Parse::RecDescent](http://search.cpan.org/perldoc?Parse::RecDescent)**（慢，但允许快速开发/调试语法）

最近的一项发现是维护的福音。用于输出配置和批处理文件，例如

*   **[文本::模板](http://search.cpan.org/perldoc?Text::Template)**

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-03T23:30:13.100

我很惊讶没有人提到 Data::Dumper，我倾向于将`use`声明留在我的脚本中，因为我知道它对维护调试很有用。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-07-21T20:42:34.643

网络::FTP。我的大部分工作涉及从一个系统中提取文件、操作它们，然后将它们推送到另一个系统上。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-07-22T06:01:02.853

*   CGI::Application::Dispatch（因此也是 CGI::Application）
*   CGI::快速
*   DBIx::类
*   模板工具包
*   DBD::Pg
*   科罗
*   任何事件::*
*   gtk2::*
*   配置::常规
*   PDL
*   开发::NYTProf
*   Moose（希望启动速度更快）

我用这些开发网络应用程序和桌面应用程序。

我注意到这里有很多普通的 CGI.pm 粉丝，尽管我非常喜欢 CGI::Application，尤其是与 C::A::D 结合使用。它仍然非常轻量级，具有合理数量的插件，一个不错的网站，并且不像 Catalyst 那样缓慢或沉重。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-07-21T21:06:17.203

*   Perl6::属性
*   正则表达式::通用
*   DBI
*   数据::自卸车
*   Getopt::长
*   文件句柄
*   总热量
*   Tcl
*   Tkx
*   广东
*   配置::标准
*   排队

如果没有 Perl6，上面列表中的第一个使模块的可读性无限提高（恕我直言）。

# java - Bean 脚本框架

> ID：603346
> 
> 赞同：3
> 
> 时间：2009-03-02T18:00:51.187
> 
> 标签：java

我想使用[Bean Scripting Framework](http://jakarta.apache.org/bsf/index.html)使我的一些 Java 类可供我公司希望编写脚本的用户使用 + 可能熟悉 Javascript 或 Python（通过 Jython）或 Ruby（通过 JRuby）。

我真的找不到太多关于如何让 BSF 工作的教程文档......我想做的是制作一个运行 shell 的 Java 应用程序，无论是在 Javascript 还是 Jython 或 JRuby 中，并将我的一些 Java 类暴露给脚本语言。

任何指针？我浏览了[BSF 资源](http://jakarta.apache.org/bsf/resources.html)页面上的一些文档，但我觉得我错过了一些明显的入门内容。

（就像那里必须有一些外壳，用一个基本的调试器完成......）

编辑：澄清——我知道如何运行 bsf.jar，它工作正常。而且我知道如何使用 Rhino 运行 Javascript shell——但那是 Javascript 特有的，与 BSF 无关。我的问题是，是否有与 BSF 一起使用的与语言无关的 shell？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T22:27:14.900

要使用 BSF，您需要 bsf.jar 和类路径上您选择的脚本语言的库。要执行 Javascript，不需要额外的库。

要打开交互式 Javascript 控制台，请尝试：

```
java org.mozilla.javascript.tools.shell.Main 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T14:51:49.473

为什么需要 BSF？

任何 JVM 语言都可以直接访问 Java 类。[JRuby 的方式](http://wiki.jruby.org/wiki/Calling_Java_from_JRuby)，[Jython 的](http://www.jython.org/docs/usejava.html)方式。并且任何 JVM 语言都会以某种方式支持调试（[这里](http://wiki.netbeans.org/RubyDebugging)有一个示例）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T15:04:58.317

查看动态 JVM 编程语言，如[Groovy](http://groovy.codehaus.org/)或[JRuby](http://jruby.codehaus.org/)！您无需任何修改即可使用您的 java 类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T17:01:18.227

我不知道任何与语言无关的外壳。您可以尝试[jline](http://jline.sourceforge.net/) + [javax.script](http://java.sun.com/developer/technicalArticles/J2SE/Desktop/scripting/) + $language 自己编写。希望能帮助到你 ：）

# amazon-ec2 - 我们可以为 EC2 实例设置易于记忆的主机名吗？

> ID：603351
> 
> 赞同：51
> 
> 时间：2009-03-02T18:02:02.290
> 
> 标签：amazon-ec2, hostname

我在 EC2 上运行了几个标准的 Fedora 实例。我觉得亚马逊分配的实例的公共主机名太奇怪了，很难记住。我想把它们改成简短的（比如红色/蓝色/绿色/等）。

这样做有什么缺点吗？以及如何设置它以使其在重新启动后仍然存在？

谢谢。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2012-10-15T16:34:50.600

在开始之前，请尝试运行`hostname`并`hostname --fqdn`记下响应是什么。

您可以编辑`/etc/hostname`和设置主机名，该主机名将在重新启动后保留。`hostname -F /etc/hostname`您可以通过将该值读入主机名来强制“重新加载”主机名。退出并登录后，bash 提示符会发生变化。

**警告/注意**：
是的，很高兴将 bash 提示符中的主机名设置为更有用的东西，`ip-123-123-123-123`但我决定离开我的（至少现在），因为看起来很多事情真的依赖于以标准方式设置的 ec2 实例上的主机名。在将主机名编辑`/etc/hostname`和更改为`webserver`许多服务后似乎失败了，因为主机名无法解析，并且 apache 无法启动。接下来我编辑`/etc/hosts`并添加了

```
127.0.0.1 webserver 
```

作为第二行。然后 Apache 将启动，但抱怨它找不到 FQDN。我确认跑步`hostname --fqdn`不再有效。

接下来我咨询`man hostname`并了解到，虽然您可以设置`hostname`它，但它似乎`FQDN`是通过 DNS 查找返回的内容。

> ### FQDN
> 
> 您无法使用此命令更改 FQDN（由 hostname --fqdn 返回）或 DNS 域名（由 dnsdomainname 返回）。系统的 FQDN 是 resolver(3) 为主机名返回的名称。
> 
> 从技术上讲：FQDN 是 getaddrinfo(3) 为 gethostname(2) 返回的主机名返回的名称。DNS 域名是第一个点之后的部分。
> 
> 因此，它取决于配置（通常在 /etc/host.conf 中）如何更改它。通常（如果 hosts 文件在 DNS 或 NIS 之前解析）您可以在 /etc/hosts 中更改它。

我认为有可能设置系统/欺骗系统以返回 FQDN，就像`ip-123-123-123-123.ec2.internal`即使主机名是`webserver`，但在这一点上，它开始看起来比它的价值更麻烦，而且对我来说有一个更好的bash 提示可能会导致很多软件和配置问题，所以我决定放弃。

我还了解到，很多亚马逊 ec2 实例都使用一种叫做[cloud-init 的](https://help.ubuntu.com/community/CloudInit)东西：

> cloud-init 是处理云实例早期初始化的 Ubuntu 软件包。它安装在 Ubuntu 云映像以及 EC2 上可用的官方 Ubuntu 映像中。
> 
> 它配置的一些东西是：
> 
> *   设置默认语言环境
> *   设置主机名
> *   生成 ssh 私钥
> *   将 ssh 密钥添加到用户的 .ssh/authorized_keys 以便他们可以登录
> *   设置临时挂载点
> 
> cloud-init 的行为可以通过用户数据进行配置。用户数据可以在实例启动时由用户提供。这是通过 ec2-run-instances 的 --user-data 或 --user-data-file 参数完成的

[我还发现这个](https://code.launchpad.net/%7Eclint-fewbar/cloud-init/glusterfs-mount-example)讨论了如何使用 cloud-init 配置主机名：

> 在 EBS 实例上，关闭和稍后启动会以不同的 IP 地址结束。
> 
> 如果用户没有修改 /etc/hostname 的原始值（由元数据的“本地主机名”播种），则 cloud-init 将再次设置主机名并更新 /etc/hostname。
> 
> 如果用户修改了 /etc/hostname，它将保持用户管理。
> 
> 此外，如果 /etc/cloud/cloud.cfg 包含设置为 True 值的“preserve_hostname”值，则 /etc/hostname 将永远不会被触及。

有趣的是，如果您不更改主机名，cloud-init 包将为您保持最新状态。

如果其他人有解决方法或可以解决提到的一些问题并帮助确保不会因为更改主机名而在 ec2 实例上中断，我会很高兴听到它。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-20T20:06:09.983

另一种方法是简单地编辑`~/.bashrc`并`PS1`添加机器的昵称。

编辑：也许更正确，机器范围，例如在 AWS Linux AMI 上（一个例子）（将其粘贴到控制台或添加到您的任意安装 .sh）：

```
cat << EOF | sudo tee /etc/profile.d/ps1.sh
if [ "$PS1" ]; then
  PS1="[\u@myinst1:\l \t \! \W]\\$ "
fi
EOF 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-02-28T08:49:53.847

`/etc/sysconfig/network`以 root 身份编辑。

代替

```
HOSTNAME=localhost.localdomain 
```

和

```
HOSTNAME=hostname.DOMAIN_NAME 
```

然后，重新启动或运行`/etc/init.d/network restart` 服务器然后应将其名称报告为 FQDN。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-05-22T08:56:54.067

从[这个网站](http://www.ducea.com/2006/08/07/how-to-change-the-hostname-of-a-linux-system/)：

> 更改正在运行的系统上的主机名
> 
> 在任何 Linux 系统上，您都可以使用命令更改其主机名`hostname`（惊讶吗？）... 以下是命令行主机名的一些快速用法：
> 
> ```
> $> hostname 
> ```
> 
> 没有任何参数，它将输出系统的当前主机名。
> 
> ```
> $> hostname --fqd 
> ```
> 
> 它将输出系统的完全限定域名（或 FQDN）。
> 
> ```
> $> hostname NEW_NAME 
> ```
> 
> 将系统的主机名设置为`NEW_NAME`.

您还可以编辑`/etc/hostname`（至少在 Ubuntu 上）。

为了确保它在 AWS 中重新启动后仍然存在，请添加命令`/etc/rc.local`以便它在机器启动时运行。

还有一种方法[可以通过 USER_DATA 动态设置主机名](http://ternarylabs.com/2010/09/15/automatically-configure-hostname-for-new-ec2-instances/)：

> ```
> USER_DATA=`/usr/bin/curl -s http://169.254.169.254/latest/user-data`
> HOSTNAME=`echo $USER_DATA`
> IPV4=`/usr/bin/curl -s http://169.254.169.254/latest/meta-data/public-ipv4`
> hostname $HOSTNAME
> echo $HOSTNAME > /etc/hostname 
> ```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-01T02:59:11.017

将系统主机名更改为公共 DNS 名称

## 如果您已经注册了公共 DNS 名称，请按照此过程

1.  在您喜欢的文本编辑器中打开`/etc/sysconfig/network`配置文件并更改 HOSTNAME 条目以反映完全限定的域名（例如 webserver.mydomain.com）。

    ```
    HOSTNAME=webserver.mydomain.com 
    ```

2.  重新启动实例以获取新主机名。

    ```
    [ec2-user ~]$ sudo reboot 
    ```

3.  登录到您的实例并验证主机名是否已更新。您的提示应该显示新的主机名（直到第一个“.”），并且 hostname 命令应该显示完全限定的域名。

    ```
    [ec2-user@webserver ~]$ hostname
    webserver.mydomain.com 
    ```

## 在没有公共 DNS 名称的情况下更改系统主机名

1.  在您喜欢的文本编辑器中打开`/etc/sysconfig/network`配置文件并更改 HOSTNAME 条目以反映所需的系统主机名（例如 webserver）。

    ```
    HOSTNAME=webserver.localdomain 
    ```

2.  在您喜欢的文本编辑器中打开该`/etc/hosts`文件并添加一个以 127.0.1.1（在 DHCP 系统上）或 eth0 的地址（在静态 IP 系统上）开头的条目以匹配下面的示例，替换为您自己的主机名。（127.0.0.1 应保留为 localhost 行。）

    ```
    127.0.0.1   localhost localhost.localdomain
    127.0.1.1   webserver.example.com webserver 
    ```

3.  重新启动实例以获取新主机名。

    ```
    [ec2-user ~]$ sudo reboot 
    ```

4.  登录到您的实例并验证主机名是否已更新。您的提示应该显示新的主机名（直到第一个“.”），并且 hostname 命令应该显示完全限定的域名。

    ```
    [ec2-user@webserver ~]$ hostname
    webserver.localdomain 
    ```

**注意：您也可以在不影响主机名的情况下更改 shell 提示。请参阅[此 AWS 文档](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/set-hostname.html)。**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T18:41:15.160

当然，如果您有自己的域（设置 CNAME 以指向 Amazon 主机名），您可以这样做。否则，您几乎会被他们提供给您的IP（或弹性IP，如果您设置其中之一）所困扰。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-12T05:42:17.793

/etc/rc.local 解决方案适用于我的基本主机名，但没有给我一个 FQDN。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-01-07T13:09:26.107

在我的 Linux AMI 中（其他实例的快照）.. 上述公式均无效。然后，我只是更改了文件中的 HOSTNAME 字段：/etc/init.d/modifyhostname 并进行了正常重启。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-03-17T22:26:03.793

您需要执行多项操作来设置主机名：

1.  `hostname newname`- 设置主机名，但不稳定
2.  编辑 /etc/hostname - 设置下次重启的主机名
3.  编辑 /etc/hosts - 防止 sudo 抱怨

我将这些放在一个脚本中并作为要点上传： [https ://gist.github.com/mnebuerquo/5443532036af8b48995547e2817dba85](https://gist.github.com/mnebuerquo/5443532036af8b48995547e2817dba85)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-03-29T17:26:46.400

```
sudo hostname *yourdesiredhostnamehere*

sudo /etc/init.d/networking restart 
```

然后更改主机名。在我的服务器上，所有其他服务（如 apache 和 postfix）都可以正常工作。服务器是 Ubuntu 12.04 LTS

# asp.net - 什么是 ASP.net 应用程序的最佳性能计数器？

> ID：603354
> 
> 赞同：8
> 
> 时间：2009-03-02T18:02:48.950
> 
> 标签：asp.net, perfmon

可以设置哪些最佳性能监视器来监视 asp.net 应用程序？

我没有直接访问相关服务器的权限，所以我不得不明确要求某些事情，否则它们不会发生。我的预感是我的应用程序池正在重新启动，但我想深入了解为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T18:46:55.957

[这](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/b4d4d195-2ecb-4728-9348-6f1bfa1a1b63.mspx?mfr=true)是 IIS 的重要性能计数器的 MSDN 列表。

如果您的站点正在重新启动，您还需要来自与 IIS 相关的应用程序和安全日志中的事件。

如果/当确实发生崩溃时，您还可以使用[IISState生成转储文件。](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/993a8a36-5761-448f-889e-9ae58d072c09.mspx?mfr=true)

# c# - 有效处理 C# 方法中的单个值和多个值

> ID：603357
> 
> 赞同：2
> 
> 时间：2009-03-02T18:03:46.453
> 
> 标签：c#, .net, methods

我有这样的方法：

```
AverageAndDoSomeMath (Point2) 
```

我想知道如何处理：

```
AverageAndDoSomeMath (Point2) // single
AverageAndDoSomeMath (Point2 collection) // multiple 
```

最好使用单个实现。

对于集合，我计划使用 IEnumerable 类型，因此我可以传递任何类型的集合，但是对于单个值，我不想将其包装并作为集合传递，因为集合本身没有任何用途，除了满足类型。

如何以最清晰、最快、最有效的方式最好地处理它？

编辑：也许我应该选择一个更好的方法名称，但是该方法计算所有点的平均值，对于 1 值它没有意义，但认为该值将用于说计算另一个值，但重要的是找到平均值，所以我不能调用第一种方法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-02T18:06:19.597

写两个方法

*   AverageAndDoSomeMath（Point2 点）
*   AverageAndDoSomeMath（IEnumerable<Point2> 点）

并通过将第一个包装在一个集合中来使第一个调用第二个。

```
public decimal AverageAndDoSomeMath (Point2 point)
{
    return AverageAndSomeMath(new []{point});
} 
```

我猜这就是您已经想到的，但认为这不是正确的解决方案，对吧？

**编辑：**简化方法（感谢 Freddy Rios）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-02T18:10:08.527

我知道您说过您不想将其包装并作为集合传递，但是有两种方法可以轻松做到这一点，所以我会发布它们以防您不知道其中一种。

您可以在方法中使用参数：

```
public void Average(params Point2[] points) 
```

之后，您可以使用任意数量的参数或数组调用它：

```
Average(P1);
Average(P2, P3, P4);
Average(); // this one becomes an empty array in the method

Point[] array = new Point[] { P1, P2, P3, P4 };
Average(array); 
```

或者，您可以使用短数组语法来包装您的对象：

```
Average({ P1 }); // this is legal C# for making an array with 1 element 
```

**编辑：** 阅读您的笔记后，我建议 params 数组是做您想做的最清晰的方法。唯一真正的缺点是你不能在没有先调用的情况下传入 a `IEnumerable<Point2>`（或其他集合，如 a ） ，因为它只需要实际的数组。`List<Point2>``ToArray()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T19:01:49.353

每个方法的单一职责会说您的方法应该只做一件事 - 计算算术平均值 - 就是这样。没有“AndDoSomeOtherMath”。

如果你看一下平均值的[公式](http://mathworld.wolfram.com/ArithmeticMean.html)，你当然可以只用一点来计算一些有意义的东西。它是标准差，需要两个或更多。

仅供参考，您可以即时计算平均值和标准偏差，而无需存储所有值。这在记忆上要容易得多。John D. Cook 有一篇[很棒的博客文章](http://www.johndcook.com/blog/2008/09/26/comparing-three-methods-of-computing-standard-deviation/)，介绍了如何处理标准偏差。

# java - Java 线程教程类型问题

> ID：603363
> 
> 赞同：3
> 
> 时间：2009-03-02T18:06:28.927
> 
> 标签：java, multithreading, concurrency, threadpool

当谈到 Java 线程和并发的世界时，我相当天真。我目前正在努力学习。我做了一个简单的例子来试图弄清楚并发是如何工作的。

这是我的代码：

```
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class ThreadedService {

    private ExecutorService exec;

    /**
     * @param delegate
     * @param poolSize
     */
    public ThreadedService(int poolSize) {
        if (poolSize < 1) {
            this.exec = Executors.newCachedThreadPool();
        } else {
            this.exec = Executors.newFixedThreadPool(poolSize);
        }
    }

    public void add(final String str) {
        exec.execute(new Runnable() {
            public void run() {
                System.out.println(str);
            }

        });

    }

    public static void main(String args[]) {
        ThreadedService t = new ThreadedService(25);
        for (int i = 0; i < 100; i++) {
            t.add("ADD: " + i);
        }
    }

} 
```

我需要做什么才能使代码按顺序打印出数字 0-99？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T18:14:41.370

[线程池](http://en.wikipedia.org/wiki/Thread_pool)通常用于不需要[同步](http://en.wikipedia.org/wiki/Synchronization_(computer_science))或高度[并行](http://en.wikipedia.org/wiki/Parallel_algorithm)的操作。

顺序打印数字 0-99 不是并发问题，需要同步线程以避免打印乱序。

我建议看一下[Java 并发课程](http://java.sun.com/docs/books/tutorial/essential/concurrency/)，以了解 Java 中的并发性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T18:16:56.887

解决问题的最简单方法是使用大小为 1 的 ThreadPool。但是，这并不是真正使用线程来解决的问题。

要扩展，如果您使用以下命令创建执行程序：

```
this.exec = Executors.newSingleThreadExecutor(); 
```

那么您的线程将全部按照提交执行的顺序进行调度和执行。在少数情况下这是合乎逻辑的事情，但在大多数情况下，线程不是用来解决这个问题的错误工具。

当您需要在不同的线程中执行任务时，这种事情是有意义的——可能需要很长时间才能执行并且您不想阻塞 GUI 线程——但您不需要或不这样做'不希望提交的任务同时运行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T18:17:54.250

线程的想法不是按顺序做事。

您将需要一些共享状态来协调。在示例中，将实例字段添加到外部类将在此示例中起作用。从添加中删除参数。添加一个锁对象和一个计数器。抓住锁，增加打印数字，增加数字，释放数字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T20:57:20.233

根据定义，该问题不适合线程。线程是独立运行的，实际上并没有办法预测哪个线程首先运行。

如果要更改代码以按顺序运行，请将添加更改为：

```
public void add(final String str) {
    System.out.println(str);
} 
```

你没有使用线程（至少不是你自己的），一切都是按顺序发生的。

# sockets - 进程之间的套接字传递

> ID：603365
> 
> 赞同：5
> 
> 时间：2009-03-02T18:07:37.970
> 
> 标签：sockets, ipc, tcp, winsock

有没有办法在 Windows 中的进程（不同的地址空间）之间传递套接字？

我找到了这个信息[Shared Sockets](https://docs.microsoft.com/en-us/windows/win32/winsock/shared-sockets-2?redirectedfrom=MSDN)，因此相信这是可能的。

"**引入了 WSADuplicateSocket 函数来实现跨进程的套接字共享**"...

更多信息：在 Apache 的源代码 (httpd-2.2.11-win32-src.zip) 中使用了带有注释的 api WSADuplicateSocket。

[编辑] 最近我发现这个关于这个问题的很好的样本。
[在非托管世界中如何进行复制 - 套接字复制 - 第 1 部分](https://web.archive.org/web/20150111081526/http://blogs.msdn.com:80/b/malarch/archive/2005/12/14/503884.aspx)
[是否可以从非托管进程传输套接字？- 套接字复制 - 第 2 部分](https://web.archive.org/web/20150104003406/http://blogs.msdn.com:80/b/malarch/archive/2005/12/26/507461.aspx)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T19:50:33.200

[请参阅WSADuplicateSocket](http://msdn.microsoft.com/en-us/library/ms741565(VS.85).aspx)的备注部分。它有效地表明您可以使用您最喜欢的进程间通信方案将 WSAPROTOCOL_INFO 结构（它只是数据！）发送到目标。

有很多IPC方案。我可能会将共享内存与[Boost::interprocess](http://www.boost.org/doc/libs/1_38_0/doc/html/interprocess.html)一起使用。但是如果目标有一个窗口+消息循环，你可以使用 SendMessage。或者剪贴板 API，就此而言（虽然有些奇怪）。机制是你的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T18:33:34.337

如果您正在创建子进程，那么有些事情可能会为您完成。看

[http://www.tangentsoft.net/wskfaq/articles/passing-sockets.html](http://www.tangentsoft.net/wskfaq/articles/passing-sockets.html) （我知道这个在古代有效；不知道它是否适用于当前版本）

[http://msdn.microsoft.com/en-us/library/ms682499.aspx](http://msdn.microsoft.com/en-us/library/ms682499.aspx)

——马库斯

# visual-studio-2008 - 为什么 Visual Studio 2008™ 会崩溃？

> ID：603374
> 
> 赞同：3
> 
> 时间：2009-03-02T18:10:57.620
> 
> 标签：visual-studio-2008

我知道[这个线程](https://stackoverflow.com/questions/96780/why-is-visual-studio-constantly-crashing)，其中问题仅限于源代码控制问题。

就我而言，它更笼统。有时，即使没有用户输入，Visual Studio 也会随机崩溃。

我通常会关闭所有文件并清理我的项目以避免进一步崩溃，但我最终会再次崩溃，而我并不知道为什么。

你有一些提示和技巧来避免随机崩溃吗？

编辑：我已经安装了 SP1，我正在使用 4GB RAM 的 Q6600 上运行 Vista

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T18:22:10.043

当您开始或停止调试时，未停靠的窗口可能会导致崩溃。[这里](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=362433)有一个错误报告。
附加组件也可能导致崩溃，以我的经验尤其是 ReSharper。您可以尝试禁用任何您可以不用的附加组件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T18:33:15.117

如果它是由附加组件引起的，而您恰好运行的是 64 位操作系统，那么还有希望！Microsoft 发布了一个修补程序，以纠正 ReSharper 和其他附加组件可能导致的 VS2008 崩溃。它可以在这里找到：http: [//support.microsoft.com/kb/947841](http://support.microsoft.com/kb/947841)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T18:58:12.657

当 Visual Studio 在您身上崩溃时，您是否会收到一个对话框，要求您将详细信息发送给 Microsoft？如果您这样做，请单击“此报告包含什么”并在 Google 上搜索标题的关键部分，您可能会找到一些关于您的问题的修补程序或知识库文章。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T18:15:39.810

我会查看您正在使用的任何插件或源代码控制集成。

我现在签约的地方使用 Visual Source Safe（我知道...），而 VSS 集成导致我发生了几次崩溃。尤其是当我打开了很多文件时，当它同时检查（大概）我所有打开文件的状态时，启动事件更是如此。

在家里，我使用带有 Ankh SVN 插件的 VS2008，它从不崩溃。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T18:31:54.030

你得到 OutOfMemoryException？检查 .suo 文件的大小。我在 VS 2005 中[遇到了这个问题](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=309804)，但我没有在 2008 年重现它。.suo 文件会膨胀，重复一行代码数千次，最终重复数百万次。每次我保存时，这会使 .suo 文件增长几兆字节。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T18:32:24.277

任何程序都会“崩溃”的原因太多了。你提出了一个本质上无法回答的问题。见鬼，甚至可能是您机器上的其他软件导致 VS 崩溃，所以无论您对 VS 做什么，它都无法解决真正的问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T18:32:41.187

VS可能崩溃的原因基本上有3个。

1) 错误或安装不当的插件。2) 坏硬件，即内存。它可能只会偶尔崩溃一次。3）VS中的一个错误。

1 通常很难追踪。

2 也很难追踪，因为内存可能会间歇性地失败。Visual Studio 是一个如此庞大的程序，它比您运行的大多数其他程序更容易占用坏内存。

3 VS 当然有错误，但我从来没有遇到过它只是崩溃而没有做任何事情的情况，所以我对此表示怀疑。

# c++ - c++命名空间使用和命名规则

> ID：603378
> 
> 赞同：25
> 
> 时间：2009-03-02T18:13:13.370
> 
> 标签：c++, namespaces

在这个项目中，我们正试图就命名空间的使用达成一致。我们决定第一层是“productName”，第二层是“moduleName”。

```
productName::moduleName 
```

现在，如果该模块是一种实用模块，则添加第三个命名空间没有问题。例如添加“str”：productName::utilityModuleName::str - 划分所有“字符串”相关内容的空间。

如果模块是主要业务模块，我们有很多机会，几乎没有协议。

例如

```
class productName::mainModuleName::DomainObject 
```

和

```
class productName::mainModuleName::DomainObjectSomethingElseViewForExample 
```

都可以在

```
namespace productName::mainModuleName::domainObject
class Data
class ViewForExample 
```

为什么我们应该创建内部而不是私有类而不是命名空间？为什么我们应该创建所有方法都是静态的类（除了这个类将成为模板参数的情况）？

项目包含 1Gb 的源代码。那么，在 c++ 中在命名空间上划分模块的最佳做法是什么？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-03-02T18:33:16.227

**命名空间的用途：**

命名空间仅用于建立上下文，因此您没有命名冲突。

**一般规则：**

不需要指定太多的上下文，并且会导致更多的不便。

所以你想用你最好的判断，但仍然遵循以下两条规则：

*   使用命名空间时不要太笼统
*   使用命名空间时不要太具体

对于如何使用命名空间名称，我不会那么严格，而是简单地使用基于相关代码组的命名空间。

**为什么过于笼统的命名空间没有帮助：**

以产品名称开头划分命名空间的问题在于，您通常会有一个代码组件，或者多个产品共有的一些基础库。

您也不会在 Product1 中使用 Product2 命名空间，因此明确指定它是没有意义的。如果您将 Product2 的文件包含在 Product1 中，那么这种命名转换仍然有用吗？

**为什么过于具体的命名空间没有帮助：**

当您的命名空间过于具体时，这些不同的命名空间之间的界限开始变得模糊。您开始来回使用彼此内部的命名空间。这时候最好把通用代码一起泛化到同一个命名空间下。

**具有所有静态与模板的类：**

> “为什么我们应该创建内部而不是私有类而不是命名空间？为什么我们应该创建所有方法都是静态的类”

一些区别：

*   可以使用`using`关键字来暗示命名空间
*   命名空间可以是别名，类是类型并且可以是类型定义的
*   可以添加命名空间；您可以随时为其添加功能并直接添加
*   如果不创建新的派生类，就无法添加类
*   命名空间可以有前向声明
*   使用类，您可以拥有私有成员和受保护成员
*   类可以与模板一起使用

**具体如何划分：**

> “项目包含 1Gb 的源代码。那么，在 c++ 中在命名空间上划分模块的最佳做法是什么？”

在没有确切源代码的情况下准确地说如何划分代码太主观了。根据模块进行划分虽然听起来合乎逻辑，但不是整个产品。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-02T18:19:51.873

这都是主观的，但我会犹豫是否深入超过 3 个级别。在某些时候它变得太笨拙了。所以除非你的代码库非常非常大，否则我会保持它很浅。

我们将代码划分为子系统，并为每个子系统设置一个命名空间。如果实用程序确实可以跨子系统重用，它们将进入它们自己的命名空间。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T18:49:35.733

在我看来，您正在尝试将命名空间用作设计工具。它们不是为此而设计的，它们旨在防止名称冲突。如果没有冲突，则不需要命名空间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-06T13:06:45.697

我根据其用途划分命名空间：

我有一个单独的命名空间，我在其中定义了所有接口（纯虚拟类）。

我有一个单独的命名空间，我在其中定义了我的库类（如 db 库、处理库）。

而且我有一个单独的命名空间，其中有我的核心业务（业务逻辑）对象（如 purchase_order 等）。

我想，它是以某种方式定义它，这在未来不会变得难以处理。因此，您可以检查当前设计中的困难。

如果你认为他们很好，你应该接受它。

# c# - 左外连接并存在于 Linq To SQL C# .NET 3.5

> ID：603380
> 
> 赞同：1
> 
> 时间：2009-03-02T18:14:10.280
> 
> 标签：c#, asp.net, sql, linq-to-sql, left-join

我一直在翻译从 LINQToSQL 返回唯一父行的左外连接。

我有 2 个表（Project、Project_Notes，它是由 Project_ID 链接的一对多关系）。我正在对 2 表的多个列进行关键字搜索，如果 Project_Notes 中的列包含关键字，我只想返回唯一的项目。我有这个 linqtoSQl 序列，但它似乎返回多个项目行。也许以`Exist`某种方式在 LINQ 中做一个？或者也许是某种groupby？

这是 LINQToSQL：

```
 query = from p in query
 join n in notes on p.PROJECT_ID equals n.PROJECT_ID into projectnotes
 from n in notes.DefaultIfEmpty()
 where n.NOTES.Contains(cwForm.search1Form)
 select p; 
```

这是它从分析器生成的 SQL

> exec sp_executesql N'SELECT [t2].[Title], [t2].[State], [t2].[PROJECT_ID], [t2].[PROVIDER_ID], [t2].[CATEGORY_ID], [t2].[ City], [t2].[UploadedDate], [t2].[SubmittedDate], [t2].[Project_Type]FROM (SELECT ROW_NUMBER() OVER (ORDER BY [t0].[UploadedDate]) AS [ROW_NUMBER], [ t0].[Title], [t0].[State], [t0].[PROJECT_ID], [t0].[PROVIDER_ID], [t0].[CATEGORY_ID], [t0].[City], [t0] .[UploadedDate], [t0].[SubmittedDate], [t0].[Project_Type] FROM [dbo].[PROJECTS] AS [t0] LEFT OUTER JOIN [dbo].[PROJECT_NOTES] AS [t1] ON 1=1 WHERE ([t1].[NOTES] LIKE @p0) AND ([t0].SubmittedDate] >= @p1) AND ([t0].[SubmittedDate] < @p2) AND ([t0].[PROVIDER_ID] = @ p3) AND ([t0].[CATEGORY_ID] IS NULL)) AS [t2] WHERE [t2].[ROW_NUMBER] @p4 + 1 AND @p4 + @p5 ORDER BY [t2].[ROW_NUMBER]',N '@p0 varchar(9),@p1 日期时间,@p2 日期时间,@p3 int,@p4 int,@p5 int',@p0='%chicago%',@p1=''2000-09-02 00:00:00:000'',@p2=''2009-03 -02 00:00:00:000'',@p3=1000,@p4=373620,@p5=20

此查询在结果中返回 1 对多关系的所有复数。我从这里找到了如何`Exists`在 LINQ 中进行操作。[http://www.linq-to-sql.com/linq-to-sql/t-sql-to-linq-upgrade/linq-exists/](http://www.linq-to-sql.com/linq-to-sql/t-sql-to-linq-upgrade/linq-exists/)

这是使用的 LINQToSQL `Exists`：

```
query = from p in query
where (from n in notes
where n.NOTES.Contains(cwForm.search1Form)
select n.PROJECT_ID).Contains(p.PROJECT_ID)
select p; 
```

生成的 SQL 语句：

> exec sp_executesql N'SELECT COUNT(*) AS [value] FROM [dbo].[PROJECTS] AS [t0] WHERE (EXISTS(SELECT NULL AS [EMPTY] FROM [dbo].[PROJECT_NOTES] AS [t1] WHERE ([ t1].PROJECT_ID] = ([t0].[PROJECT_ID])) AND ([t1].[NOTES] LIKE @p0))) AND ([t0].[SubmittedDate] >= @p1) AND ([t0] .[SubmittedDate] < @p2) AND ([t0].[PROVIDER_ID] = @p3) AND ([t0].[CATEGORY_ID] IS NULL)',N'@p0 varchar(9),@p1 datetime,@p2日期时间,@p3 int',@p0='%chicago%',@p1=''2000-09-02 00:00:00:000'',@p2=''2009-03-02 00:00: 00:000'',@p3=1000

我`databind()`从使用`Exists`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T18:38:17.227

> 它似乎返回多个项目行

是的，这就是 join 的工作方式。如果一个项目有 5 个匹配的注释，它会显示 5 次。

* * *

如果问题是 - “加入”是错误的习语！

您想将项目过滤到那些笔记包含特定文本的项目：

```
var query = db.Project
  .Where(p => p.Notes.Any(n => n.NoteField.Contains(searchString))); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T18:17:18.917

您将不得不使用 DefaultIfEmpty 扩展方法。已经有一些关于 SO 的问题显示了如何做到这一点。这是一个很好的例子：

[如何在 LINQ 中执行嵌套的 Join、Add 和 Group？](https://stackoverflow.com/questions/254784/how-can-i-perform-a-nested-join-add-and-group-in-linq)

# wix - Wix 主要升级，我做错了什么？

> ID：603381
> 
> 赞同：2
> 
> 时间：2009-03-02T18:14:22.433
> 
> 标签：wix, installation, upgrade, wix3

如果没有组件发生更改，升级工作正常，但任何时候组件更改升级都会失败，并且需要用户手动卸载并重新安装。

一些片段：

```
<Product Id="*" Name="My Application" Language="1033" Version="!(bind.FileVersion.ClientEXE)" Manufacturer="My Company" UpgradeCode="MYGUID-b94a-44eb-8e92-9286f1d89bbd">
    <Package Id="*" Description="My Installer" Comments="Copyright My Company 2008" InstallerVersion="200" Compressed="yes" />
    <Upgrade Id="MYGUID-b94a-44eb-8e92-9286f1d89bbd">
      <UpgradeVersion Language="1033" Property="UPGRADEFOUND" Minimum="0.0.0.0" Maximum="99.99.99.99" IncludeMinimum="yes" IncludeMaximum="yes" />
    </Upgrade>

    <InstallExecuteSequence>
          <RemoveExistingProducts Before="InstallInitialize" />
    </InstallExecuteSequence> 
```

此外，有时在卸载时无法删除以下注册表项有一些问题，我不明白为什么：

```
 <Component Id="InstalledRegistry" Guid="SOMEGUID-0a17-4c6b-983d-8f3feb3a7724">
        <RegistryKey Id="InstalledRegKey" Root="HKMU" Key="SOFTWARE\MyCompany\Client" Action="createAndRemoveOnUninstall">
          <RegistryValue Name="Version" Type="string" Value="!(bind.FileVersion.ClientEXE)" KeyPath="yes"/>
        </RegistryKey>
      </Component> 
```

这就是引导程序检查是否以“REINSTALL=ALL REINSTALLMODE=vamus”启动 msiexec 的内容，因此如果已卸载但未删除注册表项，安装程序将尝试进行升级并静默失败。

让我知道是否需要更多信息

* * *

编辑：之后还有一些其他问题，只有一些文件被更新。将 RemoveExistingProducts 更改为 After="InstallValidate" 并解决了该问题。让它慢一点，因为它完全删除了以前的安装，而不是只升级更改的文件（它似乎没有为我正确检测到），但它完成了工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T18:30:54.780

FWIW，您不需要任何命令行参数来执行重大升级。

代码对我来说看起来不错，所以可能是版本号没有改变？（请记住，如果您使用 4 部分版本号，Windows Installer 只关心前三个部分）

# sharepoint - SharePoint 列表错误：“值不在预期范围内”

> ID：603389
> 
> 赞同：8
> 
> 时间：2009-03-02T18:15:59.357
> 
> 标签：sharepoint, list

您好我正在使用 SharePoint 命名空间进行开发，当我尝试从我的一个 lsits 中检索 URL 列时遇到了以下错误。

```
 "Value does not fall within the expected range" 
```

我正在做的就是：

```
item["URL"] 
```

有人能告诉我我能做些什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-03T04:12:04.493

该错误绝对意味着找不到该字段。

调试进程并查看`ListItem.Fields.SchemaXML`属性以找到其内部名称，它可能在内部保存为`URL`. 您还可以使用以下方法获取列表项值。

```
SPField l_field = l_item.Fields.GetField("URL");
string l_fieldValue = l_item[l_field.Id].ToString(); 
```

该`GetField`方法通过 DisplayName 和 InternalName 查找字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T18:24:48.883

要获取 的 URL `SPListItem`，请使用`Item.Url`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-29T14:38:54.117

```
 public static string GetItemURLValue(SPListItem item, string fieldName)
    {
        string exit = "";
        SPFieldUrlValue link = new SPFieldUrlValue(item[fieldName].ToString());
        exit = link.Url;
        return exit;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-29T15:23:11.157

有一种检索 URL 的特殊方法。尝试这个：

```
SPListItem li = ...
SPFieldUrlValue fuv = new SPFieldUrlValue(li[strFieldName].ToString());
return fuv.Url; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T18:22:07.157

这通常意味着“URL”不是列表中的字段。

如果它是提升的 InfoPath 列，请尝试停用表单模板并将其重新激活到站点。我注意到每当我向信息路径模板添加新的提升字段时，我都必须这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-23T12:56:13.707

我的是一个 Windows 应用程序。在创建设置并尝试部署后，我曾经遇到过此异常。

我的应用程序需要用 Excel 编写，然后保存。我使用了 COM 组件“Microsoft Excel 11.0 Object”的参考。我注意到当我添加这个引用时，实际上有 3 个 dll 出现在我的引用列表中。

1.  微软office.core
2.  Excel
3.  VBIDE

我删除了“VBIDE”引用，我的问题就解决了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-10-02T02:30:19.457

如果它只是一个列名并且采用“单行文本”格式，那么：

```
item["URL"] != null ? item["URL"].ToString() : "Not Found"; 
```

# c++ - C++ 中的内联成员函数

> ID：603390
> 
> 赞同：15
> 
> 时间：2009-03-02T18:16:48.683
> 
> 标签：c++, inline-method

ISO C++说C++中成员函数的内联定义与用内联声明是一样的。这意味着该函数将在使用该成员函数的每个编译单元中定义。但是，如果函数调用由于某种原因不能被内联，则函数将“像往常一样”被实例化。（[http://msdn.microsoft.com/en-us/library/z8y1yy88%28VS.71%29.aspx](http://msdn.microsoft.com/en-us/library/z8y1yy88%28VS.71%29.aspx)) 我对这个定义的问题是它没有说明它将在哪个翻译单元中被实例化。我遇到的问题是，当面对单个静态库中的两个目标文件时，它们都引用了一些无法内联的内联成员函数，链接器可能会“选择”任意目标文件作为定义的源。这种特殊的选择可能会引入不需要的依赖关系。（除其他事项外）

例如： **在静态库中**

```
A.h:

class A{
  public:
    virtual bool foo() { return true; }
}; 
```

U1.cpp：

```
A a1; 
```

U2.cpp：

```
A a2; 
```

*和很多依赖*

**在另一个项目** main.cpp 中：

```
#include "A.h"

int main(){
  A a;
  a.foo();
  return 0;
} 
```

第二个项目是指第一个项目。我如何知道编译器将使用哪个定义，以及哪些目标文件及其依赖项将被链接到？标准对此有什么规定吗？（试过了，没找到）

谢谢

编辑：因为我看到有些人误解了问题是什么，所以我想强调一下：*如果编译器决定为该函数创建一个符号（在这种情况下，由于“虚拟性”，它将是不同目标文件中的几个（外部可见的）实例化，链接器将选择哪个定义（从哪个目标文件？）*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-02T18:35:16.937

只是我的两分钱。这不是特别关于虚函数，而是关于内联函数和成员函数。也许它是有用的。

### C++

就标准 C++ 而言，*必须*在使用它的每个翻译单元中定义内联函数。并且非静态内联函数将在每个翻译单元中具有相同的静态变量和相同的地址。编译器/链接器必须将多个定义合并到一个函数中才能实现这一点。因此，始终将内联函数的定义放在头文件中 - 如果您仅在实现文件（“.cpp”）（对于非成员函数）中定义它，则不要将其声明放入头文件中，因为如果您如果有人使用它，您会收到有关未定义函数或类似内容的链接器错误。

这与必须在整个程序中仅定义一次的非内联函数不同（*one-definition-rule*）。对于内联函数，如上所述的多个定义是相当正常的情况。这与调用是否最终内联无关。关于内联函数的规则仍然很重要。Microsoft 编译器是否遵守这些规则 - 我不能告诉你。如果它在这方面遵守标准，那么它会。但是，我可以想象一些使用虚拟、dll 和不同 TU 的组合可能会出现问题。我从未测试过它，但我相信没有问题。

对于成员函数，如果你在类中定义你的函数，它是隐式内联的。由于它出现在标题中，因此必须在使用它的每个翻译单元中定义它的规则会自动得到满足。但是，如果您在类外和头文件中定义函数（例如，因为中间有代码的循环依赖），那么如果您多次包含相应的文件，则该定义必须是内联的，以避免链接器引发的多定义错误。文件示例`f.h`：

```
struct f {
    // inline required here or before the definition below
    inline void g();
};

void f::g() { ... } 
```

这与将定义直接放入类定义中具有相同的效果。

### C99

请注意，C99 的内联函数规则比 C++ 更复杂。这里，内联函数可以定义为*内联定义*，在整个程序中可以存在多个。但是如果使用这样的（内联）定义（例如，如果它被调用），那么在另一个翻译单元中包含的整个程序中也*必须有**一个外部定义。*基本原理（引自解释几个 C99 特性背后基本原理的 PDF）：

> C99 中的内联确实以两种方式扩展了 C++ 规范。首先，如果一个函数在一个翻译单元中被声明为内联，则不需要在每个其他翻译单元中都被声明为内联。例如，这允许在库中内联但只能通过其他地方的外部定义使用的库函数。为外部函数使用包装函数的替代方法需要一个额外的名称；如果翻译器实际上不进行内联替换，它也可能对性能产生不利影响。
> 
> 其次，内联函数的所有定义“完全相同”的要求被以下要求取代：程序的行为不应依赖于调用是用可见的内联定义还是外部定义来实现的。功能。这允许内联定义专门用于在特定翻译单元中使用。例如，库函数的外部定义可能包括一些参数验证，这些参数验证对于从同一库中的其他函数进行的调用来说是不需要的。这些扩展确实提供了一些优势；关心兼容性的程序员可以简单地遵守更严格的 C++ 规则。

为什么我将 C99 包含在此处？因为我知道微软编译器支持 C99 的一些东西。所以在那些 MSDN 页面中，一些东西也可能来自 C99——虽然没有特别想出任何东西。在阅读它并将这些技术应用于自己的旨在成为可移植 C++ 的 C++ 代码时，应该小心。可能会告知哪些部分是 C99 特定的，哪些不是。

测试 C++ 小片段是否符合标准的好地方是[comeau 在线编译器](http://www.comeaucomputing.com/tryitout/)。如果它被拒绝，可以很确定它不是严格符合标准的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-02T19:27:24.457

当你有一个被编译器强制非内联的内联方法时，它会在每个使用它的编译单元中实例化该方法。今天，大多数编译器都足够聪明，可以仅在需要时（如果使用）实例化方法，因此仅包含头文件不会强制实例化。正如您所说，链接器将选择其中一个实例包含在可执行文件中 - 但请记住，对象模块内的记录是一种特殊类型（例如，COMDEF），以便为链接器提供足够的了解如何丢弃重复实例的信息。因此，这些记录不会导致模块之间出现不需要的依赖关系，因为链接器将使用它们来解决依赖关系的优先级低于“常规”记录。

在你给出的例子中，你真的不知道，但这没关系。链接器永远不会仅基于非内联实例来解决依赖关系。结果（就链接器包含的模块而言）将与内联方法不存在一样好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-02T18:27:16.443

AFAIK，没有关于 C++ 编译器如何以及何时内联函数调用的标准定义。这些通常是编译器绝不需要遵循的“建议”。事实上，不同的用户可能想要不同的行为。一个用户可能关心速度，而另一个用户可能关心生成的小目标文件大小。此外，编译器和平台也不同。有些编译器可能会应用更智能的分析，有些可能不会。一些编译器可能会从内联生成更长的代码，或者在调用过于昂贵的平台上工作，等等。

当你有一个内联函数时，编译器仍然应该为它生成一个符号并最终解析它的一个版本。这样，如果它在静态库中，人们仍然可以调用不在 inline 中的函数。换句话说，它仍然充当正常功能。

内联的唯一效果是在某些情况下，编译器会看到调用，看到内联，然后完全跳过调用，但函数应该仍然存在，只是在这种情况下没有被调用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-02T18:20:07.333

> 如果编译器决定为该函数创建一个符号（在这种情况下，由于“虚拟性”，它将在不同的目标文件中存在几个（外部可见的）实例化，哪个定义（来自哪个目标文件？）链接器会选择吗？）

存在于相应翻译单元中的定义。一个翻译单位不能，我重复一遍，不能只有一个这样的定义。标准对此很清楚。

> [...]链接器可能会“选择”任意目标文件作为定义的来源。

**编辑：**为了避免任何进一步的误解，让我明确一点：根据我对标准的阅读，跨不同 TU 具有多个定义的能力并没有给我们**任何**实际的影响力。实际上，我的意思是实现方式甚至略有不同。***现在，如果你所有的 TU 都有完全相同的定义，为什么还要麻烦从哪个 TU 中提取定义呢？***

如果您浏览该标准，您会发现“单一定义规则”适用于任何地方。即使允许对一个函数*有多个定义：*`inline`

> **3.2 一个定义规则：**
> 
> 5 类类型（第 9 条）、概念（14.9）、概念图（14.9.2）、枚举类型（7.2）、带有外部链接的内联函数（7.1.2）、[.. .]

结合阅读

> 3 [...] 内联函数应在使用它的每个翻译单元中定义。
> 
> 这意味着该函数将在每个编译单元中定义 [...]

和

> **7.1.2 函数说明符**
> 
> 2 带有 inline 说明符的函数声明（8.3.5、9.3、11.4）声明了一个内联函数。inline 说明符向实现表明，在调用点对函数体进行内联替换优于通常的函数调用机制。在调用点执行此内联替换不需要实现；然而，即使省略了这个内联替换，7.1.2 中定义的内联函数的其他规则仍应得到遵守。
> 
> 3 在类定义中定义的函数是内联函数。inline 说明符不应出现在块作用域函数声明中。[脚注：82] 如果在友元声明中使用 inline 说明符，则该声明应为定义，或者该函数应先前已被声明为内联。

和脚注：

> 82) inline 关键字对函数的链接没有影响。§ 7.1.2 138

也：

> 4 内联函数应在使用它的每个翻译单元中定义，并且在每种情况下都应具有完全相同的定义（3.2）。[ 注意：在其定义出现在翻译单元之前，可能会遇到对内联函数的调用。—尾注] 如果函数的定义在其第一次声明为内联之前出现在翻译单元中，则程序格式错误。如果具有外部链接的函数在一个翻译单元中声明为内联，则应在其出现的所有翻译单元中声明为内联；不需要诊断。具有外部链接的内联函数在所有翻译单元中应具有相同的地址。外部内联函数中的静态局部变量始终引用同一个对象。外部内联函数主体中的字符串文字是不同翻译单元中的相同对象。[注意：出现在默认参数表达式中的字符串文字不在内联函数的主体中，这仅仅是因为该表达式用于该内联函数的函数调用中。——尾注]

Distilled：可以有多个定义，但它们在**每个**翻译单元和地址中必须具有相同的外观和感觉——但这并不能真正让你高兴。**因此，没有定义**跨翻译单元的多个定义（注意：我并不是说您正在调用 UB）。

至于`virtual`东西——不会有任何内联。时期。

标准说：

*   必须提供相同的**声明**
*   必须有**一个定义**

来自[MSDN](http://msdn.microsoft.com/en-us/library/bw1hbe6y(VS.71).aspx)：

> 给定的内联成员函数必须在每个编译单元中以相同的方式声明。此约束导致内联函数的行为就像它们是实例化函数一样。此外，内联函数必须只有一个定义。

您`A.h`包含类定义和成员`foo()`的定义。

`U1.cpp`并且`U2.cpp`都*定义*了两个不同的 class**对象**`A`。

您在 中创建另一个`A`对象`main()`。这很好。

到目前为止，我只看到了一个定义`A::foo()`是内联的。（请记住，在类声明中定义的函数*始终*是内联的，无论其前面是否有`inline`关键字。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T18:19:11.937

如果您想确保它们被编译到特定的库中，请不要内联您的函数。

# visual-c++ - 我在哪里翻译 MFC 消息框

> ID：603402
> 
> 赞同：8
> 
> 时间：2009-03-02T18:21:10.840
> 
> 标签：visual-c++, mfc

我正在将 MFC 应用程序本地化为日语，并且资源正常工作。

我目前的问题是，当我使用`AfxMessageBox`or时`MessageBox`，对话框标题和按钮消息以英文显示，我还没有找到任何地方可以改变它。

我没有找到任何有用的搜索 MSDN 或谷歌。

所以，

这行得通吗？Windows 是否提供日语、阿拉伯语和俄语的“确定”或“是/否”按钮？

如果没有，我应该指定什么来更改这些？

编辑：我与 . 一起`MessageBoxEx`编写了一个包装类，以使其与`AfxMessageBox`. 它确实出现`MB_OK`在英语和日语中都显示为“OK”，但其他按钮选项如`MB_YESNO`被翻译成我认为是正确的日语。这是一个相当小的翻译应用程序，我们可能希望对较大的应用程序使用自动化的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T18:25:09.410

使用[MessageBoxEx](http://msdn.microsoft.com/en-us/library/ms645507(VS.85).aspx)并指定 WORD wLanguageId 字段。

> wLanguageId [in] 指定消息框按钮中显示的文本的语言。指定零 (0) 值表示以默认系统语言显示按钮文本。如果此参数为 MAKELANGID(LANG_NEUTRAL, SUBLANG_NEUTRAL)，则使用与调用线程关联的当前语言。
> 
> 要指定当前语言以外的语言，请使用 MAKELANGID 宏来创建此参数。有关详细信息，请参阅 MAKELANGID。

有关[MAKELANGID](http://msdn.microsoft.com/en-us/library/bb202928.aspx)的更多信息，请参见此处。

* * *

如果这对您不起作用，另一种方法是制作您自己的对话框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T07:11:45.373

标题是您指定的字符串，因此您应该能够翻译它。在 AfxMessageBox() 中，标题是应用程序名称 (AfxGetAppName() IIRC)。

关于按钮，文本是操作系统的一部分，无法翻译。

MessageBoxEx（由 Brian 提到）在语言支持方面从来没有很好地工作过。[十多年前的这篇 MS 知识库文章](http://support.microsoft.com/kb/152670/en-us)说，Windows 2000 将正确支持语言 ID。但它显然从未成功过。

所以你很不走运。您唯一的解决方案是使用第三方实现，例如优秀的[XMessageBox](http://www.codeproject.com/KB/dialog/xmessagebox.aspx)，并通过您的字符串表提供翻译。

请注意，[appTranslator](http://www.apptranslator.com)的词汇表包含 25 种语言的 Yes、no、cancel、...等词，并且会自动翻译它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-06T13:51:01.973

创建您自己的**L10N**宏/函数并使用以下代码：

```
静态 LRESULT __stdcall ChangeCaptions(int nCode, WPARAM wParam, LPARAM lParam)
{
    如果（nCode == HCBT_ACTIVATE）{
        SetWindowText(GetDlgItem((HWND) wParam, IDOK), L10N(GUI_OK_MSG));
        SetWindowText(GetDlgItem((HWND) wParam, IDCANCEL), L10N(GUI_CANCEL_MSG));
        SetWindowText(GetDlgItem((HWND) wParam, IDYES), L10N(GUI_YES_MSG));
        SetWindowText(GetDlgItem((HWND) wParam, IDNO), L10N(GUI_NO_MSG));
    }
    返回0；
}

int addon_gui_messagebox（HWND parentHWnd，HINSTANCE hInstance，void *text，void *caption，int 类型）
{
    诠释；
    hook = SetWindowsHookEx(WH_CBT, ChangeCaptions, hInstance, GetCurrentThreadId());
    ret = MessageBox(parentHWnd, 文本, 标题, 类型);
    UnhookWindowsHookEx(hook);
    返回 ret;
}

```

正如我之前写的 MessageBoxEx 当前忽略 lang arg。

# vb.net - Winforms MDI“桌面”区域边界

> ID：603412
> 
> 赞同：4
> 
> 时间：2009-03-02T18:24:08.960
> 
> 标签：vb.net, winforms, mdi, mdiparent, mdichild

默认的 MDI 父控件有一个很大的“桌面”区域，可以显示多个子窗体。用户可以将表单拖到这个桌面区域的边缘，这样子表单的大部分就不会出现在屏幕上。（然后滚动条出现在 MDI 父级中）我不喜欢这个功能。有没有办法锁定桌面区域的边缘，使子窗体保持完全可见？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T21:18:16.280

我用来实现上面选择的答案的代码：

```
Public alreadyMoved As Boolean = False
Public Const HEIGHT_OF_MENU_STATUS_BARS As Integer = 50
Public Const WIDTH_OF_MENU_STATUS_BARS As Integer = 141
Private Sub Form_Move(ByVal sender As System.Object, _
    ByVal e As System.EventArgs) Handles MyBase.Move
    If Not alreadyMoved Then
        alreadyMoved = True

        'If I'm over the right boundry, drop back to right against that edge
        If Me.Location.X + Me.Width > _
            MdiParent.ClientRectangle.Width - WIDTH_OF_MENU_STATUS_BARS Then
            MyBase.Location = New System.Drawing.Point( _
                (MdiParent.ClientRectangle.Width - Me.Width - _
                WIDTH_OF_MENU_STATUS_BARS), MyBase.Location.Y)
        End If

        'If I'm over the bottom boundry, drop back to right against that edge
        If Me.Location.Y + Me.Height > _
            MdiParent.ClientRectangle.Height - HEIGHT_OF_MENU_STATUS_BARS Then
            MyBase.Location = New System.Drawing.Point( _
                MyBase.Location.X, (MdiParent.ClientRectangle.Height - _
                Me.Height - HEIGHT_OF_MENU_STATUS_BARS))
        End If

        'If I'm over the top boundry, drop back to the edge
        If Me.Location.Y < 0 Then
            MyBase.Location = New System.Drawing.Point(MyBase.Location.X, 0)
        End If

        'If I'm over the left boundry, drop back to the edge
        If Me.Location.X < 0 Then
            MyBase.Location = New System.Drawing.Point(0, MyBase.Location.Y)
        End If
    End If
    alreadyMoved = False
End Sub 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T18:31:32.687

澄清一下，您所说的MDI客户端的“桌面”区域就是客户区。

您可以处理子窗体的调整大小/移动事件处理程序，然后在子窗体超出 MDI 客户区范围时调整大小/限制子窗体的移动。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T18:32:15.167

1.  禁用 MDI 窗口滚动条
2.  挂钩所有子窗口的 OnMove 事件。如果窗口移动到边界之外，则沿 x 和 y 将其“弹出”回，直到它回到父级内部。

# c# - 用户控件c#.net中的公共方法

> ID：603419
> 
> 赞同：1
> 
> 时间：2009-03-02T18:26:13.027
> 
> 标签：c#, asp.net, user-controls

如何从页面内调用用户控件的公共方法？

我在页面上的 OnInit 中动态加载控件。有什么想法吗？出于某种原因，我收到一个构建错误，指出该方法不存在，即使它是公开的。开始认为用户控件不值得所有麻烦。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T18:45:15.493

你说过

```
Control fracTemplateCtrl = 
   (FracTemplateCtrl)LoadControl("FracTemplateCtrl.ascx")
fracTemplateCtrl.TestMethod(); 
```

你需要说

```
FracTemplateCtrl fracTemplateCtrl =
   (FracTemplateCtrl)LoadControl("FracTemplateCtrl.ascx")
fracTemplateCtrl.TestMethod(); 
```

请注意，`fracTemplateCtrl is`声明为 a `FracTemplateCtrl`，因此 Visual Studio 知道它具有`TestMethod()`. 当它被声明为 a`Control`时，visual studio 不能做出这个假设。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T18:32:00.377

您是否将用户控件转换为正确的类型？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T18:32:22.327

如果没有示例代码，很难确定，但我猜您需要将对 UserControl 的引用转换为自定义控件的特定类型。例如，如果您的 UserControl 是“PersonControl”类型，那么您的代码将如下所示：

```
PersonControl ctl = (PersonControl)LoadControl("PersonControl.ascx");
ctl.DoCustomMethod(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T18:36:01.927

如果您的类是从 UserControl 继承的，请确保在访问它时，就像其他人所说的那样，您正确地转换了它。例如：

```
public MyControl : UserControl
{
    public void MyMethod(){...}
} 
```

以您的形式：

```
private MyControl mycontrol = new MyControl();
private void MainForm()
{
    this.Controls.Add(mycontrol);

    InitializeComponent();
}

private void DoStuff()
{
    ((MyControl)mycontrol).MyMethod();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T18:42:28.230

Mike 的回答是它是如何完成的，但 Visual Studio 可能对检测 UserControl 类有点怀疑，并抱怨该类型不存在。在这些情况下，我必须`<% @Reference %>`在页面上添加一个标签来强制它识别，即使它可能在 web.config 中被引用。

# flash - 寻找类似 Thinkmap 的引擎

> ID：603430
> 
> 赞同：4
> 
> 时间：2009-03-02T18:30:36.277
> 
> 标签：flash, data-visualization

我试图在闪存上找到一个类似 Thinkmap 的引擎来可视化结构化数据。有人知道免费引擎吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T18:31:53.013

你最好的选择是[耀斑](http://flare.prefuse.org/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-21T21:18:06.577

这里有一个很棒的清单：

[http://www.wikiviz.org/wiki/Tools](http://www.wikiviz.org/wiki/Tools)

这种类型的软件似乎通常被称为“信息可视化”或者也可能是“数据可视化”

从列表中，这似乎是唯一一个特定于 flash 的：

*   [Flare 可视化工具包](http://flare.prefuse.org)：用于创建在 Adob​​e Flash Player 中运行的可视化的 ActionScript 库。免费、开源、BSD 许可证。[演示](http://flare.prefuse.org/demo)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-19T19:56:38.470

[它不是免费的，但我认为使用星座框架http://asterisq.com/products/constellation/framework/implementations](http://asterisq.com/products/constellation/framework/implementations)会更好。

# version-control - 我应该将我的网站媒体保存在我网站的存储库中吗？

> ID：603441
> 
> 赞同：4
> 
> 时间：2009-03-02T18:32:20.953
> 
> 标签：version-control

我有一个使用 Django 用 Python 编写的简单博客应用程序。我使用 Git 对这个网站进行版本控制。该网站的主要内容是博客。博客条目存储在 SQLite 数据库中（*不受*版本控制，但会定期备份）；一些条目包含图像和其他媒体（如 PDF）。

我目前将这个“博客媒体”与其他媒体（例如外部 JavaScript 代码和用于布局目的的图像——当然，所有这些都井井有条）一起存储在存储库中。然而，在我看来，这并不是一个真正的好策略，原因如下：

1.  每当我发布包含图像或 PDF 链接的新博客条目时，我都必须将图像添加到存储库，然后将新版本复制到生产服务器——这似乎需要大量工作才能添加图片。将图像上传到服务器会更容易（当然，还要进行本地备份）。
2.  由于此媒体是*内容*而不是*代码*，因此似乎没有必要将其与代码（和相关样式媒体）本身一起存储。
3.  repo 包含很多二进制文件，这增加了 repo 的整体大小；更重要的是，
4.  我从来没有真正编辑过这些图像，那么为什么要让它们处于版本控制之下呢？

所以我正在考虑从 repo 中删除这些文件，并将它们复制到服务器上的目录之外的目录中，该目录包含网站的 Python 代码、模板、样式表等。

但是，我想知道：是否有“最佳实践”来处理网站存储库中的内容图像和其他媒体，而不是实际用作网站布局和功能的一部分的图像等？

* * *

## 编辑

*详细地说，我发现将网站代码*保存在 repo 和将网站*内容*保存在 repo之间是有区别的——我觉得也许*内容应该与实际提供**功能*的代码分开存储网站（特别是因为内容可能会更频繁地更改，而且我认为不需要为网站本身运行所不需要的“东西”创建新的提交）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T21:40:50.580

将它们保存在版本控制中。如果他们永远不会改变，你就不会为此付出代价。如果它们确实发生了变化，那么事实证明您毕竟需要版本控制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T18:41:20.887

最初，我会说不要将它们放在回购中，因为它们永远不会改变，然后考虑将您的网站移动到不同的服务器或托管服务提供商的情况。您需要一种简单的方法来部署它，除非它不受版本控制，否则很多复制/粘贴可能会出错。至少，如果/当发生某事时，一切都在一次。

这实际上不是一个答案，而是需要考虑的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T22:05:02.083

对它们进行版本化。为什么不？我版本的 PSD 和一切。但如果这让你畏缩，我可以理解。不过，您应该对 javascript 和样式表进行版本控制，这些东西*是*代码（某种意义上的）。

现在，如果按内容，您的意思是“我为博客文章上传的图像”或“我在评论中使用的 pdf 文件”，那么我会说不——不要对它进行版本化。这种内容在数据库或其他地方都有说明。但是，标志图像、精灵和构成网站外观的东西绝对应该进行版本控制。

如果你不相信，我再给你一个敏感的理由。有一天，您会希望您可以回顾您的历史，看看您的网站在 5 年前是什么样子。如果您对外观和感觉的东西进行版本控制，您将能够做到。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T22:34:14.227

你在两点上是完全正确的。

1.  您正在为您的代码使用版本控制。
2.  您正在备份实时内容数据库。

您得出了正确的结论，即“内容图像”就是这样，在您的代码的版本控制中没有任何业务。

将您的内容图像与您的数据库一起备份。您不想模糊两者之间的界限，除非您希望您的“代码”只是您自己的博客站点。

如果你想开始一个完全不同的博客怎么办。或者您的朋友都想要一个。您不会向他们提供包含所有内容的数据库副本。对他们来说，拥有所有内容图像的副本也没有任何用处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T18:41:20.200

移动版本控制系统不能很好地处理二进制文件，也就是说，如果它们没有改变，它就没有（一点）区别。

您只需要决定哪个更容易，将其备份到存储库和添加图像/pdf/其他内容的多步骤过程，或者为它们维护一组单独的操作（包括备份）。就我个人而言，我会将它们保留在版本控制中。如果你不改变它们，它不会伤害任何东西。为什么要担心不会造成伤害的事情？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T22:07:04.387

我认为您需要问自己为什么要使用版本控制以及为什么要进行备份可能是因为您想保护自己免受文件丢失或损坏，并且如果发生可怕的事情，您可以依靠备份.

如果您使用版本控制和单独的备份系统，您会遇到分发问题，因为您的站点的最新版本位于不同的位置。如果确实出现问题怎么办，那么您需要付出多少努力才能恢复？对我来说，拥有一个带有版本控制和备份的分布式系统似乎需要大量的手工工作，而且不容易编写脚本。更重要的是，当出现问题时，你可能已经压力过大了。使恢复过程更加困难可能对您没有多大帮助。

在我看来，将您的静态文件置于版本控制中不会造成任何伤害。您必须将它们放在版本控制存储库或普通文件系统中的某个位置。由于您的静态文件永远不会改变，它们不会随着时间的推移占用更多空间，那么问题是什么？我建议您将所有这些都置于版本控制之下，让自己轻松搞定。就我个人而言，我会定期备份我的数据库，并将此备份提交给版本控制。这样您就可以将所有东西都放在一个地方，并且在发生灾难的情况下，您可以轻松地进行新的结帐/导出以恢复您的站点。

我已经建立[了这个](http://www.sanyo.com.au)网站。它拥有大量 PDF 文件，并且*所有内容*都存储在版本控制之下。如果服务器死了，我所要做的就是一个干净的导出并重新导入数据库和站点，它再次启动并运行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T22:11:34.937

如果您正在处理网络项目，我建议您为您的媒体创建一个虚拟目录。例如，我们在本地工作副本 IIS 中为 /images/ /assets/ 等设置了一个虚拟目录，该目录指向客户可以访问的开发/登台服务器。

这提高了源代码控制的速度（尤其是使用像 Visual Source Safe 这样笨重的东西），如果客户在测试期间更改了某些内容，这会自动反映在我们的本地工作副本中。

# .net - File.Copy 完成后锁定源文件

> ID：603444
> 
> 赞同：22
> 
> 时间：2009-03-02T18:32:34.650
> 
> 标签：.net, file-locking

我们正在尝试将文件从服务器复制到 .NET 2.0 应用程序 (C#) 中的本地计算机，但一直不必要地锁定源文件。我们怀疑是文件服务器上配置的东西导致了这种行为，但不确定是什么......你能帮忙吗？

文件复制操作后，文件服务器 (Windows 2K3 R2) 报告源文件正被读取锁定，即使服务器上的文件没有进一步操作。一旦应用程序退出，锁就会被释放。

即使使用下面看到的最基本的代码，我们也能够重现该行为：

```
static void Main(string[] args)
{
    string sourceFile = @"\\win2K3server\resource\Production\IQE\sourceFolder\iqeconsole.exe";
    string destinationFile = @"d:\destinationFolder\iqeconsole.exe";
    System.IO.File.Copy(sourceFile,destinationFile,true);

    Console.ReadLine();
} 
```

锁定`File.Copy()`在行执行期间立即发生，并在该行完成后持续存在。在更复杂的应用程序中，当带有`File.Copy()`退出的例程（但应用程序仍在运行）时，锁仍然存在。

只有当整个应用程序完成时，锁才会被释放。

更改`sourceFile`为使用映射驱动器而不是 UNC 路径对行为没有影响。

当源文件位于另一台服务器上或位于本地时，不会发生此行为。

如果我们在后面加上下面一行`File.Copy`，锁会立即被释放：

```
new System.Security.Permissions.FileIOPermission(System.Security.Permissions.FileIOPermissionAccess.Read, new string[] { sourceFile }).Demand(); 
```

这对我们来说听起来好像服务器上有什么东西导致了这种行为。我们在服务器上安装了 ShadowProtect 以及 McAfee 防病毒软件。除此之外，似乎在 Windows Server 及其组件之上没有安装其他任何东西。

我们也不确定为什么要求文件的读取权限可以解决问题。

如果您能回答这些问题，我们将不胜感激：

1.  是什么导致文件锁持续存在？
2.  为什么要求读取权限可以解决问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T19:05:21.280

持有锁的可能是 McAfee 按访问扫描程序。如果您只使用读取访问权限，则会绕过它。我相信您可以使用 Sysinternals Process Viewer 工具（Microsoft 免费提供）来确认这一点。

不确定您有哪些 McAfee 订阅，但您可以定义例外规则，使其不扫描此文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T19:23:33.063

我无法在我们的文件服务器上复制它。

但是，我知道机会锁定已禁用，因为我们使用的是 PeerSoftware 的 PeerLock。

# iphone - 找出变量中的最小值？

> ID：603452
> 
> 赞同：0
> 
> 时间：2009-03-02T18:34:19.407
> 
> 标签：iphone, objective-c, variables

我有 4 到 20 个大小不同的变量。它们都是浮点型和数值型。有没有一种简单的方法可以找到其中的最小值并将其分配给变量？谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-02T18:41:19.683

不确定objective-c，但过程类似于：

```
float min = arrayofvalues[0];
foreach( float value in arrayofvalues)
{
    if(value < min)
        min=value;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T18:59:30.750

我同意 Davy8 - 你可以尝试将他的代码重写为 Objective C。

但是，我在 Objective C 中找到了一些类似 min() 的代码！

看这个：

```
- (int) smallestOf: (int) a andOf: (int) b andOf: (int) c
{
     int min = a;
     if ( b < min )
         min = b;

     if( c < min )
         min = c;

     return min;
} 
```

这段代码假定它总是只比较三个变量，但我想这是你可以处理的；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T20:04:13.853

最好的解决方案，没有 foreach。

`- (float)minFromArray:(float *)array size:(int)arrSize

{

```
float min;
int i;

min = array[0]
for(i=1;i<arrSize;i++)
    if(array[i] < min)
        min = array[i];
return min; 
```

} `

如果您想确定，请添加对 arrSize > 0 的检查。

马可

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-02T22:54:04.477

感谢您的所有回答和评论.. 我从你们那里学到了很多:)

我最终使用了马丁建议的东西。

```
if (segmentValueNumber == 11){

    float min = 100000000;      

        if(game51 > 0, game51 < min){
            min=game51;
        }

        if(game52 > 0, game52 < min){
            min=game52;
        }
} 
```

..................................................

我不知道如何将它全部实现到一个数组中，因为每个结果都依赖于一个段控制，而且我认为程序以这种方式更加优化，因为它只检查相关变量。

但再次感谢，你是最有帮助的..

# php - PHP/HTML - isset 函数

> ID：603457
> 
> 赞同：1
> 
> 时间：2009-03-02T18:35:33.927
> 
> 标签：php, html, variables, isset

我对 PHP 还很陌生，正在为我的公司创建一个网站。我正在使用一些我已经获得但似乎无法使其正常工作的现有代码 - 任何帮助将不胜感激！

我有一个变量**$id**，它标识要在页面上显示的产品类别类型。我首先需要检查 id 变量是否已设置，如果没有，则将变量默认为类别 0。

我的代码如下：

```
setdefault($id, 0);

function setdefault(&$var, $default="") 
{
   if (!isset($var)) 
   {
      $var = $default;
   }
} 
```

因此，对于地址 www.website.com/browse.php，我希望它默认为 $id=0; 地址为 www.website.com/browse.php?id=3，我希望它将 $id 设置为 3 并显示相关产品。但是，尽管设置了 $id，它仍然默认为 0。我的代码有什么明显不正确的地方吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T18:40:51.510

您可能期望 PHP 使用 $_POST 和 $_GET 作为全局变量。过去 PHP 曾经以这种方式设置，但较新的版本要求您显式引用这些变量。

你可以试试这个：

```
setdefault($_GET['id'], 0);

function setdefault(&$var, $default="") 
{
   if (!isset($var)) 
   {
      $var = $default;
   }
} 
```

甚至更简单（使用三元运算符）：

```
$id = array_key_exists('id', $_GET) ? $_GET['id'] : 0; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T18:45:46.383

首先，如果这是 PHP 5.XI，强烈建议您不要使用 & 通过引用传递变量。话虽如此。isset 函数调用在函数中将始终为真。但是你会在 setdefault($id, 0); 上收到一个未定义的变量警告。

试试这个。

```
$id = isset($id) ? $id : 0; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T18:50:12.487

如果未设置 $id，则调用 setdefault($id,0) 将生成警告。像 setdefault 这样的函数在 PHP 中不起作用。改用这个。

```
if (!isset($id)) $id = 0; 
```

如果您对数组变量执行此操作，例如 $_GET 和 $_POST，您可以执行以下操作：

```
function getuservar($A, $index, $default = '') {
    if (!isset($A[$index])) return $default;
    if (get_magic_quote_gpc()) return stripslashes($A[$index]);
    return $A[$index];
}

$clean_id = getuservar($_GET, 'id', 0); 
```

这种返回形式更好，因为您立即停止使用 $_GET 数组，而只使用在其余代码中清除的变量。您只需清理一次外部变量，就再也不会在代码中触及外部变量。$A 可以是 $_GET、$_POST、$_REQUEST 或 $_COOKIE。

它还为您处理烦人的 magic_quote 内容，因此您知道变量中的数据是用户发送的文本。只需记住在将其发送回用户或数据库时再次对其进行清理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T18:41:37.797

是如何`$id`设置的？如果`register_globals`关闭（在 PHP 4.2 和更新版本中默认关闭），您需要查看`$_GET['id']`or`$_POST['id']`代替（或`$_REQUEST['id']`，但有理由避免这样做）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T18:47:14.117

还需要包含从查询字符串 ( )中设置`$id`为某个时间的代码。`browse.php?id=3`您可能会想到`register_globals`PHP 的设置，当包含在查询字符串中时会自动创建变量。不要重新启用该功能，几年来这已被证明是一个非常糟糕的主意。

从查询字符串中提取的任何变量都需要在使用之前检查类型/安全性。因此，例如，您可以从`$_GET`超级全局中提取变量，检查它是否为数字，如果不是，则设置默认值：

```
if (!is_numeric($_GET['id']) {
  setdefault($_GET['id'], 0);
} 
```

# eclipse - Eclipse 代码库：有没有可以截取所有着色数据的地方？

> ID：603463
> 
> 赞同：1
> 
> 时间：2009-03-02T18:37:28.650
> 
> 标签：eclipse, color-scheme

我正在考虑为 Eclipse 制作一个简单的全局深色背景切换。

例如**截取所有即将渲染的颜色并替换它们：(R,G,B) -> (255-R, 255-G, 255-B)。**

**你能建议可以在哪里完成的 Eclipse 源代码点吗？**

目前的问题是

*   每个语言颜色对都必须手动修改
*   有垂直条总是白色的

相关问题：

*   [是否有一种简单、一致的方法来更改 Eclipse 编辑器的配色方案？](https://stackoverflow.com/questions/481035/is-there-a-simple-consistent-way-to-change-the-color-scheme-of-eclipse-editors#482828)
*   [日食的深色方案？](https://stackoverflow.com/questions/120621/dark-colorscheme-for-eclipse)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-11T04:37:31.620

空无一人。我曾经探索过为我们为客户创建的基于 Eclipse 的 IDE 制作深色方案。垂直条确实保持白色，其他一些颜色也无法更改。

现在，我必须说，做某事总是有一种晦涩难懂的方式。如果您真的想要，并且需要 Java 编程技能，您可以编写一个 Equinox 适配器挂钩，该挂钩将在 SWT 上运行字节码检测，以拦截所有与颜色相关的调用并通过您的颜色映射器代理它们。（如果您需要帮助，请询问 SO。）

# php - 如何将 jQuery 语句应用于运行时加载的元素？

> ID：603476
> 
> 赞同：1
> 
> 时间：2009-03-02T18:42:43.830
> 
> 标签：php, javascript, jquery, ajax

我有一个带有一个按钮和一个 div 的网页。如果单击此按钮，将使用 jQuery 将另一个按钮加载到 div 中。我发现在运行时加载的新按钮不会受到其他 jQuery 语句的影响。

如何将 jQuery 语句应用于运行时加载的元素？

我希望它很清楚。如果没有，我将尝试举一个例子。

谢谢和最好的问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T18:44:45.167

如果在加载 DIV 之前将事件附加到与动态加载的 DIV 中的某些内容匹配的选择器，则需要使用 jQuery 的[实时](http://docs.jquery.com/Events/live#typefn)功能，以便它知道寻找新内容以附加这些处理程序。如果这不是你的问题，我不确定你在问什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T18:46:38.050

只需在加载新按钮时将事件绑定到它：

$(element).bind("click", function(){ //输入新按钮的代码 })

# php - 为什么我不能将 PHP 类实例存储为 SESSION 变量

> ID：603478
> 
> 赞同：5
> 
> 时间：2009-03-02T18:43:14.237
> 
> 标签：php, class, session, variables, instance

我有一个 PHP 脚本，它通过 Dojo Ajax xhrGet 调用以 2 种方式调用。第一次使用“init”参数调用它，这会导致脚本创建 StateList 类的实例并读入状态名称文件。

```
session_start();
@include('StateList.php');
require_once('phplog.php');

//start executing here
$comd=$_GET['nexturl'];
if($comd=="init") {
$st = new StateList("../data/statestxt.txt");
$_SESSION['statefile'] = $st;
} 
```

第二次和更多次，另一个 xhrGet 调用传递一个“getstate”参数，下面的代码尝试从 SESSION 数组中获取 StateList 类的实例。

```
if($comd =="getstate") {
$st= $_SESSION['statefile'];
phplog("size=".$st->getSize()); 
```

}

但是，永远不会执行 getSize() 方法，也不能在重构的 StateList 类实例上调用任何其他方法。

请注意，这是一个在顶部包含类定义的 PHP 脚本，因此类方法应该是已知且可用的。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-02T18:54:30.870

您需要在调用之前包含类定义`session_start()`，否则该对象将无法正确反序列化，并将成为`__PHP_Incomplete_Class`. 否则你所拥有的应该可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T20:24:56.083

这是难以单独调试的事情之一。在 PHP Sessions 中存储实例化的对象总是有点棘手，并且不能 100% 保证工作。这里有一些通用的调试技巧可以帮助你解决这个问题。

首先，检查您的 apache 错误日志。您是否收到“调用非对象错误的方法”？如果是这样，这意味着您没有从会话中恢复对象。如果没有，是否有错误表明您的方法调用因其他原因而失败？

其次，检查一下你真正从会话中得到了什么。

```
if($comd =="getstate") {
    $st= $_SESSION['statefile'];
    //get the class of st
    phplog("instance=".get_class($st));

    //get a reflection dump of st
    $ref = new ReflectionClass($st);
    $string = $ref->__toString();       
    phplog("reflection=".$string);
} 
```

第三，查看存储在会话本身中的序列化字符串值。您实际上是在存储序列化对象吗？在您的开发环境中，将 php.ini 中的 session.save_path ini 值设置为 /tmp 之类的值，（或使用 ini_set 方法执行相同操作）：

```
session.save_path = "/tmp" 
```

然后检查在 /tmp （或任何文件夹）中创建的文件。您应该看到一个以以下开头的字符串：

```
statefile:O:.......... 
```

实例化对象的类的名称也将包含在其中，以及保存到属性的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T18:52:47.380

您可能需要在存储 $st 对象/变量之前对其进行[序列化。](http://us.php.net/manual/en/function.serialize.php)这将确保所有内容都保存到会话中。这绝对是[面向对象](http://us.php.net/manual/en/language.oop.serialization.php)代码的方式。当您想再次使用数据时，您必须对其进行反[序列化](http://us.php.net/manual/en/function.unserialize.php)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T18:55:34.330

如果要在会话中存储一个对象，它必须是[链接文本](http://www.php.net/manual/en/function.serialize.php "连载的")。在 PHP 中序列化对象存在很多问题，更不用说将它们存储在会话中了。我建议不要完全这样做，并为您的问题找到不同的解决方案。如果你打算这样做，你应该查看你应该在你的类中定义的“魔法方法”[链接文本](http://us.php.net/manual/en/language.oop5.magic.php#language.oop5.magic.sleep "__sleep() 和 __wakeup()")，以便在从会话中调用它时重新实例化它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T18:56:40.693

你`session.auto_start`启用了吗？该手册的会话页面指出，如果这样做，则必须以不同的方式加载类定义：

> 如果您打开 session.auto_start 那么将对象放入会话的唯一方法是使用加载类定义的 auto_prepend_file 加载其类定义，否则您将不得不序列化您的对象并在之后取消序列化它。

[http://php.net/manual/en/intro.session.php](http://php.net/manual/en/intro.session.php)

正如该页面所说，对象的序列化/反序列化通常由 PHP 自动完成，但`session.auto_start`启用会改变这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-29T16:13:28.470

尝试这个：

```
 include('StateList.php');
    require_once('phplog.php');
    // start your session after including your class file
    session_start();

    //start executing here
    $comd=$_GET['nexturl'];
    if($comd=="init") {
    $st = new StateList("../data/statestxt.txt");
    $_SESSION['statefile'] = $st;
    } 

    if($comd =="getstate") {
    // the ampersand creates a reference, preserving any further changes to your session data
    $st = &$_SESSION['statefile'];
    phplog("size=".$st->getSize());
    } 
```

# c# - 使用 c# 检查工作站锁定/解锁更改

> ID：603484
> 
> 赞同：7
> 
> 时间：2009-03-02T18:45:14.183
> 
> 标签：c#, windows, session-state, environment

**重复：** [如何以编程方式确定我的工作站是否被锁定？](https://stackoverflow.com/questions/44980)

当 Windows 用户锁定屏幕 (Windows+L) 并再次解锁时，如何检测（在运行时）。我知道我可以全局跟踪键盘输入，但是可以用环境变量检查这样的事情吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-02T18:55:12.117

SessionSwitch事件可能是您最好的选择[。](http://msdn.microsoft.com/en-us/library/microsoft.win32.sessionswitcheventhandler.aspx)检查通过[SessionSwitchEventArgs](http://msdn.microsoft.com/en-us/library/microsoft.win32.sessionswitchreason.aspx)传递的[SessionSwitchReason](http://msdn.microsoft.com/en-us/library/microsoft.win32.sessionswitcheventargs.aspx)以找出它是什么类型的开关并做出适当的反应。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T18:58:14.807

您可以通过 WM_WTSSESSION_CHANGE 消息获得此通知。您必须通知 Windows 您希望通过 WTSRegisterSessionNotification 接收这些消息并取消注册 WTSUnRegisterSessionNotification。

这些帖子应该有助于 C# 实现。

[http://pinvoke.net/default.aspx/wtsapi32.WTSRegisterSessionNotification](http://pinvoke.net/default.aspx/wtsapi32.WTSRegisterSessionNotification)

[http://blogs.msdn.com/shawnfa/archive/2005/05/17/418891.aspx](http://blogs.msdn.com/shawnfa/archive/2005/05/17/418891.aspx)

[http://bytes.com/groups/net-c/276963-trapping-when-workstation-locked](http://bytes.com/groups/net-c/276963-trapping-when-workstation-locked)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-19T22:21:26.080

**您可以使用`ComponentDispatcher`**另一种方法来获取这些事件。

这是一个包装它的示例类。

```
public class Win32Session
{
    private const int NOTIFY_FOR_THIS_SESSION = 0;
    private const int WM_WTSSESSION_CHANGE = 0x2b1;
    private const int WTS_SESSION_LOCK = 0x7;
    private const int WTS_SESSION_UNLOCK = 0x8;

    public event EventHandler MachineLocked;
    public event EventHandler MachineUnlocked;

    public Win32Session()
    {
        ComponentDispatcher.ThreadFilterMessage += ComponentDispatcher_ThreadFilterMessage;
    }

    void ComponentDispatcher_ThreadFilterMessage(ref MSG msg, ref bool handled)
    {
        if (msg.message == WM_WTSSESSION_CHANGE)
        {
            int value = msg.wParam.ToInt32();
            if (value == WTS_SESSION_LOCK)
            {
                OnMachineLocked(EventArgs.Empty);
            }
            else if (value == WTS_SESSION_UNLOCK)
            {
                OnMachineUnlocked(EventArgs.Empty);
            }
        }
    }

    protected virtual void OnMachineLocked(EventArgs e)
    {
        EventHandler temp = MachineLocked;
        if (temp != null)
        {
            temp(this, e);
        }
    }

    protected virtual void OnMachineUnlocked(EventArgs e)
    {
        EventHandler temp = MachineUnlocked;
        if (temp != null)
        {
            temp(this, e);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-03-02T19:54:48.900

您绝对不需要 WM_WTSSESSION_CHANGE 只需使用内部 WTTS api。

# html - Firefox 中的长页面被截断

> ID：603492
> 
> 赞同：1
> 
> 时间：2009-03-02T18:46:41.527
> 
> 标签：html, firefox

我网站上的一个页面非常高。它的大小不到 200KB，但它是一系列需要大量垂直空间的表格。在大约 40 个屏幕（大约是网页总滚动高度的 1/4）之后，它停止了绘制：上面的一切看起来都很好，下面的一切都是纯白色背景——除了页脚（在不同的 div 中，我猜测），它在最底部显示得很好。

我在办公室里问过，其他人以前也看到过，但不知道是什么原因造成的。我们当然还有其他页面同样高，没有问题。我已经看到页面渲染得很好，但要长得多。这根本不是一个复杂的文档——一些嵌套的 div，一些表格（4 或 5 列，每列几百行），一些 CSS。

该页面在 IE7 和 Chrome 中都表现出色。只有 Firefox 3 可以做到这一点。

关于导致这种情况的任何线索？还是解决方法？我什至不知道在这里谷歌搜索什么。

编辑：我在另一个完全不相关的页面上看到了这个。在这两种情况下，它都会在距离顶部约 33000 像素处切断——哈哈。我知道 FF3 可以有比这更长的 div 和表格。有人知道他们可能会使用 16 位大小/坐标来做什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T20:33:13.957

听起来这可能与[Firefox Bug 215055](http://bugzilla.mozilla.org/show_bug.cgi?id=215055)或[Firefox Bug 333994 有关](http://bugzilla.mozilla.org/show_bug.cgi?id=333994)。检查这些。如果确实相关，您可以随时将您的测试用例附加到这些错误之一，并将您的评论添加到错误中。

我还建议，像 zodeus 一样，尝试夜间构建或 3.1 的测试版。如果它在那里被修复，那并不意味着你强迫你的客户升级，但至少你知道它在未来的构建中被修复，你可以为 Mozilla.org 发起活动，以将修复恢复到你可能得到的更当前的构建人升级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T18:49:03.020

尝试下载 Fire Fox 3.1 Beta 或 Nightly Build。他们重新设计了很多内部结构。如果它在那里工作，那么我会说这是一个已报告并已修复的 FF3.0 错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T18:51:20.317

[在 Bugzilla 中提交的这个](https://bugzilla.mozilla.org/show_bug.cgi?id=418600)错误可能与...

# javascript - JavaScript 对象方法链：有用吗？

> ID：603499
> 
> 赞同：18
> 
> 时间：2009-03-02T18:48:41.553
> 
> 标签：javascript, object, method-chaining

所以......在 JavaScript 中搞砸了一个对我来说很新的想法，让 Object 的方法返回它们是方法的 Object；这会导致可链接性。那么我的问题是：这有什么用？我把它放在一起来测试基本的工作原理：

```
<script>
MathChain = function()
 {
    this.pass = function()
     {
        this.multiply = eval(arguments.join('*'));
        this.add = eval(arguments.join('+'));
        return this;
     }
 }

m = new MathChain().pass(5, 10, 20).multiply; // 1000
a = new MathChain().pass(5, 10, 20).add;      // 35
</script> 
```

这显然不是一个使用这个概念的恶性有效的例子，所以你能指出我做的正确的事情吗（除了jQuery，请）？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-02T18:57:03.437

好吧，这是一个不太现实的适用示例，但我想你会明白的。If 允许你对一个对象做许多不同的操作，并且提供了方便。

```
var truck = function() {

    this.turnLeft = function {

       // turn left
       return this;

    }

    this.turnRight = function {

       // turn right
       return this;

    }

    this.goReallyFast = function {

       // go fast!
       return this;

    }

};

// My get-away plan
var myTruck = new truck();
myTruck.turnLeft().turnRight().goReallyFast(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-02T19:00:02.417

流畅的界面 - [http://en.wikipedia.org/wiki/Fluent_interface](http://en.wikipedia.org/wiki/Fluent_interface)

是的，我认为它可能非常有用，但就像任何设计模式一样，只应在需要时使用

编辑：这是使用流畅界面的 c# 中的 twitter 客户端 api - [http://code.google.com/p/tweetsharp/](http://code.google.com/p/tweetsharp/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-02T19:05:36.553

对于一个非常不同的（非 OO）示例，链接有点类似于[Unix 管道](http://en.wikipedia.org/wiki/Pipeline_(Unix))。Unix 管道的每一步都返回完整的（修改后的）内容，适合发送到下一步：

```
cat file1 file2 | sort -n | awk '{print $2}' | sed 's/@/ at /g' 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-02T19:06:52.527

一个有用的示例是对您的问题稍作改动——您不是返回相同的对象，而是将对象设计为*不可变*的。然后，您的函数将全部返回相同类型的*新实例*，但属性已正确设置。

这有很多实际应用，特别是在函数式编程领域。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-02T19:42:08.523

虽然它的工作方式与您的示例不同（TBH，我以前从未见过这样做过），但[jquery 认为“链接”非常有用](http://ejohn.org/blog/ultra-chaining-with-jquery/)，而 jquery 几乎是这些天的衡量标准JS web 框架......所以是的:-)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-04-03T20:39:52.223

在定义方法后，我在寻找使方法可链接的通用解决方案时发现了这个问题。这就是我想出的。我是 JavaScript 新手；买家小心。

```
makeChainable = function() {
    var receiver = arguments[0]
    for (var i = 1; i < arguments.length; i++) {
        functionName = arguments[i];
        (function() {
            wrapped = receiver[functionName];
            receiver[functionName] = function() {
                wrapped.apply(receiver, arguments);
                return receiver;
            }
        })();
    }
}

daisy = {
    name: 'Daisy',
    moo:  function() { console.log(this.name + " moos!") }
}

makeChainable(daisy, 'moo');
daisy.moo().moo().moo(); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T19:16:34.607

在 JavaScript 中，这在导航 DOM 时总是会出现。尤其是在尝试通过一堆没有 ID 的元素时。

例如，关于[查找 table 的第一个元素的](https://stackoverflow.com/questions/563201/read-a-specific-table-column-with-prototype)问题。它可能涉及很多循环或链式命令。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-08T18:35:46.243

如果您想对单个对象执行一系列操作，JavaScript 链接可能非常有用。我同意下面的 Michael Luton 的观点，应该小心处理链接。如果您将一两个链式方法添加到仍然可读的对象上。如果您开始添加 4 个、5 个甚至 9 个，那么您的代码不仅难以阅读，而且难以维护。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-04-08T00:37:10.100

所有的孩子都喜欢链子。但是，根据我的经验，应该小心使用它，因为它会降低代码的可读性。换句话说，做对你有意义的事情，并且其他对这个概念有基本了解的程序员可以很容易地理解。

# c# - 使用复杂类型的设置

> ID：603501
> 
> 赞同：9
> 
> 时间：2009-03-02T18:49:14.033
> 
> 标签：c#, configuration, settings

我在我的 .NET 项目中使用 Settings 类。我在编辑器中注意到，只有某些类型可用作设置类中各个属性的类型。例如，如果我想拥有一个来自我的代码或通用集合的枚举属性怎么办？我将如何实施？

我猜我可以使用部分类机制在单独的文件中执行此操作（因为设置已被定义为部分类）但我想看看是否有人同意这一点，以及是否有办法在其中做到这一点编辑。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-03T00:28:32.487

创建一个新的“设置”文件以添加复杂/用户定义的选择类型。这是枚举的操作方法。

**步骤 1**。创建设置文件

![替代文字](https://farm4.static.flickr.com/3140/3324457564_689b373e20.jpg)

**步骤 2**。浏览类型

![替代文字](https://farm4.static.flickr.com/3618/3323618375_b015356e9a.jpg)

**步骤 3**。选择类型（命名空间.TypeName）

![替代文字](https://farm4.static.flickr.com/3565/3324457700_114d139ef1.jpg)

**第 4 步**。达达 - 完成

![替代文字](https://farm4.static.flickr.com/3561/3323618259_31314cb9a9.jpg)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-23T18:30:15.803

要让自定义类显示在该列表中，请确保它具有默认构造函数作为其构造选项之一。我经过惨痛的教训才学到这个

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-12-23T23:09:11.477

要回答 Jeffrey 关于在设置文件中是否可以使用通用列表的评论/问题，答案是肯定的。您只需手动编辑设置 xml 文件。例如，如果我有以下课程：

```
public class UrlAlias
{
    public string Name { get; set; }
    public string BaseUrl { get; set; }
} 
```

我可以通过右键单击我的设置文件并选择打开方式来创建这些列表。

然后选择 XML / Text Editor，并将“Type”值设置为完全限定的类名，即：

```
Type="System.Collections.Generic.List`1[MyProject.SomeNamespace.UrlAlias]" 
```

完整的设置 xml 如下所示：

```
<?xml version='1.0' encoding='utf-8'?>
<SettingsFile xmlns="http://schemas.microsoft.com/VisualStudio/2004/01/settings" CurrentProfile="(Default)" GeneratedClassNamespace="MyProject.Properties" GeneratedClassName="Settings">
 <Profiles />
  <Settings>
    <Setting Name="UrlAliases" Type="System.Collections.Generic.List`1[CommonAddin.Data.DataSource.UrlAlias]" Scope="User">
      <Value Profile="(Default)"></Value>
    </Setting>
  </Settings>
</SettingsFile> 
```

完成此操作后，您应该拥有您创建的自定义设置对象的正确配置列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T18:54:49.887

作为部分类的一部分在单独的文件中执行此操作是完全可以接受的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T18:55:11.977

如果您希望能够通过配置文件填充复杂的对象，我建议使用一些依赖注入框架 sa Spring.Net。

# sql-server - 将表复制到不同 SQL Server 上的不同数据库

> ID：603502
> 
> 赞同：37
> 
> 时间：2009-03-02T18:49:26.047
> 
> 标签：sql-server

我想将一个表从一个数据库复制到另一个。我知道如果数据库在同一个 SQL Server 上，您可以轻松地执行以下操作。

```
SELECT * INTO NewTable FROM existingdb.dbo.existingtable; 
```

如果数据库位于两个不同的 SQL Server 上，是否有任何简单的方法可以做到这一点，而不必遍历原始表中的每条记录并将其插入到新表中？

此外，这需要在 SQL Server Management Studio 之外的代码中完成。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-03-02T18:53:07.893

是的。添加一个**[链接服务器](http://technet.microsoft.com/en-us/library/ms190479.aspx)**条目，并使用 select into 使用四部分数据库对象命名约定。

例子：

```
SELECT * INTO targetTable 
FROM [sourceserver].[sourcedatabase].[dbo].[sourceTable] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-16T09:00:39.750

如果它只是复制表，那么链接服务器将可以正常工作或创建脚本，但如果辅助表已经包含一些数据，那么我建议使用一些第三方比较工具。

我正在使用[Apex Diff](http://www.apexsql.com/sql_tools_diff.aspx)，但也有很多其他工具，例如 Red Gate 或 Dev Art 的工具......

当然，第三方工具不是必需的，您可以在本地完成所有操作，这更方便。即使您的预算紧张，您也可以在试用模式下使用这些来完成任务……。

[这](https://stackoverflow.com/questions/187770/copy-tables-from-one-database-to-another-in-sql-server)是一个关于类似主题的好帖子，其中有更多关于如何在纯 sql 中执行此操作的示例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-10-10T08:21:59.597

SQL Server(2012) 提供了另一种为 SQL Server 数据库及其对象和数据生成脚本的方法。在我们的例子中，此脚本可用于将表的模式和数据从源数据库复制到目标数据库。

1.  使用 SQL Server Management Studio，从对象资源管理器中右键单击源数据库，然后从 Tasks 中选择 Generate Scripts。 [![在此处输入图像描述](https://i.stack.imgur.com/C0SdS.png)](https://i.stack.imgur.com/C0SdS.png)
2.  在选择对象窗口中，选择选择特定数据库对象以指定您将为其生成脚本的表，然后通过在每个表旁边打勾来选择这些表。点击下一步。 [![在此处输入图像描述](https://i.stack.imgur.com/CW5Dx.png)](https://i.stack.imgur.com/CW5Dx.png)
3.  在“设置脚本选项”窗口中，指定保存生成的脚本文件的路径，然后单击“高级”。 [![在此处输入图像描述](https://i.stack.imgur.com/oLFPM.png)](https://i.stack.imgur.com/oLFPM.png)
4.  从出现的 Advanced Scripting Options 窗口中，将 Schema 和 Data 指定为要编写脚本的数据类型。您可以从这里决定是否要为表中的索引和键编写脚本。单击确定。 [![在此处输入图像描述](https://i.stack.imgur.com/KKwcu.png)](https://i.stack.imgur.com/KKwcu.png) 返回“高级脚本选项”窗口，单击“下一步”。
5.  查看摘要窗口并单击下一步。 [![在此处输入图像描述](https://i.stack.imgur.com/Vtabs.png)](https://i.stack.imgur.com/Vtabs.png)
6.  您可以从“保存或发布脚本”窗口监控进度。如果没有错误单击完成，您将在指定路径中找到脚本文件。 [![在此处输入图像描述](https://i.stack.imgur.com/TMJdh.png)](https://i.stack.imgur.com/TMJdh.png)

SQL 脚本方法对于为表的模式和数据（包括索引和键）生成一个脚本很有用。但同样，如果表之间存在关系，则此方法不会以正确的顺序生成表的创建脚本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T18:52:37.020

Microsoft SQL Server 数据库发布向导将生成所有必要的插入语句，如果您需要，还可以选择架构信息：

[http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A](http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-02T18:53:13.370

生成脚本？

生成一个脚本来创建表，然后生成一个脚本来插入数据。

签出[SP_Genereate_Inserts](http://vyaskn.tripod.com/code/generate_inserts.txt)以生成数据插入脚本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-12T14:43:33.493

创建数据库，使用 Script Database as... CREATE To

在源服务器上的 SSMS 中，使用导出向导并将目标服务器数据库作为目标。

*   源实例 > YourDatabase > 任务 > 导出数据
*   数据源 = SQL Server Native Client
    *   验证/输入服务器和数据库
*   目标 = SQL Server Native Client
    *   验证/输入服务器和数据库
*   跟随向导

# oracle - 如何将 SYS_GUID() 转换为 varchar？

> ID：603504
> 
> 赞同：15
> 
> 时间：2009-03-02T18:49:35.220
> 
> 标签：oracle, guid

在 oracle 10g 中，如何将 SYS_GUID() 转换为 varchar？我正在尝试类似的东西：

```
select USER_GUID from user where email = 'user@example.com' 
```

它返回 RAW 字节 []。是否可以在 SQL 语句中使用函数将 RAW 转换为 VARCHAR2？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-02T18:55:44.940

`HEXTORAW(varchar2)`将此值与`RAW`列进行比较时不要忘记使用。

`VARCHAR2`从到没有隐式转换`RAW`。这意味着该子句：

```
WHERE raw_column = :varchar_value 
```

将被隐式转换为：

```
WHERE RAWTOHEX(raw_column) = :varchar_value 
```

，从而使索引`raw_column`不可用。

采用：

```
WHERE raw_column = HEXTORAW(:varchar_value) 
```

反而。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T18:51:15.793

使用 RAWTOHEX(USER_GUID)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-03-04T01:06:45.853

```
select RAWTOHEX(USER_GUID) from user where email = 'user@example.com' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T19:00:51.243

如果我错了，请不要 mod-1。我从记忆中去，所以这是一个免责声明来验证。

TO_CHAR 在 SQL 和 PL/SQL 之间实际上是不同的。

如您所见，在 SQL TO_CHAR 中不会采用原始​​数据。

在 PL/SQL 中 To_CHAR 将采用原始值。

因此，无论如何，如果您在一个过程中，有时使用变量会更容易，但如果您只是使用 SQL，请在此处使用其他答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-26T21:32:42.763

`select CAST (USER_GUID AS VARCHAR2(100)) from user where email = 'user@example.com'`

# c# - Sql Server 2005 上的 CLR 代码问题

> ID：603515
> 
> 赞同：0
> 
> 时间：2009-03-02T18:51:57.147
> 
> 标签：c#, sql-server, sql-server-2005, sqlclr

我正在考虑从 Sql Server 2005 中的 UDF 访问一些 CLR 代码。

我听说过 CLR 代码中抛出的未处理异常会导致服务器瘫痪的故事。

显然我的函数将包含一个 try-catch 块。但是，某些异常（stackoverflow）可以跳过捕获。

有没有人有一套指导方针可以完全消除（或最小化）我的 CLR 代码导致服务器崩溃的风险。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T19:31:07.287

未处理的异常对 SQL Server 有不利影响，但不利的程度取决于引发的异常的严重性。

一般来说，您使用受约束的执行区域来指示一段代码在失败时可能会影响的范围（进程、应用程序域、线程等）。SQL Server 使用它来确定是否只是中止当前查询/请求，或者在出现更严重错误的情况下进一步处理。

MSDN 杂志上有一篇很好的文章谈到了 CER，以及 SQL Server 如何利用它们：

[http://msdn.microsoft.com/en-us/magazine/cc163716.aspx#](http://msdn.microsoft.com/en-us/magazine/cc163716.aspx#)

此外，这里列出了专门针对为 SQL Server 开发 CLR 代码的最佳实践：

[http://msdn.microsoft.com/en-us/library/ms228970.aspx#](http://msdn.microsoft.com/en-us/library/ms228970.aspx#)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-02T19:02:44.313

代码有什么作用？

我建议您考虑通过在不首先使用 CLR 的情况下实现目标来完全避免风险，而不是使用您知道很可能会增加耦合和复杂性并且完全不可移植的技术。但如果我不知道问题出在哪里，或者您是否真的需要 CLR，我不能推荐任何东西。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-02T19:32:02.497

CLR 代码中未捕获的异常不会关闭服务器。CLR 代码在单独的应用程序域中运行，并且是隔离的。最可能发生的（这不太可能）是异常会关闭应用程序域，并导致应用程序域被卸载。这将使其a）在下一个请求时重新加载，或b）在问题得到解决或部署新版本的程序集之前被禁用。

所以至多那个特定的 CLR 程序集会被禁用，调用会话会收到错误消息。错误的 CLR 代码极不可能导致整个 sql server 实例崩溃；如果是这样，我会说这是微软的错误，而不是 CLR 函数或存储过程中的错误。

极有可能的情况是未捕获的 .net 异常将被转换为 tsql 错误消息。最多，tsql 连接会被终止；很可能会导致错误消息。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-02T19:15:55.030

我强烈建议抑制使用 CLR 函数进行并行查询的能力。您的里程可能会有所不同，但我发现这消除了我的一些 SQL 引擎错误。

[http://msdn.microsoft.com/en-us/library/ms181714.aspx](http://msdn.microsoft.com/en-us/library/ms181714.aspx)

```
WITH( MAXDOP 1) 
```

# apache-flex - 尝试在 Flex 3 中设置中断时解析错误

> ID：603521
> 
> 赞同：1
> 
> 时间：2009-03-02T18:53:27.253
> 
> 标签：apache-flex, http, actionscript

我一直在尝试在我的 Flex 3 项目中设置 HTTP 中断，但没有成功。显然，我对编程一无所知，而且我没有很多参考资料。当我尝试导出项目时，我收到结果处理程序和 var 错误字符串的解析错误。我附上了我放置中断的代码片段。

```
<mx:HTTPService id="getData" url="http://www.myurl.com"

useProxy="false" method="GET" resultFormat="text" resultType="text" 
         result="resultHandler(event)" fault="faultHandler(event)">

private function resultHandler(e:ResultEvent):void {
        trace(e.result); 
}

private function resultHandler(e:FaultEvent):void {
        var faultstring:String = event.fault.faultString; 
        Alert.show(faultstring); 
}

<mx:request xmlns="">
  <getTutorials>"true"</getTutorials>

</mx:request> 
```

我认为这可能与 PHP 文件和 Flex 正在寻找的数据类型有关？这是我在浏览器中收到的第一个错误。

TypeError：错误＃1034：类型强制失败：无法转换“[{“id”：“2”，“name”：“无肩带婚纱技巧”，“作者”：“Ramona Waters”，“rating”：“0” },{"id":"3","name":"协调你的新娘女仆","author":"Ericka Brown","rating":"0"}]" 到 mx.controls.Alert。在 DressBuilder2/resultHandler() 在 DressBuilder2/__getData_result() 在 flash.events::EventDispatcher/dispatchEventFunction() 在 flash.events::EventDispatcher/dispatchEvent()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T19:01:28.887

**更新：**酷，你的代码已经编译好了！尝试以下方法：

*   `resultFormat=array`如果你有一个`array`对象，则设置。在数组中获取此值并循环查看是否可以看到这些项目。如果这不起作用，请尝试下一个提示。
*   从 HTTPService 标记中删除`resultFormat`（与将其设置为 相同`object`）。看到[这个](http://livedocs.adobe.com/flex/3/langref/mx/rpc/http/HTTPService.html#resultFormat)。

AS 中的函数通常位于`<mx:Script>`标签内。这是首先要解决的问题。您还必须导入您正在使用的类的定义。看看这里：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" 
                layout="absolute" width="535" height="345"
                creationComplete="getData.send()">
<mx:Script>
  <![CDATA[
 import mx.rpc.events.FaultEvent;
 import mx.rpc.events.ResultEvent;
 import mx.controls.Alert;
     import mx.rpc.http.HTTPService;

 private function resultHandler(e:ResultEvent):void {
    Alert(e.result.toString());
 }
 private function faultHandler(e:FaultEvent):void {
    Alert(e.fault.toString());
 }
  ]]>
 </mx:Script>
<mx:HTTPService id="getData" resultFormat="text" 
                fault="faultHandler(event)" result="resultHandler(event)"   
                url="http://www.myurl.com"/>
</mx:Application> 
```

尝试使用这个 MXML 文件，让我们知道你已经走了多远。

# python - 使用 PyQT，如何为带有自定义列表的 QComboBox 过滤 mousePressEvent

> ID：603528
> 
> 赞同：2
> 
> 时间：2009-03-02T18:55:19.090
> 
> 标签：python, qt, qt4, pyqt, qcombobox

我有`QComboBox`一个自定义列表对象。

![截屏。](https://i.stack.imgur.com/r71L2.png)

自定义列表对象具有自定义`mousePressEvent`功能，因此当用户单击带有 +/-（曲折）的圆圈之一时，列表会展开/折叠。

当我将列表与组合框一起使用时，当用户单击扭曲时，列表会展开/折叠，但选择会更改，并且列表会隐藏。我怎样才能过滤这个，以便当用户点击一个曲折时，选择不会改变，列表不会隐藏。

## 附加屏幕截图

所有节点都崩溃了： ![所有节点都崩溃了。](https://i.stack.imgur.com/tz1Qs.png)

列表隐藏： ![隐藏列表的屏幕截图。](https://i.stack.imgur.com/sJFuw.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T23:32:48.373

QT 有一个`eventFilter`“捕获” `QEvent.MouseButtonRelease`。所以我所做的是安装我自己的，如果用户点击一个节点`eventFilter`，它会过滤事件。`QEvent.MouseButtonRelease`

在我的列表对象中，我有以下方法：

```
def mousePressEvent (self, e):
    self.colapse_expand_click = False
    if <user clicked node>:
        colapse_expand_node()
        e.accept ()
        self.colapse_expand_click = True 
```

之前的`mousePressEvent`运行`mouseReleaseEvent`。

然后在自定义组合框中，过滤事件：

```
class RevisionSelectorWidget(QtGui.QComboBox):
    def __init__(self, parent = None):
        QtGui.QComboBox.__init__(self, parent)

        self.log_list = RevisionSelectorLogList(self)
        self.setView(self.log_list)
        self.log_list.installEventFilter(self)
        self.log_list.viewport().installEventFilter(self)

    def eventFilter(self, object, event):
        if event.type() == QtCore.QEvent.MouseButtonRelease:
            if self.log_list.colapse_expand_click:
                return True
        return False 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T05:55:00.970

在我的脑海中，您可以继承`QComboBox`和覆盖`hideEvent(QHideEvent)`（继承自`QWidget`）

```
def hideEvent(self, event):
  if self.OkToHide():
    event.accept()
  else:
    event.ignore() 
```

您的屏幕截图看起来像是对组合框的有趣使用，我很好奇您为什么没有使用`TreeView`样式控件而不是列表？

**编辑（2009 年 3 月 14 日）：**

我查看了 Qt 源代码，看起来当键盘和鼠标事件被捕获时，一旦 qt 决定发出`"activated(int index)"`信号，就会`"hidePopup()"`被调用。

因此，除了重写他们的事件过滤器代码之外，另一种选择是将`"activated(int index)"`or`"highlighted(int index)"`信号连接到可以调用的插槽，该插槽`"showPopup()"`将重新引发列表项。如果您遇到令人讨厌的消失/出现绘制问题，您可能必须让 Qt 在弹出窗口可见时延迟绘制事件。

希望有帮助！

# activemq - 如何删除 ActiveMQ 中的所有主题？

> ID：603542
> 
> 赞同：7
> 
> 时间：2009-03-02T18:59:49.173
> 
> 标签：activemq

我将 ActiveMQ 与 C# 客户端库一起使用。作为评估目的的测试的一部分，我创建了 10,000 个随机名称的主题，现在我无法摆脱这些主题。ActiveMQ 因如此多的主题而陷入停顿，因此我需要将它们排除在系统之外。到目前为止，这是我尝试过的，但都没有奏效。我将 ActiveMQ 作为 Windows 服务运行。

*   删除 ACTIVEMQ_HOME\Data 中的所有文件和文件夹
*   关闭所有持久性
*   删除持久性文件夹中的所有文件和文件夹
*   删除整个 ACTIVEMQ_HOME 目录并将其重新安装到不同的文件夹中

我跟踪了文件活动，找不到在创建或删除主题时写入的任何文件。

我意识到 .NET 客户端库对功能有点轻，所以我什至无法以编程方式获得所有主题的列表。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-13T21:34:15.487

转到您的代理配置文件，在代理元素上打开文件进行编辑，添加以下属性：

```
deleteAllMessagesOnStartup="true" 
```

当您重新启动代理时，这将导致所有先前的主题和队列以及它们的待处理消息从您的 kaha 存储中删除。

玩得开心！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-07-29T11:40:35.743

这个问题可能很老了，但是一个快速而简单的方法来完全清除 ActiveMQ 中的所有数据以及所有队列和主题是转到以下路径：

```
<ActiveMQ_Installation_Directory>/data 
```

并删除其中的所有文件。

现在，一旦您重新启动 AMQ，它将以全新的、干净的安装方式启动。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-08-12T12:14:19.403

如果您将您的 activemq 版本升级到 5.8.0，您可以使用 REST API 来管理代理。但在 5.7.0 或更早的版本中，管理界面只能通过 java 环境下的 JMX 访问。

# nhibernate - NHibernate 映射问题

> ID：603544
> 
> 赞同：2
> 
> 时间：2009-03-02T19:00:47.470
> 
> 标签：nhibernate, mapping, one-to-many

我有以下对象模型：

*   `Element`一个有很多孩子和后代的顶级抽象类。
*   一个班`Event`。
*   每个都`Element`包含一袋`Event`s。
*   每个`Event`都有一个指向 parent 的指针`Element`。

到目前为止 - 相当标准的一对多关系。

但是，我想根据具体的类策略使用表。因此，该类`Element`未映射到数据库。我试图以这种方式解决它：每个具体的后代都`Element`定义了自己的 Bag of `Event`s。这样做的问题是每个`<bag>`元素都包含一个`<key>`元素。该关键点指向 的`Parent`属性`Event`。它还使s 表`Parent`中的列成为`Event`包含 Bag 的表的外键！但是一列不能是多个表的外键，我在插入时遇到异常。

我还尝试使s 表`Parent`中的字段`Event`成为多对任意类型的字段。那行得通。但是当我想使关系双向时，意味着将包添加到我的后代中，`Element`我又回到了同样的问题。包 => 外键 => 插入异常。

我确信这个案例并不像看起来那么独特。预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T08:26:24.360

有点晚了，但我有一些建议。

如果您使用“每个具体类的表”，就好像您将映射完全独立的表。因此，您需要单独的外键或多对任意键。

多对任意存储类型名称，NH 知道外键指向的位置。但是不可能对这样的外键进行限制。

如果您有多个包含相同类型物品的包，请确保它们都定义了不同的外键：

```
<class name="A">
  <!-- ... -->
  <bag name="Events">
    <key column="A_FK"/>
    <one-to-many class="Event"/>
   </bag>
</class>

<class name="B">
  <!-- ... -->
  <bag name="Events">
    <key column="B_FK"/>
    <one-to-many class="Event"/>
   </bag>
</class> 
```

您可以对这样的外键进行外键约束，但不能有非空约束，因为只使用了这些外键之一。

要真正只有一个具有所有约束的外键，您需要将元素映射到单独的表。

# java - 我应该如何在 Java 中调用 Perl 脚本？

> ID：603554
> 
> 赞同：8
> 
> 时间：2009-03-02T19:03:40.613
> 
> 标签：java, perl

我阅读`Runtime.getRuntime().exec("perl script.pl")`是一种选择，但这是最好的方法吗？

我需要那个脚本的答案，所以在某些情况下我必须阅读脚本的返回，尽管在其他情况下我可能会从文本文件中读取它。

无论如何，是`exec()`从 Java 调用 Perl 脚本的好方法吗？我应该注意，我正在开发一个 Java Web 应用程序，所以这里的安全性是一个问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-02T19:22:39.960

您可以使用或使用[Process API](http://docs.oracle.com/javase/6/docs/api/java/lang/Process.html)。Process API 允许您获取脚本的输出，因此您可以同时进行通信。[`Runtime`](http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html)[`.getRuntime()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html#getRuntime%28%29)[`.exec()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html#exec%28java.lang.String%29)

[`exitValue()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Process.html#exitValue%28%29)[`getInputStream()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Process.html#getInputStream%28%29)似乎是你需要的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T19:19:44.523

这概述了如何相当优雅地做到这一点，尽管它可能比它的价值更多的努力： [http ://search.cpan.org/~nwclark/perl-5.8.9/jpl/docs/Tutorial.pod](http://search.cpan.org/~nwclark/perl-5.8.9/jpl/docs/Tutorial.pod)

概述：
得到 JPL 的良好支持，但这是一个复杂的过程：

JPL 预处理器解析 .jpl 文件并为 Perl 方法生成 C 代码包装器。它还生成 Java 和 Perl 源文件。

C 编译器编译包装器并将其链接到 libPerlInterpreter.so 共享库，为包装器生成共享库。

Java 编译器编译 Java 源文件，该文件使用本机方法加载包装器。

包装器将 Java 代码连接到 Perl 源文件中的 Perl 代码。

幸运的是，通用 Makefile.PL 简化了该过程。这是一个为您生成 Makefile 的 Perl 脚本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T19:06:56.473

exec() 可能是最好的选择，您可以使用[exitValue()](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Process.html#exitValue())捕获它的返回值。您可能还对[Inline::Java](http://search.cpan.org/dist/Inline-Java/Java.pod)感兴趣。

-约翰

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-10T11:00:26.500

请记住，无论 Perl 脚本创建什么文件，它都是在 Java 工作文件夹中创建的。只需将该文件称为“./myPerlCreatedFile.ext”

# javascript - 如何通过 JavaScript 在锚标记中导航 href

> ID：603556
> 
> 赞同：8
> 
> 时间：2009-03-02T19:05:15.180
> 
> 标签：javascript, jquery

有没有一种简单的方法可以让 JavaScript 模仿用户单击页面上的锚标记？这意味着需要设置引荐来源网址。仅设置 document.location.href 不会设置 Referrer Url。

```
<script>
  $(document).ready(function () {
    $("a").click();
});
</script>

<a href="http://example.com">Go here</a> 
```

这不起作用，因为没有为链接设置 Click() 事件。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-02T19:07:16.580

你可以这样做：

```
window.location = $("a").attr("href"); 
```

如果你想保留推荐人，你可以这样做：

```
var href = $('a').attr('href');
$('<form>').attr({action: href, method: 'GET'}).appendTo($('body')).submit(); 
```

这是hackish，但适用于所有浏览器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-13T16:25:07.677

```
document.location.href = "#wanted_Location"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T19:08:18.747

也许这样的东西是你正在寻找的？

```
$(document).ready(function () {
  $("a").each(function(){
    if($(this).click()){
      document.location.href = $(this).attr("href");
    }
  });
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-11T16:15:14.627

有一个更简单的方法来实现它，

**HTML**

```
<a href="https://getbootstrap.com/" id="fooLinkID">Bootstrap is life </a> 
```

**JavaScript**

```
// Simulating click after 3 seconds
setTimeout(function(){
  document.getElementById('fooLinkID').click();
}, 3 * 1000); 
```

使用纯 javascript 模拟点击。

[您可以在jsFiddle](https://jsfiddle.net/errhunter/onhje5o5/)上查看工作示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T20:32:37.623

好的，没有使用 document.location 设置推荐人（根据我的其他答案），可能与 window.navigate(url) 一起使用？如果这不起作用，则以下可能，尽管它非常 - ehrm - 丑陋：

```
$(function() {
  $("a").each(function(){
    if($(this).click()){
      $('<form method="get" action="' + $(this).attr("href") + '"></form>').appendTo("body").submit();
      return false;
    }
  });
}); 
```

# binding - Silverlight 2 - DataContext / 绑定问题

> ID：603568
> 
> 赞同：1
> 
> 时间：2009-03-02T19:09:16.140
> 
> 标签：binding, silverlight-2.0, datacontext

我对这个 XAML 有疑问......当我运行它时，它因为 TextBox 而挂起。（“挂起”是指托管 aspx 页面显示在浏览器中，但用户控件对象不会出现在页面上，并且 Internet Explorer 窗口底部有一些小绿条填满但永远不会消失.) 我的代码中有一个 TextBox 和一个 TextBlock 只是为了测试。如果我注释掉 TextBox 并只留下 TextBlock，它运行良好，所以我知道 DataContext 正在设置并且与 PatternName 的绑定确实有效。输出窗口中没有帮助我调试的错误。请帮忙！我在这个问题上花了几个小时。可能会发生什么？

```
 <StackPanel x:Name="HolePatternStackPanel" >
            <TextBlock Text="{Binding PatternName}" Width="75" />
            <TextBox Text="{Binding PatternName}" Height="25" Width="125"/>
     </StackPanel> 
```

下面是从调用 ListBox.SelectionChanged 方法设置 DataContext 的代码：

```
private void lvHolePatterns_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    HolePatternStackPanel.DataContext = this.ActivePattern;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T21:20:11.810

如果使用 SelectedItem 设置控件的 DataContext，则不需要使用 SelectionChanged 事件

例如

```
<Grid DataContext="{Binding SelectedItem}">
  <TextBlock Text="{Binding some_field_in_selecteditem}" />
</Grid> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T19:21:33.847

好吧，我对此了解得更多......这整个事情都是一个主从 UI 设计，所以我有我的 ListBox 使用 SelectedItem="{Binding ActivePattern}"，显然，一些无限循环正在建立之间那和 SelectionChanged 事件处理程序。

所以现在我的问题变成了 SelectedItem 到底有什么好处？由于我必须添加一个 SelectionChanged 事件处理程序来更新详细信息堆栈面板的 DataContext？

# c - 均匀缩放一个字节的最佳方法是什么？

> ID：603569
> 
> 赞同：1
> 
> 时间：2009-03-02T19:11:12.670
> 
> 标签：c, integer

在 CI 中需要将 a`uint8_t`从 0 - 255 缩放到 0 - 31

均匀地做到这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-02T19:13:58.623

如果您尝试从 8 位扩展到 5 位，则可以进行 3 位移位；

```
uint8_t scaled = (uint8_t)(original >> 3); 
```

这会丢弃低 3 位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T19:17:31.657

您可以使用一些简单的乘法和除法：

```
uint8_t scaled = (uint8_t)(((uint32_t)original * 32U) / 256U); 
```

# sqlite - 转义单引号字符以在 SQLite 查询中使用

> ID：603572
> 
> 赞同：208
> 
> 时间：2009-03-02T19:12:36.583
> 
> 标签：sqlite, escaping

我在一个文件中编写了数据库模式（到目前为止只有一个表）和该表的 INSERT 语句。然后我创建数据库如下：

```
$ sqlite3 newdatabase.db
SQLite version 3.4.0
Enter ".help" for instructions
sqlite> .read ./schema.sql
SQL error near line 16: near "s": syntax error 
```

我的文件的第 16 行如下所示：

```
INSERT INTO table_name (field1, field2) VALUES (123, 'Hello there\'s'); 
```

问题是单引号的转义字符。我也尝试过双重转义单引号（使用`\\\'`而不是`\'`），但这也不起作用。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：335
> 
> 时间：2009-03-02T19:14:43.257

尝试将单引号加倍（许多数据库都希望这样），所以它将是：

```
INSERT INTO table_name (field1, field2) VALUES (123, 'Hello there''s'); 
```

[文档中的](http://www.sqlite.org/lang_expr.html)相关引用：

> 通过将字符串括在单引号 (') 中形成字符串常量。字符串中的单引号可以通过将两个单引号放在一行中来编码 - 就像在 Pascal 中一样。不支持使用反斜杠字符的 C 样式转义，因为它们不是标准 SQL。BLOB 文字是包含十六进制数据的字符串文字，前面有一个“x”或“X”字符。...文字值也可以是标记“NULL”。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-03-02T19:15:57.590

我相信你想通过加倍单引号来逃避：

```
INSERT INTO table_name (field1, field2) VALUES (123, 'Hello there''s'); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2018-01-04T01:26:33.210

要替换字符串中的所有 (')，请使用

```
.replace(/\'/g,"''") 
```

例子：

```
sample = "St. Mary's and St. John's";
escapedSample = sample.replace(/\'/g,"''") 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-12-11T07:51:24.067

以防万一您有需要在数据库中插入的循环或 json 字符串。尝试用单引号替换字符串。这是我的解决方案。例如，如果您有一个包含单引号的字符串。

```
String mystring = "Sample's";
String myfinalstring = mystring.replace("'","''");

 String query = "INSERT INTO "+table name+" ("+field1+") values ('"+myfinalstring+"')"; 
```

这在 c# 和 java 中对我有用

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-12-05T22:04:05.540

在 C# 中，您可以使用以下命令将单引号替换为双引号：

```
 string sample = "St. Mary's";
 string escapedSample = sample.Replace("'", "''"); 
```

输出将是：

```
"St. Mary''s" 
```

而且，如果您直接使用 Sqlite；您可以使用对象而不是字符串并捕获 DBNull 之类的特殊内容：

```
private static string MySqlEscape(Object usString)
{
    if (usString is DBNull)
    {
        return "";
    }
    string sample = Convert.ToString(usString);
    return sample.Replace("'", "''");
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-30T20:00:26.490

在 bash 脚本中，我发现在值周围转义双引号对于可能为 null 或包含需要转义的字符（如连字符）的值是必要的。

在此示例中，columnA 的值可以为 null 或包含连字符。：

```
sqlite3 $db_name "insert into foo values (\"$columnA\", $columnB)"; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-19T19:43:27.353

演示不需要复杂性或双引号的单引号字符串行为。

测试：

```
SELECT replace('SAMY''S','''''',''''); 
```

输出：

```
SAMY'S 
```

SQLite 版本：

```
SELECT sqlite_version(); 
```

输出：

```
3.36.0 
```

# asp.net - 当数据绑定到 GridView 时，如何根据值更改行的背景颜色？

> ID：603574
> 
> 赞同：1
> 
> 时间：2009-03-02T19:13:47.797
> 
> 标签：asp.net

当数据绑定到 ASP .NET GridView 时，如何根据绑定 GridView 的数据表中的一列的布尔值更改背景颜色？

例如，如果您绑定到具有两列的表：名称、LikesBurritos。如果他们喜欢墨西哥卷饼，你希望人们的名字标签是蓝色的，如果他们不喜欢，你希望他们的名字是白色的。

遍历数据表或对象列表违背了数据绑定的目的......并且有很多地方我们使用数据绑定来表示在遍历集合时不编码每一列的添加。我很好奇你是否可以通过在标记中使用表达式来声明地做到这一点......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T19:24:39.317

使用 GridView 中内置的 RowDataBound 事件，然后您可以执行以下操作（在 VB.NET 中）：

```
Private Sub FormatGridView(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) _
        Handles gvBurritoPeople.RowDataBound

  Dim drBurritoPeople As BurritoPeopleRow

  If e.Row.RowType = DataControlRowType.DataRow Then

     drBurritoPeople = DirectCast(DirectCast(e.Row.DataItem, System.Data.DataRowView).Row, BurritoPeopleRow)

     If drBurritoPeople.LikesBurritos Then
        e.Row.CssClass = "BlueRow"
     Else
        e.Row.CssClass = "WhiteRow"
     End If         

  End IF

End Sub 
```

我不太确定您不想遍历所有数据的含义是什么，但是白色或蓝色行的这种呈现是在数据写入页面的同时发生的，因此您不会丢失这里的任何表现。

编辑：我想一个可能的替代方法是在您的 ResultSet 中创建第三列，其中包含一个 CssClass 名称，您可以根据 LikesBurritos 列声明该名称，并且您可以将 CssClass 绑定到您的 GridView 中的那个，但这会发生要求您有权访问 SQL 语句或拦截您的 DataBinding 过程以修改 ResultSet 下来。

# networking - 如何判断套接字从哪个接口接收到消息？

> ID：603577
> 
> 赞同：13
> 
> 时间：2009-03-02T19:14:21.417
> 
> 标签：networking, sockets, libc

如果一个套接字被绑定到`IN6ADDR_ANY`or`INADDR_ANY`并且您使用诸如`recvfrom()`在套接字上接收消息的调用。有没有办法找出消息来自哪个接口？

在 IPv6 链接范围消息的情况下，我希望 from 参数`recvfrom()`将`scope_id`字段初始化为接口 ID。不幸的是，它`0`在我的测试程序中设置为。

有人知道找到这些信息的方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-03T20:15:12.010

dwc 是对的，IPV6_PKTINFO 将适用于 Linux 上的 IPv6。

此外，IP_PKTINFO 适用于 IPv4 — 您可以在手册页 ip(7) 中查看详细信息

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-03-15T08:33:24.317

我构建了一个提取源、目标和接口地址的示例。为简洁起见，不提供错误检查。请参阅此副本：[获取接收到的 UDP 数据包的目标地址](https://stackoverflow.com/q/5281409/149482)。

```
// sock is bound AF_INET socket, usually SOCK_DGRAM
// include struct in_pktinfo in the message "ancilliary" control data
setsockopt(sock, IPPROTO_IP, IP_PKTINFO, &opt, sizeof(opt));
// the control data is dumped here
char cmbuf[0x100];
// the remote/source sockaddr is put here
struct sockaddr_in peeraddr;
// if you want access to the data you need to init the msg_iovec fields
struct msghdr mh = {
    .msg_name = &peeraddr,
    .msg_namelen = sizeof(peeraddr),
    .msg_control = cmbuf,
    .msg_controllen = sizeof(cmbuf),
};
recvmsg(sock, &mh, 0);
for ( // iterate through all the control headers
    struct cmsghdr *cmsg = CMSG_FIRSTHDR(&mh);
    cmsg != NULL;
    cmsg = CMSG_NXTHDR(&mh, cmsg))
{
    // ignore the control headers that don't match what we want
    if (cmsg->cmsg_level != IPPROTO_IP ||
        cmsg->cmsg_type != IP_PKTINFO)
    {
        continue;
    }
    struct in_pktinfo *pi = CMSG_DATA(cmsg);
    // at this point, peeraddr is the source sockaddr
    // pi->ipi_spec_dst is the destination in_addr
    // pi->ipi_addr is the receiving interface in_addr
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-03T17:20:41.367

除了绑定到每个接口之外，我本身并不知道使用 IPv4 的方法。

IPv6 添加了 IPV6_PKTINFO 套接字选项来解决这个缺点。使用该选项，a`struct in6_pktinfo`将作为辅助数据返回。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-02T22:16:28.887

自从我进行 C/C++ TCP/IP 编码以来已经有一段时间了，但据我所知，在每条消息（或派生的套接字）上，您都可以进入 IP 标头信息。这些标头应包括接收地址，该地址将是您询问的接口的 IP。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-03T05:34:15.357

除了按照格洛梅克的建议在每个接口上打开一个单独的套接字之外，我知道在 Windows 上明确执行此操作的唯一方法是使用原始套接字，例如，

```
 SOCKET s = socket(AF_INET, SOCK_RAW, IPPROTO_IP); 
```

来自该套接字的每次接收都是一个[IP 数据包](http://en.wikipedia.org/wiki/IPv4)，其中包含源地址和目标地址。我正在处理的程序要求我使用 SIO_RCVALL 选项将套接字置于混杂模式。这样做意味着我得到了接口在网络上“看到”的每个 IP 数据包。要为我的应用程序明确提取数据包，我需要使用 IP 和 TCP/UDP 标头中的地址和端口来过滤数据。显然，这可能比您感兴趣的开销更大。我提到它只是为了说明这一点 - 我从来没有使用原始套接字而不将其置于混杂模式。所以我不确定你是否可以将它绑定到 INADDR_ANY 并从那时起将其用作常规套接字。在我看来，你可以；我只是从未尝试过。

**编辑：** 阅读这篇[文章](http://msdn.microsoft.com/en-us/library/ms740548.aspx)以了解有关 Windows 上原始套接字的限制。我在项目中遇到的最大障碍是必须是管理员组的成员才能在 Windows 2000 及更高版本上打开原始套接字。

# database - 如何在 CakePHP 中使模型的数据库可移植？

> ID：603578
> 
> 赞同：0
> 
> 时间：2009-03-02T19:14:30.493
> 
> 标签：database, cakephp, primary-key, portability

我对蛋糕不是很熟悉..所以这是我的问题..我们正在mysql上开发一个应用程序，但它最终可能需要部署到mssql或oracle。我们如何确保我们的主键不会出现奇怪的问题？在 mysql 中，它们是 AUTO INCREMENT 列，但在 oracle 中的 IIRC 您需要使用序列……有没有办法使这成为透明的更改？我是不是想多了？

有没有人有在 cakephp 应用程序上切换数据库供应商的经验？有什么需要注意的提示或事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T20:16:32.937

在 Cake 数据库配置文件中，您选择您的驱动程序（参见[http://book.cakephp.org/view/40/Database-Configuration](http://book.cakephp.org/view/40/Database-Configuration)）。然后，如果您使用 fieldname 设置您的 PK（如果使用 MySQL，这也是您的 A_I 列）`id`，Cake 将自动处理 auto_increment 插入。我假设（注意：没有尝试过使用其他东西的 Cake）Cake 会处理 Oracle 之类的 A_I 列。

Cake 使用它自己的 DB 抽象层——但包含的抽象涵盖了相当多的内容，它会按照指定的方式执行（即它会为您处理自动增量的东西）。

简而言之，你可能想多了。也就是说，我会模拟一个小蛋糕应用程序，然后尝试切换它背后的数据库（更改您的数据库配置，您的应用程序应该会自动切换）。

HTH，特拉维斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T01:05:20.440

以下做法对我很有用

我使用蛋糕模式（我倾向于为每组模型设置 1 个模式文件。IE 用户、角色、配置文件可能都在一个 UsersSchema 文件中）

还可以看看使用 debuggable.com FixturesShell - 它允许您将测试用例装置导入实时数据库。非常适合从架构文件设置初始用户和角色组。

此外，如果您将“id”字段设置为 VARCHAR(36) 而不是 INT(#)，蛋糕将自动使用 UUID 样式的 id。这意味着如果您需要将数据移动到另一个应用程序或服务器，您的数据发生 id 值冲突的可能性会大大降低。

夹具外壳还有一个用于生成 uuid 的命令行工具（因此您可以将它们添加到夹具中的 $records 变量中以进行插入等）

总之 - 使用 CakeSchema 模式外壳、来自 debuggable.com 的固定装置外壳和您的 id 的 UUID 值，它应该为您提供可移植的结构创建工具、可移植的数据插入工具和可移植的 id 字段格式。

[http://github.com/felixge/debuggable-scraps/tree/fd0e5ad625cb21f5ba16e6b186821a5774089ac7/cakephp/shells/fixtures](http://github.com/felixge/debuggable-scraps/tree/fd0e5ad625cb21f5ba16e6b186821a5774089ac7/cakephp/shells/fixtures)

[http://api.cakephp.org/class/schema-shell](http://api.cakephp.org/class/schema-shell)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T17:41:33.610

您需要使用“蛋糕模式”来管理您的数据库。这将在您创建数据库时处理所有特定于数据库的内容。

[http://book.cakephp.org/view/735/Generating-and-using-Schema-files](http://book.cakephp.org/view/735/Generating-and-using-Schema-files)

# javascript - 使用 Slider 作为输入提交 HTML 表单 (WebFX)

> ID：603580
> 
> 赞同：0
> 
> 时间：2009-03-02T19:14:59.993
> 
> 标签：javascript, html, forms

如何[将此滑块](http://webfx.eae.net/dhtml/slider/slider.html)的值提交给 CGI 应用程序（就像您将复选框一样）？不确定滑块的输入标签是否搞砸了？

```
<div class="slider" id="slider-1" tabIndex="1">
   <input class="slider-input" id="slider-input-1"
      name="slider-input-1"/>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T19:50:50.127

如果我是你，我会尝试调整`<input>`标签的`type`属性，将其设置为`text`or `hidden`。

（我对您使用的框架/环境的了解不够肯定。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T22:45:52.327

好的，我知道了：

```
 <form action="/cgi-bin/Lib.exe" method=POST name="slider" ID="Form2">
                    <input type="hidden" name="user" value="" ID="Text1">
            </form>  

<input type="button" value="Delete" class="btn" onclick="setval()" onmouseover="hov(this, 'btn btnhov')" onmouseout="hov(this, 'btn')" ID="Button1" NAME="Button1"/>

function setval()
{   
    //alert(s.getValue());
    document.slider.user.value = s.getValue();//set value of hidden text box to value of slider
    document.slider.submit();
} 
```

# sql - BIRT 2.2 动态模式名 称

> ID：603582
> 
> 赞同：1
> 
> 时间：2009-03-02T19:15:06.997
> 
> 标签：sql, db2, birt, params

是否可以在 BIRT 查询中使模式名称动态化。

我试过这个：

```
SELECT CURRENT DATE AS DATE, 
(CASE WHEN DAYOFWEEK(CURRENT DATE) = 1 THEN 'SUNDAY'
      WHEN DAYOFWEEK(CURRENT DATE) = 2 THEN 'MONDAY'
      WHEN DAYOFWEEK(CURRENT DATE) = 3 THEN 'TUESDAY'
      WHEN DAYOFWEEK(CURRENT DATE) = 4 THEN 'WEDNESDAY'
      WHEN DAYOFWEEK(CURRENT DATE) = 5 THEN 'THURSDAY'
      WHEN DAYOFWEEK(CURRENT DATE) = 6 THEN 'FRIDAY'
      WHEN DAYOFWEEK(CURRENT DATE) = 7 THEN 'SATURDAY'
      END) AS DAYOFWEEK
FROM **?**.COBOL_CALENDAR
 WHERE SERVICE_DATE = CURRENT DATE" 
```

这会产生以下错误：以下项目有错误：

```
ReportDesign (id = 1): 
+ Cannot get the result set metadata.
SQL statement does not return a ResultSet object.
SQL error #1: [IBM][CLI Driver][DB2] SQL0104N  An unexpected token "?" was found following "".  Expected tokens may include:  "( TABLE FINAL <IDENTIFIER> XMLTABLE".  SQLSTATE=42601 
```

但是 ? 似乎只适用于 where 子句。

我需要将模式作为参数传递并动态使用，因为它会根据 dev/cat/prod 更改

是否没有某种方法可以在 birt xml 外部生成 sql 并以某种方式注入它？

我对该主题进行了更多搜索并找到了此解决方案

```
<method name="beforeOpen"><![CDATA[this.queryText = "SELECT CURRENT DATE AS DATE, "+
"(CASE WHEN DAYOFWEEK(CURRENT DATE) = 1 THEN 'SUNDAY'"+
"      WHEN DAYOFWEEK(CURRENT DATE) = 2 THEN 'MONDAY'"+
"      WHEN DAYOFWEEK(CURRENT DATE) = 3 THEN 'TUESDAY'"+
"      WHEN DAYOFWEEK(CURRENT DATE) = 4 THEN 'WEDNESDAY'"+
"      WHEN DAYOFWEEK(CURRENT DATE) = 5 THEN 'THURSDAY'"+
"      WHEN DAYOFWEEK(CURRENT DATE) = 6 THEN 'FRIDAY'"+
"      WHEN DAYOFWEEK(CURRENT DATE) = 7 THEN 'SATURDAY'"+
"      END) AS DAYOFWEEK"+
"FROM "+params["SCHEMA"]+".COBOL_CALENDAR"+
" WHERE SERVICE_DATE = CURRENT DATE";]]></method> 
```

但是，无论有多少关于此问题的示例以这种方式注入 sql 只会产生以下错误。

```
ReportDesign (id = 1): 
+ Cannot get the result set metadata.
SQL statement does not return a ResultSet object.
SQL error #1: [IBM][CLI Driver][DB2] SQL0104N  An unexpected token "SCHEMANAME" was found following "".  Expected tokens may include:  ", FROM INTO".  SQLSTATE=42601 
```

我什至尝试`reportContext.getParameterValue("SCHEMANAME")`了同样结果的路线。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T19:00:54.637

啊，这是一个愚蠢的空格问题！

" END) AS DAYOFWEEK"+ "FROM "+params["SCHEMA"]+".COBOL_CALENDAR"+

在 FROM 前面添加一个空格可以修复它。

刘海头在液晶显示器上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-01T09:32:47.020

看起来您编辑了报告的 XML 源。这是在 SQL 查询中替换任意字符串的更图形化方法：

将您的查询编写如下：

```
SELECT CURRENT DATE AS DATE, 
(CASE WHEN DAYOFWEEK(CURRENT DATE) = 1 THEN 'SUNDAY'
      WHEN DAYOFWEEK(CURRENT DATE) = 2 THEN 'MONDAY'
      WHEN DAYOFWEEK(CURRENT DATE) = 3 THEN 'TUESDAY'
      WHEN DAYOFWEEK(CURRENT DATE) = 4 THEN 'WEDNESDAY'
      WHEN DAYOFWEEK(CURRENT DATE) = 5 THEN 'THURSDAY'
      WHEN DAYOFWEEK(CURRENT DATE) = 6 THEN 'FRIDAY'
      WHEN DAYOFWEEK(CURRENT DATE) = 7 THEN 'SATURDAY'
      END) AS DAYOFWEEK
FROM dev.COBOL_CALENDAR
 WHERE SERVICE_DATE = CURRENT DATE 
```

如果`dev`是一个有效的模式，您现在可以选择元数据集并且仍然可以用报告参数替换它。

接下来单击您的数据集并选择“脚本”选项卡。在这里选择“beforeOpen”并输入替换脚本：

```
this.queryText = this.queryText.replace("dev", params["SCHEMA"].value); 
```

这样，您可以在执行查询之前将`dev`查询文本中的字符串替换为 Parameter 的值。`SCHEMA`您可以替换您想要的每个字符串（`**?**`来自您的问题的链接，但首先使用有效的模式，您可以在设计阶段使用元数据集。 [![在此处输入图像描述](https://i.stack.imgur.com/M33dj.jpg)](https://i.stack.imgur.com/M33dj.jpg)

# asp.net - 对象没有被垃圾回收，但不包含 gcroots

> ID：603587
> 
> 赞同：15
> 
> 时间：2009-03-02T19:16:32.033
> 
> 标签：asp.net, debugging, windbg

在这里我们的网络应用程序遇到了一个棘手的问题。(Asp.net 2.0 赢服务器 2008)

尽管我希望它保持在相当静态的水平，但我们对网站的内存使用量会不断增长。（我们有少量数据存储在状态中）。

想找出问题所在，我运行了 System.GC.Collect(); 几次，进行内存转储，然后将此内存转储加载到 WinDbg 中。

当我执行 DumpHeap -Stat 时，我会在特定类型的内存中得到一个非常大的数字。

0000064280580b40 713471 79908752 付款选项

所以，为这种类型做一个 DumpHeap -MT，我得到了一堆对象引用。选择其中的一个随机数，我执行 !gcroot 并且命令返回报告没有对其进行引用。

对我来说，这正是 GC 应该收集这些项目的时候，但由于某种原因，它们一直处于未完成状态。

任何人都可以解释可能发生的事情吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-08T20:56:50.200

您可以尝试在 Windbg 中使用[sosex.dll](http://www.stevestechspot.com/SOSEXANewDebuggingExtensionForManagedCode.aspx)，这是一个用于帮助 .NET 调试的扩展。有一个名为 !refs 的命令类似于 !gcroot，因为它会显示所有引用对象的对象，此外它还会显示它也引用的所有对象。

在作者网站上的示例中，!refs 用于对象，输出如下所示：

```
0:000> !refs 0000000080000db8
Objects referenced by 0000000080000db8 (System.Threading.Mutex):
0000000080000ef0         32    Microsoft.Win32.SafeHandles.SafeWaitHandle 

Objects referencing 0000000080000db8 (System.Threading.Mutex):
0000000080000e08         72    System.Threading.Mutex+<>c__DisplayClass3
0000000080000e50         64    System.Runtime.CompilerServices.RuntimeHelpers+CleanupCode 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T19:26:12.417

一些事情：

1.  GC.Collect 不会帮助您进行任何调试。垃圾收集器已经被调用：如果有任何对象可用于收集，它就已经发生了。
2.  服务器上的空闲内存是浪费的内存。您确定内存正在“泄漏”，还是只是框架决定它可以在内存中保留更多内容或保留更多内存以便更快地访问？在这种情况下，我怀疑您正在泄漏内存，但需要仔细检查。
3.  听起来您不希望保留对 PaymentOption 对象的引用。也许某个地方的静态集合？还是单独的线程？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-14T05:04:08.597

PaymentObject 是否有机会实现终​​结器？它是否调用 STA COM 对象？

我很想看看 !finalizequeue 的输出，看看堆上显示的对象的数量是否大致等于可能等待最终确定的对象的数量。输出应该看起来像这样：

```
generation 0 has 57 finalizable objects (0409b5cc->0409b6b0)
generation 1 has 55 finalizable objects (0409b4f0->0409b5cc)
generation 2 has 0 finalizable objects (0409b4f0->0409b4f0)
Ready for finalization 0 objects (0409b6b0->0409b6b0) 
```

如果**Ready for finalization**对象的数量继续增长，并且您的某些垃圾收集正在发生（通过 perfmon 计数器确认），那么它可能是一个阻塞的终结器线程。您可能需要在流程的整个生命周期内（在回收之前）拍摄多个快照以进行确认。只要网站处于某种负载下，我通常依赖于 3 的幻数。

终结器中的错误可能会阻塞终结器线程并阻止对象被收集。

如果 PaymentOption 对象调用旧版 STA COM 对象，那么本文[由 STA 组件导致的 ASP.NET Hang 和 OutOfMemory 异常](http://blogs.msdn.com/tess/archive/2008/01/30/asp-net-hang-and-outofmemory-exceptions-caused-by-sta-components.aspx)可能指向正确的方向。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T19:24:18.457

并非没有有关您的应用程序的更多信息。但是很久以前我们遇到了一些令人讨厌的内存问题。你使用 ASP.NET 缓存吗？正如 Raymond Chen 喜欢说的那样，“糟糕的缓存策略与内存泄漏无法区分”。

查看另一个工具 - CLRProfiler.exe - 它将帮助您遍历对象引用树以查看对象的根。这也很好：[链接文本](http://memprofiler.com/)

你以前听过这个——如果你必须使用 GC.Collect，那就错了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T19:26:05.630

PaymentOption 对象是在异步过程中创建的吗？我记得一些事情，如果你不调用 EndInvoke，你可能会遇到这样的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-28T10:15:12.870

我自己一直在调查同样的问题，并询问为什么没有收集没有引用的对象。

大于 85,000 字节的对象存储在大对象堆中，从该堆中释放内存的频率较低。

[http://msdn.microsoft.com/en-us/magazine/cc534993.aspx](http://msdn.microsoft.com/en-us/magazine/cc534993.aspx)

单个 PaymentOption 可能没有那么大，但它们是包含在集合中，还是基于 DataSet 之类的东西？您应该选择 PaymentOption / collection / DataSet 的几个实例，然后使用 sos !objsize 命令查看它们的大小。

不幸的是，这并不能真正回答这个问题。我喜欢认为我可以信任 .net 框架来负责在需要时释放未使用的内存。但是，我看到运行我正在查看的应用程序的工作进程正在使用大量内存，即使服务器上的内存看起来非常紧张。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-01T21:40:49.173

仅供参考，.NET 4 中的 SOS 支持一些可能有帮助的新命令，即`!gcwhere`（定位异议的产生；sosex 的 gcgen）和`!findroots`（执行它在锡上所说的操作；sosex 的 !refs）

两者都记录在[SOS 文档](http://msdn.microsoft.com/en-us/library/bb190764(VS.100).aspx)中，并[在 Tess Ferrandez 的博客中提及](http://blogs.msdn.com/tess/archive/2010/03/01/new-commands-in-sos-for-net-4-0-part-1.aspx)。

# fortran - 从文件中将格式化数组读入变量

> ID：603590
> 
> 赞同：1
> 
> 时间：2009-03-02T19:16:55.013
> 
> 标签：fortran, fortran90

我正在尝试将格式化的二维数组从磁盘上的文件读取到变量中。我有写操作，这很简单，但我坚持读同一个文件。有人可以向我指出如何执行此操作的示例/文章吗？网络似乎饱和了，但我找不到有用的文章。

顺便说一句，格式化文件的原因是因为它包含配置选项，所以保持人类可读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T19:34:15.843

实际上，我发现编译器附带的物理文档通常是 Fortran 编译器最易读、信息量最大的。当然，如果您使用的是 g95 或类似的东西，这不是一个选择。

这是一个[很好的页面](http://www.cs.mtu.edu/~shene/COURSES/cs201/NOTES/chap05/format.html)，描述了 read 声明的大部分技术规范。特别是，请参阅“格式编辑描述符”部分 - 非常方便。

附带说明一下，如果您有确切的写入格式字符串，通常可以将其放入读取格式字符串中，但如果您正在使用`WRITE(*,*)`或类似的方式写入，您可能不会使用有效的写入格式语句.

最后，如果您将其转储为 ASCII 以便人们可以阅读，并且您不必担心向后兼容性，请考虑将所有内容转储为固定长度字段，因为它们是迄今为止最容易读回的内容在。

抱歉，我想不出更好的在线资源，但是 Fortran 在网络上的文档严重不足。我记得有一次检查 g95 是否有 Fortran 参考文档，但他们大多只有特定编译器设置的文档。不过祝你好运！

# iphone - 如何使用 NSUserDefaults 正确工作（检索值）

> ID：603593
> 
> 赞同：3
> 
> 时间：2009-03-02T19:17:35.713
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我的代码中有一个简单的方法，如下所示：

```
- (BOOL)isFirstTimeLogin 
{
    NSString *t_gName = 
    [NSString stringWithFormat:@"%@", [[NSUserDefaults standardUserDefaults] objectForKey:kGroupIdentifierKey]];
    if ([t_gName isEqualToString:@""] || t_gName == nil) {
        DLog(@"LoginViewController, m:::isFirstTimeLogin, First time login happening.");
        return YES;
    }

    DLog(@"LoginViewController, m:::isFirstTimeLogin, Not a first time login.");
    return NO;
} 
```

只需转到 Settings 包，然后从 PSTextFieldSpecifier 中检索一个值。如果我手动进入并添加一些任意文本，代码将按预期工作。但是，每当我第一次在新设备上安装应用程序时，第一个条件是执行为 false，它应该为 true。单步执行代码后，gdb 证明该对象也确实为 nil：

(gdb) po t_gName
(null)

我在这里可能做错了什么？为什么第一次安装应用程序时条件失败并且 t_gName 是空/null PSTextFieldSpecifier。我什至尝试在我的设置包中添加一个空字符串的 DefaultValue。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-02T19:23:18.040

```
[NSString stringWithFormat:@"%@", nil]; 
```

这会创建如下内容：

```
@"(null)" 
```

因此既不`nil`也不等于`@""`。

## 顺便一提

1.  你根本不需要`stringWithFormat:`。
2.  不检查`string == nil`但为`!string`
3.  您不必检查空字符串，因为有一组或它是`nil`.
4.  使用比 更好的名称`t_gName`，没有理由使用短名称。

像这样：

```
- (BOOL)isFirstTimeLogin 
{
    NSString *groupIdentifier = [[NSUserDefaults standardUserDefaults]
                                    objectForKey:kGroupIdentifierKey];
    if (!groupIdentifier) {
        DLog(@"First time login.");
        return YES;
    }

    DLog(@"Not a first time login.");
    return NO;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-27T18:54:42.487

试试这个：

```
 -(BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
     {

        if ([[NSUserDefaults standardUserDefaults] boolForKey:@"HasLaunchedFirstTime"])
        {
            // app already launched
            NSLog(@"app already launched");

        }
        else
        {
            [[NSUserDefaults standardUserDefaults] setBool:YES forKey:@"HasLaunchedFirstTime"];
            [[NSUserDefaults standardUserDefaults] synchronize];

             NSLog(@"First Time");

            // This is the first launch ever
        }
    } 
```

# python - 解决权限的正确方法是什么？

> ID：603595
> 
> 赞同：3
> 
> 时间：2009-03-02T19:18:05.430
> 
> 标签：python, django

我添加了一个具有一个权限的新模型，现在我需要在部署代码并为所涉及的新应用程序运行 syncdb 后将该权限添加给生产机器上的几个用户。我还没有找到正确的方法来做到这一点。auth 文档提到了 User.user_permissions.add(permission)，但从不告诉我“权限”是什么或获得它的最佳方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T19:25:26.630

`Permission`（位于`django.contrib.auth.models`）是一个数据库对象。您将能够看到所有这些`Permission.objects.all()`。它们是由每个模型的同步后信号自动创建的（[正如文档所述](http://docs.djangoproject.com/en/dev/topics/auth/#id1)，您也可以定义自己的）。

要将权限分配给用户，您首先必须获取`Permission`对象（使用`Permission.objects.get(*args)`），然后您可以将其添加到用户，`User.user_permissions.add(permission)`如您所述。

或者，如果你能做到这一点，更简单的方法就是使用 Django 管理站点。在每个用户的详细信息页面中，都有一个与权限相关的部分。我猜你没有在管理员之外使用这些权限，所以这是他们会影响的唯一区域。如果您希望所有用户都拥有所有权限，您可以通过将`is_superuser`每个用户上的标志设置为`True`.

# c# - 如何通过基类中的方法返回泛型类型？

> ID：603596
> 
> 赞同：2
> 
> 时间：2009-03-02T19:18:51.200
> 
> 标签：c#, .net, design-patterns, generics, activerecord

我一直在尝试创建一个简单的基类，它封装了我的一些数据库访问约定。我通常会创建一个名为“products_retrieve_product”的存储过程，以根据 productID 选择产品。我希望基类中的“检索”方法返回派生类在其定义中提供的类型。我想用泛型来完成什么？

```
public class MyBaseClass <T>
{
    private string _className;

    public MyBaseClass ()
    {
        _className = this.GetType().Name;
    }

    public virtual T Retrieve(int ID)
    {
        Database db = DatabaseFactory.CreateDatabase();
        DbCommand dbCommand = db.GetStoredProcCommand(String.Format("{0}s_Retrieve_{0}", _className));
        db.AddInParameter(dbCommand, String.Format("@{0}ID", _className), DbType.Int32, ID);

        using (IDataReader dr = db.ExecuteReader(dbCommand))
        {
            if (dr.Read())
            {
                BOLoader.LoadDataToProps(this, dr);
            }
        }
        return (T)this;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T19:47:18.123

我认为你想做这样的事情：

```
class MyBaseClass<T> where T : MyBaseClass<T>, new()
{
    public T Retrieve()
    {
        return new T();
    }
}

class Foo : MyBaseClass<Foo>
{
}

class Program
{
    public static void Main()
    {
        Foo f = new Foo();
        Foo f2 = f.Retrieve();
        Console.WriteLine(f2.ToString());
    }
} 
```

当你运行这个程序时，Foo 的类型名称会打印在命令行上。显然这是一个人为的例子，但是当从`MyBaseClass.Retrieve()`.

关键是在 T 上添加一个约束，使其必须是类本身的一个实例。这样，您可以在子类化时将子类指定为泛型类型`MyBaseClass<T>.`

我不完全确定这是否是一个好主意，但看起来可以做到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T19:25:47.520

当然。在您的示例中，如果我希望我的 Foo 类在调用 Retrieve(...) 时返回 Bars：

```
public class Foo : MyBaseClass<Bar>{} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T16:11:02.393

嗯，我们正在使用反射来获取类名。BOLoader 无疑是在使用反射来加载一些属性。为什么不完全致力于反思？

BOLoader 不关心这种“返回类型”的游戏。我们为什么要？

```
public static class MyBaseClassExtender
{
    public static void Retrieve(this MyBaseClass entity, int ID)
    {
        string className = entity.GetType().Name;
        Database db = DatabaseFactory.CreateDatabase();
        DbCommand dbCommand = db.GetStoredProcCommand(String.Format("{0}s_Retrieve_{0}", className));
        db.AddInParameter(dbCommand, String.Format("@{0}ID", className), DbType.Int32, ID);

        using (IDataReader dr = db.ExecuteReader(dbCommand))
        {
            if (dr.Read())
            {
                BOLoader.LoadDataToProps(this, dr);
            }
        }
    }
} 
```

然后你就说：

```
Foo myFoo = new Foo();
myFoo.Retrieve(2); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-02T19:22:16.777

不，不是，因为你真正需要做的是在类定义中这样的事情：

```
public class MyBaseClass<T> : T 
```

目前这对于泛型是不可能的。

您需要做的是将工厂与工厂生产的产品分开（您需要一个单独的类来构建 T，然后您应该提供辅助方法来处理 T，可能是扩展方法）。

# ruby-on-rails - 有哪些好的 Ruby on Rails 博客？

> ID：603609
> 
> 赞同：2
> 
> 时间：2009-03-02T19:22:58.260
> 
> 标签：ruby-on-rails

我在 6 个月前开始学习 Rails，到目前为止，我喜欢它背后的社区。有很多可用的论坛和文档资源，但我一直无法找到一个指导性的、持续维护的指导性 Rails 博客。我喜欢 Ryan Bates 的 Railscasts，但我很想找到另一个与他的一致性或质量相同的博客。

有什么建议么？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T21:35:06.880

有成百上千个优秀的 Rails 博客。

这是我的 Google Reader Ruby on Rails 部分的 OPML：

```
 <outline text="3DM Design" title="3DM Design" type="rss"
                xmlUrl="http://3dmdesign.com/dev-journal/feed" htmlUrl="http://dev-journal.3dmdesign.com"/>
            <outline
                text="&lt;3! â€” Chris Kampmeier on Ruby, Rails, and other delights"
                title="&lt;3! â€” Chris Kampmeier on Ruby, Rails, and other delights"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/shiftcommathree-blog" htmlUrl="http://www.shiftcommathree.com/"/>
            <outline text="A Rubyist Railstastic Adventure"
                title="A Rubyist Railstastic Adventure" type="rss"
                xmlUrl="http://rubyist.tumblr.com/rss" htmlUrl="http://rubyist.tumblr.com/"/>
            <outline text="A Single Programmer's Blog - Home"
                title="A Single Programmer's Blog - Home" type="rss"
                xmlUrl="http://feeds.feedburner.com/teksol" htmlUrl="http://blog.teksol.info/"/>
            <outline text="a tornado of razorblades"
                title="a tornado of razorblades" type="rss"
                xmlUrl="http://adam.blog.heroku.com/feed" htmlUrl="http://www.google.com/reader/view/feed%2Fhttp%3A%2F%2Fadam.blog.heroku.com%2Ffeed"/>
            <outline text="Accelerate HR Blog"
                title="Accelerate HR Blog" type="rss"
                xmlUrl="http://www.jobwd.com/article/rss" htmlUrl="http://www.jobwd.com/article/rss"/>
            <outline text="Active Reload - Home"
                title="Active Reload - Home" type="rss"
                xmlUrl="http://feeds.feedburner.com/activereload" htmlUrl="http://hoth.entp.com/"/>
            <outline text="Addicted To New by John Nunemaker"
                title="Addicted To New by John Nunemaker" type="rss"
                xmlUrl="http://addictedtonew.com/feed/" htmlUrl="http://addictedtonew.com"/>
            <outline text="AirBlog - Home" title="AirBlog - Home"
                type="rss"
                xmlUrl="http://blog.airbladesoftware.com/feed/atom.xml" htmlUrl="http://blog.airbladesoftware.com/"/>
            <outline text="Alex Young's weblog"
                title="Alex Young's weblog" type="rss"
                xmlUrl="http://feeds.feedburner.com/webdevelopernotes" htmlUrl="http://alexyoung.org"/>
            <outline text="Alloy Code - Home" title="Alloy Code - Home"
                type="rss" xmlUrl="http://alloycode.com/feed/atom.xml" htmlUrl="http://www.alloycode.com/"/>
            <outline text="almost effortless" title="almost effortless"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/almosteffortless" htmlUrl="http://almosteffortless.com"/>
            <outline text="AlternateIdea - Home"
                title="AlternateIdea - Home" type="rss"
                xmlUrl="http://feeds.feedburner.com/encytemedia" htmlUrl="http://alternateidea.com/"/>
            <outline text="Ambethia" title="Ambethia" type="rss"
                xmlUrl="http://ambethia.com/feed/atom/" htmlUrl="http://ambethia.com/"/>
            <outline text="Anarchogeek - Home"
                title="Anarchogeek - Home" type="rss"
                xmlUrl="http://www.anarchogeek.com/feed/atom.xml" htmlUrl="http://anarchogeek.com/"/>
            <outline text="and another thing..."
                title="and another thing..." type="rss"
                xmlUrl="http://pivotallabs.com/users/jsusser/blog.rss" htmlUrl="http://pivotallabs.com/users/jsusser/blog"/>
            <outline text="Andrzej on Software"
                title="Andrzej on Software" type="rss"
                xmlUrl="http://andrzejonsoftware.blogspot.com/feeds/posts/default" htmlUrl="http://andrzejonsoftware.blogspot.com/"/>
            <outline text="Application Error" title="Application Error"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/ApplicationError" htmlUrl="http://application-error.com/"/>
            <outline text="Article RSS Feed" title="Article RSS Feed"
                type="rss" xmlUrl="http://lrug.org/rss/meetings" htmlUrl="http://lrug.org/meetings/"/>
            <outline text="Article RSS Feed" title="Article RSS Feed"
                type="rss" xmlUrl="http://lrug.org/rss/" htmlUrl="http://lrug.org/"/>
            <outline text="Article RSS Feed" title="Article RSS Feed"
                type="rss" xmlUrl="http://lrug.org/rss/nights/" htmlUrl="http://lrug.org/nights/"/>
            <outline text="Astrails" title="Astrails" type="rss"
                xmlUrl="http://feeds.feedburner.com/Astrails" htmlUrl="http://blog.astrails.com/"/>
            <outline text="atomic_spin" title="atomic_spin" type="rss"
                xmlUrl="http://feeds.feedburner.com/atomic_spin" htmlUrl="http://spin.atomicobject.com/"/>
            <outline text="Badpopcorn" title="Badpopcorn" type="rss"
                xmlUrl="http://badpopcorn.com/blog/feed/atom/" htmlUrl="http://badpopcorn.com/blog"/>
            <outline text="Bambinos" title="Bambinos" type="rss"
                xmlUrl="http://feeds.feedburner.com/bambinos" htmlUrl="http://bambinos.tumblr.com/"/>
            <outline text="Bamboo Blog - Home"
                title="Bamboo Blog - Home" type="rss"
                xmlUrl="http://feeds.feedburner.com/newbamboo" htmlUrl="http://blog.new-bamboo.co.uk"/>
            <outline text="Barking Iguana" title="Barking Iguana"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/BarkingIguana" htmlUrl="http://barkingiguana.com/?source=feed"/>
            <outline text="Beautiful Pixel - Home"
                title="Beautiful Pixel - Home" type="rss"
                xmlUrl="http://feeds.feedburner.com/BeautifulPixel" htmlUrl="http://beautifulpixel.com/"/>
            <outline text="Beech Bonanza" title="Beech Bonanza"
                type="rss"
                xmlUrl="http://www.shaneharvie.com/feeds/posts/default" htmlUrl="http://www.shaneharvie.com/"/>
            <outline text="BenCurtis.com" title="BenCurtis.com"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/bencurtis" htmlUrl="http://www.bencurtis.com"/>
            <outline text="Binary Code" title="Binary Code" type="rss"
                xmlUrl="http://www.postal-code.com/binarycode/feed/atom/" htmlUrl="http://www.postal-code.com/binarycode"/>
            <outline text="Biodegradable Geek"
                title="Biodegradable Geek" type="rss"
                xmlUrl="http://feeds.feedburner.com/BiodegradableGeek" htmlUrl="http://biodegradablegeek.com"/>
            <outline text="bitfluent" title="bitfluent" type="rss"
                xmlUrl="http://feeds.feedburner.com/bitfluent" htmlUrl="http://blog.bitfluent.com/"/>
            <outline text="bl.ogtastic - Home"
                title="bl.ogtastic - Home" type="rss"
                xmlUrl="http://b.logi.cx/feed/atom.xml" htmlUrl="http://b.logi.cx/"/>
            <outline text="BlogFish - Blog" title="BlogFish - Blog"
                type="rss"
                xmlUrl="http://blog.innerewut.de/feed/atom.xml" htmlUrl="http://blog.innerewut.de/"/>
            <outline text="Bloggitation - Home"
                title="Bloggitation - Home" type="rss"
                xmlUrl="http://blog.zhekov.net/feed/atom.xml" htmlUrl="http://blog.zhekov.net/"/>
            <outline text="Brainspl.at" title="Brainspl.at" type="rss"
                xmlUrl="http://brainspl.at/xml/rss20/feed.xml" htmlUrl="http://brainspl.at/"/>
            <outline text="BrightBlog" title="BrightBlog" type="rss"
                xmlUrl="http://feeds.feedburner.com/Brightblog" htmlUrl="http://blog.brightbox.co.uk"/>
            <outline
                text="Bruce Williamsâ€”Ruby, Rails, and Design - Home"
                title="Bruce Williamsâ€”Ruby, Rails, and Design - Home"
                type="rss" xmlUrl="http://codefluency.com/feed/atom.xml" htmlUrl="http://codefluency.com/"/>
            <outline text="BuildingWebApps Articles"
                title="BuildingWebApps Articles" type="rss"
                xmlUrl="http://feeds.feedburner.com/buildingwebappsarticles" htmlUrl="/feeds/articles"/>
            <outline text="cfis" title="cfis" type="rss"
                xmlUrl="http://cfis.savagexi.com/xml/atom/feed.xml" htmlUrl="http://cfis.savagexi.com"/>
            <outline text="chris blogs" title="chris blogs" type="rss"
                xmlUrl="http://chneukirchen.org/blog/index.rss" htmlUrl="http://chneukirchen.org/blog"/>
            <outline text="coderrr" title="coderrr" type="rss"
                xmlUrl="http://coderrr.wordpress.com/feed/" htmlUrl="http://coderrr.wordpress.com"/>
            <outline text="Cody Fauser - Show all"
                title="Cody Fauser - Show all" type="rss"
                xmlUrl="http://feeds.feedburner.com/codyfauser" htmlUrl="http://www.codyfauser.com/"/>
            <outline text="Comments on: Bort - A Base Rails Application"
                title="Comments on: Bort - A Base Rails Application"
                type="rss"
                xmlUrl="http://jimneath.org/2008/09/09/bort-base-rails-application/feed/" htmlUrl="http://jimneath.org/2008/09/09/bort-base-rails-application/"/>
            <outline text="Continuous Thinking - Home"
                title="Continuous Thinking - Home" type="rss"
                xmlUrl="http://www.continuousthinking.com/feed/atom.xml" htmlUrl="http://continuousthinking.com/"/>
            <outline text="CrazyRails ~ Flex on Ruby on Rails"
                title="CrazyRails ~ Flex on Ruby on Rails" type="rss"
                xmlUrl="http://crazyrails.com/feed/atom/" htmlUrl="http://crazyrails.com/"/>
            <outline text="Dan Grigsby" title="Dan Grigsby" type="rss"
                xmlUrl="http://www.unpossible.com/feed/" htmlUrl="http://www.unpossible.com"/>
            <outline text="Dan Manges" title="Dan Manges" type="rss"
                xmlUrl="http://feeds.feedburner.com/dcmanges" htmlUrl="http://www.dcmanges.com/blog"/>
            <outline text="Daniel Fischer - Got Fisch?"
                title="Daniel Fischer - Got Fisch?" type="rss"
                xmlUrl="http://feeds.feedburner.com/Danielfischer" htmlUrl="http://www.danielfischer.com"/>
            <outline text="Darwinweb" title="Darwinweb" type="rss"
                xmlUrl="http://feeds.feedburner.com/darwinweb" htmlUrl="http://darwinweb.net/"/>
            <outline text="delynn - Home" title="delynn - Home"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/delynnberry" htmlUrl="http://delynnberry.com/"/>
            <outline text="Depixelate - Home" title="Depixelate - Home"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/depixelate" htmlUrl="http://www.depixelate.com/"/>
            <outline
                text="DEV_MEM.dump_to(:blog) - Multimedia systems blog"
                title="DEV_MEM.dump_to(:blog) - Multimedia systems blog"
                type="rss" xmlUrl="http://blog.mmediasys.com/feed/atom/" htmlUrl="http://blog.mmediasys.com/"/>
            <outline text="DevChix" title="DevChix" type="rss"
                xmlUrl="http://feeds.feedburner.com/devchix/QbOG" htmlUrl="http://www.devchix.com"/>
            <outline text="DevFi :" title="DevFi :" type="rss"
                xmlUrl="http://devfi.com/articles.atom" htmlUrl="http://devfi.com"/>
            <outline text="Dr Nic" title="Dr Nic" type="rss"
                xmlUrl="http://feeds.feedburner.com/DrNic" htmlUrl="http://drnicwilliams.com"/>
            <outline text="dweebd" title="dweebd" type="rss"
                xmlUrl="http://feeds.feedburner.com/dweebd" htmlUrl="http://www.dweebd.com"/>
            <outline text="EdgeCase - Home" title="EdgeCase - Home"
                type="rss" xmlUrl="http://feeds.feedburner.com/edgecase" htmlUrl="http://blog.edgecase.com/"/>
            <outline text="Ed's Elite blog" title="Ed's Elite blog"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/EdSpencer" htmlUrl="http://edspencer.net/"/>
            <outline text="eigenclass" title="eigenclass" type="rss"
                xmlUrl="http://eigenclass.org/hiki.rb?c=rss;tags=blog" htmlUrl="http://eigenclass.org"/>
            <outline text="El Humidor" title="El Humidor" type="rss"
                xmlUrl="http://feeds.feedburner.com/ElHumidor" htmlUrl="http://elhumidor.blogspot.com/"/>
            <outline text="EleventyTen - Home"
                title="EleventyTen - Home" type="rss"
                xmlUrl="http://blog.eleventyten.com/feed/atom.xml" htmlUrl="http://blog.eleventyten.com"/>
            <outline text="Ereblog" title="Ereblog" type="rss"
                xmlUrl="http://www.erebor.com/feed/" htmlUrl="http://www.erebor.com"/>
            <outline text="Err the Blog - Home"
                title="Err the Blog - Home" type="rss"
                xmlUrl="http://feeds.feedburner.com/errtheblog" htmlUrl="http://errtheblog.com/"/>
            <outline text="Euruko 2009 Barcelona 9-10 May"
                title="Euruko 2009 Barcelona 9-10 May" type="rss"
                xmlUrl="http://euruko2009.org/rss" htmlUrl="http://euruko2009.org"/>
            <outline text="evan.musing" title="evan.musing" type="rss"
                xmlUrl="http://blog.fallingsnow.net/feed/" htmlUrl="http://blog.fallingsnow.net"/>
            <outline text="Fair Answers" title="Fair Answers" type="rss"
                xmlUrl="http://www.blog.fairanswers.com/?feed=rss2" htmlUrl="http://www.blog.fairanswers.com"/>
            <outline text="fairleads" title="fairleads" type="rss"
                xmlUrl="http://fairleads.blogspot.com/feeds/posts/default" htmlUrl="http://fairleads.blogspot.com/"/>
            <outline text="five pound app" title="five pound app"
                type="rss" xmlUrl="http://fivepoundapp.com/meetup/next/" htmlUrl="http://fivepoundapp.com/"/>
            <outline text="FiveRuns Blog - Home"
                title="FiveRuns Blog - Home" type="rss"
                xmlUrl="http://blog.fiveruns.com/feed/atom.xml" htmlUrl="http://blog.fiveruns.com/"/>
            <outline text="Free Ruby and Rails Screencasts"
                title="Free Ruby and Rails Screencasts" type="rss"
                xmlUrl="http://feeds.feedburner.com/rubyplus" htmlUrl="http://www.rubyplus.org/episodes.rss"/>
            <outline text="Freelancing Gods" title="Freelancing Gods"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/freelancing_gods" htmlUrl="http://freelancing-gods.com"/>
            <outline text="geek!daily" title="geek!daily" type="rss"
                xmlUrl="http://feeds.feedburner.com/geekdailyblog" htmlUrl="http://blog.geekdaily.org/"/>
            <outline text="Geoff Evason" title="Geoff Evason" type="rss"
                xmlUrl="http://feeds.feedburner.com/GeoffEvason" htmlUrl="http://geoff.evason.name"/>
            <outline
                text="GIANT ROBOTS SMASHING INTO OTHER GIANT ROBOTS - Home"
                title="GIANT ROBOTS SMASHING INTO OTHER GIANT ROBOTS - Home"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/GiantRobotsSmashingIntoOtherGiantRobots" htmlUrl="http://giantrobots.thoughtbot.com/"/>
            <outline text="Giles Bowkett" title="Giles Bowkett"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/gilesbowkett" htmlUrl="http://gilesbowkett.blogspot.com/"/>
            <outline text="Gluttonous" title="Gluttonous" type="rss"
                xmlUrl="http://feeds.feedburner.com/Gluttonous" htmlUrl="http://glu.ttono.us/"/>
            <outline text="Grasp Ruby on Rails - Blog"
                title="Grasp Ruby on Rails - Blog" type="rss"
                xmlUrl="http://grasprubyonrails.com/feed/atom.xml" htmlUrl="http://grasprubyonrails.com/"/>
            <outline text="GrokBlok - Home" title="GrokBlok - Home"
                type="rss" xmlUrl="http://feeds.feedburner.com/grokblok" htmlUrl="http://www.google.com/reader/view/feed%2Fhttp%3A%2F%2Ffeeds.feedburner.com%2Fgrokblok"/>
            <outline text="gurge.com" title="gurge.com" type="rss"
                xmlUrl="http://gurge.com/blog/feed/" htmlUrl="http://gurge.com/blog"/>
            <outline text="Hampton Catlin - Home"
                title="Hampton Catlin - Home" type="rss"
                xmlUrl="http://hamptoncatlin.com/feed/atom.xml" htmlUrl="http://hamptoncatlin.com/"/>
            <outline
                text="has_many :bugs, :through =&amp;gt; :rails - Home"
                title="has_many :bugs, :through =&amp;gt; :rails - Home"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/monkeyonrails" htmlUrl="http://m.onkey.org/"/>
            <outline text="has_many :through - home"
                title="has_many :through - home" type="rss"
                xmlUrl="http://feeds.feedburner.com/hasmanythrough" htmlUrl="http://blog.hasmanythrough.com"/>
            <outline text="Headius" title="Headius" type="rss"
                xmlUrl="http://headius.blogspot.com/feeds/posts/default" htmlUrl="http://blog.headius.com/"/>
            <outline text="Headius" title="Headius" type="rss"
                xmlUrl="http://blog.headius.com/feeds/posts/default" htmlUrl="http://blog.headius.com/"/>
            <outline text="Heroku News" title="Heroku News" type="rss"
                xmlUrl="http://feeds.feedburner.com/heroku" htmlUrl="http://blog.heroku.com"/>
            <outline text="HeyCarsten - Home" title="HeyCarsten - Home"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/heycarsten" htmlUrl="http://heycarsten.com/"/>
            <outline text="HickoryTech" title="HickoryTech" type="rss"
                xmlUrl="http://tech.hickorywind.org/articles.rss" htmlUrl="http://tech.hickorywind.org/articles.rss"/>
            <outline text="Hungry Machine Blog - All"
                title="Hungry Machine Blog - All" type="rss"
                xmlUrl="http://feeds.feedburner.com/hungrymachine" htmlUrl="http://blog.hungrymachine.com"/>
            <outline text="igvita.com" title="igvita.com" type="rss"
                xmlUrl="http://feeds.feedburner.com/igvita" htmlUrl="http://www.igvita.com"/>
            <outline text="In the Key of E" title="In the Key of E"
                type="rss"
                xmlUrl="https://blogs.oracle.com/emononen/feed/entries/atom?cat=%2FNetBeans" htmlUrl="https://blogs.oracle.com/emononen/"/>
            <outline text="interblah.net - blog"
                title="interblah.net - blog" type="rss"
                xmlUrl="http://interblah.net/feed.xml" htmlUrl="http://www.google.com/reader/view/feed%2Fhttp%3A%2F%2Finterblah.net%2Ffeed.xml"/>
            <outline text="Intridea - Blog" title="Intridea - Blog"
                type="rss"
                xmlUrl="http://www.intridea.com/feed/blog/atom.xml" htmlUrl="http://www.intridea.com/blog/company"/>
            <outline text="Inventive Labs: Weblog"
                title="Inventive Labs: Weblog" type="rss"
                xmlUrl="http://feeds.feedburner.com/inventivelabs-weblog" htmlUrl="http://www.google.com/reader/view/feed%2Fhttp%3A%2F%2Ffeeds.feedburner.com%2Finventivelabs-weblog"/>
            <outline text="Irene Ros - Blog" title="Irene Ros - Blog"
                type="rss"
                xmlUrl="http://ireneros.com/atom/?section=Blog" htmlUrl="http://ireneros.com/"/>
            <outline text="Jake Scruggs" title="Jake Scruggs" type="rss"
                xmlUrl="http://jakescruggs.blogspot.com/feeds/posts/default" htmlUrl="http://jakescruggs.blogspot.com/"/>
            <outline text="James on Software - Home"
                title="James on Software - Home" type="rss"
                xmlUrl="http://feeds.feedburner.com/JamesOnSoftware" htmlUrl="http://jamesgolick.com/"/>
            <outline text="Jason Seifer" title="Jason Seifer" type="rss"
                xmlUrl="http://jasonseifer.com/feed" htmlUrl="http://jasonseifer.com"/>
            <outline text="Jay Fields Thoughts"
                title="Jay Fields Thoughts" type="rss"
                xmlUrl="http://blog.jayfields.com/feeds/posts/default" htmlUrl="http://blog.jayfields.com/"/>
            <outline text="jeremydurham.com" title="jeremydurham.com"
                type="rss"
                xmlUrl="http://www.jeremydurham.com/wordpress/wp-rss2.php" htmlUrl="http://www.jeremydurham.com"/>
            <outline text="Jicksta.com" title="Jicksta.com" type="rss"
                xmlUrl="http://feeds.feedburner.com/jicksta" htmlUrl="http://jicksta.com"/>
            <outline text="jlaine.net - Home" title="jlaine.net - Home"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/jlainenet" htmlUrl="http://jlaine.net/"/>
            <outline text="John Lam on Software"
                title="John Lam on Software" type="rss"
                xmlUrl="http://feeds.feedburner.com/LessIsBetter" htmlUrl="http://www.iunknown.com/"/>
            <outline text="Jonathan.inspect" title="Jonathan.inspect"
                type="rss"
                xmlUrl="http://jonathan.tron.name/articles.atom" htmlUrl="http://jonathan.tron.name"/>
            <outline text="Journal" title="Journal" type="rss"
                xmlUrl="http://www.rorsecurity.info/journal/atom.xml" htmlUrl="http://www.rorsecurity.info/journal/"/>
            <outline text="Juixe TechKnow" title="Juixe TechKnow"
                type="rss"
                xmlUrl="http://www.juixe.com/techknow/index.php/feed/atom/" htmlUrl="http://www.juixe.com/techknow"/>
            <outline text="Koz Speaks - Home" title="Koz Speaks - Home"
                type="rss" xmlUrl="http://feeds.feedburner.com/Koz" htmlUrl="http://www.koziarski.net/"/>
            <outline text="LakTEK" title="LakTEK" type="rss"
                xmlUrl="http://feeds.feedburner.com/laktek-blog" htmlUrl="http://www.web2media.net/laktek"/>
            <outline text="Learning Rails" title="Learning Rails"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/learning-rails" htmlUrl="http://www.learningrails.com/"/>
            <outline text="Libin Pan" title="Libin Pan" type="rss"
                xmlUrl="http://feeds.feedburner.com/LibinPan" htmlUrl="http://blog.libinpan.com"/>
            <outline text="LiquidRail - Rails"
                title="LiquidRail - Rails" type="rss"
                xmlUrl="http://liquidrail.com/feed/atom.xml" htmlUrl="http://liquidrail.com/"/>
            <outline text="Loud Thinking by David Heinemeier Hansson"
                title="Loud Thinking by David Heinemeier Hansson"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/LoudThinking" htmlUrl="http://www.loudthinking.com/"/>
            <outline text="Luca Guidi - Home" title="Luca Guidi - Home"
                type="rss"
                xmlUrl="http://www.lucaguidi.com/feed/atom.xml" htmlUrl="http://lucaguidi.com/"/>
            <outline text="Lucky Sneaks - Blog"
                title="Lucky Sneaks - Blog" type="rss"
                xmlUrl="http://feeds.feedburner.com/luckysneaks" htmlUrl="/blog"/>
            <outline text="Magnus Holm" title="Magnus Holm" type="rss"
                xmlUrl="http://feeds.feedburner.com/MagnusHolm" htmlUrl="http://judofyr.net/"/>
            <outline text="Marc-Andre Cournoyer's Awesome Feed"
                title="Marc-Andre Cournoyer's Awesome Feed" type="rss"
                xmlUrl="http://macournoyer.com/blog.atom" htmlUrl="http://macournoyer.com"/>
            <outline text="Marc-AndrÃ© Cournoyer's blog"
                title="Marc-AndrÃ© Cournoyer's blog" type="rss"
                xmlUrl="http://macournoyer.wordpress.com/feed/" htmlUrl="http://macournoyer.wordpress.com"/>
            <outline text="MarcRic Blog" title="MarcRic Blog" type="rss"
                xmlUrl="http://marcricblog.blogspot.com/feeds/posts/default" htmlUrl="http://marcricblog.blogspot.com/"/>
            <outline text="Martin's Blog" title="Martin's Blog"
                type="rss"
                xmlUrl="https://blogs.oracle.com/martink/feed/entries/rss" htmlUrl="https://blogs.oracle.com/martink/"/>
            <outline text="Matt, MS" title="Matt, MS" type="rss"
                xmlUrl="http://feeds.feedburner.com/MattMs" htmlUrl="http://blog.matt-darby.com"/>
            <outline text="Meme Agora" title="Meme Agora" type="rss"
                xmlUrl="http://memeagora.blogspot.com/feeds/posts/default" htmlUrl="http://memeagora.blogspot.com/"/>
            <outline text="Mental Paging Space"
                title="Mental Paging Space" type="rss"
                xmlUrl="http://mentalpagingspace.blogspot.com/feeds/posts/default" htmlUrl="http://mentalpagingspace.blogspot.com/"/>
            <outline text="Midnight Oil" title="Midnight Oil" type="rss"
                xmlUrl="http://feeds.feedburner.com/aisleten/blog" htmlUrl="http://blog.aisleten.com"/>
            <outline text="Mike Clark" title="Mike Clark" type="rss"
                xmlUrl="http://www.clarkware.com/cgi/blosxom/index.rss" htmlUrl="http://www.clarkware.com/cgi/blosxom"/>
            <outline text="mikhailian" title="mikhailian" type="rss"
                xmlUrl="http://mikhailian.livejournal.com/data/atom" htmlUrl="http://mikhailian.livejournal.com/"/>
            <outline text="Mister Bleigh - Blog"
                title="Mister Bleigh - Blog" type="rss"
                xmlUrl="http://feeds.feedburner.com/mbleigh/" htmlUrl="http://www.mbleigh.com/"/>
            <outline
                text="Mr. Matt - Ruby on Rails Developer, Manchester UK"
                title="Mr. Matt - Ruby on Rails Developer, Manchester UK"
                type="rss" xmlUrl="http://matthall.wordpress.com/feed/" htmlUrl="http://matthall.wordpress.com"/>
            <outline text="Mutually Human Software - Blog"
                title="Mutually Human Software - Blog" type="rss"
                xmlUrl="http://www.mutuallyhuman.com/feed/blog/atom.xml" htmlUrl="http://mutuallyhuman.com/blog"/>
            <outline
                text="nano RAILS: development, testing and hosting tidbits - Home"
                title="nano RAILS: development, testing and hosting tidbits - Home"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/Nanorails" htmlUrl="http://blog.nanorails.com/"/>
            <outline text="NetBeans Wiki: RubyOnRails"
                title="NetBeans Wiki: RubyOnRails" type="rss"
                xmlUrl="http://wiki.netbeans.org/wiki/rss.jsp?page=RubyOnRails&amp;mode=wiki" htmlUrl="http://wiki.netbeans.org/"/>
            <outline text="Neverintheoffice.net - Home"
                title="Neverintheoffice.net - Home" type="rss"
                xmlUrl="http://neverintheoffice.net/feed/atom.xml" htmlUrl="http://neverintheoffice.net/"/>
            <outline text="Nimble Method" title="Nimble Method"
                type="rss" xmlUrl="http://feeds.feedburner.com/pluron" htmlUrl="http://blog.pluron.com/"/>
            <outline text="Nobody Listens Anyway"
                title="Nobody Listens Anyway" type="rss"
                xmlUrl="http://www.justinball.com/feed/" htmlUrl="http://www.justinball.com"/>
            <outline text="Not So Stupid" title="Not So Stupid"
                type="rss" xmlUrl="http://www.notsostupid.com/feed/" htmlUrl="http://www.notsostupid.com"/>
            <outline text="Notch8" title="Notch8" type="rss"
                xmlUrl="http://www.notch8.com/xml/atom/feed.xml" htmlUrl="http://www.notch8.com"/>
            <outline text="Nuby on Rails" title="Nuby on Rails"
                type="rss"
                xmlUrl="http://feeds.feedburner.com/nubyonrails" htmlUrl="http://nubyonrails.com"/>
            <outline text="Nuby on Rails" title="Nuby on Rails"
                type="rss"
                xmlUrl="http://nubyonrails.topfunky.com/xml/atom/feed.xml" htmlUrl="http://nubyonrails.com"/>
            <outline text="Nullcreations - Recent Entries"
                title="Nullcreations - Recent Entries" type="rss" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T19:25:00.827

我关注[http://weblog.rubyonrails.org](http://weblog.rubyonrails.org)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T22:13:37.350

我曾经关注过很多 Rails 博客，但最近我每天只访问[Planet Ruby on Rails](http://www.planetrubyonrails.com/)几次。还有一个@rornews Twitter 帐户定期发布有趣的链接。

# flash - Flash：下载对话框

> ID：603611
> 
> 赞同：1
> 
> 时间：2009-03-02T19:23:03.720
> 
> 标签：flash, actionscript-3, download

当用户单击包含应下载图像的某个链接时，客户端希望出现一个对话框。

目前我们压缩了可下载的文件，但除了 javascript 正确（或 flash 10 文件引用类）之外，没有其他方法可以实现这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T19:27:24.440

我不这么认为。你看过[`FileReference`](http://livedocs.adobe.com/flex/3/langref/flash/net/FileReference.html)类，特别是[`download()`](http://livedocs.adobe.com/flex/3/langref/flash/net/FileReference.html#download())成员函数吗？此外，[此](http://livedocs.adobe.com/flex/3/html/17_Networking_and_communications_7.html)链接可能很重要。您面临哪些问题（如果有）`FileReference`？

# osgi - iPOJO：为什么 InstanceManager 的 getPojoObject() 会返回 null？

> ID：603618
> 
> 赞同：0
> 
> 时间：2009-03-02T19:25:10.080
> 
> 标签：osgi

我正在使用 Felix OSGi iPOJO 库，并且我正在以编程方式访问工厂以创建 ComponentInstances。我在这里阅读了代码：

[http://svn.apache.org/viewvc/felix/trunk/ipojo/core/src/main/java/org/apache/felix/ipojo/InstanceManager.java?view=markup](http://svn.apache.org/viewvc/felix/trunk/ipojo/core/src/main/java/org/apache/felix/ipojo/InstanceManager.java?view=markup)

试图弄清楚为什么我对 getPojoObject() 的调用返回 null。

我的问题是 getPojoObject() 方法在什么条件下可以返回 null？

编辑：我想我明白我现在在问什么 - 正如 TofuBeer 指出的那样，它在 JavaDoc 中说，只要在实例化对象时遇到任何问题，它就可以返回 null - 这不是一个有用的返回值，以及它被处理隐藏了真正的错误是什么。谢谢你的眼睛，TofuBeer，这让我发疯了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T19:45:35.910

随时查看代码

```
private Object createObject() 
```

返回 null 然后 getPojoObject 将返回 null。

对于返回 null 的每种情况，createObject 方法都有合理的注释/错误消息。

你的问题还有更多吗？例如，您是否让它返回 null 并试图找出原因？

# sql - 我需要数据库中的最高 ID。我这样做对吗？

> ID：603619
> 
> 赞同：-1
> 
> 时间：2009-03-02T19:25:19.110
> 
> 标签：sql, asp-classic

```
 set qv = createobject("adodb.recordset")
q ="select * from tbl order by ID"
qv.open q,QuoteConn,3,1,1
    qv.movelast
    qid=qv("ID")
qv.close 
```

编辑：

哇，你们都把这个笑话杀了。在 2009 年，我正在维护这段代码......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T19:26:55.097

MAX(id) 呢？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T19:30:33.873

是的，但尽可能以最慢的方式。

不仅如此，你的前提是错误的。 **您*不需要*从数据库中获取最高 ID。**

我的精神调试能力告诉我，你将使用它来创建一个新 ID，并将该 ID 插入到带有新记录的数据库中。这完全是错误的做法，并且会导致您网站上的代码出现竞争条件。相反，将您的 ID 设置为 Identity 列并让 Sql Server 自动创建您的 ID。`scope_identity()`然后使用 Sql Server 的函数在插入后选择新的 ID 回到你的结果中。

即使我错了，您只是想用它来检索最近的记录，您真正想要的可能是`scope_identity()`（如果您只是在同一会话中创建新记录）或`ident_current(tbl)`（如果新记录是可能是由其他人创建的或前一段时间创建的）。在最后一种情况下，你真的应该有其他方法而不是 ID 来确定什么是“最新的”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T19:27:25.457

一个更快的方法是

q="从 tbl 中选择 max(ID)"

这将始终导致具有一个值（具有最高 id）的单行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T19:27:33.600

如果您觉得古怪，您还可以颠倒 SQL 顺序并选择最上面的那个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T19:27:56.593

我不知道您对 SQL 的特殊风格，但在许多情况下您可以这样做：

q="select * from tbl where ID = (select max(b.ID) from tbl b)"

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T19:30:54.557

其他答案是正确的，我只是建议您给它一个别名，以便您可以访问它：

```
select max(ID) as "maxID" from tbl
...
qid = qv("maxID") 
```

# c# - 如何自定义 FreeTextBox 菜单？

> ID：603624
> 
> 赞同：0
> 
> 时间：2009-03-02T19:26:44.007
> 
> 标签：c#, asp.net, freetextbox

我想在 ASPX 页面上自定义我的 FreeTextBox (FTB) 控件的菜单。如何从中添加/删除元素？我还想启用它的拼写检查功能。任何帮助/参考将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T03:28:57.247

供其他人参考...您可以使用用于创建工具栏的按钮字符串来设置 FTB 的 ToolbarLayout 属性。使用逗号 (,) 分隔项目。管道 (|) 将插入分隔符

```
<FTB:FreeTextBox ID="FTB1" runat="server" Width="100%" Height="280px"
                    ToolbarLayout="ParagraphMenu, Bold, Italic, Underline, Strikethrough, CreateLink, Unlink, RemoveFormat, JustifyLeft, JustifyRight, JustifyCenter, JustifyFull, BulletedList, NumberedList, Indent, Outdent, Cut, Copy, Paste, Undo, Redo, ieSpellCheck">
</FTB:FreeTextBox> 
```

拼写检查是通过 ieSpell 完成的，它不适用于 firefox。目前正在寻找 NetSpell 的拼写检查功能。

# javascript - 如何——回调函数

> ID：603627
> 
> 赞同：0
> 
> 时间：2009-03-02T19:26:56.877
> 
> 标签：javascript, jquery, callback

我在使用 JS/jQuery 编写一小段代码时遇到了一个大问题（不知道是哪一个导致了问题）。无论如何，我们开始：

```
$('#themePicker').unbind().click(function() {
    var t = $(this);    
    modalwindow2(t, function() {
        console.log(1);
    }, function(w) {
        console.log(w);
    });

    return false;
}); 
```

和函数本身：

```
function modalwindow2(w, callbackOnSHow, callbackOnHide) {
    if (typeof(callbackOnSHow) == 'function') {
        callbackOnSHow.call();
    }

    // do some stuff //
    $('form').submit(function() {
        ajaxSubmit(function(data) {
            if (typeof(callbackOnHide) == 'function') {
                console.log('---------------');
                console.log(data);
                console.log('---------------');
                callbackOnHide.call(data);
            }
        });

        return false
    });
} 
```

该函数被调用`modalwindow2`，我想在显示模态时调用一个函数，在隐藏模态时调用另一个函数。

第一个不是问题。

第二个......嗯......我们只是说这是一个问题。为什么？

我想要一个参数发送到第二个函数。参数是一个 ajax 响应，类似于其他 jQuery 东西（ajax 操作、可排序等）。

我希望我说得够清楚。

谢谢！

编辑：

我正在使用 jQuery 1.1.2（或 1.1.3）并且升级或使用 jQuery UI 不是解决方案。我有一些依赖项（界面就是其中之一），我没有足够的时间（也没有动力）升级到 1.3 和 UI 1.7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T19:35:45.467

我了解您要做什么，但是您需要存储新创建的窗口，以便您可以在关闭回调函数中访问它。

您可能想查看[jQuery UI Dialog](http://docs.jquery.com/UI/Dialog)。它为对话框窗口（模态和其他）提供了一些非常基本的功能，并处理一些回调实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T19:58:15.740

我注意到您在 .submit 上有一个错字： **$('form').submti(function(){**

这只是 SO 的输入错误吗？

编辑：好的，所以在查看您的代码并进行简短测试之后，我想出了**这个**（请原谅双关语）：

```
function modalwindow2(w, callbackOnShow, callbackOnHide) {
    if(typeof callbackOnShow == 'function') {
        callbackOnShow.call();
    }
    $('form').submit(function() {
        if(typeof callbackOnHide == 'function') {
            callbackOnHide.call(this, "second");
        }
    });
}

$(document).ready(function (){
    $('#themePicker').click(function(){
        var t=$(this);
        modalwindow2(t, function() { alert("first"); }, function(x) { alert(x); });
        return false;
    });
}); 
```

看起来您可能只是在 call() 语句中丢失了“this”。尝试使用 callbackOnHide.call(this, data);

让我知道这是否更好！

# c# - 如何利用xml节点的Tags属性来获取它的信息和属性？

> ID：603640
> 
> 赞同：0
> 
> 时间：2009-03-02T19:28:00.853
> 
> 标签：c#, xml, winforms, xml-attribute

如何使用节点的 Tags 属性，以便获取 xml 节点的属性？

我必须在 Windows 窗体中显示 xml 树。当我单击任何节点时，它的属性应该以相同的形式显示在列表框中。

我想使用 tags 属性，但我需要将表单中的树节点转换为 xml 节点。我想将树节点存储在标签中，然后将该标签类型转换为 xml 节点。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T19:34:25.970

添加 TreeNode 类时，您的代码将如下所示：

```
// Create the node.
TreeNode newNode = new TreeNode();

// Configure.
...

// Set the tag property to hold the XML element.
XmlElement currentElement = ...;
newNode.Tag = currentElement;

// Add to the tree view.
... 
```

然后，当您拥有树视图节点时，您将获得如下元素：

```
TreeNode currentNode = ...;

// Get the XmlElement.
XmlElement currentElement = (XmlElement) currentNode.Tag;

// Process the element.
... 
```

# python - 在 Python 生成器中使用 for...else

> ID：603641
> 
> 赞同：9
> 
> 时间：2009-03-02T19:28:09.930
> 
> 标签：python, syntax, for-loop, generator, yield

我是 Python 的[for...else 语法](http://docs.python.org/reference/compound_stmts.html#the-for-statement)的忠实拥护者——令人惊讶的是它的适用频率以及简化代码的效率。

但是，我还没有想出在生成器中使用它的好方法，例如：

```
def iterate(i):
    for value in i:
        yield value
    else:
        print 'i is empty' 
```

在上面的示例中，我希望仅当为空`print`时才执行该语句。`i`但是，`else`仅考虑`break`和`return`，它总是被执行，而不管 的长度`i`。

如果不可能以`for...else`这种方式使用，那么最好的方法是什么，以便`print`仅在没有产生任何内容时执行该语句？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-02T19:32:18.207

您正在破坏生成器的定义，它应该在迭代完成时引发 StopIteration 异常（由生成器函数中的 return 语句自动处理）

所以：

```
def iterate(i):
    for value in i:
        yield value
    return 
```

最好让调用代码处理空迭代器的情况：

```
count = 0
for value in iterate(range([])):
    print value
    count += 1
else:
    if count == 0:
        print "list was empty" 
```

可能是执行上述操作的一种更清洁的方法，但这应该可以正常工作，并且不会落入下面任何常见的“将迭代器视为列表”陷阱。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-02T19:44:40.967

有几种方法可以做到这一点。你总是可以`Iterator`直接使用：

```
def iterate(i):
    try:
        i_iter = iter(i)
        next = i_iter.next()
    except StopIteration:
        print 'i is empty'
        return

    while True:
        yield next
        next = i_iter.next() 
```

但是，如果您对参数的期望有更多了解`i`，则可以更简洁：

```
def iterate(i):
    if i:  # or if len(i) == 0
        for next in i:
            yield next
    else:
        print 'i is empty'
        raise StopIteration() 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-02T20:45:06.970

总结一些较早的答案，可以这样解决：

```
def iterate(i):
    empty = True
    for value in i:
        yield value
        empty = False

    if empty:
        print "empty" 
```

所以确实没有涉及“其他”条款。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-12-31T13:43:55.440

如您所述，`for..else`仅检测到`break`. 所以它只适用于你寻找东西然后**停止**的时候。

它不适用于您的目的，不是因为它是生成器，而是**因为您想处理所有元素，而不停止**（因为您想全部生成它们，但这不是重点）。

不管是否生成器，你真的需要一个布尔值，就像 Ber 的解决方案一样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T20:16:42.263

> > 如果无法以这种方式使用 for...else，那么最好的方法是什么，以便仅在没有产生任何内容时执行 print 语句？

我能想到的最大值：

```
 >>> empty = True
>>> for i in [1,2]:
...     empty = False
... if empty:
...     print 'empty'
...
>>>
>>>
>>> empty = True
>>> for i in []:
...     empty = False
... if empty:
...    print 'empty'
...
empty
>>> 

```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-03-02T19:36:27.367

简单的 if-else 怎么样？

```
def iterate(i):
    if len(i) == 0: print 'i is empty'
    else:
        for value in i:
            yield value 
```

# php - 如何在生成 PDF 时将 Google 地图（或其他 GIS 地图）输出嵌入到 PDF 中？

> ID：603644
> 
> 赞同：5
> 
> 时间：2009-03-02T19:30:13.747
> 
> 标签：php, pdf, gis

我需要在服务器端生成 PDF 文档，其中包括地图、标记等，但据我所知，由于 JavaScript 依赖，谷歌地图无法做到这一点。

是否有某种方法可以为此使用 Google Maps API，或者是否有其他具有此功能和类似功能的免费（或便宜）替代品？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-02T19:32:59.547

你可以做的是使用谷歌地图静态api生成图像： [http ://code.google.com/apis/maps/documentation/staticmaps/](http://code.google.com/apis/maps/documentation/staticmaps/)

然后将该图像导入pdf。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T19:39:55.847

扩展到dusoft的答案。您可以使用 Imagick 加载图像和

```
$im = new Imagick("image.jpg");
$im->setImageFormat("pdf");
$im->writeImage("image.pdf"); 
```

# c# - 使用 Linq 将 facebook 个人资料与我的用户信息映射

> ID：603650
> 
> 赞同：3
> 
> 时间：2009-03-02T19:32:14.337
> 
> 标签：c#, linq, facebook

在阅读了一本关于 LINQ 的书后，我正在考虑重新编写一个我用 c# 编写的映射器类以使用 LINQ。我想知道是否有人可以帮我一把。注意：这有点令人困惑，但 User 对象是本地用户，而 user（小写）是从 Facebook XSD 生成的对象。

**原始映射器**

```
public class FacebookMapper : IMapper
{
    public IEnumerable<User> MapFrom(IEnumerable<User> users)
    {
      var facebookUsers = GetFacebookUsers(users);
      return MergeUsers(users, facebookUsers);
    }

    public Facebook.user[] GetFacebookUsers(IEnumerable<User> users)
    {
      var uids = (from u in users
        where u.FacebookUid != null
        select u.FacebookUid.Value).ToList();

      // return facebook users for uids using WCF
    }

    public IEnumerable<User> MergeUsers(IEnumerable<User> users, Facebook.user[] facebookUsers)
    {
      foreach(var u in users)
      {
        var fbUser = facebookUsers.FirstOrDefault(f => f.uid == u.FacebookUid);
        if (fbUser != null)
          u.FacebookAvatar = fbUser.pic_sqare;
      }
      return users;
    }
} 
```

我的前两次尝试碰壁了

**尝试 1**

```
public IEnumerable<User> MapFrom(IEnumerable<User> users)
{
  // didn't have a way to check if u.FacebookUid == null
  return from u in users
    join f in GetFacebookUsers(users) on u.FacebookUid equals f.uid
    select AppendAvatar(u, f);
}

public void AppendAvatar(User u, Facebook.user f)
{
  if (f == null)
    return u;
  u.FacebookAvatar = f.pic_square;
  return u;
} 
```

**尝试 2**

```
public IEnumerable<User> MapFrom(IEnumerable<User> users)
{
  // had to get the user from the facebook service for each single user,
  // would rather use a single http request.
  return from u in users
    let f = GetFacebookUser(user.FacebookUid)
    select AppendAvatar(u, f);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-01T19:28:06.250

好的，目前尚不清楚其中的确切内容`IMapper`，但我会提出一些建议，其中一些可能由于其他限制而不可行。我已经按照我的想法写了这个 - 我认为这有助于看到思路在行动，因为这会让你下次更容易做同样的事情。（当然，假设您喜欢我的解决方案：）

LINQ 本质上是函数式的。这意味着理想情况下，查询不应该有副作用。例如，我期望一个带有以下签名的方法：

```
public IEnumerable<User> MapFrom(IEnumerable<User> users) 
```

返回具有额外信息的新用户对象序列，而不是改变现有用户。您当前添加的唯一信息是头像，因此我将添加一个方法，`User`如下所示：

```
public User WithAvatar(Image avatar)
{
    // Whatever you need to create a clone of this user
    User clone = new User(this.Name, this.Age, etc);
    clone.FacebookAvatar = avatar;
    return clone;
} 
```

您甚至可能希望`User`完全不可变 - 围绕它有各种策略，例如构建器模式。问我是否需要更多详细信息。无论如何，最主要的是我们创建了一个新用户，它是旧用户的副本，但具有指定的头像。

**第一次尝试：内连接**

现在回到你的映射器……你目前有三个*公共*方法，但我*猜*只有第一个需要公共，API 的其余部分实际上不需要公开 Facebook 用户。看起来您的`GetFacebookUsers`方法基本上没问题，尽管我可能会根据空格排列查询。

因此，给定一系列本地用户和一组 Facebook 用户，我们只剩下实际的映射位了。直接的“加入”子句是有问题的，因为它不会产生没有匹配 Facebook 用户的本地用户。相反，我们需要某种方式来对待非 Facebook 用户，就好像他们是没有头像的 Facebook 用户一样。本质上这是空对象模式。

我们可以通过创建一个拥有空 uid 的 Facebook 用户来做到这一点（假设对象模型允许这样做）：

```
// Adjust for however the user should actually be constructed.
private static readonly FacebookUser NullFacebookUser = new FacebookUser(null); 
```

但是，我们实际上想要这些用户的*序列*，因为这就是`Enumerable.Concat`使用：

```
private static readonly IEnumerable<FacebookUser> NullFacebookUsers =
    Enumerable.Repeat(new FacebookUser(null), 1); 
```

现在我们可以简单地将这个虚拟条目“添加”到我们的真实条目中，并进行正常的内部连接。请注意，这*假设*Facebook 用户的查找总是会找到任何“真实”Facebook UID 的用户。如果不是这种情况，我们需要重新审视这一点，而不是使用内部连接。

我们在最后包含“null”用户，然后使用以下方法进行连接和项目`WithAvatar`：

```
public IEnumerable<User> MapFrom(IEnumerable<User> users)
{
    var facebookUsers = GetFacebookUsers(users).Concat(NullFacebookUsers);
    return from user in users
           join facebookUser in facebookUsers on
                user.FacebookUid equals facebookUser.uid
           select user.WithAvatar(facebookUser.Avatar);
} 
```

所以全班将是：

```
public sealed class FacebookMapper : IMapper
{
    private static readonly IEnumerable<FacebookUser> NullFacebookUsers =
        Enumerable.Repeat(new FacebookUser(null), 1);

    public IEnumerable<User> MapFrom(IEnumerable<User> users)
    {
        var facebookUsers = GetFacebookUsers(users).Concat(NullFacebookUsers);
        return from user in users
               join facebookUser in facebookUsers on
                    user.FacebookUid equals facebookUser.uid
               select user.WithAvatar(facebookUser.pic_square);
    }

    private Facebook.user[] GetFacebookUsers(IEnumerable<User> users)
    {
        var uids = (from u in users
                    where u.FacebookUid != null
                    select u.FacebookUid.Value).ToList();

        // return facebook users for uids using WCF
    }
} 
```

这里有几点：

*   如前所述，如果用户的 Facebook UID 可能无法作为有效用户获取，则内部连接会出现问题。
*   同样，如果我们有重复的 Facebook 用户，我们也会遇到问题——每个本地用户最终会出现两次！
*   这将替换（删除）非 Facebook 用户的头像。

**第二种方法：组加入**

让我们看看我们是否可以解决这些问题。我假设如果我们为单个 Facebook UID 获取了*多个*Facebook 用户，那么我们从他们中的哪一个获取头像并不重要——它们应该是相同的。

我们需要的是组加入，这样对于每个本地用户，我们都会获得一系列匹配的 Facebook 用户。然后我们将使用它`DefaultIfEmpty`来让生活更轻松。

我们可以保持`WithAvatar`以前的样子——但这次我们只有在有 Facebook 用户可以从中获取头像时才调用它。C# 查询表达式中的组连接由 表示`join ... into`。这个查询相当长，但不是太吓人，老实说！

```
public IEnumerable<User> MapFrom(IEnumerable<User> users)
{
    var facebookUsers = GetFacebookUsers(users);
    return from user in users
           join facebookUser in facebookUsers on
                user.FacebookUid equals facebookUser.uid
                into matchingUsers
           let firstMatch = matchingUsers.DefaultIfEmpty().First()
           select firstMatch == null ? user : user.WithAvatar(firstMatch.pic_square);
} 
```

这是查询表达式，但带有注释：

```
// "Source" sequence is just our local users
from user in users
// Perform a group join - the "matchingUsers" range variable will
// now be a sequence of FacebookUsers with the right UID. This could be empty.
join facebookUser in facebookUsers on
     user.FacebookUid equals facebookUser.uid
     into matchingUsers
// Convert an empty sequence into a single null entry, and then take the first
// element - i.e. the first matching FacebookUser or null
let firstMatch = matchingUsers.DefaultIfEmpty().First()
// If we've not got a match, return the original user.
// Otherwise return a new copy with the appropriate avatar
select firstMatch == null ? user : user.WithAvatar(firstMatch.pic_square); 
```

**非 LINQ 解决方案**

另一种选择是仅非常轻微地使用 LINQ。例如：

```
public IEnumerable<User> MapFrom(IEnumerable<User> users)
{
    var facebookUsers = GetFacebookUsers(users);
    var uidDictionary = facebookUsers.ToDictionary(fb => fb.uid);

    foreach (var user in users)
    {
        FacebookUser fb;
        if (uidDictionary.TryGetValue(user.FacebookUid, out fb)
        {
            yield return user.WithAvatar(fb.pic_square);
        }
        else
        {
            yield return user;
        }
    }
} 
```

这使用迭代器块而不是 LINQ 查询表达式。`ToDictionary`如果两次收到相同的密钥，将引发异常 - 解决此问题的一个选项是更改`GetFacebookUsers`以确保它只查找不同的 ID：

```
 private Facebook.user[] GetFacebookUsers(IEnumerable<User> users)
    {
        var uids = (from u in users
                    where u.FacebookUid != null
                    select u.FacebookUid.Value).Distinct().ToList();

        // return facebook users for uids using WCF
    } 
```

当然，这假设 Web 服务可以正常工作 - 但如果不能正常工作，您可能还是想抛出异常 :)

**结论**

从三者中挑选。组加入可能最难理解，但表现最好。迭代器块解决方案可能是最简单的，并且在`GetFacebookUsers`修改时应该表现良好。

不过，制作`User`不可变几乎肯定是一个积极的步骤。

所有这些解决方案的一个很好的副产品是用户按照他们进入的顺序出现。这对你来说可能并不重要，但它可能是一个很好的属性。

希望这会有所帮助 - 这是一个有趣的问题:)

**编辑：突变是要走的路吗？**

在您的评论中看到本地用户类型实际上是实体框架中的实体类型，采取这种行动*可能*不合适。让它不可变几乎是不可能的，我怀疑该类型的大多数用途都会*发生*突变。

如果是这种情况，可能值得更改您的界面以使其更清晰。您可能希望同时更改签名和名称，而不是返回一个`IEnumerable<User>`（这意味着 - 在某种程度上 - 投影），给您留下如下内容：

```
public sealed class FacebookMerger : IUserMerger
{
    public void MergeInformation(IEnumerable<User> users)
    {
        var facebookUsers = GetFacebookUsers(users);
        var uidDictionary = facebookUsers.ToDictionary(fb => fb.uid);

        foreach (var user in users)
        {
            FacebookUser fb;
            if (uidDictionary.TryGetValue(user.FacebookUid, out fb)
            {
                user.Avatar = fb.pic_square;
            }
        }
    }

    private Facebook.user[] GetFacebookUsers(IEnumerable<User> users)
    {
        var uids = (from u in users
                    where u.FacebookUid != null
                    select u.FacebookUid.Value).Distinct().ToList();

        // return facebook users for uids using WCF
    }
} 
```

同样，这不再是一个特别的“LINQ-y”解决方案（在主要操作中） - 但这是合理的，因为您并不是真正的“查询”；你在“更新”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-28T21:59:26.573

我会倾向于写这样的东西：

```
public class FacebookMapper : IMapper
{
    public IEnumerable<User> MapFacebookAvatars(IEnumerable<User> users)
    {
        var usersByID =
            users.Where(u => u.FacebookUid.HasValue)
                 .ToDictionary(u => u.FacebookUid.Value);

        var facebookUsersByID =
            GetFacebookUsers(usersByID.Keys).ToDictionary(f => f.uid);

        foreach(var id in usersByID.Keys.Intersect(facebookUsersByID.Keys))
            usersByID[id].FacebookAvatar = facebookUsersByID[id].pic_sqare;

        return users;
    }

    public Facebook.user[] GetFacebookUsers(IEnumerable<int> uids)
    {
       // return facebook users for uids using WCF
    }
} 
```

但是，我不会声称这对您所拥有的东西有很大的改进（除非用户或 facebook 用户集合非常大，在这种情况下，您最终可能会出现明显的性能差异。）

（我建议不要使用`Select`like`foreach`循环对集合的元素执行实际的变异操作，就像您在重构尝试中所做的那样。您可以这样做，但人们会对您的代码感到惊讶，您会必须始终牢记惰性评估。）

# java - JME 应用程序是否可以在您的手机上修改默认表单？

> ID：603652
> 
> 赞同：1
> 
> 时间：2009-03-02T19:32:18.657
> 
> 标签：java, mobile, java-me

我被要求找出是否可以使用 jme 修改手机上的默认屏幕。基本上是手机开机时显示的屏幕，但通常显示网络和最近的信号塔信息。

我对 JME 的理解是，这是不可能的。是否必须为此使用 symbian 或 USSD 等一些较旧的协议？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T20:14:07.170

无法使用 J2ME 修改设备的默认屏幕。为此，您需要一个本机应用程序（Symbian、Windows Mobile）。J2ME 位于沙盒环境中，对您可以访问的内容有很多限制。应用程序只能由用户启动，不能作为服务运行。也不可能注册应用程序以在手机启动时运行。

已经讨论过 MIDP 3.0 可以解决上述许多问题，但我认为它永远不会可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T12:08:39.620

从应用程序生命周期的角度来看，有一些方法可以近似您正在尝试做的事情，但它们几乎总是需要手机制造商的支持。

如果您有选择，索尼爱立信 JP8 平台具有 JavaME 的非标准扩展，可以提供帮助。

然而，访问电话信息将是一个主要问题。寻找实现 JSR-120 的 cbs 协议的手机，它可能会被证明是有用的。

顺便说一句，在 Series60（Symbian）手机上访问手机空闲/待机/主屏幕也需要诺基亚支持。

# .net-2.0 - asmx .net 2.0 网络服务

> ID：603658
> 
> 赞同：-1
> 
> 时间：2009-03-02T19:33:26.080
> 
> 标签：.net-2.0, service, asmx

我创建了一个 Web 服务，将其上传到远程服务器上的我的站点。我试图浏览它，但我不能，我也尝试通过 vs08 将网络引用添加到他的地址，但同样的问题发生在那里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T19:48:40.520

好的，根据您的评论：

> 我没有收到任何错误，只有在使用它时我才收到 404 page not found 错误，名称空间是“ [http://www.poppetz.com/poppetz](http://www.poppetz.com/poppetz) ”；但该服务实际上是在 [http://www.popetz.co.il/Services/Poppetz.asmx](http://www.popetz.co.il/Services/Poppetz.asmx) 也许这是问题？？？我通过 ftp 使用 vs08 部署它 – Chen Kinnrot（2 分钟前）

您的服务的命名空间与您能否访问它无关。

如果您将一个普通的旧 test.html 回显“hello world”并将其放在与您的服务相同的目录中，您可以访问它吗？即：[http ://www.popetz.co.il/Services/test.html](http://www.popetz.co.il/Services/test.html)

您能否访问托管 Web 服务的机器。如果是这样，如果您查看 IIS 管理器，是否可以在您期望的网站中看到 ASMX？

如果不是，则开始查看 IIS 配置并确保网站目录与您转储 Web 服务文件的文件夹相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T20:29:00.930

10x 每个人，服务器提供商更改了一些 iis 配置，一切正常......\

# c# - 从类或抽象类继承

> ID：603661
> 
> 赞同：22
> 
> 时间：2009-03-02T19:35:07.793
> 
> 标签：c#, .net, inheritance, class

如果您有几个类希望它们从基类继承以获得通用功能，您应该使用类还是抽象类来实现基类？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-02T19:37:29.283

这取决于，如果你永远不想能够实例化基类，那么让它抽象。否则，将其保留为普通课程。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-02T19:42:56.573

如果不应该实例化基类，则将其设为抽象类 - 如果需要实例化基类，则不要将其设为抽象类。

在这个例子中，使基类抽象是有意义的，因为基类没有任何具体含义：

```
abstract class WritingImplement
{
    public abstract void Write();
}

class Pencil : WritingImplement
{
    public override void Write() { }
} 
```

但是，在下一个示例中，您可以看到基类是如何具有具体含义的：

```
class Dog
{
    public virtual void Bark() { }
}

class GoldenRetriever : Dog
{
    public override void Bark() { }
} 
```

这一切都非常主观——你应该能够根据你的特定领域的需求做出很好的判断。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-02T19:38:24.663

这取决于，有问题的基类独立存在而不衍生自它是否有意义？如果答案是肯定的，那么它应该是一个常规类，否则，它应该是一个抽象类。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-02T20:26:22.990

我建议：

*   做一个界面。
*   在您的基类中实现接口。
*   使基类成为真正的类，而不是抽象类（原因见下文）。

我更喜欢真实类而不是抽象类的原因是抽象类不能被实例化，这*不必要地*限制了未来的选择。比如以后可能需要基类提供的状态和方法，但是不能继承，不需要实现接口；如果基类是抽象的，我很不走运，但如果基类是常规类，那么我可以创建基类的实例并将其作为我的另一个类的组件，并委托给实例以重用提供的状态/方法。

是的，这不会经常发生，但关键是：当没有理由这样做时，使基类抽象可以防止这种重用/解决方案。

现在，如果实例化基类会以某种方式存在危险，那么将其抽象化 - 或者如果可能的话，最好降低它的危险性；-)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-01-17T20:48:40.670

把它想象成一个银行账户：

您可以创建一个名为“Account”的通用抽象基本帐户，其中包含客户详细信息等基本信息。

然后，您可以创建两个名为“SavingAccount”或“DebitAccount”的派生类，它们可以有自己的特定行为，同时受益于基类行为。

在这种情况下，客户必须拥有储蓄账户或借记账户，不允许使用通用“账户”，因为在现实世界中只有一个没有描述的账户并不流行。

如果您可以根据自己的需要创建类似的场景，那么抽象就是要走的路。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T20:00:10.167

抽象类用于部分实现的类。

拥有抽象类的实例本身没有意义，它需要派生。如果您希望能够创建基类，则它不能是抽象的。

我喜欢将抽象类视为具有一些预定义成员的接口，因为它们对所有子类都是通用的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-02T20:02:02.550

换个方式想这个

> 我的基类本身是一个完整的对象吗？

如果答案是否定的，则将其抽象化。如果是，那么您可能希望将其设为具体类。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-02T19:37:49.627

我想说，如果您不打算自己调用基类，那么您应该将其定义为抽象类。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-02T19:38:09.643

这取决于您是否希望基类自行实现。

作为一个抽象类，您不能从中创建对象。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-02T19:56:04.420

抽象类非常适合预定义的功能，例如 - 当知道类应该公开的最小确切行为但不知道它应该使用什么数据或确切实现时。

```
abstract class ADataAccess
{
    abstract public void Save();
} 
```

普通（非抽象）类对于类似的事情可能非常有用，但您必须了解实现细节才能编写它们。

```
public class DataAccess
{
    public void Save()
    {
        if ( _is_new )
        {
            Insert();
        }
        else if ( _is_modified )
        {
            Update();
        }
    }
} 
```

此外，您可以使用接口（单独或在类上，无论是否抽象）来定义相同类型的原型定义。

```
interface ISaveable
{
    void Save();
    void Insert();
    void Update();
}

class UserAccount : ISavable
{
    void ISavable.Save() { ... }
    void ISavable.Insert() { ... }
    void ISavable.Update() { ... }
} 
```

另一种选择可能是使用泛型

```
class GenDataAccess<T>
{
    public void Save()
    {
        ...
    }
} 
```

所有这些方法都可以用来定义一个特定的原型供类使用。确保代码 A 可以与代码 B 对话的方法。当然，您可以根据自己的喜好混合和匹配以上所有内容。没有明确的正确方法，但我喜欢定义接口和抽象类，然后引用接口。这种方式消除了在更高级别课程中“管道”的一些思想要求，同时保持最大的灵活性。（拥有接口消除了使用抽象基类的要求，但将其作为一种选择）。

* * *

## 回答 #11

> 赞同：-8
> 
> 时间：2011-03-31T00:08:42.190

我认为你们中的很多人应该重新学习基本的 OO 课程。

The basic underlying principle in OOA/OOD is to abstract abstract abstract, until you can't abstract no more. If what your looking at is an abstraction then so be it, thats what your OOA/OOD already told you. However if you sitting there wondering whether "code" should be abstract or not then you obviously don't know what the term means and should go learn basic OOA/OOD/OOP again :-)

More to the point you should learn Design Patterns and Harmonic Theory, this will help with your OO designs immensely!

# php - 如何使用 php mssql 浏览结果？

> ID：603663
> 
> 赞同：1
> 
> 时间：2009-03-02T19:35:29.727
> 
> 标签：php, sql-server

我正在使用 php，我想做一个下一步按钮，该按钮是接下来 10 条记录的步骤（比如当你用 stackoverflow 浏览问题时）我不知道该怎么做，但我想用 Top n 来做记录 ？你认为这是个好主意吗？有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T19:43:02.127

至于在 PHP 中执行此操作，您可以轻松地使按钮发送起始金额的 POST 或 GET 请求。例如，用户会发出初始请求，这只是`yoursite.com/search.php`，下一个按钮会将他们发送到具有相同搜索条件的同一页面，仅发送一个附加字段“开始”，（即`yoursite.com/search.php?start=10`）。在代码中，您可以简单地检查它：

```
if(isset($_POST['start'])) {
    //code to add to the search string to start at $_POST['start']
} 
```

**编辑 1：** [这篇文章](http://www.select-sql.com/mssql/how-to-make-limit-from-to-in-mssql-2005.html)是我能找到的关于如何复制 MySQL`LIMIT`功能的最佳文章。此外，[这个](http://www.posteet.com/view/1567)有一个更明确的查询可供参考，但它是相同的想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T19:39:58.607

我知道在 MySQL 中你可以使用 LIMIT X, Y 其中 X 是返回的下限，Y 是上限。因此，如果您想返回 10-20，您将使用 LIMIT 10、20。不确定 MS-SQL 等价物是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T19:40:32.240

mssql 在 mysql 中没有类似 LIMIT 的东西吗？所以你可以这样做：

```
select xxx from yyy LIMIT 0,10 
```

对于前 10 个结果，然后为接下来的 10 个结果执行 LIMIT 10,20 等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T19:45:38.610

你可以使用 MySQL 的限制

设置一个名为：

```
$limit = 10;
$pl = $_GET["page"] * $limit;
if(!isset($_GET["page"]) || $_GET["page"] == 1)
{
    $pl = 0;
} 
```

在你的查询中做

```
$sql = sprintf("SELECT * FROM table LIMIT %d,%d" 
mysql_real_escape_string($pl),
mysql_real_escape_string($limit)); 
```

顺便说一句，这是来自记忆，但我认为它有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T20:02:00.130

这对你有帮助吗？

```
$count=$_POST[page]*10; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T20:42:01.237

对于 MySQL：

```
$rowsPerPage = 10;
$offset = ((int)$_GET['page'] - 1) * $rowsPerPage;

$result = mysql_query(
    sprintf('select xxx from yyy LIMIT %d,%d', $offset, $rowsPerPage)
); 
```

# c# - 网络设计；使用轮询的套接字通信

> ID：603677
> 
> 赞同：0
> 
> 时间：2009-03-02T19:39:32.087
> 
> 标签：c#, .net, design-patterns, networking, sockets

**关于正在进行的设计和实施的几句话**

我向远程应用程序发送大量请求（当然，在不同的主机上运行），然后应用程序发回数据。

**关于客户**

客户端是一个 UI，它产生一个单独的线程来提交和处理请求。一旦它提交了所有请求，它就会调用Wait。等待将解析应用程序的所有事件并调用客户端的回调。

下面是Wait的实现。

```
public void Wait (uint milliseconds)
{
       while(_socket.IsConnected)
       {
         if (_socket.Poll(milliseconds, SelectMode.SelectRead))
         {
              // read info of the buffer and calls registered callbacks for the client
              if(_socket.IsAvailable > 0)
                    ProcessSocket(socket);
         }
         else
            return; //returns after Poll has expired
      }
} 
```

*Wait*从一个单独的 线程调用，负责管理网络连接：入站和出站流量：

```
 _Receiver = new Thread(DoWork);
         _Receiver.IsBackground = true;
         _Receiver.Start(this); 
```

该线程是从应用程序的 UI 组件创建的。

**问题：**

即使主应用程序已按时发送数据，客户端有时也会看到回调延迟。值得注意的是，轮询中的一条消息被延迟，直到我的客户端断开连接，并且在内部我调用了：

```
_socket.Shutdown(SocketShutdown.Both); 
```

我认为**民意调查中正在发生一些时髦的事情**

有关如何解决问题或替代解决方法的任何建议？

谢谢

如果有任何不清楚的地方，请告诉我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T05:19:01.523

有几件事。首先，在您的示例中，“_socket”和“socket”之间有区别吗？其次，您使用的是 System.Net.Sockets.Socket 类，对吗？对于任何追溯到 1.1 的 .NET 版本，我在 MSDN 文档中都没有看到该类的 IsConnected 或 IsAvailable 属性。我认为这些都是打字错误，对吧？

您是否尝试在“IsAvailable > 0”测试中添加“else”子句并向控制台/输出窗口写入消息，例如，

```
 if (_socket.IsAvailable > 0) {
      ProcessSocket(socket);
  } else {
      Console.WriteLine("Poll() returned true but there is no data");
  } 
```

这可能会让您了解在您的程序的更大上下文中可能发生的事情。

除此之外，我不喜欢轮询套接字以获取数据。作为替代方案，是否有理由不在套接字上使用异步 Begin/EndReceive 函数？我认为转换为异步模型会很简单，因为您已经在使用单独的线程来发送和接收数据。这是来自 MSDN的[示例。](http://msdn.microsoft.com/en-us/library/dxkwh6zw.aspx)此外，我已将我使用此机制的典型实现添加[到此 SO 帖子](https://stackoverflow.com/questions/582550/c-begin-endreceive-how-do-i-read-large-data/599448#599448)中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T20:27:18.433

哪个线程正在调用 Wait() 方法？如果您只是将其放入 UI 线程池，这可能就是您有时会遇到延迟的原因。如果这是您的问题，那么要么使用系统线程池，要么为应用程序的网络部分创建一个新线程池，要么为它生成一个专用线程。

除此之外，如果不查看更多代码，很难为您提供太多帮助。

# perl - Perl 中 localtime 函数的对立面是什么？

> ID：603681
> 
> 赞同：9
> 
> 时间：2009-03-02T19:41:34.487
> 
> 标签：perl, timestamp

在 Perl 中，`localtime`需要一个 Unix 时间戳并返回年/月/日/小时/分钟/秒等。我正在寻找相反的`localtime`：我有零件，我想从它们构建一个 unix 时间戳。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-02T20:12:46.877

[您可以在Time::Local](http://search.cpan.org/perldoc?Time::Local) CPAN 模块中使用 timelocal 函数。

> 姓名
> 
> Time::Local - 从本地时间和 GMT 时间有效地计算时间
> 
> 概要
> 
> ```
> $time = timelocal($sec,$min,$hour,$mday,$mon,$year);
> $time = timegm($sec,$min,$hour,$mday,$mon,$year); 
> ```
> 
> 描述
> 
> 该模块提供了与内置 perl 函数 localtime() 和 gmtime() 相反的函数。它们将日期作为六元素数组接受，并返回自系统纪元以来的相应 time(2) 值（以秒为单位）（例如，Unix 上 1970 年 1 月 1 日午夜，格林威治标准时间）。此值可以是正值或负值，尽管 POSIX 只需要支持正值，因此系统纪元之前的日期可能不适用于所有操作系统。
> 
> 值得特别注意所提供值的预期范围。月中日的值是实际日期（即 1..31），而月份是自一月以来的月数（0..11）。这与从 localtime() 和 gmtime() 返回的值一致。

**注意：** [POSIX::mktime](http://search.cpan.org/perldoc?POSIX#mktime)只是 C 库`mktime()`函数的一个包装器。Time::Local 是一个纯 Perl 实现，并且总是返回匹配 Perl 的结果`localtime`。此外， Time::Local 提供`gmtime`，而`mktime`仅适用于当地时间。（好吧，您可以尝试更改`$ENV{TZ}`，但这在某些系统上不起作用。）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-02T19:48:19.307

[POSIX::mktime](http://search.cpan.org/perldoc?POSIX#mktime)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-02T19:51:29.470

[CPAN 上的DateTime](http://search.cpan.org/perldoc?DateTime)可能会有一些用处。它还有**很多**时间操作/翻译方法。

只需使用您的部件创建 DateTime 并调用 $datetime->formatter("%s") ；

# citrix - 如何对 Citrix 网站进行编码以使用安全网关 (CSG)？

> ID：603682
> 
> 赞同：2
> 
> 时间：2009-03-02T19:41:37.137
> 
> 标签：citrix, certificate-authority, secure-gateway

我使用 Citrix 的示例代码作为基础，并试图让它生成指示客户端使用其安全网关 (CSG) 提供程序的 ICA 文件。我的配置是，将 ICA 文件的服务器地址替换为 CSG 票证，并强制流量流向 CSG。

挑战在于 Citrix App Server（在 1494 上提供 ICA 会话）和 CSG 都必须通过 Secure Ticket Authority (STA) 进行协调。这意味着我的代码在创建 ICA 文件时需要与 STA 对话，因为 STA 持有 CSG 需要嵌入到 ICA 文件中的票证。令人困惑？当然！但它更安全。

预 CSG 代码如下所示：

```
AppLaunchInfo launchInfo = (AppLaunchInfo)userContext.launchApp(appID, new AppLaunchParams(ClientType.ICA_30));
ICAFile icaFile = userContext.convertToICAFile(launchInfo, null, null); 
```

我尝试将 SSLEnabled 信息传递给 ICA 生成，但还不够。这是代码：

```
launchInfo.setSSLEnabled(true);
launchInfo.setSSLAddress(new ServiceAddress("CSG URL", 443)); 
```

现在，看起来我需要在配置我的场时注册 STA：

```
ConnectionRoutingPolicy policy = config.getDMZRoutingPolicy();
policy.getRules().clear();

//Set the Secure Ticketing Authorities (STAs).
STAGroup STAgr = new STAGroup();
STAgr.addSTAURL(@"http://CitrixAppServerURL/scripts/ctxsta.dll");

//creat Secure Gateway conenction
SGConnectionRoute SGRoute = new SGConnectionRoute(@"https://CSGURL");
SGRoute.setUseSessionReliability(false);
SGRoute.setGatewayPort(80);
SGRoute.setTicketAuthorities(STAgr);
// add the SGRoute to the policy
policy.setDefault(SGRoute); 
```

这是基于我在[Citrix 论坛](http://forums.citrix.com/thread.jspa?forumID=48&threadID=71650&messageID=429494&)上找到的代码；但是，它破坏了我与 Farm 连接并获取我的应用程序列表的能力！

有人可以指出一个有效的代码示例吗？还是参考文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T21:08:17.680

问题中的代码基本上是正确的，但我太努力将配置注入启动的 ICA 生成器。

注意：使用**WebInterface.conf**文件作为指导是确定正确配置设置的好方法。即使代码是对的，配置也很敏感！

大多数 Citrix Secure Gateway (CSG)/Secure Ticket Authority (STA) 魔法在建立与场的初始连接策略时发生。具体来说，在*Global.asax.cs*中，您必须具有以下代码块：

1) 你必须有一个有效的 STAGroup：

```
//Set the Secure Ticketing Authorities (STAs).
STAGroup STAgr = new STAGroup();
STAgr.addSTAURL(@"http://[STA URL]/scripts/ctxsta.dll"); 
```

2）您必须创建一个 CSG 连接（与 STA 映射）：

```
 //create Secure Gateway conenction
 SGConnectionRoute SGRoute = new SGConnectionRoute(@"[CSG FQDN without HTTPS]");
 SGRoute.setUseSessionReliability(false);
 SGRoute.setGatewayPort(443);
 SGRoute.setTicketAuthorities(STAgr); 
```

3）您需要设置策略默认值

```
 // Create a DMZ routing policy
 ConnectionRoutingPolicy policy = config.getDMZRoutingPolicy();
 policy.getRules().clear();
 policy.setDefault(SGRoute); 
```

4）您需要告诉launchInfo您要启用CGP：

```
launchInfo.setCGPEnabled(true); 
```

警告：SSL 启用为红鲱鱼。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T18:19:04.193

还有另一种更清洁、更可配置的方法。可以将代码设置为使用默认 Citrix Web Interface 使用的**webinterface.conf**文件。

以下代码应替换上述示例中的所有 farmConfig、STAGroup、ConnectionRoutinePolcy 和混乱。

```
InputStream inputStream = new FileInputStream(@"C:\temp\WebInterface.conf");
CtxConfig configInput = new CtxConfig(inputStream);
Map settingsMap = configInput.getSettingsMap();
WIConfiguration wiConfiguration = ConfigurationParser.buildWIConfiguration(settingsMap);

com.citrix.wing.config.Configuration config = new com.citrix.wing.config.Configuration();
config.setGlobalConfig(wiConfiguration.getGlobalConfig());
config.setMPSFarmConfigs(wiConfiguration.getMPSFarmConfigs());
config.setDMZRoutingPolicy(wiConfiguration.getDMZRoutingPolicy());
config.setClientProxyPolicy(wiConfiguration.getClientProxyPolicy());

// Create a StaticEnvironmentAdaptor instance.
WIASPNetStaticAdaptor staticEnvAdaptor = new WIASPNetStaticAdaptor(this);

// Create a WebPNBuilder instance.
WebPNBuilder builder = WebPNBuilder.getInstance();
Application["WebPNBuilder"] = builder;

// Create a WebPN instance from the configuration.
WebPN webPN = builder.createWebPN(config, staticEnvAdaptor);
Application["WebPN"] = webPN; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T16:19:36.743

关于这个问题的另一个注意事项是使用带有内部证书（不受信任的根）的 JICA 客户端。

JICA 客户端不允许您接受来自不受信任的根的证书，因此需要将证书添加到 Java CA 存储。将其添加到 Windows 商店没有任何好处！

获取您的开发根 CA，然后导航到最新 Java 安装的 bin 目录（通常在 c:\program files\java\jre*** 下）

执行以下命令：

```
keytool -import -trustcacerts -keystore "..\lib\security\cacerts" -file "c:\temp\root.cer" -alias myroot 
```

我会让你用谷歌搜索密码，因为你应该改变它[*原文如此*]。

# compiler-construction - 如何从形式语法生成句子？

> ID：603687
> 
> 赞同：19
> 
> 时间：2009-03-02T19:42:25.747
> 
> 标签：compiler-construction, computer-science, grammar, parsing

**从语法生成句子的常用方法是什么？**

我想要一种与解析器相反的算法。也就是说，给定一个正式的上下文无关语法（比如 LL），我想生成一个符合该语法的任意句子。我在这里使用*句子*来表示任何有效的文本主体，因此它实际上可以是一个完整的程序（即使它没有任何意义——只要它在语法上是正确的）。

示例语法：

```
program   : <imports> NEWLINE? <namespace>
imports   : ("import" <identifier> NEWLINE)* 
namespace : "namespace " <identifier> NEWLINE "{" <classes> "}" 
identifier: (A-Za-z_) (A-Za-z0-9_)*
... 
```

示例生成*程序*：

```
import jkhbhhuob
import aaaaa888_

namespace u8nFGubgykb
{ class ui0op_np { ... }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-07-20T16:11:00.447

[这是一个使用NLTK](http://www.nltk.org/)的 Python 示例：

```
from nltk import parse_cfg, ChartParser
from random import choice

def produce(grammar, symbol):
    words = []
    productions = grammar.productions(lhs = symbol)
    production = choice(productions)
    for sym in production.rhs():
        if isinstance(sym, str):
            words.append(sym)
        else:
            words.extend(produce(grammar, sym))
    return words

grammar = parse_cfg('''
S -> NP VP
PP -> P NP
NP -> Det N | Det N PP | 'I'
VP -> V NP | VP PP
V -> 'shot' | 'killed' | 'wounded'
Det -> 'an' | 'my' 
N -> 'elephant' | 'pajamas' | 'cat' | 'dog'
P -> 'in' | 'outside'
''')

parser = ChartParser(grammar)

gr = parser.grammar()
print ' '.join(produce(gr, gr.start())) 
```

该示例改编自[该书](https://www.nltk.org/book/ch08.html)。生成的句子在语法上是正确的，但仍然完全是胡言乱语。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T20:00:29.823

我不知道有这样做的“通用”算法。随机程序生成用于遗传编程，因此您可以寻找基于语法的 GP 系统并查看它们如何处理程序生成。我会做一个递归规则生成算法，如伪代码：

```
void GenerateRule(someRule)
{
  foreach (part in someRule.Parts)
  {
    if (part.IsLiteral) OutputLiteral(part);
    if (part.IsIdentifier) Output(GenerateIdentifier(part)));
    if (part.IsRule) GenerateRule(part.Rule);
  }
} 
```

这假设您已将所有部分读入某个数据结构。您还需要处理重复（随机生成它们发生的次数）和可选规则（掷硬币看它们是否存在）。

* * *

编辑：哦，如果规则有多个选项，您只需选择其中一个选项，并以相同的方式处理它。因此，如果某个规则是 (Literal|Variable)，您将在两者之间随机选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T19:51:43.230

在我的头顶上：

我会递归地工作（基本上与递归体面的解析器相反）使用一些关于如何处理范围（`(...)`：可能是随机选择）选项（`?`：参见*下面的[]），重复（'* '泊松分布？）的启发式方法。文字 ( `"..."`) 被简单地写入输出，而子标记 (`<...>') 生成递归。

除非您想保证某种完整的覆盖范围，否则这应该不会太难。即使那样，仅生成*一堆*数据也会有所帮助...

* * *

[*] 您需要在少于 50% 的时间内包含选项，以防止在处理规则时无限回归

```
 nonterm:  otherstuff <nonterm>? 
```

很好的[底座](https://stackoverflow.com/questions/603687/how-do-i-generate-sentences-from-a-formal-grammar/603768#603768)。

与重复类似，抛出一个强烈收敛的分布。

* * *

如果输入语法以 BNF 形式呈现，则需要先解析输入语法，如此处所示。最简单的做法是使用映射`(name, string)`，然后从最高级别的令牌开始（您可能会认为这意味着第一个......）。

这给了你：

> ("program", "<imports> NEWLINE?<namespace>")
> 
> ("imports", ("import" <标识符> NEWLINE)*)
> 
> ...

你从“程序”开始，点击“<imports>”，所以你会重复......回来时，点击“NEWLINE？”，所以掷骰子并写或不写，点击“<namespace>”所以重复......返回时你就完成了。

* * *

我发现自己怀疑以前有人做过。如果您只需要输出，我会在网上搜索...也许[http://portal.acm.org/citation.cfm?doid=966137.966142](http://portal.acm.org/citation.cfm?doid=966137.966142)，尽管那里有大量的解析器生成器使搜索空间变得混乱。 .. 也试试[这篇论文](http://www.sciencedirect.com/science?_ob=ArticleURL&_udi=B6V0B-3SP62KK-9&_user=10&_rdoc=1&_fmt=&_orig=search&_sort=d&view=c&_acct=C000050221&_version=1&_urlVersion=0&_userid=10&md5=ab18c231faad1c54e63358d7ea589459)。

顺便说一句——你当地的大学可能有这些期刊的在线订阅，所以你可以通过在图书馆联系来免费获得它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-02T23:22:49.663

您的解决方案应遵循语法的归纳结构。你如何为以下每一个生成随机话语？

*   端子符号
*   非终结符
*   右手边的序列
*   右手边的选择
*   右侧星形闭合

如果您写下用于表示语法的数据结构，这一切都会更加清晰。您的一组相互递归生成器函数的结构将非常紧密地反映该数据结构。

处理无限递归有点冒险。最简单的方法是生成话语流并保持深度截止。或者，如果您使用像 Haskell 这样的惰性语言，您可以生成*所有*话语并剥离任意数量的有限话语（比原始问题更棘手，但非常有趣）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T19:46:27.080

我的第一个建议是广度优先搜索。只需设置规则图并搜索它们。您将从最小的程序开始吐出程序，然后慢慢变大。但是，您可能会发现，对于给定数量的规则，您的语法会以指数方式吐出更多的程序，并且您可能不会在使用 DFS 的程序中获得超过 30 个左右的标记。

深度优先搜索的问题在于，一旦你有了左递归规则，你的搜索就会陷入无限循环。

另一个大问题是语法正确的程序距离语义正确的程序还有很长的路要走。除了最基本的情况外，生成后一种类型可能完全不可行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T20:02:47.273

您将遇到的问题是图形的递归性质使得您可以生成无限大小的正确语法。您可能想要做一些事情，例如在您的语法中设置节点类型的哈希，其中包含您允许自己点击该节点的次数和限制。然后深度优先搜索您的内容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-29T17:49:43.227

像往常一样，我会建议不要重新发明轮子。我已经为 ARM 汇编器编写了其中一个，但我对此表示遗憾（*软件：实践和经验*2007 年 4 月）：

“回想起来，应该使用现成的表达式生成器来生成随机 ARM 汇编指令以进行比较。取而代之的是，逐步构建 Perl 脚本，获取每个 ARM 指令定义并生成实例。然而，增量内部方法的一个优势是简单的替换可以检测到简单的错误，并且可以逐步进行错误搜索。”</p>

恐怕我不记得是什么让我改变了主意，而且我怀疑它是否与您的特定需求相关，但我确实建议更加努力地寻找预先存在的解决方案。自己写这样的东西需要更少的纪律，但它总是比你预期的要花更长的时间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-02T19:46:00.480

不是答案，但请检查有关语法生成的维基百科条目： [http ://en.wikipedia.org/wiki/Context-free_grammar_generation_algorithms](http://en.wikipedia.org/wiki/Context-free_grammar_generation_algorithms)

它描述了一些常用的算法。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-03-02T19:46:56.627

虽然这个想法很好（我之前已经想过很多次），但现实情况是，如果没有一些样本数据和/或大量的生成器约束/努力限制，这是一项相当大的工作。

人们可能会发现手工编写样本更容易。:)

# sql-server - 审计触发器中的每个插入行

> ID：603699
> 
> 赞同：1
> 
> 时间：2009-03-02T19:46:56.937
> 
> 标签：sql-server, triggers

我正在尝试通过向我的表中添加触发器并将行插入到我的审计表中来进行审计历史记录。我有一个存储过程，因为它节省了代码，所以插入更容易一些；我不必写出整个插入语句，而是使用我要插入的列的一些参数来执行存储过程。

我不确定如何为“插入”表中的每一行执行存储过程。我想也许我需要使用光标，但我不确定。我以前从未使用过光标。

由于这是一次审计，我将需要将每列旧列的值与新列的值进行比较，看看它是否发生了变化。如果它确实发生了变化，我将执行在我的审计表中添加一行的存储过程。

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T20:09:32.140

我会用空间换时间，而不是做比较。只需在插入/更新时将新值推送到审计表。磁盘便宜。

另外，我不确定存储过程会给你带来什么。你不能在触发器中做一些简单的事情，比如：

```
insert into dbo.mytable_audit
    (select *, getdate(), getdate(), 'create' from inserted) 
```

触发器在插入时运行的位置，您正在添加创建时间、上次更新时间和修改类型字段。对于更新，这有点棘手，因为您需要提供命名参数，因为不应更新创建时间

```
insert into dbo.mytable_audit (col1, col2, ...., last_updated, modification)
     (select *, getdate(), 'update' from inserted) 
```

此外，您是否也计划只审核成功或失败？如果您想审核失败，我认为您将需要触发器以外的其他东西，因为如果事务回滚，触发器将不会运行 - 如果触发器首先运行，您将不会拥有事务的状态。

我实际上已经将我的审计转移到了我的数据访问层并现在用代码来完成。它使成功和失败的审计更容易，并且（使用反射）很容易将字段复制到审计对象。它允许我做的另一件事是提供用户上下文，因为我没有授予数据库的实际用户权限并使用服务帐户运行所有查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T23:30:52.953

已经有一个内置函数`UPDATE()`可以告诉您列是否已更改（但它是在整个插入的行集上）。

您可以查看[Paul Nielsen 的 AutoAudit 触发器](http://autoaudit.codeplex.com/)中的一些代码生成技术。

它的作用是同时检查：

```
IF UPDATE(<column_name>)
INSERT Audit (...)
SELECT ...
FROM Inserted
JOIN Deleted
    ON Inserted.KeyField = Deleted.KeyField -- (AutoAudit does not support multi-column primary keys, but the technique can be done manually)
AND NOT (Inserted.<column_name> = Deleted.<column_name> OR COALESCE(Inserted.<column_name>, Deleted.<column_name>) IS NULL) 
```

但它将每一列更改作为单独的行进行审计。我用它来审计对配置表的更改。我目前没有使用它来审核大量更改表。（但在我设计的大多数事务系统中，大量活动表上的行通常是不可变的，你没有很多`UPDATE`s，只有很多`INSERT`s - 所以你甚至不需要这种审计）。例如，订单或分类帐条目永远不会更改，购物车是一次性的 - 也不会有这种审计。在像客户这样的低容量变更表上，您可以使用这种审计。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T19:53:56.780

如果您的数据库需要扩展到少数用户，这将变得非常昂贵。我建议研究 3rd 方数据库审计工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-21T02:41:02.687

杰夫，我同意 Zodeus 的观点。一个不错的选择是使用第三个工具。我使用了生成审计触发器的审计数据库 (FREE)web 工具（你不需要写一行 TSQL 代码）

另一个很好的工具是 Apex SQL 审计，但它不是免费的。

我希望这对你有帮助，F. O'Neill

# sql - 如何使用 SQL Server 实现 LIMIT？

> ID：603724
> 
> 赞同：157
> 
> 时间：2009-03-02T19:54:59.803
> 
> 标签：sql, sql-server, migration

我对 MySQL 进行了以下查询：

```
select * from table1 LIMIT 10,20 
```

如何使用 SQL Server 执行此操作？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2009-03-02T20:00:09.683

从 SQL SERVER 2005 开始，您可以这样做...

```
USE AdventureWorks;
GO
WITH OrderedOrders AS
(
    SELECT SalesOrderID, OrderDate,
    ROW_NUMBER() OVER (ORDER BY OrderDate) AS 'RowNumber'
    FROM Sales.SalesOrderHeader 
) 
SELECT * 
FROM OrderedOrders 
WHERE RowNumber BETWEEN 10 AND 20; 
```

或类似 2000 及以下版本的东西...

```
SELECT TOP 10 * FROM (SELECT TOP 20 FROM Table ORDER BY Id) ORDER BY Id DESC 
```

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2009-03-02T19:58:12.463

笨重，但它会工作。

```
SELECT TOP 10 * FROM table WHERE id NOT IN (SELECT TOP 10 id FROM table ORDER BY id) FROM table ORDER BY id 
```

MSSQL 遗漏 LIMIT 子句是犯罪行为，IMO。你不应该做这种笨拙的解决方法。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2014-09-16T16:37:33.080

从 SQL SERVER 2012 开始，您可以使用 OFFSET FETCH 子句：

```
USE AdventureWorks;
GO
SELECT SalesOrderID, OrderDate
FROM Sales.SalesOrderHeader 
ORDER BY SalesOrderID
    OFFSET 10 ROWS
    FETCH NEXT 10 ROWS ONLY;
GO 
```

[http://msdn.microsoft.com/en-us/library/ms188385(v=sql.110).aspx](http://msdn.microsoft.com/en-us/library/ms188385(v=sql.110).aspx)

当 order by 不是唯一的时，这可能无法正常工作。

如果查询修改为 ORDER BY OrderDate，则返回的结果集与预期不符。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2016-05-19T14:19:52.697

这就是我在 MS SQL Server 2012 中限制结果的方式：

```
SELECT * 
FROM table1
ORDER BY columnName
  OFFSET 10 ROWS FETCH NEXT 10 ROWS ONLY 
```

注意：`OFFSET`只能与`ORDER BY`.

解释代码行`OFFSET xx ROWS FETCH NEXT yy ROW ONLY`

`xx`是您要从表中开始拉取的记录/行号，即：如果表 1 中有 40 条记录，则上面的代码将从第 10 行开始拉取。

这`yy`是您要从表中提取的记录/行数。

以前面的示例为基础：如果表 1 有 40 条记录，并且您开始从第 10 行拉取并获取 NEXT 集 10 ( `yy`)。这意味着，上面的代码将从表 1 中提取记录，从第 10 行开始，到第 20 行结束。从而提取第 10 到 20 行。

查看链接以获取有关[OFFSET的更多信息](https://technet.microsoft.com/en-us/library/gg699618(v=sql.110).aspx)

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2009-03-02T20:04:12.090

这几乎是我在 10 月份提出的一个问题的重复： [Emulate MySQL LIMIT Clause in Microsoft SQL Server 2000](https://stackoverflow.com/questions/216673/emulate-mysql-limit-clause-in-microsoft-sql-server-2000)

如果您使用的是 Microsoft SQL Server 2000，则没有好的解决方案。大多数人不得不求助于在带有`IDENTITY`主键的临时表中捕获查询结果。然后使用条件查询主键列`BETWEEN`。

如果您使用的是 Microsoft SQL Server 2005 或更高版本，则您有一个`ROW_NUMBER()`函数，因此您可以获得相同的结果但避免使用临时表。

```
SELECT t1.*
FROM (
    SELECT ROW_NUMBER OVER(ORDER BY id) AS row, t1.*
    FROM ( ...original SQL query... ) t1
) t2
WHERE t2.row BETWEEN @offset+1 AND @offset+@count; 
```

您也可以将其编写为[公用表表达式](http://msdn.microsoft.com/en-us/library/ms190766.aspx)，如@Leon Tayson 的[回答](https://stackoverflow.com/questions/603724/how-to-implements-limit-with-microsoft-sql/603746#603746)中所示。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-03-02T20:05:16.863

```
SELECT  *
FROM    (
        SELECT  TOP 20
                t.*, ROW_NUMBER() OVER (ORDER BY field1) AS rn
        FROM    table1 t
        ORDER BY
                field1
        ) t
WHERE   rn > 10 
```

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2012-03-06T12:13:50.087

语法上 MySQL LIMIT 查询是这样的：

```
SELECT * FROM table LIMIT OFFSET, ROW_COUNT 
```

这可以翻译成 Microsoft SQL Server 之类的

```
SELECT * FROM 
(
    SELECT TOP #{OFFSET+ROW_COUNT} *, ROW_NUMBER() OVER (ORDER BY (SELECT 1)) AS rnum 
    FROM table
) a
WHERE rnum > OFFSET 
```

现在您的查询`select * from table1 LIMIT 10,20`将是这样的：

```
SELECT * FROM 
(
    SELECT TOP 30 *, ROW_NUMBER() OVER (ORDER BY (SELECT 1)) AS rnum 
    FROM table1
) a
WHERE rnum > 10 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-02T19:56:34.760

```
SELECT TOP 10 * FROM table; 
```

是相同的

```
SELECT * FROM table LIMIT 0,10; 
```

[这是一篇关于在 MsSQL 中实现 Limit 的文章，](http://www.select-sql.com/mssql/how-to-make-limit-from-to-in-mssql-2005.html)读起来很不错，特别是评论。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-04-17T03:10:17.773

这是我尽量避免使用 MS Server 的原因之一……但无论如何。有时您只是没有选择（是的！我必须使用过时的版本！！）。

我的建议是创建一个虚拟表：

从：

```
SELECT * FROM table 
```

到：

```
CREATE VIEW v_table AS    
    SELECT ROW_NUMBER() OVER (ORDER BY table_key) AS row,* FROM table 
```

然后只需查询：

```
SELECT * FROM v_table WHERE row BETWEEN 10 AND 20 
```

如果添加或删除字段，“行”会自动更新。

这个选项的主要问题是 ORDER BY 是固定的。因此，如果您想要不同的顺序，则必须创建另一个视图。

**更新**

这种方法还有另一个问题：如果您尝试过滤数据，它将无法按预期工作。例如，如果您这样做：

```
SELECT * FROM v_table WHERE field = 'test' AND row BETWEEN 10 AND 20 
```

WHERE 仅限于那些在 10 到 20 之间的行中的数据（而不是搜索整个数据集并限制输出）。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-04-12T11:21:31.210

一定要试。在下面的查询中，您可以看到分组依据、排序依据、跳过行和限制行。

```
select emp_no , sum(salary_amount) from emp_salary
Group by emp_no 
ORDER BY emp_no 
OFFSET 5 ROWS       -- Skip first 5 
FETCH NEXT 10 ROWS ONLY; -- limit to retrieve next 10 row after skiping rows 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-02T20:09:20.457

这是一种适用于 SQL2000 的多步骤方法。

```
-- Create a temp table to hold the data
CREATE TABLE #foo(rowID int identity(1, 1), myOtherColumns)

INSERT INTO #foo (myColumns) SELECT myData order By MyCriteria

Select * FROM #foo where rowID > 10 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-02-28T15:28:12.153

```
SELECT 
    * 
FROM 
    (
        SELECT 
            top 20              -- ($a) number of records to show
            * 
        FROM
            (
                SELECT 
                    top 29      -- ($b) last record position
                    * 
                FROM 
                    table       -- replace this for table name (i.e. "Customer")
                ORDER BY 
                    2 ASC
            ) AS tbl1 
        ORDER BY 
            2 DESC
    ) AS tbl2 
ORDER BY 
    2 ASC;

-- Examples:

-- Show 5 records from position 5:
-- $a = 5;
-- $b = (5 + 5) - 1
-- $b = 9;

-- Show 10 records from position 4:
-- $a = 10;
-- $b = (10 + 4) - 1
-- $b = 13;

-- To calculate $b:
-- $b = ($a + position) - 1

-- For the present exercise we need to:
-- Show 20 records from position 10:
-- $a = 20;
-- $b = (20 + 10) - 1
-- $b = 29; 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-01-23T05:04:40.700

在 SQL 中，不存在 LIMIT 关键字。如果您只需要有限数量的行，则应使用类似于 LIMIT 的 TOP 关键字。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-02-03T13:08:26.040

简单的方法

MYSQL：

```
SELECT 'filds' FROM 'table' WHERE 'where' LIMIT 'offset','per_page' 
```

微软SQL：

```
SELECT 'filds' FROM 'table' WHERE 'where' ORDER BY 'any' OFFSET 'offset' 
ROWS FETCH NEXT 'per_page' ROWS ONLY 
```

ORDER BY 是强制性的

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-10-11T05:29:51.893

如果您的 ID 是唯一标识符类型或您在表中的 id 未排序，您必须按照以下方式进行操作。

```
select * from
(select ROW_NUMBER() OVER (ORDER BY (select 0)) AS RowNumber,* from table1) a
where a.RowNumber between 2 and 5 
```

代码将是

```
从限制 2,5 中选择 *
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-08-09T01:54:02.870

> 更好地在 MSSQLExpress 2017 中使用它。

```
SELECT * FROM
(
    SELECT ROW_NUMBER() OVER (ORDER BY (SELECT 0)) as [Count], * FROM table1
) as a
WHERE [Count] BETWEEN 10 and 20; 
```

-- 给出一个列 [Count] 并为每一行分配一个唯一的计数而不订购一些东西，然后再次重新选择你可以提供限制的地方.. :)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-12-14T10:55:34.617

获得结果的可能方法之一如下，希望这会有所帮助。

```
declare @start int
declare @end int
SET @start = '5000';  -- 0 , 5000 ,
SET @end = '10000'; -- 5001, 10001
SELECT * FROM ( 
  SELECT TABLE_NAME,TABLE_TYPE, ROW_NUMBER() OVER (ORDER BY TABLE_NAME) as row FROM information_schema.tables
 ) a WHERE a.row > @start and a.row <= @end 
```

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2009-03-02T20:02:12.500

如果我没记错的话（自从我使用 SQL Server 已经有一段时间了）你可以使用这样的东西：（2005 年及以上）

```
SELECT
    *
   ,ROW_NUMBER() OVER(ORDER BY SomeFields) AS [RowNum]
FROM SomeTable
WHERE RowNum BETWEEN 10 AND 20 
```

# algorithm - 哪种算法可以解决极高的非突发错误？

> ID：603727
> 
> 赞同：2
> 
> 时间：2009-03-02T19:55:49.927
> 
> 标签：algorithm, binary, random, error-correction

我有一个错误率非常高的二进制流。错误率为 50%，这意味着每个位都有 50% 的机会被翻转。该错误不会以突发形式发生并且是完全随机的，因此 Reed-Solomon 码不能很好地工作。

我应该将哪种方案或算法应用于流？我根本不在乎开销。

这都是理论上的，所以问我是否可以减少流的错误是没有意义的。

**编辑**

不要说它不可能，它告诉你的第一个答案是有可能的[噪声信道编码定理。](http://en.wikipedia.org/wiki/Noisy_channel_coding_theorem)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T20:04:08.143

如果错误率为 50%，那基本上是随机噪声，不是吗？我的意思是，考虑只尝试传输一个比特。如果您发送正确位的*无限*流，错误率是 50%，无论正确位是 1 还是 0，您都会得到一半 1 和一半 0。

如果它实际上小于 50%（例如 50% 的位将是“随机”而不是“翻转”），那么您可以重复数据 - 传输每个位 128 次并计算出每 100 位您获得的更多已收到。那是简单的代码，非常低效，根本不是数学解决方案:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T20:02:21.190

好吧，Reed-Solomon 纠错的全部意义在于，大多数现实世界的错误都发生在突发中，因此您可以对数据进行交织和去交织。如果您的错误是完全随机的，即泊松分布，那么只需以简单、数学上有效的方式将冗余添加到流中即可。您可以看到的一件事是某种隐藏的马尔可夫模型，例如[格子代码。](http://en.wikipedia.org/wiki/Trellis_modulation) 这基本上只是一种在数学上有效的添加冗余的方法。

另外，看看[嘈杂的信道编码定理。](http://en.wikipedia.org/wiki/Noisy_channel_coding_theorem) 严格来说，它不适用于数字数据，但如果这些位的来源是某个模拟过程，或者如果您可以将您的位建模*为好像*它们是某个模拟过程的结果，它可以让您深入了解什么你能做的最好的可能是。这将防止您浪费时间试图做得比数学上可能的更好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T20:17:56.753

当信道接近 50% 的实际噪声率时，根本无法再传输任何信息。对于 Jon Skeet 的回答，如果错误率低于 50% 的噪声，那么您可以通过对预期数据进行更长的突发冗余和统计查看结果以对原始值有一定程度的信心来获取数据。然后将基于噪声的特征推导出给定长度所需的突发长度和置信水平。但是，请理解，您在这里所做的是有效地降低数据速率以提高传输流的净信噪比。

在您的问题中，您可能已将其排除在外，但更好的编码方案可能基于数据流本身的相对存在（或不存在）。换句话说，要传输一个二进制......发送一个 1/0 的交替流。要发送零，不发送任何内容，或者发送恒定电平。这个想法是发送（和接收）任何东西代表一种状态，而发送（和接收）任何东西都代表另一种状态。这将有效地类似于数据的一种[双极编码](http://en.wikipedia.org/wiki/Bipolar_encoding)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T20:18:24.333

如果您的错误率为 50%，则比特流是随机的，并且与原始比特流没有关联。就像您正在用完全随机的比特流对流进行异或运算，结果是完全随机的。您对此无能为力。

为了使任何方案起作用，翻转率必须低于 50%。当然，它可能高于 50%，但是您可以先反转流，然后像错误率低于 50% 一样对其进行处理。

如果错误是完全随机的并且非常频繁（例如 25% 的位被翻转），则很难提出稳健的错误检测方案。您需要添加大量冗余。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T20:21:21.113

噪声信道编码定理表明您实际上可以实现信道的香农容量。它**并不是**说通道具有非零容量！

如果将通道中 100% 的位**随机化**，则其中 50% 将保持不变，因此您只需随机翻转 50% 的位。很明显，您不能通过这样的通道发送任何数据——它的香农容量为零。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T20:03:41.843

你看过涡轮代码吗？

——马库斯

嗬！我误认为 50% 是随机的，而不是 50% 的翻转。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T20:05:22.010

如果在任何给定的传输中*恰好有*50% 的位被翻转，而不是每个位都以 50% 的概率被翻转，您可以通过发送两位的传输来发送一些信息——发送 0 作为 00，发送 1 作为01.如果接收到的码字的第一位是1，则另一位不翻转。

# php - PHP 文件操作列表

> ID：603740
> 
> 赞同：1
> 
> 时间：2009-03-02T19:58:53.163
> 
> 标签：php, file-io

我正在寻找每个文件操作的列表。我在[http://www.google.se/search?q=Php+File+Operations](http://www.google.se/search?q=Php+File+Operations)上用 Google 搜索，但没有找到任何东西。

你知道在哪里可以找到 PHP 文件操作列表吗？

```
$file = fopen("words.txt","**r**"); the r is once File Operation 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T20:01:01.163

您的问题需要澄清，但请尝试 PHP 手册中的[PHP 文件系统函数](http://uk3.php.net/ref.filesystem)部分。（我所做的只是在 Google 上搜索“PHP 文件函数”）。

如果您要查找的是**文件打开*模式***（例如“r”等），那么您需要查看手册中[的 fopen() 页面（页面](http://uk3.php.net/fopen)下方有一个表格）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T20:01:02.893

在这里，它们在左侧列出了所有文件功能，在该文档的正文中，它们具有您可以在 fopen 中使用的所有模式

[关联](http://is.php.net/manual/en/function.fopen.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T20:01:14.203

[http://www.php.net/manual/en/ref.filesystem.php](http://www.php.net/manual/en/ref.filesystem.php)你在找什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T20:33:16.170

如果您在 php 中进行文件工作，我强烈建议您查看 SPL 库，因为它们是一个更好的 API，并且可以启动 OO。

一般 SPL 信息可以在这里找到：[http](http://www.php.net/~helly/php/ext/spl/) ://www.php.net/~helly/php/ext/spl/ 还有一个不错的教程：[http://www.phpro.org/tutorials/Introduction-to-SPL。 html](http://www.phpro.org/tutorials/Introduction-to-SPL.html)

# visual-studio - 如何合并两个不同的 Visual Studio 解决方案？

> ID：603744
> 
> 赞同：39
> 
> 时间：2009-03-02T19:59:59.900
> 
> 标签：visual-studio, visual-studio-2005

我有两个 Visual Studio 2005 解决方案，其中一个构建二进制文件及其所有依赖项，其中一个构建 Web 应用程序和一些实用程序以及它们的安装程序。到目前为止，我们已经将上述二进制文件作为静态文件包含在安装程序中；我想从该二进制文件的解决方案中获取所有项目，并让它们成为安装程序解决方案的一部分，以便一次性构建所有内容。

据我所知，我无法在不丢失依赖信息的情况下从二进制解决方案中添加现有项目。这会起作用，但是由于涉及到 20 个项目，我想在移动项目时保留依赖信息。看起来我可能只需要在文本编辑器中使用解决方案 XML 执行此操作......有没有更好的方式？

请注意，这与有关合并同一解决方案文件的两个版本的相关问题不同。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-03-02T20:54:09.367

有一种方法可以在 Visual Studio 中内置。右键单击解决方案，然后选择添加 - 现有项目。从那里选择其他解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-02-23T17:30:59.263

如果你想自动化这个过程，你可以尝试使用这个工具

[http://code.google.com/p/merge-solutions/](http://code.google.com/p/merge-solutions/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T20:24:15.180

您可能需要考虑使用引用而不是依赖项。这些存储在项目的文件中，因此在解决方案中保留。可能有一些事情可以用依赖关系而不是引用来完成，但是我不知道有任何这种情况，对于简单的用途来说，引用就绰绰有余了。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-02T20:39:22.320

尝试选择树中的所有项目节点，然后将它们拖放到另一个解决方案中。

# ruby-on-rails - 创建关联后可以使用哪些方法？

> ID：603745
> 
> 赞同：1
> 
> 时间：2009-03-02T20:00:04.083
> 
> 标签：ruby-on-rails

我刚刚开始使用 RoR，所以我确信这是非常基本的。假设我有两个模型：Account 和 Transaction

```
class Account < ActiveRecord::Base
    has_many :transactions
end

class Transaction < ActiveRecord::Base
    belongs_to :account
end 
```

建立此关联后，哪些方法（针对每个模型）可用/自动生成？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T20:11:18.063

这取决于。一些方法（例如Account#transactions、Transaction#account）从一开始就存在。其他的将根据需要（通过 method_missing 钩子）创建，例如动态查找器。确切的列表可能取决于其他因素，包括其他地方使用的acts_as 等。

您是否关心创建了哪些或所有可能性是什么？

——马库斯

PS 更多信息请看这里：

[http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T04:49:01.033

从你的 Rails 应用程序的根目录运行脚本/控制台，然后你可以像这样探索所有的魔法模型方法：

```
> account = Account.new  
> account.methods
> ...[long list of methods]...
> transaction = Transaction.new  
> transaction.methods
> ...[long list of methods]... 
```

您将获得对象的所有方法的长列表，包括生成的方法。所有方法都将在没有换行符的情况下列出 - 并且有 100 多种方法可能难以阅读。您可以使用主目录中的 .irbrc 文件和一些自定义方法来格式化 irb 中的输出，使其更易于阅读。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T20:35:59.783

继续inkdeep的回答：你可以在你的视图中输出这样的东西，所以它的格式是：

@transaction.methods.each 做 |method| 方法+“
”结束

我正在使用 HAML，所以语法有点不同，但只需查找“do”

# apache2 - 跨多个域为同一子域编写虚拟主机的方法？

> ID：603753
> 
> 赞同：0
> 
> 时间：2009-03-02T20:01:06.000
> 
> 标签：apache2, virtualhost

我在 /etc/apache2/sites-enabled 中设置了几个域：

```
domain1.com
domain2.com
domain3.com 
```

我需要为每个设置 webmail.domain*.com。我可以为每个单独的虚拟主机文件执行此操作，但是有没有办法编写通配符虚拟主机以被所有域捕获？

此外，所有 webmail.*.com 请求都应为同一目录提供服务。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T20:12:58.857

[ServerAlias](http://httpd.apache.org/docs/2.2/mod/core.html#serveralias)允许使用通配符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T20:08:17.917

尽管我很刻薄，但看看[Apache 的 vhosts 文档](http://httpd.apache.org/docs/2.2/vhosts/)，答案似乎不是。您需要一个 FQDN，而不是一个通配符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T20:15:07.183

啊，这对我有用：

```
<VirtualHost *:80>
    ServerName webmail.domain.com
    ServerAlias webmail.*
    DocumentRoot /path/to/webmail
    UseCanonicalName Off
</VirtualHost> 
```

# c# - 布局 C# 类的最佳方式是什么？

> ID：603758
> 
> 赞同：45
> 
> 时间：2009-03-02T20:01:47.683
> 
> 标签：c#, coding-style

是否有标准的 C# 文件布局方式？比如字段，然后是属性，然后是构造函数等？

这是我通常做的，但我想知道是否有标准方法？

1.  嵌套类或枚举
2.  字段
3.  特性
4.  活动
5.  构造函数
6.  公共方法
7.  私有方法

人们将他们的领域组合在一起，还是将它们与属性放在一起？还是人们不担心订单？Visual Studio 似乎很难做到。

**编辑**：将有关 ReSharper 的其他部分移至此处：[使 Resharper 尊重您对代码顺序的偏好。](https://stackoverflow.com/questions/603805/make-resharper-respect-your-preference-for-code-order)

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-03-10T13:53:41.103

我倾向于使用[Microsoft StyleCop](http://code.msdn.microsoft.com/sourceanalysis)，它根据规则[SA1201](http://stylecop.soyuz5.com/SA1201.html)有一个固定的顺序：

> **原因** C# 代码文件中的某个元素相对于代码中的其他元素是乱序的。
> 
> **规则描述** 当文件中的代码元素不遵循标准排序方案时，就会违反此规则。
> 
> 为了遵守此规则，文件根级别或命名空间内的元素必须按以下顺序定位：
> 
> *   外部别名指令
> *   使用指令
> *   命名空间
> *   代表们
> *   枚举
> *   接口
> *   结构
> *   课程
> 
> 在类、结构或接口中，元素必须按以下顺序定位：
> 
> *   字段
> *   构造函数
> *   终结器（析构函数）
> *   代表们
> *   活动
> *   枚举
> *   接口
> *   特性
> *   索引器
> *   方法
> *   结构
> *   课程
> 
> 遵循基于元素类型的标准排序方案可以增加文件的可读性和可维护性，并鼓励代码重用。
> 
> 在实现一个接口时，有时需要将接口的所有成员彼此相邻地分组。如果界面包含不同类型的元素，这有时需要违反此规则。这个问题可以通过使用部分类来解决。
> 
> 1.  如果类还不是部分的，则将部分属性添加到类。
>     
>     
> 2.  添加第二个同名的部分类。可以将它放在同一个文件中，就在原始类的下方，或者放在第二个文件中。
>     
>     
> 3.  将接口继承和接口实现的所有成员移动到类的第二部分。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-02T20:07:36.873

我认为没有*最好*的方法。在布局方面有两件重要的事情需要考虑。首先最重要的是一致性。选择一种方法并确保整个团队都同意并应用布局。其次，如果您的班级变得足够大，以至于您正在搜索那些讨厌的属性所在的位置（或者必须实现区域以使其更容易找到），那么您的班级可能太大了。考虑嗅探它，并根据你的气味进行重构。

要回答 reshaper 问题，请检查**选项中的****类型成员布局**（在C **#**节点下）。这并不简单，但可以更改布局顺序。

 ***** * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T20:11:53.117

我不认为区域一定是错误代码的标志。但要确定你将不得不审查你所拥有的。正如我在[这里](https://stackoverflow.com/questions/5916/how-do-you-feel-about-code-folding/5929#5929)所说的，这就是我对代码进行区域化的方式。

枚举
声明
构造函数
方法
事件处理程序
属性

但最重要的是保持它的一致性和目的性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T20:11:02.667

我倾向于将私有数据聚集在一起，并倾向于将相关的方法/属性聚集在功能组中。

```
public class Whatever {
   // private data here
   int _someVal = kSomeConstant;

   // constructor(s)
   public Whatever() { }

#region FabulousTrick  // sometimes regionize it
   // fabulous trick code
   private int SupportMethodOne() { }
   private double SupportMethodTwo() { }
   public void PerformFabulousTrick(Dog spot) {
       int herrings = SupportMethodOne();
       double pieces = SupportMethodTwo();
       // etc
   }
#endregion FabulousTrick
   // etc
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-01T20:18:55.287

您可以尝试 Regionerate 来帮助解决这个问题。我真的很喜欢它，它是 Scott Hanselman 的选择。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-17T14:56:12.987

如前所述，我认为没有最好的方法。但是某些组织确实可以帮助您成为程序员。

在一个漫长的项目中，您多久会花时间在一个或多个源文件上来回寻找您的功能之一。

所以我`#region`以这种方式利用了很多——

1.  **region Events**：这个类使用的所有事件引用（至少在这个特定的部分类中）。

2.  **区域控件**：直接与窗体上的控件交互的所有功能。

3.  **region MDI** : 设置 mdi

    然后会有一些与功能而不是界面有关，

4.  **区域正则表达式搜索**

我一边走一边编，但使用我一直使用的相同模式。我必须说，一些接手我的工作的程序员告诉我，它很容易理解，而另一些程序员则告诉我它很乱。

你可以在一半的时间取悦一半的人，另一半的四分之一的时间和另一半的时间让包括你自己在内的每个人都感到困惑。我认为 Winston Chrchil 是这么说的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T20:11:44.927

不管怎样让你更有效率。有些喜欢属性访问器旁边的私有字段，有些喜欢构造函数上方的字段。最大的帮助是对“喜欢”元素进行分组。我个人喜欢将私有方法、私有属性等结合在一起。

一次又一次地尝试一些事情，无论你觉得什么都能让你更有效率，并帮助你保持代码的维护。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-02T20:13:54.533

每个都有自己的，但我倾向于遵循 MSDN 帮助遵循的相同顺序。

我也不喜欢嵌套类或枚举，而是为它们创建单独的文件，这也使得编写单元测试更容易（因为当您需要添加/修复/重构测试时很容易找到关联的测试文件）。

恕我直言，顺序并不那么重要，因为 VS 可以很容易地找到所有成员（尤其是如果您遵循每个文件的一个类/接口/枚举方法），如果您想构建文档，Sandcastle 会将它们分组，所以我d 更关心给他们起有意义的名字。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-10T19:57:02.947

除了在类文件中保持一组一致的区域之外，我还按字母顺序保持区域的所有组件。在阅读代码时，我倾向于有一点“视觉记忆”，这让我不得不使用导航下拉菜单在文件中查找代码，因为它到处都是。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-10T20:03:59.780

我使用以下布局：

事件全局/类范围的字段私有/内部属性方法公共/受保护的属性方法嵌套类（尽管我尽量避免这些）

我也坚信每个文件有 1 个代码“事物”（类、接口或枚举），文件名与“事物”名称相同。是的，它是一个更大的项目，但它使查找东西变得非常容易。

# visual-studio-2008 - 视觉工作室的错误烦人，有什么解决办法吗？

> ID：603763
> 
> 赞同：1
> 
> 时间：2009-03-02T20:02:20.957
> 
> 标签：visual-studio-2008

运行视觉工作室 2008 sp1。当我在不调试 Web 应用程序的情况下运行时，它会打开 2 个 IE 浏览器窗口？我的代码中没有任何东西在这样做！我似乎找不到任何有关如何解决此问题的信息。有没有人遇到过这个？有解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-03-01T12:49:10.850

你有多个网络项目吗？

检查项目设置中 Web 选项卡上的启动选项并查看它们的设置。

如果这没有帮助，请尝试创建一个新项目，看看它是否也有同样的效果。如果没有，请尝试区分 csproj 文件（或 csproj.user，如果您已将其设置为将设置存储在单独的文件中）。

# apache - 如何从 Apache 重定向到 Tomcat？

> ID：603765
> 
> 赞同：37
> 
> 时间：2009-03-02T20:02:28.023
> 
> 标签：apache, url, tomcat, ports

我正在开发我的第一个 Java 网站。我在端口 8080 上运行 Apache Tomcat，在端口 80 上运行 Apache HTTPD。我可以访问该站点的当前 URL 是（例如）123.4.5.6:8080。在将域指向新 IP 之前，我想从 URL 中**删除端口号。**

目前我只将 Apache 用于 phpmyadmin，但是我计划将它用于 CGI 脚本和其他东西，一旦我弄清楚`mod_jk`等等......所以我不想将 Tomcat 的端口更改为 80 并关闭 Apache。

我希望这是有道理的。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-02T20:09:59.520

正确的做法是将 Apache 保留在 80，将 Tomcat 保留在 8080，并使用插件（最好是 mod_proxy）从 Apache 代理 Tomcat。mod_proxy 只需 10 分钟即可完成设置。

这个方法很容易[理解。](http://tomcat.apache.org/tomcat-4.1-doc/proxy-howto.html)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-02T20:50:05.553

正如您已经提到的，完成此操作的常用方法是使用`mod_jk`Apache HTTPD 转发您希望由 Tomcat 处理的内容。

在 tomcat.apache.org 上有一个[Quick HowTo 。](http://tomcat.apache.org/connectors-doc/generic_howto/quick.html)您需要执行以下操作：

*   复制`mod_jk.so`到 Apache HTTPD 的相应模块目录中。
*   创建配置文件`workers.properties`
*   在 Apache HTTPD 中`httpd.conf`，添加一个配置部分`mod_jk`。
*   确保将 Tomcat 配置为接受`mod_jk`协议，该协议通常位于端口 8009 上。

`httpd.conf`中的行`JkMount`：

```
JkMount  /examples/* worker1 
```

告诉 Apache HTTPD 哪些请求将被转发到 Tomcat。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T22:32:14.217

上面两个有用的答案都很好，但我更喜欢`mod_proxy`. `mod_jk`mod_proxy 不需要额外的安装，不像`mod_jk`，而且设置更容易。 `mod_jk`使您可以更好地控制 Tomcat 参数的详细调整，但如果您只是想要从 Apache 到 Tomcat 的简单重定向，`mod_proxy`这是可行的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-30T09:32:40.863

如果您希望由 Apache 而不是 Tomcat 提供静态内容，您应该使用 mod_jk：http: [//tomcat.apache.org/tomcat-6.0-doc/proxy-howto.html](http://tomcat.apache.org/tomcat-6.0-doc/proxy-howto.html)

那么 SSL 呢？如果我们希望 Apache 处理 HTTPS，因为它比 java/Tomcat 更快？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-16T16:42:11.453

您应该使用此链接配置您的 tomcat。对于 tomcat 7 [http://tomcat.apache.org/tomcat-7.0-doc/proxy-howto.html](http://tomcat.apache.org/tomcat-7.0-doc/proxy-howto.html)

# java - 如何形成从 HashMap 中提取的值的有序列表？

> ID：603766
> 
> 赞同：0
> 
> 时间：2009-03-02T20:02:38.867
> 
> 标签：java, iterator, hashmap

我的问题实际上比问题所暗示的更微妙，但想保持标题简短。

我有一个`HashMap<String, File>`对象`File`作为值。键是作为实例`String name`一部分的字段`File`。我需要遍历 中的值`HashMap`并将它们作为单个返回`String`。

这是我目前拥有的：

```
private String getFiles()
{   
    Collection<File> fileCollection = files.values();
    StringBuilder allFilesString = new StringBuilder();

    for(File file : fileCollection) {
        allFilesString.append(file.toString());
    }
    return allFilesString.toString();
} 
```

这可以完成工作，但理想情况下，我希望将单独的`File`值附加到按`StringBuilder`顺序排列的`int fileID`，这是`File`类的一个字段。

希望我已经说得够清楚了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T20:14:26.090

像这样的东西应该工作：

```
List<File> fileCollection = new ArrayList<File>(files.values());

Collections.sort(fileCollection, 
                 new Comparator<File>() 
                 {
                     public int compare(File fileA, File fileB) 
                     {
                         final int retVal;

                         if(fileA.fileID > fileB.fileID)
                         {
                             retVal = 1;
                         }
                         else if(fileA.fileID < fileB.fileID)
                         {
                             retVal = -1;
                         }
                         else
                         {
                             retVal = 0;
                         }

                         return (retVal);                         
                     }
                 }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T20:05:50.607

不幸的是，无法以任何可识别的顺序从 HashMap 中获取数据。您必须使用使用 fileID 的 Comparator 将所有值放入 TreeSet，或者将它们放入 ArrayList 并使用 Collections.sort 对它们进行排序，再次使用 Comparator 比较您想要的方式。

如果有任何重复项，TreeSet 方法将不起作用，并且它可能会有点过分，因为您不会在 Set 中添加内容或从中删除内容。Collections.sort 方法是一个很好的解决方案，例如，您将获取整个 HashSet，对结果进行排序，然后在生成结果后立即丢弃已排序的集合。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T23:55:29.430

好的，这就是我想出的。似乎解决了这个问题，返回一个字符串，其中的 File 对象按它们的 fileId 很好地排序。

```
public String getFiles()
{   
    List<File> fileList = new ArrayList<File>(files.values());

    Collections.sort(fileList, new Comparator<File>()
                               {
                                   public int compare(File fileA, File fileB)
                                   {
                                       if(fileA.getFileId() > fileB.getFileId()) 
                                       {
                                           return 1;
                                       }
                                       else if(fileA.getFileId() < fileB.getFileId()) 
                                       {
                                           return -1;
                                       }
                                       return 0;
                                   }
                               });

    StringBuilder allFilesString = new StringBuilder();

    for(File file : fileList) {
        allFilesString.append(file.toString());
    }
    return allFilesString.toString();
} 
```

我以前从未使用过 Comparator（对 Java 来说相对较新），所以如果我实现了任何不正确的东西，我将不胜感激。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T20:06:45.220

为什么不将它收集到一个数组中，对其进行排序，然后将其连接起来呢？

——马库斯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T20:10:00.253

您必须将您的 values() 集合添加到 ArrayList 并使用 Collections.sort() 和自定义 Comparator 实例对其进行排序，然后再对其进行迭代。

顺便说一句，请注意，用集合的大小初始化 StringBuffer 是没有意义的，因为您将为每个集合元素添加超过 1 个字符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T20:10:21.030

创建一个临时列表，然后将每对数据添加到其中。根据您的自定义比较器使用 Collections.sort() 对其进行排序，然后您将拥有所需顺序的列表。

这是您正在寻找的方法：http: [//java.sun.com/javase/6/docs/api/java/util/Collections.html#sort (java.util.List,%20java.util.Comparator )](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#sort(java.util.List,%20java.util.Comparator))

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T20:47:17.137

在将 LinkedHashMap 添加到集合之前，我创建了十几次。

您可能想要做的是创建一个 TreeHashMap 集合。

创建第二个集合并将添加的任何内容附加到两者中并不是真正的大小命中，并且您可以获得两者的性能（添加时会花费一点时间）。

将其作为一个新集合来帮助您的代码保持干净整洁。集合类应该只有几行长，并且应该替换您现有的哈希图......

如果您养成总是包装您的收藏品的习惯，那么这些东西就可以工作，您甚至都不会想到它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-04T07:04:31.340

```
StringBuffer allFilesString = new StringBuffer(fileCollection.size()); 
```

除非您的所有 file.toString() 平均是一个字符，否则您可能会使 StringBuffer 太小。（如果不正确，你最好不要设置它，让代码更简单）如果你将它设置为大小的倍数，你可能会得到更好的结果。此外，StringBuffer 是同步的，但 StringBuilder 不是同步的，因此这里效率更高。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-12T00:59:41.620

删除不必要`if`的语句。

```
List<File> fileCollection = new ArrayList<File>(files.values());
Collections.sort(fileCollection, 
             new Comparator<File>() {
                 public int compare(File a, File b) {
                     return (a.fileID - b.fileID);
                 }
             }); 
```

# c# - 处理程序覆盖 CancelEventArgs 上的 Cancel 属性

> ID：603769
> 
> 赞同：3
> 
> 时间：2009-03-02T20:02:59.690
> 
> 标签：c#, events, event-handling

[CancelEventArgs](http://msdn.microsoft.com/en-us/library/system.componentmodel.canceleventargs.aspx)提供了一个名为 Cancel 的属性，不同的事件处理程序可以设置它来告诉调用事件的对象是否应该继续执行取消操作。

似乎由于事件是多播委托，因此事件的简单引发可能会调用两个委托。第一个将 Cancel 属性设置为 true，第二个将 Cancel 属性设置为 false。组件/框架的“可取消”事件是否支持这些场景并逐个调用每个委托，在每一步检查取消标志？提出此类事件的最佳做法是什么？是否只有一个 CancelEventArgs 实例传递给每个委托？是否使用了单独的实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T20:21:46.697

一个小实验很快表明他们使用了 1 个 Cancel 实例（可能是 EventArgs 对象）。

这有点像一场赌博，结果取决于附加事件处理程序的顺序。

在 CancelEventArgs 的特殊情况下，我认为正确的模式是将 Cancel 设置为 true 或不理会它，因此顺序无关紧要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T23:13:14.600

测试：

```
public static void Main() {
    Event += (sender, e) => e.Cancel = true;
    Event += (sender, e) => e.Cancel = false;
    Event += (sender, e) => e.Cancel = true;

    var args = new CancelEventArgs();
    Event(null, args);

    WL(args.Cancel);
}

static event EventHandler<CancelEventArgs> Event; 
```

附加事件处理程序的顺序确实很重要。

一般来说，具有不可变事件参数的事件和多播委托不应一起使用，但 .NET 框架非常广泛地使用此类事件。

# macos - Mac OS X 中的环境变量

> ID：603785
> 
> 赞同：200
> 
> 时间：2009-03-02T20:07:20.460
> 
> 标签：macos, environment-variables

更新：下面的链接*没有完整的答案*。必须在两个地方（一个用于 GUI，一个用于 shell）设置路径或变量是蹩脚的。

**不重复**：[在 OS X 中设置环境变量？](https://stackoverflow.com/questions/135688/setting-environment-variables-in-os-x)

* * *

来自 Windows 背景，设置和修改环境变量非常容易（只需转到系统属性 > 高级 > 环境变量），在 Mac OS 10.5 上似乎并不那么简单。大多数参考资料都说我应该更新 /etc/profile 或 ~/.profile。这些等同于系统变量和用户变量吗？例如，我应该在哪里设置我的`JAVA_HOME`变量？

* * *

编辑：

我希望能够从终端以及像 Eclipse 这样的应用程序访问变量。另外，我希望我不必重新启动/注销即可使其生效。

* * *

## 回答 #1

> 赞同：312
> 
> 时间：2010-12-31T00:33:07.510

有几个地方可以设置环境变量。

*   `~/.profile`：将其用于您要在从终端启动的所有程序中设置的变量（注意，与 Linux 不同，在 Terminal.app 中打开的所有 shell 都是登录 shell）。
*   `~/.bashrc`：这是为不是登录 shell 的 shell 调用的。将其用于需要在子 shell 中重新定义的别名和其他内容，而不是用于继承的环境变量。
*   `/etc/profile`: 这是在 ~/.profile 之前加载的，但在其他方面是等效的。当您希望变量应用于机器上所有用户启动的终端程序时使用它（假设他们使用 bash）。
*   `~/.MacOSX/environment.plist`：这是由登录窗口在登录时读取的。它适用于所有应用程序，包括 GUI 应用程序，但 Spotlight 在 10.5（不是 10.6）中启动的应用程序除外。它需要您注销并再次登录才能使更改生效。自 OS X 10.8 起不再支持此文件。
*   您的用户`launchd`实例：这适用于用户启动的所有程序、GUI 和 CLI。您可以随时使用 中的`setenv`命令应用更改`launchctl`。*理论上*，您应该能够将`setenv`命令放入`~/.launchd.conf`，并`launchd`在用户登录时自动读取它们，但实际上从未实现对这个文件的支持。相反，您可以使用另一种机制在登录时执行脚本，并调用该脚本`launchctl`来设置`launchd`环境。
*   `/etc/launchd.conf`：这是在系统启动和用户登录时由 launchd 读取的。它们会影响系统上的每个进程，因为 launchd 是根进程。要将更改应用到正在运行的 root 启动，您可以将命令通过管道传输到`sudo launchctl`.

要理解的基本内容是：

*   环境变量在进程的子进程被分叉时被继承。
*   根进程是一个启动实例，每个用户会话也有一个单独的启动实例。
*   launchd 允许您使用`launchctl`;更改其当前环境变量 然后，更新后的变量将被它从那时起派生的所有新进程继承。

使用 launchd 设置环境变量的示例：

```
echo setenv REPLACE_WITH_VAR REPLACE_WITH_VALUE | launchctl 
```

现在，启动使用该变量的 GUI 应用程序，瞧！

要解决不起作用的事实`~/.launchd.conf`，您可以将以下脚本放入`~/Library/LaunchAgents/local.launchd.conf.plist`：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
  <key>Label</key>
  <string>local.launchd.conf</string>
  <key>ProgramArguments</key>
  <array>
    <string>sh</string>
    <string>-c</string>
    <string>launchctl &lt; ~/.launchd.conf</string>    
  </array>
  <key>RunAtLoad</key>
  <true/>
</dict>
</plist> 
```

然后你可以放`setenv REPLACE_WITH_VAR REPLACE_WITH_VALUE`里面`~/.launchd.conf`，每次登录都会执行。

请注意，当以这种方式将命令列表传递到 launchctl 时，您将无法使用包含空格的值设置环境变量。如果你需要这样做，你可以调用launchctl如下`launchctl setenv MYVARIABLE "QUOTE THE STRING"`：

另外，请注意在登录时运行的其他程序可能会在启动代理之前执行，因此可能看不到它设置的环境变量。

* * *

## 回答 #2

> 赞同：153
> 
> 时间：2010-09-21T01:20:54.273

没有必要重复。您可以使用`launchctl setenv`.

例如，如果您想在将当前路径设置在`.bashrc`或任何位置后将其镜像到 launchd：

```
PATH=whatever:you:want
launchctl setenv PATH $PATH 
```

环境变量不会在运行的应用程序中自动更新。您将需要重新启动应用程序以获取更新的环境变量（尽管您可以在 shell 中设置变量，例如`PATH=whatever:you:want`；无需重新启动终端）。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-12-02T14:23:53.867

我认为 OP 正在寻找的是一个简单的、类似 Windows 的解决方案。

给你：

[https://www.macupdate.com/app/mac/14617/rcenvironment](https://www.macupdate.com/app/mac/14617/rcenvironment)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-03-02T20:13:52.647

您可以在 linux 上阅读，它与 Mac OS X 非常接近。或者你可以阅读 BSD Unix，它更接近一点。在大多数情况下，Linux 和 BSD 之间的差异并不大。

`/etc/profile`是系统环境变量。

`~/.profile`是用户特定的环境变量。

“我应该在哪里设置我的 JAVA_HOME 变量？”

*   你有多个用户吗？他们在乎吗？您会通过更改 a 来搞乱其他用户`/etc/profile`吗？

一般来说，即使我是唯一的用户，我也不喜欢搞乱系统范围的设置。我更喜欢编辑我的本地设置。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-02T20:10:36.833

对于 GUI 应用程序，您必须创建和编辑`~/.MacOSX/environment.plist`. 更多细节[在这里](http://developer.apple.com/documentation/MacOSX/Conceptual/BPRuntimeConfig/Articles/EnvironmentVars.html)。您需要注销才能使这些生效。我不确定它们是否也会影响从终端启动的应用程序，但我认为它们会。

对于从终端启动的应用程序，您还可以编辑 ~/.profile 文件。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-09-04T21:10:14.813

**[使用osx-env-sync](https://github.com/ersiner/osx-env-sync)**从单一来源同步命令行和 GUI 应用程序的 OS X 环境变量。

[我还在这里](https://stackoverflow.com/a/32405815/258474)发布了一个相关问题的答案。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-04-12T09:03:43.187

只需通过终端打开`~/.profile`文件并在此处键入：`nano`

```
export PATH=whatever/you/want:$PATH 
```

保存此文件（cmd+X 和 Y）。之后，请再次注销/登录，或者在终端中打开一个新选项卡并尝试使用您的新变量。

请不要忘记在任何/您/想要的之后添加“：$PATH”，否则您将删除 PATH 变量中的所有路径，这些路径在此之前就在那里。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-07T08:38:26.177

我编写了一个工具来轻松管理 macOS 应用程序的环境变量。

[https://github.com/yuezk/macenv](https://github.com/yuezk/macenv)

您可以使用 设置环境变量`~/.macenv set`，例如：

```
~/.macenv set JAVA_HOME /path/to/java/home 
```

在后台，它调用`launchctl setenv`设置环境变量，`~/.launchd.conf`同时保存环境变量，并注册一个自动启动服务以在操作系统重新启动时加载环境变量。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-11-29T21:10:04.617

如果要在 macOS 上永久更改环境变量，请将它们设置为`/etc/paths`. *请注意*，此文件默认为只读，因此您必须**chmod**以获得写入权限。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2020-04-18T04:58:06.070

对于 2020 Mac OS X Catalina 用户：

忘记其他无用的答案，这里只需要两个步骤：

1.  使用命名约定创建一个文件：priority-appname。然后复制粘贴要添加的路径`PATH`。

    例如，在我的情况下`80-vscode`内容。`/Applications/Visual Studio Code.app/Contents/Resources/app/bin/`

2.  将该文件移动到`/etc/paths.d/`. 不要忘记在终端中打开一个新选项卡（新会话）并键入`echo $PATH`以检查您的路径是否已添加！

注意：此方法仅将您的路径**附加**`PATH`到.

# java - 将 SVN 与 CruiseControl 一起使用？

> ID：603786
> 
> 赞同：3
> 
> 时间：2009-03-02T20:07:34.983
> 
> 标签：java, svn, continuous-integration, cruisecontrol

我正在尝试使用[CruiseControl 2.7.3](http://cruisecontrol.sourceforge.net/index.html)（原版）来构建一个位于 SVN 存储库中的 Java 项目。

我的巡航配置使用[svn 插件](http://cruisecontrol.sourceforge.net/main/configxml.html#svn)作为修改集。当检测到修改时，将使用 Ant 计划构建。然后，该 Ant 构建文件使用 svnant Ant Task 对项目进行完整的检查。有一段时间，我们将此设置为仅签出“HEAD”，但我们遇到过构建不会触发一两次签入的情况，因为签入发生在修改集检查之后，但在 ant 调用之前svn结账。因此，我们试图更改 ant 构建文件以使用修改检查检索到的修订号。

CruiseControl 配置参考页面声称设置了一个属性[svnrevision](http://cruisecontrol.sourceforge.net/main/configxml.html#svn)并将其传递给构建器，就像 label 属性是由[labelincrementers 设置](http://cruisecontrol.sourceforge.net/main/configxml.html#labelincrementer)的一样。**当我按下强制建立**按钮 时，它似乎没有设置。

我需要做些什么来完成这件事吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T16:01:19.473

查看 SVN 源代码控制的代码，似乎 svnrevision 应该传递给构建器，从而传递给您的 Ant 调用。您是否尝试过使用 Ant 脚本中的属性？

针对评论中的问题：

那是因为在强制构建的情况下没有修改，所以没有修改修订号。在这种情况下，svnlabelincrementer 将传递您在本地拥有的最新版本号，这也是最新的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T21:20:58.007

Cruisecontrol ant 调用与这样构造的 (svn)label 无关。svn 标签用于注释构建名称，而 build.log 实际上只是 ant 的输出，因为它通过 Cruisecontrol 传递。

如果您想将修订号写入 ant 构建输出，基本上有两种方法：

一种方法是让 ant 以某种方式与 svn 交互。ant 中的 Svn 只能通过 tigris 的[contrib ant 任务](http://subclipse.tigris.org/svnant/svn.html)获得，因此将其放入您的 ant 文件中并非易事。但是在你的构建中，你可以做一个[svn info](http://subclipse.tigris.org/svnant/svn.html#info)并获取修订号作为你可以使用的 ant 属性。

另一种方法是使用 svnlabelincrementer 将修订号分配给标签，并使用从[Cruisecontrol](http://cruisecontrol.sourceforge.net/main/configxml.html#buildproperties)传递到构建脚本的构建属性将其传递给 ant 脚本。正如 Jay 在评论中提到的，标签仅包含最后一次成功的构建修订，这不是他想要的。[在这个博客](http://agileiscool.blogspot.com/2008/02/svnlabelincrementer-in-cruisecontrol.html)上已经提出了一个修复，但是在 ant 构建文件中进行工作似乎更合适。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T14:17:50.700

你可以使用安静期设置吗？提交后，CruiseControl 可以等待一段时间（比如 30 秒），然后再开始构建。

它不会为每个提交触发单独的构建。相反，大约在同一时间提交将启动单个构建。

# winforms - Winforms MDI 客户端区域的大小/位置

> ID：603788
> 
> 赞同：12
> 
> 时间：2009-03-02T20:07:55.890
> 
> 标签：winforms, mdi, mdichild, mdiparent

MDI 表单内部是一个客户区，它承载 mdi 子表单。我如何知道该区域有多大？到目前为止，我能想到的最好的方法是找到父级潜在客户区（mdiparent.ClientRectangle）的总大小，然后减去从客户区带走的工具栏等组件的大小。有没有更好的办法？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-02T22:21:00.373

窗体上没有属性可以让您访问 MDI 客户端窗口。但是你可以像这样找到它：

```
public MdiClient GetMdiClientWindow() {
  foreach (Control ctl in this.Controls) {
    if (ctl is MdiClient) return ctl as MdiClient;
  }
  return null;
} 
```

从那里，只需使用它的 Size 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T03:17:27.370

这是 vb.net 中该代码的变体：

```
Public Function GetMdiClientWindowSize() As Size
    For Each ctl As Control In Me.MdiParent.Controls
        If TypeOf ctl Is MdiClient Then
            Return ctl.Size
        End If
    Next
    Return Nothing
End Function 
```

# windows - 使用 GetSaveFileName。我指定了 OFN_EXPLORER 标志，但总是得到旧的对话框外观，除非我避免同时使用钩子和模板

> ID：603790
> 
> 赞同：2
> 
> 时间：2009-03-02T20:08:20.223
> 
> 标签：windows, winapi

使用 GetSaveFileName。我指定了 OFN_EXPLORER 标志，但我总是得到旧的对话框外观，除非我避免同时使用钩子和模板。（OPENFILENAME 结构中的 lpfnHook 和 lpfnTemplate（以及它们各自的“启用”标志））

如果我避免只使用其中一种，我仍然会得到旧的对话框外观。我也尝试不使用模板，但使用钩子......但总是从中返回 TRUE（我看到从钩子中提到“总是返回 false”作为获取旧界面的一种方式）。不过，它似乎没有任何效果。

编辑：添加了相关代码：

```
ofn.lStructSize=sizeof(OPENFILENAME);
ofn.hInstance=RhInst;
ofn.hwndOwner=MainWh;
ofn.lpstrFilter=s;
ofn.lpstrCustomFilter=null;
ofn.nMaxCustFilter=0;
ofn.nFilterIndex=sel;

ofn.lpstrFile=fname;
ofn.nMaxFile=lstrl;
ofn.lpstrFileTitle=tfile;
ofn.nMaxFileTitle=lstrl;

if (path && lstrlen(path)) ofn.lpstrInitialDir=path;
else ofn.lpstrInitialDir=drive;

lstrcpy(SE_DefExt,ext);
ofn.lpstrDefExt=SE_DefExt;
if (titleid) ofn.lpstrTitle=title;
else ofn.lpstrTitle=null;

ofn.lpfnHook=(CommHookProc)MakeProcInstance((FARPROC)SEOpen32Hook,hInst);
ofn.lpTemplateName=NULL;
ofn.Flags=OFN_SHOWHELP | OFN_OVERWRITEPROMPT | OFN_ENABLEHOOK  | OFN_EXPLORER
            | OFN_PATHMUSTEXIST | OFN_HIDEREADONLY;

if(allowfit)
    {
    ofn.lpTemplateName = MAKEINTRESOURCE(SAVETOFIT);
    ofn.Flags |= OFN_ENABLETEMPLATE;
    }

if (GetSaveFileName(&ofn))
    {
    // <snip>
    } 
```

请注意，在这种情况下，“allowfit”是非零/真。如果我注释掉 OFN_ENABLEHOOK 和 OFN_ENABLETEMPLATE 的标志设置，我会得到“新”对话框外观。

**编辑 2：
现在看起来我对所看到的感到困惑。我相信在这两种情况下，我都会得到“新的”OFN_EXPLORER 行为和外观。当我删除 OFN_EXPLORER 标志时，我得到一个非常老式的对话框。

我想要的是保存文件对话框的样式，该对话框在右上角有“后退”和“前进”按钮，以及（最重要的是）我可以输入的地址框。我以前的所有评论和代码描述（上图）仍然适用；当我删除模板和钩子时，我得到了我的“后退和前进”按钮，以及我的可键入地址框（加上左侧浏览树）......当我离开模板和钩子时——我没有（取而代之的是顶部的“保存在”选项列表，左侧的“标准位置”（“最近的位置”，“桌面”，...）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T16:40:02.297

你定义了`_WIN32_WINNT >= 0x0500`吗？将 lStructSize 设置为 win2000 大小可能有助于对话框决定（如果您需要支持 < NT5，则必须进行一些版本检查并`OPENFILENAME_SIZE_VERSION_400`用作下级系统的大小）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T10:39:50.020

As for the template, You should define DS_SHELLFONT. [http://blogs.msdn.com/oldnewthing/archive/2005/02/04/366987.aspx](http://blogs.msdn.com/oldnewthing/archive/2005/02/04/366987.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T17:14:38.393

如果您同时使用`OFN_EXPLORER`并`OFN_ENABLEHOOK`在 Windows Vista 和 7 中使用，您将获得 XP 风格的对话框。如果删除`OFN_EXPLORER`，您将获得较旧的 Win2k 样式。如果使用`OFN_ENABLEHOOK`(或`OFN_ENABLETEMPLATE`) 则系统将不会使用 Vista/7 样式。

从 Vista 开始，如果您想自定义此类对话框，建议您使用 COM 接口`IFileDialog`、`IFileOpenDialog`和`IFileSaveDialog`. 请参阅[http://msdn.microsoft.com/en-us/library/windows/desktop/bb776913(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776913(v=vs.85).aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T20:35:14.823

也许您需要显示一些代码？根据 MSDN：

> 您可以为资源管理器样式的“保存”对话框提供 OFNHookProc 挂钩过程。要启用挂钩过程，请在 OPENFILENAME 结构的 Flags 成员中设置 OFN_EXPLORER 和 OFN_ENABLEHOOK 标志，并在 lpfnHook 成员中指定挂钩过程的地址。

所以似乎除非你做一些奇怪的事情，否则它应该可以工作。

# c# - 让 ReSharper 尊重您对代码顺序的偏好

> ID：603805
> 
> 赞同：2
> 
> 时间：2009-03-02T20:11:39.267
> 
> 标签：c#, coding-style, resharper

与我的另一个问题相关：[布局 C# 类的最佳方法是什么？](https://stackoverflow.com/questions/603758/whats-the-best-way-to-layout-a-c-class)

ReSharper 中有没有一种方法可以定义您希望成员所处的顺序，以便 ReSharper 维护它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T20:14:21.020

从[这个答案](https://stackoverflow.com/questions/603758/whats-the-best-way-to-layout-a-c-class/603787#603787)：

检查**选项中的****类型成员布局**（在C **#**节点下）。这并不简单，但可以更改布局顺序。

 ***** * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-09T12:30:12.560

检查Resharper 帮助文档中的[文件和类型布局-](https://www.jetbrains.com/help/resharper/File_and_Type_Layout.html)

> ReSharper 可以根据不同的模式对 C# 文件中的类型和类型成员进行重新排序。模式可以描述许多在对文件中的项目重新排序和/或用指定区域包装它们时评估的条件和约束。

该页面描述了这些模式是如何工作的，如何配置它们（这里有两个选项 - 使用可视化编辑器或编辑 XAML 源），最后，如何应用您的设置。

# generics - 将 iBATIS.NET 与通用自定义集合接口和 Unity 结合使用

> ID：603808
> 
> 赞同：1
> 
> 时间：2009-03-02T20:12:16.657
> 
> 标签：generics, collections, unity-container, ibatis.net

我正在尝试在使用 iBATIS.NET 映射的类 O/R 中使用通用自定义集合接口（以支持使用 Microsoft Patterns and Practices Unity 进行注入）。有谁知道这是否可行，如果可以，该怎么做？

我有一个 IDataItemCollection<T> 接口，我映射到扩展 CollectionBase 的 SqlDataItemCollection<T>。我想在我的类中使用 IDataItemCollection<T>，以便可以将 SqlDataItemCollection<T> 与通过 Unity 扩展接口的其他类交换。iBATIS.NET 映射文件可以直接引用具体类，因为没有一个就没有另一个。

下面我包含了一个非常简化的代码、数据库和映射示例。我对 iBATIS.NET 完全陌生，现在真的只是想证明它的用途，所以请根据需要重新调整映射 XML。

非常感谢，

保罗

* * *

C# 代码

```
public interface IDataItem
{
    object Id { get; set; }
}

public class DataItem : IDataItem
{
    public object Id { get; set; }
}

public interface IDataItemCollection<T> : ICollection where T : IDataItem
{
    // Various Getters and Setters
...
}

public class SqlDataItemCollection<T> : CollectionBase, IDataItemCollection<T> where T : DataItem
{
    public SqlDataItemCollection() { }
    public SqlDataItemCollection(T injType) { }

    // Getters and Setters to implement interfaces
...
}

public class Foo : DataItem
{
    public Foo(IDataItemCollection<Bar> bars)
    {
        Bars = bars;
    }

    public IDataItemCollection<Bar> Bars { get; set; }
}

public class Bar : DataItem { } 
```

SQL Server 2005 数据库

```
CREATE TABLE Foo
(
    Id bigint IDENTITY(1,1)
)

CREATE TABLE Bar
(
    Id bigint IDENTITY(1,1)
)

CREATE TABLE FooBar
(
    FooId bigint,
    BarId bigint
) 
```

iBATIS.NET 映射.xml

```
<resultMaps>
    <resultMap id="FooResult" class="Foo">
        <result property="Id" column="Id"/>
        <result property="Bars" column="Id" select="SelectBarsInFoo" lazyLoad="false"/>
    </resultMap>

    <resultMap id="BarResult" class="Bar">
        <result property="Id" column="Id"/>
    </resultMap>
</resultMaps>

<statements>
    <select id="SelectFoo" resultMap="FooResult">
        SELECT Id
        FROM Foo
    </select>

    <select id="SelectBarsInFoo" parameterClass="long" resultMap="BarResult" listClass="SqlDataItemCollection`1[Bar]" >
        SELECT Bar.Id
        FROM Bar
        JOIN FooBar ON Bar.Id = FooBar.BarId
        WHERE FooBar.FooId = #value#
    </select>
</statements> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-07-01T19:56:11.940

在将我的应用程序的一部分重构回接口后，我也遇到了同样的问题。我通过显式实现我的集合的接口定义然后将实现复制为其具体类来解决它。这可能无法解决您的问题。

```
public interface IGroup { }
public class Group : IGroup { }
public class IGroupCollection : IList<IGroup> { }
public class GroupCollection : IGroupCollection { }

public interface IConcrete
{
    IGroupCollection Items { get; set; }
}

public class Concrete : IConcrete
{
    public GroupCollection Items { get; set; }
    IGroupCollection IConcrete.Items
    {
        get { return Items; }
        set { Items = value as GroupCollection; }
    }
} 
```

这允许 iBATIS.NET 将项目添加到集合中而不会遇到类型转换错误，而显式接口实现允许我在`IConcrete`整个应用程序中使用 s 而无需参考实际`Concrete`或实际的`GroupCollection`.

# c# - TDD：静态方法、依赖注入、缓存，还有你！

> ID：603821
> 
> 赞同：5
> 
> 时间：2009-03-02T20:14:24.750
> 
> 标签：c#, oop, tdd

希望我能稍微体面地解释一下，因为它今天在我的大脑中烧毁了保险丝。我正在学习 C# 中的 TDD，所以我仍在尝试重新连接我的大脑以适应它。

假设我有一个**User**类，它以前有一个静态方法来检索 User 对象（下面简化了）。

```
public static User GetUser(string username)
{
   User user = GetUserFromCache(username);
   if(user == null)
   {
       user = GetUserFromDatabase(username);
       StoreObjectInCache(user);
   }
   return user;
} 
```

所以我试图重写它以使用依赖注入，所以如果需要去那里，我可以伪造“GetUserFromDatabase”方法。这意味着我必须使函数不是静态的。数据访问层将从数据库构造用户对象，将返回的列映射到对象属性，而从缓存中检索将返回一个真正的蓝色**用户**对象。但是，在非静态方法中，我不能只说

```
this = GetUserFromCache(username); 
```

因为它只是不那样工作。虽然我绝不是如何与 OO 一起跳舞的世界专家，但看起来我几乎必须从缓存中获取 User 对象并编写另一个映射函数，将返回的 User 对象属性存储到新的用户实例。

这里有什么解决方案？我缺少任何 OO 魔法吗？是重构一切以使用工厂而不是在对象本身中具有实例化逻辑的唯一解决方案吗？还是我一直盯着这个太久而错过了一些完全明显的东西？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T20:26:02.180

我不认为你错过了任何魔法，我认为重构以从你的业务对象中删除持久性代码并进入你的持久性层是从单元测试和设计角度来看的正确方法。您可能想考虑让缓存位于业务层和持久层之间，调解业务对象的检索/更新以简化事情。如果您以这种方式将事物分开，您应该能够模拟/伪造您的缓存和持久层。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T20:31:54.270

[根据今天的日期进行日期处理的单元测试代码](https://stackoverflow.com/questions/565289/unit-testing-code-that-does-date-processing-based-on-todays-date/565315#565315)

前

*   有一些代码使用数据库来获取用户并将其放入缓存中。

后

*   有一些代码使用数据库来获取用户
*   有一些代码将用户放在缓存中。

这两组代码不应相互依赖。

```
public static Func<string, UserName> Loader {get;set;}

public static Constructor()
{
  Loader = GetFromDataBase;
}

public static User GetUser(string userName)
{
  User user = GetUserFromCache()
  if (user == null)
  {
    user = Loader(userName);
    StoreUserInCache(user);
  }
  return user;
}    

public void Test1()
{
  UserGetter.Loader = Mock.GetUser;
  UserGetter.GetUser("Bob");
} 
```

传统上，将使用接口而不是 Func。如果涉及多个方法，则接口是一个明显的选择，而不是 Func。如果方法实现本身是静态的，那么 Func 是一种对它们进行抽象的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T20:45:12.493

我在您的示例中缺少的是您调用“GetUser”的上下文。这可能是因为使用静态方法不需要考虑，因为您可以从任何地方调用它。在 DI 中，这意味着发送者需要以某种方式引用存储库，这很可能是一个字段。

当您的缓存是某个对象的字段时，可能是外观，您可以使用它使您的缓存成为数据库的代理。

所以你会有：

```
class ApplicationFacade{
  private IUserRepository users = null;

  public doStuff(){
    this.users.GetUser("my-name");
  }
} 
```

其中 IUserRepository 是缓存、假数据库和数据库的通用接口。像这样简单的东西：

```
interface IUserRepository{
  User GetUser(string username);
} 
```

您的缓存现在可以是实现此接口的简单对象，并且由于缓存被注入，DI 容器也可以注入其中。

```
class Cache : IUserRepository {
  private IUserRepository users = null;
  public User GetUser(string username){
    if (this.NotCached(username)){
      this.ToCache(this.users.GetUser(username));
    }
    return this.FromCache(username);
  }
} 
```

现在，根据您的需要，您可以将伪造、缓存或数据库注入到外观对象中，如果您使用缓存对象，则可以根据需要将伪造的 er 数据库注入其中（如果您真的想要，甚至可以注入其他缓存）。

当然，实际的注入机制取决于您的 DI 容器，并且可能需要一些额外的代码作为公共属性或构造函数字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T17:16:35.740

看看[Refactoring static method / static field for Testing](https://stackoverflow.com/questions/250137/refactoring-static-method-static-field-for-testing)

如果由于某种原因您无法按照另一个答案中的建议重构所有内容以分离关注点，那么建议的方法可能对您有用。

# java - Java：使用单例和泛型进行设计

> ID：603827
> 
> 赞同：4
> 
> 时间：2009-03-02T20:16:06.180
> 
> 标签：java, singleton, generics, predicate

我正在使用一个名为 Predicate 的接口，用于筛选集合。例如，我可以定义

```
public class BlackCatPredicate implements Predicate<Cat> {
  public boolean evaluate( Cat c ) {
       return c.isBlack();
  }
} 
```

然后使用一些实用`findAll( Collection<T> coll, Predicate<T> pred)`方法将谓词应用于 Cats 的集合，并只获取黑色的，等等。

我的问题是：我的代码中到处都是黑猫，所以没有必要一遍又一遍地实例化 BlackCatPredicate。它应该只有一个实例。（单例？）但是，在编写许多谓词的过程中，我不想将每个谓词都实现为单例。那么——这里的正确设计是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-02T20:23:06.367

我会使用一个匿名类常量并将其与它所操作的类放在一起：

```
public class Cat{
    public static final Predicate<Cat> BLACK_PREDICATE = new Predicate<Cat>(){
            public boolean evaluate( Cat c ) {
                return c.isBlack();
            }
        };

    // Rest of the Cat class goes here
} 
```

如果谓词有参数，则可以使用静态工厂方法。

**编辑：** 正如评论中所指出的，根据使用模式，它可能会导致更清晰的代码来收集单独的类中的谓词常量（和/或工厂方法），或者仅用于 Cat，或者全部。这主要取决于他们的数量，多少额外的组织是有帮助的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T20:21:04.577

像这样的东西应该工作：

```
class Predicates
{
    private static class BlackCatPredicate implements Predicate<Cat> 
    {
        public boolean evaluate(final Cat c) 
        {
            return c.isBlack();
        }
    }

    private static final BlackCatPredicate = new BlackCatPredicate(); 

    public static Predicate<Cat> getBlackCatPredicate()
    {
        return (blackCatPredicate);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T20:18:10.577

您可以创建一个将任何谓词作为类型 arg 的通用工厂 - 然后为给定的谓词类型生成单个实例。

另一种更通用的方法是开始使用依赖注入库 - 并通过它创建所有对象。通常，您可以在适当的情况下将类型切换为单例，而无需进行少量更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T20:46:16.937

我根本不用担心创建额外的`BlackCatPredicate`实例。

如果你不喜欢到处写`new BlackCatPredicate()`，你当然可以添加一个静态工厂方法，这样你就可以写`BlackCatPredicate.getInstance()`了。另一种选择是创建一个单独的类，以便您可以编写`CatPredicates.getBlackCatPredicateInstance()`.

然而，这只是为了从客户端代码中抽象出谓词的创建，它与实际的对象创建无关。处理短期对象是 JVM 最擅长的事情之一，因此创建一堆额外的`BlackCatPredicate`实例并立即丢弃它们不会丝毫影响您的性能。

# python - 你将如何在 wxPython FlexGridSizer 中绘制单元格边框？

> ID：603831
> 
> 赞同：2
> 
> 时间：2009-03-02T20:16:51.750
> 
> 标签：python, wxpython, drawing

我是 Python 新手，但我在网上找不到太多像样的文档，所以我希望有人知道答案或答案在哪里......

我有一个 wxPython FlexGridSizer 绑定到包含其他 FlexGridSizer 的面板，我想在主 FlexGridSizer 上显示一些单元格边框，所以每个部分看起来都是封装的，但我找不到任何文档来做到这一点。

我尝试使用面板添加到我的主 FlexGridView，并打开面板的边框，但面板的边框并不总是填满整个 FlexGridView 单元格，因此它看起来不连贯且不均匀。

有人知道如何正确模拟吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T22:17:12.270

Sizer 仅用于在空间上组织小部件，事实上它们是“不可见的”。

我认为你在每个单元格内放置一个面板并打开它的边界是正确的。尝试使用 wx.EXPAND 标志添加它，它有机会提供帮助。

关于文档：wxPython 本质上是 wxWidgets C++ 库的包装器（嗯，有一些额外的东西），所以几乎所有你需要的东西都可以在 wxwidgets 文档中找到。我发现[这个文档浏览器](http://wiki.wxwidgets.org/docbrowse.html)很有用。这里有一些关于为 wxPython 用户解释 C++ 文档的注意事项，但通常一切都很明显[。](http://wiki.wxpython.org/C%2B%2BGuideForwxPythoneers)

同样对于边框，您可能对 wx.StaticBox 或 wx.StaticBoxSizer （一组控件周围的蚀刻线框，通常带有标签）感兴趣

# mysql - MySQL：切换 int 字段值的简单方法

> ID：603835
> 
> 赞同：50
> 
> 时间：2009-03-02T20:19:09.327
> 
> 标签：mysql

我知道如何做到这一点，但我认为我会用双选等使它过于复杂。

你怎么能做到这一点（伪sql中的示例）

```
UPDATE some_table SET an_int_value = (an_int_value==1 ? 0 : 1); 
```

由于某些其他功能，它必须是一个 int 值，但是您如何以简单的方式做到这一点？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-09-22T16:27:25.817

```
UPDATE table SET field = 1 - field 
```

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2009-03-02T20:23:21.407

```
UPDATE some_table SET an_int_value = IF(an_int_value=1, 0, 1); 
```

[http://dev.mysql.com/doc/refman/5.1/en/control-flow-functions.html#function_if](http://dev.mysql.com/doc/refman/5.1/en/control-flow-functions.html#function_if)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-02T20:23:44.133

```
UPDATE some_table SET an_int_value = IF(an_int_value=1, 0, 1) 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-02T20:23:45.007

在这种情况下，您可以使用 XOR 类型的操作：

```
UPDATE some_table SET an_int_value = an_int_value XOR 1 
```

这是假设 an_int_value 将始终为 1 或 0。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-08-24T07:32:34.460

我可以看到所有有经验的人的答案，我也得到了他们的答案的更新。

这个呢……我是这样的……

```
UPDATE tablename SET fieldname = not fieldname 
```

如果这不是一个可行的解决方案，请任何机构提出建议。关于执行速度或任何其他......该说什么......事实......概念......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-02T20:24:31.870

另外一个选项：

```
UPDATE some_table SET an_int_value = ABS(an_int_value - 1); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-14T22:25:27.933

如果您使用的是 TINYINT（0 和 1），那么做一个简单的异或（[https://dev.mysql.com/doc/refman/8.0/en/logical-operators.html#operator_xor](https://dev.mysql.com/doc/refman/8.0/en/logical-operators.html#operator_xor)）

```
UPDATE
    `some_table`
SET
    `an_int_value` = `an_int_value` ^ 1 
```

**测试：**

选择 0 ^ 1; /* 返回 1 */

选择 1 ^ 1; /* 返回 0 */

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-12T09:16:47.433

对于 ENUM(0,1) 字段，您可以使用...

更新表 SET int_value=BINARY(int_value=1)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-04-02T07:23:47.883

对于 ENUM(0,1) UPDATE some_table SET an_int_value = IF(an_int_value='1', '0', '1');

# asp.net - 以编程方式刷新/更新 HttpContext.User

> ID：603838
> 
> 赞同：4
> 
> 时间：2009-03-02T20:19:32.007
> 
> 标签：asp.net, forms-authentication, httpcontext

我将 FormsAuthentication 用于 ASP.NET 站点，该站点具有显示当前登录用户 Page.User.Identity.Name 的母版页。

他们可以在他们的设置中更改他们的用户名，当这样做时，我会为他们更新他们的 cookie，这样他们就不必通过回发退出/重新登录。

```
FormsAuthentication.SignOut();
FormsAuthentication.SetAuthCookie(username, false); 
```

我可能很挑剔，但是在他们更改用户名后，母版页仍会显示其原始用户名，直到他们重新加载或加载不同的页面。

有没有办法以编程方式更新当前的 Page.User，以便在同一个回发期间显示他们的新用户名？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-17T14:56:26.913

虽然 MasterMax 的建议是我会做的，但您实际上可以更新`Page.User`via `HttpContext.Current.User`。

如果您知道用户的角色（或者您没有使用基于角色的授权），则可以利用`System.Security.Principal.GenericPrincipal`该类：

```
string newUsername = "New Username";
string[] roles = new string[] {"Role1", "Role2"};

HttpContext.Current.User = 
   new GenericPrincipal(new GenericIdentity(newUserName), roles); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T20:30:18.067

您可以创建母版页类的实例，并将您为用户名设置的属性设为公开，以便您可以在 FormsAuthentication 代码之后立即设置该属性。

# database - 加入 varchar(50) 外键会减慢查询速度

> ID：603845
> 
> 赞同：1
> 
> 时间：2009-03-02T20:21:05.060
> 
> 标签：database, tsql, optimization

我有这个很长的查询，但是向其中添加 where 子句或加入字符串会导致运行额外的 2 秒。我不知道为什么。

这是完整的查询：

```
ALTER PROCEDURE [dbo].[RespondersByPracticeID]
    @practiceID int = null,
    @activeOnly bit = 1
AS
BEGIN
    SET NOCOUNT ON;
    select 
        isnull(sum(isResponder),0) as [Responders]
        ,isnull(count(*) - sum(isResponder),0) as [NonResponders]
        ,isnull((select 
                count(p.patientID)
            from patient p 
                inner join practice on practice.practiceid = p.practiceid
                            inner join [lookup] l on p.dosing = l.lookupid and l.lookupid = 'da_ncd'
                where
                p.practiceID = isnull(@practiceID, p.practiceID)
                and p.active = case @activeOnly when 1 then 1 else p.active end
            ) - (isnull(sum(isResponder),0) + isnull(count(*) - sum(isResponder),0)),0)
         as [Undetermined]
    from (  
        select 
            v.patientID
            ,firstVisit.hbLevel as startHb
            ,maxHbVisit.hblevel as maxHb
            , case when (maxHbVisit.hblevel - firstVisit.hbLevel >= 1) then 1 else 0 end as isResponder
            ,count(v.patientID) as patientCount
        from patient p 
            inner join visit v on v.patientid = v.patientid 
            inner join practice on practice.practiceid = p.practiceid
            inner join [lookup] l on p.dosing = l.lookupid and l.lookupid = 'da_ncd'
            inner join (
                SELECT
                  p.PatientID
                  ,v.VisitID
                  ,v.hblevel 
                  ,v.VisitDate 
                FROM Patient p
                  INNER JOIN Visit v ON p.PatientID = v.PatientID
                WHERE
                    v.VisitDate = (
                        SELECT MIN(VisitDate) 
                        FROM Visit 
                        WHERE PatientId = p.PatientId
                     )
            ) firstVisit on firstVisit.patientID = v.patientID
            inner join (
                select 
                    p.patientID
                    ,max(v.hbLevel) as hblevel
                from Patient p
                     INNER JOIN Visit v ON p.PatientID = v.PatientID
                group by
                    p.patientID
            ) MaxHbVisit on maxHbVisit.patientid = v.patientId
        where
            p.practiceID = isnull(@practiceID, p.practiceID)
            and p.active = case @activeOnly when 1 then 1 else p.active end

        group by
            v.patientID
            ,firstVisit.hbLevel
            ,maxHbVisit.hblevel
        having
            datediff(
                d,
                dateadd(
                    day
                    ,-DatePart(
                        dw
                        ,min(v.visitDate)
                    ) + 1
                    ,min(v.visitDate)
                )
                , max(v.visitDate)
            ) >= (7 * 8) -- Eight weeks.
    ) responders
END 
```

减慢速度的线是：

```
inner join [lookup] l on p.dosing = l.lookupid and l.lookupid = 'da_ncd' 
```

此外，将其移至`where`子句具有相同的效果：

```
where p.dosing = 'da_ncd' 
```

否则，查询几乎会立即运行。`>.<`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T20:31:15.397

啊，对不起，我想通了。Patient.Dosing 设置为允许空值。我想这使它成为一种不同的索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T20:52:08.200

为了记录，即使问题得到了回答。通常发生这样的事情是因为执行计划发生了变化。比较查询分析器中的计划。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T20:54:42.577

另一个问题是数据类型——如果 p.dosing 和 l.lookupid 不同——例如，nvarchar 与 varchar 会产生巨大的影响。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-02T20:27:15.967

尝试在该表上创建索引，确保在字段列表中正确包含该 VARCHAR 字段。

# python - 你如何在 Python 中进行 UDP 多播？

> ID：603852
> 
> 赞同：98
> 
> 时间：2009-03-02T20:24:10.250
> 
> 标签：python, multicast

如何在 Python 中发送和接收 UDP 多播？是否有标准库可以这样做？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-11-25T03:03:07.967

这对我有用：

收到

```
import socket
import struct

MCAST_GRP = '224.1.1.1'
MCAST_PORT = 5007
IS_ALL_GROUPS = True

sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)
sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
if IS_ALL_GROUPS:
    # on this port, receives ALL multicast groups
    sock.bind(('', MCAST_PORT))
else:
    # on this port, listen ONLY to MCAST_GRP
    sock.bind((MCAST_GRP, MCAST_PORT))
mreq = struct.pack("4sl", socket.inet_aton(MCAST_GRP), socket.INADDR_ANY)

sock.setsockopt(socket.IPPROTO_IP, socket.IP_ADD_MEMBERSHIP, mreq)

while True:
  # For Python 3, change next line to "print(sock.recv(10240))"
  print sock.recv(10240) 
```

发送

```
import socket

MCAST_GRP = '224.1.1.1'
MCAST_PORT = 5007
# regarding socket.IP_MULTICAST_TTL
# ---------------------------------
# for all packets sent, after two hops on the network the packet will not 
# be re-sent/broadcast (see https://www.tldp.org/HOWTO/Multicast-HOWTO-6.html)
MULTICAST_TTL = 2

sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)
sock.setsockopt(socket.IPPROTO_IP, socket.IP_MULTICAST_TTL, MULTICAST_TTL)

# For Python 3, change next line to 'sock.sendto(b"robot", ...' to avoid the
# "bytes-like object is required" msg (https://stackoverflow.com/a/42612820)
sock.sendto("robot", (MCAST_GRP, MCAST_PORT)) 
```

它基于[http://wiki.python.org/moin/UdpCommunication](http://wiki.python.org/moin/UdpCommunication)中的示例，这些示例不起作用。

我的系统是... Linux 2.6.31-15-generic #50-Ubuntu SMP Tue Nov 10 14:54:29 UTC 2009 i686 GNU/Linux Python 2.6.4

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-07-20T03:40:37.433

向多播组广播的多播发送方：

```
#!/usr/bin/env python

import socket
import struct

def main():
  MCAST_GRP = '224.1.1.1'
  MCAST_PORT = 5007
  sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)
  sock.setsockopt(socket.IPPROTO_IP, socket.IP_MULTICAST_TTL, 32)
  sock.sendto('Hello World!', (MCAST_GRP, MCAST_PORT))

if __name__ == '__main__':
  main() 
```

从多播组读取并将十六进制数据打印到控制台的多播接收器：

```
#!/usr/bin/env python

import socket
import binascii

def main():
  MCAST_GRP = '224.1.1.1' 
  MCAST_PORT = 5007
  sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)
  try:
    sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
  except AttributeError:
    pass
  sock.setsockopt(socket.IPPROTO_IP, socket.IP_MULTICAST_TTL, 32) 
  sock.setsockopt(socket.IPPROTO_IP, socket.IP_MULTICAST_LOOP, 1)

  sock.bind((MCAST_GRP, MCAST_PORT))
  host = socket.gethostbyname(socket.gethostname())
  sock.setsockopt(socket.SOL_IP, socket.IP_MULTICAST_IF, socket.inet_aton(host))
  sock.setsockopt(socket.SOL_IP, socket.IP_ADD_MEMBERSHIP, 
                   socket.inet_aton(MCAST_GRP) + socket.inet_aton(host))

  while 1:
    try:
      data, addr = sock.recvfrom(1024)
    except socket.error, e:
      print 'Expection'
      hexdata = binascii.hexlify(data)
      print 'Data = %s' % hexdata

if __name__ == '__main__':
  main() 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-10-06T13:55:47.557

更好的使用：

```
sock.bind((MCAST_GRP, MCAST_PORT)) 
```

代替：

```
sock.bind(('', MCAST_PORT)) 
```

因为，如果您想在同一个端口上收听多个多播组，您将获得所有侦听器上的所有消息。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-03-28T15:23:38.117

为了加入多播组 Python 使用本机 OS 套接字接口。由于 Python 环境的可移植性和稳定性，许多套接字选项直接转发到本地套接字 setsockopt 调用。组播操作模式如加入和删除组成员资格只能通过`setsockopt`。

接收组播 IP 数据包的基本程序如下所示：

```
from socket import *

multicast_port  = 55555
multicast_group = "224.1.1.1"
interface_ip    = "10.11.1.43"

s = socket(AF_INET, SOCK_DGRAM )
s.bind(("", multicast_port ))
mreq = inet_aton(multicast_group) + inet_aton(interface_ip)
s.setsockopt(IPPROTO_IP, IP_ADD_MEMBERSHIP, str(mreq))

while 1:
    print s.recv(1500) 
```

首先，它创建套接字，绑定它并通过发出触发触发多播组加入`setsockopt`。最后它永远接收数据包。

发送多播 IP 帧是直截了当的。如果您的系统中有单个 NIC，则发送此类数据包与通常的 UDP 帧发送没有区别。您只需在`sendto()`方法中设置正确的目标 IP 地址即可。

我注意到实际上很多关于互联网的例子都是偶然的。即使在官方 python 文档中。他们所有人的问题都在错误地使用 struct.pack。请注意，典型示例使用`4sl`as 格式，与实际 OS 套接字接口结构不一致。

我将尝试描述在执行对 python 套接字对象的 setsockopt 调用时引擎盖下发生的事情。

Python 将 setsockopt 方法调用转发到本机 C 套接字接口。Linux 套接字文档（请参阅参考资料`man 7 ip`）介绍`ip_mreqn`了 IP_ADD_MEMBERSHIP 选项的两种结构形式。最短的格式是 8 字节长，更长的是 12 字节长。上面的示例生成 8 字节`setsockopt`调用，其中前四个字节定义`multicast_group`，后四个字节定义`interface_ip`。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-10-13T09:16:07.767

只是另一个答案来解释其他答案的代码中的一些微妙点：

*   `socket.INADDR_ANY`- （已编辑）在 的上下文中`IP_ADD_MEMBERSHIP`，这并没有真正将套接字绑定到所有接口，而只是选择多播启动的默认接口（根据路由表）
*   加入多播组与将套接字绑定到本地接口地址不同

请参阅[绑定多播 (UDP) 套接字是什么意思？](https://stackoverflow.com/questions/10692956/what-does-it-mean-to-bind-a-multicast-udp-socket)有关多播如何工作的更多信息

组播接收器：

```
import socket
import struct
import argparse

def run(groups, port, iface=None, bind_group=None):
    # generally speaking you want to bind to one of the groups you joined in
    # this script,
    # but it is also possible to bind to group which is added by some other
    # programs (like another python program instance of this)

    # assert bind_group in groups + [None], \
    #     'bind group not in groups to join'
    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)

    # allow reuse of socket (to allow another instance of python running this
    # script binding to the same ip/port)
    sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)

    sock.bind(('' if bind_group is None else bind_group, port))
    for group in groups:
        mreq = struct.pack(
            '4sl' if iface is None else '4s4s',
            socket.inet_aton(group),
            socket.INADDR_ANY if iface is None else socket.inet_aton(iface))

        sock.setsockopt(socket.IPPROTO_IP, socket.IP_ADD_MEMBERSHIP, mreq)

    while True:
        print(sock.recv(10240))

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('--port', type=int, default=19900)
    parser.add_argument('--join-mcast-groups', default=[], nargs='*',
                        help='multicast groups (ip addrs) to listen to join')
    parser.add_argument(
        '--iface', default=None,
        help='local interface to use for listening to multicast data; '
        'if unspecified, any interface would be chosen')
    parser.add_argument(
        '--bind-group', default=None,
        help='multicast groups (ip addrs) to bind to for the udp socket; '
        'should be one of the multicast groups joined globally '
        '(not necessarily joined in this python program) '
        'in the interface specified by --iface. '
        'If unspecified, bind to 0.0.0.0 '
        '(all addresses (all multicast addresses) of that interface)')
    args = parser.parse_args()
    run(args.join_mcast_groups, args.port, args.iface, args.bind_group) 
```

示例用法：（在两个控制台中运行以下命令并选择您自己的 --iface （必须与接收多播数据的接口相同））

`python3 multicast_recv.py --iface='192.168.56.102' --join-mcast-groups '224.1.1.1' '224.1.1.2' '224.1.1.3' --bind-group '224.1.1.2'`

`python3 multicast_recv.py --iface='192.168.56.102' --join-mcast-groups '224.1.1.4'`

组播发件人：

```
import socket
import argparse

def run(group, port):
    MULTICAST_TTL = 20
    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)
    sock.setsockopt(socket.IPPROTO_IP, socket.IP_MULTICAST_TTL, MULTICAST_TTL)
    sock.sendto(b'from multicast_send.py: ' +
                f'group: {group}, port: {port}'.encode(), (group, port))

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('--mcast-group', default='224.1.1.1')
    parser.add_argument('--port', default=19900)
    args = parser.parse_args()
    run(args.mcast_group, args.port) 
```

示例用法： # 假设接收者绑定到下面的多播组地址，并且某些程序请求加入该组。并且为了简化情况，假设接收者和发送者在同一个子网下

`python3 multicast_send.py --mcast-group '224.1.1.2'`

`python3 multicast_send.py --mcast-group '224.1.1.4'`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-09-23T18:16:13.477

看看[py-multicast](http://coobs.eu.org/py-multicast/)。网络模块可以检查接口是否支持多播（至少在 Linux 上）。

```
import multicast
from multicast import network

receiver = multicast.MulticastUDPReceiver ("eth0", "238.0.0.1", 1234 )
data = receiver.read()
receiver.close()

config = network.ifconfig()
print config['eth0'].addresses
# ['10.0.0.1']
print config['eth0'].multicast
#True - eth0 supports multicast
print config['eth0'].up
#True - eth0 is up 
```

也许看不到 IGMP 的问题是由不支持多播的接口引起的？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-24T12:12:32.773

要使客户端代码（来自 tolomea）在 Solaris 上工作，您需要将`IP_MULTICAST_TTL`套接字选项的 ttl 值作为无符号字符传递。否则你会得到一个错误。这在 Solaris 10 和 11 上对我有用：

```
import socket
import struct

MCAST_GRP = '224.1.1.1'
MCAST_PORT = 5007
ttl = struct.pack('B', 2)

sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)
sock.setsockopt(socket.IPPROTO_IP, socket.IP_MULTICAST_TTL, ttl)
sock.sendto("robot", (MCAST_GRP, MCAST_PORT)) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-12-03T12:03:04.190

> 这个例子对我不起作用，原因不明。

不是晦涩难懂，就是简单的路由。

在 OpenBSD 上

```
route add -inet 224.0.0.0/4 224.0.0.1 
```

您可以在 Linux 上设置到开发人员的路由

```
route add -net 224.0.0.0 netmask 240.0.0.0 dev wlp2s0 
```

强制所有多播流量到 Linux 上的一个接口

```
 ifconfig wlp2s0 allmulti 
```

tcpdump 超级简单

```
tcpdump -n multicast 
```

在您的代码中，您有：

```
while True:
  # For Python 3, change next line to "print(sock.recv(10240))" 
```

为什么是**10240**？

> 多播数据包大小应为**1316 字节**

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-08-08T15:10:04.640

托洛梅亚的回答对我有用。我也将它入侵到[socketserver.UDPServer 中](http://docs.python.org/3.2/library/socketserver.html#socketserver-udpserver-example)：

```
class ThreadedMulticastServer(socketserver.ThreadingMixIn, socketserver.UDPServer):
    def __init__(self, *args):
        super().__init__(*args)
        self.socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)
        self.socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
        self.socket.bind((MCAST_GRP, MCAST_PORT))
        mreq = struct.pack('4sl', socket.inet_aton(MCAST_GRP), socket.INADDR_ANY)
        self.socket.setsockopt(socket.IPPROTO_IP, socket.IP_ADD_MEMBERSHIP, mreq) 
```

# python - 如何在 urllib2 请求中获取默认标头？

> ID：603856
> 
> 赞同：15
> 
> 时间：2009-03-02T20:24:41.853
> 
> 标签：python, urllib2

我有一个使用 urllib2 的 Python Web 客户端。将 HTTP 标头添加到我的传出请求中很容易。我只是创建一个我想要添加的标题的字典，并将它传递给 Request 初始化程序。

但是，其他“标准”HTTP 标头以及我明确添加的自定义标头都会添加到请求中。当我使用 Wireshark 嗅探请求时，除了我自己添加的标题之外，我还看到了标题。我的问题是如何访问这些标头？我想记录每个请求（包括*全套*HTTP 标头），但不知道如何。

任何指针？

简而言之：如何从 urllib2 创建的 HTTP 请求中获取所有传出标头？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-10-27T14:36:54.197

如果您想查看发送的文字 HTTP 请求，并因此查看每个最后一个标头与线路上表示的完全相同，那么您可以告诉`urllib2`使用您自己的`HTTPHandler`打印输出（或保存，或其他）版本传出的 HTTP 请求。

```
import httplib, urllib2

class MyHTTPConnection(httplib.HTTPConnection):
    def send(self, s):
        print s  # or save them, or whatever!
        httplib.HTTPConnection.send(self, s)

class MyHTTPHandler(urllib2.HTTPHandler):
    def http_open(self, req):
        return self.do_open(MyHTTPConnection, req)

opener = urllib2.build_opener(MyHTTPHandler)
response = opener.open('http://www.google.com/') 
```

运行这段代码的结果是：

```
GET / HTTP/1.1
Accept-Encoding: identity
Host: www.google.com
Connection: close
User-Agent: Python-urllib/2.6 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-02T20:57:21.153

urllib2 库使用 OpenerDirector 对象来处理实际打开。幸运的是，python 库提供了默认值，因此您不必这样做。然而，正是这些 OpenerDirector 对象添加了额外的标头。

在发送请求后查看它们是什么（例如，以便您可以记录它）：

```
req = urllib2.Request(url='http://google.com')
response = urllib2.urlopen(req)
print req.unredirected_hdrs

(produces {'Host': 'google.com', 'User-agent': 'Python-urllib/2.5'} etc) 
```

unredirected_hdrs 是 OpenerDirectors 转储其额外标头的地方。只需查看`req.headers`将仅显示您自己的标题 - 库为您保留那些不受干扰的标题。

如果您需要在发送请求之前查看标头，则需要子类化 OpenerDirector 以拦截传输。

希望有帮助。

编辑：我忘了提到，一旦发送请求，`req.header_items()`将为您提供所有标头的元组列表，包括您自己的和 OpenerDirector 添加的。我应该首先提到这一点，因为它是最直接的 :-) 抱歉。

编辑2：在您对定义自己的处理程序的示例提出问题之后，这是我想出的示例。任何对请求链的关注是我们需要确保处理程序对于多个请求是安全的，这就是为什么我不喜欢直接替换 HTTPConnection 类上 putheader 的定义。

遗憾的是，由于 HTTPConnection 和 AbstractHTTPHandler 的内部结构非常内部，我们必须从 python 库中复制大部分代码来注入我们的自定义行为。假设我没有在下面犯错并且这与我在 5 分钟的测试中一样有效，如果您将 Python 版本更新为修订号（即：2.5.x 到 2.5.y 或2.5 到 2.6 等）。

因此，我应该提到我使用的是 Python 2.5.1。如果您有 2.6 或特别是 3.0，您可能需要相应地进行调整。

如果这不起作用，请告诉我。我对这个问题太感兴趣了：

```
import urllib2
import httplib
import socket

class CustomHTTPConnection(httplib.HTTPConnection):

    def __init__(self, *args, **kwargs):
        httplib.HTTPConnection.__init__(self, *args, **kwargs)
        self.stored_headers = []

    def putheader(self, header, value):
        self.stored_headers.append((header, value))
        httplib.HTTPConnection.putheader(self, header, value)

class HTTPCaptureHeaderHandler(urllib2.AbstractHTTPHandler):

    def http_open(self, req):
        return self.do_open(CustomHTTPConnection, req)

    http_request = urllib2.AbstractHTTPHandler.do_request_

    def do_open(self, http_class, req):
        # All code here lifted directly from the python library
        host = req.get_host()
        if not host:
            raise URLError('no host given')

        h = http_class(host) # will parse host:port
        h.set_debuglevel(self._debuglevel)

        headers = dict(req.headers)
        headers.update(req.unredirected_hdrs)
        headers["Connection"] = "close"
        headers = dict(
            (name.title(), val) for name, val in headers.items())
        try:
            h.request(req.get_method(), req.get_selector(), req.data, headers)
            r = h.getresponse()
        except socket.error, err: # XXX what error?
            raise urllib2.URLError(err)
        r.recv = r.read
        fp = socket._fileobject(r, close=True)

        resp = urllib2.addinfourl(fp, r.msg, req.get_full_url())
        resp.code = r.status
        resp.msg = r.reason

        # This is the line we're adding
        req.all_sent_headers = h.stored_headers
        return resp

my_handler = HTTPCaptureHeaderHandler()
opener = urllib2.OpenerDirector()
opener.add_handler(my_handler)
req = urllib2.Request(url='http://www.google.com')

resp = opener.open(req)

print req.all_sent_headers

shows: [('Accept-Encoding', 'identity'), ('Host', 'www.google.com'), ('Connection', 'close'), ('User-Agent', 'Python-urllib/2.5')] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T20:58:53.847

像这样的东西怎么样：

```
import urllib2
import httplib

old_putheader = httplib.HTTPConnection.putheader
def putheader(self, header, value):
    print header, value
    old_putheader(self, header, value)
httplib.HTTPConnection.putheader = putheader

urllib2.urlopen('http://www.google.com') 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-08-09T10:09:50.703

低级解决方案：

```
import httplib

class HTTPConnection2(httplib.HTTPConnection):
    def __init__(self, *args, **kwargs):
        httplib.HTTPConnection.__init__(self, *args, **kwargs)
        self._request_headers = []
        self._request_header = None

    def putheader(self, header, value):
        self._request_headers.append((header, value))
        httplib.HTTPConnection.putheader(self, header, value)

    def send(self, s):
        self._request_header = s
        httplib.HTTPConnection.send(self, s)

    def getresponse(self, *args, **kwargs):
        response = httplib.HTTPConnection.getresponse(self, *args, **kwargs)
        response.request_headers = self._request_headers
        response.request_header = self._request_header
        return response 
```

例子：

```
conn = HTTPConnection2("www.python.org")
conn.request("GET", "/index.html", headers={
    "User-agent": "test",
    "Referer": "/",
})
response = conn.getresponse() 
```

response.status，response.reason：

```
1: 200 OK 
```

response.request_headers：

```
[('Host', 'www.python.org'), ('Accept-Encoding', 'identity'), ('Referer', '/'), ('User-agent', 'test')] 
```

response.request_header：

```
GET /index.html HTTP/1.1
Host: www.python.org
Accept-Encoding: identity
Referer: /
User-agent: test 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-08-09T13:16:27.890

另一个解决方案，女巫使用了[How do you get default headers in a urllib2 Request?](https://stackoverflow.com/questions/603856/how-do-you-get-default-headers-in-a-urllib2-request/603966#603966) 但不从 std-lib 复制代码：

```
class HTTPConnection2(httplib.HTTPConnection):
    """
    Like httplib.HTTPConnection but stores the request headers.
    Used in HTTPConnection3(), see below.
    """
    def __init__(self, *args, **kwargs):
        httplib.HTTPConnection.__init__(self, *args, **kwargs)
        self.request_headers = []
        self.request_header = ""

    def putheader(self, header, value):
        self.request_headers.append((header, value))
        httplib.HTTPConnection.putheader(self, header, value)

    def send(self, s):
        self.request_header = s
        httplib.HTTPConnection.send(self, s)

class HTTPConnection3(object):
    """
    Wrapper around HTTPConnection2
    Used in HTTPHandler2(), see below.
    """
    def __call__(self, *args, **kwargs):
        """
        instance made in urllib2.HTTPHandler.do_open()
        """
        self._conn = HTTPConnection2(*args, **kwargs)
        self.request_headers = self._conn.request_headers
        self.request_header = self._conn.request_header
        return self

    def __getattribute__(self, name):
        """
        Redirect attribute access to the local HTTPConnection() instance.
        """
        if name == "_conn":
            return object.__getattribute__(self, name)
        else:
            return getattr(self._conn, name)

class HTTPHandler2(urllib2.HTTPHandler):
    """
    A HTTPHandler which stores the request headers.
    Used HTTPConnection3, see above.

    >>> opener = urllib2.build_opener(HTTPHandler2)
    >>> opener.addheaders = [("User-agent", "Python test")]
    >>> response = opener.open('http://www.python.org/')

    Get the request headers as a list build with HTTPConnection.putheader():
    >>> response.request_headers
    [('Accept-Encoding', 'identity'), ('Host', 'www.python.org'), ('Connection', 'close'), ('User-Agent', 'Python test')]

    >>> response.request_header
    'GET / HTTP/1.1\\r\\nAccept-Encoding: identity\\r\\nHost: www.python.org\\r\\nConnection: close\\r\\nUser-Agent: Python test\\r\\n\\r\\n'
    """
    def http_open(self, req):
        conn_instance = HTTPConnection3()
        response = self.do_open(conn_instance, req)
        response.request_headers = conn_instance.request_headers
        response.request_header = conn_instance.request_header
        return response 
```

编辑：更新源

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T20:46:02.037

参见 urllib2.py:do_request (line 1044 (1067)) 和 urllib2.py:do_open (line 1073) (line 293) self.addheaders = [('User-agent', client_version)] (只添加了'User-agent' )

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-27T14:49:24.677

在我看来，您正在寻找响应对象的标头，其中包括`Connection: close`等。这些标头位于 urlopen 返回的对象中。获取它们很容易：

```
from urllib2 import urlopen
req = urlopen("http://www.google.com")
print req.headers.headers 
```

`req.headers`是[httplib.HTTPMessage的一个实例](http://docs.python.org/library/httplib.html?highlight=httplib.httpmessage#httplib.HTTPMessage)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-02T20:48:15.697

它应该将默认的 http 标头（由[w3.org](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)指定）与您指定的标头一起发送。如果您想完整查看它们，可以使用[WireShark 之类的工具。](http://www.wireshark.org/)

**编辑：**

如果您想记录它们，您可以使用[WinPcap](http://www.winpcap.org/)捕获特定应用程序（在您的情况下为 python）发送的数据包。您还可以指定数据包的类型和许多其他详细信息。

-约翰

# javascript - 将链式方法附加到 JavaScript 中的元素集合

> ID：603870
> 
> 赞同：1
> 
> 时间：2009-03-02T20:27:47.823
> 
> 标签：javascript, collections, methods, element, chaining

这 - 至少目前 - 纯粹是实验，但我很好奇：有没有办法将方法（通过原型）附加到元素集合？我已经测试了以下代码：

```
<div>a</div>
<div>b</div>
<div>c</div>
<script>
NodeList.prototype._ = function(s)
 {
    for (x = 0; x < this.length; x++)
     {
        eval('this[x]' + '.' + s);
     }
    return this;
 }
document.getElementsByTagName('div')._("style.backgroundColor = 'red'")._('innerHTML += x');
</script> 
```

目前，它在 Opera 中完美运行；正如预期的那样，对所有 div 元素调用 _ 方法，然后依次将传递给它的字符串 eval()'ing*到*每个元素上。请注意，_ 方法允许链接，这也得到了证明，调用 _ 将预测的**x**迭代器变量附加到每个元素的 innerHTML。

现在，两个问题...

首先，有没有更好的方法来解决这个问题？我一直希望我能做到`document.getElementsByTagName('div').style.backgroundColor = "red";`，但可惜，它还没有实现。这就是我首先这样做的原因，也是我如此简洁地命名该方法的原因；我试图尽可能地模仿它。

其次，假设这是一个理智的用法，我将如何让它在 Firefox 中工作？该浏览器相当于`NodeList`is `HTMLCollection`，但尝试对后者进行原型设计根本不会成功。建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T21:33:16.620

我已经制定了我认为可以作为可行解决方案的方法；使用这种方法对元素集合进行链式修改有什么不好的地方吗？

```
<script>
_ = function()
 {
    for (x = 0; x < arguments[0].length; x++)
     {
        for (y = 0; y < arguments[1].length; y++)
         {
            eval('arguments[0][x]' + '.' + arguments[1][y]);
         }
     }
 }
</script> 
```

用法：

```
divs = document.getElementsByTagName('div');
_(divs, ["style.color = 'red'", "innerHTML += x"]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-08T16:57:59.153

这是您需要的“更漂亮”版本（没有评估，没有全局变量，正式参数，字符串中没有丑陋的代码），而不是在原型上设置它，因为这不适用于 IE。

```
/**
 * Sets a property on each of the elements in the list
 * @param {NodeList} list
 * @param {string} prop The name of property to be set, 
 *        e.g., 'style.backgroundColor', 'value'.
 * @param {mixed} value what to set the value to
 */
function setListProp( list, prop, value) {    
    for (var i = 0; i < list.length; i++) {
        setProp(list[i], prop, value);
    }
}

/**
 * Avoids the use of eval to set properties that may contain dots
 * Why avoid eval? eval is slow and could be dangerous if input comes from 
 * an unsanitized source
 * @param {object} el object that will have its property set
 * @param {string} propName ('value', 'style.backgroundColor')
 * Example: setProp(node, 'style.backgroundColor', "#ddd");
 */
function setProp(el, propName, value) {
    var propList = propName.split('.');
    // Note we're not setting it to the last value in the property chain
    for (var i=0; i < propList.length - 1 ; i++) {
        el = el[propList[i]];
    }
    var lastProperty = propList[propList.length -1];
    el[lastProperty] = value;
} 
```

***测试用例*** 使用 Firefox 访问 google.com，在控制台中输入上述代码，然后输入以下内容：

```
// Set tooltip on links
setListProp( document.getElementsByTagName('a'), 'title', 'YEAH it worked');

// Set bg to red on all links
setListProp( document.getElementsByTagName('a'), 'style.backgroundColor', '#f00'); 
```

**更新** 如果您希望能够按照您提到的那样执行 +=，我的解决方案将不起作用。我认为最优雅的解决方案是使用如下回调循环。

```
/** 
 * This exists in many libs and in newer versions of JS on Array's prototype 
 * @param {Object[]} arr The array that we want to act on each element. 
 *                   Does not work for sparse arrays
 * @param {Function} callback The function to be called for each element, it will be passed
 *        the element as its first argument, the index as the secibd
 */
function iterate(arr, callback) {
  for (var i=0,item; item=arr[i]; i++) {
    callback(item, i);
  }
} 
```

然后你可以这样称呼它

```
var as = document.getElementsByTagName('a'); 
iterate( as, function(el, index) {
  el.style.backgroundColor = 'red';
  el.innerHTML += "Whatever";
}); 
```

# string - 查找列表中最长项目长度的最有效方法是什么？

> ID：603877
> 
> 赞同：3
> 
> 时间：2009-03-02T20:31:11.917
> 
> 标签：string, language-agnostic, list, coldfusion, code-golf

给定一个不同长度的单词列表，找到任何单词的最大长度的最佳方法是什么？

例如，以下应返回 6

```
findMaxLen("a,set,of,random,words") 
```

当然，这样做是相当微不足道的......

```
<cffunction name="findMaxLen" returntype="Numeric">
    <cfset var CurMax = 0 />
    <cfset var CurItem = 0 />
    <cfloop index="CurItem" list="#Arguments[1]#">
        <cfif Len(CurItem) GT CurMax >
            <cfset CurMax = Len(CurItem)/>
        </cfif>
    </cfloop>
    <cfreturn CurMax />
</cffunction> 
```

或者，短一点...

```
<cffunction name="findMaxLen" returntype="Numeric">
    <cfset var CurMax = 0 />
    <cfset var CurItem = 0 />
    <cfloop index="CurItem" list="#Arguments[1]#">
        <cfset CurMax = Max( CurMax , Len(CurItem) ) />
    </cfloop>
    <cfreturn CurMax />
</cffunction> 
```

但是有没有更好的方法——更有效的方法？

也许一些Java方法？转换为数组并按项目长度排序？计算逗号之间的最大间隔？

实际上，以上两个示例中的任何一个都可以很好地满足我当前的需求，并且这不适用于对性能至关重要的东西，因此我不需要对此*的*答案，但是我认为仍然会很有趣看看人们会想出什么...

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-02T20:33:23.863

计算逗号之间的距离。

我认为没有什么*比*这更快了。它是`O(n)`，并且无论如何您*都*必须至少查看每个字符一次（以查看它是否是逗号）。

```
int FindLongestWord(char* str)
{
   char* lastComma = str - 1;
   int longest = 0;
   int length;
   char* pCheckChar;

   for(pCheckChar = str; *pCheckChar; pCheckChar++)
   {
      if(*pCheckChar == ',')
      {
         length = pCheckChar - lastComma - 1;
         if(length > longest)
         {
            longest = length;
         }

         lastComma = pCheckChar;
      }
   }

   // Check to see if the last word is the longest
   length = pCheckChar - lastComma - 1;
   if(length > longest)
   {
      longest = length;
   }

   return longest;
} 
```

或者我想你可以说

```
"a,set,of,random,words".Split(',').Max(w=>w.Length); 
```

如果我们在玩游戏... ;]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-02T22:00:15.103

在 Perl 中（假设我们有一个变量`$max`来存储答案）：

```
(length $1 > $max) && ($max = length $1) while "a,set,of,random,words" =~ /(\w+)/g; 
```

或者：

```
(length $_ > $max) && ($max = length $_) foreach split /,/, "a,set,of,random,words"; 
```

或者：

```
$max = length((sort { length $b <=> length $a } split /,/, "a,set,of,random,words")[0]); 
```

毕竟，TMTOWTDI。

编辑：我忘记了核心模块！

```
use List::Util 'reduce';
$max = length reduce { length $a > length $b ? $a : $b } split /,/, "a,set,of,random,words"; 
```

...不知何故设法比其他的更长。那好吧！

编辑2：我只记得`map()`：

```
use List::Util 'max';
$max = max map length, split /,/, "a,set,of,random,words"; 
```

*这*更像是我正在寻找的东西。

编辑3：为了完整性：

```
($max) = sort { $b <=> $a } map length, split /,/, "a,set,of,random,words"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T20:47:13.657

看到有`code-golf`标签，这里是 C# 中的 52 个字符

```
"a,set,of,random,words".Split(',').Max(w=>w.Length); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T21:06:06.530

这是'短'CFML方式 - 72个字符......

```
Len(ArrayMax("a,set,of,random,words".replaceAll('[^,]','1').split(','))) 
```

另一个版本，78 个字符，但处理巨大的字符串（见评论）......

```
Len(ListLast(ListSort("a,set,of,random,words".replaceAll('[^,]','1'),'text'))) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T20:44:05.630

我确实看到了代码高尔夫标签 - 这是 Python 中的 54 个字符：

```
len(max("a,set,of,random,words".split(","), key=len)) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T21:12:25.203

在没有字符串额外功能的java中。（只是一个伪链表：P）在开始时将最大值设为 0

```
 int find(LinkedList strings, int max) {
      int i;
      String s=(String)strings.element();
      for(i=0;s.charAt(i)!='\0';i++);
      if(strings.hasNext())
         return find(strings.Next(),(i>max?i:max));
      return max;
    } 
```

编辑：现在刚刚注意到它给出的是一个字符串而不是字符串列表，没关系在这里保持不变:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-02T22:24:48.367

如果您不担心可读性... ;)

```
String longest(String...ss){String _="";for(String s:ss)if(_.length()<s.length())_=s;return _;} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T00:12:41.573

我想这取决于高效的含义。如果这意味着编写的代码中的字符最少，那是一回事。如果这意味着最少的内存或最快的执行速度，那就是另一个。

为了最快的执行，我将采取循环。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-11T15:12:20.360

在vc++中

```
int findMaxLen(const char *s)
{
    const char c = ',';
    int a = 0, b = 0;
    while(*s)
    {
        while(*s && *s++ != c)b++;
        if(b > a)a=b;
        b = 0;
    }
    return a;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-11T16:52:20.167

# 在[J](http://www.jsoftware.com/)

假设盒装字符串列表（L）：

```
{.\:~>#&.>L 
```

使用 CSV 文件的示例：

```
{.\:~;>#&.>readcsv'test.csv' 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-11T04:42:16.420

在斯卡拉（55个字符）：

```
",set,of,random,words".split(",").:\(0)(_.length max _) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-09-25T04:35:01.637

Clojure：49 个字节。

```
(def l #(reduce max(for[x(.split%%2)](count x)))) 
```

易读版本：

```
(defn longest [astr sep]
  (reduce max
    (for [word (.split astr sep)]
      (count word)))) 
```

我还在学习这门语言，所以我很想听听任何改进它的方法。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-07-04T22:31:29.043

我面前没有 Python，所以我无法检查它是否有效，但是......

```
def maxlen(x):
    return len(sorted(x.split(), key=lambda y: len(y))[1]) 
```

应该做的伎俩。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-07-08T18:57:25.587

这不是最简单的吗？

```
<cffunction name="findMaxLen" returntype="Numeric">
    <cfset longest = 0>
    <cfloop list="#Arguments[1]#" index="w">
        <cfif len(w) gt longest>
            <cfset longest = len(w)>
        </cfif>
    </cfloop>
    <cfreturn longest>
</cffunction> 
```

# actionscript - 序列化 Flex 对象以保存/恢复应用程序状态

> ID：603890
> 
> 赞同：1
> 
> 时间：2009-03-02T20:34:14.203
> 
> 标签：actionscript, flex3

是否可以在 Flex 中序列化对象的层次结构，将二进制数据发送到 URL 以在服务器上/从服务器上存储/检索，并反序列化数据以恢复对象的原始状态？

我知道可以将对象转换为 XML 格式（还没有尝试过），但我希望避免手动解析 XML 和重建对象。拥有可以将对象序列化/反序列化为简单二进制格式的功能会很好（我过去在 Java 中做过类似的事情，虽然不像我希望的那么容易）。Perl 中的 'eval' 函数与我正在寻找的类似，当然没有保存代码。

在伪代码中，这是我想做的：

```
private var contentToSave:HBox = new HBox();

private function saveState(event:Event):void {
    var toSave:HBox = this.contentToSave;
    var data:? = /* serialize 'toSave' ActionScript classes to binary data*/;
    sendDataToServer(data, filename);
}
private function restoreState(filename):void {
    var data:? = getDataFromServer(filename);
    var savedData:HBox = /* deserialize binary 'data' to ActionScript classes */;
    this.contentToSave = savedData;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T20:56:25.600

看看[ByteArray.writeObject()](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/utils/ByteArray.html#writeObject%28%29)。它将传递的 AMF 格式的对象保存到字节数组中。这个函数我没用过太多，具体可以序列化什么样的对象我不是很清楚，但绝对不是全部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T20:41:18.337

试试[ascorelib](http://code.google.com/p/as3corelib/source/browse/#svn/trunk/src/com/adobe/serialization)`serialization`中基于 JSON 的包。

> [...]但我希望避免手动解析 XML 和重建对象

AS 像处理任何其他本机类型一样处理 XML。放心。XML 是处理您将要提取并放回服务器的数据的首选方式。当然，它`ascorelib`为您提供了一个 JSON 类——因此您可能也想查看它。

> Perl 中的 'eval' 函数与我正在寻找的类似，当然没有保存代码。

IIRC，`eval`是 ECMAScript 规范的一部分（你会在 Javascript 中找到它）。但在 AS3.0 中没有。它在某些以前的版本中在一定程度上存在，但不再受支持。

# database - PostgreSQL 的 Ltree 模块是否适合线程注释？

> ID：603894
> 
> 赞同：10
> 
> 时间：2009-03-02T20:36:33.153
> 
> 标签：database, postgresql, tree, comments, hierarchy

我正在考虑在我的应用程序中使用 PostgreSQL 的[Ltree 模块](http://www.sai.msu.su/~megera/postgres/gist/ltree/)来帮助处理线程注释。我一直在关注它用于线程评论。我认为它会在您需要更新节点及其子节点的情况下有所帮助，例如当您想要隐藏评论及其回复时。

我认为 ltree（或类似的东西）如果与传统的邻接列表（“comment_id”/“parent_comment_id”）结合使用会很有用。

在开始使用 ltree 之前，我想知道一些事情：

1.  您是否使用过 ltree？这就是所谓的“生产就绪”吗？
2.  如果是这样，你用它解决了什么问题？它做得好吗？
3.  你认为它适合线程评论系统吗？
    4.  如果你使用它，你在路径的“文本”部分使用了什么？您是否设置了类似于他们使用“Top.Astronomy.Cosmology”的 DMOZ 示例或基于主键“1.403.29.5”之类的东西？
    5.  有一个更好的方法吗？使用嵌套列表方法我有点紧张——我读过的所有内容都表明，UPDATES 或 INSERTS 并不是很热（你不需要重新排序吗？）。我也不是 CS 专业的，这种数据结构是我将来可能会忘记的东西。有人使用嵌套列表来发表评论或类似的东西吗？

如果有任何帮助，这是我正在考虑的架构：

```
CREATE TABLE comments (
    comment_id SERIAL PRIMARY KEY,
    parent_comment_id int REFERENCES comments(comment_id) ON UPDATE CASCADE ON DELETE CASCADE,
    thread_id int NOT NULL  REFERENCES threads(thread_id) ON UPDATE CASCADE ON DELETE CASCADE,
    path ltree NOT NULL,
    comment_body text NOT NULL,
    hide boolean not null default false
); 
```

ltree 使用的“路径”列看起来像：

```
<thread_id>.<parent_comment_id_#1>.<parent_comment_id_#2>.<my_comment_id> 
```

在路径中使用主键有什么问题吗？我应该在路径中包含节点自己的主键吗？如果我这样做了，在其上放置一个唯一索引作为约束是否有意义？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-03T17:39:31.260

1.  是的，是的；
2.  知识库中部分的层次结构（实现之一）；
3.  是的;

有问题的表之一的定义：

```
 Table "knowledgebase.section"
           Column           |           Type           |                                  Modifiers
----------------------------+--------------------------+-----------------------------------------------------------------------------
 section_sid                | integer                  | not null default nextval('knowledgebase.section_section_sid_seq'::regclass)
 section                    | character varying        | not null
 description                | character varying        |
 path                       | ltree                    | not null
 is_active                  | boolean                  | not null default true
 role_sid                   | integer                  | not null
 last_modified_by           | integer                  | not null
 creation_datetime          | timestamp with time zone | not null default now()
 last_modification_datetime | timestamp with time zone | not null default now()
 is_expanded                | boolean                  | not null default false
 section_idx                | tsvector                 |
Indexes:
    "section_sid_pkey" PRIMARY KEY, btree (section_sid)
    "section_section_key" UNIQUE, btree (section)
    "idxsection_idx" gist (section_idx)
    "path_gist_idx" gist (path)
Foreign-key constraints:
    "last_modified_by_fkey" FOREIGN KEY (last_modified_by) REFERENCES "user"."role"(role_sid) ON UPDATE CASCADE ON DELETE RESTRICT
    "role_sid_fkey" FOREIGN KEY (role_sid) REFERENCES "user"."role"(role_sid) ON  UPDATE CASCADE ON DELETE RESTRICT
Triggers:
    section_idx_update BEFORE INSERT OR UPDATE ON knowledgebase.section FOR EACH ROW EXECUTE PROCEDURE tsearch2('section_idx', 'section') 
```

“路径”列使用主键作为标签。

该表的当前内容示例（关于主键和“路径”列）：

```
 section_sid | path
 -------------+-------
           53 | 34.53
           56 | 56
           55 | 29.55
           35 | 35
           54 | 34.54
           37 | 30.37
          ... | ... 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-03T23:53:07.803

我建议任何在 SQL 中实现层次关系的人阅读[Joe Celko 的 Trees and Hierarchies in SQL for Smarties](https://rads.stackoverflow.com/amzn/click/com/1558609202)。

仅使用 parent_id 时，遍历任意深度的父子链接可能非常低效。这本书描述了使这种访问速度更快的技术。

在本系列文章中也可以免费找到一种策略（我碰巧使用）：

*   [第 1 部分](http://www.dbmsmag.com/9603d06.html) （查找“SQL 中的树”部分）（[Wayback 链接](https://web.archive.org/web/20081121131640/http://www.dbmsmag.com/9603d06.html)）
*   [第 2 部分](http://www.dbmsmag.com/9604d06.html)（[回退链接](https://web.archive.org/web/20080517111145/http://www.dbmsmag.com/9604d06.html)）
*   [第 3 部分](http://www.dbmsmag.com/9605d06.html)（[回退链接](https://web.archive.org/web/20080517111145/http://www.dbmsmag.com/9605d06.html)）
*   [第 4 部分](http://www.dbmsmag.com/9606d06.html)（[回退链接](https://web.archive.org/web/20080517111145/http://www.dbmsmag.com/9606d06.html)）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T04:40:32.007

PostgreSQL 8.4 版将通用表表达式功能引入核心 with`WITH`和`WITH... RECURSIVE`表达式。如果您正在修改旧代码，您可能需要等到 8.4 发布，因为这样您就不必担心 Ltree 和新核心语法之间的任何不兼容性。如果您正在使用旧代码，或者不想等待 8.4，您可能需要确保编写的代码可以轻松转换为新语法，尤其是在您更改旧模式或设计新模式时一。

也可以看看：

*   [8.4 手动输入`WITH`查询和 CTE](http://developer.postgresql.org/pgdocs/postgres/queries-with.html)
*   [带有 CTE 8.4 实现示例的文章](http://www.depesz.com/index.php/2008/10/07/waiting-for-84-common-table-expressions-with-queries/)

# xcode - Xcode 文档订阅按钮

> ID：603895
> 
> 赞同：0
> 
> 时间：2009-03-02T20:37:46.347
> 
> 标签：xcode

当我在 Xcode 中转到**帮助 > 文档**时，我注意到左侧边栏中的各种“订阅”按钮。

当我点击订阅按钮时究竟会发生什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T20:57:28.640

当我单击“订阅”时，它只是开始下载新的更新文档。在那之后，我想它会一次又一次地检查新的可用下载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T07:09:15.183

[订阅文档提要](http://developer.apple.com/DOCUMENTATION/DeveloperTools/Conceptual/XcodeWorkspace/200-Documentation_Access/chapter_6_section_9.html)

“当一个新的文档集可用时，它会列在提要名称下，旁边有一个获取按钮。单击按钮下载并安装文档集。

当您计算机上的文档集有新版本可用时，文档集名称旁边会显示更新按钮。单击按钮下载并安装新版本的文档集。”

# c# - ASP.NET MVC 贡献项目

> ID：603896
> 
> 赞同：1
> 
> 时间：2009-03-02T20:38:11.667
> 
> 标签：c#, asp.net-mvc

我希望与 ASP.NET MVC 项目的贡献者继续合作。我正在为一家大型公司进行专业开发，但在这里还不够。我还在大学里教授 Java 面向对象的实践，但我仍然觉得我对这方面的工程了解不够。简而言之，我正在寻找一个项目（小型，开源），以便在我在这里发疯之前获得有价值的信息并向社区中的其他人学习（我已经达到了众所周知的天花板）。

寻找此类工作的最佳地点在哪里？

我想要的专业知识... JQuery、ASP.NET MVC、CSharp、AJAX、Javascript、会员资格，而且名单还在继续。以前的工作大多是私人的（内联网），所以我所拥有的只是我整理的几个网站。http://jancel.doesntexist.com（是我目前正在研究的一个，不会永远在这里，只是等待客户购买）。http://hurl.me 是我参与的第一个 MVC C# 项目，以了解更多关于 ASP.NET MVC C# 的信息。我的体验从 Preview 2 开始，很高兴能在这里加入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T20:44:55.910

[MvcContrib](http://www.codeplex.com/MVCContrib)怎么样？另一个想法是[Code Camp Server](http://code.google.com/p/codecampserver/)，但我不确定它在新功能方面的活跃程度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T21:08:22.843

有许多开源项目可以轻松地对其代码库进行重大重构（并且知道这一点）。我将从 SourceForge 开始，找到一些您对他们的主题感兴趣的内容，然后开始对话。（从您的角度来看，它们甚至不需要是当前的 ASP 站点。）

# iphone - UIImage：调整大小，然后裁剪

> ID：603907
> 
> 赞同：189
> 
> 时间：2009-03-02T20:42:10.300
> 
> 标签：iphone, ios, image-processing, core-graphics

几天来，我一直在用自己的脸来面对这个问题，尽管我一直觉得自己正处于启示的边缘，但我根本无法实现我的目标。

我认为，在我设计的概念阶段提前，从 iPhone 的相机或库中抓取图像，将其缩小到指定的高度，使用等效于**Aspect Fill**选项的功能将是一件小事UIImageView（完全在代码中），然后**裁剪掉**任何不适合传递的 CGRect 的内容。

从相机或图书馆获取原始图像是微不足道的。我对其他两个步骤被证明是多么困难感到震惊。

附图显示了我想要实现的目标。有人会好心地握住我的手吗？到目前为止，我发现的每个代码示例似乎都会破坏图像、颠倒、看起来像废话、绘制越界或无法正常工作。

* * *

## 回答 #1

> 赞同：248
> 
> 时间：2009-03-03T06:55:32.057

我需要同样的东西——在我的例子中，选择适合缩放后的尺寸，然后裁剪每一端以适应其余部分的宽度。（我在横向工作，所以可能没有注意到纵向模式的任何缺陷。）这是我的代码 - 它是 UIImage 类别的一部分。我的代码中的目标大小始终设置为设备的全屏大小。

```
@implementation UIImage (Extras)

#pragma mark -
#pragma mark Scale and crop image

- (UIImage*)imageByScalingAndCroppingForSize:(CGSize)targetSize
{
    UIImage *sourceImage = self;
    UIImage *newImage = nil;    
    CGSize imageSize = sourceImage.size;
    CGFloat width = imageSize.width;
    CGFloat height = imageSize.height;
    CGFloat targetWidth = targetSize.width;
    CGFloat targetHeight = targetSize.height;
    CGFloat scaleFactor = 0.0;
    CGFloat scaledWidth = targetWidth;
    CGFloat scaledHeight = targetHeight;
    CGPoint thumbnailPoint = CGPointMake(0.0,0.0);

    if (CGSizeEqualToSize(imageSize, targetSize) == NO) 
    {
        CGFloat widthFactor = targetWidth / width;
        CGFloat heightFactor = targetHeight / height;

        if (widthFactor > heightFactor) 
        {
            scaleFactor = widthFactor; // scale to fit height
        }
        else
        {
            scaleFactor = heightFactor; // scale to fit width
        }

        scaledWidth  = width * scaleFactor;
        scaledHeight = height * scaleFactor;

        // center the image
        if (widthFactor > heightFactor)
        {
            thumbnailPoint.y = (targetHeight - scaledHeight) * 0.5; 
        }
        else
        {
            if (widthFactor < heightFactor)
            {
                thumbnailPoint.x = (targetWidth - scaledWidth) * 0.5;
            }
        }
    }   

    UIGraphicsBeginImageContext(targetSize); // this will crop

    CGRect thumbnailRect = CGRectZero;
    thumbnailRect.origin = thumbnailPoint;
    thumbnailRect.size.width  = scaledWidth;
    thumbnailRect.size.height = scaledHeight;

    [sourceImage drawInRect:thumbnailRect];

    newImage = UIGraphicsGetImageFromCurrentImageContext();

    if(newImage == nil)
    {
        NSLog(@"could not scale image");
    }

    //pop the context to get back to the default
    UIGraphicsEndImageContext();

    return newImage;
} 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2009-03-02T22:32:06.197

较早的帖子包含调整 UIImage 大小的方法的代码。相关部分如下：

```
+ (UIImage*)imageWithImage:(UIImage*)image 
               scaledToSize:(CGSize)newSize;
{
   UIGraphicsBeginImageContext( newSize );
   [image drawInRect:CGRectMake(0,0,newSize.width,newSize.height)];
   UIImage* newImage = UIGraphicsGetImageFromCurrentImageContext();
   UIGraphicsEndImageContext();

   return newImage;
} 
```

就裁剪而言，我相信如果您更改方法以使用与上下文不同的缩放大小，则生成的图像应该被裁剪到上下文的范围内。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2010-11-22T23:09:41.000

```
+ (UIImage *)scaleImage:(UIImage *)image toSize:(CGSize)targetSize {
    //If scaleFactor is not touched, no scaling will occur      
    CGFloat scaleFactor = 1.0;

    //Deciding which factor to use to scale the image (factor = targetSize / imageSize)
    if (image.size.width > targetSize.width || image.size.height > targetSize.height)
        if (!((scaleFactor = (targetSize.width / image.size.width)) > (targetSize.height / image.size.height))) //scale to fit width, or
            scaleFactor = targetSize.height / image.size.height; // scale to fit heigth.

    UIGraphicsBeginImageContext(targetSize); 

    //Creating the rect where the scaled image is drawn in
    CGRect rect = CGRectMake((targetSize.width - image.size.width * scaleFactor) / 2,
                             (targetSize.height -  image.size.height * scaleFactor) / 2,
                             image.size.width * scaleFactor, image.size.height * scaleFactor);

    //Draw the image into the rect
    [image drawInRect:rect];

    //Saving the image, ending image context
    UIImage *scaledImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return scaledImage;
} 
```

我提议这个。她不是美女吗？;)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2010-01-18T14:58:25.070

有一段很棒的代码与调整图像大小和其他一些操作有关。当我试图弄清楚如何调整图像大小时，我遇到了这个问题...... [http://vocaro.com/trevor/blog/2009/10/12/resize-a-uiimage-the-right-way/](http://vocaro.com/trevor/blog/2009/10/12/resize-a-uiimage-the-right-way/)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-06-28T18:40:44.147

干得好。这个是完美的;-)

编辑：见下面的评论 - “不适用于某些图像，失败：CGContextSetInterpolationQuality：无效上下文 0x0 错误”

```
// Resizes the image according to the given content mode, taking into account the image's orientation
- (UIImage *)resizedImageWithContentMode:(UIViewContentMode)contentMode imageToScale:(UIImage*)imageToScale bounds:(CGSize)bounds interpolationQuality:(CGInterpolationQuality)quality {
    //Get the size we want to scale it to
    CGFloat horizontalRatio = bounds.width / imageToScale.size.width;
    CGFloat verticalRatio = bounds.height / imageToScale.size.height;
    CGFloat ratio;

    switch (contentMode) {
        case UIViewContentModeScaleAspectFill:
            ratio = MAX(horizontalRatio, verticalRatio);
            break;

        case UIViewContentModeScaleAspectFit:
            ratio = MIN(horizontalRatio, verticalRatio);
            break;

        default:
            [NSException raise:NSInvalidArgumentException format:@"Unsupported content mode: %d", contentMode];
    }

    //...and here it is
    CGSize newSize = CGSizeMake(imageToScale.size.width * ratio, imageToScale.size.height * ratio);

    //start scaling it
    CGRect newRect = CGRectIntegral(CGRectMake(0, 0, newSize.width, newSize.height));
    CGImageRef imageRef = imageToScale.CGImage;
    CGContextRef bitmap = CGBitmapContextCreate(NULL,
                                                newRect.size.width,
                                                newRect.size.height,
                                                CGImageGetBitsPerComponent(imageRef),
                                                0,
                                                CGImageGetColorSpace(imageRef),
                                                CGImageGetBitmapInfo(imageRef));

    CGContextSetInterpolationQuality(bitmap, quality);

    // Draw into the context; this scales the image
    CGContextDrawImage(bitmap, newRect, imageRef);

    // Get the resized image from the context and a UIImage
    CGImageRef newImageRef = CGBitmapContextCreateImage(bitmap);
    UIImage *newImage = [UIImage imageWithCGImage:newImageRef];

    // Clean up
    CGContextRelease(bitmap);
    CGImageRelease(newImageRef);

    return newImage;
} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-12-24T13:15:03.330

这是 Jane Sales 在 Swift 中的答案的一个版本。干杯!

```
public func resizeImage(image: UIImage, size: CGSize) -> UIImage? {
    var returnImage: UIImage?

    var scaleFactor: CGFloat = 1.0
    var scaledWidth = size.width
    var scaledHeight = size.height
    var thumbnailPoint = CGPointMake(0, 0)

    if !CGSizeEqualToSize(image.size, size) {
        let widthFactor = size.width / image.size.width
        let heightFactor = size.height / image.size.height

        if widthFactor > heightFactor {
            scaleFactor = widthFactor
        } else {
            scaleFactor = heightFactor
        }

        scaledWidth = image.size.width * scaleFactor
        scaledHeight = image.size.height * scaleFactor

        if widthFactor > heightFactor {
            thumbnailPoint.y = (size.height - scaledHeight) * 0.5
        } else if widthFactor < heightFactor {
            thumbnailPoint.x = (size.width - scaledWidth) * 0.5
        }
    }

    UIGraphicsBeginImageContextWithOptions(size, true, 0)

    var thumbnailRect = CGRectZero
    thumbnailRect.origin = thumbnailPoint
    thumbnailRect.size.width = scaledWidth
    thumbnailRect.size.height = scaledHeight

    image.drawInRect(thumbnailRect)
    returnImage = UIGraphicsGetImageFromCurrentImageContext()

    UIGraphicsEndImageContext()

    return returnImage
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-06-19T00:58:45.043

我发现 Evgenii Kanvets 发布的 Swift 3 并没有统一缩放图像。

这是我的 Swift 4 版本的函数，它不会挤压图像：

```
static func resizedCroppedImage(image: UIImage, newSize:CGSize) -> UIImage? {

    // This function returns a newImage, based on image
    // - image is scaled uniformaly to fit into a rect of size newSize
    // - if the newSize rect is of a different aspect ratio from the source image
    //     the new image is cropped to be in the center of the source image
    //     (the excess source image is removed)

    var ratio: CGFloat = 0
    var delta: CGFloat = 0
    var drawRect = CGRect()

    if newSize.width > newSize.height {

        ratio = newSize.width / image.size.width
        delta = (ratio * image.size.height) - newSize.height
        drawRect = CGRect(x: 0, y: -delta / 2, width: newSize.width, height: newSize.height + delta)

    } else {

        ratio = newSize.height / image.size.height
        delta = (ratio * image.size.width) - newSize.width
        drawRect = CGRect(x: -delta / 2, y: 0, width: newSize.width + delta, height: newSize.height)

    }

    UIGraphicsBeginImageContextWithOptions(newSize, true, 0.0)
    image.draw(in: drawRect)
    let newImage = UIGraphicsGetImageFromCurrentImageContext()
    UIGraphicsEndImageContext()

    return newImage
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-01-09T20:02:30.913

我修改了 Brad Larson 的代码。它将在给定的矩形中填充图像。

```
-(UIImage*) scaleAndCropToSize:(CGSize)newSize;
{
    float ratio = self.size.width / self.size.height;

    UIGraphicsBeginImageContext(newSize);

    if (ratio > 1) {
        CGFloat newWidth = ratio * newSize.width;
        CGFloat newHeight = newSize.height;
        CGFloat leftMargin = (newWidth - newHeight) / 2;
        [self drawInRect:CGRectMake(-leftMargin, 0, newWidth, newHeight)];
    }
    else {
        CGFloat newWidth = newSize.width;
        CGFloat newHeight = newSize.height / ratio;
        CGFloat topMargin = (newHeight - newWidth) / 2;
        [self drawInRect:CGRectMake(0, -topMargin, newSize.width, newSize.height/ratio)];
    }

    UIImage* newImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return newImage;
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-11-23T09:31:53.200

```
scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0.0,0.0,ScreenWidth,ScreenHeigth)];
    [scrollView setBackgroundColor:[UIColor blackColor]];
    [scrollView setDelegate:self];
    [scrollView setShowsHorizontalScrollIndicator:NO];
    [scrollView setShowsVerticalScrollIndicator:NO];
    [scrollView setMaximumZoomScale:2.0];
    image=[image scaleToSize:CGSizeMake(ScreenWidth, ScreenHeigth)];
    imageView = [[UIImageView alloc] initWithImage:image];
    UIImageView* imageViewBk = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"background.png"]];
    [self.view addSubview:imageViewBk];
    CGRect rect;
    rect.origin.x=0;
    rect.origin.y=0;
    rect.size.width = image.size.width;
    rect.size.height = image.size.height;

    [imageView setFrame:rect];

    [scrollView setContentSize:[imageView frame].size];
    [scrollView setMinimumZoomScale:[scrollView frame].size.width / [imageView frame].size.width];
    [scrollView setZoomScale:[scrollView minimumZoomScale]];
    [scrollView addSubview:imageView];

    [[self view] addSubview:scrollView]; 
```

然后你可以通过这个对你的图像进行屏幕截图

```
float zoomScale = 1.0 / [scrollView zoomScale];
CGRect rect;
rect.origin.x = [scrollView contentOffset].x * zoomScale;
rect.origin.y = [scrollView contentOffset].y * zoomScale;
rect.size.width = [scrollView bounds].size.width * zoomScale;
rect.size.height = [scrollView bounds].size.height * zoomScale;

CGImageRef cr = CGImageCreateWithImageInRect([[imageView image] CGImage], rect);

UIImage *cropped = [UIImage imageWithCGImage:cr];

CGImageRelease(cr); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-09-09T07:29:23.070

Xamarin.iOS 版本[接受了关于如何调整大小然后裁剪 UIImage (Aspect Fill)](https://stackoverflow.com/a/605385/883738)的答案如下

```
 public static UIImage ScaleAndCropImage(UIImage sourceImage, SizeF targetSize)
    {
        var imageSize = sourceImage.Size;
        UIImage newImage = null;
        var width = imageSize.Width;
        var height = imageSize.Height;
        var targetWidth = targetSize.Width;
        var targetHeight = targetSize.Height;
        var scaleFactor = 0.0f;
        var scaledWidth = targetWidth;
        var scaledHeight = targetHeight;
        var thumbnailPoint = PointF.Empty;
        if (imageSize != targetSize)
        {
            var widthFactor = targetWidth / width;
            var heightFactor = targetHeight / height;
            if (widthFactor > heightFactor)
            {
                scaleFactor = widthFactor;// scale to fit height
            }
            else
            {
                scaleFactor = heightFactor;// scale to fit width
            }
            scaledWidth = width * scaleFactor;
            scaledHeight = height * scaleFactor;
            // center the image
            if (widthFactor > heightFactor)
            {
                thumbnailPoint.Y = (targetHeight - scaledHeight) * 0.5f;
            }
            else
            {
                if (widthFactor < heightFactor)
                {
                    thumbnailPoint.X = (targetWidth - scaledWidth) * 0.5f;
                }
            }
        }
        UIGraphics.BeginImageContextWithOptions(targetSize, false, 0.0f);
        var thumbnailRect = new RectangleF(thumbnailPoint, new SizeF(scaledWidth, scaledHeight));
        sourceImage.Draw(thumbnailRect);
        newImage = UIGraphics.GetImageFromCurrentImageContext();
        if (newImage == null)
        {
            Console.WriteLine("could not scale image");
        }
        //pop the context to get back to the default
        UIGraphics.EndImageContext();

        return newImage;
    } 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-08-16T22:00:41.650

我将[Sam Wirch 的指南转换为 swift](http://www.samwirch.com/blog/cropping-and-resizing-images-camera-ios-and-objective-c)，它对我来说效果很好，尽管最终图像中有一些非常轻微的“挤压”，我无法解决。

```
func resizedCroppedImage(image: UIImage, newSize:CGSize) -> UIImage {
    var ratio: CGFloat = 0
    var delta: CGFloat = 0
    var offset = CGPointZero
    if image.size.width > image.size.height {
        ratio = newSize.width / image.size.width
        delta = (ratio * image.size.width) - (ratio * image.size.height)
        offset = CGPointMake(delta / 2, 0)
    } else {
        ratio = newSize.width / image.size.height
        delta = (ratio * image.size.height) - (ratio * image.size.width)
        offset = CGPointMake(0, delta / 2)
    }
    let clipRect = CGRectMake(-offset.x, -offset.y, (ratio * image.size.width) + delta, (ratio * image.size.height) + delta)
    UIGraphicsBeginImageContextWithOptions(newSize, true, 0.0)
    UIRectClip(clipRect)
    image.drawInRect(clipRect)
    let newImage = UIGraphicsGetImageFromCurrentImageContext()
    UIGraphicsEndImageContext()
    return newImage
} 
```

如果有人想要客观 c 版本，它在他的网站上。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-09-04T12:38:44.617

这是[Sam Wirch 的](http://www.samwirch.com/blog/cropping-and-resizing-images-camera-ios-and-objective-c/)Swift 3 版本，由 William T.

```
extension UIImage {

    static func resizedCroppedImage(image: UIImage, newSize:CGSize) -> UIImage? {
        var ratio: CGFloat = 0
        var delta: CGFloat = 0
        var offset = CGPoint.zero

        if image.size.width > image.size.height {
            ratio = newSize.width / image.size.width
            delta = (ratio * image.size.width) - (ratio * image.size.height)
            offset = CGPoint(x: delta / 2, y: 0)
        } else {
            ratio = newSize.width / image.size.height
            delta = (ratio * image.size.height) - (ratio * image.size.width)
            offset = CGPoint(x: 0, y: delta / 2)
        }

        let clipRect = CGRect(x: -offset.x, y: -offset.y, width: (ratio * image.size.width) + delta, height: (ratio * image.size.height) + delta)
        UIGraphicsBeginImageContextWithOptions(newSize, true, 0.0)
        UIRectClip(clipRect)
        image.draw(in: clipRect)
        let newImage = UIGraphicsGetImageFromCurrentImageContext()
        UIGraphicsEndImageContext()

        return newImage
    }

} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-06-27T08:07:41.273

以下简单代码对我有用。

```
[imageView setContentMode:UIViewContentModeScaleAspectFill];
[imageView setClipsToBounds:YES]; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-02-12T15:30:05.103

```
- (UIImage*)imageScale:(CGFloat)scaleFactor cropForSize:(CGSize)targetSize
{
    targetSize = !targetSize.width?self.size:targetSize;
    UIGraphicsBeginImageContext(targetSize); // this will crop

    CGRect thumbnailRect = CGRectZero;

    thumbnailRect.size.width  = targetSize.width*scaleFactor;
    thumbnailRect.size.height = targetSize.height*scaleFactor;
    CGFloat xOffset = (targetSize.width- thumbnailRect.size.width)/2;
    CGFloat yOffset = (targetSize.height- thumbnailRect.size.height)/2;
    thumbnailRect.origin = CGPointMake(xOffset,yOffset);

    [self drawInRect:thumbnailRect];

    UIImage *newImage  = UIGraphicsGetImageFromCurrentImageContext();

    if(newImage == nil)
    {
        NSLog(@"could not scale image");
    }

    UIGraphicsEndImageContext();

    return newImage;
} 
```

作品示例下方：左图-（原图）；右图，比例 x2

![在此处输入图像描述](https://i.stack.imgur.com/0iEoP.png)

如果要缩放图像但保留其帧（比例），请以这种方式调用方法：

```
[yourImage imageScale:2.0f cropForSize:CGSizeZero]; 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-02-24T07:32:23.657

斯威夫特版本：

```
 static func imageWithImage(image:UIImage, newSize:CGSize) ->UIImage {
    UIGraphicsBeginImageContextWithOptions(newSize, true, UIScreen.mainScreen().scale);
    image.drawInRect(CGRectMake(0, 0, newSize.width, newSize.height))

    let newImage = UIGraphicsGetImageFromCurrentImageContext();

    UIGraphicsEndImageContext();
    return newImage
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-05-28T04:58:39.383

这个问题似乎已经被搁置了，但是在我寻求一个我可以更容易理解（并用 Swift 编写）的解决方案时，我想到了这个（也发布到：[如何裁剪 UIImage？](https://stackoverflow.com/questions/2635371/how-to-crop-the-uiimage/30497518#30497518)）

* * *

我希望能够根据纵横比从区域裁剪，并根据外部边界范围缩放到大小。这是我的变化：

```
import AVFoundation
import ImageIO

class Image {

    class func crop(image:UIImage, crop source:CGRect, aspect:CGSize, outputExtent:CGSize) -> UIImage {

        let sourceRect = AVMakeRectWithAspectRatioInsideRect(aspect, source)
        let targetRect = AVMakeRectWithAspectRatioInsideRect(aspect, CGRect(origin: CGPointZero, size: outputExtent))

        let opaque = true, deviceScale:CGFloat = 0.0 // use scale of device's main screen
        UIGraphicsBeginImageContextWithOptions(targetRect.size, opaque, deviceScale)

        let scale = max(
            targetRect.size.width / sourceRect.size.width,
            targetRect.size.height / sourceRect.size.height)

        let drawRect = CGRect(origin: -sourceRect.origin * scale, size: image.size * scale)
        image.drawInRect(drawRect)

        let scaledImage = UIGraphicsGetImageFromCurrentImageContext()
        UIGraphicsEndImageContext()

        return scaledImage
    }
} 
```

我发现有几件事令人困惑，裁剪和调整大小的不同问题。裁剪由您传递给 drawInRect 的矩形的原点处理，缩放由大小部分处理。在我的情况下，我需要将源上的裁剪矩形的大小与相同纵横比的输出矩形相关联。然后输出/输入比例因子，这需要应用于drawRect（传递给drawInRect）。

需要注意的是，这种方法有效地假设您正在绘制的图像大于图像上下文。我没有对此进行测试，但我认为您可以使用此代码来处理裁剪/缩放，但明确地将比例参数定义为上述比例参数。默认情况下，UIKit 根据屏幕分辨率应用乘数。

最后，应该注意的是，这种 UIKit 方法比 CoreGraphics / Quartz 和 Core Image 方法级别更高，并且似乎可以处理图像方向问题。还值得一提的是，它非常快，仅次于 ImageIO，根据这里的这篇文章：http: [//nshipster.com/image-resizing/](http://nshipster.com/image-resizing/)

# asp.net-mvc - 我应该如何使用 ASP.NET MVC 路由实现本地化？

> ID：603915
> 
> 赞同：3
> 
> 时间：2009-03-02T20:45:23.117
> 
> 标签：asp.net-mvc, localization, routing

我正在尝试为新的 ASP.NET MVC 站点的未来（几个月后）本地化做计划。

就构建 URL 和路由而言，试图决定做什么最有意义。

例如，我应该立即开始：

```
 http://www.example.com/en/Products/1001
 http://www.example.com/es/Products/1001 
```

要不就

```
 http://www.example.com/Products/1001 
```

然后稍后添加其他语言

```
 http://www.example.com/en/Products/1001 
```

这就是我现在的基本主要问题，试图让路由正确。我希望我的 URL 可以被搜索引擎正确索引。我什至不确定我是否想要 URL 中的语言，但我认为没有一个不会混淆搜索引擎的好选择。

它会导致各种其他问题，例如“我是否应该将产品一词本地化”，但现在我只想在启动英文网站之前先确定路由。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T22:34:17.503

我和你有完全相同的 URL_mapping。我的路线也使用了约束。为我工作。

```
 routes.MapRoute(
            // Route name
            "LocalizedController", 
            // URL with parameters                                             
            "{language}/{controller}/{action}",
            // Parameter defaults
            new {
                controller = "Home", action = "Index", 
                language = "de"
            },
              //Parameter constraints
            new { language = @"de|en" } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-12T19:21:18.980

我会使用不同的 URL 方案，如下所示：

```
en.mysite.com (English)
mysite.com (default language)
ro.mysite.com (Romanian) 
```

等等

然后我会像在[这个答案](https://stackoverflow.com/questions/278668/is-it-possible-to-make-an-asp-net-mvc-route-based-on-a-subdomain/541495#541495)中那样创建一个自定义路线。

# ruby - 在字符串类中获取字符串值

> ID：603922
> 
> 赞同：1
> 
> 时间：2009-03-02T20:47:27.713
> 
> 标签：ruby

我正在向 Ruby 中的 String 类添加一个新方法，如何获取该类的值？

例如：

```
class String
 def myMethodName(arguments)
   # here I want the string value
 end
end

puts "Lennie".myMethodName()
# this should return "Lennie" or whatever the value of the string is. 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T20:56:18.020

您应该能够通过参考访问实际的字符串值`self`：

```
class String
    def myMethodName()
        self
    end
end

puts "Lennie".myMethodName()
# => "Lennie" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T20:55:34.837

如何使用“自我”？

考虑到您将 a 方法添加到 String，self 指的是字符串本身。我想如果你不确定你可以使用“self to_s”来确定你真的得到了周围对象的字符串值。

所以：

```
def mymethod(args)
  self
end 
```

应该做的伎俩

# c# - 闰年错误调用 ToUniversalTime().AddYears().ToLocalTime()？

> ID：603923
> 
> 赞同：2
> 
> 时间：2009-03-02T20:48:07.960
> 
> 标签：c#, .net, datetime, leap-year

`DateTime`我在 .NET 的处理中遇到了可能是闰年，特别是`ToLocalTime()`. 这是一些重现问题的代码（我在太平洋时区）：

```
DateTime dtStartLocal = DateTime.Parse("2009-02-28T23:00:00.0-08:00");
DateTime dtEndLocal = dtStartLocal.AddYears(3);
DateTime dtStartUtc = dtStartLocal.ToUniversalTime();
DateTime dtEndUtc = dtStartUtc.AddYears(3);
DateTime dtEndLocal2 = dtEndUtc.ToLocalTime();
DateTime dtStartLocal2 = dtStartUtc.ToLocalTime();
Console.WriteLine("START: 1={0}, 2={0}", dtStartLocal, dtStartLocal2);
Console.WriteLine("END  : 1={0}, 2={1}", dtEndLocal, dtEndLocal2);
Console.ReadLine(); 
```

输出是：

> 开始：1=2/28/2009 晚上 11:00:00，2=2/28/2009 晚上 11:00:00
> 结束：1=2/28/2012 晚上 11:00:00，2=2/29 /2012 晚上 11:00:00

请注意，我所做的变量`ToUniversalTime().AddYears(3).ToLocalTime()`与 just 不同`AddYears(3)`，它提前一天。

有没有人遇到过这个？如果这是预期的，有人可以解释其背后的逻辑吗？

注意：是的，最好的方法是完全在 UTC 中工作，而不是在它们之间翻转。这不是影响我的东西，而是我遇到的特殊情况。本质上我误解了它是如何`AddYears()`工作的，现在我可以看到它为什么在做它正在做的事情（请参阅下面我选择的答案）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-02T20:57:53.523

我认为这工作正常。

```
DateTime dtStartUtc = dtStartLocal.ToUniversalTime(); 
```

PST 是 UTC-8。因此，这会将时间转换为 2009 年 3 月 1 日 07:00:00。

```
DateTime dtEndUtc = dtStartUtc.AddYears(3); 
```

这比上一次增加了三年，即 2012 年 3 月 1 日 07:00:00。

```
DateTime dtEndLocal2 = dtEndUtc.ToLocalTime(); 
```

这会将结束时间转换回 PST，即 2012 年 2 月 29 日 11:00:00。

我想说这只是在本地时间和 UTC 时间之间转换的副作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T20:57:05.490

打印时区/校正因子。当您执行 .ToUniversialTime() 时，它实际上会从您的原始时间（“-08:00”）添加 8 小时，这将从 2 月 28 日 23:00 开始的第二天 11:00。因此，当您将其添加 3 年时，即为 29 日上午 11:00。如果你做了2年，那就是3月1日，它与闰年无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T21:06:39.943

据我所知，这种行为并不正确。当您将本地时间转换为 UTC 时，它会有效地将其推到第二天；3 月 1 日。当您添加三年时，它将保持为 3 月 1 日。将其转换回当地时间并回滚到前一天，因为 2012 年是闰年，所以是 2 月 29 日。

# javascript - 从javascript提交名称值对？

> ID：603924
> 
> 赞同：1
> 
> 时间：2009-03-02T20:48:10.143
> 
> 标签：javascript, forms, submit

JS 可以通过 document.testform.submit() 提交名称/值对吗？? 还是必须通过html标签提交，例如

```
<INPUT TYPE="text" NAME="inputbox1" VALUE="This is such a great form!" SIZE=50><P> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T22:27:05.087

通常，您在表单中包含一个 <input type="hidden"> ，并在提交之前在事件处理程序中设置您想要的值。

```
<form method="post" action="thing" id="sandwich"><fieldset>
    <input type="text" name="inputbox1" value="This is such a great form!" />
    <input type="hidden" name="jsremark" />
</fieldset></form>

<script type="text/javascript">
    document.getElementById('sandwich').onsubmit= function() {
        this.elements.jsremark.value= 'Secretly it aint that great';
        return true;
    }
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T20:48:53.060

不，您必须自己使用 javascript 将其混入 JSON

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T20:52:44.533

使用 jquery 非常简单：

```
$("#formid").bind("submit", function(){
 var str = $("#formid").serialize();
 $.post("url?"+str);
 return false;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T20:53:36.433

您可以仅使用 JS 设置 ajax 请求的发布数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T22:40:54.057

使用 jQuery 很简单：

```
$.post(url, {"name":"value"}) 
```

# c# - 如何每分钟更新 C# 中的 datagridview

> ID：603929
> 
> 赞同：5
> 
> 时间：2009-03-02T20:49:20.533
> 
> 标签：c#, winforms, datagridview

我目前正在使用 C# 开发一个非常简单的项目。

我有一个状态框、两个按钮和一个 dataGridView。

当表单加载时，dataGridView 已正确填充。

然后我想做的是每 45 秒更新一次该表以反映数据库中的任何更改。

我正在寻找有关实现此目标的技术的建议。我一直在寻找明确的信息，但似乎有些缺乏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-02T21:08:46.617

1.  将`Timer`控件添加到您的表单。（它在组件类别中）
2.  将其`Interval`属性设置为`45000`（值表示毫秒）
3.  `Enabled`将计时器的属性设置为`True`在表单设计器中，或在代码中的某个位置。
4.  为计时器的`Tick`事件添加一个处理程序（您可以通过双击计时器来获取）
5.  在`Tick`处理程序内部，更新您的`dataGridView`

您的处理程序将如下所示：

```
private void timer1_Tick(object sender, EventArgs e)
{
    // Update DataGridView
} 
```

如果您出于某种原因需要暂停更新，您可以调用`timer1.Stop()`以停止计时器运行，并使用`timer1.Start()`重新启动它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-02T21:08:27.210

像其他人建议的那样，使用 Timer 重新查询数据库。我唯一要补充的是，当您重新查询数据库时，不要只将 DataGridView 的数据源设置为新表。而是将其与现有表合并。这样做的原因是，如果用户位于网格中间，例如查看特定行，如果您将 DataSource 重置为新表，则整个网格将刷新并且它们将失去位置。烦死人了！但是，如果您*合并*它，它将对用户无缝。

[数据表合并](http://msdn.microsoft.com/en-us/library/system.data.datatable.merge.aspx)

使用 Merge 方法时要注意的一件事是表需要有一个主键。仔细检查以确保 DataTable 本身具有主键。它并不总是将其从数据库中拉回。您可能需要执行以下操作：

```
table.PrimaryKey = new DataColumn[] {table.Columns["ID"]}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-02T20:52:43.847

使用计时器控件，然后以您需要的特定增量执行更新。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T20:53:43.003

您可以创建一个每 45 秒触发一次的[Timer](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.aspx)，并从其事件处理程序更新您的 UI。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-25T13:21:53.367

你的意思是我应该在 Timer 事件处理程序中再次绑定 datagridview 吗？

# embedded - USB 虚拟 COM

> ID：603931
> 
> 赞同：0
> 
> 时间：2009-03-02T20:49:32.137
> 
> 标签：embedded, usbserial

正在寻找嵌入式（非 PC）USB 虚拟 COM 实现的骨架/源代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-02T21:08:56.287

取决于你的处理器。

例如，ST 为其 STM32 系列提供了一个 VCP 示例。FreeRTOS 还提供了 AT91 部件的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-14T09:42:32.303

我从来没有将 LibUSB 用于 ARV famyli，它是软件 USB，不需要设备上的特殊芯片，但需要在 PCB 上放置一些外部硬件。我从未使用过它，但它可能会得到 avr freks 网站的高度支持

# php - Zend 框架：使用模型和视图，最佳实践

> ID：603935
> 
> 赞同：9
> 
> 时间：2009-03-02T20:50:34.490
> 
> 标签：php, zend-framework, model

我对面向对象编程比较陌生。我非常了解这些概念，但实际上，我很难找到有关如何在我的 Zend Framework 应用程序中最好地使用模型的信息。

具体来说，我有一个不使用数据库表的模型（不扩展任何东西）。它使用 getter 和 setter 来访问其受保护的成员。我发现自己在为如何在视图中最好地显示这个模型而苦苦挣扎。我不想在我的视图模板中使用逻辑，但我发现自己处于以下情况：

在我的控制器中：

```
$object = new Object();
$object->setName('Foo Bar');
$this->view->object = $object; 
```

在我的视图模板中：

```
<h2><?= $this->object->getName() ?></h2> 
```

我真的不喜欢在我的视图模板中调用函数，但我不知道更好的方法来做到这一点。我不希望我的模型成员公开，但我基本上希望达到相同的结果：

```
<h2><?= $this->object->name ?></h2> 
```

我不希望我的控制器完成所有必须了解模型的所有工作：

```
$object = new Object();
$object->setName('Foo Bar');
$this->view->object = $object;
$this->view->object->name = $object->getName(); 
```

在 Zend 框架中使用模型的最佳实践是什么？任何人都可以推荐任何可以帮助我理解 Zend 框架中的模型/视图困境的教程吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T22:47:51.777

一种可能性是在 PHP 中使用神奇的 __set 和 __get 方法。我在我的抽象模型类中使用它们：

```
abstract class Model_Abstract
{
    protected $_data;

    // Private Data Members assigned to protected $_data
    public function __construct($data = null)
    {
        // Makes it so that I can pass in an associative array as well as 
        // an StdObject.
        if(!is_object($data)) {
            $data = (object) $data;
        }

        $this->_data = $data;

    }

    public function __get($key)
    {
        if (method_exists($this, '_get' . ucfirst($key))) {
            $method = '_get' . ucfirst($key);
            return $this->$method();            
        }
        else {
            return $this->_data->$key;
        }   
    }

    public function __set($key, $val)
    {
        if ( method_exists( $this, '_set' . ucfirst($key) ) ) {
            $method = '_set' . ucfirst($key);
            return $this->$method($val);            
        }
        else {
            $this->_data->$key = $val;
            return $this->_data->$key;
        }
    }
}

class Model_User extends Model_Abstract
{
    //Example overriding method for the property firstName in the $_data collection.
    protected function _getFirstName()
    {
        // Do some special processing and then output the first name.
    }
} 
```

这使得您可以根据需要为属性指定 getter 和 setter，但这样您就不必为每个属性定义样板函数，只需在返回之前对其进行某种处理的那些价值。例如，我在许多地方使用该功能将符合 ISO 标准的日期（存储在 MySQL 中）更改为更紧凑、更易于用户阅读的格式。

至于在您的控制器中放置什么，我建议您查看[这篇文章](https://stackoverflow.com/questions/432435/zendframework-where-to-place-get-and-post-http-request-handling)以获取有关在控制器中放置什么处理的一些具体反馈。

有些人觉得他们宁愿有一个助手来自动将模型加载到视图中并完全绕过控制器。我个人会说，在 Zend Framework 和 PHP 的上下文中，将模型从控制器传递到视图中是很有意义的，因为视图中模型的状态通常取决于来自请求的内容（绝对应该处理在控制器中）。

**更新：**根据评论中的批评，我要指出的一件事是，您的数据库访问层和域（或模型）层实际上是两个不同的东西，尽管使用 Active Record，它们混合在一起。不久前我问了[这个问题](https://stackoverflow.com/questions/373054/how-to-properly-create-domain-using-zend-framework)，并收到了一些关于这个问题的有用反馈。无论您决定对模型做什么，您都希望为所有域对象提供一致的 API，而不管模型的数据来自何处。

我想 Saem 的回答提供的一个好处是，它提供了将属性/函数返回值从一个或多个域对象直接映射到视图对象的能力。从理论上讲，视图中的用法如下所示：

```
// Mapped from Model_User::_data->last_name and Model_User::_data->first_name
$this->name 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-02T21:04:14.210

如果只有其他开发人员要使用模板，我建议只传递模型。这是 Jeff Atwood 关于 MVC[理解模型-视图-控制器的帖子的链接](http://www.codinghorror.com/blog/archives/001112.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T21:31:45.593

这并不是特别适合 zend 框架，但在我看来，这个问题相当普遍。

看来您走在正确的道路上，而不是在控制器内部将模型硬连接到视图。如果您要映射大量模型或一遍又一遍地映射同一个模型，您宁愿拥有那个抽象，这一点尤其重要。

一些简单的方法是编写一堆映射函数，如果你要避免的只是一遍又一遍地映射相同的东西，那就没问题了。

如果您想要一个更通用的解决方案，同时也解决了避免编写样板代码并保持更干燥的问题，我建议创建一个映射器类。

您可以创建一个 ViewModelMapper，它将采用一个模型或几个模型并将它们映射到视图。

```
class ViewModelMapper
{
    public function __construct($view)
    {
        //set the properties
    }

    public function addModel($model, $overrideViewProperty = null)
    {
        //add the model to the list of models to map, use the view's property 
        // name to figure out what to map it to? Allow for an override just in case.
    }

    public function getMappedView()
    {
        //take the view, map all the models
    }
} 
```

然后，您可以在控制器上实例化它，并设置映射，因此控制器仍然控制映射，但是对于所有控制器映射，所有样板和编码逻辑都是集中的，除了极少数例外。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-10T05:14:07.733

要深入了解模型架构，[请阅读这篇文章](http://weierophinney.net/matthew/archives/202-Model-Infrastructure.html "阅读这篇文章")。它没有具体谈论观点，但绝对值得一读。

我最终`getViewClass()`为我的模型添加了一个功能。控制器调用此函数来获取它原本无法访问的受保护变量，并且视图不必担心调用任何 getter。

```
//controller
$object = new Object();
$object->setName('Foo Bar');
$this->view->object = $object->getViewClass();

//view template
<h2><?= $this->object->name ?></h2> 
```

我不知道是否有更好的方法可以在 Zend 框架中完成这项工作，但这是一种解决方案。

# actionscript-3 - 为什么我的 URLLoader 在完成时没有调度？

> ID：603941
> 
> 赞同：7
> 
> 时间：2009-03-02T20:51:50.963
> 
> 标签：actionscript-3, urlloader

我正在使用 URLLoader 将一些键/值对发送到 php 脚本，然后将它们转换为电子邮件，发送（或不发送），然后回显带有响应的字符串。

起初它工作正常。URLLoader 发布，一分钟后我收到了电子邮件，但由于某种原因，我没有收到回复。事实上，我的 COMPLETE 事件似乎根本没有触发。这让我很困惑，因为如果我收到电子邮件，我知道我必须正确发送所有内容。这是我的代码：

```
public class Mailman{
    public static const METHOD:String = URLRequestMethod.POST;
    public static const ACTION:String = "mailer.php";

    public static var myLoader:URLLoader = new URLLoader();

    private static function onMessageProgress(e:Event){
        var L:URLLoader = e.target as URLLoader;
        Output.trace("PROGRESS: "+L.bytesLoaded+"/"+L.bytesTotal);
        for(var k in L){
            Output.trace("   "+k+": "+L[k]);
        }
    }

    private static function onOpen(e:Event){
        Output.trace("Connection opened");
    }

    private static function onComplete(e:Event){
        Output.trace("Complete!");
    }

    private static function onStatusChange(e:HTTPStatusEvent){
        Output.trace("Status Changed to "+e.status);
    }

    private static function onMessageFail(e:Event){
        PanelManager.alert("ERROR: Could not send your request. Please try again later.");
    }

    public static function sendMessage(recipient:String,subject:String,message:String){
        var _vars:URLVariables = new URLVariables();
            _vars.recipient = recipient;
            _vars.subject = subject;
            _vars.message = message;

        var req:URLRequest = new URLRequest(ACTION);
        req.data = _vars;
        req.method = METHOD;

        myLoader.dataFormat = URLLoaderDataFormat.VARIABLES;
        myLoader.addEventListener(ProgressEvent.PROGRESS,onMessageProgress);
        myLoader.addEventListener(Event.OPEN,onOpen);
        myLoader.addEventListener(Event.COMPLETE,onComplete);
        myLoader.addEventListener(HTTPStatusEvent.HTTP_STATUS,onStatusChange);
        myLoader.addEventListener(IOErrorEvent.IO_ERROR,onMessageFail);
        myLoader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,onMessageFail);
        myLoader.load(req);
    }

    public static function test(){
        sendMessage("john@example.com","test","this is a test message.");
    }

    function Mailman(){}
} 
```

当我打电话给 时`Mailman.test()`，我收到的电子邮件与我预期的完全一样，这就是追踪结果：

```
    连接打开
    进展：45/45
    状态更改为 0

```

怎么会这样？如果我正确理解了文档，当我开始下载我的响应时会发生 Open 事件，并且显然正在发生这种情况，那么我怎样才能恢复 0 的 http 状态？有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T21:30:21.993

我找到了。

问题出在 URLLoader 的数据格式上。这是您返回的格式，而不是您发送的格式。我把它切换到它`URLLoaderDataFormat.TEXT`，它工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-10T23:51:19.427

这可能发生的另一个原因 - 如果您在注册事件侦听器时使用弱引用，并且不保留对 URLLoader 实例和处理事件的实例的引用，GC 可能会在它们接收任何事件之前清理它们。

```
//make sure the URLLoader and onComplete instances are not local vars
var req:URLRequest = new URLRequest("dosomething.php");
myLoader.addEventListener(Event.COMPLETE, onComplete, false, 0, TRUE);
myLoader.load(req); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-01T11:45:37.250

好的，我在我的情况下找到了答案，它是负责 Chrome 中 Status=0 的 .NET 页面。在将响应发送回闪存后，我们在 .net 页面的行中执行该操作，我们正在关闭正在重置页面的响应对象，因此 Chrome 显示 status=0 并且无法呈现结果. 注释掉 response.close 行后，它开始正常工作。[我在http://viveklakhanpal.wordpress.com/2010/07/01/error-2032ioerror/](http://viveklakhanpal.wordpress.com/2010/07/01/error-2032ioerror/)上写了我对这个问题的经验以及我是如何解决它的

谢谢，维维克。

# iphone - 最高性能的音频层？

> ID：603951
> 
> 赞同：2
> 
> 时间：2009-03-02T20:54:07.197
> 
> 标签：iphone, cocoa-touch

我很好奇在 iPhone 上可用的音频层中哪一个是性能最高的。目前我使用了 SystemSoundID 方法和 AVAudioPlayer 方法，我想知道是否值得研究 AudioQueue 或 OpenAL ......是否有显着的性能提升？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T11:59:19.987

音频是一个复杂的问题，而且大部分是由硬件完成的，因此更改 API 并没有提高性能。

不同的 API 用于不同的任务：

*   SystemSound 用于短通知声音（最长 10 秒）
*   AudioQueue 适用于比 SystemSound 更长的所有内容
*   AVAudioPlayer 只是 AudioQueue 之上的一个 Objective-C 层，你不会因为这个层而失去任何性能。（因此，如果 AVAudioPlayer 为您工作，请继续使用它！）
*   OpenAL 用于音效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T12:04:13.670

iPhone 的[FMOD](http://www.fmod.org)怎么样？它主要用于游戏开发，可用于各种平台。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T02:05:48.673

我一直在阅读有关使用 RemoteIO 的非常低级别和非常低延迟的音频。看看这篇文章和随后的（长篇）讨论：[使用 RemoteIO 音频单元](http://michael.tyson.id.au/2008/11/04/using-remoteio-audio-unit/)。我不建议您走这条路，除非您的应用程序的高级库完全失败。作者发现不同方法之间的性能差异非常明显——有些出乎意料。YMMV

# blogs - 特定领域的语言博主

> ID：603958
> 
> 赞同：5
> 
> 时间：2009-03-02T20:55:40.720
> 
> 标签：blogs, dsl

我目前需要大大增加我对 DSL 的了解。谁是 DSL 中的大人物？我应该阅读哪些博客？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-02T21:12:04.003

[您可以在Lambda the Ultimate](http://lambda-the-ultimate.org/)博客上阅读很多关于语言设计的有趣内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T21:04:17.047

Martin Fowler 写了一[本关于 DSL](http://martinfowler.com/books.html#dsl)的书（[亚马逊链接](https://rads.stackoverflow.com/amzn/click/com/0321712943)）。Ayende Rahien 完成了一[本](http://ayende.com/Blog/archive/2009/03/02/building-domain-specific-languages-with-boo-ndash-full-book-now.aspx)关于在 Boo 中编写 DSL 的书，这本书也可以通过 Manning 的早期访问计划[在线获得。](http://www.manning.com/rahien/)前者是概念性的，而后者是实用指南。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T20:58:44.923

[Martin Fowler](http://martinfowler.com/)是第一个想到的人。他的页面上也有指向其他资源的链接。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T14:06:29.087

我知道这是一个老问题，但我喜欢阅读 eelco visser 的[博客](http://blog.eelcovisser.net/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-02T21:00:59.740

首先是马丁·福勒和埃里克·埃文斯。

也许是吉米尼尔森。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T21:09:14.323

[Paul Hudak](http://cs-www.cs.yale.edu/homes/hudak-paul/)是从事 Haskell 工作的人之一，并撰写[了这篇](http://portal.acm.org/citation.cfm?id=242477)关于在 Haskell 中实现嵌入式 DSL 的论文。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-18T14:09:46.740

[Ayende Rahien](http://ayende.com/Blog/category/547.aspx)关于各种事物的博客，包括通过 Boo 的 DSL

# linq-to-sql - 使用 LINQ2SQL 从存储过程返回匿名类型

> ID：603967
> 
> 赞同：2
> 
> 时间：2009-03-02T20:57:22.010
> 
> 标签：linq-to-sql, stored-procedures

考虑以下存储过程：

```
SELECT * FROM Customers;

SELECT Customer.Id, Customer.Name, Order.Total, Order.DateOrdered
FROM Customers INNER JOIN Orders ON Customers.Id = Orders.CustomerId; 
```

该过程显然返回两个结果集，我试图用这个部分类方法检索它们：

```
public partial class DBSproc : DataContext
{
    [Function(Name = "dbo.spGetCustomersAndOrders")]
    [ResultType(typeof(Customer))]
    // What type should I use here for the second resultset?
    [ResultType(typeof(... what here? ...))] 
    public IMultipleResults GetCustomersAndOrders()
    {
        IExecuteResult result =
            this.ExecuteMethodCall(this,
               ((MethodInfo)(MethodInfo.GetCurrentMethod())));

        return (IMultipleResults)(result.ReturnValue);
    }
} 
```

我知道第一个结果集将映射到 Customer 实体，但第二个结果集呢？第二个是自定义选择，将多个表中的多个列组合在一起。我没有具有这些属性的实体。

我应该为该结果集创建一个虚拟实体吗？我希望我能以某种方式将匿名类型用于此类临时查询。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T23:53:43.320

一般来说，只有当返回类型为“对象”时，才能从方法返回匿名类型。然后，调用代码不知道您的匿名类型可能具有哪些属性，除非它使用反射。

所以是的，您可以使用匿名类型，但您可能不想这样做，因为它不是很有用。

# c++ - 在 VS2008 中使用 STL 端口

> ID：603973
> 
> 赞同：0
> 
> 时间：2009-03-02T20:58:54.283
> 
> 标签：c++, visual-studio-2008, stlport

我正在将我们的 C++ 代码从 eVC 4.0 移植到 Visual Studio 2008。我们的目标是 Windows Mobile 6.1，我们正在为我们的应用程序使用 Windows Mobile 6.0 SDK。

我们的代码在 eVC 4 中编译时使用了 stl 端口，如果可能的话，我们希望继续使用 stl 端口。

有谁知道在我们的应用程序中合并 STL 端口（5.2.1）需要哪些步骤。我们已经在解决方案中设置了包含目录（就像我们为 eVC 4.0 项目所做的那样），但是每当我们尝试将列表 push_back 或向量插入命令与我们自己的类一起使用时，我们都会看到错误（下面）（下面是错误与我们的类“TriangleBufferElement”）。这些命令似乎确实适用于 int、double 等本机类型。

我们确保所有类都具有正确的构造函数、复制构造函数、赋值运算符和比较运算符，并且看起来都是正确的。

有任何想法吗？

```
C:\Program Files\Windows CE Tools\stlport\stl/_construct.h(119) : error C2665: 'operator new' : none of the 2 overloads could convert all the argument types
1>        C:\Program Files\Windows Mobile 6 SDK\PocketPC\include\../../../Windows Mobile 6 SDK\PocketPC\Include\Armv4i/new(61): could be 'void *operator new(unsigned int,const std::nothrow_t &) throw()'
1>        while trying to match the argument list '(unsigned int, TriangleBufferElement *)'
1>        C:\Program Files\Windows CE Tools\stlport\stl/_construct.h(134) : see reference to function template instantiation 'void stlp_std::_Copy_Construct_aux<_Tp>(_Tp *,const _Tp &,const stlp_std::__false_type &)' being compiled
1>        with
1>        [
1>            _Tp=TriangleBufferElement
1>        ]
1>        C:\Program Files\Windows CE Tools\stlport\stl/_vector.h(381) : see reference to function template instantiation 'void stlp_std::_Copy_Construct<_Tp>(_Tp *,const _Tp &)' being compiled
1>        with
1>        [
1>            _Tp=TriangleBufferElement
1>        ]
1>        C:\Program Files\Windows CE Tools\stlport\stl/_vector.h(376) : while compiling class template member function 'void stlp_std::vector<_Tp>::push_back(const _Tp &)'
1>        with
1>        [
1>            _Tp=TriangleBufferElement
1>        ]
1>        c:\srcdevbranch\pointlib\dtmconverter\dtm\dtmreader\.\trianglebuffer.h(47) : see reference to class template instantiation 'stlp_std::vector<_Tp>' being compiled
1>        with
1>        [
1>            _Tp=TriangleBufferElement
1>        ] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T21:10:11.403

您可能应该看到的一些链接（如果还没有看到）：

[STL端口注意事项：](http://www.stlport.org/doc/README.VC++.html)

> 您可能会遇到使用默认 SGI 节点分配器的问题。不过，我没有这样的问题。默认节点分配器非常快，所以我不建议在没有正当理由的情况下禁用它。但是，如果它导致问题，请定义`_STLP_USE_MALLOC`或`_STLP_USE_NEWALLOC`获取基于 bare`malloc()`或`new()`-based 的默认分配器。

虽然[这篇](http://objectmix.com/c/321331-install-other-stl-sgi-stlport-etc-visual-studio-2008-c-9-0-a.html)文章说它还没有被移植到 VS2008。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T21:25:51.193

您是否为新的编译器环境重新配置了 STLPort？Visual Studio 2008 与旧的 eVC++ 编译器完全不同。

尝试：

```
 configure evc9 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-27T19:52:30.357

就我而言，这是由于定义了 __PLACEMENT_NEW_INLINE

# javascript - 从javascript设置的html值？

> ID：603974
> 
> 赞同：7
> 
> 时间：2009-03-02T20:58:57.233
> 
> 标签：javascript, forms, variables

```
<script type="text/javascript">
  var p = s.getMaximum();
</script>

<form action="/cgi-bin/Lib.exe" method="POST" name="checks" ID="Form1">
    <INPUT TYPE="text" NAME="inputbox" VALUE="VAR P FROM JAVA SCRIPT HERE?" ID="Text1"><P></form> 
```

可以将 javascript 值“p”作为输入表单的值传递吗？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-02T21:01:57.273

您可以使用 javascript 将该元素的值设置为`p`.

```
<script type="text/javascript">
    document.getElementById("Text1").value = p;
</script> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-02T21:02:29.550

```
document.getElementById('Text1').value = p; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T21:02:40.547

您想了解 Javascript DOM。

从以下内容开始：http: [//www.w3schools.com/htmldom/dom_obj_form.asp](http://www.w3schools.com/htmldom/dom_obj_form.asp)

具体来说，您正在寻找操纵 document.checks.inputbox.value

编辑：页面已删除。现在可以在这里找到答案：http: [//www.w3schools.com/jsref/coll_doc_forms.asp](http://www.w3schools.com/jsref/coll_doc_forms.asp)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-11T23:26:10.320

使用 Javascript：

```
<script type="text/javascript">
    document.getElementById("Text1").value = p;
</script> 
```

使用 jQuery：

```
<script type="text/javascript">
    $("#Text1").val(p);
</script> 
```

# javascript - What is the JavaScript equivalent of var_dump or print_r in PHP?

> ID：603987
> 
> 赞同：314
> 
> 时间：2009-03-02T21:03:17.550
> 
> 标签：javascript, object, dump, var-dump

I would like to see the structure of object in JavaScript (for debugging). Is there anything similar to var_dump in PHP?

* * *

## 回答 #1

> 赞同：322
> 
> 时间：2009-03-02T21:05:54.033

Most modern browsers have a console in their developer tools, useful for this sort of debugging.

```
console.log(myvar); 
```

Then you will get a nicely mapped out interface of the object/whatever in the console.

Check out the [`console`](https://developer.mozilla.org/en-US/docs/Web/API/Console) documentation for more details.

* * *

## 回答 #2

> 赞同：172
> 
> 时间：2012-10-05T09:56:37.857

Most common way:

```
console.log(object); 
```

However I must mention `JSON.stringify` which is useful to dump variables in non-browser scripts:

```
console.log( JSON.stringify(object) ); 
```

The `JSON.stringify` function also supports built-in prettification as pointed out by *Simon Zyx*.

Example:

```
var obj = {x: 1, y: 2, z: 3};

console.log( JSON.stringify(obj, null, 2) ); // spacing level = 2 
```

The above snippet will print:

```
{
  "x": 1,
  "y": 2,
  "z": 3
} 
```

On **caniuse.com** you can view the browsers that support natively the `JSON.stringify` function: [http://caniuse.com/json](http://caniuse.com/json)

You can also use the Douglas Crockford library to add `JSON.stringify` support on old browsers: [https://github.com/douglascrockford/JSON-js](https://github.com/douglascrockford/JSON-js)

Docs for `JSON.stringify`: [https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify)

I hope this helps :-)

* * *

## 回答 #3

> 赞同：97
> 
> 时间：2012-07-03T16:52:26.983

I wrote this JS function `dump()` to work like PHP's `var_dump()`. To show the contents of the variable in an alert window: `dump(variable)` To show the contents of the variable in the web page: `dump(variable, 'body')` To just get a string of the variable: `dump(variable, 'none')`

```
/* repeatString() returns a string which has been repeated a set number of times */
function repeatString(str, num) {
    out = '';
    for (var i = 0; i < num; i++) {
        out += str;
    }
    return out;
}

/*
dump() displays the contents of a variable like var_dump() does in PHP. dump() is
better than typeof, because it can distinguish between array, null and object.
Parameters:
    v:              The variable
    howDisplay:     "none", "body", "alert" (default)
    recursionLevel: Number of times the function has recursed when entering nested
                    objects or arrays. Each level of recursion adds extra space to the
                    output to indicate level. Set to 0 by default.
Return Value:
    A string of the variable's contents
Limitations:
    Can't pass an undefined variable to dump(). 
    dump() can't distinguish between int and float.
    dump() can't tell the original variable type of a member variable of an object.
    These limitations can't be fixed because these are *features* of JS. However, dump()
*/
function dump(v, howDisplay, recursionLevel) {
    howDisplay = (typeof howDisplay === 'undefined') ? "alert" : howDisplay;
    recursionLevel = (typeof recursionLevel !== 'number') ? 0 : recursionLevel;

    var vType = typeof v;
    var out = vType;

    switch (vType) {
        case "number":
        /* there is absolutely no way in JS to distinguish 2 from 2.0
           so 'number' is the best that you can do. The following doesn't work:
           var er = /^[0-9]+$/;
           if (!isNaN(v) && v % 1 === 0 && er.test(3.0)) {
               out = 'int';
           }
        */
        break;
    case "boolean":
        out += ": " + v;
        break;
    case "string":
        out += "(" + v.length + '): "' + v + '"';
        break;
    case "object":
        //check if null
        if (v === null) {
            out = "null";
        }
        //If using jQuery: if ($.isArray(v))
        //If using IE: if (isArray(v))
        //this should work for all browsers according to the ECMAScript standard:
        else if (Object.prototype.toString.call(v) === '[object Array]') {
            out = 'array(' + v.length + '): {\n';
            for (var i = 0; i < v.length; i++) {
                out += repeatString('   ', recursionLevel) + "   [" + i + "]:  " +
                    dump(v[i], "none", recursionLevel + 1) + "\n";
            }
            out += repeatString('   ', recursionLevel) + "}";
        }
        else {
            //if object
            let sContents = "{\n";
            let cnt = 0;
            for (var member in v) {
                //No way to know the original data type of member, since JS
                //always converts it to a string and no other way to parse objects.
                sContents += repeatString('   ', recursionLevel) + "   " + member +
                    ":  " + dump(v[member], "none", recursionLevel + 1) + "\n";
                cnt++;
            }
            sContents += repeatString('   ', recursionLevel) + "}";
            out += "(" + cnt + "): " + sContents;
        }
        break;
    default:
        out = v;
        break;
    }

    if (howDisplay == 'body') {
        var pre = document.createElement('pre');
        pre.innerHTML = out;
        document.body.appendChild(pre);
    }
    else if (howDisplay == 'alert') {
        alert(out);
    }

    return out;
} 
```

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2012-07-25T18:18:05.960

The var_dump equivalent in JavaScript? Simply, there isn't one.

But, that doesn't mean you're left helpless. Like some have suggested, use [Firebug](https://getfirebug.com/) (or equivalent in other browsers), but unlike what others suggested, don't use console.log when you have a (slightly) better tool [console.dir](https://getfirebug.com/wiki/index.php/Console_API#console.dir.28object.29):

```
console.dir(object) 
```

> Prints an interactive listing of all properties of the object. This looks identical to the view that you would see in the DOM tab.

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2013-08-23T19:25:10.617

As others have already mentioned, the best way to debug your variables is to use a modern browser's developer console (e.g. [Chrome Developer Tools](https://developers.google.com/chrome-developer-tools/), Firefox+[Firebug](http://getfirebug.com/), [Opera Dragonfly](http://www.opera.com/dragonfly/) [(which now disappeared in the new Chromium-based (Blink) Opera, but as developers [say](http://my.opera.com/desktopteam/blog/opera-features-and-release-cycle), *"Dragonfly is not dead though we cannot give you more information yet"*)].

But in case you need another approach, there's a really useful site called **php.js**:

**[http://phpjs.org/](http://phpjs.org/)**

which provides *"JavaScript alternatives to PHP functions"* - so you can use them the similar way as you would in PHP. I will copy-paste the appropriate functions to you here, BUT **be aware that these codes can get updated on the original site in case some bugs are detected, so I suggest you visiting the [phpjs.org](http://phpjs.org/) site**! (Btw. I'm NOT affiliated with the site, but I find it extremely useful.)

# `var_dump()` in JavaScript

Here is the code of the JS-alternative of `var_dump()`:
[http://phpjs.org/functions/var_dump/](http://phpjs.org/functions/var_dump/)
it depends on the `echo()` function: [http://phpjs.org/functions/echo/](http://phpjs.org/functions/echo/)

```
function var_dump() {
  //  discuss at: http://phpjs.org/functions/var_dump/
  // original by: Brett Zamir (http://brett-zamir.me)
  // improved by: Zahlii
  // improved by: Brett Zamir (http://brett-zamir.me)
  //  depends on: echo
  //        note: For returning a string, use var_export() with the second argument set to true
  //        test: skip
  //   example 1: var_dump(1);
  //   returns 1: 'int(1)'

  var output = '',
    pad_char = ' ',
    pad_val = 4,
    lgth = 0,
    i = 0;

  var _getFuncName = function(fn) {
    var name = (/\W*function\s+([\w\$]+)\s*\(/)
      .exec(fn);
    if (!name) {
      return '(Anonymous)';
    }
    return name[1];
  };

  var _repeat_char = function(len, pad_char) {
    var str = '';
    for (var i = 0; i < len; i++) {
      str += pad_char;
    }
    return str;
  };
  var _getInnerVal = function(val, thick_pad) {
    var ret = '';
    if (val === null) {
      ret = 'NULL';
    } else if (typeof val === 'boolean') {
      ret = 'bool(' + val + ')';
    } else if (typeof val === 'string') {
      ret = 'string(' + val.length + ') "' + val + '"';
    } else if (typeof val === 'number') {
      if (parseFloat(val) == parseInt(val, 10)) {
        ret = 'int(' + val + ')';
      } else {
        ret = 'float(' + val + ')';
      }
    }
    // The remaining are not PHP behavior because these values only exist in this exact form in JavaScript
    else if (typeof val === 'undefined') {
      ret = 'undefined';
    } else if (typeof val === 'function') {
      var funcLines = val.toString()
        .split('\n');
      ret = '';
      for (var i = 0, fll = funcLines.length; i < fll; i++) {
        ret += (i !== 0 ? '\n' + thick_pad : '') + funcLines[i];
      }
    } else if (val instanceof Date) {
      ret = 'Date(' + val + ')';
    } else if (val instanceof RegExp) {
      ret = 'RegExp(' + val + ')';
    } else if (val.nodeName) {
      // Different than PHP's DOMElement
      switch (val.nodeType) {
      case 1:
        if (typeof val.namespaceURI === 'undefined' || val.namespaceURI === 'http://www.w3.org/1999/xhtml') {
          // Undefined namespace could be plain XML, but namespaceURI not widely supported
          ret = 'HTMLElement("' + val.nodeName + '")';
        } else {
          ret = 'XML Element("' + val.nodeName + '")';
        }
        break;
      case 2:
        ret = 'ATTRIBUTE_NODE(' + val.nodeName + ')';
        break;
      case 3:
        ret = 'TEXT_NODE(' + val.nodeValue + ')';
        break;
      case 4:
        ret = 'CDATA_SECTION_NODE(' + val.nodeValue + ')';
        break;
      case 5:
        ret = 'ENTITY_REFERENCE_NODE';
        break;
      case 6:
        ret = 'ENTITY_NODE';
        break;
      case 7:
        ret = 'PROCESSING_INSTRUCTION_NODE(' + val.nodeName + ':' + val.nodeValue + ')';
        break;
      case 8:
        ret = 'COMMENT_NODE(' + val.nodeValue + ')';
        break;
      case 9:
        ret = 'DOCUMENT_NODE';
        break;
      case 10:
        ret = 'DOCUMENT_TYPE_NODE';
        break;
      case 11:
        ret = 'DOCUMENT_FRAGMENT_NODE';
        break;
      case 12:
        ret = 'NOTATION_NODE';
        break;
      }
    }
    return ret;
  };

  var _formatArray = function(obj, cur_depth, pad_val, pad_char) {
    var someProp = '';
    if (cur_depth > 0) {
      cur_depth++;
    }

    var base_pad = _repeat_char(pad_val * (cur_depth - 1), pad_char);
    var thick_pad = _repeat_char(pad_val * (cur_depth + 1), pad_char);
    var str = '';
    var val = '';

    if (typeof obj === 'object' && obj !== null) {
      if (obj.constructor && _getFuncName(obj.constructor) === 'PHPJS_Resource') {
        return obj.var_dump();
      }
      lgth = 0;
      for (someProp in obj) {
        lgth++;
      }
      str += 'array(' + lgth + ') {\n';
      for (var key in obj) {
        var objVal = obj[key];
        if (typeof objVal === 'object' && objVal !== null && !(objVal instanceof Date) && !(objVal instanceof RegExp) &&
          !
          objVal.nodeName) {
          str += thick_pad + '[' + key + '] =>\n' + thick_pad + _formatArray(objVal, cur_depth + 1, pad_val,
            pad_char);
        } else {
          val = _getInnerVal(objVal, thick_pad);
          str += thick_pad + '[' + key + '] =>\n' + thick_pad + val + '\n';
        }
      }
      str += base_pad + '}\n';
    } else {
      str = _getInnerVal(obj, thick_pad);
    }
    return str;
  };

  output = _formatArray(arguments[0], 0, pad_val, pad_char);
  for (i = 1; i < arguments.length; i++) {
    output += '\n' + _formatArray(arguments[i], 0, pad_val, pad_char);
  }

  this.echo(output);
} 
```

# `print_r()` in JavaScript

Here is the `print_r()` function:
[http://phpjs.org/functions/print_r/](http://phpjs.org/functions/print_r/)
It depends on `echo()` too.

```
function print_r(array, return_val) {
  //  discuss at: http://phpjs.org/functions/print_r/
  // original by: Michael White (http://getsprink.com)
  // improved by: Ben Bryan
  // improved by: Brett Zamir (http://brett-zamir.me)
  // improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  //    input by: Brett Zamir (http://brett-zamir.me)
  //  depends on: echo
  //   example 1: print_r(1, true);
  //   returns 1: 1

  var output = '',
    pad_char = ' ',
    pad_val = 4,
    d = this.window.document,
    getFuncName = function(fn) {
      var name = (/\W*function\s+([\w\$]+)\s*\(/)
        .exec(fn);
      if (!name) {
        return '(Anonymous)';
      }
      return name[1];
    };
  repeat_char = function(len, pad_char) {
    var str = '';
    for (var i = 0; i < len; i++) {
      str += pad_char;
    }
    return str;
  };
  formatArray = function(obj, cur_depth, pad_val, pad_char) {
    if (cur_depth > 0) {
      cur_depth++;
    }

    var base_pad = repeat_char(pad_val * cur_depth, pad_char);
    var thick_pad = repeat_char(pad_val * (cur_depth + 1), pad_char);
    var str = '';

    if (typeof obj === 'object' && obj !== null && obj.constructor && getFuncName(obj.constructor) !==
      'PHPJS_Resource') {
      str += 'Array\n' + base_pad + '(\n';
      for (var key in obj) {
        if (Object.prototype.toString.call(obj[key]) === '[object Array]') {
          str += thick_pad + '[' + key + '] => ' + formatArray(obj[key], cur_depth + 1, pad_val, pad_char);
        } else {
          str += thick_pad + '[' + key + '] => ' + obj[key] + '\n';
        }
      }
      str += base_pad + ')\n';
    } else if (obj === null || obj === undefined) {
      str = '';
    } else {
      // for our "resource" class
      str = obj.toString();
    }

    return str;
  };

  output = formatArray(array, 0, pad_val, pad_char);

  if (return_val !== true) {
    if (d.body) {
      this.echo(output);
    } else {
      try {
        // We're in XUL, so appending as plain text won't work; trigger an error out of XUL
        d = XULDocument;
        this.echo('<pre xmlns="http://www.w3.org/1999/xhtml" style="white-space:pre;">' + output + '</pre>');
      } catch (e) {
        // Outputting as plain text may work in some plain XML
        this.echo(output);
      }
    }
    return true;
  }
  return output;
} 
```

# `var_export()` in JavaScript

You may also find the `var_export()` alternative useful, which also depends on `echo()`:
[http://phpjs.org/functions/var_export/](http://phpjs.org/functions/var_export/)

```
function var_export(mixed_expression, bool_return) {
  //  discuss at: http://phpjs.org/functions/var_export/
  // original by: Philip Peterson
  // improved by: johnrembo
  // improved by: Brett Zamir (http://brett-zamir.me)
  //    input by: Brian Tafoya (http://www.premasolutions.com/)
  //    input by: Hans Henrik (http://hanshenrik.tk/)
  // bugfixed by: Brett Zamir (http://brett-zamir.me)
  // bugfixed by: Brett Zamir (http://brett-zamir.me)
  //  depends on: echo
  //   example 1: var_export(null);
  //   returns 1: null
  //   example 2: var_export({0: 'Kevin', 1: 'van', 2: 'Zonneveld'}, true);
  //   returns 2: "array (\n  0 => 'Kevin',\n  1 => 'van',\n  2 => 'Zonneveld'\n)"
  //   example 3: data = 'Kevin';
  //   example 3: var_export(data, true);
  //   returns 3: "'Kevin'"

  var retstr = '',
    iret = '',
    value,
    cnt = 0,
    x = [],
    i = 0,
    funcParts = [],
    // We use the last argument (not part of PHP) to pass in
    // our indentation level
    idtLevel = arguments[2] || 2,
    innerIndent = '',
    outerIndent = '',
    getFuncName = function(fn) {
      var name = (/\W*function\s+([\w\$]+)\s*\(/)
        .exec(fn);
      if (!name) {
        return '(Anonymous)';
      }
      return name[1];
    };
  _makeIndent = function(idtLevel) {
    return (new Array(idtLevel + 1))
      .join(' ');
  };
  __getType = function(inp) {
    var i = 0,
      match, types, cons, type = typeof inp;
    if (type === 'object' && (inp && inp.constructor) &&
      getFuncName(inp.constructor) === 'PHPJS_Resource') {
      return 'resource';
    }
    if (type === 'function') {
      return 'function';
    }
    if (type === 'object' && !inp) {
      // Should this be just null?
      return 'null';
    }
    if (type === 'object') {
      if (!inp.constructor) {
        return 'object';
      }
      cons = inp.constructor.toString();
      match = cons.match(/(\w+)\(/);
      if (match) {
        cons = match[1].toLowerCase();
      }
      types = ['boolean', 'number', 'string', 'array'];
      for (i = 0; i < types.length; i++) {
        if (cons === types[i]) {
          type = types[i];
          break;
        }
      }
    }
    return type;
  };
  type = __getType(mixed_expression);

  if (type === null) {
    retstr = 'NULL';
  } else if (type === 'array' || type === 'object') {
    outerIndent = _makeIndent(idtLevel - 2);
    innerIndent = _makeIndent(idtLevel);
    for (i in mixed_expression) {
      value = this.var_export(mixed_expression[i], 1, idtLevel + 2);
      value = typeof value === 'string' ? value.replace(/</g, '&lt;')
        .
      replace(/>/g, '&gt;'): value;
      x[cnt++] = innerIndent + i + ' => ' +
        (__getType(mixed_expression[i]) === 'array' ?
          '\n' : '') + value;
    }
    iret = x.join(',\n');
    retstr = outerIndent + 'array (\n' + iret + '\n' + outerIndent + ')';
  } else if (type === 'function') {
    funcParts = mixed_expression.toString()
      .
    match(/function .*?\((.*?)\) \{([\s\S]*)\}/);

    // For lambda functions, var_export() outputs such as the following:
    // '\000lambda_1'. Since it will probably not be a common use to
    // expect this (unhelpful) form, we'll use another PHP-exportable
    // construct, create_function() (though dollar signs must be on the
    // variables in JavaScript); if using instead in JavaScript and you
    // are using the namespaced version, note that create_function() will
    // not be available as a global
    retstr = "create_function ('" + funcParts[1] + "', '" +
      funcParts[2].replace(new RegExp("'", 'g'), "\\'") + "')";
  } else if (type === 'resource') {
    // Resources treated as null for var_export
    retstr = 'NULL';
  } else {
    retstr = typeof mixed_expression !== 'string' ? mixed_expression :
      "'" + mixed_expression.replace(/(["'])/g, '\\$1')
      .
    replace(/\0/g, '\\0') + "'";
  }

  if (!bool_return) {
    this.echo(retstr);
    return null;
  }

  return retstr;
} 
```

# `echo()` in JavaScript

[http://phpjs.org/functions/echo/](http://phpjs.org/functions/echo/)

```
function echo() {
  //  discuss at: http://phpjs.org/functions/echo/
  // original by: Philip Peterson
  // improved by: echo is bad
  // improved by: Nate
  // improved by: Brett Zamir (http://brett-zamir.me)
  // improved by: Brett Zamir (http://brett-zamir.me)
  // improved by: Brett Zamir (http://brett-zamir.me)
  //  revised by: Der Simon (http://innerdom.sourceforge.net/)
  // bugfixed by: Eugene Bulkin (http://doubleaw.com/)
  // bugfixed by: Brett Zamir (http://brett-zamir.me)
  // bugfixed by: Brett Zamir (http://brett-zamir.me)
  // bugfixed by: EdorFaus
  //    input by: JB
  //        note: If browsers start to support DOM Level 3 Load and Save (parsing/serializing),
  //        note: we wouldn't need any such long code (even most of the code below). See
  //        note: link below for a cross-browser implementation in JavaScript. HTML5 might
  //        note: possibly support DOMParser, but that is not presently a standard.
  //        note: Although innerHTML is widely used and may become standard as of HTML5, it is also not ideal for
  //        note: use with a temporary holder before appending to the DOM (as is our last resort below),
  //        note: since it may not work in an XML context
  //        note: Using innerHTML to directly add to the BODY is very dangerous because it will
  //        note: break all pre-existing references to HTMLElements.
  //   example 1: echo('<div><p>abc</p><p>abc</p></div>');
  //   returns 1: undefined

  var isNode = typeof module !== 'undefined' && module.exports && typeof global !== "undefined" && {}.toString.call(
    global) == '[object global]';
  if (isNode) {
    var args = Array.prototype.slice.call(arguments);
    return console.log(args.join(' '));
  }

  var arg = '';
  var argc = arguments.length;
  var argv = arguments;
  var i = 0;
  var holder, win = this.window;
  var d = win.document;
  var ns_xhtml = 'http://www.w3.org/1999/xhtml';
  // If we're in a XUL context
  var ns_xul = 'http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul';

  var stringToDOM = function(str, parent, ns, container) {
    var extraNSs = '';
    if (ns === ns_xul) {
      extraNSs = ' xmlns:html="' + ns_xhtml + '"';
    }
    var stringContainer = '<' + container + ' xmlns="' + ns + '"' + extraNSs + '>' + str + '</' + container + '>';
    var dils = win.DOMImplementationLS;
    var dp = win.DOMParser;
    var ax = win.ActiveXObject;
    if (dils && dils.createLSInput && dils.createLSParser) {
      // Follows the DOM 3 Load and Save standard, but not
      // implemented in browsers at present; HTML5 is to standardize on innerHTML, but not for XML (though
      // possibly will also standardize with DOMParser); in the meantime, to ensure fullest browser support, could
      // attach http://svn2.assembla.com/svn/brettz9/DOMToString/DOM3.js (see http://svn2.assembla.com/svn/brettz9/DOMToString/DOM3.xhtml for a simple test file)
      var lsInput = dils.createLSInput();
      // If we're in XHTML, we'll try to allow the XHTML namespace to be available by default
      lsInput.stringData = stringContainer;
      // synchronous, no schema type
      var lsParser = dils.createLSParser(1, null);
      return lsParser.parse(lsInput)
        .firstChild;
    } else if (dp) {
      // If we're in XHTML, we'll try to allow the XHTML namespace to be available by default
      try {
        var fc = new dp()
          .parseFromString(stringContainer, 'text/xml');
        if (fc && fc.documentElement && fc.documentElement.localName !== 'parsererror' && fc.documentElement.namespaceURI !==
          'http://www.mozilla.org/newlayout/xml/parsererror.xml') {
          return fc.documentElement.firstChild;
        }
        // If there's a parsing error, we just continue on
      } catch (e) {
        // If there's a parsing error, we just continue on
      }
    } else if (ax) {
      // We don't bother with a holder in Explorer as it doesn't support namespaces
      var axo = new ax('MSXML2.DOMDocument');
      axo.loadXML(str);
      return axo.documentElement;
    }
    /*else if (win.XMLHttpRequest) {
     // Supposed to work in older Safari
      var req = new win.XMLHttpRequest;
      req.open('GET', 'data:application/xml;charset=utf-8,'+encodeURIComponent(str), false);
      if (req.overrideMimeType) {
        req.overrideMimeType('application/xml');
      }
      req.send(null);
      return req.responseXML;
    }*/
    // Document fragment did not work with innerHTML, so we create a temporary element holder
    // If we're in XHTML, we'll try to allow the XHTML namespace to be available by default
    //if (d.createElementNS && (d.contentType && d.contentType !== 'text/html')) {
    // Don't create namespaced elements if we're being served as HTML (currently only Mozilla supports this detection in true XHTML-supporting browsers, but Safari and Opera should work with the above DOMParser anyways, and IE doesn't support createElementNS anyways)
    if (d.createElementNS && // Browser supports the method
      (d.documentElement.namespaceURI || // We can use if the document is using a namespace
        d.documentElement.nodeName.toLowerCase() !== 'html' || // We know it's not HTML4 or less, if the tag is not HTML (even if the root namespace is null)
        (d.contentType && d.contentType !== 'text/html') // We know it's not regular HTML4 or less if this is Mozilla (only browser supporting the attribute) and the content type is something other than text/html; other HTML5 roots (like svg) still have a namespace
      )) {
      // Don't create namespaced elements if we're being served as HTML (currently only Mozilla supports this detection in true XHTML-supporting browsers, but Safari and Opera should work with the above DOMParser anyways, and IE doesn't support createElementNS anyways); last test is for the sake of being in a pure XML document
      holder = d.createElementNS(ns, container);
    } else {
      // Document fragment did not work with innerHTML
      holder = d.createElement(container);
    }
    holder.innerHTML = str;
    while (holder.firstChild) {
      parent.appendChild(holder.firstChild);
    }
    return false;
    // throw 'Your browser does not support DOM parsing as required by echo()';
  };

  var ieFix = function(node) {
    if (node.nodeType === 1) {
      var newNode = d.createElement(node.nodeName);
      var i, len;
      if (node.attributes && node.attributes.length > 0) {
        for (i = 0, len = node.attributes.length; i < len; i++) {
          newNode.setAttribute(node.attributes[i].nodeName, node.getAttribute(node.attributes[i].nodeName));
        }
      }
      if (node.childNodes && node.childNodes.length > 0) {
        for (i = 0, len = node.childNodes.length; i < len; i++) {
          newNode.appendChild(ieFix(node.childNodes[i]));
        }
      }
      return newNode;
    } else {
      return d.createTextNode(node.nodeValue);
    }
  };

  var replacer = function(s, m1, m2) {
    // We assume for now that embedded variables do not have dollar sign; to add a dollar sign, you currently must use {$$var} (We might change this, however.)
    // Doesn't cover all cases yet: see http://php.net/manual/en/language.types.string.php#language.types.string.syntax.double
    if (m1 !== '\\') {
      return m1 + eval(m2);
    } else {
      return s;
    }
  };

  this.php_js = this.php_js || {};
  var phpjs = this.php_js;
  var ini = phpjs.ini;
  var obs = phpjs.obs;
  for (i = 0; i < argc; i++) {
    arg = argv[i];
    if (ini && ini['phpjs.echo_embedded_vars']) {
      arg = arg.replace(/(.?)\{?\$(\w*?\}|\w*)/g, replacer);
    }

    if (!phpjs.flushing && obs && obs.length) {
      // If flushing we output, but otherwise presence of a buffer means caching output
      obs[obs.length - 1].buffer += arg;
      continue;
    }

    if (d.appendChild) {
      if (d.body) {
        if (win.navigator.appName === 'Microsoft Internet Explorer') {
          // We unfortunately cannot use feature detection, since this is an IE bug with cloneNode nodes being appended
          d.body.appendChild(stringToDOM(ieFix(arg)));
        } else {
          var unappendedLeft = stringToDOM(arg, d.body, ns_xhtml, 'div')
            .cloneNode(true); // We will not actually append the div tag (just using for providing XHTML namespace by default)
          if (unappendedLeft) {
            d.body.appendChild(unappendedLeft);
          }
        }
      } else {
        // We will not actually append the description tag (just using for providing XUL namespace by default)
        d.documentElement.appendChild(stringToDOM(arg, d.documentElement, ns_xul, 'description'));
      }
    } else if (d.write) {
      d.write(arg);
    } else {
      console.log(arg);
    }
  }
} 
```

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2009-03-02T21:07:26.667

[Firebug](http://getfirebug.com/console.html).

Then, in your javascript:

```
var blah = {something: 'hi', another: 'noway'};
console.debug("Here is blah: %o", blah); 
```

Now you can look at the console, click on the statement and see what is inside `blah`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-09-21T15:46:27.980

A nice simple solution for parsing a JSON Response to HTML.

```
var json_response = jQuery.parseJSON(data);
html_response += 'JSON Response:<br />';

jQuery.each(json_response, function(k, v) {
    html_response += outputJSONReponse(k, v);
});

function outputJSONReponse(k, v) {
    var html_response = k + ': ';

    if(jQuery.isArray(v) || jQuery.isPlainObject(v)) {
        jQuery.each(v, function(j, w) {
            html_response += outputJSONReponse(j, w);
        });
    } else {
        html_response += v + '<br />';
    }

    return html_response;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-03-20T13:02:11.900

You could also try this function. Can't remember the original author, but all credits goes to him/her.

Works like a charm - 100% the same as var_dump in PHP.

Check it out.

```
function dump(arr,level) {
	var dumped_text = "";
	if(!level) level = 0;

	//The padding given at the beginning of the line.
	var level_padding = "";
	for(var j=0;j<level+1;j++) level_padding += "    ";

	if(typeof(arr) == 'object') { //Array/Hashes/Objects
		for(var item in arr) {
			var value = arr[item];

			if(typeof(value) == 'object') { //If it is an array,
				dumped_text += level_padding + "'" + item + "' ...\n";
				dumped_text += dump(value,level+1);
			} else {
				dumped_text += level_padding + "'" + item + "' => \"" + value + "\"\n";
			}
		}
	} else { //Stings/Chars/Numbers etc.
		dumped_text = "===>"+arr+"<===("+typeof(arr)+")";
	}
	return dumped_text;
}

// Example:

var employees = [
    { id: '1', sex: 'm', city: 'Paris' }, 
    { id: '2', sex: 'f', city: 'London' },
    { id: '3', sex: 'f', city: 'New York' },
    { id: '4', sex: 'm', city: 'Moscow' },
    { id: '5', sex: 'm', city: 'Berlin' }
]

// Open dev console (F12) to see results:

console.log(dump(employees));
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-10-03T20:12:03.917

I put this forward to help anyone needing something readily practical for giving you a nice, prettified (indented) picture of a JS `Node`. None of the other solutions worked for me for a `Node` ("cyclical error" or whatever...). This walks you through the tree under the DOM `Node` (without using recursion) and gives you the depth, `tagName` (if applicable) and `textContent` (if applicable).

Any other details from the nodes you encounter as you walk the tree under the head node can be added as per your interest...

```
function printRNode( node ){
    // make sort of human-readable picture of the node... a bit like PHP print_r

    if( node === undefined || node === null ){
        throwError( 'node was ' + typeof node );
    }
    let s = '';

    // NB walkDOM could be made into a utility function which you could 
    // call with one or more callback functions as parameters...

    function walkDOM( headNode ){
      const stack = [ headNode ];
      const depthCountDowns = [ 1 ];
      while (stack.length > 0) {
        const node = stack.pop();
        const depth = depthCountDowns.length - 1;
        // TODO non-text, non-BR nodes could show more details (attributes, properties, etc.)
        const stringRep = node.nodeType === 3? 'TEXT: |' + node.nodeValue + '|' : 'tag: ' + node.tagName;
        s += '  '.repeat( depth ) + stringRep + '\n';
        const lastIndex = depthCountDowns.length - 1;
        depthCountDowns[ lastIndex ] = depthCountDowns[ lastIndex ] - 1;
        if( node.childNodes.length ){
            depthCountDowns.push( node.childNodes.length );
            stack.push( ... Array.from( node.childNodes ).reverse() );
        }
        while( depthCountDowns[ depthCountDowns.length - 1 ] === 0 ){
            depthCountDowns.splice( -1 );
        }
      }
    } 
    walkDOM( node );
    return s;
} 
```

# iis-7 - 经典 ASP 在 IIS7 中总是返回代码 200

> ID：603994
> 
> 赞同：2
> 
> 时间：2009-03-02T21:04:58.280
> 
> 标签：iis-7, asp-classic, trace

我在 IIS7 中启用了跟踪。我在 IIS 管理工具的 ASP 选项卡中将这些属性设置为 true：

*   appAllowClientDebug,
*   应用程序允许调试，
*   errorsToNTLog,
*   scriptErrorSentToBrowser;

为了测试它，我编写了一个小的经典 ASP 测试页面，我自愿在其中包含一个错误（错误的 activeX 名称）。

我的 asp 测试页面会一直呈现，直到到达 bug 行。页面的其余部分未呈现。我期待一个 500 错误代码，但代码始终是 200。FailedReqLogFiles 文件夹中没有错误文件。

有人知道吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-16T10:06:15.153

好的，我认为问题实际上在于*Enable Server Side Debugging*。您可能已启用它，但您应该*禁用*它。

服务器认为它应该开始调试并尝试启动调试器，然后找不到并放弃！我确信这在 IIS7 之前从未发生过。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-18T13:42:33.910

早安，

这个问题大大减慢了我们的开发速度，因为浏览器上没有显示 sql server 错误。我们的应用程序服务提供商尝试了一些设置，但无法正常工作。他们给我发了设置，我不小心一次只做了两个，我们的问题得到了解决。他们告诉我 asp 给出的返回码是 200 而不是错误码。

这对我们有用：

“发送到浏览器 = True”和“启用服务器端调试”= False”的组合有效。

我希望这对其他人有所帮助。

汤姆阿姆斯特朗

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T21:30:53.397

看看这个，看看这是否会阻止您收到 500 错误。此外，如果错误是通过 activeX 中的异常处理程序处理的，那么您可能不会在 asp 响应中看到错误。

[http://classicasp.aspfaq.com/general/why-do-i-get-a-500-internal-server-error-for-all-asp-errors.html](http://classicasp.aspfaq.com/general/why-do-i-get-a-500-internal-server-error-for-all-asp-errors.html)

200 OK 是成功 HTTP 请求的标准响应。状态码表示客户端的请求被成功接收、理解和接受。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T03:36:11.783

我们发生了同样的 IIS7 错误。它没有返回任何类型的错误。屏幕上没有错误消息，也没有 500。页面刚刚停止渲染。

这就是你所看到的吗？不幸的是，我不记得它是什么，我认为它就像是在处理错误。（如果这是你所看到的，我会继续努力记住的！）

我不认为是这样，但可能是：进入错误页面 > 编辑功能设置（隐藏在右侧面板上）并选择详细错误？该设置也是必需的，您没有提及。

# c# - Visual C#、Winforms 和 Partial Class Madness

> ID：603995
> 
> 赞同：2
> 
> 时间：2009-03-02T21:05:00.043
> 
> 标签：c#, visual-studio, winforms, partial-classes

我没有用.NET 做太多的工作，所以如果这有一个微不足道的解决方案，请原谅我。

“问题”（实际上更令人烦恼）是 VC# IDE*默认*`System.Windows.Forms.Form`打开所有具有在设计视图中继承的类的文件。唯一的例外是“*.Designer.cs”文件。

 *一般来说，这很好。但是，如果我有一个`partial class`实现一些控制处理程序代码的，这将变得相当烦人。例如，当双击源文件时，您会被带到 Winforms 设计器并显示一个空表单。完全没用。

要解决这个问题，您需要右键单击有问题的源文件，然后从上下文菜单中选择“查看代码”。

我的问题很简单：有*什么*方法可以绕过这个荒谬的？如果没有，我想知道人们如何组织他们的 UI 处理代码。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-02T21:08:28.257

是的。

在文件的上下文菜单中，选择“打开方式...”并使用“设置为默认值”按钮并选择您喜欢的编辑器（在您的情况下，可能是 CSharp 编辑器）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T21:07:51.750

我总是使用 Doubleclick，而不是右键单击和查看代码，它会转到代码页，专注于 Form_load 事件，可以将其留空并忽略。

如果您真的想修复该行为，我建议您以某种方式使您的文件不是表单！不能怪 VS 在您打开表单文件时认为您想使用表单！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-19T08:42:40.310

单击解决方案资源管理器中的文件，然后按 F-7。*********`****