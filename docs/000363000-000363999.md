# StackOverflow 问答 000363000-000363999

# perforce - 我想在 perforce 更新期间明确报告未更新的文件（因为冲突）

> ID：363006
> 
> 赞同：2
> 
> 时间：2008-12-12T15:04:13.050
> 
> 标签：perforce

当我进行更新并更新了无数文件时，我经常会错过由于冲突而未合并的文件。我唯一的方法是浏览我所有的更改列表并查看文件图标。

没有更好的方法吗？即使是基于控制台的命令也可以......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T15:52:19.613

您可以立即再次进行更新，这一次只会打印出冲突。如果您使用的是 p4v，请确保您显示了日志，因为结果应该在那里滚动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T23:56:07.470

从命令行，

```
p4 resolve -n 
```

将列出具有未解决冲突的每个文件。

在 p4v 中，您可以右键单击软件仓库或工作区的根目录并选择“解决”以获取一个可以交互解决冲突的窗口。

# c++ - 如何重新定位/调整屏幕上的资源？

> ID：363007
> 
> 赞同：1
> 
> 时间：2008-12-12T15:04:34.063
> 
> 标签：c++, windows-mobile, embedded-resource

我想将本机相机应用程序嵌入到自定义表单中。我要嵌入相机的 RECT r 属性如下：

r.top = 26; r.bottom = 220; r.left = 0; r.right = 320;

这是运行本机相机应用程序的方法：

> HRESULT CPhotoCapture::CameraCapture(HWND hwndOwner, LPTSTR pszFilename) { HRESULT hResult; SHCAMERACAPTURE shcc;

```
//Set the SHCAMERACAPTURE structure
ZeroMemory(&shcc, sizeof(shcc));
shcc.cbSize = sizeof(shcc);
shcc.hwndOwner = hwndOwner;
shcc.pszInitialDir = _T("\\My Documents");
shcc.pszDefaultFileName = _T("test.jpg");
shcc.pszTitle = _T("Camera Demo");
shcc.StillQuality = CAMERACAPTURE_STILLQUALITY_HIGH;
shcc.VideoTypes = CAMERACAPTURE_VIDEOTYPE_MESSAGING;
shcc.nResolutionWidth   = 1024;
shcc.nResolutionHeight  = 768;
shcc.nVideoTimeLimit    = 15;
shcc.Mode = CAMERACAPTURE_MODE_STILL;

//display the camera capture dialog
hResult = SHCameraCapture(&shcc);

if(hResult == S_OK)
{
    //TODO:: Write to log
}

return hResult; 
```

}

上面的方法是从尺寸等于 r 的窗口调用的：

```
HRESULT hr = S_OK;
hr = m_PhotoCapture.CameraCapture(this->m_hWnd, L"test"); 
```

有谁知道如何修改上述函数（hwndOwner）在矩形r中显示嵌入资源的方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T15:15:29.063

我认为您需要在自定义表单上放置一个图片框（大小为您想要的尺寸），然后传递图片框的窗口句柄而不是表单本身的句柄。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T15:09:50.450

您不太清楚 hwndOwner 指向什么。我对这可能如何工作的**猜测*是您需要创建一个窗口，它是您的主显示窗口的子窗口，其位置与您的矩形匹配（并且是可见的），然后传递它的句柄，然后捕获 API 使用DShow 将帧抓取的输出从相机传输到句柄所代表的窗口。

# vb.net - 在 Exchange 2003 上创建大量邮箱

> ID：363012
> 
> 赞同：0
> 
> 时间：2008-12-12T15:05:29.490
> 
> 标签：vb.net, active-directory, exchange-server

我要为大约 750 多个用户创建邮箱。我应该在创建之间睡一会儿以免交换服务器超载还是没关系？我已经读到，在用户访问它或他们收到邮件之前，不会创建实际的邮箱。我在 .NET 2.0 中使用 CDOEXM 和 DirectoryServices。

```
Imports System.DirectoryServices
Imports CDOEXM

...
...

Dim mbx As IMailboxStore = user.NativeObject
mbx.CreateMailbox(store)
user.CommitChanges() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T15:08:09.953

我只是去争取它。我不希望只有 750 会在类似于现代服务器的任何东西上引起任何类型的操作问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-20T08:54:32.473

Exchage 将大部分工作推迟到用户第一次登录，因此创建邮箱应该不会是太多工作。

# c# - Linq to SQL - “此成员被多次定义”错误

> ID：363026
> 
> 赞同：5
> 
> 时间：2008-12-12T15:08:23.103
> 
> 标签：c#, .net, linq-to-sql

我有以下 linq 代码...

```
CMSDataContext dc = new CMSDataContext();

var q = from u in dc.CMSUsers 
        join d in dc.tblDistricts
          on u.DistrictCode equals d.District into orders
        select u; 
```

区显示此错误：“tblDistrict.District”和“tblDistrict.District”之间的歧义

有任何想法吗？

编辑：

事实证明，我在两个不同的 dbml 文件中有同一个表。显然，我不能这样做。我最终将不得不将一个 dbml 文件中的表与另一个 dbml 文件中的另一个表连接起来。如果有人能启发我如何做到这一点，我会将其视为答案。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T16:09:24.137

如果两个表之间有 FK 关系，LINQ-to-SQl 将自动为其创建一个属性。

例如，如果您的 Order 对象有一个 CustomerID，它是 Customers 表的 Foriegn 键，Order 将自动具有一个 Customer 属性。如果您已经拥有 Customer 属性，则会发生冲突。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-21T12:15:56.120

我有他同样的问题。解决方案是从*解决方案资源管理器中***删除** `.dbml`文件。

 *# java - 为什么使用 java.util.zip.ZipFile 打开空 ZIP 文件时出现异常？

> ID：363031
> 
> 赞同：3
> 
> 时间：2008-12-12T15:09:43.507
> 
> 标签：java, exception, zip, zipfile

我想打开一个没有 java.util.zip.ZipFile 条目的 ZIP 文件。但在构造函数上，我得到以下异常：'java.util.zip.ZipException：打开 zip 文件时出错'。如何打开空的 ZIP？

该 ZIP 文件是由 linux 下的命令行 zip 程序创建的。我只是从一个 ZIP 文件中删除了所有条目。

我需要这个作为我写的课程的测试数据。对于这种情况，该类应该只返回一个空列表，但损坏的 ZIP 文件应该返回一个错误。

有关该问题的更多解释。我有一个接口，用于从不同来源提取一些文档。其他实现从 web 服务或目录中收集它们，这个实现来自 ZIP 文件。该接口为 Iterator 提供了更多功能。所以我想决定 ZIP 文件是空的还是损坏的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-14T16:24:26.410

hack：您可以假设所有空 ZIP 都是相同的，只需对其长度/校验和进行硬编码以进行验证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T15:16:43.180

不知道为什么要这样实现，但是为什么需要成功打开一个空的Zip文件呢？无论如何，您都无法使用 java.util.zip.ZipFile 对其进行修改...

因此，您可以捕获 ZipException（对于无效格式的 zip 文件会抛出该异常），如果您捕获它，则跳过该文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-15T14:51:40.980

我现在对这个问题的解决方案是，我只是使用 ZipInputStream 而不是 ZipFile。此类适用于空 ZIP 文件。我不知道原因，为什么一个有效而另一个无效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-05T00:45:49.550

I think the reason ZipInputStream works and ZipFile does not is because of the two different ways that zip files are read. The ZipFile constructor attempts to read the ZipFile's table of contents, which is written to the end of the file. If it can't read the TOC, it throws a ZipException (with almost no helpful info contained therein), which I think is what you're seeing. ZipInputStream, however, reads the entries out of the zip file sequentially starting at the beginning of the file, so it seems more robust in this case.

This is all very poorly documented and I've run into similar problems myself using ZipFile. Both methods of reading from a zip file are valid, but you'd think the API docs would mention the implications of the random access/TOC method of reading through constructor versus reading through a ZipInputStream.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T15:19:19.510

你确定它是一个有效的 zip 文件吗？那将是我的第一个猜测。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T15:29:20.597

ZIP 文件格式有错误[检查这里的 JDK](http://java.sun.com/j2se/1.5.0/docs/api/java/util/zip/ZipFile.html#ZipFile(java.io.File))。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-14T16:14:55.710

使用`ZipOutputStream`.

# php - 管理单身人士的最佳方式是什么？

> ID：363038
> 
> 赞同：1
> 
> 时间：2008-12-12T15:11:36.047
> 
> 标签：php, design-patterns, singleton

我在搞乱不同的 PHP 日志框架。我目前正在尝试 PEAR::Log。我想我会使用它的`singleton`功能来确保只有一个类的实例。

我有一个类似守护进程的小脚本，我想添加日志记录，因为它可能是系统中要测试的最简单的脚本。这个脚本有几个功能。我可能想在函数中记录一些东西。

我的问题是如何最好地管理这个单例？

对我来说：

```
&Log::singleton($handler, $name, $ident, $conf, $maxLevel); 
```

在每个函数中似乎并不理想，特别是因为我已经在初始调用中指定了所有选项。Pear::Log 序列化此信息，但从看起来您仍然必须提供所有这些变量来获取实例。

另一种选择是将实例传递给每个函数。再次，似乎它不太理想。

我想您也可以将实例设为“全局”。

在这种情况下你怎么办？有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T16:21:58.603

更好的是，如果您的最终目标是能够盲目跟注

```
Logger::Write("Something happened"); 
```

无论您需要它，您都可以将 Michal 的解决方案更进一步

```
class Logger {
    private static $log = null;

    public static function init(Log $log) {
        self::$log = $log;
    }

    public static function Write(String $str) {
        if($log == null)
            init(Log::singleton(...));

        $this->log->Write($str);
    }
} 
```

这样，您的日志将在第一次使用时被初始化一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T15:52:12.813

我对 PEAR::Log 了解不多，但为什么不创建另一个包装/简化日志记录的单例。

```
class Logger {

    private static $log;

    private function __construct() { }

    public static function init(Log $log) {
        self::$log = $log;
    }

    public static function get() {
        return self::$log;
    }

} 
```

`Logger`使用实例初始化后，`Log`您可以通过`Logger::get`. 由于在 PHP 中可以取消引用，因此您可以这样做

```
Logger::get()->doSomething($foo, $bar); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T15:58:16.060

只需使用全局实例。在某个地方，您必须有一个所有其他文件都必须包含的文件。只是在那里实例化它。如果你有一些反对全局变量的东西，你可能不应该在 PHP 中编程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T16:25:25.787

> 另一种选择是将实例传递给每个函数。再一次，似乎不太理想。

基本上，您可以选择为每个函数、每个对象实例或在一个全局范围内传递依赖项。我发现使用对象实例范围通常可以很好地平衡灵活性。一般来说，你应该尽量限制变量的范围，所以如果有意义的话，一定要通过函数参数。

# asp.net-mvc - 删除列表项时更新模型错误

> ID：363042
> 
> 赞同：1
> 
> 时间：2008-12-12T15:12:55.683
> 
> 标签：asp.net-mvc, updatemodel

我有一个编辑页面来编辑一些信息。页面填充了一个复杂的对象。此对象的属性之一是通用列表。

如果我只是编辑信息并保存，updatemodel 可以正常工作。如果我从列表中删除（我使用 jquery 删除表单元素客户端），更新模型将失败，并显示“对象未设置为实例”。

我猜更新模型期望列表保持相同的长度或其他内容，但找不到有关此的任何信息，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T09:20:36.903

好的，在 jquery remove 例程中发现了问题（当然是程序员错误）我已经删除了所有元素，除了模型绑定器用于列表的隐藏字段:(

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T15:57:11.367

模型绑定器将尝试映射您的复杂对象属性，从以下位置检索数据：
1) 来自 RouteData 的值
2) URI 查询字符串
3) 请求表单提交
检查这些地方以查看您的属性为何为空。如果您要删除表单元素，您的财产将不会收到任何数据。[这里](http://weblogs.asp.net/scottgu/archive/2008/10/16/asp-net-mvc-beta-released.aspx)有一些信息和 Scott Hanselman 的错误[分析](http://www.hanselman.com/blog/TheWeeklySourceCode28ASPNETMVCBetaObscurityModelStateIsValidIsFalseBecauseModelBinderPullsValuesFromRouteData.aspx)。

# algorithm - 是否有提高图像分辨率的算法？

> ID：363047
> 
> 赞同：5
> 
> 时间：2008-12-12T15:14:10.567
> 
> 标签：algorithm, image, resolution, image-scaling

是否有任何算法或工具可以提高图像的分辨率 - 除了让图像中的每个单独像素变大一点的简单缩放之外？

我意识到这样的算法必须发明原始图像中并不真正存在的像素，但我认为可能有一些算法可以智能地找出要添加到图像中的像素以提高其分辨率。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T15:17:57.687

插值：[图像缩放](http://en.wikipedia.org/wiki/Image_scaling)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T15:27:22.940

对于实际算法检查[图像插值](http://www.cambridgeincolour.com/tutorials/image-interpolation.htm)。

对您的问题的简单回答是：“是的，有算法，但都不是很好。” 正如您在问题中提到的那样，限制因素是需要发明像素以将分辨率提高到超过少量。*（这*就是为什么你不能从闭路电视安全摄像机拍摄的照片中从某人眼镜的反射中读取车牌号，就像他们在 CSI：迈阿密一样。）

如果您只想创建更大的图像（用于壁挂等），那么您可以使用[Photoshop 插件，](http://www.visoracle.com/download/freedemo/imageeditor/bmre.html)使用现有信息平滑像素之间的过渡。它不能创造新的像素，但它可以摆脱那种四四方方的像素化外观。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T15:44:48.023

先前答案的附录：请注意，您的问题的答案在很大程度上取决于您所说的分辨率的确切含义-显示设备，捕获设备或查看设备（即人眼）的含义。我假设您'正在谈论光栅图像（矢量图像不存在问题。）

您*必须*接受以较高分辨率拍摄的照片比以较低分辨率拍摄的相同场景的照片包含更多的图像信息（即细节）。没有*办法*凭空添加这些信息。缩放算法基于离散光栅图像元素之间的连续性假设合成一些信息。那个“新”信息实际上并不是新的，而是从预先存在的图片信息中衍生出来的，因此不能认为它有100%的概率与原始场景匹配。更好的算法可能会产生更好的概率，但它们的结果将始终具有小于 1 的匹配概率。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-12T15:19:09.400

> 放大图像是有风险的。超过一定程度，放大图像是徒劳的；你不能凭空神奇地合成无限数量的新像素。并且插值像素永远不如真实像素。这就是为什么将 512x512 的 Lena 图像放大 500% 有点不自然。找到更高分辨率的扫描或您需要的任何图片* 比在软件中升级它更聪明。

[从杰夫阿特伍德](http://www.codinghorror.com/blog/archives/000903.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-28T19:38:28.257

提高分辨率的一种方法是进行多次曝光，将它们放大到 4 倍区域（双向 2 倍线性）并使用堆叠软件合并图像。最终图像将优于任何原件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-12T18:21:40.157

您可以尝试使用 autotrace 或 potrace 等工具对图像进行矢量化处理，并以您喜欢的任何分辨率使用它。但它的计算成本非常高，因此您最终得到的图像颜色/特征很少，如果您需要快速处理整个图像，则更少。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-01-14T05:51:05.910

在某些情况下，超分辨率算法可能会有所帮助。我不知道所涉及的所有内容（需要软件/硬件和初始图像），但如果您有兴趣，这里有一些链接：

[http://almalence.com/doc/superresolution-comparison/](http://almalence.com/doc/superresolution-comparison/) （似乎 Almalence 的 PhotoAcute 在本文中测试的产品中表现最好——30 美元或 150 美元）。它们位于：www。光敏网络

用于 SR 的马尔可夫随机场 – 免费软件包（麻省理工学院和微软项目） [http://people.csail.mit.edu/billf/project%20pages/sresCode/Markov%20Random%20Fields%20for%20Super-Resolution.html](http://people.csail.mit.edu/billf/project%20pages/sresCode/Markov%20Random%20Fields%20for%20Super-Resolution.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-12T15:19:20.180

大多数体面的图像编辑器都有平滑/插值过滤器来进行这种调整大小/重新采样，例如[IrfanView](http://www.irfanview.com/)，它为您提供了多个插值过滤器选项。请参阅[Lanczos 重采样](http://en.wikipedia.org/wiki/Lanczos_resampling)。ImageMagick 的转换程序也允许您在指定[过滤器后执行此操作](http://www.imagemagick.org/script/command-line-options.php#filter)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-12T15:27:20.117

如果您需要通过算法执行此操作，请查看 Draemon 建议的[Image Scaling](http://en.wikipedia.com/wiki/Image_Scaling)链接。您将在什么平台上进行这些插值？大多数图形库将实施多种方法，使您能够在速度与质量之间取得平衡。

如果您只需要调整一些图像的大小，我推荐[GIMP](http://www.gimp.org)。它可以通过多种方式调整图像大小，至少其中一种方式在任何情况下都能产生出色的效果。

正如其他人指出的那样，您不能指望缩放方法来发明原始图像中没有的信息。所以你不能指望它会像 CSI 中的那些时刻，他们“放大和增强”以看到原始图像中无可救药地模糊的车牌上的数字。

# linux - 对 cron 执行的命令有特殊限制吗？

> ID：363049
> 
> 赞同：7
> 
> 时间：2008-12-12T15:16:10.873
> 
> 标签：linux, unix, cron

我有一个`crontab`看起来像

```
0 0 * * * pg_dump DB_NAME > /path/to/dumps/`date +%Y%m%d`.dmp 
```

当我手动运行它时效果很好，但在`cron`运行它时却不行。挖掘日志后，我看到

```
Dec 12 00:00:01 localhost crond[17638]: (postgres) CMD (pg_dump DB_NAME > /path/to/dumps/`date +) 
```

看起来百分号有问题，但`man`页面根本不包含百分号，所以我认为它们没问题。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-12T15:22:34.107

您必须使用反斜杠转义百分号：

```
0 0 * * * pg_dump DB_NAME > /path/to/dumps/`date +\%Y\%m\%d`.dmp 
```

来自`man 5 crontab`：

> ''sixth'' 字段（该行的其余部分）指定要运行的命令。该行的整个命令部分，直到换行符或 % 字符，将由 /bin/sh 或 crontab 文件的 SHELL 变量中指定的 shell 执行。命令中的百分号 (%)，除非用反斜杠 (\) 转义，否则将更改为换行符，并且第一个 % 之后的所有数据将作为标准输入发送到命令。无法将单个命令行拆分为多行，例如 shell 的尾随“\”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T15:51:35.170

`cron`与命令行相比，还有另一个可能影响程序运行的特征问题（除了`%`Robert Gamble 描述的对“ ”符号的解释）。

这种差异在于环境。如果程序运行依赖于特殊的环境变量，那么当你从命令行运行它时，它会在你通常使用的环境下运行，如果你运行它，它可能会运行，`at`因为它会在你创建作业时捕获环境. 但`cron`没有特殊的环境设置。

因此，我习惯性地配置`cron`为通过绝对路径名运行脚本，并且该脚本执行我需要的环境设置（`$HOME/bin`例如，将我的目录添加到 PATH）。我什至有一个标准化的基础设施——一个设置环境和运行其他程序的 shell 脚本。

```
#   @(#)$Id: crontab,v 4.2 2007/09/17 02:41:00 jleffler Exp $
#   Crontab file for Home Directory for Jonathan Leffler (JL)
#-----------------------------------------------------------------------------
#Min     Hour    Day     Month   Weekday Command
#-----------------------------------------------------------------------------
0        *       *       *       *       /usr/bin/ksh /work1/jleffler/bin/Cron/hourly
1        1       *       *       *       /usr/bin/ksh /work1/jleffler/bin/Cron/daily
23       1       *       *       1-5     /usr/bin/ksh /work1/jleffler/bin/Cron/weekday
2        3       *       *       0       /usr/bin/ksh /work1/jleffler/bin/Cron/weekly
21       3       1       *       *       /usr/bin/ksh /work1/jleffler/bin/Cron/monthly 
```

中的脚本`/work1/jleffler/bin/Cron`设置环境，然后运行同名的脚本`/work1/jleffler/bin`来完成实际工作。`Cron`子目录中的名称实际上都是指向同一个脚本的链接。

# javascript - jRails 与原型

> ID：363050
> 
> 赞同：10
> 
> 时间：2008-12-12T15:16:33.883
> 
> 标签：javascript, jquery, ruby-on-rails, prototypejs

我不是想把这个问题作为一个偏好问题，我真的想知道人们在使用 jQuery 和 Rails 或 jRails 进行开发方面的经验。到目前为止，包括我自己在内的大多数 Rails 用户都在使用 Prototype。但是，我混合了很多 jQuery 插件，因为它们非常易于使用和扩展。

我现在正在考虑为一个新的 Rails 项目从 Prototype 转移到 jQuery。但是，我喜欢原型的力量。Protoype 几乎是一种基于 JS 的新语言，而我发现 jQuery 就像是一种很棒的脚本语言，有很多语法糖和链接。

无论如何，您的想法将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-12T16:54:50.957

在 Rails 中，这一切都归结为辅助方法。您是否使用任何原型辅助方法？如果是这样，那么您必须使用 jRails 切换到 jQuery。但如果不是，那真的没关系。他们都很棒。我以前用过很多原型，它很棒。但我更喜欢使用 jQuery 做事的选择器方式，所以我已经切换了。另一个不使用辅助方法的好理由是不显眼的 javascript。rails 辅助方法会创建凌乱的内联代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-12T17:52:15.300

如果您想在生成的代码和手写代码之间保持“一致”的代码库，那么如果您使用 rjs 模板，jRails 就很棒。但是，我个人看到 jRails 不知道如何真正体面地处理 ajax 表单生成器。

我最大的建议是“当你需要它”时使用 jRails，并且更习惯于手工编写 JavaScript。Prototype 和 jQuery 实际上是两个完全不同的思想流派，它们不一定兼容。起初，我是 Prototype 的大力倡导者，因为我的大量 Ruby 设计知识是可以转移的，但是我学会了以更强大的方式使用 jQuery，使用 jQuery 来增强更自然的 JavaScript。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-12T16:16:20.657

除了 rjs 文件和其他 javascript 帮助程序之外，您还使用原型吗？如果是这样，那么您将需要确定是否要在 jQuery 中重写这些。否则，您可以只使用 jRails 来处理任何 rjs 助手，您甚至不会注意到有什么不同。

我一直在使用 jRails 并且喜欢它！

# visual-studio-2005 - 生成 Visual C++ 2005 项目时生成 cmd.exe 时出错

> ID：363055
> 
> 赞同：2
> 
> 时间：2008-12-12T15:18:07.250
> 
> 标签：visual-studio-2005, build-process

我正在更改 vc++ 包含目录，新路径突然低于错误

erProject：错误 PRJ0003：生成“cmd.exe”时出错。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-12T15:21:24.530

此页面帮助我解决了问题

[http://www.interact-sw.co.uk/iangblog/2005/09/12/cmdspawnerror](http://www.interact-sw.co.uk/iangblog/2005/09/12/cmdspawnerror)

# c# - 从 .net 代码调试到 SQL Server 存储过程代码的可能性？

> ID：363061
> 
> 赞同：4
> 
> 时间：2008-12-12T15:19:13.550
> 
> 标签：c#, .net, sql-server, stored-procedures, debugging

是否有可能从.net 代码直接深入到 SQL Server 存储过程？因此，在.net 中逐步调试时，我想进入一个调用的存储过程。

我知道如何单独调试它们，但我想加入这些调试会话以获得一些时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T15:44:58.240

我一直觉得这有点棘手，但这是可能的。

首先，您必须在 IDE 中为项目/解决方案启用 T-SQL 调试，然后您必须将数据库连接设置为项目/解决方案的一部分。

实际上单步执行存储过程似乎很麻烦，但是如果您打开存储过程代码并在其中显式设置断点，它将命中断点。

# multithreading - 一个应用程序中有多少个并发线程是很多？

> ID：363079
> 
> 赞同：5
> 
> 时间：2008-12-12T15:25:36.110
> 
> 标签：multithreading

5、100、1000？

我想，“这取决于”，但取决于什么？

作为服务器守护程序/服务运行的应用程序有什么共同点？

什么是硬限制？

鉴于机器可以处理整体工作负载，我如何确定开销开始影响性能的线程数？

操作系统之间的重要区别是什么？

还应该考虑什么？

我之所以问，是因为我想在应用程序中使用线程来组织我的应用程序的子组件，这些子组件不共享数据并且旨在并行完成它们的工作。由于该应用程序还将使用线程池来并行化某些任务，我想知道我应该从什么时候开始考虑总共要运行的线程数。

我知道 n+1 规则是确定同时处理同一任务以获得性能的线程数的准则。但是，我想使用线程，就像在更大范围内使用进程一样，即组织不应相互干扰的独立任务。

在[这个相关问题](https://stackoverflow.com/questions/120636/)中，由于增加了复杂性，一些人建议尽量减少线程数。对我来说，线程似乎也可以帮助让事情变得更有条理，实际上减少了干扰。这不正确吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T15:33:19.310

我无法回答您关于“多少是多少”的问题，但我同意您不应该为每项可能的任务使用线程。

应用程序性能的**最佳**线程数量是 (n+1)，其中 n 是您的计算机/集群拥有的处理器/内核数量。

您的实际线程数量与 n+1 的差异越大，它获得的优化越少，并且您的系统资源浪费在线程计算上。

所以通常你使用 1 个线程用于 UI，1 个线程用于一些通用任务，以及 (n+1) 个线程用于一些大计算任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T15:57:55.297

实际上 Ajmastrean 有点过时了。引用他自己的[链接](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.aspx)

> 线程池的默认大小为每个可用处理器 250 个工作线程和 1000 个 I/O 完成线程。可以使用 SetMaxThreads 方法更改线程池中的线程数。

但总的来说，我认为 25 确实是收益递减规律（以及程序员跟踪正在发生的事情的能力）开始生效的地方。尽管 Max 是对的，但只要所有线程都在执行非阻塞计算 n+1 是最佳数字，在现实世界中，我执行的大多数线程任务往往是在具有某种 IO 的东西上完成的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T16:17:48.830

还取决于您的架构。例如，在 NVIDIA GPGPU lib CUDA 中，您可以同时安装 8 线程多处理器 512 线程。您可能会问为什么要为每个标量处理器分配 64 个线程？答案很简单：如果计算不是计算绑定而是内存 IO 绑定，您可以通过执行其他线程来隐藏内存延迟。类似的适用于普通 CPU。我记得对 make "-j" 的并行选项的建议是使用大约 1.5 倍的内核数。许多编译任务都是沉重的 IO 负担，如果任务必须等待硬盘、内存……无论如何，CPU 可以在不同的线程上工作。

接下来您必须考虑，任务/线程切换的成本是多少。例如，它是免费的，而 CPU 必须为上下文切换执行一些工作。因此，一般而言，您必须估计两次任务切换的惩罚是否比线程阻塞的时间长（这在很大程度上取决于您的应用程序）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T15:51:22.627

Microsoft 的[ThreadPool](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.aspx)类将每个处理器限制为 25 个线程。该限制基于线程之间的[上下文切换](http://www.dotnetconsult.co.uk/weblog2/PermaLink,guid,29363d7e-79c1-432b-8ec1-5583ec5e9aa3.aspx)和每个线程[消耗的内存。](http://blogs.msdn.com/oldnewthing/archive/2005/07/29/444912.aspx)因此，如果您在 Windows 平台上，这是一个很好的指南。

# mysql - MYSQL - 我将如何导出仅指定某些字段的表？

> ID：363084
> 
> 赞同：12
> 
> 时间：2008-12-12T15:27:44.250
> 
> 标签：mysql, database, mysqldump

如何导出仅指定某些字段的表？

我正在使用 mysql 5.0 - 使用 sql 命令或 mysqldump。

我的表是 X，我要导出的字段是 A,B,C

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-12T15:31:37.020

```
SELECT A,B,C
FROM X
INTO OUTFILE 'file name'; 
```

您需要 FILE 权限才能执行此操作，并且它不会覆盖文件。

`INTO OUTFILE`它也有很多选项，例如`FIELDS ENCLOSED BY`,`FIELDS ESCAPED BY`等...您可能想[在手册中查找](http://dev.mysql.com/doc/refman/5.0/en/select.html)。

要生成 CSV 文件，您可以执行以下操作：

```
SELECT A,B,C
INTO OUTFILE '/tmp/result.txt'
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
LINES TERMINATED BY '\n'
FROM X; 
```

要从文件中重新加载数据，请使用该[`LOAD DATA INFILE`](http://dev.mysql.com/doc/refman/5.0/en/load-data.html)命令与您用于转储它的选项相同。对于上面的 CSV 格式，那将是

```
LOAD DATA INFILE '/tmp/result.txt'
INTO TABLE X
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
LINES TERMINATED BY '\n'; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-10-20T06:44:13.733

If you are using phpMyAdmin,

Run the query

> SELECT A,B,C FROM X

and there is an export option in the bottom of the result.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-18T20:49:10.883

`OUTFILE`不会为您生成 SQL 转储，也`mysqldump`不能对列的子集进行操作。但是您可以`create table temp_weeeee select ....`导出并删除它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-16T09:10:21.173

外壳命令

```
echo 'select field from db.table;' | mysql -u user -p password > output.txt 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T15:35:06.170

尝试：

```
SELECT col1, col2
  INTO OUTFILE '/filepath/export.txt'
    FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
    LINES TERMINATED BY '\n'
FROM table; 
```

# mfc - 带有 WS_POPUP 对话框的自定义工具提示

> ID：363086
> 
> 赞同：1
> 
> 时间：2008-12-12T15:28:31.863
> 
> 标签：mfc, tooltip, cdialog

我想创建自定义工具提示，我可以在其中放置任何类型的控件。我从 CDialog 派生并使用了这些`WS_POPUP | WS_BORDER`样式。我还在`CS_DROPSHADOW`OnInitDialog 中添加样式以获取工具提示阴影。

然后我自己管理`WM_MOUSEHOVER`和`WM_MOUSELEAVE`事件来显示/隐藏工具提示。

我使用`SetWindowPos`和`SWP_NOACTIVATE`来显示工具提示，以防止父级变为非活动状态以及新对话框变为活动状态。但无论如何，当我使用`CDialog::Create`方法创建对话框时......主窗口变得不活动......什么会产生非常糟糕的效果。

所以我的问题是如何创建一个具有 WS_POPUP 样式的 CDialog 而不会在新对话框出现时我的主窗口（或对话框的父窗口）变为非活动状态？？？

感谢您的帮助！

编辑：我不使用 WS_VISIBLE 样式来创建对话框......这是资源：

```
 IDD_LABEL_TOOLTIP_DLG DIALOGEX 0, 0, 100, 9
    STYLE DS_SETFONT | WS_POPUP | WS_BORDER
    FONT 8, "Tahoma", 0, 0, 0x0
    BEGIN
       LTEXT           "##################",IDC_TOOLTIP_LBL_TEXT,0,0,99,9
   END 
```

显示工具提示的代码是这样的：

```
if(!pTooltipDlg)
{
    pTooltipDlg = new MyCustomTooltipDlg();
    pTooltipDlg->Create( MyCustomTooltipDlg::IDD, this);
}
pTooltipDlg->ShowWindow(SW_SHOWNOACTIVATE); 
```

第一次（即在调用创建时）主窗口失去焦点......其余的这种丑陋的效果没有发生......所以我确定是因为创建。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T15:35:27.963

创建窗口时，不要在其上设置 WS_VISIBLE 标志。然后您可以使用带有 SW_SHOWNA 或 SW_SHOWNOACTIVATE 的 ShowWindow 来使对话框可见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T15:37:29.783

你`CDialog::Create()`用`WS_VISIBLE`set打电话吗？可能即使只是打电话`Create()`也足以吸引父母的注意力。`WM_SETFOCUS`在您的工具提示类上覆盖并且*不*调用基类以使焦点无法更改窗口也可能值得。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T16:28:10.680

首先，考虑使用 CWnd 而不是 CDialog。这为您提供了更精细的控制。除了对话框模板之外，您并没有真正使用 CDialog 的任何功能；动态创建控件并不难。

您可能还想在消息处理程序中考虑处理 OnShowWindow 并确保将任何显示命令更改为 SW_SHOWNA，如 Mark Ransom 的评论中所示。

此外，作为工具提示，它可能应该有一个 NULL 父窗口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T22:20:52.103

行。我终于明白了！我只需要在 OnInitDialog 方法中返回 FALSE 以避免激活对话框。

感谢大家！

# windows-mobile - 如何判断 Windows 移动设备是否使用 VB.Net 连接到外部电源？

> ID：363094
> 
> 赞同：3
> 
> 时间：2008-12-12T15:35:02.083
> 
> 标签：windows-mobile

当设备使用电池电源或外部电源时，Windows Mobile 设备具有不同的挂起行为。

在我使用 VB.net 编写的应用程序中，我需要能够确定设备是否连接了外部电源。

有没有一种方法可以从 Compact 框架中获得这种状态？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T15:54:36.210

如果您仅使用 WIndowsMo​​bile 5.0 及更高版本，则需要查看[State 和 Notification Broker](http://www.developer.com/ws/pc/article.php/3547381)，特别是[Status namespace](http://msdn.microsoft.com/en-us/library/microsoft.windowsmobile.status.aspx)。

要获得更广泛的支持，您可以使用 NOTIFICATION_EVENT_AC_APPLIED 或 NOTIFICATION_EVENT_AC_REMOVED 事件代码检测调用[CeRunAppAtEvent](http://msdn.microsoft.com/en-us/library/aa932775.aspx)（这可以设置命名事件而不仅仅是运行应用程序）的状态*转换*（到交流电源或从交流电源转换） 。这就是[智能设备框架](http://www.smartdeviceframework.com)中的[DeviceManagement 类](http://opennetcf.com/library/sdf/html/2b12c039-26e1-14e2-afdd-36f55aa07c5b.htm)所做的。

您可以通过调用[GetSystemPowerStatusEx2](http://msdn.microsoft.com/en-us/library/aa453173.aspx)来检测当前状态（而不是转换） 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T15:53:32.140

```
if (SystemState.PowerBatteryState & BatteryState.Charging) ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-27T09:03:02.887

首先，通过将其复制到您的代码（模块或类）中来实现所有这些：[https ://msdn.microsoft.com/en-us/library/aa457088.aspx](https://msdn.microsoft.com/en-us/library/aa457088.aspx)

然后：

```
Public Function isOnCharge() As Boolean
  Dim status As New SYSTEM_POWER_STATUS_EX2
  GetSystemPowerStatusEx2(status, Convert.ToUInt32(Marshal.SizeOf(status)), True)    

  If status.BatteryCurrent < 10000 Then
       return true 'plugged in
  else return false 'Unplugged
  End If
End Function 
```

我这样做是因为带有 SystemState.PowerBatteryState 和 BatteryState.Charging 的样本不起作用，所以我设法用另一种方法让它工作。

如果我的设备被插上，status.batteryCurrent 小于 10000，但如果它被拔掉，它的值超过 4000000。如果你想得到更精确的值，你可以对你的设备做一些测试。干杯！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-19T05:01:07.867

这可能超出了您的要求，但我在 Windows Mobile Powermanagement APIS 上写了一些东西。它使用 Chris 刚刚引用的相同 API，但面向 .Net（抱歉，它是在 C# 中，而不是 VB.Net 中）。

[http://www.codeproject.com/KB/mobile/WiMoPower1.aspx](http://www.codeproject.com/KB/mobile/WiMoPower1.aspx)

# html - 如何减少回发时 IE 中的闪烁？

> ID：363096
> 
> 赞同：5
> 
> 时间：2008-12-12T15:35:23.127
> 
> 标签：html, internet-explorer, internet-explorer-8

当页面回发时，IE 会导致非常不吸引人的闪烁或闪烁。如果不使用 UpdatePanel，我该如何减少或删除它？

大多数解决方案建议使用这样的页面转换：

```
<meta content="BlendTrans(Duration=0.1)" http-equiv="Page-Exit" /> 
```

我们已经成功使用它几年了，但它在 IE8 Beta 2 中被破坏了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T15:46:22.247

我想我已经找到了解决方案。它适用于 IE6、7 和 8b2。

```
<meta http-equiv="Page-Exit" content="Alpha(opacity=100)" /> 
```

这将停止闪烁。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-12T15:57:57.030

我不确定这是否是同一个问题，但我一直使用这个解决方案，它可以跨浏览器工作：

```
<!-- Fixes the "Flash of Unstyled Content" problem (info here: http://www.bluerobot.com/web/css/fouc.asp) -->
<script type="text/javascript"></script> 
```

# c# - 我可以避免 FillPolygon 与 DrawPolygon 的不良/不同渲染吗？

> ID：363099
> 
> 赞同：2
> 
> 时间：2008-12-12T15:36:56.697
> 
> 标签：c#, graphics

我正在使用具有半透明颜色的[FillPolygon来绘制三角形（箭头指针）。](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.fillpolygon.aspx)我注意到 FillPolygon 用 isocel 三角形给出了尴尬的结果。[其中一侧与DrawPolygon](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.drawpolygon.aspx)的一侧重叠，而另外两个则不是。我本来期望没有或全部，但不是介于两者之间。

这是一个示例：DrawPolygon 使用半透明红色，而 FillPolygon 使用半透明绿色。你可以看到一侧是棕色的，另外两侧是红色的。

[替代文字 http://www.slimcode.com/downloads/arrow.png](http://www.slimcode.com/downloads/arrow.png)

这个例子的坐标是：{X=36,Y=201}, {X=42,Y=207}, {X=30,Y=207}。

使用不透明颜色可以解决所有问题，因为我可以同时调用 DrawPolygon 和 FillPolygon，但我需要使用半透明颜色。如果可以有所作为，我正在绘制图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T16:47:40.360

你想使用位图并做这样的事情。请注意，这不是可运行的代码。

```
 Dim image As New Bitmap(<my_Xsize>, <my_Ysize>)
    Dim gr As Graphics = Graphics.FromImage(image)
    <Draw your FillPolygon>
    <Erase the leftside of the polygon>
    <Draw your Polygon>

     gr.DrawImage(image, <myXcoor>, <myYcoor>) 
```

通过使用位图，您可以调整到像素级别以获得您想要的确切内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T16:54:13.140

技巧：在中间缓冲区中将整个箭头绘制为不透明的，然后使用适当的透明度将整个缓冲区绘制到图像上。

# wpf - 在 WPF 中，如何确定控件所在的网格中的列/行？

> ID：363100
> 
> 赞同：6
> 
> 时间：2008-12-12T15:37:13.810
> 
> 标签：wpf, grid

我正在动态构建一个网格并将按钮放在其中一列中。当我单击一个按钮时，我想知道它在我的网格的哪一行。我怎样才能找到它？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-12T17:46:32.053

在您说的按钮的 Click 事件处理程序中：

```
int row;
Button btn = sender as Button;
if (btn != null)
{
    row = Grid.GetRow(btn); // And you have the row number...
}
else
{
    // A nasty error occurred...
} 
```

# outlook - 在 Outlook 2003 中清除类别

> ID：363105
> 
> 赞同：1
> 
> 时间：2008-12-12T15:39:50.060
> 
> 标签：outlook

Outlook 2007 会自动从传入电子邮件中去除类别。

Outlook 2003 不这样做，强制收件人使用发件人类别。

有没有办法：强制 Outlook 2003 删除传入电子邮件中的类别（不能通过规则和警报执行）。或 强制 Outlook 2007 和 Outlook 2003 在发送前删除类别？

谢谢，

杰夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T15:53:44.370

尝试设置规则来运行脚本：

```
Sub RemoveCategories(MyMail As MailItem)
  Dim strID As String
  Dim objMail As Outlook.MailItem

  strID = MyMail.EntryID
  Set objMail = Application.Session.GetItemFromID(strID)
  objMail.Categories = ""
  objMail.Save

  Set objMail = Nothing
End Sub 
```

这是基于[这篇文章](http://www.outlookcode.com/article.aspx?id=62)。

# barcode - 有人知道免费条形码阅读器算法的源代码吗？

> ID：363108
> 
> 赞同：4
> 
> 时间：2008-12-12T15:41:09.217
> 
> 标签：barcode

有谁知道免费条形码阅读器算法的源代码，最好是基于 C/C++/C# 的语言？处理条形码的位图图片的东西很好......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T15:43:52.173

你看过[ZXing](http://code.google.com/p/zxing/)吗？

# vim - 在 Vim 中搜索选择

> ID：363111
> 
> 赞同：115
> 
> 时间：2008-12-12T15:43:10.287
> 
> 标签：vim, viemu, string-search

在编写 C++ 时，我使用 Visual Studio 的 Vim 和 Vim 插件。通常，我发现自己想在函数中搜索字符串，例如每次调用`object->public_member.memberfunc()`.

我知道 Vim 提供了一种方便的方法来搜索单个单词，通过按`*`and `#`，它还可以使用无处不在的斜杠`/`命令搜索键入的字符串。当尝试搜索像上面这样的较长字符串的所有实例时，重新键入 after 需要一段时间`/`。

有没有办法搜索选择？比如用 高亮`v`，然后用 复制`y`，有没有办法在后面粘贴`/`？有没有更简单的捷径？

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2008-12-12T15:45:42.733

检查这个 Vim 提示：[搜索视觉选择的文本](http://vim.wikia.com/wiki/Search_for_visually_selected_text)

或者您可以简单地使用**y**拉出选定的文本并进入搜索模式**/ ，然后您可以使用****Ctrl+R 0**粘贴最后拉出的文本

 *** * *

## 回答 #2

> 赞同：97
> 
> 时间：2012-05-04T16:11:43.440

# 回答

1.  抽出您要搜索的文本
2.  `q``/``p`
3.  `Enter`

**解释**

`q/``/`除了您处于命令模式之外，它的工作方式与原版搜索类似，因此`p`实际上是“粘贴”而不是输入字符`p`。因此，上面将复制您正在搜索的文本并将其粘贴到搜索中。

有关更多详细信息，请键入`:help q/`

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2008-12-16T01:11:20.073

使用**q** **/**而不仅仅是**/**。（与**q** **:**相同）。现在您可以通过命令和搜索历史进行 VIM 编辑！（有时尝试 Ctrl-N 和 Ctrl-P）。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-02-07T09:25:22.317

我刚刚了解到（通过优秀的书*Practical Vim*）有一个插件可以做到这一点。您可以[在 GitHub 上找到该插件](https://github.com/bronson/vim-visual-star-search)。

`*`该插件可让您使用和搜索视觉选择`#`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-13T10:32:45.183

您实际上可以直观地选择文本，然后按 * 和 # 搜索下一个匹配项......它的工作原理相同，唯一需要注意的是：

> 选择中的空白匹配任何空白，在搜索时（搜索“hello world”也会在一行的末尾找到“hello”，在下一行的开头找到“world”）。

[http://vim.wikia.com/wiki/Search_for_visually_selected_text](http://vim.wikia.com/wiki/Search_for_visually_selected_text)

# orm - 断开连接的记录集

> ID：363118
> 
> 赞同：0
> 
> 时间：2008-12-12T15:44:45.167
> 
> 标签：orm, ado, recordset, disconnected-session

我认识的人想在应用程序中使用[非连接记录集。](http://www.4guysfromrolla.com/webtech/080101-1.shtml)对我来说，如果我有一个 ORM 工具，就真的不需要触摸断开连接的记录集。我对 ORM 的理解方式是，ORM 不会在不必要的长时间内拥抱连接，从而解决了对断开连接的记录集的需求。是否存在您仍想使用断开连接的记录集的实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T11:50:16.840

伪造的 ADO 记录集可以作为数据容器对象的不错选择，作为 VBA 类型（结构）、集合、字典等的替代品，即具有内置支持过滤、排序、搜索的强数据类型可空字段** , 输出到格式化的文本/xml/数组, 分页, 克隆等。一个虚构的 ADO 记录集根据定义断开连接。

也许这不是您的想法，但它是您问题的有效答案，即即使您有一个 ORM，您何时仍希望使用断开连接的记录集的示例。

** 类似地，ADO Parameter 对象是 Variant 类型的常用替代方案，因为与 VB 内在类型不同，它们可以是强数据类型*和*可为空的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T16:21:24.937

我会考虑在小型“组装并忘记”应用程序中使用记录集，或者当您有简单的报告需求（如只读网格视图）时。

这包括任何感觉你能做的最快的事情的应用程序，你看不到它以后会改变的原因。

但是，如果您要使用业务逻辑等构建稍微高级、可维护、健壮的应用程序，请不要使用记录集。

但可以肯定的是，它仍然有用..

# gwt - 旧应用程序中具有多个主机页面的 GWT

> ID：363136
> 
> 赞同：9
> 
> 时间：2008-12-12T15:48:29.153
> 
> 标签：gwt

**我正在考虑使用 GWT 作为现有**Web 应用程序的前端。

我不能证明一次完全重写为 100% GWT 是合理的。我很可能会逐渐将部分系统迁移到 GWT。但是为了保持一致性，我想从第一天起就使用 GWT TabPanel、MenuBar 等作为全局界面元素。

作为一个实验，看看如何合并系统的“遗留”部分，我做了以下事情。

应用程序的主页模板现在在每个页面上加载一个小的“包装器”GWT 模块。此 GWT 模块在动态生成的主机页面中查找选择的 DIV。如果找到了 DIV，则将合适的小部件插入适当的位置，即 menuBar、tabPanel。

包含的小部件的许多配置也可以作为 JSON 结构插入到主机页面中。例如，我实现了一个以这种方式动态设置 TabPanel 的适配器。我还添加了一些非常简单的小部件来加载远程 HTML 等。

作为原型，这一切似乎都可以**完美运行**并且加载速度很快。然而，GWT 应用程序似乎真的被设计为从单个主机页面运行，而不是数百个动态生成的页面。

任何人都可以强调上述方法可能遇到的任何问题，特别是随着 GWT 模块大小的增加？我的目标是有意保持遗留包装器模块的精简。其他功能将在单独的模块中实现。

其他人是如何逐渐将 GWT 集成到他们的前端的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-13T00:49:24.600

GWT 的设计使用方式之一就是您使用它的方式。我们已经在我们的许多应用程序中做到了这一点——其中有一个 GWT 模块具有多个“部分”，这些“部分”基于给定的 id 是否存在于页面上而被加载。所以我认为你不会有任何问题。即使对于新的 Web 应用程序，我们也经常使用这种方法，我们只需要页面上的一些“小部件”，而不是在 GWT 中编码整个应用程序。

它不会有很大的不同，但我建议的一件事是不要将 GWT javascript 代码放入您的主模板中，而只是将其放在需要它的页面上。确实，如果您不运行 HTTPS，它基本上会被永久缓存，但如果该页面上实际上不需要它，让人们加载模块似乎是错误的。这当然取决于人们如何使用您的网站，如果他们无论如何都可能下载它，那么它不会有任何区别。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T15:17:05.370

你做对了。避免避免通过将 GWT 拆分为多个单独的应用程序来尝试“最小化”GWT 占用空间的诱惑。

GWT 性能的关键是尽可能少的下载并确保它们被缓存。加载一次 250k 的捆绑包比加载两个 200k 的捆绑包要好得多，而且因为压缩会随着文件的增大而变得更好，随着事情的增长，您确实开始获得好处。

在说服自己这一点时，y-slow 和 firebug 真的很有帮助。

您可以在此处的示例章节中查看一个性能技巧：http: [//www.infoq.com/articles/progwt](http://www.infoq.com/articles/progwt) 它显示了一个迷你架构，围绕将 GWT 小部件加载到任意数量的插槽并在 JavaScript 中预填充数据变量。这允许您的 GWT 小部件加载，而不需要第二个 HTTP GET 来获取它们使用的数据。在实践中，我发现这是一个很好的性能提升。

# sql - 使用 SQuirrel 从 Excel 导入 MySQL 数据库

> ID：363138
> 
> 赞同：1
> 
> 时间：2008-12-12T15:48:56.983
> 
> 标签：sql, excel, import, squirrel-sql

我有一个 Excel 电子表格，里面有几千个条目。我想将表导入 MySQL 4 数据库（这就是我得到的）。我正在使用 SQuirrel 对远程托管的数据库进行 GUI 访问。

有没有办法将电子表格中的列（我可以根据数据库表中的列名命名）加载到数据库中，而无需从该表中复制生成的 CSV 文件的内容？也就是说，我可以在本地文件上运行 LOAD 命令，指示它将内容加载到远程数据库中吗？这样做可能会对性能产生什么影响？

请注意，表中有一个自动生成的字段用于将 id 分配给新值，我想确保我不会覆盖该 id，因为它是表上的主键（以及其他复合键）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T16:28:29.353

如果您在电子表格中只有几千个条目，那么您不应该遇到性能问题（当然，除非每一行都非常大）。

您可能对某些 Excel 数据（例如货币）有问题，最好尝试一下，看看会发生什么。

重新阅读您的问题，您必须将 Excel 导出到本地存储的文本文件中。但是将本地文件加载到远程 MySQL 数据库中应该没有任何问题。不确定您是否可以使用 Squirrel 执行此操作，您需要访问 MySQL 命令行才能运行 LOAD 命令。

如果您有购买预算，最好的方法是使用 Navicat？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T17:18:53.887

我制作了[这个工具，您可以在其中粘贴 Excel 文件的内容并生成创建表，并插入](http://utilitymill.com/utility/csv_to_create_table)您可以运行的语句。（我假设 squirrel 可以让你运行 SQL 脚本？）

如果您尝试一下，请告诉我它是否适合您。

# xul - 使用 XULRunner 开始 XUL 和 XPCOM 开发？

> ID：363151
> 
> 赞同：9
> 
> 时间：2008-12-12T15:53:23.543
> 
> 标签：xul, xpcom, xulrunner

我正计划为专有系统设计一个应用程序 XUL 和 XPCOM。所以我决定使用 C/C++，但是作为一个初学者，我该如何开始这个领域的开发，我找不到一个好的指南来开始。如果你能提供一些链接和书籍会很好。我也想知道如何防止用户在视图部分专门修改代码，因为逻辑可以在 XPCOM 中完成。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-13T05:54:13.067

[XUL explorer](https://developer.mozilla.org/en/XUL_Explorer)是一个让您拖放 XUL 的工具。它非常适合模拟界面或开始了解您可以使用的各种元素。

[xulrunner](https://developer.mozilla.org/en/XULRunner)是 Mozilla 的二进制文件，允许您运行 XUL/XPCOM/javascript 应用程序。

[Mozilla 开发者中心](https://developer.mozilla.org/En)是您的朋友。

如果您使用 IRC，请查看 irc.mozilla.org 上的 #xulrunner。他们对初学者的一些问题相当宽容。

我不认为允许用户查看（或可能修改）实际的 XUL 界面是不可能的。有一些尝试以某种方式保护 JavaScript 的路径（一些表面级别，如模糊、缩小，但还有一些可能的安全加载方法）。XPCOM 可以用 C++ 或 JavaScript 编写，仅举几例，如果你将更多代码放在 XPCOM 中，我认为它应该更安全。

了解您可以在 XUL 中做什么的一个有趣的开始是查看[XUL 周期表](http://www.hevanet.com/acorbin/xul/top.xul)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T06:25:55.420

阻止用户修改您的代码是徒劳的，因为他们总是能够这样做。

你当然可以发布一个修改过的 xulrunner（也包含一些必需的 XPCOM），它只加载由某个密钥签名的 jar，但他们可以通过修改内存中的二进制文件或图像来轻松解决这个问题。

所以不要试图阻止人们修改你的代码——你不能——除非你在一个受信任的平台上，比如游戏机——即使这样也不能保证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-19T17:55:03.373

[这](https://developer.mozilla.org/En/Creating_XPCOM_Components)帮助我创建了我的第一个 XPCOM。

# objective-c - 如何更改 Cocoa 中的主菜单？

> ID：363156
> 
> 赞同：4
> 
> 时间：2008-12-12T15:54:35.867
> 
> 标签：objective-c, macos, cocoa, nsmenu

我有一个具有两种类型窗口的可可应用程序，每种类型的窗口都需要显示不同的主菜单。

在我的 MainMenu.xib 中，我有默认的 MainMenu。在 Window1.xib 中有 Window1，在 Window2.xib 中有 Window2，它是 MainMenu。

当我打开第一个窗口时，我有默认菜单，当我打开 Window2 时，我得到它的菜单。

但是，当我切换回 Window1 时，我仍然看到 Window2 的菜单。如何使显示的菜单跟随关键窗口？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-12T18:27:09.350

通常，您不应该每次都更换整个主菜单。简单地禁用任何不适用于当前窗口的菜单项更符合人机界面指南。如果你真的应该在菜单栏中有一组完全不同的菜单，也许你应该把应用程序的那部分拆分成一个单独的应用程序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-12T16:13:09.137

NSApplication 有一个方法，`- (void)setMainMenu:(NSMenu *)aMenu`. 您可以通过实现`- (void)windowDidBecomeKey:(NSNotification *)notification`.

请记住，仅更改子菜单而不是更换整个主菜单可能更容易，因为您不必维护应用程序、帮助和其他不会在两个窗口之间更改的菜单的两个不同副本.

# .net - 什么是最有价值的 .Net Compact Framework 提示、技巧和避免陷阱？

> ID：363158
> 
> 赞同：65
> 
> 时间：2008-12-12T15:54:46.770
> 
> 标签：.net, windows-mobile, compact-framework

我们在 .Net Compact Framework 和 Windows Mobile 中广泛工作。我已经看到很多关于 ASP.Net 应用程序或其他基于 .Net 的桌面应用程序开发细节的问题，但没有特定于 CF。

是否还有其他移动开发人员可以分享一些在 Compact Framework 中开发时开始做、停止做和避免做的事情？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2008-12-12T16:08:38.910

当然：

*   尽可能使用物理设备（而不是模拟器）
*   使用多个设备进行测试（不同供应商、不同型号）
*   集中测试睡眠/唤醒行为
*   使用 MSTEST 单元测试时，切勿使用私有访问器
*   避免 ActiveSync 像瘟疫一样 - 使用 CoreCon 直接调试
*   熟悉 RPM 并尽早开始使用它
*   尽可能重用对象
*   避免在表单的 ctor 中做大量工作 - 为延迟加载或在后台线程中卸载它
*   尽可能按需加载表单（不是一次全部加载）
*   缓存常用表单，按需创建不常用表单
*   保持低图像分辨率
*   如果一个类公开 Dispose*使用它*。总是。
*   没有应用程序太小而无法从 MVC/MVP 模式中受益
*   不要为 CF 使用 Microsoft CAB/SCSF 端口（移植它的人显然从未真正使用过资源有限的设备）
*   如果您要进行任何远程数据/服务活动，请熟悉“偶尔连接”的概念
*   停靠和锚定是你的朋友和敌人 - 测试运行时屏幕旋转和多种分辨率（即使你认为你不会针对它们，因为你的想法可能是错误的）
*   看看，但不要在设备部署包项目类型上大量投资。它有可能会咬你的主要限制。批处理文件运行得非常好或自定义 MSBUILD 任务调用 CabWiz
*   复习您的 C++ 和 P/Invoke 技能。你**会**需要它们。如果没有 P/Invoking 某些东西，几乎不可能编写一个有用的 CF 应用程序。
*   编码到目标的最低公分母。
*   部分类是您的朋友，尤其是在目标类型（PPC、电话、非移动 CE）之间划分逻辑时。
*   避免从持久存储运行应用程序，尤其是对于 CE 和 pre-WInMo 5。复制到 RAM 并从那里运行以防止按需分页杀死您，尤其是在睡眠/唤醒周期之后。
*   应用程序不应该关心睡眠/唤醒转换，但那是纯粹的理论。睡眠唤醒**会*改变您的应用行为，所以再次测试、测试、测试。
*   我提到过测试吗？尤其是在您可以使用的每台设备上？从 eBay 上为您的测试实验室购买便宜的硬件。拥有更多设备比拥有最新设备更重要，除非您打算使用较新设备的特定功能。
*   如果您打算以编程方式使用蓝牙，请寻求上帝的干预。熟悉 Widcomm 和 Microsoft 堆栈并了解它们是不同的。
*   观看有关 Compact Framework 中内存管理的 MSDN 网络广播。再看一遍你第一次错过的东西。
*   注意睡眠/唤醒使内部句柄无效并导致访问冲突。这更深奥，但肯定会发生。例如，如果您在存储卡上运行应用程序，则整个应用程序不会加载到 RAM 中。使用中的部分被按需调入执行。这一切都很好。现在，如果您关闭设备电源，驱动程序将全部关闭。当您重新启动电源时，许多设备只需重新安装存储设备即可。当您的应用程序需要在更多程序中请求页面时，它不再是它原来的位置并且它死了。安装存储上的数据库可能会发生类似的行为。如果您有数据库的打开句柄，则在睡眠/唤醒周期后，连接句柄可能不再有效。
*   安装[Platform Builder 的评估版](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=7e286847-6e06-4a0c-8cac-ca7d4c09cb56)。很多东西的源代码都在那里（比如网络 UI、许多驱动程序等），当您的 P/Invoke 代码没有按照您的预期执行时，您至少可以找到一个地方“为什么”。

**2010 年 5 月 25 日添加**

*   [不要期望 WinMo 下的电源管理 API 能够](http://blog.opennetcf.com/ctacke/2010/05/18/WhyWindowsMobileSucksACaseStudy.aspx)跨设备一致或正确（甚至完全不）工作。事实上，即使使用相同的硬件，它也可能会从操作系统构建更改为操作系统构建。

**2010 年 7 月 27 日添加**

*   如果您追求美观的 UI，请准备好进行大量自定义或手动绘图。
*   如果您正在进行自定义或手动绘图并且需要使用透明度，请准备好迎接一大堆[挫折](http://blog.opennetcf.com/ctacke/2009/10/26/ProjectResistanceTransparencyInTheCompactFrameworkSucks.aspx)，并且不得不编写[古怪的代码](http://blog.opennetcf.com/ctacke/2010/07/21/GettingAPixelsTransparencyInTheCompactFramework.aspx)或直接调用[本机代码](http://msdn.microsoft.com/en-us/library/aa452250.aspx)来[解决](http://blog.opennetcf.com/ctacke/2010/07/23/KeepingABitmapsTransparencyWhenCopying.aspx) CF 中的[缺点。](http://blog.opennetcf.com/ctacke/2009/10/28/ProjectResistanceDay4GraphicFixesAndMoreGesturing.aspx)

**2011 年 11 月 22 日添加**

*   不要仅仅因为名称空间或类存在于 BCL 中就认为它实际上是以任何有用的方式实现的。 [证书当然不是](http://blog.opennetcf.com/ctacke/2011/11/22/X509CertificatesCompactFrameworkWTF.aspx)。

我只是将它们添加到列表中，因为它们发生在我身上......

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-17T08:30:51.060

[OpenNETCF](http://www.opennetcf.com/)是一个很好的资源。

当使用 .NET Compact Framework 进行开发时，他们的[Smart Device Framework](http://www.opennetcf.com/Products/SmartDeviceFramework/tabid/65/Default.aspx)是必不可少的，因为缺少许多完整的框架功能[我想有人曾经说过 .NET Compact Framework 是 NotImplementedException 的包装器！]

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-12T16:01:41.047

*这不仅仅*针对Compact Framework 设备，但是由于在移动平台上开发的资源限制，在它们上进行开发时它会更加丑陋。

* * *

最近，我在管理内存泄漏的线程中看到了一篇很棒的帖子，它帮助我识别了在我们的一个移动应用程序中[设置 DataGrid.DataSource 时我不知道的漏洞。](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=92260)

绑定 DataGrid 时，您不应该*直接*使用以下内容：

```
dgDataGrid.DataSource = dsDataSet; 
```

因为这每次都会创建一个新的 CurrencyManager ，但没有正确处理。相反，您希望首先将 DataGrid 绑定到 BindingSource 以避免资源泄漏。

```
bsData.DataSource = dsDataSet;

dgDataGrid.DataSource = bsData; 
```

谁知道？Scott Langham 在[另一篇文章](https://stackoverflow.com/questions/20386/memory-leaks-in-net#318744)中做到了。谢谢斯科特！

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-12T16:22:35.933

如果您必须支持多种屏幕尺寸/分辨率，表单继承是一个很好的方法。基本上，您设计您的表单以适应标准的 320x240 屏幕。要支持不同的屏幕尺寸，您只需添加一个新表单，从您的自定义表单（而不仅仅是表单）继承，然后根据需要重新排列控件。

另一个有用的技巧是包装 ShowDialog 调用，使您可以将父窗体的标题临时设置为 "" - 这可以防止应用程序中所有打开的窗体显示在正在运行的程序列表中。增强包装器的另一种方法是使用父窗口的句柄 PInvoke SetForegroundWindow。这样可以确保在孩子关闭后，父母总是会重新出现；如果没有这个调用，其他窗口可能会被插入到父窗体上方的 z 堆栈中。

注意 SD 卡上的加密。SqlCE 将完全停止工作。Oracle Lite 在加密下的行为更加险恶，因为它的一部分有效而部分无效。

避免 SqlCE RDA 和合并复制。如果它们可靠地工作，这些将是很棒的工具，但在复制期间网络连接可能意外断开的情况下它们不会（在 WM 世界中很常见）。使用生产应用程序，这让我有点难。我们处理的 MS 支持技术最终被迫承认它不能 100% 工作。实际报价：“继续尝试复制 - 它们最终会正确合并”。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-21T21:55:53.393

大多数不寻常的东西需要通过 P/Invoke 直接调用 Windows API。我发现[http://www.pinvoke.net/](http://www.pinvoke.net/)是 Win32 和 Windows CE 上 P/Invoke 的一个很好的资源。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2010-09-27T19:08:56.673

仅供参考，如果您对 Visual Studio 2010 中没有 Compact Framework 支持感到不安，请前往[此处](https://connect.microsoft.com/VisualStudio/feedback/details/595712/no-support-for-windows-ce-and-compact-framework-development-in-vs2010?wa=wsignin1.0)并投票支持将其添加。（并传播消息）

MS 或多或少地放弃了 Connect 中现有的功能请求。请到新的[用户语音网站投票](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2145313-bring-back-support-for-smart-device-extensions)支持此功能。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-16T22:59:04.097

*   如果您打算使用 Sql Server 3.5 Compact，请阅读[此博客](http://blogs.msdn.com/sqlservercompact/)。
*   SQL Server Compact 存在严重的性能问题，与桌面相比，设备上的某些代码可能会慢 100 倍，因此请始终在设备上测试您的数据库代码。
*   在设备上设置单元和性能/集成测试。也很少有人真正做到这一点，它并不复杂，而且远远超过成本。
*   如果您一直部署代码，请使用网络而不是 ActiveSync。最简单的方法是在设备上设置一个简单的 FTP 服务器或 TCP 代理。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-12-29T10:02:28.813

Working with Compact Framework and SqlCe, there can be a lot of issues with performance, memory leaks and thread synchronisations.

Rules to abide by to minimise Compact Framework - SqlCe headaches.

1.  Use one SqlCe connection - you can use a locking mechanism on the connection to enable the use of one connection on multiple threads.
2.  Bulk Data inserts are slow because of the Sqlce Engine. Use direct table inserts, which has a similar performance benefit to writing directly to a text file.
3.  Dispose the SqlCe connection on close of the application. This makes sure all resources are cleaned up.
4.  Dispose all commands, datareaders etc after every call to the database. Using statements are your friend. Make sure reader objects are inside command using statements etc...

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-27T22:44:15.560

OpenNet CF 值得研究——即使是免费版也有一些有用的库——例如 FTP、datagrid 附加功能等；这非常有用，因为 CF 缺少很多 .net 框架功能。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-04-25T01:05:52.877

在 .net 上可以进行单元测试 (TDD) 参见。但也有问题。

您将使用 MSTest。不是 NUnit、MBUnit、XUnit.net 等 MSTest。

您将需要 Visual Studio Professional（据我所知）。最简单的开始方法是右键单击要测试的方法，然后选择“创建单元测试”。这将为您设置测试项目。只创建一个测试项目。它不喜欢拥有多个。只需执行此操作即可创建项目并为您设置所有依赖项。然后创建自己的测试类。

模拟对象可能是一个问题。RhinoMocks、Moq 和 TypeMock 都依赖于 .net 中不可用的东西。Pex 有一个名为 Stubs 的项目，我仍在研究中。Pex 是 Microsoft 研究项目。您最终将创建自定义的假对象。

测试在设备模拟器上运行。这意味着必须部署它们。如果您在第一次启动测试运行程序时遇到奇怪的错误，您可能还没有在设备模拟器上安装 .net 3.5。首先部署您的项目，然后再次运行测试。

在非测试方面：您确实获得了 LINQ to Objects 和 LINQ to XML。两者都是天赐之物。您可以通过 WCF 与服务器通信，但无法获得所有端点。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-30T17:36:54.253

[使用 DataGrid 时，您可以使用最初发布在 Chris Craft 博客上](http://www.cjcraft.com/Blog/PermaLink,guid,12a73e11-ceff-47a6-8371-d0c0a3db0c00.aspx)的以下代码，通过列标题对其内容进行排序：

```
using System.Windows.Forms;
using System.Data;

public static void SortDataGrid(object sender, System.Windows.Forms.MouseEventArgs e)
{
   DataGrid.HitTestInfo hitTest;
   DataTable dataTable;
   DataView dataView;
   string columnName;
   DataGrid dataGrid;

   // Use only left mouse button clicks.
   if (e.Button == MouseButtons.Left)
   {
   // Set dataGrid equal to the object that called this event handler.
   dataGrid = (DataGrid)sender;

   // Perform a hit test to determine where the mousedown event occured.
   hitTest = dataGrid.HitTest(e.X, e.Y);

   // If the MouseDown event occured on a column header,
   // then perform the sorting operation.
   if (hitTest.Type == DataGrid.HitTestType.ColumnHeader)
   {
      // Get the DataTable associated with this datagrid.
      dataTable = (DataTable)dataGrid.DataSource;

      // Get the DataView associated with the DataTable.
      dataView = dataTable.DefaultView;

      // Get the name of the column that was clicked.
      if(dataGrid.TableStyles.Count != 0)
         columnName = dataGrid.TableStyles[0].GridColumnStyles[hitTest.Column].MappingName;
      else
         columnName = dataTable.Columns[hitTest.Column].ColumnName;

      // If the sort property of the DataView is already the current
      // column name, sort that column in descending order.
      // Otherwise, sort on the column name.
      if (dataView.Sort == columnName)
         dataView.Sort = columnName + " DESC";
      else
         dataView.Sort = columnName;
      }
   }
}

private void dgDataGrid_MouseUp(object sender, System.Windows.Forms.MouseEventArgs e)
{
   if(dgDataGrid.VisibleRowCount == 0) return;
   SortDataGrid(sender, e);
   dgDataGrid.Select(dgDataGrid.CurrentRowIndex);
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-06-24T05:00:17.370

*   您会在 .net cf. 中遇到很多错误和限制。您将不得不修补它们。它很丑，但你别无选择。

*   你最终会编写很多自定义控件。由于框架中的大多数控件不支持客户端通常要求的功能。因此，为您从一开始就使用的每个控件创建自定义控件是一个很好的做法。即使当你开始时你可能没有任何东西。您可以稍后添加自定义逻辑。无需修改大量现有代码。

*   如果您需要验证，您可以使用[.net 验证框架](http://github.com/thekindofme/.netcf-Validation-Framework)

*   在您的应用程序中到处分散您的代码是一个好主意。您可以使用 MVC 模式。如果你选择使用它，你可以通过使用[MobileMVC 来抢占先机](http://mobilemvc.codeplex.com)
*   如果您需要一个丰富的 UI 工具包，您可以查看 Resco（google it）。
*   VS Designer 将是你的大敌。

这就是我现在能想到的。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-03T15:13:49.360

使用 OutlookSession 做任何事情时，总是

*   在主（应用程序）线程上实例化它
*   在主线程上执行它（我使用一个控制对象来调用）
*   并在适当的时间范围内处理它（如果你不这样做，你会在 Pocket Outlook 中出现奇怪的行为）

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-09-22T03:01:30.073

使用 Windows Mobile 时，如果您不希望表单全屏显示，则需要将**FormBorderStyle**设置为**None**。如果你不这样做，那么你将花费数小时拉扯你的头发，想知道为什么它会自动调整到全屏尺寸（这实际上是Windows Mobile的一个*功能）*

# c# - System.Drawing.Image 异常

> ID：363159
> 
> 赞同：1
> 
> 时间：2008-12-12T15:54:59.657
> 
> 标签：c#, exception

嘿，伙计们，我在以下方面遇到了例外

内部异常：{“值不能为空。\r\n参数名称：字符串”}

读起来像是一条简单的错误消息，但没有一个值（图像、文件名）为空。我怎样才能找出这个空字符串在哪里？

```
RipHelper.UploadImage(image, fileName); 
```

调用

```
public static void UploadImage(System.Drawing.Image image, string fileName)
        {
// this line is never reached
         } 
```

这是完整的错误日志

# #

System.ArgumentNullException：值不能为空。参数名称： System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer& number, NumberFormatInfo info, Boolean parseDecimal) at System.Number.ParseInt32(String s, NumberStyles style, NumberFormatInfo info) at System.Int32.Parse(String s) 在 Helpers.RipHelper..cctor() 在 C:\Helpers\RipHelper.cs:line 23 --- 内部异常堆栈跟踪结束 --- 在 Helpers.RipHelper.UploadImage(HttpPostedFile uploadFile, String fileName) 在 Helpers C:\Helpers\UploadHelper.cs:line 79 中的 .UploadHelper.UploadImage(HttpContext 上下文)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T15:59:56.637

例外是在类 Helpers.RipHelper 的静态构造函数中，位于 RipHelper.cs 的第 23 行。这一行正在调用 Int32.Parse，传递一个空值。

也许静态构造函数引用了一个尚未初始化的静态字段。如果您在调试时遇到问题，请发布类的代码，包括静态构造函数和任何字段初始值设定项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T16:00:57.523

错误发生在 RipHelper 类的静态构造函数中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T16:01:08.303

RipHelper 第 23 行试图将空字符串转换为整数，但失败了。这可能在构造函数或静态初始化程序中。您可以访问 RipHelper 源代码吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T16:04:28.047

.cctor() 听起来好像你的 RipHelper 类的构造函数有问题。您可以在调试模式下单步执行代码并查看实际抛出异常的行吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T16:10:38.533

多谢你们。经验教训“更加注意错误日志”。罪魁祸首在这里

```
private static readonly int previewImageHeight = int.Parse(ConfigurationManager.AppSettings["PreviewImageHeight"]); 
```

PreviewImageHeight 在配置中拼写错误。

# c++ - 如何设置理想的 QPixmapCache::cacheLimit？

> ID：363160
> 
> 赞同：1
> 
> 时间：2008-12-12T15:55:07.783
> 
> 标签：c++, qt, caching

我刚刚开始使用 QPixmapCache，我想知道，因为没有太多文档，关于如何根据应用程序运行的系统调整大小。

一些用户可能有很多可用内存，而另一些用户则很少。我不知道最好的设置是什么。

检测系统（空闲）RAM 并调整缓存大小以适应的最佳方法是什么？

[http://doc.trolltech.com/4.4/qpixmapcache.html#setCacheLimit](http://doc.trolltech.com/4.4/qpixmapcache.html#setCacheLimit)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T04:08:23.013

要检测 Windows 中的空闲 RAM，可以使用[GlobalMemoryStatus](http://msdn.microsoft.com/en-us/library/aa366586.aspx)函数。

我不确定这是否会帮助您调整像素图缓存的大小；也许您需要进行一些性能测量并创建一个查找表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T23:10:16.347

请注意，QPixmap 是特定于窗口系统的。这意味着 QPixmap 可能比一般 RAM 更多地对应于显卡内存。就像任何其他缓存一样，它的大小应该“尽可能多，但不能更多”。

调整缓存的最佳方法是分析您在（目标用户的）典型机器上运行的应用程序。查看缓存是否开始丢弃旧的像素图并获得缓存未命中。

# memory - 小型内存设备中的内存分配

> ID：363162
> 
> 赞同：2
> 
> 时间：2008-12-12T15:56:51.710
> 
> 标签：memory, symbian

一些系统如 Symbian 坚持人们在分配
大对象（如路径名，可能超过 512 字节）时使用堆而不是堆栈。这有什么具体原因吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T16:28:21.040

通常，嵌入式设备上的堆栈固定为非常小，即 8K 是 Symbian 上的默认堆栈大小。

如果您认为最大长度的文件名是 256 字节，但对于 512 字节的 unicode（整个堆栈的 1/16），仅对于 1 个文件名就加倍。所以你可以想象，如果你不小心的话，很容易用完堆栈。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-11T08:12:48.900

大多数 Symbian 设备都带有 MMU，但直到最近，还不支持分页。这意味着为每个正在运行的进程提交物理 RAM。Symbian 上的每个线程（通常）都有一个固定的 8KB 堆栈。如果每个线程都有一个堆栈，那么将此堆栈的大小从 8KB 增加到 32KB，将对设备的内存需求产生很大影响。

堆是全局的。如果您需要，增加其规模的影响要小得多。因此，在 Symbian 上，堆栈仅用于小数据项 - 从堆中分配较大的数据项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T16:05:15.407

嵌入式设备通常具有固定大小的堆栈。由于 C 中的子例程调用只需要将几个字压入堆栈，因此几百字节可能就足够了（如果您避免递归函数调用）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T18:10:28.697

大多数嵌入式设备没有内存管理单元，因此操作系统无法自动增加堆栈空间，对程序员透明。即使假设堆栈是可增长的，您也必须自己管理它，这并不比堆分配好，而且一开始就违背了使用堆栈的目的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T16:04:54.363

嵌入式设备的堆栈通常驻留在非常少量的高速内存中。如果您在此类设备上的堆栈上分配大对象，您可能会面临**堆栈溢出**。

# python - 正则表达式问题组名称重新定义？

> ID：363171
> 
> 赞同：13
> 
> 时间：2008-12-12T15:58:50.990
> 
> 标签：python, regex

所以我有这个正则表达式：

```
(^(\s+)?(?P<NAME>(\w)(\d{7}))((01f\.foo)|(\.bar|\.goo\.moo\.roo))$|(^(\s+)?(?P<NAME2>R1_\d{6}_\d{6}_)((01f\.foo)|(\.bar|\.goo\.moo\.roo))$)) 
```

现在，如果我尝试对此进行匹配：

```
B048661501f.foo

```

我收到此错误：

```
  编译中的文件“C:\Python25\lib\re.py”，第 188 行
    返回_compile（模式，标志）
  _compile 中的文件“C:\Python25\lib\re.py”，第 241 行
    raise error, v # 无效表达式
sre_constants.error：将组名“NAME”重新定义为组 9；是第 3 组

```

如果我不能在相同的正则表达式中为两种不同的情况定义两次相同的组，我该怎么办？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-12T16:27:22.413

不，你不能有两个同名的组，这会以某种方式违背目的，不是吗？

您可能*真正*想要的是：

```
^\s*(?P<NAME>\w\d{7}|R1_(?:\d{6}_){2})(01f\.foo|\.(?:bar|goo|moo|roo))$ 
```

我尽可能重构了你的正则表达式。我做了以下假设：

你想（如果我错了，请纠正我）：

*   忽略字符串开头的空格
*   将以下任一匹配到名为“NAME”的组中：
    *   一个字母后跟 7 位数字，或
    *   `"R1_"`, 和两次 (6 位数 + `"_"`)
*   其次是：
    *   `"01f.foo"`或者
    *   `"."`和 (`"bar"`或`"goo"`或`"moo"`或`"roo"`)
*   后跟字符串的结尾

* * *

你也可能意味着：

```
^\s*(?P<NAME>\w\d{7}01f|R1_(?:\d{6}_){2})\.(?:foo|bar|goo|moo|roo)$ 
```

这是：

*   忽略字符串开头的空格
*   将以下任一匹配到名为“NAME”的组中：
    *   一个字母后跟 7 位数字和“01f”
    *   `"R1_"`, 和两次 (6 位数 + `"_"`)
*   一个点
*   `"foo"`, `"bar"`, `"goo"`,`"moo"`或`"roo"`
*   字符串的结尾

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-11T21:21:35.470

与 Tamalak 的回复相反，在您的情况下重复使用相同的名称是有意义的。

您的正则表达式使用 python2.7 和 re2 编译。也许这个问题已经解决了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-05-26T05:31:16.487

以下答案涉及如何使上述正则表达式在 Python3 中工作。

由于 Max 建议的 re2 模块在 Python3 中不起作用，因为 `NameError: basestring`. 另一个替代方案是`regex`模块。

`regex`模块只是`re`具有额外附加功能的增强版本。该模块还允许在正则表达式中具有相同的组名。

您可以通过以下方式安装它：

```
sudo pip install regex 
```

如果您已经在使用`re`或`re2`在您的程序中。只需执行以下操作即可导入`regex`模块

```
import regex as re 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-18T09:10:30.767

正如[这里](https://stackoverflow.com/a/44463324/416988)提到的，Python PyPi`regex`模块支持*分支重置功能*。

# asp.net - 在母版页中启用viewstatemac

> ID：363172
> 
> 赞同：0
> 
> 时间：2008-12-12T15:59:46.947
> 
> 标签：asp.net

我收到“视图状态 MAC 验证失败”，据我所知，您可以在每个页面或 web.config 上添加 enableviewstatemac = false，所以我可以在主页面中更改而不是更改为每个页面，这样我就不会必须在所有页面上进行更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T18:00:29.950

消息验证检查默认是关闭的，所以一定有人打开它是有原因的。

我不确定您是否可以在母版页上设置它 - 它是一个页面指令，但它可能适用于主声明。但是，如果您想为网站上的所有页面关闭它，那么更新 web.config 将是最简单的选项 - 然后如果您稍后添加第二个母版页，您将不必记得在那里关闭它.

在 web.config 中，您可以修改 asp.page 部分：

```
<asp:Page EnableViewStateMac="False" /> 
```

这将为整个站点关闭它。

[http://msdn.microsoft.com/en-us/library/system.web.ui.page.enableviewstatemac.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.page.enableviewstatemac.aspx)

# project-management - 使用主题地图导航的项目跟踪工具？

> ID：363181
> 
> 赞同：4
> 
> 时间：2008-12-12T16:02:07.753
> 
> 标签：project-management, visualization, topic-maps

我在项目管理方面遇到了麻烦，我正在寻找一个很好的工具，它可以很好地匹配我的大脑工作方式（非常相关）。我想要一个错误跟踪器，但我可以将任务分组为主题并在图表中将主题相互关联（请参阅[主题](http://en.wikipedia.org/wiki/Topic_Maps)地​​图上的维基百科条目），以便我可以轻松找到并可视化“大图”。我试过使用 AbstractSpoon 的[ToDoList](http://www.abstractspoon.com/)，它运行良好，但它是分层的，在大约 30 或 40 个条目之后，我迷失在要做的事情的迷宫中。

有什么建议么？

* * *

**编辑：**我现在尝试过[Freemind](http://freemind.sourceforge.net)、[Conzilla](http://www.conzilla.org)、[XMind](http://www.xmind.net/)和[VUE](http://vue.tufts.edu/)。Freemind 和 Conzilla 有点不稳定。XMind 似乎是四个中最精致的；他们有一个非免费的“专业”版本（按月付费>：（这很奇怪），但有一个免费的开源基础版本。您不能使用免费版本直接从程序中导出数据，但存储格式只是一个 .jar 样式（ZIP 文件，扩展名为 .xmind）文件，其中包含一个“contents.xml”，如果需要，可以轻松解析。

@codeslave：

> 但无论如何，视觉表现有多重要

可视化就是一切！我有信息超载，我需要能够浏览混乱的信息。我不希望它被超级 Powerpoint 抛光，但我需要能够使用我创建的关联来提醒自己如何找到我正在寻找的东西。在理想的世界中，您可以只对所有内容进行全文搜索，但这只有在您能记住搜索短语的情况下才有效。通常我会在“算法”下归档一些东西，当我去寻找它时，我会在“编程”下寻找，反之亦然。关联性通过允许我直观地浏览我存储的信息的“心理模型”来解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T09:16:13.097

您始终可以从“最喜欢的”工具中获取 CVS 导出，并创建可以使用 Omnigator 或 xSiteable 工具查看的主题地图。我曾经有几个 XSLT 文件来完成处理 JIRA 数据的工作。如果兴趣足够高，也许需要恢复？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T16:29:54.750

我开发了一个小型实用程序，可以[将 MindMaps 导入到项目计划](http://www.mobiusdevelopment.com/dev/Download.asp?ArticleID=5765697756647927831)中。让我知道这样的事情是否有帮助，我会进一步开发它。

[现在我只是从MindMap](http://freemind.sourceforge.net/) -> 项目文件中单向使用它。我通常将其用于头脑风暴和范围管理，然后在我们喜欢我们正在使用的范围进行更正式的项目管理时导出到项目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T16:47:10.050

使用好的旧 FogBugz 怎么样？您可以很容易地将案例关联在一起。您没有得到主题空间/思维导图的漂亮图表（特征想法 Joel），但视觉表示无论如何重要。

# sql-server - 在 SQL Server 中使用 SET ROWCOUNT - 限制结果集

> ID：363189
> 
> 赞同：3
> 
> 时间：2008-12-12T16:06:03.753
> 
> 标签：sql-server, tsql

我有一个由多个 SELECT 语句组成的 sql 语句。我想将返回的总行数限制为 1000 行。我认为使用 SET ROWCOUNT 1000 指令可以做到这一点……但事实并非如此。例如：

```
SET ROWCOUNT 1000

select orderId from TableA

select name from TableB 
```

我最初的想法是 SET ROWCOUNT 将应用于**整个**批次，而不是其中的单个语句。我看到的行为是将第一个选择限制为 1000，然后将第二个选择限制为 1000，总共返回 2000 行。有没有办法将 1000 限制应用于整个批次？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T16:08:30.503

不是在一个声明中。您必须在每个语句之后从所需的总行数中减去 @@ROWCOUNT，并使用变量（例如“@RowsLeft”）来存储所需的剩余行数。然后，您可以从每个单独的查询中选择 TOP @RowsLeft ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T16:13:18.060

未经测试并且不使用 ROWCOUNT，但可以给你一个想法吗？

假设 TableA 和 TableB 中的 col1 是同一类型。

```
SELECT TOP 1000 * 
FROM (select orderId 
      from TableA 
      UNION ALL 
      select name from TableB) t 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T16:15:32.283

使用 TOP 而不是 ROWCOUNT

[http://msdn.microsoft.com/en-us/library/ms189463.aspx](http://msdn.microsoft.com/en-us/library/ms189463.aspx)

您试图从所有表中获取 1000 行 MAX 对吗？

我认为其他方法可能会首先从顶部查询中填充，而您可能永远不会从较低的查询中获得结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T16:17:18.690

如果您能够批量执行此操作，如果第一个查询总是返回超过 1000 个，您将如何从第二个查询中看到任何记录？

如果查询足够相似，您可以尝试通过联合来执行此操作并在其上使用行数，因为此时它只是一个查询。如果返回的列中的查询不同，我不确定将整个组限制为 1000 行会得到什么，因为含义会有所不同。从用户的角度来看，我宁愿始终如一地获得 500 个订单和 500 个客户名称，而不是一天收到 998 个订单和 2 个名称，然后下一天收到 210 个订单和 790 个名称。如果您碰巧对第二个查询中的信息最感兴趣，则无法使用该应用程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T16:46:04.373

这个要求听起来很奇怪。除非您合并或连接来自两个选择的数据，否则将它们视为一个，以便应用最大行数根本没有意义，因为此时它们是不相关的查询。如果您确实需要这样做，请尝试：

```
select top 1000 from (
    select orderId, null as name, 'TableA' as Source from TableA
    union all
    select null as orderID, name, 'TableB' as Source from TableB
) a order by Source 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-22T17:31:14.733

SET ROWCOUNT 适用于每个单独的查询。在您给定的示例中，它应用了两次，一次应用于每个 SELECT 语句，因为每个语句都是它自己的批处理（它们没有分组或联合或任何东西，因此完全单独执行）。

@RedFilter 的方法似乎最有可能给你想要的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-22T17:20:28.333

以下对我有用：

```
CREATE PROCEDURE selectTopN
(
    @numberOfRecords int
)
AS
    SELECT TOP (@numberOfRecords) * FROM Customers
GO 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-16T03:52:43.147

这是你的解决方案：

[顶部（事务处理 SQL）](http://technet.microsoft.com/en-us/library/ms189463.aspx)

关于@@RowCount，您可以阅读此链接：

[SET ROWCOUNT (Transact-SQL)](http://technet.microsoft.com/en-us/library/ms188774.aspx)

![在此处输入图像描述](https://i.stack.imgur.com/lElUB.gif)重要的

在 SQL Server 的未来版本中使用`SET ROWCOUNT` `will not affect` `DELETE`、`INSERT`和`UPDATE`语句。`Avoid`在新的开发工作中使用`SET ROWCOUNT`with `DELETE`、`INSERT`和`UPDATE`语句，并计划修改当前使用它的应用程序。对于类似的行为，请使用 TOP 语法。有关详细信息，请参阅[TOP (Transact-SQL)](http://technet.microsoft.com/en-us/library/ms189463.aspx)。

我认为两种方法都可以。！

# .net - 如何避免 XML 注入

> ID：363190
> 
> 赞同：7
> 
> 时间：2008-12-12T16:06:48.680
> 
> 标签：.net, xml

我有用于形成 XPath 查询的输入字段值。我应该检查输入字符串中的哪些符号以最大程度地减少 XML 注入的可能性？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T17:13:51.557

本[**文档**](http://packetstormsecurity.org/papers/bypass/Blind_XPath_Injection_20040518.pdf)详细描述了“Blind XPath Injection”的概念。

它提供了 XPath 注入的具体示例并讨论了防止这种情况的方法。

在“**防御 XPath 注入**”一节中说：

"*防御 XPath 注入本质上类似于防御 SQL 注入。应用程序必须清理用户输入。具体而言，单引号和双引号字符应该被禁止。这可以在应用程序本身或第三方产品中完成 (例如应用程序防火墙。）测试应用程序对 XPath 注入的敏感性可以很容易地通过注入单引号或双引号并检查响应来执行。如果发生错误，那么 XPath 注入很可能是可能的*。

正如其他人所说，还应注意使用轴和 // 缩写。如果正在使用[**XPath 2.0**](http://www.w3.org/TR/xpath20/)，则不应允许[**`doc`**()函数，因为它可以访问具有已知 URI（或文件名）的任何文档。](http://www.w3.org/TR/xpath-functions/#func-doc)

建议使用预编译 XPath 表达式但保留它与动态定义的参数或变量一起工作的可能性的 API。然后用户输入将仅定义这些参数的内容，并且永远不会被视为对已编译表达式的修改。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-12T22:57:01.457

颠倒你的战术。

不要试图过滤掉不可接受的字符—— *“除非我知道它是坏的，否则假设它是好的”的策略*

相反，过滤可接受的字符 - *“这东西没问题，我假设其他一切都是坏的”*的策略。

在安全方面，采用“默认拒绝”而不是*“默认接受”*的策略。

例如 ...

...如果您要向某人询问搜索词，例如某人的名字，请将输入限制为您希望在姓名中找到的字符。

一种方法是限制为 AZ，然后确保您的搜索技术能够识别重音（例如 i = ì = í = î = ï 等等），尽管这取决于非欧洲命名。

...如果您要一个数字，请限制为数字并拒绝其他所有内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T16:15:42.283

我将首先考虑什么是您的特定用例的有效输入，然后寻找限制其他所有内容的方法。如果您有固定范围的条目值，我会将条目限制为这些值。否则，如果您的用例要求您考虑未来，那么您可能需要检查轴修饰符和路径分隔符，例如`:`和`\`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T16:21:10.523

这取决于您所说的“XML 注入”是什么意思。文档中是否存在敏感部分且不允许用户查看？或者您是否将其作为可写状态打开并允许用户更新文档的某些部分，并且只允许他们更新某些部分？

在基本层面上，要回答您的问题，您至少需要查找 xpath 轴操作（例如`//`, `/`）`::`和通配符 ( `@*`, `*`)。但是我的感觉是直接使用用户输入来构建xpath可能不是最优的解决方案。也许如果您就您要实现的目标向我们提供更多背景信息，我们可以建议替代方法？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-13T13:29:19.823

关闭此漏洞只是一个修补程序。所以现在应用“默认拒绝”策略太危险了。我决定检查以下符号的输入 [,",',*,=,{,\,.,space。我认为这可以防止最常见的攻击 谢谢大家的回答！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-27T13:04:24.470

输入字符串的验证会很有帮助，也许，使用像正则表达式（像这样的 ^\w+）这样的东西，因为不允许特殊字符。

# windows - 没有 Cygwin 的 Windows 上的 Git？

> ID：363192
> 
> 赞同：19
> 
> 时间：2008-12-12T16:07:18.820
> 
> 标签：windows, git, version-control, tortoisesvn, cygwin

是否有任何不需要 Cygwin 的 Windows 原生 Git 实现？我已经成为 TortoiseSVN 客户端的粉丝，并且非常希望看到一个类似的适用于 Windows 的 Git 客户端。

**编辑：**我也在考虑[Mercurial](http://www.selenic.com/mercurial/wiki/)，但我更愿意在做出决定之前先检查一些。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-14T00:29:46.680

有一个[TortoiseGit](http://repo.or.cz/w/TortoiseGit.git) -- Window Explore 扩展来操作 Git。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-12T16:27:12.400

看看[MSysGit](http://code.google.com/p/msysgit/)。然而，这只是使用 MingW 而不是 cygwin 编译的命令行 git。这不是像 TortoiseSVN 这样的 GUI 工具。

GitExtensions[采用](http://sourceforge.net/projects/gitextensions/)与 Tortoise 相同的路径，但看起来还没有准备好。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-14T11:06:31.123

大约一周前，我开始使用 GitExtensions。尽管 0.6 版是一个非常完整的软件包，但我认为它还没有准备好发布。该工具集应该准备好在几天内发布它的第一个稳定版本。在任何人在生产中使用它之前，我需要解决一些问题。现在最重要的问题是 shell 扩展部分是用 c# 编写的，因此可能会导致问题。我现在正在用 c++ 重写它，应该只需要几个小时。我还想构建一些可以防止用户搞砸的功能（比如在另一个存储上创建一个存储并在合并过程中丢弃工作或提交更改）。我已经完成了我曾经使用过的所有 git 命令（push、pull、fetch、stash、branch、commit、merge、format-patch、am、apply 等），所以它应该很快就可以使用了。该工具集是用 C# 编写的（.Net 3.5 直到版本 0.6，以后的版本使用 .Net 2.0）除了 shell 扩展部分。还有一个视觉工作室插件，但这仍然是非常基本的。

顺便说一句，我还没有尝试过 TortoiseGit，但我真的很喜欢 TortoiseSVN！

亨克

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-23T09:15:27.047

您是否尝试过查看[Google Code 上的 TortoiseGit 页面](http://code.google.com/p/tortoisegit/)？我相信它与发布的其他链接是同一个项目，但它更友好一些。您可以从那里下载最新版本作为安装程序。

# linux - 是否可以对 QTreeWidget 列中的数字进行排序？

> ID：363200
> 
> 赞同：7
> 
> 时间：2008-12-12T16:10:36.193
> 
> 标签：linux, qt, sorting, qtreewidget, qtreewidgetitem

我有一个 QTreeWidget，其中有一列填充了一些数字，我该如何对它们进行排序？

如果我使用 setSortingEnabled(true); 我只能正确排序字符串，因此我的列已排序：

1 10 100 2 20 200

但这不是我想要的！建议？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-14T15:10:48.057

您可以排序覆盖 < 运算符并像这样更改排序条件。

```
class TreeWidgetItem : public QTreeWidgetItem {
  public:
  TreeWidgetItem(QTreeWidget* parent):QTreeWidgetItem(parent){}
  private:
  bool operator<(const QTreeWidgetItem &other)const {
     int column = treeWidget()->sortColumn();
     return text(column).toLower() < other.text(column).toLower();
  }
}; 
```

在这个例子中，它忽略了真实的大小写，面对小写模式的字段。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-02-22T07:48:28.047

这是一个使用 pyQt 的实现`__lt__`

```
class TreeWidgetItem(QtGui.QTreeWidgetItem):

    def __init__(self, parent=None):
        QtGui.QTreeWidgetItem.__init__(self, parent)

    def __lt__(self, otherItem):
        column = self.treeWidget().sortColumn()
        return self.text(column).toLower() < otherItem.text(column).toLower() 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-27T16:13:07.980

我发现的最好方法是使用 try 块来查找数字

```
class TreeWidgetItem( QtGui.QTreeWidgetItem ):
    def __init__(self, parent=None):
        QtGui.QTreeWidgetItem.__init__(self, parent)

    def __lt__(self, otherItem):
        column = self.treeWidget().sortColumn()
        try:
            return float( self.text(column) ) > float( otherItem.text(column) )
        except ValueError:
            return self.text(column) > otherItem.text(column) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-12T16:22:11.583

数字按数值排序，但字符串排序相反（即`"19999" < "2"`）。

更具体地说，字符串从左到右逐个字符进行比较，直到其中一个或其他字符不同，此时停止比较。例如，`19`将`121`像这样进行比较：

```
"19"[0] != "121"[0] ? // no
"19"[1] != "121"[1] ? // yes
     '9' > '2' ?      // yes
          return some value that indicates "19" greater than "121"; 
```

要正确排序它们，您需要将它们转换为数值，然后对它们进行排序。除此之外，您可以实现自己的排序算法，以正确的方式读取数字。

# html - 通用下拉菜单？

> ID：363206
> 
> 赞同：3
> 
> 时间：2008-12-12T16:13:35.890
> 
> 标签：html, css, cross-browser, html-select

我正在尝试为我正在设计的网站创建一个“快速链接”下拉列表，它必须与所有浏览器 IE6 及更高版本兼容。它需要保持 120px 宽，因为它的位置是静态的。使用`<select>`标签并设置宽度，这是可行的；但是，当打开该框时，IE 会切断较长的文本链接，Firefox 会正确调整它们的大小。无论如何定义下拉菜单的宽度与适用于所有浏览器的框顶部的 120px 不同？

如果没有，是否有一个不需要 10 页 javascript 的可自定义下拉菜单的简单脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T16:37:53.733

查看[http://lwis.net/free-css-drop-down-menu/](http://lwis.net/free-css-drop-down-menu/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T18:02:54.733

如果对 A List Apart[吸盘鱼](http://www.alistapart.com/articles/dropdowns/)感兴趣，您应该查看更新[的吸盘鱼之子以](http://www.htmldog.com/articles/suckerfish/dropdowns/)获得灵感。12 行 javascript 代码 + 多行支持。

作为参考，这里是一个讨论问题并提供解决方案的[线程](http://www.webmasterworld.com/css/3580296.htm)，以支持 ie6 和 ie7 的细微差别以及吸盘鱼的儿子（但适用于所有菜单实现）。

# bash - bash脚本..复制文件而不覆盖

> ID：363209
> 
> 赞同：2
> 
> 时间：2008-12-12T16:14:45.187
> 
> 标签：bash

我想知道是否可以根据原始名称将文件复制/移动到目的地。

基本上，我有一个 /mail 文件夹，其中有几个子文件夹，例如 cur 和 new 等。然后我在 /mail/home/username 中有一个提取的备份，它是重复的。mv -f 将不起作用，因为我没有权限覆盖目录，但只有其中的文件。

我收到诸如 mv: cannot overwrite directory `/home/username/mail/username.com' 之类的错误

我想要做的是将目录username.com 中的每个文件移动到/mail 中的同名文件夹中。可以有任意数量的文件夹来代替 username.com，它们各自有单独的子目录。

做这个的最好方式是什么？

我必须这样做，因为由于某些情况，我只能通过 php 使用 ftp 和 bash 访问我的主机。

编辑：澄清

我想我需要澄清发生了什么。我在共享主机上，显然没有对目录本身的写访问权限。至少是邮件和public_html等主要的。我用 tar 备份了 ~/mail，但是当我试图将它解压到 ~/mail/home/mail 等时，我忘记了完整路径。现在，我不能简单地解压缩，因为路径错误，我不能 mv -f 因为我只有对文件的写访问权，而不是目录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T16:38:01.910

对于复制，您应该考虑`cpio`在“通过”模式下使用 ( `-p`)：

```
cd /mail; find . -type f | cpio -pvdmB /home/username/mail 
```

`-v`是冗长的；`-d`根据需要创建目录；`-m`保留文件的修改时间；`-B`意味着使用更大的块大小，在这里可能无关紧要（它曾经在弄乱磁带设备时有所作为）。此列表中省略了进行`-u`无条件复制、覆盖目标区域中预先存在的文件的标志。该`cd`命令确保路径名正确；如果你刚刚做了：

```
find /mail -type f | cpio -pvdmB /home/username 
```

您将获得相同的结果，但这只是巧合 - 因为子目录下的子目录`/home/username`与原始的绝对路径名相同。如果您需要这样做：

```
find /var/spool/mail -type f | cpio -pvdmB /home/username/mail 
```

那么复制的文件将在 下找到`/home/username/mail/var/spool/mail`，这不太可能是您的想法。

您可以使用 (GNU) 实现类似的效果`tar`：

```
(cd /mail; tar -cf - . ) | (cd /home/username/mail; tar -xf - ) 
```

这会复制目录，而不仅仅是文件。为此，您需要 GNU-only 工具：

```
(cd /mail; find . -type f | tar -cf - -F - ) | (cd /home/username/mail; tar -xf - ) 
```

第一个单独的破折号表示“写入标准输出”；第二个意思是“从标准输入读取”；“-F”选项表示“读取文件名以从命名文件中复制”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T16:24:30.830

我不完全清楚你想要做什么，但你可以尝试以下方法：

```
for file in /mail/*; do
    mv -f $file /home/username/mail/$(basename $file)
done 
```

这会将 /mail 中的每个文件和子目录从那里移动到 /home/username/mail。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T16:39:00.410

是否使用`tar`选项？您可以升级目录，并在覆盖现有文件和目录`tar`的情况下将其解压缩`/mail/`（因为我假设这是您大致想要的） 。`tar`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T16:40:01.000

我对您到底想要做什么感到有些困惑。但是您应该能够使用亚当解决方案的方法并将错误重定向到文件。

```
for file in /mail/*; do
    mv -f $file /home/username/mail/$(basename $file) 2> /tmp/mailbackup.username.errors
done 
```

目录不会被覆盖，您可以检查文件，以便它只包含您预期的错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T16:58:22.290

可以再解压吗？*tar*的 -P 选项不会去除前导“/”，因此将尊重绝对路径名。根据您的编辑，听起来这会解决它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T17:04:31.933

即使有了您的澄清，我仍然无法准确理解您在做什么。但是，您有机会使用 rsync 吗？src 和 dest 主机可以是 rsync 的同一主机。我记得，您可以告诉 rsync 只更新目标区域中已经存在的文件（--existing），也可以忽略目录更改（--omit-dir-times）。

同样，我不太了解您的需求，但 rsync 在备份文件和目录方面非常灵活。

祝你好运。

# asp.net-mvc - 如何在 ASP.NET MVC 的控制器中获取路由名称？

> ID：363211
> 
> 赞同：53
> 
> 时间：2008-12-12T16:15:32.877
> 
> 标签：asp.net-mvc, model-view-controller, routing

ASP.NET MVC 路由在映射时具有名称：

```
routes.MapRoute(
    "Debug", // Route name -- how can I use this later????
    "debug/{controller}/{action}/{id}",
    new { controller = "Home", action = "Index", id = string.Empty } ); 
```

有没有办法获取路由名称，例如上例中的“Debug”？我想在控制器的 OnActionExecuting 中访问它，以便在调试时可以在 ViewData 中设置内容，例如，通过在 URL 前面加上 /debug/...

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2008-12-12T19:22:11.547

不幸的是，路线名称未存储在路线中。它只是在 MVC 内部用作集合中的键。我认为这是您在使用 HtmlHelper.RouteLink 创建链接时仍然可以使用的东西（也许在其他地方也是如此，不知道）。

无论如何，我也需要它，这就是我所做的：

```
public static class RouteCollectionExtensions
{
    public static Route MapRouteWithName(this RouteCollection routes,
    string name, string url, object defaults, object constraints)
    {
        Route route = routes.MapRoute(name, url, defaults, constraints);
        route.DataTokens = new RouteValueDictionary();
        route.DataTokens.Add("RouteName", name);

        return route;
    }
} 
```

所以我可以注册这样的路线：

```
routes.MapRouteWithName(
    "myRouteName",
    "{controller}/{action}/{username}",
    new { controller = "Home", action = "List" }
    ); 
```

在我的 Controller 操作中，我可以通过以下方式访问路由名称：

```
RouteData.DataTokens["RouteName"] 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-09-06T23:10:07.383

如果使用如下标准 MapRoute 设置：

```
routes.MapRoute(    name: "Default",
                    url: "{controller}/{action}/{id}",
                    defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional } 
```

...这将在视图中工作...

```
var routeName = Url.RequestContext.RouteData.Values["action"].ToString(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-12T04:25:58.237

您可以使用附加参数的默认值通过路由值传递路由名称：

```
routes.MapRoute(
    name: "MyRoute",
    url: "{controller}/{action}/{id}",
    defaults: new { routeName = "MyRoute", controller = "Home", action = "Index", id=UrlParameter.Optional }
); 
```

然后，可以从控制器上下文中获取传递的值：

```
string routeName = ControllerContext.RouteData.Values["routeName"].ToString(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-28T11:37:13.403

这并不能*直接*回答问题（如果您想学究）；但是，真正的目标似乎是在给定路由名称的情况下获取路由的基本 URL。所以，这就是我的做法：

我的路线定义`RouteConfig.cs`为：

```
routes.MapRoute(
            name: "MyRoute",
            url: "Cont/Act/{blabla}",
            defaults: new { controller = "Cont", action = "Act"}
        ); 
```

并获取路由的基本 URL：

```
var myRoute = Url.RouteUrl("MyRoute", new { blabla = "blabla" }).Replace("blabla", ""); 
```

它给了我想要的路由的基本 URL：

```
/Cont/Act/ 
```

希望这可以帮助。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-20T21:40:12.530

另一种解决方案可能是使用解决方案配置：

```
protected override OnActionExecuting()
{
    #if DEBUG

        // set up stuff in the ViewData

    #endif

    // continue
} 
```

真的不需要像这样引用路由名称——我想这就是为什么 MVC 让做这种事情变得如此困难。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2011-05-31T14:35:54.133

另一种选择 - 使用带有字符串 [] 命名空间参数的 MapRoute，然后您可以将命名空间视为`RouteData.DataTokens["Namespaces"]`

# ruby - 鞋子打包机问题

> ID：363218
> 
> 赞同：2
> 
> 时间：2008-12-12T16:17:46.957
> 
> 标签：ruby, shoes, packager

我使用打包器为以下代码制作了一个可执行文件：

```
Shoes.app do
  stack :margin => 10 do
    @edit = edit_box :width => 1.0 do
      @para.text = @edit.text
    end
    @para = para ""
  end
end 
```

然后我收到错误消息：

C:/Program Files/Common Files/Shoes/0.r1134/lib/shoes.rb line 394utf.rb: 10:
编译器错误
utf.rb: 10: Invalid char '\377' in expression
utf.rb: 10 ：表达式
utf.rb 中的无效字符“\337”：10：表达式 utf.rb 中的无效字符“\337”
：10：表达式 utf.rb 中的无效字符“\331”
：10：无效的字符“\377”表达式
utf.rb: 10: 表达式中的无效字符 '\270'
utf.rb: 10: 表达式中的无效字符 '\304'

有人可以帮我一把吗？

BR，
多里安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-01T08:48:08.907

可能是[这里](http://www.mail-archive.com/ironruby-core@rubyforge.org/msg02138.html)建议将文件保存为无 BOM 的 UTF-8 格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T16:24:18.810

我有类似的问题，但以 Unix 格式保存使它对我有用。

不过，另一个问题似乎是打包的 .exe 以某种方式缓存了要执行的代码。如果我更改源代码，运行打包程序重新创建 exe，然后再次启动 exe，它似乎没有发生任何事情。即使之前删除 .exe，或者将源移动到另一个文件夹似乎也不能解决问题。

唯一的解决方案似乎是重命名源文件。打包程序然后正确地创建一个新的 .exe 与更新的代码。

有没有人遇到过这样的问题，或者知道解决方法？打包程序是否有一个临时文件夹存储文件，然后不能被覆盖，以便始终使用“第一个版本”？我查看了打包程序的源代码，但在那里找不到任何东西......

基督教

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T11:58:00.730

我也找不到生成工作 .exe 的方法。尝试将源代码保存在所有可能的 Unicode 编码变体中，但仍然没有。鞋子 r1134。我想我在某个地方发红了，这需要在期待已久的下一个鞋子版本中修复......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T18:07:42.803

我在 Windows 上使用 vim 时遇到了同样的问题。

我发现如果您使用记事本并将其保存为默认的“ANSI”，它确实可以工作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-05T23:31:40.913

我还收到“表达式中的无效字符 '\377'”。我保存为 UTF-8 (UNIX LF)，所以这不是问题，因为我在我的应用程序名称中使用了下划线 ('_')。显然，您不能在名称中带有下划线的文件上使用 shoes-packager，这很烦人，因为下划线是 ruby​​-convention...

# unix - 管道作为进程间通信

> ID：363221
> 
> 赞同：9
> 
> 时间：2008-12-12T16:18:02.293
> 
> 标签：unix, piping

我有兴趣编写单独的程序模块，这些模块作为独立线程运行，我可以与管道挂钩。动机是我可以完全独立地编写和测试每个模块，甚至可以用不同的语言编写它们，或者在不同的机器上运行不同的模块。这里有各种各样的可能性。我已经使用管道一段时间了，但我不熟悉其行为的细微差别。

*   似乎接收端会阻塞等待输入，这是我所期望的，但是发送端有时会阻塞等待某人从流中读取吗？
*   如果我将 eof 写入流，我可以继续写入该流直到我关闭它吗？
*   命名管道和未命名管道的行为是否存在差异？
*   我首先用命名管道打开管道的哪一端有关系吗？
*   不同 Linux 系统之间管道的行为是否一致？
*   管道的行为是否取决于我使用的 shell 或我配置它的方式？
*   如果我想以这种方式使用管道，是否还有其他问题我应该问或我应该注意的问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T17:11:19.330

哇，这是很多问题。让我们看看我是否可以涵盖所有内容...

> 似乎接收端会阻止等待输入，这是我所期望的

您正确地期望实际的“读取”调用将阻塞，直到出现某些东西。但是，我相信有一些 C 函数可以让您“窥视”管道中等待的内容（和数量）。不幸的是，我不记得这是否也阻止了。

> 发送端是否有时会等待某人从流中读取

不，发送永远不应该阻塞。如果这是通过网络连接到另一台计算机的管道，请考虑一下后果。您是否要等待（通过可能的高延迟）另一台计算机响应它收到它？现在，如果目标的读取器句柄已关闭，则情况不同。在这种情况下，您应该进行一些错误检查来处理它。

> 如果我将 eof 写入流，我可以继续写入该流直到我关闭它

我认为这取决于您使用的语言及其管道的实现。在 C 中，我会说不。在 linux shell 中，我会说是的。其他有更多经验的人必须回答这个问题。

> 命名管道和未命名管道的行为是否存在差异？据我所知，是的。但是，我在命名与未命名方面没有太多经验。我相信区别在于：

*   单向与双向通信
*   读取和写入线程的“输入”和“输出”流

> 我首先用命名管道打开管道的哪一端有关系吗？

通常不会，但您可能会在尝试创建线程并将线程彼此链接时遇到初始化问题。您需要有一个主线程来创建所有子线程并将它们各自的管道相互同步。

> 不同Linux系统之间管道的行为是否一致？

同样，这取决于什么语言，但通常是的。听说过 POSIX 吗？这是标准（至少对于 linux，Windows 是自己做的）。

> 管道的行为是否取决于我使用的 shell 或我配置它的方式？

这进入了一个灰色地带。答案*应该*是否定的，因为 shell 本质上应该是进行系统调用。然而，在那之前的一切都是可以争夺的。

> 还有其他问题我应该问吗

您提出的问题表明您对该系统有相当的了解。继续研究并专注于您将在哪个级别上工作（shell、C 等）。不过，只要尝试一下，您就会学到更多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T17:16:19.790

这一切都基于类 UNIX 系统；我不熟悉 Windows 最新版本的具体行为。

*似乎接收端会阻塞等待输入，这是我所期望的，但是发送端有时会阻塞等待某人从流中读取吗？*

是的，尽管在现代机器上它可能不会经常发生。管道有一个可能会填满的中间*缓冲区*。如果是这样，管道的写入端确实会阻塞。但如果你仔细想想，没有多少文件大到足以冒这个风险。

*如果我将 eof 写入流，我可以继续写入该流直到我关闭它吗？*

嗯，你的意思是像 CTRL-D，0x04？当然，只要流是这样设置的。即。

```
506 # cat | od -c
abc
^D
efg
0000000    a   b   c  \n 004  \n   e   f   g  \n                        
0000012 
```

*命名管道和未命名管道的行为是否存在差异？*

是的，但它们很微妙并且依赖于实现。最大的一个是您可以在另一端运行之前写入命名管道；使用未命名的管道，文件描述符在 fork/exec 过程中被共享，因此在进程未启动的情况下无法访问瞬态缓冲区。

*我首先用命名管道打开管道的哪一端有关系吗？*

没有。

*不同Linux系统之间管道的行为是否一致？*

在合理范围内，是的。缓冲区大小等可能会有所不同。

*管道的行为是否取决于我使用的 shell 或我配置它的方式？*

不。当你创建一个管道时，在幕后发生的是你的父进程（shell）创建一个具有一对文件描述符的管道，然后像下面的伪代码一样执行 fork exec：

**家长**：

```
create pipe, returning two file descriptors, call them fd[0] and fd[1]
fork write-side process
fork read-side process 
```

**写端**：

```
close fd[0]
connect fd[1] to stdout
exec writer program 
```

**读端**：

```
close fd[1]
connect fd[0] to stdin
exec reader program 
```

*如果我想以这种方式使用管道，是否还有其他问题我应该问或我应该注意的问题？*

你想做的每一件事真的会像这样排成一行吗？如果没有，您可能需要考虑更通用的架构。但是，通过管道的“狭窄”接口进行交互的许多单独的进程是可取的，这是一个很好的见解。

*[更新：我首先反转了文件描述符索引。他们现在是正确的，请参阅`man 2 pipe`。]*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-13T07:31:41.560

正如 Dashogun 和 Charlie Martin 所指出的，这是一个大问题。他们的某些部分答案不准确，所以我也将回答。

> 我有兴趣编写单独的程序模块，这些模块作为独立线程运行，我可以与管道挂钩。

小心尝试使用管道作为单个进程的线程之间的通信机制。因为您将在单个进程中同时打开管道的读取和写入端，所以您永远不会得到 EOF（零字节）指示。

如果您真的指的是进程，那么这就是经典 Unix 构建工具的方法的基础。许多标准的 Unix 程序都是过滤器，它们从标准输入中读取，以某种方式对其进行转换，然后将结果写入标准输出。例如，`tr`、`sort`、`grep`和`cat`都是过滤器，仅举几例。当您操作的数据允许时，这是一个很好的范例。并非所有的数据操作都有助于这种方法，但有很多。

> 动机是我可以完全独立地编写和测试每个模块，甚至可以用不同的语言编写它们，或者在不同的机器上运行不同的模块。

好点。请注意，机器之间并没有真正的管道机制，尽管您可以使用诸如`rsh`or (better)之类的程序来接近它`ssh`。然而，在内部，这些程序可能会从管道读取本地数据并将该数据发送到远程机器，但它们通过套接字在机器之间进行通信，而不是使用管道。

> 这里有各种各样的可能性。我已经使用管道一段时间了，但我不熟悉其行为的细微差别。

好的; 提问是一种（好的）学习方式。当然，实验是另一回事。

> 似乎接收端会阻塞等待输入，这是我所期望的，但是发送端有时会阻塞等待某人从流中读取吗？

是的。管道缓冲区的大小是有限制的。传统上，这非常小 - 4096 或 5120 是常见值。您可能会发现现代 Linux 使用了更大的值。您可以使用`fpathconf()`_PC_PIPE_BUF 来找出管道缓冲区的大小。POSIX 只要求缓冲区为 512（即 _POSIX_PIPE_BUF 为 512）。

> 如果我将 eof 写入流，我可以继续写入该流直到我关闭它吗？

从技术上讲，没有办法将 EOF 写入流；您关闭管道描述符以指示 EOF。如果您将 control-D 或 control-Z 视为 EOF 字符，那么就管道而言，它们只是常规字符 - 它们仅在以规范模式运行的终端（熟，或正常）。

> 命名管道和未命名管道的行为是否存在差异？

是的，没有。最大的区别是未命名管道必须由一个进程设置，并且只能由该进程和作为共同祖先共享该进程的子进程使用。相比之下，命名管道可以由以前未关联的进程使用。下一个重大差异是第一个的结果。使用未命名管道，您可以从单个函数（系统）调用返回两个文件描述符，但您使用常规函数`pipe()`打开 FIFO 或命名管道。`open()`（在打开它之前，必须有人使用调用创建一个 FIFO `mkfifo()`；未命名管道不需要任何此类事先设置。）但是，一旦您打开了文件描述符，命名管道和未命名管道之间几乎没有区别。

> 我首先用命名管道打开管道的哪一端有关系吗？

不，第一个打开 FIFO 的进程（通常）会阻塞，直到有一个进程打开另一端。如果您打开它进行读写（非常规但可能），那么您将不会被阻止；如果您使用 O_NONBLOCK 标志，您将不会被阻止。

> 不同 Linux 系统之间管道的行为是否一致？

是的。在我使用过的任何系统上，我都没有听说过或遇到过任何管道问题。

> 管道的行为是否取决于我使用的 shell 或我配置它的方式？

否：管道和 FIFO 独立于您使用的外壳。

> 如果我想以这种方式使用管道，是否还有其他问题我应该问或我应该注意的问题？

请记住，您必须在将要写入的进程中关闭管道的读取端，并在将要读取的进程中关闭管道的写入端。如果要通过管道进行双向通信，请使用两个单独的管道。如果您创建复杂的管道布置，请注意死锁 - 这是可能的。然而，线性管道不会死锁（尽管如果第一个进程从不关闭其输出，则下游进程可能会无限期地等待）。

* * *

我在上面和对其他答案的评论中都观察到管道缓冲区通常仅限于非常小的尺寸。@Charlie Martin 反驳说，某些版本的 Unix 具有动态管道缓冲区，这些缓冲区可能非常大。

我不确定他心中有哪些。我在 Solaris、AIX、HP-UX、MacOS X、Linux 和 Cygwin / Windows XP 上使用了以下测试程序（结果如下）：

```
#include <unistd.h>
#include <signal.h>
#include <stdio.h>
#include <fcntl.h>
#include <stdlib.h>
#include <errno.h>
#include <string.h>

static const char *arg0;

static void err_syserr(char *str)
{
    int errnum = errno;
    fprintf(stderr, "%s: %s - (%d) %s\n", arg0, str, errnum, strerror(errnum));
    exit(1);
}

int main(int argc, char **argv)
{
    int pd[2];
    pid_t kid;
    size_t i = 0;
    char buffer[2] = "a";
    int flags;

    arg0 = argv[0];

    if (pipe(pd) != 0)
        err_syserr("pipe() failed");
    if ((kid = fork()) < 0)
        err_syserr("fork() failed");
    else if (kid == 0)
    {
        close(pd[1]);
        pause();
    }
    /* else */
    close(pd[0]);
    if (fcntl(pd[1], F_GETFL, &flags) == -1)
        err_syserr("fcntl(F_GETFL) failed");
    flags |= O_NONBLOCK;
    if (fcntl(pd[1], F_SETFL, &flags) == -1)
        err_syserr("fcntl(F_SETFL) failed");
    while (write(pd[1], buffer, sizeof(buffer)-1) == sizeof(buffer)-1)
    {
        putchar('.');
        if (++i % 50 ==  0)
            printf("%u\n", (unsigned)i);
    }
    if (i % 50 !=  0)
        printf("%u\n", (unsigned)i);
    kill(kid, SIGINT);
    return 0;
} 
```

我很想从其他平台获得额外的结果。这是我找到的尺寸。我必须承认，所有结果都比我预期的要大，但是当谈到缓冲区大小时，查理和我可能正在争论“相当大”的含义。

*   8196 - 适用于 IA-64 的 HP-UX 11.23（fcntl(F_SETFL) 失败）
*   16384 - 索拉里斯 10
*   16384 - MacOS X 10.5（O_NONBLOCK 不起作用，尽管 fcntl(F_SETFL) 没有失败）
*   32768 - AIX 5.3
*   65536 - Cygwin / Windows XP（O_NONBLOCK 不起作用，尽管 fcntl(F_SETFL) 没有失败）
*   65536 - SuSE Linux 10（和 CentOS）（fcntl(F_SETFL) 失败）

*从这些测试中清楚的一点是，O_NONBLOCK 在某些平台上与管道一起工作，而在其他平台上则不工作。*

该程序创建一个管道和分叉。孩子关闭管道的写入端，然后进入睡眠状态，直到它收到信号——这就是 pause() 所做的。然后父级关闭管道的读取端，并在写入描述符上设置标志，这样它就不会在尝试在完整管道上写入时阻塞。然后它循环，一次写一个字符，为每个写的字符打印一个点，每 50 个字符打印一个计数和换行符。当它检测到写入问题（缓冲区已满，因为孩子没有读东西）时，它会停止循环，写入最终计数并杀死孩子。

# c# - 这里的每个人都在跳上 ORM 乐队的马车吗？

> ID：363222
> 
> 赞同：13
> 
> 时间：2008-12-12T16:18:29.593
> 
> 标签：c#, .net, nhibernate, linq-to-sql, orm

Microsoft Linq to SQL、实体框架（EF）和nHibernate等都在提出ORMS作为下一代数据映射技术，并声称轻量级、快速和简单。比如这篇刚刚在 VS 杂志上发表的文章：

[http://visualstudiomagazine.com/features/article.aspx?editorialsid=2583](http://visualstudiomagazine.com/features/article.aspx?editorialsid=2583)

谁对在他们的项目中实施这些技术感到兴奋？这些技术的创新之处在哪里，使它们比他们的前辈如此出色？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-12T22:59:57.333

多年来，我在数百个应用程序中编写了数据访问层、持久性组件，甚至是我自己的 ORM（我的“爱好”之一）；我什至实现了我自己的业务事务管理器（在其他地方讨论过 SO）。

ORM 工具已经在其他平台上出现了很长时间，例如 Java、Python 等。现在以微软为中心的团队已经发现了它们，这似乎是一种新的时尚。总的来说，我认为这是一件好事——这是探索和理解似乎随着 .NET 的到来而引入的架构和设计概念的必要步骤。

底线：我总是更喜欢自己进行数据访问，而不是与一些试图“帮助”我的工具作斗争。放弃对自己命运的控制是绝对不能接受的，而数据访问是我的应用程序命运的关键部分。一些简单的原则使数据访问非常易于管理。

使用模块化、抽象和封装的基本概念——因此将平台的基本数据访问 API（例如，ADO.NET）包装在您自己的层中，从而提高抽象级别更接近您的问题空间。不要直接针对该 API 对所有数据访问进行编码（也在 SO 的其他地方讨论）。

严格应用 DRY（不要重复自己）原则 = 从数据访问代码中重构白天。在适当的时候使用代码生成作为重构的一种手段，但要尽可能地消除对代码生成的需求。通常，代码生成表明您的环境中缺少某些东西——语言缺陷、内置工具限制等。

同时，学会很好地使用可用的 API，尤其是在性能和​​健壮性方面，然后将这些经验整合到您自己的抽象数据访问层中。例如，学习在 SQL 中正确使用参数，而不是将文字值嵌入 SQL 字符串中。

最后，请记住，任何成功的应用程序/系统都会遇到性能问题。解决性能问题更多地依赖于设计它们，而不是仅仅在实现中“调整”某些东西。该设计工作将影响数据库和应用程序，它们必须同步更改。因此，寻求能够轻松（敏捷）地进行此类更改，而不是试图避免更改应用程序本身。在某种程度上，这最终意味着能够在不停机的情况下部署更改。如果您不“设计”远离它，这并不难做到。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-12T16:30:07.713

我是一个巨大的 ORM 倡导者。使用 ORM 生成代码为我们的大多数项目节省了大约 20-30% 的成本。

我们做合同开发，所以这是一个很大的胜利。

Chris Lively 提出了一个有趣的观点，即每次查询被触及时都必须进行重新部署。这对某些人来说可能是个问题，但它根本不会触动我们。我们有禁止直接更改生产数据库的规则。

此外，您仍然可以在适当的时候依赖传统的存储过程甚至视图......我们不是教条式的 100% ORM，这是肯定的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-12T16:27:46.907

从免费版的 LLBLGen 到最新最好的商业产品 LLBLGen Pro，我在 ORM 列车上的时间最长。我认为 ORM 非常适合许多常见的数据输入输出系统。

然而，这并不是说他们解决了所有问题。它是一种可以在有意义的地方使用的工具。如果您的数据库模式相对接近您的业务对象需要的方式，那么 ORM 是最好的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-16T05:33:07.253

这不是赶潮流，而是对实际问题的反应！对象关系映射 (ORM) 已经存在了很长时间，它解决了一个实际问题。

最初的面向对象（OO）语言都是关于使用计算机语言模拟现实世界的问题。有人可能会说，如果您真的使用 OO 语言来构建系统，那么您将使用领域驱动设计 (DDD) 来模拟现实世界的问题领域。从逻辑上讲，这会将您带到关注点分离模型，以使您的 DDD 保持整洁，远离所有混乱的数据持久性和应用程序控制。

当您按照 DDD 模式构建系统并使用关系数据库进行持久化时，您确实需要一个好的 ORM，否则您将花费​​太多时间来构建和维护数据库 crud（双关语）。

ORM 是一个老问题，几年前就被 Object Lens 和 Top Link 等产品解决了。Object Lens 是 ParkPlace 在 90 年代构建的 Smalltalk ORM。Top Link 由 Object People 为 Smalltalk 构建，然后转换为 Java，目前由 Oracle 使用。自 90 年代以来，Top Link 也一直存在。DDD 倡导者现在开始清楚地阐明 DDD 的案例并获得思想份额。因此，ORM 必然会成为主流，而微软只是像往常一样做出反应。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-12T16:24:03.513

不，不是每个人都是。

这是使用大多数 ORM 工具（尤其是 LINQ to SQL）的房间里头号大笨象：

您保证任何与数据相关的更改都需要完全重新部署您的应用程序。

例如，我的日常工作目前可以通过修改现有的存储过程并重新部署那个部分来解决大多数查询问题。使用 Linq 等，您的数据查询被移动到您的实际代码中。猜猜这意味着什么？

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-12T18:22:21.497

ORM 非常适合那些与为他们编写软件的软件相处得很好的人；但是如果你对控制正在发生的事情和原因很着迷，ORM 可能不是最理想的，尤其是在数据库优化方面。任何抽象层都有成本和收益；ORM 两者都有，但恕我直言，平衡还不正确。讽刺的是，ORM 在其当前形式中添加了一个抽象层，仍然将类和未抽象的数据库模式紧密地放在一起。

我的经验是，它可以帮助您快速获得概念验证版本，但可以引入您可能不熟悉的重构要求（至少目前如此）。

除此之外，该工具正在发展，最佳实践和模式还没有很好地建立，也没有让其他程序员（或未来的程序员）对您的代码感到满意的那种共识。所以我希望在一段时间内看到高于平常的重构要求。

我将保留判断（乐观地）关于它将在哪里成为主流。在这一点上，我不会打赌当前的项目。我处理阻抗失配的模式对我的目的来说是令人满意的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-12T18:13:41.733

一旦你想做除了最简单的选择、更新或删除之外的任何事情，你就必须与 ORM 系统作斗争。一旦你开始做真正的事情，你的表现就会进入厕所。

所以不行。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-16T05:52:19.337

我期待着我的团队开始研究 ORM 解决方案的那一天。直到那一天，我们还是一个纯粹的数据集/存储过程商店，让我告诉你，并不是所有的饼干和肉汁都是“纯粹的”。

首先，新的 Linq to SQL 的性能接近于存储过程和数据读取器的性能。我们在任何地方都使用数据集，因此性能会有所提高。到目前为止，对 ORM 来说还不错。

其次，存储过程具有与代码分开发布的额外好处，但它们也有与代码分开发布的不利之处。假设您有一个数据库，其中有超过 5 个系统连接到它，并且有超过 10 个人在使用它。现在考虑管理所有这些存储过程的更改和依赖关系，尤其是在有公共代码库的情况下。这是一场噩梦……

第三，很难调试存储过程。它们经常由于多种原因导致错误行为。这并不是说ORM生成的动态sql不会产生同样的结果，而是少一个问题就是少一个问题。没有权限问题（虽然大部分在 SQL 2005 中得到解决），没有更多的多步骤开发。编写查询、测试查询、部署查询、将其绑定到代码中、测试代码、部署代码。查询是代码的一部分，我认为这是一件好事。

第四，你仍然可以使用存储过程。运行一些需要很长时间的报告？存储过程是一个更好的解决方案。为什么？查询执行计划可以由数据库引擎优化。我不会假装了解数据库的所有工作原理，但我知道目前优化动态 sql 存在一些限制，这是我们在使用 ORM 时所做的权衡。但是，在使用 ORM 解决方案时不排除存储过程。

我看到人们避免使用 ORM 的最大原因是他们根本没有使用 ORM 的经验。会有一个明显的学习曲线和无知阶段。但是，如果它要提高开发性能并且几乎不妨碍（或在我的情况下提高）性能。这是一个值得做出的权衡。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-12T16:40:38.753

我也是一个忠实的粉丝，使用 EF 和 Linq-to-SQL。我的理由是：

由于 LINQ 已编译且类型安全，因此您不会遇到“基于字符串”的 SQL 中的拼写错误问题。我不知道我花了多少时间来追踪 SP 或其他 SQL 中的错误，其中“tick”或其他关键字位于错误的位置。

上述及其他因素使发展更快。

尽管与“更接近金属”的数据库查询方法相比肯定存在开销，但如果性能是我们的第一个关注点，我们根本不会使用 .NET，甚至不会使用 C++。对于*大多数*应用程序，我已经能够从 Linq-To-SQL 获得出色的性能，即使不使用存储过程方法（基于客户端的编译查询是我常用的方法）。

当然，对于某些应用程序，您仍然希望以老式的方式做事。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-12T17:05:49.357

我想我的意思是，ORM 在使用传统的 ADO.NET、SQL 构建 DAL 并将它们映射到代码中的对象方面提供了哪些创新？

以下是我的 DAL 的三个主要部分，我正在与 ORM 进行比较以了解其好处：

1.  您仍然必须在 ORM = SQL 中进行查询（到目前为止，SQL 更强大）

2.  映射代码移至配置，但仍未消除，只是从一种范式转移到另一种范式

3.  对象的定义和管理必须与您的数据模式紧密相关，这与我可以将它们解耦的传统方法不同。

我错过了什么吗？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-12T16:31:29.583

我一直在密切关注 Fluent-NHibernate，因为它具有我在项目中见过的最具潜力的一些。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-12T16:35:55.143

我是一个 ORM 大佬，从数据库中获取逻辑，只为速度而使用数据库。

我喜欢你开发应用程序的速度。根据 ORM 的不同，最大的优势是您可以更改后端而无需转换您的业务逻辑。

我切换到 LINQ 并且从未回头。 [DBLinq](http://code.google.com/p/dblinq2007/downloads/list)非常适合做 MSSQL 以外的其他数据库。我已经将它与我的 SQL 一起使用，它很棒。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-12T16:39:59.800

还没有，仍然持怀疑态度；像大多数 Microsoft 产品一样，我等待 SP2 或一年半之后才在产品环境中信任它们

请注意，几乎任何人（不仅仅是微软）推出的每一个新事物都被誉为“轻量级、快速和简单”——用一块盐来看待它。他们不会像好处/功能那样大声宣传问题/问题！这就是我们等待早期采用者发现它们的原因。

这并不是贬低 ORM 或 LINQ 或类似的东西。我保留判断直到

*   我有时间评估它们，
*   出现了一些只有他们才能满足的需要，
*   该技术看起来稳定且支持良好，足以在我的一个客户的生产环境中冒险，和/或
*   客户要求它

请注意：我以前手动完成过 ORM，它工作得很好，所以我对更新的 ORM 系统寄予厚望。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-12T17:36:21.947

> 如果 codesmith 基于您的表生成代码，您是否仍然与您的数据模式紧密耦合？我更喜欢将我的对象与我的数据库模式分离的解决方案，以提高架构的灵活性

这来自您的一条评论 - 确实，CodeSmith 将您与您的桌子紧密结合在一起。

另一方面，NHibernate 有许多可以帮助解决此问题的功能：您拥有组件，因此在代码中您可以拥有：具有属性 Address 的 Person，其中 Address 是一个单独的类。

你也[继承映射](http://www.hibernate.org/hib_docs/nhibernate/html/inheritance.html)。因此，它可以将您的架构与您的域分离。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-12T17:44:46.907

在我工作的地方，我们仍然使用手卷、重复的剪切粘贴 DAL。这是极其痛苦、复杂且容易出错的，但这是所有开发人员都能理解的。虽然它目前对我们有用，但我不推荐它，因为它在大型项目中开始迅速崩溃。如果有人不想使用成熟的 ORM，我至少会提倡某种 DAL 生成。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-12T18:53:52.337

我实际上正在编写一个 .NET 中的 ORM 工具，作为一个让我开心的项目。

SQL对我来说已经死了。我讨厌写它，尤其是在我的代码中的任何地方。为每个对象手动编写选择/插入/更新/删除查询是浪费时间 IMO。在动态生成查询时，甚至不要让我开始处理 NULL（“where col_1 = ？”与“where col_1 is null”）。ORM 工具可以为我处理。

此外，拥有一个可以动态生成 SQL 的地方有望长期消除 SQL 注入攻击。

另一方面，我使用过 Hibernate，我非常讨厌它。在一个真实的项目中，我们每隔几周就会遇到限制、未实现的位和错误。

保留查询逻辑 DB 端（通常作为视图或存储过程）还具有可供 DBA 调整的好处。那是我上一份工作中的一场持久战，使用 Hibernate。DBA：“给我们所有可能的查询，以便我们调整” Devs：“嗯，我不知道，因为 Hibernate 会即时生成它们。不过我可以给你一些 HQL 和 XML 映射！” DBA：“别让我打你的脸！”

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-12T19:08:08.330

我不喜欢大多数 ORM 中使用的代码生成。事实上，总的来说，我发现代码生成是一个弱工具，通常首先表明使用了错误的语言。

特别是对于 .Net 反射，我认为对于 ORM 目的不需要代码生成。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-12-14T18:30:54.610

这是[一个强烈的意见](http://ayende.com/Blog/archive/2008/11/21/stealing-from-your-client.aspx)。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-12-21T20:41:20.517

不，我抛弃了 ORM，转而使用 smalltalk 和 OODB：Gemstone。更好的代码，更少的代码，更快的开发。

# bash - 如何让 STDOUT 和 STDERR 都进入终端和日志文件？

> ID：363223
> 
> 赞同：140
> 
> 时间：2008-12-12T16:18:30.933
> 
> 标签：bash, logging, shell

我有一个脚本，将由非技术用户以交互方式运行。该脚本将状态更新写入 STDOUT，以便用户可以确定该脚本运行正常。

我希望将 STDOUT 和 STDERR 都重定向到终端（以便用户可以看到脚本正在运行以及查看是否存在问题）。我还希望将两个流都重定向到日志文件。

我在网上看到了很多解决方案。有些不起作用，有些则非常复杂。我开发了一个可行的解决方案（我将作为答案输入），但它很笨拙。

完美的解决方案是一行代码，可以合并到任何脚本的开头，将两个流发送到终端和日志文件。

**编辑：**将 STDERR 重定向到 STDOUT 并将结果通过管道传输到 tee 工作，但这取决于用户记住重定向和管道输出。我希望日志记录是万无一失的和自动的（这就是为什么我希望能够将解决方案嵌入到脚本本身中。）

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2008-12-12T16:21:29.807

使用“tee”重定向到文件和屏幕。根据您使用的外壳，您首先必须使用将 stderr 重定向到 stdout

```
./a.out 2>&1 | tee output 
```

或者

```
./a.out |& tee output 
```

在 csh 中，有一个名为“script”的内置命令，它会将进入屏幕的所有内容捕获到文件中。您可以通过键入“脚本”来启动它，然后执行您想要捕获的任何操作，然后按 control-D 关闭脚本文件。我不知道 sh/bash/ksh 的等价物。

此外，由于您已经指出这些是您自己可以修改的 sh 脚本，因此您可以通过用大括号或方括号将整个脚本括起来在内部进行重定向，例如

```
 #!/bin/sh
  {
    ... whatever you had in your script before
  } 2>&1 | tee output.file 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-04-03T17:42:00.740

将近五年后...

我相信这是OP寻求的“完美解决方案”。

这是您可以添加到 Bash 脚本顶部的一个衬里：

```
exec > >(tee -a $HOME/logfile) 2>&1 
```

这是一个演示其用法的小脚本：

```
#!/usr/bin/env bash

exec > >(tee -a $HOME/logfile) 2>&1

# Test redirection of STDOUT
echo test_stdout

# Test redirection of STDERR
ls test_stderr___this_file_does_not_exist 
```

（注意：这只适用于 Bash。它**不适**用于 /bin/sh。）

改编自[这里](https://github.com/medined/accumulo_stackscript/blob/master/setup.sh)；据我所知，原始文件没有在日志文件中捕获 STDERR。[使用此处](http://www.linuxjournal.com/content/bash-redirections-using-exec)的注释进行了修复。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2018-10-29T18:15:13.783

### 模式

```
the_cmd 1> >(tee stdout.txt ) 2> >(tee stderr.txt >&2 ) 
```

这会分别重定向 stdout 和 stderr，并将stdout 和 stderr 的*单独*副本发送给调用者（可能是您的终端）。

*   `tee`在 zsh 中，在s 完成之前，它不会继续执行下一条语句。

*   在 bash 中，您可能会发现最后几行输出出现*在*接下来的任何语句之后。

在任何一种情况下，正确的位都会到达正确的位置。

* * *

### 解释

这是一个脚本（存储在 ./example 中）：

```
#! /usr/bin/env bash
the_cmd()
{
    echo out;
    1>&2 echo err;
}

the_cmd 1> >(tee stdout.txt ) 2> >(tee stderr.txt >&2 ) 
```

这是一个会话：

```
$ foo=$(./example)
    err

$ echo $foo
    out

$ cat stdout.txt
    out

$ cat stderr.txt
    err 
```

以下是它的工作原理：

1.  两个`tee`进程都被启动，它们的标准输入被分配给文件描述符。因为它们包含在[进程替换](http://tldp.org/LDP/abs/html/process-sub.html)中，所以这些文件描述符的路径在调用命令中被替换，所以现在看起来像这样：

`the_cmd 1> /proc/self/fd/13 2> /proc/self/fd/14`

2.  `the_cmd`运行，将 stdout 写入第一个文件描述符，将 stderr 写入第二个文件描述符。

3.  在 bash 情况下，一旦`the_cmd`完成，以下语句会立即发生（如果您的终端是调用者，那么您将看到您的提示出现）。

4.  在 zsh 的情况下，一旦`the_cmd`完成，shell 会等待两个`tee`进程都完成，然后再继续。更多关于这个[here](https://unix.stackexchange.com/a/558315/146169)。

5.  第一个`tee`进程从 的标准输出中读取数据`the_cmd`，将标准输出的副本写回调用者，因为这就是这样`tee`做的。它的输出没有被重定向，所以它们原封不动地返回给调用者

6.  第二个`tee`进程将其`stdout`重定向到调用者的`stderr`（这很好，因为它的标准输入是从标准错误中读取`the_cmd`的）。因此，当它写入其标准输出时，这些位将进入调用者的标准错误。

这使文件和命令输出中的 stderr 与 stdout 分开。

如果第一个 tee 写入任何错误，它们将显示在 stderr 文件和命令的 stderr 中，如果第二个 tee 写入任何错误，它们只会显示在终端的 stderr 中。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-12T16:26:05.273

将 stderr 重定向到 stdout 在您的命令中附加以下内容：`2>&1` 对于输出到终端和登录到文件，您应该使用`tee`

两者一起看起来像这样：

```
 mycommand 2>&1 | tee mylogfile.log 
```

编辑：要嵌入到您的脚本中，您也会这样做。所以你的脚本

```
#!/bin/sh
whatever1
whatever2
...
whatever3 
```

最终会成为

```
#!/bin/sh
( whatever1
whatever2
...
whatever3 ) 2>&1 | tee mylogfile.log 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-12-21T09:56:26.760

编辑：我看到我出轨了，最后回答了一个与被问者不同的问题。真正问题的答案在 Paul Tomblin 答案的底部。（如果您出于某种原因想要增强该解决方案以分别重定向 stdout 和 stderr，您可以使用我在此处描述的技术。）

* * *

我一直想要一个保留stdout和stderr之间区别的答案。不幸的是，迄今为止给出的所有保留这种区别的答案都是种族倾向的：正如我在评论中指出的那样，它们冒着程序看到不完整输入的风险。

我想我终于找到了一个保留区别的答案，不喜欢种族，也不是非常繁琐。

第一个构建块：交换标准输出和标准错误：

```
my_command 3>&1 1>&2 2>&3- 
```

第二个构建块：如果我们只想过滤（例如 tee）stderr，我们可以通过交换 stdout&stderr、过滤然后交换回来来实现：

```
{ my_command 3>&1 1>&2 2>&3- | stderr_filter;} 3>&1 1>&2 2>&3- 
```

现在剩下的很简单：我们可以在开头添加一个标准输出过滤器：

```
{ { my_command | stdout_filter;} 3>&1 1>&2 2>&3- | stderr_filter;} 3>&1 1>&2 2>&3- 
```

或最后：

```
{ my_command 3>&1 1>&2 2>&3- | stderr_filter;} 3>&1 1>&2 2>&3- | stdout_filter 
```

为了说服自己上述两个命令都有效，我使用了以下命令：

```
alias my_command='{ echo "to stdout"; echo "to stderr" >&2;}'
alias stdout_filter='{ sleep 1; sed -u "s/^/teed stdout: /" | tee stdout.txt;}'
alias stderr_filter='{ sleep 2; sed -u "s/^/teed stderr: /" | tee stderr.txt;}' 
```

输出是：

```
...(1 second pause)...
teed stdout: to stdout
...(another 1 second pause)...
teed stderr: to stderr 
```

`teed stderr: to stderr`正如预期的那样，我的提示在“”之后立即返回。

**关于 zsh 的脚注**：

上述解决方案适用于 bash（也许还有其他一些 shell，我不确定），但它不适用于 zsh。在 zsh 中失败有两个原因：

1.  `2>&3-`zsh 不理解该语法；必须重写为`2>&3 3>&-`
2.  在 zsh 中（不像其他 shell），如果你重定向一个已经打开的文件描述符，在某些情况下（我不完全理解它是如何决定的）它会做一个内置的类似 tee 的行为。为避免这种情况，您必须在重定向之前关闭每个 fd。

因此，例如，我的第二个解决方案必须为 zsh 重写为`{my_command 3>&1 1>&- 1>&2 2>&- 2>&3 3>&- | stderr_filter;} 3>&1 1>&- 1>&2 2>&- 2>&3 3>&- | stdout_filter`（它也适用于 bash，但非常冗长）。

另一方面，您可以利用 zsh 神秘的内置隐式 teeing 来获得更短的 zsh 解决方案，它根本不运行 tee：

```
my_command >&1 >stdout.txt 2>&2 2>stderr.txt 
```

（我不会从我发现的文档中猜到`>&1`and`2>&2`是触发 zsh 隐式发球的东西；我通过反复试验发现了这一点。）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-12T16:22:18.680

使用 tee 程序并将 stderr 复制到 stdout。

```
 program 2>&1 | tee > logfile 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-12T17:10:33.873

在脚本中使用`script`命令（man 1 脚本）

创建一个设置 script() 然后调用 exit 的包装器 shellscript（2 行）。

第 1 部分：wrap.sh

```
#!/bin/sh
script -c './realscript.sh'
exit 
```

第 2 部分：realscript.sh

```
#!/bin/sh
echo 'Output' 
```

结果：

```
~: sh wrap.sh 
Script started, file is typescript
Output
Script done, file is typescript
~: cat typescript 
Script started on fr. 12\. des. 2008 kl. 18.07 +0100
Output

Script done on fr. 12\. des. 2008 kl. 18.07 +0100
~: 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-12T16:22:33.470

我创建了一个名为“RunScript.sh”的脚本。这个脚本的内容是：

```
${APP_HOME}/${1}.sh ${2} ${3} ${4} ${5} ${6} 2>&1 | tee -a ${APP_HOME}/${1}.log 
```

我这样称呼它：

```
./RunScript.sh ScriptToRun Param1 Param2 Param3 ... 
```

这可行，但它需要应用程序的脚本通过外部脚本运行。这有点笨拙。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-11-13T12:01:12.800

一年后，这是一个用于记录任何内容的旧 bash 脚本。例如，
`teelog make ...`记录到生成的日志名称（也请参阅记录嵌套`make`s 的技巧。）

```
#!/bin/bash
me=teelog
Version="2008-10-9 oct denis-bz"

Help() {
cat <<!

    $me anycommand args ...

logs the output of "anycommand ..." as well as displaying it on the screen,
by running
    anycommand args ... 2>&1 | tee `day`-command-args.log

That is, stdout and stderr go to both the screen, and to a log file.
(The Unix "tee" command is named after "T" pipe fittings, 1 in -> 2 out;
see http://en.wikipedia.org/wiki/Tee_(command) ).

The default log file name is made up from "command" and all the "args":
    $me cmd -opt dir/file  logs to `day`-cmd--opt-file.log .
To log to xx.log instead, either export log=xx.log or
    $me log=xx.log cmd ...
If "logdir" is set, logs are put in that directory, which must exist.
An old xx.log is moved to /tmp/\$USER-xx.log .

The log file has a header like
    # from: command args ...
    # run: date pwd etc.
to show what was run; see "From" in this file.

Called as "Log" (ln -s $me Log), Log anycommand ... logs to a file:
    command args ... > `day`-command-args.log
and tees stderr to both the log file and the terminal -- bash only.

Some commands that prompt for input from the console, such as a password,
don't prompt if they "| tee"; you can only type ahead, carefully.

To log all "make" s, including nested ones like
    cd dir1; \$(MAKE)
    cd dir2; \$(MAKE)
    ...
export MAKE="$me make"

!
  # See also: output logging in screen(1).
    exit 1
}

#-------------------------------------------------------------------------------
# bzutil.sh  denisbz may2008 --

day() {  # 30mar, 3mar
    /bin/date +%e%h  |  tr '[A-Z]' '[a-z]'  |  tr -d ' '
}

edate() {  # 19 May 2008 15:56
    echo `/bin/date "+%e %h %Y %H:%M"`
}

From() {  # header  # from: $*  # run: date pwd ...
    case `uname` in Darwin )
        mac=" mac `sw_vers -productVersion`"
    esac
    cut -c -200 <<!
${comment-#} from: $@
${comment-#} run: `edate`  in $PWD `uname -n` $mac `arch` 

!
    # mac $PWD is pwd -L not -P real
}

    # log name: day-args*.log, change this if you like --
logfilename() {
    log=`day`
    [[ $1 == "sudo" ]]  &&  shift
    for arg
    do
        log="$log-${arg##*/}"  # basename
        (( ${#log} >= 100 ))  &&  break  # max len 100
    done
            # no blanks etc in logfilename please, tr them to "-"
    echo $logdir/` echo "$log".log  |  tr -C '.:+=[:alnum:]_\n' - `
}

#-------------------------------------------------------------------------------
case "$1" in
-v* | --v* )
    echo "$0 version: $Version"
    exit 1 ;;
"" | -* )
    Help
esac

    # scan log= etc --
while [[ $1 == [a-zA-Z_]*=* ]]; do
    export "$1"
    shift
done

: ${logdir=.}
[[ -w $logdir ]] || {
    echo >&2 "error: $me: can't write in logdir $logdir"
    exit 1
    }
: ${log=` logfilename "$@" `}
[[ -f $log ]]  &&
    /bin/mv "$log" "/tmp/$USER-${log##*/}"

case ${0##*/} in  # basename
log | Log )  # both to log, stderr to caller's stderr too --
{
    From "$@"
    "$@"
} > $log  2> >(tee /dev/stderr)  # bash only
    # see http://wooledge.org:8000/BashFAQ 47, stderr to a pipe
;;

* )
#-------------------------------------------------------------------------------
{
    From "$@"  # header: from ... date pwd etc.

    "$@"  2>&1  # run the cmd with stderr and stdout both to the log

} | tee $log
    # mac tee buffers stdout ?

esac 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-06-11T02:28:40.570

这个问题似乎还没有被优雅地解决。每次我搜索“如何同时输出到标准输出和标准错误”时，谷歌都会将我引导到这篇文章。

今天，我终于找到了一种简单有效的方法来解决几乎所有这些需求。

基本思想是可以同时打印到多个输出的 tee 命令，以及特定于 linux 的 /proc/self/fd/{1,2,...} 来表示 stdout、stderr...

*   将标准输入打印到标准输出和标准错误

```
tee /proc/self/fd/2 
```

*   将标准输入打印到标准输出和标准错误，并归档

```
tee /proc/self/fd/2 file 
```

希望这会有所帮助。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2021-01-15T15:01:37.607

通过结合“kvantour, MatrixManAtYrService”和“Jason Sydes”的解决方案，这是一个通过重定向为 bash 工作的解决方案：

```
#!/bin/bash
exec 1> >(tee x.log) 2> >(tee x.err >&2)

echo "test for log"
echo "test for err" 1>&2 
```

将上面的脚本另存为 x.sh。运行 ./x.sh 后，x.log 只包含标准输出，而 x.err 只包含标准错误。

# django - 如何最好地集成 Flex 和 Django？

> ID：363224
> 
> 赞同：4
> 
> 时间：2008-12-12T16:18:36.037
> 
> 标签：django, apache-flex, ria

我正在构建一个带有 Flex 前端和 Django 后端的站点。

我面临的问题是为每个模型编写一个 CRUD 前端很乏味。

我已经检查了[django-rest-interface](http://code.google.com/p/django-rest-interface/)，但除了读取/GET（即创建/POST、更新/PUT、删除/删除）之外的其他任何操作并不明显，并且找不到任何相关示例。

我问这个问题的通常答案是“使用 AMF”，但我想学习的是如何实际进行接口，而不是协议格式。

那么，最重要的是，集成 Flex 和 Django 的最佳实践和最简单的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-15T06:48:31.267

@Matt Briggs，DjangoAMF 教程不够清晰，我无法在那里取得进展。

我终于掌握了[如何使用 PyAMF](http://www.pyamf.org/wiki/DjangoHowto)，到目前为止，一切都很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T16:29:58.417

问一个正在这样做的朋友，他说他使用[DjangoAMF](http://djangoamf.sourceforge.jp/index.php?UserManual_en)库

# asp.net - asp.net、url 重写模块和 web.config

> ID：363231
> 
> 赞同：31
> 
> 时间：2008-12-12T16:20:08.560
> 
> 标签：asp.net, url, web-config, module, rewrite

我在 IIS7 (Vista) 上使用带有 .NET 3.5 的 ASP.net 和 Microsoft 的 URL 重写模块。

这意味着，我有一个

```
<system.webServer>
    <rewrite>...</rewrite>
    ...
</system.webServer> 
```

web.config 中的部分，但我收到警告，在 system.webServer 中不允许元素“重写”。

我如何配置我的系统以允许（甚至可能有 Intellisense）在 web.config 的重写部分？

谢谢克里斯托夫

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2010-08-15T03:29:49.030

我能够在 Visual Studio 2010 中使用它。

从 Ruslan 的帖子[开始](http://ruslany.net/2010/04/visual-studio-xml-intellisense-for-url-rewrite-2-0/)，下载 2.0 IntelliSense 文件。然后，只需按照他之前[在此处](http://ruslany.net/2009/08/visual-studio-xml-intellisense-for-url-rewrite-1-1/)发布的指示进行操作即可。我最终所做的只是按照 Ruslan 的指示运行以下命令：

`C:\download_directory\rewrite2_intellisense>cscript UpdateSchemaCache.js`

正如 Christoph 在他的评论中指出的那样，如果您使用的是 Visual Studio 2010，请确保在运行上述命令之前替换为 UpdateSchemaCache.js `VS90COMNTOOLS`。`VS100COMNTOOLS`

I did not need to restart Visual Studio. I added the `<rewrite>` section only to the applicable Web.config transformation files, as having it in the main Web.config breaks local debugging.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T20:32:23.407

我相信您需要在系统的 web.config 文件中“安装” URL 重写模块。

您需要通过 IIS 7.0 界面在应用程序上安装该模块，或者让您的托管公司为您安装。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-28T19:26:13.520

~~我相信您需要像这样在 web.config 中定义模块：~~

 ~~```
<system.webServer>
    <modules>
        <add name="UrlRewriteModule" type="UrlRewritingNet.Web.UrlRewriteModule, UrlRewritingNet.UrlRewriter" />
    </modules>
</system.webServer> 
```~~ 

~~更新：Intellisense 可以在这里设置：~~

 ~~[http://ruslany.net/2009/08/visual-studio-xml-intellisense-for-url-rewrite-1-1/](http://ruslany.net/2009/08/visual-studio-xml-intellisense-for-url-rewrite-1-1/)

更新：验证 sectionGroup 是否在 %systemroot%\system32\inetsrv\config\applicationHost.config 中标识：

```
<sectionGroup name="rewrite">
    <section name="rules" overrideModeDefault="Allow" />
    <section name="globalRules" overrideModeDefault="Deny" allowDefinition="AppHostOnly" />
    <section name="rewriteMaps" overrideModeDefault="Allow" />
</sectionGroup> 
```

# asp.net-mvc - 没有 ViewContext 的 URL 表单操作

> ID：363234
> 
> 赞同：3
> 
> 时间：2008-12-12T16:21:08.247
> 
> 标签：asp.net-mvc, url, routes

是否可以在不知道 ViewContext（例如，在控制器中）的情况下从操作中获取 URL？像这样的东西：

```
LinkBuilder.BuildUrlFromExpression(ViewContext context, Expression<Action<T>> action) 
```

...但使用 Controller.RouteData 而不是 ViewContext。我似乎在这上面有金属块。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T16:32:26.040

这是我在单元测试中的做法：

```
 private string RouteValueDictionaryToUrl(RouteValueDictionary rvd)
    {
        var context = MvcMockHelpers.FakeHttpContext("~/");
        // _routes is a RouteCollection
        var vpd = _routes.GetVirtualPath(
            new RequestContext(context, _
                routes.GetRouteData(context)), rvd);
        return vpd.VirtualPath;
    } 
```

根据评论，我将适应控制器：

```
string path = RouteTable.Routes.GetVirtualPath(
    new RequestContext(HttpContext, 
        RouteTable.Routes.GetRouteData(HttpContext)),
    new RouteValueDictionary( 
        new { controller = "Foo",
              action = "Bar" })).VirtualPath; 
```

用真实姓名替换“Foo”和“Bar”。这不是我的想法，所以我不能保证它是最有效的解决方案，但它应该让你走上正确的轨道。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-13T17:34:25.613

克雷格，感谢您的正确答案。它工作得很好，它也让我思考。因此，在我消除那些抗重构的“魔术字符串”的过程中，我对您的解决方案开发了一个变体：

```
public static string GetUrlFor<T>(this HttpContextBase c, Expression<Func<T, object>> action)
    where T : Controller
{
    return RouteTable.Routes.GetVirtualPath(
        new RequestContext(c, RouteTable.Routes.GetRouteData(c)), 
        GetRouteValuesFor(action)).VirtualPath;
}

public static RouteValueDictionary GetRouteValuesFor<T>(Expression<Func<T, object>> action) 
    where T : Controller
{
    var methodCallExpresion = ((MethodCallExpression) action.Body);
    var controllerTypeName = methodCallExpresion.Object.Type.Name;
    var routeValues = new RouteValueDictionary(new
    {
        controller = controllerTypeName.Remove(controllerTypeName.LastIndexOf("Controller")), 
        action = methodCallExpresion.Method.Name
    });
    var methodParameters = methodCallExpresion.Method.GetParameters();
    for (var i = 0; i < methodParameters.Length; i++)
    {
        var value = Expression.Lambda(methodCallExpresion.Arguments[i]).Compile().DynamicInvoke();
        var name = methodParameters[i].Name;
        routeValues.Add(name, value);
    }
    return routeValues;
} 
```

我知道有些人会说……可怕的反思！在我的特定应用程序中，我认为可维护性的好处超过了性能问题。我欢迎任何关于这个想法和代码的反馈。

# asp.net - 如何处理保存为用户控件属性的对象中的事件？

> ID：363235
> 
> 赞同：0
> 
> 时间：2008-12-12T16:21:10.477
> 
> 标签：asp.net, events

我有一个包含用户控件的 aspx 页面。用户控件显示一个业务对象并允许用户编辑该对象。用户控件具有保存正在显示的对象的属性。

```
Public Property Item() As Widget       
    Get
        If ViewState("Item") IsNot Nothing Then
            Return DirectCast(ViewState("Item"), Widget)
        End If
        Return Nothing
    End Get
    Private Set(ByVal value As Widget)
        ViewState("Item") = value
    End Set
End Property 
```

我最近向 Widgets 添加了一项新功能，以便它在某些情况下引发事件。我想在我的用户控件中处理该事件。

如何将处理程序连接到属性？ **Protected Sub WidgetHandler(ByVal sender as Object, ByVal e as WidgetEventArgs) 处理 Me.Item.WidgetEvent**不起作用。它会引发一个序列化错误，指示用户控件不可序列化。Widgets 和 WidgetEventArgs 被标记为 Serializable。我尝试了**Protected WithEvents myItem As Widget**，将处理程序声明更改为 **...Handles myItem.WidgetEvent**，并将**myItem = value**添加到 Item Setter，但这没有任何区别。我也尝试在 setter 中使用 AddHandler ，但它也不起作用。

在我的用户控件中维护对业务对象的引用以便我可以处理其事件的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T21:03:06.693

页面中的任何事件都会导致回发。回发后，页面中的每个控件都会触发 OnLoad 事件，包括您的 UserControl 和小部件本身。您可以检查在您的 UserControl 的 OnLoad 事件中引发了哪个事件并查看 sender 对象；如果它是您的小部件，那么您可以对该事件采取行动。

我并不是说这是最好的解决方案，而是在没有实际尝试的情况下想到的第一个解决方案。

# asp.net - 使用 AjaxToolKit 改进 WebForm 登录

> ID：363244
> 
> 赞同：0
> 
> 时间：2008-12-12T16:22:21.037
> 
> 标签：asp.net, roundedcorners-dropshadow

我选择 AjaxToolKit 来构建 WebForm 登录。有没有其他人在尝试这样做时遇到问题？我打算将 DropShadow Extender 和 RoundedCorners 与面板一起使用，但这是我第一次使用面板。

请检查[此链接](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/ConfirmButton/ConfirmButton.aspx)。

每当用户单击按钮时，我想将登录面板放入屏幕截图所示的内容中。当您尝试在“提问”中插入图像或超链接时，这与 StackOverflow 上发生的功能类似。这可能吗？这是多少努力？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-12T16:38:31.783

如果您谈论的是 100% 使用 ajax 控制工具包，请查看[ModalPanel](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/ModalPopup/ModalPopup.aspx)示例。

您也可以选择像[iBox](http://www.ibegin.com/labs/ibox/)这样的 javascript 库选项，这将有点难以集成，但并不多。

我更喜欢使用 javascript 和 css 手动执行此操作，如果您知道自己在做什么，这并不难，如果您不熟悉这些技术，则可能需要更多的工作。[这](http://weblogs.asp.net/jeff/archive/2006/10/25/Modal_2D00_style-pops-in-Javascript-and-CSS.aspx)是一个很好的帖子，可以引导您了解基础知识

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T16:41:18.643

我在我的应用程序中广泛使用 AjaxControlToolkit，它非常简单。作为服务器端 ajax，我确实在您的页面上发出了很多 javascript。我建议您仅在需要的地方使用 AJAX，即在页面执行大量操作并且您希望使其更具响应性的情况下，例如 Dashboard 类型的应用程序。

# mysql - mysql全文搜索“all but”查询

> ID：363248
> 
> 赞同：1
> 
> 时间：2008-12-12T16:23:54.560
> 
> 标签：mysql, search, full-text-search

我需要在表中查询“除了关键字之外的所有内容”。只使用“-”是行不通的，事实上[mysql 手册](http://dev.mysql.com/doc/refman/5.1/en/fulltext-boolean.html)说：

> 注意：- 运算符仅用于排除与其他搜索词匹配的行。因此，仅包含以 - 开头的术语的布尔模式搜索返回空结果。它不会返回“除包含任何排除项的行之外的所有行。”</p>

我发现的唯一解决方法是“a* b* .... y* z* -keyword”，因为这允许所有其他结果匹配。还有其他（更清洁）的方式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T16:33:30.263

只需使用：

```
NOT MATCH(field) AGAINST(keyword) 
```

# outlook - 有没有讨论 iCalendar 格式和互操作性的好论坛？

> ID：363251
> 
> 赞同：2
> 
> 时间：2008-12-12T16:24:05.823
> 
> 标签：outlook, icalendar

我似乎找不到一个专注于 iCalendar 格式的好论坛。具体来说，iCalendar 是如何使用 Outlook 实现的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-12T09:27:24.523

如果您正在生成 iCalendar 数据并希望检查 Outlook 是否存在问题，那么您可以尝试使用[Douglas Day 的验证器对其进行验证](http://icalvalid.cloudapp.net/)。

他的验证器不仅根据 RFC 5545 规范测量您的 iCalendar 数据，而且还建议潜在的兼容性问题。

该验证器基于 DDay.iCal，旨在“尽可能符合 RFC 5545，同时与流行的日历应用程序（如 Apple iCal、Outlook 2007 等）兼容”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T19:20:22.127

最好的解决方案通常是尝试一下。当然，这意味着安装 Outlook 或拥有可以与之合作的朋友/用户。我意识到这通常是一个问题，但它确实是确定应用程序行为方式的唯一方法。

在互操作方面：如果你让它在 Apple Mail/iCal、GMail 和 Outlook 中工作，根据我的经验，你应该也能很好地处理其他邮件。

# command-line - 使用TFS，想运行命令行工具进行混淆

> ID：363254
> 
> 赞同：0
> 
> 时间：2008-12-12T16:24:45.947
> 
> 标签：command-line, tfs, build-process

第一次使用团队资源管理器，我想添加一个构建任务，该任务将运行命令行工具来混淆程序集。这将是我假设要执行的最后一项任务。

我将如何使用 Team Explorer 执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T16:39:06.010

我们使用 Xenocode Postbuild。为了混淆，我们使用我们在 DLL 中编写的自定义构建任务，我们从 TFS 中的构建配置中调用该构建任务。

因此，我们[创建了一个](http://msdn.microsoft.com/en-us/library/ms400767(VS.80).aspx)包含 PostBuild 命令行的自定义任务。[我们从MSBUILD 目标](http://msdn.microsoft.com/en-us/library/t50z2hka.aspx)传递任务变量。该目标是与我们的发布构建定义关联的项目文件的一部分。

# excel - excel中的邮政编码距离

> ID：363259
> 
> 赞同：1
> 
> 时间：2008-12-12T16:26:18.063
> 
> 标签：excel, zipcode

我正在寻找一种在 excel 中获取函数以检索一个拉链到另一个拉链的距离的方法。假设我有 100,000 名可能的新兵名单，我想按最近的方式排序。我有会议邮政编码，然后是 100,000 招聘邮政编码。我希望能够只编写一个函数 =ZipCodeDistance(a2,d1) 然后按该列排序。我找到了一个声称可以做到这一点的 65 美元的程序，但我想知道是否有免费的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T16:30:13.860

如果你有每个邮政编码的纬度和经度，你可以使用三角函数来计算乌鸦飞翔的距离。

[这里](http://www.populardata.com/downloads.html)有一个免费的数据库，您可以下载。

要进行计算，请参阅[此处](http://www.movable-type.co.uk/scripts/latlong.html)的信息。和一些实际的 Excel 特定的计算示例在[这里](http://www.cpearson.com/excel/latlong.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T16:31:14.730

[此处](https://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/programming-and-development/?p=634)解释了如何获取数据和算法，但在 C# 中。如果你的 Excel VBA 没问题，翻译应该不会太难吧？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T16:36:03.940

您可以获得每个邮政编码的邮局地址列表，并将每个地址地理编码成一个经纬度对。对新兵的地址做同样的事情，然后使用大圆距离的公式。

这是美国邮政编码数据库的链接：

[http://www.zipcodeworld.com/](http://www.zipcodeworld.com/)

另一个是如何计算地球上两点之间的距离：

[http://williams.best.vwh.net/avform.htm](http://williams.best.vwh.net/avform.htm)

# apache-flex - 是否有一种标准化的方式将元数据（例如版本、许可证）嵌入到 SWC 组件中？

> ID：363267
> 
> 赞同：4
> 
> 时间：2008-12-12T16:27:52.600
> 
> 标签：apache-flex, flash, metadata, components, swc

**场景**：有一个**Adob​​e Flex 3**`SWC`项目，它以文件的形式使用了多个第三方库和组件。

我们如何知道这些`SWC`文件“里面有什么”？具体来说，如何确保项目使用所有这些组件的最新版本？

根据[官方 Adob​​e Flex 3 帮助](http://livedocs.adobe.com/flex/3/html/ascomponents_advanced_5.html)，“您可以定义”（原文如此）`version`您打算打包和分发的组件的属性。类似于以下内容：

```
private static const version:String = '1.0.0.42'; 
```

但是 Adob​​e 的创作工具并没有以任何特殊方式处理该属性，而且我怀疑它不是社区常用的，无论如何。

`catalog.xml`所有组件中的文件`SWC`似乎不包含任何有用的东西。

**开发人员是否以任何方式分发`SWC`通常将元数据嵌入到这些文件中？是否有一种标准化的方法可以从`SWC`文件中检索版本、许可证、作者和版权等数据？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T11:37:01.563

您可以查看 RSL 摘要。它们将不同的哈希值附加到特定库的每个版本（catalog.xml 文件中的 swc/library/libraries/digests）。那么您所要做的就是只加载具有已知摘要值的库。

如果您对正在使用的 SWC 文件没有任何控制权并且它们没有使用摘要，那么您就会被供应商使用的任何专有版本控制系统所困。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T19:46:43.053

我认为在 .swc 文件本身中包含版本名称是一种很好的做法。例如，如果您使用 Mate 框架，则 swc 文件名类似于 Mate_08_5.swc。快速浏览一下，您可以看到您使用的是 0.8.5 版本。

就许可证而言，通常您在包含您的 .swc 文件的 .zip 中分发一个 LICENSE 文本文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T21:42:40.933

你提出了一个有趣的观点。

Adobe 提供了一种将基本元数据包含在 SWF（因此也包含在 SWC）中的方法，但它存储在二进制文件中，并且没有反编译就无法提取它。

有趣的是，如果一个人知道如何阅读 SWF，那么提取元数据是相当容易的。但大多数时候它不包含任何有用的信息，因为显然创作工具不允许您简单地查看它......

所以我想首先我们需要在我们的创作工具中进行一些集成，然后我们可能会开始在元数据中找到有用的信息:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-15T20:37:20.907

SWC 通常与其他支持文件（例如文档和示例）一起分发在一个包中。版本、许可证和作者信息通常作为该软件包的一部分在单独的自述文件或许可证文件中提供。我从未见过 Flex 世界中的组件开发人员将这类信息编译到 SWC 本身中。

# javascript - 如何从表单中删除 jQuery 验证？

> ID：363268
> 
> 赞同：45
> 
> 时间：2008-12-12T16:28:02.413
> 
> 标签：javascript, jquery, validation

我正在使用 jQuery 验证插件来验证表单，如果单击某个链接，我想删除验证并提交表单。

我正在使用 javascript 提交表单`jQuery('form#listing').submit()`，因此我必须使用 javascript 删除验证规则/功能。

问题是我无法弄清楚如何做到这一点。我已经尝试过类似`jQuery('form#listing').validate({});`and的东西`jQuery('form#listing').validate = null`，但没有运气。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-06-28T17:53:17.607

触发 DOM 提交方法跳过验证：

```
$("#listing")[0].submit(); 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-12-12T17:49:59.517

[您可以使用unbind](http://docs.jquery.com/Events/unbind#typefn)删除节点事件：

```
jQuery('form#listing').unbind('submit'); // remove all submit handlers of the form 
```

您可能正在寻找的是验证插件也可以从提交事件中取消分配自己：

```
jQuery('form#listing').validate({
   onsubmit : false
}); 
```

对于这两个，您应该能够跟进`.submit()`提交表单的调用：

```
jQuery('form#listing').unbind('submit').submit(); 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-03-26T10:01:45.900

```
var form = $('#my_form_id').get(0);
$.removeData(form,'validator'); 
```

真的在工作。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-12T16:36:34.143

您可以将取消的 css 类添加到元素（按钮，输入），以便它跳过验证

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-07-10T16:44:29.163

现在这似乎对我有用：

```
var form = $('#my_form_id').get(0);
$(form).removeData('validate'); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-07-17T16:24:15.070

您还可以通过这种方式使用公共“规则”功能：

```
$('input, select, textarea').each(function() {
    $(this).rules('remove');
}); 
```

这就是我正在使用的;）

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-08-23T15:01:52.180

如果您想打开/关闭表单验证（例如付款类型的不同验证......），我发现没有其他方法有用

我必须做的（这不是一个很好的解决方法，但它确实有效）

设置验证：

```
jQuery('#form').validate(); 
```

禁用表单：

```
jQuery('#form').validate().currentForm = ''; 
```

再次启用表单：

```
jQuery('#form').validate().currentForm = jQuery('#form')[0]; 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-12-12T09:13:22.533

```
$("#formName").validate().settings.ignore = "*"; 
```

参考：[https ://github.com/jzaefferer/jquery-validation/issues/725](https://github.com/jzaefferer/jquery-validation/issues/725)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-07-10T15:38:39.327

我最近升级到了 Jörn 的验证器脚本 1.5.5，并且 removeValidator 函数已被弃用。

```
 ...
jQuery.extend(
          jQuery.fn, 
          {
          removeValidator: function(){
              this.unbind();
              jQuery.removeData(this[0], 'validator'); 
          }
... 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-07-02T15:47:50.373

对于表单的所有标签输入：

```
$('#myform').validate().settings.ignore = '.valid';
$('input').addClass('valid'); 
```

这个对我有用。

# c# - 备份 app.config 的内置方法

> ID：363274
> 
> 赞同：2
> 
> 时间：2008-12-12T16:29:24.970
> 
> 标签：c#, configuration, backup, app-config

System.Configuration 中是否有任何内置方法可以备份当前运行的应用程序 XXX.exe.config 文件。或者如果没有，如何检索当前应用程序配置文件名以进行备份。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T19:17:15.567

您应该能够使用[System.Configuration.ConfigurationManager](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx)类来执行此操作。

OpenMappedConfiguration 方法可用于打开 System.Configuration.Configuration 类型的实例，该类型基于您的应用程序/Web 配置（或任何其他格式正确的文件，因此其他人的应用程序/Web 配置）。然后 Configuration 类型有一个 Save 方法和一个 SaveAs 方法。

不能说我已经用它们来做你想要的，但是（与@StingyJack 的评论交谈）我已经在 Installer 子类型（服务的 ProjectInstaller）中使用了它们。

# html - 使用 CSS 隐藏内容而不显示：无或 JavaScript

> ID：363276
> 
> 赞同：22
> 
> 时间：2008-12-12T16:29:41.210
> 
> 标签：html, css, blackberry, mobile

如何在不使用`display:none`或 JavaScript 的情况下隐藏 div？

在我的国家，很多黑莓都禁用了 CSS 支持（这里的移​​动公司对开发人员不太友好）。我有文字说

```
<div class="BBwarn">
please activate your css support and a link
</div> 
```

一旦用户激活 CSS 支持，我想隐藏它，但我不能使用`display:none;`，因为它仅在 BB 固件 4.6 中受支持。这是一个公共网站，我不能让所有访问者都升级。

有人知道解决方案吗？我希望这个问题现在更容易理解。

更新：谢谢大家的回答，但我不能使用

*   立场：绝对
*   溢出

因为它们在 Blackberry 固件 4.6 及更高版本中可用

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-12T16:33:21.903

这是一种常见的方式：

`margin-left: -9999;`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-12T17:36:25.567

要尝试的事情：

*   使用 z-index 将其放在其他元素后面
*   通过绝对定位将其移出屏幕
*   可见性：隐藏
*   通过将背景设置为前景色使内容“不可见”（仅适用于文本）
*   不透明度：0

但真正的问题是：为什么？

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-15T18:27:21.823

How about:

```
 visibility: hidden; 
```

That should hide the DIV, (note how it will still be rendered but be invisible, that means it will take space in the document as if it was visible, but be invisible (unlike display:none; where the div will not be rendered)).

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-12T23:08:17.877

为什么不尝试简单的：

```
position: absolute;
left: -1000px; 
```

我不明白为什么它不起作用。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-15T22:30:27.357

我不确定你所说的使用 < 4.6 的百分比，但如果这对你来说很重要，那么我可以看到一个理由来接受你不能一直取悦所有人，并且应该可以实现可接受的级联解决方案。可能带有一个链接来解释升级和启用 css 的好处。

```
height: 0; 
overflow: hidden;
visibility: hidden; 
color: #fff; 
background: #fff; 
```

顺便说一句 - 如果你告诉别人打开它，你最好确保你的 css 是好的...... :-)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-12-12T17:19:31.887

```
<div style="height:0;width:0;overflow:hidden;">
<!-- content here -->
</div> 
```

顺便说一句，这是我预加载图像的方法，这很好，因为它不使用 javascript。

Visibility:hidden 不会做同样的事情，因为一些浏览器很聪明，除非它认为它实际上是可见的，否则不会发出请求。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-12-20T01:31:35.877

What makes you think `display: none` is not supported before version 4.6? Did you test that, or are you going by their documentation?

I'm not a mobile developer either, so I'm just going by what I gleaned from the documentation.

The [BlackBerry Browser 4.6 CSS Reference](http://na.blackberry.com/eng/deliverables/3829/CSS_Reference.pdf) indeed mentions "Availability: BlackBerry® Device Software version 4.6 or later" for the display property, but their [BlackBerry Browser 4.3 Content Developer Guide](http://na.blackberry.com/eng/deliverables/1369/BlackBerry_Browser_Version_4.3_Content_Developer_Guide.pdf) indicates that 4.3 already supported a very limited version of the `display` property, including `display: none`. Versions before 4.3 don't support the `display` property (again, going by the [BlackBerry Browser developer documentation](http://na.blackberry.com/eng/support/docs/subcategories/?userType=21&category=BlackBerry+Browser)).

Can you assume your users do at least have firmware version 4.3, or is that just as unacceptable as assuming they have 4.6?

Have you tried simply setting the width and height to zero? I'm not familiar with the BlackBerry (Browser), but I'm sceptically assuming its CSS support is less than perfect, certainly on the older versions. I wouldn't be surprised if this worked:

```
.BBwarn {
    display: none; /* for 4.6 and up */
    width: 0px;    /* for 4.3 */
    height: 0px;
} 
```

But then `width` and `height` are only supported on all elements starting from version 4.3\. Before that they could only be applied to `<button>` and `<img>` tags and some `<input>` types (according to the documentation).

So perhaps the safest way to really make it work on all BlackBerry firmware versions is to use an image for the warning, and use CSS to set its width and height to zero.

If an image is not an option (due to lozalization issues or so, perhaps), an ugly hack might be to specify an empty/illegal image source and put the warning text in the `alt` attribute. I don't know if setting its width and height to zero would still hide that alt text then.

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-12-12T16:41:15.210

`visibility: hidden;`会起作用，但该特定占用的空间`div`仍然会出现。如果您要使用否定`left-margin`方法，请记住您需要将对象设置`position`为`absolute`.

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-09-07T08:32:25.837

这个怎么样：

```
clip: rect(0,0,0,0); 
```

注意：请注意，如果使用“溢出：可见”，则剪辑属性不起作用。

在你的情况下：

```
<div class="BBwarn">
  please activate your css support and a link
</div> 
```

只需添加这个 CSS：

```
.BBwarn{
  position: absolute;
  clip: rect(0,0,0,0);
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-15T18:29:52.147

I assume You don't want to use JavaScript because the Blackberrys don't support it.

What about if you did the opposite and displayed the block of code with JavaScript, rather than tried to hide it?

```
<script type="text/javascript"><!--
document.open();
document.writeln('<div class="BBwarn">');
document.writeln('please activate your css support and a link');
document.writeln('</div>');
document.close();
//--></script> 
```

This is a bit of a hack, but would not display the text with disabled JavaScript...

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-12T16:32:33.560

您可以将其绝对定位在屏幕之外。

但我也不是移动开发人员。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-12-09T13:40:47.167

你可以做一些明智的事情：

```
.class{
opacity:0; overflow:hidden; visibility: hidden; height:0;
} 
```

为了更精确，您可以添加：

```
color:transparent; background-color:transparent; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-20T02:48:33.193

到底有什么问题（前面提到的）

宽度：0 高度：0 可见性：隐藏

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-03-24T11:00:48.637

当我尝试在 BlackBerry Curve 8530 (OS 5.0) 中使用 javascript 自定义选择框时，我遇到了类似的问题。但是，创建的菜单无法隐藏，因为 css 以下属性仍然不起作用：

```
display
overflow
position: absolute
visibility
z-index 
```

并且破坏和重新创建 HTML 元素也不起作用，所以我来到这里可以解决我的问题。我知道我的回答并不完全是关于这里提出的问题，但是一旦我遇到问题到这里，我想我不是唯一一个发生并且将会发生的人。

无论如何，即使这些 css 属性有效，我需要的是一些可以在大多数 BB 模型上工作的代码。

我的解决方案是使用此处找到的所有答案做出的。这很简单。我做了两节课：

```
.element
{
    width: 100px;
    height: 100px;
    font-size: 12px;
    color: black;
    background-color: transparent;
    border: 1px solid black;
}
.element_hidden
{
    width: 0px;
    height: 0px;
    font-size: 0px;
    color: white;
    background-color: white;
    border: none;
} 
```

是的。我为页面中的每种元素制作了两个。最初，所有类都设置为 class="element_hidden"，因此当鼠标悬停在选择框菜单上时，所有类都更改为 class="element"，并且它们被显示和隐藏，就好像它们被设置为不可见/可见一样。

我希望这对某人有用！;D

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-02T16:21:47.977

宽度：0 高度：0 可见性：隐藏

...并不总是适用于固件 2.2 及更早版本。有时您可以隐藏一个元素，但它会通过某些击键重新出现（例如下划线）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-09-16T14:28:58.113

或者您可以使用请启用 Javascript

并使用显示“启用 CSS”的图像并使用“显示：无”设置样式。

因此，每当启用相应的功能时，这些警告都不会显示。

或者，我假设您正在使用一些服务器端代码？您可以尝试检测最常见的已知平台，这些平台支持特定版本的 css/javascript 并相应地提供内容。您甚至可能不必自己编写所有内容。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-12-21T09:19:55.880

**我使用字体大小来获得这个而不使用显示无**

```
font-size: 0px; 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-09-03T19:03:37.793

正如您在问题中所说，您需要针对4.6 以下的**黑莓版本**的解决方案，并且对于 4.6 以下的黑莓版本支持的 CSS 属性很少，因此我们可以为此目的使用某种 hack。尝试将文本设置`color`为背景或设置`font-size`为 0。这是一个 hack，但它使它不可见。运行以下代码段，让我知道它是否适合您。

```
.alert1 {
    color: #fff; //3.8 or later

}

.alert2 {
    font-size: 0; //3.8 or later
}
```

```
<b>Alert1</b>
<div class="alert1">
please activate your css support and a link
</div>

<b>Alert2</b>
<div class="alert2">
please activate your css support and a link
</div>
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-12-11T10:52:31.167

我们可以使用 transform 属性沿 x 和 y 轴缩放元素。

```
. BBwarn{
   transform : scale(0,0);
} 
```

# wcf - 带有 WCF 错误的 https：“找不到与方案 https 匹配的基地址”

> ID：363285
> 
> 赞同：42
> 
> 时间：2008-12-12T16:32:19.377
> 
> 标签：wcf, https

我去[https://mywebsite/MyApp/Myservice.svc](https://mywebsite/MyApp/Myservice.svc)并收到以下错误：

（如果我使用 http:// 链接有效）

“*服务'/MyApp/MyService.svc'由于编译过程中的异常而无法激活。异常消息是：找不到与绑定BasicHttpBinding的端点的方案https匹配的基地址。注册的基地址方案是[http ]..* ”

**编辑：**所以如果我`address=""`改为`address="https:// ..."`然后我得到这个错误：

"*错误：不支持协议 'https' ......' [https://.../Annotation.svc](https://.../Annotation.svc) ' 上的 ChannelDispatcher 与合同 '"Annotation"' 无法打开其 IChannelListener。* "

这是我的`Web.Config`样子：

```
<services>
      <service behaviorConfiguration="AnnotationWCF.AnnotationBehavior"
              name="AnnotationWCF.Annotation">
              <endpoint address="" binding="basicHttpBinding" bindingConfiguration="BasicHttpBinding_Annotation"
                      contract="AnnotationWCF.Annotation" />
              <endpoint address="" 
                  binding="basicHttpBinding" bindingConfiguration="SecureTransport"
                  contract="AnnotationWCF.Annotation" />
              <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service> 
```

```
<bindings>
<basicHttpBinding>
    <binding name="BasicHttpBinding_Annotation" maxBufferSize="2147483647"
            maxReceivedMessageSize="2147483647">
        <readerQuotas maxDepth="2147483647" maxStringContentLength="2147483647"
            maxArrayLength="2147483647" maxBytesPerRead="2147483647"
            maxNameTableCharCount="2147483647" />
    </binding>
    <binding name="SecureTransport" maxBufferSize="2147483647"
            maxReceivedMessageSize="2147483647">
        <security mode="Transport">
        <transport clientCredentialType="None"/>
        </security>
        <readerQuotas maxDepth="2147483647" maxStringContentLength="2147483647"
            maxArrayLength="2147483647" maxBytesPerRead="2147483647"
            maxNameTableCharCount="2147483647" />
    </binding>
</basicHttpBinding> 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2011-05-26T03:20:48.233

我有这个完全相同的问题。除了我的解决方案是在绑定值中添加一个“s”。

**旧：** 绑定 =“mexHttpBinding”

**新：** 绑定=“mexHttpsBinding”

**web.config 片段：**

```
<services>
    <service behaviorConfiguration="ServiceBehavior" name="LIMS.UI.Web.WCFServices.Accessioning.QuickDataEntryService">
        <endpoint behaviorConfiguration="AspNetAjaxBehavior" binding="webHttpBinding" bindingConfiguration="webBinding" 
            contract="LIMS.UI.Web.WCFServices.Accessioning.QuickDataEntryService" />
        <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
    </service> 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-19T19:11:44.630

事实证明，我的问题是我使用负载平衡器来处理 SSL，然后通过 http 将其发送到实际服务器，然后服务器抱怨。

修复说明如下：http: [//blog.hackedbrain.com/2006/09/26/how-to-ssl-passthrough-with-wcf-or-transportwithmessagecredential-over-plain-http/](http://blog.hackedbrain.com/2006/09/26/how-to-ssl-passthrough-with-wcf-or-transportwithmessagecredential-over-plain-http/)

编辑：在与微软支持人员交谈后，我解决了我的问题，这略有不同。

我的 silverlight 应用程序在代码中的端点地址通过 https 传输到负载均衡器。然后负载均衡器将端点地址更改为 http 并指向它要访问的实际服务器。因此，在每个服务器的 Web 配置中，我为端点添加了一个 listenUri，它是 http 而不是 https

```
<endpoint address="" listenUri="http://[LOAD_BALANCER_ADDRESS]" ... /> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-09-17T01:20:59.267

确保为您的服务器启用 SSL！

尝试在没有该证书的本地机器上使用 HTTPS 配置文件时出现此错误。我试图进行本地测试 - 通过将一些绑定从 HTTPS 转换为 HTTP。我认为这样做比尝试安装自签名证书进行本地测试更容易。

结果我收到了这个错误，因为**我没有**在我的本地 IIS 上启用 SSL，即使我并不打算实际使用它。

HTTPS 的配置中有一些内容。在 IIS7 中创建自签名证书允许 HTTP 工作:-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-12T22:00:46.080

我认为您正在尝试以与以下配置类似的方式配置您的服务。这里有更多信息：[使用不同的绑定值指定具有两个端点的服务](http://msdn.microsoft.com/en-us/library/ms733099.aspx "向下滚动以指定具有两个端点的服务...")。此外，除了开发之外，将 HTTP 和 HTTPS 端点都用于同一服务可能不是一个好主意。它有点违背了 HTTPS 的目的。希望这可以帮助！

```
<service type="HelloWorld, IndigoConfig, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null">
    <endpoint
        address="http://computer:8080/Hello"
        contract="HelloWorld, IndigoConfig, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null"
        binding="basicHttpBinding"
        bindingConfiguration="shortTimeout"
    </endpoint>
    <endpoint
        address="http://computer:8080/Hello"
        contract="HelloWorld, IndigoConfig, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null"
        binding="basicHttpBinding"
        bindingConfiguration="Secure"
     </endpoint>
</service>
<bindings>
    <basicHttpBinding 
        name="shortTimeout"
        timeout="00:00:00:01" 
     />
     <basicHttpBinding 
        name="Secure">
        <Security mode="Transport" />
     </basicHttpBinding>
</bindings> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-05T07:49:21.937

在我的情况下，我在绑定中将安全模式设置为“TransportCredentialOnly”而不是“Transport”。改变它解决了这个问题

```
<bindings>
  <webHttpBinding>
    <binding name="webHttpSecure">
      <security mode="Transport">
        <transport clientCredentialType="Windows" ></transport>
      </security>
      </binding>
  </webHttpBinding>
</bindings> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-07-28T16:39:47.570

查看您的基地址和端点地址（在您的示例代码中看不到）。很可能你错过了一个专栏或其他一些错字，例如 https// 而不是 https://

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-01T20:37:50.600

我正在使用 webHttpBinding 并忘记在导致错误的绑定配置上指明“传输”的安全模式：

```
 <webHttpBinding>
    <binding name="MyWCFServiceEndpoint">
      <security mode="Transport" />
    </binding>
  </webHttpBinding> 
```

在配置中添加这个解决了这个问题。

# c# - 从 jQuery 中选择多个文件后，ASP.Net 上传多个文件

> ID：363286
> 
> 赞同：3
> 
> 时间：2008-12-12T16:32:19.940
> 
> 标签：c#, asp.net, jquery, file-upload, multifile-uploader

我使用了一个 jQuery 多文件上传控件 [来自 fyneworks [http://www.fyneworks.com/jquery/multiple-file-upload/#tab-Overview](http://www.fyneworks.com/jquery/multiple-file-upload/#tab-Overview)的 MultiFile ] 来收集一些文件名，但不知道如何上传它们在服务器上。

标准的 asp:FileUpload 控件似乎只允许单个文件，我不想使用 swfupload 控件，只是普通的旧 aspx。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T16:33:21.530

（我自己已经回答了这个问题，我只是在通过 goole 或 SO 找到答案时遇到了问题，这似乎很有用......）

[感谢 Suprotim Agarwal http://www.dotnetcurry.com/ShowArticle.aspx?ID=68](http://www.dotnetcurry.com/ShowArticle.aspx?ID=68)，这段代码可以满足我的需要

使用合适的 jQuery 多重上传控件（例如来自 fyneworks [http://www.fyneworks.com/jquery/multiple-file-upload/#tab-Overview](http://www.fyneworks.com/jquery/multiple-file-upload/#tab-Overview)的 MultiFile ）选择文件并单击提交按钮后，调用aspx 文件中的以下代码

```
HttpFileCollection hfc = Request.Files;
for (int i = 0; i < hfc.Count; i++)
{
    HttpPostedFile hpf = hfc[i];
    if (hpf.ContentLength > 0)
    {               
        hpf.SaveAs(Server.MapPath("Uploads") + "\\" + System.IO.Path.GetFileName(hpf.FileName));
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-24T13:38:34.500

HttpFileCollection 上传 = HttpContext.Current.Request.Files;

for (int i = 0; i < uploads.Count; i++) {

```
 HttpPostedFile upload = (HttpPostedFile)uploads[i]; 
```

# c++ - 为什么 Visual C++ 缺少重构功能？

> ID：363292
> 
> 赞同：78
> 
> 时间：2008-12-12T16:34:27.767
> 
> 标签：c++, visual-studio, visual-studio-2008, visual-c++

在 Visual Studio 2008 中使用 C++ 编程时，为什么在使用 C# 时在重构菜单中没有看到类似的功能？

我经常使用**重命名**，当它不存在时你真的很想念它。我相信您可以获得提供此功能的插件，但为什么在使用 C++ 时不将其集成到 IDE 中？这是由于必须解析 C++ 的方式存在一些问题吗？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-12-12T16:44:19.383

C++ 的语法和语义使得正确实现重构功能变得**异常困难。**可以实现一些相对简单的东西来覆盖 90% 的情况，但在剩下的 10% 的情况下，这个简单的解决方案会通过更改您不想更改的内容来严重破坏您的代码。

阅读[http://yosefk.com/c++fqa/defective.html#defect-8](http://yosefk.com/c++fqa/defective.html#defect-8)，简要讨论 C++ 中的任何重构代码必须处理的困难。

微软显然决定为 C++ 开发这一特殊功能，让第三方开发人员尽其所能。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-12T16:40:57.957

我不确定为什么会这样，但是存在第三方工具可以提供帮助。例如，现在我正在评估[Visual Assist X](http://www.wholetomato.com/) (by Whole Tomato)。我们还使用 Visual Studio 2005。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-18T19:20:52.433

[devexpress](http://www.devexpress.com/)提供插件[重构！](http://www.devexpress.com/Products/Visual_Studio_Add-in/RefactorCPP/index.xml)用于VS2005 和 VS2008[的 C++ 。](http://www.devexpress.com/Products/Visual_Studio_Add-in/RefactorCPP/index.xml)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-12T16:43:15.423

不要觉得很难完成，它在 VB.Net 中也不可用 :)

与 C# 相比，C++ 是一种难以解析的语言（VB 也是，除非你打开了“Option Explicit”和“Option Strict”，很难在更大的上下文中准确地判断任何代码行在做什么）。

猜测可能与提供它的“难度”有关。

PS 我将我的答案标记为社区 wiki，因为我知道它没有提供任何有用的信息。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-10-25T11:24:17.380

Eclipse 很少进行 C++ 重构，包括“重命名”。在 StackOverflow 上查看这个[问题。](https://stackoverflow.com/questions/130913/what-is-the-state-of-c-refactor-support-in-eclipse)

也可以在 Eclipse 中使用 Microsoft 编译器。[在这里](https://stackoverflow.com/questions/8816923/c-how-to-debug-a-c-application-compiled-using-the-microsoft-visual-c-to)查看。

试试 Eclipse，看看它是否适合你。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-04-13T23:33:23.447

围绕这个问题有很多混乱和困惑。这段精彩的 youtube 视频应该阐明了为什么 C++ 重构很难：[https ://www.youtube.com/watch?v=mVbDzTM21BQ](https://www.youtube.com/watch?v=mVbDzTM21BQ)

tl;dr Google 通过使用允许访问其中间格式的编译器 (Clang + LLVM) 重构了整个 1 亿行 C++ 代码库。

归根结底，第三方在这里被搞砸了，除非 MS 以相同的方式输出中间结果，否则他们没有现实的方法来重构 VS C++。如果您从编程问题的角度考虑，这很明显：为了重构 VS C++，您必须能够以与 VS 完全相同的方式编译 C++，但具有相同的错误、限制、缺陷、黑客、快捷方式、解决方法等. 像 Coderush 和 Resharper 这样的常见嫌疑人没有预算来应对这种精神错乱，尽管他们显然正在尝试，但已经有好几年了……

[http://www.jetbrains.com/resharper-cpp/](http://www.jetbrains.com/resharper-cpp/)

2016 年更新：Resharper 现在在 C++ 重构方面做得不错。限制纯粹是针对大型/巨大的项目。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-11-15T10:20:47.743

MS终于做到了：[https ://channel9.msdn.com/Shows/C9-GoingNative/GoingNative-33-C-Refactoring-in-Visual-Studio-2015#time=04m37s](https://channel9.msdn.com/Shows/C9-GoingNative/GoingNative-33-C-Refactoring-in-Visual-Studio-2015#time=04m37s)

他们大约在 10 年前就开始这样做了，我记得很久以前看过 ms channel9。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-11-15T11:23:59.943

我已经将[Visual Assist X](http://www.wholetomato.com/)与 Visual Studio 一起使用了大约一年半。这是一个令人难以置信的工具，可以帮助您处理普通的 C++ 代码，但它在模板化代码上表现不佳。例如，如果您有一个复杂的基于策略的模板设计，它将不知道如何重命名您的变量，并且项目将不再编译。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-07-01T07:13:39.380

安装启用该功能的插件：[https ://visualstudiogallery.msdn.microsoft.com/164904b2-3b47-417f-9b6b-fdd35757d194](https://visualstudiogallery.msdn.microsoft.com/164904b2-3b47-417f-9b6b-fdd35757d194)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-05-11T19:36:32.460

我想指出 Qt Creator（一个与 VC++ 库和构建系统兼容的 C++ IDE）提供了非常有效的符号重命名：

> 您可以重命名项目中所有文件中的符号。重命名类时，还可以更改与类名匹配的文件名。

[Qt Creator - 重构：重命名符号](http://doc.qt.io/qtcreator/creator-editor-refactoring.html#renaming-symbols)

Qt Creator 的重命名功能为您提供了它找到的符号引用的列表，并有机会在执行替换之前排除它们中的任何一个。所以如果它得到一个错误的符号引用，你可以排除它。

[![Qt Creator 重构替换](https://i.stack.imgur.com/oiKIN.png)](https://i.stack.imgur.com/oiKIN.png)

所以 C++ 符号重命名是可能的。从 Qt Creator 转向 VS 我感到很痛苦，以至于我考虑将现有的相当大的 VS 项目转换为使用 Qt Creator。

我不相信这在 C++ 中特别难的论点。除了它已经在 Qt Creator 中运行良好之外，还有一个事实是编译器和链接器可以找到并匹配符号：如果这不可能，您就无法构建您的应用程序。

事实上，像 Python 这样的动态类型语言也有重命名工具。如果您可以为没有显式引用变量类型的语言创建这样的工具，那么您绝对可以为 C++ 做到这一点。

一个例子：

> ...绳子，一个python重构库...我尝试了一些重命名，这确实按预期工作。

[Stack Overflow - 你为 Python 使用了哪些重构工具？](https://stackoverflow.com/a/29770/1390788)

* * *

## 回答 #11

> 赞同：-3
> 
> 时间：2013-03-05T10:38:09.913

好吧，尽管各位专家发表了评论，但我完全不同意重构支持问题与 C++ 语言语义或任何语言语义有关。除了编译器构建者自己不会因为他们自己的原因或限制而选择在第一种情况下实现一个。

不要冒犯，但我很遗憾地说 jsb 先生，您提供的上述链接以支持您关于 C++ 缺陷的案例（即 yosefk）完全没有问题。当有人要求“旧金山”时，它更像是您为“洛杉矶”提供方向。

在我看来，提出某些语言的重构难度问题更像是对语言完整性本身提出质疑。特别是对于有时只是痛苦的语言......当涉及到它们的变量声明和使用时。：） 好的！告诉我你怎么会失去对节点树中某个节点的跟踪......嗯？所以它对任何语言都有什么作用，就像机器级代码一样简单。您知道您的 VS 编译器可以轻松检测某些变量或例程是否是死代码。明白我的意思了吗？

关于开发第三方工具。我认为编译器供应商可以更容易和更有效地实现它，如果他们想要然后第三方工具将不得不复制所有解析数据库来处理它。现在编译器可以在机器代码级别非常有效地优化代码，我在这里听说很难说出以前如何使用某些变量。我想你没有真正关注编译器的内部工作。它保存在什么数据库中。

并确保它与 IDE 用于所有类似目的的数据库几乎相同。以前编译器只是一个单独的实体，IDE 只是一个具有一些专业化的文本编辑器，但随着时间的推移，编译器和 IDE 编辑器之间的差距越来越小，它直接开始在类似的解析数据库上工作。这使得更有效地处理所有这些智能感知和重构或其他与语法相关的问题成为可能。对于所有预编译的东西和 JIT 编译，这个差距几乎是疏忽的。因此，为这两个目的使用相同的数据库几乎是有意义的，否则由于重复，您的内存需求会更高。

你们都是程序员——我不是！你们似乎很难想象如何为 C++ 或任何我无法理解的语言实现重构。它只是为了一些你必须付出更多努力的东西，这取决于你试图推动的人有多重。

无论如何，VS 一个不错的 IDE，尤其是在 C# 方面。

# php - 如何使用自定义社区/城市/州在 drupal 或 elgg 上注册？

> ID：363293
> 
> 赞同：1
> 
> 时间：2008-12-12T16:35:10.667
> 
> 标签：php, javascript, drupal, elgg

我正在实施一个社交网站。我希望使用 drupal 或 elgg 并尝试两者。我坚持自定义注册以包括城市和州之外的社区。

我想让下拉菜单根据更多的全局信息自定义本地信息。因此，一旦您选择了州，城市列表就会填充到下拉菜单中。

我正在建立一个有趣社区的列表，并且可以将其加载到数据库表或任何方便的地方。

你有什么建议？

Javascript 和/或 php 很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T18:13:30.390

您将需要一个像[Active Select](http://drupal.org/project/activeselect)（[此处为 Drupal 6 端口](http://drupal.org/node/298230)）这样的模块，为 Forms API 提供此类功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-27T03:53:42.570

对于 elgg .. 有两个你会发现有用的插件。

1.  表格 - [http://community.elgg.org/pg/plugins/kevin/read/97061/form-and-related-plugins-for-elgg-15-and-higher](http://community.elgg.org/pg/plugins/kevin/read/97061/form-and-related-plugins-for-elgg-15-and-higher)

2.  弹性配置文件 - [http://groups.google.com/group/elgg-development/browse_thread/thread/15bb22b7b5fc665e](http://groups.google.com/group/elgg-development/browse_thread/thread/15bb22b7b5fc665e)

希望这能为您指明一个有用的方向。

你甚至可以使用 csv 和这个插件...动态填写所有信息。

[http://community.elgg.org/pg/plugins/naakka/read/165550/upload-users](http://community.elgg.org/pg/plugins/naakka/read/165550/upload-users)

# java - 代码到接口原则是否适用于实体类？

> ID：363295
> 
> 赞同：2
> 
> 时间：2008-12-12T16:35:35.173
> 
> 标签：java

我正在尝试在项目中遵循代码到接口。我应该先创建一个接口，然后再为实体类实现该接口吗？我认为这可能使接口优先方法走得太远了，应该忽略实体。这就是我的意思...

```
public interface Address {
  public String getStreet();
  public void setStreet(String street);
}

@Entity
public class AddressImpl implements Address {
  private String street;

  public String getStreet(){
    return this.street;
  }
  public void setStreet(String street){
    this.street = street;
  }
}

@Entity
public class OfficeImpl /* implements Office */ {
  private Address location;

  public Address getLocation(){
    return this.location;
  }
  public void setLocation(Address location){
    this.location = location;
  }
}

public class Driver {
  public static void main(String[] args) {
    Office work = new OfficeImpl();
    Address workAddress = new AddressImpl();
    workAddress.setStreet("Main St.");
    work.setLocation(workAddress);
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T16:39:28.757

我认为可能没有必要为实体创建接口。

创建接口的目的（或至少是其中一个目的）是为了更容易将一种具体实现换成另一种。这对你的 DAO、业务逻辑等来说显然是一件好事。

但是，除非您也计划更改实体的实施，否则我会避免它！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T16:40:29.657

在您的示例中，您可能走得太远了，但是一旦您添加方法、编写测试用例并可能使用依赖注入，它就会更有意义。

对于像这样的简单项目，它是矫枉过正的，但一旦你进入一个“真正的”应用程序，那么它通常是一个好主意。只是注意不要过度，一切都不需要实现接口，只要它有意义。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T16:55:06.493

实体的接口应该是所有实体共有的行为和属性！

```
public interface IEntity
{
    int EntityId { get; set; }
    bool FindById(int id);
    bool Create(object [] values);
    bool Delete(int id);
    //etc.
} 
```

对不起 C# 示例，但语言无关紧要。接口用于“插头兼容性”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T16:47:53.137

我认为当您谈论实体时，这可能是矫枉过正。

当您使用具有共同用途但不一定相同的实体时，接口很有用。想不出什么好办法来解释，但这里有一个例子：

```
interface IFlaggable {
  bool IsFlagged ...
  string Reason ...
}

class ForumPost implements IFlaggable { }

class PrivateMessage implements IFlaggable { } 
```

希望有帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T16:53:06.917

我通常不会为数据保存 bean 制作接口，也就是说，我不会为具有原始类型值的类和它们的 getter/setter 制作接口。从来没有真正遇到过我需要接口来处理我通常使用它们的任何东西（主要是多态性和模拟），所以我没有费心去做。

我想我应该指出，大多数时候，当我使用 databeans 时，我也会使用自定义类反映来自那些相同对象的值，这些自定义类的工作方式如下：

```
Reflector r = new Reflector(new DataBean( [ values given through constructor ] ));
long someNumber = r.get("method", Long.class); 
```

# c++ - 尺寸不是 2^x 的 openGL 纹理

> ID：363302
> 
> 赞同：4
> 
> 时间：2008-12-12T16:37:15.327
> 
> 标签：c++, opengl, ldf

我正在尝试在 openGL 环境中显示图片。图片的原始尺寸是 3648x2432，我想用 256x384 的图像显示它。问题是，384 不是 2 的幂，当我尝试显示它时，它看起来被拉伸了。我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T16:54:08.600

我知道有三种方法可以做到这一点 -

*   阿尔伯特建议的那个（调整大小直到适合）。
*   将纹理细分为 2**n 大小的矩形，并以某种方式将它们拼凑在一起。
*   看看能不能用`GL_ARB_texture_non_power_of_two`。不过最好避免使用它，因为它看起来像是 Xorg 特定的扩展。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T16:46:22.033

您可以调整纹理的大小，使其*为*2 的幂（倾斜纹理，以便在映射到对象时看起来正确）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T17:01:57.633

`ARB_texture_rectangle`可能是您正在寻找的。它允许您绑定到`GL_TEXTURE_RECTANGLE_ARB`而不是`GL_TEXTURE_2D`，并且您可以加载具有非 2 次方维度的图像。请注意，您的纹理坐标范围为 [0..w]x[0..h] 而不是 [0..1]x[0..1]。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-23T20:08:17.963

如果 GL_EXT_texture_rectangle 为真，则将 GL_TEXTURE_RECTANGLE_EXT 用于 glEnable() 和 GLBindTexture() 调用中的第一个参数。

# asp.net - 将 ObjectDataSource 绑定到我的数据访问层中的现有方法

> ID：363320
> 
> 赞同：2
> 
> 时间：2008-12-12T16:40:59.907
> 
> 标签：asp.net, vb.net, data-binding

我看过设计器代码，也看过在代码隐藏中构建 ObjectDataSource 的代码，但是这两种方法都通过文本命令或存储过程直接与数据库通信。这对我来说似乎是不必要的代码重复，因为我的数据访问层已经有一个方法可以返回一个包含我需要用于此报告的数据的数据表。

如何以编程方式构建 ODS 并将其链接到我的数据访问层的方法？

编辑：

感谢所有回答的人。这对我来说措辞很糟糕。当初写这个问题的时候，有太多不明白的地方。我应该问的是：

如何以编程方式将 .Net Reporting Services 报表 (*.rdlc) 绑定到我的数据访问层中的方法而不是 ADO.Net 数据集。

请看下面我的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-16T20:16:29.827

为了使用标准的 .Net 数据集作为 Reporting Services 报告的数据源，我必须：

1.  创建一个使用与 DAL 方法相同的存储过程的 ADO 数据集

2.  使用 ADO 数据集填充设计器中报表中的字段

3.  在 aspx 页面中，使用以下命令：

    ```
    <rsweb:ReportViewer ID="ReportViewer1" runat="server" Font-Names="Verdana"
                        Font-Size="8pt" Height="655px" Width="980px">
        <ServerReport ReportServerUrl="" />
        <LocalReport>

        </LocalReport>
    </rsweb:ReportViewer> 
    ```

    在代码隐藏中：

    ```
    ReportViewer1.ProcessingMode = ProcessingMode.Local
    Dim report As LocalReport = ReportViewer1.LocalReport
    report.ReportPath = "<your report path>"
    report.DataSources.Clear()

    Dim rds As New ReportDataSource()
    rds.Name = "<dataset name>_<stored proc name>"
    rds.Value = <your DAL method ()>

    report.DataSources.Add(rds)
    report.Refresh() 
    ```

4.  一旦您对此进行了测试并且对您获得的报告感到满意，您就可以安全地从您的项目中排除 ADO 数据集。

注意：这远非理想，我可能做了一些不必要的步骤或我错过了一些步骤。
让我真正头疼的一件事是，RDLC 中的 XML 包含不再相关的旧 ADO 数据集的定义。要删除它们，请在解决方案资源管理器中右键单击 rdlc 文件，然后选择“打开方式”，然后在下一个菜单中选择 XML 编辑器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-13T11:21:30.957

这是我的解决方案。我有一个名为“数据”的数据层的传统项目。现在我的 RDLC 托管在主 Web 项目“Web”中。所以“数据”中有我的 .NET 类型：

> Data.Models.Reports.MyRepository

; 和该类型的方法：

> 获取我的报告

幸运的是，ReportDataSource 有重载方法 Add，它接受 IDataSource 作为第二个参数。一旦你明白了，一切都清楚了。

```
//Create object data source
ObjectDataSource objDataSource = new ObjectDataSource();
objDataSource.TypeName = "Data.Models.Reports.MyRepository";
objDataSource.SelectMethod = "GetMyReport";
//Add parameters if any ...
objDataSource.SelectParameters.Add("Param1", ""); 
```

这里是魔法。对象数据源完全可以作为构造函数中的第二个参数

```
ReportDataSource rptDataSource = new ReportDataSource("DataSet1",objDataSource);
reportViewer.LocalReport.DataSources.Add(rptDataSource); 
```

对我来说就像一个魅力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T16:54:31.487

你使用对象数据源还是数据表？从不重复的其中一个中选择一个

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T16:55:02.187

对象数据源可以绑定到类实现 IEnumerable 的任何对象。如果您的 DAL 方法返回集合或 DataTable/DataView 或同一行的内容。您只需用方法的返回值分配对象数据源对象的数据源属性并调用 DataBind()。您甚至可以直接使用数据服务器控件的 DataSource 属性并执行相同的操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T22:40:40.180

这个问题没有多大意义。如果有一个 ObjectDataSource (ODS)，那么它可能被用来填充显示数据的任何控件（最有可能通过 DataSourceID 字段）。在标记页面上，您将看到 ODS 具有类的名称和该类上用于检索数据的方法的名称。这并不意味着它会做两次，这就是你设置它的方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T23:04:50.663

当您说数据源直接与数据库通信时，您是指SqlDataSource吗？

如果您有一个数据访问层类，那么将它连接到 ObjectDataSource 是相当容易的。只需以声明方式执行：

```
<asp:ObjectDataSource ID="ObjectDataSource1" runat="server" 
SelectMethod="[InsertYourMethodHere]" TypeName="[InsertYourDALClassHere]">
<SelectParameters>
[Add Your Parameters Here]
</SelectParameters>
</asp:ObjectDataSource> 
```

如果您使用设计器，使用 DataObject 和 DataObjectMethod 属性来装饰您的 DAL 类可能是明智之举。如果您希望以编程方式执行此操作，只需在代码隐藏中使用相同的属性。

# javascript - javascript不会加载，没有明显的错误

> ID：363324
> 
> 赞同：0
> 
> 时间：2008-12-12T16:41:35.880
> 
> 标签：javascript

我有以下代码，它不起作用。javascript 没有给出任何错误，并且似乎可以正常加载。但是单击链接将无济于事。一个链接的例子是：

```
<a href="#" onclick="updateByQuery('Layer3', "Ed Hardy");">Link 1</a><li>Link 2</li> 
```

和代码：

```
var xmlHttp
var layername
var url
function update(layer, url) {
    var xmlHttp=GetXmlHttpObject(); //you have this defined elsewhere

    if(xmlHttp==null) {
        alert("Your browser is not supported?");
    }

    xmlHttp.onreadystatechange = function() {
        if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
            document.getElementById(layer).innerHTML=xmlHttp.responseText;
        } else if (xmlHttp.readyState==1 || xmlHttp.readyState=="loading") {
            document.getElementById(layer).innerHTML="loading";
        }

       //etc
    }

    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);
}

function updateByPk(layer, pk) {
   url = "get_auction.php?cmd=GetAuctionData&pk="+pk+"&sid="+Math.random();
   update(layer, url);
}

function updateByQuery(layer, query) {
   url = "get_records.php?cmd=GetRecordSet&query="+query+"&sid="+Math.random();
   update(layer, url);
}

function GetXmlHttpObject()
{
    var xmlHttp=null;
    try
    {
        xmlHttp=new XMLHttpRequest();
    }catch (e)
    {

        try
        {
                xmlHttp =new ActiveXObject("Microsoft.XMLHTTP");
        } 
        catch (e) {}

    }
return xmlHttp;
}
function makewindows(){
child1 = window.open ("about:blank");
child1.document.write(<?php echo htmlspecialchars(json_encode($row2["ARTICLE_DESC"]), ENT_QUOTES); ?>);
child1.document.close(); 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T16:45:52.347

这可能是由于“Ed Hardy”周围的双引号字符造成的。这是否有效：

```
<a href="#" onclick="updateByQuery('Layer3', 'Ed Hardy');">Link 1</a><li>Link 2</li> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T16:56:02.607

来自精彩的[JSLint](http://jslint.com)

您在这些之后缺少分号

```
var xmlHttp
var layername
var url

xmlHttp.onreadystatechange = function() {
        if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
            document.getElementById(layer).innerHTML=xmlHttp.responseText;
        } else if (xmlHttp.readyState==1 || xmlHttp.readyState=="loading") {
            document.getElementById(layer).innerHTML="loading";
        }

       //etc
    } 
```

(e) 使用 2x，将第二个更改为“ex”。

```
 try
    {
        xmlHttp=new XMLHttpRequest();
    }catch (e)
    {

        try
        {
                xmlHttp =new ActiveXObject("Microsoft.XMLHTTP");
        } 
        catch (e) {}

    } 
```

尝试在 JS 中为 EVERYTING 使用单引号，在 PHP 中为 EVERYTING 使用双引号。

获取 Firebug 以查看是否有任何其他语法错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T16:56:57.643

此外，这一行：

```
child1.document.write(<?php echo htmlspecialchars(json_encode($row2["ARTICLE_DESC"]), ENT_QUOTES); ?>); 
```

可能应该在 PHP 引用中包含引号，以便 JavaScript 知道您希望它写什么：

```
child1.document.write("<?php echo htmlspecialchars(json_encode($row2['ARTICLE_DESC']), ENT_QUOTES); ?>"); 
```

请注意，我也将 ARTICLE_DESC 周围的双引号更改为单引号。

# java - 嵌套 SAX ContentHandler

> ID：363325
> 
> 赞同：1
> 
> 时间：2008-12-12T16:41:58.970
> 
> 标签：java, xml, dom, parsing, sax

我想使用 SAX 解析文档，并从一些元素创建一个子文档，同时纯粹使用 SAX 处理其他元素。因此，鉴于此文档：

```
 <DOC>
    <small>
      <element />
    </small>
    <entries>
      <!-- thousands here -->
    </entries>
  </DOC> 
```

我想使用 SAX ContentHandler 解析 DOC 和 DOC/entries 元素，但是当我点击时，`<small>`我想创建一个仅包含 the`<small>`及其子项的新文档。

有没有一种简单的方法可以做到这一点，还是我必须自己手动构建 DOM？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T17:59:53.803

一种方法是创建一个用于监视指示元素`ContentHandler`进入或退出的事件。`<small>`此处理程序充当代理，并在“正常”模式下将 SAX 事件直接传递给“真实” `ContentHandler`。

然而，当检测到进入一个`<small>`元素时，代理负责创建一个[`TransformerHandler`](http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/transform/sax/SAXTransformerFactory.html#newTransformerHandler())（使用无操作，“null”转换），[连接](http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/transform/sax/TransformerHandler.html#setResult(javax.xml.transform.Result))到一个[`DOMResult`](http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/transform/dom/DOMResult.html). `TransformerHandler`期望一个完整的、格式良好的文档会产生的所有事件；您不能立即向其发送`startElement`事件。相反，首先通过在实例上调用`setDocumentLocator`、`startDocument`和其他必要事件来模拟新文档的开始。`TransformerHandler`

然后，直到`<small>`元素元素的结尾被代理检测到，所有事件都被转发到 this`TransformerHandler`而不是 "real" `ContentHandler`。当`</small>`遇到结束标记时，代理通过调用`endDocument`. `TransformerHandler`DOM 现在作为 的结果可用`TransformerHandler`，其中仅包含`<small />`片段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T17:07:20.960

在我看来，答案取决于您是否需要内存中的“新文档”。如果您这样做然后使用 DOM，或者如果您只是要流式传输“新文档”，那么 StAX 可能更适合 SAX 的事件驱动性质。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T18:33:46.980

我从一个 SAX 流中构建多个同时文档没有问题。对于任何面向业务文档的流来说，这几乎都是 SOP。你这样做有什么困难？您的类的层次结构不必与 SAX 流的层次结构相匹配。

# c# - ICollection - 获取单个值

> ID：363326
> 
> 赞同：60
> 
> 时间：2008-12-12T16:42:36.267
> 
> 标签：c#, .net, icollection

从 ICollection 中获取价值的最佳方法是什么？除此之外，我们知道 Collection 是空的。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2008-12-12T17:18:13.420

您可以为此使用 LINQ：。

```
var foo = myICollection.OfType<YourType>().FirstOrDefault();
// or use a query
var bar = (from x in myICollection.OfType<YourType>() where x.SomeProperty == someValue select x)
   .FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-12-12T16:55:11.267

最简单的方法是：

```
foreach(object o in collection) {
  return o;
} 
```

但是如果它实际上是一个泛型集合，这并不是特别有效，因为 IEnumerator 实现了 IDisposable，因此编译器必须放入 try/finally，并在 finally 块中调用 Dispose()。

如果它是非泛型集合，或者您知道泛型集合在其 Dispose() 方法中没有实现任何内容，则可以使用以下内容：

```
IEnumerator en = collection.GetEnumerator();
en.MoveNext();
return en.Current; 
```

如果你知道是否可以实现 IList，你可以这样做：

```
IList iList = collection as IList;
if (iList != null) {
  // Implements IList, so can use indexer
  return iList[0];
}
// Use the slower way
foreach (object o in collection) {
  return o;
} 
```

同样，如果它可能是您自己定义的某种类型的具有某种索引访问的，您可以使用相同的技术。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-02-10T22:16:58.360

```
collection.ToArray()[i] 
```

这种方式很慢，但使用起来非常简单。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-12T17:06:57.013

没有泛型并且因为`ICollection`实现`IEnumerable`了你可以像示例 1 中那样做。使用泛型你只需要像示例 2 那样做：

```
List<string> l = new List<string>();
l.Add("astring");

ICollection col1 = (ICollection)l;
ICollection<string> col2 = (ICollection<string>)l;

//example 1
IEnumerator e1 = col1.GetEnumerator();
if (e1.MoveNext())
    Console.WriteLine(e1.Current);

//example 2
if (col2.Count != 0)
    Console.WriteLine(col2.Single()); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-04-01T09:42:53.647

如果您知道您的收藏只有一项，应该只有一项，您可以使用 Linq 扩展方法[`Single()`](https://msdn.microsoft.com/en-us/library/bb155325.aspx)。

这会将 a`ICollection<T>`转换为`T`包含该集合的单个项目的对象。如果集合的长度为 0 或大于 1，则会抛出`InvalidOperationException`.

# java - Netbeans中WebStart属性中自签名复选框的含义是什么

> ID：363329
> 
> 赞同：1
> 
> 时间：2008-12-12T16:42:43.773
> 
> 标签：java, netbeans, jar-signing

在 Netbeans（我有 6.5 版本）中，在 Application> Webstart 下的项目属性中，有一个自签名复选框。

它的意义是什么？我什么时候需要使用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T16:54:11.393

可能与网络启动安全性有关。如果您查看[此页面](http://java.sun.com/javase/6/docs/technotes/guides/javaws/developersguide/development.html#security)，您将看到 Web 启动应用程序在沙箱中运行，除非它们已签名。您可以选择生成自签名证书，而不是经过验证的证书，例如来自 Verisign 或 Thawte 的证书。

如果您正在测试，自签名很好，但如果您将某些东西部署到生产以供公众使用，我建议您获得适当的证书。

# c++ - 无法追踪潜在的内存覆盖。窗户怪异

> ID：363336
> 
> 赞同：1
> 
> 时间：2008-12-12T16:44:02.943
> 
> 标签：c++, windows

这让我发疯了。我在 Windows .lib 中使用了一些第 3 方代码，在调试模式下会导致类似于以下内容的错误：

```
Run-Time Check Failure #2 - Stack around the variable 'foo' was corrupted. 
```

当对象超出范围或被删除时，将引发错误。只需分配这些对象之一然后删除它就会引发错误。因此，我认为问题出在众多构造函数/析构函数之一中，但尽管遍历了每一行代码，我还是找不到问题所在。

但是，这只发生在在静态库中创建这些对象之一时。如果我在我的 EXE 应用程序中创建一个，则不会出现错误。第 3 方代码本身存在于静态库中。例如，这会失败：

```
**3RDPARTY.LIB**

class Foo : public Base
{
    ...
};

**MY.LIB**

void Test()
{
    Foo* foo = new Foo;
    delete foo; // CRASH!
}

**MY.EXE**

void Func()
{
    Test();
} 
```

但这会起作用：

```
**3RDPARTY.LIB**

class Foo : public Base
{
    ...
};

**MY.EXE**

void Func()
{
    Foo* foo = new Foo;
    delete foo; // NO ERROR
} 
```

因此，删除“中间”.lib 文件会使问题消失，正是这种怪异让我发疯。EXE 和 2 个库都使用相同的 CRT 库。链接没有错误。第 3 方代码使用继承，有 5 个基类。我已经尽可能多地注释掉了代码，同时仍在构建它，我只是看不到发生了什么。

因此，如果有人知道为什么 .lib 中的代码与 .exe 中的相同代码的行为不同，我很想听听。同上跟踪内存覆盖的任何提示！我正在使用 Visual Studio 2008。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T16:50:39.933

一种可能性是[调用约定](http://en.wikipedia.org/wiki/Calling_convention)不匹配 - 确保您的库和可执行文件都设置为使用相同的默认调用约定（通常是 __cdecl）。要设置它，打开您的项目属性并转到**配置属性 > C/C++ > 高级**并查看**调用约定**选项。如果你用错误的调用约定调用一个函数，你会完全弄乱堆栈。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T13:58:47.670

好的，我追查了问题，如果有人感兴趣的话，这是一个破解者。基本上，我的 .LIB 就出现了问题。已定义`_WIN32_WINNT`为`0x0501`（Windows 2000 及更高版本），但我的 EXE 和第 3 方 LIB 将其定义为`0x0600`（Vista）。现在，第 3 方库包含的头文件之一`sspi.h`定义了一个名为的结构`SecurityFunctionTable`，其中包括以下代码段：

```
#if OSVER(NTDDI_VERSION) > NTDDI_WIN2K
    // Fields below this are available in OSes after w2k
    SET_CONTEXT_ATTRIBUTES_FN_W         SetContextAttributesW;
#endif // greater thean 2K 
```

长话短说，这意味着 LIB 之间的对象大小不匹配，这导致了运行时检查失败。

班级！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T16:50:38.453

您的 .lib 文件是否与库的 .lib 链接？我从您的示例中假设您将标头包含在析构函数的声明中；没有它，删除这种类型是允许的，但可能会导致 UB（以一种奇怪的方式，与使用前必须定义某些东西的一般规则相反）。如果 .lib 文件没有链接在一起，则自定义`operator delete`或析构函数可能存在一些奇怪的链接问题，虽然这不应该发生，但您永远无法确定它是否不会发生。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T16:51:09.357

没有看到更多代码，很难给你一个肯定的答案。然而，为了追踪内存覆盖，我推荐使用 WinDbg（微软免费提供，搜索“ [Debugging Tools for Windows](http://www.microsoft.com/whdc/devtools/debugging/default.mspx) ”）。

当您将它附加到您的进程时，您可以让它为内存访问（读取、写入或执行）设置断点。总的来说，它真的很强大，但它应该特别能帮助你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T21:02:21.347

> 当对象超出范围或被删除时，将引发错误。

每当我遇到这种情况时，它都与使用与应用程序其余部分不同的 C++ 运行时版本的编译库有关。

# concurrency - 您如何利用多核？

> ID：363341
> 
> 赞同：61
> 
> 时间：2008-12-12T16:44:43.067
> 
> 标签：concurrency, scalability, parallel-processing, multicore

作为来自企业 Web 开发领域的[HPC](http://en.wikipedia.org/wiki/High-performance_computing)领域的人，我总是很想知道“现实世界”中的开发人员如何利用并行计算。现在[所有芯片都在走向多核](http://www.gotw.ca/publications/concurrency-ddj.htm)，这一点更加重要，当一个芯片上有数千个核心而不是几个核心时，它会更加重要。

我的问题是：

1.  这对您的软件路线图有何影响？
2.  我对有关多核如何影响不同软件领域的真实故事特别感兴趣，因此请在您的答案中指定您所做的开发类型（*例如*服务器端、客户端应用程序、科学计算等）。
3.  您如何处理现有代码以利用多核机器，您面临哪些挑战？你在使用[OpenMP](http://www.openmp.org/)、[Erlang](http://www.erlang.org/)、[Haskell](http://www.haskell.org/)、[CUDA](http://en.wikipedia.org/wiki/CUDA)、[TBB](http://www.threadingbuildingblocks.org/)、[UPC](http://upc.lbl.gov/)还是别的什么？
4.  随着并发水平的不断提高，您打算做什么，您将如何处理成百上千个内核？
5.  如果您的领域*不*容易从并行计算中受益，那么解释为什么也很有趣。

最后，我把这个问题描述为一个多核问题，但请随意谈论其他类型的并行计算。如果您正在移植应用程序的一部分以使用[MapReduce](http://labs.google.com/papers/mapreduce.html)，或者如果大型集群上的[MPI](http://www.open-mpi.org/)是您的范例，那么也一定要提到这一点。

**更新：**如果您确实回答了 #5，请提及您是否认为如果内核数（100、1000 等）超过可用内存带宽所能提供的数量（看看每个内核的带宽如何变得越来越小），情况是否会发生变化）。您仍然可以将剩余的内核用于您的应用程序吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-12-13T01:40:51.330

我的研究工作包括编译器和垃圾邮件过滤方面的工作。我还做了很多“个人生产力”的 Unix 工作。另外，我编写和使用软件来管理我教的课程，包括评分、测试学生代码、跟踪成绩和无数其他琐事。

1.  **多核对我完全没有影响，**只是作为编译器支持其他应用程序的一个研究问题。但这些问题主要在于运行时系统，而不是编译器。
2.  1990 年左右，Dave Wortman 费了很大的力气，证明您可以**并行化一个编译器来保持四个处理器的忙碌**。我认识的人都没有重复过这个实验。 **大多数编译器都足够快**以运行单线程。在多个不同的源文件上并行运行顺序编译器比让编译器本身并行要容易得多。对于垃圾邮件过滤，**学习是一个固有的顺序过程**。即使是旧机器也可以在一秒钟内学习数百条消息，因此即使是大型语料库也可以在一分钟内学习。再次，**训练足够快**。
3.  我利用并行机器的唯一重要方法是**使用并行 make**。这是一个巨大的福音，**大型构建很容易并行化**。Make 自动完成几乎所有的工作。我唯一记得的另一件事是使用并行性来计算长时间运行的学生代码，方法是将其移植到一堆实验室机器上，我可以凭良心做到这一点，因为我只破坏了每台机器的一个核心，所以只使用 1 /4 CPU 资源。哦，我写了一个 Lua 脚本，当用 lame 翻录 MP3 文件时将使用所有 4 个内核。该脚本需要做很多工作才能做到正确。
4.  我将**忽略数十、数百和数千个核心**。我第一次被告知“并行机器即将到来；你必须做好准备”是在 1984 年。当时和今天都是如此，**并行编程是高技能专家的领域**。唯一改变的是，今天**制造商强迫我们为并行硬件付费，**无论我们是否愿意。但**仅仅因为硬件是付费的，并不意味着它可以免费使用。** 编程模型很糟糕，使线程/互斥模型*工作*，更不用说表现良好了，即使硬件是免费的，也是一项昂贵的工作。我希望大多数程序员忽略并行性并安静地处理他们的业务。当一个熟练的专家带着一个平行的品牌或一个伟大的电脑游戏出现时，我会默默地鼓掌并利用他们的努力。如果我想要我自己的应用程序的性能，我将专注于**减少内存分配**并忽略并行性。
5.  **并行**性真的很难。 *大多数*域很难并行化。像并行生成这样可广泛重用的异常是令人欣喜的。

总结（我从一位为领先 CPU 制造商工作的主讲人那里听到）：业界支持多核是因为他们无法让机器运行得更快、更热，而且他们不知道如何处理额外的晶体管。现在他们急切地想找到一种让多核盈利的方法，因为如果他们没有盈利，他们就无法建造下一代晶圆厂生产线。肉汁列车已经结束，我们实际上可能不得不开始关注软件成本。

许多认真对待并行性的人都忽略了这些玩具 4 核甚至 32 核机器，转而支持具有 128 个或更多处理器的 GPU。我的猜测是，真正的行动将在那里。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-12T22:43:46.647

对于 Web 应用程序来说，这非常非常简单：忽略它。除非您有一些真正需要并行完成的代码，否则您可以简单地编写旧式单线程代码并感到高兴。

在任何给定时刻，您通常需要处理的请求比您拥有的内核要多得多。而且由于每个线程都是在自己的线程中处理的（甚至是进程，取决于您的技术），这已经在并行工作了。

唯一需要注意的地方是访问某种需要同步的全局状态时。将其保持在最低限度，以避免将人为瓶颈引入其他（几乎）完全可扩展的世界。

所以对我来说，多核基本上归结为这些项目：

*   我的服务器有更少的“CPU”，而每台服务器都有更多的内核（对我来说差别不大）
*   相同数量的CPU可以支撑更多的并发用户
*   当这似乎是*不是*CPU 100% 加载的结果的性能瓶颈时，这表明我在某处进行了一些糟糕的同步。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-12T17:31:54.593

我从事医学成像和图像处理工作。

我们处理多核的方式与处理单核的方式非常相似——我们在编写的应用程序中已经有多个线程，以便获得响应式 UI。

但是，因为我们现在可以，所以我们正在认真考虑在 CUDA 或 OpenMP 中实现我们的大多数图像处理操作。英特尔编译器为 OpenMP 提供了很多很好的示例代码，它只是比 CUDA 更成熟的产品，并且提供了更大的安装基础，所以我们可能会采用它。

对于昂贵的（即超过一秒的）操作，我们倾向于做的是，如果可以的话，将该操作分叉到另一个进程中。这样，主 UI 仍然是响应式的。如果我们不能，或者移动这么多内存太不方便或太慢，那么操作仍然在一个线程中，然后该操作本身可以产生多个线程。

我们的关键是确保我们不会遇到并发瓶颈。我们在 .NET 中开发，这意味着 UI 更新必须通过对 UI 的 Invoke 调用来完成，以便让主线程更新 UI。

也许我很懒，但实际上，当涉及到并行化矩阵求逆之类的事情时，我不想花费太多时间来解决很多这些问题。很多非常聪明的人已经花了很多时间让这些东西像 nitrous 一样快速，我只是想把他们所做的事情拿来称呼它。像 CUDA 这样的东西有一个有趣的图像处理接口（当然，这就是它的定义），但对于那种即插即用的编程来说，它仍然太不成熟。如果我或其他开发人员有很多空闲时间，我们可能会尝试一下。因此，我们将使用 OpenMP 来加快处理速度（这肯定是在接下来几个月的开发路线图上）。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-12-12T17:18:45.680

1.  目前 - 老实说，并没有太大影响。我更多地处于“准备阶段”，学习使这成为可能的技术和语言特性。
2.  我没有一个特定的领域，但我遇到过数学（多核是必不可少的）、数据排序/搜索（多核上的分而治之很有帮助）和多计算机需求（例如，要求备用站的处理能力*用于*某事）。
3.  这取决于我使用的语言。显然在 C# 中，我的双手与尚未准备好的并行扩展实现捆绑在一起，这似乎确实提高了性能，直到您开始将相同的算法与 OpenMP 进行比较（也许不是一个公平的比较）。所以在 .NET 上，通过一些`for`→`Parallel.For`重构之类的东西会很容易。**真正**
    有趣的地方在于 C++，因为与 .NET 相比，您可以从诸如 OpenMP 之类的东西中挤出的性能是惊人的。事实上，OpenMP 让我很惊讶，因为我没想到它会如此高效地工作。好吧，我猜它的开发人员有很多时间来完善它。我也喜欢它在 Visual Studio 中开箱即用，与您必须付费的 TBB 不同。 **至于 MPI，我将 PureMPI.net 用于小型家庭项目（我有一个 LAN）来处理一台机器无法完成的计算。我从未在商业上使用过 MPI，但我知道 MKL 有一些 MPI 优化的功能，对于任何需要它们的人来说可能会很有趣。**
***   我计划进行“轻量计算”，即使用额外的内核来预先计算可能需要或可能不需要的结果——当然，RAM 允许。我还打算深入研究大多数最终用户的机器目前无法处理的昂贵算法和方法。*   至于没有从并行化中受益的领域……嗯，总能找到一些东西。**我**担心的一件事是对 .NET 的良好支持，但遗憾的是我已经放弃了能够达到与 C++ 类似的速度的希望。**

 *** * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-14T15:34:00.303

到目前为止，无非是更高效的编译`make`：

```
gmake -j 
```

该`-j`选项允许不相互依赖的任务并行运行。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-12-12T20:40:01.517

我正在开发 ASP.NET Web 应用程序。在我的代码中直接使用多核的可能性很小，但是通过在负载下产生多个工作线程/进程，IIS 已经很好地扩展了多核/CPU。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-06-05T11:20:51.597

我们在使用 F# 的 .NET 4 中的任务并行性方面取得了很大的成功。我们的客户迫切需要多核支持，因为他们不希望他们的 n-1 核闲置！

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-12-12T19:57:06.437

我在做图像处理。我们通过处理分配给不同线程的切片中的图像，尽可能利用多核。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-06-01T14:09:21.790

我在回答一个不同的问题时说了一些（希望这没问题！）：有一个概念/方法称为[基于流的编程](http://www.jpaulmorrison.com/fbp/)(FBP) 已经存在了 30 多年，并被用于处理加拿大一家主要银行的大部分批处理。它在 Java 和 C# 中具有基于线程的实现，尽管早期的实现是基于光纤的（C++ 和大型机汇编程序）。解决利用多核问题的大多数方法都涉及尝试采用传统的单线程程序并确定哪些部分可以并行运行。FBP 采用了不同的方法：应用程序从一开始就设计为多个异步运行的“黑盒”组件（想想制造装配线）。由于组件之间的接口是数据流，因此 FBP 本质上与语言无关，因此支持混合语言应用程序和特定领域的语言。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-08T15:46:26.903

[我们](http://www.viva64.com/)创建了[VivaMP](http://www.viva64.com/vivamp-tool/)代码分析器，用于在并行 OpenMP 程序中进行错误检测。

VivaMP 是一种类似于 lint 的静态 C/C++ 代码分析器，旨在指示基于 OpenMP 技术的并行程序中的错误。VivaMP 静态分析器大大增加了现有编译器的能力，诊断任何有错误或最终导致此类错误的并行代码。该分析仪已集成到 VisualStudio2005/2008 开发环境中。

[VivaMP – OpenMP 工具](http://www.viva64.com/art-3-2-655899033.html)

[C++ 开发人员的 32 个 OpenMP 陷阱](http://www.viva64.com/art-3-2-1023467288.html)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-06-14T05:39:02.650

我相信“*循环是工程师最好的朋友*”。

我的公司提供了一种商业工具，用于以多种计算机语言分析和转换超大型软件系统。“大”是指 10-3000 万行代码。该工具就是DMS软件再造工具包（简称DMS）。

对如此庞大的系统进行分析（甚至转换）需要很长时间：我们的 C 代码点对点分析器在具有 16 Gb RAM 的 x86-64 上需要 90 个 CPU 小时。工程师想要比这更快的答案。

因此，我们在[PARLANSE](http://www.semdesigns.com/products/parlanse/index.html)中实现了 DMS，这是一种我们自己设计的并行编程语言，旨在利用小型多核共享内存系统。

parlanse 背后的关键思想是：a) 让程序员公开并行性，b) 让编译器选择它可以实现的部分，c) 将上下文切换保持在绝对最低限度。计算上的静态偏序很容易帮助实现所有 3 个；说起来容易，相对容易衡量成本，编译器很容易安排计算。（用这个编写并行快速排序很简单）。

不幸的是，我们在 1996 年做到了这一点 :-( 过去几年终于证明了这一点；我现在可以在 Fry's 以低于 1000 美元的价格购买 8 台核心机器，并以与小型汽车相同的价格购买 24 台核心机器（并且可能迅速下降）。

好消息是 DMS 现在已经相当成熟，并且 DMS 中有许多关键的内部机制利用了这一点，特别是一整类称为“属性语法”的分析器，我们使用特定领域的语言编写这不是套话。DMS 将这些属性语法编译成 PARLANSE，然后并行执行。我们的 C++ 前端使用属性语法，大约 100K sloc；它被编译成 800K SLOC 的并行 parlanse 代码，实际上可以可靠地工作。

现在（2009 年 6 月），我们正忙于使 DMS 变得有用，并且总是没有足够的时间来很好地利用并行性。因此，90 小时点分析。我们正在努力实现并行化，并有合理的希望加速 10-20 倍。

我们相信，从长远来看，充分利用 SMP 将使工作站对提出难题的工程师更加友好。他们也应该这样做。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-12T20:25:53.277

我的研究生工作是开发用于在嵌入式系统中进行裸机多核工作和教学的概念。

我还在使用 F# 来提高我的高级多进程语言工具的速度。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-12T23:13:12.547

我们的域逻辑在很大程度上基于工作流引擎，每个工作流实例都在 ThreadPool 之外运行。

这对我们来说已经足够了。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-12T23:22:39.737

我现在可以将我的主操作系统与我的开发分开/安装任何我喜欢的操作系统，使用带有 Virtual PC 或 VMWare 的虚拟化设置。

双核意味着一个 CPU 运行我的主机操作系统，另一个运行我的开发操作系统，性能相当不错。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-09-09T05:51:32.537

我在 Mac 上使用和编程。Grand Central Dispatch 为胜利而战。[Ars Technica](http://arstechnica.com/apple/reviews/2009/08/mac-os-x-10-6.ars/12)对 Snow Leopard 的评论有很多关于多核编程以及人们（或至少是 Apple）正在使用它的地方的有趣内容。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-12-24T00:45:19.790

学习一门函数式编程语言可能会使用多个内核……代价高昂。

我认为使用额外的内核并不难。作为 Web 应用程序，有一些琐碎的事情不需要额外注意，因为 Web 服务器会并行运行查询。这些问题是针对长时间运行的算法（长就是你所说的长）。这些需要拆分为不相互依赖的较小域，或同步依赖关系。很多算法都可以做到这一点，但有时需要非常不同的实现（再次成本）。

所以，除非你使用命令式编程语言，否则没有灵丹妙药，抱歉。要么您需要熟练的程序员（成本高昂），要么您需要转向其他编程语言（成本高昂）。或者你可能只是运气好（网络）。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2010-01-26T23:28:34.180

我决定在[DEFLATE](http://www.ietf.org/rfc/rfc1951.txt)算法的实现中利用多个内核。[MArc Adler 在 C 代码中使用PIGZ](http://www.c10n.info/archives/505)（并行 gzip）做了类似的事情。[我已经在DotNetZip v1.9](http://dotnetzip.codeplex.com)的托管代码库中提供了哲学等价物。这不是 PIGZ 的一个端口，而是一个类似的想法，独立实现。

DEFLATE 背后的想法是扫描数据块，查找重复序列，构建一个“字典”，将一个短“代码”映射到每个重复序列，然后发出一个字节流，其中一个重复序列的每个实例被字典中的“代码”替换。

因为构建字典是 CPU 密集型的，所以 DEFLATE 是并行化的完美候选者。我采用了 Map+Reduce 类型的方法，将传入的未压缩字节树划分为一组较小的块（映射），例如每个 64k，然后独立压缩这些块。然后我将生成的块连接在一起（减少）。每个 64k 块在其自己的线程上独立压缩，而不考虑其他块。

在双核机器上，这种方法的压缩时间大约是传统串行方法的 54%。在服务器级机器上，有更多可用内核，它可能会提供更好的结果；没有服务器机器，我没有亲自测试过，但人们告诉我它很快。

* * *

存在与多线程管理相关的运行时 (cpu) 开销、与每个 thead 的缓冲区相关的运行时内存开销以及与连接块相关的数据开销。所以这种方法只对更大的字节流有效。在我的测试中，超过 512k，它可以得到回报。在此之下，最好使用串行方法。

* * *

DotNetZip 作为库提供。我的目标是让这一切变得透明。因此，当缓冲区超过 512kb 时，库会自动使用额外的线程。为了使用线程，应用程序无需执行任何操作。它只是工作，当使用线程时，它神奇地更快。我认为对于应用程序使用的大多数库来说，这是一种合理的方法。

* * *

如果计算机能够智能地自动和动态地利用可并行算法上的资源，那将是一件好事，但今天的现实是应用程序设计人员必须明确编码并行化。

* * *

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2014-12-28T14:08:14.233

我正在利用使用 C、PThreads 的多核以及使用 PREEMPT_RT 补丁集的调度程序在带有 Linux 的 OpenVPX 平台上的通信顺序进程的自制实现。所有这些加起来几乎 100% 跨多个操作系统实例的 CPU 利用率，没有 CPU 时间用于 OpenVPX 机箱中的处理器卡之间的数据交换，而且延迟也非常低。还使用 sFPDP 将多个 OpenVPX 机箱连接到一台机器中。我没有使用 Xeon 的内部 DMA 来缓解 CPU 内部的内存压力（DMA 仍然以 CPU 内核为代价使用内存带宽）。相反，我们将数据留在原处并以 CSP 方式传递它的所有权（因此与 .NET 的任务并行数据流库的理念不同）。

1) 软件路线图——我们面临着最大限度地利用空间和可用功率的压力。充分利用最新硬件至关重要

2) 软件领域——有效的科学计算

3）我们正在用现有代码做什么？不断地将其拆分并在线程之间重新分配它的一部分，以便在不破坏实时要求的情况下最大限度地发挥每个核心的作用。新硬件意味着大量的重新思考（更快的内核可以在给定的时间内做更多的事情，不希望它们被充分利用）。不像听起来那么糟糕——核心例程非常模块化，因此很容易组装成线程大小的块。尽管我们计划从 Linux 中控制线程亲和性，但我们还没有设法通过这样做来获得显着的额外性能。Linux 非常擅长在或多或少相同的地方获取数据和代码。

4) 实际上已经存在 - 整台机器已经加起来多达数千个内核

5) 并行计算是必不可少的——它是一个 MISD 系统。

如果这听起来像是很多工作，那就是。有些工作需要全力以赴，充分利用可用的硬件，并避开几乎所有高水平的东西。我们发现总机器性能是 CPU 内存带宽的函数，而不是 CPU 核心速度、L1/L2/L3 缓存大小。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-01-26T23:45:21.553

1.  *这对您的软件路线图有何影响？*
    它没有。我们（与几乎所有其他）业务相关的应用程序在单核上运行得非常好。只要添加更多内核不会显着降低单线程应用程序的性能，我们就很高兴

2.  *......真实的故事......*
    像其他人一样，并行构建是我们获得的主要好处。不过，Visual Studio 2008 C# 编译器似乎并没有使用多个内核，这真的很糟糕

3.  *你在用你现有的代码做什么来利用多核机器*
    如果我们有一个可以并行化的长时间运行的算法，我们可能会考虑使用 .NET 并行扩展，但这种情况实际发生的可能性很小。最可能的答案是，一些开发人员会为了兴趣而玩弄它，但除此之外别无他求

4.  *您将如何处理数百或数千个内核？*
    头 -> 沙子。

5.  *如果您的领域不容易从并行计算中受益，那么解释为什么也很有趣。*
    客户端应用程序主要推送数据，服务器应用程序主要依赖 SQL Server 来完成繁重的工作

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-03T17:23:11.830

我使用 .Net 线程在 C# 中工作。您可以将面向对象的封装与线程管理结合起来。

我读过 Peter 的一些帖子，谈论 Packt Publishing 的一本新书，我在 Packt Publishing 网页中找到了以下文章：

[http://www.packtpub.com/article/simplifying-parallelism-complexity-c-sharp](http://www.packtpub.com/article/simplifying-parallelism-complexity-c-sharp)

我读过Joe Duffy 的书《Concurrent Programming with Windows》。现在，我正在等待希拉尔的书“C# 2008 和 2005 线程编程” - [http://www.amazon.com/2008-2005-Threaded-Programming-Beginners/dp/1847197108/ref=pd_rhf_p_t_2](https://rads.stackoverflow.com/amzn/click/com/1847197108)

我同意 Szundi 的“没有银弹”！

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-02-03T17:31:11.033

你说“对于 Web 应用程序来说，这非常非常容易：忽略它。除非你有一些真正需要并行完成的代码，否则你可以简单地编写老式的单线程代码并感到高兴。”

我正在使用 Web 应用程序，我确实需要充分利用并行性。我明白你的意思。但是，我们必须为多核革命做好准备。忽略它与忽略 90 年代的 GUI 革命一样。

我们不是还在为 DOS 开发吗？我们必须解决多核问题，否则我们将在多年后死去。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-08-03T11:40:11.340

我认为这种趋势首先会说服一些开发人员，然后他们中的大多数人会看到并行化是一项非常复杂的任务。我希望一些设计模式能够解决这种复杂性。不是低级别的，而是架构模式，这将很难做错事。

例如，我希望消息传递模式会变得流行，因为它本质上是异步的，但你不会考虑死锁或互斥锁或其他任何东西。

# c++ - 一旦你采用了 boost 的智能指针，有没有使用原始指针的情况？

> ID：363351
> 
> 赞同：12
> 
> 时间：2008-12-12T16:47:15.277
> 
> 标签：c++, boost, smart-pointers

我很好奇，因为我开始采用更多的 boost 习语以及似乎是最佳实践的最佳实践'还没有被介绍给“现代 C++”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T17:17:43.203

`shared_ptr`我几乎不使用，因为我通常避免共享所有权。因此，我使用类似`boost::scoped_ptr`“拥有”一个对象的东西，但对它的所有其他引用都将是原始指针。例子：

```
boost::scoped_ptr<SomeType> my_object(new SomeType);
some_function(my_object.get()); 
```

但`some_function`会处理一个原始指针：

```
void some_function(SomeType* some_obj)
{
  assert (some_obj);
  some_obj->whatever();
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-17T22:56:13.420

只是我的头顶上的一些：

*   在内存映射文件中导航。
*   您必须过度分配的 Windows API 调用（如 LPBITMAPINFOHEADER）。
*   您在任意内存（VirtualQuery() 等）中四处游荡的任何代码。
*   几乎任何时候你都在指针上使用 reinterpret_cast<> 。
*   任何时候使用placement-new。

这里的共同点是“任何情况下，您需要将一块内存视为您拥有分配控制权的资源以外的东西”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-12T16:59:11.320

这些天来，我几乎放弃了对原始指针的所有使用。我什至开始在我们的代码库中查找使用原始指针的地方，并将它们切换为智能指针变体。通过这个简单的操作，我能够删除多少代码，真是令人惊讶。在原始 C++ 指针的生命周期管理上浪费了太多代码。

我不使用指针的唯一地方是与我无法控制的其他代码库的几个互操作场景。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-12T17:27:29.593

我发现“现代” C++ 和旧* 东西之间的主要区别在于谨慎使用类不变量和封装。组织良好的代码自然倾向于有更少的指针飞来飞去。在 shared_ptrs 中游泳时，我几乎和在新闻和删除中一样紧张。

我很期待`unique_ptr`在 C++0x 中。我认为这将清理仍然在野外漫游的少数（智能）指针。

*不幸的是仍然很常见

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-12T17:41:23.483

当然，任何时候处理遗留库或 API 时都需要传递原始指针，尽管您可能只是暂时从智能指针中提取它。

事实上，将原始指针传递给函数总是安全的，只要函数不尝试将指针的副本保留在全局变量或成员变量中，或者尝试删除它。有了这些限制，函数就不能影响对象的生命周期，智能指针的唯一原因是管理对象的生命周期。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-12T16:59:43.737

我仍然在资源敏感代码或其他需要占用空间很小的代码中使用常规指针，例如某些异常，我不能假设任何数据都是有效的，并且还必须假设我的内存也快用完了。

托管内存几乎总是优于原始内存，因为这意味着您不必在正确的位置处理删除它，但仍然可以很好地控制指针的构造和销毁点。

哦，还有另一个地方可以使用原始指针：

```
boost::shared_ptr<int> ptr(new int); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-12T17:18:51.983

我仍然在具有内存映射 IO 的设备（例如嵌入式系统）上使用原始指针，在这些设备中拥有智能指针并没有真正意义，因为您永远不需要或无法使用`delete`它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-12T17:02:43.683

如果你有循环数据结构，例如，A 指向 B，B 指向 A，你不能天真地为 A 和 B 使用智能指针，因为那样对象只会被释放额外的工作。要释放内存，您必须手动清除智能指针，这与删除智能指针一样糟糕。

您可能会认为这种情况不会经常发生，但假设您的 Parent 对象具有指向一堆 Child 对象的智能指针。在某个地方，有人需要查找父级的子级，因此他们向子级添加了一个智能指针成员，该成员指向父级。默默地，内存不再被释放。

需要一些照顾。智能指针不等同于垃圾回收。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-12T17:54:20.210

我正在编写必须与 Objective C 共存的 C++（使用 Objective C++ 进行桥接）。因为声明为 Objective C++ 类的一部分的 C++ 对象没有调用构造函数或析构函数，所以您不能真正将它们保存在智能指针中。

所以我倾向于使用原始指针，尽管通常使用 boost::intrustive_ptr 和内部引用计数。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-12T21:00:38.010

并不是说我会这样做，但您需要原始指针来实现，例如，链表或图表。`std::list<>`但是使用or会更聪明`boost::graph<>`。

# html - HTML表格问题

> ID：363356
> 
> 赞同：2
> 
> 时间：2008-12-12T16:48:50.593
> 
> 标签：html, layout, html-table

我有一个 HTML 表格问题，我想更好地理解。

假设我有一个 3 行 HTML

```
<table>
    <tr>
        <td style="text-align:right;">A1</td>
        <td>A2</td>
    </tr>
    <tr>
        <td style="text-align:right;">B1</td>
        <td>B2</td>
    </tr>
    <tr>
        <td colspan="2">A very loooooooong string here</td>
    </tr>
</table> 
```

对于很长的文本，前 2 行中的内容看起来几乎居中。但是，如果我将整个“非常长的字符串”移动`<td>`到行内的一个单独`<table>`的行中，我会看到其他内容没有居中。为什么当`<td>`内容在另一个表中时显示不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T00:14:17.293

如果您的问题以 2 个表格结束，原始表格如下：

```
<table>
 <tr>
  <td style="text-align:right;">A1</td>
  <td>A2</td>
 </tr>
 <tr>
  <td style="text-align:right;">B1</td>
  <td>B2</td>
 </tr>
</table> 
```

并且 looooong 文本变成了自己的：

```
<table>
 <tr>
  <td colspan="2">A very loooooooong string here</td>
 </tr>
</table> 
```

那么第一个表的前两行不再看起来像居中的原因是因为它们不是 -**仅**当您相对于第二个表进行比较时。

如果您`border="1"`在 TABLE 属性中进行调试，您将看到包含它们的表折叠到尽可能宽的表数据单元格。正因为如此，他们看起来不像是居中的，尽管他们仍然是。

向第一个表格添加一些任意宽度，您会看到它们仍然居中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T16:53:29.163

你能提供你的第二个例子吗？当我创建以下内容时，它看起来仍然相同。您可能没有正确地将表格嵌入到 colspan 为 2 的表格单元格中。

```
<table border="1">
 <tr>
  <td style="text-align:right;">A1</td>
  <td>A2</td>
 </tr>
 <tr>
  <td style="text-align:right;">B1</td>
  <td>B2</td>
 </tr>
 <tr>
  <td colspan="2">
    <table border="1"><tr>
        <td>A very loooooooong string here</td>
    </tr></table>
  </td>
 </tr>
</table> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T16:58:41.977

在解释 HTML 的问题时，最好指出用于测试的浏览器......
无论如何，我用 FF3 和 IE6 进行了快速测试，我没有看到你描述的行为：使用嵌套表，长字符串的填充稍微多一些，但其他内容仍然在视觉上居中。
你应该显示你的其他代码。我的是：

```
<table>
 <tr>
  <td style="text-align:right;">A1</td>
  <td>A2</td>
 </tr>
 <tr>
  <td style="text-align:right;">B1</td>
  <td>B2</td>
 </tr>
 <tr>
  <td colspan="2"><table><tr><td>A very loooooooong string here</td></tr></table></td>
 </tr>
</table> 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-12-12T17:04:14.430

我想我知道你的意思，是你问题的第二部分基于：

```
<table>
 <tr>
  <td style="text-align:right;">A1</td>
  <td>A2</td>
 </tr>
 <tr>
  <td style="text-align:right;">B1</td>
  <td>B2</td>
 </tr>
 <tr>
  <table><td colspan="2">A very loooooooong string here</td></table>
 </tr>
</table> 
```

那么我猜表格内容呈现左对齐的原因是内部表格标签隐藏了外部表格的colspan。

答案是停止使用 html 来设置表格样式并改用 CSS！

# .net - 一段时间后，user.identity.name 变为空白

> ID：363358
> 
> 赞同：-2
> 
> 时间：2008-12-12T16:49:00.233
> 
> 标签：.net, asp.net

有谁知道为什么 user.identity.name 在大约（10 分钟）后变成空白，我使用的是 .Net Framework 1.1

编辑：
会话超时设置为 20 分钟
，在 web.config 的 system.web/authentication/forms 下没有设置超时

谢谢，
奥斯卡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T17:44:43.273

会话到期与 ASP.NET 身份验证无关。

可能是您的表单身份验证超时：默认为 30 分钟，并且使用 web.config 中 system.web/authentication/forms 元素的 timeout 属性进行配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T19:40:23.257

您是否检查过应用程序池的回收频率？如果在一定时间后没有设置回收，它可能会承受重载，因此达到极限并回收。在这一点上，你会失去你的会话。

另外，您如何分配 user.identity.name？如果是通过身份验证，用户是否也失去了身份验证或只是名称？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-09T05:07:21.877

这是因为在 IIS 上启用了匿名登录。我不知道它在最初的几分钟是如何工作的

# c# - 用于 WPF (C#) 的优秀开源报告工具/框架

> ID：363363
> 
> 赞同：19
> 
> 时间：2008-12-12T16:50:30.213
> 
> 标签：c#, wpf, open-source, reporting

我正在为基于 Windows 的应用程序 (WPF) 寻找一个好的开源报告工具/框架。

我使用的数据库是 sql server 2005。

我感兴趣的典型报告格式是试算表、资产负债表等（典型的银行/金融报告应用程序）。

图表也应该有很好的支持。

如果有人对 WPF 应用程序的报告有任何经验，您的意见将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-11T19:02:05.487

看看[http://wpfreports.codeplex.com/](http://wpfreports.codeplex.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-14T04:41:23.473

由于这可能构成答案的一部分，我想把它放在答案部分。刚找到这个系列文章 [WPF多页报告](https://web.archive.org/web/20121214141444/http://janrep.blog.codeplant.net/post/WPF-Multipage-Reports-Part-I.aspx) **（注：原链接失效，替换为Wayback Machine链接）**。

考虑将其放在这里，因为这可能会使其他学习者受益。本文介绍如何为 LOB 应用程序创建报告框架。

俗话说“手上一鸟，灌木丛中二”，我会深入研究这一点，直到其他人想出更好的东西:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-06T05:44:52.813

[PdfReport](http://pdfreport.codeplex.com/)是一个代码优先的报告引擎，它建立在 iTextSharp 和 EPPlus 库之上。它与 .NET 3.5+ Web 和 Windows 应用程序兼容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-13T01:17:49.443

作为开源，这不存在，至少现在不存在。它可能也不存在商业产品。WPF 组件市场才刚刚起步。

# sql-server - 浏览 SQL Server

> ID：363370
> 
> 赞同：2
> 
> 时间：2008-12-12T16:51:11.260
> 
> 标签：sql-server, windows-networking

我正在编写一个连接到 SQL 服务器的数据库应用程序。我想实现一个类似于 SQL Management Studio 中的连接对话框。我已经找到了一种获取服务器上数据库列表的方法，但我真的很想获取网络上可用服务器的列表，这样最终用户就不必输入服务器的名称/IP .

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T17:13:56.627

如果您在 .Net 中开发程序，您可以使用 SMO 对象来执行此操作。使用 Microsoft.SqlServer.Management.Smo.SmoApplication.EnumAvailableSqlServers 方法获取本地网络中运行的所有 sql 服务器的列表。
扫描需要几秒钟，但不是很慢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T16:59:36.220

从[这里](http://sqlserver2000.databases.aspfaq.com/how-do-i-find-all-the-available-sql-servers-on-my-network.html)：

```
CREATE PROCEDURE dbo.ListLocalServers 
AS 
BEGIN 
    SET NOCOUNT ON 

    CREATE TABLE #servers(sname VARCHAR(255)) 

    INSERT #servers EXEC master..XP_CMDShell 'OSQL -L' 
    -- play with ISQL -L too, results differ slightly 

    DELETE #servers WHERE sname='Servers:' 

    SELECT LTRIM(sname) FROM #servers WHERE sname != 'NULL' 

    DROP TABLE #servers 
END 
```

[此处的](http://groups.google.com/group/microsoft.public.sqlserver.programming/msg/caaae2403daf3d05?pli=1)替代 SQL DMO 方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T17:00:55.933

不确定是否有正确的方法，但一种技巧是尝试将端口 1433（默认 mssqlserver 端口）连接到网络中的机器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T17:01:04.530

[来自sqlsecurity.com](http://www.sqlsecurity.com/Tools/FreeTools/tabid/65/Default.aspx)的工具 SQLPing 旧版本下载包含可能有用的源代码。

实际上，您需要在网络上的每个 IP 地址上查询端口 1434 UDP。但是，防火墙和策略会阻止这一点。

注意：1434 是您在服务器上枚举 SQL 实例的位置。如果您只使用默认实例，那么端口 1433 就可以了。除非它在端口 2433 上“隐藏”...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T17:02:28.117

如果可以的话，您最好的猜测是提前填充列表。

扫描网络以查找 SQL 服务器可能不是最好的主意（缓慢、不可靠）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T17:09:51.410

开始可能是获取[MS 网络监视器](http://www.microsoft.com/downloads/details.aspx?familyid=f4db40af-1e08-4a21-a26b-ec2f4dc4190d)，然后在单击 MSSMS 中的下拉菜单时查看它的作用。

我的猜测是（当您单击该下拉菜单时会有延迟）是它轮询本地网络。

话虽如此，在我的办公室里，它似乎比*本地*网络轮询更多，因为它获取位于公司网络内但在其他子网上的服务器。

祝你好运

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T17:25:02.767

也许 SQLCMD /L 会为你工作。

# c# - 如何在新线程中运行一些简单的代码？

> ID：363377
> 
> 赞同：377
> 
> 时间：2008-12-12T16:53:49.100
> 
> 标签：c#, .net, multithreading

我有一些代码需要在与 GUI 不同的线程中运行，因为它当前会导致表单在代码运行时冻结（大约 10 秒）。

假设我以前从未创建过新线程；什么是如何在 C# 中使用 .NET Framework 2.0 或更高版本执行此操作的简单/基本示例？

* * *

## 回答 #1

> 赞同：381
> 
> 时间：2012-11-28T17:38:55.760

开始阅读的好地方是[Joe Albahari](http://www.albahari.com/threading/)。

如果你想创建自己的线程，这很简单：

```
using System.Threading;
new Thread(() => 
{
    Thread.CurrentThread.IsBackground = true; 
    /* run your code here */ 
    Console.WriteLine("Hello, world"); 
}).Start(); 
```

* * *

## 回答 #2

> 赞同：195
> 
> 时间：2009-01-27T02:58:18.187

`BackgroundWorker` seems to be best choice for you.

Here is my minimal example. After you click on the button the background worker will begin working in background thread and also report its progress simultaneously. It will also report after the work completes.

```
using System.ComponentModel;
...
    private void button1_Click(object sender, EventArgs e)
    {
        BackgroundWorker bw = new BackgroundWorker();

        // this allows our worker to report progress during work
        bw.WorkerReportsProgress = true;

        // what to do in the background thread
        bw.DoWork += new DoWorkEventHandler(
        delegate(object o, DoWorkEventArgs args)
        {
            BackgroundWorker b = o as BackgroundWorker;

            // do some simple processing for 10 seconds
            for (int i = 1; i <= 10; i++)
            {
                // report the progress in percent
                b.ReportProgress(i * 10);
                Thread.Sleep(1000);
            }

        });

        // what to do when progress changed (update the progress bar for example)
        bw.ProgressChanged += new ProgressChangedEventHandler(
        delegate(object o, ProgressChangedEventArgs args)
        {
            label1.Text = string.Format("{0}% Completed", args.ProgressPercentage);
        });

        // what to do when worker completes its task (notify the user)
        bw.RunWorkerCompleted += new RunWorkerCompletedEventHandler(
        delegate(object o, RunWorkerCompletedEventArgs args)
        {
            label1.Text = "Finished!";
        });

        bw.RunWorkerAsync();
    } 
```

**Note:**

*   I put everything in single method using C#'s anonymous method for simplicity but you can always pull them out to different methods.
*   It is safe to update GUI within `ProgressChanged` or `RunWorkerCompleted` handlers. However, updating GUI from `DoWork` will cause `InvalidOperationException`.

* * *

## 回答 #3

> 赞同：103
> 
> 时间：2008-12-12T16:59:50.757

[ThreadPool.QueueUserWorkItem](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.queueuserworkitem.aspx)非常适合简单的事情。唯一需要注意的是从另一个线程访问控件。

```
System.Threading.ThreadPool.QueueUserWorkItem(delegate {
    DoSomethingThatDoesntInvolveAControl();
}, null); 
```

* * *

## 回答 #4

> 赞同：85
> 
> 时间：2008-12-12T16:59:39.807

又快又脏，但它会起作用：

在顶部使用：

```
using System.Threading; 
```

简单的代码：

```
static void Main( string[] args )
{
    Thread t = new Thread( NewThread );
    t.Start();
}

static void NewThread()
{
    //code goes here
} 
```

我只是把它扔到一个新的控制台应用程序中作为一个例子

* * *

## 回答 #5

> 赞同：82
> 
> 时间：2015-08-03T02:25:17.317

这是另一种选择：

```
Task.Run(()=>{
//Here is a new thread
}); 
```

* * *

## 回答 #6

> 赞同：40
> 
> 时间：2008-12-12T16:56:54.727

尝试使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)类。你给它代表运行什么，并在工作完成时得到通知。我链接到的 MSDN 页面上有一个示例。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2009-08-06T15:25:04.417

如果你想得到一个值：

```
var someValue;

Thread thread = new Thread(delegate()
            {                 
                //Do somthing and set your value
                someValue = "Hello World";
            });

thread.Start();

while (thread.IsAlive)
  Application.DoEvents(); 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-12-12T17:00:47.090

将该代码放在一个函数中（不能在与 GUI 相同的线程上执行的代码），并触发该代码的执行，请放置以下内容。

`Thread myThread= new Thread(nameOfFunction);`

`workerThread.Start();`

在线程对象上调用 start 函数将导致在新线程中执行函数调用。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2016-10-15T14:34:42.980

这里如何使用带有 progressBar 的线程，它只是为了了解线程是如何工作的，形式上有 3 个 progressBar 和 4 个按钮：

```
 public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }
    Thread t, t2, t3;
    private void Form1_Load(object sender, EventArgs e)
    {

        CheckForIllegalCrossThreadCalls = false;

         t = new Thread(birinicBar); //evry thread workes with a new progressBar

         t2 = new Thread(ikinciBar);

         t3 = new Thread(ucuncuBar);

    }

    public void birinicBar() //to make progressBar work
    {
        for (int i = 0; i < 100; i++) {
            progressBar1.Value++;
            Thread.Sleep(100); // this progressBar gonna work faster
        }
    }

    public void ikinciBar()
    {
        for (int i = 0; i < 100; i++)
        {
            progressBar2.Value++;
            Thread.Sleep(200);
        }

    }

    public void ucuncuBar()
    {
        for (int i = 0; i < 100; i++)
        {
            progressBar3.Value++;
            Thread.Sleep(300);
        }
    }

    private void button1_Click(object sender, EventArgs e) //that button to start the threads
    {
        t.Start();
        t2.Start(); t3.Start();

    }

    private void button4_Click(object sender, EventArgs e)//that button to stup the threads with the progressBar
    {
        t.Suspend();
        t2.Suspend();
        t3.Suspend();
    }

    private void button2_Click(object sender, EventArgs e)// that is for contuniue after stuping
    {
        t.Resume();
        t2.Resume();
        t3.Resume();
    }

    private void button3_Click(object sender, EventArgs e) // finally with that button you can remove all of the threads
    {
        t.Abort();
        t2.Abort();
        t3.Abort();
    }
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-01-26T19:51:56.627

```
// following declaration of delegate ,,,
public delegate long GetEnergyUsageDelegate(DateTime lastRunTime, 
                                            DateTime procDateTime);

// following inside of some client method
GetEnergyUsageDelegate nrgDel = GetEnergyUsage;
IAsyncResult aR = nrgDel.BeginInvoke(lastRunTime, procDT, null, null);
while (!aR.IsCompleted) Thread.Sleep(500);
int usageCnt = nrgDel.EndInvoke(aR); 
```

查尔斯您的代码（上图）不正确。您无需旋转等待完成。EndInvoke 将阻塞，直到 WaitHandle 发出信号。

如果你想阻止直到完成，你只需要

```
nrgDel.EndInvoke(nrgDel.BeginInvoke(lastRuntime,procDT,null,null)); 
```

或者

```
ar.AsyncWaitHandle.WaitOne(); 
```

但是如果你阻塞了，那么发出 anyc 调用有什么意义呢？您不妨只使用同步调用。更好的选择是不阻塞并传入 lambda 进行清理：

```
nrgDel.BeginInvoke(lastRuntime,procDT,(ar)=> {ar.EndInvoke(ar);},null); 
```

要记住的一件事是您**必须**调用 EndInvoke。很多人忘记了这一点并最终泄漏了 WaitHandle，因为大多数异步实现在 EndInvoke 中释放了等待句柄。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-26T20:08:42.647

如果要使用原始 Thread 对象，则需要至少将 IsBackground 设置为 true，并且还应该设置 Threading Apartment 模型（可能是 STA）。

```
public static void DoWork()
{
    // do some work
}

public static void StartWorker()
{
    Thread worker = new Thread(DoWork);
    worker.IsBackground = true;
    worker.SetApartmentState(System.Threading.ApartmentState.STA);
    worker.Start()
} 
```

如果您需要 UI 交互，我会推荐 BackgroundWorker 类。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-12T17:03:48.503

另一种选择，使用委托和线程池......

假设“GetEnergyUsage”是一个将 DateTime 和另一个 DateTime 作为输入参数的方法，并返回一个 Int ...

```
// following declaration of delegate ,,,
public delegate long GetEnergyUsageDelegate(DateTime lastRunTime, 
                                            DateTime procDateTime);

// following inside of some client method 
GetEnergyUsageDelegate nrgDel = GetEnergyUsage;                     
IAsyncResult aR = nrgDel.BeginInvoke(lastRunTime, procDT, null, null);
while (!aR.IsCompleted) Thread.Sleep(500);
int usageCnt = nrgDel.EndInvoke(aR); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-12T18:57:58.820

在 .Net 中运行不同线程的方式有很多种，每种方式都有不同的行为。GUI退出后是否需要继续运行线程？您需要在线程和 GUI 之间传递信息吗？线程是否需要更新 GUI？线程应该执行一项任务然后退出，还是应该继续运行？这些问题的答案将告诉您使用哪种方法。

Code Project 网站上有一篇很好的[异步方法文章，描述了各种方法并提供了示例代码。](https://www.codeproject.com/Articles/14931/Asynchronous-Method-Invocation)

请注意，本文是在将[异步/等待](http://msdn.com/async)模式和[任务并行库](https://docs.microsoft.com/en-us/dotnet/standard/parallel-programming/task-parallel-library-tpl)引入 .NET 之前编写的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-12T17:38:49.337

[如何：使用后台线程搜索文件](http://msdn.microsoft.com/en-us/library/3s8xdz5c.aspx)

您必须非常小心地从其他线程访问特定于 GUI 的东西（这对于许多 GUI 工具包来说很常见）。如果您想从处理线程更新 GUI 中的某些内容，请检查我认为对 WinForms 有用的[这个答案。](https://stackoverflow.com/questions/10349/in-winforms-why-cant-you-update-ui-controls-from-other-threads#10359)对于 WPF 看到[这个](http://mikescodeblog.blogspot.com/2007/12/wpf-progress-bars.html)（它显示了如何在 UpdateProgress() 方法中触摸组件，以便它可以从其他线程工作，但实际上我不喜欢它在通过 Dispathcer`CheckAccess()`之前不做，[请参阅](http://blog.paranoidferret.com/index.php/2008/06/25/working-with-the-wpf-dispatcher/)并在其中搜索 CheckAccess）`BeginInvoke`

正在寻找有关线程的 .NET 特定书籍，并找到[了这本](http://www.albahari.com/threading/threading.pdf)（可免费下载）。有关它的更多详细信息，请参见[http://www.albahari.com/threading/](http://www.albahari.com/threading/)。

我相信您会在前 20 页中找到作为新线程启动执行所需的内容，并且它还有更多（不确定 GUI 特定的片段，我的意思是严格特定于线程）。很高兴听到社区对这项工作的看法，因为我正在阅读这个。现在对我来说看起来很整洁（用于显示 .NET 特定的线程方法和类型）。它还涵盖了我真正欣赏的 .NET 2.0（而不是古老的 1.1）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-27T02:22:47.587

我建议查看 Jeff Richter 的[Power Threading Library](http://wintellect.com/PowerThreading.aspx)，特别是 IAsyncEnumerator。看一下[Charlie Calvert](http://blogs.msdn.com/charlie/archive/2008/12/03/jeff-richter-video-on-asynchronous-programming-and-his-power-threading-library.aspx)博客上的视频，Richter 对其进行了全面的了解。

不要被这个名字吓到，因为它使异步编程任务更容易编码。

# visual-studio - Visual Studio 网页设计

> ID：363410
> 
> 赞同：1
> 
> 时间：2008-12-12T16:59:58.120
> 
> 标签：visual-studio, visual-studio-2005

我正在使用 Visual Studio 2005 并且一直在构建 asp.net 应用程序。大多数只是用于报告和数据维护的部门级应用程序。他们工作，他们看起来不错，但他们看起来不太好。我没有任何其他工具，例如 Dreamweaver 或 Expression。任何人都可以命名任何书籍或资源，以便在 Visual Studio 中制作更好看的网页。

谢谢，

比利

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T17:08:41.957

老实说，IDE 在设计工作方面做得相当不错。我们正在将我们的设计师从 Dreamweaver 过渡到 Visual Studio 2008，他们肯定喜欢这些工具。

不要采取错误的方式，但是有些人就是无法使页面看起来不错，无论它是什么工具。我是那些人的其中一个。我可以整天编码，但如果我需要将一个页面放在一起，它看起来就像是 90 年代的东西。

我建议您寻找一些 HTML 模板，并根据您的产品进行调整。那里有开源模板，并且可以用相对较少的钱购买。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T17:06:46.767

我总是尝试自己编写代码，而不是使用设计工具。

您可以使用 CSS 和 HTML 做很多事情，了解这些部分如何组合在一起很重要。

如果您正在寻找一些好的网站设计示例，我建议您查看[http://csszengarden.com](http://csszengarden.com)

他们有很多不同的设计，都基于同一个 HTML 文件，所以它让你对 CSS 的可能性有一个很好的视角。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T17:08:19.213

我的朋友雅各布桑福德有一本书你应该看看：

[专业的 ASP.Net 设计](http://www.wrox.com/WileyCDA/WroxTitle/Professional-ASP-NET-2-0-Design-CSS-Themes-and-Master-Pages.productCd-0470124482.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T17:11:12.310

您需要做的第一件事是学习 CSS。如果你不知道用来做任何事情的技术，你就不能指望设计任何东西。我将从[HTML-Dog 教程](http://htmldog.com/)开始，然后从那里开始。更重要的是实际上具有良好的设计感，而这要困难得多。

设计技巧与dreamweaver 没有任何关系。为了培养良好的设计感，您需要开始对您访问的网站进行反省。想想为什么事情看起来好或坏。结合你的 CSS 知识，当你看到一些看起来很酷的东西时，想想你将如何实现它。如果你不知道，源代码就在那里，所以需要一些时间来弄清楚。

我已经这样做了大约 5 年了，但我仍然不擅长想出新的设计。（虽然，我比刚开始时做得更好。）当我开始一个网站时，我所做的就是从其他地方抄袭基本设计，并把它变成我自己的。对于 ASP，我使用 devexpress 控件，它有很多漂亮的主题，所以通常我最终只是将控件的外观和感觉扩展到站点的其余部分。

# html - 如何在 XSL 中制作目录框架？

> ID：363420
> 
> 赞同：0
> 
> 时间：2008-12-12T17:02:06.760
> 
> 标签：html

我有一个正在为其创建 XSL 样式表的 XML 文件。

我想要的是有两个框架并对数据进行两次传递，第一个将在左侧框架中创建一个目录，第二个将在右侧具有数据主体。

我可以做两次传球，问题是将它们放在不同的帧中。框架 HTML 元素接受一个源；我不能把我的来源直接放在那里。

我可以想出几种方法来解决这个问题，但没有一个让我感到兴奋，所以我想看看是否有人找到了解决这个问题的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-12T17:29:12.697

如果要使用框架，则需要三个单独的文件。

1.  框架文件。这只是一个严格的 HTML 文件
2.  目录文件
3.  您的内容的文件

第一个是指定的只是一个 HTML 文件。后两个是最终会变成 HTML 的 XSL 文件。[W3Schools](http://www.w3schools.com/HTML/html_frames.asp)上有一个很好的框架教程。

**编辑**：我越想这个，我就越不喜欢这个解决方案。每次提供初始页面时，它要求 XSL 解析器运行两次

您是否考虑过使用 CSS 或表格来进行布局？互联网上有一些非常好的[开源 CSS 模板](http://www.oswd.org/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T18:21:18.170

这是由脚本生成的相对稳定的数据，所以我最终做的是为 TOC 和主窗口创建单独的样式表，然后在生成 html 后使用它们为每个样式表生成 html 文件。

然后我的主页只是一个引用这些生成的 html 文件的静态 html 页面。

可能有更好的方法，但这是一个内部参考，所以这足以让我继续前进。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-15T18:35:16.973

如前所述，您需要 3 个文件。

在 XSLT 2.0 中，您可以使用 xsl:result-document 指令从一个 xsl 样式表生成多个输出文件。

在 XSLT 1.0 中，您没有该功能，但根据处理器，它可能是可能的。例如，对于 Xalan，请参阅[http://xml.apache.org/xalan-j/extensions_xsltc.html#redirect_ext](http://xml.apache.org/xalan-j/extensions_xsltc.html#redirect_ext)

# php - 如何在 HTML 中换行没有空格的长行？

> ID：363425
> 
> 赞同：69
> 
> 时间：2008-12-12T17:03:49.393
> 
> 标签：php, html, css, word-wrap

如果用户在没有任何空格或空白的情况下输入长行，它将通过比当前元素更宽来破坏格式。就像是：

> 哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈…………………… ..................................................... ………………………………………………………………………………………………………………………………………………

我试过只`wordwrap()`在 PHP 中使用，但问题是如果有链接或其他一些有效的 HTML，它就会中断。

CSS 中似乎有一些选项，但它们都不适用于所有浏览器。请参阅 IE 中的自动换行。

你怎么解决这个问题？

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2010-10-18T11:19:04.970

在 CSS3 中：

```
word-wrap:break-word 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2011-09-25T09:54:58.140

我试图解决同样的问题，我在这里找到了解决方案：

[http://perishablepress.com/press/2010/06/01/wrapping-content/](http://perishablepress.com/press/2010/06/01/wrapping-content/)

解决方案：向容器中添加以下 CSS 属性

```
div {
    white-space: pre;           /* CSS 2.0 */
    white-space: pre-wrap;      /* CSS 2.1 */
    white-space: pre-line;      /* CSS 3.0 */
    white-space: -pre-wrap;     /* Opera 4-6 */
    white-space: -o-pre-wrap;   /* Opera 7 */
    white-space: -moz-pre-wrap; /* Mozilla */
    white-space: -hp-pre-wrap;  /* HP Printers */
    word-wrap: break-word;      /* IE 5+ */
} 
```

我们的想法是全部使用它们，以便您获得更好的跨浏览器兼容性

希望这可以帮助

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-12-12T17:12:20.747

我喜欢使用`overflow: auto`CSS 属性/值配对。这将以您期望的方式呈现父对象。如果父项中的文本太宽，则滚动条会出现在对象本身内。这将使结构保持您希望的外观，并为查看者提供滚动查看更多内容的能力。

编辑：与`overflow: auto`相比的好处`overflow: scroll`是，`auto`滚动条仅在存在溢出内容时才会出现。使用`scroll`，滚动条始终可见。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-12T17:30:29.620

我没有亲自使用过它，但[Hyphenator](http://code.google.com/p/hyphenator/)看起来很有希望。

另请参阅相关（可能重复）问题：

*   [css / js中的自动换行](https://stackoverflow.com/questions/322929/word-wrap-in-css-js)
*   [谁解决了 long-word-breaks-my-div 问题？（提示：不是stackoverflow）](https://stackoverflow.com/questions/320184/who-has-solved-the-long-word-breaks-my-div-problem-hint-not-stackoverflow)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-12-23T03:16:32.547

我很惊讶没有人提到我最喜欢的解决这个问题的方法之一，即`<wbr>`（可选换行符）标签。它[在浏览器中得到了很好的支持，](http://www.quirksmode.org/oddsandends/wbr.html)并且基本上告诉浏览器它*可以*在必要时插入换行符。还有相关的零宽度空格字符，`&#8203;`含义相同。

对于提到的用例，在网页上显示用户评论，我假设已经有一些输出格式来防止注入攻击等。所以很容易在太长的单词或链接中的`<wbr>`每个字符中添加这些标签`N`.

这在您需要控制输出格式时特别有用，而 CSS 并不总是允许您这样做。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-12-12T17:10:19.253

我会将帖子放在一个 div 中，该 div 具有固定宽度设置溢出以滚动（或根据内容完全隐藏）。

就像：

```
#post{
    width: 500px;
    overflow: scroll;
} 
```

但这只是我。

编辑：正如**cLFlaVA**指出的那样......最好使用`auto`then `scroll`。我同意他的看法。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-12T17:21:03.773

没有“完美”的 HTML/CSS 解决方案。

解决方案要么隐藏溢出（即滚动或只是隐藏）或扩展以适应。没有魔法。

问：如何将一个 100 厘米宽的物体放入只有 99 厘米宽的空间中？

答：你不能。

你可以阅读[断词](http://css-discuss.incutio.com/?page=WordWrapLongText)

**编辑**

请查看此解决方案 [如何使用 css 应用换行/延续样式和代码格式](https://stackoverflow.com/questions/330229/how-to-apply-a-line-wrapcontinuation-style-and-code-formatting-with-css)

或者

[如何防止长词破坏我的div？](https://stackoverflow.com/questions/320184/who-has-solved-the-long-word-breaks-my-div-problem-hint-not-stackoverflow)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-12T17:06:11.463

我通过没有像这样固定我的右侧边栏来躲避这个问题：P

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-12T17:11:29.797

这是我在 ASP.NET 中所做的：

1.  在空格上拆分文本字段以获取所有单词
2.  迭代单词以查找长度超过一定数量的单词
3.  插入每 x 个字符（例如每 25 个字符。）

我查看了其他基于 CSS 的方法，但没有找到任何可以跨浏览器工作的方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-07T19:28:48.537

根据乔恩的建议，我创建的代码：

```
public static string WrapWords(string text, int maxLength)
    {
        string[] words = text.Split(' ');
        for (int i = 0; i < words.Length; i++)
        {
            if (words[i].Length > maxLength) //long word
            {
                words[i] = words[i].Insert(maxLength, " ");
                //still long ?
                words[i]=WrapWords(words[i], maxLength);
            }
        }
        text = string.Join(" ", words);
        return (text);
    } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-09-04T23:09:12.270

我不想仅仅为了断字而在我的页面中添加库。然后我写了一个简单的函数，我在下面提供，希望它对人们有所帮助。

（它打破了 15 个字符，并在其间应用了“& shy;”，但您可以在代码中轻松更改）

```
//the function:
BreakLargeWords = function (str)
{
    BreakLargeWord = function (word)
    {
        var brokenWords = [];
        var wpatt = /\w{15}|\w/igm;
        while (wmatch = wpatt.exec(word))
        {
            var brokenWord = wmatch[0];
            brokenWords.push(brokenWord);
            if (brokenWord.length >= 15) brokenWords.push("&shy;");
        }
        return brokenWords.join("");
    }

    var match;
    var word = "";
    var words = [];
    var patt = /\W/igm;
    var prevPos = 0;
    while (match = patt.exec(str))
    {
        var pos = match.index;
        var len = pos - prevPos;
        word = str.substr(prevPos, len);

        if (word.length > 15) word = BreakLargeWord(word);

        words.push(word);
        words.push(match[0]);
        prevPos = pos + 1;
    }
    word = str.substr(prevPos);
    if (word.length > 15) word = BreakLargeWord(word);
    words.push(word);
    var text = words.join("");
    return text;
}

//how to use
var bigText = "Why is this text this big? Lets do a wrap <b>here</b>! aaaaaaaaaaaaa-bbbbb-eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee";
var goodText = BreakLargeWords(bigText); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-06-22T23:00:28.323

将零宽度空格 ( `&#8203;`) 添加到字符串中，它将换行。

这是一个 Javacript 示例：

```
let longWordWithOutSpace = 'pneumonoultramicroscopicsilicovolcanoconiosis';
// add &#8203; between every character to make it wrap
longWordWithOutSpace.split('').join('&#8203;'); 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2010-01-11T13:22:19.853

我已经发布了一个解决方案，它使用 JavaScript 和一个简单的正则表达式来打破长词，这样就可以在不破坏您的网站布局的情况下对其进行包装。

[使用 CSS 和 JavaScript 换行](http://www.hemanshubhojak.com/Home/Post?postId=8)

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2011-09-09T15:01:35.097

我知道这是一个非常古老的问题，因为我遇到了同样的问题，所以我寻找了一个简单的解决方案。正如在第一篇文章中提到的，我决定使用 php-function 自动换行。

有关信息，请参阅以下代码示例；-)

```
<?php
    $v = "reallyreallyreallylonglinkreallyreallyreallylonglinkreallyreallyreallylonglinkreallyreallyreallylonglinkreallyreallyreallylonglinkreallyreallyreallylonglink";
    $v2 = wordwrap($v, 12, "<br/>", true);
?>
<html>
    <head>
        <title>test</title>
    </head>
    <body>
        <table width="300" border="1">
            <tr height="30">
                <td colspan="3" align="center" valign="top">test</td>
            </tr>
            <tr>
                <td width="100"><a href="<?php echo $v; ?>"><?php echo $v2; ?></a></td>
                <td width="100">&nbsp;</td>
                <td width="100">&nbsp;</td>
            </tr>
        </table>
    </body>
</html> 
```

希望这可以帮助。

# c++ - 寻找更好的 C++ 类工厂

> ID：363453
> 
> 赞同：7
> 
> 时间：2008-12-12T17:12:20.077
> 
> 标签：c++, design-patterns

我有一个包含多个对象的应用程序（到目前为止大约有 50 个，但还在增长）。应用程序中每个对象只有一个实例，并且这些实例在组件之间共享。

我所做的是从基础 BrokeredObject 类派生所有对象：

```
class BrokeredObject
{
  virtual int GetInterfaceId() = 0;
}; 
```

每个对象类型都返回一个唯一的 ID。这些 ID 保存在头文件中。

然后我有一个 ObjectBroker“工厂”。当有人需要一个对象时，调用 GetObjectByID()。boker 在 STL 列表中查找对象是否已经存在，如果存在，则返回它。如果没有，它会创建它，将其放入列表中并返回它。一切都很好。

```
BrokeredObject *GetObjectByID(int id)
{
  BrokeredObject *pObject;
  ObjectMap::iterator = m_objectList.find(id);
  // etc.
  if(found) return pObject;

  // not found, so create
  switch(id)
  {
    case 0: pObject = new TypeA; break;
    case 1: pObject = new TypeB; break;
    // etc.
    // I loathe this list
  }
  // add it to the list
  return pObject;
} 
```

我觉得痛苦的是维护这个 ID 列表并且必须让每个类都实现它。通过让每种类型都保存有关其自己的 ID 的信息，我至少让我的消费者的生活稍微轻松了一点，如下所示：

```
class TypeA : public BrokeredObject
{
  static int get_InterfaceID() { return IID_TYPEA; }
  int GetInterfaceID() { return get_InterfaceID(); }
}; 
```

所以我可以得到这样的对象：

```
GetObjectByID(TypeA::get_InterfaceID()); 
```

不必真正知道 ID 映射是什么，但我仍然对维护和潜在的错误不感兴趣。似乎如果我知道类型，为什么我还必须知道 ID？

我渴望在 C# 中是这样的：

```
BrokeredObject GetOrCreateObject<T>() where T : BrokeredObject
{
  return new T();
} 
```

ObjectBroker 将根据传入的*类型*创建对象。

C# 是否宠坏了我，而 C++ 无法做到这一点只是生活中的一个事实，或者有没有办法实现这一点，而我没有看到？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-12T17:36:55.987

是的，有办法。即使在 C++ 中，对于 C# 代码所做的事情也非常简单（尽管不检查继承）：

```
template<typename T>
BrokeredObject * GetOrCreateObject() {
  return new T();
} 
```

这将与 C# 代码一样工作并执行相同的操作。它也是类型安全的：如果您传递的类型不是从 BrokeredObject 继承的（或者不是该类型本身），那么编译器会在 return 语句中抱怨。然而，它总是会返回一个新对象。

### 辛格尔顿

正如另一个人建议的那样（感谢他），这一切看起来都非常适合单例模式。只需`TypeA::getInstance()`将唯一的实例存储在该类的静态变量中即可。我想这会比上述方法容易得多，不需要 ID 来解决它（我之前在这个答案中展示了一种使用模板存储 ID 的方法，但我发现它实际上就是单例）。

我已经读到您将有机会拥有多个类的实例。一种方法是拥有一个*Mingleton*（我编造了这个词 :)）

```
enum MingletonKind {
    SINGLETON,
    MULTITON
};

// Singleton
template<typename D, MingletonKind>
struct Mingleton {
    static boost::shared_ptr<D> getOrCreate() {
        static D d;
        return boost::shared_ptr<D>(&d, NoopDel());
    }

    struct NoopDel {
        void operator()(D const*) const { /* do nothing */ }
    };
};

// Multiton
template<typename D>
struct Mingleton<D, MULTITON> {
    static boost::shared_ptr<D> getOrCreate() {
        return boost::shared_ptr<D>(new D);
    }
};

class ImASingle : public Mingleton<ImASingle, SINGLETON> {
public:
    void testCall() { }
    // Indeed, we have to have a private constructor to prevent
    // others to create instances of us.
private:
    ImASingle() { /* ... */ }
    friend class Mingleton<ImASingle, SINGLETON>;
};

class ImAMulti : public Mingleton<ImAMulti, MULTITON> {
public:
    void testCall() { }
    // ...
};

int main() {
    // both do what we expect.
    ImAMulti::getOrCreate()->testCall();
    ImASingle::getOrCreate()->testCall();
} 
```

现在，您只需使用`SomeClass::getOrCreate()`它，它就会关心细节。shared_ptr 单例中的自定义删除器使删除成为无操作，因为 shared_ptr 拥有的对象是静态分配的。但是，要注意静态变量的破坏顺序问题：[静态初始化顺序惨败](https://stackoverflow.com/questions/335369/finding-c-static-initialization-order-problems)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-13T01:31:12.940

我解决这个问题的方法是使用我所说的静态注册表模式，在我看来，它是 C++ 版本的依赖注入。

基本上，您有一个类型的构建器对象的静态列表，用于构建另一种类型的对象。

一个基本的静态注册表实现如下所示：

```
template <class T>
class StaticRegistry
{
public:
    typedef std::list<T*>   Container;

    static  StaticRegistry<T>&  GetInstance()
    {
        if (Instance == 0)
        {
            Instance = new StaticRegistry<T>;
        }
        return *Instance;
    }

    void    Register(T* item)
    {
        Items.push_back(item);
    }

    void    Deregister(T* item)
    {
        Items.remove(item);
        if (Items.empty())
        {
            delete this;
            Instance = 0;
        }
    }

    typedef typename Container::const_iterator  const_iterator;

    const_iterator begin() const
    {
        return Items.begin();
    }

    const_iterator end() const
    {
        return Items.end();
    }

protected:
    StaticRegistry() {}
    ~StaticRegistry() {}

private:
    Container               Items;

    static StaticRegistry<T>*   Instance;
};

template <class T>
StaticRegistry<T>* StaticRegistry<T>::Instance = 0; 
```

BrokeredObjectBuilder 的实现可能如下所示：

```
class BrokeredObjectBuilderBase {
public:
    BrokeredObjectBuilderBase() { StaticRegistry<BrokeredObjectBuilderBase>::GetInstance().Register(this); }
    virtual ~BrokeredObjectBuilderBase() { StaticRegistry<BrokeredObjectBuilderBase>::GetInstance().Deregister(this); }

    virtual int GetInterfaceId() = 0;
    virtual BrokeredObject* MakeBrokeredObject() = 0;
};

template<class T>
class BrokeredObjectBuilder : public BrokeredObjectBuilderBase {
public:
    BrokeredObjectBuilder(unsigned long interface_id) : m_InterfaceId(interface_id) { } 
    virtual int GetInterfaceId() { return m_InterfaceId; }
    virtual T* MakeBrokeredObject() { return new T; }
private:
    unsigned long m_InterfaceId;
};

class TypeA : public BrokeredObject
{
   ...
};

// Create a global variable for the builder of TypeA so that it's 
// included in the BrokeredObjectBuilderRegistry
BrokeredObjectBuilder<TypeA> TypeABuilder(TypeAUserInterfaceId);

typedef StaticRegistry<BrokeredObjectBuilderBase> BrokeredObjectBuilderRegistry;

BrokeredObject *GetObjectByID(int id)
{
  BrokeredObject *pObject(0);
  ObjectMap::iterator = m_objectList.find(id);
  // etc.
  if(found) return pObject;

  // not found, so create
  BrokeredObjectBuilderRegistry& registry(BrokeredObjectBuilderRegistry::GetInstance());
  for(BrokeredObjectBuilderRegistry::const_iterator it = registry.begin(), e = registry.end(); it != e; ++it)
  {
    if(it->GetInterfaceId() == id)
    {
      pObject = it->MakeBrokeredObject();
      break;
    }
  }

  if(0 == pObject)
  {
    // userinterface id not found, handle this here
    ...
  }      

  // add it to the list
  return pObject;
} 
```

优点：

*   所有知道创建类型的代码都被分离到构建器中，并且 BrokeredObject 类不需要知道它。
*   此实现可以在库中使用，您可以在每个项目级别上控制使用多种不同技术将哪些构建器拉入项目中。
*   构建器可以像您希望的那样复杂或简单（如上所示）。

缺点：

*   涉及到一些基础设施（但不是太多）。
*   定义全局变量以包含要包含在项目中的构建器的灵活性确实使其使用起来有点混乱。
*   我发现人们很难理解这种模式，我不知道为什么。
*   有时很难随时了解静态注册表中的内容。
*   上述实现泄漏了一位内存。（我可以忍受这一点...）

上面的实现非常简单，您可以根据自己的要求以多种不同的方式对其进行扩展。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T17:30:08.870

您可以定义纯虚方法，而不是 BrokeredObject 基类中的 GetInterfaceId()：

```
virtual BrokeredObject& GetInstance()=0; 
```

在派生类中，您将从该方法返回特定派生类的实例，如果它已经创建，如果没有，您将首先创建它然后返回它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-12T18:10:33.423

使用模板类作为代理。
使实例成为函数的静态成员。它将在首次使用时创建，并在程序退出时自动销毁。

```
template <class Type>
class BrokeredObject
{
    public:
        static Type& getInstance()
        {
            static Type theInstance;

            return theInstance;
        }
}; 

class TestObject
{
    public:
       TestObject()
       {}
};

int main()
{
    TestObject& obj =BrokeredObject<TestObject>::getInstance();
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T17:37:46.390

看起来您不需要全局对象来进行管理，那么为什么不将所有内容都移到类中呢？

```
template <class Type>
class BrokeredObject
{
protected:
    static Type *theInstance;

public:
    static Type *getOrCreate()
    {
        if (!theInstance) {
            theInstance = new Type();
        }

        return theInstance;
    }

    static void free()
    {
        delete theInstance;
    }

};

class TestObject : public BrokeredObject<TestObject>
{
public:
    TestObject()
    {}

};

int
main()
{
    TestObject *obj = TestObject::getOrCreate();
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-12T17:30:43.597

如果启用了[RTTI ，则可以使用](http://en.wikipedia.org/wiki/RTTI)[typeid](http://en.wikipedia.org/wiki/Typeid)获取类名。

一个问题，为什么你使用工厂而不是为每个类使用单例模式？

* * *

编辑：好的，所以你不想被锁定在一个单例中；没问题。C++ 的美妙之处在于它为您提供了如此多的灵活性。您可以有一个 GetSharedInstance() 成员函数，该函数返回该类的静态实例，但将构造函数保持为公共，以便您仍然可以创建其他实例。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-12T23:20:14.453

如果您在编译时总是知道类型，那么调用`BrokeredObject* p = GetObjectByID(TypeA::get_InterfaceID())`而不是`TypeA* p = new TypeA`直接`TypeA o`调用就没有什么意义了。

另一方面，如果您在编译时不知道确切的类型，则可以使用某种类型的注册表。

```
template <class T>
BrokeredObject* CreateObject()
{
    return new T();
}

typedef int type_identity;
typedef std::map<type_identity, BrokeredObject* (*)()> registry;
registry r;

class TypeA : public BrokeredObject
{
public:
     static const type_identity identity;
};

class TypeB : public BrokeredObject
{
public:
     static const type_identity identity;
};

r[TypeA::identity] = &CreateObject<TypeA>;
r[TypeB::identity] = &CreateObject<TypeB>; 
```

或者，如果您启用了 RTTI，您可以使用`type_info`type_identity：

```
typedef const type_info* type_identity;
typedef std::map<type_identity, BrokeredObject* (*)()> registry;
registry r;

r[&typeid(TypeA)] = &CreateObject<TypeA>;
r[&typeid(TypeB)] = &CreateObject<TypeB>; 
```

当然，在任何情况下，每个新类都可以在注册表中自行注册，从而使注册分散化而不是集中化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-12T17:38:50.960

您几乎肯定应该使用依赖注入。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-12T17:40:26.543

为什么不是这个？

```
    模板
    BrokeredObject* GetOrCreateObject()
    {
      返回新的 T();
    }

```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-31T15:09:50.960

我的用例往往变得更复杂一些——我需要能够进行一些对象初始化，并且我需要能够根据配置从不同的 DLL 加载对象（例如硬件的模拟与实际）。它开始看起来像 COM 和 ATL 是我前进的方向，但我不想将 COM 的权重添加到操作系统（这是在 CE 中完成的）。

我最终选择的是基于模板的（感谢[litb](https://stackoverflow.com/users/34509/litb)让我走上正轨），看起来像这样：

```
class INewTransModule
{
  public:
    virtual bool Init() { return true; }
    virtual bool Shutdown() { return true; }
};

template <typename T>
struct BrokeredObject
{
public:
    inline static T* GetInstance()
  {
    static T t;
    return &t;
  }
};

template <> 
struct BrokeredObject<INewTransModule>
{
public:
    inline static INewTransModule* GetInstance()
  {
    static INewTransModule t;
    // do stuff after creation
    ASSERT(t.Init());
    return &t;
  }
};

class OBJECTBROKER_API ObjectBroker
{
  public: 
    // these calls do configuration-based creations
    static ITraceTool  *GetTraceTool();
    static IEeprom     *GetEeprom();
    // etc
}; 
```

然后为了确保对象（因为它们是模板化的）实际上被编译，我添加了如下定义：

```
class EepromImpl: public BrokeredObject<EepromImpl>, public CEeprom
{
};

class SimEepromImpl: public BrokeredObject<SimEepromImpl>, public CSimEeprom
{
}; 
```

# performance - 有哪些应用程序可以在生成数据时传递数据并让它分析一些统计数据？

> ID：363459
> 
> 赞同：1
> 
> 时间：2008-12-12T17:13:49.170
> 
> 标签：performance, statistics, measurement

基本要求是从 C# 代码（托管代码或可以从命令中定期获取数据的东西）传递给某些命令类型和执行时间（可能还有其他数据，但这是我们目前关注的基本数据） line. 并对其进行一些统计分析：每种命令类型的平均时间、标准偏差、一些图表会很好，等等。

可以实时执行此操作的东西可能更可取，但我想我们自己保存数据并将其传递给分析也是可以接受的。

我们可以为此写一些东西，但似乎应该有一些东西可以用于此。

编辑：基本上是在寻找低学习曲线并且能够做上面提到的事情。基本上比手动编码更快学习和使用的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-16T01:03:09.450

我可能在这里偏离了基地，但自定义 Windows 性能对象和计数器会这样做吗？您可以为每种命令类型创建一个对象，并为执行时间创建一个计数器，然后使用 Perfmon 的日志记录、图表和报告工具。或者将 Perfmon 数据导出到 Excel/Access 以获得更高级的内容。

# .net - 如何克服对 ASP.Net MVC 标记中的 <% %> 的恐惧？

> ID：363465
> 
> 赞同：14
> 
> 时间：2008-12-12T17:15:48.340
> 
> 标签：.net, asp.net-mvc

所以我完全相信 ASP.NET 的基本原则、可测试性、SoC、HTML 控制……太棒了。然而，作为新手，我对标记有很大的兴趣。[我知道它来自于我对经典 ASP 的仇恨，当我看到这个](http://www.flickr.com/photos/webjedi/3103009542/)时，我不禁觉得我已经进入了暮光之城。

我不知道替代方案是什么（我可以使用服务器控件、数据绑定等...吗？）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-12T17:20:44.867

你可以做一些事情来帮助清理标记，但我同意它可能会有点标签汤。

*   您可以[制作自己的 HTML 助手](http://weblogs.asp.net/stephenwalther/archive/2008/06/13/asp-net-mvc-tip-1-creating-new-html-helpers-with-extension-methods.aspx)来使用扩展方法输出数据，这样您就可以隐藏一些 if/else 逻辑、迭代等
*   S[强烈输入你的观点](https://stackoverflow.com/questions/302273/strongly-typed-views-in-asp-mvc)，这样你就可以做`ViewData.Model.myProperty`而不是`(MyClasst)ViewData["foo"].myProperty`

例如，这是我为制作 RSS-spitter-outer 所做的扩展 :)

```
 public static string RSSRepeater<T>(this HtmlHelper html, IEnumerable<T> rss) where T : IRSSable
    {
        StringBuilder result = new StringBuilder();

        if (rss.Count() > 0)
        {
            foreach (IRSSable item in rss)
            {
                result.Append("<item>").Append(item.GetRSSItem().InnerXml).Append("</item>");
            }
        }

        return result.ToString();
    } 
```

所以在我的前端，我所拥有的只是`<%=Html.RSSRepeater(mydata)%>`更好的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-12T17:32:25.480

1) 帮助程序减少 HTML 噪音
2) 部分视图分解更大的页面/重用视图代码
3) 尝试不同的渲染引擎，例如[Sparkline](http://haacked.com/archive/2008/12/08/asp.net-mvc-northwind-demo-using-the-spark-view-engine.aspx)
4) 如果您的视图包含太多`if`语句，请使用 REFACTOR。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-12T17:26:52.310

[避免阅读标签汤](http://blog.wekeroad.com/blog/asp-net-mvc-avoiding-tag-soup/)可能会有所帮助。通常你不能使用服务器控件（虽然有些可能有效），没有回发或视图状态。我不认为你可以使用数据绑定（同样可能有例外，我不确定 ASP.NET MVC 如何处理视图中的服务器控件。） - 最简单的“数据绑定”方法是传递一个列表或数组将数据放入视图并使用 foreach 从中构建 HTML。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T17:33:10.207

将*一些*（不是全部，仅在有意义的情况下）显示逻辑（如您的日期）移动到您的模型中。例如，在您的示例中，您可以添加一个处理 .ToShortDateString() 调用的 Task.DisplayDate 字符串属性。然后，如果它发生变化，您可以在一个地方进行全部更改，它会缩短视图中的代码。

HTML 助手有时很好。我真的不喜欢将我的 HTML 放在连接字符串中，或​​者在某个类中使用 StringBuilder，但如果你正在做很多可以处理许多不同数据集的事情，那么它们还不错。

我还将更改您的 C# 代码格式首选项以在同一行包含括号。这减少了混乱。不幸的是，您不能在代码编辑器和 HTML 编辑器之间对此进行单独的设置，因此您也必须在代码中习惯它。这不是世界上最糟糕的事情。

其他人所说的也有帮助：使用部分视图和强类型。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-25T20:56:26.030

我喜欢让“<% %>”标签的语法高亮显示与背景颜色非常相似。我为我的“<% %>”标签使用黑色背景和银色（手头上没有特定颜色）颜色。加上这里的其他建议应该使您的代码更具可读性。当然，您可以随时尝试其他视图引擎（这就是 MVC 的美妙之处！）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-25T23:11:12.403

我会看看其他一些可用的视图引擎，我个人非常喜欢[Spark 视图引擎](http://dev.dejardin.org/)，但还有很多其他的。

Scott Hanselman 写了一篇关于 spark 和[Nhaml](http://www.codeplex.com/MVCContrib)的精彩文章，其中包含一些标记片段，您可以查看它们是否适合您的美学 :)

[http://www.hanselman.com/blog/TheWeeklySourceCode30SparkAndNHamlCrazyASPNETMVCViewEngines.aspx](http://www.hanselman.com/blog/TheWeeklySourceCode30SparkAndNHamlCrazyASPNETMVCViewEngines.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-13T02:54:34.787

如果在格式化后按 ctrl+z，它只会撤消格式化而不是打字。

我发现这有助于将第一个括号与 if 语句保持在同一行

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-13T02:58:59.847

如果您正在谈论来自渲染控件的 HTML，恐怕它不会变得更好，因为您在 MVC 中的 View 周围有一个很好的基于标准的包装器。如果没有经过调整的控件，输出仍然是大约 1995 年的糟糕嵌套表代码。

谢谢，微软！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-25T04:27:08.983

使用**服务器端**注释`<%-- comment --%>`来分隔块并增加可读性。也使用额外的行距来分隔块（SO似乎出于某种原因在这里扼杀了我的行距）。

```
 <%-- Go through each testimonial --%>
        <% foreach (var testimonial in ViewData.Model.Testimonials) { %>

        <div class="testimonialFrame">
            <div class="testimonialHeader"><%= testimonial.summaryText %></div>

            <%-- Show video if available --%>
            <% if (string.IsNullOrEmpty(testimonial.Video.FullURL) == false) { %>

            <div  style="padding-top:12px">
                <% Html.RenderAction("YouTubeControl", "Application", new { youTubeId = testimonial.Video.FullURL }); %>
            </div>

            <% } %>

            <div class="roundedBox" style="margin-top:15px">
                <div id="txtTestimonialText" class="testimonialText paddedBox"><%= testimonial.TestimonialText %></div>
            </div>

            <div class="testimonialFooter"><%= testimonial.name %></div>
        </div>

        <% } %> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-25T04:32:07.460

偶尔使用辅助方法（我不是在谈论扩展辅助方法）使用 Html 对象模型在视图本身中编写 HTML 代码。除非您有一些无法在视图中轻松编写的奇怪逻辑，否则我不会对此进行推荐。只要 .aspx.cs 中的代码是 VIEW 代码，就可以了。

在您的视图的 .aspx 文件中：

```
 <%-- render section --%>
 <% RenderTextSection(section); %> 
```

在您的视图的“代码隐藏”中，您使用 HtmlGenericControl 创建 HTML，然后使用以下行将其写出：

```
htmlControl.RenderControl(new HtmlTextWriter(Response.Output)); 
```

我的完整方法：

```
protected void RenderTextSection(ProductSectionInfo item)

    {
        HtmlGenericControl sectionTextDiv = new HtmlGenericControl("div");

        bool previousHasBulletPoint = false;
        System.Web.UI.HtmlControls.HtmlControl currentContainer = sectionTextDiv;

        foreach (var txt in item.DescriptionItems)
        {
            if (!previousHasBulletPoint && txt.bp)
            {
                // start bulleted section
                currentContainer = new HtmlGenericControl("UL");
                sectionTextDiv.Controls.Add(currentContainer);
            }
            else if (previousHasBulletPoint && !txt.bp)
            {
                // exit bulleted section
                currentContainer = sectionTextDiv;
            }

            if (txt.bp)
            {
                currentContainer.Controls.Add(new HtmlGenericControl("LI")
                {
                    InnerHtml = txt.t
                });
            }
            else
            {
                currentContainer.Controls.Add(new HtmlGenericControl()
                {
                    InnerHtml = txt.t
                });
            }

            previousHasBulletPoint = txt.bp;
        }

        sectionTextDiv.RenderControl(new HtmlTextWriter(Response.Output));
    } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-25T04:46:24.047

我建议查看 MonoRails 使用的 Velocity 模板引擎。ASP.NET MVC 非常接近于 MonoRails 格式的模型，因此使用 Velocity 模板相当容易。

[单击此处了解更多信息](http://www.eggheadcafe.com/aspnet/how-to/3719646/aspnet-mvc-tip-19--use.aspx)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-10-11T14:47:09.307

现在你可以试试[Razor](http://weblogs.asp.net/scottgu/archive/2010/07/02/introducing-razor.aspx)（在 ASP.NET MVC 3 中）

我只是希望“@”也不会吓到你：P

# active-directory - 您如何在“托管解决方案”中使用 Active Directory？

> ID：363481
> 
> 赞同：9
> 
> 时间：2008-12-12T17:19:45.350
> 
> 标签：active-directory, azure, hosted, buzzword-compliance

昨天我接到一个微软代表的电话，询问我们是否提供“托管解决方案”，大概是 Windows Azure 大推动的一部分。我一打完电话，我们的营销总监就来到我的办公室，说我们的大多数客户都要求在下一个版本中集成 Active Directory。然后我想到：如果应用程序不在客户的网络上，如何在“托管解决方案”中使用 Active Directory？

作为一个关于 Active Directory 集成的更普遍的问题，这通常对应用程序意味着什么类型的功能更改？这是否意味着用户仅通过对 Active Directory 进行身份验证即可登录应用程序，还是意味着应用程序从 Active Directory 获取其用户列表，或者是否在应用程序中创建新用户或组会在 Active Directory 中创建新用户或组?

我是否刚刚陷入流行语战争的交火中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T17:31:55.920

你不是。Active Directory 可以在公共 Internet 上运行，但这会使网络的安全性和设置相当复杂。

通常，针对 Active Directory 对应用程序进行身份验证意味着您的成员资格提供商（例如）将调用 Active Directory 进行身份验证，然后用户只需登录即可；您不会在自己的数据库中保留活动凭据等。但是，我认为缓存该信息也是明智之举，并准备在目录之外对该缓存进行身份验证，以防域控制器无法进行身份验证（如果您在跨目录运行目录，则风险尤其大）互联网）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T17:42:01.250

您可以使用 Active Directory 联合服务在两个组织之间通过 Internet 使用 AD 进行身份验证。请参阅：[http ://technet.microsoft.com/en-us/library/cc786469.aspx](http://technet.microsoft.com/en-us/library/cc786469.aspx)

我从来没有用过它，只是读过它。希望能帮助到你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-27T01:33:14.480

接受的答案解释了 Active Directory 的作用，我同意缓存基本用户信息在许多情况下可能很有用。

Active Directory 可以扩展到企业网络之外，扩展到 Internet 和连接的 Web 服务。正如另一位用户提到的，这是通过 ADFS（Active Directory 联合服务）实现的，它允许在单独的身份验证服务之间建立“可信”连接。作为“Office 365 Jump Start”网络研讨会的一部分，解释了许多场景： [http ://technet.microsoft.com/en-us/edge/office-365-jump-start-04-microsoft-office-365 -身份和访问解决方案](http://technet.microsoft.com/en-us/edge/office-365-jump-start-04-microsoft-office-365-identity-and-access-solutions)

在查看了这些之后，我立即认为“托管”AD 和 ADFS 服务会很有用，因为客户不想在内部维护 AD 服务器（如果您正在这样做，Microsoft 不建议运行少于 5 个单独的服务器这个！）最近，微软也推出了他们的Azure云平台。他们提供的其中一项服务标有“身份”，您可以在此处查看：http: [//www.windowsazure.com/en-us/services/identity/](http://www.windowsazure.com/en-us/services/identity/)

这是微软自己的托管 AD 服务解决方案。事实上，他们甚至提到使用他们的“身份”托管服务作为 Office 356 甚至 Google Web 应用程序的 SSO（单点登录）的解决方案。

我仍在学习 AD 和 Microsoft 的云产品，但我希望这能为您指明正确的方向。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-04T15:06:19.807

这里有一篇文章：http: [//www.developerfusion.com/article/121561/integrating-active-directory-into-azure/](http://www.developerfusion.com/article/121561/integrating-active-directory-into-azure/)深入描述了如何将 Active Directory 与 Azure 集成 - 希望对您有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T20:25:50.063

Active Directory 可以在公共互联网上运行，但您会遇到延迟时间，这可能会导致您的应用程序超时或崩溃，具体取决于您的带宽。过去，我在另一家名为 ultradns.com 的公司开设了帐户，该公司专门研究这些类型的场景。希望有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-13T00:40:49.377

如果您需要MS 的*任何*支持，最好使用真正的托管框架。

我相信你会喜欢一些链接：

*   [HMC](http://www.microsoft.com/hosting/solutions/hostedmessaging.mspx)（托管消息传递和协作）

*   我所知道的关于框架的唯一真实博客来自[Kip Ng](http://blogs.technet.com/provtest/default.aspx)

*   [ASP.NET 论坛](http://forums.asp.net/167.aspx)也是关于框架问题的一个很好的资源。

*   [此处](http://implement-hmc.spaces.live.com/)是为 Exchange 多租户配置 AD 的工作示例，尽管它基于框架的旧版本，但许多相同的原则适用。

此外，尝试搜索关键字多租户的一些文章。

# visual-studio - 多个 Team Foundation Server

> ID：363486
> 
> 赞同：3
> 
> 时间：2008-12-12T17:20:51.260
> 
> 标签：visual-studio, open-source, tfs, codeplex

我们目前在我们公司有一个本地 TF 服务器，并且我们即将开源项目的一个子集（通过 Codeplex），但是在同一解决方案中混合两个 Team Foundation Server 时遇到了问题。看起来 Visual Studio 无法同时连接到多个 TF 服务器。处理它的最佳方法是什么？

*   **解决方案 1**：仅将开源项目绑定到 Codeplex，将专有项目仅绑定到本地。根据您连接的位置绑定和取消绑定项目-> 看起来 VS 不喜欢这个想法。项目松散绑定并开始表现异常。

*   **解决方案 2**将全部绑定到本地并为开源子集使用另一个解决方案 --> 团队资源管理器工作区管理器避免您使用重叠的本地文件夹树，即使在不同的服务器上也是如此，因此它不是一个选项。

*   **解决方案 3**使用 TFS 将所有内容绑定到本地。对开源子集使用另一个源代码控制，如 SVN。看起来它很容易变得凌乱，但我们没有很多选择。

有开源项目的人遇到过这样的问题？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T00:21:50.850

我会坚持使用一个单一的权威存储库，否则您最终会在某个时候遇到版本地狱。如果您打算让外部开发人员在 codeplex 端贡献代码，您需要将您的更改与他们的更改合并，并将他们的更改集成到您自己的内部 TFS 服务器上。

拥有一个单一的权威存储库并在另一个上为里程碑版本创建快照会更安全。

您可以在内部存储库上进行细粒度的签入和修改，并定期将它们集成/合并到 codeplex 代码树。然而，在一个代码库上工作的东西在集成后可能在另一个代码库上效果不佳，你越早集成更改越好（不要在你自己的孤立分支上工作太久）。

# php - php引用问题

> ID：363491
> 
> 赞同：0
> 
> 时间：2008-12-12T17:22:18.060
> 
> 标签：php

我有这个 PHP 代码

```
echo '<a href="#" onclick="updateByQuery(\'Layer3\', ' . json_encode($query) . ');">Link 1</a>'; 
```

生成这样的链接：

```
<a href="#" onclick="updateByQuery('Layer3', "Ed Hardy");">Link 1</a><li>Link 2</li> 
```

导致不调用javascript。我如何让它围绕 $query 的结果生成单引号，在这种情况下是 ed hardy？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T17:26:45.337

您应该对其[进行 html 编码](http://www.php.net/htmlentities)：

```
echo '<a href="#" onclick="updateByQuery(\'Layer3\', ' . htmlentities(json_encode($query)) . ');">Link 1</a>'; 
```

你也可以使用`htmlspecialchars`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T17:48:53.217

```
echo "<a href='#' onclick='updateByQuery(\"Layer3\", \"" . json_encode($query) . "\");'>Link 1</a>"; 
```

这会产生：

```
<a href='#' onclick='updateByQuery("Layer3", "Ed Hardy");'>Link 1</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T17:24:35.340

尝试做相反的事情......对html使用单引号，对javascript使用双引号。事实上，我们就是这样做的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T17:26:00.487

```
echo "<a href='#' onclick='updateByQuery(\"Layer3\", " . json_encode($query) . ");'>Link 1</a>"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-15T00:06:40.283

引号是内联处理程序的一个问题。正如 RoBerg 所说，您需要在文本中使用 htmlentities。

另一种解决方法是使用钩子方法和匿名函数，而不是内联处理程序。

```
echo '
<a href="#" id="link_1">Link 1</a>
<script>document.getElementById("link_1").onclick =
       function() { updateByQuery("Layer3", '.json_encode($query).'); }
</script>
'; 
```

# iphone - 了解 iPhone 上的内存消耗

> ID：363493
> 
> 赞同：35
> 
> 时间：2008-12-12T17:22:34.813
> 
> 标签：iphone, memory-management, opengl-es

我正在使用 OpenGL ES 开发一个 2D iPhone 游戏，我一直在达到 24 MB 内存限制——我的应用程序不断崩溃并显示错误代码 101。我非常努力地寻找内存的去向，但 Instruments 中的数字仍然很多比我预期的要大。

我使用 Memory Monitor、Object Alloc、Leaks 和 OpenGL ES 工具运行应用程序。当应用程序被加载时，可用物理内存从 37 MB 下降到 23 MB，Object Alloc 稳定在 7 MB 左右，Leaks 显示两个或三个泄漏大小为几个字节，Gart 对象大小约为 5 MB，Memory Monitor 说应用程序占用大约 14 MB 的实际内存。我很困惑内存去了哪里——当我深入研究对象分配时，大部分内存都在纹理中，正如我所期望的那样。但是我自己的纹理分配计数器和 Gart 对象大小都同意纹理应该占用大约 5 MB。

我不知道分配任何其他值得一提的东西，并且 Object Alloc 同意。记忆去哪儿了？（如果这还不够，我很乐意提供更多细节。）

* * *

*更新：*我真的试图找到我可以分配这么多内存的地方，但没有结果。让我疯狂的是对象分配（~7 MB）和内存监视器（~14 MB）显示的实际内存使用量之间的差异。即使我忘记了巨大的泄漏或大块内存，它们*仍然应该出现在 Object Allocations*中，不是吗？

我已经尝试过[通常的](https://stackoverflow.com/questions/281764/in-cocoatouch-iphone-os-how-do-i-findeliminate-leaks-that-the-instruments-leak) [嫌疑人](https://stackoverflow.com/questions/289360/problem-deallocing-memory-used-by-uiimageviews-with-fairly-large-image-in-an-ui)，即。与`UIImage`它的缓存，但这并没有帮助。有没有办法逐行跟踪内存使用“调试器风格”，观察每条语句对内存使用的影响？

* * *

*到目前为止我发现了什么：*

1.  我真的*在*使用那么多内存。衡量真正的内存消耗并不容易，但是经过大量计算后，我认为内存消耗确实很高。我的错。

2.  我发现没有简单的方法来测量使用的内存。内存监视器的数字是准确的（这些是真正重要的数字），但内存监视器无法告诉您内存的确切位置。Object Alloc 工具对于跟踪实际内存使用情况几乎毫无用处。当我创建纹理时，分配的内存计数器会上升一段时间（将纹理读入内存），然后下降（将纹理数据传递给 OpenGL，释放）。这没关系，但并不总是会发生——有时即使在纹理被传递到 OpenGL 并从“我的”内存中释放之后，内存使用率仍然很高。这意味着 Object Alloc 工具显示的分配内存总量小于实际总内存消耗，但大于实际消耗减去纹理 ( `real – textures < object alloc < real`)。去搞清楚。

3.  我误读了编程指南。24 MB 的内存限制适用于纹理和表面，而不是整个应用程序。实际的红线稍远一些，但我找不到任何硬数字。共识是 25-30 MB 是上限。

4.  当系统内存不足时，它开始发送内存警告。我几乎没有什么可释放的，但其他应用程序确实会将一些内存释放回系统，尤其是 Safari（它似乎正在缓存网站）。当内存监视器中显示的可用内存变为零时，系统开始查杀。

我不得不硬着头皮重写代码的某些部分以提高内存效率，但我可能仍在推动它。如果我要设计另一个游戏，我肯定会想到一些资源分页。对于当前的游戏，这非常困难，因为它一直在运动，并且加载纹理会妨碍，即使在另一个线程中完成。**我会对其他人如何解决这个问题很感兴趣。**

请注意，这些只是我的观点，不必太准确。如果我发现有关此主题的更多信息，我将更新该问题。我会保持这个问题的开放性，以防了解这个问题的人愿意回答，因为这些都是比其他任何东西更多的解决方法和猜测。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-03-19T08:28:08.780

*我非常怀疑这是 Instruments 中的一个错误。*

首先，阅读[Jeff Lamarche 的这篇关于 openGL 纹理的博文](http://iphonedevelopment.blogspot.com/2009/05/opengl-es-from-ground-up-part-6_25.html)：

*   有一个如何加载纹理而不导致泄漏的简单示例
*   了解“小”图像在加载到 OpenGL 后如何实际使用“大量”内存

摘抄：

> 纹理，即使它们是由压缩图像制成的，也会占用大量应用程序的内存堆，因为它们必须在内存中扩展才能使用。每个像素占用 4 个字节，因此忘记释放纹理图像数据会很快耗尽内存。

其次，可以使用 Instruments 调试纹理内存。有两种分析配置：[OpenGL ES Analyzer](https://developer.apple.com/library/mac/#documentation/AnalysisTools/Reference/Instruments_User_Reference/OpenGLESAnalyzer/OpenGLESAnalyzer.html)和[OpenGL ES Driver](https://developer.apple.com/library/mac/#documentation/AnalysisTools/Reference/Instruments_User_Reference/OpenGLESDriverInstrument/OpenGLESDriverInstrument.html#//apple_ref/doc/uid/TP40011355-CH37-SW1)。您需要在设备上运行这些，因为模拟器不使用 OpenGL。只需从 XCode 中选择 Product->Profile 并在 Instruments 启动后查找这些配置文件。

* * *

有了这些知识，这就是我要做的：

*   检查您是否没有[泄漏内存](http://developer.apple.com/mac/library/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html#//apple_ref/doc/uid/20000994)——这显然会导致此问题。
*   确保您没有[访问自动释放的内存](http://www.cocoadev.com/index.pl?DebuggingAutorelease)——崩溃的常见原因。
*   创建一个单独的测试应用程序并单独（和组合）加载纹理以找出导致问题的纹理（或其组合）。

**更新：**在考虑了您的问题后，我一直在阅读[Apple 的 OpenGL ES Programming Guide](http://developer.apple.com/iphone/library/documentation/3DDrawing/Conceptual/OpenGLES_ProgrammingGuide/index.html)，它提供了非常好的信息。强烈推荐！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-16T01:15:02.767

一种方法是开始注释代码并检查错误是否仍然发生。是的，它既乏味又简单，但如果你知道错误在哪里，它可能会有所帮助。

它崩溃的地方就是它崩溃的原因，等等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-13T23:41:53.890

嗯，这不是很多细节，但如果泄漏没有告诉你泄漏在哪里，有两个重要的选择：

[i] 泄漏错过了泄漏 [ii] 内存实际上并没有被泄漏

修复 [i] 非常困难，但正如 Eric Albert 所说，向 Apple 提交错误报告会有所帮助。[ii] 表示您正在使用的内存仍然可以在某个地方访问，但也许您已经忘记了它。是否有任何列表在增长，而不会丢弃旧条目？是否有很多缓冲区被重新分配（）？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-22T01:56:03.723

对于那些在 2012 年之后看到这个的人：

真正加载到设备物理内存中的内存是 VM Tracker Instrument 中的驻留内存。

Allocation Instrument 只标记 malloc/[NSObject alloc] 和一些框架缓冲区创建的内存，例如，Allocation Instrument 中不包含解压缩的图像位图，但它总是占用大部分内存。

Please Watch WWDC 2012 Session 242 iOS App Performance: Memory to get the information from Apple.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T19:56:41.010

这对您没有特别的帮助，但如果您发现记忆工具没有提供您需要的所有数据，请在 bugreport.apple.com 提交错误。附上你的应用程序的副本，并说明这些工具如何未能满足你的分析，Apple 会看看他们是否可以改进这些工具。谢谢！

# c# - catch 块和方法中抛出新异常的区别

> ID：363495
> 
> 赞同：2
> 
> 时间：2008-12-12T17:22:51.880
> 
> 标签：c#, exception

在一种方法中，我希望能够将一个值插入到一个 div 中，该 div 是我选择解析的 html 文档的一部分。

```
public void AddToDiv(string div)
{
    //Code to read the html document and look for the div 
    //(name specified as the parameter of this method).
} 
```

问题是，我可以指定一个名为“abc”的 div，但 html 文档可能没有这个 div。很公平，但我说的有什么区别：

```
try
{
    //Method logic to parse document for the div
}
catch(ArgumentException ex)
{
    // (I wouldn't supress this catch block in production code, 
    // just omitting body details for simplicity.
} 
```

或者

```
public void ParseDocument
{
    //Logic here...

    if(!document.Contains(div)
    {
    throw new ArgumentException();
    }
} 
```

简而言之，catch 块和在主逻辑块中说 throw new [ExceptionType here] 有什么区别？我如何决定使用哪个？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T17:30:20.307

就个人而言，我会检查是否存在，而不是允许抛出异常，它更容易确定逻辑流，并且更适合您的代码意图。

请参阅这些问题和答案以进行更广泛的讨论

[何时抛出异常](https://stackoverflow.com/questions/77127/when-to-throw-an-exception)

[是否有任何正当理由忽略捕获的异常](https://stackoverflow.com/questions/204814/is-there-any-valid-reason-to-ever-ignore-a-caught-exception)

[.net 异常有多慢？](https://stackoverflow.com/questions/161942/how-slow-are-net-exceptions)

**编辑：**

再三考虑，您应该考虑“包含”检查的费用。如果它可能与实际获取 div 一样昂贵，并且它使例程运行所需的时间增加了一倍，并且**如果这种滞后会降低性能到它会被注意到的程度**，那么最好去获取分区。我仍然会捕获它并抛出 ArgumentException，将原始异常作为内部异常。

**注意：**除非需要，否则不要优化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T17:48:36.290

还有第三种选择，但我稍后会写更多关于它的内容。

首先，捕捉异常就是捕捉你没想到的错误，处理它们，然后优雅地继续或关闭。

当您遇到不应该发生或应该在其他地方处理的情况时，应该使用抛出异常。如果您想在您的方法之外处理此错误，这可能是您的解决方案。

第三种选择是实际避免您知道可能发生的错误。例如，您可以检查 div 是否存在，如果不存在则不执行任何操作，也称为防御性编程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T17:30:50.803

抛出和捕获是异常处理的两个对立面。遇到灾难并且无法从中恢复的组件会抛出异常。在堆栈的较低位置，调用组件可以捕获异常并处理它。

不同之处在于，在这种情况下，模式是 AddToDiv 会抛出一个异常，而调用 AddToDiv 的 ParseDocument 可以捕获并处理它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T17:34:58.330

那么 Try/Catch 更昂贵，它应该用于处理**意外**错误。在这种情况下，您知道您可能会收到错误，并且不必“尝试”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T17:50:49.547

问题是：如果 ParseDocument(...) 不能做你想做的事，它应该默默地失败吗？如果是这样，请在其中使用 try{} catch{}。如果您需要调用代码知道 ParseDocument 失败，它应该抛出这个调用代码可以捕获的异常。

# jquery - 带有复选框单击的 JQuery 突出显示行

> ID：363503
> 
> 赞同：3
> 
> 时间：2008-12-12T17:26:07.087
> 
> 标签：jquery

```
$(document).ready(function(){
    $(".txtDate").datepicker({ showOn: "both", 
        buttonImage: "library/ui/datepicker/img/calendar2.gif", dateFormat: "yy/mm/dd", buttonImageOnly: true });

    //added this checkbox click for something I given earlier

    $("#Table input").click(function() { 
        if ($(this).attr("checked") == true)
        {
            $(this).parent().parent().addClass("highlight");  
        } 
        else
        {   
            $(this).parent().parent().removeClass("highlight");
        }
    });
}); 
```

我在后面的代码中动态添加的每一行都有一个复选框控件

```
for( int i=0; i< data.count;i++){   
    HtmlTableCell CheckCell = new HtmlTableCell();
    CheckBox Check = new CheckBox(); 

    CheckCell.Controls.Add(Check);

    row.Cells.Add(CheckCell);
    Table.Rows.Add(row);
} 
```

带有标记的表 id 在这里：

```
<table id="Table"  runat="server" width="100%" cellspacing="5" border="1"> 
    <colgroup width="3%"></colgroup>
    <colgroup width="15%"></colgroup>
    <colgroup width="20%"></colgroup>
    <colgroup width="15%"></colgroup>
    <colgroup width="47%"></colgroup>
    <thead>
        <tr> 
            <th id="CheckBox" runat="server"><input type="checkbox" id="CheckBox1" name="CheckBox" runat="server" /></th>
            <th id="Type" runat="server"></th>
            <th id="Category" runat="server"></th>  
            <th id="DateTime" runat="server"></th>  
            <th id="Description" runat="server"></th>
        </tr>
    </thead> 
    <tbody>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T17:38:24.330

您的 JQuery 代码没有任何问题 - 尽管如果您使用[toggleClass](http://docs.jquery.com/Attributes/toggleClass#class)会更干净：

```
 $('#Table INPUT').click(function() {
     $(this).parent().parent().toggleClass('highlight');
 }); 
```

我猜你的 id 是错误的 - 或者你在运行该 JQuery 片段之前遇到了另一个 JavaScript 错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T17:48:54.030

是的 - 我的回答也被淘汰了。

无论如何，如果您使用的是 asp.net，那么名称会被破坏（类似于 ctl100_Table ），您需要将其放入 jquery 而不是 Table。

在浏览器中查看实际呈现的 html 以获取您需要使用的名称。

您可以尝试使用 $("[id$=Table]).attr("id") 来获取损坏的版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T17:35:56.193

我看到的第一个问题是没有 id 为“Table input”的元素，即与“#Table input”匹配的元素——至少在您提供的 html 中没有。无论如何，id 不能有空格，所以检查一下。如果您需要，我很乐意为您提供进一步的帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T17:35:58.533

Grr，我刚刚完成了对这个问题的回复，然后才被删除。你也要把这个删掉吗？

* * *

我创建了一个示例文件来测试您的场景，它按预期工作。我已将其包含在下面供您参考。话虽如此，我建议删除与您在测试期间尝试解决的特定功能无关的任何代码，以确保其他代码没有外围问题。此外，请务必执行 view > source 以确保您的表格确实具有该 ID，并且您的复选框和 HTML 正在正确有效地呈现。如果你破坏了 HTML，你的 jQuery 就不能工作。

这是我使用的示例文件。你测试的是什么浏览器？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <title>Untitled</title>
    <script type="text/javascript" src="shared-scripts/jquery-1.2.4b.js"></script>
    <style type="text/css">
        .highlight {
            background-color: yellow;
        }
    </style>

    <script type="text/javascript">
    <!--
    $(document).ready(function(){
        $("#Table input").click(function() {
            if ($(this).attr("checked") == true) {
                $(this).parent().parent().addClass("highlight");
            } else {
                $(this).parent().parent().removeClass("highlight");
            }
        });
    });
    //-->
    </script>
</head>

<body>
<form name="f">
<table id="Table" border="1"><tr>
    <td><input type="checkbox" name="cb1" id="cb1" value="y" /></td>
    <td>Click me</td>
</tr><tr>
    <td><input type="checkbox" name="cb2" id="cb2" value="y" /></td>
    <td>Click me</td>
</tr><tr>
    <td><input type="checkbox" name="cb3" id="cb3" value="y" /></td>
    <td>Click me</td>
</tr></table>
</form>
</body>
</html> 
```

# c# - 满足要求的接口或抽象类

> ID：363504
> 
> 赞同：5
> 
> 时间：2008-12-12T17:26:30.970
> 
> 标签：c#, .net

我想为任何类型的 UI（Web 或窗口）提供一个抽象视图。为了做到这一点，我必须使用接口（IView），我只能在其中应用关于视图的规则。事实上，我想设置一些基本的复杂功能来提供给它的继承。

所以这种方式，我必须使用抽象类。问题是

1) 界面只有规则 2) 视图（web 表单或窗口表单）不能再继承，因为它已经从窗口或 web 表单继承

我怎样才能做到这一点？非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-12T18:10:04.097

你添加的函数会改变类的定义，还是只是创建函数来操作已经是类的一部分的数据？

如果您需要重新定义这两个类的基类的各个方面，那么是的，您将需要更改继承结构。但是，如果这些函数现在只是操作已经是类的一部分的数据，那么我建议您使用该接口并创建实用程序函数。

这是我的意思的一个笨拙的例子：

```
using System;

abstract class Pet { }

class Dog : Pet, IPet
{
    public String Name { get; set; }
    public Int32 Age { get; set; }
}

class Cat : Pet, IPet
{
    public String Name { get; set; }
    public Int32 Age { get; set; }
}

interface IPet
{
    String Name { get; set; }
    Int32 Age { get; set; }
}

static class PetUtils
{
    public static void Print(this IPet pet)
    {
        Console.WriteLine(pet.Name + " is " + pet.Age);
    }
} 
```

您的两个 UI 类可能以这种方式相关。我想像我创建的那种实用方法可以解决您需要以横切方式做的事情。我确实将该`PetUtils.Print`方法创建为扩展方法，因为这将创建实例方法的富有表现力的错觉。如果您不使用 C# 3，只需`this`从`public static void Print(this IPet pet)`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T17:53:21.260

您可以继承一个具体的类（Web 窗体/窗口窗体），声明您的类抽象，并且仍然实现一个接口。

System.Web.UI.Page 示例：

```
public interface IView
{
    void Foo();
}

public abstract class BasePage : Page, IView
{
    //honor the interface
    //but pass implementation responsibility to inheriting classes
    public abstract void Foo();

    //concrete method
    public void Bar()
    {
        //do concrete work
    }
}

public class ConcretePage : BasePage
{
   //implement Foo
    public override void Foo() { }
} 
```

这为您提供了接口和具体方法 Bar(); 的好处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T18:42:04.000

我想做的是这样的

Public MustInherit Class ControllerBase(Of M As {ModelBase, New}, V As {IView})

```
Inherits BaseController

Dim model As M
Dim view As V
Public Sub New()
    model = New M
    view.Controller = Me
    model.Controller = Me
End Sub
Public Overridable Function GetModel() As M
    Return model
End Function
Public Overridable Function GetView() As V
    Return view
End Function 
```

结束类

公共类 BaseWindow

```
Inherits System.Windows.Forms.Form
Implements IView
Dim c As BaseController

Public Function GetController() As BaseController
    Return c
End Function

Friend WriteOnly Property Controller() As BaseController Implements IView.Controller
    Set(ByVal value As BaseController)
        c = value
    End Set
End Property 
```

结束类

```
 Public Class BaseWeb
Inherits System.Web.UI.Page
Implements IView

Dim c As BaseController   

Public Function GetController() As BaseController
    Return c
End Function

Friend WriteOnly Property Controller() As BaseController Implements IView.Controller
    Set(ByVal value As BaseController)
        c = value
    End Set
End Property 
```

结束类

公共接口 IView

```
WriteOnly Property Controller() As BaseController 
```

端接口

# php - 使用 $.ajax 请求使用 PHP 到 MYSQL 数据库的 jQuery 表单处理

> ID：363528
> 
> 赞同：3
> 
> 时间：2008-12-12T17:32:18.353
> 
> 标签：php, jquery, mysql, forms

**问题：**如何使用 jQuery 和 $.ajax 请求处理表单，以便将数据传递给将其写入数据库的脚本？

**问题：** 我有一个简单的电子邮件注册表单，处理后会将电子邮件连同当前日期一起添加到 MySQL 数据库中的表中。在没有 jQuery 的情况下处理表单按预期工作，添加电子邮件和日期。使用 jQuery，表单提交成功并返回成功消息。但是，不会向数据库中添加任何数据。

任何见解将不胜感激！

```
 <!-- PROCESS.PHP -->
    <?php
        // DB info
        $dbhost = '#';
        $dbuser = '#'; 
        $dbpass = '#';
        $dbname = '#';

        // Open connection to db
        $conn = mysql_connect($dbhost, $dbuser, $dbpass) or die ('Error connecting to mysql');
        mysql_select_db($dbname);

        // Form variables
        $email      = $_POST['email'];
        $submitted  = $_POST['submitted'];

        // Clean up
        function cleanData($str) {
            $str = trim($str);
            $str = strip_tags($str);
            $str = strtolower($str);
            return $str;
        }
        $email  = cleanData($email);

        $error = "";
        if(isset($submitted)) {
            if($email == '') {
                $error .= '<p class="error">Please enter your email address.</p>' . "\n";
            } else if (!eregi("^[A-Z0-9._%-]+@[A-Z0-9._%-]+\.[A-Z]{2,4}$", $email)) {
                $error .= '<p class="error">Please enter a valid email address.</p>' . "\n";
            }
            if(!$error){
                echo '<p id="signup-success-nojs">You have successfully subscribed!</p>';

                // Add to database
                $add_email  = "INSERT INTO subscribers (email,date) VALUES ('$email',CURDATE())";
                mysql_query($add_email) or die(mysql_error());

            }else{
                echo $error;
            }
        }
    ?>

<!-- SAMPLE.PHP -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Sample</title>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>
<script type="text/javascript">
        $(document).ready(function(){ 
                // Email Signup
                $("form#newsletter").submit(function() {    
                    var dataStr = $("#newsletter").serialize();
                    alert(dataStr);
                        $.ajax({
                            type: "POST",
                            url: "process.php",
                            data: dataStr,
                            success: function(del){
                                $('form#newsletter').hide();
                                $('#signup-success').fadeIn();
                            }
                    });
                return false;
                });             
        }); 
</script>
<style type="text/css">
#email {
    margin-right:2px;
    padding:5px;
    width:145px;
    border-top:1px solid #ccc;
    border-left:1px solid #ccc;
    border-right:1px solid #eee;
    border-bottom:1px solid #eee;
    font-size:14px;
    color:#9e9e9e;
    }   
#signup-success {
    margin-bottom:20px;
    padding-bottom:10px;
    background:url(../img/css/divider-dots.gif) repeat-x 0 100%;
    display:none;
    }
#signup-success p, #signup-success-nojs {
    padding:5px;
    background:#fff;
    border:1px solid #dedede;
    text-align:center;
    font-weight:bold;
    color:#3d7da5;
    }
</style>
</head>
<body>
<?php include('process.php'); ?>
<form id="newsletter" class="divider" name="newsletter" method="post" action="">
    <fieldset>
    <input id="email" type="text" name="email" />
    <input id="submit-button" type="image" src="<?php echo $base_url; ?>/assets/img/css/signup.gif" alt=" SIGNUP " />
    <input id="submitted" type="hidden" name="submitted" value="true" />
    </fieldset>
</form>
<div id="signup-success"><p>You have successfully subscribed!</p></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T17:50:41.093

相反，如果使用 data: dataStr，请使用：

```
data : {param: value, param2: value2} 
```

这是对 POST 请求执行此操作的正确方法。

另外，我推荐使用一个表单插件，像[这样](http://malsup.com/jquery/form/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-10T07:06:31.193

加上一个表单插件，让生活更轻松。我经常有回发到同一页面的表单。我发送了一个额外的参数（ajax=true），我用它来改变页面返回给浏览器的内容，即。只是我可以通过 innerHTML 注入的页面片段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-27T10:59:30.357

检查来自 process.php file.echo 的响应并删除 post 值并提醒响应，因为要正确写入的所有内容只需将 post 值发送到 process.php。Serialize 的语法也可以是

```
jQuery('#newsletter').formSerialize(); 
```

# opengl - 在openGL中用鼠标绘制

> ID：363534
> 
> 赞同：2
> 
> 时间：2008-12-12T17:34:32.310
> 
> 标签：opengl, mouse, draw

如何在 C++ 中使用 openGL 用鼠标绘制多边形？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-12T17:55:42.563

首先调节鼠标以识别多边形的形状，并能够完成它在计算机屏幕上看到的形状。您可以使用操作性条件反射（通过用食物颗粒奖励鼠标）将其训练到可接受的熟练程度。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-19T12:40:39.163

假设这是家庭作业，并且您想在查看其他人的解决方案之前尝试自己解决这个问题，请花点时间考虑一下：

*   您如何知道用户何时按下按钮？
*   当时的鼠标坐标是多少？
*   如何将鼠标坐标转换为 GL 模型的世界坐标？
*   你如何确定要移动哪个顶点？（或添加）
*   你如何移动顶点？
*   你如何重绘？
*   模型和视图之间有什么联系？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-12T17:44:15.583

也许去上课，专心听讲，听听老师说的话？或者看一下 NeHe 教程，使用全能谷歌五分钟就能找到？

# oop - 您将如何设计没有继承的控制树/层次结构？

> ID：363549
> 
> 赞同：1
> 
> 时间：2008-12-12T17:38:08.917
> 
> 标签：oop, inheritance

我知道 [优先组合](https://stackoverflow.com/questions/49002/prefer-composition-over-inheritance) 而不是继承的响应，并且知道组合优于继承的优点。

但是在某些情况下，继承确实可以发挥很好的作用。继承层次结构的不正确使用会导致所有与重用相关的问题。

以以下控件为例...

```
Button/Textbox/Combobox/ListBox/Grid etc. 
```

通常它们被实现为

```
public class Control
{
    ...
}

public abstract class TextBoxBase : control
{
    ....
}

public class TextBox : TextBoxBase
{
    ....
}

public abstract class ButtonBase: control
{
    ....
}

public class Button: ButtonBase
{
    ....
}

public class TextBox : TextBoxBase
{
    ....
}

public class NumericTextBox: TextBox
{
    ....
} 
```

注意：UI 和功能都是可重复使用的。

我可能是错误的或部分正确的。您的想法只会帮助我提高对这个主题的理解。

您将如何在不使用继承的情况下设计控制模型/层次结构，您认为哪一个更好？

请考虑易用性，使用 IDE 进行此控件也是如此。

**PS：这个问题也是受到[这个问题](https://stackoverflow.com/questions/361371/should-inheritance-of-non-interface-types-be-removed-from-programming-languages)的启发。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T17:45:40.103

*偏爱*构图与在每种情况下都强制要求构图不同。为了添加到您的 UI 示例，我想说 Java 和 .NET 都受益于对流使用继承层次结构。

不过，我建议您看一下 Windows Presentation Foundation 的继承树 - 这是一个为组合而设计的相对现代的 UI 工具包。这可以实现奇怪而美妙的事情——比如包含更多按钮的按钮等。有时（如那个例子）它是无用的——但总体设计很强大。

我并不是说我很理想——我也不会声称对 WPF 非常了解——但这是一个有趣的起点。

我应该指出，即使在 WPF 中，继承也被广泛使用 - 但与（比如说）WinForms 中的方式不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T17:48:13.000

您将使用一系列委托来实现传统上在父类中的功能。假设 Control 类包含基本的绘图功能（即paint()）——那么 Control 将成为 BasicControlDelegate 或类似的，并且将使用对 BasicControlDelegate 的引用创建“子类”，该类将用于所有“继承”功能。

如果您想按原样使用父/委托功能，您可以在每个“子类”中创建一个 paint() 方法，该方法只需在委托上调用相同的方法。如果要更改功能，请创建不同的实现。

TextBoxBase 可能有一个paint() 实现，它被TextBox 直接使用，但也许NumericTextBox 有它自己的paint() 实现。

我认为主要有以下几点：

*   继承类似于具有对“父对象”的隐式引用的组合（当然只有一个真实对象）。
*   通过继承，您可以默认继承和公开每个公共方法，并且可以根据需要覆盖它。
*   使用组合默认情况下您不会公开任何内容，并且必须包装您想要公开的每个方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T17:44:13.023

当所有任务都处于相同的角色时，继承会更好。

# user-interface - web ui：如何为多选呈现一个大列表

> ID：363565
> 
> 赞同：9
> 
> 时间：2008-12-12T17:41:37.960
> 
> 标签：user-interface

我正在寻找任何人可能已经看到的关于如何有效地呈现项目列表（总共约 1500 个）以便可以选择多个项目的任何示例。

我见过几个类似的问题，其中答案建议自动完成，它可以选择单个项目，但不允许用户选择多个项目。

任何建议，尤其是指向可能具有潜在解决方案的网络应用程序的指针，将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T17:52:20.543

我正在考虑 Google 如何使用 Gmail 的方式。

首先，您可以在用户可以单独选择的每个项目旁边放置复选框。然后放置一个过滤器/搜索框，可以选择/取消选择所有匹配项（添加到/从选择中减去）。您还可以在文本框上实现自动完成。

其他过滤选项（按标签、按日期等）也很适合这种方法。这取决于您要列出的项目类型。

如果项目之间有一些共同的分组，您还可以将列表排列在一组子列表中。仍然使用复选框，但您可以将列表框排列在一起（当用户选择要查看的父节点时，在右侧的下一个框中填充子节点）。或者一个简单的树视图可能会做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-08-09T19:49:41.163

自此发布以来已经有一段时间了，但与此同时，一些非常好的多选“标签输入”或“药盒”样式选项变得可用：

[https://harvesthq.github.io/chosen/](https://harvesthq.github.io/chosen/)

这是适用于许多情况的绝佳解决方案 - 试试吧！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T17:44:51.837

我想不出我使用的任何**可用**的网络应用程序可以向我展示 1500 件我必须从中选择的东西。

我的建议是以某种方式分解列表（例如，作为一系列较小的选择，然后您可以允许多个选择）。你所问的听起来像是一场可用性噩梦。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T17:51:03.620

我将`div`通过在文本输入中键入文本来创建一个填充有项目的容器。
文本输入对所有可用项目执行基本过滤。
这些项目将作为可选元素出现在容器内，并且选定的项目将被转移到一个单独的容器中（以便能够执行多个搜索）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-11T21:03:08.850

抱歉迟到了几年......我希望这至少可以帮助某人。

我会说要么使用[Eric Hynds 的多选](http://www.erichynds.com/examples/jquery-ui-multiselect-widget/demos/#filter)，要么使用它的更大版本。好吧，也许这不是 1500 项的最佳界面，但也许它恰到好处。而且它有点类似于 google 的处理方式，只是它几乎不支持键盘导航。

它修改了常规的 SELECT MULTIPLE，HTML 保管箱，带有一个非常可定制和可点击的列表，您可以轻松地过滤（和当前）**或**组 - 目前，过滤器和分组不能很好地协同工作。

如果需要，您可以使用此多选和另一个显示已选择的所有内容的框。你甚至[可以调整它（看例子#8）](http://www.erichynds.com/examples/jquery-multiselect/examples.htm)来做到这一点。

# javascript - 显示html的好方法 画廊、mooflow、灯箱等元素

> ID：363566
> 
> 赞同：1
> 
> 时间：2008-12-12T17:41:43.187
> 
> 标签：javascript, jquery, jquery-plugins

我们有许多插件可以很好地显示图像。例如：mooflow( [http://www.outcut.de/MooFlow/example-milkbox-bridge.html](http://www.outcut.de/MooFlow/example-milkbox-bridge.html) )，我们可以用它以mac itunes的方式显示图像。但我想知道我们是否有任何插件可以显示这样的 html DIV 元素。我没有要显示的图像，但我只想显示一系列 div，其中每个 div 都有一些简短的文本内容。

我真的很高兴知道有一种方法可以配置 jquery 的画廊、灯箱和 mootools 的 mooflow 以使它们除了常规图像之外还显示 div。

谢谢，~沙菲

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T17:43:34.943

[jQuery Thickbox](http://jquery.com/demo/thickbox/)让您处理 HTML 内容（参见“内联内容”示例）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T17:44:38.983

有几个 Lightbox 的修改版本可以做到这一点。一个例子是[厚盒](http://jquery.com/demo/thickbox/)。请参阅内联内容示例。

# java - 从 Java 中的 EnumSet 中获取值

> ID：363569
> 
> 赞同：7
> 
> 时间：2008-12-12T17:42:41.280
> 
> 标签：java

如果您使用 an`EnumSet`来存储传统的二进制值（1、2、4 等），那么当项目少于 64 个时，我会认为这是存储为位向量并有效地表示为 long。有没有一种简单的方法来获得这个 long 的值。我想要一种快速简单的方法来将集合的内容存储在文件或数据库中。

如果我以旧方式执行此操作，我将只使用 long，并自己做一些旋转，尽管存在类型安全等问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T17:58:06.490

据我所知，这没有暴露。您基本上可以自己重写它 - 查看 EnumSet 的代码以了解代码 - 但遗憾的是没有更好的方法来获取它:(

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-12T18:38:31.900

我认为这不能以通用方式完成。转换为 long 非常容易：

```
public static <T extends Enum<T>> long enumSetToLong(EnumSet<T> set)
{
    long r = 0;
    for(T value : set)
    {
        r |= 1L << value.ordinal();
    }
    return r;
} 
```

我不知道你怎么可能从 long back 转换为 EnumSet 一般。我知道没有办法（缺乏反思）来获取枚举的值数组来进行查找。您必须按枚举进行。

我认为序列化是要走的路。仅将序列化为 long 更容易受到版本控制错误的影响，或者由于重新排列枚举中的常量而导致的错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-26T17:38:41.887

正如 Jon Skeet 所提到的，此信息未公开。但戴夫雷展示了如何轻松计算它。我制作了一个库，使此类转换变得更加简单。如果您使用“long”，它还会检查确实没有超过 64 个元素。我必须创建一个新的数据类型，但它可以像 BitSet 或 EnumSet 一样使用。请注意，这需要 Java 8 或更高版本，因为它使用具有默认实现的接口。

这是链接：[http ://claude-martin.ch/enumbitset/](http://claude-martin.ch/enumbitset/)

例子：

```
 static enum MyEnum implements EnumBitSetHelper<MyEnum> { A, B, C }
  public static void main(final String[] args) {
    final EnumBitSet<MyEnum> set = EnumBitSet.of(MyEnum.A, MyEnum.C);
    long bitmask = set.toLong(); // = 3
  } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-12T16:46:46.113

如果添加带有枚举类的参数是可能的。将枚举集转换为字节的示例：

```
public static <T extends Enum<T>, U extends Enum<?>> byte toByte(EnumSet<T> set, Class<U> type) {
  byte b = 0;

  if(type.getEnumConstants().length > 8) {
    throw new RuntimeException("enum set doesn't fit in one byte");
  }

  for(Enum<?> e: type.getEnumConstants()) {
    if(set.contains(e)) {
      b |= 1 << e.ordinal();
    }
  }

  return b;
}

public static <E extends Enum<E>> EnumSet<E> toSet(byte b, Class<E> type) {
  E[] enums = type.getEnumConstants();
  EnumSet<E> enumSet = EnumSet.noneOf(type);

  for(int bit = 0; bit < 8; bit++) {
    if((b & 1 << bit) > 0) {
      enumSet.add(enums[bit]);
    }
  }

  return enumSet;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T17:53:47.403

[`EnumSet`](http://java.sun.com/javase/6/docs/api/java/util/EnumSet.html)实现`Serializable`，所以你可以用`ObjectOutputStream`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-14T16:09:46.347

EnumSet 的（典型 - 它不是强制性的）实现使用枚举值的序数。您不应该假设序数将始终保持不变。因此，如果您想使用序数有效地存储枚举集，您还应该存储从枚举名称到序数的映射（可能存储为枚举名称序列）。

EnumSet 本身似乎没有很好的序列化形式。它只是转储了一个枚举。其主体将被转录为一系列整数对象引用而不是位集。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-16T12:41:49.880

[`BitSet`](http://docs.oracle.com/javase/7/docs/api/java/util/BitSet.html)在这种情况下可能很有用，因为它提供了与字节数组的转换。您可能仍需要`enum`为 indeces 声明具有显式值 (1,2,3..) 的a `BitSet`。与 long 不同，它总是 64 位，`BitSet`似乎不允许限制其长度（例如 64 位）。

# asp.net - 如何通过 Attach 方法使用 Linq 更新数据

> ID：363570
> 
> 赞同：3
> 
> 时间：2008-12-12T17:42:43.730
> 
> 标签：asp.net, linq

我的数据层中有一个更新方法，如下所示：

```
public clacc datalayerSec_User
private objUIData as new UIData
Public Function Update(ByVal objUser As SEC_USER) As Boolean
  Try
    objUIData.SEC_USERs.Attach(objUser)
    objUIData.Refresh(RefreshMode.KeepCurrentValues, objUser)
    objUIData.SubmitChanges(ConflictMode.ContinueOnConflict)
    Return True
  Catch ex As Exception
    Throw ex
  End Try
End Function
end class 
```

我编写了这段代码来更新我的数据：

```
Dim tmpUser As New UI_Class.BAL.Security.cls_SEC_USER
Dim tblUser = tmpUser.GetAll.SingleOrDefault(Function(x) x.DS_OPENID = pOpenID)
tblUser.DT_LAST_LOGIN = DateTime.Now
tmpUser.Update(tblUser) 
```

当我运行它时，我收到此错误消息：无法附加已存在的实体。

如何修复？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-13T12:01:31.640

解决此问题的最简单方法是在检索用户对象和更新时使用相同的 DataContext。

通常，DataContext 应该为“工作单元”保持活动状态，换句话说，您可以使用它来检索您想要更改的任何对象，然后更改其属性，然后只需在 DataContext 上执行 SubmitChanges()。无需将实体重新附加到 DataContext，因为它已经引用了它。

我的 VB 技能不存在，但是这样的东西应该可以工作（注意：出现非常粗糙的伪代码，建议正确处理 DataContext 之类的东西）：

```
class cls_SEC_USER
{
    private _UIData = new UIData();

    public User SingleOrDefault(int x)
    {
        return _UIData.Users.SingleOrDefault(y => y.UserId == x);
    }

    public void Update(User u)
    {
        _UIData.SubmitChanges();
    }
}

// ..........

cls_SEC_USER tmpUser = new cls_SEC_USER();  
User u = tmpUser.SingleOrDefault(4);

if(u != null)
{
    u.DT_LAST_LOGIN = DateTime.Now;
    tmpUser.Update(u);
} 
```

如果您想深入挖掘，[Brian Orrell 对您遇到的问题有一个很好的总结。](http://borrell.parivedasolutions.com/2008/02/linq-to-sql-updating-in-aspnet-right.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T17:45:11.523

如果您从中检索用户对象的 DataContext 尚未断开或处置，我认为不需要调用 Attach()。objUIData 的生命周期是什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T17:47:05.110

我不知道你的问题的答案，我也遇到了同样的问题，但我采取了一个简单的策略来防止这些小问题。

不要尝试附加/分离，而是尽快获取实际对象；这在网络场景中效果很好。

# graphics - 用于分层流程图的 Javascript 库

> ID：363592
> 
> 赞同：13
> 
> 时间：2008-12-12T17:47:53.047
> 
> 标签：graphics, javascript

你知道任何可以在网页中直观地呈现图形的 Javascript 库吗？

澄清：我所说的图表是指工作流树或决策树之类的东西。抱歉不清楚。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-01-05T15:43:27.040

我一直在做一些研究，寻找一个可以处理实时创建流程图/决策树的 JS 组件，mxGraph 看起来很方便：[http ://www.jgraph.com/mxgraph.html](http://www.jgraph.com/mxgraph.html)

免责声明：除了在网上搜索合适的东西外，我与供应商没有任何关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T17:55:30.833

道场图表：

*   [测试](http://archive.dojotoolkit.org/nightly/dojotoolkit/dojox/charting/tests/)（警告：此测试服务器设置用于调试）
*   [我在 SitePen 博客上的文章](http://www.sitepen.com/blog/author/elazutkin/)（声明：我是这个包的主要开发者）。

带有指向同一测试服务器的链接的独立 Dojo 图表小部件：

*   [模拟量规](http://archive.dojotoolkit.org/nightly/dojotoolkit/dojox/widget/tests/test_AnalogGaugeWidget.html)
*   [条形图](http://archive.dojotoolkit.org/nightly/dojotoolkit/dojox/widget/tests/test_BarGaugeWidget.html)（子弹图的变体）。

**编辑：**回复问题的最新编辑：Dojo Charting 不直接支持流程图。有几个项目使用 Dojo GFX 做到了这一点，但没有人回馈它——请尝试使用谷歌。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-11T16:49:40.597

JS流程图...

仅使用 HTML GUI 创建流程图。函数是在 JQuery 的帮助下用 JavaScript 编写的。绘图源为 HTML 格式且可见。如果在浏览器中打开 index.htm，程序可以在本地使用。

[http://sourceforge.net/projects/jsflowchart/](http://sourceforge.net/projects/jsflowchart/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T19:15:21.593

几年前，我使用[Prototype](http://prototypejs.org)制作了一个[概念验证](http://jameslab.moveable.com/ajaxio/)盒和连接器程序。这有点蹩脚，我从来没有完成它，但它证明它是可以完成的。不客气。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T17:49:41.843

我们在上一个项目中使用了[YUI](http://developer.yahoo.com/yui/)。它是免费的，并且有很多简洁的功能，看看吧！

**编辑：**图表是允许统计类型图、散点图和其他图表内容的组件。我没有意识到您正在寻找基于流程图/层次结构的图表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T17:51:27.707

SO 使用[flot](http://code.google.com/p/flot/)，我认为它非常棒，并且希望在即将到来的公司项目中使用

**编辑：**错过了“分层”部分。尽管如此，仍然会推荐使用线性浮点数

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-05T15:54:32.380

[InfoVis](http://thejit.org/)怎么样？（请参阅[此 SO 问题](https://stackoverflow.com/questions/1911903/jquery-or-extjs-plugins-for-creating-organization-chart)。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-11T17:18:53.113

不久前我使用了[以下库](http://www.codeproject.com/KB/scripting/graphic_javascript_tree.aspx)，它很好地实现了 walker 算法。不过可能有点过时了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-04T07:57:03.827

我认为 JQuery 有一些解决方案，但我会说在 Flex 中进行，这对于这些场景来说非常棒。甚至还有针对 Flex 的开源解决方案。这也很简单，只需查看 Adob​​e 文档即可。

# unit-testing - 对调用另一个方法的方法进行单元测试

> ID：363596
> 
> 赞同：74
> 
> 时间：2008-12-12T17:48:46.477
> 
> 标签：unit-testing, testing

对调用多个方法的方法进行单元测试的最佳方法是什么，例如：

```
modify(string value)
{
    if(value.Length > 5)  replaceit(value);

    else changeit(value);
} 
```

此伪代码有一个 modify 方法，该方法（当前）调用`replaceit()`或`changeit()`。我已经为`replaceit`and`changeit`编写了测试，因此为 modify 编写一个新的测试将是 99% 的同一组代码。我需要对其进行测试，因为它可能会在未来发生变化。

那么我要复制粘贴现有的测试代码吗？将测试代码移至通用函数？还有其他想法吗？我不确定这里的最佳做法。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-12-12T18:28:22.857

这是一个经典的基于状态的测试与基于行为的测试场景。

在这个非常简单的示例中，测试输出很好。但是，在某些时候，您会遇到执行后检查状态很复杂的测试。相反，您想检查行为（例如，验证 changeit 是使用特定值调用的）。

那时，您可能应该研究一个模拟对象框架，如 Rhino.Mocks (.Net) 或 Mockito (Java)，并开始编写更多基于接口的代码。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-12T17:54:30.303

如果您已经独立测试过`replaceit()`，`changeit()`那么您唯一需要测试的就是 if 条件。使用一些值进行测试`modify()`，以确保它在正确的条件下调用正确的函数（对于您提供的示例代码，这些条件`null`的`Strings`长度为 4、5 和 6）。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-12-12T19:24:10.373

你有很多选择。哪个最好取决于您的问题中不清楚的细节。

*   `modify`就好像它是一个不相关的方法一样进行测试。优点：它可能在某个时候成为一个。
*   只需测试您是否正确地使用了 if 语句。也就是说，只需进行足够的测试以使测试迫使您编写所需的实现（调用`replaceit`and`changeit`只是*可能工作的最简单的实现*。如果您正在练习 TDD，这对您来说应该很自然。优势：高测试覆盖率，无需重复的努力。
*   *子类和覆盖方法*（这是“有效地使用遗留代码”一书中的一种依赖破坏技术）：在您引入的子类上测试方法，该子类仅用于测试目的，它覆盖`replaceit`并`changeit`使用预设答案或设置感知变量（指示方法是否已使用正确的值调用的变量）。优点：可能会简化您的测试（或不简化），有时甚至只是使测试成为可能。
*   `replaceit`为和方法提取一个新类`changeit`，包括该类的接口。测试时存根或模拟该接口`modify`。优点：可能会使您的设计更可测试*，并且*通常（或不能）更好地解耦/可重用。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-12-12T18:07:37.440

只是测试`modify`。

`Modify`应该在给定某些值时返回某些值。

*modify如何*完成它的工作并不重要——只要它*完成*它的工作。事实上，它碰巧使用`replaceit`并且`changeit`是不允许任何人依赖的内部实现细节。

而且，如果将来您更改`modify`为使用不同的方法（或不使用方法），它不会、不应该、也不会影响您对`modify`.

也就是说，还要测试`replaceit`和`changeit`.

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-12T06:14:26.087

按优先顺序

1.  modify(test) 只有 2 个场景（if stmt 的每个分支），所以我会编写 2 个测试来修改表单。
    如果 replaceit(value) 的预期结果很容易确定..

.

```
public TestModifyIfValueLength..()
    {
      string expectedValue = .. ;// literal result of replaceit(value)
      Assert.Equals( expectedValue, modify("asd") );
    } 
```

2.  如果不是，请考虑使用存根（使用子类并覆盖 changeit、replaceit）来验证是否调用了正确的方法。
3.  如果存根工作量太大，请执行 Mock 操作。提取一个界面并设置对 changeit、replaceit 的期望。

假设

*   您对 replaceit(value) 和 changeit(value) 进行了测试，它们全面测试了这两种方法（例如所有边界条件）。
*   replaceit() 和 changeit() 是公共方法。如果不是，您应该考虑仅针对公共方法编写测试。您应该可以在不知道测试代码的情况下自由调整/删除私有方法。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-12T17:56:06.963

在这种情况下，“测试代码”是什么？设置并检查结果？如果是这样，我会将其重构为不同的方法并在每个测试中使用它。我只会在有大量的情况下才这样做 - 只需阅读该方法的代码，就能看到测试所做的一切，这对可读性有好处。

老实说，复杂的测试方法常常困扰着我 - 通常它们实际上无法避免，但如果你*可以*简化它们，那么这样做是值得的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-12T17:57:40.720

如果您已经为 replaceit() 和 changeit() 编写了测试，则修改测试将简单地检查是否根据“值”的值返回不同的结果。但是，您将只是在测试中重新实现该方法的逻辑，这有点荒谬。

在这种情况下，我不会测试修改，直到它具有更复杂的逻辑，或者更好 - 被另一种更重要的测试方法使用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-12T17:54:55.873

好吧，不，您的测试代码不会 99% 相同，因为您实际上在这里测试的是不同的东西，除非 replaceit、changeit 和 modify 都返回相同的值。

不知道为什么困难。修改方法的测试应该是大约四行长。由于您已经在测试底层功能并且您要做的就是确保此特定方法不会中断，因此编写一个测试来测试此函数中返回预期值的两个可能的代码路径就足够了。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-12T18:17:30.303

你基本上需要2个测试。

1) 传入一个字符串，如“The Quick Brown Fox Jumps!” （长度大于五）确保该值受`replaceit(...)`

2) 传入一个类似 "Foo" 的字符串（长度小于 5），并确保该值受`changeit(...)`

您的测试（在伪代码中）可能如下所示：

```
testLongValue() {
    string testValue = "A value longer than 5 chars";
    string expected = "Replaced!";
    string actual = modify(testValue);
    assertEqual(expected, actual);
}

testShortValue() {
    string testValue = "len4";
    string expected = "Changed!";
    string actual = modify(testValue);
    assertEqual(expected, actual);
} 
```

显然，如果我知道 replacit() 和 changeit() 应该做什么，我可以给你一个更现实的例子，但这应该给你一个想法。如果它改变了原始值引用而不是返回它，您可以在调用发生后使用 testValue 作为实际值。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-12T18:19:43.577

像您这样测试边界条件`if (value.length > 5)`时，应确保您的测试数据包含`value`长度`4`为 、`5`或的值`6`。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-10-23T22:03:09.767

您可以从方法中创建一个函数并模拟这些函数。或者，您可以创建一个虚拟方法并使用 Rhino 模拟 - 部分模拟，您可以模拟这些虚拟方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-12T18:36:55.337

与贾斯汀标准相同，*加上*作为值传递`null`（对于您提供给我们的代码片段，这显然会失败；））单元测试的基本规则是“仅测试特定于被测方法的内容”。而且它相当......不常见的方法不调用另一个方法。

# asp.net - 如何有效地允许多个用户在一台机器上访问 ASP.NET 应用程序？

> ID：363643
> 
> 赞同：0
> 
> 时间：2008-12-12T18:03:13.720
> 
> 标签：asp.net, authentication, session

我们有两种类型的用户——一种是在大楼里走动并在无线网络上使用 PDA 访问应用程序，另一种是桌面用户。

有时，移动用户会尝试使用其中一台桌面用户 PC 来访问该应用程序。这通常会导致两个用户之间的数据和页面溢出。出于非常特殊的原因，修改用户行为不是一种选择。正在使用的机器只运行 6 或 7。

这里的核心问题是什么，推荐的方法是什么？

散漫的答案赞赏！

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T18:15:40.463

一般来说，您的问题听起来更像是用户体验 + 用户培训问题，而不是技术相关问题。

如果用户在以其他用户身份登录时输入或更新数据，我认为最好的解决方法是明确**谁**从每个屏幕登录到应用程序。例如，将用户名以相当大的字体放在页面顶部附近，并在其旁边提供一个注销链接。这是假设您的系统中可以使用用户名/密码类型的身份验证。

你不一定要让他们做**很多**额外的工作，只需单击一两次即可。

希望有帮助！

# c# - C# List<> GroupBy 2 个值

> ID：363655
> 
> 赞同：34
> 
> 时间：2008-12-12T18:10:25.250
> 
> 标签：c#, linq, list, ienumerable, group-by

我在 Framework 3.5 上使用 C#。我希望通过两个属性快速分组一个通用列表<>。为了这个例子，假设我有一个带有 CustomerId、ProductId 和 ProductCount 属性的 Order 类型的列表。如何使用 lambda 表达式获得按 CustomerId 和 ProductId 分组的 ProductCounts 的总和？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-12-12T18:43:00.720

```
var sums = Orders.GroupBy(x => new { x.CustomerID, x.ProductID })
                 .Select(group => group.Sum(x => x.ProductCount)); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2010-05-19T19:59:52.160

我意识到这个线程已经很老了，但由于我只是在这个语法上苦苦挣扎，我想我会发布我的额外发现 - 你可以在一个查询中返回总和和 ID（不带 foreach），如下所示：

```
var sums = Orders
            .GroupBy(x => new { x.CustomerID, x.ProductID })
            .Select(group =>new {group.Key, ProductCount = group.Sum(x => x.ProductCount)}); 
```

对我来说，让它工作的棘手部分是总和必须是别名，显然......

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-14T23:40:20.320

或者，如果您想获取每个总和的 ID，您可以这样做

```
var customerAndProductGroups =
    from order in Orders
    orderby order.CustomerID, order.ProductID // orderby not necessary, but neater
    group order by new { order.CustomerID, order.ProductID };

foreach (var customerAndProductGroup in customerAndProductGroups)
{
    Console.WriteLine("Customer {0} has ordered product {1} for a total count of {2}",
        customerAndProductGroup.Key.CustomerID,
        customerAndProductGroup.Key.ProductID,
        customerAndProductGroup.Sum(item => item.ProductCount));
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-01T14:17:52.373

var New1 = EmpList.GroupBy(z => z.Age).OrderBy(Employee => Employee.Key);

dataGridView1.DataSource = New1;

# mysql - Mysql 可视化工具

> ID：363658
> 
> 赞同：18
> 
> 时间：2008-12-12T18:11:22.907
> 
> 标签：mysql, database, database-design, visualization

有谁知道一个好的（最好是开源和跨平台的）工具来允许简单地可视化 mysql 数据库？我只需要一个可以快速指向数据库的工具，它会显示基本的表结构和字段类型等。没有什么太高级或太疯狂了。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-12T18:29:20.390

[MySQL Workbench](http://dev.mysql.com/workbench/)在 Windows 和 Linux 上运行。商业版可以让您对实时数据库的结构进行逆向工程和编辑，免费版可以让您首先将结构转储到文件中。它的祖先[DBDesigner](http://www.fabforce.net/dbdesigner4/)有点老，但没有这个限制。Windows 和 Linux 也是如此。

如果这两个是矫枉过正，您可以尝试使用[MySQLFront](http://www.heidisql.com/)的后代 HeidiSQL。它仅在 Windows 上运行，但有一个在 Java 上运行的 alpha 版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T18:40:00.133

我真的很喜欢Windows 上的[Sqlyog](http://www.webyog.com/en/downloads.php)。它（技术上）是开源的，但不是跨平台的。（向下滚动到“社区版”）

如果您的要求是开源的、简单的和跨平台的，您是否考虑过使用[phpMyAdmin](http://www.phpmyadmin.net)建立一个网站？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T18:14:39.140

mysql-管理员

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-12T18:17:59.477

还有 MySQL Workbench。它更多用于设计，但会按照您的要求进行。有一个有点残缺的免费版本，我认为它可能只是 Windows。

编辑：有一个 Linux 版本。

[http://dev.mysql.com/downloads/workbench/5.1.html](http://dev.mysql.com/downloads/workbench/5.1.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-16T23:46:17.740

Sqlyog社区应该没问题

# c# - 处理应用程序重新设计

> ID：363659
> 
> 赞同：1
> 
> 时间：2008-12-12T18:11:59.753
> 
> 标签：c#, asp.net, database-design

我正在做一个重新设计/重做应用程序的项目。问题是旧的应用程序是用 ASP.net 1.0 编写的，数据库非常大，有 100 多个表和 300 个奇怪的视图。数据库以非常劣质的方式处理角色和成员资格。它也涉及一个简单的工作流程。该应用程序在维护方面很痛苦。我有大约 3-4 个月的时间来重做软件。

数据库设计不是我喜欢的，但查看迁移数据的时间框架和数据库重新设计可能会使项目偏离轨道。

以前有人遇到过这种情况吗？？有人对我如何进行这个项目有任何指示吗？

我很想用 .NET 3.5 让软件跟上速度。如果不考虑数据库，我不确定 App 重新设计是否有意义

系统问题： 1\. 维护性和可扩展性问题。2\. 糟糕的数据库设计，特别是在用户管理的情况下，应用程序严重依赖用户和角色等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T18:35:30.800

数据库重新设计是一项巨大的工作。如果您或您团队中的某个人不是数据库设计和 ETL 方面的专家，那么您最终可能会遇到比现在更糟的情况。

但是，是否有可能只修复数据库中最糟糕的一两个部分，从而实现整体改进？查看性能最差的查询以了解真正的错误（不仅仅是从您个人的角度来看您不喜欢什么，而是从现在真正运行不佳的方面）。也许比完全重新设计少的东西可以给您带来重大的性能提升。

如果您不喜欢数据库的原因是它不是真正的关系型数据库，那么您可能会妥协，方法是放入具有新名称的关系表、移动数据并删除旧表，以及使用结构化的旧表名称创建视图喜欢现在的设计。（不要首先没有当前的数据库备份！！！！）这样您就可以开始将代码更改为新的更有效的设计，但在您完成之前，您没有更改的内容仍然有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T18:21:34.977

您是否负责重新设计数据库或整个应用程序？您是在执行单人任务还是有大量帮助？您的公司是否采用任何方法标准（SDLC 流程），或者您是一个特立独行的 IT 部门？

四个月听起来很有侵略性。您需要记录需求、计划、设计、构建和测试每个功能组件，将数据从旧系统转换到新系统，并可能为所有这些场景的发生设置新环境。

底线是：花大量时间估算完成整个过程所需的工作量。如果是四个月，那就太好了。我怀疑它会是。一旦你对所涉及的工作有一个记录的、详细的估计，把它带给你的老板，并向他解释四个月的时间框架有多极端。

如果您主要关心是否重做数据库，请考虑一个古老的成语，即链的强度取决于其最薄弱的环节。新的应用程序将使用 .NET 编写，但是坐在一个设计糟糕的、杂乱无章的数据库上真的有意义吗？

花时间*计划*您的项目，您将花费更少的时间进行实际开发、测试和返工，否则您会遇到这些问题。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T18:26:43.813

这是一句老话，***聪明的数据结构和愚蠢的逻辑每次都击败了相反的***事情。[请参阅unix 哲学文章](http://en.wikipedia.org/wiki/Unix_philosophy)中的规则 5 。归根结底，我从事的每个项目都不得不用代码来修复损坏的数据结构，这一直是一件痛苦的事情。

简短的回答：如果可以的话，重新做数据。

长答案：务实。如果你可以通过只重做部分数据库来省去一些麻烦，那就去做吧。在应用程序逻辑中处理它会比在数据库级别更痛苦。

希望有帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T18:19:59.177

如果您不想重新设计数据库，您可以随时重构您的用户体验 (UI)。如果您选择使用 webforms，请使用一个好的模式，那么我的建议是使用 Model View Presenter-pattern，或者如果您了解很多 javascript 和 html 并且您不喜欢 webforms 模型，请使用新的 ASP.NET MVC。

但在你要重构你的应用程序之前，你必须了解你选择的设计模式。

我希望你能用这些信息做点什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T18:52:52.153

我真的不知道项目的范围。但是 4 个月的时间来重新设计一个 100 个表的系统似乎不切实际。除了，也许，如果你非常了解这个领域。

我的 0.02 美元

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T19:05:50.753

加上我的 0.02 美元，您首先必须清楚为什么要进行重新设计，当前软件的问题是什么，性能、可维护性、扩展产品的更好基础等。然后明确说明您的目标新产品（即改进用户体验、性能目标、框架等）也许这会让您更好地了解需要重新设计的内容和有效的内容。

# collections - 在多个类上拉伸对象的好方法

> ID：363660
> 
> 赞同：1
> 
> 时间：2008-12-12T18:12:06.913
> 
> 标签：collections, mdi

我有一系列订单。我想访问数据库一次，检索订单，存储它们，然后能够通过多个表单访问这个集合。我知道在 asp.net 中，您可以使用 Application Object 或 Session Object 之类的东西，但是您如何在 win 表单应用程序中做到这一点？我正在考虑创建一个可以通过多个表单、类或任何地方访问的静态集合。这听起来对吗，甚至可行吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T18:36:04.027

WebForms 和 WinForms 的根本区别在于 WinForms 是有状态的。换句话说，您可以确保您加载一次的对象在程序关闭之前都可用。WebForms 并非如此，因为 HTTP 是无状态的，而 ASP.Net 编织了许多“魔术”[ViewState、服务器会话、Cookie、隐藏字段等] 来将 Web 应用程序的页面粘合在一起。

有了这种方式的基本概念，就很容易使对象在 WinForms 中全局可用。使用 Singleton / Static 类并分配其成员。您总是可以说 .Instance.. [在静态类/具有静态属性的类的情况下] 从任何表单中检索值。

一个问题是“线程安全”……又名……多个表单同时读取/写入静态属性。如果你能照顾好这个，休息是轻而易举的事。

对于您的上述问题：

您可以拥有自己的 Singleton Cache 类来缓存记录。Cache 类将是一个自定义集合实现。您需要确保它是线程安全的[或确保您的应用程序只加载一次并从那时起读取]...如果您希望对数据库的更改反映在实体对象中，您可能需要考虑一个成熟的 ORM .

`CacheList.OrderCache[orderNo].Customer.Address.City = "Las Vegas";`

 `class static CacheList { public static Cache OrderCache {get; internal set;}

}

public class Cache : CollectionBase where T : Entity { .....` 

`}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T18:15:35.910

无论如何，您应该有一些访问数据库的数据对象，对吧？将其包装在一个 CacheProxy 类中，如果它没有本地副本，它将命中数据库。我听说你也可以[在 Winforms 中使用 System.Web 缓存](http://www.codeproject.com/KB/cs/cacheinwinformapps.aspx)。

# c# - 用于字符串连接的 StringBuilder 抛出 OutOfMemoryException

> ID：363680
> 
> 赞同：16
> 
> 时间：2008-12-12T18:20:41.623
> 
> 标签：c#, out-of-memory, stringbuilder

我们大多倾向于遵循上述最佳实践。

看看[String 与 StringBuilder](https://stackoverflow.com/questions/73883/string-vs-stringbuilder)

**但即使有足够的可用内存，** StringBuilder 也可能抛出OutOfMemoryException 。它会抛出 OOM 异常，因为它需要“连续的内存块”。

一些链接供参考 [StringBuilder OutOfMemoryException](http://bytes.com/groups/net-c/501231-stringbuilder-outofmemory)

还有更多......

你们中有多少人面临或意识到这个问题，你做了什么来解决它？

有什么我想念的吗？

**PS：我没有意识到这一点。**

我已经改写了这个问题。

*** 同样的事情也适用于手动连接（我将验证这一点并更新 SO）。引起我担心的另一件事是系统中有足够的内存。这就是我在这里提出这个问题以检查是否有人遇到这个问题或者代码有什么严重错误的原因。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-12T18:24:41.553

您创建的底层字符串也需要一个连续的内存块，因为它表示为一个字符数组（数组需要连续的内存）。如果 StringBuilder 抛出 OOM 异常，你将无法在没有它的情况下构建底层。

如果创建字符串导致 OOM，则您的应用程序中可能存在更严重的问题。

编辑以回应澄清：

当手动连接成功时，使用 StringBuilder 构建字符串会失败的一小部分情况。手动连接将使用组合两个字符串所需的确切长度，而 StringBuilder 具有不同的分配内存的算法。它更具侵略性，并且可能会分配比字符串实际需要的更多内存。

使用 StringBuilder 还将导致所需内存临时加倍，因为字符串将在短时间内以 System.String 形式和 StringBuilder 同时存在。

但是，如果一种方式导致 OOM 而另一种没有，那么它仍然可能指向您的程序中更严重的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T18:33:22.957

如果 StringBuilder 将在您的特定情况下抛出 OutOfMemoryException，那么进行手动字符串连接并不是更好的解决方案；情况更糟。这正是应该使用 StringBuilder 的情况（创建一个非常非常长的字符串）。手动连接这么大的字符串将花费许多倍于使用 StringBuilder 创建字符串所需的内存。

也就是说，在现代计算机上，如果您的字符串*在连续内存不足的情况下运行*计算机，则您的设计存在严重缺陷。我无法想象你可能会做什么来创建一个那么大的字符串。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T18:50:40.457

我们在谈论多少内存？我不是在谈论系统中的可用内存或总内存，但是您要连接的字符串有多长？

内存溢出异常几乎总是关于您的代码的一个非常糟糕的信号，即使它在内存实际耗尽之前很久就失败了，就像您由于连续内存不可用而经历的那样。

那时你真的应该重构代码。

例如，以下是解决该问题的各种方法：

1.  不要一次将尽可能多的数据保存在内存中，将其放在磁盘或其他东西上
2.  分解它，保留一个字符串/字符串生成器列表，并且在切换到新的之前只添加到一定长度，避免“连续内存”问题
3.  重构算法以完全不在内存中建立千兆字节的数据

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-12T18:29:49.670

如果您的内存限制如此接近以至于这甚至是一个问题，那么您可能应该考虑不同的架构或获得更强大的机器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T19:29:58.317

如果您查看`StringBuilder`其实现方式，您会发现它实际上使用 a`String`来保存数据（`String`具有内部方法，允许`StringBuilder`就地修改）。

即它们都使用相同数量的内存。但是，因为`StringBuilder`将在需要时自动扩展底层数组并根据需要进行复制（但容量增加一倍），这很可能是导致内存不足错误的原因。但是正如其他人已经指出的那样，两者都需要连续的内存块，

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-12T18:33:08.370

好吧，问题实际上是，为什么你需要处理这么长的字符串？如果你偶然发现了这个问题，你很可能应该改变你的概念。

这个问题甚至会影响*System.String*类，因此您应该将输入分块到*List<string>*并并行处理数据，如果编写得当，这应该会提高整体性能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-17T22:27:31.403

我遇到了这个异常，用不同的字符串构建器连续构建了非常大的字符串（这不应该引起问题，因为它们是在匿名函数中声明的），最后通过重用在匿名函数之外声明的单个 StringBuilder 来解决它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-12-22T21:32:00.900

我有一个非常相似的经验，我在附加字符串但忘记添加 String.Format。因此：

```
myStringBuilder.Append("1,""{0}""", someVeryLargeIntVariable) 
```

本来应该：

```
myStringBuilder.Append(String.Format("1,""{0}""", someVeryLargeIntVariable)) 
```

请注意，这是我失败的 vb.net 代码。我在 c# 中复制了一个类似的测试：

```
myStringBuilder.Append('a', 1564544656); 
```

对比

```
myStringBuilder.Append(string.Format("1,\"{0}\"", 1564544656)); 
```

但就我而言，vb.net 让我陷入了隐式转换的麻烦 b/c（我无法在 c# 中并行处理*完全相同的问题）。*

我希望这对某人有所帮助。

# java - 如何在 Java 中生成特定范围内的随机整数？

> ID：363681
> 
> 赞同：3883
> 
> 时间：2008-12-12T18:20:57.053
> 
> 标签：java, random, integer

如何生成随机数`int`特定范围内的随机值？

我尝试了以下方法，但这些都不起作用：

**尝试1：**

```
randomNum = minimum + (int)(Math.random() * maximum); 
```

错误：`randomNum`可以大于`maximum`.

**尝试2：**

```
Random rn = new Random();
int n = maximum - minimum + 1;
int i = rn.nextInt() % n;
randomNum =  minimum + i; 
```

错误：`randomNum`可以小于`minimum`.

* * *

## 回答 #1

> 赞同：4151
> 
> 时间：2008-12-12T18:25:27.497

在**Java 1.7 或更高版本**中，执行此操作的标准方法如下：

```
import java.util.concurrent.ThreadLocalRandom;

// nextInt is normally exclusive of the top value,
// so add 1 to make it inclusive
int randomNum = ThreadLocalRandom.current().nextInt(min, max + 1); 
```

请参阅[相关的 JavaDoc](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/ThreadLocalRandom.html#nextInt(int,int))。这种方法的优点是不需要显式初始化[java.util.Random](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Random.html)实例，如果使用不当，可能会造成混乱和错误。

然而，相反，没有办法明确设置种子，因此在测试或保存游戏状态或类似情况等有用的情况下，很难重现结果。在这些情况下，可以使用下面所示的 Java 1.7 之前的技术。

**在 Java 1.7 之前**，执行此操作的标准方法如下：

```
import java.util.Random;

/**
 * Returns a pseudo-random number between min and max, inclusive.
 * The difference between min and max can be at most
 * <code>Integer.MAX_VALUE - 1</code>.
 *
 * @param min Minimum value
 * @param max Maximum value.  Must be greater than min.
 * @return Integer between min and max, inclusive.
 * @see java.util.Random#nextInt(int)
 */
public static int randInt(int min, int max) {

    // NOTE: This will (intentionally) not run as written so that folks
    // copy-pasting have to think about how to initialize their
    // Random instance.  Initialization of the Random instance is outside
    // the main scope of the question, but some decent options are to have
    // a field that is initialized once and then re-used as needed or to
    // use ThreadLocalRandom (if using at least Java 1.7).
    // 
    // In particular, do NOT do 'Random rand = new Random()' here or you
    // will get not very good / not very random results.
    Random rand;

    // nextInt is normally exclusive of the top value,
    // so add 1 to make it inclusive
    int randomNum = rand.nextInt((max - min) + 1) + min;

    return randomNum;
} 
```

请参阅[相关的 JavaDoc](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Random.html#nextInt(int))。在实践中，[java.util.Random](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Random.html)类通常比[java.lang.Math.random()](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Math.html#random())更可取。

特别是，当标准库中有一个简单的 API 来完成任务时，不需要重新发明随机整数生成轮。

* * *

## 回答 #2

> 赞同：1485
> 
> 时间：2008-12-12T18:35:49.627

请注意，这种方法比一种`nextInt`方法更有偏见，效率更低，[https://stackoverflow.com/a/738651/360211](https://stackoverflow.com/a/738651/360211)

实现此目的的一种标准模式是：

```
Min + (int)(Math.random() * ((Max - Min) + 1)) 
```

[Java](http://en.wikipedia.org/wiki/Java_%28programming_language%29)数学库函数 Math.random() 在 range 中生成一个双精度值`[0,1)`。请注意，此范围不包括 1。

为了首先获得特定范围的值，您需要乘以要覆盖的值范围的大小。

```
Math.random() * ( Max - Min ) 
```

这将返回 range 中的值`[0,Max-Min)`，其中不包括“Max-Min”。

例如，如果你想`[5,10)`，你需要覆盖五个整数值，所以你使用

```
Math.random() * 5 
```

这将返回 range 中的值`[0,5)`，其中不包括 5。

现在您需要将此范围向上移动到您的目标范围。您可以通过添加 Min 值来做到这一点。

```
Min + (Math.random() * (Max - Min)) 
```

您现在将获得 range 中的值`[Min,Max)`。按照我们的示例，这意味着`[5,10)`：

```
5 + (Math.random() * (10 - 5)) 
```

但是，这仍然不包括在内`Max`，您将获得双倍价值。为了获得`Max`包含的值，您需要将 1 添加到您的范围参数`(Max - Min)`，然后通过强制转换为 int 来截断小数部分。这是通过以下方式完成的：

```
Min + (int)(Math.random() * ((Max - Min) + 1)) 
```

你有它。范围内的随机整数值`[Min,Max]`，或根据示例`[5,10]`：

```
5 + (int)(Math.random() * ((10 - 5) + 1)) 
```

* * *

## 回答 #3

> 赞同：433
> 
> 时间：2009-09-04T04:23:27.280

利用：

```
Random ran = new Random();
int x = ran.nextInt(6) + 5; 
```

整数`x`现在是可能结果为 的随机数`5-10`。

* * *

## 回答 #4

> 赞同：190
> 
> 时间：2008-12-12T18:25:08.403

利用：

```
minimum + rn.nextInt(maxValue - minvalue + 1) 
```

* * *

## 回答 #5

> 赞同：177
> 
> 时间：2014-11-26T18:29:07.910

使用[java-8](/questions/tagged/java-8 "显示标记为“java-8”的问题")[`ints(int randomNumberOrigin, int randomNumberBound)`](http://docs.oracle.com/javase/8/docs/api/java/util/Random.html#ints-int-int-) ，他们在[`Random`](http://docs.oracle.com/javase/8/docs/api/java/util/Random.html)类中引入了该方法。

例如，如果您想在 [0, 10] 范围内生成五个随机整数（或单个整数），只需执行以下操作：

```
Random r = new Random();
int[] fiveRandomNumbers = r.ints(5, 0, 11).toArray();
int randomNumber = r.ints(1, 0, 11).findFirst().getAsInt(); 
```

第一个参数仅指示生成的大小`IntStream`（这是生成无限制的方法的重载方法`IntStream`）。

如果您需要执行多个单独的调用，您可以从流中创建一个无限的原始迭代器：

```
public final class IntRandomNumberGenerator {

    private PrimitiveIterator.OfInt randomIterator;

    /**
     * Initialize a new random number generator that generates
     * random numbers in the range [min, max]
     * @param min - the min value (inclusive)
     * @param max - the max value (inclusive)
     */
    public IntRandomNumberGenerator(int min, int max) {
        randomIterator = new Random().ints(min, max + 1).iterator();
    }

    /**
     * Returns a random number in the range (min, max)
     * @return a random number in the range (min, max)
     */
    public int nextInt() {
        return randomIterator.nextInt();
    }
} 
```

你也可以为`double`和`long`价值观做这件事。我希望它有帮助！:)

* * *

## 回答 #6

> 赞同：118
> 
> 时间：2008-12-12T18:31:28.030

您可以将第二个代码示例编辑为：

```
Random rn = new Random();
int range = maximum - minimum + 1;
int randomNum =  rn.nextInt(range) + minimum; 
```

* * *

## 回答 #7

> 赞同：107
> 
> 时间：2015-03-12T22:44:28.503

只需对您的第一个解决方案进行小修改就足够了。

```
Random rand = new Random();
randomNum = minimum + rand.nextInt((maximum - minimum) + 1); 
```

* * *

在这里查看更多以实现[`Random`](https://insight.io/github.com/lambdalab-mirror/jdk8u-jdk/blob/master/src/share/classes/java/util/Random.java?line=77)

* * *

## 回答 #8

> 赞同：93
> 
> 时间：2013-02-12T23:19:46.923

`ThreadLocalRandom`相当于`java.util.Random`多线程环境的类。在每个线程中本地执行随机数的生成。因此，通过减少冲突，我们可以获得更好的性能。

```
int rand = ThreadLocalRandom.current().nextInt(x,y); 
```

`x`, `y`- 间隔，例如 (1,10)

* * *

## 回答 #9

> 赞同：75
> 
> 时间：2009-01-08T15:04:42.937

[Java](http://en.wikipedia.org/wiki/Java_%28programming_language%29)中的`Math.Random`类是从0开始的。所以，如果你写这样的东西：

```
Random rand = new Random();
int x = rand.nextInt(10); 
```

`x`会在`0-9`包容之间。

因此，给定以下项目数组，在（数组的基数）和`25`之间生成随机数的代码将是：`0``array.length`

```
String[] i = new String[25];
Random rand = new Random();
int index = 0;

index = rand.nextInt( i.length ); 
```

由于`i.length`will return `25`， the`nextInt( i.length )`将返回一个介于 的范围内的数字`0-24`。另一种选择是与`Math.Random`它以相同的方式工作。

```
index = (int) Math.floor(Math.random() * i.length); 
```

为了更好地理解，请查看论坛帖子*[Random Intervals (archive.org)](http://web.archive.org/web/20070308142422/http://www.kirupa.com/forum/showthread.php?s=&postid=81565)*。

* * *

## 回答 #10

> 赞同：58
> 
> 时间：2013-09-01T02:53:53.773

只需执行以下语句即可完成：

```
Randomizer.generate(0,10); //min of zero, max of ten 
```

下面是它的源代码

### 随机器.java

```
public class Randomizer {
    public static int generate(int min,int max) {
        return min + (int)(Math.random() * ((max - min) + 1));
    }
} 
```

它既干净又简单。

* * *

## 回答 #11

> 赞同：50
> 
> 时间：2011-01-10T13:19:59.707

请原谅我的挑剔，但大多数人建议的解决方案，即 ，`min + rng.nextInt(max - min + 1))`似乎很危险，因为：

*   `rng.nextInt(n)`达不到`Integer.MAX_VALUE`。
*   `(max - min)``min`为负时可能导致溢出。

一个万无一失的解决方案将为`min <= max`[ `Integer.MIN_VALUE`, `Integer.MAX_VALUE`] 内的任何内容返回正确的结果。考虑以下简单的实现：

```
int nextIntInRange(int min, int max, Random rng) {
   if (min > max) {
      throw new IllegalArgumentException("Cannot draw random int from invalid range [" + min + ", " + max + "].");
   }
   int diff = max - min;
   if (diff >= 0 && diff != Integer.MAX_VALUE) {
      return (min + rng.nextInt(diff + 1));
   }
   int i;
   do {
      i = rng.nextInt();
   } while (i < min || i > max);
   return i;
} 
```

尽管效率低下，但请注意，`while`循环中的成功概率始终为 50% 或更高。

* * *

## 回答 #12

> 赞同：34
> 
> 时间：2008-12-12T18:27:55.340

[我想知道Apache Commons Math](http://commons.apache.org/proper/commons-math/)库提供的任何随机数生成方法是否符合要求。

例如：[`RandomDataGenerator.nextInt`](http://commons.apache.org/proper/commons-math/javadocs/api-3.6.1/org/apache/commons/math3/random/RandomDataGenerator.html#nextInt(int,%20int))或[`RandomDataGenerator.nextLong`](http://commons.apache.org/proper/commons-math/javadocs/api-3.6.1/org/apache/commons/math3/random/RandomDataGenerator.html#nextLong(long,%20long))

* * *

## 回答 #13

> 赞同：33
> 
> 时间：2017-05-28T14:30:49.440

我用这个：

```
 /**
   * @param min - The minimum.
   * @param max - The maximum.
   * @return A random double between these numbers (inclusive the minimum and maximum).
   */
 public static double getRandom(double min, double max) {
   return (Math.random() * (max + 1 - min)) + min;
 } 
```

如果需要，您可以将其转换为整数。

* * *

## 回答 #14

> 赞同：31
> 
> 时间：2008-12-12T18:25:39.710

```
 rand.nextInt((max+1) - min) + min; 
```

* * *

## 回答 #15

> 赞同：30
> 
> 时间：2014-08-03T03:07:54.327

让我们举个例子。

假设我希望生成一个**5-10**之间的数字：

```
int max = 10;
int min = 5;
int diff = max - min;
Random rn = new Random();
int i = rn.nextInt(diff + 1);
i += min;
System.out.print("The Random Number is " + i); 
```

*让我们明白这*...

> > 用最大值初始化最大值，用最小值初始化最小值。
> > 
> > 现在，我们需要确定可以获得多少个可能的值。对于此示例，它将是：
> > 
> > > **5、6、7、8、9、10**
> > 
> > 所以，这个计数将是 max - min + 1。
> > 
> > > 即 10 - 5 + 1 = 6
> > 
> > 随机数将生成一个介于**0-5**之间的数字。
> > 
> > > 即 0、1、2、3、4、5
> > 
> > 将*最小值*添加到随机数将产生：
> > 
> > > 5、6、7、8、9、10
> > 
> > 因此，我们获得了所需的范围。

* * *

## 回答 #16

> 赞同：27
> 
> 时间：2015-05-27T10:43:08.360

[使用nextint(n)](http://docs.oracle.com/javase/6/docs/api/java/util/Random.html#nextInt(int))方法为 min 和 max 的差生成一个随机数，然后将 min 数添加到结果中：

```
Random rn = new Random();
int result = rn.nextInt(max - min + 1) + min;
System.out.println(result); 
```

* * *

## 回答 #17

> 赞同：27
> 
> 时间：2018-04-11T21:54:39.603

> 从 Java 7 开始，您不应再使用`Random`. 对于大多数用途，现在选择的随机数生成器是 [`ThreadLocalRandom`](https://stackoverflow.com/questions/363681/how-do-i-generate-random-integers-within-a-specific-range-in-java#answer-363692).
> 
> 对于分叉连接池和并行流，请使用[`SplittableRandom`](https://docs.oracle.com/javase/8/docs/api/java/util/SplittableRandom.html).

*约书亚·布洛赫。有效的Java。第三版。*

## 从 Java 8 开始

对于分叉连接池和并行流，`SplittableRandom`与`Random`.

`int`在范围内生成随机数`[0, 1_000]:`

```
int n = new SplittableRandom().nextInt(0, 1_001); 
```

生成`int[100]`范围内的随机值数组`[0, 1_000]:`

```
int[] a = new SplittableRandom().ints(100, 0, 1_001).parallel().toArray(); 
```

要返回随机值流：

```
IntStream stream = new SplittableRandom().ints(100, 0, 1_001); 
```

* * *

## 回答 #18

> 赞同：21
> 
> 时间：2013-12-24T13:33:13.920

只需使用[Random](http://docs.oracle.com/javase/6/docs/api/java/util/Random.html)类：

```
Random ran = new Random();
// Assumes max and min are non-negative.
int randomInt = min + ran.nextInt(max - min + 1); 
```

* * *

## 回答 #19

> 赞同：20
> 
> 时间：2012-08-12T15:01:37.200

这种方法使用起来可能很方便：

此方法将返回提供的最小值和最大值***之间***的随机数：

```
public static int getRandomNumberBetween(int min, int max) {
    Random foo = new Random();
    int randomNumber = foo.nextInt(max - min) + min;
    if (randomNumber == min) {
        // Since the random number is between the min and max values, simply add 1
        return min + 1;
    } else {
        return randomNumber;
    }
} 
```

***并且此方法将从***提供的最小值和最大值返回一个随机数（因此生成的数字也可以是最小值或最大值）：

```
public static int getRandomNumberFrom(int min, int max) {
    Random foo = new Random();
    int randomNumber = foo.nextInt((max + 1) - min) + min;

    return randomNumber;
} 
```

* * *

## 回答 #20

> 赞同：20
> 
> 时间：2017-11-02T06:38:07.033

要生成“在两个数字之间”的随机数，请使用以下代码：

```
Random r = new Random();
int lowerBound = 1;
int upperBound = 11;
int result = r.nextInt(upperBound-lowerBound) + lowerBound; 
```

这会给你一个介于 1（包括）和 11（不包括）之间的随机数，所以通过加 1 来初始化 upperBound 值。例如，如果你想生成 1 到 10 之间的随机数，那么用 11 而不是初始化 upperBound 数10.

* * *

## 回答 #21

> 赞同：19
> 
> 时间：2008-12-12T18:28:35.087

```
int random = minimum + Double.valueOf(Math.random()*(maximum-minimum )).intValue(); 
```

或者看看[Apache Commons](http://commons.apache.org/lang)的 RandomUtils 。

* * *

## 回答 #22

> 赞同：19
> 
> 时间：2010-02-16T08:50:53.270

如果掷骰子，它将是 1 到 6（不是 0 到 6）之间的随机数，所以：

```
face = 1 + randomNumbers.nextInt(6); 
```

* * *

## 回答 #23

> 赞同：18
> 
> 时间：2012-02-15T16:19:03.693

`ints`这是一个有用的类，可以在包含/排除边界的任意组合的范围内生成随机数：

```
import java.util.Random;

public class RandomRange extends Random {
    public int nextIncInc(int min, int max) {
        return nextInt(max - min + 1) + min;
    }

    public int nextExcInc(int min, int max) {
        return nextInt(max - min) + 1 + min;
    }

    public int nextExcExc(int min, int max) {
        return nextInt(max - min - 1) + 1 + min;
    }

    public int nextIncExc(int min, int max) {
        return nextInt(max - min) + min;
    }
} 
```

* * *

## 回答 #24

> 赞同：18
> 
> 时间：2017-06-20T12:39:17.707

您可以在 Java 8 中简洁地实现这一点：

```
Random random = new Random();

int max = 10;
int min = 5;
int totalNumber = 10;

IntStream stream = random.ints(totalNumber, min, max);
stream.forEach(System.out::println); 
```

* * *

## 回答 #25

> 赞同：17
> 
> 时间：2012-01-18T16:15:15.493

另一种选择是只使用[Apache Commons](http://en.wikipedia.org/wiki/Apache_Commons)：

```
import org.apache.commons.math.random.RandomData;
import org.apache.commons.math.random.RandomDataImpl;

public void method() {
    RandomData randomData = new RandomDataImpl();
    int number = randomData.nextInt(5, 10);
    // ...
 } 
```

* * *

## 回答 #26

> 赞同：17
> 
> 时间：2011-07-13T11:31:55.007

```
public static Random RANDOM = new Random(System.nanoTime());

public static final float random(final float pMin, final float pMax) {
    return pMin + RANDOM.nextFloat() * (pMax - pMin);
} 
```

* * *

## 回答 #27

> 赞同：16
> 
> 时间：2012-06-07T10:38:41.870

我发现这个例子[生成随机数](http://www.javapractices.com/topic/TopicAction.do?Id=62)：

* * *

此示例生成特定范围内的随机整数。

```
import java.util.Random;

/** Generate random integers in a certain range. */
public final class RandomRange {

  public static final void main(String... aArgs){
    log("Generating random integers in the range 1..10.");

    int START = 1;
    int END = 10;
    Random random = new Random();
    for (int idx = 1; idx <= 10; ++idx){
      showRandomInteger(START, END, random);
    }

    log("Done.");
  }

  private static void showRandomInteger(int aStart, int aEnd, Random aRandom){
    if ( aStart > aEnd ) {
      throw new IllegalArgumentException("Start cannot exceed End.");
    }
    //get the range, casting to long to avoid overflow problems
    long range = (long)aEnd - (long)aStart + 1;
    // compute a fraction of the range, 0 <= frac < range
    long fraction = (long)(range * aRandom.nextDouble());
    int randomNumber =  (int)(fraction + aStart);    
    log("Generated : " + randomNumber);
  }

  private static void log(String aMessage){
    System.out.println(aMessage);
  }
} 
```

此类的示例运行：

```
Generating random integers in the range 1..10.
Generated : 9
Generated : 3
Generated : 3
Generated : 9
Generated : 4
Generated : 1
Generated : 3
Generated : 9
Generated : 10
Generated : 10
Done. 
```

* * *

## 回答 #28

> 赞同：14
> 
> 时间：2015-03-26T13:02:40.417

最好使用[SecureRandom](http://docs.oracle.com/javase/7/docs/api/java/security/SecureRandom.html)而不是 Random。

```
public static int generateRandomInteger(int min, int max) {
    SecureRandom rand = new SecureRandom();
    rand.setSeed(new Date().getTime());
    int randomNum = rand.nextInt((max - min) + 1) + min;
    return randomNum;
} 
```

* * *

## 回答 #29

> 赞同：14
> 
> 时间：2010-02-22T11:44:03.290

```
rand.nextInt((max+1) - min) + min; 
```

这工作正常。

* * *

## 回答 #30

> 赞同：14
> 
> 时间：2014-11-28T00:50:24.237

这是一个简单的示例，显示了如何从封闭`[min, max]`范围生成随机数，而`min <= max is true`

您可以将其用作孔类中的字段，并将所有`Random.class`方法集中在一个地方

**结果示例：**

```
RandomUtils random = new RandomUtils();
random.nextInt(0, 0); // returns 0
random.nextInt(10, 10); // returns 10
random.nextInt(-10, 10); // returns numbers from -10 to 10 (-10, -9....9, 10)
random.nextInt(10, -10); // throws assert 
```

**资料来源：**

```
import junit.framework.Assert;
import java.util.Random;

public class RandomUtils extends Random {

    /**
     * @param min generated value. Can't be > then max
     * @param max generated value
     * @return values in closed range [min, max].
     */
    public int nextInt(int min, int max) {
        Assert.assertFalse("min can't be > then max; values:[" + min + ", " + max + "]", min > max);
        if (min == max) {
            return max;
        }

        return nextInt(max - min + 1) + min;
    }
} 
```

* * *

## 回答 #31

> 赞同：11
> 
> 时间：2015-02-11T11:40:18.450

```
private static Random random = new Random();    

public static int getRandomInt(int min, int max){
  return random.nextInt(max - min + 1) + min;
} 
```

或者

```
public static int getRandomInt(Random random, int min, int max)
{
  return random.nextInt(max - min + 1) + min;
} 
```

* * *

## 回答 #32

> 赞同：9
> 
> 时间：2021-06-28T12:25:36.597

```
Random rng = new Random();
int min = 3;
int max = 11;
int upperBound = max - min + 1; // upper bound is exclusive, so +1
int num = min + rng.nextInt(upperBound);
System.out.println(num); 
```

* * *

## 回答 #33

> 赞同：6
> 
> 时间：2014-06-14T03:50:38.187

```
import java.util.Random; 

public class RandomUtil {
    // Declare as class variable so that it is not re-seeded every call
    private static Random random = new Random();

    /**
     * Returns a psuedo-random number between min and max (both inclusive)
     * @param min Minimim value
     * @param max Maximim value. Must be greater than min.
     * @return Integer between min and max (both inclusive)
     * @see java.util.Random#nextInt(int)
     */
    public static int nextInt(int min, int max) {
        // nextInt is normally exclusive of the top value,
        // so add 1 to make it inclusive
        return random.nextInt((max - min) + 1) + min;
    }
} 
```

* * *

## 回答 #34

> 赞同：6
> 
> 时间：2012-10-27T08:07:07.543

您可以使用此代码段来解决您的问题：

```
Random r = new Random();
int myRandomNumber = 0;
myRandomNumber = r.nextInt(maxValue-minValue+1)+minValue; 
```

使用 myRandomNumber （它会给你一个范围内的数字）。

* * *

## 回答 #35

> 赞同：6
> 
> 时间：2014-01-15T00:51:55.380

我将简单说明问题提供的解决方案有什么问题以及为什么会出现错误。

解决方案1：

```
randomNum = minimum + (int)(Math.random()*maximum); 
```

问题：randomNum 被分配的数值大于最大值。

解释：假设我们的最小值是 5，而你的最大值是 10。任何`Math.random()`大于 0.6 的值都会使表达式的计算结果为 6 或更大，加上 5 会使它大于 10（你的最大值）。问题是您将随机数乘以最大值（生成的数字几乎与最大值一样大），然后加上最小值。除非最小值为 1，否则它是不正确的。如其他答案所述，您必须切换到

```
randomNum = minimum + (int)(Math.random()*(maximum-minimum+1)) 
```

+1 是因为`Math.random()`永远不会返回 1.0。

解决方案2：

```
Random rn = new Random();
int n = maximum - minimum + 1;
int i = rn.nextInt() % n;
randomNum =  minimum + i; 
```

您的问题是，如果第一项小于 0，则 '%' 可能会返回负数。由于`rn.nextInt()`返回负值的几率约为 50%，因此您也不会得到预期的结果。

然而，这几乎是完美的。您只需进一步查看 Javadoc，[nextInt(int n)](http://docs.oracle.com/javase/6/docs/api/java/util/Random.html#nextInt%28int%29)。使用该方法可用，做

```
Random rn = new Random();
int n = maximum - minimum + 1;
int i = rn.nextInt(n);
randomNum =  minimum + i; 
```

也会返回想要的结果。

* * *

## 回答 #36

> 赞同：6
> 
> 时间：2016-12-21T23:37:16.613

**使用 Java 8 IntStream 和 Collections.shuffle 的不同方法**

```
import java.util.stream.IntStream;
import java.util.ArrayList;
import java.util.Collections;

public class Main {

    public static void main(String[] args) {

        IntStream range = IntStream.rangeClosed(5,10);
        ArrayList<Integer> ls =  new ArrayList<Integer>();

        //populate the ArrayList
        range.forEach(i -> ls.add(new Integer(i)) );

        //perform a random shuffle  using the Collections Fisher-Yates shuffle
        Collections.shuffle(ls);
        System.out.println(ls);
    }
} 
```

**Scala 中的等价物**

```
import scala.util.Random

object RandomRange extends App{
  val x =  Random.shuffle(5 to 10)
    println(x)
} 
```

* * *

## 回答 #37

> 赞同：6
> 
> 时间：2019-05-13T09:04:30.250

可以使用以下代码：

```
ThreadLocalRandom.current().nextInt(rangeStart, rangeEndExclusive) 
```

* * *

## 回答 #38

> 赞同：5
> 
> 时间：2013-11-24T14:15:03.237

我正在考虑通过使用以下方法将生成的随机数线性归一化到所需的范围内。让`x`是一个随机数，让`a`和`b`是所需标准化数的最小和最大范围。

然后下面只是一个非常简单的代码片段，用于测试线性映射产生的范围。

```
public static void main(String[] args) {
    int a = 100;
    int b = 1000;
    int lowest = b;
    int highest = a;
    int count = 100000;
    Random random = new Random();
    for (int i = 0; i < count; i++) {
        int nextNumber = (int) ((Math.abs(random.nextDouble()) * (b - a))) + a;
        if (nextNumber < a || nextNumber > b) {
            System.err.println("number not in range :" + nextNumber);
        }
        else {
            System.out.println(nextNumber);
        }
        if (nextNumber < lowest) {
            lowest = nextNumber;
        }
        if (nextNumber > highest) {
            highest = nextNumber;
        }
    }
    System.out.println("Produced " + count + " numbers from " + lowest
            + " to " + highest);
} 
```

* * *

## 回答 #39

> 赞同：5
> 
> 时间：2015-04-08T14:14:01.603

你可以这样做：

```
import java.awt.*;
import java.io.*;
import java.util.*;
import java.math.*;

public class Test {

    public static void main(String[] args) {
        int first, second;

        Scanner myScanner = new Scanner(System.in);

        System.out.println("Enter first integer: ");
        int numOne;
        numOne = myScanner.nextInt();
        System.out.println("You have keyed in " + numOne);

        System.out.println("Enter second integer: ");
        int numTwo;
        numTwo = myScanner.nextInt();
        System.out.println("You have keyed in " + numTwo);

        Random generator = new Random();
        int num = (int)(Math.random()*numTwo);
        System.out.println("Random number: " + ((num>numOne)?num:numOne+num));
    }
} 
```

* * *

## 回答 #40

> 赞同：5
> 
> 时间：2020-05-04T14:48:10.440

```
int func(int max, int min){

      int range = max - min + 1;

      // Math.random() function will return a random no between [0.0,1.0).
      int res = (int) ( Math.random()*range)+min;

      return res;
} 
```

* * *

## 回答 #41

> 赞同：5
> 
> 时间：2018-05-31T15:16:34.117

```
import java.util.Random;

public class RandomSSNTest {

    public static void main(String args[]) {
        generateDummySSNNumber();
    }

    //831-33-6049
    public static void generateDummySSNNumber() {
        Random random = new Random();

        int id1 = random.nextInt(1000);//3
        int id2 = random.nextInt(100);//2
        int id3 = random.nextInt(10000);//4

        System.out.print((id1+"-"+id2+"-"+id3));
    }

} 
```

你也可以使用

```
import java.util.concurrent.ThreadLocalRandom;
Random random = ThreadLocalRandom.current(); 
```

但是，此类在多线程环境中表现不佳。

* * *

## 回答 #42

> 赞同：5
> 
> 时间：2017-10-09T08:48:28.547

```
Random random = new Random();
int max = 10;
int min = 3;
int randomNum = random.nextInt(max) % (max - min + 1) + min; 
```

* * *

## 回答 #43

> 赞同：5
> 
> 时间：2016-12-02T18:16:20.240

你可以使用

```
RandomStringUtils.randomNumeric(int count) 
```

方法也来自apache commons。

* * *

## 回答 #44

> 赞同：5
> 
> 时间：2020-10-08T05:18:42.200

您可以使用以下方式来做到这一点

```
int range = 10;
int min = 5
Random r = new Random();
int  = r.nextInt(range) + min; 
```

* * *

## 回答 #45

> 赞同：4
> 
> 时间：2012-10-27T08:17:26.713

I just generate a random number using Math.random() and multiply it by a big number, let's say 10000\. So, I get a number between 0 to 10,000 and call this number `i`. Now, if I need numbers between (x, y), then do the following:

```
i = x + (i % (y - x)); 
```

So, all `i`'s are numbers between x and y.

To remove the bias as pointed out in the comments, rather than multiplying it by 10000 (or the big number), multiply it by (y-x).

* * *

## 回答 #46

> 赞同：4
> 
> 时间：2018-08-14T12:25:54.900

**在尝试 1**中进行以下更改应该可以完成工作 -

```
randomNum = minimum + (int)(Math.random() * (maximum - minimum) ); 
```

检查[此](https://ideone.com/20nXU9)工作代码。

* * *

## 回答 #47

> 赞同：4
> 
> 时间：2017-05-26T13:24:38.657

如果您已经使用`Commons Lang API 2.x`或最新版本，则有一类用于随机数生成`RandomUtils`。

```
public static int nextInt(int n) 
```

从 Math.random() 序列返回介于 0（包括）和指定值（不包括）之间的伪随机、均匀分布的 int 值。

参数： **n** - 指定的独占最大值

```
int random = RandomUtils.nextInt(1000000); 
```

注意：在[RandomUtils](https://commons.apache.org/proper/commons-lang/javadocs/api-2.6/org/apache/commons/lang/math/RandomUtils.html#nextInt(java.util.Random))中有很多随机数生成方法

* * *

## 回答 #48

> 赞同：4
> 
> 时间：2017-08-12T14:10:39.000

这是执行此操作的简单方法。

```
import java.util.Random;
class Example{
    public static void main(String args[]){
        /*-To test-
        for(int i = 1 ;i<20 ; i++){
            System.out.print(randomnumber()+",");
        }
        */

        int randomnumber = randomnumber();

    }

    public static int randomnumber(){
        Random rand = new Random();
        int randomNum = rand.nextInt(6) + 5;

        return randomNum;
    }
} 
```

那里 5 是随机数的起点。6 是包含数字 5 的范围。

* * *

## 回答 #49

> 赞同：4
> 
> 时间：2021-08-24T03:28:28.790

int randomNum = 5+(int)(Math.random() * 5);

范围 5-10

* * *

## 回答 #50

> 赞同：4
> 
> 时间：2020-05-29T04:47:33.147

使用 Apache Lang3 Commons

```
Integer.parseInt(RandomStringUtils.randomNumeric(6, 6)); 
```

最小值 100000 到最大值 999999

* * *

## 回答 #51

> 赞同：4
> 
> 时间：2018-02-25T20:26:34.977

假设您想要介于 0-9 之间的范围，0 是最小值，9 是最大值。下面的函数将打印 0 到 9 之间的任何内容。所有范围都相同。

```
public static void main(String[] args) {
    int b = randomNumberRange(0, 9);
    int d = randomNumberRange (100, 200);
    System.out.println("value of b is " + b);
    System.out.println("value of d is " + d);
}

public static int randomNumberRange(int min, int max) {
    int n = (max + 1 - min) + min;
    return (int) (Math.random() * n);
} 
```

* * *

## 回答 #52

> 赞同：3
> 
> 时间：2012-12-05T17:28:48.830

我的一个朋友今天在大学里问过我同样的问题（他的要求是生成一个介于 1 和 -1 之间的随机数）。所以我写了这个，到目前为止它在我的测试中运行良好。理想情况下，有很多方法可以在给定范围内生成随机数。尝试这个：

功能：

```
private static float getRandomNumberBetween(float numberOne, float numberTwo) throws Exception{

    if (numberOne == numberTwo){
        throw new Exception("Both the numbers can not be equal");
    }

    float rand = (float) Math.random();
    float highRange = Math.max(numberOne, numberTwo);
    float lowRange = Math.min(numberOne, numberTwo);

    float lowRand = (float) Math.floor(rand-1);
    float highRand = (float) Math.ceil(rand+1);

    float genRand = (highRange-lowRange)*((rand-lowRand)/(highRand-lowRand))+lowRange;

    return genRand;
} 
```

像这样执行：

```
System.out.println( getRandomNumberBetween(1,-1)); 
```

* * *

## 回答 #53

> 赞同：3
> 
> 时间：2013-09-23T09:24:43.260

我认为这段代码会为它工作。请试试这个：

```
import java.util.Random;
public final class RandomNumber {

    public static final void main(String... aArgs) {
        log("Generating 10 random integers in range 1..10.");
        int START = 1;
        int END = 10;
        Random randomGenerator = new Random();
        for (int idx=1; idx<=10; ++idx) {

            // int randomInt=randomGenerator.nextInt(100);
            // log("Generated : " + randomInt);
            showRandomInteger(START,END,randomGenerator);
        }
        log("Done");
    }

    private static void log(String aMessage) {
        System.out.println(aMessage);
    }

    private static void showRandomInteger(int aStart, int aEnd, Random aRandom) {
        if (aStart > aEnd) {
            throw new IllegalArgumentException("Start cannot exceed End.");
        }
        long range = (long)aEnd - (long)aStart + 1;
        long fraction = (long) (range * aRandom.nextDouble());
        int randomNumber = (int) (fraction + aStart);
        log("Generated" + randomNumber);
    }
} 
```

* * *

## 回答 #54

> 赞同：3
> 
> 时间：2016-09-26T20:13:53.647

这将生成范围**(Min - Max)**且**没有重复的****随机数列表**。

 ****```
generateRandomListNoDuplicate(1000, 8000, 500); 
```

添加此方法。

```
private void generateRandomListNoDuplicate(int min, int max, int totalNoRequired) {
    Random rng = new Random();
    Set<Integer> generatedList = new LinkedHashSet<>();
    while (generatedList.size() < totalNoRequired) {
        Integer radnomInt = rng.nextInt(max - min + 1) + min;
        generatedList.add(radnomInt);
    }
} 
```

希望这会帮助你。

* * *

## 回答 #55

> 赞同：3
> 
> 时间：2018-05-23T15:24:13.047

下面是另一个使用 Random 和 forEach 的例子

```
int firstNum = 20;//Inclusive
int lastNum = 50;//Exclusive
int streamSize = 10;
Random num = new Random().ints(10, 20, 50).forEach(System.out::println); 
```

* * *

## 回答 #56

> 赞同：3
> 
> 时间：2018-11-17T07:46:35.577

将 java.util 用于 Random 用于一般用途。

您可以定义最小和最大范围以获得这些结果。

```
Random rand=new Random();
rand.nextInt((max+1) - min) + min; 
```

* * *

## 回答 #57

> 赞同：3
> 
> 时间：2018-02-01T04:54:58.237

下面的代码生成一个介于 100,000 和 900,000 之间的随机数。此代码将生成六位数的值。我正在使用此代码生成六位数的[OTP](https://en.wikipedia.org/wiki/One-time_password)。

用于`import java.util.Random`使用此随机方法。

```
import java.util.Random;

// Six digits random number generation for OTP
Random rnd = new Random();
long longregisterOTP = 100000 + rnd.nextInt(900000);
System.out.println(longregisterOTP); 
```

* * *

## 回答 #58

> 赞同：3
> 
> 时间：2017-01-19T06:37:25.250

我创建了一种方法来获取给定范围内的唯一整数。

```
/*
      * minNum is the minimum possible random number
      * maxNum is the maximum possible random number
      * numbersNeeded is the quantity of random number required
      * the give method provides you with unique random number between min & max range
*/
public static Set<Integer> getUniqueRandomNumbers( int minNum , int maxNum ,int numbersNeeded ){

    if(minNum >= maxNum)
        throw new IllegalArgumentException("maxNum must be greater than minNum");

    if(! (numbersNeeded > (maxNum - minNum + 1) ))
        throw new IllegalArgumentException("numberNeeded must be greater then difference b/w (max- min +1)");

    Random rng = new Random(); // Ideally just create one instance globally

    // Note: use LinkedHashSet to maintain insertion order
    Set<Integer> generated = new LinkedHashSet<Integer>();
    while (generated.size() < numbersNeeded)
    {
        Integer next = rng.nextInt((maxNum - minNum) + 1) + minNum;

        // As we're adding to a set, this will automatically do a containment check
        generated.add(next);
    }
    return generated;
} 
```

* * *

## 回答 #59

> 赞同：3
> 
> 时间：2021-12-30T08:30:49.223

Java 17 引入了该[`RandomGenerator`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/random/RandomGenerator.html)接口，该接口提供了[`int nextInt(int origin, int bound)`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/random/RandomGenerator.html#nextInt(int,int))一种获取范围内随机整数的方法：

```
// Returns a random int between minimum (inclusive) & maximum (exclusive)
int randomInt = RandomGenerator.getDefault().nextInt(minimum, maximum); 
```

除了用于 Java 17 中添加的新随机生成算法外，此接口还添加到现有的随机生成类（[`Random`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Random.html)、[`SecureRandom`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/security/SecureRandom.html)、[`SplittableRandom`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/SplittableRandom.html)和[`ThreadLocalRandom`](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/ThreadLocalRandom.html)）中。这意味着从 Java 17 开始，所有这些类都有这个有界`nextInt`方法：

```
new Random().nextInt(minimum, maximum);
new SecureRandom().nextInt(minimum, maximum);
new SplittableRandom().nextInt(minimum, maximum);
new ThreadLocalRandom().nextInt(minimum, maximum); 
```

此方法是Java 17 的新方法。自从它们分别在版本 7`Random`和8 中添加到 Java 以来就已经有了该方法，尽管在 Java 17 之前它不是共享接口的一部分。`SecureRandom``ThreadLocalRandom``SplittableRandom`

* * *

## 回答 #60

> 赞同：2
> 
> 时间：2014-05-24T23:21:12.753

您可以使用 Random 类生成随机数，然后使用 .nextInt(maxNumber) 生成随机数。maxNumber 是生成随机数时希望最大的数字。但请记住，Random 类为您提供数字 0 到 maxNumber-1。

```
Random r = new Random();
int i = r.nextInt(); 
```

另一种方法是使用 Math.Random() 类，学校中的许多课程都要求您使用它，因为它更有效并且您不必声明新的 Random 对象。要使用 Math.Random() 获取随机数，请输入：

```
Math.random() * (max - min) + min; 
```

* * *

## 回答 #61

> 赞同：2
> 
> 时间：2013-06-07T15:14:19.457

尝试使用`org.apache.commons.lang.RandomStringUtils`类。是的，它有时会给出相邻的重复数字，但它会给出 5 到 15 之间的值：

```
 while (true)
    {
        int abc = Integer.valueOf(RandomStringUtils.randomNumeric(1));
        int cd = Integer.valueOf(RandomStringUtils.randomNumeric(2));
        if ((cd-abc) >= 5 && (cd-abc) <= 15)
        {
            System.out.println(cd-abc);
            break;
        }
    } 
```

* * *

## 回答 #62

> 赞同：2
> 
> 时间：2015-10-29T20:46:13.020

[min..max] 范围内的随机数：

```
int randomFromMinToMaxInclusive = ThreadLocalRandom.current()
        .nextInt(min, max + 1); 
```

* * *

## 回答 #63

> 赞同：2
> 
> 时间：2016-11-28T22:33:31.230

上述大多数建议不考虑“溢出”，例如：min = Integer.MIN_VALUE, max = 100。到目前为止我的正确方法之一是：

```
final long mod = max- min + 1L;
final int next = (int) (Math.abs(rand.nextLong() % mod) + min); 
```

* * *

## 回答 #64

> 赞同：2
> 
> 时间：2017-12-01T23:01:47.353

[https://sourceforge.net/projects/stochunit/](https://sourceforge.net/projects/stochunit/)有一个库，用于处理范围的选择。

```
StochIntegerSelector randomIntegerSelector = new StochIntegerSelector();
randomIntegerSelector.setMin(-1);
randomIntegerSelector.setMax(1);
Integer selectInteger = randomIntegerSelector.selectInteger(); 
```

它具有边缘包含/排除。

* * *

## 回答 #65

> 赞同：2
> 
> 时间：2018-08-22T06:46:32.617

```
public static void main(String[] args) {

    Random ran = new Random();

    int min, max;
    Scanner sc = new Scanner(System.in);
    System.out.println("Enter min range:");
    min = sc.nextInt();
    System.out.println("Enter max range:");
    max = sc.nextInt();
    int num = ran.nextInt(min);
    int num1 = ran.nextInt(max);
    System.out.println("Random Number between given range is " + num1);

} 
```

* * *

## 回答 #66

> 赞同：1
> 
> 时间：2021-01-27T18:09:39.107

为了避免重复多次说过的话，我将通过使用扩展类的[SecureRandom](https://docs.oracle.com/javase/8/docs/api/java/security/SecureRandom.html)类为那些需要加密更强的伪随机数生成器的人展示一个替代方案`Random`。从[源代码](https://docs.oracle.com/javase/8/docs/api/java/security/SecureRandom.html)可以阅读：

> **此类提供了一个加密的强随机数生成器 (RNG)。**加密强随机数至少符合 FIPS 140-2，加密模块的安全要求，第 4.9.1 节中指定的统计随机数生成器测试。此外，SecureRandom 必须产生非确定性的输出。因此，传递给 SecureRandom 对象的任何种子材料都必须是不可预测的，并且所有 SecureRandom 输出序列必须具有加密强度，如 RFC 1750：安全随机性建议中所述。
> 
> 调用者通过无参数构造函数或 getInstance 方法之一获取 SecureRandom 实例：
> 
> ```
>  SecureRandom random = new SecureRandom(); 
> ```
> 
> 许多 SecureRandom 实现采用伪随机数生成器 (PRNG) 的形式，这意味着它们使用确定性算法从真正的随机种子生成伪随机序列。其他实现可能会产生真正的随机数，而其他实现可能会使用这两种技术的组合。

`min`要在 a和`max`values之间生成随机数：

```
public static int generate(SecureRandom secureRandom, int min, int max) {
        return min + secureRandom.nextInt((max - min) + 1);
} 
```

对于给定的 a `min`（包括）和`max`（不包括）值：

```
return min + secureRandom.nextInt((max - min)); 
```

运行代码示例：

```
public class Main {

    public static int generate(SecureRandom secureRandom, int min, int max) {
        return min + secureRandom.nextInt((max - min) + 1);
    }

    public static void main(String[] arg) {
        SecureRandom random = new SecureRandom();
        System.out.println(generate(random, 0, 2 ));
    }
} 
```

诸如[stackoverflow](https://stackoverflow.com/questions/11051205/difference-between-java-util-random-and-java-security-securerandom)、[baeldung](https://www.baeldung.com/java-secure-random)、[geeksforgeeks 之](https://www.geeksforgeeks.org/random-vs-secure-random-numbers-java/)`Random`类的源提供了和`SecureRandom`类之间的比较。

从[baeldung](https://www.baeldung.com/java-secure-random)可以读到：

> 使用 SecureRandom 的最常见方式是生成 int、long、float、double 或 boolean 值：
> 
> int randomInt = secureRandom.nextInt();
> long randomLong = secureRandom.nextLong();
> 浮动 randomFloat = secureRandom.nextFloat();
> 双 randomDouble = secureRandom.nextDouble();
> boolean randomBoolean = secureRandom.nextBoolean();
> 
> **为了生成 int 值，我们可以传递一个上限作为参数：**
> 
> int randomInt = secureRandom.nextInt(upperBound);
> 
> **此外，我们可以为 int、double 和 long 生成一个值流：**
> 
> IntStream randomIntStream = secureRandom.ints();
> LongStream randomLongStream = secureRandom.longs();
> DoubleStream randomDoubleStream = secureRandom.doubles();
> 
> **对于所有流，我们可以显式设置流大小：**
> 
> IntStream intStream = secureRandom.ints(streamSize);

此类提供了超出此问题范围的其他几个选项（*例如，选择基础随机数生成器）。*

* * *

## 回答 #67

> 赞同：0
> 
> 时间：2017-10-04T14:18:05.930

一种在 a 和 b 之间生成 n 个随机数的简单方法，例如 a =90, b=100, n =20

```
Random r = new Random();
for(int i =0; i<20; i++){
    System.out.println(r.ints(90, 100).iterator().nextInt());
} 
```

`r.ints()`返回一个`IntStream`并有几个有用的方法，看看它的[API](https://docs.oracle.com/javase/8/docs/api/java/util/stream/IntStream.html)。

* * *

## 回答 #68

> 赞同：0
> 
> 时间：2017-04-26T12:30:14.847

使用 Java 8 流，

*   传递 initialCapacity - 多少个数字
*   传递 randomBound - 从 x 到 randomBound
*   传递 true/false 是否已排序
*   传递一个新的 Random() 对象

```
public static List<Integer> generateNumbers(int initialCapacity, int randomBound, Boolean sorted, Random random) {

    List<Integer> numbers = random.ints(initialCapacity, 1, randomBound).boxed().collect(Collectors.toList());

    if (sorted)
        numbers.sort(null);

    return numbers;
} 
```

在此示例中，它从 1-Randombound 生成数字。

* * *

## 回答 #69

> 赞同：0
> 
> 时间：2019-07-06T09:02:40.907

*这是一个函数，它根据user42155*的要求，在*`lowerBoundIncluded` *and* *定义的范围内准确返回一个整数随机数*`upperBoundIncluded`*

 **`SplittableRandom splittableRandom = new SplittableRandom();`

```
BiFunction<Integer,Integer,Integer> randomInt = (lowerBoundIncluded, upperBoundIncluded)
    -> splittableRandom.nextInt( lowerBoundIncluded, upperBoundIncluded + 1 ); 
```

`randomInt.apply( …, … ); // gets the random number`

*…或更短的随机数的一次性生成*

```
new SplittableRandom().nextInt( lowerBoundIncluded, upperBoundIncluded + 1 ); 
```

* * *

## 回答 #70

> 赞同：-4
> 
> 时间：2019-12-16T10:56:17.680

以下代码段将给出 0 到 10000 之间的随机值：

```
import java.util.Random;
public class Main
{
    public static void main(String[] args) {
        Random rand = new Random();
        System.out.printf("%04d%n", rand.nextInt(10000));
    }
} 
```

* * *

## 回答 #71

> 赞同：-4
> 
> 时间：2019-01-01T09:39:04.087

您可以执行以下操作。

```
import java.util.Random;
public class RandomTestClass {

    public static void main(String[] args) {
        Random r = new Random();
        int max, min;
        Scanner scanner = new Scanner(System.in);
        System.out.println("Enter maximum value : ");
        max = scanner.nextInt();
        System.out.println("Enter minimum value : ");
        min = scanner.nextInt();
        int randomNum;
        randomNum = r.nextInt(max) + min;
        System.out.println("Random Number : " + randomNum);
    }

} 
```

# web-services - 如何从 WCF Web 服务访问 Application[] 集合

> ID：363682
> 
> 赞同：1
> 
> 时间：2008-12-12T18:21:27.957
> 
> 标签：web-services, wcf, application-state

我曾经使用 .ASMX Web 服务，但我正在尝试迁移到 WCF，因为它是最新的东西，而且应该会更好。

无论如何，我想要做的非常简单：创建一个通过调用 Application.Clear() 清空 Application 集合的 Web 服务。在 ASMX Web 服务中，这真的很简单，因为 .ASMX Web 服务可以完全访问 Application[] 集合。但是，这在 WCF 中实际上并不适用。

所以，这是我的服务合同：

```
[ServiceContract]
public interface IFlusherServicePage
{
    [OperationContract]
    void FlushApplicationCache();
} 
```

这是我的实现类：

```
public class FlusherServicePage : Page, IFlusherServicePage
{
    public void FlushApplicationCache()
    {
        Application.Clear();
    }
} 
```

这是我的 .svc 文件：

```
<%@ ServiceHost Language="C#" Debug="true" Service="FlusherServicePage" CodeBehind="~/App_Code/FlusherServicePage.cs" %> 
```

一切都编译得很好。但是，当我调用我的 web 服务时，FlushApplicationCache() 会抛出 NullReferenceException，因为 Application[] 为空。

有什么方法可以从 WCF 网络服务访问 Application[] 集合？还是我需要回到 .ASMX？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-16T14:15:18.573

尽管 WCF 可以在与 ASP.Net 相同的 AppDomain 中运行，但它不会通过完整的 ASP.Net 管道。因此，未设置 HttpContext，您无法访问应用程序。WCF 服务已从 ASP.Net 中分离出来，以便托管在 Server 2008 的 WAS 中。

# java - 两个 IDE 有不同的结果

> ID：363704
> 
> 赞同：0
> 
> 时间：2008-12-12T18:28:13.200
> 
> 标签：java, eclipse, intellij-idea, easymock

我和我的同事在做同一个项目，但我们使用不同的 IDE。他使用 Eclipse 3.4，我使用 IntelliJ 8.0。

最近我提倡使用使用CGLIB的EasyMock来对我们的项目进行一些单元测试。我没有看到在 IntelliJ 中对 EasyMock 生成的部分模拟对象设置断点有任何问题，但我的同事报告说他无法在 Eclipse 中对 EasyMock 生成的部分模拟对象设置断点，因为它报告行号信息不存在生成的类。

在绝望地在谷歌上搜索答案后，我希望我的朋友们能给出关于 SO 的提示。

1.  关于为什么 IntelliJ 工作而 Eclipse 在这种情况下不工作的任何想法？
2.  任何可能解决此问题的 Eclipse 配置线索？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T10:46:16.967

简单的模拟对象是由一些 ant 脚本创建的吗？在这种情况下，eclipse中的设置与生成的调试行信息无关然后有必要检查ant设置以查看是否存在一些差异

# c# - C#，运算符'*'不能应用于'double'和'decimal'类型的操作数

> ID：363706
> 
> 赞同：11
> 
> 时间：2008-12-12T18:28:25.213
> 
> 标签：c#, decimal, multiplication

这个错误应该是一个简单的错误，但我似乎无法让它工作。问题在于这个相同的代码在程序的早期工作。我看不出它有什么理由在这个实例上发送一个错误，而不是之前的四个。参考下面的代码，并随时提供您可能有的任何批评，因为它应该让我变得更好。如果重要的话，我正在使用 Sharp Develop 2.2。

这是一个有效的代码示例：

```
void calc2Click(object sender, EventArgs e)
{
    if (!String.IsNullOrEmpty(tb2_fla.Text) & String.IsNullOrEmpty(tb2_e.Text) | String.IsNullOrEmpty(tb2_fla.Text) & String.IsNullOrEmpty(tb2_e.Text) | String.IsNullOrEmpty(tb2_e.Text))
    {
        MessageBox.Show("Enter either kVA and Voltage or FLA and Voltage", "Invalid Data Entry", MessageBoxButtons.OK);
    }       

        if (!String.IsNullOrEmpty(tb2_kva.Text) & !String.IsNullOrEmpty(tb2_e.Text))
    { 
            decimal x, y, z;
            x = decimal.Parse(tb2_kva.Text);      
            y = decimal.Parse(tb2_e.Text);
            z = (x * 1000) / (1.732050808m * y); //the m at the end of the decimal allows for the multiplication of decimals    
            tb2_fla.Text = z.ToString();
            tb2_fla.Text = Math.Round(z,2).ToString();
    }
        else
    {
        if (!String.IsNullOrEmpty(tb2_fla.Text) & !String.IsNullOrEmpty(tb2_e.Text))
    { 
            decimal x, y, z;
            x = decimal.Parse(tb2_fla.Text);      
            y = decimal.Parse(tb2_e.Text);
            z = (x * y * 1.732050808m) / 1000; //the m at the end of the decimal allows for the multiplication of decimals  
            tb2_kva.Text = Math.Round(z,2).ToString();

    } 
```

这是在这篇文章的主题行中发送错误的代码示例：

```
void Calc4Click(object sender, EventArgs e)
{
        if (!String.IsNullOrEmpty(tb4_fla.Text) && String.IsNullOrEmpty(tb4_e.Text) || String.IsNullOrEmpty(tb4_kw.Text) & String.IsNullOrEmpty(tb4_e.Text) || String.IsNullOrEmpty(tb4_e.Text))
        {   //If values are entered improperly, the following message box will appear
        MessageBox.Show("Enter either FLA and Voltage or kW and Voltage", "Invalid Data Entry", MessageBoxButtons.OK);
        }   

        if (!String.IsNullOrEmpty(tb4_fla.Text)&& !String.IsNullOrEmpty(tb4_e.Text)&& String.IsNullOrEmpty(tb4_kw.Text))
        {//If the user eneters FLA and Voltage calculate for kW

            decimal x, y, z;
            x = decimal.Parse(tb4_fla.Text);
            y = decimal.Parse(tb4_e.Text);
            z = (x*y)*(.8 * 1.732050808m);
            tb4_kw.Text = Math.Round(z,0).ToString();

        }               

        if (!String.IsNullOrEmpty(tb4_kw.Text) && !String.IsNullOrEmpty(tb4_e.Text) && String.IsNullOrEmpty(tb4_fla.Text))
        {;//If the user enters kW and Voltage calculate for FLA
            decimal x, y, z;
            x = decimal.Parse(tb4_kw.Text);
            y = decimal.Parse(tb4_e.Text);
            z = (1000 * x)/(y * 1.732050808m)* .8;
            tb4_fla.Text = Math.Round(z,0).ToString();
        }

    } 
```

我很感激我能得到的任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-12-12T18:31:28.310

```
.8m instead of .8 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T18:32:55.470

你没有说它是哪条线，但我打赌这两条：

```
z = (x*y)*(.8 * 1.732050808m); 
```

和：

```
z = (1000 * x)/(y * 1.732050808m)* .8; 
```

请注意，您的 .8 没有“m”限定符。我看到你的其他地方都提供了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T18:32:11.587

在此行中：

z = (x *y)* (.8 * 1.732050808m);

您将 .8 指定为文字，但没有“m”后缀，文字指定双精度。

z = (x *y)* (.8m * 1.732050808m);

会修复它。

# delphi - 是否存在按 ItemIndex 的启用数据的单选组组件？

> ID：363712
> 
> 赞同：1
> 
> 时间：2008-12-12T18:31:27.173
> 
> 标签：delphi, data-aware, radio-group

我正在用启用数据的版本替换我的一个表单中的几个组件，当我的新 TDBRadioGroup 没有与分配给它的数字字段链接时，这有点令人惊讶。事实证明，TDDBRadioGroup 的“值”不是通过 ItemIndex 属性存储在您必须手动填充的 TStrings 中。我可以理解这在某些情况下会很有用，但是当它只是链接到数字字段时，必须执行以下操作：

```
 for i := 0 to myRadioGroup.Items.Count - 1 do
      myRadioGroup.Values.Add(intToStr(i)); 
```

有点矫枉过正。有谁知道将使用 ItemIndex 作为其值参数的启用数据的无线电组组件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T20:40:10.237

您可以专门化一个 TDBRadioGroup 并按索引添加值，我建议您覆盖事件过程 Loaded；覆盖；

```
procedure TMyDBRadioGroup.Loaded; override;

var
  I: Integer;

begin
  inherited;
  Values.Clear;
  for i := 0 toItems.Count - 1 do
    Values.Add(intToStr(i));
end; 
```

# jquery - 如何使用 jquery 滑动打开内容

> ID：363718
> 
> 赞同：6
> 
> 时间：2008-12-12T18:32:49.447
> 
> 标签：jquery, css, animation

我的设计师递给我一个我不是 100% 确定如何使用 jquery 和 css 的设计。我基本上是在尝试让用户向上“滑动”页脚以显示更多内容。

我的..

```
 <div id="footer">
     <div id="expandingFooter"> hidden content</div>
        content that is always visible
 </div> 
```

我有一个 onclick 的切换按钮

```
$('#expandingFooter').slideToggle(); 
```

这会将展开的页脚内容向下滑动打开，然后向上滑动以关闭。我希望它向上滑动然后关闭。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-12T19:07:52.200

您可以利用 JQuery UI 1.6 的效果（[效果演示页面](http://ui.jquery.com/repository/real-world/effects/)）。以下为我完成了预期的效果。

```
$('#toggleButton').bind('click', function(e) {
    $('#expandingFooter').toggle(
        'slide', 
        { easing: 'easeOutQuint', direction: 'down' }, 
        1000
    );
}); 
```

注意：您可能需要使用 easing 参数来获得所需的平滑度。

您需要拥有最新版本的[JQuery](http://docs.jquery.com/Downloading_jQuery)和[JQuery UI 幻灯片效果](http://ui.jquery.com/download_builder/)才能执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T18:45:21.200

尝试这样的事情：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <title>Untitled</title>
    <script type="text/javascript" src="shared-scripts/jquery-1.2.4b.js"></script>
    <script type="text/javascript">
    <!--
  $(document).ready(function(){
    $("#footer").click(function () {
      if ($("#expandingFooter").is(":hidden")) {
        $("#expandingFooter").show("slow");
      } else {
        $("#expandingFooter").slideUp();
      }
    });
    $("#expandingFooter").hide();
  });
    //--></script>

</head>

<body>
 <div id="footer">
     <div id="expandingFooter"> hidden content</div>
        content that is always visible
 </div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T18:51:53.700

我的解决方案有点小技巧。您想要的 slideUp() 函数不是在 JQuery 中构建的，因为您可以实现它的方式取决于您的 html/css 设计。正常流动是从上到下。

我建议这样做：

```
<a id="toggle">Toggle()</a>

<div id="slide" style="position:relative; height: 100px">

    <div id="slideInner" style="position:absolute; bottom: 0; background: lightblue"">
        <p>Suspendisse potenti. Vivamus libero. Dummy Text</p>
    </div>

</div>

<script type="text/javascript">
    $('.hoverable').hover( function() { $(this).find("div").show(); },
                       function() { $(this).find("div").hide(); } );

    $('#toggle').click(function () {
        $('#slideInner').slideToggle();
    });
</script> 
```

此代码只是一个示例。将内联 css 移动到外部工作表。javascript 的同上。

如果您希望“幻灯片”div 消失，请向 slideToggle() 函数添加一个回调，在“幻灯片”div 上调用 hide()。

# sql-server-2008 - 我应该在哪里存储 SSIS 数据？

> ID：363720
> 
> 赞同：1
> 
> 时间：2008-12-12T18:33:03.580
> 
> 标签：sql-server-2008, ssis

我在 SSIS Dataa Flow 任务中有一个缓慢的自定义数据源。我必须使用多个参数运行包

如果我想使用 SQL 数据目标（批量插入）将数据上传到数据库，则连接超时

如果我将数据写入平面文件，我将无法运行包的多个实例，因为它们将写入同一个文件。我可以将文件名作为参数传递到某处吗？

我是否需要编写自定义脚本目标作为最后的手段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T18:45:43.570

原始文件目标允许您将文件名存储在包变量中。然后，您可以使用 dtexec 的 /Set 或 /Conf 命令行开关在命令行上设置变量，或者为该包的运行引入配置文件。原始文件不适合手动处理，但如果您的数据流以一个结束，那么下一个数据流会拾取它并与它一起运行，这很容易处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T18:46:38.390

您可以使用包变量作为文件名。然后，您必须确定如何检索数据。如果您有一个包含要使用的文件名的临时表，那么您可以在运行包之前在作业步骤中设置其值。然后包可以读取该值。需要其他文件吗？没问题，只需更新表并再次运行包的另一个步骤。或者，您也可以设置包，以便它迭代表中的所有值。

# asp.net - 如何持久化列表 ASP.NET 自定义控件中的属性？

> ID：363725
> 
> 赞同：6
> 
> 时间：2008-12-12T18:33:31.100
> 
> 标签：asp.net, viewstate, custom-server-controls

我在自定义控件中有以下属性：

```
List<myClass> _items;
public List<myClass> Items{
    get { return _items; }
    set { _items= value; }
} 
```

在我的代码隐藏中，我将项目添加到集合中，如...

```
myCustomControl.items.Add(new myClass()); 
```

但是，这些不会在回发中保留。允许自定义控件持久性的正确方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-10T17:12:55.567

哎呀！不要将 List<> 放入 ViewState！这将是巨大的！

如果将包含两个元素“abc”和“xyz”的 List<string> 添加到 ViewState 中，它将增加 312 个字节。

相反，如果您添加一个包含相同两个元素的 string[]，它只会增长 24 个字节。

那只是字符串列表！您可以按照 Corey Downie 的建议将您的课程放在那里，但您的 ViewState 会迅速增长！

为了保持合理的大小，您必须努力将项目列表转换为字符串数组，然后再转换回来。

作为替代方案，考虑将您的对象放入 Session：这样您的对象将存储在服务器上，而不是被序列化为 ViewState 并发送到浏览器并返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-19T17:18:41.890

克服泛型列表大小问题的一种方法是将其作为基本数组类型保存在 ViewState 中：

```
protected List<string> Items 
{ 
    get 
    { 
        if (ViewState["Items"] == null)
            ViewState["Items"] = new string[0];
        return new List<string>((string[])ViewState["Items"]);
    }
    set
    {
        ViewState["Items"] = value.ToArray();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T19:27:23.550

如果您正在谈论在同一页面的回发中保留数据，那么您可以手动将项目添加到 ViewState 并在加载时检索它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-15T23:35:59.023

我同意视图状态中的 List<> 存在问题，但它确实有效。请注意，设计上没有设置器。您需要对列表对象对象的引用，并且您的 get 方法可以在需要时新建一个列表。

```
protected List<myClass> Items
{
    get
    {
        if (ViewState["myClass"] == null)
            ViewState["myClass"] = new List<myClass>();

        return (List<myClass>)ViewState["myClass"];
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T22:12:48.167

您可以将它们存储在控件视图状态中

```
public List<myClass> Items{
    get { return this.ViewState["itemsKey"] }
    set { this.ViewState["itemsKey"]= value; }
} 
```

# apache-flex - Flex html-template 和输出文件夹结构的官方说明在哪里可以找到？

> ID：363726
> 
> 赞同：2
> 
> 时间：2008-12-12T18:33:46.230
> 
> 标签：apache-flex, templates, air, flexbuilder

我正在寻找一个官方的 Adob​​e 页面来解释 Flex Builder 中使用的各种目录的来龙去脉，即*html-template、bin-debug*和*bin-release*。

这些文件夹中发生了很多事情：创建和删除文件夹，自动复制文件，或者不自动复制，AIR 应用程序似乎就是这种情况。我正在寻找有关控制此行为的设置、文件夹结构的记录意图等的具体信息。简而言之，我试图了解 Flex 工作流程的一部分，它似乎以不可预测且完全未记录的方式工作。

我不是在组织项目资产方面寻求帮助，我对半自动输出文件夹如何工作以及如何影响它们的配置更加好奇。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T18:50:30.677

我敢说你不会找到这个官方文档，因为 Adob​​e 认为这是他们的业务——从字面上看。请阅读 2008 年 12 月的这篇文章“<a href="http://www.adobe.com/devnet/flex/articles/best_practices_pt2.html" rel="nofollow noreferrer">Flex 最佳实践 - 第 2 部分：开发实践”；在“<a href="http://www.adobe.com/devnet/flex/articles/best_practices_pt2_02.html" rel="nofollow noreferrer">Handling Assets”部分中，您将看到一个文件夹结构的建议，看起来非常接近我认为你正在寻找的东西......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-24T18:34:14.893

此链接可能对您有用。 [http://livedocs.adobe.com/flex/3/html/wrapper_01.html](http://livedocs.adobe.com/flex/3/html/wrapper_01.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-16T00:09:41.010

我会在官方文档中查看这些页面：

[Flex 应用程序结构](http://livedocs.adobe.com/flex/3/html/apparch_01.html)、 [构建概述](http://livedocs.adobe.com/flex/3/html/building_overview_1.html)和 [应用程序部署](http://livedocs.adobe.com/flex/3/html/help.html?content=modular_5.html)

简短的，我头脑中的答案是：

*   *html-template*的名称恰如其分，它存储了实际 Flash 对象的 HTML“包装器”或“容器”。如果您需要围绕您的 Flash/Flex 应用程序进行“标准”HTML/Javascript 设计/交互，您可以 在*html-template中修改**index.template.html*并将外部 CSS、JS 等添加到该文件夹​​中。
**   *bin-debug*是为调试目的而编译的应用程序版本。因此，它会获取*html-template*中的所有内容并将其复制到*bin-debug*，同时编译构成您的应用程序的所有 SWF。*   *bin-release与**bin-debug*非常相似，但通过 Flex Builder 发布过程填充，并提供额外的选项，如“查看源代码”。实际上，我之前只是直接从*bin-debug*复制到演示服务器而没有遇到任何问题，但我确信这对于实际部署来说是个坏主意。*

 *我要补充的唯一另一件事是，Flex Builder 会尝试尽快创建调试版本，因此它只会复制或编译它认为已更改的文件……有时它会遗漏一些。Project->Clean... 将强制将所有文件重新复制/编译到*bin-debug*中。

# c# - 有没有一种简单的方法来确定 C# 中的类型大小？

> ID：363729
> 
> 赞同：7
> 
> 时间：2008-12-12T18:34:12.457
> 
> 标签：c#

有没有办法说这样的话：

大小（类型）？还是 type.Size？

现在我正在考虑使用如下代码：

```
if (type.Equals(typeof(int)))
    return sizeof(int);
else if (type.Equals(typeof(long)))
    return sizeof(long); 
```

等等，等等，对于每一种数据类型。

必须有一个更清洁的解决方案，不是吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-12T18:36:16.833

试试 Marshal.SizeOf()

[http://msdn.microsoft.com/en-us/library/5s4920fa.aspx](http://msdn.microsoft.com/en-us/library/5s4920fa.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T18:39:05.910

如果这是用于数据访问，您可以执行 type.GetTypeCode() （它是 IConvertible 的成员），它为您提供了一个很好的枚举来打开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T19:01:03.710

看看这些问题：

*   [使用 C# 获取字段的大小（以字节为单位）](https://stackoverflow.com/questions/207592/getting-the-size-of-a-field-in-bytes-with-c#207601)
*   [如何获取 HttpRuntime.Cache 中对象的大小？](https://stackoverflow.com/questions/326606/how-can-i-get-the-size-of-an-object-in-the-httpruntimecache#326695)
*   [找出 .net 对象的大小](https://stackoverflow.com/questions/324053/find-out-the-size-of-a-net-object#324063)

特别是，请阅读[Jon Skeet](https://stackoverflow.com/users/22656/jon-skeet)留下的答案。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2010-04-16T10:02:18.717

也许你可以去 `Convert.ToString(type.MaxValue, 2).Length / 8` ？

# c# - ASP.NET 中请求或服务器独有的静态类实例？

> ID：363730
> 
> 赞同：4
> 
> 时间：2008-12-12T18:35:29.193
> 
> 标签：c#, asp.net

```
 public sealed class UserLoginSingleton
{

     UserLoginCollection _userLoginCol = new UserLoginCollection();

    UserLoginSingleton()
    {
    }

    public static UserLoginSingleton Instance
    {
        get
        {
            IDictionary items = HttpContext.Current.Items;
            if (!items.Contains("TheInstance"))
            {
                items["TheInstance"] = new UserLoginSingleton();

            }
            return items["TheInstance"] as UserLoginSingleton;
        }
    }

    public void CreateUserObj(string xmlData)
    {
        _userLoginCol = (UserLoginCollection)_xmlUtil.Deserialize(xmlData, typeof(UserLoginCollection));
    }

    public UserLoginCollection getUserObj()
    {
        return _userLoginCol;
    }
} 
```

用法：

第 1 页.aspx

```
UserLoginSingleton.Instance.CreateUserObj(xml); 
```

Pase2.aspx：

> UserLoginCollection userLoginCollection = UserLoginSingleton.Instance.getUserObj();

在此处关注文章： [链接文本](https://stackoverflow.com/questions/194999/are-static-class-instances-unique-to-a-request-or-a-server-in-aspnet)

我在第 1 页中设置了我的集合对象，然后执行 response.redirect 或单击链接以将我转到第 2.aspx 页。但是，我的单例实例没有我设置的集合对象。如何在每个会话的不同页面中保留我的集合对象？

我知道静态不会起作用，因为每个实例都会看到该对象，并且我希望每个用户都有特定的对象。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T18:46:31.277

该`HttpContext.Items`集合是按请求进行的。因此，在您的情况下，当用户被重定向到 page2.aspx 时，您在第 1 页上创建的实例就消失了。要使同一实例在请求中可用，您需要使用`HttpContext.Session`来存储您的实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-13T19:19:40.910

使用读取 HttpSession 而不是静态变量的静态方法：

```
 public class UserLoginController
{
    public static UserLoginController Instance
    {
        get
        {
            HttpSession session = HttpContext.Current.Session;
            if (session["UserLoginController"] == null)
            {
                session["UserLoginController"] = new UserLoginController();
            }
            return session["UserLoginController"] as UserLoginController;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T19:46:36.490

也许我需要重新考虑我想做什么。基本上，我的集合是围绕下拉列表的不同值的集合。这是由客户端提供的，我的网页需要显示它。

我想客户端可以将它作为序列化数据发送给我，我给了他们 xsd，他们会在登录时异步发送给我。第 1 页将接收序列化数据。登录页面将使他们登录。一旦 page1 收到数据，将反序列化为我的强类型集合，该集合又将用于在 page2.aspx 中构建下拉列表

为什么我要以如此原始的方式来做。我的双手受到限制，如果可以避免的话，我会尽量不使用会话状态来持有这个对象。

每个用户登录都带有下拉列表的各种选项。用户 1 可以有 10 个选项，用户 2 可以有 200 个选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T18:59:28.537

静态字段在请求之间共享。注意标准的多线程问题！

HttpContext 实例不在请求之间共享。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T20:25:17.380

只是指出你的单例实现是错误的，你的单例应该这样声明

```
public sealed class Singleton
{
    static readonly Singleton instance=new Singleton();

    // Explicit static constructor to tell C# compiler
    // not to mark type as beforefieldinit
    static Singleton()
    {
    }

    Singleton()
    {
    }

    public static Singleton Instance
    {
        get
        {
            return instance;
        }
    }
} 
```

# unit-testing - 让 PartCover 工作

> ID：363740
> 
> 赞同：23
> 
> 时间：2008-12-12T18:37:58.673
> 
> 标签：unit-testing, mstest, code-coverage, partcover

我想尝试 PartCover 的代码覆盖率。我正在使用 MSTest 运行 Visual Studio 2008 Professional。专业版不包括团队测试工具，如代码覆盖率。

所以，我正在尝试 PartCover，但我无法让它工作。在 PartCover.Browser 中，我选择了 MSTest 可执行文件，将工作参数指向了我的 tests.dll，并尝试将工作目录指向 TestResults 文件夹，但出现错误：

“报告为空。检查设置并再次运行目标。”

我不知道下一步该尝试什么。

**编辑**

事实证明我有两个问题。首先，我的规则不正确。其次，我的工作论证中有空格。空格出现错误，但没有出现在任何地方。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-12T18:50:01.863

是的，我也有这个问题。查看规则字段的格式。

在浏览器中添加如下内容：

`+[MyNamespace.MyAssemblyName]*`

您指定的程序集名称是包含您想要覆盖的类型的程序集的名称。开始：

`+[*]*`

并且 partcover 很乐意为您提供单元测试项目的覆盖率指标，您引用的任何库等等。

在命令行中，您在 --include 参数中指定相同的模式： `--include=[MyNamespace.MyAssembly]*`

您还可以排除包含的命名空间或类型，或限制命名空间内您在报告中获取覆盖率数据的类型。根据手册，规则的格式是正则表达式语法的子集（由 asterix 作为通配符和组成程序集和类名的字符组成，非常有限，但足以获得所需的数据）。查看手册中有关规则的部分。如果您没有手册，请[从 sourceforge 下载](http://sourceforge.net/forum/forum.php?forum_id=611572)。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-12-14T17:05:50.127

当从 NAnt 脚本调用 PartCover 时，我必须经过许多步骤才能最终让 PartCover 正常工作。为了方便他人，我收集了我必须在这里做的一切；请注意，其中一些已经被其他人回答了，但我花了很多时间把它们放在一起。

首先，正如此处其他地方所回答的那样，如果您的操作系统是 64 位，则需要运行 [最新的 Windows SDK]\bin\CorFlags.exe [PartCover install dir]\PartCover.exe /32BIT+ /Force

这是 PartCover 安装后的一次性步骤。它将更改可执行文件，并警告您需要重新签署程序集，但我没有这样做，它（最终）工作正常。请注意，尽管 CorFlags 看起来没有按照您的要求执行并警告您有关签名，但它确实更改了 .exe，只是没有明确指出这一点。

接下来，如果您的操作系统是 64 位，并且您使用 NUnit（或其他测试 exe）和 PartCover，您将需要调用为 x86 显式编译的版本。在 NUnit 的情况下，这将是 nunit-console-x86.exe。调用 nunit-console.exe 只会在完成工作后无限期地挂起，而不是返回提示。

接下来，正如此处其他地方所回答的那样，开发版本 PartCover 2.3 即使在其上运行了 CorFlags 后也默默地失败了。但是，2.2 起作用了。

接下来，当调用 PartCover.exe 时，参数的语法是 --arg-name ... 而不是 --=arg-name（即破折号空格 arg 名称，而不是破折号等于 arg 名称）；PartCover 文档似乎是双向的，但等号对我不起作用。

在上述之后，PartCover 终于可以从命令行工作了。我使用了一个设置文件（您可以使用 PartCover 浏览器 UI 应用程序保存一个设置文件，然后您可以从命令行使用），因此我指定的唯一参数是设置文件完整路径和输出报告文件命名完整路径。

当从 NAnt 脚本调用时，这仍然不起作用，所以我终于意识到必须引用 arg 值......并使用 HTML 编码的标记作为引号。因此...

**摘录：**

```
<property name="PartCoverExePath" value="c:\Program Files (x86)\PartCover .NET 2\PartCover.exe" />
<property name="PartCoverWorkPath" value="c:\Projects\MyProject\trunk\CI\" />
<property name="PartCoverSettingsFileName" value="PartCover.Settings.xml" />
<property name="PartCoverReportFileName" value="PartCover.Report.xml" />

<target name="MyTarget">
<exec program="${PartCoverExePath}">
<arg value="--settings &quot;${PartCoverWorkPath}${PartCoverSettingsFileName}&quot;" />
<arg value="--output &quot;${PartCoverWorkPath}${PartCoverReportFileName}&quot;" />
</exec>
</target> 
```

**PartCover 设置文件：**

```
<PartCoverSettings>
<Target>C:\CI\Binaries\NUnit2.5.2\bin\net-2.0\nunit-console-x86.exe</Target>
<TargetWorkDir>c:\Projects\MyProject\trunk\MyProject.Test\bin\Debug</TargetWorkDir>
<TargetArgs>MyProject.Test.dll</TargetArgs>
<Rule>+[*]*</Rule>
<Rule>-[log4net*]*</Rule>
<Rule>-[nunit*]*</Rule>
<Rule>-[MyProject.Test*]*</Rule>
</PartCoverSettings> 
```

呸！希望这可以避免其他人让我头疼。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-01-20T07:50:47.010

PartCover 报告也有同样的问题。所以我一直在努力让它正常工作，我发现问题出在 PartCover 发行版附带的两个 XSLT 文件上。

我修复了这些文件，现在一切对我来说都很好：

## *大会报告*

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxml="urn:schemas-microsoft-com:xslt">
  <xsl:output method="html" indent="yes"/>
    <xsl:template match="/">

    <xsl:variable name="cov0style" select="'background:#E79090;text-align:right;'"/>
    <xsl:variable name="cov20style" select="'background:#D79797;text-align:right;'"/>
    <xsl:variable name="cov40style" select="'background:#D7A0A0;text-align:right;'"/>
    <xsl:variable name="cov60style" select="'background:#C7A7A7;text-align:right;'"/>
    <xsl:variable name="cov80style" select="'background:#C0B0B0;text-align:right;'"/>
    <xsl:variable name="cov100style" select="'background:#D7D7D7;text-align:right;'"/>

<table style="border-collapse: collapse;">
  <tr style="font-weight:bold; background:whitesmoke;">
    <td colspan="2">Coverage by assembly</td>
  </tr>

  <xsl:variable name="asms" select="/PartCoverReport/Assembly"/>
  <xsl:for-each select="$asms">
    <xsl:variable name="current-asm-node" select="."/>
    <tr>

      <xsl:element name="td">
        <xsl:attribute name="style">background:ghostwhite; padding: 5px  30px 5px  5px;</xsl:attribute>
        <xsl:value-of select="$current-asm-node/@name"/>
      </xsl:element>

      <xsl:variable name="codeSize" select="sum(/PartCoverReport/Type[@asmref=$current-asm-node/@id]/Method/pt/@len)+0"/>
      <xsl:variable name="coveredCodeSize" select="sum(/PartCoverReport/Type[@asmref=$current-asm-node/@id]/Method/pt[@visit>0]/@len)+0"/>

      <xsl:element name="td">
        <xsl:if test="$codeSize=0">
          <xsl:attribute name="style">
            <xsl:value-of select="$cov0style"/>
          </xsl:attribute>
          0%
        </xsl:if>
        <xsl:if test="$codeSize &gt; 0">
          <xsl:variable name="coverage" select="ceiling(100 * $coveredCodeSize div $codeSize)"/>
          <xsl:if test="$coverage &gt;=  0 and $coverage &lt; 20">
            <xsl:attribute name="style">
              <xsl:value-of select="$cov20style"/>
            </xsl:attribute>
          </xsl:if>
          <xsl:if test="$coverage &gt;= 20 and $coverage &lt; 40">
            <xsl:attribute name="style">
              <xsl:value-of select="$cov40style"/>
            </xsl:attribute>
          </xsl:if>
          <xsl:if test="$coverage &gt;= 40 and $coverage &lt; 60">
            <xsl:attribute name="style">
              <xsl:value-of select="$cov60style"/>
            </xsl:attribute>
          </xsl:if>
          <xsl:if test="$coverage &gt;= 60 and $coverage &lt; 80">
            <xsl:attribute name="style">
              <xsl:value-of select="$cov80style"/>
            </xsl:attribute>
          </xsl:if>
          <xsl:if test="$coverage &gt;= 80">
            <xsl:attribute name="style">
              <xsl:value-of select="$cov100style"/>
            </xsl:attribute>
          </xsl:if>
          <xsl:value-of select="$coverage"/>%
        </xsl:if>
      </xsl:element>
    </tr>
  </xsl:for-each>
</table> 
```

## *按班级报告*

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxml="urn:schemas-microsoft-com:xslt">
<xsl:output method="html" indent="no"/>

<xsl:template match="/">

<xsl:variable name="cov0style" select="'background:#FF4040;text-align:right;'"/>
<xsl:variable name="cov20style" select="'background:#F06060;text-align:right;'"/>
<xsl:variable name="cov40style" select="'background:#E78080;text-align:right;'"/>
<xsl:variable name="cov60style" select="'background:#E0A0A0;text-align:right;'"/>
<xsl:variable name="cov80style" select="'background:#D7B0B0;text-align:right;'"/>
<xsl:variable name="cov100style" select="'background:#E0E0E0;text-align:right;'"/>

<table style="border-collapse: collapse;">
    <tr style="font-weight:bold; background:whitesmoke;"><td colspan="2">Coverage by class</td></tr>

    <xsl:for-each select="/PartCoverReport/Type">
        <tr>

            <xsl:element name="td">
                <xsl:attribute name="style">background:ghostwhite; padding: 5px  30px 5px  5px;</xsl:attribute>
                <xsl:value-of select="@name"/>
            </xsl:element>

            <xsl:variable name="codeSize" select="sum(./Method/pt/@len)+0"/>
            <xsl:variable name="coveredCodeSize" select="sum(./Method/pt[@visit>0]/@len)+0"/>

            <xsl:element name="td">
                <xsl:if test="$codeSize=0">
                    <xsl:attribute name="style"><xsl:value-of select="$cov0style"/></xsl:attribute>
                    0%
                </xsl:if>

                <xsl:if test="$codeSize &gt; 0">
                    <xsl:variable name="coverage" select="ceiling(100 * $coveredCodeSize div $codeSize)"/>

                    <xsl:if test="$coverage &gt;=  0 and $coverage &lt; 20"><xsl:attribute name="style"><xsl:value-of select="$cov20style"/></xsl:attribute></xsl:if>
                    <xsl:if test="$coverage &gt;= 20 and $coverage &lt; 40"><xsl:attribute name="style"><xsl:value-of select="$cov40style"/></xsl:attribute></xsl:if>
                    <xsl:if test="$coverage &gt;= 40 and $coverage &lt; 60"><xsl:attribute name="style"><xsl:value-of select="$cov60style"/></xsl:attribute></xsl:if>
                    <xsl:if test="$coverage &gt;= 60 and $coverage &lt; 80"><xsl:attribute name="style"><xsl:value-of select="$cov80style"/></xsl:attribute></xsl:if>
                    <xsl:if test="$coverage &gt;= 80"><xsl:attribute name="style"><xsl:value-of select="$cov100style"/></xsl:attribute></xsl:if>
                    <xsl:value-of select="$coverage"/>%
                </xsl:if>

            </xsl:element>
        </tr>
    </xsl:for-each>
</table>    
</xsl:template>
</xsl:stylesheet> 
```

希望这个对你有帮助。此外，欢迎任何有关此文件的反馈，因此我们可以为社区提供正确的文件。[请参阅此相关问题](https://stackoverflow.com/questions/1895304/how-do-i-include-full-partcover-results-with-teamcity-5/2095656#2095656)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-12T15:53:58.520

@pelazm - 感谢您提供出色的指导。

要添加到您的解决方案中的两件小事：

(a) 如果您不想外部 PartCover.settings.xml

```
<!-- Runs unit tests through PartCover to calculate unit test covereage-->
<!-- Use %2a instead of * and %3f instead of ? to prevent expansion -->
<!-- %40 = @  %25 = % %24 = $ -->
<Target Name="RunTests">
  <ItemGroup>
     <pc4_settings Include="--target &quot;$(NUnitEXE)&quot;"/>
     <pc4_settings Include="--target-work-dir &quot;$(RootDirectory)\src&quot;"/>
     <pc4_settings Include="--include [%2a]%2a"/>
     <pc4_settings Include="--exclude [nunit%2a]%2a"/>
     <pc4_settings Include="--exclude [log4net%2a]%2a"/>
     <pc4_settings Include="--exclude [MetadataProcessor.Tests%2a]%2a"/>
   </ItemGroup>

   <CreateItem Include="$(RootDirectory)\src\**\bin\$(Configuration)\*.Tests.dll">
     <Output TaskParameter="Include" ItemName="TestAssemblies" />
   </CreateItem>

   <Exec Command="&quot;$(PartCover4Directory)\PartCover.exe&quot; --register    @(pc4_settings,' ') --target-args &quot;%(TestAssemblies.Identity) $(NUnitArgs) /xml:%(TestAssemblies.Identity).NUnitResults.xml&quot; --output $(BuildDirectory)\PartCover-results.xml"
  ContinueOnError="true"
  WorkingDirectory="$(BuildDirectory)">
     <Output TaskParameter="ExitCode" ItemName="ExitCodes"/>
   </Exec>

   <XslTransformation XslInputPath="$(RootDirectory)\tools\partcover4\xslt\PartCoverFullReport.xslt"
                  XmlInputPaths="$(BuildDirectory)\PartCover-results.xml"
                  OutputPaths="$(BuildDirectory)\PartCover-results-PartCoverFullReport.html" />

   <Error Text="Test error occurred" Condition="'%(ExitCodes.Identity)'>0"/>
 </Target> 
```

(b) Gáspár Nagy 的 HTML 报告非常好 - [http://gasparnagy.blogspot.com/2010/09/detailed-report-for-partcover-in.html](http://gasparnagy.blogspot.com/2010/09/detailed-report-for-partcover-in.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T22:31:08.747

使用 PartCover 版本 2.3.0.18745 时，我的代码未显示在报告中也有类似问题。使用 2.2.0.34631 版本解决了这个问题。

# c++ - Windows 资源管理器目录作为捆绑包

> ID：363760
> 
> 赞同：3
> 
> 时间：2008-12-12T18:45:29.373
> 
> 标签：c++, windows, directory, bundle, windows-shell

我一直在研究一种方法来防止我的用户意外进入我的应用程序的数据目录。

我的应用程序使用文件夹来存储结构化项目。文件夹内部结构是批评性的，不应该搞砸。我希望我的用户看到这个文件夹作为一个整体并且不能打开它（就像一个 Mac 包）。

有没有办法在 Windows 上做到这一点？

**从当前答案编辑**

当然，我并不是要阻止我的用户访问他们的数据，只是保护他们免于意外破坏数据完整性。因此不需要加密或密码保护。

感谢大家对 .Net 的回答，但不幸的是，这主要是一个 C++ 项目，对 .Net 框架没有任何依赖。

我提到的数据不是光，它们是从电子显微镜获得的图像。这些数据可能很大（~100 MiB 到~1 GiB），因此不能将所有内容加载到内存中。这些是巨大的图像，因此存储必须提供一种通过一次访问一个文件而不将整个存档加载到内存中来增量读取数据的方法。

此外，该应用程序主要是遗留的，一些我们甚至不负责的组件。允许我保留当前 IO 代码的解决方案是可取的。

Shell Extension 看起来很有趣，我将进一步研究解决方案。

LarryF，您能详细说明 Filter Driver 或 DefineDOSDevice 吗？我不熟悉这些概念。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T18:56:58.837

在您的程序内部还是外部？

有办法，但没有一个是容易的。您可能会查看文件系统上的过滤器驱动程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T19:16:52.650

您可以做几件事：

一件事是您可以创建一个 FolderView Windows Shell 扩展，该扩展将为您的关键文件夹创建自定义视图。通过创建一个自定义的 FolderView，您可以使用一行文本“Nothing to see here”将文件夹设置为空白，或者您可以执行更复杂的操作，例如使用相同方法的 GAC 查看器。这种方法会相当复杂，但是可以通过使用类似[CodeProject](http://www.codeproject.com/KB/shell/msf3.aspx)文章的库之类的东西作为基础来减轻这种复杂性。

另一种解决方案是使用 ZIP 虚拟文件系统，这将要求您替换任何直接使用 System.IO 的代码来使用其他东西。ASP.NET 2.0 正是出于这个原因，您可以很容易地在此基础上进行构建，请查看这篇关于实现 VirtualPathProvider 的[MSDN 文章。](http://msdn.microsoft.com/en-us/library/aa479502.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T20:34:42.617

如果您采用 ZIP 文件方法（我为您考虑过，但没有提及），我建议您使用 deflate 算法，但使用您自己的文件系统...查看类似 TAR 格式的内容。然后，只需编写代码以在将所有 I/O 写入磁盘时通过 Inflate/Deflate 算法。我不会使用 ZIP“FORMAT”，因为它太容易查看文件，找到 PK 作为前两个字节，然后解压缩文件....

我最喜欢 Joshperry 的建议。

当然，您也可以编写一个将所有数据存储在一个文件中的设备驱动程序，但同样，我们正在研究一个驱动程序。（我不确定您是否可以在驱动程序之外实现它。您可能可以，并且在您的程序内部调用 DefineDOSDevice，给它一个只有您的代码可以访问的名称，它将被视为一个普通的文件系统。 ）。我会尝试一些想法，如果它们有效，我会给你一个样本。现在你让我感兴趣了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-08T00:07:20.900

[结构化存储](http://msdn.microsoft.com/en-us/library/aa380369(VS.85).aspx)专为您描述的场景而设计：

> 结构化存储通过将单个文件作为称为存储和流的对象的结构化集合处理，在 COM 中提供文件和数据持久性。

“存储”类似于文件夹，“流”类似于文件。基本上，您有一个文件，当使用结构化存储 API 访问它时，它的行为和外观就像一个完整的、自包含的文件系统。

但请注意：

> 对 COM 技术的深刻理解是结构化存储的开发使用的先决条件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T18:59:35.307

您可以将项目目录包装到 .zip 文件中并将数据存储在那里，就像使用 .jar 一样（我知道 .jar 几乎是只读的，这是为了示例）。做一个非标准的扩展，这样双击就不会立即生效，完成。;-)

当然，这意味着您必须包装所有文件 IO 才能使用 .zip，这取决于您的程序是如何构建的，这可能很乏味。Java 已经完成了：[TrueZip](https://truezip.dev.java.net/)。也许你可以以此为灵感？

如果您受到诱惑 - 我不建议摆弄文件夹权限，原因很明显，这无济于事。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T19:18:30.773

您可以使用隔离存储。

[http://www.ondotnet.com/pub/a/dotnet/2003/04/21/isolatedstorage.html](http://www.ondotnet.com/pub/a/dotnet/2003/04/21/isolatedstorage.html)

它并不能解决所有问题，但它确实使应用程序数据免受伤害。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-12T19:22:24.963

请记住：如果您将其存储在文件系统中，用户将始终能够看到它。篡改资源管理器，我改用 cmd.exe。或总司令。或者别的什么。

如果您不希望人们弄乱您的文件，我建议您

*   加密它们以防止篡改文件
*   将它们放入存档（即 ZIP）中，可能对其进行密码保护，然后在运行时压缩/解压缩（我会查找快速修改存档的算法）

这当然不是完全保护，但它的实现相当简单，不需要您在操作系统中安装时髦的东西，并且应该远离大多数好奇的用户。

当然，如果不控制计算机本身，您将永远无法完全控制用户计算机上的文件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-12T19:26:12.990

我见过使用 Tomalak 建议的 zip 存档作为“项目文件”的软件（Visual Paradigm 的 Agilian）。Zip 文件很好理解，并且使用非标准文件扩展名确实可以防止临时用户弄乱“文件”。这样做的一大优势是，在发生损坏的情况下，可以使用标准工具来解决问题，您不必担心创建特殊工具来支持您的主应用程序。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-15T23:18:49.007

我很高兴听到您在 C++ 中执行此操作。似乎没有人认为 C++ 是“必要的”了。这都是 C# 和 ASP.NET ......即使我在一个全 C# 的房子里工作，当我发誓我*永远不会*切换时，因为 C++ 做了我曾经需要做的所有事情，然后是一些。我已经成年了，可以清理自己的记忆了！呵呵..无论如何，回到手头的问题...

这`DefineDOSDevice()`是一种用于分配驱动器号、端口名称（LPT1、COM1 等）的方法。你给它一个名字，一些标志和一个处理这个设备的“路径”。但是，不要让它愚弄你。它不是文件系统路径，而是 NT 对象路径。我确定您已经将它们视为“\Device\HardDisk0”等。您可以使用 sysinternals 中的 WinObj.exe 来了解我的意思。无论如何，您可以创建一个设备驱动程序，然后将 MSDOS 符号链接指向它，然后您就可以关闭并运行了。但是，对于最初的问题，这似乎需要做很多工作。

一个典型的目录中有多少这些兆到千兆字节的文件？您最好将所有文件粘贴在一个巨型文件中，并在其旁边存储一个索引文件（或每个文件的标题），该文件指向“虚拟文件系统”文件中的下一个“文件”。

一个很好的例子可能是查看 Microsoft MSN 存档格式。当我在一家 AV 公司工作时，我颠倒了这种存档格式，它实际上非常有创意，但非常简单。可以在一个文件中完成所有操作，如果您想要花哨，您可以*将*数据存储在 RAID 5 类型配置中的 3 个文件中，因此如果 3 个文件中的任何一个被冲洗掉，您可以重建其他文件。另外，用户只会在一个目录中看到 3 个*非常*大的文件，并且无法访问单个（内部）文件。

我为您提供了解压缩这些 MSN 存档格式之一的代码。我没有创建一个的代码，但是从提取源中，您可以毫无问题地构建/编写一个。如果文件被删除和/或经常重命名，则可能会导致文件中的已用空间出现问题，必须不时进行修剪。

这种格式甚至支持 CRC 字段，因此您可以测试文件是否正常。我永远无法完全逆转微软用来对数据进行 CRC 校验的算法，但我有一个很好的主意。

您将无法保留当前的 ​​I/O 例程，这意味着 CreateFile() 不仅能够打开存档中的任何文件，但是，凭借 C++ 的超酷，您可以覆盖 CreateFile 调用来实现您的存档格式。

如果您需要他的帮助，并且这是一个足够大的问题，也许我们可以离线讨论并为您找到解决方案。

我不反对给你写一个 FileSystemDriver，但为此，我们必须开始谈论补偿。就像我现在所做的那样，我非常乐意免费为您提供指导和想法。

我不确定在这里给你我的电子邮件地址是否符合犹太教规，我不确定 SO 在这方面的政策，因为我们可能会谈论潜在的工作/征集，但这不是我唯一的意图。我宁愿先帮你找到自己的解决方案。

在查看设备驱动程序之前，请下载 WinDDK。它到处都是驱动程序示例。

如果你想知道我为什么这么关心这个，那是因为我多年来一直在写一个类似于这个的驱动程序，它必须是 Windows*和*与 OSX 兼容，这将允许用户保护驱动器卷（USB 密钥、可移动卷），而无需安装任何驱动程序或复杂（而且体积庞大，有时令人讨厌）的软件。近年来，很多硬件制造商都在做类似的事情，但我认为安全性并不是那么安全。我正在研究使用 RSA 和 AES，与 GPG 和 PGP 的工作方式完全相同。最初，我被告知（我相信，但没有证据）将用于保护 MP3 文件的内容。由于它们将以加密格式存储，因此如果没有正确的密码短语，它们根本无法工作。但是，我也看到了它的其他用途。（当一个 16 兆（是 MEG）USB 密钥的成本超过 100 美元左右时，这又回来了）。

该项目还与我的石油和天然气行业 PC 安全系统一起使用，该系统使用类似于智能卡的东西，只是更容易使用、重复使用/重新发行、不可能（阅读：非常困难和不太可能）破解，并且我可以在家里自己的孩子身上使用它！（因为总是争论谁在电脑上的时间，谁得到的最多，等等，等等，等等……）

呼……我想我在这里跑题了。无论如何，这里是 Microsoft MSN 存档格式的示例。看看你是否可以使用这样的东西，知道你总是可以通过在主文件中解析/搜索请求的文件时跟踪文件中的偏移量来“跳过”文件；或在内存中保存的预解析数据中。而且由于您不会在内存中加载原始二进制文件数据，因此您唯一的限制可能是 32 位机器上的 4gb 文件限制。

MARC（Microsoft MSN 存档）格式的布局（松散）如下：

*   12字节头（只有一个）
    *   文件魔术
    *   马克版
    *   文件数（在下表中）
*   68 字节文件表头（其中 1 到 Header.NumFiles）
    *   文件名
    *   文件大小
    *   校验和
    *   原始文件数据的偏移量

现在，在 12 字节文件表条目中，32 位用于文件长度和偏移量。对于非常大的文件，您可能必须将其增加到 48 或 64 位整数。

这是我为处理这些而编写的一些代码。

```
#define MARC_FILE_MAGIC         0x4352414D // In Little Endian
#define MARC_FILENAME_LEN       56 //(You'll notice this is rather small)
#define MARC_HEADER_SIZE        12
#define MARC_FILE_ENT_SIZE      68

#define MARC_DATA_SIZE          1024 * 128 // 128k Read Buffer should be enough.

#define MARC_ERR_OK              0      // No error
#define MARC_ERR_OOD             314    // Out of data error
#define MARC_ERR_OS              315    // Error returned by the OS
#define MARC_ERR_CRC             316    // CRC error

struct marc_file_hdr
{
    ULONG            h_magic;
    ULONG            h_version;
    ULONG            h_files;
    int              h_fd;
    struct marc_dir *h_dir;
};

struct marc_file
{
    char            f_filename[MARC_FILENAME_LEN];
    long            f_filesize;
    unsigned long   f_checksum;
    long            f_offset;
};

struct marc_dir
{
    struct marc_file       *dir_file;
    ULONG                   dir_filenum;
    struct marc_dir        *dir_next;
}; 
```

这让您了解我为它们编写的标题，这里是 open 函数。是的，它缺少所有的支持电话、错误例程等，但你明白了。请原谅 C 和 C++ 代码风格的混合。我们的扫描仪是由许多类似这样的问题组成的集群……我使用了诸如 open()、fopen() 之类的古老调用，以与代码库的其余部分保持标准。

```
struct marc_file_hdr *marc_open(char *filename)
{
    struct marc_file_hdr *fhdr  = (struct marc_file_hdr*)malloc(sizeof(marc_file_hdr));
    fhdr->h_dir = NULL;

#if defined(_sopen_s)
    int errno = _sopen_s(fhdr->h_fd, filename, _O_BINARY | _O_RDONLY, _SH_DENYWR, _S_IREAD | _S_IWRITE);
#else
    fhdr->h_fd = open(filename, _O_BINARY | _O_RDONLY);
#endif
    if(fhdr->h_fd < 0)
    {
        marc_close(fhdr);
        return NULL;
    }

    //Once we have the file open, read all the file headers, and populate our main headers linked list.
    if(read(fhdr->h_fd, fhdr, MARC_HEADER_SIZE) != MARC_HEADER_SIZE)
    {
        errmsg("MARC: Could not read MARC header from file %s.\n", filename);
        marc_close(fhdr);
        return NULL;
    }

    // Verify the file magic
    if(fhdr->h_magic != MARC_FILE_MAGIC)
    {
        errmsg("MARC: Incorrect file magic %x found in MARC file.", fhdr->h_magic);
        marc_close(fhdr);
        return NULL;
    }

    if(fhdr->h_files <= 0)
    {
        errmsg("MARC: No files found in archive.\n");
        marc_close(fhdr);
        return NULL;
    }

    // Get all the file headers from this archive, and link them to the main header.
    struct marc_dir *lastdir = NULL, *curdir = NULL;
    curdir = (struct marc_dir*)malloc(sizeof(marc_dir));
    fhdr->h_dir = curdir;

    for(int x = 0;x < fhdr->h_files;x++)
    {
        if(lastdir)
        {
            lastdir->dir_next = (struct marc_dir*)malloc(sizeof(marc_dir));
            lastdir->dir_next->dir_next = NULL;
            curdir = lastdir->dir_next;
        }

        curdir->dir_file = (struct marc_file*)malloc(sizeof(marc_file));
        curdir->dir_filenum = x + 1;

        if(read(fhdr->h_fd, curdir->dir_file, MARC_FILE_ENT_SIZE) != MARC_FILE_ENT_SIZE)
        {
            errmsg("MARC: Could not read file header for file %d\n", x);
            marc_close(fhdr);
            return NULL;
        }
        // LEF: Just a little extra insurance...
        curdir->dir_file->f_filename[MARC_FILENAME_LEN] = NULL;

        lastdir = curdir;
    }
    lastdir->dir_next = NULL;

    return fhdr;
} 
```

然后，您有简单的提取方法。请记住，这仅用于病毒扫描，因此没有搜索例程等。这旨在简单地转储文件，对其进行扫描，然后继续。下面是我相信 Microsoft 使用的 CRC 代码例程，但我不确定他们 CRC 到底是*什么*。它可能包括标题数据+文件数据等。我只是没有足够的心思回去尝试扭转它。无论如何，如您所见，这种存档格式没有压缩，但添加起来*非常*容易。如果您愿意，可以提供完整的源代码。（我认为剩下的就是 close() 例程，以及调用和提取每个文件的代码等！！）

```
bool marc_extract(struct marc_file_hdr *marc, struct marc_file *marcfile, char *file, int &err)
{
    // Create the file from marcfile, in *file's location, return any errors.
    int ofd = 0;
#if defined(_sopen_s)
     err = _sopen_s(ofd, filename, _O_CREAT | _O_SHORT_LIVED | _O_BINARY | _O_RDWR, _SH_DENYNO, _S_IREAD | _S_IWRITE);
#else
    ofd = open(file, _O_CREAT | _O_SHORT_LIVED | _O_BINARY | _O_RDWR);
#endif

    // Seek to the offset of the file to extract
    if(lseek(marc->h_fd, marcfile->f_offset, SEEK_SET) != marcfile->f_offset)
    {
        errmsg("MARC: Could not seek to offset 0x%04x for file %s.\n", marcfile->f_offset, marcfile->f_filename);
        close(ofd);
        err = MARC_ERR_OS; // Get the last error from the OS.
        return false;
    }

    unsigned char *buffer = (unsigned char*)malloc(MARC_DATA_SIZE);

    long bytesleft = marcfile->f_filesize;
    long readsize = MARC_DATA_SIZE >= marcfile->f_filesize ? marcfile->f_filesize : MARC_DATA_SIZE;
    unsigned long crc = 0;

    while(bytesleft)
    {
        if(read(marc->h_fd, buffer, readsize) != readsize)
        {
            errmsg("MARC: Failed to extract data from MARC archive.\n");
            free(buffer);
            close(ofd);
            err = MARC_ERR_OOD;
            return false;
        }

        crc = marc_checksum(buffer, readsize, crc);

        if(write(ofd, buffer, readsize) != readsize)
        {
            errmsg("MARC: Failed to write data to file.\n");
            free(buffer);
            close(ofd);
            err = MARC_ERR_OS; // Get the last error from the OS.
            return false;
        }
        bytesleft -= readsize;
        readsize = MARC_DATA_SIZE >= bytesleft ? bytesleft : MARC_DATA_SIZE;
    }

    // LEF:  I can't quite figure out how the checksum is computed, but I think it has to do with the file header, PLUS the data in the file, or it's checked on the data in the file
    //       minus any BOM's at the start...  So, we'll just rem out this code for now, but I wrote it anyways.
    //if(crc != marcfile->f_checksum)
    //{
    //    warningmsg("MARC: File CRC does not match.  File could be corrupt, or altered.  CRC=0x%08X, expected 0x%08X\n", crc, marcfile->f_checksum);
    //    err = MARC_ERR_CRC;
    //}

    free(buffer);
    close(ofd);

    return true;
} 
```

这是我假设的 CRC 例程（我可能从 Stuart Caie 和[libmspack](http://www.cabextract.org.uk/libmspack/ "库包")偷了这个，我不记得了）：

```
static unsigned long marc_checksum(void *pv, UINT cb, unsigned long seed)
{
    int count = cb / 4;
    unsigned long csum = seed;
    BYTE *p = (BYTE*)pv;
    unsigned long ul;

    while(count-- > 0)
    {
        ul = *p++;
        ul |= (((unsigned long)(*p++)) <<  8);
        ul |= (((unsigned long)(*p++)) << 16);
        ul |= (((unsigned long)(*p++)) << 24);
        csum ^= ul;
    }

    ul = 0;
    switch(cb % 4)
    {
        case 3: ul |= (((unsigned long)(*p++)) << 16);
        case 2: ul |= (((unsigned long)(*p++)) <<  8);
        case 1: ul |= *p++;
        default: break;
    }
    csum ^= ul;

    return csum;
} 
```

好吧，我认为这篇文章现在已经够长了……如果您需要帮助或有任何问题，请联系我。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-07T23:17:52.713

看起来[FUSE 的一些 Windows 端口](http://sourceforge.net/apps/mediawiki/fuse/index.php?title=OperatingSystems#Windows)开始出现。我认为这将是最好的解决方案，因为它可以让我保持遗留代码（相当大）不变。

# eclipse - 在 Eclipse 中禁用 Ant 脚本的 DTD 警告？

> ID：363768
> 
> 赞同：65
> 
> 时间：2008-12-12T18:48:27.653
> 
> 标签：eclipse, ant, warnings, dtd

我正在使用[Eclipse Ganymede](http://en.wikipedia.org/wiki/Eclipse_%28software%29#Releases)。一切正常，但我对无警告的“问题”选项卡有一种固执的渴望。现在它（正确地）抱怨我的[Ant](http://en.wikipedia.org/wiki/Apache_Ant)脚本：“没有检测到文档的语法约束（DTD 或 XML 模式）。” 有没有办法只为那些文件关闭它？理想情况下，如果我的其他模式约束文件缺少模式声明，我希望它仍然警告我。

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-01-27T12:41:23.157

最简单的是提供一个最小的 DTD 来关闭它。

```
<!DOCTYPE project> 
```

蚂蚁文件

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2011-07-30T06:53:20.790

和 Brian 一起在“渴望无警告的问题标签”上，我终于决定认真解决这个问题。多亏了马丁的领导，这看起来已经完成了。

但是，它不是 Project -> Properties，而是可以通过 Windows -> Preferences 全局解决。

1.  在左窗格中选择验证类别。
2.  找到名为“XML Validator”的验证器（在右窗格中）并单击其省略号 (...) 按钮。
3.  在以下对话框中，选择“排除组”并单击“添加规则...”。
4.  在 New Filter Rule Wizard 的第一页上，选择 Content Type 选项并单击 Next>。
5.  最后，在 Content Type 下拉列表中，选择“Ant Buildfile”。
6.  单击 Finish 和几个 OK，这应该会处理现有和未来的 Ant Build 文件验证警告。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-10-01T10:03:34.330

即使这个线程有点老，有人可能会觉得这很有趣：

[http://www.cs.hs-rm.de/~knauf/KomponentenArchitekturen2008/jsfunit/index.html](http://www.cs.hs-rm.de/~knauf/KomponentenArchitekturen2008/jsfunit/index.html)

转到*Project Properties* -> *Validation*并按照该页面上的屏幕截图进行操作。即使您不会说德语，也应该很容易。;-)

这个解决方案对我来说非常有效。干杯!

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-01-13T05:10:22.287

您可以删除它并恢复它以避免警告。很明显，这是一个错误。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-06-01T15:59:45.380

我在较新版本的 Eclipse 中看到了禁用此功能的选项。它位于：Window，Preferences，XML，XML Files，Validation 然后将下拉菜单“Indicate when no grammar is specified:”从“Warn”更改为“Ignore”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-03-02T10:51:52.990

事实上，正如 damoco 所说，这似乎是 Eclipse 中的一个错误。如果我从 Windows 中删除（复制到别处）该文件，刷新 Eclipse，然后恢复该文件并再次刷新，警告就会消失。

我正在使用 Eclipse Galileo 构建 20090621-0832。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2011-02-15T19:37:15.140

右键单击警告将其删除，然后清理

# coldfusion - 如何获取在 ColdFusion 中扩展我的组件的名称？

> ID：363770
> 
> 赞同：2
> 
> 时间：2008-12-12T18:49:56.230
> 
> 标签：coldfusion, components, cfc

假设我有以下名为***Base***的组件：

```
<cfcomponent output="false">

    <cffunction name="init" access="public" returntype="Any" output="false">
        <cfset variables.metadata = getmetadata(this)>
        <cfreturn this>
    </cffunction>

    <cffunction name="getmeta" access="public" returntype="Any" output="false">
        <cfreturn variables.metadata>
    </cffunction>

</cfcomponent> 
```

我想在另一个名为***Admin***的组件中扩展 base ：

```
<cfcomponent output="false" extends="Base">
</cfcomponent> 
```

现在在我的应用程序中，如果我在创建对象时执行以下操作：

```
<cfset obj = createobject("component", "Admin").init()>
<cfdump var="#obj.getmeta()#"> 
```

我得到的元数据告诉我该组件的名称是***Admin***并且它正在扩展我的***Base***组件。这一切都很好，但我不想在创建对象时显式调用***init()方法。***

***如果我能在我的Base***组件中做这样的事情，我会很好：

```
<cfcomponent output="false">

    <cfset init()>

    <cffunction name="init" access="public" returntype="Any" output="false">
        <cfset variables.metadata = getmetadata(this)>
        <cfreturn this>
    </cffunction>

    <cffunction name="getmeta" access="public" returntype="Any" output="false">
        <cfreturn variables.metadata>
    </cffunction>

</cfcomponent> 
```

然而，getmeta() 方法返回的元数据告诉我组件名称是***Base***，即使它仍在扩展中。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-17T16:20:39.833

我不是 100% 确定你在追求什么，但 ColdFusion 8 添加了 getComponentMetaData() 函数，它不需要实例化的 CFC，而是采用点符号路径到 CFC。您应该能够从 Admin 获取路径，您可以将其传递给 getComponentMetaData() 而无需调用 Base 上的 init()。

[ColdFusion LiveDoc：getComponentMetaData()](http://livedocs.adobe.com/coldfusion/8/htmldocs/functions_e-g_33.html#5190523)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T20:50:22.680

您是否有理由不想在每个扩展的 cfc 中调用 init？

```
<cfcomponent output="false" extends="Base">
    <cfset super.init()>

</cfcomponent> 
```

这似乎像你想要的那样填充元数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-15T16:32:17.727

6岁，但我会给出真正的答案......

给定 Base.cfc：

```
component{
    public function foo(){
        return 'base';
    }
} 
```

和 Child.cfc：

```
component extends="Base"{
    public function foo(){
        return 'child';
    }
} 
```

要找出 Child 扩展的组件，只需执行以下操作：

```
<cfscript>
child = createObject( "component", "Child" );
writeDump( getMetaData(child).extends.name );
</cfscript> 
```

# actionscript-3 - 在 actionscript 3 中设置函数参数的默认值

> ID：363776
> 
> 赞同：6
> 
> 时间：2008-12-12T18:51:38.973
> 
> 标签：actionscript-3

有什么方法可以引用 var 或 const 作为 actionscript 3 中函数参数的默认值。

我可以定义默认值，如 null、string、int。

```
函数 a( b = null ) {
   废话……
}
```

但我想做的是

```
函数 a( b = function(){} ) {
    废话……
}
```

似乎有办法做到这一点。大概是通过一个 const

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-13T11:25:11.103

奇怪的是，您似乎不能这样做，至少我无法让它工作，它不会接受对静态函数的任何引用作为默认值。

我能做的最好的就是这样：

```
public function myFunction(functionArgument:Function = null):void {
    if (functionArgument != null) {
        functionArgument();
    } else {
        defaultFunction();
    }
} 
```

作为旁注，我刚刚发现您实际上可以声明这样的函数：

```
public static const STATICFUNC:Function = function():void { trace("i'm static!") }; 
```

但这似乎与以理智的方式宣布它们的工作方式相同，所以那里也没有运气。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T16:57:34.173

参数默认值必须是编译时常量，因为编译器必须在编译代码时输入默认值。这意味着静态函数，无论它们多么可预测，都不能用作参数默认值。编译时常量是编译器通过检查代码知道的值，但实际上并没有运行它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T18:08:02.867

我同意葡萄柚。

但如果您想在每次调用时创建新对象，您可以这样做：

```
function myFunction(f:Function = null):void
{
    f = (f != null) ? f : function():void{ trace('new function'); }
} 
```

或者当然：

```
function myFunction(f:Function = null):void
{
    f = (f != null) ? f : defaultFunction; 
}

function defaultFunction():void
{
   trace('default function invoked')
} 
```

# asp.net - 拍卖风格网站的架构

> ID：363783
> 
> 赞同：0
> 
> 时间：2008-12-12T18:54:23.287
> 
> 标签：asp.net

哪里是查找拍卖风格网站底层架构信息的好地方？最好在 ASP.Net 中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-12T18:59:02.687

至少从数据架构方面来看，[Database Answers](http://www.databaseanswers.org/data_models/index.htm)网站有一些数据库图表，通常可以帮助您开始思考域模型。那里也有一个拍卖图。

# java - 在 Swing 的 JTextPane 中设置选项卡策略

> ID：363784
> 
> 赞同：2
> 
> 时间：2008-12-12T18:55:37.000
> 
> 标签：java, swing, jtextpane

我希望我的 JTextPane 在按 Tab 时插入空格。目前它插入制表符（ASCII 9）。

是否有自定义 JTextPane 的选项卡策略（除了捕获“tab-key”事件并自己插入空格之外）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T20:02:07.160

您可以在 JTextPane 上设置 javax.swing.text.Document。以下示例将使您了解我的意思:)

```
import java.awt.Dimension;

import javax.swing.JFrame;
import javax.swing.JTextPane;
import javax.swing.text.AttributeSet;
import javax.swing.text.BadLocationException;
import javax.swing.text.DefaultStyledDocument;

public class Tester {

    public static void main(String[] args) {
        JTextPane textpane = new JTextPane();
        textpane.setDocument(new TabDocument());
        JFrame frame = new JFrame();
        frame.getContentPane().add(textpane);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(new Dimension(200, 200));
        frame.setVisible(true);
    }

    static class TabDocument extends DefaultStyledDocument {
        @Override
        public void insertString(int offs, String str, AttributeSet a) throws BadLocationException {
            str = str.replaceAll("\t", " ");
            super.insertString(offs, str, a);
        }
    }
} 
```

定义一个 DefaultStyleDocument 来完成这项工作。然后将 Document 设置为您的 JTextPane。

干杯凯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T19:26:08.123

据我所知，正如你所说，你必须抓住关键事件。根据使用情况，您也可以等到输入提交，然后将制表符更改为空格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T19:50:24.690

您可以尝试对 DefaultStyledDocument 进行子类化并覆盖 insert 以用空格替换插入元素中的任何选项卡。然后使用 setStyledDocument() 在 JTextPane 中安装您的子类。不过，这可能比捕捉关键事件更麻烦。

# interop - 使用 VS.NET 构建 OCX？

> ID：363787
> 
> 赞同：4
> 
> 时间：2008-12-12T18:57:29.850
> 
> 标签：interop, activex, ms-office, user-controls, ocx

OCX怎么了？他们不再可能使用最新的工具进行创建吗？

我需要创建一个可以放置在 Word、PowerPoint 和 Excel 文档中的 ActiveX 控件。如果我使用 VS.NET，我只能使用 COM Interop 创建一个 UserControl DLL，但我认为我不能使用 PowerPoint 开发人员选项卡的“更多控件”工具箱添加它。

你会怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T18:59:20.300

是的，您仍然可以创建它们。但是您不能使用 .NET 语言创建 OCX。需要非托管 C++（或 VB）。您可以在 C# 或 VB.NET 中创建的具有 COM 互操作性的 DLL 只是通过 CCW 调用的 .NET 对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T20:02:37.473

您仍然可以使用 .NET 创建 ActiveX 组件。但是，这是实验性的，不推荐。如果您仍想尝试，可以在 Andrew Whitechapel 的博客中找到信息：

> [将托管控件用作 ActiveX 控件](http://blogs.msdn.com/andreww/archive/2008/11/24/using-managed-controls-as-activex-controls.aspx)

但正如安德鲁所说：

> 这似乎适用于 Excel（我所做的测试非常有限），部分适用于 PowerPoint，但不适用于 Word。

因此，如果您不想花费大量时间调试奇怪的错误，我建议您使用旧的 VB 6.0 和 Visual Studio 6.0 来构建您的 ActiveX 组件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T18:59:38.503

使用可以针对本机代码 + ActiveX 的 C++ 或 VB 编译器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T15:41:35.187

根据您需要做什么，加载项可能比 OCX 更合适，您当然可以使用 .NET 创建它们。您还应该查看 Visual Studio Tools for Office，它不是 OCX 的直接替代品，而只是为了了解新功能。它可能会向您展示您现在使用 OCX 解决的问题的新方法。

# asp.net - ASP.net：奇怪的网络用户控制问题

> ID：363790
> 
> 赞同：0
> 
> 时间：2008-12-12T18:58:08.740
> 
> 标签：asp.net

这很奇怪。我像这样在 asp.net 网页上声明一个网络用户控件

```
print("<%@ Register Src="~/Controls/blah.ascx" TagName="blahCtrl" TagPrefix="cc" %>"); 
```

直到今天在它给我名字 blah 的代码后面的代码中我都没有问题，没有声明错误。有谁知道这是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T20:01:13.030

尝试在 .aspx 源页面而不是 .aspx.cs 页面上注册它。

# c# - 使用 C# 前端和 Java 后端的程序：好的还是坏的做法？

> ID：363792
> 
> 赞同：4
> 
> 时间：2008-12-12T18:58:47.773
> 
> 标签：c#, java, desktop-application

我和我的朋友在应用程序开发问题上存在分歧。这是一个简单的生产管理应用程序。

据我的朋友说，前端将数据存储在 XML 中，Java 程序将读取 XML 文档，将其存储（在后端），然后应用一些业务逻辑并将结果再次存储到另一个 XML 文档中。并且 C# 前端将显示结果（他想使用套接字来传达 XML 的状态）。

我认为这是一个坏主意。我建议整个应用程序应该用 C# 或 Java 编写。

**注意**：该应用程序是独立的。它不在网络上使用。

你们有人试过吗？请分享你的想法:)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-12T19:57:16.953

你是对的，你的朋友给出了一个坏主意。另外，从你的问题中，我看到有几个困扰的问题，我不知道从哪里开始，所以我只是列出它们而不是任何特定的顺序。但是您要继续阅读的基本规则是，您必须同意越简单越好，正如爱因斯坦所说的“事情应该尽可能简单，但不能更简单”（或者类似的东西，我不记得确切的引用）。

1.  前端和后端的概念并不真正适用于桌面应用程序。相反，您希望使用 MVC 模式来分离关注点。维基百科可能是开始学习或复习的好地方。
2.  如果不需要，为什么要使用套接字（这完全没有必要）。这是为什么这是一个坏主意的第一个原因，因为如果一切都是用语言完成的，在相同的进程空间中运行（您的应用程序是桌面或独立应用程序），您就不需要使用套接字。
3.  同样，为什么是 XML（再次没有必要）。不需要，因为您可以传递 Java 或 C# 对象。对于 XML，当标签被添加到真实数据时，首先存在信噪比问题。然后是解析、构建 XML、潜在的附加库等的时间。这将是您朋友方法中引入的所有代码。

这些是最明显的原因。从经理或公司的角度来看，还有其他原因：

1.  要维护此应用程序，经理或公司需要雇用 2 个不同的技能组。这可能不是真的，因为大多数程序员都是多语言的。但情况并非总是如此。
2.  在部署方面，现在您强制您的用户同时安装 JRE 和 .NET 框架，以便能够运行您的应用程序。而其中任何一个都不是一个很小的足迹。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-12T19:09:26.660

谈论让它变得复杂。Java 或 C#。一个真的不是另一个的后端。它们都与语言“做同样的事情”。唯一的区别是您是想利用 .NET 的力量，还是想利用巨大的 Java 框架的力量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T19:02:56.780

这是一个“不通过网络使用”的桌面应用程序......我根本看不到需要真正的“后端”。

用单一语言编写桌面应用程序，并将数据存储在 XML 中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-12T19:26:26.327

所以你的应用程序是独立的，不需要通过网络工作，但你的朋友坚持使用套接字连接应用程序的前端和后端？此设置有问题，似乎[比需要的复杂](http://thedailywtf.com/Articles/The_Complicator_0x27_s_Gloves.aspx)。

在我看来，您的朋友想使用 Java，因为他更了解 Java 的 XML 处理框架。就个人而言，我认为 Java 和 .NET 之间的互操作是多余的。通过使用您选择的单一语言编写应用程序，您将节省大量工时和挫败感。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-12T19:03:50.103

你朋友的建议是保持模块化。您使用什么语言并不重要，但如果将它放在一个大项目中，您可能会使其非模块化。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-12T19:06:25.463

对于那种类型的应用程序，我只会使用一种语言。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-12T02:50:15.670

可以在前端利用 C# 桌面应用程序的强大功能并在后端使用 Java Ejb+Web 服务 (Jax-ws)。C# 应用程序可以读取 SOAP wsdl 来创建存根和访问由 Jax-ws 实现的 Java 后端的接口。

# java - 将现有 php 类转换为 Java 的最佳方法是什么？

> ID：363805
> 
> 赞同：7
> 
> 时间：2008-12-12T19:01:56.377
> 
> 标签：java, php

我的任务是将几个 php 类转换为 java 类，这很快成为我的噩梦。我了解基本的语言结构，它与 C 类似。所有函数调用和类调用似乎无处可去，而 var 可以在**表达式的中间声明！**那让我头晕目眩，哦，还有零“0”文档的事实。

将php转换为java代码的最佳**方法**（和/或）**工具**（和/或）**参考资料是什么？**

编辑：我必须将 php 转换为 java 有 3 个原因。

1.  通常的原因，我的老板也告诉我。
2.  php太慢了，有时需要**几分钟**才能向服务器运行请求。
3.  php 是扩展和维护的噩梦。（至少对我们来说是强类型语言类型）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-12T21:18:50.533

您询问最佳实践。我相信在你的情况下一个好的做法是theman愉快地提出的方法：使用自动化工具可能会产生不好的结果：垃圾输入，垃圾输出......

你有代码：分析它，如果需要的话，在它的大范围内。并在 Java 中重新创建它。这可能很耗时，但不一定比盲目转换更糟。您可以在途中记录，也许可以使用此分析来找到有问题的部分。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-12T19:07:24.323

人是最好的工具。

我会尝试重写 php 以将大部分 php 功能删除为 C 之类的东西。然后你就可以轻松地用 Java 重写了。

但是我要问，为什么需要转换php？你不能把 php 包装成可以从 Java 调用的东西吗？这样您在转换时不会添加任何错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T19:33:47.687

1.  扔掉代码
2.  用java重写
3.  ？？？
4.  利润！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-12T21:06:17.920

我在[PHP 优化提示](https://stackoverflow.com/questions/127765/php-optimization-tips#127855)问题中说过这一点，我将在这里再说一遍：如果您从静态环境（Web 服务器模块或 FastCGI）运行 PHP，请使用操作码缓存，例如[APC](http://pecl.php.net/package/APC)。否则，PHP 会根据每个请求重新解释/重新编译您的代码！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-25T02:50:07.373

查看[http://www.numiton.com](http://www.numiton.com)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-10-09T20:12:13.733

有人暗示 Java 不如 PHP 灵活：默认情况下，它实际上要灵活得多（因为核心 API 包含数千个类和内置功能）。您只需要学习这两种语言的核心概念，例如 Java 的自动装箱，就可以为动态类型腾出空间。查看[http://www.javaworld.com](http://www.javaworld.com)，我目前正在将一个大型 API 从 PHP 移植到 Java，应该需要几天时间。两个类，libcurl，json 解析，也许还有一百个方法/函数。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-12T19:21:25.340

根据 PHP 代码，这可能是一项几乎不可能完成的任务。反过来就容易多了。PHP 是一种非常动态的语言，您可以摆脱在 Java 中不可能完成的事情。一件特别具有破坏性的事情是 PHP 变量可能会在执行期间更改类型。虽然这很少使用，但它可能会发生。此外，由于 PHP 是松散类型的，因此存在很多隐式转换。有些是巧合，而另一些对于程序的意义很重要。还有一个事实是 PHP 代码不像 Java 那样严格面向对象。即使在面向对象的 PHP 程序中，您通常也会看到某种程度的过程元素。这些不能直接映射到 Java 代码。

作为 Pyrolistical，我很好奇您为什么需要转换此代码？如果是遗留代码，保持 PHP 代码运行，并通过某种服务接口（SOAP、RPC 等）与其交互不是更好吗？然后，您可以随着时间的推移逐渐更换零件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-12T21:49:33.670

为了完整起见，我应该指出，JVM 有一个 PHP 运行时。看看[栎树](http://www.caucho.com/resin-3.0/quercus/)。

您可能会考虑将当前的代码库留在 PHP 中并让它在 JVM 上运行。然后，您可以根据需要用 Java 重写代码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-10-01T08:54:29.187

Caucho/Resin 服务器在运行时将 PHP 代码转换为 Java servlet！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-02-25T05:28:33.617

我通常会使用 php5servlet 生成的类，这是一个在 tomcat 和树脂中可用的 jar。

然后将类文件更改为Java。

干杯

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-12T19:18:35.487

我无法想象存在这样的工具。我用 C++ 和 Java 做了类似的事情。这是一种痛苦，但最好的办法是由你自己来实现。

或者用 C 编写它并使用 jni warpper 创建一个 dll 以从 Java 调用它。这应该是最快的方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-12T19:25:16.690

您可能可以使用反射 API 编写一些东西来完成其中的一些操作，但是您真的无法对函数体做任何事情——您最终会得到没有实现的存根类。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-12T19:52:41.267

我一直在研究[Groovy](http://groovy.codehaus.org/)作为从 PHP 到 Java 的过渡语言。他们（Groovy 开发人员）声称它可以像 Java 代码一样编译成 Java 字节码。
它也不那么严格，他们的网站上有几个翻译示例。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-12T20:24:41.610

*听起来您正在尝试将程序化的 PHP 代码转换为 OO 代码库。*

这与其说是 PHP 到 Java 的问题，不如说是范式转变。没有自动化的方法可以做到这一点，它会很粗糙。特别是如果一个代码库写得不好。

顺便说一句，我也想你为什么要转换？仅仅是表演吗？如果是这样，您是否无法解决性能问题。**我认为仅仅从一种语言转换为另一种语言并不能解决它，你仍然必须找到瓶颈。**

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-07-21T00:09:24.743

我只能找到两个：

1) [https://github.com/bafolts/java2php](https://github.com/bafolts/java2php)

2) [http://www.runtimeconverter.com/](http://www.runtimeconverter.com/)

还有 Caucho Resin，但它不*完全*是转换器。它是 Java 内部的 php 实现。

互联网上有很多关于 numiton 的信息，但他们的网站已经关闭了好几年。

# sql-server - 查看多行数据时可以设置 SQL Management Studio 以显示多行字段吗？

> ID：363807
> 
> 赞同：0
> 
> 时间：2008-12-12T19:02:25.207
> 
> 标签：sql-server

通常它只是将多行内容放在一个单行字段上，并在通常换行符的文本之间添加比正常标签略小的标签。

我正在使用 SQL Management Studio Express。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T20:52:10.913

我相信您唯一的选择是选择结果到文本而不是结果到网格。即便如此，新行仍将换行到整个数据行的开头，因此并没有太大的改进。

# lucene - “排除这些词”功能

> ID：363809
> 
> 赞同：0
> 
> 时间：2008-12-12T19:02:57.687
> 
> 标签：lucene

如何使用 Lucene 为搜索应用程序实现“排除这些词”功能？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-11T08:30:09.317

因此我可以使用stopanalyzer：

StopAnalyzer StopAnalyzer 包括小写过滤器，并且还有一个过滤器可以过滤掉任何“停用词”，例如在英语中常见的冠词（a、an、the 等），它们也可能是搜索的噪音目的。StopAnalyzer 带有一组停用词，但您可以使用自己的停用词数组对其进行实例化。

[http://lucene.apache.org/java/2_3_0/api/org/apache/lucene/analysis/StopAnalyzer.html](http://lucene.apache.org/java/2_3_0/api/org/apache/lucene/analysis/StopAnalyzer.html)

更多信息： [http :](http://www.darksleep.com/lucene/) [//www.darksleep.com/lucene/ 如何按 Lucene.Net 字段排序并忽略“a”和“the”等常见停用词？](https://stackoverflow.com/questions/66041/how-to-sort-by-lucene-net-field-and-ignore-common-stop-words-such-as-a-and-the)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T19:13:52.767

查看[此处](http://lucene.apache.org/java/2_3_2/queryparsersyntax.html)的 NOT 运算符。如果它是用户生成的查询，只需相应地构建您的查询或按摩。

# asp.net-mvc - MVC - 从代码中输出 HTML，最好使用 Response.OutputStream 或 StringBuilder

> ID：363814
> 
> 赞同：2
> 
> 时间：2008-12-12T19:04:53.330
> 
> 标签：asp.net-mvc

我正在编写一个 asp.net MVC 站点，并且我已经为 Html 类编写了一些扩展来为我生成一些 html。

从扩展方法中直接写入 Response.Output 流还是让扩展方法返回一个字符串更好？

直接从视图中使用 Reponse.Output 流有哪些优点/缺点。

使用示例：

```
<%= Html.GenerateHtml() %> 
```

对比

```
<% Html.GenerateFoo() %> 
```

从 GenerateFoo() 方法中，我可以使用以下内容直接写入输出流

```
... 
helper.ViewContext.HttpContext.Response.OutputStream.Write()
... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T23:38:01.080

返回一个字符串使您可以选择在结果转储到 Response.Write() 之前修改/检查/捕获结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T22:04:38.193

首先，我不会使用 OutputStream 进行文本输出，我会使用 Response.Write()。

其次，返回一个字符串到 <%= 无论如何都会调用 Response.Write() （有时在 Temp ASP.NET 文件夹中查看 ASPX 的编译输出）。

# url-rewriting - 如何提取数据并将其替换为新代码并将其另存为新文本？

> ID：363819
> 
> 赞同：0
> 
> 时间：2008-12-12T19:06:36.383
> 
> 标签：url-rewriting

我一直在尝试在原始文本的每一行中提取 URL 的最后六个数字，并将其添加到另一个必须添加到结果文本中的代码中。还需要从原始文本中删除每一行的一些代码，并将其替换为结果文本中的新代码。

输入 [http://riyajr.googlepages.com/original.txt](http://riyajr.googlepages.com/original.txt)

输出 [http://riyajr.googlepages.com/result.txt](http://riyajr.googlepages.com/result.txt)

有什么软件可以完成上述任务吗？请帮助我提供任何其他可用选项。如果有人可以为我提供可以完成上述任务的完整脚本代码，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T19:13:22.250

是的，很多。它是任何脚本语言的基本应用程序 - Perl 或 Python 或...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T19:32:31.340

php:

```
$infile = "in.txt";
$outfile = "out.txt";

foreach (file($url) as $line)
{

    //extract last 6 chars
    $chars = substr($line, -6);

    // append the last 6 chars to a outfile
    file_put_contents($outfile, "$chars\n", FILE_APPEND);
} 
```

请注意，这并没有做任何正则表达式来确定最后 6 个字符是否是数字，它只是盲目地抓取它们。

获得一本好的脚本书！

# javascript - 如何显示足够智能以处理多个打开的浏览器或选项卡的会话超时警告

> ID：363833
> 
> 赞同：17
> 
> 时间：2008-12-12T19:14:03.793
> 
> 标签：javascript, session, session-timeout, browser-tab

我已经使用 javascript 实现了会话超时警告，它只是询问用户是否要延长会话或注销。问题在于，这是针对 Intranet 门户的，其中高级用户通常会同时向应用程序打开多个浏览器窗口或选项卡。目前，将提示他们即将从每个浏览器窗口中注销。如何使代码更智能以检测他们正在积极使用另一个浏览器会话？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T19:19:57.357

您必须使用 Ajax 检查服务器上的会话状态并跟踪用户拥有的所有打开的会话/窗口。然后，您将能够仅针对其中一个带有注销警告的可用会话。

回应您的评论：

不要使用内置的会话机制，使用服务器端的持久数组或数据库日志来设计自己的。

不，HTTP 请求中的任何内容都不会告诉您打开了多少浏览器，但是您可以在用户打开每个浏览器窗口时分配自己的 sessionID cookie。对服务器进行 Ajax 调用，查看用户是否超时，如果您是会话日志中最低（或最后）的条目，那么您就是收到警告的浏览器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T20:49:49.310

您不能指望所有选项卡/窗口都属于同一个会话，因为它们可以生成并包含在单独的进程中，而您对此没有太多控制权。

但是，如果您的代码引用了 Javascript cookie，您可以通过回发（同步或异步 AJAX）检查您的伪会话状态。但是，您依赖于在用户浏览器上启用的 cookie。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T20:11:11.013

这行得通吗？

存储一个 Javascript cookie 并检查以确定会话是否已在另一个选项卡中扩展？

看起来这确实有效......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-25T10:10:31.113

安装 @ng-idle @ng-idle 可通过 NPM 获得。通过运行安装它：

```
npm install --save @ng-idle/core @ng-idle/keepalive angular2-moment 
```

设置您的应用程序模块 打开 src/app/app.module.ts 并使用导入 Ng2IdleModule

```
import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';
import { FormsModule } from '@angular/forms';
import { HttpModule } from '@angular/http';

import { NgIdleKeepaliveModule } from '@ng-idle/keepalive'; // this includes the core NgIdleModule but includes keepalive providers for easy wireup

import { MomentModule } from 'angular2-moment'; // optional, provides moment-style pipes for date formatting

import { AppComponent } from './app.component';

@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule,
    FormsModule,
    HttpModule,
    MomentModule,
    NgIdleKeepaliveModule.forRoot()
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { } 
```

然后在 component.ts

```
import { Component } from '@angular/core';

import {Idle, DEFAULT_INTERRUPTSOURCES} from '@ng-idle/core';
import {Keepalive} from '@ng-idle/keepalive';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent {

    currentPath: String;

    idleState = 'Not started.';
    timedOut = false;
    lastPing?: Date = null;

    constructor(private idle: Idle, private keepalive: Keepalive, location: Location, router: Router) {

        // sets an idle timeout of 5 seconds, for testing purposes.
        idle.setIdle(5);

        // sets a timeout period of 5 seconds. after 10 seconds of inactivity, the user will be considered timed out.
        idle.setTimeout(5);

        // sets the default interrupts, in this case, things like clicks, scrolls, touches to the document
        idle.setInterrupts(DEFAULT_INTERRUPTSOURCES);

        idle.onIdleEnd.subscribe(() => this.idleState = 'No longer idle.');

        idle.onTimeout.subscribe(() => {
            this.idleState = 'Timed out!';
            this.timedOut = true;
        });

        idle.onIdleStart.subscribe(() => this.idleState = 'You\'ve gone idle!');
        idle.onTimeoutWarning.subscribe((countdown) => this.idleState = 'You will time out in ' + countdown + ' seconds!');

        // Sets the ping interval to 15 seconds
        keepalive.interval(15);

        keepalive.onPing.subscribe(() => this.lastPing = new Date());

        // Lets check the path everytime the route changes, stop or start the idle check as appropriate.
        router.events.subscribe((val) => {

            this.currentPath = location.path();
            if(this.currentPath.search(/authentication\/login/gi) == -1)
                idle.watch();
            else
                idle.stop();

        });
    }

    reset() {
        this.idle.watch();
        this.idleState = 'Started.';
        this.timedOut = false;
    }
} 
```

# sql - 选择中的 SQL 用户定义函数

> ID：363838
> 
> 赞同：67
> 
> 时间：2008-12-12T19:16:40.887
> 
> 标签：sql, sql-server, select, user-defined-functions

我在 SQL 中有一个名为 getBuisnessDays 的用户定义函数，它需要 @startdate 和 @enddate 并返回两个日期之间的工作日数。如何在我的选择中调用该函数？

这就是我想做的..

```
SELECT getBusinessDays(a.opendate,a.closedate) 
FROM account a
WHERE ... 
```

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-12-12T19:22:18.927

是的，你几乎可以做到这一点：

```
SELECT dbo.GetBusinessDays(a.opendate,a.closedate) as BusinessDays
FROM account a
WHERE... 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-12T19:29:18.803

如果它是一个表值函数（返回一个表集），你只需将它作为一个表加入

此函数生成一个列表，其中包含传递的逗号分隔列表中的所有值

```
SELECT * FROM dbo.udf_generate_inlist_to_table('1,2,3,4') 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-12T19:25:35.037

使用标量值 UDF，而不是表值 UDF，然后您可以根据需要在 SELECT 中使用它。

# wcsf - 为什么可以选择为业务模块的接口创建单独的类库？

> ID：363842
> 
> 赞同：1
> 
> 时间：2008-12-12T19:17:30.607
> 
> 标签：wcsf

在 wcsf 中，如果我勾选了相关的框/框，则可以使用单独的类库为接口创建业务模块。

为接口创建一个单独的类库有什么意义？这不会给我的项目增加不必要的膨胀并在两个类库之间建立高度耦合吗？将接口存储在存储具体类的类库中会有什么问题？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T19:32:18.813

将接口存储在单独的类库中的优点是它实际上*解耦*了实现和使用类库。如果接口带有具体的实现类，那么你有

实现类.dll <--- ClientClasses.dll

如果将接口放入单独的程序集中，则更像是这样：

实施Classes.dll ---> Interfaces.dll <--- ClientClasses.dll

请注意这如何消除您的客户端代码和实现之间的耦合——这将允许您的整个应用程序使用基于配置的方法来定位正确的实现类。

# css - 使用自动换行更改元素的标签大小：pre？

> ID：363845
> 
> 赞同：2
> 
> 时间：2008-12-12T19:18:34.800
> 
> 标签：css, word-wrap, tab-size

我有一个类似于标签的元素（因为它有自动换行：pre;）来在网站上显示代码。唯一的问题是选项卡尺寸太大，导致元素经常水平滚动，因为它是固定宽度的。

是否可以更改标签大小？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T19:23:06.973

您可以用空格替换制表符。然后你可以精确控制缩进的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T19:34:12.163

我们需要更清楚地了解您的问题，但是您是否正在寻找`text-indent`css 属性？您可以设置缩进量，例如：

```
<style type="text/css">
p {
  text-indent: 40px;
}
</style> 
```

# sql-server - 检测特定数据库是否存在的与版本无关的 SQL Server 脚本/语句

> ID：363848
> 
> 赞同：2
> 
> 时间：2008-12-12T19:19:39.617
> 
> 标签：sql-server, tsql

由于发行版的打包性质，需要创建一个 SQL Server 脚本（更多是一条语句），它可以在 SQL Server 7.0 到 2008 上正确执行，这基本上可以实现这一点：

```
if exists(select * from sys.databases where name = 'Blah') 
```

这很难的原因：

SQL 7 'sys.databases' 无效

SQL 2008 'sysdatabases' 无效

我愚蠢地使用 serverproperty 解析出版本号，以允许 IF 取决于版本：

```
if (select CONVERT(int,replace(CONVERT(char(3),serverproperty ('productversion')),'.',''))) >= 80 
```

然后发现SQL 7下不存在serverproperty。

请注意，SQL 可以远离安装，因此不要在本地机器上乱搞——注册条目/文件版本等是有任何用处的。

SQL Server 错误处理（尤其是 7.0）很差，或者我对它的理解不够好，无法让它做一种 try/catch。

我现在对此问题视而不见，因此将不胜感激。

谢谢，

加雷斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T19:21:35.307

尝试

使用数据库

并测试@@ERROR。

> 使用数据库
> IF @@ERROR <> 0 GOTO ErrExit
> 
> 逻辑...
> 
> 返回 0
> 
> 错误退出：
> 返回 1

（或 RAISERROR，或 ...）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T21:00:41.193

谢谢 G 马斯特罗斯

这看起来可能会产生 100% 的解决方案。它在 SQL 7 下可用。

我需要完成和测试，但乍一看我认为它会飞。

这是代码草案仅供参考。

```
create table #dwch_temp
(
name sysname
,db_size nvarchar(13)
,owner sysname
,dbid smallint
,created nvarchar(11)
,status nvarchar(600)
,compatibility_level tinyint
)
go

insert into #dwch_temp
exec sp_helpdb

if exists(select name from #dwch_temp where name = 'DWCHServer')

-- run the code

drop table #dwch_temp 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T19:22:51.967

您可以尝试在 USE [DatabaseName] 周围尝试... CATCH。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T20:00:28.257

谢谢勒多菲尔。它仍然存在引发错误且 GOTO 未处理的问题：

消息 1801，级别 16，状态 3，第 9 行数据库“DWCHServer”已经存在。选择不同的数据库名称。

我什至试过

声明 @err int 使用 DWCHServer

SELECT @err = @@error IF @err <> 0 GOTO ErrExit

我试图避免这种情况，因为它可能会产生影响，具体取决于设置的 SQL 框。它可能会寻呼某人或某事。我对此表示怀疑，因为它是 16 级（杂项用户错误 - 很好），而且通常只有 17 岁以上才能启动某种工作流程。

考虑将系统要求改为 2000+ ;)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-05T00:45:58.380

sysdatabases 是 Sybase 时代的遗留物，并且仍然存在于 SQL 2008 中（尽管已弃用）。您可以使用如下查询检查数据库是否存在：

如果存在（从 master..sysdatabases 中选择 1，其中 name = 'Blah'）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T20:30:33.280

我无权访问 SQL 7 实例，但我鼓励您尝试：

```
sp_helpDB 
```

我知道这适用于 sql 2000 和 sql 2005 以获取数据库列表。我怀疑它也适用于 SQL 7。

# c++ - 数组下标的无效类型“int [int]”

> ID：363864
> 
> 赞同：8
> 
> 时间：2008-12-12T19:25:23.630
> 
> 标签：c++, arrays, compiler-errors

这段代码抛出了标题中给出的编译错误，谁能告诉我要改变什么？

```
#include <iostream>

using namespace std;

int main(){

    int myArray[10][10][10];

    for (int i = 0; i <= 9; ++i){
        for (int t = 0; t <=9; ++t){            
            for (int x = 0; x <= 9; ++x){
                for (int y = 0; y <= 9; ++y){

                myArray[i][t][x][y] = i+t+x+y; //This will give each element a value

                      }
                      }
                      }
                      }

    for (int i = 0; i <= 9; ++i){
        for (int t = 0; t <=9; ++t){
            for (int x = 0; x <= 9; ++x){
                for (int y = 0; y <= 9; ++y){

                cout << myArray[i][t][x][y] << endl;

                    }
                    }
                    }                
                    }

    system("pause");

} 
```

提前致谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-12T19:28:15.560

您正在为一个三维数组下标`myArray[10][10][10]`四次`myArray[i][t][x][y]`。您可能需要向数组添加另一个维度。还可以考虑像[Boost.MultiArray](http://www.boost.org/doc/libs/1_37_0/libs/multi_array/doc/index.html)这样的容器，尽管此时这可能超出了您的想象。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-12T20:00:41.657

要改变什么？除了 3 或 4 维数组问题，您应该摆脱幻数（10 和 9）。

```
const int DIM_SIZE = 10;
int myArray[DIM_SIZE][DIM_SIZE][DIM_SIZE];

for (int i = 0; i < DIM_SIZE; ++i){
    for (int t = 0; t < DIM_SIZE; ++t){            
        for (int x = 0; x < DIM_SIZE; ++x){ 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-12T19:30:05.947

```
int myArray[10][10][10]; 
```

应该

```
int myArray[10][10][10][10]; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-01-27T02:42:10.653

为了完整起见，此错误也可能发生在不同的情况下：当您在外部范围内声明一个数组，但在内部范围内声明另一个具有相同名称的变量时，会隐藏数组。然后，当您尝试索引数组时，您实际上是在访问内部范围内的变量，它甚至可能不是一个数组，或者它可能是一个维度较少的数组。

例子：

```
int a[10];  // a global scope

void f(int a)   // a declared in local scope, overshadows a in global scope
{
  printf("%d", a[0]);  // you trying to access the array a, but actually addressing local argument a
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-12T19:28:32.097

您正在尝试访问具有 4 个取消引用的 3 维数组

您只需要 3 个循环而不是 4 个，或者`int myArray[10][10][10][10];`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-02-04T17:25:41.657

我认为您已经初始化了一个 3d 数组，但您正在尝试访问一个 4 维数组。

# backup - 您如何处理 TB 级数据的异地备份？

> ID：363871
> 
> 赞同：5
> 
> 时间：2008-12-12T19:27:29.023
> 
> 标签：backup, backup-strategies

我有数 TB 的文件和数据库转储，需要异地备份。

实现这一目标的最佳方法是什么？

我目前正在权衡 rsyinc 到 Amazon EBS 或获取设备（例如梭子鱼）。

我打电话给我的一个朋友，他说他使用 backula 将所有文件放在一个磁盘上，然后将该磁盘备份到磁带，然后将磁带发送到铁山。

仍在等待我联系过的其他系统管理员的回复。将在此处发布结果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-12T19:35:31.490

一个值得考虑的异地备份常见解决方案是在现场执行备份，然后通过安全的蜗牛邮件或为此目的设计的服务将备份物理地传输到其他地方。如果带宽是一个问题，这可能更实用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T19:56:34.147

我不使用磁带，而是使用每周物理更换的硬盘驱动器。它比磁带设备便宜，并且在必要时更容易插入另一个系统。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T19:44:02.063

早在 80 年代后期，我曾在一个地方工作，每周一我们都会收到一盒各种类型的磁带——我们会在那个盒子上的磁带上做一组每周备份，然后将它们发送到异地。显然他们有两个这样的盒子，一个在我们的办公室里，另一个被锁在某个地方。然后我们得到了一个 Exabyte 驱动器，它的单个磁带容量大于整盒 TK-50、QIC-40 和 mag 磁带，而且每周与一位经理一起将单个磁带送回家更简单。

我确信仍然有这样的异地备份系统，但我发现将几个 500Gb 驱动器从我的家庭系统循环到我的办公桌上更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T20:10:17.690

为什么不加密它并实际上传到第三方供应商？

我正在考虑在家中使用我的数据执行此操作，但还没有找到可以让我进行转储的供应商...他们都想安装客户端应用程序...

诚然，我并没有那么努力……

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T21:18:50.487

我们使用了几种解决方案。我们与另一家公司进行异地备份。我们还使用几个便携式硬盘驱动器并每天更换它们。这两种解决方案都不能真正处理数 TB 的数据。更像千兆字节。

然而，在未来，我们可能会考虑使用磁带路由器，或者其他类似永久和可存储的东西。TB 级的数据太多，无法通过网络传输。当蓝光光盘价格合理且在商业上可行时，研究不久前被吹捧的 400GB 光盘可能是个好主意。这些对存储非常友好（在物理意义上和文件大小意义上），并且根据寿命统计数据，可能会保留一段时间，类似于磁带。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-12T21:26:18.597

我建议使用像 EMC 这样的公司提供的本地 san，它可以为远程设施提供基于压缩快照的复制。这是一个昂贵的解决方案，但它确实有效。

[http://www.emc.com/products/family/emc-centera-family.htm](http://www.emc.com/products/family/emc-centera-family.htm)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-15T16:42:51.893

周末，我收到了几个系统管理员朋友的回复。

似乎最好的做法是将所有机器备份到一个中央大磁盘，然后将该磁盘备份到磁带，然后将磁带发送到异地（都使用过 Iron Mountain）。

磁带可容纳 400-800G，每条磁带的成本为 30-80 美元。磁带更换器的价格似乎高达 10,000 美元。

不知道异地运输费用是多少。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-31T13:53:23.067

我害怕胶带。我认为它给人一种数据安全的错误感觉。根据我自己在数百个磁带上备份数十 TB 的经验，我们发现几年后的数据恢复率下降到 70% 左右。

公平地说，这是一项现已停产的技术 (AIT)，但它几乎让我终生无法使用磁带，除非它安装在 1 英寸线轴上并且价格非常昂贵。

如今，多个硬盘驱动器、多个位置，是的，退回到 Amazon S3 或其他云提供商并没有什么坏处（除了有点贵）。

# syntax - PowerShell 中的“@”符号有什么作用？

> ID：363884
> 
> 赞同：134
> 
> 时间：2008-12-12T19:32:40.467
> 
> 标签：syntax, powershell

我已经看到了`@`PowerShell 中用于初始化数组的符号。

该符号究竟`@`表示什么，我在哪里可以阅读更多有关它的信息？

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2009-02-22T05:07:01.223

在 PowerShell V2 中，@ 也是[Splat 运算符](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_splatting?view=powershell-6)。

```
PS> # First use it to create a hashtable of parameters:
PS> $params = @{path = "c:\temp"; Recurse= $true}
PS> # Then use it to SPLAT the parameters - which is to say to expand a hash table 
PS> # into a set of command line parameters.
PS> dir @params
PS> # That was the equivalent of:
PS> dir -Path c:\temp -Recurse:$true 
```

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2008-12-12T19:51:44.903

PowerShell 实际上会将任何逗号分隔的列表视为一个数组：

```
"server1","server2" 
```

所以 @ 在这些情况下是可选的。但是，对于关联数组，@ 是必需的：

```
@{"Key"="Value";"Key2"="Value2"} 
```

正式地，@ 是“数组运算符”。您可以在随 PowerShell 一起安装的文档中或在我与人合着的“Windows PowerShell：TFM”之类的书中阅读有关它的更多信息。

* * *

## 回答 #3

> 赞同：82
> 
> 时间：2015-10-02T20:13:45.957

虽然上述回复提供了*大部分*答案，但它是有用的——即使问题很晚——提供完整的答案，即：

**数组子表达式**（参见[about_arrays](https://technet.microsoft.com/en-us/library/hh847882.aspx)）

强制值是一个数组，即使是单例或空值，例如`$a = @(ps | where name -like 'foo')`

**哈希初始化器**（参见[about_hash_tables](https://technet.microsoft.com/en-us/library/hh847780.aspx)）

使用键值对初始化哈希表，例如 `$HashArguments = @{ Path = "test.txt"; Destination = "test2.txt"; WhatIf = $true }`

**[喷溅](https://technet.microsoft.com/en-us/library/jj672955.aspx)（见**about_splatting**）**

 **让我们使用数组或哈希表中的参数调用 cmdlet，而不是使用更习惯的单独枚举参数，例如使用上面的哈希表，`Copy-Item @HashArguments`

**这里是字符串**（见[about_quoting_rules](https://technet.microsoft.com/en-us/library/hh847740.aspx)）

让我们创建带有易于嵌入引号的字符串，通常用于多行字符串，例如：

```
$data = @"
line one
line two
something "quoted" here
"@ 
```

因为这类问题（*PowerShell 中的“x”表示法是什么意思？*）在 StackOverflow 以及许多读者评论中都很常见，所以我整理了一个 PowerShell 标点符号词典，刚刚发布在 Simple-Talk.com 上。阅读所有关于 @ 以及 % 和 # 以及 $_ 和 ? 以及更多[关于 PowerShell 标点符号的完整指南](https://www.simple-talk.com/sysadmin/powershell/the-complete-guide-to-powershell-punctuation/)。附在文章后面的是这张挂图，它在一张纸上为您提供了所有内容： [![在此处输入图像描述](https://i.stack.imgur.com/jSC7R.jpg)](https://i.stack.imgur.com/jSC7R.jpg)

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2008-12-12T20:42:12.930

您还可以包装 cmdlet（或管道）的输出，`@()`以确保您得到的是一个数组而不是单个项目。

例如， dir 通常返回一个列表，但根据选项，它可能返回单个对象。如果您计划使用 foreach-object 遍历结果，则需要确保返回一个列表。这是一个人为的例子：

```
$results = @( dir c:\autoexec.bat) 
```

还有一件事......一个空数组（如初始化变量）被表示`@()`。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-12-12T19:38:32.637

**喷溅操作员**

要创建一个数组，我们创建一个变量并分配该数组。数组用“@”符号表示。让我们以上面的讨论为例，使用一个数组来连接多台远程计算机：

```
$strComputers = @("Server1", "Server2", "Server3")<enter> 
```

它们用于数组和散列。

[PowerShell 教程 7：累积、调用和修改数据](https://web.archive.org/web/20151102083107/http://www.powershellpro.com:80/powershell-tutorial-introduction/variables-arrays-hashes/)

[PowerShell 中的数组文字](https://devblogs.microsoft.com/powershell/array-literals-in-powershell/)

# objective-c - WebView 在我的 ScreenSaverView 中的错误位置呈现

> ID：363889
> 
> 赞同：0
> 
> 时间：2008-12-12T19:34:53.237
> 
> 标签：objective-c, macos, webkit

我编写了一个显示网页的屏幕保护程序。它在我的主显示器上完全按照我的意愿工作，但在预览和辅助显示器中，Web 视图挂在屏幕顶部。

示例（来自预览）：

[屏幕保护程序错误 http://img.skitch.com/20081212-nk5cqrgfds1funr1a3p72aw25q.preview.jpg](http://skitch.com/dlsspy/6mds/screen-saver-bug)
使用[plasq](http://plasq.com/)的[Skitch](http://skitch.com)上传！

我的代码非常简单。从内部`initWithFrame:isPreview:`我有以下代码：

```
webview = [[WebView alloc] initWithFrame:frame
                           frameName:@"main"
                           groupName:@"main"];
[self addSubview:webview]; 
```

有谁知道发生了什么？

如果有人想玩这个项目，[代码](http://github.com/dustin/websaver)在 github 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T21:00:59.977

我认为您给 WebView 的框架位于错误的坐标中。请记住，视图的框架是根据父视图的坐标系（边界）表示的。

`-bounds`如果我正确地理解了您想要做的事情，您应该使视图与 superview 的一样大：通常是从 (0,0) 到 (width,height) 的矩形。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T22:12:24.980

我查看了您的代码，您正在使用超级视图的 (WebSaverView) 框架矩形作为 WebView 的框架。您应该改用它的边界矩形 ( `[self bounds]`)。边界矩形表示超级视图“内部”的区域。如您所见，两者可能并不总是具有相同的起源，这导致了这个问题。您不应该调整传入的帧`initWithFrame:`，因为原点可能有一个很好的理由不为 0,0。

# vb.net - VB.NET .....循环帮助

> ID：363892
> 
> 赞同：0
> 
> 时间：2008-12-12T19:36:40.113
> 
> 标签：vb.net, visual-studio, loops

我在 Visual Studio 2008 中使用 My.Settings 来存储信息，以供用户再次运行程序时使用。

我的工作正常...但是由于我使用 12 个文本框，我不想写...

我的.settings.grade1 = textbox1.text

对于每一个，我也在使用存储的信息进行计算，所以我不想写 my.settings.grade1 + my.settings.grade2 等。

欢迎任何帮助

谢谢 =)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-12T19:49:09.637

在具有文本框的表单上，在初始化表单时将它们添加到集合或文本框数组中。

然后，遍历文本框的集合或数组以分配给设置值。

如果您不想手动将文本框的分配编码到数组中，那么在您的表单初始化代码中，遍历表单上的所有控件并检查您分配给每个文本框的控件类型或特定“标签”，然后以这种方式将每个文本框添加到数组中。

```
For Each c as Control in Me.Controls

 If c.Tag.ToString() = "Grade" Then
  ' Add Items to collection here '
 End If

Next c 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T21:18:20.283

您是否考虑过使用 ApplicationSettings Binding 将您的值自动绑定到您的 Textboxes.Text 属性。这将支持 2 向绑定，然后您所要做的就是在关闭时调用 Save。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-12T19:55:34.383

或者你可以这样做：

假设您的文本框按照以下方式命名：Grade1、Grade2、Grade3 等。

您可以将成绩存储在一个数组中，然后遍历该数组：

```
((TextBox)form.findControl("Grade" + i.ToString())).Text = Grade(i) 
```

根据您的计算，您还可以在循环内执行计算。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T21:12:03.743

填充成绩文本框列表：

```
'at the class level'
Public GradeBoxes(11) As TextBox
Const grade As String = "GRADE"

'when the form is created'
Dim i As Integer = 0
For Each ctr As Control In Controls
    If TypeOf (ctr) Is TextBox AndAlso ctr.Name.ToUpper.StartsWith(grade) Then
        i = CInt(ctr.Name.SubString(grade.Length))
        If i >= 0 AndAlso i < GradeBoxes.Length Then GradeBoxes(i) = ctrl
    End If
Next ctr

For Each box As TextBox in GradeBoxes
    If box IsNot Nothing AndAlso My.Settings(box.Name) IsNot Nothing Then
        box.Text = My.Settings(box.Name)
    End If
Next box 
```

保存成绩：

```
For Each box As TextBox in GradeBoxes
    If box IsNot Nothing AndAlso My.Settings(box.Name) IsNot Nothing Then
        My.Settings(box.Name) = box.Text
    End If
Next box
My.Settings.Save() 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-12T19:54:32.713

你的意思是类似的吗？

```
 Dim sum As Long
    Dim grades(11) As Long

    Dim i As Integer = 0
    For Each ctr In Controls
        If TypeOf (ctr) Is TextBox Then
            grades(i) = CLng(ctr.Text)
            sum = sum + grades(i)
            i = i + 1
        End If
    Next 
```

# iphone - 清理 iPhone 应用程序内存的最佳做法？

> ID：363893
> 
> 赞同：3
> 
> 时间：2008-12-12T19:38:09.737
> 
> 标签：iphone, objective-c, cocoa-touch

我已经看到使用不同方式释放/释放对象的示例源代码，所以我想知道哪种方式被认为是“最好的”方式。几个选项`-dealloc`：

1) 释放对象

```
- (void)dealloc {
    [obj1 release];
    [obj2 release];
    [super dealloc];
} 
```

2）将对象设置为零

```
- (void)dealloc {
    self.obj1 = nil;
    self.obj2 = nil;
    [super dealloc];
} 
```

3) 直接解除分配对象

```
- (void)dealloc {
    [obj1 dealloc];
    [obj2 dealloc];
    [super dealloc];
} 
```

哪种方式最好？各有优劣？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-12T20:07:02.907

方法 1 是唯一推荐的方法。在你释放它们之后将它们设置为 nil 也是一个好习惯。

方法 2 仅适用于管理自己的对象/值保留的属性，因此它不是普遍适用的。如果您实现自己的 setter 方法，该方法在属性更改时执行其他操作，则在 [dealloc] 中调用它可能会产生不希望的副作用。

方法 3 违反了引用计数原则，因为它会释放对象，即使其他对象对它们有 [retain] 保留，因此当其他对象接下来访问它们时，您的程序将崩溃。您永远不应该直接调用 [dealloc] —— 让运行时在最后一个所有者调用 [release] 时调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-12T20:49:45.223

如果 obj1 和 obj2 是使用 @synthesize-d 访问器的属性，则方法 1 和方法 2 是等价的。如果这两个条件中的任何一个不成立，那么效果就会大不相同。如果它们不是属性，那么方法 2 只是将指针设置为 nil 而不做任何会释放对象的操作。如果它们是属性，但您已经实现了自己的 setter 方法，则方法 2 以“nil”作为参数调用这些方法。这是否等同于方法 1 取决于您如何实现这些方法。如果您的自定义设置器在参数为 nil 时执行任何重要操作，则方法 2 将确保执行此代码。

正如 Marco 所说，方法 3 是完全错误的。如果您已经看到示例代码这样做，那么作者可能实际上并不知道他们在做什么。

# c# - 在 Web 用户控件之间传递值

> ID：363899
> 
> 赞同：2
> 
> 时间：2008-12-12T19:42:15.127
> 
> 标签：c#, asp.net, user-controls

我的 asp.net 页面上有几个 Web 用户控件，我想在它们之间传递值。例如 ：

其中一个有一个dropDownList，当用户从dropDownList中选择任何项目时，它可以将选定的值传递给包括GridView的另一个用户控件，以显示来自包含下拉列表的用户控件的选定项目值的相关数据。（哇，很尴尬的句子）

谢谢并恭祝安康..

Ps：我们可以在返回值的方式中使用User控件作为类吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T19:47:37.363

然后，在 DropDownList onChange 事件中，您可以将所选项目值分配给其他用户控件的属性。

好的，您的 UserControls 应该具有允许设置数据的属性。例如，在 Control2 中，您将拥有：

```
public string needData { 
get { return MyData; }
set { 
  MyData = value;
  //do whatever you need to do with that data here
} 
```

现在在您的页面中，您将捕获 DropDownList OnChange 事件，并且在其中您会像这样：

```
myControl2.needData = myDropDownList.SelectedValue; 
```

这更有意义吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-09T06:14:32.133

使用委托，[这里的例子](http://www.dotnetfunda.com/articles/article201.aspx)

希望这可以帮助

# python - 相当于 wxPython 中的 HTML 多选框

> ID：363907
> 
> 赞同：3
> 
> 时间：2008-12-12T19:45:11.610
> 
> 标签：python, wxpython

我想在 wxPython 中创建一个与HTML 中`ListBox`的多个框具有相同语义的一个。`select`具体来说，我想要以下语义

*   当用户单击列表中的一个条目时，所有其他条目都将取消选择，而单击的条目将变为选中状态。如果条目已被选中，则它保持选中状态。
*   当用户在单击条目时按住 Ctrl 键时，所有其他条目保持不变，但它会切换是否选择了单击的条目。
*   当用户按住 shift 并单击一个条目时，该条目以及它与最后单击的条目之间的每个条目都会被选中。

在 Java 中，我通过使用`JList`Swing 中的类并将选择模式设置为`MULTIPLE_INTERVAL_SELECTED`. 我假设有一种方法可以使用 wxPython 工具包来做到这一点，但是我不知道如何让一个`ListBox`或`ListCtrl`任何其他类来做这件事，除非我自己做大量的事件驱动编程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T19:49:51.507

我认为您正在寻找的是[wxLB_EXTENDED](http://docs.wxwidgets.org/2.6/wx_wxlistbox.html)列表框样式。指定`style = wx.LB_EXTENDED`何时创建`ListBox`.

然后，您可以使用该`GetSelections`方法获取所选项目的列表。

# git - 如何使用 'git rebase -i' 重新调整分支中的所有更改？

> ID：363908
> 
> 赞同：79
> 
> 时间：2008-12-12T19:45:16.727
> 
> 标签：git

这是一个例子：

```
>git status
# On branch master
nothing to commit (working directory clean)
>git checkout -b test-branch
>vi test.c
>git add test.c
>git commit -m "modified test.c"
>vi README
>git add README
>git commit -m "modified README" 
```

现在我想做一个' `git rebase -i`'，让我为这个分支重新提交所有提交。是否有类似' `git rebase -i HEAD~MASTER`'或类似的东西。我想我可以做' `git rebase -i HEAD~2`'，但我真的不想计算已经提交了多少次。我也可以做' `git rebase -i sha1`'但我不想梳理 git log 来找到第一个提交 sha1。有任何想法吗？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2010-11-17T17:36:31.967

好的，我假设分支被称为“功能”，它是从“主”分支出来的。

有一个叫做 merge-base 的小 git 命令。它需要两次提交，并为您提供这两者的第一个共同祖先。所以...

```
git merge-base feature master 
```

...将为您提供这两个提交的第一个共同祖先。猜猜当你将提交传递给 git rebase -i 时会发生什么，比如......

```
git rebase -i `git merge-base feature master` 
```

来自 master 和 feature 分支的第一个共同祖先的交互式 rebase。利润！;)

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2015-05-29T18:25:57.707

所有提供的解决方案的问题是，它们不允许您从第一次提交开始变基。如果第一个提交哈希是 XYZ 并且您这样做：

```
git rebase -i XYZ 
```

您只能从第二次提交开始变基。

如果你想从第一次提交中变基，你可以这样做：

```
git rebase -i --root 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2008-12-12T20:35:20.213

你有没有试过：`git rebase -i master`？

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2008-12-13T01:40:33.577

在其他平台上使用 gitk (*nix) 或 gitx (OS X) 或类似工具，并查看哪个提交是您分支的根。然后运行：

```
git rebase -i <the SHA hash of the root commit> 
```

例如，我有一个使用 gitx 检查的存储库：

![gitx 屏幕截图](https://i.stack.imgur.com/VdhA2.jpg)

现在我知道了根哈希，我可以运行它：

```
git rebase -i 38965ed29d89a4136e47b688ca10b522b6bc335f 
```

我的编辑器会弹出这个，我可以随心所欲地重新排列/挤压/任何东西。

```
pick 50b2cff File 1 changes.
pick 345df08 File 2 changes.
pick 9894931 File 3 changes.
pick 9a62b92 File 4 changes.
pick 640b1f8 File 5 changes.
pick 1c437f7 File 6 changes.
pick b014597 File 7 changes.
pick b1f52bc File 8 changes.
pick 40ae0fc File 9 changes.

# Rebase 38965ed..40ae0fc onto 38965ed
#
# Commands:
#  pick = use commit
#  edit = use commit, but stop for amending
#  squash = use commit, but meld into previous commit
#
# If you remove a line here THAT COMMIT WILL BE LOST.
# However, if you remove everything, the rebase will be aborted.
# 
```

我确信有一些神奇的方法可以说服 git 自动找出树的根，但我不知道它是什么。

编辑：魔法是这样的：

```
git log master..other_feature | cat 
```

这将向您显示该分支上的所有提交，并且通过管道连接到 cat 将禁用寻呼机，以便您立即看到第一个提交。

编辑：结合以上提供了一个完全自动化的解决方案：

```
git rebase -i  `git log master..other_feature --pretty=format:"%h" | tail -n 1`~ 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-06-24T20:44:00.067

**从不同分支变基的问题**

问题`git rebase -i master`在于，您可能有暂时不想处理的合并冲突，或者您可能在一次提交中修复冲突，只是在变基过程中在另一次提交中再次修复它。

**从已知提交变基的问题**

这里的整个问题是你必须*知道*你必须引用哪个提交，或者通过它的 SHA 或 HEAD~x 等。这只是一个小烦恼，但它是一个烦恼。

**更好的方法**

如果您想重新设置当前分支中的所有提交，因为它与父分支共享最近的提交，您可以将以下别名添加到 .gitconfig：

```
rbi = !sh -c \"git rebase -i `git merge-base $1 HEAD`\" - 
```

**用法**

```
git rbi parentBranch 
```

**这个怎么运作**

这个别名只是一个 shell 脚本，它使用了一个引用父分支的参数。传递该参数`git merge-base`以确定该分支与当前分支之间的最新共享提交。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-05-05T06:03:56.653

从 Git v1.7.10 开始，您可以`git rebase`不带参数地运行，它会找到分支点并将您的本地更改重新定位到上游分支。

您需要配置上游分支才能使其工作（即`git pull`没有参数应该工作）。

有关更多详细信息，请参阅[git rebase](http://git-scm.com/docs/git-rebase)的文档：

> 如果未指定，将使用在 branch..remote 和 branch..merge 选项中配置的上游（请参阅 git-config[1] 了解详细信息）并假定 --fork-point 选项。如果您当前不在任何分支上，或者当前分支没有配置上游，rebase 将中止。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-08-30T17:24:15.170

一个通用的解决方案（如果您不知道上游分支的名称）是：

```
git rebase -i @{upstream} 
```

请注意，如果您的上游（可能是跟踪分支）在您上次重新定位后已更新，您将从上游拉入新的提交。如果您不想引入新的提交，请使用

```
git rebase -i `git merge-base --all HEAD @{upstream}` 
```

但这有点拗口。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-06-23T14:36:11.950

```
git rebase -i --onto @{u}... @{u} 
```

从 HEAD 及其上游的单个合并点开始的交互式变基，包括 HEAD 中不在其上游的所有提交。

换句话说，正是你想要的。

# ssas - MDX 中集合的第一个和最后一个测量日期

> ID：363925
> 
> 赞同：2
> 
> 时间：2008-12-12T19:51:27.260
> 
> 标签：ssas, mdx

我正在寻找有关如何处理 MDX 查询的一些指导。我的情况是我发生了销售，它构成了事实表的粒度，并且是度量。我有一个产品维度和一个客户维度。我还有一个日期维度和一个时间维度，我将它们分开以保持维度上的成员数量较少。

我正在尝试编写的查询是询问每个客户每个产品的第一次和最后一次购买。因此，示例结果集可能如下所示：

```
Car - Bob - 2008-12-10 - 15:39 - 2008-12-11 - 16:44
Car - Bill - 2008-12-12 - 09:16 - 2008-12-12 - 09:16
Van - Jim - 2008-12-11 - 14:02 - 2008-12-12 - 22:01 
```

所以，Bob 买了两辆车，我们有第一次和最后一次购买，Bill 买了一辆车，所以第一次和最后一次购买是一样的，Jim 可能买了三辆货车，但我们只显示第一辆和最后一辆。

我尝试过使用 TAIL，但似乎无法正确设置集合以显示每位客户的最后一次购买。即便如此，第一次购买 HEAD 的过期时间表明我不能在同一轴上两次使用相同的尺寸。由于每天可能有几次购买，这也变得更加困难，所以我需要的查询是每个产品的每个客户的最后日期的最后时间，以及每个产品的每个客户的第一个日期的第一次.

我不一定要求提供确切的查询答案，尽管这会有所帮助，但我对使用的方法和最佳方法感兴趣。该平台是 SQL Server Analysis Services 2005。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T10:25:17.090

你不能只在购买日期使用最小和最大聚合吗？还是我完全错过了这个问题？

# java - 从 org.joda.time.DateTime 转换为 java.util.Calendar 的方法

> ID：363930
> 
> 赞同：23
> 
> 时间：2008-12-12T19:52:40.457
> 
> 标签：java, datetime, jodatime

有人做过这个可以分享吗？我看到一两个选项，但想知道其他人已经完成了什么。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-12-12T20:01:06.617

根据 joda-time 文档，首选的方法是调用它： [AbstractDateTime#toCalendar](http://joda-time.sourceforge.net/api-release/org/joda/time/base/AbstractDateTime.html#toCalendar(java.util.Locale))。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-30T15:06:01.847

You can also call AbstractInstant#toDate

[http://joda-time.sourceforge.net/api-release/org/joda/time/base/AbstractInstant.html#toDate()](http://joda-time.sourceforge.net/api-release/org/joda/time/base/AbstractInstant.html#toDate())

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T03:14:15.480

在 2.1 中你可以使用

```
public static Calendar parseCalendar(DateTime dt){
    return dt.toGregorianCalendar();
} 
```

# c++ - 你怎么能得到一个 4.2 版本的 g++/gcc for windows？

> ID：363936
> 
> 赞同：4
> 
> 时间：2008-12-12T19:54:23.213
> 
> 标签：c++, gcc, mingw

您如何获得最新版本的 g++/gcc for windows，即 4.2+？Mingw 的标准 g++ 是 3.4.5，已经 3 年了，于 2005 年 11 月发布。Mingw 有一个 4.2 版本，但这只是在 Alpha 阶段。我找不到最近稳定的 g++ for windows 版本，我肯定错过了一些东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-12T20:09:33.323

[Twilight Dragon Media](http://www.tdragon.net/)跟踪并定期发布可用于 MinGW 环境的 GCC 版本。

当前版本基于 GCC 4.3.2。

包可以在[这里](http://www.tdragon.net/recentgcc/)下载。经过两个多月的广泛测试后，我开始在生产中使用 4.3.2-TDM1 版本。我遇到的唯一不确定的事情是 C++ 中的跨 DLL 异常，但是 C++ 异常在 MinGW 中已经被破坏了很长时间，而且我们的大多数代码都没有使用它们，或者至少没有跨库边界使用它们。

有一个更新的版本可用（4.3.2-TDM2，已经发布了几天）。发行说明说它“与第一个不同之处仅在于已修复的两个错误 - 一个与临时文件有关，一个与标题路径有关。一个新的 TDM/MinGW 安装程序已同时发布。” 不过还没有测试过。

编辑：4.3.3-TDM1 到目前为止似乎很稳定——在预生产使用中没有遇到任何错误。在对其进行了广泛的测试之后，我可以推荐 4.3.2-TDM2 用于生产用途。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-12T19:56:58.497

使用[Cygwin](http://cygwin.com)。完整的[软件包列表](http://cygwin.com/packages/)包括[gcc4-g++](http://cygwin.com/packages/gcc4-g++/)，最新版本是 4.3.2-1，应该可以满足您的需求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-14T22:48:14.013

[你可以在这里](http://nuwen.net/mingw.html)得到一个使用 gcc 4.3.3 的 MinGW 发行版——我玩过它，但没有在愤怒中使用它。它配备了 boost 和其他几个有用的库

# asp.net - 基本：会话 id 是如何创建的？

> ID：363940
> 
> 赞同：9
> 
> 时间：2008-12-12T19:55:09.873
> 
> 标签：asp.net, session

IIS 是否在收到请求时创建会话 ID 以及保存在哪里（客户端或服务器）？

服务器如何识别请求来自同一个用户/会话？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-12T20:07:04.187

您的第一个问题的答案是肯定的——如果使用会话，以及两者。

cookie 是随着每个请求/响应在客户端和服务器之间来回传递的一小段文本。

IIS 生成一个会话 id，保存它和任何相关的数据，并将 cookie 传递给客户端（浏览器）。

当客户端发出另一个请求时，它会将包含 sessionID 的 cookie 发送回服务器。然后服务器可以查看 cookie 并找到保存在服务器上的会话（和相关数据）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-12T20:14:00.507

在 ASP.net 中，有多个位置可以保存会话，但它始终位于服务器基础结构中。

默认是 IIS 进程的内存。这意味着：如果您重置 IIS（或整个 PC）甚至只是 IIS 中的应用程序池，所有会话都将被删除，并且会话数据将永远丢失。此外，如果您有很多会话并在每个会话中存储大量数据，则该过程将需要大量内存，这可能是一个问题。这称为“进程内”会话。

主要的替代方案是 SQL Server 数据库。这样，即使在重新启动后仍会保留会话，并且每个会话的大小并不重要。主要缺点是增加了延迟：从数据库中获取数据当然比 In-Proc 解决方案要慢。

还有一些其他方法如何存储会话（包括编写一个全新的会话提供程序的选项），但两种常见的方法是“服务器的内存”和“A MS SQL 数据库”。

# python - Python成语返回第一项或无

> ID：363944
> 
> 赞同：360
> 
> 时间：2008-12-12T19:56:02.540
> 
> 标签：python, idioms, python-2.4

我敢肯定有一种更简单的方法可以做到这一点，而我只是没有想到。

我正在调用一堆返回列表的方法。该列表可能为空。如果列表非空，我想返回第一项；否则，我想返回 None。此代码有效：

```
my_list = get_list()
if len(my_list) > 0: return my_list[0]
return None 
```

在我看来，这样做应该有一个简单的单行成语，但对于我的生活，我想不出它。有没有？

**编辑：**

我在这里寻找单行表达式的原因不是我喜欢非常简洁的代码，而是因为我不得不编写很多这样的代码：

```
x = get_first_list()
if x:
    # do something with x[0]
    # inevitably forget the [0] part, and have a bug to fix
y = get_second_list()
if y:
    # do something with y[0]
    # inevitably forget the [0] part AGAIN, and have another bug to fix 
```

我想做的事情当然可以通过一个函数来完成（并且可能会是）：

```
def first_item(list_or_none):
    if list_or_none: return list_or_none[0]

x = first_item(get_first_list())
if x:
    # do something with x
y = first_item(get_second_list())
if y:
    # do something with y 
```

我发布这个问题是因为我经常对 Python 中的简单表达式可以做什么感到惊讶，并且我认为如果有一个简单的表达式可以解决问题，那么编写一个函数是一件愚蠢的事情。但是看到这些答案，似乎函数*是*简单的解决方案。

* * *

## 回答 #1

> 赞同：286
> 
> 时间：2008-12-13T23:31:55.753

## Python 2.6+

```
next(iter(your_list), None) 
```

如果`your_list`可以`None`：

```
next(iter(your_list or []), None) 
```

## 蟒蛇2.4

```
def get_first(iterable, default=None):
    if iterable:
        for item in iterable:
            return item
    return default 
```

例子：

```
x = get_first(get_first_list())
if x:
    ...
y = get_first(get_second_list())
if y:
    ... 
```

另一种选择是内联上述函数：

```
for x in get_first_list() or []:
    # process x
    break # process at most one item
for y in get_second_list() or []:
    # process y
    break 
```

为了避免`break`你可以写：

```
for x in yield_first(get_first_list()):
    x # process x
for y in yield_first(get_second_list()):
    y # process y 
```

在哪里：

```
def yield_first(iterable):
    for item in iterable or []:
        yield item
        return 
```

* * *

## 回答 #2

> 赞同：251
> 
> 时间：2008-12-12T20:12:27.513

最好的方法是这样的：

```
a = get_list()
return a[0] if a else None 
```

您也可以在一行中完成，但程序员阅读起来要困难得多：

```
return (get_list()[:1] or [None])[0] 
```

* * *

## 回答 #3

> 赞同：88
> 
> 时间：2008-12-12T20:00:03.920

```
(get_list() or [None])[0] 
```

那应该行得通。

顺便说一句，我没有使用变量`list`，因为它覆盖了内置`list()`函数。

编辑：我之前有一个稍微简单但错误的版本。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2014-08-20T06:36:29.900

最 Python 惯用的方法是在迭代器上使用 next() ，因为 list 是*iterable*。就像@JFSebastian 在 2011 年 12 月 13 日发表的评论一样。

`next(iter(the_list), None)`如果`the_list`为空，则返回 None。见[next() Python 2.6+](https://docs.python.org/2/library/functions.html#next)

或者如果您确定`the_list`不为空：

`iter(the_list).next()`见[iterator.next() Python 2.2+](https://docs.python.org/2/library/stdtypes.html#iterator.next)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2016-02-29T14:43:44.513

如果您发现自己试图从列表理解中提取第一件事（或无），您可以切换到生成器来执行以下操作：

```
next((x for x in blah if cond), None) 
```

优点：如果 blah 不是可索引的，则可以使用。缺点：这是不熟悉的语法。不过，在 ipython 中修改和过滤内容时它很有用。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-12-12T22:41:48.133

OP 的解决方案几乎就在那里，只有几件事可以使它更加 Pythonic。

一方面，不需要获取列表的长度。Python 中的空列表在 if 检查中评估为 False。只是简单的说

```
if list: 
```

此外，分配给与保留字重叠的变量是一个非常糟糕的主意。“list”是 Python 中的保留字。

所以让我们把它改成

```
some_list = get_list()
if some_list: 
```

这里的许多解决方案都忽略了一个非常重要的一点，即**所有 Python 函数/方法默认返回 None**。请尝试以下操作。

```
def does_nothing():
    pass

foo = does_nothing()
print foo 
```

除非您需要返回 None 以提前终止函数，否则没有必要显式返回 None。非常简洁，只要返回第一个条目，如果它存在的话。

```
some_list = get_list()
if some_list:
    return list[0] 
```

最后，也许这是隐含的，但只是为了明确（因为[显式优于隐式](http://www.python.org/dev/peps/pep-0020/)），您不应该让您的函数从另一个函数获取列表；只需将其作为参数传入即可。所以，最终的结果将是

```
def get_first_item(some_list): 
    if some_list:
        return list[0]

my_list = get_list()
first_item = get_first_item(my_list) 
```

正如我所说，OP 几乎就在那里，只需轻轻一点，它就具有您正在寻找的 Python 风味。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2015-07-18T04:33:11.960

> **Python成语返回第一项或无？**

最 Pythonic 的方法是最受好评的答案所展示的，当我阅读这个问题时，这是我首先想到的。下面是如何使用它，首先如果可能为空的列表被传递给一个函数：

```
def get_first(l): 
    return l[0] if l else None 
```

如果列表是从`get_list`函数返回的：

```
l = get_list()
return l[0] if l else None 
```

## Python 3.8 中的新功能，赋值表达式

赋值表达式使用就地赋值运算符（非正式地称为海象运算符），`:=`Python 3.8 中的新功能，允许我们就地进行检查和赋值，允许单行：

```
return l[0] if (l := get_list()) else None 
```

作为一个长期使用 Python 的用户，这感觉就像我们试图在一行上做太多事情 - 我觉得做假定性能相同的样式会更好：

```
if l := get_list():
    return l[0]
return None 
```

支持这一表述的是 Tim Peter在 PEP 中提议对语言进行这种更改的[文章。](https://www.python.org/dev/peps/pep-0572/#appendix-a-tim-peters-s-findings)他没有提到第一个公式，但基于他喜欢的其他公式，我认为他不会介意。

## 此处演示的其他方法，并附有解释

### `for`

当我开始尝试想出聪明的方法来做到这一点时，这是我想到的第二件事：

```
for item in get_list():
    return item 
```

这假定函数在这里结束，隐式返回`None`if`get_list`返回一个空列表。下面的显式代码是完全等价的：

```
for item in get_list():
    return item
return None 
```

### `if some_list`

还提出了以下内容（我更正了不正确的变量名称），它也使用了隐式`None`. 这将比上述更可取，因为它使用逻辑检查而不是可能不会发生的迭代。这应该更容易立即理解正在发生的事情。但是如果我们是为了可读性和可维护性而编写的，我们还应该`return None`在末尾添加显式：

```
some_list = get_list()
if some_list:
    return some_list[0] 
```

### 切片`or [None]`并选择第零个索引

这也是投票率最高的答案：

```
return (get_list()[:1] or [None])[0] 
```

切片是不必要的，它会在内存中创建一个额外的单项列表。以下应该更高效。解释一下，`or`如果第一个元素`False`在布尔上下文中，则返回第二个元素，因此如果`get_list`返回一个空列表，则括号中包含的表达式将返回一个带有 'None' 的列表，然后将通过`0`索引访问该列表：

```
return (get_list() or [None])[0] 
```

下一个使用这样一个事实，如果第一项`True`在布尔上下文中，则返回第二项，并且由于它引用 my_list 两次，它并不比三元表达式好（技术上不是单行）：

```
my_list = get_list() 
return (my_list and my_list[0]) or None 
```

### `next`

然后我们有以下巧妙的使用内建`next`和`iter`

```
return next(iter(get_list()), None) 
```

解释一下，`iter`返回一个带有`.next`方法的迭代器。（`.__next__`在 Python 3 中。）然后内置`next`调用该`.next`方法，如果迭代器用尽，则返回我们给出的默认值，`None`.

### 多余的三元表达式 ( `a if b else c`) 和回旋

提出了以下建议，但反过来会更好，因为逻辑通常在积极而不是消极中更好地理解。由于`get_list`被调用了两次，除非结果以某种方式被记忆，否则这将表现不佳：

```
return None if not get_list() else get_list()[0] 
```

更好的逆：

```
return get_list()[0] if get_list() else None 
```

更好的是，使用一个局部变量，这样`get_list`它只被调用一次，你首先讨论了推荐的 Pythonic 解决方案：

```
l = get_list()
return l[0] if l else None 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-09-16T14:28:24.870

`my_list[0] if len(my_list) else None`

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-12T21:48:57.867

```
for item in get_list():
    return item 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-08-25T17:02:56.377

[关于成语](https://docs.python.org/3/library/itertools.html#itertools-recipes)，有一个名为`nth`.

从 itertools 食谱：

```
def nth(iterable, n, default=None):
    "Returns the nth item or a default value"
    return next(islice(iterable, n, None), default) 
```

如果您想要单行，请考虑安装一个为您实现此配方的库，例如[`more_itertools`](https://github.com/erikrose/more-itertools)：

```
import more_itertools as mit

mit.nth([3, 2, 1], 0)
# 3

mit.nth([], 0)                                             # default is `None`
# None 
```

另一个工具可用，它只返回第一项，称为[`more_itertools.first`](https://more-itertools.readthedocs.io/en/latest/api.html).

```
mit.first([3, 2, 1])
# 3

mit.first([], default=None)
# None 
```

这些 itertools 一般适用于任何可迭代对象，而不仅仅是列表。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-12T23:14:19.800

坦率地说，我不认为有更好的成语：你是清晰和简洁的 - 不需要任何“更好”的东西。也许吧，但这真的是一个品味问题，你可以改变`if len(list) > 0:`-`if list:`一个空列表将始终评估为 False。

在相关的说明中，Python**不是**Perl（没有双关语！），您不必获得最酷的代码。
实际上，我在 Python 中看到的最糟糕的代码也非常酷 :-) 并且完全无法维护。

顺便说一句，我在这里看到的大多数解决方案都没有考虑 list[0] 计算结果为 False （例如空字符串或零） - 在这种情况下，它们都返回 None 而不是正确的元素。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-16T07:07:33.257

出于好奇，我对其中两个解决方案进行了计时。使用 return 语句过早结束 for 循环的解决方案在我的机器上使用 Python 2.5.1 的成本略高，我怀疑这与设置可迭代对象有关。

```
import random
import timeit

def index_first_item(some_list):
    if some_list:
        return some_list[0]

def return_first_item(some_list):
    for item in some_list:
        return item

empty_lists = []
for i in range(10000):
    empty_lists.append([])

assert empty_lists[0] is not empty_lists[1]

full_lists = []
for i in range(10000):
    full_lists.append(list([random.random() for i in range(10)]))

mixed_lists = empty_lists[:50000] + full_lists[:50000]
random.shuffle(mixed_lists)

if __name__ == '__main__':
    ENV = 'import firstitem'
    test_data = ('empty_lists', 'full_lists', 'mixed_lists')
    funcs = ('index_first_item', 'return_first_item')
    for data in test_data:
        print "%s:" % data
        for func in funcs:
            t = timeit.Timer('firstitem.%s(firstitem.%s)' % (
                func, data), ENV)
            times = t.repeat()
            avg_time = sum(times) / len(times)
            print "  %s:" % func
            for time in times:
                print "    %f seconds" % time
            print "    %f seconds avg." % avg_time 
```

这些是我得到的时间：

```
空列表：
  index_first_item：
    0.748353 秒
    0.741086 秒
    0.741191 秒
    0.743543 秒平均
  return_first_item：
    0.785511 秒
    0.822178 秒
    0.782846 秒
    0.796845 秒平均
完整列表：
  index_first_item：
    0.762618 秒
    0.788040 秒
    0.786849 秒
    平均 0.779169 秒
  return_first_item：
    0.802735 秒
    0.878706 秒
    0.808781 秒
    平均 0.830074 秒
混合列表：
  index_first_item：
    0.791129 秒
    0.743526 秒
    0.744441 秒
    0.759699 秒平均
  return_first_item：
    0.784801 秒
    0.785146 秒
    0.840193 秒
    0.803380 秒平均

```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-16T13:17:12.963

```
def head(iterable):
    try:
        return iter(iterable).next()
    except StopIteration:
        return None

print head(xrange(42, 1000)  # 42
print head([])               # None 
```

顺便说一句：我会将您的一般程序流程改造成如下内容：

```
lists = [
    ["first", "list"],
    ["second", "list"],
    ["third", "list"]
]

def do_something(element):
    if not element:
        return
    else:
        # do something
        pass

for li in lists:
    do_something(head(li)) 
```

（尽可能避免重复）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-06-28T07:57:26.543

这个怎么样：

`(my_list and my_list[0]) or None`

**注意：**这对于对象列表应该可以正常工作，但根据下面的评论，如果是数字或字符串列表，它可能会返回不正确的答案。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-03-18T08:14:55.827

不知道这是多么pythonic，但直到库中有第一个函数，我将它包含在源代码中：

```
first = lambda l, default=None: next(iter(l or []), default) 
```

它只是一行（符合黑色）并避免了依赖关系。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-11-15T19:46:42.720

借用[more_itertools.first_true](https://more-itertools.readthedocs.io/en/stable/_modules/more_itertools/recipes.html#first_true)代码会产生一些可读性强的东西：

```
def first_true(iterable, default=None, pred=None):
    return next(filter(pred, iterable), default)

def get_first_non_default(items_list, default=None):
    return first_true(items_list, default, pred=lambda x: x!=default) 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2008-12-12T20:30:19.117

```
try:
    return a[0]
except IndexError:
    return None 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2008-12-12T23:48:00.637

使用 and-or 技巧：

```
a = get_list()
return a and a[0] or None
```

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2014-02-04T18:37:07.803

可能不是最快的解决方案，但没有人提到这个选项：

```
dict(enumerate(get_list())).get(0) 
```

如果`get_list()`可以返回`None`，您可以使用：

```
dict(enumerate(get_list() or [])).get(0) 
```

好处：

-一条线

- 你只需打`get_list()`一次电话

-容易明白

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2015-07-20T07:00:51.813

我的用例只是设置局部变量的值。

就我个人而言，我发现尝试和除样式清洁器可以阅读

```
items = [10, 20]
try: first_item = items[0]
except IndexError: first_item = None
print first_item 
```

而不是切片列表。

```
items = [10, 20]
first_item = (items[:1] or [None, ])[0]
print first_item 
```

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2008-12-12T20:10:04.010

您可以使用[提取方法](http://www.refactoring.com/catalog/extractMethod.html)。换句话说，将该代码提取到您将调用的方法中。

我不会尝试更多地压缩它，一个衬里似乎比冗长的版本更难阅读。如果你使用提取方法，它是一个单行；）

* * *

## 回答 #22

> 赞同：-2
> 
> 时间：2008-12-13T00:35:13.630

有几个人建议做这样的事情：

```
list = get_list()
return list and list[0] or None 
```

这在很多情况下都有效，但只有当 list[0] 不等于 0、False 或空字符串时才有效。如果 list[0] 为 0、False 或空字符串，则该方法将错误地返回 None。

> > 我在自己的代码中创建了这个错误太多次了！

* * *

## 回答 #23

> 赞同：-3
> 
> 时间：2008-12-12T21:55:53.703

不是与 C 风格的三元运算符等效的惯用 python

```
cond and true_expr or false_expr 
```

IE。

```
list = get_list()
return list and list[0] or None 
```

* * *

## 回答 #24

> 赞同：-3
> 
> 时间：2016-10-25T09:54:19.547

```
if mylist != []:

       print(mylist[0])

   else:

       print(None) 
```

# python - 使用 python 监视一些服务器上的服务的最佳方法

> ID：363968
> 
> 赞同：1
> 
> 时间：2008-12-12T20:02:13.883
> 
> 标签：python

从 python 监视一些服务器的 HTTP/FTP/IMAP/POP3/SMTP 等服务的最佳方法是什么？使用套接字并尝试连接到服务端口 http-80、ftp-21 等...如果连接成功则假设服务正常或使用 python 库连接到指定服务并处理异常/返回码/等...

例如对于 ftp 是不是更好

```
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
    s.connect(("ftp.domain.tld", 21))
    print "ok"
except:
    print "failed"
s.close() 
```

或者

```
from ftplib import FTP

try:
    ftp = FTP('ftp.domain.tld')
    print "FTP service OK"
    ftp.close()
except:
    print "FTP err" 
```

其余的也是如此，socket vs urllib2，imaplib等......如果我采用lib方式，我如何测试smtp？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-12T20:23:45.027

**更新1：**

实际上，在您的代码中，这两个选项（在 FTP 中）没有区别。第二个选项应该是首选代码可读性。但是方式不登录到 ftp 服务器，也许读取一些文件？

**更新0：**

监控时，最好测试全栈。因为否则您可能会错过未在套接字级别表现出来的问题。可以使用 smtplib 测试 smtp。最好的方法实际上是用它发送邮件。并使用 imaplib 从目标读取它。或者，您可以只使用 smtplib 与 smtp 服务器对话。最好做整个端到端的事情。但应考虑开发和配置资源以应对缺失问题的影响。

# vb.net - 尝试 Catch 块

> ID：363969
> 
> 赞同：1
> 
> 时间：2008-12-12T20:02:29.983
> 
> 标签：vb.net, exception-handling

我有以下代码

```
Try
    'Some code that causes exception
Catch ex as ExceptionType1
    'Handle Section - 1
Catch ex as ExceptionType2
    'Handle section - 2
Catch ex as ExceptionType3
    'Handle section - 3    
Finally
    ' Clean up
End Try 
```

假设 ExceptionType1 由第 1 节处理的代码抛出。在第 1 节处理之后，我可以将控制权传递给第 2 节/第 3 节吗？那可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-12T20:06:42.470

更改代码以在一个块中捕获所有异常，并从那里确定类型和执行路径。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-12T20:10:10.110

您可以在异常处理程序中调用函数。

```
Try
'Some code that causes exception'
Catch ex as ExceptionType1
  handler_1()
  handler_2()
  handler_3()
Catch ex as ExceptionType2
  handler_2()
  handler_3()
Catch ex as ExceptionType3
  handler_3()
Finally
  handler_4()    
End Try 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-12T20:15:02.673

~~你没有指定语言~~，我不知道语言，所以我一般回答。

你不能那样做。如果您想拥有通用代码，请将其放入 中`finally`，或者如果它只需要针对某些捕获案例执行，您可以将该代码复制到相应的案例中。如果代码比较大并且你想避免冗余，你可以把它放到一个自己的函数中。如果这会降低代码的可读性，您可以嵌套 try/catch 块（至少在 Java 和 C++ 中。我不了解您的语言）。这是Java中的示例：

```
class ThrowingException {
    public static void main(String... args) {
        try {
            try {
                throw new RuntimeException();
            } catch(RuntimeException e) {
                System.out.println("Hi 1, handling RuntimeException..");
                throw e;
            } finally {
                System.out.println("finally 1");
            }
        } catch(Exception e) {
            System.out.println("Hi 2, handling Exception..");
        } finally {
            System.out.println("finally 2");
        }
    }
} 
```

这将打印出：

```
Hi 1, handling RuntimeException..
finally 1
Hi 2, handling Exception..
finally 2 
```

将您的公共代码放入外部 catch 块中。使用嵌套版本还可以处理发生异常的情况，而无需在 catch 块中明确地重新抛出旧的。它可能更适合您想要的东西，但也可能不适合。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-12T20:08:01.237

我认为如果您使用嵌套的 try 块，您可以获得您想要的行为。一旦抛出异常，执行将转到 catch 块。如果什么都没有被重新抛出，它会移动到 finally。

# c++ - C++ 模板和外部函数声明

> ID：363998
> 
> 赞同：0
> 
> 时间：2008-12-12T20:14:23.440
> 
> 标签：c++, templates

我有这个：

```
template <typename T>
class myList
{
    ...
    class myIterator
    {
        ...
        T& operator*();
    }
}
...
template<typename T>
T& myList<T>::myIterator::operator*()
{
    ...
} 
```

这给了我以下错误：“'&'令牌之前的预期初始化程序”。我到底应该怎么做？我已经尝试在它之前添加“模板 myList::myIterator”，但这没有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-12T20:22:15.357

一些分号和公共如何：

```
template <typename T>
class myList
{
public:
    class myIterator
    {
    public:
        T& operator*();
    };
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-12T22:49:55.823

编译好：
如果你想发布代码，它应该尽可能简单，但它仍然应该是可编译的。如果你把东西删掉，那么你可能会删除你想要修复的真正错误，如果你向人们展示代码，这里的人真的很擅长发现问题。

在这种情况下，我们只能将其归结为您已删除的一些代码。

```
template <typename T>
class myList
{
    public:
    class myIterator
    {
        public:
        T& operator*();
    };
};

template<typename T>
T& myList<T>::myIterator::operator*()
{
    static T    x;
    return x;
}

int main()
{
    myList<int>             a;
    myList<int>::myIterator b;
    int&                    c= *b;
} 
```***********~~***